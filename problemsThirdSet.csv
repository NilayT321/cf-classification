739E "Gosha is hunting" "brute force,data structures,dp,flows,math,probabilities,sortings" "Gosha is hunting. His goal is to catch as many Pokemons as possible. Gosha has a Poke Balls and b Ultra Balls. There are n Pokemons. They are numbered 1 through n. Gosha knows that if he throws a Poke Ball at the i-th Pokemon he catches it with probability pi. If he throws an Ultra Ball at the i-th Pokemon he catches it with probability ui. He can throw at most one Ball of each type at any Pokemon.The hunting proceeds as follows: at first, Gosha chooses no more than a Pokemons at which he will throw Poke Balls and no more than b Pokemons at which he will throw Ultra Balls. After that, he throws the chosen Balls at the chosen Pokemons. If he throws both Ultra Ball and Poke Ball at some Pokemon, he is caught if and only if he is caught by any of these Balls. The outcome of a throw doesn\'t depend on the other throws.Gosha would like to know what is the expected number of the Pokemons he catches if he acts in an optimal way. In other words, he would like to know the maximum possible expected number of Pokemons can catch." 3000

739D "Recover a functional graph" "graph matchings" "Functional graph is a directed graph in which all vertices have outdegree equal to 1. Loops are allowed.Some vertices of a functional graph lay on a cycle. From the others we can come to a cycle by making a finite number of steps along the edges (we consider only finite functional graphs in this problem).Let\'s compute two values for each vertex. precyclei is the amount of edges we should pass to get to a vertex which is a part of some cycle (zero, if i itself lies on a cycle), cyclei is the length of the cycle we get to.You are given the information about these values for some functional graph. For each vertex you know the values precyclei and cyclei, however, instead of some values there can be the question mark. It means that these values are unknown.Build any functional graph that suits the description or determine that there is no such graph." 3400

739C "Alyona and towers" "data structures" "Alyona has built n towers by putting small cubes some on the top of others. Each cube has size 1\xe2\x80\x89\xc3\x97\xe2\x80\x891\xe2\x80\x89\xc3\x97\xe2\x80\x891. A tower is a non-zero amount of cubes standing on the top of each other. The towers are next to each other, forming a row.Sometimes Alyona chooses some segment towers, and put on the top of each tower several cubes. Formally, Alyouna chooses some segment of towers from li to ri and adds di cubes on the top of them.Let the sequence a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an be the heights of the towers from left to right. Let\'s call as a segment of towers al,\xe2\x80\x89al\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89ar a hill if the following condition holds: there is integer k (l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r) such that al\xe2\x80\x89<\xe2\x80\x89al\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89<\xe2\x80\x89al\xe2\x80\x89+\xe2\x80\x892\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89ak\xe2\x80\x89>\xe2\x80\x89ak\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89>\xe2\x80\x89ak\xe2\x80\x89+\xe2\x80\x892\xe2\x80\x89>\xe2\x80\x89...\xe2\x80\x89>\xe2\x80\x89ar.After each addition of di cubes on the top of the towers from li to ri, Alyona wants to know the maximum width among all hills. The width of a hill is the number of towers in it." 2500

739B "Alyona and a tree" "binary search,data structures,dfs and similar,graphs,trees" "Alyona has a tree with n vertices. The root of the tree is the vertex 1. In each vertex Alyona wrote an positive integer, in the vertex i she wrote ai. Moreover, the girl wrote a positive integer to every edge of the tree (possibly, different integers on different edges).Let\'s define dist(v,\xe2\x80\x89u) as the sum of the integers written on the edges of the simple path from v to u.The vertex v controls the vertex u (v\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89u) if and only if u is in the subtree of v and dist(v,\xe2\x80\x89u)\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89au.Alyona wants to settle in some vertex. In order to do this, she wants to know for each vertex v what is the number of vertices u such that v controls u." 1900

739A "Alyona and mex" "constructive algorithms,greedy" "Alyona\'s mother wants to present an array of n non-negative integers to Alyona. The array should be special. Alyona is a capricious girl so after she gets the array, she inspects m of its subarrays. Subarray is a set of some subsequent elements of the array. The i-th subarray is described with two integers li and ri, and its elements are a[li],\xe2\x80\x89a[li\xe2\x80\x89+\xe2\x80\x891],\xe2\x80\x89...,\xe2\x80\x89a[ri].Alyona is going to find mex for each of the chosen subarrays. Among these m mexes the girl is going to find the smallest. She wants this minimum mex to be as large as possible. You are to find an array a of n elements so that the minimum mex among those chosen by Alyona subarrays is as large as possible.The mex of a set S is a minimum possible non-negative integer that is not in S." 1700

737F "Dirty plates" "constructive algorithms,math" "After one of celebrations there is a stack of dirty plates in Nikita\'s kitchen. Nikita has to wash them and put into a dryer. In dryer, the plates should be also placed in a stack also, and the plates sizes should increase down up. The sizes of all plates are distinct.Nikita has no so much free space, specifically, he has a place for only one more stack of plates. Therefore, he can perform only such two operations:   Take any number of plates from 1 to a from the top of the dirty stack, wash them and put them to the intermediate stack.  Take any number of plates from 1 to b from the top of the intermediate stack and put them to the stack in the dryer. Note that after performing each of the operations, the plates are put in the same order as they were before the operation.You are given the sizes of the plates s1,\xe2\x80\x89s2,\xe2\x80\x89...,\xe2\x80\x89sn in the down up order in the dirty stack, and integers a and b. All the sizes are distinct. Write a program that determines whether or not Nikita can put the plates in increasing down up order in the dryer. If he is able to do so, the program should find some sequence of operations (not necessary optimal) to achieve it." 3300

737E "Tanya is 5!" "graph matchings,graphs,greedy,schedules" "Tanya is now five so all her friends gathered together to celebrate her birthday. There are n children on the celebration, including Tanya.The celebration is close to its end, and the last planned attraction is gaming machines. There are m machines in the hall, they are numbered 1 through m. Each of the children has a list of machines he wants to play on. Moreover, for each of the machines he knows the exact time he wants to play on it. For every machine, no more than one child can play on this machine at the same time.It is evening already, so every adult wants to go home. To speed up the process, you can additionally rent second copies of each of the machines. To rent the second copy of the j-th machine, you have to pay pj burles. After you rent a machine, you can use it for as long as you want.How long it will take to make every child play according to his plan, if you have a budget of b burles for renting additional machines? There is only one copy of each machine, so it\'s impossible to rent a third machine of the same type.The children can interrupt the game in any moment and continue it later. If the i-th child wants to play on the j-th machine, it is allowed after you rent the copy of the j-th machine that this child would play some part of the time on the j-th machine and some part of the time on its copy (each of these parts could be empty). The interruptions and changes take no time and can be performed in any integer moment of time. Of course, a child can\'t play on more than one machine at the same time.Remember, that it is not needed to save money (no one saves money at the expense of children happiness!), it is needed to minimize the latest moment of time some child ends his game." 3300

736E "Chess Championship" "constructive algorithms,flows,greedy,math" "Ostap is preparing to play chess again and this time he is about to prepare. Thus, he was closely monitoring one recent chess tournament. There were m players participating and each pair of players played exactly one game. The victory gives 2 points, draw�\xe2\x80\x94 1 points, lose�\xe2\x80\x94 0 points.Ostap is lazy, so he never tries to remember the outcome of each game. Instead, he computes the total number of points earned by each of the players (the sum of his points in all games which he took part in), sort these value in non-ascending order and then remembers first n integers in this list.Now the Great Strategist Ostap wonders whether he remembers everything correct. He considers that he is correct if there exists at least one tournament results table such that it will produce the given integers. That means, if we count the sum of points for each player, sort them and take first n elements, the result will coincide with what Ostap remembers. Can you check if such table exists?" 2900

736D Permutations math,matrices "Ostap Bender is worried that people started to forget that he is the Great Combinator. Now he wants to show them his skills in combinatorics. Now he studies the permutations of length n. He has a list of m valid pairs, pair ai and bi means that he is allowed to place integers bi at position ai.He knows that the number of permutations that use only valid pairs is odd. Now, for each pair he wants to find out, will the number of valid permutations be odd if he removes this pair (and only it) from the list." 2800

735E "Ostap and Tree" dp,trees "Ostap already settled down in Rio de Janiero suburb and started to grow a tree in his garden. Recall that a tree is a connected undirected acyclic graph. Ostap\'s tree now has n vertices. He wants to paint some vertices of the tree black such that from any vertex u there is at least one black vertex v at distance no more than k. Distance between two vertices of the tree is the minimum possible number of edges of the path between them.As this number of ways to paint the tree can be large, Ostap wants you to compute it modulo 109\xe2\x80\x89+\xe2\x80\x897. Two ways to paint the tree are considered different if there exists a vertex that is painted black in one way and is not painted in the other one." 2500

735D Taxes "math,number theory" "Mr. Funt now lives in a country with a very specific tax laws. The total income of mr. Funt during this year is equal to n (n\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x892) burles and the amount of tax he has to pay is calculated as the maximum divisor of n (not equal to n, of course). For example, if n\xe2\x80\x89=\xe2\x80\x896 then Funt has to pay 3 burles, while for n\xe2\x80\x89=\xe2\x80\x8925 he needs to pay 5 and if n\xe2\x80\x89=\xe2\x80\x892 he pays only 1 burle.As mr. Funt is a very opportunistic person he wants to cheat a bit. In particular, he wants to split the initial n in several parts n1\xe2\x80\x89+\xe2\x80\x89n2\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89nk\xe2\x80\x89=\xe2\x80\x89n (here k is arbitrary, even k\xe2\x80\x89=\xe2\x80\x891 is allowed) and pay the taxes for each part separately. He can\'t make some part equal to 1 because it will reveal him. So, the condition ni\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x892 should hold for all i from 1 to k.Ostap Bender wonders, how many money Funt has to pay (i.e. minimal) if he chooses and optimal way to split n in parts." 1600

735C "Tennis Championship" "combinatorics,constructive algorithms,greedy,math" "Famous Brazil city Rio de Janeiro holds a tennis tournament and Ostap Bender doesn\'t want to miss this event. There will be n players participating, and the tournament will follow knockout rules from the very first game. That means, that if someone loses a game he leaves the tournament immediately.Organizers are still arranging tournament grid (i.e. the order games will happen and who is going to play with whom) but they have already fixed one rule: two players can play against each other only if the number of games one of them has already played differs by no more than one from the number of games the other one has already played. Of course, both players had to win all their games in order to continue participating in the tournament.Tournament hasn\'t started yet so the audience is a bit bored. Ostap decided to find out what is the maximum number of games the winner of the tournament can take part in (assuming the rule above is used). However, it is unlikely he can deal with this problem without your help." 1600

735B Urbanization "greedy,number theory,sortings" "Local authorities have heard a lot about combinatorial abilities of Ostap Bender so they decided to ask his help in the question of urbanization. There are n people who plan to move to the cities. The wealth of the i of them is equal to ai. Authorities plan to build two cities, first for n1 people and second for n2 people. Of course, each of n candidates can settle in only one of the cities. Thus, first some subset of candidates of size n1 settle in the first city and then some subset of size n2 is chosen among the remaining candidates and the move to the second city. All other candidates receive an official refuse and go back home.To make the statistic of local region look better in the eyes of their bosses, local authorities decided to pick subsets of candidates in such a way that the sum of arithmetic mean of wealth of people in each of the cities is as large as possible. Arithmetic mean of wealth in one city is the sum of wealth ai among all its residents divided by the number of them (n1 or n2 depending on the city). The division should be done in real numbers without any rounding.Please, help authorities find the optimal way to pick residents for two cities." 1100

735A "Ostap and Grasshopper" implementation,strings "On the way to Rio de Janeiro Ostap kills time playing with a grasshopper he took with him in a special box. Ostap builds a line of length n such that some cells of this line are empty and some contain obstacles. Then, he places his grasshopper to one of the empty cells and a small insect in another empty cell. The grasshopper wants to eat the insect.Ostap knows that grasshopper is able to jump to any empty cell that is exactly k cells away from the current (to the left or to the right). Note that it doesn\'t matter whether intermediate cells are empty or not as the grasshopper makes a jump over them. For example, if k\xe2\x80\x89=\xe2\x80\x891 the grasshopper can jump to a neighboring cell only, and if k\xe2\x80\x89=\xe2\x80\x892 the grasshopper can jump over a single cell.Your goal is to determine whether there is a sequence of jumps such that grasshopper will get from his initial position to the cell with an insect." 800

734F "Anton and School" "bitmasks,constructive algorithms,implementation,math" "Anton goes to school, his favorite lessons are arraystudying. He usually solves all the tasks pretty fast, but this time the teacher gave him a complicated one: given two arrays b and c of length n, find array a, such that:where a�and�b means bitwise AND, while a�or�b means bitwise OR.Usually Anton is good in arraystudying, but this problem is too hard, so Anton asks you to help." 2500

734E "Anton and Tree" "dfs and similar,dp,trees" "Anton is growing a tree in his garden. In case you forgot, the tree is a connected acyclic undirected graph.There are n vertices in the tree, each of them is painted black or white. Anton doesn\'t like multicolored trees, so he wants to change the tree such that all vertices have the same color (black or white).To change the colors Anton can use only operations of one type. We denote it as paint(v), where v is some vertex of the tree. This operation changes the color of all vertices u such that all vertices on the shortest path from v to u have the same color (including v and u). For example, consider the tree  and apply operation paint(3) to get the following:  Anton is interested in the minimum number of operation he needs to perform in order to make the colors of all vertices equal." 2100

734D "Anton and Chess" implementation "Anton likes to play chess. Also, he likes to do programming. That is why he decided to write the program that plays chess. However, he finds the game on 8 to 8 board to too simple, he uses an infinite one instead.The first task he faced is to check whether the king is in check. Anton doesn\'t know how to implement this so he asks you to help.Consider that an infinite chess board contains one white king and the number of black pieces. There are only rooks, bishops and queens, as the other pieces are not supported yet. The white king is said to be in check if at least one black piece can reach the cell with the king in one move. Help Anton and write the program that for the given position determines whether the white king is in check.Remainder, on how do chess pieces move:   Bishop moves any number of cells diagonally, but it can\'t ""leap"" over the occupied cells.  Rook moves any number of cells horizontally or vertically, but it also can\'t ""leap"" over the occupied cells.  Queen is able to move any number of cells horizontally, vertically or diagonally, but it also can\'t ""leap""." 1700

734C "Anton and Making Potions" "binary search,dp,greedy,two pointers" "Anton is playing a very interesting computer game, but now he is stuck at one of the levels. To pass to the next level he has to prepare n potions.Anton has a special kettle, that can prepare one potions in x seconds. Also, he knows spells of two types that can faster the process of preparing potions.  Spells of this type speed up the preparation time of one potion. There are m spells of this type, the i-th of them costs bi manapoints and changes the preparation time of each potion to ai instead of x.  Spells of this type immediately prepare some number of potions. There are k such spells, the i-th of them costs di manapoints and instantly create ci potions. Anton can use no more than one spell of the first type and no more than one spell of the second type, and the total number of manapoints spent should not exceed s. Consider that all spells are used instantly and right before Anton starts to prepare potions.Anton wants to get to the next level as fast as possible, so he is interested in the minimum number of time he needs to spent in order to prepare at least n potions." 1600

734B "Anton and Digits" "brute force,greedy,implementation,math" "Recently Anton found a box with digits in his room. There are k2 digits 2, k3 digits 3, k5 digits 5 and k6 digits 6.Anton\'s favorite integers are 32 and 256. He decided to compose this integers from digits he has. He wants to make the sum of these integers as large as possible. Help him solve this task!Each digit can be used no more than once, i.e. the composed integers should contain no more than k2 digits 2, k3 digits 3 and so on. Of course, unused digits are not counted in the sum." 800

734A "Anton and Danik" implementation,strings "Anton likes to play chess, and so does his friend Danik.Once they have played n games in a row. For each game it\'s known who was the winner�\xe2\x80\x94 Anton or Danik. None of the games ended with a tie.Now Anton wonders, who won more games, he or Danik? Help him determine this." 800

733F "Drivers Dissatisfaction" "data structures,dsu,graphs,trees" "In one kingdom there are n cities and m two-way roads. Each road connects a pair of cities, and for each road we know the level of drivers dissatisfaction�\xe2\x80\x94 the value wi.For each road we know the value ci�\xe2\x80\x94 how many lamziks we should spend to reduce the level of dissatisfaction with this road by one. Thus, to reduce the dissatisfaction with the i-th road by k, we should spend k\xc2\xb7ci lamziks. And it is allowed for the dissatisfaction to become zero or even negative.In accordance with the king\'s order, we need to choose n\xe2\x80\x89-\xe2\x80\x891 roads and make them the main roads. An important condition must hold: it should be possible to travel from any city to any other by the main roads.The road ministry has a budget of S lamziks for the reform. The ministry is going to spend this budget for repair of some roads (to reduce the dissatisfaction with them), and then to choose the n\xe2\x80\x89-\xe2\x80\x891 main roads.Help to spend the budget in such a way and then to choose the main roads so that the total dissatisfaction with the main roads will be as small as possible. The dissatisfaction with some roads can become negative. It is not necessary to spend whole budget S.It is guaranteed that it is possible to travel from any city to any other using existing roads. Each road in the kingdom is a two-way road." 2200

733E "Sleep in Class" "constructive algorithms,data structures,math,two pointers" "The academic year has just begun, but lessons and olympiads have already occupied all the free time. It is not a surprise that today Olga fell asleep on the Literature. She had a dream in which she was on a stairs. The stairs consists of n steps. The steps are numbered from bottom to top, it means that the lowest step has number 1, and the highest step has number n. Above each of them there is a pointer with the direction (up or down) Olga should move from this step. As soon as Olga goes to the next step, the direction of the pointer (above the step she leaves) changes. It means that the direction ""up"" changes to ""down"", the direction ""down"" �\xe2\x80\x94� to the direction ""up"".Olga always moves to the next step in the direction which is shown on the pointer above the step. If Olga moves beyond the stairs, she will fall and wake up. Moving beyond the stairs is a moving down from the first step or moving up from the last one (it means the n-th) step. In one second Olga moves one step up or down according to the direction of the pointer which is located above the step on which Olga had been at the beginning of the second. For each step find the duration of the dream if Olga was at this step at the beginning of the dream.Olga\'s fall also takes one second, so if she was on the first step and went down, she would wake up in the next second." 2400

733D "Kostya the Sculptor" "data structures,hashing" "Kostya is a genial sculptor, he has an idea: to carve a marble sculpture in the shape of a sphere. Kostya has a friend Zahar who works at a career. Zahar knows about Kostya\'s idea and wants to present him a rectangular parallelepiped of marble from which he can carve the sphere. Zahar has n stones which are rectangular parallelepipeds. The edges sizes of the i-th of them are ai, bi and ci. He can take no more than two stones and present them to Kostya. If Zahar takes two stones, he should glue them together on one of the faces in order to get a new piece of rectangular parallelepiped of marble. Thus, it is possible to glue a pair of stones together if and only if two faces on which they are glued together match as rectangles. In such gluing it is allowed to rotate and flip the stones in any way. Help Zahar choose such a present so that Kostya can carve a sphere of the maximum possible volume and present it to Zahar." 1600

733C "Epidemic in Monstropolis" "constructive algorithms,dp,greedy,two pointers" "There was an epidemic in Monstropolis and all monsters became sick. To recover, all monsters lined up in queue for an appointment to the only doctor in the city.Soon, monsters became hungry and began to eat each other. One monster can eat other monster if its weight is strictly greater than the weight of the monster being eaten, and they stand in the queue next to each other. Monsters eat each other instantly. There are no monsters which are being eaten at the same moment. After the monster A eats the monster B, the weight of the monster A increases by the weight of the eaten monster B. In result of such eating the length of the queue decreases by one, all monsters after the eaten one step forward so that there is no empty places in the queue again. A monster can eat several monsters one after another. Initially there were n monsters in the queue, the i-th of which had weight ai.For example, if weights are [1,\xe2\x80\x892,\xe2\x80\x892,\xe2\x80\x892,\xe2\x80\x891,\xe2\x80\x892] (in order of queue, monsters are numbered from 1 to 6 from left to right) then some of the options are:  the first monster can\'t eat the second monster because a1\xe2\x80\x89=\xe2\x80\x891 is not greater than a2\xe2\x80\x89=\xe2\x80\x892;  the second monster can\'t eat the third monster because a2\xe2\x80\x89=\xe2\x80\x892 is not greater than a3\xe2\x80\x89=\xe2\x80\x892;  the second monster can\'t eat the fifth monster because they are not neighbors;  the second monster can eat the first monster, the queue will be transformed to [3,\xe2\x80\x892,\xe2\x80\x892,\xe2\x80\x891,\xe2\x80\x892]. After some time, someone said a good joke and all monsters recovered. At that moment there were k (k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) monsters in the queue, the j-th of which had weight bj. Both sequences (a and b) contain the weights of the monsters in the order from the first to the last.You are required to provide one of the possible orders of eating monsters which led to the current queue, or to determine that this could not happen. Assume that the doctor didn\'t make any appointments while monsters were eating each other." 1800

733B Parade math "Very soon there will be a parade of victory over alien invaders in Berland. Unfortunately, all soldiers died in the war and now the army consists of entirely new recruits, many of whom do not even know from which leg they should begin to march. The civilian population also poorly understands from which leg recruits begin to march, so it is only important how many soldiers march in step.There will be n columns participating in the parade, the i-th column consists of li soldiers, who start to march from left leg, and ri soldiers, who start to march from right leg.The beauty of the parade is calculated by the following formula: if L is the total number of soldiers on the parade who start to march from the left leg, and R is the total number of soldiers on the parade who start to march from the right leg, so the beauty will equal |L\xe2\x80\x89-\xe2\x80\x89R|.No more than once you can choose one column and tell all the soldiers in this column to switch starting leg, i.e. everyone in this columns who starts the march from left leg will now start it from right leg, and vice versa. Formally, you can pick no more than one index i and swap values li and ri. Find the index of the column, such that switching the starting leg for soldiers in it will maximize the the beauty of the parade, or determine, that no such operation can increase the current beauty." 1100

733A "Grasshopper And the String" implementation "One day, the Grasshopper was jumping on the lawn and found a piece of paper with a string. Grasshopper became interested what is the minimum jump ability he should have in order to be able to reach the far end of the string, jumping only on vowels of the English alphabet. Jump ability is the maximum possible length of his jump. Formally, consider that at the begginning the Grasshopper is located directly in front of the leftmost character of the string. His goal is to reach the position right after the rightmost character of the string. In one jump the Grasshopper could jump to the right any distance from 1 to the value of his jump ability.  The picture corresponds to the first example. The following letters are vowels: \'A\', \'E\', \'I\', \'O\', \'U\' and \'Y\'." 1000

732F "Tourist Reform" "dfs and similar,graphs" "Berland is a tourist country! At least, it can become such�\xe2\x80\x94 the government of Berland is confident about this. There are n cities in Berland, some pairs of which are connected by two-ways roads. Each road connects two different cities. In Berland there are no roads which connect the same pair of cities. It is possible to get from any city to any other city using given two-ways roads. According to the reform each road will become one-way. It will be oriented to one of two directions.To maximize the tourist attraction of Berland, after the reform for each city i the value ri will be calculated. It will equal to the number of cities x for which there is an oriented path from the city i to the city x. In other words, ri will equal the number of cities which can be reached from the city i by roads. The government is sure that tourist\'s attention will be focused on the minimum value of ri.Help the government of Berland make the reform to maximize the minimum of ri." 2300

732E Sockets greedy,sortings "The ICM ACPC World Finals is coming! Unfortunately, the organizers of the competition were so busy preparing tasks that totally missed an important technical point \xe2\x80\x94 the organization of electricity supplement for all the participants workstations.There are n computers for participants, the i-th of which has power equal to positive integer pi. At the same time there are m sockets available, the j-th of which has power euqal to positive integer sj. It is possible to connect the i-th computer to the j-th socket if and only if their powers are the same: pi\xe2\x80\x89=\xe2\x80\x89sj. It is allowed to connect no more than one computer to one socket. Thus, if the powers of all computers and sockets are distinct, then no computer can be connected to any of the sockets. In order to fix the situation professor Puch Williams urgently ordered a wagon of adapters�\xe2\x80\x94 power splitters. Each adapter has one plug and one socket with a voltage divider between them. After plugging an adapter to a socket with power x, the power on the adapter\'s socket becomes equal to , it means that it is equal to the socket\'s power divided by two with rounding up, for example  and .Each adapter can be used only once. It is possible to connect several adapters in a chain plugging the first to a socket. For example, if two adapters are plugged one after enother to a socket with power 10, it becomes possible to connect one computer with power 3 to this socket.The organizers should install adapters so that it will be possible to supply with electricity the maximum number of computers c at the same time. If there are several possible connection configurations, they want to find the one that uses the minimum number of adapters u to connect c computers.Help organizers calculate the maximum number of connected computers c and the minimum number of adapters u needed for this.The wagon of adapters contains enough of them to do the task. It is guaranteed that it\'s possible to connect at least one computer." 2100

732D Exams "binary search,greedy,sortings" "Vasiliy has an exam period which will continue for n days. He has to pass exams on m subjects. Subjects are numbered from 1 to m.About every day we know exam for which one of m subjects can be passed on that day. Perhaps, some day you can\'t pass any exam. It is not allowed to pass more than one exam on any day. On each day Vasiliy can either pass the exam of that day (it takes the whole day) or prepare all day for some exam or have a rest. About each subject Vasiliy know a number ai�\xe2\x80\x94 the number of days he should prepare to pass the exam number i. Vasiliy can switch subjects while preparing for exams, it is not necessary to prepare continuously during ai days for the exam number i. He can mix the order of preparation for exams in any way.Your task is to determine the minimum number of days in which Vasiliy can pass all exams, or determine that it is impossible. Each exam should be passed exactly one time." 1700

732C Sanatorium "binary search,constructive algorithms,greedy,implementation,math" "Vasiliy spent his vacation in a sanatorium, came back and found that he completely forgot details of his vacation! Every day there was a breakfast, a dinner and a supper in a dining room of the sanatorium (of course, in this order). The only thing that Vasiliy has now is a card from the dining room contaning notes how many times he had a breakfast, a dinner and a supper (thus, the card contains three integers). Vasiliy could sometimes have missed some meal, for example, he could have had a breakfast and a supper, but a dinner, or, probably, at some days he haven\'t been at the dining room at all.Vasiliy doesn\'t remember what was the time of the day when he arrived to sanatorium (before breakfast, before dinner, before supper or after supper), and the time when he left it (before breakfast, before dinner, before supper or after supper). So he considers any of these options. After Vasiliy arrived to the sanatorium, he was there all the time until he left. Please note, that it\'s possible that Vasiliy left the sanatorium on the same day he arrived.According to the notes in the card, help Vasiliy determine the minimum number of meals in the dining room that he could have missed. We shouldn\'t count as missed meals on the arrival day before Vasiliy\'s arrival and meals on the departure day after he left." 1200

732B "Cormen --- The Best Friend Of a Man" dp,greedy "Recently a dog was bought for Polycarp. The dog\'s name is Cormen. Now Polycarp has a lot of troubles. For example, Cormen likes going for a walk. Empirically Polycarp learned that the dog needs at least k walks for any two consecutive days in order to feel good. For example, if k\xe2\x80\x89=\xe2\x80\x895 and yesterday Polycarp went for a walk with Cormen 2 times, today he has to go for a walk at least 3 times. Polycarp analysed all his affairs over the next n days and made a sequence of n integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an, where ai is the number of times Polycarp will walk with the dog on the i-th day while doing all his affairs (for example, he has to go to a shop, throw out the trash, etc.).Help Polycarp determine the minimum number of walks he needs to do additionaly in the next n days so that Cormen will feel good during all the n days. You can assume that on the day before the first day and on the day after the n-th day Polycarp will go for a walk with Cormen exactly k times. Write a program that will find the minumum number of additional walks and the appropriate schedule�\xe2\x80\x94 the sequence of integers b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bn (bi\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89ai), where bi means the total number of walks with the dog on the i-th day." 1000

732A "Buy a Shovel" "brute force,constructive algorithms,implementation,math" "Polycarp urgently needs a shovel! He comes to the shop and chooses an appropriate one. The shovel that Policarp chooses is sold for k burles. Assume that there is an unlimited number of such shovels in the shop.In his pocket Polycarp has an unlimited number of ""10-burle coins"" and exactly one coin of r burles (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x899).What is the minimum number of shovels Polycarp has to buy so that he can pay for the purchase without any change? It is obvious that he can pay for 10 shovels without any change (by paying the requied amount of 10-burle coins and not using the coin of r burles). But perhaps he can buy fewer shovels and pay without any change. Note that Polycarp should buy at least one shovel." 800

731F "Video Cards" "brute force,data structures,implementation,math,number theory" "Little Vlad is fond of popular computer game Bota-2. Recently, the developers announced the new add-on named Bota-3. Of course, Vlad immediately bought only to find out his computer is too old for the new game and needs to be updated.There are n video cards in the shop, the power of the i-th video card is equal to integer value ai. As Vlad wants to be sure the new game will work he wants to buy not one, but several video cards and unite their powers using the cutting-edge technology. To use this technology one of the cards is chosen as the leading one and other video cards are attached to it as secondary. For this new technology to work it\'s required that the power of each of the secondary video cards is divisible by the power of the leading video card. In order to achieve that the power of any secondary video card can be reduced to any integer value less or equal than the current power. However, the power of the leading video card should remain unchanged, i.e. it can\'t be reduced.Vlad has an infinite amount of money so he can buy any set of video cards. Help him determine which video cards he should buy such that after picking the leading video card and may be reducing some powers of others to make them work together he will get the maximum total value of video power." 1900

731E "Funny Game" dp,games "Once upon a time Petya and Gena gathered after another programming competition and decided to play some game. As they consider most modern games to be boring, they always try to invent their own games. They have only stickers and markers, but that won\'t stop them.The game they came up with has the following rules. Initially, there are n stickers on the wall arranged in a row. Each sticker has some number written on it. Now they alternate turn, Petya moves first.One move happens as follows. Lets say there are m\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x892 stickers on the wall. The player, who makes the current move, picks some integer k from 2 to m and takes k leftmost stickers (removes them from the wall). After that he makes the new sticker, puts it to the left end of the row, and writes on it the new integer, equal to the sum of all stickers he took on this move. Game ends when there is only one sticker left on the wall. The score of the player is equal to the sum of integers written on all stickers he took during all his moves. The goal of each player is to maximize the difference between his score and the score of his opponent.Given the integer n and the initial sequence of stickers on the wall, define the result of the game, i.e. the difference between the Petya\'s and Gena\'s score if both players play optimally." 2200

731D "80-th Level Archeology" "brute force,data structures,greedy,sortings" "Archeologists have found a secret pass in the dungeon of one of the pyramids of Cycleland. To enter the treasury they have to open an unusual lock on the door. The lock consists of n words, each consisting of some hieroglyphs. The wall near the lock has a round switch. Each rotation of this switch changes the hieroglyphs according to some rules. The instruction nearby says that the door will open only if words written on the lock would be sorted in lexicographical order (the definition of lexicographical comparison in given in notes section).The rule that changes hieroglyphs is the following. One clockwise rotation of the round switch replaces each hieroglyph with the next hieroglyph in alphabet, i.e. hieroglyph x (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89c\xe2\x80\x89-\xe2\x80\x891) is replaced with hieroglyph (x\xe2\x80\x89+\xe2\x80\x891), and hieroglyph c is replaced with hieroglyph 1.Help archeologist determine, how many clockwise rotations they should perform in order to open the door, or determine that this is impossible, i.e. no cyclic shift of the alphabet will make the sequence of words sorted lexicographically." 2200

731C Socks "dfs and similar,dsu,graphs,greedy" "Arseniy is already grown-up and independent. His mother decided to leave him alone for m days and left on a vacation. She have prepared a lot of food, left some money and washed all Arseniy\'s clothes. Ten minutes before her leave she realized that it would be also useful to prepare instruction of which particular clothes to wear on each of the days she will be absent. Arseniy\'s family is a bit weird so all the clothes is enumerated. For example, each of Arseniy\'s n socks is assigned a unique integer from 1 to n. Thus, the only thing his mother had to do was to write down two integers li and ri for each of the days�\xe2\x80\x94 the indices of socks to wear on the day i (obviously, li stands for the left foot and ri for the right). Each sock is painted in one of k colors.When mother already left Arseniy noticed that according to instruction he would wear the socks of different colors on some days. Of course, that is a terrible mistake cause by a rush. Arseniy is a smart boy, and, by some magical coincidence, he posses k jars with the paint�\xe2\x80\x94 one for each of k colors.Arseniy wants to repaint some of the socks in such a way, that for each of m days he can follow the mother\'s instructions and wear the socks of the same color. As he is going to be very busy these days he will have no time to change the colors of any socks so he has to finalize the colors now.The new computer game Bota-3 was just realised and Arseniy can\'t wait to play it. What is the minimum number of socks that need their color to be changed in order to make it possible to follow mother\'s instructions and wear the socks of the same color during each of m days." 1600

731B "Coupons and Discounts" "constructive algorithms,greedy" "The programming competition season has already started and it\'s time to train for ICPC. Sereja coaches his teams for a number of year and he knows that to get ready for the training session it\'s not enough to prepare only problems and editorial. As the training sessions lasts for several hours, teams become hungry. Thus, Sereja orders a number of pizzas so they can eat right after the end of the competition.Teams plan to train for n times during n consecutive days. During the training session Sereja orders exactly one pizza for each team that is present this day. He already knows that there will be ai teams on the i-th day.There are two types of discounts in Sereja\'s favourite pizzeria. The first discount works if one buys two pizzas at one day, while the second is a coupon that allows to buy one pizza during two consecutive days (two pizzas in total).As Sereja orders really a lot of pizza at this place, he is the golden client and can use the unlimited number of discounts and coupons of any type at any days.Sereja wants to order exactly ai pizzas on the i-th day while using only discounts and coupons. Note, that he will never buy more pizzas than he need for this particular day. Help him determine, whether he can buy the proper amount of pizzas each day if he is allowed to use only coupons and discounts. Note, that it\'s also prohibited to have any active coupons after the end of the day n." 1100

731A "Night at the Museum" implementation,strings "Grigoriy, like the hero of one famous comedy film, found a job as a night security guard at the museum. At first night he received embosser and was to take stock of the whole exposition.Embosser is a special devise that allows to ""print"" the text of a plastic tape. Text is printed sequentially, character by character. The device consists of a wheel with a lowercase English letters written in a circle, static pointer to the current letter and a button that print the chosen letter. At one move it\'s allowed to rotate the alphabetic wheel one step clockwise or counterclockwise. Initially, static pointer points to letter \'a\'. Other letters are located as shown on the picture:  After Grigoriy add new item to the base he has to print its name on the plastic tape and attach it to the corresponding exhibit. It\'s not required to return the wheel to its initial position with pointer on the letter \'a\'.Our hero is afraid that some exhibits may become alive and start to attack him, so he wants to print the names as fast as possible. Help him, for the given string find the minimum number of rotations of the wheel required to print it." 800

730L "Expression Queries" "data structures" "A simplified arithmetic expression (SAE) is an arithmetic expression defined by the following grammar:  <SAE> ::= <Number> | <SAE>+<SAE> | <SAE>*<SAE> | (<SAE>)  <Number> ::= <Digit> | <Digit><Number>  <Digit> ::= 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 In other words it\'s a correct arithmetic expression that is allowed to contain brackets, numbers (possibly with leading zeros), multiplications and additions. For example expressions ""(0+01)"", ""0"" and ""1*(0)"" are simplified arithmetic expressions, but expressions ""2-1"", ""+1"" and ""1+2)"" are not.Given a string s1s2...s|s| that represents a SAE; si denotes the i-th character of the string which can be either a digit (\'0\'-\'9\'), a plus sign (\'+\'), a multiplication sign (\'*\'), an opening round bracket \'(\' or a closing round bracket \')\'.A part slsl\xe2\x80\x89+\xe2\x80\x891...sr of this string is called a sub-expression if and only if it is a SAE.You task is to answer m queries, each of which is a pair of integers li, ri (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89li\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ri\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|s|). For each query determine whether the corresponding part of the given string is a sub-expression and in case it\'s a sub-expression calculate its value modulo 1000000007�(109\xe2\x80\x89+\xe2\x80\x897). The values should be calculated using standard operator priorities." 3200

730K "Roads Orientation Problem" graphs "Berland consists of n cities and m bidirectional roads connecting pairs of cities. There is no road connecting a city to itself, and between any pair of cities there is no more than one road. It is possible to reach any city from any other moving along roads.Currently Mr. President is in the city s and his destination is the city t. He plans to move along roads from s to t (s\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89t).That\'s why Ministry of Fools and Roads has difficult days. The minister is afraid that Mr. President could get into a traffic jam or get lost. Who knows what else can happen!To be sure that everything goes as planned, the minister decided to temporarily make all roads one-way. So each road will be oriented in one of two possible directions. The following conditions must be satisfied:  There should be no cycles along roads after orientation.  The city s should be the only such city that all its roads are oriented out (i.e. there are no ingoing roads to the city s and the city s is the only such city).  The city t should be the only such city that all its roads are oriented in (i.e. there are no outgoing roads from the city t and the city t is the only such city). Help the minister solve his problem. Write a program to find any such orientation of all roads or report that no solution exists." 3200

730J Bottles dp "Nick has n bottles of soda left after his birthday. Each bottle is described by two values: remaining amount of soda ai and bottle volume bi (ai\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89bi).Nick has decided to pour all remaining soda into minimal number of bottles, moreover he has to do it as soon as possible. Nick spends x seconds to pour x units of soda from one bottle to another.Nick asks you to help him to determine k \xe2\x80\x94 the minimal number of bottles to store all remaining soda and t \xe2\x80\x94 the minimal time to pour soda into k bottles. A bottle can\'t store more soda than its volume. All remaining soda should be saved." 1900

730I "Olympiad in Programming and Sports" dp,flows,graphs,greedy "There are n students at Berland State University. Every student has two skills, each measured as a number: ai \xe2\x80\x94 the programming skill and bi \xe2\x80\x94 the sports skill.It is announced that an Olympiad in programming and sports will be held soon. That\'s why Berland State University should choose two teams: one to take part in the programming track and one to take part in the sports track.There should be exactly p students in the programming team and exactly s students in the sports team. A student can\'t be a member of both teams.The university management considers that the strength of the university on the Olympiad is equal to the sum of two values: the programming team strength and the sports team strength. The strength of a team is the sum of skills of its members in the corresponding area, so the strength of the programming team is the sum of all ai and the strength of the sports team is the sum of all bi over corresponding team members.Help Berland State University to compose two teams to maximize the total strength of the university on the Olympiad." 2000

730H "Delete Them" "constructive algorithms,implementation" "Polycarp is a beginner programmer. He is studying how to use a command line.Polycarp faced the following problem. There are n files in a directory and he needs to delete some of them. Polycarp wants to run a single delete command with filename pattern as an argument. All the files to be deleted should match the pattern and all other files shouldn\'t match the pattern.Polycarp doesn\'t know about an asterisk \'*\', the only special character he knows is a question mark \'?\' which matches any single character. All other characters in the pattern match themselves only.Formally, a pattern matches a filename if and only if they have equal lengths and all characters in the corresponding positions are equal except when the character in the pattern is \'?\', in which case the corresponding filename character does not matter.For example, the filename pattern ""a?ba?"":  matches filenames ""aabaa"", ""abba."", ""a.ba9"" and ""a.ba."";  does not match filenames ""aaba"", ""abaab"", ""aabaaa"" and ""aabaa."". Help Polycarp find a pattern which matches files to be deleted and only them or report if there is no such pattern." 1300

730G "Car Repair Shop" implementation "Polycarp starts his own business. Tomorrow will be the first working day of his car repair shop. For now the car repair shop is very small and only one car can be repaired at a given time.Polycarp is good at marketing, so he has already collected n requests from clients. The requests are numbered from 1 to n in order they came.The i-th request is characterized by two values: si \xe2\x80\x94 the day when a client wants to start the repair of his car, di \xe2\x80\x94 duration (in days) to repair the car. The days are enumerated from 1, the first day is tomorrow, the second day is the day after tomorrow and so on.Polycarp is making schedule by processing requests in the order from the first to the n-th request. He schedules the i-th request as follows:  If the car repair shop is idle for di days starting from si (si,\xe2\x80\x89si\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89si\xe2\x80\x89+\xe2\x80\x89di\xe2\x80\x89-\xe2\x80\x891), then these days are used to repair a car of the i-th client.  Otherwise, Polycarp finds the first day x (from 1 and further) that there are di subsequent days when no repair is scheduled starting from x. In other words he chooses the smallest positive x that all days x,\xe2\x80\x89x\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89x\xe2\x80\x89+\xe2\x80\x89di\xe2\x80\x89-\xe2\x80\x891 are not scheduled for repair of any car. So, the car of the i-th client will be repaired in the range [x,\xe2\x80\x89x\xe2\x80\x89+\xe2\x80\x89di\xe2\x80\x89-\xe2\x80\x891]. It is possible that the day x when repair is scheduled to start will be less than si. Given n requests, you are asked to help Polycarp schedule all of them according to the rules above." 1600

730F "Ber Patio" NA "Polycarp is a regular customer at the restaurant ""Ber Patio"". He likes having lunches there.""Ber Patio"" has special discount program for regular customers. A customer can collect bonuses and partially cover expenses in the restaurant.Let\'s assume a customer currently has b bonuses and she has to pay r burles for a lunch. In this case the customer can use bonuses (1 bonus = 1 burle) to reduce the payment. She can cover at most half of the payment using bonuses. However, 1 bonus will be added to the customer\'s bonus balance per each 10 burles she paid.Formally:  a customer can choose any number x of bonuses to use ()),  the customer\'s bonus balance is reduced by x,  the customer pays r\xe2\x80\x89-\xe2\x80\x89x burles,  the customer\'s bonus balance is increased by \xe2\x8c\x8a(r\xe2\x80\x89-\xe2\x80\x89x)\xe2\x80\x89/\xe2\x80\x8910\xe2\x8c\x8b (i.e. integer division rounded down is used). Initially, there are b bonuses on Polycarp\'s account. Polycarp is going to have a lunch in ""Ber Patio"" for the next n days. He estimated the values a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an, where ai is the number of burles in a receipt for the i-th day. The sum over all receipts doesn\'t exceed 105 burles.Write a program to find the minimum number of burles Polycarp has to spend and an optimal strategy to use bonuses." 3100

730E "Award Ceremony" greedy,implementation "All-Berland programming contest comes to an end. In total, n teams participated in it. Like in ACM-ICPC, current results stopped refreshing one hour before the contest ends. So at the Award Ceremony, results are partially known. For each team the value ai is given \xe2\x80\x94 the number of points the i-th team has earned before the last hour of the contest. Besides that, the Jury has evaluated all submissions sent during the last hour and knows values di \xe2\x80\x94 the number of points earned by the i-th team during the last hour (these values can be negative, which means that a team can lose points).Before the contest, each team got unique id from 1 to n. According to the contest rules, a team with more points takes a higher place. If two or more teams have equal number of points, the team with lower id will take the higher place. So no two teams can share the same place.The Award Ceremony proceeds in the following way. At the beginning of the ceremony, a large screen shows the results for the time moment ""one hour before the end"", which means that the i-th team has ai points. Then the Jury unfreezes results of the teams one by one in some order. When result of the j-th team is unfrozen, its score changes from aj to aj\xe2\x80\x89+\xe2\x80\x89dj. At this time the table of results is modified and the place of the team can change. The unfreezing of the j-th team is followed by the applause from the audience with duration of |xj\xe2\x80\x89-\xe2\x80\x89yj| seconds, where xj is the place of the j-th team before unfreezing and yj is the place right after the unfreezing. For example, if the team does not change the place, there is no applause from the audience. As you can see, during the Award Ceremony, each team will be unfrozen exactly once.Your task is to find such an order to unfreeze all the teams that the total duration of applause is maximum possible." 2200

730D "Running Over The Bridges" greedy,implementation,math "Polycarp is playing a game called ""Running Over The Bridges"". In this game he has to run over n bridges from the left to the right. Bridges are arranged one after the other, so the i-th bridge begins where the (i\xe2\x80\x89-\xe2\x80\x891)-th bridge ends.You have the following data about bridges: li and ti \xe2\x80\x94 the length of the i-th bridge and the maximum allowed time which Polycarp can spend running over the i-th bridge. Thus, if Polycarp is in the beginning of the bridge i at the time T then he has to leave it at the time T\xe2\x80\x89+\xe2\x80\x89ti or earlier. It is allowed to reach the right end of a bridge exactly at the time T\xe2\x80\x89+\xe2\x80\x89ti.Polycarp can run from the left side to the right one with speed 0.5, so he will run over a bridge with length s in time 2\xc2\xb7s. Besides, he has several magical drinks. If he uses one drink, his speed increases twice (i.e. to value 1) for r seconds. All magical drinks are identical. Please note that Polycarp can use a drink only at integer moments of time, and he drinks it instantly and completely. Additionally, if Polycarp uses a drink at the moment T he can use the next drink not earlier than at the moment T\xe2\x80\x89+\xe2\x80\x89r.What is the minimal number of drinks Polycarp has to use to run over all n bridges? If this number is not greater than 105, then you have to find out the moments of time when Polycarp has to use each magical drink." 2200

730C Bulmart "binary search,dfs and similar" "A new trade empire is rising in Berland. Bulmart, an emerging trade giant, decided to dominate the market of ... shovels! And now almost every city in Berland has a Bulmart store, and some cities even have several of them! The only problem is, at the moment sales are ... let\'s say a little below estimates. Some people even say that shovels retail market is too small for such a big company to make a profit. But the company management believes in the future of that market and seeks new ways to increase income. There are n cities in Berland connected with m bi-directional roads. All roads have equal lengths. It can happen that it is impossible to reach a city from another city using only roads. There is no road which connects a city to itself. Any pair of cities can be connected by at most one road.There are w Bulmart stores in Berland. Each of them is described by three numbers:   ci \xe2\x80\x94 the number of city where the i-th store is located (a city can have no stores at all or have several of them),  ki \xe2\x80\x94 the number of shovels in the i-th store,  pi \xe2\x80\x94 the price of a single shovel in the i-th store (in burles). The latest idea of the Bulmart management is to create a program which will help customers get shovels as fast as possible for affordable budget. Formally, the program has to find the minimum amount of time needed to deliver rj shovels to the customer in the city gj for the total cost of no more than aj burles. The delivery time between any two adjacent cities is equal to 1. If shovels are delivered from several cities, the delivery time is equal to the arrival time of the last package. The delivery itself is free of charge.The program needs to find answers to q such queries. Each query has to be processed independently from others, i.e. a query does not change number of shovels in stores for the next queries." 2100

730B "Minimum and Maximum" "constructive algorithms,interactive" "This is an interactive problem. You have to use flush operation right after printing each line. For example, in C++ you should use function fflush(stdout), in Java \xe2\x80\x94 System.out.flush(), in Pascal \xe2\x80\x94 flush(output) and in Python \xe2\x80\x94 sys.stdout.flush().In this problem, you need to find maximal and minimal elements of an array. What could be simpler?You can imagine that the jury has an array, and initially you know the only number n \xe2\x80\x94 array\'s length.Array\'s elements are numbered from 1 to n. You are allowed to compare two elements of the array by using their indices i and j. There are three possible responses to this query: \'<\' (if ai is less than aj), \'=\' (if ai is equal to aj) and finally \'>\' (if ai is greater than aj).It\'s known that it\'s always possible to find both maximal and minimal elements of the array by using no more than  comparisons, where \xe2\x8c\x88 x\xe2\x8c\x89 is the result of rounding x up.Write the program that will find positions of the minimum and the maximum in the jury\'s array of length n, by using no more than f(n) comparisons." 1800

730A "Toda 2" greedy,implementation "A group of n friends enjoys playing popular video game Toda 2. There is a rating system describing skill level of each player, initially the rating of the i-th friend is ri.The friends decided to take part in the championship as a team. But they should have equal ratings to be allowed to compose a single team consisting of all n friends. So the friends are faced with the problem: how to make all their ratings equal.One way to change ratings is to willingly lose in some matches. Friends can form a party consisting of two to five (but not more than n) friends and play a match in the game. When the party loses, the rating of each of its members decreases by 1. A rating can\'t become negative, so ri\xe2\x80\x89=\xe2\x80\x890 doesn\'t change after losing.The friends can take part in multiple matches, each time making a party from any subset of friends (but remember about constraints on party size: from 2 to 5 members).The friends want to make their ratings equal but as high as possible.Help the friends develop a strategy of losing the matches so that all their ratings become equal and the resulting rating is maximum possible." 1800

729F "Financiers Game" dp "This problem has unusual memory constraint.At evening, Igor and Zhenya the financiers became boring, so they decided to play a game. They prepared n papers with the income of some company for some time periods. Note that the income can be positive, zero or negative.Igor and Zhenya placed the papers in a row and decided to take turns making moves. Igor will take the papers from the left side, Zhenya will take the papers from the right side. Igor goes first and takes 1 or 2 (on his choice) papers from the left. Then, on each turn a player can take k or k\xe2\x80\x89+\xe2\x80\x891 papers from his side if the opponent took exactly k papers in the previous turn. Players can\'t skip moves. The game ends when there are no papers left, or when some of the players can\'t make a move.Your task is to determine the difference between the sum of incomes on the papers Igor took and the sum of incomes on the papers Zhenya took, assuming both players play optimally. Igor wants to maximize the difference, Zhenya wants to minimize it." 2500

729E Subordinates "constructive algorithms,data structures,graphs,greedy,sortings" "There are n workers in a company, each of them has a unique id from 1 to n. Exaclty one of them is a chief, his id is s. Each worker except the chief has exactly one immediate superior.There was a request to each of the workers to tell how how many superiors (not only immediate). Worker\'s superiors are his immediate superior, the immediate superior of the his immediate superior, and so on. For example, if there are three workers in the company, from which the first is the chief, the second worker\'s immediate superior is the first, the third worker\'s immediate superior is the second, then the third worker has two superiors, one of them is immediate and one not immediate. The chief is a superior to all the workers except himself.Some of the workers were in a hurry and made a mistake. You are to find the minimum number of workers that could make a mistake." 1900

729D "Sea Battle" "constructive algorithms,greedy,math" "Galya is playing one-dimensional Sea Battle on a 1\xe2\x80\x89\xc3\x97\xe2\x80\x89n grid. In this game a ships are placed on the grid. Each of the ships consists of b consecutive cells. No cell can be part of two ships, however, the ships can touch each other.Galya doesn\'t know the ships location. She can shoot to some cells and after each shot she is told if that cell was a part of some ship (this case is called ""hit"") or not (this case is called ""miss"").Galya has already made k shots, all of them were misses.Your task is to calculate the minimum number of cells such that if Galya shoot at all of them, she would hit at least one ship.It is guaranteed that there is at least one valid ships placement." 1700

729C "Road to Cinema" "binary search,greedy,sortings" "Vasya is currently at a car rental service, and he wants to reach cinema. The film he has bought a ticket for starts in t minutes. There is a straight road of length s from the service to the cinema. Let\'s introduce a coordinate system so that the car rental service is at the point 0, and the cinema is at the point s.There are k gas stations along the road, and at each of them you can fill a car with any amount of fuel for free! Consider that this operation doesn\'t take any time, i.e. is carried out instantly.There are n cars in the rental service, i-th of them is characterized with two integers ci and vi�\xe2\x80\x94 the price of this car rent and the capacity of its fuel tank in liters. It\'s not allowed to fuel a car with more fuel than its tank capacity vi. All cars are completely fueled at the car rental service.Each of the cars can be driven in one of two speed modes: normal or accelerated. In the normal mode a car covers 1 kilometer in 2 minutes, and consumes 1 liter of fuel. In the accelerated mode a car covers 1 kilometer in 1 minutes, but consumes 2 liters of fuel. The driving mode can be changed at any moment and any number of times.Your task is to choose a car with minimum price such that Vasya can reach the cinema before the show starts, i.e. not later than in t minutes. Assume that all cars are completely fueled initially." 1700

729B Spotlights dp,implementation "Theater stage is a rectangular field of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m. The director gave you the stage\'s plan which actors will follow. For each cell it is stated in the plan if there would be an actor in this cell or not.You are to place a spotlight on the stage in some good position. The spotlight will project light in one of the four directions (if you look at the stage from above)�\xe2\x80\x94 left, right, up or down. Thus, the spotlight\'s position is a cell it is placed to and a direction it shines.A position is good if two conditions hold:   there is no actor in the cell the spotlight is placed to;  there is at least one actor in the direction the spotlight projects. Count the number of good positions for placing the spotlight. Two positions of spotlight are considered to be different if the location cells or projection direction differ." 1200

729A "Interview with Oleg" implementation,strings "Polycarp has interviewed Oleg and has written the interview down without punctuation marks and spaces to save time. Thus, the interview is now a string s consisting of n lowercase English letters.There is a filler word ogo in Oleg\'s speech. All words that can be obtained from ogo by adding go several times to the end of it are also considered to be fillers. For example, the words ogo, ogogo, ogogogo are fillers, but the words go, og, ogog, ogogog and oggo are not fillers.The fillers have maximal size, for example, for ogogoo speech we can\'t consider ogo a filler and goo as a normal phrase. We should consider ogogo as a filler here.To print the interview, Polycarp has to replace each of the fillers with three asterisks. Note that a filler word is replaced with exactly three asterisks regardless of its length.Polycarp has dealt with this problem in no time. Can you do the same? The clock is ticking!" 900

727F "Polycarp\'s problems" "binary search,dp,greedy" "Polycarp has interviewed Oleg and has written the interview down without punctuation marks and spaces to save time. Thus, the interview is now a string s consisting of n lowercase English letters.There is a filler word ogo in Oleg\'s speech. All words that can be obtained from ogo by adding go several times to the end of it are also considered to be fillers. For example, the words ogo, ogogo, ogogogo are fillers, but the words go, og, ogog, ogogog and oggo are not fillers.The fillers have maximal size, for example, for ogogoo speech we can\'t consider ogo a filler and goo as a normal phrase. We should consider ogogo as a filler here.To print the interview, Polycarp has to replace each of the fillers with three asterisks. Note that a filler word is replaced with exactly three asterisks regardless of its length.Polycarp has dealt with this problem in no time. Can you do the same? The clock is ticking!" 2300

727E "Games on a CD" "data structures,hashing,string suffix structures,strings" "Several years ago Tolya had n computer games and at some point of time he decided to burn them to CD. After that he wrote down the names of the games one after another in a circle on the CD in clockwise order. The names were distinct, the length of each name was equal to k. The names didn\'t overlap.Thus, there is a cyclic string of length n\xc2\xb7k written on the CD.Several years have passed and now Tolya can\'t remember which games he burned to his CD. He knows that there were g popular games that days. All of the games he burned were among these g games, and no game was burned more than once.You have to restore any valid list of games Tolya could burn to the CD several years ago." 2300

727D "T-shirts Distribution" "constructive algorithms,flows,greedy" "The organizers of a programming contest have decided to present t-shirts to participants. There are six different t-shirts sizes in this problem: S, M, L, XL, XXL, XXXL (sizes are listed in increasing order). The t-shirts are already prepared. For each size from S to XXXL you are given the number of t-shirts of this size.During the registration, the organizers asked each of the n participants about the t-shirt size he wants. If a participant hesitated between two sizes, he could specify two neighboring sizes�\xe2\x80\x94 this means that any of these two sizes suits him.Write a program that will determine whether it is possible to present a t-shirt to each participant of the competition, or not. Of course, each participant should get a t-shirt of proper size:   the size he wanted, if he specified one size;  any of the two neibouring sizes, if he specified two sizes. If it is possible, the program should find any valid distribution of the t-shirts." 1800

727C "Guess the Array" "constructive algorithms,interactive,math" "This is an interactive problem. You should use flush operation after each printed line. For example, in C++ you should use fflush(stdout), in Java you should use System.out.flush(), and in Pascal�\xe2\x80\x94 flush(output).In this problem you should guess an array a which is unknown for you. The only information you have initially is the length n of the array a.The only allowed action is to ask the sum of two elements by their indices. Formally, you can print two indices i and j (the indices should be distinct). Then your program should read the response: the single integer equals to ai\xe2\x80\x89+\xe2\x80\x89aj.It is easy to prove that it is always possible to guess the array using at most n requests.Write a program that will guess the array a by making at most n requests." 1400

727B "Bill Total Value" "expression parsing,implementation,strings" "Vasily exited from a store and now he wants to recheck the total price of all purchases in his bill. The bill is a string in which the names of the purchases and their prices are printed in a row without any spaces. Check has the format ""name1price1name2price2...namenpricen"", where namei (name of the i-th purchase) is a non-empty string of length not more than 10, consisting of lowercase English letters, and pricei (the price of the i-th purchase) is a non-empty string, consisting of digits and dots (decimal points). It is possible that purchases with equal names have different prices.The price of each purchase is written in the following format. If the price is an integer number of dollars then cents are not written.Otherwise, after the number of dollars a dot (decimal point) is written followed by cents in a two-digit format (if number of cents is between 1 and 9 inclusively, there is a leading zero).Also, every three digits (from less significant to the most) in dollars are separated by dot (decimal point). No extra leading zeroes are allowed. The price always starts with a digit and ends with a digit.For example:  ""234"", ""1.544"", ""149.431.10"", ""0.99"" and ""123.05"" are valid prices,  "".333"", ""3.33.11"", ""12.00"", "".33"", ""0.1234"" and ""1.2"" are not valid. Write a program that will find the total price of all purchases in the given bill." 1600

727A "Transformation: from A to B" "brute force,dfs and similar,math" "Vasily has a number a, which he wants to turn into a number b. For this purpose, he can do two types of operations:  multiply the current number by 2 (that is, replace the number x by 2\xc2\xb7x);  append the digit 1 to the right of current number (that is, replace the number x by 10\xc2\xb7x\xe2\x80\x89+\xe2\x80\x891). You need to help Vasily to transform the number a into the number b using only the operations described above, or find that it is impossible.Note that in this task you are not required to minimize the number of operations. It suffices to find any way to transform a into b." 1000

725G "Messages on a Tree" NA "Alice and Bob are well-known for sending messages to each other. This time you have a rooted tree with Bob standing in the root node and copies of Alice standing in each of the other vertices. The root node has number 0, the rest are numbered 1 through n.At some moments of time some copies of Alice want to send a message to Bob and receive an answer. We will call this copy the initiator. The process of sending a message contains several steps:   The initiator sends the message to the person standing in the parent node and begins waiting for the answer.  When some copy of Alice receives a message from some of her children nodes, she sends the message to the person standing in the parent node and begins waiting for the answer.  When Bob receives a message from some of his child nodes, he immediately sends the answer to the child node where the message came from.  When some copy of Alice (except for initiator) receives an answer she is waiting for, she immediately sends it to the child vertex where the message came from.  When the initiator receives the answer she is waiting for, she doesn\'t send it to anybody.  There is a special case: a copy of Alice can\'t wait for two answers at the same time, so if some copy of Alice receives a message from her child node while she already waits for some answer, she rejects the message and sends a message saying this back to the child node where the message came from. Then the copy of Alice in the child vertex processes this answer as if it was from Bob.  The process of sending a message to a parent node or to a child node is instant but a receiver (a parent or a child) gets a message after 1 second. If some copy of Alice receives several messages from child nodes at the same moment while she isn\'t waiting for an answer, she processes the message from the initiator with the smallest number and rejects all the rest. If some copy of Alice receives messages from children nodes and also receives the answer she is waiting for at the same instant, then Alice first processes the answer, then immediately continue as normal with the incoming messages.You are given the moments of time when some copy of Alice becomes the initiator and sends a message to Bob. For each message, find the moment of time when the answer (either from Bob or some copy of Alice) will be received by the initiator.You can assume that if Alice wants to send a message (i.e. become the initiator) while waiting for some answer, she immediately rejects the message and receives an answer from herself in no time." 3300

725F "Family Photos" games,greedy "Alice and Bonnie are sisters, but they don\'t like each other very much. So when some old family photos were found in the attic, they started to argue about who should receive which photos. In the end, they decided that they would take turns picking photos. Alice goes first.There are n stacks of photos. Each stack contains exactly two photos. In each turn, a player may take only a photo from the top of one of the stacks.Each photo is described by two non-negative integers a and b, indicating that it is worth a units of happiness to Alice and b units of happiness to Bonnie. Values of a and b might differ for different photos.It\'s allowed to pass instead of taking a photo. The game ends when all photos are taken or both players pass consecutively.The players don\'t act to maximize their own happiness. Instead, each player acts to maximize the amount by which her happiness exceeds her sister\'s. Assuming both players play optimal, find the difference between Alice\'s and Bonnie\'s happiness. That is, if there\'s a perfectly-played game such that Alice has x happiness and Bonnie has y happiness at the end, you should print x\xe2\x80\x89-\xe2\x80\x89y." 2900

725E "Too Much Money" "brute force,greedy" "Alfred wants to buy a toy moose that costs c dollars. The store doesn\xe2\x80\x99t give change, so he must give the store exactly c dollars, no more and no less. He has n coins. To make c dollars from his coins, he follows the following algorithm: let S be the set of coins being used. S is initially empty. Alfred repeatedly adds to S the highest-valued coin he has such that the total value of the coins in S after adding the coin doesn\xe2\x80\x99t exceed c. If there is no such coin, and the value of the coins in S is still less than c, he gives up and goes home. Note that Alfred never removes a coin from S after adding it.As a programmer, you might be aware that Alfred\xe2\x80\x99s algorithm can fail even when there is a set of coins with value exactly c. For example, if Alfred has one coin worth $3, one coin worth $4, and two coins worth $5, and the moose costs $12, then Alfred will add both of the $5 coins to S and then give up, since adding any other coin would cause the value of the coins in S to exceed $12. Of course, Alfred could instead combine one $3 coin, one $4 coin, and one $5 coin to reach the total.Bob tried to convince Alfred that his algorithm was flawed, but Alfred didn\xe2\x80\x99t believe him. Now Bob wants to give Alfred some coins (in addition to those that Alfred already has) such that Alfred\xe2\x80\x99s algorithm fails. Bob can give Alfred any number of coins of any denomination (subject to the constraint that each coin must be worth a positive integer number of dollars). There can be multiple coins of a single denomination. He would like to minimize the total value of the coins he gives Alfred. Please find this minimum value. If there is no solution, print ""Greed is good"". You can assume that the answer, if it exists, is positive. In other words, Alfred\'s algorithm will work if Bob doesn\'t give him any coins." 2600

725D "Contest Balloons" "data structures,greedy" "One tradition of ACM-ICPC contests is that a team gets a balloon for every solved problem. We assume that the submission time doesn\'t matter and teams are sorted only by the number of balloons they have. It means that one\'s place is equal to the number of teams with more balloons, increased by 1. For example, if there are seven teams with more balloons, you get the eight place. Ties are allowed.You should know that it\'s important to eat before a contest. If the number of balloons of a team is greater than the weight of this team, the team starts to float in the air together with their workstation. They eventually touch the ceiling, what is strictly forbidden by the rules. The team is then disqualified and isn\'t considered in the standings.A contest has just finished. There are n teams, numbered 1 through n. The i-th team has ti balloons and weight wi. It\'s guaranteed that ti doesn\'t exceed wi so nobody floats initially.Limak is a member of the first team. He doesn\'t like cheating and he would never steal balloons from other teams. Instead, he can give his balloons away to other teams, possibly making them float. Limak can give away zero or more balloons of his team. Obviously, he can\'t give away more balloons than his team initially has.What is the best place Limak can get?" 1800

725C "Hidden Word" "brute force,constructive algorithms,implementation,strings" "Let\xe2\x80\x99s define a grid to be a set of tiles with 2 rows and 13 columns. Each tile has an English letter written in it. The letters don\'t have to be unique: there might be two or more tiles with the same letter written on them. Here is an example of a grid: ABCDEFGHIJKLMNOPQRSTUVWXYZ We say that two tiles are adjacent if they share a side or a corner. In the example grid above, the tile with the letter \'A\' is adjacent only to the tiles with letters \'B\', \'N\', and \'O\'. A tile is not adjacent to itself.A sequence of tiles is called a path if each tile in the sequence is adjacent to the tile which follows it (except for the last tile in the sequence, which of course has no successor). In this example, ""ABC"" is a path, and so is ""KXWIHIJK"". ""MAB"" is not a path because \'M\' is not adjacent to \'A\'. A single tile can be used more than once by a path (though the tile cannot occupy two consecutive places in the path because no tile is adjacent to itself).You\xe2\x80\x99re given a string s which consists of 27 upper-case English letters. Each English letter occurs at least once in s. Find a grid that contains a path whose tiles, viewed in the order that the path visits them, form the string s. If there\xe2\x80\x99s no solution, print ""Impossible"" (without the quotes)." 1600

725B "Food on the Plane" implementation,math "A new airplane SuperPuperJet has an infinite number of rows, numbered with positive integers starting with 1 from cockpit to tail. There are six seats in each row, denoted with letters from \'a\' to \'f\'. Seats \'a\', \'b\' and \'c\' are located to the left of an aisle (if one looks in the direction of the cockpit), while seats \'d\', \'e\' and \'f\' are located to the right. Seats \'a\' and \'f\' are located near the windows, while seats \'c\' and \'d\' are located near the aisle.   �It\'s lunch time and two flight attendants have just started to serve food. They move from the first rows to the tail, always maintaining a distance of two rows from each other because of the food trolley. Thus, at the beginning the first attendant serves row 1 while the second attendant serves row 3. When both rows are done they move one row forward: the first attendant serves row 2 while the second attendant serves row 4. Then they move three rows forward and the first attendant serves row 5 while the second attendant serves row 7. Then they move one row forward again and so on.Flight attendants work with the same speed: it takes exactly 1 second to serve one passenger and 1 second to move one row forward. Each attendant first serves the passengers on the seats to the right of the aisle and then serves passengers on the seats to the left of the aisle (if one looks in the direction of the cockpit). Moreover, they always serve passengers in order from the window to the aisle. Thus, the first passenger to receive food in each row is located in seat \'f\', and the last one�\xe2\x80\x94 in seat \'c\'. Assume that all seats are occupied.Vasya has seat s in row n and wants to know how many seconds will pass before he gets his lunch." 1200

725A "Jumping Ball" implementation "In a new version of the famous Pinball game, one of the most important parts of the game field is a sequence of n bumpers. The bumpers are numbered with integers from 1 to n from left to right. There are two types of bumpers. They are denoted by the characters \'<\' and \'>\'. When the ball hits the bumper at position i it goes one position to the right (to the position i\xe2\x80\x89+\xe2\x80\x891) if the type of this bumper is \'>\', or one position to the left (to i\xe2\x80\x89-\xe2\x80\x891) if the type of the bumper at position i is \'<\'. If there is no such position, in other words if i\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89<\xe2\x80\x891 or i\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89>\xe2\x80\x89n, the ball falls from the game field.Depending on the ball\'s starting position, the ball may eventually fall from the game field or it may stay there forever. You are given a string representing the bumpers\' types. Calculate the number of positions such that the ball will eventually fall from the game field if it starts at that position." 1000

724G "Xor-matic Number of the Graph" "bitmasks,graphs,math,number theory,trees" "You are given an undirected graph, constisting of n vertices and m edges. Each edge of the graph has some non-negative integer written on it.Let\'s call a triple (u,\xe2\x80\x89v,\xe2\x80\x89s) interesting, if 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89u\xe2\x80\x89<\xe2\x80\x89v\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n and there is a path (possibly non-simple, i.e. it can visit the same vertices and edges multiple times) between vertices u and v such that xor of all numbers written on the edges of this path is equal to s. When we compute the value s for some path, each edge is counted in xor as many times, as it appear on this path. It\'s not hard to prove that there are finite number of such triples.Calculate the sum over modulo 109\xe2\x80\x89+\xe2\x80\x897 of the values of s over all interesting triples." 2600

724F "Uniformly Branched Trees" combinatorics,dp,trees "A tree is a connected graph without cycles.Two trees, consisting of n vertices each, are called isomorphic if there exists a permutation p:\xe2\x80\x89{1,\xe2\x80\x89...,\xe2\x80\x89n}\xe2\x80\x89\xe2\x86\x92\xe2\x80\x89{1,\xe2\x80\x89...,\xe2\x80\x89n} such that the edge (u,\xe2\x80\x89v) is present in the first tree if and only if the edge (pu,\xe2\x80\x89pv) is present in the second tree.Vertex of the tree is called internal if its degree is greater than or equal to two.Count the number of different non-isomorphic trees, consisting of n vertices, such that the degree of each internal vertex is exactly d. Print the answer over the given prime modulo mod." 2700

724E "Goods transportation" dp,flows,greedy "There are n cities located along the one-way road. Cities are numbered from 1 to n in the direction of the road.The i-th city had produced pi units of goods. No more than si units of goods can be sold in the i-th city.For each pair of cities i and j such that 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n you can no more than once transport no more than c units of goods from the city i to the city j. Note that goods can only be transported from a city with a lesser index to the city with a larger index. You can transport goods between cities in any order.Determine the maximum number of produced goods that can be sold in total in all the cities after a sequence of transportations." 2900

724D "Dense Subsequence" "data structures,greedy,strings" "You are given a string s, consisting of lowercase English letters, and the integer m.One should choose some symbols from the given string so that any contiguous subsegment of length m has at least one selected symbol. Note that here we choose positions of symbols, not the symbols themselves.Then one uses the chosen symbols to form a new string. All symbols from the chosen position should be used, but we are allowed to rearrange them in any order.Formally, we choose a subsequence of indices 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i1\xe2\x80\x89<\xe2\x80\x89i2\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89it\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|s|. The selected sequence must meet the following condition: for every j such that 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|s|\xe2\x80\x89-\xe2\x80\x89m\xe2\x80\x89+\xe2\x80\x891, there must be at least one selected index that belongs to the segment [j,\xe2\x80\x89�j\xe2\x80\x89+\xe2\x80\x89m\xe2\x80\x89-\xe2\x80\x891], i.e. there should exist a k from 1 to t, such that j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ik\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89+\xe2\x80\x89m\xe2\x80\x89-\xe2\x80\x891.Then we take any permutation p of the selected indices and form a new string sip1sip2... sipt.Find the lexicographically smallest string, that can be obtained using this procedure." 1900

724C "Ray Tracing" "greedy,hashing,implementation,math,number theory,sortings" "There are k sensors located in the rectangular room of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m meters. The i-th sensor is located at point (xi,\xe2\x80\x89yi). All sensors are located at distinct points strictly inside the rectangle. Opposite corners of the room are located at points (0,\xe2\x80\x890) and (n,\xe2\x80\x89m). Walls of the room are parallel to coordinate axes.At the moment 0, from the point (0,\xe2\x80\x890) the laser ray is released in the direction of point (1,\xe2\x80\x891). The ray travels with a speed of  meters per second. Thus, the ray will reach the point (1,\xe2\x80\x891) in exactly one second after the start.When the ray meets the wall it\'s reflected by the rule that the angle of incidence is equal to the angle of reflection. If the ray reaches any of the four corners, it immediately stops.For each sensor you have to determine the first moment of time when the ray will pass through the point where this sensor is located. If the ray will never pass through this point, print \xe2\x80\x89-\xe2\x80\x891 for such sensors." 1800

724B "Batch Sort" "brute force,greedy,implementation,math" "You are given a table consisting of n rows and m columns.Numbers in each row form a permutation of integers from 1 to m.You are allowed to pick two elements in one row and swap them, but no more than once for each row. Also, no more than once you are allowed to pick two columns and swap them. Thus, you are allowed to perform from 0 to n\xe2\x80\x89+\xe2\x80\x891 actions in total. Operations can be performed in any order.You have to check whether it\'s possible to obtain the identity permutation 1,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89m in each row. In other words, check if one can perform some of the operation following the given rules and make each row sorted in increasing order." 1500

724A "Checking the Calendar" implementation "You are given names of two days of the week.Please, determine whether it is possible that during some non-leap year the first day of some month was equal to the first day of the week you are given, while the first day of the next month was equal to the second day of the week you are given. Both months should belong to one year.In this problem, we consider the Gregorian calendar to be used. The number of months in this calendar is equal to 12. The number of days in months during any non-leap year is: 31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31.Names of the days of the week are given with lowercase English letters: ""monday"", ""tuesday"", ""wednesday"", ""thursday"", ""friday"", ""saturday"", ""sunday""." 1000

723F "st-Spanning Tree" dsu,graphs,greedy,implementation "You are given an undirected connected graph consisting of n vertices and m edges. There are no loops and no multiple edges in the graph.You are also given two distinct vertices s and t, and two values ds and dt. Your task is to build any spanning tree of the given graph (note that the graph is not weighted), such that the degree of the vertex s doesn\'t exceed ds, and the degree of the vertex t doesn\'t exceed dt, or determine, that there is no such spanning tree.The spanning tree of the graph G is a subgraph which is a tree and contains all vertices of the graph G. In other words, it is a connected graph which contains n\xe2\x80\x89-\xe2\x80\x891 edges and can be obtained by removing some of the edges from G.The degree of a vertex is the number of edges incident to this vertex." 2300

723E "One-Way Reform" "constructive algorithms,dfs and similar,flows,graphs,greedy" "There are n cities and m two-way roads in Berland, each road connects two cities. It is known that there is no more than one road connecting each pair of cities, and there is no road which connects the city with itself. It is possible that there is no way to get from one city to some other city using only these roads.The road minister decided to make a reform in Berland and to orient all roads in the country, i.e. to make each road one-way. The minister wants to maximize the number of cities, for which the number of roads that begins in the city equals to the number of roads that ends in it." 2200

723D "Lakes in Berland" "dfs and similar,dsu,graphs,greedy,implementation" "The map of Berland is a rectangle of the size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m, which consists of cells of size 1\xe2\x80\x89\xc3\x97\xe2\x80\x891. Each cell is either land or water. The map is surrounded by the ocean. Lakes are the maximal regions of water cells, connected by sides, which are not connected with the ocean. Formally, lake is a set of water cells, such that it\'s possible to get from any cell of the set to any other without leaving the set and moving only to cells adjacent by the side, none of them is located on the border of the rectangle, and it\'s impossible to add one more water cell to the set such that it will be connected with any other cell.You task is to fill up with the earth the minimum number of water cells so that there will be exactly k lakes in Berland. Note that the initial number of lakes on the map is not less than k." 1600

723C "Polycarp at the Radio" greedy "Polycarp is a music editor at the radio station. He received a playlist for tomorrow, that can be represented as a sequence a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an, where ai is a band, which performs the i-th song. Polycarp likes bands with the numbers from 1 to m, but he doesn\'t really like others. We define as bj the number of songs the group j is going to perform tomorrow. Polycarp wants to change the playlist in such a way that the minimum among the numbers b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bm will be as large as possible.Find this maximum possible value of the minimum among the bj (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m), and the minimum number of changes in the playlist Polycarp needs to make to achieve it. One change in the playlist is a replacement of the performer of the i-th song with any other group." 1600

723B "Text Document Analysis" "expression parsing,implementation,strings" "Modern text editors usually show some information regarding the document being edited. For example, the number of words, the number of pages, or the number of characters.In this problem you should implement the similar functionality.You are given a string which only consists of:  uppercase and lowercase English letters,  underscore symbols (they are used as separators),  parentheses (both opening and closing). It is guaranteed that each opening parenthesis has a succeeding closing parenthesis. Similarly, each closing parentheses has a preceding opening parentheses matching it. For each pair of matching parentheses there are no other parenthesis between them. In other words, each parenthesis in the string belongs to a matching ""opening-closing"" pair, and such pairs can\'t be nested.For example, the following string is valid: ""_Hello_Vasya(and_Petya)__bye_(and_OK)"".Word is a maximal sequence of consecutive letters, i.e. such sequence that the first character to the left and the first character to the right of it is an underscore, a parenthesis, or it just does not exist. For example, the string above consists of seven words: ""Hello"", ""Vasya"", ""and"", ""Petya"", ""bye"", ""and"" and ""OK"". Write a program that finds:  the length of the longest word outside the parentheses (print 0, if there is no word outside the parentheses),  the number of words inside the parentheses (print 0, if there is no word inside the parentheses)." 1100

723A "The New Year: Meeting Friends" implementation,math,sortings "There are three friend living on the straight line Ox in Lineland. The first friend lives at the point x1, the second friend lives at the point x2, and the third friend lives at the point x3. They plan to celebrate the New Year together, so they need to meet at one point. What is the minimum total distance they have to travel in order to meet at some point and celebrate the New Year?It\'s guaranteed that the optimal answer is always integer." 800

722F "Cyclic Cipher" "chinese remainder theorem,data structures,implementation,number theory,two pointers" "You are given n sequences. Each sequence consists of positive integers, not exceeding m. All integers in one sequence are distinct, but the same integer may appear in multiple sequences. The length of the i-th sequence is ki.Each second integers in each of the sequences are shifted by one to the left, i.e. integers at positions i\xe2\x80\x89>\xe2\x80\x891 go to positions i\xe2\x80\x89-\xe2\x80\x891, while the first integers becomes the last.Each second we take the first integer of each sequence and write it down to a new array. Then, for each value x from 1 to m we compute the longest segment of the array consisting of element x only.The above operation is performed for 10100 seconds. For each integer from 1 to m find out the longest segment found at this time." 2800

722E "Research Rover" combinatorics,dp "Unfortunately, the formal description of the task turned out to be too long, so here is the legend.Research rover finally reached the surface of Mars and is ready to complete its mission. Unfortunately, due to the mistake in the navigation system design, the rover is located in the wrong place.The rover will operate on the grid consisting of n rows and m columns. We will define as (r,\xe2\x80\x89c) the cell located in the row r and column c. From each cell the rover is able to move to any cell that share a side with the current one.The rover is currently located at cell (1,\xe2\x80\x891) and has to move to the cell (n,\xe2\x80\x89m). It will randomly follow some shortest path between these two cells. Each possible way is chosen equiprobably.The cargo section of the rover contains the battery required to conduct the research. Initially, the battery charge is equal to s units of energy.Some of the cells contain anomaly. Each time the rover gets to the cell with anomaly, the battery looses half of its charge rounded down. Formally, if the charge was equal to x before the rover gets to the cell with anomaly, the charge will change to .While the rover picks a random shortest path to proceed, compute the expected value of the battery charge after it reaches cell (n,\xe2\x80\x89m). If the cells (1,\xe2\x80\x891) and (n,\xe2\x80\x89m) contain anomaly, they also affect the charge of the battery." 2900

722D "Generating Sets" "binary search,data structures,dfs and similar,greedy,strings,trees" "You are given a set Y of n distinct positive integers y1,\xe2\x80\x89y2,\xe2\x80\x89...,\xe2\x80\x89yn.Set X of n distinct positive integers x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xn is said to generate set Y if one can transform X to Y by applying some number of the following two operation to integers in X:  Take any integer xi and multiply it by two, i.e. replace xi with 2\xc2\xb7xi.  Take any integer xi, multiply it by two and add one, i.e. replace xi with 2\xc2\xb7xi\xe2\x80\x89+\xe2\x80\x891. Note that integers in X are not required to be distinct after each operation.Two sets of distinct integers X and Y are equal if they are equal as sets. In other words, if we write elements of the sets in the array in the increasing order, these arrays would be equal.Note, that any set of integers (or its permutation) generates itself.You are given a set Y and have to find a set X that generates Y and the maximum element of X is mininum possible." 1900

722C "Destroying Array" "data structures,dsu" "You are given an array consisting of n non-negative integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an.You are going to destroy integers in the array one by one. Thus, you are given the permutation of integers from 1 to n defining the order elements of the array are destroyed.After each element is destroyed you have to find out the segment of the array, such that it contains no destroyed elements and the sum of its elements is maximum possible. The sum of elements in the empty segment is considered to be 0." 1600

722B "Verse Pattern" implementation,strings "You are given a text consisting of n lines. Each line contains some space-separated words, consisting of lowercase English letters.We define a syllable as a string that contains exactly one vowel and any arbitrary number (possibly none) of consonants. In English alphabet following letters are considered to be vowels: \'a\', \'e\', \'i\', \'o\', \'u\' and \'y\'.Each word of the text that contains at least one vowel can be divided into syllables. Each character should be a part of exactly one syllable. For example, the word ""mamma"" can be divided into syllables as ""ma"" and ""mma"", ""mam"" and ""ma"", and ""mamm"" and ""a"". Words that consist of only consonants should be ignored.The verse patterns for the given text is a sequence of n integers p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pn. Text matches the given verse pattern if for each i from 1 to n one can divide words of the i-th line in syllables in such a way that the total number of syllables is equal to pi.You are given the text and the verse pattern. Check, if the given text matches the given verse pattern." 1200

722A "Broken Clock" "brute force,implementation" "You are given a broken clock. You know, that it is supposed to show time in 12- or 24-hours HH:MM format. In 12-hours format hours change from 1 to 12, while in 24-hours it changes from 0 to 23. In both formats minutes change from 0 to 59.You are given a time in format HH:MM that is currently displayed on the broken clock. Your goal is to change minimum number of digits in order to make clocks display the correct time in the given format.For example, if 00:99 is displayed, it is enough to replace the second 9 with 3 in order to get 00:39 that is a correct time in 24-hours format. However, to make 00:99 correct in 12-hours format, one has to change at least two digits. Additionally to the first change one can replace the second 0 with 1 and obtain 01:39." 1300

721E "Road to Home" "binary search,dp" "Once Danil the student was returning home from tram stop lately by straight road of length L. The stop is located at the point x\xe2\x80\x89=\xe2\x80\x890, but the Danil\'s home�\xe2\x80\x94 at the point x\xe2\x80\x89=\xe2\x80\x89L. Danil goes from x\xe2\x80\x89=\xe2\x80\x890 to x\xe2\x80\x89=\xe2\x80\x89L with a constant speed and does not change direction of movement.There are n street lights at the road, each of which lights some continuous segment of the road. All of the n lightened segments do not share common points.Danil loves to sing, thus he wants to sing his favourite song over and over again during his walk. As soon as non-lightened segments of the road scare him, he sings only when he goes through the lightened segments.Danil passes distance p while performing his favourite song once. Danil can\'t start another performance if the segment passed while performing is not fully lightened. Moreover, if Danil has taken a pause between two performances, he is not performing while not having passed a segment of length at least t. Formally,  Danil can start single performance at a point x only if every point of segment [x,\xe2\x80\x89x\xe2\x80\x89+\xe2\x80\x89p] is lightened;  If Danil has finished performing at a point x\xe2\x80\x89+\xe2\x80\x89p, then the next performance can be started only at a point y such that y\xe2\x80\x89=\xe2\x80\x89x\xe2\x80\x89+\xe2\x80\x89p or y\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89x\xe2\x80\x89+\xe2\x80\x89p\xe2\x80\x89+\xe2\x80\x89t satisfying the statement under the point 1.   Blue half-circles denote performances. Please note that just after Danil has taken a pause in performing, he has not sang for a path of length of at least t. Determine how many times Danil can perform his favourite song during his walk from x\xe2\x80\x89=\xe2\x80\x890 to x\xe2\x80\x89=\xe2\x80\x89L.Please note that Danil does not break a single performance, thus, started singing another time, he finishes singing when having a segment of length of p passed from the performance start point." 2700

721D "Maxim and Array" "constructive algorithms,data structures,greedy,math" "Recently Maxim has found an array of n integers, needed by no one. He immediately come up with idea of changing it: he invented positive integer x and decided to add or subtract it from arbitrary array elements. Formally, by applying single operation Maxim chooses integer i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) and replaces the i-th element of array ai either with ai\xe2\x80\x89+\xe2\x80\x89x or with ai\xe2\x80\x89-\xe2\x80\x89x. Please note that the operation may be applied more than once to the same position.Maxim is a curious minimalis, thus he wants to know what is the minimum value that the product of all array elements (i.e. ) can reach, if Maxim would apply no more than k operations to it. Please help him in that." 2000

721C Journey dp,graphs "Recently Irina arrived to one of the most famous cities of Berland�\xe2\x80\x94 the Berlatov city. There are n showplaces in the city, numbered from 1 to n, and some of them are connected by one-directional roads. The roads in Berlatov are designed in a way such that there are no cyclic routes between showplaces.Initially Irina stands at the showplace 1, and the endpoint of her journey is the showplace n. Naturally, Irina wants to visit as much showplaces as she can during her journey. However, Irina\'s stay in Berlatov is limited and she can\'t be there for more than T time units.Help Irina determine how many showplaces she may visit during her journey from showplace 1 to showplace n within a time not exceeding T. It is guaranteed that there is at least one route from showplace 1 to showplace n such that Irina will spend no more than T time units passing it." 1800

721B Passwords implementation,math,sortings,strings "Vanya is managed to enter his favourite site Codehorses. Vanya uses n distinct passwords for sites at all, however he can\'t remember which one exactly he specified during Codehorses registration.Vanya will enter passwords in order of non-decreasing their lengths, and he will enter passwords of same length in arbitrary order. Just when Vanya will have entered the correct password, he is immediately authorized on the site. Vanya will not enter any password twice.Entering any passwords takes one second for Vanya. But if Vanya will enter wrong password k times, then he is able to make the next try only 5 seconds after that. Vanya makes each try immediately, that is, at each moment when Vanya is able to enter password, he is doing that.Determine how many seconds will Vanya need to enter Codehorses in the best case for him (if he spends minimum possible number of second) and in the worst case (if he spends maximum possible amount of seconds)." 1100

721A "One-dimensional Japanese Crossword" implementation "Recently Adaltik discovered japanese crosswords. Japanese crossword is a picture, represented as a table sized a\xe2\x80\x89\xc3\x97\xe2\x80\x89b squares, and each square is colored white or black. There are integers to the left of the rows and to the top of the columns, encrypting the corresponding row or column. The number of integers represents how many groups of black squares there are in corresponding row or column, and the integers themselves represents the number of consecutive black squares in corresponding group (you can find more detailed explanation in Wikipedia https://en.wikipedia.org/wiki/Japanese_crossword).Adaltik decided that the general case of japanese crossword is too complicated and drew a row consisting of n squares (e.g. japanese crossword sized 1\xe2\x80\x89\xc3\x97\xe2\x80\x89n), which he wants to encrypt in the same way as in japanese crossword.  The example of encrypting of a single row of japanese crossword. Help Adaltik find the numbers encrypting the row he drew." 800

720F "Array Covering" "data structures" "Misha has an array of integers of length n. He wants to choose k different continuous subarrays, so that each element of the array belongs to at least one of the chosen subarrays.Misha wants to choose the subarrays in such a way that if he calculated the sum of elements for each subarray, and then add up all these sums, the resulting value was maximum possible." 3100

720E Cipher implementation "Borya has recently found a big electronic display. The computer that manages the display stores some integer number. The number has n decimal digits, the display shows the encoded version of the number, where each digit is shown using some lowercase letter of the English alphabet.There is a legend near the display, that describes how the number is encoded. For each digit position i and each digit j the character c is known, that encodes this digit at this position. Different digits can have the same code characters.Each second the number is increased by 1. And one second after a moment when the number reaches the value that is represented as n 9-s in decimal notation, the loud beep sounds. Andrew knows the number that is stored in the computer. Now he wants to know how many seconds must pass until Borya can definitely tell what was the original number encoded by the display. Assume that Borya can precisely measure time, and that the encoded number will first be increased exactly one second after Borya started watching at the display." 3100

720D Slalom "data structures,dp,sortings" "Little girl Masha likes winter sports, today she\'s planning to take part in slalom skiing.The track is represented as a grid composed of n\xe2\x80\x89\xc3\x97\xe2\x80\x89m squares. There are rectangular obstacles at the track, composed of grid squares. Masha must get from the square (1,\xe2\x80\x891) to the square (n,\xe2\x80\x89m). She can move from a square to adjacent square: either to the right, or upwards. If the square is occupied by an obstacle, it is not allowed to move to that square.One can see that each obstacle can actually be passed in two ways: either it is to the right of Masha\'s path, or to the left. Masha likes to try all ways to do things, so she would like to know how many ways are there to pass the track. Two ways are considered different if there is an obstacle such that it is to the right of the path in one way, and to the left of the path in the other way.Help Masha to find the number of ways to pass the track. The number of ways can be quite big, so Masha would like to know it modulo 109\xe2\x80\x89+\xe2\x80\x897.The pictures below show different ways to pass the track in sample tests." 3100

720C Homework "constructive algorithms" "Today Peter has got an additional homework for tomorrow. The teacher has given three integers to him: n, m and k, and asked him to mark one or more squares on a square grid of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m. The marked squares must form a connected figure, and there must be exactly k triples of marked squares that form an L-shaped tromino�\xe2\x80\x94 all three squares are inside a 2\xe2\x80\x89\xc3\x97\xe2\x80\x892 square.The set of squares forms a connected figure if it is possible to get from any square to any other one if you are allowed to move from a square to any adjacent by a common side square.Peter cannot fulfill the task, so he asks you for help. Help him to create such figure." 3100

720B Cactusophobia "dfs and similar,flows" "Tree is a connected undirected graph that has no cycles. Edge cactus is a connected undirected graph without loops and parallel edges, such that each edge belongs to at most one cycle.Vasya has an edge cactus, each edge of this graph has some color.Vasya would like to remove the minimal number of edges in such way that his cactus turned to a tree. Vasya wants to make it in such a way that there were edges of as many different colors in the resulting tree, as possible. Help him to find how many different colors can the resulting tree have." 2400

720A "Closing ceremony" greedy "The closing ceremony of Squanch Code Cup is held in the big hall with n\xe2\x80\x89\xc3\x97\xe2\x80\x89m seats, arranged in n rows, m seats in a row. Each seat has two coordinates (x,\xe2\x80\x89y) (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n, 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m). There are two queues of people waiting to enter the hall: k people are standing at (0,\xe2\x80\x890) and n\xc2\xb7m\xe2\x80\x89-\xe2\x80\x89k people are standing at (0,\xe2\x80\x89m\xe2\x80\x89+\xe2\x80\x891). Each person should have a ticket for a specific seat. If person p at (x,\xe2\x80\x89y) has ticket for seat (xp,\xe2\x80\x89yp) then he should walk |x\xe2\x80\x89-\xe2\x80\x89xp|\xe2\x80\x89+\xe2\x80\x89|y\xe2\x80\x89-\xe2\x80\x89yp| to get to his seat.Each person has a stamina�\xe2\x80\x94 the maximum distance, that the person agrees to walk. You should find out if this is possible to distribute all n\xc2\xb7m tickets in such a way that each person has enough stamina to get to their seat." 2000

719B "Anatoly and Cockroaches" greedy "Anatoly lives in the university dorm as many other students do. As you know, cockroaches are also living there together with students. Cockroaches might be of two colors: black and red. There are n cockroaches living in Anatoly\'s room.Anatoly just made all his cockroaches to form a single line. As he is a perfectionist, he would like the colors of cockroaches in the line to alternate. He has a can of black paint and a can of red paint. In one turn he can either swap any two cockroaches, or take any single cockroach and change it\'s color.Help Anatoly find out the minimum number of turns he needs to make the colors of cockroaches in the line alternate." 1400

719A "Vitya in the Countryside" implementation "Every summer Vitya comes to visit his grandmother in the countryside. This summer, he got a huge wart. Every grandma knows that one should treat warts when the moon goes down. Thus, Vitya has to catch the moment when the moon is down.Moon cycle lasts 30 days. The size of the visible part of the moon (in Vitya\'s units) for each day is 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 14, 13, 12, 11, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1, and then cycle repeats, thus after the second 1 again goes 0.As there is no internet in the countryside, Vitya has been watching the moon for n consecutive days and for each of these days he wrote down the size of the visible part of the moon. Help him find out whether the moon will be up or down next day, or this cannot be determined by the data he has." 1100

718E "Matvey\'s Birthday" bitmasks,graphs "Every summer Vitya comes to visit his grandmother in the countryside. This summer, he got a huge wart. Every grandma knows that one should treat warts when the moon goes down. Thus, Vitya has to catch the moment when the moon is down.Moon cycle lasts 30 days. The size of the visible part of the moon (in Vitya\'s units) for each day is 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 14, 13, 12, 11, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1, and then cycle repeats, thus after the second 1 again goes 0.As there is no internet in the countryside, Vitya has been watching the moon for n consecutive days and for each of these days he wrote down the size of the visible part of the moon. Help him find out whether the moon will be up or down next day, or this cannot be determined by the data he has." 3300

718D "Andrew and Chemistry" dp,hashing,trees "During the chemistry lesson Andrew learned that the saturated hydrocarbons (alkanes) enter into radical chlorination reaction. Andrew is a very curious boy, so he wondered how many different products of the reaction may be forms for a given alkane. He managed to solve the task for small molecules, but for large ones he faced some difficulties and asks you to help.Formally, you are given a tree consisting of n vertices, such that the degree of each vertex doesn\'t exceed 4. You have to count the number of distinct non-isomorphic trees that can be obtained by adding to this tree one new vertex and one new edge, such that the graph is still the tree and the degree of each vertex doesn\'t exceed 4.Two trees are isomorphic if there exists a bijection f(v) such that vertices u and v are connected by an edge if and only if vertices f(v) and f(u) are connected by an edge." 2900

718C "Sasha and Array" "data structures,math,matrices" "Sasha has an array of integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. You have to perform m queries. There might be queries of two types:  1 l r x�\xe2\x80\x94 increase all integers on the segment from l to r by values x;  2 l r�\xe2\x80\x94 find , where f(x) is the x-th Fibonacci number. As this number may be large, you only have to find it modulo 109\xe2\x80\x89+\xe2\x80\x897. In this problem we define Fibonacci numbers as follows: f(1)\xe2\x80\x89=\xe2\x80\x891, f(2)\xe2\x80\x89=\xe2\x80\x891, f(x)\xe2\x80\x89=\xe2\x80\x89f(x\xe2\x80\x89-\xe2\x80\x891)\xe2\x80\x89+\xe2\x80\x89f(x\xe2\x80\x89-\xe2\x80\x892) for all x\xe2\x80\x89>\xe2\x80\x892.Sasha is a very talented boy and he managed to perform all queries in five seconds. Will you be able to write the program that performs as well as Sasha?" 2300

718A "Efim and Strange Grade" dp,implementation,math "Efim just received his grade for the last test. He studies in a special school and his grade can be equal to any positive decimal fraction. First he got disappointed, as he expected a way more pleasant result. Then, he developed a tricky plan. Each second, he can ask his teacher to round the grade at any place after the decimal point (also, he can ask to round to the nearest integer). There are t seconds left till the end of the break, so Efim has to act fast. Help him find what is the maximum grade he can get in no more than t seconds. Note, that he can choose to not use all t seconds. Moreover, he can even choose to not round the grade at all.In this problem, classic rounding rules are used: while rounding number to the n-th digit one has to take a look at the digit n\xe2\x80\x89+\xe2\x80\x891. If it is less than 5 than the n-th digit remain unchanged while all subsequent digits are replaced with 0. Otherwise, if the n\xe2\x80\x89+\xe2\x80\x891 digit is greater or equal to 5, the digit at the position n is increased by 1 (this might also change some other digits, if this one was equal to 9) and all subsequent digits are replaced with 0. At the end, all trailing zeroes are thrown away.For example, if the number 1.14 is rounded to the first decimal place, the result is 1.1, while if we round 1.5 to the nearest integer, the result is 2. Rounding number 1.299996121 in the fifth decimal place will result in number 1.3." 1700

717I "Cowboy Beblop at his computer" geometry "Cowboy Beblop is a funny little boy who likes sitting at his computer. He somehow obtained two elastic hoops in the shape of 2D polygons, which are not necessarily convex. Since there\'s no gravity on his spaceship, the hoops are standing still in the air. Since the hoops are very elastic, Cowboy Beblop can stretch, rotate, translate or shorten their edges as much as he wants.For both hoops, you are given the number of their vertices, as well as the position of each vertex, defined by the X , Y and Z coordinates. The vertices are given in the order they\'re connected: the 1st\xe2\x80\xafvertex is connected to the 2nd, which is connected to the 3rd, etc., and the last vertex is connected to the first one. Two hoops are connected if it\'s impossible to pull them to infinity in different directions by manipulating their edges, without having their edges or vertices intersect at any point \xe2\x80\x93 just like when two links of a chain are connected. The polygons\' edges do not intersect or overlap. To make things easier, we say that two polygons are well-connected, if the edges of one polygon cross the area of the other polygon in two different directions (from the upper and lower sides of the plane defined by that polygon) a different number of times.Cowboy Beblop is fascinated with the hoops he has obtained and he would like to know whether they are well-connected or not. Since he\xe2\x80\x99s busy playing with his dog, Zwei, he\xe2\x80\x99d like you to figure it out for him. He promised you some sweets if you help him!" 2800

717H "Pokermon League challenge" math,probabilities "Welcome to the world of Pokermon, yellow little mouse-like creatures, who absolutely love playing poker! Yeah, right\xe2\x80\xa6 In the ensuing Pokermon League, there are n registered Pokermon trainers, and t existing trainer teams each of which belongs to one of two conferences. Since there is a lot of jealousy between trainers, there are e pairs of trainers who hate each other. Their hate is mutual, there are no identical pairs among these, and no trainer hates himself (the world of Pokermon is a joyful place!). Each trainer has a wish-list of length li of teams he\xe2\x80\x99d like to join.Your task is to divide players into teams and the teams into two conferences, so that:   each trainer belongs to exactly one team;   no team is in both conferences;   total hate between conferences is at least e\xe2\x80\x89/\xe2\x80\x892;   every trainer is in a team from his wish-list. Total hate between conferences is calculated as the number of pairs of trainers from teams from different conferences who hate each other." 2400

717G Underfail flows "You have recently fallen through a hole and, after several hours of unconsciousness, have realized you are in an underground city. On one of your regular, daily walks through the unknown, you have encountered two unusually looking skeletons called Sanz and P\xe2\x80\x99pairus, who decided to accompany you and give you some puzzles for seemingly unknown reasons.One day, Sanz has created a crossword for you. Not any kind of crossword, but a 1D crossword! You are given m words and a string of length n. You are also given an array p, which designates how much each word is worth�\xe2\x80\x94 the i-th word is worth pi points. Whenever you find one of the m words in the string, you are given the corresponding number of points. Each position in the crossword can be used at most x times. A certain word can be counted at different places, but you cannot count the same appearance of a word multiple times. If a word is a substring of another word, you can count them both (presuming you haven\xe2\x80\x99t used the positions more than x times).In order to solve the puzzle, you need to tell Sanz what\xe2\x80\x99s the maximum achievable number of points in the crossword. There is no need to cover all postions, just get the maximal score! Crossword and words contain only lowercase English letters." 2400

717F "Heroes of Making Magic III" "data structures" "I\xe2\x80\x99m strolling on sunshine, yeah-ah! And doesn\xe2\x80\x99t it feel good! Well, it certainly feels good for our Heroes of Making Magic, who are casually walking on a one-directional road, fighting imps. Imps are weak and feeble creatures and they are not good at much. However, Heroes enjoy fighting them. For fun, if nothing else. Our Hero, Ignatius, simply adores imps. He is observing a line of imps, represented as a zero-indexed array of integers a of length n, where ai denotes the number of imps at the i-th position. Sometimes, imps can appear out of nowhere. When heroes fight imps, they select a segment of the line, start at one end of the segment, and finish on the other end, without ever exiting the segment. They can move exactly one cell left or right from their current position and when they do so, they defeat one imp on the cell that they moved to, so, the number of imps on that cell decreases by one. This also applies when heroes appear at one end of the segment, at the beginning of their walk. Their goal is to defeat all imps on the segment, without ever moving to an empty cell in it (without imps), since they would get bored. Since Ignatius loves imps, he doesn\xe2\x80\x99t really want to fight them, so no imps are harmed during the events of this task. However, he would like you to tell him whether it would be possible for him to clear a certain segment of imps in the above mentioned way if he wanted to. You are given q queries, which have two types:   1 a b k�\xe2\x80\x94 denotes that k imps appear at each cell from the interval [a,\xe2\x80\x89b]  2 a b - asks whether Ignatius could defeat all imps on the interval [a,\xe2\x80\x89b] in the way described above" 2600

717E "Paint it really, really dark gray" "dfs and similar" "I see a pink boar and I want it painted black. Black boars look much more awesome and mighty than the pink ones. Since Jaggy became the ruler of the forest, he has been trying his best to improve the diplomatic relations between the forest region and the nearby ones. Some other rulers, however, have requested too much in return for peace between their two regions, so he realized he has to resort to intimidation. Once a delegate for diplomatic relations of a neighboring region visits Jaggy\xe2\x80\x99s forest, if they see a whole bunch of black boars, they might suddenly change their mind about attacking Jaggy. Black boars are really scary, after all. Jaggy\xe2\x80\x99s forest can be represented as a tree (connected graph without cycles) with n vertices. Each vertex represents a boar and is colored either black or pink. Jaggy has sent a squirrel to travel through the forest and paint all the boars black. The squirrel, however, is quite unusually trained and while it traverses the graph, it changes the color of every vertex it visits, regardless of its initial color: pink vertices become black and black vertices become pink. Since Jaggy is too busy to plan the squirrel\xe2\x80\x99s route, he needs your help. He wants you to construct a walk through the tree starting from vertex 1 such that in the end all vertices are black. A walk is a sequence of vertices, such that every consecutive pair has an edge between them in a tree." 1900

717D "Dexterina\xe2\x80\x99s Lab" games,matrices,probabilities "I see a pink boar and I want it painted black. Black boars look much more awesome and mighty than the pink ones. Since Jaggy became the ruler of the forest, he has been trying his best to improve the diplomatic relations between the forest region and the nearby ones. Some other rulers, however, have requested too much in return for peace between their two regions, so he realized he has to resort to intimidation. Once a delegate for diplomatic relations of a neighboring region visits Jaggy\xe2\x80\x99s forest, if they see a whole bunch of black boars, they might suddenly change their mind about attacking Jaggy. Black boars are really scary, after all. Jaggy\xe2\x80\x99s forest can be represented as a tree (connected graph without cycles) with n vertices. Each vertex represents a boar and is colored either black or pink. Jaggy has sent a squirrel to travel through the forest and paint all the boars black. The squirrel, however, is quite unusually trained and while it traverses the graph, it changes the color of every vertex it visits, regardless of its initial color: pink vertices become black and black vertices become pink. Since Jaggy is too busy to plan the squirrel\xe2\x80\x99s route, he needs your help. He wants you to construct a walk through the tree starting from vertex 1 such that in the end all vertices are black. A walk is a sequence of vertices, such that every consecutive pair has an edge between them in a tree." 1900

717C "Potions Homework" implementation,sortings "Harry Water, Ronaldo, Her-my-oh-knee and their friends have started a new school year at their MDCS School of Speechcraft and Misery. At the time, they are very happy to have seen each other after a long time. The sun is shining, birds are singing, flowers are blooming, and their Potions class teacher, professor Snipe is sulky as usual. Due to his angst fueled by disappointment in his own life, he has given them a lot of homework in Potions class. Each of the n students has been assigned a single task. Some students do certain tasks faster than others. Thus, they want to redistribute the tasks so that each student still does exactly one task, and that all tasks are finished. Each student has their own laziness level, and each task has its own difficulty level. Professor Snipe is trying hard to improve their work ethics, so each student\xe2\x80\x99s laziness level is equal to their task\xe2\x80\x99s difficulty level. Both sets of values are given by the sequence a, where ai represents both the laziness level of the i-th student and the difficulty of his task. The time a student needs to finish a task is equal to the product of their laziness level and the task\xe2\x80\x99s difficulty. They are wondering, what is the minimum possible total time they must spend to finish all tasks if they distribute them in the optimal way. Each person should receive one task and each task should be given to one person. Print the answer modulo 10\xe2\x80\x89007." 1200

717B "R3D3\xe2\x80\x99s Summer Adventure" dp,greedy "Harry Water, Ronaldo, Her-my-oh-knee and their friends have started a new school year at their MDCS School of Speechcraft and Misery. At the time, they are very happy to have seen each other after a long time. The sun is shining, birds are singing, flowers are blooming, and their Potions class teacher, professor Snipe is sulky as usual. Due to his angst fueled by disappointment in his own life, he has given them a lot of homework in Potions class. Each of the n students has been assigned a single task. Some students do certain tasks faster than others. Thus, they want to redistribute the tasks so that each student still does exactly one task, and that all tasks are finished. Each student has their own laziness level, and each task has its own difficulty level. Professor Snipe is trying hard to improve their work ethics, so each student\xe2\x80\x99s laziness level is equal to their task\xe2\x80\x99s difficulty level. Both sets of values are given by the sequence a, where ai represents both the laziness level of the i-th student and the difficulty of his task. The time a student needs to finish a task is equal to the product of their laziness level and the task\xe2\x80\x99s difficulty. They are wondering, what is the minimum possible total time they must spend to finish all tasks if they distribute them in the optimal way. Each person should receive one task and each task should be given to one person. Print the answer modulo 10\xe2\x80\x89007." 2700

717A "Festival Organization" "combinatorics,math,number theory" "The Prodiggers are quite a cool band and for this reason, they have been the surprise guest at the ENTER festival for the past 80 years. At the beginning of their careers, they weren\xe2\x80\x99t so successful, so they had to spend time digging channels to earn money; hence the name. Anyway, they like to tour a lot and have surprising amounts of energy to do extremely long tours. However, they hate spending two consecutive days without having a concert, so they would like to avoid it.A tour is defined by a sequence of concerts and days-off. You need to count in how many ways The Prodiggers can select k different tours of the same length between l and r.For example if k\xe2\x80\x89=\xe2\x80\x892, l\xe2\x80\x89=\xe2\x80\x891 and r\xe2\x80\x89=\xe2\x80\x892, if we define concert day as {1} and day-off as {0}, here are all possible tours: {0}, {1}, {00}, {01}, {10}, {11}. But tour 00 can not be selected because it has 2 days-off in a row. Now, we need to count in how many ways we can select k\xe2\x80\x89=\xe2\x80\x892 tours of the same length in range [1;2]. Here they are: {0,1}; {01,10}; {01,11}; {10,11}.Since their schedule is quite busy, they want you to tell them in how many ways can do that, modulo 1\xe2\x80\x89000\xe2\x80\x89000\xe2\x80\x89007 (109\xe2\x80\x89+\xe2\x80\x897)." 2900

716B "Complete the Word" "greedy,two pointers" "ZS the Coder loves to read the dictionary. He thinks that a word is nice if there exists a substring (contiguous segment of letters) of it of length 26 where each letter of English alphabet appears exactly once. In particular, if the string has length strictly less than 26, no such substring exists and thus it is not nice.Now, ZS the Coder tells you a word, where some of its letters are missing as he forgot them. He wants to determine if it is possible to fill in the missing letters so that the resulting word is nice. If it is possible, he needs you to find an example of such a word as well. Can you help him?" 1300

716A "Crazy Computer" implementation "ZS the Coder is coding on a crazy computer. If you don\'t type in a word for a c consecutive seconds, everything you typed disappear! More formally, if you typed a word at second a and then the next word at second b, then if b\xe2\x80\x89-\xe2\x80\x89a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89c, just the new word is appended to other words on the screen. If b\xe2\x80\x89-\xe2\x80\x89a\xe2\x80\x89>\xe2\x80\x89c, then everything on the screen disappears and after that the word you have typed appears on the screen.For example, if c\xe2\x80\x89=\xe2\x80\x895 and you typed words at seconds 1,\xe2\x80\x893,\xe2\x80\x898,\xe2\x80\x8914,\xe2\x80\x8919,\xe2\x80\x8920 then at the second 8 there will be 3 words on the screen. After that, everything disappears at the second 13 because nothing was typed. At the seconds 14 and 19 another two words are typed, and finally, at the second 20, one more word is typed, and a total of 3 words remain on the screen.You\'re given the times when ZS the Coder typed the words. Determine how many words remain on the screen after he finished typing everything." 800

715E "Complete the Permutations" combinatorics,fft,graphs,math "ZS the Coder is given two permutations p and q of {1,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89n}, but some of their elements are replaced with 0. The distance between two permutations p and q is defined as the minimum number of moves required to turn p into q. A move consists of swapping exactly 2 elements of p.ZS the Coder wants to determine the number of ways to replace the zeros with positive integers from the set {1,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89n} such that p and q are permutations of {1,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89n} and the distance between p and q is exactly k.ZS the Coder wants to find the answer for all 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x891. Can you help him?" 3400

715D "Create a Maze" "constructive algorithms" "ZS the Coder loves mazes. Your job is to create one so that he can play with it. A maze consists of n\xe2\x80\x89\xc3\x97\xe2\x80\x89m rooms, and the rooms are arranged in n rows (numbered from the top to the bottom starting from 1) and m columns (numbered from the left to the right starting from 1). The room in the i-th row and j-th column is denoted by (i,\xe2\x80\x89j). A player starts in the room (1,\xe2\x80\x891) and wants to reach the room (n,\xe2\x80\x89m).Each room has four doors (except for ones at the maze border), one on each of its walls, and two adjacent by the wall rooms shares the same door. Some of the doors are locked, which means it is impossible to pass through the door. For example, if the door connecting (i,\xe2\x80\x89j) and (i,\xe2\x80\x89j\xe2\x80\x89+\xe2\x80\x891) is locked, then we can\'t go from (i,\xe2\x80\x89j) to (i,\xe2\x80\x89j\xe2\x80\x89+\xe2\x80\x891). Also, one can only travel between the rooms downwards (from the room (i,\xe2\x80\x89j) to the room (i\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89j)) or rightwards (from the room (i,\xe2\x80\x89j) to the room (i,\xe2\x80\x89j\xe2\x80\x89+\xe2\x80\x891)) provided the corresponding door is not locked.  This image represents a maze with some doors locked. The colored arrows denotes all the possible paths while a red cross denotes a locked door. ZS the Coder considers a maze to have difficulty x if there is exactly x ways of travelling from the room (1,\xe2\x80\x891) to the room (n,\xe2\x80\x89m). Two ways are considered different if they differ by the sequence of rooms visited while travelling.Your task is to create a maze such that its difficulty is exactly equal to T. In addition, ZS the Coder doesn\'t like large mazes, so the size of the maze and the number of locked doors are limited. Sounds simple enough, right?" 3100

715C "Digit Tree" "dfs and similar,divide and conquer,dsu,trees" "ZS the Coder has a large tree. It can be represented as an undirected connected graph of n vertices numbered from 0 to n\xe2\x80\x89-\xe2\x80\x891 and n\xe2\x80\x89-\xe2\x80\x891 edges between them. There is a single nonzero digit written on each edge.One day, ZS the Coder was bored and decided to investigate some properties of the tree. He chose a positive integer M, which is coprime to 10, i.e. .ZS consider an ordered pair of distinct vertices (u,\xe2\x80\x89v) interesting when if he would follow the shortest path from vertex u to vertex v and write down all the digits he encounters on his path in the same order, he will get a decimal representaion of an integer divisible by M.Formally, ZS consider an ordered pair of distinct vertices (u,\xe2\x80\x89v) interesting if the following states true:  Let a1\xe2\x80\x89=\xe2\x80\x89u,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89ak\xe2\x80\x89=\xe2\x80\x89v be the sequence of vertices on the shortest path from u to v in the order of encountering them;  Let di (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89k) be the digit written on the edge between vertices ai and ai\xe2\x80\x89+\xe2\x80\x891;  The integer  is divisible by M. Help ZS the Coder find the number of interesting pairs!" 2700

715B "Complete The Graph" "binary search,constructive algorithms,graphs,shortest paths" "ZS the Coder has drawn an undirected graph of n vertices numbered from 0 to n\xe2\x80\x89-\xe2\x80\x891 and m edges between them. Each edge of the graph is weighted, each weight is a positive integer.The next day, ZS the Coder realized that some of the weights were erased! So he wants to reassign positive integer weight to each of the edges which weights were erased, so that the length of the shortest path between vertices s and t in the resulting graph is exactly L. Can you help him?" 2300

715A "Plus and Square Root" "constructive algorithms,math" "ZS the Coder is playing a game. There is a number displayed on the screen and there are two buttons, \'\xe2\x80\x89+\xe2\x80\x89\' (plus) and \'\' (square root). Initially, the number 2 is displayed on the screen. There are n\xe2\x80\x89+\xe2\x80\x891 levels in the game and ZS the Coder start at the level 1.When ZS the Coder is at level k, he can :  Press the \'\xe2\x80\x89+\xe2\x80\x89\' button. This increases the number on the screen by exactly k. So, if the number on the screen was x, it becomes x\xe2\x80\x89+\xe2\x80\x89k. Press the \'\' button. Let the number on the screen be x. After pressing this button, the number becomes . After that, ZS the Coder levels up, so his current level becomes k\xe2\x80\x89+\xe2\x80\x891. This button can only be pressed when x is a perfect square, i.e. x\xe2\x80\x89=\xe2\x80\x89m2 for some positive integer m. Additionally, after each move, if ZS the Coder is at level k, and the number on the screen is m, then m must be a multiple of k. Note that this condition is only checked after performing the press. For example, if ZS the Coder is at level 4 and current number is 100, he presses the \'\' button and the number turns into 10. Note that at this moment, 10 is not divisible by 4, but this press is still valid, because after it, ZS the Coder is at level 5, and 10 is divisible by 5.ZS the Coder needs your help in beating the game�\xe2\x80\x94 he wants to reach level n\xe2\x80\x89+\xe2\x80\x891. In other words, he needs to press the \'\' button n times. Help him determine the number of times he should press the \'\xe2\x80\x89+\xe2\x80\x89\' button before pressing the \'\' button at each level. Please note that ZS the Coder wants to find just any sequence of presses allowing him to reach level n\xe2\x80\x89+\xe2\x80\x891, but not necessarily a sequence minimizing the number of presses." 1600

714B "Filya and Homework" implementation,sortings "Today, hedgehog Filya went to school for the very first time! Teacher gave him a homework which Filya was unable to complete without your help.Filya is given an array of non-negative integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. First, he pick an integer x and then he adds x to some elements of the array (no more than once), subtract x from some other elements (also, no more than once) and do no change other elements. He wants all elements of the array to be equal.Now he wonders if it\'s possible to pick such integer x and change some elements of the array using this x in order to make all elements equal." 1200

714A "Meeting of Old Friends" implementation,math "Today an outstanding event is going to happen in the forest�\xe2\x80\x94 hedgehog Filya will come to his old fried Sonya!Sonya is an owl and she sleeps during the day and stay awake from minute l1 to minute r1 inclusive. Also, during the minute k she prinks and is unavailable for Filya.Filya works a lot and he plans to visit Sonya from minute l2 to minute r2 inclusive.Calculate the number of minutes they will be able to spend together." 1100

713E "Sonya Partymaker" "binary search,dp" "Owl Sonya decided to become a partymaker. To train for this role she gather all her owl friends in the country house. There are m chairs located in a circle and consequently numbered with integers from 1 to m. Thus, chairs i and i\xe2\x80\x89+\xe2\x80\x891 are neighbouring for all i from 1 to m\xe2\x80\x89-\xe2\x80\x891. Chairs 1 and m are also neighbouring. Some chairs are occupied by her friends. There are n friends in total. No two friends occupy the same chair. Rules are the following:  Each participant removes from the game the chair he is currently sitting on.  Each of the participants choose a direction that she will follow: clockwise (indices increase, from m goes to 1) and counter-clockwise (indices decrease, from 1 goes to m). This direction may coincide or be different for any pair of owls.  Each turn all guests move one step in the chosen directions. If some guest move to the position with a chair there, he removes this chair from the game.  Game ends if there are no more chairs left in the game. Owls are very busy and want to get rid of the game as soon as possible. They cooperate to pick the direction. Your goal is to find the minimum number o moves required to finish the game." 3300

713D "Animals and Puzzle" "binary search,data structures" "Owl Sonya gave a huge lake puzzle of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m to hedgehog Filya as a birthday present. Friends immediately started to assemble the puzzle, but some parts of it turned out to be empty�\xe2\x80\x94 there was no picture on them. Parts with picture on it are denoted by 1, while empty parts are denoted by 0. Rows of the puzzle are numbered from top to bottom with integers from 1 to n, while columns are numbered from left to right with integers from 1 to m.Animals decided to complete the picture and play with it, as it might be even more fun! Owl and hedgehog ask each other some queries. Each query is provided by four integers x1, y1, x2, y2 which define the rectangle, where (x1,\xe2\x80\x89y1) stands for the coordinates of the up left cell of the rectangle, while (x2,\xe2\x80\x89y2) stands for the coordinates of the bottom right cell. The answer to the query is the size of the maximum square consisting of picture parts only (only parts denoted by 1) and located fully inside the query rectangle.Help Sonya and Filya answer t queries." 2700

713C "Sonya and Problem Wihtout a Legend" dp,sortings "Sonya was unable to think of a story for this problem, so here comes the formal description.You are given the array containing n positive integers. At one turn you can pick any element and increase or decrease it by 1. The goal is the make the array strictly increasing by making the minimum possible number of operations. You are allowed to change elements in any way, they can become negative or equal to 0." 2300

713B "Searching Rectangles" "binary search,constructive algorithms,interactive" "Filya just learned new geometry object�\xe2\x80\x94 rectangle. He is given a field consisting of n\xe2\x80\x89\xc3\x97\xe2\x80\x89n unit cells. Rows are numbered from bottom to top with integer from 1 to n. Columns are numbered from left to right with integers from 1 to n. Cell, located at the intersection of the row r and column c is denoted as (r,\xe2\x80\x89c). Filya has painted two rectangles, such that their sides are parallel to coordinate axes and each cell lies fully inside or fully outside each of them. Moreover, no cell lies in both rectangles.Later, hedgehog Filya became interested in the location of his rectangles but was unable to find the sheet of paper they were painted on. They were taken by Sonya and now she wants to play a little game with Filya. He tells her a query rectangle and she replies with the number of initial rectangles that lie fully inside the given query rectangle. The query rectangle should match the same conditions as initial rectangles. Rectangle lies fully inside the query if each o its cells lies inside the query.Filya knows Sonya really well, so is sure that if he asks more than 200 questions she will stop to reply." 2200

713A "Sonya and Queries" "data structures,implementation" "Today Sonya learned about long integers and invited all her friends to share the fun. Sonya has an initially empty multiset with integers. Friends give her t queries, each of one of the following type:  \xe2\x80\x89+\xe2\x80\x89 ai�\xe2\x80\x94 add non-negative integer ai to the multiset. Note, that she has a multiset, thus there may be many occurrences of the same integer.  \xe2\x80\x89-\xe2\x80\x89 ai�\xe2\x80\x94 delete a single occurrence of non-negative integer ai from the multiset. It\'s guaranteed, that there is at least one ai in the multiset.  ? s�\xe2\x80\x94 count the number of integers in the multiset (with repetitions) that match some pattern s consisting of 0 and 1. In the pattern, 0 stands for the even digits, while 1 stands for the odd. Integer x matches the pattern s, if the parity of the i-th from the right digit in decimal notation matches the i-th from the right digit of the pattern. If the pattern is shorter than this integer, it\'s supplemented with 0-s from the left. Similarly, if the integer is shorter than the pattern its decimal notation is supplemented with the 0-s from the left. For example, if the pattern is s\xe2\x80\x89=\xe2\x80\x89010, than integers 92, 2212, 50 and 414 match the pattern, while integers 3, 110, 25 and 1030 do not." 1400

712E "Memory and Casinos" "data structures,math,probabilities" "There are n casinos lined in a row. If Memory plays at casino i, he has probability pi to win and move to the casino on the right (i\xe2\x80\x89+\xe2\x80\x891) or exit the row (if i\xe2\x80\x89=\xe2\x80\x89n), and a probability 1\xe2\x80\x89-\xe2\x80\x89pi to lose and move to the casino on the left (i\xe2\x80\x89-\xe2\x80\x891) or also exit the row (if i\xe2\x80\x89=\xe2\x80\x891). We say that Memory dominates on the interval i... j if he completes a walk such that,  He starts on casino i.  He never looses in casino i.  He finishes his walk by winning in casino j. Note that Memory can still walk left of the 1-st casino and right of the casino n and that always finishes the process.Now Memory has some requests, in one of the following forms:  1 i a b: Set .  2 l r: Print the probability that Memory will dominate on the interval l... r, i.e. compute the probability that Memory will first leave the segment l... r after winning at casino r, if she starts in casino l. It is guaranteed that at any moment of time p is a non-decreasing sequence, i.e. pi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89pi\xe2\x80\x89+\xe2\x80\x891 for all i from 1 to n\xe2\x80\x89-\xe2\x80\x891.Please help Memory by answering all his requests!" 2500

712D "Memory and Scores" combinatorics,dp,math "Memory and his friend Lexa are competing to get higher score in one popular computer game. Memory starts with score a and Lexa starts with score b. In a single turn, both Memory and Lexa get some integer in the range [\xe2\x80\x89-\xe2\x80\x89k;k] (i.e. one integer among \xe2\x80\x89-\xe2\x80\x89k,\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x89k\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x89k\xe2\x80\x89+\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x892,\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x890,\xe2\x80\x891,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89k\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89k) and add them to their current scores. The game has exactly t turns. Memory and Lexa, however, are not good at this game, so they both always get a random integer at their turn.Memory wonders how many possible games exist such that he ends with a strictly higher score than Lexa. Two games are considered to be different if in at least one turn at least one player gets different score. There are (2k\xe2\x80\x89+\xe2\x80\x891)2t games in total. Since the answer can be very large, you should print it modulo 109\xe2\x80\x89+\xe2\x80\x897. Please solve this problem for Memory." 2200

712C "Memory and De-Evolution" greedy,math "Memory is now interested in the de-evolution of objects, specifically triangles. He starts with an equilateral triangle of side length x, and he wishes to perform operations to obtain an equilateral triangle of side length y.In a single second, he can modify the length of a single side of the current triangle such that it remains a non-degenerate triangle (triangle of positive area). At any moment of time, the length of each side should be integer.What is the minimum number of seconds required for Memory to obtain the equilateral triangle of side length y?" 1600

712B "Memory and Trident" implementation,strings "Memory is performing a walk on the two-dimensional plane, starting at the origin. He is given a string s with his directions for motion: An \'L\' indicates he should move one unit left.  An \'R\' indicates he should move one unit right.  A \'U\' indicates he should move one unit up.  A \'D\' indicates he should move one unit down.But now Memory wants to end at the origin. To do this, he has a special trident. This trident can replace any character in s with any of \'L\', \'R\', \'U\', or \'D\'. However, because he doesn\'t want to wear out the trident, he wants to make the minimum number of edits possible. Please tell Memory what is the minimum number of changes he needs to make to produce a string that, when walked, will end at the origin, or if there is no such string." 1100

712A "Memory and Crow" implementation,math "There are n integers b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bn written in a row. For all i from 1 to n, values ai are defined by the crows performing the following procedure:  The crow sets ai initially 0.  The crow then adds bi to ai, subtracts bi\xe2\x80\x89+\xe2\x80\x891, adds the bi\xe2\x80\x89+\xe2\x80\x892 number, and so on until the n\'th number. Thus, ai\xe2\x80\x89=\xe2\x80\x89bi\xe2\x80\x89-\xe2\x80\x89bi\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x89bi\xe2\x80\x89+\xe2\x80\x892\xe2\x80\x89-\xe2\x80\x89bi\xe2\x80\x89+\xe2\x80\x893.... Memory gives you the values a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an, and he now wants you to find the initial numbers b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bn written in the row? Can you do it?" 800

711E "ZS and The Birthday Paradox" "math,number theory,probabilities" "ZS the Coder has recently found an interesting concept called the Birthday Paradox. It states that given a random set of 23 people, there is around 50% chance that some two of them share the same birthday. ZS the Coder finds this very interesting, and decides to test this with the inhabitants of Udayland.In Udayland, there are 2n days in a year. ZS the Coder wants to interview k people from Udayland, each of them has birthday in one of 2n days (each day with equal probability). He is interested in the probability of at least two of them have the birthday at the same day. ZS the Coder knows that the answer can be written as an irreducible fraction . He wants to find the values of A and B (he does not like to deal with floating point numbers). Can you help him?" 2300

711D "Directed Roads" "combinatorics,dfs and similar,graphs,math" "ZS the Coder and Chris the Baboon has explored Udayland for quite some time. They realize that it consists of n towns numbered from 1 to n. There are n directed roads in the Udayland. i-th of them goes from town i to some other town ai (ai\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89i). ZS the Coder can flip the direction of any road in Udayland, i.e. if it goes from town A to town B before the flip, it will go from town B to town A after.ZS the Coder considers the roads in the Udayland confusing, if there is a sequence of distinct towns A1,\xe2\x80\x89A2,\xe2\x80\x89...,\xe2\x80\x89Ak (k\xe2\x80\x89>\xe2\x80\x891) such that for every 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89k there is a road from town Ai to town Ai\xe2\x80\x89+\xe2\x80\x891 and another road from town Ak to town A1. In other words, the roads are confusing if some of them form a directed cycle of some towns.Now ZS the Coder wonders how many sets of roads (there are 2n variants) in initial configuration can he choose to flip such that after flipping each road in the set exactly once, the resulting network will not be confusing.Note that it is allowed that after the flipping there are more than one directed road from some town and possibly some towns with no roads leading out of it, or multiple roads between any pair of cities." 1900

711C "Coloring Trees" dp "ZS the Coder and Chris the Baboon has arrived at Udayland! They walked in the park where n trees grow. They decided to be naughty and color the trees in the park. The trees are numbered with integers from 1 to n from left to right.Initially, tree i has color ci. ZS the Coder and Chris the Baboon recognizes only m different colors, so 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ci\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m, where ci\xe2\x80\x89=\xe2\x80\x890 means that tree i is uncolored.ZS the Coder and Chris the Baboon decides to color only the uncolored trees, i.e. the trees with ci\xe2\x80\x89=\xe2\x80\x890. They can color each of them them in any of the m colors from 1 to m. Coloring the i-th tree with color j requires exactly pi,\xe2\x80\x89j litres of paint.The two friends define the beauty of a coloring of the trees as the minimum number of contiguous groups (each group contains some subsegment of trees) you can split all the n trees into so that each group contains trees of the same color. For example, if the colors of the trees from left to right are 2,\xe2\x80\x891,\xe2\x80\x891,\xe2\x80\x891,\xe2\x80\x893,\xe2\x80\x892,\xe2\x80\x892,\xe2\x80\x893,\xe2\x80\x891,\xe2\x80\x893, the beauty of the coloring is 7, since we can partition the trees into 7 contiguous groups of the same color : {2},\xe2\x80\x89{1,\xe2\x80\x891,\xe2\x80\x891},\xe2\x80\x89{3},\xe2\x80\x89{2,\xe2\x80\x892},\xe2\x80\x89{3},\xe2\x80\x89{1},\xe2\x80\x89{3}. ZS the Coder and Chris the Baboon wants to color all uncolored trees so that the beauty of the coloring is exactly k. They need your help to determine the minimum amount of paint (in litres) needed to finish the job.Please note that the friends can\'t color the trees that are already colored." 1700

711B "Chris and Magic Square" "constructive algorithms,implementation" "ZS the Coder and Chris the Baboon arrived at the entrance of Udayland. There is a n\xe2\x80\x89\xc3\x97\xe2\x80\x89n magic grid on the entrance which is filled with integers. Chris noticed that exactly one of the cells in the grid is empty, and to enter Udayland, they need to fill a positive integer into the empty cell.Chris tried filling in random numbers but it didn\'t work. ZS the Coder realizes that they need to fill in a positive integer such that the numbers in the grid form a magic square. This means that he has to fill in a positive integer so that the sum of the numbers in each row of the grid (), each column of the grid (), and the two long diagonals of the grid (the main diagonal�\xe2\x80\x94  and the secondary diagonal�\xe2\x80\x94 ) are equal. Chris doesn\'t know what number to fill in. Can you help Chris find the correct positive integer to fill in or determine that it is impossible?" 1400

711A "Bus to Udayland" "brute force,implementation" "ZS the Coder and Chris the Baboon are travelling to Udayland! To get there, they have to get on the special IOI bus. The IOI bus has n rows of seats. There are 4 seats in each row, and the seats are separated into pairs by a walkway. When ZS and Chris came, some places in the bus was already occupied.ZS and Chris are good friends. They insist to get a pair of neighbouring empty seats. Two seats are considered neighbouring if they are in the same row and in the same pair. Given the configuration of the bus, can you help ZS and Chris determine where they should sit?" 800

710F "String Set Queries" "brute force,data structures,hashing,interactive,string suffix structures,strings" "You should process m queries over a set D of strings. Each query is one of three kinds:  Add a string s to the set D. It is guaranteed that the string s was not added before.  Delete a string s from the set D. It is guaranteed that the string s is in the set D.  For the given string s find the number of occurrences of the strings from the set D. If some string p from D has several occurrences in s you should count all of them. Note that you should solve the problem in online mode. It means that you can\'t read the whole input at once. You can read each query only after writing the answer for the last query of the third type. Use functions fflush in C++ and BufferedWriter.flush in Java languages after each writing in your program." 2400

710E "Generate a String" "dfs and similar,dp" "zscoder wants to generate an input file for some programming competition problem.His input is a string consisting of n letters \'a\'. He is too lazy to write a generator so he will manually generate the input in a text editor.Initially, the text editor is empty. It takes him x seconds to insert or delete a letter \'a\' from the text file and y seconds to copy the contents of the entire text file, and duplicate it.zscoder wants to find the minimum amount of time needed for him to create the input file of exactly n letters \'a\'. Help him to determine the amount of time needed to generate the input." 2000

710D "Two Arithmetic Progressions" "math,number theory" "You are given two arithmetic progressions: a1k\xe2\x80\x89+\xe2\x80\x89b1 and a2l\xe2\x80\x89+\xe2\x80\x89b2. Find the number of integers x such that L\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89R and x\xe2\x80\x89=\xe2\x80\x89a1k\'\xe2\x80\x89+\xe2\x80\x89b1\xe2\x80\x89=\xe2\x80\x89a2l\'\xe2\x80\x89+\xe2\x80\x89b2, for some integers k\',\xe2\x80\x89l\'\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x890." 2500

710C "Magic Odd Square" "constructive algorithms,math" "Find an n\xe2\x80\x89\xc3\x97\xe2\x80\x89n matrix with different numbers from 1 to n2, so the sum in each row, column and both main diagonals are odd." 1500

710B "Optimal Point on a Line" "brute force,sortings" "You are given n points on a line with their coordinates xi. Find the point x so the sum of distances to the given points is minimal." 1400

710A "King Moves" implementation "The only king stands on the standard chess board. You are given his position in format ""cd"", where c is the column from \'a\' to \'h\' and d is the row from \'1\' to \'8\'. Find the number of moves permitted for the king.Check the king\'s moves here https://en.wikipedia.org/wiki/King_(chess).  King moves from the position e4" 800

709B Checkpoints greedy,implementation,sortings "Vasya takes part in the orienteering competition. There are n checkpoints located along the line at coordinates x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xn. Vasya starts at the point with coordinate a. His goal is to visit at least n\xe2\x80\x89-\xe2\x80\x891 checkpoint in order to finish the competition. Participant are allowed to visit checkpoints in arbitrary order.Vasya wants to pick such checkpoints and the order of visiting them that the total distance travelled is minimized. He asks you to calculate this minimum possible value." 1500

709A Juicer implementation "Kolya is going to make fresh orange juice. He has n oranges of sizes a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. Kolya will put them in the juicer in the fixed order, starting with orange of size a1, then orange of size a2 and so on. To be put in the juicer the orange must have size not exceeding b, so if Kolya sees an orange that is strictly greater he throws it away and continues with the next one.The juicer has a special section to collect waste. It overflows if Kolya squeezes oranges of the total size strictly greater than d. When it happens Kolya empties the waste section (even if there are no more oranges) and continues to squeeze the juice. How many times will he have to empty the waste section?" 900

708E "Student\'s Camp" dp,math "Kolya is going to make fresh orange juice. He has n oranges of sizes a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. Kolya will put them in the juicer in the fixed order, starting with orange of size a1, then orange of size a2 and so on. To be put in the juicer the orange must have size not exceeding b, so if Kolya sees an orange that is strictly greater he throws it away and continues with the next one.The juicer has a special section to collect waste. It overflows if Kolya squeezes oranges of the total size strictly greater than d. When it happens Kolya empties the waste section (even if there are no more oranges) and continues to squeeze the juice. How many times will he have to empty the waste section?" 3100

708D "Incorrect Flow" flows "At the entrance examination for the magistracy of the MSU Cyber-Mechanics Department Sasha got the question about Ford-Fulkerson algorithm. He knew the topic perfectly as he worked with it many times on programming competition. As the task for the question he was given a network with partially build flow that he had to use in order to demonstrate the workflow of the algorithm. He quickly finished to write the text and took a look at the problem only to understand that the given network is incorrect!Suppose you are given a directed graph G(V,\xe2\x80\x89E) with two special nodes s and t called source and sink. We denote as n the number of nodes in the graph, i.e. n\xe2\x80\x89=\xe2\x80\x89|V| and m stands for the number of directed edges in the graph, i.e. m\xe2\x80\x89=\xe2\x80\x89|E|. For the purpose of this problem we always consider node 1 to be the source and node n to be the sink. In addition, for each edge of the graph e we define the capacity function c(e) and flow function f(e). Function f(e) represents the correct flow if the following conditions are satisfied:  For each edge  the flow is non-negative and does not exceed capacity c(e), i.e. 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89f(e)\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89c(e).  For each node , that is not source or sink (v\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89s and v\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89t) the sum of flows of all edges going in v is equal to the sum of the flows among all edges going out from v. In other words, there is no flow stuck in v. It was clear that as the exam was prepared last night and there are plenty of mistakes in the tasks. Sasha asked one of the professors to fix the network or give the correct task, but the reply was that the magistrate student should be able to fix the network himself. As the professor doesn\'t want the task to become easier, he asks Sasha to fix the network in a such way that the total number of changes is minimum possible. Sasha is not allowed to remove edges, add new ones or reverse the direction of existing edges. The only thing he is able to do is to change capacity function c(e) and flow function f(e). Moreover, all the values should remain non-negative integers. There is no requirement on the flow to be maximum in any sense.Find the minimum possible total change of the functions f(e) and c(e) that Sasha has to make in order to make the flow correct. The total change is defined as the sum of absolute differences, i.e. if new functions are f\xe2\x80\x89*\xe2\x80\x89(e) and c\xe2\x80\x89*\xe2\x80\x89(e), then the total change is ." 2900

708C Centroids "data structures,dfs and similar,dp,graphs,greedy,trees" "Tree is a connected acyclic graph. Suppose you are given a tree consisting of n vertices. The vertex of this tree is called centroid if the size of each connected component that appears if this vertex is removed from the tree doesn\'t exceed .You are given a tree of size n and can perform no more than one edge replacement. Edge replacement is the operation of removing one edge from the tree (without deleting incident vertices) and inserting one new edge (without adding new vertices) in such a way that the graph remains a tree. For each vertex you have to determine if it\'s possible to make it centroid by performing no more than one edge replacement." 2300

708B "Recover the String" "constructive algorithms,greedy,implementation,math" "For each string s consisting of characters \'0\' and \'1\' one can define four integers a00, a01, a10 and a11, where axy is the number of subsequences of length 2 of the string s equal to the sequence {x,\xe2\x80\x89y}. In these problem you are given four integers a00, a01, a10, a11 and have to find any non-empty string s that matches them, or determine that there is no such string. One can prove that if at least one answer exists, there exists an answer of length no more than 1\xe2\x80\x89000\xe2\x80\x89000." 1900

708A "Letters Cyclic Shift" "constructive algorithms,greedy,implementation,strings" "You are given a non-empty string s consisting of lowercase English letters. You have to pick exactly one non-empty substring of s and shift all its letters \'z\'  \'y\'  \'x\'  \'b\'  \'a\'  \'z\'. In other words, each character is replaced with the previous character of English alphabet and \'a\' is replaced with \'z\'.What is the lexicographically minimum string that can be obtained from s by performing this shift exactly once?" 1200

707E Garlands "data structures" "Like all children, Alesha loves New Year celebration. During the celebration he and his whole family dress up the fir-tree. Like all children, Alesha likes to play with garlands�\xe2\x80\x94 chains consisting of a lightbulbs.Alesha uses a grid field sized n\xe2\x80\x89\xc3\x97\xe2\x80\x89m for playing. The rows of the field are numbered from 1 to n from the top to the bottom and columns are numbered from 1 to m from the left to the right.Alesha has k garlands which he places at the field. He does so in the way such that each lightbulb of each garland lies in the center of some cell in the field, and each cell contains at most one lightbulb. Of course lightbulbs, which are neighbours in some garland, appears in cells neighbouring by a side.The example of garland placing.Each garland is turned off or turned on at any moment. If some garland is turned on then each of its lightbulbs is turned on, the same applies for garland turned off. Each lightbulb in the whole garland set is unique, and thus, being turned on, brings Alesha some pleasure, described by an integer value. Turned off lightbulbs don\'t bring Alesha any pleasure.Alesha can turn garlands on and off and wants to know the sum of pleasure value which the lightbulbs, placed in the centers of the cells in some rectangular part of the field, bring him. Initially all the garlands are turned on.Alesha is still very little and can\'t add big numbers. He extremely asks you to help him." 2400

707D "Persistent Bookcase" "bitmasks,data structures,dfs and similar,implementation" "Recently in school Alina has learned what are the persistent data structures: they are data structures that always preserves the previous version of itself and access to it when it is modified.After reaching home Alina decided to invent her own persistent data structure. Inventing didn\'t take long: there is a bookcase right behind her bed. Alina thinks that the bookcase is a good choice for a persistent data structure. Initially the bookcase is empty, thus there is no book at any position at any shelf.The bookcase consists of n shelves, and each shelf has exactly m positions for books at it. Alina enumerates shelves by integers from 1 to n and positions at shelves�\xe2\x80\x94 from 1 to m. Initially the bookcase is empty, thus there is no book at any position at any shelf in it.Alina wrote down q operations, which will be consecutively applied to the bookcase. Each of the operations has one of four types: 1 i j�\xe2\x80\x94 Place a book at position j at shelf i if there is no book at it. 2 i j�\xe2\x80\x94 Remove the book from position j at shelf i if there is a book at it. 3 i�\xe2\x80\x94 Invert book placing at shelf i. This means that from every position at shelf i which has a book at it, the book should be removed, and at every position at shelf i which has not book at it, a book should be placed. 4 k�\xe2\x80\x94 Return the books in the bookcase in a state they were after applying k-th operation. In particular, k\xe2\x80\x89=\xe2\x80\x890 means that the bookcase should be in initial state, thus every book in the bookcase should be removed from its position.After applying each of operation Alina is interested in the number of books in the bookcase. Alina got \'A\' in the school and had no problem finding this values. Will you do so?" 2200

707C "Pythagorean Triples" "math,number theory" "Katya studies in a fifth grade. Recently her class studied right triangles and the Pythagorean theorem. It appeared, that there are triples of positive integers such that you can construct a right triangle with segments of lengths corresponding to triple. Such triples are called Pythagorean triples.For example, triples (3,\xe2\x80\x894,\xe2\x80\x895), (5,\xe2\x80\x8912,\xe2\x80\x8913) and (6,\xe2\x80\x898,\xe2\x80\x8910) are Pythagorean triples.Here Katya wondered if she can specify the length of some side of right triangle and find any Pythagorean triple corresponding to such length? Note that the side which length is specified can be a cathetus as well as hypotenuse.Katya had no problems with completing this task. Will you do the same?" 1500

707B Bakery graphs "Masha wants to open her own bakery and bake muffins in one of the n cities numbered from 1 to n. There are m bidirectional roads, each of whose connects some pair of cities.To bake muffins in her bakery, Masha needs to establish flour supply from some storage. There are only k storages, located in different cities numbered a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89ak.Unforunately the law of the country Masha lives in prohibits opening bakery in any of the cities which has storage located in it. She can open it only in one of another n\xe2\x80\x89-\xe2\x80\x89k cities, and, of course, flour delivery should be paid�\xe2\x80\x94 for every kilometer of path between storage and bakery Masha should pay 1 ruble.Formally, Masha will pay x roubles, if she will open the bakery in some city b (ai\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89b for every 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k) and choose a storage in some city s (s\xe2\x80\x89=\xe2\x80\x89aj for some 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k) and b and s are connected by some path of roads of summary length x (if there are more than one path, Masha is able to choose which of them should be used).Masha is very thrifty and rational. She is interested in a city, where she can open her bakery (and choose one of k storages and one of the paths between city with bakery and city with storage) and pay minimum possible amount of rubles for flour delivery. Please help Masha find this amount." 1300

707A "Brain\'s Photos" implementation "Masha wants to open her own bakery and bake muffins in one of the n cities numbered from 1 to n. There are m bidirectional roads, each of whose connects some pair of cities.To bake muffins in her bakery, Masha needs to establish flour supply from some storage. There are only k storages, located in different cities numbered a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89ak.Unforunately the law of the country Masha lives in prohibits opening bakery in any of the cities which has storage located in it. She can open it only in one of another n\xe2\x80\x89-\xe2\x80\x89k cities, and, of course, flour delivery should be paid�\xe2\x80\x94 for every kilometer of path between storage and bakery Masha should pay 1 ruble.Formally, Masha will pay x roubles, if she will open the bakery in some city b (ai\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89b for every 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k) and choose a storage in some city s (s\xe2\x80\x89=\xe2\x80\x89aj for some 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k) and b and s are connected by some path of roads of summary length x (if there are more than one path, Masha is able to choose which of them should be used).Masha is very thrifty and rational. She is interested in a city, where she can open her bakery (and choose one of k storages and one of the paths between city with bakery and city with storage) and pay minimum possible amount of rubles for flour delivery. Please help Masha find this amount." 800

706E "Working routine" "data structures,implementation" "Vasiliy finally got to work, where there is a huge amount of tasks waiting for him. Vasiliy is given a matrix consisting of n rows and m columns and q tasks. Each task is to swap two submatrices of the given matrix.For each task Vasiliy knows six integers ai, bi, ci, di, hi, wi, where ai is the index of the row where the top-left corner of the first rectangle is located, bi is the index of its column, ci is the index of the row of the top-left corner of the second rectangle, di is the index of its column, hi is the height of the rectangle and wi is its width.It\'s guaranteed that two rectangles in one query do not overlap and do not touch, that is, no cell belongs to both rectangles, and no two cells belonging to different rectangles share a side. However, rectangles are allowed to share an angle.Vasiliy wants to know how the matrix will look like after all tasks are performed." 2500

706D "Vasiliy\'s Multiset" "binary search,bitmasks,data structures,trees" "Vasiliy finally got to work, where there is a huge amount of tasks waiting for him. Vasiliy is given a matrix consisting of n rows and m columns and q tasks. Each task is to swap two submatrices of the given matrix.For each task Vasiliy knows six integers ai, bi, ci, di, hi, wi, where ai is the index of the row where the top-left corner of the first rectangle is located, bi is the index of its column, ci is the index of the row of the top-left corner of the second rectangle, di is the index of its column, hi is the height of the rectangle and wi is its width.It\'s guaranteed that two rectangles in one query do not overlap and do not touch, that is, no cell belongs to both rectangles, and no two cells belonging to different rectangles share a side. However, rectangles are allowed to share an angle.Vasiliy wants to know how the matrix will look like after all tasks are performed." 1800

706C "Hard problem" dp,strings "Vasiliy is fond of solving different tasks. Today he found one he wasn\'t able to solve himself, so he asks you to help.Vasiliy is given n strings consisting of lowercase English letters. He wants them to be sorted in lexicographical order (as in the dictionary), but he is not allowed to swap any of them. The only operation he is allowed to do is to reverse any of them (first character becomes last, second becomes one before last and so on).To reverse the i-th string Vasiliy has to spent ci units of energy. He is interested in the minimum amount of energy he has to spent in order to have strings sorted in lexicographical order.String A is lexicographically smaller than string B if it is shorter than B (|A|\xe2\x80\x89<\xe2\x80\x89|B|) and is its prefix, or if none of them is a prefix of the other and at the first position where they differ character in A is smaller than the character in B.For the purpose of this problem, two equal strings nearby do not break the condition of sequence being sorted lexicographically." 1600

706B "Interesting drink" "binary search,dp,implementation" "Vasiliy likes to rest after a hard work, so you may often meet him in some bar nearby. As all programmers do, he loves the famous drink ""Beecola"", which can be bought in n different shops in the city. It\'s known that the price of one bottle in the shop i is equal to xi coins.Vasiliy plans to buy his favorite drink for q consecutive days. He knows, that on the i-th day he will be able to spent mi coins. Now, for each of the days he want to know in how many different shops he can buy a bottle of ""Beecola""." 1100

706A Beru-taxi "brute force,geometry,implementation" "Vasiliy lives at point (a,\xe2\x80\x89b) of the coordinate plane. He is hurrying up to work so he wants to get out of his house as soon as possible. New app suggested n available Beru-taxi nearby. The i-th taxi is located at point (xi,\xe2\x80\x89yi) and moves with a speed vi. Consider that each of n drivers will move directly to Vasiliy and with a maximum possible speed. Compute the minimum time when Vasiliy will get in any of Beru-taxi cars." 900

705B "Spider Man" games,math "Peter Parker wants to play a game with Dr. Octopus. The game is about cycles. Cycle is a sequence of vertices, such that first one is connected with the second, second is connected with third and so on, while the last one is connected with the first one again. Cycle may consist of a single isolated vertex.Initially there are k cycles, i-th of them consisting of exactly vi vertices. Players play alternatively. Peter goes first. On each turn a player must choose a cycle with at least 2 vertices (for example, x vertices) among all available cycles and replace it by two cycles with p and x\xe2\x80\x89-\xe2\x80\x89p vertices where 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89p\xe2\x80\x89<\xe2\x80\x89x is chosen by the player. The player who cannot make a move loses the game (and his life!).Peter wants to test some configurations of initial cycle sets before he actually plays with Dr. Octopus. Initially he has an empty set. In the i-th test he adds a cycle with ai vertices to the set (this is actually a multiset because it can contain two or more identical cycles). After each test, Peter wants to know that if the players begin the game with the current set of cycles, who wins? Peter is pretty good at math, but now he asks you to help." 1100

705A Hulk implementation "Dr. Bruce Banner hates his enemies (like others don\'t). As we all know, he can barely talk when he turns into the incredible Hulk. That\'s why he asked you to help him to express his feelings.Hulk likes the Inception so much, and like that his feelings are complicated. They have n layers. The first layer is hate, second one is love, third one is hate and so on...For example if n\xe2\x80\x89=\xe2\x80\x891, then his feeling is ""I hate it"" or if n\xe2\x80\x89=\xe2\x80\x892 it\'s ""I hate that I love it"", and if n\xe2\x80\x89=\xe2\x80\x893 it\'s ""I hate that I love that I hate it"" and so on.Please help Dr. Banner." 800

704E "Iron Man" "data structures,geometry,trees" "Tony Stark is playing a game with his suits (they have auto-pilot now). He lives in Malibu. Malibu has n junctions numbered from 1 to n, connected with n\xe2\x80\x89-\xe2\x80\x891 roads. One can get from a junction to any other junction using these roads (graph of Malibu forms a tree).Tony has m suits. There\'s a special plan for each suit. The i-th suit will appear at the moment of time ti in the junction vi, and will move to junction ui using the shortest path between vi and ui with the speed ci roads per second (passing a junctions takes no time), and vanishing immediately when arriving at ui (if it reaches ui in time q, it\'s available there at moment q, but not in further moments). Also, suits move continuously (for example if vi\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89ui, at time  it\'s in the middle of a road. Please note that if vi\xe2\x80\x89=\xe2\x80\x89ui it means the suit will be at junction number vi only at moment ti and then it vanishes. An explosion happens if at any moment of time two suits share the same exact location (it may be in a junction or somewhere on a road; while appearing, vanishing or moving).Your task is to tell Tony the moment of the the first explosion (if there will be any)." 3300

704D "Captain America" flows,greedy "Steve Rogers is fascinated with new vibranium shields S.H.I.E.L.D gave him. They\'re all uncolored. There are n shields in total, the i-th shield is located at point (xi,\xe2\x80\x89yi) of the coordinate plane. It\'s possible that two or more shields share the same location.Steve wants to paint all these shields. He paints each shield in either red or blue. Painting a shield in red costs r dollars while painting it in blue costs b dollars.Additionally, there are m constraints Steve wants to be satisfied. The i-th constraint is provided by three integers ti, li and di:  If ti\xe2\x80\x89=\xe2\x80\x891, then the absolute difference between the number of red and blue shields on line x\xe2\x80\x89=\xe2\x80\x89li should not exceed di.  If ti\xe2\x80\x89=\xe2\x80\x892, then the absolute difference between the number of red and blue shields on line y\xe2\x80\x89=\xe2\x80\x89li should not exceed di. Steve gave you the task of finding the painting that satisfies all the condition and the total cost is minimum." 3100

704C "Black Widow" dp,graphs,implementation,math "Natalia Romanova is trying to test something on the new gun S.H.I.E.L.D gave her. In order to determine the result of the test, she needs to find the number of answers to a certain equation. The equation is of form:Where  represents logical OR and  represents logical exclusive OR (XOR), and vi,\xe2\x80\x89j are some boolean variables or their negations. Natalia calls the left side of the equation a XNF formula. Each statement in brackets is called a clause, and vi,\xe2\x80\x89j are called literals.In the equation Natalia has, the left side is actually a 2-XNF-2 containing variables x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xm and their negations. An XNF formula is 2-XNF-2 if:  For each 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n, ki\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x892, i.e. the size of each clause doesn\'t exceed two.  Each variable occurs in the formula at most two times (with negation and without negation in total). Please note that it\'s possible that a variable occurs twice but its negation doesn\'t occur in any clause (or vice versa). Natalia is given a formula of m variables, consisting of n clauses. Please, make sure to check the samples in order to properly understand how the formula looks like.Natalia is more into fight than theory, so she asked you to tell her the number of answers to this equation. More precisely, you need to find the number of ways to set x1,\xe2\x80\x89...,\xe2\x80\x89xm with true and false (out of total of 2m ways) so that the equation is satisfied. Since this number can be extremely large, you need to print the answer modulo 109\xe2\x80\x89+\xe2\x80\x897.Please, note that some variable may appear twice in one clause, or not appear in the equation at all (but still, setting it to false or true gives different ways to set variables)." 2900

704B "Ant Man" dp,graphs,greedy "Scott Lang is at war with Darren Cross. There are n chairs in a hall where they are, numbered with 1,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89n from left to right. The i-th chair is located at coordinate xi. Scott is on chair number s and Cross is on chair number e. Scott can jump to all other chairs (not only neighboring chairs). He wants to start at his position (chair number s), visit each chair exactly once and end up on chair number e with Cross. As we all know, Scott can shrink or grow big (grow big only to his normal size), so at any moment of time he can be either small or large (normal). The thing is, he can only shrink or grow big while being on a chair (not in the air while jumping to another chair). Jumping takes time, but shrinking and growing big takes no time. Jumping from chair number i to chair number j takes |xi\xe2\x80\x89-\xe2\x80\x89xj| seconds. Also, jumping off a chair and landing on a chair takes extra amount of time. If Scott wants to jump to a chair on his left, he can only be small, and if he wants to jump to a chair on his right he should be large.Jumping off the i-th chair takes:  ci extra seconds if he\'s small.  di extra seconds otherwise (he\'s large). Also, landing on i-th chair takes:  bi extra seconds if he\'s small.  ai extra seconds otherwise (he\'s large). In simpler words, jumping from i-th chair to j-th chair takes exactly:  |xi\xe2\x80\x89-\xe2\x80\x89xj|\xe2\x80\x89+\xe2\x80\x89ci\xe2\x80\x89+\xe2\x80\x89bj seconds if j\xe2\x80\x89<\xe2\x80\x89i.  |xi\xe2\x80\x89-\xe2\x80\x89xj|\xe2\x80\x89+\xe2\x80\x89di\xe2\x80\x89+\xe2\x80\x89aj seconds otherwise (j\xe2\x80\x89>\xe2\x80\x89i). Given values of x, a, b, c, d find the minimum time Scott can get to Cross, assuming he wants to visit each chair exactly once." 2500

704A Thor "brute force,data structures,implementation" "Thor is getting used to the Earth. As a gift Loki gave him a smartphone. There are n applications on this phone. Thor is fascinated by this phone. He has only one minor issue: he can\'t count the number of unread notifications generated by those applications (maybe Loki put a curse on it so he can\'t).q events are about to happen (in chronological order). They are of three types:  Application x generates a notification (this new notification is unread).  Thor reads all notifications generated so far by application x (he may re-read some notifications).  Thor reads the first t notifications generated by phone applications (notifications generated in first t events of the first type). It\'s guaranteed that there were at least t events of the first type before this event. Please note that he doesn\'t read first t unread notifications, he just reads the very first t notifications generated on his phone and he may re-read some of them in this operation. Please help Thor and tell him the number of unread notifications after each event. You may assume that initially there are no notifications in the phone." 1600

703E "Mishka and Divisors" "dp,number theory" "After playing with her beautiful array, Mishka decided to learn some math. After learning how to multiply, divide and what is divisibility, she is now interested in solving the following problem.You are given integer k and array a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an of n integers. You are to find non-empty subsequence of array elements such that the product of its elements is divisible by k and it contains minimum possible number of elements.Formally, you are to find a sequence of indices 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i1\xe2\x80\x89<\xe2\x80\x89i2\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89im\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n such that  is divisible by k while m is minimum possible among all such variants.If there are more than one such subsequences, you should choose one among them, such that sum of its elements is minimum possible.Mishka quickly solved this problem. Will you do so?" 2600

703D "Mishka and Interesting sum" "data structures" "Little Mishka enjoys programming. Since her birthday has just passed, her friends decided to present her with array of non-negative integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an of n elements!Mishka loved the array and she instantly decided to determine its beauty value, but she is too little and can\'t process large arrays. Right because of that she invited you to visit her and asked you to process m queries.Each query is processed in the following way:  Two integers l and r (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) are specified�\xe2\x80\x94 bounds of query segment.  Integers, presented in array segment [l,\xe2\x80\x89\xe2\x80\x89r] (in sequence of integers al,\xe2\x80\x89al\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89ar) even number of times, are written down.  XOR-sum of written down integers is calculated, and this value is the answer for a query. Formally, if integers written down in point 2 are x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xk, then Mishka wants to know the value , where �\xe2\x80\x94 operator of exclusive bitwise OR. Since only the little bears know the definition of array beauty, all you are to do is to answer each of queries presented." 2100

703C "Chris and Road" geometry,implementation "And while Mishka is enjoying her trip...Chris is a little brown bear. No one knows, where and when he met Mishka, but for a long time they are together (excluding her current trip). However, best friends are important too. John is Chris\' best friend.Once walking with his friend, John gave Chris the following problem:At the infinite horizontal road of width w, bounded by lines y\xe2\x80\x89=\xe2\x80\x890 and y\xe2\x80\x89=\xe2\x80\x89w, there is a bus moving, presented as a convex polygon of n vertices. The bus moves continuously with a constant speed of v in a straight Ox line in direction of decreasing x coordinates, thus in time only x coordinates of its points are changing. Formally, after time t each of x coordinates of its points will be decreased by vt.There is a pedestrian in the point (0,\xe2\x80\x890), who can move only by a vertical pedestrian crossing, presented as a segment connecting points (0,\xe2\x80\x890) and (0,\xe2\x80\x89w) with any speed not exceeding u. Thus the pedestrian can move only in a straight line Oy in any direction with any speed not exceeding u and not leaving the road borders. The pedestrian can instantly change his speed, thus, for example, he can stop instantly.Please look at the sample note picture for better understanding.We consider the pedestrian is hit by the bus, if at any moment the point he is located in lies strictly inside the bus polygon (this means that if the point lies on the polygon vertex or on its edge, the pedestrian is not hit by the bus).You are given the bus position at the moment 0. Please help Chris determine minimum amount of time the pedestrian needs to cross the road and reach the point (0,\xe2\x80\x89w) and not to be hit by the bus." 2100

703B "Mishka and trip" implementation,math "Little Mishka is a great traveller and she visited many countries. After thinking about where to travel this time, she chose XXX�\xe2\x80\x94 beautiful, but little-known northern country.Here are some interesting facts about XXX:  XXX consists of n cities, k of whose (just imagine!) are capital cities.  All of cities in the country are beautiful, but each is beautiful in its own way. Beauty value of i-th city equals to ci.  All the cities are consecutively connected by the roads, including 1-st and n-th city, forming a cyclic route 1\xe2\x80\x89\xe2\x80\x94\xe2\x80\x892\xe2\x80\x89\xe2\x80\x94\xe2\x80\x89...\xe2\x80\x89\xe2\x80\x94\xe2\x80\x89n\xe2\x80\x89\xe2\x80\x94\xe2\x80\x891. Formally, for every 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89n there is a road between i-th and i\xe2\x80\x89+\xe2\x80\x891-th city, and another one between 1-st and n-th city.  Each capital city is connected with each other city directly by the roads. Formally, if city x is a capital city, then for every 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n,\xe2\x80\x89\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89x, there is a road between cities x and i.  There is at most one road between any two cities.  Price of passing a road directly depends on beauty values of cities it connects. Thus if there is a road between cities i and j, price of passing it equals ci\xc2\xb7cj.Mishka started to gather her things for a trip, but didn\'t still decide which route to follow and thus she asked you to help her determine summary price of passing each of the roads in XXX. Formally, for every pair of cities a and b (a\xe2\x80\x89<\xe2\x80\x89b), such that there is a road between a and b you are to find sum of products ca\xc2\xb7cb. Will you help her?" 1400

703A "Mishka and Game" implementation "Mishka is a little polar bear. As known, little bears loves spending their free time playing dice for chocolates. Once in a wonderful sunny morning, walking around blocks of ice, Mishka met her friend Chris, and they started playing the game.Rules of the game are very simple: at first number of rounds n is defined. In every round each of the players throws a cubical dice with distinct numbers from 1 to 6 written on its faces. Player, whose value after throwing the dice is greater, wins the round. In case if player dice values are equal, no one of them is a winner.In average, player, who won most of the rounds, is the winner of the game. In case if two players won the same number of rounds, the result of the game is draw.Mishka is still very little and can\'t count wins and losses, so she asked you to watch their game and determine its result. Please help her!" 800

702F T-Shirts "data structures" "The big consignment of t-shirts goes on sale in the shop before the beginning of the spring. In all n types of t-shirts go on sale. The t-shirt of the i-th type has two integer parameters \xe2\x80\x94 ci and qi, where ci \xe2\x80\x94 is the price of the i-th type t-shirt, qi \xe2\x80\x94 is the quality of the i-th type t-shirt. It should be assumed that the unlimited number of t-shirts of each type goes on sale in the shop, but in general the quality is not concerned with the price. As predicted, k customers will come to the shop within the next month, the j-th customer will get ready to spend up to bj on buying t-shirts. All customers have the same strategy. First of all, the customer wants to buy the maximum possible number of the highest quality t-shirts, then to buy the maximum possible number of the highest quality t-shirts from residuary t-shirts and so on. At the same time among several same quality t-shirts the customer will buy one that is cheaper. The customers don\'t like the same t-shirts, so each customer will not buy more than one t-shirt of one type. Determine the number of t-shirts which each customer will buy, if they use the described strategy. All customers act independently from each other, and the purchase of one does not affect the purchase of another." 2800

702E "Analysis of Pathes in Functional Graph" "data structures,graphs" "You are given a functional graph. It is a directed graph, in which from each vertex goes exactly one arc. The vertices are numerated from 0 to n\xe2\x80\x89-\xe2\x80\x891.Graph is given as the array f0,\xe2\x80\x89f1,\xe2\x80\x89...,\xe2\x80\x89fn\xe2\x80\x89-\xe2\x80\x891, where fi \xe2\x80\x94 the number of vertex to which goes the only arc from the vertex i. Besides you are given array with weights of the arcs w0,\xe2\x80\x89w1,\xe2\x80\x89...,\xe2\x80\x89wn\xe2\x80\x89-\xe2\x80\x891, where wi \xe2\x80\x94 the arc weight from i to fi.  The graph from the first sample test. Also you are given the integer k (the length of the path) and you need to find for each vertex two numbers si and mi, where:  si \xe2\x80\x94 the sum of the weights of all arcs of the path with length equals to k which starts from the vertex i;  mi \xe2\x80\x94 the minimal weight from all arcs on the path with length k which starts from the vertex i. The length of the path is the number of arcs on this path." 2100

702D "Road to Post Office" math "Vasiliy has a car and he wants to get from home to the post office. The distance which he needs to pass equals to d kilometers.Vasiliy\'s car is not new \xe2\x80\x94 it breaks after driven every k kilometers and Vasiliy needs t seconds to repair it. After repairing his car Vasiliy can drive again (but after k kilometers it will break again, and so on). In the beginning of the trip the car is just from repair station.To drive one kilometer on car Vasiliy spends a seconds, to walk one kilometer on foot he needs b seconds (a\xe2\x80\x89<\xe2\x80\x89b).Your task is to find minimal time after which Vasiliy will be able to reach the post office. Consider that in every moment of time Vasiliy can left his car and start to go on foot." 1900

702C "Cellular Network" "binary search,implementation,two pointers" "You are given n points on the straight line \xe2\x80\x94 the positions (x-coordinates) of the cities and m points on the same line \xe2\x80\x94 the positions (x-coordinates) of the cellular towers. All towers work in the same way \xe2\x80\x94 they provide cellular network for all cities, which are located at the distance which is no more than r from this tower.Your task is to find minimal r that each city has been provided by cellular network, i.e. for each city there is at least one cellular tower at the distance which is no more than r.If r\xe2\x80\x89=\xe2\x80\x890 then a tower provides cellular network only for the point where it is located. One tower can provide cellular network for any number of cities, but all these cities must be at the distance which is no more than r from this tower." 1500

702B "Powers of Two" "brute force,data structures,implementation,math" "You are given n integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. Find the number of pairs of indexes i,\xe2\x80\x89j (i\xe2\x80\x89<\xe2\x80\x89j) that ai\xe2\x80\x89+\xe2\x80\x89aj is a power of 2 (i. e. some integer x exists so that ai\xe2\x80\x89+\xe2\x80\x89aj\xe2\x80\x89=\xe2\x80\x892x)." 1500

702A "Maximum Increase" dp,greedy,implementation "You are given array consisting of n integers. Your task is to find the maximum length of an increasing subarray of the given array.A subarray is the sequence of consecutive elements of the array. Subarray is called increasing if each element of this subarray strictly greater than previous." 800

701C "They Are Everywhere" "binary search,strings,two pointers" "Sergei B., the young coach of Pokemons, has found the big house which consists of n flats ordered in a row from left to right. It is possible to enter each flat from the street. It is possible to go out from each flat. Also, each flat is connected with the flat to the left and the flat to the right. Flat number 1 is only connected with the flat number 2 and the flat number n is only connected with the flat number n\xe2\x80\x89-\xe2\x80\x891.There is exactly one Pokemon of some type in each of these flats. Sergei B. asked residents of the house to let him enter their flats in order to catch Pokemons. After consulting the residents of the house decided to let Sergei B. enter one flat from the street, visit several flats and then go out from some flat. But they won\'t let him visit the same flat more than once. Sergei B. was very pleased, and now he wants to visit as few flats as possible in order to collect Pokemons of all types that appear in this house. Your task is to help him and determine this minimum number of flats he has to visit." 1500

701B "Cells Not Under Attack" "data structures,math" "Vasya has the square chessboard of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89n and m rooks. Initially the chessboard is empty. Vasya will consequently put the rooks on the board one after another.The cell of the field is under rook\'s attack, if there is at least one rook located in the same row or in the same column with this cell. If there is a rook located in the cell, this cell is also under attack.You are given the positions of the board where Vasya will put rooks. For each rook you have to determine the number of cells which are not under attack after Vasya puts it on the board." 1200

701A Cards greedy,implementation "There are n cards (n is even) in the deck. Each card has a positive integer written on it. n\xe2\x80\x89/\xe2\x80\x892 people will play new card game. At the beginning of the game each player gets two cards, each card is given to exactly one player. Find the way to distribute cards such that the sum of values written of the cards will be equal for each player. It is guaranteed that it is always possible." 800

700E "Cool Slogans" "string suffix structures,strings" "Bomboslav set up a branding agency and now helps companies to create new logos and advertising slogans. In term of this problems, slogan of the company should be a non-empty substring of its name. For example, if the company name is ""hornsandhoofs"", then substrings ""sand"" and ""hor"" could be its slogans, while strings ""e"" and ""hornss"" can not.Sometimes the company performs rebranding and changes its slogan. Slogan A is considered to be cooler than slogan B if B appears in A as a substring at least twice (this occurrences are allowed to overlap). For example, slogan A\xe2\x80\x89=\xe2\x80\x89 ""abacaba"" is cooler than slogan B\xe2\x80\x89=\xe2\x80\x89 ""ba"", slogan A\xe2\x80\x89=\xe2\x80\x89 ""abcbcbe"" is cooler than slogan B\xe2\x80\x89=\xe2\x80\x89 ""bcb"", but slogan A\xe2\x80\x89=\xe2\x80\x89 ""aaaaaa"" is not cooler than slogan B\xe2\x80\x89=\xe2\x80\x89 ""aba"".You are given the company name w and your task is to help Bomboslav determine the length of the longest sequence of slogans s1,\xe2\x80\x89s2,\xe2\x80\x89...,\xe2\x80\x89sk, such that any slogan in the sequence is cooler than the previous one." 3300

700D "Huffman Coding on Segment" "data structures,greedy" "Alice wants to send an important message to Bob. Message a\xe2\x80\x89=\xe2\x80\x89(a1,\xe2\x80\x89...,\xe2\x80\x89an) is a sequence of positive integers (characters).To compress the message Alice wants to use binary Huffman coding. We recall that binary Huffman code, or binary prefix code is a function f, that maps each letter that appears in the string to some binary string (that is, string consisting of characters \'0\' and \'1\' only) such that for each pair of different characters ai and aj string f(ai) is not a prefix of f(aj) (and vice versa). The result of the encoding of the message a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an is the concatenation of the encoding of each character, that is the string f(a1)f(a2)... f(an). Huffman codes are very useful, as the compressed message can be easily and uniquely decompressed, if the function f is given. Code is usually chosen in order to minimize the total length of the compressed message, i.e. the length of the string f(a1)f(a2)... f(an).Because of security issues Alice doesn\'t want to send the whole message. Instead, she picks some substrings of the message and wants to send them separately. For each of the given substrings ali... ari she wants to know the minimum possible length of the Huffman coding. Help her solve this problem." 3100

700C "Break Up" "dfs and similar,graphs" "Again, there are hard times in Berland! Many towns have such tensions that even civil war is possible. There are n towns in Reberland, some pairs of which connected by two-way roads. It is not guaranteed that it is possible to reach one town from any other town using these roads. Towns s and t announce the final break of any relationship and intend to rule out the possibility of moving between them by the roads. Now possibly it is needed to close several roads so that moving from s to t using roads becomes impossible. Each town agrees to spend money on closing no more than one road, therefore, the total number of closed roads will be no more than two.Help them find set of no more than two roads such that there will be no way between s and t after closing these roads. For each road the budget required for its closure was estimated. Among all sets find such that the total budget for the closure of a set of roads is minimum." 2600

700B "Connecting Universities" "dfs and similar,dp,graphs,trees" "Treeland is a country in which there are n towns connected by n\xe2\x80\x89-\xe2\x80\x891 two-way road such that it\'s possible to get from any town to any other town. In Treeland there are 2k universities which are located in different towns. Recently, the president signed the decree to connect universities by high-speed network.The Ministry of Education understood the decree in its own way and decided that it was enough to connect each university with another one by using a cable. Formally, the decree will be done! To have the maximum sum in the budget, the Ministry decided to divide universities into pairs so that the total length of the required cable will be maximum. In other words, the total distance between universities in k pairs should be as large as possible. Help the Ministry to find the maximum total distance. Of course, each university should be present in only one pair. Consider that all roads have the same length which is equal to 1." 1800

700A "As Fast As Possible" "binary search,math" "On vacations n pupils decided to go on excursion and gather all together. They need to overcome the path with the length l meters. Each of the pupils will go with the speed equal to v1. To get to the excursion quickly, it was decided to rent a bus, which has seats for k people (it means that it can\'t fit more than k people at the same time) and the speed equal to v2. In order to avoid seasick, each of the pupils want to get into the bus no more than once.Determine the minimum time required for all n pupils to reach the place of excursion. Consider that the embarkation and disembarkation of passengers, as well as the reversal of the bus, take place immediately and this time can be neglected." 1900

699B "One Bomb" implementation "You are given a description of a depot. It is a rectangular checkered field of n\xe2\x80\x89\xc3\x97\xe2\x80\x89m size. Each cell in a field can be empty (""."") or it can be occupied by a wall (""*""). You have one bomb. If you lay the bomb at the cell (x,\xe2\x80\x89y), then after triggering it will wipe out all walls in the row x and all walls in the column y.You are to determine if it is possible to wipe out all walls in the depot by placing and triggering exactly one bomb. The bomb can be laid both in an empty cell or in a cell occupied by a wall." 1400

699A "Launch of Collider" implementation "There will be a launch of a new, powerful and unusual collider very soon, which located along a straight line. n particles will be launched inside it. All of them are located in a straight line and there can not be two or more particles located in the same point. The coordinates of the particles coincide with the distance in meters from the center of the collider, xi is the coordinate of the i-th particle and its position in the collider at the same time. All coordinates of particle positions are even integers.You know the direction of each particle movement�\xe2\x80\x94 it will move to the right or to the left after the collider\'s launch start. All particles begin to move simultaneously at the time of the collider\'s launch start. Each particle will move straight to the left or straight to the right with the constant speed of 1 meter per microsecond. The collider is big enough so particles can not leave it in the foreseeable time.Write the program which finds the moment of the first collision of any two particles of the collider. In other words, find the number of microseconds before the first moment when any two particles are at the same point." 1000

698F "Coprime Permutation" "combinatorics,number theory" "Two positive integers are coprime if and only if they don\'t have a common divisor greater than 1.Some bear doesn\'t want to tell Radewoosh how to solve some algorithmic problem. So, Radewoosh is going to break into that bear\'s safe with solutions. To pass through the door, he must enter a permutation of numbers 1 through n. The door opens if and only if an entered permutation p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pn satisfies:In other words, two different elements are coprime if and only if their indices are coprime. Some elements of a permutation may be already fixed. In how many ways can Radewoosh fill the remaining gaps so that the door will open? Print the answer modulo 109\xe2\x80\x89+\xe2\x80\x897." 3000

698E Cron NA "Sometime the classic solution are not powerful enough and we have to design our own. For the purpose of this problem you have to implement the part of the system of task scheduling.Each task should be executed at some particular moments of time. In our system you may set the exact value for the second, minute, hour, day of the week, day and month, when the task should be executed. Moreover, one can set a special value -1 that means any value of this parameter is valid.For example, if the parameter string is -1 59 23 -1 -1 -1, the problem will be executed every day at 23:59:00, 23:59:01, 23:59:02, ..., 23:59:59 (60 times in total).Seconds, minutes and hours are numbered starting from zero, while day, months and days of the week are numbered starting from one. The first day of the week is Monday.There is one special case that is treated separately. If both day of the week and day are given (i.e. differ from -1) to execute the task only one of these two (at least one, if both match this is fine too) parameters should match the current time (of course, all other parameters should match too). For example, the string of parameters 0 0 12 6 3 7 means that the task will be executed both on Saturday, July 2nd, 2016 and on Sunday, July 3rd, 2016 at noon.One should not forget about the existence of the leap years. The year is leap if it\'s number is divisible by 400, or is not divisible by 100, but is divisible by 4. Each leap year has 366 days instead of usual 365, by extending February to 29 days rather than the common 28.The current time is represented as the number of seconds passed after 00:00:00 January 1st, 1970 (Thursday).You are given the string of six parameters, describing the moments of time the task should be executed. You are also given a number of moments of time. For each of them you have to find the first moment of time strictly greater than the current when the task will be executed." 2800

698D "Limak and Shooting Points" "brute force,geometry,math" "Bearland is a dangerous place. Limak can\xe2\x80\x99t travel on foot. Instead, he has k magic teleportation stones. Each stone can be used at most once. The i-th stone allows to teleport to a point (axi,\xe2\x80\x89ayi). Limak can use stones in any order.There are n monsters in Bearland. The i-th of them stands at (mxi,\xe2\x80\x89myi).The given k\xe2\x80\x89+\xe2\x80\x89n points are pairwise distinct.After each teleportation, Limak can shoot an arrow in some direction. An arrow will hit the first monster in the chosen direction. Then, both an arrow and a monster disappear. It\xe2\x80\x99s dangerous to stay in one place for long, so Limak can shoot only one arrow from one place.A monster should be afraid if it\xe2\x80\x99s possible that Limak will hit it. How many monsters should be afraid of Limak?" 2600

698C LRU bitmasks,dp,math,probabilities "While creating high loaded systems one should pay a special attention to caching. This problem will be about one of the most popular caching algorithms called LRU (Least Recently Used).Suppose the cache may store no more than k objects. At the beginning of the workflow the cache is empty. When some object is queried we check if it is present in the cache and move it here if it\'s not. If there are more than k objects in the cache after this, the least recently used one should be removed. In other words, we remove the object that has the smallest time of the last query.Consider there are n videos being stored on the server, all of the same size. Cache can store no more than k videos and caching algorithm described above is applied. We know that any time a user enters the server he pick the video i with probability pi. The choice of the video is independent to any events before.The goal of this problem is to count for each of the videos the probability it will be present in the cache after 10100 queries." 2400

698B "Fix a Tree" "constructive algorithms,dfs and similar,dsu,graphs,trees" "A tree is an undirected connected graph without cycles.Let\'s consider a rooted undirected tree with n vertices, numbered 1 through n. There are many ways to represent such a tree. One way is to create an array with n integers p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pn, where pi denotes a parent of vertex i (here, for convenience a root is considered its own parent).  For this rooted tree the array p is [2,\xe2\x80\x893,\xe2\x80\x893,\xe2\x80\x892]. Given a sequence p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pn, one is able to restore a tree:  There must be exactly one index r that pr\xe2\x80\x89=\xe2\x80\x89r. A vertex r is a root of the tree.  For all other n\xe2\x80\x89-\xe2\x80\x891 vertices i, there is an edge between vertex i and vertex pi. A sequence p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pn is called valid if the described procedure generates some (any) rooted tree. For example, for n\xe2\x80\x89=\xe2\x80\x893 sequences (1,2,2), (2,3,1) and (2,1,3) are not valid.You are given a sequence a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an, not necessarily valid. Your task is to change the minimum number of elements, in order to get a valid sequence. Print the minimum number of changes and an example of a valid sequence after that number of changes. If there are many valid sequences achievable in the minimum number of changes, print any of them." 1700

698A Vacations dp "Vasya has n days of vacations! So he decided to improve his IT skills and do sport. Vasya knows the following information about each of this n days: whether that gym opened and whether a contest was carried out in the Internet on that day. For the i-th day there are four options:  on this day the gym is closed and the contest is not carried out;  on this day the gym is closed and the contest is carried out;  on this day the gym is open and the contest is not carried out;  on this day the gym is open and the contest is carried out. On each of days Vasya can either have a rest or write the contest (if it is carried out on this day), or do sport (if the gym is open on this day).Find the minimum number of days on which Vasya will have a rest (it means, he will not do sport and write the contest at the same time). The only limitation that Vasya has \xe2\x80\x94 he does not want to do the same activity on two consecutive days: it means, he will not do sport on two consecutive days, and write the contest on two consecutive days." 1400

697B Barnicle "brute force,implementation,math,strings" "Barney is standing in a bar and starring at a pretty girl. He wants to shoot her with his heart arrow but he needs to know the distance between him and the girl to make his shot accurate.  Barney asked the bar tender Carl about this distance value, but Carl was so busy talking to the customers so he wrote the distance value (it\'s a real number) on a napkin. The problem is that he wrote it in scientific notation. The scientific notation of some real number x is the notation of form AeB, where A is a real number and B is an integer and x\xe2\x80\x89=\xe2\x80\x89A\xe2\x80\x89\xc3\x97\xe2\x80\x8910B is true. In our case A is between 0 and 9 and B is non-negative.Barney doesn\'t know anything about scientific notation (as well as anything scientific at all). So he asked you to tell him the distance value in usual decimal representation with minimal number of digits after the decimal point (and no decimal point if it is an integer). See the output format for better understanding." 1400

697A "Pineapple Incident" implementation,math "Ted has a pineapple. This pineapple is able to bark like a bulldog! At time t (in seconds) it barks for the first time. Then every s seconds after it, it barks twice with 1 second interval. Thus it barks at times t, t\xe2\x80\x89+\xe2\x80\x89s, t\xe2\x80\x89+\xe2\x80\x89s\xe2\x80\x89+\xe2\x80\x891, t\xe2\x80\x89+\xe2\x80\x892s, t\xe2\x80\x89+\xe2\x80\x892s\xe2\x80\x89+\xe2\x80\x891, etc.  Barney woke up in the morning and wants to eat the pineapple, but he can\'t eat it when it\'s barking. Barney plans to eat it at time x (in seconds), so he asked you to tell him if it\'s gonna bark at that time." 900

696F ...Dary! "binary search,geometry,two pointers" "Barney has finally found the one, a beautiful young lady named Lyanna. The problem is, Lyanna and Barney are trapped in Lord Loss\' castle. This castle has shape of a convex polygon of n points. Like most of castles in Demonata worlds, this castle has no ceiling.  Barney and Lyanna have an escape plan, but it requires some geometry knowledge, so they asked for your help.Barney knows that demons are organized and move in lines. He and Lyanna want to wait for the appropriate time so they need to watch for the demons. Each of them wants to stay in a point inside the castle (possibly on edges or corners), also they may stay in the same position. They both want to pick a real number r and watch all points in the circles with radius r around each of them (these two circles may overlap).  We say that Barney and Lyanna are watching carefully if and only if for every edge of the polygon, at least one of them can see at least one point on the line this edge lies on, thus such point may not be on the edge but it should be on edge\'s line. Formally, each edge line should have at least one common point with at least one of two circles.The greater r is, the more energy and focus they need. So they asked you to tell them the minimum value of r such that they can watch carefully." 3300

696E "...Wait for it..." "data structures,dsu,trees" "Barney is searching for his dream girl. He lives in NYC. NYC has n junctions numbered from 1 to n and n\xe2\x80\x89-\xe2\x80\x891 roads connecting them. We will consider the NYC as a rooted tree with root being junction 1. m girls live in NYC, i-th of them lives along junction ci and her weight initially equals i pounds.  Barney consider a girl x to be better than a girl y if and only if: girl x has weight strictly less than girl y or girl x and girl y have equal weights and index of girl x living junction index is strictly less than girl y living junction index, i.e. cx\xe2\x80\x89<\xe2\x80\x89cy. Thus for any two girls one of them is always better than another one.For the next q days, one event happens each day. There are two types of events:  Barney goes from junction v to junction u. As a result he picks at most k best girls he still have not invited from junctions on his way and invites them to his house to test if one of them is his dream girl. If there are less than k not invited girls on his path, he invites all of them. Girls living along junctions in subtree of junction v (including v itself) put on some weight. As result, their weights increase by k pounds. Your task is for each event of first type tell Barney the indices of girls he will invite to his home in this event." 3000

696D Legen... "data structures,dp,matrices,strings" "Barney was hanging out with Nora for a while and now he thinks he may have feelings for her. Barney wants to send her a cheesy text message and wants to make her as happy as possible.  Initially, happiness level of Nora is 0. Nora loves some pickup lines like ""I\'m falling for you"" and stuff. Totally, she knows n pickup lines, each consisting only of lowercase English letters, also some of them may be equal (in writing, but different in pronouncing or meaning though). Every time Nora sees i-th pickup line as a consecutive subsequence of Barney\'s text message her happiness level increases by ai. These substrings may overlap, for example, Nora will see the pickup line aa twice and the pickup line ab once in text message aaab.Due to texting app limits, Barney\'s text may have up to l characters.Barney asked you to help him make Nora as much happy as possible, it\'s gonna be legen..." 2500

696C PLEASE combinatorics,dp,implementation,math,matrices "As we all know Barney\'s job is ""PLEASE"" and he has not much to do at work. That\'s why he started playing ""cups and key"". In this game there are three identical cups arranged in a line from left to right. Initially key to Barney\'s heart is under the middle cup.  Then at one turn Barney swaps the cup in the middle with any of other two cups randomly (he choses each with equal probability), so the chosen cup becomes the middle one. Game lasts n turns and Barney independently choses a cup to swap with the middle one within each turn, and the key always remains in the cup it was at the start.After n-th turn Barney asks a girl to guess which cup contains the key. The girl points to the middle one but Barney was distracted while making turns and doesn\'t know if the key is under the middle cup. That\'s why he asked you to tell him the probability that girl guessed right.Number n of game turns can be extremely large, that\'s why Barney did not give it to you. Instead he gave you an array a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89ak such that   in other words, n is multiplication of all elements of the given array.Because of precision difficulties, Barney asked you to tell him the answer as an irreducible fraction. In other words you need to find it as a fraction p\xe2\x80\x89/\xe2\x80\x89q such that , where  is the greatest common divisor. Since p and q can be extremely large, you only need to find the remainders of dividing each of them by 109\xe2\x80\x89+\xe2\x80\x897.Please note that we want  of p and q to be 1, not  of their remainders after dividing by 109\xe2\x80\x89+\xe2\x80\x897." 2000

696B Puzzles "dfs and similar,math,probabilities,trees" "Barney lives in country USC (United States of Charzeh). USC has n cities numbered from 1 through n and n\xe2\x80\x89-\xe2\x80\x891 roads between them. Cities and roads of USC form a rooted tree (Barney\'s not sure why it is rooted). Root of the tree is the city number 1. Thus if one will start his journey from city 1, he can visit any city he wants by following roads.  Some girl has stolen Barney\'s heart, and Barney wants to find her. He starts looking for in the root of the tree and (since he is Barney Stinson not a random guy), he uses a random DFS to search in the cities. A pseudo code of this algorithm is as follows:let starting_time be an array of length ncurrent_time = 0dfs(v):\tcurrent_time = current_time + 1\tstarting_time[v] = current_time\tshuffle children[v] randomly (each permutation with equal possibility)\t// children[v] is vector of children cities of city v\tfor u in children[v]:\t\tdfs(u)As told before, Barney will start his journey in the root of the tree (equivalent to call dfs(1)).Now Barney needs to pack a backpack and so he wants to know more about his upcoming journey: for every city i, Barney wants to know the expected value of starting_time[i]. He\'s a friend of Jon Snow and knows nothing, that\'s why he asked for your help." 1700

696A "Lorenzo Von Matterhorn" "brute force,data structures,implementation,trees" "Barney lives in NYC. NYC has infinite number of intersections numbered with positive integers starting from 1. There exists a bidirectional road between intersections i and 2i and another road between i and 2i\xe2\x80\x89+\xe2\x80\x891 for every positive integer i. You can clearly see that there exists a unique shortest path between any two intersections.  Initially anyone can pass any road for free. But since SlapsGiving is ahead of us, there will q consecutive events happen soon. There are two types of events:1. Government makes a new rule. A rule can be denoted by integers v, u and w. As the result of this action, the passing fee of all roads on the shortest path from u to v increases by w dollars. 2. Barney starts moving from some intersection v and goes to intersection u where there\'s a girl he wants to cuddle (using his fake name Lorenzo Von Matterhorn). He always uses the shortest path (visiting minimum number of intersections or roads) between two intersections.Government needs your calculations. For each time Barney goes to cuddle a girl, you need to tell the government how much money he should pay (sum of passing fee of all roads he passes)." 1500

691F "Couple Cover" "brute force,dp,number theory" "Couple Cover, a wildly popular luck-based game, is about to begin! Two players must work together to construct a rectangle. A bag with n balls, each with an integer written on it, is placed on the table. The first player reaches in and grabs a ball randomly (all balls have equal probability of being chosen) \xe2\x80\x94 the number written on this ball is the rectangle\'s width in meters. This ball is not returned to the bag, and the second player reaches into the bag and grabs another ball \xe2\x80\x94 the number written on this ball is the rectangle\'s height in meters. If the area of the rectangle is greater than or equal some threshold p square meters, the players win. Otherwise, they lose.The organizers of the game are trying to select an appropriate value for p so that the probability of a couple winning is not too high and not too low, but they are slow at counting, so they have hired you to answer some questions for them. You are given a list of the numbers written on the balls, the organizers would like to know how many winning pairs of balls exist for different values of p. Note that two pairs are different if either the first or the second ball is different between the two in pair, and two different balls with the same number are considered different." 2200

691E Xor-sequences matrices "You are given n integers a1,\xe2\x80\x89\xe2\x80\x89a2,\xe2\x80\x89\xe2\x80\x89...,\xe2\x80\x89\xe2\x80\x89an.A sequence of integers x1,\xe2\x80\x89\xe2\x80\x89x2,\xe2\x80\x89\xe2\x80\x89...,\xe2\x80\x89\xe2\x80\x89xk is called a ""xor-sequence"" if for every 1\xe2\x80\x89\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89\xe2\x80\x89i\xe2\x80\x89\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89\xe2\x80\x89k\xe2\x80\x89-\xe2\x80\x891 the number of ones in the binary representation of the number xi  xi\xe2\x80\x89\xe2\x80\x89+\xe2\x80\x89\xe2\x80\x891\'s is a multiple of 3 and  for all 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k. The symbol  is used for the binary exclusive or operation.How many ""xor-sequences"" of length k exist? Output the answer modulo 109\xe2\x80\x89+\xe2\x80\x897.Note if a\xe2\x80\x89=\xe2\x80\x89[1,\xe2\x80\x891] and k\xe2\x80\x89=\xe2\x80\x891 then the answer is 2, because you should consider the ones from a as different." 1900

691D "Swaps in Permutation" "dfs and similar,dsu,math" "You are given a permutation of the numbers 1,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89n and m pairs of positions (aj,\xe2\x80\x89bj).At each step you can choose a pair from the given positions and swap the numbers in that positions. What is the lexicographically maximal permutation one can get?Let p and q be two permutations of the numbers 1,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89n. p is lexicographically smaller than the q if a number 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n exists, so pk\xe2\x80\x89=\xe2\x80\x89qk for 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k\xe2\x80\x89<\xe2\x80\x89i and pi\xe2\x80\x89<\xe2\x80\x89qi." 1700

691C "Exponential notation" implementation,strings "You are given a positive decimal number x.Your task is to convert it to the ""simple exponential notation"".Let x\xe2\x80\x89=\xe2\x80\x89a\xc2\xb710b, where 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a\xe2\x80\x89<\xe2\x80\x8910, then in general case the ""simple exponential notation"" looks like ""aEb"". If b equals to zero, the part ""Eb"" should be skipped. If a is an integer, it should be written without decimal point. Also there should not be extra zeroes in a and b." 1800

691B s-palindrome implementation,strings "Let\'s call a string ""s-palindrome"" if it is symmetric about the middle of the string. For example, the string ""oHo"" is ""s-palindrome"", but the string ""aa"" is not. The string ""aa"" is not ""s-palindrome"", because the second half of it is not a mirror reflection of the first half.  English alphabet You are given a string s. Check if the string is ""s-palindrome""." 1600

691A "Fashion in Berland" implementation "According to rules of the Berland fashion, a jacket should be fastened by all the buttons except only one, but not necessarily it should be the last one. Also if the jacket has only one button, it should be fastened, so the jacket will not swinging open.You are given a jacket with n buttons. Determine if it is fastened in a right way." 1000

690F3 "Tree of Life (hard)" trees "To add insult to injury, the zombies have taken all but two drawings from Heidi! Please help her recover the Tree of Life from only these two drawings." 3200

690F2 "Tree of Life (medium)" "constructive algorithms,hashing,trees" "Heidi got tired of deciphering the prophecy hidden in the Tree of Life and decided to go back to her headquarters, rest a little and try there. Of course, she cannot uproot the Tree and take it with her, so she made a drawing of the Tree on a piece of paper. On second thought, she made more identical drawings so as to have n in total (where n is the number of vertices of the Tree of Life) \xe2\x80\x93 who knows what might happen?Indeed, on her way back Heidi was ambushed by a group of zombies. While she managed to fend them off, they have damaged her drawings in a peculiar way: from the i-th copy, the vertex numbered i was removed, along with all adjacent edges. In each picture, the zombies have also erased all the vertex numbers and relabeled the remaining n\xe2\x80\x89-\xe2\x80\x891 vertices arbitrarily using numbers 1 to n (fortunately, each vertex still has a distinct number). What\'s more, the drawings have been arbitrarily shuffled/reordered.Now Heidi wants to recover the Tree of Life from her descriptions of all the drawings (as lists of edges)." 2700

690F1 "Tree of Life (easy)" NA "Heidi has finally found the mythical Tree of Life \xe2\x80\x93 a legendary combinatorial structure which is said to contain a prophecy crucially needed to defeat the undead armies.On the surface, the Tree of Life is just a regular undirected tree well-known from computer science. This means that it is a collection of n points (called vertices), some of which are connected using n\xe2\x80\x89-\xe2\x80\x891 line segments (edges) so that each pair of vertices is connected by a path (a sequence of one or more edges).To decipher the prophecy, Heidi needs to perform a number of steps. The first is counting the number of lifelines in the tree \xe2\x80\x93 these are paths of length 2, i.e., consisting of two edges. Help her!" 1300

690E2 "Photographs (II)" NA "Zombies seem to have become much more intelligent lately \xe2\x80\x93 a few have somehow wandered into the base through the automatic gate. Heidi has had to beef up security, and a new gate has been installed. Unfortunately, now the questions being asked are more complicated, and even humans have trouble answering them. Can you still program the robot army to do this reliably?The new questions are of the following form: a grayscale photograph has been divided into several horizontal pieces, which have been arbitrarily rearranged. The task is to assemble the original image back from these pieces (somewhat like in a jigsaw puzzle). To further delay the zombies, significant Gaussian-distributed noise has been added to the image." 2600

690E1 "Photographs (I)" NA "The Human-Cow Confederation (HC2), led by Heidi, has built a base where people and cows can hide, guarded from zombie attacks. The entrance to the base is protected by an automated gate which performs a kind of a Turing test: it shows the entering creature a photograph and asks them whether the top and bottom halves of this photograph have been swapped or not. A person (or even a cow) will have no problem answering such questions; on the other hand, a zombie would just randomly smash one of the two buttons.The creature is asked a series of such questions. If at least 75% of them are answered correctly, the gate is unlocked; otherwise, a side door opens, beneath which a huge fan is spinning...Heidi is now building a robot army to fight the zombies, and she wants the robots to also be able to enter the base. You are tasked with programming them to distinguish the images. The first two images from the test set. The first picture has been rearranged, but not the second." 1800

690D3 "The Wall (hard)" dp "So many wall designs to choose from! Even modulo 106\xe2\x80\x89+\xe2\x80\x893, it\'s an enormous number. Given that recently Heidi acquired an unlimited supply of bricks, her choices are endless! She really needs to do something to narrow them down.Heidi is quick to come up with criteria for a useful wall:  In a useful wall, at least one segment is wider than W bricks. This should give the zombies something to hit their heads against. Or,  in a useful wall, at least one column is higher than H bricks. This provides a lookout from which zombies can be spotted at a distance. This should rule out a fair amount of possibilities, right? Help Heidi compute the number of useless walls that do not confirm to either of these criteria. In other words, a wall is useless if every segment has width at most W and height at most H.Parameter C, the total width of the wall, has the same meaning as in the easy version. However, note that the number of bricks is now unlimited.Output the number of useless walls modulo 106\xe2\x80\x89+\xe2\x80\x893." 2100

690D2 "The Wall (medium)" combinatorics "Heidi the Cow is aghast: cracks in the northern Wall? Zombies gathering outside, forming groups, preparing their assault? This must not happen! Quickly, she fetches her HC2 (Handbook of Crazy Constructions) and looks for the right chapter:How to build a wall:  Take a set of bricks.  Select one of the possible wall designs. Computing the number of possible designs is left as an exercise to the reader.  Place bricks on top of each other, according to the chosen design. This seems easy enough. But Heidi is a Coding Cow, not a Constructing Cow. Her mind keeps coming back to point 2b. Despite the imminent danger of a zombie onslaught, she wonders just how many possible walls she could build with up to n bricks.A wall is a set of wall segments as defined in the easy version. How many different walls can be constructed such that the wall consists of at least 1 and at most n bricks? Two walls are different if there exist a column c and a row r such that one wall has a brick in this spot, and the other does not.Along with n, you will be given C, the width of the wall (as defined in the easy version). Return the number of different walls modulo 106\xe2\x80\x89+\xe2\x80\x893." 1800

690D1 "The Wall (easy)" NA """The zombies are lurking outside. Waiting. Moaning. And when they come...""""When they come?""""I hope the Wall is high enough.""Zombie attacks have hit the Wall, our line of defense in the North. Its protection is failing, and cracks are showing. In places, gaps have appeared, splitting the wall into multiple segments. We call on you for help. Go forth and explore the wall! Report how many disconnected segments there are.The wall is a two-dimensional structure made of bricks. Each brick is one unit wide and one unit high. Bricks are stacked on top of each other to form columns that are up to R bricks high. Each brick is placed either on the ground or directly on top of another brick. Consecutive non-empty columns form a wall segment. The entire wall, all the segments and empty columns in-between, is C columns wide." 1200

690C3 "Brain Network (hard)" trees "Breaking news from zombie neurology! It turns out that \xe2\x80\x93 contrary to previous beliefs \xe2\x80\x93 every zombie is born with a single brain, and only later it evolves into a complicated brain structure. In fact, whenever a zombie consumes a brain, a new brain appears in its nervous system and gets immediately connected to one of the already existing brains using a single brain connector. Researchers are now interested in monitoring the brain latency of a zombie. Your task is to write a program which, given a history of evolution of a zombie\'s nervous system, computes its brain latency at every stage." 2200

690C2 "Brain Network (medium)" "dfs and similar,graphs,trees" "Further research on zombie thought processes yielded interesting results. As we know from the previous problem, the nervous system of a zombie consists of n brains and m brain connectors joining some pairs of brains together. It was observed that the intellectual abilities of a zombie depend mainly on the topology of its nervous system. More precisely, we define the distance between two brains u and v (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89u,\xe2\x80\x89v\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) as the minimum number of brain connectors used when transmitting a thought between these two brains. The brain latency of a zombie is defined to be the maximum distance between any two of its brains. Researchers conjecture that the brain latency is the crucial parameter which determines how smart a given zombie is. Help them test this conjecture by writing a program to compute brain latencies of nervous systems.In this problem you may assume that any nervous system given in the input is valid, i.e., it satisfies conditions (1) and (2) from the easy version." 1500

690C1 "Brain Network (easy)" NA "One particularly well-known fact about zombies is that they move and think terribly slowly. While we still don\'t know why their movements are so sluggish, the problem of laggy thinking has been recently resolved. It turns out that the reason is not (as previously suspected) any kind of brain defect \xe2\x80\x93 it\'s the opposite! Independent researchers confirmed that the nervous system of a zombie is highly complicated \xe2\x80\x93 it consists of n brains (much like a cow has several stomachs). They are interconnected by brain connectors, which are veins capable of transmitting thoughts between brains. There are two important properties such a brain network should have to function properly:   It should be possible to exchange thoughts between any two pairs of brains (perhaps indirectly, through other brains).  There should be no redundant brain connectors, that is, removing any brain connector would make property 1 false. If both properties are satisfied, we say that the nervous system is valid. Unfortunately (?), if the system is not valid, the zombie stops thinking and becomes (even more) dead. Your task is to analyze a given nervous system of a zombie and find out whether it is valid." 1300

690B3 "Recover Polygon (hard)" "data structures" "Zombies have found out about the Zombie Contamination level checker and managed to damage it! Now detecting the shape of their main compound will be a real challenge for Heidi. As before, a lair can be represented as a strictly convex polygon on a lattice. Each vertex of the polygon occupies a point on the lattice. However, the damaged Zombie Contamination level checker can only tell, for each cell, whether the level of Zombie Contamination for that cell is in the set {1,\xe2\x80\x892,\xe2\x80\x893}. In other words, Heidi knows all the cells of the lattice for which the Contamination level is not 0 and not 4.Given this information, Heidi still wants to know the exact shape of the lair to rain destruction on the zombies. Help her!" 2600

690B2 "Recover Polygon (medium)" geometry "Now that Heidi has made sure her Zombie Contamination level checker works, it\'s time to strike! This time, the zombie lair is a strictly convex polygon on the lattice. Each vertex of the polygon occupies a point on the lattice. For each cell of the lattice, Heidi knows the level of Zombie Contamination \xe2\x80\x93 the number of corners of the cell that are inside or on the border of the lair.Given this information, Heidi wants to know the exact shape of the lair to rain destruction on the zombies. Help her!" 2600

690B1 "Recover Polygon (easy)" NA "The zombies are gathering in their secret lair! Heidi will strike hard to destroy them once and for all. But there is a little problem... Before she can strike, she needs to know where the lair is. And the intel she has is not very good.Heidi knows that the lair can be represented as a rectangle on a lattice, with sides parallel to the axes. Each vertex of the polygon occupies an integer point on the lattice. For each cell of the lattice, Heidi can check the level of Zombie Contamination. This level is an integer between 0 and 4, equal to the number of corners of the cell that are inside or on the border of the rectangle.As a test, Heidi wants to check that her Zombie Contamination level checker works. Given the output of the checker, Heidi wants to know whether it could have been produced by a single non-zero area rectangular-shaped lair (with axis-parallel sides)." 1700

690A3 "Collective Mindsets (hard)" NA "Heidi got one brain, thumbs up! But the evening isn\'t over yet and one more challenge awaits our dauntless agent: after dinner, at precisely midnight, the N attendees love to play a very risky game...Every zombie gets a number ni (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ni\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89N) written on his forehead. Although no zombie can see his own number, he can see the numbers written on the foreheads of all N\xe2\x80\x89-\xe2\x80\x891 fellows. Note that not all numbers have to be unique (they can even all be the same). From this point on, no more communication between zombies is allowed. Observation is the only key to success. When the cuckoo clock strikes midnight, all attendees have to simultaneously guess the number on their own forehead. If at least one of them guesses his number correctly, all zombies survive and go home happily. On the other hand, if not a single attendee manages to guess his number correctly, all of them are doomed to die!Zombies aren\'t very bright creatures though, and Heidi has to act fast if she does not want to jeopardize her life. She has one single option: by performing some quick surgery on the brain she managed to get from the chest, she has the ability to remotely reprogram the decision-making strategy of all attendees for their upcoming midnight game! Can you suggest a sound strategy to Heidi which, given the rules of the game, ensures that at least one attendee will guess his own number correctly, for any possible sequence of numbers on the foreheads?Given a zombie\'s rank R and the N\xe2\x80\x89-\xe2\x80\x891 numbers ni on the other attendees\' foreheads, your program will have to return the number that the zombie of rank R shall guess. Those answers define your strategy, and we will check if it is flawless or not." 2400

690A2 "Collective Mindsets (medium)" NA "Way to go! Heidi now knows how many brains there must be for her to get one. But throwing herself in the midst of a clutch of hungry zombies is quite a risky endeavor. Hence Heidi wonders: what is the smallest number of brains that must be in the chest for her to get out at all (possibly empty-handed, but alive)?The brain dinner night will evolve just as in the previous subtask: the same crowd is present, the N\xe2\x80\x89-\xe2\x80\x891 zombies have the exact same mindset as before and Heidi is to make the first proposal, which must be accepted by at least half of the attendees for her to survive." 2300

690A1 "Collective Mindsets (easy)" NA "Tonight is brain dinner night and all zombies will gather together to scarf down some delicious brains. The artful Heidi plans to crash the party, incognito, disguised as one of them. Her objective is to get away with at least one brain, so she can analyze the zombies\' mindset back home and gain a strategic advantage.They will be N guests tonight: N\xe2\x80\x89-\xe2\x80\x891 real zombies and a fake one, our Heidi. The living-dead love hierarchies as much as they love brains: each one has a unique rank in the range 1 to N\xe2\x80\x89-\xe2\x80\x891, and Heidi, who still appears slightly different from the others, is attributed the highest rank, N. Tonight there will be a chest with brains on display and every attendee sees how many there are. These will then be split among the attendees according to the following procedure:The zombie of the highest rank makes a suggestion on who gets how many brains (every brain is an indivisible entity). A vote follows. If at least half of the attendees accept the offer, the brains are shared in the suggested way and the feast begins. But if majority is not reached, then the highest-ranked zombie is killed, and the next zombie in hierarchy has to make a suggestion. If he is killed too, then the third highest-ranked makes one, etc. (It\'s enough to have exactly half of the votes \xe2\x80\x93 in case of a tie, the vote of the highest-ranked alive zombie counts twice, and he will of course vote in favor of his own suggestion in order to stay alive.)You should know that zombies are very greedy and sly, and they know this too \xe2\x80\x93 basically all zombie brains are alike. Consequently, a zombie will never accept an offer which is suboptimal for him. That is, if an offer is not strictly better than a potential later offer, he will vote against it. And make no mistake: while zombies may normally seem rather dull, tonight their intellects are perfect. Each zombie\'s priorities for tonight are, in descending order:   survive the event (they experienced death already once and know it is no fun),  get as many brains as possible. Heidi goes first and must make an offer which at least half of the attendees will accept, and which allocates at least one brain for Heidi herself.What is the smallest number of brains that have to be in the chest for this to be possible?" 1100

689E "Mike and Geometry Problem" "combinatorics,data structures,dp,geometry,implementation" "Mike wants to prepare for IMO but he doesn\'t know geometry, so his teacher gave him an interesting geometry problem. Let\'s define f([l,\xe2\x80\x89r])\xe2\x80\x89=\xe2\x80\x89r\xe2\x80\x89-\xe2\x80\x89l\xe2\x80\x89+\xe2\x80\x891 to be the number of integer points in the segment [l,\xe2\x80\x89r] with l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r (say that ). You are given two integers n and k and n closed intervals [li,\xe2\x80\x89ri] on OX axis and you have to find:  In other words, you should find the sum of the number of integer points in the intersection of any k of the segments. As the answer may be very large, output it modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897).Mike can\'t solve this problem so he needs your help. You will help him, won\'t you?" 2000

689D "Friends and Subsequences" "binary search,data structures" "Mike and !Mike are old childhood rivals, they are opposite in everything they do, except programming. Today they have a problem they cannot solve on their own, but together (with you)�\xe2\x80\x94 who knows? Every one of them has an integer sequences a and b of length n. Being given a query of the form of pair of integers (l,\xe2\x80\x89r), Mike can instantly tell the value of  while !Mike can instantly tell the value of .Now suppose a robot (you!) asks them all possible different queries of pairs of integers (l,\xe2\x80\x89r) (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) (so he will make exactly n(n\xe2\x80\x89+\xe2\x80\x891)\xe2\x80\x89/\xe2\x80\x892 queries) and counts how many times their answers coincide, thus for how many pairs  is satisfied.How many occasions will the robot count?" 2100

689C "Mike and Chocolate Thieves" "binary search,combinatorics,math" "Bad news came to Mike\'s village, some thieves stole a bunch of chocolates from the local factory! Horrible! Aside from loving sweet things, thieves from this area are known to be very greedy. So after a thief takes his number of chocolates for himself, the next thief will take exactly k times more than the previous one. The value of k (k\xe2\x80\x89>\xe2\x80\x891) is a secret integer known only to them. It is also known that each thief\'s bag can carry at most n chocolates (if they intend to take more, the deal is cancelled) and that there were exactly four thieves involved. Sadly, only the thieves know the value of n, but rumours say that the numbers of ways they could have taken the chocolates (for a fixed n, but not fixed k) is m. Two ways are considered different if one of the thieves (they should be numbered in the order they take chocolates) took different number of chocolates in them.Mike want to track the thieves down, so he wants to know what their bags are and value of n will help him in that. Please find the smallest possible value of n or tell him that the rumors are false and there is no such n." 1700

689B "Mike and Shortcuts" "dfs and similar,graphs,greedy,shortest paths" "Recently, Mike was very busy with studying for exams and contests. Now he is going to chill a bit by doing some sight seeing in the city.City consists of n intersections numbered from 1 to n. Mike starts walking from his house located at the intersection number 1 and goes along some sequence of intersections. Walking from intersection number i to intersection j requires |i\xe2\x80\x89-\xe2\x80\x89j| units of energy. The total energy spent by Mike to visit a sequence of intersections p1\xe2\x80\x89=\xe2\x80\x891,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pk is equal to  units of energy.Of course, walking would be boring if there were no shortcuts. A shortcut is a special path that allows Mike walking from one intersection to another requiring only 1 unit of energy. There are exactly n shortcuts in Mike\'s city, the ith of them allows walking from intersection i to intersection ai (i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ai\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x891) (but not in the opposite direction), thus there is exactly one shortcut starting at each intersection. Formally, if Mike chooses a sequence p1\xe2\x80\x89=\xe2\x80\x891,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pk then for each 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89k satisfying pi\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89=\xe2\x80\x89api and api\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89pi Mike will spend only 1 unit of energy instead of |pi\xe2\x80\x89-\xe2\x80\x89pi\xe2\x80\x89+\xe2\x80\x891| walking from the intersection pi to intersection pi\xe2\x80\x89+\xe2\x80\x891. For example, if Mike chooses a sequence p1\xe2\x80\x89=\xe2\x80\x891,\xe2\x80\x89p2\xe2\x80\x89=\xe2\x80\x89ap1,\xe2\x80\x89p3\xe2\x80\x89=\xe2\x80\x89ap2,\xe2\x80\x89...,\xe2\x80\x89pk\xe2\x80\x89=\xe2\x80\x89apk\xe2\x80\x89-\xe2\x80\x891, he spends exactly k\xe2\x80\x89-\xe2\x80\x891 units of total energy walking around them.Before going on his adventure, Mike asks you to find the minimum amount of energy required to reach each of the intersections from his home. Formally, for each 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n Mike is interested in finding minimum possible total energy of some sequence p1\xe2\x80\x89=\xe2\x80\x891,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pk\xe2\x80\x89=\xe2\x80\x89i." 1600

689A "Mike and Cellphone" "brute force,constructive algorithms,implementation" "While swimming at the beach, Mike has accidentally dropped his cellphone into the water. There was no worry as he bought a cheap replacement phone with an old-fashioned keyboard. The keyboard has only ten digital equal-sized keys, located in the following way:  Together with his old phone, he lost all his contacts and now he can only remember the way his fingers moved when he put some number in. One can formally consider finger movements as a sequence of vectors connecting centers of keys pressed consecutively to put in a number. For example, the finger movements for number ""586"" are the same as finger movements for number ""253"":    Mike has already put in a number by his ""finger memory"" and started calling it, so he is now worrying, can he be sure that he is calling the correct number? In other words, is there any other number, that has the same finger movements?" 1400

688B "Lovely Palindromes" "constructive algorithms,math" "Pari has a friend who loves palindrome numbers. A palindrome number is a number that reads the same forward or backward. For example 12321, 100001 and 1 are palindrome numbers, while 112 and 1021 are not.Pari is trying to love them too, but only very special and gifted people can understand the beauty behind palindrome numbers. Pari loves integers with even length (i.e. the numbers with even number of digits), so she tries to see a lot of big palindrome numbers with even length (like a 2-digit 11 or 6-digit 122221), so maybe she could see something in them.Now Pari asks you to write a program that gets a huge integer n from the input and tells what is the n-th even-length positive palindrome number?" 1000

688A Opponents implementation "Arya has n opponents in the school. Each day he will fight with all opponents who are present this day. His opponents have some fighting plan that guarantees they will win, but implementing this plan requires presence of them all. That means if one day at least one of Arya\'s opponents is absent at the school, then Arya will beat all present opponents. Otherwise, if all opponents are present, then they will beat Arya.For each opponent Arya knows his schedule�\xe2\x80\x94 whether or not he is going to present on each particular day. Tell him the maximum number of consecutive days that he will beat all present opponents.Note, that if some day there are no opponents present, Arya still considers he beats all the present opponents." 800

687E TOF "dfs and similar,graphs" "Today Pari gave Arya a cool graph problem. Arya wrote a non-optimal solution for it, because he believes in his ability to optimize non-optimal solutions. In addition to being non-optimal, his code was buggy and he tried a lot to optimize it, so the code also became dirty! He keeps getting Time Limit Exceeds and he is disappointed. Suddenly a bright idea came to his mind!Here is how his dirty code looks like:dfs(v){     set count[v] = count[v] + 1     if(count[v] < 1000)     {          foreach u in neighbors[v]          {               if(visited[u] is equal to false)               {                    dfs(u)               }               break          }     }     set visited[v] = true}main(){     input the digraph()     TOF()     foreach 1<=i<=n     {          set count[i] = 0 , visited[i] = false     }     foreach 1 <= v <= n     {          if(visited[v] is equal to false)          {               dfs(v)          }     }     ... // And do something cool and magical but we can\'t tell you what!}He asks you to write the TOF function in order to optimize the running time of the code with minimizing the number of calls of the dfs function. The input is a directed graph and in the TOF function you have to rearrange the edges of the graph in the list neighbors for each vertex. The number of calls of dfs function depends on the arrangement of neighbors of each vertex." 2900

687D "Dividing Kingdom II" "brute force,data structures,dsu,graphs,sortings" "Long time ago, there was a great kingdom and it was being ruled by The Great Arya and Pari The Great. These two had some problems about the numbers they like, so they decided to divide the great kingdom between themselves.The great kingdom consisted of n cities numbered from 1 to n and m bidirectional roads between these cities, numbered from 1 to m. The i-th road had length equal to wi. The Great Arya and Pari The Great were discussing about destructing some prefix (all road with numbers less than some x) and suffix (all roads with numbers greater than some x) of the roads so there will remain only the roads with numbers l,\xe2\x80\x89l\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89r\xe2\x80\x89-\xe2\x80\x891 and r.After that they will divide the great kingdom into two pieces (with each city belonging to exactly one piece) such that the hardness of the division is minimized. The hardness of a division is the maximum length of a road such that its both endpoints are in the same piece of the kingdom. In case there is no such road, the hardness of the division is considered to be equal to \xe2\x80\x89-\xe2\x80\x891.Historians found the map of the great kingdom, and they have q guesses about the l and r chosen by those great rulers. Given these data, for each guess li and ri print the minimum possible hardness of the division of the kingdom." 2500

687C "The Values You Can Make" dp "Pari wants to buy an expensive chocolate from Arya. She has n coins, the value of the i-th coin is ci. The price of the chocolate is k, so Pari will take a subset of her coins with sum equal to k and give it to Arya.Looking at her coins, a question came to her mind: after giving the coins to Arya, what values does Arya can make with them? She is jealous and she doesn\'t want Arya to make a lot of values. So she wants to know all the values x, such that Arya will be able to make x using some subset of coins with the sum k.Formally, Pari wants to know the values x such that there exists a subset of coins with the sum k such that some subset of this subset has the sum x, i.e. there is exists some way to pay for the chocolate, such that Arya will be able to make the sum x using these coins." 1900

687B "Remainders Game" "chinese remainder theorem,math,number theory" "Today Pari and Arya are playing a game called Remainders.Pari chooses two positive integer x and k, and tells Arya k but not x. Arya have to find the value . There are n ancient numbers c1,\xe2\x80\x89c2,\xe2\x80\x89...,\xe2\x80\x89cn and Pari has to tell Arya  if Arya wants. Given k and the ancient values, tell us if Arya has a winning strategy independent of value of x or not. Formally, is it true that Arya can understand the value  for any positive integer x?Note, that  means the remainder of x after dividing it by y." 1800

687A "NP-Hard Problem" "dfs and similar,graphs" "Recently, Pari and Arya did some research about NP-Hard problems and they found the minimum vertex cover problem very interesting.Suppose the graph G is given. Subset A of its vertices is called a vertex cover of this graph, if for each edge uv there is at least one endpoint of it in this set, i.e.  or  (or both).Pari and Arya have won a great undirected graph as an award in a team contest. Now they have to split it in two parts, but both of them want their parts of the graph to be a vertex cover.They have agreed to give you their graph and you need to find two disjoint subsets of its vertices A and B, such that both A and B are vertex cover or claim it\'s impossible. Each vertex should be given to no more than one of the friends (or you can even keep it for yourself)." 1500

686B "Little Robber Girl\'s Zoo" "constructive algorithms,implementation,sortings" "Recently, Pari and Arya did some research about NP-Hard problems and they found the minimum vertex cover problem very interesting.Suppose the graph G is given. Subset A of its vertices is called a vertex cover of this graph, if for each edge uv there is at least one endpoint of it in this set, i.e.  or  (or both).Pari and Arya have won a great undirected graph as an award in a team contest. Now they have to split it in two parts, but both of them want their parts of the graph to be a vertex cover.They have agreed to give you their graph and you need to find two disjoint subsets of its vertices A and B, such that both A and B are vertex cover or claim it\'s impossible. Each vertex should be given to no more than one of the friends (or you can even keep it for yourself)." 1100

686A "Free Ice Cream" "constructive algorithms,implementation" "After their adventure with the magic mirror Kay and Gerda have returned home and sometimes give free ice cream to kids in the summer.At the start of the day they have x ice cream packs. Since the ice cream is free, people start standing in the queue before Kay and Gerda\'s house even in the night. Each person in the queue wants either to take several ice cream packs for himself and his friends or to give several ice cream packs to Kay and Gerda (carriers that bring ice cream have to stand in the same queue).If a carrier with d ice cream packs comes to the house, then Kay and Gerda take all his packs. If a child who wants to take d ice cream packs comes to the house, then Kay and Gerda will give him d packs if they have enough ice cream, otherwise the child will get no ice cream at all and will leave in distress.Kay wants to find the amount of ice cream they will have after all people will leave from the queue, and Gerda wants to find the number of distressed kids." 800

685E "Travelling Through the Snow Queen\'s Kingdom" "bitmasks,brute force,divide and conquer,graphs" "After their adventure with the magic mirror Kay and Gerda have returned home and sometimes give free ice cream to kids in the summer.At the start of the day they have x ice cream packs. Since the ice cream is free, people start standing in the queue before Kay and Gerda\'s house even in the night. Each person in the queue wants either to take several ice cream packs for himself and his friends or to give several ice cream packs to Kay and Gerda (carriers that bring ice cream have to stand in the same queue).If a carrier with d ice cream packs comes to the house, then Kay and Gerda take all his packs. If a child who wants to take d ice cream packs comes to the house, then Kay and Gerda will give him d packs if they have enough ice cream, otherwise the child will get no ice cream at all and will leave in distress.Kay wants to find the amount of ice cream they will have after all people will leave from the queue, and Gerda wants to find the number of distressed kids." 2800

685D "Kay and Eternity" "brute force,implementation,sortings" "Snow Queen told Kay to form a word ""eternity"" using pieces of ice. Kay is eager to deal with the task, because he will then become free, and Snow Queen will give him all the world and a pair of skates.Behind the palace of the Snow Queen there is an infinite field consisting of cells. There are n pieces of ice spread over the field, each piece occupying exactly one cell and no two pieces occupying the same cell. To estimate the difficulty of the task Kay looks at some squares of size k\xe2\x80\x89\xc3\x97\xe2\x80\x89k cells, with corners located at the corners of the cells and sides parallel to coordinate axis and counts the number of pieces of the ice inside them.This method gives an estimation of the difficulty of some part of the field. However, Kay also wants to estimate the total difficulty, so he came up with the following criteria: for each x (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) he wants to count the number of squares of size k\xe2\x80\x89\xc3\x97\xe2\x80\x89k, such that there are exactly x pieces of the ice inside.Please, help Kay estimate the difficulty of the task given by the Snow Queen." 2600

685C "Optimal Point" "binary search,math" "When the river brought Gerda to the house of the Old Lady who Knew Magic, this lady decided to make Gerda her daughter. She wants Gerda to forget about Kay, so she puts all the roses from the garden underground.Mole, who lives in this garden, now can watch the roses without going up to the surface. Typical mole is blind, but this mole was granted as special vision by the Old Lady. He can watch any underground objects on any distance, even through the obstacles and other objects. However, the quality of the picture depends on the Manhattan distance to object being observed.Mole wants to find an optimal point to watch roses, that is such point with integer coordinates that the maximum Manhattan distance to the rose is minimum possible.As usual, he asks you to help.Manhattan distance between points (x1,\xe2\x80\x89�y1,\xe2\x80\x89�z1) and (x2,\xe2\x80\x89�y2,\xe2\x80\x89�z2) is defined as |x1\xe2\x80\x89-\xe2\x80\x89x2|\xe2\x80\x89+\xe2\x80\x89|y1\xe2\x80\x89-\xe2\x80\x89y2|\xe2\x80\x89+\xe2\x80\x89|z1\xe2\x80\x89-\xe2\x80\x89z2|." 2900

685B "Kay and Snowflake" "data structures,dfs and similar,dp,trees" "After the piece of a devilish mirror hit the Kay\'s eye, he is no longer interested in the beauty of the roses. Now he likes to watch snowflakes.Once upon a time, he found a huge snowflake that has a form of the tree (connected acyclic graph) consisting of n nodes. The root of tree has index 1. Kay is very interested in the structure of this tree.After doing some research he formed q queries he is interested in. The i-th query asks to find a centroid of the subtree of the node vi. Your goal is to answer all queries.Subtree of a node is a part of tree consisting of this node and all it\'s descendants (direct or not). In other words, subtree of node v is formed by nodes u, such that node v is present on the path from u to root.Centroid of a tree (or a subtree) is a node, such that if we erase it from the tree, the maximum size of the connected component will be at least two times smaller than the size of the initial tree (or a subtree)." 1900

685A "Robbers\' watch" "brute force,combinatorics,dp,math" "After the piece of a devilish mirror hit the Kay\'s eye, he is no longer interested in the beauty of the roses. Now he likes to watch snowflakes.Once upon a time, he found a huge snowflake that has a form of the tree (connected acyclic graph) consisting of n nodes. The root of tree has index 1. Kay is very interested in the structure of this tree.After doing some research he formed q queries he is interested in. The i-th query asks to find a centroid of the subtree of the node vi. Your goal is to answer all queries.Subtree of a node is a part of tree consisting of this node and all it\'s descendants (direct or not). In other words, subtree of node v is formed by nodes u, such that node v is present on the path from u to root.Centroid of a tree (or a subtree) is a node, such that if we erase it from the tree, the maximum size of the connected component will be at least two times smaller than the size of the initial tree (or a subtree)." 1700

683J "The Hero with Bombs" "*special problem" "In a new computer game you need to help the hero to get out of the maze, which is a rectangular field of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m. The hero is located in one of the cells of this field. He knows where the exit of the maze is, and he wants to reach it.In one move, the hero can either move to the next cell (i.e. the cell which has a common side with the current cell) if it is free, or plant a bomb on the cell where he is, or skip the move and do nothing. A planted bomb explodes after three moves, that is, after the hero makes 3 more actions but does not have time to make the fourth (all three types of moves described above are considered as actions).The explosion destroys the obstacles in all the cells which have at least one common point with this cell (i.e. in all the cells sharing with the bomb cell a corner or a side). The explosion must not hurt the cell with the exit or the cell with the hero. The hero can not go beyond the boundaries of the maze.Your task is to determine the sequence of hero\'s actions to reach the exit. Note that you haven\'t to minimize the length of the sequence. The only restriction \xe2\x80\x94 the length of the resulting sequence should not exceed 100,000 symbols." 3000

683I Loader "*special problem,graphs" "A loader works in a warehouse, which is a rectangular field with size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m. Some cells of this field are free, others are occupied by pillars on which the roof of the warehouse rests. There is a load in one of the free cells, and the loader in another. At any moment, the loader and the load can not be in the cells with columns, outside the warehouse or in the same cell.The loader can move to the adjacent cell (two cells are considered adjacent if they have a common side), or move the load. To move the load, the loader should reach the cell adjacent to the load and push the load. In this case the load advances to the next cell in the direction in which the loader pushes it and the loader ends up in the cell in which the load was.Your task is to determine a sequence of pushes and loader\'s movements after which the load will reach the given cell (it is guaranteed that this cell is free). The load is rather heavy, so you need to minimize first the number of pushes and second the number of loader\'s movements." 2500

683H "Exchange of Books" "*special problem" "n pupils, who love to read books, study at school. It is known that each student has exactly one best friend, and each pupil is the best friend of exactly one other pupil. Each of the pupils has exactly one interesting book.The pupils decided to share books with each other. Every day, all pupils give their own books to their best friends. Thus, every day each of the pupils has exactly one book.Your task is to use the list of the best friends and determine the exchange of books among pupils after k days. For simplicity, all students are numbered from 1 to n in all tests." 1900

683G "The Fraction" "*special problem" "Periodic decimal fraction is usually written as: [entire_part.non-periodic_part (period)]. Any simple fraction can be represented as a periodic decimal fraction and vice versa. For example, the decimal fraction 0.2(45) corresponds to a fraction 27\xe2\x80\x89/\xe2\x80\x89110. Your task is to convert the periodic fraction to a simple periodic fraction." 1900

683F "Reformat the String" "*special problem" "In this problem you are given a string s consisting of uppercase and lowercase Latin letters, spaces, dots and commas. Your task is to correct the formatting of this string by removing and inserting spaces, as well as changing the case of the letters.After formatting, the resulting string must meet the following requirements:  the string must not start with a space;  there should be exactly one space between any two consecutive words;  there should be a Latin letter immediately before a dot or a comma, and there should be a space immediately after a dot or a comma in the case that there is a word after that dot or comma, otherwise that dot or comma must be the last character in the string;  all letters must be lowercase, except all first letters in the first words of the sentences, they must be capitalized. The first word of a sentence is a word that is either the first word of the string or a word after a dot. It is guaranteed that there is at least one letter in the given string between any two punctuation marks (commas and dots are punctuation marks). There is at least one letter before the leftmost punctuation mark." 1800

683E "Hammer throwing" "*special problem" "n athletes take part in the hammer throw. Each of them has his own unique identifier \xe2\x80\x94 the integer from 1 to n (all athletes have distinct identifiers). After the draw, the order in which the athletes will throw the hammer has been determined (they will do it one by one).Unfortunately, a not very attentive judge lost the list with the order of athletes, but each of the athletes has remembered how many competitors with identifiers larger than his own will throw the hammer before him.Your task is to help the organizers as quickly as possible to restore the order of the athletes." 1800

683D "Chocolate Bar" "*special problem,math" "A chocolate bar has a rectangular shape and consists of n\xe2\x80\x89\xc3\x97\xe2\x80\x89m slices. In other words, a bar consists of n rows with m slices of chocolate in each row.Each slice of chocolate is known to weigh 1 gram. Your task is to determine for each of the q chocolate bars whether it is possible to obtain a piece weighing p grams by breaking the bar several (possibly zero) times. The final piece of the chocolate bar should be whole, and breaks are made along the line of slices\' section for the whole length of the current piece." 1400

683C "Symmetric Difference" "*special problem" "You are given two sets of numbers. Your task is to print all numbers from the sets, that both sets don\'t contain simultaneously." 1600

683B "The Teacher of Physical Education" "*special problem" "n pupils came to Physical Education lesson. We know the name and the height of each pupil. Your task is to help the teacher of Physical Education to line up all pupils in non-decreasing order of their heights." 1600

683A "The Check of the Point" "*special problem,geometry" "On the coordinate plane there is a square with sides parallel to the coordinate axes. The length of the square side is equal to a. The lower left corner of the square coincides with the point (0,\xe2\x80\x890) (the point of the origin). The upper right corner of the square has positive coordinates.You are given a point with coordinates (x, y). Your task is to determine whether this point is located strictly inside the square, on its side, or strictly outside the square." 1200

682E "Alyona and Triangles" "geometry,two pointers" "You are given n points with integer coordinates on the plane. Points are given in a way such that there is no triangle, formed by any three of these n points, which area exceeds S.Alyona tried to construct a triangle with integer coordinates, which contains all n points and which area doesn\'t exceed 4S, but, by obvious reason, had no success in that. Please help Alyona construct such triangle. Please note that vertices of resulting triangle are not necessarily chosen from n given points." 2600

682D "Alyona and Strings" dp,strings "After returned from forest, Alyona started reading a book. She noticed strings s and t, lengths of which are n and m respectively. As usual, reading bored Alyona and she decided to pay her attention to strings s and t, which she considered very similar.Alyona has her favourite positive integer k and because she is too small, k does not exceed 10. The girl wants now to choose k disjoint non-empty substrings of string s such that these strings appear as disjoint substrings of string t and in the same order as they do in string s. She is also interested in that their length is maximum possible among all variants.Formally, Alyona wants to find a sequence of k non-empty strings p1,\xe2\x80\x89p2,\xe2\x80\x89p3,\xe2\x80\x89...,\xe2\x80\x89pk satisfying following conditions:  s can be represented as concatenation a1p1a2p2... akpkak\xe2\x80\x89+\xe2\x80\x891, where a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89ak\xe2\x80\x89+\xe2\x80\x891 is a sequence of arbitrary strings (some of them may be possibly empty);  t can be represented as concatenation b1p1b2p2... bkpkbk\xe2\x80\x89+\xe2\x80\x891, where b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bk\xe2\x80\x89+\xe2\x80\x891 is a sequence of arbitrary strings (some of them may be possibly empty);  sum of the lengths of strings in sequence is maximum possible. Please help Alyona solve this complicated problem and find at least the sum of the lengths of the strings in a desired sequence.A substring of a string is a subsequence of consecutive characters of the string." 1900

682C "Alyona and the Tree" "dfs and similar,dp,graphs,trees" "Alyona decided to go on a diet and went to the forest to get some apples. There she unexpectedly found a magic rooted tree with root in the vertex 1, every vertex and every edge of which has a number written on.The girl noticed that some of the tree\'s vertices are sad, so she decided to play with them. Let\'s call vertex v sad if there is a vertex u in subtree of vertex v such that dist(v,\xe2\x80\x89u)\xe2\x80\x89>\xe2\x80\x89au, where au is the number written on vertex u, dist(v,\xe2\x80\x89u) is the sum of the numbers written on the edges on the path from v to u.Leaves of a tree are vertices connected to a single vertex by a single edge, but the root of a tree is a leaf if and only if the tree consists of a single vertex�\xe2\x80\x94 root.Thus Alyona decided to remove some of tree leaves until there will be no any sad vertex left in the tree. What is the minimum number of leaves Alyona needs to remove?" 1600

682B "Alyona and Mex" sortings "Someone gave Alyona an array containing n positive integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. In one operation, Alyona can choose any element of the array and decrease it, i.e. replace with any positive integer that is smaller than the current one. Alyona can repeat this operation as many times as she wants. In particular, she may not apply any operation to the array at all.Formally, after applying some operations Alyona will get an array of n positive integers b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bn such that 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89bi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ai for every 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n. Your task is to determine the maximum possible value of mex of this array.Mex of an array in this problem is the minimum positive integer that doesn\'t appear in this array. For example, mex of the array containing 1, 3 and 4 is equal to 2, while mex of the array containing 2, 3 and 2 is equal to 1." 1200

682A "Alyona and Numbers" "constructive algorithms,math,number theory" "After finishing eating her bun, Alyona came up with two integers n and m. She decided to write down two columns of integers�\xe2\x80\x94 the first column containing integers from 1 to n and the second containing integers from 1 to m. Now the girl wants to count how many pairs of integers she can choose, one from the first column and the other from the second column, such that their sum is divisible by 5.Formally, Alyona wants to count the number of pairs of integers (x,\xe2\x80\x89y) such that 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n, 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m and  equals 0.As usual, Alyona has some troubles and asks you to help." 1100

681E "Runaway to a Shadow" geometry,sortings "Dima is living in a dormitory, as well as some cockroaches.At the moment 0 Dima saw a cockroach running on a table and decided to kill it. Dima needs exactly T seconds for aiming, and after that he will precisely strike the cockroach and finish it.To survive the cockroach has to run into a shadow, cast by round plates standing on the table, in T seconds. Shadow casted by any of the plates has the shape of a circle. Shadow circles may intersect, nest or overlap arbitrarily.The cockroach uses the following strategy: first he equiprobably picks a direction to run towards and then runs towards it with the constant speed v. If at some moment t\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89T it reaches any shadow circle, it immediately stops in the shadow and thus will stay alive. Otherwise the cockroach is killed by the Dima\'s precise strike. Consider that the Dima\'s precise strike is instant.Determine the probability of that the cockroach will stay alive." 2500

681D "Gifts by the List" "constructive algorithms,dfs and similar,graphs,trees" "Sasha lives in a big happy family. At the Man\'s Day all the men of the family gather to celebrate it following their own traditions. There are n men in Sasha\'s family, so let\'s number them with integers from 1 to n.Each man has at most one father but may have arbitrary number of sons.Man number A is considered to be the ancestor of the man number B if at least one of the following conditions is satisfied:   A\xe2\x80\x89=\xe2\x80\x89B;  the man number A is the father of the man number B;  there is a man number C, such that the man number A is his ancestor and the man number C is the father of the man number B. Of course, if the man number A is an ancestor of the man number B and A\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89B, then the man number B is not an ancestor of the man number A.The tradition of the Sasha\'s family is to give gifts at the Man\'s Day. Because giving gifts in a normal way is boring, each year the following happens.  A list of candidates is prepared, containing some (possibly all) of the n men in some order.  Each of the n men decides to give a gift.  In order to choose a person to give a gift to, man A looks through the list and picks the first man B in the list, such that B is an ancestor of A and gives him a gift. Note that according to definition it may happen that a person gives a gift to himself.  If there is no ancestor of a person in the list, he becomes sad and leaves the celebration without giving a gift to anyone. This year you have decided to help in organizing celebration and asked each of the n men, who do they want to give presents to (this person is chosen only among ancestors). Are you able to make a list of candidates, such that all the wishes will be satisfied if they give gifts according to the process described above?" 2000

681C "Heap Operations" "constructive algorithms,data structures,greedy" "Petya has recently learned data structure named ""Binary heap"".The heap he is now operating with allows the following operations:   put the given number into the heap;  get the value of the minimum element in the heap;  extract the minimum element from the heap; Thus, at any moment of time the heap contains several integers (possibly none), some of them might be equal.In order to better learn this data structure Petya took an empty heap and applied some operations above to it. Also, he carefully wrote down all the operations and their results to his event log, following the format:   insert x�\xe2\x80\x94 put the element with value x in the heap;  getMin x�\xe2\x80\x94 the value of the minimum element contained in the heap was equal to x;  removeMin�\xe2\x80\x94 the minimum element was extracted from the heap (only one instance, if there were many). All the operations were correct, i.e. there was at least one element in the heap each time getMin or removeMin operations were applied.While Petya was away for a lunch, his little brother Vova came to the room, took away some of the pages from Petya\'s log and used them to make paper boats.Now Vova is worried, if he made Petya\'s sequence of operations inconsistent. For example, if one apply operations one-by-one in the order they are written in the event log, results of getMin operations might differ from the results recorded by Petya, and some of getMin or removeMin operations may be incorrect, as the heap is empty at the moment they are applied.Now Vova wants to add some new operation records to the event log in order to make the resulting sequence of operations correct. That is, the result of each getMin operation is equal to the result in the record, and the heap is non-empty when getMin ad removeMin are applied. Vova wants to complete this as fast as possible, as the Petya may get back at any moment. He asks you to add the least possible number of operation records to the current log. Note that arbitrary number of operations may be added at the beginning, between any two other operations, or at the end of the log." 1600

681B "Economy Game" "brute force" "Kolya is developing an economy simulator game. His most favourite part of the development process is in-game testing. Once he was entertained by the testing so much, that he found out his game-coin score become equal to 0.Kolya remembers that at the beginning of the game his game-coin score was equal to n and that he have bought only some houses (for 1\xe2\x80\x89234\xe2\x80\x89567 game-coins each), cars (for 123\xe2\x80\x89456 game-coins each) and computers (for 1\xe2\x80\x89234 game-coins each).Kolya is now interested, whether he could have spent all of his initial n game-coins buying only houses, cars and computers or there is a bug in the game. Formally, is there a triple of non-negative integers a, b and c such that a\xe2\x80\x89\xc3\x97\xe2\x80\x891\xe2\x80\x89234\xe2\x80\x89567\xe2\x80\x89+\xe2\x80\x89b\xe2\x80\x89\xc3\x97\xe2\x80\x89123\xe2\x80\x89456\xe2\x80\x89+\xe2\x80\x89c\xe2\x80\x89\xc3\x97\xe2\x80\x891\xe2\x80\x89234\xe2\x80\x89=\xe2\x80\x89n?Please help Kolya answer this question." 1300

681A "A Good Contest" implementation "Codeforces user\' handle color depends on his rating�\xe2\x80\x94 it is red if his rating is greater or equal to 2400; it is orange if his rating is less than 2400 but greater or equal to 2200, etc. Each time participant takes part in a rated contest, his rating is changed depending on his performance.Anton wants the color of his handle to become red. He considers his performance in the rated contest to be good if he outscored some participant, whose handle was colored red before the contest and his rating has increased after it.Anton has written a program that analyses contest results and determines whether he performed good or not. Are you able to do the same?" 800

680B "Bear and Finding Criminals" "constructive algorithms,implementation" "There are n cities in Bearland, numbered 1 through n. Cities are arranged in one long row. The distance between cities i and j is equal to |i\xe2\x80\x89-\xe2\x80\x89j|.Limak is a police officer. He lives in a city a. His job is to catch criminals. It\'s hard because he doesn\'t know in which cities criminals are. Though, he knows that there is at most one criminal in each city.Limak is going to use a BCD (Bear Criminal Detector). The BCD will tell Limak how many criminals there are for every distance from a city a. After that, Limak can catch a criminal in each city for which he is sure that there must be a criminal.You know in which cities criminals are. Count the number of criminals Limak will catch, after he uses the BCD." 1000

680A "Bear and Five Cards" "constructive algorithms,implementation" "A little bear Limak plays a game. He has five cards. There is one number written on each card. Each number is a positive integer.Limak can discard (throw out) some cards. His goal is to minimize the sum of numbers written on remaining (not discarded) cards.He is allowed to at most once discard two or three cards with the same number. Of course, he won\'t discard cards if it\'s impossible to choose two or three cards with the same number.Given five numbers written on cards, cay you find the minimum sum of numbers on remaining cards?" 800

679E "Bear and Bad Powers of 42" "data structures" "Limak, a bear, isn\'t good at handling queries. So, he asks you to do it.We say that powers of 42 (numbers 1,\xe2\x80\x8942,\xe2\x80\x891764,\xe2\x80\x89...) are bad. Other numbers are good.You are given a sequence of n good integers t1,\xe2\x80\x89t2,\xe2\x80\x89...,\xe2\x80\x89tn. Your task is to handle q queries of three types:  1 i�\xe2\x80\x94 print ti in a separate line.  2 a b x�\xe2\x80\x94 for  set ti to x. It\'s guaranteed that x is a good number.  3 a b x�\xe2\x80\x94 for  increase ti by x. After this repeat the process while at least one ti is bad. You can note that after each query all ti are good." 3100

679D "Bear and Chase" "brute force,dfs and similar,graphs,implementation,math,probabilities" "Bearland has n cities, numbered 1 through n. There are m bidirectional roads. The i-th road connects two distinct cities ai and bi. No two roads connect the same pair of cities. It\'s possible to get from any city to any other city (using one or more roads).The distance between cities a and b is defined as the minimum number of roads used to travel between a and b.Limak is a grizzly bear. He is a criminal and your task is to catch him, or at least to try to catch him. You have only two days (today and tomorrow) and after that Limak is going to hide forever.Your main weapon is BCD (Bear Criminal Detector). Where you are in some city, you can use BCD and it tells you the distance between you and a city where Limak currently is. Unfortunately, BCD can be used only once a day.You don\'t know much about Limak\'s current location. You assume that he is in one of n cities, chosen uniformly at random (each city with probability ). You decided for the following plan:  Choose one city and use BCD there.   After using BCD you can try to catch Limak (but maybe it isn\'t a good idea). In this case you choose one city and check it. You win if Limak is there. Otherwise, Limak becomes more careful and you will never catch him (you loose).   Wait 24 hours to use BCD again. You know that Limak will change his location during that time. In detail, he will choose uniformly at random one of roads from his initial city, and he will use the chosen road, going to some other city.  Tomorrow, you will again choose one city and use BCD there.  Finally, you will try to catch Limak. You will choose one city and check it. You will win if Limak is there, and loose otherwise. Each time when you choose one of cities, you can choose any of n cities. Let\'s say it isn\'t a problem for you to quickly get somewhere.What is the probability of finding Limak, if you behave optimally?" 2900

679C "Bear and Square Grid" "dfs and similar,dsu,implementation" "You have a grid with n rows and n columns. Each cell is either empty (denoted by \'.\') or blocked (denoted by \'X\').Two empty cells are directly connected if they share a side. Two cells (r1,\xe2\x80\x89c1) (located in the row r1 and column c1) and (r2,\xe2\x80\x89c2) are connected if there exists a sequence of empty cells that starts with (r1,\xe2\x80\x89c1), finishes with (r2,\xe2\x80\x89c2), and any two consecutive cells in this sequence are directly connected. A connected component is a set of empty cells such that any two cells in the component are connected, and there is no cell in this set that is connected to some cell not in this set.Your friend Limak is a big grizzly bear. He is able to destroy any obstacles in some range. More precisely, you can choose a square of size k\xe2\x80\x89\xc3\x97\xe2\x80\x89k in the grid and Limak will transform all blocked cells there to empty ones. However, you can ask Limak to help only once.The chosen square must be completely inside the grid. It\'s possible that Limak won\'t change anything because all cells are empty anyway.You like big connected components. After Limak helps you, what is the maximum possible size of the biggest connected component in the grid?" 2400

679B "Bear and Tower of Cubes" "binary search,dp,greedy" "Limak is a little polar bear. He plays by building towers from blocks. Every block is a cube with positive integer length of side. Limak has infinitely many blocks of each side length.A block with side a has volume a3. A tower consisting of blocks with sides a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89ak has the total volume a13\xe2\x80\x89+\xe2\x80\x89a23\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89ak3.Limak is going to build a tower. First, he asks you to tell him a positive integer X�\xe2\x80\x94 the required total volume of the tower. Then, Limak adds new blocks greedily, one by one. Each time he adds the biggest block such that the total volume doesn\'t exceed X.Limak asks you to choose X not greater than m. Also, he wants to maximize the number of blocks in the tower at the end (however, he still behaves greedily). Secondarily, he wants to maximize X.Can you help Limak? Find the maximum number of blocks his tower can have and the maximum X\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m that results this number of blocks." 2200

679A "Bear and Prime 100" "constructive algorithms,interactive,math" "This is an interactive problem. In the output section below you will see the information about flushing the output.Bear Limak thinks of some hidden number�\xe2\x80\x94 an integer from interval [2,\xe2\x80\x89100]. Your task is to say if the hidden number is prime or composite.Integer x\xe2\x80\x89>\xe2\x80\x891 is called prime if it has exactly two distinct divisors, 1 and x. If integer x\xe2\x80\x89>\xe2\x80\x891 is not prime, it\'s called composite.You can ask up to 20 queries about divisors of the hidden number. In each query you should print an integer from interval [2,\xe2\x80\x89100]. The system will answer ""yes"" if your integer is a divisor of the hidden number. Otherwise, the answer will be ""no"".For example, if the hidden number is 14 then the system will answer ""yes"" only if you print 2, 7 or 14.When you are done asking queries, print ""prime"" or ""composite"" and terminate your program.You will get the Wrong Answer verdict if you ask more than 20 queries, or if you print an integer not from the range [2,\xe2\x80\x89100]. Also, you will get the Wrong Answer verdict if the printed answer isn\'t correct.You will get the Idleness Limit Exceeded verdict if you don\'t print anything (but you should) or if you forget about flushing the output (more info below)." 1400

678F "Lena and Queries" "data structures,divide and conquer,geometry" "Lena is a programmer. She got a task to solve at work.There is an empty set of pairs of integers and n queries to process. Each query is one of three types:  Add a pair (a,\xe2\x80\x89b) to the set.  Remove a pair added in the query number i. All queries are numbered with integers from 1 to n.  For a given integer q find the maximal value x\xc2\xb7q\xe2\x80\x89+\xe2\x80\x89y over all pairs (x,\xe2\x80\x89y) from the set. Help Lena to process the queries." 2500

678E "Another Sith Tournament" bitmasks,dp,math,probabilities "The rules of Sith Tournament are well known to everyone. n Sith take part in the Tournament. The Tournament starts with the random choice of two Sith who will fight in the first battle. As one of them loses, his place is taken by the next randomly chosen Sith who didn\'t fight before. Does it need to be said that each battle in the Sith Tournament ends with a death of one of opponents? The Tournament ends when the only Sith remains alive.Jedi Ivan accidentally appeared in the list of the participants in the Sith Tournament. However, his skills in the Light Side of the Force are so strong so he can influence the choice of participants either who start the Tournament or who take the loser\'s place after each battle. Of course, he won\'t miss his chance to take advantage of it. Help him to calculate the probability of his victory." 2200

678D "Iterated Linear Function" "math,number theory" "Consider a linear function f(x)\xe2\x80\x89=\xe2\x80\x89Ax\xe2\x80\x89+\xe2\x80\x89B. Let\'s define g(0)(x)\xe2\x80\x89=\xe2\x80\x89x and g(n)(x)\xe2\x80\x89=\xe2\x80\x89f(g(n\xe2\x80\x89-\xe2\x80\x891)(x)) for n\xe2\x80\x89>\xe2\x80\x890. For the given integer values A, B, n and x find the value of g(n)(x) modulo 109\xe2\x80\x89+\xe2\x80\x897." 1700

678C "Joty and Chocolate" "implementation,math,number theory" "Little Joty has got a task to do. She has a line of n tiles indexed from 1 to n. She has to paint them in a strange pattern.An unpainted tile should be painted Red if it\'s index is divisible by a and an unpainted tile should be painted Blue if it\'s index is divisible by b. So the tile with the number divisible by a and b can be either painted Red or Blue.After her painting is done, she will get p chocolates for each tile that is painted Red and q chocolates for each tile that is painted Blue.Note that she can paint tiles in any order she wants.Given the required information, find the maximum�number of chocolates Joty can get." 1600

678B "The Same Calendar" implementation "The girl Taylor has a beautiful calendar for the year y. In the calendar all days are given with their days of week: Monday, Tuesday, Wednesday, Thursday, Friday, Saturday and Sunday.The calendar is so beautiful that she wants to know what is the next year after y when the calendar will be exactly the same. Help Taylor to find that year.Note that leap years has 366 days. The year is leap if it is divisible by 400 or it is divisible by 4, but not by 100 (https://en.wikipedia.org/wiki/Leap_year)." 1600

678A "Johny Likes Numbers" implementation,math "Johny likes numbers n and k very much. Now Johny wants to find the smallest integer x greater than n, so it is divisible by the number k." 800

677E "Vanya and Balloons" "binary search,brute force,dp,implementation" "Vanya plays a game of balloons on the field of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89n, where each cell contains a balloon with one of the values 0, 1, 2 or 3. The goal is to destroy a cross, such that the product of all values of balloons in the cross is maximum possible. There are two types of crosses: normal and rotated. For example:**o****o**ooooo**o****o**oro***o*o*o***o***o*o*o***oFormally, the cross is given by three integers r, c and d, such that d\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r,\xe2\x80\x89c\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x89d\xe2\x80\x89+\xe2\x80\x891. The normal cross consists of balloons located in cells (x,\xe2\x80\x89y) (where x stay for the number of the row and y for the number of the column), such that |x\xe2\x80\x89-\xe2\x80\x89r|\xc2\xb7|y\xe2\x80\x89-\xe2\x80\x89c|\xe2\x80\x89=\xe2\x80\x890 and |x\xe2\x80\x89-\xe2\x80\x89r|\xe2\x80\x89+\xe2\x80\x89|y\xe2\x80\x89-\xe2\x80\x89c|\xe2\x80\x89<\xe2\x80\x89d. Rotated cross consists of balloons located in cells (x,\xe2\x80\x89y), such that |x\xe2\x80\x89-\xe2\x80\x89r|\xe2\x80\x89=\xe2\x80\x89|y\xe2\x80\x89-\xe2\x80\x89c| and |x\xe2\x80\x89-\xe2\x80\x89r|\xe2\x80\x89<\xe2\x80\x89d.Vanya wants to know the maximum possible product of the values of balls forming one cross. As this value can be large, output it modulo 109\xe2\x80\x89+\xe2\x80\x897." 2300

677D "Vanya and Treasure" "data structures,dp,graphs,shortest paths" "Vanya is in the palace that can be represented as a grid n\xe2\x80\x89\xc3\x97\xe2\x80\x89m. Each room contains a single chest, an the room located in the i-th row and j-th columns contains the chest of type aij. Each chest of type x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89p\xe2\x80\x89-\xe2\x80\x891 contains a key that can open any chest of type x\xe2\x80\x89+\xe2\x80\x891, and all chests of type 1 are not locked. There is exactly one chest of type p and it contains a treasure.Vanya starts in cell (1,\xe2\x80\x891) (top left corner). What is the minimum total distance Vanya has to walk in order to get the treasure? Consider the distance between cell (r1,\xe2\x80\x89c1) (the cell in the row r1 and column c1) and (r2,\xe2\x80\x89c2) is equal to |r1\xe2\x80\x89-\xe2\x80\x89r2|\xe2\x80\x89+\xe2\x80\x89|c1\xe2\x80\x89-\xe2\x80\x89c2|." 2300

677C "Vanya and Label" bitmasks,combinatorics,implementation,strings "While walking down the street Vanya saw a label ""Hide&Seek"". Because he is a programmer, he used & as a bitwise AND for these two words represented as a integers in base 64 and got new word. Now Vanya thinks of some string s and wants to know the number of pairs of words of length |s| (length of s), such that their bitwise AND is equal to s. As this number can be large, output it modulo 109\xe2\x80\x89+\xe2\x80\x897.To represent the string as a number in numeral system with base 64 Vanya uses the following rules:  digits from \'0\' to \'9\' correspond to integers from 0 to 9;  letters from \'A\' to \'Z\' correspond to integers from 10 to 35;  letters from \'a\' to \'z\' correspond to integers from 36 to 61;  letter \'-\' correspond to integer 62;  letter \'_\' correspond to integer 63." 1500

677B "Vanya and Food Processor" implementation,math "Vanya smashes potato in a vertical food processor. At each moment of time the height of the potato in the processor doesn\'t exceed h and the processor smashes k centimeters of potato each second. If there are less than k centimeters remaining, than during this second processor smashes all the remaining potato.Vanya has n pieces of potato, the height of the i-th piece is equal to ai. He puts them in the food processor one by one starting from the piece number 1 and finishing with piece number n. Formally, each second the following happens:  If there is at least one piece of potato remaining, Vanya puts them in the processor one by one, until there is not enough space for the next piece.  Processor smashes k centimeters of potato (or just everything that is inside). Provided the information about the parameter of the food processor and the size of each potato in a row, compute how long will it take for all the potato to become smashed." 1400

677A "Vanya and Fence" implementation "Vanya and his friends are walking along the fence of height h and they do not want the guard to notice them. In order to achieve this the height of each of the friends should not exceed h. If the height of some person is greater than h he can bend down and then he surely won\'t be noticed by the guard. The height of the i-th person is equal to ai.Consider the width of the person walking as usual to be equal to 1, while the width of the bent person is equal to 2. Friends want to talk to each other while walking, so they would like to walk in a single row. What is the minimum width of the road, such that friends can walk in a row and remain unattended by the guard?" 800

676E "The Last Fight Between Human and AI" math "100 years have passed since the last victory of the man versus computer in Go. Technologies made a huge step forward and robots conquered the Earth! It\'s time for the final fight between human and robot that will decide the faith of the planet.The following game was chosen for the fights: initially there is a polynomial P(x)\xe2\x80\x89=\xe2\x80\x89anxn\xe2\x80\x89+\xe2\x80\x89an\xe2\x80\x89-\xe2\x80\x891xn\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89a1x\xe2\x80\x89+\xe2\x80\x89a0,\xe2\x80\x89 with yet undefined coefficients and the integer k. Players alternate their turns. At each turn, a player pick some index j, such that coefficient aj that stay near xj is not determined yet and sets it to any value (integer or real, positive or negative, 0 is also allowed). Computer moves first. The human will be declared the winner if and only if the resulting polynomial will be divisible by Q(x)\xe2\x80\x89=\xe2\x80\x89x\xe2\x80\x89-\xe2\x80\x89k.Polynomial P(x) is said to be divisible by polynomial Q(x) if there exists a representation P(x)\xe2\x80\x89=\xe2\x80\x89B(x)Q(x), where B(x) is also some polynomial.Some moves have been made already and now you wonder, is it true that human can guarantee the victory if he plays optimally?" 2400

676D "Theseus and labyrinth" "graphs,implementation,shortest paths" "Theseus has just arrived to Crete to fight Minotaur. He found a labyrinth that has a form of a rectangular field of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m and consists of blocks of size 1\xe2\x80\x89\xc3\x97\xe2\x80\x891.Each block of the labyrinth has a button that rotates all blocks 90 degrees clockwise. Each block rotates around its center and doesn\'t change its position in the labyrinth. Also, each block has some number of doors (possibly none). In one minute, Theseus can either push the button in order to rotate all the blocks 90 degrees clockwise or pass to the neighbouring block. Theseus can go from block A to some neighbouring block B only if block A has a door that leads to block B and block B has a door that leads to block A.Theseus found an entrance to labyrinth and is now located in block (xT,\xe2\x80\x89yT)�\xe2\x80\x94 the block in the row xT and column yT. Theseus know that the Minotaur is hiding in block (xM,\xe2\x80\x89yM) and wants to know the minimum number of minutes required to get there.Theseus is a hero, not a programmer, so he asks you to help him." 2000

676C "Vasya and String" "binary search,dp,strings,two pointers" "High school student Vasya got a string of length n as a birthday present. This string consists of letters \'a\' and \'b\' only. Vasya denotes beauty of the string as the maximum length of a substring (consecutive subsequence) consisting of equal letters.Vasya can change no more than k characters of the original string. What is the maximum beauty of the string he can achieve?" 1500

676B "Pyramid of Glasses" implementation,math,math "Mary has just graduated from one well-known University and is now attending celebration party. Students like to dream of a beautiful life, so they used champagne glasses to construct a small pyramid. The height of the pyramid is n. The top level consists of only 1 glass, that stands on 2 glasses on the second level (counting from the top), then 3 glasses on the third level and so on.The bottom level consists of n glasses.Vlad has seen in the movies many times how the champagne beautifully flows from top levels to bottom ones, filling all the glasses simultaneously. So he took a bottle and started to pour it in the glass located at the top of the pyramid.Each second, Vlad pours to the top glass the amount of champagne equal to the size of exactly one glass. If the glass is already full, but there is some champagne flowing in it, then it pours over the edge of the glass and is equally distributed over two glasses standing under. If the overflowed glass is at the bottom level, then the champagne pours on the table. For the purpose of this problem we consider that champagne is distributed among pyramid glasses immediately. Vlad is interested in the number of completely full glasses if he stops pouring champagne in t seconds.Pictures below illustrate the pyramid consisting of three levels." 1500

676A "Nicholas and Permutation" "constructive algorithms,implementation" "Nicholas has an array a that contains n distinct integers from 1 to n. In other words, Nicholas has a permutation of size n.Nicholas want the minimum element (integer 1) and the maximum element (integer n) to be as far as possible from each other. He wants to perform exactly one swap in order to maximize the distance between the minimum and the maximum elements. The distance between two elements is considered to be equal to the absolute difference between their positions." 800

675E "Trains and Statistic" "data structures,dp,greedy" "Vasya commutes by train every day. There are n train stations in the city, and at the i-th station it\'s possible to buy only tickets to stations from i\xe2\x80\x89+\xe2\x80\x891 to ai inclusive. No tickets are sold at the last station.Let \xcf\x81i,\xe2\x80\x89j be the minimum number of tickets one needs to buy in order to get from stations i to station j. As Vasya is fond of different useless statistic he asks you to compute the sum of all values \xcf\x81i,\xe2\x80\x89j among all pairs 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n." 2300

675D "Tree Construction" "data structures,trees" "During the programming classes Vasya was assigned a difficult problem. However, he doesn\'t know how to code and was unable to find the solution in the Internet, so he asks you to help.You are given a sequence a, consisting of n distinct integers, that is used to construct the binary search tree. Below is the formal description of the construction process.  First element a1 becomes the root of the tree.  Elements a2,a3,\xe2\x80\xa6,an are added one by one. To add element ai one needs to traverse the tree starting from the root and using the following rules:   The pointer to the current node is set to the root.  If ai is greater than the value in the current node, then its right child becomes the current node. Otherwise, the left child of the current node becomes the new current node.  If at some point there is no required child, the new node is created, it is assigned value ai and becomes the corresponding child of the current node." 1800

675C "Money Transfers" "constructive algorithms,data structures,greedy,sortings" "There are n banks in the city where Vasya lives, they are located in a circle, such that any two banks are neighbouring if their indices differ by no more than 1. Also, bank 1 and bank n are neighbours if n\xe2\x80\x89>\xe2\x80\x891. No bank is a neighbour of itself.Vasya has an account in each bank. Its balance may be negative, meaning Vasya owes some money to this bank.There is only one type of operations available: transfer some amount of money from any bank to account in any neighbouring bank. There are no restrictions on the size of the sum being transferred or balance requirements to perform this operation.Vasya doesn\'t like to deal with large numbers, so he asks you to determine the minimum number of operations required to change the balance of each bank account to zero. It\'s guaranteed, that this is possible to achieve, that is, the total balance of Vasya in all banks is equal to zero." 2100

675B "Restoring Painting" "brute force,constructive algorithms,math" "Vasya works as a watchman in the gallery. Unfortunately, one of the most expensive paintings was stolen while he was on duty. He doesn\'t want to be fired, so he has to quickly restore the painting. He remembers some facts about it.  The painting is a square 3\xe2\x80\x89\xc3\x97\xe2\x80\x893, each cell contains a single integer from 1 to n, and different cells may contain either different or equal integers.  The sum of integers in each of four squares 2\xe2\x80\x89\xc3\x97\xe2\x80\x892 is equal to the sum of integers in the top left square 2\xe2\x80\x89\xc3\x97\xe2\x80\x892.  Four elements a, b, c and d are known and are located as shown on the picture below. Help Vasya find out the number of distinct squares the satisfy all the conditions above. Note, that this number may be equal to 0, meaning Vasya remembers something wrong.Two squares are considered to be different, if there exists a cell that contains two different integers in different squares." 1400

675A "Infinite Sequence" math "Vasya likes everything infinite. Now he is studying the properties of a sequence s, such that its first element is equal to a (s1\xe2\x80\x89=\xe2\x80\x89a), and the difference between any two neighbouring elements is equal to c (si\xe2\x80\x89-\xe2\x80\x89si\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89=\xe2\x80\x89c). In particular, Vasya wonders if his favourite integer b appears in this sequence, that is, there exists a positive integer i, such that si\xe2\x80\x89=\xe2\x80\x89b. Of course, you are the person he asks for a help." 1100

673B "Problems for Round" greedy,implementation "There are n problems prepared for the next Codeforces round. They are arranged in ascending order by their difficulty, and no two problems have the same difficulty. Moreover, there are m pairs of similar problems. Authors want to split problems between two division according to the following rules:   Problemset of each division should be non-empty.  Each problem should be used in exactly one division (yes, it is unusual requirement).  Each problem used in division 1 should be harder than any problem used in division 2.  If two problems are similar, they should be used in different divisions. Your goal is count the number of ways to split problem between two divisions and satisfy all the rules. Two ways to split problems are considered to be different if there is at least one problem that belongs to division 1 in one of them and to division 2 in the other.Note, that the relation of similarity is not transitive. That is, if problem i is similar to problem j and problem j is similar to problem k, it doesn\'t follow that i is similar to k." 1300

673A "Bear and Game" implementation "Bear Limak likes watching sports on TV. He is going to watch a game today. The game lasts 90 minutes and there are no breaks.Each minute can be either interesting or boring. If 15 consecutive minutes are boring then Limak immediately turns TV off.You know that there will be n interesting minutes t1,\xe2\x80\x89t2,\xe2\x80\x89...,\xe2\x80\x89tn. Your task is to calculate for how many minutes Limak will watch the game." 800

672B "Different is Good" "constructive algorithms,implementation,strings" "A wise man told Kerem ""Different is good"" once, so Kerem wants all things in his life to be different. Kerem recently got a string s consisting of lowercase English letters. Since Kerem likes it when things are different, he wants all substrings of his string s to be distinct. Substring is a string formed by some number of consecutive characters of the string. For example, string ""aba"" has substrings """" (empty substring), ""a"", ""b"", ""a"", ""ab"", ""ba"", ""aba"".If string s has at least two equal substrings then Kerem will change characters at some positions to some other lowercase English letters. Changing characters is a very tiring job, so Kerem want to perform as few changes as possible.Your task is to find the minimum number of changes needed to make all the substrings of the given string distinct, or determine that it is impossible." 1000

672A "Summer Camp" implementation "Every year, hundreds of people come to summer camps, they learn new algorithms and solve hard problems.This is your first year at summer camp, and you are asked to solve the following problem. All integers starting with 1 are written in one line. The prefix of these line is ""123456789101112131415..."". Your task is to print the n-th digit of this string (digits are numbered starting with 1." 800

671E "Organizing a Race" "data structures,greedy" "Kekoland is a country with n beautiful cities numbered from left to right and connected by n\xe2\x80\x89-\xe2\x80\x891 roads. The i-th road connects cities i and i\xe2\x80\x89+\xe2\x80\x891 and length of this road is wi kilometers. When you drive in Kekoland, each time you arrive in city i by car you immediately receive gi liters of gas. There is no other way to get gas in Kekoland.You were hired by the Kekoland president Keko to organize the most beautiful race Kekoland has ever seen. Let race be between cities l and r (l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r). Race will consist of two stages. On the first stage cars will go from city l to city r. After completing first stage, next day second stage will be held, now racers will go from r to l with their cars. Of course, as it is a race, racers drive directly from start city to finish city. It means that at the first stage they will go only right, and at the second stage they go only left. Beauty of the race between l and r is equal to r\xe2\x80\x89-\xe2\x80\x89l\xe2\x80\x89+\xe2\x80\x891 since racers will see r\xe2\x80\x89-\xe2\x80\x89l\xe2\x80\x89+\xe2\x80\x891 beautiful cities of Kekoland. Cars have infinite tank so racers will take all the gas given to them.At the beginning of each stage racers start the race with empty tank (0 liters of gasoline). They will immediately take their gasoline in start cities (l for the first stage and r for the second stage) right after the race starts. It may not be possible to organize a race between l and r if cars will run out of gas before they reach finish.You have k presents. Each time you give a present to city i its value gi increases by 1. You may distribute presents among cities in any way (also give many presents to one city, each time increasing gi by 1). What is the most beautiful race you can organize?Each car consumes 1 liter of gas per one kilometer." 3300

671D "Roads in Yusland" "data structures,dp,greedy" "Mayor of Yusland just won the lottery and decided to spent money on something good for town. For example, repair all the roads in the town.Yusland consists of n intersections connected by n\xe2\x80\x89-\xe2\x80\x891 bidirectional roads. One can travel from any intersection to any other intersection using only these roads.There is only one road repairing company in town, named ""RC company"". Company\'s center is located at the intersection 1. RC company doesn\'t repair roads you tell them. Instead, they have workers at some intersections, who can repair only some specific paths. The i-th worker can be paid ci coins and then he repairs all roads on a path from ui to some vi that lies on the path from ui to intersection 1. Mayor asks you to choose the cheapest way to hire some subset of workers in order to repair all the roads in Yusland. It\'s allowed that some roads will be repaired more than once.If it\'s impossible to repair all roads print \xe2\x80\x89-\xe2\x80\x891." 2900

671C "Ultimate Weirdness of an Array" "data structures,number theory" "Yasin has an array a containing n integers. Yasin is a 5 year old, so he loves ultimate weird things.Yasin denotes weirdness of an array as maximum gcd(ai,\xe2\x80\x89\xe2\x80\x89aj) value among all 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n. For n\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x891 weirdness is equal to 0, gcd(x,\xe2\x80\x89\xe2\x80\x89y) is the greatest common divisor of integers x and y.He also defines the ultimate weirdness of an array. Ultimate weirdness is  where f(i,\xe2\x80\x89\xe2\x80\x89j) is weirdness of the new array a obtained by removing all elements between i and j inclusive, so new array is [a1... ai\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89aj\xe2\x80\x89+\xe2\x80\x891... an].Since 5 year old boys can\'t code, Yasin asks for your help to find the value of ultimate weirdness of the given array a!" 2800

671B "Robin Hood" "binary search,greedy" "We all know the impressive story of Robin Hood. Robin Hood uses his archery skills and his wits to steal the money from rich, and return it to the poor.There are n citizens in Kekoland, each person has ci coins. Each day, Robin Hood will take exactly 1 coin from the richest person in the city and he will give it to the poorest person (poorest person right after taking richest\'s 1 coin). In case the choice is not unique, he will select one among them at random. Sadly, Robin Hood is old and want to retire in k days. He decided to spend these last days with helping poor people. After taking his money are taken by Robin Hood richest person may become poorest person as well, and it might even happen that Robin Hood will give his money back. For example if all people have same number of coins, then next day they will have same number of coins too. Your task is to find the difference between richest and poorest persons wealth after k days. Note that the choosing at random among richest and poorest doesn\'t affect the answer." 2000

671A "Recycling Bottles" dp,geometry,greedy,implementation "It was recycling day in Kekoland. To celebrate it Adil and Bera went to Central Perk where they can take bottles from the ground and put them into a recycling bin.We can think Central Perk as coordinate plane. There are n bottles on the ground, the i-th bottle is located at position (xi,\xe2\x80\x89yi). Both Adil and Bera can carry only one bottle at once each. For both Adil and Bera the process looks as follows:   Choose to stop or to continue to collect bottles.  If the choice was to continue then choose some bottle and walk towards it.  Pick this bottle and walk to the recycling bin.  Go to step 1. Adil and Bera may move independently. They are allowed to pick bottles simultaneously, all bottles may be picked by any of the two, it\'s allowed that one of them stays still while the other one continues to pick bottles.They want to organize the process such that the total distance they walk (the sum of distance walked by Adil and distance walked by Bera) is minimum possible. Of course, at the end all bottles should lie in the recycling bin." 1800

670F "Restore a Number" "brute force,constructive algorithms,strings" "Vasya decided to pass a very large integer n to Kate. First, he wrote that number as a string, then he appended to the right integer k�\xe2\x80\x94 the number of digits in n. Magically, all the numbers were shuffled in arbitrary order while this note was passed to Kate. The only thing that Vasya remembers, is a non-empty substring of n (a substring of n is a sequence of consecutive digits of the number n).Vasya knows that there may be more than one way to restore the number n. Your task is to find the smallest possible initial integer n. Note that decimal representation of number n contained no leading zeroes, except the case the integer n was equal to zero itself (in this case a single digit 0 was used)." 2300

670E "Correct Bracket Sequence Editor" "data structures,dsu,strings" "Recently Polycarp started to develop a text editor that works only with correct bracket sequences (abbreviated as CBS). Note that a bracket sequence is correct if it is possible to get a correct mathematical expression by adding ""+""-s and ""1""-s to it. For example, sequences ""(())()"", ""()"" and ""(()(()))"" are correct, while "")("", ""(()"" and ""(()))("" are not. Each bracket in CBS has a pair. For example, in ""(()(()))"":  1st bracket is paired with 8th,  2d bracket is paired with 3d,  3d bracket is paired with 2d,  4th bracket is paired with 7th,  5th bracket is paired with 6th,  6th bracket is paired with 5th,  7th bracket is paired with 4th,  8th bracket is paired with 1st. Polycarp\'s editor currently supports only three operations during the use of CBS. The cursor in the editor takes the whole position of one of the brackets (not the position between the brackets!). There are three operations being supported:  \xc2\xabL\xc2\xbb�\xe2\x80\x94 move the cursor one position to the left,  \xc2\xabR\xc2\xbb�\xe2\x80\x94 move the cursor one position to the right,  \xc2\xabD\xc2\xbb�\xe2\x80\x94 delete the bracket in which the cursor is located, delete the bracket it\'s paired to and all brackets between them (that is, delete a substring between the bracket in which the cursor is located and the one it\'s paired to). After the operation ""D"" the cursor moves to the nearest bracket to the right (of course, among the non-deleted). If there is no such bracket (that is, the suffix of the CBS was deleted), then the cursor moves to the nearest bracket to the left (of course, among the non-deleted). There are pictures illustrated several usages of operation ""D"" below.  All incorrect operations (shift cursor over the end of CBS, delete the whole CBS, etc.) are not supported by Polycarp\'s editor.Polycarp is very proud of his development, can you implement the functionality of his editor?" 1700

670D2 "Magic Powder - 2" "binary search,implementation" "The term of this problem is the same as the previous one, the only exception \xe2\x80\x94 increased restrictions." 1500

670D1 "Magic Powder - 1" "binary search,brute force,implementation" "This problem is given in two versions that differ only by constraints. If you can solve this problem in large constraints, then you can just write a single solution to the both versions. If you find the problem too difficult in large constraints, you can write solution to the simplified version only.Waking up in the morning, Apollinaria decided to bake cookies. To bake one cookie, she needs n ingredients, and for each ingredient she knows the value ai�\xe2\x80\x94 how many grams of this ingredient one needs to bake a cookie. To prepare one cookie Apollinaria needs to use all n ingredients.Apollinaria has bi gram of the i-th ingredient. Also she has k grams of a magic powder. Each gram of magic powder can be turned to exactly 1 gram of any of the n ingredients and can be used for baking cookies.Your task is to determine the maximum number of cookies, which Apollinaria is able to bake using the ingredients that she has and the magic powder." 1400

670C Cinema implementation,sortings "Moscow is hosting a major international conference, which is attended by n scientists from different countries. Each of the scientists knows exactly one language. For convenience, we enumerate all languages of the world with integers from 1 to 109.In the evening after the conference, all n scientists decided to go to the cinema. There are m movies in the cinema they came to. Each of the movies is characterized by two distinct numbers�\xe2\x80\x94 the index of audio language and the index of subtitles language. The scientist, who came to the movie, will be very pleased if he knows the audio language of the movie, will be almost satisfied if he knows the language of subtitles and will be not satisfied if he does not know neither one nor the other (note that the audio language and the subtitles language for each movie are always different). Scientists decided to go together to the same movie. You have to help them choose the movie, such that the number of very pleased scientists is maximum possible. If there are several such movies, select among them one that will maximize the number of almost satisfied scientists." 1300

670B "Game of Robots" implementation "In late autumn evening n robots gathered in the cheerful company of friends. Each robot has a unique identifier�\xe2\x80\x94 an integer from 1 to 109.At some moment, robots decided to play the game ""Snowball"". Below there are the rules of this game. First, all robots stand in a row. Then the first robot says his identifier. After that the second robot says the identifier of the first robot and then says his own identifier. Then the third robot says the identifier of the first robot, then says the identifier of the second robot and after that says his own. This process continues from left to right until the n-th robot says his identifier.Your task is to determine the k-th identifier to be pronounced." 1000

670A Holidays "brute force,constructive algorithms,greedy,math" "On the planet Mars a year lasts exactly n days (there are no leap years on Mars). But Martians have the same weeks as earthlings�\xe2\x80\x94 5 work days and then 2 days off. Your task is to determine the minimum possible and the maximum possible number of days off per year on Mars." 900

669A "Little Artem and Presents" math "Little Artem got n stones on his birthday and now wants to give some of them to Masha. He knows that Masha cares more about the fact of receiving the present, rather than the value of that present, so he wants to give her stones as many times as possible. However, Masha remembers the last present she received, so Artem can\'t give her the same number of stones twice in a row. For example, he can give her 3 stones, then 1 stone, then again 3 stones, but he can\'t give her 3 stones and then again 3 stones right after that.How many times can Artem give presents to Masha?" 800

667B "Coat of Anticubism" "constructive algorithms,geometry" "As some of you know, cubism is a trend in art, where the problem of constructing volumetrical shape on a plane with a combination of three-dimensional geometric shapes comes to the fore. A famous sculptor Cicasso, whose self-portrait you can contemplate, hates cubism. He is more impressed by the idea to transmit two-dimensional objects through three-dimensional objects by using his magnificent sculptures. And his new project is connected with this. Cicasso wants to make a coat for the haters of anticubism. To do this, he wants to create a sculpture depicting a well-known geometric primitive \xe2\x80\x94 convex polygon.Cicasso prepared for this a few blanks, which are rods with integer lengths, and now he wants to bring them together. The i-th rod is a segment of length li.The sculptor plans to make a convex polygon with a nonzero area, using all rods he has as its sides. Each rod should be used as a side to its full length. It is forbidden to cut, break or bend rods. However, two sides may form a straight angle .Cicasso knows that it is impossible to make a convex polygon with a nonzero area out of the rods with the lengths which he had chosen. Cicasso does not want to leave the unused rods, so the sculptor decides to make another rod-blank with an integer length so that his problem is solvable. Of course, he wants to make it as short as possible, because the materials are expensive, and it is improper deed to spend money for nothing. Help sculptor!" 1100

667A "Pouring Rain" geometry,math "A lot of people in Berland hates rain, but you do not. Rain pacifies, puts your thoughts in order. By these years you have developed a good tradition \xe2\x80\x94 when it rains, you go on the street and stay silent for a moment, contemplate all around you, enjoy freshness, think about big deeds you have to do. Today everything had changed quietly. You went on the street with a cup contained water, your favorite drink. In a moment when you were drinking a water you noticed that the process became quite long: the cup still contained water because of rain. You decided to make a formal model of what was happening and to find if it was possible to drink all water in that situation. Thus, your cup is a cylinder with diameter equals d centimeters. Initial level of water in cup equals h centimeters from the bottom.   You drink a water with a speed equals v milliliters per second. But rain goes with such speed that if you do not drink a water from the cup, the level of water increases on e centimeters per second. The process of drinking water from the cup and the addition of rain to the cup goes evenly and continuously. Find the time needed to make the cup empty or find that it will never happen. It is guaranteed that if it is possible to drink all water, it will happen not later than after 104 seconds.Note one milliliter equals to one cubic centimeter." 1100

666E "Forensic Examination" "data structures,string suffix structures" "The country of Reberland is the archenemy of Berland. Recently the authorities of Berland arrested a Reberlandian spy who tried to bring the leaflets intended for agitational propaganda to Berland illegally . The most leaflets contain substrings of the Absolutely Inadmissible Swearword and maybe even the whole word.Berland legal system uses the difficult algorithm in order to determine the guilt of the spy. The main part of this algorithm is the following procedure.All the m leaflets that are brought by the spy are numbered from 1 to m. After that it\'s needed to get the answer to q queries of the following kind: ""In which leaflet in the segment of numbers [l,\xe2\x80\x89r] the substring of the Absolutely Inadmissible Swearword [pl,\xe2\x80\x89pr] occurs more often?"".The expert wants you to automate that procedure because this time texts of leaflets are too long. Help him!" 3100

666D "Chain Reaction" "brute force,geometry" "Group of Berland scientists, with whom you have a close business relationship, makes a research in the area of peaceful nuclear energy. In particular, they found that a group of four nanobots, placed on a surface of a plate, can run a powerful chain reaction under certain conditions. To be precise, researchers introduced a rectangular Cartesian coordinate system on a flat plate and selected four distinct points with integer coordinates where bots will be placed initially. Next each bot will be assigned with one of the four directions (up, down, left or right) parallel to the coordinate axes. After that, each bot is shifted by an integer distance (which may be different for different bots) along its direction. The chain reaction starts, if the bots are in the corners of a square with positive area with sides parallel to the coordinate axes. Each corner of the square must contain one nanobot. This reaction will be stronger, if bots spend less time to move. We can assume that bots move with unit speed. In other words, the lesser is the maximum length traveled by bot, the stronger is reaction.Scientists have prepared a set of plates and selected starting position for the bots for each plate. Now they ask you to assign the direction for each bot to move after landing such that the maximum length traveled by bot is as small as possible." 3000

666C Codeword combinatorics,strings "The famous sculptor Cicasso is a Reberlandian spy!These is breaking news in Berlandian papers today. And now the sculptor is hiding. This time you give the shelter to the maestro. You have a protected bunker and you provide it to your friend. You set the security system in such way that only you can open the bunker. To open it one should solve the problem which is hard for others but is simple for you.Every day the bunker generates a codeword s. Every time someone wants to enter the bunker, integer n appears on the screen. As the answer one should enter another integer \xe2\x80\x94 the residue modulo 109\xe2\x80\x89+\xe2\x80\x897 of the number of strings of length n that consist only of lowercase English letters and contain the string s as the subsequence.The subsequence of string a is a string b that can be derived from the string a by removing some symbols from it (maybe none or all of them). In particular any string is the subsequence of itself. For example, the string ""cfo"" is the subsequence of the string ""codeforces"".You haven\'t implemented the algorithm that calculates the correct answers yet and you should do that ASAP." 2500

666B "World Tour" "graphs,shortest paths" "A famous sculptor Cicasso goes to a world tour!Well, it is not actually a world-wide. But not everyone should have the opportunity to see works of sculptor, shouldn\'t he? Otherwise there will be no any exclusivity. So Cicasso will entirely hold the world tour in his native country \xe2\x80\x94 Berland.Cicasso is very devoted to his work and he wants to be distracted as little as possible. Therefore he will visit only four cities. These cities will be different, so no one could think that he has ""favourites"". Of course, to save money, he will chose the shortest paths between these cities. But as you have probably guessed, Cicasso is a weird person. Although he doesn\'t like to organize exhibitions, he likes to travel around the country and enjoy its scenery. So he wants the total distance which he will travel to be as large as possible. However, the sculptor is bad in planning, so he asks you for help. There are n cities and m one-way roads in Berland. You have to choose four different cities, which Cicasso will visit and also determine the order in which he will visit them. So that the total distance he will travel, if he visits cities in your order, starting from the first city in your list, and ending in the last, choosing each time the shortest route between a pair of cities \xe2\x80\x94 will be the largest. Note that intermediate routes may pass through the cities, which are assigned to the tour, as well as pass twice through the same city. For example, the tour can look like that: . Four cities in the order of visiting marked as overlines: [1,\xe2\x80\x895,\xe2\x80\x892,\xe2\x80\x894].Note that Berland is a high-tech country. So using nanotechnologies all roads were altered so that they have the same length. For the same reason moving using regular cars is not very popular in the country, and it can happen that there are such pairs of cities, one of which generally can not be reached by car from the other one. However, Cicasso is very conservative and cannot travel without the car. Choose cities so that the sculptor can make the tour using only the automobile. It is guaranteed that it is always possible to do." 2000

666A "Reberland Linguistics" dp,implementation,strings "First-rate specialists graduate from Berland State Institute of Peace and Friendship. You are one of the most talented students in this university. The education is not easy because you need to have fundamental knowledge in different areas, which sometimes are not related to each other. For example, you should know linguistics very well. You learn a structure of Reberland language as foreign language. In this language words are constructed according to the following rules. First you need to choose the ""root"" of the word \xe2\x80\x94 some string which has more than 4 letters. Then several strings with the length 2 or 3 symbols are appended to this word. The only restriction \xe2\x80\x94  it is not allowed to append the same string twice in a row. All these strings are considered to be suffixes of the word (this time we use word ""suffix"" to describe a morpheme but not the few last characters of the string as you may used to). Here is one exercise that you have found in your task list. You are given the word s. Find all distinct strings with the length 2 or 3, which can be suffixes of this word according to the word constructing rules in Reberland language. Two strings are considered distinct if they have different length or there is a position in which corresponding characters do not match. Let\'s look at the example: the word abacabaca is given. This word can be obtained in the following ways: , where the root of the word is overlined, and suffixes are marked by ""corners"". Thus, the set of possible suffixes for this word is {aca,\xe2\x80\x89ba,\xe2\x80\x89ca}." 1800

665F "Four Divisors" "data structures,dp,math,number theory,sortings,two pointers" "If an integer a is divisible by another integer b, then b is called the divisor of a.For example: 12 has positive 6 divisors. They are 1, 2, 3, 4, 6 and 12.Let\xe2\x80\x99s define a function D(n) \xe2\x80\x94 number of integers between 1 and n (inclusive) which has exactly four positive divisors.Between 1 and 10 only the integers 6, 8 and 10 has exactly four positive divisors. So, D(10)\xe2\x80\x89=\xe2\x80\x893.You are given an integer n. You have to calculate D(n)." 2400

665E "Beautiful Subarrays" "data structures,divide and conquer,strings,trees" "One day, ZS the Coder wrote down an array of integers a\xe2\x80\x89with elements a1,\xe2\x80\x89\xe2\x80\x89a2,\xe2\x80\x89\xe2\x80\x89...,\xe2\x80\x89\xe2\x80\x89an.A subarray of the array a is a sequence al,\xe2\x80\x89\xe2\x80\x89al\xe2\x80\x89\xe2\x80\x89+\xe2\x80\x89\xe2\x80\x891,\xe2\x80\x89\xe2\x80\x89...,\xe2\x80\x89\xe2\x80\x89ar for some integers (l,\xe2\x80\x89\xe2\x80\x89r) such that 1\xe2\x80\x89\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89\xe2\x80\x89l\xe2\x80\x89\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89\xe2\x80\x89r\xe2\x80\x89\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89\xe2\x80\x89n. ZS the Coder thinks that a subarray of a is beautiful if the bitwise xor of all the elements in the subarray is at least k.Help ZS the Coder find the number of beautiful subarrays of a!" 2100

665D "Simple Subset" "constructive algorithms,greedy,number theory" "A tuple of positive integers {x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xk} is called simple if for all pairs of positive integers (i,\xe2\x80\x89\xe2\x80\x89j) (1\xe2\x80\x89\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x80\x89<\xe2\x80\x89\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k), xi\xe2\x80\x89\xe2\x80\x89+\xe2\x80\x89\xe2\x80\x89xj is a prime.You are given an array a with n positive integers a1,\xe2\x80\x89\xe2\x80\x89a2,\xe2\x80\x89\xe2\x80\x89...,\xe2\x80\x89\xe2\x80\x89an (not necessary distinct). You want to find a simple subset of the array a with the maximum size.A prime number (or a prime) is a natural number greater than 1 that has no positive divisors other than 1 and itself.Let\'s define a subset of the array a as a tuple that can be obtained from a by removing some (possibly all) elements of it." 1800

665C "Simple Strings" dp,greedy,strings "zscoder loves simple strings! A string t is called simple if every pair of adjacent characters are distinct. For example ab, aba, zscoder are simple whereas aa, add are not simple.zscoder is given a string s. He wants to change a minimum number of characters so that the string s becomes simple. Help him with this task!" 1300

665B Shopping "brute force" "Ayush is a cashier at the shopping center. Recently his department has started a \'\'click and collect"" service which allows users to shop online. The store contains k items. n customers have already used the above service. Each user paid for m items. Let aij denote the j-th item in the i-th person\'s order.Due to the space limitations all the items are arranged in one single row. When Ayush receives the i-th order he will find one by one all the items aij (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m) in the row. Let pos(x) denote the position of the item x in the row at the moment of its collection. Then Ayush takes time equal to pos(ai1)\xe2\x80\x89+\xe2\x80\x89pos(ai2)\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89pos(aim) for the i-th customer.When Ayush accesses the x-th element he keeps a new stock in the front of the row and takes away the x-th element. Thus the values are updating.Your task is to calculate the total time it takes for Ayush to process all the orders.You can assume that the market has endless stock." 1400

665A "Buses Between Cities" implementation "Buses run between the cities A and B, the first one is at 05:00 AM and the last one departs not later than at 11:59 PM. A bus from the city A departs every a minutes and arrives to the city B in a ta minutes, and a bus from the city B departs every b minutes and arrives to the city A in a tb minutes.The driver Simion wants to make his job diverse, so he counts the buses going towards him. Simion doesn\'t count the buses he meet at the start and finish.You know the time when Simion departed from the city A to the city B. Calculate the number of buses Simion will meet to be sure in his counting." 1600

664A "Complicated GCD" "math,number theory" "Greatest common divisor GCD(a,\xe2\x80\x89b) of two positive integers a and b is equal to the biggest integer d such that both integers a and b are divisible by d. There are many efficient algorithms to find greatest common divisor GCD(a,\xe2\x80\x89b), for example, Euclid algorithm. Formally, find the biggest integer d, such that all integers a,\xe2\x80\x89a\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89a\xe2\x80\x89+\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89b are divisible by d. To make the problem even more complicated we allow a and b to be up to googol, 10100�\xe2\x80\x94 such number do not fit even in 64-bit integer type!" 800

663A Rebus "constructive algorithms,expression parsing,greedy,math" "You are given a rebus of form ? + ? - ? + ? = n, consisting of only question marks, separated by arithmetic operation \'+\' and \'-\', equality and positive integer n. The goal is to replace each question mark with some positive integer from 1 to n, such that equality holds." 1800

662E "To Hack or not to Hack" "brute force,dp,greedy" "Consider a regular Codeforces round consisting of three problems that uses dynamic scoring.You are given an almost final scoreboard. For each participant (including yourself), the time of the accepted submission for each of the problems is given. Also, for each solution you already know whether you are able to hack it or not. The only changes in the scoreboard that will happen before the end of the round are your challenges.What is the best place you may take at the end?More formally, n people are participating (including yourself). For any problem, if it was solved by exactly k people at the end of the round, the maximum score for this problem is defined as:   If n\xe2\x80\x89<\xe2\x80\x892k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x892n, then the maximum possible score is 500;  If n\xe2\x80\x89<\xe2\x80\x894k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x892n, then the maximum possible score is 1000;  If n\xe2\x80\x89<\xe2\x80\x898k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x892n, then the maximum possible score is 1500;  If n\xe2\x80\x89<\xe2\x80\x8916k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x892n, then the maximum possible score is 2000;  If n\xe2\x80\x89<\xe2\x80\x8932k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x892n, then the maximum possible score is 2500;  If 32k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n, then the maximum possible score is 3000. Let the maximum possible score for some problem be equal to s. Then a contestant who didn\'t manage to get it accepted (or his solution was hacked) earns 0 points for this problem. If he got the the solution accepted t minutes after the beginning of the round (and his solution wasn\'t hacked), he earns  points for this problem.The overall score of a participant is equal to the sum of points he earns for each problem plus 100 points for each successful hack (only you make hacks).The resulting place you get is equal to one plus the number of participants who\'s overall score is strictly greater than yours." 3100

662D "International Olympiad" "constructive algorithms,greedy,implementation,math" "International Abbreviation Olympiad takes place annually starting from 1989. Each year the competition receives an abbreviation of form IAO\'y, where y stands for some number of consequent last digits of the current year. Organizers always pick an abbreviation with non-empty string y that has never been used before. Among all such valid abbreviations they choose the shortest one and announce it to be the abbreviation of this year\'s competition.For example, the first three Olympiads (years 1989, 1990 and 1991, respectively) received the abbreviations IAO\'9, IAO\'0 and IAO\'1, while the competition in 2015 received an abbreviation IAO\'15, as IAO\'5 has been already used in 1995.You are given a list of abbreviations. For each of them determine the year it stands for." 2000

662C "Binary Table" "bitmasks,brute force,divide and conquer,dp,fft,math" "You are given a table consisting of n rows and m columns. Each cell of the table contains either 0 or 1. In one move, you are allowed to pick any row or any column and invert all values, that is, replace 0 by 1 and vice versa.What is the minimum number of cells with value 1 you can get after applying some number of operations?" 2600

662B "Graph Coloring" "dfs and similar,graphs" "You are given an undirected graph that consists of n vertices and m edges. Initially, each edge is colored either red or blue. Each turn a player picks a single vertex and switches the color of all edges incident to it. That is, all red edges with an endpoint in this vertex change the color to blue, while all blue edges with an endpoint in this vertex change the color to red.Find the minimum possible number of moves required to make the colors of all edges equal." 2200

662A "Gambling Nim" bitmasks,math,matrices,probabilities "As you know, the game of ""Nim"" is played with n piles of stones, where the i-th pile initially contains ai stones. Two players alternate the turns. During a turn a player picks any non-empty pile and removes any positive number of stones from it. The one who is not able to make a move loses the game.Petya and Vasya are tired of playing Nim, so they invented their own version of the game and named it the ""Gambling Nim"". They have n two-sided cards, one side of the i-th card has number ai written on it, while the other side has number bi. At the beginning of the game the players put all the cards on the table, each card only one of its sides up, and this side is chosen independently and uniformly. Thus they obtain a sequence c1,\xe2\x80\x89c2,\xe2\x80\x89...,\xe2\x80\x89cn, where ci is equal to ai or bi. Then they take n piles of stones, with i-th pile containing exactly ci stones and play Nim. Petya takes the first turn.Given that both players play optimally, find the probability of Petya\'s victory. Output the answer as an irreducible fraction." 2400

661H "Rotate Matrix" "*special problem" "You are given a square matrix of integer numbers. Rotate it 90 degrees clockwise (see examples for clarification of rotation)." 2400

661G "Hungarian Notation" "*special problem" "In Hungarian notation, a variable name is prefixed with a letter or a group of letters which are mnemonics for the type of that variable. For the purposes of this problem we will consider only two data types: integer and real.You are given the meaningful part of variable name in lowercase and a sample value that it will store. Integer values will be written as a sequence of digits. Real values will be written using fixed-point notation: the value is represented with a mandatory decimal point, one or more digits in the decimal part and without exponent part.Your task is to construct a name of this variable in Hungarian notation in the following way. Convert the first letter of meaningful part of the name to uppercase, and prepend a prefix: \'i\' for integer variables and \'f\' for real ones." 2200

661F "Primes in Interval" "*special problem" "You are given two integers a and b (a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b). How many prime numbers are there on the interval from a to b, inclusive?" 1900

661E "Divisibility Check" "*special problem" "You are given an array of integers. Check whether there exists a number in this array which is divisible by all other numbers in this array. Output 1, if such a number exists, and 0 otherwise." 2000

661D "Maximal Difference" "*special problem" "You are given an array of integers ai. Find the largest absolute value of difference between adjacent elements of the array max(abs(ai\xe2\x80\x89-\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x891))." 2100

661C "Array Sum" "*special problem" "You are given an array of integers. Calculate the sum of its elements." 2000

661B Seasons "*special problem" "You are given a name of a month. Output the season of the year to which it belongs (based on Northern hemisphere)." 1900

661A "Lazy Caterer Sequence" "*special problem" "Lazy caterer sequence is defined as the maximum number of pieces formed when slicing a convex pancake with n cuts (each cut is a straight line). The formula is Cn\xe2\x80\x89=\xe2\x80\x89n\xc2\xb7(n\xe2\x80\x89+\xe2\x80\x891)\xe2\x80\x89/\xe2\x80\x892\xe2\x80\x89+\xe2\x80\x891. You are given n; calculate n-th element of the sequence." 1300

660F "Bear and Bowling 4" "binary search,data structures,divide and conquer,geometry,ternary search" "Limak is an old brown bear. He often goes bowling with his friends. Today he feels really good and tries to beat his own record!For rolling a ball one gets a score \xe2\x80\x94 an integer (maybe negative) number of points. Score for the i-th roll is multiplied by i and scores are summed up. So, for k rolls with scores s1,\xe2\x80\x89s2,\xe2\x80\x89...,\xe2\x80\x89sk, the total score is . The total score is 0 if there were no rolls.Limak made n rolls and got score ai for the i-th of them. He wants to maximize his total score and he came up with an interesting idea. He can say that some first rolls were only a warm-up, and that he wasn\'t focused during the last rolls. More formally, he can cancel any prefix and any suffix of the sequence a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. It is allowed to cancel all rolls, or to cancel none of them.The total score is calculated as if there were only non-canceled rolls. So, the first non-canceled roll has score multiplied by 1, the second one has score multiplied by 2, and so on, till the last non-canceled roll.What maximum total score can Limak get?" 2500

660E "Different Subsets For All Tuples" combinatorics,math "For a sequence a of n integers between 1 and m, inclusive, denote f(a) as the number of distinct subsequences of a (including the empty subsequence).You are given two positive integers n and m. Let S be the set of all sequences of length n consisting of numbers from 1 to m. Compute the sum f(a) over all a in S modulo 109\xe2\x80\x89+\xe2\x80\x897." 2300

660D "Number of Parallelograms" geometry "You are given n points on a plane. All the points are distinct and no three of them lie on the same line. Find the number of parallelograms with the vertices at the given points." 1900

660C "Hard Process" "binary search,dp,two pointers" "You are given an array a with n elements. Each element of a is either 0 or 1.Let\'s denote the length of the longest subsegment of consecutive elements in a, consisting of only numbers one, as f(a). You can change no more than k zeroes to ones to maximize f(a)." 1600

660B "Seating On Bus" implementation "Consider 2n rows of the seats in a bus. n rows of the seats on the left and n rows of the seats on the right. Each row can be filled by two people. So the total capacity of the bus is 4n.Consider that m (m\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x894n) people occupy the seats in the bus. The passengers entering the bus are numbered from 1 to m (in the order of their entering the bus). The pattern of the seat occupation is as below:1-st row left window seat, 1-st row right window seat, 2-nd row left window seat, 2-nd row right window seat, ... , n-th row left window seat, n-th row right window seat.After occupying all the window seats (for m\xe2\x80\x89>\xe2\x80\x892n) the non-window seats are occupied:1-st row left non-window seat, 1-st row right non-window seat, ... , n-th row left non-window seat, n-th row right non-window seat.All the passengers go to a single final destination. In the final destination, the passengers get off in the given order.1-st row left non-window seat, 1-st row left window seat, 1-st row right non-window seat, 1-st row right window seat, ... , n-th row left non-window seat, n-th row left window seat, n-th row right non-window seat, n-th row right window seat.  The seating for n\xe2\x80\x89=\xe2\x80\x899 and m\xe2\x80\x89=\xe2\x80\x8936. You are given the values n and m. Output m numbers from 1 to m, the order in which the passengers will get off the bus." 1000

660A "Co-prime Array" "greedy,implementation,math,number theory" "You are given an array of n elements, you must make it a co-prime array in as few moves as possible.In each move you can insert any positive integral number you want not greater than 109 in any place in the array.An array is co-prime if any two adjacent numbers of it are co-prime.In the number theory, two integers a and b are said to be co-prime if the only positive integer that divides both of them is 1." 1200

659G "Fence Divercity" "combinatorics,dp,number theory" "Long ago, Vasily built a good fence at his country house. Vasily calls a fence good, if it is a series of n consecutively fastened vertical boards of centimeter width, the height of each in centimeters is a positive integer. The house owner remembers that the height of the i-th board to the left is hi.Today Vasily decided to change the design of the fence he had built, by cutting his top connected part so that the fence remained good. The cut part should consist of only the upper parts of the boards, while the adjacent parts must be interconnected (share a non-zero length before cutting out of the fence).You, as Vasily\'s curious neighbor, will count the number of possible ways to cut exactly one part as is described above. Two ways to cut a part are called distinct, if for the remaining fences there is such i, that the height of the i-th boards vary.As Vasily\'s fence can be very high and long, get the remainder after dividing the required number of ways by 1\xe2\x80\x89000\xe2\x80\x89000\xe2\x80\x89007 (109\xe2\x80\x89+\xe2\x80\x897)." 2300

659F "Polycarp and Hay" "dfs and similar,dsu,graphs,greedy,sortings" "The farmer Polycarp has a warehouse with hay, which can be represented as an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m rectangular table, where n is the number of rows, and m is the number of columns in the table. Each cell of the table contains a haystack. The height in meters of the hay located in the i-th row and the j-th column is equal to an integer ai,\xe2\x80\x89j and coincides with the number of cubic meters of hay in the haystack, because all cells have the size of the base 1\xe2\x80\x89\xc3\x97\xe2\x80\x891. Polycarp has decided to tidy up in the warehouse by removing an arbitrary integer amount of cubic meters of hay from the top of each stack. You can take different amounts of hay from different haystacks. Besides, it is allowed not to touch a stack at all, or, on the contrary, to remove it completely. If a stack is completely removed, the corresponding cell becomes empty and no longer contains the stack.Polycarp wants the following requirements to hold after the reorganization:  the total amount of hay remaining in the warehouse must be equal to k,  the heights of all stacks (i.e., cells containing a non-zero amount of hay) should be the same,  the height of at least one stack must remain the same as it was,  for the stability of the remaining structure all the stacks should form one connected region. The two stacks are considered adjacent if they share a side in the table. The area is called connected if from any of the stack in the area you can get to any other stack in this area, moving only to adjacent stacks. In this case two adjacent stacks necessarily belong to the same area.Help Polycarp complete this challenging task or inform that it is impossible." 2000

659E "New Reform" "data structures,dfs and similar,dsu,graphs,greedy" "Berland has n cities connected by m bidirectional roads. No road connects a city to itself, and each pair of cities is connected by no more than one road. It is not guaranteed that you can get from any city to any other one, using only the existing roads.The President of Berland decided to make changes to the road system and instructed the Ministry of Transport to make this reform. Now, each road should be unidirectional (only lead from one city to another).In order not to cause great resentment among residents, the reform needs to be conducted so that there can be as few separate cities as possible. A city is considered separate, if no road leads into it, while it is allowed to have roads leading from this city.Help the Ministry of Transport to find the minimum possible number of separate cities after the reform." 1600

659D "Bicycle Race" geometry,implementation,math "Maria participates in a bicycle race.The speedway takes place on the shores of Lake Lucerne, just repeating its contour. As you know, the lake shore consists only of straight sections, directed to the north, south, east or west.Let\'s introduce a system of coordinates, directing the Ox axis from west to east, and the Oy axis from south to north. As a starting position of the race the southernmost point of the track is selected (and if there are several such points, the most western among them). The participants start the race, moving to the north. At all straight sections of the track, the participants travel in one of the four directions (north, south, east or west) and change the direction of movement only in bends between the straight sections. The participants, of course, never turn back, that is, they do not change the direction of movement from north to south or from east to west (or vice versa).Maria is still young, so she does not feel confident at some turns. Namely, Maria feels insecure if at a failed or untimely turn, she gets into the water. In other words, Maria considers the turn dangerous if she immediately gets into the water if it is ignored.Help Maria get ready for the competition�\xe2\x80\x94 determine the number of dangerous turns on the track." 1500

659C "Tanya and Toys" greedy,implementation "In Berland recently a new collection of toys went on sale. This collection consists of 109 types of toys, numbered with integers from 1 to 109. A toy from the new collection of the i-th type costs i bourles.Tania has managed to collect n different types of toys a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an from the new collection. Today is Tanya\'s birthday, and her mother decided to spend no more than m bourles on the gift to the daughter. Tanya will choose several different types of toys from the new collection as a gift. Of course, she does not want to get a type of toy which she already has.Tanya wants to have as many distinct types of toys in her collection as possible as the result. The new collection is too diverse, and Tanya is too little, so she asks you to help her in this." 1200

659B "Qualifying Contest" "constructive algorithms,sortings" "Very soon Berland will hold a School Team Programming Olympiad. From each of the m Berland regions a team of two people is invited to participate in the olympiad. The qualifying contest to form teams was held and it was attended by n Berland students. There were at least two schoolboys participating from each of the m regions of Berland. The result of each of the participants of the qualifying competition is an integer score from 0 to 800 inclusive.The team of each region is formed from two such members of the qualifying competition of the region, that none of them can be replaced by a schoolboy of the same region, not included in the team and who received a greater number of points. There may be a situation where a team of some region can not be formed uniquely, that is, there is more than one school team that meets the properties described above. In this case, the region needs to undertake an additional contest. The two teams in the region are considered to be different if there is at least one schoolboy who is included in one team and is not included in the other team. It is guaranteed that for each region at least two its representatives participated in the qualifying contest.Your task is, given the results of the qualifying competition, to identify the team from each region, or to announce that in this region its formation requires additional contests." 1300

659A "Round House" implementation,math "Vasya lives in a round building, whose entrances are numbered sequentially by integers from 1 to n. Entrance n and entrance 1 are adjacent.Today Vasya got bored and decided to take a walk in the yard. Vasya lives in entrance a and he decided that during his walk he will move around the house b entrances in the direction of increasing numbers (in this order entrance n should be followed by entrance 1). The negative value of b corresponds to moving |b| entrances in the order of decreasing numbers (in this order entrance 1 is followed by entrance n). If b\xe2\x80\x89=\xe2\x80\x890, then Vasya prefers to walk beside his entrance.  Illustration for n\xe2\x80\x89=\xe2\x80\x896, a\xe2\x80\x89=\xe2\x80\x892, b\xe2\x80\x89=\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x895. Help Vasya to determine the number of the entrance, near which he will be at the end of his walk." 1000

658A "Bear and Reverse Radewoosh" implementation "Limak and Radewoosh are going to compete against each other in the upcoming algorithmic contest. They are equally skilled but they won\'t solve problems in the same order.There will be n problems. The i-th problem has initial score pi and it takes exactly ti minutes to solve it. Problems are sorted by difficulty�\xe2\x80\x94 it\'s guaranteed that pi\xe2\x80\x89<\xe2\x80\x89pi\xe2\x80\x89+\xe2\x80\x891 and ti\xe2\x80\x89<\xe2\x80\x89ti\xe2\x80\x89+\xe2\x80\x891.A constant c is given too, representing the speed of loosing points. Then, submitting the i-th problem at time x (x minutes after the start of the contest) gives max(0,\xe2\x80\x89 pi\xe2\x80\x89-\xe2\x80\x89c\xc2\xb7x) points.Limak is going to solve problems in order 1,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89n (sorted increasingly by pi). Radewoosh is going to solve them in order n,\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x891 (sorted decreasingly by pi). Your task is to predict the outcome�\xe2\x80\x94 print the name of the winner (person who gets more points at the end) or a word ""Tie"" in case of a tie.You may assume that the duration of the competition is greater or equal than the sum of all ti. That means both Limak and Radewoosh will accept all n problems." 800

656G "You\'re a Professional" "*special problem" "Limak and Radewoosh are going to compete against each other in the upcoming algorithmic contest. They are equally skilled but they won\'t solve problems in the same order.There will be n problems. The i-th problem has initial score pi and it takes exactly ti minutes to solve it. Problems are sorted by difficulty�\xe2\x80\x94 it\'s guaranteed that pi\xe2\x80\x89<\xe2\x80\x89pi\xe2\x80\x89+\xe2\x80\x891 and ti\xe2\x80\x89<\xe2\x80\x89ti\xe2\x80\x89+\xe2\x80\x891.A constant c is given too, representing the speed of loosing points. Then, submitting the i-th problem at time x (x minutes after the start of the contest) gives max(0,\xe2\x80\x89 pi\xe2\x80\x89-\xe2\x80\x89c\xc2\xb7x) points.Limak is going to solve problems in order 1,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89n (sorted increasingly by pi). Radewoosh is going to solve them in order n,\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x891 (sorted decreasingly by pi). Your task is to predict the outcome�\xe2\x80\x94 print the name of the winner (person who gets more points at the end) or a word ""Tie"" in case of a tie.You may assume that the duration of the competition is greater or equal than the sum of all ti. That means both Limak and Radewoosh will accept all n problems." 1900

656F "Ace It!" "*special problem" "InputThe only line of the input is a string of 7 characters. The first character is letter A, followed by 6 digits. The input is guaranteed to be valid (for certain definition of ""valid"").OutputOutput a single integer.ExamplesInputCopyA221033OutputCopy21InputCopyA223635OutputCopy22InputCopyA232726OutputCopy23" 1900

656E "Out of Controls" "*special problem" "You are given a complete undirected graph. For each pair of vertices you are given the length of the edge that connects them. Find the shortest paths between each pair of vertices in the graph and return the length of the longest of them." 2000

656D "Rosetta Problem" "*special problem" "++++++++[>+>++>+++>++++>+++++>++++++>+++++++>++++++++>+++++++++>++++++++++>+++++++++++>++++++++++++>+++++++++++++>++++++++++++++>+++++++++++++++>++++++++++++++++<<<<<<<<<<<<<<<<-]>>>>>>>>>>.<<<<<<<<<<>>>>>>>>>>>>>>++.--<<<<<<<<<<<<<<>>>>>>>>>>>>>+.-<<<<<<<<<<<<<>>>>>>>>>>>>>>--.++<<<<<<<<<<<<<<>>>>>>>>>>>>>>>----.++++<<<<<<<<<<<<<<<>>>>.<<<<>>>>>>>>>>>>>>--.++<<<<<<<<<<<<<<>>>>>>>>>>>>>>>---.+++<<<<<<<<<<<<<<<>>>>>>>>>>>>>>---.+++<<<<<<<<<<<<<<>>>>>>>>>>>>++.--<<<<<<<<<<<<>>>>>>>>>>>>>---.+++<<<<<<<<<<<<<>>>>>>>>>>>>>>++.--<<<<<<<<<<<<<<.DCBA:^!~}|{zyxwvutsrqponmlkjihgfedcba`_^]\\[ZYXWVUTSRQPONMLKJIHdcbD`Y^]\\UZYRv9876543210/.-,+*)(\'&%$#""!~}|{zyxwvutsrqponm+*)(\'&%$#cya`=^]\\[ZYXWVUTSRQPONMLKJfe^cba`_X]VzTYRv98TSRQ3ONMLEi,+*)(\'&%$#""!~}|{zyxwvutsrqponmlkjihgfedcba`_^]\\[ZYXWVUTSonPlkjchg`ed]#DCBA@?>=<;:9876543OHGLKDIHGFE>b%$#""!~}|{zyxwvutsrqponmlkjihgfedcba`_^]\\[ZYXWVUTSRQPONMibafedcba`_X|?>Z<XWVUTSRKo\\ v34*8+6+,78+9*3+,93+9*5+,28+9*1+,55+9*4+,23*6*2*,91,@,+7*9*25,*48,+3*9+38,+<>62*9*2+,34*9*3+,66+9*8+,52*9*7+,75+9*8+,92+9*6+,48+9*3+,43*9*2+,84*,26*9*3^" 2100

656C "Without Text" "*special problem" "You can preview the image in better quality by the link: http://assets.codeforces.com/files/656/without-text.png" 2000

656B Scrambled "*special problem,implementation" "Btoh yuo adn yuor roomatme lhoate wianshg disehs, btu stlil sdmoeboy msut peorrfm tihs cohre dialy. Oen dya yuo decdie to idourtcne smoe syestm. Yuor rmmotaoe sstgegus teh fooniwllg dael. Yuo argee on tow arayrs of ientgres M adn R, nmebur upmicnog dyas (induiclng teh cunrret oen) wtih sicsescuve irnegets (teh ceurrnt dya is zreo), adn yuo wsah teh diehss on dya D if adn olny if terhe etsixs an iednx i scuh taht D�mod�M[i]\xe2\x80\x89=\xe2\x80\x89R[i], otwsehrie yuor rmootmae deos it. Yuo lkie teh cncepot, btu yuor rmotaome\'s cuinnng simle meaks yuo ssecupt sthnoemig, so yuo itennd to vefriy teh fnerisas of teh aemnrgeet.Yuo aer geivn ayarrs M adn R. Cuaclatle teh pceanregte of dyas on wchih yuo edn up dnoig teh wisahng. Amsuse taht yuo hvae iiiftlneny mnay dyas aehad of yuo." 1700

656A "Da Vinci Powers" "*special problem" "InputThe input contains a single integer a (0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x8935).OutputOutput a single integer.ExamplesInputCopy3OutputCopy8InputCopy10OutputCopy1024" 1900

653G "Move by Prime" "combinatorics,math,number theory" "Pussycat Sonya has an array consisting of n positive integers. There are 2n possible subsequences of the array. For each subsequence she counts the minimum number of operations to make all its elements equal. Each operation must be one of two:  Choose some element of the subsequence and multiply it by some prime number.  Choose some element of the subsequence and divide it by some prime number. The chosen element must be divisible by the chosen prime number. What is the sum of minimum number of operations for all 2n possible subsequences? Find and print this sum modulo 109\xe2\x80\x89+\xe2\x80\x897." 3100

653F "Paper task" "data structures,string suffix structures,strings" "Alex was programming while Valentina (his toddler daughter) got there and started asking many questions about the round brackets (or parenthesis) in the code. He explained her a bit and when she got it he gave her a task in order to finish his code on time.For the purpose of this problem we consider only strings consisting of opening and closing round brackets, that is characters \'(\' and \')\'.The sequence of brackets is called correct if:   it\'s empty;  it\'s a correct sequence of brackets, enclosed in a pair of opening and closing brackets;  it\'s a concatenation of two correct sequences of brackets. For example, the sequences ""()()"" and ""((()))(())"" are correct, while "")(()"", ""((((("" and ""())"" are not.Alex took a piece of paper, wrote a string s consisting of brackets and asked Valentina to count the number of distinct non-empty substrings of s that are correct sequences of brackets. In other words, her task is to count the number of non-empty correct sequences of brackets that occur in a string s as a substring (don\'t mix up with subsequences).When Valentina finished the task, Alex noticed he doesn\'t know the answer. Help him don\'t loose face in front of Valentina and solve the problem!" 2600

653E "Bear and Forgotten Tree 2" "dfs and similar,dsu,graphs,trees" "A tree is a connected undirected graph consisting of n vertices and n\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x89\xe2\x80\x891 edges. Vertices are numbered 1 through n.Limak is a little polar bear. He once had a tree with n vertices but he lost it. He still remembers something about the lost tree though.You are given m pairs of vertices (a1,\xe2\x80\x89b1),\xe2\x80\x89(a2,\xe2\x80\x89b2),\xe2\x80\x89...,\xe2\x80\x89(am,\xe2\x80\x89bm). Limak remembers that for each i there was no edge between ai and bi. He also remembers that vertex 1 was incident to exactly k edges (its degree was equal to k).Is it possible that Limak remembers everything correctly? Check whether there exists a tree satisfying the given conditions." 2400

653D "Delivery Bears" "binary search,flows,graphs" "Niwel is a little golden bear. As everyone knows, bears live in forests, but Niwel got tired of seeing all the trees so he decided to move to the city.In the city, Niwel took on a job managing bears to deliver goods. The city that he lives in can be represented as a directed graph with n nodes and m edges. Each edge has a weight capacity. A delivery consists of a bear carrying weights with their bear hands on a simple path from node 1 to node n. The total weight that travels across a particular edge must not exceed the weight capacity of that edge.Niwel has exactly x bears. In the interest of fairness, no bear can rest, and the weight that each bear carries must be exactly the same. However, each bear may take different paths if they like.Niwel would like to determine, what is the maximum amount of weight he can deliver (it\'s the sum of weights carried by bears). Find the maximum weight." 2200

653C "Bear and Up-Down" "brute force,implementation" "The life goes up and down, just like nice sequences. Sequence t1,\xe2\x80\x89t2,\xe2\x80\x89...,\xe2\x80\x89tn is called nice if the following two conditions are satisfied:   ti\xe2\x80\x89<\xe2\x80\x89ti\xe2\x80\x89+\xe2\x80\x891 for each odd i\xe2\x80\x89<\xe2\x80\x89n;  ti\xe2\x80\x89>\xe2\x80\x89ti\xe2\x80\x89+\xe2\x80\x891 for each even i\xe2\x80\x89<\xe2\x80\x89n. For example, sequences (2,\xe2\x80\x898), (1,\xe2\x80\x895,\xe2\x80\x891) and (2,\xe2\x80\x895,\xe2\x80\x891,\xe2\x80\x89100,\xe2\x80\x8999,\xe2\x80\x89120) are nice, while (1,\xe2\x80\x891), (1,\xe2\x80\x892,\xe2\x80\x893) and (2,\xe2\x80\x895,\xe2\x80\x893,\xe2\x80\x892) are not.Bear Limak has a sequence of positive integers t1,\xe2\x80\x89t2,\xe2\x80\x89...,\xe2\x80\x89tn. This sequence is not nice now and Limak wants to fix it by a single swap. He is going to choose two indices i\xe2\x80\x89<\xe2\x80\x89j and swap elements ti and tj in order to get a nice sequence. Count the number of ways to do so. Two ways are considered different if indices of elements chosen for a swap are different." 1900

653B "Bear and Compressing" "brute force,dfs and similar,dp,strings" "Limak is a little polar bear. Polar bears hate long strings and thus they like to compress them. You should also know that Limak is so young that he knows only first six letters of the English alphabet: \'a\', \'b\', \'c\', \'d\', \'e\' and \'f\'.You are given a set of q possible operations. Limak can perform them in any order, any operation may be applied any number of times. The i-th operation is described by a string ai of length two and a string bi of length one. No two of q possible operations have the same string ai.When Limak has a string s he can perform the i-th operation on s if the first two letters of s match a two-letter string ai. Performing the i-th operation removes first two letters of s and inserts there a string bi. See the notes section for further clarification.You may note that performing an operation decreases the length of a string s exactly by 1. Also, for some sets of operations there may be a string that cannot be compressed any further, because the first two letters don\'t match any ai.Limak wants to start with a string of length n and perform n\xe2\x80\x89-\xe2\x80\x891 operations to finally get a one-letter string ""a"". In how many ways can he choose the starting string to be able to get ""a""? Remember that Limak can use only letters he knows." 1300

653A "Bear and Three Balls" "brute force,implementation,sortings" "Limak is a little polar bear. He has n balls, the i-th ball has size ti.Limak wants to give one ball to each of his three friends. Giving gifts isn\'t easy�\xe2\x80\x94 there are two rules Limak must obey to make friends happy:  No two friends can get balls of the same size.  No two friends can get balls of sizes that differ by more than 2. For example, Limak can choose balls with sizes 4, 5 and 3, or balls with sizes 90, 91 and 92. But he can\'t choose balls with sizes 5, 5 and 6 (two friends would get balls of the same size), and he can\'t choose balls with sizes 30, 31 and 33 (because sizes 30 and 33 differ by more than 2).Your task is to check whether Limak can choose three balls that satisfy conditions above." 900

652F "Ants on a Circle" "constructive algorithms,math" "n ants are on a circle of length m. An ant travels one unit of distance per one unit of time. Initially, the ant number i is located at the position si and is facing in the direction di (which is either L or R). Positions are numbered in counterclockwise order starting from some point. Positions of the all ants are distinct.All the ants move simultaneously, and whenever two ants touch, they will both switch their directions. Note that it is possible for an ant to move in some direction for a half of a unit of time and in opposite direction for another half of a unit of time.Print the positions of the ants after t time units." 2800

652E "Pursuit For Artifacts" "dfs and similar,dsu,graphs,trees" "Johnny is playing a well-known computer game. The game are in some country, where the player can freely travel, pass quests and gain an experience.In that country there are n islands and m bridges between them, so you can travel from any island to any other. In the middle of some bridges are lying ancient powerful artifacts. Johnny is not interested in artifacts, but he can get some money by selling some artifact.At the start Johnny is in the island a and the artifact-dealer is in the island b (possibly they are on the same island). Johnny wants to find some artifact, come to the dealer and sell it. The only difficulty is that bridges are too old and destroying right after passing over them. Johnnie\'s character can\'t swim, fly and teleport, so the problem became too difficult.Note that Johnny can\'t pass the half of the bridge, collect the artifact and return to the same island. Determine if Johnny can find some artifact and sell it." 2300

652D "Nested Segments" "data structures,sortings" "You are given n segments on a line. There are no ends of some segments that coincide. For each segment find the number of segments it contains." 1800

652C "Foe Pairs" "combinatorics,sortings,two pointers" "You are given a permutation p of length n. Also you are given m foe pairs (ai,\xe2\x80\x89bi) (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ai,\xe2\x80\x89bi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n,\xe2\x80\x89ai\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89bi). Your task is to count the number of different intervals (x,\xe2\x80\x89y) (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) that do not contain any foe pairs. So you shouldn\'t count intervals (x,\xe2\x80\x89y) that contain at least one foe pair in it (the positions and order of the values from the foe pair are not important).Consider some example: p\xe2\x80\x89=\xe2\x80\x89[1,\xe2\x80\x893,\xe2\x80\x892,\xe2\x80\x894] and foe pairs are {(3,\xe2\x80\x892),\xe2\x80\x89(4,\xe2\x80\x892)}. The interval (1,\xe2\x80\x893) is incorrect because it contains a foe pair (3,\xe2\x80\x892). The interval (1,\xe2\x80\x894) is also incorrect because it contains two foe pairs (3,\xe2\x80\x892) and (4,\xe2\x80\x892). But the interval (1,\xe2\x80\x892) is correct because it doesn\'t contain any foe pair." 1800

652B z-sort sortings "A student of z-school found a kind of sorting called z-sort. The array a with n elements are z-sorted if two conditions hold:  ai\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89ai\xe2\x80\x89-\xe2\x80\x891 for all even i,  ai\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ai\xe2\x80\x89-\xe2\x80\x891 for all odd i\xe2\x80\x89>\xe2\x80\x891. For example the arrays [1,2,1,2] and [1,1,1,1] are z-sorted while the array [1,2,3,4] isn\xe2\x80\x99t z-sorted.Can you make the array z-sorted?" 1000

652A "Gabriel and Caterpillar" implementation,math "The 9-th grade student Gabriel noticed a caterpillar on a tree when walking around in a forest after the classes. The caterpillar was on the height h1 cm from the ground. On the height h2 cm (h2\xe2\x80\x89>\xe2\x80\x89h1) on the same tree hung an apple and the caterpillar was crawling to the apple.Gabriel is interested when the caterpillar gets the apple. He noted that the caterpillar goes up by a cm per hour by day and slips down by b cm per hour by night.In how many days Gabriel should return to the forest to see the caterpillar get the apple. You can consider that the day starts at 10 am and finishes at 10 pm. Gabriel\'s classes finish at 2 pm. You can consider that Gabriel noticed the caterpillar just after the classes at 2 pm.Note that the forest is magic so the caterpillar can slip down under the ground and then lift to the apple." 1400

651B "Beautiful Paintings" greedy,sortings "There are n pictures delivered for the new exhibition. The i-th painting has beauty ai. We know that a visitor becomes happy every time he passes from a painting to a more beautiful one.We are allowed to arranged pictures in any order. What is the maximum possible number of times the visitor may become happy while passing all pictures from first to last? In other words, we are allowed to rearrange elements of a in any order. What is the maximum possible number of indices i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x891), such that ai\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89>\xe2\x80\x89ai." 1200

651A Joysticks dp,greedy,implementation,math "Friends are going to play console. They have two joysticks and only one charger for them. Initially first joystick is charged at a1 percent and second one is charged at a2 percent. You can connect charger to a joystick only at the beginning of each minute. In one minute joystick either discharges by 2 percent (if not connected to a charger) or charges by 1 percent (if connected to a charger).Game continues while both joysticks have a positive charge. Hence, if at the beginning of minute some joystick is charged by 1 percent, it has to be connected to a charger, otherwise the game stops. If some joystick completely discharges (its charge turns to 0), the game also stops.Determine the maximum number of minutes that game can last. It is prohibited to pause the game, i. e. at each moment both joysticks should be enabled. It is allowed for joystick to be charged by more than 100 percent." 1100

650E "Clockwork Bomb" "data structures,dfs and similar,dsu,greedy,trees" "My name is James diGriz, I\'m the most clever robber and treasure hunter in the whole galaxy. There are books written about my adventures and songs about my operations, though you were able to catch me up in a pretty awkward moment.I was able to hide from cameras, outsmart all the guards and pass numerous traps, but when I finally reached the treasure box and opened it, I have accidentally started the clockwork bomb! Luckily, I have met such kind of bombs before and I know that the clockwork mechanism can be stopped by connecting contacts with wires on the control panel of the bomb in a certain manner.I see n contacts connected by n\xe2\x80\x89-\xe2\x80\x891 wires. Contacts are numbered with integers from 1 to n. Bomb has a security mechanism that ensures the following condition: if there exist k\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x892 contacts c1,\xe2\x80\x89c2,\xe2\x80\x89...,\xe2\x80\x89ck forming a circuit, i. e. there exist k distinct wires between contacts c1 and c2, c2 and c3, ..., ck and c1, then the bomb immediately explodes and my story ends here. In particular, if two contacts are connected by more than one wire they form a circuit of length 2. It is also prohibited to connect a contact with itself.On the other hand, if I disconnect more than one wire (i. e. at some moment there will be no more than n\xe2\x80\x89-\xe2\x80\x892 wires in the scheme) then the other security check fails and the bomb also explodes. So, the only thing I can do is to unplug some wire and plug it into a new place ensuring the fact that no circuits appear.I know how I should put the wires in order to stop the clockwork. But my time is running out! Help me get out of this alive: find the sequence of operations each of which consists of unplugging some wire and putting it into another place so that the bomb is defused." 3200

650D Zip-line "binary search,data structures,dp,hashing" "Vasya has decided to build a zip-line on trees of a nearby forest. He wants the line to be as long as possible but he doesn\'t remember exactly the heights of all trees in the forest. He is sure that he remembers correct heights of all trees except, possibly, one of them.It is known that the forest consists of n trees staying in a row numbered from left to right with integers from 1 to n. According to Vasya, the height of the i-th tree is equal to hi. The zip-line of length k should hang over k (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) trees i1,\xe2\x80\x89i2,\xe2\x80\x89...,\xe2\x80\x89ik (i1\xe2\x80\x89<\xe2\x80\x89i2\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89ik) such that their heights form an increasing sequence, that is hi1\xe2\x80\x89<\xe2\x80\x89hi2\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89hik.Petya had been in this forest together with Vasya, and he now has q assumptions about the mistake in Vasya\'s sequence h. His i-th assumption consists of two integers ai and bi indicating that, according to Petya, the height of the tree numbered ai is actually equal to bi. Note that Petya\'s assumptions are independent from each other.Your task is to find the maximum length of a zip-line that can be built over the trees under each of the q assumptions.In this problem the length of a zip line is considered equal to the number of trees that form this zip-line." 2600

650C "Table Compression" "dfs and similar,dp,dsu,graphs,greedy" "Little Petya is now fond of data compression algorithms. He has already studied gz, bz, zip algorithms and many others. Inspired by the new knowledge, Petya is now developing the new compression algorithm which he wants to name dis.Petya decided to compress tables. He is given a table a consisting of n rows and m columns that is filled with positive integers. He wants to build the table a\' consisting of positive integers such that the relative order of the elements in each row and each column remains the same. That is, if in some row i of the initial table ai,\xe2\x80\x89j\xe2\x80\x89<\xe2\x80\x89ai,\xe2\x80\x89k, then in the resulting table a\'i,\xe2\x80\x89j\xe2\x80\x89<\xe2\x80\x89a\'i,\xe2\x80\x89k, and if ai,\xe2\x80\x89j\xe2\x80\x89=\xe2\x80\x89ai,\xe2\x80\x89k then a\'i,\xe2\x80\x89j\xe2\x80\x89=\xe2\x80\x89a\'i,\xe2\x80\x89k. Similarly, if in some column j of the initial table ai,\xe2\x80\x89j\xe2\x80\x89<\xe2\x80\x89ap,\xe2\x80\x89j then in compressed table a\'i,\xe2\x80\x89j\xe2\x80\x89<\xe2\x80\x89a\'p,\xe2\x80\x89j and if ai,\xe2\x80\x89j\xe2\x80\x89=\xe2\x80\x89ap,\xe2\x80\x89j then a\'i,\xe2\x80\x89j\xe2\x80\x89=\xe2\x80\x89a\'p,\xe2\x80\x89j. Because large values require more space to store them, the maximum value in a\' should be as small as possible.Petya is good in theory, however, he needs your help to implement the algorithm." 2200

650B "Image Preview" "binary search,brute force,dp,two pointers" "Vasya\'s telephone contains n photos. Photo number 1 is currently opened on the phone. It is allowed to move left and right to the adjacent photo by swiping finger over the screen. If you swipe left from the first photo, you reach photo n. Similarly, by swiping right from the last photo you reach photo 1. It takes a seconds to swipe from photo to adjacent.For each photo it is known which orientation is intended for it \xe2\x80\x94 horizontal or vertical. Phone is in the vertical orientation and can\'t be rotated. It takes b second to change orientation of the photo.Vasya has T seconds to watch photos. He want to watch as many photos as possible. If Vasya opens the photo for the first time, he spends 1 second to notice all details in it. If photo is in the wrong orientation, he spends b seconds on rotating it before watching it. If Vasya has already opened the photo, he just skips it (so he doesn\'t spend any time for watching it or for changing its orientation). It is not allowed to skip unseen photos.Help Vasya find the maximum number of photos he is able to watch during T seconds." 1900

650A Watchmen "data structures,geometry,math" "Watchmen are in a danger and Doctor Manhattan together with his friend Daniel Dreiberg should warn them as soon as possible. There are n watchmen on a plane, the i-th watchman is located at point (xi,\xe2\x80\x89yi).They need to arrange a plan, but there are some difficulties on their way. As you know, Doctor Manhattan considers the distance between watchmen i and j to be |xi\xe2\x80\x89-\xe2\x80\x89xj|\xe2\x80\x89+\xe2\x80\x89|yi\xe2\x80\x89-\xe2\x80\x89yj|. Daniel, as an ordinary person, calculates the distance using the formula .The success of the operation relies on the number of pairs (i,\xe2\x80\x89j) (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n), such that the distance between watchman i and watchmen j calculated by Doctor Manhattan is equal to the distance between them calculated by Daniel. You were asked to compute the number of such pairs." 1400

649E \xd0\x90\xd0\xb2\xd1\x82\xd0\xbe\xd0\xb1\xd1\x83\xd1\x81 "binary search,data structures,greedy,sortings" "Watchmen are in a danger and Doctor Manhattan together with his friend Daniel Dreiberg should warn them as soon as possible. There are n watchmen on a plane, the i-th watchman is located at point (xi,\xe2\x80\x89yi).They need to arrange a plan, but there are some difficulties on their way. As you know, Doctor Manhattan considers the distance between watchmen i and j to be |xi\xe2\x80\x89-\xe2\x80\x89xj|\xe2\x80\x89+\xe2\x80\x89|yi\xe2\x80\x89-\xe2\x80\x89yj|. Daniel, as an ordinary person, calculates the distance using the formula .The success of the operation relies on the number of pairs (i,\xe2\x80\x89j) (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n), such that the distance between watchman i and watchmen j calculated by Doctor Manhattan is equal to the distance between them calculated by Daniel. You were asked to compute the number of such pairs." 2100

649D "\xd0\x94\xd0\xb5\xd1\x84\xd1\x80\xd0\xb0\xd0\xb3\xd0\xbc\xd0\xb5\xd0\xbd\xd1\x82\xd0\xb0\xd1\x86\xd0\xb8\xd1\x8f \xd0\xbf\xd0\xb0\xd0\xbc\xd1\x8f\xd1\x82\xd0\xb8" "constructive algorithms,greedy,implementation" "Watchmen are in a danger and Doctor Manhattan together with his friend Daniel Dreiberg should warn them as soon as possible. There are n watchmen on a plane, the i-th watchman is located at point (xi,\xe2\x80\x89yi).They need to arrange a plan, but there are some difficulties on their way. As you know, Doctor Manhattan considers the distance between watchmen i and j to be |xi\xe2\x80\x89-\xe2\x80\x89xj|\xe2\x80\x89+\xe2\x80\x89|yi\xe2\x80\x89-\xe2\x80\x89yj|. Daniel, as an ordinary person, calculates the distance using the formula .The success of the operation relies on the number of pairs (i,\xe2\x80\x89j) (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n), such that the distance between watchman i and watchmen j calculated by Doctor Manhattan is equal to the distance between them calculated by Daniel. You were asked to compute the number of such pairs." 1600

649C "\xd0\x9f\xd0\xb5\xd1\x87\xd0\xb0\xd1\x82\xd1\x8c \xd1\x83\xd1\x81\xd0\xbb\xd0\xbe\xd0\xb2\xd0\xb8\xd0\xb9" "constructive algorithms,greedy,sortings" "Watchmen are in a danger and Doctor Manhattan together with his friend Daniel Dreiberg should warn them as soon as possible. There are n watchmen on a plane, the i-th watchman is located at point (xi,\xe2\x80\x89yi).They need to arrange a plan, but there are some difficulties on their way. As you know, Doctor Manhattan considers the distance between watchmen i and j to be |xi\xe2\x80\x89-\xe2\x80\x89xj|\xe2\x80\x89+\xe2\x80\x89|yi\xe2\x80\x89-\xe2\x80\x89yj|. Daniel, as an ordinary person, calculates the distance using the formula .The success of the operation relies on the number of pairs (i,\xe2\x80\x89j) (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n), such that the distance between watchman i and watchmen j calculated by Doctor Manhattan is equal to the distance between them calculated by Daniel. You were asked to compute the number of such pairs." 1500

649B \xd0\xad\xd1\x82\xd0\xb0\xd0\xb6\xd0\xb8 "constructive algorithms" "Watchmen are in a danger and Doctor Manhattan together with his friend Daniel Dreiberg should warn them as soon as possible. There are n watchmen on a plane, the i-th watchman is located at point (xi,\xe2\x80\x89yi).They need to arrange a plan, but there are some difficulties on their way. As you know, Doctor Manhattan considers the distance between watchmen i and j to be |xi\xe2\x80\x89-\xe2\x80\x89xj|\xe2\x80\x89+\xe2\x80\x89|yi\xe2\x80\x89-\xe2\x80\x89yj|. Daniel, as an ordinary person, calculates the distance using the formula .The success of the operation relies on the number of pairs (i,\xe2\x80\x89j) (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n), such that the distance between watchman i and watchmen j calculated by Doctor Manhattan is equal to the distance between them calculated by Daniel. You were asked to compute the number of such pairs." 1400

649A "\xd0\x9b\xd1\x8e\xd0\xb1\xd0\xb8\xd0\xbc\xd1\x8b\xd0\xb5 \xd1\x87\xd0\xb8\xd1\x81\xd0\xbb\xd0\xb0 \xd0\x9f\xd0\xbe\xd0\xbb\xd0\xb8\xd0\xba\xd0\xb0\xd1\x80\xd0\xbf\xd0\xb0" "constructive algorithms,implementation" "Watchmen are in a danger and Doctor Manhattan together with his friend Daniel Dreiberg should warn them as soon as possible. There are n watchmen on a plane, the i-th watchman is located at point (xi,\xe2\x80\x89yi).They need to arrange a plan, but there are some difficulties on their way. As you know, Doctor Manhattan considers the distance between watchmen i and j to be |xi\xe2\x80\x89-\xe2\x80\x89xj|\xe2\x80\x89+\xe2\x80\x89|yi\xe2\x80\x89-\xe2\x80\x89yj|. Daniel, as an ordinary person, calculates the distance using the formula .The success of the operation relies on the number of pairs (i,\xe2\x80\x89j) (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n), such that the distance between watchman i and watchmen j calculated by Doctor Manhattan is equal to the distance between them calculated by Daniel. You were asked to compute the number of such pairs." 1000

648E "\xd0\xa1\xd0\xbe\xd0\xb1\xd0\xb5\xd1\x80\xd0\xb8 \xd1\x87\xd0\xb8\xd1\x81\xd0\xbb\xd0\xbe" "graphs,shortest paths" "Watchmen are in a danger and Doctor Manhattan together with his friend Daniel Dreiberg should warn them as soon as possible. There are n watchmen on a plane, the i-th watchman is located at point (xi,\xe2\x80\x89yi).They need to arrange a plan, but there are some difficulties on their way. As you know, Doctor Manhattan considers the distance between watchmen i and j to be |xi\xe2\x80\x89-\xe2\x80\x89xj|\xe2\x80\x89+\xe2\x80\x89|yi\xe2\x80\x89-\xe2\x80\x89yj|. Daniel, as an ordinary person, calculates the distance using the formula .The success of the operation relies on the number of pairs (i,\xe2\x80\x89j) (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n), such that the distance between watchman i and watchmen j calculated by Doctor Manhattan is equal to the distance between them calculated by Daniel. You were asked to compute the number of such pairs." 2300

648D "\xd0\xa1\xd0\xbe\xd0\xb1\xd0\xb0\xd1\x87\xd0\xba\xd0\xb8 \xd0\xb8 \xd0\xbc\xd0\xb8\xd1\x81\xd0\xba\xd0\xb8" "data structures,greedy,sortings" "Watchmen are in a danger and Doctor Manhattan together with his friend Daniel Dreiberg should warn them as soon as possible. There are n watchmen on a plane, the i-th watchman is located at point (xi,\xe2\x80\x89yi).They need to arrange a plan, but there are some difficulties on their way. As you know, Doctor Manhattan considers the distance between watchmen i and j to be |xi\xe2\x80\x89-\xe2\x80\x89xj|\xe2\x80\x89+\xe2\x80\x89|yi\xe2\x80\x89-\xe2\x80\x89yj|. Daniel, as an ordinary person, calculates the distance using the formula .The success of the operation relies on the number of pairs (i,\xe2\x80\x89j) (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n), such that the distance between watchman i and watchmen j calculated by Doctor Manhattan is equal to the distance between them calculated by Daniel. You were asked to compute the number of such pairs." 1900

648C "\xd0\x9f\xd1\x83\xd1\x82\xd1\x8c \xd0\xa0\xd0\xbe\xd0\xb1\xd0\xbe\xd1\x82\xd0\xb0" "constructive algorithms,dfs and similar,graphs" "Watchmen are in a danger and Doctor Manhattan together with his friend Daniel Dreiberg should warn them as soon as possible. There are n watchmen on a plane, the i-th watchman is located at point (xi,\xe2\x80\x89yi).They need to arrange a plan, but there are some difficulties on their way. As you know, Doctor Manhattan considers the distance between watchmen i and j to be |xi\xe2\x80\x89-\xe2\x80\x89xj|\xe2\x80\x89+\xe2\x80\x89|yi\xe2\x80\x89-\xe2\x80\x89yj|. Daniel, as an ordinary person, calculates the distance using the formula .The success of the operation relies on the number of pairs (i,\xe2\x80\x89j) (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n), such that the distance between watchman i and watchmen j calculated by Doctor Manhattan is equal to the distance between them calculated by Daniel. You were asked to compute the number of such pairs." 1100

648B "\xd0\xa1\xd0\xbe\xd0\xb1\xd0\xb5\xd1\x80\xd0\xb8 \xd1\x81\xd1\x82\xd0\xbe\xd0\xbb" "constructive algorithms,sortings" "Watchmen are in a danger and Doctor Manhattan together with his friend Daniel Dreiberg should warn them as soon as possible. There are n watchmen on a plane, the i-th watchman is located at point (xi,\xe2\x80\x89yi).They need to arrange a plan, but there are some difficulties on their way. As you know, Doctor Manhattan considers the distance between watchmen i and j to be |xi\xe2\x80\x89-\xe2\x80\x89xj|\xe2\x80\x89+\xe2\x80\x89|yi\xe2\x80\x89-\xe2\x80\x89yj|. Daniel, as an ordinary person, calculates the distance using the formula .The success of the operation relies on the number of pairs (i,\xe2\x80\x89j) (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n), such that the distance between watchman i and watchmen j calculated by Doctor Manhattan is equal to the distance between them calculated by Daniel. You were asked to compute the number of such pairs." 800

648A "\xd0\x9d\xd0\xb0\xd0\xb8\xd0\xb1\xd0\xbe\xd0\xbb\xd1\x8c\xd1\x88\xd0\xb8\xd0\xb9 \xd0\xbf\xd0\xbe\xd0\xb4\xd1\x8a\xd0\xb5\xd0\xbc" "constructive algorithms,implementation" "Watchmen are in a danger and Doctor Manhattan together with his friend Daniel Dreiberg should warn them as soon as possible. There are n watchmen on a plane, the i-th watchman is located at point (xi,\xe2\x80\x89yi).They need to arrange a plan, but there are some difficulties on their way. As you know, Doctor Manhattan considers the distance between watchmen i and j to be |xi\xe2\x80\x89-\xe2\x80\x89xj|\xe2\x80\x89+\xe2\x80\x89|yi\xe2\x80\x89-\xe2\x80\x89yj|. Daniel, as an ordinary person, calculates the distance using the formula .The success of the operation relies on the number of pairs (i,\xe2\x80\x89j) (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n), such that the distance between watchman i and watchmen j calculated by Doctor Manhattan is equal to the distance between them calculated by Daniel. You were asked to compute the number of such pairs." 900

645G "Armistice Area Apportionment" "binary search,geometry" "After a drawn-out mooclear arms race, Farmer John and the Mischievous Mess Makers have finally agreed to establish peace. They plan to divide the territory of Bovinia with a line passing through at least two of the n outposts scattered throughout the land. These outposts, remnants of the conflict, are located at the points (x1,\xe2\x80\x89y1),\xe2\x80\x89(x2,\xe2\x80\x89y2),\xe2\x80\x89...,\xe2\x80\x89(xn,\xe2\x80\x89yn).In order to find the optimal dividing line, Farmer John and Elsie have plotted a map of Bovinia on the coordinate plane. Farmer John\'s farm and the Mischievous Mess Makers\' base are located at the points P\xe2\x80\x89=\xe2\x80\x89(a,\xe2\x80\x890) and Q\xe2\x80\x89=\xe2\x80\x89(\xe2\x80\x89-\xe2\x80\x89a,\xe2\x80\x890), respectively. Because they seek a lasting peace, Farmer John and Elsie would like to minimize the maximum difference between the distances from any point on the line to P and Q.Formally, define the difference of a line  relative to two points P and Q as the smallest real number d so that for all points X on line , |PX\xe2\x80\x89-\xe2\x80\x89QX|\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89d. (It is guaranteed that d exists and is unique.) They wish to find the line  passing through two distinct outposts (xi,\xe2\x80\x89yi) and (xj,\xe2\x80\x89yj) such that the difference of  relative to P and Q is minimized." 3200

645F "Cowslip Collections" "combinatorics,math,number theory" "In an attempt to make peace with the Mischievious Mess Makers, Bessie and Farmer John are planning to plant some flower gardens to complement the lush, grassy fields of Bovinia. As any good horticulturist knows, each garden they plant must have the exact same arrangement of flowers. Initially, Farmer John has n different species of flowers he can plant, with ai flowers of the i-th species.On each of the next q days, Farmer John will receive a batch of flowers of a new species. On day j, he will receive cj flowers of the same species, but of a different species from those Farmer John already has. Farmer John, knowing the right balance between extravagance and minimalism, wants exactly k species of flowers to be used. Furthermore, to reduce waste, each flower of the k species Farmer John chooses must be planted in some garden. And each of the gardens must be identical; that is to say that each of the k chosen species should have an equal number of flowers in each garden. As Farmer John is a proponent of national equality, he would like to create the greatest number of gardens possible.After receiving flowers on each of these q days, Farmer John would like to know the sum, over all possible choices of k species, of the maximum number of gardens he could create. Since this could be a large number, you should output your result modulo 109\xe2\x80\x89+\xe2\x80\x897." 2500

645E "Intellectual Inquiry" dp,greedy,strings "After getting kicked out of her reporting job for not knowing the alphabet, Bessie has decided to attend school at the Fillet and Eggs Eater Academy. She has been making good progress with her studies and now knows the first k English letters.Each morning, Bessie travels to school along a sidewalk consisting of m\xe2\x80\x89+\xe2\x80\x89n tiles. In order to help Bessie review, Mr. Moozing has labeled each of the first m sidewalk tiles with one of the first k lowercase English letters, spelling out a string t. Mr. Moozing, impressed by Bessie\'s extensive knowledge of farm animals, plans to let her finish labeling the last n tiles of the sidewalk by herself.Consider the resulting string s (|s|\xe2\x80\x89=\xe2\x80\x89m\xe2\x80\x89+\xe2\x80\x89n) consisting of letters labeled on tiles in order from home to school. For any sequence of indices p1\xe2\x80\x89<\xe2\x80\x89p2\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89pq we can define subsequence of the string s as string sp1sp2... spq. Two subsequences are considered to be distinct if they differ as strings. Bessie wants to label the remaining part of the sidewalk such that the number of distinct subsequences of tiles is maximum possible. However, since Bessie hasn\'t even finished learning the alphabet, she needs your help!Note that empty subsequence also counts." 2200

645D "Robot Rapping Results Report" "binary search,dp,graphs" "While Farmer John rebuilds his farm in an unfamiliar portion of Bovinia, Bessie is out trying some alternative jobs. In her new gig as a reporter, Bessie needs to know about programming competition results as quickly as possible. When she covers the 2016 Robot Rap Battle Tournament, she notices that all of the robots operate under deterministic algorithms. In particular, robot i will beat robot j if and only if robot i has a higher skill level than robot j. And if robot i beats robot j and robot j beats robot k, then robot i will beat robot k. Since rapping is such a subtle art, two robots can never have the same skill level.Given the results of the rap battles in the order in which they were played, determine the minimum number of first rap battles that needed to take place before Bessie could order all of the robots by skill level." 1800

645C "Enduring Exodus" "binary search,two pointers" "In an attempt to escape the Mischievous Mess Makers\' antics, Farmer John has abandoned his farm and is traveling to the other side of Bovinia. During the journey, he and his k cows have decided to stay at the luxurious Grand Moo-dapest Hotel. The hotel consists of n rooms located in a row, some of which are occupied.Farmer John wants to book a set of k\xe2\x80\x89+\xe2\x80\x891 currently unoccupied rooms for him and his cows. He wants his cows to stay as safe as possible, so he wishes to minimize the maximum distance from his room to the room of his cow. The distance between rooms i and j is defined as |j\xe2\x80\x89-\xe2\x80\x89i|. Help Farmer John protect his cows by calculating this minimum possible distance." 1600

645B "Mischievous Mess Makers" greedy,math "It is a balmy spring afternoon, and Farmer John\'s n cows are ruminating about link-cut cacti in their stalls. The cows, labeled 1 through n, are arranged so that the i-th cow occupies the i-th stall from the left. However, Elsie, after realizing that she will forever live in the shadows beyond Bessie\'s limelight, has formed the Mischievous Mess Makers and is plotting to disrupt this beautiful pastoral rhythm. While Farmer John takes his k minute long nap, Elsie and the Mess Makers plan to repeatedly choose two distinct stalls and swap the cows occupying those stalls, making no more than one swap each minute.Being the meticulous pranksters that they are, the Mischievous Mess Makers would like to know the maximum messiness attainable in the k minutes that they have. We denote as pi the label of the cow in the i-th stall. The messiness of an arrangement of cows is defined as the number of pairs (i,\xe2\x80\x89j) such that i\xe2\x80\x89<\xe2\x80\x89j and pi\xe2\x80\x89>\xe2\x80\x89pj." 1200

645A "Amity Assessment" "brute force,constructive algorithms,implementation" "Bessie the cow and her best friend Elsie each received a sliding puzzle on Pi Day. Their puzzles consist of a 2\xe2\x80\x89\xc3\x97\xe2\x80\x892 grid and three tiles labeled \'A\', \'B\', and \'C\'. The three tiles sit on top of the grid, leaving one grid cell empty. To make a move, Bessie or Elsie can slide a tile adjacent to the empty cell into the empty cell as shown below:  In order to determine if they are truly Best Friends For Life (BFFLs), Bessie and Elsie would like to know if there exists a sequence of moves that takes their puzzles to the same configuration (moves can be performed in both puzzles). Two puzzles are considered to be in the same configuration if each tile is on top of the same grid cell in both puzzles. Since the tiles are labeled with letters, rotations and reflections are not allowed." 1200

644C "Hostname Aliases" "*special problem,binary search,data structures,implementation,sortings,strings" "There are some websites that are accessible through several different addresses. For example, for a long time Codeforces was accessible with two hostnames codeforces.com and codeforces.ru.You are given a list of page addresses being queried. For simplicity we consider all addresses to have the form http://<hostname>[/<path>], where:  <hostname>�\xe2\x80\x94 server name (consists of words and maybe some dots separating them),  /<path>�\xe2\x80\x94 optional part, where <path> consists of words separated by slashes. We consider two <hostname> to correspond to one website if for each query to the first <hostname> there will be exactly the same query to the second one and vice versa�\xe2\x80\x94 for each query to the second <hostname> there will be the same query to the first one. Take a look at the samples for further clarifications.Your goal is to determine the groups of server names that correspond to one website. Ignore groups consisting of the only server name.Please note, that according to the above definition queries http://<hostname> and http://<hostname>/ are different." 2100

644B "Processing Queries" "*special problem,constructive algorithms,data structures,two pointers" "In this problem you have to simulate the workflow of one-thread server. There are n queries to process, the i-th will be received at moment ti and needs to be processed for di units of time. All ti are guaranteed to be distinct.When a query appears server may react in three possible ways:   If server is free and query queue is empty, then server immediately starts to process this query.  If server is busy and there are less than b queries in the queue, then new query is added to the end of the queue.  If server is busy and there are already b queries pending in the queue, then new query is just rejected and will never be processed. As soon as server finished to process some query, it picks new one from the queue (if it\'s not empty, of course). If a new query comes at some moment x, and the server finishes to process another query at exactly the same moment, we consider that first query is picked from the queue and only then new query appears.For each query find the moment when the server will finish to process it or print -1 if this query will be rejected." 1700

644A "Parliament of Berland" "*special problem,constructive algorithms" "There are n parliamentarians in Berland. They are numbered with integers from 1 to n. It happened that all parliamentarians with odd indices are Democrats and all parliamentarians with even indices are Republicans.New parliament assembly hall is a rectangle consisting of a\xe2\x80\x89\xc3\x97\xe2\x80\x89b chairs�\xe2\x80\x94 a rows of b chairs each. Two chairs are considered neighbouring if they share as side. For example, chair number 5 in row number 2 is neighbouring to chairs number 4 and 6 in this row and chairs with number 5 in rows 1 and 3. Thus, chairs have four neighbours in general, except for the chairs on the border of the hallWe know that if two parliamentarians from one political party (that is two Democrats or two Republicans) seat nearby they spent all time discussing internal party issues.Write the program that given the number of parliamentarians and the sizes of the hall determine if there is a way to find a seat for any parliamentarian, such that no two members of the same party share neighbouring seats." 1000

643G "Choosing Ads" "data structures" "One social network developer recently suggested a new algorithm of choosing ads for users.There are n slots which advertisers can buy. It is possible to buy a segment of consecutive slots at once. The more slots you own, the bigger are the chances your ad will be shown to users.Every time it is needed to choose ads to show, some segment of slots is picked by a secret algorithm. Then some advertisers are chosen. The only restriction is that it should be guaranteed for advertisers which own at least p% of slots composing this segment that their ad will be shown.From the other side, users don\'t like ads. So it was decided to show no more than  ads at once. You are asked to develop a system to sell segments of slots and choose ads in accordance with the rules described above." 3200

643F "Bears and Juice" dp,math,meet-in-the-middle "There are n bears in the inn and p places to sleep. Bears will party together for some number of nights (and days).Bears love drinking juice. They don\'t like wine but they can\'t distinguish it from juice by taste or smell.A bear doesn\'t sleep unless he drinks wine. A bear must go to sleep a few hours after drinking a wine. He will wake up many days after the party is over.Radewoosh is the owner of the inn. He wants to put some number of barrels in front of bears. One barrel will contain wine and all other ones will contain juice. Radewoosh will challenge bears to find a barrel with wine.Each night, the following happens in this exact order:  Each bear must choose a (maybe empty) set of barrels. The same barrel may be chosen by many bears.  Each bear drinks a glass from each barrel he chose.  All bears who drink wine go to sleep (exactly those bears who chose a barrel with wine). They will wake up many days after the party is over. If there are not enough places to sleep then bears lose immediately. At the end, if it\'s sure where wine is and there is at least one awake bear then bears win (unless they have lost before because of the number of places to sleep).Radewoosh wants to allow bears to win. He considers q scenarios. In the i-th scenario the party will last for i nights. Then, let Ri denote the maximum number of barrels for which bears surely win if they behave optimally. Let\'s define . Your task is to find , where  denotes the exclusive or (also denoted as XOR).Note that the same barrel may be chosen by many bears and all of them will go to sleep at once." 2900

643E "Bear and Destroying Subtrees" dp,math,probabilities,trees "Limak is a little grizzly bear. He will once attack Deerland but now he can only destroy trees in role-playing games. Limak starts with a tree with one vertex. The only vertex has index 1 and is a root of the tree.Sometimes, a game chooses a subtree and allows Limak to attack it. When a subtree is attacked then each of its edges is destroyed with probability , independently of other edges. Then, Limak gets the penalty�\xe2\x80\x94 an integer equal to the height of the subtree after the attack. The height is defined as the maximum number of edges on the path between the root of the subtree and any vertex in the subtree.You must handle queries of two types.  1 v denotes a query of the first type. A new vertex appears and its parent is v. A new vertex has the next available index (so, new vertices will be numbered 2,\xe2\x80\x893,\xe2\x80\x89...).  2 v denotes a query of the second type. For a moment let\'s assume that the game allows Limak to attack a subtree rooted in v. Then, what would be the expected value of the penalty Limak gets after the attack? In a query of the second type, Limak doesn\'t actually attack the subtree and thus the query doesn\'t affect next queries." 2700

643D "Bearish Fanpages" NA "There is a social website with n fanpages, numbered 1 through n. There are also n companies, and the i-th company owns the i-th fanpage.Recently, the website created a feature called following. Each fanpage must choose exactly one other fanpage to follow.The website doesn\xe2\x80\x99t allow a situation where i follows j and at the same time j follows i. Also, a fanpage can\'t follow itself.Let\xe2\x80\x99s say that fanpage i follows some other fanpage j0. Also, let\xe2\x80\x99s say that i is followed by k other fanpages j1,\xe2\x80\x89j2,\xe2\x80\x89...,\xe2\x80\x89jk. Then, when people visit fanpage i they see ads from k\xe2\x80\x89+\xe2\x80\x892 distinct companies: i,\xe2\x80\x89j0,\xe2\x80\x89j1,\xe2\x80\x89...,\xe2\x80\x89jk. Exactly ti people subscribe (like) the i-th fanpage, and each of them will click exactly one add. For each of k\xe2\x80\x89+\xe2\x80\x891 companies j0,\xe2\x80\x89j1,\xe2\x80\x89...,\xe2\x80\x89jk, exactly  people will click their ad. Remaining  people will click an ad from company i (the owner of the fanpage).The total income of the company is equal to the number of people who click ads from this copmany.Limak and Radewoosh ask you for help. Initially, fanpage i follows fanpage fi. Your task is to handle q queries of three types:  1 i j�\xe2\x80\x94 fanpage i follows fanpage j from now. It\'s guaranteed that i didn\'t follow j just before the query. Note an extra constraint for the number of queries of this type (below, in the Input section).  2 i�\xe2\x80\x94 print the total income of the i-th company.  3�\xe2\x80\x94 print two integers: the smallest income of one company and the biggest income of one company." 2900

643C "Levels and Regions" dp "Radewoosh is playing a computer game. There are n levels, numbered 1 through n. Levels are divided into k regions (groups). Each region contains some positive number of consecutive levels.The game repeats the the following process: If all regions are beaten then the game ends immediately. Otherwise, the system finds the first region with at least one non-beaten level. Let X denote this region. The system creates an empty bag for tokens. Each token will represent one level and there may be many tokens representing the same level.  For each already beaten level i in the region X, the system adds ti tokens to the bag (tokens representing the i-th level).  Let j denote the first non-beaten level in the region X. The system adds tj tokens to the bag.  Finally, the system takes a uniformly random token from the bag and a player starts the level represented by the token. A player spends one hour and beats the level, even if he has already beaten it in the past. Given n, k and values t1,\xe2\x80\x89t2,\xe2\x80\x89...,\xe2\x80\x89tn, your task is to split levels into regions. Each level must belong to exactly one region, and each region must contain non-empty consecutive set of levels. What is the minimum possible expected number of hours required to finish the game?" 2400

643B "Bear and Two Paths" "constructive algorithms,graphs" "Bearland has n cities, numbered 1 through n. Cities are connected via bidirectional roads. Each road connects two distinct cities. No two roads connect the same pair of cities.Bear Limak was once in a city a and he wanted to go to a city b. There was no direct connection so he decided to take a long walk, visiting each city exactly once. Formally:   There is no road between a and b.  There exists a sequence (path) of n distinct cities v1,\xe2\x80\x89v2,\xe2\x80\x89...,\xe2\x80\x89vn that v1\xe2\x80\x89=\xe2\x80\x89a, vn\xe2\x80\x89=\xe2\x80\x89b and there is a road between vi and vi\xe2\x80\x89+\xe2\x80\x891 for . On the other day, the similar thing happened. Limak wanted to travel between a city c and a city d. There is no road between them but there exists a sequence of n distinct cities u1,\xe2\x80\x89u2,\xe2\x80\x89...,\xe2\x80\x89un that u1\xe2\x80\x89=\xe2\x80\x89c, un\xe2\x80\x89=\xe2\x80\x89d and there is a road between ui and ui\xe2\x80\x89+\xe2\x80\x891 for .Also, Limak thinks that there are at most k roads in Bearland. He wonders whether he remembers everything correctly.Given n, k and four distinct cities a, b, c, d, can you find possible paths (v1,\xe2\x80\x89...,\xe2\x80\x89vn) and (u1,\xe2\x80\x89...,\xe2\x80\x89un) to satisfy all the given conditions? Find any solution or print -1 if it\'s impossible." 1600

643A "Bear and Colors" implementation "Bear Limak has n colored balls, arranged in one long row. Balls are numbered 1 through n, from left to right. There are n possible colors, also numbered 1 through n. The i-th ball has color ti.For a fixed interval (set of consecutive elements) of balls we can define a dominant color. It\'s a color occurring the biggest number of times in the interval. In case of a tie between some colors, the one with the smallest number (index) is chosen as dominant.There are  non-empty intervals in total. For each color, your task is to count the number of intervals in which this color is dominant." 1500

641G "Little Artem and Graph" NA "Little Artem is given a graph, constructed as follows: start with some k-clique, then add new vertices one by one, connecting them to k already existing vertices that form a k-clique.Artem wants to count the number of spanning trees in this graph modulo 109\xe2\x80\x89+\xe2\x80\x897." 2300

641F "Little Artem and 2-SAT" NA "Little Artem is a very smart programmer. He knows many different difficult algorithms. Recently he has mastered in 2-SAT one.In computer science, 2-satisfiability (abbreviated as 2-SAT) is the special case of the problem of determining whether a conjunction (logical AND) of disjunctions (logical OR) have a solution, in which all disjunctions consist of no more than two arguments (variables). For the purpose of this problem we consider only 2-SAT formulas where each disjunction consists of exactly two arguments.Consider the following 2-SAT problem as an example: . Note that there might be negations in 2-SAT formula (like for x1 and for x4).Artem now tries to solve as many problems with 2-SAT as possible. He found a very interesting one, which he can not solve yet. Of course, he asks you to help him. The problem is: given two 2-SAT formulas f and g, determine whether their sets of possible solutions are the same. Otherwise, find any variables assignment x such that f(x)\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89g(x)." 3000

641E "Little Artem and Time Machine" "data structures" "Little Artem has invented a time machine! He could go anywhere in time, but all his thoughts of course are with computer science. He wants to apply this time machine to a well-known data structure: multiset.Artem wants to create a basic multiset of integers. He wants these structure to support operations of three types:  Add integer to the multiset. Note that the difference between set and multiset is that multiset may store several instances of one integer.  Remove integer from the multiset. Only one instance of this integer is removed. Artem doesn\'t want to handle any exceptions, so he assumes that every time remove operation is called, that integer is presented in the multiset.  Count the number of instances of the given integer that are stored in the multiset. But what about time machine? Artem doesn\'t simply apply operations to the multiset one by one, he now travels to different moments of time and apply his operation there. Consider the following example.  First Artem adds integer 5 to the multiset at the 1-st moment of time.  Then Artem adds integer 3 to the multiset at the moment 5.  Then Artem asks how many 5 are there in the multiset at moment 6. The answer is 1.  Then Artem returns back in time and asks how many integers 3 are there in the set at moment 4. Since 3 was added only at moment 5, the number of integers 3 at moment 4 equals to 0.  Then Artem goes back in time again and removes 5 from the multiset at moment 3.  Finally Artyom asks at moment 7 how many integers 5 are there in the set. The result is 0, since we have removed 5 at the moment 3. Note that Artem dislikes exceptions so much that he assures that after each change he makes all delete operations are applied only to element that is present in the multiset. The answer to the query of the third type is computed at the moment Artem makes the corresponding query and are not affected in any way by future changes he makes.Help Artem implement time travellers multiset." 2000

641D "Little Artem and Random Variable" dp,implementation,math,probabilities "Little Artyom decided to study probability theory. He found a book with a lot of nice exercises and now wants you to help him with one of them.Consider two dices. When thrown each dice shows some integer from 1 to n inclusive. For each dice the probability of each outcome is given (of course, their sum is 1), and different dices may have different probability distributions.We throw both dices simultaneously and then calculate values max(a,\xe2\x80\x89b) and min(a,\xe2\x80\x89b), where a is equal to the outcome of the first dice, while b is equal to the outcome of the second dice. You don\'t know the probability distributions for particular values on each dice, but you know the probability distributions for max(a,\xe2\x80\x89b) and min(a,\xe2\x80\x89b). That is, for each x from 1 to n you know the probability that max(a,\xe2\x80\x89b) would be equal to x and the probability that min(a,\xe2\x80\x89b) would be equal to x. Find any valid probability distribution for values on the dices. It\'s guaranteed that the input data is consistent, that is, at least one solution exists." 2400

641C "Little Artem and Dance" "brute force,constructive algorithms,implementation" "Little Artem is fond of dancing. Most of all dances Artem likes rueda�\xe2\x80\x94 Cuban dance that is danced by pairs of boys and girls forming a circle and dancing together.More detailed, there are n pairs of boys and girls standing in a circle. Initially, boy number 1 dances with a girl number 1, boy number 2 dances with a girl number 2 and so on. Girls are numbered in the clockwise order. During the dance different moves are announced and all pairs perform this moves. While performing moves boys move along the circle, while girls always stay at their initial position. For the purpose of this problem we consider two different types of moves:  Value x and some direction are announced, and all boys move x positions in the corresponding direction.  Boys dancing with even-indexed girls swap positions with boys who are dancing with odd-indexed girls. That is the one who was dancing with the girl 1 swaps with the one who was dancing with the girl number 2, while the one who was dancing with girl number 3 swaps with the one who was dancing with the girl number 4 and so one. It\'s guaranteed that n is even. Your task is to determine the final position of each boy." 1800

641B "Little Artem and Matrix" implementation "Little Artem likes electronics. He can spend lots of time making different schemas and looking for novelties in the nearest electronics store. The new control element was delivered to the store recently and Artem immediately bought it.That element can store information about the matrix of integers size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m. There are n\xe2\x80\x89+\xe2\x80\x89m inputs in that element, i.e. each row and each column can get the signal. When signal comes to the input corresponding to some row, this row cyclically shifts to the left, that is the first element of the row becomes last element, second element becomes first and so on. When signal comes to the input corresponding to some column, that column shifts cyclically to the top, that is first element of the column becomes last element, second element becomes first and so on. Rows are numbered with integers from 1 to n from top to bottom, while columns are numbered with integers from 1 to m from left to right.Artem wants to carefully study this element before using it. For that purpose he is going to set up an experiment consisting of q turns. On each turn he either sends the signal to some input or checks what number is stored at some position of the matrix.Artem has completed his experiment and has written down the results, but he has lost the chip! Help Artem find any initial matrix that will match the experiment results. It is guaranteed that experiment data is consistent, which means at least one valid matrix exists." 1400

641A "Little Artem and Grasshopper" implementation "Little Artem found a grasshopper. He brought it to his house and constructed a jumping area for him.The area looks like a strip of cells 1\xe2\x80\x89\xc3\x97\xe2\x80\x89n. Each cell contains the direction for the next jump and the length of that jump. Grasshopper starts in the first cell and follows the instructions written on the cells. Grasshopper stops immediately if it jumps out of the strip. Now Artem wants to find out if this will ever happen." 1000

639F "Bear and Chemistry" "data structures,dfs and similar,graphs,trees" "Limak is a smart brown bear who loves chemistry, reactions and transforming elements.In Bearland (Limak\'s home) there are n elements, numbered 1 through n. There are also special machines, that can transform elements. Each machine is described by two integers ai,\xe2\x80\x89bi representing two elements, not necessarily distinct. One can use a machine either to transform an element ai to bi or to transform bi to ai. Machines in Bearland aren\'t very resistant and each of them can be used at most once. It is possible that ai\xe2\x80\x89=\xe2\x80\x89bi and that many machines have the same pair ai,\xe2\x80\x89bi.Radewoosh is Limak\'s biggest enemy and rival. He wants to test Limak in the chemistry. They will meet tomorrow and both of them will bring all their machines. Limak has m machines but he doesn\'t know much about his enemy. They agreed Radewoosh will choose two distinct elements, let\'s denote them as x and y. Limak will be allowed to use both his and Radewoosh\'s machines. He may use zero or more (maybe even all) machines to achieve the goal, each machine at most once. Limak will start from an element x and his task will be to first get an element y and then to again get an element x�\xe2\x80\x94 then we say that he succeeds. After that Radewoosh would agree that Limak knows the chemistry (and Radewoosh would go away).Radewoosh likes some particular non-empty set of favorite elements and he will choose x,\xe2\x80\x89y from that set. Limak doesn\'t know exactly which elements are in the set and also he doesn\'t know what machines Radewoosh has. Limak has heard q gossips (queries) though and each of them consists of Radewoosh\'s machines and favorite elements. For each gossip Limak wonders if he would be able to succeed tomorrow for every pair x,\xe2\x80\x89y chosen from the set of favorite elements. If yes then print ""YES"" (without the quotes). But if there exists a pair (x,\xe2\x80\x89y) from the given set that Limak wouldn\'t be able to succeed then you should print ""NO"" (without the quotes)." 3300

639E "Bear and Paradox" "binary search,greedy,math,sortings" "Limak is a big polar bear. He prepared n problems for an algorithmic contest. The i-th problem has initial score pi. Also, testers said that it takes ti minutes to solve the i-th problem. Problems aren\'t necessarily sorted by difficulty and maybe harder problems have smaller initial score but it\'s too late to change it�\xe2\x80\x94 Limak has already announced initial scores for problems. Though it\'s still possible to adjust the speed of losing points, denoted by c in this statement.Let T denote the total number of minutes needed to solve all problems (so, T\xe2\x80\x89=\xe2\x80\x89t1\xe2\x80\x89+\xe2\x80\x89t2\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89tn). The contest will last exactly T minutes. So it\'s just enough to solve all problems.Points given for solving a problem decrease linearly. Solving the i-th problem after x minutes gives exactly  points, where  is some real constant that Limak must choose.Let\'s assume that c is fixed. During a contest a participant chooses some order in which he or she solves problems. There are n! possible orders and each of them gives some total number of points, not necessarily integer. We say that an order is optimal if it gives the maximum number of points. In other words, the total number of points given by this order is greater or equal than the number of points given by any other order. It\'s obvious that there is at least one optimal order. However, there may be more than one optimal order.Limak assumes that every participant will properly estimate ti at the very beginning and will choose some optimal order. He also assumes that testers correctly predicted time needed to solve each problem.For two distinct problems i and j such that pi\xe2\x80\x89<\xe2\x80\x89pj Limak wouldn\'t be happy to see a participant with strictly more points for problem i than for problem j. He calls such a situation a paradox.It\'s not hard to prove that there will be no paradox for c\xe2\x80\x89=\xe2\x80\x890. The situation may be worse for bigger c. What is the maximum real value c (remember that ) for which there is no paradox possible, that is, there will be no paradox for any optimal order of solving problems?It can be proved that the answer (the maximum c as described) always exists." 2800

639D "Bear and Contribution" "data structures,greedy,sortings,two pointers" "Codeforces is a wonderful platform and one its feature shows how much someone contributes to the community. Every registered user has contribution�\xe2\x80\x94 an integer number, not necessarily positive. There are n registered users and the i-th of them has contribution ti.Limak is a little polar bear and he\'s new into competitive programming. He doesn\'t even have an account in Codeforces but he is able to upvote existing blogs and comments. We assume that every registered user has infinitely many blogs and comments.  Limak can spend b minutes to read one blog and upvote it. Author\'s contribution will be increased by 5.  Limak can spend c minutes to read one comment and upvote it. Author\'s contribution will be increased by 1. Note that it\'s possible that Limak reads blogs faster than comments.Limak likes ties. He thinks it would be awesome to see a tie between at least k registered users. To make it happen he is going to spend some time on reading and upvoting. After that, there should exist an integer value x that at least k registered users have contribution exactly x.How much time does Limak need to achieve his goal?" 2400

639C "Bear and Polynomials" hashing,implementation,math "Limak is a little polar bear. He doesn\'t have many toys and thus he often plays with polynomials.He considers a polynomial valid if its degree is n and its coefficients are integers not exceeding k by the absolute value. More formally:Let a0,\xe2\x80\x89a1,\xe2\x80\x89...,\xe2\x80\x89an denote the coefficients, so . Then, a polynomial P(x) is valid if all the following conditions are satisfied:  ai is integer for every i;  |ai|\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k for every i;  an\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x890. Limak has recently got a valid polynomial P with coefficients a0,\xe2\x80\x89a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. He noticed that P(2)\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x890 and he wants to change it. He is going to change one coefficient to get a valid polynomial Q of degree n that Q(2)\xe2\x80\x89=\xe2\x80\x890. Count the number of ways to do so. You should count two ways as a distinct if coefficients of target polynoms differ." 2200

639B "Bear and Forgotten Tree 3" "constructive algorithms,graphs,trees" "A tree is a connected undirected graph consisting of n vertices and n\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x89\xe2\x80\x891 edges. Vertices are numbered 1 through n.Limak is a little polar bear and Radewoosh is his evil enemy. Limak once had a tree but Radewoosh stolen it. Bear is very sad now because he doesn\'t remember much about the tree�\xe2\x80\x94 he can tell you only three values n, d and h:  The tree had exactly n vertices.  The tree had diameter d. In other words, d was the biggest distance between two vertices.  Limak also remembers that he once rooted the tree in vertex 1 and after that its height was h. In other words, h was the biggest distance between vertex 1 and some other vertex. The distance between two vertices of the tree is the number of edges on the simple path between them.Help Limak to restore his tree. Check whether there exists a tree satisfying the given conditions. Find any such tree and print its edges in any order. It\'s also possible that Limak made a mistake and there is no suitable tree�\xe2\x80\x93 in this case print ""-1""." 1600

639A "Bear and Displayed Friends" implementation "Limak is a little polar bear. He loves connecting with other bears via social networks. He has n friends and his relation with the i-th of them is described by a unique integer ti. The bigger this value is, the better the friendship is. No two friends have the same value ti.Spring is starting and the Winter sleep is over for bears. Limak has just woken up and logged in. All his friends still sleep and thus none of them is online. Some (maybe all) of them will appear online in the next hours, one at a time.The system displays friends who are online. On the screen there is space to display at most k friends. If there are more than k friends online then the system displays only k best of them�\xe2\x80\x94 those with biggest ti.Your task is to handle queries of two types:  ""1 id""�\xe2\x80\x94 Friend id becomes online. It\'s guaranteed that he wasn\'t online before.  ""2 id""�\xe2\x80\x94 Check whether friend id is displayed by the system. Print ""YES"" or ""NO"" in a separate line. Are you able to help Limak and answer all queries of the second type?" 1200

638D "Three-dimensional Turtle Super Computer" "brute force,dfs and similar,graphs" "A super computer has been built in the Turtle Academy of Sciences. The computer consists of n\xc2\xb7m\xc2\xb7k CPUs. The architecture was the paralellepiped of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m\xe2\x80\x89\xc3\x97\xe2\x80\x89k, split into 1\xe2\x80\x89\xc3\x97\xe2\x80\x891\xe2\x80\x89\xc3\x97\xe2\x80\x891 cells, each cell contains exactly one CPU. Thus, each CPU can be simultaneously identified as a group of three numbers from the layer number from 1 to n, the line number from 1 to m and the column number from 1 to k.In the process of the Super Computer\'s work the CPUs can send each other messages by the famous turtle scheme: CPU (x,\xe2\x80\x89y,\xe2\x80\x89z) can send messages to CPUs (x\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89y,\xe2\x80\x89z), (x,\xe2\x80\x89y\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89z) and (x,\xe2\x80\x89y,\xe2\x80\x89z\xe2\x80\x89+\xe2\x80\x891) (of course, if they exist), there is no feedback, that is, CPUs (x\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89y,\xe2\x80\x89z), (x,\xe2\x80\x89y\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89z) and (x,\xe2\x80\x89y,\xe2\x80\x89z\xe2\x80\x89+\xe2\x80\x891) cannot send messages to CPU (x,\xe2\x80\x89y,\xe2\x80\x89z).Over time some CPUs broke down and stopped working. Such CPUs cannot send messages, receive messages or serve as intermediates in transmitting messages. We will say that CPU (a,\xe2\x80\x89b,\xe2\x80\x89c) controls CPU (d,\xe2\x80\x89e,\xe2\x80\x89f) , if there is a chain of CPUs (xi,\xe2\x80\x89yi,\xe2\x80\x89zi), such that (x1\xe2\x80\x89=\xe2\x80\x89a,\xe2\x80\x89y1\xe2\x80\x89=\xe2\x80\x89b,\xe2\x80\x89z1\xe2\x80\x89=\xe2\x80\x89c), (xp\xe2\x80\x89=\xe2\x80\x89d,\xe2\x80\x89yp\xe2\x80\x89=\xe2\x80\x89e,\xe2\x80\x89zp\xe2\x80\x89=\xe2\x80\x89f) (here and below p is the length of the chain) and the CPU in the chain with number i (i\xe2\x80\x89<\xe2\x80\x89p) can send messages to CPU i\xe2\x80\x89+\xe2\x80\x891.Turtles are quite concerned about the denial-proofness of the system of communication between the remaining CPUs. For that they want to know the number of critical CPUs. A CPU (x,\xe2\x80\x89y,\xe2\x80\x89z) is critical, if turning it off will disrupt some control, that is, if there are two distinctive from (x,\xe2\x80\x89y,\xe2\x80\x89z) CPUs: (a,\xe2\x80\x89b,\xe2\x80\x89c) and (d,\xe2\x80\x89e,\xe2\x80\x89f), such that (a,\xe2\x80\x89b,\xe2\x80\x89c) controls (d,\xe2\x80\x89e,\xe2\x80\x89f) before (x,\xe2\x80\x89y,\xe2\x80\x89z) is turned off and stopped controlling it after the turning off." 1800

638C "Road Improvement" "*special problem,dfs and similar,graphs,greedy,trees" "In Berland there are n cities and n\xe2\x80\x89-\xe2\x80\x891 bidirectional roads. Each road connects some pair of cities, from any city you can get to any other one using only the given roads.In each city there is exactly one repair brigade. To repair some road, you need two teams based in the cities connected by the road to work simultaneously for one day. Both brigades repair one road for the whole day and cannot take part in repairing other roads on that day. But the repair brigade can do nothing on that day.Determine the minimum number of days needed to repair all the roads. The brigades cannot change the cities where they initially are." 1800

638B "Making Genome in Berland" "*special problem,dfs and similar,strings" "Berland scientists face a very important task - given the parts of short DNA fragments, restore the dinosaur DNA! The genome of a berland dinosaur has noting in common with the genome that we\'ve used to: it can have 26 distinct nucleotide types, a nucleotide of each type can occur at most once. If we assign distinct English letters to all nucleotides, then the genome of a Berland dinosaur will represent a non-empty string consisting of small English letters, such that each letter occurs in it at most once.Scientists have n genome fragments that are represented as substrings (non-empty sequences of consecutive nucleotides) of the sought genome.You face the following problem: help scientists restore the dinosaur genome. It is guaranteed that the input is not contradictory and at least one suitable line always exists. When the scientists found out that you are a strong programmer, they asked you in addition to choose the one with the minimum length. If there are multiple such strings, choose any string." 1500

638A "Home Numbers" "*special problem,constructive algorithms,math" "The main street of Berland is a straight line with n houses built along it (n is an even number). The houses are located at both sides of the street. The houses with odd numbers are at one side of the street and are numbered from 1 to n\xe2\x80\x89-\xe2\x80\x891 in the order from the beginning of the street to the end (in the picture: from left to right). The houses with even numbers are at the other side of the street and are numbered from 2 to n in the order from the end of the street to its beginning (in the picture: from right to left). The corresponding houses with even and odd numbers are strictly opposite each other, that is, house 1 is opposite house n, house 3 is opposite house n\xe2\x80\x89-\xe2\x80\x892, house 5 is opposite house n\xe2\x80\x89-\xe2\x80\x894 and so on.  Vasya needs to get to house number a as quickly as possible. He starts driving from the beginning of the street and drives his car to house a. To get from the beginning of the street to houses number 1 and n, he spends exactly 1 second. He also spends exactly one second to drive the distance between two neighbouring houses. Vasya can park at any side of the road, so the distance between the beginning of the street at the houses that stand opposite one another should be considered the same.Your task is: find the minimum time Vasya needs to reach house a." 1100

637D "Running with Obstacles" "*special problem,data structures,dp,greedy" "A sportsman starts from point xstart\xe2\x80\x89=\xe2\x80\x890 and runs to point with coordinate xfinish\xe2\x80\x89=\xe2\x80\x89m (on a straight line). Also, the sportsman can jump \xe2\x80\x94 to jump, he should first take a run of length of not less than s meters (in this case for these s meters his path should have no obstacles), and after that he can jump over a length of not more than d meters. Running and jumping is permitted only in the direction from left to right. He can start andfinish a jump only at the points with integer coordinates in which there are no obstacles. To overcome some obstacle, it is necessary to land at a point which is strictly to the right of this obstacle.On the way of an athlete are n obstacles at coordinates x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xn. He cannot go over the obstacles, he can only jump over them. Your task is to determine whether the athlete will be able to get to the finish point." 1600

637C "Promocodes with Mistakes" "*special problem,brute force,constructive algorithms,implementation" "During a New Year special offer the ""Sudislavl Bars"" offered n promo codes. Each promo code consists of exactly six digits and gives right to one free cocktail at the bar ""Mosquito Shelter"". Of course, all the promocodes differ.As the ""Mosquito Shelter"" opens only at 9, and partying in Sudislavl usually begins at as early as 6, many problems may arise as to how to type a promotional code without errors. It is necessary to calculate such maximum k, that the promotional code could be uniquely identified if it was typed with no more than k errors. At that, k\xe2\x80\x89=\xe2\x80\x890 means that the promotional codes must be entered exactly.A mistake in this problem should be considered as entering the wrong numbers. For example, value ""123465"" contains two errors relative to promocode ""123456"". Regardless of the number of errors the entered value consists of exactly six digits." 1400

637B "Chat Order" "*special problem,binary search,constructive algorithms,data structures,sortings" "Polycarp is a big lover of killing time in social networks. A page with a chatlist in his favourite network is made so that when a message is sent to some friend, his friend\'s chat rises to the very top of the page. The relative order of the other chats doesn\'t change. If there was no chat with this friend before, then a new chat is simply inserted to the top of the list.Assuming that the chat list is initially empty, given the sequence of Polycaprus\' messages make a list of chats after all of his messages are processed. Assume that no friend wrote any message to Polycarpus." 1200

637A "Voting for Photos" "*special problem,constructive algorithms,implementation" "After celebrating the midcourse the students of one of the faculties of the Berland State University decided to conduct a vote for the best photo. They published the photos in the social network and agreed on the rules to choose a winner: the photo which gets most likes wins. If multiple photoes get most likes, the winner is the photo that gets this number first.Help guys determine the winner photo by the records of likes." 1000

635A Orchestra "brute force,implementation" "Paul is at the orchestra. The string section is arranged in an r\xe2\x80\x89\xc3\x97\xe2\x80\x89c rectangular grid and is filled with violinists with the exception of n violists. Paul really likes violas, so he would like to take a picture including at least k of them. Paul can take a picture of any axis-parallel rectangle in the orchestra. Count the number of possible pictures that Paul can take.Two pictures are considered to be different if the coordinates of corresponding rectangles are different." 1100

634A "Island Puzzle" "constructive algorithms,implementation" "A remote island chain contains n islands, labeled 1 through n. Bidirectional bridges connect the islands to form a simple cycle�\xe2\x80\x94 a bridge connects islands 1 and 2, islands 2 and 3, and so on, and additionally a bridge connects islands n and 1. The center of each island contains an identical pedestal, and all but one of the islands has a fragile, uniquely colored statue currently held on the pedestal. The remaining island holds only an empty pedestal.The islanders want to rearrange the statues in a new order. To do this, they repeat the following process: First, they choose an island directly adjacent to the island containing an empty pedestal. Then, they painstakingly carry the statue on this island across the adjoining bridge and place it on the empty pedestal.Determine if it is possible for the islanders to arrange the statues in the desired order." 1300

633H "Fibonacci-ish II" "data structures,implementation" "Yash is finally tired of computing the length of the longest Fibonacci-ish sequence. He now plays around with more complex things such as Fibonacci-ish potentials. Fibonacci-ish potential of an array ai is computed as follows:   Remove all elements j if there exists i\xe2\x80\x89<\xe2\x80\x89j such that ai\xe2\x80\x89=\xe2\x80\x89aj.  Sort the remaining elements in ascending order, i.e. a1\xe2\x80\x89<\xe2\x80\x89a2\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89an.  Compute the potential as P(a)\xe2\x80\x89=\xe2\x80\x89a1\xc2\xb7F1\xe2\x80\x89+\xe2\x80\x89a2\xc2\xb7F2\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89an\xc2\xb7Fn, where Fi is the i-th Fibonacci number (see notes for clarification). You are given an array ai of length n and q ranges from lj to rj. For each range j you have to compute the Fibonacci-ish potential of the array bi, composed using all elements of ai from lj to rj inclusive. Find these potentials modulo m." 3100

633G "Yash And Trees" "bitmasks,data structures,dfs and similar,math,number theory" "Yash loves playing with trees and gets especially excited when they have something to do with prime numbers. On his 20th birthday he was granted with a rooted tree of n nodes to answer queries on. Hearing of prime numbers on trees, Yash gets too intoxicated with excitement and asks you to help out and answer queries on trees for him. Tree is rooted at node 1. Each node i has some value ai associated with it. Also, integer m is given.There are queries of two types:  for given node v and integer value x, increase all ai in the subtree of node v by value x  for given node v, find the number of prime numbers p less than m, for which there exists a node u in the subtree of v and a non-negative integer value k, such that au\xe2\x80\x89=\xe2\x80\x89p\xe2\x80\x89+\xe2\x80\x89m\xc2\xb7k." 2800

633F "The Chocolate Spree" "dfs and similar,dp,graphs,trees" "Alice and Bob have a tree (undirected acyclic connected graph). There are ai chocolates waiting to be picked up in the i-th vertex of the tree. First, they choose two different vertices as their starting positions (Alice chooses first) and take all the chocolates contained in them.Then, they alternate their moves, selecting one vertex at a time and collecting all chocolates from this node. To make things more interesting, they decided that one can select a vertex only if he/she selected a vertex adjacent to that one at his/her previous turn and this vertex has not been already chosen by any of them during other move.If at any moment one of them is not able to select the node that satisfy all the rules, he/she will skip his turns and let the other person pick chocolates as long as he/she can. This goes on until both of them cannot pick chocolates any further.Due to their greed for chocolates, they want to collect as many chocolates as possible. However, as they are friends they only care about the total number of chocolates they obtain together. What is the maximum total number of chocolates they may pick?" 2600

633E "Startup Funding" "binary search,constructive algorithms,data structures,probabilities,two pointers" "An e-commerce startup pitches to the investors to get funding. They have been functional for n weeks now and also have a website!For each week they know the number of unique visitors during this week vi and the revenue ci. To evaluate the potential of the startup at some range of weeks from l to r inclusive investors use the minimum among the maximum number of visitors multiplied by 100 and the minimum revenue during this period, that is: The truth is that investors have no idea how to efficiently evaluate the startup, so they are going to pick some k random distinct weeks li and give them to managers of the startup. For each li they should pick some ri\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89li and report maximum number of visitors and minimum revenue during this period.Then, investors will calculate the potential of the startup for each of these ranges and take minimum value of p(li,\xe2\x80\x89ri) as the total evaluation grade of the startup. Assuming that managers of the startup always report the optimal values of ri for some particular li, i.e., the value such that the resulting grade of the startup is maximized, what is the expected resulting grade of the startup?" 2400

633D Fibonacci-ish "brute force,dp,hashing,implementation,math" "Yash has recently learnt about the Fibonacci sequence and is very excited about it. He calls a sequence Fibonacci-ish if   the sequence consists of at least two elements  f0 and f1 are arbitrary  fn\xe2\x80\x89+\xe2\x80\x892\xe2\x80\x89=\xe2\x80\x89fn\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x89fn for all n\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x890. You are given some sequence of integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. Your task is rearrange elements of this sequence in such a way that its longest possible prefix is Fibonacci-ish sequence." 2000

633C "Spy Syndrome 2" "data structures,dp,hashing,implementation,sortings,string suffix structures,strings" "After observing the results of Spy Syndrome, Yash realised the errors of his ways. He now believes that a super spy such as Siddhant can\'t use a cipher as basic and ancient as Caesar cipher. After many weeks of observation of Siddhant\xe2\x80\x99s sentences, Yash determined a new cipher technique.For a given sentence, the cipher is processed as:   Convert all letters of the sentence to lowercase.  Reverse each of the words of the sentence individually.  Remove all the spaces in the sentence. For example, when this cipher is applied to the sentenceKira is childish and he hates losingthe resulting string isariksihsidlihcdnaehsetahgnisolNow Yash is given some ciphered string and a list of words. Help him to find out any original sentence composed using only words from the list. Note, that any of the given words could be used in the sentence multiple times." 1900

633B "A Trivial Problem" "brute force,constructive algorithms,math,number theory" "Mr. Santa asks all the great programmers of the world to solve a trivial problem. He gives them an integer m and asks for the number of positive integers n, such that the factorial of n ends with exactly m zeroes. Are you among those great programmers who can solve this problem?" 1300

633A "Ebony and Ivory" "brute force,math,number theory" "Dante is engaged in a fight with ""The Savior"". Before he can fight it with his sword, he needs to break its shields. He has two guns, Ebony and Ivory, each of them is able to perform any non-negative number of shots.For every bullet that hits the shield, Ebony deals a units of damage while Ivory deals b units of damage. In order to break the shield Dante has to deal exactly c units of damage. Find out if this is possible." 1100

632F "Magic Matrix" "brute force,divide and conquer,graphs,matrices,trees" "You\'re given a matrix A of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89n.Let\'s call the matrix with nonnegative elements magic if it is symmetric (so aij\xe2\x80\x89=\xe2\x80\x89aji), aii\xe2\x80\x89=\xe2\x80\x890 and aij\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89max(aik,\xe2\x80\x89ajk) for all triples i,\xe2\x80\x89j,\xe2\x80\x89k. Note that i,\xe2\x80\x89j,\xe2\x80\x89k do not need to be distinct.Determine if the matrix is magic.As the input/output can reach very huge size it is recommended to use fast input/output methods: for example, prefer to use scanf/printf instead of cin/cout in C++, prefer to use BufferedReader/PrintWriter instead of Scanner/System.out in Java." 2400

632E "Thief in a Shop" "divide and conquer,dp,fft,math" "A thief made his way to a shop.As usual he has his lucky knapsack with him. The knapsack can contain k objects. There are n kinds of products in the shop and an infinite number of products of each kind. The cost of one product of kind i is ai.The thief is greedy, so he will take exactly k products (it\'s possible for some kinds to take several products of that kind).Find all the possible total costs of products the thief can nick into his knapsack." 2400

632D "Longest Subsequence" "brute force,math,number theory" "You are given array a with n elements and the number m. Consider some subsequence of a and the value of least common multiple (LCM) of its elements. Denote LCM as l. Find any longest subsequence of a with the value l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m.A subsequence of a is an array we can get by erasing some elements of a. It is allowed to erase zero or all elements.The LCM of an empty array equals 1." 2100

632C "The Smallest String Concatenation" sortings,strings "You\'re given a list of n strings a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. You\'d like to concatenate them together in some order such that the resulting string would be lexicographically smallest.Given the list of strings, output the lexicographically smallest concatenation." 1700

632B "Alice, Bob, Two Teams" "brute force,constructive algorithms" "Alice and Bob are playing a game. The game involves splitting up game pieces into two teams. There are n pieces, and the i-th piece has a strength pi.The way to split up game pieces is split into several steps:  First, Alice will split the pieces into two different groups A and B. This can be seen as writing the assignment of teams of a piece in an n character string, where each character is A or B.  Bob will then choose an arbitrary prefix or suffix of the string, and flip each character in that suffix (i.e. change A to B and B to A). He can do this step at most once.  Alice will get all the pieces marked A and Bob will get all the pieces marked B. The strength of a player is then the sum of strengths of the pieces in the group.Given Alice\'s initial split into two teams, help Bob determine an optimal strategy. Return the maximum strength he can achieve." 1400

632A "Grandma Laura and Apples" NA "Grandma Laura came to the market to sell some apples. During the day she sold all the apples she had. But grandma is old, so she forgot how many apples she had brought to the market.She precisely remembers she had n buyers and each of them bought exactly half of the apples she had at the moment of the purchase and also she gave a half of an apple to some of them as a gift (if the number of apples at the moment of purchase was odd), until she sold all the apples she had.So each buyer took some integral positive number of apples, but maybe he didn\'t pay for a half of an apple (if the number of apples at the moment of the purchase was odd).For each buyer grandma remembers if she gave a half of an apple as a gift or not. The cost of an apple is p (the number p is even).Print the total money grandma should have at the end of the day to check if some buyers cheated her." 1200

631E "Product Sum" "data structures,dp,geometry" "Blake is the boss of Kris, however, this doesn\'t spoil their friendship. They often gather at the bar to talk about intriguing problems about maximising some values. This time the problem is really special.You are given an array a of length n. The characteristic of this array is the value �\xe2\x80\x94 the sum of the products of the values ai by i. One may perform the following operation exactly once: pick some element of the array and move to any position. In particular, it\'s allowed to move the element to the beginning or to the end of the array. Also, it\'s allowed to put it back to the initial position. The goal is to get the array with the maximum possible value of characteristic." 2600

631D Messenger "data structures,hashing,implementation,string suffix structures,strings" "Each employee of the ""Blake Techologies"" company uses a special messaging app ""Blake Messenger"". All the stuff likes this app and uses it constantly. However, some important futures are missing. For example, many users want to be able to search through the message history. It was already announced that the new feature will appear in the nearest update, when developers faced some troubles that only you may help them to solve.All the messages are represented as a strings consisting of only lowercase English letters. In order to reduce the network load strings are represented in the special compressed form. Compression algorithm works as follows: string is represented as a concatenation of n blocks, each block containing only equal characters. One block may be described as a pair (li,\xe2\x80\x89ci), where li is the length of the i-th block and ci is the corresponding letter. Thus, the string s may be written as the sequence of pairs .Your task is to write the program, that given two compressed string t and s finds all occurrences of s in t. Developers know that there may be many such occurrences, so they only ask you to find the number of them. Note that p is the starting position of some occurrence of s in t if and only if tptp\xe2\x80\x89+\xe2\x80\x891...tp\xe2\x80\x89+\xe2\x80\x89|s|\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89=\xe2\x80\x89s, where ti is the i-th character of string t.Note that the way to represent the string in compressed form may not be unique. For example string ""aaaa"" may be given as , , ..." 2100

631C Report "data structures,sortings" "Each month Blake gets the report containing main economic indicators of the company ""Blake Technologies"". There are n commodities produced by the company. For each of them there is exactly one integer in the final report, that denotes corresponding revenue. Before the report gets to Blake, it passes through the hands of m managers. Each of them may reorder the elements in some order. Namely, the i-th manager either sorts first ri numbers in non-descending or non-ascending order and then passes the report to the manager i\xe2\x80\x89+\xe2\x80\x891, or directly to Blake (if this manager has number i\xe2\x80\x89=\xe2\x80\x89m).Employees of the ""Blake Technologies"" are preparing the report right now. You know the initial sequence ai of length n and the description of each manager, that is value ri and his favourite order. You are asked to speed up the process and determine how the final report will look like." 1700

631B "Print Check" "constructive algorithms,implementation" "Kris works in a large company ""Blake Technologies"". As a best engineer of the company he was assigned a task to develop a printer that will be able to print horizontal and vertical strips. First prototype is already built and Kris wants to tests it. He wants you to implement the program that checks the result of the printing.Printer works with a rectangular sheet of paper of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m. Consider the list as a table consisting of n rows and m columns. Rows are numbered from top to bottom with integers from 1 to n, while columns are numbered from left to right with integers from 1 to m. Initially, all cells are painted in color 0.Your program has to support two operations:   Paint all cells in row ri in color ai;  Paint all cells in column ci in color ai. If during some operation i there is a cell that have already been painted, the color of this cell also changes to ai.Your program has to print the resulting table after k operation." 1200

631A Interview "brute force,implementation" "Blake is a CEO of a large company called ""Blake Technologies"". He loves his company very much and he thinks that his company should be the best. That is why every candidate needs to pass through the interview that consists of the following problem.We define function f(x,\xe2\x80\x89l,\xe2\x80\x89r) as a bitwise OR of integers xl,\xe2\x80\x89xl\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89xr, where xi is the i-th element of the array x. You are given two arrays a and b of length n. You need to determine the maximum value of sum f(a,\xe2\x80\x89l,\xe2\x80\x89r)\xe2\x80\x89+\xe2\x80\x89f(b,\xe2\x80\x89l,\xe2\x80\x89r) among all possible 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n." 900

630R Game games,math "There is a legend in the IT City college. A student that failed to answer all questions on the game theory exam is given one more chance by his professor. The student has to play a game with the professor.The game is played on a square field consisting of n\xe2\x80\x89\xc3\x97\xe2\x80\x89n cells. Initially all cells are empty. On each turn a player chooses and paint an empty cell that has no common sides with previously painted cells. Adjacent corner of painted cells is allowed. On the next turn another player does the same, then the first one and so on. The player with no cells to paint on his turn loses.The professor have chosen the field size n and allowed the student to choose to be the first or the second player in the game. What should the student choose to win the game? Both players play optimally." 1200

630Q Pyramids geometry,math "IT City administration has no rest because of the fame of the Pyramids in Egypt. There is a project of construction of pyramid complex near the city in the place called Emerald Walley. The distinction of the complex is that its pyramids will be not only quadrangular as in Egypt but also triangular and pentagonal. Of course the amount of the city budget funds for the construction depends on the pyramids\' volume. Your task is to calculate the volume of the pilot project consisting of three pyramids \xe2\x80\x94 one triangular, one quadrangular and one pentagonal.The first pyramid has equilateral triangle as its base, and all 6 edges of the pyramid have equal length. The second pyramid has a square as its base and all 8 edges of the pyramid have equal length. The third pyramid has a regular pentagon as its base and all 10 edges of the pyramid have equal length." 1700

630P "Area of a Star" geometry "It was decided in IT City to distinguish successes of local IT companies by awards in the form of stars covered with gold from one side. To order the stars it is necessary to estimate order cost that depends on the area of gold-plating. Write a program that can calculate the area of a star.A ""star"" figure having n\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x895 corners where n is a prime number is constructed the following way. On the circle of radius r n points are selected so that the distances between the adjacent ones are equal. Then every point is connected by a segment with two maximally distant points. All areas bounded by the segments parts are the figure parts." 2100

630O Arrow geometry "Petya has recently started working as a programmer in the IT city company that develops computer games.Besides game mechanics implementation to create a game it is necessary to create tool programs that can be used by game designers to create game levels. Petya\'s first assignment is to create a tool that allows to paint different arrows on the screen.A user of this tool will choose a point on the screen, specify a vector (the arrow direction) and vary several parameters to get the required graphical effect. In the first version of the program Petya decided to limit parameters of the arrow by the following: a point with coordinates (px,\xe2\x80\x89py), a nonzero vector with coordinates (vx,\xe2\x80\x89vy), positive scalars a,\xe2\x80\x89b,\xe2\x80\x89c,\xe2\x80\x89d,\xe2\x80\x89a\xe2\x80\x89>\xe2\x80\x89c.The produced arrow should have the following properties. The arrow consists of a triangle and a rectangle. The triangle is isosceles with base of length a and altitude of length b perpendicular to the base. The rectangle sides lengths are c and d. Point (px,\xe2\x80\x89py) is situated in the middle of the triangle base and in the middle of side of rectangle that has length c. Area of intersection of the triangle and the rectangle is zero. The direction from (px,\xe2\x80\x89py) point to the triangle vertex opposite to base containing the point coincides with direction of (vx,\xe2\x80\x89vy) vector.Enumerate the arrow points coordinates in counter-clockwise order starting from the tip." 2000

630N Forecast math "The Department of economic development of IT City created a model of city development till year 2100.To prepare report about growth perspectives it is required to get growth estimates from the model.To get the growth estimates it is required to solve a quadratic equation. Since the Department of economic development of IT City creates realistic models only, that quadratic equation has a solution, moreover there are exactly two different real roots.The greater of these roots corresponds to the optimistic scenario, the smaller one corresponds to the pessimistic one. Help to get these estimates, first the optimistic, then the pessimistic one." 1300

630M Turn geometry,math "Vasya started working in a machine vision company of IT City. Vasya\'s team creates software and hardware for identification of people by their face.One of the project\'s know-how is a camera rotating around its optical axis on shooting. People see an eye-catching gadget \xe2\x80\x94 a rotating camera \xe2\x80\x94 come up to it to see it better, look into it. And the camera takes their photo at that time. What could be better for high quality identification?But not everything is so simple. The pictures from camera appear rotated too (on clockwise camera rotation frame the content becomes rotated counter-clockwise). But the identification algorithm can work only with faces that are just slightly deviated from vertical.Vasya was entrusted to correct the situation \xe2\x80\x94 to rotate a captured image so that image would be minimally deviated from vertical. Requirements were severe. Firstly, the picture should be rotated only on angle divisible by 90 degrees to not lose a bit of information about the image. Secondly, the frames from the camera are so huge and FPS is so big that adequate rotation speed is provided by hardware FPGA solution only. And this solution can rotate only by 90 degrees clockwise. Of course, one can apply 90 degrees turn several times but for the sake of performance the number of turns should be minimized.Help Vasya implement the program that by the given rotation angle of the camera can determine the minimum number of 90 degrees clockwise turns necessary to get a picture in which up direction deviation from vertical is minimum.The next figure contains frames taken from an unrotated camera, then from rotated 90 degrees clockwise, then from rotated 90 degrees counter-clockwise. Arrows show direction to ""true up"".  The next figure shows 90 degrees clockwise turn by FPGA hardware." 1800

630L "Cracking the Code" implementation,math "The protection of a popular program developed by one of IT City companies is organized the following way. After installation it outputs a random five digit number which should be sent in SMS to a particular phone number. In response an SMS activation code arrives.A young hacker Vasya disassembled the program and found the algorithm that transforms the shown number into the activation code. Note: it is clear that Vasya is a law-abiding hacker, and made it for a noble purpose \xe2\x80\x94 to show the developer the imperfection of their protection.The found algorithm looks the following way. At first the digits of the number are shuffled in the following order <first digit><third digit><fifth digit><fourth digit><second digit>. For example the shuffle of 12345 should lead to 13542. On the second stage the number is raised to the fifth power. The result of the shuffle and exponentiation of the number 12345 is 455�422�043�125�550�171�232. The answer is the 5 last digits of this result. For the number 12345 the answer should be 71232.Vasya is going to write a keygen program implementing this algorithm. Can you do the same?" 1400

630K Indivisibility "math,number theory" "IT City company developing computer games decided to upgrade its way to reward its employees. Now it looks the following way. After a new game release users start buying it actively, and the company tracks the number of sales with precision to each transaction. Every time when the next number of sales is not divisible by any number from 2 to 10 every developer of this game gets a small bonus.A game designer Petya knows that the company is just about to release a new game that was partly developed by him. On the basis of his experience he predicts that n people will buy the game during the first month. Now Petya wants to determine how many times he will get the bonus. Help him to know it." 1500

630J Divisibility "math,number theory" "IT City company developing computer games invented a new way to reward its employees. After a new game release users start buying it actively, and the company tracks the number of sales with precision to each transaction. Every time when the next number of sales is divisible by all numbers from 2 to 10 every developer of this game gets a small bonus.A game designer Petya knows that the company is just about to release a new game that was partly developed by him. On the basis of his experience he predicts that n people will buy the game during the first month. Now Petya wants to determine how many times he will get the bonus. Help him to know it." 1100

630I "Parking Lot" combinatorics,math "To quickly hire highly skilled specialists one of the new IT City companies made an unprecedented move. Every employee was granted a car, and an employee can choose one of four different car makes.The parking lot before the office consists of one line of (2n\xe2\x80\x89-\xe2\x80\x892) parking spaces. Unfortunately the total number of cars is greater than the parking lot capacity. Furthermore even amount of cars of each make is greater than the amount of parking spaces! That\'s why there are no free spaces on the parking lot ever.Looking on the straight line of cars the company CEO thought that parking lot would be more beautiful if it contained exactly n successive cars of the same make. Help the CEO determine the number of ways to fill the parking lot this way." 1700

630H Benches combinatorics,math "The city park of IT City contains n east to west paths and n north to south paths. Each east to west path crosses each north to south path, so there are n2 intersections.The city funded purchase of five benches. To make it seems that there are many benches it was decided to place them on as many paths as possible. Obviously this requirement is satisfied by the following scheme: each bench is placed on a cross of paths and each path contains not more than one bench.Help the park administration count the number of ways to place the benches." 1400

630G "Challenge Pennants" combinatorics,math "Because of budget cuts one IT company established new non-financial reward system instead of bonuses.Two kinds of actions are rewarded: fixing critical bugs and suggesting new interesting features. A man who fixed a critical bug gets ""I fixed a critical bug"" pennant on his table. A man who suggested a new interesting feature gets ""I suggested a new feature"" pennant on his table.Because of the limited budget of the new reward system only 5 ""I fixed a critical bug"" pennants and 3 ""I suggested a new feature"" pennants were bought.In order to use these pennants for a long time they were made challenge ones. When a man fixes a new critical bug one of the earlier awarded ""I fixed a critical bug"" pennants is passed on to his table. When a man suggests a new interesting feature one of the earlier awarded ""I suggested a new feature"" pennants is passed on to his table.One man can have several pennants of one type and of course he can have pennants of both types on his table. There are n tables in the IT company. Find the number of ways to place the pennants on these tables given that each pennant is situated on one of the tables and each table is big enough to contain any number of pennants." 1600

630F "Selection of Personnel" combinatorics,math "One company of IT City decided to create a group of innovative developments consisting from 5 to 7 people and hire new employees for it. After placing an advertisment the company received n resumes. Now the HR department has to evaluate each possible group composition and select one of them. Your task is to count the number of variants of group composition to evaluate." 1300

630E "A rectangle" math "Developing tools for creation of locations maps for turn-based fights in a new game, Petya faced the following problem.A field map consists of hexagonal cells. Since locations sizes are going to be big, a game designer wants to have a tool for quick filling of a field part with identical enemy units. This action will look like following: a game designer will select a rectangular area on the map, and each cell whose center belongs to the selected rectangle will be filled with the enemy unit.More formally, if a game designer selected cells having coordinates (x1,\xe2\x80\x89y1) and (x2,\xe2\x80\x89y2), where x1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x2 and y1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y2, then all cells having center coordinates (x,\xe2\x80\x89y) such that x1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x2 and y1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y2 will be filled. Orthogonal coordinates system is set up so that one of cell sides is parallel to OX axis, all hexagon centers have integer coordinates and for each integer x there are cells having center with such x coordinate and for each integer y there are cells having center with such y coordinate. It is guaranteed that difference x2\xe2\x80\x89-\xe2\x80\x89x1 is divisible by 2.Working on the problem Petya decided that before painting selected units he wants to output number of units that will be painted on the map.Help him implement counting of these units before painting." 1900

630D Hexagons! math "After a probationary period in the game development company of IT City Petya was included in a group of the programmers that develops a new turn-based strategy game resembling the well known ""Heroes of Might & Magic"". A part of the game is turn-based fights of big squadrons of enemies on infinite fields where every cell is in form of a hexagon.Some of magic effects are able to affect several field cells at once, cells that are situated not farther than n cells away from the cell in which the effect was applied. The distance between cells is the minimum number of cell border crosses on a path from one cell to another.It is easy to see that the number of cells affected by a magic effect grows rapidly when n increases, so it can adversely affect the game performance. That\'s why Petya decided to write a program that can, given n, determine the number of cells that should be repainted after effect application, so that game designers can balance scale of the effects and the game performance. Help him to do it. Find the number of hexagons situated not farther than n cells away from a given cell." 1100

630C "Lucky Numbers" combinatorics,math "The numbers of all offices in the new building of the Tax Office of IT City will have lucky numbers.Lucky number is a number that consists of digits 7 and 8 only. Find the maximum number of offices in the new building of the Tax Office given that a door-plate can hold a number not longer than n digits." 1100

630B "Moore\'s Law" math "The numbers of all offices in the new building of the Tax Office of IT City will have lucky numbers.Lucky number is a number that consists of digits 7 and 8 only. Find the maximum number of offices in the new building of the Tax Office given that a door-plate can hold a number not longer than n digits." 1200

630A "Again Twenty Five!" "number theory" "The HR manager was disappointed again. The last applicant failed the interview the same way as 24 previous ones. ""Do I give such a hard task?"" \xe2\x80\x94 the HR manager thought. ""Just raise number 5 to the power of n and get last two digits of the number. Yes, of course, n can be rather big, and one cannot find the power using a calculator, but we need people who are able to think, not just follow the instructions.""Could you pass the interview in the machine vision company in IT City?" 800

629E "Famil Door and Roads" "combinatorics,data structures,dfs and similar,dp,probabilities,trees" "Famil Door\xe2\x80\x99s City map looks like a tree (undirected connected acyclic graph) so other people call it Treeland. There are n intersections in the city connected by n\xe2\x80\x89-\xe2\x80\x891 bidirectional roads.There are m friends of Famil Door living in the city. The i-th friend lives at the intersection ui and works at the intersection vi. Everyone in the city is unhappy because there is exactly one simple path between their home and work.Famil Door plans to construct exactly one new road and he will randomly choose one among n\xc2\xb7(n\xe2\x80\x89-\xe2\x80\x891)\xe2\x80\x89/\xe2\x80\x892 possibilities. Note, that he may even build a new road between two cities that are already connected by one.He knows, that each of his friends will become happy, if after Famil Door constructs a new road there is a path from this friend home to work and back that doesn\'t visit the same road twice. Formally, there is a simple cycle containing both ui and vi. Moreover, if the friend becomes happy, his pleasure is equal to the length of such path (it\'s easy to see that it\'s unique). For each of his friends Famil Door wants to know his expected pleasure, that is the expected length of the cycle containing both ui and vi if we consider only cases when such a cycle exists." 2300

629D "Babaei and Birthday Cake" "data structures,dp" "As you know, every birthday party has a cake! This time, Babaei is going to prepare the very special birthday party\'s cake.Simple cake is a cylinder of some radius and height. The volume of the simple cake is equal to the volume of corresponding cylinder. Babaei has n simple cakes and he is going to make a special cake placing some cylinders on each other.However, there are some additional culinary restrictions. The cakes are numbered in such a way that the cake number i can be placed only on the table or on some cake number j where j\xe2\x80\x89<\xe2\x80\x89i. Moreover, in order to impress friends Babaei will put the cake i on top of the cake j only if the volume of the cake i is strictly greater than the volume of the cake j.Babaei wants to prepare a birthday cake that has a maximum possible total volume. Help him find this value." 2000

629C "Famil Door and Brackets" dp,strings "As Famil Door\xe2\x80\x99s birthday is coming, some of his friends (like Gabi) decided to buy a present for him. His friends are going to buy a string consisted of round brackets since Famil Door loves string of brackets of length n more than any other strings!The sequence of round brackets is called valid if and only if:   the total number of opening brackets is equal to the total number of closing brackets;  for any prefix of the sequence, the number of opening brackets is greater or equal than the number of closing brackets. Gabi bought a string s of length m (m\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) and want to complete it to obtain a valid sequence of brackets of length n. He is going to pick some strings p and q consisting of round brackets and merge them in a string p\xe2\x80\x89+\xe2\x80\x89s\xe2\x80\x89+\xe2\x80\x89q, that is add the string p at the beginning of the string s and string q at the end of the string s.Now he wonders, how many pairs of strings p and q exists, such that the string p\xe2\x80\x89+\xe2\x80\x89s\xe2\x80\x89+\xe2\x80\x89q is a valid sequence of round brackets. As this number may be pretty large, he wants to calculate it modulo 109\xe2\x80\x89+\xe2\x80\x897." 2000

629B "Far Relative\xe2\x80\x99s Problem" "brute force" "As Famil Door\xe2\x80\x99s birthday is coming, some of his friends (like Gabi) decided to buy a present for him. His friends are going to buy a string consisted of round brackets since Famil Door loves string of brackets of length n more than any other strings!The sequence of round brackets is called valid if and only if:   the total number of opening brackets is equal to the total number of closing brackets;  for any prefix of the sequence, the number of opening brackets is greater or equal than the number of closing brackets. Gabi bought a string s of length m (m\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) and want to complete it to obtain a valid sequence of brackets of length n. He is going to pick some strings p and q consisting of round brackets and merge them in a string p\xe2\x80\x89+\xe2\x80\x89s\xe2\x80\x89+\xe2\x80\x89q, that is add the string p at the beginning of the string s and string q at the end of the string s.Now he wonders, how many pairs of strings p and q exists, such that the string p\xe2\x80\x89+\xe2\x80\x89s\xe2\x80\x89+\xe2\x80\x89q is a valid sequence of round brackets. As this number may be pretty large, he wants to calculate it modulo 109\xe2\x80\x89+\xe2\x80\x897." 1100

629A "Far Relative\xe2\x80\x99s Birthday Cake" "brute force,combinatorics,constructive algorithms,implementation" "As Famil Door\xe2\x80\x99s birthday is coming, some of his friends (like Gabi) decided to buy a present for him. His friends are going to buy a string consisted of round brackets since Famil Door loves string of brackets of length n more than any other strings!The sequence of round brackets is called valid if and only if:   the total number of opening brackets is equal to the total number of closing brackets;  for any prefix of the sequence, the number of opening brackets is greater or equal than the number of closing brackets. Gabi bought a string s of length m (m\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) and want to complete it to obtain a valid sequence of brackets of length n. He is going to pick some strings p and q consisting of round brackets and merge them in a string p\xe2\x80\x89+\xe2\x80\x89s\xe2\x80\x89+\xe2\x80\x89q, that is add the string p at the beginning of the string s and string q at the end of the string s.Now he wonders, how many pairs of strings p and q exists, such that the string p\xe2\x80\x89+\xe2\x80\x89s\xe2\x80\x89+\xe2\x80\x89q is a valid sequence of round brackets. As this number may be pretty large, he wants to calculate it modulo 109\xe2\x80\x89+\xe2\x80\x897." 800

628F "Bear and Fair Set" flows,graphs "Limak is a grizzly bear. He is big and dreadful. You were chilling in the forest when you suddenly met him. It\'s very unfortunate for you. He will eat all your cookies unless you can demonstrate your mathematical skills. To test you, Limak is going to give you a puzzle to solve.It\'s a well-known fact that Limak, as every bear, owns a set of numbers. You know some information about the set:  The elements of the set are distinct positive integers.  The number of elements in the set is n. The number n is divisible by 5.  All elements are between 1 and b, inclusive: bears don\'t know numbers greater than b.  For each r in {0,\xe2\x80\x891,\xe2\x80\x892,\xe2\x80\x893,\xe2\x80\x894}, the set contains exactly  elements that give remainder r when divided by 5. (That is, there are  elements divisible by 5,  elements of the form 5k\xe2\x80\x89+\xe2\x80\x891,  elements of the form 5k\xe2\x80\x89+\xe2\x80\x892, and so on.) Limak smiles mysteriously and gives you q hints about his set. The i-th hint is the following sentence: ""If you only look at elements that are between 1 and upToi, inclusive, you will find exactly quantityi such elements in my set.""In a moment Limak will tell you the actual puzzle, but something doesn\'t seem right... That smile was very strange. You start to think about a possible reason. Maybe Limak cheated you? Or is he a fair grizzly bear?Given n, b, q and hints, check whether Limak can be fair, i.e. there exists at least one set satisfying the given conditions. If it\'s possible then print \'\'fair"". Otherwise, print \'\'unfair""." 2500

628E "Zbazi in Zeydabad" "data structures,implementation" "A tourist wants to visit country Zeydabad for Zbazi (a local game in Zeydabad).The country Zeydabad is a rectangular table consisting of n rows and m columns. Each cell on the country is either \'z\' or \'.\'.The tourist knows this country is named Zeydabad because there are lots of \'\'Z-pattern""s in the country. A \'\'Z-pattern"" is a square which anti-diagonal is completely filled with \'z\' and its upper and lower rows are also completely filled with \'z\'. All other cells of a square can be arbitrary.  Note that a \'\'Z-pattern"" can consist of only one cell (see the examples).So he wants to count the number of \'\'Z-pattern""s in the country (a necessary skill for Zbazi).Now your task is to help tourist with counting number of \'\'Z-pattern""s.As input/output can reach huge size it is recommended to use fast input/output methods: for example, prefer to use gets/scanf/printf instead of getline/cin/cout in C++, prefer to use BufferedReader/PrintWriter instead of Scanner/System.out in Java." 2300

628D "Magic Numbers" dp "Consider the decimal presentation of an integer. Let\'s call a number d-magic if digit d appears in decimal presentation of the number on even positions and nowhere else.For example, the numbers 1727374, 17, 1 are 7-magic but 77, 7, 123, 34, 71 are not 7-magic. On the other hand the number 7 is 0-magic, 123 is 2-magic, 34 is 4-magic and 71 is 1-magic.Find the number of d-magic numbers in the segment [a,\xe2\x80\x89b] that are multiple of m. Because the answer can be very huge you should only find its value modulo 109\xe2\x80\x89+\xe2\x80\x897 (so you should find the remainder after dividing by 109\xe2\x80\x89+\xe2\x80\x897)." 2200

628C "Bear and String Distance" greedy,strings "Limak is a little polar bear. He likes nice strings \xe2\x80\x94 strings of length n, consisting of lowercase English letters only.The distance between two letters is defined as the difference between their positions in the alphabet. For example, , and .Also, the distance between two nice strings is defined as the sum of distances of corresponding letters. For example, , and .Limak gives you a nice string s and an integer k. He challenges you to find any nice string s\' that . Find any s\' satisfying the given conditions, or print ""-1"" if it\'s impossible to do so.As input/output can reach huge size it is recommended to use fast input/output methods: for example, prefer to use gets/scanf/printf instead of getline/cin/cout in C++, prefer to use BufferedReader/PrintWriter instead of Scanner/System.out in Java." 1300

628B "New Skateboard" dp "Max wants to buy a new skateboard. He has calculated the amount of money that is needed to buy a new skateboard. He left a calculator on the floor and went to ask some money from his parents. Meanwhile his little brother Yusuf came and started to press the keys randomly. Unfortunately Max has forgotten the number which he had calculated. The only thing he knows is that the number is divisible by 4.You are given a string s consisting of digits (the number on the display of the calculator after Yusuf randomly pressed the keys). Your task is to find the number of substrings which are divisible by 4. A substring can start with a zero.A substring of a string is a nonempty sequence of consecutive characters.For example if string s is 124 then we have four substrings that are divisible by 4: 12, 4, 24 and 124. For the string 04 the answer is three: 0, 4, 04.As input/output can reach huge size it is recommended to use fast input/output methods: for example, prefer to use gets/scanf/printf instead of getline/cin/cout in C++, prefer to use BufferedReader/PrintWriter instead of Scanner/System.out in Java." 1300

628A "Tennis Tournament" implementation,math "A tennis tournament with n participants is running. The participants are playing by an olympic system, so the winners move on and the losers drop out.The tournament takes place in the following way (below, m is the number of the participants of the current round):  let k be the maximal power of the number 2 such that k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m,  k participants compete in the current round and a half of them passes to the next round, the other m\xe2\x80\x89-\xe2\x80\x89k participants pass to the next round directly,  when only one participant remains, the tournament finishes. Each match requires b bottles of water for each participant and one bottle for the judge. Besides p towels are given to each participant for the whole tournament.Find the number of bottles and towels needed for the tournament.Note that it\'s a tennis tournament so in each match two participants compete (one of them will win and the other will lose)." 1000

627F "Island Puzzle" "dfs and similar,dsu,graphs,trees" "A remote island chain contains n islands, labeled 1 through n. Bidirectional bridges connect the islands to form a simple cycle�\xe2\x80\x94 a bridge connects islands 1 and 2, islands 2 and 3, and so on, and additionally a bridge connects islands n and 1. The center of each island contains an identical pedestal, and all but one of the islands has a fragile, uniquely colored statue currently held on the pedestal. The remaining island holds only an empty pedestal.The islanders want to rearrange the statues in a new order. To do this, they repeat the following process: First, they choose an island directly adjacent to the island containing an empty pedestal. Then, they painstakingly carry the statue on this island across the adjoining bridge and place it on the empty pedestal.Determine if it is possible for the islanders to arrange the statues in the desired order." 3400

627E Orchestra "two pointers" "Paul is at the orchestra. The string section is arranged in an r\xe2\x80\x89\xc3\x97\xe2\x80\x89c rectangular grid and is filled with violinists with the exception of n violists. Paul really likes violas, so he would like to take a picture including at least k of them. Paul can take a picture of any axis-parallel rectangle in the orchestra. Count the number of possible pictures that Paul can take.Two pictures are considered to be different if the coordinates of corresponding rectangles are different." 3000

627D "Preorder Test" "binary search,dfs and similar,dp,graphs,greedy,trees" "For his computer science class, Jacob builds a model tree with sticks and balls containing n nodes in the shape of a tree. Jacob has spent ai minutes building the i-th ball in the tree.Jacob\'s teacher will evaluate his model and grade Jacob based on the effort he has put in. However, she does not have enough time to search his whole tree to determine this; Jacob knows that she will examine the first k nodes in a DFS-order traversal of the tree. She will then assign Jacob a grade equal to the minimum ai she finds among those k nodes.Though Jacob does not have enough time to rebuild his model, he can choose the root node that his teacher starts from. Furthermore, he can rearrange the list of neighbors of each node in any order he likes. Help Jacob find the best grade he can get on this assignment.A DFS-order traversal is an ordering of the nodes of a rooted tree, built by a recursive DFS-procedure initially called on the root of the tree. When called on a given node v, the procedure does the following:   Print v.  Traverse the list of neighbors of the node v in order and iteratively call DFS-procedure on each one. Do not call DFS-procedure on node u if you came to node v directly from u." 2600

627C "Package Delivery" "data structures,divide and conquer,greedy" "Johnny drives a truck and must deliver a package from his hometown to the district center. His hometown is located at point 0 on a number line, and the district center is located at the point d.Johnny\'s truck has a gas tank that holds exactly n liters, and his tank is initially full. As he drives, the truck consumes exactly one liter per unit distance traveled. Moreover, there are m gas stations located at various points along the way to the district center. The i-th station is located at the point xi on the number line and sells an unlimited amount of fuel at a price of pi dollars per liter. Find the minimum cost Johnny must pay for fuel to successfully complete the delivery." 2200

627B "Factory Repairs" "data structures" "A factory produces thimbles in bulk. Typically, it can produce up to a thimbles a day. However, some of the machinery is defective, so it can currently only produce b thimbles each day. The factory intends to choose a k-day period to do maintenance and construction; it cannot produce any thimbles during this time, but will be restored to its full production of a thimbles per day after the k days are complete.Initially, no orders are pending. The factory receives updates of the form di, ai, indicating that ai new orders have been placed for the di-th day. Each order requires a single thimble to be produced on precisely the specified day. The factory may opt to fill as many or as few of the orders in a single batch as it likes.As orders come in, the factory owner would like to know the maximum number of orders he will be able to fill if he starts repairs on a given day pi. Help the owner answer his questions." 1700

627A "XOR Equation" dp,math "Two positive integers a and b have a sum of s and a bitwise XOR of x. How many possible values are there for the ordered pair (a,\xe2\x80\x89b)?" 1700

626G Raffles "data structures,dp,greedy,math" "Johnny is at a carnival which has n raffles. Raffle i has a prize with value pi. Each participant can put tickets in whichever raffles they choose (they may have more than one ticket in a single raffle). At the end of the carnival, one ticket is selected at random from each raffle, and the owner of the ticket wins the associated prize. A single person can win multiple prizes from different raffles. However, county rules prevent any one participant from owning more than half the tickets in a single raffle, i.e. putting more tickets in the raffle than all the other participants combined. To help combat this (and possibly win some prizes), the organizers started by placing a single ticket in each raffle, which they will never remove.Johnny bought t tickets and is wondering where to place them. Currently, there are a total of li tickets in the i-th raffle. He watches as other participants place tickets and modify their decisions and, at every moment in time, wants to know how much he can possibly earn. Find the maximum possible expected value of Johnny\'s winnings at each moment if he distributes his tickets optimally. Johnny may redistribute all of his tickets arbitrarily between each update, but he may not place more than t tickets total or have more tickets in a single raffle than all other participants combined." 3100

626F "Group Projects" dp "There are n students in a class working on group projects. The students will divide into groups (some students may be in groups alone), work on their independent pieces, and then discuss the results together. It takes the i-th student ai minutes to finish his/her independent piece.If students work at different paces, it can be frustrating for the faster students and stressful for the slower ones. In particular, the imbalance of a group is defined as the maximum ai in the group minus the minimum ai in the group. Note that a group containing a single student has an imbalance of 0. How many ways are there for the students to divide into groups so that the total imbalance of all groups is at most k?Two divisions are considered distinct if there exists a pair of students who work in the same group in one division but different groups in the other." 2400

626E "Simple Skewness" "binary search,math,ternary search" "Define the simple skewness of a collection of numbers to be the collection\'s mean minus its median. You are given a list of n (not necessarily distinct) integers. Find the non-empty subset (with repetition) with the maximum simple skewness.The mean of a collection is the average of its elements. The median of a collection is its middle element when all of its elements are sorted, or the average of its two middle elements if it has even size." 2400

626D "Jerry\'s Protest" "brute force,combinatorics,dp,probabilities" "Define the simple skewness of a collection of numbers to be the collection\'s mean minus its median. You are given a list of n (not necessarily distinct) integers. Find the non-empty subset (with repetition) with the maximum simple skewness.The mean of a collection is the average of its elements. The median of a collection is its middle element when all of its elements are sorted, or the average of its two middle elements if it has even size." 1800

626C "Block Towers" "brute force,greedy,math,number theory" "Students in a class are making towers of blocks. Each student makes a (non-zero) tower by stacking pieces lengthwise on top of each other. n of the students use pieces made of two blocks and m of the students use pieces made of three blocks.The students don\xe2\x80\x99t want to use too many blocks, but they also want to be unique, so no two students\xe2\x80\x99 towers may contain the same number of blocks. Find the minimum height necessary for the tallest of the students\' towers." 1600

626B Cards "constructive algorithms,dp,math" "Catherine has a deck of n cards, each of which is either red, green, or blue. As long as there are at least two cards left, she can do one of two actions:   take any two (not necessarily adjacent) cards with different colors and exchange them for a new card of the third color;  take any two (not necessarily adjacent) cards with the same color and exchange them for a new card with that color. She repeats this process until there is only one card left. What are the possible colors for the final card?" 1300

626A "Robot Sequence" "brute force,implementation" "Calvin the robot lies in an infinite rectangular grid. Calvin\'s source code contains a list of n commands, each either \'U\', \'R\', \'D\', or \'L\'�\xe2\x80\x94 instructions to move a single square up, right, down, or left, respectively. How many ways can Calvin execute a non-empty contiguous substrings of commands and return to the same square he starts in? Two substrings are considered different if they have different starting or ending indices." 1000

625E "Frog Fights" "data structures,greedy" "Ostap Bender recently visited frog farm and was inspired to create his own frog game.Number of frogs are places on a cyclic gameboard, divided into m cells. Cells are numbered from 1 to m, but the board is cyclic, so cell number 1 goes right after the cell number m in the direction of movement. i-th frog during its turn can jump for ai cells.Frogs move in turns, game starts with a move by frog 1. On its turn i-th frog moves ai cells forward, knocking out all the frogs on its way. If there is a frog in the last cell of the path of the i-th frog, that frog is also knocked out. After this the value ai is decreased by the number of frogs that were knocked out during this turn. If ai is zero or goes negative, then i-th frog doesn\'t make moves anymore.After frog number 1 finishes its turn, frog number 2 starts to move, then frog number 3 and so on. After the frog number n makes its move, frog 1 starts to move again, then frog 2 and so on this process goes forever. If some frog was already knocked out from the board, we consider that it skips all its moves.Help Ostap to identify, what frogs will stay on the board at the end of a game?" 2800

625D "Finals in arithmetic" "constructive algorithms,implementation,math" "Vitya is studying in the third grade. During the last math lesson all the pupils wrote on arithmetic quiz. Vitya is a clever boy, so he managed to finish all the tasks pretty fast and Oksana Fillipovna gave him a new one, that is much harder.Let\'s denote a flip operation of an integer as follows: number is considered in decimal notation and then reverted. If there are any leading zeroes afterwards, they are thrown away. For example, if we flip 123 the result is the integer 321, but flipping 130 we obtain 31, and by flipping 31 we come to 13.Oksana Fillipovna picked some number a without leading zeroes, and flipped it to get number ar. Then she summed a and ar, and told Vitya the resulting value n. His goal is to find any valid a.As Oksana Fillipovna picked some small integers as a and ar, Vitya managed to find the answer pretty fast and became interested in finding some general algorithm to deal with this problem. Now, he wants you to write the program that for given n finds any a without leading zeroes, such that a\xe2\x80\x89+\xe2\x80\x89ar\xe2\x80\x89=\xe2\x80\x89n or determine that such a doesn\'t exist." 2400

625C "K-special Tables" "constructive algorithms,implementation" "People do many crazy things to stand out in a crowd. Some of them dance, some learn by heart rules of Russian language, some try to become an outstanding competitive programmers, while others collect funny math objects.Alis is among these collectors. Right now she wants to get one of k-special tables. In case you forget, the table n\xe2\x80\x89\xc3\x97\xe2\x80\x89n is called k-special if the following three conditions are satisfied:  every integer from 1 to n2 appears in the table exactly once;  in each row numbers are situated in increasing order;  the sum of numbers in the k-th column is maximum possible. Your goal is to help Alice and find at least one k-special table of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89n. Both rows and columns are numbered from 1 to n, with rows numbered from top to bottom and columns numbered from left to right." 1300

625B "War of the Corporations" "constructive algorithms,greedy,strings" "A long time ago, in a galaxy far far away two giant IT-corporations Pineapple and Gogol continue their fierce competition. Crucial moment is just around the corner: Gogol is ready to release it\'s new tablet Lastus 3000.This new device is equipped with specially designed artificial intelligence (AI). Employees of Pineapple did their best to postpone the release of Lastus 3000 as long as possible. Finally, they found out, that the name of the new artificial intelligence is similar to the name of the phone, that Pineapple released 200 years ago. As all rights on its name belong to Pineapple, they stand on changing the name of Gogol\'s artificial intelligence.Pineapple insists, that the name of their phone occurs in the name of AI as a substring. Because the name of technology was already printed on all devices, the Gogol\'s director decided to replace some characters in AI name with ""#"". As this operation is pretty expensive, you should find the minimum number of characters to replace with ""#"", such that the name of AI doesn\'t contain the name of the phone as a substring.Substring is a continuous subsequence of a string." 1200

625A "Guest From the Past" implementation,math "Kolya Gerasimov loves kefir very much. He lives in year 1984 and knows all the details of buying this delicious drink. One day, as you probably know, he found himself in year 2084, and buying kefir there is much more complicated.Kolya is hungry, so he went to the nearest milk shop. In 2084 you may buy kefir in a plastic liter bottle, that costs a rubles, or in glass liter bottle, that costs b rubles. Also, you may return empty glass bottle and get c (c\xe2\x80\x89<\xe2\x80\x89b) rubles back, but you cannot return plastic bottles.Kolya has n rubles and he is really hungry, so he wants to drink as much kefir as possible. There were no plastic bottles in his 1984, so Kolya doesn\'t know how to act optimally and asks for your help." 1700

624B "Making a String" greedy,sortings "You are given an alphabet consisting of n letters, your task is to make a string of the maximum possible length so that the following conditions are satisfied:   the i-th letter occurs in the string no more than ai times;  the number of occurrences of each letter in the string must be distinct for all the letters that occurred in the string at least once." 1100

624A "Save Luke" math "Luke Skywalker got locked up in a rubbish shredder between two presses. R2D2 is already working on his rescue, but Luke needs to stay alive as long as possible. For simplicity we will assume that everything happens on a straight line, the presses are initially at coordinates 0 and L, and they move towards each other with speed v1 and v2, respectively. Luke has width d and is able to choose any position between the presses. Luke dies as soon as the distance between the presses is less than his width. Your task is to determine for how long Luke can stay alive." 800

623E "Transforming Sequence" combinatorics,dp,fft,math "Let\'s define the transformation P of a sequence of integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an as b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bn, where bi\xe2\x80\x89=\xe2\x80\x89a1�|�a2�|�...�|�ai for all i\xe2\x80\x89=\xe2\x80\x891,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89n, where | is the bitwise OR operation.Vasya consequently applies the transformation P to all sequences of length n consisting of integers from 1 to 2k\xe2\x80\x89-\xe2\x80\x891 inclusive. He wants to know how many of these sequences have such property that their transformation is a strictly increasing sequence. Help him to calculate this number modulo 109\xe2\x80\x89+\xe2\x80\x897." 3300

623D Birthday greedy,math,probabilities "A MIPT student named Misha has a birthday today, and he decided to celebrate it in his country house in suburban Moscow. n friends came by, and after a typical party they decided to play blind man\'s buff.The birthday boy gets blindfolded and the other players scatter around the house. The game is played in several rounds. In each round, Misha catches exactly one of his friends and has to guess who it is. The probability of catching the i-th friend does not change between rounds and is equal to pi percent (as we know, it is directly proportional to the amount of alcohol consumed by the i-th friend) and p1\xe2\x80\x89+\xe2\x80\x89p2\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89pn\xe2\x80\x89=\xe2\x80\x89100 holds. Misha has no information about who he caught. After Misha makes an attempt to guess the caught person, the round ends. Even then, Misha isn\'t told whether he guessed correctly, and a new round begins.The game ends when Misha guesses every friend at least once, that is, there exists such set of rounds k1,\xe2\x80\x89k2,\xe2\x80\x89...,\xe2\x80\x89kn, that during round number ki Misha caught the i-th friend and guessed him. Misha wants to minimize the expectation of the number of rounds of the game. Despite the fact that at any point in the game Misha has no information about who he has already guessed, his friends are honest, and if they see that the condition for the end of the game is fulfilled, the game ends immediately. Find the expectation of the number of rounds in the game if Misha plays optimally." 2700

623C "Electric Charges" "binary search,dp" "Programmer Sasha is a student at MIPT (Moscow Institute of Physics and Technology) and he needs to make a laboratory work to pass his finals.A laboratory unit is a plane with standard coordinate axes marked on it. Physicists from Moscow Institute of Physics and Technology charged the axes by large electric charges: axis X is positive and axis Y is negative.Experienced laboratory worker marked n points with integer coordinates (xi,\xe2\x80\x89yi) on the plane and stopped the time. Sasha should use ""atomic tweezers"" to place elementary particles in these points. He has an unlimited number of electrons (negatively charged elementary particles) and protons (positively charged elementary particles). He can put either an electron or a proton at each marked point. As soon as all marked points are filled with particles, laboratory worker will turn on the time again and the particles will come in motion and after some time they will stabilize in equilibrium. The objective of the laboratory work is to arrange the particles in such a way, that the diameter of the resulting state (the maximum distance between the pairs of points of the set) is as small as possible.Since Sasha is a programmer, he naively thinks that all the particles will simply ""fall"" into their projections on the corresponding axes: electrons will fall on axis X, while protons will fall on axis Y. As we are programmers too, we will consider the same model as Sasha. That is, a particle gets from point (x,\xe2\x80\x89y) to point (x,\xe2\x80\x890) if it is an electron and to point (0,\xe2\x80\x89y) if it is a proton.As the laboratory has high background radiation and Sasha takes care of his laptop, he did not take it with him, and now he can\'t write a program that computes the minimum possible diameter of the resulting set. Therefore, you will have to do it for him.Print a square of the minimum possible diameter of the set." 2900

623B "Array GCD" "dp,greedy,number theory" "You are given array ai of length n. You may consecutively apply two operations to this array:  remove some subsegment (continuous subsequence) of length m\xe2\x80\x89<\xe2\x80\x89n and pay for it m\xc2\xb7a coins;  change some elements of the array by at most 1, and pay b coins for each change. Please note that each of operations may be applied at most once (and may be not applied at all) so you can remove only one segment and each number may be changed (increased or decreased) by at most 1. Also note, that you are not allowed to delete the whole array.Your goal is to calculate the minimum number of coins that you need to spend in order to make the greatest common divisor of the elements of the resulting array be greater than 1." 2300

623A "Graph and String" "constructive algorithms,graphs" "One day student Vasya was sitting on a lecture and mentioned a string s1s2... sn, consisting of letters ""a"", ""b"" and ""c"" that was written on his desk. As the lecture was boring, Vasya decided to complete the picture by composing a graph G with the following properties:   G has exactly n vertices, numbered from 1 to n.  For all pairs of vertices i and j, where i\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89j, there is an edge connecting them if and only if characters si and sj are either equal or neighbouring in the alphabet. That is, letters in pairs ""a""-""b"" and ""b""-""c"" are neighbouring, while letters ""a""-""c"" are not. Vasya painted the resulting graph near the string and then erased the string. Next day Vasya\'s friend Petya came to a lecture and found some graph at his desk. He had heard of Vasya\'s adventure and now he wants to find out whether it could be the original graph G, painted by Vasya. In order to verify this, Petya needs to know whether there exists a string s, such that if Vasya used this s he would produce the given graph G." 1800

622F "The Sum of the k-th Powers" math "There are well-known formulas: , , . Also mathematicians found similar formulas for higher degrees.Find the value of the sum  modulo 109\xe2\x80\x89+\xe2\x80\x897 (so you should find the remainder after dividing the answer by the value 109\xe2\x80\x89+\xe2\x80\x897)." 2600

622E "Ants in Leaves" "dfs and similar,greedy,sortings,trees" "Tree is a connected graph without cycles. A leaf of a tree is any vertex connected with exactly one other vertex.You are given a tree with n vertices and a root in the vertex 1. There is an ant in each leaf of the tree. In one second some ants can simultaneously go to the parent vertex from the vertex they were in. No two ants can be in the same vertex simultaneously except for the root of the tree.Find the minimal time required for all ants to be in the root of the tree. Note that at start the ants are only in the leaves of the tree." 2200

622D "Optimal Number Permutation" "constructive algorithms" "You have array a that contains all integers from 1 to n twice. You can arbitrary permute any numbers in a.Let number i be in positions xi,\xe2\x80\x89yi (xi\xe2\x80\x89<\xe2\x80\x89yi) in the permuted array a. Let\'s define the value di\xe2\x80\x89=\xe2\x80\x89yi\xe2\x80\x89-\xe2\x80\x89xi \xe2\x80\x94 the distance between the positions of the number i. Permute the numbers in array a to minimize the value of the sum ." 1900

622C "Not Equal on a Segment" "data structures,implementation" "You are given array a with n integers and m queries. The i-th query is given with three integers li,\xe2\x80\x89ri,\xe2\x80\x89xi.For the i-th query find any position pi (li\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89pi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ri) so that api\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89xi." 1700

622B "The Time" implementation "You are given the current time in 24-hour format hh:mm. Find and print the time after a minutes.Note that you should find only the time after a minutes, see the examples to clarify the problem statement.You can read more about 24-hour format here https://en.wikipedia.org/wiki/24-hour_clock." 900

622A "Infinite Sequence" implementation,math "Consider the infinite sequence of integers: 1,\xe2\x80\x891,\xe2\x80\x892,\xe2\x80\x891,\xe2\x80\x892,\xe2\x80\x893,\xe2\x80\x891,\xe2\x80\x892,\xe2\x80\x893,\xe2\x80\x894,\xe2\x80\x891,\xe2\x80\x892,\xe2\x80\x893,\xe2\x80\x894,\xe2\x80\x895.... The sequence is built in the following way: at first the number 1 is written out, then the numbers from 1 to 2, then the numbers from 1 to 3, then the numbers from 1 to 4 and so on. Note that the sequence contains numbers, not digits. For example number 10 first appears in the sequence in position 55 (the elements are numerated from one).Find the number on the n-th position of the sequence." 1000

621E "Wet Shark and Blocks" dp,matrices "There are b blocks of digits. Each one consisting of the same n digits, which are given to you in the input. Wet Shark must choose exactly one digit from each block and concatenate all of those digits together to form one large integer. For example, if he chooses digit 1 from the first block and digit 2 from the second block, he gets the integer 12. Wet Shark then takes this number modulo x. Please, tell him how many ways he can choose one digit from each block so that he gets exactly k as the final result. As this number may be too large, print it modulo 109\xe2\x80\x89+\xe2\x80\x897.Note, that the number of ways to choose some digit in the block is equal to the number of it\'s occurrences. For example, there are 3 ways to choose digit 5 from block 3 5 6 7 8 9 5 1 1 1 1 5." 2000

621D "Rat Kwesh and Cheese" "brute force,constructive algorithms,math" "Wet Shark asked Rat Kwesh to generate three positive real numbers x, y and z, from 0.1 to 200.0, inclusive. Wet Krash wants to impress Wet Shark, so all generated numbers will have exactly one digit after the decimal point.Wet Shark knows Rat Kwesh will want a lot of cheese. So he will give the Rat an opportunity to earn a lot of cheese. He will hand the three numbers x, y and z to Rat Kwesh, and Rat Kwesh will pick one of the these twelve options:  a1\xe2\x80\x89=\xe2\x80\x89xyz;  a2\xe2\x80\x89=\xe2\x80\x89xzy;  a3\xe2\x80\x89=\xe2\x80\x89(xy)z;  a4\xe2\x80\x89=\xe2\x80\x89(xz)y;  a5\xe2\x80\x89=\xe2\x80\x89yxz;  a6\xe2\x80\x89=\xe2\x80\x89yzx;  a7\xe2\x80\x89=\xe2\x80\x89(yx)z;  a8\xe2\x80\x89=\xe2\x80\x89(yz)x;  a9\xe2\x80\x89=\xe2\x80\x89zxy;  a10\xe2\x80\x89=\xe2\x80\x89zyx;  a11\xe2\x80\x89=\xe2\x80\x89(zx)y;  a12\xe2\x80\x89=\xe2\x80\x89(zy)x. Let m be the maximum of all the ai, and c be the smallest index (from 1 to 12) such that ac\xe2\x80\x89=\xe2\x80\x89m. Rat\'s goal is to find that c, and he asks you to help him. Rat Kwesh wants to see how much cheese he gets, so he you will have to print the expression corresponding to that ac." 2400

621C "Wet Shark and Flowers" "combinatorics,math,number theory,probabilities" "There are n sharks who grow flowers for Wet Shark. They are all sitting around the table, such that sharks i and i\xe2\x80\x89+\xe2\x80\x891 are neighbours for all i from 1 to n\xe2\x80\x89-\xe2\x80\x891. Sharks n and 1 are neighbours too.Each shark will grow some number of flowers si. For i-th shark value si is random integer equiprobably chosen in range from li to ri. Wet Shark has it\'s favourite prime number p, and he really likes it! If for any pair of neighbouring sharks i and j the product si\xc2\xb7sj is divisible by p, then Wet Shark becomes happy and gives 1000 dollars to each of these sharks.At the end of the day sharks sum all the money Wet Shark granted to them. Find the expectation of this value." 1700

621B "Wet Shark and Bishops" combinatorics,implementation "Today, Wet Shark is given n bishops on a 1000 by 1000 grid. Both rows and columns of the grid are numbered from 1 to 1000. Rows are numbered from top to bottom, while columns are numbered from left to right.Wet Shark thinks that two bishops attack each other if they share the same diagonal. Note, that this is the only criteria, so two bishops may attack each other (according to Wet Shark) even if there is another bishop located between them. Now Wet Shark wants to count the number of pairs of bishops that attack each other." 1300

621A "Wet Shark and Odd and Even" implementation "Today, Wet Shark is given n integers. Using any of these integers no more than once, Wet Shark wants to get maximum possible even (divisible by 2) sum. Please, calculate this value for Wet Shark. Note, that if Wet Shark uses no integers from the n integers, the sum is an even integer 0." 900

620F "Xors on Segments" "data structures,strings,trees" "You are given an array with n integers ai and m queries. Each query is described by two integers (lj,\xe2\x80\x89rj).Let\'s define the function . The function is defined for only u\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89v.For each query print the maximal value of the function f(ax,\xe2\x80\x89ay) over all lj\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x,\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89rj,\xe2\x80\x89 ax\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ay." 2800

620E "New Year Tree" "bitmasks,data structures,trees" "The New Year holidays are over, but Resha doesn\'t want to throw away the New Year tree. He invited his best friends Kerim and Gural to help him to redecorate the New Year tree.The New Year tree is an undirected tree with n vertices and root in the vertex 1.You should process the queries of the two types:  Change the colours of all vertices in the subtree of the vertex v to the colour c.  Find the number of different colours in the subtree of the vertex v." 2100

620D "Professor GukiZ and Two Arrays" "binary search,two pointers" "Professor GukiZ has two arrays of integers, a and b. Professor wants to make the sum of the elements in the array a sa as close as possible to the sum of the elements in the array b sb. So he wants to minimize the value v\xe2\x80\x89=\xe2\x80\x89|sa\xe2\x80\x89-\xe2\x80\x89sb|.In one operation professor can swap some element from the array a and some element from the array b. For example if the array a is [5,\xe2\x80\x891,\xe2\x80\x893,\xe2\x80\x892,\xe2\x80\x894] and the array b is [3,\xe2\x80\x893,\xe2\x80\x892] professor can swap the element 5 from the array a and the element 2 from the array b and get the new array a [2,\xe2\x80\x891,\xe2\x80\x893,\xe2\x80\x892,\xe2\x80\x894] and the new array b [3,\xe2\x80\x893,\xe2\x80\x895].Professor doesn\'t want to make more than two swaps. Find the minimal value v and some sequence of no more than two swaps that will lead to the such value v. Professor makes swaps one by one, each new swap he makes with the new arrays a and b." 2200

620C "Pearls in a Row" greedy "There are n pearls in a row. Let\'s enumerate them with integers from 1 to n from the left to the right. The pearl number i has the type ai.Let\'s call a sequence of consecutive pearls a segment. Let\'s call a segment good if it contains two pearls of the same type.Split the row of the pearls to the maximal number of good segments. Note that each pearl should appear in exactly one segment of the partition.As input/output can reach huge size it is recommended to use fast input/output methods: for example, prefer to use scanf/printf instead of cin/cout in C++, prefer to use BufferedReader/PrintWriter instead of Scanner/System.out in Java." 1500

620B "Grandfather Dovlet\xe2\x80\x99s calculator" implementation "There are n pearls in a row. Let\'s enumerate them with integers from 1 to n from the left to the right. The pearl number i has the type ai.Let\'s call a sequence of consecutive pearls a segment. Let\'s call a segment good if it contains two pearls of the same type.Split the row of the pearls to the maximal number of good segments. Note that each pearl should appear in exactly one segment of the partition.As input/output can reach huge size it is recommended to use fast input/output methods: for example, prefer to use scanf/printf instead of cin/cout in C++, prefer to use BufferedReader/PrintWriter instead of Scanner/System.out in Java." 1000

620A "Professor GukiZ\'s Robot" implementation,math "There are n pearls in a row. Let\'s enumerate them with integers from 1 to n from the left to the right. The pearl number i has the type ai.Let\'s call a sequence of consecutive pearls a segment. Let\'s call a segment good if it contains two pearls of the same type.Split the row of the pearls to the maximal number of good segments. Note that each pearl should appear in exactly one segment of the partition.As input/output can reach huge size it is recommended to use fast input/output methods: for example, prefer to use scanf/printf instead of cin/cout in C++, prefer to use BufferedReader/PrintWriter instead of Scanner/System.out in Java." 800

618G "Combining Slimes" dp,math,matrices,probabilities "Your friend recently gave you some slimes for your birthday. You have a very large amount of slimes with value 1 and 2, and you decide to invent a game using these slimes.You initialize a row with n empty spaces. You also choose a number p to be used in the game. Then, you will perform the following steps while the last space is empty.   With probability , you will choose a slime with value 1, and with probability , you will choose a slime with value 2. You place the chosen slime on the last space of the board.  You will push the slime to the left as far as possible. If it encounters another slime, and they have the same value v, you will merge the slimes together to create a single slime with value v\xe2\x80\x89+\xe2\x80\x891. This continues on until the slime reaches the end of the board, or encounters a slime with a different value than itself. You have played the game a few times, but have gotten bored of it. You are now wondering, what is the expected sum of all values of the slimes on the board after you finish the game." 3300

618F "Double Knapsack" "constructive algorithms,two pointers" "You are given two multisets A and B. Each multiset has exactly n integers each between 1 and n inclusive. Multisets may contain multiple copies of the same number.You would like to find a nonempty subset of A and a nonempty subset of B such that the sum of elements in these subsets are equal. Subsets are also multisets, i.e. they can contain elements with equal values.If no solution exists, print \xe2\x80\x89-\xe2\x80\x891. Otherwise, print the indices of elements in any such subsets of A and B that have the same sum." 3000

618E "Robot Arm" "data structures,geometry" "Roger is a robot. He has an arm that is a series of n segments connected to each other. The endpoints of the i-th segment are initially located at points (i\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x890) and (i,\xe2\x80\x890). The endpoint at (i\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x890) is colored red and the endpoint at (i,\xe2\x80\x890) is colored blue for all segments. Thus, the blue endpoint of the i-th segment is touching the red endpoint of the (i\xe2\x80\x89+\xe2\x80\x891)-th segment for all valid i.Roger can move his arm in two different ways:   He can choose some segment and some value. This is denoted as choosing the segment number i and picking some positive l. This change happens as follows: the red endpoint of segment number i and segments from 1 to i\xe2\x80\x89-\xe2\x80\x891 are all fixed in place. Imagine a ray from the red endpoint to the blue endpoint. The blue endpoint and segments i\xe2\x80\x89+\xe2\x80\x891 through n are translated l units in the direction of this ray.   In this picture, the red point labeled A and segments before A stay in place, while the blue point labeled B and segments after B gets translated. He can choose a segment and rotate it. This is denoted as choosing the segment number i, and an angle a. The red endpoint of the i-th segment will stay fixed in place. The blue endpoint of that segment and segments i\xe2\x80\x89+\xe2\x80\x891 to n will rotate clockwise by an angle of a degrees around the red endpoint.   In this picture, the red point labeled A and segments before A stay in place, while the blue point labeled B and segments after B get rotated around point A. Roger will move his arm m times. These transformations are a bit complicated, and Roger easily loses track of where the blue endpoint of the last segment is. Help him compute the coordinates of the blue endpoint of the last segment after applying each operation. Note that these operations are cumulative, and Roger\'s arm may intersect itself arbitrarily during the moves." 2500

618D "Hamiltonian Spanning Tree" "dfs and similar,dp,graph matchings,greedy,trees" "A group of n cities is connected by a network of roads. There is an undirected road between every pair of cities, so there are  roads in total. It takes exactly y seconds to traverse any single road.A spanning tree is a set of roads containing exactly n\xe2\x80\x89-\xe2\x80\x891 roads such that it\'s possible to travel between any two cities using only these roads.Some spanning tree of the initial network was chosen. For every road in this tree the time one needs to traverse this road was changed from y to x seconds. Note that it\'s not guaranteed that x is smaller than y.You would like to travel through all the cities using the shortest path possible. Given n, x, y and a description of the spanning tree that was chosen, find the cost of the shortest path that starts in any city, ends in any city and visits all cities exactly once." 2200

618C Constellation geometry,implementation "Cat Noku has obtained a map of the night sky. On this map, he found a constellation with n stars numbered from 1 to n. For each i, the i-th star is located at coordinates (xi,\xe2\x80\x89yi). No two stars are located at the same position.In the evening Noku is going to take a look at the night sky. He would like to find three distinct stars and form a triangle. The triangle must have positive area. In addition, all other stars must lie strictly outside of this triangle. He is having trouble finding the answer and would like your help. Your job is to find the indices of three stars that would form a triangle that satisfies all the conditions. It is guaranteed that there is no line such that all stars lie on that line. It can be proven that if the previous condition is satisfied, there exists a solution to this problem." 1600

618B "Guess the Permutation" "constructive algorithms" "Bob has a permutation of integers from 1 to n. Denote this permutation as p. The i-th element of p will be denoted as pi. For all pairs of distinct integers i,\xe2\x80\x89j between 1 and n, he wrote the number ai,\xe2\x80\x89j\xe2\x80\x89=\xe2\x80\x89min(pi,\xe2\x80\x89pj). He writes ai,\xe2\x80\x89i\xe2\x80\x89=\xe2\x80\x890 for all integer i from 1 to n.Bob gave you all the values of ai,\xe2\x80\x89j that he wrote down. Your job is to reconstruct any permutation that could have generated these values. The input will be formed so that it is guaranteed that there is at least one solution that is consistent with the information given." 1100

618A "Slime Combining" implementation "Your friend recently gave you some slimes for your birthday. You have n slimes all initially with value 1.You are going to play a game with these slimes. Initially, you put a single slime by itself in a row. Then, you will add the other n\xe2\x80\x89-\xe2\x80\x891 slimes one by one. When you add a slime, you place it at the right of all already placed slimes. Then, while the last two slimes in the row have the same value v, you combine them together to create a slime with value v\xe2\x80\x89+\xe2\x80\x891.You would like to see what the final state of the row is after you\'ve added all n slimes. Please print the values of the slimes in the row from left to right." 800

617E "XOR and Favorite Number" "data structures" "Bob has a favorite number k and ai of length n. Now he asks you to answer m queries. Each query is given by a pair li and ri and asks you to count the number of pairs of integers i and j, such that l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r and the xor of the numbers ai,\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89aj is equal to k." 2200

617D Polyline "constructive algorithms,implementation" "There are three points marked on the coordinate plane. The goal is to make a simple polyline, without self-intersections and self-touches, such that it passes through all these points. Also, the polyline must consist of only segments parallel to the coordinate axes. You are to find the minimum number of segments this polyline may consist of." 1700

617C "Watering Flowers" implementation "A flowerbed has many flowers and two fountains.You can adjust the water pressure and set any values r1(r1\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x890) and r2(r2\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x890), giving the distances at which the water is spread from the first and second fountain respectively. You have to set such r1 and r2 that all the flowers are watered, that is, for each flower, the distance between the flower and the first fountain doesn\'t exceed r1, or the distance to the second fountain doesn\'t exceed r2. It\'s OK if some flowers are watered by both fountains.You need to decrease the amount of water you need, that is set such r1 and r2 that all the flowers are watered and the r12\xe2\x80\x89+\xe2\x80\x89r22 is minimum possible. Find this minimum value." 1600

617B Chocolate combinatorics "Bob loves everything sweet. His favorite chocolate bar consists of pieces, each piece may contain a nut. Bob wants to break the bar of chocolate into multiple pieces so that each part would contain exactly one nut and any break line goes between two adjacent pieces.You are asked to calculate the number of ways he can do it. Two ways to break chocolate are considered distinct if one of them contains a break between some two adjacent pieces and the other one doesn\'t. Please note, that if Bob doesn\'t make any breaks, all the bar will form one piece and it still has to have exactly one nut." 1300

617A Elephant math "An elephant decided to visit his friend. It turned out that the elephant\'s house is located at point 0 and his friend\'s house is located at point x(x\xe2\x80\x89>\xe2\x80\x890) of the coordinate line. In one step the elephant can move 1, 2, 3, 4 or 5 positions forward. Determine, what is the minimum number of steps he need to make in order to get to his friend\'s house." 800

616F "Expensive Strings" "data structures,sortings,string suffix structures,strings" "You are given n strings ti. Each string has cost ci.Let\'s define the function of string , where ps,\xe2\x80\x89i is the number of occurrences of s in ti, |s| is the length of the string s. Find the maximal value of function f(s) over all strings.Note that the string s is not necessarily some string from t." 2700

616E "Sum of Remainders" "implementation,math,number theory" "Calculate the value of the sum: n mod 1 + n mod 2 + n mod 3 + ... + n mod m. As the result can be very large, you should print the value modulo 109\xe2\x80\x89+\xe2\x80\x897 (the remainder when divided by 109\xe2\x80\x89+\xe2\x80\x897).The modulo operator a mod b stands for the remainder after dividing a by b. For example 10 mod 3 = 1." 2200

616D "Longest k-Good Segment" "binary search,data structures,two pointers" "The array a with n integers is given. Let\'s call the sequence of one or more consecutive elements in a segment. Also let\'s call the segment k-good if it contains no more than k different values.Find any longest k-good segment.As the input/output can reach huge size it is recommended to use fast input/output methods: for example, prefer to use scanf/printf instead of cin/cout in C++, prefer to use BufferedReader/PrintWriter instead of Scanner/System.out in Java." 1600

616C "The Labyrinth" "dfs and similar" "You are given a rectangular field of n\xe2\x80\x89\xc3\x97\xe2\x80\x89m cells. Each cell is either empty or impassable (contains an obstacle). Empty cells are marked with \'.\', impassable cells are marked with \'*\'. Let\'s call two empty cells adjacent if they share a side.Let\'s call a connected component any non-extendible set of cells such that any two of them are connected by the path of adjacent cells. It is a typical well-known definition of a connected component.For each impassable cell (x,\xe2\x80\x89y) imagine that it is an empty cell (all other cells remain unchanged) and find the size (the number of cells) of the connected component which contains (x,\xe2\x80\x89y). You should do it for each impassable cell independently.The answer should be printed as a matrix with n rows and m columns. The j-th symbol of the i-th row should be ""."" if the cell is empty at the start. Otherwise the j-th symbol of the i-th row should contain the only digit \xe2\x80\x94- the answer modulo 10. The matrix should be printed without any spaces.To make your output faster it is recommended to build the output as an array of n strings having length m and print it as a sequence of lines. It will be much faster than writing character-by-character.As input/output can reach huge size it is recommended to use fast input/output methods: for example, prefer to use scanf/printf instead of cin/cout in C++, prefer to use BufferedReader/PrintWriter instead of Scanner/System.out in Java." 1600

616B "Dinner with Emma" games,greedy "Jack decides to invite Emma out for a dinner. Jack is a modest student, he doesn\'t want to go to an expensive restaurant. Emma is a girl with high taste, she prefers elite places.Munhattan consists of n streets and m avenues. There is exactly one restaurant on the intersection of each street and avenue. The streets are numbered with integers from 1 to n and the avenues are numbered with integers from 1 to m. The cost of dinner in the restaurant at the intersection of the i-th street and the j-th avenue is cij.Jack and Emma decide to choose the restaurant in the following way. Firstly Emma chooses the street to dinner and then Jack chooses the avenue. Emma and Jack makes their choice optimally: Emma wants to maximize the cost of the dinner, Jack wants to minimize it. Emma takes into account that Jack wants to minimize the cost of the dinner. Find the cost of the dinner for the couple in love." 1000

616A "Comparing Two Long Integers" implementation,strings "You are given two very long integers a,\xe2\x80\x89b (leading zeroes are allowed). You should check what number a or b is greater or determine that they are equal.The input size is very large so don\'t use the reading of symbols one by one. Instead of that use the reading of a whole line or token.As input/output can reach huge size it is recommended to use fast input/output methods: for example, prefer to use scanf/printf instead of cin/cout in C++, prefer to use BufferedReader/PrintWriter instead of Scanner/System.out in Java. Don\'t use the function input() in Python2 instead of it use the function raw_input()." 900

615E Hexagons "binary search,implementation,math" "Ayrat is looking for the perfect code. He decided to start his search from an infinite field tiled by hexagons. For convenience the coordinate system is introduced, take a look at the picture to see how the coordinates of hexagon are defined:   Ayrat is searching through the field. He started at point (0,\xe2\x80\x890) and is moving along the spiral (see second picture). Sometimes he forgets where he is now. Help Ayrat determine his location after n moves." 2100

615D Multipliers "math,number theory" "Ayrat has number n, represented as it\'s prime factorization pi of size m, i.e. n\xe2\x80\x89=\xe2\x80\x89p1\xc2\xb7p2\xc2\xb7...\xc2\xb7pm. Ayrat got secret information that that the product of all divisors of n taken modulo 109\xe2\x80\x89+\xe2\x80\x897 is the password to the secret data base. Now he wants to calculate this value." 2000

615C "Running Track" dp,greedy,strings,trees "A boy named Ayrat lives on planet AMI-1511. Each inhabitant of this planet has a talent. Specifically, Ayrat loves running, moreover, just running is not enough for him. He is dreaming of making running a real art.First, he wants to construct the running track with coating t. On planet AMI-1511 the coating of the track is the sequence of colored blocks, where each block is denoted as the small English letter. Therefore, every coating can be treated as a string.Unfortunately, blocks aren\'t freely sold to non-business customers, but Ayrat found an infinite number of coatings s. Also, he has scissors and glue. Ayrat is going to buy some coatings s, then cut out from each of them exactly one continuous piece (substring) and glue it to the end of his track coating. Moreover, he may choose to flip this block before glueing it. Ayrat want\'s to know the minimum number of coating s he needs to buy in order to get the coating t for his running track. Of course, he also want\'s to know some way to achieve the answer." 2000

615B "Longtail Hedgehog" dp,graphs "This Christmas Santa gave Masha a magic picture and a pencil. The picture consists of n points connected by m segments (they might cross in any way, that doesn\'t matter). No two segments connect the same pair of points, and no segment connects the point to itself. Masha wants to color some segments in order paint a hedgehog. In Mashas mind every hedgehog consists of a tail and some spines. She wants to paint the tail that satisfies the following conditions:   Only segments already presented on the picture can be painted;  The tail should be continuous, i.e. consists of some sequence of points, such that every two neighbouring points are connected by a colored segment;  The numbers of points from the beginning of the tail to the end should strictly increase. Masha defines the length of the tail as the number of points in it. Also, she wants to paint some spines. To do so, Masha will paint all the segments, such that one of their ends is the endpoint of the tail. Masha defines the beauty of a hedgehog as the length of the tail multiplied by the number of spines. Masha wants to color the most beautiful hedgehog. Help her calculate what result she may hope to get.Note that according to Masha\'s definition of a hedgehog, one segment may simultaneously serve as a spine and a part of the tail (she is a little girl after all). Take a look at the picture for further clarifications." 1600

615A Bulbs implementation "Vasya wants to turn on Christmas lights consisting of m bulbs. Initially, all bulbs are turned off. There are n buttons, each of them is connected to some set of bulbs. Vasya can press any of these buttons. When the button is pressed, it turns on all the bulbs it\'s connected to. Can Vasya light up all the bulbs?If Vasya presses the button such that some bulbs connected to it are already turned on, they do not change their state, i.e. remain turned on." 800

614B "Gena\'s Code" implementation,math "Vasya wants to turn on Christmas lights consisting of m bulbs. Initially, all bulbs are turned off. There are n buttons, each of them is connected to some set of bulbs. Vasya can press any of these buttons. When the button is pressed, it turns on all the bulbs it\'s connected to. Can Vasya light up all the bulbs?If Vasya presses the button such that some bulbs connected to it are already turned on, they do not change their state, i.e. remain turned on." 1400

614A "Link/Cut Tree" "brute force,implementation" "Programmer Rostislav got seriously interested in the Link/Cut Tree data structure, which is based on Splay trees. Specifically, he is now studying the expose procedure.Unfortunately, Rostislav is unable to understand the definition of this procedure, so he decided to ask programmer Serezha to help him. Serezha agreed to help if Rostislav solves a simple task (and if he doesn\'t, then why would he need Splay trees anyway?)Given integers l, r and k, you need to print all powers of number k within range from l to r inclusive. However, Rostislav doesn\'t want to spent time doing this, as he got interested in playing a network game called Agar with Gleb. Help him!" 1500

613E "Puzzle Lover" dp,hashing,strings "Oleg Petrov loves crossword puzzles and every Thursday he buys his favorite magazine with crosswords and other word puzzles. In the last magazine Oleg found a curious puzzle, and the magazine promised a valuable prize for it\'s solution. We give a formal description of the problem below.The puzzle field consists of two rows, each row contains n cells. Each cell contains exactly one small English letter. You also are given a word w, which consists of k small English letters. A solution of the puzzle is a sequence of field cells c1, ..., ck, such that: For all i from 1 to k the letter written in the cell ci matches the letter wi; All the cells in the sequence are pairwise distinct; For all i from 1 to k\xe2\x80\x89-\xe2\x80\x891 cells ci and ci\xe2\x80\x89+\xe2\x80\x891 have a common side.Oleg Petrov quickly found a solution for the puzzle. Now he wonders, how many distinct solutions are there for this puzzle. Oleg Petrov doesn\'t like too large numbers, so calculate the answer modulo 109\xe2\x80\x89+\xe2\x80\x897.Two solutions ci and c\'i are considered distinct if the sequences of cells do not match in at least one position, that is there is such j in range from 1 to k, such that cj\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89c\'j." 3200

613D "Kingdom and its Cities" "dfs and similar,divide and conquer,dp,graphs,sortings,trees" "Meanwhile, the kingdom of K is getting ready for the marriage of the King\'s daughter. However, in order not to lose face in front of the relatives, the King should first finish reforms in his kingdom. As the King can not wait for his daughter\'s marriage, reforms must be finished as soon as possible.The kingdom currently consists of n cities. Cities are connected by n\xe2\x80\x89-\xe2\x80\x891 bidirectional road, such that one can get from any city to any other city. As the King had to save a lot, there is only one path between any two cities.What is the point of the reform? The key ministries of the state should be relocated to distinct cities (we call such cities important). However, due to the fact that there is a high risk of an attack by barbarians it must be done carefully. The King has made several plans, each of which is described by a set of important cities, and now wonders what is the best plan.Barbarians can capture some of the cities that are not important (the important ones will have enough protection for sure), after that the captured city becomes impassable. In particular, an interesting feature of the plan is the minimum number of cities that the barbarians need to capture in order to make all the important cities isolated, that is, from all important cities it would be impossible to reach any other important city.Help the King to calculate this characteristic for each of his plan." 2800

613C Necklace "constructive algorithms,math" "Ivan wants to make a necklace as a present to his beloved girl. A necklace is a cyclic sequence of beads of different colors. Ivan says that necklace is beautiful relative to the cut point between two adjacent beads, if the chain of beads remaining after this cut is a palindrome (reads the same forward and backward).  Ivan has beads of n colors. He wants to make a necklace, such that it\'s beautiful relative to as many cuts as possible. He certainly wants to use all the beads. Help him to make the most beautiful necklace." 2500

613B Skills "binary search,brute force,dp,greedy,sortings,two pointers" "Lesha plays the recently published new version of the legendary game hacknet. In this version character skill mechanism was introduced. Now, each player character has exactly n skills. Each skill is represented by a non-negative integer ai�\xe2\x80\x94 the current skill level. All skills have the same maximum level A.Along with the skills, global ranking of all players was added. Players are ranked according to the so-called Force. The Force of a player is the sum of the following values:  The number of skills that a character has perfected (i.e., such that ai\xe2\x80\x89=\xe2\x80\x89A), multiplied by coefficient cf. The minimum skill level among all skills (min ai), multiplied by coefficient cm. Now Lesha has m hacknetian currency units, which he is willing to spend. Each currency unit can increase the current level of any skill by 1 (if it\'s not equal to A yet). Help him spend his money in order to achieve the maximum possible value of the Force." 1900

613A "Peter and Snow Blower" "binary search,geometry,ternary search" "Peter got a new snow blower as a New Year present. Of course, Peter decided to try it immediately. After reading the instructions he realized that it does not work like regular snow blowing machines. In order to make it work, you need to tie it to some point that it does not cover, and then switch it on. As a result it will go along a circle around this point and will remove all the snow from its path.Formally, we assume that Peter\'s machine is a polygon on a plane. Then, after the machine is switched on, it will make a circle around the point to which Peter tied it (this point lies strictly outside the polygon). That is, each of the points lying within or on the border of the polygon will move along the circular trajectory, with the center of the circle at the point to which Peter tied his machine.Peter decided to tie his car to point P and now he is wondering what is the area of \xe2\x80\x8b\xe2\x80\x8bthe region that will be cleared from snow. Help him." 1900

612F "Simba on the Circle" dp "You are given a circular array with n elements. The elements are numbered from some element with values from 1 to n in clockwise order. The i-th cell contains the value ai. The robot Simba is in cell s.Each moment of time the robot is in some of the n cells (at the begin he is in s). In one turn the robot can write out the number written in current cell or move to the adjacent cell in clockwise or counterclockwise direction. To write out the number from the cell Simba doesn\'t spend any time, but to move to adjacent cell Simba spends one unit of time.Simba wants to write the number from each cell one time, so the numbers will be written in a non decreasing order. Find the least number of time units to write out all numbers." 2600

612E "Square Root of Permutation" "combinatorics,constructive algorithms,dfs and similar,graphs,math" "A permutation of length n is an array containing each integer from 1 to n exactly once. For example, q\xe2\x80\x89=\xe2\x80\x89[4,\xe2\x80\x895,\xe2\x80\x891,\xe2\x80\x892,\xe2\x80\x893] is a permutation. For the permutation q the square of permutation is the permutation p that p[i]\xe2\x80\x89=\xe2\x80\x89q[q[i]] for each i\xe2\x80\x89=\xe2\x80\x891... n. For example, the square of q\xe2\x80\x89=\xe2\x80\x89[4,\xe2\x80\x895,\xe2\x80\x891,\xe2\x80\x892,\xe2\x80\x893] is p\xe2\x80\x89=\xe2\x80\x89q2\xe2\x80\x89=\xe2\x80\x89[2,\xe2\x80\x893,\xe2\x80\x894,\xe2\x80\x895,\xe2\x80\x891].This problem is about the inverse operation: given the permutation p you task is to find such permutation q that q2\xe2\x80\x89=\xe2\x80\x89p. If there are several such q find any of them." 2200

612D "The Union of k-Segments" greedy,sortings "You are given n segments on the coordinate axis Ox and the number k. The point is satisfied if it belongs to at least k segments. Find the smallest (by the number of segments) set of segments on the coordinate axis Ox which contains all satisfied points and no others." 1800

612C "Replace To Make Regular Bracket Sequence" "data structures,expression parsing,math" "You are given string s consists of opening and closing brackets of four kinds <>, {}, [], (). There are two types of brackets: opening and closing. You can replace any bracket by another of the same type. For example, you can replace < by the bracket {, but you can\'t replace it by ) or >.The following definition of a regular bracket sequence is well-known, so you can be familiar with it.Let\'s define a regular bracket sequence (RBS). Empty string is RBS. Let s1 and s2 be a RBS then the strings <s1>s2, {s1}s2, [s1]s2, (s1)s2 are also RBS.For example the string ""[[(){}]<>]"" is RBS, but the strings ""[)()"" and ""][()()"" are not.Determine the least number of replaces to make the string s RBS." 1400

612B "HDD is Outdated Technology" implementation,math "HDD hard drives group data by sectors. All files are split to fragments and each of them are written in some sector of hard drive. Note the fragments can be written in sectors in arbitrary order.One of the problems of HDD hard drives is the following: the magnetic head should move from one sector to another to read some file.Find the time need to read file split to n fragments. The i-th sector contains the fi-th fragment of the file (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89fi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n). Note different sectors contains the different fragments. At the start the magnetic head is in the position that contains the first fragment. The file are reading in the following manner: at first the first fragment is read, then the magnetic head moves to the sector that contains the second fragment, then the second fragment is read and so on until the n-th fragment is read. The fragments are read in the order from the first to the n-th.It takes |a\xe2\x80\x89-\xe2\x80\x89b| time units to move the magnetic head from the sector a to the sector b. Reading a fragment takes no time." 1200

612A "The Text Splitting" "brute force,implementation,strings" "You are given the string s of length n and the numbers p,\xe2\x80\x89q. Split the string s to pieces of length p and q.For example, the string ""Hello"" for p\xe2\x80\x89=\xe2\x80\x892, q\xe2\x80\x89=\xe2\x80\x893 can be split to the two strings ""Hel"" and ""lo"" or to the two strings ""He"" and ""llo"".Note it is allowed to split the string s to the strings only of length p or to the strings only of length q (see the second sample test)." 1300

611H "New Year  and Forgotten Tree" "constructive algorithms,flows,graphs" "You are given the string s of length n and the numbers p,\xe2\x80\x89q. Split the string s to pieces of length p and q.For example, the string ""Hello"" for p\xe2\x80\x89=\xe2\x80\x892, q\xe2\x80\x89=\xe2\x80\x893 can be split to the two strings ""Hel"" and ""lo"" or to the two strings ""He"" and ""llo"".Note it is allowed to split the string s to the strings only of length p or to the strings only of length q (see the second sample test)." 3200

611G "New Year and Cake" "geometry,two pointers" "Limak is a little polar bear. According to some old traditions, his bear family prepared a New Year cake. And Limak likes cakes.As you may know, a New Year cake is a strictly convex polygon with n vertices.Parents won\'t allow Limak to eat more than half of a cake because he would get sick. After some thinking they decided to cut a cake along one of n\xc2\xb7(n\xe2\x80\x89-\xe2\x80\x893)\xe2\x80\x89/\xe2\x80\x892 diagonals. Then Limak will get a non-greater piece.Limak understands rules but he won\'t be happy if the second piece happens to be much bigger. Limak\'s disappointment will be equal to the difference between pieces\' areas, multiplied by two. It can be proved that it will be integer for the given constraints.There are n\xc2\xb7(n\xe2\x80\x89-\xe2\x80\x893)\xe2\x80\x89/\xe2\x80\x892 possible scenarios. Consider them all and find the sum of values of Limak\'s disappointment, modulo 109\xe2\x80\x89+\xe2\x80\x897." 2900

611F "New Year and Cleaning" "binary search,implementation" "Limak is a little polar bear. His parents told him to clean a house before the New Year\'s Eve. Their house is a rectangular grid with h rows and w columns. Each cell is an empty square.He is a little bear and thus he can\'t clean a house by himself. Instead, he is going to use a cleaning robot.A cleaning robot has a built-in pattern of n moves, defined by a string of the length n. A single move (character) moves a robot to one of four adjacent cells. Each character is one of the following four: \'U\' (up), \'D\' (down), \'L\' (left), \'R\' (right). One move takes one minute.A cleaning robot must be placed and started in some cell. Then it repeats its pattern of moves till it hits a wall (one of four borders of a house). After hitting a wall it can be placed and used again.Limak isn\'t sure if placing a cleaning robot in one cell will be enough. Thus, he is going to start it w\xc2\xb7h times, one time in each cell. Maybe some cells will be cleaned more than once but who cares?Limak asks you one question. How much time will it take to clean a house? Find and print the number of minutes modulo 109\xe2\x80\x89+\xe2\x80\x897. It\'s also possible that a cleaning robot will never stop�\xe2\x80\x94 then print ""-1"" (without the quotes) instead.Placing and starting a robot takes no time, however, you must count a move when robot hits a wall. Take a look into samples for further clarification." 2500

611E "New Year and Three Musketeers" "data structures,greedy,sortings" "Do you know the story about the three musketeers? Anyway, you must help them now.Richelimakieu is a cardinal in the city of Bearis. He found three brave warriors and called them the three musketeers. Athos has strength a, Borthos strength b, and Caramis has strength c.The year 2015 is almost over and there are still n criminals to be defeated. The i-th criminal has strength ti. It\'s hard to defeat strong criminals�\xe2\x80\x94 maybe musketeers will have to fight together to achieve it.Richelimakieu will coordinate musketeers\' actions. In each hour each musketeer can either do nothing or be assigned to one criminal. Two or three musketeers can be assigned to the same criminal and then their strengths are summed up. A criminal can be defeated in exactly one hour (also if two or three musketeers fight him). Richelimakieu can\'t allow the situation where a criminal has strength bigger than the sum of strengths of musketeers fighting him�\xe2\x80\x94 a criminal would win then!In other words, there are three ways to defeat a criminal.  A musketeer of the strength x in one hour can defeat a criminal of the strength not greater than x. So, for example Athos in one hour can defeat criminal i only if ti\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a.  Two musketeers can fight together and in one hour defeat a criminal of the strength not greater than the sum of strengths of these two musketeers. So, for example Athos and Caramis in one hour can defeat criminal i only if ti\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a\xe2\x80\x89+\xe2\x80\x89c. Note that the third remaining musketeer can either do nothing or fight some other criminal.  Similarly, all three musketeers can fight together and in one hour defeat a criminal of the strength not greater than the sum of musketeers\' strengths, i.e. ti\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a\xe2\x80\x89+\xe2\x80\x89b\xe2\x80\x89+\xe2\x80\x89c. Richelimakieu doesn\'t want musketeers to fight during the New Year\'s Eve. Thus, he must coordinate their actions in order to minimize the number of hours till all criminals will be defeated.Find the minimum number of hours to defeat all criminals. If musketeers can\'t defeat them all then print ""-1"" (without the quotes) instead." 2400

611D "New Year and Ancient Prophecy" dp,hashing,strings "Limak is a little polar bear. In the snow he found a scroll with the ancient prophecy. Limak doesn\'t know any ancient languages and thus is unable to understand the prophecy. But he knows digits!One fragment of the prophecy is a sequence of n digits. The first digit isn\'t zero. Limak thinks that it\'s a list of some special years. It\'s hard to see any commas or spaces, so maybe ancient people didn\'t use them. Now Limak wonders what years are listed there.Limak assumes three things:  Years are listed in the strictly increasing order;  Every year is a positive integer number;  There are no leading zeros. Limak is going to consider all possible ways to split a sequence into numbers (years), satisfying the conditions above. He will do it without any help. However, he asked you to tell him the number of ways to do so. Since this number may be very large, you are only asked to calculate it modulo 109\xe2\x80\x89+\xe2\x80\x897." 2000

611C "New Year and Domino" dp,implementation "They say ""years are like dominoes, tumbling one after the other"". But would a year fit into a grid? I don\'t think so.Limak is a little polar bear who loves to play. He has recently got a rectangular grid with h rows and w columns. Each cell is a square, either empty (denoted by \'.\') or forbidden (denoted by \'#\'). Rows are numbered 1 through h from top to bottom. Columns are numbered 1 through w from left to right.Also, Limak has a single domino. He wants to put it somewhere in a grid. A domino will occupy exactly two adjacent cells, located either in one row or in one column. Both adjacent cells must be empty and must be inside a grid.Limak needs more fun and thus he is going to consider some queries. In each query he chooses some rectangle and wonders, how many way are there to put a single domino inside of the chosen rectangle?" 1500

611B "New Year and Old Property" "bitmasks,brute force,implementation" "The year 2015 is almost over.Limak is a little polar bear. He has recently learnt about the binary system. He noticed that the passing year has exactly one zero in its representation in the binary system�\xe2\x80\x94 201510\xe2\x80\x89=\xe2\x80\x89111110111112. Note that he doesn\'t care about the number of zeros in the decimal representation.Limak chose some interval of years. He is going to count all years from this interval that have exactly one zero in the binary representation. Can you do it faster?Assume that all positive integers are always written without leading zeros." 1300

611A "New Year and Days" implementation "Today is Wednesday, the third day of the week. What\'s more interesting is that tomorrow is the last day of the year 2015.Limak is a little polar bear. He enjoyed this year a lot. Now, he is so eager to the coming year 2016.Limak wants to prove how responsible a bear he is. He is going to regularly save candies for the entire year 2016! He considers various saving plans. He can save one candy either on some fixed day of the week or on some fixed day of the month.Limak chose one particular plan. He isn\'t sure how many candies he will save in the 2016 with his plan. Please, calculate it and tell him." 900

610E "Alphabet Permutations" "data structures,strings" "You are given a string s of length n, consisting of first k lowercase English letters.We define a c-repeat of some string q as a string, consisting of c copies of the string q. For example, string ""acbacbacbacb"" is a 4-repeat of the string ""acb"".Let\'s say that string a contains string b as a subsequence, if string b can be obtained from a by erasing some symbols.Let p be a string that represents some permutation of the first k lowercase English letters. We define function d(p) as the smallest integer such that a d(p)-repeat of the string p contains string s as a subsequence.There are m operations of one of two types that can be applied to string s:  Replace all characters at positions from li to ri by a character ci.  For the given p, that is a permutation of first k lowercase English letters, find the value of function d(p). All operations are performed sequentially, in the order they appear in the input. Your task is to determine the values of function d(p) for all operations of the second type." 2500

610D "Vika and Segments" "constructive algorithms,data structures,geometry,two pointers" "Vika has an infinite sheet of squared paper. Initially all squares are white. She introduced a two-dimensional coordinate system on this sheet and drew n black horizontal and vertical segments parallel to the coordinate axes. All segments have width equal to 1 square, that means every segment occupy some set of neighbouring squares situated in one row or one column.Your task is to calculate the number of painted cells. If a cell was painted more than once, it should be calculated exactly once." 2300

610C "Harmony Analysis" "constructive algorithms" "The semester is already ending, so Danil made an effort and decided to visit a lesson on harmony analysis to know how does the professor look like, at least. Danil was very bored on this lesson until the teacher gave the group a simple task: find 4 vectors in 4-dimensional space, such that every coordinate of every vector is 1 or \xe2\x80\x89-\xe2\x80\x891 and any two vectors are orthogonal. Just as a reminder, two vectors in n-dimensional space are considered to be orthogonal if and only if their scalar product is equal to zero, that is: .Danil quickly managed to come up with the solution for this problem and the teacher noticed that the problem can be solved in a more general case for 2k vectors in 2k-dimensinoal space. When Danil came home, he quickly came up with the solution for this problem. Can you cope with it?" 1800

610B "Vika and Squares" "constructive algorithms,implementation" "Vika has n jars with paints of distinct colors. All the jars are numbered from 1 to n and the i-th jar contains ai liters of paint of color i.Vika also has an infinitely long rectangular piece of paper of width 1, consisting of squares of size 1\xe2\x80\x89\xc3\x97\xe2\x80\x891. Squares are numbered 1, 2, 3 and so on. Vika decided that she will start painting squares one by one from left to right, starting from the square number 1 and some arbitrary color. If the square was painted in color x, then the next square will be painted in color x\xe2\x80\x89+\xe2\x80\x891. In case of x\xe2\x80\x89=\xe2\x80\x89n, next square is painted in color 1. If there is no more paint of the color Vika wants to use now, then she stops.Square is always painted in only one color, and it takes exactly 1 liter of paint. Your task is to calculate the maximum number of squares that might be painted, if Vika chooses right color to paint the first square." 1300

610A "Pasha and Stick" combinatorics,math "Pasha has a wooden stick of some positive integer length n. He wants to perform exactly three cuts to get four parts of the stick. Each part must have some positive integer length and the sum of these lengths will obviously be n. Pasha likes rectangles but hates squares, so he wonders, how many ways are there to split a stick into four parts so that it\'s possible to form a rectangle using these parts, but is impossible to form a square.Your task is to help Pasha and count the number of such ways. Two ways to cut the stick are considered distinct if there exists some integer x, such that the number of parts of length x in the first way differ from the number of parts of length x in the second way." 1000

609F "Frogs and mosquitoes" "data structures,greedy" "There are n frogs sitting on the coordinate axis Ox. For each frog two values xi,\xe2\x80\x89ti are known \xe2\x80\x94 the position and the initial length of the tongue of the i-th frog (it is guaranteed that all positions xi are different). m mosquitoes one by one are landing to the coordinate axis. For each mosquito two values are known pj \xe2\x80\x94 the coordinate of the position where the j-th mosquito lands and bj \xe2\x80\x94 the size of the j-th mosquito. Frogs and mosquitoes are represented as points on the coordinate axis.The frog can eat mosquito if mosquito is in the same position with the frog or to the right, and the distance between them is not greater than the length of the tongue of the frog.If at some moment several frogs can eat a mosquito the leftmost frog will eat it (with minimal xi). After eating a mosquito the length of the tongue of a frog increases with the value of the size of eaten mosquito. It\'s possible that after it the frog will be able to eat some other mosquitoes (the frog should eat them in this case).For each frog print two values \xe2\x80\x94 the number of eaten mosquitoes and the length of the tongue after landing all mosquitoes and after eating all possible mosquitoes by frogs.Each mosquito is landing to the coordinate axis only after frogs eat all possible mosquitoes landed before. Mosquitoes are given in order of their landing to the coordinate axis." 2500

609E "Minimum spanning tree for each edge" "data structures,dfs and similar,dsu,graphs,trees" "Connected undirected weighted graph without self-loops and multiple edges is given. Graph contains n vertices and m edges.For each edge (u,\xe2\x80\x89v) find the minimal possible weight of the spanning tree that contains the edge (u,\xe2\x80\x89v).The weight of the spanning tree is the sum of weights of all edges included in spanning tree." 2100

609D "Gadgets for dollars and pounds" "binary search,greedy,two pointers" "Nura wants to buy k gadgets. She has only s burles for that. She can buy each gadget for dollars or for pounds. So each gadget is selling only for some type of currency. The type of currency and the cost in that currency are not changing.Nura can buy gadgets for n days. For each day you know the exchange rates of dollar and pound, so you know the cost of conversion burles to dollars or to pounds.Each day (from 1 to n) Nura can buy some gadgets by current exchange rate. Each day she can buy any gadgets she wants, but each gadget can be bought no more than once during n days.Help Nura to find the minimum day index when she will have k gadgets. Nura always pays with burles, which are converted according to the exchange rate of the purchase day. Nura can\'t buy dollars or pounds, she always stores only burles. Gadgets are numbered with integers from 1 to m in order of their appearing in input." 2000

609C "Load Balancing" implementation,math "In the school computer room there are n servers which are responsible for processing several computing tasks. You know the number of scheduled tasks for each server: there are mi tasks assigned to the i-th server.In order to balance the load for each server, you want to reassign some tasks to make the difference between the most loaded server and the least loaded server as small as possible. In other words you want to minimize expression ma\xe2\x80\x89-\xe2\x80\x89mb, where a is the most loaded server and b is the least loaded one.In one second you can reassign a single task. Thus in one second you can choose any pair of servers and move a single task from one server to another.Write a program to find the minimum number of seconds needed to balance the load of servers." 1500

609B "The Best Gift" "constructive algorithms,implementation" "Emily\'s birthday is next week and Jack has decided to buy a present for her. He knows she loves books so he goes to the local bookshop, where there are n books on sale from one of m genres.In the bookshop, Jack decides to buy two books of different genres.Based on the genre of books on sale in the shop, find the number of options available to Jack for choosing two books of different genres for Emily. Options are considered different if they differ in at least one book.The books are given by indices of their genres. The genres are numbered from 1 to m." 1100

609A "USB Flash Drives" greedy,implementation,sortings "Sean is trying to save a large file to a USB flash drive. He has n USB flash drives with capacities equal to a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an megabytes. The file size is equal to m megabytes. Find the minimum number of USB flash drives needed to write Sean\'s file, if he can split the file between drives." 800

608B "Hamming Distance Sum" combinatorics,strings "Genos needs your help. He was asked to solve the following programming problem by Saitama:The length of some string s is denoted |s|. The Hamming distance between two strings s and t of equal length is defined as , where si is the i-th character of s and ti is the i-th character of t. For example, the Hamming distance between string ""0011"" and string ""0110"" is |0\xe2\x80\x89-\xe2\x80\x890|\xe2\x80\x89+\xe2\x80\x89|0\xe2\x80\x89-\xe2\x80\x891|\xe2\x80\x89+\xe2\x80\x89|1\xe2\x80\x89-\xe2\x80\x891|\xe2\x80\x89+\xe2\x80\x89|1\xe2\x80\x89-\xe2\x80\x890|\xe2\x80\x89=\xe2\x80\x890\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x890\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89=\xe2\x80\x892.Given two binary strings a and b, find the sum of the Hamming distances between a and all contiguous substrings of b of length |a|." 1500

608A "Saitama Destroys Hotel" implementation,math "Saitama accidentally destroyed a hotel again. To repay the hotel company, Genos has volunteered to operate an elevator in one of its other hotels. The elevator is special \xe2\x80\x94 it starts on the top floor, can only move down, and has infinite capacity. Floors are numbered from 0 to s and elevator initially starts on floor s at time 0.The elevator takes exactly 1 second to move down exactly 1 floor and negligible time to pick up passengers. Genos is given a list detailing when and on which floor passengers arrive. Please determine how long in seconds it will take Genos to bring all passengers to floor 0." 1000

607E "Cross Sum" "binary search,geometry" "Genos has been given n distinct lines on the Cartesian plane. Let  be a list of intersection points of these lines. A single point might appear multiple times in this list if it is the intersection of multiple pairs of lines. The order of the list does not matter.Given a query point (p,\xe2\x80\x89q), let  be the corresponding list of distances of all points in  to the query point. Distance here refers to euclidean distance. As a refresher, the euclidean distance between two points (x1,\xe2\x80\x89y1) and (x2,\xe2\x80\x89y2) is .Genos is given a point (p,\xe2\x80\x89q) and a positive integer m. He is asked to find the sum of the m smallest elements in . Duplicate elements in  are treated as separate elements. Genos is intimidated by Div1 E problems so he asked for your help." 3300

607D "Power Tree" "data structures,trees" "Genos and Saitama went shopping for Christmas trees. However, a different type of tree caught their attention, the exalted Power Tree. A Power Tree starts out as a single root vertex indexed 1. A Power Tree grows through a magical phenomenon known as an update. In an update, a single vertex is added to the tree as a child of some other vertex.Every vertex in the tree (the root and all the added vertices) has some value vi associated with it. The power of a vertex is defined as the strength of the multiset composed of the value associated with this vertex (vi) and the powers of its direct children. The strength of a multiset is defined as the sum of all elements in the multiset multiplied by the number of elements in it. Or in other words for some multiset S: Saitama knows the updates that will be performed on the tree, so he decided to test Genos by asking him queries about the tree during its growth cycle.An update is of the form 1�p�v, and adds a new vertex with value v as a child of vertex p.A query is of the form 2�u, and asks for the power of vertex u.Please help Genos respond to these queries modulo 109\xe2\x80\x89+\xe2\x80\x897." 2600

607C Marbles hashing,strings "In the spirit of the holidays, Saitama has given Genos two grid paths of length n (a weird gift even by Saitama\'s standards). A grid path is an ordered sequence of neighbouring squares in an infinite grid. Two squares are neighbouring if they share a side.One example of a grid path is (0,\xe2\x80\x890)\xe2\x80\x89\xe2\x86\x92\xe2\x80\x89(0,\xe2\x80\x891)\xe2\x80\x89\xe2\x86\x92\xe2\x80\x89(0,\xe2\x80\x892)\xe2\x80\x89\xe2\x86\x92\xe2\x80\x89(1,\xe2\x80\x892)\xe2\x80\x89\xe2\x86\x92\xe2\x80\x89(1,\xe2\x80\x891)\xe2\x80\x89\xe2\x86\x92\xe2\x80\x89(0,\xe2\x80\x891)\xe2\x80\x89\xe2\x86\x92\xe2\x80\x89(\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x891). Note that squares in this sequence might be repeated, i.e. path has self intersections.Movement within a grid path is restricted to adjacent squares within the sequence. That is, from the i-th square, one can only move to the (i\xe2\x80\x89-\xe2\x80\x891)-th or (i\xe2\x80\x89+\xe2\x80\x891)-th squares of this path. Note that there is only a single valid move from the first and last squares of a grid path. Also note, that even if there is some j-th square of the path that coincides with the i-th square, only moves to (i\xe2\x80\x89-\xe2\x80\x891)-th and (i\xe2\x80\x89+\xe2\x80\x891)-th squares are available. For example, from the second square in the above sequence, one can only move to either the first or third squares.To ensure that movement is not ambiguous, the two grid paths will not have an alternating sequence of three squares. For example, a contiguous subsequence (0,\xe2\x80\x890)\xe2\x80\x89\xe2\x86\x92\xe2\x80\x89(0,\xe2\x80\x891)\xe2\x80\x89\xe2\x86\x92\xe2\x80\x89(0,\xe2\x80\x890) cannot occur in a valid grid path.One marble is placed on the first square of each grid path. Genos wants to get both marbles to the last square of each grid path. However, there is a catch. Whenever he moves one marble, the other marble will copy its movement if possible. For instance, if one marble moves east, then the other marble will try and move east as well. By try, we mean if moving east is a valid move, then the marble will move east.Moving north increases the second coordinate by 1, while moving south decreases it by 1. Similarly, moving east increases first coordinate by 1, while moving west decreases it.Given these two valid grid paths, Genos wants to know if it is possible to move both marbles to the ends of their respective paths. That is, if it is possible to move the marbles such that both marbles rest on the last square of their respective paths." 2500

607B Zuma dp "Genos recently installed the game Zuma on his phone. In Zuma there exists a line of n gemstones, the i-th of which has color ci. The goal of the game is to destroy all the gemstones in the line as quickly as possible.In one second, Genos is able to choose exactly one continuous substring of colored gemstones that is a palindrome and remove it from the line. After the substring is removed, the remaining gemstones shift to form a solid line again. What is the minimum number of seconds needed to destroy the entire line?Let us remind, that the string (or substring) is called palindrome, if it reads same backwards or forward. In our case this means the color of the first gemstone is equal to the color of the last one, the color of the second gemstone is equal to the color of the next to last and so on." 1900

607A "Chain Reaction" "binary search,dp" "There are n beacons located at distinct positions on a number line. The i-th beacon has position ai and power level bi. When the i-th beacon is activated, it destroys all beacons to its left (direction of decreasing coordinates) within distance bi inclusive. The beacon itself is not destroyed however. Saitama will activate the beacons one at a time from right to left. If a beacon is destroyed, it cannot be activated.Saitama wants Genos to add a beacon strictly to the right of all the existing beacons, with any position and any power level, such that the least possible number of beacons are destroyed. Note that Genos\'s placement of the beacon means it will be the first beacon activated. Help Genos by finding the minimum number of beacons that could be destroyed." 1600

606B "Testing Robots" implementation "The Cybernetics Failures (CF) organisation made a prototype of a bomb technician robot. To find the possible problems it was decided to carry out a series of tests. At the beginning of each test the robot prototype will be placed in cell (x0,\xe2\x80\x89y0) of a rectangular squared field of size x\xe2\x80\x89\xc3\x97\xe2\x80\x89y, after that a mine will be installed into one of the squares of the field. It is supposed to conduct exactly x\xc2\xb7y tests, each time a mine is installed into a square that has never been used before. The starting cell of the robot always remains the same.After placing the objects on the field the robot will have to run a sequence of commands given by string s, consisting only of characters \'L\', \'R\', \'U\', \'D\'. These commands tell the robot to move one square to the left, to the right, up or down, or stay idle if moving in the given direction is impossible. As soon as the robot fulfills all the sequence of commands, it will blow up due to a bug in the code. But if at some moment of time the robot is at the same square with the mine, it will also blow up, but not due to a bug in the code.Moving to the left decreases coordinate y, and moving to the right increases it. Similarly, moving up decreases the x coordinate, and moving down increases it.The tests can go on for very long, so your task is to predict their results. For each k from 0 to length(s) your task is to find in how many tests the robot will run exactly k commands before it blows up." 1600

606A "Magic Spheres" implementation "Carl is a beginner magician. He has a blue, b violet and c orange magic spheres. In one move he can transform two spheres of the same color into one sphere of any other color. To make a spell that has never been seen before, he needs at least x blue, y violet and z orange spheres. Can he get them (possible, in multiple actions)?" 1200

605E "Intergalaxy Trips" "probabilities,shortest paths" "The scientists have recently discovered wormholes�\xe2\x80\x94 objects in space that allow to travel very long distances between galaxies and star systems. The scientists know that there are n galaxies within reach. You are in the galaxy number 1 and you need to get to the galaxy number n. To get from galaxy i to galaxy j, you need to fly onto a wormhole (i,\xe2\x80\x89j) and in exactly one galaxy day you will find yourself in galaxy j. Unfortunately, the required wormhole is not always available. Every galaxy day they disappear and appear at random. However, the state of wormholes does not change within one galaxy day. A wormhole from galaxy i to galaxy j exists during each galaxy day taken separately with probability pij. You can always find out what wormholes exist at the given moment. At each moment you can either travel to another galaxy through one of wormholes that exist at this moment or you can simply wait for one galaxy day to see which wormholes will lead from your current position at the next day.Your task is to find the expected value of time needed to travel from galaxy 1 to galaxy n, if you act in the optimal way. It is guaranteed that this expected value exists." 2700

605D "Board Game" "data structures,dfs and similar" "You are playing a board card game. In this game the player has two characteristics, x and y�\xe2\x80\x94 the white magic skill and the black magic skill, respectively. There are n spell cards lying on the table, each of them has four characteristics, ai, bi, ci and di. In one move a player can pick one of the cards and cast the spell written on it, but only if first two of it\'s characteristics meet the requirement ai\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x and bi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y, i.e. if the player has enough magic skill to cast this spell. However, after casting the spell the characteristics of a player change and become equal to x\xe2\x80\x89=\xe2\x80\x89ci and y\xe2\x80\x89=\xe2\x80\x89di.At the beginning of the game both characteristics of a player are equal to zero. The goal of the game is to cast the n-th spell. Your task is to make it in as few moves as possible. You are allowed to use spell in any order and any number of times (for example, you may not use some spells at all)." 2500

605C "Freelancer\'s Dreams" geometry "You are playing a board card game. In this game the player has two characteristics, x and y�\xe2\x80\x94 the white magic skill and the black magic skill, respectively. There are n spell cards lying on the table, each of them has four characteristics, ai, bi, ci and di. In one move a player can pick one of the cards and cast the spell written on it, but only if first two of it\'s characteristics meet the requirement ai\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x and bi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y, i.e. if the player has enough magic skill to cast this spell. However, after casting the spell the characteristics of a player change and become equal to x\xe2\x80\x89=\xe2\x80\x89ci and y\xe2\x80\x89=\xe2\x80\x89di.At the beginning of the game both characteristics of a player are equal to zero. The goal of the game is to cast the n-th spell. Your task is to make it in as few moves as possible. You are allowed to use spell in any order and any number of times (for example, you may not use some spells at all)." 2400

605B "Lazy Student" "constructive algorithms,data structures,graphs" "Student Vladislav came to his programming exam completely unprepared as usual. He got a question about some strange algorithm on a graph�\xe2\x80\x94 something that will definitely never be useful in real life. He asked a girl sitting next to him to lend him some cheat papers for this questions and found there the following definition:The minimum spanning tree T of graph G is such a tree that it contains all the vertices of the original graph G, and the sum of the weights of its edges is the minimum possible among all such trees.Vladislav drew a graph with n vertices and m edges containing no loops and multiple edges. He found one of its minimum spanning trees and then wrote for each edge its weight and whether it is included in the found tree or not. Unfortunately, the piece of paper where the graph was painted is gone and the teacher is getting very angry and demands to see the original graph. Help Vladislav come up with a graph so that the information about the minimum spanning tree remains correct." 1700

605A "Sorting Railway Cars" "constructive algorithms,greedy" "An infinitely long railway has a train consisting of n cars, numbered from 1 to n (the numbers of all the cars are distinct) and positioned in arbitrary order. David Blaine wants to sort the railway cars in the order of increasing numbers. In one move he can make one of the cars disappear from its place and teleport it either to the beginning of the train, or to the end of the train, at his desire. What is the minimum number of actions David Blaine needs to perform in order to sort the train?" 1600

604B "More Cowbell" "binary search,greedy" "Kevin Sun wants to move his precious collection of n cowbells from Naperthrill to Exeter, where there is actually grass instead of corn. Before moving, he must pack his cowbells into k boxes of a fixed size. In order to keep his collection safe during transportation, he won\'t place more than two cowbells into a single box. Since Kevin wishes to minimize expenses, he is curious about the smallest size box he can use to pack his entire collection. Kevin is a meticulous cowbell collector and knows that the size of his i-th (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) cowbell is an integer si. In fact, he keeps his cowbells sorted by size, so si\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89si for any i\xe2\x80\x89>\xe2\x80\x891. Also an expert packer, Kevin can fit one or two cowbells into a box of size s if and only if the sum of their sizes does not exceed s. Given this information, help Kevin determine the smallest s for which it is possible to put all of his cowbells into k boxes of size s." 1400

604A "Uncowed Forces" implementation "Kevin Sun has just finished competing in Codeforces Round #334! The round was 120 minutes long and featured five problems with maximum point values of 500, 1000, 1500, 2000, and 2500, respectively. Despite the challenging tasks, Kevin was uncowed and bulldozed through all of them, distinguishing himself from the herd as the best cowmputer scientist in all of Bovinia. Kevin knows his submission time for each problem, the number of wrong submissions that he made on each problem, and his total numbers of successful and unsuccessful hacks. Because Codeforces scoring is complicated, Kevin wants you to write a program to compute his final score.Codeforces scores are computed as follows: If the maximum point value of a problem is x, and Kevin submitted correctly at minute m but made w wrong submissions, then his score on that problem is . His total score is equal to the sum of his scores for each problem. In addition, Kevin\'s total score gets increased by 100 points for each successful hack, but gets decreased by 50 points for each unsuccessful hack.All arithmetic operations are performed with absolute precision and no rounding. It is guaranteed that Kevin\'s final score is an integer." 1000

603E "Pastoral Oddities" "data structures,divide and conquer,dsu,math,trees" "In the land of Bovinia there are n pastures, but no paths connecting the pastures. Of course, this is a terrible situation, so Kevin Sun is planning to rectify it by constructing m undirected paths connecting pairs of distinct pastures. To make transportation more efficient, he also plans to pave some of these new paths.Kevin is very particular about certain aspects of path-paving. Since he loves odd numbers, he wants each pasture to have an odd number of paved paths connected to it. Thus we call a paving sunny if each pasture is incident to an odd number of paved paths. He also enjoys short paths more than long paths, so he would like the longest paved path to be as short as possible. After adding each path, Kevin wants to know if a sunny paving exists for the paths of Bovinia, and if at least one does, the minimum possible length of the longest path in such a paving. Note that ""longest path"" here means maximum-weight edge." 3000

603D "Ruminations on Ruminants" geometry,math "Kevin Sun is ruminating on the origin of cows while standing at the origin of the Cartesian plane. He notices n lines  on the plane, each representable by an equation of the form ax\xe2\x80\x89+\xe2\x80\x89by\xe2\x80\x89=\xe2\x80\x89c. He also observes that no two lines are parallel and that no three lines pass through the same point.For each triple (i,\xe2\x80\x89j,\xe2\x80\x89k) such that 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89j\xe2\x80\x89<\xe2\x80\x89k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n, Kevin considers the triangle formed by the three lines  . He calls a triangle original if the circumcircle of that triangle passes through the origin. Since Kevin believes that the circles of bovine life are tied directly to such triangles, he wants to know the number of original triangles formed by unordered triples of distinct lines. Recall that the circumcircle of a triangle is the circle which passes through all the vertices of that triangle." 2900

603C "Lieges of Legendre" games,math "Kevin and Nicky Sun have invented a new game called Lieges of Legendre. In this game, two players take turns modifying the game state with Kevin moving first. Initially, the game is set up so that there are n piles of cows, with the i-th pile containing ai cows. During each player\'s turn, that player calls upon the power of Sunlight, and uses it to either:  Remove a single cow from a chosen non-empty pile.  Choose a pile of cows with even size 2\xc2\xb7x (x\xe2\x80\x89>\xe2\x80\x890), and replace it with k piles of x cows each. The player who removes the last cow wins. Given n, k, and a sequence a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an, help Kevin and Nicky find the winner, given that both sides play in optimal way." 2200

603B "Moodular Arithmetic" "combinatorics,dfs and similar,dsu,math,number theory" "As behooves any intelligent schoolboy, Kevin Sun is studying psycowlogy, cowculus, and cryptcowgraphy at the Bovinia State University (BGU) under Farmer Ivan. During his Mathematics of Olympiads (MoO) class, Kevin was confronted with a weird functional equation and needs your help. For two fixed integers k and p, where p is an odd prime number, the functional equation states that  for some function . (This equation should hold for any integer x in the range 0 to p\xe2\x80\x89-\xe2\x80\x891, inclusive.)It turns out that f can actually be many different functions. Instead of finding a solution, Kevin wants you to count the number of distinct functions f that satisfy this equation. Since the answer may be very large, you should print your result modulo 109\xe2\x80\x89+\xe2\x80\x897." 1800

603A "Alternative Thinking" dp,greedy,math "Kevin has just recevied his disappointing results on the USA Identification of Cows Olympiad (USAICO) in the form of a binary string of length n. Each character of Kevin\'s string represents Kevin\'s score on one of the n questions of the olympiad\xe2\x80\x94\'1\' for a correctly identified cow and \'0\' otherwise.However, all is not lost. Kevin is a big proponent of alternative thinking and believes that his score, instead of being the sum of his points, should be the length of the longest alternating subsequence of his string. Here, we define an alternating subsequence of a string as a not-necessarily contiguous subsequence where no two consecutive elements are equal. For example, {0,\xe2\x80\x891,\xe2\x80\x890,\xe2\x80\x891}, {1,\xe2\x80\x890,\xe2\x80\x891}, and {1,\xe2\x80\x890,\xe2\x80\x891,\xe2\x80\x890} are alternating sequences, while {1,\xe2\x80\x890,\xe2\x80\x890} and {0,\xe2\x80\x891,\xe2\x80\x890,\xe2\x80\x891,\xe2\x80\x891} are not.Kevin, being the sneaky little puffball that he is, is willing to hack into the USAICO databases to improve his score. In order to be subtle, he decides that he will flip exactly one substring\xe2\x80\x94that is, take a contiguous non-empty substring of his score and change all \'0\'s in that substring to \'1\'s and vice versa. After such an operation, Kevin wants to know the length of the longest possible alternating subsequence that his string could have." 1600

602B "Approximating a Constant Range" "dp,implementation,two pointers" "When Xellos was doing a practice course in university, he once had to measure the intensity of an effect that slowly approached equilibrium. A good way to determine the equilibrium intensity would be choosing a sufficiently large number of consecutive data points that seems as constant as possible and taking their average. Of course, with the usual sizes of data, it\'s nothing challenging�\xe2\x80\x94 but why not make a similar programming contest problem while we\'re at it?You\'re given a sequence of n data points a1,\xe2\x80\x89...,\xe2\x80\x89an. There aren\'t any big jumps between consecutive data points�\xe2\x80\x94 for each 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89n, it\'s guaranteed that |ai\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89-\xe2\x80\x89ai|\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x891.A range [l,\xe2\x80\x89r] of data points is said to be almost constant if the difference between the largest and the smallest value in that range is at most 1. Formally, let M be the maximum and m the minimum value of ai for l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r; the range [l,\xe2\x80\x89r] is almost constant if M\xe2\x80\x89-\xe2\x80\x89m\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x891.Find the length of the longest almost constant range." 1400

602A "Two Bases" "brute force,implementation" "After seeing the ""ALL YOUR BASE ARE BELONG TO US"" meme for the first time, numbers X and Y realised that they have different bases, which complicated their relations.You\'re given a number X represented in base bx and a number Y represented in base by. Compare those two numbers." 1100

601E "A Museum Robbery" "data structures,dp" "There\'s a famous museum in the city where Kleof\xc3\xa1\xc5\xa1 lives. In the museum, n exhibits (numbered 1 through n) had been displayed for a long time; the i-th of those exhibits has value vi and mass wi. Then, the museum was bought by a large financial group and started to vary the exhibits. At about the same time, Kleof\xc3\xa1\xc5\xa1... gained interest in the museum, so to say.You should process q events of three types: type 1 \xe2\x80\x94 the museum displays an exhibit with value v and mass w; the exhibit displayed in the i-th event of this type is numbered n\xe2\x80\x89+\xe2\x80\x89i (see sample explanation for more details) type 2 \xe2\x80\x94 the museum removes the exhibit with number x and stores it safely in its vault type 3 \xe2\x80\x94 Kleof\xc3\xa1\xc5\xa1 visits the museum and wonders (for no important reason at all, of course): if there was a robbery and exhibits with total mass at most m were stolen, what would their maximum possible total value be?For each event of type 3, let s(m) be the maximum possible total value of stolen exhibits with total mass \xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m.Formally, let D be the set of numbers of all exhibits that are currently displayed (so initially D = {1, ..., n}). Let P(D) be the set of all subsets of D and let Then, s(m) is defined as Compute s(m) for each . Note that the output follows a special format." 2800

601D "Acyclic Organic Compounds" "data structures,dfs and similar,dsu,hashing,strings,trees" "You are given a tree T with n vertices (numbered 1 through n) and a letter in each vertex. The tree is rooted at vertex 1.Let\'s look at the subtree Tv of some vertex v. It is possible to read a string along each simple path starting at v and ending at some vertex in Tv (possibly v itself). Let\'s denote the number of distinct strings which can be read this way as . Also, there\'s a number cv assigned to each vertex v. We are interested in vertices with the maximum value of .You should compute two statistics: the maximum value of  and the number of vertices v with the maximum ." 2400

601C "Kleof\xc3\xa1\xc5\xa1 and the n-thlon" dp,math,probabilities "You are given a tree T with n vertices (numbered 1 through n) and a letter in each vertex. The tree is rooted at vertex 1.Let\'s look at the subtree Tv of some vertex v. It is possible to read a string along each simple path starting at v and ending at some vertex in Tv (possibly v itself). Let\'s denote the number of distinct strings which can be read this way as . Also, there\'s a number cv assigned to each vertex v. We are interested in vertices with the maximum value of .You should compute two statistics: the maximum value of  and the number of vertices v with the maximum ." 2300

601B "Lipshitz Sequence" "data structures,math" "A function  is called Lipschitz continuous if there is a real constant K such that the inequality |f(x)\xe2\x80\x89-\xe2\x80\x89f(y)|\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89K\xc2\xb7|x\xe2\x80\x89-\xe2\x80\x89y| holds for all . We\'ll deal with a more... discrete version of this term.For an array , we define it\'s Lipschitz constant  as follows:  if n\xe2\x80\x89<\xe2\x80\x892,   if n\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x892,  over all 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n In other words,  is the smallest non-negative integer such that |h[i]\xe2\x80\x89-\xe2\x80\x89h[j]|\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89L\xc2\xb7|i\xe2\x80\x89-\xe2\x80\x89j| holds for all 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i,\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n.You are given an array  of size n and q queries of the form [l,\xe2\x80\x89r]. For each query, consider the subarray ; determine the sum of Lipschitz constants of all subarrays of ." 2100

601A "The Two Routes" "graphs,shortest paths" "In Absurdistan, there are n towns (numbered 1 through n) and m bidirectional railways. There is also an absurdly simple road network�\xe2\x80\x94 for each pair of different towns x and y, there is a bidirectional road between towns x and y if and only if there is no railway between them. Travelling to a different town using one railway or one road always takes exactly one hour.A train and a bus leave town 1 at the same time. They both have the same destination, town n, and don\'t make any stops on the way (but they can wait in town n). The train can move only along railways and the bus can move only along roads.You\'ve been asked to plan out routes for the vehicles; each route can use any road/railway multiple times. One of the most important aspects to consider is safety�\xe2\x80\x94 in order to avoid accidents at railway crossings, the train and the bus must not arrive at the same town (except town n) simultaneously.Under these constraints, what is the minimum number of hours needed for both vehicles to reach town n (the maximum of arrival times of the bus and the train)? Note, that bus and train are not required to arrive to the town n at the same moment of time, but are allowed to do so." 1600

600F "Edge coloring of bipartite graph" graphs "You are given an undirected bipartite graph without multiple edges. You should paint the edges of graph to minimal number of colours, so that no two adjacent edges have the same colour." 2800

600E "Lomsat gelral" "data structures,dfs and similar,dsu,trees" "You are given a rooted tree with root in vertex 1. Each vertex is coloured in some colour.Let\'s call colour c dominating in the subtree of vertex v if there are no other colours that appear in the subtree of vertex v more times than colour c. So it\'s possible that two or more colours will be dominating in the subtree of some vertex.The subtree of vertex v is the vertex v and all other vertices that contains vertex v in each path to the root.For each vertex v find the sum of all dominating colours in the subtree of vertex v." 2300

600D "Area of Two Circles\' Intersection" geometry "You are given a rooted tree with root in vertex 1. Each vertex is coloured in some colour.Let\'s call colour c dominating in the subtree of vertex v if there are no other colours that appear in the subtree of vertex v more times than colour c. So it\'s possible that two or more colours will be dominating in the subtree of some vertex.The subtree of vertex v is the vertex v and all other vertices that contains vertex v in each path to the root.For each vertex v find the sum of all dominating colours in the subtree of vertex v." 2000

600C "Make Palindrome" "constructive algorithms,greedy,strings" "A string is called palindrome if it reads the same from left to right and from right to left. For example ""kazak"", ""oo"", ""r"" and ""mikhailrubinchikkihcniburliahkim"" are palindroms, but strings ""abb"" and ""ij"" are not.You are given string s consisting of lowercase Latin letters. At once you can choose any position in the string and change letter in that position to any other lowercase letter. So after each changing the length of the string doesn\'t change. At first you can change some letters in s. Then you can permute the order of letters as you want. Permutation doesn\'t count as changes. You should obtain palindrome with the minimal number of changes. If there are several ways to do that you should get the lexicographically (alphabetically) smallest palindrome. So firstly you should minimize the number of changes and then minimize the palindrome lexicographically." 1800

600B "Queries about less or equal elements" "binary search,data structures,sortings,two pointers" "You are given two arrays of integers a and b. For each element of the second array bj you should find the number of elements in array a that are less than or equal to the value bj." 1300

600A "Extract Numbers" implementation,strings "You are given string s. Let\'s call word any largest sequence of consecutive symbols without symbols \',\' (comma) and \';\' (semicolon). For example, there are four words in string ""aba,123;1a;0"": ""aba"", ""123"", ""1a"", ""0"". A word can be empty: for example, the string s="";;"" contains three empty words separated by \';\'.You should find all words in the given string that are nonnegative INTEGER numbers without leading zeroes and build by them new string a. String a should contain all words that are numbers separating them by \',\' (the order of numbers should remain the same as in the string s). By all other words you should build string b in the same way (the order of numbers should remain the same as in the string s).Here strings ""101"", ""0"" are INTEGER numbers, but ""01"" and ""1.0"" are not.For example, for the string aba,123;1a;0 the string a would be equal to ""123,0"" and string b would be equal to ""aba,1a""." 1600

599E "Sandy and Nuts" bitmasks,dp,trees "Rooted tree is a connected graph without any simple cycles with one vertex selected as a root. In this problem the vertex number 1 will always serve as a root.Lowest common ancestor of two vertices u and v is the farthest from the root vertex that lies on both the path from u to the root and on path from v to the root. We will denote it as LCA(u,\xe2\x80\x89v).Sandy had a rooted tree consisting of n vertices that she used to store her nuts. Unfortunately, the underwater storm broke her tree and she doesn\'t remember all it\'s edges. She only managed to restore m edges of the initial tree and q triples ai, bi and ci, for which she supposes LCA(ai,\xe2\x80\x89bi)\xe2\x80\x89=\xe2\x80\x89ci.Help Sandy count the number of trees of size n with vertex 1 as a root, that match all the information she remembered. If she made a mess and there are no such trees then print 0. Two rooted trees are considered to be distinct if there exists an edge that occur in one of them and doesn\'t occur in the other one." 2600

599D "Spongebob and Squares" "brute force,math" "Spongebob is already tired trying to reason his weird actions and calculations, so he simply asked you to find all pairs of n and m, such that there are exactly x distinct squares in the table consisting of n rows and m columns. For example, in a 3\xe2\x80\x89\xc3\x97\xe2\x80\x895 table there are 15 squares with side one, 8 squares with side two and 3 squares with side three. The total number of distinct squares in a 3\xe2\x80\x89\xc3\x97\xe2\x80\x895 table is 15\xe2\x80\x89+\xe2\x80\x898\xe2\x80\x89+\xe2\x80\x893\xe2\x80\x89=\xe2\x80\x8926." 1900

599C "Day at the Beach" sortings "One day Squidward, Spongebob and Patrick decided to go to the beach. Unfortunately, the weather was bad, so the friends were unable to ride waves. However, they decided to spent their time building sand castles.At the end of the day there were n castles built by friends. Castles are numbered from 1 to n, and the height of the i-th castle is equal to hi. When friends were about to leave, Squidward noticed, that castles are not ordered by their height, and this looks ugly. Now friends are going to reorder the castles in a way to obtain that condition hi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89hi\xe2\x80\x89+\xe2\x80\x891 holds for all i from 1 to n\xe2\x80\x89-\xe2\x80\x891.Squidward suggested the following process of sorting castles:   Castles are split into blocks�\xe2\x80\x94 groups of consecutive castles. Therefore the block from i to j will include castles i,\xe2\x80\x89i\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89j. A block may consist of a single castle.  The partitioning is chosen in such a way that every castle is a part of exactly one block.  Each block is sorted independently from other blocks, that is the sequence hi,\xe2\x80\x89hi\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89hj becomes sorted.  The partitioning should satisfy the condition that after each block is sorted, the sequence hi becomes sorted too. This may always be achieved by saying that the whole sequence is a single block. Even Patrick understands that increasing the number of blocks in partitioning will ease the sorting process. Now friends ask you to count the maximum possible number of blocks in a partitioning that satisfies all the above requirements." 1600

599B "Spongebob and Joke" implementation "While Patrick was gone shopping, Spongebob decided to play a little trick on his friend. The naughty Sponge browsed through Patrick\'s personal stuff and found a sequence a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89am of length m, consisting of integers from 1 to n, not necessarily distinct. Then he picked some sequence f1,\xe2\x80\x89f2,\xe2\x80\x89...,\xe2\x80\x89fn of length n and for each number ai got number bi\xe2\x80\x89=\xe2\x80\x89fai. To finish the prank he erased the initial sequence ai.It\'s hard to express how sad Patrick was when he returned home from shopping! We will just say that Spongebob immediately got really sorry about what he has done and he is now trying to restore the original sequence. Help him do this or determine that this is impossible." 1500

599A "Patrick and Shopping" implementation "Today Patrick waits for a visit from his friend Spongebob. To prepare for the visit, Patrick needs to buy some goodies in two stores located near his house. There is a d1 meter long road between his house and the first shop and a d2 meter long road between his house and the second shop. Also, there is a road of length d3 directly connecting these two shops to each other. Help Patrick calculate the minimum distance that he needs to walk in order to go to both shops and return to his house.  Patrick always starts at his house. He should visit both shops moving only along the three existing roads and return back to his house. He doesn\'t mind visiting the same shop or passing the same road multiple times. The only goal is to minimize the total distance traveled." 800

598F "Cut Length" geometry "Given simple (without self-intersections) n-gon. It is not necessary convex. Also you are given m lines. For each line find the length of common part of the line and the n-gon.The boundary of n-gon belongs to polygon. It is possible that n-gon contains 180-degree angles." 2900

598E "Chocolate Bar" "brute force,dp" "You have a rectangular chocolate bar consisting of n\xe2\x80\x89\xc3\x97\xe2\x80\x89m single squares. You want to eat exactly k squares, so you may need to break the chocolate bar. In one move you can break any single rectangular piece of chocolate in two rectangular pieces. You can break only by lines between squares: horizontally or vertically. The cost of breaking is equal to square of the break length.For example, if you have a chocolate bar consisting of 2\xe2\x80\x89\xc3\x97\xe2\x80\x893 unit squares then you can break it horizontally and get two 1\xe2\x80\x89\xc3\x97\xe2\x80\x893 pieces (the cost of such breaking is 32\xe2\x80\x89=\xe2\x80\x899), or you can break it vertically in two ways and get two pieces: 2\xe2\x80\x89\xc3\x97\xe2\x80\x891 and 2\xe2\x80\x89\xc3\x97\xe2\x80\x892 (the cost of such breaking is 22\xe2\x80\x89=\xe2\x80\x894).For several given values n, m and k find the minimum total cost of breaking. You can eat exactly k squares of chocolate if after all operations of breaking there is a set of rectangular pieces of chocolate with the total size equal to k squares. The remaining n\xc2\xb7m\xe2\x80\x89-\xe2\x80\x89k squares are not necessarily form a single rectangular piece." 2000

598D "Igor In the Museum" "dfs and similar,graphs,shortest paths" "Igor is in the museum and he wants to see as many pictures as possible.Museum can be represented as a rectangular field of n\xe2\x80\x89\xc3\x97\xe2\x80\x89m cells. Each cell is either empty or impassable. Empty cells are marked with \'.\', impassable cells are marked with \'*\'. Every two adjacent cells of different types (one empty and one impassable) are divided by a wall containing one picture.At the beginning Igor is in some empty cell. At every moment he can move to any empty cell that share a side with the current one.For several starting positions you should calculate the maximum number of pictures that Igor can see. Igor is able to see the picture only if he is in the cell adjacent to the wall with this picture. Igor have a lot of time, so he will examine every picture he can see." 1700

598C "Nearest vectors" geometry,sortings "You are given the set of vectors on the plane, each of them starting at the origin. Your task is to find a pair of vectors with the minimal non-oriented angle between them.Non-oriented angle is non-negative value, minimal between clockwise and counterclockwise direction angles. Non-oriented angle is always between 0 and \xcf\x80. For example, opposite directions vectors have angle equals to \xcf\x80." 2300

598B "Queries on a String" implementation,strings "You are given a string s and should process m queries. Each query is described by two 1-based indices li, ri and integer ki. It means that you should cyclically shift the substring s[li... ri] ki times. The queries should be processed one after another in the order they are given.One operation of a cyclic shift (rotation) is equivalent to moving the last character to the position of the first character and shifting all other characters one position to the right.For example, if the string s is abacaba and the query is l1\xe2\x80\x89=\xe2\x80\x893,\xe2\x80\x89r1\xe2\x80\x89=\xe2\x80\x896,\xe2\x80\x89k1\xe2\x80\x89=\xe2\x80\x891 then the answer is abbacaa. If after that we would process the query l2\xe2\x80\x89=\xe2\x80\x891,\xe2\x80\x89r2\xe2\x80\x89=\xe2\x80\x894,\xe2\x80\x89k2\xe2\x80\x89=\xe2\x80\x892 then we would get the string baabcaa." 1300

598A "Tricky Sum" math "In this problem you are to calculate the sum of all integers from 1 to n, but you should take all powers of two with minus in the sum.For example, for n\xe2\x80\x89=\xe2\x80\x894 the sum is equal to \xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89-\xe2\x80\x892\xe2\x80\x89+\xe2\x80\x893\xe2\x80\x89-\xe2\x80\x894\xe2\x80\x89=\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x894, because 1, 2 and 4 are 20, 21 and 22 respectively.Calculate the answer for t values of n." 900

597C Subsequences "data structures,dp" "For the given sequence with n different elements find the number of increasing subsequences with k\xe2\x80\x89+\xe2\x80\x891 elements. It is guaranteed that the answer is not greater than 8\xc2\xb71018." 1900

597B Restaurant dp,greedy,sortings "A restaurant received n orders for the rental. Each rental order reserve the restaurant for a continuous period of time, the i-th order is characterized by two time values \xe2\x80\x94 the start time li and the finish time ri (li\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ri).Restaurant management can accept and reject orders. What is the maximal number of orders the restaurant can accept?No two accepted orders can intersect, i.e. they can\'t share even a moment of time. If one order ends in the moment other starts, they can\'t be accepted both." 1600

597A Divisibility math "Find the number of k-divisible numbers on the segment [a,\xe2\x80\x89b]. In other words you need to find the number of such integer values x that a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b and x is divisible by k." 1600

596E "Wilbur and Strings" "dfs and similar,dp,graphs,strings" "Wilbur the pig now wants to play with strings. He has found an n by m table consisting only of the digits from 0 to 9 where the rows are numbered 1 to n and the columns are numbered 1 to m. Wilbur starts at some square and makes certain moves. If he is at square (x, y) and the digit d (0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89d\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x899) is written at position (x, y), then he must move to the square (x\xe2\x80\x89+\xe2\x80\x89ad, y\xe2\x80\x89+\xe2\x80\x89bd), if that square lies within the table, and he stays in the square (x, y) otherwise. Before Wilbur makes a move, he can choose whether or not to write the digit written in this square on the white board. All digits written on the whiteboard form some string. Every time a new digit is written, it goes to the end of the current string.Wilbur has q strings that he is worried about. For each string si, Wilbur wants to know whether there exists a starting position (x, y) so that by making finitely many moves, Wilbur can end up with the string si written on the white board." 2500

596D "Wilbur and Trees" dp,math,probabilities,sortings "Wilbur the pig really wants to be a beaver, so he decided today to pretend he is a beaver and bite at trees to cut them down.There are n trees located at various positions on a line. Tree i is located at position xi. All the given positions of the trees are distinct.The trees are equal, i.e. each tree has height h. Due to the wind, when a tree is cut down, it either falls left with probability p, or falls right with probability 1\xe2\x80\x89-\xe2\x80\x89p. If a tree hits another tree while falling, that tree will fall in the same direction as the tree that hit it. A tree can hit another tree only if the distance between them is strictly less than h. For example, imagine there are 4 trees located at positions 1, 3, 5 and 8, while h\xe2\x80\x89=\xe2\x80\x893 and the tree at position 1 falls right. It hits the tree at position 3 and it starts to fall too. In it\'s turn it hits the tree at position 5 and it also starts to fall. The distance between 8 and 5 is exactly 3, so the tree at position 8 will not fall.As long as there are still trees standing, Wilbur will select either the leftmost standing tree with probability 0.5 or the rightmost standing tree with probability 0.5. Selected tree is then cut down. If there is only one tree remaining, Wilbur always selects it. As the ground is covered with grass, Wilbur wants to know the expected total length of the ground covered with fallen trees after he cuts them all down because he is concerned about his grass-eating cow friends. Please help Wilbur." 2300

596C "Wilbur and Points" combinatorics,greedy,sortings "Wilbur is playing with a set of n points on the coordinate plane. All points have non-negative integer coordinates. Moreover, if some point (x, y) belongs to the set, then all points (x\', y\'), such that 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\'\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x and 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y\'\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y also belong to this set.Now Wilbur wants to number the points in the set he has, that is assign them distinct integer numbers from 1 to n. In order to make the numbering aesthetically pleasing, Wilbur imposes the condition that if some point (x, y) gets number i, then all (x\',y\') from the set, such that x\'\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89x and y\'\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89y must be assigned a number not less than i. For example, for a set of four points (0, 0), (0, 1), (1, 0) and (1, 1), there are two aesthetically pleasing numberings. One is 1, 2, 3, 4 and another one is 1, 3, 2, 4.Wilbur\'s friend comes along and challenges Wilbur. For any point he defines it\'s special value as s(x,\xe2\x80\x89y)\xe2\x80\x89=\xe2\x80\x89y\xe2\x80\x89-\xe2\x80\x89x. Now he gives Wilbur some w1, w2,..., wn, and asks him to find an aesthetically pleasing numbering of the points in the set, such that the point that gets number i has it\'s special value equal to wi, that is s(xi,\xe2\x80\x89yi)\xe2\x80\x89=\xe2\x80\x89yi\xe2\x80\x89-\xe2\x80\x89xi\xe2\x80\x89=\xe2\x80\x89wi.Now Wilbur asks you to help him with this challenge." 1700

596B "Wilbur and Array" greedy,implementation "Wilbur the pig is tinkering with arrays again. He has the array a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an initially consisting of n zeros. At one step, he can choose any index i and either add 1 to all elements ai,\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89... ,\xe2\x80\x89an or subtract 1 from all elements ai,\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89an. His goal is to end up with the array b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bn. Of course, Wilbur wants to achieve this goal in the minimum number of steps and asks you to compute this value." 1100

596A "Wilbur and Swimming Pool" geometry,implementation "After making bad dives into swimming pools, Wilbur wants to build a swimming pool in the shape of a rectangle in his backyard. He has set up coordinate axes, and he wants the sides of the rectangle to be parallel to them. Of course, the area of the rectangle must be positive. Wilbur had all four vertices of the planned pool written on a paper, until his friend came along and erased some of the vertices.Now Wilbur is wondering, if the remaining n vertices of the initial rectangle give enough information to restore the area of the planned swimming pool." 1100

595B "Pasha and Phone" "binary search,math" "Pasha has recently bought a new phone jPager and started adding his friends\' phone numbers there. Each phone number consists of exactly n digits.Also Pasha has a number k and two sequences of length n\xe2\x80\x89/\xe2\x80\x89k (n is divisible by k) a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an\xe2\x80\x89/\xe2\x80\x89k and b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bn\xe2\x80\x89/\xe2\x80\x89k. Let\'s split the phone number into blocks of length k. The first block will be formed by digits from the phone number that are on positions 1, 2,..., k, the second block will be formed by digits from the phone number that are on positions k\xe2\x80\x89+\xe2\x80\x891, k\xe2\x80\x89+\xe2\x80\x892, ..., 2\xc2\xb7k and so on. Pasha considers a phone number good, if the i-th block doesn\'t start from the digit bi and is divisible by ai if represented as an integer. To represent the block of length k as an integer, let\'s write it out as a sequence c1, c2,...,ck. Then the integer is calculated as the result of the expression c1\xc2\xb710k\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x89c2\xc2\xb710k\xe2\x80\x89-\xe2\x80\x892\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89ck.Pasha asks you to calculate the number of good phone numbers of length n, for the given k, ai and bi. As this number can be too big, print it modulo 109\xe2\x80\x89+\xe2\x80\x897." 1600

595A "Vitaly and Night" "constructive algorithms,implementation" "One day Vitaly was going home late at night and wondering: how many people aren\'t sleeping at that moment? To estimate, Vitaly decided to look which windows are lit in the house he was passing by at that moment.Vitaly sees a building of n floors and 2\xc2\xb7m windows on each floor. On each floor there are m flats numbered from 1 to m, and two consecutive windows correspond to each flat. If we number the windows from 1 to 2\xc2\xb7m from left to right, then the j-th flat of the i-th floor has windows 2\xc2\xb7j\xe2\x80\x89-\xe2\x80\x891 and 2\xc2\xb7j in the corresponding row of windows (as usual, floors are enumerated from the bottom). Vitaly thinks that people in the flat aren\'t sleeping at that moment if at least one of the windows corresponding to this flat has lights on.Given the information about the windows of the given house, your task is to calculate the number of flats where, according to Vitaly, people aren\'t sleeping." 800

594E "Cutting the Line" "string suffix structures,strings" "You are given a non-empty line s and an integer k. The following operation is performed with this line exactly once:  A line is split into at most k non-empty substrings, i.e. string s is represented as a concatenation of a set of strings s\xe2\x80\x89=\xe2\x80\x89t1\xe2\x80\x89+\xe2\x80\x89t2\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89tm, 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k.  Some of strings ti are replaced by strings tir, that is, their record from right to left.  The lines are concatenated back in the same order, we get string s\'\xe2\x80\x89=\xe2\x80\x89t\'1t\'2... t\'m, where t\'i equals ti or tir. Your task is to determine the lexicographically smallest string that could be the result of applying the given operation to the string s." 3100

594D REQ "data structures,number theory" "Today on a math lesson the teacher told Vovochka that the Euler function of a positive integer \xcf\x86(n) is an arithmetic function that counts the positive integers less than or equal to n that are relatively prime to n. The number 1 is coprime to all the positive integers and \xcf\x86(1)\xe2\x80\x89=\xe2\x80\x891.Now the teacher gave Vovochka an array of n positive integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an and a task to process q queries li ri�\xe2\x80\x94 to calculate and print  modulo 109\xe2\x80\x89+\xe2\x80\x897. As it is too hard for a second grade school student, you\'ve decided to help Vovochka." 2500

594C "Edo and Magnets" "brute force,greedy,implementation,two pointers" "Edo has got a collection of n refrigerator magnets!He decided to buy a refrigerator and hang the magnets on the door. The shop can make the refrigerator with any size of the door that meets the following restrictions: the refrigerator door must be rectangle, and both the length and the width of the door must be positive integers.Edo figured out how he wants to place the magnets on the refrigerator. He introduced a system of coordinates on the plane, where each magnet is represented as a rectangle with sides parallel to the coordinate axes.Now he wants to remove no more than k magnets (he may choose to keep all of them) and attach all remaining magnets to the refrigerator door, and the area of \xe2\x80\x8b\xe2\x80\x8bthe door should be as small as possible. A magnet is considered to be attached to the refrigerator door if its center lies on the door or on its boundary. The relative positions of all the remaining magnets must correspond to the plan.Let us explain the last two sentences. Let\'s suppose we want to hang two magnets on the refrigerator. If the magnet in the plan has coordinates of the lower left corner (x1, y1) and the upper right corner (x2, y2), then its center is located at (, ) (may not be integers). By saying the relative position should correspond to the plan we mean that the only available operation is translation, i.e. the vector connecting the centers of two magnets in the original plan, must be equal to the vector connecting the centers of these two magnets on the refrigerator.The sides of the refrigerator door must also be parallel to coordinate axes." 2300

594B "Max and Bike" "binary search,geometry" "For months Maxim has been coming to work on his favorite bicycle. And quite recently he decided that he is ready to take part in a cyclists\' competitions.He knows that this year n competitions will take place. During the i-th competition the participant must as quickly as possible complete a ride along a straight line from point si to point fi (si\xe2\x80\x89<\xe2\x80\x89fi).Measuring time is a complex process related to usage of a special sensor and a time counter. Think of the front wheel of a bicycle as a circle of radius r. Let\'s neglect the thickness of a tire, the size of the sensor, and all physical effects. The sensor is placed on the rim of the wheel, that is, on some fixed point on a circle of radius r. After that the counter moves just like the chosen point of the circle, i.e. moves forward and rotates around the center of the circle.At the beginning each participant can choose any point bi, such that his bike is fully behind the starting line, that is, bi\xe2\x80\x89<\xe2\x80\x89si\xe2\x80\x89-\xe2\x80\x89r. After that, he starts the movement, instantly accelerates to his maximum speed and at time tsi, when the coordinate of the sensor is equal to the coordinate of the start, the time counter starts. The cyclist makes a complete ride, moving with his maximum speed and at the moment the sensor\'s coordinate is equal to the coordinate of the finish (moment of time tfi), the time counter deactivates and records the final time. Thus, the counter records that the participant made a complete ride in time tfi\xe2\x80\x89-\xe2\x80\x89tsi.  Maxim is good at math and he suspects that the total result doesn\'t only depend on his maximum speed v, but also on his choice of the initial point bi. Now Maxim is asking you to calculate for each of n competitions the minimum possible time that can be measured by the time counter. The radius of the wheel of his bike is equal to r." 2500

594A "Warrior and Archer" games "In the official contest this problem has a different statement, for which jury\'s solution was working incorrectly, and for this reason it was excluded from the contest. This mistake have been fixed and the current given problem statement and model solution corresponds to what jury wanted it to be during the contest.Vova and Lesha are friends. They often meet at Vova\'s place and compete against each other in a computer game named The Ancient Papyri: Swordsink. Vova always chooses a warrior as his fighter and Leshac chooses an archer. After that they should choose initial positions for their characters and start the fight. A warrior is good at melee combat, so Vova will try to make the distance between fighters as small as possible. An archer prefers to keep the enemy at a distance, so Lesha will try to make the initial distance as large as possible.There are n (n is always even) possible starting positions for characters marked along the Ox axis. The positions are given by their distinct coordinates x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xn, two characters cannot end up at the same position.Vova and Lesha take turns banning available positions, Vova moves first. During each turn one of the guys bans exactly one of the remaining positions. Banned positions cannot be used by both Vova and Lesha. They continue to make moves until there are only two possible positions remaining (thus, the total number of moves will be n\xe2\x80\x89-\xe2\x80\x892). After that Vova\'s character takes the position with the lesser coordinate and Lesha\'s character takes the position with the bigger coordinate and the guys start fighting.Vova and Lesha are already tired by the game of choosing positions, as they need to play it before every fight, so they asked you (the developer of the The Ancient Papyri: Swordsink) to write a module that would automatically determine the distance at which the warrior and the archer will start fighting if both Vova and Lesha play optimally." 2300

593E "Strange Calculation and Cats" dp,matrices "Gosha\'s universe is a table consisting of n rows and m columns. Both the rows and columns are numbered with consecutive integers starting with 1. We will use (r,\xe2\x80\x89c) to denote a cell located in the row r and column c.Gosha is often invited somewhere. Every time he gets an invitation, he first calculates the number of ways to get to this place, and only then he goes. Gosha\'s house is located in the cell (1,\xe2\x80\x891).At any moment of time, Gosha moves from the cell he is currently located in to a cell adjacent to it (two cells are adjacent if they share a common side). Of course, the movement is possible only if such a cell exists, i.e. Gosha will not go beyond the boundaries of the table. Thus, from the cell (r,\xe2\x80\x89c) he is able to make a move to one of the cells (r\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89c), (r,\xe2\x80\x89c\xe2\x80\x89-\xe2\x80\x891), (r\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89c), (r,\xe2\x80\x89c\xe2\x80\x89+\xe2\x80\x891). Also, Ghosha can skip a move and stay in the current cell (r,\xe2\x80\x89c).Besides the love of strange calculations, Gosha is allergic to cats, so he never goes to the cell that has a cat in it. Gosha knows exactly where and when he will be invited and the schedule of cats travelling along the table. Formally, he has q records, the i-th of them has one of the following forms:   1, xi, yi, ti�\xe2\x80\x94 Gosha is invited to come to cell (xi,\xe2\x80\x89yi) at the moment of time ti. It is guaranteed that there is no cat inside cell (xi,\xe2\x80\x89yi) at this moment of time.  2, xi, yi, ti�\xe2\x80\x94 at the moment ti a cat appears in cell (xi,\xe2\x80\x89yi). It is guaranteed that no other cat is located in this cell (xi,\xe2\x80\x89yi) at that moment of time.  3, xi, yi, ti�\xe2\x80\x94 at the moment ti a cat leaves cell (xi,\xe2\x80\x89yi). It is guaranteed that there is cat located in the cell (xi,\xe2\x80\x89yi). Gosha plans to accept only one invitation, but he has not yet decided, which particular one. In order to make this decision, he asks you to calculate for each of the invitations i the number of ways to get to the cell (xi,\xe2\x80\x89yi) at the moment ti. For every invitation, assume that Gosha he starts moving from cell (1,\xe2\x80\x891) at the moment 1.Moving between two neighboring cells takes Gosha exactly one unit of tim. In particular, this means that Gosha can come into the cell only if a cat sitting in it leaves the moment when Gosha begins his movement from the neighboring cell, and if none of the cats comes to the cell at the time when Gosha is in it.Two ways to go from cell (1,\xe2\x80\x891) to cell (x,\xe2\x80\x89y) at time t are considered distinct if for at least one moment of time from 1 to t Gosha\'s positions are distinct for the two ways at this moment. Note, that during this travel Gosha is allowed to visit both (1,\xe2\x80\x891) and (x,\xe2\x80\x89y) multiple times. Since the number of ways can be quite large, print it modulo 109\xe2\x80\x89+\xe2\x80\x897." 2400

593D "Happy Tree Party" "data structures,dfs and similar,graphs,math,trees" "Bogdan has a birthday today and mom gave him a tree consisting of n vertecies. For every edge of the tree i, some number xi was written on it. In case you forget, a tree is a connected non-directed graph without cycles. After the present was granted, m guests consecutively come to Bogdan\'s party. When the i-th guest comes, he performs exactly one of the two possible operations:   Chooses some number yi, and two vertecies ai and bi. After that, he moves along the edges of the tree from vertex ai to vertex bi using the shortest path (of course, such a path is unique in the tree). Every time he moves along some edge j, he replaces his current number yi by , that is, by the result of integer division yi div xj.  Chooses some edge pi and replaces the value written in it xpi by some positive integer ci\xe2\x80\x89<\xe2\x80\x89xpi. As Bogdan cares about his guests, he decided to ease the process. Write a program that performs all the operations requested by guests and outputs the resulting value yi for each i of the first type." 2400

593C "Beautiful Function" "constructive algorithms,math" "Every day Ruslan tried to count sheep to fall asleep, but this didn\'t help. Now he has found a more interesting thing to do. First, he thinks of some set of circles on a plane, and then tries to choose a beautiful set of points, such that there is at least one point from the set inside or on the border of each of the imagined circles.Yesterday Ruslan tried to solve this problem for the case when the set of points is considered beautiful if it is given as (xt\xe2\x80\x89=\xe2\x80\x89f(t),\xe2\x80\x89yt\xe2\x80\x89=\xe2\x80\x89g(t)), where argument t takes all integer values from 0 to 50. Moreover, f(t) and g(t) should be correct functions.Assume that w(t) and h(t) are some correct functions, and c is an integer ranging from 0 to 50. The function s(t) is correct if it\'s obtained by one of the following rules:  s(t)\xe2\x80\x89=\xe2\x80\x89abs(w(t)), where abs(x) means taking the absolute value of a number x, i.e. |x|; s(t)\xe2\x80\x89=\xe2\x80\x89(w(t)\xe2\x80\x89+\xe2\x80\x89h(t)); s(t)\xe2\x80\x89=\xe2\x80\x89(w(t)\xe2\x80\x89-\xe2\x80\x89h(t)); s(t)\xe2\x80\x89=\xe2\x80\x89(w(t)\xe2\x80\x89*\xe2\x80\x89h(t)), where \xe2\x80\x89*\xe2\x80\x89 means multiplication, i.e. (w(t)\xc2\xb7h(t)); s(t)\xe2\x80\x89=\xe2\x80\x89c; s(t)\xe2\x80\x89=\xe2\x80\x89t;Yesterday Ruslan thought on and on, but he could not cope with the task. Now he asks you to write a program that computes the appropriate f(t) and g(t) for any set of at most 50 circles.In each of the functions f(t) and g(t) you are allowed to use no more than 50 multiplications. The length of any function should not exceed 100\xc2\xb7n characters. The function should not contain spaces.Ruslan can\'t keep big numbers in his memory, so you should choose f(t) and g(t), such that for all integer t from 0 to 50 value of f(t) and g(t) and all the intermediate calculations won\'t exceed 109 by their absolute value." 2200

593B "Anton and Lines" geometry,sortings "The teacher gave Anton a large geometry homework, but he didn\'t do it (as usual) as he participated in a regular round on Codeforces. In the task he was given a set of n lines defined by the equations y\xe2\x80\x89=\xe2\x80\x89ki\xc2\xb7x\xe2\x80\x89+\xe2\x80\x89bi. It was necessary to determine whether there is at least one point of intersection of two of these lines, that lays strictly inside the strip between x1\xe2\x80\x89<\xe2\x80\x89x2. In other words, is it true that there are 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n and x\',\xe2\x80\x89y\', such that:   y\'\xe2\x80\x89=\xe2\x80\x89ki\xe2\x80\x89*\xe2\x80\x89x\'\xe2\x80\x89+\xe2\x80\x89bi, that is, point (x\',\xe2\x80\x89y\') belongs to the line number i;  y\'\xe2\x80\x89=\xe2\x80\x89kj\xe2\x80\x89*\xe2\x80\x89x\'\xe2\x80\x89+\xe2\x80\x89bj, that is, point (x\',\xe2\x80\x89y\') belongs to the line number j;  x1\xe2\x80\x89<\xe2\x80\x89x\'\xe2\x80\x89<\xe2\x80\x89x2, that is, point (x\',\xe2\x80\x89y\') lies inside the strip bounded by x1\xe2\x80\x89<\xe2\x80\x89x2. You can\'t leave Anton in trouble, can you? Write a program that solves the given task." 1600

593A 2Char "brute force,implementation" "Andrew often reads articles in his favorite magazine 2Char. The main feature of these articles is that each of them uses at most two distinct letters. Andrew decided to send an article to the magazine, but as he hasn\'t written any article, he just decided to take a random one from magazine 26Char. However, before sending it to the magazine 2Char, he needs to adapt the text to the format of the journal. To do so, he removes some words from the chosen article, in such a way that the remaining text can be written using no more than two distinct letters.Since the payment depends from the number of non-space characters in the article, Andrew wants to keep the words with the maximum total length." 1200

592E BCPC "binary search,geometry,two pointers" "BCPC stands for Byteforces Collegiate Programming Contest, and is the most famous competition in Byteforces.BCPC is a team competition. Each team is composed by a coach and three contestants. Blenda is the coach of the Bit State University(BSU), and she is very strict selecting the members of her team.  In BSU there are n students numbered from 1 to n. Since all BSU students are infinitely smart, the only important parameters for Blenda are their reading and writing speed. After a careful measuring, Blenda have found that the i-th student have a reading speed equal to ri (words per minute), and a writing speed of wi (symbols per minute). Since BSU students are very smart, the measured speeds are sometimes very big and Blenda have decided to subtract some constant value c from all the values of reading speed and some value d from all the values of writing speed. Therefore she considers ri\'\xe2\x80\x89=\xe2\x80\x89ri\xe2\x80\x89-\xe2\x80\x89c and wi\'\xe2\x80\x89=\xe2\x80\x89wi\xe2\x80\x89-\xe2\x80\x89d. The student i is said to overwhelm the student j if and only if ri\'\xc2\xb7wj\'\xe2\x80\x89>\xe2\x80\x89rj\'\xc2\xb7wi\'. Blenda doesn\xe2\x80\x99t like fights in teams, so she thinks that a team consisting of three distinct students i,\xe2\x80\x89j and k is good if i overwhelms j, j overwhelms k, and k overwhelms i. Yes, the relation of overwhelming is not transitive as it often happens in real life.Since Blenda is busy preparing a training camp in Codeforces, you are given a task to calculate the number of different good teams in BSU. Two teams are considered to be different if there is at least one student that is present in one team but is not present in the other. In other words, two teams are different if the sets of students that form these teams are different." 2700

592D "Super M" "dfs and similar,dp,graphs,trees" "Ari the monster is not an ordinary monster. She is the hidden identity of Super M, the Byteforces\xe2\x80\x99 superhero. Byteforces is a country that consists of n cities, connected by n\xe2\x80\x89-\xe2\x80\x891 bidirectional roads. Every road connects exactly two distinct cities, and the whole road system is designed in a way that one is able to go from any city to any other city using only the given roads. There are m cities being attacked by humans. So Ari... we meant Super M have to immediately go to each of the cities being attacked to scare those bad humans. Super M can pass from one city to another only using the given roads. Moreover, passing through one road takes her exactly one kron - the time unit used in Byteforces.   However, Super M is not on Byteforces now - she is attending a training camp located in a nearby country Codeforces. Fortunately, there is a special device in Codeforces that allows her to instantly teleport from Codeforces to any city of Byteforces. The way back is too long, so for the purpose of this problem teleportation is used exactly once.You are to help Super M, by calculating the city in which she should teleport at the beginning in order to end her job in the minimum time (measured in krons). Also, provide her with this time so she can plan her way back to Codeforces." 2200

592C "The Big Race" math "Vector Willman and Array Bolt are the two most famous athletes of Byteforces. They are going to compete in a race with a distance of L meters today.  Willman and Bolt have exactly the same speed, so when they compete the result is always a tie. That is a problem for the organizers because they want a winner. While watching previous races the organizers have noticed that Willman can perform only steps of length equal to w meters, and Bolt can perform only steps of length equal to b meters. Organizers decided to slightly change the rules of the race. Now, at the end of the racetrack there will be an abyss, and the winner will be declared the athlete, who manages to run farther from the starting point of the the racetrack (which is not the subject to change by any of the athletes). Note that none of the athletes can run infinitely far, as they both will at some moment of time face the point, such that only one step further will cause them to fall in the abyss. In other words, the athlete will not fall into the abyss if the total length of all his steps will be less or equal to the chosen distance L.Since the organizers are very fair, the are going to set the length of the racetrack as an integer chosen randomly and uniformly in range from 1 to t (both are included). What is the probability that Willman and Bolt tie again today?" 1800

592B "The Monster and the Squirrel" math "Ari the monster always wakes up very early with the first ray of the sun and the first thing she does is feeding her squirrel.Ari draws a regular convex polygon on the floor and numbers it\'s vertices 1,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89n in clockwise order. Then starting from the vertex 1 she draws a ray in the direction of each other vertex. The ray stops when it reaches a vertex or intersects with another ray drawn before. Ari repeats this process for vertex 2,\xe2\x80\x893,\xe2\x80\x89...,\xe2\x80\x89n (in this particular order). And then she puts a walnut in each region inside the polygon.  Ada the squirrel wants to collect all the walnuts, but she is not allowed to step on the lines drawn by Ari. That means Ada have to perform a small jump if she wants to go from one region to another. Ada can jump from one region P to another region Q if and only if P and Q share a side or a corner.Assuming that Ada starts from outside of the picture, what is the minimum number of jumps she has to perform in order to collect all the walnuts?" 1100

592A PawnChess implementation "Galois is one of the strongest chess players of Byteforces. He has even invented a new variant of chess, which he named \xc2\xabPawnChess\xc2\xbb.This new game is played on a board consisting of 8 rows and 8 columns. At the beginning of every game some black and white pawns are placed on the board. The number of black pawns placed is not necessarily equal to the number of white pawns placed.   Lets enumerate rows and columns with integers from 1 to 8. Rows are numbered from top to bottom, while columns are numbered from left to right. Now we denote as (r,\xe2\x80\x89c) the cell located at the row r and at the column c.There are always two players A and B playing the game. Player A plays with white pawns, while player B plays with black ones. The goal of player A is to put any of his pawns to the row 1, while player B tries to put any of his pawns to the row 8. As soon as any of the players completes his goal the game finishes immediately and the succeeded player is declared a winner.Player A moves first and then they alternate turns. On his move player A must choose exactly one white pawn and move it one step upward and player B (at his turn) must choose exactly one black pawn and move it one step down. Any move is possible only if the targeted cell is empty. It\'s guaranteed that for any scenario of the game there will always be at least one move available for any of the players.Moving upward means that the pawn located in (r,\xe2\x80\x89c) will go to the cell (r\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89c), while moving down means the pawn located in (r,\xe2\x80\x89c) will go to the cell (r\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89c). Again, the corresponding cell must be empty, i.e. not occupied by any other pawn of any color.Given the initial disposition of the board, determine who wins the game if both players play optimally. Note that there will always be a winner due to the restriction that for any game scenario both players will have some moves available." 1200

591B Rebranding implementation,strings "The name of one small but proud corporation consists of n lowercase English letters. The Corporation has decided to try rebranding�\xe2\x80\x94 an active marketing strategy, that includes a set of measures to change either the brand (both for the company and the goods it produces) or its components: the name, the logo, the slogan. They decided to start with the name.For this purpose the corporation has consecutively hired m designers. Once a company hires the i-th designer, he immediately contributes to the creation of a new corporation name as follows: he takes the newest version of the name and replaces all the letters xi by yi, and all the letters yi by xi. This results in the new version. It is possible that some of these letters do no occur in the string. It may also happen that xi coincides with yi. The version of the name received after the work of the last designer becomes the new name of the corporation.Manager Arkady has recently got a job in this company, but is already soaked in the spirit of teamwork and is very worried about the success of the rebranding. Naturally, he can\'t wait to find out what is the new name the Corporation will receive.Satisfy Arkady\'s curiosity and tell him the final version of the name." 1200

591A "Wizards\' Duel" implementation,math "The name of one small but proud corporation consists of n lowercase English letters. The Corporation has decided to try rebranding�\xe2\x80\x94 an active marketing strategy, that includes a set of measures to change either the brand (both for the company and the goods it produces) or its components: the name, the logo, the slogan. They decided to start with the name.For this purpose the corporation has consecutively hired m designers. Once a company hires the i-th designer, he immediately contributes to the creation of a new corporation name as follows: he takes the newest version of the name and replaces all the letters xi by yi, and all the letters yi by xi. This results in the new version. It is possible that some of these letters do no occur in the string. It may also happen that xi coincides with yi. The version of the name received after the work of the last designer becomes the new name of the corporation.Manager Arkady has recently got a job in this company, but is already soaked in the spirit of teamwork and is very worried about the success of the rebranding. Naturally, he can\'t wait to find out what is the new name the Corporation will receive.Satisfy Arkady\'s curiosity and tell him the final version of the name." 900

590E Birthday "graph matchings,strings" "Today is birthday of a Little Dasha�\xe2\x80\x94 she is now 8 years old! On this occasion, each of her n friends and relatives gave her a ribbon with a greeting written on it, and, as it turned out, all the greetings are different. Dasha gathered all the ribbons and decided to throw away some of them in order to make the remaining set stylish. The birthday girl considers a set of ribbons stylish if no greeting written on some ribbon is a substring of another greeting written on some other ribbon. Let us recall that the substring of the string s is a continuous segment of s.Help Dasha to keep as many ribbons as possible, so that she could brag about them to all of her friends. Dasha cannot rotate or flip ribbons, that is, each greeting can be read in a single way given in the input." 3200

590D "Top Secret Task" dp "A top-secret military base under the command of Colonel Zuev is expecting an inspection from the Ministry of Defence. According to the charter, each top-secret military base must include a top-secret troop that should... well, we cannot tell you exactly what it should do, it is a top secret troop at the end. The problem is that Zuev\'s base is missing this top-secret troop for some reasons.The colonel decided to deal with the problem immediately and ordered to line up in a single line all n soldiers of the base entrusted to him. Zuev knows that the loquacity of the i-th soldier from the left is equal to qi. Zuev wants to form the top-secret troop using k leftmost soldiers in the line, thus he wants their total loquacity to be as small as possible (as the troop should remain top-secret). To achieve this, he is going to choose a pair of consecutive soldiers and swap them. He intends to do so no more than s times. Note that any soldier can be a participant of such swaps for any number of times. The problem turned out to be unusual, and colonel Zuev asked you to help.Determine, what is the minimum total loquacity of the first k soldiers in the line, that can be achieved by performing no more than s swaps of two consecutive soldiers." 2300

590C "Three States" "dfs and similar,graphs,shortest paths" "The famous global economic crisis is approaching rapidly, so the states of Berman, Berance and Bertaly formed an alliance and allowed the residents of all member states to freely pass through the territory of any of them. In addition, it was decided that a road between the states should be built to guarantee so that one could any point of any country can be reached from any point of any other State.Since roads are always expensive, the governments of the states of the newly formed alliance asked you to help them assess the costs. To do this, you have been issued a map that can be represented as a rectangle table consisting of n rows and m columns. Any cell of the map either belongs to one of three states, or is an area where it is allowed to build a road, or is an area where the construction of the road is not allowed. A cell is called passable, if it belongs to one of the states, or the road was built in this cell. From any passable cells you can move up, down, right and left, if the cell that corresponds to the movement exists and is passable.Your task is to construct a road inside a minimum number of cells, so that it would be possible to get from any cell of any state to any cell of any other state using only passable cells.It is guaranteed that initially it is possible to reach any cell of any state from any cell of this state, moving only along its cells. It is also guaranteed that for any state there is at least one cell that belongs to it." 2200

590B "Chip \'n Dale Rescue Rangers" "binary search,geometry,math" "The famous global economic crisis is approaching rapidly, so the states of Berman, Berance and Bertaly formed an alliance and allowed the residents of all member states to freely pass through the territory of any of them. In addition, it was decided that a road between the states should be built to guarantee so that one could any point of any country can be reached from any point of any other State.Since roads are always expensive, the governments of the states of the newly formed alliance asked you to help them assess the costs. To do this, you have been issued a map that can be represented as a rectangle table consisting of n rows and m columns. Any cell of the map either belongs to one of three states, or is an area where it is allowed to build a road, or is an area where the construction of the road is not allowed. A cell is called passable, if it belongs to one of the states, or the road was built in this cell. From any passable cells you can move up, down, right and left, if the cell that corresponds to the movement exists and is passable.Your task is to construct a road inside a minimum number of cells, so that it would be possible to get from any cell of any state to any cell of any other state using only passable cells.It is guaranteed that initially it is possible to reach any cell of any state from any cell of this state, moving only along its cells. It is also guaranteed that for any state there is at least one cell that belongs to it." 2100

590A "Median Smoothing" implementation "A schoolboy named Vasya loves reading books on programming and mathematics. He has recently read an encyclopedia article that described the method of median smoothing (or median filter) and its many applications in science and engineering. Vasya liked the idea of the method very much, and he decided to try it in practice.Applying the simplest variant of median smoothing to the sequence of numbers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an will result a new sequence b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bn obtained by the following algorithm:  b1\xe2\x80\x89=\xe2\x80\x89a1, bn\xe2\x80\x89=\xe2\x80\x89an, that is, the first and the last number of the new sequence match the corresponding numbers of the original sequence.  For i\xe2\x80\x89=\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x891 value bi is equal to the median of three values ai\xe2\x80\x89-\xe2\x80\x891, ai and ai\xe2\x80\x89+\xe2\x80\x891. The median of a set of three numbers is the number that goes on the second place, when these three numbers are written in the non-decreasing order. For example, the median of the set 5, 1, 2 is number 2, and the median of set 1, 0, 1 is equal to 1.In order to make the task easier, Vasya decided to apply the method to sequences consisting of zeros and ones only.Having made the procedure once, Vasya looked at the resulting sequence and thought: what if I apply the algorithm to it once again, and then apply it to the next result, and so on? Vasya tried a couple of examples and found out that after some number of median smoothing algorithm applications the sequence can stop changing. We say that the sequence is stable, if it does not change when the median smoothing is applied to it.Now Vasya wonders, whether the sequence always eventually becomes stable. He asks you to write a program that, given a sequence of zeros and ones, will determine whether it ever becomes stable. Moreover, if it ever becomes stable, then you should determine what will it look like and how many times one needs to apply the median smoothing algorithm to initial sequence in order to obtain a stable one." 1700

588B "Duff in Love" math "Duff is in love with lovely numbers! A positive integer x is called lovely if and only if there is no such positive integer a\xe2\x80\x89>\xe2\x80\x891 such that a2 is a divisor of x.  Malek has a number store! In his store, he has only divisors of positive integer n (and he has all of them). As a birthday present, Malek wants to give her a lovely number from his store. He wants this number to be as big as possible.Malek always had issues in math, so he asked for your help. Please tell him what is the biggest lovely number in his store." 1300

588A "Duff and Meat" greedy "Duff is addicted to meat! Malek wants to keep her happy for n days. In order to be happy in i-th day, she needs to eat exactly ai kilograms of meat.  There is a big shop uptown and Malek wants to buy meat for her from there. In i-th day, they sell meat for pi dollars per kilogram. Malek knows all numbers a1,\xe2\x80\x89...,\xe2\x80\x89an and p1,\xe2\x80\x89...,\xe2\x80\x89pn. In each day, he can buy arbitrary amount of meat, also he can keep some meat he has for the future.Malek is a little tired from cooking meat, so he asked for your help. Help him to minimize the total money he spends to keep Duff happy for n days." 900

587F "Duff is Mad" "data structures,strings" "Duff is mad at her friends. That\'s why she sometimes makes Malek to take candy from one of her friends for no reason!  She has n friends. Her i-th friend\'s name is si (their names are not necessarily unique). q times, she asks Malek to take candy from her friends. She\'s angry, but also she acts with rules. When she wants to ask Malek to take candy from one of her friends, like k, she chooses two numbers l and r and tells Malek to take exactly  candies from him/her, where occur(t,\xe2\x80\x89s) is the number of occurrences of string t in s.Malek is not able to calculate how many candies to take in each request from Duff. That\'s why she asked for your help. Please tell him how many candies to take in each request." 3000

587E "Duff as a Queen" "data structures" "Duff is the queen of her country, Andarz Gu. She\'s a competitive programming fan. That\'s why, when he saw her minister, Malek, free, she gave her a sequence consisting of n non-negative integers, a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an and asked him to perform q queries for her on this sequence.  There are two types of queries:  given numbers l,\xe2\x80\x89r and k, Malek should perform  for each l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r (, bitwise exclusive OR of numbers a and b).  given numbers l and r Malek should tell her the score of sequence al,\xe2\x80\x89al\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89... ,\xe2\x80\x89ar. Score of a sequence b1,\xe2\x80\x89...,\xe2\x80\x89bk is the number of its different Kheshtaks. A non-negative integer w is a Kheshtak of this sequence if and only if there exists a subsequence of b, let\'s denote it as bi1,\xe2\x80\x89bi2,\xe2\x80\x89... ,\xe2\x80\x89bix (possibly empty) such that  (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i1\xe2\x80\x89<\xe2\x80\x89i2\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89ix\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k). If this subsequence is empty, then w\xe2\x80\x89=\xe2\x80\x890.Unlike Duff, Malek is not a programmer. That\'s why he asked for your help. Please help him perform these queries." 2900

587D "Duff in Mafia" "2-sat,binary search" "Duff is one if the heads of Mafia in her country, Andarz Gu. Andarz Gu has n cities (numbered from 1 to n) connected by m bidirectional roads (numbered by 1 to m).Each road has a destructing time, and a color. i-th road connects cities vi and ui and its color is ci and its destructing time is ti.Mafia wants to destruct a matching in Andarz Gu. A matching is a subset of roads such that no two roads in this subset has common endpoint. They can destruct these roads in parallel, i. e. the total destruction time is a maximum over destruction times of all selected roads.  They want two conditions to be satisfied:  The remaining roads form a proper coloring.  Destructing time of this matching is minimized. The remaining roads after destructing this matching form a proper coloring if and only if no two roads of the same color have same endpoint, or, in the other words, edges of each color should form a matching.There is no programmer in Mafia. That\'s why Duff asked for your help. Please help her and determine which matching to destruct in order to satisfied those conditions (or state that this is not possible)." 3100

587C "Duff in the Army" "data structures,trees" "Recently Duff has been a soldier in the army. Malek is her commander.Their country, Andarz Gu has n cities (numbered from 1 to n) and n\xe2\x80\x89-\xe2\x80\x891 bidirectional roads. Each road connects two different cities. There exist a unique path between any two cities.There are also m people living in Andarz Gu (numbered from 1 to m). Each person has and ID number. ID number of i\xe2\x80\x89-\xe2\x80\x89th person is i and he/she lives in city number ci. Note that there may be more than one person in a city, also there may be no people living in the city.  Malek loves to order. That\'s why he asks Duff to answer to q queries. In each query, he gives her numbers v,\xe2\x80\x89u and a.To answer a query:Assume there are x people living in the cities lying on the path from city v to city u. Assume these people\'s IDs are p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89px in increasing order. If k\xe2\x80\x89=\xe2\x80\x89min(x,\xe2\x80\x89a), then Duff should tell Malek numbers k,\xe2\x80\x89p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pk in this order. In the other words, Malek wants to know a minimums on that path (or less, if there are less than a people).Duff is very busy at the moment, so she asked you to help her and answer the queries." 2200

587B "Duff in Beach" dp "While Duff was resting in the beach, she accidentally found a strange array b0,\xe2\x80\x89b1,\xe2\x80\x89...,\xe2\x80\x89bl\xe2\x80\x89-\xe2\x80\x891 consisting of l positive integers. This array was strange because it was extremely long, but there was another (maybe shorter) array, a0,\xe2\x80\x89...,\xe2\x80\x89an\xe2\x80\x89-\xe2\x80\x891 that b can be build from a with formula: bi\xe2\x80\x89=\xe2\x80\x89ai mod n where a mod b denoted the remainder of dividing a by b.  Duff is so curious, she wants to know the number of subsequences of b like bi1,\xe2\x80\x89bi2,\xe2\x80\x89...,\xe2\x80\x89bix (0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i1\xe2\x80\x89<\xe2\x80\x89i2\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89ix\xe2\x80\x89<\xe2\x80\x89l), such that:   1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k  For each 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89-\xe2\x80\x891,   For each 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89-\xe2\x80\x891, bij\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89bij\xe2\x80\x89+\xe2\x80\x891. i.e this subsequence is non-decreasing. Since this number can be very large, she want to know it modulo 109\xe2\x80\x89+\xe2\x80\x897.Duff is not a programmer, and Malek is unavailable at the moment. So she asked for your help. Please tell her this number." 2100

587A "Duff and Weight Lifting" greedy "Recently, Duff has been practicing weight lifting. As a hard practice, Malek gave her a task. He gave her a sequence of weights. Weight of i-th of them is 2wi pounds. In each step, Duff can lift some of the remaining weights and throw them away. She does this until there\'s no more weight left. Malek asked her to minimize the number of steps.  Duff is a competitive programming fan. That\'s why in each step, she can only lift and throw away a sequence of weights 2a1,\xe2\x80\x89...,\xe2\x80\x892ak if and only if there exists a non-negative integer x such that 2a1\xe2\x80\x89+\xe2\x80\x892a2\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x892ak\xe2\x80\x89=\xe2\x80\x892x, i. e. the sum of those numbers is a power of two.Duff is a competitive programming fan, but not a programmer. That\'s why she asked for your help. Help her minimize the number of steps." 1500

586B "Laurenty and Shop" implementation "A little boy Laurenty has been playing his favourite game Nota for quite a while and is now very hungry. The boy wants to make sausage and cheese sandwiches, but first, he needs to buy a sausage and some cheese.The town where Laurenty lives in is not large. The houses in it are located in two rows, n houses in each row. Laurenty lives in the very last house of the second row. The only shop in town is placed in the first house of the first row.The first and second rows are separated with the main avenue of the city. The adjacent houses of one row are separated by streets.Each crosswalk of a street or an avenue has some traffic lights. In order to cross the street, you need to press a button on the traffic light, wait for a while for the green light and cross the street. Different traffic lights can have different waiting time.The traffic light on the crosswalk from the j-th house of the i-th row to the (j\xe2\x80\x89+\xe2\x80\x891)-th house of the same row has waiting time equal to aij (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x892,\xe2\x80\x891\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x891). For the traffic light on the crossing from the j-th house of one row to the j-th house of another row the waiting time equals bj (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n). The city doesn\'t have any other crossings.The boy wants to get to the store, buy the products and go back. The main avenue of the city is wide enough, so the boy wants to cross it exactly once on the way to the store and exactly once on the way back home. The boy would get bored if he had to walk the same way again, so he wants the way home to be different from the way to the store in at least one crossing.  Figure to the first sample. Help Laurenty determine the minimum total time he needs to wait at the crossroads." 1300

586A "Alena\'s Schedule" implementation "A little boy Laurenty has been playing his favourite game Nota for quite a while and is now very hungry. The boy wants to make sausage and cheese sandwiches, but first, he needs to buy a sausage and some cheese.The town where Laurenty lives in is not large. The houses in it are located in two rows, n houses in each row. Laurenty lives in the very last house of the second row. The only shop in town is placed in the first house of the first row.The first and second rows are separated with the main avenue of the city. The adjacent houses of one row are separated by streets.Each crosswalk of a street or an avenue has some traffic lights. In order to cross the street, you need to press a button on the traffic light, wait for a while for the green light and cross the street. Different traffic lights can have different waiting time.The traffic light on the crosswalk from the j-th house of the i-th row to the (j\xe2\x80\x89+\xe2\x80\x891)-th house of the same row has waiting time equal to aij (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x892,\xe2\x80\x891\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x891). For the traffic light on the crossing from the j-th house of one row to the j-th house of another row the waiting time equals bj (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n). The city doesn\'t have any other crossings.The boy wants to get to the store, buy the products and go back. The main avenue of the city is wide enough, so the boy wants to cross it exactly once on the way to the store and exactly once on the way back home. The boy would get bored if he had to walk the same way again, so he wants the way home to be different from the way to the store in at least one crossing.  Figure to the first sample. Help Laurenty determine the minimum total time he needs to wait at the crossroads." 900

585F "Digits of Number Pi" dp,implementation,strings "Vasily has recently learned about the amazing properties of number \xcf\x80. In one of the articles it has been hypothesized that, whatever the sequence of numbers we have, in some position, this sequence is found among the digits of number \xcf\x80. Thus, if you take, for example, the epic novel ""War and Peace"" of famous Russian author Leo Tolstoy, and encode it with numbers, then we will find the novel among the characters of number \xcf\x80.Vasily was absolutely delighted with this, because it means that all the books, songs and programs have already been written and encoded in the digits of \xcf\x80. Vasily is, of course, a bit wary that this is only a hypothesis and it hasn\'t been proved, so he decided to check it out.To do this, Vasily downloaded from the Internet the archive with the sequence of digits of number \xcf\x80, starting with a certain position, and began to check the different strings of digits on the presence in the downloaded archive. Vasily quickly found short strings of digits, but each time he took a longer string, it turned out that it is not in the archive. Vasily came up with a definition that a string of length d is a half-occurrence if it contains a substring of length of at least , which occurs in the archive.To complete the investigation, Vasily took 2 large numbers x,\xe2\x80\x89y (x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y) with the same number of digits and now he wants to find the number of numbers in the interval from x to y, which are half-occurrences in the archive. Help Vasily calculate this value modulo 109\xe2\x80\x89+\xe2\x80\x897." 3200

585E "Present for Vitalik the Philatelist" "combinatorics,math,number theory" "Vitalik the philatelist has a birthday today!As he is a regular customer in a stamp store called \'Robin Bobin\', the store management decided to make him a gift.Vitalik wants to buy one stamp and the store will give him a non-empty set of the remaining stamps, such that the greatest common divisor (GCD) of the price of the stamps they give to him is more than one. If the GCD of prices of the purchased stamp and prices of present stamps set will be equal to 1, then Vitalik will leave the store completely happy.The store management asks you to count the number of different situations in which Vitalik will leave the store completely happy. Since the required number of situations can be very large, you need to find the remainder of this number modulo 109\xe2\x80\x89+\xe2\x80\x897. The situations are different if the stamps purchased by Vitalik are different, or if one of the present sets contains a stamp that the other present does not contain." 2900

585D "Lizard Era: Beginning" meet-in-the-middle "In the game Lizard Era: Beginning the protagonist will travel with three companions: Lynn, Meliana and Worrigan. Overall the game has n mandatory quests. To perform each of them, you need to take exactly two companions.The attitude of each of the companions to the hero is an integer. Initially, the attitude of each of them to the hero of neutral and equal to 0. As the hero completes quests, he makes actions that change the attitude of the companions, whom he took to perform this task, in positive or negative direction.Tell us what companions the hero needs to choose to make their attitude equal after completing all the quests. If this can be done in several ways, choose the one in which the value of resulting attitude is greatest possible." 2300

585C "Alice, Bob, Oranges and Apples" "number theory" "Alice and Bob decided to eat some fruit. In the kitchen they found a large bag of oranges and apples. Alice immediately took an orange for herself, Bob took an apple. To make the process of sharing the remaining fruit more fun, the friends decided to play a game. They put multiple cards and on each one they wrote a letter, either \'A\', or the letter \'B\'. Then they began to remove the cards one by one from left to right, every time they removed a card with the letter \'A\', Alice gave Bob all the fruits she had at that moment and took out of the bag as many apples and as many oranges as she had before. Thus the number of oranges and apples Alice had, did not change. If the card had written letter \'B\', then Bob did the same, that is, he gave Alice all the fruit that he had, and took from the bag the same set of fruit. After the last card way removed, all the fruit in the bag were over.You know how many oranges and apples was in the bag at first. Your task is to find any sequence of cards that Alice and Bob could have played with." 2400

585B "Phillip and Trains" "dfs and similar,graphs,shortest paths" "The mobile application store has a new game called ""Subway Roller"".The protagonist of the game Philip is located in one end of the tunnel and wants to get out of the other one. The tunnel is a rectangular field consisting of three rows and n columns. At the beginning of the game the hero is in some cell of the leftmost column. Some number of trains rides towards the hero. Each train consists of two or more neighbouring cells in some row of the field.All trains are moving from right to left at a speed of two cells per second, and the hero runs from left to right at the speed of one cell per second. For simplicity, the game is implemented so that the hero and the trains move in turns. First, the hero moves one cell to the right, then one square up or down, or stays idle. Then all the trains move twice simultaneously one cell to the left. Thus, in one move, Philip definitely makes a move to the right and can move up or down. If at any point, Philip is in the same cell with a train, he loses. If the train reaches the left column, it continues to move as before, leaving the tunnel.Your task is to answer the question whether there is a sequence of movements of Philip, such that he would be able to get to the rightmost column." 1700

585A "Gennady the Dentist" "brute force,implementation" "Gennady is one of the best child dentists in Berland. Today n children got an appointment with him, they lined up in front of his office.All children love to cry loudly at the reception at the dentist. We enumerate the children with integers from 1 to n in the order they go in the line. Every child is associated with the value of his cofidence pi. The children take turns one after another to come into the office; each time the child that is the first in the line goes to the doctor.While Gennady treats the teeth of the i-th child, the child is crying with the volume of vi. At that the confidence of the first child in the line is reduced by the amount of vi, the second one \xe2\x80\x94 by value vi\xe2\x80\x89-\xe2\x80\x891, and so on. The children in the queue after the vi-th child almost do not hear the crying, so their confidence remains unchanged.If at any point in time the confidence of the j-th child is less than zero, he begins to cry with the volume of dj and leaves the line, running towards the exit, without going to the doctor\'s office. At this the confidence of all the children after the j-th one in the line is reduced by the amount of dj.All these events occur immediately one after the other in some order. Some cries may lead to other cries, causing a chain reaction. Once in the hallway it is quiet, the child, who is first in the line, goes into the doctor\'s office.Help Gennady the Dentist to determine the numbers of kids, whose teeth he will cure. Print their numbers in the chronological order." 1800

584E "Anton and Ira" "constructive algorithms,greedy,math" "Anton loves transforming one permutation into another one by swapping elements for money, and Ira doesn\'t like paying for stupid games. Help them obtain the required permutation by paying as little money as possible.More formally, we have two permutations, p and s of numbers from 1 to n. We can swap pi and pj, by paying |i\xe2\x80\x89-\xe2\x80\x89j| coins for it. Find and print the smallest number of coins required to obtain permutation s from permutation p. Also print the sequence of swap operations at which we obtain a solution." 2300

584D "Dima and Lisa" "brute force,math,number theory" "Dima loves representing an odd number as the sum of multiple primes, and Lisa loves it when there are at most three primes. Help them to represent the given number as the sum of at most than three primes.More formally, you are given an odd numer n. Find a set of numbers pi (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k), such that 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x893 pi is a prime The numbers pi do not necessarily have to be distinct. It is guaranteed that at least one possible solution exists." 1800

584C "Marina and Vasya" "constructive algorithms,greedy,strings" "Marina loves strings of the same length and Vasya loves when there is a third string, different from them in exactly t characters. Help Vasya find at least one such string.More formally, you are given two strings s1, s2 of length n and number t. Let\'s denote as f(a,\xe2\x80\x89b) the number of characters in which strings a and b are different. Then your task will be to find any string s3 of length n, such that f(s1,\xe2\x80\x89s3)\xe2\x80\x89=\xe2\x80\x89f(s2,\xe2\x80\x89s3)\xe2\x80\x89=\xe2\x80\x89t. If there is no such string, print \xe2\x80\x89-\xe2\x80\x891." 1700

584B "Kolya and Tanya" combinatorics "Kolya loves putting gnomes at the circle table and giving them coins, and Tanya loves studying triplets of gnomes, sitting in the vertexes of an equilateral triangle.More formally, there are 3n gnomes sitting in a circle. Each gnome can have from 1 to 3 coins. Let\'s number the places in the order they occur in the circle by numbers from 0 to 3n\xe2\x80\x89-\xe2\x80\x891, let the gnome sitting on the i-th place have ai coins. If there is an integer i (0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89n) such that ai\xe2\x80\x89+\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x89n\xe2\x80\x89+\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x892n\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x896, then Tanya is satisfied. Count the number of ways to choose ai so that Tanya is satisfied. As there can be many ways of distributing coins, print the remainder of this number modulo 109\xe2\x80\x89+\xe2\x80\x897. Two ways, a and b, are considered distinct if there is index i (0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x893n), such that ai\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89bi (that is, some gnome got different number of coins in these two ways)." 1500

584A "Olesya and Rodion" math "Olesya loves numbers consisting of n digits, and Rodion only likes numbers that are divisible by t. Find some number that satisfies both of them.Your task is: given the n and t print an integer strictly larger than zero consisting of n digits that is divisible by t. If such number doesn\'t exist, print \xe2\x80\x89-\xe2\x80\x891." 1000

583B "Robot\'s Task" greedy,implementation "Olesya loves numbers consisting of n digits, and Rodion only likes numbers that are divisible by t. Find some number that satisfies both of them.Your task is: given the n and t print an integer strictly larger than zero consisting of n digits that is divisible by t. If such number doesn\'t exist, print \xe2\x80\x89-\xe2\x80\x891." 1200

583A "Asphalting Roads" implementation "City X consists of n vertical and n horizontal infinite roads, forming n\xe2\x80\x89\xc3\x97\xe2\x80\x89n intersections. Roads (both vertical and horizontal) are numbered from 1 to n, and the intersections are indicated by the numbers of the roads that form them.Sand roads have long been recognized out of date, so the decision was made to asphalt them. To do this, a team of workers was hired and a schedule of work was made, according to which the intersections should be asphalted.Road repairs are planned for n2 days. On the i-th day of the team arrives at the i-th intersection in the list and if none of the two roads that form the intersection were already asphalted they asphalt both roads. Otherwise, the team leaves the intersection, without doing anything with the roads.According to the schedule of road works tell in which days at least one road will be asphalted." 1000

582E "Boolean Function" "bitmasks,dp,expression parsing" "In this problem we consider Boolean functions of four variables A,\xe2\x80\x89B,\xe2\x80\x89C,\xe2\x80\x89D. Variables A,\xe2\x80\x89B,\xe2\x80\x89C and D are logical and can take values 0 or 1. We will define a function using the following grammar:<expression> ::= <variable> | (<expression>) <operator> (<expression>)<variable> ::= \'A\' | \'B\' | \'C\' | \'D\' | \'a\' | \'b\' | \'c\' | \'d\'<operator> ::= \'&\' | \'|\'Here large letters A,\xe2\x80\x89B,\xe2\x80\x89C,\xe2\x80\x89D represent variables, and small letters represent their negations. For example, if A\xe2\x80\x89=\xe2\x80\x891, then character \'A\' corresponds to value 1, and value character \'a\' corresponds to value 0. Here character \'&\' corresponds to the operation of logical AND, character \'|\' corresponds to the operation of logical OR.You are given expression s, defining function f, where some operations and variables are missing. Also you know the values of the function f(A,\xe2\x80\x89B,\xe2\x80\x89C,\xe2\x80\x89D) for some n distinct sets of variable values. Count the number of ways to restore the elements that are missing in the expression so that the resulting expression corresponded to the given information about function f in the given variable sets. As the value of the result can be rather large, print its remainder modulo 109\xe2\x80\x89+\xe2\x80\x897." 3000

582D "Number of Binominal Coefficients" "dp,math,number theory" "For a given prime integer p and integers \xce\xb1,\xe2\x80\x89A calculate the number of pairs of integers (n,\xe2\x80\x89k), such that 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89A and  is divisible by p\xce\xb1. As the answer can be rather large, print the remainder of the answer moduly 109\xe2\x80\x89+\xe2\x80\x897.Let us remind you that  is the number of ways k objects can be chosen from the set of n objects." 3300

582C "Superior Periodic Subarrays" "number theory" "You are given an infinite periodic array a0,\xe2\x80\x89a1,\xe2\x80\x89...,\xe2\x80\x89an\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89... with the period of length n. Formally, . A periodic subarray (l,\xe2\x80\x89s) (0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89<\xe2\x80\x89n, 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89s\xe2\x80\x89<\xe2\x80\x89n) of array a is an infinite periodic array with a period of length s that is a subsegment of array a, starting with position l.A periodic subarray (l,\xe2\x80\x89s) is superior, if when attaching it to the array a, starting from index l, any element of the subarray is larger than or equal to the corresponding element of array a. An example of attaching is given on the figure (top \xe2\x80\x94 infinite array a, bottom \xe2\x80\x94 its periodic subarray (l,\xe2\x80\x89s)):  Find the number of distinct pairs (l,\xe2\x80\x89s), corresponding to the superior periodic arrays." 2400

582B "Once Again..." "constructive algorithms,dp,matrices" "You are given an array of positive integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an\xe2\x80\x89\xc3\x97\xe2\x80\x89T of length n\xe2\x80\x89\xc3\x97\xe2\x80\x89T. We know that for any i\xe2\x80\x89>\xe2\x80\x89n it is true that ai\xe2\x80\x89=\xe2\x80\x89ai\xe2\x80\x89-\xe2\x80\x89n. Find the length of the longest non-decreasing sequence of the given array." 1900

582A "GCD Table" "constructive algorithms,greedy,number theory" "The GCD table G of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89n for an array of positive integers a of length n is defined by formula   Let us remind you that the greatest common divisor (GCD) of two positive integers x and y is the greatest integer that is divisor of both x and y, it is denoted as . For example, for array a\xe2\x80\x89=\xe2\x80\x89{4,\xe2\x80\x893,\xe2\x80\x896,\xe2\x80\x892} of length 4 the GCD table will look as follows:  Given all the numbers of the GCD table G, restore array a." 1700

581F "Zublicanes and Mumocrates" "dp,trees,two pointers" "It\'s election time in Berland. The favorites are of course parties of zublicanes and mumocrates. The election campaigns of both parties include numerous demonstrations on n main squares of the capital of Berland. Each of the n squares certainly can have demonstrations of only one party, otherwise it could lead to riots. On the other hand, both parties have applied to host a huge number of demonstrations, so that on all squares demonstrations must be held. Now the capital management will distribute the area between the two parties.Some pairs of squares are connected by (n\xe2\x80\x89-\xe2\x80\x891) bidirectional roads such that between any pair of squares there is a unique way to get from one square to another. Some squares are on the outskirts of the capital meaning that they are connected by a road with only one other square, such squares are called dead end squares.The mayor of the capital instructed to distribute all the squares between the parties so that the dead end squares had the same number of demonstrations of the first and the second party. It is guaranteed that the number of dead end squares of the city is even.To prevent possible conflicts between the zublicanes and the mumocrates it was decided to minimize the number of roads connecting the squares with the distinct parties. You, as a developer of the department of distributing squares, should determine this smallest number." 2400

581E "Kojiro and Furrari" dp,greedy "Motorist Kojiro spent 10 years saving up for his favorite car brand, Furrari. Finally Kojiro\'s dream came true! Kojiro now wants to get to his girlfriend Johanna to show off his car to her.Kojiro wants to get to his girlfriend, so he will go to her along a coordinate line. For simplicity, we can assume that Kojiro is at the point f of a coordinate line, and Johanna is at point e. Some points of the coordinate line have gas stations. Every gas station fills with only one type of fuel: Regular-92, Premium-95 or Super-98. Thus, each gas station is characterized by a pair of integers ti and xi \xe2\x80\x94 the number of the gas type and its position.One liter of fuel is enough to drive for exactly 1 km (this value does not depend on the type of fuel). Fuels of three types differ only in quality, according to the research, that affects the lifetime of the vehicle motor. A Furrari tank holds exactly s liters of fuel (regardless of the type of fuel). At the moment of departure from point f Kojiro\'s tank is completely filled with fuel Super-98. At each gas station Kojiro can fill the tank with any amount of fuel, but of course, at no point in time, the amount of fuel in the tank can be more than s liters. Note that the tank can simultaneously have different types of fuel. The car can moves both left and right.To extend the lifetime of the engine Kojiro seeks primarily to minimize the amount of fuel of type Regular-92. If there are several strategies to go from f to e, using the minimum amount of fuel of type Regular-92, it is necessary to travel so as to minimize the amount of used fuel of type Premium-95.Write a program that can for the m possible positions of the start fi minimize firstly, the amount of used fuel of type Regular-92 and secondly, the amount of used fuel of type Premium-95." 2800

581D "Three Logos" "bitmasks,brute force,constructive algorithms,geometry,implementation,math" "Three companies decided to order a billboard with pictures of their logos. A billboard is a big square board. A logo of each company is a rectangle of a non-zero area. Advertisers will put up the ad only if it is possible to place all three logos on the billboard so that they do not overlap and the billboard has no empty space left. When you put a logo on the billboard, you should rotate it so that the sides were parallel to the sides of the billboard.Your task is to determine if it is possible to put the logos of all the three companies on some square billboard without breaking any of the described rules." 1700

581C "Developing Skills" implementation,math,sortings "Petya loves computer games. Finally a game that he\'s been waiting for so long came out!The main character of this game has n different skills, each of which is characterized by an integer ai from 0 to 100. The higher the number ai is, the higher is the i-th skill of the character. The total rating of the character is calculated as the sum of the values \xe2\x80\x8b\xe2\x80\x8bof  for all i from 1 to n. The expression \xe2\x8c\x8a x\xe2\x8c\x8b denotes the result of rounding the number x down to the nearest integer.At the beginning of the game Petya got k improvement units as a bonus that he can use to increase the skills of his character and his total rating. One improvement unit can increase any skill of Petya\'s character by exactly one. For example, if a4\xe2\x80\x89=\xe2\x80\x8946, after using one imporvement unit to this skill, it becomes equal to 47. A hero\'s skill cannot rise higher more than 100. Thus, it is permissible that some of the units will remain unused.Your task is to determine the optimal way of using the improvement units so as to maximize the overall rating of the character. It is not necessary to use all the improvement units." 1400

581B "Luxurious Houses" implementation,math "The capital of Berland has n multifloor buildings. The architect who built up the capital was very creative, so all the houses were built in one row.Let\'s enumerate all the houses from left to right, starting with one. A house is considered to be luxurious if the number of floors in it is strictly greater than in all the houses with larger numbers. In other words, a house is luxurious if the number of floors in it is strictly greater than in all the houses, which are located to the right from it. In this task it is assumed that the heights of floors in the houses are the same.The new architect is interested in n questions, i-th of them is about the following: ""how many floors should be added to the i-th house to make it luxurious?"" (for all i from 1 to n, inclusive). You need to help him cope with this task.Note that all these questions are independent from each other \xe2\x80\x94 the answer to the question for house i does not affect other answers (i.e., the floors to the houses are not actually added)." 1100

581A "Vasya the Hipster" implementation,math "One day Vasya the Hipster decided to count how many socks he had. It turned out that he had a red socks and b blue socks.According to the latest fashion, hipsters should wear the socks of different colors: a red one on the left foot, a blue one on the right foot.Every day Vasya puts on new socks in the morning and throws them away before going to bed as he doesn\'t want to wash them.Vasya wonders, what is the maximum number of days when he can dress fashionable and wear different socks, and after that, for how many days he can then wear the same socks until he either runs out of socks or cannot make a single pair from the socks he\'s got.Can you help him?" 800

580E "Kefa and Watch" "data structures,hashing,strings" "One day Kefa the parrot was walking down the street as he was on the way home from the restaurant when he saw something glittering by the road. As he came nearer he understood that it was a watch. He decided to take it to the pawnbroker to earn some money. The pawnbroker said that each watch contains a serial number represented by a string of digits from 0 to 9, and the more quality checks this number passes, the higher is the value of the watch. The check is defined by three positive integers l, r and d. The watches pass a check if a substring of the serial number from l to r has period d. Sometimes the pawnbroker gets distracted and Kefa changes in some substring of the serial number all digits to c in order to increase profit from the watch. The seller has a lot of things to do to begin with and with Kefa messing about, he gave you a task: to write a program that determines the value of the watch.Let us remind you that number x is called a period of string s (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|s|), if si\xe2\x80\x89\xe2\x80\x89=\xe2\x80\x89\xe2\x80\x89si\xe2\x80\x89+\xe2\x80\x89x for all i from 1 to |s|\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x89\xe2\x80\x89x." 2500

580D "Kefa and Dishes" bitmasks,dp "When Kefa came to the restaurant and sat at a table, the waiter immediately brought him the menu. There were n dishes. Kefa knows that he needs exactly m dishes. But at that, he doesn\'t want to order the same dish twice to taste as many dishes as possible. Kefa knows that the i-th dish gives him ai units of satisfaction. But some dishes do not go well together and some dishes go very well together. Kefa set to himself k rules of eating food of the following type \xe2\x80\x94 if he eats dish x exactly before dish y (there should be no other dishes between x and y), then his satisfaction level raises by c. Of course, our parrot wants to get some maximal possible satisfaction from going to the restaurant. Help him in this hard task!" 1800

580C "Kefa and Park" "dfs and similar,graphs,trees" "Kefa decided to celebrate his first big salary by going to the restaurant. He lives by an unusual park. The park is a rooted tree consisting of n vertices with the root at vertex 1. Vertex 1 also contains Kefa\'s house. Unfortunaely for our hero, the park also contains cats. Kefa has already found out what are the vertices with cats in them.The leaf vertices of the park contain restaurants. Kefa wants to choose a restaurant where he will go, but unfortunately he is very afraid of cats, so there is no way he will go to the restaurant if the path from the restaurant to his house contains more than m consecutive vertices with cats. Your task is to help Kefa count the number of restaurants where he can go." 1500

580B "Kefa and Company" "binary search,sortings,two pointers" "Kefa wants to celebrate his first big salary by going to restaurant. However, he needs company. Kefa has n friends, each friend will agree to go to the restaurant if Kefa asks. Each friend is characterized by the amount of money he has and the friendship factor in respect to Kefa. The parrot doesn\'t want any friend to feel poor compared to somebody else in the company (Kefa doesn\'t count). A friend feels poor if in the company there is someone who has at least d units of money more than he does. Also, Kefa wants the total friendship factor of the members of the company to be maximum. Help him invite an optimal company!" 1500

580A "Kefa and First Steps" "brute force,dp,implementation" "Kefa decided to make some money doing business on the Internet for exactly n days. He knows that on the i-th day (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) he makes ai money. Kefa loves progress, that\'s why he wants to know the length of the maximum non-decreasing subsegment in sequence ai. Let us remind you that the subsegment of the sequence is its continuous fragment. A subsegment of numbers is called non-decreasing if all numbers in it follow in the non-decreasing order.Help Kefa cope with this task!" 900

579B "Finding Team Member" "brute force,implementation,sortings" "There is a programing contest named SnakeUp, 2n people want to compete for it. In order to attend this contest, people need to form teams of exactly two people. You are given the strength of each possible combination of two people. All the values of the strengths are distinct.Every contestant hopes that he can find a teammate so that their team\xe2\x80\x99s strength is as high as possible. That is, a contestant will form a team with highest strength possible by choosing a teammate from ones who are willing to be a teammate with him/her. More formally, two people A and B may form a team if each of them is the best possible teammate (among the contestants that remain unpaired) for the other one. Can you determine who will be each person\xe2\x80\x99s teammate?" 1300

579A "Raising Bacteria" bitmasks "You are a lover of bacteria. You want to raise some bacteria in a box. Initially, the box is empty. Each morning, you can put any number of bacteria into the box. And each night, every bacterium in the box will split into two bacteria. You hope to see exactly x bacteria in the box at some moment. What is the minimum number of bacteria you need to put into the box across those days?" 1000

578F "Mirror Box" matrices,trees "You are given a box full of mirrors. Box consists of grid of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m. Each cell of the grid contains a mirror put in the shape of \'\\\' or \'\xe2\x80\x89/\xe2\x80\x89\' (45 degree to the horizontal or vertical line). But mirrors in some cells have been destroyed. You want to put new mirrors into these grids so that the following two conditions are satisfied:  If you put a light ray horizontally/vertically into the middle of any unit segment that is side of some border cell, the light will go out from the neighboring unit segment to the segment you put the ray in. each unit segment of the grid of the mirror box can be penetrated by at least one light ray horizontally/vertically put into the box according to the rules of the previous paragraph   After you tried putting some mirrors, you find out that there are many ways of doing so. How many possible ways are there? The answer might be large, so please find the result modulo prime number MOD." 3200

578E Walking! "constructive algorithms,greedy" "There is a sand trail in front of Alice\'s home.In daytime, people walk over it and leave a footprint on the trail for their every single step. Alice cannot distinguish the order of the footprints, but she can tell whether each footprint is made by left foot or right foot. Also she\'s certain that all people are walking by alternating left foot and right foot.For example, suppose that one person walked through the trail and left some footprints. The footprints are RRLRL in order along the trail (\'R\' means right foot and \'L\' means left foot). You might think the outcome of the footprints is strange. But in fact, some steps are resulting from walking backwards!There are some possible order of steps that produce these footprints such as 1\xe2\x80\x89\xe2\x86\x92\xe2\x80\x893\xe2\x80\x89\xe2\x86\x92\xe2\x80\x892\xe2\x80\x89\xe2\x86\x92\xe2\x80\x895\xe2\x80\x89\xe2\x86\x92\xe2\x80\x894 or 2\xe2\x80\x89\xe2\x86\x92\xe2\x80\x893\xe2\x80\x89\xe2\x86\x92\xe2\x80\x894\xe2\x80\x89\xe2\x86\x92\xe2\x80\x895\xe2\x80\x89\xe2\x86\x92\xe2\x80\x891 (we suppose that the distance between two consecutive steps can be arbitrarily long). The number of backward steps from above two examples are 2 and 1 separately.Alice is interested in these footprints. Whenever there is a person walking trough the trail, she takes a picture of all these footprints along the trail and erase all of them so that next person will leave a new set of footprints. We know that people walk by alternating right foot and left foot, but we don\'t know if the first step is made by left foot or right foot.Alice wants to know the minimum possible number of backward steps made by a person. But it\'s a little hard. Please help Alice to calculate it. You also need to construct one possible history of these footprints." 2700

578D "LCS Again" dp,greedy "You are given a string S of length n with each character being one of the first m lowercase English letters. Calculate how many different strings T of length n composed from the first m lowercase English letters exist such that the length of LCS (longest common subsequence) between S and T is n\xe2\x80\x89-\xe2\x80\x891.Recall that LCS of two strings S and T is the longest string C such that C both in S and T as a subsequence." 2700

578C "Weakness and Poorness" "ternary search" "You are given a sequence of n integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. Determine a real number x such that the weakness of the sequence a1\xe2\x80\x89-\xe2\x80\x89x,\xe2\x80\x89a2\xe2\x80\x89-\xe2\x80\x89x,\xe2\x80\x89...,\xe2\x80\x89an\xe2\x80\x89-\xe2\x80\x89x is as small as possible.The weakness of a sequence is defined as the maximum value of the poorness over all segments (contiguous subsequences) of a sequence.The poorness of a segment is defined as the absolute value of sum of the elements of segment." 2000

578B """Or"" Game" "brute force,greedy" "You are given n numbers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. You can perform at most k operations. For each operation you can multiply one of the numbers by x. We want to make  as large as possible, where  denotes the bitwise OR. Find the maximum possible value of  after performing at most k operations optimally." 1700

578A "A Problem about Polyline" geometry,math "There is a polyline going through points (0,\xe2\x80\x890)\xe2\x80\x89\xe2\x80\x93\xe2\x80\x89(x,\xe2\x80\x89x)\xe2\x80\x89\xe2\x80\x93\xe2\x80\x89(2x,\xe2\x80\x890)\xe2\x80\x89\xe2\x80\x93\xe2\x80\x89(3x,\xe2\x80\x89x)\xe2\x80\x89\xe2\x80\x93\xe2\x80\x89(4x,\xe2\x80\x890)\xe2\x80\x89\xe2\x80\x93\xe2\x80\x89...\xe2\x80\x89-\xe2\x80\x89(2kx,\xe2\x80\x890)\xe2\x80\x89\xe2\x80\x93\xe2\x80\x89(2kx\xe2\x80\x89+\xe2\x80\x89x,\xe2\x80\x89x)\xe2\x80\x89\xe2\x80\x93\xe2\x80\x89.... We know that the polyline passes through the point (a,\xe2\x80\x89b). Find minimum positive value x such that it is true or determine that there is no such x." 1700

577B "Modulo Sum" "combinatorics,data structures,dp,two pointers" "You are given a sequence of numbers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an, and a number m.Check if it is possible to choose a non-empty subsequence aij such that the sum of numbers in this subsequence is divisible by m." 1900

577A "Multiplication Table" "implementation,number theory" "Let\'s consider a table consisting of n rows and n columns. The cell located at the intersection of i-th row and j-th column contains number i\xe2\x80\x89\xc3\x97\xe2\x80\x89j. The rows and columns are numbered starting from 1.You are given a positive integer x. Your task is to count the number of cells in a table that contain number x." 1000

576E "Painting Edges" "binary search,data structures" "Note the unusual memory limit for this problem.You are given an undirected graph consisting of n vertices and m edges. The vertices are numbered with integers from 1 to n, the edges are numbered with integers from 1 to m. Each edge can be unpainted or be painted in one of the k colors, which are numbered with integers from 1 to k. Initially, none of the edges is painted in any of the colors.You get queries of the form ""Repaint edge ei to color ci"". At any time the graph formed by the edges of the same color must be bipartite. If after the repaint this condition is violated, then the query is considered to be invalid and edge ei keeps its color. Otherwise, edge ei is repainted in color ci, and the query is considered to valid.Recall that the graph is called bipartite if the set of its vertices can be divided into two parts so that no edge connected vertices of the same parts.For example, suppose you are given a triangle graph, that is a graph with three vertices and edges (1,\xe2\x80\x892), (2,\xe2\x80\x893) and (3,\xe2\x80\x891). Suppose that the first two edges are painted color 1, and the third one is painted color 2. Then the query of ""repaint the third edge in color 1"" will be incorrect because after its execution the graph formed by the edges of color 1 will not be bipartite. On the other hand, it is possible to repaint the second edge in color 2.You receive q queries. For each query, you should either apply it, and report that the query is valid, or report that the query is invalid." 3300

576D "Flights for Regular Customers" dp,matrices "In the country there are exactly n cities numbered with positive integers from 1 to n. In each city there is an airport is located.Also, there is the only one airline, which makes m flights. Unfortunately, to use them, you need to be a regular customer of this company, namely, you have the opportunity to enjoy flight i from city ai to city bi only if you have already made at least di flights before that.Please note that flight i flies exactly from city ai to city bi. It can not be used to fly from city bi to city ai. An interesting fact is that there may possibly be recreational flights with a beautiful view of the sky, which begin and end in the same city.You need to get from city 1 to city n. Unfortunately, you\'ve never traveled by plane before. What minimum number of flights you have to perform in order to get to city n?Note that the same flight can be used multiple times." 2700

576C "Points on Plane" "constructive algorithms,divide and conquer,geometry,greedy,sortings" "On a plane are n points (xi, yi) with integer coordinates between 0 and 106. The distance between the two points with numbers a and b is said to be the following value:  (the distance calculated by such formula is called Manhattan distance).We call a hamiltonian path to be some permutation pi of numbers from 1 to n. We say that the length of this path is value .Find some hamiltonian path with a length of no more than 25\xe2\x80\x89\xc3\x97\xe2\x80\x89108. Note that you do not have to minimize the path length." 2100

576B "Invariance of Tree" "constructive algorithms,dfs and similar,greedy,trees" "A tree of size n is an undirected connected graph consisting of n vertices without cycles.Consider some tree with n vertices. We call a tree invariant relative to permutation p\xe2\x80\x89=\xe2\x80\x89p1p2... pn, if for any two vertices of the tree u and v the condition holds: ""vertices u and v are connected by an edge if and only if vertices pu and pv are connected by an edge"".You are given permutation p of size n. Find some tree size n, invariant relative to the given permutation." 2100

576A "Vasya and Petya\'s Game" "math,number theory" "A tree of size n is an undirected connected graph consisting of n vertices without cycles.Consider some tree with n vertices. We call a tree invariant relative to permutation p\xe2\x80\x89=\xe2\x80\x89p1p2... pn, if for any two vertices of the tree u and v the condition holds: ""vertices u and v are connected by an edge if and only if vertices pu and pv are connected by an edge"".You are given permutation p of size n. Find some tree size n, invariant relative to the given permutation." 1500

575I "Robots protection" "data structures" "Company ""Robots industries"" produces robots for territory protection. Robots protect triangle territories \xe2\x80\x94 right isosceles triangles with catheti parallel to North-South and East-West directions.Owner of some land buys and sets robots on his territory to protect it. From time to time, businessmen want to build offices on that land and want to know how many robots will guard it. You are to handle these queries." 2800

575H Bots "combinatorics,dp,math,number theory" "Sasha and Ira are two best friends. But they aren\xe2\x80\x99t just friends, they are software engineers and experts in artificial intelligence. They are developing an algorithm for two bots playing a two-player game. The game is cooperative and turn based. In each turn, one of the players makes a move (it doesn\xe2\x80\x99t matter which player, it\'s possible that players turns do not alternate). Algorithm for bots that Sasha and Ira are developing works by keeping track of the state the game is in. Each time either bot makes a move, the state changes. And, since the game is very dynamic, it will never go back to the state it was already in at any point in the past.Sasha and Ira are perfectionists and want their algorithm to have an optimal winning strategy. They have noticed that in the optimal winning strategy, both bots make exactly N moves each. But, in order to find the optimal strategy, their algorithm needs to analyze all possible states of the game (they haven\xe2\x80\x99t learned about alpha-beta pruning yet) and pick the best sequence of moves.They are worried about the efficiency of their algorithm and are wondering what is the total number of states of the game that need to be analyzed?" 1800

575G "Run for beer" "dfs and similar,shortest paths" "People in BubbleLand like to drink beer. Little do you know, beer here is so good and strong that every time you drink it your speed goes 10 times slower than before you drank it.Birko lives in city Beergrade, but wants to go to city Beerburg. You are given a road map of BubbleLand and you need to find the fastest way for him. When he starts his journey in Beergrade his speed is 1. When he comes to a new city he always tries a glass of local beer, which divides his speed by 10. The question here is what the minimal time for him to reach Beerburg is. If there are several paths with the same minimal time, pick the one that has least roads on it. If there is still more than one path, pick any.It is guaranteed that there will be at least one path from Beergrade to Beerburg." 2200

575F Bulbo dp,greedy "Bananistan is a beautiful banana republic. Beautiful women in beautiful dresses. Beautiful statues of beautiful warlords. Beautiful stars in beautiful nights.In Bananistan people play this crazy game \xe2\x80\x93 Bulbo. There\xe2\x80\x99s an array of bulbs and player at the position, which represents one of the bulbs. The distance between two neighboring bulbs is 1. Before each turn player can change his position with cost |posnew\xe2\x80\x89-\xe2\x80\x89posold|. After that, a contiguous set of bulbs lights-up and player pays the cost that\xe2\x80\x99s equal to the distance to the closest shining bulb. Then, all bulbs go dark again. The goal is to minimize your summed cost. I tell you, Bananistanians are spending their nights playing with bulbs.Banana day is approaching, and you are hired to play the most beautiful Bulbo game ever. A huge array of bulbs is installed, and you know your initial position and all the light-ups in advance. You need to play the ideal game and impress Bananistanians, and their families." 2100

575E "Spectator Riots" geometry "It\xe2\x80\x99s riot time on football stadium Ramacana! Raging fans have entered the field and the police find themselves in a difficult situation. The field can be represented as a square in the coordinate system defined by two diagonal vertices in (0,0) and (105, 105). The sides of that square are also considered to be inside the field, everything else is outside.In the beginning, there are N fans on the field. For each fan we are given his speed, an integer vi as well as his integer coordinates (xi, yi). A fan with those coordinates might move and after one second he might be at any point (xi\xe2\x80\x89+\xe2\x80\x89p, yi\xe2\x80\x89+\xe2\x80\x89q) where 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|p|\xe2\x80\x89+\xe2\x80\x89|q|\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89vi. p, q are both integers.Points that go outside of the square that represents the field are excluded and all others have equal probability of being the location of that specific fan after one second.Andrej, a young and promising police officer, has sent a flying drone to take a photo of the riot from above. The drone\xe2\x80\x99s camera works like this:  It selects three points with integer coordinates such that there is a chance of a fan appearing there after one second. They must not be collinear or the camera won\xe2\x80\x99t work. It is guaranteed that not all of the initial positions of fans will be on the same line.  Camera focuses those points and creates a circle that passes through those three points. A photo is taken after one second (one second after the initial state).  Everything that is on the circle or inside it at the moment of taking the photo (one second after focusing the points) will be on the photo. Your goal is to select those three points so that the expected number of fans seen on the photo is maximized. If there are more such selections, select those three points that give the circle with largest radius among them. If there are still more suitable selections, any one of them will be accepted. If your answer follows conditions above and radius of circle you return is smaller then the optimal one by 0.01, your output will be considered as correct.No test will have optimal radius bigger than 1010." 2800

575D Tablecity "constructive algorithms,implementation" "There was a big bank robbery in Tablecity. In order to catch the thief, the President called none other than Albert \xe2\x80\x93 Tablecity\xe2\x80\x99s Chief of Police. Albert does not know where the thief is located, but he does know how he moves.Tablecity can be represented as 1000\xe2\x80\x89\xc3\x97\xe2\x80\x892 grid, where every cell represents one district. Each district has its own unique name \xe2\x80\x9c(X,\xe2\x80\x89Y)\xe2\x80\x9d, where X and Y are the coordinates of the district in the grid. The thief\xe2\x80\x99s movement is as Every hour the thief will leave the district (X,\xe2\x80\x89Y) he is currently hiding in, and move to one of the districts: (X\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89Y), (X\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89Y), (X\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89Y\xe2\x80\x89-\xe2\x80\x891), (X\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89Y\xe2\x80\x89+\xe2\x80\x891), (X\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89Y\xe2\x80\x89-\xe2\x80\x891), (X\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89Y\xe2\x80\x89+\xe2\x80\x891) as long as it exists in Tablecity. Below is an example of thief\xe2\x80\x99s possible movements if he is located in district (7,1):Albert has enough people so that every hour he can pick any two districts in Tablecity and fully investigate them, making sure that if the thief is located in one of them, he will get caught. Albert promised the President that the thief will be caught in no more than 2015 hours and needs your help in order to achieve that." 1700

575C Party "bitmasks,brute force,graph matchings" "Note the unusual memory limit for the problem.People working in MDCS (Microsoft Development Center Serbia) like partying. They usually go to night clubs on Friday and Saturday.There are N people working in MDCS and there are N clubs in the city. Unfortunately, if there is more than one Microsoft employee in night club, level of coolness goes infinitely high and party is over, so club owners will never let more than one Microsoft employee enter their club in the same week (just to be sure).You are organizing night life for Microsoft employees and you have statistics about how much every employee likes Friday and Saturday parties for all clubs.You need to match people with clubs maximizing overall sum of their happiness (they are happy as much as they like the club), while half of people should go clubbing on Friday and the other half on Saturday." 2700

575B Bribes "dfs and similar,graphs,trees" "Ruritania is a country with a very badly maintained road network, which is not exactly good news for lorry drivers that constantly have to do deliveries. In fact, when roads are maintained, they become one-way. It turns out that it is sometimes impossible to get from one town to another in a legal way \xe2\x80\x93 however, we know that all towns are reachable, though illegally!Fortunately for us, the police tend to be very corrupt and they will allow a lorry driver to break the rules and drive in the wrong direction provided they receive \xe2\x80\x98a small gift\xe2\x80\x99. There is one patrol car for every road and they will request 1000 Ruritanian dinars when a driver drives in the wrong direction. However, being greedy, every time a patrol car notices the same driver breaking the rule, they will charge double the amount of money they requested the previous time on that particular road.Borna is a lorry driver that managed to figure out this bribing pattern. As part of his job, he has to make K stops in some towns all over Ruritania and he has to make these stops in a certain order. There are N towns (enumerated from 1 to N) in Ruritania and Borna\xe2\x80\x99s initial location is the capital city i.e. town 1. He happens to know which ones out of the N\xe2\x80\x89-\xe2\x80\x891 roads in Ruritania are currently unidirectional, but he is unable to compute the least amount of money he needs to prepare for bribing the police. Help Borna by providing him with an answer and you will be richly rewarded." 2200

575A Fibonotci "data structures,math,matrices" "Fibonotci sequence is an integer recursive sequence defined by the recurrence relation  Fn\xe2\x80\x89=\xe2\x80\x89sn\xe2\x80\x89-\xe2\x80\x891\xc2\xb7Fn\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x89sn\xe2\x80\x89-\xe2\x80\x892\xc2\xb7Fn\xe2\x80\x89-\xe2\x80\x892  with  F0\xe2\x80\x89=\xe2\x80\x890,\xe2\x80\x89F1\xe2\x80\x89=\xe2\x80\x891 Sequence s is an infinite and almost cyclic sequence with a cycle of length N. A sequence s is called almost cyclic with a cycle of length N if , for i\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89N, except for a finite number of values si, for which  (i\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89N).Following is an example of an almost cyclic sequence with a cycle of length 4:  s = (5,3,8,11,5,3,7,11,5,3,8,11,\xe2\x80\xa6) Notice that the only value of s for which the equality  does not hold is s6 (s6\xe2\x80\x89=\xe2\x80\x897 and s2\xe2\x80\x89=\xe2\x80\x898). You are given s0,\xe2\x80\x89s1,\xe2\x80\x89...sN\xe2\x80\x89-\xe2\x80\x891 and all the values of sequence s for which  (i\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89N).Find ." 2700

574B "Bear and Three Musketeers" "brute force,dfs and similar,graphs,hashing" "Do you know a story about the three musketeers? Anyway, you will learn about its origins now.Richelimakieu is a cardinal in the city of Bearis. He is tired of dealing with crime by himself. He needs three brave warriors to help him to fight against bad guys.There are n warriors. Richelimakieu wants to choose three of them to become musketeers but it\'s not that easy. The most important condition is that musketeers must know each other to cooperate efficiently. And they shouldn\'t be too well known because they could be betrayed by old friends. For each musketeer his recognition is the number of warriors he knows, excluding other two musketeers.Help Richelimakieu! Find if it is possible to choose three musketeers knowing each other, and what is minimum possible sum of their recognitions." 1500

574A "Bear and Elections" greedy,implementation "Limak is a grizzly bear who desires power and adoration. He wants to win in upcoming elections and rule over the Bearland.There are n candidates, including Limak. We know how many citizens are going to vote for each candidate. Now i-th candidate would get ai votes. Limak is candidate number 1. To win in elections, he must get strictly more votes than any other candidate.Victory is more important than everything else so Limak decided to cheat. He will steal votes from his opponents by bribing some citizens. To bribe a citizen, Limak must give him or her one candy - citizens are bears and bears like candies. Limak doesn\'t have many candies and wonders - how many citizens does he have to bribe?" 1200

573E "Bear and Bowling" "data structures,greedy" "Limak is an old brown bear. He often goes bowling with his friends. Today he feels really good and tries to beat his own record!For rolling a ball one gets a score \xe2\x80\x94 an integer (maybe negative) number of points. Score for i-th roll is multiplied by i and scores are summed up. So, for k rolls with scores s1,\xe2\x80\x89s2,\xe2\x80\x89...,\xe2\x80\x89sk, total score is . Total score is 0 if there were no rolls.Limak made n rolls and got score ai for i-th of them. He wants to maximize his total score and he came up with an interesting idea. He will cancel some rolls, saying that something distracted him or there was a strong wind.Limak is able to cancel any number of rolls, maybe even all or none of them. Total score is calculated as if there were only non-canceled rolls. Look at the sample tests for clarification. What maximum total score can Limak get?" 3200

573D "Bear and Cavalry" "data structures,divide and conquer,dp" "Would you want to fight against bears riding horses? Me neither.Limak is a grizzly bear. He is general of the dreadful army of Bearland. The most important part of an army is cavalry of course.Cavalry of Bearland consists of n warriors and n horses. i-th warrior has strength wi and i-th horse has strength hi. Warrior together with his horse is called a unit. Strength of a unit is equal to multiplied strengths of warrior and horse. Total strength of cavalry is equal to sum of strengths of all n units. Good assignment of warriors and horses makes cavalry truly powerful.Initially, i-th warrior has i-th horse. You are given q queries. In each query two warriors swap their horses with each other.General Limak must be ready for every possible situation. What if warriors weren\'t allowed to ride their own horses? After each query find the maximum possible strength of cavalry if we consider assignments of all warriors to all horses that no warrior is assigned to his own horse (it can be proven that for n\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x892 there is always at least one correct assignment).Note that we can\'t leave a warrior without a horse." 3000

573C "Bear and Drawing" "constructive algorithms,dfs and similar,trees" "Limak is a little bear who learns to draw. People usually start with houses, fences and flowers but why would bears do it? Limak lives in the forest and he decides to draw a tree.Recall that tree is a connected graph consisting of n vertices and n\xe2\x80\x89-\xe2\x80\x891 edges.Limak chose a tree with n vertices. He has infinite strip of paper with two parallel rows of dots. Little bear wants to assign vertices of a tree to some n distinct dots on a paper so that edges would intersect only at their endpoints \xe2\x80\x94 drawn tree must be planar. Below you can see one of correct drawings for the first sample test.  Is it possible for Limak to draw chosen tree?" 2300

573B "Bear and Blocks" "binary search,data structures,dp,math" "Limak is a little bear who loves to play. Today he is playing by destroying block towers. He built n towers in a row. The i-th tower is made of hi identical blocks. For clarification see picture for the first sample.Limak will repeat the following operation till everything is destroyed.Block is called internal if it has all four neighbors, i.e. it has each side (top, left, down and right) adjacent to other block or to the floor. Otherwise, block is boundary. In one operation Limak destroys all boundary blocks. His paws are very fast and he destroys all those blocks at the same time.Limak is ready to start. You task is to count how many operations will it take him to destroy all towers." 1600

573A "Bear and Poker" "implementation,math,number theory" "Limak is an old brown bear. He often plays poker with his friends. Today they went to a casino. There are n players (including Limak himself) and right now all of them have bids on the table. i-th of them has bid with size ai dollars.Each player can double his bid any number of times and triple his bid any number of times. The casino has a great jackpot for making all bids equal. Is it possible that Limak and his friends will win a jackpot?" 1300

572B "Order Book" "data structures,greedy,implementation,sortings" "In this task you need to process a set of stock exchange orders and use them to create order book.An order is an instruction of some participant to buy or sell stocks on stock exchange. The order number i has price pi, direction di \xe2\x80\x94 buy or sell, and integer qi. This means that the participant is ready to buy or sell qi stocks at price pi for one stock. A value qi is also known as a volume of an order.All orders with the same price p and direction d are merged into one aggregated order with price p and direction d. The volume of such order is a sum of volumes of the initial orders.An order book is a list of aggregated orders, the first part of which contains sell orders sorted by price in descending order, the second contains buy orders also sorted by price in descending order.An order book of depth s contains s best aggregated orders for each direction. A buy order is better if it has higher price and a sell order is better if it has lower price. If there are less than s aggregated orders for some direction then all of them will be in the final order book.You are given n stock exhange orders. Your task is to print order book of depth s for these orders." 1300

572A Arrays sortings "You are given two arrays A and B consisting of integers, sorted in non-decreasing order. Check whether it is possible to choose k numbers in array A and choose m numbers in array B so that any number chosen in the first array is strictly less than any number chosen in the second array." 900

571E "Geometric Progressions" math "Geometric progression with the first element a and common ratio b is a sequence of numbers a,\xe2\x80\x89ab,\xe2\x80\x89ab2,\xe2\x80\x89ab3,\xe2\x80\x89....You are given n integer geometric progressions. Your task is to find the smallest integer x, that is the element of all the given progressions, or else state that such integer does not exist." 3200

571D Campus "binary search,data structures,dsu,trees" "Oscolcovo city has a campus consisting of n student dormitories, n universities and n military offices. Initially, the i-th dormitory belongs to the i-th university and is assigned to the i-th military office.Life goes on and the campus is continuously going through some changes. The changes can be of four types:  University aj merges with university bj. After that all the dormitories that belonged to university bj are assigned to to university aj, and university bj disappears.  Military office cj merges with military office dj. After that all the dormitories that were assigned to military office dj, are assigned to military office cj, and military office dj disappears.  Students of university xj move in dormitories. Lets kxj is the number of dormitories that belong to this university at the time when the students move in. Then the number of students in each dormitory of university xj increases by kxj (note that the more dormitories belong to the university, the more students move in each dormitory of the university).  Military office number yj conducts raids on all the dormitories assigned to it and takes all students from there. Thus, at each moment of time each dormitory is assigned to exactly one university and one military office. Initially, all the dormitory are empty.Your task is to process the changes that take place in the campus and answer the queries, how many people currently live in dormitory qj." 3100

571C "CNF 2" "constructive algorithms,dfs and similar,graphs,greedy" "\'In Boolean logic, a formula is in conjunctive normal form (CNF) or clausal normal form if it is a conjunction of clauses, where a clause is a disjunction of literals\' (cited from https://en.wikipedia.org/wiki/Conjunctive_normal_form)In the other words, CNF is a formula of type , where & represents a logical ""AND"" (conjunction),  represents a logical ""OR"" (disjunction), and vij are some boolean variables or their negations. Each statement in brackets is called a clause, and vij are called literals.You are given a CNF containing variables x1,\xe2\x80\x89...,\xe2\x80\x89xm and their negations. We know that each variable occurs in at most two clauses (with negation and without negation in total). Your task is to determine whether this CNF is satisfiable, that is, whether there are such values of variables where the CNF value is true. If CNF is satisfiable, then you also need to determine the values of the variables at which the CNF is true. It is guaranteed that each variable occurs at most once in each clause." 2500

571B Minimization dp,greedy,sortings "You\'ve got array A, consisting of n integers and a positive integer k. Array A is indexed by integers from 1 to n.You need to permute the array elements so that value  became minimal possible. In particular, it is allowed not to change order of elements at all." 2000

571A "Lengthening Sticks" combinatorics,implementation,math "You are given three sticks with positive integer lengths of a,\xe2\x80\x89b, and c centimeters. You can increase length of some of them by some positive integer number of centimeters (different sticks can be increased by a different length), but in total by at most l centimeters. In particular, it is allowed not to increase the length of any stick.Determine the number of ways to increase the lengths of some sticks so that you can form from them a non-degenerate (that is, having a positive area) triangle. Two ways are considered different, if the length of some stick is increased by different number of centimeters in them." 2100

570E "Pig and Palindromes" combinatorics,dp "Peppa the Pig was walking and walked into the forest. What a strange coincidence! The forest has the shape of a rectangle, consisting of n rows and m columns. We enumerate the rows of the rectangle from top to bottom with numbers from 1 to n, and the columns \xe2\x80\x94 from left to right with numbers from 1 to m. Let\'s denote the cell at the intersection of the r-th row and the c-th column as (r,\xe2\x80\x89c).Initially the pig stands in cell (1,\xe2\x80\x891), and in the end she wants to be in cell (n,\xe2\x80\x89m). Since the pig is in a hurry to get home, she can go from cell (r,\xe2\x80\x89c), only to either cell (r\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89c) or (r,\xe2\x80\x89c\xe2\x80\x89+\xe2\x80\x891). She cannot leave the forest.The forest, where the pig is, is very unusual. Some cells of the forest similar to each other, and some look very different. Peppa enjoys taking pictures and at every step she takes a picture of the cell where she is now. The path through the forest is considered to be beautiful if photographs taken on her way, can be viewed in both forward and in reverse order, showing the same sequence of photos. More formally, the line formed by the cells in order of visiting should be a palindrome (you can read a formal definition of a palindrome in the previous problem).Count the number of beautiful paths from cell (1,\xe2\x80\x891) to cell (n,\xe2\x80\x89m). Since this number can be very large, determine the remainder after dividing it by 109\xe2\x80\x89+\xe2\x80\x897." 2300

570D "Tree Requests" "binary search,bitmasks,constructive algorithms,dfs and similar,graphs,trees" "Roman planted a tree consisting of n vertices. Each vertex contains a lowercase English letter. Vertex 1 is the root of the tree, each of the n\xe2\x80\x89-\xe2\x80\x891 remaining vertices has a parent in the tree. Vertex is connected with its parent by an edge. The parent of vertex i is vertex pi, the parent index is always less than the index of the vertex (i.e., pi\xe2\x80\x89<\xe2\x80\x89i).The depth of the vertex is the number of nodes on the path from the root to v along the edges. In particular, the depth of the root is equal to 1.We say that vertex u is in the subtree of vertex v, if we can get from u to v, moving from the vertex to the parent. In particular, vertex v is in its subtree.Roma gives you m queries, the i-th of which consists of two numbers vi, hi. Let\'s consider the vertices in the subtree vi located at depth hi. Determine whether you can use the letters written at these vertices to make a string that is a palindrome. The letters that are written in the vertexes, can be rearranged in any order to make a palindrome, but all letters should be used." 2200

570C Replacement "constructive algorithms,data structures,implementation" "Daniel has a string s, consisting of lowercase English letters and period signs (characters \'.\'). Let\'s define the operation of replacement as the following sequence of steps: find a substring "".."" (two consecutive periods) in string s, of all occurrences of the substring let\'s choose the first one, and replace this substring with string ""."". In other words, during the replacement operation, the first two consecutive periods are replaced by one. If string s contains no two consecutive periods, then nothing happens.Let\'s define f(s) as the minimum number of operations of replacement to perform, so that the string does not have any two consecutive periods left.You need to process m queries, the i-th results in that the character at position xi (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89xi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) of string s is assigned value ci. After each operation you have to calculate and output the value of f(s).Help Daniel to process all queries." 1600

570B "Simple Game" "constructive algorithms,games,greedy,implementation,math" "One day Misha and Andrew were playing a very simple game. First, each player chooses an integer in the range from 1 to n. Let\'s assume that Misha chose number m, and Andrew chose number a.Then, by using a random generator they choose a random integer c in the range between 1 and n (any integer from 1 to n is chosen with the same probability), after which the winner is the player, whose number was closer to c. The boys agreed that if m and a are located on the same distance from c, Misha wins.Andrew wants to win very much, so he asks you to help him. You know the number selected by Misha, and number n. You need to determine which value of a Andrew must choose, so that the probability of his victory is the highest possible.More formally, you need to find such integer a (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n), that the probability that  is maximal, where c is the equiprobably chosen integer from 1 to n (inclusive)." 1300

570A Elections implementation "The country of Byalechinsk is running elections involving n candidates. The country consists of m cities. We know how many people in each city voted for each candidate.The electoral system in the country is pretty unusual. At the first stage of elections the votes are counted for each city: it is assumed that in each city won the candidate who got the highest number of votes in this city, and if several candidates got the maximum number of votes, then the winner is the one with a smaller index.At the second stage of elections the winner is determined by the same principle over the cities: the winner of the elections is the candidate who won in the maximum number of cities, and among those who got the maximum number of cities the winner is the one with a smaller index.Determine who will win the elections." 1100

569B Inventory greedy,math "Companies always have a lot of equipment, furniture and other things. All of them should be tracked. To do this, there is an inventory number assigned with each item. It is much easier to create a database by using those numbers and keep the track of everything.During an audit, you were surprised to find out that the items are not numbered sequentially, and some items even share the same inventory number! There is an urgent need to fix it. You have chosen to make the numbers of the items sequential, starting with 1. Changing a number is quite a time-consuming process, and you would like to make maximum use of the current numbering.You have been given information on current inventory numbers for n items in the company. Renumber items so that their inventory numbers form a permutation of numbers from 1 to n by changing the number of as few items as possible. Let us remind you that a set of n numbers forms a permutation if all the numbers are in the range from 1 to n, and no two numbers are equal." 1200

569A Music implementation,math "Little Lesha loves listening to music via his smartphone. But the smartphone doesn\'t have much memory, so Lesha listens to his favorite songs in a well-known social network InTalk.Unfortunately, internet is not that fast in the city of Ekaterinozavodsk and the song takes a lot of time to download. But Lesha is quite impatient. The song\'s duration is T seconds. Lesha downloads the first S seconds of the song and plays it. When the playback reaches the point that has not yet been downloaded, Lesha immediately plays the song from the start (the loaded part of the song stays in his phone, and the download is continued from the same place), and it happens until the song is downloaded completely and Lesha listens to it to the end. For q seconds of real time the Internet allows you to download q\xe2\x80\x89-\xe2\x80\x891 seconds of the track.Tell Lesha, for how many times he will start the song, including the very first start." 1500

568E "Longest Increasing Subsequence" "data structures,dp" "Note that the memory limit in this problem is less than usual.Let\'s consider an array consisting of positive integers, some positions of which contain gaps.We have a collection of numbers that can be used to fill the gaps. Each number from the given collection can be used at most once.Your task is to determine such way of filling gaps that the longest increasing subsequence in the formed array has a maximum size." 3000

568D "Sign Posts" "brute force,geometry,math" "One Khanate had a lot of roads and very little wood. Riding along the roads was inconvenient, because the roads did not have road signs indicating the direction to important cities.The Han decided that it\'s time to fix the issue, and ordered to put signs on every road. The Minister of Transport has to do that, but he has only k signs. Help the minister to solve his problem, otherwise the poor guy can lose not only his position, but also his head.More formally, every road in the Khanate is a line on the Oxy plane, given by an equation of the form Ax\xe2\x80\x89+\xe2\x80\x89By\xe2\x80\x89+\xe2\x80\x89C\xe2\x80\x89=\xe2\x80\x890 (A and B are not equal to 0 at the same time). You are required to determine whether you can put signs in at most k points so that each road had at least one sign installed." 2800

568C "New Language" 2-sat,greedy "Living in Byteland was good enough to begin with, but the good king decided to please his subjects and to introduce a national language. He gathered the best of wise men, and sent an expedition to faraway countries, so that they would find out all about how a language should be designed.After some time, the wise men returned from the trip even wiser. They locked up for six months in the dining room, after which they said to the king: ""there are a lot of different languages, but almost all of them have letters that are divided into vowels and consonants; in a word, vowels and consonants must be combined correctly.""There are very many rules, all of them have exceptions, but our language will be deprived of such defects! We propose to introduce a set of formal rules of combining vowels and consonants, and include in the language all the words that satisfy them.The rules of composing words are: The letters are divided into vowels and consonants in some certain way; All words have a length of exactly n; There are m rules of the form (pos1,\xe2\x80\x89t1,\xe2\x80\x89pos2,\xe2\x80\x89t2). Each rule is: if the position pos1 has a letter of type t1, then the position pos2 has a letter of type t2.You are given some string s of length n, it is not necessarily a correct word of the new language. Among all the words of the language that lexicographically not smaller than the string s, find the minimal one in lexicographic order." 2600

568B "Symmetric and Transitive" combinatorics,dp,math "Little Johnny has recently learned about set theory. Now he is studying binary relations. You\'ve probably heard the term ""equivalence relation"". These relations are very important in many areas of mathematics. For example, the equality of the two numbers is an equivalence relation.A set \xcf\x81 of pairs (a,\xe2\x80\x89b) of elements of some set A is called a binary relation on set A. For two elements a and b of the set A we say that they are in relation \xcf\x81, if pair , in this case we use a notation .Binary relation is equivalence relation, if: It is reflexive (for any a it is true that ); It is symmetric (for any a, b it is true that if , then ); It is transitive (if  and , than ).Little Johnny is not completely a fool and he noticed that the first condition is not necessary! Here is his ""proof"":Take any two elements, a and b. If , then  (according to property (2)), which means  (according to property (3)).It\'s very simple, isn\'t it? However, you noticed that Johnny\'s ""proof"" is wrong, and decided to show him a lot of examples that prove him wrong.Here\'s your task: count the number of binary relations over a set of size n such that they are symmetric, transitive, but not an equivalence relations (i.e. they are not reflexive).Since their number may be very large (not 0, according to Little Johnny), print the remainder of integer division of this number by 109\xe2\x80\x89+\xe2\x80\x897." 1900

568A "Primes or Palindromes?" "brute force,implementation,math,number theory" "Rikhail Mubinchik believes that the current definition of prime numbers is obsolete as they are too complex and unpredictable. A palindromic number is another matter. It is aesthetically pleasing, and it has a number of remarkable properties. Help Rikhail to convince the scientific community in this!Let us remind you that a number is called prime if it is integer larger than one, and is not divisible by any positive integer other than itself and one.Rikhail calls a number a palindromic if it is integer, positive, and its decimal representation without leading zeros is a palindrome, i.e. reads the same from left to right and right to left.One problem with prime numbers is that there are too many of them. Let\'s introduce the following notation: \xcf\x80(n)�\xe2\x80\x94 the number of primes no larger than n, rub(n)�\xe2\x80\x94 the number of palindromic numbers no larger than n. Rikhail wants to prove that there are a lot more primes than palindromic ones.He asked you to solve the following problem: for a given value of the coefficient A find the maximum n, such that \xcf\x80(n)\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89A\xc2\xb7rub(n)." 1600

567F Mausoleum dp "King of Berland Berl IV has recently died. Hail Berl V! As a sign of the highest achievements of the deceased king the new king decided to build a mausoleum with Berl IV\'s body on the main square of the capital.The mausoleum will be constructed from 2n blocks, each of them has the shape of a cuboid. Each block has the bottom base of a 1\xe2\x80\x89\xc3\x97\xe2\x80\x891 meter square. Among the blocks, exactly two of them have the height of one meter, exactly two have the height of two meters, ..., exactly two have the height of n meters.The blocks are arranged in a row without spacing one after the other. Of course, not every arrangement of blocks has the form of a mausoleum. In order to make the given arrangement in the form of the mausoleum, it is necessary that when you pass along the mausoleum, from one end to the other, the heights of the blocks first were non-decreasing (i.e., increasing or remained the same), and then \xe2\x80\x94 non-increasing (decrease or remained unchanged). It is possible that any of these two areas will be omitted. For example, the following sequences of block height meet this requirement:  [1,\xe2\x80\x892,\xe2\x80\x892,\xe2\x80\x893,\xe2\x80\x894,\xe2\x80\x894,\xe2\x80\x893,\xe2\x80\x891];  [1,\xe2\x80\x891];  [2,\xe2\x80\x892,\xe2\x80\x891,\xe2\x80\x891];  [1,\xe2\x80\x892,\xe2\x80\x893,\xe2\x80\x893,\xe2\x80\x892,\xe2\x80\x891]. Suddenly, k more requirements appeared. Each of the requirements has the form: ""h[xi] signi h[yi]"", where h[t] is the height of the t-th block, and a signi is one of the five possible signs: \'=\' (equals), \'<\' (less than), \'>\' (more than), \'<=\' (less than or equals), \'>=\' (more than or equals). Thus, each of the k additional requirements is given by a pair of indexes xi, yi (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89xi,\xe2\x80\x89yi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x892n) and sign signi.Find the number of possible ways to rearrange the blocks so that both the requirement about the shape of the mausoleum (see paragraph 3) and the k additional requirements were met." 2400

567E "President and Roads" "dfs and similar,graphs,hashing,shortest paths" "Berland has n cities, the capital is located in city s, and the historic home town of the President is in city t (s\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89t). The cities are connected by one-way roads, the travel time for each of the road is a positive integer.Once a year the President visited his historic home town t, for which his motorcade passes along some path from s to t (he always returns on a personal plane). Since the president is a very busy man, he always chooses the path from s to t, along which he will travel the fastest.The ministry of Roads and Railways wants to learn for each of the road: whether the President will definitely pass through it during his travels, and if not, whether it is possible to repair it so that it would definitely be included in the shortest path from the capital to the historic home town of the President. Obviously, the road can not be repaired so that the travel time on it was less than one. The ministry of Berland, like any other, is interested in maintaining the budget, so it wants to know the minimum cost of repairing the road. Also, it is very fond of accuracy, so it repairs the roads so that the travel time on them is always a positive integer." 2200

567D "One-Dimensional Battle Ships" "binary search,data structures,greedy,sortings" "Alice and Bob love playing one-dimensional battle ships. They play on the field in the form of a line consisting of n square cells (that is, on a 1\xe2\x80\x89\xc3\x97\xe2\x80\x89n table).At the beginning of the game Alice puts k ships on the field without telling their positions to Bob. Each ship looks as a 1\xe2\x80\x89\xc3\x97\xe2\x80\x89a rectangle (that is, it occupies a sequence of a consecutive squares of the field). The ships cannot intersect and even touch each other.After that Bob makes a sequence of ""shots"". He names cells of the field and Alice either says that the cell is empty (""miss""), or that the cell belongs to some ship (""hit"").But here\'s the problem! Alice like to cheat. May be that is why she responds to each Bob\'s move with a ""miss"". Help Bob catch Alice cheating \xe2\x80\x94 find Bob\'s first move, such that after it you can be sure that Alice cheated." 1700

567C "Geometric Progression" "binary search,data structures,dp" "Polycarp loves geometric progressions very much. Since he was only three years old, he loves only the progressions of length three. He also has a favorite integer k and a sequence a, consisting of n integers.He wants to know how many subsequences of length three can be selected from a, so that they form a geometric progression with common ratio k.A subsequence of length three is a combination of three such indexes i1,\xe2\x80\x89i2,\xe2\x80\x89i3, that 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i1\xe2\x80\x89<\xe2\x80\x89i2\xe2\x80\x89<\xe2\x80\x89i3\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n. That is, a subsequence of length three are such groups of three elements that are not necessarily consecutive in the sequence, but their indexes are strictly increasing.A geometric progression with common ratio k is a sequence of numbers of the form b\xc2\xb7k0,\xe2\x80\x89b\xc2\xb7k1,\xe2\x80\x89...,\xe2\x80\x89b\xc2\xb7kr\xe2\x80\x89-\xe2\x80\x891.Polycarp is only three years old, so he can not calculate this number himself. Help him to do it." 1700

567B "Berland National Library" implementation "Berland National Library has recently been built in the capital of Berland. In addition, in the library you can take any of the collected works of Berland leaders, the library has a reading room.Today was the pilot launch of an automated reading room visitors\' accounting system! The scanner of the system is installed at the entrance to the reading room. It records the events of the form ""reader entered room"", ""reader left room"". Every reader is assigned a registration number during the registration procedure at the library \xe2\x80\x94 it\'s a unique integer from 1 to 106. Thus, the system logs events of two forms:  ""+ ri"" \xe2\x80\x94 the reader with registration number ri entered the room;  ""- ri"" \xe2\x80\x94 the reader with registration number ri left the room. The first launch of the system was a success, it functioned for some period of time, and, at the time of its launch and at the time of its shutdown, the reading room may already have visitors.Significant funds of the budget of Berland have been spent on the design and installation of the system. Therefore, some of the citizens of the capital now demand to explain the need for this system and the benefits that its implementation will bring. Now, the developers of the system need to urgently come up with reasons for its existence.Help the system developers to find the minimum possible capacity of the reading room (in visitors) using the log of the system available to you." 1300

567A "Lineland Mail" greedy,implementation "All cities of Lineland are located on the Ox coordinate axis. Thus, each city is associated with its position xi \xe2\x80\x94 a coordinate on the Ox axis. No two cities are located at a single point.Lineland residents love to send letters to each other. A person may send a letter only if the recipient lives in another city (because if they live in the same city, then it is easier to drop in).Strange but true, the cost of sending the letter is exactly equal to the distance between the sender\'s city and the recipient\'s city.For each city calculate two values \xe2\x80\x8b\xe2\x80\x8bmini and maxi, where mini is the minimum cost of sending a letter from the i-th city to some other city, and maxi is the the maximum cost of sending a letter from the i-th city to some other city" 900

566G "Max and Min" geometry "Two kittens, Max and Min, play with a pair of non-negative integers x and y. As you can guess from their names, kitten Max loves to maximize and kitten Min loves to minimize. As part of this game Min wants to make sure that both numbers, x and y became negative at the same time, and kitten Max tries to prevent him from doing so.Each kitten has a set of pairs of integers available to it. Kitten Max has n pairs of non-negative integers (ai,\xe2\x80\x89bi) (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n), and kitten Min has m pairs of non-negative integers (cj,\xe2\x80\x89dj) (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m). As kitten Max makes a move, it can take any available pair (ai,\xe2\x80\x89bi) and add ai to x and bi to y, and kitten Min can take any available pair (cj,\xe2\x80\x89dj) and subtract cj from x and dj from y. Each kitten can use each pair multiple times during distinct moves.Max moves first. Kitten Min is winning if at some moment both numbers a, b are negative simultaneously. Otherwise, the winner of the game is kitten Max. Determine which kitten wins if both of them play optimally." 2500

566F "Clique in the Divisibility Graph" "dp,math,number theory" "As you must know, the maximum clique problem in an arbitrary graph is NP-hard. Nevertheless, for some graphs of specific kinds it can be solved effectively.Just in case, let us remind you that a clique in a non-directed graph is a subset of the vertices of a graph, such that any two vertices of this subset are connected by an edge. In particular, an empty set of vertexes and a set consisting of a single vertex, are cliques.Let\'s define a divisibility graph for a set of positive integers A\xe2\x80\x89=\xe2\x80\x89{a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an} as follows. The vertices of the given graph are numbers from set A, and two numbers ai and aj (i\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89j) are connected by an edge if and only if either ai is divisible by aj, or aj is divisible by ai.You are given a set of non-negative integers A. Determine the size of a maximum clique in a divisibility graph for set A." 1500

566E "Restoring Map" "bitmasks,constructive algorithms,trees" "Archaeologists found some information about an ancient land of Treeland. We know for sure that the Treeland consisted of n cities connected by the n\xe2\x80\x89-\xe2\x80\x891 road, such that you can get from each city to any other one along the roads. However, the information about the specific design of roads in Treeland has been lost. The only thing that the archaeologists can use is the preserved information about near cities.Two cities of Treeland were called near, if it were possible to move from one city to the other one by moving through at most two roads. Also, a city is considered near to itself. During the recent excavations archaeologists found a set of n notes, each of them represents a list of cities, near to some of the n cities of the country. However, unfortunately, none of the found records lets you understand in what order the cities go in the list and for which city in the list the near to it cities were listed. Help the archaeologists and restore any variant of the map of Treeland that meets the found information." 3200

566D "Restructuring Company" "data structures,dsu" "Even the most successful company can go through a crisis period when you have to make a hard decision \xe2\x80\x94 to restructure, discard and merge departments, fire employees and do other unpleasant stuff. Let\'s consider the following model of a company.There are n people working for the Large Software Company. Each person belongs to some department. Initially, each person works on his own project in his own department (thus, each company initially consists of n departments, one person in each).However, harsh times have come to the company and the management had to hire a crisis manager who would rebuild the working process in order to boost efficiency. Let\'s use team(person) to represent a team where person person works. A crisis manager can make decisions of two types:  Merge departments team(x) and team(y) into one large department containing all the employees of team(x) and team(y), where x and y (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x,\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) \xe2\x80\x94 are numbers of two of some company employees. If team(x) matches team(y), then nothing happens.  Merge departments team(x),\xe2\x80\x89team(x\xe2\x80\x89+\xe2\x80\x891),\xe2\x80\x89...,\xe2\x80\x89team(y), where x and y (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) \xe2\x80\x94 the numbers of some two employees of the company. At that the crisis manager can sometimes wonder whether employees x and y (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x,\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) work at the same department.Help the crisis manager and answer all of his queries." 1900

566C "Logistical Questions" "dfs and similar,divide and conquer,trees" "Some country consists of n cities, connected by a railroad network. The transport communication of the country is so advanced that the network consists of a minimum required number of (n\xe2\x80\x89-\xe2\x80\x891) bidirectional roads (in the other words, the graph of roads is a tree). The i-th road that directly connects cities ai and bi, has the length of li kilometers.The transport network is served by a state transporting company FRR (Fabulous Rail Roads). In order to simplify the price policy, it offers a single ride fare on the train. In order to follow the route of length t kilometers, you need to pay  burles. Note that it is forbidden to split a long route into short segments and pay them separately (a special railroad police, or RRP, controls that the law doesn\'t get violated).A Large Software Company decided to organize a programming tournament. Having conducted several online rounds, the company employees determined a list of finalists and sent it to the logistical department to find a place where to conduct finals. The Large Software Company can easily organize the tournament finals in any of the n cities of the country, so the the main factor in choosing the city for the last stage of the tournament is the total cost of buying tickets for all the finalists. We know that the i-th city of the country has wi cup finalists living there.Help the company employees find the city such that the total cost of travel of all the participants to it is minimum." 3000

566B "Replicating Processes" "constructive algorithms,greedy" "A Large Software Company develops its own social network. Analysts have found that during the holidays, major sporting events and other significant events users begin to enter the network more frequently, resulting in great load increase on the infrastructure.As part of this task, we assume that the social network is 4n processes running on the n servers. All servers are absolutely identical machines, each of which has a volume of RAM of 1 GB = 1024 MB (1). Each process takes 100 MB of RAM on the server. At the same time, the needs of maintaining the viability of the server takes about 100 more megabytes of RAM. Thus, each server may have up to 9 different processes of social network.Now each of the n servers is running exactly 4 processes. However, at the moment of peak load it is sometimes necessary to replicate the existing 4n processes by creating 8n new processes instead of the old ones. More formally, there is a set of replication rules, the i-th (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x894n) of which has the form of ai\xe2\x80\x89\xe2\x86\x92\xe2\x80\x89(bi,\xe2\x80\x89ci), where ai, bi and ci (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ai,\xe2\x80\x89bi,\xe2\x80\x89ci\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) are the numbers of servers. This means that instead of an old process running on server ai, there should appear two new copies of the process running on servers bi and ci. The two new replicated processes can be on the same server (i.e., bi may be equal to ci) or even on the same server where the original process was (i.e. ai may be equal to bi or ci). During the implementation of the rule ai\xe2\x80\x89\xe2\x86\x92\xe2\x80\x89(bi,\xe2\x80\x89ci) first the process from the server ai is destroyed, then appears a process on the server bi, then appears a process on the server ci.There is a set of 4n rules, destroying all the original 4n processes from n servers, and creating after their application 8n replicated processes, besides, on each of the n servers will be exactly 8 processes. However, the rules can only be applied consecutively, and therefore the amount of RAM of the servers imposes limitations on the procedure for the application of the rules.According to this set of rules determine the order in which you want to apply all the 4n rules so that at any given time the memory of each of the servers contained at most 9 processes (old and new together), or tell that it is impossible." 2600

566A "Matching Names" "dfs and similar,strings,trees" "Teachers of one programming summer school decided to make a surprise for the students by giving them names in the style of the ""Hobbit"" movie. Each student must get a pseudonym maximally similar to his own name. The pseudonym must be a name of some character of the popular saga and now the teachers are busy matching pseudonyms to student names.There are n students in a summer school. Teachers chose exactly n pseudonyms for them. Each student must get exactly one pseudonym corresponding to him. Let us determine the relevance of a pseudonym b to a student with name a as the length of the largest common prefix a and b. We will represent such value as . Then we can determine the quality of matching of the pseudonyms to students as a sum of relevances of all pseudonyms to the corresponding students.Find the matching between students and pseudonyms with the maximum quality." 2300

560B "Gerald is into Art" "constructive algorithms,implementation" "Gerald bought two very rare paintings at the Sotheby\'s auction and he now wants to hang them on the wall. For that he bought a special board to attach it to the wall and place the paintings on the board. The board has shape of an a1\xe2\x80\x89\xc3\x97\xe2\x80\x89b1 rectangle, the paintings have shape of a a2\xe2\x80\x89\xc3\x97\xe2\x80\x89b2 and a3\xe2\x80\x89\xc3\x97\xe2\x80\x89b3 rectangles.Since the paintings are painted in the style of abstract art, it does not matter exactly how they will be rotated, but still, one side of both the board, and each of the paintings must be parallel to the floor. The paintings can touch each other and the edges of the board, but can not overlap or go beyond the edge of the board. Gerald asks whether it is possible to place the paintings on the board, or is the board he bought not large enough?" 1200

560A "Currency System in Geraldion" implementation,sortings "A magic island Geraldion, where Gerald lives, has its own currency system. It uses banknotes of several values. But the problem is, the system is not perfect and sometimes it happens that Geraldionians cannot express a certain sum of money with any set of banknotes. Of course, they can use any number of banknotes of each value. Such sum is called unfortunate. Gerald wondered: what is the minimum unfortunate sum?" 1000

559E "Gerald and Path" dp,sortings "The main walking trail in Geraldion is absolutely straight, and it passes strictly from the north to the south, it is so long that no one has ever reached its ends in either of the two directions. The Geraldionians love to walk on this path at any time, so the mayor of the city asked the Herald to illuminate this path with a few spotlights. The spotlights have already been delivered to certain places and Gerald will not be able to move them. Each spotlight illuminates a specific segment of the path of the given length, one end of the segment is the location of the spotlight, and it can be directed so that it covers the segment to the south or to the north of spotlight.The trail contains a monument to the mayor of the island, and although you can walk in either directions from the monument, no spotlight is south of the monument.You are given the positions of the spotlights and their power. Help Gerald direct all the spotlights so that the total length of the illuminated part of the path is as much as possible." 3000

559D Randomizer combinatorics,geometry,probabilities "Gerald got tired of playing board games with the usual six-sided die, and he bought a toy called Randomizer. It functions as follows.A Randomizer has its own coordinate plane on which a strictly convex polygon is painted, the polygon is called a basic polygon. If you shake a Randomizer, it draws some nondegenerate (i.e. having a non-zero area) convex polygon with vertices at some vertices of the basic polygon. The result of the roll (more precisely, the result of the shaking) is considered to be the number of points with integer coordinates, which were strictly inside (the points on the border are not considered) the selected polygon. Now Gerald is wondering: what is the expected result of shaking the Randomizer?During the shaking the Randomizer considers all the possible non-degenerate convex polygons with vertices at the vertices of the basic polygon. Let\'s assume that there are k versions of the polygons. Then the Randomizer chooses each of them with probability ." 2800

559C "Gerald and Giant Chess" "combinatorics,dp,math,number theory" "Giant chess is quite common in Geraldion. We will not delve into the rules of the game, we\'ll just say that the game takes place on an h\xe2\x80\x89\xc3\x97\xe2\x80\x89w field, and it is painted in two colors, but not like in chess. Almost all cells of the field are white and only some of them are black. Currently Gerald is finishing a game of giant chess against his friend Pollard. Gerald has almost won, and the only thing he needs to win is to bring the pawn from the upper left corner of the board, where it is now standing, to the lower right corner. Gerald is so confident of victory that he became interested, in how many ways can he win?The pawn, which Gerald has got left can go in two ways: one cell down or one cell to the right. In addition, it can not go to the black cells, otherwise the Gerald still loses. There are no other pawns or pieces left on the field, so that, according to the rules of giant chess Gerald moves his pawn until the game is over, and Pollard is just watching this process." 2200

559B "Equivalent Strings" "divide and conquer,hashing,sortings,strings" "Today on a lecture about strings Gerald learned a new definition of string equivalency. Two strings a and b of equal length are called equivalent in one of the two cases:   They are equal.  If we split string a into two halves of the same size a1 and a2, and string b into two halves of the same size b1 and b2, then one of the following is correct:   a1 is equivalent to b1, and a2 is equivalent to b2  a1 is equivalent to b2, and a2 is equivalent to b1  As a home task, the teacher gave two strings to his students and asked to determine if they are equivalent.Gerald has already completed this home task. Now it\'s your turn!" 1700

559A "Gerald\'s Hexagon" "brute force,geometry,math" "Today on a lecture about strings Gerald learned a new definition of string equivalency. Two strings a and b of equal length are called equivalent in one of the two cases:   They are equal.  If we split string a into two halves of the same size a1 and a2, and string b into two halves of the same size b1 and b2, then one of the following is correct:   a1 is equivalent to b1, and a2 is equivalent to b2  a1 is equivalent to b2, and a2 is equivalent to b1  As a home task, the teacher gave two strings to his students and asked to determine if they are equivalent.Gerald has already completed this home task. Now it\'s your turn!" 1600

558E "A Simple Task" "data structures,sortings,strings" "This task is very simple. Given a string S of length n and q queries each query is on the format i j k which means sort the substring consisting of the characters from i to j in non-decreasing order if k\xe2\x80\x89=\xe2\x80\x891 or in non-increasing order if k\xe2\x80\x89=\xe2\x80\x890.Output the final string after applying the queries." 2300

558D "Guess Your Way Out! II" "data structures,implementation,sortings" "Amr bought a new video game ""Guess Your Way Out! II"". The goal of the game is to find an exit from the maze that looks like a perfect binary tree of height h. The player is initially standing at the root of the tree and the exit from the tree is located at some leaf node.Let\'s index all the nodes of the tree such that   The root is number 1  Each internal node i (i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x892h\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89-\xe2\x80\x891) will have a left child with index = 2i and a right child with index = 2i\xe2\x80\x89+\xe2\x80\x891 The level of a node is defined as 1 for a root, or 1 + level of parent of the node otherwise. The vertices of the level h are called leaves. The exit to the maze is located at some leaf node n, the player doesn\'t know where the exit is so he has to guess his way out! In the new version of the game the player is allowed to ask questions on the format ""Does the ancestor(exit,\xe2\x80\x89i) node number belong to the range [L,\xe2\x80\x89R]?"". Here ancestor(v,\xe2\x80\x89i) is the ancestor of a node v that located in the level i. The game will answer with ""Yes"" or ""No"" only. The game is designed such that it doesn\'t always answer correctly, and sometimes it cheats to confuse the player!.Amr asked a lot of questions and got confused by all these answers, so he asked you to help him. Given the questions and its answers, can you identify whether the game is telling contradictory information or not? If the information is not contradictory and the exit node can be determined uniquely, output its number. If the information is not contradictory, but the exit node isn\'t defined uniquely, output that the number of questions is not sufficient. Otherwise output that the information is contradictory." 2300

558C "Amr and Chemistry" "brute force,graphs,greedy,math,shortest paths" "Amr loves Chemistry, and specially doing experiments. He is preparing for a new interesting experiment.Amr has n different types of chemicals. Each chemical i has an initial volume of ai liters. For this experiment, Amr has to mix all the chemicals together, but all the chemicals volumes must be equal first. So his task is to make all the chemicals volumes equal.To do this, Amr can do two different kind of operations.   Choose some chemical i and double its current volume so the new volume will be 2ai  Choose some chemical i and divide its volume by two (integer division) so the new volume will be  Suppose that each chemical is contained in a vessel of infinite volume. Now Amr wonders what is the minimum number of operations required to make all the chemicals volumes equal?" 1900

558B "Amr and The Large Array" implementation "Amr has got a large array of size n. Amr doesn\'t like large arrays so he intends to make it smaller.Amr doesn\'t care about anything in the array except the beauty of it. The beauty of the array is defined to be the maximum number of times that some number occurs in this array. He wants to choose the smallest subsegment of this array such that the beauty of it will be the same as the original array.Help Amr by choosing the smallest subsegment possible." 1300

558A "Lala Land and Apple Trees" "brute force,implementation,sortings" "Amr lives in Lala Land. Lala Land is a very beautiful country that is located on a coordinate line. Lala Land is famous with its apple trees growing everywhere.Lala Land has exactly n apple trees. Tree number i is located in a position xi and has ai apples growing on it. Amr wants to collect apples from the apple trees. Amr currently stands in x\xe2\x80\x89=\xe2\x80\x890 position. At the beginning, he can choose whether to go right or left. He\'ll continue in his direction until he meets an apple tree he didn\'t visit before. He\'ll take all of its apples and then reverse his direction, continue walking in this direction until he meets another apple tree he didn\'t visit before and so on. In the other words, Amr reverses his direction when visiting each new apple tree. Amr will stop collecting apples when there are no more trees he didn\'t visit in the direction he is facing.What is the maximum number of apples he can collect?" 1100

557E "Ann and Half-Palindrome" "data structures,dp,graphs,string suffix structures,strings,trees" "Tomorrow Ann takes the hardest exam of programming where she should get an excellent mark. On the last theoretical class the teacher introduced the notion of a half-palindrome. String t is a half-palindrome, if for all the odd positions i () the following condition is held: ti\xe2\x80\x89=\xe2\x80\x89t|t|\xe2\x80\x89-\xe2\x80\x89i\xe2\x80\x89+\xe2\x80\x891, where |t| is the length of string t if positions are indexed from 1. For example, strings ""abaa"", ""a"", ""bb"", ""abbbaa"" are half-palindromes and strings ""ab"", ""bba"" and ""aaabaa"" are not.Ann knows that on the exam she will get string s, consisting only of letters a and b, and number k. To get an excellent mark she has to find the k-th in the lexicographical order string among all substrings of s that are half-palyndromes. Note that each substring in this order is considered as many times as many times it occurs in s.The teachers guarantees that the given number k doesn\'t exceed the number of substrings of the given string that are half-palindromes.Can you cope with this problem?" 2300

557D "Vitaly and Cycle" "combinatorics,dfs and similar,graphs,math" "After Vitaly was expelled from the university, he became interested in the graph theory.Vitaly especially liked the cycles of an odd length in which each vertex occurs at most once.Vitaly was wondering how to solve the following problem. You are given an undirected graph consisting of n vertices and m edges, not necessarily connected, without parallel edges and loops. You need to find t \xe2\x80\x94 the minimum number of edges that must be added to the given graph in order to form a simple cycle of an odd length, consisting of more than one vertex. Moreover, he must find w \xe2\x80\x94 the number of ways to add t edges in order to form a cycle of an odd length (consisting of more than one vertex). It is prohibited to add loops or parallel edges.Two ways to add edges to the graph are considered equal if they have the same sets of added edges.Since Vitaly does not study at the university, he asked you to help him with this task." 2000

557C "Arthur and Table" "brute force,data structures,dp,greedy,math,sortings" "Arthur has bought a beautiful big table into his new flat. When he came home, Arthur noticed that the new table is unstable.In total the table Arthur bought has n legs, the length of the i-th leg is li.Arthur decided to make the table stable and remove some legs. For each of them Arthur determined number di�\xe2\x80\x94�the amount of energy that he spends to remove the i-th leg.A table with k legs is assumed to be stable if there are more than half legs of the maximum length. For example, to make a table with 5 legs stable, you need to make sure it has at least three (out of these five) legs of the maximum length. Also, a table with one leg is always stable and a table with two legs is stable if and only if they have the same lengths.Your task is to help Arthur and count the minimum number of energy units Arthur should spend on making the table stable." 1900

557B "Pasha and Tea" "constructive algorithms,implementation,math,sortings" "Pasha decided to invite his friends to a tea party. For that occasion, he has a large teapot with the capacity of w milliliters and 2n tea cups, each cup is for one of Pasha\'s friends. The i-th cup can hold at most ai milliliters of water.It turned out that among Pasha\'s friends there are exactly n boys and exactly n girls and all of them are going to come to the tea party. To please everyone, Pasha decided to pour the water for the tea as follows:  Pasha can boil the teapot exactly once by pouring there at most w milliliters of water;  Pasha pours the same amount of water to each girl;  Pasha pours the same amount of water to each boy;  if each girl gets x milliliters of water, then each boy gets 2x milliliters of water. In the other words, each boy should get two times more water than each girl does.Pasha is very kind and polite, so he wants to maximize the total amount of the water that he pours to his friends. Your task is to help him and determine the optimum distribution of cups between Pasha\'s friends." 1500

557A "Ilya and Diplomas" greedy,implementation,math "Soon a school Olympiad in Informatics will be held in Berland, n schoolchildren will participate there.At a meeting of the jury of the Olympiad it was decided that each of the n participants, depending on the results, will get a diploma of the first, second or third degree. Thus, each student will receive exactly one diploma.They also decided that there must be given at least min1 and at most max1 diplomas of the first degree, at least min2 and at most max2 diplomas of the second degree, and at least min3 and at most max3 diplomas of the third degree.After some discussion it was decided to choose from all the options of distributing diplomas satisfying these limitations the one that maximizes the number of participants who receive diplomas of the first degree. Of all these options they select the one which maximizes the number of the participants who receive diplomas of the second degree. If there are multiple of these options, they select the option that maximizes the number of diplomas of the third degree.Choosing the best option of distributing certificates was entrusted to Ilya, one of the best programmers of Berland. However, he found more important things to do, so it is your task now to choose the best option of distributing of diplomas, based on the described limitations.It is guaranteed that the described limitations are such that there is a way to choose such an option of distributing diplomas that all n participants of the Olympiad will receive a diploma of some degree." 1100

556B "Case of Fake Numbers" "brute force,implementation" "Andrewid the Android is a galaxy-famous detective. He is now investigating a case of frauds who make fake copies of the famous Stolp\'s gears, puzzles that are as famous as the Rubik\'s cube once was.Its most important components are a button and a line of n similar gears. Each gear has n teeth containing all numbers from 0 to n\xe2\x80\x89-\xe2\x80\x891 in the counter-clockwise order. When you push a button, the first gear rotates clockwise, then the second gear rotates counter-clockwise, the the third gear rotates clockwise an so on.Besides, each gear has exactly one active tooth. When a gear turns, a new active tooth is the one following after the current active tooth according to the direction of the rotation. For example, if n\xe2\x80\x89=\xe2\x80\x895, and the active tooth is the one containing number 0, then clockwise rotation makes the tooth with number 1 active, or the counter-clockwise rotating makes the tooth number 4 active.Andrewid remembers that the real puzzle has the following property: you can push the button multiple times in such a way that in the end the numbers on the active teeth of the gears from first to last form sequence 0,\xe2\x80\x891,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x891. Write a program that determines whether the given puzzle is real or fake." 1100

556A "Case of the Zeros and Ones" greedy "Andrewid the Android is a galaxy-famous detective. In his free time he likes to think about strings containing zeros and ones.Once he thought about a string of length n consisting of zeroes and ones. Consider the following operation: we choose any two adjacent positions in the string, and if one them contains 0, and the other contains 1, then we are allowed to remove these two digits from the string, obtaining a string of length n\xe2\x80\x89-\xe2\x80\x892 as a result.Now Andreid thinks about what is the minimum length of the string that can remain after applying the described operation several times (possibly, zero)? Help him to calculate this number." 900

555E "Case of Computer Network" "dfs and similar,graphs,trees" "Andrewid the Android is a galaxy-known detective. Now he is preparing a defense against a possible attack by hackers on a major computer network.In this network are n vertices, some pairs of vertices are connected by m undirected channels. It is planned to transfer q important messages via this network, the i-th of which must be sent from vertex si to vertex di via one or more channels, perhaps through some intermediate vertices.To protect against attacks a special algorithm was developed. Unfortunately it can be applied only to the network containing directed channels. Therefore, as new channels can\'t be created, it was decided for each of the existing undirected channels to enable them to transmit data only in one of the two directions.Your task is to determine whether it is possible so to choose the direction for each channel so that each of the q messages could be successfully transmitted." 2800

555D "Case of a Top Secret" "binary search,implementation,math" "Andrewid the Android is a galaxy-famous detective. Now he is busy with a top secret case, the details of which are not subject to disclosure.However, he needs help conducting one of the investigative experiment. There are n pegs put on a plane, they are numbered from 1 to n, the coordinates of the i-th of them are (xi,\xe2\x80\x890). Then, we tie to the bottom of one of the pegs a weight on a tight rope of length l (thus, its coordinates will be equal to (xi,\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x89l), where i is the number of the used peg). Then the weight is pushed to the right, so that it starts to rotate counterclockwise. At the same time, if the weight during rotation touches some of the other pegs, it then begins to rotate around that peg. Suppose that each peg itself is very thin and does not affect the rope length while weight is rotating around it.  More formally, if at some moment the segment of the rope contains one or more pegs in addition to the peg around which the weight is rotating, the weight will then rotate around the farthermost one of them on a shorter segment of a rope. In particular, if the segment of the rope touches some peg by its endpoint, it is considered that the weight starts to rotate around that peg on a segment of the rope of length 0.At some moment the weight will begin to rotate around some peg, without affecting the rest of the pegs. Andrewid interested in determining the number of this peg.Andrewid prepared m queries containing initial conditions for pushing the weight, help him to determine for each of them, around what peg the weight will eventually rotate." 2500

555C "Case of Chocolate" "data structures" "Andrewid the Android is a galaxy-known detective. Now he does not investigate any case and is eating chocolate out of boredom.A bar of chocolate can be presented as an n\xe2\x80\x89\xc3\x97\xe2\x80\x89n table, where each cell represents one piece of chocolate. The columns of the table are numbered from 1 to n from left to right and the rows are numbered from top to bottom. Let\'s call the anti-diagonal to be a diagonal that goes the lower left corner to the upper right corner of the table. First Andrewid eats all the pieces lying below the anti-diagonal. Then he performs the following q actions with the remaining triangular part: first, he chooses a piece on the anti-diagonal and either direction \'up\' or \'left\', and then he begins to eat all the pieces starting from the selected cell, moving in the selected direction until he reaches the already eaten piece or chocolate bar edge.After each action, he wants to know how many pieces he ate as a result of this action." 2200

555B "Case of Fugitive" "data structures,greedy,sortings" "Andrewid the Android is a galaxy-famous detective. He is now chasing a criminal hiding on the planet Oxa-5, the planet almost fully covered with water.The only dry land there is an archipelago of n narrow islands located in a row. For more comfort let\'s represent them as non-intersecting segments on a straight line: island i has coordinates [li,\xe2\x80\x89ri], besides, ri\xe2\x80\x89<\xe2\x80\x89li\xe2\x80\x89+\xe2\x80\x891 for 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x891.To reach the goal, Andrewid needs to place a bridge between each pair of adjacent islands. A bridge of length a can be placed between the i-th and the (i\xe2\x80\x89+\xe2\x80\x891)-th islads, if there are such coordinates of x and y, that li\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ri, li\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ri\xe2\x80\x89+\xe2\x80\x891 and y\xe2\x80\x89-\xe2\x80\x89x\xe2\x80\x89=\xe2\x80\x89a. The detective was supplied with m bridges, each bridge can be used at most once. Help him determine whether the bridges he got are enough to connect each pair of adjacent islands." 2000

555A "Case of Matryoshkas" implementation "Andrewid the Android is a galaxy-famous detective. He is now investigating the case of vandalism at the exhibition of contemporary art.The main exhibit is a construction of n matryoshka dolls that can be nested one into another. The matryoshka dolls are numbered from 1 to n. A matryoshka with a smaller number can be nested in a matryoshka with a higher number, two matryoshkas can not be directly nested in the same doll, but there may be chain nestings, for example, 1\xe2\x80\x89\xe2\x86\x92\xe2\x80\x892\xe2\x80\x89\xe2\x86\x92\xe2\x80\x894\xe2\x80\x89\xe2\x86\x92\xe2\x80\x895. In one second, you can perform one of the two following operations:  Having a matryoshka a that isn\'t nested in any other matryoshka and a matryoshka b, such that b doesn\'t contain any other matryoshka and is not nested in any other matryoshka, you may put a in b;  Having a matryoshka a directly contained in matryoshka b, such that b is not nested in any other matryoshka, you may get a out of b. According to the modern aesthetic norms the matryoshka dolls on display were assembled in a specific configuration, i.e. as several separate chains of nested matryoshkas, but the criminal, following the mysterious plan, took out all the dolls and assembled them into a single large chain (1\xe2\x80\x89\xe2\x86\x92\xe2\x80\x892\xe2\x80\x89\xe2\x86\x92\xe2\x80\x89...\xe2\x80\x89\xe2\x86\x92\xe2\x80\x89n). In order to continue the investigation Andrewid needs to know in what minimum time it is possible to perform this action." 1500

554B "Ohana Cleans Up" "brute force,greedy,strings" "Ohana Matsumae is trying to clean a room, which is divided up into an n by n grid of squares. Each square is initially either clean or dirty. Ohana can sweep her broom over columns of the grid. Her broom is very strange: if she sweeps over a clean square, it will become dirty, and if she sweeps over a dirty square, it will become clean. She wants to sweep some columns of the room to maximize the number of rows that are completely clean. It is not allowed to sweep over the part of the column, Ohana can only sweep the whole column.Return the maximum number of rows that she can make completely clean." 1200

554A "Kyoya and Photobooks" "brute force,math,strings" "Kyoya Ootori is selling photobooks of the Ouran High School Host Club. He has 26 photos, labeled ""a"" to ""z"", and he has compiled them into a photo booklet with some photos in some order (possibly with some photos being duplicated). A photo booklet can be described as a string of lowercase letters, consisting of the photos in the booklet in order. He now wants to sell some ""special edition"" photobooks, each with one extra photo inserted anywhere in the book. He wants to make as many distinct photobooks as possible, so he can make more money. He asks Haruhi, how many distinct photobooks can he make by inserting one extra photo into the photobook he already has?Please help Haruhi solve this problem." 900

553E "Kyoya and Train" dp,fft,graphs,math,probabilities "Kyoya Ootori wants to take the train to get to school. There are n train stations and m one-way train lines going between various stations. Kyoya is currently at train station 1, and the school is at station n. To take a train, he must pay for a ticket, and the train also takes a certain amount of time. However, the trains are not perfect and take random amounts of time to arrive at their destination. If Kyoya arrives at school strictly after t time units, he will have to pay a fine of x.Each train line is described by a ticket price, and a probability distribution on the time the train takes. More formally, train line i has ticket cost ci, and a probability distribution pi,\xe2\x80\x89k which denotes the probability that this train will take k time units for all 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89t. Amounts of time that each of the trains used by Kyouya takes are mutually independent random values (moreover, if Kyoya travels along the same train more than once, it is possible for the train to take different amounts of time and those amounts are also independent one from another). Kyoya wants to get to school by spending the least amount of money in expectation (for the ticket price plus possible fine for being late). Of course, Kyoya has an optimal plan for how to get to school, and every time he arrives at a train station, he may recalculate his plan based on how much time he has remaining. What is the expected cost that Kyoya will pay to get to school if he moves optimally?" 3200

553D "Nudist Beach" "binary search,graphs,greedy" "Nudist Beach is planning a military operation to attack the Life Fibers. In this operation, they will attack and capture several cities which are currently under the control of the Life Fibers.There are n cities, labeled from 1 to n, and m bidirectional roads between them. Currently, there are Life Fibers in every city. In addition, there are k cities that are fortresses of the Life Fibers that cannot be captured under any circumstances. So, the Nudist Beach can capture an arbitrary non-empty subset of cities with no fortresses.After the operation, Nudist Beach will have to defend the captured cities from counterattack. If they capture a city and it is connected to many Life Fiber controlled cities, it will be easily defeated. So, Nudist Beach would like to capture a set of cities such that for each captured city the ratio of Nudist Beach controlled neighbors among all neighbors of that city is as high as possible. More formally, they would like to capture a non-empty set of cities S with no fortresses of Life Fibers. The strength of a city  is defined as (number of neighbors of x in S) / (total number of neighbors of x). Here, two cities are called neighbors if they are connnected with a road. The goal is to maximize the strength of the weakest city in S.Given a description of the graph, and the cities with fortresses, find a non-empty subset that maximizes the strength of the weakest city." 2300

553C "Love Triangles" "dfs and similar,dsu,graphs" "There are many anime that are about ""love triangles"": Alice loves Bob, and Charlie loves Bob as well, but Alice hates Charlie. You are thinking about an anime which has n characters. The characters are labeled from 1 to n. Every pair of two characters can either mutually love each other or mutually hate each other (there is no neutral state).You hate love triangles (A-B are in love and B-C are in love, but A-C hate each other), and you also hate it when nobody is in love. So, considering any three characters, you will be happy if exactly one pair is in love (A and B love each other, and C hates both A and B), or if all three pairs are in love (A loves B, B loves C, C loves A).You are given a list of m known relationships in the anime. You know for sure that certain pairs love each other, and certain pairs hate each other. You\'re wondering how many ways you can fill in the remaining relationships so you are happy with every triangle. Two ways are considered different if two characters are in love in one way but hate each other in the other. Print this count modulo 1\xe2\x80\x89000\xe2\x80\x89000\xe2\x80\x89007." 2200

553B "Kyoya and Permutation" "binary search,combinatorics,constructive algorithms,greedy,implementation,math" "Let\'s define the permutation of length n as an array p\xe2\x80\x89=\xe2\x80\x89[p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pn] consisting of n distinct integers from range from 1 to n. We say that this permutation maps value 1 into the value p1, value 2 into the value p2 and so on.Kyota Ootori has just learned about cyclic representation of a permutation. A cycle is a sequence of numbers such that each element of this sequence is being mapped into the next element of this sequence (and the last element of the cycle is being mapped into the first element of the cycle). The cyclic representation is a representation of p as a collection of cycles forming p. For example, permutation p\xe2\x80\x89=\xe2\x80\x89[4,\xe2\x80\x891,\xe2\x80\x896,\xe2\x80\x892,\xe2\x80\x895,\xe2\x80\x893] has a cyclic representation that looks like (142)(36)(5) because 1 is replaced by 4, 4 is replaced by 2, 2 is replaced by 1, 3 and 6 are swapped, and 5 remains in place. Permutation may have several cyclic representations, so Kyoya defines the standard cyclic representation of a permutation as follows. First, reorder the elements within each cycle so the largest element is first. Then, reorder all of the cycles so they are sorted by their first element. For our example above, the standard cyclic representation of [4,\xe2\x80\x891,\xe2\x80\x896,\xe2\x80\x892,\xe2\x80\x895,\xe2\x80\x893] is (421)(5)(63).Now, Kyoya notices that if we drop the parenthesis in the standard cyclic representation, we get another permutation! For instance, [4,\xe2\x80\x891,\xe2\x80\x896,\xe2\x80\x892,\xe2\x80\x895,\xe2\x80\x893] will become [4,\xe2\x80\x892,\xe2\x80\x891,\xe2\x80\x895,\xe2\x80\x896,\xe2\x80\x893].Kyoya notices that some permutations don\'t change after applying operation described above at all. He wrote all permutations of length n that do not change in a list in lexicographic order. Unfortunately, his friend Tamaki Suoh lost this list. Kyoya wishes to reproduce the list and he needs your help. Given the integers n and k, print the permutation that was k-th on Kyoya\'s list." 1900

553A "Kyoya and Colored Balls" combinatorics,dp,math "Kyoya Ootori has a bag with n colored balls that are colored with k different colors. The colors are labeled from 1 to k. Balls of the same color are indistinguishable. He draws balls from the bag one by one until the bag is empty. He noticed that he drew the last ball of color i before drawing the last ball of color i\xe2\x80\x89+\xe2\x80\x891 for all i from 1 to k\xe2\x80\x89-\xe2\x80\x891. Now he wonders how many different ways this can happen." 1500

552E "Vanya and Brackets" "brute force,dp,expression parsing,greedy,implementation,strings" "Vanya is doing his maths homework. He has an expression of form , where x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xn are digits from 1 to 9, and sign  represents either a plus \'+\' or the multiplication sign \'*\'. Vanya needs to add one pair of brackets in this expression so that to maximize the value of the resulting expression." 2100

552D "Vanya and Triangles" "brute force,combinatorics,data structures,geometry,math,sortings" "Vanya got bored and he painted n distinct points on the plane. After that he connected all the points pairwise and saw that as a result many triangles were formed with vertices in the painted points. He asks you to count the number of the formed triangles with the non-zero area." 1900

552C "Vanya and Scales" "brute force,dp,greedy,math,meet-in-the-middle,number theory" "Vanya has a scales for weighing loads and weights of masses w0,\xe2\x80\x89w1,\xe2\x80\x89w2,\xe2\x80\x89...,\xe2\x80\x89w100 grams where w is some integer not less than 2 (exactly one weight of each nominal value). Vanya wonders whether he can weight an item with mass m using the given weights, if the weights can be put on both pans of the scales. Formally speaking, your task is to determine whether it is possible to place an item of mass m and some weights on the left pan of the scales, and some weights on the right pan of the scales so that the pans of the scales were in balance." 1900

552B "Vanya and Books" implementation,math "Vanya got an important task \xe2\x80\x94 he should enumerate books in the library and label each book with its number. Each of the n books should be assigned with a number from 1 to n. Naturally, distinct books should be assigned distinct numbers.Vanya wants to know how many digits he will have to write down as he labels the books." 1200

552A "Vanya and Table" implementation,math "Vanya has a table consisting of 100 rows, each row contains 100 cells. The rows are numbered by integers from 1 to 100 from bottom to top, the columns are numbered from 1 to 100 from left to right. In this table, Vanya chose n rectangles with sides that go along borders of squares (some rectangles probably occur multiple times). After that for each cell of the table he counted the number of rectangles it belongs to and wrote this number into it. Now he wants to find the sum of values in all cells of the table and as the table is too large, he asks you to help him find the result." 1000

551E "GukiZ and GukiZiana" "binary search,data structures,implementation" "Professor GukiZ was playing with arrays again and accidentally discovered new function, which he called GukiZiana. For given array a, indexed with integers from 1 to n, and number y, GukiZiana(a,\xe2\x80\x89y) represents maximum value of j\xe2\x80\x89-\xe2\x80\x89i, such that aj\xe2\x80\x89=\xe2\x80\x89ai\xe2\x80\x89=\xe2\x80\x89y. If there is no y as an element in a, then GukiZiana(a,\xe2\x80\x89y) is equal to \xe2\x80\x89-\xe2\x80\x891. GukiZ also prepared a problem for you. This time, you have two types of queries:   First type has form 1 l r x and asks you to increase values of all ai such that l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r by the non-negative integer x.  Second type has form 2 y and asks you to find value of GukiZiana(a,\xe2\x80\x89y). For each query of type 2, print the answer and make GukiZ happy!" 2500

551D "GukiZ and Binary Operations" "combinatorics,implementation,math,matrices,number theory" "We all know that GukiZ often plays with arrays. Now he is thinking about this problem: how many arrays a, of length n, with non-negative elements strictly less then 2l meet the following condition: ? Here operation  means bitwise AND (in Pascal it is equivalent to and, in C/C++/Java/Python it is equivalent to &), operation  means bitwise OR (in Pascal it is equivalent to , in C/C++/Java/Python it is equivalent to |). Because the answer can be quite large, calculate it modulo m. This time GukiZ hasn\'t come up with solution, and needs you to help him!" 2100

551C "GukiZ hates Boxes" "binary search,greedy" "Professor GukiZ is concerned about making his way to school, because massive piles of boxes are blocking his way. In total there are n piles of boxes, arranged in a line, from left to right, i-th pile (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) containing ai boxes. Luckily, m students are willing to help GukiZ by removing all the boxes from his way. Students are working simultaneously. At time 0, all students are located left of the first pile. It takes one second for every student to move from this position to the first pile, and after that, every student must start performing sequence of two possible operations, each taking one second to complete. Possible operations are: If i\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89n, move from pile i to pile i\xe2\x80\x89+\xe2\x80\x891; If pile located at the position of student is not empty, remove one box from it.GukiZ\'s students aren\'t smart at all, so they need you to tell them how to remove boxes before professor comes (he is very impatient man, and doesn\'t want to wait). They ask you to calculate minumum time t in seconds for which they can remove all the boxes from GukiZ\'s way. Note that students can be positioned in any manner after t seconds, but all the boxes must be removed." 2200

551B ZgukistringZ "brute force,constructive algorithms,implementation,strings" "Professor GukiZ doesn\'t accept string as they are. He likes to swap some letters in string to obtain a new one.GukiZ has strings a, b, and c. He wants to obtain string k by swapping some letters in a, so that k should contain as many non-overlapping substrings equal either to b or c as possible. Substring of string x is a string formed by consecutive segment of characters from x. Two substrings of string x overlap if there is position i in string x occupied by both of them.GukiZ was disappointed because none of his students managed to solve the problem. Can you help them and find one of possible strings k?" 1800

551A "GukiZ and Contest" "brute force,implementation,sortings" "Professor GukiZ likes programming contests. He especially likes to rate his students on the contests he prepares. Now, he has decided to prepare a new contest. In total, n students will attend, and before the start, every one of them has some positive integer rating. Students are indexed from 1 to n. Let\'s denote the rating of i-th student as ai. After the contest ends, every student will end up with some positive integer position. GukiZ expects that his students will take places according to their ratings. He thinks that each student will take place equal to . In particular, if student A has rating strictly lower then student B, A will get the strictly better position than B, and if two students have equal ratings, they will share the same position. GukiZ would like you to reconstruct the results by following his expectations. Help him and determine the position after the end of the contest for each of his students if everything goes as expected." 800

550E "Brackets in Implications" "constructive algorithms,greedy,implementation,math" "Implication is a function of two logical arguments, its value is false if and only if the value of the first argument is true and the value of the second argument is false. Implication is written by using character \'\', and the arguments and the result of the implication are written as \'0\' (false) and \'1\' (true). According to the definition of the implication:   When a logical expression contains multiple implications, then when there are no brackets, it will be calculated from left to fight. For example,. When there are brackets, we first calculate the expression in brackets. For example,.For the given logical expression  determine if it is possible to place there brackets so that the value of a logical expression is false. If it is possible, your task is to find such an arrangement of brackets." 2200

550D "Regular Bridge" "constructive algorithms,graphs,implementation" "An undirected graph is called k-regular, if the degrees of all its vertices are equal k. An edge of a connected graph is called a bridge, if after removing it the graph is being split into two connected components.Build a connected undirected k-regular graph containing at least one bridge, or else state that such graph doesn\'t exist." 1900

550C "Divisibility by Eight" "brute force,dp,math" "You are given a non-negative integer n, its decimal representation consists of at most 100 digits and doesn\'t contain leading zeroes.Your task is to determine if it is possible in this case to remove some of the digits (possibly not remove any digit at all) so that the result contains at least one digit, forms a non-negative integer, doesn\'t have leading zeroes and is divisible by 8. After the removing, it is forbidden to rearrange the digits.If a solution exists, you should print it." 1500

550B "Preparing Olympiad" "bitmasks,brute force" "You have n problems. You have estimated the difficulty of the i-th one as integer ci. Now you want to prepare a problemset for a contest, using some of the problems you\'ve made.A problemset for the contest must consist of at least two problems. You think that the total difficulty of the problems of the contest must be at least l and at most r. Also, you think that the difference between difficulties of the easiest and the hardest of the chosen problems must be at least x.Find the number of ways to choose a problemset for the contest." 1400

550A "Two Substrings" "brute force,dp,greedy,implementation,strings" "You are given string s. Your task is to determine if the given string s contains two non-overlapping substrings ""AB"" and ""BA"" (the substrings can go in any order)." 1500

549H "Degenerate Matrix" "binary search,math" "The determinant of a matrix 2\xe2\x80\x89\xc3\x97\xe2\x80\x892 is defined as follows:A matrix is called degenerate if its determinant is equal to zero. The norm ||A|| of a matrix A is defined as a maximum of absolute values of its elements.You are given a matrix . Consider any degenerate matrix B such that norm ||A\xe2\x80\x89-\xe2\x80\x89B|| is minimum possible. Determine ||A\xe2\x80\x89-\xe2\x80\x89B||." 2100

549G "Happy Line" "constructive algorithms,greedy,sortings" "Do you like summer? Residents of Berland do. They especially love eating ice cream in the hot summer. So this summer day a large queue of n Berland residents lined up in front of the ice cream stall. We know that each of them has a certain amount of berland dollars with them. The residents of Berland are nice people, so each person agrees to swap places with the person right behind him for just 1 dollar. More formally, if person a stands just behind person b, then person a can pay person b 1 dollar, then a and b get swapped. Of course, if person a has zero dollars, he can not swap places with person b.Residents of Berland are strange people. In particular, they get upset when there is someone with a strictly smaller sum of money in the line in front of them.Can you help the residents of Berland form such order in the line so that they were all happy? A happy resident is the one who stands first in the line or the one in front of who another resident stands with not less number of dollars. Note that the people of Berland are people of honor and they agree to swap places only in the manner described above." 2200

549F "Yura and Developers" "data structures,divide and conquer" "Yura has a team of k developers and a list of n tasks numbered from 1 to n. Yura is going to choose some tasks to be done this week. Due to strange Looksery habits the numbers of chosen tasks should be a segment of consecutive integers containing no less than 2 numbers, i. e. a sequence of form l,\xe2\x80\x89l\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89r for some 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89<\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n. Every task i has an integer number ai associated with it denoting how many man-hours are required to complete the i-th task. Developers are not self-confident at all, and they are actually afraid of difficult tasks. Knowing that, Yura decided to pick up a hardest task (the one that takes the biggest number of man-hours to be completed, among several hardest tasks with same difficulty level he chooses arbitrary one) and complete it on his own. So, if tasks with numbers [l,\xe2\x80\x89r] are chosen then the developers are left with r\xe2\x80\x89-\xe2\x80\x89l tasks to be done by themselves. Every developer can spend any integer amount of hours over any task, but when they are done with the whole assignment there should be exactly ai man-hours spent over the i-th task. The last, but not the least problem with developers is that one gets angry if he works more than another developer. A set of tasks [l,\xe2\x80\x89r] is considered good if it is possible to find such a distribution of work that allows to complete all the tasks and to have every developer working for the same amount of time (amount of work performed by Yura doesn\'t matter for other workers as well as for him).For example, let\'s suppose that Yura have chosen tasks with following difficulties: a\xe2\x80\x89=\xe2\x80\x89[1,\xe2\x80\x892,\xe2\x80\x893,\xe2\x80\x894], and he has three developers in his disposal. He takes the hardest fourth task to finish by himself, and the developers are left with tasks with difficulties [1,\xe2\x80\x892,\xe2\x80\x893]. If the first one spends an hour on the first task and an hour on the third one, the second developer spends two hours on the second task and the third developer spends two hours on the third task, then they are done, since every developer worked exactly for two hours and every task has been worked over for the required amount of time. As another example, if the first task required two hours instead of one to be completed then it would be impossible to assign the tasks in a way described above. Besides work, Yura is fond of problem solving. He wonders how many pairs (l,\xe2\x80\x89r) (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89<\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) exists such that a segment [l,\xe2\x80\x89r] is good? Yura has already solved this problem, but he has no time to write the code. Please, help Yura and implement the solution for this problem." 2800

549E "Sasha Circle" geometry,math "Berlanders like to eat cones after a hard day. Misha Square and Sasha Circle are local authorities of Berland. Each of them controls its points of cone trade. Misha has n points, Sasha \xe2\x80\x94 m. Since their subordinates constantly had conflicts with each other, they decided to build a fence in the form of a circle, so that the points of trade of one businessman are strictly inside a circle, and points of the other one are strictly outside. It doesn\'t matter which of the two gentlemen will have his trade points inside the circle.Determine whether they can build a fence or not." 2700

549D "Haar Features" greedy,implementation "The first algorithm for detecting a face on the image working in realtime was developed by Paul Viola and Michael Jones in 2001. A part of the algorithm is a procedure that computes Haar features. As part of this task, we consider a simplified model of this concept.Let\'s consider a rectangular image that is represented with a table of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m. The table elements are integers that specify the brightness of each pixel in the image.A feature also is a rectangular table of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m. Each cell of a feature is painted black or white.To calculate the value of the given feature at the given image, you must perform the following steps. First the table of the feature is put over the table of the image (without rotations or reflections), thus each pixel is entirely covered with either black or white cell. The value of a feature in the image is the value of W\xe2\x80\x89-\xe2\x80\x89B, where W is the total brightness of the pixels in the image, covered with white feature cells, and B is the total brightness of the pixels covered with black feature cells.Some examples of the most popular Haar features are given below.   Your task is to determine the number of operations that are required to calculate the feature by using the so-called prefix rectangles.A prefix rectangle is any rectangle on the image, the upper left corner of which coincides with the upper left corner of the image.You have a variable value, whose value is initially zero. In one operation you can count the sum of pixel values \xe2\x80\x8b\xe2\x80\x8bat any prefix rectangle, multiply it by any integer and add to variable value.You are given a feature. It is necessary to calculate the minimum number of operations required to calculate the values of this attribute at an arbitrary image. For a better understanding of the statement, read the explanation of the first sample." 1900

549C "The Game Of Parity" games "There are n cities in Westeros. The i-th city is inhabited by ai people. Daenerys and Stannis play the following game: in one single move, a player chooses a certain town and burns it to the ground. Thus all its residents, sadly, die. Stannis starts the game. The game ends when Westeros has exactly k cities left.The prophecy says that if the total number of surviving residents is even, then Daenerys wins: Stannis gets beheaded, and Daenerys rises on the Iron Throne. If the total number of surviving residents is odd, Stannis wins and everything goes in the completely opposite way.Lord Petyr Baelish wants to know which candidates to the throne he should support, and therefore he wonders, which one of them has a winning strategy. Answer to this question of Lord Baelish and maybe you will become the next Lord of Harrenholl." 2200

549B "Looksery Party" "constructive algorithms,dfs and similar,graphs,greedy" "The Looksery company, consisting of n staff members, is planning another big party. Every employee has his phone number and the phone numbers of his friends in the phone book. Everyone who comes to the party, sends messages to his contacts about how cool it is. At the same time everyone is trying to spend as much time on the fun as possible, so they send messages to everyone without special thinking, moreover, each person even sends a message to himself or herself.Igor and Max, Looksery developers, started a dispute on how many messages each person gets. Igor indicates n numbers, the i-th of which indicates how many messages, in his view, the i-th employee is going to take. If Igor guesses correctly at least one of these numbers, he wins, otherwise Max wins.You support Max in this debate, so you need, given the contact lists of the employees, to determine whether there is a situation where Igor loses. Specifically, you need to determine which employees should come to the party, and which should not, so after all the visitors send messages to their contacts, each employee received a number of messages that is different from what Igor stated." 2300

549A "Face Detection" implementation,strings "The developers of Looksery have to write an efficient algorithm that detects faces on a picture. Unfortunately, they are currently busy preparing a contest for you, so you will have to do it for them. In this problem an image is a rectangular table that consists of lowercase Latin letters. A face on the image is a 2\xe2\x80\x89\xc3\x97\xe2\x80\x892 square, such that from the four letters of this square you can make word ""face"". You need to write a program that determines the number of faces on the image. The squares that correspond to the faces can overlap." 900

548B "Mike and Fun" "brute force,dp,greedy,implementation" "Mike and some bears are playing a game just for fun. Mike is the judge. All bears except Mike are standing in an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m grid, there\'s exactly one bear in each cell. We denote the bear standing in column number j of row number i by (i,\xe2\x80\x89j). Mike\'s hands are on his ears (since he\'s the judge) and each bear standing in the grid has hands either on his mouth or his eyes.  They play for q rounds. In each round, Mike chooses a bear (i,\xe2\x80\x89j) and tells him to change his state i. e. if his hands are on his mouth, then he\'ll put his hands on his eyes or he\'ll put his hands on his mouth otherwise. After that, Mike wants to know the score of the bears.Score of the bears is the maximum over all rows of number of consecutive bears with hands on their eyes in that row.Since bears are lazy, Mike asked you for help. For each round, tell him the score of these bears after changing the state of a bear selected in that round." 1400

548A "Mike and Fax" "brute force,implementation,strings" "While Mike was walking in the subway, all the stuff in his back-bag dropped on the ground. There were several fax messages among them. He concatenated these strings in some order and now he has string s.  He is not sure if this is his own back-bag or someone else\'s. He remembered that there were exactly k messages in his own bag, each was a palindrome string and all those strings had the same length.He asked you to help him and tell him if he has worn his own back-bag. Check if the given string s is a concatenation of k palindromes of the same length." 1100

547E "Mike and Friends" "data structures,string suffix structures,strings,trees" "What-The-Fatherland is a strange country! All phone numbers there are strings consisting of lowercase English letters. What is double strange that a phone number can be associated with several bears!In that country there is a rock band called CF consisting of n bears (including Mike) numbered from 1 to n.   Phone number of i-th member of CF is si. May 17th is a holiday named Phone Calls day. In the last Phone Calls day, everyone called all the numbers that are substrings of his/her number (one may call some number several times). In particular, everyone called himself (that was really strange country).Denote as call(i,\xe2\x80\x89j) the number of times that i-th member of CF called the j-th member of CF. The geek Mike has q questions that he wants to ask you. In each question he gives you numbers l,\xe2\x80\x89r and k and you should tell him the number" 2800

547D "Mike and Fish" "constructive algorithms,dfs and similar,graphs" "As everyone knows, bears love fish. But Mike is a strange bear; He hates fish! The even more strange thing about him is he has an infinite number of blue and red fish.   He has marked n distinct points in the plane. i-th point is point (xi,\xe2\x80\x89yi). He wants to put exactly one fish in each of these points such that the difference between the number of red fish and the blue fish on each horizontal or vertical line is at most 1.He can\'t find a way to perform that! Please help him." 2600

547C "Mike and Foam" "bitmasks,combinatorics,dp,math,number theory" "Mike is a bartender at Rico\'s bar. At Rico\'s, they put beer glasses in a special shelf. There are n kinds of beer at Rico\'s numbered from 1 to n. i-th kind of beer has ai milliliters of foam on it.  Maxim is Mike\'s boss. Today he told Mike to perform q queries. Initially the shelf is empty. In each request, Maxim gives him a number x. If beer number x is already in the shelf, then Mike should remove it from the shelf, otherwise he should put it in the shelf.After each query, Mike should tell him the score of the shelf. Bears are geeks. So they think that the score of a shelf is the number of pairs (i,\xe2\x80\x89j) of glasses in the shelf such that i\xe2\x80\x89<\xe2\x80\x89j and  where  is the greatest common divisor of numbers a and b.Mike is tired. So he asked you to help him in performing these requests." 2300

547B "Mike and Feet" "binary search,data structures,dp,dsu" "Mike is the president of country What-The-Fatherland. There are n bears living in this country besides Mike. All of them are standing in a line and they are numbered from 1 to n from left to right. i-th bear is exactly ai feet high.   A group of bears is a non-empty contiguous segment of the line. The size of a group is the number of bears in that group. The strength of a group is the minimum height of the bear in that group.Mike is a curious to know for each x such that 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n the maximum strength among all groups of size x." 1900

547A "Mike and Frog" "brute force,greedy,implementation,math" "Mike has a frog and a flower. His frog is named Xaniar and his flower is named Abol. Initially(at time 0), height of Xaniar is h1 and height of Abol is h2. Each second, Mike waters Abol and Xaniar.  So, if height of Xaniar is h1 and height of Abol is h2, after one second height of Xaniar will become  and height of Abol will become  where x1,\xe2\x80\x89y1,\xe2\x80\x89x2 and y2 are some integer numbers and  denotes the remainder of a modulo b.Mike is a competitive programmer fan. He wants to know the minimum time it takes until height of Xania is a1 and height of Abol is a2.Mike has asked you for your help. Calculate the minimum time or say it will never happen." 2200

546E "Soldier and Traveling" flows,graphs,math "In the country there are n cities and m bidirectional roads between them. Each city has an army. Army of the i-th city consists of ai soldiers. Now soldiers roam. After roaming each soldier has to either stay in his city or to go to the one of neighboring cities by at moving along at most one road.Check if is it possible that after roaming there will be exactly bi soldiers in the i-th city." 2100

546D "Soldier and Number Game" "constructive algorithms,dp,math,number theory" "Two soldiers are playing a game. At the beginning first of them chooses a positive integer n and gives it to the second soldier. Then the second one tries to make maximum possible number of rounds. Each round consists of choosing a positive integer x\xe2\x80\x89>\xe2\x80\x891, such that n is divisible by x and replacing n with n\xe2\x80\x89/\xe2\x80\x89x. When n becomes equal to 1 and there is no more possible valid moves the game is over and the score of the second soldier is equal to the number of rounds he performed.To make the game more interesting, first soldier chooses n of form a!\xe2\x80\x89/\xe2\x80\x89b! for some positive integer a and b (a\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89b). Here by k! we denote the factorial of k that is defined as a product of all positive integers not large than k.What is the maximum possible score of the second soldier?" 1700

546C "Soldier and Cards" "brute force,dfs and similar,games" "Two bored soldiers are playing card war. Their card deck consists of exactly n cards, numbered from 1 to n, all values are different. They divide cards between them in some manner, it\'s possible that they have different number of cards. Then they play a ""war""-like card game. The rules are following. On each turn a fight happens. Each of them picks card from the top of his stack and puts on the table. The one whose card value is bigger wins this fight and takes both cards from the table to the bottom of his stack. More precisely, he first takes his opponent\'s card and puts to the bottom of his stack, and then he puts his card to the bottom of his stack. If after some turn one of the player\'s stack becomes empty, he loses and the other one wins. You have to calculate how many fights will happen and who will win the game, or state that game won\'t end." 1400

546B "Soldier and Badges" "brute force,greedy,implementation,sortings" "Colonel has n badges. He wants to give one badge to every of his n soldiers. Each badge has a coolness factor, which shows how much it\'s owner reached. Coolness factor can be increased by one for the cost of one coin. For every pair of soldiers one of them should get a badge with strictly higher factor than the second one. Exact values of their factors aren\'t important, they just need to have distinct factors. Colonel knows, which soldier is supposed to get which badge initially, but there is a problem. Some of badges may have the same factor of coolness. Help him and calculate how much money has to be paid for making all badges have different factors of coolness." 1200

546A "Soldier and Bananas" "brute force,implementation,math" "A soldier wants to buy w bananas in the shop. He has to pay k dollars for the first banana, 2k dollars for the second one and so on (in other words, he has to pay i\xc2\xb7k dollars for the i-th banana). He has n dollars. How many dollars does he have to borrow from his friend soldier to buy w bananas?" 800

545E "Paths and Trees" "graphs,greedy,shortest paths" "Little girl Susie accidentally found her elder brother\'s notebook. She has many things to do, more important than solving problems, but she found this problem too interesting, so she wanted to know its solution and decided to ask you about it. So, the problem statement is as follows.Let\'s assume that we are given a connected weighted undirected graph G\xe2\x80\x89=\xe2\x80\x89(V,\xe2\x80\x89E) (here V is the set of vertices, E is the set of edges). The shortest-path tree from vertex u is such graph G1\xe2\x80\x89=\xe2\x80\x89(V,\xe2\x80\x89E1) that is a tree with the set of edges E1 that is the subset of the set of edges of the initial graph E, and the lengths of the shortest paths from u to any vertex to G and to G1 are the same. You are given a connected weighted undirected graph G and vertex u. Your task is to find the shortest-path tree of the given graph from vertex u, the total weight of whose edges is minimum possible." 2000

545D Queue greedy,implementation,sortings "Little girl Susie went shopping with her mom and she wondered how to improve service quality. There are n people in the queue. For each person we know time ti needed to serve him. A person will be disappointed if the time he waits is more than the time needed to serve him. The time a person waits is the total time when all the people who stand in the queue in front of him are served. Susie thought that if we swap some people in the queue, then we can decrease the number of people who are disappointed. Help Susie find out what is the maximum number of not disappointed people can be achieved by swapping people in the queue." 1300

545C Woodcutters dp,greedy "Little Susie listens to fairy tales before bed every day. Today\'s fairy tale was about wood cutters and the little girl immediately started imagining the choppers cutting wood. She imagined the situation that is described below.There are n trees located along the road at points with coordinates x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xn. Each tree has its height hi. Woodcutters can cut down a tree and fell it to the left or to the right. After that it occupies one of the segments [xi\xe2\x80\x89-\xe2\x80\x89hi,\xe2\x80\x89xi] or [xi;xi\xe2\x80\x89+\xe2\x80\x89hi]. The tree that is not cut down occupies a single point with coordinate xi. Woodcutters can fell a tree if the segment to be occupied by the fallen tree doesn\'t contain any occupied point. The woodcutters want to process as many trees as possible, so Susie wonders, what is the maximum number of trees to fell." 1500

545B "Equidistant String" greedy "Little Susie loves strings. Today she calculates distances between them. As Susie is a small girl after all, her strings contain only digits zero and one. She uses the definition of Hamming distance:We will define the distance between two strings s and t of the same length consisting of digits zero and one as the number of positions i, such that si isn\'t equal to ti. As besides everything else Susie loves symmetry, she wants to find for two strings s and t of length n such string p of length n, that the distance from p to s was equal to the distance from p to t.It\'s time for Susie to go to bed, help her find such string p or state that it is impossible." 1100

545A "Toy Cars" implementation "Little Susie, thanks to her older brother, likes to play with cars. Today she decided to set up a tournament between them. The process of a tournament is described in the next paragraph.There are n toy cars. Each pair collides. The result of a collision can be one of the following: no car turned over, one car turned over, both cars turned over. A car is good if it turned over in no collision. The results of the collisions are determined by an n\xe2\x80\x89\xc3\x97\xe2\x80\x89n matrix \xd0\x90: there is a number on the intersection of the \xd1\x96-th row and j-th column that describes the result of the collision of the \xd1\x96-th and the j-th car:   \xe2\x80\x89-\xe2\x80\x891: if this pair of cars never collided. \xe2\x80\x89-\xe2\x80\x891 occurs only on the main diagonal of the matrix.  0: if no car turned over during the collision.  1: if only the i-th car turned over during the collision.  2: if only the j-th car turned over during the collision.  3: if both cars turned over during the collision. Susie wants to find all the good cars. She quickly determined which cars are good. Can you cope with the task?" 900

544B "Sea and Islands" "constructive algorithms,implementation" "A map of some object is a rectangular field consisting of n rows and n columns. Each cell is initially occupied by the sea but you can cover some some cells of the map with sand so that exactly k islands appear on the map. We will call a set of sand cells to be island if it is possible to get from each of them to each of them by moving only through sand cells and by moving from a cell only to a side-adjacent cell. The cells are called to be side-adjacent if they share a vertical or horizontal side. It is easy to see that islands do not share cells (otherwise they together form a bigger island).Find a way to cover some cells with sand so that exactly k islands appear on the n\xe2\x80\x89\xc3\x97\xe2\x80\x89n map, or determine that no such way exists." 1400

544A "Set of Strings" implementation,strings "You are given a string q. A sequence of k strings s1,\xe2\x80\x89s2,\xe2\x80\x89...,\xe2\x80\x89sk is called beautiful, if the concatenation of these strings is string q (formally, s1\xe2\x80\x89+\xe2\x80\x89s2\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89sk\xe2\x80\x89=\xe2\x80\x89q) and the first characters of these strings are distinct.Find any beautiful sequence of strings or determine that the beautiful sequence doesn\'t exist." 1100

543E "Listening to Music" "constructive algorithms,data structures" "Please note that the memory limit differs from the standard.You really love to listen to music. During the each of next s days you will listen to exactly m songs from the playlist that consists of exactly n songs. Let\'s number the songs from the playlist with numbers from 1 to n, inclusive. The quality of song number i is ai.On the i-th day you choose some integer v (li\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89v\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ri) and listen to songs number v,\xe2\x80\x89v\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89v\xe2\x80\x89+\xe2\x80\x89m\xe2\x80\x89-\xe2\x80\x891. On the i-th day listening to one song with quality less than qi increases your displeasure by exactly one.Determine what minimum displeasure you can get on each of the s next days." 3200

543D "Road Improvement" dp,trees "The country has n cities and n\xe2\x80\x89-\xe2\x80\x891 bidirectional roads, it is possible to get from every city to any other one if you move only along the roads. The cities are numbered with integers from 1 to n inclusive.All the roads are initially bad, but the government wants to improve the state of some roads. We will assume that the citizens are happy about road improvement if the path from the capital located in city x to any other city contains at most one bad road.Your task is \xe2\x80\x94 for every possible x determine the number of ways of improving the quality of some roads in order to meet the citizens\' condition. As those values can be rather large, you need to print each value modulo 1\xe2\x80\x89000\xe2\x80\x89000\xe2\x80\x89007 (109\xe2\x80\x89+\xe2\x80\x897)." 2300

543C "Remembering Strings" bitmasks,dp "You have multiset of n strings of the same length, consisting of lowercase English letters. We will say that those strings are easy to remember if for each string there is some position i and some letter c of the English alphabet, such that this string is the only string in the multiset that has letter c in position i.For example, a multiset of strings {""abc"", ""aba"", ""adc"", ""ada""} are not easy to remember. And multiset {""abc"", ""ada"", ""ssa""} is easy to remember because:   the first string is the only string that has character c in position 3;  the second string is the only string that has character d in position 2;  the third string is the only string that has character s in position 2. You want to change your multiset a little so that it is easy to remember. For aij coins, you can change character in the j-th position of the i-th string into any other lowercase letter of the English alphabet. Find what is the minimum sum you should pay in order to make the multiset of strings easy to remember." 2500

543B "Destroying Roads" "constructive algorithms,graphs,shortest paths" "In some country there are exactly n cities and m bidirectional roads connecting the cities. Cities are numbered with integers from 1 to n. If cities a and b are connected by a road, then in an hour you can go along this road either from city a to city b, or from city b to city a. The road network is such that from any city you can get to any other one by moving along the roads.You want to destroy the largest possible number of roads in the country so that the remaining roads would allow you to get from city s1 to city t1 in at most l1 hours and get from city s2 to city t2 in at most l2 hours.Determine what maximum number of roads you need to destroy in order to meet the condition of your plan. If it is impossible to reach the desired result, print -1." 2100

543A "Writing Code" dp "Programmers working on a large project have just received a task to write exactly m lines of code. There are n programmers working on a project, the i-th of them makes exactly ai bugs in every line of code that he writes. Let\'s call a sequence of non-negative integers v1,\xe2\x80\x89v2,\xe2\x80\x89...,\xe2\x80\x89vn a plan, if v1\xe2\x80\x89+\xe2\x80\x89v2\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89vn\xe2\x80\x89=\xe2\x80\x89m. The programmers follow the plan like that: in the beginning the first programmer writes the first v1 lines of the given task, then the second programmer writes v2 more lines of the given task, and so on. In the end, the last programmer writes the remaining lines of the code. Let\'s call a plan good, if all the written lines of the task contain at most b bugs in total.Your task is to determine how many distinct good plans are there. As the number of plans can be large, print the remainder of this number modulo given positive integer mod." 1800

542F Quest dp,greedy "Polycarp is making a quest for his friends. He has already made n tasks, for each task the boy evaluated how interesting it is as an integer qi, and the time ti in minutes needed to complete the task. An interesting feature of his quest is: each participant should get the task that is best suited for him, depending on his preferences. The task is chosen based on an interactive quiz that consists of some questions. The player should answer these questions with ""yes"" or ""no"". Depending on the answer to the question, the participant either moves to another question or goes to one of the tasks that are in the quest. In other words, the quest is a binary tree, its nodes contain questions and its leaves contain tasks. We know that answering any of the questions that are asked before getting a task takes exactly one minute from the quest player. Polycarp knows that his friends are busy people and they can\'t participate in the quest for more than T minutes. Polycarp wants to choose some of the n tasks he made, invent the corresponding set of questions for them and use them to form an interactive quiz as a binary tree so that no matter how the player answers quiz questions, he spends at most T minutes on completing the whole quest (that is, answering all the questions and completing the task). Specifically, the quest can contain zero questions and go straight to the task. Each task can only be used once (i.e., the people who give different answers to questions should get different tasks).Polycarp wants the total ""interest"" value of the tasks involved in the quest to be as large as possible. Help him determine the maximum possible total interest value of the task considering that the quest should be completed in T minutes at any variant of answering questions." 2100

542E "Playing on Graph" "graphs,shortest paths" "Vova and Marina love offering puzzles to each other. Today Marina offered Vova to cope with the following task.Vova has a non-directed graph consisting of n vertices and m edges without loops and multiple edges. Let\'s define the operation of contraction two vertices a and b that are not connected by an edge. As a result of this operation vertices a and b are deleted and instead of them a new vertex x is added into the graph, and also edges are drawn from it to all vertices that were connected with a or with b (specifically, if the vertex was connected with both a and b, then also exactly one edge is added from x to it). Thus, as a result of contraction again a non-directed graph is formed, it contains no loops nor multiple edges, and it contains (n\xe2\x80\x89-\xe2\x80\x891) vertices.Vova must perform the contraction an arbitrary number of times to transform the given graph into a chain of the maximum length. A chain of length k (k\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x890) is a connected graph whose vertices can be numbered with integers from 1 to k\xe2\x80\x89+\xe2\x80\x891 so that the edges of the graph connect all pairs of vertices (i,\xe2\x80\x89i\xe2\x80\x89+\xe2\x80\x891) (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k) and only them. Specifically, the graph that consists of one vertex is a chain of length 0. The vertices that are formed as a result of the contraction are allowed to be used in the following operations of contraction.  The picture illustrates the contraction of two vertices marked by red. Help Vova cope with his girlfriend\'s task. Find the maximum length of the chain that can be obtained from the resulting graph or else determine that it is impossible to obtain the chain." 2600

542D "Superhero\'s Job" "dfs and similar,dp,hashing,math,number theory" "Vova and Marina love offering puzzles to each other. Today Marina offered Vova to cope with the following task.Vova has a non-directed graph consisting of n vertices and m edges without loops and multiple edges. Let\'s define the operation of contraction two vertices a and b that are not connected by an edge. As a result of this operation vertices a and b are deleted and instead of them a new vertex x is added into the graph, and also edges are drawn from it to all vertices that were connected with a or with b (specifically, if the vertex was connected with both a and b, then also exactly one edge is added from x to it). Thus, as a result of contraction again a non-directed graph is formed, it contains no loops nor multiple edges, and it contains (n\xe2\x80\x89-\xe2\x80\x891) vertices.Vova must perform the contraction an arbitrary number of times to transform the given graph into a chain of the maximum length. A chain of length k (k\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x890) is a connected graph whose vertices can be numbered with integers from 1 to k\xe2\x80\x89+\xe2\x80\x891 so that the edges of the graph connect all pairs of vertices (i,\xe2\x80\x89i\xe2\x80\x89+\xe2\x80\x891) (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k) and only them. Specifically, the graph that consists of one vertex is a chain of length 0. The vertices that are formed as a result of the contraction are allowed to be used in the following operations of contraction.  The picture illustrates the contraction of two vertices marked by red. Help Vova cope with his girlfriend\'s task. Find the maximum length of the chain that can be obtained from the resulting graph or else determine that it is impossible to obtain the chain." 2600

542C "Idempotent functions" "constructive algorithms,graphs,math" "Some time ago Leonid have known about idempotent functions. Idempotent function defined on a set {1,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89n} is such function , that for any  the formula g(g(x))\xe2\x80\x89=\xe2\x80\x89g(x) holds.Let\'s denote as f(k)(x) the function f applied k times to the value x. More formally, f(1)(x)\xe2\x80\x89=\xe2\x80\x89f(x), f(k)(x)\xe2\x80\x89=\xe2\x80\x89f(f(k\xe2\x80\x89-\xe2\x80\x891)(x)) for each k\xe2\x80\x89>\xe2\x80\x891.You are given some function . Your task is to find minimum positive integer k such that function f(k)(x) is idempotent." 2000

542B "Duck Hunt" "data structures" "A duck hunter is doing his favorite thing, hunting. He lives in a two dimensional world and is located at point (0,\xe2\x80\x890). As he doesn\'t like walking for his prey, he prefers to shoot only vertically up (because in this case, the ducks fall straight into his hands). The hunter doesn\'t reload the gun immediately \xe2\x80\x94 r or more seconds must pass between the shots. When the hunter shoots up, the bullet immediately hits all the ducks who are directly above the hunter.In a two dimensional world each duck is a horizontal segment that moves horizontally in the negative direction of the Ox axis at the speed 1 length unit per second. For each duck we know the values hi and ti \xe2\x80\x94 the x-coordinates of its head (the left end of the segment) and its tail (the right end of the segment) at time 0. The height where the duck is flying isn\'t important as the gun shoots vertically up to the infinite height and hits all the ducks on its way.   The figure to the first sample. What maximum number of ducks can the hunter shoot? The duck is considered shot by the hunter if at the moment of the shot at least one of its point intersects the Oy axis. After the hunter shoots the duck, it falls and it can\'t be shot anymore. The hunter cannot make shots before the moment of time 0." 3100

542A "Place Your Ad Here" "data structures,sortings" "Ivan Anatolyevich\'s agency is starting to become famous in the town. They have already ordered and made n TV commercial videos. Each video is made in a special way: the colors and the soundtrack are adjusted to the time of the day and the viewers\' mood. That\'s why the i-th video can only be shown within the time range of [li,\xe2\x80\x89ri] (it is not necessary to use the whole segment but the broadcast time should be within this segment).Now it\'s time to choose a TV channel to broadcast the commercial. Overall, there are m TV channels broadcasting in the city, the j-th one has cj viewers, and is ready to sell time [aj,\xe2\x80\x89bj] to broadcast the commercial.Ivan Anatolyevich is facing a hard choice: he has to choose exactly one video i and exactly one TV channel j to broadcast this video and also a time range to broadcast [x,\xe2\x80\x89y]. At that the time range should be chosen so that it is both within range [li,\xe2\x80\x89ri] and within range [aj,\xe2\x80\x89bj].Let\'s define the efficiency of the broadcast as value (y\xe2\x80\x89-\xe2\x80\x89x)\xc2\xb7cj \xe2\x80\x94 the total sum of time that all the viewers of the TV channel are going to spend watching the commercial. Help Ivan Anatolyevich choose the broadcast with the maximum efficiency!" 2400

540E "Infinite Inversions" "binary search,data structures,implementation,sortings,trees" "There is an infinite sequence consisting of all positive integers in the increasing order: p\xe2\x80\x89=\xe2\x80\x89{1,\xe2\x80\x892,\xe2\x80\x893,\xe2\x80\x89...}. We performed n swap operations with this sequence. A swap(a,\xe2\x80\x89b) is an operation of swapping the elements of the sequence on positions a and b. Your task is to find the number of inversions in the resulting sequence, i.e. the number of such index pairs (i,\xe2\x80\x89j), that i\xe2\x80\x89<\xe2\x80\x89j and pi\xe2\x80\x89>\xe2\x80\x89pj." 2100

540D "Bad Luck Island" dp,probabilities "The Bad Luck Island is inhabited by three kinds of species: r rocks, s scissors and p papers. At some moments of time two random individuals meet (all pairs of individuals can meet equiprobably), and if they belong to different species, then one individual kills the other one: a rock kills scissors, scissors kill paper, and paper kills a rock. Your task is to determine for each species what is the probability that this species will be the only one to inhabit this island after a long enough period of time." 1900

540C "Ice Cave" "dfs and similar" "You play a computer game. Your character stands on some level of a multilevel ice cave. In order to move on forward, you need to descend one level lower and the only way to do this is to fall through the ice.The level of the cave where you are is a rectangular square grid of n rows and m columns. Each cell consists either from intact or from cracked ice. From each cell you can move to cells that are side-adjacent with yours (due to some limitations of the game engine you cannot make jumps on the same place, i.e. jump from a cell to itself). If you move to the cell with cracked ice, then your character falls down through it and if you move to the cell with intact ice, then the ice on this cell becomes cracked.Let\'s number the rows with integers from 1 to n from top to bottom and the columns with integers from 1 to m from left to right. Let\'s denote a cell on the intersection of the r-th row and the c-th column as (r,\xe2\x80\x89c). You are staying in the cell (r1,\xe2\x80\x89c1) and this cell is cracked because you\'ve just fallen here from a higher level. You need to fall down through the cell (r2,\xe2\x80\x89c2) since the exit to the next level is there. Can you do this?" 2000

540B "School Marks" greedy,implementation "Little Vova studies programming in an elite school. Vova and his classmates are supposed to write n progress tests, for each test they will get a mark from 1 to p. Vova is very smart and he can write every test for any mark, but he doesn\'t want to stand out from the crowd too much. If the sum of his marks for all tests exceeds value x, then his classmates notice how smart he is and start distracting him asking to let them copy his homework. And if the median of his marks will be lower than y points (the definition of a median is given in the notes), then his mom will decide that he gets too many bad marks and forbid him to play computer games.Vova has already wrote k tests and got marks a1,\xe2\x80\x89...,\xe2\x80\x89ak. He doesn\'t want to get into the first or the second situation described above and now he needs to determine which marks he needs to get for the remaining tests. Help him do that." 1700

540A "Combination Lock" implementation "Scrooge McDuck keeps his most treasured savings in a home safe with a combination lock. Each time he wants to put there the treasures that he\'s earned fair and square, he has to open the lock.  The combination lock is represented by n rotating disks with digits from 0 to 9 written on them. Scrooge McDuck has to turn some disks so that the combination of digits on the disks forms a secret combination. In one move, he can rotate one disk one digit forwards or backwards. In particular, in one move he can go from digit 0 to digit 9 and vice versa. What minimum number of actions does he need for that?" 800

538H "Summer Dichotomy" "2-sat,data structures,dfs and similar,greedy" "T students applied into the ZPP class of Summer Irrelevant School. The organizing committee of the school may enroll any number of them, but at least t students must be enrolled. The enrolled students should be divided into two groups in any manner (it is possible that one of the groups will be empty!)During a shift the students from the ZPP grade are tutored by n teachers. Due to the nature of the educational process, each of the teachers should be assigned to exactly one of two groups (it is possible that no teacher will be assigned to some of the groups!). The i-th teacher is willing to work in a group as long as the group will have at least li and at most ri students (otherwise it would be either too boring or too hard). Besides, some pairs of the teachers don\'t like each other other and therefore can not work in the same group; in total there are m pairs of conflicting teachers.You, as the head teacher of Summer Irrelevant School, have got a difficult task: to determine how many students to enroll in each of the groups and in which group each teacher will teach." 3200

538G "Berserk Robot" "constructive algorithms,math,sortings" "Help! A robot escaped our lab and we need help finding it. The lab is at the point (0,\xe2\x80\x890) of the coordinate plane, at time 0 the robot was there. The robot\'s movements are defined by a program�\xe2\x80\x94 a string of length l, consisting of characters U, L, D, R. Each second the robot executes the next command in his program: if the current coordinates of the robot are (x,\xe2\x80\x89y), then commands U, L, D, R move it to cells (x,\xe2\x80\x89y\xe2\x80\x89+\xe2\x80\x891), (x\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89y), (x,\xe2\x80\x89y\xe2\x80\x89-\xe2\x80\x891), (x\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89y) respectively. The execution of the program started at time 0. The program is looped, i.e. each l seconds of executing the program start again from the first character. Unfortunately, we don\'t know what program was loaded into the robot when he left the lab.Our radars managed to find out the position of the robot at n moments of time: we know that at the moment of time ti the robot is at the point (xi,\xe2\x80\x89yi). Given this data, either help to determine what program could be loaded into the robot, or determine that no possible program meets the data and the robot must have broken down." 3100

538F "A Heap of Heaps" "brute force,data structures,math,sortings" "Andrew skipped lessons on the subject \'Algorithms and Data Structures\' for the entire term. When he came to the final test, the teacher decided to give him a difficult task as a punishment.The teacher gave Andrew an array of n numbers a1, ..., an. After that he asked Andrew for each k from 1 to n\xe2\x80\x89-\xe2\x80\x891 to build a k-ary heap on the array and count the number of elements for which the property of the minimum-rooted heap is violated, i.e. the value of an element is less than the value of its parent.Andrew looked up on the Wikipedia that a k-ary heap is a rooted tree with vertices in elements of the array. If the elements of the array are indexed from 1 to n, then the children of element v are elements with indices k(v\xe2\x80\x89-\xe2\x80\x891)\xe2\x80\x89+\xe2\x80\x892, ..., kv\xe2\x80\x89+\xe2\x80\x891 (if some of these elements lie outside the borders of the array, the corresponding children are absent). In any k-ary heap every element except for the first one has exactly one parent; for the element 1 the parent is absent (this element is the root of the heap). Denote p(v) as the number of the parent of the element with the number v. Let\'s say that for a non-root element v the property of the heap is violated if av\xe2\x80\x89<\xe2\x80\x89ap(v).Help Andrew cope with the task!" 2200

538E "Demiurges Play Again" "dfs and similar,dp,math,trees" "Demiurges Shambambukli and Mazukta love to watch the games of ordinary people. Today, they noticed two men who play the following game.There is a rooted tree on n nodes, m of which are leaves (a leaf is a nodes that does not have any children), edges of the tree are directed from parent to children. In the leaves of the tree integers from 1 to m are placed in such a way that each number appears exactly in one leaf.Initially, the root of the tree contains a piece. Two players move this piece in turns, during a move a player moves the piece from its current nodes to one of its children; if the player can not make a move, the game ends immediately. The result of the game is the number placed in the leaf where a piece has completed its movement. The player who makes the first move tries to maximize the result of the game and the second player, on the contrary, tries to minimize the result. We can assume that both players move optimally well.Demiurges are omnipotent, so before the game they can arbitrarily rearrange the numbers placed in the leaves. Shambambukli wants to rearrange numbers so that the result of the game when both players play optimally well is as large as possible, and Mazukta wants the result to be as small as possible. What will be the outcome of the game, if the numbers are rearranged by Shambambukli, and what will it be if the numbers are rearranged by Mazukta? Of course, the Demiurges choose the best possible option of arranging numbers." 2200

538D "Weird Chess" "brute force,constructive algorithms,implementation" "Igor has been into chess for a long time and now he is sick of the game by the ordinary rules. He is going to think of new rules of the game and become world famous.Igor\'s chessboard is a square of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89n cells. Igor decided that simple rules guarantee success, that\'s why his game will have only one type of pieces. Besides, all pieces in his game are of the same color. The possible moves of a piece are described by a set of shift vectors. The next passage contains a formal description of available moves.Let the rows of the board be numbered from top to bottom and the columns be numbered from left to right from 1 to n. Let\'s assign to each square a pair of integers (x,\xe2\x80\x89y)�\xe2\x80\x94 the number of the corresponding column and row. Each of the possible moves of the piece is defined by a pair of integers (dx,\xe2\x80\x89dy); using this move, the piece moves from the field (x,\xe2\x80\x89y) to the field (x\xe2\x80\x89+\xe2\x80\x89dx,\xe2\x80\x89y\xe2\x80\x89+\xe2\x80\x89dy). You can perform the move if the cell (x\xe2\x80\x89+\xe2\x80\x89dx,\xe2\x80\x89y\xe2\x80\x89+\xe2\x80\x89dy) is within the boundaries of the board and doesn\'t contain another piece. Pieces that stand on the cells other than (x,\xe2\x80\x89y) and (x\xe2\x80\x89+\xe2\x80\x89dx,\xe2\x80\x89y\xe2\x80\x89+\xe2\x80\x89dy) are not important when considering the possibility of making the given move (for example, like when a knight moves in usual chess).Igor offers you to find out what moves his chess piece can make. He placed several pieces on the board and for each unoccupied square he told you whether it is attacked by any present piece (i.e. whether some of the pieces on the field can move to that cell). Restore a possible set of shift vectors of the piece, or else determine that Igor has made a mistake and such situation is impossible for any set of shift vectors." 1800

538C "Tourist\'s Notes" "binary search,brute force,greedy,implementation,math" "Igor has been into chess for a long time and now he is sick of the game by the ordinary rules. He is going to think of new rules of the game and become world famous.Igor\'s chessboard is a square of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89n cells. Igor decided that simple rules guarantee success, that\'s why his game will have only one type of pieces. Besides, all pieces in his game are of the same color. The possible moves of a piece are described by a set of shift vectors. The next passage contains a formal description of available moves.Let the rows of the board be numbered from top to bottom and the columns be numbered from left to right from 1 to n. Let\'s assign to each square a pair of integers (x,\xe2\x80\x89y)�\xe2\x80\x94 the number of the corresponding column and row. Each of the possible moves of the piece is defined by a pair of integers (dx,\xe2\x80\x89dy); using this move, the piece moves from the field (x,\xe2\x80\x89y) to the field (x\xe2\x80\x89+\xe2\x80\x89dx,\xe2\x80\x89y\xe2\x80\x89+\xe2\x80\x89dy). You can perform the move if the cell (x\xe2\x80\x89+\xe2\x80\x89dx,\xe2\x80\x89y\xe2\x80\x89+\xe2\x80\x89dy) is within the boundaries of the board and doesn\'t contain another piece. Pieces that stand on the cells other than (x,\xe2\x80\x89y) and (x\xe2\x80\x89+\xe2\x80\x89dx,\xe2\x80\x89y\xe2\x80\x89+\xe2\x80\x89dy) are not important when considering the possibility of making the given move (for example, like when a knight moves in usual chess).Igor offers you to find out what moves his chess piece can make. He placed several pieces on the board and for each unoccupied square he told you whether it is attacked by any present piece (i.e. whether some of the pieces on the field can move to that cell). Restore a possible set of shift vectors of the piece, or else determine that Igor has made a mistake and such situation is impossible for any set of shift vectors." 1600

538B "Quasi Binary" "constructive algorithms,dp,greedy,implementation" "A number is called quasibinary if its decimal representation contains only digits 0 or 1. For example, numbers 0, 1, 101, 110011�\xe2\x80\x94 are quasibinary and numbers 2, 12, 900 are not.You are given a positive integer n. Represent it as a sum of minimum number of quasibinary numbers." 1400

538A "Cutting Banner" "brute force,implementation" "A large banner with word CODEFORCES was ordered for the 1000-th onsite round of Codeforces\xcf\x89 that takes place on the Miami beach. Unfortunately, the company that made the banner mixed up two orders and delivered somebody else\'s banner that contains someone else\'s word. The word on the banner consists only of upper-case English letters.There is very little time to correct the mistake. All that we can manage to do is to cut out some substring from the banner, i.e. several consecutive letters. After that all the resulting parts of the banner will be glued into a single piece (if the beginning or the end of the original banner was cut out, only one part remains); it is not allowed change the relative order of parts of the banner (i.e. after a substring is cut, several first and last letters are left, it is allowed only to glue the last letters to the right of the first letters). Thus, for example, for example, you can cut a substring out from string \'TEMPLATE\' and get string \'TEMPLE\' (if you cut out string AT), \'PLATE\' (if you cut out TEM), \'T\' (if you cut out EMPLATE), etc.Help the organizers of the round determine whether it is possible to cut out of the banner some substring in such a way that the remaining parts formed word CODEFORCES." 1400

536E "Tavas on the Path" "data structures,divide and conquer,trees" "Tavas lives in Tavaspolis. Tavaspolis has n cities numbered from 1 to n connected by n\xe2\x80\x89-\xe2\x80\x891 bidirectional roads. There exists a path between any two cities. Also each road has a length.  Tavas\' favorite strings are binary strings (they contain only 0 and 1). For any binary string like s\xe2\x80\x89=\xe2\x80\x89s1s2... sk, T(s) is its Goodness. T(s) can be calculated as follows:Consider there are exactly m blocks of 1s in this string (a block of 1s in s is a maximal consecutive substring of s that only contains 1) with lengths x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xm.Define  where f is a given sequence (if m\xe2\x80\x89=\xe2\x80\x890, then T(s)\xe2\x80\x89=\xe2\x80\x890).Tavas loves queries. He asks you to answer q queries. In each query he gives you numbers v,\xe2\x80\x89u,\xe2\x80\x89l and you should print following number:Consider the roads on the path from city v to city u: e1,\xe2\x80\x89e2,\xe2\x80\x89...,\xe2\x80\x89ex.Build the binary string b of length x such that: bi\xe2\x80\x89=\xe2\x80\x891 if and only if l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89w(ei) where w(e) is the length of road e.You should print T(b) for this query." 3100

536D "Tavas in Kansas" dp,games "Tavas lives in Kansas. Kansas has n cities numbered from 1 to n connected with m bidirectional roads. We can travel from any city to any other city via these roads. Kansas is as strange as Tavas. So there may be a road between a city and itself or more than one road between two cities.Tavas invented a game and called it ""Dashti"". He wants to play Dashti with his girlfriends, Nafas.In this game, they assign an arbitrary integer value to each city of Kansas. The value of i-th city equals to pi.During the game, Tavas is in city s and Nafas is in city t. They play in turn and Tavas goes first. A player in his/her turn, must choose a non-negative integer x and his/her score increases by the sum of values of all cities with (shortest) distance no more than x from his/her city. Each city may be used once, or in the other words, after first time a player gets score from a city, city score becomes zero.There is an additional rule: the player must choose x such that he/she gets the point of at least one city that was not used before. Note that city may initially have value 0, such city isn\'t considered as been used at the beginning of the game, i. e. each player may use it to fullfill this rule.The game ends when nobody can make a move.A player\'s score is the sum of the points he/she earned during the game. The winner is the player with greater score, or there is a draw if players score the same value. Both players start game with zero points.  If Tavas wins, he\'ll break his girlfriend\'s heart, and if Nafas wins, Tavas will cry. But if their scores are equal, they\'ll be happy and Tavas will give Nafas flowers.They\'re not too emotional after all, so they\'ll play optimally. Your task is to tell Tavas what\'s going to happen after the game ends." 2900

535E "Tavas and Pashmaks" geometry,math "Tavas is a cheerleader in the new sports competition named ""Pashmaks"".  This competition consists of two part: swimming and then running. People will immediately start running R meters after they finished swimming exactly S meters. A winner is a such person that nobody else finishes running before him/her (there may be more than one winner).Before the match starts, Tavas knows that there are n competitors registered for the match. Also, he knows that i-th person\'s swimming speed is si meters per second and his/her running speed is ri meters per second. Unfortunately, he doesn\'t know the values of R and S, but he knows that they are real numbers greater than 0.As a cheerleader, Tavas wants to know who to cheer up. So, he wants to know all people that might win. We consider a competitor might win if and only if there are some values of R and S such that with these values, (s)he will be a winner.Tavas isn\'t really familiar with programming, so he asked you to help him." 2600

535D "Tavas and Malekas" "greedy,hashing,string suffix structures,strings" "Tavas is a strange creature. Usually ""zzz"" comes out of people\'s mouth while sleeping, but string s of length n comes out from Tavas\' mouth instead.  Today Tavas fell asleep in Malekas\' place. While he was sleeping, Malekas did a little process on s. Malekas has a favorite string p. He determined all positions x1\xe2\x80\x89<\xe2\x80\x89x2\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89xk where p matches s. More formally, for each xi (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k) he condition sxisxi\xe2\x80\x89+\xe2\x80\x891... sxi\xe2\x80\x89+\xe2\x80\x89|p|\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89=\xe2\x80\x89p is fullfilled.Then Malekas wrote down one of subsequences of x1,\xe2\x80\x89x2,\xe2\x80\x89... xk (possibly, he didn\'t write anything) on a piece of paper. Here a sequence b is a subsequence of sequence a if and only if we can turn a into b by removing some of its elements (maybe no one of them or all).After Tavas woke up, Malekas told him everything. He couldn\'t remember string s, but he knew that both p and s only contains lowercase English letters and also he had the subsequence he had written on that piece of paper.Tavas wonders, what is the number of possible values of s? He asked SaDDas, but he wasn\'t smart enough to solve this. So, Tavas asked you to calculate this number for him.Answer can be very large, so Tavas wants you to print the answer modulo 109\xe2\x80\x89+\xe2\x80\x897." 1900

535C "Tavas and Karafs" "binary search,greedy,math" "Karafs is some kind of vegetable in shape of an 1\xe2\x80\x89\xc3\x97\xe2\x80\x89h rectangle. Tavaspolis people love Karafs and they use Karafs in almost any kind of food. Tavas, himself, is crazy about Karafs.  Each Karafs has a positive integer height. Tavas has an infinite 1-based sequence of Karafses. The height of the i-th Karafs is si\xe2\x80\x89=\xe2\x80\x89A\xe2\x80\x89+\xe2\x80\x89(i\xe2\x80\x89-\xe2\x80\x891)\xe2\x80\x89\xc3\x97\xe2\x80\x89B.For a given m, let\'s define an m-bite operation as decreasing the height of at most m distinct not eaten Karafses by 1. Karafs is considered as eaten when its height becomes zero.Now SaDDas asks you n queries. In each query he gives you numbers l, t and m and you should find the largest number r such that l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r and sequence sl,\xe2\x80\x89sl\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89sr can be eaten by performing m-bite no more than t times or print -1 if there is no such number r." 1900

535B "Tavas and SaDDas" "bitmasks,brute force,combinatorics,implementation" "Once again Tavas started eating coffee mix without water! Keione told him that it smells awful, but he didn\'t stop doing that. That\'s why Keione told his smart friend, SaDDas to punish him! SaDDas took Tavas\' headphones and told him: ""If you solve the following problem, I\'ll return it to you.""  The problem is: You are given a lucky number n. Lucky numbers are the positive integers whose decimal representations contain only the lucky digits 4 and 7. For example, numbers 47, 744, 4 are lucky and 5, 17, 467 are not.If we sort all lucky numbers in increasing order, what\'s the 1-based index of n? Tavas is not as smart as SaDDas, so he asked you to do him a favor and solve this problem so he can have his headphones back." 1100

535A "Tavas and Nafas" "brute force,implementation" "Today Tavas got his test result as an integer score and he wants to share it with his girlfriend, Nafas.His phone operating system is Tavdroid, and its keyboard doesn\'t have any digits! He wants to share his score with Nafas via text, so he has no choice but to send this number using words.  He ate coffee mix without water again, so right now he\'s really messed up and can\'t think.Your task is to help him by telling him what to type." 1000

534F "Simplified Nonogram" bitmasks,dp,hashing,meet-in-the-middle "In this task you have to write a program dealing with nonograms on fields no larger than 5\xe2\x80\x89\xc3\x97\xe2\x80\x8920.Simplified nonogram is a task where you have to build such field (each cell is either white or black) that satisfies the given information about rows and columns. For each row and each column the number of contiguous black segments is specified. For example if size of the field is n\xe2\x80\x89=\xe2\x80\x893,\xe2\x80\x89m\xe2\x80\x89=\xe2\x80\x895, \xd0\xb0nd numbers of contiguous black segments in rows are: [2,\xe2\x80\x893,\xe2\x80\x892] and in columns are: [1,\xe2\x80\x890,\xe2\x80\x891,\xe2\x80\x892,\xe2\x80\x891] then the solution may look like:  It is guaranteed that on each test in the testset there exists at least one solution." 2400

534E "Berland Local Positioning System" "constructive algorithms,greedy,hashing,implementation" "In Berland a bus travels along the main street of the capital. The street begins from the main square and looks like a very long segment. There are n bus stops located along the street, the i-th of them is located at the distance ai from the central square, all distances are distinct, the stops are numbered in the order of increasing distance from the square, that is, ai\xe2\x80\x89<\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x891 for all i from 1 to n\xe2\x80\x89-\xe2\x80\x891. The bus starts its journey from the first stop, it passes stops 2, 3 and so on. It reaches the stop number n, turns around and goes in the opposite direction to stop 1, passing all the intermediate stops in the reverse order. After that, it again starts to move towards stop n. During the day, the bus runs non-stop on this route.The bus is equipped with the Berland local positioning system. When the bus passes a stop, the system notes down its number.One of the key features of the system is that it can respond to the queries about the distance covered by the bus for the parts of its path between some pair of stops. A special module of the system takes the input with the information about a set of stops on a segment of the path, a stop number occurs in the set as many times as the bus drove past it. This module returns the length of the traveled segment of the path (or -1 if it is impossible to determine the length uniquely). The operation of the module is complicated by the fact that stop numbers occur in the request not in the order they were visited but in the non-decreasing order.For example, if the number of stops is 6, and the part of the bus path starts at the bus stop number 5, ends at the stop number 3 and passes the stops as follows: , then the request about this segment of the path will have form: 3,\xe2\x80\x894,\xe2\x80\x895,\xe2\x80\x895,\xe2\x80\x896. If the bus on the segment of the path from stop 5 to stop 3 has time to drive past the 1-th stop (i.e., if we consider a segment that ends with the second visit to stop 3 on the way from 5), then the request will have form: 1,\xe2\x80\x892,\xe2\x80\x892,\xe2\x80\x893,\xe2\x80\x893,\xe2\x80\x894,\xe2\x80\x895,\xe2\x80\x895,\xe2\x80\x896.You will have to repeat the Berland programmers achievement and implement this function." 2400

534D Handshakes "binary search,constructive algorithms,data structures,greedy" "On February, 30th n students came in the Center for Training Olympiad Programmers (CTOP) of the Berland State University. They came one by one, one after another. Each of them went in, and before sitting down at his desk, greeted with those who were present in the room by shaking hands. Each of the students who came in stayed in CTOP until the end of the day and never left.At any time any three students could join together and start participating in a team contest, which lasted until the end of the day. The team did not distract from the contest for a minute, so when another student came in and greeted those who were present, he did not shake hands with the members of the contest writing team. Each team consisted of exactly three students, and each student could not become a member of more than one team. Different teams could start writing contest at different times.Given how many present people shook the hands of each student, get a possible order in which the students could have come to CTOP. If such an order does not exist, then print that this is impossible.Please note that some students could work independently until the end of the day, without participating in a team contest." 1900

534C "Polycarpus\' Dice" math "On February, 30th n students came in the Center for Training Olympiad Programmers (CTOP) of the Berland State University. They came one by one, one after another. Each of them went in, and before sitting down at his desk, greeted with those who were present in the room by shaking hands. Each of the students who came in stayed in CTOP until the end of the day and never left.At any time any three students could join together and start participating in a team contest, which lasted until the end of the day. The team did not distract from the contest for a minute, so when another student came in and greeted those who were present, he did not shake hands with the members of the contest writing team. Each team consisted of exactly three students, and each student could not become a member of more than one team. Different teams could start writing contest at different times.Given how many present people shook the hands of each student, get a possible order in which the students could have come to CTOP. If such an order does not exist, then print that this is impossible.Please note that some students could work independently until the end of the day, without participating in a team contest." 1600

534B "Covered Path" dp,greedy,math "The on-board computer on Polycarp\'s car measured that the car speed at the beginning of some section of the path equals v1 meters per second, and in the end it is v2 meters per second. We know that this section of the route took exactly t seconds to pass.Assuming that at each of the seconds the speed is constant, and between seconds the speed can change at most by d meters per second in absolute value (i.e., the difference in the speed of any two adjacent seconds does not exceed d in absolute value), find the maximum possible length of the path section in meters." 1400

534A Exam "constructive algorithms,implementation,math" "An exam for n students will take place in a long and narrow room, so the students will sit in a line in some order. The teacher suspects that students with adjacent numbers (i and i\xe2\x80\x89+\xe2\x80\x891) always studied side by side and became friends and if they take an exam sitting next to each other, they will help each other for sure.Your task is to choose the maximum number of students and make such an arrangement of students in the room that no two students with adjacent numbers sit side by side." 1100

533F Encoding "hashing,string suffix structures,strings" "Polycarp invented a new way to encode strings. Let\'s assume that we have string T, consisting of lowercase English letters. Let\'s choose several pairs of letters of the English alphabet in such a way that each letter occurs in at most one pair. Then let\'s replace each letter in T with its pair letter if there is a pair letter for it. For example, if you chose pairs (l, r), (p, q) and (a, o), then word ""parallelogram"" according to the given encoding principle transforms to word ""qolorreraglom"".Polycarpus already has two strings, S and T. He suspects that string T was obtained after applying the given encoding method from some substring of string S. Find all positions mi in S (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89mi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|S|\xe2\x80\x89-\xe2\x80\x89|T|\xe2\x80\x89+\xe2\x80\x891), such that T can be obtained fro substring SmiSmi\xe2\x80\x89+\xe2\x80\x891... Smi\xe2\x80\x89+\xe2\x80\x89|T|\xe2\x80\x89-\xe2\x80\x891 by applying the described encoding operation by using some set of pairs of English alphabet letters" 2400

533E "Correcting Mistakes" "constructive algorithms,dp,greedy,hashing,strings,two pointers" "Analyzing the mistakes people make while typing search queries is a complex and an interesting work. As there is no guaranteed way to determine what the user originally meant by typing some query, we have to use different sorts of heuristics.Polycarp needed to write a code that could, given two words, check whether they could have been obtained from the same word as a result of typos. Polycarpus suggested that the most common typo is skipping exactly one letter as you type a word.Implement a program that can, given two distinct words S and T of the same length n determine how many words W of length n\xe2\x80\x89+\xe2\x80\x891 are there with such property that you can transform W into both S, and T by deleting exactly one character. Words S and T consist of lowercase English letters. Word W also should consist of lowercase English letters." 1800

533D Landmarks "data structures,dp" "We have an old building with n\xe2\x80\x89+\xe2\x80\x892 columns in a row. These columns support the ceiling. These columns are located in points with coordinates 0\xe2\x80\x89=\xe2\x80\x89x0\xe2\x80\x89<\xe2\x80\x89x1\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89xn\xe2\x80\x89<\xe2\x80\x89xn\xe2\x80\x89+\xe2\x80\x891. The leftmost and the rightmost columns are special, we will call them bearing, the other columns are ordinary. For each column we know its durability di. Let\'s consider an ordinary column with coordinate x. Let\'s assume that the coordinate of the closest to it column to the left (bearing or ordinary) is a and the coordinate of the closest to it column to the right (also, bearing or ordinary) is b. In this task let\'s assume that this column supports the segment of the ceiling from point  to point  (here both fractions are considered as real division). If the length of the segment of the ceiling supported by the column exceeds di, then the column cannot support it and it crashes after a while, and after that the load is being redistributeed between the neighbouring columns according to the same principle.  Thus, ordinary columns will be crashing for some time until the process stops at some state. One can prove that the set of the remaining columns doesn\'t depend on the order in which columns crash. If there are only two bearing columns left in the end, then we assume that the whole construction crashes under the weight of the roof. But if at least one ordinary column stays in addition to the bearing ones, then the building doesn\'t crash.To make the building stronger, we can add one extra ordinary column of arbitrary durability d\' at any (not necessarily integer) point 0\xe2\x80\x89<\xe2\x80\x89x\'\xe2\x80\x89<\xe2\x80\x89xn\xe2\x80\x89+\xe2\x80\x891. If point x\' is already occupied by an ordinary column, it is replaced by a new one.Your task is to find out: what minimal durability can the added column have so that the building doesn\'t crash?" 3000

533C "Board Game" games,greedy,implementation,math "Polycarp and Vasiliy love simple logical games. Today they play a game with infinite chessboard and one pawn for each player. Polycarp and Vasiliy move in turns, Polycarp starts. In each turn Polycarp can move his pawn from cell (x,\xe2\x80\x89y) to (x\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89y) or (x,\xe2\x80\x89y\xe2\x80\x89-\xe2\x80\x891). Vasiliy can move his pawn from (x,\xe2\x80\x89y) to one of cells: (x\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89y),\xe2\x80\x89(x\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89y\xe2\x80\x89-\xe2\x80\x891) and (x,\xe2\x80\x89y\xe2\x80\x89-\xe2\x80\x891). Both players are also allowed to skip move. There are some additional restrictions \xe2\x80\x94 a player is forbidden to move his pawn to a cell with negative x-coordinate or y-coordinate or to the cell containing opponent\'s pawn The winner is the first person to reach cell (0,\xe2\x80\x890). You are given the starting coordinates of both pawns. Determine who will win if both of them play optimally well." 1700

533B "Work Group" "dfs and similar,dp,graphs,strings,trees" "One Big Software Company has n employees numbered from 1 to n. The director is assigned number 1. Every employee of the company except the director has exactly one immediate superior. The director, of course, doesn\'t have a superior.We will call person a a subordinates of another person b, if either b is an immediate supervisor of a, or the immediate supervisor of a is a subordinate to person b. In particular, subordinates of the head are all other employees of the company.To solve achieve an Important Goal we need to form a workgroup. Every person has some efficiency, expressed by a positive integer ai, where i is the person\'s number. The efficiency of the workgroup is defined as the total efficiency of all the people included in it.The employees of the big software company are obsessed with modern ways of work process organization. Today pair programming is at the peak of popularity, so the workgroup should be formed with the following condition. Each person entering the workgroup should be able to sort all of his subordinates who are also in the workgroup into pairs. In other words, for each of the members of the workgroup the number of his subordinates within the workgroup should be even.Your task is to determine the maximum possible efficiency of the workgroup formed at observing the given condition. Any person including the director of company can enter the workgroup." 2000

533A "Berland Miners" "binary search,data structures,dfs and similar,greedy,trees" "The biggest gold mine in Berland consists of n caves, connected by n\xe2\x80\x89-\xe2\x80\x891 transitions. The entrance to the mine leads to the cave number 1, it is possible to go from it to any remaining cave of the mine by moving along the transitions. The mine is being developed by the InMine Inc., k miners work for it. Each day the corporation sorts miners into caves so that each cave has at most one miner working there. For each cave we know the height of its ceiling hi in meters, and for each miner we know his height sj, also in meters. If a miner\'s height doesn\'t exceed the height of the cave ceiling where he is, then he can stand there comfortably, otherwise, he has to stoop and that makes him unhappy.Unfortunately, miners typically go on strike in Berland, so InMine makes all the possible effort to make miners happy about their work conditions. To ensure that no miner goes on strike, you need make sure that no miner has to stoop at any moment on his way from the entrance to the mine to his cave (in particular, he must be able to stand comfortably in the cave where he works). To reach this goal, you can choose exactly one cave and increase the height of its ceiling by several meters. However enlarging a cave is an expensive and complex procedure. That\'s why InMine Inc. asks you either to determine the minimum number of meters you should raise the ceiling of some cave so that it is be possible to sort the miners into the caves and keep all miners happy with their working conditions or to determine that it is impossible to achieve by raising ceiling in exactly one cave." 3000

530I "Different variables" "*special problem" "N variables X1,\xe2\x80\x89...,\xe2\x80\x89XN can have positive integer values. You are given K constraints for these value that look like ""the values of variables Xi1,\xe2\x80\x89Xi2,\xe2\x80\x89...,\xe2\x80\x89XiM are different"". Among all possible lists of values of these variables that satisfy these constraints select the ones which have minimum possible max(Xi). Output lexicographically least of these lists." 2500

530H "Points in triangle" "*special problem,geometry" "You are given a set of points on a plane with positive integer coordinates. Find a triangle of minimum area with vertices in points (0,\xe2\x80\x890), (A,\xe2\x80\x890) and (0,\xe2\x80\x89B) (A and B are unknown positive integers) that contains all the given points inside it (points on the edges count towards being inside)." 2100

530G "Levenshtein distance" "*special problem" "Levenshtein distance between two strings of letters is calculated as the minimal total cost of a sequence of edit actions that converts one of the strings into the other one. The allowed edit actions are: substitution: the cost of substituting one letter with another is equal to the difference of index numbers of these letters in English alphabet. insertion/deletion: the cost of inserting a letter into a string or deleting a letter from a string is equal to the index number of this letter in English alphabet (see examples).You are given two strings. Find the Levenshtein distance between them." 2100

530F "Jumping frogs" "*special problem" "A rectangular swamp is inhabited by 10 species of frogs. Frogs of species i can jump from hillocks to hillock exactly i units along X-axis or Y-axis. Initially frogs of all types sit at the hillock at coordinates (0, 0). You are given coordinates of all other hillocks in the swamp. Find the largest Manhattan distance from (0, 0) to any hillock to which one of the frogs can travel by jumping between hillocks.Manhattan distance between (x1,\xe2\x80\x89y1) and (x2,\xe2\x80\x89y2) is |x1\xe2\x80\x89-\xe2\x80\x89x2|\xe2\x80\x89+\xe2\x80\x89|y1\xe2\x80\x89-\xe2\x80\x89y2|." 2100

530E "Sum and product" "*special problem" "You are given integers N and D. Find N positive integers x1...xN such that the difference of their product and their sum equals D." 1700

530D "Set subtraction" "*special problem" "You are given a starting set consisting of all integers from 1 to 1000, inclusive. You are also given several sets which need to be subtracted from the starting set (i.e., each number which is in at least one of these sets needs to be removed from the starting set). Each subtracted set is represented as an interval of integers from A to B, inclusive. Output the result after all subtractions." 1600

530C "Diophantine equation" "*special problem" "You are given an equation A\xe2\x80\x89*\xe2\x80\x89X\xe2\x80\x89+\xe2\x80\x89B\xe2\x80\x89*\xe2\x80\x89Y\xe2\x80\x89=\xe2\x80\x89C, A,\xe2\x80\x89B,\xe2\x80\x89C are positive integer coefficients, X and Y are variables which can have positive integer values only. Output the number of solutions of this equation and the solutions themselves." 1500

530B "String inside out" "*special problem" "You are given a string S of even length s1..s2n . Perform the following manipulations: divide it into two halves s1..sn and sn\xe2\x80\x89+\xe2\x80\x891..s2n reverse each of them sn..s1 and s2n..sn\xe2\x80\x89+\xe2\x80\x891 concatenate the resulting strings into sn..s1s2n..sn\xe2\x80\x89+\xe2\x80\x891Output the result of these manipulations." 1600

530A "Quadratic equation" "*special problem" "You are given a quadratic equation with integer coefficients A\xe2\x80\x89*\xe2\x80\x89X2\xe2\x80\x89+\xe2\x80\x89B\xe2\x80\x89*\xe2\x80\x89X\xe2\x80\x89+\xe2\x80\x89C\xe2\x80\x89=\xe2\x80\x890. It is guaranteed that A\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x890 and that the equation has at least one real root. Output the roots of the equation." 1500

529B "Group Photo 2 (online mirror version)" "brute force,greedy,sortings" "Many years have passed, and n friends met at a party again. Technologies have leaped forward since the last meeting, cameras with timer appeared and now it is not obligatory for one of the friends to stand with a camera, and, thus, being absent on the photo.Simply speaking, the process of photographing can be described as follows. Each friend occupies a rectangle of pixels on the photo: the i-th of them in a standing state occupies a wi pixels wide and a hi pixels high rectangle. But also, each person can lie down for the photo, and then he will occupy a hi pixels wide and a wi pixels high rectangle.The total photo will have size W\xe2\x80\x89\xc3\x97\xe2\x80\x89H, where W is the total width of all the people rectangles, and H is the maximum of the heights. The friends want to determine what minimum area the group photo can they obtain if no more than n\xe2\x80\x89/\xe2\x80\x892 of them can lie on the ground (it would be strange if more than n\xe2\x80\x89/\xe2\x80\x892 gentlemen lie on the ground together, isn\'t it?..)Help them to achieve this goal." 1900

528E "Triangles 3000" geometry,sortings "Many years have passed, and n friends met at a party again. Technologies have leaped forward since the last meeting, cameras with timer appeared and now it is not obligatory for one of the friends to stand with a camera, and, thus, being absent on the photo.Simply speaking, the process of photographing can be described as follows. Each friend occupies a rectangle of pixels on the photo: the i-th of them in a standing state occupies a wi pixels wide and a hi pixels high rectangle. But also, each person can lie down for the photo, and then he will occupy a hi pixels wide and a wi pixels high rectangle.The total photo will have size W\xe2\x80\x89\xc3\x97\xe2\x80\x89H, where W is the total width of all the people rectangles, and H is the maximum of the heights. The friends want to determine what minimum area the group photo can they obtain if no more than n\xe2\x80\x89/\xe2\x80\x892 of them can lie on the ground (it would be strange if more than n\xe2\x80\x89/\xe2\x80\x892 gentlemen lie on the ground together, isn\'t it?..)Help them to achieve this goal." 3100

528D "Fuzzy Search" "bitmasks,brute force,fft" "Leonid works for a small and promising start-up that works on decoding the human genome. His duties include solving complex problems of finding certain patterns in long strings consisting of letters \'A\', \'T\', \'G\' and \'C\'.Let\'s consider the following scenario. There is a fragment of a human DNA chain, recorded as a string S. To analyze the fragment, you need to find all occurrences of string T in a string S. However, the matter is complicated by the fact that the original chain fragment could contain minor mutations, which, however, complicate the task of finding a fragment. Leonid proposed the following approach to solve this problem.Let\'s write down integer k\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x890 \xe2\x80\x94 the error threshold. We will say that string T occurs in string S on position i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|S|\xe2\x80\x89-\xe2\x80\x89|T|\xe2\x80\x89+\xe2\x80\x891), if after putting string T along with this position, each character of string T corresponds to the some character of the same value in string S at the distance of at most k. More formally, for any j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|T|) there must exist such p (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89p\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|S|), that |(i\xe2\x80\x89+\xe2\x80\x89j\xe2\x80\x89-\xe2\x80\x891)\xe2\x80\x89-\xe2\x80\x89p|\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k and S[p]\xe2\x80\x89=\xe2\x80\x89T[j].For example, corresponding to the given definition, string ""ACAT"" occurs in string ""AGCAATTCAT"" in positions 2, 3 and 6.  Note that at k\xe2\x80\x89=\xe2\x80\x890 the given definition transforms to a simple definition of the occurrence of a string in a string.Help Leonid by calculating in how many positions the given string T occurs in the given string S with the given error threshold." 2500

527E "Data Center Drama" "dfs and similar,graphs" "The project of a data center of a Big Software Company consists of n computers connected by m cables. Simply speaking, each computer can be considered as a box with multiple cables going out of the box. Very Important Information is transmitted along each cable in one of the two directions. As the data center plan is not yet approved, it wasn\'t determined yet in which direction information will go along each cable. The cables are put so that each computer is connected with each one, perhaps through some other computers.The person in charge of the cleaning the data center will be Claudia Ivanova, the janitor. She loves to tie cables into bundles using cable ties. For some reasons, she groups the cables sticking out of a computer into groups of two, and if it isn\'t possible, then she gets furious and attacks the computer with the water from the bucket.It should also be noted that due to the specific physical characteristics of the Very Important Information, it is strictly forbidden to connect in one bundle two cables where information flows in different directions.The management of the data center wants to determine how to send information along each cable so that Claudia Ivanova is able to group all the cables coming out of each computer into groups of two, observing the condition above. Since it may not be possible with the existing connections plan, you are allowed to add the minimum possible number of cables to the scheme, and then you need to determine the direction of the information flow for each cable (yes, sometimes data centers are designed based on the janitors\' convenience...)" 2600

527D "Clique Problem" "data structures,dp,greedy,implementation,sortings" "The clique problem is one of the most well-known NP-complete problems. Under some simplification it can be formulated as follows. Consider an undirected graph G. It is required to find a subset of vertices C of the maximum size such that any two of them are connected by an edge in graph G. Sounds simple, doesn\'t it? Nobody yet knows an algorithm that finds a solution to this problem in polynomial time of the size of the graph. However, as with many other NP-complete problems, the clique problem is easier if you consider a specific type of a graph.Consider n distinct points on a line. Let the i-th point have the coordinate xi and weight wi. Let\'s form graph G, whose vertices are these points and edges connect exactly the pairs of points (i,\xe2\x80\x89j), such that the distance between them is not less than the sum of their weights, or more formally: |xi\xe2\x80\x89-\xe2\x80\x89xj|\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89wi\xe2\x80\x89+\xe2\x80\x89wj.Find the size of the maximum clique in such graph." 1800

527C "Glass Carving" "binary search,data structures,implementation" "Leonid wants to become a glass carver (the person who creates beautiful artworks by cutting the glass). He already has a rectangular w mm \xe2\x80\x89\xc3\x97\xe2\x80\x89 h mm sheet of glass, a diamond glass cutter and lots of enthusiasm. What he lacks is understanding of what to carve and how.In order not to waste time, he decided to practice the technique of carving. To do this, he makes vertical and horizontal cuts through the entire sheet. This process results in making smaller rectangular fragments of glass. Leonid does not move the newly made glass fragments. In particular, a cut divides each fragment of glass that it goes through into smaller fragments.After each cut Leonid tries to determine what area the largest of the currently available glass fragments has. Since there appear more and more fragments, this question takes him more and more time and distracts him from the fascinating process.Leonid offers to divide the labor \xe2\x80\x94 he will cut glass, and you will calculate the area of the maximum fragment after each cut. Do you agree?" 1500

527B "Error Correct System" greedy "Ford Prefect got a job as a web developer for a small company that makes towels. His current work task is to create a search engine for the website of the company. During the development process, he needs to write a subroutine for comparing strings S and T of equal length to be ""similar"". After a brief search on the Internet, he learned about the Hamming distance between two strings S and T of the same length, which is defined as the number of positions in which S and T have different characters. For example, the Hamming distance between words ""permanent"" and ""pergament"" is two, as these words differ in the fourth and sixth letters.Moreover, as he was searching for information, he also noticed that modern search engines have powerful mechanisms to correct errors in the request to improve the quality of search. Ford doesn\'t know much about human beings, so he assumed that the most common mistake in a request is swapping two arbitrary letters of the string (not necessarily adjacent). Now he wants to write a function that determines which two letters should be swapped in string S, so that the Hamming distance between a new string S and string T would be as small as possible, or otherwise, determine that such a replacement cannot reduce the distance between the strings.Help him do this!" 1500

527A "Playing with Paper" implementation,math "One day Vasya was sitting on a not so interesting Maths lesson and making an origami from a rectangular a mm \xe2\x80\x89\xc3\x97\xe2\x80\x89 b mm sheet of paper (a\xe2\x80\x89>\xe2\x80\x89b). Usually the first step in making an origami is making a square piece of paper from the rectangular sheet by folding the sheet along the bisector of the right angle, and cutting the excess part.  After making a paper ship from the square piece, Vasya looked on the remaining (a\xe2\x80\x89-\xe2\x80\x89b) mm \xe2\x80\x89\xc3\x97\xe2\x80\x89 b mm strip of paper. He got the idea to use this strip of paper in the same way to make an origami, and then use the remainder (if it exists) and so on. At the moment when he is left with a square piece of paper, he will make the last ship from it and stop.Can you determine how many ships Vasya will make during the lesson?" 1100

526G "Spiders Evil Plan" greedy,trees "Spiders are Om Nom\'s old enemies. They love eating candies as much as he does and that\'s why they keep trying to keep the monster away from his favorite candies. They came up with an evil plan to trap Om Nom.  Let\'s consider a rope structure consisting of n nodes and n\xe2\x80\x89-\xe2\x80\x891 ropes connecting the nodes. The structure is connected, thus, the ropes and the nodes form a tree. Each rope of the formed structure is associated with its length. A candy is tied to node x of the structure. Om Nom really wants to eat this candy.The y spiders are trying to stop him from doing it. They decided to entangle the candy and some part of the structure into a web, thus attaching the candy to as large as possible part of the rope structure. Each spider can use his web to cover all ropes on the path between two arbitrary nodes a and b. Thus, y spiders can cover the set of ropes which is a union of y paths in the given tree. These y paths can arbitrarily intersect each other. The spiders want the following conditions to be hold:  the node containing the candy is adjacent to at least one rope covered with a web  the ropes covered with the web form a connected structure (what\'s the idea of covering with a web the ropes that are not connected with the candy?)  the total length of the ropes covered with web is as large as possible The spiders haven\'t yet decided to what node of the structure they will tie the candy and how many spiders will cover the structure with web, so they asked you to help them. Help them calculate the optimal plan for multiple values of x and y." 3300

526F "Pudding Monsters" "data structures,divide and conquer" "In this problem you will meet the simplified model of game Pudding Monsters.An important process in developing any game is creating levels. A game field in Pudding Monsters is an n\xe2\x80\x89\xc3\x97\xe2\x80\x89n rectangular grid, n of its cells contain monsters and some other cells contain game objects. The gameplay is about moving the monsters around the field. When two monsters are touching each other, they glue together into a single big one (as they are from pudding, remember?).  Statistics showed that the most interesting maps appear if initially each row and each column contains exactly one monster and the rest of map specifics is set up by the correct positioning of the other game objects. A technique that\'s widely used to make the development process more efficient is reusing the available resources. For example, if there is a large n\xe2\x80\x89\xc3\x97\xe2\x80\x89n map, you can choose in it a smaller k\xe2\x80\x89\xc3\x97\xe2\x80\x89k square part, containing exactly k monsters and suggest it as a simplified version of the original map.You wonder how many ways there are to choose in the initial map a k\xe2\x80\x89\xc3\x97\xe2\x80\x89k (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) square fragment, containing exactly k pudding monsters. Calculate this number." 3000

526E "Transmitting Levels" dp,implementation "Optimizing the amount of data transmitted via a network is an important and interesting part of developing any network application.  In one secret game developed deep in the ZeptoLab company, the game universe consists of n levels, located in a circle. You can get from level i to levels i\xe2\x80\x89-\xe2\x80\x891 and i\xe2\x80\x89+\xe2\x80\x891, also you can get from level 1 to level n and vice versa. The map of the i-th level description size is ai bytes.In order to reduce the transmitted traffic, the game gets levels as follows. All the levels on the server are divided into m groups and each time a player finds himself on one of the levels of a certain group for the first time, the server sends all levels of the group to the game client as a single packet. Thus, when a player travels inside the levels of a single group, the application doesn\'t need any new information. Due to the technical limitations the packet can contain an arbitrary number of levels but their total size mustn\'t exceed b bytes, where b is some positive integer constant.Usual situation is that players finish levels one by one, that\'s why a decision was made to split n levels into m groups so that each group was a continuous segment containing multiple neighboring levels (also, the group can have two adjacent levels, n and 1). Specifically, if the descriptions of all levels have the total weight of at most b bytes, then they can all be united into one group to be sent in a single packet.Determine, what minimum number of groups do you need to make in order to organize the levels of the game observing the conditions above?As developing a game is a long process and technology never stagnates, it is yet impossible to predict exactly what value will take constant value b limiting the packet size when the game is out. That\'s why the developers ask you to find the answer for multiple values of b." 2400

526D "Om Nom and Necklace" "hashing,string suffix structures,strings" "One day Om Nom found a thread with n beads of different colors. He decided to cut the first several beads from this thread to make a bead necklace and present it to his girlfriend Om Nelly.  Om Nom knows that his girlfriend loves beautiful patterns. That\'s why he wants the beads on the necklace to form a regular pattern. A sequence of beads S is regular if it can be represented as S\xe2\x80\x89=\xe2\x80\x89A\xe2\x80\x89+\xe2\x80\x89B\xe2\x80\x89+\xe2\x80\x89A\xe2\x80\x89+\xe2\x80\x89B\xe2\x80\x89+\xe2\x80\x89A\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89A\xe2\x80\x89+\xe2\x80\x89B\xe2\x80\x89+\xe2\x80\x89A, where A and B are some bead sequences, ""\xe2\x80\x89+\xe2\x80\x89"" is the concatenation of sequences, there are exactly 2k\xe2\x80\x89+\xe2\x80\x891 summands in this sum, among which there are k\xe2\x80\x89+\xe2\x80\x891 ""A"" summands and k ""B"" summands that follow in alternating order. Om Nelly knows that her friend is an eager mathematician, so she doesn\'t mind if A or B is an empty sequence.Help Om Nom determine in which ways he can cut off the first several beads from the found thread (at least one; probably, all) so that they form a regular pattern. When Om Nom cuts off the beads, he doesn\'t change their order." 2200

526C "Om Nom and Candies" "brute force,greedy,math" "A sweet little monster Om Nom loves candies very much. One day he found himself in a rather tricky situation that required him to think a bit in order to enjoy candies the most. Would you succeed with the same task if you were on his place?  One day, when he came to his friend Evan, Om Nom didn\'t find him at home but he found two bags with candies. The first was full of blue candies and the second bag was full of red candies. Om Nom knows that each red candy weighs Wr grams and each blue candy weighs Wb grams. Eating a single red candy gives Om Nom Hr joy units and eating a single blue candy gives Om Nom Hb joy units.Candies are the most important thing in the world, but on the other hand overeating is not good. Om Nom knows if he eats more than C grams of candies, he will get sick. Om Nom thinks that it isn\'t proper to leave candy leftovers, so he can only eat a whole candy. Om Nom is a great mathematician and he quickly determined how many candies of what type he should eat in order to get the maximum number of joy units. Can you repeat his achievement? You can assume that each bag contains more candies that Om Nom can eat." 2000

526B "Om Nom and Dark Park" "dfs and similar,greedy,implementation" "Om Nom is the main character of a game ""Cut the Rope"". He is a bright little monster who likes visiting friends living at the other side of the park. However the dark old parks can scare even somebody as fearless as Om Nom, so he asks you to help him.  The park consists of 2n\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89-\xe2\x80\x891 squares connected by roads so that the scheme of the park is a full binary tree of depth n. More formally, the entrance to the park is located at the square 1. The exits out of the park are located at squares 2n,\xe2\x80\x892n\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x892n\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89-\xe2\x80\x891 and these exits lead straight to the Om Nom friends\' houses. From each square i (2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x892n\xe2\x80\x89+\xe2\x80\x891) there is a road to the square . Thus, it is possible to go from the park entrance to each of the exits by walking along exactly n roads.    To light the path roads in the evening, the park keeper installed street lights along each road. The road that leads from square i to square  has ai lights.Om Nom loves counting lights on the way to his friend. Om Nom is afraid of spiders who live in the park, so he doesn\'t like to walk along roads that are not enough lit. What he wants is that the way to any of his friends should have in total the same number of lights. That will make him feel safe. He asked you to help him install additional lights. Determine what minimum number of lights it is needed to additionally place on the park roads so that a path from the entrance to any exit of the park contains the same number of street lights. You may add an arbitrary number of street lights to each of the roads." 1400

526A "King of Thieves" "brute force,implementation" "In this problem you will meet the simplified model of game King of Thieves.In a new ZeptoLab game called ""King of Thieves"" your aim is to reach a chest with gold by controlling your character, avoiding traps and obstacles on your way.  An interesting feature of the game is that you can design your own levels that will be available to other players. Let\'s consider the following simple design of a level.A dungeon consists of n segments located at a same vertical level, each segment is either a platform that character can stand on, or a pit with a trap that makes player lose if he falls into it. All segments have the same length, platforms on the scheme of the level are represented as \'*\' and pits are represented as \'.\'. One of things that affects speedrun characteristics of the level is a possibility to perform a series of consecutive jumps of the same length. More formally, when the character is on the platform number i1, he can make a sequence of jumps through the platforms i1\xe2\x80\x89<\xe2\x80\x89i2\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89ik, if i2\xe2\x80\x89-\xe2\x80\x89i1\xe2\x80\x89=\xe2\x80\x89i3\xe2\x80\x89-\xe2\x80\x89i2\xe2\x80\x89=\xe2\x80\x89...\xe2\x80\x89=\xe2\x80\x89ik\xe2\x80\x89-\xe2\x80\x89ik\xe2\x80\x89-\xe2\x80\x891. Of course, all segments i1,\xe2\x80\x89i2,\xe2\x80\x89... ik should be exactly the platforms, not pits. Let\'s call a level to be good if you can perform a sequence of four jumps of the same length or in the other words there must be a sequence i1,\xe2\x80\x89i2,\xe2\x80\x89...,\xe2\x80\x89i5, consisting of five platforms so that the intervals between consecutive platforms are of the same length. Given the scheme of the level, check if it is good." 1300

525E "Anya and Cubes" "binary search,bitmasks,brute force,dp,math,meet-in-the-middle" "Anya loves to fold and stick. Today she decided to do just that.Anya has n cubes lying in a line and numbered from 1 to n from left to right, with natural numbers written on them. She also has k stickers with exclamation marks. We know that the number of stickers does not exceed the number of cubes.Anya can stick an exclamation mark on the cube and get the factorial of the number written on the cube. For example, if a cube reads 5, then after the sticking it reads 5!, which equals 120.You need to help Anya count how many ways there are to choose some of the cubes and stick on some of the chosen cubes at most k exclamation marks so that the sum of the numbers written on the chosen cubes after the sticking becomes equal to S. Anya can stick at most one exclamation mark on each cube. Can you do it?Two ways are considered the same if they have the same set of chosen cubes and the same set of cubes with exclamation marks." 2100

525D "Arthur and Walls" "constructive algorithms,data structures,graphs,greedy,shortest paths" "Finally it is a day when Arthur has enough money for buying an apartment. He found a great option close to the center of the city with a nice price.Plan of the apartment found by Arthur looks like a rectangle n\xe2\x80\x89\xc3\x97\xe2\x80\x89m consisting of squares of size 1\xe2\x80\x89\xc3\x97\xe2\x80\x891. Each of those squares contains either a wall (such square is denoted by a symbol ""*"" on the plan) or a free space (such square is denoted on the plan by a symbol ""."").Room in an apartment is a maximal connected area consisting of free squares. Squares are considered adjacent if they share a common side.The old Arthur dream is to live in an apartment where all rooms are rectangles. He asks you to calculate minimum number of walls you need to remove in order to achieve this goal. After removing a wall from a square it becomes a free square. While removing the walls it is possible that some rooms unite into a single one." 2400

525C "Ilya and Sticks" greedy,math,sortings "In the evening, after the contest Ilya was bored, and he really felt like maximizing. He remembered that he had a set of n sticks and an instrument. Each stick is characterized by its length li.Ilya decided to make a rectangle from the sticks. And due to his whim, he decided to make rectangles in such a way that maximizes their total area. Each stick is used in making at most one rectangle, it is possible that some of sticks remain unused. Bending sticks is not allowed.Sticks with lengths a1, a2, a3 and a4 can make a rectangle if the following properties are observed:  a1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a3\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a4  a1\xe2\x80\x89=\xe2\x80\x89a2  a3\xe2\x80\x89=\xe2\x80\x89a4 A rectangle can be made of sticks with lengths of, for example, 3�3�3�3 or 2�2�4�4. A rectangle cannot be made of, for example, sticks 5�5�5�7.Ilya also has an instrument which can reduce the length of the sticks. The sticks are made of a special material, so the length of each stick can be reduced by at most one. For example, a stick with length 5 can either stay at this length or be transformed into a stick of length 4.You have to answer the question \xe2\x80\x94 what maximum total area of the rectangles can Ilya get with a file if makes rectangles from the available sticks?" 1600

525B "Pasha and String" "constructive algorithms,greedy,math,strings" "Pasha got a very beautiful string s for his birthday, the string consists of lowercase Latin letters. The letters in the string are numbered from 1 to |s| from left to right, where |s| is the length of the given string.Pasha didn\'t like his present very much so he decided to change it. After his birthday Pasha spent m days performing the following transformations on his string�\xe2\x80\x94�each day he chose integer ai and reversed a piece of string (a segment) from position ai to position |s|\xe2\x80\x89-\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x891. It is guaranteed that 2\xc2\xb7ai\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|s|.You face the following task: determine what Pasha\'s string will look like after m days." 1400

525A "Vitaliy and Pie" greedy,hashing,strings "After a hard day Vitaly got very hungry and he wants to eat his favorite potato pie. But it\'s not that simple. Vitaly is in the first room of the house with n room located in a line and numbered starting from one from left to right. You can go from the first room to the second room, from the second room to the third room and so on \xe2\x80\x94 you can go from the (n\xe2\x80\x89-\xe2\x80\x891)-th room to the n-th room. Thus, you can go to room x only from room x\xe2\x80\x89-\xe2\x80\x891.The potato pie is located in the n-th room and Vitaly needs to go there. Each pair of consecutive rooms has a door between them. In order to go to room x from room x\xe2\x80\x89-\xe2\x80\x891, you need to open the door between the rooms with the corresponding key. In total the house has several types of doors (represented by uppercase Latin letters) and several types of keys (represented by lowercase Latin letters). The key of type t can open the door of type T if and only if t and T are the same letter, written in different cases. For example, key f can open door F.Each of the first n\xe2\x80\x89-\xe2\x80\x891 rooms contains exactly one key of some type that Vitaly can use to get to next rooms. Once the door is open with some key, Vitaly won\'t get the key from the keyhole but he will immediately run into the next room. In other words, each key can open no more than one door.Vitaly realizes that he may end up in some room without the key that opens the door to the next room. Before the start his run for the potato pie Vitaly can buy any number of keys of any type that is guaranteed to get to room n.Given the plan of the house, Vitaly wants to know what is the minimum number of keys he needs to buy to surely get to the room n, which has a delicious potato pie. Write a program that will help Vitaly find out this number." 1100

524F "And Yet Another Bracket Sequence" "data structures,greedy,hashing,string suffix structures,strings" "Polycarpus has a finite sequence of opening and closing brackets. In order not to fall asleep in a lecture, Polycarpus is having fun with his sequence. He is able to perform two operations:  adding any bracket in any position (in the beginning, the end, or between any two existing brackets);  cyclic shift \xe2\x80\x94 moving the last bracket from the end of the sequence to the beginning. Polycarpus can apply any number of operations to his sequence and adding a cyclic shift in any order. As a result, he wants to get the correct bracket sequence of the minimum possible length. If there are several such sequences, Polycarpus is interested in the lexicographically smallest one. Help him find such a sequence.Acorrect bracket sequence is a sequence of opening and closing brackets, from which you can get a correct arithmetic expression by adding characters ""1"" and ""+"" . Each opening bracket must correspond to a closed one. For example, the sequences ""(())()"", ""()"", ""(()(()))"" are correct and "")("", ""(()"" and ""(()))("" are not.The sequence a1 a2... an is lexicographically smaller than sequence b1 b2... bn, if there is such number i from 1 to n, thatak\xe2\x80\x89=\xe2\x80\x89bk for 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k\xe2\x80\x89<\xe2\x80\x89i and ai\xe2\x80\x89<\xe2\x80\x89bi. Consider that ""("" \xe2\x80\x89<\xe2\x80\x89 "")""." 2700

524E "Rooks and Rectangles" "data structures,sortings" "Polycarpus has a chessboard of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m, where k rooks are placed. Polycarpus hasn\'t yet invented the rules of the game he will play. However, he has already allocated q rectangular areas of special strategic importance on the board, they must be protected well. According to Polycarpus, a rectangular area of \xe2\x80\x8b\xe2\x80\x8bthe board is well protected if all its vacant squares can be beaten by the rooks that stand on this area. The rooks on the rest of the board do not affect the area\'s defense. The position of the rooks is fixed and cannot be changed. We remind you that the the rook beats the squares located on the same vertical or horizontal line with it, if there are no other pieces between the square and the rook. Help Polycarpus determine whether all strategically important areas are protected." 2400

524D "Social Network" "greedy,two pointers" "Polycarpus got an internship in one well-known social network. His test task is to count the number of unique users who have visited a social network during the day. Polycarpus was provided with information on all user requests for this time period. For each query, we know its time... and nothing else, because Polycarpus has already accidentally removed the user IDs corresponding to the requests from the database. Thus, it is now impossible to determine whether any two requests are made by the same person or by different people.But wait, something is still known, because that day a record was achieved \xe2\x80\x94 M simultaneous users online! In addition, Polycarpus believes that if a user made a request at second s, then he was online for T seconds after that, that is, at seconds s, s\xe2\x80\x89+\xe2\x80\x891, s\xe2\x80\x89+\xe2\x80\x892, ..., s\xe2\x80\x89+\xe2\x80\x89T\xe2\x80\x89-\xe2\x80\x891. So, the user\'s time online can be calculated as the union of time intervals of the form [s,\xe2\x80\x89s\xe2\x80\x89+\xe2\x80\x89T\xe2\x80\x89-\xe2\x80\x891] over all times s of requests from him.Guided by these thoughts, Polycarpus wants to assign a user ID to each request so that:  the number of different users online did not exceed M at any moment,  at some second the number of distinct users online reached value M,  the total number of users (the number of distinct identifiers) was as much as possible. Help Polycarpus cope with the test." 2100

524C "The Art of Dealing with ATM" "binary search,sortings" "ATMs of a well-known bank of a small country are arranged so that they can not give any amount of money requested by the user. Due to the limited size of the bill dispenser (the device that is directly giving money from an ATM) and some peculiarities of the ATM structure, you can get at most k bills from it, and the bills may be of at most two distinct denominations.For example, if a country uses bills with denominations 10, 50, 100, 500, 1000 and 5000 burles, then at k\xe2\x80\x89=\xe2\x80\x8920 such ATM can give sums 100\xe2\x80\x89000 burles and 96\xe2\x80\x89000 burles, but it cannot give sums 99\xe2\x80\x89000 and 101\xe2\x80\x89000 burles.Let\'s suppose that the country uses bills of n distinct denominations, and the ATM that you are using has an unlimited number of bills of each type. You know that during the day you will need to withdraw a certain amount of cash q times. You know that when the ATM has multiple ways to give money, it chooses the one which requires the minimum number of bills, or displays an error message if it cannot be done. Determine the result of each of the q of requests for cash withdrawal." 1900

524B "\xd0\xa4\xd0\xbe\xd1\x82\xd0\xbe \xd0\xbd\xd0\xb0 \xd0\xbf\xd0\xb0\xd0\xbc\xd1\x8f\xd1\x82\xd1\x8c - 2 (round version)" dp,greedy "ATMs of a well-known bank of a small country are arranged so that they can not give any amount of money requested by the user. Due to the limited size of the bill dispenser (the device that is directly giving money from an ATM) and some peculiarities of the ATM structure, you can get at most k bills from it, and the bills may be of at most two distinct denominations.For example, if a country uses bills with denominations 10, 50, 100, 500, 1000 and 5000 burles, then at k\xe2\x80\x89=\xe2\x80\x8920 such ATM can give sums 100\xe2\x80\x89000 burles and 96\xe2\x80\x89000 burles, but it cannot give sums 99\xe2\x80\x89000 and 101\xe2\x80\x89000 burles.Let\'s suppose that the country uses bills of n distinct denominations, and the ATM that you are using has an unlimited number of bills of each type. You know that during the day you will need to withdraw a certain amount of cash q times. You know that when the ATM has multiple ways to give money, it chooses the one which requires the minimum number of bills, or displays an error message if it cannot be done. Determine the result of each of the q of requests for cash withdrawal." 1700

524A "\xd0\x92\xd0\xbe\xd0\xb7\xd0\xbc\xd0\xbe\xd0\xb6\xd0\xbd\xd0\xbe, \xd0\xb2\xd1\x8b \xd0\xb7\xd0\xbd\xd0\xb0\xd0\xb5\xd1\x82\xd0\xb5 \xd1\x8d\xd1\x82\xd0\xb8\xd1\x85 \xd0\xbb\xd1\x8e\xd0\xb4\xd0\xb5\xd0\xb9?" implementation "ATMs of a well-known bank of a small country are arranged so that they can not give any amount of money requested by the user. Due to the limited size of the bill dispenser (the device that is directly giving money from an ATM) and some peculiarities of the ATM structure, you can get at most k bills from it, and the bills may be of at most two distinct denominations.For example, if a country uses bills with denominations 10, 50, 100, 500, 1000 and 5000 burles, then at k\xe2\x80\x89=\xe2\x80\x8920 such ATM can give sums 100\xe2\x80\x89000 burles and 96\xe2\x80\x89000 burles, but it cannot give sums 99\xe2\x80\x89000 and 101\xe2\x80\x89000 burles.Let\'s suppose that the country uses bills of n distinct denominations, and the ATM that you are using has an unlimited number of bills of each type. You know that during the day you will need to withdraw a certain amount of cash q times. You know that when the ATM has multiple ways to give money, it chooses the one which requires the minimum number of bills, or displays an error message if it cannot be done. Determine the result of each of the q of requests for cash withdrawal." 1600

523D "Statistics of Recompressing Videos" "*special problem,data structures,implementation" "A social network for dogs called DH (DogHouse) has k special servers to recompress uploaded videos of cute cats. After each video is uploaded, it should be recompressed on one (any) of the servers, and only after that it can be saved in the social network.We know that each server takes one second to recompress a one minute fragment. Thus, any server takes m seconds to recompress a m minute video.We know the time when each of the n videos were uploaded to the network (in seconds starting from the moment all servers started working). All videos appear at different moments of time and they are recompressed in the order they appear. If some video appeared at time s, then its recompressing can start at that very moment, immediately. Some videos can await recompressing when all the servers are busy. In this case, as soon as a server is available, it immediately starts recompressing another video. The videos that await recompressing go in a queue. If by the moment the videos started being recompressed some servers are available, then any of them starts recompressing the video.For each video find the moment it stops being recompressed." 1600

523C "Name Quest" "*special problem,greedy" "A Martian boy is named s \xe2\x80\x94 he has got this name quite recently from his parents for his coming of age birthday. Now he enjoys looking for his name everywhere. If he sees that he can obtain his name from some string by removing zero or more letters (at that, the remaining letters remain in the same order), he gets happy. For example, if s=\xc2\xababa\xc2\xbb, then strings \xc2\xabbaobab\xc2\xbb, \xc2\xabaabbaa\xc2\xbb, \xc2\xabhelloabahello\xc2\xbb make him very happy and strings \xc2\xabaab\xc2\xbb, \xc2\xabbaaa\xc2\xbb and \xc2\xabhelloabhello\xc2\xbb do not.However rather than being happy once, he loves twice as much being happy twice! So, when he got string t as a present, he wanted to cut it in two parts (the left part and the right part) so that each part made him happy.Help s determine the number of distinct ways to cut the given string t into two parts in the required manner." 1400

523B "Mean Requests" "*special problem,implementation" "In this problem you will have to deal with a real algorithm that is used in the VK social network.As in any other company that creates high-loaded websites, the VK developers have to deal with request statistics regularly. An important indicator reflecting the load of the site is the mean number of requests for a certain period of time of T seconds (for example, T\xe2\x80\x89=\xe2\x80\x8960�seconds\xe2\x80\x89=\xe2\x80\x891�min and T\xe2\x80\x89=\xe2\x80\x8986400�seconds\xe2\x80\x89=\xe2\x80\x891�day). For example, if this value drops dramatically, that shows that the site has access problem. If this value grows, that may be a reason to analyze the cause for the growth and add more servers to the website if it is really needed.However, even such a natural problem as counting the mean number of queries for some period of time can be a challenge when you process the amount of data of a huge social network. That\'s why the developers have to use original techniques to solve problems approximately, but more effectively at the same time.Let\'s consider the following formal model. We have a service that works for n seconds. We know the number of queries to this resource at at each moment of time t (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89t\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n). Let\'s formulate the following algorithm of calculating the mean with exponential decay. Let c be some real number, strictly larger than one.// setting this constant value correctly can adjust   // the time range for which statistics will be calculateddouble c = some constant value; // as the result of the algorithm\'s performance this variable will contain // the mean number of queries for the last // T seconds by the current moment of timedouble mean = 0.0; for t = 1..n: // at each second, we do the following:    // at is the number of queries that came at the last second;    mean = (mean + at / T) / c;Thus, the mean variable is recalculated each second using the number of queries that came at that second. We can make some mathematical calculations and prove that choosing the value of constant c correctly will make the value of mean not very different from the real mean value ax at t\xe2\x80\x89-\xe2\x80\x89T\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89t. The advantage of such approach is that it only uses the number of requests at the current moment of time and doesn\'t require storing the history of requests for a large time range. Also, it considers the recent values with the weight larger than the weight of the old ones, which helps to react to dramatic change in values quicker.However before using the new theoretical approach in industrial programming, there is an obligatory step to make, that is, to test its credibility practically on given test data sets. Your task is to compare the data obtained as a result of the work of an approximate algorithm to the real data. You are given n values at, integer T and real number c. Also, you are given m moments pj (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m), where we are interested in the mean value of the number of queries for the last T seconds. Implement two algorithms. The first one should calculate the required value by definition, i.e. by the formula . The second algorithm should calculate the mean value as is described above. Print both values and calculate the relative error of the second algorithm by the formula , where approx is the approximate value, obtained by the second algorithm, and real is the exact value obtained by the first algorithm." 1500

523A "Rotate, Flip and Zoom" "*special problem,implementation" "Polycarp is writing the prototype of a graphic editor. He has already made up his mind that the basic image transformations in his editor will be: rotate the image 90 degrees clockwise, flip the image horizontally (symmetry relative to the vertical line, that is, the right part of the image moves to the left, and vice versa) and zooming on the image. He is sure that that there is a large number of transformations that can be expressed through these three.He has recently stopped implementing all three transformations for monochrome images. To test this feature, he asked you to write a code that will consecutively perform three actions with a monochrome image: first it will rotate the image 90 degrees clockwise, then it will flip the image horizontally and finally, it will zoom in twice on the image (that is, it will double all the linear sizes).Implement this feature to help Polycarp test his editor." 1200

522D "Closest Equals" "*special problem,data structures" "You are given sequence a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an and m queries lj,\xe2\x80\x89rj (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89lj\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89rj\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n). For each query you need to print the minimum distance between such pair of elements ax and ay (x\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89y), that:  both indexes of the elements lie within range [lj,\xe2\x80\x89rj], that is, lj\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x,\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89rj;  the values of the elements are equal, that is ax\xe2\x80\x89=\xe2\x80\x89ay. The text above understands distance as |x\xe2\x80\x89-\xe2\x80\x89y|." 2000

522C "Chicken or Fish?" greedy "Polycarp is flying in the airplane. Finally, it is his favorite time \xe2\x80\x94 the lunchtime. The BerAvia company stewardess is giving food consecutively to all the passengers from the 1-th one to the last one. Polycarp is sitting on seat m, that means, he will be the m-th person to get food.The flight menu has k dishes in total and when Polycarp boarded the flight, he had time to count the number of portions of each dish on board. Thus, he knows values a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89ak, where ai is the number of portions of the i-th dish.The stewardess has already given food to m\xe2\x80\x89-\xe2\x80\x891 passengers, gave Polycarp a polite smile and asked him what he would prefer. That\'s when Polycarp realized that they might have run out of some dishes by that moment. For some of the m\xe2\x80\x89-\xe2\x80\x891 passengers ahead of him, he noticed what dishes they were given. Besides, he\'s heard some strange mumbling from some of the m\xe2\x80\x89-\xe2\x80\x891 passengers ahead of him, similar to phrase \'I\'m disappointed\'. That happened when a passenger asked for some dish but the stewardess gave him a polite smile and said that they had run out of that dish. In that case the passenger needed to choose some other dish that was available. If Polycarp heard no more sounds from a passenger, that meant that the passenger chose his dish at the first try.Help Polycarp to find out for each dish: whether they could have run out of the dish by the moment Polyarp was served or that dish was definitely available." 2100

522B "Photo to Remember" "*special problem,data structures,dp,implementation" "One day n friends met at a party, they hadn\'t seen each other for a long time and so they decided to make a group photo together. Simply speaking, the process of taking photos can be described as follows. On the photo, each photographed friend occupies a rectangle of pixels: the i-th of them occupies the rectangle of width wi pixels and height hi pixels. On the group photo everybody stands in a line, thus the minimum pixel size of the photo including all the photographed friends, is W\xe2\x80\x89\xc3\x97\xe2\x80\x89H, where W is the total sum of all widths and H is the maximum height of all the photographed friends.As is usually the case, the friends made n photos \xe2\x80\x94 the j-th (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) photo had everybody except for the j-th friend as he was the photographer.Print the minimum size of each made photo in pixels." 1100

522A Reposts "*special problem,dfs and similar,dp,graphs,trees" "One day Polycarp published a funny picture in a social network making a poll about the color of his handle. Many of his friends started reposting Polycarp\'s joke to their news feed. Some of them reposted the reposts and so on.These events are given as a sequence of strings ""name1 reposted name2"", where name1 is the name of the person who reposted the joke, and name2 is the name of the person from whose news feed the joke was reposted. It is guaranteed that for each string ""name1 reposted name2"" user ""name1"" didn\'t have the joke in his feed yet, and ""name2"" already had it in his feed by the moment of repost. Polycarp was registered as ""Polycarp"" and initially the joke was only in his feed.Polycarp measures the popularity of the joke as the length of the largest repost chain. Print the popularity of Polycarp\'s joke." 1200

521E "Cycling City" "dfs and similar,graphs" "You are organizing a cycling race on the streets of the city. The city contains n junctions, some pairs of them are connected by roads; on each road you can move in any direction. No two roads connect the same pair of intersections, and no road connects the intersection with itself.You want the race to be open to both professional athletes and beginner cyclists, and that\'s why you will organize the race in three nominations: easy, moderate and difficult; each participant will choose the more suitable nomination. For each nomination you must choose the route \xe2\x80\x94 the chain of junctions, consecutively connected by roads. Routes must meet the following conditions: all three routes should start at the same intersection, and finish at the same intersection (place of start and finish can\'t be the same); to avoid collisions, no two routes can have common junctions (except for the common start and finish), and can not go along the same road (irrespective of the driving direction on the road for those two routes); no route must pass twice through the same intersection or visit the same road twice (irrespective of the driving direction on the road for the first and second time of visit).Preparing for the competition is about to begin, and you need to determine the routes of the race as quickly as possible. The length of the routes is not important, it is only important that all the given requirements were met." 3100

521D Shop greedy "Vasya plays one very well-known and extremely popular MMORPG game. His game character has k skill; currently the i-th of them equals to ai. Also this game has a common rating table in which the participants are ranked according to the product of all the skills of a hero in the descending order.Vasya decided to \'upgrade\' his character via the game store. This store offers n possible ways to improve the hero\'s skills; Each of these ways belongs to one of three types:  assign the i-th skill to b;  add b to the i-th skill;  multiply the i-th skill by b. Unfortunately, a) every improvement can only be used once; b) the money on Vasya\'s card is enough only to purchase not more than m of the n improvements. Help Vasya to reach the highest ranking in the game. To do this tell Vasya which of improvements he has to purchase and in what order he should use them to make his rating become as high as possible. If there are several ways to achieve it, print any of them." 2800

520E "Pluses everywhere" "combinatorics,dp,math,number theory" "Vasya is sitting on an extremely boring math class. To have fun, he took a piece of paper and wrote out n numbers on a single line. After that, Vasya began to write out different ways to put pluses (""+"") in the line between certain digits in the line so that the result was a correct arithmetic expression; formally, no two pluses in such a partition can stand together (between any two adjacent pluses there must be at least one digit), and no plus can stand at the beginning or the end of a line. For example, in the string 100500, ways 100500 (add no pluses), 1+00+500 or 10050+0 are correct, and ways 100++500, +1+0+0+5+0+0 or 100500+ are incorrect.The lesson was long, and Vasya has written all the correct ways to place exactly k pluses in a string of digits. At this point, he got caught having fun by a teacher and he was given the task to calculate the sum of all the resulting arithmetic expressions by the end of the lesson (when calculating the value of an expression the leading zeros should be ignored). As the answer can be large, Vasya is allowed to get only its remainder modulo 109\xe2\x80\x89+\xe2\x80\x897. Help him!" 2200

520D Cubes games,greedy,implementation "Once Vasya and Petya assembled a figure of m cubes, each of them is associated with a number between 0 and m\xe2\x80\x89-\xe2\x80\x891 (inclusive, each number appeared exactly once). Let\'s consider a coordinate system such that the OX is the ground, and the OY is directed upwards. Each cube is associated with the coordinates of its lower left corner, these coordinates are integers for each cube.The figure turned out to be stable. This means that for any cube that is not on the ground, there is at least one cube under it such that those two cubes touch by a side or a corner. More formally, this means that for the cube with coordinates (x,\xe2\x80\x89y) either y\xe2\x80\x89=\xe2\x80\x890, or there is a cube with coordinates (x\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89y\xe2\x80\x89-\xe2\x80\x891), (x,\xe2\x80\x89y\xe2\x80\x89-\xe2\x80\x891) or (x\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89y\xe2\x80\x89-\xe2\x80\x891).Now the boys want to disassemble the figure and put all the cubes in a row. In one step the cube is removed from the figure and being put to the right of the blocks that have already been laid. The guys remove the cubes in such order that the figure remains stable. To make the process more interesting, the guys decided to play the following game. The guys take out the cubes from the figure in turns. It is easy to see that after the figure is disassembled, the integers written on the cubes form a number, written in the m-ary positional numerical system (possibly, with a leading zero). Vasya wants the resulting number to be maximum possible, and Petya, on the contrary, tries to make it as small as possible. Vasya starts the game.Your task is to determine what number is formed after the figure is disassembled, if the boys play optimally. Determine the remainder of the answer modulo 109\xe2\x80\x89+\xe2\x80\x899." 2100

520C "DNA Alignment" math,strings "Vasya became interested in bioinformatics. He\'s going to write an article about similar cyclic DNA sequences, so he invented a new method for determining the similarity of cyclic sequences.Let\'s assume that strings s and t have the same length n, then the function h(s,\xe2\x80\x89t) is defined as the number of positions in which the respective symbols of s and t are the same. Function h(s,\xe2\x80\x89t) can be used to define the function of Vasya distance \xcf\x81(s,\xe2\x80\x89t):  where  is obtained from string s, by applying left circular shift i times. For example, \xcf\x81(""AGC"",\xe2\x80\x89""CGT"")\xe2\x80\x89=\xe2\x80\x89 h(""AGC"",\xe2\x80\x89""CGT"")\xe2\x80\x89+\xe2\x80\x89h(""AGC"",\xe2\x80\x89""GTC"")\xe2\x80\x89+\xe2\x80\x89h(""AGC"",\xe2\x80\x89""TCG"")\xe2\x80\x89+\xe2\x80\x89 h(""GCA"",\xe2\x80\x89""CGT"")\xe2\x80\x89+\xe2\x80\x89h(""GCA"",\xe2\x80\x89""GTC"")\xe2\x80\x89+\xe2\x80\x89h(""GCA"",\xe2\x80\x89""TCG"")\xe2\x80\x89+\xe2\x80\x89 h(""CAG"",\xe2\x80\x89""CGT"")\xe2\x80\x89+\xe2\x80\x89h(""CAG"",\xe2\x80\x89""GTC"")\xe2\x80\x89+\xe2\x80\x89h(""CAG"",\xe2\x80\x89""TCG"")\xe2\x80\x89=\xe2\x80\x89 1\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x890\xe2\x80\x89+\xe2\x80\x890\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x890\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89=\xe2\x80\x896Vasya found a string s of length n on the Internet. Now he wants to count how many strings t there are such that the Vasya distance from the string s attains maximum possible value. Formally speaking, t must satisfy the equation: .Vasya could not try all possible strings to find an answer, so he needs your help. As the answer may be very large, count the number of such strings modulo 109\xe2\x80\x89+\xe2\x80\x897." 1500

520B "Two Buttons" "dfs and similar,graphs,greedy,implementation,math,shortest paths" "Vasya has found a strange device. On the front panel of a device there are: a red button, a blue button and a display showing some positive integer. After clicking the red button, device multiplies the displayed number by two. After clicking the blue button, device subtracts one from the number on the display. If at some point the number stops being positive, the device breaks down. The display can show arbitrarily large numbers. Initially, the display shows number n.Bob wants to get number m on the display. What minimum number of clicks he has to make in order to achieve this result?" 1400

520A Pangram implementation,strings "A word or a sentence in some language is called a pangram if all the characters of the alphabet of this language appear in it at least once. Pangrams are often used to demonstrate fonts in printing or test the output devices.You are given a string consisting of lowercase and uppercase Latin letters. Check whether this string is a pangram. We say that the string contains a letter of the Latin alphabet if this letter occurs in the string in uppercase or lowercase." 800

519E "A and B and Lecture Rooms" "binary search,data structures,dfs and similar,dp,trees" "A and B are preparing themselves for programming contests.The University where A and B study is a set of rooms connected by corridors. Overall, the University has n rooms connected by n\xe2\x80\x89-\xe2\x80\x891 corridors so that you can get from any room to any other one by moving along the corridors. The rooms are numbered from 1 to n.Every day \xd0\x90 and B write contests in some rooms of their university, and after each contest they gather together in the same room and discuss problems. A and B want the distance from the rooms where problems are discussed to the rooms where contests are written to be equal. The distance between two rooms is the number of edges on the shortest path between them.As they write contests in new rooms every day, they asked you to help them find the number of possible rooms to discuss problems for each of the following m days." 2100

519D "A and B and Interesting Substrings" "data structures,dp,two pointers" "A and B are preparing themselves for programming contests.After several years of doing sports programming and solving many problems that require calculating all sorts of abstract objects, A and B also developed rather peculiar tastes.A likes lowercase letters of the Latin alphabet. He has assigned to each letter a number that shows how much he likes that letter (he has assigned negative numbers to the letters he dislikes). B likes substrings. He especially likes the ones that start and end with the same letter (their length must exceed one).Also, A and B have a string s. Now they are trying to find out how many substrings t of a string s are interesting to B (that is, t starts and ends with the same letter and its length is larger than one), and also the sum of values of all letters (assigned by A), except for the first and the last one is equal to zero.Naturally, A and B have quickly found the number of substrings t that are interesting to them. Can you do it?" 1800

519C "A and B and Team Training" "greedy,implementation,math,number theory" "A and B are preparing themselves for programming contests.An important part of preparing for a competition is sharing programming knowledge from the experienced members to those who are just beginning to deal with the contests. Therefore, during the next team training A decided to make teams so that newbies are solving problems together with experienced participants.A believes that the optimal team of three people should consist of one experienced participant and two newbies. Thus, each experienced participant can share the experience with a large number of people.However, B believes that the optimal team should have two experienced members plus one newbie. Thus, each newbie can gain more knowledge and experience.As a result, A and B have decided that all the teams during the training session should belong to one of the two types described above. Furthermore, they agree that the total number of teams should be as much as possible.There are n experienced members and m newbies on the training session. Can you calculate what maximum number of teams can be formed?" 1300

519B "A and B and Compilation Errors" "data structures,implementation,sortings" "A and B are preparing themselves for programming contests.B loves to debug his code. But before he runs the solution and starts debugging, he has to first compile the code.Initially, the compiler displayed n compilation errors, each of them is represented as a positive integer. After some effort, B managed to fix some mistake and then another one mistake.However, despite the fact that B is sure that he corrected the two errors, he can not understand exactly what compilation errors disappeared \xe2\x80\x94 the compiler of the language which B uses shows errors in the new order every time! B is sure that unlike many other programming languages, compilation errors for his programming language do not depend on each other, that is, if you correct one error, the set of other error does not change.Can you help B find out exactly what two errors he corrected?" 1100

519A "A and B and Chess" implementation "A and B are preparing themselves for programming contests.To train their logical thinking and solve problems better, A and B decided to play chess. During the game A wondered whose position is now stronger.For each chess piece we know its weight:   the queen\'s weight is 9,  the rook\'s weight is 5,  the bishop\'s weight is 3,  the knight\'s weight is 3,  the pawn\'s weight is 1,  the king\'s weight isn\'t considered in evaluating position. The player\'s weight equals to the sum of weights of all his pieces on the board.As A doesn\'t like counting, he asked you to help him determine which player has the larger position weight." 900

518F "Pasha and Pipe" "binary search,brute force,combinatorics,dp,implementation" "On a certain meeting of a ruling party ""A"" minister Pavel suggested to improve the sewer system and to create a new pipe in the city.The city is an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m rectangular squared field. Each square of the field is either empty (then the pipe can go in it), or occupied (the pipe cannot go in such square). Empty squares are denoted by character \'.\', occupied squares are denoted by character \'#\'.The pipe must meet the following criteria:  the pipe is a polyline of width 1,  the pipe goes in empty squares,  the pipe starts from the edge of the field, but not from a corner square,  the pipe ends at the edge of the field but not in a corner square,  the pipe has at most 2 turns (90 degrees),  the border squares of the field must share exactly two squares with the pipe,  if the pipe looks like a single segment, then the end points of the pipe must lie on distinct edges of the field,  for each non-border square of the pipe there are exacly two side-adjacent squares that also belong to the pipe,  for each border square of the pipe there is exactly one side-adjacent cell that also belongs to the pipe. Here are some samples of allowed piping routes:            ....#            ....#            .*..#           *****            ****.            .***.           ..#..            ..#*.            ..#*.           #...#            #..*#            #..*#           .....            ...*.            ...*.Here are some samples of forbidden piping routes:            .**.#            *...#            .*.*#           .....            ****.            .*.*.           ..#..            ..#*.            .*#*.           #...#            #..*#            #*.*#           .....            ...*.            .***.In these samples the pipes are represented by characters \'\xe2\x80\x89*\xe2\x80\x89\'.You were asked to write a program that calculates the number of distinct ways to make exactly one pipe in the city. The two ways to make a pipe are considered distinct if they are distinct in at least one square." 2300

518E "Arthur and Questions" "greedy,implementation,math,ternary search" "After bracket sequences Arthur took up number theory. He has got a new favorite sequence of length n (a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an), consisting of integers and integer k, not exceeding n.This sequence had the following property: if you write out the sums of all its segments consisting of k consecutive elements (a1�\xe2\x80\x89+\xe2\x80\x89�a2�...�\xe2\x80\x89+\xe2\x80\x89�ak,\xe2\x80\x89�a2�\xe2\x80\x89+\xe2\x80\x89�a3�\xe2\x80\x89+\xe2\x80\x89�...�\xe2\x80\x89+\xe2\x80\x89�ak\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89�...,\xe2\x80\x89�an\xe2\x80\x89-\xe2\x80\x89k\xe2\x80\x89+\xe2\x80\x891�\xe2\x80\x89+\xe2\x80\x89�an\xe2\x80\x89-\xe2\x80\x89k\xe2\x80\x89+\xe2\x80\x892�\xe2\x80\x89+\xe2\x80\x89�...�\xe2\x80\x89+\xe2\x80\x89�an), then those numbers will form strictly increasing sequence.For example, for the following sample: n\xe2\x80\x89=\xe2\x80\x895,\xe2\x80\x89�k\xe2\x80\x89=\xe2\x80\x893,\xe2\x80\x89�a\xe2\x80\x89=\xe2\x80\x89(1,\xe2\x80\x89�2,\xe2\x80\x89�4,\xe2\x80\x89�5,\xe2\x80\x89�6) the sequence of numbers will look as follows: (1�\xe2\x80\x89+\xe2\x80\x89�2�\xe2\x80\x89+\xe2\x80\x89�4,\xe2\x80\x89�2�\xe2\x80\x89+\xe2\x80\x89�4�\xe2\x80\x89+\xe2\x80\x89�5,\xe2\x80\x89�4�\xe2\x80\x89+\xe2\x80\x89�5�\xe2\x80\x89+\xe2\x80\x89�6)�=�(7,\xe2\x80\x89�11,\xe2\x80\x89�15), that means that sequence a meets the described property. Obviously the sequence of sums will have n\xe2\x80\x89-\xe2\x80\x89k\xe2\x80\x89+\xe2\x80\x891 elements.Somebody (we won\'t say who) replaced some numbers in Arthur\'s sequence by question marks (if this number is replaced, it is replaced by exactly one question mark). We need to restore the sequence so that it meets the required property and also minimize the sum |ai|, where |ai| is the absolute value of ai." 2200

518D "Ilya and Escalator" combinatorics,dp,math,probabilities "Ilya got tired of sports programming, left university and got a job in the subway. He was given the task to determine the escalator load factor. Let\'s assume that n people stand in the queue for the escalator. At each second one of the two following possibilities takes place: either the first person in the queue enters the escalator with probability p, or the first person in the queue doesn\'t move with probability (1\xe2\x80\x89-\xe2\x80\x89p), paralyzed by his fear of escalators and making the whole queue wait behind him.Formally speaking, the i-th person in the queue cannot enter the escalator until people with indices from 1 to i\xe2\x80\x89-\xe2\x80\x891 inclusive enter it. In one second only one person can enter the escalator. The escalator is infinite, so if a person enters it, he never leaves it, that is he will be standing on the escalator at any following second. Ilya needs to count the expected value of the number of people standing on the escalator after t seconds. Your task is to help him solve this complicated task." 1700

518C "Anya and Smartphone" "constructive algorithms,data structures,implementation" "Anya has bought a new smartphone that uses Berdroid operating system. The smartphone menu has exactly n applications, each application has its own icon. The icons are located on different screens, one screen contains k icons. The icons from the first to the k-th one are located on the first screen, from the (k\xe2\x80\x89+\xe2\x80\x891)-th to the 2k-th ones are on the second screen and so on (the last screen may be partially empty).Initially the smartphone menu is showing the screen number 1. To launch the application with the icon located on the screen t, Anya needs to make the following gestures: first she scrolls to the required screen number t, by making t\xe2\x80\x89-\xe2\x80\x891 gestures (if the icon is on the screen t), and then make another gesture \xe2\x80\x94 press the icon of the required application exactly once to launch it.After the application is launched, the menu returns to the first screen. That is, to launch the next application you need to scroll through the menu again starting from the screen number 1.All applications are numbered from 1 to n. We know a certain order in which the icons of the applications are located in the menu at the beginning, but it changes as long as you use the operating system. Berdroid is intelligent system, so it changes the order of the icons by moving the more frequently used icons to the beginning of the list. Formally, right after an application is launched, Berdroid swaps the application icon and the icon of a preceding application (that is, the icon of an application on the position that is smaller by one in the order of menu). The preceding icon may possibly be located on the adjacent screen. The only exception is when the icon of the launched application already occupies the first place, in this case the icon arrangement doesn\'t change.Anya has planned the order in which she will launch applications. How many gestures should Anya make to launch the applications in the planned order? Note that one application may be launched multiple times." 1600

518B "Tanya and Postcard" greedy,implementation,strings "Little Tanya decided to present her dad a postcard on his Birthday. She has already created a message \xe2\x80\x94 string s of length n, consisting of uppercase and lowercase English letters. Tanya can\'t write yet, so she found a newspaper and decided to cut out the letters and glue them into the postcard to achieve string s. The newspaper contains string t, consisting of uppercase and lowercase English letters. We know that the length of string t greater or equal to the length of the string s.The newspaper may possibly have too few of some letters needed to make the text and too many of some other letters. That\'s why Tanya wants to cut some n letters out of the newspaper and make a message of length exactly n, so that it looked as much as possible like s. If the letter in some position has correct value and correct letter case (in the string s and in the string that Tanya will make), then she shouts joyfully ""YAY!"", and if the letter in the given position has only the correct value but it is in the wrong case, then the girl says ""WHOOPS"".Tanya wants to make such message that lets her shout ""YAY!"" as much as possible. If there are multiple ways to do this, then her second priority is to maximize the number of times she says ""WHOOPS"". Your task is to help Tanya make the message." 1400

518A "Vitaly and Strings" "constructive algorithms,strings" "Vitaly is a diligent student who never missed a lesson in his five years of studying in the university. He always does his homework on time and passes his exams in time. During the last lesson the teacher has provided two strings s and t to Vitaly. The strings have the same length, they consist of lowercase English letters, string s is lexicographically smaller than string t. Vitaly wondered if there is such string that is lexicographically larger than string s and at the same is lexicographically smaller than string t. This string should also consist of lowercase English letters and have the length equal to the lengths of strings s and t. Let\'s help Vitaly solve this easy problem!" 1600

516E "Drazil and His Happy Friends" "math,number theory" "Drazil has many friends. Some of them are happy and some of them are unhappy. Drazil wants to make all his friends become happy. So he invented the following plan.There are n boys and m girls among his friends. Let\'s number them from 0 to n\xe2\x80\x89-\xe2\x80\x891 and 0 to m\xe2\x80\x89-\xe2\x80\x891 separately. In i-th day, Drazil invites -th boy and -th girl to have dinner together (as Drazil is programmer, i starts from 0). If one of those two people is happy, the other one will also become happy. Otherwise, those two people remain in their states. Once a person becomes happy (or if it is happy originally), he stays happy forever.Drazil wants to know on which day all his friends become happy or to determine if they won\'t become all happy at all." 3100

516D "Drazil and Morning Exercise" "dfs and similar,dp,dsu,trees,two pointers" "Drazil and Varda are the earthworm couple. They want to find a good place to bring up their children. They found a good ground containing nature hole. The hole contains many rooms, some pairs of rooms are connected by small tunnels such that earthworm can move between them.Let\'s consider rooms and small tunnels as the vertices and edges in a graph. This graph is a tree. In the other words, any pair of vertices has an unique path between them.Each room that is leaf in the graph is connected with a ground by a vertical tunnel. Here, leaf is a vertex that has only one outgoing edge in the graph.Each room is large enough only to fit one earthworm living in it. Earthworm can\'t live in a tunnel.Drazil and Varda have a plan to educate their children. They want all their children to do morning exercises immediately after getting up!When the morning is coming, all earthworm children get up in the same time, then each of them chooses the farthest path to the ground for gathering with others (these children are lazy, so they all want to do exercises as late as possible).Drazil and Varda want the difference between the time first earthworm child arrives outside and the time the last earthworm child arrives outside to be not larger than l (otherwise children will spread around the ground and it will be hard to keep them exercising together).Also, The rooms that are occupied by their children should form a connected set. In the other words, for any two rooms that are occupied with earthworm children, all rooms that lie on the path between them should be occupied with earthworm children too.How many children Drazil and Varda may have at most in order to satisfy all conditions above? Drazil and Varda want to know the answer for many different choices of l.(Drazil and Varda don\'t live in the hole with their children)" 2800

515E "Drazil and Park" "data structures" "Drazil is a monkey. He lives in a circular park. There are n trees around the park. The distance between the i-th tree and (i\xe2\x80\x89+\xe2\x80\x891)-st trees is di, the distance between the n-th tree and the first tree is dn. The height of the i-th tree is hi.Drazil starts each day with the morning run. The morning run consists of the following steps:  Drazil chooses two different trees  He starts with climbing up the first tree  Then he climbs down the first tree, runs around the park (in one of two possible directions) to the second tree, and climbs on it  Then he finally climbs down the second tree. But there are always children playing around some consecutive trees. Drazil can\'t stand children, so he can\'t choose the trees close to children. He even can\'t stay close to those trees.If the two trees Drazil chooses are x-th and y-th, we can estimate the energy the morning run takes to him as 2(hx\xe2\x80\x89+\xe2\x80\x89hy)\xe2\x80\x89+\xe2\x80\x89dist(x,\xe2\x80\x89y). Since there are children on exactly one of two arcs connecting x and y, the distance dist(x,\xe2\x80\x89y) between trees x and y is uniquely defined.Now, you know that on the i-th day children play between ai-th tree and bi-th tree. More formally, if ai\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89bi, children play around the trees with indices from range [ai,\xe2\x80\x89bi], otherwise they play around the trees with indices from .Please help Drazil to determine which two trees he should choose in order to consume the most energy (since he wants to become fit and cool-looking monkey) and report the resulting amount of energy for each day." 2300

515D "Drazil and Tiles" "constructive algorithms,greedy" "Drazil created a following problem about putting 1\xe2\x80\x89\xc3\x97\xe2\x80\x892 tiles into an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m grid:""There is a grid with some cells that are empty and some cells that are occupied. You should use 1\xe2\x80\x89\xc3\x97\xe2\x80\x892 tiles to cover all empty cells and no two tiles should cover each other. And you should print a solution about how to do it.""But Drazil doesn\'t like to write special checking program for this task. His friend, Varda advised him: ""how about asking contestant only to print the solution when it exists and it is unique? Otherwise contestant may print \'Not unique\' "".Drazil found that the constraints for this task may be much larger than for the original task!Can you solve this new problem?Note that you should print \'Not unique\' either when there exists no solution or when there exists several different solutions for the original task." 2000

515C "Drazil and Factorial" greedy,math,sortings "Drazil is playing a math game with Varda.Let\'s define  for positive integer x as a product of factorials of its digits. For example, .First, they choose a decimal number a consisting of n digits that contains at least one digit larger than 1. This number may possibly start with leading zeroes. Then they should find maximum positive number x satisfying following two conditions:1. x doesn\'t contain neither digit 0 nor digit 1.2.  = .Help friends find such number." 1400

515B "Drazil and His Happy Friends" "brute force,dsu,meet-in-the-middle,number theory" "Drazil has many friends. Some of them are happy and some of them are unhappy. Drazil wants to make all his friends become happy. So he invented the following plan.There are n boys and m girls among his friends. Let\'s number them from 0 to n\xe2\x80\x89-\xe2\x80\x891 and 0 to m\xe2\x80\x89-\xe2\x80\x891 separately. In i-th day, Drazil invites -th boy and -th girl to have dinner together (as Drazil is programmer, i starts from 0). If one of those two people is happy, the other one will also become happy. Otherwise, those two people remain in their states. Once a person becomes happy (or if it is happy originally), he stays happy forever.Drazil wants to know on which day all his friends become happy or to determine if they won\'t become all happy at all." 1300

515A "Drazil and Date" math "Someday, Drazil wanted to go on date with Varda. Drazil and Varda live on Cartesian plane. Drazil\'s home is located in point (0,\xe2\x80\x890) and Varda\'s home is located in point (a,\xe2\x80\x89b). In each step, he can move in a unit distance in horizontal or vertical direction. In other words, from position (x,\xe2\x80\x89y) he can go to positions (x\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89y), (x\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89y), (x,\xe2\x80\x89y\xe2\x80\x89+\xe2\x80\x891) or (x,\xe2\x80\x89y\xe2\x80\x89-\xe2\x80\x891). Unfortunately, Drazil doesn\'t have sense of direction. So he randomly chooses the direction he will go to in each step. He may accidentally return back to his house during his travel. Drazil may even not notice that he has arrived to (a,\xe2\x80\x89b) and continue travelling. Luckily, Drazil arrived to the position (a,\xe2\x80\x89b) successfully. Drazil said to Varda: ""It took me exactly s steps to travel from my house to yours"". But Varda is confused about his words, she is not sure that it is possible to get from (0,\xe2\x80\x890) to (a,\xe2\x80\x89b) in exactly s steps. Can you find out if it is possible for Varda?" 1000

514E "Darth Vader and Tree" dp,matrices "When Darth Vader gets bored, he sits down on the sofa, closes his eyes and thinks of an infinite rooted tree where each node has exactly n sons, at that for each node, the distance between it an its i-th left child equals to di. The Sith Lord loves counting the number of nodes in the tree that are at a distance at most x from the root. The distance is the sum of the lengths of edges on the path between nodes.But he has got used to this activity and even grew bored of it. \'Why does he do that, then?\' \xe2\x80\x94 you may ask. It\'s just that he feels superior knowing that only he can solve this problem. Do you want to challenge Darth Vader himself? Count the required number of nodes. As the answer can be rather large, find it modulo 109\xe2\x80\x89+\xe2\x80\x897." 2200

514D "R2D2 and Droid Army" "binary search,data structures,two pointers" "An army of n droids is lined up in one row. Each droid is described by m integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89am, where ai is the number of details of the i-th type in this droid\'s mechanism. R2-D2 wants to destroy the sequence of consecutive droids of maximum length. He has m weapons, the i-th weapon can affect all the droids in the army by destroying one detail of the i-th type (if the droid doesn\'t have details of this type, nothing happens to it). A droid is considered to be destroyed when all of its details are destroyed. R2-D2 can make at most k shots. How many shots from the weapon of what type should R2-D2 make to destroy the sequence of consecutive droids of maximum length?" 2000

514C "Watto and Mechanism" "binary search,data structures,hashing,string suffix structures,strings" "Watto, the owner of a spare parts store, has recently got an order for the mechanism that can process strings in a certain way. Initially the memory of the mechanism is filled with n strings. Then the mechanism should be able to process queries of the following type: ""Given string s, determine if the memory of the mechanism contains string t that consists of the same number of characters as s and differs from s in exactly one position"".Watto has already compiled the mechanism, all that\'s left is to write a program for it and check it on the data consisting of n initial lines and m queries. He decided to entrust this job to you." 2000

514B "Han Solo and Lazer Gun" "brute force,data structures,geometry,implementation,math" "There are n Imperial stormtroopers on the field. The battle field is a plane with Cartesian coordinate system. Each stormtrooper is associated with his coordinates (x,\xe2\x80\x89y) on this plane. Han Solo has the newest duplex lazer gun to fight these stormtroopers. It is situated at the point (x0,\xe2\x80\x89y0). In one shot it can can destroy all the stormtroopers, situated on some line that crosses point (x0,\xe2\x80\x89y0).Your task is to determine what minimum number of shots Han Solo needs to defeat all the stormtroopers.The gun is the newest invention, it shoots very quickly and even after a very large number of shots the stormtroopers don\'t have enough time to realize what\'s happening and change their location." 1400

514A "Chewba\xd1\x81ca and Number" greedy,implementation "There are n Imperial stormtroopers on the field. The battle field is a plane with Cartesian coordinate system. Each stormtrooper is associated with his coordinates (x,\xe2\x80\x89y) on this plane. Han Solo has the newest duplex lazer gun to fight these stormtroopers. It is situated at the point (x0,\xe2\x80\x89y0). In one shot it can can destroy all the stormtroopers, situated on some line that crosses point (x0,\xe2\x80\x89y0).Your task is to determine what minimum number of shots Han Solo needs to defeat all the stormtroopers.The gun is the newest invention, it shoots very quickly and even after a very large number of shots the stormtroopers don\'t have enough time to realize what\'s happening and change their location." 1200

513G3 "Inversions problem" dp "You are given a permutation of n numbers p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pn. We perform k operations of the following type: choose uniformly at random two indices l and r (l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r) and reverse the order of the elements pl,\xe2\x80\x89pl\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89pr. Your task is to find the expected value of the number of inversions in the resulting permutation." 3100

513G2 "Inversions problem" dp,probabilities "You are given a permutation of n numbers p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pn. We perform k operations of the following type: choose uniformly at random two indices l and r (l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r) and reverse the order of the elements pl,\xe2\x80\x89pl\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89pr. Your task is to find the expected value of the number of inversions in the resulting permutation." 2400

513G1 "Inversions problem" "brute force,dfs and similar,dp,meet-in-the-middle" "You are given a permutation of n numbers p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pn. We perform k operations of the following type: choose uniformly at random two indices l and r (l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r) and reverse the order of the elements pl,\xe2\x80\x89pl\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89pr. Your task is to find the expected value of the number of inversions in the resulting permutation." 1800

513F2 Scaygerboss flows "Cthulhu decided to catch Scaygerboss. Scaygerboss found it out and is trying to hide in a pack of his scaygers. Each scayger except Scaygerboss is either a male or a female. Scaygerboss\'s gender is ""other"".Scaygers are scattered on a two-dimensional map divided into cells. A scayger looks nerdy and loveable if it is staying in the same cell with exactly one scayger of a gender that is different from its own gender. Cthulhu will not be able to catch Scaygerboss if all the scaygers on the map look nerdy and loveable.The scaygers can move around at different speeds. For each scayger, we are given the time it takes this scayger to move from a cell to an adjacent cell. Cells are adjacent if they share a common side. At any point of time, each cell that does not contain an obstacle can be occupied by an arbitrary number of scaygers. Scaygers cannot move to cells with obstacles.Calculate minimal time in order to make all scaygers look nerdy and loveable if they move optimally toward this goal." 2800

513F1 Scaygerboss flows "Cthulhu decided to catch Scaygerboss. Scaygerboss found it out and is trying to hide in a pack of his scaygers. Each scayger except Scaygerboss is either a male or a female. Scaygerboss\'s gender is ""other"".Scaygers are scattered on a two-dimensional map divided into cells. A scayger looks nerdy and loveable if it is staying in the same cell with exactly one scayger of a gender that is different from its own gender. Cthulhu will not be able to catch Scaygerboss if all the scaygers on the map look nerdy and loveable.The scaygers can move around at different speeds. For each scayger, we are given the time it takes this scayger to move from a cell to an adjacent cell. Cells are adjacent if they share a common side. At any point of time, each cell that does not contain an obstacle can be occupied by an arbitrary number of scaygers. Scaygers cannot move to cells with obstacles.Calculate minimal time in order to make all scaygers look nerdy and loveable if they move optimally toward this goal." 2700

513E2 "Subarray Cuts" dp "You are given an array of length n and a number k. Let\'s pick k non-overlapping non-empty subarrays of the initial array. Let si be the sum of the i-th subarray in order from left to right. Compute the maximum value of the following expression: |s1\xe2\x80\x89-\xe2\x80\x89s2|\xe2\x80\x89+\xe2\x80\x89|s2\xe2\x80\x89-\xe2\x80\x89s3|\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89|sk\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89-\xe2\x80\x89sk|Here subarray is a contiguous part of an array." 2700

513E1 "Subarray Cuts" dp "You are given an array of length n and a number k. Let\'s pick k non-overlapping non-empty subarrays of the initial array. Let si be the sum of the i-th subarray in order from left to right. Compute the maximum value of the following expression: |s1\xe2\x80\x89-\xe2\x80\x89s2|\xe2\x80\x89+\xe2\x80\x89|s2\xe2\x80\x89-\xe2\x80\x89s3|\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89|sk\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89-\xe2\x80\x89sk|Here subarray is a contiguous part of an array." 2600

513D2 "Constrained Tree" "constructive algorithms,data structures" "You need to find a binary tree of size n that satisfies a given set of c constraints. Suppose that the nodes of the unknown binary tree are labeled using a pre-order traversal starting with 1. For the i-th constraint you are given two labels, ai and bi and a direction, left or right. In case of left direction, bi is an element of the subtree rooted at ai\'s left child. Similarly in the case of right direction bi is an element of the subtree rooted at ai\'s right child." 2600

513D1 "Constrained Tree" "dfs and similar" "You need to find a binary tree of size n that satisfies a given set of c constraints. Suppose that the nodes of the unknown binary tree are labeled using a pre-order traversal starting with 1. For the i-th constraint you are given two labels, ai and bi and a direction, left or right. In case of left direction, bi is an element of the subtree rooted at ai\'s left child. Similarly in the case of right direction bi is an element of the subtree rooted at ai\'s right child." 2400

513C "Second price auction" bitmasks,probabilities "Nowadays, most of the internet advertisements are not statically linked to a web page. Instead, what will be shown to the person opening a web page is determined within 100 milliseconds after the web page is opened. Usually, multiple companies compete for each ad slot on the web page in an auction. Each of them receives a request with details about the user, web page and ad slot and they have to respond within those 100 milliseconds with a bid they would pay for putting an advertisement on that ad slot. The company that suggests the highest bid wins the auction and gets to place its advertisement. If there are several companies tied for the highest bid, the winner gets picked at random.However, the company that won the auction does not have to pay the exact amount of its bid. In most of the cases, a second-price auction is used. This means that the amount paid by the company is equal to the maximum of all the other bids placed for this ad slot.Let\'s consider one such bidding. There are n companies competing for placing an ad. The i-th of these companies will bid an integer number of microdollars equiprobably randomly chosen from the range between Li and Ri, inclusive. In the other words, the value of the i-th company bid can be any integer from the range [Li,\xe2\x80\x89Ri] with the same probability. Determine the expected value that the winner will have to pay in a second-price auction." 2000

513B2 Permutations "bitmasks,divide and conquer,math" "You are given a permutation p of numbers 1,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89n. Let\'s define f(p) as the following sum:Find the lexicographically m-th permutation of length n in the set of permutations having the maximum possible value of f(p)." 1800

513B1 Permutations "brute force" "You are given a permutation p of numbers 1,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89n. Let\'s define f(p) as the following sum:Find the lexicographically m-th permutation of length n in the set of permutations having the maximum possible value of f(p)." 1400

513A Game "constructive algorithms,math" "Two players play a simple game. Each player is provided with a box with balls. First player\'s box contains exactly n1 balls and second player\'s box contains exactly n2 balls. In one move first player can take from 1 to k1 balls from his box and throw them away. Similarly, the second player can take from 1 to k2 balls from his box in his move. Players alternate turns and the first player starts the game. The one who can\'t make a move loses. Your task is to determine who wins if both players play optimally." 800

512E "Fox And Polygon" "constructive algorithms,divide and conquer" "Fox Ciel just designed a puzzle game called ""Polygon""! It is played using triangulations of a regular n-edge polygon. The goal is to transform one triangulation to another by some tricky rules.Triangulation of an n-edge poylgon is a set of n\xe2\x80\x89-\xe2\x80\x893 diagonals satisfying the condition that no two diagonals share a common internal point.For example, the initial state of the game may look like (a) in above figure. And your goal may look like (c). In each step you can choose a diagonal inside the polygon (but not the one of edges of the polygon) and flip this diagonal. Suppose you are going to flip a diagonal a\xe2\x80\x89\xe2\x80\x93\xe2\x80\x89b. There always exist two triangles sharing a\xe2\x80\x89\xe2\x80\x93\xe2\x80\x89b as a side, let\'s denote them as a\xe2\x80\x89\xe2\x80\x93\xe2\x80\x89b\xe2\x80\x89\xe2\x80\x93\xe2\x80\x89c and a\xe2\x80\x89\xe2\x80\x93\xe2\x80\x89b\xe2\x80\x89\xe2\x80\x93\xe2\x80\x89d. As a result of this operation, the diagonal a\xe2\x80\x89\xe2\x80\x93\xe2\x80\x89b is replaced by a diagonal c\xe2\x80\x89\xe2\x80\x93\xe2\x80\x89d. It can be easily proven that after flip operation resulting set of diagonals is still a triangulation of the polygon.So in order to solve above case, you may first flip diagonal 6\xe2\x80\x89\xe2\x80\x93\xe2\x80\x893, it will be replaced by diagonal 2\xe2\x80\x89\xe2\x80\x93\xe2\x80\x894. Then you flip diagonal 6\xe2\x80\x89\xe2\x80\x93\xe2\x80\x894 and get figure (c) as result.Ciel just proved that for any starting and destination triangulations this game has a solution. She wants you to solve it in no more than 20\xe2\x80\x89000 steps for any puzzle satisfying n\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x891000." 2900

512D "Fox And Travelling" dp,trees "Fox Ciel is going to travel to New Foxland during this summer.New Foxland has n attractions that are linked by m undirected roads. Two attractions are called adjacent if they are linked by a road. Fox Ciel has k days to visit this city and each day she will visit exactly one attraction.There is one important rule in New Foxland: you can\'t visit an attraction if it has more than one adjacent attraction that you haven\'t visited yet.At the beginning Fox Ciel haven\'t visited any attraction. During her travelling she may move aribtrarly between attraction. After visiting attraction a, she may travel to any attraction b satisfying conditions above that hasn\'t been visited yet, even if it is not reachable from a by using the roads (Ciel uses boat for travelling between attractions, so it is possible). She wants to know how many different travelling plans she can make. Calculate this number modulo 109\xe2\x80\x89+\xe2\x80\x899 for every k from 0 to n since she hasn\'t decided for how many days she is visiting New Foxland." 2900

510E "Fox And Dinner" flows "Fox Ciel is participating in a party in Prime Kingdom. There are n foxes there (include Fox Ciel). The i-th fox is ai years old.They will have dinner around some round tables. You want to distribute foxes such that:  Each fox is sitting at some table.  Each table has at least 3 foxes sitting around it.  The sum of ages of any two adjacent foxes around each table should be a prime number. If k foxes f1, f2, ..., fk are sitting around table in clockwise order, then for 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k\xe2\x80\x89-\xe2\x80\x891: fi and fi\xe2\x80\x89+\xe2\x80\x891 are adjacent, and f1 and fk are also adjacent.If it is possible to distribute the foxes in the desired manner, find out a way to do that." 2300

510D "Fox And Jumping" "bitmasks,brute force,dp,math" "Fox Ciel is playing a game. In this game there is an infinite long tape with cells indexed by integers (positive, negative and zero). At the beginning she is standing at the cell 0.There are also n cards, each card has 2 attributes: length li and cost ci. If she pays ci dollars then she can apply i-th card. After applying i-th card she becomes able to make jumps of length li, i. e. from cell x to cell (x\xe2\x80\x89-\xe2\x80\x89li) or cell (x\xe2\x80\x89+\xe2\x80\x89li).She wants to be able to jump to any cell on the tape (possibly, visiting some intermediate cells). For achieving this goal, she wants to buy some cards, paying as little money as possible. If this is possible, calculate the minimal cost." 1900

510C "Fox And Names" "dfs and similar,graphs,sortings" "Fox Ciel is going to publish a paper on FOCS (Foxes Operated Computer Systems, pronounce: ""Fox""). She heard a rumor: the authors list on the paper is always sorted in the lexicographical order. After checking some examples, she found out that sometimes it wasn\'t true. On some papers authors\' names weren\'t sorted in lexicographical order in normal sense. But it was always true that after some modification of the order of letters in alphabet, the order of authors becomes lexicographical!She wants to know, if there exists an order of letters in Latin alphabet such that the names on the paper she is submitting are following in the lexicographical order. If so, you should find out any such order.Lexicographical order is defined in following way. When we compare s and t, first we find the leftmost position with differing characters: si\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89ti. If there is no such position (i. e. s is a prefix of t or vice versa) the shortest string is less. Otherwise, we compare characters si and ti according to their order in alphabet." 1600

510B "Fox And Two Dots" "dfs and similar" "Fox Ciel is playing a mobile puzzle game called ""Two Dots"". The basic levels are played on a board of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m cells, like this:Each cell contains a dot that has some color. We will use different uppercase Latin characters to express different colors.The key of this game is to find a cycle that contain dots of same color. Consider 4 blue dots on the picture forming a circle as an example. Formally, we call a sequence of dots d1,\xe2\x80\x89d2,\xe2\x80\x89...,\xe2\x80\x89dk a cycle if and only if it meets the following condition:  These k dots are different: if i\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89j then di is different from dj.  k is at least 4.  All dots belong to the same color.  For all 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k\xe2\x80\x89-\xe2\x80\x891: di and di\xe2\x80\x89+\xe2\x80\x891 are adjacent. Also, dk and d1 should also be adjacent. Cells x and y are called adjacent if they share an edge. Determine if there exists a cycle on the field." 1500

510A "Fox And Snake" implementation "Fox Ciel starts to learn programming. The first task is drawing a fox! However, that turns out to be too hard for a beginner, so she decides to draw a snake instead.A snake is a pattern on a n by m table. Denote c-th cell of r-th row as (r,\xe2\x80\x89c). The tail of the snake is located at (1,\xe2\x80\x891), then it\'s body extends to (1,\xe2\x80\x89m), then goes down 2 rows to (3,\xe2\x80\x89m), then goes left to (3,\xe2\x80\x891) and so on.Your task is to draw this snake for Fox Ciel: the empty cells should be represented as dot characters (\'.\') and the snake cells should be filled with number signs (\'#\').Consider sample tests in order to understand the snake pattern." 800

509F "Progress Monitoring" dp,trees "Programming teacher Dmitry Olegovich is going to propose the following task for one of his tests for students:You are given a tree T with n vertices, specified by its adjacency matrix a[1... n,\xe2\x80\x891... n]. What is the output of the following pseudocode?used[1 ... n] = {0, ..., 0};procedure dfs(v):    print v;    used[v] = 1;    for i = 1, 2, ..., n:        if (a[v][i] == 1 and used[i] == 0):            dfs(i);dfs(1);In order to simplify the test results checking procedure, Dmitry Olegovich decided to create a tree T such that the result is his favorite sequence b. On the other hand, Dmitry Olegovich doesn\'t want to provide students with same trees as input, otherwise they might cheat. That\'s why Dmitry Olegovich is trying to find out the number of different trees T such that the result of running the above pseudocode with T as input is exactly the sequence b. Can you help him?Two trees with n vertices are called different if their adjacency matrices a1 and a2 are different, i. e. there exists a pair (i,\xe2\x80\x89j), such that 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i,\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n and a1[i][j]\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89a2[i][j]." 2300

509E "Pretty Song" math,strings "When Sasha was studying in the seventh grade, he started listening to music a lot. In order to evaluate which songs he likes more, he introduced the notion of the song\'s prettiness. The title of the song is a word consisting of uppercase Latin letters. The prettiness of the song is the prettiness of its title.Let\'s define the simple prettiness of a word as the ratio of the number of vowels in the word to the number of all letters in the word.Let\'s define the prettiness of a word as the sum of simple prettiness of all the substrings of the word.More formally, let\'s define the function vowel(c) which is equal to 1, if c is a vowel, and to 0 otherwise. Let si be the i-th character of string s, and si..j be the substring of word s, staring at the i-th character and ending at the j-th character (sisi\xe2\x80\x89+\xe2\x80\x891... sj, i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j).Then the simple prettiness of s is defined by the formula:The prettiness of s equals Find the prettiness of the given song title.We assume that the vowels are I,\xe2\x80\x89E,\xe2\x80\x89A,\xe2\x80\x89O,\xe2\x80\x89U,\xe2\x80\x89Y." 2000

509D "Restoring Numbers" "constructive algorithms,math" "Vasya had two arrays consisting of non-negative integers: a of size n and b of size m. Vasya chose a positive integer k and created an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m matrix v using the following formula:Vasya wrote down matrix v on a piece of paper and put it in the table.A year later Vasya was cleaning his table when he found a piece of paper containing an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m matrix w. He remembered making a matrix one day by the rules given above but he was not sure if he had found the paper with the matrix v from those days. Your task is to find out if the matrix w that you\'ve found could have been obtained by following these rules and if it could, then for what numbers k,\xe2\x80\x89a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an,\xe2\x80\x89b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bm it is possible." 2200

509C "Sums of Digits" dp,greedy,implementation "Vasya had a strictly increasing sequence of positive integers a1, ..., an. Vasya used it to build a new sequence b1, ..., bn, where bi is the sum of digits of ai\'s decimal representation. Then sequence ai got lost and all that remained is sequence bi.Vasya wonders what the numbers ai could be like. Of all the possible options he likes the one sequence with the minimum possible last number an. Help Vasya restore the initial sequence.It is guaranteed that such a sequence always exists." 2000

509B "Painting Pebbles" "constructive algorithms,greedy,implementation" "There are n piles of pebbles on the table, the i-th pile contains ai pebbles. Your task is to paint each pebble using one of the k given colors so that for each color c and any two piles i and j the difference between the number of pebbles of color c in pile i and number of pebbles of color c in pile j is at most one.In other words, let\'s say that bi,\xe2\x80\x89c is the number of pebbles of color c in the i-th pile. Then for any 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89c\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k, 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i,\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n the following condition must be satisfied |bi,\xe2\x80\x89c\xe2\x80\x89-\xe2\x80\x89bj,\xe2\x80\x89c|\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x891. It isn\'t necessary to use all k colors: if color c hasn\'t been used in pile i, then bi,\xe2\x80\x89c is considered to be zero." 1300

509A "Maximum in Table" "brute force,implementation" "An n\xe2\x80\x89\xc3\x97\xe2\x80\x89n table a is defined as follows:  The first row and the first column contain ones, that is: ai,\xe2\x80\x891\xe2\x80\x89=\xe2\x80\x89a1,\xe2\x80\x89i\xe2\x80\x89=\xe2\x80\x891 for all i\xe2\x80\x89=\xe2\x80\x891,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89n.  Each of the remaining numbers in the table is equal to the sum of the number above it and the number to the left of it. In other words, the remaining elements are defined by the formula ai,\xe2\x80\x89j\xe2\x80\x89=\xe2\x80\x89ai\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89j\xe2\x80\x89+\xe2\x80\x89ai,\xe2\x80\x89j\xe2\x80\x89-\xe2\x80\x891. These conditions define all the values in the table.You are given a number n. You need to determine the maximum value in the n\xe2\x80\x89\xc3\x97\xe2\x80\x89n table defined by the rules above." 800

508E "Arthur and Brackets" dp,greedy "Notice that the memory limit is non-standard.Recently Arthur and Sasha have studied correct bracket sequences. Arthur understood this topic perfectly and become so amazed about correct bracket sequences, so he even got himself a favorite correct bracket sequence of length 2n. Unlike Arthur, Sasha understood the topic very badly, and broke Arthur\'s favorite correct bracket sequence just to spite him.All Arthur remembers about his favorite sequence is for each opening parenthesis (\'(\') the approximate distance to the corresponding closing one (\')\'). For the i-th opening bracket he remembers the segment [li,\xe2\x80\x89ri], containing the distance to the corresponding closing bracket.Formally speaking, for the i-th opening bracket (in order from left to right) we know that the difference of its position and the position of the corresponding closing bracket belongs to the segment [li,\xe2\x80\x89ri].Help Arthur restore his favorite correct bracket sequence!" 2200

508D "Tanya and Password" "dfs and similar,graphs" "While dad was at work, a little girl Tanya decided to play with dad\'s password to his secret database. Dad\'s password is a string consisting of n\xe2\x80\x89+\xe2\x80\x892 characters. She has written all the possible n three-letter continuous substrings of the password on pieces of paper, one for each piece of paper, and threw the password out. Each three-letter substring was written the number of times it occurred in the password. Thus, Tanya ended up with n pieces of paper.Then Tanya realized that dad will be upset to learn about her game and decided to restore the password or at least any string corresponding to the final set of three-letter strings. You have to help her in this difficult task. We know that dad\'s password consisted of lowercase and uppercase letters of the Latin alphabet and digits. Uppercase and lowercase letters of the Latin alphabet are considered distinct." 2500

508C "Anya and Ghosts" "constructive algorithms,greedy" "Anya loves to watch horror movies. In the best traditions of horror, she will be visited by m ghosts tonight. Anya has lots of candles prepared for the visits, each candle can produce light for exactly t seconds. It takes the girl one second to light one candle. More formally, Anya can spend one second to light one candle, then this candle burns for exactly t seconds and then goes out and can no longer be used.For each of the m ghosts Anya knows the time at which it comes: the i-th visit will happen wi seconds after midnight, all wi\'s are distinct. Each visit lasts exactly one second.What is the minimum number of candles Anya should use so that during each visit, at least r candles are burning? Anya can start to light a candle at any time that is integer number of seconds from midnight, possibly, at the time before midnight. That means, she can start to light a candle integer number of seconds before midnight or integer number of seconds after a midnight, or in other words in any integer moment of time." 1600

508B "Anton and currency you all know" greedy,math,strings "Berland, 2016. The exchange rate of currency you all know against the burle has increased so much that to simplify the calculations, its fractional part was neglected and the exchange rate is now assumed to be an integer.Reliable sources have informed the financier Anton of some information about the exchange rate of currency you all know against the burle for tomorrow. Now Anton knows that tomorrow the exchange rate will be an even number, which can be obtained from the present rate by swapping exactly two distinct digits in it. Of all the possible values that meet these conditions, the exchange rate for tomorrow will be the maximum possible. It is guaranteed that today the exchange rate is an odd positive integer n. Help Anton to determine the exchange rate of currency you all know for tomorrow!" 1300

508A "Pasha and Pixels" "brute force" "Pasha loves his phone and also putting his hair up... But the hair is now irrelevant.Pasha has installed a new game to his phone. The goal of the game is following. There is a rectangular field consisting of n row with m pixels in each row. Initially, all the pixels are colored white. In one move, Pasha can choose any pixel and color it black. In particular, he can choose the pixel that is already black, then after the boy\'s move the pixel does not change, that is, it remains black. Pasha loses the game when a 2\xe2\x80\x89\xc3\x97\xe2\x80\x892 square consisting of black pixels is formed. Pasha has made a plan of k moves, according to which he will paint pixels. Each turn in his plan is represented as a pair of numbers i and j, denoting respectively the row and the column of the pixel to be colored on the current move.Determine whether Pasha loses if he acts in accordance with his plan, and if he does, on what move the 2\xe2\x80\x89\xc3\x97\xe2\x80\x892 square consisting of black pixels is formed." 1100

507E "Breaking Good" "dfs and similar,dp,graphs,shortest paths" "Breaking Good is a new video game which a lot of gamers want to have. There is a certain level in the game that is really difficult even for experienced gamers.Walter William, the main character of the game, wants to join a gang called Los Hermanos (The Brothers). The gang controls the whole country which consists of n cities with m bidirectional roads connecting them. There is no road is connecting a city to itself and for any two cities there is at most one road between them. The country is connected, in the other words, it is possible to reach any city from any other city using the given roads. The roads aren\'t all working. There are some roads which need some more work to be performed to be completely functioning.The gang is going to rob a bank! The bank is located in city 1. As usual, the hardest part is to escape to their headquarters where the police can\'t get them. The gang\'s headquarters is in city n. To gain the gang\'s trust, Walter is in charge of this operation, so he came up with a smart plan.First of all the path which they are going to use on their way back from city 1 to their headquarters n must be as short as possible, since it is important to finish operation as fast as possible.Then, gang has to blow up all other roads in country that don\'t lay on this path, in order to prevent any police reinforcements. In case of non-working road, they don\'t have to blow up it as it is already malfunctional. If the chosen path has some roads that doesn\'t work they\'ll have to repair those roads before the operation.Walter discovered that there was a lot of paths that satisfied the condition of being shortest possible so he decided to choose among them a path that minimizes the total number of affected roads (both roads that have to be blown up and roads to be repaired).Can you help Walter complete his task and gain the gang\'s trust?" 2100

507D "The Maths Lecture" dp,implementation "Amr doesn\'t like Maths as he finds it really boring, so he usually sleeps in Maths lectures. But one day the teacher suspected that Amr is sleeping and asked him a question to make sure he wasn\'t.First he gave Amr two positive integers n and k. Then he asked Amr, how many integer numbers x\xe2\x80\x89>\xe2\x80\x890 exist such that:  Decimal representation of x (without leading zeroes) consists of exactly n digits;  There exists some integer y\xe2\x80\x89>\xe2\x80\x890 such that:   ;  decimal representation of y is a suffix of decimal representation of x.  As the answer to this question may be pretty huge the teacher asked Amr to output only its remainder modulo a number m.Can you help Amr escape this embarrassing situation?" 2200

507C "Guess Your Way Out!" implementation,math,trees "Amr bought a new video game ""Guess Your Way Out!"". The goal of the game is to find an exit from the maze that looks like a perfect binary tree of height h. The player is initially standing at the root of the tree and the exit from the tree is located at some leaf node. Let\'s index all the leaf nodes from the left to the right from 1 to 2h. The exit is located at some node n where 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x892h, the player doesn\'t know where the exit is so he has to guess his way out!Amr follows simple algorithm to choose the path. Let\'s consider infinite command string ""LRLRLRLRL..."" (consisting of alternating characters \'L\' and \'R\'). Amr sequentially executes the characters of the string using following rules:  Character \'L\' means ""go to the left child of the current node"";  Character \'R\' means ""go to the right child of the current node"";  If the destination node is already visited, Amr skips current command, otherwise he moves to the destination node;  If Amr skipped two consecutive commands, he goes back to the parent of the current node before executing next command;  If he reached a leaf node that is not the exit, he returns to the parent of the current node;  If he reaches an exit, the game is finished. Now Amr wonders, if he follows this algorithm, how many nodes he is going to visit before reaching the exit?" 1700

507B "Amr and Pins" geometry,math "Amr loves Geometry. One day he came up with a very interesting problem.Amr has a circle of radius r and center in point (x,\xe2\x80\x89y). He wants the circle center to be in new position (x\',\xe2\x80\x89y\').In one step Amr can put a pin to the border of the circle in a certain point, then rotate the circle around that pin by any angle and finally remove the pin.Help Amr to achieve his goal in minimum number of steps." 1400

507A "Amr and Music" greedy,implementation,sortings "Amr is a young coder who likes music a lot. He always wanted to learn how to play music but he was busy coding so he got an idea.Amr has n instruments, it takes ai days to learn i-th instrument. Being busy, Amr dedicated k days to learn how to play the maximum possible number of instruments.Amr asked for your help to distribute his free days between instruments so that he can achieve his goal." 1000

506E "Mr. Kitayuta\'s Gift" combinatorics,dp,matrices,strings "Amr is a young coder who likes music a lot. He always wanted to learn how to play music but he was busy coding so he got an idea.Amr has n instruments, it takes ai days to learn i-th instrument. Being busy, Amr dedicated k days to learn how to play the maximum possible number of instruments.Amr asked for your help to distribute his free days between instruments so that he can achieve his goal." 3000

506D "Mr. Kitayuta\'s Colorful Graph" "brute force,dfs and similar,dsu,graphs" "Amr is a young coder who likes music a lot. He always wanted to learn how to play music but he was busy coding so he got an idea.Amr has n instruments, it takes ai days to learn i-th instrument. Being busy, Amr dedicated k days to learn how to play the maximum possible number of instruments.Amr asked for your help to distribute his free days between instruments so that he can achieve his goal." 2400

505E "Mr. Kitayuta vs. Bamboos" "binary search,greedy" "Mr. Kitayuta\'s garden is planted with n bamboos. (Bamboos are tall, fast-growing tropical plants with hollow stems.) At the moment, the height of the i-th bamboo is hi meters, and it grows ai meters at the end of each day. Actually, Mr. Kitayuta hates these bamboos. He once attempted to cut them down, but failed because their stems are too hard. Mr. Kitayuta have not given up, however. He has crafted Magical Hammer with his intelligence to drive them into the ground.He can use Magical Hammer at most k times during each day, due to his limited Magic Power. Each time he beat a bamboo with Magical Hammer, its height decreases by p meters. If the height would become negative by this change, it will become 0 meters instead (it does not disappear). In other words, if a bamboo whose height is h meters is beaten with Magical Hammer, its new height will be max(0,\xe2\x80\x89h\xe2\x80\x89-\xe2\x80\x89p) meters. It is possible to beat the same bamboo more than once in a day.Mr. Kitayuta will fight the bamboos for m days, starting today. His purpose is to minimize the height of the tallest bamboo after m days (that is, m iterations of ""Mr. Kitayuta beats the bamboos and then they grow""). Find the lowest possible height of the tallest bamboo after m days." 2900

505D "Mr. Kitayuta\'s Technology" "dfs and similar" "Mr. Kitayuta\'s garden is planted with n bamboos. (Bamboos are tall, fast-growing tropical plants with hollow stems.) At the moment, the height of the i-th bamboo is hi meters, and it grows ai meters at the end of each day. Actually, Mr. Kitayuta hates these bamboos. He once attempted to cut them down, but failed because their stems are too hard. Mr. Kitayuta have not given up, however. He has crafted Magical Hammer with his intelligence to drive them into the ground.He can use Magical Hammer at most k times during each day, due to his limited Magic Power. Each time he beat a bamboo with Magical Hammer, its height decreases by p meters. If the height would become negative by this change, it will become 0 meters instead (it does not disappear). In other words, if a bamboo whose height is h meters is beaten with Magical Hammer, its new height will be max(0,\xe2\x80\x89h\xe2\x80\x89-\xe2\x80\x89p) meters. It is possible to beat the same bamboo more than once in a day.Mr. Kitayuta will fight the bamboos for m days, starting today. His purpose is to minimize the height of the tallest bamboo after m days (that is, m iterations of ""Mr. Kitayuta beats the bamboos and then they grow""). Find the lowest possible height of the tallest bamboo after m days." 2200

505C "Mr. Kitayuta, the Treasure Hunter" "dfs and similar,dp,two pointers" "The Shuseki Islands are an archipelago of 30001 small islands in the Yutampo Sea. The islands are evenly spaced along a line, numbered from 0 to 30000 from the west to the east. These islands are known to contain many treasures. There are n gems in the Shuseki Islands in total, and the i-th gem is located on island pi.Mr. Kitayuta has just arrived at island 0. With his great jumping ability, he will repeatedly perform jumps between islands to the east according to the following process:   First, he will jump from island 0 to island d.  After that, he will continue jumping according to the following rule. Let l be the length of the previous jump, that is, if his previous jump was from island prev to island cur, let l\xe2\x80\x89=\xe2\x80\x89cur\xe2\x80\x89-\xe2\x80\x89prev. He will perform a jump of length l\xe2\x80\x89-\xe2\x80\x891, l or l\xe2\x80\x89+\xe2\x80\x891 to the east. That is, he will jump to island (cur\xe2\x80\x89+\xe2\x80\x89l\xe2\x80\x89-\xe2\x80\x891), (cur\xe2\x80\x89+\xe2\x80\x89l) or (cur\xe2\x80\x89+\xe2\x80\x89l\xe2\x80\x89+\xe2\x80\x891) (if they exist). The length of a jump must be positive, that is, he cannot perform a jump of length 0 when l\xe2\x80\x89=\xe2\x80\x891. If there is no valid destination, he will stop jumping. Mr. Kitayuta will collect the gems on the islands visited during the process. Find the maximum number of gems that he can collect." 1900

505B "Mr. Kitayuta\'s Colorful Graph" "dfs and similar,dp,dsu,graphs" "The Shuseki Islands are an archipelago of 30001 small islands in the Yutampo Sea. The islands are evenly spaced along a line, numbered from 0 to 30000 from the west to the east. These islands are known to contain many treasures. There are n gems in the Shuseki Islands in total, and the i-th gem is located on island pi.Mr. Kitayuta has just arrived at island 0. With his great jumping ability, he will repeatedly perform jumps between islands to the east according to the following process:   First, he will jump from island 0 to island d.  After that, he will continue jumping according to the following rule. Let l be the length of the previous jump, that is, if his previous jump was from island prev to island cur, let l\xe2\x80\x89=\xe2\x80\x89cur\xe2\x80\x89-\xe2\x80\x89prev. He will perform a jump of length l\xe2\x80\x89-\xe2\x80\x891, l or l\xe2\x80\x89+\xe2\x80\x891 to the east. That is, he will jump to island (cur\xe2\x80\x89+\xe2\x80\x89l\xe2\x80\x89-\xe2\x80\x891), (cur\xe2\x80\x89+\xe2\x80\x89l) or (cur\xe2\x80\x89+\xe2\x80\x89l\xe2\x80\x89+\xe2\x80\x891) (if they exist). The length of a jump must be positive, that is, he cannot perform a jump of length 0 when l\xe2\x80\x89=\xe2\x80\x891. If there is no valid destination, he will stop jumping. Mr. Kitayuta will collect the gems on the islands visited during the process. Find the maximum number of gems that he can collect." 1400

505A "Mr. Kitayuta\'s Gift" "brute force,implementation,strings" "The Shuseki Islands are an archipelago of 30001 small islands in the Yutampo Sea. The islands are evenly spaced along a line, numbered from 0 to 30000 from the west to the east. These islands are known to contain many treasures. There are n gems in the Shuseki Islands in total, and the i-th gem is located on island pi.Mr. Kitayuta has just arrived at island 0. With his great jumping ability, he will repeatedly perform jumps between islands to the east according to the following process:   First, he will jump from island 0 to island d.  After that, he will continue jumping according to the following rule. Let l be the length of the previous jump, that is, if his previous jump was from island prev to island cur, let l\xe2\x80\x89=\xe2\x80\x89cur\xe2\x80\x89-\xe2\x80\x89prev. He will perform a jump of length l\xe2\x80\x89-\xe2\x80\x891, l or l\xe2\x80\x89+\xe2\x80\x891 to the east. That is, he will jump to island (cur\xe2\x80\x89+\xe2\x80\x89l\xe2\x80\x89-\xe2\x80\x891), (cur\xe2\x80\x89+\xe2\x80\x89l) or (cur\xe2\x80\x89+\xe2\x80\x89l\xe2\x80\x89+\xe2\x80\x891) (if they exist). The length of a jump must be positive, that is, he cannot perform a jump of length 0 when l\xe2\x80\x89=\xe2\x80\x891. If there is no valid destination, he will stop jumping. Mr. Kitayuta will collect the gems on the islands visited during the process. Find the maximum number of gems that he can collect." 1100

504E "Misha and LCP on Tree" "binary search,dfs and similar,hashing,string suffix structures,trees" "Misha has a tree with characters written on the vertices. He can choose two vertices s and t of this tree and write down characters of vertices lying on a path from s to t. We\'ll say that such string corresponds to pair (s,\xe2\x80\x89t).Misha has m queries of type: you are given 4 vertices a, b, c, d; you need to find the largest common prefix of the strings that correspond to pairs (a,\xe2\x80\x89b) and (c,\xe2\x80\x89d). Your task is to help him." 3000

504D "Misha and XOR" bitmasks "After Misha\'s birthday he had many large numbers left, scattered across the room. Now it\'s time to clean up and Misha needs to put them in a basket. He ordered this task to his pet robot that agreed to complete the task at certain conditions. Before the robot puts a number x to the basket, Misha should answer the question: is it possible to choose one or multiple numbers that already are in the basket, such that their XOR sum equals x? If the answer is positive, you also need to give the indexes of these numbers. If there are multiple options of choosing numbers, you are allowed to choose any correct option. After Misha\'s answer the robot puts the number to the basket.Initially the basket is empty. Each integer you put in the basket takes some number. The first integer you put into the basket take number 0, the second integer takes number 1 and so on.Misha needs to clean up the place as soon as possible but unfortunately, he isn\'t that good at mathematics. He asks you to help him." 2700

501E "Misha and Palindrome Degree" "binary search,combinatorics,implementation" "Misha has an array of n integers indexed by integers from 1 to n. Let\'s define palindrome degree of array a as the number of such index pairs (l,\xe2\x80\x89r)(1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n), that the elements from the l-th to the r-th one inclusive can be rearranged in such a way that the whole array will be a palindrome. In other words, pair (l,\xe2\x80\x89r) should meet the condition that after some rearranging of numbers on positions from l to r, inclusive (it is allowed not to rearrange the numbers at all), for any 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n following condition holds: a[i]\xe2\x80\x89=\xe2\x80\x89a[n\xe2\x80\x89-\xe2\x80\x89i\xe2\x80\x89+\xe2\x80\x891]. Your task is to find the palindrome degree of Misha\'s array." 2500

501D "Misha and Permutations Summation" "data structures" "Let\'s define the sum of two permutations p and q of numbers 0,\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89(n\xe2\x80\x89-\xe2\x80\x891) as permutation , where Perm(x) is the x-th lexicographically permutation of numbers 0,\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89(n\xe2\x80\x89-\xe2\x80\x891) (counting from zero), and Ord(p) is the number of permutation p in the lexicographical order.For example, Perm(0)\xe2\x80\x89=\xe2\x80\x89(0,\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x892,\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x891), Perm(n!\xe2\x80\x89-\xe2\x80\x891)\xe2\x80\x89=\xe2\x80\x89(n\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x891,\xe2\x80\x890)Misha has two permutations, p and q. Your task is to find their sum.Permutation a\xe2\x80\x89=\xe2\x80\x89(a0,\xe2\x80\x89a1,\xe2\x80\x89...,\xe2\x80\x89an\xe2\x80\x89-\xe2\x80\x891) is called to be lexicographically smaller than permutation b\xe2\x80\x89=\xe2\x80\x89(b0,\xe2\x80\x89b1,\xe2\x80\x89...,\xe2\x80\x89bn\xe2\x80\x89-\xe2\x80\x891), if for some k following conditions hold: a0\xe2\x80\x89=\xe2\x80\x89b0,\xe2\x80\x89a1\xe2\x80\x89=\xe2\x80\x89b1,\xe2\x80\x89...,\xe2\x80\x89ak\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89=\xe2\x80\x89bk\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89ak\xe2\x80\x89<\xe2\x80\x89bk." 2000

501C "Misha and Forest" "constructive algorithms,data structures,greedy,sortings,trees" "Let\'s define a forest as a non-directed acyclic graph (also without loops and parallel edges). One day Misha played with the forest consisting of n vertices. For each vertex v from 0 to n\xe2\x80\x89-\xe2\x80\x891 he wrote down two integers, degreev and sv, were the first integer is the number of vertices adjacent to vertex v, and the second integer is the XOR sum of the numbers of vertices adjacent to v (if there were no adjacent vertices, he wrote down 0). Next day Misha couldn\'t remember what graph he initially had. Misha has values degreev and sv left, though. Help him find the number of edges and the edges of the initial graph. It is guaranteed that there exists a forest that corresponds to the numbers written by Misha." 1500

501B "Misha and Changing Handles" "data structures,dsu,strings" "Misha hacked the Codeforces site. Then he decided to let all the users change their handles. A user can now change his handle any number of times. But each new handle must not be equal to any handle that is already used or that was used at some point.Misha has a list of handle change requests. After completing the requests he wants to understand the relation between the original and the new handles of the users. Help him to do that." 1100

501A Contest implementation "Misha and Vasya participated in a Codeforces contest. Unfortunately, each of them solved only one problem, though successfully submitted it at the first attempt. Misha solved the problem that costs a points and Vasya solved the problem that costs b points. Besides, Misha submitted the problem c minutes after the contest started and Vasya submitted the problem d minutes after the contest started. As you know, on Codeforces the cost of a problem reduces as a round continues. That is, if you submit a problem that costs p points t minutes after the contest started, you get  points. Misha and Vasya are having an argument trying to find out who got more points. Help them to find out the truth." 900

500G "New Year Running" "number theory,trees" "New Year is coming in Tree Island! In this island, as the name implies, there are n cities connected by n\xe2\x80\x89-\xe2\x80\x891 roads, and for any two distinct cities there always exists exactly one path between them. For every person in Tree Island, it takes exactly one minute to pass by exactly one road.There is a weird New Year tradition for runnners in Tree Island, which is called ""extreme run"". This tradition can be done as follows.A runner chooses two distinct cities a and b. For simplicity, let\'s denote the shortest path from city a to city b as p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pl (here, p1\xe2\x80\x89=\xe2\x80\x89a and pl\xe2\x80\x89=\xe2\x80\x89b holds). Then following happens:  The runner starts at city a.  The runner runs from city a to b, following the shortest path from city a to city b.  When the runner arrives at city b, he turns his direction immediately (it takes no time), and runs towards city a, following the shortest path from city b to city a.  When the runner arrives at city a, he turns his direction immediately (it takes no time), and runs towards city b, following the shortest path from city a to city b.  Repeat step 3 and step 4 forever. In short, the course of the runner can be denoted as:  Two runners JH and JY decided to run ""extremely"" in order to celebrate the New Year. JH has chosen two cities u and v, and JY has chosen two cities x and y. They decided to start running at the same moment, and run until they meet at the same city for the first time. Meeting on a road doesn\'t matter for them. Before running, they want to know the amount of time they will run.It is too hard for JH and JY to calculate this, so they ask you for help." 3200

500F "New Year Shopping" "divide and conquer,dp" "Dohyun is running a grocery store. He sells n items numbered by integers from 1 to n. The i-th (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) of them costs ci dollars, and if I buy it, my happiness increases by hi. Each item can be displayed only for p units of time because of freshness. As Dohyun displays the i-th item at time ti, the customers can buy the i-th item only from time ti to time ti\xe2\x80\x89+\xe2\x80\x89(p\xe2\x80\x89-\xe2\x80\x891) inclusively. Also, each customer cannot buy the same item more than once.I\'d like to visit Dohyun\'s grocery store and buy some items for the New Year Party, and maximize my happiness. Because I am a really busy person, I can visit the store only once, and for very short period of time. In other words, if I visit the store at time t, I can only buy the items available at time t. But I can buy as many items as possible, if the budget holds. I can\'t buy same item several times due to store rules. It is not necessary to use the whole budget.I made a list of q pairs of integers (aj,\xe2\x80\x89bj), which means I may visit the store at time aj, and spend at most bj dollars at the store. For each pair, I\'d like to know the maximum happiness I can obtain. But there are so many pairs that I can\'t handle them. Can you help me?" 2700

500E "New Year Domino" "data structures,dp,dsu" "Celebrating the new year, many people post videos of falling dominoes; Here\'s a list of them: https://www.youtube.com/results?search_query=New+Years+Dominos User ainta, who lives in a 2D world, is going to post a video as well.There are n dominoes on a 2D Cartesian plane. i-th domino (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) can be represented as a line segment which is parallel to the y-axis and whose length is li. The lower point of the domino is on the x-axis. Let\'s denote the x-coordinate of the i-th domino as pi. Dominoes are placed one after another, so p1\xe2\x80\x89<\xe2\x80\x89p2\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89pn\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89<\xe2\x80\x89pn holds.User ainta wants to take a video of falling dominoes. To make dominoes fall, he can push a single domino to the right. Then, the domino will fall down drawing a circle-shaped orbit until the line segment totally overlaps with the x-axis.   Also, if the s-th domino touches the t-th domino while falling down, the t-th domino will also fall down towards the right, following the same procedure above. Domino s touches domino t if and only if the segment representing s and t intersects.   See the picture above. If he pushes the leftmost domino to the right, it falls down, touching dominoes (A), (B) and (C). As a result, dominoes (A), (B), (C) will also fall towards the right. However, domino (D) won\'t be affected by pushing the leftmost domino, but eventually it will fall because it is touched by domino (C) for the first time.  The picture above is an example of falling dominoes. Each red circle denotes a touch of two dominoes.User ainta has q plans of posting the video. j-th of them starts with pushing the xj-th domino, and lasts until the yj-th domino falls. But sometimes, it could be impossible to achieve such plan, so he has to lengthen some dominoes. It costs one dollar to increase the length of a single domino by 1. User ainta wants to know, for each plan, the minimum cost needed to achieve it. Plans are processed independently, i. e. if domino\'s length is increased in some plan, it doesn\'t affect its length in other plans. Set of dominos that will fall except xj-th domino and yj-th domino doesn\'t matter, but the initial push should be on domino xj." 2300

500D "New Year Santa Network" "combinatorics,dfs and similar,graphs,trees" "New Year is coming in Tree World! In this world, as the name implies, there are n cities connected by n\xe2\x80\x89-\xe2\x80\x891 roads, and for any two distinct cities there always exists a path between them. The cities are numbered by integers from 1 to n, and the roads are numbered by integers from 1 to n\xe2\x80\x89-\xe2\x80\x891. Let\'s define d(u,\xe2\x80\x89v) as total length of roads on the path between city u and city v.As an annual event, people in Tree World repairs exactly one road per year. As a result, the length of one road decreases. It is already known that in the i-th year, the length of the ri-th road is going to become wi, which is shorter than its length before. Assume that the current year is year 1.Three Santas are planning to give presents annually to all the children in Tree World. In order to do that, they need some preparation, so they are going to choose three distinct cities c1, c2, c3 and make exactly one warehouse in each city. The k-th (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x893) Santa will take charge of the warehouse in city ck.It is really boring for the three Santas to keep a warehouse alone. So, they decided to build an only-for-Santa network! The cost needed to build this network equals to d(c1,\xe2\x80\x89c2)\xe2\x80\x89+\xe2\x80\x89d(c2,\xe2\x80\x89c3)\xe2\x80\x89+\xe2\x80\x89d(c3,\xe2\x80\x89c1) dollars. Santas are too busy to find the best place, so they decided to choose c1,\xe2\x80\x89c2,\xe2\x80\x89c3 randomly uniformly over all triples of distinct numbers from 1 to n. Santas would like to know the expected value of the cost needed to build the network.However, as mentioned, each year, the length of exactly one road decreases. So, the Santas want to calculate the expected after each length change. Help them to calculate the value." 1900

500C "New Year Book Reading" "constructive algorithms,greedy,implementation,math" "New Year is coming, and Jaehyun decided to read many books during 2015, unlike this year. He has n books numbered by integers from 1 to n. The weight of the i-th (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) book is wi.As Jaehyun\'s house is not large enough to have a bookshelf, he keeps the n books by stacking them vertically. When he wants to read a certain book x, he follows the steps described below.  He lifts all the books above book x.  He pushes book x out of the stack.  He puts down the lifted books without changing their order.  After reading book x, he puts book x on the top of the stack.  He decided to read books for m days. In the j-th (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m) day, he will read the book that is numbered with integer bj (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89bj\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n). To read the book, he has to use the process described in the paragraph above. It is possible that he decides to re-read the same book several times.After making this plan, he realized that the total weight of books he should lift during m days would be too heavy. So, he decided to change the order of the stacked books before the New Year comes, and minimize the total weight. You may assume that books can be stacked in any possible order. Note that book that he is going to read on certain step isn\'t considered as lifted on that step. Can you help him?" 1600

500B "New Year Permutation" "dfs and similar,dsu,graphs,greedy,math,sortings" "User ainta has a permutation p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pn. As the New Year is coming, he wants to make his permutation as pretty as possible.Permutation a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an is prettier than permutation b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bn, if and only if there exists an integer k (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) where a1\xe2\x80\x89=\xe2\x80\x89b1,\xe2\x80\x89a2\xe2\x80\x89=\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89ak\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89=\xe2\x80\x89bk\xe2\x80\x89-\xe2\x80\x891 and ak\xe2\x80\x89<\xe2\x80\x89bk all holds.As known, permutation p is so sensitive that it could be only modified by swapping two distinct elements. But swapping two elements is harder than you think. Given an n\xe2\x80\x89\xc3\x97\xe2\x80\x89n binary matrix A, user ainta can swap the values of pi and pj (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i,\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n, i\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89j) if and only if Ai,\xe2\x80\x89j\xe2\x80\x89=\xe2\x80\x891.Given the permutation p and the matrix A, user ainta wants to know the prettiest permutation that he can obtain." 1600

500A "New Year Transportation" "dfs and similar,graphs,implementation" "New Year is coming in Line World! In this world, there are n cells numbered by integers from 1 to n, as a 1\xe2\x80\x89\xc3\x97\xe2\x80\x89n board. People live in cells. However, it was hard to move between distinct cells, because of the difficulty of escaping the cell. People wanted to meet people who live in other cells.So, user tncks0121 has made a transportation system to move between these cells, to celebrate the New Year. First, he thought of n\xe2\x80\x89-\xe2\x80\x891 positive integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an\xe2\x80\x89-\xe2\x80\x891. For every integer i where 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x891 the condition 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ai\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x89i holds. Next, he made n\xe2\x80\x89-\xe2\x80\x891 portals, numbered by integers from 1 to n\xe2\x80\x89-\xe2\x80\x891. The i-th (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x891) portal connects cell i and cell (i\xe2\x80\x89+\xe2\x80\x89ai), and one can travel from cell i to cell (i\xe2\x80\x89+\xe2\x80\x89ai) using the i-th portal. Unfortunately, one cannot use the portal backwards, which means one cannot move from cell (i\xe2\x80\x89+\xe2\x80\x89ai) to cell i using the i-th portal. It is easy to see that because of condition 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ai\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x89i one can\'t leave the Line World using portals.Currently, I am standing at cell 1, and I want to go to cell t. However, I don\'t know whether it is possible to go there. Please determine whether I can go to cell t by only using the construted transportation system." 1000

499B Lecture implementation,strings "You have a new professor of graph theory and he speaks very quickly. You come up with the following plan to keep up with his lecture and make notes.You know two languages, and the professor is giving the lecture in the first one. The words in both languages consist of lowercase English characters, each language consists of several words. For each language, all words are distinct, i.e. they are spelled differently. Moreover, the words of these languages have a one-to-one correspondence, that is, for each word in each language, there exists exactly one word in the other language having has the same meaning.You can write down every word the professor says in either the first language or the second language. Of course, during the lecture you write down each word in the language in which the word is shorter. In case of equal lengths of the corresponding words you prefer the word of the first language.You are given the text of the lecture the professor is going to read. Find out how the lecture will be recorded in your notes." 1000

499A "Watching a movie" greedy,implementation "You have decided to watch the best moments of some movie. There are two buttons on your player:   Watch the current minute of the movie. By pressing this button, you watch the current minute of the movie and the player automatically proceeds to the next minute of the movie.  Skip exactly x minutes of the movie (x is some fixed positive integer). If the player is now at the t-th minute of the movie, then as a result of pressing this button, it proceeds to the minute (t\xe2\x80\x89+\xe2\x80\x89x). Initially the movie is turned on in the player on the first minute, and you want to watch exactly n best moments of the movie, the i-th best moment starts at the li-th minute and ends at the ri-th minute (more formally, the i-th best moment consists of minutes: li,\xe2\x80\x89li\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89ri). Determine, what is the minimum number of minutes of the movie you have to watch if you want to watch all the best moments?" 1000

498E "Stairs and Lines" dp,matrices "You are given a figure on a grid representing stairs consisting of 7 steps. The width of the stair on height i is wi squares. Formally, the figure is created by consecutively joining rectangles of size wi\xe2\x80\x89\xc3\x97\xe2\x80\x89i so that the wi sides lie on one straight line. Thus, for example, if all wi\xe2\x80\x89=\xe2\x80\x891, the figure will look like that (different colors represent different rectangles):  And if w\xe2\x80\x89=\xe2\x80\x89{5,\xe2\x80\x891,\xe2\x80\x890,\xe2\x80\x893,\xe2\x80\x890,\xe2\x80\x890,\xe2\x80\x891}, then it looks like that:  Find the number of ways to color some borders of the figure\'s inner squares so that no square had all four borders colored. The borders of the squares lying on the border of the figure should be considered painted. The ways that differ with the figure\'s rotation should be considered distinct." 2700

498D "Traffic Jams in the Land" "data structures,dp,number theory" "Some country consists of (n\xe2\x80\x89+\xe2\x80\x891) cities, located along a straight highway. Let\'s number the cities with consecutive integers from 1 to n\xe2\x80\x89+\xe2\x80\x891 in the order they occur along the highway. Thus, the cities are connected by n segments of the highway, the i-th segment connects cities number i and i\xe2\x80\x89+\xe2\x80\x891. Every segment of the highway is associated with a positive integer ai\xe2\x80\x89>\xe2\x80\x891 \xe2\x80\x94 the period of traffic jams appearance on it. In order to get from city x to city y (x\xe2\x80\x89<\xe2\x80\x89y), some drivers use the following tactics. Initially the driver is in city x and the current time t equals zero. Until the driver arrives in city y, he perfors the following actions:  if the current time t is a multiple of ax, then the segment of the highway number x is now having traffic problems and the driver stays in the current city for one unit of time (formally speaking, we assign t\xe2\x80\x89=\xe2\x80\x89t\xe2\x80\x89+\xe2\x80\x891);  if the current time t is not a multiple of ax, then the segment of the highway number x is now clear and that\'s why the driver uses one unit of time to move to city x\xe2\x80\x89+\xe2\x80\x891 (formally, we assign t\xe2\x80\x89=\xe2\x80\x89t\xe2\x80\x89+\xe2\x80\x891 and x\xe2\x80\x89=\xe2\x80\x89x\xe2\x80\x89+\xe2\x80\x891). You are developing a new traffic control system. You want to consecutively process q queries of two types:  determine the final value of time t after the ride from city x to city y (x\xe2\x80\x89<\xe2\x80\x89y) assuming that we apply the tactics that is described above. Note that for each query t is being reset to 0.  replace the period of traffic jams appearing on the segment number x by value y (formally, assign ax\xe2\x80\x89=\xe2\x80\x89y). Write a code that will effectively process the queries given above." 2400

498C "Array and Operations" "flows,graph matchings,number theory" "You have written on a piece of paper an array of n positive integers a[1],\xe2\x80\x89a[2],\xe2\x80\x89...,\xe2\x80\x89a[n] and m good pairs of integers (i1,\xe2\x80\x89j1),\xe2\x80\x89(i2,\xe2\x80\x89j2),\xe2\x80\x89...,\xe2\x80\x89(im,\xe2\x80\x89jm). Each good pair (ik,\xe2\x80\x89jk) meets the following conditions: ik\xe2\x80\x89+\xe2\x80\x89jk is an odd number and 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ik\xe2\x80\x89<\xe2\x80\x89jk\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n.In one operation you can perform a sequence of actions:   take one of the good pairs (ik,\xe2\x80\x89jk) and some integer v (v\xe2\x80\x89>\xe2\x80\x891), which divides both numbers a[ik] and a[jk];  divide both numbers by v, i. e. perform the assignments:  and . Determine the maximum number of operations you can sequentially perform on the given array. Note that one pair may be used several times in the described operations." 2100

498B "Name That Tune" "dp,probabilities,two pointers" "It turns out that you are a great fan of rock band AC/PE. Peter learned that and started the following game: he plays the first song of the list of n songs of the group, and you have to find out the name of the song. After you tell the song name, Peter immediately plays the following song in order, and so on.The i-th song of AC/PE has its recognizability pi. This means that if the song has not yet been recognized by you, you listen to it for exactly one more second and with probability of pi percent you recognize it and tell it\'s name. Otherwise you continue listening it. Note that you can only try to guess it only when it is integer number of seconds after the moment the song starts playing.In all AC/PE songs the first words of chorus are the same as the title, so when you\'ve heard the first ti seconds of i-th song and its chorus starts, you immediately guess its name for sure.For example, in the song Highway To Red the chorus sounds pretty late, but the song has high recognizability. In the song Back In Blue, on the other hand, the words from the title sound close to the beginning of the song, but it\'s hard to name it before hearing those words. You can name both of these songs during a few more first seconds.Determine the expected number songs of you will recognize if the game lasts for exactly T seconds (i. e. you can make the last guess on the second T, after that the game stops).If all songs are recognized faster than in T seconds, the game stops after the last song is recognized." 2400

498A "Crazy Town" geometry "Crazy Town is a plane on which there are n infinite line roads. Each road is defined by the equation aix\xe2\x80\x89+\xe2\x80\x89biy\xe2\x80\x89+\xe2\x80\x89ci\xe2\x80\x89=\xe2\x80\x890, where ai and bi are not both equal to the zero. The roads divide the plane into connected regions, possibly of infinite space. Let\'s call each such region a block. We define an intersection as the point where at least two different roads intersect.Your home is located in one of the blocks. Today you need to get to the University, also located in some block. In one step you can move from one block to another, if the length of their common border is nonzero (in particular, this means that if the blocks are adjacent to one intersection, but have no shared nonzero boundary segment, then it are not allowed to move from one to another one in one step).Determine what is the minimum number of steps you have to perform to get to the block containing the university. It is guaranteed that neither your home nor the university is located on the road." 1700

497E "Subsequences Return" dp,matrices "Assume that sk(n) equals the sum of digits of number n in the k-based notation. For example, s2(5)\xe2\x80\x89=\xe2\x80\x89s2(1012)\xe2\x80\x89=\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x890\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89=\xe2\x80\x892, s3(14)\xe2\x80\x89=\xe2\x80\x89s3(1123)\xe2\x80\x89=\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x892\xe2\x80\x89=\xe2\x80\x894.The sequence of integers a0,\xe2\x80\x89...,\xe2\x80\x89an\xe2\x80\x89-\xe2\x80\x891 is defined as . Your task is to calculate the number of distinct subsequences of sequence a0,\xe2\x80\x89...,\xe2\x80\x89an\xe2\x80\x89-\xe2\x80\x891. Calculate the answer modulo 109\xe2\x80\x89+\xe2\x80\x897.Sequence a1,\xe2\x80\x89...,\xe2\x80\x89ak is called to be a subsequence of sequence b1,\xe2\x80\x89...,\xe2\x80\x89bl, if there is a sequence of indices 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i1\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89ik\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l, such that a1\xe2\x80\x89=\xe2\x80\x89bi1, ..., ak\xe2\x80\x89=\xe2\x80\x89bik. In particular, an empty sequence (i.e. the sequence consisting of zero elements) is a subsequence of any sequence." 2900

497D Gears "brute force,geometry,math" "Assume that sk(n) equals the sum of digits of number n in the k-based notation. For example, s2(5)\xe2\x80\x89=\xe2\x80\x89s2(1012)\xe2\x80\x89=\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x890\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89=\xe2\x80\x892, s3(14)\xe2\x80\x89=\xe2\x80\x89s3(1123)\xe2\x80\x89=\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x892\xe2\x80\x89=\xe2\x80\x894.The sequence of integers a0,\xe2\x80\x89...,\xe2\x80\x89an\xe2\x80\x89-\xe2\x80\x891 is defined as . Your task is to calculate the number of distinct subsequences of sequence a0,\xe2\x80\x89...,\xe2\x80\x89an\xe2\x80\x89-\xe2\x80\x891. Calculate the answer modulo 109\xe2\x80\x89+\xe2\x80\x897.Sequence a1,\xe2\x80\x89...,\xe2\x80\x89ak is called to be a subsequence of sequence b1,\xe2\x80\x89...,\xe2\x80\x89bl, if there is a sequence of indices 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i1\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89ik\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l, such that a1\xe2\x80\x89=\xe2\x80\x89bi1, ..., ak\xe2\x80\x89=\xe2\x80\x89bik. In particular, an empty sequence (i.e. the sequence consisting of zero elements) is a subsequence of any sequence." 2900

496E "Distributing Parts" greedy,sortings "You are an assistant director in a new musical play. The play consists of n musical parts, each part must be performed by exactly one actor. After the casting the director chose m actors who can take part in the play. Your task is to assign the parts to actors. However, there are several limitations.First, each actor has a certain voice range and there are some parts that he cannot sing. Formally, there are two integers for each actor, ci and di (ci\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89di)�\xe2\x80\x94 the pitch of the lowest and the highest note that the actor can sing. There also are two integers for each part�\xe2\x80\x94 aj and bj (aj\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89bj)�\xe2\x80\x94 the pitch of the lowest and the highest notes that are present in the part. The i-th actor can perform the j-th part if and only if ci\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89aj\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89bj\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89di, i.e. each note of the part is in the actor\'s voice range.According to the contract, the i-th actor can perform at most ki parts. Besides, you are allowed not to give any part to some actors (then they take part in crowd scenes).The rehearsal starts in two hours and you need to do the assignment quickly!" 2100

496D "Tennis Game" "binary search" "Petya and Gena love playing table tennis. A single match is played according to the following rules: a match consists of multiple sets, each set consists of multiple serves. Each serve is won by one of the players, this player scores one point. As soon as one of the players scores t points, he wins the set; then the next set starts and scores of both players are being set to 0. As soon as one of the players wins the total of s sets, he wins the match and the match is over. Here s and t are some positive integer numbers.To spice it up, Petya and Gena choose new numbers s and t before every match. Besides, for the sake of history they keep a record of each match: that is, for each serve they write down the winner. Serve winners are recorded in the chronological order. In a record the set is over as soon as one of the players scores t points and the match is over as soon as one of the players wins s sets.Petya and Gena have found a record of an old match. Unfortunately, the sequence of serves in the record isn\'t divided into sets and numbers s and t for the given match are also lost. The players now wonder what values of s and t might be. Can you determine all the possible options?" 1900

496C "Removing Columns" "brute force,constructive algorithms,implementation" "You are given an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m rectangular table consisting of lower case English letters. In one operation you can completely remove one column from the table. The remaining parts are combined forming a new table. For example, after removing the second column from the tableabcdedfghijk�we obtain the table:acdefghjk�A table is called good if its rows are ordered from top to bottom lexicographically, i.e. each row is lexicographically no larger than the following one. Determine the minimum number of operations of removing a column needed to make a given table good." 1500

496B "Secret Combination" "brute force,constructive algorithms,implementation" "You got a box with a combination lock. The lock has a display showing n digits. There are two buttons on the box, each button changes digits on the display. You have quickly discovered that the first button adds 1 to all the digits (all digits 9 become digits 0), and the second button shifts all the digits on the display one position to the right (the last digit becomes the first one). For example, if the display is currently showing number 579, then if we push the first button, the display will show 680, and if after that we push the second button, the display will show 068.You know that the lock will open if the display is showing the smallest possible number that can be obtained by pushing the buttons in some order. The leading zeros are ignored while comparing numbers. Now your task is to find the desired number." 1500

496A "Minimum Difficulty" "brute force,implementation,math" "Mike is trying rock climbing but he is awful at it. There are n holds on the wall, i-th hold is at height ai off the ground. Besides, let the sequence ai increase, that is, ai\xe2\x80\x89<\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x891 for all i from 1 to n\xe2\x80\x89-\xe2\x80\x891; we will call such sequence a track. Mike thinks that the track a1, ..., an has difficulty . In other words, difficulty equals the maximum distance between two holds that are adjacent in height.Today Mike decided to cover the track with holds hanging on heights a1, ..., an. To make the problem harder, Mike decided to remove one hold, that is, remove one element of the sequence (for example, if we take the sequence (1,\xe2\x80\x892,\xe2\x80\x893,\xe2\x80\x894,\xe2\x80\x895) and remove the third element from it, we obtain the sequence (1,\xe2\x80\x892,\xe2\x80\x894,\xe2\x80\x895)). However, as Mike is awful at climbing, he wants the final difficulty (i.e. the maximum difference of heights between adjacent holds after removing the hold) to be as small as possible among all possible options of removing a hold. The first and last holds must stay at their positions.Help Mike determine the minimum difficulty of the track after removing one hold." 900

495B "Modular Equations" "math,number theory" "Last week, Hamed learned about a new type of equations in his math class called Modular Equations. Lets define i modulo j as the remainder of division of i by j and denote it by . A Modular Equation, as Hamed\'s teacher described, is an equation of the form  in which a and b are two non-negative integers and x is a variable. We call a positive integer x for which  a solution of our equation.Hamed didn\'t pay much attention to the class since he was watching a movie. He only managed to understand the definitions of these equations.Now he wants to write his math exercises but since he has no idea how to do that, he asked you for help. He has told you all he knows about Modular Equations and asked you to write a program which given two numbers a and b determines how many answers the Modular Equation  has." 1600

495A "Digital Counter" implementation "Malek lives in an apartment block with 100 floors numbered from 0 to 99. The apartment has an elevator with a digital counter showing the floor that the elevator is currently on. The elevator shows each digit of a number with 7 light sticks by turning them on or off. The picture below shows how the elevator shows each digit.One day when Malek wanted to go from floor 88 to floor 0 using the elevator he noticed that the counter shows number 89 instead of 88. Then when the elevator started moving the number on the counter changed to 87. After a little thinking Malek came to the conclusion that there is only one explanation for this: One of the sticks of the counter was broken. Later that day Malek was thinking about the broken stick and suddenly he came up with the following problem.Suppose the digital counter is showing number n. Malek calls an integer x (0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x8999) good if it\'s possible that the digital counter was supposed to show x but because of some(possibly none) broken sticks it\'s showing n instead. Malek wants to know number of good integers for a specific n. So you must write a program that calculates this number. Please note that the counter always shows two digits." 1100

494E Sharti "data structures,games" "During the last 24 hours Hamed and Malek spent all their time playing ""Sharti"". Now they are too exhausted to finish the last round. So they asked you for help to determine the winner of this round. ""Sharti"" is played on a n\xe2\x80\x89\xc3\x97\xe2\x80\x89n board with some of cells colored white and others colored black. The rows of the board are numbered from top to bottom using number 1 to n. Also the columns of the board are numbered from left to right using numbers 1 to n. The cell located at the intersection of i-th row and j-th column is denoted by (i,\xe2\x80\x89j).The players alternatively take turns. In each turn the player must choose a square with side-length at most k with its lower-right cell painted white. Then the colors of all the cells in this square are inversed (white cells become black and vice-versa). The player who cannot perform a move in his turn loses. You know Hamed and Malek are very clever and they would have played their best moves at each turn. Knowing this and the fact that Hamed takes the first turn, given the initial board as described in the input, you must determine which one of them will be the winner." 3200

494D Birthday "data structures,dfs and similar,dp,trees" "Ali is Hamed\'s little brother and tomorrow is his birthday. Hamed wants his brother to earn his gift so he gave him a hard programming problem and told him if he can successfully solve it, he\'ll get him a brand new laptop. Ali is not yet a very talented programmer like Hamed and although he usually doesn\'t cheat but this time is an exception. It\'s about a brand new laptop. So he decided to secretly seek help from you. Please solve this problem for Ali. An n-vertex weighted rooted tree is given. Vertex number 1 is a root of the tree. We define d(u,\xe2\x80\x89v) as the sum of edges weights on the shortest path between vertices u and v. Specifically we define d(u,\xe2\x80\x89u)\xe2\x80\x89=\xe2\x80\x890. Also let\'s define S(v) for each vertex v as a set containing all vertices u such that d(1,\xe2\x80\x89u)\xe2\x80\x89=\xe2\x80\x89d(1,\xe2\x80\x89v)\xe2\x80\x89+\xe2\x80\x89d(v,\xe2\x80\x89u). Function f(u,\xe2\x80\x89v) is then defined using the following formula:The goal is to calculate f(u,\xe2\x80\x89v) for each of the q given pair of vertices. As the answer can be rather large it\'s enough to print it modulo 109\xe2\x80\x89+\xe2\x80\x897." 2700

494C "Helping People" dp,probabilities "Malek is a rich man. He also is very generous. That\'s why he decided to split his money between poor people. A charity institute knows n poor people numbered from 1 to n. The institute gave Malek q recommendations. A recommendation is a segment of people like [l,\xe2\x80\x89r] which means the institute recommended that Malek gives one dollar to every person whose number is in this segment.However this charity has very odd rules about the recommendations. Because of those rules the recommendations are given in such a way that for every two recommendation [a,\xe2\x80\x89b] and [c,\xe2\x80\x89d] one of the following conditions holds:   The two segments are completely disjoint. More formally either a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b\xe2\x80\x89<\xe2\x80\x89c\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89d or c\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89d\xe2\x80\x89<\xe2\x80\x89a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b  One of the two segments are inside another. More formally either a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89c\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89d\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b or c\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89d. The goodness of a charity is the value of maximum money a person has after Malek finishes giving his money. The institute knows for each recommendation what is the probability that Malek will accept it. They want to know the expected value of goodness of this charity. So they asked you for help.You have been given the list of recommendations and for each recommendation the probability of it being accepted by Malek. You have also been given how much money each person initially has. You must find the expected value of goodness." 2600

494B "Obsessive String" dp,strings "Hamed has recently found a string t and suddenly became quite fond of it. He spent several days trying to find all occurrences of t in other strings he had. Finally he became tired and started thinking about the following problem. Given a string s how many ways are there to extract k\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x891 non-overlapping substrings from it such that each of them contains string t as a substring? More formally, you need to calculate the number of ways to choose two sequences a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89ak and b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bk satisfying the following requirements:  k\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x891        ��t is a substring of string saisai\xe2\x80\x89+\xe2\x80\x891... sbi (string s is considered as 1-indexed). As the number of ways can be rather large print it modulo 109\xe2\x80\x89+\xe2\x80\x897." 2000

494A Treasure greedy "Malek has recently found a treasure map. While he was looking for a treasure he found a locked door. There was a string s written on the door consisting of characters \'(\', \')\' and \'#\'. Below there was a manual on how to open the door. After spending a long time Malek managed to decode the manual and found out that the goal is to replace each \'#\' with one or more \')\' characters so that the final string becomes beautiful. Below there was also written that a string is called beautiful if for each i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|s|) there are no more \')\' characters than \'(\' characters among the first i characters of s and also the total number of \'(\' characters is equal to the total number of \')\' characters. Help Malek open the door by telling him for each \'#\' character how many \')\' characters he must replace it with." 1500

493E "Vasya and Polynomial" math "Vasya is studying in the last class of school and soon he will take exams. He decided to study polynomials. Polynomial is a function P(x)\xe2\x80\x89=\xe2\x80\x89a0\xe2\x80\x89+\xe2\x80\x89a1x1\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89anxn. Numbers ai are called coefficients of a polynomial, non-negative integer n is called a degree of a polynomial.Vasya has made a bet with his friends that he can solve any problem with polynomials. They suggested him the problem: ""Determine how many polynomials P(x) exist with integer non-negative coefficients so that , and , where  and b are given positive integers""? Vasya does not like losing bets, but he has no idea how to solve this task, so please help him to solve the problem." 2800

493D "Vasya and Chess" "constructive algorithms,games,math" "Vasya decided to learn to play chess. Classic chess doesn\'t seem interesting to him, so he plays his own sort of chess.The queen is the piece that captures all squares on its vertical, horizontal and diagonal lines. If the cell is located on the same vertical, horizontal or diagonal line with queen, and the cell contains a piece of the enemy color, the queen is able to move to this square. After that the enemy\'s piece is removed from the board. The queen cannot move to a cell containing an enemy piece if there is some other piece between it and the queen. There is an n\xe2\x80\x89\xc3\x97\xe2\x80\x89n chessboard. We\'ll denote a cell on the intersection of the r-th row and c-th column as (r,\xe2\x80\x89c). The square (1,\xe2\x80\x891) contains the white queen and the square (1,\xe2\x80\x89n) contains the black queen. All other squares contain green pawns that don\'t belong to anyone.The players move in turns. The player that moves first plays for the white queen, his opponent plays for the black queen.On each move the player has to capture some piece with his queen (that is, move to a square that contains either a green pawn or the enemy queen). The player loses if either he cannot capture any piece during his move or the opponent took his queen during the previous move. Help Vasya determine who wins if both players play with an optimal strategy on the board n\xe2\x80\x89\xc3\x97\xe2\x80\x89n." 1700

493C "Vasya and Basketball" "binary search,brute force,data structures,implementation,sortings,two pointers" "Vasya follows a basketball game and marks the distances from which each team makes a throw. He knows that each successful throw has value of either 2 or 3 points. A throw is worth 2 points if the distance it was made from doesn\'t exceed some value of d meters, and a throw is worth 3 points if the distance is larger than d meters, where d is some non-negative integer.Vasya would like the advantage of the points scored by the first team (the points of the first team minus the points of the second team) to be maximum. For that he can mentally choose the value of d. Help him to do that." 1600

493B "Vasya and Wrestling" implementation "Vasya has become interested in wrestling. In wrestling wrestlers use techniques for which they are awarded points by judges. The wrestler who gets the most points wins.When the numbers of points of both wrestlers are equal, the wrestler whose sequence of points is lexicographically greater, wins.If the sequences of the awarded points coincide, the wrestler who performed the last technique wins. Your task is to determine which wrestler won." 1400

493A "Vasya and Football" implementation "Vasya has started watching football games. He has learned that for some fouls the players receive yellow cards, and for some fouls they receive red cards. A player who receives the second yellow card automatically receives a red card.Vasya is watching a recorded football match now and makes notes of all the fouls that he would give a card for. Help Vasya determine all the moments in time when players would be given red cards if Vasya were the judge. For each player, Vasya wants to know only the first moment of time when he would receive a red card from Vasya." 1300

492E "Vanya and Field" math "Vanya decided to walk in the field of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89n cells. The field contains m apple trees, the i-th apple tree is at the cell with coordinates (xi,\xe2\x80\x89yi). Vanya moves towards vector (dx,\xe2\x80\x89dy). That means that if Vanya is now at the cell (x,\xe2\x80\x89y), then in a second he will be at cell . The following condition is satisfied for the vector: , where  is the largest integer that divides both a and b. Vanya ends his path when he reaches the square he has already visited. Vanya wonders, from what square of the field he should start his path to see as many apple trees as possible." 2000

492D "Vanya and Computer Game" "binary search,implementation,math,sortings" "Vanya and his friend Vova play a computer game where they need to destroy n monsters to pass a level. Vanya\'s character performs attack with frequency x hits per second and Vova\'s character performs attack with frequency y hits per second. Each character spends fixed time to raise a weapon and then he hits (the time to raise the weapon is 1\xe2\x80\x89/\xe2\x80\x89x seconds for the first character and 1\xe2\x80\x89/\xe2\x80\x89y seconds for the second one). The i-th monster dies after he receives ai hits. Vanya and Vova wonder who makes the last hit on each monster. If Vanya and Vova make the last hit at the same time, we assume that both of them have made the last hit." 1800

492C "Vanya and Exams" greedy,sortings "Vanya wants to pass n exams and get the academic scholarship. He will get the scholarship if the average grade mark for all the exams is at least avg. The exam grade cannot exceed r. Vanya has passed the exams and got grade ai for the i-th exam. To increase the grade for the i-th exam by 1 point, Vanya must write bi essays. He can raise the exam grade multiple times.What is the minimum number of essays that Vanya needs to write to get scholarship?" 1400

492B "Vanya and Lanterns" "binary search,implementation,math,sortings" "Vanya walks late at night along a straight street of length l, lit by n lanterns. Consider the coordinate system with the beginning of the street corresponding to the point 0, and its end corresponding to the point l. Then the i-th lantern is at the point ai. The lantern lights all points of the street that are at the distance of at most d from it, where d is some positive number, common for all lanterns. Vanya wonders: what is the minimum light radius d should the lanterns have to light the whole street?" 1200

492A "Vanya and Cubes" implementation "Vanya got n cubes. He decided to build a pyramid from them. Vanya wants to build the pyramid as follows: the top level of the pyramid must consist of 1 cube, the second level must consist of 1\xe2\x80\x89+\xe2\x80\x892\xe2\x80\x89=\xe2\x80\x893 cubes, the third level must have 1\xe2\x80\x89+\xe2\x80\x892\xe2\x80\x89+\xe2\x80\x893\xe2\x80\x89=\xe2\x80\x896 cubes, and so on. Thus, the i-th level of the pyramid must have 1\xe2\x80\x89+\xe2\x80\x892\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89(i\xe2\x80\x89-\xe2\x80\x891)\xe2\x80\x89+\xe2\x80\x89i cubes.Vanya wants to know what is the maximum height of the pyramid that he can make using the given cubes." 800

491C Deciphering "flows,graph matchings" "One day Maria Ivanovna found a Sasha\'s piece of paper with a message dedicated to Olya. Maria Ivanovna wants to know what is there in a message, but unfortunately the message is ciphered. Maria Ivanovna knows that her students usually cipher their messages by replacing each letter of an original message by some another letter. Replacement works in such way that same letters are always replaced with some fixed letter, and different letters are always replaced by different letters. Maria Ivanovna supposed that the message contains answers to the final exam (since its length is equal to the number of final exam questions). On the other hand she knows that Sasha\'s answer are not necessary correct. There are K possible answers for each questions. Of course, Maria Ivanovna knows correct answers.Maria Ivanovna decided to decipher message in such way that the number of Sasha\'s correct answers is maximum possible. She is very busy now, so your task is to help her." 2300

491B "New York Hotel" greedy,math "Think of New York as a rectangular grid consisting of N vertical avenues numerated from 1 to N and M horizontal streets numerated 1 to M. C friends are staying at C hotels located at some street-avenue crossings. They are going to celebrate birthday of one of them in the one of H restaurants also located at some street-avenue crossings. They also want that the maximum distance covered by one of them while traveling to the restaurant to be minimum possible. Help friends choose optimal restaurant for a celebration.Suppose that the distance between neighboring crossings are all the same equal to one kilometer." 2100

491A "Up the hill" "constructive algorithms,implementation" "Hiking club ""Up the hill"" just returned from a walk. Now they are trying to remember which hills they\'ve just walked through.It is known that there were N stops, all on different integer heights between 1 and N kilometers (inclusive) above the sea level. On the first day they\'ve traveled from the first stop to the second stop, on the second day they\'ve traveled from the second to the third and so on, and on the last day they\'ve traveled from the stop N\xe2\x80\x89-\xe2\x80\x891 to the stop N and successfully finished their expedition.They are trying to find out which heights were their stops located at. They have an entry in a travel journal specifying how many days did they travel up the hill, and how many days did they walk down the hill.Help them by suggesting some possible stop heights satisfying numbers from the travel journal." 1000

490F "Treeland Tour" "data structures,dfs and similar,dp,trees" "The ""Road Accident"" band is planning an unprecedented tour around Treeland. The RA fans are looking forward to the event and making bets on how many concerts their favorite group will have.Treeland consists of n cities, some pairs of cities are connected by bidirectional roads. Overall the country has n\xe2\x80\x89-\xe2\x80\x891 roads. We know that it is possible to get to any city from any other one. The cities are numbered by integers from 1 to n. For every city we know its value ri \xe2\x80\x94 the number of people in it.We know that the band will travel along some path, having concerts in some cities along the path. The band\'s path will not pass one city twice, each time they move to the city that hasn\'t been previously visited. Thus, the musicians will travel along some path (without visiting any city twice) and in some (not necessarily all) cities along the way they will have concerts.The band plans to gather all the big stadiums and concert halls during the tour, so every time they will perform in a city which population is larger than the population of the previously visited with concert city. In other words, the sequence of population in the cities where the concerts will be held is strictly increasing.In a recent interview with the leader of the ""road accident"" band promised to the fans that the band will give concert in the largest possible number of cities! Thus the band will travel along some chain of cities of Treeland and have concerts in some of these cities, so that the population number will increase, and the number of concerts will be the largest possible.The fans of Treeland are frantically trying to figure out how many concerts the group will have in Treeland. Looks like they can\'t manage without some help from a real programmer! Help the fans find the sought number of concerts." 2200

490E "Restoring Increasing Sequence" "binary search,brute force,greedy,implementation" "Peter wrote on the board a strictly increasing sequence of positive integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. Then Vasil replaced some digits in the numbers of this sequence by question marks. Thus, each question mark corresponds to exactly one lost digit.Restore the the original sequence knowing digits remaining on the board." 2000

490D Chocolate "brute force,dfs and similar,math,meet-in-the-middle,number theory" "Polycarpus likes giving presents to Paraskevi. He has bought two chocolate bars, each of them has the shape of a segmented rectangle. The first bar is a1\xe2\x80\x89\xc3\x97\xe2\x80\x89b1 segments large and the second one is a2\xe2\x80\x89\xc3\x97\xe2\x80\x89b2 segments large.Polycarpus wants to give Paraskevi one of the bars at the lunch break and eat the other one himself. Besides, he wants to show that Polycarpus\'s mind and Paraskevi\'s beauty are equally matched, so the two bars must have the same number of squares.To make the bars have the same number of squares, Polycarpus eats a little piece of chocolate each minute. Each minute he does the following:  he either breaks one bar exactly in half (vertically or horizontally) and eats exactly a half of the bar,  or he chips of exactly one third of a bar (vertically or horizontally) and eats exactly a third of the bar. In the first case he is left with a half, of the bar and in the second case he is left with two thirds of the bar.Both variants aren\'t always possible, and sometimes Polycarpus cannot chip off a half nor a third. For example, if the bar is 16\xe2\x80\x89\xc3\x97\xe2\x80\x8923, then Polycarpus can chip off a half, but not a third. If the bar is 20\xe2\x80\x89\xc3\x97\xe2\x80\x8918, then Polycarpus can chip off both a half and a third. If the bar is 5\xe2\x80\x89\xc3\x97\xe2\x80\x897, then Polycarpus cannot chip off a half nor a third.What is the minimum number of minutes Polycarpus needs to make two bars consist of the same number of squares? Find not only the required minimum number of minutes, but also the possible sizes of the bars after the process." 1900

490C "Hacking Cypher" "brute force,math,number theory,strings" "Polycarpus participates in a competition for hacking into a new secure messenger. He\'s almost won.Having carefully studied the interaction protocol, Polycarpus came to the conclusion that the secret key can be obtained if he properly cuts the public key of the application into two parts. The public key is a long integer which may consist of even a million digits!Polycarpus needs to find such a way to cut the public key into two nonempty parts, that the first (left) part is divisible by a as a separate number, and the second (right) part is divisible by b as a separate number. Both parts should be positive integers that have no leading zeros. Polycarpus knows values a and b.Help Polycarpus and find any suitable method to cut the public key." 1700

490B Queue dsu,implementation "During the lunch break all n Berland State University students lined up in the food court. However, it turned out that the food court, too, has a lunch break and it temporarily stopped working.Standing in a queue that isn\'t being served is so boring! So, each of the students wrote down the number of the student ID of the student that stands in line directly in front of him, and the student that stands in line directly behind him. If no one stands before or after a student (that is, he is the first one or the last one), then he writes down number 0 instead (in Berland State University student IDs are numerated from 1).After that, all the students went about their business. When they returned, they found out that restoring the queue is not such an easy task.Help the students to restore the state of the queue by the numbers of the student ID\'s of their neighbors in the queue." 1500

490A "Team Olympiad" greedy,implementation,sortings "The School \xe2\x84\x960 of the capital of Berland has n children studying in it. All the children in this school are gifted: some of them are good at programming, some are good at maths, others are good at PE (Physical Education). Hence, for each child we know value ti:  ti\xe2\x80\x89=\xe2\x80\x891, if the i-th child is good at programming,  ti\xe2\x80\x89=\xe2\x80\x892, if the i-th child is good at maths,  ti\xe2\x80\x89=\xe2\x80\x893, if the i-th child is good at PE Each child happens to be good at exactly one of these three subjects.The Team Scientific Decathlon Olympias requires teams of three students. The school teachers decided that the teams will be composed of three children that are good at different subjects. That is, each team must have one mathematician, one programmer and one sportsman. Of course, each child can be a member of no more than one team.What is the maximum number of teams that the school will be able to present at the Olympiad? How should the teams be formed for that?" 800

489F "Special Matrices" combinatorics,dp "An n\xe2\x80\x89\xc3\x97\xe2\x80\x89n square matrix is special, if:  it is binary, that is, each cell contains either a 0, or a 1;  the number of ones in each row and column equals 2. You are given n and the first m rows of the matrix. Print the number of special n\xe2\x80\x89\xc3\x97\xe2\x80\x89n matrices, such that the first m rows coincide with the given ones.As the required value can be rather large, print the remainder after dividing the value by the given number mod." 2100

489E Hiking "binary search,dp" "A traveler is planning a water hike along the river. He noted the suitable rest points for the night and wrote out their distances from the starting point. Each of these locations is further characterized by its picturesqueness, so for the i-th rest point the distance from the start equals xi, and its picturesqueness equals bi. The traveler will move down the river in one direction, we can assume that he will start from point 0 on the coordinate axis and rest points are points with coordinates xi.Every day the traveler wants to cover the distance l. In practice, it turns out that this is not always possible, because he needs to end each day at one of the resting points. In addition, the traveler is choosing between two desires: cover distance l every day and visit the most picturesque places.Let\'s assume that if the traveler covers distance rj in a day, then he feels frustration , and his total frustration over the hike is calculated as the total frustration on all days.Help him plan the route so as to minimize the relative total frustration: the total frustration divided by the total picturesqueness of all the rest points he used.The traveler\'s path must end in the farthest rest point." 2300

489D "Unbearable Controversy of Being" "brute force,combinatorics,dfs and similar,graphs" "Tomash keeps wandering off and getting lost while he is walking along the streets of Berland. It\'s no surprise! In his home town, for any pair of intersections there is exactly one way to walk from one intersection to the other one. The capital of Berland is very different!Tomash has noticed that even simple cases of ambiguity confuse him. So, when he sees a group of four distinct intersections a, b, c and d, such that there are two paths from a to c \xe2\x80\x94 one through b and the other one through d, he calls the group a ""damn rhombus"". Note that pairs (a,\xe2\x80\x89b), (b,\xe2\x80\x89c), (a,\xe2\x80\x89d), (d,\xe2\x80\x89c) should be directly connected by the roads. Schematically, a damn rhombus is shown on the figure below:  Other roads between any of the intersections don\'t make the rhombus any more appealing to Tomash, so the four intersections remain a ""damn rhombus"" for him.Given that the capital of Berland has n intersections and m roads and all roads are unidirectional and are known in advance, find the number of ""damn rhombi"" in the city.When rhombi are compared, the order of intersections b and d doesn\'t matter." 1700

489C "Given Length and Sum of Digits..." dp,greedy,implementation "You have a positive integer m and a non-negative integer s. Your task is to find the smallest and the largest of the numbers that have length m and sum of digits s. The required numbers should be non-negative integers written in the decimal base without leading zeroes." 1400

489B "BerSU Ball" "dfs and similar,dp,graph matchings,greedy,sortings,two pointers" "The Berland State University is hosting a ballroom dance in celebration of its 100500-th anniversary! n boys and m girls are already busy rehearsing waltz, minuet, polonaise and quadrille moves.We know that several boy&girl pairs are going to be invited to the ball. However, the partners\' dancing skill in each pair must differ by at most one.For each boy, we know his dancing skills. Similarly, for each girl we know her dancing skills. Write a code that can determine the largest possible number of pairs that can be formed from n boys and m girls." 1200

489A SwapSort greedy,implementation,sortings "In this problem your goal is to sort an array consisting of n integers in at most n swaps. For the given array find the sequence of swaps that makes the array sorted in the non-descending order. Swaps are performed consecutively, one after another.Note that in this problem you do not have to minimize the number of swaps \xe2\x80\x94 your task is to find any sequence that is no longer than n." 1200

488B "Candy Boxes" "brute force,constructive algorithms,math" "There is an old tradition of keeping 4 boxes of candies in the house in Cyberland. The numbers of candies are special if their arithmetic mean, their median and their range are all equal. By definition, for a set {x1,\xe2\x80\x89x2,\xe2\x80\x89x3,\xe2\x80\x89x4} (x1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x3\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x4) arithmetic mean is , median is  and range is x4\xe2\x80\x89-\xe2\x80\x89x1. The arithmetic mean and median are not necessary integer. It is well-known that if those three numbers are same, boxes will create a ""debugging field"" and codes in the field will have no bugs.For example, 1,\xe2\x80\x891,\xe2\x80\x893,\xe2\x80\x893 is the example of 4 numbers meeting the condition because their mean, median and range are all equal to 2.Jeff has 4 special boxes of candies. However, something bad has happened! Some of the boxes could have been lost and now there are only n (0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x894) boxes remaining. The i-th remaining box contains ai candies.Now Jeff wants to know: is there a possible way to find the number of candies of the 4\xe2\x80\x89-\xe2\x80\x89n missing boxes, meeting the condition above (the mean, median and range are equal)?" 1900

488A "Giga Tower" "brute force" "Giga Tower is the tallest and deepest building in Cyberland. There are 17\xe2\x80\x89777\xe2\x80\x89777\xe2\x80\x89777 floors, numbered from \xe2\x80\x89-\xe2\x80\x898\xe2\x80\x89888\xe2\x80\x89888\xe2\x80\x89888 to 8\xe2\x80\x89888\xe2\x80\x89888\xe2\x80\x89888. In particular, there is floor 0 between floor \xe2\x80\x89-\xe2\x80\x891 and floor 1. Every day, thousands of tourists come to this place to enjoy the wonderful view. In Cyberland, it is believed that the number ""8"" is a lucky number (that\'s why Giga Tower has 8\xe2\x80\x89888\xe2\x80\x89888\xe2\x80\x89888 floors above the ground), and, an integer is lucky, if and only if its decimal notation contains at least one digit ""8"". For example, 8,\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x89180,\xe2\x80\x89808 are all lucky while 42,\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x8910 are not. In the Giga Tower, if you write code at a floor with lucky floor number, good luck will always be with you (Well, this round is #278, also lucky, huh?).Tourist Henry goes to the tower to seek good luck. Now he is at the floor numbered a. He wants to find the minimum positive integer b, such that, if he walks b floors higher, he will arrive at a floor with a lucky number." 1100

487E Tourists "data structures,dfs and similar,graphs,trees" "There are n cities in Cyberland, numbered from 1 to n, connected by m bidirectional roads. The j-th road connects city aj and bj.For tourists, souvenirs are sold in every city of Cyberland. In particular, city i sell it at a price of wi.Now there are q queries for you to handle. There are two types of queries: ""C a w"": The price in city a is changed to w. ""A a b"": Now a tourist will travel from city a to b. He will choose a route, he also doesn\'t want to visit a city twice. He will buy souvenirs at the city where the souvenirs are the cheapest (possibly exactly at city a or b). You should output the minimum possible price that he can buy the souvenirs during his travel.More formally, we can define routes as follow: A route is a sequence of cities [x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xk], where k is a certain positive integer. For any 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k,\xe2\x80\x89xi\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89xj. For any 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89k, there is a road connecting xi and xi\xe2\x80\x89+\xe2\x80\x891. The minimum price of the route is min(wx1,\xe2\x80\x89wx2,\xe2\x80\x89...,\xe2\x80\x89wxk). The required answer is the minimum value of the minimum prices of all valid routes from a to b." 3200

487D "Conveyor Belts" "data structures" "Automatic Bakery of Cyberland (ABC) recently bought an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m rectangle table. To serve the diners, ABC placed seats around the table. The size of each seat is equal to a unit square, so there are 2(n\xe2\x80\x89+\xe2\x80\x89m) seats in total.ABC placed conveyor belts on each unit square on the table. There are three types of conveyor belts: ""^"", ""<"" and "">"". A ""^"" belt can bring things upwards. ""<"" can bring leftwards and "">"" can bring rightwards.Let\'s number the rows with 1 to n from top to bottom, the columns with 1 to m from left to right. We consider the seats above and below the top of the table are rows 0 and n\xe2\x80\x89+\xe2\x80\x891 respectively. Also we define seats to the left of the table and to the right of the table to be column 0 and m\xe2\x80\x89+\xe2\x80\x891. Due to the conveyor belts direction restriction there are currently no way for a diner sitting in the row n\xe2\x80\x89+\xe2\x80\x891 to be served.Given the initial table, there will be q events in order. There are two types of events:  ""A x y"" means, a piece of bread will appear at row x and column y (we will denote such position as (x,\xe2\x80\x89y)). The bread will follow the conveyor belt, until arriving at a seat of a diner. It is possible that the bread gets stuck in an infinite loop. Your task is to simulate the process, and output the final position of the bread, or determine that there will be an infinite loop.  ""C x y c"" means that the type of the conveyor belt at (x,\xe2\x80\x89y) is changed to c. Queries are performed separately meaning that even if the bread got stuck in an infinite loop, it won\'t affect further queries." 2700

487C "Prefix Product Sequence" "constructive algorithms,math,number theory" "Consider a sequence [a1,\xe2\x80\x89a2,\xe2\x80\x89... ,\xe2\x80\x89an]. Define its prefix product sequence .Now given n, find a permutation of [1,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89n], such that its prefix product sequence is a permutation of [0,\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x891]." 2300

487B Strip "binary search,data structures,dp,two pointers" "Alexandra has a paper strip with n numbers on it. Let\'s call them ai from left to right.Now Alexandra wants to split it into some pieces (possibly 1). For each piece of strip, it must satisfy: Each piece should contain at least l numbers. The difference between the maximal and the minimal number on the piece should be at most s.Please help Alexandra to find the minimal number of pieces meeting the condition above." 2000

487A "Fight the Monster" "binary search,brute force,implementation" "A monster is attacking the Cyberland!Master Yang, a braver, is going to beat the monster. Yang and the monster each have 3 attributes: hitpoints (HP), offensive power (ATK) and defensive power (DEF).During the battle, every second the monster\'s HP decrease by max(0,\xe2\x80\x89ATKY\xe2\x80\x89-\xe2\x80\x89DEFM), while Yang\'s HP decreases by max(0,\xe2\x80\x89ATKM\xe2\x80\x89-\xe2\x80\x89DEFY), where index Y denotes Master Yang and index M denotes monster. Both decreases happen simultaneously Once monster\'s HP\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x890 and the same time Master Yang\'s HP\xe2\x80\x89>\xe2\x80\x890, Master Yang wins.Master Yang can buy attributes from the magic shop of Cyberland: h bitcoins per HP, a bitcoins per ATK, and d bitcoins per DEF.Now Master Yang wants to know the minimum number of bitcoins he can spend in order to win." 1800

486E "LIS of Sequence" "data structures,dp,greedy,hashing,math" "The next ""Data Structures and Algorithms"" lesson will be about Longest Increasing Subsequence (LIS for short) of a sequence. For better understanding, Nam decided to learn it a few days before the lesson.Nam created a sequence a consisting of n (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89105) elements a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ai\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89105). A subsequence ai1,\xe2\x80\x89ai2,\xe2\x80\x89...,\xe2\x80\x89aik where 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i1\xe2\x80\x89<\xe2\x80\x89i2\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89ik\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n is called increasing if ai1\xe2\x80\x89<\xe2\x80\x89ai2\xe2\x80\x89<\xe2\x80\x89ai3\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89aik. An increasing subsequence is called longest if it has maximum length among all increasing subsequences. Nam realizes that a sequence may have several longest increasing subsequences. Hence, he divides all indexes i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n), into three groups: group of all i such that ai belongs to no longest increasing subsequences. group of all i such that ai belongs to at least one but not every longest increasing subsequence. group of all i such that ai belongs to every longest increasing subsequence. Since the number of longest increasing subsequences of a may be very large, categorizing process is very difficult. Your task is to help him finish this job." 2200

486D "Valid Sets" "dfs and similar,dp,math,trees" "As you know, an undirected connected graph with n nodes and n\xe2\x80\x89-\xe2\x80\x891 edges is called a tree. You are given an integer d and a tree consisting of n nodes. Each node i has a value ai associated with it.We call a set S of tree nodes valid if following conditions are satisfied: S is non-empty. S is connected. In other words, if nodes u and v are in S, then all nodes lying on the simple path between u and v should also be presented in S. .Your task is to count the number of valid sets. Since the result can be very large, you must print its remainder modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." 2100

486C "Palindrome Transformation" "brute force,greedy,implementation" "Nam is playing with a string on his computer. The string consists of n lowercase English letters. It is meaningless, so Nam decided to make the string more beautiful, that is to make it be a palindrome by using 4 arrow keys: left, right, up, down.There is a cursor pointing at some symbol of the string. Suppose that cursor is at position i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n, the string uses 1-based indexing) now. Left and right arrow keys are used to move cursor around the string. The string is cyclic, that means that when Nam presses left arrow key, the cursor will move to position i\xe2\x80\x89-\xe2\x80\x891 if i\xe2\x80\x89>\xe2\x80\x891 or to the end of the string (i. e. position n) otherwise. The same holds when he presses the right arrow key (if i\xe2\x80\x89=\xe2\x80\x89n, the cursor appears at the beginning of the string).When Nam presses up arrow key, the letter which the text cursor is pointing to will change to the next letter in English alphabet (assuming that alphabet is also cyclic, i. e. after \'z\' follows \'a\'). The same holds when he presses the down arrow key.Initially, the text cursor is at position p. Because Nam has a lot homework to do, he wants to complete this as fast as possible. Can you help him by calculating the minimum number of arrow keys presses to make the string to be a palindrome?" 1700

486B "OR in Matrix" greedy,hashing,implementation "Let\'s define logical OR as an operation on two logical values (i. e. values that belong to the set {0,\xe2\x80\x891}) that is equal to 1 if either or both of the logical values is set to 1, otherwise it is 0. We can define logical OR of three or more logical values in the same manner: where  is equal to 1 if some ai\xe2\x80\x89=\xe2\x80\x891, otherwise it is equal to 0.Nam has a matrix A consisting of m rows and n columns. The rows are numbered from 1 to m, columns are numbered from 1 to n. Element at row i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m) and column j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) is denoted as Aij. All elements of A are either 0 or 1. From matrix A, Nam creates another matrix B of the same size using formula:.(Bij is OR of all elements in row i and column j of matrix A)Nam gives you matrix B and challenges you to guess matrix A. Although Nam is smart, he could probably make a mistake while calculating matrix B, since size of A can be large." 1300

486A "Calculating Function" implementation,math "For a positive integer n let\'s define a function f:f(n)\xe2\x80\x89=\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x892\xe2\x80\x89-\xe2\x80\x893\xe2\x80\x89+\xe2\x80\x89..\xe2\x80\x89+\xe2\x80\x89(\xe2\x80\x89-\xe2\x80\x891)nn Your task is to calculate f(n) for a given integer n." 800

485B "Valuable Resources" "brute force,greedy" "Many computer strategy games require building cities, recruiting army, conquering tribes, collecting resources. Sometimes it leads to interesting problems. Let\'s suppose that your task is to build a square city. The world map uses the Cartesian coordinates. The sides of the city should be parallel to coordinate axes. The map contains mines with valuable resources, located at some points with integer coordinates. The sizes of mines are relatively small, i.e. they can be treated as points. The city should be built in such a way that all the mines are inside or on the border of the city square. Building a city takes large amount of money depending on the size of the city, so you have to build the city with the minimum area. Given the positions of the mines find the minimum possible area of the city." 1300

485A Factory implementation,math,matrices "One industrial factory is reforming working plan. The director suggested to set a mythical detail production norm. If at the beginning of the day there were x details in the factory storage, then by the end of the day the factory has to produce  (remainder after dividing x by m) more details. Unfortunately, no customer has ever bought any mythical detail, so all the details produced stay on the factory. The board of directors are worried that the production by the given plan may eventually stop (that means that there will be \xd0\xb0 moment when the current number of details on the factory is divisible by m). Given the number of details a on the first day and number m check if the production stops at some moment." 1400

484E "Sign on Fence" "binary search,constructive algorithms,data structures" "Bizon the Champion has recently finished painting his wood fence. The fence consists of a sequence of n panels of 1 meter width and of arbitrary height. The i-th panel\'s height is hi meters. The adjacent planks follow without a gap between them.After Bizon painted the fence he decided to put a ""for sale"" sign on it. The sign will be drawn on a rectangular piece of paper and placed on the fence so that the sides of the sign are parallel to the fence panels and are also aligned with the edges of some panels. Bizon the Champion introduced the following constraints for the sign position:  The width of the sign should be exactly w meters.  The sign must fit into the segment of the fence from the l-th to the r-th panels, inclusive (also, it can\'t exceed the fence\'s bound in vertical direction). The sign will be really pretty, So Bizon the Champion wants the sign\'s height to be as large as possible.You are given the description of the fence and several queries for placing sign. For each query print the maximum possible height of the sign that can be placed on the corresponding segment of the fence with the given fixed width of the sign." 2500

484D Kindergarten "data structures,dp,greedy" "In a kindergarten, the children are being divided into groups. The teacher put the children in a line and associated each child with his or her integer charisma value. Each child should go to exactly one group. Each group should be a nonempty segment of consecutive children of a line. A group\'s sociability is the maximum difference of charisma of two children in the group (in particular, if the group consists of one child, its sociability equals a zero). The teacher wants to divide the children into some number of groups in such way that the total sociability of the groups is maximum. Help him find this value." 2400

484C "Strange Sorting" implementation,math "How many specific orders do you know? Ascending order, descending order, order of ascending length, order of ascending polar angle... Let\'s have a look at another specific order: d-sorting. This sorting is applied to the strings of length at least d, where d is some positive integer. The characters of the string are sorted in following manner: first come all the 0-th characters of the initial string, then the 1-st ones, then the 2-nd ones and so on, in the end go all the (d\xe2\x80\x89-\xe2\x80\x891)-th characters of the initial string. By the i-th characters we mean all the character whose positions are exactly i modulo d. If two characters stand on the positions with the same remainder of integer division by d, their relative order after the sorting shouldn\'t be changed. The string is zero-indexed. For example, for string \'qwerty\':Its 1-sorting is the string \'qwerty\' (all characters stand on 0 positions),Its 2-sorting is the string \'qetwry\' (characters \'q\', \'e\' and \'t\' stand on 0 positions and characters \'w\', \'r\' and \'y\' are on 1 positions),Its 3-sorting is the string \'qrwtey\' (characters \'q\' and \'r\' stand on 0 positions, characters \'w\' and \'t\' stand on 1 positions and characters \'e\' and \'y\' stand on 2 positions),Its 4-sorting is the string \'qtwyer\',Its 5-sorting is the string \'qywert\'.You are given string S of length n and m shuffling operations of this string. Each shuffling operation accepts two integer arguments k and d and transforms string S as follows. For each i from 0 to n\xe2\x80\x89-\xe2\x80\x89k in the increasing order we apply the operation of d-sorting to the substring S[i..i\xe2\x80\x89+\xe2\x80\x89k\xe2\x80\x89-\xe2\x80\x891]. Here S[a..b] represents a substring that consists of characters on positions from a to b inclusive.After each shuffling operation you need to print string S." 2600

484B "Maximum Value" "binary search,math,sortings,two pointers" "You are given a sequence a consisting of n integers. Find the maximum possible value of  (integer remainder of ai divided by aj), where 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i,\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n and ai\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89aj." 2100

484A Bits "bitmasks,constructive algorithms" "Let\'s denote as  the number of bits set (\'1\' bits) in the binary representation of the non-negative integer x.You are given multiple queries consisting of pairs of integers l and r. For each query, find the x, such that l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r, and  is maximum possible. If there are multiple such numbers find the smallest of them." 1700

483B "Friends and Presents" "binary search,math" "You have two friends. You want to present each of them several positive integers. You want to present cnt1 numbers to the first friend and cnt2 numbers to the second friend. Moreover, you want all presented numbers to be distinct, that also means that no number should be presented to both friends.In addition, the first friend does not like the numbers that are divisible without remainder by prime number x. The second one does not like the numbers that are divisible without remainder by prime number y. Of course, you\'re not going to present your friends numbers they don\'t like.Your task is to find such minimum number v, that you can form presents using numbers from a set 1,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89v. Of course you may choose not to present some numbers at all.A positive integer number greater than 1 is called prime if it has no positive divisors other than 1 and itself." 1800

483A Counterexample "brute force,implementation,math,number theory" "Your friend has recently learned about coprime numbers. A pair of numbers {a,\xe2\x80\x89b} is called coprime if the maximum number that divides both a and b is equal to one. Your friend often comes up with different statements. He has recently supposed that if the pair (a,\xe2\x80\x89b) is coprime and the pair (b,\xe2\x80\x89c) is coprime, then the pair (a,\xe2\x80\x89c) is coprime. You want to find a counterexample for your friend\'s statement. Therefore, your task is to find three distinct numbers (a,\xe2\x80\x89b,\xe2\x80\x89c), for which the statement is false, and the numbers meet the condition l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a\xe2\x80\x89<\xe2\x80\x89b\xe2\x80\x89<\xe2\x80\x89c\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r. More specifically, you need to find three numbers (a,\xe2\x80\x89b,\xe2\x80\x89c), such that l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a\xe2\x80\x89<\xe2\x80\x89b\xe2\x80\x89<\xe2\x80\x89c\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r, pairs (a,\xe2\x80\x89b) and (b,\xe2\x80\x89c) are coprime, and pair (a,\xe2\x80\x89c) is not coprime." 1100

482E ELCA "data structures,trees" "You have a root tree containing n vertexes. Let\'s number the tree vertexes with integers from 1 to n. The tree root is in the vertex 1.Each vertex (except fot the tree root) v has a direct ancestor pv. Also each vertex v has its integer value sv. Your task is to perform following queries:  P v u (u\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89v). If u isn\'t in subtree of v, you must perform the assignment pv\xe2\x80\x89=\xe2\x80\x89u. Otherwise you must perform assignment pu\xe2\x80\x89=\xe2\x80\x89v. Note that after this query the graph continues to be a tree consisting of n vertexes. V v t. Perform assignment sv\xe2\x80\x89=\xe2\x80\x89t. Your task is following. Before starting performing queries and after each query you have to calculate expected value written on the lowest common ancestor of two equiprobably selected vertices i and j. Here lowest common ancestor of i and j is the deepest vertex that lies on the both of the path from the root to vertex i and the path from the root to vertex j. Please note that the vertices i and j can be the same (in this case their lowest common ancestor coincides with them)." 3200

482D "Random Function and Tree" combinatorics,dp,trees "You have a rooted tree consisting of n vertices. Let\'s number them with integers from 1 to n inclusive. The root of the tree is the vertex 1. For each i\xe2\x80\x89>\xe2\x80\x891 direct parent of the vertex i is pi. We say that vertex i is child for its direct parent pi.You have initially painted all the vertices with red color. You like to repaint some vertices of the tree. To perform painting you use the function paint that you call with the root of the tree as an argument. Here is the pseudocode of this function:count = 0 // global integer variable rnd() { // this function is used in paint code    return 0 or 1 equiprobably}paint(s) {    if (count is even) then paint s with white color    else paint s with black color    count = count + 1        if rnd() = 1 then children = [array of vertex s children in ascending order of their numbers]    else children = [array of vertex s children in descending order of their numbers]    for child in children { // iterating over children array        if rnd() = 1 then paint(child) // calling paint recursively    }}As a result of this function, some vertices may change their colors to white or black and some of them may remain red.Your task is to determine the number of distinct possible colorings of the vertices of the tree. We will assume that the coloring is possible if there is a nonzero probability to get this coloring with a single call of paint(1). We assume that the colorings are different if there is a pair of vertices that are painted with different colors in these colorings. Since the required number may be very large, find its remainder of division by 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." 2700

482C "Game with Strings" bitmasks,dp,probabilities "You play the game with your friend. The description of this game is listed below. Your friend creates n distinct strings of the same length m and tells you all the strings. Then he randomly chooses one of them. He chooses strings equiprobably, i.e. the probability of choosing each of the n strings equals . You want to guess which string was chosen by your friend. In order to guess what string your friend has chosen, you are allowed to ask him questions. Each question has the following form: \xc2\xabWhat character stands on position pos in the string you have chosen?\xc2\xbb A string is considered guessed when the answers to the given questions uniquely identify the string. After the string is guessed, you stop asking questions. You do not have a particular strategy, so as each question you equiprobably ask about a position that hasn\'t been yet mentioned. Your task is to determine the expected number of questions needed to guess the string chosen by your friend." 2600

482B "Interesting Array" "constructive algorithms,data structures,trees" "We\'ll call an array of n non-negative integers a[1],\xe2\x80\x89a[2],\xe2\x80\x89...,\xe2\x80\x89a[n] interesting, if it meets m constraints. The i-th of the m constraints consists of three integers li, ri, qi (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89li\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ri\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) meaning that value  should be equal to qi. Your task is to find any interesting array of n elements or state that such array doesn\'t exist.Expression x&y means the bitwise AND of numbers x and y. In programming languages C++, Java and Python this operation is represented as ""&"", in Pascal \xe2\x80\x94 as ""and""." 1800

482A "Diverse Permutation" "constructive algorithms,greedy" "Permutation p is an ordered set of integers p1,\xe2\x80\x89\xe2\x80\x89\xe2\x80\x89p2,\xe2\x80\x89\xe2\x80\x89\xe2\x80\x89...,\xe2\x80\x89\xe2\x80\x89\xe2\x80\x89pn, consisting of n distinct positive integers not larger than n. We\'ll denote as n the length of permutation p1,\xe2\x80\x89\xe2\x80\x89\xe2\x80\x89p2,\xe2\x80\x89\xe2\x80\x89\xe2\x80\x89...,\xe2\x80\x89\xe2\x80\x89\xe2\x80\x89pn.Your task is to find such permutation p of length n, that the group of numbers |p1\xe2\x80\x89-\xe2\x80\x89p2|,\xe2\x80\x89|p2\xe2\x80\x89-\xe2\x80\x89p3|,\xe2\x80\x89...,\xe2\x80\x89|pn\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89-\xe2\x80\x89pn| has exactly k distinct elements." 1200

480E "Parking Lot" "data structures,divide and conquer" "Petya\'s been bored at work and he is killing the time by watching the parking lot at the office. The parking lot looks from above like an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m table (a cell of the table corresponds to a single parking spot). Some spots in the parking lot are taken, others are empty.Petya watches cars riding into the parking lot one by one. After a car settles down at the parking spot, Petya amuzes himself by counting what maximum square of empty spots (i.e. a square subtable) can be seen on the parking lot if we look at it from above. Also, he takes notes of the square\'s size (side length) in his notebook. You task is: given the state of the parking lot at the initial moment of time and the information about where the arriving cars park, restore what Petya wrote in his notebook. It is midday, so nobody leaves the lot." 2800

480D Parcels dp,graphs "Jaroslav owns a small courier service. He has recently got and introduced a new system of processing parcels. Each parcel is a box, the box has its weight and strength. The system works as follows. It originally has an empty platform where you can put boxes by the following rules:   If the platform is empty, then the box is put directly on the platform, otherwise it is put on the topmost box on the platform.  The total weight of all boxes on the platform cannot exceed the strength of platform S at any time.  The strength of any box of the platform at any time must be no less than the total weight of the boxes that stand above. You can take only the topmost box from the platform.The system receives n parcels, the i-th parcel arrives exactly at time ini, its weight and strength are equal to wi and si, respectively. Each parcel has a value of vi bourles. However, to obtain this value, the system needs to give the parcel exactly at time outi, otherwise Jaroslav will get 0 bourles for it. Thus, Jaroslav can skip any parcel and not put on the platform, formally deliver it at time ini and not get anything for it. Any operation in the problem is performed instantly. This means that it is possible to make several operations of receiving and delivering parcels at the same time and in any order. Please note that the parcel that is delivered at time outi, immediately gets outside of the system, and the following activities taking place at the same time are made \xe2\x80\x8b\xe2\x80\x8bwithout taking it into consideration. Since the system is very complex, and there are a lot of received parcels, Jaroslav asks you to say what maximum amount of money he can get using his system." 2600

479E "Riding in a Lift" combinatorics,dp "Imagine that you are in a building that has exactly n floors. You can move between the floors in a lift. Let\'s number the floors from bottom to top with integers from 1 to n. Now you\'re on the floor number a. You are very bored, so you want to take the lift. Floor number b has a secret lab, the entry is forbidden. However, you already are in the mood and decide to make k consecutive trips in the lift.Let us suppose that at the moment you are on the floor number x (initially, you were on floor a). For another trip between floors you choose some floor with number y (y\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89x) and the lift travels to this floor. As you cannot visit floor b with the secret lab, you decided that the distance from the current floor x to the chosen y must be strictly less than the distance from the current floor x to floor b with the secret lab. Formally, it means that the following inequation must fulfill: |x\xe2\x80\x89-\xe2\x80\x89y|\xe2\x80\x89<\xe2\x80\x89|x\xe2\x80\x89-\xe2\x80\x89b|. After the lift successfully transports you to floor y, you write down number y in your notepad.Your task is to find the number of distinct number sequences that you could have written in the notebook as the result of k trips in the lift. As the sought number of trips can be rather large, find the remainder after dividing the number by 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." 1900

479D "Long Jumps" "binary search,greedy,implementation" "Valery is a PE teacher at a school in Berland. Soon the students are going to take a test in long jumps, and Valery has lost his favorite ruler! However, there is no reason for disappointment, as Valery has found another ruler, its length is l centimeters. The ruler already has n marks, with which he can make measurements. We assume that the marks are numbered from 1 to n in the order they appear from the beginning of the ruler to its end. The first point coincides with the beginning of the ruler and represents the origin. The last mark coincides with the end of the ruler, at distance l from the origin. This ruler can be repesented by an increasing sequence a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an, where ai denotes the distance of the i-th mark from the origin (a1\xe2\x80\x89=\xe2\x80\x890, an\xe2\x80\x89=\xe2\x80\x89l).Valery believes that with a ruler he can measure the distance of d centimeters, if there is a pair of integers i and j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n), such that the distance between the i-th and the j-th mark is exactly equal to d (in other words, aj\xe2\x80\x89-\xe2\x80\x89ai\xe2\x80\x89=\xe2\x80\x89d). Under the rules, the girls should be able to jump at least x centimeters, and the boys should be able to jump at least y (x\xe2\x80\x89<\xe2\x80\x89y) centimeters. To test the children\'s abilities, Valery needs a ruler to measure each of the distances x and y. Your task is to determine what is the minimum number of additional marks you need to add on the ruler so that they can be used to measure the distances x and y. Valery can add the marks at any integer non-negative distance from the origin not exceeding the length of the ruler." 1700

479C Exams greedy,sortings "Student Valera is an undergraduate student at the University. His end of term exams are approaching and he is to pass exactly n exams. Valera is a smart guy, so he will be able to pass any exam he takes on his first try. Besides, he can take several exams on one day, and in any order.According to the schedule, a student can take the exam for the i-th subject on the day number ai. However, Valera has made an arrangement with each teacher and the teacher of the i-th subject allowed him to take an exam before the schedule time on day bi (bi\xe2\x80\x89<\xe2\x80\x89ai). Thus, Valera can take an exam for the i-th subject either on day ai, or on day bi. All the teachers put the record of the exam in the student\'s record book on the day of the actual exam and write down the date of the mark as number ai.Valera believes that it would be rather strange if the entries in the record book did not go in the order of non-decreasing date. Therefore Valera asks you to help him. Find the minimum possible value of the day when Valera can take the final exam if he takes exams so that all the records in his record book go in the order of non-decreasing date." 1400

479B Towers "brute force,constructive algorithms,greedy,implementation,sortings" "As you know, all the kids in Berland love playing with cubes. Little Petya has n towers consisting of cubes of the same size. Tower with number i consists of ai cubes stacked one on top of the other. Petya defines the instability of a set of towers as a value equal to the difference between the heights of the highest and the lowest of the towers. For example, if Petya built five cube towers with heights (8, 3, 2, 6, 3), the instability of this set is equal to 6 (the highest tower has height 8, the lowest one has height 2). The boy wants the instability of his set of towers to be as low as possible. All he can do is to perform the following operation several times: take the top cube from some tower and put it on top of some other tower of his set. Please note that Petya would never put the cube on the same tower from which it was removed because he thinks it\'s a waste of time. Before going to school, the boy will have time to perform no more than k such operations. Petya does not want to be late for class, so you have to help him accomplish this task." 1400

479A Expression "brute force,math" "Petya studies in a school and he adores Maths. His class has been studying arithmetic expressions. On the last class the teacher wrote three positive integers a, b, c on the blackboard. The task was to insert signs of operations \'+\' and \'*\', and probably brackets between the numbers so that the value of the resulting expression is as large as possible. Let\'s consider an example: assume that the teacher wrote numbers 1, 2 and 3 on the blackboard. Here are some ways of placing signs and brackets:  1+2*3=7  1*(2+3)=5  1*2*3=6  (1+2)*3=9 Note that you can insert operation signs only between a and b, and between b and c, that is, you cannot swap integers. For instance, in the given sample you cannot get expression (1+3)*2.It\'s easy to see that the maximum value that you can obtain is 9.Your task is: given a, b and c print the maximum value that you can get." 1000

478E "Wavy numbers" "brute force,dfs and similar,meet-in-the-middle,sortings" "A wavy number is such positive integer that for any digit of its decimal representation except for the first one and the last one following condition holds: the digit is either strictly larger than both its adjacent digits or strictly less than both its adjacent digits. For example, numbers 35270, 102, 747, 20 and 3 are wavy and numbers 123, 1000 and 2212 are not.The task is to find the k-th smallest wavy number r that is divisible by n for the given integer values n and k.You are to write a program that will find the value of r if it doesn\'t exceed 1014." 2900

478D "Red-Green Towers" dp "There are r red and g green blocks for construction of the red-green tower. Red-green tower can be built following next rules:  Red-green tower is consisting of some number of levels;  Let the red-green tower consist of n levels, then the first level of this tower should consist of n blocks, second level \xe2\x80\x94 of n\xe2\x80\x89-\xe2\x80\x891 blocks, the third one \xe2\x80\x94 of n\xe2\x80\x89-\xe2\x80\x892 blocks, and so on \xe2\x80\x94 the last level of such tower should consist of the one block. In other words, each successive level should contain one block less than the previous one;  Each level of the red-green tower should contain blocks of the same color.  Let h be the maximum possible number of levels of red-green tower, that can be built out of r red and g green blocks meeting the rules above. The task is to determine how many different red-green towers having h levels can be built out of the available blocks.Two red-green towers are considered different if there exists some level, that consists of red blocks in the one tower and consists of green blocks in the other tower.You are to write a program that will find the number of different red-green towers of height h modulo�109\xe2\x80\x89+\xe2\x80\x897." 2000

478C "Table Decorations" greedy "You have r red, g green and b blue balloons. To decorate a single table for the banquet you need exactly three balloons. Three balloons attached to some table shouldn\'t have the same color. What maximum number t of tables can be decorated if we know number of balloons of each color?Your task is to write a program that for given values r, g and b will find the maximum number t of tables, that can be decorated in the required manner." 1800

478B "Random Teams" "combinatorics,constructive algorithms,greedy,math" "n participants of the competition were split into m teams in some manner so that each team has at least one participant. After the competition each pair of participants from the same team became friends.Your task is to write a program that will find the minimum and the maximum number of pairs of friends that could have formed by the end of the competition." 1300

478A "Initial Bet" implementation "There are five people playing a game called ""Generosity"". Each person gives some non-zero number of coins b as an initial bet. After all players make their bets of b coins, the following operation is repeated for several times: a coin is passed from one player to some other player.Your task is to write a program that can, given the number of coins each player has at the end of the game, determine the size b of the initial bet or find out that such outcome of the game cannot be obtained for any positive number of coins b in the initial bet." 1100

477E "Dreamoon and Notepad" "data structures" "Dreamoon has just created a document of hard problems using notepad.exe. The document consists of n lines of text, ai denotes the length of the i-th line. He now wants to know what is the fastest way to move the cursor around because the document is really long.Let (r,\xe2\x80\x89c) be a current cursor position, where r is row number and c is position of cursor in the row. We have 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n and 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89c\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ar.We can use following six operations in notepad.exe to move our cursor assuming the current cursor position is at (r,\xe2\x80\x89c):  up key: the new cursor position (nr,\xe2\x80\x89nc)\xe2\x80\x89=\xe2\x80\x89(max(r\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x891),\xe2\x80\x89min(anr,\xe2\x80\x89c))  down key: the new cursor position (nr,\xe2\x80\x89nc)\xe2\x80\x89=\xe2\x80\x89(min(r\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89n),\xe2\x80\x89min(anr,\xe2\x80\x89c))  left key: the new cursor position (nr,\xe2\x80\x89nc)\xe2\x80\x89=\xe2\x80\x89(r,\xe2\x80\x89max(0,\xe2\x80\x89c\xe2\x80\x89-\xe2\x80\x891))  right key: the new cursor position (nr,\xe2\x80\x89nc)\xe2\x80\x89=\xe2\x80\x89(r,\xe2\x80\x89min(anr,\xe2\x80\x89c\xe2\x80\x89+\xe2\x80\x891))  HOME key: the new cursor position (nr,\xe2\x80\x89nc)\xe2\x80\x89=\xe2\x80\x89(r,\xe2\x80\x890)  END key: the new cursor position (nr,\xe2\x80\x89nc)\xe2\x80\x89=\xe2\x80\x89(r,\xe2\x80\x89ar) You\'re given the document description (n and sequence ai) and q queries from Dreamoon. Each query asks what minimal number of key presses is needed to move the cursor from (r1,\xe2\x80\x89c1) to (r2,\xe2\x80\x89c2)." 3100

477D "Dreamoon and Binary" dp,strings "Dreamoon saw a large integer x written on the ground and wants to print its binary form out. Dreamoon has accomplished the part of turning x into its binary format. Now he is going to print it in the following manner.He has an integer n\xe2\x80\x89=\xe2\x80\x890 and can only perform the following two operations in any order for unlimited times each:  Print n in binary form without leading zeros, each print will append to the right of previous prints.  Increase n by 1. Let\'s define an ideal sequence as a sequence of operations that can successfully print binary representation of x without leading zeros and ends with a print operation (i.e. operation 1). Dreamoon wants to know how many different ideal sequences are there and the length (in operations) of the shortest ideal sequence.The answers might be large so please print them modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897).Let\'s define the string representation of an ideal sequence as a string of \'1\' and \'2\' where the i-th character in the string matches the i-th operation performed. Two ideal sequences are called different if their string representations are different." 2700

476E "Dreamoon and Strings" dp,strings "Dreamoon has a string s and a pattern string p. He first removes exactly x characters from s obtaining string s\' as a result. Then he calculates  that is defined as the maximal number of non-overlapping substrings equal to p that can be found in s\'. He wants to make this number as big as possible.More formally, let\'s define  as maximum value of  over all s\' that can be obtained by removing exactly x characters from s. Dreamoon wants to know  for all x from 0 to |s| where |s| denotes the length of string s." 2200

476D "Dreamoon and Sets" "constructive algorithms,greedy,math" "Dreamoon likes to play with sets, integers and .  is defined as the largest positive integer that divides both a and b.Let S be a set of exactly four distinct integers greater than 0. Define S to be of rank k if and only if for all pairs of distinct elements si, sj from S, .Given k and n, Dreamoon wants to make up n sets of rank k using integers from 1 to m such that no integer is used in two different sets (of course you can leave some integers without use). Calculate the minimum m that makes it possible and print one possible solution." 1900

476C "Dreamoon and Sums" math "Dreamoon loves summing up something for no reason. One day he obtains two integers a and b occasionally. He wants to calculate the sum of all nice integers. Positive integer x is called nice if  and , where k is some integer number in range [1,\xe2\x80\x89a].By  we denote the quotient of integer division of x and y. By  we denote the remainder of integer division of x and y. You can read more about these operations here: http://goo.gl/AcsXhT.The answer may be large, so please print its remainder modulo 1\xe2\x80\x89000\xe2\x80\x89000\xe2\x80\x89007 (109\xe2\x80\x89+\xe2\x80\x897). Can you compute it faster than Dreamoon?" 1600

476B "Dreamoon and WiFi" "bitmasks,brute force,combinatorics,dp,math,probabilities" "Dreamoon is standing at the position 0 on a number line. Drazil is sending a list of commands through Wi-Fi to Dreamoon\'s smartphone and Dreamoon follows them.Each command is one of the following two types:   Go 1 unit towards the positive direction, denoted as \'+\'  Go 1 unit towards the negative direction, denoted as \'-\' But the Wi-Fi condition is so poor that Dreamoon\'s smartphone reports some of the commands can\'t be recognized and Dreamoon knows that some of them might even be wrong though successfully recognized. Dreamoon decides to follow every recognized command and toss a fair coin to decide those unrecognized ones (that means, he moves to the 1 unit to the negative or positive direction with the same probability 0.5). You are given an original list of commands sent by Drazil and list received by Dreamoon. What is the probability that Dreamoon ends in the position originally supposed to be final by Drazil\'s commands?" 1300

476A "Dreamoon and Stairs" implementation,math "Dreamoon wants to climb up a stair of n steps. He can climb 1 or 2 steps at each move. Dreamoon wants the number of moves to be a multiple of an integer m. What is the minimal number of moves making him climb to the top of the stairs that satisfies his condition?" 1000

475F Meta-universe "data structures" "Consider infinite grid of unit cells. Some of those cells are planets. Meta-universe M\xe2\x80\x89=\xe2\x80\x89{p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pk} is a set of planets. Suppose there is an infinite row or column with following two properties: 1) it doesn\'t contain any planet pi of meta-universe M on it; 2) there are planets of M located on both sides from this row or column. In this case we can turn the meta-universe M into two non-empty meta-universes M1 and M2 containing planets that are located on respective sides of this row or column. A meta-universe which can\'t be split using operation above is called a universe. We perform such operations until all meta-universes turn to universes.Given positions of the planets in the original meta-universe, find the number of universes that are result of described process. It can be proved that each universe is uniquely identified not depending from order of splitting." 2900

475E "Strongly Connected City 2" "dfs and similar" "Imagine a city with n junctions and m streets. Junctions are numbered from 1 to n.In order to increase the traffic flow, mayor of the city has decided to make each street one-way. This means in the street between junctions u and v, the traffic moves only from u to v or only from v to u. The problem is to direct the traffic flow of streets in a way that maximizes the number of pairs (u,\xe2\x80\x89v) where 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89u,\xe2\x80\x89v\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n and it is possible to reach junction v from u by passing the streets in their specified direction. Your task is to find out maximal possible number of such pairs." 2700

475D CGCDSSQ "brute force,data structures,math" "Given a sequence of integers a1,\xe2\x80\x89...,\xe2\x80\x89an and q queries x1,\xe2\x80\x89...,\xe2\x80\x89xq on it. For each query xi you have to count the number of pairs (l,\xe2\x80\x89r) such that 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n and gcd(al,\xe2\x80\x89al\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89ar)\xe2\x80\x89=\xe2\x80\x89xi. is a greatest common divisor of v1,\xe2\x80\x89v2,\xe2\x80\x89...,\xe2\x80\x89vn, that is equal to a largest positive integer that divides all vi." 2000

475C "Kamal-ol-molk\'s Painting" "brute force,constructive algorithms,greedy" "Given a sequence of integers a1,\xe2\x80\x89...,\xe2\x80\x89an and q queries x1,\xe2\x80\x89...,\xe2\x80\x89xq on it. For each query xi you have to count the number of pairs (l,\xe2\x80\x89r) such that 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n and gcd(al,\xe2\x80\x89al\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89ar)\xe2\x80\x89=\xe2\x80\x89xi. is a greatest common divisor of v1,\xe2\x80\x89v2,\xe2\x80\x89...,\xe2\x80\x89vn, that is equal to a largest positive integer that divides all vi." 2100

475B "Strongly Connected City" "brute force,dfs and similar,graphs,implementation" "Imagine a city with n horizontal streets crossing m vertical streets, forming an (n\xe2\x80\x89-\xe2\x80\x891)\xe2\x80\x89\xc3\x97\xe2\x80\x89(m\xe2\x80\x89-\xe2\x80\x891) grid. In order to increase the traffic flow, mayor of the city has decided to make each street one way. This means in each horizontal street, the traffic moves only from west to east or only from east to west. Also, traffic moves only from north to south or only from south to north in each vertical street. It is possible to enter a horizontal street from a vertical street, or vice versa, at their intersection.  The mayor has received some street direction patterns. Your task is to check whether it is possible to reach any junction from any other junction in the proposed street direction pattern." 1400

475A "Bayan Bus" implementation "The final round of Bayan Programming Contest will be held in Tehran, and the participants will be carried around with a yellow bus. The bus has 34 passenger seats: 4 seats in the last row and 3 seats in remaining rows.   The event coordinator has a list of k participants who should be picked up at the airport. When a participant gets on the bus, he will sit in the last row with an empty seat. If there is more than one empty seat in that row, he will take the leftmost one. In order to keep track of the people who are on the bus, the event coordinator needs a figure showing which seats are going to be taken by k participants. Your task is to draw the figure representing occupied seats." 1100

474F "Ant colony" "data structures,math,number theory" "Mole is hungry again. He found one ant colony, consisting of n ants, ordered in a row. Each ant i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) has a strength si.In order to make his dinner more interesting, Mole organizes a version of \xc2\xabHunger Games\xc2\xbb for the ants. He chooses two numbers l and r (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) and each pair of ants with indices between l and r (inclusively) will fight. When two ants i and j fight, ant i gets one battle point only if si divides sj (also, ant j gets one battle point only if sj divides si). After all fights have been finished, Mole makes the ranking. An ant i, with vi battle points obtained, is going to be freed only if vi\xe2\x80\x89=\xe2\x80\x89r\xe2\x80\x89-\xe2\x80\x89l, or in other words only if it took a point in every fight it participated. After that, Mole eats the rest of the ants. Note that there can be many ants freed or even none.In order to choose the best sequence, Mole gives you t segments [li,\xe2\x80\x89ri] and asks for each of them how many ants is he going to eat if those ants fight." 2100

474E Pillars "binary search,data structures,dp,sortings,trees" "Marmot found a row with n pillars. The i-th pillar has the height of hi meters. Starting from one pillar i1, Marmot wants to jump on the pillars i2, ..., ik. (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i1\xe2\x80\x89<\xe2\x80\x89i2\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89ik\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n). From a pillar i Marmot can jump on a pillar j only if i\xe2\x80\x89<\xe2\x80\x89j and |hi\xe2\x80\x89-\xe2\x80\x89hj|\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89d, where |x| is the absolute value of the number x.Now Marmot is asking you find out a jump sequence with maximal length and print it." 2000

474D Flowers dp "We saw the little game Marmot made for Mole\'s lunch. Now it\'s Marmot\'s dinner time and, as we all know, Marmot eats flowers. At every dinner he eats some red and white flowers. Therefore a dinner can be represented as a sequence of several flowers, some of them white and some of them red.But, for a dinner to be tasty, there is a rule: Marmot wants to eat white flowers only in groups of size k.Now Marmot wonders in how many ways he can eat between a and b flowers. As the number of ways could be very large, print it modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." 1700

474C "Captain Marmot" "brute force,geometry" "Captain Marmot wants to prepare a huge and important battle against his enemy, Captain Snake. For this battle he has n regiments, each consisting of 4 moles.Initially, each mole i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x894n) is placed at some position (xi,\xe2\x80\x89yi) in the Cartesian plane. Captain Marmot wants to move some moles to make the regiments compact, if it\'s possible.Each mole i has a home placed at the position (ai,\xe2\x80\x89bi). Moving this mole one time means rotating his position point (xi,\xe2\x80\x89yi) 90 degrees counter-clockwise around it\'s home point (ai,\xe2\x80\x89bi).A regiment is compact only if the position points of the 4 moles form a square with non-zero area.Help Captain Marmot to find out for each regiment the minimal number of moves required to make that regiment compact, if it\'s possible." 2000

474B Worms "binary search,implementation" "It is lunch time for Mole. His friend, Marmot, prepared him a nice game for lunch.Marmot brought Mole n ordered piles of worms such that i-th pile contains ai worms. He labeled all these worms with consecutive integers: worms in first pile are labeled with numbers 1 to a1, worms in second pile are labeled with numbers a1\xe2\x80\x89+\xe2\x80\x891 to a1\xe2\x80\x89+\xe2\x80\x89a2 and so on. See the example for a better understanding.Mole can\'t eat all the worms (Marmot brought a lot) and, as we all know, Mole is blind, so Marmot tells him the labels of the best juicy worms. Marmot will only give Mole a worm if Mole says correctly in which pile this worm is contained.Poor Mole asks for your help. For all juicy worms said by Marmot, tell Mole the correct answers." 1200

474A Keyboard implementation "Our good friend Mole is trying to code a big message. He is typing on an unusual keyboard with characters arranged in following way:qwertyuiopasdfghjkl;zxcvbnm,./Unfortunately Mole is blind, so sometimes it is problem for him to put his hands accurately. He accidentally moved both his hands with one position to the left or to the right. That means that now he presses not a button he wants, but one neighboring button (left or right, as specified in input).We have a sequence of characters he has typed and we want to find the original message." 900

472G "Design Tutorial: Increase the Constraints" "bitmasks,data structures,fft" "There is a simple way to create hard tasks: take one simple problem as the query, and try to find an algorithm that can solve it faster than bruteforce. This kind of tasks usually appears in OI contest, and usually involves data structures.Let\'s try to create a task, for example, we take the ""Hamming distance problem"": for two binary strings s and t with the same length, the Hamming distance between them is the number of positions at which the corresponding symbols are different. For example, the Hamming distance between ""00111"" and ""10101"" is 2 (the different symbols are marked with bold).We use the Hamming distance problem as a query in the following way: you are given two strings a and b and several queries. Each query will be: what is the Hamming distance between two strings ap1ap1\xe2\x80\x89+\xe2\x80\x891...ap1\xe2\x80\x89+\xe2\x80\x89len\xe2\x80\x89-\xe2\x80\x891 and bp2bp2\xe2\x80\x89+\xe2\x80\x891...bp2\xe2\x80\x89+\xe2\x80\x89len\xe2\x80\x89-\xe2\x80\x891?Note, that in this problem the strings are zero-based, that is s\xe2\x80\x89=\xe2\x80\x89s0s1... s|s|\xe2\x80\x89-\xe2\x80\x891." 2800

472F "Design Tutorial: Change the Goal" "constructive algorithms,math,matrices" "There are some tasks which have the following structure: you are given a model, and you can do some operations, you should use these operations to achive the goal. One way to create a new task is to use the same model and same operations, but change the goal.Let\'s have a try. I have created the following task for Topcoder SRM 557 Div1-Hard: you are given n integers x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xn. You are allowed to perform the assignments (as many as you want) of the following form xi ^= xj (in the original task i and j must be different, but in this task we allow i to equal j). The goal is to maximize the sum of all xi.Now we just change the goal. You are also given n integers y1,\xe2\x80\x89y2,\xe2\x80\x89...,\xe2\x80\x89yn. You should make x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xn exactly equal to y1,\xe2\x80\x89y2,\xe2\x80\x89...,\xe2\x80\x89yn. In other words, for each i number xi should be equal to yi." 2700

472E "Design Tutorial: Learn from a Game" "constructive algorithms,implementation" "One way to create task is to learn from game. You should pick a game and focus on part of the mechanic of that game, then it might be a good task.Let\'s have a try. Puzzle and Dragon was a popular game in Japan, we focus on the puzzle part of that game, it is a tile-matching puzzle.(Picture from Wikipedia page: http://en.wikipedia.org/wiki/Puzzle_&_Dragons)There is an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m board which consists of orbs. During the game you can do the following move. In the beginning of move you touch a cell of the board, then you can move your finger to one of the adjacent cells (a cell not on the boundary has 8 adjacent cells), then you can move your finger from the current cell to one of the adjacent cells one more time, and so on. Each time you move your finger from a cell to another cell, the orbs in these cells swap with each other. In other words whatever move you make, the orb in the cell you are touching never changes.The goal is to achieve such kind of pattern that the orbs will be cancelled and your monster will attack the enemy, but we don\'t care about these details. Instead, we will give you the initial board as an input and the target board as an output. Your goal is to determine whether there is a way to reach the target in a single move." 2800

472D "Design Tutorial: Inverse the Problem" "dfs and similar,dsu,shortest paths,trees" "There is an easy way to obtain a new task from an old one called ""Inverse the problem"": we give an output of the original task, and ask to generate an input, such that solution to the original problem will produce the output we provided. The hard task of Topcoder Open 2014 Round 2C, InverseRMQ, is a good example.Now let\'s create a task this way. We will use the task: you are given a tree, please calculate the distance between any pair of its nodes. Yes, it is very easy, but the inverse version is a bit harder: you are given an n\xe2\x80\x89\xc3\x97\xe2\x80\x89n distance matrix. Determine if it is the distance matrix of a weighted tree (all weights must be positive integers)." 1900

472C "Design Tutorial: Make It Nondeterministic" greedy "A way to make a new task is to make it nondeterministic or probabilistic. For example, the hard task of Topcoder SRM 595, Constellation, is the probabilistic version of a convex hull.Let\'s try to make a new task. Firstly we will use the following task. There are n people, sort them by their name. It is just an ordinary sorting problem, but we can make it more interesting by adding nondeterministic element. There are n people, each person will use either his/her first name or last name as a handle. Can the lexicographical order of the handles be exactly equal to the given permutation p?More formally, if we denote the handle of the i-th person as hi, then the following condition must hold: ." 1400

472B "Design Tutorial: Learn from Life" NA "One way to create a task is to learn from life. You can choose some experience in real life, formalize it and then you will get a new task.Let\'s think about a scene in real life: there are lots of people waiting in front of the elevator, each person wants to go to a certain floor. We can formalize it in the following way. We have n people standing on the first floor, the i-th person wants to go to the fi-th floor. Unfortunately, there is only one elevator and its capacity equal to k (that is at most k people can use it simultaneously). Initially the elevator is located on the first floor. The elevator needs |a\xe2\x80\x89-\xe2\x80\x89b| seconds to move from the a-th floor to the b-th floor (we don\'t count the time the people need to get on and off the elevator).What is the minimal number of seconds that is needed to transport all the people to the corresponding floors and then return the elevator to the first floor?" 1300

472A "Design Tutorial: Learn from Math" "math,number theory" "One way to create a task is to learn from math. You can generate some random math statement or modify some theorems to get something new and build a new task from that.For example, there is a statement called the ""Goldbach\'s conjecture"". It says: ""each even number no less than four can be expressed as the sum of two primes"". Let\'s modify it. How about a statement like that: ""each integer no less than 12 can be expressed as the sum of two composite numbers."" Not like the Goldbach\'s conjecture, I can prove this theorem.You are given an integer n no less than 12, express it as a sum of two composite numbers." 800

471E "MUH and Lots and Lots of Segments" "data structures,dsu" "Polar bears Menshykov and Uslada from the zoo of St. Petersburg and elephant Horace from the zoo of Kiev decided to do some painting. As they were trying to create their first masterpiece, they made a draft on a piece of paper. The draft consists of n segments. Each segment was either horizontal or vertical. Now the friends want to simplify the draft by deleting some segments or parts of segments so that the final masterpiece meets three conditions:  Horace wants to be able to paint the whole picture in one stroke: by putting the brush on the paper and never taking it off until the picture is ready. The brush can paint the same place multiple times. That\'s why all the remaining segments must form a single connected shape.  Menshykov wants the resulting shape to be simple. He defines a simple shape as a shape that doesn\'t contain any cycles.  Initially all the segment on the draft have integer startpoint and endpoint coordinates. Uslada doesn\'t like real coordinates and she wants this condition to be fulfilled after all the changes. As in other parts the draft is already beautiful, the friends decided to delete such parts of the draft that the sum of lengths of the remaining segments is as large as possible. Your task is to count this maximum sum of the lengths that remain after all the extra segments are removed." 2700

471D "MUH and Cube Walls" "string suffix structures,strings" "Polar bears Menshykov and Uslada from the zoo of St. Petersburg and elephant Horace from the zoo of Kiev got hold of lots of wooden cubes somewhere. They started making cube towers by placing the cubes one on top of the other. They defined multiple towers standing in a line as a wall. A wall can consist of towers of different heights.Horace was the first to finish making his wall. He called his wall an elephant. The wall consists of w towers. The bears also finished making their wall but they didn\'t give it a name. Their wall consists of n towers. Horace looked at the bears\' tower and wondered: in how many parts of the wall can he ""see an elephant""? He can ""see an elephant"" on a segment of w contiguous towers if the heights of the towers on the segment match as a sequence the heights of the towers in Horace\'s wall. In order to see as many elephants as possible, Horace can raise and lower his wall. He even can lower the wall below the ground level (see the pictures to the samples for clarification).Your task is to count the number of segments where Horace can ""see an elephant""." 1800

471C "MUH and House of Cards" "binary search,brute force,greedy,math" "Polar bears Menshykov and Uslada from the zoo of St. Petersburg and elephant Horace from the zoo of Kiev decided to build a house of cards. For that they\'ve already found a hefty deck of n playing cards. Let\'s describe the house they want to make:   The house consists of some non-zero number of floors.  Each floor consists of a non-zero number of rooms and the ceiling. A room is two cards that are leaned towards each other. The rooms are made in a row, each two adjoining rooms share a ceiling made by another card.  Each floor besides for the lowest one should contain less rooms than the floor below. Please note that the house may end by the floor with more than one room, and in this case they also must be covered by the ceiling. Also, the number of rooms on the adjoining floors doesn\'t have to differ by one, the difference may be more. While bears are practicing to put cards, Horace tries to figure out how many floors their house should consist of. The height of the house is the number of floors in it. It is possible that you can make a lot of different houses of different heights out of n cards. It seems that the elephant cannot solve this problem and he asks you to count the number of the distinct heights of the houses that they can make using exactly n cards." 1700

471B "MUH and Important Things" implementation,sortings "It\'s time polar bears Menshykov and Uslada from the zoo of St. Petersburg and elephant Horace from the zoo of Kiev got down to business. In total, there are n tasks for the day and each animal should do each of these tasks. For each task, they have evaluated its difficulty. Also animals decided to do the tasks in order of their difficulty. Unfortunately, some tasks can have the same difficulty, so the order in which one can perform the tasks may vary.Menshykov, Uslada and Horace ask you to deal with this nuisance and come up with individual plans for each of them. The plan is a sequence describing the order in which an animal should do all the n tasks. Besides, each of them wants to have its own unique plan. Therefore three plans must form three different sequences. You are to find the required plans, or otherwise deliver the sad news to them by stating that it is impossible to come up with three distinct plans for the given tasks." 1300

471A "MUH and Sticks" implementation "Two polar bears Menshykov and Uslada from the St.Petersburg zoo and elephant Horace from the Kiev zoo got six sticks to play with and assess the animals\' creativity. Menshykov, Uslada and Horace decided to make either an elephant or a bear from those sticks. They can make an animal from sticks in the following way:   Four sticks represent the animal\'s legs, these sticks should have the same length.  Two remaining sticks represent the animal\'s head and body. The bear\'s head stick must be shorter than the body stick. The elephant, however, has a long trunk, so his head stick must be as long as the body stick. Note that there are no limits on the relations between the leg sticks and the head and body sticks. Your task is to find out which animal can be made from the given stick set. The zoo keeper wants the sticks back after the game, so they must never be broken, even bears understand it." 1100

470H "Array Sorting" "*special problem" "Sorting arrays is traditionally associated with high-level languages. How hard can it be in FALSE? Sort the given array in non-descending order." 2300

470G "Hamming Distance" "*special problem" "Hamming distance between two strings of equal length is the number of positions at which the corresponding symbols are different. You are given two strings; calculate the distance between them." 2300

470F "Pairwise Sums" "*special problem" "You are given an array of n integers. For each element output the sum of itself and the previous element. For the first element, output the sum of the first and the last elements of the array." 2300

470E Chessboard "*special problem" "Chessboard is a board of n\xe2\x80\x89\xc3\x97\xe2\x80\x89n squares arranged in two alternating colors (black and white). Top left square is white. You are given board size n. Output an image of a chessboard, with black and white squares marked with \'#\' and \'.\' characters, respectively." 1900

470D "Caesar Cipher" "*special problem" "Caesar cipher is one of the simplest encryption techniques. To transform the original message into encrypted one using key k, one has to replace each letter with a letter which is k positions later in the alphabet (if this takes the position beyond Z, the rest of it is counted from the start of the alphabet). In a more formal way, if letters of the alphabet are enumerated starting with 0, the result of encryption for character x will be  (26 is the number of letters in the Latin alphabet).You are given the original message and the encryption key k. Output the result of encryption." 1900

470C Eval "*special problem" "You are given a simple arithmetic expression of the form a?b, where a and b are integer constants, and ? can be one of the following operations: \'+\' (addition), \'-\' (subtraction), \'*\' (multiplication), \'/\' (integer division) or \'%\' (modulo operation).Output the result of evaluation of this expression." 1900

470B Hexakosioihexekontahexaphobia "*special problem" "This (unpronounceable) word means simply fear of number 666. You are given a string of digits. Check whether it is scary for a person suffering from this phobia, i.e., whether it contains number 666 as a substring." 1800

470A "Crystal Ball Sequence" "*special problem,implementation" "Crystal ball sequence on hexagonal lattice is defined as follows: n-th element is the number of lattice points inside a hexagon with (n\xe2\x80\x89+\xe2\x80\x891) points on each side. The formula is Hn\xe2\x80\x89=\xe2\x80\x893\xc2\xb7n\xc2\xb7(n\xe2\x80\x89+\xe2\x80\x891)\xe2\x80\x89+\xe2\x80\x891. You are given n; calculate n-th element of the sequence." 1400

469B "Chat Online" implementation "Little X and Little Z are good friends. They always chat online. But both of them have schedules.Little Z has fixed schedule. He always online at any moment of time between a1 and b1, between a2 and b2, ..., between ap and bp (all borders inclusive). But the schedule of Little X is quite strange, it depends on the time when he gets up. If he gets up at time 0, he will be online at any moment of time between c1 and d1, between c2 and d2, ..., between cq and dq (all borders inclusive). But if he gets up at time t, these segments will be shifted by t. They become [ci\xe2\x80\x89+\xe2\x80\x89t,\xe2\x80\x89di\xe2\x80\x89+\xe2\x80\x89t] (for all i).If at a moment of time, both Little X and Little Z are online simultaneosly, they can chat online happily. You know that Little X can get up at an integer moment of time between l and r (both borders inclusive). Also you know that Little X wants to get up at the moment of time, that is suitable for chatting with Little Z (they must have at least one common moment of time in schedules). How many integer moments of time from the segment [l,\xe2\x80\x89r] suit for that?" 1300

469A "I Wanna Be the Guy" greedy,implementation "There is a game called ""I Wanna Be the Guy"", consisting of n levels. Little X and his friend Little Y are addicted to the game. Each of them wants to pass the whole game.Little X can pass only p levels of the game. And Little Y can pass only q levels of the game. You are given the indices of levels Little X can pass and the indices of levels Little Y can pass. Will Little X and Little Y pass the whole game, if they cooperate each other?" 800

468E Permanent "dp,graph matchings,math,meet-in-the-middle" "Little X has solved the #P-complete problem in polynomial time recently. So he gives this task to you. There is a special n\xe2\x80\x89\xc3\x97\xe2\x80\x89n matrix A, you should calculate its permanent modulo 1000000007�(109\xe2\x80\x89+\xe2\x80\x897). The special property of matrix A is almost all its elements equal to 1. Only k elements have specified value.You can find the definition of permanent at the link: https://en.wikipedia.org/wiki/Permanent" 3100

468D Tree "graph matchings" "Little X has a tree consisting of n nodes (they are numbered from 1 to n). Each edge of the tree has a positive length. Let\'s define the distance between two nodes v and u (we\'ll denote it d(v,\xe2\x80\x89u)) as the sum of the lengths of edges in the shortest path between v and u. A permutation p is a sequence of n distinct integers p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pn (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89pi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n). Little X wants to find a permutation p such that sum  is maximal possible. If there are multiple optimal permutations, he wants to find the lexicographically smallest one. Help him with the task!" 3100

468C "Hack it!" "binary search,constructive algorithms,math" "Little X has met the following problem recently. Let\'s define f(x) as the sum of digits in decimal representation of number x (for example, f(1234)\xe2\x80\x89=\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x892\xe2\x80\x89+\xe2\x80\x893\xe2\x80\x89+\xe2\x80\x894). You are to calculate Of course Little X has solved this problem quickly, has locked it, and then has tried to hack others. He has seen the following C++ code:     ans = solve(l, r) % a;    if (ans <= 0)      ans += a; This code will fail only on the test with . You are given number a, help Little X to find a proper test for hack." 2500

468B "Two Sets" "2-sat,dfs and similar,dsu,graph matchings,greedy" "Little X has n distinct integers: p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pn. He wants to divide all of them into two sets A and B. The following two conditions must be satisfied:  If number x belongs to set A, then number a\xe2\x80\x89-\xe2\x80\x89x must also belong to set A.  If number x belongs to set B, then number b\xe2\x80\x89-\xe2\x80\x89x must also belong to set B. Help Little X divide the numbers into two sets or determine that it\'s impossible." 2000

468A "24 Game" "constructive algorithms,greedy,math" "Little X used to play a card game called ""24 Game"", but recently he has found it too easy. So he invented a new game.Initially you have a sequence of n integers: 1,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89n. In a single step, you can pick two of them, let\'s denote them a and b, erase them from the sequence, and append to the sequence either a\xe2\x80\x89+\xe2\x80\x89b, or a\xe2\x80\x89-\xe2\x80\x89b, or a\xe2\x80\x89\xc3\x97\xe2\x80\x89b.After n\xe2\x80\x89-\xe2\x80\x891 steps there is only one number left. Can you make this number equal to 24?" 1500

467E "Alex and Complicated Task" "data structures,dp,greedy" "After you have read all the problems, probably, you think Alex is genius person. That\'s true! One day he came up with the following task.Given a sequence of integer numbers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. You are to find a longest sequence b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89b4m, that satisfies the following conditions:  b4k\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89=\xe2\x80\x89b4k\xe2\x80\x89+\xe2\x80\x893 for all valid integer k;  b4k\xe2\x80\x89+\xe2\x80\x892\xe2\x80\x89=\xe2\x80\x89b4k\xe2\x80\x89+\xe2\x80\x894 for all valid integer k;  sequence b is subsequence of a (not necessarily contiguous subsequence). And finally... Alex had given this complicated task to George, and George gave it to you. Help George to cope with the task." 2300

467D "Fedor and Essay" "dfs and similar,dp,graphs,hashing,strings" "After you had helped Fedor to find friends in the \xc2\xabCall of Soldiers 3\xc2\xbb game, he stopped studying completely. Today, the English teacher told him to prepare an essay. Fedor didn\'t want to prepare the essay, so he asked Alex for help. Alex came to help and wrote the essay for Fedor. But Fedor didn\'t like the essay at all. Now Fedor is going to change the essay using the synonym dictionary of the English language.Fedor does not want to change the meaning of the essay. So the only change he would do: change a word from essay to one of its synonyms, basing on a replacement rule from the dictionary. Fedor may perform this operation any number of times.As a result, Fedor wants to get an essay which contains as little letters \xc2\xabR\xc2\xbb (the case doesn\'t matter) as possible. If there are multiple essays with minimum number of \xc2\xabR\xc2\xbbs he wants to get the one with minimum length (length of essay is the sum of the lengths of all the words in it). Help Fedor get the required essay.Please note that in this problem the case of letters doesn\'t matter. For example, if the synonym dictionary says that word cat can be replaced with word DOG, then it is allowed to replace the word Cat with the word doG." 2400

467C "George and Job" dp,implementation "The new ITone 6 has been released recently and George got really keen to buy it. Unfortunately, he didn\'t have enough money, so George was going to work as a programmer. Now he faced the following problem at the work.Given a sequence of n integers p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pn. You are to choose k pairs of integers: [l1,\xe2\x80\x89r1],\xe2\x80\x89[l2,\xe2\x80\x89r2],\xe2\x80\x89...,\xe2\x80\x89[lk,\xe2\x80\x89rk]�(1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r1\xe2\x80\x89<\xe2\x80\x89l2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r2\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89lk\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89rk\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n;�ri\xe2\x80\x89-\xe2\x80\x89li\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89=\xe2\x80\x89m),\xe2\x80\x89in such a way that the value of sum  is maximal possible. Help George to cope with the task." 1700

467B "Fedor and New Game" "bitmasks,brute force,constructive algorithms,implementation" "After you had helped George and Alex to move in the dorm, they went to help their friend Fedor play a new computer game \xc2\xabCall of Soldiers 3\xc2\xbb.The game has (m\xe2\x80\x89+\xe2\x80\x891) players and n types of soldiers in total. Players \xc2\xabCall of Soldiers 3\xc2\xbb are numbered form 1 to (m\xe2\x80\x89+\xe2\x80\x891). Types of soldiers are numbered from 0 to n\xe2\x80\x89-\xe2\x80\x891. Each player has an army. Army of the i-th player can be described by non-negative integer xi. Consider binary representation of xi: if the j-th bit of number xi equal to one, then the army of the i-th player has soldiers of the j-th type. Fedor is the (m\xe2\x80\x89+\xe2\x80\x891)-th player of the game. He assume that two players can become friends if their armies differ in at most k types of soldiers (in other words, binary representations of the corresponding numbers differ in at most k bits). Help Fedor and count how many players can become his friends." 1100

467A "George and Accommodation" implementation "George has recently entered the BSUCP (Berland State University for Cool Programmers). George has a friend Alex who has also entered the university. Now they are moving into a dormitory. George and Alex want to live in the same room. The dormitory has n rooms in total. At the moment the i-th room has pi people living in it and the room can accommodate qi people in total (pi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89qi). Your task is to count how many rooms has free place for both George and Alex." 800

466E "Information Graph" "dfs and similar,dsu,graphs,trees" "There are n employees working in company ""X"" (let\'s number them from 1 to n for convenience). Initially the employees didn\'t have any relationships among each other. On each of m next days one of the following events took place:  either employee y became the boss of employee x (at that, employee x didn\'t have a boss before);  or employee x gets a packet of documents and signs them; then he gives the packet to his boss. The boss signs the documents and gives them to his boss and so on (the last person to sign the documents sends them to the archive);  or comes a request of type ""determine whether employee x signs certain documents"". Your task is to write a program that will, given the events, answer the queries of the described type. At that, it is guaranteed that throughout the whole working time the company didn\'t have cyclic dependencies." 2100

466D "Increase Sequence" combinatorics,dp "Peter has a sequence of integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. Peter wants all numbers in the sequence to equal h. He can perform the operation of ""adding one on the segment [l,\xe2\x80\x89r]"": add one to all elements of the sequence with indices from l to r (inclusive). At that, Peter never chooses any element as the beginning of the segment twice. Similarly, Peter never chooses any element as the end of the segment twice. In other words, for any two segments [l1,\xe2\x80\x89r1] and [l2,\xe2\x80\x89r2], where Peter added one, the following inequalities hold: l1\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89l2 and r1\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89r2.How many distinct ways are there to make all numbers in the sequence equal h? Print this number of ways modulo 1000000007�(109\xe2\x80\x89+\xe2\x80\x897). Two ways are considered distinct if one of them has a segment that isn\'t in the other way." 2100

466C "Number of Ways" "binary search,brute force,data structures,dp,two pointers" "You\'ve got array a[1],\xe2\x80\x89a[2],\xe2\x80\x89...,\xe2\x80\x89a[n], consisting of n integers. Count the number of ways to split all the elements of the array into three contiguous parts so that the sum of elements in each part is the same. More formally, you need to find the number of such pairs of indices i,\xe2\x80\x89j (2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x891), that ." 1700

466B "Wonder Room" "brute force,math" "The start of the new academic year brought about the problem of accommodation students into dormitories. One of such dormitories has a a\xe2\x80\x89\xc3\x97\xe2\x80\x89b square meter wonder room. The caretaker wants to accommodate exactly n students there. But the law says that there must be at least 6 square meters per student in a room (that is, the room for n students must have the area of at least 6n square meters). The caretaker can enlarge any (possibly both) side of the room by an arbitrary positive integer of meters. Help him change the room so as all n students could live in it and the total area of the room was as small as possible." 2000

466A "Cheap Travel" implementation "Ann has recently started commuting by subway. We know that a one ride subway ticket costs a rubles. Besides, Ann found out that she can buy a special ticket for m rides (she can buy it several times). It costs b rubles. Ann did the math; she will need to use subway n times. Help Ann, tell her what is the minimum sum of money she will have to spend to make n rides?" 1200

465B "Inbox (100500)" implementation "Over time, Alexey\'s mail box got littered with too many letters. Some of them are read, while others are unread.Alexey\'s mail program can either show a list of all letters or show the content of a single letter. As soon as the program shows the content of an unread letter, it becomes read letter (if the program shows the content of a read letter nothing happens). In one click he can do any of the following operations: Move from the list of letters to the content of any single letter. Return to the list of letters from single letter viewing mode. In single letter viewing mode, move to the next or to the previous letter in the list. You cannot move from the first letter to the previous one or from the last letter to the next one.The program cannot delete the letters from the list or rearrange them.Alexey wants to read all the unread letters and go watch football. Now he is viewing the list of all letters and for each letter he can see if it is read or unread. What minimum number of operations does Alexey need to perform to read all unread letters?" 1000

465A "inc ARG" implementation "Sergey is testing a next-generation processor. Instead of bytes the processor works with memory cells consisting of n bits. These bits are numbered from 1 to n. An integer is stored in the cell in the following way: the least significant bit is stored in the first bit of the cell, the next significant bit is stored in the second bit, and so on; the most significant bit is stored in the n-th bit.Now Sergey wants to test the following instruction: ""add 1 to the value of the cell"". As a result of the instruction, the integer that is written in the cell must be increased by one; if some of the most significant bits of the resulting number do not fit into the cell, they must be discarded.Sergey wrote certain values \xe2\x80\x8b\xe2\x80\x8bof the bits in the cell and is going to add one to its value. How many bits of the cell will change after the operation?" 900

464E "The Classic Problem" "data structures,graphs,shortest paths" "You are given a weighted undirected graph on n vertices and m edges. Find the shortest path from vertex s to vertex t or else state that such path doesn\'t exist." 3000

464D "World of Darkraft - 2" dp,probabilities "Roma found a new character in the game ""World of Darkraft - 2"". In this game the character fights monsters, finds the more and more advanced stuff that lets him fight stronger monsters.The character can equip himself with k distinct types of items. Power of each item depends on its level (positive integer number). Initially the character has one 1-level item of each of the k types.After the victory over the monster the character finds exactly one new randomly generated item. The generation process looks as follows. Firstly the type of the item is defined; each of the k types has the same probability. Then the level of the new item is defined. Let\'s assume that the level of player\'s item of the chosen type is equal to t at the moment. Level of the new item will be chosen uniformly among integers from segment [1; t\xe2\x80\x89+\xe2\x80\x891].From the new item and the current player\'s item of the same type Roma chooses the best one (i.e. the one with greater level) and equips it (if both of them has the same level Roma choses any). The remaining item is sold for coins. Roma sells an item of level x of any type for x coins.Help Roma determine the expected number of earned coins after the victory over n monsters." 2700

464C "Substitutes in Number" dp "Andrew and Eugene are playing a game. Initially, Andrew has string s, consisting of digits. Eugene sends Andrew multiple queries of type ""di\xe2\x80\x89\xe2\x86\x92\xe2\x80\x89ti"", that means ""replace all digits di in string s with substrings equal to ti"". For example, if s\xe2\x80\x89=\xe2\x80\x89123123, then query ""2\xe2\x80\x89\xe2\x86\x92\xe2\x80\x8900"" transforms s to 10031003, and query ""3\xe2\x80\x89\xe2\x86\x92\xe2\x80\x89"" (""replace 3 by an empty string"") transforms it to s\xe2\x80\x89=\xe2\x80\x891212. After all the queries Eugene asks Andrew to find the remainder after division of number with decimal representation equal to s by 1000000007�(109\xe2\x80\x89+\xe2\x80\x897). When you represent s as a decimal number, please ignore the leading zeroes; also if s is an empty string, then it\'s assumed that the number equals to zero.Andrew got tired of processing Eugene\'s requests manually and he asked you to write a program for that. Help him!" 2100

464B "Restore Cube" "brute force,geometry" "Peter had a cube with non-zero length of a side. He put the cube into three-dimensional space in such a way that its vertices lay at integer points (it is possible that the cube\'s sides are not parallel to the coordinate axes). Then he took a piece of paper and wrote down eight lines, each containing three integers \xe2\x80\x94 coordinates of cube\'s vertex (a single line contains coordinates of a single vertex, each vertex is written exactly once), put the paper on the table and left. While Peter was away, his little brother Nick decided to play with the numbers on the paper. In one operation Nick could swap some numbers inside a single line (Nick didn\'t swap numbers from distinct lines). Nick could have performed any number of such operations.When Peter returned and found out about Nick\'s mischief, he started recollecting the original coordinates. Help Peter restore the original position of the points or else state that this is impossible and the numbers were initially recorded incorrectly." 2000

464A "No to Palindromes!" greedy,strings "Paul hates palindromes. He assumes that string s is tolerable if each its character is one of the first p letters of the English alphabet and s doesn\'t contain any palindrome contiguous substring of length 2 or more.Paul has found a tolerable string s of length n. Help him find the lexicographically next tolerable string of the same length or else state that such string does not exist." 1700

463E "Caisa and Tree" "brute force,dfs and similar,math,number theory,trees" "Caisa is now at home and his son has a simple task for him.Given a rooted tree with n vertices, numbered from 1 to n (vertex 1 is the root). Each vertex of the tree has a value. You should answer q queries. Each query is one of the following:  Format of the query is ""1 v"". Let\'s write out the sequence of vertices along the path from the root to vertex v: u1,\xe2\x80\x89u2,\xe2\x80\x89...,\xe2\x80\x89uk (u1\xe2\x80\x89=\xe2\x80\x891;�uk\xe2\x80\x89=\xe2\x80\x89v). You need to output such a vertex ui that gcd(value�of�ui,\xe2\x80\x89value�of�v)\xe2\x80\x89>\xe2\x80\x891 and i\xe2\x80\x89<\xe2\x80\x89k. If there are several possible vertices ui pick the one with maximum value of i. If there is no such vertex output -1.  Format of the query is ""2 v w"". You must change the value of vertex v to w. You are given all the queries, help Caisa to solve the problem." 2100

463D "Gargari and Permutations" "dfs and similar,dp,graphs,implementation" "Gargari got bored to play with the bishops and now, after solving the problem about them, he is trying to do math homework. In a math book he have found k permutations. Each of them consists of numbers 1,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89n in some order. Now he should find the length of the longest common subsequence of these permutations. Can you help Gargari?You can read about longest common subsequence there: https://en.wikipedia.org/wiki/Longest_common_subsequence_problem" 1900

463C "Gargari and Bishops" greedy,hashing,implementation "Gargari is jealous that his friend Caisa won the game from the previous problem. He wants to prove that he is a genius.He has a n\xe2\x80\x89\xc3\x97\xe2\x80\x89n chessboard. Each cell of the chessboard has a number written on it. Gargari wants to place two bishops on the chessboard in such a way that there is no cell that is attacked by both of them. Consider a cell with number x written on it, if this cell is attacked by one of the bishops Gargari will get x dollars for it. Tell Gargari, how to place bishops on the chessboard to get maximum amount of money.We assume a cell is attacked by a bishop, if the cell is located on the same diagonal with the bishop (the cell, where the bishop is, also considered attacked by it)." 1900

463B "Caisa and Pylons" "brute force,implementation,math" "Caisa solved the problem with the sugar and now he is on the way back to home. Caisa is playing a mobile game during his path. There are (n\xe2\x80\x89+\xe2\x80\x891) pylons numbered from 0 to n in this game. The pylon with number 0 has zero height, the pylon with number i (i\xe2\x80\x89>\xe2\x80\x890) has height hi. The goal of the game is to reach n-th pylon, and the only move the player can do is to jump from the current pylon (let\'s denote its number as k) to the next one (its number will be k\xe2\x80\x89+\xe2\x80\x891). When the player have made such a move, its energy increases by hk\xe2\x80\x89-\xe2\x80\x89hk\xe2\x80\x89+\xe2\x80\x891 (if this value is negative the player loses energy). The player must have non-negative amount of energy at any moment of the time. Initially Caisa stand at 0 pylon and has 0 energy. The game provides a special opportunity: one can pay a single dollar and increase the height of anyone pylon by one. Caisa may use that opportunity several times, but he doesn\'t want to spend too much money. What is the minimal amount of money he must paid to reach the goal of the game?" 1100

463A "Caisa and Sugar" "brute force,implementation" "Caisa is going to have a party and he needs to buy the ingredients for a big chocolate cake. For that he is going to the biggest supermarket in town.Unfortunately, he has just s dollars for sugar. But that\'s not a reason to be sad, because there are n types of sugar in the supermarket, maybe he able to buy one. But that\'s not all. The supermarket has very unusual exchange politics: instead of cents the sellers give sweets to a buyer as a change. Of course, the number of given sweets always doesn\'t exceed 99, because each seller maximizes the number of dollars in the change (100 cents can be replaced with a dollar).Caisa wants to buy only one type of sugar, also he wants to maximize the number of sweets in the change. What is the maximum number of sweets he can get? Note, that Caisa doesn\'t want to minimize the cost of the sugar, he only wants to get maximum number of sweets as change." 1200

462B "Appleman and Card Game" greedy "Appleman has n cards. Each card has an uppercase letter written on it. Toastman must choose k cards from Appleman\'s cards. Then Appleman should give Toastman some coins depending on the chosen cards. Formally, for each Toastman\'s card i you should calculate how much Toastman\'s cards have the letter equal to letter on ith, then sum up all these quantities, such a number of coins Appleman should give to Toastman.Given the description of Appleman\'s cards. What is the maximum number of coins Toastman can get?" 1300

462A "Appleman and Easy Task" "brute force,implementation" "Toastman came up with a very easy task. He gives it to Appleman, but Appleman doesn\'t know how to solve it. Can you help him?Given a n\xe2\x80\x89\xc3\x97\xe2\x80\x89n checkerboard. Each cell of the board has either character \'x\', or character \'o\'. Is it true that each cell of the board has even number of adjacent cells with \'o\'? Two cells of the board are adjacent if they share a side." 1000

461E "Appleman and a Game" "binary search,shortest paths,strings" "Appleman and Toastman like games. Today they play a game with strings with the following rules. Firstly Toastman tells Appleman two strings s and t both consisting only of letters \'A\', \'B\', \'C\', \'D\'. Then Appleman must build string s as quickly as possible. Initially he has empty string, and in one second he can append to end of the current string any contiguous substring of t.Now, Toastman and Appleman are beginning to play the game. Toastman has already told string t to Appleman, but he hasn\'t come up with string s yet. Toastman only thinks, that he should choose string s consisting of n characters. Of course, he wants to find the worst string for Appleman (such string, that Appleman will spend as much time as possible during the game). Tell Toastman, how much time will Appleman spend during the game if Toastman finds the worst string for him. You can assume that Appleman plays optimally, therefore he builds any string s in minimal possible time." 3000

461D "Appleman and Complicated Task" dsu,math "Toastman came up with a very complicated task. He gives it to Appleman, but Appleman doesn\'t know how to solve it. Can you help him?Given a n\xe2\x80\x89\xc3\x97\xe2\x80\x89n checkerboard. Each cell of the board has either character \'x\', or character \'o\', or nothing. How many ways to fill all the empty cells with \'x\' or \'o\' (each cell must contain only one character in the end) are there, such that for each cell the number of adjacent cells with \'o\' will be even? Find the number of ways modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897). Two cells of the board are adjacent if they share a side." 2800

461C "Appleman and a Sheet of Paper" "data structures,implementation" "Appleman has a very big sheet of paper. This sheet has a form of rectangle with dimensions 1\xe2\x80\x89\xc3\x97\xe2\x80\x89n. Your task is help Appleman with folding of such a sheet. Actually, you need to perform q queries. Each query will have one of the following types:  Fold the sheet of paper at position pi. After this query the leftmost part of the paper with dimensions 1\xe2\x80\x89\xc3\x97\xe2\x80\x89pi must be above the rightmost part of the paper with dimensions 1\xe2\x80\x89\xc3\x97\xe2\x80\x89([current�width�of�sheet]\xe2\x80\x89-\xe2\x80\x89pi).  Count what is the total width of the paper pieces, if we will make two described later cuts and consider only the pieces between the cuts. We will make one cut at distance li from the left border of the current sheet of paper and the other at distance ri from the left border of the current sheet of paper. Please look at the explanation of the first test example for better understanding of the problem." 2200

461B "Appleman and Tree" "dfs and similar,dp,trees" "Appleman has a tree with n vertices. Some of the vertices (at least one) are colored black and other vertices are colored white.Consider a set consisting of k (0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k\xe2\x80\x89<\xe2\x80\x89n) edges of Appleman\'s tree. If Appleman deletes these edges from the tree, then it will split into (k\xe2\x80\x89+\xe2\x80\x891) parts. Note, that each part will be a tree with colored vertices.Now Appleman wonders, what is the number of sets splitting the tree in such a way that each resulting part will have exactly one black vertex? Find this number modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." 2000

461A "Appleman and Toastman" greedy,sortings "Appleman and Toastman play a game. Initially Appleman gives one group of n numbers to the Toastman, then they start to complete the following tasks:  Each time Toastman gets a group of numbers, he sums up all the numbers and adds this sum to the score. Then he gives the group to the Appleman.  Each time Appleman gets a group consisting of a single number, he throws this group out. Each time Appleman gets a group consisting of more than one number, he splits the group into two non-empty groups (he can do it in any way) and gives each of them to Toastman. After guys complete all the tasks they look at the score value. What is the maximum possible value of score they can get?" 1200

460E "Roland and Rose" "brute force,geometry,math,sortings" "Roland loves growing flowers. He has recently grown a beautiful rose at point (0,\xe2\x80\x890) of the Cartesian coordinate system. The rose is so beautiful that Roland is afraid that the evil forces can try and steal it. To protect the rose, Roland wants to build n watch towers. Let\'s assume that a tower is a point on the plane at the distance of at most r from the rose. Besides, Roland assumes that the towers should be built at points with integer coordinates and the sum of squares of distances between all pairs of towers must be as large as possible. Note, that Roland may build several towers at the same point, also he may build some of them at point (0,\xe2\x80\x890).Help Roland build the towers at the integer points so that the sum of squares of distances between all towers is maximum possible. Note that the distance in this problem is defined as the Euclidian distance between points." 2700

460D "Little Victor and Set" "brute force,constructive algorithms,math" "Little Victor adores the sets theory. Let us remind you that a set is a group of numbers where all numbers are pairwise distinct. Today Victor wants to find a set of integers S that has the following properties:  for all x  the following inequality holds l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r;  1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|S|\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k;  lets denote the i-th element of the set S as si; value  must be as small as possible. Help Victor find the described set." 2300

460C Present "binary search,data structures,greedy" "Little beaver is a beginner programmer, so informatics is his favorite subject. Soon his informatics teacher is going to have a birthday and the beaver has decided to prepare a present for her. He planted n flowers in a row on his windowsill and started waiting for them to grow. However, after some time the beaver noticed that the flowers stopped growing. The beaver thinks it is bad manners to present little flowers. So he decided to come up with some solutions. There are m days left to the birthday. The height of the i-th flower (assume that the flowers in the row are numbered from 1 to n from left to right) is equal to ai at the moment. At each of the remaining m days the beaver can take a special watering and water w contiguous flowers (he can do that only once at a day). At that each watered flower grows by one height unit on that day. The beaver wants the height of the smallest flower be as large as possible in the end. What maximum height of the smallest flower can he get?" 1700

460B "Little Dima and Equation" "brute force,implementation,math,number theory" "Little Dima misbehaved during a math lesson a lot and the nasty teacher Mr. Pickles gave him the following problem as a punishment. Find all integer solutions x (0\xe2\x80\x89<\xe2\x80\x89x\xe2\x80\x89<\xe2\x80\x89109) of the equation:x\xe2\x80\x89=\xe2\x80\x89b\xc2\xb7s(x)a\xe2\x80\x89+\xe2\x80\x89c,\xe2\x80\x89 where a, b, c are some predetermined constant values and function s(x) determines the sum of all digits in the decimal representation of number x.The teacher gives this problem to Dima for each lesson. He changes only the parameters of the equation: a, b, c. Dima got sick of getting bad marks and he asks you to help him solve this challenging problem." 1500

460A "Vasya and Socks" "brute force,implementation,math" "Vasya has n pairs of socks. In the morning of each day Vasya has to put on a pair of socks before he goes to school. When he comes home in the evening, Vasya takes off the used socks and throws them away. Every m-th day (at days with numbers m,\xe2\x80\x892m,\xe2\x80\x893m,\xe2\x80\x89...) mom buys a pair of socks to Vasya. She does it late in the evening, so that Vasya cannot put on a new pair of socks before the next day. How many consecutive days pass until Vasya runs out of socks?" 900

459E "Pashmak and Graph" dp,sortings "Pashmak\'s homework is a problem about graphs. Although he always tries to do his homework completely, he can\'t solve this problem. As you know, he\'s really weak at graph theory; so try to help him in solving the problem.You are given a weighted directed graph with n vertices and m edges. You need to find a path (perhaps, non-simple) with maximum number of edges, such that the weights of the edges increase along the path. In other words, each edge of the path must have strictly greater weight than the previous edge in the path.Help Pashmak, print the number of edges in the required path." 1900

459D "Pashmak and Parmida\'s problem" "data structures,divide and conquer,sortings" "Pashmak\'s homework is a problem about graphs. Although he always tries to do his homework completely, he can\'t solve this problem. As you know, he\'s really weak at graph theory; so try to help him in solving the problem.You are given a weighted directed graph with n vertices and m edges. You need to find a path (perhaps, non-simple) with maximum number of edges, such that the weights of the edges increase along the path. In other words, each edge of the path must have strictly greater weight than the previous edge in the path.Help Pashmak, print the number of edges in the required path." 1800

459C "Pashmak and Buses" "combinatorics,constructive algorithms,math" "Recently Pashmak has been employed in a transportation company. The company has k buses and has a contract with a school which has n students. The school planned to take the students to d different places for d days (each day in one place). Each day the company provides all the buses for the trip. Pashmak has to arrange the students in the buses. He wants to arrange the students in a way that no two students become close friends. In his ridiculous idea, two students will become close friends if and only if they are in the same buses for all d days.Please help Pashmak with his weird idea. Assume that each bus has an unlimited capacity." 1900

459B "Pashmak and Flowers" combinatorics,implementation,sortings "Pashmak decided to give Parmida a pair of flowers from the garden. There are n flowers in the garden and the i-th of them has a beauty number bi. Parmida is a very strange girl so she doesn\'t want to have the two most beautiful flowers necessarily. She wants to have those pairs of flowers that their beauty difference is maximal possible!Your task is to write a program which calculates two things:  The maximum beauty difference of flowers that Pashmak can give to Parmida.  The number of ways that Pashmak can pick the flowers. Two ways are considered different if and only if there is at least one flower that is chosen in the first way and not chosen in the second way." 1300

459A "Pashmak and Garden" implementation "Pashmak has fallen in love with an attractive girl called Parmida since one year ago...Today, Pashmak set up a meeting with his partner in a romantic garden. Unfortunately, Pashmak has forgotten where the garden is. But he remembers that the garden looks like a square with sides parallel to the coordinate axes. He also remembers that there is exactly one tree on each vertex of the square. Now, Pashmak knows the position of only two of the trees. Help him to find the position of two remaining ones." 1200

457F "An easy problem about trees" dp,games,greedy,trees "Pieguy and Piegirl are playing a game. They have a rooted binary tree, that has a property that each node is either a leaf or has exactly two children. Each leaf has a number associated with it.On his/her turn a player can choose any two leafs that share their immediate parent, remove them, and associate either of their values with their parent, that now became a leaf (the player decides which of the two values to associate). The game ends when only one node (the one that was the root of the tree) is left.Pieguy goes first, and his goal is to maximize the value that will be associated with the root when the game ends. Piegirl wants to minimize that value. Assuming that both players are playing optimally, what number will be associated with the root when the game ends?" 3200

457E "Flow Optimality" "constructive algorithms,flows,math" "There is a computer network consisting of n nodes numbered 1 through n. There are links in the network that connect pairs of nodes. A pair of nodes may have multiple links between them, but no node has a link to itself.Each link supports unlimited bandwidth (in either direction), however a link may only transmit in a single direction at any given time. The cost of sending data across a link is proportional to the square of the bandwidth. Specifically, each link has a positive weight, and the cost of sending data across the link is the weight times the square of the bandwidth.The network is connected (there is a series of links from any node to any other node), and furthermore designed to remain connected in the event of any single node failure.You needed to send data from node 1 to node n at a bandwidth of some positive number k. That is, you wish to assign a bandwidth to each link so that the bandwidth into a node minus the bandwidth out of a node is \xe2\x80\x89-\xe2\x80\x89k for node 1, k for node n, and 0 for all other nodes. The individual bandwidths do not need to be integers.Wishing to minimize the total cost, you drew a diagram of the network, then gave the task to an intern to solve. The intern claimed to have solved the task and written the optimal bandwidths on your diagram, but then spilled coffee on it, rendering much of it unreadable (including parts of the original diagram, and the value of k).From the information available, determine if the intern\'s solution may have been optimal. That is, determine if there exists a valid network, total bandwidth, and optimal solution which is a superset of the given information. Furthermore, determine the efficiency of the intern\'s solution (if possible), where efficiency is defined as total cost divided by total bandwidth." 3000

457D Bingo! combinatorics,math,probabilities "The game of bingo is played on a 5\xe2\x80\x89\xc3\x97\xe2\x80\x895 square grid filled with distinct numbers between 1 and 75. In this problem you will consider a generalized version played on an n\xe2\x80\x89\xc3\x97\xe2\x80\x89n grid with distinct numbers between 1 and m (m\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89n2). A player begins by selecting a randomly generated bingo grid (generated uniformly among all available grids). Then k distinct numbers between 1 and m will be called at random (called uniformly among all available sets of k numbers). For each called number that appears on the grid, the player marks that cell. The score at the end is 2 raised to the power of (number of completely marked rows plus number of completely marked columns).Determine the expected value of the score. The expected score may be very large. If the expected score is larger than 1099, print 1099 instead (for example as ""1e99"" without the quotes)." 2700

457C Elections "brute force" "You are running for a governor in a small city in Russia. You ran some polls and did some research, and for every person in the city you know whom he will vote for, and how much it will cost to bribe that person to vote for you instead of whomever he wants to vote for right now. You are curious, what is the smallest amount of money you need to spend on bribing to win the elections. To win elections you need to have strictly more votes than any other candidate." 2100

457B "Distributed Join" greedy "Piegirl was asked to implement two table join operation for distributed database system, minimizing the network traffic.Suppose she wants to join two tables, A and B. Each of them has certain number of rows which are distributed on different number of partitions. Table A is distributed on the first cluster consisting of m partitions. Partition with index i has ai rows from A. Similarly, second cluster containing table B has n partitions, i-th one having bi rows from B. In one network operation she can copy one row from any partition to any other partition. At the end, for each row from A and each row from B there should be a partition that has both rows. Determine the minimal number of network operations to achieve this." 1900

457A "Golden System" math,meet-in-the-middle "Piegirl got bored with binary, decimal and other integer based counting systems. Recently she discovered some interesting properties about number , in particular that q2\xe2\x80\x89=\xe2\x80\x89q\xe2\x80\x89+\xe2\x80\x891, and she thinks it would make a good base for her new unique system. She called it ""golden system"". In golden system the number is a non-empty string containing 0\'s and 1\'s as digits. The decimal value of expression a0a1...an equals to .Soon Piegirl found out that this system doesn\'t have same properties that integer base systems do and some operations can not be performed on it. She wasn\'t able to come up with a fast way of comparing two numbers. She is asking for your help.Given two numbers written in golden system notation, determine which of them has larger decimal value." 1700

456B "Fedya and Maths" "math,number theory" "Fedya studies in a gymnasium. Fedya\'s maths hometask is to calculate the following expression:(1n\xe2\x80\x89+\xe2\x80\x892n\xe2\x80\x89+\xe2\x80\x893n\xe2\x80\x89+\xe2\x80\x894n)�mod�5for given value of n. Fedya managed to complete the task. Can you? Note that given number n can be extremely large (e.g. it can exceed any integer type of your programming language)." 1200

456A Laptops sortings "One day Dima and Alex had an argument about the price and quality of laptops. Dima thinks that the more expensive a laptop is, the better it is. Alex disagrees. Alex thinks that there are two laptops, such that the price of the first laptop is less (strictly smaller) than the price of the second laptop but the quality of the first laptop is higher (strictly greater) than the quality of the second laptop.Please, check the guess of Alex. You are given descriptions of n laptops. Determine whether two described above laptops exist." 1100

455E Function "data structures" "Serega and Fedor play with functions. One day they came across a very interesting function. It looks like that:  f(1,\xe2\x80\x89j)\xe2\x80\x89=\xe2\x80\x89a[j], 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n.  f(i,\xe2\x80\x89j)\xe2\x80\x89=\xe2\x80\x89min(f(i\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89j),\xe2\x80\x89f(i\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89j\xe2\x80\x89-\xe2\x80\x891))\xe2\x80\x89+\xe2\x80\x89a[j], 2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n, i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n. Here a is an integer array of length n.Serega and Fedya want to know what values this function takes at some points. But they don\'t want to calculate the values manually. So they ask you to help them." 2900

455D "Serega and Fun" "data structures" "Serega loves fun. However, everyone has fun in the unique manner. Serega has fun by solving query problems. One day Fedor came up with such a problem.You are given an array a consisting of n positive integers and queries to it. The queries can be of two types:  Make a unit cyclic shift to the right on the segment from l to r (both borders inclusive). That is rearrange elements of the array in the following manner:a[l],\xe2\x80\x89a[l\xe2\x80\x89+\xe2\x80\x891],\xe2\x80\x89...,\xe2\x80\x89a[r\xe2\x80\x89-\xe2\x80\x891],\xe2\x80\x89a[r]\xe2\x80\x89\xe2\x86\x92\xe2\x80\x89a[r],\xe2\x80\x89a[l],\xe2\x80\x89a[l\xe2\x80\x89+\xe2\x80\x891],\xe2\x80\x89...,\xe2\x80\x89a[r\xe2\x80\x89-\xe2\x80\x891]. Count how many numbers equal to k are on the segment from l to r (both borders inclusive). Fedor hurried to see Serega enjoy the problem and Serega solved it really quickly. Let\'s see, can you solve it?" 2700

455C Civilization "dfs and similar,dp,dsu,ternary search,trees" "Andrew plays a game called ""Civilization"". Dima helps him.The game has n cities and m bidirectional roads. The cities are numbered from 1 to n. Between any pair of cities there either is a single (unique) path, or there is no path at all. A path is such a sequence of distinct cities v1,\xe2\x80\x89v2,\xe2\x80\x89...,\xe2\x80\x89vk, that there is a road between any contiguous cities vi and vi\xe2\x80\x89+\xe2\x80\x891 (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89k). The length of the described path equals to (k\xe2\x80\x89-\xe2\x80\x891). We assume that two cities lie in the same region if and only if, there is a path connecting these two cities.During the game events of two types take place:  Andrew asks Dima about the length of the longest path in the region where city x lies.  Andrew asks Dima to merge the region where city x lies with the region where city y lies. If the cities lie in the same region, then no merging is needed. Otherwise, you need to merge the regions as follows: choose a city from the first region, a city from the second region and connect them by a road so as to minimize the length of the longest path in the resulting region. If there are multiple ways to do so, you are allowed to choose any of them. Dima finds it hard to execute Andrew\'s queries, so he asks you to help him. Help Dima." 2100

455B "A Lot of Games" "dfs and similar,dp,games,implementation,strings,trees" "Andrew, Fedor and Alex are inventive guys. Now they invent the game with strings for two players.Given a group of n non-empty strings. During the game two players build the word together, initially the word is empty. The players move in turns. On his step player must add a single letter in the end of the word, the resulting word must be prefix of at least one string from the group. A player loses if he cannot move.Andrew and Alex decided to play this game k times. The player who is the loser of the i-th game makes the first move in the (i\xe2\x80\x89+\xe2\x80\x891)-th game. Guys decided that the winner of all games is the player who wins the last (k-th) game. Andrew and Alex already started the game. Fedor wants to know who wins the game if both players will play optimally. Help him." 1900

455A Boredom dp "Alex doesn\'t like boredom. That\'s why whenever he gets bored, he comes up with games. One long winter evening he came up with a game and decided to play it.Given a sequence a consisting of n integers. The player can make several steps. In a single step he can choose an element of the sequence (let\'s denote it ak) and delete it, at that all elements equal to ak\xe2\x80\x89+\xe2\x80\x891 and ak\xe2\x80\x89-\xe2\x80\x891 also must be deleted from the sequence. That step brings ak points to the player. Alex is a perfectionist, so he decided to get as many points as possible. Help him." 1500

454B "Little Pony and Sort by Shift" implementation "One day, Twilight Sparkle is interested in how to sort a sequence of integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an in non-decreasing order. Being a young unicorn, the only operation she can perform is a unit shift. That is, she can move the last element of the sequence to its beginning:a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an\xe2\x80\x89\xe2\x86\x92\xe2\x80\x89an,\xe2\x80\x89a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an\xe2\x80\x89-\xe2\x80\x891. Help Twilight Sparkle to calculate: what is the minimum number of operations that she needs to sort the sequence?" 1200

454A "Little Pony and Crystal Mine" implementation "Twilight Sparkle once got a crystal from the Crystal Mine. A crystal of size n (n is odd; n\xe2\x80\x89>\xe2\x80\x891) is an n\xe2\x80\x89\xc3\x97\xe2\x80\x89n matrix with a diamond inscribed into it.You are given an odd integer n. You need to draw a crystal of size n. The diamond cells of the matrix should be represented by character ""D"". All other cells of the matrix should be represented by character ""*"". Look at the examples to understand what you need to draw." 800

453E "Little Pony and Lord Tirek" "data structures" "Lord Tirek is a centaur and the main antagonist in the season four finale episodes in the series ""My Little Pony: Friendship Is Magic"". In ""Twilight\'s Kingdom"" (Part 1), Tirek escapes from Tartarus and drains magic from ponies to grow stronger.  The core skill of Tirek is called Absorb Mana. It takes all mana from a magic creature and gives them to the caster.Now to simplify the problem, assume you have n ponies (numbered from 1 to n). Each pony has three attributes:  si : amount of mana that the pony has at time 0;  mi : maximum mana that the pony can have;  ri : mana regeneration per unit time. Lord Tirek will do m instructions, each of them can be described with three integers: ti,\xe2\x80\x89li,\xe2\x80\x89ri. The instruction means that at time ti, Tirek will use Absorb Mana on ponies with numbers from li to ri (both borders inclusive). We\'ll give you all the m instructions in order, count how much mana Tirek absorbs for each instruction." 3100

453D "Little Pony and Elements of Harmony" dp,matrices "The Elements of Harmony are six supernatural artifacts representing subjective aspects of harmony. They are arguably the most powerful force in Equestria. The inside of Elements of Harmony can be seen as a complete graph with n vertices labeled from 0 to n\xe2\x80\x89-\xe2\x80\x891, where n is a power of two, equal to 2m.  The energy in Elements of Harmony is in constant movement. According to the ancient book, the energy of vertex u in time i (ei[u]) equals to: Here b[] is the transformation coefficient \xe2\x80\x94 an array of m\xe2\x80\x89+\xe2\x80\x891 integers and f(u,\xe2\x80\x89v) is the number of ones in the binary representation of number (u�xor�v).Given the transformation coefficient and the energy distribution at time 0 (e0[]). Help Twilight Sparkle predict the energy distribution at time t (et[]). The answer can be quite large, so output it modulo p." 3000

453C "Little Pony and Summer Sun Celebration" "constructive algorithms,dfs and similar,graphs" "Twilight Sparkle learnt that the evil Nightmare Moon would return during the upcoming Summer Sun Celebration after one thousand years of imprisonment on the moon. She tried to warn her mentor Princess Celestia, but the princess ignored her and sent her to Ponyville to check on the preparations for the celebration.  Twilight Sparkle wanted to track the path of Nightmare Moon. Unfortunately, she didn\'t know the exact path. What she knew is the parity of the number of times that each place Nightmare Moon visited. Can you help Twilight Sparkle to restore any path that is consistent with this information?Ponyville can be represented as an undirected graph (vertices are places, edges are roads between places) without self-loops and multi-edges. The path can start and end at any place (also it can be empty). Each place can be visited multiple times. The path must not visit more than 4n places." 2200

453B "Little Pony and Harmony Chest" "bitmasks,brute force,dp" "Princess Twilight went to Celestia and Luna\'s old castle to research the chest from the Elements of Harmony.  A sequence of positive integers bi is harmony if and only if for every two elements of the sequence their greatest common divisor equals 1. According to an ancient book, the key of the chest is a harmony sequence bi which minimizes the following expression:You are given sequence ai, help Princess Twilight to find the key." 2000

453A "Little Pony and Expected Maximum" probabilities "Twilight Sparkle was playing Ludo with her friends Rainbow Dash, Apple Jack and Flutter Shy. But she kept losing. Having returned to the castle, Twilight Sparkle became interested in the dice that were used in the game.The dice has m faces: the first face of the dice contains a dot, the second one contains two dots, and so on, the m-th face contains m dots. Twilight Sparkle is sure that when the dice is tossed, each face appears with probability . Also she knows that each toss is independent from others. Help her to calculate the expected maximum number of dots she could get after tossing the dice n times." 1600

452F Permutation "data structures,divide and conquer,hashing" "You are given a permutation of numbers from 1 to n. Determine whether there\'s a pair of integers a,\xe2\x80\x89b (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a,\xe2\x80\x89b\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n;�a\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89b) such that the element  (note, that it is usual division, not integer one) is between a and b in this permutation." 2700

452E "Three strings" "data structures,dsu,string suffix structures,strings" "You are given three strings (s1,\xe2\x80\x89s2,\xe2\x80\x89s3). For each integer l (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89min(|s1|,\xe2\x80\x89|s2|,\xe2\x80\x89|s3|) you need to find how many triples (i1,\xe2\x80\x89i2,\xe2\x80\x89i3) exist such that three strings sk[ik... ik\xe2\x80\x89+\xe2\x80\x89l\xe2\x80\x89-\xe2\x80\x891] (k\xe2\x80\x89=\xe2\x80\x891,\xe2\x80\x892,\xe2\x80\x893) are pairwise equal. Print all found numbers modulo 1000000007�(109\xe2\x80\x89+\xe2\x80\x897).See notes if you are not sure about some of the denotions used in the statement." 2400

452D "Washer, Dryer, Folder" greedy,implementation "You have k pieces of laundry, each of which you want to wash, dry and fold. You are at a laundromat that has n1 washing machines, n2 drying machines and n3 folding machines. Each machine can process only one piece of laundry at a time. You can\'t dry a piece of laundry before it is washed, and you can\'t fold it before it is dried. Moreover, after a piece of laundry is washed, it needs to be immediately moved into a drying machine, and after it is dried, it needs to be immediately moved into a folding machine.It takes t1 minutes to wash one piece of laundry in a washing machine, t2 minutes to dry it in a drying machine, and t3 minutes to fold it in a folding machine. Find the smallest number of minutes that is enough to wash, dry and fold all the laundry you have." 1900

452C "Magic Trick" combinatorics,math,probabilities "Alex enjoys performing magic tricks. He has a trick that requires a deck of n cards. He has m identical decks of n different cards each, which have been mixed together. When Alex wishes to perform the trick, he grabs n cards at random and performs the trick with those. The resulting deck looks like a normal deck, but may have duplicates of some cards.The trick itself is performed as follows: first Alex allows you to choose a random card from the deck. You memorize the card and put it back in the deck. Then Alex shuffles the deck, and pulls out a card. If the card matches the one you memorized, the trick is successful.You don\'t think Alex is a very good magician, and that he just pulls a card randomly from the deck. Determine the probability of the trick being successful if this is the case." 2100

452B "4-point polyline" "brute force,constructive algorithms,geometry,trees" "You are given a rectangular grid of lattice points from (0,\xe2\x80\x890) to (n,\xe2\x80\x89m) inclusive. You have to choose exactly 4 different points to build a polyline possibly with self-intersections and self-touching. This polyline should be as long as possible.A polyline defined by points p1,\xe2\x80\x89p2,\xe2\x80\x89p3,\xe2\x80\x89p4 consists of the line segments p1\xe2\x80\x89p2,\xe2\x80\x89p2\xe2\x80\x89p3,\xe2\x80\x89p3\xe2\x80\x89p4, and its length is the sum of the lengths of the individual line segments." 1800

452A Eevee "brute force,implementation,strings" "You are solving the crossword problem K from IPSC 2014. You solved all the clues except for one: who does Eevee evolve into? You are not very into pokemons, but quick googling helped you find out, that Eevee can evolve into eight different pokemons: Vaporeon, Jolteon, Flareon, Espeon, Umbreon, Leafeon, Glaceon, and Sylveon.You know the length of the word in the crossword, and you already know some letters. Designers of the crossword made sure that the answer is unambiguous, so you can assume that exactly one pokemon out of the 8 that Eevee evolves into fits the length and the letters given. Your task is to find it." 1000

451E "Devu and Flowers" "bitmasks,combinatorics,number theory" "Devu wants to decorate his garden with flowers. He has purchased n boxes, where the i-th box contains fi flowers. All flowers in a single box are of the same color (hence they are indistinguishable). Also, no two boxes have flowers of the same color.Now Devu wants to select exactly s flowers from the boxes to decorate his garden. Devu would like to know, in how many different ways can he select the flowers from each box? Since this number may be very large, he asks you to find the number modulo (109\xe2\x80\x89+\xe2\x80\x897). Devu considers two ways different if there is at least one box from which different number of flowers are selected in these two ways." 2300

451D "Count Good Substrings" math "We call a string good, if after merging all the consecutive equal characters, the resulting string is palindrome. For example, ""aabba"" is good, because after the merging step it will become ""aba"".Given a string, you have to find two values:  the number of good substrings of even length;  the number of good substrings of odd length." 2000

451C "Predict Outcome of the Game" "brute force,implementation,math" "There are n games in a football tournament. Three teams are participating in it. Currently k games had already been played. You are an avid football fan, but recently you missed the whole k games. Fortunately, you remember a guess of your friend for these k games. Your friend did not tell exact number of wins of each team, instead he thought that absolute difference between number of wins of first and second team will be d1 and that of between second and third team will be d2.You don\'t want any of team win the tournament, that is each team should have the same number of wins after n games. That\'s why you want to know: does there exist a valid tournament satisfying the friend\'s guess such that no team will win this tournament?Note that outcome of a match can not be a draw, it has to be either win or loss." 1700

451B "Sort the Array" implementation,sortings "Being a programmer, you like arrays a lot. For your birthday, your friends have given you an array a consisting of n distinct integers.Unfortunately, the size of a is too small. You want a bigger array! Your friends agree to give you a bigger array, but only if you are able to answer the following question correctly: is it possible to sort the array a (in increasing order) by reversing exactly one segment of a? See definitions of segment and reversing in the notes." 1300

451A "Game With Sticks" implementation "After winning gold and silver in IOI 2014, Akshat and Malvika want to have some fun. Now they are playing a game on a grid made of n horizontal and m vertical sticks.An intersection point is any point on the grid which is formed by the intersection of one horizontal stick and one vertical stick.In the grid shown below, n\xe2\x80\x89=\xe2\x80\x893 and m\xe2\x80\x89=\xe2\x80\x893. There are n\xe2\x80\x89+\xe2\x80\x89m\xe2\x80\x89=\xe2\x80\x896 sticks in total (horizontal sticks are shown in red and vertical sticks are shown in green). There are n\xc2\xb7m\xe2\x80\x89=\xe2\x80\x899 intersection points, numbered from 1 to 9.  The rules of the game are very simple. The players move in turns. Akshat won gold, so he makes the first move. During his/her move, a player must choose any remaining intersection point and remove from the grid all sticks which pass through this point. A player will lose the game if he/she cannot make a move (i.e. there are no intersection points remaining on the grid at his/her move).Assume that both players play optimally. Who will win the game?" 900

450B "Jzzhu and Sequences" implementation,math "Jzzhu has invented a kind of sequences, they meet the following property:You are given x and y, please calculate fn modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." 1300

450A "Jzzhu and Children" implementation "There are n children in Jzzhu\'s school. Jzzhu is going to give some candies to them. Let\'s number all the children from 1 to n. The i-th child wants to get at least ai candies.Jzzhu asks children to line up. Initially, the i-th child stands at the i-th place of the line. Then Jzzhu start distribution of the candies. He follows the algorithm:  Give m candies to the first child of the line.  If this child still haven\'t got enough candies, then the child goes to the end of the line, else the child go home.  Repeat the first two steps while the line is not empty. Consider all the children in the order they go home. Jzzhu wants to know, which child will be the last in this order?" 1000

449E "Jzzhu and Squares" "dp,math,number theory" "Jzzhu has two integers, n and m. He calls an integer point (x,\xe2\x80\x89y) of a plane special if 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n and 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m. Jzzhu defines a unit square as a square with corners at points (x,\xe2\x80\x89y), (x\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89y), (x\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89y\xe2\x80\x89+\xe2\x80\x891), (x,\xe2\x80\x89y\xe2\x80\x89+\xe2\x80\x891), where x and y are some integers.Let\'s look at all the squares (their sides not necessarily parallel to the coordinate axes) with corners at the special points. For each such square Jzzhu paints a dot in every unit square that is fully inside it. After that some unit squares can contain several dots. Now Jzzhu wonders, how many dots he has painted on the plane. Find this number modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." 2900

449D "Jzzhu and Numbers" bitmasks,combinatorics,dp "Jzzhu have n non-negative integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. We will call a sequence of indexes i1,\xe2\x80\x89i2,\xe2\x80\x89...,\xe2\x80\x89ik (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i1\xe2\x80\x89<\xe2\x80\x89i2\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89ik\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) a group of size k. Jzzhu wonders, how many groups exists such that ai1 & ai2 & ... & aik\xe2\x80\x89=\xe2\x80\x890 (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n)? Help him and print this number modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897). Operation x & y denotes bitwise AND operation of two numbers." 2400

449C "Jzzhu and Apples" "constructive algorithms,number theory" "Jzzhu has picked n apples from his big apple tree. All the apples are numbered from 1 to n. Now he wants to sell them to an apple store. Jzzhu will pack his apples into groups and then sell them. Each group must contain two apples, and the greatest common divisor of numbers of the apples in each group must be greater than 1. Of course, each apple can be part of at most one group.Jzzhu wonders how to get the maximum possible number of groups. Can you help him?" 2500

449B "Jzzhu and Cities" "graphs,greedy,shortest paths" "Jzzhu is the president of country A. There are n cities numbered from 1 to n in his country. City 1 is the capital of A. Also there are m roads connecting the cities. One can go from city ui to vi (and vise versa) using the i-th road, the length of this road is xi. Finally, there are k train routes in the country. One can use the i-th train route to go from capital of the country to city si (and vise versa), the length of this route is yi.Jzzhu doesn\'t want to waste the money of the country, so he is going to close some of the train routes. Please tell Jzzhu the maximum number of the train routes which can be closed under the following condition: the length of the shortest path from every city to the capital mustn\'t change." 2000

449A "Jzzhu and Chocolate" greedy,math "Jzzhu has a big rectangular chocolate bar that consists of n\xe2\x80\x89\xc3\x97\xe2\x80\x89m unit squares. He wants to cut this bar exactly k times. Each cut must meet the following requirements:  each cut should be straight (horizontal or vertical);  each cut should go along edges of unit squares (it is prohibited to divide any unit chocolate square with cut);  each cut should go inside the whole chocolate bar, and all cuts must be distinct. The picture below shows a possible way to cut a 5\xe2\x80\x89\xc3\x97\xe2\x80\x896 chocolate for 5 times.  Imagine Jzzhu have made k cuts and the big chocolate is splitted into several pieces. Consider the smallest (by area) piece of the chocolate, Jzzhu wants this piece to be as large as possible. What is the maximum possible area of smallest piece he can get with exactly k cuts? The area of a chocolate piece is the number of unit squares in it." 1700

448E Divisors "brute force,dfs and similar,implementation,number theory" "Bizon the Champion isn\'t just friendly, he also is a rigorous coder.Let\'s define function f(a), where a is a sequence of integers. Function f(a) returns the following sequence: first all divisors of a1 go in the increasing order, then all divisors of a2 go in the increasing order, and so on till the last element of sequence a. For example, f([2,\xe2\x80\x899,\xe2\x80\x891])\xe2\x80\x89=\xe2\x80\x89[1,\xe2\x80\x892,\xe2\x80\x891,\xe2\x80\x893,\xe2\x80\x899,\xe2\x80\x891].Let\'s determine the sequence Xi, for integer i (i\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x890): X0\xe2\x80\x89=\xe2\x80\x89[X] ([X] is a sequence consisting of a single number X), Xi\xe2\x80\x89=\xe2\x80\x89f(Xi\xe2\x80\x89-\xe2\x80\x891) (i\xe2\x80\x89>\xe2\x80\x890). For example, at X\xe2\x80\x89=\xe2\x80\x896 we get X0\xe2\x80\x89=\xe2\x80\x89[6], X1\xe2\x80\x89=\xe2\x80\x89[1,\xe2\x80\x892,\xe2\x80\x893,\xe2\x80\x896], X2\xe2\x80\x89=\xe2\x80\x89[1,\xe2\x80\x891,\xe2\x80\x892,\xe2\x80\x891,\xe2\x80\x893,\xe2\x80\x891,\xe2\x80\x892,\xe2\x80\x893,\xe2\x80\x896].Given the numbers X and k, find the sequence Xk. As the answer can be rather large, find only the first 105 elements of this sequence." 2200

448D "Multiplication Table" "binary search,brute force" "Bizon the Champion isn\'t just charming, he also is very smart.While some of us were learning the multiplication table, Bizon the Champion had fun in his own manner. Bizon the Champion painted an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m multiplication table, where the element on the intersection of the i-th row and j-th column equals i\xc2\xb7j (the rows and columns of the table are numbered starting from 1). Then he was asked: what number in the table is the k-th largest number? Bizon the Champion always answered correctly and immediately. Can you repeat his success?Consider the given multiplication table. If you write out all n\xc2\xb7m numbers from the table in the non-decreasing order, then the k-th number you write out is called the k-th largest number." 1800

448C "Painting Fence" "divide and conquer,dp,greedy" "Bizon the Champion isn\'t just attentive, he also is very hardworking.Bizon the Champion decided to paint his old fence his favorite color, orange. The fence is represented as n vertical planks, put in a row. Adjacent planks have no gap between them. The planks are numbered from the left to the right starting from one, the i-th plank has the width of 1 meter and the height of ai meters.Bizon the Champion bought a brush in the shop, the brush\'s width is 1 meter. He can make vertical and horizontal strokes with the brush. During a stroke the brush\'s full surface must touch the fence at all the time (see the samples for the better understanding). What minimum number of strokes should Bizon the Champion do to fully paint the fence? Note that you are allowed to paint the same area of the fence multiple times." 1900

448B "Suffix Structures" implementation,strings "Bizon the Champion isn\'t just a bison. He also is a favorite of the ""Bizons"" team.At a competition the ""Bizons"" got the following problem: ""You are given two distinct words (strings of English letters), s and t. You need to transform word s into word t"". The task looked simple to the guys because they know the suffix data structures well. Bizon Senior loves suffix automaton. By applying it once to a string, he can remove from this string any single character. Bizon Middle knows suffix array well. By applying it once to a string, he can swap any two characters of this string. The guys do not know anything about the suffix tree, but it can help them do much more. Bizon the Champion wonders whether the ""Bizons"" can solve the problem. Perhaps, the solution do not require both data structures. Find out whether the guys can solve the problem and if they can, how do they do it? Can they solve it either only with use of suffix automaton or only with use of suffix array or they need both structures? Note that any structure may be used an unlimited number of times, the structures may be used in any order." 1400

448A Rewards implementation "Bizon the Champion is called the Champion for a reason. Bizon the Champion has recently got a present \xe2\x80\x94 a new glass cupboard with n shelves and he decided to put all his presents there. All the presents can be divided into two types: medals and cups. Bizon the Champion has a1 first prize cups, a2 second prize cups and a3 third prize cups. Besides, he has b1 first prize medals, b2 second prize medals and b3 third prize medals. Naturally, the rewards in the cupboard must look good, that\'s why Bizon the Champion decided to follow the rules:  any shelf cannot contain both cups and medals at the same time;  no shelf can contain more than five cups;  no shelf can have more than ten medals. Help Bizon the Champion find out if we can put all the rewards so that all the conditions are fulfilled." 800

447B "DZY Loves Strings" greedy,implementation "DZY loves collecting special strings which only contain lowercase letters. For each lowercase letter c DZY knows its value wc. For each special string s\xe2\x80\x89=\xe2\x80\x89s1s2... s|s| (|s| is the length of the string) he represents its value with a function f(s), where Now DZY has a string s. He wants to insert k lowercase letters into this string in order to get the largest possible value of the resulting string. Can you help him calculate the largest possible value he could get?" 1000

447A "DZY Loves Hash" implementation "DZY has a hash table with p buckets, numbered from 0 to p\xe2\x80\x89-\xe2\x80\x891. He wants to insert n numbers, in the order they are given, into the hash table. For the i-th number xi, DZY will put it into the bucket numbered h(xi), where h(x) is the hash function. In this problem we will assume, that h(x)\xe2\x80\x89=\xe2\x80\x89x�mod�p. Operation a�mod�b denotes taking a remainder after division a by b.However, each bucket can contain no more than one element. If DZY wants to insert an number into a bucket which is already filled, we say a ""conflict"" happens. Suppose the first conflict happens right after the i-th insertion, you should output i. If no conflict happens, just output -1." 800

446E "DZY Loves Bridges" math,matrices "DZY owns 2m islands near his home, numbered from 1 to 2m. He loves building bridges to connect the islands. Every bridge he builds takes one day\'s time to walk across.DZY has a strange rule of building the bridges. For every pair of islands u,\xe2\x80\x89v�(u\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89v), he has built 2k different bridges connecting them, where  (a|b means b is divisible by a). These bridges are bidirectional.Also, DZY has built some bridges connecting his home with the islands. Specifically, there are ai different bridges from his home to the i-th island. These are one-way bridges, so after he leaves his home he will never come back.DZY decides to go to the islands for sightseeing. At first he is at home. He chooses and walks across one of the bridges connecting with his home, and arrives at some island. After that, he will spend t day(s) on the islands. Each day, he can choose to stay and rest, or to walk to another island across the bridge. It is allowed to stay at an island for more than one day. It\'s also allowed to cross one bridge more than once.Suppose that right after the t-th day DZY stands at the i-th island. Let ans[i] be the number of ways for DZY to reach the i-th island after t-th day. Your task is to calculate ans[i] for each i modulo 1051131." 3100

446D "DZY Loves Games" math,matrices,probabilities "Today DZY begins to play an old game. In this game, he is in a big maze with n rooms connected by m corridors (each corridor allows to move in both directions). You can assume that all the rooms are connected with corridors directly or indirectly.DZY has got lost in the maze. Currently he is in the first room and has k lives. He will act like the follows:  Firstly he will randomly pick one of the corridors going from his current room. Each outgoing corridor has the same probability to be picked.  Then he will go through the corridor and then the process repeats. There are some rooms which have traps in them. The first room definitely has no trap, the n-th room definitely has a trap. Each time DZY enters one of these rooms, he will lost one life. Now, DZY knows that if he enters the n-th room with exactly 2 lives, firstly he will lost one live, but then he will open a bonus round. He wants to know the probability for him to open the bonus round. Please, help him." 2800

446C "DZY Loves Fibonacci Numbers" "data structures,math,number theory" "In mathematical terms, the sequence Fn of Fibonacci numbers is defined by the recurrence relation F1\xe2\x80\x89=\xe2\x80\x891;�F2\xe2\x80\x89=\xe2\x80\x891;�Fn\xe2\x80\x89=\xe2\x80\x89Fn\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x89Fn\xe2\x80\x89-\xe2\x80\x892�(n\xe2\x80\x89>\xe2\x80\x892).DZY loves Fibonacci numbers very much. Today DZY gives you an array consisting of n integers: a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. Moreover, there are m queries, each query has one of the two types:  Format of the query ""1 l r"". In reply to the query, you need to add Fi\xe2\x80\x89-\xe2\x80\x89l\xe2\x80\x89+\xe2\x80\x891 to each element ai, where l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r.  Format of the query ""2 l r"". In reply to the query you should output the value of  modulo 1000000009�(109\xe2\x80\x89+\xe2\x80\x899). Help DZY reply to all the queries." 2400

446B "DZY Loves Modification" "brute force,data structures,greedy" "As we know, DZY loves playing games. One day DZY decided to play with a n\xe2\x80\x89\xc3\x97\xe2\x80\x89m matrix. To be more precise, he decided to modify the matrix with exactly k operations.Each modification is one of the following:  Pick some row of the matrix and decrease each element of the row by p. This operation brings to DZY the value of pleasure equal to the sum of elements of the row before the decreasing.  Pick some column of the matrix and decrease each element of the column by p. This operation brings to DZY the value of pleasure equal to the sum of elements of the column before the decreasing. DZY wants to know: what is the largest total value of pleasure he could get after performing exactly k modifications? Please, help him to calculate this value." 2000

446A "DZY Loves Sequences" "dp,implementation,two pointers" "DZY has a sequence a, consisting of n integers.We\'ll call a sequence ai,\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89aj (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) a subsegment of the sequence a. The value (j\xe2\x80\x89-\xe2\x80\x89i\xe2\x80\x89+\xe2\x80\x891) denotes the length of the subsegment.Your task is to find the longest subsegment of a, such that it is possible to change at most one number (change one number to any integer you want) from the subsegment to make the subsegment strictly increasing.You only need to output the length of the subsegment you find." 1600

445B "DZY Loves Chemistry" "dfs and similar,dsu,greedy" "DZY loves chemistry, and he enjoys mixing chemicals.DZY has n chemicals, and m pairs of them will react. He wants to pour these chemicals into a test tube, and he needs to pour them in one by one, in any order. Let\'s consider the danger of a test tube. Danger of an empty test tube is 1. And every time when DZY pours a chemical, if there are already one or more chemicals in the test tube that can react with it, the danger of the test tube will be multiplied by 2. Otherwise the danger remains as it is.Find the maximum possible danger after pouring all the chemicals one by one in optimal order." 1400

445A "DZY Loves Chessboard" "dfs and similar,implementation" "DZY loves chessboard, and he enjoys playing with it.He has a chessboard of n rows and m columns. Some cells of the chessboard are bad, others are good. For every good cell, DZY wants to put a chessman on it. Each chessman is either white or black. After putting all chessmen, DZY wants that no two chessmen with the same color are on two adjacent cells. Two cells are adjacent if and only if they share a common edge.You task is to find any suitable placement of chessmen on the given chessboard." 1200

444E "DZY Loves Planting" "binary search,dsu,trees" "DZY loves planting, and he enjoys solving tree problems.DZY has a weighted tree (connected undirected graph without cycles) containing n nodes (they are numbered from 1 to n). He defines the function g(x,\xe2\x80\x89y) (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x,\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) as the longest edge in the shortest path between nodes x and y. Specially g(z,\xe2\x80\x89z)\xe2\x80\x89=\xe2\x80\x890 for every z.For every integer sequence p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pn (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89pi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n), DZY defines f(p) as . DZY wants to find such a sequence p that f(p) has maximum possible value. But there is one more restriction: the element j can appear in p at most xj times.Please, find the maximum possible f(p) under the described restrictions." 2700

444D "DZY Loves Strings" "binary search,hashing,strings,two pointers" "DZY loves collecting special strings which only contain lowercase letters. For each lowercase letter c DZY knows its value wc. For each special string s\xe2\x80\x89=\xe2\x80\x89s1s2... s|s| (|s| is the length of the string) he represents its value with a function f(s), where Now DZY has a string s. He wants to insert k lowercase letters into this string in order to get the largest possible value of the resulting string. Can you help him calculate the largest possible value he could get?" 2500

444C "DZY Loves Colors" "data structures" "DZY loves colors, and he enjoys painting.On a colorful day, DZY gets a colorful ribbon, which consists of n units (they are numbered from 1 to n from left to right). The color of the i-th unit of the ribbon is i at first. It is colorful enough, but we still consider that the colorfulness of each unit is 0 at first.DZY loves painting, we know. He takes up a paintbrush with color x and uses it to draw a line on the ribbon. In such a case some contiguous units are painted. Imagine that the color of unit i currently is y. When it is painted by this paintbrush, the color of the unit becomes x, and the colorfulness of the unit increases by |x\xe2\x80\x89-\xe2\x80\x89y|.DZY wants to perform m operations, each operation can be one of the following:  Paint all the units with numbers between l and r (both inclusive) with color x.  Ask the sum of colorfulness of the units between l and r (both inclusive). Can you help DZY?" 2400

444B "DZY Loves FFT" probabilities "DZY loves Fast Fourier Transformation, and he enjoys using it.Fast Fourier Transformation is an algorithm used to calculate convolution. Specifically, if a, b and c are sequences with length n, which are indexed from 0 to n\xe2\x80\x89-\xe2\x80\x891, andWe can calculate c fast using Fast Fourier Transformation.DZY made a little change on this formula. NowTo make things easier, a is a permutation of integers from 1 to n, and b is a sequence only containing 0 and 1. Given a and b, DZY needs your help to calculate c.Because he is naughty, DZY provides a special way to get a and b. What you need is only three integers n, d, x. After getting them, use the code below to generate a and b.//x is 64-bit variable;function getNextX() {    x = (x * 37 + 10007) % 1000000007;    return x;}function initAB() {    for(i = 0; i < n; i = i + 1){        a[i] = i + 1;    }    for(i = 0; i < n; i = i + 1){        swap(a[i], a[getNextX() % (i + 1)]);    }    for(i = 0; i < n; i = i + 1){        if (i < d)            b[i] = 1;        else            b[i] = 0;    }    for(i = 0; i < n; i = i + 1){        swap(b[i], b[getNextX() % (i + 1)]);    }}Operation x % y denotes remainder after division x by y. Function swap(x, y) swaps two values x and y." 2300

444A "DZY Loves Physics" greedy,math "DZY loves Physics, and he enjoys calculating density.Almost everything has density, even a graph. We define the density of a non-directed graph (nodes and edges of the graph have some values) as follows:  where v is the sum of the values of the nodes, e is the sum of the values of the edges.Once DZY got a graph G, now he wants to find a connected induced subgraph G\' of the graph, such that the density of G\' is as large as possible.An induced subgraph G\'(V\',\xe2\x80\x89E\') of a graph G(V,\xe2\x80\x89E) is a graph that satisfies:  ;  edge  if and only if , and edge ;  the value of an edge in G\' is the same as the value of the corresponding edge in G, so as the value of a node. Help DZY to find the induced subgraph with maximum density. Note that the induced subgraph you choose must be connected." 1600

443B "Kolya and Tandem Repeat" "brute force,implementation,strings" "Kolya got string s for his birthday, the string consists of small English letters. He immediately added k more characters to the right of the string.Then Borya came and said that the new string contained a tandem repeat of length l as a substring. How large could l be?See notes for definition of a tandem repeat." 1500

443A "Anton and Letters" "constructive algorithms,implementation" "Recently, Anton has found a set. The set consists of small English letters. Anton carefully wrote out all the letters from the set in one line, separated by a comma. He also added an opening curved bracket at the beginning of the line and a closing curved bracket at the end of the line. Unfortunately, from time to time Anton would forget writing some letter and write it again. He asks you to count the total number of distinct letters in his set." 800

442E "Gena and Second Distance" geometry "Gena doesn\'t like geometry, so he asks you to solve this problem for him.A rectangle with sides parallel to coordinate axes contains n dots. Let\'s consider some point of the plane. Let\'s count the distances from this point to the given n points. Let\'s sort these numbers in the non-decreasing order. We\'ll call the beauty of the point the second element of this array. If there are two mimimum elements in this array, the beaty will be equal to this minimum.Find the maximum beauty of a point inside the given rectangle." 3100

442D "Adam and Tree" "data structures,trees" "When Adam gets a rooted tree (connected non-directed graph without cycles), he immediately starts coloring it. More formally, he assigns a color to each edge of the tree so that it meets the following two conditions:   There is no vertex that has more than two incident edges painted the same color.  For any two vertexes that have incident edges painted the same color (say, c), the path between them consists of the edges of the color c. Not all tree paintings are equally good for Adam. Let\'s consider the path from some vertex to the root. Let\'s call the number of distinct colors on this path the cost of the vertex. The cost of the tree\'s coloring will be the maximum cost among all the vertexes. Help Adam determine the minimum possible cost of painting the tree. Initially, Adam\'s tree consists of a single vertex that has number one and is the root. In one move Adam adds a new vertex to the already existing one, the new vertex gets the number equal to the minimum positive available integer. After each operation you need to calculate the minimum cost of coloring the resulting tree." 2600

442C "Artem and Array" "data structures,greedy" "Artem has an array of n positive integers. Artem decided to play with it. The game consists of n moves. Each move goes like this. Artem chooses some element of the array and removes it. For that, he gets min(a,\xe2\x80\x89b) points, where a and b are numbers that were adjacent with the removed number. If the number doesn\'t have an adjacent number to the left or right, Artem doesn\'t get any points. After the element is removed, the two parts of the array glue together resulting in the new array that Artem continues playing with. Borya wondered what maximum total number of points Artem can get as he plays this game." 2500

442B "Andrey and Problem" greedy,math,probabilities "Andrey needs one more problem to conduct a programming contest. He has n friends who are always willing to help. He can ask some of them to come up with a contest problem. Andrey knows one value for each of his fiends \xe2\x80\x94 the probability that this friend will come up with a problem if Andrey asks him.Help Andrey choose people to ask. As he needs only one problem, Andrey is going to be really upset if no one comes up with a problem or if he gets more than one problem from his friends. You need to choose such a set of people that maximizes the chances of Andrey not getting upset." 1800

442A "Borya and Hanabi" "bitmasks,brute force,implementation" "Have you ever played Hanabi? If not, then you\'ve got to try it out! This problem deals with a simplified version of the game.Overall, the game has 25 types of cards (5 distinct colors and 5 distinct values). Borya is holding n cards. The game is somewhat complicated by the fact that everybody sees Borya\'s cards except for Borya himself. Borya knows which cards he has but he knows nothing about the order they lie in. Note that Borya can have multiple identical cards (and for each of the 25 types of cards he knows exactly how many cards of this type he has).The aim of the other players is to achieve the state when Borya knows the color and number value of each of his cards. For that, other players can give him hints. The hints can be of two types: color hints and value hints. A color hint goes like that: a player names some color and points at all the cards of this color. Similarly goes the value hint. A player names some value and points at all the cards that contain the value.Determine what minimum number of hints the other players should make for Borya to be certain about each card\'s color and value." 1700

441E "Valera and Number" bitmasks,dp,math,probabilities "Valera is a coder. Recently he wrote a funny program. The pseudo code for this program is given below://input: integers x, k, pa = x;for(step = 1; step <= k; step = step + 1){    rnd = [random integer from 1 to 100];    if(rnd <= p)        a = a * 2;    else        a = a + 1;}s = 0;while(remainder after dividing a by 2 equals 0){    a = a / 2;    s = s + 1;}Now Valera wonders: given the values x, k and p, what is the expected value of the resulting number s?" 2400

441D "Valera and Swaps" "constructive algorithms,dsu,graphs,implementation,math,string suffix structures" "A permutation p of length n is a sequence of distinct integers p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pn (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89pi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n). A permutation is an identity permutation, if for any i the following equation holds pi\xe2\x80\x89=\xe2\x80\x89i. A swap (i,\xe2\x80\x89j) is the operation that swaps elements pi and pj in the permutation. Let\'s assume that f(p) is the minimum number of swaps that you need to make the permutation p an identity permutation. Valera wonders, how he can transform permutation p into any permutation q, such that f(q)\xe2\x80\x89=\xe2\x80\x89m, using the minimum number of swaps. Help him do that." 2100

441C "Valera and Tubes" "constructive algorithms,dfs and similar,implementation" "Valera has got a rectangle table consisting of n rows and m columns. Valera numbered the table rows starting from one, from top to bottom and the columns \xe2\x80\x93 starting from one, from left to right. We will represent cell that is on the intersection of row x and column y by a pair of integers (x,\xe2\x80\x89y).Valera wants to place exactly k tubes on his rectangle table. A tube is such sequence of table cells (x1,\xe2\x80\x89y1), (x2,\xe2\x80\x89y2), ..., (xr,\xe2\x80\x89yr), that:   r\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x892;  for any integer i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89-\xe2\x80\x891) the following equation |xi\xe2\x80\x89-\xe2\x80\x89xi\xe2\x80\x89+\xe2\x80\x891|\xe2\x80\x89+\xe2\x80\x89|yi\xe2\x80\x89-\xe2\x80\x89yi\xe2\x80\x89+\xe2\x80\x891|\xe2\x80\x89=\xe2\x80\x891 holds;  each table cell, which belongs to the tube, must occur exactly once in the sequence. Valera thinks that the tubes are arranged in a fancy manner if the following conditions are fulfilled:   no pair of tubes has common cells;  each cell of the table belongs to some tube. Help Valera to arrange k tubes on his rectangle table in a fancy manner." 1500

441B "Valera and Fruits" greedy,implementation "Valera loves his garden, where n fruit trees grow.This year he will enjoy a great harvest! On the i-th tree bi fruit grow, they will ripen on a day number ai. Unfortunately, the fruit on the tree get withered, so they can only be collected on day ai and day ai\xe2\x80\x89+\xe2\x80\x891 (all fruits that are not collected in these two days, become unfit to eat).Valera is not very fast, but there are some positive points. Valera is ready to work every day. In one day, Valera can collect no more than v fruits. The fruits may be either from the same tree, or from different ones. What is the maximum amount of fruit Valera can collect for all time, if he operates optimally well?" 1400

441A "Valera and Antique Items" implementation "Valera is a collector. Once he wanted to expand his collection with exactly one antique item.Valera knows n sellers of antiques, the i-th of them auctioned ki items. Currently the auction price of the j-th object of the i-th seller is sij. Valera gets on well with each of the n sellers. He is perfectly sure that if he outbids the current price of one of the items in the auction (in other words, offers the seller the money that is strictly greater than the current price of the item at the auction), the seller of the object will immediately sign a contract with him.Unfortunately, Valera has only v units of money. Help him to determine which of the n sellers he can make a deal with." 1000

440D "Berland Federalization" dp,trees "Recently, Berland faces federalization requests more and more often. The proponents propose to divide the country into separate states. Moreover, they demand that there is a state which includes exactly k towns.Currently, Berland has n towns, some pairs of them are connected by bilateral roads. Berland has only n\xe2\x80\x89-\xe2\x80\x891 roads. You can reach any city from the capital, that is, the road network forms a tree.The Ministry of Roads fears that after the reform those roads that will connect the towns of different states will bring a lot of trouble.Your task is to come up with a plan to divide the country into states such that:  each state is connected, i.e. for each state it is possible to get from any town to any other using its roads (that is, the roads that connect the state towns),  there is a state that consisted of exactly k cities,  the number of roads that connect different states is minimum." 2200

440C "One-Based Arithmetic" "brute force,dfs and similar,divide and conquer" "Prof. Vasechkin wants to represent positive integer n as a sum of addends, where each addends is an integer number containing only 1s. For example, he can represent 121 as 121=111+11+\xe2\x80\x931. Help him to find the least number of digits 1 in such sum." 1800

440B Balancer greedy,implementation "Petya has k matches, placed in n matchboxes lying in a line from left to right. We know that k is divisible by n. Petya wants all boxes to have the same number of matches inside. For that, he can move a match from its box to the adjacent one in one move. How many such moves does he need to achieve the desired configuration?" 1600

440A "Forgotten Episode" implementation "Polycarpus adores TV series. Right now he is ready to finish watching a season of a popular sitcom ""Graph Theory"". In total, the season has n episodes, numbered with integers from 1 to n.Polycarpus watches episodes not one by one but in a random order. He has already watched all the episodes except for one. Which episode has Polycaprus forgotten to watch?" 800

439E "Devu and Birthday Celebration" combinatorics,dp,math "Today is Devu\'s birthday. For celebrating the occasion, he bought n sweets from the nearby market. He has invited his f friends. He would like to distribute the sweets among them. As he is a nice guy and the occasion is great, he doesn\'t want any friend to be sad, so he would ensure to give at least one sweet to each friend. He wants to celebrate it in a unique style, so he would like to ensure following condition for the distribution of sweets. Assume that he has distributed n sweets to his friends such that ith friend is given ai sweets. He wants to make sure that there should not be any positive integer x\xe2\x80\x89>\xe2\x80\x891, which divides every ai.Please find the number of ways he can distribute sweets to his friends in the required way. Note that the order of distribution is important, for example [1, 2] and [2, 1] are distinct distributions. As the answer could be very large, output answer modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897).To make the problem more interesting, you are given q queries. Each query contains an n, f pair. For each query please output the required number of ways modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." 2100

439D "Devu and his Brother" "binary search,sortings,ternary search,two pointers" "Devu and his brother love each other a lot. As they are super geeks, they only like to play with arrays. They are given two arrays a and b by their father. The array a is given to Devu and b to his brother. As Devu is really a naughty kid, he wants the minimum value of his array a should be at least as much as the maximum value of his brother\'s array b. Now you have to help Devu in achieving this condition. You can perform multiple operations on the arrays. In a single operation, you are allowed to decrease or increase any element of any of the arrays by 1. Note that you are allowed to apply the operation on any index of the array multiple times.You need to find minimum number of operations required to satisfy Devu\'s condition so that the brothers can play peacefully without fighting." 1700

439C "Devu and Partitioning of the Array" "brute force,constructive algorithms,implementation,number theory" "Devu being a small kid, likes to play a lot, but he only likes to play with arrays. While playing he came up with an interesting question which he could not solve, can you please solve it for him?Given an array consisting of distinct integers. Is it possible to partition the whole array into k disjoint non-empty parts such that p of the parts have even sum (each of them must have even sum) and remaining k - p have odd sum? (note that parts need not to be continuous).If it is possible to partition the array, also give any possible way of valid partitioning." 1700

439B "Devu, the Dumb Guy" implementation,sortings "Devu is a dumb guy, his learning curve is very slow. You are supposed to teach him n subjects, the ith subject has ci chapters. When you teach him, you are supposed to teach all the chapters of a subject continuously.Let us say that his initial per chapter learning power of a subject is x hours. In other words he can learn a chapter of a particular subject in x hours.Well Devu is not complete dumb, there is a good thing about him too. If you teach him a subject, then time required to teach any chapter of the next subject will require exactly 1 hour less than previously required (see the examples to understand it more clearly). Note that his per chapter learning power can not be less than 1 hour.You can teach him the n subjects in any possible order. Find out minimum amount of time (in hours) Devu will take to understand all the subjects and you will be free to do some enjoying task rather than teaching a dumb guy.Please be careful that answer might not fit in 32 bit data type." 1200

439A "Devu, the Singer and Churu, the Joker" greedy,implementation "Devu is a renowned classical singer. He is invited to many big functions/festivals. Recently he was invited to ""All World Classical Singing Festival"". Other than Devu, comedian Churu was also invited.Devu has provided organizers a list of the songs and required time for singing them. He will sing n songs, ith song will take ti minutes exactly. The Comedian, Churu will crack jokes. All his jokes are of 5 minutes exactly.People have mainly come to listen Devu. But you know that he needs rest of 10 minutes after each song. On the other hand, Churu being a very active person, doesn\'t need any rest.You as one of the organizers should make an optimal s\xd1\x81hedule for the event. For some reasons you must follow the conditions:  The duration of the event must be no more than d minutes;  Devu must complete all his songs;  With satisfying the two previous conditions the number of jokes cracked by Churu should be as many as possible. If it is not possible to find a way to conduct all the songs of the Devu, output -1. Otherwise find out maximum number of jokes that Churu can crack in the grand event." 900

438E "The Child and Binary Tree" "combinatorics,divide and conquer,fft,number theory" "Our child likes computer science very much, especially he likes binary trees.Consider the sequence of n distinct positive integers: c1,\xe2\x80\x89c2,\xe2\x80\x89...,\xe2\x80\x89cn. The child calls a vertex-weighted rooted binary tree good if and only if for every vertex v, the weight of v is in the set {c1,\xe2\x80\x89c2,\xe2\x80\x89...,\xe2\x80\x89cn}. Also our child thinks that the weight of a vertex-weighted tree is the sum of all vertices\' weights.Given an integer m, can you for all s (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89s\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m) calculate the number of good vertex-weighted rooted binary trees with weight s? Please, check the samples for better understanding what trees are considered different.We only want to know the answer modulo 998244353 (7\xe2\x80\x89\xc3\x97\xe2\x80\x8917\xe2\x80\x89\xc3\x97\xe2\x80\x89223\xe2\x80\x89+\xe2\x80\x891, a prime number)." 3100

438D "The Child and Sequence" "data structures,math" "At the children\'s day, the child came to Picks\'s house, and messed his house up. Picks was angry at him. A lot of important things were lost, in particular the favorite sequence of Picks.Fortunately, Picks remembers how to repair the sequence. Initially he should create an integer array a[1],\xe2\x80\x89a[2],\xe2\x80\x89...,\xe2\x80\x89a[n]. Then he should perform a sequence of m operations. An operation can be one of the following:  Print operation l,\xe2\x80\x89r. Picks should write down the value of .  Modulo operation l,\xe2\x80\x89r,\xe2\x80\x89x. Picks should perform assignment a[i]\xe2\x80\x89=\xe2\x80\x89a[i]�mod�x for each i (l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r).  Set operation k,\xe2\x80\x89x. Picks should set the value of a[k] to x (in other words perform an assignment a[k]\xe2\x80\x89=\xe2\x80\x89x). Can you help Picks to perform the whole sequence of operations?" 2300

437E "The Child and Polygon" dp,geometry "This time our child has a simple polygon. He has to find the number of ways to split the polygon into non-degenerate triangles, each way must satisfy the following requirements:  each vertex of each triangle is one of the polygon vertex;  each side of the polygon must be the side of exactly one triangle;  the area of intersection of every two triangles equals to zero, and the sum of all areas of triangles equals to the area of the polygon;  each triangle must be completely inside the polygon;  each side of each triangle must contain exactly two vertices of the polygon. The picture below depicts an example of a correct splitting.  Please, help the child. Calculate the described number of ways modulo 1000000007 (109\xe2\x80\x89\xe2\x80\x89+\xe2\x80\x89\xe2\x80\x897) for him." 2500

437D "The Child and Zoo" dsu,sortings "Of course our child likes walking in a zoo. The zoo has n areas, that are numbered from 1 to n. The i-th area contains ai animals in it. Also there are m roads in the zoo, and each road connects two distinct areas. Naturally the zoo is connected, so you can reach any area of the zoo from any other area using the roads.Our child is very smart. Imagine the child want to go from area p to area q. Firstly he considers all the simple routes from p to q. For each route the child writes down the number, that is equal to the minimum number of animals among the route areas. Let\'s denote the largest of the written numbers as f(p,\xe2\x80\x89q). Finally, the child chooses one of the routes for which he writes down the value f(p,\xe2\x80\x89q).After the child has visited the zoo, he thinks about the question: what is the average value of f(p,\xe2\x80\x89q) for all pairs p,\xe2\x80\x89q (p\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89q)? Can you answer his question?" 1900

437C "The Child and Toy" graphs,greedy,sortings "On Children\'s Day, the child got a toy from Delayyy as a present. However, the child is so naughty that he can\'t wait to destroy the toy.The toy consists of n parts and m ropes. Each rope links two parts, but every pair of parts is linked by at most one rope. To split the toy, the child must remove all its parts. The child can remove a single part at a time, and each remove consume an energy. Let\'s define an energy value of part i as vi. The child spend vf1\xe2\x80\x89+\xe2\x80\x89vf2\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89vfk energy for removing part i where f1,\xe2\x80\x89f2,\xe2\x80\x89...,\xe2\x80\x89fk are the parts that are directly connected to the i-th and haven\'t been removed.Help the child to find out, what is the minimum total energy he should spend to remove all n parts." 1400

437B "The Child and Set" bitmasks,greedy,implementation,sortings "At the children\'s day, the child came to Picks\'s house, and messed his house up. Picks was angry at him. A lot of important things were lost, in particular the favorite set of Picks.Fortunately, Picks remembers something about his set S:  its elements were distinct integers from 1 to limit;  the value of  was equal to sum; here lowbit(x) equals 2k where k is the position of the first one in the binary representation of x. For example, lowbit(100102)\xe2\x80\x89=\xe2\x80\x89102,\xe2\x80\x89lowbit(100012)\xe2\x80\x89=\xe2\x80\x8912,\xe2\x80\x89lowbit(100002)\xe2\x80\x89=\xe2\x80\x89100002 (binary representation). Can you help Picks and find any set S, that satisfies all the above conditions?" 1500

437A "The Child and Homework" implementation "Once upon a time a child got a test consisting of multiple-choice questions as homework. A multiple-choice question consists of four choices: A, B, C and D. Each choice has a description, and the child should find out the only one that is correct.Fortunately the child knows how to solve such complicated test. The child will follow the algorithm:  If there is some choice whose description at least twice shorter than all other descriptions, or at least twice longer than all other descriptions, then the child thinks the choice is great.  If there is exactly one great choice then the child chooses it. Otherwise the child chooses C (the child think it is the luckiest choice). You are given a multiple-choice questions, can you predict child\'s choose?" 1300

436F Banners "brute force,data structures,dp" "All modern mobile applications are divided into free and paid. Even a single application developers often release two versions: a paid version without ads and a free version with ads.  Suppose that a paid version of the app costs p (p is an integer) rubles, and the free version of the application contains c ad banners. Each user can be described by two integers: ai \xe2\x80\x94 the number of rubles this user is willing to pay for the paid version of the application, and bi \xe2\x80\x94 the number of banners he is willing to tolerate in the free version.The behavior of each member shall be considered strictly deterministic:  if for user i, value bi is at least c, then he uses the free version,  otherwise, if value ai is at least p, then he buys the paid version without advertising,  otherwise the user simply does not use the application. Each user of the free version brings the profit of c\xe2\x80\x89\xc3\x97\xe2\x80\x89w rubles. Each user of the paid version brings the profit of p rubles.Your task is to help the application developers to select the optimal parameters p and c. Namely, knowing all the characteristics of users, for each value of c from 0 to (max�bi)\xe2\x80\x89+\xe2\x80\x891 you need to determine the maximum profit from the application and the corresponding parameter p." 3000

436E "Cardboard Box" "data structures,greedy" "Everyone who has played Cut the Rope knows full well how the gameplay is organized. All levels in the game are divided into boxes. Initially only one box with some levels is available. Player should complete levels to earn stars, collecting stars opens new box with levels.  Imagine that you are playing Cut the Rope for the first time. Currently you have only the levels of the first box (by the way, it is called ""Cardboard Box""). Each level is characterized by two integers: ai \xe2\x80\x94 how long it takes to complete the level for one star, bi \xe2\x80\x94 how long it takes to complete the level for two stars (ai\xe2\x80\x89<\xe2\x80\x89bi).You want to open the next box as quickly as possible. So, you need to earn at least w stars. How do make it happen? Note that the level can be passed only once: either for one star or for two. You do not necessarily need to pass all the levels." 2600

436D "Pudding Monsters" dp "Have you ever played Pudding Monsters? In this task, a simplified one-dimensional model of this game is used.  Imagine an infinite checkered stripe, the cells of which are numbered sequentially with integers. Some cells of the strip have monsters, other cells of the strip are empty. All monsters are made of pudding, so if there are two monsters in the neighboring cells, they stick to each other (literally). Similarly, if several monsters are on consecutive cells, they all stick together in one block of monsters. We will call the stuck together monsters a block of monsters. A detached monster, not stuck to anyone else, is also considered a block.In one move, the player can take any block of monsters and with a movement of his hand throw it to the left or to the right. The selected monsters will slide on until they hit some other monster (or a block of monsters).For example, if a strip has three monsters in cells 1, 4 and 5, then there are only four possible moves: to send a monster in cell 1 to minus infinity, send the block of monsters in cells 4 and 5 to plus infinity, throw monster 1 to the right (it will stop in cell 3), throw a block of monsters in cells 4 and 5 to the left (they will stop in cells 2 and 3).Some cells on the strip are marked with stars. These are the special cells. The goal of the game is to make the largest possible number of special cells have monsters on them.You are given the numbers of the special cells on a strip as well as the initial position of all monsters. What is the maximum number of special cells that will contain monsters in the optimal game?" 2800

436C "Dungeons and Candies" dsu,graphs,greedy,trees "During the loading of the game ""Dungeons and Candies"" you are required to get descriptions of k levels from the server. Each description is a map of an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m checkered rectangular field. Some cells of the field contain candies (each cell has at most one candy). An empty cell is denoted as ""."" on the map, but if a cell has a candy, it is denoted as a letter of the English alphabet. A level may contain identical candies, in this case the letters in the corresponding cells of the map will be the same.  When you transmit information via a network, you want to minimize traffic \xe2\x80\x94 the total size of the transferred data. The levels can be transmitted in any order. There are two ways to transmit the current level A:  You can transmit the whole level A. Then you need to transmit n\xc2\xb7m bytes via the network.  You can transmit the difference between level A and some previously transmitted level B (if it exists); this operation requires to transmit dA,\xe2\x80\x89B\xc2\xb7w bytes, where dA,\xe2\x80\x89B is the number of cells of the field that are different for A and B, and w is a constant. Note, that you should compare only the corresponding cells of levels A and B to calculate dA,\xe2\x80\x89B. You cannot transform the maps of levels, i.e. rotate or shift them relatively to each other. Your task is to find a way to transfer all the k levels and minimize the traffic." 1800

436B "Om Nom and Spiders" implementation,math "Om Nom really likes candies and doesn\'t like spiders as they frequently steal candies. One day Om Nom fancied a walk in a park. Unfortunately, the park has some spiders and Om Nom doesn\'t want to see them at all.  The park can be represented as a rectangular n\xe2\x80\x89\xc3\x97\xe2\x80\x89m field. The park has k spiders, each spider at time 0 is at some cell of the field. The spiders move all the time, and each spider always moves in one of the four directions (left, right, down, up). In a unit of time, a spider crawls from his cell to the side-adjacent cell in the corresponding direction. If there is no cell in the given direction, then the spider leaves the park. The spiders do not interfere with each other as they move. Specifically, one cell can have multiple spiders at the same time.Om Nom isn\'t yet sure where to start his walk from but he definitely wants:  to start walking at time 0 at an upper row cell of the field (it is guaranteed that the cells in this row do not contain any spiders);  to walk by moving down the field towards the lowest row (the walk ends when Om Nom leaves the boundaries of the park). We know that Om Nom moves by jumping. One jump takes one time unit and transports the little monster from his cell to either a side-adjacent cell on the lower row or outside the park boundaries.Each time Om Nom lands in a cell he sees all the spiders that have come to that cell at this moment of time. Om Nom wants to choose the optimal cell to start the walk from. That\'s why he wonders: for each possible starting cell, how many spiders will he see during the walk if he starts from this cell? Help him and calculate the required value for each possible starting cell." 1400

436A "Feed with Candy" greedy "The hero of the Cut the Rope game is a little monster named Om Nom. He loves candies. And what a coincidence! He also is the hero of today\'s problem.  One day, Om Nom visited his friend Evan. Evan has n candies of two types (fruit drops and caramel drops), the i-th candy hangs at the height of hi centimeters above the floor of the house, its mass is mi. Om Nom wants to eat as many candies as possible. At the beginning Om Nom can make at most x centimeter high jumps. When Om Nom eats a candy of mass y, he gets stronger and the height of his jump increases by y centimeters.What maximum number of candies can Om Nom eat if he never eats two candies of the same type in a row (Om Nom finds it too boring)?" 1500

435E "Special Graph" NA "In this problem you will need to deal with an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m grid graph. The graph\'s vertices are the nodes of the n\xe2\x80\x89\xc3\x97\xe2\x80\x89m grid. The graph\'s edges are all the sides and diagonals of the grid\'s unit squares.The figure below shows a 3\xe2\x80\x89\xc3\x97\xe2\x80\x895 graph. The black lines are the graph\'s edges, the colored circles are the graph\'s vertices. The vertices of the graph are painted on the picture for a reason: the coloring is a correct vertex coloring of the 3\xe2\x80\x89\xc3\x97\xe2\x80\x895 graph into four colors. A graph coloring is correct if and only if each vertex is painted and no two vertices connected by an edge are painted the same color.  You are given the size of the grid graph n\xe2\x80\x89\xc3\x97\xe2\x80\x89m and the colors of some of its vertices. Find any way how to paint the unpainted vertices of the graph in 4 colors to make the final coloring a correct vertex graph coloring. If there is no such correct vertex coloring, say that the answer doesn\'t exist." 2500

435D "Special Grid" "brute force,dp,greedy" "You are given an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m grid, some of its nodes are black, the others are white. Moreover, it\'s not an ordinary grid \xe2\x80\x94 each unit square of the grid has painted diagonals.The figure below is an example of such grid of size 3\xe2\x80\x89\xc3\x97\xe2\x80\x895. Four nodes of this grid are black, the other 11 nodes are white.  Your task is to count the number of such triangles on the given grid that:  the corners match the white nodes, and the area is positive;  all sides go along the grid lines (horizontal, vertical or diagonal);  no side contains black nodes." 2000

435C Cardiogram implementation "In this problem, your task is to use ASCII graphics to paint a cardiogram. A cardiogram is a polyline with the following corners:That is, a cardiogram is fully defined by a sequence of positive integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an.Your task is to paint a cardiogram by given sequence ai." 1600

435B "Pasha Maximizes" greedy "Pasha has a positive integer a without leading zeroes. Today he decided that the number is too small and he should make it larger. Unfortunately, the only operation Pasha can do is to swap two adjacent decimal digits of the integer.Help Pasha count the maximum number he can get if he has the time to make at most k swaps." 1400

435A "Queue on Bus Stop" implementation "It\'s that time of the year when the Russians flood their countryside summer cottages (dachas) and the bus stop has a lot of people. People rarely go to the dacha on their own, it\'s usually a group, so the people stand in queue by groups.The bus stop queue has n groups of people. The i-th group from the beginning has ai people. Every 30 minutes an empty bus arrives at the bus stop, it can carry at most m people. Naturally, the people from the first group enter the bus first. Then go the people from the second group and so on. Note that the order of groups in the queue never changes. Moreover, if some group cannot fit all of its members into the current bus, it waits for the next bus together with other groups standing after it in the queue.Your task is to determine how many buses is needed to transport all n groups to the dacha countryside." 1000

434E "Furukawa Nagisa\'s Tree" "binary search,divide and conquer,sortings,trees" "It\'s that time of the year when the Russians flood their countryside summer cottages (dachas) and the bus stop has a lot of people. People rarely go to the dacha on their own, it\'s usually a group, so the people stand in queue by groups.The bus stop queue has n groups of people. The i-th group from the beginning has ai people. Every 30 minutes an empty bus arrives at the bus stop, it can carry at most m people. Naturally, the people from the first group enter the bus first. Then go the people from the second group and so on. Note that the order of groups in the queue never changes. Moreover, if some group cannot fit all of its members into the current bus, it waits for the next bus together with other groups standing after it in the queue.Your task is to determine how many buses is needed to transport all n groups to the dacha countryside." 3000

434D "Nanami\'s Power Plant" flows "It\'s that time of the year when the Russians flood their countryside summer cottages (dachas) and the bus stop has a lot of people. People rarely go to the dacha on their own, it\'s usually a group, so the people stand in queue by groups.The bus stop queue has n groups of people. The i-th group from the beginning has ai people. Every 30 minutes an empty bus arrives at the bus stop, it can carry at most m people. Naturally, the people from the first group enter the bus first. Then go the people from the second group and so on. Note that the order of groups in the queue never changes. Moreover, if some group cannot fit all of its members into the current bus, it waits for the next bus together with other groups standing after it in the queue.Your task is to determine how many buses is needed to transport all n groups to the dacha countryside." 2900

433E "Tachibana Kanade\'s Tofu" dp "It\'s that time of the year when the Russians flood their countryside summer cottages (dachas) and the bus stop has a lot of people. People rarely go to the dacha on their own, it\'s usually a group, so the people stand in queue by groups.The bus stop queue has n groups of people. The i-th group from the beginning has ai people. Every 30 minutes an empty bus arrives at the bus stop, it can carry at most m people. Naturally, the people from the first group enter the bus first. Then go the people from the second group and so on. Note that the order of groups in the queue never changes. Moreover, if some group cannot fit all of its members into the current bus, it waits for the next bus together with other groups standing after it in the queue.Your task is to determine how many buses is needed to transport all n groups to the dacha countryside." 2500

433D "Nanami\'s Digital Board" dsu,implementation "It\'s that time of the year when the Russians flood their countryside summer cottages (dachas) and the bus stop has a lot of people. People rarely go to the dacha on their own, it\'s usually a group, so the people stand in queue by groups.The bus stop queue has n groups of people. The i-th group from the beginning has ai people. Every 30 minutes an empty bus arrives at the bus stop, it can carry at most m people. Naturally, the people from the first group enter the bus first. Then go the people from the second group and so on. Note that the order of groups in the queue never changes. Moreover, if some group cannot fit all of its members into the current bus, it waits for the next bus together with other groups standing after it in the queue.Your task is to determine how many buses is needed to transport all n groups to the dacha countryside." 2000

433C "Ryouko\'s Memory Note" implementation,math,sortings "It\'s that time of the year when the Russians flood their countryside summer cottages (dachas) and the bus stop has a lot of people. People rarely go to the dacha on their own, it\'s usually a group, so the people stand in queue by groups.The bus stop queue has n groups of people. The i-th group from the beginning has ai people. Every 30 minutes an empty bus arrives at the bus stop, it can carry at most m people. Naturally, the people from the first group enter the bus first. Then go the people from the second group and so on. Note that the order of groups in the queue never changes. Moreover, if some group cannot fit all of its members into the current bus, it waits for the next bus together with other groups standing after it in the queue.Your task is to determine how many buses is needed to transport all n groups to the dacha countryside." 1800

433B "Kuriyama Mirai\'s Stones" dp,implementation,sortings "It\'s that time of the year when the Russians flood their countryside summer cottages (dachas) and the bus stop has a lot of people. People rarely go to the dacha on their own, it\'s usually a group, so the people stand in queue by groups.The bus stop queue has n groups of people. The i-th group from the beginning has ai people. Every 30 minutes an empty bus arrives at the bus stop, it can carry at most m people. Naturally, the people from the first group enter the bus first. Then go the people from the second group and so on. Note that the order of groups in the queue never changes. Moreover, if some group cannot fit all of its members into the current bus, it waits for the next bus together with other groups standing after it in the queue.Your task is to determine how many buses is needed to transport all n groups to the dacha countryside." 1200

433A "Kitahara Haruki\'s Gift" "brute force,implementation" "It\'s that time of the year when the Russians flood their countryside summer cottages (dachas) and the bus stop has a lot of people. People rarely go to the dacha on their own, it\'s usually a group, so the people stand in queue by groups.The bus stop queue has n groups of people. The i-th group from the beginning has ai people. Every 30 minutes an empty bus arrives at the bus stop, it can carry at most m people. Naturally, the people from the first group enter the bus first. Then go the people from the second group and so on. Note that the order of groups in the queue never changes. Moreover, if some group cannot fit all of its members into the current bus, it waits for the next bus together with other groups standing after it in the queue.Your task is to determine how many buses is needed to transport all n groups to the dacha countryside." 1100

432E "Square Tiling" "constructive algorithms,greedy" "You have an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m rectangle table, its cells are not initially painted. Your task is to paint all cells of the table. The resulting picture should be a tiling of the table with squares. More formally:  each cell must be painted some color (the colors are marked by uppercase Latin letters);  we will assume that two cells of the table are connected if they are of the same color and share a side; each connected region of the table must form a square. Given n and m, find lexicographically minimum coloring of the table that meets the described properties." 2300

432D "Prefixes and Suffixes" "dp,string suffix structures,strings,two pointers" "You have a string s\xe2\x80\x89=\xe2\x80\x89s1s2...s|s|, where |s| is the length of string s, and si its i-th character. Let\'s introduce several definitions:  A substring s[i..j] (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|s|) of string s is string sisi\xe2\x80\x89+\xe2\x80\x891...sj.  The prefix of string s of length l (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|s|) is string s[1..l].  The suffix of string s of length l (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|s|) is string s[|s|\xe2\x80\x89-\xe2\x80\x89l\xe2\x80\x89+\xe2\x80\x891..|s|]. Your task is, for any prefix of string s which matches a suffix of string s, print the number of times it occurs in string s as a substring." 2000

432C "Prime Swaps" greedy,sortings "You have an array a[1],\xe2\x80\x89a[2],\xe2\x80\x89...,\xe2\x80\x89a[n], containing distinct integers from 1 to n. Your task is to sort this array in increasing order with the following operation (you may need to apply it multiple times):  choose two indexes, i and j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n; (j\xe2\x80\x89-\xe2\x80\x89i\xe2\x80\x89+\xe2\x80\x891) is a prime number);  swap the elements on positions i and j; in other words, you are allowed to apply the following sequence of assignments: tmp\xe2\x80\x89=\xe2\x80\x89a[i],\xe2\x80\x89a[i]\xe2\x80\x89=\xe2\x80\x89a[j],\xe2\x80\x89a[j]\xe2\x80\x89=\xe2\x80\x89tmp (tmp is a temporary variable). You do not need to minimize the number of used operations. However, you need to make sure that there are at most 5n operations." 1800

432B "Football Kit" "brute force,greedy,implementation" "Consider a football tournament where n teams participate. Each team has two football kits: for home games, and for away games. The kit for home games of the i-th team has color xi and the kit for away games of this team has color yi (xi\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89yi).In the tournament, each team plays exactly one home game and exactly one away game with each other team (n(n\xe2\x80\x89-\xe2\x80\x891) games in total). The team, that plays the home game, traditionally plays in its home kit. The team that plays an away game plays in its away kit. However, if two teams has the kits of the same color, they cannot be distinguished. In this case the away team plays in its home kit.Calculate how many games in the described tournament each team plays in its home kit and how many games it plays in its away kit." 1200

432A "Choosing Teams" greedy,implementation,sortings "The Saratov State University Olympiad Programmers Training Center (SSU OPTC) has n students. For each student you know the number of times he/she has participated in the ACM ICPC world programming championship. According to the ACM ICPC rules, each person can participate in the world championship at most 5 times.The head of the SSU OPTC is recently gathering teams to participate in the world championship. Each team must consist of exactly three people, at that, any person cannot be a member of two or more teams. What maximum number of teams can the head make if he wants each team to participate in the world championship with the same members at least k times?" 800

431E "Chemistry Experiment" "binary search,data structures,ternary search" "One day two students, Grisha and Diana, found themselves in the university chemistry lab. In the lab the students found n test tubes with mercury numbered from 1 to n and decided to conduct an experiment.The experiment consists of q steps. On each step, one of the following actions occurs:  Diana pours all the contents from tube number pi and then pours there exactly xi liters of mercury.  Let\'s consider all the ways to add vi liters of water into the tubes; for each way let\'s count the volume of liquid (water and mercury) in the tube with water with maximum amount of liquid; finally let\'s find the minimum among counted maximums. That is the number the students want to count. At that, the students don\'t actually pour the mercury. They perform calculations without changing the contents of the tubes. Unfortunately, the calculations proved to be too complex and the students asked you to help them. Help them conduct the described experiment." 2200

431D "Random Task" "binary search,bitmasks,combinatorics,dp,math" "One day, after a difficult lecture a diligent student Sasha saw a graffitied desk in the classroom. She came closer and read: ""Find such positive integer n, that among numbers n\xe2\x80\x89+\xe2\x80\x891, n\xe2\x80\x89+\xe2\x80\x892, ..., 2\xc2\xb7n there are exactly m numbers which binary representation contains exactly k digits one"".The girl got interested in the task and she asked you to help her solve it. Sasha knows that you are afraid of large numbers, so she guaranteed that there is an answer that doesn\'t exceed 1018." 2100

431C k-Tree dp,implementation,trees "Quite recently a creative student Lesha had a lecture on trees. After the lecture Lesha was inspired and came up with the tree of his own which he called a k-tree.A k-tree is an infinite rooted tree where:  each vertex has exactly k children;  each edge has some weight;  if we look at the edges that goes from some vertex to its children (exactly k edges), then their weights will equal 1,\xe2\x80\x892,\xe2\x80\x893,\xe2\x80\x89...,\xe2\x80\x89k. The picture below shows a part of a 3-tree.      As soon as Dima, a good friend of Lesha, found out about the tree, he immediately wondered: ""How many paths of total weight n (the sum of all weights of the edges in the path) are there, starting from the root of a k-tree and also containing at least one edge of weight at least d?"".Help Dima find an answer to his question. As the number of ways can be rather large, print it modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." 1600

431B "Shower Line" "brute force,implementation" "Many students live in a dormitory. A dormitory is a whole new world of funny amusements and possibilities but it does have its drawbacks. There is only one shower and there are multiple students who wish to have a shower in the morning. That\'s why every morning there is a line of five people in front of the dormitory shower door. As soon as the shower opens, the first person from the line enters the shower. After a while the first person leaves the shower and the next person enters the shower. The process continues until everybody in the line has a shower.Having a shower takes some time, so the students in the line talk as they wait. At each moment of time the students talk in pairs: the (2i\xe2\x80\x89-\xe2\x80\x891)-th man in the line (for the current moment) talks with the (2i)-th one. Let\'s look at this process in more detail. Let\'s number the people from 1 to 5. Let\'s assume that the line initially looks as 23154 (person number 2 stands at the beginning of the line). Then, before the shower opens, 2 talks with 3, 1 talks with 5, 4 doesn\'t talk with anyone. Then 2 enters the shower. While 2 has a shower, 3 and 1 talk, 5 and 4 talk too. Then, 3 enters the shower. While 3 has a shower, 1 and 5 talk, 4 doesn\'t talk to anyone. Then 1 enters the shower and while he is there, 5 and 4 talk. Then 5 enters the shower, and then 4 enters the shower.We know that if students i and j talk, then the i-th student\'s happiness increases by gij and the j-th student\'s happiness increases by gji. Your task is to find such initial order of students in the line that the total happiness of all students will be maximum in the end. Please note that some pair of students may have a talk several times. In the example above students 1 and 5 talk while they wait for the shower to open and while 3 has a shower." 1200

431A "Black Square" implementation "Quite recently, a very smart student named Jury decided that lectures are boring, so he downloaded a game called ""Black Square"" on his super cool touchscreen phone.In this game, the phone\'s screen is divided into four vertical strips. Each second, a black square appears on some of the strips. According to the rules of the game, Jury must use this second to touch the corresponding strip to make the square go away. As Jury is both smart and lazy, he counted that he wastes exactly ai calories on touching the i-th strip.You\'ve got a string s, describing the process of the game and numbers a1,\xe2\x80\x89a2,\xe2\x80\x89a3,\xe2\x80\x89a4. Calculate how many calories Jury needs to destroy all the squares?" 800

430B "Balls Game" "brute force,two pointers" "Iahub is training for the IOI. What is a better way to train than playing a Zuma-like game? There are n balls put in a row. Each ball is colored in one of k colors. Initially the row doesn\'t contain three or more contiguous balls with the same color. Iahub has a single ball of color x. He can insert his ball at any position in the row (probably, between two other balls). If at any moment there are three or more contiguous balls of the same color in the row, they are destroyed immediately. This rule is applied multiple times, until there are no more sets of 3 or more contiguous balls of the same color. For example, if Iahub has the row of balls [black, black, white, white, black, black] and a white ball, he can insert the ball between two white balls. Thus three white balls are destroyed, and then four black balls become contiguous, so all four balls are destroyed. The row will not contain any ball in the end, so Iahub can destroy all 6 balls.Iahub wants to destroy as many balls as possible. You are given the description of the row of balls, and the color of Iahub\'s ball. Help Iahub train for the IOI by telling him the maximum number of balls from the row he can destroy." 1400

430A "Points and Segments (easy)" "constructive algorithms,sortings" "Iahub isn\'t well prepared on geometry problems, but he heard that this year there will be a lot of geometry problems on the IOI selection camp. Scared, Iahub locked himself in the basement and started thinking of new problems of this kind. One of them is the following.Iahub wants to draw n distinct points and m segments on the OX axis. He can draw each point with either red or blue. The drawing is good if and only if the following requirement is met: for each segment [li,\xe2\x80\x89ri] consider all the red points belong to it (ri points), and all the blue points belong to it (bi points); each segment i should satisfy the inequality |ri\xe2\x80\x89-\xe2\x80\x89bi|\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x891.Iahub thinks that point x belongs to segment [l,\xe2\x80\x89r], if inequality l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r holds.Iahub gives to you all coordinates of points and segments. Please, help him to find any good drawing." 1600

429E "Points and Segments" graphs "Iahub isn\'t well prepared on geometry problems, but he heard that this year there will be a lot of geometry problems on the IOI selection camp. Scared, Iahub locked himself in the basement and started thinking of new problems of this kind. One of them is the following.Iahub wants to draw n distinct segments [li,\xe2\x80\x89ri] on the OX axis. He can draw each segment with either red or blue. The drawing is good if and only if the following requirement is met: for each point x of the OX axis consider all the segments that contains point x; suppose, that rx red segments and bx blue segments contain point x; for each point x inequality |rx\xe2\x80\x89-\xe2\x80\x89bx|\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x891 must be satisfied.A segment [l,\xe2\x80\x89r] contains a point x if and only if l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r.Iahub gives you the starting and ending points of all the segments. You have to find any good drawing for him." 3000

429D "Tricky Function" "data structures,divide and conquer,geometry" "Iahub and Sorin are the best competitive programmers in their town. However, they can\'t both qualify to an important contest. The selection will be made with the help of a single problem. Blatnatalag, a friend of Iahub, managed to get hold of the problem before the contest. Because he wants to make sure Iahub will be the one qualified, he tells Iahub the following task.You\'re given an (1-based) array a with n elements. Let\'s define function f(i,\xe2\x80\x89j) (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i,\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) as (i\xe2\x80\x89-\xe2\x80\x89j)2\xe2\x80\x89+\xe2\x80\x89g(i,\xe2\x80\x89j)2. Function g is calculated by the following pseudo-code:int g(int i, int j) {    int sum = 0;    for (int k = min(i, j) + 1; k <= max(i, j); k = k + 1)        sum = sum + a[k];    return sum;}Find a value mini\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89j��f(i,\xe2\x80\x89j).Probably by now Iahub already figured out the solution to this problem. Can you?" 2200

429C "Guess the Tree" "bitmasks,constructive algorithms,dp,greedy,trees" "Iahub and Iahubina went to a picnic in a forest full of trees. Less than 5 minutes passed before Iahub remembered of trees from programming. Moreover, he invented a new problem and Iahubina has to solve it, otherwise Iahub won\'t give her the food. Iahub asks Iahubina: can you build a rooted tree, such that  each internal node (a node with at least one son) has at least two sons;  node i has ci nodes in its subtree? Iahubina has to guess the tree. Being a smart girl, she realized that it\'s possible no tree can follow Iahub\'s restrictions. In this way, Iahub will eat all the food. You need to help Iahubina: determine if there\'s at least one tree following Iahub\'s restrictions. The required tree must contain n nodes." 2300

429B "Working out" dp "Summer is coming! It\'s time for Iahub and Iahubina to work out, as they both want to look hot at the beach. The gym where they go is a matrix a with n lines and m columns. Let number a[i][j] represents the calories burned by performing workout at the cell of gym in the i-th line and the j-th column.Iahub starts with workout located at line 1 and column 1. He needs to finish with workout a[n][m]. After finishing workout a[i][j], he can go to workout a[i\xe2\x80\x89+\xe2\x80\x891][j] or a[i][j\xe2\x80\x89+\xe2\x80\x891]. Similarly, Iahubina starts with workout a[n][1] and she needs to finish with workout a[1][m]. After finishing workout from cell a[i][j], she goes to either a[i][j\xe2\x80\x89+\xe2\x80\x891] or a[i\xe2\x80\x89-\xe2\x80\x891][j]. There is one additional condition for their training. They have to meet in exactly one cell of gym. At that cell, none of them will work out. They will talk about fast exponentiation (pretty odd small talk) and then both of them will move to the next workout.If a workout was done by either Iahub or Iahubina, it counts as total gain. Please plan a workout for Iahub and Iahubina such as total gain to be as big as possible. Note, that Iahub and Iahubina can perform workouts with different speed, so the number of cells that they use to reach meet cell may differs." 1600

429A Xor-tree "dfs and similar,trees" "Iahub is very proud of his recent discovery, propagating trees. Right now, he invented a new tree, called xor-tree. After this new revolutionary discovery, he invented a game for kids which uses xor-trees.The game is played on a tree having n nodes, numbered from 1 to n. Each node i has an initial value initi, which is either 0 or 1. The root of the tree is node 1.One can perform several (possibly, zero) operations on the tree during the game. The only available type of operation is to pick a node x. Right after someone has picked node x, the value of node x flips, the values of sons of x remain the same, the values of sons of sons of x flips, the values of sons of sons of sons of x remain the same and so on.The goal of the game is to get each node i to have value goali, which can also be only 0 or 1. You need to reach the goal of the game by using minimum number of operations." 1300

427E "Police Patrol" "greedy,implementation,math,ternary search" "Imagine that your city is an infinite 2D plane with Cartesian coordinate system. The only crime-affected road of your city is the x-axis. Currently, there are n criminals along the road. No police station has been built on this road yet, so the mayor wants to build one.As you are going to be in charge of this new police station, the mayor has asked you to choose a suitable position (some integer point) for building it. You should choose the best position for the police station, so that you could minimize the total time of your criminal catching mission. Your mission of catching the criminals will operate only from this station. The new station will have only one patrol car. You will go to the criminals by this car, carry them on the car, bring them back to the police station and put them in prison. The patrol car can carry at most m criminals at a time. Note that, the criminals don\'t know about your mission. So, they will stay where they are instead of running away.Your task is to find the position for the police station, so that total distance you need to cover to catch all the criminals will be minimum possible. Note that, you also can built the police station on the positions where one or more criminals already exist. In such a case all these criminals are arrested instantly." 2000

427D "Match & Catch" "dp,string suffix structures,strings" "Police headquarter is monitoring signal on different frequency levels. They have got two suspiciously encoded strings s1 and s2 from two different frequencies as signals. They are suspecting that these two strings are from two different criminals and they are planning to do some evil task.Now they are trying to find a common substring of minimum length between these two strings. The substring must occur only once in the first string, and also it must occur only once in the second string.Given two strings s1 and s2 consist of lowercase Latin letters, find the smallest (by length) common substring p of both s1 and s2, where p is a unique substring in s1 and also in s2. See notes for formal definition of substring and uniqueness." 2200

427C Checkposts "dfs and similar,graphs,two pointers" "Your city has n junctions. There are m one-way roads between the junctions. As a mayor of the city, you have to ensure the security of all the junctions.To ensure the security, you have to build some police checkposts. Checkposts can only be built in a junction. A checkpost at junction i can protect junction j if either i\xe2\x80\x89=\xe2\x80\x89j or the police patrol car can go to j from i and then come back to i.Building checkposts costs some money. As some areas of the city are more expensive than others, building checkpost at some junctions might cost more money than other junctions.You have to determine the minimum possible money needed to ensure the security of all the junctions. Also you have to find the number of ways to ensure the security in minimum price and in addition in minimum number of checkposts. Two ways are different if any of the junctions contains a checkpost in one of them and do not contain in the other." 1700

427B "Prison Transfer" "data structures,implementation" "The prison of your city has n prisoners. As the prison can\'t accommodate all of them, the city mayor has decided to transfer c of the prisoners to a prison located in another city.For this reason, he made the n prisoners to stand in a line, with a number written on their chests. The number is the severity of the crime he/she has committed. The greater the number, the more severe his/her crime was.Then, the mayor told you to choose the c prisoners, who will be transferred to the other prison. He also imposed two conditions. They are,  The chosen c prisoners has to form a contiguous segment of prisoners.  Any of the chosen prisoner\'s crime level should not be greater then t. Because, that will make the prisoner a severe criminal and the mayor doesn\'t want to take the risk of his running away during the transfer. Find the number of ways you can choose the c prisoners." 1100

427A "Police Recruits" implementation "The police department of your city has just started its journey. Initially, they don\xe2\x80\x99t have any manpower. So, they started hiring new recruits in groups.Meanwhile, crimes keeps occurring within the city. One member of the police force can investigate only one crime during his/her lifetime.If there is no police officer free (isn\'t busy with crime) during the occurrence of a crime, it will go untreated.Given the chronological order of crime occurrences and recruit hirings, find the number of crimes which will go untreated." 800

426B "Sereja and Mirroring" implementation "Let\'s assume that we are given a matrix b of size x\xe2\x80\x89\xc3\x97\xe2\x80\x89y, let\'s determine the operation of mirroring matrix b. The mirroring of matrix b is a 2x\xe2\x80\x89\xc3\x97\xe2\x80\x89y matrix c which has the following properties:  the upper half of matrix c (rows with numbers from 1 to x) exactly matches b;  the lower half of matrix c (rows with numbers from x\xe2\x80\x89+\xe2\x80\x891 to 2x) is symmetric to the upper one; the symmetry line is the line that separates two halves (the line that goes in the middle, between rows x and x\xe2\x80\x89+\xe2\x80\x891). Sereja has an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m matrix a. He wants to find such matrix b, that it can be transformed into matrix a, if we\'ll perform on it several (possibly zero) mirrorings. What minimum number of rows can such matrix contain?" 1300

426A "Sereja and Mugs" implementation "Sereja showed an interesting game to his friends. The game goes like that. Initially, there is a table with an empty cup and n water mugs on it. Then all players take turns to move. During a move, a player takes a non-empty mug of water and pours all water from it into the cup. If the cup overfills, then we assume that this player lost.As soon as Sereja\'s friends heard of the game, they wanted to play it. Sereja, on the other hand, wanted to find out whether his friends can play the game in such a way that there are no losers. You are given the volumes of all mugs and the cup. Also, you know that Sereja has (n\xe2\x80\x89-\xe2\x80\x891) friends. Determine if Sereja\'s friends can play the game so that nobody loses." 800

425E "Sereja and Sets" dp "Let\'s assume that set S consists of m distinct intervals [l1,\xe2\x80\x89r1], [l2,\xe2\x80\x89r2], ..., [lm,\xe2\x80\x89rm] (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89li\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ri\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n; li,\xe2\x80\x89ri are integers).Let\'s assume that f(S) is the maximum number of intervals that you can choose from the set S, such that every two of them do not intersect. We assume that two intervals, [l1,\xe2\x80\x89r1] and [l2,\xe2\x80\x89r2], intersect if there is an integer x, which meets two inequalities: l1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r1 and l2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r2.Sereja wonders, how many sets S are there, such that f(S)\xe2\x80\x89=\xe2\x80\x89k? Count this number modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." 2500

425D "Sereja and Squares" "binary search,data structures,hashing" "Sereja has painted n distinct points on the plane. The coordinates of each point are integers. Now he is wondering: how many squares are there with sides parallel to the coordinate axes and with points painted in all its four vertexes? Help him, calculate this number." 2300

425C "Sereja and Two Sequences" "data structures,dp" "Sereja has two sequences a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an and b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bm, consisting of integers. One day Sereja got bored and he decided two play with them. The rules of the game was very simple. Sereja makes several moves, in one move he can perform one of the following actions:  Choose several (at least one) first elements of sequence a (non-empty prefix of a), choose several (at least one) first elements of sequence b (non-empty prefix of b); the element of sequence a with the maximum index among the chosen ones must be equal to the element of sequence b with the maximum index among the chosen ones; remove the chosen elements from the sequences.  Remove all elements of both sequences. The first action is worth e energy units and adds one dollar to Sereja\'s electronic account. The second action is worth the number of energy units equal to the number of elements Sereja removed from the sequences before performing this action. After Sereja performed the second action, he gets all the money that he earned on his electronic account during the game.Initially Sereja has s energy units and no money on his account. What maximum number of money can Sereja get? Note, the amount of Seraja\'s energy mustn\'t be negative at any time moment." 2300

425B "Sereja and Table" bitmasks,greedy "Sereja has an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m rectangular table a, each cell of the table contains a zero or a number one. Sereja wants his table to meet the following requirement: each connected component of the same values forms a rectangle with sides parallel to the sides of the table. Rectangles should be filled with cells, that is, if a component form a rectangle of size h\xe2\x80\x89\xc3\x97\xe2\x80\x89w, then the component must contain exactly hw cells.A connected component of the same values is a set of cells of the table that meet the following conditions:  every two cells of the set have the same value;  the cells of the set form a connected region on the table (two cells are connected if they are adjacent in some row or some column of the table);  it is impossible to add any cell to the set unless we violate the two previous conditions. Can Sereja change the values of at most k cells of the table so that the table met the described requirement? What minimum number of table cells should he change in this case?" 2200

425A "Sereja and Swaps" "brute force,sortings" "As usual, Sereja has array a, its elements are integers: a[1],\xe2\x80\x89a[2],\xe2\x80\x89...,\xe2\x80\x89a[n]. Let\'s introduce notation:A swap operation is the following sequence of actions:  choose two indexes i,\xe2\x80\x89j (i\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89j);  perform assignments tmp\xe2\x80\x89=\xe2\x80\x89a[i],\xe2\x80\x89a[i]\xe2\x80\x89=\xe2\x80\x89a[j],\xe2\x80\x89a[j]\xe2\x80\x89=\xe2\x80\x89tmp. What maximum value of function m(a) can Sereja get if he is allowed to perform at most k swap operations?" 1500

424E "Colored Jenga" "dfs and similar,dp,probabilities" "Cold winter evenings in Tomsk are very boring \xe2\x80\x94 nobody wants be on the streets at such a time. Residents of Tomsk while away the time sitting in warm apartments, inventing a lot of different games. One of such games is \'Colored Jenga\'.This game requires wooden blocks of three colors: red, green and blue. A tower of n levels is made from them. Each level consists of three wooden blocks. The blocks in each level can be of arbitrary colors, but they are always located close and parallel to each other. An example of such a tower is shown in the figure.  The game is played by exactly one person. Every minute a player throws a special dice which has six sides. Two sides of the dice are green, two are blue, one is red and one is black. The dice shows each side equiprobably.If the dice shows red, green or blue, the player must take any block of this color out of the tower at this minute so that the tower doesn\'t fall. If this is not possible, the player waits until the end of the minute, without touching the tower. He also has to wait until the end of the minute without touching the tower if the dice shows the black side. It is not allowed to take blocks from the top level of the tower (whether it is completed or not).Once a player got a block out, he must put it on the top of the tower so as to form a new level or finish the upper level consisting of previously placed blocks. The newly constructed levels should have all the same properties as the initial levels. If the upper level is not completed, starting the new level is prohibited.For the tower not to fall, in each of the levels except for the top, there should be at least one block. Moreover, if at some of these levels there is exactly one block left and this block is not the middle block, the tower falls.The game ends at the moment when there is no block in the tower that you can take out so that the tower doesn\'t fall.Here is a wonderful game invented by the residents of the city of Tomsk. I wonder for how many minutes can the game last if the player acts optimally well? If a player acts optimally well, then at any moment he tries to choose the block he takes out so as to minimize the expected number of the game duration.Your task is to write a program that determines the expected number of the desired amount of minutes." 2500

424D "Biathlon Track" "binary search,brute force,constructive algorithms,data structures,dp" "Recently an official statement of the world Olympic Committee said that the Olympic Winter Games 2030 will be held in Tomsk. The city officials decided to prepare for the Olympics thoroughly and to build all the necessary Olympic facilities as early as possible. First, a biathlon track will be built.To construct a biathlon track a plot of land was allocated, which is a rectangle divided into n\xe2\x80\x89\xc3\x97\xe2\x80\x89m identical squares. Each of the squares has two coordinates: the number of the row (from 1 to n), where it is located, the number of the column (from 1 to m), where it is located. Also each of the squares is characterized by its height. During the sports the biathletes will have to move from one square to another. If a biathlete moves from a higher square to a lower one, he makes a descent. If a biathlete moves from a lower square to a higher one, he makes an ascent. If a biathlete moves between two squares with the same height, then he moves on flat ground.The biathlon track should be a border of some rectangular area of the allocated land on which biathletes will move in the clockwise direction. It is known that on one move on flat ground an average biathlete spends tp seconds, an ascent takes tu seconds, a descent takes td seconds. The Tomsk Administration wants to choose the route so that the average biathlete passes it in as close to t seconds as possible. In other words, the difference between time ts of passing the selected track and t should be minimum.For a better understanding you can look at the first sample of the input data. In this sample n\xe2\x80\x89=\xe2\x80\x896,\xe2\x80\x89m\xe2\x80\x89=\xe2\x80\x897, and the administration wants the track covering time to be as close to t\xe2\x80\x89=\xe2\x80\x8948 seconds as possible, also, tp\xe2\x80\x89=\xe2\x80\x893, tu\xe2\x80\x89=\xe2\x80\x896 and td\xe2\x80\x89=\xe2\x80\x892. If we consider the rectangle shown on the image by arrows, the average biathlete can move along the boundary in a clockwise direction in exactly 48 seconds. The upper left corner of this track is located in the square with the row number 4, column number 3 and the lower right corner is at square with row number 6, column number 7.  Among other things the administration wants all sides of the rectangle which boundaries will be the biathlon track to consist of no less than three squares and to be completely contained within the selected land.You are given the description of the given plot of land and all necessary time values. You are to write the program to find the most suitable rectangle for a biathlon track. If there are several such rectangles, you are allowed to print any of them." 2300

424C "Magic Formulas" math "People in the Tomskaya region like magic formulas very much. You can see some of them below.Imagine you are given a sequence of positive integer numbers p1, p2, ..., pn. Lets write down some magic formulas:Here, ""mod"" means the operation of taking the residue after dividing.The expression  means applying the bitwise xor (excluding ""OR"") operation to integers x and y. The given operation exists in all modern programming languages. For example, in languages C++ and Java it is represented by ""^"", in Pascal \xe2\x80\x94 by ""xor"".People in the Tomskaya region like magic formulas very much, but they don\'t like to calculate them! Therefore you are given the sequence p, calculate the value of Q." 1600

424B Megacity "binary search,greedy,implementation,sortings" "The administration of the Tomsk Region firmly believes that it\'s time to become a megacity (that is, get population of one million). Instead of improving the demographic situation, they decided to achieve its goal by expanding the boundaries of the city.The city of Tomsk can be represented as point on the plane with coordinates (0; 0). The city is surrounded with n other locations, the i-th one has coordinates (xi, yi) with the population of ki people. You can widen the city boundaries to a circle of radius r. In such case all locations inside the circle and on its border are included into the city.Your goal is to write a program that will determine the minimum radius r, to which is necessary to expand the boundaries of Tomsk, so that it becomes a megacity." 1200

424A Squats implementation "Pasha has many hamsters and he makes them work out. Today, n hamsters (n is even) came to work out. The hamsters lined up and each hamster either sat down or stood up.For another exercise, Pasha needs exactly  hamsters to stand up and the other hamsters to sit down. In one minute, Pasha can make some hamster ether sit down or stand up. How many minutes will he need to get what he wants if he acts optimally well?" 900

421D "Bug in Code" "binary search,data structures,sortings" "Recently a serious bug has been found in the FOS code. The head of the F company wants to find the culprit and punish him. For that, he set up an organizational meeting, the issue is: who\'s bugged the code? Each of the n coders on the meeting said: \'I know for sure that either x or y did it!\'The head of the company decided to choose two suspects and invite them to his office. Naturally, he should consider the coders\' opinions. That\'s why the head wants to make such a choice that at least p of n coders agreed with it. A coder agrees with the choice of two suspects if at least one of the two people that he named at the meeting was chosen as a suspect. In how many ways can the head of F choose two suspects?Note that even if some coder was chosen as a suspect, he can agree with the head\'s choice if he named the other chosen coder at the meeting." 1900

421A "Pasha and Hamsters" "constructive algorithms,implementation" "Pasha has two hamsters: Arthur and Alexander. Pasha put n apples in front of them. Pasha knows which apples Arthur likes. Similarly, Pasha knows which apples Alexander likes. Pasha doesn\'t want any conflict between the hamsters (as they may like the same apple), so he decided to distribute the apples between the hamsters on his own. He is going to give some apples to Arthur and some apples to Alexander. It doesn\'t matter how many apples each hamster gets but it is important that each hamster gets only the apples he likes. It is possible that somebody doesn\'t get any apples.Help Pasha distribute all the apples between the hamsters. Note that Pasha wants to distribute all the apples, not just some of them." 800

420E "Playing the ball" geometry "A coder cannot sit and code all day. Sometimes it is a good idea to rise from the desk, have a rest, have small talk with colleagues and even play. The coders of the F company have their favorite ball game.Let\'s imagine the game on the plane with a cartesian coordinate system. The point (0, 0) contains the player who chooses an arbitrary direction and throws a ball in that direction. The ball hits the plane at distance d from the player\'s original position and continues flying in the same direction. After the ball hits the plane for the first time, it flies on and hits the plane again at distance 2\xc2\xb7d from the player\'s original position and so on (it continue flying in the chosen direction and hitting the plane after each d units). All coders in the F company are strong, so the ball flies infinitely far away.The plane has n circles painted on it. If a ball hits the plane and hits a circle that is painted on the plane (including its border), then the player gets one point. The ball can hit multiple circles at once and get one point for each of them (if the ball hits some circle x times during the move, the player also gets x points). Count the maximum number of points a player can get if he throws a ball in the arbitrary direction. Note that the direction may have real cooridinates." 2600

420D "Cup Trick" "data structures" "The employees of the F company have lots of ways to entertain themselves. Today they invited a famous magician who shows a trick with plastic cups and a marble.The point is to trick the spectator\'s attention. Initially, the spectator stands in front of a line of n plastic cups. Then the magician places a small marble under one cup and shuffles the cups. Then the spectator should guess which cup hides the marble.But the head coder of the F company isn\'t easy to trick. When he saw the performance, he noticed several important facts:  each cup contains a mark \xe2\x80\x94 a number from 1 to n; all marks on the cups are distinct;  the magician shuffles the cups in m operations, each operation looks like that: take a cup marked xi, sitting at position yi in the row of cups (the positions are numbered from left to right, starting from 1) and shift it to the very beginning of the cup row (on the first position). When the head coder came home after work he wanted to re-do the trick. Unfortunately, he didn\'t remember the starting or the final position of the cups. He only remembered which operations the magician performed. Help the coder: given the operations in the order they were made find at least one initial permutation of the cups that can go through the described operations in the given order. Otherwise, state that such permutation doesn\'t exist." 2200

420C "Bug in Code" "data structures,graphs,implementation,two pointers" "Recently a serious bug has been found in the FOS code. The head of the F company wants to find the culprit and punish him. For that, he set up an organizational meeting, the issue is: who\'s bugged the code? Each of the n coders on the meeting said: \'I know for sure that either x or y did it!\'The head of the company decided to choose two suspects and invite them to his office. Naturally, he should consider the coders\' opinions. That\'s why the head wants to make such a choice that at least p of n coders agreed with it. A coder agrees with the choice of two suspects if at least one of the two people that he named at the meeting was chosen as a suspect. In how many ways can the head of F choose two suspects?Note that even if some coder was chosen as a suspect, he can agree with the head\'s choice if he named the other chosen coder at the meeting." 1900

420B "Online Meeting" implementation "Nearly each project of the F company has a whole team of developers working on it. They often are in different rooms of the office in different cities and even countries. To keep in touch and track the results of the project, the F company conducts shared online meetings in a Spyke chat.One day the director of the F company got hold of the records of a part of an online meeting of one successful team. The director watched the record and wanted to talk to the team leader. But how can he tell who the leader is? The director logically supposed that the leader is the person who is present at any conversation during a chat meeting. In other words, if at some moment of time at least one person is present on the meeting, then the leader is present on the meeting.You are the assistant director. Given the \'user logged on\'/\'user logged off\' messages of the meeting in the chronological order, help the director determine who can be the leader. Note that the director has the record of only a continuous part of the meeting (probably, it\'s not the whole meeting)." 1800

420A "Start Up" implementation "Recently, a start up by two students of a state university of city F gained incredible popularity. Now it\'s time to start a new company. But what do we call it?The market analysts came up with a very smart plan: the name of the company should be identical to its reflection in a mirror! In other words, if we write out the name of the company on a piece of paper in a line (horizontally, from left to right) with large English letters, then put this piece of paper in front of the mirror, then the reflection of the name in the mirror should perfectly match the line written on the piece of paper.There are many suggestions for the company name, so coming up to the mirror with a piece of paper for each name wouldn\'t be sensible. The founders of the company decided to automatize this process. They asked you to write a program that can, given a word, determine whether the word is a \'mirror\' word or not." 1000

418E "Tricky Password" "data structures" "In order to ensure confidentiality, the access to the ""Russian Code Cup"" problems is password protected during the problem development process.To select a password, the jury can generate a special table that contains n columns and the infinite number of rows. To construct a table, the first row is fixed, and all the others are obtained by the following rule:In the row i at position p there is a number equal to the number of times a[i\xe2\x80\x89-\xe2\x80\x891][p] occurs on the prefix a[i\xe2\x80\x89-\xe2\x80\x891][1... p].To ensure the required level of confidentiality, the jury must be able to perform the following operations:   Replace number a[1][p] by v and rebuild the table.  Find the number a[x][y], which will be the new password. Doing all these steps manually is very tedious, so the jury asks you to help him. Write a program that responds to the request of the jury." 3100

418D "Big Problems for Organizers" "data structures,graphs,trees" "The Finals of the ""Russian Code Cup"" 2214 will be held in n hotels. Two hotels (let\'s assume that they are the main hotels), will host all sorts of events, and the remaining hotels will accommodate the participants. The hotels are connected by n\xe2\x80\x89-\xe2\x80\x891 roads, you can get from any hotel to any other one.The organizers wonder what is the minimum time all the participants need to get to the main hotels, if each participant goes to the main hotel that is nearest to him and moving between two hotels connected by a road takes one unit of time.The hosts consider various options for the location of the main hotels. For each option help the organizers to find minimal time." 2800

417E "Square Table" "constructive algorithms,math,probabilities" "While resting on the ship after the ""Russian Code Cup"" a boy named Misha invented an interesting game. He promised to give his quadrocopter to whoever will be the first one to make a rectangular table of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m, consisting of positive integers such that the sum of the squares of numbers for each row and each column was also a square.Since checking the correctness of the table manually is difficult, Misha asks you to make each number in the table to not exceed 108." 2400

417D "Cunning Gena" bitmasks,dp,greedy,sortings "A boy named Gena really wants to get to the ""Russian Code Cup"" finals, or at least get a t-shirt. But the offered problems are too complex, so he made an arrangement with his n friends that they will solve the problems for him.The participants are offered m problems on the contest. For each friend, Gena knows what problems he can solve. But Gena\'s friends won\'t agree to help Gena for nothing: the i-th friend asks Gena xi rubles for his help in solving all the problems he can. Also, the friend agreed to write a code for Gena only if Gena\'s computer is connected to at least ki monitors, each monitor costs b rubles.Gena is careful with money, so he wants to spend as little money as possible to solve all the problems. Help Gena, tell him how to spend the smallest possible amount of money. Initially, there\'s no monitors connected to Gena\'s computer." 1900

417C Football "constructive algorithms,graphs,implementation" "One day, at the ""Russian Code Cup"" event it was decided to play football as an out of competition event. All participants was divided into n teams and played several matches, two teams could not play against each other more than once.The appointed Judge was the most experienced member \xe2\x80\x94 Pavel. But since he was the wisest of all, he soon got bored of the game and fell asleep. Waking up, he discovered that the tournament is over and the teams want to know the results of all the matches.Pavel didn\'t want anyone to discover about him sleeping and not keeping an eye on the results, so he decided to recover the results of all games. To do this, he asked all the teams and learned that the real winner was friendship, that is, each team beat the other teams exactly k times. Help Pavel come up with chronology of the tournir that meets all the conditions, or otherwise report that there is no such table." 1400

417B Crash implementation "During the ""Russian Code Cup"" programming competition, the testing system stores all sent solutions for each participant. We know that many participants use random numbers in their programs and are often sent several solutions with the same source code to check.Each participant is identified by some unique positive integer k, and each sent solution A is characterized by two numbers: x�\xe2\x80\x94 the number of different solutions that are sent before the first solution identical to A, and k \xe2\x80\x94 the number of the participant, who is the author of the solution. Consequently, all identical solutions have the same x.It is known that the data in the testing system are stored in the chronological order, that is, if the testing system has a solution with number x (x\xe2\x80\x89>\xe2\x80\x890) of the participant with number k, then the testing system has a solution with number x\xe2\x80\x89-\xe2\x80\x891 of the same participant stored somewhere before.During the competition the checking system crashed, but then the data of the submissions of all participants have been restored. Now the jury wants to verify that the recovered data is in chronological order. Help the jury to do so." 1400

417A Elimination dp,implementation,math "The finalists of the ""Russian Code Cup"" competition in 2214 will be the participants who win in one of the elimination rounds.The elimination rounds are divided into main and additional. Each of the main elimination rounds consists of c problems, the winners of the round are the first n people in the rating list. Each of the additional elimination rounds consists of d problems. The winner of the additional round is one person. Besides, k winners of the past finals are invited to the finals without elimination.As a result of all elimination rounds at least n\xc2\xb7m people should go to the finals. You need to organize elimination rounds in such a way, that at least n\xc2\xb7m people go to the finals, and the total amount of used problems in all rounds is as small as possible." 1500

416E "President\'s Path" "dp,graphs,shortest paths" "The finalists of the ""Russian Code Cup"" competition in 2214 will be the participants who win in one of the elimination rounds.The elimination rounds are divided into main and additional. Each of the main elimination rounds consists of c problems, the winners of the round are the first n people in the rating list. Each of the additional elimination rounds consists of d problems. The winner of the additional round is one person. Besides, k winners of the past finals are invited to the finals without elimination.As a result of all elimination rounds at least n\xc2\xb7m people should go to the finals. You need to organize elimination rounds in such a way, that at least n\xc2\xb7m people go to the finals, and the total amount of used problems in all rounds is as small as possible." 2500

416D "Population Size" greedy,implementation,math "Polycarpus develops an interesting theory about the interrelation of arithmetic progressions with just everything in the world. His current idea is that the population of the capital of Berland changes over time like an arithmetic progression. Well, or like multiple arithmetic progressions.Polycarpus believes that if he writes out the population of the capital for several consecutive years in the sequence a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an, then it is convenient to consider the array as several arithmetic progressions, written one after the other. For example, sequence (8,\xe2\x80\x896,\xe2\x80\x894,\xe2\x80\x892,\xe2\x80\x891,\xe2\x80\x894,\xe2\x80\x897,\xe2\x80\x8910,\xe2\x80\x892) can be considered as a sequence of three arithmetic progressions (8,\xe2\x80\x896,\xe2\x80\x894,\xe2\x80\x892), (1,\xe2\x80\x894,\xe2\x80\x897,\xe2\x80\x8910) and (2), which are written one after another.Unfortunately, Polycarpus may not have all the data for the n consecutive years (a census of the population doesn\'t occur every year, after all). For this reason, some values of ai \xe2\x80\x8b\xe2\x80\x8bmay be unknown. Such values are represented by number -1.For a given sequence a\xe2\x80\x89=\xe2\x80\x89(a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an), which consists of positive integers and values \xe2\x80\x8b\xe2\x80\x8b-1, find the minimum number of arithmetic progressions Polycarpus needs to get a. To get a, the progressions need to be written down one after the other. Values \xe2\x80\x8b\xe2\x80\x8b-1 may correspond to an arbitrary positive integer and the values ai\xe2\x80\x89>\xe2\x80\x890 must be equal to the corresponding elements of sought consecutive record of the progressions.Let us remind you that a finite sequence c is called an arithmetic progression if the difference ci\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89-\xe2\x80\x89ci of any two consecutive elements in it is constant. By definition, any sequence of length 1 is an arithmetic progression." 2400

416C "Booking System" "binary search,dp,greedy,implementation" "Innovation technologies are on a victorious march around the planet. They integrate into all spheres of human activity!A restaurant called ""Dijkstra\'s Place"" has started thinking about optimizing the booking system. There are n booking requests received by now. Each request is characterized by two numbers: ci and pi \xe2\x80\x94 the size of the group of visitors who will come via this request and the total sum of money they will spend in the restaurant, correspondingly.We know that for each request, all ci people want to sit at the same table and are going to spend the whole evening in the restaurant, from the opening moment at 18:00 to the closing moment.Unfortunately, there only are k tables in the restaurant. For each table, we know ri \xe2\x80\x94 the maximum number of people who can sit at it. A table can have only people from the same group sitting at it. If you cannot find a large enough table for the whole group, then all visitors leave and naturally, pay nothing.Your task is: given the tables and the requests, decide which requests to accept and which requests to decline so that the money paid by the happy and full visitors was maximum." 1600

416B "Art Union" "brute force,dp,implementation" "A well-known art union called ""Kalevich is Alive!"" manufactures objects d\'art (pictures). The union consists of n painters who decided to organize their work as follows.Each painter uses only the color that was assigned to him. The colors are distinct for all painters. Let\'s assume that the first painter uses color 1, the second one uses color 2, and so on. Each picture will contain all these n colors. Adding the j-th color to the i-th picture takes the j-th painter tij units of time.Order is important everywhere, so the painters\' work is ordered by the following rules:  Each picture is first painted by the first painter, then by the second one, and so on. That is, after the j-th painter finishes working on the picture, it must go to the (j\xe2\x80\x89+\xe2\x80\x891)-th painter (if j\xe2\x80\x89<\xe2\x80\x89n);  each painter works on the pictures in some order: first, he paints the first picture, then he paints the second picture and so on;  each painter can simultaneously work on at most one picture. However, the painters don\'t need any time to have a rest;  as soon as the j-th painter finishes his part of working on the picture, the picture immediately becomes available to the next painter. Given that the painters start working at time 0, find for each picture the time when it is ready for sale." 1300

416A "Guess a number!" "greedy,implementation,two pointers" "A TV show called ""Guess a number!"" is gathering popularity. The whole Berland, the old and the young, are watching the show.The rules are simple. The host thinks of an integer y and the participants guess it by asking questions to the host. There are four types of acceptable questions:  Is it true that y is strictly larger than number x?  Is it true that y is strictly smaller than number x?  Is it true that y is larger than or equal to number x?  Is it true that y is smaller than or equal to number x? On each question the host answers truthfully, ""yes"" or ""no"".Given the sequence of questions and answers, find any integer value of y that meets the criteria of all answers. If there isn\'t such value, print ""Impossible""." 1400

415B "Mashmokh and Tokens" "binary search,greedy,implementation,math" "Bimokh is Mashmokh\'s boss. For the following n days he decided to pay to his workers in a new way. At the beginning of each day he will give each worker a certain amount of tokens. Then at the end of each day each worker can give some of his tokens back to get a certain amount of money. The worker can save the rest of tokens but he can\'t use it in any other day to get more money. If a worker gives back w tokens then he\'ll get  dollars. Mashmokh likes the tokens however he likes money more. That\'s why he wants to save as many tokens as possible so that the amount of money he gets is maximal possible each day. He has n numbers x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xn. Number xi is the number of tokens given to each worker on the i-th day. Help him calculate for each of n days the number of tokens he can save." 1500

415A "Mashmokh and Lights" implementation "Mashmokh works in a factory. At the end of each day he must turn off all of the lights. The lights on the factory are indexed from 1 to n. There are n buttons in Mashmokh\'s room indexed from 1 to n as well. If Mashmokh pushes button with index i, then each light with index not less than i that is still turned on turns off.Mashmokh is not very clever. So instead of pushing the first button he pushes some of the buttons randomly each night. He pushed m distinct buttons b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bm (the buttons were pushed consecutively in the given order) this night. Now he wants to know for each light the index of the button that turned this light off. Please note that the index of button bi is actually bi, not i.Please, help Mashmokh, print these indices." 900

414E "Mashmokh\'s Designed Problem" "data structures" "Mashmokh works in a factory. At the end of each day he must turn off all of the lights. The lights on the factory are indexed from 1 to n. There are n buttons in Mashmokh\'s room indexed from 1 to n as well. If Mashmokh pushes button with index i, then each light with index not less than i that is still turned on turns off.Mashmokh is not very clever. So instead of pushing the first button he pushes some of the buttons randomly each night. He pushed m distinct buttons b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bm (the buttons were pushed consecutively in the given order) this night. Now he wants to know for each light the index of the button that turned this light off. Please note that the index of button bi is actually bi, not i.Please, help Mashmokh, print these indices." 3200

414D "Mashmokh and Water Tanks" "binary search,data structures,greedy,trees,two pointers" "Mashmokh is playing a new game. In the beginning he has k liters of water and p coins. Additionally he has a rooted tree (an undirected connected acyclic graph) that consists of m vertices. Each vertex of the tree contains a water tank that is empty in the beginning.The game begins with the fact that Mashmokh chooses some (no more than k) of these tanks (except the root) and pours into each of them exactly 1 liter of water. Then the following process is performed until there is no water remained in tanks.  The process consists of several steps.  At the beginning of each step Mashmokh opens doors of all tanks. Then Mashmokh closes doors of some tanks (he is not allowed to close door of tank in the root) for the duration of this move. Let\'s denote the number of liters in some tank with closed door as w, Mashmokh pays w coins for the closing of that tank during this move.  Let\'s denote by x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xm as the list of vertices of the tree sorted (nondecreasing) by their depth. The vertices from this list should be considered one by one in the order. Firstly vertex x1 (which is the root itself) is emptied. Then for each vertex xi (i\xe2\x80\x89>\xe2\x80\x891), if its door is closed then skip the vertex else move all the water from the tank of vertex xi to the tank of its father (even if the tank of the father is closed). Suppose l moves were made until the tree became empty. Let\'s denote the amount of water inside the tank of the root after the i-th move by wi then Mashmokh will win max(w1,\xe2\x80\x89w2,\xe2\x80\x89...,\xe2\x80\x89wl) dollars. Mashmokh wanted to know what is the maximum amount of dollars he can win by playing the above game. He asked you to find this value for him." 2300

414C "Mashmokh and Reverse Operation" "combinatorics,divide and conquer" "Mashmokh\'s boss, Bimokh, didn\'t like Mashmokh. So he fired him. Mashmokh decided to go to university and participate in ACM instead of finding a new job. He wants to become a member of Bamokh\'s team. In order to join he was given some programming tasks and one week to solve them. Mashmokh is not a very experienced programmer. Actually he is not a programmer at all. So he wasn\'t able to solve them. That\'s why he asked you to help him with these tasks. One of these tasks is the following.You have an array a of length 2n and m queries on it. The i-th query is described by an integer qi. In order to perform the i-th query you must:  split the array into 2n\xe2\x80\x89-\xe2\x80\x89qi parts, where each part is a subarray consisting of 2qi numbers; the j-th subarray (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x892n\xe2\x80\x89-\xe2\x80\x89qi) should contain the elements a[(j\xe2\x80\x89-\xe2\x80\x891)\xc2\xb72qi\xe2\x80\x89+\xe2\x80\x891],\xe2\x80\x89a[(j\xe2\x80\x89-\xe2\x80\x891)\xc2\xb72qi\xe2\x80\x89+\xe2\x80\x892],\xe2\x80\x89...,\xe2\x80\x89a[(j\xe2\x80\x89-\xe2\x80\x891)\xc2\xb72qi\xe2\x80\x89+\xe2\x80\x892qi];  reverse each of the subarrays;  join them into a single array in the same order (this array becomes new array a);  output the number of inversions in the new a. Given initial array a and all the queries. Answer all the queries. Please, note that the changes from some query is saved for further queries." 2100

414B "Mashmokh and ACM" "combinatorics,dp,number theory" "Mashmokh\'s boss, Bimokh, didn\'t like Mashmokh. So he fired him. Mashmokh decided to go to university and participate in ACM instead of finding a new job. He wants to become a member of Bamokh\'s team. In order to join he was given some programming tasks and one week to solve them. Mashmokh is not a very experienced programmer. Actually he is not a programmer at all. So he wasn\'t able to solve them. That\'s why he asked you to help him with these tasks. One of these tasks is the following.A sequence of l integers b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bl (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89...\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89bl\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) is called good if each number divides (without a remainder) by the next number in the sequence. More formally  for all i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89-\xe2\x80\x891).Given n and k find the number of good sequences of length k. As the answer can be rather large print it modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." 1400

414A "Mashmokh and Numbers" "constructive algorithms,number theory" "It\'s holiday. Mashmokh and his boss, Bimokh, are playing a game invented by Mashmokh. In this game Mashmokh writes sequence of n distinct integers on the board. Then Bimokh makes several (possibly zero) moves. On the first move he removes the first and the second integer from from the board, on the second move he removes the first and the second integer of the remaining sequence from the board, and so on. Bimokh stops when the board contains less than two numbers. When Bimokh removes numbers x and y from the board, he gets gcd(x,\xe2\x80\x89y) points. At the beginning of the game Bimokh has zero points.Mashmokh wants to win in the game. For this reason he wants his boss to get exactly k points in total. But the guy doesn\'t know how choose the initial sequence in the right way. Please, help him. Find n distinct integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an such that his boss will score exactly k points. Also Mashmokh can\'t memorize too huge numbers. Therefore each of these integers must be at most 109." 1500

413E "Maze 2D" "data structures,divide and conquer" "The last product of the R2 company in the 2D games\' field is a new revolutionary algorithm of searching for the shortest path in a 2\xe2\x80\x89\xc3\x97\xe2\x80\x89n maze.Imagine a maze that looks like a 2\xe2\x80\x89\xc3\x97\xe2\x80\x89n rectangle, divided into unit squares. Each unit square is either an empty cell or an obstacle. In one unit of time, a person can move from an empty cell of the maze to any side-adjacent empty cell. The shortest path problem is formulated as follows. Given two free maze cells, you need to determine the minimum time required to go from one cell to the other.Unfortunately, the developed algorithm works well for only one request for finding the shortest path, in practice such requests occur quite often. You, as the chief R2 programmer, are commissioned to optimize the algorithm to find the shortest path. Write a program that will effectively respond to multiple requests to find the shortest path in a 2\xe2\x80\x89\xc3\x97\xe2\x80\x89n maze." 2200

413D 2048 bitmasks,dp "The programmers from the R2 company love playing 2048. One day, they decided to invent their own simplified version of this game \xe2\x80\x94 2k on a stripe.Imagine an infinite in one direction stripe, consisting of unit squares (the side of each square is equal to the height of the stripe). Each square can either be empty or contain some number.Initially, all squares are empty. Then at infinity one of the unit squares number 2 or 4 appears. Then the player presses a button once, and the appeared number begins to move towards the beginning of the stripe. Let\'s assume that some number x moves to the beginning of the stripe, then it will stop if:  it either gets in the first square of the stripe;  or it is in the square that is preceded by a square with number y (y\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89x). But if number x at some point of time gets to the square with the same number then both numbers add to each other and result in 2x. The new number 2x continues moving to the beginning of the stripe by the same rules. After the final stop of the number moving process, the infinity gets a new number 2 or 4 and the process repeats. Read the notes to the test samples to better understand the moving strategy.I guess you\'ve understood that the game progress fully depends on the order in which numbers 2 and 4 appear. Let\'s look at some sequence of numbers 2 and 4 in the game. We assume that the sequence is winning if it results in at least one square getting the number greater or equal than 2k. The goal of the game is to make up a winning sequence of n numbers. But not everything is so simple, some numbers in the sequence are identified beforehand. You are given a sequence consisting of numbers 0, 2, 4. Count how many ways there are to replace each 0 of the sequence with 2 or 4 to get a winning sequence." 2000

413C Jeopardy! greedy,math "\'Jeopardy!\' is an intellectual game where players answer questions and earn points. Company Q conducts a simplified \'Jeopardy!\' tournament among the best IT companies. By a lucky coincidence, the old rivals made it to the finals: company R1 and company R2. The finals will have n questions, m of them are auction questions and n\xe2\x80\x89-\xe2\x80\x89m of them are regular questions. Each question has a price. The price of the i-th question is ai points. During the game the players chose the questions. At that, if the question is an auction, then the player who chose it can change the price if the number of his current points is strictly larger than the price of the question. The new price of the question cannot be less than the original price and cannot be greater than the current number of points of the player who chose the question. The correct answer brings the player the points equal to the price of the question. The wrong answer to the question reduces the number of the player\'s points by the value of the question price.The game will go as follows. First, the R2 company selects a question, then the questions are chosen by the one who answered the previous question correctly. If no one answered the question, then the person who chose last chooses again.All R2 employees support their team. They want to calculate what maximum possible number of points the R2 team can get if luck is on their side during the whole game (they will always be the first to correctly answer questions). Perhaps you are not going to be surprised, but this problem was again entrusted for you to solve." 1400

413B "Spyke Chatting" implementation "The R2 company has n employees working for it. The work involves constant exchange of ideas, sharing the stories of success and upcoming challenging. For that, R2 uses a famous instant messaging program Spyke.R2 has m Spyke chats just to discuss all sorts of issues. In each chat, some group of employees exchanges messages daily. An employee can simultaneously talk in multiple chats. If some employee is in the k-th chat, he can write messages to this chat and receive notifications about messages from this chat. If an employee writes a message in the chat, all other participants of the chat receive a message notification.The R2 company is conducting an audit. Now the specialists study effective communication between the employees. For this purpose, they have a chat log and the description of chat structure. You, as one of audit specialists, are commissioned to write a program that will use this data to determine the total number of message notifications received by each employee." 1300

413A "Data Recovery" implementation "Not so long ago company R2 bought company R1 and consequently, all its developments in the field of multicore processors. Now the R2 laboratory is testing one of the R1 processors.The testing goes in n steps, at each step the processor gets some instructions, and then its temperature is measured. The head engineer in R2 is keeping a report record on the work of the processor: he writes down the minimum and the maximum measured temperature in his notebook. His assistant had to write down all temperatures into his notebook, but (for unknown reasons) he recorded only m.The next day, the engineer\'s assistant filed in a report with all the m temperatures. However, the chief engineer doubts that the assistant wrote down everything correctly (naturally, the chief engineer doesn\'t doubt his notes). So he asked you to help him. Given numbers n, m, min, max and the list of m temperatures determine whether you can upgrade the set of m temperatures to the set of n temperatures (that is add n\xe2\x80\x89-\xe2\x80\x89m temperatures), so that the minimum temperature was min and the maximum one was max." 1200

412E "E-mail Addresses" implementation "One of the most important products of the R1 company is a popular @r1.com mail service. The R1 mailboxes receive and send millions of emails every day.Today, the online news thundered with terrible information. The R1 database crashed and almost no data could be saved except for one big string. The developers assume that the string contains the letters of some users of the R1 mail. Recovering letters is a tedious mostly manual work. So before you start this process, it was decided to estimate the difficulty of recovering. Namely, we need to calculate the number of different substrings of the saved string that form correct e-mail addresses.We assume that valid addresses are only the e-mail addresses which meet the following criteria:  the address should begin with a non-empty sequence of letters, numbers, characters \'_\', starting with a letter;  then must go character \'@\';  then must go a non-empty sequence of letters or numbers;  then must go character \'.\';  the address must end with a non-empty sequence of letters. You got lucky again and the job was entrusted to you! Please note that the substring is several consecutive characters in a string. Two substrings, one consisting of the characters of the string with numbers l1,\xe2\x80\x89l1\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89l1\xe2\x80\x89+\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89r1 and the other one consisting of the characters of the string with numbers l2,\xe2\x80\x89l2\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89l2\xe2\x80\x89+\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89r2, are considered distinct if l1\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89l2 or r1\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89r2." 1900

412D "Giving Awards" "dfs and similar" "The employees of the R1 company often spend time together: they watch football, they go camping, they solve contests. So, it\'s no big deal that sometimes someone pays for someone else.Today is the day of giving out money rewards. The R1 company CEO will invite employees into his office one by one, rewarding each one for the hard work this month. The CEO knows who owes money to whom. And he also understands that if he invites person x to his office for a reward, and then immediately invite person y, who has lent some money to person x, then they can meet. Of course, in such a situation, the joy of person x from his brand new money reward will be much less. Therefore, the R1 CEO decided to invite the staff in such an order that the described situation will not happen for any pair of employees invited one after another.However, there are a lot of employees in the company, and the CEO doesn\'t have a lot of time. Therefore, the task has been assigned to you. Given the debt relationships between all the employees, determine in which order they should be invited to the office of the R1 company CEO, or determine that the described order does not exist." 2000

412C Pattern implementation,strings "Developers often face with regular expression patterns. A pattern is usually defined as a string consisting of characters and metacharacters that sets the rules for your search. These patterns are most often used to check whether a particular string meets the certain rules.In this task, a pattern will be a string consisting of small English letters and question marks (\'?\'). The question mark in the pattern is a metacharacter that denotes an arbitrary small letter of the English alphabet. We will assume that a string matches the pattern if we can transform the string into the pattern by replacing the question marks by the appropriate characters. For example, string aba matches patterns: ???, ??a, a?a, aba.Programmers that work for the R1 company love puzzling each other (and themselves) with riddles. One of them is as follows: you are given n patterns of the same length, you need to find a pattern that contains as few question marks as possible, and intersects with each of the given patterns. Two patterns intersect if there is a string that matches both the first and the second pattern. Can you solve this riddle?" 1200

412B "Network Configuration" greedy,sortings "The R1 company wants to hold a web search championship. There were n computers given for the competition, each of them is connected to the Internet. The organizers believe that the data transfer speed directly affects the result. The higher the speed of the Internet is, the faster the participant will find the necessary information. Therefore, before the competition started, each computer had its maximum possible data transfer speed measured. On the i-th computer it was ai kilobits per second.There will be k participants competing in the championship, each should get a separate computer. The organizing company does not want any of the participants to have an advantage over the others, so they want to provide the same data transfer speed to each participant\'s computer. Also, the organizers want to create the most comfortable conditions for the participants, so the data transfer speed on the participants\' computers should be as large as possible.The network settings of the R1 company has a special option that lets you to cut the initial maximum data transfer speed of any computer to any lower speed. How should the R1 company configure the network using the described option so that at least k of n computers had the same data transfer speed and the data transfer speed on these computers was as large as possible?" 900

412A Poster greedy,implementation "The R1 company has recently bought a high rise building in the centre of Moscow for its main office. It\'s time to decorate the new office, and the first thing to do is to write the company\'s slogan above the main entrance to the building.The slogan of the company consists of n characters, so the decorators hung a large banner, n meters wide and 1 meter high, divided into n equal squares. The first character of the slogan must be in the first square (the leftmost) of the poster, the second character must be in the second square, and so on.Of course, the R1 programmers want to write the slogan on the poster themselves. To do this, they have a large (and a very heavy) ladder which was put exactly opposite the k-th square of the poster. To draw the i-th character of the slogan on the poster, you need to climb the ladder, standing in front of the i-th square of the poster. This action (along with climbing up and down the ladder) takes one hour for a painter. The painter is not allowed to draw characters in the adjacent squares when the ladder is in front of the i-th square because the uncomfortable position of the ladder may make the characters untidy. Besides, the programmers can move the ladder. In one hour, they can move the ladder either a meter to the right or a meter to the left.Drawing characters and moving the ladder is very tiring, so the programmers want to finish the job in as little time as possible. Develop for them an optimal poster painting plan!" 900

411C Kicker implementation "Kicker (table football) is a board game based on football, in which players control the footballers\' figures mounted on rods by using bars to get the ball into the opponent\'s goal. When playing two on two, one player of each team controls the goalkeeper and the full-backs (plays defence), the other player controls the half-backs and forwards (plays attack).Two teams of company Q decided to battle each other. Let\'s enumerate players from both teams by integers from 1 to 4. The first and second player play in the first team, the third and the fourth one play in the second team. For each of the four players we know their game skills in defence and attack. The defence skill of the i-th player is ai, the attack skill is bi.Before the game, the teams determine how they will play. First the players of the first team decide who will play in the attack, and who will play in the defence. Then the second team players do the same, based on the choice of their opponents.We will define a team\'s defence as the defence skill of player of the team who plays defence. Similarly, a team\'s attack is the attack skill of the player of the team who plays attack. We assume that one team is guaranteed to beat the other one, if its defence is strictly greater than the opponent\'s attack and its attack is strictly greater than the opponent\'s defence.The teams of company Q know each other\'s strengths and therefore arrange their teams optimally. Identify the team that is guaranteed to win (if both teams act optimally) or tell that there is no such team." 1700

411B "Multi-core Processor" implementation "The research center Q has developed a new multi-core processor. The processor consists of n cores and has k cells of cache memory. Consider the work of this processor.At each cycle each core of the processor gets one instruction: either do nothing, or the number of the memory cell (the core will write an information to the cell). After receiving the command, the core executes it immediately. Sometimes it happens that at one cycle, multiple cores try to write the information into a single cell. Unfortunately, the developers did not foresee the possibility of resolving conflicts between cores, so in this case there is a deadlock: all these cores and the corresponding memory cell are locked forever. Each of the locked cores ignores all further commands, and no core in the future will be able to record an information into the locked cell. If any of the cores tries to write an information into some locked cell, it is immediately locked.The development team wants to explore the deadlock situation. Therefore, they need a program that will simulate the processor for a given set of instructions for each core within m cycles . You\'re lucky, this interesting work is entrusted to you. According to the instructions, during the m cycles define for each core the number of the cycle, during which it will become locked. It is believed that initially all cores and all memory cells are not locked." 1600

411A "Password Check" "*special problem,implementation" "You have probably registered on Internet sites many times. And each time you should enter your invented password. Usually the registration form automatically checks the password\'s crypt resistance. If the user\'s password isn\'t complex enough, a message is displayed. Today your task is to implement such an automatic check.Web-developers of the company Q assume that a password is complex enough, if it meets all of the following conditions:  the password length is at least 5 characters;  the password contains at least one large English letter;  the password contains at least one small English letter;  the password contains at least one digit. You are given a password. Please implement the automatic check of its complexity for company Q." 800

409I "Feed the Golorp" "*special problem" "Golorps are mysterious creatures who feed on variables. Golorp\'s name is a program in some programming language. Some scientists believe that this language is Befunge; golorps are tantalizingly silent.Variables consumed by golorps can take values from 0 to 9, inclusive. For each golorp its daily diet is defined by its name. Some golorps are so picky that they can\'t be fed at all. Besides, all golorps are very health-conscious and try to eat as little as possible. Given a choice of several valid sequences of variable values, each golorp will choose lexicographically smallest one.For the purposes of this problem you can assume that a golorp consists of jaws and a stomach. The number of variables necessary to feed a golorp is defined by the shape of its jaws. Variables can get to the stomach only via the jaws.A hungry golorp is visiting you. You know its name; feed it or figure out that it\'s impossible." 2400

409H "A + B Strikes Back" "*special problem,brute force,constructive algorithms,dsu,implementation" "A + B is often used as an example of the easiest problem possible to show some contest platform. However, some scientists have observed that sometimes this problem is not so easy to get accepted. Want to try?" 1500

409G "On a plane" "*special problem,geometry" "InputThe first line contains a single integer n (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x891000) \xe2\x80\x94 the number of points on a plane.Each of the next n lines contains two real coordinates xi and yi of the  point, specified with exactly 2 fractional digits. All coordinates are between \xe2\x80\x89-\xe2\x80\x891000 and 1000, inclusive.OutputOutput a single real number \xce\xb8 \xe2\x80\x94 the answer to the problem statement. The absolute or relative error of your answer should be at most 10\xe2\x80\x89-\xe2\x80\x892.ExamplesInputCopy8-2.14 2.06-1.14 2.04-2.16 1.46-2.14 0.70-1.42 0.40-0.94 -0.48-1.42 -1.28-2.16 -1.62OutputCopy5.410InputCopy52.26 1.442.28 0.642.30 -0.301.58 0.663.24 0.66OutputCopy5.620InputCopy86.98 2.066.40 1.125.98 0.245.54 -0.607.16 0.307.82 1.248.34 0.248.74 -0.76OutputCopy5.480InputCopy510.44 2.0610.90 0.8011.48 -0.4812.06 0.7612.54 2.06OutputCopy6.040InputCopy816.94 2.4215.72 2.3814.82 1.5814.88 0.5015.76 -0.1616.86 -0.2017.00 0.8816.40 0.92OutputCopy6.040InputCopy720.62 3.0021.06 2.2821.56 1.3621.66 0.5621.64 -0.5222.14 2.3222.62 3.04OutputCopy6.720" 2200

409F 000001 "*special problem" "InputThe input contains a single integer a (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x8964).OutputOutput a single integer.ExamplesInputCopy2OutputCopy1InputCopy4OutputCopy2InputCopy27OutputCopy5InputCopy42OutputCopy6" 1900

409E Dome "*special problem"  1800

409D "Big Data" "*special problem" "Little Petya wanted to give an April Fools Day present to some scientists. After some hesitation he decided to give them the array that he got as a present in Codeforces Round #153 (Div.2). The scientists rejoiced at the gift and decided to put some important facts to this array. Here are the first few of the facts: The highest mountain above sea level in the world is Mount Everest. Its peak rises to 8848 m.  The largest board game tournament consisted of 958 participants playing chapaev. The largest online maths competition consisted of 12766 participants. The Nile is credited as the longest river in the world. From its farthest stream in Burundi, it extends 6695 km in length. While not in flood, the main stretches of the Amazon river in South America can reach widths of up to 1100 km at its widest points. Angel Falls is the highest waterfall. Its greatest single drop measures 807 m. The Hotel Everest View above Namche, Nepal \xe2\x80\x94 the village closest to Everest base camp \xe2\x80\x93 is at a record height of 31962 m Uranium is the heaviest of all the naturally occurring elements. Its most common isotope has a nucleus containing 146 neutrons. The coldest permanently inhabited place is the Siberian village of Oymyakon, where the temperature of -68\xc2\xb0C was registered in the twentieth century. The longest snake held in captivity is over 25 feet long. Its name is Medusa. Colonel Meow holds the world record for longest fur on a cat \xe2\x80\x94 almost 134 centimeters. Sea otters can have up to 10000 hairs per square inch. This is the most dense fur in the animal kingdom. The largest state of USA is Alaska; its area is 663268 square miles Alaska has a longer coastline than all of the other 49 U.S. States put together: it is 154103 miles long. Lake Baikal is the largest freshwater lake in the world. It reaches 1642�meters in depth and contains around one-fifth of the world\xe2\x80\x99s unfrozen fresh water. The most colorful national flag is the one of Turkmenistan, with 106 colors." 1700

409C "Magnum Opus" "*special problem" "Salve, mi amice.Et tu quidem de lapis philosophorum. Barba non facit philosophum. Labor omnia vincit. Non potest creatio ex nihilo. Necesse est partibus.Rp:����I Aqua Fortis����I Aqua Regia����II Amalgama����VII Minium����IV VitriolMisce in vitro et \xc3\xa6stus, et nil admirari. Festina lente, et nulla tenaci invia est via.Fac et spera,Vale,Nicolas Flamel" 1700

409B "Mysterious Language" "*special problem" "You are given a mysterious language (codenamed ""Secret"") available in ""Custom Invocation"" tab. Figure out what this language is and write a program which prints its name. Note that the program must be written in this language." 1700

409A "The Great Game" "*special problem" "Two teams meet in The Game World Championship. Some scientists consider this game to be the most intellectually challenging game in the world. You are given two strings describing the teams\' actions in the final battle. Figure out who became the champion." 1700

408B Garland implementation "Once little Vasya read an article in a magazine on how to make beautiful handmade garland from colored paper. Vasya immediately went to the store and bought n colored sheets of paper, the area of each sheet is 1 square meter.The garland must consist of exactly m pieces of colored paper of arbitrary area, each piece should be of a certain color. To make the garland, Vasya can arbitrarily cut his existing colored sheets into pieces. Vasya is not obliged to use all the sheets to make the garland.Vasya wants the garland to be as attractive as possible, so he wants to maximize the total area of \xe2\x80\x8b\xe2\x80\x8bm pieces of paper in the garland. Calculate what the maximum total area of \xe2\x80\x8b\xe2\x80\x8bthe pieces of paper in the garland Vasya can get." 1200

408A "Line to Cashier" implementation "Little Vasya went to the supermarket to get some groceries. He walked about the supermarket for a long time and got a basket full of products. Now he needs to choose the cashier to pay for the products.There are n cashiers at the exit from the supermarket. At the moment the queue for the i-th cashier already has ki people. The j-th person standing in the queue to the i-th cashier has mi,\xe2\x80\x89j items in the basket. Vasya knows that:  the cashier needs 5 seconds to scan one item;  after the cashier scans each item of some customer, he needs 15 seconds to take the customer\'s money and give him the change. Of course, Vasya wants to select a queue so that he can leave the supermarket as soon as possible. Help him write a program that displays the minimum number of seconds after which Vasya can get to one of the cashiers." 900

407E k-d-sequence "data structures" "We\'ll call a sequence of integers a good k-d sequence if we can add to it at most k numbers in such a way that after the sorting the sequence will be an arithmetic progression with difference d.You got hold of some sequence a, consisting of n integers. Your task is to find its longest contiguous subsegment, such that it is a good k-d sequence." 3100

407D "Largest Submatrix 3" dp,hashing "You are given matrix a of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m, its elements are integers. We will assume that the rows of the matrix are numbered from top to bottom from 1 to n, the columns are numbered from left to right from 1 to m. We will denote the element on the intersecting of the i-th row and the j-th column as aij.We\'ll call submatrix i1,\xe2\x80\x89j1,\xe2\x80\x89i2,\xe2\x80\x89j2 (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n;�1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m) such elements aij of the given matrix that i1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i2 AND j1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j2. We\'ll call the area of the submatrix number (i2\xe2\x80\x89-\xe2\x80\x89i1\xe2\x80\x89+\xe2\x80\x891)\xc2\xb7(j2\xe2\x80\x89-\xe2\x80\x89j1\xe2\x80\x89+\xe2\x80\x891). We\'ll call a submatrix inhomogeneous, if all its elements are distinct.Find the largest (in area) inhomogenous submatrix of the given matrix." 2700

407C "Curious Array" "brute force,combinatorics,implementation,math" "You\'ve got an array consisting of n integers: a[1],\xe2\x80\x89a[2],\xe2\x80\x89...,\xe2\x80\x89a[n]. Moreover, there are m queries, each query can be described by three integers li,\xe2\x80\x89ri,\xe2\x80\x89ki. Query li,\xe2\x80\x89ri,\xe2\x80\x89ki means that we should add  to each element a[j], where li\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ri.Record  means the binomial coefficient, or the number of combinations from y elements into groups of x elements.You need to fulfil consecutively all queries and then print the final array." 2500

407B "Long Path" dp,implementation "One day, little Vasya found himself in a maze consisting of (n\xe2\x80\x89+\xe2\x80\x891) rooms, numbered from 1 to (n\xe2\x80\x89+\xe2\x80\x891). Initially, Vasya is at the first room and to get out of the maze, he needs to get to the (n\xe2\x80\x89+\xe2\x80\x891)-th one.The maze is organized as follows. Each room of the maze has two one-way portals. Let\'s consider room number i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n), someone can use the first portal to move from it to room number (i\xe2\x80\x89+\xe2\x80\x891), also someone can use the second portal to move from it to room number pi, where 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89pi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i.In order not to get lost, Vasya decided to act as follows.   Each time Vasya enters some room, he paints a cross on its ceiling. Initially, Vasya paints a cross at the ceiling of room 1.  Let\'s assume that Vasya is in room i and has already painted a cross on its ceiling. Then, if the ceiling now contains an odd number of crosses, Vasya uses the second portal (it leads to room pi), otherwise Vasya uses the first portal. Help Vasya determine the number of times he needs to use portals to get to room (n\xe2\x80\x89+\xe2\x80\x891) in the end." 1600

407A Triangle "brute force,geometry,implementation,math" "There is a right triangle with legs of length a and b. Your task is to determine whether it is possible to locate the triangle on the plane in such a way that none of its sides is parallel to the coordinate axes. All the vertices must have integer coordinates. If there exists such a location, you have to output the appropriate coordinates of vertices." 1600

406E "Hamming Triples" "implementation,math,two pointers" "Little Chris is having a nightmare. Even in dreams all he thinks about is math.Chris dreams about m binary strings of length n, indexed with numbers from 1 to m. The most horrifying part is that the bits of each string are ordered in either ascending or descending order. For example, Chris could be dreaming about the following 4 strings of length 5:  The Hamming distance H(a,\xe2\x80\x89b) between two strings a and b of length n is the number of positions at which the corresponding symbols are different. \xd0\xa1hris thinks that each three strings with different indices constitute a single triple. Chris\'s delusion is that he will wake up only if he counts the number of such string triples a, b, c that the sum H(a,\xe2\x80\x89b)\xe2\x80\x89+\xe2\x80\x89H(b,\xe2\x80\x89c)\xe2\x80\x89+\xe2\x80\x89H(c,\xe2\x80\x89a) is maximal among all the string triples constructed from the dreamed strings.Help Chris wake up from this nightmare!" 2800

406D "Hill Climbing" "dfs and similar,geometry,trees" "This problem has nothing to do with Little Chris. It is about hill climbers instead (and Chris definitely isn\'t one).There are n hills arranged on a line, each in the form of a vertical line segment with one endpoint on the ground. The hills are numbered with numbers from 1 to n from left to right. The i-th hill stands at position xi with its top at height yi. For every two hills a and b, if the top of hill a can be seen from the top of hill b, their tops are connected by a rope. Formally, the tops of two hills are connected if the segment connecting their top points does not intersect or touch any of the other hill segments. Using these ropes, the hill climbers can move from hill to hill.There are m teams of climbers, each composed of exactly two members. The first and the second climbers of the i-th team are located at the top of the ai-th and bi-th hills, respectively. They want to meet together at the top of some hill. Now, each of two climbers move according to the following process:  if a climber is at the top of the hill where the other climber is already located or will come eventually, the former climber stays at this hill;  otherwise, the climber picks a hill to the right of his current hill that is reachable by a rope and is the rightmost possible, climbs this hill and continues the process (the climber can also climb a hill whose top is lower than the top of his current hill).   For each team of climbers, determine the number of the meeting hill for this pair!" 2200

405E "Graph Cutting" "dfs and similar,graphs" "Little Chris is participating in a graph cutting contest. He\'s a pro. The time has come to test his skills to the fullest.Chris is given a simple undirected connected graph with n vertices (numbered from 1 to n) and m edges. The problem is to cut it into edge-distinct paths of length 2. Formally, Chris has to partition all edges of the graph into pairs in such a way that the edges in a single pair are adjacent and each edge must be contained in exactly one pair.For example, the figure shows a way Chris can cut a graph. The first sample test contains the description of this graph.  You are given a chance to compete with Chris. Find a way to cut the given graph or determine that it is impossible!" 2300

405D "Toy Sum" greedy,implementation,math "Little Chris is very keen on his toy blocks. His teacher, however, wants Chris to solve more problems, so he decided to play a trick on Chris.There are exactly s blocks in Chris\'s set, each block has a unique number from 1 to s. Chris\'s teacher picks a subset of blocks X and keeps it to himself. He will give them back only if Chris can pick such a non-empty subset Y from the remaining blocks, that the equality holds:  ""Are you kidding me?"", asks Chris.For example, consider a case where s\xe2\x80\x89=\xe2\x80\x898 and Chris\'s teacher took the blocks with numbers 1, 4 and 5. One way for Chris to choose a set is to pick the blocks with numbers 3 and 6, see figure. Then the required sums would be equal: (1\xe2\x80\x89-\xe2\x80\x891)\xe2\x80\x89+\xe2\x80\x89(4\xe2\x80\x89-\xe2\x80\x891)\xe2\x80\x89+\xe2\x80\x89(5\xe2\x80\x89-\xe2\x80\x891)\xe2\x80\x89=\xe2\x80\x89(8\xe2\x80\x89-\xe2\x80\x893)\xe2\x80\x89+\xe2\x80\x89(8\xe2\x80\x89-\xe2\x80\x896)\xe2\x80\x89=\xe2\x80\x897.  However, now Chris has exactly s\xe2\x80\x89=\xe2\x80\x89106 blocks. Given the set X of blocks his teacher chooses, help Chris to find the required set Y!" 1700

405C "Unusual Product" implementation,math "Little Chris is a huge fan of linear algebra. This time he has been given a homework about the unusual square of a square matrix.The dot product of two integer number vectors x and y of size n is the sum of the products of the corresponding components of the vectors. The unusual square of an n\xe2\x80\x89\xc3\x97\xe2\x80\x89n square matrix A is defined as the sum of n dot products. The i-th of them is the dot product of the i-th row vector and the i-th column vector in the matrix A.Fortunately for Chris, he has to work only in GF(2)! This means that all operations (addition, multiplication) are calculated modulo 2. In fact, the matrix A is binary: each element of A is either 0 or 1. For example, consider the following matrix A:  The unusual square of A is equal to (1\xc2\xb71\xe2\x80\x89+\xe2\x80\x891\xc2\xb70\xe2\x80\x89+\xe2\x80\x891\xc2\xb71)\xe2\x80\x89+\xe2\x80\x89(0\xc2\xb71\xe2\x80\x89+\xe2\x80\x891\xc2\xb71\xe2\x80\x89+\xe2\x80\x891\xc2\xb70)\xe2\x80\x89+\xe2\x80\x89(1\xc2\xb71\xe2\x80\x89+\xe2\x80\x890\xc2\xb71\xe2\x80\x89+\xe2\x80\x890\xc2\xb70)\xe2\x80\x89=\xe2\x80\x890\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89=\xe2\x80\x890.However, there is much more to the homework. Chris has to process q queries; each query can be one of the following:   given a row index i, flip all the values in the i-th row in A;  given a column index i, flip all the values in the i-th column in A;  find the unusual square of A. To flip a bit value w means to change it to 1\xe2\x80\x89-\xe2\x80\x89w, i.e., 1 changes to 0 and 0 changes to 1.Given the initial matrix A, output the answers for each query of the third type! Can you solve Chris\'s homework?" 1600

405B "Domino Effect" NA "Little Chris knows there\'s no fun in playing dominoes, he thinks it\'s too random and doesn\'t require skill. Instead, he decided to play with the dominoes and make a ""domino show"".Chris arranges n dominoes in a line, placing each piece vertically upright. In the beginning, he simultaneously pushes some of the dominoes either to the left or to the right. However, somewhere between every two dominoes pushed in the same direction there is at least one domino pushed in the opposite direction.After each second, each domino that is falling to the left pushes the adjacent domino on the left. Similarly, the dominoes falling to the right push their adjacent dominoes standing on the right. When a vertical domino has dominoes falling on it from both sides, it stays still due to the balance of the forces. The figure shows one possible example of the process.  Given the initial directions Chris has pushed the dominoes, find the number of the dominoes left standing vertically at the end of the process!" 1100

405A "Gravity Flip" greedy,implementation,sortings "Little Chris is bored during his physics lessons (too easy), so he has built a toy box to keep himself occupied. The box is special, since it has the ability to change gravity.There are n columns of toy cubes in the box arranged in a line. The i-th column contains ai cubes. At first, the gravity in the box is pulling the cubes downwards. When Chris switches the gravity, it begins to pull all the cubes to the right side of the box. The figure shows the initial and final configurations of the cubes in the box: the cubes that have changed their position are highlighted with orange.  Given the initial configuration of the toy cubes in the box, find the amounts of cubes in each of the n columns after the gravity switch!" 900

404E "Maze 1D" "binary search,greedy,implementation" "Valera has a strip infinite in both directions and consisting of cells. The cells are numbered by integers. The cell number 0 has a robot.The robot has instructions \xe2\x80\x94 the sequence of moves that he must perform. In one move, the robot moves one cell to the left or one cell to the right, according to instructions. Before the robot starts moving, Valera puts obstacles in some cells of the strip, excluding cell number 0. If the robot should go into the cell with an obstacle according the instructions, it will skip this move.Also Valera indicates the finish cell in which the robot has to be after completing the entire instructions. The finishing cell should be different from the starting one. It is believed that the robot completed the instructions successfully, if during the process of moving he visited the finish cell exactly once \xe2\x80\x94 at its last move. Moreover, the latter move cannot be skipped.Let\'s assume that k is the minimum number of obstacles that Valera must put to make the robot able to complete the entire sequence of instructions successfully and end up in some finishing cell. You need to calculate in how many ways Valera can choose k obstacles and the finishing cell so that the robot is able to complete the instructions successfully." 2200

404D "Minesweeper 1D" dp,implementation "Game ""Minesweeper 1D"" is played on a line of squares, the line\'s height is 1 square, the line\'s width is n squares. Some of the squares contain bombs. If a square doesn\'t contain a bomb, then it contains a number from 0 to 2 \xe2\x80\x94 the total number of bombs in adjacent squares.For example, the correct field to play looks like that: 001*2***101*. The cells that are marked with ""*"" contain bombs. Note that on the correct field the numbers represent the number of bombs in adjacent cells. For example, field 2* is not correct, because cell with value 2 must have two adjacent cells with bombs.Valera wants to make a correct field to play ""Minesweeper 1D"". He has already painted a squared field with width of n cells, put several bombs on the field and wrote numbers into some cells. Now he wonders how many ways to fill the remaining cells with bombs and numbers are there if we should get a correct field in the end." 1900

404C "Restore Graph" "dfs and similar,graphs,sortings" "Valera had an undirected connected graph without self-loops and multiple edges consisting of n vertices. The graph had an interesting property: there were at most k edges adjacent to each of its vertices. For convenience, we will assume that the graph vertices were indexed by integers from 1 to n.One day Valera counted the shortest distances from one of the graph vertices to all other ones and wrote them out in array d. Thus, element d[i] of the array shows the shortest distance from the vertex Valera chose to vertex number i.Then something irreparable terrible happened. Valera lost the initial graph. However, he still has the array d. Help him restore the lost graph." 1800

404B Marathon implementation,math "Valera takes part in the Berland Marathon. The marathon race starts at the stadium that can be represented on the plane as a square whose lower left corner is located at point with coordinates (0,\xe2\x80\x890) and the length of the side equals a meters. The sides of the square are parallel to coordinate axes.As the length of the marathon race is very long, Valera needs to have extra drink during the race. The coach gives Valera a bottle of drink each d meters of the path. We know that Valera starts at the point with coordinates (0,\xe2\x80\x890) and runs counter-clockwise. That is, when Valera covers a meters, he reaches the point with coordinates (a,\xe2\x80\x890). We also know that the length of the marathon race equals nd\xe2\x80\x89+\xe2\x80\x890.5 meters. Help Valera\'s coach determine where he should be located to help Valera. Specifically, determine the coordinates of Valera\'s positions when he covers d,\xe2\x80\x892\xc2\xb7d,\xe2\x80\x89...,\xe2\x80\x89n\xc2\xb7d meters." 1500

404A "Valera and X" implementation "Valera is a little boy. Yesterday he got a huge Math hometask at school, so Valera didn\'t have enough time to properly learn the English alphabet for his English lesson. Unfortunately, the English teacher decided to have a test on alphabet today. At the test Valera got a square piece of squared paper. The length of the side equals n squares (n is an odd number) and each unit square contains some small letter of the English alphabet.Valera needs to know if the letters written on the square piece of paper form letter ""X"". Valera\'s teacher thinks that the letters on the piece of paper form an ""X"", if:  on both diagonals of the square paper all letters are the same;  all other squares of the paper (they are not on the diagonals) contain the same letter that is different from the letters on the diagonals. Help Valera, write the program that completes the described task for him." 1000

403E "Two Rooted Trees" "data structures,implementation,trees" "You have two rooted undirected trees, each contains n vertices. Let\'s number the vertices of each tree with integers from 1 to n. The root of each tree is at vertex 1. The edges of the first tree are painted blue, the edges of the second one are painted red. For simplicity, let\'s say that the first tree is blue and the second tree is red.Edge {x,\xe2\x80\x89y} is called bad for edge {p,\xe2\x80\x89q} if two conditions are fulfilled:   The color of edge {x,\xe2\x80\x89y} is different from the color of edge {p,\xe2\x80\x89q}.  Let\'s consider the tree of the same color that edge {p,\xe2\x80\x89q} is. Exactly one of vertices x, y lies both in the subtree of vertex p and in the subtree of vertex q. In this problem, your task is to simulate the process described below. The process consists of several stages:  On each stage edges of exactly one color are deleted.  On the first stage, exactly one blue edge is deleted.  Let\'s assume that at the stage i we\'ve deleted edges {u1,\xe2\x80\x89v1}, {u2,\xe2\x80\x89v2}, ..., {uk,\xe2\x80\x89vk}. At the stage i\xe2\x80\x89+\xe2\x80\x891 we will delete all undeleted bad edges for edge {u1,\xe2\x80\x89v1}, then we will delete all undeleted bad edges for edge {u2,\xe2\x80\x89v2} and so on until we reach edge {uk,\xe2\x80\x89vk}.  For each stage of deleting edges determine what edges will be removed on the stage. Note that the definition of a bad edge always considers the initial tree before it had any edges removed." 2900

403D "Beautiful Pairs of Numbers" combinatorics,dp "The sequence of integer pairs (a1,\xe2\x80\x89b1),\xe2\x80\x89(a2,\xe2\x80\x89b2),\xe2\x80\x89...,\xe2\x80\x89(ak,\xe2\x80\x89bk) is beautiful, if the following statements are fulfilled:   1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b1\xe2\x80\x89<\xe2\x80\x89a2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b2\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89ak\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89bk\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n, where n is a given positive integer;  all numbers b1\xe2\x80\x89-\xe2\x80\x89a1, b2\xe2\x80\x89-\xe2\x80\x89a2, ..., bk\xe2\x80\x89-\xe2\x80\x89ak are distinct. For the given number n find the number of beautiful sequences of length k. As the answer can be rather large, print the remainder after dividing it by 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." 2300

402E "Strictly Positive Matrix" graphs,math "You have matrix a of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89n. Let\'s number the rows of the matrix from 1 to n from top to bottom, let\'s number the columns from 1 to n from left to right. Let\'s use aij to represent the element on the intersection of the i-th row and the j-th column. Matrix a meets the following two conditions:   for any numbers i,\xe2\x80\x89j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i,\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) the following inequality holds: aij\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x890;  . Matrix b is strictly positive, if for any numbers i,\xe2\x80\x89j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i,\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) the inequality bij\xe2\x80\x89>\xe2\x80\x890 holds. You task is to determine if there is such integer k\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x891, that matrix ak is strictly positive." 2200

402D "Upgrading Array" "dp,greedy,math,number theory" "You have an array of positive integers a[1],\xe2\x80\x89a[2],\xe2\x80\x89...,\xe2\x80\x89a[n] and a set of bad prime numbers b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bm. The prime numbers that do not occur in the set b are considered good. The beauty of array a is the sum , where function f(s) is determined as follows:  f(1)\xe2\x80\x89=\xe2\x80\x890;  Let\'s assume that p is the minimum prime divisor of s. If p is a good prime, then , otherwise . You are allowed to perform an arbitrary (probably zero) number of operations to improve array a. The operation of improvement is the following sequence of actions:  Choose some number r (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) and calculate the value g = GCD(a[1],\xe2\x80\x89a[2],\xe2\x80\x89...,\xe2\x80\x89a[r]).  Apply the assignments: , , ..., . What is the maximum beauty of the array you can get?" 1800

402C "Searching for Graph" "brute force,constructive algorithms,graphs" "Let\'s call an undirected graph of n vertices p-interesting, if the following conditions fulfill:   the graph contains exactly 2n\xe2\x80\x89+\xe2\x80\x89p edges;  the graph doesn\'t contain self-loops and multiple edges;  for any integer k (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n), any subgraph consisting of k vertices contains at most 2k\xe2\x80\x89+\xe2\x80\x89p edges. A subgraph of a graph is some set of the graph vertices and some set of the graph edges. At that, the set of edges must meet the condition: both ends of each edge from the set must belong to the chosen set of vertices. Your task is to find a p-interesting graph consisting of n vertices." 1500

402B "Trees in a Row" "brute force,implementation" "The Queen of England has n trees growing in a row in her garden. At that, the i-th (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) tree from the left has height ai meters. Today the Queen decided to update the scenery of her garden. She wants the trees\' heights to meet the condition: for all i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89n), ai\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89-\xe2\x80\x89ai\xe2\x80\x89=\xe2\x80\x89k, where k is the number the Queen chose.Unfortunately, the royal gardener is not a machine and he cannot fulfill the desire of the Queen instantly! In one minute, the gardener can either decrease the height of a tree to any positive integer height or increase the height of a tree to any positive integer height. How should the royal gardener act to fulfill a whim of Her Majesty in the minimum number of minutes?" 1400

402A Nuts greedy,math "You have a nuts and lots of boxes. The boxes have a wonderful feature: if you put x (x\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x890) divisors (the spacial bars that can divide a box) to it, you get a box, divided into x\xe2\x80\x89+\xe2\x80\x891 sections.You are minimalist. Therefore, on the one hand, you are against dividing some box into more than k sections. On the other hand, you are against putting more than v nuts into some section of the box. What is the minimum number of boxes you have to use if you want to put all the nuts in boxes, and you have b divisors?Please note that you need to minimize the number of used boxes, not sections. You do not have to minimize the number of used divisors." 1100

401E "Olympic Games" math "This problem was deleted from the contest, because it was used previously at another competition." 2500

401D "Roman and Numbers" "bitmasks,brute force,combinatorics,dp,number theory" "Roman is a young mathematician, very famous in Uzhland. Unfortunately, Sereja doesn\'t think so. To make Sereja change his mind, Roman is ready to solve any mathematical problem. After some thought, Sereja asked Roma to find, how many numbers are close to number n, modulo m.Number x is considered close to number n modulo m, if:  it can be obtained by rearranging the digits of number n,  it doesn\'t have any leading zeroes,  the remainder after dividing number x by m equals 0. Roman is a good mathematician, but the number of such numbers is too huge for him. So he asks you to help him." 2000

401C Team "constructive algorithms,greedy,implementation" "Now it\'s time of Olympiads. Vanya and Egor decided to make his own team to take part in a programming Olympiad. They\'ve been best friends ever since primary school and hopefully, that can somehow help them in teamwork.For each team Olympiad, Vanya takes his play cards with numbers. He takes only the cards containing numbers 1 and 0. The boys are very superstitious. They think that they can do well at the Olympiad if they begin with laying all the cards in a row so that:  there wouldn\'t be a pair of any side-adjacent cards with zeroes in a row;  there wouldn\'t be a group of three consecutive cards containing numbers one. Today Vanya brought n cards with zeroes and m cards with numbers one. The number of cards was so much that the friends do not know how to put all those cards in the described way. Help them find the required arrangement of the cards or else tell the guys that it is impossible to arrange cards in such a way." 1400

401B "Sereja and Contests" greedy,implementation,math "Sereja is a coder and he likes to take part in Codesorfes rounds. However, Uzhland doesn\'t have good internet connection, so Sereja sometimes skips rounds.Codesorfes has rounds of two types: Div1 (for advanced coders) and Div2 (for beginner coders). Two rounds, Div1 and Div2, can go simultaneously, (Div1 round cannot be held without Div2) in all other cases the rounds don\'t overlap in time. Each round has a unique identifier \xe2\x80\x94 a positive integer. The rounds are sequentially (without gaps) numbered with identifiers by the starting time of the round. The identifiers of rounds that are run simultaneously are different by one, also the identifier of the Div1 round is always greater.Sereja is a beginner coder, so he can take part only in rounds of Div2 type. At the moment he is taking part in a Div2 round, its identifier equals to x. Sereja remembers very well that he has taken part in exactly k rounds before this round. Also, he remembers all identifiers of the rounds he has taken part in and all identifiers of the rounds that went simultaneously with them. Sereja doesn\'t remember anything about the rounds he missed.Sereja is wondering: what minimum and what maximum number of Div2 rounds could he have missed? Help him find these two numbers." 1200

401A "Vanya and Cards" implementation,math "Vanya loves playing. He even has a special set of cards to play with. Each card has a single integer. The number on the card can be positive, negative and can even be equal to zero. The only limit is, the number on each card doesn\'t exceed x in the absolute value.Natasha doesn\'t like when Vanya spends a long time playing, so she hid all of his cards. Vanya became sad and started looking for the cards but he only found n of them. Vanya loves the balance, so he wants the sum of all numbers on found cards equal to zero. On the other hand, he got very tired of looking for cards. Help the boy and say what is the minimum number of cards does he need to find to make the sum equal to zero?You can assume that initially Vanya had infinitely many cards with each integer number from \xe2\x80\x89-\xe2\x80\x89x to x." 800

400E "Inna and Binary Logic" "binary search,bitmasks,data structures" "Inna is fed up with jokes about female logic. So she started using binary logic instead.Inna has an array of n elements a1[1],\xe2\x80\x89a1[2],\xe2\x80\x89...,\xe2\x80\x89a1[n]. Girl likes to train in her binary logic, so she does an exercise consisting of n stages: on the first stage Inna writes out all numbers from array a1, on the i-th (i\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x892) stage girl writes all elements of array ai, which consists of n\xe2\x80\x89-\xe2\x80\x89i\xe2\x80\x89+\xe2\x80\x891 integers; the k-th integer of array ai is defined as follows: ai[k]\xe2\x80\x89=\xe2\x80\x89ai\xe2\x80\x89-\xe2\x80\x891[k]�AND�ai\xe2\x80\x89-\xe2\x80\x891[k\xe2\x80\x89+\xe2\x80\x891]. Here AND is bit-wise binary logical operation.Dima decided to check Inna\'s skill. He asks Inna to change array, perform the exercise and say the sum of all  elements she wrote out during the current exercise.Help Inna to answer the questions!" 2100

400D "Dima and Bacteria" "dsu,graphs,shortest paths" "Dima took up the biology of bacteria, as a result of his experiments, he invented k types of bacteria. Overall, there are n bacteria at his laboratory right now, and the number of bacteria of type i equals ci. For convenience, we will assume that all the bacteria are numbered from 1 to n. The bacteria of type ci are numbered from  to .With the help of special equipment Dima can move energy from some bacteria into some other one. Of course, the use of such equipment is not free. Dima knows m ways to move energy from some bacteria to another one. The way with number i can be described with integers ui, vi and xi mean that this way allows moving energy from bacteria with number ui to bacteria with number vi or vice versa for xi dollars.Dima\'s Chef (Inna) calls the type-distribution correct if there is a way (may be non-direct) to move energy from any bacteria of the particular type to any other bacteria of the same type (between any two bacteria of the same type) for zero cost.As for correct type-distribution the cost of moving the energy depends only on the types of bacteria help Inna to determine is the type-distribution correct? If it is, print the matrix d with size k\xe2\x80\x89\xc3\x97\xe2\x80\x89k. Cell d[i][j] of this matrix must be equal to the minimal possible cost of energy-moving from bacteria with type i to bacteria with type j." 2000

400C "Inna and Huge Candy Matrix" implementation,math "Inna and Dima decided to surprise Sereja. They brought a really huge candy matrix, it\'s big even for Sereja! Let\'s number the rows of the giant matrix from 1 to n from top to bottom and the columns \xe2\x80\x94 from 1 to m, from left to right. We\'ll represent the cell on the intersection of the i-th row and j-th column as (i,\xe2\x80\x89j). Just as is expected, some cells of the giant candy matrix contain candies. Overall the matrix has p candies: the k-th candy is at cell (xk,\xe2\x80\x89yk).The time moved closer to dinner and Inna was already going to eat p of her favourite sweets from the matrix, when suddenly Sereja (for the reason he didn\'t share with anyone) rotated the matrix x times clockwise by 90 degrees. Then he performed the horizontal rotate of the matrix y times. And then he rotated the matrix z times counterclockwise by 90 degrees. The figure below shows how the rotates of the matrix looks like.  Inna got really upset, but Duma suddenly understood two things: the candies didn\'t get damaged and he remembered which cells contained Inna\'s favourite sweets before Sereja\'s strange actions. Help guys to find the new coordinates in the candy matrix after the transformation Sereja made!" 1500

400B "Inna and New Matrix of Candies" "brute force,implementation,schedules" "Inna likes sweets and a game called the ""Candy Matrix"". Today, she came up with the new game ""Candy Matrix 2: Reload"".The field for the new game is a rectangle table of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m. Each line of the table contains one cell with a dwarf figurine, one cell with a candy, the other cells of the line are empty. The game lasts for several moves. During each move the player should choose all lines of the matrix where dwarf is not on the cell with candy and shout ""Let\'s go!"". After that, all the dwarves from the chosen lines start to simultaneously move to the right. During each second, each dwarf goes to the adjacent cell that is located to the right of its current cell. The movement continues until one of the following events occurs:  some dwarf in one of the chosen lines is located in the rightmost cell of his row;  some dwarf in the chosen lines is located in the cell with the candy. The point of the game is to transport all the dwarves to the candy cells.Inna is fabulous, as she came up with such an interesting game. But what about you? Your task is to play this game optimally well. Specifically, you should say by the given game field what minimum number of moves the player needs to reach the goal of the game." 1200

400A "Inna and Choose Options" implementation "There always is something to choose from! And now, instead of ""Noughts and Crosses"", Inna choose a very unusual upgrade of this game. The rules of the game are given below:There is one person playing the game. Before the beginning of the game he puts 12 cards in a row on the table. Each card contains a character: ""X"" or ""O"". Then the player chooses two positive integers a and b (a\xc2\xb7b\xe2\x80\x89=\xe2\x80\x8912), after that he makes a table of size a\xe2\x80\x89\xc3\x97\xe2\x80\x89b from the cards he put on the table as follows: the first b cards form the first row of the table, the second b cards form the second row of the table and so on, the last b cards form the last (number a) row of the table. The player wins if some column of the table contain characters ""X"" on all cards. Otherwise, the player loses.Inna has already put 12 cards on the table in a row. But unfortunately, she doesn\'t know what numbers a and b to choose. Help her win the game: print to her all the possible ways of numbers a,\xe2\x80\x89b that she can choose and win." 1000

399B "Red and Blue Balls" NA "User ainta has a stack of n red and blue balls. He can apply a certain operation which changes the colors of the balls inside the stack.  While the top ball inside the stack is red, pop the ball from the top of the stack.  Then replace the blue ball on the top with a red ball.  And finally push some blue balls to the stack until the stack has total of n balls inside.  �If there are no blue balls inside the stack, ainta can\'t apply this operation. Given the initial state of the stack, ainta wants to know the maximum number of operations he can repeatedly apply." -999

399A Pages implementation "User ainta is making a web site. This time he is going to make a navigation of the pages. In his site, there are n pages numbered by integers from 1 to n. Assume that somebody is on the p-th page now. The navigation will look like this: << p\xe2\x80\x89-\xe2\x80\x89k p\xe2\x80\x89-\xe2\x80\x89k\xe2\x80\x89+\xe2\x80\x891 ... p\xe2\x80\x89-\xe2\x80\x891 (p) p\xe2\x80\x89+\xe2\x80\x891 ... p\xe2\x80\x89+\xe2\x80\x89k\xe2\x80\x89-\xe2\x80\x891 p\xe2\x80\x89+\xe2\x80\x89k >> When someone clicks the button ""<<"" he is redirected to page 1, and when someone clicks the button "">>"" he is redirected to page n. Of course if someone clicks on a number, he is redirected to the corresponding page.There are some conditions in the navigation:  If page 1 is in the navigation, the button ""<<"" must not be printed.  If page n is in the navigation, the button "">>"" must not be printed.  If the page number is smaller than 1 or greater than n, it must not be printed.  �You can see some examples of the navigations. Make a program that prints the navigation." -999

398E "Sorting Permutations" NA "We are given a permutation sequence a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an of numbers from 1 to n. Let\'s assume that in one second, we can choose some disjoint pairs (u1,\xe2\x80\x89v1),\xe2\x80\x89(u2,\xe2\x80\x89v2),\xe2\x80\x89...,\xe2\x80\x89(uk,\xe2\x80\x89vk) and swap all aui and avi for every i at the same time (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ui\xe2\x80\x89<\xe2\x80\x89vi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n). The pairs are disjoint if every ui and vj are different from each other.We want to sort the sequence completely in increasing order as fast as possible. Given the initial permutation, calculate the number of ways to achieve this. Two ways are different if and only if there is a time t, such that the set of pairs used for swapping at that time are different as sets (so ordering of pairs doesn\'t matter). If the given permutation is already sorted, it takes no time to sort, so the number of ways to sort it is 1.To make the problem more interesting, we have k holes inside the permutation. So exactly k numbers of a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an are not yet determined. For every possibility of filling the holes, calculate the number of ways, and print the total sum of these values modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." -999

398D "Instant Messanger" "data structures" "User ainta decided to make a new instant messenger called ""aintalk"". With aintalk, each user can chat with other people. User ainta made the prototype of some functions to implement this thing.  login(u): User u logins into aintalk and becomes online.  logout(u): User u logouts and becomes offline.  add_friend(u, v): User u and user v become friends. It means, u and v can talk with each other. The friendship is bidirectional.  del_friend(u, v): Unfriend user u and user v. It means, u and v cannot talk with each other from then.  count_online_friends(u): The function returns the number of friends of user u who are online at the moment.  �Because the messenger is being tested by some users numbered from 1 to n, there is no register method. This means, at the beginning, some users may be online, and some users may have friends.User ainta is going to make these functions, but before making the messenger public, he wants to know whether he is correct. Help ainta verify his code." -999

398C "Tree and Array" "constructive algorithms" "User ainta likes trees. This time he is going to make an undirected tree with n vertices numbered by integers from 1 to n. The tree is weighted, so each edge of the tree will have some integer weight.Also he has an array t: t[1],\xe2\x80\x89t[2],\xe2\x80\x89...,\xe2\x80\x89t[n]. At first all the elements of the array are initialized to 0. Then for each edge connecting vertices u and v (u\xe2\x80\x89<\xe2\x80\x89v) of the tree with weight c, ainta adds value c to the elements t[u],\xe2\x80\x89t[u\xe2\x80\x89+\xe2\x80\x891],\xe2\x80\x89...,\xe2\x80\x89t[v\xe2\x80\x89-\xe2\x80\x891],\xe2\x80\x89t[v] of array t.Let\'s assume that d(u,\xe2\x80\x89v) is the total weight of edges on the shortest path between vertex u and vertex v. User ainta calls a pair of integers x,\xe2\x80\x89y (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89<\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) good if and only if d(x,\xe2\x80\x89y)\xe2\x80\x89=\xe2\x80\x89t[x]\xe2\x80\x89+\xe2\x80\x89t[x\xe2\x80\x89+\xe2\x80\x891]\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89t[y\xe2\x80\x89-\xe2\x80\x891]\xe2\x80\x89+\xe2\x80\x89t[y].User ainta wants to make at least  good pairs, but he couldn\'t make a proper tree. Help ainta to find such a tree." -999

398B "Painting The Wall" dp,probabilities "User ainta decided to paint a wall. The wall consists of n2 tiles, that are arranged in an n\xe2\x80\x89\xc3\x97\xe2\x80\x89n table. Some tiles are painted, and the others are not. As he wants to paint it beautifully, he will follow the rules below.  Firstly user ainta looks at the wall. If there is at least one painted cell on each row and at least one painted cell on each column, he stops coloring. Otherwise, he goes to step 2.  User ainta choose any tile on the wall with uniform probability.  If the tile he has chosen is not painted, he paints the tile. Otherwise, he ignores it.  Then he takes a rest for one minute even if he doesn\'t paint the tile. And then ainta goes to step 1.  �However ainta is worried if it would take too much time to finish this work. So he wants to calculate the expected time needed to paint the wall by the method above. Help him find the expected time. You can assume that choosing and painting any tile consumes no time at all." -999

398A Cards "constructive algorithms,implementation" "User ainta loves to play with cards. He has a cards containing letter ""o"" and b cards containing letter ""x"". He arranges the cards in a row, and calculates the score of the deck by the formula below.  At first, the score is 0.  For each block of contiguous ""o""s with length x the score increases by x2.  For each block of contiguous ""x""s with length y the score decreases by y2.  �For example, if a\xe2\x80\x89=\xe2\x80\x896,\xe2\x80\x89b\xe2\x80\x89=\xe2\x80\x893 and ainta have arranged the cards in the order, that is described by string ""ooxoooxxo"", the score of the deck equals 22\xe2\x80\x89-\xe2\x80\x8912\xe2\x80\x89+\xe2\x80\x8932\xe2\x80\x89-\xe2\x80\x8922\xe2\x80\x89+\xe2\x80\x8912\xe2\x80\x89=\xe2\x80\x899. That is because the deck has 5 blocks in total: ""oo"", ""x"", ""ooo"", ""xx"", ""o"".User ainta likes big numbers, so he wants to maximize the score with the given cards. Help ainta make the score as big as possible. Note, that he has to arrange all his cards." -999

397B "On Corruption and Numbers" "constructive algorithms,implementation,math" "Alexey, a merry Berland entrant, got sick of the gray reality and he zealously wants to go to university. There are a lot of universities nowadays, so Alexey is getting lost in the diversity \xe2\x80\x94 he has not yet decided what profession he wants to get. At school, he had bad grades in all subjects, and it\'s only thanks to wealthy parents that he was able to obtain the graduation certificate.The situation is complicated by the fact that each high education institution has the determined amount of voluntary donations, paid by the new students for admission \xe2\x80\x94 ni berubleys. He cannot pay more than ni, because then the difference between the paid amount and ni can be regarded as a bribe!Each rector is wearing the distinctive uniform of his university. Therefore, the uniform\'s pockets cannot contain coins of denomination more than ri. The rector also does not carry coins of denomination less than li in his pocket \xe2\x80\x94 because if everyone pays him with so small coins, they gather a lot of weight and the pocket tears. Therefore, a donation can be paid only by coins of denomination x berubleys, where li\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ri (Berland uses coins of any positive integer denomination). Alexey can use the coins of different denominations and he can use the coins of the same denomination any number of times. When Alexey was first confronted with such orders, he was puzzled because it turned out that not all universities can accept him! Alexey is very afraid of going into the army (even though he had long wanted to get the green uniform, but his dad says that the army bullies will beat his son and he cannot pay to ensure the boy\'s safety). So, Alexey wants to know for sure which universities he can enter so that he could quickly choose his alma mater.Thanks to the parents, Alexey is not limited in money and we can assume that he has an unlimited number of coins of each type.In other words, you are given t requests, each of them contains numbers ni,\xe2\x80\x89li,\xe2\x80\x89ri. For each query you need to answer, whether it is possible to gather the sum of exactly ni berubleys using only coins with an integer denomination from li to ri berubleys. You can use coins of different denominations. Coins of each denomination can be used any number of times." -999

397A "On Segment\'s Own Points" implementation "Alexey, a merry Berland entrant, got sick of the gray reality and he zealously wants to go to university. There are a lot of universities nowadays, so Alexey is getting lost in the diversity \xe2\x80\x94 he has not yet decided what profession he wants to get. At school, he had bad grades in all subjects, and it\'s only thanks to wealthy parents that he was able to obtain the graduation certificate.The situation is complicated by the fact that each high education institution has the determined amount of voluntary donations, paid by the new students for admission \xe2\x80\x94 ni berubleys. He cannot pay more than ni, because then the difference between the paid amount and ni can be regarded as a bribe!Each rector is wearing the distinctive uniform of his university. Therefore, the uniform\'s pockets cannot contain coins of denomination more than ri. The rector also does not carry coins of denomination less than li in his pocket \xe2\x80\x94 because if everyone pays him with so small coins, they gather a lot of weight and the pocket tears. Therefore, a donation can be paid only by coins of denomination x berubleys, where li\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ri (Berland uses coins of any positive integer denomination). Alexey can use the coins of different denominations and he can use the coins of the same denomination any number of times. When Alexey was first confronted with such orders, he was puzzled because it turned out that not all universities can accept him! Alexey is very afraid of going into the army (even though he had long wanted to get the green uniform, but his dad says that the army bullies will beat his son and he cannot pay to ensure the boy\'s safety). So, Alexey wants to know for sure which universities he can enter so that he could quickly choose his alma mater.Thanks to the parents, Alexey is not limited in money and we can assume that he has an unlimited number of coins of each type.In other words, you are given t requests, each of them contains numbers ni,\xe2\x80\x89li,\xe2\x80\x89ri. For each query you need to answer, whether it is possible to gather the sum of exactly ni berubleys using only coins with an integer denomination from li to ri berubleys. You can use coins of different denominations. Coins of each denomination can be used any number of times." -999

396E "On Iteration of One Well-Known Function" math "Of course, many of you can calculate \xcf\x86(n) \xe2\x80\x94 the number of positive integers that are less than or equal to n, that are coprime with n. But what if we need to calculate \xcf\x86(\xcf\x86(...\xcf\x86(n))), where function \xcf\x86 is taken k times and n is given in the canonical decomposition into prime factors? You are given n and k, calculate the value of \xcf\x86(\xcf\x86(...\xcf\x86(n))). Print the result in the canonical decomposition into prime factors." -999

396D "On Sum of Number of Inversions in Permutations" combinatorics,math "You are given a permutation p. Calculate the total number of inversions in all permutations that lexicographically do not exceed the given one.As this number can be very large, print it modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." -999

396C "On Changing Tree" "data structures,graphs,trees" "You are given a rooted tree consisting of n vertices numbered from 1 to n. The root of the tree is a vertex number 1.Initially all vertices contain number 0. Then come q queries, each query has one of the two types:  The format of the query: 1 v x k. In response to the query, you need to add to the number at vertex v number x; to the numbers at the descendants of vertex v at distance 1, add x\xe2\x80\x89-\xe2\x80\x89k; and so on, to the numbers written in the descendants of vertex v at distance i, you need to add x\xe2\x80\x89-\xe2\x80\x89(i\xc2\xb7k). The distance between two vertices is the number of edges in the shortest path between these vertices.  The format of the query: 2 v. In reply to the query you should print the number written in vertex v modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897). Process the queries given in the input." -999

396B "On Sum of Fractions" "math,number theory" "Let\'s assume that   v(n) is the largest prime number, that does not exceed n; u(n) is the smallest prime number strictly greater than n. Find ." -999

396A "On Number of Decompositions into Multipliers" "combinatorics,math,number theory" "You are given an integer m as a product of integers a1,\xe2\x80\x89a2,\xe2\x80\x89... an . Your task is to find the number of distinct decompositions of number m into the product of n ordered positive integers.Decomposition into n products, given in the input, must also be considered in the answer. As the answer can be very large, print it modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." -999

394E "Lightbulb for Minister" geometry "The Minister for education is coming! Naturally, nobody wants to perform poorly in front of such a honored guest. However, two hours before the arrival it turned out that one of the classes has a malfunctioning lightbulb \xe2\x80\x94 for some reason it doesn\'t get enough energy. The solution was found quickly: all we\'ve got to do is to change the location of the lightbulb so that it got the maximum amount of energy.Everybody knows that the power of the lightbulb equals , where C is some constant value and ri is the Euclidean distance from the bulb to the i-th generator. Consequently, our task is to minimize . Of course, we know the positions of all generators.The bulb should be on the ceiling of the class. The ceiling of the class is in the form of a strictly convex m-gon (the class itself has the form of a right prism with a strictly convex m-gon at the bottom). Help to find the optimum location for the bulb. Assume that all generators are in the plane of the class ceiling. Consider that the plane of the class ceiling has some Cartesian coordinate system introduced." -999

394D "Physical Education and Buns" "brute force,implementation,math" "The Physical education teacher at SESC is a sort of mathematician too. His most favorite topic in mathematics is progressions. That is why the teacher wants the students lined up in non-decreasing height form an arithmetic progression.To achieve the goal, the gym teacher ordered a lot of magical buns from the dining room. The magic buns come in two types: when a student eats one magic bun of the first type, his height increases by one, when the student eats one magical bun of the second type, his height decreases by one. The physical education teacher, as expected, cares about the health of his students, so he does not want them to eat a lot of buns. More precisely, he wants the maximum number of buns eaten by some student to be minimum.Help the teacher, get the maximum number of buns that some pupils will have to eat to achieve the goal of the teacher. Also, get one of the possible ways for achieving the objective, namely, the height of the lowest student in the end and the step of the resulting progression." -999

394C Dominoes "constructive algorithms,greedy" "During the break, we decided to relax and play dominoes. Our box with Domino was empty, so we decided to borrow the teacher\'s dominoes.The teacher responded instantly at our request. He put nm dominoes on the table as an n\xe2\x80\x89\xc3\x97\xe2\x80\x892m rectangle so that each of the n rows contained m dominoes arranged horizontally. Each half of each domino contained number (0 or 1).We were taken aback, and the teacher smiled and said: ""Consider some arrangement of dominoes in an n\xe2\x80\x89\xc3\x97\xe2\x80\x892m matrix. Let\'s count for each column of the matrix the sum of numbers in this column. Then among all such sums find the maximum one. Can you rearrange the dominoes in the matrix in such a way that the maximum sum will be minimum possible? Note that it is prohibited to change the orientation of the dominoes, they all need to stay horizontal, nevertheless dominoes are allowed to rotate by 180 degrees. As a reward I will give you all my dominoes"".We got even more taken aback. And while we are wondering what was going on, help us make an optimal matrix of dominoes." -999

394B "Very Beautiful Number" math "Teacher thinks that we make a lot of progress. Now we are even allowed to use decimal notation instead of counting sticks. After the test the teacher promised to show us a ""very beautiful number"". But the problem is, he\'s left his paper with the number in the teachers\' office.The teacher remembers that the ""very beautiful number"" was strictly positive, didn\'t contain any leading zeroes, had the length of exactly p decimal digits, and if we move the last digit of the number to the beginning, it grows exactly x times. Besides, the teacher is sure that among all such numbers the ""very beautiful number"" is minimal possible.The teachers\' office isn\'t near and the teacher isn\'t young. But we\'ve passed the test and we deserved the right to see the ""very beautiful number"". Help to restore the justice, find the ""very beautiful number"" for us!" -999

394A "Counting Sticks" "brute force,implementation" "When new students come to the Specialized Educational and Scientific Centre (SESC) they need to start many things from the beginning. Sometimes the teachers say (not always unfairly) that we cannot even count. So our teachers decided to teach us arithmetics from the start. And what is the best way to teach students add and subtract? \xe2\x80\x94 That\'s right, using counting sticks! An here\'s our new task: An expression of counting sticks is an expression of type:[ A sticks][sign +][B sticks][sign =][C sticks] (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89A,\xe2\x80\x89B,\xe2\x80\x89C).  Sign + consists of two crossed sticks: one vertical and one horizontal. Sign = consists of two horizontal sticks. The expression is arithmetically correct if A\xe2\x80\x89+\xe2\x80\x89B\xe2\x80\x89=\xe2\x80\x89C.We\'ve got an expression that looks like A\xe2\x80\x89+\xe2\x80\x89B\xe2\x80\x89=\xe2\x80\x89C given by counting sticks. Our task is to shift at most one stick (or we can shift nothing) so that the expression became arithmetically correct. Note that we cannot remove the sticks from the expression, also we cannot shift the sticks from the signs + and =.We really aren\'t fabulous at arithmetics. Can you help us?" -999

393B "Three matrices" NA "Chubby Yang is studying linear equations right now. He came up with a nice problem. In the problem you are given an n\xe2\x80\x89\xc3\x97\xe2\x80\x89n matrix W, consisting of integers, and you should find two n\xe2\x80\x89\xc3\x97\xe2\x80\x89n matrices A and B, all the following conditions must hold:   Aij\xe2\x80\x89=\xe2\x80\x89Aji, for all i,\xe2\x80\x89j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i,\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n);  Bij\xe2\x80\x89=\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x89Bji, for all i,\xe2\x80\x89j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i,\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n);  Wij\xe2\x80\x89=\xe2\x80\x89Aij\xe2\x80\x89+\xe2\x80\x89Bij, for all i,\xe2\x80\x89j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i,\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n). Can you solve the problem?" -999

393A Nineteen NA "Alice likes word ""nineteen"" very much. She has a string s and wants the string to contain as many such words as possible. For that reason she can rearrange the letters of the string.For example, if she has string ""xiineteenppnnnewtnee"", she can get string ""xnineteenppnineteenw"", containing (the occurrences marked) two such words. More formally, word ""nineteen"" occurs in the string the number of times you can read it starting from some letter of the string. Of course, you shouldn\'t skip letters.Help her to find the maximum number of ""nineteen""s that she can get in her string." -999

392E "Deleting Substrings" NA "SmallR likes a game called ""Deleting Substrings"". In the game you are given a sequence of integers w, you can modify the sequence and get points. The only type of modification you can perform is (unexpected, right?) deleting substrings. More formally, you can choose several contiguous elements of w and delete them from the sequence. Let\'s denote the sequence of chosen elements as wl,\xe2\x80\x89wl\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89wr. They must meet the conditions:  the equality |wi\xe2\x80\x89-\xe2\x80\x89wi\xe2\x80\x89+\xe2\x80\x891|\xe2\x80\x89=\xe2\x80\x891 must hold for all i (l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89r);  the inequality 2\xc2\xb7wi\xe2\x80\x89-\xe2\x80\x89wi\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89-\xe2\x80\x89wi\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x890 must hold for all i (l\xe2\x80\x89<\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89r). After deleting the chosen substring of w, you gain vr\xe2\x80\x89-\xe2\x80\x89l\xe2\x80\x89+\xe2\x80\x891 points. You can perform the described operation again and again while proper substrings exist. Also you can end the game at any time. Your task is to calculate the maximum total score you can get in the game." -999

392D "Three Arrays" "data structures" "There are three arrays a, b and c. Each of them consists of n integers. SmallY wants to find three integers u, v, w (0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89u,\xe2\x80\x89v,\xe2\x80\x89w\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) such that the following condition holds: each number that appears in the union of a, b and c, appears either in the first u elements of a, or in the first v elements of b, or in the first w elements of c. Of course, SmallY doesn\'t want to have huge numbers u, v and w, so she wants sum u\xe2\x80\x89+\xe2\x80\x89v\xe2\x80\x89+\xe2\x80\x89w to be as small as possible.Please, help her to find the minimal possible sum of u\xe2\x80\x89+\xe2\x80\x89v\xe2\x80\x89+\xe2\x80\x89w." -999

392C "Yet Another Number Sequence" combinatorics,math,matrices "Everyone knows what the Fibonacci sequence is. This sequence can be defined by the recurrence relation: F1\xe2\x80\x89=\xe2\x80\x891,\xe2\x80\x89F2\xe2\x80\x89=\xe2\x80\x892,\xe2\x80\x89Fi\xe2\x80\x89=\xe2\x80\x89Fi\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x89Fi\xe2\x80\x89-\xe2\x80\x892�(i\xe2\x80\x89>\xe2\x80\x892).We\'ll define a new number sequence Ai(k) by the formula: Ai(k)\xe2\x80\x89=\xe2\x80\x89Fi\xe2\x80\x89\xc3\x97\xe2\x80\x89ik�(i\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x891).In this problem, your task is to calculate the following sum: A1(k)\xe2\x80\x89+\xe2\x80\x89A2(k)\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89An(k). The answer can be very large, so print it modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." -999

392B "Tower of Hanoi" dp "The Tower of Hanoi is a well-known mathematical puzzle. It consists of three rods, and a number of disks of different sizes which can slide onto any rod. The puzzle starts with the disks in a neat stack in ascending order of size on one rod, the smallest at the top, thus making a conical shape.The objective of the puzzle is to move the entire stack to another rod, obeying the following simple rules:   Only one disk can be moved at a time.  Each move consists of taking the upper disk from one of the stacks and placing it on top of another stack i.e. a disk can only be moved if it is the uppermost disk on a stack.  No disk may be placed on top of a smaller disk. With three disks, the puzzle can be solved in seven moves. The minimum number of moves required to solve a Tower of Hanoi puzzle is 2n\xe2\x80\x89-\xe2\x80\x891, where n is the number of disks. (c) Wikipedia.SmallY\'s puzzle is very similar to the famous Tower of Hanoi. In the Tower of Hanoi puzzle you need to solve a puzzle in minimum number of moves, in SmallY\'s puzzle each move costs some money and you need to solve the same puzzle but for minimal cost. At the beginning of SmallY\'s puzzle all n disks are on the first rod. Moving a disk from rod i to rod j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i,\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x893) costs tij units of money. The goal of the puzzle is to move all the disks to the third rod.In the problem you are given matrix t and an integer n. You need to count the minimal cost of solving SmallY\'s puzzle, consisting of n disks." -999

392A "Blocked Points" math "Imagine you have an infinite 2D plane with Cartesian coordinate system. Some of the integral points are blocked, and others are not. Two integral points A and B on the plane are 4-connected if and only if:  the Euclidean distance between A and B is one unit and neither A nor B is blocked;  or there is some integral point C, such that A is 4-connected with C, and C is 4-connected with B. Let\'s assume that the plane doesn\'t contain blocked points. Consider all the integral points of the plane whose Euclidean distance from the origin is no more than n, we\'ll name these points special. Chubby Yang wants to get the following property: no special point is 4-connected to some non-special point. To get the property she can pick some integral points of the plane and make them blocked. What is the minimum number of points she needs to pick?" -999

391F3 "Stock Trading" NA "This problem consists of three subproblems: for solving subproblem F1 you will receive 8 points, for solving subproblem F2 you will receive 15 points, and for solving subproblem F3 you will receive 10 points.Manao has developed a model to predict the stock price of a company over the next n days and wants to design a profit-maximizing trading algorithm to make use of these predictions. Unfortunately, Manao\'s trading account has the following restrictions:   It only allows owning either zero or one shares of stock at a time;  It only allows buying or selling a share of this stock once per day;  It allows a maximum of k buy orders over the next n days; For the purposes of this problem, we define a trade to a be the act of buying one share of stock on day i, then holding the stock until some day j\xe2\x80\x89>\xe2\x80\x89i at which point the share is sold. To restate the above constraints, Manao is permitted to make at most k non-overlapping trades during the course of an n-day trading period for which Manao\'s model has predictions about the stock price.Even though these restrictions limit the amount of profit Manao can make compared to what would be achievable with an unlimited number of trades or the ability to hold more than one share at a time, Manao still has the potential to make a lot of money because Manao\'s model perfectly predicts the daily price of the stock. For example, using this model, Manao could wait until the price is low, then buy one share and hold until the price reaches a high value, then sell for a profit, and repeat this process up to k times until n days have passed.Nevertheless, Manao is not satisfied by having a merely good trading algorithm, and wants to develop an optimal strategy for trading subject to these constraints. Help Manao achieve this goal by writing a program that will determine when to buy and sell stock to achieve the greatest possible profit during the n-day trading period subject to the above constraints." -999

391F2 "Stock Trading" greedy "This problem consists of three subproblems: for solving subproblem F1 you will receive 8 points, for solving subproblem F2 you will receive 15 points, and for solving subproblem F3 you will receive 10 points.Manao has developed a model to predict the stock price of a company over the next n days and wants to design a profit-maximizing trading algorithm to make use of these predictions. Unfortunately, Manao\'s trading account has the following restrictions:   It only allows owning either zero or one shares of stock at a time;  It only allows buying or selling a share of this stock once per day;  It allows a maximum of k buy orders over the next n days; For the purposes of this problem, we define a trade to a be the act of buying one share of stock on day i, then holding the stock until some day j\xe2\x80\x89>\xe2\x80\x89i at which point the share is sold. To restate the above constraints, Manao is permitted to make at most k non-overlapping trades during the course of an n-day trading period for which Manao\'s model has predictions about the stock price.Even though these restrictions limit the amount of profit Manao can make compared to what would be achievable with an unlimited number of trades or the ability to hold more than one share at a time, Manao still has the potential to make a lot of money because Manao\'s model perfectly predicts the daily price of the stock. For example, using this model, Manao could wait until the price is low, then buy one share and hold until the price reaches a high value, then sell for a profit, and repeat this process up to k times until n days have passed.Nevertheless, Manao is not satisfied by having a merely good trading algorithm, and wants to develop an optimal strategy for trading subject to these constraints. Help Manao achieve this goal by writing a program that will determine when to buy and sell stock to achieve the greatest possible profit during the n-day trading period subject to the above constraints." -999

391F1 "Stock Trading" dp "This problem consists of three subproblems: for solving subproblem F1 you will receive 8 points, for solving subproblem F2 you will receive 15 points, and for solving subproblem F3 you will receive 10 points.Manao has developed a model to predict the stock price of a company over the next n days and wants to design a profit-maximizing trading algorithm to make use of these predictions. Unfortunately, Manao\'s trading account has the following restrictions:   It only allows owning either zero or one shares of stock at a time;  It only allows buying or selling a share of this stock once per day;  It allows a maximum of k buy orders over the next n days; For the purposes of this problem, we define a trade to a be the act of buying one share of stock on day i, then holding the stock until some day j\xe2\x80\x89>\xe2\x80\x89i at which point the share is sold. To restate the above constraints, Manao is permitted to make at most k non-overlapping trades during the course of an n-day trading period for which Manao\'s model has predictions about the stock price.Even though these restrictions limit the amount of profit Manao can make compared to what would be achievable with an unlimited number of trades or the ability to hold more than one share at a time, Manao still has the potential to make a lot of money because Manao\'s model perfectly predicts the daily price of the stock. For example, using this model, Manao could wait until the price is low, then buy one share and hold until the price reaches a high value, then sell for a profit, and repeat this process up to k times until n days have passed.Nevertheless, Manao is not satisfied by having a merely good trading algorithm, and wants to develop an optimal strategy for trading subject to these constraints. Help Manao achieve this goal by writing a program that will determine when to buy and sell stock to achieve the greatest possible profit during the n-day trading period subject to the above constraints." -999

391E2 "Three Trees" NA "This problem consists of two subproblems: for solving subproblem E1 you will receive 11 points, and for solving subproblem E2 you will receive 13 points.A tree is an undirected connected graph containing no cycles. The distance between two nodes in an unweighted tree is the minimum number of edges that have to be traversed to get from one node to another.You are given 3 trees that have to be united into a single tree by adding two edges between these trees. Each of these edges can connect any pair of nodes from two trees. After the trees are connected, the distances between all unordered pairs of nodes in the united tree should be computed. What is the maximum possible value of the sum of these distances?" -999

391E1 "Three Trees" NA "This problem consists of two subproblems: for solving subproblem E1 you will receive 11 points, and for solving subproblem E2 you will receive 13 points.A tree is an undirected connected graph containing no cycles. The distance between two nodes in an unweighted tree is the minimum number of edges that have to be traversed to get from one node to another.You are given 3 trees that have to be united into a single tree by adding two edges between these trees. Each of these edges can connect any pair of nodes from two trees. After the trees are connected, the distances between all unordered pairs of nodes in the united tree should be computed. What is the maximum possible value of the sum of these distances?" -999

391D2 Supercollider "data structures" "This problem consists of two subproblems: for solving subproblem D1 you will receive 3 points, and for solving subproblem D2 you will receive 16 points.Manao is the chief architect involved in planning a new supercollider. He has to identify a plot of land where the largest possible supercollider can be built. The supercollider he is building requires four-way orthogonal collisions of particles traveling at the same speed, so it will consist of four accelerating chambers and be shaped like a plus sign (i.e., +). Each of the four accelerating chambers must be the same length and must be aligned with the Earth\'s magnetic field (parallel or orthogonal) to minimize interference.The accelerating chambers need to be laid down across long flat stretches of land to keep costs under control. Thus, Manao has already commissioned a topographical study that has identified all possible maximal length tracts of land available for building accelerating chambers that are either parallel or orthogonal to the Earth\'s magnetic field. To build the largest possible supercollider, Manao must identify the largest symmetric plus shape from among these candidate tracts. That is, he must find the two tracts of land that form an axis-aligned plus shape with the largest distance from the center of the plus to the tip of the shortest of the four arms of the plus. Note that the collider need not use the entire length of the tracts identified (see the example in the notes)." -999

391D1 Supercollider "brute force" "This problem consists of two subproblems: for solving subproblem D1 you will receive 3 points, and for solving subproblem D2 you will receive 16 points.Manao is the chief architect involved in planning a new supercollider. He has to identify a plot of land where the largest possible supercollider can be built. The supercollider he is building requires four-way orthogonal collisions of particles traveling at the same speed, so it will consist of four accelerating chambers and be shaped like a plus sign (i.e., +). Each of the four accelerating chambers must be the same length and must be aligned with the Earth\'s magnetic field (parallel or orthogonal) to minimize interference.The accelerating chambers need to be laid down across long flat stretches of land to keep costs under control. Thus, Manao has already commissioned a topographical study that has identified all possible maximal length tracts of land available for building accelerating chambers that are either parallel or orthogonal to the Earth\'s magnetic field. To build the largest possible supercollider, Manao must identify the largest symmetric plus shape from among these candidate tracts. That is, he must find the two tracts of land that form an axis-aligned plus shape with the largest distance from the center of the plus to the tip of the shortest of the four arms of the plus. Note that the collider need not use the entire length of the tracts identified (see the example in the notes)." -999

391C3 "The Tournament" NA "This problem consists of three subproblems: for solving subproblem C1 you will receive 4 points, for solving subproblem C2 you will receive 4 points, and for solving subproblem C3 you will receive 8 points.Manao decided to pursue a fighter\'s career. He decided to begin with an ongoing tournament. Before Manao joined, there were n contestants in the tournament, numbered from 1 to n. Each of them had already obtained some amount of tournament points, namely the i-th fighter had pi points.Manao is going to engage in a single fight against each contestant. Each of Manao\'s fights ends in either a win or a loss. A win grants Manao one point, and a loss grants Manao\'s opponent one point. For each i, Manao estimated the amount of effort ei he needs to invest to win against the i-th contestant. Losing a fight costs no effort.After Manao finishes all of his fights, the ranklist will be determined, with 1 being the best rank and n\xe2\x80\x89+\xe2\x80\x891 being the worst. The contestants will be ranked in descending order of their tournament points. The contestants with the same number of points as Manao will be ranked better than him if they won the match against him and worse otherwise. The exact mechanism of breaking ties for other fighters is not relevant here.Manao\'s objective is to have rank k or better. Determine the minimum total amount of effort he needs to invest in order to fulfill this goal, if it is possible." -999

391C2 "The Tournament" greedy "This problem consists of three subproblems: for solving subproblem C1 you will receive 4 points, for solving subproblem C2 you will receive 4 points, and for solving subproblem C3 you will receive 8 points.Manao decided to pursue a fighter\'s career. He decided to begin with an ongoing tournament. Before Manao joined, there were n contestants in the tournament, numbered from 1 to n. Each of them had already obtained some amount of tournament points, namely the i-th fighter had pi points.Manao is going to engage in a single fight against each contestant. Each of Manao\'s fights ends in either a win or a loss. A win grants Manao one point, and a loss grants Manao\'s opponent one point. For each i, Manao estimated the amount of effort ei he needs to invest to win against the i-th contestant. Losing a fight costs no effort.After Manao finishes all of his fights, the ranklist will be determined, with 1 being the best rank and n\xe2\x80\x89+\xe2\x80\x891 being the worst. The contestants will be ranked in descending order of their tournament points. The contestants with the same number of points as Manao will be ranked better than him if they won the match against him and worse otherwise. The exact mechanism of breaking ties for other fighters is not relevant here.Manao\'s objective is to have rank k or better. Determine the minimum total amount of effort he needs to invest in order to fulfill this goal, if it is possible." -999

391C1 "The Tournament" "brute force" "This problem consists of three subproblems: for solving subproblem C1 you will receive 4 points, for solving subproblem C2 you will receive 4 points, and for solving subproblem C3 you will receive 8 points.Manao decided to pursue a fighter\'s career. He decided to begin with an ongoing tournament. Before Manao joined, there were n contestants in the tournament, numbered from 1 to n. Each of them had already obtained some amount of tournament points, namely the i-th fighter had pi points.Manao is going to engage in a single fight against each contestant. Each of Manao\'s fights ends in either a win or a loss. A win grants Manao one point, and a loss grants Manao\'s opponent one point. For each i, Manao estimated the amount of effort ei he needs to invest to win against the i-th contestant. Losing a fight costs no effort.After Manao finishes all of his fights, the ranklist will be determined, with 1 being the best rank and n\xe2\x80\x89+\xe2\x80\x891 being the worst. The contestants will be ranked in descending order of their tournament points. The contestants with the same number of points as Manao will be ranked better than him if they won the match against him and worse otherwise. The exact mechanism of breaking ties for other fighters is not relevant here.Manao\'s objective is to have rank k or better. Determine the minimum total amount of effort he needs to invest in order to fulfill this goal, if it is possible." -999

391B "Word Folding" "brute force" "You will receive 5 points for solving this problem.Manao has invented a new operation on strings that is called folding. Each fold happens between a pair of consecutive letters and places the second part of the string above first part, running in the opposite direction and aligned to the position of the fold. Using this operation, Manao converts the string into a structure that has one more level than there were fold operations performed. See the following examples for clarity.We will denote the positions of folds with \'|\' characters. For example, the word ""ABRACADABRA"" written as ""AB|RACA|DAB|RA"" indicates that it has been folded three times: first, between the leftmost pair of \'B\' and \'R\' letters; second, between \'A\' and \'D\'; and third, between the rightmost pair of \'B\' and \'R\' letters. Here are several examples of folded strings:""ABCDEF|GHIJK"" |  ""A|BCDEFGHIJK"" |  ""AB|RACA|DAB|RA"" |  ""X|XXXXX|X|X|XXXXXX""               |                 |                   |       XXXXXX    KJIHG      |   KJIHGFEDCB    |      AR           |       X   ABCDEF      |            A    |     DAB           |       X               |                 |     ACAR          |       XXXXX               |                 |       AB          |           XOne last example for ""ABCD|EFGH|IJ|K"":  KIJHGFEABCDManao noticed that each folded string can be viewed as several piles of letters. For instance, in the previous example, there are four piles, which can be read as ""AHI"", ""BGJK"", ""CF"", and ""DE"" from bottom to top. Manao wonders what is the highest pile of identical letters he can build using fold operations on a given word. Note that the pile should not contain gaps and should start at the bottom level. For example, in the rightmost of the four examples above, none of the piles would be considered valid since each of them has gaps, starts above the bottom level, or both." -999

391A "Genetic Engineering" "implementation,two pointers" "You will receive 3 points for solving this problem.Manao is designing the genetic code for a new type of algae to efficiently produce fuel. Specifically, Manao is focusing on a stretch of DNA that encodes one protein. The stretch of DNA is represented by a string containing only the characters \'A\', \'T\', \'G\' and \'C\'.Manao has determined that if the stretch of DNA contains a maximal sequence of consecutive identical nucleotides that is of even length, then the protein will be nonfunctional. For example, consider a protein described by DNA string ""GTTAAAG"". It contains four maximal sequences of consecutive identical nucleotides: ""G"", ""TT"", ""AAA"", and ""G"". The protein is nonfunctional because sequence ""TT"" has even length.Manao is trying to obtain a functional protein from the protein he currently has. Manao can insert additional nucleotides into the DNA stretch. Each additional nucleotide is a character from the set {\'A\', \'T\', \'G\', \'C\'}. Manao wants to determine the minimum number of insertions necessary to make the DNA encode a functional protein." -999

390E "Inna and Large Sweet Matrix" NA "Inna loves sweets very much. That\'s why she wants to play the ""Sweet Matrix"" game with Dima and Sereja. But Sereja is a large person, so the game proved small for him. Sereja suggested playing the ""Large Sweet Matrix"" game.The ""Large Sweet Matrix"" playing field is an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m matrix. Let\'s number the rows of the matrix from 1 to n, and the columns \xe2\x80\x94 from 1 to m. Let\'s denote the cell in the i-th row and j-th column as (i,\xe2\x80\x89j). Each cell of the matrix can contain multiple candies, initially all cells are empty. The game goes in w moves, during each move one of the two following events occurs:  Sereja chooses five integers x1,\xe2\x80\x89y1,\xe2\x80\x89x2,\xe2\x80\x89y2,\xe2\x80\x89v (x1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x2,\xe2\x80\x89y1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y2) and adds v candies to each matrix cell (i,\xe2\x80\x89j) (x1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x2;�y1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y2).  Sereja chooses four integers x1,\xe2\x80\x89y1,\xe2\x80\x89x2,\xe2\x80\x89y2 (x1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x2,\xe2\x80\x89y1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y2). Then he asks Dima to calculate the total number of candies in cells (i,\xe2\x80\x89j) (x1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x2;�y1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y2) and he asks Inna to calculate the total number of candies in the cells of matrix (p,\xe2\x80\x89q), which meet the following logical criteria: (p\xe2\x80\x89<\xe2\x80\x89x1 OR p\xe2\x80\x89>\xe2\x80\x89x2) AND (q\xe2\x80\x89<\xe2\x80\x89y1 OR q\xe2\x80\x89>\xe2\x80\x89y2). Finally, Sereja asks to write down the difference between the number Dima has calculated and the number Inna has calculated (D - I). Unfortunately, Sereja\'s matrix is really huge. That\'s why Inna and Dima aren\'t coping with the calculating. Help them!" -999

390D "Inna and Sweet Matrix" "constructive algorithms" "Inna loves sweets very much. That\'s why she decided to play a game called ""Sweet Matrix"".Inna sees an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m matrix and k candies. We\'ll index the matrix rows from 1 to n and the matrix columns from 1 to m. We\'ll represent the cell in the i-th row and j-th column as (i,\xe2\x80\x89j). Two cells (i,\xe2\x80\x89j) and (p,\xe2\x80\x89q) of the matrix are adjacent if |i\xe2\x80\x89-\xe2\x80\x89p|\xe2\x80\x89+\xe2\x80\x89|j\xe2\x80\x89-\xe2\x80\x89q|\xe2\x80\x89=\xe2\x80\x891. A path is a sequence of the matrix cells where each pair of neighbouring cells in the sequence is adjacent. We\'ll call the number of cells in the sequence the path\'s length.Each cell of the matrix can have at most one candy. Initiallly, all the cells are empty. Inna is trying to place each of the k candies in the matrix one by one. For each candy Inna chooses cell (i,\xe2\x80\x89j) that will contains the candy, and also chooses the path that starts in cell (1,\xe2\x80\x891) and ends in cell (i,\xe2\x80\x89j) and doesn\'t contain any candies. After that Inna moves the candy along the path from cell (1,\xe2\x80\x891) to cell (i,\xe2\x80\x89j), where the candy stays forever. If at some moment Inna can\'t choose a path for the candy, she loses. If Inna can place all the candies in the matrix in the described manner, then her penalty equals the sum of lengths of all the paths she has used.Help Inna to minimize the penalty in the game." -999

390C "Inna and Candy Boxes" "data structures" "Inna loves sweets very much. She has n closed present boxes lines up in a row in front of her. Each of these boxes contains either a candy (Dima\'s work) or nothing (Sereja\'s work). Let\'s assume that the boxes are numbered from 1 to n, from left to right.As the boxes are closed, Inna doesn\'t know which boxes contain candies and which boxes contain nothing. Inna chose number k and asked w questions to Dima to find that out. Each question is characterised by two integers li,\xe2\x80\x89ri (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89li\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ri\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n; r\xe2\x80\x89-\xe2\x80\x89l\xe2\x80\x89+\xe2\x80\x891 is divisible by k), the i-th question is: ""Dima, is that true that among the boxes with numbers from li to ri, inclusive, the candies lie only in boxes with numbers li\xe2\x80\x89+\xe2\x80\x89k\xe2\x80\x89-\xe2\x80\x891, li\xe2\x80\x89+\xe2\x80\x892k\xe2\x80\x89-\xe2\x80\x891, li\xe2\x80\x89+\xe2\x80\x893k\xe2\x80\x89-\xe2\x80\x891, ..., ri?""Dima hates to say ""no"" to Inna. That\'s why he wonders, what number of actions he will have to make for each question to make the answer to the question positive. In one action, Dima can either secretly take the candy from any box or put a candy to any box (Dima has infinitely many candies). Help Dima count the number of actions for each Inna\'s question.Please note that Dima doesn\'t change the array during Inna\'s questions. That\'s why when you calculate the number of operations for the current question, please assume that the sequence of boxes didn\'t change." -999

390B "Inna, Dima and Song" implementation "Inna is a great piano player and Dima is a modest guitar player. Dima has recently written a song and they want to play it together. Of course, Sereja wants to listen to the song very much. A song is a sequence of notes. Dima and Inna want to play each note at the same time. At that, they can play the i-th note at volume v (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89v\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ai; v is an integer) both on the piano and the guitar. They should retain harmony, so the total volume with which the i-th note was played on the guitar and the piano must equal bi. If Dima and Inna cannot play a note by the described rules, they skip it and Sereja\'s joy drops by 1. But if Inna and Dima play the i-th note at volumes xi and yi (xi\xe2\x80\x89+\xe2\x80\x89yi\xe2\x80\x89=\xe2\x80\x89bi) correspondingly, Sereja\'s joy rises by xi\xc2\xb7yi. Sereja has just returned home from the university and his current joy is 0. Help Dima and Inna play the song so as to maximize Sereja\'s total joy after listening to the whole song!" -999

390A "Inna and Alarm Clock" implementation "Inna loves sleeping very much, so she needs n alarm clocks in total to wake up. Let\'s suppose that Inna\'s room is a 100\xe2\x80\x89\xc3\x97\xe2\x80\x89100 square with the lower left corner at point (0,\xe2\x80\x890) and with the upper right corner at point (100,\xe2\x80\x89100). Then the alarm clocks are points with integer coordinates in this square.The morning has come. All n alarm clocks in Inna\'s room are ringing, so Inna wants to turn them off. For that Inna has come up with an amusing game:  First Inna chooses a type of segments that she will use throughout the game. The segments can be either vertical or horizontal.  Then Inna makes multiple moves. In a single move, Inna can paint a segment of any length on the plane, she chooses its type at the beginning of the game (either vertical or horizontal), then all alarm clocks that are on this segment switch off. The game ends when all the alarm clocks are switched off. Inna is very sleepy, so she wants to get through the alarm clocks as soon as possible. Help her, find the minimum number of moves in the game that she needs to turn off all the alarm clocks!" -999

389B "Fox and Cross" greedy,implementation "Fox Ciel has a board with n rows and n columns. So, the board consists of n\xe2\x80\x89\xc3\x97\xe2\x80\x89n cells. Each cell contains either a symbol \'.\', or a symbol \'#\'.A cross on the board is a connected set of exactly five cells of the board that looks like a cross. The picture below shows how it looks.Ciel wants to draw several (may be zero) crosses on the board. Each cross must cover exactly five cells with symbols \'#\', and any cell with symbol \'#\' must belong to some cross. No two crosses can share a cell.Please, tell Ciel if she can draw the crosses in the described way." 1100

389A "Fox and Number Game" greedy,math "Fox Ciel is playing a game with numbers now. Ciel has n positive integers: x1, x2, ..., xn. She can do the following operation as many times as needed: select two different indexes i and j such that xi > xj hold, and then apply assignment xi = xi - xj. The goal is to make the sum of all numbers as small as possible.Please help Ciel to find this minimal sum." 1000

388E "Fox and Meteor Shower" geometry "There is a meteor shower on the sky and there are n meteors. The sky can be viewed as a 2D Euclid Plane and the meteor is point on this plane. Fox Ciel looks at the sky. She finds out that the orbit of each meteor is a straight line, and each meteor has a constant velocity. Now Ciel wants to know: what is the maximum number of meteors such that any pair met at the same position at a certain time? Note that the time is not limited and can be also negative. The meteors will never collide when they appear at the same position at the same time." 3100

388D "Fox and Perfect Sets" math "Fox Ciel studies number theory.She thinks a non-empty set S contains non-negative integers is perfect if and only if for any  (a can be equal to b), . Where operation xor means exclusive or operation (http://en.wikipedia.org/wiki/Exclusive_or).Please calculate the number of perfect sets consisting of integers not greater than k. The answer can be very large, so print it modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." 2700

388C "Fox and Card Game" games,greedy,sortings "Fox Ciel is playing a card game with her friend Fox Jiro. There are n piles of cards on the table. And there is a positive integer on each card.The players take turns and Ciel takes the first turn. In Ciel\'s turn she takes a card from the top of any non-empty pile, and in Jiro\'s turn he takes a card from the bottom of any non-empty pile. Each player wants to maximize the total sum of the cards he took. The game ends when all piles become empty.Suppose Ciel and Jiro play optimally, what is the score of the game?" 2000

388B "Fox and Minimal path" "bitmasks,constructive algorithms,graphs,implementation,math" "Fox Ciel wants to write a task for a programming contest. The task is: ""You are given a simple undirected graph with n vertexes. Each its edge has unit length. You should calculate the number of shortest paths between vertex 1 and vertex 2.""Same with some writers, she wants to make an example with some certain output: for example, her birthday or the number of her boyfriend. Can you help her to make a test case with answer equal exactly to k?" 1900

388A "Fox and Box Accumulation" greedy,sortings "Fox Ciel has n boxes in her room. They have the same size and weight, but they might have different strength. The i-th box can hold at most xi boxes on its top (we\'ll call xi the strength of the box). Since all the boxes have the same size, Ciel cannot put more than one box directly on the top of some box. For example, imagine Ciel has three boxes: the first has strength 2, the second has strength 1 and the third has strength 1. She cannot put the second and the third box simultaneously directly on the top of the first one. But she can put the second box directly on the top of the first one, and then the third box directly on the top of the second one. We will call such a construction of boxes a pile.Fox Ciel wants to construct piles from all the boxes. Each pile will contain some boxes from top to bottom, and there cannot be more than xi boxes on the top of i-th box. What is the minimal number of piles she needs to construct?" 1400

387E "George and Cards" "binary search,data structures" "George is a cat, so he loves playing very much.Vitaly put n cards in a row in front of George. Each card has one integer written on it. All cards had distinct numbers written on them. Let\'s number the cards from the left to the right with integers from 1 to n. Then the i-th card from the left contains number pi (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89pi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n). Vitaly wants the row to have exactly k cards left. He also wants the i-th card from left to have number bi written on it. Vitaly gave a task to George, to get the required sequence of cards using the remove operation n\xe2\x80\x89-\xe2\x80\x89k times.In one remove operation George can choose w (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89w; w is not greater than the current number of cards in the row) contiguous cards (contiguous subsegment of cards). Let\'s denote the numbers written on these card as x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xw (from the left to the right). After that, George can remove the card xi, such that xi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89xj for each j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89w). After the described operation George gets w pieces of sausage.George wondered: what maximum number of pieces of sausage will he get in total if he reaches his goal and acts optimally well? Help George, find an answer to his question!" 2200

387D "George and Interesting Graph" "graph matchings" "George loves graphs. Most of all, he loves interesting graphs. We will assume that a directed graph is interesting, if it meets the following criteria:   The graph doesn\'t contain any multiple arcs;  There is vertex v (we\'ll call her the center), such that for any vertex of graph u, the graph contains arcs (u,\xe2\x80\x89v) and (v,\xe2\x80\x89u). Please note that the graph also contains loop (v,\xe2\x80\x89v).  The outdegree of all vertexes except for the center equals two and the indegree of all vertexes except for the center equals two. The outdegree of vertex u is the number of arcs that go out of u, the indegree of vertex u is the number of arcs that go in u. Please note that the graph can contain loops. However, not everything\'s that simple. George got a directed graph of n vertices and m arcs as a present. The graph didn\'t have any multiple arcs. As George loves interesting graphs, he wants to slightly alter the presented graph and transform it into an interesting one. In one alteration he can either remove an arbitrary existing arc from the graph or add an arbitrary arc to the graph. George wonders: what is the minimum number of changes that he needs to obtain an interesting graph from the graph he\'s got as a present? Help George and find the answer to the question." 2200

387C "George and Number" greedy,implementation "George is a cat, so he really likes to play. Most of all he likes to play with his array of positive integers b. During the game, George modifies the array by using special changes. Let\'s mark George\'s current array as b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89b|b| (record |b| denotes the current length of the array). Then one change is a sequence of actions:   Choose two distinct indexes i and j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i,\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|b|;�i\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89j), such that bi\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89bj.  Get number v\xe2\x80\x89=\xe2\x80\x89concat(bi,\xe2\x80\x89bj), where concat(x,\xe2\x80\x89y) is a number obtained by adding number y to the end of the decimal record of number x. For example, concat(500,\xe2\x80\x8910)\xe2\x80\x89=\xe2\x80\x8950010, concat(2,\xe2\x80\x892)\xe2\x80\x89=\xe2\x80\x8922.  Add number v to the end of the array. The length of the array will increase by one.  Remove from the array numbers with indexes i and j. The length of the array will decrease by two, and elements of the array will become re-numbered from 1 to current length of the array. George played for a long time with his array b and received from array b an array consisting of exactly one number p. Now George wants to know: what is the maximum number of elements array b could contain originally? Help him find this number. Note that originally the array could contain only positive integers." 1700

387B "George and Round" "brute force,greedy,two pointers" "George decided to prepare a Codesecrof round, so he has prepared m problems for the round. Let\'s number the problems with integers 1 through m. George estimates the i-th problem\'s complexity by integer bi.To make the round good, he needs to put at least n problems there. Besides, he needs to have at least one problem with complexity exactly a1, at least one with complexity exactly a2, ..., and at least one with complexity exactly an. Of course, the round can also have problems with other complexities.George has a poor imagination. It\'s easier for him to make some already prepared problem simpler than to come up with a new one and prepare it. George is magnificent at simplifying problems. He can simplify any already prepared problem with complexity c to any positive integer complexity d (c\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89d), by changing limits on the input data.However, nothing is so simple. George understood that even if he simplifies some problems, he can run out of problems for a good round. That\'s why he decided to find out the minimum number of problems he needs to come up with in addition to the m he\'s prepared in order to make a good round. Note that George can come up with a new problem of any complexity." 1200

387A "George and Sleep" implementation "George woke up and saw the current time s on the digital clock. Besides, George knows that he has slept for time t. Help George! Write a program that will, given time s and t, determine the time p when George went to bed. Note that George could have gone to bed yesterday relatively to the current time (see the second test sample)." 900

386D "Game with Points" "dp,graphs,implementation,shortest paths" "You are playing the following game. There are n points on a plane. They are the vertices of a regular n-polygon. Points are labeled with integer numbers from 1 to n. Each pair of distinct points is connected by a diagonal, which is colored in one of 26 colors. Points are denoted by lowercase English letters. There are three stones positioned on three distinct vertices. All stones are the same. With one move you can move the stone to another free vertex along some diagonal. The color of this diagonal must be the same as the color of the diagonal, connecting another two stones. Your goal is to move stones in such way that the only vertices occupied by stones are 1, 2 and 3. You must achieve such position using minimal number of moves. Write a program which plays this game in an optimal way." 2100

386C "Diverse Substrings" "dp,strings,two pointers" "String diversity is the number of symbols that occur in the string at least once. Diversity of s will be denoted by d(s). For example , d(""aaa"")=1, d(""abacaba"")=3.Given a string s, consisting of lowercase Latin letters. Consider all its substrings. Obviously, any substring diversity is a number from 1 to d(s). Find statistics about substrings diversity: for each k from 1 to d(s), find how many substrings of s has a diversity of exactly k." 2000

386B "Fly, freebies, fly!" "binary search,brute force,implementation" "Everyone loves a freebie. Especially students.It is well-known that if in the night before exam a student opens window, opens the student\'s record-book and shouts loudly three times ""Fly, freebie, fly!"" \xe2\x80\x94 then flown freebie helps him to pass the upcoming exam.In the night before the exam on mathematical analysis n students living in dormitory shouted treasured words. The i-th student made a sacrament at the time ti, where ti is the number of seconds elapsed since the beginning of the night.It is known that the freebie is a capricious and willful lady. That night the freebie was near dormitory only for T seconds. Therefore, if for two students their sacrament times differ for more than T, then the freebie didn\'t visit at least one of them.Since all students are optimists, they really want to know what is the maximal number of students visited by the freebie can be." 1400

386A "Second-Price Auction" implementation "In this problem we consider a special type of an auction, which is called the second-price auction. As in regular auction n bidders place a bid which is price a bidder ready to pay. The auction is closed, that is, each bidder secretly informs the organizer of the auction price he is willing to pay. After that, the auction winner is the participant who offered the highest price. However, he pay not the price he offers, but the highest price among the offers of other participants (hence the name: the second-price auction).Write a program that reads prices offered by bidders and finds the winner and the price he will pay. Consider that all of the offered prices are different." 800

385E "Bear in the Field" math,matrices "Our bear\'s forest has a checkered field. The checkered field is an n\xe2\x80\x89\xc3\x97\xe2\x80\x89n table, the rows are numbered from 1 to n from top to bottom, the columns are numbered from 1 to n from left to right. Let\'s denote a cell of the field on the intersection of row x and column y by record (x,\xe2\x80\x89y). Each cell of the field contains growing raspberry, at that, the cell (x,\xe2\x80\x89y) of the field contains x\xe2\x80\x89+\xe2\x80\x89y raspberry bushes.The bear came out to walk across the field. At the beginning of the walk his speed is (dx,\xe2\x80\x89dy). Then the bear spends exactly t seconds on the field. Each second the following takes place:  Let\'s suppose that at the current moment the bear is in cell (x,\xe2\x80\x89y).  First the bear eats the raspberry from all the bushes he has in the current cell. After the bear eats the raspberry from k bushes, he increases each component of his speed by k. In other words, if before eating the k bushes of raspberry his speed was (dx,\xe2\x80\x89dy), then after eating the berry his speed equals (dx\xe2\x80\x89+\xe2\x80\x89k,\xe2\x80\x89dy\xe2\x80\x89+\xe2\x80\x89k).  Let\'s denote the current speed of the bear (dx,\xe2\x80\x89dy) (it was increased after the previous step). Then the bear moves from cell (x,\xe2\x80\x89y) to cell (((x\xe2\x80\x89+\xe2\x80\x89dx\xe2\x80\x89-\xe2\x80\x891)�mod�n)\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89((y\xe2\x80\x89+\xe2\x80\x89dy\xe2\x80\x89-\xe2\x80\x891)�mod�n)\xe2\x80\x89+\xe2\x80\x891).  Then one additional raspberry bush grows in each cell of the field. You task is to predict the bear\'s actions. Find the cell he ends up in if he starts from cell (sx,\xe2\x80\x89sy). Assume that each bush has infinitely much raspberry and the bear will never eat all of it." 2300

385D "Bear and Floodlight" bitmasks,dp,geometry "One day a bear lived on the Oxy axis. He was afraid of the dark, so he couldn\'t move at night along the plane points that aren\'t lit. One day the bear wanted to have a night walk from his house at point (l,\xe2\x80\x890) to his friend\'s house at point (r,\xe2\x80\x890), along the segment of length (r\xe2\x80\x89-\xe2\x80\x89l). Of course, if he wants to make this walk, he needs each point of the segment to be lit. That\'s why the bear called his friend (and yes, in the middle of the night) asking for a very delicate favor.The Oxy axis contains n floodlights. Floodlight i is at point (xi,\xe2\x80\x89yi) and can light any angle of the plane as large as ai degree with vertex at point (xi,\xe2\x80\x89yi). The bear asked his friend to turn the floodlights so that he (the bear) could go as far away from his house as possible during the walking along the segment. His kind friend agreed to fulfill his request. And while he is at it, the bear wonders: what is the furthest he can go away from his house? Hep him and find this distance.Consider that the plane has no obstacles and no other light sources besides the floodlights. The bear\'s friend cannot turn the floodlights during the bear\'s walk. Assume that after all the floodlights are turned in the correct direction, the bear goes for a walk and his friend goes to bed." 2200

385C "Bear and Prime Numbers" "binary search,brute force,data structures,dp,implementation,math,number theory" "Recently, the bear started studying data structures and faced the following problem.You are given a sequence of integers x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xn of length n and m queries, each of them is characterized by two integers li,\xe2\x80\x89ri. Let\'s introduce f(p) to represent the number of such indexes k, that xk is divisible by p. The answer to the query li,\xe2\x80\x89ri is the sum: , where S(li,\xe2\x80\x89ri) is a set of prime numbers from segment [li,\xe2\x80\x89ri] (both borders are included in the segment).Help the bear cope with the problem." 1700

385B "Bear and Strings" "brute force,greedy,implementation,math,strings" "The bear has a string s\xe2\x80\x89=\xe2\x80\x89s1s2... s|s| (record |s| is the string\'s length), consisting of lowercase English letters. The bear wants to count the number of such pairs of indices i,\xe2\x80\x89j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|s|), that string x(i,\xe2\x80\x89j)\xe2\x80\x89=\xe2\x80\x89sisi\xe2\x80\x89+\xe2\x80\x891... sj contains at least one string ""bear"" as a substring.String x(i,\xe2\x80\x89j) contains string ""bear"", if there is such index k (i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89-\xe2\x80\x893), that sk\xe2\x80\x89=\xe2\x80\x89b, sk\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89=\xe2\x80\x89e, sk\xe2\x80\x89+\xe2\x80\x892\xe2\x80\x89=\xe2\x80\x89a, sk\xe2\x80\x89+\xe2\x80\x893\xe2\x80\x89=\xe2\x80\x89r.Help the bear cope with the given problem." 1200

385A "Bear and Raspberry" "brute force,greedy,implementation" "The bear decided to store some raspberry for the winter. He cunningly found out the price for a barrel of honey in kilos of raspberry for each of the following n days. According to the bear\'s data, on the i-th (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) day, the price for one barrel of honey is going to is xi kilos of raspberry.Unfortunately, the bear has neither a honey barrel, nor the raspberry. At the same time, the bear\'s got a friend who is ready to lend him a barrel of honey for exactly one day for c kilograms of raspberry. That\'s why the bear came up with a smart plan. He wants to choose some day d (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89d\xe2\x80\x89<\xe2\x80\x89n), lent a barrel of honey and immediately (on day d) sell it according to a daily exchange rate. The next day (d\xe2\x80\x89+\xe2\x80\x891) the bear wants to buy a new barrel of honey according to a daily exchange rate (as he\'s got some raspberry left from selling the previous barrel) and immediately (on day d\xe2\x80\x89+\xe2\x80\x891) give his friend the borrowed barrel of honey as well as c kilograms of raspberry for renting the barrel.The bear wants to execute his plan at most once and then hibernate. What maximum number of kilograms of raspberry can he earn? Note that if at some point of the plan the bear runs out of the raspberry, then he won\'t execute such a plan." 1000

384B Multitasking "greedy,implementation,sortings,two pointers" "Iahub wants to enhance his multitasking abilities. In order to do this, he wants to sort n arrays simultaneously, each array consisting of m integers.Iahub can choose a pair of distinct indices i and j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i,\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m,\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89j). Then in each array the values at positions i and j are swapped only if the value at position i is strictly greater than the value at position j.Iahub wants to find an array of pairs of distinct indices that, chosen in order, sort all of the n arrays in ascending or descending order (the particular order is given in input). The size of the array can be at most  (at most  pairs). Help Iahub, find any suitable array." 1500

384A Coder implementation "Iahub likes chess very much. He even invented a new chess piece named Coder. A Coder can move (and attack) one square horizontally or vertically. More precisely, if the Coder is located at position (x,\xe2\x80\x89y), he can move to (or attack) positions (x\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89y), (x\xe2\x80\x931,\xe2\x80\x89y), (x,\xe2\x80\x89y\xe2\x80\x89+\xe2\x80\x891) and (x,\xe2\x80\x89y\xe2\x80\x931).Iahub wants to know how many Coders can be placed on an n\xe2\x80\x89\xc3\x97\xe2\x80\x89n chessboard, so that no Coder attacks any other Coder." 800

383E Vowels "combinatorics,divide and conquer,dp" "Iahubina is tired of so many complicated languages, so she decided to invent a new, simple language. She already made a dictionary consisting of n 3-words. A 3-word is a sequence of exactly 3 lowercase letters of the first 24 letters of the English alphabet (a to x). She decided that some of the letters are vowels, and all the others are consonants. The whole language is based on a simple rule: any word that contains at least one vowel is correct.Iahubina forgot which letters are the vowels, and wants to find some possible correct sets of vowels. She asks Iahub questions. In each question, she will give Iahub a set of letters considered vowels (in this question). For each question she wants to know how many words of the dictionary are correct, considering the given set of vowels.Iahubina wants to know the xor of the squared answers to all the possible questions. There are 224 different questions, they are all subsets of the set of the first 24 letters of the English alphabet. Help Iahub find that number." 2700

383D Antimatter dp "Iahub accidentally discovered a secret lab. He found there n devices ordered in a line, numbered from 1 to n from left to right. Each device i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) can create either ai units of matter or ai units of antimatter. Iahub wants to choose some contiguous subarray of devices in the lab, specify the production mode for each of them (produce matter or antimatter) and finally take a photo of it. However he will be successful only if the amounts of matter and antimatter produced in the selected subarray will be the same (otherwise there would be overflowing matter or antimatter in the photo). You are requested to compute the number of different ways Iahub can successful take a photo. A photo is different than another if it represents another subarray, or if at least one device of the subarray is set to produce matter in one of the photos and antimatter in the other one." 2300

383C "Propagating tree" "data structures,dfs and similar,trees" "Iahub likes trees very much. Recently he discovered an interesting tree named propagating tree. The tree consists of n nodes numbered from 1 to n, each node i having an initial value ai. The root of the tree is node 1.This tree has a special property: when a value val is added to a value of node i, the value -val is added to values of all the children of node i. Note that when you add value -val to a child of node i, you also add -(-val) to all children of the child of node i and so on. Look an example explanation to understand better how it works.This tree supports two types of queries:  ""1 x val"" \xe2\x80\x94 val is added to the value of node x;  ""2 x"" \xe2\x80\x94 print the current value of node x. In order to help Iahub understand the tree better, you must answer m queries of the preceding type." 2000

383B Volcanoes "binary search,implementation,sortings,two pointers" "Iahub got lost in a very big desert. The desert can be represented as a n\xe2\x80\x89\xc3\x97\xe2\x80\x89n square matrix, where each cell is a zone of the desert. The cell (i,\xe2\x80\x89j) represents the cell at row i and column j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i,\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n). Iahub can go from one cell (i,\xe2\x80\x89j) only down or right, that is to cells (i\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89j) or (i,\xe2\x80\x89j\xe2\x80\x89+\xe2\x80\x891). Also, there are m cells that are occupied by volcanoes, which Iahub cannot enter. Iahub is initially at cell (1,\xe2\x80\x891) and he needs to travel to cell (n,\xe2\x80\x89n). Knowing that Iahub needs 1 second to travel from one cell to another, find the minimum time in which he can arrive in cell (n,\xe2\x80\x89n)." 2500

383A "Milking cows" "data structures,greedy" "Iahub helps his grandfather at the farm. Today he must milk the cows. There are n cows sitting in a row, numbered from 1 to n from left to right. Each cow is either facing to the left or facing to the right. When Iahub milks a cow, all the cows that see the current cow get scared and lose one unit of the quantity of milk that they can give. A cow facing left sees all the cows with lower indices than her index, and a cow facing right sees all the cows with higher indices than her index. A cow that got scared once can get scared again (and lose one more unit of milk). A cow that has been milked once cannot get scared and lose any more milk. You can assume that a cow never loses all the milk she can give (a cow gives an infinitely amount of milk).Iahub can decide the order in which he milks the cows. But he must milk each cow exactly once. Iahub wants to lose as little milk as possible. Print the minimum amount of milk that is lost." 1600

382E "Ksenia and Combinatorics" combinatorics,dp "Ksenia has her winter exams. Today she is learning combinatorics. Here\'s one of the problems she needs to learn to solve.How many distinct trees are there consisting of n vertices, each with the following properties:  the tree is marked, that is, the vertices of the tree are numbered from 1 to n;  each vertex of the tree is connected with at most three other vertices, and at the same moment the vertex with number 1 is connected with at most two other vertices;  the size of the tree\'s maximum matching equals k. Two trees are considered distinct if there are such two vertices u and v, that in one tree they are connected by an edge and in the other tree they are not.Help Ksenia solve the problem for the given n and k. As the answer to the problem can be very huge you should output it modulo 1000000007�(109\xe2\x80\x89+\xe2\x80\x897)." 2600

382D "Ksenia and Pawns" "dfs and similar,graphs,implementation,trees" "Ksenia has a chessboard of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m. Each cell of the chessboard contains one of the characters: ""<"", "">"", ""^"", ""v"", ""#"". The cells that contain character ""#"" are blocked. We know that all chessboard cells that touch the border are blocked.Ksenia is playing with two pawns on this chessboard. Initially, she puts the pawns on the chessboard. One cell of the chessboard can contain two pawns if and only if the cell is blocked. In other cases two pawns can not stand in one cell. The game begins when Ksenia put pawns on the board. In one move, Ksenia moves each pawn to a side adjacent cell in the direction of arrows painted on the cell on which the corresponding pawn sits (if the pawn sits on ""#"", it does not move). Assume that Ksenia moves pawns simultaneously (see the second test case). Of course, Ksenia plays for points. How can one calculate the points per game? Very simply! Let\'s count how many movements the first pawn made and how many movements the second pawn made, sum these two numbers \xe2\x80\x94 it will be the resulting score of the game. Ksenia wonders: what is the maximum number of points she can earn (for that, she should place the pawns optimally well early in the game). Help her and find that number." 2200

382C "Arithmetic Progression" implementation,sortings "Everybody knows what an arithmetic progression is. Let us remind you just in case that an arithmetic progression is such sequence of numbers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an of length n, that the following condition fulfills: a2\xe2\x80\x89-\xe2\x80\x89a1\xe2\x80\x89=\xe2\x80\x89a3\xe2\x80\x89-\xe2\x80\x89a2\xe2\x80\x89=\xe2\x80\x89a4\xe2\x80\x89-\xe2\x80\x89a3\xe2\x80\x89=\xe2\x80\x89...\xe2\x80\x89=\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89-\xe2\x80\x89ai\xe2\x80\x89=\xe2\x80\x89...\xe2\x80\x89=\xe2\x80\x89an\xe2\x80\x89-\xe2\x80\x89an\xe2\x80\x89-\xe2\x80\x891.For example, sequences [1, 5], [10], [5, 4, 3] are arithmetic progressions and sequences [1, 3, 2], [1, 2, 4] are not.Alexander has n cards containing integers. Arthur wants to give Alexander exactly one more card with a number so that he could use the resulting n\xe2\x80\x89+\xe2\x80\x891 cards to make an arithmetic progression (Alexander has to use all of his cards).Arthur has already bought a card but he hasn\'t written a number on it. Help him, print all integers that you can write on a card so that the described condition fulfilled." 1700

382B "Number Busters" "binary search,math" "Arthur and Alexander are number busters. Today they\'ve got a competition. Arthur took a group of four integers a,\xe2\x80\x89b,\xe2\x80\x89w,\xe2\x80\x89x (0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b\xe2\x80\x89<\xe2\x80\x89w,\xe2\x80\x890\xe2\x80\x89<\xe2\x80\x89x\xe2\x80\x89<\xe2\x80\x89w) and Alexander took integer \xd1\x81. Arthur and Alexander use distinct approaches to number bustings. Alexander is just a regular guy. Each second, he subtracts one from his number. In other words, he performs the assignment: c\xe2\x80\x89=\xe2\x80\x89c\xe2\x80\x89-\xe2\x80\x891. Arthur is a sophisticated guy. Each second Arthur performs a complex operation, described as follows: if b\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89x, perform the assignment b\xe2\x80\x89=\xe2\x80\x89b\xe2\x80\x89-\xe2\x80\x89x, if b\xe2\x80\x89<\xe2\x80\x89x, then perform two consecutive assignments a\xe2\x80\x89=\xe2\x80\x89a\xe2\x80\x89-\xe2\x80\x891;�b\xe2\x80\x89=\xe2\x80\x89w\xe2\x80\x89-\xe2\x80\x89(x\xe2\x80\x89-\xe2\x80\x89b).You\'ve got numbers a,\xe2\x80\x89b,\xe2\x80\x89w,\xe2\x80\x89x,\xe2\x80\x89c. Determine when Alexander gets ahead of Arthur if both guys start performing the operations at the same time. Assume that Alexander got ahead of Arthur if c\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a." 2000

382A "Ksenia and Pan Scales" greedy,implementation "Ksenia has ordinary pan scales and several weights of an equal mass. Ksenia has already put some weights on the scales, while other weights are untouched. Ksenia is now wondering whether it is possible to put all the remaining weights on the scales so that the scales were in equilibrium. The scales is in equilibrium if the total sum of weights on the left pan is equal to the total sum of weights on the right pan." 1100

381B "Sereja and Stairs" greedy,implementation,sortings "Sereja loves integer sequences very much. He especially likes stairs.Sequence a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89a|a| (|a| is the length of the sequence) is stairs if there is such index i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|a|), that the following condition is met: a1\xe2\x80\x89<\xe2\x80\x89a2\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89ai\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89<\xe2\x80\x89ai\xe2\x80\x89>\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89>\xe2\x80\x89...\xe2\x80\x89>\xe2\x80\x89a|a|\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89>\xe2\x80\x89a|a|.For example, sequences [1, 2, 3, 2] and [4, 2] are stairs and sequence [3, 1, 2] isn\'t.Sereja has m cards with numbers. He wants to put some cards on the table in a row to get a stair sequence. What maximum number of cards can he put on the table?" 1100

381A "Sereja and Dima" "greedy,implementation,two pointers" "Sereja and Dima play a game. The rules of the game are very simple. The players have n cards in a row. Each card contains a number, all numbers on the cards are distinct. The players take turns, Sereja moves first. During his turn a player can take one card: either the leftmost card in a row, or the rightmost one. The game ends when there is no more cards. The player who has the maximum sum of numbers on his cards by the end of the game, wins.Sereja and Dima are being greedy. Each of them chooses the card with the larger number during his move.Inna is a friend of Sereja and Dima. She knows which strategy the guys are using, so she wants to determine the final score, given the initial state of the game. Help her." 800

380E "Sereja and Dividing" "data structures" "Let\'s assume that we have a sequence of doubles a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89a|a| and a double variable x. You are allowed to perform the following two-staged operation:  choose an index of the sequence element i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|a|);  consecutively perform assignments: . Let\'s use function g(a,\xe2\x80\x89x) to represent the largest value that can be obtained from variable x, using the described operation any number of times and sequence a.Sereja has sequence b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89b|b|. Help Sereja calculate sum: . Record [bi,\xe2\x80\x89bi\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89bj] represents a sequence containing the elements in brackets in the given order. To avoid problems with precision, please, print the required sum divided by |b|2." 2600

380D "Sereja and Cinema" combinatorics,math "The cinema theater hall in Sereja\'s city is n seats lined up in front of one large screen. There are slots for personal possessions to the left and to the right of each seat. Any two adjacent seats have exactly one shared slot. The figure below shows the arrangement of seats and slots for n\xe2\x80\x89=\xe2\x80\x894.  Today it\'s the premiere of a movie called ""Dry Hard"". The tickets for all the seats have been sold. There is a very strict controller at the entrance to the theater, so all n people will come into the hall one by one. As soon as a person enters a cinema hall, he immediately (momentarily) takes his seat and occupies all empty slots to the left and to the right from him. If there are no empty slots, the man gets really upset and leaves.People are not very constant, so it\'s hard to predict the order in which the viewers will enter the hall. For some seats, Sereja knows the number of the viewer (his number in the entering queue of the viewers) that will come and take this seat. For others, it can be any order. Being a programmer and a mathematician, Sereja wonders: how many ways are there for the people to enter the hall, such that nobody gets upset? As the number can be quite large, print it modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." 2500

380C "Sereja and Brackets" "data structures,schedules" "Sereja has a bracket sequence s1,\xe2\x80\x89s2,\xe2\x80\x89...,\xe2\x80\x89sn, or, in other words, a string s of length n, consisting of characters ""("" and "")"".Sereja needs to answer m queries, each of them is described by two integers li,\xe2\x80\x89ri (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89li\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ri\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n). The answer to the i-th query is the length of the maximum correct bracket subsequence of sequence sli,\xe2\x80\x89sli\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89sri. Help Sereja answer all queries.You can find the definitions for a subsequence and a correct bracket sequence in the notes." 2000

380B "Sereja and Tree" graphs,implementation "Sereja adores trees. Today he came up with a revolutionary new type of binary root trees.His new tree consists of n levels, each vertex is indexed by two integers: the number of the level and the number of the vertex on the current level. The tree root is at level 1, its index is (1,\xe2\x80\x891). Here is a pseudo code of tree construction.//the global data are integer arrays cnt[], left[][], right[][]cnt[1] = 1;fill arrays left[][], right[][] with values -1;for(level = 1; level < n; level = level + 1){    cnt[level + 1] = 0;    for(position = 1; position <= cnt[level]; position = position + 1){        if(the value of position is a power of two){ // that is, 1, 2, 4, 8...            left[level][position] = cnt[level + 1] + 1;            right[level][position] = cnt[level + 1] + 2;            cnt[level + 1] = cnt[level + 1] + 2;                    }else{            right[level][position] = cnt[level + 1] + 1;            cnt[level + 1] = cnt[level + 1] + 1;        }    }}After the pseudo code is run, cell cnt[level] contains the number of vertices on level level. Cell left[level][position] contains the number of the vertex on the level level\xe2\x80\x89+\xe2\x80\x891, which is the left child of the vertex with index (level,\xe2\x80\x89position), or it contains -1, if the vertex doesn\'t have a left child. Similarly, cell right[level][position] is responsible for the right child. You can see how the tree with n\xe2\x80\x89=\xe2\x80\x894 looks like in the notes.Serja loves to make things complicated, so he first made a tree and then added an empty set A(level,\xe2\x80\x89position) for each vertex. Then Sereja executes m operations. Each operation is of one of the two following types:  The format of the operation is ""1 t l r x"". For all vertices level,\xe2\x80\x89position (level\xe2\x80\x89=\xe2\x80\x89t;�l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89position\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r) add value x to set A(level,\xe2\x80\x89position).  The format of the operation is ""2 t v"". For vertex level,\xe2\x80\x89position (level\xe2\x80\x89=\xe2\x80\x89t,\xe2\x80\x89position\xe2\x80\x89=\xe2\x80\x89v), find the union of all sets of vertices that are in the subtree of vertex (level,\xe2\x80\x89position). Print the size of the union of these sets. Help Sereja execute the operations. In this problem a set contains only distinct values like std::set in C++." 2400

380A "Sereja and Prefixes" "binary search,brute force" "Sereja loves number sequences very much. That\'s why he decided to make himself a new one following a certain algorithm.Sereja takes a blank piece of paper. Then he starts writing out the sequence in m stages. Each time he either adds a new number to the end of the sequence or takes l first elements of the current sequence and adds them c times to the end. More formally, if we represent the current sequence as a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an, then after we apply the described operation, the sequence transforms into a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an[,\xe2\x80\x89a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89al] (the block in the square brackets must be repeated c times). A day has passed and Sereja has completed the sequence. He wonders what are the values of some of its elements. Help Sereja." 1600

379G "New Year Cactus" dp "Jack and Jill are tired of the New Year tree, now they\'ve got a New Year cactus at home! A cactus is a connected undirected graph where any two simple cycles have at most one common vertex. In other words, this graph doesn\'t have any edges that lie on more than one simple cycle.On the 31st of December they are going to decorate the cactus by hanging toys to its vertices. At most one toy is going to hang on each vertex \xe2\x80\x94 it\'s either the toy Jack hung or the toy Jill hung. It\'s possible for a vertex to have no toys.Jack and Jill has been arguing, so they don\'t want any edge to connect two vertices where one vertex has Jack\'s toy and the other vertex has Jill\'s toy.Jack has decided to hang a toys. What maximum number of toys b can Jill hang if they both cooperate to maximize this value? Your task is to write a program that finds the sought b for all a from 0 to the number of vertices on the New Year Cactus." 3100

379F "New Year Tree" "data structures,divide and conquer,trees" "You are a programmer and you have a New Year Tree (not the traditional fur tree, though) \xe2\x80\x94 a tree of four vertices: one vertex of degree three (has number 1), connected with three leaves (their numbers are from 2 to 4).On the New Year, programmers usually have fun. You decided to have fun as well by adding vertices to the tree. One adding operation looks as follows:  First we choose some leaf of the tree with number v.  Let\'s mark the number of vertices on the tree at this moment by variable n, then two vertexes are added to the tree, their numbers are n\xe2\x80\x89+\xe2\x80\x891 and n\xe2\x80\x89+\xe2\x80\x892, also you get new edges, one between vertices v and n\xe2\x80\x89+\xe2\x80\x891 and one between vertices v and n\xe2\x80\x89+\xe2\x80\x892. Your task is not just to model the process of adding vertices to the tree, but after each adding operation print the diameter of the current tree. Come on, let\'s solve the New Year problem!" 2400

379E "New Year Tree Decorations" geometry,schedules,sortings "Due to atheistic Soviet past, Christmas wasn\'t officially celebrated in Russia for most of the twentieth century. As a result, the Russian traditions for Christmas and New Year mixed into one event celebrated on the New Year but including the tree, a Santa-like \'Grandfather Frost\', presents and huge family reunions and dinner parties all over the country. Bying a Tree at the New Year and installing it in the house is a tradition. Usually the whole family decorates the tree on the New Year Eve. We hope that Codeforces is a big and loving family, so in this problem we are going to decorate a tree as well.So, our decoration consists of n pieces, each piece is a piece of colored paper, its border is a closed polyline of a special shape. The pieces go one by one as is shown on the picture. The i-th piece is a polyline that goes through points: (0,\xe2\x80\x890), (0,\xe2\x80\x89y0), (1,\xe2\x80\x89y1), (2,\xe2\x80\x89y2), ..., (k,\xe2\x80\x89yk), (k,\xe2\x80\x890). The width of each piece equals k.  The figure to the left shows the decoration, the figure to the right shows the individual pieces it consists of. The piece number 1 (shown red on the figure) is the outer piece (we see it completely), piece number 2 (shown yellow) follows it (we don\'t see it completely as it is partially closed by the first piece) and so on. The programmers are quite curious guys, so the moment we hung a decoration on the New Year tree we started to wonder: what area of each piece can people see?" 2500

379D "New Year Letter" "bitmasks,brute force,dp" "Many countries have such a New Year or Christmas tradition as writing a letter to Santa including a wish list for presents. Vasya is an ordinary programmer boy. Like all ordinary boys, he is going to write the letter to Santa on the New Year Eve (we Russians actually expect Santa for the New Year, not for Christmas). Vasya has come up with an algorithm he will follow while writing a letter. First he chooses two strings, s1 anf s2, consisting of uppercase English letters. Then the boy makes string sk, using a recurrent equation sn\xe2\x80\x89=\xe2\x80\x89sn\xe2\x80\x89-\xe2\x80\x892\xe2\x80\x89+\xe2\x80\x89sn\xe2\x80\x89-\xe2\x80\x891, operation \'+\' means a concatenation (that is, the sequential record) of strings in the given order. Then Vasya writes down string sk on a piece of paper, puts it in the envelope and sends in to Santa. Vasya is absolutely sure that Santa will bring him the best present if the resulting string sk has exactly x occurrences of substring AC (the short-cut reminds him \xd0\xbef accepted problems). Besides, Vasya decided that string s1 should have length n, and string s2 should have length m. Vasya hasn\'t decided anything else.At the moment Vasya\'s got urgent New Year business, so he asks you to choose two strings for him, s1 and s2 in the required manner. Help Vasya." 2000

379C "New Year Ratings Change" greedy,sortings "One very well-known internet resource site (let\'s call it X) has come up with a New Year adventure. Specifically, they decided to give ratings to all visitors.There are n users on the site, for each user we know the rating value he wants to get as a New Year Present. We know that user i wants to get at least ai rating units as a present.The X site is administered by very creative and thrifty people. On the one hand, they want to give distinct ratings and on the other hand, the total sum of the ratings in the present must be as small as possible.Help site X cope with the challenging task of rating distribution. Find the optimal distribution." 1400

379B "New Year Present" "constructive algorithms,implementation" "The New Year is coming! That\'s why many people today are busy preparing New Year presents. Vasily the Programmer is no exception.Vasily knows that the best present is (no, it\'s not a contest) money. He\'s put n empty wallets from left to right in a row and decided how much money to put in what wallet. Vasily decided to put ai coins to the i-th wallet from the left.Vasily is a very busy man, so the money are sorted into the bags by his robot. Initially, the robot stands by the leftmost wallet in the row. The robot can follow instructions of three types: go to the wallet that is to the left of the current one (if such wallet exists), go to the wallet that is to the right of the current one (if such wallet exists), put a coin to the current wallet. Due to some technical malfunctions the robot cannot follow two ""put a coin"" instructions in a row.Vasily doesn\'t want to wait for long, so he wants to write a program for the robot that contains at most 106 operations (not necessarily minimum in length) the robot can use to put coins into the wallets. Help him." 1200

379A "New Year Candles" implementation "Vasily the Programmer loves romance, so this year he decided to illuminate his room with candles.Vasily has a candles.When Vasily lights up a new candle, it first burns for an hour and then it goes out. Vasily is smart, so he can make b went out candles into a new candle. As a result, this new candle can be used like any other new candle.Now Vasily wonders: for how many hours can his candles light up the room if he acts optimally well? Help him find this number." 1000

378B Semifinals implementation,sortings "Two semifinals have just been in the running tournament. Each semifinal had n participants. There are n participants advancing to the finals, they are chosen as follows: from each semifinal, we choose k people (0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x892k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) who showed the best result in their semifinals and all other places in the finals go to the people who haven\'t ranked in the top k in their semifinal but got to the n\xe2\x80\x89-\xe2\x80\x892k of the best among the others.The tournament organizers hasn\'t yet determined the k value, so the participants want to know who else has any chance to get to the finals and who can go home." 1300

378A "Playing with Dice" "brute force" "Two players are playing a game. First each of them writes an integer from 1 to 6, and then a dice is thrown. The player whose written number got closer to the number on the dice wins. If both payers have the same difference, it\'s a draw.The first player wrote number a, the second player wrote number b. How many ways to throw a dice are there, at which the first player wins, or there is a draw, or the second player wins?" 800

377E "Cookie Clicker" dp,geometry "Kostya is playing the computer game Cookie Clicker. The goal of this game is to gather cookies. You can get cookies using different buildings: you can just click a special field on the screen and get the cookies for the clicks, you can buy a cookie factory, an alchemy lab, a time machine and it all will bring lots and lots of cookies.At the beginning of the game (time 0), Kostya has 0 cookies and no buildings. He has n available buildings to choose from: the i-th building is worth ci cookies and when it\'s built it brings vi cookies at the end of each second. Also, to make the game more interesting to play, Kostya decided to add a limit: at each moment of time, he can use only one building. Of course, he can change the active building each second at his discretion.It\'s important that Kostya is playing a version of the game where he can buy new buildings and change active building only at time moments that are multiples of one second. Kostya can buy new building and use it at the same time. If Kostya starts to use a building at the time moment t, he can get the first profit from it only at the time moment t\xe2\x80\x89+\xe2\x80\x891.Kostya wants to earn at least s cookies as quickly as possible. Determine the number of seconds he needs to do that." 2800

377D "Developing Game" "data structures" "Pavel is going to make a game of his dream. However, he knows that he can\'t make it on his own so he founded a development company and hired n workers of staff. Now he wants to pick n workers from the staff who will be directly responsible for developing a game.Each worker has a certain skill level vi. Besides, each worker doesn\'t want to work with the one whose skill is very different. In other words, the i-th worker won\'t work with those whose skill is less than li, and with those whose skill is more than ri.Pavel understands that the game of his dream isn\'t too hard to develop, so the worker with any skill will be equally useful. That\'s why he wants to pick a team of the maximum possible size. Help him pick such team." 2400

377C "Captains Mode" bitmasks,dp,games "Kostya is a progamer specializing in the discipline of Dota 2. Valve Corporation, the developer of this game, has recently released a new patch which turned the balance of the game upside down. Kostya, as the captain of the team, realizes that the greatest responsibility lies on him, so he wants to resort to the analysis of innovations patch from the mathematical point of view to choose the best heroes for his team in every game.A Dota 2 match involves two teams, each of them must choose some heroes that the players of the team are going to play for, and it is forbidden to choose the same hero several times, even in different teams. In large electronic sports competitions where Kostya\'s team is going to participate, the matches are held in the Captains Mode. In this mode the captains select the heroes by making one of two possible actions in a certain, predetermined order: pick or ban.  To pick a hero for the team. After the captain picks, the picked hero goes to his team (later one of a team members will play it) and can no longer be selected by any of the teams.  To ban a hero. After the ban the hero is not sent to any of the teams, but it still can no longer be selected by any of the teams. The team captain may miss a pick or a ban. If he misses a pick, a random hero is added to his team from those that were available at that moment, and if he misses a ban, no hero is banned, as if there was no ban.Kostya has already identified the strength of all the heroes based on the new patch fixes. Of course, Kostya knows the order of picks and bans. The strength of a team is the sum of the strengths of the team\'s heroes and both teams that participate in the match seek to maximize the difference in strengths in their favor. Help Kostya determine what team, the first one or the second one, has advantage in the match, and how large the advantage is." 2200

377B "Preparing for the Contest" "binary search,data structures,greedy,sortings" "Soon there will be held the world\'s largest programming contest, but the testing system still has m bugs. The contest organizer, a well-known university, has no choice but to attract university students to fix all the bugs. The university has n students able to perform such work. The students realize that they are the only hope of the organizers, so they don\'t want to work for free: the i-th student wants to get ci \'passes\' in his subjects (regardless of the volume of his work).Bugs, like students, are not the same: every bug is characterized by complexity aj, and every student has the level of his abilities bi. Student i can fix a bug j only if the level of his abilities is not less than the complexity of the bug: bi\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89aj, and he does it in one day. Otherwise, the bug will have to be fixed by another student. Of course, no student can work on a few bugs in one day. All bugs are not dependent on each other, so they can be corrected in any order, and different students can work simultaneously.The university wants to fix all the bugs as quickly as possible, but giving the students the total of not more than s passes. Determine which students to use for that and come up with the schedule of work saying which student should fix which bug." 1900

377A Maze "dfs and similar" "Pavel loves grid mazes. A grid maze is an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m rectangle maze where each cell is either empty, or is a wall. You can go from one cell to another only if both cells are empty and have a common side.Pavel drew a grid maze with all empty cells forming a connected area. That is, you can go from any empty cell to any other one. Pavel doesn\'t like it when his maze has too little walls. He wants to turn exactly k empty cells into walls so that all the remaining cells still formed a connected area. Help him." 1600

376B I.O.U. implementation "Imagine that there is a group of three friends: A, B and \xd0\xa1. A owes B 20 rubles and B owes C 20 rubles. The total sum of the debts is 40 rubles. You can see that the debts are not organized in a very optimal manner. Let\'s rearrange them like that: assume that A owes C 20 rubles and B doesn\'t owe anything to anybody. The debts still mean the same but the total sum of the debts now equals 20 rubles.This task is a generalisation of a described example. Imagine that your group of friends has n people and you know the debts between the people. Optimize the given debts without changing their meaning. In other words, finally for each friend the difference between the total money he should give and the total money he should take must be the same. Print the minimum sum of all debts in the optimal rearrangement of the debts. See the notes to the test samples to better understand the problem." 1300

376A Lever implementation,math "You have a description of a lever as string s. We\'ll represent the string length as record |s|, then the lever looks as a horizontal bar with weights of length |s|\xe2\x80\x89-\xe2\x80\x891 with exactly one pivot. We will assume that the bar is a segment on the Ox axis between points 0 and |s|\xe2\x80\x89-\xe2\x80\x891.The decoding of the lever description is given below.  If the i-th character of the string equals ""^"", that means that at coordinate i there is the pivot under the bar.  If the i-th character of the string equals ""="", that means that at coordinate i there is nothing lying on the bar.  If the i-th character of the string equals digit c (1-9), that means that at coordinate i there is a weight of mass c on the bar. Your task is, given the lever description, print if it will be in balance or not. Assume that the bar doesn\'t weight anything. Assume that the bar initially is in balance then all weights are simultaneously put on it. After that the bar either tilts to the left, or tilts to the right, or is in balance." 900

375E "Red and Black Tree" dp,implementation,math "You have a weighted tree, consisting of n vertices. Each vertex is either painted black or is painted red. A red and black tree is called beautiful, if for any its vertex we can find a black vertex at distance at most x.The distance between two nodes is the shortest path between them.You have a red and black tree. Your task is to make it beautiful in the minimum number of color swap operations. In one color swap operation, you can choose two vertices of different colors and paint each of them the other color. In other words, if you choose a red vertex p and a black vertex q, then in one operation you are allowed to paint p black and paint q red.Print the minimum number of required actions." 3000

375D "Tree and Queries" "data structures,dfs and similar,trees" "You have a rooted tree consisting of n vertices. Each vertex of the tree has some color. We will assume that the tree vertices are numbered by integers from 1 to n. Then we represent the color of vertex v as cv. The tree root is a vertex with number 1.In this problem you need to answer to m queries. Each query is described by two integers vj,\xe2\x80\x89kj. The answer to query vj,\xe2\x80\x89kj is the number of such colors of vertices x, that the subtree of vertex vj contains at least kj vertices of color x.You can find the definition of a rooted tree by the following link: http://en.wikipedia.org/wiki/Tree_(graph_theory)." 2400

375C "Circling Round Treasures" "bitmasks,shortest paths" "You have a map as a rectangle table. Each cell of the table is either an obstacle, or a treasure with a certain price, or a bomb, or an empty cell. Your initial position is also given to you.You can go from one cell of the map to a side-adjacent one. At that, you are not allowed to go beyond the borders of the map, enter the cells with treasures, obstacles and bombs. To pick the treasures, you need to build a closed path (starting and ending in the starting cell). The closed path mustn\'t contain any cells with bombs inside. Let\'s assume that the sum of the treasures\' values that are located inside the closed path equals v, and besides, you\'ve made k single moves (from one cell to another) while you were going through the path, then such path brings you the profit of v\xe2\x80\x89-\xe2\x80\x89k rubles.Your task is to build a closed path that doesn\'t contain any bombs and brings maximum profit.Note that the path can have self-intersections. In order to determine if a cell lies inside a path or not, use the following algorithm:  Assume that the table cells are points on the plane (the table cell on the intersection of the i-th column and the j-th row is point (i,\xe2\x80\x89j)). And the given path is a closed polyline that goes through these points.  You need to find out if the point p of the table that is not crossed by the polyline lies inside the polyline.  Let\'s draw a ray that starts from point p and does not intersect other points of the table (such ray must exist).  Let\'s count the number of segments of the polyline that intersect the painted ray. If this number is odd, we assume that point p (and consequently, the table cell) lie inside the polyline (path). Otherwise, we assume that it lies outside." 2600

375B "Maximum Submatrix 2" "data structures,dp,implementation,sortings" "You are given a matrix consisting of digits zero and one, its size is n\xe2\x80\x89\xc3\x97\xe2\x80\x89m. You are allowed to rearrange its rows. What is the maximum area of the submatrix that only consists of ones and can be obtained in the given problem by the described operations?Let\'s assume that the rows of matrix a are numbered from 1 to n from top to bottom and the columns are numbered from 1 to m from left to right. A matrix cell on the intersection of the i-th row and the j-th column can be represented as (i,\xe2\x80\x89j). Formally, a submatrix of matrix a is a group of four integers d,\xe2\x80\x89u,\xe2\x80\x89l,\xe2\x80\x89r (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89d\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89u\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n;�1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m). We will assume that the submatrix contains cells (i,\xe2\x80\x89j) (d\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89u;�l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r). The area of the submatrix is the number of cells it contains." 1600

375A "Divisible by Seven" "math,number theory" "You have number a, whose decimal representation quite luckily contains digits 1, 6, 8, 9. Rearrange the digits in its decimal representation so that the resulting number will be divisible by 7.Number a doesn\'t contain any leading zeroes and contains digits 1, 6, 8, 9 (it also can contain another digits). The resulting number also mustn\'t contain any leading zeroes." 1600

374E "Inna and Babies" "binary search,data structures,dsu,geometry,implementation" "Inna, Dima and Sereja are in one room together. It\'s cold outside, so Sereja suggested to play a board game called ""Babies"". The babies playing board is an infinite plane containing n blue babies and m red ones. Each baby is a segment that grows in time. At time moment t the blue baby (x,\xe2\x80\x89y) is a blue segment with ends at points (x\xe2\x80\x89-\xe2\x80\x89t,\xe2\x80\x89y\xe2\x80\x89+\xe2\x80\x89t), (x\xe2\x80\x89+\xe2\x80\x89t,\xe2\x80\x89y\xe2\x80\x89-\xe2\x80\x89t). Similarly, at time t the red baby (x,\xe2\x80\x89y) is a red segment with ends at points (x\xe2\x80\x89+\xe2\x80\x89t,\xe2\x80\x89y\xe2\x80\x89+\xe2\x80\x89t), (x\xe2\x80\x89-\xe2\x80\x89t,\xe2\x80\x89y\xe2\x80\x89-\xe2\x80\x89t) of the plane. Initially, at time t\xe2\x80\x89=\xe2\x80\x890 all babies are points on the plane.The goal of the game is to find the first integer moment of time when the plane contains a rectangle of a non-zero area which sides are fully covered by some babies. A side may be covered by multiple babies. More formally, each point of each side of the rectangle should be covered by at least one baby of any color. At that, you must assume that the babies are closed segments, that is, they contain their endpoints.You are given the positions of all babies \xe2\x80\x94 help Inna and Dima to find the required moment of time." 2600

374D "Inna and Sequence" "binary search,data structures,dp,trees" "Dima\'s spent much time thinking what present to give to Inna and gave her an empty sequence w. Now they want to fill sequence w with numbers zero and one. For that, they decided to play an amusing game. Before the game begins, Dima chooses m integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89am (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a1\xe2\x80\x89<\xe2\x80\x89a2\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89am). Then Inna and Dima start playing, that is, adding numbers to sequence w. Each new number they choose is added to the end of the sequence. At some moments of time Dima feels that the game is going to end too soon (and he wants to play with Inna as long as possible), so he hits a table hard with his fist. At that the a1-th, a2-th, a3-th, ..., ak-th numbers from the beginning simultaneously fall out of the sequence (the sequence gets k numbers less). Here k is such maximum number that value ak doesn\'t exceed the current length of the sequence. If number a1 is larger than the current length of w, then nothing falls out of the sequence.You are given the chronological sequence of events in the game. Each event is either adding a number to the end of sequence w or Dima\'s hit on the table. Calculate the sequence w after all these events happen." 2000

374C "Inna and Dima" "dfs and similar,dp,graphs,implementation" "Inna and Dima bought a table of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m in the shop. Each cell of the table contains a single letter: ""D"", ""I"", ""M"", ""A"".Inna loves Dima, so she wants to go through his name as many times as possible as she moves through the table. For that, Inna acts as follows:  initially, Inna chooses some cell of the table where letter ""D"" is written;  then Inna can move to some side-adjacent table cell that contains letter ""I""; then from this cell she can go to one of the side-adjacent table cells that contains the written letter ""M""; then she can go to a side-adjacent cell that contains letter ""A"". Then Inna assumes that she has gone through her sweetheart\'s name;  Inna\'s next move can be going to one of the side-adjacent table cells that contains letter ""D"" and then walk on through name DIMA in the similar manner. Inna never skips a letter. So, from the letter ""D"" she always goes to the letter ""I"", from the letter ""I"" she always goes the to letter ""M"", from the letter ""M"" she always goes to the letter ""A"", and from the letter ""A"" she always goes to the letter ""D"". Depending on the choice of the initial table cell, Inna can go through name DIMA either an infinite number of times or some positive finite number of times or she can\'t go through his name once. Help Inna find out what maximum number of times she can go through name DIMA." 1900

374B "Inna and Nine" combinatorics,greedy "Inna loves digit 9 very much. That\'s why she asked Dima to write a small number consisting of nines. But Dima must have misunderstood her and he wrote a very large number a, consisting of digits from 1 to 9.Inna wants to slightly alter the number Dima wrote so that in the end the number contained as many digits nine as possible. In one move, Inna can choose two adjacent digits in a number which sum equals 9 and replace them by a single digit 9.For instance, Inna can alter number 14545181 like this: 14545181\xe2\x80\x89\xe2\x86\x92\xe2\x80\x891945181\xe2\x80\x89\xe2\x86\x92\xe2\x80\x89194519\xe2\x80\x89\xe2\x86\x92\xe2\x80\x8919919. Also, she can use this method to transform number 14545181 into number 19991. Inna will not transform it into 149591 as she can get numbers 19919 and 19991 which contain more digits nine.Dima is a programmer so he wants to find out how many distinct numbers containing as many digits nine as possible Inna can get from the written number. Help him with this challenging task." 1500

374A "Inna and Pink Pony" greedy,implementation "Dima and Inna are doing so great! At the moment, Inna is sitting on the magic lawn playing with a pink pony. Dima wanted to play too. He brought an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m chessboard, a very tasty candy and two numbers a and b.Dima put the chessboard in front of Inna and placed the candy in position (i,\xe2\x80\x89j) on the board. The boy said he would give the candy if it reaches one of the corner cells of the board. He\'s got one more condition. There can only be actions of the following types:  move the candy from position (x,\xe2\x80\x89y) on the board to position (x\xe2\x80\x89-\xe2\x80\x89a,\xe2\x80\x89y\xe2\x80\x89-\xe2\x80\x89b);  move the candy from position (x,\xe2\x80\x89y) on the board to position (x\xe2\x80\x89+\xe2\x80\x89a,\xe2\x80\x89y\xe2\x80\x89-\xe2\x80\x89b);  move the candy from position (x,\xe2\x80\x89y) on the board to position (x\xe2\x80\x89-\xe2\x80\x89a,\xe2\x80\x89y\xe2\x80\x89+\xe2\x80\x89b);  move the candy from position (x,\xe2\x80\x89y) on the board to position (x\xe2\x80\x89+\xe2\x80\x89a,\xe2\x80\x89y\xe2\x80\x89+\xe2\x80\x89b). Naturally, Dima doesn\'t allow to move the candy beyond the chessboard borders.Inna and the pony started shifting the candy around the board. They wonder what is the minimum number of allowed actions that they need to perform to move the candy from the initial position (i,\xe2\x80\x89j) to one of the chessboard corners. Help them cope with the task!" 2000

373B "Making Sequences is Fun" "binary search,implementation,math" "We\'ll define S(n) for positive integer n as follows: the number of the n\'s digits in the decimal base. For example, S(893)\xe2\x80\x89=\xe2\x80\x893, S(114514)\xe2\x80\x89=\xe2\x80\x896.You want to make a consecutive integer sequence starting from number m (m,\xe2\x80\x89m\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...). But you need to pay S(n)\xc2\xb7k to add the number n to the sequence.You can spend a cost up to w, and you want to make the sequence as long as possible. Write a program that tells sequence\'s maximum length." 1600

373A "Collecting Beats is Fun" implementation "Cucumber boy is fan of Kyubeat, a famous music game.Kyubeat has 16 panels for playing arranged in 4\xe2\x80\x89\xc3\x97\xe2\x80\x894 table. When a panel lights up, he has to press that panel.Each panel has a timing to press (the preffered time when a player should press it), and Cucumber boy is able to press at most k panels in a time with his one hand. Cucumber boy is trying to press all panels in perfect timing, that is he wants to press each panel exactly in its preffered time. If he cannot press the panels with his two hands in perfect timing, his challenge to press all the panels in perfect timing will fail.You are given one scene of Kyubeat\'s panel from the music Cucumber boy is trying. Tell him is he able to press all the panels in perfect timing." 900

372E "Drawing Circles is Fun" combinatorics,geometry "There are a set of points S on the plane. This set doesn\'t contain the origin O(0,\xe2\x80\x890), and for each two distinct points in the set A and B, the triangle OAB has strictly positive area.Consider a set of pairs of points (P1,\xe2\x80\x89P2),\xe2\x80\x89(P3,\xe2\x80\x89P4),\xe2\x80\x89...,\xe2\x80\x89(P2k\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89P2k). We\'ll call the set good if and only if:  k\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x892.  All Pi are distinct, and each Pi is an element of S.  For any two pairs (P2i\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89P2i) and (P2j\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89P2j), the circumcircles of triangles OP2i\xe2\x80\x89-\xe2\x80\x891P2j\xe2\x80\x89-\xe2\x80\x891 and OP2iP2j have a single common point, and the circumcircle of triangles OP2i\xe2\x80\x89-\xe2\x80\x891P2j and OP2iP2j\xe2\x80\x89-\xe2\x80\x891 have a single common point. Calculate the number of good sets of pairs modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." 3000

372D "Choosing Subtree is Fun" "binary search,data structures,dfs and similar,trees,two pointers" "There is a tree consisting of n vertices. The vertices are numbered from 1 to n.Let\'s define the length of an interval [l,\xe2\x80\x89r] as the value r\xe2\x80\x89-\xe2\x80\x89l\xe2\x80\x89+\xe2\x80\x891. The score of a subtree of this tree is the maximum length of such an interval [l,\xe2\x80\x89r] that, the vertices with numbers l,\xe2\x80\x89l\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89r belong to the subtree.Considering all subtrees of the tree whose size is at most k, return the maximum score of the subtree. Note, that in this problem tree is not rooted, so a subtree \xe2\x80\x94 is an arbitrary connected subgraph of the tree." 2600

372C "Watching Fireworks is Fun" "data structures,dp,math" "A festival will be held in a town\'s main street. There are n sections in the main street. The sections are numbered 1 through n from left to right. The distance between each adjacent sections is 1.In the festival m fireworks will be launched. The i-th (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m) launching is on time ti at section ai. If you are at section x (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) at the time of i-th launching, you\'ll gain happiness value bi\xe2\x80\x89-\xe2\x80\x89|ai\xe2\x80\x89-\xe2\x80\x89x| (note that the happiness value might be a negative value).You can move up to d length units in a unit time interval, but it\'s prohibited to go out of the main street. Also you can be in an arbitrary section at initial time moment (time equals to 1), and want to maximize the sum of happiness that can be gained from watching fireworks. Find the maximum total happiness.Note that two or more fireworks can be launched at the same time." 2100

372B "Counting Rectangles is Fun" "brute force,divide and conquer,dp" "There is an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m rectangular grid, each cell of the grid contains a single integer: zero or one. Let\'s call the cell on the i-th row and the j-th column as (i,\xe2\x80\x89j).Let\'s define a ""rectangle"" as four integers a,\xe2\x80\x89b,\xe2\x80\x89c,\xe2\x80\x89d (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89c\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n;�1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89d\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m). Rectangle denotes a set of cells of the grid {(x,\xe2\x80\x89y)�:\xe2\x80\x89�a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89c,\xe2\x80\x89b\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89d}. Let\'s define a ""good rectangle"" as a rectangle that includes only the cells with zeros.You should answer the following q queries: calculate the number of good rectangles all of which cells are in the given rectangle." 1900

372A "Counting Kangaroos is Fun" "binary search,greedy,sortings,two pointers" "There are n kangaroos with pockets. Each kangaroo has a size (integer number). A kangaroo can go into another kangaroo\'s pocket if and only if the size of kangaroo who hold the kangaroo is at least twice as large as the size of kangaroo who is held.Each kangaroo can hold at most one kangaroo, and the kangaroo who is held by another kangaroo cannot hold any kangaroos.The kangaroo who is held by another kangaroo cannot be visible from outside. Please, find a plan of holding kangaroos with the minimal number of kangaroos who is visible." 1600

371E "Subway Innovation" "greedy,math,two pointers" "Berland is going through tough times \xe2\x80\x94 the dirt price has dropped and that is a blow to the country\'s economy. Everybody knows that Berland is the top world dirt exporter!The President of Berland was forced to leave only k of the currently existing n subway stations.The subway stations are located on a straight line one after another, the trains consecutively visit the stations as they move. You can assume that the stations are on the Ox axis, the i-th station is at point with coordinate xi. In such case the distance between stations i and j is calculated by a simple formula |xi\xe2\x80\x89-\xe2\x80\x89xj|.Currently, the Ministry of Transport is choosing which stations to close and which ones to leave. Obviously, the residents of the capital won\'t be too enthusiastic about the innovation, so it was decided to show the best side to the people. The Ministry of Transport wants to choose such k stations that minimize the average commute time in the subway!Assuming that the train speed is constant (it is a fixed value), the average commute time in the subway is calculated as the sum of pairwise distances between stations, divided by the number of pairs (that is ) and divided by the speed of the train.Help the Minister of Transport to solve this difficult problem. Write a program that, given the location of the stations selects such k stations that the average commute time in the subway is minimized." 2000

371D Vessels "data structures,dsu,implementation,trees" "There is a system of n vessels arranged one above the other as shown in the figure below. Assume that the vessels are numbered from 1 to n, in the order from the highest to the lowest, the volume of the i-th vessel is ai liters.  Initially, all the vessels are empty. In some vessels water is poured. All the water that overflows from the i-th vessel goes to the (i\xe2\x80\x89+\xe2\x80\x891)-th one. The liquid that overflows from the n-th vessel spills on the floor.Your task is to simulate pouring water into the vessels. To do this, you will need to handle two types of queries:  Add xi liters of water to the pi-th vessel;  Print the number of liters of water in the ki-th vessel. When you reply to the second request you can assume that all the water poured up to this point, has already overflown between the vessels." 1800

371C Hamburgers "binary search,brute force" "Polycarpus loves hamburgers very much. He especially adores the hamburgers he makes with his own hands. Polycarpus thinks that there are only three decent ingredients to make hamburgers from: a bread, sausage and cheese. He writes down the recipe of his favorite ""Le Hamburger de Polycarpus"" as a string of letters \'B\' (bread), \'S\' (sausage) \xd0\xb8 \'C\' (cheese). The ingredients in the recipe go from bottom to top, for example, recipe ""\xd0\x92SCBS"" represents the hamburger where the ingredients go from bottom to top as bread, sausage, cheese, bread and sausage again.Polycarpus has nb pieces of bread, ns pieces of sausage and nc pieces of cheese in the kitchen. Besides, the shop nearby has all three ingredients, the prices are pb rubles for a piece of bread, ps for a piece of sausage and pc for a piece of cheese.Polycarpus has r rubles and he is ready to shop on them. What maximum number of hamburgers can he cook? You can assume that Polycarpus cannot break or slice any of the pieces of bread, sausage or cheese. Besides, the shop has an unlimited number of pieces of each ingredient." 1600

371B "Fox Dividing Cheese" "math,number theory" "Two little greedy bears have found two pieces of cheese in the forest of weight a and b grams, correspondingly. The bears are so greedy that they are ready to fight for the larger piece. That\'s where the fox comes in and starts the dialog: ""Little bears, wait a little, I want to make your pieces equal"" ""Come off it fox, how are you going to do that?"", the curious bears asked. ""It\'s easy"", said the fox. ""If the mass of a certain piece is divisible by two, then I can eat exactly a half of the piece. If the mass of a certain piece is divisible by three, then I can eat exactly two-thirds, and if the mass is divisible by five, then I can eat four-fifths. I\'ll eat a little here and there and make the pieces equal"". The little bears realize that the fox\'s proposal contains a catch. But at the same time they realize that they can not make the two pieces equal themselves. So they agreed to her proposal, but on one condition: the fox should make the pieces equal as quickly as possible. Find the minimum number of operations the fox needs to make pieces equal." 1300

371A "K-Periodic Array" greedy,implementation,math "This task will exclusively concentrate only on the arrays where all elements equal 1 and/or 2.Array a is k-period if its length is divisible by k and there is such array b of length k, that a is represented by array b written exactly  times consecutively. In other words, array a is k-periodic, if it has period of length k.For example, any array is n-periodic, where n is the array length. Array [2,\xe2\x80\x891,\xe2\x80\x892,\xe2\x80\x891,\xe2\x80\x892,\xe2\x80\x891] is at the same time 2-periodic and 6-periodic and array [1,\xe2\x80\x892,\xe2\x80\x891,\xe2\x80\x891,\xe2\x80\x892,\xe2\x80\x891,\xe2\x80\x891,\xe2\x80\x892,\xe2\x80\x891] is at the same time 3-periodic and 9-periodic.For the given array a, consisting only of numbers one and two, find the minimum number of elements to change to make the array k-periodic. If the array already is k-periodic, then the required value equals 0." 1000

370E "Summer Reading" dp,greedy "At school Vasya got an impressive list of summer reading books. Unlike other modern schoolchildren, Vasya loves reading, so he read some book each day of the summer.As Vasya was reading books, he was making notes in the Reader\'s Diary. Each day he wrote the orderal number of the book he was reading. The books in the list are numbered starting from 1 and Vasya was reading them in the order they go in the list. Vasya never reads a new book until he finishes reading the previous one. Unfortunately, Vasya wasn\'t accurate and some days he forgot to note the number of the book and the notes for those days remained empty.As Vasya knows that the literature teacher will want to check the Reader\'s Diary, so he needs to restore the lost records. Help him do it and fill all the blanks. Vasya is sure that he spends at least two and at most five days for each book. Vasya finished reading all the books he had started. Assume that the reading list contained many books. So many, in fact, that it is impossible to read all of them in a summer. If there are multiple valid ways to restore the diary records, Vasya prefers the one that shows the maximum number of read books." 2500

370D "Broken Monitor" "brute force,constructive algorithms,greedy,implementation" "Innocentius has a problem \xe2\x80\x94 his computer monitor has broken. Now some of the pixels are ""dead"", that is, they are always black. As consequence, Innocentius can\'t play the usual computer games. He is recently playing the following game with his younger brother Polycarpus.Innocentius is touch-typing a program that paints a white square one-pixel wide frame on the black screen. As the monitor is broken, some pixels that should be white remain black. Polycarpus should look at what the program displayed on the screen and guess the position and size of the frame Innocentius has painted. Polycarpus doesn\'t like the game but Innocentius persuaded brother to play as ""the game is good for the imagination and attention"".Help Polycarpus, automatize his part in the gaming process. Write the code that finds such possible square frame that:  the frame\'s width is 1 pixel,  the frame doesn\'t go beyond the borders of the screen,  all white pixels of the monitor are located on the frame,  of all frames that satisfy the previous three conditions, the required frame must have the smallest size. Formally, a square frame is represented by such pixels of the solid square, that are on the square\'s border, that is, are not fully surrounded by the other pixels of the square. For example, if the frame\'s size is d\xe2\x80\x89=\xe2\x80\x893, then it consists of 8 pixels, if its size is d\xe2\x80\x89=\xe2\x80\x892, then it contains 4 pixels and if d\xe2\x80\x89=\xe2\x80\x891, then the frame is reduced to a single pixel." 2100

370C Mittens "constructive algorithms,greedy,sortings" "A Christmas party in city S. had n children. All children came in mittens. The mittens can be of different colors, but each child had the left and the right mitten of the same color. Let\'s say that the colors of the mittens are numbered with integers from 1 to m, and the children are numbered from 1 to n. Then the i-th child has both mittens of color ci.The Party had Santa Claus (\'Father Frost\' in Russian), his granddaughter Snow Girl, the children danced around the richly decorated Christmas tree. In fact, everything was so bright and diverse that the children wanted to wear mittens of distinct colors. The children decided to swap the mittens so that each of them got one left and one right mitten in the end, and these two mittens were of distinct colors. All mittens are of the same size and fit all the children.The children started exchanging the mittens haphazardly, but they couldn\'t reach the situation when each child has a pair of mittens of distinct colors. Vasily Petrov, the dad of one of the children, noted that in the general case the children\'s idea may turn out impossible. Besides, he is a mathematician and he came up with such scheme of distributing mittens that the number of children that have distinct-colored mittens was maximum. You task is to repeat his discovery. Note that the left and right mittens are different: each child must end up with one left and one right mitten." 1800

370B "Berland Bingo" implementation "Lately, a national version of a bingo game has become very popular in Berland. There are n players playing the game, each player has a card with numbers. The numbers on each card are distinct, but distinct cards can have equal numbers. The card of the i-th player contains mi numbers.During the game the host takes numbered balls one by one from a bag. He reads the number aloud in a high and clear voice and then puts the ball away. All participants cross out the number if it occurs on their cards. The person who crosses out all numbers from his card first, wins. If multiple people cross out all numbers from their cards at the same time, there are no winners in the game. At the beginning of the game the bag contains 100 balls numbered 1 through 100, the numbers of all balls are distinct.You are given the cards for each player. Write a program that determines whether a player can win the game at the most favorable for him scenario or not." 1300

370A "Rook, Bishop and King" "graphs,math,shortest paths" "Little Petya is learning to play chess. He has already learned how to move a king, a rook and a bishop. Let us remind you the rules of moving chess pieces. A chessboard is 64 square fields organized into an 8\xe2\x80\x89\xc3\x97\xe2\x80\x898 table. A field is represented by a pair of integers (r,\xe2\x80\x89c) \xe2\x80\x94 the number of the row and the number of the column (in a classical game the columns are traditionally indexed by letters). Each chess piece takes up exactly one field. To make a move is to move a chess piece, the pieces move by the following rules:  A rook moves any number of fields horizontally or vertically.  A bishop moves any number of fields diagonally.  A king moves one field in any direction \xe2\x80\x94 horizontally, vertically or diagonally.   The pieces move like that Petya is thinking about the following problem: what minimum number of moves is needed for each of these pieces to move from field (r1,\xe2\x80\x89c1) to field (r2,\xe2\x80\x89c2)? At that, we assume that there are no more pieces besides this one on the board. Help him solve this problem." 1100

369E "Valera and Queries" "binary search,data structures" "Valera loves segments. He has recently come up with one interesting problem.The Ox axis of coordinates has n segments, the i-th segment starts in position li and ends in position ri (we will mark it as [li,\xe2\x80\x89ri]). Your task is to process m queries, each consists of number cnti and a set of cnti coordinates of points located on the Ox axis. The answer to the query is the number of segments, such that each of them contains at least one point from the query. Segment [l,\xe2\x80\x89r] contains point q, if l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89q\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r.Valera found the solution of this problem too difficult. So he asked you to help him. Help Valera." 2200

369D "Valera and Fools" "dfs and similar,dp,graphs,shortest paths" "One fine morning, n fools lined up in a row. After that, they numbered each other with numbers from 1 to n, inclusive. Each fool got a unique number. The fools decided not to change their numbers before the end of the fun.Every fool has exactly k bullets and a pistol. In addition, the fool number i has probability of pi (in percent) that he kills the fool he shoots at.The fools decided to have several rounds of the fun. Each round of the fun looks like this: each currently living fool shoots at another living fool with the smallest number (a fool is not stupid enough to shoot at himself). All shots of the round are perfomed at one time (simultaneously). If there is exactly one living fool, he does not shoot.Let\'s define a situation as the set of numbers of all the living fools at the some time. We say that a situation is possible if for some integer number j (0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k) there is a nonzero probability that after j rounds of the fun this situation will occur.Valera knows numbers p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pn and k. Help Valera determine the number of distinct possible situations." 2200

369C "Valera and Elections" "dfs and similar,graphs,trees" "The city Valera lives in is going to hold elections to the city Parliament.The city has n districts and n\xe2\x80\x89-\xe2\x80\x891 bidirectional roads. We know that from any district there is a path along the roads to any other district. Let\'s enumerate all districts in some way by integers from 1 to n, inclusive. Furthermore, for each road the residents decided if it is the problem road or not. A problem road is a road that needs to be repaired.There are n candidates running the elections. Let\'s enumerate all candidates in some way by integers from 1 to n, inclusive. If the candidate number i will be elected in the city Parliament, he will perform exactly one promise \xe2\x80\x94 to repair all problem roads on the way from the i-th district to the district 1, where the city Parliament is located.Help Valera and determine the subset of candidates such that if all candidates from the subset will be elected to the city Parliament, all problem roads in the city will be repaired. If there are several such subsets, you should choose the subset consisting of the minimum number of candidates." 1600

369B "Valera and Contest" "constructive algorithms,implementation,math" "Valera loves to participate in competitions. Especially in programming contests. Today he has participated in the contest with his team, consisting of n students (including Valera). This contest was an individual competition, so each student in the team solved problems individually.After the contest was over, Valera was interested in results. He found out that:  each student in the team scored at least l points and at most r points;  in total, all members of the team scored exactly sall points;  the total score of the k members of the team who scored the most points is equal to exactly sk; more formally, if a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an is the sequence of points earned by the team of students in the non-increasing order (a1\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89a2\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89...\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89an), then sk\xe2\x80\x89=\xe2\x80\x89a1\xe2\x80\x89+\xe2\x80\x89a2\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89ak. However, Valera did not find out exactly how many points each of n students scored. Valera asked you to recover any distribution of scores between the students of the team, such that all the conditions above are met." 1400

369A "Valera and Plates" greedy,implementation "Valera is a lazy student. He has m clean bowls and k clean plates. Valera has made an eating plan for the next n days. As Valera is lazy, he will eat exactly one dish per day. At that, in order to eat a dish, he needs exactly one clean plate or bowl. We know that Valera can cook only two types of dishes. He can eat dishes of the first type from bowls and dishes of the second type from either bowls or plates. When Valera finishes eating, he leaves a dirty plate/bowl behind. His life philosophy doesn\'t let him eat from dirty kitchenware. So sometimes he needs to wash his plate/bowl before eating. Find the minimum number of times Valera will need to wash a plate/bowl, if he acts optimally." 900

368B "Sereja and Suffixes" "data structures,dp" "Sereja has an array a, consisting of n integers a1, a2, ..., an. The boy cannot sit and do nothing, he decided to study an array. Sereja took a piece of paper and wrote out m integers l1,\xe2\x80\x89l2,\xe2\x80\x89...,\xe2\x80\x89lm (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89li\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n). For each number li he wants to know how many distinct numbers are staying on the positions li, li\xe2\x80\x89+\xe2\x80\x891, ..., n. Formally, he want to find the number of distinct numbers among ali,\xe2\x80\x89ali\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89an.?Sereja wrote out the necessary array elements but the array was so large and the boy was so pressed for time. Help him, find the answer for the described question for each li." 1100

368A "Sereja and Coat Rack" implementation "Sereja owns a restaurant for n people. The restaurant hall has a coat rack with n hooks. Each restaurant visitor can use a hook to hang his clothes on it. Using the i-th hook costs ai rubles. Only one person can hang clothes on one hook.Tonight Sereja expects m guests in the restaurant. Naturally, each guest wants to hang his clothes on an available hook with minimum price (if there are multiple such hooks, he chooses any of them). However if the moment a guest arrives the rack has no available hooks, Sereja must pay a d ruble fine to the guest. Help Sereja find out the profit in rubles (possibly negative) that he will get tonight. You can assume that before the guests arrive, all hooks on the rack are available, all guests come at different time, nobody besides the m guests is visiting Sereja\'s restaurant tonight." 1000

367E "Sereja and Intervals" combinatorics,dp "Sereja is interested in intervals of numbers, so he has prepared a problem about intervals for you. An interval of numbers is a pair of integers [l,\xe2\x80\x89r] (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m). Interval [l1,\xe2\x80\x89r1] belongs to interval [l2,\xe2\x80\x89r2] if the following condition is met: l2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r2.Sereja wants to write out a sequence of n intervals [l1,\xe2\x80\x89r1], [l2,\xe2\x80\x89r2], ..., [ln,\xe2\x80\x89rn] on a piece of paper. At that, no interval in the sequence can belong to some other interval of the sequence. Also, Sereja loves number x very much and he wants some (at least one) interval in the sequence to have li\xe2\x80\x89=\xe2\x80\x89x. Sereja wonders, how many distinct ways to write such intervals are there?Help Sereja and find the required number of ways modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897).Two ways are considered distinct if there is such j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n), that the j-th intervals in two corresponding sequences are not equal." 2700

367D "Sereja and Sets" "bitmasks,dfs and similar" "Sereja has m non-empty sets of integers A1,\xe2\x80\x89A2,\xe2\x80\x89...,\xe2\x80\x89Am. What a lucky coincidence! The given sets are a partition of the set of all integers from 1 to n. In other words, for any integer v (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89v\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) there is exactly one set At such that . Also Sereja has integer d.Sereja decided to choose some sets from the sets he has. Let\'s suppose that i1,\xe2\x80\x89i2,\xe2\x80\x89...,\xe2\x80\x89ik (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i1\xe2\x80\x89<\xe2\x80\x89i2\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89ik\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m) are indexes of the chosen sets. Then let\'s define an array of integers b, sorted in ascending order, as a union of the chosen sets, that is, . We\'ll represent the element with number j in this array (in ascending order) as bj. Sereja considers his choice of sets correct, if the following conditions are met:b1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89d;�bi\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89-\xe2\x80\x89bi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89d�(1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89|b|);�n\xe2\x80\x89-\xe2\x80\x89d\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b|b|.Sereja wants to know what is the minimum number of sets (k) that he can choose so that his choice will be correct. Help him with that." 2400

367C "Sereja and the Arrangement of Numbers" graphs,greedy,sortings "Let\'s call an array consisting of n integer numbers a1, a2, ..., an, beautiful if it has the following property:  consider all pairs of numbers x,\xe2\x80\x89y (x\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89y), such that number x occurs in the array a and number y occurs in the array a;  for each pair x,\xe2\x80\x89y must exist some position j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89<\xe2\x80\x89n), such that at least one of the two conditions are met, either aj\xe2\x80\x89=\xe2\x80\x89x,\xe2\x80\x89aj\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89=\xe2\x80\x89y, or aj\xe2\x80\x89=\xe2\x80\x89y,\xe2\x80\x89aj\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89=\xe2\x80\x89x. Sereja wants to build a beautiful array a, consisting of n integers. But not everything is so easy, Sereja\'s friend Dima has m coupons, each contains two integers qi,\xe2\x80\x89wi. Coupon i costs wi and allows you to use as many numbers qi as you want when constructing the array a. Values qi are distinct. Sereja has no coupons, so Dima and Sereja have made the following deal. Dima builds some beautiful array a of n elements. After that he takes wi rubles from Sereja for each qi, which occurs in the array a. Sereja believed his friend and agreed to the contract, and now he is wondering, what is the maximum amount of money he can pay.Help Sereja, find the maximum amount of money he can pay to Dima." 2000

367B "Sereja ans Anagrams" "binary search,data structures" "Sereja has two sequences a and b and number p. Sequence a consists of n integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. Similarly, sequence b consists of m integers b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bm. As usual, Sereja studies the sequences he has. Today he wants to find the number of positions q (q\xe2\x80\x89+\xe2\x80\x89(m\xe2\x80\x89-\xe2\x80\x891)\xc2\xb7p\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n;�q\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x891), such that sequence b can be obtained from sequence aq,\xe2\x80\x89aq\xe2\x80\x89+\xe2\x80\x89p,\xe2\x80\x89aq\xe2\x80\x89+\xe2\x80\x892p,\xe2\x80\x89...,\xe2\x80\x89aq\xe2\x80\x89+\xe2\x80\x89(m\xe2\x80\x89-\xe2\x80\x891)p by rearranging elements.Sereja needs to rush to the gym, so he asked to find all the described positions of q." 1900

367A "Sereja and Algorithm" "data structures,implementation" "Sereja loves all sorts of algorithms. He has recently come up with a new algorithm, which receives a string as an input. Let\'s represent the input string of the algorithm as q\xe2\x80\x89=\xe2\x80\x89q1q2... qk. The algorithm consists of two steps:  Find any continuous subsequence (substring) of three characters of string q, which doesn\'t equal to either string ""zyx"", ""xzy"", ""yxz"". If q doesn\'t contain any such subsequence, terminate the algorithm, otherwise go to step 2.  Rearrange the letters of the found subsequence randomly and go to step 1. Sereja thinks that the algorithm works correctly on string q if there is a non-zero probability that the algorithm will be terminated. But if the algorithm anyway will work for infinitely long on a string, then we consider the algorithm to work incorrectly on this string.Sereja wants to test his algorithm. For that, he has string s\xe2\x80\x89=\xe2\x80\x89s1s2... sn, consisting of n characters. The boy conducts a series of m tests. As the i-th test, he sends substring slisli\xe2\x80\x89+\xe2\x80\x891... sri (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89li\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ri\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) to the algorithm input. Unfortunately, the implementation of his algorithm works too long, so Sereja asked you to help. For each test (li,\xe2\x80\x89ri) determine if the algorithm works correctly on this test or not." 1500

366E "Dima and Magic Guitar" "brute force,implementation,math" "Dima loves Inna very much. He decided to write a song for her. Dima has a magic guitar with n strings and m frets. Dima makes the guitar produce sounds like that: to play a note, he needs to hold one of the strings on one of the frets and then pull the string. When Dima pulls the i-th string holding it on the j-th fret the guitar produces a note, let\'s denote it as aij. We know that Dima\'s guitar can produce k distinct notes. It is possible that some notes can be produced in multiple ways. In other words, it is possible that aij\xe2\x80\x89=\xe2\x80\x89apq at (i,\xe2\x80\x89j)\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89(p,\xe2\x80\x89q).Dima has already written a song \xe2\x80\x94 a sequence of s notes. In order to play the song, you need to consecutively produce the notes from the song on the guitar. You can produce each note in any available way. Dima understood that there are many ways to play a song and he wants to play it so as to make the song look as complicated as possible (try to act like Cobein).We\'ll represent a way to play a song as a sequence of pairs (xi,\xe2\x80\x89yi) (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89s), such that the xi-th string on the yi-th fret produces the i-th note from the song. The complexity of moving between pairs (x1,\xe2\x80\x89y1) and (x2,\xe2\x80\x89y2) equals  + . The complexity of a way to play a song is the maximum of complexities of moving between adjacent pairs.Help Dima determine the maximum complexity of the way to play his song! The guy\'s gotta look cool!" 2200

366D "Dima and Trap Graph" "binary search,data structures,dfs and similar,dsu,shortest paths,two pointers" "Dima and Inna love spending time together. The problem is, Seryozha isn\'t too enthusiastic to leave his room for some reason. But Dima and Inna love each other so much that they decided to get criminal...Dima constructed a trap graph. He shouted: ""Hey Seryozha, have a look at my cool graph!"" to get his roommate interested and kicked him into the first node.A trap graph is an undirected graph consisting of n nodes and m edges. For edge number k, Dima denoted a range of integers from lk to rk (lk\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89rk). In order to get out of the trap graph, Seryozha initially (before starting his movements) should pick some integer (let\'s call it x), then Seryozha must go some way from the starting node with number 1 to the final node with number n. At that, Seryozha can go along edge k only if lk\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89rk.Seryozha is a mathematician. He defined the loyalty of some path from the 1-st node to the n-th one as the number of integers x, such that if he initially chooses one of them, he passes the whole path. Help Seryozha find the path of maximum loyalty and return to his room as quickly as possible!" 2000

366C "Dima and Salad" dp "Dima, Inna and Seryozha have gathered in a room. That\'s right, someone\'s got to go. To cheer Seryozha up and inspire him to have a walk, Inna decided to cook something. Dima and Seryozha have n fruits in the fridge. Each fruit has two parameters: the taste and the number of calories. Inna decided to make a fruit salad, so she wants to take some fruits from the fridge for it. Inna follows a certain principle as she chooses the fruits: the total taste to the total calories ratio of the chosen fruits must equal k. In other words,  , where aj is the taste of the j-th chosen fruit and bj is its calories.Inna hasn\'t chosen the fruits yet, she is thinking: what is the maximum taste of the chosen fruits if she strictly follows her principle? Help Inna solve this culinary problem \xe2\x80\x94 now the happiness of a young couple is in your hands!Inna loves Dima very much so she wants to make the salad from at least one fruit." 1900

366B "Dima and To-do List" "brute force,implementation" "You helped Dima to have a great weekend, but it\'s time to work. Naturally, Dima, as all other men who have girlfriends, does everything wrong.Inna and Dima are now in one room. Inna tells Dima off for everything he does in her presence. After Inna tells him off for something, she goes to another room, walks there in circles muttering about how useless her sweetheart is. During that time Dima has time to peacefully complete k\xe2\x80\x89-\xe2\x80\x891 tasks. Then Inna returns and tells Dima off for the next task he does in her presence and goes to another room again. It continues until Dima is through with his tasks.Overall, Dima has n tasks to do, each task has a unique number from 1 to n. Dima loves order, so he does tasks consecutively, starting from some task. For example, if Dima has 6 tasks to do in total, then, if he starts from the 5-th task, the order is like that: first Dima does the 5-th task, then the 6-th one, then the 1-st one, then the 2-nd one, then the 3-rd one, then the 4-th one.Inna tells Dima off (only lovingly and appropriately!) so often and systematically that he\'s very well learned the power with which she tells him off for each task. Help Dima choose the first task so that in total he gets told off with as little power as possible." 1200

366A "Dima and Guards" implementation "Nothing has changed since the last round. Dima and Inna still love each other and want to be together. They\'ve made a deal with Seryozha and now they need to make a deal with the dorm guards...There are four guardposts in Dima\'s dorm. Each post contains two guards (in Russia they are usually elderly women). You can bribe a guard by a chocolate bar or a box of juice. For each guard you know the minimum price of the chocolate bar she can accept as a gift and the minimum price of the box of juice she can accept as a gift. If a chocolate bar for some guard costs less than the minimum chocolate bar price for this guard is, or if a box of juice for some guard costs less than the minimum box of juice price for this guard is, then the guard doesn\'t accept such a gift.In order to pass through a guardpost, one needs to bribe both guards.The shop has an unlimited amount of juice and chocolate of any price starting with 1. Dima wants to choose some guardpost, buy one gift for each guard from the guardpost and spend exactly n rubles on it.Help him choose a post through which he can safely sneak Inna or otherwise say that this is impossible. Mind you, Inna would be very sorry to hear that!" 1100

365B "The Fibonacci Segment" implementation "You have array a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. Segment [l,\xe2\x80\x89r] (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) is good if ai\xe2\x80\x89=\xe2\x80\x89ai\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x89ai\xe2\x80\x89-\xe2\x80\x892, for all i (l\xe2\x80\x89+\xe2\x80\x892\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r).Let\'s define len([l,\xe2\x80\x89r])\xe2\x80\x89=\xe2\x80\x89r\xe2\x80\x89-\xe2\x80\x89l\xe2\x80\x89+\xe2\x80\x891, len([l,\xe2\x80\x89r]) is the length of the segment [l,\xe2\x80\x89r]. Segment [l1,\xe2\x80\x89r1], is longer than segment [l2,\xe2\x80\x89r2], if len([l1,\xe2\x80\x89r1])\xe2\x80\x89>\xe2\x80\x89len([l2,\xe2\x80\x89r2]).Your task is to find a good segment of the maximum length in array a. Note that a segment of length 1 or 2 is always good." 1100

365A "Good Number" implementation "Let\'s call a number k-good if it contains all digits not exceeding k (0,\xe2\x80\x89...,\xe2\x80\x89k). You\'ve got a number k and an array a containing n numbers. Find out how many k-good numbers are in a (count each number every time it occurs in array a)." 1100

364E "Empty Rectangles" "divide and conquer,two pointers" "You\'ve got an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m table (n rows and m columns), each cell of the table contains a ""0"" or a ""1"".Your task is to calculate the number of rectangles with the sides that are parallel to the sides of the table and go along the cell borders, such that the number one occurs exactly k times in the rectangle." 3000

364D Ghd "brute force,math,probabilities" "John Doe offered his sister Jane Doe find the gcd of some set of numbers a.Gcd is a positive integer g, such that all number from the set are evenly divisible by g and there isn\'t such g\' (g\'\xe2\x80\x89>\xe2\x80\x89g), that all numbers of the set are evenly divisible by g\'.Unfortunately Jane couldn\'t cope with the task and John offered her to find the ghd of the same subset of numbers.Ghd is a positive integer g, such that at least half of numbers from the set are evenly divisible by g and there isn\'t such g\' (g\'\xe2\x80\x89>\xe2\x80\x89g) that at least half of the numbers from the set are evenly divisible by g\'.Jane coped with the task for two hours. Please try it, too." 2900

364C "Beautiful Set" "brute force,number theory" "We\'ll call a set of positive integers a beautiful if the following condition fulfills: for any prime p, if , then . In other words, if one number from the set is divisible by prime p, then at least half of numbers from the set is divisible by p.Your task is to find any beautiful set, where the number of elements is equal to k and each element doesn\'t exceed 2k2." 2300

364B "Free Market" dp,greedy "John Doe has recently found a ""Free Market"" in his city \xe2\x80\x94 that is the place where you can exchange some of your possessions for other things for free. John knows that his city has n items in total (each item is unique). You can bring any number of items to the market and exchange them for any other one. Note that each item is one of a kind and that means that you cannot exchange set {a,\xe2\x80\x89b} for set {v,\xe2\x80\x89a}. However, you can always exchange set x for any set y, unless there is item p, such that p occurs in x and p occurs in y.For each item, John knows its value ci. John\'s sense of justice doesn\'t let him exchange a set of items x for a set of items y, if s(x)\xe2\x80\x89+\xe2\x80\x89d\xe2\x80\x89<\xe2\x80\x89s(y) (s(x) is the total price of items in the set x). During one day John can exchange only one set of items for something else. Initially, he has no items. John wants to get a set of items with the maximum total price. Find the cost of such set and the minimum number of days John can get it in." 2200

364A Matrix "combinatorics,data structures,implementation" "You have a string of decimal digits s. Let\'s define bij\xe2\x80\x89=\xe2\x80\x89si\xc2\xb7sj. Find in matrix b the number of such rectangles that the sum bij for all cells (i,\xe2\x80\x89j) that are the elements of the rectangle equals a in each rectangle.A rectangle in a matrix is a group of four integers (x,\xe2\x80\x89y,\xe2\x80\x89z,\xe2\x80\x89t) (x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y,\xe2\x80\x89z\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89t). The elements of the rectangle are all cells (i,\xe2\x80\x89j) such that x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y,\xe2\x80\x89z\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89t." 1600

363E "Two Circles" "brute force,data structures,implementation" "Let\'s assume that we are given an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m table filled by integers. We\'ll mark a cell in the i-th row and j-th column as (i,\xe2\x80\x89j). Thus, (1,\xe2\x80\x891) is the upper left cell of the table and (n,\xe2\x80\x89m) is the lower right cell. We\'ll assume that a circle of radius r with the center in cell (i0,\xe2\x80\x89j0) is a set of such cells (i,\xe2\x80\x89j) that . We\'ll consider only the circles that do not go beyond the limits of the table, that is, for which r\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x89r and r\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m\xe2\x80\x89-\xe2\x80\x89r.    A circle of radius 3 with the center at (4,\xe2\x80\x895). Find two such non-intersecting circles of the given radius r that the sum of numbers in the cells that belong to these circles is maximum. Two circles intersect if there is a cell that belongs to both circles. As there can be more than one way to choose a pair of circles with the maximum sum, we will also be interested in the number of such pairs. Calculate the number of unordered pairs of circles, for instance, a pair of circles of radius 2 with centers at (3,\xe2\x80\x894) and (7,\xe2\x80\x897) is the same pair as the pair of circles of radius 2 with centers at (7,\xe2\x80\x897) and (3,\xe2\x80\x894)." 2500

363D "Renting Bikes" "binary search,greedy" "A group of n schoolboys decided to ride bikes. As nobody of them has a bike, the boys need to rent them.The renting site offered them m bikes. The renting price is different for different bikes, renting the j-th bike costs pj rubles.In total, the boys\' shared budget is a rubles. Besides, each of them has his own personal money, the i-th boy has bi personal rubles. The shared budget can be spent on any schoolchildren arbitrarily, but each boy\'s personal money can be spent on renting only this boy\'s bike.Each boy can rent at most one bike, one cannot give his bike to somebody else.What maximum number of schoolboys will be able to ride bikes? What minimum sum of personal money will they have to spend in total to let as many schoolchildren ride bikes as possible?" 1800

363C "Fixing Typos" greedy,implementation "Many modern text editors automatically check the spelling of the user\'s text. Some editors even suggest how to correct typos.In this problem your task to implement a small functionality to correct two types of typos in a word. We will assume that three identical letters together is a typo (for example, word ""helllo"" contains a typo). Besides, a couple of identical letters immediately followed by another couple of identical letters is a typo too (for example, words ""helloo"" and ""wwaatt"" contain typos).Write a code that deletes the minimum number of letters from a word, correcting described typos in the word. You are allowed to delete letters from both ends and from the middle of the word." 1400

363B Fence "brute force,dp" "There is a fence in front of Polycarpus\'s home. The fence consists of n planks of the same width which go one after another from left to right. The height of the i-th plank is hi meters, distinct planks can have distinct heights.  Fence for n\xe2\x80\x89=\xe2\x80\x897 and h\xe2\x80\x89=\xe2\x80\x89[1,\xe2\x80\x892,\xe2\x80\x896,\xe2\x80\x891,\xe2\x80\x891,\xe2\x80\x897,\xe2\x80\x891] Polycarpus has bought a posh piano and is thinking about how to get it into the house. In order to carry out his plan, he needs to take exactly k consecutive planks from the fence. Higher planks are harder to tear off the fence, so Polycarpus wants to find such k consecutive planks that the sum of their heights is minimal possible.Write the program that finds the indexes of k consecutive planks with minimal total height. Pay attention, the fence is not around Polycarpus\'s home, it is in front of home (in other words, the fence isn\'t cyclic)." 1100

363A Soroban implementation "You know that Japan is the country with almost the largest \'electronic devices per person\' ratio. So you might be quite surprised to find out that the primary school in Japan teaches to count using a Soroban \xe2\x80\x94 an abacus developed in Japan. This phenomenon has its reasons, of course, but we are not going to speak about them. Let\'s have a look at the Soroban\'s construction.  Soroban consists of some number of rods, each rod contains five beads. We will assume that the rods are horizontal lines. One bead on each rod (the leftmost one) is divided from the others by a bar (the reckoning bar). This single bead is called go-dama and four others are ichi-damas. Each rod is responsible for representing a single digit from 0 to 9. We can obtain the value of a digit by following simple algorithm:  Set the value of a digit equal to 0.  If the go-dama is shifted to the right, add 5.  Add the number of ichi-damas shifted to the left. Thus, the upper rod on the picture shows digit 0, the middle one shows digit 2 and the lower one shows 7. We will consider the top rod to represent the last decimal digit of a number, so the picture shows number 720.Write the program that prints the way Soroban shows the given number n." 800

362E "Petya and Pipes" "flows,graphs,shortest paths" "A little boy Petya dreams of growing up and becoming the Head Berland Plumber. He is thinking of the problems he will have to solve in the future. Unfortunately, Petya is too inexperienced, so you are about to solve one of such problems for Petya, the one he\'s the most interested in.The Berland capital has n water tanks numbered from 1 to n. These tanks are connected by unidirectional pipes in some manner. Any pair of water tanks is connected by at most one pipe in each direction. Each pipe has a strictly positive integer width. Width determines the number of liters of water per a unit of time this pipe can transport. The water goes to the city from the main water tank (its number is 1). The water must go through some pipe path and get to the sewer tank with cleaning system (its number is n). Petya wants to increase the width of some subset of pipes by at most k units in total so that the width of each pipe remains integer. Help him determine the maximum amount of water that can be transmitted per a unit of time from the main tank to the sewer tank after such operation is completed." 2300

362D "Fools and Foolproof Roads" "data structures,dfs and similar,dsu,graphs,greedy" "You must have heard all about the Foolland on your Geography lessons. Specifically, you must know that federal structure of this country has been the same for many centuries. The country consists of n cities, some pairs of cities are connected by bidirectional roads, each road is described by its length li.The fools lived in their land joyfully, but a recent revolution changed the king. Now the king is Vasily the Bear. Vasily divided the country cities into regions, so that any two cities of the same region have a path along the roads between them and any two cities of different regions don\'t have such path. Then Vasily decided to upgrade the road network and construct exactly p new roads in the country. Constructing a road goes like this:  We choose a pair of distinct cities u, v that will be connected by a new road (at that, it is possible that there already is a road between these cities).  We define the length of the new road: if cities u, v belong to distinct regions, then the length is calculated as min(109,\xe2\x80\x89S\xe2\x80\x89+\xe2\x80\x891) (S \xe2\x80\x94 the total length of all roads that exist in the linked regions), otherwise we assume that the length equals 1000.  We build a road of the specified length between the chosen cities. If the new road connects two distinct regions, after construction of the road these regions are combined into one new region. Vasily wants the road constructing process to result in the country that consists exactly of q regions. Your task is to come up with such road constructing plan for Vasily that it meets the requirement and minimizes the total length of the built roads." 2100

362C "Insertion Sort" "data structures,dp,implementation,math" "Petya is a beginner programmer. He has already mastered the basics of the C++ language and moved on to learning algorithms. The first algorithm he encountered was insertion sort. Petya has already written the code that implements this algorithm and sorts the given integer zero-indexed array a of size n in the non-decreasing order. for (int i = 1; i < n; i = i + 1){   int j = i;    while (j > 0 && a[j] < a[j - 1])   {      swap(a[j], a[j - 1]); // swap elements a[j] and a[j - 1]      j = j - 1;   }}Petya uses this algorithm only for sorting of arrays that are permutations of numbers from 0 to n\xe2\x80\x89-\xe2\x80\x891. He has already chosen the permutation he wants to sort but he first decided to swap some two of its elements. Petya wants to choose these elements in such a way that the number of times the sorting executes function swap, was minimum. Help Petya find out the number of ways in which he can make the swap and fulfill this requirement.It is guaranteed that it\'s always possible to swap two elements of the input permutation in such a way that the number of swap function calls decreases." 1900

362B "Petya and Staircases" implementation,sortings "Little boy Petya loves stairs very much. But he is bored from simple going up and down them \xe2\x80\x94 he loves jumping over several stairs at a time. As he stands on some stair, he can either jump to the next one or jump over one or two stairs at a time. But some stairs are too dirty and Petya doesn\'t want to step on them.Now Petya is on the first stair of the staircase, consisting of n stairs. He also knows the numbers of the dirty stairs of this staircase. Help Petya find out if he can jump through the entire staircase and reach the last stair number n without touching a dirty stair once.One has to note that anyway Petya should step on the first and last stairs, so if the first or the last stair is dirty, then Petya cannot choose a path with clean steps only." 1100

362A "Two Semiknights Meet" greedy,math "A boy Petya loves chess very much. He even came up with a chess piece of his own, a semiknight. The semiknight can move in any of these four directions: 2 squares forward and 2 squares to the right, 2 squares forward and 2 squares to the left, 2 squares backward and 2 to the right and 2 squares backward and 2 to the left. Naturally, the semiknight cannot move beyond the limits of the chessboard.Petya put two semiknights on a standard chessboard. Petya simultaneously moves with both semiknights. The squares are rather large, so after some move the semiknights can meet, that is, they can end up in the same square. After the meeting the semiknights can move on, so it is possible that they meet again. Petya wonders if there is such sequence of moves when the semiknights meet. Petya considers some squares bad. That is, they do not suit for the meeting. The semiknights can move through these squares but their meetings in these squares don\'t count.Petya prepared multiple chess boards. Help Petya find out whether the semiknights can meet on some good square for each board.Please see the test case analysis." 1500

361B "Levko and Permutation" "constructive algorithms,math,number theory" "Levko loves permutations very much. A permutation of length n is a sequence of distinct positive integers, each is at most n.Let\xe2\x80\x99s assume that value gcd(a,\xe2\x80\x89b) shows the greatest common divisor of numbers a and b. Levko assumes that element pi of permutation p1,\xe2\x80\x89p2,\xe2\x80\x89... ,\xe2\x80\x89pn is good if gcd(i,\xe2\x80\x89pi)\xe2\x80\x89>\xe2\x80\x891. Levko considers a permutation beautiful, if it has exactly k good elements. Unfortunately, he doesn\xe2\x80\x99t know any beautiful permutation. Your task is to help him to find at least one of them." 1200

361A "Levko and Table" "constructive algorithms,implementation" "Levko loves tables that consist of n rows and n columns very much. He especially loves beautiful tables. A table is beautiful to Levko if the sum of elements in each row and column of the table equals k.Unfortunately, he doesn\'t know any such table. Your task is to help him to find at least one of them." 800

360E "Levko and Game" "graphs,greedy,shortest paths" "Levko loves sports pathfinding competitions in his city very much. In order to boost his performance, Levko spends his spare time practicing. The practice is a game.The city consists of n intersections connected by m\xe2\x80\x89+\xe2\x80\x89k directed roads. Two or more roads can connect the same pair of intersections. Besides, there can be roads leading from an intersection to itself. Levko and Zenyk are playing a game. First Levko stands on intersection s1, and Zenyk stands on intersection s2. They both want to get to intersection f. The person who does it quicker wins. If they get there at the same time, the game ends with a draw. By agreement both players start simultaneously and move with the same speed.Levko wants to win very much. He knows the lengths of all the roads in the city. Also he knows that he can change the lengths of some roads (there are k such roads at all) if he pays the government. So, the government can change the length of the i-th road to any integer value in the segment [li, ri] (both borders inclusive). Levko wondered if he can reconstruct the roads so as to win the game and whether he can hope for the draw if he cannot win.You should consider that both players play optimally well. It is guaranteed that we can get from intersections s1 and s2 to intersection f." 2800

360D "Levko and Sets" "number theory" "Levko loves all sorts of sets very much.Levko has two arrays of integers a1,\xe2\x80\x89a2,\xe2\x80\x89... ,\xe2\x80\x89an and b1,\xe2\x80\x89b2,\xe2\x80\x89... ,\xe2\x80\x89bm and a prime number p. Today he generates n sets. Let\'s describe the generation process for the i-th set:  First it has a single number 1.  Let\'s take any element c from this set. For all j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m) if number (c\xc2\xb7aibj)�mod�p doesn\'t occur in the set, then add it to the set.  Repeat step 2 as long as we can add at least one element to our set. Levko wonders, how many numbers belong to at least one set. That is, he wants to know what size is the union of n generated sets." 2600

360C "Levko and Strings" combinatorics,dp "Levko loves strings of length n, consisting of lowercase English letters, very much. He has one such string s. For each string t of length n, Levko defines its beauty relative to s as the number of pairs of indexes i, j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n), such that substring t[i..j] is lexicographically larger than substring s[i..j].The boy wondered how many strings t are there, such that their beauty relative to s equals exactly k. Help him, find the remainder after division this number by 1000000007 (109\xe2\x80\x89+\xe2\x80\x897).A substring s[i..j] of string s\xe2\x80\x89=\xe2\x80\x89s1s2... sn is string sisi\xe2\x80\x89\xe2\x80\x89+\xe2\x80\x89\xe2\x80\x891... sj.String x\xe2\x80\x89\xe2\x80\x89=\xe2\x80\x89\xe2\x80\x89x1x2... xp is lexicographically larger than string y\xe2\x80\x89\xe2\x80\x89=\xe2\x80\x89\xe2\x80\x89y1y2... yp, if there is such number r (r\xe2\x80\x89<\xe2\x80\x89p), that x1\xe2\x80\x89\xe2\x80\x89=\xe2\x80\x89\xe2\x80\x89y1,\xe2\x80\x89\xe2\x80\x89x2\xe2\x80\x89\xe2\x80\x89=\xe2\x80\x89\xe2\x80\x89y2,\xe2\x80\x89\xe2\x80\x89... ,\xe2\x80\x89\xe2\x80\x89xr\xe2\x80\x89\xe2\x80\x89=\xe2\x80\x89\xe2\x80\x89yr and xr\xe2\x80\x89\xe2\x80\x89+\xe2\x80\x89\xe2\x80\x891\xe2\x80\x89>\xe2\x80\x89yr\xe2\x80\x89\xe2\x80\x89+\xe2\x80\x89\xe2\x80\x891. The string characters are compared by their ASCII codes." 2500

360B "Levko and Array" "binary search,dp" "Levko has an array that consists of integers: a1,\xe2\x80\x89a2,\xe2\x80\x89... ,\xe2\x80\x89an. But he doesn\xe2\x80\x99t like this array at all.Levko thinks that the beauty of the array a directly depends on value c(a), which can be calculated by the formula:  The less value c(a) is, the more beautiful the array is.It\xe2\x80\x99s time to change the world and Levko is going to change his array for the better. To be exact, Levko wants to change the values of at most k array elements (it is allowed to replace the values by any integers). Of course, the changes should make the array as beautiful as possible.Help Levko and calculate what minimum number c(a) he can reach." 2000

360A "Levko and Array Recovery" greedy,implementation "Levko loves array a1,\xe2\x80\x89a2,\xe2\x80\x89... ,\xe2\x80\x89an, consisting of integers, very much. That is why Levko is playing with array a, performing all sorts of operations with it. Each operation Levko performs is of one of two types:  Increase all elements from li to ri by di. In other words, perform assignments aj\xe2\x80\x89=\xe2\x80\x89aj\xe2\x80\x89+\xe2\x80\x89di for all j that meet the inequation li\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ri.  Find the maximum of elements from li to ri. That is, calculate the value . Sadly, Levko has recently lost his array. Fortunately, Levko has records of all operations he has performed on array a. Help Levko, given the operation records, find at least one suitable array. The results of all operations for the given array must coincide with the record results. Levko clearly remembers that all numbers in his array didn\'t exceed 109 in their absolute value, so he asks you to find such an array." 1700

359E Neatness "constructive algorithms,dfs and similar" "Simon loves neatness. So before he goes to bed, Simon wants to complete all chores in the house.Simon\'s house looks like a rectangular table consisting of n rows and n columns from above. All rows of the table are numbered from 1 to n from top to bottom. All columns of the table are numbered from 1 to n from left to right. Each cell of the table is a room. Pair (x,\xe2\x80\x89y) denotes the room, located at the intersection of the x-th row and the y-th column. For each room we know if the light is on or not there.Initially Simon is in room (x0,\xe2\x80\x89y0). He wants to turn off the lights in all the rooms in the house, and then return to room (x0,\xe2\x80\x89y0). Suppose that at the current moment Simon is in the room (x,\xe2\x80\x89y). To reach the desired result, he can perform the following steps:  The format of the action is ""1"". The action is to turn on the light in room (x,\xe2\x80\x89y). Simon cannot do it if the room already has light on.  The format of the action is ""2"". The action is to turn off the light in room (x,\xe2\x80\x89y). Simon cannot do it if the room already has light off.  The format of the action is ""dir"" (dir is a character). The action is to move to a side-adjacent room in direction dir. The direction can be left, right, up or down (the corresponding dir is L, R, U or D). Additionally, Simon can move only if he see a light in the direction dir. More formally, if we represent the room, Simon wants to go, as (nx,\xe2\x80\x89ny), there shold be an integer k (k\xe2\x80\x89>\xe2\x80\x890), that room (x\xe2\x80\x89+\xe2\x80\x89(nx\xe2\x80\x89-\xe2\x80\x89x)k,\xe2\x80\x89y\xe2\x80\x89+\xe2\x80\x89(ny\xe2\x80\x89-\xe2\x80\x89y)k) has a light. Of course, Simon cannot move out of his house. Help Simon, find the sequence of actions that lets him achieve the desired result." 2400

359D "Pair of Numbers" "binary search,brute force,data structures,math,two pointers" "Simon has an array a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an, consisting of n positive integers. Today Simon asked you to find a pair of integers l,\xe2\x80\x89r (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n), such that the following conditions hold:  there is integer j (l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r), such that all integers al,\xe2\x80\x89al\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89ar are divisible by aj;  value r\xe2\x80\x89-\xe2\x80\x89l takes the maximum value among all pairs for which condition 1 is true; Help Simon, find the required pair of numbers (l,\xe2\x80\x89r). If there are multiple required pairs find all of them." 2000

359C "Prime Number" "math,number theory" "Simon has a prime number x and an array of non-negative integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an.Simon loves fractions very much. Today he wrote out number  on a piece of paper. After Simon led all fractions to a common denominator and summed them up, he got a fraction: , where number t equals xa1\xe2\x80\x89+\xe2\x80\x89a2\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89an. Now Simon wants to reduce the resulting fraction. Help him, find the greatest common divisor of numbers s and t. As GCD can be rather large, print it as a remainder after dividing it by number 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." 1900

359B Permutation "constructive algorithms,dp,math" "A permutation p is an ordered group of numbers p1,\xe2\x80\x89\xe2\x80\x89\xe2\x80\x89p2,\xe2\x80\x89\xe2\x80\x89\xe2\x80\x89...,\xe2\x80\x89\xe2\x80\x89\xe2\x80\x89pn, consisting of n distinct positive integers, each is no more than n. We\'ll define number n as the length of permutation p1,\xe2\x80\x89\xe2\x80\x89\xe2\x80\x89p2,\xe2\x80\x89\xe2\x80\x89\xe2\x80\x89...,\xe2\x80\x89\xe2\x80\x89\xe2\x80\x89pn.Simon has a positive integer n and a non-negative integer k, such that 2k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n. Help him find permutation a of length 2n, such that it meets this equation: ." 1400

359A Table "constructive algorithms,greedy,implementation" "Simon has a rectangular table consisting of n rows and m columns. Simon numbered the rows of the table from top to bottom starting from one and the columns \xe2\x80\x94 from left to right starting from one. We\'ll represent the cell on the x-th row and the y-th column as a pair of numbers (x,\xe2\x80\x89y). The table corners are cells: (1,\xe2\x80\x891), (n,\xe2\x80\x891), (1,\xe2\x80\x89m), (n,\xe2\x80\x89m).Simon thinks that some cells in this table are good. Besides, it\'s known that no good cell is the corner of the table. Initially, all cells of the table are colorless. Simon wants to color all cells of his table. In one move, he can choose any good cell of table (x1,\xe2\x80\x89y1), an arbitrary corner of the table (x2,\xe2\x80\x89y2) and color all cells of the table (p,\xe2\x80\x89q), which meet both inequations: min(x1,\xe2\x80\x89x2)\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89p\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89max(x1,\xe2\x80\x89x2), min(y1,\xe2\x80\x89y2)\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89q\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89max(y1,\xe2\x80\x89y2).Help Simon! Find the minimum number of operations needed to color all cells of the table. Note that you can color one cell multiple times." 1000

358E "Dima and Kicks" "brute force,dsu,graphs,implementation" "Dima is a good person. In fact, he\'s great. But all good things come to an end...Seryozha is going to kick Dima just few times.. For this reason he divides the room into unit squares. Now the room is a rectangle n\xe2\x80\x89\xc3\x97\xe2\x80\x89m consisting of unit squares.For the beginning, Seryozha put Dima in a center of some square. Then he started to kick Dima (it is known, that he kicks Dima at least once). Each time when Dima is kicked he flyes up and moves into one of four directions (up, left, right, down). On each move Dima passes k (k\xe2\x80\x89>\xe2\x80\x891) unit of the length in the corresponding direction. Seryozha is really kind, so he kicks Dima in such way that Dima never meets the walls (in other words, Dima never leave the room\'s space). Seryozha is also dynamic character so Dima never flies above the same segment, connecting a pair of adjacent squares, twice.Seryozha kicks Dima for a long time, but Dima is not vindictive \xe2\x80\x94 Dima writes. Dima marked all squares in which he was staying or above which he was flying. Thanks to kicks, Dima does not remember the k value, so he asks you to find all possible values which matches to the Dima\'s records." 2300

358D "Dima and Hares" dp,greedy "Dima liked the present he got from Inna very much. He liked the present he got from Seryozha even more. Dima felt so grateful to Inna about the present that he decided to buy her n hares. Inna was very happy. She lined up the hares in a row, numbered them from 1 to n from left to right and started feeding them with carrots. Inna was determined to feed each hare exactly once. But in what order should she feed them?Inna noticed that each hare radiates joy when she feeds it. And the joy of the specific hare depends on whether Inna fed its adjacent hares before feeding it. Inna knows how much joy a hare radiates if it eats when either both of his adjacent hares are hungry, or one of the adjacent hares is full (that is, has been fed), or both of the adjacent hares are full. Please note that hares number 1 and n don\'t have a left and a right-adjacent hare correspondingly, so they can never have two full adjacent hares.Help Inna maximize the total joy the hares radiate. :)" 1800

358C "Dima and Containers" "constructive algorithms,greedy,implementation" "Dima has a birthday soon! It\'s a big day! Saryozha\'s present to Dima is that Seryozha won\'t be in the room and won\'t disturb Dima and Inna as they celebrate the birthday. Inna\'s present to Dima is a stack, a queue and a deck.Inna wants her present to show Dima how great a programmer he is. For that, she is going to give Dima commands one by one. There are two types of commands:  Add a given number into one of containers. For the queue and the stack, you can add elements only to the end. For the deck, you can add elements to the beginning and to the end.  Extract a number from each of at most three distinct containers. Tell all extracted numbers to Inna and then empty all containers. In the queue container you can extract numbers only from the beginning. In the stack container you can extract numbers only from the end. In the deck number you can extract numbers from the beginning and from the end. You cannot extract numbers from empty containers. Every time Dima makes a command of the second type, Inna kisses Dima some (possibly zero) number of times. Dima knows Inna perfectly well, he is sure that this number equals the sum of numbers he extracts from containers during this operation.As we\'ve said before, Dima knows Inna perfectly well and he knows which commands Inna will give to Dima and the order of the commands. Help Dima find the strategy that lets him give as more kisses as possible for his birthday!" 2000

358B "Dima and Text Messages" "brute force,strings" "Seryozha has a very changeable character. This time he refused to leave the room to Dima and his girlfriend (her hame is Inna, by the way). However, the two lovebirds can always find a way to communicate. Today they are writing text messages to each other.Dima and Inna are using a secret code in their text messages. When Dima wants to send Inna some sentence, he writes out all words, inserting a heart before each word and after the last word. A heart is a sequence of two characters: the ""less"" characters (<) and the digit three (3). After applying the code, a test message looks like that: <3word1<3word2<3 ... wordn<3.Encoding doesn\'t end here. Then Dima inserts a random number of small English characters, digits, signs ""more"" and ""less"" into any places of the message.Inna knows Dima perfectly well, so she knows what phrase Dima is going to send her beforehand. Inna has just got a text message. Help her find out if Dima encoded the message correctly. In other words, find out if a text message could have been received by encoding in the manner that is described above." 1500

358A "Dima and Continuous Line" "brute force,implementation" "Dima and Seryozha live in an ordinary dormitory room for two. One day Dima had a date with his girl and he asked Seryozha to leave the room. As a compensation, Seryozha made Dima do his homework.The teacher gave Seryozha the coordinates of n distinct points on the abscissa axis and asked to consecutively connect them by semi-circus in a certain order: first connect the first point with the second one, then connect the second point with the third one, then the third one with the fourth one and so on to the n-th point. Two points with coordinates (x1,\xe2\x80\x890) and (x2,\xe2\x80\x890) should be connected by a semi-circle that passes above the abscissa axis with the diameter that coincides with the segment between points. Seryozha needs to find out if the line on the picture intersects itself. For clarifications, see the picture Seryozha showed to Dima (the left picture has self-intersections, the right picture doesn\'t have any).  Seryozha is not a small boy, so the coordinates of the points can be rather large. Help Dima cope with the problem." 1400

357B "Flag Day" "constructive algorithms,implementation" "In Berland, there is the national holiday coming \xe2\x80\x94 the Flag Day. In the honor of this event the president of the country decided to make a big dance party and asked your agency to organize it. He has several conditions:  overall, there must be m dances; exactly three people must take part in each dance; each dance must have one dancer in white clothes, one dancer in red clothes and one dancer in blue clothes (these are the colors of the national flag of Berland). The agency has n dancers, and their number can be less than 3m. That is, some dancers will probably have to dance in more than one dance. All of your dancers must dance on the party. However, if some dance has two or more dancers from a previous dance, then the current dance stops being spectacular. Your agency cannot allow that to happen, so each dance has at most one dancer who has danced in some previous dance. You considered all the criteria and made the plan for the m dances: each dance had three dancers participating in it. Your task is to determine the clothes color for each of the n dancers so that the President\'s third condition fulfilled: each dance must have a dancer in white, a dancer in red and a dancer in blue. The dancers cannot change clothes between the dances." 1400

357A "Group of Students" "brute force,greedy,implementation" "At the beginning of the school year Berland State University starts two city school programming groups, for beginners and for intermediate coders. The children were tested in order to sort them into groups. According to the results, each student got some score from 1 to m points. We know that c1 schoolchildren got 1 point, c2 children got 2 points, ..., cm children got m points. Now you need to set the passing rate k (integer from 1 to m): all schoolchildren who got less than k points go to the beginner group and those who get at strictly least k points go to the intermediate group. We know that if the size of a group is more than y, then the university won\'t find a room for them. We also know that if a group has less than x schoolchildren, then it is too small and there\'s no point in having classes with it. So, you need to split all schoolchildren into two groups so that the size of each group was from x to y, inclusive. Help the university pick the passing rate in a way that meets these requirements." 1000

356E "Xenia and String Problem" "dp,hashing,implementation,string suffix structures,strings" "Xenia the coder went to The Olympiad of Informatics and got a string problem. Unfortunately, Xenia isn\'t fabulous in string algorithms. Help her solve the problem.String s is a sequence of characters s1s2... s|s|, where record |s| shows the length of the string. Substring s[i... j] of string s is string sisi\xe2\x80\x89+\xe2\x80\x891... sj.String s is a Gray string, if it meets the conditions:  the length of string |s| is odd;  character  occurs exactly once in the string;  either |s|\xe2\x80\x89=\xe2\x80\x891, or substrings  and  are the same and are Gray strings. For example, strings ""abacaba"", ""xzx"", ""g"" are Gray strings and strings ""aaa"", ""xz"", ""abaxcbc"" are not.The beauty of string p is the sum of the squares of the lengths of all substrings of string p that are Gray strings. In other words, consider all pairs of values i,\xe2\x80\x89j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|p|). If substring p[i... j] is a Gray string, you should add (j\xe2\x80\x89-\xe2\x80\x89i\xe2\x80\x89+\xe2\x80\x891)2 to the beauty.Xenia has got string t consisting of lowercase English letters. She is allowed to replace at most one letter of the string by any other English letter. The task is to get a string of maximum beauty." 3000

356D "Bags and Coins" "bitmasks,constructive algorithms,dp,greedy" "When you were a child you must have been told a puzzle of bags and coins. Anyway, here\'s one of its versions: A horse has three bags. The first bag has one coin, the second bag has one coin and the third bag has three coins. In total, the horse has three coins in the bags. How is that possible? The answer is quite simple. The third bag contains a coin and two other bags. This problem is a generalization of the childhood puzzle. You have n bags. You know that the first bag contains a1 coins, the second bag contains a2 coins, ..., the n-th bag contains an coins. In total, there are s coins. Find the way to arrange the bags and coins so that they match the described scenario or else state that it is impossible to do." 2700

356C Compartments "combinatorics,constructive algorithms,greedy,implementation" "A team of students from the city S is sent to the All-Berland Olympiad in Informatics. Traditionally, they go on the train. All students have bought tickets in one carriage, consisting of n compartments (each compartment has exactly four people). We know that if one compartment contain one or two students, then they get bored, and if one compartment contain three or four students, then the compartment has fun throughout the entire trip.The students want to swap with other people, so that no compartment with students had bored students. To swap places with another person, you need to convince him that it is really necessary. The students can not independently find the necessary arguments, so they asked a sympathetic conductor for help. The conductor can use her life experience to persuade any passenger to switch places with some student.However, the conductor does not want to waste time persuading the wrong people, so she wants to know what is the minimum number of people necessary to persuade her to change places with the students. Your task is to find the number. After all the swaps each compartment should either have no student left, or have a company of three or four students." 2100

356B "Xenia and Hamming" implementation,math "Xenia is an amateur programmer. Today on the IT lesson she learned about the Hamming distance.The Hamming distance between two strings s\xe2\x80\x89=\xe2\x80\x89s1s2... sn and t\xe2\x80\x89=\xe2\x80\x89t1t2... tn of equal length n is value . Record [si\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89ti] is the Iverson notation and represents the following: if si\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89ti, it is one, otherwise \xe2\x80\x94 zero.Now Xenia wants to calculate the Hamming distance between two long strings a and b. The first string a is the concatenation of n copies of string x, that is, . The second string b is the concatenation of m copies of string y. Help Xenia, calculate the required Hamming distance, given n,\xe2\x80\x89x,\xe2\x80\x89m,\xe2\x80\x89y." 1900

356A "Knight Tournament" "data structures,dsu" "Hooray! Berl II, the king of Berland is making a knight tournament. The king has already sent the message to all knights in the kingdom and they in turn agreed to participate in this grand event.As for you, you\'re just a simple peasant. There\'s no surprise that you slept in this morning and were late for the tournament (it was a weekend, after all). Now you are really curious about the results of the tournament. This time the tournament in Berland went as follows:  There are n knights participating in the tournament. Each knight was assigned his unique number \xe2\x80\x94 an integer from 1 to n.  The tournament consisted of m fights, in the i-th fight the knights that were still in the game with numbers at least li and at most ri have fought for the right to continue taking part in the tournament.  After the i-th fight among all participants of the fight only one knight won \xe2\x80\x94 the knight number xi, he continued participating in the tournament. Other knights left the tournament.  The winner of the last (the m-th) fight (the knight number xm) became the winner of the tournament. You fished out all the information about the fights from your friends. Now for each knight you want to know the name of the knight he was conquered by. We think that the knight number b was conquered by the knight number a, if there was a fight with both of these knights present and the winner was the knight number a.Write the code that calculates for each knight, the name of the knight that beat him." 1500

355B "Vasya and Public Transport" greedy,implementation "Vasya often uses public transport. The transport in the city is of two types: trolleys and buses. The city has n buses and m trolleys, the buses are numbered by integers from 1 to n, the trolleys are numbered by integers from 1 to m.Public transport is not free. There are 4 types of tickets:   A ticket for one ride on some bus or trolley. It costs c1 burles;  A ticket for an unlimited number of rides on some bus or on some trolley. It costs c2 burles;  A ticket for an unlimited number of rides on all buses or all trolleys. It costs c3 burles;  A ticket for an unlimited number of rides on all buses and trolleys. It costs c4 burles. Vasya knows for sure the number of rides he is going to make and the transport he is going to use. He asked you for help to find the minimum sum of burles he will have to spend on the tickets." 1100

355A "Vasya and Digital Root" "constructive algorithms,implementation" "Vasya has recently found out what a digital root of a number is and he decided to share his knowledge with you.Let\'s assume that S(n) is the sum of digits of number n, for example, S(4098)\xe2\x80\x89=\xe2\x80\x894\xe2\x80\x89+\xe2\x80\x890\xe2\x80\x89+\xe2\x80\x899\xe2\x80\x89+\xe2\x80\x898\xe2\x80\x89=\xe2\x80\x8921. Then the digital root of number n equals to:   dr(n)\xe2\x80\x89=\xe2\x80\x89S(n), if S(n)\xe2\x80\x89<\xe2\x80\x8910;  dr(n)\xe2\x80\x89=\xe2\x80\x89dr(\xe2\x80\x89S(n)\xe2\x80\x89), if S(n)\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x8910. For example, dr(4098)\xe2\x80\x89\xe2\x80\x89=\xe2\x80\x89\xe2\x80\x89dr(21)\xe2\x80\x89\xe2\x80\x89=\xe2\x80\x89\xe2\x80\x893.Vasya is afraid of large numbers, so the numbers he works with are at most 101000. For all such numbers, he has proved that dr(n)\xe2\x80\x89\xe2\x80\x89=\xe2\x80\x89\xe2\x80\x89S(\xe2\x80\x89S(\xe2\x80\x89S(\xe2\x80\x89S(n)\xe2\x80\x89)\xe2\x80\x89)\xe2\x80\x89) (n\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89101000).Now Vasya wants to quickly find numbers with the given digital root. The problem is, he hasn\'t learned how to do that and he asked you to help him. You task is, given numbers k and d, find the number consisting of exactly k digits (the leading zeroes are not allowed), with digital root equal to d, or else state that such number does not exist." 1100

354E "Lucky Number Representation" "constructive algorithms,dfs and similar,dp" "We know that lucky digits are digits 4 and 7, however Vasya\'s got another favorite digit 0 and he assumes it also is lucky! Lucky numbers are such non-negative integers whose decimal record only contains lucky digits. For example, numbers 0,\xe2\x80\x8947,\xe2\x80\x897074 are lucky, but 1,\xe2\x80\x897377,\xe2\x80\x89895,\xe2\x80\x89 -7 are not.Vasya has t important positive integers he needs to remember. Vasya is quite superstitious and he wants to remember lucky numbers only, so he is asking you for each important number to represent it as a sum of exactly six lucky numbers (Vasya just can\'t remember more numbers). Then Vasya can just remember these six numbers and calculate the important number at any moment.For each of t important integers represent it as the sum of six lucky numbers or state that this is impossible." 2200

354D "Transferring Pyramid" dp "Vasya and Petya are using an interesting data storing structure: a pyramid.The pyramid consists of n rows, the i-th row contains i cells. Each row is shifted half a cell to the left relative to the previous row. The cells are numbered by integers from 1 to  as shown on the picture below.An example of a pyramid at n\xe2\x80\x89=\xe2\x80\x895 is:   This data structure can perform operations of two types:   Change the value of a specific cell. It is described by three integers: ""t\xe2\x80\x82i\xe2\x80\x82v"", where t\xe2\x80\x89=\xe2\x80\x891 (the type of operation), i \xe2\x80\x94 the number of the cell to change and v the value to assign to the cell.  Change the value of some subpyramid. The picture shows a highlighted subpyramid with the top in cell 5. It is described by s\xe2\x80\x89+\xe2\x80\x892 numbers: ""t\xe2\x80\x82i\xe2\x80\x82v1\xe2\x80\x82v2\xe2\x80\x82...\xe2\x80\x82vs"", where t\xe2\x80\x89=\xe2\x80\x892, i \xe2\x80\x94 the number of the top cell of the pyramid, s \xe2\x80\x94 the size of the subpyramid (the number of cells it has), vj \xe2\x80\x94 the value you should assign to the j-th cell of the subpyramid. Formally: a subpyramid with top at the i-th cell of the k-th row (the 5-th cell is the second cell of the third row) will contain cells from rows from k to n, the (k\xe2\x80\x89+\xe2\x80\x89p)-th row contains cells from the i-th to the (i\xe2\x80\x89+\xe2\x80\x89p)-th (0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89p\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x89k).Vasya and Petya had two identical pyramids. Vasya changed some cells in his pyramid and he now wants to send his changes to Petya. For that, he wants to find a sequence of operations at which Petya can repeat all Vasya\'s changes. Among all possible sequences, Vasya has to pick the minimum one (the one that contains the fewest numbers).You have a pyramid of n rows with k changed cells. Find the sequence of operations which result in each of the k changed cells being changed by at least one operation. Among all the possible sequences pick the one that contains the fewest numbers." 2900

354C "Vasya and Beautiful Arrays" "brute force,dp,number theory" "Vasya\'s got a birthday coming up and his mom decided to give him an array of positive integers a of length n.Vasya thinks that an array\'s beauty is the greatest common divisor of all its elements. His mom, of course, wants to give him as beautiful an array as possible (with largest possible beauty). Unfortunately, the shop has only one array a left. On the plus side, the seller said that he could decrease some numbers in the array (no more than by k for each number).The seller can obtain array b from array a if the following conditions hold: bi\xe2\x80\x89>\xe2\x80\x890;\xe2\x80\x820\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ai\xe2\x80\x89-\xe2\x80\x89bi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k for all 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n.Help mom find the maximum possible beauty of the array she will give to Vasya (that seller can obtain)." 2100

354B "Game with Strings" bitmasks,dp,games "Given an n\xe2\x80\x89\xc3\x97\xe2\x80\x89n table T consisting of lowercase English letters. We\'ll consider some string s good if the table contains a correct path corresponding to the given string. In other words, good strings are all strings we can obtain by moving from the left upper cell of the table only to the right and down. Here\'s the formal definition of correct paths:Consider rows of the table are numbered from 1 to n from top to bottom, and columns of the table are numbered from 1 to n from left to the right. Cell (r,\xe2\x80\x89c) is a cell of table T on the r-th row and in the c-th column. This cell corresponds to letter Tr,\xe2\x80\x89c.A path of length k is a sequence of table cells [(r1,\xe2\x80\x89c1),\xe2\x80\x89(r2,\xe2\x80\x89c2),\xe2\x80\x89...,\xe2\x80\x89(rk,\xe2\x80\x89ck)]. The following paths are correct:   There is only one correct path of length 1, that is, consisting of a single cell: [(1,\xe2\x80\x891)];  Let\'s assume that [(r1,\xe2\x80\x89c1),\xe2\x80\x89...,\xe2\x80\x89(rm,\xe2\x80\x89cm)] is a correct path of length m, then paths [(r1,\xe2\x80\x89c1),\xe2\x80\x89...,\xe2\x80\x89(rm,\xe2\x80\x89cm),\xe2\x80\x89(rm\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89cm)] and [(r1,\xe2\x80\x89c1),\xe2\x80\x89...,\xe2\x80\x89(rm,\xe2\x80\x89cm),\xe2\x80\x89(rm,\xe2\x80\x89cm\xe2\x80\x89+\xe2\x80\x891)] are correct paths of length m\xe2\x80\x89+\xe2\x80\x891. We should assume that a path [(r1,\xe2\x80\x89c1),\xe2\x80\x89(r2,\xe2\x80\x89c2),\xe2\x80\x89...,\xe2\x80\x89(rk,\xe2\x80\x89ck)] corresponds to a string of length k: Tr1,\xe2\x80\x89c1\xe2\x80\x89+\xe2\x80\x89Tr2,\xe2\x80\x89c2\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89Trk,\xe2\x80\x89ck.Two players play the following game: initially they have an empty string. Then the players take turns to add a letter to the end of the string. After each move (adding a new letter) the resulting string must be good. The game ends after 2n\xe2\x80\x89-\xe2\x80\x891 turns. A player wins by the following scenario:   If the resulting string has strictly more letters ""a"" than letters ""b"", then the first player wins;  If the resulting string has strictly more letters ""b"" than letters ""a"", then the second player wins;  If the resulting string has the same number of letters ""a"" and ""b"", then the players end the game with a draw. Your task is to determine the result of the game provided that both players played optimally well." 2400

354A "Vasya and Robot" "brute force,greedy,math" "Vasya has n items lying in a line. The items are consecutively numbered by numbers from 1 to n in such a way that the leftmost item has number 1, the rightmost item has number n. Each item has a weight, the i-th item weights wi kilograms.Vasya needs to collect all these items, however he won\'t do it by himself. He uses his brand new robot. The robot has two different arms \xe2\x80\x94 the left one and the right one. The robot can consecutively perform the following actions:   Take the leftmost item with the left hand and spend wi\xe2\x80\x89\xc2\xb7\xe2\x80\x89l energy units (wi is a weight of the leftmost item, l is some parameter). If the previous action was the same (left-hand), then the robot spends extra Ql energy units;  Take the rightmost item with the right hand and spend wj\xe2\x80\x89\xc2\xb7\xe2\x80\x89r energy units (wj is a weight of the rightmost item, r is some parameter). If the previous action was the same (right-hand), then the robot spends extra Qr energy units; Naturally, Vasya wants to program the robot in a way that the robot spends as little energy as possible. He asked you to solve this problem. Your task is to find the minimum number of energy units robot spends to collect all items." 1500

353E Antichain "dp,graph matchings,greedy" "You have a directed acyclic graph G, consisting of n vertexes, numbered from 0 to n\xe2\x80\x89-\xe2\x80\x891. The graph contains n edges numbered from 0 to n\xe2\x80\x89-\xe2\x80\x891. An edge with number i connects vertexes i and (i\xe2\x80\x89+\xe2\x80\x891)�mod�n, and it can be directed in either direction (from i to (i\xe2\x80\x89+\xe2\x80\x891)�mod�n, or vise versa).Operation x�mod�y means taking the remainder after dividing number x by number y.Let\'s call two vertexes u and v in graph G comparable if the graph contains a path either from u to v or from v to u. We\'ll assume that an antichain is a set of vertexes of graph G, where any two distinct vertexes are not comparable. The size of an antichain is the number of vertexes in the corresponding set. An antichain is maximum if the graph doesn\'t have antichains of a larger size.Your task is to find the size of the maximum antichain in graph G." 2200

353D Queue "constructive algorithms,dp" "There are n schoolchildren, boys and girls, lined up in the school canteen in front of the bun stall. The buns aren\'t ready yet and the line is undergoing some changes.Each second all boys that stand right in front of girls, simultaneously swap places with the girls (so that the girls could go closer to the beginning of the line). In other words, if at some time the i-th position has a boy and the (i\xe2\x80\x89+\xe2\x80\x891)-th position has a girl, then in a second, the i-th position will have a girl and the (i\xe2\x80\x89+\xe2\x80\x891)-th one will have a boy.Let\'s take an example of a line of four people: a boy, a boy, a girl, a girl (from the beginning to the end of the line). Next second the line will look like that: a boy, a girl, a boy, a girl. Next second it will be a girl, a boy, a girl, a boy. Next second it will be a girl, a girl, a boy, a boy. The line won\'t change any more.Your task is: given the arrangement of the children in the line to determine the time needed to move all girls in front of boys (in the example above it takes 3 seconds). Baking buns takes a lot of time, so no one leaves the line until the line stops changing." 2000

353C "Find Maximum" "implementation,math,number theory" "Valera has array a, consisting of n integers a0,\xe2\x80\x89a1,\xe2\x80\x89...,\xe2\x80\x89an\xe2\x80\x89-\xe2\x80\x891, and function f(x), taking an integer from 0 to 2n\xe2\x80\x89-\xe2\x80\x891 as its single argument. Value f(x) is calculated by formula , where value bit(i) equals one if the binary representation of number x contains a 1 on the i-th position, and zero otherwise.For example, if n\xe2\x80\x89=\xe2\x80\x894 and x\xe2\x80\x89=\xe2\x80\x8911 (11\xe2\x80\x89=\xe2\x80\x8920\xe2\x80\x89+\xe2\x80\x8921\xe2\x80\x89+\xe2\x80\x8923), then f(x)\xe2\x80\x89=\xe2\x80\x89a0\xe2\x80\x89+\xe2\x80\x89a1\xe2\x80\x89+\xe2\x80\x89a3.Help Valera find the maximum of function f(x) among all x, for which an inequality holds: 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m." 1600

353B "Two Heaps" "combinatorics,constructive algorithms,greedy,implementation,math,sortings" "Valera has 2\xc2\xb7n cubes, each cube contains an integer from 10 to 99. He arbitrarily chooses n cubes and puts them in the first heap. The remaining cubes form the second heap. Valera decided to play with cubes. During the game he takes a cube from the first heap and writes down the number it has. Then he takes a cube from the second heap and write out its two digits near two digits he had written (to the right of them). In the end he obtained a single fourdigit integer \xe2\x80\x94 the first two digits of it is written on the cube from the first heap, and the second two digits of it is written on the second cube from the second heap.Valera knows arithmetic very well. So, he can easily count the number of distinct fourdigit numbers he can get in the game. The other question is: how to split cubes into two heaps so that this number (the number of distinct fourdigit integers Valera can get) will be as large as possible?" 1900

353A Domino implementation,math "Valera has got n domino pieces in a row. Each piece consists of two halves \xe2\x80\x94 the upper one and the lower one. Each of the halves contains a number from 1 to 6. Valera loves even integers very much, so he wants the sum of the numbers on the upper halves and the sum of the numbers on the lower halves to be even.To do that, Valera can rotate the dominoes by 180 degrees. After the rotation the upper and the lower halves swap places. This action takes one second. Help Valera find out the minimum time he must spend rotating dominoes to make his wish come true." 1200

352B "Jeff and Periods" implementation,sortings "One day Jeff got hold of an integer sequence a1, a2, ..., an of length n. The boy immediately decided to analyze the sequence. For that, he needs to find all values of x, for which these conditions hold:  x occurs in sequence a.  Consider all positions of numbers x in the sequence a (such i, that ai\xe2\x80\x89=\xe2\x80\x89x). These numbers, sorted in the increasing order, must form an arithmetic progression. Help Jeff, find all x that meet the problem conditions." 1300

352A "Jeff and Digits" "brute force,implementation,math" "Jeff\'s got n cards, each card contains either digit 0, or digit 5. Jeff can choose several cards and put them in a line so that he gets some number. What is the largest possible number divisible by 90 Jeff can make from the cards he\'s got?Jeff must make the number without leading zero. At that, we assume that number 0 doesn\'t contain any leading zeroes. Jeff doesn\'t have to use all the cards." 1000

351E "Jeff and Permutation" greedy "Jeff\'s friends know full well that the boy likes to get sequences and arrays for his birthday. Thus, Jeff got sequence p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pn for his birthday.Jeff hates inversions in sequences. An inversion in sequence a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an is a pair of indexes i,\xe2\x80\x89j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n), such that an inequality ai\xe2\x80\x89>\xe2\x80\x89aj holds.Jeff can multiply some numbers of the sequence p by -1. At that, he wants the number of inversions in the sequence to be minimum. Help Jeff and find the minimum number of inversions he manages to get." 2200

351D "Jeff and Removing Periods" "data structures" "Cosider a sequence, consisting of n integers: a1, a2, ..., an. Jeff can perform the following operation on sequence a:  take three integers v, t, k (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89v,\xe2\x80\x89t\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n;�0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k;�v\xe2\x80\x89+\xe2\x80\x89tk\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n), such that av = av\xe2\x80\x89+\xe2\x80\x89t, av\xe2\x80\x89+\xe2\x80\x89t = av\xe2\x80\x89+\xe2\x80\x892t, ..., av\xe2\x80\x89+\xe2\x80\x89t(k\xe2\x80\x89-\xe2\x80\x891) = av\xe2\x80\x89+\xe2\x80\x89tk;  remove elements av, av\xe2\x80\x89+\xe2\x80\x89t, ..., av\xe2\x80\x89+\xe2\x80\x89t\xc2\xb7k from the sequence a, the remaining elements should be reindexed a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an\xe2\x80\x89-\xe2\x80\x89k\xe2\x80\x89-\xe2\x80\x891.  permute in some order the remaining elements of sequence a. A beauty of a sequence a is the minimum number of operations that is needed to delete all elements from sequence a.Jeff\'s written down a sequence of m integers b1, b2, ..., bm. Now he wants to ask q questions. Each question can be described with two integers li,\xe2\x80\x89ri. The answer to the question is the beauty of sequence bli, bli\xe2\x80\x89+\xe2\x80\x891, ..., bri. You are given the sequence b and all questions. Help Jeff, answer all his questions." 2700

351C "Jeff and Brackets" dp,matrices "Jeff loves regular bracket sequences.Today Jeff is going to take a piece of paper and write out the regular bracket sequence, consisting of nm brackets. Let\'s number all brackets of this sequence from 0 to nm - 1 from left to right. Jeff knows that he is going to spend ai mod n liters of ink on the i-th bracket of the sequence if he paints it opened and bi mod n liters if he paints it closed.You\'ve got sequences a, b and numbers n, m. What minimum amount of ink will Jeff need to paint a regular bracket sequence of length nm?Operation x mod y means taking the remainder after dividing number x by number y." 2500

351B "Jeff and Furik" combinatorics,dp,probabilities "Jeff has become friends with Furik. Now these two are going to play one quite amusing game.At the beginning of the game Jeff takes a piece of paper and writes down a permutation consisting of n numbers: p1, p2, ..., pn. Then the guys take turns to make moves, Jeff moves first. During his move, Jeff chooses two adjacent permutation elements and then the boy swaps them. During his move, Furic tosses a coin and if the coin shows ""heads"" he chooses a random pair of adjacent elements with indexes i and i\xe2\x80\x89+\xe2\x80\x891, for which an inequality pi\xe2\x80\x89>\xe2\x80\x89pi\xe2\x80\x89+\xe2\x80\x891 holds, and swaps them. But if the coin shows ""tails"", Furik chooses a random pair of adjacent elements with indexes i and i\xe2\x80\x89+\xe2\x80\x891, for which the inequality pi\xe2\x80\x89<\xe2\x80\x89pi\xe2\x80\x89+\xe2\x80\x891 holds, and swaps them. If the coin shows ""heads"" or ""tails"" and Furik has multiple ways of adjacent pairs to take, then he uniformly takes one of the pairs. If Furik doesn\'t have any pair to take, he tosses a coin one more time. The game ends when the permutation is sorted in the increasing order.Jeff wants the game to finish as quickly as possible (that is, he wants both players to make as few moves as possible). Help Jeff find the minimum mathematical expectation of the number of moves in the game if he moves optimally well.You can consider that the coin shows the heads (or tails) with the probability of 50 percent." 1900

351A "Jeff and Rounding" dp,greedy,implementation,math "Jeff got 2n real numbers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89a2n as a birthday present. The boy hates non-integer numbers, so he decided to slightly ""adjust"" the numbers he\'s got. Namely, Jeff consecutively executes n operations, each of them goes as follows:  choose indexes i and j (i\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89j) that haven\'t been chosen yet;  round element ai to the nearest integer that isn\'t more than ai (assign to ai: \xe2\x8c\x8a ai�\xe2\x8c\x8b);  round element aj to the nearest integer that isn\'t less than aj (assign to aj: \xe2\x8c\x88 aj�\xe2\x8c\x89). Nevertheless, Jeff doesn\'t want to hurt the feelings of the person who gave him the sequence. That\'s why the boy wants to perform the operations so as to make the absolute value of the difference between the sum of elements before performing the operations and the sum of elements after performing the operations as small as possible. Help Jeff find the minimum absolute value of the difference." 1800

350E "Wrong Floyd" "brute force,constructive algorithms,dfs and similar,graphs" "Valera conducts experiments with algorithms that search for shortest paths. He has recently studied the Floyd\'s algorithm, so it\'s time to work with it.Valera\'s already written the code that counts the shortest distance between any pair of vertexes in a non-directed connected graph from n vertexes and m edges, containing no loops and multiple edges. Besides, Valera\'s decided to mark part of the vertexes. He\'s marked exactly k vertexes a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89ak.Valera\'s code is given below.ans[i][j] // the shortest distance for a pair of vertexes i,\xe2\x80\x89ja[i]  // vertexes, marked by Valerafor(i = 1; i <= n; i++) {    for(j = 1; j <= n; j++) {        if (i == j)            ans[i][j] = 0;        else            ans[i][j] = INF;  //INF is a very large number     }}    for(i = 1; i <= m; i++) {    read a pair of vertexes u, v that have a non-directed edge between them;    ans[u][v] = 1;    ans[v][u] = 1;}for (i = 1; i <= k; i++) {    v = a[i];    for(j = 1; j <= n; j++)        for(r = 1; r <= n; r++)            ans[j][r] = min(ans[j][r], ans[j][v] + ans[v][r]);}Valera has seen that his code is wrong. Help the boy. Given the set of marked vertexes a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89ak, find such non-directed connected graph, consisting of n vertexes and m edges, for which Valera\'s code counts the wrong shortest distance for at least one pair of vertexes (i,\xe2\x80\x89j). Valera is really keen to get a graph without any loops and multiple edges. If no such graph exists, print -1." 2200

350D "Looking for Owls" "binary search,data structures,geometry,hashing,sortings" "Emperor Palpatine loves owls very much. The emperor has some blueprints with the new Death Star, the blueprints contain n distinct segments and m distinct circles. We will consider the segments indexed from 1 to n in some way and the circles \xe2\x80\x94 indexed from 1 to m in some way. Palpatine defines an owl as a set of a pair of distinct circles (i,\xe2\x80\x89j) (i\xe2\x80\x89<\xe2\x80\x89j) and one segment k, such that:   circles i and j are symmetrical relatively to the straight line containing segment k;  circles i and j don\'t have any common points;  circles i and j have the same radius;  segment k intersects the segment that connects the centers of circles i and j. Help Palpatine, count the number of distinct owls on the picture." 2400

350C Bombs greedy,implementation,sortings "You\'ve got a robot, its task is destroying bombs on a square plane. Specifically, the square plane contains n bombs, the i-th bomb is at point with coordinates (xi,\xe2\x80\x89yi). We know that no two bombs are at the same point and that no bomb is at point with coordinates (0,\xe2\x80\x890). Initially, the robot is at point with coordinates (0,\xe2\x80\x890). Also, let\'s mark the robot\'s current position as (x,\xe2\x80\x89y). In order to destroy all the bombs, the robot can perform three types of operations:  Operation has format ""1 k dir"". To perform the operation robot have to move in direction dir k (k\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x891) times. There are only 4 directions the robot can move in: ""R"", ""L"", ""U"", ""D"". During one move the robot can move from the current point to one of following points: (x\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89y), (x\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89y), (x,\xe2\x80\x89y\xe2\x80\x89+\xe2\x80\x891), (x,\xe2\x80\x89y\xe2\x80\x89-\xe2\x80\x891) (corresponding to directions). It is forbidden to move from point (x,\xe2\x80\x89y), if at least one point on the path (besides the destination point) contains a bomb.  Operation has format ""2"". To perform the operation robot have to pick a bomb at point (x,\xe2\x80\x89y) and put it in a special container. Thus, the robot can carry the bomb from any point to any other point. The operation cannot be performed if point (x,\xe2\x80\x89y) has no bomb. It is forbidden to pick a bomb if the robot already has a bomb in its container.  Operation has format ""3"". To perform the operation robot have to take a bomb out of the container and destroy it. You are allowed to perform this operation only if the robot is at point (0,\xe2\x80\x890). It is forbidden to perform the operation if the container has no bomb. Help the robot and find the shortest possible sequence of operations he can perform to destroy all bombs on the coordinate plane." 1600

350B Resort graphs "Valera\'s finally decided to go on holiday! He packed up and headed for a ski resort.Valera\'s fancied a ski trip but he soon realized that he could get lost in this new place. Somebody gave him a useful hint: the resort has n objects (we will consider the objects indexed in some way by integers from 1 to n), each object is either a hotel or a mountain.Valera has also found out that the ski resort had multiple ski tracks. Specifically, for each object v, the resort has at most one object u, such that there is a ski track built from object u to object v. We also know that no hotel has got a ski track leading from the hotel to some object.Valera is afraid of getting lost on the resort. So he wants you to come up with a path he would walk along. The path must consist of objects v1,\xe2\x80\x89v2,\xe2\x80\x89...,\xe2\x80\x89vk (k\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x891) and meet the following conditions:  Objects with numbers v1,\xe2\x80\x89v2,\xe2\x80\x89...,\xe2\x80\x89vk\xe2\x80\x89-\xe2\x80\x891 are mountains and the object with number vk is the hotel.  For any integer i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89k), there is exactly one ski track leading from object vi. This track goes to object vi\xe2\x80\x89+\xe2\x80\x891.  The path contains as many objects as possible (k is maximal). Help Valera. Find such path that meets all the criteria of our hero!" 1500

350A TL "brute force,greedy,implementation" "Valera wanted to prepare a Codesecrof round. He\'s already got one problem and he wants to set a time limit (TL) on it.Valera has written n correct solutions. For each correct solution, he knows its running time (in seconds). Valera has also wrote m wrong solutions and for each wrong solution he knows its running time (in seconds).Let\'s suppose that Valera will set v seconds TL in the problem. Then we can say that a solution passes the system testing if its running time is at most v seconds. We can also say that a solution passes the system testing with some ""extra"" time if for its running time, a seconds, an inequality 2a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89v holds.As a result, Valera decided to set v seconds TL, that the following conditions are met:  v is a positive integer;  all correct solutions pass the system testing;  at least one correct solution passes the system testing with some ""extra"" time;  all wrong solutions do not pass the system testing;  value v is minimum among all TLs, for which points 1, 2, 3, 4 hold. Help Valera and find the most suitable TL or else state that such TL doesn\'t exist." 1200

349B "Color the Fence" "data structures,dp,greedy,implementation" "Igor has fallen in love with Tanya. Now Igor wants to show his feelings and write a number on the fence opposite to Tanya\'s house. Igor thinks that the larger the number is, the more chance to win Tanya\'s heart he has. Unfortunately, Igor could only get v liters of paint. He did the math and concluded that digit d requires ad liters of paint. Besides, Igor heard that Tanya doesn\'t like zeroes. That\'s why Igor won\'t use them in his number.Help Igor find the maximum number he can write on the fence." 1700

349A "Cinema Line" greedy,implementation "The new ""Die Hard"" movie has just been released! There are n people at the cinema box office standing in a huge line. Each of them has a single 100, 50 or 25 ruble bill. A ""Die Hard"" ticket costs 25 rubles. Can the booking clerk sell a ticket to each person and give the change if he initially has no money and sells the tickets strictly in the order people follow in the line?" 1100

348E Pilgrims "dfs and similar,dp,trees" "A long time ago there was a land called Dudeland. Dudeland consisted of n towns connected with n\xe2\x80\x89-\xe2\x80\x891 bidirectonal roads. The towns are indexed from 1 to n and one can reach any city from any other city if he moves along the roads of the country. There are m monasteries in Dudeland located in m different towns. In each monastery lives a pilgrim.At the beginning of the year, each pilgrim writes down which monastery is the farthest from the monastery he is living in. If there is more than one farthest monastery, he lists all of them. On the Big Lebowski day each pilgrim picks one town from his paper at random and starts walking to that town. Walter hates pilgrims and wants to make as many of them unhappy as possible by preventing them from finishing their journey. He plans to destroy exactly one town that does not contain a monastery. A pilgrim becomes unhappy if all monasteries in his list become unreachable from the monastery he is living in. You need to find the maximum number of pilgrims Walter can make unhappy. Also find the number of ways he can make this maximal number of pilgrims unhappy: the number of possible towns he can destroy." 2800

348D Turtles dp,matrices "You\'ve got a table of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m. We\'ll consider the table rows numbered from top to bottom 1 through n, and the columns numbered from left to right 1 through m. Then we\'ll denote the cell in row x and column y as (x,\xe2\x80\x89y).Initially cell (1,\xe2\x80\x891) contains two similar turtles. Both turtles want to get to cell (n,\xe2\x80\x89m). Some cells of the table have obstacles but it is guaranteed that there aren\'t any obstacles in the upper left and lower right corner. A turtle (one or the other) can go from cell (x,\xe2\x80\x89y) to one of two cells (x\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89y) and (x,\xe2\x80\x89y\xe2\x80\x89+\xe2\x80\x891), as long as the required cell doesn\'t contain an obstacle. The turtles have had an argument so they don\'t want to have any chance of meeting each other along the way. Help them find the number of ways in which they can go from cell (1,\xe2\x80\x891) to cell (n,\xe2\x80\x89m).More formally, find the number of pairs of non-intersecting ways from cell (1,\xe2\x80\x891) to cell (n,\xe2\x80\x89m) modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897). Two ways are called non-intersecting if they have exactly two common points \xe2\x80\x94 the starting point and the final point." 2500

348C "Subset Sums" "brute force,data structures" "You are given an array a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an and m sets S1,\xe2\x80\x89S2,\xe2\x80\x89...,\xe2\x80\x89Sm of indices of elements of this array. Let\'s denote Sk\xe2\x80\x89=\xe2\x80\x89{Sk,\xe2\x80\x89i}�(1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|Sk|). In other words, Sk,\xe2\x80\x89i is some element from set Sk.In this problem you have to answer q queries of the two types:  Find the sum of elements with indices from set Sk: . The query format is ""? k"".  Add number x to all elements at indices from set Sk: aSk,\xe2\x80\x89i is replaced by aSk,\xe2\x80\x89i\xe2\x80\x89+\xe2\x80\x89x for all i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|Sk|). The query format is ""+ k x"". After each first type query print the required sum." 2500

348B "Apple Tree" "dfs and similar,number theory,trees" "You are given a rooted tree with n vertices. In each leaf vertex there\'s a single integer \xe2\x80\x94 the number of apples in this vertex. The weight of a subtree is the sum of all numbers in this subtree leaves. For instance, the weight of a subtree that corresponds to some leaf is the number written in the leaf.A tree is balanced if for every vertex v of the tree all its subtrees, corresponding to the children of vertex v, are of equal weight. Count the minimum number of apples that you need to remove from the tree (specifically, from some of its leaves) in order to make the tree balanced. Notice that you can always achieve the goal by just removing all apples." 2100

348A Mafia "binary search,math,sortings" "One day n friends gathered together to play ""Mafia"". During each round of the game some player must be the supervisor and other n\xe2\x80\x89-\xe2\x80\x891 people take part in the game. For each person we know in how many rounds he wants to be a player, not the supervisor: the i-th person wants to play ai rounds. What is the minimum number of rounds of the ""Mafia"" game they need to play to let each person play at least as many rounds as they want?" 1600

347B "Fixed Points" "brute force,implementation,math" "A permutation of length n is an integer sequence such that each integer from 0 to (n\xe2\x80\x89-\xe2\x80\x891) appears exactly once in it. For example, sequence [0,\xe2\x80\x892,\xe2\x80\x891] is a permutation of length 3 while both [0,\xe2\x80\x892,\xe2\x80\x892] and [1,\xe2\x80\x892,\xe2\x80\x893] are not.A fixed point of a function is a point that is mapped to itself by the function. A permutation can be regarded as a bijective function. We\'ll get a definition of a fixed point in a permutation. An integer i is a fixed point of permutation a0,\xe2\x80\x89a1,\xe2\x80\x89...,\xe2\x80\x89an\xe2\x80\x89-\xe2\x80\x891 if and only if ai\xe2\x80\x89=\xe2\x80\x89i. For example, permutation [0,\xe2\x80\x892,\xe2\x80\x891] has 1 fixed point and permutation [0,\xe2\x80\x891,\xe2\x80\x892] has 3 fixed points.You are given permutation a. You are allowed to swap two elements of the permutation at most once. Your task is to maximize the number of fixed points in the resulting permutation. Note that you are allowed to make at most one swap operation." 1100

347A "Difference Row" "constructive algorithms,implementation,sortings" "You want to arrange n integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an in some order in a row. Let\'s define the value of an arrangement as the sum of differences between all pairs of adjacent integers.More formally, let\'s denote some arrangement as a sequence of integers x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xn, where sequence x is a permutation of sequence a. The value of such an arrangement is (x1\xe2\x80\x89-\xe2\x80\x89x2)\xe2\x80\x89+\xe2\x80\x89(x2\xe2\x80\x89-\xe2\x80\x89x3)\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89(xn\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89-\xe2\x80\x89xn).Find the largest possible value of an arrangement. Then, output the lexicographically smallest sequence x that corresponds to an arrangement of the largest possible value." 1300

346E "Doodle Jump" "math,number theory" "In Doodle Jump the aim is to guide a four-legged creature called ""The Doodler"" up a never-ending series of platforms without falling. \xe2\x80\x94 Wikipedia. It is a very popular game and xiaodao likes it very much. One day when playing the game she wondered whether there exists a platform that the doodler couldn\'t reach due to the limits of its jumping ability. Consider the following problem.There are n platforms. The height of the x-th (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) platform is a\xc2\xb7x mod p, where a and p are positive co-prime integers. The maximum possible height of a Doodler\'s jump is h. That is, it can jump from height h1 to height h2 (h1\xe2\x80\x89<\xe2\x80\x89h2) if h2\xe2\x80\x89-\xe2\x80\x89h1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89h. Initially, the Doodler is on the ground, the height of which is 0. The question is whether it can reach the highest platform or not.For example, when a\xe2\x80\x89=\xe2\x80\x897, n\xe2\x80\x89=\xe2\x80\x894, p\xe2\x80\x89=\xe2\x80\x8912, h\xe2\x80\x89=\xe2\x80\x892, the heights of the platforms are 7, 2, 9, 4 as in the picture below. With the first jump the Doodler can jump to the platform at height 2, with the second one the Doodler can jump to the platform at height 4, but then it can\'t jump to any of the higher platforms. So, it can\'t reach the highest platform.  User xiaodao thought about the problem for a long time but didn\'t solve it, so she asks you for help. Also, she has a lot of instances of the problem. Your task is solve all of these instances." 3000

346D "Robot Control" "dp,graphs,shortest paths" "The boss of the Company of Robot is a cruel man. His motto is ""Move forward Or Die!"". And that is exactly what his company\'s product do. Look at the behavior of the company\'s robot when it is walking in the directed graph. This behavior has been called ""Three Laws of Robotics"":  Law 1. The Robot will destroy itself when it visits a vertex of the graph which it has already visited.  Law 2. The Robot will destroy itself when it has no way to go (that is when it reaches a vertex whose out-degree is zero).  Law 3. The Robot will move randomly when it has multiple ways to move (that is when it reach a vertex whose out-degree is more than one). Of course, the robot can move only along the directed edges of the graph. Can you imagine a robot behaving like that? That\'s why they are sold at a very low price, just for those who are short of money, including mzry1992, of course. mzry1992 has such a robot, and she wants to move it from vertex s to vertex t in a directed graph safely without self-destruction. Luckily, she can send her robot special orders at each vertex. A special order shows the robot which way to move, if it has multiple ways to move (to prevent random moving of the robot according to Law 3). When the robot reaches vertex t, mzry1992 takes it off the graph immediately. So you can see that, as long as there exists a path from s to t, she can always find a way to reach the goal (whatever the vertex t has the outdegree of zero or not).   Sample 2 However, sending orders is expensive, so your task is to find the minimum number of orders mzry1992 needs to send in the worst case. Please note that mzry1992 can give orders to the robot while it is walking on the graph. Look at the first sample to clarify that part of the problem." 2600

346C "Number Transformation II" greedy,math "You are given a sequence of positive integers x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xn and two non-negative integers a and b. Your task is to transform a into b. To do that, you can perform the following moves:  subtract 1 from the current a;  subtract a mod xi (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) from the current a. Operation a mod xi means taking the remainder after division of number a by number xi.Now you want to know the minimum number of moves needed to transform a into b." 2200

346B "Lucky Common Subsequence" dp,strings "In mathematics, a subsequence is a sequence that can be derived from another sequence by deleting some elements without changing the order of the remaining elements. For example, the sequence BDF is a subsequence of ABCDEF. A substring of a string is a continuous subsequence of the string. For example, BCD is a substring of ABCDEF.You are given two strings s1, s2 and another string called virus. Your task is to find the longest common subsequence of s1 and s2, such that it doesn\'t contain virus as a substring." 2000

346A "Alice and Bob" "games,math,number theory" "It is so boring in the summer holiday, isn\'t it? So Alice and Bob have invented a new game to play. The rules are as follows. First, they get a set of n distinct integers. And then they take turns to make the following moves. During each move, either Alice or Bob (the player whose turn is the current) can choose two distinct integers x and y from the set, such that the set doesn\'t contain their absolute difference |x\xe2\x80\x89-\xe2\x80\x89y|. Then this player adds integer |x\xe2\x80\x89-\xe2\x80\x89y| to the set (so, the size of the set increases by one).If the current player has no valid move, he (or she) loses the game. The question is who will finally win the game if both players play optimally. Remember that Alice always moves first." 1600

345G "Suffix Subgroup" "*special problem,strings" "You are given a group of n strings: s1,\xe2\x80\x89s2,\xe2\x80\x89...,\xe2\x80\x89sn.You should find a subgroup si1,\xe2\x80\x89si2,\xe2\x80\x89...,\xe2\x80\x89sik (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i1\xe2\x80\x89<\xe2\x80\x89i2\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89ik\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) of the group. The following two conditions must hold:  there exists a string t such, that each string from found subgroup is its suffix;  the number of strings in the found subgroup is as large as possible. Your task is to print the number of strings in the found subgroup." 2200

345F "Superstitions Inspection" "*special problem" "You read scientific research regarding popularity of most famous superstitions across various countries, and you want to analyze their data. More specifically, you want to know which superstitions are popular in most countries.The data is given as a single file in the following format: country name on a separate line, followed by a list of superstitions popular in it, one entry per line. Each entry of the list is formatted as an asterisk ""*"" followed by a single space and then by the superstition name. Entries are unique within each country. The first line of input will represent a country. The input will contain at least one superstition. Country name is a non-empty sequence of words, where each word consists of only English letters. The words of the name of some country will be separated in input with one or more spaces.Superstition name is a non-empty sequence of words, where each word consists of only English letters and digits. The words of the name of some superstition will be separated in input with one or more spaces.You can consider two names equal, if corresponding sequences of words are equal. You shouldn\'t consider the case of the letters when you compare the words.Output the list of superstitions which are observed in the greatest number of countries. It\'s guaranteed that all countries have distinct names." 2700

345E "Black Cat Rush" "*special problem" "Today you go out of your house and immediately notice that something is weird. Around your door there is a swarm of black cats \xe2\x80\x94 all tense paws and twitching tails. As you do your first step, they all dart off and start running towards you. It looks like they want to thwart you!You are moving in a straight line from point (0,\xe2\x80\x890) to point (a,\xe2\x80\x890) with velocity v. There are n black cats around you who want to cross your paths. A cat can move in any direction with velocity at most u. A cat assumes it has crossed your path if it managed to get to at least one point of your path earlier or at the same time as you got there.You are given four integers: a, v, u, n, as well as cats\' coordinates (xi,\xe2\x80\x89yi). What is the greatest number of cats who manage to cross your path?" 2700

345D "Chain Letter" "*special problem,dfs and similar,graphs" "A chain letter is a kind of a message which urges the recipient to forward it to as many contacts as possible, usually with some kind of mystic explanation. Of course, this is only a superstition, and you don\'t believe in it, but all your friends do. You know that today there will be one of these letters going around, and you want to know how many times you\'ll receive it \xe2\x80\x94 of course, not that you\'ll be sending it yourself!You are given an array of strings f with n elements which describes the contacts between you and n\xe2\x80\x89-\xe2\x80\x891 of your friends: j-th character of i-th string (f[i][j]) is ""1"" if people i and j will send messages to each other, and ""0"" otherwise. Person 1 starts sending the letter to all his contacts; every person who receives the letter for the first time sends it to all his contacts. You are person n, and you don\'t forward the letter when you receive it. Calculate the number of copies of this letter you\'ll receive." 2200

345C "Counting Fridays" "*special problem" "Judging from the previous problem, Friday the 13th really doesn\'t treat you well, so you start thinking about how to minimize its impact on your life. You are a passionate participant of programming contests, so various competitions are an important part of your schedule. Naturally, you\'d like as few of them to be spoiled as possible.A friendly admin leaked to you the list of dates on which the contests will be held for several years ahead. Check how many of them happen to take place on Friday the 13th of any month." 2000

345B Triskaidekaphobia "*special problem" "Triskaidekaphobia is a fear of number 13. Ordinary people who suffer from this phobia feel uncomfortable around numbers 13, 130, 513 etc, but you, being a programmer, take this fear one step further. For example, consider number 7. It\'s ok when written in decimal, but written in base 4 it becomes 13, the dreadful number!The more you think about it, the worse it looks. Number 100 has as many as 13 notations which contain 13! And there are numbers which have 13 in infinite number of their notations! Luckily, you can do any math in binary, which is completely safe from the nasty number. But still, you want to be able to estimate the level of nastiness of any number. Your task is: given an integer n, find the number of different integer bases b (b\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x892) for which n, written in base b, contains at least one 13. Assume that ""digits"" of the number in bases larger than 10 are written not as letters but as decimal numbers; thus, 30 in base 16 is not 1E but (1)(14) or simply 114. Please note, that 13 must be present as a substring of notation, not a subsequence (123 doesn\'t contain 13)." 2100

345A "Expecting Trouble" "*special problem,probabilities" "It is Friday the 13th today, and even though you\'re a modern well-educated person, you can\'t help feeling a bit nervous about it. You decide to look for evidence against this superstition (or for it). As a first step, you recall all Fridays the 13th in your life and calculate how many of them were unusually bad \xe2\x80\x94 like that time when you decided to play a game on ZX Spectrum and ended up breaking your TV set. The problem is, you can\'t remember some Fridays, and you\'re not sure why \xe2\x80\x94 were they really that bad?You have assembled a sequence of your recollections. Character ""0"" stands for a normal day, ""1"" \xe2\x80\x94 for a nasty one, and ""?"" means you have no idea what kind of day that was. Being a programmer, you decide to approximate these unknown days with independent random variables, which take value 1 with probability p, and 0 with probability (1\xe2\x80\x89-\xe2\x80\x89p).Given a string of your memories and the value of p, calculate out the expected value of average badness of your Fridays the 13th." 1500

344B "Simple Molecules" "brute force,graphs,math" "Mad scientist Mike is busy carrying out experiments in chemistry. Today he will attempt to join three atoms into one molecule.A molecule consists of atoms, with some pairs of atoms connected by atomic bonds. Each atom has a valence number \xe2\x80\x94 the number of bonds the atom must form with other atoms. An atom can form one or multiple bonds with any other atom, but it cannot form a bond with itself. The number of bonds of an atom in the molecule must be equal to its valence number.  Mike knows valence numbers of the three atoms. Find a molecule that can be built from these atoms according to the stated rules, or determine that it is impossible." 1200

344A Magnets implementation "Mad scientist Mike entertains himself by arranging rows of dominoes. He doesn\'t need dominoes, though: he uses rectangular magnets instead. Each magnet has two poles, positive (a ""plus"") and negative (a ""minus""). If two magnets are put together at a close distance, then the like poles will repel each other and the opposite poles will attract each other.Mike starts by laying one magnet horizontally on the table. During each following step Mike adds one more magnet horizontally to the right end of the row. Depending on how Mike puts the magnet on the table, it is either attracted to the previous one (forming a group of multiple magnets linked together) or repelled by it (then Mike lays this magnet at some distance to the right from the previous one). We assume that a sole magnet not linked to others forms a group of its own.  Mike arranged multiple magnets in a row. Determine the number of groups that the magnets formed." 800

343E "Pumping Stations" "brute force,dfs and similar,divide and conquer,flows,graphs,greedy,trees" "Mad scientist Mike has applied for a job. His task is to manage a system of water pumping stations.The system consists of n pumping stations, which are numbered by integers from 1 to n. Some pairs of stations are connected by bidirectional pipes through which water can flow in either direction (but only in one at a time). For each pipe you know its bandwidth \xe2\x80\x94 the maximum number of liters of water that can flow through it in one hour. Each pumping station can pump incoming water from some stations to other stations through the pipes, provided that in one hour the total influx of water to the station is equal to the total outflux of water from the station.It is Mike\'s responsibility to pump water between stations. From station a to station b through the pipes (possibly through other stations) within one hour one can transmit a certain number of liters of water according to the rules described above. During this time, water from other stations can not flow into station a, and can not flow out of the station b. However, any amount of water can flow out of station a or in station b. If a total of x litres of water flows out of the station a in an hour, then Mike gets x bollars more to his salary.To get paid, Mike needs to work for n\xe2\x80\x89-\xe2\x80\x891 days, according to the contract. On the first day he selects two stations v1 and v2, and within one hour he pumps a certain amount of water from v1 to v2. Next, on the i-th day Mike chooses a station vi\xe2\x80\x89+\xe2\x80\x891 that has been never selected before, and pumps a certain amount of water out of the station vi to station vi\xe2\x80\x89+\xe2\x80\x891 for one hour. The quantity of water he pumps on the i-th day does not depend on the amount of water pumped on the (i\xe2\x80\x89-\xe2\x80\x891)-th day.Mike needs to earn as much bollars as he can for his projects. Help Mike find such a permutation of station numbers v1, v2, ..., vn so Mike will be able to earn the highest possible salary." 2900

343D "Water Tree" "data structures,dfs and similar,graphs,trees" "Mad scientist Mike has constructed a rooted tree, which consists of n vertices. Each vertex is a reservoir which can be either empty or filled with water.The vertices of the tree are numbered from 1 to n with the root at vertex 1. For each vertex, the reservoirs of its children are located below the reservoir of this vertex, and the vertex is connected with each of the children by a pipe through which water can flow downwards.Mike wants to do the following operations with the tree:   Fill vertex v with water. Then v and all its children are filled with water.  Empty vertex v. Then v and all its ancestors are emptied.  Determine whether vertex v is filled with water at the moment.  Initially all vertices of the tree are empty.Mike has already compiled a full list of operations that he wants to perform in order. Before experimenting with the tree Mike decided to run the list through a simulation. Help Mike determine what results will he get after performing all the operations." 2100

343C "Read Time" "binary search,greedy,two pointers" "Mad scientist Mike does not use slow hard disks. His modification of a hard drive has not one, but n different heads that can read data in parallel.When viewed from the side, Mike\'s hard drive is an endless array of tracks. The tracks of the array are numbered from left to right with integers, starting with 1. In the initial state the i-th reading head is above the track number hi. For each of the reading heads, the hard drive\'s firmware can move the head exactly one track to the right or to the left, or leave it on the current track. During the operation each head\'s movement does not affect the movement of the other heads: the heads can change their relative order; there can be multiple reading heads above any of the tracks. A track is considered read if at least one head has visited this track. In particular, all of the tracks numbered h1, h2, ..., hn have been read at the beginning of the operation.  Mike needs to read the data on m distinct tracks with numbers p1, p2, ..., pm. Determine the minimum time the hard drive firmware needs to move the heads and read all the given tracks. Note that an arbitrary number of other tracks can also be read." 1900

343B "Alternating Current" "data structures,greedy,implementation" "Mad scientist Mike has just finished constructing a new device to search for extraterrestrial intelligence! He was in such a hurry to launch it for the first time that he plugged in the power wires without giving it a proper glance and started experimenting right away. After a while Mike observed that the wires ended up entangled and now have to be untangled again.The device is powered by two wires ""plus"" and ""minus"". The wires run along the floor from the wall (on the left) to the device (on the right). Both the wall and the device have two contacts in them on the same level, into which the wires are plugged in some order. The wires are considered entangled if there are one or more places where one wire runs above the other one. For example, the picture below has four such places (top view):  Mike knows the sequence in which the wires run above each other. Mike also noticed that on the left side, the ""plus"" wire is always plugged into the top contact (as seen on the picture). He would like to untangle the wires without unplugging them and without moving the device. Determine if it is possible to do that. A wire can be freely moved and stretched on the floor, but cannot be cut.To understand the problem better please read the notes to the test samples." 1600

343A "Rational Resistance" "math,number theory" "Mad scientist Mike is building a time machine in his spare time. To finish the work, he needs a resistor with a certain resistance value.However, all Mike has is lots of identical resistors with unit resistance R0\xe2\x80\x89=\xe2\x80\x891. Elements with other resistance can be constructed from these resistors. In this problem, we will consider the following as elements:   one resistor;  an element and one resistor plugged in sequence;  an element and one resistor plugged in parallel.   With the consecutive connection the resistance of the new element equals R\xe2\x80\x89=\xe2\x80\x89Re\xe2\x80\x89+\xe2\x80\x89R0. With the parallel connection the resistance of the new element equals . In this case Re equals the resistance of the element being connected.Mike needs to assemble an element with a resistance equal to the fraction . Determine the smallest possible number of resistors he needs to make such an element." 1600

342E "Xenia and Tree" "data structures,divide and conquer,trees" "Xenia the programmer has a tree consisting of n nodes. We will consider the tree nodes indexed from 1 to n. We will also consider the first node to be initially painted red, and the other nodes \xe2\x80\x94 to be painted blue.The distance between two tree nodes v and u is the number of edges in the shortest path between v and u.Xenia needs to learn how to quickly execute queries of two types:  paint a specified blue node in red;  calculate which red node is the closest to the given one and print the shortest distance to the closest red node. Your task is to write a program which will execute the described queries." 2400

342D "Xenia and Dominoes" "bitmasks,dfs and similar,dp" "Xenia likes puzzles very much. She is especially fond of the puzzles that consist of domino pieces. Look at the picture that shows one of such puzzles.  A puzzle is a 3\xe2\x80\x89\xc3\x97\xe2\x80\x89n table with forbidden cells (black squares) containing dominoes (colored rectangles on the picture). A puzzle is called correct if it meets the following conditions:  each domino occupies exactly two non-forbidden cells of the table;  no two dominoes occupy the same table cell;  exactly one non-forbidden cell of the table is unoccupied by any domino (it is marked by a circle in the picture). To solve the puzzle, you need multiple steps to transport an empty cell from the starting position to some specified position. A move is transporting a domino to the empty cell, provided that the puzzle stays correct. The horizontal dominoes can be moved only horizontally, and vertical dominoes can be moved only vertically. You can\'t rotate dominoes. The picture shows a probable move.Xenia has a 3\xe2\x80\x89\xc3\x97\xe2\x80\x89n table with forbidden cells and a cell marked with a circle. Also, Xenia has very many identical dominoes. Now Xenia is wondering, how many distinct correct puzzles she can make if she puts dominoes on the existing table. Also, Xenia wants the circle-marked cell to be empty in the resulting puzzle. The puzzle must contain at least one move.Help Xenia, count the described number of puzzles. As the described number can be rather large, print the remainder after dividing it by 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." 2100

342C "Cupboard and Balloons" geometry "A girl named Xenia has a cupboard that looks like an arc from ahead. The arc is made of a semicircle with radius r (the cupboard\'s top) and two walls of height h (the cupboard\'s sides). The cupboard\'s depth is r, that is, it looks like a rectangle with base r and height h\xe2\x80\x89+\xe2\x80\x89r from the sides. The figure below shows what the cupboard looks like (the front view is on the left, the side view is on the right).  Xenia got lots of balloons for her birthday. The girl hates the mess, so she wants to store the balloons in the cupboard. Luckily, each balloon is a sphere with radius . Help Xenia calculate the maximum number of balloons she can put in her cupboard. You can say that a balloon is in the cupboard if you can\'t see any part of the balloon on the left or right view. The balloons in the cupboard can touch each other. It is not allowed to squeeze the balloons or deform them in any way. You can assume that the cupboard\'s walls are negligibly thin." 1900

342B "Xenia and Spies" "brute force,greedy,implementation" "Xenia the vigorous detective faced n (n\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x892) foreign spies lined up in a row. We\'ll consider the spies numbered from 1 to n from left to right. Spy s has an important note. He has to pass the note to spy f. Xenia interrogates the spies in several steps. During one step the spy keeping the important note can pass the note to one of his neighbours in the row. In other words, if this spy\'s number is x, he can pass the note to another spy, either x\xe2\x80\x89-\xe2\x80\x891 or x\xe2\x80\x89+\xe2\x80\x891 (if x\xe2\x80\x89=\xe2\x80\x891 or x\xe2\x80\x89=\xe2\x80\x89n, then the spy has only one neighbour). Also during a step the spy can keep a note and not pass it to anyone.But nothing is that easy. During m steps Xenia watches some spies attentively. Specifically, during step ti (steps are numbered from 1) Xenia watches spies numbers li,\xe2\x80\x89li\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89li\xe2\x80\x89+\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89ri (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89li\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ri\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n). Of course, if during some step a spy is watched, he can\'t do anything: neither give the note nor take it from some other spy. Otherwise, Xenia reveals the spies\' cunning plot. Nevertheless, if the spy at the current step keeps the note, Xenia sees nothing suspicious even if she watches him.You\'ve got s and f. Also, you have the steps during which Xenia watches spies and which spies she is going to watch during each step. Find the best way the spies should act in order to pass the note from spy s to spy f as quickly as possible (in the minimum number of steps)." 1500

342A "Xenia and Divisors" greedy,implementation "Xenia the mathematician has a sequence consisting of n (n is divisible by 3) positive integers, each of them is at most 7. She wants to split the sequence into groups of three so that for each group of three a,\xe2\x80\x89b,\xe2\x80\x89c the following conditions held:  a\xe2\x80\x89<\xe2\x80\x89b\xe2\x80\x89<\xe2\x80\x89c;  a divides b, b divides c. Naturally, Xenia wants each element of the sequence to belong to exactly one group of three. Thus, if the required partition exists, then it has  groups of three.Help Xenia, find the required partition or else say that it doesn\'t exist." 1200

341E "Candies Game" "constructive algorithms,greedy" "Iahub is playing an uncommon game. Initially, he has n boxes, numbered 1, 2, 3, ..., n. Each box has some number of candies in it, described by a sequence a1, a2, ..., an. The number ak represents the number of candies in box k. The goal of the game is to move all candies into exactly two boxes. The rest of n\xe2\x80\x89-\xe2\x80\x892 boxes must contain zero candies. Iahub is allowed to do several (possible zero) moves. At each move he chooses two different boxes i and j, such that ai\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89aj. Then, Iahub moves from box j to box i exactly ai candies. Obviously, when two boxes have equal number of candies, box number j becomes empty.Your task is to give him a set of moves such as Iahub to archive the goal of the game. If Iahub can\'t win the game for the given configuration of boxes, output -1. Please note that in case there exist a solution, you don\'t need to print the solution using minimal number of moves." 3000

341D "Iahub and Xors" "data structures" "Iahub does not like background stories, so he\'ll tell you exactly what this problem asks you for.You are given a matrix a with n rows and n columns. Initially, all values of the matrix are zeros. Both rows and columns are 1-based, that is rows are numbered 1, 2, ..., n and columns are numbered 1, 2, ..., n. Let\'s denote an element on the i-th row and j-th column as ai,\xe2\x80\x89j.We will call a submatrix (x0,\xe2\x80\x89y0,\xe2\x80\x89x1,\xe2\x80\x89y1) such elements ai,\xe2\x80\x89j for which two inequalities hold: x0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x1, y0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y1.Write a program to perform two following operations:  Query(x0, y0, x1, y1): print the xor sum of the elements of the submatrix (x0,\xe2\x80\x89y0,\xe2\x80\x89x1,\xe2\x80\x89y1).  Update(x0, y0, x1, y1, v): each element from submatrix (x0,\xe2\x80\x89y0,\xe2\x80\x89x1,\xe2\x80\x89y1) gets xor-ed by value v." 2500

340E "Iahub and Permutations" combinatorics,math "Iahub is so happy about inventing bubble sort graphs that he\'s staying all day long at the office and writing permutations. Iahubina is angry that she is no more important for Iahub. When Iahub goes away, Iahubina comes to his office and sabotage his research work.The girl finds an important permutation for the research. The permutation contains n distinct integers a1, a2, ..., an (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ai\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n). She replaces some of permutation elements with -1 value as a revenge. When Iahub finds out his important permutation is broken, he tries to recover it. The only thing he remembers about the permutation is it didn\'t have any fixed point. A fixed point for a permutation is an element ak which has value equal to k (ak\xe2\x80\x89=\xe2\x80\x89k). Your job is to proof to Iahub that trying to recover it is not a good idea. Output the number of permutations which could be originally Iahub\'s important permutation, modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." 2000

340D "Bubble Sort Graph" "binary search,data structures,dp" "Iahub recently has learned Bubble Sort, an algorithm that is used to sort a permutation with n elements a1, a2, ..., an in ascending order. He is bored of this so simple algorithm, so he invents his own graph. The graph (let\'s call it G) initially has n vertices and 0 edges. During Bubble Sort execution, edges appear as described in the following algorithm (pseudocode). procedure bubbleSortGraph()    build a graph G with n vertices and 0 edges    repeat        swapped = false        for i = 1 to n - 1 inclusive do:            if a[i] > a[i + 1] then                add an undirected edge in G between a[i] and a[i + 1]                swap( a[i], a[i + 1] )                swapped = true            end if        end for    until not swapped     /* repeat the algorithm as long as swapped value is true. */ end procedureFor a graph, an independent set is a set of vertices in a graph, no two of which are adjacent (so there are no edges between vertices of an independent set). A maximum independent set is an independent set which has maximum cardinality. Given the permutation, find the size of the maximum independent set of graph G, if we use such permutation as the premutation a in procedure bubbleSortGraph." 1500

340C "Tourist Problem" combinatorics,implementation,math "Iahub is a big fan of tourists. He wants to become a tourist himself, so he planned a trip. There are n destinations on a straight road that Iahub wants to visit. Iahub starts the excursion from kilometer 0. The n destinations are described by a non-negative integers sequence a1, a2, ..., an. The number ak represents that the kth destination is at distance ak kilometers from the starting point. No two destinations are located in the same place. Iahub wants to visit each destination only once. Note that, crossing through a destination is not considered visiting, unless Iahub explicitly wants to visit it at that point. Also, after Iahub visits his last destination, he doesn\'t come back to kilometer 0, as he stops his trip at the last destination. The distance between destination located at kilometer x and next destination, located at kilometer y, is |x\xe2\x80\x89-\xe2\x80\x89y| kilometers. We call a ""route"" an order of visiting the destinations. Iahub can visit destinations in any order he wants, as long as he visits all n destinations and he doesn\'t visit a destination more than once. Iahub starts writing out on a paper all possible routes and for each of them, he notes the total distance he would walk. He\'s interested in the average number of kilometers he would walk by choosing a route. As he got bored of writing out all the routes, he asks you to help him." 1600

340B "Maximal Area Quadrilateral" "brute force,geometry" "Iahub has drawn a set of n points in the cartesian plane which he calls ""special points"". A quadrilateral is a simple polygon without self-intersections with four sides (also called edges) and four vertices (also called corners). Please note that a quadrilateral doesn\'t have to be convex. A special quadrilateral is one which has all four vertices in the set of special points. Given the set of special points, please calculate the maximal area of a special quadrilateral." 2100

340A "The Wall" math "Iahub and his friend Floyd have started painting a wall. Iahub is painting the wall red and Floyd is painting it pink. You can consider the wall being made of a very large number of bricks, numbered 1, 2, 3 and so on. Iahub has the following scheme of painting: he skips x\xe2\x80\x89-\xe2\x80\x891 consecutive bricks, then he paints the x-th one. That is, he\'ll paint bricks x, 2\xc2\xb7x, 3\xc2\xb7x and so on red. Similarly, Floyd skips y\xe2\x80\x89-\xe2\x80\x891 consecutive bricks, then he paints the y-th one. Hence he\'ll paint bricks y, 2\xc2\xb7y, 3\xc2\xb7y and so on pink.After painting the wall all day, the boys observed that some bricks are painted both red and pink. Iahub has a lucky number a and Floyd has a lucky number b. Boys wonder how many bricks numbered no less than a and no greater than b are painted both red and pink. This is exactly your task: compute and print the answer to the question." 1200

339E "Three Swaps" "constructive algorithms,dfs and similar,greedy" "Xenia the horse breeder has n (n\xe2\x80\x89>\xe2\x80\x891) horses that stand in a row. Each horse has its own unique number. Initially, the i-th left horse has number i. That is, the sequence of numbers of horses in a row looks as follows (from left to right): 1, 2, 3, ..., n.Xenia trains horses before the performance. During the practice sessions, she consistently gives them commands. Each command is a pair of numbers l,\xe2\x80\x89r (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89<\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n). The command l,\xe2\x80\x89r means that the horses that are on the l-th, (l\xe2\x80\x89+\xe2\x80\x891)-th, (l\xe2\x80\x89+\xe2\x80\x892)-th, ..., r-th places from the left must be rearranged. The horses that initially stand on the l-th and r-th places will swap. The horses on the (l\xe2\x80\x89+\xe2\x80\x891)-th and (r\xe2\x80\x89-\xe2\x80\x891)-th places will swap. The horses on the (l\xe2\x80\x89+\xe2\x80\x892)-th and (r\xe2\x80\x89-\xe2\x80\x892)-th places will swap and so on. In other words, the horses that were on the segment [l,\xe2\x80\x89r] change their order to the reverse one.For example, if Xenia commanded l\xe2\x80\x89=\xe2\x80\x892,\xe2\x80\x89r\xe2\x80\x89=\xe2\x80\x895, and the sequence of numbers of horses before the command looked as (2, 1, 3, 4, 5, 6), then after the command the sequence will be (2, 5, 4, 3, 1, 6).We know that during the practice Xenia gave at most three commands of the described form. You have got the final sequence of numbers of horses by the end of the practice. Find what commands Xenia gave during the practice. Note that you do not need to minimize the number of commands in the solution, find any valid sequence of at most three commands." 2700

339D "Xenia and Bit Operations" "data structures,trees" "Xenia the beginner programmer has a sequence a, consisting of 2n non-negative integers: a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89a2n. Xenia is currently studying bit operations. To better understand how they work, Xenia decided to calculate some value v for a.Namely, it takes several iterations to calculate value v. At the first iteration, Xenia writes a new sequence a1�or�a2,\xe2\x80\x89a3�or�a4,\xe2\x80\x89...,\xe2\x80\x89a2n\xe2\x80\x89-\xe2\x80\x891�or�a2n, consisting of 2n\xe2\x80\x89-\xe2\x80\x891 elements. In other words, she writes down the bit-wise OR of adjacent elements of sequence a. At the second iteration, Xenia writes the bitwise exclusive OR of adjacent elements of the sequence obtained after the first iteration. At the third iteration Xenia writes the bitwise OR of the adjacent elements of the sequence obtained after the second iteration. And so on; the operations of bitwise exclusive OR and bitwise OR alternate. In the end, she obtains a sequence consisting of one element, and that element is v.Let\'s consider an example. Suppose that sequence a\xe2\x80\x89=\xe2\x80\x89(1,\xe2\x80\x892,\xe2\x80\x893,\xe2\x80\x894). Then let\'s write down all the transformations (1,\xe2\x80\x892,\xe2\x80\x893,\xe2\x80\x894) \xe2\x80\x89\xe2\x86\x92\xe2\x80\x89 (1�or�2\xe2\x80\x89=\xe2\x80\x893,\xe2\x80\x893�or�4\xe2\x80\x89=\xe2\x80\x897) \xe2\x80\x89\xe2\x86\x92\xe2\x80\x89 (3�xor�7\xe2\x80\x89=\xe2\x80\x894). The result is v\xe2\x80\x89=\xe2\x80\x894.You are given Xenia\'s initial sequence. But to calculate value v for a given sequence would be too easy, so you are given additional m queries. Each query is a pair of integers p,\xe2\x80\x89b. Query p,\xe2\x80\x89b means that you need to perform the assignment ap\xe2\x80\x89=\xe2\x80\x89b. After each query, you need to print the new value v for the new sequence a." 1700

339C "Xenia and Weights" "constructive algorithms,dfs and similar,dp,graphs,greedy,shortest paths" "Xenia has a set of weights and pan scales. Each weight has an integer weight from 1 to 10 kilos. Xenia is going to play with scales and weights a little. For this, she puts weights on the scalepans, one by one. The first weight goes on the left scalepan, the second weight goes on the right scalepan, the third one goes on the left scalepan, the fourth one goes on the right scalepan and so on. Xenia wants to put the total of m weights on the scalepans.Simply putting weights on the scales is not interesting, so Xenia has set some rules. First, she does not put on the scales two consecutive weights of the same weight. That is, the weight that goes i-th should be different from the (i\xe2\x80\x89+\xe2\x80\x891)-th weight for any i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89m). Second, every time Xenia puts a weight on some scalepan, she wants this scalepan to outweigh the other one. That is, the sum of the weights on the corresponding scalepan must be strictly greater than the sum on the other pan.You are given all types of weights available for Xenia. You can assume that the girl has an infinite number of weights of each specified type. Your task is to help Xenia lay m weights on \xe2\x80\x8b\xe2\x80\x8bthe scales or to say that it can\'t be done." 1700

339B "Xenia and Ringroad" implementation "Xenia lives in a city that has n houses built along the main ringroad. The ringroad houses are numbered 1 through n in the clockwise order. The ringroad traffic is one way and also is clockwise.Xenia has recently moved into the ringroad house number 1. As a result, she\'s got m things to do. In order to complete the i-th task, she needs to be in the house number ai and complete all tasks with numbers less than i. Initially, Xenia is in the house number 1, find the minimum time she needs to complete all her tasks if moving from a house to a neighboring one along the ringroad takes one unit of time." 1000

339A "Helpful Maths" greedy,implementation,sortings,strings "Xenia the beginner mathematician is a third year student at elementary school. She is now learning the addition operation.The teacher has written down the sum of multiple numbers. Pupils should calculate the sum. To make the calculation easier, the sum only contains numbers 1, 2 and 3. Still, that isn\'t enough for Xenia. She is only beginning to count, so she can calculate a sum only if the summands follow in non-decreasing order. For example, she can\'t calculate sum 1+3+2+1 but she can calculate sums 1+1+2 and 3+3.You\'ve got the sum that was written on the board. Rearrange the summans and print the sum in such a way that Xenia can calculate the sum." 800

338E Optimize! "data structures" "Manao is solving a problem with the following statement:  He came up with a solution that produces the correct answers but is too slow. You are given the pseudocode of his solution, where the function getAnswer calculates the answer to the problem:getAnswer(a[1..n], b[1..len], h)  answer = 0  for i = 1 to n-len+1    answer = answer + f(a[i..i+len-1], b, h, 1)  return answerf(s[1..len], b[1..len], h, index)  if index = len+1 then    return 1  for i = 1 to len    if s[index] + b[i] >= h      mem = b[i]      b[i] = 0      res = f(s, b, h, index + 1)      b[i] = mem      if res > 0        return 1  return 0Your task is to help Manao optimize his algorithm." 2600

338D "GCD Table" "chinese remainder theorem,math,number theory" "Consider a table G of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m such that G(i,\xe2\x80\x89j)\xe2\x80\x89=\xe2\x80\x89GCD(i,\xe2\x80\x89j) for all 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n,\xe2\x80\x891\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m. GCD(a,\xe2\x80\x89b) is the greatest common divisor of numbers a and b.You have a sequence of positive integer numbers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89ak. We say that this sequence occurs in table G if it coincides with consecutive elements in some row, starting from some position. More formally, such numbers 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n and 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m\xe2\x80\x89-\xe2\x80\x89k\xe2\x80\x89+\xe2\x80\x891 should exist that G(i,\xe2\x80\x89j\xe2\x80\x89+\xe2\x80\x89l\xe2\x80\x89-\xe2\x80\x891)\xe2\x80\x89=\xe2\x80\x89al for all 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k.Determine if the sequence a occurs in table G." 2900

337E "Divisor Tree" "brute force,number theory,trees" "A divisor tree is a rooted tree that meets the following conditions:   Each vertex of the tree contains a positive integer number.  The numbers written in the leaves of the tree are prime numbers.  For any inner vertex, the number within it is equal to the product of the numbers written in its children. Manao has n distinct integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. He tries to build a divisor tree which contains each of these numbers. That is, for each ai, there should be at least one vertex in the tree which contains ai. Manao loves compact style, but his trees are too large. Help Manao determine the minimum possible number of vertices in the divisor tree sought." 2200

337D "Book of Evil" "dfs and similar,divide and conquer,dp,trees" "Paladin Manao caught the trail of the ancient Book of Evil in a swampy area. This area contains n settlements numbered from 1 to n. Moving through the swamp is very difficult, so people tramped exactly n\xe2\x80\x89-\xe2\x80\x891 paths. Each of these paths connects some pair of settlements and is bidirectional. Moreover, it is possible to reach any settlement from any other one by traversing one or several paths.The distance between two settlements is the minimum number of paths that have to be crossed to get from one settlement to the other one. Manao knows that the Book of Evil has got a damage range d. This means that if the Book of Evil is located in some settlement, its damage (for example, emergence of ghosts and werewolves) affects other settlements at distance d or less from the settlement where the Book resides.Manao has heard of m settlements affected by the Book of Evil. Their numbers are p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pm. Note that the Book may be affecting other settlements as well, but this has not been detected yet. Manao wants to determine which settlements may contain the Book. Help him with this difficult task." 2000

337C Quiz "binary search,greedy,math,matrices,number theory" "Manao is taking part in a quiz. The quiz consists of n consecutive questions. A correct answer gives one point to the player. The game also has a counter of consecutive correct answers. When the player answers a question correctly, the number on this counter increases by 1. If the player answers a question incorrectly, the counter is reset, that is, the number on it reduces to 0. If after an answer the counter reaches the number k, then it is reset, and the player\'s score is doubled. Note that in this case, first 1 point is added to the player\'s score, and then the total score is doubled. At the beginning of the game, both the player\'s score and the counter of consecutive correct answers are set to zero.Manao remembers that he has answered exactly m questions correctly. But he does not remember the order in which the questions came. He\'s trying to figure out what his minimum score may be. Help him and compute the remainder of the corresponding number after division by 1000000009 (109\xe2\x80\x89+\xe2\x80\x899)." 1600

337B "Routine Problem" "greedy,math,number theory" "Manao has a monitor. The screen of the monitor has horizontal to vertical length ratio a:b. Now he is going to watch a movie. The movie\'s frame has horizontal to vertical length ratio c:d. Manao adjusts the view in such a way that the movie preserves the original frame ratio, but also occupies as much space on the screen as possible and fits within it completely. Thus, he may have to zoom the movie in or out, but Manao will always change the frame proportionally in both dimensions.Calculate the ratio of empty screen (the part of the screen not occupied by the movie) to the total screen size. Print the answer as an irreducible fraction p\xe2\x80\x89/\xe2\x80\x89q." 1400

337A Puzzles greedy "The end of the school year is near and Ms. Manana, the teacher, will soon have to say goodbye to a yet another class. She decided to prepare a goodbye present for her n students and give each of them a jigsaw puzzle (which, as wikipedia states, is a tiling puzzle that requires the assembly of numerous small, often oddly shaped, interlocking and tessellating pieces).The shop assistant told the teacher that there are m puzzles in the shop, but they might differ in difficulty and size. Specifically, the first jigsaw puzzle consists of f1 pieces, the second one consists of f2 pieces and so on.Ms. Manana doesn\'t want to upset the children, so she decided that the difference between the numbers of pieces in her presents must be as small as possible. Let A be the number of pieces in the largest puzzle that the teacher buys and B be the number of pieces in the smallest such puzzle. She wants to choose such n puzzles that A\xe2\x80\x89-\xe2\x80\x89B is minimum possible. Help the teacher and find the least possible value of A\xe2\x80\x89-\xe2\x80\x89B." 900

336E "Vasily the Bear and Painting Square" bitmasks,combinatorics,dp,implementation "Vasily the bear has two favorite integers n and k and a pencil. Besides, he\'s got k jars with different water color paints. All jars are numbered in some manner from 1 to k, inclusive. The jar number i contains the paint of the i-th color. Initially the bear took a pencil and drew four segments on the coordinate plane. All of them end at point (0,\xe2\x80\x890). They begin at: (0,\xe2\x80\x892n), (0,\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x892n), (2n,\xe2\x80\x890), (\xe2\x80\x89-\xe2\x80\x892n,\xe2\x80\x890). Then for each i\xe2\x80\x89=\xe2\x80\x891,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89n, the bear drew two squares. The first square has the following vertex coordinates: (2i,\xe2\x80\x890), (\xe2\x80\x89-\xe2\x80\x892i,\xe2\x80\x890), (0,\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x892i), (0,\xe2\x80\x892i). The second square has the following vertex coordinates: (\xe2\x80\x89-\xe2\x80\x892i\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x892i\xe2\x80\x89-\xe2\x80\x891), (\xe2\x80\x89-\xe2\x80\x892i\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x892i\xe2\x80\x89-\xe2\x80\x891), (2i\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x892i\xe2\x80\x89-\xe2\x80\x891), (2i\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x892i\xe2\x80\x89-\xe2\x80\x891). After that, the bear drew another square: (1,\xe2\x80\x890), (\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x890), (0,\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x891), (0,\xe2\x80\x891). All points mentioned above form the set of points A.The sample of the final picture at n\xe2\x80\x89=\xe2\x80\x890The sample of the final picture at n\xe2\x80\x89=\xe2\x80\x892The bear decided to paint the resulting picture in k moves. The i-th move consists of the following stages:   The bear chooses 3 distinct points in set \xd0\x90 so that any pair of the chosen points has a segment on the picture between them. The chosen points and segments mark the area that mustn\'t contain any previously painted points.  The bear paints the area bounded by the chosen points and segments the i-th color. Note that after the k-th move some parts of the picture can stay unpainted.The bear asked you to calculate, how many distinct ways there are to paint his picture. A way to paint the picture is a sequence of three-element sets of points he chose on each step. Two sequences are considered distinct if there is such number i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k), that the i-th members of these sequences do not coincide as sets. As the sought number can be rather large, you only need to calculate the remainder after dividing it by number 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." 2700

336D "Vasily the Bear and Beautiful Strings" "combinatorics,math,number theory" "Vasily the Bear loves beautiful strings. String s is beautiful if it meets the following criteria:   String s only consists of characters 0 and 1, at that character 0 must occur in string s exactly n times, and character 1 must occur exactly m times.  We can obtain character g from string s with some (possibly, zero) number of modifications. The character g equals either zero or one. A modification of string with length at least two is the following operation: we replace two last characters from the string by exactly one other character. This character equals one if it replaces two zeros, otherwise it equals zero. For example, one modification transforms string ""01010"" into string ""0100"", two modifications transform it to ""011"". It is forbidden to modify a string with length less than two.Help the Bear, count the number of beautiful strings. As the number of beautiful strings can be rather large, print the remainder after dividing the number by 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." 2100

336C "Vasily the Bear and Sequence" "brute force,greedy,implementation,number theory" "Vasily the bear has got a sequence of positive integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. Vasily the Bear wants to write out several numbers on a piece of paper so that the beauty of the numbers he wrote out was maximum. The beauty of the written out numbers b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bk is such maximum non-negative integer v, that number b1 and b2 and ... and bk is divisible by number 2v without a remainder. If such number v doesn\'t exist (that is, for any non-negative integer v, number b1 and b2 and ... and bk is divisible by 2v without a remainder), the beauty of the written out numbers equals -1. Tell the bear which numbers he should write out so that the beauty of the written out numbers is maximum. If there are multiple ways to write out the numbers, you need to choose the one where the bear writes out as many numbers as possible.Here expression x and y means applying the bitwise AND operation to numbers x and y. In programming languages C++ and Java this operation is represented by ""&"", in Pascal \xe2\x80\x94 by ""and""." 1800

336B "Vasily the Bear and Fly" math "One beautiful day Vasily the bear painted 2m circles of the same radius R on a coordinate plane. Circles with numbers from 1 to m had centers at points (2R\xe2\x80\x89-\xe2\x80\x89R,\xe2\x80\x890), (4R\xe2\x80\x89-\xe2\x80\x89R,\xe2\x80\x890), ..., (2Rm\xe2\x80\x89-\xe2\x80\x89R,\xe2\x80\x890), respectively. Circles with numbers from m\xe2\x80\x89+\xe2\x80\x891 to 2m had centers at points (2R\xe2\x80\x89-\xe2\x80\x89R,\xe2\x80\x892R), (4R\xe2\x80\x89-\xe2\x80\x89R,\xe2\x80\x892R), ..., (2Rm\xe2\x80\x89-\xe2\x80\x89R,\xe2\x80\x892R), respectively. Naturally, the bear painted the circles for a simple experiment with a fly. The experiment continued for m2 days. Each day of the experiment got its own unique number from 0 to m2\xe2\x80\x89-\xe2\x80\x891, inclusive. On the day number i the following things happened:   The fly arrived at the coordinate plane at the center of the circle with number  ( is the result of dividing number x by number y, rounded down to an integer).  The fly went along the coordinate plane to the center of the circle number  ( is the remainder after dividing number x by number y). The bear noticed that the fly went from the center of circle v to the center of circle u along the shortest path with all points lying on the border or inside at least one of the 2m circles. After the fly reached the center of circle u, it flew away in an unknown direction. Help Vasily, count the average distance the fly went along the coordinate plane during each of these m2 days." 1900

336A "Vasily the Bear and Triangle" implementation,math "Vasily the bear has a favorite rectangle, it has one vertex at point (0,\xe2\x80\x890), and the opposite vertex at point (x,\xe2\x80\x89y). Of course, the sides of Vasya\'s favorite rectangle are parallel to the coordinate axes. Vasya also loves triangles, if the triangles have one vertex at point B\xe2\x80\x89=\xe2\x80\x89(0,\xe2\x80\x890). That\'s why today he asks you to find two points A\xe2\x80\x89=\xe2\x80\x89(x1,\xe2\x80\x89y1) and C\xe2\x80\x89=\xe2\x80\x89(x2,\xe2\x80\x89y2), such that the following conditions hold:  the coordinates of points: x1, x2, y1, y2 are integers. Besides, the following inequation holds: x1\xe2\x80\x89<\xe2\x80\x89x2;  the triangle formed by point A, B and C is rectangular and isosceles ( is right);  all points of the favorite rectangle are located inside or on the border of triangle ABC;  the area of triangle ABC is as small as possible. Help the bear, find the required points. It is not so hard to proof that these points are unique." 1000

335F "Buy One, Get One Free" dp,greedy "A nearby pie shop is having a special sale. For each pie you pay full price for, you may select one pie of a strictly lesser value to get for free. Given the prices of all the pies you wish to acquire, determine the minimum total amount you must pay for all of the pies." 3000

335E "Counting Skyscrapers" dp,math,probabilities "A number of skyscrapers have been built in a line. The number of skyscrapers was chosen uniformly at random between 2 and 314! (314 factorial, a very large number). The height of each skyscraper was chosen randomly and independently, with height i having probability 2\xe2\x80\x89-\xe2\x80\x89i for all positive integers i. The floors of a skyscraper with height i are numbered 0 through i\xe2\x80\x89-\xe2\x80\x891.To speed up transit times, a number of zip lines were installed between skyscrapers. Specifically, there is a zip line connecting the i-th floor of one skyscraper with the i-th floor of another skyscraper if and only if there are no skyscrapers between them that have an i-th floor.Alice and Bob decide to count the number of skyscrapers.Alice is thorough, and wants to know exactly how many skyscrapers there are. She begins at the leftmost skyscraper, with a counter at 1. She then moves to the right, one skyscraper at a time, adding 1 to her counter each time she moves. She continues until she reaches the rightmost skyscraper.Bob is impatient, and wants to finish as fast as possible. He begins at the leftmost skyscraper, with a counter at 1. He moves from building to building using zip lines. At each stage Bob uses the highest available zip line to the right, but ignores floors with a height greater than h due to fear of heights. When Bob uses a zip line, he travels too fast to count how many skyscrapers he passed. Instead, he just adds 2i to his counter, where i is the number of the floor he\'s currently on. He continues until he reaches the rightmost skyscraper.Consider the following example. There are 6 buildings, with heights 1, 4, 3, 4, 1, 2 from left to right, and h\xe2\x80\x89=\xe2\x80\x892. Alice begins with her counter at 1 and then adds 1 five times for a result of 6. Bob begins with his counter at 1, then he adds 1, 4, 4, and 2, in order, for a result of 12. Note that Bob ignores the highest zip line because of his fear of heights (h\xe2\x80\x89=\xe2\x80\x892).  Bob\'s counter is at the top of the image, and Alice\'s counter at the bottom. All zip lines are shown. Bob\'s path is shown by the green dashed line and Alice\'s by the pink dashed line. The floors of the skyscrapers are numbered, and the zip lines Bob uses are marked with the amount he adds to his counter.When Alice and Bob reach the right-most skyscraper, they compare counters. You will be given either the value of Alice\'s counter or the value of Bob\'s counter, and must compute the expected value of the other\'s counter." 2800

335D "Rectangles and Square" "brute force,dp" "You are given n rectangles, labeled 1 through n. The corners of rectangles have integer coordinates and their edges are parallel to the Ox and Oy axes. The rectangles may touch each other, but they do not overlap (that is, there are no points that belong to the interior of more than one rectangle).Your task is to determine if there\'s a non-empty subset of the rectangles that forms a square. That is, determine if there exists a subset of the rectangles and some square for which every point that belongs to the interior or the border of that square belongs to the interior or the border of at least one of the rectangles in the subset, and every point that belongs to the interior or the border of at least one rectangle in the subset belongs to the interior or the border of that square." 2400

335C "More Reclamation" games "In a far away land, there are two cities near a river. One day, the cities decide that they have too little space and would like to reclaim some of the river area into land.The river area can be represented by a grid with r rows and exactly two columns \xe2\x80\x94 each cell represents a rectangular area. The rows are numbered 1 through r from top to bottom, while the columns are numbered 1 and 2.Initially, all of the cells are occupied by the river. The plan is to turn some of those cells into land one by one, with the cities alternately choosing a cell to reclaim, and continuing until no more cells can be reclaimed.However, the river is also used as a major trade route. The cities need to make sure that ships will still be able to sail from one end of the river to the other. More formally, if a cell (r,\xe2\x80\x89c) has been reclaimed, it is not allowed to reclaim any of the cells (r\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x893\xe2\x80\x89-\xe2\x80\x89c), (r,\xe2\x80\x893\xe2\x80\x89-\xe2\x80\x89c), or (r\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x893\xe2\x80\x89-\xe2\x80\x89c).The cities are not on friendly terms, and each city wants to be the last city to reclaim a cell (they don\'t care about how many cells they reclaim, just who reclaims a cell last). The cities have already reclaimed n cells. Your job is to determine which city will be the last to reclaim a cell, assuming both choose cells optimally from current moment." 2100

335B Palindrome "constructive algorithms,dp" "Given a string s, determine if it contains any palindrome of length exactly 100 as a subsequence. If it has any, print any one of them. If it doesn\'t have any, print a palindrome that is a subsequence of s and is as long as possible." 1900

335A Banana "binary search,constructive algorithms,greedy" "Piegirl is buying stickers for a project. Stickers come on sheets, and each sheet of stickers contains exactly n stickers. Each sticker has exactly one character printed on it, so a sheet of stickers can be described by a string of length n. Piegirl wants to create a string s using stickers. She may buy as many sheets of stickers as she wants, and may specify any string of length n for the sheets, but all the sheets must be identical, so the string is the same for all sheets. Once she attains the sheets of stickers, she will take some of the stickers from the sheets and arrange (in any order) them to form s. Determine the minimum number of sheets she has to buy, and provide a string describing a possible sheet of stickers she should buy." 1400

334B "Eight Point Sets" sortings "Gerald is very particular to eight point sets. He thinks that any decent eight point set must consist of all pairwise intersections of three distinct integer vertical straight lines and three distinct integer horizontal straight lines, except for the average of these nine points. In other words, there must be three integers x1,\xe2\x80\x89x2,\xe2\x80\x89x3 and three more integers y1,\xe2\x80\x89y2,\xe2\x80\x89y3, such that x1\xe2\x80\x89<\xe2\x80\x89x2\xe2\x80\x89<\xe2\x80\x89x3, y1\xe2\x80\x89<\xe2\x80\x89y2\xe2\x80\x89<\xe2\x80\x89y3 and the eight point set consists of all points (xi,\xe2\x80\x89yj) (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i,\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x893), except for point (x2,\xe2\x80\x89y2).You have a set of eight points. Find out if Gerald can use this set?" 1400

334A "Candy Bags" implementation "Gerald has n younger brothers and their number happens to be even. One day he bought n2 candy bags. One bag has one candy, one bag has two candies, one bag has three candies and so on. In fact, for each integer k from 1 to n2 he has exactly one bag with k candies. Help him give n bags of candies to each brother so that all brothers got the same number of candies." 1000

333E "Summer Earnings" "binary search,bitmasks,brute force,geometry,sortings" "Many schoolchildren look for a job for the summer, and one day, when Gerald was still a schoolboy, he also decided to work in the summer. But as Gerald was quite an unusual schoolboy, he found quite unusual work. A certain Company agreed to pay him a certain sum of money if he draws them three identical circles on a plane. The circles must not interfere with each other (but they may touch each other). He can choose the centers of the circles only from the n options granted by the Company. He is free to choose the radius of the circles himself (all three radiuses must be equal), but please note that the larger the radius is, the more he gets paid. Help Gerald earn as much as possible." 2500

333D "Characteristics of Rectangles" "binary search,bitmasks,brute force,implementation,sortings" "Gerald found a table consisting of n rows and m columns. As a prominent expert on rectangular tables, he immediately counted the table\'s properties, that is, the minimum of the numbers in the corners of the table (minimum of four numbers). However, he did not like the final value \xe2\x80\x94 it seemed to be too small. And to make this value larger, he decided to crop the table a little: delete some columns on the left and some on the right, as well as some rows from the top and some from the bottom. Find what the maximum property of the table can be after such cropping. Note that the table should have at least two rows and at least two columns left in the end. The number of cropped rows or columns from each of the four sides can be zero." 2100

333C "Lucky Tickets" "brute force,constructive algorithms" "Gerald has a friend, Pollard. Pollard is interested in lucky tickets (ticket is a sequence of digits). At first he thought that a ticket is lucky if between some its digits we can add arithmetic signs and brackets so that the result obtained by the arithmetic expression was number 100. But he quickly analyzed all such tickets and moved on to a more general question. Now he explores k-lucky tickets.Pollard sais that a ticket is k-lucky if we can add arithmetic operation signs between its digits to the left or right of them (i.e., ""+"", ""-"", ""\xe2\x80\x89\xc3\x97\xe2\x80\x89"") and brackets so as to obtain the correct arithmetic expression whose value would equal k. For example, ticket ""224201016"" is 1000-lucky as (\xe2\x80\x89-\xe2\x80\x892\xe2\x80\x89-\xe2\x80\x89(2\xe2\x80\x89+\xe2\x80\x894))\xe2\x80\x89\xc3\x97\xe2\x80\x89(2\xe2\x80\x89+\xe2\x80\x890)\xe2\x80\x89+\xe2\x80\x891016\xe2\x80\x89=\xe2\x80\x891000.Pollard was so carried away by the lucky tickets that he signed up for a seminar on lucky tickets and, as far as Gerald knows, Pollard will attend it daily at 7 pm in some famous institute and will commute to it in the same tram for m days. In this tram tickets have eight digits. And Gerald wants to make a surprise for Pollard: each day Pollard will receive a tram k-lucky ticket. The conductor has already agreed to give Pollard certain tickets during all these m days and he only wants Gerald to tell him what kind of tickets to give out. In this regard, help Gerald pick exactly m distinct k-lucky tickets." 2700

333B Chips greedy "Gerald plays the following game. He has a checkered field of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89n cells, where m various cells are banned. Before the game, he has to put a few chips on some border (but not corner) board cells. Then for n\xe2\x80\x89-\xe2\x80\x891 minutes, Gerald every minute moves each chip into an adjacent cell. He moves each chip from its original edge to the opposite edge. Gerald loses in this game in each of the three cases:  At least one of the chips at least once fell to the banned cell.  At least once two chips were on the same cell.  At least once two chips swapped in a minute (for example, if you stand two chips on two opposite border cells of a row with even length, this situation happens in the middle of the row). In that case he loses and earns 0 points. When nothing like that happened, he wins and earns the number of points equal to the number of chips he managed to put on the board. Help Gerald earn the most points." 1800

333A Secrets greedy "Gerald has been selling state secrets at leisure. All the secrets cost the same: n marks. The state which secrets Gerald is selling, has no paper money, only coins. But there are coins of all positive integer denominations that are powers of three: 1 mark, 3 marks, 9 marks, 27 marks and so on. There are no coins of other denominations. Of course, Gerald likes it when he gets money without the change. And all buyers respect him and try to give the desired sum without change, if possible. But this does not always happen.One day an unlucky buyer came. He did not have the desired sum without change. Then he took out all his coins and tried to give Gerald a larger than necessary sum with as few coins as possible. What is the maximum number of coins he could get?The formal explanation of the previous paragraph: we consider all the possible combinations of coins for which the buyer can not give Gerald the sum of n marks without change. For each such combination calculate the minimum number of coins that can bring the buyer at least n marks. Among all combinations choose the maximum of the minimum number of coins. This is the number we want." 1600

332E "Binary Key" dp,greedy,implementation "Let\'s assume that p and q are strings of positive length, called the container and the key correspondingly, string q only consists of characters 0 and 1. Let\'s take a look at a simple algorithm that extracts message s from the given container p:i = 0;j = 0;s = <>;while i is less than the length of the string p{    if q[j] == 1, then add to the right of string s character p[i];    increase variables i, j by one;    if the value of the variable j equals the length of the string q, then j = 0; }In the given pseudocode i, j are integer variables, s is a string, \'=\' is an assignment operator, \'==\' is a comparison operation, \'[]\' is the operation of obtaining the string character with the preset index, \'<>\' is an empty string. We suppose that in all strings the characters are numbered starting from zero. We understand that implementing such algorithm is quite easy, so your task is going to be slightly different. You need to construct the lexicographically minimum key of length k, such that when it is used, the algorithm given above extracts message s from container p (otherwise find out that such key doesn\'t exist)." 2400

332D "Theft of Blueprints" graphs,math "Insurgents accidentally got hold of the plan of a top secret research polygon created on a distant planet for the needs of the Galaxy Empire. The insurgents suppose that this polygon is developing new deadly weapon. The polygon consists of n missile silos connected by bidirectional underground passages. The passages are linked to laboratories where research is conducted. Naturally, the passages are guarded severely: the passage between silos i and j is patrolled by ci,\xe2\x80\x89j war droids.The insurgents studied the polygon plan and noticed its unusual structure. As it turned out, for any k-element set of silos S there is exactly one silo that is directly connected by a passage with each silo from S (we\'ll call this silo adjacent with S). Having considered that, the insurgents decided to act as follows:  they choose a k-element set of silos S;  a group of scouts lands from the air into each silo from S;  each group moves along the corresponding passage to the silo, adjacent with S (as the scouts move, they check out the laboratories and watch for any signs of weapon blueprints);  in the silo, adjacent with S, the groups get on the ship and fly away. The danger of the operation is the total number of droids that patrol the passages through which the scouts will go. The danger of the operation obviously only depends on the way to choose set S. The insurgents haven\'t yet decided on the exact silos to send the scouts to. However, they already want to start preparing the weapons for the scout groups. To do that, the insurgents need to know the mathematical average of the dangers of the operations that correspond to all possible ways to choose set S. Solve this problem to help the insurgents protect the ideals of the Republic!" 2400

332C "Students\' Revenge" "data structures,greedy,sortings" "Insurgents accidentally got hold of the plan of a top secret research polygon created on a distant planet for the needs of the Galaxy Empire. The insurgents suppose that this polygon is developing new deadly weapon. The polygon consists of n missile silos connected by bidirectional underground passages. The passages are linked to laboratories where research is conducted. Naturally, the passages are guarded severely: the passage between silos i and j is patrolled by ci,\xe2\x80\x89j war droids.The insurgents studied the polygon plan and noticed its unusual structure. As it turned out, for any k-element set of silos S there is exactly one silo that is directly connected by a passage with each silo from S (we\'ll call this silo adjacent with S). Having considered that, the insurgents decided to act as follows:  they choose a k-element set of silos S;  a group of scouts lands from the air into each silo from S;  each group moves along the corresponding passage to the silo, adjacent with S (as the scouts move, they check out the laboratories and watch for any signs of weapon blueprints);  in the silo, adjacent with S, the groups get on the ship and fly away. The danger of the operation is the total number of droids that patrol the passages through which the scouts will go. The danger of the operation obviously only depends on the way to choose set S. The insurgents haven\'t yet decided on the exact silos to send the scouts to. However, they already want to start preparing the weapons for the scout groups. To do that, the insurgents need to know the mathematical average of the dangers of the operations that correspond to all possible ways to choose set S. Solve this problem to help the insurgents protect the ideals of the Republic!" 2200

332B "Maximum Absurdity" "data structures,dp,implementation" "Reforms continue entering Berland. For example, during yesterday sitting the Berland Parliament approved as much as n laws (each law has been assigned a unique number from 1 to n). Today all these laws were put on the table of the President of Berland, G.W. Boosch, to be signed.This time mr. Boosch plans to sign 2k laws. He decided to choose exactly two non-intersecting segments of integers from 1 to n of length k and sign all laws, whose numbers fall into these segments. More formally, mr. Boosch is going to choose two integers a, b (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x89k\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89b\xe2\x80\x89-\xe2\x80\x89a\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89k) and sign all laws with numbers lying in the segments [a;�a\xe2\x80\x89+\xe2\x80\x89k\xe2\x80\x89-\xe2\x80\x891] and [b;�b\xe2\x80\x89+\xe2\x80\x89k\xe2\x80\x89-\xe2\x80\x891] (borders are included).As mr. Boosch chooses the laws to sign, he of course considers the public opinion. Allberland Public Opinion Study Centre (APOSC) conducted opinion polls among the citizens, processed the results into a report and gave it to the president. The report contains the absurdity value for each law, in the public opinion. As mr. Boosch is a real patriot, he is keen on signing the laws with the maximum total absurdity. Help him." 1500

332A "Down the Hatch!" implementation "Everybody knows that the Berland citizens are keen on health, especially students. Berland students are so tough that all they drink is orange juice!Yesterday one student, Vasya and his mates made some barbecue and they drank this healthy drink only. After they ran out of the first barrel of juice, they decided to play a simple game. All n people who came to the barbecue sat in a circle (thus each person received a unique index bi from 0 to n\xe2\x80\x89-\xe2\x80\x891). The person number 0 started the game (this time it was Vasya). All turns in the game were numbered by integers starting from 1. If the j-th turn was made by the person with index bi, then this person acted like that:  he pointed at the person with index (bi\xe2\x80\x89+\xe2\x80\x891)�mod�n either with an elbow or with a nod (x�mod�y is the remainder after dividing x by y);  if j\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x894 and the players who had turns number j\xe2\x80\x89-\xe2\x80\x891, j\xe2\x80\x89-\xe2\x80\x892, j\xe2\x80\x89-\xe2\x80\x893, made during their turns the same moves as player bi on the current turn, then he had drunk a glass of juice;  the turn went to person number (bi\xe2\x80\x89+\xe2\x80\x891)�mod�n. The person who was pointed on the last turn did not make any actions.The problem was, Vasya\'s drunk too much juice and can\'t remember the goal of the game. However, Vasya\'s got the recorded sequence of all the participants\' actions (including himself). Now Vasya wants to find out the maximum amount of juice he could drink if he played optimally well (the other players\' actions do not change). Help him.You can assume that in any scenario, there is enough juice for everybody." 1300

331E2 "Deja Vu" "constructive algorithms,dp" "Everybody knows that we have been living in the Matrix for a long time. And in the new seventh Matrix the world is ruled by beavers.So let\'s take beaver Neo. Neo has so-called ""deja vu"" outbursts when he gets visions of events in some places he\'s been at or is going to be at. Let\'s examine the phenomenon in more detail.We can say that Neo\'s city is represented by a directed graph, consisting of n shops and m streets that connect the shops. No two streets connect the same pair of shops (besides, there can\'t be one street from A to B and one street from B to A). No street connects a shop with itself. As Neo passes some streets, he gets visions. No matter how many times he passes street k, every time he will get the same visions in the same order. A vision is a sequence of shops.We know that Neo is going to get really shocked if he passes the way from some shop a to some shop b, possible coinciding with a, such that the list of visited shops in the real life and in the visions coincide.Suggest beaver Neo such path of non-zero length. Or maybe you can even count the number of such paths modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)?.." 3100

331E1 "Deja Vu" "constructive algorithms,graphs,implementation" "Everybody knows that we have been living in the Matrix for a long time. And in the new seventh Matrix the world is ruled by beavers.So let\'s take beaver Neo. Neo has so-called ""deja vu"" outbursts when he gets visions of events in some places he\'s been at or is going to be at. Let\'s examine the phenomenon in more detail.We can say that Neo\'s city is represented by a directed graph, consisting of n shops and m streets that connect the shops. No two streets connect the same pair of shops (besides, there can\'t be one street from A to B and one street from B to A). No street connects a shop with itself. As Neo passes some streets, he gets visions. No matter how many times he passes street k, every time he will get the same visions in the same order. A vision is a sequence of shops.We know that Neo is going to get really shocked if he passes the way from some shop a to some shop b, possible coinciding with a, such that the list of visited shops in the real life and in the visions coincide.Suggest beaver Neo such path of non-zero length. Or maybe you can even count the number of such paths modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)?.." 2900

331D3 "Escaping on Beaveractor" "data structures,implementation,trees" "Don\'t put up with what you\'re sick of! The Smart Beaver decided to escape from the campus of Beaver Science Academy (BSA). BSA is a b\xe2\x80\x89\xc3\x97\xe2\x80\x89b square on a plane. Each point x,\xe2\x80\x89y (0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x,\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b) belongs to BSA. To make the path quick and funny, the Beaver constructed a Beaveractor, an effective and comfortable types of transport.The campus obeys traffic rules: there are n arrows, parallel to the coordinate axes. The arrows do not intersect and do not touch each other. When the Beaveractor reaches some arrow, it turns in the arrow\'s direction and moves on until it either reaches the next arrow or gets outside the campus. The Beaveractor covers exactly one unit of space per one unit of time. You can assume that there are no obstacles to the Beaveractor.The BSA scientists want to transport the brand new Beaveractor to the ""Academic Tractor"" research institute and send the Smart Beaver to do his postgraduate studies and sharpen pencils. They have q plans, representing the Beaveractor\'s initial position (xi,\xe2\x80\x89yi), the initial motion vector wi and the time ti that have passed after the escape started.Your task is for each of the q plans to determine the Smart Beaver\'s position after the given time." 3000

331D2 "Escaping on Beaveractor" graphs "Don\'t put up with what you\'re sick of! The Smart Beaver decided to escape from the campus of Beaver Science Academy (BSA). BSA is a b\xe2\x80\x89\xc3\x97\xe2\x80\x89b square on a plane. Each point x,\xe2\x80\x89y (0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x,\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b) belongs to BSA. To make the path quick and funny, the Beaver constructed a Beaveractor, an effective and comfortable types of transport.The campus obeys traffic rules: there are n arrows, parallel to the coordinate axes. The arrows do not intersect and do not touch each other. When the Beaveractor reaches some arrow, it turns in the arrow\'s direction and moves on until it either reaches the next arrow or gets outside the campus. The Beaveractor covers exactly one unit of space per one unit of time. You can assume that there are no obstacles to the Beaveractor.The BSA scientists want to transport the brand new Beaveractor to the ""Academic Tractor"" research institute and send the Smart Beaver to do his postgraduate studies and sharpen pencils. They have q plans, representing the Beaveractor\'s initial position (xi,\xe2\x80\x89yi), the initial motion vector wi and the time ti that have passed after the escape started.Your task is for each of the q plans to determine the Smart Beaver\'s position after the given time." 2600

331D1 "Escaping on Beaveractor" "dfs and similar,implementation" "Don\'t put up with what you\'re sick of! The Smart Beaver decided to escape from the campus of Beaver Science Academy (BSA). BSA is a b\xe2\x80\x89\xc3\x97\xe2\x80\x89b square on a plane. Each point x,\xe2\x80\x89y (0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x,\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b) belongs to BSA. To make the path quick and funny, the Beaver constructed a Beaveractor, an effective and comfortable types of transport.The campus obeys traffic rules: there are n arrows, parallel to the coordinate axes. The arrows do not intersect and do not touch each other. When the Beaveractor reaches some arrow, it turns in the arrow\'s direction and moves on until it either reaches the next arrow or gets outside the campus. The Beaveractor covers exactly one unit of space per one unit of time. You can assume that there are no obstacles to the Beaveractor.The BSA scientists want to transport the brand new Beaveractor to the ""Academic Tractor"" research institute and send the Smart Beaver to do his postgraduate studies and sharpen pencils. They have q plans, representing the Beaveractor\'s initial position (xi,\xe2\x80\x89yi), the initial motion vector wi and the time ti that have passed after the escape started.Your task is for each of the q plans to determine the Smart Beaver\'s position after the given time." 2400

331C3 "The Great Julya Calendar" dp "Yet another Armageddon is coming! This time the culprit is the Julya tribe calendar. The beavers in this tribe knew math very well. Smart Beaver, an archaeologist, got a sacred plate with a magic integer on it. The translation from Old Beaverish is as follows: ""May the Great Beaver bless you! May your chacres open and may your third eye never turn blind from beholding the Truth! Take the magic number, subtract a digit from it (the digit must occur in the number) and get a new magic number. Repeat this operation until a magic number equals zero. The Earth will stand on Three Beavers for the time, equal to the number of subtractions you perform!""Distinct subtraction sequences can obviously get you different number of operations. But the Smart Beaver is ready to face the worst and is asking you to count the minimum number of operations he needs to reduce the magic number to zero." 2500

331C2 "The Great Julya Calendar" dp "Yet another Armageddon is coming! This time the culprit is the Julya tribe calendar. The beavers in this tribe knew math very well. Smart Beaver, an archaeologist, got a sacred plate with a magic integer on it. The translation from Old Beaverish is as follows: ""May the Great Beaver bless you! May your chacres open and may your third eye never turn blind from beholding the Truth! Take the magic number, subtract a digit from it (the digit must occur in the number) and get a new magic number. Repeat this operation until a magic number equals zero. The Earth will stand on Three Beavers for the time, equal to the number of subtractions you perform!""Distinct subtraction sequences can obviously get you different number of operations. But the Smart Beaver is ready to face the worst and is asking you to count the minimum number of operations he needs to reduce the magic number to zero." 2400

331C1 "The Great Julya Calendar" dp "Yet another Armageddon is coming! This time the culprit is the Julya tribe calendar. The beavers in this tribe knew math very well. Smart Beaver, an archaeologist, got a sacred plate with a magic integer on it. The translation from Old Beaverish is as follows: ""May the Great Beaver bless you! May your chacres open and may your third eye never turn blind from beholding the Truth! Take the magic number, subtract a digit from it (the digit must occur in the number) and get a new magic number. Repeat this operation until a magic number equals zero. The Earth will stand on Three Beavers for the time, equal to the number of subtractions you perform!""Distinct subtraction sequences can obviously get you different number of operations. But the Smart Beaver is ready to face the worst and is asking you to count the minimum number of operations he needs to reduce the magic number to zero." 1100

331B2 "Shave Beaver!" "data structures" "The Smart Beaver has recently designed and built an innovative nanotechnologic all-purpose beaver mass shaving machine, ""Beavershave 5000"". Beavershave 5000 can shave beavers by families! How does it work? Very easily!There are n beavers, each of them has a unique id from 1 to n. Consider a permutation a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an of n these beavers. Beavershave 5000 needs one session to shave beavers with ids from x to y (inclusive) if and only if there are such indices i1\xe2\x80\x89<\xe2\x80\x89i2\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89ik, that ai1\xe2\x80\x89=\xe2\x80\x89x, ai2\xe2\x80\x89=\xe2\x80\x89x\xe2\x80\x89+\xe2\x80\x891, ..., aik\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89=\xe2\x80\x89y\xe2\x80\x89-\xe2\x80\x891, aik\xe2\x80\x89=\xe2\x80\x89y. And that is really convenient. For example, it needs one session to shave a permutation of beavers 1,\xe2\x80\x892,\xe2\x80\x893,\xe2\x80\x89...,\xe2\x80\x89n.If we can\'t shave beavers from x to y in one session, then we can split these beavers into groups [x,\xe2\x80\x89p1], [p1\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89p2], ..., [pm\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89y] (x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89p1\xe2\x80\x89<\xe2\x80\x89p2\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89pm\xe2\x80\x89<\xe2\x80\x89y), in such a way that the machine can shave beavers in each group in one session. But then Beavershave 5000 needs m\xe2\x80\x89+\xe2\x80\x891 working sessions to shave beavers from x to y.All beavers are restless and they keep trying to swap. So if we consider the problem more formally, we can consider queries of two types:   what is the minimum number of sessions that Beavershave 5000 needs to shave beavers with ids from x to y, inclusive?  two beavers on positions x and y (the beavers ax and ay) swapped. You can assume that any beaver can be shaved any number of times." 1900

331B1 "Shave Beaver!" implementation "The Smart Beaver has recently designed and built an innovative nanotechnologic all-purpose beaver mass shaving machine, ""Beavershave 5000"". Beavershave 5000 can shave beavers by families! How does it work? Very easily!There are n beavers, each of them has a unique id from 1 to n. Consider a permutation a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an of n these beavers. Beavershave 5000 needs one session to shave beavers with ids from x to y (inclusive) if and only if there are such indices i1\xe2\x80\x89<\xe2\x80\x89i2\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89ik, that ai1\xe2\x80\x89=\xe2\x80\x89x, ai2\xe2\x80\x89=\xe2\x80\x89x\xe2\x80\x89+\xe2\x80\x891, ..., aik\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89=\xe2\x80\x89y\xe2\x80\x89-\xe2\x80\x891, aik\xe2\x80\x89=\xe2\x80\x89y. And that is really convenient. For example, it needs one session to shave a permutation of beavers 1,\xe2\x80\x892,\xe2\x80\x893,\xe2\x80\x89...,\xe2\x80\x89n.If we can\'t shave beavers from x to y in one session, then we can split these beavers into groups [x,\xe2\x80\x89p1], [p1\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89p2], ..., [pm\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89y] (x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89p1\xe2\x80\x89<\xe2\x80\x89p2\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89pm\xe2\x80\x89<\xe2\x80\x89y), in such a way that the machine can shave beavers in each group in one session. But then Beavershave 5000 needs m\xe2\x80\x89+\xe2\x80\x891 working sessions to shave beavers from x to y.All beavers are restless and they keep trying to swap. So if we consider the problem more formally, we can consider queries of two types:   what is the minimum number of sessions that Beavershave 5000 needs to shave beavers with ids from x to y, inclusive?  two beavers on positions x and y (the beavers ax and ay) swapped. You can assume that any beaver can be shaved any number of times." 1700

331A2 "Oh Sweet Beaverette" "data structures,sortings" "\xe2\x80\x94 Oh my sweet Beaverette, would you fancy a walk along a wonderful woodland belt with me?   \xe2\x80\x94 Of course, my Smart Beaver! Let us enjoy the splendid view together. How about Friday night? At this point the Smart Beaver got rushing. Everything should be perfect by Friday, so he needed to prepare the belt to the upcoming walk. He needed to cut down several trees.Let\'s consider the woodland belt as a sequence of trees. Each tree i is described by the esthetic appeal ai \xe2\x80\x94 some trees are very esthetically pleasing, others are \'so-so\', and some trees are positively ugly!The Smart Beaver calculated that he needed the following effects to win the Beaverette\'s heart:   The first objective is to please the Beaverette: the sum of esthetic appeal of the remaining trees must be maximum possible;  the second objective is to surprise the Beaverette: the esthetic appeal of the first and the last trees in the resulting belt must be the same;  and of course, the walk should be successful: there must be at least two trees in the woodland belt left. Now help the Smart Beaver! Which trees does he need to cut down to win the Beaverette\'s heart?" 1500

331A1 "Oh Sweet Beaverette" "brute force,implementation" "\xe2\x80\x94 Oh my sweet Beaverette, would you fancy a walk along a wonderful woodland belt with me?   \xe2\x80\x94 Of course, my Smart Beaver! Let us enjoy the splendid view together. How about Friday night? At this point the Smart Beaver got rushing. Everything should be perfect by Friday, so he needed to prepare the belt to the upcoming walk. He needed to cut down several trees.Let\'s consider the woodland belt as a sequence of trees. Each tree i is described by the esthetic appeal ai \xe2\x80\x94 some trees are very esthetically pleasing, others are \'so-so\', and some trees are positively ugly!The Smart Beaver calculated that he needed the following effects to win the Beaverette\'s heart:   The first objective is to please the Beaverette: the sum of esthetic appeal of the remaining trees must be maximum possible;  the second objective is to surprise the Beaverette: the esthetic appeal of the first and the last trees in the resulting belt must be the same;  and of course, the walk should be successful: there must be at least two trees in the woodland belt left. Now help the Smart Beaver! Which trees does he need to cut down to win the Beaverette\'s heart?" 1400

330B "Road Construction" "constructive algorithms,graphs" "A country has n cities. Initially, there is no road in the country. One day, the king decides to construct some roads connecting pairs of cities. Roads can be traversed either way. He wants those roads to be constructed in such a way that it is possible to go from each city to any other city by traversing at most two roads. You are also given m pairs of cities \xe2\x80\x94 roads cannot be constructed between these pairs of cities.Your task is to construct the minimum number of roads that still satisfy the above conditions. The constraints will guarantee that this is always possible." 1300

330A Cakeminator "brute force,implementation" "You are given a rectangular cake, represented as an r\xe2\x80\x89\xc3\x97\xe2\x80\x89c grid. Each cell either has an evil strawberry, or is empty. For example, a 3\xe2\x80\x89\xc3\x97\xe2\x80\x894 cake may look as follows:  The cakeminator is going to eat the cake! Each time he eats, he chooses a row or a column that does not contain any evil strawberries and contains at least one cake cell that has not been eaten before, and eats all the cake cells there. He may decide to eat any number of times.Please output the maximum number of cake cells that the cakeminator can eat." 800

329E Evil math "There are n cities on a two dimensional Cartesian plane. The distance between two cities is equal to the Manhattan distance between them (see the Notes for definition). A Hamiltonian cycle of the cities is defined as a permutation of all n cities. The length of this Hamiltonian cycle is defined as the sum of the distances between adjacent cities in the permutation plus the distance between the first and final city in the permutation. Please compute the longest possible length of a Hamiltonian cycle of the given cities." 3100

329D "The Evil Temple and the Moving Rocks" "constructive algorithms" "Important: All possible tests are in the pretest, so you shouldn\'t hack on this problem. So, if you passed pretests, you will also pass the system test.You are an adventurer currently journeying inside an evil temple. After defeating a couple of weak monsters, you arrived at a square room consisting of tiles forming an n\xe2\x80\x89\xc3\x97\xe2\x80\x89n grid, surrounded entirely by walls. At the end of the room lies a door locked with evil magical forces. The following inscriptions are written on the door: The sound of clashing rocks will awaken the door! Being a very senior adventurer, you immediately realize what this means. In the room next door lies an infinite number of magical rocks. There are four types of rocks:   \'^\': this rock moves upwards;  \'<\': this rock moves leftwards;  \'>\': this rock moves rightwards;  \'v\': this rock moves downwards. To open the door, you first need to place the rocks on some of the tiles (one tile can be occupied by at most one rock). Then, you select a single rock that you have placed and activate it. The activated rock will then move in its direction until it hits another rock or hits the walls of the room (the rock will not move if something already blocks it in its chosen direction). The rock then deactivates. If it hits the walls, or if there have been already 107 events of rock becoming activated, the movements end. Otherwise, the rock that was hit becomes activated and this procedure is repeated.If a rock moves at least one cell before hitting either the wall or another rock, the hit produces a sound. The door will open once the number of produced sounds is at least x. It is okay for the rocks to continue moving after producing x sounds.The following picture illustrates the four possible scenarios of moving rocks. Moves at least one cell, then hits another rock. A sound is produced, the hit rock becomes activated.   Moves at least one cell, then hits the wall (i.e., the side of the room). A sound is produced, the movements end.   Does not move because a rock is already standing in the path. The blocking rock becomes activated, but no sounds are produced.   Does not move because the wall is in the way. No sounds are produced and the movements end.  Assume there\'s an infinite number of rocks of each type in the neighboring room. You know what to do: place the rocks and open the door!" 2500

329C "Graph Reconstruction" "constructive algorithms" "I have an undirected graph consisting of n nodes, numbered 1 through n. Each node has at most two incident edges. For each pair of nodes, there is at most an edge connecting them. No edge connects a node to itself.I would like to create a new graph in such a way that:   The new graph consists of the same number of nodes and edges as the old graph.  The properties in the first paragraph still hold.  For each two nodes u and v, if there is an edge connecting them in the old graph, there is no edge connecting them in the new graph. Help me construct the new graph, or tell me if it is impossible." 2400

329B "Biridian Forest" "dfs and similar,shortest paths" "You\'re a mikemon breeder currently in the middle of your journey to become a mikemon master. Your current obstacle is go through the infamous Biridian Forest.The forestThe Biridian Forest is a two-dimensional grid consisting of r rows and c columns. Each cell in Biridian Forest may contain a tree, or may be vacant. A vacant cell may be occupied by zero or more mikemon breeders (there may also be breeders other than you in the forest). Mikemon breeders (including you) cannot enter cells with trees. One of the cells is designated as the exit cell.The initial grid, including your initial position, the exit cell, and the initial positions of all other breeders, will be given to you. Here\'s an example of such grid (from the first example):  MovesBreeders (including you) may move in the forest. In a single move, breeders may perform one of the following actions:   Do nothing.  Move from the current cell to one of the four adjacent cells (two cells are adjacent if they share a side). Note that breeders cannot enter cells with trees.  If you are located on the exit cell, you may leave the forest. Only you can perform this move \xe2\x80\x94 all other mikemon breeders will never leave the forest by using this type of movement. After each time you make a single move, each of the other breeders simultaneously make a single move (the choice of which move to make may be different for each of the breeders).Mikemon battleIf you and t (t\xe2\x80\x89>\xe2\x80\x890) mikemon breeders are located on the same cell, exactly t mikemon battles will ensue that time (since you will be battling each of those t breeders once). After the battle, all of those t breeders will leave the forest to heal their respective mikemons.Note that the moment you leave the forest, no more mikemon battles can ensue, even if another mikemon breeder move to the exit cell immediately after that. Also note that a battle only happens between you and another breeders \xe2\x80\x94 there will be no battle between two other breeders (there may be multiple breeders coexisting in a single cell).Your goalYou would like to leave the forest. In order to do so, you have to make a sequence of moves, ending with a move of the final type. Before you make any move, however, you post this sequence on your personal virtual idol Blog. Then, you will follow this sequence of moves faithfully.Goal of other breedersBecause you post the sequence in your Blog, the other breeders will all know your exact sequence of moves even before you make your first move. All of them will move in such way that will guarantee a mikemon battle with you, if possible. The breeders that couldn\'t battle you will do nothing.Your taskPrint the minimum number of mikemon battles that you must participate in, assuming that you pick the sequence of moves that minimize this number. Note that you are not required to minimize the number of moves you make." 1500

329A Purification "constructive algorithms,greedy" "You are an adventurer currently journeying inside an evil temple. After defeating a couple of weak zombies, you arrived at a square room consisting of tiles forming an n\xe2\x80\x89\xc3\x97\xe2\x80\x89n grid. The rows are numbered 1 through n from top to bottom, and the columns are numbered 1 through n from left to right. At the far side of the room lies a door locked with evil magical forces. The following inscriptions are written on the door: The cleaning of all evil will awaken the door! Being a very senior adventurer, you immediately realize what this means. You notice that every single cell in the grid are initially evil. You should purify all of these cells.The only method of tile purification known to you is by casting the ""Purification"" spell. You cast this spell on a single tile \xe2\x80\x94 then, all cells that are located in the same row and all cells that are located in the same column as the selected tile become purified (including the selected tile)! It is allowed to purify a cell more than once.You would like to purify all n\xe2\x80\x89\xc3\x97\xe2\x80\x89n cells while minimizing the number of times you cast the ""Purification"" spell. This sounds very easy, but you just noticed that some tiles are particularly more evil than the other tiles. You cannot cast the ""Purification"" spell on those particularly more evil tiles, not even after they have been purified. They can still be purified if a cell sharing the same row or the same column gets selected by the ""Purification"" spell.Please find some way to purify all the cells with the minimum number of spells cast. Print -1 if there is no such way." 1500

328B "Sheldon and Ice Pieces" greedy "Do you remember how Kai constructed the word ""eternity"" using pieces of ice as components?Little Sheldon plays with pieces of ice, each piece has exactly one digit between 0 and 9. He wants to construct his favourite number t. He realized that digits 6 and 9 are very similar, so he can rotate piece of ice with 6 to use as 9 (and vice versa). Similary, 2 and 5 work the same. There is no other pair of digits with similar effect. He called this effect ""Digital Mimicry"".Sheldon favourite number is t. He wants to have as many instances of t as possible. How many instances he can construct using the given sequence of ice pieces. He can use any piece at most once." 1500

328A "IQ Test" implementation "Petya is preparing for IQ test and he has noticed that there many problems like: you are given a sequence, find the next number. Now Petya can solve only problems with arithmetic or geometric progressions.Arithmetic progression is a sequence a1, a1\xe2\x80\x89+\xe2\x80\x89d, a1\xe2\x80\x89+\xe2\x80\x892d, ..., a1\xe2\x80\x89+\xe2\x80\x89(n\xe2\x80\x89-\xe2\x80\x891)d, where a1 and d are any numbers.Geometric progression is a sequence b1, b2\xe2\x80\x89=\xe2\x80\x89b1q, ..., bn\xe2\x80\x89=\xe2\x80\x89bn\xe2\x80\x89-\xe2\x80\x891q, where b1\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x890, q\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x890, q\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x891. Help Petya and write a program to determine if the given sequence is arithmetic or geometric. Also it should found the next number. If the sequence is neither arithmetic nor geometric, print 42 (he thinks it is impossible to find better answer). You should also print 42 if the next element of progression is not integer. So answer is always integer." 1800

327E "Axis Walking" "bitmasks,combinatorics,constructive algorithms,dp,meet-in-the-middle" "Iahub wants to meet his girlfriend Iahubina. They both live in Ox axis (the horizontal axis). Iahub lives at point 0 and Iahubina at point d.Iahub has n positive integers a1, a2, ..., an. The sum of those numbers is d. Suppose p1, p2, ..., pn is a permutation of {1,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89n}. Then, let b1\xe2\x80\x89=\xe2\x80\x89ap1, b2\xe2\x80\x89=\xe2\x80\x89ap2 and so on. The array b is called a ""route"". There are n! different routes, one for each permutation p.Iahub\'s travel schedule is: he walks b1 steps on Ox axis, then he makes a break in point b1. Then, he walks b2 more steps on Ox axis and makes a break in point b1\xe2\x80\x89+\xe2\x80\x89b2. Similarly, at j-th (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) time he walks bj more steps on Ox axis and makes a break in point b1\xe2\x80\x89+\xe2\x80\x89b2\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89bj.Iahub is very superstitious and has k integers which give him bad luck. He calls a route ""good"" if he never makes a break in a point corresponding to one of those k numbers. For his own curiosity, answer how many good routes he can make, modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." 2300

327D "Block Tower" "constructive algorithms,dfs and similar,graphs" "After too much playing on paper, Iahub has switched to computer games. The game he plays is called ""Block Towers"". It is played in a rectangular grid with n rows and m columns (it contains n\xe2\x80\x89\xc3\x97\xe2\x80\x89m cells). The goal of the game is to build your own city. Some cells in the grid are big holes, where Iahub can\'t build any building. The rest of cells are empty. In some empty cell Iahub can build exactly one tower of two following types:  Blue towers. Each has population limit equal to 100.  Red towers. Each has population limit equal to 200. However, it can be built in some cell only if in that moment at least one of the neighbouring cells has a Blue Tower. Two cells are neighbours is they share a side. Iahub is also allowed to destroy a building from any cell. He can do this operation as much as he wants. After destroying a building, the other buildings are not influenced, and the destroyed cell becomes empty (so Iahub can build a tower in this cell if needed, see the second example for such a case).Iahub can convince as many population as he wants to come into his city. So he needs to configure his city to allow maximum population possible. Therefore he should find a sequence of operations that builds the city in an optimal way, so that total population limit is as large as possible.He says he\'s the best at this game, but he doesn\'t have the optimal solution. Write a program that calculates the optimal one, to show him that he\'s not as good as he thinks." 1900

327C "Magic Five" combinatorics,math "There is a long plate s containing n digits. Iahub wants to delete some digits (possibly none, but he is not allowed to delete all the digits) to form his ""magic number"" on the plate, a number that is divisible by 5. Note that, the resulting number may contain leading zeros.Now Iahub wants to count the number of ways he can obtain magic number, modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897). Two ways are different, if the set of deleted positions in s differs.Look at the input part of the statement, s is given in a special form." 1700

327B "Hungry Sequence" math "Iahub and Iahubina went to a date at a luxury restaurant. Everything went fine until paying for the food. Instead of money, the waiter wants Iahub to write a Hungry sequence consisting of n integers. A sequence a1, a2, ..., an, consisting of n integers, is Hungry if and only if:   Its elements are in increasing order. That is an inequality ai\xe2\x80\x89<\xe2\x80\x89aj holds for any two indices i,\xe2\x80\x89j (i\xe2\x80\x89<\xe2\x80\x89j).  For any two indices i and j (i\xe2\x80\x89<\xe2\x80\x89j), aj must not be divisible by ai. Iahub is in trouble, so he asks you for help. Find a Hungry sequence with n elements." 1200

327A "Flipping Game" "brute force,dp,implementation" "Iahub got bored, so he invented a game to be played on paper. He writes n integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. Each of those integers can be either 0 or 1. He\'s allowed to do exactly one move: he chooses two indices i and j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) and flips all values ak for which their positions are in range [i,\xe2\x80\x89j] (that is i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j). Flip the value of x means to apply operation x\xe2\x80\x89=\xe2\x80\x891 - x.The goal of the game is that after exactly one move to obtain the maximum number of ones. Write a program to solve the little game of Iahub." 1200

325E "The Red Button" "combinatorics,dfs and similar,dsu,graphs,greedy" "Piegirl found the red button. You have one last chance to change the inevitable end.The circuit under the button consists of n nodes, numbered from 0 to n - 1. In order to deactivate the button, the n nodes must be disarmed in a particular order. Node 0 must be disarmed first. After disarming node i, the next node to be disarmed must be either node (2\xc2\xb7i) modulo n or node (2\xc2\xb7i)\xe2\x80\x89+\xe2\x80\x891 modulo n. The last node to be disarmed must be node 0. Node 0 must be disarmed twice, but all other nodes must be disarmed exactly once. Your task is to find any such order and print it. If there is no such order, print -1." 2800

325D Reclamation dsu "In a far away land, there exists a planet shaped like a cylinder. There are three regions in this planet: top, bottom, and side as shown in the following picture.  Both the top and the bottom areas consist of big cities. The side area consists entirely of the sea.One day, a city decides that it has too little space and would like to reclamate some of the side area into land. The side area can be represented by a grid with r rows and c columns \xe2\x80\x94 each cell represents a rectangular area in the side area. The rows are numbered 1 through r from top to bottom, while the columns are numbered 1 through c from left to right. Two cells are adjacent if they share a side. In addition, two cells located on the same row \xe2\x80\x94 one in the leftmost column, and the other in the rightmost column \xe2\x80\x94 are also adjacent.Initially, all of the cells are occupied by the sea. The plan is to turn some of those cells into land one by one in a particular order that will be given to you.However, the sea on the side area is also used as a major trade route. More formally, it is not allowed to reclamate the sea cells into land in such way that there does not exist a sequence of cells with the following property:  All cells in the sequence are occupied by the sea (i.e., they are not reclamated).  The first cell in the sequence is in the top row.  The last cell in the sequence is in the bottom row.  Consecutive cells in the sequence are adjacent. Thus, the plan is revised. Each time a cell is going to be turned from sea to land, the city first needs to check whether or not it would violate the above condition by doing that. If it would, then the cell is not turned into land and the plan proceeds into the next cell. Otherwise, the cell is turned into land.Your job is to simulate this and output the number of cells that were successfully turned into land." 2900

325C "Monsters and Diamonds" "dfs and similar,graphs,shortest paths" "Piegirl has found a monster and a book about monsters and pies. When she is reading the book, she found out that there are n types of monsters, each with an ID between 1 and n. If you feed a pie to a monster, the monster will split into some number of monsters (possibly zero), and at least one colorful diamond. Monsters may be able to split in multiple ways.At the begining Piegirl has exactly one monster. She begins by feeding the monster a pie. She continues feeding pies to monsters until no more monsters are left. Then she collects all the diamonds that were created.You will be given a list of split rules describing the way in which the various monsters can split. Every monster can split in at least one way, and if a monster can split in multiple ways then each time when it splits Piegirl can choose the way it splits.For each monster, determine the smallest and the largest number of diamonds Piegirl can possibly collect, if initially she has a single instance of that monster. Piegirl has an unlimited supply of pies." 2600

325B "Stadium and Games" "binary search,math" "Daniel is organizing a football tournament. He has come up with the following tournament format:   In the first several (possibly zero) stages, while the number of teams is even, they split in pairs and play one game for each pair. At each stage the loser of each pair is eliminated (there are no draws). Such stages are held while the number of teams is even.  Eventually there will be an odd number of teams remaining. If there is one team remaining, it will be declared the winner, and the tournament ends. Otherwise each of the remaining teams will play with each other remaining team once in round robin tournament (if there are x teams, there will be  games), and the tournament ends. For example, if there were 20 teams initially, they would begin by playing 10 games. So, 10 teams would be eliminated, and the remaining 10 would play 5 games. Then the remaining 5 teams would play 10 games in a round robin tournament. In total there would be 10+5+10=25 games.Daniel has already booked the stadium for n games. Help him to determine how many teams he should invite so that the tournament needs exactly n games. You should print all possible numbers of teams that will yield exactly n games in ascending order, or -1 if there are no such numbers." 1800

325A "Square and Rectangles" implementation "You are given n rectangles. The corners of rectangles have integer coordinates and their edges are parallel to the Ox and Oy axes. The rectangles may touch each other, but they do not overlap (that is, there are no points that belong to the interior of more than one rectangle). Your task is to determine if the rectangles form a square. In other words, determine if the set of points inside or on the border of at least one rectangle is precisely equal to the set of points inside or on the border of some square." 1500

323C "Two permutations" "data structures" "You are given two permutations p and q, consisting of n elements, and m queries of the form: l1,\xe2\x80\x89r1,\xe2\x80\x89l2,\xe2\x80\x89r2 (l1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r1;�l2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r2). The response for the query is the number of such integers from 1 to n, that their position in the first permutation is in segment [l1,\xe2\x80\x89r1] (borders included), and position in the second permutation is in segment [l2,\xe2\x80\x89r2] (borders included too).A permutation of n elements is the sequence of n distinct integers, each not less than 1 and not greater than n.Position of number v (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89v\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) in permutation g1,\xe2\x80\x89g2,\xe2\x80\x89...,\xe2\x80\x89gn is such number i, that gi\xe2\x80\x89=\xe2\x80\x89v." 2400

323B Tournament-graph "constructive algorithms,graphs" "In this problem you have to build tournament graph, consisting of n vertices, such, that for any oriented pair of vertices (v,\xe2\x80\x89u) (v\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89u) there exists a path from vertex v to vertex u consisting of no more then two edges.A directed graph without self-loops is a tournament, if there is exactly one edge between any two distinct vertices (in one out of two possible directions)." 2200

323A "Black-and-White Cube" "combinatorics,constructive algorithms" "You are given a cube of size k\xe2\x80\x89\xc3\x97\xe2\x80\x89k\xe2\x80\x89\xc3\x97\xe2\x80\x89k, which consists of unit cubes. Two unit cubes are considered neighbouring, if they have common face.Your task is to paint each of k3 unit cubes one of two colours (black or white), so that the following conditions must be satisfied:  each white cube has exactly 2 neighbouring cubes of white color;  each black cube has exactly 2 neighbouring cubes of black color." 1600

322B "Ciel and Flowers" combinatorics,math "Fox Ciel has some flowers: r red flowers, g green flowers and b blue flowers. She wants to use these flowers to make several bouquets. There are 4 types of bouquets:  To make a ""red bouquet"", it needs 3 red flowers.  To make a ""green bouquet"", it needs 3 green flowers.  To make a ""blue bouquet"", it needs 3 blue flowers.  To make a ""mixing bouquet"", it needs 1 red, 1 green and 1 blue flower. Help Fox Ciel to find the maximal number of bouquets she can make." 1600

322A "Ciel and Dancing" greedy "Fox Ciel and her friends are in a dancing room. There are n boys and m girls here, and they never danced before. There will be some songs, during each song, there must be exactly one boy and one girl are dancing. Besides, there is a special rule:  either the boy in the dancing pair must dance for the first time (so, he didn\'t dance with anyone before);  or the girl in the dancing pair must dance for the first time. Help Fox Ciel to make a schedule that they can dance as many songs as possible." 1000

321E "Ciel and Gondolas" "data structures,divide and conquer,dp" "Fox Ciel is in the Amusement Park. And now she is in a queue in front of the Ferris wheel. There are n people (or foxes more precisely) in the queue: we use first people to refer one at the head of the queue, and n-th people to refer the last one in the queue.There will be k gondolas, and the way we allocate gondolas looks like this:  When the first gondolas come, the q1 people in head of the queue go into the gondolas.  Then when the second gondolas come, the q2 people in head of the remain queue go into the gondolas.����... The remain qk people go into the last (k-th) gondolas. Note that q1, q2, ..., qk must be positive. You can get from the statement that  and qi\xe2\x80\x89>\xe2\x80\x890.You know, people don\'t want to stay with strangers in the gondolas, so your task is to find an optimal allocation way (that is find an optimal sequence q) to make people happy. For every pair of people i and j, there exists a value uij denotes a level of unfamiliar. You can assume uij\xe2\x80\x89=\xe2\x80\x89uji for all i,\xe2\x80\x89j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i,\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) and uii\xe2\x80\x89=\xe2\x80\x890 for all i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n). Then an unfamiliar value of a gondolas is the sum of the levels of unfamiliar between any pair of people that is into the gondolas.A total unfamiliar value is the sum of unfamiliar values for all gondolas. Help Fox Ciel to find the minimal possible total unfamiliar value for some optimal allocation." 2600

321D "Ciel and Flipboard" dp,greedy,math "Fox Ciel has a board with n rows and n columns, there is one integer in each cell.It\'s known that n is an odd number, so let\'s introduce . Fox Ciel can do the following operation many times: she choose a sub-board with size x rows and x columns, then all numbers in it will be multiplied by -1.Return the maximal sum of numbers in the board that she can get by these operations." 2900

321C "Ciel the Commander" "constructive algorithms,dfs and similar,divide and conquer,greedy,trees" "Now Fox Ciel becomes a commander of Tree Land. Tree Land, like its name said, has n cities connected by n\xe2\x80\x89-\xe2\x80\x891 undirected roads, and for any two cities there always exists a path between them.Fox Ciel needs to assign an officer to each city. Each officer has a rank \xe2\x80\x94 a letter from \'A\' to \'Z\'. So there will be 26 different ranks, and \'A\' is the topmost, so \'Z\' is the bottommost.There are enough officers of each rank. But there is a special rule must obey: if x and y are two distinct cities and their officers have the same rank, then on the simple path between x and y there must be a city z that has an officer with higher rank. The rule guarantee that a communications between same rank officers will be monitored by higher rank officer.Help Ciel to make a valid plan, and if it\'s impossible, output ""Impossible!""." 2100

321B "Ciel and Duel" dp,flows,greedy "Fox Ciel is playing a card game with her friend Jiro.Jiro has n cards, each one has two attributes: position (Attack or Defense) and strength. Fox Ciel has m cards, each one has these two attributes too. It\'s known that position of all Ciel\'s cards is Attack.Now is Ciel\'s battle phase, Ciel can do the following operation many times:  Choose one of her cards X. This card mustn\'t be chosen before.  If Jiro has no alive cards at that moment, he gets the damage equal to (X\'s strength). Otherwise, Ciel needs to choose one Jiro\'s alive card Y, then:   If Y\'s position is Attack, then (X\'s strength) \xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89 (Y\'s strength) must hold. After this attack, card Y dies, and Jiro gets the damage equal to (X\'s strength) - (Y\'s strength).  If Y\'s position is Defense, then (X\'s strength) \xe2\x80\x89>\xe2\x80\x89 (Y\'s strength) must hold. After this attack, card Y dies, but Jiro gets no damage.  Ciel can end her battle phase at any moment (so, she can use not all her cards). Help the Fox to calculate the maximal sum of damage Jiro can get." 1900

321A "Ciel and Robot" "binary search,implementation,math" "Fox Ciel has a robot on a 2D plane. Initially it is located in (0, 0). Fox Ciel code a command to it. The command was represented by string s. Each character of s is one move operation. There are four move operations at all:  \'U\': go up, (x, y) \xe2\x80\x89\xe2\x86\x92\xe2\x80\x89 (x, y+1);  \'D\': go down, (x, y) \xe2\x80\x89\xe2\x86\x92\xe2\x80\x89 (x, y-1);  \'L\': go left, (x, y) \xe2\x80\x89\xe2\x86\x92\xe2\x80\x89 (x-1, y);  \'R\': go right, (x, y) \xe2\x80\x89\xe2\x86\x92\xe2\x80\x89 (x+1, y). The robot will do the operations in s from left to right, and repeat it infinite times. Help Fox Ciel to determine if after some steps the robot will located in (a,\xe2\x80\x89b)." 1700

320B "Ping-Pong (Easy Version)" "dfs and similar,graphs" "In this problem at each moment you have a set of intervals. You can move from interval (a,\xe2\x80\x89b) from our set to interval (c,\xe2\x80\x89d) from our set if and only if c\xe2\x80\x89<\xe2\x80\x89a\xe2\x80\x89<\xe2\x80\x89d or c\xe2\x80\x89<\xe2\x80\x89b\xe2\x80\x89<\xe2\x80\x89d. Also there is a path from interval I1 from our set to interval I2 from our set if there is a sequence of successive moves starting from I1 so that we can reach I2.Your program should handle the queries of the following two types:  ""1 x y"" (x\xe2\x80\x89<\xe2\x80\x89y) \xe2\x80\x94 add the new interval (x,\xe2\x80\x89y) to the set of intervals. The length of the new interval is guaranteed to be strictly greater than all the previous intervals. ""2 a b"" (a\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89b) \xe2\x80\x94 answer the question: is there a path from a-th (one-based) added interval to b-th (one-based) added interval? Answer all the queries. Note, that initially you have an empty set of intervals." 1500

320A "Magic Numbers" "brute force,greedy" "A magic number is a number formed by concatenation of numbers 1, 14 and 144. We can use each of these numbers any number of times. Therefore 14144, 141414 and 1411 are magic numbers but 1444, 514 and 414 are not.You\'re given a number. Determine if it is a magic number or not." 900

319E Ping-Pong "data structures" "In this problem at each moment you have a set of intervals. You can move from interval (a,\xe2\x80\x89b) from our set to interval (c,\xe2\x80\x89d) from our set if and only if c\xe2\x80\x89<\xe2\x80\x89a\xe2\x80\x89<\xe2\x80\x89d or c\xe2\x80\x89<\xe2\x80\x89b\xe2\x80\x89<\xe2\x80\x89d. Also there is a path from interval I1 from our set to interval I2 from our set if there is a sequence of successive moves starting from I1 so that we can reach I2.Your program should handle the queries of the following two types:  ""1 x y"" (x\xe2\x80\x89<\xe2\x80\x89y) \xe2\x80\x94 add the new interval (x,\xe2\x80\x89y) to the set of intervals. The length of the new interval is guaranteed to be strictly greater than all the previous intervals. ""2 a b"" (a\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89b) \xe2\x80\x94 answer the question: is there a path from a-th (one-based) added interval to b-th (one-based) added interval? Answer all the queries. Note, that initially you have an empty set of intervals." 3000

319D "Have You Ever Heard About the Word?" "greedy,hashing,string suffix structures,strings" "A substring of a string is a contiguous subsequence of that string. So, string bca is substring of string abcabc, but string cc is not.A repeating block is a string formed by concatenating some string with itself. So, string abcabc is a repeating block, but strings abcabd, ababab are not.You\'ve got a sequence of Latin characters (string). At each step you find the shortest substring that is a repeating block, if there exists more than one you must choose the leftmost. As the substring is of form XX (X \xe2\x80\x94 some string) you replace this substring with X, in other words you delete one of the X substrings in the substring. You repeat this process until there remains no repeating block in the string. How would the final string looks like? Look at the sample explanation to understand the statement more precise." 2800

319C "Kalila and Dimna in the Logging Industry" dp,geometry "Kalila and Dimna are two jackals living in a huge jungle. One day they decided to join a logging factory in order to make money. The manager of logging factory wants them to go to the jungle and cut n trees with heights a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. They bought a chain saw from a shop. Each time they use the chain saw on the tree number i, they can decrease the height of this tree by one unit. Each time that Kalila and Dimna use the chain saw, they need to recharge it. Cost of charging depends on the id of the trees which have been cut completely (a tree is cut completely if its height equal to 0). If the maximum id of a tree which has been cut completely is i (the tree that have height ai in the beginning), then the cost of charging the chain saw would be bi. If no tree is cut completely, Kalila and Dimna cannot charge the chain saw. The chainsaw is charged in the beginning. We know that for each i < j, ai\xe2\x80\x89<\xe2\x80\x89aj and bi\xe2\x80\x89>\xe2\x80\x89bj and also bn\xe2\x80\x89=\xe2\x80\x890 and a1\xe2\x80\x89=\xe2\x80\x891. Kalila and Dimna want to cut all the trees completely, with minimum cost. They want you to help them! Will you?" 2100

319B "Psychos in a Line" "data structures,implementation" "There are n psychos standing in a line. Each psycho is assigned a unique integer from 1 to n. At each step every psycho who has an id greater than the psycho to his right (if exists) kills his right neighbor in the line. Note that a psycho might kill and get killed at the same step. You\'re given the initial arrangement of the psychos in the line. Calculate how many steps are needed to the moment of time such, that nobody kills his neighbor after that moment. Look notes to understand the statement more precise." 1900

319A "Malek Dance Club" combinatorics,math "As a tradition, every year before IOI all the members of Natalia Fan Club are invited to Malek Dance Club to have a fun night together. Malek Dance Club has 2n members and coincidentally Natalia Fan Club also has 2n members. Each member of MDC is assigned a unique id i from 0 to 2n\xe2\x80\x89-\xe2\x80\x891. The same holds for each member of NFC.One of the parts of this tradition is one by one dance, where each member of MDC dances with a member of NFC. A dance pair is a pair of numbers (a,\xe2\x80\x89b) such that member a from MDC dances with member b from NFC.The complexity of a pairs\' assignment is the number of pairs of dancing pairs (a,\xe2\x80\x89b) and (c,\xe2\x80\x89d) such that a\xe2\x80\x89<\xe2\x80\x89c and b\xe2\x80\x89>\xe2\x80\x89d.You are given a binary number of length n named x. We know that member i from MDC dances with member  from NFC. Your task is to calculate the complexity of this assignment modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897).Expression  denotes applying \xc2\xabXOR\xc2\xbb to numbers x and y. This operation exists in all modern programming languages, for example, in C++ and Java it denotes as \xc2\xab^\xc2\xbb, in Pascal \xe2\x80\x94 \xc2\xabxor\xc2\xbb." 1600

318B "Strings of Power" "implementation,strings,two pointers" "Volodya likes listening to heavy metal and (occasionally) reading. No wonder Volodya is especially interested in texts concerning his favourite music style.Volodya calls a string powerful if it starts with ""heavy"" and ends with ""metal"". Finding all powerful substrings (by substring Volodya means a subsequence of consecutive characters in a string) in a given text makes our hero especially joyful. Recently he felt an enormous fit of energy while reading a certain text. So Volodya decided to count all powerful substrings in this text and brag about it all day long. Help him in this difficult task. Two substrings are considered different if they appear at the different positions in the text.For simplicity, let us assume that Volodya\'s text can be represented as a single string." 1300

318A "Even Odds" math "Being a nonconformist, Volodya is displeased with the current state of things, particularly with the order of natural numbers (natural number is positive integer number). He is determined to rearrange them. But there are too many natural numbers, so Volodya decided to start with the first n. He writes down the following sequence of numbers: firstly all odd integers from 1 to n (in ascending order), then all even integers from 1 to n (also in ascending order). Help our hero to find out which number will stand at the position number k." 900

317E "Princess and Her Shadow" "constructive algorithms,shortest paths" "Princess Vlada enjoys springing in the meadows and walking in the forest. One day \xe2\x80\x94 wonderful, sunny day \xe2\x80\x94 during her walk Princess found out with astonishment that her shadow was missing! ""Blimey!"", \xe2\x80\x94 she thought and started her search of the shadow in the forest.Normally the Shadow is too lazy and simply sleeps under the Princess. But at this terrifically hot summer day she got bored of such a dull life, so she decided to play with Vlada.The forest, where our characters entertain themselves, may be represented as a set of integer cells in the plane, where the Shadow and the Princess can move only up, down, left and right by 1. Some cells (as it happens in decent forests) are occupied by trees. The Shadow and the Princess are not allowed to enter a cell occupied by a tree. Unfortunately, these are the hard times for the forest, so there are very few trees growing here...At first the Princess was walking within the cell (vx,�vy), while the Shadow hid from the Princess in the cell (sx,�sy). The Princess, The Shadow and the trees are located in the different cells.The Shadow is playing with the Princess. As soon as the Princess moves by 1 in some direction, the Shadow simultaneously flies by 1 in the same direction, if it is possible (if the cell to fly to is not occupied by some tree); otherwise, the Shadow doesn\'t move. The Shadow is very shadowy, so our characters do not interfere with each other.We say that the Shadow is caught by the Princess if after some move both of them are located in the same cell. Vlada managed to catch her Shadow! Can you?" 3100

317D "Game with Powers" dp,games "Vasya and Petya wrote down all integers from 1 to n to play the ""powers"" game (n can be quite large; however, Vasya and Petya are not confused by this fact).Players choose numbers in turn (Vasya chooses first). If some number x is chosen at the current turn, it is forbidden to choose x or all of its other positive integer powers (that is, x2, x3, ...) at the next turns. For instance, if the number 9 is chosen at the first turn, one cannot choose 9 or 81 later, while it is still allowed to choose 3 or 27. The one who cannot make a move loses.Who wins if both Vasya and Petya play optimally?" 2300

317C Balance "constructive algorithms,dfs and similar,graphs,trees" "A system of n vessels with water is given. Several pairs of vessels are connected by tubes with transfusion mechanisms. One may transfer an integer amount of liters of water between two vessels connected by such tube (tube works in both directions). There might be multiple tubes between two vessels. Total number of tubes equals e. Volume of each vessel equals v liters. Of course, the amount of the water in any vessel cannot exceed v liters in the process of transfusions.Given the initial amounts ai of water in the vessels and the desired amounts bi find a sequence of transfusions that deals with the task. Total number of transfusions must not exceed 2\xc2\xb7n2." 2500

317B Ants "brute force,implementation" "It has been noted that if some ants are put in the junctions of the graphene integer lattice then they will act in the following fashion: every minute at each junction (x, y) containing at least four ants a group of four ants will be formed, and these four ants will scatter to the neighbouring junctions (x\xe2\x80\x89+\xe2\x80\x891, y), (x\xe2\x80\x89-\xe2\x80\x891, y), (x, y\xe2\x80\x89+\xe2\x80\x891), (x, y\xe2\x80\x89-\xe2\x80\x891) \xe2\x80\x94 one ant in each direction. No other ant movements will happen. Ants never interfere with each other.Scientists have put a colony of n ants into the junction (0, 0) and now they wish to know how many ants will there be at some given junctions, when the movement of the ants stops." 2000

317A "Perfect Pair" "brute force" "Let us call a pair of integer numbers m-perfect, if at least one number in the pair is greater than or equal to m. Thus, the pairs (3, 3) and (0, 2) are 2-perfect while the pair (-1, 1) is not.Two integers x, y are written on the blackboard. It is allowed to erase one of them and replace it with the sum of the numbers, (x\xe2\x80\x89+\xe2\x80\x89y).What is the minimum number of such operations one has to perform in order to make the given pair of integers m-perfect?" 1600

316G3 "Good Substrings" "string suffix structures" "Smart Beaver recently got interested in a new word game. The point is as follows: count the number of distinct good substrings of some string s. To determine if a string is good or not the game uses rules. Overall there are n rules. Each rule is described by a group of three (p,\xe2\x80\x89l,\xe2\x80\x89r), where p is a string and l and r (l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r) are integers. We\xe2\x80\x99ll say that string t complies with rule (p,\xe2\x80\x89l,\xe2\x80\x89r), if the number of occurrences of string t in string p lies between l and r, inclusive. For example, string ""ab"", complies with rules (""ab"", 1, 2) and (""aab"", 0, 1), but does not comply with rules (""cd"", 1, 2) and (""abab"", 0, 1).A substring s[l... r] (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|s|) of string s\xe2\x80\x89=\xe2\x80\x89s1s2... s|s| (|s| is a length of s) is string slsl\xe2\x80\x89+\xe2\x80\x891... sr.Consider a number of occurrences  of string t in string p as a number of pairs of integers l,\xe2\x80\x89r (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|p|) such that p[l... r]\xe2\x80\x89=\xe2\x80\x89t.We\xe2\x80\x99ll say that string t is good if it complies with all n rules. Smart Beaver asks you to help him to write a program that can calculate the number of distinct good substrings of string s. Two substrings s[x... y] and s[z... w] are cosidered to be distinct iff s[x... y]\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89s[z... w]." 2400

316G2 "Good Substrings" "string suffix structures" "Smart Beaver recently got interested in a new word game. The point is as follows: count the number of distinct good substrings of some string s. To determine if a string is good or not the game uses rules. Overall there are n rules. Each rule is described by a group of three (p,\xe2\x80\x89l,\xe2\x80\x89r), where p is a string and l and r (l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r) are integers. We\xe2\x80\x99ll say that string t complies with rule (p,\xe2\x80\x89l,\xe2\x80\x89r), if the number of occurrences of string t in string p lies between l and r, inclusive. For example, string ""ab"", complies with rules (""ab"", 1, 2) and (""aab"", 0, 1), but does not comply with rules (""cd"", 1, 2) and (""abab"", 0, 1).A substring s[l... r] (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|s|) of string s\xe2\x80\x89=\xe2\x80\x89s1s2... s|s| (|s| is a length of s) is string slsl\xe2\x80\x89+\xe2\x80\x891... sr.Consider a number of occurrences  of string t in string p as a number of pairs of integers l,\xe2\x80\x89r (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|p|) such that p[l... r]\xe2\x80\x89=\xe2\x80\x89t.We\xe2\x80\x99ll say that string t is good if it complies with all n rules. Smart Beaver asks you to help him to write a program that can calculate the number of distinct good substrings of string s. Two substrings s[x... y] and s[z... w] are cosidered to be distinct iff s[x... y]\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89s[z... w]." 2200

316G1 "Good Substrings" hashing,strings "Smart Beaver recently got interested in a new word game. The point is as follows: count the number of distinct good substrings of some string s. To determine if a string is good or not the game uses rules. Overall there are n rules. Each rule is described by a group of three (p,\xe2\x80\x89l,\xe2\x80\x89r), where p is a string and l and r (l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r) are integers. We\xe2\x80\x99ll say that string t complies with rule (p,\xe2\x80\x89l,\xe2\x80\x89r), if the number of occurrences of string t in string p lies between l and r, inclusive. For example, string ""ab"", complies with rules (""ab"", 1, 2) and (""aab"", 0, 1), but does not comply with rules (""cd"", 1, 2) and (""abab"", 0, 1).A substring s[l... r] (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|s|) of string s\xe2\x80\x89=\xe2\x80\x89s1s2... s|s| (|s| is a length of s) is string slsl\xe2\x80\x89+\xe2\x80\x891... sr.Consider a number of occurrences  of string t in string p as a number of pairs of integers l,\xe2\x80\x89r (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|p|) such that p[l... r]\xe2\x80\x89=\xe2\x80\x89t.We\xe2\x80\x99ll say that string t is good if it complies with all n rules. Smart Beaver asks you to help him to write a program that can calculate the number of distinct good substrings of string s. Two substrings s[x... y] and s[z... w] are cosidered to be distinct iff s[x... y]\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89s[z... w]." 1700

316F3 "Suns and Rays" "constructive algorithms,dfs and similar,implementation" "Smart Beaver became interested in drawing. He draws suns. However, at some point, Smart Beaver realized that simply drawing suns is boring. So he decided to design a program that will process his drawings. You are given a picture drawn by the beaver. It will have two colors: one for the background and one for the suns in the image. Your task will be to count the number of suns in the image and for each of them to count the number of rays.Sun is arbitrarily rotated ellipse with rays. Ray is a segment which connects point on boundary of the ellipse with some point outside ellipse.   An image where all suns are circles.     An image where all suns are ellipses, their axes are parallel to the coordinate axes.     An image where all suns are rotated ellipses.  It is guaranteed that:   No two suns have common points.  The rays\xe2\x80\x99 width is 3 pixels.  The lengths of the ellipsis suns\xe2\x80\x99 axes will lie between 40 and 200 pixels.  No two rays intersect.  The lengths of all rays will lie between 10 and 30 pixels." 2200

316F2 "Suns and Rays" NA "Smart Beaver became interested in drawing. He draws suns. However, at some point, Smart Beaver realized that simply drawing suns is boring. So he decided to design a program that will process his drawings. You are given a picture drawn by the beaver. It will have two colors: one for the background and one for the suns in the image. Your task will be to count the number of suns in the image and for each of them to count the number of rays.Sun is arbitrarily rotated ellipse with rays. Ray is a segment which connects point on boundary of the ellipse with some point outside ellipse.   An image where all suns are circles.     An image where all suns are ellipses, their axes are parallel to the coordinate axes.     An image where all suns are rotated ellipses.  It is guaranteed that:   No two suns have common points.  The rays\xe2\x80\x99 width is 3 pixels.  The lengths of the ellipsis suns\xe2\x80\x99 axes will lie between 40 and 200 pixels.  No two rays intersect.  The lengths of all rays will lie between 10 and 30 pixels." 2300

316F1 "Suns and Rays" "dfs and similar,implementation" "Smart Beaver became interested in drawing. He draws suns. However, at some point, Smart Beaver realized that simply drawing suns is boring. So he decided to design a program that will process his drawings. You are given a picture drawn by the beaver. It will have two colors: one for the background and one for the suns in the image. Your task will be to count the number of suns in the image and for each of them to count the number of rays.Sun is arbitrarily rotated ellipse with rays. Ray is a segment which connects point on boundary of the ellipse with some point outside ellipse.   An image where all suns are circles.     An image where all suns are ellipses, their axes are parallel to the coordinate axes.     An image where all suns are rotated ellipses.  It is guaranteed that:   No two suns have common points.  The rays\xe2\x80\x99 width is 3 pixels.  The lengths of the ellipsis suns\xe2\x80\x99 axes will lie between 40 and 200 pixels.  No two rays intersect.  The lengths of all rays will lie between 10 and 30 pixels." 2200

316E3 "Summer Homework" "data structures,math" "By the age of three Smart Beaver mastered all arithmetic operations and got this summer homework from the amazed teacher:You are given a sequence of integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. Your task is to perform on it m consecutive operations of the following type:  For given numbers xi and vi assign value vi to element axi.  For given numbers li and ri you\'ve got to calculate sum , where f0\xe2\x80\x89=\xe2\x80\x89f1\xe2\x80\x89=\xe2\x80\x891 and at i\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x892: fi\xe2\x80\x89=\xe2\x80\x89fi\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x89fi\xe2\x80\x89-\xe2\x80\x892.  For a group of three numbers li ri di you should increase value ax by di for all x (li\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ri). Smart Beaver planned a tour around great Canadian lakes, so he asked you to help him solve the given problem." 2300

316E2 "Summer Homework" "data structures,math" "By the age of three Smart Beaver mastered all arithmetic operations and got this summer homework from the amazed teacher:You are given a sequence of integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. Your task is to perform on it m consecutive operations of the following type:  For given numbers xi and vi assign value vi to element axi.  For given numbers li and ri you\'ve got to calculate sum , where f0\xe2\x80\x89=\xe2\x80\x89f1\xe2\x80\x89=\xe2\x80\x891 and at i\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x892: fi\xe2\x80\x89=\xe2\x80\x89fi\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x89fi\xe2\x80\x89-\xe2\x80\x892.  For a group of three numbers li ri di you should increase value ax by di for all x (li\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ri). Smart Beaver planned a tour around great Canadian lakes, so he asked you to help him solve the given problem." 2300

316E1 "Summer Homework" "brute force,data structures" "By the age of three Smart Beaver mastered all arithmetic operations and got this summer homework from the amazed teacher:You are given a sequence of integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. Your task is to perform on it m consecutive operations of the following type:  For given numbers xi and vi assign value vi to element axi.  For given numbers li and ri you\'ve got to calculate sum , where f0\xe2\x80\x89=\xe2\x80\x89f1\xe2\x80\x89=\xe2\x80\x891 and at i\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x892: fi\xe2\x80\x89=\xe2\x80\x89fi\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x89fi\xe2\x80\x89-\xe2\x80\x892.  For a group of three numbers li ri di you should increase value ax by di for all x (li\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ri). Smart Beaver planned a tour around great Canadian lakes, so he asked you to help him solve the given problem." 1500

316D3 "PE Lesson" dp,math "Smart Beaver decided to be not only smart, but also a healthy beaver! And so he began to attend physical education classes at school X. In this school, physical education has a very creative teacher. One of his favorite warm-up exercises is throwing balls. Students line up. Each one gets a single ball in the beginning. The balls are numbered from 1 to n (by the demand of the inventory commission).   Figure 1. The initial position for n\xe2\x80\x89=\xe2\x80\x895.  After receiving the balls the students perform the warm-up exercise. The exercise takes place in a few throws. For each throw the teacher chooses any two arbitrary different students who will participate in it. The selected students throw their balls to each other. Thus, after each throw the students remain in their positions, and the two balls are swapped.   Figure 2. The example of a throw.  In this case there was a throw between the students, who were holding the 2-nd and the 4-th balls. Since the warm-up has many exercises, each of them can only continue for little time. Therefore, for each student we know the maximum number of throws he can participate in. For this lessons maximum number of throws will be 1 or 2.Note that after all phases of the considered exercise any ball can end up with any student. Smart Beaver decided to formalize it and introduced the concept of the ""ball order"". The ball order is a sequence of n numbers that correspond to the order of balls in the line. The first number will match the number of the ball of the first from the left student in the line, the second number will match the ball of the second student, and so on. For example, in figure 2 the order of the balls was (1, 2, 3, 4, 5), and after the throw it was (1, 4, 3, 2, 5). Smart beaver knows the number of students and for each student he knows the maximum number of throws in which he can participate. And now he is wondering: what is the number of distinct ways of ball orders by the end of the exercise." 2400

316D2 "PE Lesson" dp "Smart Beaver decided to be not only smart, but also a healthy beaver! And so he began to attend physical education classes at school X. In this school, physical education has a very creative teacher. One of his favorite warm-up exercises is throwing balls. Students line up. Each one gets a single ball in the beginning. The balls are numbered from 1 to n (by the demand of the inventory commission).   Figure 1. The initial position for n\xe2\x80\x89=\xe2\x80\x895.  After receiving the balls the students perform the warm-up exercise. The exercise takes place in a few throws. For each throw the teacher chooses any two arbitrary different students who will participate in it. The selected students throw their balls to each other. Thus, after each throw the students remain in their positions, and the two balls are swapped.   Figure 2. The example of a throw.  In this case there was a throw between the students, who were holding the 2-nd and the 4-th balls. Since the warm-up has many exercises, each of them can only continue for little time. Therefore, for each student we know the maximum number of throws he can participate in. For this lessons maximum number of throws will be 1 or 2.Note that after all phases of the considered exercise any ball can end up with any student. Smart Beaver decided to formalize it and introduced the concept of the ""ball order"". The ball order is a sequence of n numbers that correspond to the order of balls in the line. The first number will match the number of the ball of the first from the left student in the line, the second number will match the ball of the second student, and so on. For example, in figure 2 the order of the balls was (1, 2, 3, 4, 5), and after the throw it was (1, 4, 3, 2, 5). Smart beaver knows the number of students and for each student he knows the maximum number of throws in which he can participate. And now he is wondering: what is the number of distinct ways of ball orders by the end of the exercise." 2300

316D1 "PE Lesson" "brute force,dp" "Smart Beaver decided to be not only smart, but also a healthy beaver! And so he began to attend physical education classes at school X. In this school, physical education has a very creative teacher. One of his favorite warm-up exercises is throwing balls. Students line up. Each one gets a single ball in the beginning. The balls are numbered from 1 to n (by the demand of the inventory commission).   Figure 1. The initial position for n\xe2\x80\x89=\xe2\x80\x895.  After receiving the balls the students perform the warm-up exercise. The exercise takes place in a few throws. For each throw the teacher chooses any two arbitrary different students who will participate in it. The selected students throw their balls to each other. Thus, after each throw the students remain in their positions, and the two balls are swapped.   Figure 2. The example of a throw.  In this case there was a throw between the students, who were holding the 2-nd and the 4-th balls. Since the warm-up has many exercises, each of them can only continue for little time. Therefore, for each student we know the maximum number of throws he can participate in. For this lessons maximum number of throws will be 1 or 2.Note that after all phases of the considered exercise any ball can end up with any student. Smart Beaver decided to formalize it and introduced the concept of the ""ball order"". The ball order is a sequence of n numbers that correspond to the order of balls in the line. The first number will match the number of the ball of the first from the left student in the line, the second number will match the ball of the second student, and so on. For example, in figure 2 the order of the balls was (1, 2, 3, 4, 5), and after the throw it was (1, 4, 3, 2, 5). Smart beaver knows the number of students and for each student he knows the maximum number of throws in which he can participate. And now he is wondering: what is the number of distinct ways of ball orders by the end of the exercise." 2300

316C2 "Tidying Up" "flows,graph matchings" "Smart Beaver is careful about his appearance and pays special attention to shoes so he has a huge number of pairs of shoes from the most famous brands of the forest. He\'s trying to handle his shoes carefully so that each pair stood side by side. But by the end of the week because of his very active lifestyle in his dressing room becomes a mess.Smart Beaver from ABBYY is not only the brightest beaver in the area, but he also is the most domestically oriented. For example, on Mondays the Smart Beaver cleans everything in his home.It\'s Monday morning. Smart Beaver does not want to spend the whole day cleaning, besides, there is much in to do and it\xe2\x80\x99s the gym day, so he wants to clean up as soon as possible. Now the floors are washed, the dust is wiped off \xe2\x80\x94 it\xe2\x80\x99s time to clean up in the dressing room. But as soon as the Smart Beaver entered the dressing room, all plans for the day were suddenly destroyed: chaos reigned there and it seemed impossible to handle, even in a week. Give our hero some hope: tell him what is the minimum number of shoes need to change the position to make the dressing room neat.The dressing room is rectangular and is divided into n\xe2\x80\x89\xc3\x97\xe2\x80\x89m equal squares, each square contains exactly one shoe. Each pair of shoes has a unique number that is integer from 1 to , more formally, a square with coordinates (i,\xe2\x80\x89j) contains an integer number of the pair which is lying on it. The Smart Beaver believes that the dressing room is neat only when each pair of sneakers lies together. We assume that the pair of sneakers in squares (i1,\xe2\x80\x89j1) and (i2,\xe2\x80\x89j2) lies together if |i1\xe2\x80\x89-\xe2\x80\x89i2|\xe2\x80\x89+\xe2\x80\x89|j1\xe2\x80\x89-\xe2\x80\x89j2|\xe2\x80\x89=\xe2\x80\x891." 2300

316C1 "Tidying Up" flows "Smart Beaver is careful about his appearance and pays special attention to shoes so he has a huge number of pairs of shoes from the most famous brands of the forest. He\'s trying to handle his shoes carefully so that each pair stood side by side. But by the end of the week because of his very active lifestyle in his dressing room becomes a mess.Smart Beaver from ABBYY is not only the brightest beaver in the area, but he also is the most domestically oriented. For example, on Mondays the Smart Beaver cleans everything in his home.It\'s Monday morning. Smart Beaver does not want to spend the whole day cleaning, besides, there is much in to do and it\xe2\x80\x99s the gym day, so he wants to clean up as soon as possible. Now the floors are washed, the dust is wiped off \xe2\x80\x94 it\xe2\x80\x99s time to clean up in the dressing room. But as soon as the Smart Beaver entered the dressing room, all plans for the day were suddenly destroyed: chaos reigned there and it seemed impossible to handle, even in a week. Give our hero some hope: tell him what is the minimum number of shoes need to change the position to make the dressing room neat.The dressing room is rectangular and is divided into n\xe2\x80\x89\xc3\x97\xe2\x80\x89m equal squares, each square contains exactly one shoe. Each pair of shoes has a unique number that is integer from 1 to , more formally, a square with coordinates (i,\xe2\x80\x89j) contains an integer number of the pair which is lying on it. The Smart Beaver believes that the dressing room is neat only when each pair of sneakers lies together. We assume that the pair of sneakers in squares (i1,\xe2\x80\x89j1) and (i2,\xe2\x80\x89j2) lies together if |i1\xe2\x80\x89-\xe2\x80\x89i2|\xe2\x80\x89+\xe2\x80\x89|j1\xe2\x80\x89-\xe2\x80\x89j2|\xe2\x80\x89=\xe2\x80\x891." 2200

316B2 EKG "dfs and similar,dp" "In the rush of modern life, people often forget how beautiful the world is. The time to enjoy those around them is so little that some even stand in queues to several rooms at the same time in the clinic, running from one queue to another.(Cultural note: standing in huge and disorganized queues for hours is a native tradition in Russia, dating back to the Soviet period. Queues can resemble crowds rather than lines. Not to get lost in such a queue, a person should follow a strict survival technique: you approach the queue and ask who the last person is, somebody answers and you join the crowd. Now you\'re the last person in the queue till somebody else shows up. You keep an eye on the one who was last before you as he is your only chance to get to your destination) I\'m sure many people have had the problem when a stranger asks who the last person in the queue is and even dares to hint that he will be the last in the queue and then bolts away to some unknown destination. These are the representatives of the modern world, in which the ratio of lack of time is so great that they do not even watch foreign top-rated TV series. Such people often create problems in queues, because the newcomer does not see the last person in the queue and takes a place after the ""virtual"" link in this chain, wondering where this legendary figure has left.The Smart Beaver has been ill and he\'s made an appointment with a therapist. The doctor told the Beaver the sad news in a nutshell: it is necessary to do an electrocardiogram. The next day the Smart Beaver got up early, put on the famous TV series on download (three hours till the download\'s complete), clenched his teeth and bravely went to join a queue to the electrocardiogram room, which is notorious for the biggest queues at the clinic.Having stood for about three hours in the queue, the Smart Beaver realized that many beavers had not seen who was supposed to stand in the queue before them and there was a huge mess. He came up to each beaver in the ECG room queue and asked who should be in front of him in the queue. If the beaver did not know his correct position in the queue, then it might be his turn to go get an ECG, or maybe he should wait for a long, long time...As you\'ve guessed, the Smart Beaver was in a hurry home, so he gave you all the necessary information for you to help him to determine what his number in the queue can be." 1600

316B1 EKG "brute force,dfs and similar" "In the rush of modern life, people often forget how beautiful the world is. The time to enjoy those around them is so little that some even stand in queues to several rooms at the same time in the clinic, running from one queue to another.(Cultural note: standing in huge and disorganized queues for hours is a native tradition in Russia, dating back to the Soviet period. Queues can resemble crowds rather than lines. Not to get lost in such a queue, a person should follow a strict survival technique: you approach the queue and ask who the last person is, somebody answers and you join the crowd. Now you\'re the last person in the queue till somebody else shows up. You keep an eye on the one who was last before you as he is your only chance to get to your destination) I\'m sure many people have had the problem when a stranger asks who the last person in the queue is and even dares to hint that he will be the last in the queue and then bolts away to some unknown destination. These are the representatives of the modern world, in which the ratio of lack of time is so great that they do not even watch foreign top-rated TV series. Such people often create problems in queues, because the newcomer does not see the last person in the queue and takes a place after the ""virtual"" link in this chain, wondering where this legendary figure has left.The Smart Beaver has been ill and he\'s made an appointment with a therapist. The doctor told the Beaver the sad news in a nutshell: it is necessary to do an electrocardiogram. The next day the Smart Beaver got up early, put on the famous TV series on download (three hours till the download\'s complete), clenched his teeth and bravely went to join a queue to the electrocardiogram room, which is notorious for the biggest queues at the clinic.Having stood for about three hours in the queue, the Smart Beaver realized that many beavers had not seen who was supposed to stand in the queue before them and there was a huge mess. He came up to each beaver in the ECG room queue and asked who should be in front of him in the queue. If the beaver did not know his correct position in the queue, then it might be his turn to go get an ECG, or maybe he should wait for a long, long time...As you\'ve guessed, the Smart Beaver was in a hurry home, so he gave you all the necessary information for you to help him to determine what his number in the queue can be." 1500

316A2 "Special Task" math "Special Agent Smart Beaver works in a secret research department of ABBYY. He\'s been working there for a long time and is satisfied with his job, as it allows him to eat out in the best restaurants and order the most expensive and exotic wood types there. The content special agent has got an important task: to get the latest research by British scientists on the English Language. These developments are encoded and stored in a large safe. The Beaver\'s teeth are strong enough, so the authorities assured that upon arriving at the place the beaver won\'t have any problems with opening the safe.And he finishes his aspen sprig and leaves for this important task. Of course, the Beaver arrived at the location without any problems, but alas. He can\'t open the safe with his strong and big teeth. At this point, the Smart Beaver get a call from the headquarters and learns that opening the safe with the teeth is not necessary, as a reliable source has sent the following information: the safe code consists of digits and has no leading zeroes. There also is a special hint, which can be used to open the safe. The hint is string s with the following structure:  if si = ""?"", then the digit that goes i-th in the safe code can be anything (between 0 to 9, inclusively);  if si is a digit (between 0 to 9, inclusively), then it means that there is digit si on position i in code;  if the string contains letters from ""A"" to ""J"", then all positions with the same letters must contain the same digits and the positions with distinct letters must contain distinct digits.  The length of the safe code coincides with the length of the hint. For example, hint ""?JGJ9"" has such matching safe code variants: ""51919"", ""55959"", ""12329"", ""93539"" and so on, and has wrong variants such as: ""56669"", ""00111"", ""03539"" and ""13666"".After receiving such information, the authorities change the plan and ask the special agents to work quietly and gently and not to try to open the safe by mechanical means, and try to find the password using the given hint.At a special agent school the Smart Beaver was the fastest in his platoon finding codes for such safes, but now he is not in that shape: the years take their toll ... Help him to determine the number of possible variants of the code to the safe, matching the given hint. After receiving this information, and knowing his own speed of entering codes, the Smart Beaver will be able to determine whether he will have time for tonight\'s show ""Beavers are on the trail"" on his favorite TV channel, or he should work for a sleepless night..." 1400

316A1 "Special Task" greedy "Special Agent Smart Beaver works in a secret research department of ABBYY. He\'s been working there for a long time and is satisfied with his job, as it allows him to eat out in the best restaurants and order the most expensive and exotic wood types there. The content special agent has got an important task: to get the latest research by British scientists on the English Language. These developments are encoded and stored in a large safe. The Beaver\'s teeth are strong enough, so the authorities assured that upon arriving at the place the beaver won\'t have any problems with opening the safe.And he finishes his aspen sprig and leaves for this important task. Of course, the Beaver arrived at the location without any problems, but alas. He can\'t open the safe with his strong and big teeth. At this point, the Smart Beaver get a call from the headquarters and learns that opening the safe with the teeth is not necessary, as a reliable source has sent the following information: the safe code consists of digits and has no leading zeroes. There also is a special hint, which can be used to open the safe. The hint is string s with the following structure:  if si = ""?"", then the digit that goes i-th in the safe code can be anything (between 0 to 9, inclusively);  if si is a digit (between 0 to 9, inclusively), then it means that there is digit si on position i in code;  if the string contains letters from ""A"" to ""J"", then all positions with the same letters must contain the same digits and the positions with distinct letters must contain distinct digits.  The length of the safe code coincides with the length of the hint. For example, hint ""?JGJ9"" has such matching safe code variants: ""51919"", ""55959"", ""12329"", ""93539"" and so on, and has wrong variants such as: ""56669"", ""00111"", ""03539"" and ""13666"".After receiving such information, the authorities change the plan and ask the special agents to work quietly and gently and not to try to open the safe by mechanical means, and try to find the password using the given hint.At a special agent school the Smart Beaver was the fastest in his platoon finding codes for such safes, but now he is not in that shape: the years take their toll ... Help him to determine the number of possible variants of the code to the safe, matching the given hint. After receiving this information, and knowing his own speed of entering codes, the Smart Beaver will be able to determine whether he will have time for tonight\'s show ""Beavers are on the trail"" on his favorite TV channel, or he should work for a sleepless night..." 1100

315B "Sereja and Array" implementation "Sereja has got an array, consisting of n integers, a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. Sereja is an active boy, so he is now going to complete m operations. Each operation will have one of the three forms:  Make vi-th array element equal to xi. In other words, perform the assignment avi\xe2\x80\x89=\xe2\x80\x89xi.  Increase each array element by yi. In other words, perform n assignments ai\xe2\x80\x89=\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x89yi (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n).  Take a piece of paper and write out the qi-th array element. That is, the element aqi. Help Sereja, complete all his operations." 1200

315A "Sereja and Bottles" "brute force" "Sereja and his friends went to a picnic. The guys had n soda bottles just for it. Sereja forgot the bottle opener as usual, so the guys had to come up with another way to open bottles.Sereja knows that the i-th bottle is from brand ai, besides, you can use it to open other bottles of brand bi. You can use one bottle to open multiple other bottles. Sereja can open bottle with opened bottle or closed bottle.Knowing this, Sereja wants to find out the number of bottles they\'ve got that they won\'t be able to open in any way. Help him and find this number." 1400

314E "Sereja and Squares" dp "Sereja painted n points on the plane, point number i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) has coordinates (i,\xe2\x80\x890). Then Sereja marked each point with a small or large English letter. Sereja don\'t like letter ""x"", so he didn\'t use it to mark points. Sereja thinks that the points are marked beautifully if the following conditions holds:  all points can be divided into pairs so that each point will belong to exactly one pair;  in each pair the point with the lesser abscissa will be marked with a small English letter and the point with the larger abscissa will be marked with the same large English letter;  if we built a square on each pair, the pair\'s points will be the square\'s opposite points and the segment between them will be the square\'s diagonal, then among the resulting squares there won\'t be any intersecting or touching ones. Little Petya erased some small and all large letters marking the points. Now Sereja wonders how many ways are there to return the removed letters so that the points were marked beautifully." 2900

314D "Sereja and Straight Lines" "binary search,data structures,geometry,sortings,two pointers" "Sereja placed n points on a plane. Now Sereja wants to place on the plane two straight lines, intersecting at a right angle, so that one of the straight lines intersect the Ox axis at an angle of 45 degrees and the maximum distance from the points to the straight lines were minimum. In this problem we consider the distance between points (x1,\xe2\x80\x89y1) and (x2,\xe2\x80\x89y2) equal |x1\xe2\x80\x89-\xe2\x80\x89x2|\xe2\x80\x89+\xe2\x80\x89|y1\xe2\x80\x89-\xe2\x80\x89y2|. The distance between the point and the straight lines is the minimum distance from the point to some point belonging to one of the lines.Help Sereja, find the maximum distance from the points to the optimally located straight lines." 2500

314C "Sereja and Subsequences" "data structures,dp" "Sereja has a sequence that consists of n positive integers, a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. First Sereja took a piece of squared paper and wrote all distinct non-empty non-decreasing subsequences of sequence a. Then for each sequence written on the squared paper, Sereja wrote on a piece of lines paper all sequences that do not exceed it.A sequence of positive integers x\xe2\x80\x89=\xe2\x80\x89x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xr doesn\'t exceed a sequence of positive integers y\xe2\x80\x89=\xe2\x80\x89y1,\xe2\x80\x89y2,\xe2\x80\x89...,\xe2\x80\x89yr, if the following inequation holds: x1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y1,\xe2\x80\x89x2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y2,\xe2\x80\x89...,\xe2\x80\x89xr\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89yr.Now Sereja wonders, how many sequences are written on the lines piece of paper. Help Sereja, find the required quantity modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." 2000

314B "Sereja and Periods" "binary search,dfs and similar,strings" "Let\'s introduce the designation , where x is a string, n is a positive integer and operation ""\xe2\x80\x89+\xe2\x80\x89"" is the string concatenation operation. For example, [abc,\xe2\x80\x892]\xe2\x80\x89=\xe2\x80\x89abcabc.We\'ll say that string s can be obtained from string t, if we can remove some characters from string t and obtain string s. For example, strings ab and a\xd1\x81ba can be obtained from string xacbac, and strings bx and aaa cannot be obtained from it.Sereja has two strings, w\xe2\x80\x89=\xe2\x80\x89[a,\xe2\x80\x89b] and q\xe2\x80\x89=\xe2\x80\x89[c,\xe2\x80\x89d]. He wants to find such maximum integer p (p\xe2\x80\x89>\xe2\x80\x890), that [q,\xe2\x80\x89p] can be obtained from string w." 2000

314A "Sereja and Contest" implementation "During the last Sereja\'s Codesecrof round the server crashed many times, so the round was decided to be made unrated for some participants. Let\'s assume that n people took part in the contest. Let\'s assume that the participant who got the first place has rating a1, the second place participant has rating a2, ..., the n-th place participant has rating an. Then changing the rating on the Codesecrof site is calculated by the formula .After the round was over, the Codesecrof management published the participants\' results table. They decided that if for a participant di\xe2\x80\x89<\xe2\x80\x89k, then the round can be considered unrated for him. But imagine the management\'s surprise when they found out that the participants\' rating table is dynamic. In other words, when some participant is removed from the rating, he is removed from the results\' table and the rating is recalculated according to the new table. And of course, all applications for exclusion from the rating are considered in view of the current table.We know that among all the applications for exclusion from the rating the first application to consider is from the participant with the best rank (the rank with the minimum number), for who di\xe2\x80\x89<\xe2\x80\x89k. We also know that the applications for exclusion from rating were submitted by all participants.Now Sereja wonders, what is the number of participants to be excluded from the contest rating, and the numbers of the participants in the original table in the order of their exclusion from the rating. Pay attention to the analysis of the first test case for a better understanding of the statement." 1600

313E "Ilya and Two Numbers" "constructive algorithms,data structures,dsu,greedy" "Ilya has recently taken up archaeology. He\'s recently found two numbers, written in the m-based notation. Each of the found numbers consisted of exactly n digits. Ilya immediately started looking for information about those numbers. He learned that the numbers are part of a cyphered code and the one who can decypher it can get the greatest treasure.After considerable research Ilya understood that to decypher the code, he should do the following:  Rearrange digits in the first number in some manner. Similarly, rearrange digits in the second number in some manner. As a result of this operation, the numbers can get leading zeroes.  Add numbers, digit by digit, modulo m. In other words, we need to get the third number of length n, each digit of the number is the sum of the respective numbers of the found numbers. For example, suppose there are two numbers recorded in the ternary notation, 001210 and 012111, then if you add them to each other digit by digit modulo 3, you will get number 010021.  The key to the code is the maximum possible number that can be obtained in the previous step. Help Ilya, find the key to the code." 2300

313D "Ilya and Roads" dp "Everything is great about Ilya\'s city, except the roads. The thing is, the only ZooVille road is represented as n holes in a row. We will consider the holes numbered from 1 to n, from left to right.Ilya is really keep on helping his city. So, he wants to fix at least k holes (perharps he can fix more) on a single ZooVille road. The city has m building companies, the i-th company needs ci money units to fix a road segment containing holes with numbers of at least li and at most ri. The companies in ZooVille are very greedy, so, if they fix a segment containing some already fixed holes, they do not decrease the price for fixing the segment. Determine the minimum money Ilya will need to fix at least k holes." 2100

313C "Ilya and Matrix" "constructive algorithms,greedy,implementation,sortings" "Ilya is a very good-natured lion. He likes maths. Of all mathematical objects, his favourite one is matrices. Now he\'s faced a complicated matrix problem he needs to solve.He\'s got a square 2n\xe2\x80\x89\xc3\x97\xe2\x80\x892n-sized matrix and 4n integers. You need to arrange all these numbers in the matrix (put each number in a single individual cell) so that the beauty of the resulting matrix with numbers is maximum.The beauty of a 2n\xe2\x80\x89\xc3\x97\xe2\x80\x892n-sized matrix is an integer, obtained by the following algorithm:  Find the maximum element in the matrix. Let\'s denote it as m.  If n\xe2\x80\x89=\xe2\x80\x890, then the beauty of the matrix equals m. Otherwise, a matrix can be split into 4 non-intersecting 2n\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89\xc3\x97\xe2\x80\x892n\xe2\x80\x89-\xe2\x80\x891-sized submatrices, then the beauty of the matrix equals the sum of number m and other four beauties of the described submatrices. As you can see, the algorithm is recursive.Help Ilya, solve the problem and print the resulting maximum beauty of the matrix." 1400

313B "Ilya and Queries" dp,implementation "Ilya the Lion wants to help all his friends with passing exams. They need to solve the following problem to pass the IT exam.You\'ve got string s\xe2\x80\x89=\xe2\x80\x89s1s2... sn (n is the length of the string), consisting only of characters ""."" and ""#"" and m queries. Each query is described by a pair of integers li,\xe2\x80\x89ri (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89li\xe2\x80\x89<\xe2\x80\x89ri\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n). The answer to the query li,\xe2\x80\x89ri is the number of such integers i (li\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89ri), that si\xe2\x80\x89=\xe2\x80\x89si\xe2\x80\x89+\xe2\x80\x891.Ilya the Lion wants to help his friends but is there anyone to help him? Help Ilya, solve the problem." 1100

313A "Ilya and Bank Account" "implementation,number theory" "Ilya is a very clever lion, he lives in an unusual city ZooVille. In this city all the animals have their rights and obligations. Moreover, they even have their own bank accounts. The state of a bank account is an integer. The state of a bank account can be a negative number. This means that the owner of the account owes the bank money.Ilya the Lion has recently had a birthday, so he got a lot of gifts. One of them (the gift of the main ZooVille bank) is the opportunity to delete the last digit or the digit before last from the state of his bank account no more than once. For example, if the state of Ilya\'s bank account is -123, then Ilya can delete the last digit and get his account balance equal to -12, also he can remove its digit before last and get the account balance equal to -13. Of course, Ilya is permitted not to use the opportunity to delete a digit from the balance.Ilya is not very good at math, and that\'s why he asks you to help him maximize his bank account. Find the maximum state of the bank account that can be obtained using the bank\'s gift." 900

312B Archer math,probabilities "SmallR is an archer. SmallR is taking a match of archer with Zanoes. They try to shoot in the target in turns, and SmallR shoots first. The probability of shooting the target each time is  for SmallR while  for Zanoes. The one who shoots in the target first should be the winner.Output the probability that SmallR will win the match." 1300

312A "Whose sentence is it?" implementation,strings "One day, liouzhou_101 got a chat record of Freda and Rainbow. Out of curiosity, he wanted to know which sentences were said by Freda, and which were said by Rainbow. According to his experience, he thought that Freda always said ""lala."" at the end of her sentences, while Rainbow always said ""miao."" at the beginning of his sentences. For each sentence in the chat record, help liouzhou_101 find whose sentence it is." 1100

311E Biologist flows "SmallR is a biologist. Her latest research finding is how to change the sex of dogs. In other words, she can change female dogs into male dogs and vice versa.She is going to demonstrate this technique. Now SmallR has n dogs, the costs of each dog\'s change may be different. The dogs are numbered from 1 to n. The cost of change for dog i is vi RMB. By the way, this technique needs a kind of medicine which can be valid for only one day. So the experiment should be taken in one day and each dog can be changed at most once.This experiment has aroused extensive attention from all sectors of society. There are m rich folks which are suspicious of this experiment. They all want to bet with SmallR forcibly. If SmallR succeeds, the i-th rich folk will pay SmallR wi RMB. But it\'s strange that they have a special method to determine whether SmallR succeeds. For i-th rich folk, in advance, he will appoint certain ki dogs and certain one gender. He will think SmallR succeeds if and only if on some day the ki appointed dogs are all of the appointed gender. Otherwise, he will think SmallR fails.If SmallR can\'t satisfy some folk that isn\'t her friend, she need not pay him, but if someone she can\'t satisfy is her good friend, she must pay g RMB to him as apologies for her fail.Then, SmallR hope to acquire money as much as possible by this experiment. Please figure out the maximum money SmallR can acquire. By the way, it is possible that she can\'t obtain any money, even will lose money. Then, please give out the minimum money she should lose." 2300

311D "Interval Cubing" "data structures,math" "While learning Computational Geometry, Tiny is simultaneously learning a useful data structure called segment tree or interval tree. He has scarcely grasped it when comes out a strange problem:Given an integer sequence a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. You should run q queries of two types:  Given two integers l and r (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n), ask the sum of all elements in the sequence al,\xe2\x80\x89al\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89ar.  Given two integers l and r (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n), let each element x in the sequence al,\xe2\x80\x89al\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89ar becomes x3. In other words, apply an assignments al\xe2\x80\x89=\xe2\x80\x89al3,\xe2\x80\x89al\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89=\xe2\x80\x89al\xe2\x80\x89+\xe2\x80\x8913,\xe2\x80\x89...,\xe2\x80\x89ar\xe2\x80\x89=\xe2\x80\x89ar3. For every query of type 1, output the answer to it.Tiny himself surely cannot work it out, so he asks you for help. In addition, Tiny is a prime lover. He tells you that because the answer may be too huge, you should only output it modulo 95542721 (this number is a prime number)." 2600

311C "Fetch the Treasure" "brute force,data structures,graphs,shortest paths" "Rainbow built h cells in a row that are numbered from 1 to h from left to right. There are n cells with treasure. We call each of these n cells ""Treasure Cell"". The i-th ""Treasure Cell"" is the ai-th cell and the value of treasure in it is ci dollars.Then, Freda went in the first cell. For now, she can go just k cells forward, or return to the first cell. That means Freda was able to reach the 1st, (k\xe2\x80\x89+\xe2\x80\x891)-th, (2\xc2\xb7k\xe2\x80\x89+\xe2\x80\x891)-th, (3\xc2\xb7k\xe2\x80\x89+\xe2\x80\x891)-th cells and so on.Then Rainbow gave Freda m operations. Each operation is one of the following three types:  Add another method x: she can also go just x cells forward at any moment. For example, initially she has only one method k. If at some moment she has methods a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89ar then she can reach all the cells with number in form , where vi \xe2\x80\x94 some non-negative integer.  Reduce the value of the treasure in the x-th ""Treasure Cell"" by y dollars. In other words, to apply assignment cx\xe2\x80\x89=\xe2\x80\x89cx\xe2\x80\x89-\xe2\x80\x89y.  Ask the value of the most valuable treasure among the cells Freda can reach. If Freda cannot reach any cell with the treasure then consider the value of the most valuable treasure equal to 0, and do nothing. Otherwise take the most valuable treasure away. If several ""Treasure Cells"" have the most valuable treasure, take the ""Treasure Cell"" with the minimum number (not necessarily with the minimum number of cell). After that the total number of cells with a treasure is decreased by one. As a programmer, you are asked by Freda to write a program to answer each query." 2500

311B "Cats Transport" "data structures,dp" "Zxr960115 is owner of a large farm. He feeds m cute cats and employs p feeders. There\'s a straight road across the farm and n hills along the road, numbered from 1 to n from left to right. The distance between hill i and (i\xe2\x80\x89-\xe2\x80\x891) is di meters. The feeders live in hill 1.One day, the cats went out to play. Cat i went on a trip to hill hi, finished its trip at time ti, and then waited at hill hi for a feeder. The feeders must take all the cats. Each feeder goes straightly from hill 1 to n without waiting at a hill and takes all the waiting cats at each hill away. Feeders walk at a speed of 1 meter per unit time and are strong enough to take as many cats as they want.For example, suppose we have two hills (d2\xe2\x80\x89=\xe2\x80\x891) and one cat that finished its trip at time 3 at hill 2 (h1\xe2\x80\x89=\xe2\x80\x892). Then if the feeder leaves hill 1 at time 2 or at time 3, he can take this cat, but if he leaves hill 1 at time 1 he can\'t take it. If the feeder leaves hill 1 at time 2, the cat waits him for 0 time units, if the feeder leaves hill 1 at time 3, the cat waits him for 1 time units.Your task is to schedule the time leaving from hill 1 for each feeder so that the sum of the waiting time of all cats is minimized." 2400

311A "The Closest Pair" "constructive algorithms,implementation" "Currently Tiny is learning Computational Geometry. When trying to solve a problem called ""The Closest Pair Of Points In The Plane"", he found that a code which gave a wrong time complexity got Accepted instead of Time Limit Exceeded.The problem is the follows. Given n points in the plane, find a pair of points between which the distance is minimized. Distance between (x1,\xe2\x80\x89y1) and (x2,\xe2\x80\x89y2) is .The pseudo code of the unexpected code is as follows:input nfor i from 1 to n    input the i-th point\'s coordinates into p[i]sort array p[] by increasing of x coordinate first and increasing of y coordinate secondd=INF        //here INF is a number big enoughtot=0for i from 1 to n    for j from (i+1) to n        ++tot        if (p[j].x-p[i].x>=d) then break    //notice that ""break"" is only to be                                            //out of the loop ""for j""        d=min(d,distance(p[i],p[j]))output dHere, tot can be regarded as the running time of the code. Due to the fact that a computer can only run a limited number of operations per second, tot should not be more than k in order not to get Time Limit Exceeded.You are a great hacker. Would you please help Tiny generate a test data and let the code get Time Limit Exceeded?" 1300

309E Sheep "binary search,greedy" "Information technologies are developing and are increasingly penetrating into all spheres of human activity. Incredible as it is, the most modern technology are used in farming!A large farm has a meadow with grazing sheep. Overall there are n sheep and each of them contains a unique number from 1 to n \xe2\x80\x94 because the sheep need to be distinguished and you need to remember information about each one, and they are so much alike! The meadow consists of infinite number of regions numbered from 1 to infinity. It\'s known that sheep i likes regions from li to ri.There are two shepherds taking care of the sheep: First and Second. First wakes up early in the morning and leads the sheep graze on the lawn. Second comes in the evening and collects all the sheep.One morning, First woke up a little later than usual, and had no time to lead the sheep graze on the lawn. So he tied together every two sheep if there is a region they both like. First thought that it would be better \xe2\x80\x94 Second would have less work in the evening, because sheep won\'t scatter too much, being tied to each other!In the evening Second came on the lawn, gathered the sheep and tried to line them up in a row. But try as he might, the sheep wouldn\'t line up as Second want! Second had neither the strength nor the ability to untie the sheep so he left them as they are, but with one condition: he wanted to line up the sheep so that the maximum distance between two tied sheep was as small as possible. The distance between the sheep is the number of sheep in the ranks that are between these two.Help Second find the right arrangement." 2900

309D "Tennis Rackets" "brute force,geometry" "Professional sport is more than hard work. It also is the equipment, designed by top engineers. As an example, let\'s take tennis. Not only should you be in great shape, you also need an excellent racket! In this problem your task is to contribute to the development of tennis and to help to design a revolutionary new concept of a racket!The concept is a triangular racket. Ant it should be not just any triangle, but a regular one. As soon as you\'ve chosen the shape, you need to stretch the net. By the time you came the rocket had n holes drilled on each of its sides. The holes divide each side into equal n\xe2\x80\x89+\xe2\x80\x891 parts. At that, the m closest to each apex holes on each side are made for better ventilation only and you cannot stretch the net through them. The next revolutionary idea as to stretch the net as obtuse triangles through the holes, so that for each triangle all apexes lay on different sides. Moreover, you need the net to be stretched along every possible obtuse triangle. That\'s where we need your help \xe2\x80\x94 help us to count the number of triangles the net is going to consist of.Two triangles are considered to be different if their pictures on the fixed at some position racket are different." 2700

309C "Memory for Arrays" "binary search,bitmasks,greedy" "You get to work and turn on the computer. You start coding and give little thought to the RAM role in the whole process. In this problem your task is to solve one of the problems you encounter in your computer routine.We\'ll consider the RAM as a sequence of cells that can contain data. Some cells already contain some data, some are empty. The empty cells form the so-called memory clusters. Thus, a memory cluster is a sequence of some consecutive empty memory cells. You have exactly n memory clusters, the i-th cluster consists of ai cells. You need to find memory for m arrays in your program. The j-th array takes 2bj consecutive memory cells. There possibly isn\'t enough memory for all m arrays, so your task is to determine what maximum number of arrays can be located in the available memory clusters. Of course, the arrays cannot be divided between the memory clusters. Also, no cell can belong to two arrays." 1900

309B "Context Advertising" "dp,two pointers" "Advertising has become part of our routine. And now, in the era of progressive technologies, we need your ideas to make advertising better!In this problem we\'ll look at a simplified version of context advertising. You\'ve got a text, consisting of exactly n words. A standard advertising banner has exactly r lines, each line can contain at most c characters. The potential customer always likes it when they can see lots of advertising, so you should determine which maximum number of consecutive words from the text can be written on the banner. Single words in one line of the banner should be separated by spaces. You are allowed to insert more than one space at once. Note that you are not allowed to break the words, that is, each word in the text must occupy exactly one line in the banner. Besides, you cannot change the word order, that is, if you read the banner text consecutively, from top to bottom and from left to right, you should get some consecutive part of the advertisement text.More formally, the statement can be written like that. Let\'s say that all words are indexed from 1 to n in the order in which they occur in the advertisement text. Then you have to choose all words, starting from some i-th one and ending with some j-th one (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n), so that all of them could be written on the banner. There must be as many words as possible. See the samples for clarifications." 2100

309A "Morning run" "binary search,math,two pointers" "People like to be fit. That\'s why many of them are ready to wake up at dawn, go to the stadium and run. In this problem your task is to help a company design a new stadium. The city of N has a shabby old stadium. Many people like it and every morning thousands of people come out to this stadium to run. The stadium can be represented as a circle, its length is exactly l meters with a marked start line. However, there can\'t be simultaneous start in the morning, so exactly at 7, each runner goes to his favorite spot on the stadium and starts running from there. Note that not everybody runs in the same manner as everybody else. Some people run in the clockwise direction, some of them run in the counter-clockwise direction. It mostly depends on the runner\'s mood in the morning, so you can assume that each running direction is equiprobable for each runner in any fixed morning. The stadium is tiny and is in need of major repair, for right now there only is one running track! You can\'t get too playful on a single track, that\'s why all runners keep the same running speed \xe2\x80\x94 exactly 1 meter per a time unit. Nevertheless, the runners that choose different directions bump into each other as they meet. The company wants to design a new stadium, but they first need to know how bad the old one is. For that they need the expectation of the number of bumpings by t time units after the running has begun. Help the company count the required expectation. Note that each runner chooses a direction equiprobably, independently from the others and then all runners start running simultaneously at 7 a.m. Assume that each runner runs for t time units without stopping. Consider the runners to bump at a certain moment if at that moment they found themselves at the same point in the stadium. A pair of runners can bump more than once." 2000

306D Polygon "constructive algorithms,geometry" "Polycarpus loves convex polygons, especially if all their angles are the same and all their sides are different. Draw for him any such polygon with the given number of vertexes." 2300

306C "White, Black and White Again" "combinatorics,number theory" "Polycarpus is sure that his life fits the description: ""first there is a white stripe, then a black one, then a white one again"". So, Polycarpus is sure that this rule is going to fulfill during the next n days. Polycarpus knows that he is in for w good events and b not-so-good events. At least one event is going to take place during each day. As each day is unequivocally characterizes as a part of a white or a black stripe, then each day is going to have events of the same type only (ether good or not-so-good).What is the number of distinct ways this scenario can develop over the next n days if Polycarpus is in for a white stripe (a stripe that has good events only, the stripe\'s length is at least 1 day), the a black stripe (a stripe that has not-so-good events only, the stripe\'s length is at least 1 day) and a white stripe again (a stripe that has good events only, the stripe\'s length is at least 1 day). Each of n days will belong to one of the three stripes only.Note that even the events of the same type are distinct from each other. Even if some events occur on the same day, they go in some order (there are no simultaneous events).Write a code that prints the number of possible configurations to sort the events into days. See the samples for clarifications on which scenarios should be considered distinct. Print the answer modulo 1000000009 (109\xe2\x80\x89+\xe2\x80\x899)." 2100

306B Optimizer "data structures,greedy,sortings" "A process RAM is a sequence of bytes that are indexed from 1 to n. Polycarpus\'s program contains such instructions as ""memset"", that is, the operations of filling memory cells on a segment with some value. The details are: the code only contains m instructions that look like ""set13 a_i l_i"". Instruction i fills a continuous memory segment of length li, starting from cell number ai, (that it cells with numbers ai,\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x89li\xe2\x80\x89-\xe2\x80\x891) with values 13.In Polycarpus\'s code, the optimizer\'s task is to remove the maximum number of instructions from his code in such a way that the remaining instructions set value 13 in all the memory bytes that got this value from the code before the optimization. Also, the value 13 should be set only in the memory bytes that got this value from the code before the optimization. Your task is to implement the optimizer for such program." 2100

306A Candies implementation "Polycarpus has got n candies and m friends (n\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89m). He wants to make a New Year present with candies to each friend. Polycarpus is planning to present all candies and he wants to do this in the fairest (that is, most equal) manner. He wants to choose such ai, where ai is the number of candies in the i-th friend\'s present, that the maximum ai differs from the least ai as little as possible.For example, if n is divisible by m, then he is going to present the same number of candies to all his friends, that is, the maximum ai won\'t differ from the minimum one." 800

305E "Playing with String" games "Two people play the following string game. Initially the players have got some string s. The players move in turns, the player who cannot make a move loses. Before the game began, the string is written on a piece of paper, one letter per cell.  An example of the initial situation at s = ""abacaba"" A player\'s move is the sequence of actions:  The player chooses one of the available pieces of paper with some string written on it. Let\'s denote it is t. Note that initially, only one piece of paper is available.  The player chooses in the string t\xe2\x80\x89=\xe2\x80\x89t1t2... t|t| character in position i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|t|) such that for some positive integer l (0\xe2\x80\x89<\xe2\x80\x89i\xe2\x80\x89-\xe2\x80\x89l;�i\xe2\x80\x89+\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|t|) the following equations hold: ti\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89=\xe2\x80\x89ti\xe2\x80\x89+\xe2\x80\x891, ti\xe2\x80\x89-\xe2\x80\x892\xe2\x80\x89=\xe2\x80\x89ti\xe2\x80\x89+\xe2\x80\x892, ..., ti\xe2\x80\x89-\xe2\x80\x89l\xe2\x80\x89=\xe2\x80\x89ti\xe2\x80\x89+\xe2\x80\x89l.  Player cuts the cell with the chosen character. As a result of the operation, he gets three new pieces of paper, the first one will contain string t1t2... ti\xe2\x80\x89-\xe2\x80\x891, the second one will contain a string consisting of a single character ti, the third one contains string ti\xe2\x80\x89+\xe2\x80\x891ti\xe2\x80\x89+\xe2\x80\x892... t|t|.   An example of making action (i\xe2\x80\x89=\xe2\x80\x894) with string s = \xc2\xababacaba\xc2\xbb Your task is to determine the winner provided that both players play optimally well. If the first player wins, find the position of character that is optimal to cut in his first move. If there are multiple positions, print the minimal possible one." 2300

305D "Olya and Graph" combinatorics,math "Olya has got a directed non-weighted graph, consisting of n vertexes and m edges. We will consider that the graph vertexes are indexed from 1 to n in some manner. Then for any graph edge that goes from vertex v to vertex u the following inequation holds: v\xe2\x80\x89<\xe2\x80\x89u.Now Olya wonders, how many ways there are to add an arbitrary (possibly zero) number of edges to the graph so as the following conditions were met:  You can reach vertexes number i\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89i\xe2\x80\x89+\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89n from any vertex number i (i\xe2\x80\x89<\xe2\x80\x89n).  For any graph edge going from vertex v to vertex u the following inequation fulfills: v\xe2\x80\x89<\xe2\x80\x89u.  There is at most one edge between any two vertexes.  The shortest distance between the pair of vertexes i,\xe2\x80\x89j (i\xe2\x80\x89<\xe2\x80\x89j), for which j\xe2\x80\x89-\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k holds, equals j\xe2\x80\x89-\xe2\x80\x89i edges.  The shortest distance between the pair of vertexes i,\xe2\x80\x89j (i\xe2\x80\x89<\xe2\x80\x89j), for which j\xe2\x80\x89-\xe2\x80\x89i\xe2\x80\x89>\xe2\x80\x89k holds, equals either j\xe2\x80\x89-\xe2\x80\x89i or j\xe2\x80\x89-\xe2\x80\x89i\xe2\x80\x89-\xe2\x80\x89k edges.  We will consider two ways distinct, if there is the pair of vertexes i,\xe2\x80\x89j (i\xe2\x80\x89<\xe2\x80\x89j), such that first resulting graph has an edge from i to j and the second one doesn\'t have it.Help Olya. As the required number of ways can be rather large, print it modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." 2200

305C "Ivan and Powers of Two" greedy,implementation "Ivan has got an array of n non-negative integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. Ivan knows that the array is sorted in the non-decreasing order. Ivan wrote out integers 2a1,\xe2\x80\x892a2,\xe2\x80\x89...,\xe2\x80\x892an on a piece of paper. Now he wonders, what minimum number of integers of form 2b (b\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x890) need to be added to the piece of paper so that the sum of all integers written on the paper equalled 2v\xe2\x80\x89-\xe2\x80\x891 for some integer v (v\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x890). Help Ivan, find the required quantity of numbers." 1600

305B "Continued Fractions" "brute force,implementation,math" "A continued fraction of height n is a fraction of form . You are given two rational numbers, one is represented as  and the other one is represented as a finite fraction of height n. Check if they are equal." 1700

305A "Strange Addition" "brute force,constructive algorithms,implementation" "Unfortunately, Vasya can only sum pairs of integers (a, b), such that for any decimal place at least one number has digit 0 in this place. For example, Vasya can sum numbers 505 and 50, but he cannot sum 1 and 4.Vasya has a set of k distinct non-negative integers d1,\xe2\x80\x89d2,\xe2\x80\x89...,\xe2\x80\x89dk.Vasya wants to choose some integers from this set so that he could sum any two chosen numbers. What maximal number of integers can he choose in the required manner?" 1600

304B Calendar "brute force,implementation" "Calendars in widespread use today include the Gregorian calendar, which is the de facto international standard, and is used almost everywhere in the world for civil purposes. The Gregorian reform modified the Julian calendar\'s scheme of leap years as follows: Every year that is exactly divisible by four is a leap year, except for years that are exactly divisible by 100; the centurial years that are exactly divisible by 400 are still leap years. For example, the year 1900 is not a leap year; the year 2000 is a leap year.   In this problem, you have been given two dates and your task is to calculate how many days are between them. Note, that leap years have unusual number of days in February.Look at the sample to understand what borders are included in the aswer." 1300

304A "Pythagorean Theorem II" "brute force,math" "In mathematics, the Pythagorean theorem \xe2\x80\x94 is a relation in Euclidean geometry among the three sides of a right-angled triangle. In terms of areas, it states: \x7fIn any right-angled triangle, the area of the square whose side is the hypotenuse (the side opposite the right angle) is equal to the sum of the areas of the squares whose sides are the two legs (the two sides that meet at a right angle). The theorem can be written as an equation relating the lengths of the sides a, b and c, often called the Pythagorean equation:a2\xe2\x80\x89+\xe2\x80\x89b2\xe2\x80\x89=\xe2\x80\x89c2where c represents the length of the hypotenuse, and a and b represent the lengths of the other two sides.  Given n, your task is to count how many right-angled triangles with side-lengths a, b and c that satisfied an inequality 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89c\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n." 1200

303E "Random Ranking" dp,math,probabilities "Imagine a real contest or exam of n participants. Every participant will get a particular score. We can predict the standings board more or less, if we do some statistics on their previous performance.  Let\'s say the score of the participants will be uniformly distributed in interval [li,\xe2\x80\x89ri] (the score can be a real number). Can you predict the standings board according to these data? In other words you should say for each participant the probability that he gets some fixed place in the scoreboard. The participants are sorted by increasing of their scores in the scoreboard. So, the participant with the largest score gets the last place." 3000

303D "Rotatable Number" "math,number theory" "Bike is a smart boy who loves math very much. He invented a number called ""Rotatable Number"" inspired by 142857. As you can see, 142857 is a magic number because any of its rotatings can be got by multiplying that number by 1,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x896 (numbers from one to number\'s length). Rotating a number means putting its last several digit into first. For example, by rotating number 12345 you can obtain any numbers: 12345,\xe2\x80\x8951234,\xe2\x80\x8945123,\xe2\x80\x8934512,\xe2\x80\x8923451. It\'s worth mentioning that leading-zeroes are allowed. So both 4500123 and 0123450 can be obtained by rotating 0012345. You can see why 142857 satisfies the condition. All of the 6 equations are under base 10.  142857\xc2\xb71\xe2\x80\x89=\xe2\x80\x89142857;  142857\xc2\xb72\xe2\x80\x89=\xe2\x80\x89285714;  142857\xc2\xb73\xe2\x80\x89=\xe2\x80\x89428571;  142857\xc2\xb74\xe2\x80\x89=\xe2\x80\x89571428;  142857\xc2\xb75\xe2\x80\x89=\xe2\x80\x89714285;  142857\xc2\xb76\xe2\x80\x89=\xe2\x80\x89857142. Now, Bike has a problem. He extends ""Rotatable Number"" under any base b. As is mentioned above, 142857 is a ""Rotatable Number"" under base 10. Another example is 0011 under base 2. All of the 4 equations are under base 2.  0011\xc2\xb71\xe2\x80\x89=\xe2\x80\x890011;  0011\xc2\xb710\xe2\x80\x89=\xe2\x80\x890110;  0011\xc2\xb711\xe2\x80\x89=\xe2\x80\x891001;  0011\xc2\xb7100\xe2\x80\x89=\xe2\x80\x891100. So, he wants to find the largest b (1\xe2\x80\x89<\xe2\x80\x89b\xe2\x80\x89<\xe2\x80\x89x) so that there is a positive ""Rotatable Number"" (leading-zeroes allowed) of length n under base b.Note that any time you multiply a rotatable number by numbers from 1 to its length you should get a rotating of that number." 2600

303C "Minimum Modular" "brute force,graphs,math,number theory" "You have been given n distinct integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. You can remove at most k of them. Find the minimum modular m (m\xe2\x80\x89>\xe2\x80\x890), so that for every pair of the remaining integers (ai,\xe2\x80\x89aj), the following unequality holds: ." 2400

303B "Rectangle Puzzle II" implementation,math "You are given a rectangle grid. That grid\'s size is n\xe2\x80\x89\xc3\x97\xe2\x80\x89m. Let\'s denote the coordinate system on the grid. So, each point on the grid will have coordinates \xe2\x80\x94 a pair of integers (x,\xe2\x80\x89y) (0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n,\xe2\x80\x890\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m).Your task is to find a maximum sub-rectangle on the grid (x1,\xe2\x80\x89y1,\xe2\x80\x89x2,\xe2\x80\x89y2) so that it contains the given point (x,\xe2\x80\x89y), and its length-width ratio is exactly (a,\xe2\x80\x89b). In other words the following conditions must hold: 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n, 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m, .The sides of this sub-rectangle should be parallel to the axes. And values x1,\xe2\x80\x89y1,\xe2\x80\x89x2,\xe2\x80\x89y2 should be integers.  If there are multiple solutions, find the rectangle which is closest to (x,\xe2\x80\x89y). Here ""closest"" means the Euclid distance between (x,\xe2\x80\x89y) and the center of the rectangle is as small as possible. If there are still multiple solutions, find the lexicographically minimum one. Here ""lexicographically minimum"" means that we should consider the sub-rectangle as sequence of integers (x1,\xe2\x80\x89y1,\xe2\x80\x89x2,\xe2\x80\x89y2), so we can choose the lexicographically minimum one." 1700

303A "Lucky Permutation Triple" "constructive algorithms,implementation,math" "Bike is interested in permutations. A permutation of length n is an integer sequence such that each integer from 0 to (n\xe2\x80\x89-\xe2\x80\x891) appears exactly once in it. For example, [0,\xe2\x80\x892,\xe2\x80\x891] is a permutation of length 3 while both [0,\xe2\x80\x892,\xe2\x80\x892] and [1,\xe2\x80\x892,\xe2\x80\x893] is not.A permutation triple of permutations of length n (a,\xe2\x80\x89b,\xe2\x80\x89c) is called a Lucky Permutation Triple if and only if . The sign ai denotes the i-th element of permutation a. The modular equality described above denotes that the remainders after dividing ai\xe2\x80\x89+\xe2\x80\x89bi by n and dividing ci by n are equal.Now, he has an integer n and wants to find a Lucky Permutation Triple. Could you please help him?" 1300

302B "Eugeny and Play List" "binary search,implementation,two pointers" "Eugeny loves listening to music. He has n songs in his play list. We know that song number i has the duration of ti minutes. Eugeny listens to each song, perhaps more than once. He listens to song number i ci times. Eugeny\'s play list is organized as follows: first song number 1 plays c1 times, then song number 2 plays c2 times, ..., in the end the song number n plays cn times.Eugeny took a piece of paper and wrote out m moments of time when he liked a song. Now for each such moment he wants to know the number of the song that played at that moment. The moment x means that Eugeny wants to know which song was playing during the x-th minute of his listening to the play list.Help Eugeny and calculate the required numbers of songs." 1200

302A "Eugeny and Array" implementation "Eugeny has array a\xe2\x80\x89=\xe2\x80\x89a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an, consisting of n integers. Each integer ai equals to -1, or to 1. Also, he has m queries:  Query number i is given as a pair of integers li, ri (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89li\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ri\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n).  The response to the query will be integer 1, if the elements of array a can be rearranged so as the sum ali\xe2\x80\x89+\xe2\x80\x89ali\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89ari\xe2\x80\x89=\xe2\x80\x890, otherwise the response to the query will be integer 0. Help Eugeny, answer all his queries." 800

301E "Yaroslav and Arrangements" dp "Yaroslav calls an array of r integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89ar good, if it meets the following conditions: |a1\xe2\x80\x89-\xe2\x80\x89a2|\xe2\x80\x89=\xe2\x80\x891,\xe2\x80\x89|a2\xe2\x80\x89-\xe2\x80\x89a3|\xe2\x80\x89=\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89|ar\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89-\xe2\x80\x89ar|\xe2\x80\x89=\xe2\x80\x891,\xe2\x80\x89|ar\xe2\x80\x89-\xe2\x80\x89a1|\xe2\x80\x89=\xe2\x80\x891, at that . An array of integers b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89br is called great, if it meets the following conditions:  The elements in it do not decrease (bi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89bi\xe2\x80\x89+\xe2\x80\x891).  If the inequalities 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n and 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89bi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m hold.  If we can rearrange its elements and get at least one and at most k distinct good arrays. Yaroslav has three integers n,\xe2\x80\x89m,\xe2\x80\x89k. He needs to count the number of distinct great arrays. Help Yaroslav! As the answer may be rather large, print the remainder after dividing it by 1000000007 (109\xe2\x80\x89+\xe2\x80\x897).Two arrays are considered distinct if there is a position in which they have distinct numbers." 2800

301D "Yaroslav and Divisors" "data structures" "Yaroslav has an array p\xe2\x80\x89=\xe2\x80\x89p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pn (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89pi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n), consisting of n distinct integers. Also, he has m queries:  Query number i is represented as a pair of integers li, ri (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89li\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ri\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n).  The answer to the query li,\xe2\x80\x89ri is the number of pairs of integers q, w (li\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89q,\xe2\x80\x89w\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ri) such that pq is the divisor of pw. Help Yaroslav, answer all his queries." 2200

301C "Yaroslav and Algorithm" "constructive algorithms" "Yaroslav likes algorithms. We\'ll describe one of his favorite algorithms.  The algorithm receives a string as the input. We denote this input string as a.  The algorithm consists of some number of command. \xd0\xa1ommand number i looks either as si >> wi, or as si <> wi, where si and wi are some possibly empty strings of length at most 7, consisting of digits and characters ""?"".  At each iteration, the algorithm looks for a command with the minimum index i, such that si occurs in a as a substring. If this command is not found the algorithm terminates.  Let\'s denote the number of the found command as k. In string a the first occurrence of the string sk is replaced by string wk. If the found command at that had form sk >> wk, then the algorithm continues its execution and proceeds to the next iteration. Otherwise, the algorithm terminates.  The value of string a after algorithm termination is considered to be the output of the algorithm. Yaroslav has a set of n positive integers, he needs to come up with his favorite algorithm that will increase each of the given numbers by one. More formally, if we consider each number as a string representing the decimal representation of the number, then being run on each of these strings separately, the algorithm should receive the output string that is a recording of the corresponding number increased by one.Help Yaroslav." 2500

301B "Yaroslav and Time" "binary search,graphs,shortest paths" "Yaroslav is playing a game called ""Time"". The game has a timer showing the lifespan he\'s got left. As soon as the timer shows 0, Yaroslav\'s character dies and the game ends. Also, the game has n clock stations, station number i is at point (xi,\xe2\x80\x89yi) of the plane. As the player visits station number i, he increases the current time on his timer by ai. The stations are for one-time use only, so if the player visits some station another time, the time on his timer won\'t grow.A player spends d\xc2\xb7dist time units to move between stations, where dist is the distance the player has covered and d is some constant. The distance between stations i and j is determined as |xi\xe2\x80\x89-\xe2\x80\x89xj|\xe2\x80\x89+\xe2\x80\x89|yi\xe2\x80\x89-\xe2\x80\x89yj|.Initially, the player is at station number 1, and the player has strictly more than zero and strictly less than one units of time. At station number 1 one unit of money can increase the time on the timer by one time unit (you can buy only integer number of time units).Now Yaroslav is wondering, how much money he needs to get to station n. Help Yaroslav. Consider the time to buy and to increase the timer value negligibly small." 2100

301A "Yaroslav and Sequence" "constructive algorithms" "Yaroslav has an array, consisting of (2\xc2\xb7n\xe2\x80\x89-\xe2\x80\x891) integers. In a single operation Yaroslav can change the sign of exactly n elements in the array. In other words, in one operation Yaroslav can select exactly n array elements, and multiply each of them by -1.Yaroslav is now wondering: what maximum sum of array elements can be obtained if it is allowed to perform any number of described operations?Help Yaroslav." 1800

300E "Empire Strikes Back" "binary search,math,number theory" "In a far away galaxy there is war again. The treacherous Republic made k precision strikes of power ai on the Empire possessions. To cope with the republican threat, the Supreme Council decided to deal a decisive blow to the enemy forces. To successfully complete the conflict, the confrontation balance after the blow should be a positive integer. The balance of confrontation is a number that looks like , where p\xe2\x80\x89=\xe2\x80\x89n! (n is the power of the Imperial strike), . After many years of war the Empire\'s resources are low. So to reduce the costs, n should be a minimum positive integer that is approved by the commanders.Help the Empire, find the minimum positive integer n, where the described fraction is a positive integer." 2300

300D "Painting Square" dp,fft "Vasily the bear has got a large square white table of n rows and n columns. The table has got a black border around this table.  The example of the initial table at n = 5. Vasily the bear wants to paint his square table in exactly k moves. Each move is sequence of actions:  The bear chooses some square inside his table. At that the square must have a black border painted around it. Also, the square shouldn\'t contain a black cell. The number of cells in the square shouldn\'t be less than 2.  The bear chooses some row and some column inside the chosen square. Then he paints each cell of this row and this column inside the chosen square. After that the rectangles, formed by the square\'s border and the newly painted cells, must be squares of a non-zero area.      An example of correct painting at n = 7 \xd0\xb8 k = 2. The bear already knows numbers n and k. Help him \xe2\x80\x94 find the number of ways to paint the square in exactly k moves. Two ways to paint are called distinct if the resulting tables will differ in at least one cell. As the answer can be rather large, print the remainder after dividing it by 7340033." 2300

300C "Beautiful Numbers" "brute force,combinatorics" "Vitaly is a very weird man. He\'s got two favorite digits a and b. Vitaly calls a positive integer good, if the decimal representation of this integer only contains digits a and b. Vitaly calls a good number excellent, if the sum of its digits is a good number.For example, let\'s say that Vitaly\'s favourite digits are 1 and 3, then number 12 isn\'t good and numbers 13 or 311 are. Also, number 111 is excellent and number 11 isn\'t. Now Vitaly is wondering, how many excellent numbers of length exactly n are there. As this number can be rather large, he asks you to count the remainder after dividing it by 1000000007 (109\xe2\x80\x89+\xe2\x80\x897).A number\'s length is the number of digits in its decimal representation without leading zeroes." 1800

300B Coach "brute force,dfs and similar,graphs" "A programming coach has n students to teach. We know that n is divisible by 3. Let\'s assume that all students are numbered from 1 to n, inclusive.Before the university programming championship the coach wants to split all students into groups of three. For some pairs of students we know that they want to be on the same team. Besides, if the i-th student wants to be on the same team with the j-th one, then the j-th student wants to be on the same team with the i-th one. The coach wants the teams to show good results, so he wants the following condition to hold: if the i-th student wants to be on the same team with the j-th, then the i-th and the j-th students must be on the same team. Also, it is obvious that each student must be on exactly one team.Help the coach and divide the teams the way he wants." 1500

300A Array "brute force,constructive algorithms,implementation" "Vitaly has an array of n distinct integers. Vitaly wants to divide this array into three non-empty sets so as the following conditions hold:   The product of all numbers in the first set is less than zero (\xe2\x80\x89<\xe2\x80\x890).  The product of all numbers in the second set is greater than zero (\xe2\x80\x89>\xe2\x80\x890).  The product of all numbers in the third set is equal to zero.  Each number from the initial array must occur in exactly one set. Help Vitaly. Divide the given array." 1100

299B "Ksusha the Squirrel" "brute force,implementation" "Ksusha the Squirrel is standing at the beginning of a straight road, divided into n sectors. The sectors are numbered 1 to n, from left to right. Initially, Ksusha stands in sector 1. Ksusha wants to walk to the end of the road, that is, get to sector n. Unfortunately, there are some rocks on the road. We know that Ksusha hates rocks, so she doesn\'t want to stand in sectors that have rocks.Ksusha the squirrel keeps fit. She can jump from sector i to any of the sectors i\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89i\xe2\x80\x89+\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89i\xe2\x80\x89+\xe2\x80\x89k. Help Ksusha! Given the road description, say if she can reach the end of the road (note, she cannot stand on a rock)?" 900

299A "Ksusha and Array" "brute force,number theory,sortings" "Ksusha is a beginner coder. Today she starts studying arrays. She has array a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an, consisting of n positive integers.Her university teacher gave her a task. Find such number in the array, that all array elements are divisible by it. Help her and find the number!" 1000

298B Sail "brute force,greedy,implementation" "The polar bears are going fishing. They plan to sail from (sx,\xe2\x80\x89sy) to (ex,\xe2\x80\x89ey). However, the boat can only sail by wind. At each second, the wind blows in one of these directions: east, south, west or north. Assume the boat is currently at (x,\xe2\x80\x89y).  If the wind blows to the east, the boat will move to (x\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89y).  If the wind blows to the south, the boat will move to (x,\xe2\x80\x89y\xe2\x80\x89-\xe2\x80\x891).  If the wind blows to the west, the boat will move to (x\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89y).  If the wind blows to the north, the boat will move to (x,\xe2\x80\x89y\xe2\x80\x89+\xe2\x80\x891). Alternatively, they can hold the boat by the anchor. In this case, the boat stays at (x,\xe2\x80\x89y). Given the wind direction for t seconds, what is the earliest time they sail to (ex,\xe2\x80\x89ey)?" 1200

298A "Snow Footprints" greedy,implementation "There is a straight snowy road, divided into n blocks. The blocks are numbered from 1 to n from left to right. If one moves from the i-th block to the (i\xe2\x80\x89+\xe2\x80\x891)-th block, he will leave a right footprint on the i-th block. Similarly, if one moves from the i-th block to the (i\xe2\x80\x89-\xe2\x80\x891)-th block, he will leave a left footprint on the i-th block. If there already is a footprint on the i-th block, the new footprint will cover the old one.  At the beginning, there were no footprints. Then polar bear Alice starts from the s-th block, makes a sequence of moves and ends in the t-th block. It is known that Alice never moves outside of the road. You are given the description of Alice\'s footprints. Your task is to find a pair of possible values of s,\xe2\x80\x89t by looking at the footprints." 1300

297E "Mystic Carvings" "data structures" "The polar bears have discovered a gigantic circular piece of floating ice with some mystic carvings on it. There are n lines carved on the ice. Each line connects two points on the boundary of the ice (we call these points endpoints). The endpoints are numbered 1,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x892n counter-clockwise along the circumference. No two lines share an endpoint.Now a group of 6 polar bears (Alice, Bob, Carol, Dave, Eve, Frank) are going to build caves on the endpoints. Each polar bear would build a cave and live in it. No two polar bears can build a cave on the same endpoints. Alice and Bob is a pair of superstitious lovers. They believe the lines are carved by aliens (or humans, which are pretty much the same thing to polar bears), and have certain spiritual power. Therefore they want to build their caves on two endpoints which are connected by a line. The same for Carol and Dave, Eve and Frank.The distance between two caves X and Y is defined as one plus minimum number of other caves one need to pass through in order to travel from X to Y along the boundary of the ice (endpoints without caves are not counted).To ensure fairness, the distances between the three pairs of lovers have to be the same (that is, the distance between Alice and Bob, the distance between Carol and Dave, and the distance between Eve and Frank are the same).The figures below show two different configurations, where the dots on the circle are the endpoints. The configuration on the left is not valid. Although each pair of lovers (A and B, C and D, E and F) is connected a line, the distance requirement is not satisfied. The distance between A and B is 2 (one can go from A to B in the clockwise direction passing through F). The distance between E and F is also 2. However, the distance between C and D is 1 (one can go from C to D in the counter-clockwise direction without passing through any other caves). The configuration on the right is valid. All three pairs have the same distance 1.  Count the number of ways to build the caves under the requirements. Two configurations are considered the same if the same set of 6 endpoints are used." 3000

297D "Color the Carpet" "constructive algorithms" "Even polar bears feel cold when lying on the ice. Therefore, a polar bear Alice is going to make a carpet. The carpet can be viewed as a grid with height h and width w. Then the grid is divided into h\xe2\x80\x89\xc3\x97\xe2\x80\x89w squares. Alice is going to assign one of k different colors to each square. The colors are numbered from 1 to k. She may choose not to use all of the colors.However, there are some restrictions. For every two adjacent squares (squares that shares an edge) x and y, there is a color constraint in one of the forms:   color(x)\xe2\x80\x89=\xe2\x80\x89color(y), or  color(x)\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89color(y). Example of the color constraints:  Ideally, Alice wants to satisfy all color constraints. But again, life in the Arctic is hard. It is not always possible to satisfy all color constraints. Fortunately, she will still be happy if at least  of the color constraints are satisfied. If she has 4 colors she can color the carpet in the following way:  And she is happy because  of the color constraints are satisfied, and . Your task is to help her color the carpet." 2500

297C "Splitting the Uniqueness" "constructive algorithms" "Polar bears like unique arrays \xe2\x80\x94 that is, arrays without repeated elements. You have got a unique array s with length n containing non-negative integers. Since you are good friends with Alice and Bob, you decide to split the array in two. Precisely, you need to construct two arrays a and b that are also of length n, with the following conditions for all i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n):  ai,\xe2\x80\x89bi are non-negative integers;  si\xe2\x80\x89=\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x89bi . Ideally, a and b should also be unique arrays. However, life in the Arctic is hard and this is not always possible. Fortunately, Alice and Bob are still happy if their arrays are almost unique. We define an array of length n to be almost unique, if and only if it can be turned into a unique array by removing no more than  entries.For example, the array [1,\xe2\x80\x892,\xe2\x80\x891,\xe2\x80\x893,\xe2\x80\x892] is almost unique because after removing the first two entries, it becomes [1,\xe2\x80\x893,\xe2\x80\x892]. The array [1,\xe2\x80\x892,\xe2\x80\x891,\xe2\x80\x893,\xe2\x80\x891,\xe2\x80\x892] is not almost unique because we need to remove at least 3 entries to turn it into a unique array.So, your task is to split the given unique array s into two almost unique arrays a and b." 2400

297B "Fish Weight" "constructive algorithms,greedy" "It is known that there are k fish species in the polar ocean, numbered from 1 to k. They are sorted by non-decreasing order of their weight, which is a positive number. Let the weight of the i-th type of fish be wi, then 0\xe2\x80\x89<\xe2\x80\x89w1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89w2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89...\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89wk holds.Polar bears Alice and Bob each have caught some fish, and they are guessing who has the larger sum of weight of the fish he/she\'s caught. Given the type of the fish they\'ve caught, determine whether it is possible that the fish caught by Alice has a strictly larger total weight than Bob\'s. In other words, does there exist a sequence of weights wi (not necessary integers), such that the fish caught by Alice has a strictly larger total weight?" 1600

297A "Parity Game" "constructive algorithms" "You are fishing with polar bears Alice and Bob. While waiting for the fish to bite, the polar bears get bored. They come up with a game. First Alice and Bob each writes a 01-string (strings that only contain character ""0"" and ""1"") a and b. Then you try to turn a into b using two types of operations:  Write parity(a) to the end of a. For example, .  Remove the first character of a. For example, . You cannot perform this operation if a is empty. You can use as many operations as you want. The problem is, is it possible to turn a into b?The parity of a 01-string is 1 if there is an odd number of ""1""s in the string, and 0 otherwise." 1700

296B "Yaroslav and Two Strings" combinatorics,dp "Yaroslav thinks that two strings s and w, consisting of digits and having length n are non-comparable if there are two numbers, i and j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i,\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n), such that si\xe2\x80\x89>\xe2\x80\x89wi and sj\xe2\x80\x89<\xe2\x80\x89wj. Here sign si represents the i-th digit of string s, similarly, wj represents the j-th digit of string w.A string\'s template is a string that consists of digits and question marks (""?"").Yaroslav has two string templates, each of them has length n. Yaroslav wants to count the number of ways to replace all question marks by some integers in both templates, so as to make the resulting strings incomparable. Note that the obtained strings can contain leading zeroes and that distinct question marks can be replaced by distinct or the same integers.Help Yaroslav, calculate the remainder after dividing the described number of ways by 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." 2000

296A "Yaroslav and Permutations" greedy,math "Yaroslav has an array that consists of n integers. In one second Yaroslav can swap two neighboring array elements. Now Yaroslav is wondering if he can obtain an array where any two neighboring elements would be distinct in a finite time.Help Yaroslav." 1100

295E "Yaroslav and Points" "data structures" "Yaroslav has n points that lie on the Ox axis. The coordinate of the first point is x1, the coordinate of the second point is x2, ..., the coordinate of the n-th point is \xe2\x80\x94 xn. Now Yaroslav wants to execute m queries, each of them is of one of the two following types:  Move the pj-th point from position xpj to position xpj\xe2\x80\x89+\xe2\x80\x89dj. At that, it is guaranteed that after executing such query all coordinates of the points will be distinct.  Count the sum of distances between all pairs of points that lie on the segment [lj,\xe2\x80\x89rj] (lj\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89rj). In other words, you should count the sum of: . Help Yaroslav." 2500

295D "Greg and Caves" combinatorics,dp "Greg has a pad. The pad\'s screen is an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m rectangle, each cell can be either black or white. We\'ll consider the pad rows to be numbered with integers from 1 to n from top to bottom. Similarly, the pad\'s columns are numbered with integers from 1 to m from left to right.Greg thinks that the pad\'s screen displays a cave if the following conditions hold:  There is a segment [l,\xe2\x80\x89r] (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n), such that each of the rows l,\xe2\x80\x89l\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89r has exactly two black cells and all other rows have only white cells.  There is a row number t (l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89t\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r), such that for all pairs of rows with numbers i and j (l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89t) the set of columns between the black cells in row i (with the columns where is these black cells) is the subset of the set of columns between the black cells in row j (with the columns where is these black cells). Similarly, for all pairs of rows with numbers i and j (t\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r) the set of columns between the black cells in row j (with the columns where is these black cells) is the subset of the set of columns between the black cells in row i (with the columns where is these black cells). Greg wondered, how many ways there are to paint a cave on his pad. Two ways can be considered distinct if there is a cell that has distinct colors on the two pictures.Help Greg." 2400

295C "Greg and Friends" "combinatorics,dp,graphs,shortest paths" "One day Greg and his friends were walking in the forest. Overall there were n people walking, including Greg. Soon he found himself in front of a river. The guys immediately decided to get across the river. Luckily, there was a boat by the river bank, just where the guys were standing. We know that the boat can hold people with the total weight of at most k kilograms.Greg immediately took a piece of paper and listed there the weights of all people in his group (including himself). It turned out that each person weights either 50 or 100 kilograms. Now Greg wants to know what minimum number of times the boat needs to cross the river to transport the whole group to the other bank. The boat needs at least one person to navigate it from one bank to the other. As the boat crosses the river, it can have any non-zero number of passengers as long as their total weight doesn\'t exceed k.Also Greg is wondering, how many ways there are to transport everybody to the other side in the minimum number of boat rides. Two ways are considered distinct if during some ride they have distinct sets of people on the boat.Help Greg with this problem." 2100

295B "Greg and Graph" "dp,graphs,shortest paths" "Greg has a weighed directed graph, consisting of n vertices. In this graph any pair of distinct vertices has an edge between them in both directions. Greg loves playing with the graph and now he has invented a new game:  The game consists of n steps.  On the i-th step Greg removes vertex number xi from the graph. As Greg removes a vertex, he also removes all the edges that go in and out of this vertex.  Before executing each step, Greg wants to know the sum of lengths of the shortest paths between all pairs of the remaining vertices. The shortest path can go through any remaining vertex. In other words, if we assume that d(i,\xe2\x80\x89v,\xe2\x80\x89u) is the shortest path between vertices v and u in the graph that formed before deleting vertex xi, then Greg wants to know the value of the following sum: . Help Greg, print the value of the required sum before each step." 1700

295A "Greg and Array" "data structures,implementation" "Greg has an array a\xe2\x80\x89=\xe2\x80\x89a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an and m operations. Each operation looks as: li, ri, di, (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89li\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ri\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n). To apply operation i to the array means to increase all array elements with numbers li,\xe2\x80\x89li\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89ri by value di.Greg wrote down k queries on a piece of paper. Each query has the following form: xi, yi, (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89xi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89yi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m). That means that one should apply operations with numbers xi,\xe2\x80\x89xi\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89yi to the array.Now Greg is wondering, what the array a will be after all the queries are executed. Help Greg." 1400

294E "Shaass the Great" dp,trees "The great Shaass is the new king of the Drakht empire. The empire has n cities which are connected by n\xe2\x80\x89-\xe2\x80\x891 bidirectional roads. Each road has an specific length and connects a pair of cities. There\'s a unique simple path connecting each pair of cities.His majesty the great Shaass has decided to tear down one of the roads and build another road with the same length between some pair of cities. He should build such road that it\'s still possible to travel from each city to any other city. He might build the same road again.You as his advisor should help him to find a way to make the described action. You should find the way that minimize the total sum of pairwise distances between cities after the action. So calculate the minimum sum." 2300

294D "Shaass and Painter Robot" "brute force,implementation,number theory" "Shaass thinks a kitchen with all white floor tiles is so boring. His kitchen floor is made of n\xc2\xb7m square tiles forming a n\xe2\x80\x89\xc3\x97\xe2\x80\x89m rectangle. Therefore he\'s decided to color some of the tiles in black so that the floor looks like a checkerboard, which is no two side-adjacent tiles should have the same color.Shaass wants to use a painter robot to color the tiles. In the beginning the robot is standing in a border tile (xs,\xe2\x80\x89ys) facing a diagonal direction (i.e. upper-left, upper-right, down-left or down-right). As the robot walks in the kitchen he paints every tile he passes even if it\'s painted before. Painting each tile consumes one unit of black paint. If at any moment the robot hits a wall of the kitchen he changes his direction according the reflection rules. Note that a tile gets painted when the robot enters the tile from another tile, in other words changing direction in the same tile doesn\'t lead to any painting. The first tile the robot is standing on, is also painted.The robot stops painting the first moment the floor is checkered. Given the dimensions of the kitchen and the position of the robot, find out the amount of paint the robot consumes before it stops painting the floor.Let\'s consider an examples depicted below.  If the robot starts at tile number 1 (the tile (1,\xe2\x80\x891)) of the left grid heading to down-right it\'ll pass tiles 1354236 and consumes 7 units of black paint on his way until he stops at tile number 6. But if it starts at tile number 1 in the right grid heading to down-right it will get stuck in a loop painting tiles 1, 2, and 3." 2500

294C "Shaass and Lights" "combinatorics,number theory" "There are n lights aligned in a row. These lights are numbered 1 to n from left to right. Initially some of the lights are switched on. Shaass wants to switch all the lights on. At each step he can switch a light on (this light should be switched off at that moment) if there\'s at least one adjacent light which is already switched on. He knows the initial state of lights and he\'s wondering how many different ways there exist to switch all the lights on. Please find the required number of ways modulo 1000000007�(109\xe2\x80\x89+\xe2\x80\x897)." 1900

294B "Shaass and Bookshelf" dp,greedy "Shaass has n books. He wants to make a bookshelf for all his books. He wants the bookshelf\'s dimensions to be as small as possible. The thickness of the i-th book is ti and its pages\' width is equal to wi. The thickness of each book is either 1 or 2. All books have the same page heights.  Shaass puts the books on the bookshelf in the following way. First he selects some of the books and put them vertically. Then he puts the rest of the books horizontally above the vertical books. The sum of the widths of the horizontal books must be no more than the total thickness of the vertical books. A sample arrangement of the books is depicted in the figure.  Help Shaass to find the minimum total thickness of the vertical books that we can achieve." 1700

294A "Shaass and Oskols" implementation,math "Shaass has decided to hunt some birds. There are n horizontal electricity wires aligned parallel to each other. Wires are numbered 1 to n from top to bottom. On each wire there are some oskols sitting next to each other. Oskol is the name of a delicious kind of birds in Shaass\'s territory. Supposed there are ai oskols sitting on the i-th wire.  Sometimes Shaass shots one of the birds and the bird dies (suppose that this bird sat at the i-th wire). Consequently all the birds on the i-th wire to the left of the dead bird get scared and jump up on the wire number i\xe2\x80\x89-\xe2\x80\x891, if there exists no upper wire they fly away. Also all the birds to the right of the dead bird jump down on wire number i\xe2\x80\x89+\xe2\x80\x891, if there exists no such wire they fly away. Shaass has shot m birds. You\'re given the initial number of birds on each wire, tell him how many birds are sitting on each wire after the shots." 800

293E "Close Vertices" "data structures,divide and conquer,trees" "You\'ve got a weighted tree, consisting of n vertices. Each edge has a non-negative weight. The length of the path between any two vertices of the tree is the number of edges in the path. The weight of the path is the total weight of all edges it contains. Two vertices are close if there exists a path of length at most l between them and a path of weight at most w between them. Count the number of pairs of vertices v,\xe2\x80\x89u (v\xe2\x80\x89<\xe2\x80\x89u), such that vertices v and u are close." 2700

293D "Ksusha and Square" "geometry,math,probabilities,two pointers" "Ksusha is a vigorous mathematician. She is keen on absolutely incredible mathematical riddles. Today Ksusha came across a convex polygon of non-zero area. She is now wondering: if she chooses a pair of distinct points uniformly among all integer points (points with integer coordinates) inside or on the border of the polygon and then draws a square with two opposite vertices lying in the chosen points, what will the expectation of this square\'s area be?A pair of distinct points is chosen uniformly among all pairs of distinct points, located inside or on the border of the polygon. Pairs of points p,\xe2\x80\x89q (p\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89q) and q,\xe2\x80\x89p are considered the same.Help Ksusha! Count the required expectation." 2700

293C "Cube Problem" "brute force,math,number theory" "Yaroslav, Andrey and Roman love playing cubes. Sometimes they get together and play cubes for hours and hours! Today they got together again and they are playing cubes. Yaroslav took unit cubes and composed them into an a\xe2\x80\x89\xc3\x97\xe2\x80\x89a\xe2\x80\x89\xc3\x97\xe2\x80\x89a cube, Andrey made a b\xe2\x80\x89\xc3\x97\xe2\x80\x89b\xe2\x80\x89\xc3\x97\xe2\x80\x89b cube and Roman made a c\xe2\x80\x89\xc3\x97\xe2\x80\x89c\xe2\x80\x89\xc3\x97\xe2\x80\x89c cube. After that the game was finished and the guys left. But later, Vitaly entered the room. He saw the cubes and wanted to make a cube as well. But what size should the cube be? Of course it should be a large cube with the side of length a\xe2\x80\x89+\xe2\x80\x89b\xe2\x80\x89+\xe2\x80\x89c. Besides, Vitaly decided to decompose the cubes built by Yaroslav, Andrey and Roman and compose his own large cube out of them. However, it turned out that the unit cubes he got from destroying the three cubes just weren\'t enough to make a large cube. We know that Vitaly was short of exactly n cubes. Vitaly got upset, demolished everything and left. As he was leaving, he met Petya and told him that there had been three cubes in the room and that he needed another n unit cubes to make his own large cube.Petya entered the room and saw the messily scattered cubes. He wanted to make it neat and orderly again. But he only knows that there had been three cubes, made of small unit cubes and that Vitaly needed n more unit cubes to make a large one! Help Petya understand, how many ways of sizes a, b, c are there to restore Yaroslav\'s, Andrey\'s and Roman\'s cubes." 2400

293B "Distinct Paths" "brute force,combinatorics" "You have a rectangular n\xe2\x80\x89\xc3\x97\xe2\x80\x89m-cell board. Some cells are already painted some of k colors. You need to paint each uncolored cell one of the k colors so that any path from the upper left square to the lower right one doesn\'t contain any two cells of the same color. The path can go only along side-adjacent cells and can only go down or right.Print the number of possible paintings modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." 2700

293A "Weird Game" games,greedy "Yaroslav, Andrey and Roman can play cubes for hours and hours. But the game is for three, so when Roman doesn\'t show up, Yaroslav and Andrey play another game. Roman leaves a word for each of them. Each word consists of 2\xc2\xb7n binary characters ""0"" or ""1"". After that the players start moving in turns. Yaroslav moves first. During a move, a player must choose an integer from 1 to 2\xc2\xb7n, which hasn\'t been chosen by anybody up to that moment. Then the player takes a piece of paper and writes out the corresponding character from his string. Let\'s represent Yaroslav\'s word as s\xe2\x80\x89=\xe2\x80\x89s1s2... s2n. Similarly, let\'s represent Andrey\'s word as t\xe2\x80\x89=\xe2\x80\x89t1t2... t2n. Then, if Yaroslav choose number k during his move, then he is going to write out character sk on the piece of paper. Similarly, if Andrey choose number r during his move, then he is going to write out character tr on the piece of paper.The game finishes when no player can make a move. After the game is over, Yaroslav makes some integer from the characters written on his piece of paper (Yaroslav can arrange these characters as he wants). Andrey does the same. The resulting numbers can contain leading zeroes. The person with the largest number wins. If the numbers are equal, the game ends with a draw.You are given two strings s and t. Determine the outcome of the game provided that Yaroslav and Andrey play optimally well." 1500

292E "Copying Data" "data structures" "We often have to copy large volumes of information. Such operation can take up many computer resources. Therefore, in this problem you are advised to come up with a way to copy some part of a number array into another one, quickly.More formally, you\'ve got two arrays of integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an and b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bn of length n. Also, you\'ve got m queries of two types:  Copy the subsegment of array a of length k, starting from position x, into array b, starting from position y, that is, execute by\xe2\x80\x89+\xe2\x80\x89q\xe2\x80\x89=\xe2\x80\x89ax\xe2\x80\x89+\xe2\x80\x89q for all integer q (0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89q\xe2\x80\x89<\xe2\x80\x89k). The given operation is correct \xe2\x80\x94 both subsegments do not touch unexistent elements.  Determine the value in position x of array b, that is, find value bx. For each query of the second type print the result \xe2\x80\x94 the value of the corresponding element of array b." 1900

292D "Connected Components" "data structures,dfs and similar,dp,dsu" "We already know of the large corporation where Polycarpus works as a system administrator. The computer network there consists of n computers and m cables that connect some pairs of computers. In other words, the computer network can be represented as some non-directed graph with n nodes and m edges. Let\'s index the computers with integers from 1 to n, let\'s index the cables with integers from 1 to m.Polycarpus was given an important task \xe2\x80\x94 check the reliability of his company\'s network. For that Polycarpus decided to carry out a series of k experiments on the computer network, where the i-th experiment goes as follows:  Temporarily disconnect the cables with indexes from li to ri, inclusive (the other cables remain connected).  Count the number of connected components in the graph that is defining the computer network at that moment.  Re-connect the disconnected cables with indexes from li to ri (that is, restore the initial network). Help Polycarpus carry out all experiments and for each print the number of connected components in the graph that defines the computer network through the given experiment. Isolated vertex should be counted as single component." 1900

292C "Beautiful IP Addresses" "brute force" "The problem uses a simplified TCP/IP address model, please read the statement carefully.An IP address is a 32-bit integer, represented as a group of four decimal 8-bit integers (without leading zeroes), separated by commas. For example, record 0.255.1.123 shows a correct IP address and records 0.256.1.123 and 0.255.1.01 do not. In the given problem an arbitrary group of four 8-bit integers is a correct IP address.Our hero Polycarpus still works as a system administrator in some large corporation. He likes beautiful IP addresses. To check if some IP address is beautiful, he should do the following:  write out in a line four 8-bit numbers of the IP address, without the commas;  check if the resulting string is a palindrome. Let us remind you that a palindrome is a string that reads the same from right to left and from left to right.For example, IP addresses 12.102.20.121 and 0.3.14.130 are beautiful (as strings ""1210220121"" and ""0314130"" are palindromes), and IP addresses 1.20.20.1 and 100.4.4.1 are not.Polycarpus wants to find all beautiful IP addresses that have the given set of digits. Each digit from the set must occur in the IP address at least once. IP address must not contain any other digits. Help him to cope with this difficult task." 2000

292B "Network Topology" graphs,implementation "This problem uses a simplified network topology model, please read the problem statement carefully and use it as a formal document as you develop the solution.Polycarpus continues working as a system administrator in a large corporation. The computer network of this corporation consists of n computers, some of them are connected by a cable. The computers are indexed by integers from 1 to n. It\'s known that any two computers connected by cable directly or through other computersPolycarpus decided to find out the network\'s topology. A network topology is the way of describing the network configuration, the scheme that shows the location and the connections of network devices.Polycarpus knows three main network topologies: bus, ring and star. A bus is the topology that represents a shared cable with all computers connected with it. In the ring topology the cable connects each computer only with two other ones. A star is the topology where all computers of a network are connected to the single central node.Let\'s represent each of these network topologies as a connected non-directed graph. A bus is a connected graph that is the only path, that is, the graph where all nodes are connected with two other ones except for some two nodes that are the beginning and the end of the path. A ring is a connected graph, where all nodes are connected with two other ones. A star is a connected graph, where a single central node is singled out and connected with all other nodes. For clarifications, see the picture.  (1) \xe2\x80\x94 bus, (2) \xe2\x80\x94 ring, (3) \xe2\x80\x94 star You\'ve got a connected non-directed graph that characterizes the computer network in Polycarpus\' corporation. Help him find out, which topology type the given network is. If that is impossible to do, say that the network\'s topology is unknown." 1200

292A SMSC implementation "Some large corporation where Polycarpus works has its own short message service center (SMSC). The center\'s task is to send all sorts of crucial information. Polycarpus decided to check the efficiency of the SMSC. For that, he asked to give him the statistics of the performance of the SMSC for some period of time. In the end, Polycarpus got a list of n tasks that went to the SMSC of the corporation. Each task was described by the time it was received by the SMSC and the number of text messages to send. More formally, the i-th task was described by two integers ti and ci \xe2\x80\x94 the receiving time (the second) and the number of the text messages, correspondingly.Polycarpus knows that the SMSC cannot send more than one text message per second. The SMSC uses a queue to organize its work. Consider a time moment x, the SMSC work at that moment as follows:  If at the time moment x the queue is not empty, then SMSC sends one message from the queue (SMSC gets the message from the head of the queue). Otherwise it doesn\'t send messages at the time moment x.  If at the time moment x SMSC receives a task, then it adds to the queue all the messages from this task (SMSC adds messages to the tail of the queue). Note, that the messages from the task cannot be send at time moment x. That\'s because the decision about sending message or not is made at point 1 before adding these messages to the queue. Given the information about all n tasks, Polycarpus wants to count two values: the time when the last text message was sent and the maximum size of the queue at some time. Help him count these two characteristics he needs to evaluate the efficiency of the SMSC." 1100

291E "Tree-String Problem" "*special problem,dfs and similar,hashing,strings" "A rooted tree is a non-directed connected graph without any cycles with a distinguished vertex, which is called the tree root. Consider the vertices of a rooted tree, that consists of n vertices, numbered from 1 to n. In this problem the tree root is the vertex number 1.Let\'s represent the length of the shortest by the number of edges path in the tree between vertices v and u as d(v,\xe2\x80\x89u).A parent of vertex v in the rooted tree with the root in vertex r (v\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89r) is vertex pv, such that d(r,\xe2\x80\x89pv)\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89=\xe2\x80\x89d(r,\xe2\x80\x89v) and d(pv,\xe2\x80\x89v)\xe2\x80\x89=\xe2\x80\x891. For example, on the picture the parent of vertex v\xe2\x80\x89=\xe2\x80\x895 is vertex p5\xe2\x80\x89=\xe2\x80\x892.One day Polycarpus came across a rooted tree, consisting of n vertices. The tree wasn\'t exactly ordinary: it had strings written on its edges. Polycarpus positioned the tree on the plane so as to make all edges lead from top to bottom if you go from the vertex parent to the vertex (see the picture). For any edge that lead from vertex pv to vertex v (1\xe2\x80\x89<\xe2\x80\x89v\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n), he knows string sv that is written on it. All strings are written on the edges from top to bottom. For example, on the picture s7=""ba"". The characters in the strings are numbered starting from 0.  An example of Polycarpus\'s tree (corresponds to the example from the statement) Polycarpus defines the position in this tree as a specific letter on a specific string. The position is written as a pair of integers (v,\xe2\x80\x89x) that means that the position is the x-th letter of the string sv (1\xe2\x80\x89<\xe2\x80\x89v\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n, 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89<\xe2\x80\x89|sv|), where |sv| is the length of string sv. For example, the highlighted letters are positions (2,\xe2\x80\x891) and (3,\xe2\x80\x891).Let\'s consider the pair of positions (v,\xe2\x80\x89x) and (u,\xe2\x80\x89y) in Polycarpus\' tree, such that the way from the first position to the second goes down on each step. We will consider that the pair of such positions defines string z. String z consists of all letters on the way from (v,\xe2\x80\x89x) to (u,\xe2\x80\x89y), written in the order of this path. For example, in the picture the highlighted positions define string ""bacaba"".Polycarpus has a string t, he wants to know the number of pairs of positions that define string t. Note that the way from the first position to the second in the pair must go down everywhere. Help him with this challenging tree-string problem!" 2000

291D "Parallel Programming" "*special problem,greedy" "Polycarpus has a computer with n processors. Also, his computer has n memory cells. We\'ll consider the processors numbered by integers from 1 to n and that the memory cells are consecutively numbered by integers from 1 to n.Polycarpus needs to come up with a parallel program model. For each memory cell number i this program must record the value n\xe2\x80\x89-\xe2\x80\x89i to this cell. In other words, for each cell you\'ve got to find the distance to cell n.Let\'s denote the value that is written in the i-th cell as ai. Initially, ai\xe2\x80\x89=\xe2\x80\x891 (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89n) and an\xe2\x80\x89=\xe2\x80\x890. We will consider that only processor i can write values in the memory cell number i. All processors can read an information from some cell (several processors can read an information from some cell simultaneously).The parallel program is executed in several steps. During each step we execute the parallel version of the increment operation. Executing the parallel version of the increment operation goes as follows:  Each processor independently of the other ones chooses some memory cell. Let\'s say that processor i has chosen a cell with number ci (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ci\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n).  All processors simultaneously execute operation ai\xe2\x80\x89=\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x89aci. Help Polycarpus come up with the parallel program model that is executed in exactly k steps. Calculate the operations that need to be executed. Note that after k steps for all i\'s value ai must be equal n\xe2\x80\x89-\xe2\x80\x89i." 1600

291C "Network Mask" "*special problem,bitmasks,brute force,implementation" "The problem uses a simplified TCP/IP address model, please make sure you\'ve read the statement attentively.Polycarpus has found a job, he is a system administrator. One day he came across n IP addresses. Each IP address is a 32 bit number, represented as a group of four 8-bit numbers (without leading zeroes), separated by dots. For example, the record 0.255.1.123 shows a correct IP address and records 0.256.1.123 and 0.255.1.01 do not. In this problem an arbitrary group of four 8-bit numbers is a correct IP address.Having worked as an administrator for some time, Polycarpus learned that if you know the IP address, you can use the subnet mask to get the address of the network that has this IP addess.The subnet mask is an IP address that has the following property: if we write this IP address as a 32 bit string, that it is representable as ""11...11000..000"". In other words, the subnet mask first has one or more one bits, and then one or more zero bits (overall there are 32 bits). For example, the IP address 2.0.0.0 is not a correct subnet mask as its 32-bit record looks as 00000010000000000000000000000000.To get the network address of the IP address, you need to perform the operation of the bitwise ""and"" of the IP address and the subnet mask. For example, if the subnet mask is 255.192.0.0, and the IP address is 192.168.1.2, then the network address equals 192.128.0.0. In the bitwise ""and"" the result has a bit that equals 1 if and only if both operands have corresponding bits equal to one.Now Polycarpus wants to find all networks to which his IP addresses belong. Unfortunately, Polycarpus lost subnet mask. Fortunately, Polycarpus remembers that his IP addresses belonged to exactly k distinct networks. Help Polycarpus find the subnet mask, such that his IP addresses will belong to exactly k distinct networks. If there are several such subnet masks, find the one whose bit record contains the least number of ones. If such subnet mask do not exist, say so." 1600

291B "Command Line Arguments" "*special problem,implementation,strings" "The problem describes the properties of a command line. The description somehow resembles the one you usually see in real operating systems. However, there are differences in the behavior. Please make sure you\'ve read the statement attentively and use it as a formal document.In the Pindows operating system a strings are the lexemes of the command line \xe2\x80\x94 the first of them is understood as the name of the program to run and the following lexemes are its arguments. For example, as we execute the command "" run.exe one, two . "", we give four lexemes to the Pindows command line: ""run.exe"", ""one,"", ""two"", ""."". More formally, if we run a command that can be represented as string s (that has no quotes), then the command line lexemes are maximal by inclusion substrings of string s that contain no spaces.To send a string with spaces or an empty string as a command line lexeme, we can use double quotes. The block of characters that should be considered as one lexeme goes inside the quotes. Embedded quotes are prohibited \xe2\x80\x94 that is, for each occurrence of character """""" we should be able to say clearly that the quotes are opening or closing. For example, as we run the command """"run.exe o"" """" "" ne, "" two . "" "" "", we give six lexemes to the Pindows command line: ""run.exe o"", """" (an empty string), "" ne, "", ""two"", ""."", "" "" (a single space).It is guaranteed that each lexeme of the command line is either surrounded by spaces on both sides or touches the corresponding command border. One of its consequences is: the opening brackets are either the first character of the string or there is a space to the left of them.You have a string that consists of uppercase and lowercase English letters, digits, characters "".,?!"""" and spaces. It is guaranteed that this string is a correct OS Pindows command line string. Print all lexemes of this command line string. Consider the character """""" to be used only in order to denote a single block of characters into one command line lexeme. In particular, the consequence is that the given string has got an even number of such characters." 1300

291A "Spyke Talks" "*special problem,implementation,sortings" "Polycarpus is the director of a large corporation. There are n secretaries working for the corporation, each of them corresponds via the famous Spyke VoIP system during the day. We know that when two people call each other via Spyke, the Spyke network assigns a unique ID to this call, a positive integer session number.One day Polycarpus wondered which secretaries are talking via the Spyke and which are not. For each secretary, he wrote out either the session number of his call or a 0 if this secretary wasn\'t talking via Spyke at that moment.Help Polycarpus analyze these data and find out the number of pairs of secretaries that are talking. If Polycarpus has made a mistake in the data and the described situation could not have taken place, say so.Note that the secretaries can correspond via Spyke not only with each other, but also with the people from other places. Also, Spyke conferences aren\'t permitted \xe2\x80\x94 that is, one call connects exactly two people." 800

290F "Greedy Petya" "*special problem,dfs and similar,graphs,greedy" "Petya is an unexperienced programming contestant. Recently he has come across the following problem:You are given a non-directed graph which consists of n nodes and m edges. Your task is to determine whether the graph contains a Hamiltonian path.Petya wrote a quick bug-free code which he believes solves this problem. After that Petya decided to give this problem for April Fools Day contest. Unfortunately, Petya might have made a mistake, and it\'s quite possible that his algorithm is wrong. But this isn\'t a good excuse to leave the contest without submitting this problem, is it?" 2800

290E HQ "*special problem,constructive algorithms" "The famous joke programming language HQ9+ has only 4 commands. In this problem we will explore its subset \xe2\x80\x94 a language called HQ..." 2500

290D Orange "*special problem,implementation"  1400

290C WTF? "*special problem,graph matchings,implementation,trees" "HAII HAS A TUXGIMMEH TUXI HAS A FOO ITS 0I HAS A BAR ITS 0I HAS A BAZ ITS 0I HAS A QUZ ITS 1TUX IS NOW A NUMBRIM IN YR LOOP NERFIN YR TUX TIL BOTH SAEM TUX AN 0I HAS A PURGIMMEH PURPUR IS NOW A NUMBRFOO R SUM OF FOO AN PURBAR R SUM OF BAR AN 1BOTH SAEM BIGGR OF PRODUKT OF FOO AN QUZ AN PRODUKT OF BAR BAZ AN PRODUKT OF FOO AN QUZO RLY?YA RLYBAZ R FOOQUZ R BAROICIM OUTTA YR LOOPBAZ IS NOW A NUMBARVISIBLE SMOOSH QUOSHUNT OF BAZ QUZKTHXBYE" 1700

290B "QR code" "*special problem,implementation"  1500

290A "Mysterious strings" "*special problem,implementation" "InputThe input contains a single integer a (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x8940).OutputOutput a single string.ExamplesInputCopy2OutputCopyAdamsInputCopy8OutputCopyVan BurenInputCopy29OutputCopyHarding" 1400

289B "Polo the Penguin and Matrix" "brute force,dp,implementation,sortings,ternary search" "Little penguin Polo has an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m matrix, consisting of integers. Let\'s index the matrix rows from 1 to n from top to bottom and let\'s index the columns from 1 to m from left to right. Let\'s represent the matrix element on the intersection of row i and column j as aij.In one move the penguin can add or subtract number d from some matrix element. Find the minimum number of moves needed to make all matrix elements equal. If the described plan is impossible to carry out, say so." 1400

289A "Polo the Penguin and Segments" "brute force,implementation" "Little penguin Polo adores integer segments, that is, pairs of integers [l;�r] (l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r). He has a set that consists of n integer segments: [l1;�r1],\xe2\x80\x89[l2;�r2],\xe2\x80\x89...,\xe2\x80\x89[ln;�rn]. We know that no two segments of this set intersect. In one move Polo can either widen any segment of the set 1 unit to the left or 1 unit to the right, that is transform [l;�r] to either segment [l\xe2\x80\x89-\xe2\x80\x891;�r], or to segment [l;�r\xe2\x80\x89+\xe2\x80\x891].The value of a set of segments that consists of n segments [l1;�r1],\xe2\x80\x89[l2;�r2],\xe2\x80\x89...,\xe2\x80\x89[ln;�rn] is the number of integers x, such that there is integer j, for which the following inequality holds, lj\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89rj.Find the minimum number of moves needed to make the value of the set of Polo\'s segments divisible by k." 1100

288E "Polo the Penguin and Lucky Numbers" dp,implementation,math "Everybody knows that lucky numbers are positive integers that contain only lucky digits 4 and 7 in their decimal representation. For example, numbers 47, 744, 4 are lucky and 5, 17, 467 are not.Polo the Penguin have two positive integers l and r (l\xe2\x80\x89<\xe2\x80\x89r), both of them are lucky numbers. Moreover, their lengths (that is, the number of digits in the decimal representation without the leading zeroes) are equal to each other.Let\'s assume that n is the number of distinct lucky numbers, each of them cannot be greater than r or less than l, and ai is the i-th (in increasing order) number of them. Find a1\xc2\xb7a2\xe2\x80\x89+\xe2\x80\x89a2\xc2\xb7a3\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89an\xe2\x80\x89-\xe2\x80\x891\xc2\xb7an. As the answer can be rather large, print the remainder after dividing it by 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." 2800

288D "Polo the Penguin and Trees" "combinatorics,dfs and similar,trees" "Little penguin Polo has got a tree \xe2\x80\x94 a non-directed connected acyclic graph, containing n nodes and n\xe2\x80\x89-\xe2\x80\x891 edges. We will consider the tree nodes numbered by integers from 1 to n.Today Polo wonders, how to find the number of pairs of paths that don\'t have common nodes. More formally, he should find the number of groups of four integers a,\xe2\x80\x89b,\xe2\x80\x89c and d such that:  1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a\xe2\x80\x89<\xe2\x80\x89b\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n;  1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89c\xe2\x80\x89<\xe2\x80\x89d\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n;  there\'s no such node that lies on both the shortest path from node a to node b and from node c to node d. The shortest path betweem two nodes is the path that is shortest in the number of edges.Help Polo solve this problem." 2400

288C "Polo the Penguin and XOR operation" implementation,math "Little penguin Polo likes permutations. But most of all he likes permutations of integers from 0 to n, inclusive.For permutation p\xe2\x80\x89=\xe2\x80\x89p0,\xe2\x80\x89p1,\xe2\x80\x89...,\xe2\x80\x89pn, Polo has defined its beauty \xe2\x80\x94 number .Expression  means applying the operation of bitwise excluding ""OR"" to numbers x and y. This operation exists in all modern programming languages, for example, in language C++ and Java it is represented as ""^"" and in Pascal \xe2\x80\x94 as ""xor"".Help him find among all permutations of integers from 0 to n the permutation with the maximum beauty." 1700

288B "Polo the Penguin and Houses" combinatorics "Little penguin Polo loves his home village. The village has n houses, indexed by integers from 1 to n. Each house has a plaque containing an integer, the i-th house has a plaque containing integer pi (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89pi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n).Little penguin Polo loves walking around this village. The walk looks like that. First he stands by a house number x. Then he goes to the house whose number is written on the plaque of house x (that is, to house px), then he goes to the house whose number is written on the plaque of house px (that is, to house ppx), and so on.We know that:  When the penguin starts walking from any house indexed from 1 to k, inclusive, he can walk to house number 1.  When the penguin starts walking from any house indexed from k\xe2\x80\x89+\xe2\x80\x891 to n, inclusive, he definitely cannot walk to house number 1.  When the penguin starts walking from house number 1, he can get back to house number 1 after some non-zero number of walks from a house to a house. You need to find the number of ways you may write the numbers on the houses\' plaques so as to fulfill the three above described conditions. Print the remainder after dividing this number by 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." 1500

288A "Polo the Penguin and Strings" greedy "Little penguin Polo adores strings. But most of all he adores strings of length n.One day he wanted to find a string that meets the following conditions:  The string consists of n lowercase English letters (that is, the string\'s length equals n), exactly k of these letters are distinct.  No two neighbouring letters of a string coincide; that is, if we represent a string as s\xe2\x80\x89=\xe2\x80\x89s1s2... sn, then the following inequality holds, si\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89si\xe2\x80\x89+\xe2\x80\x891(1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89n).  Among all strings that meet points 1 and 2, the required string is lexicographically smallest. Help him find such string or state that such string doesn\'t exist.String x\xe2\x80\x89=\xe2\x80\x89x1x2... xp is lexicographically less than string y\xe2\x80\x89=\xe2\x80\x89y1y2... yq, if either p\xe2\x80\x89<\xe2\x80\x89q and x1\xe2\x80\x89=\xe2\x80\x89y1,\xe2\x80\x89x2\xe2\x80\x89=\xe2\x80\x89y2,\xe2\x80\x89... ,\xe2\x80\x89xp\xe2\x80\x89=\xe2\x80\x89yp, or there is such number r (r\xe2\x80\x89<\xe2\x80\x89p,\xe2\x80\x89r\xe2\x80\x89<\xe2\x80\x89q), that x1\xe2\x80\x89=\xe2\x80\x89y1,\xe2\x80\x89x2\xe2\x80\x89=\xe2\x80\x89y2,\xe2\x80\x89... ,\xe2\x80\x89xr\xe2\x80\x89=\xe2\x80\x89yr and xr\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89<\xe2\x80\x89yr\xe2\x80\x89+\xe2\x80\x891. The characters of the strings are compared by their ASCII codes." 1300

287B Pipeline "binary search,math" "Vova, the Ultimate Thule new shaman, wants to build a pipeline. As there are exactly n houses in Ultimate Thule, Vova wants the city to have exactly n pipes, each such pipe should be connected to the water supply. A pipe can be connected to the water supply if there\'s water flowing out of it. Initially Vova has only one pipe with flowing water. Besides, Vova has several splitters.A splitter is a construction that consists of one input (it can be connected to a water pipe) and x output pipes. When a splitter is connected to a water pipe, water flows from each output pipe. You can assume that the output pipes are ordinary pipes. For example, you can connect water supply to such pipe if there\'s water flowing out from it. At most one splitter can be connected to any water pipe.  The figure shows a 4-output splitter Vova has one splitter of each kind: with 2, 3, 4, ..., k outputs. Help Vova use the minimum number of splitters to build the required pipeline or otherwise state that it\'s impossible.Vova needs the pipeline to have exactly n pipes with flowing out water. Note that some of those pipes can be the output pipes of the splitters." 1700

287A "IQ Test" "brute force,implementation" "In the city of Ultima Thule job applicants are often offered an IQ test. The test is as follows: the person gets a piece of squared paper with a 4\xe2\x80\x89\xc3\x97\xe2\x80\x894 square painted on it. Some of the square\'s cells are painted black and others are painted white. Your task is to repaint at most one cell the other color so that the picture has a 2\xe2\x80\x89\xc3\x97\xe2\x80\x892 square, completely consisting of cells of the same color. If the initial picture already has such a square, the person should just say so and the test will be completed. Your task is to write a program that determines whether it is possible to pass the test. You cannot pass the test if either repainting any cell or no action doesn\'t result in a 2\xe2\x80\x89\xc3\x97\xe2\x80\x892 square, consisting of cells of the same color." 1100

286E "Ladies\' Shop" "constructive algorithms,fft,math" "In the city of Ultima Thule job applicants are often offered an IQ test. The test is as follows: the person gets a piece of squared paper with a 4\xe2\x80\x89\xc3\x97\xe2\x80\x894 square painted on it. Some of the square\'s cells are painted black and others are painted white. Your task is to repaint at most one cell the other color so that the picture has a 2\xe2\x80\x89\xc3\x97\xe2\x80\x892 square, completely consisting of cells of the same color. If the initial picture already has such a square, the person should just say so and the test will be completed. Your task is to write a program that determines whether it is possible to pass the test. You cannot pass the test if either repainting any cell or no action doesn\'t result in a 2\xe2\x80\x89\xc3\x97\xe2\x80\x892 square, consisting of cells of the same color." 2800

286D Tourists "data structures,sortings" "A double tourist path, located at a park in Ultima Thule, is working by the following principle:  We introduce the Cartesian coordinate system.  At some points of time there are two tourists going (for a walk) from points (\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x890) and (1,\xe2\x80\x890) simultaneously. The first one is walking from (\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x890), the second one is walking from (1,\xe2\x80\x890).  Both tourists in a pair move at the same speed 1 (distance unit per second), the first one moves along line x\xe2\x80\x89=\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x891, the second one moves along line x\xe2\x80\x89=\xe2\x80\x891, both of them are moving in the positive direction of the Oy axis.  At some points of time walls appear. Wall (li,\xe2\x80\x89ri) is a segment between points (0,\xe2\x80\x89li) and (0,\xe2\x80\x89ri). Each wall appears immediately. The Ultima Thule government wants to learn this for each pair of tourists that walk simultaneously: for how long (in seconds) will they not see each other? Two tourists don\'t see each other if the segment that connects their positions on the plane intersects at least one wall. Two segments intersect if they share at least one point. We assume that the segments\' ends belong to the segments.Help the government count the required time. Note that the walls can intersect (in any way) or coincide." 2600

286C "Main Sequence" greedy,implementation "As you know, Vova has recently become a new shaman in the city of Ultima Thule. So, he has received the shaman knowledge about the correct bracket sequences. The shamans of Ultima Thule have been using lots of different types of brackets since prehistoric times. A bracket type is a positive integer. The shamans define a correct bracket sequence as follows:  An empty sequence is a correct bracket sequence.  If {a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89al} and {b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bk} are correct bracket sequences, then sequence {a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89al,\xe2\x80\x89b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bk} (their concatenation) also is a correct bracket sequence.  If {a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89al} \xe2\x80\x94 is a correct bracket sequence, then sequence  also is a correct bracket sequence, where v (v\xe2\x80\x89>\xe2\x80\x890) is an integer. For example, sequences {1,\xe2\x80\x891,\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x892,\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x892,\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x891} and {3,\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x893} are correct bracket sequences, and {2,\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x893} is not.Moreover, after Vova became a shaman, he learned the most important correct bracket sequence {x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xn}, consisting of n integers. As sequence x is the most important, Vova decided to encrypt it just in case.Encrypting consists of two sequences. The first sequence {p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pn} contains types of brackets, that is, pi\xe2\x80\x89=\xe2\x80\x89|xi| (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n). The second sequence {q1,\xe2\x80\x89q2,\xe2\x80\x89...,\xe2\x80\x89qt} contains t integers \xe2\x80\x94 some positions (possibly, not all of them), which had negative numbers in sequence {x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xn}.Unfortunately, Vova forgot the main sequence. But he was lucky enough to keep the encryption: sequences {p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pn} and {q1,\xe2\x80\x89q2,\xe2\x80\x89...,\xe2\x80\x89qt}. Help Vova restore sequence x by the encryption. If there are multiple sequences that correspond to the encryption, restore any of them. If there are no such sequences, you should tell so." 2100

286B Shifting implementation "John Doe has found the beautiful permutation formula.Let\'s take permutation p\xe2\x80\x89=\xe2\x80\x89p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pn. Let\'s define transformation f of this permutation: where k (k\xe2\x80\x89>\xe2\x80\x891) is an integer, the transformation parameter, r is such maximum integer that rk\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n. If rk\xe2\x80\x89=\xe2\x80\x89n, then elements prk\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89prk\xe2\x80\x89+\xe2\x80\x892 and so on are omitted. In other words, the described transformation of permutation p cyclically shifts to the left each consecutive block of length k and the last block with the length equal to the remainder after dividing n by k. John Doe thinks that permutation f(f(�...�f(p\xe2\x80\x89=\xe2\x80\x89[1,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89n],\xe2\x80\x892)�...�,\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x891),\xe2\x80\x89n) is beautiful. Unfortunately, he cannot quickly find the beautiful permutation he\'s interested in. That\'s why he asked you to help him.Your task is to find a beautiful permutation for the given n. For clarifications, see the notes to the third sample." 2200

286A "Lucky Permutation" "constructive algorithms,math" "A permutation p of size n is the sequence p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pn, consisting of n distinct integers, each of them is from 1 to n (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89pi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n).A lucky permutation is such permutation p, that any integer i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) meets this condition ppi\xe2\x80\x89=\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x89i\xe2\x80\x89+\xe2\x80\x891.You have integer n. Find some lucky permutation p of size n." 1400

285E "Positions in Permutations" combinatorics,dp,math "Permutation p is an ordered set of integers p1,\xe2\x80\x89\xe2\x80\x89p2,\xe2\x80\x89\xe2\x80\x89...,\xe2\x80\x89\xe2\x80\x89pn, consisting of n distinct positive integers, each of them doesn\'t exceed n. We\'ll denote the i-th element of permutation p as pi. We\'ll call number n the size or the length of permutation p1,\xe2\x80\x89\xe2\x80\x89p2,\xe2\x80\x89\xe2\x80\x89...,\xe2\x80\x89\xe2\x80\x89pn.We\'ll call position i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) in permutation p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pn good, if |p[i]\xe2\x80\x89-\xe2\x80\x89i|\xe2\x80\x89=\xe2\x80\x891. Count the number of permutations of size n with exactly k good positions. Print the answer modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." 2600

285D "Permutation Sum" bitmasks,combinatorics,dp,implementation,meet-in-the-middle "Permutation p is an ordered set of integers p1,\xe2\x80\x89\xe2\x80\x89p2,\xe2\x80\x89\xe2\x80\x89...,\xe2\x80\x89\xe2\x80\x89pn, consisting of n distinct positive integers, each of them doesn\'t exceed n. We\'ll denote the i-th element of permutation p as pi. We\'ll call number n the size or the length of permutation p1,\xe2\x80\x89\xe2\x80\x89p2,\xe2\x80\x89\xe2\x80\x89...,\xe2\x80\x89\xe2\x80\x89pn.Petya decided to introduce the sum operation on the set of permutations of length n. Let\'s assume that we are given two permutations of length n: a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an and b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bn. Petya calls the sum of permutations a and b such permutation c of length n, where ci\xe2\x80\x89=\xe2\x80\x89((ai\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x89bi\xe2\x80\x89-\xe2\x80\x891) mod n)\xe2\x80\x89+\xe2\x80\x891 (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n).Operation  means taking the remainder after dividing number x by number y.Obviously, not for all permutations a and b exists permutation c that is sum of a and b. That\'s why Petya got sad and asked you to do the following: given n, count the number of such pairs of permutations a and b of length n, that exists permutation c that is sum of a and b. The pair of permutations x,\xe2\x80\x89y (x\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89y) and the pair of permutations y,\xe2\x80\x89x are considered distinct pairs.As the answer can be rather large, print the remainder after dividing it by 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." 1900

285C "Building Permutation" greedy,implementation,sortings "Permutation p is an ordered set of integers p1,\xe2\x80\x89\xe2\x80\x89p2,\xe2\x80\x89\xe2\x80\x89...,\xe2\x80\x89\xe2\x80\x89pn, consisting of n distinct positive integers, each of them doesn\'t exceed n. We\'ll denote the i-th element of permutation p as pi. We\'ll call number n the size or the length of permutation p1,\xe2\x80\x89\xe2\x80\x89p2,\xe2\x80\x89\xe2\x80\x89...,\xe2\x80\x89\xe2\x80\x89pn.You have a sequence of integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. In one move, you are allowed to decrease or increase any number by one. Count the minimum number of moves, needed to build a permutation from this sequence." 1200

285B "Find Marble" implementation "Petya and Vasya are playing a game. Petya\'s got n non-transparent glasses, standing in a row. The glasses\' positions are indexed with integers from 1 to n from left to right. Note that the positions are indexed but the glasses are not.First Petya puts a marble under the glass in position s. Then he performs some (possibly zero) shuffling operations. One shuffling operation means moving the glass from the first position to position p1, the glass from the second position to position p2 and so on. That is, a glass goes from position i to position pi. Consider all glasses are moving simultaneously during one shuffling operation. When the glasses are shuffled, the marble doesn\'t travel from one glass to another: it moves together with the glass it was initially been put in.After all shuffling operations Petya shows Vasya that the ball has moved to position t. Vasya\'s task is to say what minimum number of shuffling operations Petya has performed or determine that Petya has made a mistake and the marble could not have got from position s to position t." 1200

285A "Slightly Decreasing Permutations" greedy,implementation "Permutation p is an ordered set of integers p1,\xe2\x80\x89\xe2\x80\x89p2,\xe2\x80\x89\xe2\x80\x89...,\xe2\x80\x89\xe2\x80\x89pn, consisting of n distinct positive integers, each of them doesn\'t exceed n. We\'ll denote the i-th element of permutation p as pi. We\'ll call number n the size or the length of permutation p1,\xe2\x80\x89\xe2\x80\x89p2,\xe2\x80\x89\xe2\x80\x89...,\xe2\x80\x89\xe2\x80\x89pn.The decreasing coefficient of permutation p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pn is the number of such i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89n), that pi\xe2\x80\x89>\xe2\x80\x89pi\xe2\x80\x89+\xe2\x80\x891.You have numbers n and k. Your task is to print the permutation of length n with decreasing coefficient k." 1100

284B "Cows and Poker Game" "brute force,implementation" "There are n cows playing poker at a table. For the current betting phase, each player\'s status is either ""ALLIN"", ""IN"", or ""FOLDED"", and does not change throughout the phase. To increase the suspense, a player whose current status is not ""FOLDED"" may show his/her hand to the table. However, so as not to affect any betting decisions, he/she may only do so if all other players have a status of either ""ALLIN"" or ""FOLDED"". The player\'s own status may be either ""ALLIN"" or ""IN"".Find the number of cows that can currently show their hands without affecting any betting decisions." 1000

284A "Cows and Primitive Roots" "implementation,math,number theory" "The cows have just learned what a primitive root is! Given a prime p, a primitive root  is an integer x (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89<\xe2\x80\x89p) such that none of integers x\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89x2\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89xp\xe2\x80\x89-\xe2\x80\x892\xe2\x80\x89-\xe2\x80\x891 are divisible by p, but xp\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89-\xe2\x80\x891 is. Unfortunately, computing primitive roots can be time consuming, so the cows need your help. Given a prime p, help the cows find the number of primitive roots ." 1400

283E "Cow Tennis Tournament" "combinatorics,data structures,math" "Farmer John is hosting a tennis tournament with his n cows. Each cow has a skill level si, and no two cows having the same skill level. Every cow plays every other cow exactly once in the tournament, and each cow beats every cow with skill level lower than its own.However, Farmer John thinks the tournament will be demoralizing for the weakest cows who lose most or all of their matches, so he wants to flip some of the results. In particular, at k different instances, he will take two integers ai,\xe2\x80\x89bi (ai\xe2\x80\x89<\xe2\x80\x89bi) and flip all the results between cows with skill level between ai and bi inclusive. That is, for any pair x,\xe2\x80\x89y  he will change the result of the match on the final scoreboard (so if x won the match, the scoreboard will now display that y won the match, and vice versa). It is possible that Farmer John will change the result of a match multiple times. It is not guaranteed that ai and bi are equal to some cow\'s skill level.Farmer John wants to determine how balanced he made the tournament results look. In particular, he wants to count the number of triples of cows (p,\xe2\x80\x89q,\xe2\x80\x89r) for which the final leaderboard shows that cow p beats cow q, cow q beats cow r, and cow r beats cow p. Help him determine this number.Note that two triples are considered different if they do not contain the same set of cows (i.e. if there is a cow in one triple that is not in the other)." 2800

283D "Cows and Cool Sequences" "dp,math,number theory" "Bessie and the cows have recently been playing with ""cool"" sequences and are trying to construct some. Unfortunately they are bad at arithmetic, so they need your help!A pair (x,\xe2\x80\x89y) of positive integers is ""cool"" if x can be expressed as the sum of y consecutive integers (not necessarily positive). A sequence (a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an) is ""cool"" if the pairs (a1,\xe2\x80\x89a2),\xe2\x80\x89(a2,\xe2\x80\x89a3),\xe2\x80\x89...,\xe2\x80\x89(an\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89an) are all cool. The cows have a sequence of n positive integers, a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. In one move, they may replace some ai with any other positive integer (there are no other limits on the new value of ai). Determine the smallest number of moves needed to make the resulting sequence cool." 2400

283C "Coin Troubles" dp "In the Isle of Guernsey there are n different types of coins. For each i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n), coin of type i is worth ai cents. It is possible that ai\xe2\x80\x89=\xe2\x80\x89aj for some i and j (i\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89j). Bessie has some set of these coins totaling t cents. She tells Jessie q pairs of integers. For each i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89q), the pair bi,\xe2\x80\x89ci tells Jessie that Bessie has a strictly greater number of coins of type bi than coins of type ci. It is known that all bi are distinct and all ci are distinct. Help Jessie find the number of possible combinations of coins Bessie could have. Two combinations are considered different if there is some i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n), such that the number of coins Bessie has of type i is different in the two combinations. Since the answer can be very large, output it modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897). If there are no possible combinations of coins totaling t cents that satisfy Bessie\'s conditions, output 0." 2100

283B "Cow Program" "dfs and similar,dp,graphs" "Farmer John has just given the cows a program to play with! The program contains two integer variables, x and y, and performs the following operations on a sequence a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an of positive integers:  Initially, x\xe2\x80\x89=\xe2\x80\x891 and y\xe2\x80\x89=\xe2\x80\x890. If, after any step, x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x890 or x\xe2\x80\x89>\xe2\x80\x89n, the program immediately terminates.  The program increases both x and y by a value equal to ax simultaneously.  The program now increases y by ax while decreasing x by ax.  The program executes steps 2 and 3 (first step 2, then step 3) repeatedly until it terminates (it may never terminate). So, the sequence of executed steps may start with: step 2, step 3, step 2, step 3, step 2 and so on. The cows are not very good at arithmetic though, and they want to see how the program works. Please help them!You are given the sequence a2,\xe2\x80\x89a3,\xe2\x80\x89...,\xe2\x80\x89an. Suppose for each i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x891) we run the program on the sequence i,\xe2\x80\x89a2,\xe2\x80\x89a3,\xe2\x80\x89...,\xe2\x80\x89an. For each such run output the final value of y if the program terminates or -1 if it does not terminate." 1700

283A "Cows and Sequence" "constructive algorithms,data structures,implementation" "Bessie and the cows are playing with sequences and need your help. They start with a sequence, initially containing just the number 0, and perform n operations. Each operation is one of the following:  Add the integer xi to the first ai elements of the sequence.  Append an integer ki to the end of the sequence. (And hence the size of the sequence increases by 1)  Remove the last element of the sequence. So, the size of the sequence decreases by one. Note, that this operation can only be done if there are at least two elements in the sequence. After each operation, the cows would like to know the average of all the numbers in the sequence. Help them!" 1600

282E "Sausage Maximization" "bitmasks,data structures,trees" "The Bitlandians are quite weird people. They have their own problems and their own solutions. They have their own thoughts and their own beliefs, they have their own values and their own merits. They have their own dishes and their own sausages!In Bitland a sausage is an array of integers! A sausage\'s deliciousness is equal to the bitwise excluding OR (the xor operation) of all integers in that sausage. One day, when Mr. Bitkoch (the local cook) was going to close his BitRestaurant, BitHaval and BitAryo, the most famous citizens of Bitland, entered the restaurant and each ordered a sausage.But Mr. Bitkoch had only one sausage left. So he decided to cut a prefix (several, may be zero, first array elements) of the sausage and give it to BitHaval and a postfix (several, may be zero, last array elements) of the sausage and give it to BitAryo. Note that one or both pieces of the sausage can be empty. Of course, the cut pieces mustn\'t intersect (no array element can occur in both pieces).The pleasure of BitHaval and BitAryo is equal to the bitwise XOR of their sausages\' deliciousness. An empty sausage\'s deliciousness equals zero.Find a way to cut a piece of sausage for BitHaval and BitAryo that maximizes the pleasure of these worthy citizens." 2200

282D "Yet Another Number Game" dp,games "Since most contestants do not read this part, I have to repeat that Bitlandians are quite weird. They have their own jobs, their own working method, their own lives, their own sausages and their own games!Since you are so curious about Bitland, I\'ll give you the chance of peeking at one of these games.BitLGM and BitAryo are playing yet another of their crazy-looking genius-needed Bitlandish games. They\'ve got a sequence of n non-negative integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. The players make moves in turns. BitLGM moves first. Each player can and must do one of the two following actions in his turn:  Take one of the integers (we\'ll denote it as ai). Choose integer x (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ai). And then decrease ai by x, that is, apply assignment: ai\xe2\x80\x89=\xe2\x80\x89ai\xe2\x80\x89-\xe2\x80\x89x.  Choose integer x . And then decrease all ai by x, that is, apply assignment: ai\xe2\x80\x89=\xe2\x80\x89ai\xe2\x80\x89-\xe2\x80\x89x, for all i. The player who cannot make a move loses.You\'re given the initial sequence a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. Determine who wins, if both players plays optimally well and if BitLGM and BitAryo start playing the described game in this sequence." 2100

282C "XOR and OR" "constructive algorithms,implementation,math" "The Bitlandians are quite weird people. They do everything differently. They have a different alphabet so they have a different definition for a string.A Bitlandish string is a string made only of characters ""0"" and ""1"".BitHaval (the mayor of Bitland) loves to play with Bitlandish strings. He takes some Bitlandish string a, and applies several (possibly zero) operations to it. In one operation the mayor may take any two adjacent characters of a string, define one of them as x and the other one as y. Then he calculates two values p and q: p\xe2\x80\x89=\xe2\x80\x89x�xor�y, q\xe2\x80\x89=\xe2\x80\x89x�or�y. Then he replaces one of the two taken characters by p and the other one by q.The xor operation means the bitwise excluding OR operation. The or operation is the bitwise OR operation.So for example one operation can transform string 11 to string 10 or to string 01. String 1 cannot be transformed into any other string.You\'ve got two Bitlandish strings a and b. Your task is to check if it is possible for BitHaval to transform string a to string b in several (possibly zero) described operations." 1500

282B "Painting Eggs" greedy,math "The Bitlandians are quite weird people. They have very peculiar customs.As is customary, Uncle J. wants to have n eggs painted for Bitruz (an ancient Bitland festival). He has asked G. and A. to do the work.The kids are excited because just as is customary, they\'re going to be paid for the job! Overall uncle J. has got n eggs. G. named his price for painting each egg. Similarly, A. named his price for painting each egg. It turns out that for each egg the sum of the money both A. and G. want for the painting equals 1000.Uncle J. wants to distribute the eggs between the children so as to give each egg to exactly one child. Also, Uncle J. wants the total money paid to A. to be different from the total money paid to G. by no more than 500.Help Uncle J. Find the required distribution of eggs or otherwise say that distributing the eggs in the required manner is impossible." 1500

282A Bit++ implementation "The classic programming language of Bitland is Bit++. This language is so peculiar and complicated.The language is that peculiar as it has exactly one variable, called x. Also, there are two operations:  Operation ++ increases the value of variable x by 1.  Operation -- decreases the value of variable x by 1. A statement in language Bit++ is a sequence, consisting of exactly one operation and one variable x. The statement is written without spaces, that is, it can only contain characters ""+"", ""-"", ""X"". Executing a statement means applying the operation it contains.A programme in Bit++ is a sequence of statements, each of them needs to be executed. Executing a programme means executing all the statements it contains.You\'re given a programme in language Bit++. The initial value of x is 0. Execute the programme and find its final value (the value of the variable when this programme is executed)." 800

281B "Nearest Fraction" "brute force,implementation,two pointers" "You are given three positive integers x,\xe2\x80\x89y,\xe2\x80\x89n. Your task is to find the nearest fraction to fraction  whose denominator is no more than n. Formally, you should find such pair of integers a,\xe2\x80\x89b (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n;�0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a) that the value  is as minimal as possible.If there are multiple ""nearest"" fractions, choose the one with the minimum denominator. If there are multiple ""nearest"" fractions with the minimum denominator, choose the one with the minimum numerator." 1700

281A "Word Capitalization" implementation,strings "Capitalization is writing a word with its first letter as a capital letter. Your task is to capitalize the given word.Note, that during capitalization all the letters except the first one remains unchanged." 800

280E "Sequence Transformation" "brute force,data structures,dp,implementation,math" "You\'ve got a non-decreasing sequence x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xn (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89...\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89xn\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89q). You\'ve also got two integers a and b (a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b;�a\xc2\xb7(n\xe2\x80\x89-\xe2\x80\x891)\xe2\x80\x89<\xe2\x80\x89q).Your task is to transform sequence x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xn into some sequence y1,\xe2\x80\x89y2,\xe2\x80\x89...,\xe2\x80\x89yn (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89yi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89q;�a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89yi\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89-\xe2\x80\x89yi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b). The transformation price is the following sum: . Your task is to choose such sequence y that minimizes the described transformation price." 3000

280D "k-Maximum Subsequence Sum" "data structures,flows,graphs,implementation" "Consider integer sequence a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. You should run queries of two types:  The query format is ""0 i val"". In reply to this query you should make the following assignment: ai\xe2\x80\x89=\xe2\x80\x89val.  The query format is ""1 l r k"". In reply to this query you should print the maximum sum of at most k non-intersecting subsegments of sequence al,\xe2\x80\x89al\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89ar. Formally, you should choose at most k pairs of integers (x1,\xe2\x80\x89y1),\xe2\x80\x89(x2,\xe2\x80\x89y2),\xe2\x80\x89...,\xe2\x80\x89(xt,\xe2\x80\x89yt) (l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y1\xe2\x80\x89<\xe2\x80\x89x2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y2\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89xt\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89yt\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r;�t\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k) such that the sum ax1\xe2\x80\x89+\xe2\x80\x89ax1\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89ay1\xe2\x80\x89+\xe2\x80\x89ax2\xe2\x80\x89+\xe2\x80\x89ax2\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89ay2\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89axt\xe2\x80\x89+\xe2\x80\x89axt\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89ayt is as large as possible. Note that you should choose at most k subsegments. Particularly, you can choose 0 subsegments. In this case the described sum considered equal to zero." 2800

280C "Game on Tree" implementation,math,probabilities,trees "Momiji has got a rooted tree, consisting of n nodes. The tree nodes are numbered by integers from 1 to n. The root has number 1. Momiji decided to play a game on this tree.The game consists of several steps. On each step, Momiji chooses one of the remaining tree nodes (let\'s denote it by v) and removes all the subtree nodes with the root in node v from the tree. Node v gets deleted as well. The game finishes when the tree has no nodes left. In other words, the game finishes after the step that chooses the node number 1.Each time Momiji chooses a new node uniformly among all the remaining nodes. Your task is to find the expectation of the number of steps in the described game." 2200

280B "Maximum Xor Secondary" "data structures,implementation,two pointers" "Bike loves looking for the second maximum element in the sequence. The second maximum element in the sequence of distinct numbers x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xk (k\xe2\x80\x89>\xe2\x80\x891) is such maximum element xj, that the following inequality holds: .The lucky number of the sequence of distinct positive integers x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xk (k\xe2\x80\x89>\xe2\x80\x891) is the number that is equal to the bitwise excluding OR of the maximum element of the sequence and the second maximum element of the sequence.You\'ve got a sequence of distinct positive integers s1,\xe2\x80\x89s2,\xe2\x80\x89...,\xe2\x80\x89sn (n\xe2\x80\x89>\xe2\x80\x891). Let\'s denote sequence sl,\xe2\x80\x89sl\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89sr as s[l..r] (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89<\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n). Your task is to find the maximum number among all lucky numbers of sequences s[l..r].Note that as all numbers in sequence s are distinct, all the given definitions make sence." 1800

280A "Rectangle Puzzle" geometry "You are given two rectangles on a plane. The centers of both rectangles are located in the origin of coordinates (meaning the center of the rectangle\'s symmetry). The first rectangle\'s sides are parallel to the coordinate axes: the length of the side that is parallel to the Ox axis, equals w, the length of the side that is parallel to the Oy axis, equals h. The second rectangle can be obtained by rotating the first rectangle relative to the origin of coordinates by angle \xce\xb1.  Your task is to find the area of the region which belongs to both given rectangles. This region is shaded in the picture." 2000

279E "Beautiful Decomposition" "dp,games,greedy,number theory" "Valera considers a number beautiful, if it equals 2k or -2k for some integer k (k\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x890). Recently, the math teacher asked Valera to represent number n as the sum of beautiful numbers. As Valera is really greedy, he wants to complete the task using as few beautiful numbers as possible. Help Valera and find, how many numbers he is going to need. In other words, if you look at all decompositions of the number n into beautiful summands, you need to find the size of the decomposition which has the fewest summands." 1900

279D "The Minimum Number of Variables" bitmasks,dp "You\'ve got a positive integer sequence a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. All numbers in the sequence are distinct. Let\'s fix the set of variables b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bm. Initially each variable bi (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m) contains the value of zero. Consider the following sequence, consisting of n operations.The first operation is assigning the value of a1 to some variable bx (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m). Each of the following n\xe2\x80\x89-\xe2\x80\x891 operations is assigning to some variable by the value that is equal to the sum of values that are stored in the variables bi and bj (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i,\xe2\x80\x89j,\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m). At that, the value that is assigned on the t-th operation, must equal at. For each operation numbers y,\xe2\x80\x89i,\xe2\x80\x89j are chosen anew.Your task is to find the minimum number of variables m, such that those variables can help you perform the described sequence of operations." 2200

279C Ladder "dp,implementation,two pointers" "You\'ve got an array, consisting of n integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. Also, you\'ve got m queries, the i-th query is described by two integers li,\xe2\x80\x89ri. Numbers li,\xe2\x80\x89ri define a subsegment of the original array, that is, the sequence of numbers ali,\xe2\x80\x89ali\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89ali\xe2\x80\x89+\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89ari. For each query you should check whether the corresponding segment is a ladder. A ladder is a sequence of integers b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bk, such that it first doesn\'t decrease, then doesn\'t increase. In other words, there is such integer x (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k), that the following inequation fulfills: b1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89...\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89bx\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89bx\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89bx\xe2\x80\x89+\xe2\x80\x892...\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89bk. Note that the non-decreasing and the non-increasing sequences are also considered ladders." 1700

279B Books "binary search,brute force,implementation,two pointers" "When Valera has got some free time, he goes to the library to read some books. Today he\'s got t free minutes to read. That\'s why Valera took n books in the library and for each book he estimated the time he is going to need to read it. Let\'s number the books by integers from 1 to n. Valera needs ai minutes to read the i-th book.Valera decided to choose an arbitrary book with number i and read the books one by one, starting from this book. In other words, he will first read book number i, then book number i\xe2\x80\x89+\xe2\x80\x891, then book number i\xe2\x80\x89+\xe2\x80\x892 and so on. He continues the process until he either runs out of the free time or finishes reading the n-th book. Valera reads each book up to the end, that is, he doesn\'t start reading the book if he doesn\'t have enough free time to finish reading it. Print the maximum number of books Valera can read." 1400

279A "Point on Spiral" "brute force,geometry,implementation" "Valera the horse lives on a plane. The Cartesian coordinate system is defined on this plane. Also an infinite spiral is painted on the plane. The spiral consists of segments: [(0,\xe2\x80\x890),\xe2\x80\x89(1,\xe2\x80\x890)], [(1,\xe2\x80\x890),\xe2\x80\x89(1,\xe2\x80\x891)], [(1,\xe2\x80\x891),\xe2\x80\x89(\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x891)], [(\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x891),\xe2\x80\x89(\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x891)], [(\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x891),\xe2\x80\x89(2,\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x891)], [(2,\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x891),\xe2\x80\x89(2,\xe2\x80\x892)] and so on. Thus, this infinite spiral passes through each integer point of the plane.Valera the horse lives on the plane at coordinates (0,\xe2\x80\x890). He wants to walk along the spiral to point (x,\xe2\x80\x89y). Valera the horse has four legs, so he finds turning very difficult. Count how many times he will have to turn if he goes along a spiral from point (0,\xe2\x80\x890) to point (x,\xe2\x80\x89y)." 1400

278B "New Problem" "brute force,strings" "Coming up with a new problem isn\'t as easy as many people think. Sometimes it is hard enough to name it. We\'ll consider a title original if it doesn\'t occur as a substring in any titles of recent Codeforces problems. You\'ve got the titles of n last problems \xe2\x80\x94 the strings, consisting of lowercase English letters. Your task is to find the shortest original title for the new problem. If there are multiple such titles, choose the lexicographically minimum one. Note, that title of the problem can\'t be an empty string.A substring s[l... r] (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|s|) of string s\xe2\x80\x89=\xe2\x80\x89s1s2... s|s| (where |s| is the length of string s) is string slsl\xe2\x80\x89+\xe2\x80\x891... sr.String x\xe2\x80\x89=\xe2\x80\x89x1x2... xp is lexicographically smaller than string y\xe2\x80\x89=\xe2\x80\x89y1y2... yq, if either p\xe2\x80\x89<\xe2\x80\x89q and x1\xe2\x80\x89=\xe2\x80\x89y1,\xe2\x80\x89x2\xe2\x80\x89=\xe2\x80\x89y2,\xe2\x80\x89... ,\xe2\x80\x89xp\xe2\x80\x89=\xe2\x80\x89yp, or there exists such number r (r\xe2\x80\x89<\xe2\x80\x89p,\xe2\x80\x89r\xe2\x80\x89<\xe2\x80\x89q), that x1\xe2\x80\x89=\xe2\x80\x89y1,\xe2\x80\x89x2\xe2\x80\x89=\xe2\x80\x89y2,\xe2\x80\x89... ,\xe2\x80\x89xr\xe2\x80\x89=\xe2\x80\x89yr and xr\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89<\xe2\x80\x89yr\xe2\x80\x89+\xe2\x80\x891. The string characters are compared by their ASCII codes." 1500

278A "Circle Line" implementation "The circle line of the Berland subway has n stations. We know the distances between all pairs of neighboring stations: d1 is the distance between the 1-st and the 2-nd station; d2 is the distance between the 2-nd and the 3-rd station;... dn\xe2\x80\x89-\xe2\x80\x891 is the distance between the n\xe2\x80\x89-\xe2\x80\x891-th and the n-th station; dn is the distance between the n-th and the 1-st station.The trains go along the circle line in both directions. Find the shortest distance between stations with numbers s and t." 800

277E "Binary Tree on Plane" flows,trees "A root tree is a directed acyclic graph that contains one node (root), from which there is exactly one path to any other node.A root tree is binary if each node has at most two outgoing arcs.When a binary tree is painted on the plane, all arcs should be directed from top to bottom. That is, each arc going from u to v must meet the condition yu\xe2\x80\x89>\xe2\x80\x89yv.You\'ve been given the coordinates of all tree nodes. Your task is to connect these nodes by arcs so as to get the binary root tree and make the total length of the arcs minimum. All arcs of the built tree must be directed from top to bottom." 2400

277D "Google Code Jam" dp,probabilities "Many of you must be familiar with the Google Code Jam round rules. Let us remind you of some key moments that are crucial to solving this problem. During the round, the participants are suggested to solve several problems, each divided into two subproblems: an easy one with small limits (Small input), and a hard one with large limits (Large input). You can submit a solution for Large input only after you\'ve solved the Small input for this problem. There are no other restrictions on the order of solving inputs. In particular, the participant can first solve the Small input, then switch to another problem, and then return to the Large input. Solving each input gives the participant some number of points (usually different for each problem). This takes into account only complete solutions that work correctly on all tests of the input. The participant gets the test result of a Small input right after he submits it, but the test result of a Large input are out only after the round\'s over. In the final results table the participants are sorted by non-increasing of received points. If the points are equal, the participants are sorted by ascending of time penalty. By the Google Code Jam rules the time penalty is the time when the last correct solution was submitted.Vasya decided to check out a new tactics on another round. As soon as the round begins, the boy quickly read all the problems and accurately evaluated the time it takes to solve them. Specifically, for each one of the n problems Vasya knows five values: Solving the Small input of the i-th problem gives to the participant scoreSmalli points, and solving the Large input gives scoreLargei more points. That is, the maximum number of points you can get for the i-th problem equals scoreSmalli\xe2\x80\x89+\xe2\x80\x89scoreLargei. Writing the solution for the Small input of the i-th problem takes exactly timeSmalli minutes for Vasya. Improving this code and turning it into the solution of the Large input takes another timeLargei minutes. Vasya\'s had much practice, so he solves all Small inputs from the first attempt. But it\'s not so easy with the Large input: there is the probFaili probability that the solution to the Large input will turn out to be wrong at the end of the round. Please keep in mind that these solutions do not affect the participants\' points and the time penalty.A round lasts for t minutes. The time for reading problems and submitting solutions can be considered to equal zero. Vasya is allowed to submit a solution exactly at the moment when the round ends.Vasya wants to choose a set of inputs and the order of their solution so as to make the expectation of the total received points maximum possible. If there are multiple ways to do this, he needs to minimize the expectation of the time penalty. Help Vasya to cope with this problem." 2800

277C Game games,implementation "Two players play the following game. Initially, the players have a knife and a rectangular sheet of paper, divided into equal square grid cells of unit size. The players make moves in turn, the player who can\'t make a move loses. In one move, a player can take the knife and cut the paper along any segment of the grid line (not necessarily from border to border). The part of the paper, that touches the knife at least once, is considered cut. There is one limit not to turn the game into an infinite cycle: each move has to cut the paper, that is the knife has to touch the part of the paper that is not cut before.Obviously, the game ends when the entire sheet is cut into 1\xe2\x80\x89\xc3\x97\xe2\x80\x891 blocks. During the game, the pieces of the sheet are not allowed to move. It is also prohibited to cut along the border. The coordinates of the ends of each cut must be integers.You are given an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m piece of paper, somebody has already made k cuts there. Your task is to determine who will win if the players start to play on this sheet. You can consider that both players play optimally well. If the first player wins, you also need to find the winning first move." 2400

277B "Set of Points" "constructive algorithms,geometry" "Convexity of a set of points on the plane is the size of the largest subset of points that form a convex polygon. Your task is to build a set of n points with the convexity of exactly m. Your set of points should not contain three points that lie on a straight line." 2300

277A "Learning Languages" "dfs and similar,dsu" "The ""BerCorp"" company has got n employees. These employees can use m approved official languages for the formal correspondence. The languages are numbered with integers from 1 to m. For each employee we have the list of languages, which he knows. This list could be empty, i. e. an employee may know no official languages. But the employees are willing to learn any number of official languages, as long as the company pays their lessons. A study course in one language for one employee costs 1 berdollar.Find the minimum sum of money the company needs to spend so as any employee could correspond to any other one (their correspondence can be indirect, i. e. other employees can help out translating)." 1400

276E "Little Girl and Problem on Trees" "data structures,graphs,trees" "A little girl loves problems on trees very much. Here\'s one of them.A tree is an undirected connected graph, not containing cycles. The degree of node x in the tree is the number of nodes y of the tree, such that each of them is connected with node x by some edge of the tree. Let\'s consider a tree that consists of n nodes. We\'ll consider the tree\'s nodes indexed from 1 to n. The cosidered tree has the following property: each node except for node number 1 has the degree of at most 2.Initially, each node of the tree contains number 0. Your task is to quickly process the requests of two types:  Request of form: 0 v x d. In reply to the request you should add x to all numbers that are written in the nodes that are located at the distance of at most d from node v. The distance between two nodes is the number of edges on the shortest path between them.  Request of form: 1 v. In reply to the request you should print the current number that is written in node v." 2100

276D "Little Girl and Maximum XOR" bitmasks,dp,greedy,implementation,math "A little girl loves problems on bitwise operations very much. Here\'s one of them.You are given two integers l and r. Let\'s consider the values of  for all pairs of integers a and b (l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r). Your task is to find the maximum value among all considered ones.Expression  means applying bitwise excluding or operation to integers x and y. The given operation exists in all modern programming languages, for example, in languages C++ and Java it is represented as ""^"", in Pascal \xe2\x80\x94 as ""xor""." 1700

276C "Little Girl and Maximum Sum" "data structures,greedy,implementation,sortings" "The little girl loves the problems on array queries very much.One day she came across a rather well-known problem: you\'ve got an array of n elements (the elements of the array are indexed starting from 1); also, there are q queries, each one is defined by a pair of integers li, ri (1\xe2\x89\xa4li\xe2\x89\xa4ri\xe2\x89\xa4n). You need to find for each query the sum of elements of the array with indexes from li to ri, inclusive.The little girl found the problem rather boring. She decided to reorder the array elements before replying to the queries in a way that makes the sum of query replies maximum possible. Your task is to find the value of this maximum sum." 1500

276B "Little Girl and Game" games,greedy "The Little Girl loves problems on games very much. Here\'s one of them.Two players have got a string s, consisting of lowercase English letters. They play a game that is described by the following rules:  The players move in turns; In one move the player can remove an arbitrary letter from string s.  If the player before his turn can reorder the letters in string s so as to get a palindrome, this player wins. A palindrome is a string that reads the same both ways (from left to right, and vice versa). For example, string ""abba"" is a palindrome and string ""abc"" isn\'t. Determine which player will win, provided that both sides play optimally well \xe2\x80\x94 the one who moves first or the one who moves second." 1300

276A "Lunch Rush" implementation "Having written another programming contest, three Rabbits decided to grab some lunch. The coach gave the team exactly k time units for the lunch break.The Rabbits have a list of n restaurants to lunch in: the i-th restaurant is characterized by two integers fi and ti. Value ti shows the time the Rabbits need to lunch in the i-th restaurant. If time ti exceeds the time k that the coach has given for the lunch break, then the Rabbits\' joy from lunching in this restaurant will equal fi\xe2\x80\x89-\xe2\x80\x89(ti\xe2\x80\x89-\xe2\x80\x89k). Otherwise, the Rabbits get exactly fi units of joy.Your task is to find the value of the maximum joy the Rabbits can get from the lunch, depending on the restaurant. The Rabbits must choose exactly one restaurant to lunch in. Note that the joy value isn\'t necessarily a positive value." 900

275B "Convex Shape" "constructive algorithms,implementation" "Consider an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m grid. Initially all the cells of the grid are colored white. Lenny has painted some of the cells (at least one) black. We call a painted grid convex if one can walk from any black cell to any another black cell using a path of side-adjacent black cells changing his direction at most once during the path. In the figure below, the left grid is convex while the right one is not convex, because there exist two cells which need more than one time to change direction in their path.  You\'re given a painted grid in the input. Tell Lenny if the grid is convex or not." 1700

275A "Lights Out" implementation "Lenny is playing a game on a 3\xe2\x80\x89\xc3\x97\xe2\x80\x893 grid of lights. In the beginning of the game all lights are switched on. Pressing any of the lights will toggle it and all side-adjacent lights. The goal of the game is to switch all the lights off. We consider the toggling as follows: if the light was switched on then it will be switched off, if it was switched off then it will be switched on.Lenny has spent some time playing with the grid and by now he has pressed each light a certain number of times. Given the number of times each light is pressed, you have to print the current state of each light." 900

274E "Mirror Room" "data structures,implementation" "Imagine an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m grid with some blocked cells. The top left cell in the grid has coordinates (1,\xe2\x80\x891) and the bottom right cell has coordinates (n,\xe2\x80\x89m). There are k blocked cells in the grid and others are empty. You flash a laser beam from the center of an empty cell (xs,\xe2\x80\x89ys) in one of the diagonal directions (i.e. north-east, north-west, south-east or south-west). If the beam hits a blocked cell or the border of the grid it will reflect. The behavior of the beam reflection in different situations is depicted in the figure below.   After a while the beam enters an infinite cycle. Count the number of empty cells that the beam goes through at least once. We consider that the beam goes through cell if it goes through its center." 3000

274D "Lovely Matrix" "dfs and similar,graphs,greedy,sortings" "Lenny had an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m matrix of positive integers. He loved the matrix so much, because each row of the matrix was sorted in non-decreasing order. For the same reason he calls such matrices of integers lovely.One day when Lenny was at school his little brother was playing with Lenny\'s matrix in his room. He erased some of the entries of the matrix and changed the order of some of its columns. When Lenny got back home he was very upset. Now Lenny wants to recover his matrix.Help him to find an order for the columns of the matrix so that it\'s possible to fill in the erased entries of the matrix to achieve a lovely matrix again. Note, that you can fill the erased entries of the matrix with any integers." 2200

274C "The Last Hole!" "brute force,geometry" "Luyi has n circles on the plane. The i-th circle is centered at (xi,\xe2\x80\x89yi). At the time zero circles start to grow simultaneously. In other words, the radius of each circle at time t (t\xe2\x80\x89>\xe2\x80\x890) is equal to t. The circles are drawn as black discs on an infinite white plane. So at each moment the plane consists of several black and white regions. Note that the circles may overlap while growing.  We define a hole as a closed, connected white region. For instance, the figure contains two holes shown by red border. During growing some holes may be created and it is easy to see that each created hole will disappear eventually. Luyi asks you to find moment of time such that the last hole disappears. In other words, you should find the first moment such that no hole can be seen after that." 2600

274B "Zero Tree" "dfs and similar,dp,greedy,trees" "A tree is a graph with n vertices and exactly n\xe2\x80\x89-\xe2\x80\x891 edges; this graph should meet the following condition: there exists exactly one shortest (by number of edges) path between any pair of its vertices.A subtree of a tree T is a tree with both vertices and edges as subsets of vertices and edges of T.You\'re given a tree with n vertices. Consider its vertices numbered with integers from 1 to n. Additionally an integer is written on every vertex of this tree. Initially the integer written on the i-th vertex is equal to vi. In one move you can apply the following operation:  Select the subtree of the given tree that includes the vertex with number 1.  Increase (or decrease) by one all the integers which are written on the vertices of that subtree. Calculate the minimum number of moves that is required to make all the integers written on the vertices of the given tree equal to zero." 1800

274A "k-Multiple Free Set" "binary search,greedy,sortings" "A k-multiple free set is a set of integers where there is no pair of integers where one is equal to another integer multiplied by k. That is, there are no two integers x and y (x\xe2\x80\x89<\xe2\x80\x89y) from the set, such that y\xe2\x80\x89=\xe2\x80\x89x\xc2\xb7k.You\'re given a set of n distinct positive integers. Your task is to find the size of it\'s largest k-multiple free subset." 1500

273E "Dima and Game" dp,games "Dima and Anya love playing different games. Now Dima has imagined a new game that he wants to play with Anya.Dima writes n pairs of integers on a piece of paper (li,\xe2\x80\x89ri) (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89li\xe2\x80\x89<\xe2\x80\x89ri\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89p). Then players take turns. On his turn the player can do the following actions:  choose the number of the pair i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n), such that ri\xe2\x80\x89-\xe2\x80\x89li\xe2\x80\x89>\xe2\x80\x892;  replace pair number i by pair  or by pair . Notation \xe2\x8c\x8ax\xe2\x8c\x8b means rounding down to the closest integer. The player who can\'t make a move loses.Of course, Dima wants Anya, who will move first, to win. That\'s why Dima should write out such n pairs of integers (li,\xe2\x80\x89ri) (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89li\xe2\x80\x89<\xe2\x80\x89ri\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89p), that if both players play optimally well, the first one wins. Count the number of ways in which Dima can do it. Print the remainder after dividing the answer by number 1000000007�(109\xe2\x80\x89+\xe2\x80\x897).Two ways are considered distinct, if the ordered sequences of the written pairs are distinct." 2600

273D "Dima and Figure" dp "Dima loves making pictures on a piece of squared paper. And yet more than that Dima loves the pictures that depict one of his favorite figures. A piece of squared paper of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m is represented by a table, consisting of n rows and m columns. All squares are white on blank squared paper. Dima defines a picture as an image on a blank piece of paper, obtained by painting some squares black.The picture portrays one of Dima\'s favorite figures, if the following conditions hold:  The picture contains at least one painted cell;  All painted cells form a connected set, that is, you can get from any painted cell to any other one (you can move from one cell to a side-adjacent one);  The minimum number of moves needed to go from the painted cell at coordinates (x1,\xe2\x80\x89y1) to the painted cell at coordinates (x2,\xe2\x80\x89y2), moving only through the colored cells, equals |x1\xe2\x80\x89-\xe2\x80\x89x2|\xe2\x80\x89+\xe2\x80\x89|y1\xe2\x80\x89-\xe2\x80\x89y2|. Now Dima is wondering: how many paintings are on an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m piece of paper, that depict one of his favorite figures? Count this number modulo 1000000007�(109\xe2\x80\x89+\xe2\x80\x897)." 2400

272E "Dima and Horses" "combinatorics,constructive algorithms,graphs" "Dima came to the horse land. There are n horses living in the land. Each horse in the horse land has several enemies (enmity is a symmetric relationship). The horse land isn\'t very hostile, so the number of enemies of each horse is at most 3.Right now the horse land is going through an election campaign. So the horses trusted Dima to split them into two parts. At that the horses want the following condition to hold: a horse shouldn\'t have more than one enemy in its party.Help Dima split the horses into parties. Note that one of the parties can turn out to be empty." 2200

272D "Dima and Two Sequences" combinatorics,math,sortings "Little Dima has two sequences of points with integer coordinates: sequence (a1,\xe2\x80\x891),\xe2\x80\x89(a2,\xe2\x80\x892),\xe2\x80\x89...,\xe2\x80\x89(an,\xe2\x80\x89n) and sequence (b1,\xe2\x80\x891),\xe2\x80\x89(b2,\xe2\x80\x892),\xe2\x80\x89...,\xe2\x80\x89(bn,\xe2\x80\x89n).Now Dima wants to count the number of distinct sequences of points of length 2\xc2\xb7n that can be assembled from these sequences, such that the x-coordinates of points in the assembled sequence will not decrease. Help him with that. Note that each element of the initial sequences should be used exactly once in the assembled sequence.Dima considers two assembled sequences (p1,\xe2\x80\x89q1),\xe2\x80\x89(p2,\xe2\x80\x89q2),\xe2\x80\x89...,\xe2\x80\x89(p2\xc2\xb7n,\xe2\x80\x89q2\xc2\xb7n) and (x1,\xe2\x80\x89y1),\xe2\x80\x89(x2,\xe2\x80\x89y2),\xe2\x80\x89...,\xe2\x80\x89(x2\xc2\xb7n,\xe2\x80\x89y2\xc2\xb7n) distinct, if there is such i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x892\xc2\xb7n), that (pi,\xe2\x80\x89qi)\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89(xi,\xe2\x80\x89yi).As the answer can be rather large, print the remainder from dividing the answer by number m." 1600

272C "Dima and Staircase" "data structures,implementation" "Dima\'s got a staircase that consists of n stairs. The first stair is at height a1, the second one is at a2, the last one is at an (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89...\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89an). Dima decided to play with the staircase, so he is throwing rectangular boxes at the staircase from above. The i-th box has width wi and height hi. Dima throws each box vertically down on the first wi stairs of the staircase, that is, the box covers stairs with numbers 1,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89wi. Each thrown box flies vertically down until at least one of the two following events happen:  the bottom of the box touches the top of a stair;  the bottom of the box touches the top of a box, thrown earlier. We only consider touching of the horizontal sides of stairs and boxes, at that touching with the corners isn\'t taken into consideration. Specifically, that implies that a box with width wi cannot touch the stair number wi\xe2\x80\x89+\xe2\x80\x891.You are given the description of the staircase and the sequence in which Dima threw the boxes at it. For each box, determine how high the bottom of the box after landing will be. Consider a box to fall after the previous one lands." 1500

272B "Dima and Sequence" implementation,math "Dima got into number sequences. Now he\'s got sequence a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an, consisting of n positive integers. Also, Dima has got a function f(x), which can be defined with the following recurrence:  f(0)\xe2\x80\x89=\xe2\x80\x890;  f(2\xc2\xb7x)\xe2\x80\x89=\xe2\x80\x89f(x);  f(2\xc2\xb7x\xe2\x80\x89+\xe2\x80\x891)\xe2\x80\x89=\xe2\x80\x89f(x)\xe2\x80\x89+\xe2\x80\x891. Dima wonders, how many pairs of indexes (i,\xe2\x80\x89j) (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) are there, such that f(ai)\xe2\x80\x89=\xe2\x80\x89f(aj). Help him, count the number of such pairs." 1400

272A "Dima and Friends" implementation,math "Dima and his friends have been playing hide and seek at Dima\'s place all night. As a result, Dima\'s place got messy. In the morning they decided that they need to clean the place.To decide who exactly would clean the apartment, the friends want to play a counting-out game. First, all the guys stand in a circle, and then each of them shows some number of fingers on one hand (one to five), and then the boys count in a circle, starting from Dima, the number of people, respective to the total number of fingers shown. The person on who the countdown stops will clean the apartment.For example, if Dima and one of his friends played hide and seek, and 7 fingers were shown during the counting-out, then Dima would clean the place. If there were 2 or say, 8 fingers shown, then his friend would clean the place.Dima knows how many fingers each of his friends will show during the counting-out. Now he is interested in the number of ways to show some number of fingers on one hand (one to five), so that he did not have to clean the place. Help Dima." 1000

271E "Three Horses" "constructive algorithms,math,number theory" "There are three horses living in a horse land: one gray, one white and one gray-and-white. The horses are really amusing animals, which is why they adore special cards. Each of those cards must contain two integers, the first one on top, the second one in the bottom of the card. Let\'s denote a card with a on the top and b in the bottom as (a,\xe2\x80\x89b).Each of the three horses can paint the special cards. If you show an (a,\xe2\x80\x89b) card to the gray horse, then the horse can paint a new (a\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89b\xe2\x80\x89+\xe2\x80\x891) card. If you show an (a,\xe2\x80\x89b) card, such that a and b are even integers, to the white horse, then the horse can paint a new  card. If you show two cards (a,\xe2\x80\x89b) and (b,\xe2\x80\x89c) to the gray-and-white horse, then he can paint a new (a,\xe2\x80\x89c) card.Polycarpus really wants to get n special cards (1,\xe2\x80\x89a1), (1,\xe2\x80\x89a2), ..., (1,\xe2\x80\x89an). For that he is going to the horse land. He can take exactly one (x,\xe2\x80\x89y) card to the horse land, such that 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89<\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m. How many ways are there to choose the card so that he can perform some actions in the horse land and get the required cards?Polycarpus can get cards from the horses only as a result of the actions that are described above. Polycarpus is allowed to get additional cards besides the cards that he requires." 2200

271D "Good Substrings" "data structures,strings" "You\'ve got string s, consisting of small English letters. Some of the English letters are good, the rest are bad.A substring s[l...r] (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|s|) of string s\xe2\x80\x89\xe2\x80\x89=\xe2\x80\x89\xe2\x80\x89s1s2...s|s| (where |s| is the length of string s) is string \xe2\x80\x89slsl\xe2\x80\x89+\xe2\x80\x891...sr.The substring s[l...r] is good, if among the letters \xe2\x80\x89sl,\xe2\x80\x89sl\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89sr there are at most k bad ones (look at the sample\'s explanation to understand it more clear).Your task is to find the number of distinct good substrings of the given string s. Two substrings s[x...y] and s[p...q] are considered distinct if their content is different, i.e. s[x...y]\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89s[p...q]." 1800

271C Secret "constructive algorithms,implementation" "The Greatest Secret Ever consists of n words, indexed by positive integers from 1 to n. The secret needs dividing between k Keepers (let\'s index them by positive integers from 1 to k), the i-th Keeper gets a non-empty set of words with numbers from the set Ui\xe2\x80\x89=\xe2\x80\x89(ui,\xe2\x80\x891,\xe2\x80\x89ui,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89ui,\xe2\x80\x89|Ui|). Here and below we\'ll presuppose that the set elements are written in the increasing order.We\'ll say that the secret is safe if the following conditions are hold:  for any two indexes i,\xe2\x80\x89j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k) the intersection of sets Ui and Uj is an empty set;  the union of sets U1,\xe2\x80\x89U2,\xe2\x80\x89...,\xe2\x80\x89Uk is set (1,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89n);  in each set Ui, its elements ui,\xe2\x80\x891,\xe2\x80\x89ui,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89ui,\xe2\x80\x89|Ui| do not form an arithmetic progression (in particular, |Ui|\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x893 should hold). Let us remind you that the elements of set (u1,\xe2\x80\x89u2,\xe2\x80\x89...,\xe2\x80\x89us) form an arithmetic progression if there is such number d, that for all i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89s) fulfills ui\xe2\x80\x89+\xe2\x80\x89d\xe2\x80\x89=\xe2\x80\x89ui\xe2\x80\x89+\xe2\x80\x891. For example, the elements of sets (5), (1,\xe2\x80\x8910) and (1,\xe2\x80\x895,\xe2\x80\x899) form arithmetic progressions and the elements of sets (1,\xe2\x80\x892,\xe2\x80\x894) and (3,\xe2\x80\x896,\xe2\x80\x898) don\'t.Your task is to find any partition of the set of words into subsets U1,\xe2\x80\x89U2,\xe2\x80\x89...,\xe2\x80\x89Uk so that the secret is safe. Otherwise indicate that there\'s no such partition." 1500

271B "Prime Matrix" "binary search,brute force,math,number theory" "You\'ve got an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m matrix. The matrix consists of integers. In one move, you can apply a single transformation to the matrix: choose an arbitrary element of the matrix and increase it by 1. Each element can be increased an arbitrary number of times.You are really curious about prime numbers. Let us remind you that a prime number is a positive integer that has exactly two distinct positive integer divisors: itself and number one. For example, numbers 2, 3, 5 are prime and numbers 1, 4, 6 are not. A matrix is prime if at least one of the two following conditions fulfills:  the matrix has a row with prime numbers only;  the matrix has a column with prime numbers only; Your task is to count the minimum number of moves needed to get a prime matrix from the one you\'ve got." 1300

271A "Beautiful Year" "brute force" "It seems like the year of 2013 came only yesterday. Do you know a curious fact? The year of 2013 is the first year after the old 1987 with only distinct digits.Now you are suggested to solve the following problem: given a year number, find the minimum year number which is strictly larger than the given one and has only distinct digits." 800

270B Multithreading "data structures,greedy,implementation" "Emuskald is addicted to Codeforces, and keeps refreshing the main page not to miss any changes in the ""recent actions"" list. He likes to read thread conversations where each thread consists of multiple messages.Recent actions shows a list of n different threads ordered by the time of the latest message in the thread. When a new message is posted in a thread that thread jumps on the top of the list. No two messages of different threads are ever posted at the same time.Emuskald has just finished reading all his opened threads and refreshes the main page for some more messages to feed his addiction. He notices that no new threads have appeared in the list and at the i-th place in the list there is a thread that was at the ai-th place before the refresh. He doesn\'t want to waste any time reading old messages so he wants to open only threads with new messages.Help Emuskald find out the number of threads that surely have new messages. A thread x surely has a new message if there is no such sequence of thread updates (posting messages) that both conditions hold:   thread x is not updated (it has no new messages);  the list order 1, 2, ..., n changes to a1, a2, ..., an." 1400

270A "Fancy Fence" geometry,implementation,math "Emuskald needs a fence around his farm, but he is too lazy to build it himself. So he purchased a fence-building robot.He wants the fence to be a regular polygon. The robot builds the fence along a single path, but it can only make fence corners at a single angle a.Will the robot be able to build the fence Emuskald wants? In other words, is there a regular polygon which angles are equal to a?" 1100

269E "String Theory" geometry,math,strings "Emuskald is an innovative musician and always tries to push the boundaries of music production. Now he has come up with an idea for a revolutionary musical instrument \xe2\x80\x94 a rectangular harp.A rectangular harp is a rectangle n\xe2\x80\x89\xc3\x97\xe2\x80\x89m consisting of n rows and m columns. The rows are numbered 1 to n from top to bottom. Similarly the columns are numbered 1 to m from left to right. String pins are spaced evenly across every side, one per unit. Thus there are n pins on the left and right sides of the harp and m pins on its top and bottom. The harp has exactly n\xe2\x80\x89+\xe2\x80\x89m different strings, each string connecting two different pins, each on a different side of the harp.Emuskald has ordered his apprentice to construct the first ever rectangular harp. However, he didn\'t mention that no two strings can cross, otherwise it would be impossible to play the harp. Two strings cross if the segments connecting their pins intersect. To fix the harp, Emuskald can perform operations of two types:   pick two different columns and swap their pins on each side of the harp, not changing the pins that connect each string;  pick two different rows and swap their pins on each side of the harp, not changing the pins that connect each string; In the following example, he can fix the harp by swapping two columns:   Help Emuskald complete his creation and find the permutations how the rows and columns of the harp need to be rearranged, or tell that it is impossible to do so. He can detach and reattach each string to its pins, so the physical layout of the strings doesn\'t matter." 3100

269D "Maximum Waterfall" "data structures,dp,graphs,sortings" "Emuskald was hired to design an artificial waterfall according to the latest trends in landscape architecture. A modern artificial waterfall consists of multiple horizontal panels affixed to a wide flat wall. The water flows down the top of the wall from panel to panel until it reaches the bottom of the wall.The wall has height t and has n panels on the wall. Each panel is a horizontal segment at height hi which begins at li and ends at ri. The i-th panel connects the points (li,\xe2\x80\x89hi) and (ri,\xe2\x80\x89hi) of the plane. The top of the wall can be considered a panel connecting the points (\xe2\x80\x89-\xe2\x80\x89109,\xe2\x80\x89t) and (109,\xe2\x80\x89t). Similarly, the bottom of the wall can be considered a panel connecting the points (\xe2\x80\x89-\xe2\x80\x89109,\xe2\x80\x890) and (109,\xe2\x80\x890). No two panels share a common point.Emuskald knows that for the waterfall to be aesthetically pleasing, it can flow from panel i to panel j () only if the following conditions hold:   max(li,\xe2\x80\x89lj)\xe2\x80\x89<\xe2\x80\x89min(ri,\xe2\x80\x89rj) (horizontal projections of the panels overlap);  hj\xe2\x80\x89<\xe2\x80\x89hi (panel j is below panel i);  there is no such panel k (hj\xe2\x80\x89<\xe2\x80\x89hk\xe2\x80\x89<\xe2\x80\x89hi) that the first two conditions hold for the pairs (i,\xe2\x80\x89k) and (k,\xe2\x80\x89j). Then the flow for  is equal to min(ri,\xe2\x80\x89rj)\xe2\x80\x89-\xe2\x80\x89max(li,\xe2\x80\x89lj), the length of their horizontal projection overlap.Emuskald has decided that in his waterfall the water will flow in a single path from top to bottom. If water flows to a panel (except the bottom of the wall), the water will fall further to exactly one lower panel. The total amount of water flow in the waterfall is then defined as the minimum horizontal projection overlap between two consecutive panels in the path of the waterfall. Formally:   the waterfall consists of a single path of panels ;  the flow of the waterfall is the minimum flow in the path .  To make a truly great waterfall Emuskald must maximize this water flow, but there are too many panels and he is having a hard time planning his creation. Below is an example of a waterfall Emuskald wants:  Help Emuskald maintain his reputation and find the value of the maximum possible water flow." 2600

269C "Flawed Flow" "constructive algorithms,flows,graphs,greedy" "Emuskald considers himself a master of flow algorithms. Now he has completed his most ingenious program yet \xe2\x80\x94 it calculates the maximum flow in an undirected graph. The graph consists of n vertices and m edges. Vertices are numbered from 1 to n. Vertices 1 and n being the source and the sink respectively.However, his max-flow algorithm seems to have a little flaw \xe2\x80\x94 it only finds the flow volume for each edge, but not its direction. Help him find for each edge the direction of the flow through this edges. Note, that the resulting flow should be correct maximum flow.More formally. You are given an undirected graph. For each it\'s undirected edge (ai, bi) you are given the flow volume ci. You should direct all edges in such way that the following conditions hold:  for each vertex v (1\xe2\x80\x89<\xe2\x80\x89v\xe2\x80\x89<\xe2\x80\x89n), sum of ci of incoming edges is equal to the sum of ci of outcoming edges;  vertex with number 1 has no incoming edges;  the obtained directed graph does not have cycles." 2100

269B "Greenhouse Effect" dp "Emuskald is an avid horticulturist and owns the world\'s longest greenhouse \xe2\x80\x94 it is effectively infinite in length.Over the years Emuskald has cultivated n plants in his greenhouse, of m different plant species numbered from 1 to m. His greenhouse is very narrow and can be viewed as an infinite line, with each plant occupying a single point on that line.Emuskald has discovered that each species thrives at a different temperature, so he wants to arrange m\xe2\x80\x89-\xe2\x80\x891 borders that would divide the greenhouse into m sections numbered from 1 to m from left to right with each section housing a single species. He is free to place the borders, but in the end all of the i-th species plants must reside in i-th section from the left.Of course, it is not always possible to place the borders in such way, so Emuskald needs to replant some of his plants. He can remove each plant from its position and place it anywhere in the greenhouse (at any real coordinate) with no plant already in it. Since replanting is a lot of stress for the plants, help Emuskald find the minimum number of plants he has to replant to be able to place the borders." 1700

269A "Magical Boxes" greedy,math "Emuskald is a well-known illusionist. One of his trademark tricks involves a set of magical boxes. The essence of the trick is in packing the boxes inside other boxes.From the top view each magical box looks like a square with side length equal to 2k (k is an integer, k\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x890) units. A magical box v can be put inside a magical box u, if side length of v is strictly less than the side length of u. In particular, Emuskald can put 4 boxes of side length 2k\xe2\x80\x89-\xe2\x80\x891 into one box of side length 2k, or as in the following figure:  Emuskald is about to go on tour performing around the world, and needs to pack his magical boxes for the trip. He has decided that the best way to pack them would be inside another magical box, but magical boxes are quite expensive to make. Help him find the smallest magical box that can fit all his boxes." 1600

268E Playlist math,probabilities,sortings "Manao\'s friends often send him new songs. He never listens to them right away. Instead, he compiles them into a playlist. When he feels that his mind is open to new music, he opens the playlist and starts to listen to the songs.Of course, there are some songs that Manao doesn\'t particuarly enjoy. To get more pleasure from the received songs, he invented the following procedure of listening to the playlist:  If after listening to some song Manao realizes that he liked it, then he remembers it and starts to listen to the next unlistened song.  If after listening to some song Manao realizes that he did not like it, he listens to all the songs he liked up to this point and then begins to listen to the next unlistened song. For example, if Manao has four songs in the playlist, A, B, C, D (in the corresponding order) and he is going to like songs A and C in the end, then the order of listening is the following:  Manao listens to A, he likes it, he remembers it.  Manao listens to B, he does not like it, so he listens to A, again.  Manao listens to C, he likes the song and he remembers it, too.  Manao listens to D, but does not enjoy it and re-listens to songs A and C. That is, in the end Manao listens to song A three times, to song C twice and songs B and D once. Note that if Manao once liked a song, he will never dislike it on a subsequent listening.Manao has received n songs: the i-th of them is li seconds long and Manao may like it with a probability of pi percents. The songs could get on Manao\'s playlist in any order, so Manao wants to know the maximum expected value of the number of seconds after which the listening process will be over, for all possible permutations of the songs in the playlist." 2100

268D "Wall Bars" dp "Manao is working for a construction company. Recently, an order came to build wall bars in a children\'s park. Manao was commissioned to develop a plan of construction, which will enable the company to save the most money.After reviewing the formal specifications for the wall bars, Manao discovered a number of controversial requirements and decided to treat them to the company\'s advantage. His resulting design can be described as follows:  Let\'s introduce some unit of length. The construction center is a pole of height n.  At heights 1,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89n exactly one horizontal bar sticks out from the pole. Each bar sticks in one of four pre-fixed directions.  A child can move from one bar to another if the distance between them does not exceed h and they stick in the same direction. If a child is on the ground, he can climb onto any of the bars at height between 1 and h. In Manao\'s construction a child should be able to reach at least one of the bars at heights n\xe2\x80\x89-\xe2\x80\x89h\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x89h\xe2\x80\x89+\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89n if he begins at the ground.   The figure to the left shows what a common set of wall bars looks like. The figure to the right shows Manao\'s construction Manao is wondering how many distinct construction designs that satisfy his requirements exist. As this number can be rather large, print the remainder after dividing it by 1000000009�(109\xe2\x80\x89+\xe2\x80\x899). Two designs are considered distinct if there is such height i, that the bars on the height i in these designs don\'t stick out in the same direction." 2300

268C "Beautiful Sets of Points" "constructive algorithms,implementation" "Manao has invented a new mathematical term \xe2\x80\x94 a beautiful set of points. He calls a set of points on a plane beautiful if it meets the following conditions:  The coordinates of each point in the set are integers.  For any two points from the set, the distance between them is a non-integer. Consider all points (x,\xe2\x80\x89y) which satisfy the inequations: 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n; 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m; x\xe2\x80\x89+\xe2\x80\x89y\xe2\x80\x89>\xe2\x80\x890. Choose their subset of maximum size such that it is also a beautiful set of points." 1500

268B Buttons implementation,math "Manao is trying to open a rather challenging lock. The lock has n buttons on it and to open it, you should press the buttons in a certain order to open the lock. When you push some button, it either stays pressed into the lock (that means that you\'ve guessed correctly and pushed the button that goes next in the sequence), or all pressed buttons return to the initial position. When all buttons are pressed into the lock at once, the lock opens.Consider an example with three buttons. Let\'s say that the opening sequence is: {2, 3, 1}. If you first press buttons 1 or 3, the buttons unpress immediately. If you first press button 2, it stays pressed. If you press 1 after 2, all buttons unpress. If you press 3 after 2, buttons 3 and 2 stay pressed. As soon as you\'ve got two pressed buttons, you only need to press button 1 to open the lock.Manao doesn\'t know the opening sequence. But he is really smart and he is going to act in the optimal way. Calculate the number of times he\'s got to push a button in order to open the lock in the worst-case scenario." 1000

268A Games "brute force" "Manao works on a sports TV. He\'s spent much time watching the football games of some country. After a while he began to notice different patterns. For example, each team has two sets of uniforms: home uniform and guest uniform. When a team plays a game at home, the players put on the home uniform. When a team plays as a guest on somebody else\'s stadium, the players put on the guest uniform. The only exception to that rule is: when the home uniform color of the host team matches the guests\' uniform, the host team puts on its guest uniform as well. For each team the color of the home and guest uniform is different.There are n teams taking part in the national championship. The championship consists of n\xc2\xb7(n\xe2\x80\x89-\xe2\x80\x891) games: each team invites each other team to its stadium. At this point Manao wondered: how many times during the championship is a host team going to put on the guest uniform? Note that the order of the games does not affect this number.You know the colors of the home and guest uniform for each team. For simplicity, the colors are numbered by integers in such a way that no two distinct colors have the same number. Help Manao find the answer to his question." 800

267C "Berland Traffic" math,matrices "Berland traffic is very different from traffic in other countries. The capital of Berland consists of n junctions and m roads. Each road connects a pair of junctions. There can be multiple roads between a pair of junctions. For each road we know its capacity: value ci is the maximum number of cars that can drive along a road in any direction per a unit of time. For each road, the cars can drive along it in one of two direction. That it, the cars can\'t simultaneously move in both directions. A road\'s traffic is the number of cars that goes along it per a unit of time. For road (ai,\xe2\x80\x89bi) this value is negative, if the traffic moves from bi to ai. A road\'s traffic can be a non-integer number.The capital has two special junctions \xe2\x80\x94 the entrance to the city (junction 1) and the exit from the city (junction n). For all other junctions it is true that the traffic is not lost there. That is, for all junctions except for 1 and n the incoming traffic sum equals the outgoing traffic sum.Traffic has an unusual peculiarity in the capital of Berland \xe2\x80\x94 for any pair of junctions (x,\xe2\x80\x89y) the sum of traffics along any path from x to y doesn\'t change depending on the choice of the path. Such sum includes traffic along all roads on the path (possible with the ""minus"" sign, if the traffic along the road is directed against the direction of the road on the path from x to y).Your task is to find the largest traffic that can pass trough the city per one unit of time as well as the corresponding traffic for each road." 2700

267B Dominoes "dfs and similar,graphs" "You have a set of dominoes. Each domino is a rectangular tile with a line dividing its face into two square ends. Can you put all dominoes in a line one by one from left to right so that any two dominoes touched with the sides that had the same number of points? You can rotate the dominoes, changing the left and the right side (domino ""1-4"" turns into ""4-1"")." 2000

267A Subtractions "math,number theory" "You\'ve got two numbers. As long as they are both larger than zero, they go through the same operation: subtract the lesser number from the larger one. If they equal substract one number from the another. For example, one operation transforms pair (4,17) to pair (4,13), it transforms (5,5) to (0,5).You\'ve got some number of pairs (ai,\xe2\x80\x89bi). How many operations will be performed for each of them?" 900

266E "More Queries to Array..." "data structures,math" "You\'ve got an array, consisting of n integers: a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. Your task is to quickly run the queries of two types: Assign value x to all elements from l to r inclusive. After such query the values of the elements of array al,\xe2\x80\x89al\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89ar become equal to x. Calculate and print sum , where k doesn\'t exceed 5. As the value of the sum can be rather large, you should print it modulo 1000000007�(109\xe2\x80\x89+\xe2\x80\x897)." 2500

266D BerDonalds "graphs,math,shortest paths" "BerDonalds, a well-known fast food restaurant, is going to open a cafe in Bertown. The important thing is to choose the new restaurant\'s location so that it would be easy to get there. The Bertown road system is represented by n junctions, connected by m bidirectional roads. For each road we know its length. We also know that we can get from any junction to any other one, moving along the roads.Your task is to find such location of the restaurant, that the shortest distance along the roads from the cafe to the farthest junction would be minimum. Note that the restaurant can be located not only on the junction, but at any point of any road." 2400

266C "Below the Diagonal" "constructive algorithms,greedy,math" "You are given a square matrix consisting of n rows and n columns. We assume that the rows are numbered from 1 to n from top to bottom and the columns are numbered from 1 to n from left to right. Some cells (n\xe2\x80\x89-\xe2\x80\x891 cells in total) of the the matrix are filled with ones, the remaining cells are filled with zeros. We can apply the following operations to the matrix:  Swap i-th and j-th rows of the matrix;  Swap i-th and j-th columns of the matrix. You are asked to transform the matrix into a special form using these operations. In that special form all the ones must be in the cells that lie below the main diagonal. Cell of the matrix, which is located on the intersection of the i-th row and of the j-th column, lies below the main diagonal if i\xe2\x80\x89>\xe2\x80\x89j." 2100

266B "Queue at the School" "constructive algorithms,graph matchings,implementation,shortest paths" "During the break the schoolchildren, boys and girls, formed a queue of n people in the canteen. Initially the children stood in the order they entered the canteen. However, after a while the boys started feeling awkward for standing in front of the girls in the queue and they started letting the girls move forward each second. Let\'s describe the process more precisely. Let\'s say that the positions in the queue are sequentially numbered by integers from 1 to n, at that the person in the position number 1 is served first. Then, if at time x a boy stands on the i-th position and a girl stands on the (i\xe2\x80\x89+\xe2\x80\x891)-th position, then at time x\xe2\x80\x89+\xe2\x80\x891 the i-th position will have a girl and the (i\xe2\x80\x89+\xe2\x80\x891)-th position will have a boy. The time is given in seconds.You\'ve got the initial position of the children, at the initial moment of time. Determine the way the queue is going to look after t seconds." 800

266A "Stones on the Table" implementation "There are n stones on the table in a row, each of them can be red, green or blue. Count the minimum number of stones to take from the table so that any two neighboring stones had different colors. Stones in a row are considered neighboring if there are no other stones between them." 800

265B "Roadside Trees (Simplified Edition)" greedy,implementation "Squirrel Liss loves nuts. There are n trees (numbered 1 to n from west to east) along a street and there is a delicious nut on the top of each tree. The height of the tree i is hi. Liss wants to eat all nuts.Now Liss is on the root of the tree with the number 1. In one second Liss can perform one of the following actions:  Walk up or down one unit on a tree.  Eat a nut on the top of the current tree.  Jump to the next tree. In this action the height of Liss doesn\'t change. More formally, when Liss is at height h of the tree i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x891), she jumps to height h of the tree i\xe2\x80\x89+\xe2\x80\x891. This action can\'t be performed if h\xe2\x80\x89>\xe2\x80\x89hi\xe2\x80\x89+\xe2\x80\x891. Compute the minimal time (in seconds) required to eat all nuts." 1000

265A "Colorful Stones (Simplified Edition)" implementation "There is a sequence of colorful stones. The color of each stone is one of red, green, or blue. You are given a string s. The i-th (1-based) character of s represents the color of the i-th stone. If the character is ""R"", ""G"", or ""B"", the color of the corresponding stone is red, green, or blue, respectively.Initially Squirrel Liss is standing on the first stone. You perform instructions one or more times.Each instruction is one of the three types: ""RED"", ""GREEN"", or ""BLUE"". After an instruction c, if Liss is standing on a stone whose colors is c, Liss will move one stone forward, else she will not move.You are given a string t. The number of instructions is equal to the length of t, and the i-th character of t represents the i-th instruction.Calculate the final position of Liss (the number of the stone she is going to stand on in the end) after performing all the instructions, and print its 1-based position. It is guaranteed that Liss don\'t move out of the sequence." 800

264E "Roadside Trees" "data structures,dp" "Squirrel Liss loves nuts. Liss asks you to plant some nut trees.There are n positions (numbered 1 to n from west to east) to plant a tree along a street. Trees grow one meter per month. At the beginning of each month you should process one query. The query is one of the following types:  Plant a tree of height h at position p.  Cut down the x-th existent (not cut) tree from the west (where x is 1-indexed). When we cut the tree it drops down and takes all the available place at the position where it has stood. So no tree can be planted at this position anymore. After processing each query, you should print the length of the longest increasing subsequence. A subset of existent trees is called an increasing subsequence if the height of the trees in the set is strictly increasing from west to east (for example, the westmost tree in the set must be the shortest in the set). The length of the increasing subsequence is the number of trees in it.Note that Liss don\'t like the trees with the same heights, so it is guaranteed that at any time no two trees have the exactly same heights." 3000

264D "Colorful Stones" "dp,two pointers" "There are two sequences of colorful stones. The color of each stone is one of red, green, or blue. You are given two strings s and t. The i-th (1-based) character of s represents the color of the i-th stone of the first sequence. Similarly, the i-th (1-based) character of t represents the color of the i-th stone of the second sequence. If the character is ""R"", ""G"", or ""B"", the color of the corresponding stone is red, green, or blue, respectively.Initially Squirrel Liss is standing on the first stone of the first sequence and Cat Vasya is standing on the first stone of the second sequence. You can perform the following instructions zero or more times.Each instruction is one of the three types: ""RED"", ""GREEN"", or ""BLUE"". After an instruction c, the animals standing on stones whose colors are c will move one stone forward. For example, if you perform an instruction \xc2\xabRED\xc2\xbb, the animals standing on red stones will move one stone forward. You are not allowed to perform instructions that lead some animals out of the sequences. In other words, if some animals are standing on the last stones, you can\'t perform the instructions of the colors of those stones.A pair of positions (position of Liss, position of Vasya) is called a state. A state is called reachable if the state is reachable by performing instructions zero or more times from the initial state (1, 1). Calculate the number of distinct reachable states." 2500

264C "Choosing Balls" dp "There are n balls. They are arranged in a row. Each ball has a color (for convenience an integer) and an integer value. The color of the i-th ball is ci and the value of the i-th ball is vi.Squirrel Liss chooses some balls and makes a new sequence without changing the relative order of the balls. She wants to maximize the value of this sequence.The value of the sequence is defined as the sum of following values for each ball (where a and b are given constants):  If the ball is not in the beginning of the sequence and the color of the ball is same as previous ball\'s color, add (the value of the ball) \xe2\x80\x89\xc3\x97\xe2\x80\x89 a.  Otherwise, add (the value of the ball) \xe2\x80\x89\xc3\x97\xe2\x80\x89 b. You are given q queries. Each query contains two integers ai and bi. For each query find the maximal value of the sequence she can make when a\xe2\x80\x89=\xe2\x80\x89ai and b\xe2\x80\x89=\xe2\x80\x89bi.Note that the new sequence can be empty, and the value of an empty sequence is defined as zero." 2000

264B "Good Sequences" "dp,number theory" "Squirrel Liss is interested in sequences. She also has preferences of integers. She thinks n integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an are good.Now she is interested in good sequences. A sequence x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xk is called good if it satisfies the following three conditions:  The sequence is strictly increasing, i.e. xi\xe2\x80\x89<\xe2\x80\x89xi\xe2\x80\x89+\xe2\x80\x891 for each i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k\xe2\x80\x89-\xe2\x80\x891).  No two adjacent elements are coprime, i.e. gcd(xi,\xe2\x80\x89xi\xe2\x80\x89+\xe2\x80\x891)\xe2\x80\x89>\xe2\x80\x891 for each i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k\xe2\x80\x89-\xe2\x80\x891) (where gcd(p,\xe2\x80\x89q) denotes the greatest common divisor of the integers p and q).  All elements of the sequence are good integers. Find the length of the longest good sequence." 1500

264A "Escape from Stones" "constructive algorithms,data structures,implementation,two pointers" "Squirrel Liss lived in a forest peacefully, but unexpected trouble happens. Stones fall from a mountain. Initially Squirrel Liss occupies an interval [0,\xe2\x80\x891]. Next, n stones will fall and Liss will escape from the stones. The stones are numbered from 1 to n in order.The stones always fall to the center of Liss\'s interval. When Liss occupies the interval [k\xe2\x80\x89-\xe2\x80\x89d,\xe2\x80\x89k\xe2\x80\x89+\xe2\x80\x89d] and a stone falls to k, she will escape to the left or to the right. If she escapes to the left, her new interval will be [k\xe2\x80\x89-\xe2\x80\x89d,\xe2\x80\x89k]. If she escapes to the right, her new interval will be [k,\xe2\x80\x89k\xe2\x80\x89+\xe2\x80\x89d].You are given a string s of length n. If the i-th character of s is ""l"" or ""r"", when the i-th stone falls Liss will escape to the left or to the right, respectively. Find the sequence of stones\' numbers from left to right after all the n stones falls." 1200

263E Rhombus "brute force,data structures,dp" "You\'ve got a table of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m. On the intersection of the i-th row (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) and the j-th column (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m) there is a non-negative integer ai,\xe2\x80\x89j. Besides, you\'ve got a non-negative integer k.Your task is to find such pair of integers (a,\xe2\x80\x89b) that meets these conditions:   k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x89k\xe2\x80\x89+\xe2\x80\x891;  k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m\xe2\x80\x89-\xe2\x80\x89k\xe2\x80\x89+\xe2\x80\x891;  let\'s denote the maximum of the function  among all integers x and y, that satisfy the inequalities k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x89k\xe2\x80\x89+\xe2\x80\x891 and k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m\xe2\x80\x89-\xe2\x80\x89k\xe2\x80\x89+\xe2\x80\x891, as mval; for the required pair of numbers the following equation must hold f(a,\xe2\x80\x89b)\xe2\x80\x89=\xe2\x80\x89mval." 2500

263D "Cycle in Graph" "dfs and similar,graphs" "You\'ve got a undirected graph G, consisting of n nodes. We will consider the nodes of the graph indexed by integers from 1 to n. We know that each node of graph G is connected by edges with at least k other nodes of this graph. Your task is to find in the given graph a simple cycle of length of at least k\xe2\x80\x89+\xe2\x80\x891.A simple cycle of length d (d\xe2\x80\x89>\xe2\x80\x891) in graph G is a sequence of distinct graph nodes v1,\xe2\x80\x89v2,\xe2\x80\x89...,\xe2\x80\x89vd such, that nodes v1 and vd are connected by an edge of the graph, also for any integer i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89d) nodes vi and vi\xe2\x80\x89+\xe2\x80\x891 are connected by an edge of the graph." 1800

263C "Circle of Numbers" "brute force,dfs and similar,implementation" "One day Vasya came up to the blackboard and wrote out n distinct integers from 1 to n in some order in a circle. Then he drew arcs to join the pairs of integers (a,\xe2\x80\x89b) (a\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89b), that are either each other\'s immediate neighbors in the circle, or there is number c, such that a and \xd1\x81 are immediate neighbors, and b and c are immediate neighbors. As you can easily deduce, in the end Vasya drew 2\xc2\xb7n arcs.For example, if the numbers are written in the circle in the order 1,\xe2\x80\x892,\xe2\x80\x893,\xe2\x80\x894,\xe2\x80\x895 (in the clockwise direction), then the arcs will join pairs of integers (1,\xe2\x80\x892), (2,\xe2\x80\x893), (3,\xe2\x80\x894), (4,\xe2\x80\x895), (5,\xe2\x80\x891), (1,\xe2\x80\x893), (2,\xe2\x80\x894), (3,\xe2\x80\x895), (4,\xe2\x80\x891) and (5,\xe2\x80\x892).Much time has passed ever since, the numbers we wiped off the blackboard long ago, but recently Vasya has found a piece of paper with 2\xc2\xb7n written pairs of integers that were joined with the arcs on the board. Vasya asks you to find the order of numbers in the circle by these pairs." 2000

263B Squares greedy,implementation,sortings "Vasya has found a piece of paper with a coordinate system written on it. There are n distinct squares drawn in this coordinate system. Let\'s number the squares with integers from 1 to n. It turned out that points with coordinates (0,\xe2\x80\x890) and (ai,\xe2\x80\x89ai) are the opposite corners of the i-th square.Vasya wants to find such integer point (with integer coordinates) of the plane, that belongs to exactly k drawn squares. We\'ll say that a point belongs to a square, if the point is located either inside the square, or on its boundary. Help Vasya find a point that would meet the described limits." 900

263A "Beautiful Matrix" implementation "You\'ve got a 5\xe2\x80\x89\xc3\x97\xe2\x80\x895 matrix, consisting of 24 zeroes and a single number one. Let\'s index the matrix rows by numbers from 1 to 5 from top to bottom, let\'s index the matrix columns by numbers from 1 to 5 from left to right. In one move, you are allowed to apply one of the two following transformations to the matrix:  Swap two neighboring matrix rows, that is, rows with indexes i and i\xe2\x80\x89+\xe2\x80\x891 for some integer i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x895).  Swap two neighboring matrix columns, that is, columns with indexes j and j\xe2\x80\x89+\xe2\x80\x891 for some integer j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89<\xe2\x80\x895). You think that a matrix looks beautiful, if the single number one of the matrix is located in its middle (in the cell that is on the intersection of the third row and the third column). Count the minimum number of moves needed to make the matrix beautiful." 800

262B "Roma and Changing Signs" greedy "Roma works in a company that sells TVs. Now he has to prepare a report for the last year.Roma has got a list of the company\'s incomes. The list is a sequence that consists of n integers. The total income of the company is the sum of all integers in sequence. Roma decided to perform exactly k changes of signs of several numbers in the sequence. He can also change the sign of a number one, two or more times.The operation of changing a number\'s sign is the operation of multiplying this number by -1.Help Roma perform the changes so as to make the total income of the company (the sum of numbers in the resulting sequence) maximum. Note that Roma should perform exactly k changes." 1200

262A "Roma and Lucky Numbers" implementation "Roma (a popular Russian name that means \'Roman\') loves the Little Lvov Elephant\'s lucky numbers.Let us remind you that lucky numbers are positive integers whose decimal representation only contains lucky digits 4 and 7. For example, numbers 47, 744, 4 are lucky and 5, 17, 467 are not.Roma\'s got n positive integers. He wonders, how many of those integers have not more than k lucky digits? Help him, write the program that solves the problem." 800

261E "Maxim and Calculator" "brute force,dp,two pointers" "Maxim has got a calculator. The calculator has two integer cells. Initially, the first cell contains number 1, and the second cell contains number 0. In one move you can perform one of the following operations:  Let\'s assume that at the current time the first cell contains number a, and the second cell contains number b. Write to the second cell number b\xe2\x80\x89+\xe2\x80\x891;  Let\'s assume that at the current time the first cell contains number a, and the second cell contains number b. Write to the first cell number a\xc2\xb7b. Maxim is wondering, how many integers x (l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r) are there, such that we can write the number x to the first cell of the calculator, having performed at most p moves." 2800

261D "Maxim and Increasing Subsequence" dp "Maxim loves sequences, especially those that strictly increase. He is wondering, what is the length of the longest increasing subsequence of the given sequence a?Sequence a is given as follows:   the length of the sequence equals n\xe2\x80\x89\xc3\x97\xe2\x80\x89t;   (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89\xc3\x97\xe2\x80\x89t), where operation  means taking the remainder after dividing number x by number y. Sequence s1,\xe2\x80\x89\xe2\x80\x89s2,\xe2\x80\x89\xe2\x80\x89...,\xe2\x80\x89\xe2\x80\x89sr of length r is a subsequence of sequence a1,\xe2\x80\x89\xe2\x80\x89a2,\xe2\x80\x89\xe2\x80\x89...,\xe2\x80\x89\xe2\x80\x89an, if there is such increasing sequence of indexes i1,\xe2\x80\x89i2,\xe2\x80\x89...,\xe2\x80\x89ir (1\xe2\x80\x89\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89\xe2\x80\x89i1\xe2\x80\x89\xe2\x80\x89<\xe2\x80\x89\xe2\x80\x89i2\xe2\x80\x89\xe2\x80\x89<\xe2\x80\x89... \xe2\x80\x89\xe2\x80\x89<\xe2\x80\x89\xe2\x80\x89ir\xe2\x80\x89\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89\xe2\x80\x89n), that aij\xe2\x80\x89\xe2\x80\x89=\xe2\x80\x89\xe2\x80\x89sj. In other words, the subsequence can be obtained from the sequence by crossing out some elements.Sequence s1,\xe2\x80\x89\xe2\x80\x89s2,\xe2\x80\x89\xe2\x80\x89...,\xe2\x80\x89\xe2\x80\x89sr is increasing, if the following inequality holds: s1\xe2\x80\x89<\xe2\x80\x89s2\xe2\x80\x89<\xe2\x80\x89\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89\xe2\x80\x89sr.Maxim have k variants of the sequence a. Help Maxim to determine for each sequence the length of the longest increasing subsequence." 2600

261C "Maxim and Matrix" "constructive algorithms,dp,math" "Maxim loves to fill in a matrix in a special manner. Here is a pseudocode of filling in a matrix of size (m\xe2\x80\x89+\xe2\x80\x891)\xe2\x80\x89\xc3\x97\xe2\x80\x89(m\xe2\x80\x89+\xe2\x80\x891):Maxim asks you to count, how many numbers m (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) are there, such that the sum of values in the cells in the row number m\xe2\x80\x89+\xe2\x80\x891 of the resulting matrix equals t.Expression (x xor y) means applying the operation of bitwise excluding ""OR"" to numbers x and y. The given operation exists in all modern programming languages. For example, in languages C++ and Java it is represented by character ""^"", in Pascal \xe2\x80\x94 by ""xor""." 2000

261B "Maxim and Restaurant" dp,math,probabilities "Maxim has opened his own restaurant! The restaurant has got a huge table, the table\'s length is p meters.Maxim has got a dinner party tonight, n guests will come to him. Let\'s index the guests of Maxim\'s restaurant from 1 to n. Maxim knows the sizes of all guests that are going to come to him. The i-th guest\'s size (ai) represents the number of meters the guest is going to take up if he sits at the restaurant table.Long before the dinner, the guests line up in a queue in front of the restaurant in some order. Then Maxim lets the guests in, one by one. Maxim stops letting the guests in when there is no place at the restaurant table for another guest in the queue. There is no place at the restaurant table for another guest in the queue, if the sum of sizes of all guests in the restaurant plus the size of this guest from the queue is larger than p. In this case, not to offend the guest who has no place at the table, Maxim doesn\'t let any other guest in the restaurant, even if one of the following guests in the queue would have fit in at the table.Maxim is now wondering, what is the average number of visitors who have come to the restaurant for all possible n! orders of guests in the queue. Help Maxim, calculate this number." 1900

261A "Maxim and Discounts" greedy,sortings "Maxim always goes to the supermarket on Sundays. Today the supermarket has a special offer of discount systems.There are m types of discounts. We assume that the discounts are indexed from 1 to m. To use the discount number i, the customer takes a special basket, where he puts exactly qi items he buys. Under the terms of the discount system, in addition to the items in the cart the customer can receive at most two items from the supermarket for free. The number of the ""free items"" (0, 1 or 2) to give is selected by the customer. The only condition imposed on the selected ""free items"" is as follows: each of them mustn\'t be more expensive than the cheapest item out of the qi items in the cart.Maxim now needs to buy n items in the shop. Count the minimum sum of money that Maxim needs to buy them, if he use the discount system optimally well.Please assume that the supermarket has enough carts for any actions. Maxim can use the same discount multiple times. Of course, Maxim can buy items without any discounts." 1400

260E "Dividing Kingdom" "binary search,brute force,data structures" "A country called Flatland is an infinite two-dimensional plane. Flatland has n cities, each of them is a point on the plane.Flatland is ruled by king Circle IV. Circle IV has 9 sons. He wants to give each of his sons part of Flatland to rule. For that, he wants to draw four distinct straight lines, such that two of them are parallel to the Ox axis, and two others are parallel to the Oy axis. At that, no straight line can go through any city. Thus, Flatland will be divided into 9 parts, and each son will be given exactly one of these parts. Circle IV thought a little, evaluated his sons\' obedience and decided that the i-th son should get the part of Flatland that has exactly ai cities.Help Circle find such four straight lines that if we divide Flatland into 9 parts by these lines, the resulting parts can be given to the sons so that son number i got the part of Flatland which contains ai cities." 2500

260D "Black and White Tree" "constructive algorithms,dsu,graphs,greedy,trees" "The board has got a painted tree graph, consisting of n nodes. Let us remind you that a non-directed graph is called a tree if it is connected and doesn\'t contain any cycles.Each node of the graph is painted black or white in such a manner that there aren\'t two nodes of the same color, connected by an edge. Each edge contains its value written on it as a non-negative integer.A bad boy Vasya came up to the board and wrote number sv near each node v \xe2\x80\x94 the sum of values of all edges that are incident to this node. Then Vasya removed the edges and their values from the board.Your task is to restore the original tree by the node colors and numbers sv." 2100

260C "Balls and Boxes" "constructive algorithms,greedy,implementation" "Little Vasya had n boxes with balls in the room. The boxes stood in a row and were numbered with numbers from 1 to n from left to right.Once Vasya chose one of the boxes, let\'s assume that its number is i, took all balls out from it (it is guaranteed that this box originally had at least one ball), and began putting balls (one at a time) to the boxes with numbers i\xe2\x80\x89+\xe2\x80\x891, i\xe2\x80\x89+\xe2\x80\x892, i\xe2\x80\x89+\xe2\x80\x893 and so on. If Vasya puts a ball into the box number n, then the next ball goes to box 1, the next one goes to box 2 and so on. He did it until he had no balls left in his hands. It is possible that Vasya puts multiple balls to the same box, and it is also possible that one or more balls will go to the box number i. If i\xe2\x80\x89=\xe2\x80\x89n, Vasya puts the first ball into the box number 1, then the next ball goes to box 2 and so on. For example, let\'s suppose that initially Vasya had four boxes, and the first box had 3 balls, the second one had 2, the third one had 5 and the fourth one had 4 balls. Then, if i\xe2\x80\x89=\xe2\x80\x893, then Vasya will take all five balls out of the third box and put them in the boxes with numbers: 4,\xe2\x80\x891,\xe2\x80\x892,\xe2\x80\x893,\xe2\x80\x894. After all Vasya\'s actions the balls will lie in the boxes as follows: in the first box there are 4 balls, 3 in the second one, 1 in the third one and 6 in the fourth one.At this point Vasya has completely forgotten the original arrangement of the balls in the boxes, but he knows how they are arranged now, and the number x \xe2\x80\x94 the number of the box, where he put the last of the taken out balls.He asks you to help to find the initial arrangement of the balls in the boxes." 1700

260B "Ancient Prophesy" "brute force,implementation,strings" "A recently found Ancient Prophesy is believed to contain the exact Apocalypse date. The prophesy is a string that only consists of digits and characters ""-"".We\'ll say that some date is mentioned in the Prophesy if there is a substring in the Prophesy that is the date\'s record in the format ""dd-mm-yyyy"". We\'ll say that the number of the date\'s occurrences is the number of such substrings in the Prophesy. For example, the Prophesy ""0012-10-2012-10-2012"" mentions date 12-10-2012 twice (first time as ""0012-10-2012-10-2012"", second time as ""0012-10-2012-10-2012"").The date of the Apocalypse is such correct date that the number of times it is mentioned in the Prophesy is strictly larger than that of any other correct date.A date is correct if the year lies in the range from 2013 to 2015, the month is from 1 to 12, and the number of the day is strictly more than a zero and doesn\'t exceed the number of days in the current month. Note that a date is written in the format ""dd-mm-yyyy"", that means that leading zeroes may be added to the numbers of the months or days if needed. In other words, date ""1-1-2013"" isn\'t recorded in the format ""dd-mm-yyyy"", and date ""01-01-2013"" is recorded in it.Notice, that any year between 2013 and 2015 is not a leap year." 1600

260A "Adding Digits" implementation,math "Vasya has got two number: a and b. However, Vasya finds number a too short. So he decided to repeat the operation of lengthening number a n times.One operation of lengthening a number means adding exactly one digit to the number (in the decimal notation) to the right provided that the resulting number is divisible by Vasya\'s number b. If it is impossible to obtain the number which is divisible by b, then the lengthening operation cannot be performed.Your task is to help Vasya and print the number he can get after applying the lengthening operation to number a n times." 1400

259B "Little Elephant and Magic Square" "brute force,implementation" "Little Elephant loves magic squares very much.A magic square is a 3\xe2\x80\x89\xc3\x97\xe2\x80\x893 table, each cell contains some positive integer. At that the sums of integers in all rows, columns and diagonals of the table are equal. The figure below shows the magic square, the sum of integers in all its rows, columns and diagonals equals 15.  The Little Elephant remembered one magic square. He started writing this square on a piece of paper, but as he wrote, he forgot all three elements of the main diagonal of the magic square. Fortunately, the Little Elephant clearly remembered that all elements of the magic square did not exceed 105. Help the Little Elephant, restore the original magic square, given the Elephant\'s notes." 1100

259A "Little Elephant and Chess" "brute force,strings" "The Little Elephant loves chess very much. One day the Little Elephant and his friend decided to play chess. They\'ve got the chess pieces but the board is a problem. They\'ve got an 8\xe2\x80\x89\xc3\x97\xe2\x80\x898 checkered board, each square is painted either black or white. The Little Elephant and his friend know that a proper chessboard doesn\'t have any side-adjacent cells with the same color and the upper left cell is white. To play chess, they want to make the board they have a proper chessboard. For that the friends can choose any row of the board and cyclically shift the cells of the chosen row, that is, put the last (rightmost) square on the first place in the row and shift the others one position to the right. You can run the described operation multiple times (or not run it at all).For example, if the first line of the board looks like that ""BBBBBBWW"" (the white cells of the line are marked with character ""W"", the black cells are marked with character ""B""), then after one cyclic shift it will look like that ""WBBBBBBW"".Help the Little Elephant and his friend to find out whether they can use any number of the described operations to turn the board they have into a proper chessboard." 1000

258E "Little Elephant and Tree" "data structures,dfs and similar,trees" "The Little Elephant loves trees very much, he especially loves root trees.He\'s got a tree consisting of n nodes (the nodes are numbered from 1 to n), with root at node number 1. Each node of the tree contains some list of numbers which initially is empty. The Little Elephant wants to apply m operations. On the i-th operation (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m) he first adds number i to lists of all nodes of a subtree with the root in node number ai, and then he adds number i to lists of all nodes of the subtree with root in node bi.After applying all operations the Little Elephant wants to count for each node i number ci \xe2\x80\x94 the number of integers j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n;�j\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89i), such that the lists of the i-th and the j-th nodes contain at least one common number.Help the Little Elephant, count numbers ci for him." 2400

258D "Little Elephant and Broken Sorting" dp,math,probabilities "The Little Elephant loves permutations of integers from 1 to n very much. But most of all he loves sorting them. To sort a permutation, the Little Elephant repeatedly swaps some elements. As a result, he must receive a permutation 1,\xe2\x80\x892,\xe2\x80\x893,\xe2\x80\x89...,\xe2\x80\x89n.This time the Little Elephant has permutation p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pn. Its sorting program needs to make exactly m moves, during the i-th move it swaps elements that are at that moment located at the ai-th and the bi-th positions. But the Little Elephant\'s sorting program happened to break down and now on every step it can equiprobably either do nothing or swap the required elements.Now the Little Elephant doesn\'t even hope that the program will sort the permutation, but he still wonders: if he runs the program and gets some permutation, how much will the result of sorting resemble the sorted one? For that help the Little Elephant find the mathematical expectation of the number of permutation inversions after all moves of the program are completed.We\'ll call a pair of integers i,\xe2\x80\x89j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) an inversion in permutatuon p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pn, if the following inequality holds: pi\xe2\x80\x89>\xe2\x80\x89pj." 2600

258C "Little Elephant and LCM" "binary search,combinatorics,dp,math" "The Little Elephant loves the LCM (least common multiple) operation of a non-empty set of positive integers. The result of the LCM operation of k positive integers x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xk is the minimum positive integer that is divisible by each of numbers xi.Let\'s assume that there is a sequence of integers b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bn. Let\'s denote their LCMs as lcm(b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bn) and the maximum of them as max(b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bn). The Little Elephant considers a sequence b good, if lcm(b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bn)\xe2\x80\x89=\xe2\x80\x89max(b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bn).The Little Elephant has a sequence of integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. Help him find the number of good sequences of integers b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bn, such that for all i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) the following condition fulfills: 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89bi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ai. As the answer can be rather large, print the remainder from dividing it by 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." 2000

258B "Little Elephant and Elections" "brute force,combinatorics,dp" "There have recently been elections in the zoo. Overall there were 7 main political parties: one of them is the Little Elephant Political Party, 6 other parties have less catchy names.Political parties find their number in the ballot highly important. Overall there are m possible numbers: 1,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89m. Each of these 7 parties is going to be assigned in some way to exactly one number, at that, two distinct parties cannot receive the same number.The Little Elephant Political Party members believe in the lucky digits 4 and 7. They want to evaluate their chances in the elections. For that, they need to find out, how many correct assignments are there, such that the number of lucky digits in the Little Elephant Political Party ballot number is strictly larger than the total number of lucky digits in the ballot numbers of 6 other parties. Help the Little Elephant Political Party, calculate this number. As the answer can be rather large, print the remainder from dividing it by 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." 1900

258A "Little Elephant and Bits" greedy,math "The Little Elephant has an integer a, written in the binary notation. He wants to write this number on a piece of paper.To make sure that the number a fits on the piece of paper, the Little Elephant ought to delete exactly one any digit from number a in the binary record. At that a new number appears. It consists of the remaining binary digits, written in the corresponding order (possible, with leading zeroes).The Little Elephant wants the number he is going to write on the paper to be as large as possible. Help him find the maximum number that he can obtain after deleting exactly one binary digit and print it in the binary notation." 1100

257E "Greedy Elevator" "data structures,implementation" "The m-floor (m\xe2\x80\x89>\xe2\x80\x891) office of international corporation CodeForces has the advanced elevator control system established. It works as follows.All office floors are sequentially numbered with integers from 1 to m. At time t\xe2\x80\x89=\xe2\x80\x890, the elevator is on the first floor, the elevator is empty and nobody is waiting for the elevator on other floors. Next, at times ti (ti\xe2\x80\x89>\xe2\x80\x890) people come to the elevator. For simplicity, we assume that one person uses the elevator only once during the reported interval. For every person we know three parameters: the time at which the person comes to the elevator, the floor on which the person is initially, and the floor to which he wants to go.The movement of the elevator between the floors is as follows. At time t (t\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x890, t is an integer) the elevator is always at some floor. First the elevator releases all people who are in the elevator and want to get to the current floor. Then it lets in all the people waiting for the elevator on this floor. If a person comes to the elevator exactly at time t, then he has enough time to get into it. We can assume that all of these actions (going in or out from the elevator) are made instantly. After that the elevator decides, which way to move and at time (t\xe2\x80\x89+\xe2\x80\x891) the elevator gets to the selected floor.The elevator selects the direction of moving by the following algorithm.   If the elevator is empty and at the current time no one is waiting for the elevator on any floor, then the elevator remains at the current floor.  Otherwise, let\'s assume that the elevator is on the floor number x (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m). Then elevator calculates the directions\' ""priorities"" pup and pdown: pup is the sum of the number of people waiting for the elevator on the floors with numbers greater than x, and the number of people in the elevator, who want to get to the floors with the numbers greater than x; pdown is the sum of the number of people waiting for the elevator on the floors with numbers less than x, and the number of people in the elevator, who want to get to the floors with the numbers less than x. If pup\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89pdown, then the elevator goes one floor above the current one (that is, from floor x to floor x\xe2\x80\x89+\xe2\x80\x891), otherwise the elevator goes one floor below the current one (that is, from floor x to floor x\xe2\x80\x89-\xe2\x80\x891). Your task is to simulate the work of the elevator and for each person to tell the time when the elevator will get to the floor this person needs. Please note that the elevator is large enough to accommodate all the people at once." 2200

257D Sum greedy,math "Vasya has found a piece of paper with an array written on it. The array consists of n integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. Vasya noticed that the following condition holds for the array ai\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x892\xc2\xb7ai for any positive integer i (i\xe2\x80\x89<\xe2\x80\x89n).Vasya wants to add either a ""+"" or a ""-"" before each number of array. Thus, Vasya will get an expression consisting of n summands. The value of the resulting expression is the sum of all its elements. The task is to add signs ""+"" and ""-"" before each number so that the value of expression s meets the limits 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89s\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a1. Print a sequence of signs ""+"" and ""-"", satisfying the given limits. It is guaranteed that the solution for the problem exists." 1900

257C "View Angle" "brute force,geometry,math" "Flatland has recently introduced a new type of an eye check for the driver\'s licence. The check goes like that: there is a plane with mannequins standing on it. You should tell the value of the minimum angle with the vertex at the origin of coordinates and with all mannequins standing inside or on the boarder of this angle. As you spend lots of time ""glued to the screen"", your vision is impaired. So you have to write a program that will pass the check for you." 1800

257B "Playing Cubes" games,greedy,implementation "Petya and Vasya decided to play a little. They found n red cubes and m blue cubes. The game goes like that: the players take turns to choose a cube of some color (red or blue) and put it in a line from left to right (overall the line will have n\xe2\x80\x89+\xe2\x80\x89m cubes). Petya moves first. Petya\'s task is to get as many pairs of neighbouring cubes of the same color as possible. Vasya\'s task is to get as many pairs of neighbouring cubes of different colors as possible. The number of Petya\'s points in the game is the number of pairs of neighboring cubes of the same color in the line, the number of Vasya\'s points in the game is the number of neighbouring cubes of the different color in the line. Your task is to calculate the score at the end of the game (Petya\'s and Vasya\'s points, correspondingly), if both boys are playing optimally well. To ""play optimally well"" first of all means to maximize the number of one\'s points, and second \xe2\x80\x94 to minimize the number of the opponent\'s points." 1300

257A Sockets greedy,implementation,sortings "Vasya has got many devices that work on electricity. He\'s got n supply-line filters to plug the devices, the i-th supply-line filter has ai sockets.Overall Vasya has got m devices and k electrical sockets in his flat, he can plug the devices or supply-line filters directly. Of course, he can plug the supply-line filter to any other supply-line filter. The device (or the supply-line filter) is considered plugged to electricity if it is either plugged to one of k electrical sockets, or if it is plugged to some supply-line filter that is in turn plugged to electricity. What minimum number of supply-line filters from the given set will Vasya need to plug all the devices he has to electricity? Note that all devices and supply-line filters take one socket for plugging and that he can use one socket to plug either one device or one supply-line filter." 1100

256E "Lucky Arrays" "data structures" "Little Maxim loves interesting problems. He decided to share one such problem with you. Initially there is an array a, consisting of n zeroes. The elements of the array are indexed, starting from 1. Then follow queries to change array a. Each query is characterized by two integers vi,\xe2\x80\x89ti. In the answer to the query we should make the vi-th array element equal ti (avi\xe2\x80\x89=\xe2\x80\x89ti;�1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89vi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n).Maxim thinks that some pairs of integers (x,\xe2\x80\x89y) are good and some are not. Maxim thinks that array a, consisting of n integers, is lucky, if for all integer i, (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x891) the pair of integers (ai,\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x891) \xe2\x80\x94 is good. Note that the order of numbers in the pairs is important, that is, specifically, (1,\xe2\x80\x892)\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89(2,\xe2\x80\x891).After each query to change array a Maxim wants to know, how many ways there are to replace all zeroes in array a with integers from one to three so as to make the resulting array (without zeroes) lucky. Of course, distinct zeroes can be replaced by distinct integers.Maxim told you the sequence of queries and all pairs of integers he considers lucky. Help Maxim, solve this problem for him." 2400

256D "Liars and Serge" dp "There are n people, sitting in a line at the table. For each person we know that he always tells either the truth or lies.Little Serge asked them: how many of you always tell the truth? Each of the people at the table knows everything (who is an honest person and who is a liar) about all the people at the table. The honest people are going to say the correct answer, the liars are going to say any integer from 1 to n, which is not the correct answer. Every liar chooses his answer, regardless of the other liars, so two distinct liars may give distinct answer.Serge does not know any information about the people besides their answers to his question. He took a piece of paper and wrote n integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an, where ai is the answer of the i-th person in the row. Given this sequence, Serge determined that exactly k people sitting at the table apparently lie.Serge wonders, how many variants of people\'s answers (sequences of answers a of length n) there are where one can say that exactly k people sitting at the table apparently lie. As there can be rather many described variants of answers, count the remainder of dividing the number of the variants by 777777777." 2700

255E "Furlo and Rublo and Game" games,implementation,math "Furlo and Rublo play a game. The table has n piles of coins lying on it, the i-th pile has ai coins. Furlo and Rublo move in turns, Furlo moves first. In one move you are allowed to:  choose some pile, let\'s denote the current number of coins in it as x;  choose some integer y (0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y\xe2\x80\x89<\xe2\x80\x89x;�x1\xe2\x80\x89/\xe2\x80\x894\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x1\xe2\x80\x89/\xe2\x80\x892) and decrease the number of coins in this pile to y. In other words, after the described move the pile will have y coins left. The player who can\'t make a move, loses. Your task is to find out, who wins in the given game if both Furlo and Rublo play optimally well." 2200

255D "Mr. Bender and Square" "binary search,implementation,math" "Mr. Bender has a digital table of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89n, each cell can be switched on or off. He wants the field to have at least c switched on squares. When this condition is fulfilled, Mr Bender will be happy.We\'ll consider the table rows numbered from top to bottom from 1 to n, and the columns \xe2\x80\x94 numbered from left to right from 1 to n. Initially there is exactly one switched on cell with coordinates (x,\xe2\x80\x89y) (x is the row number, y is the column number), and all other cells are switched off. Then each second we switch on the cells that are off but have the side-adjacent cells that are on.For a cell with coordinates (x,\xe2\x80\x89y) the side-adjacent cells are cells with coordinates (x\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89y), (x\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89y), (x,\xe2\x80\x89y\xe2\x80\x89-\xe2\x80\x891), (x,\xe2\x80\x89y\xe2\x80\x89+\xe2\x80\x891).In how many seconds will Mr. Bender get happy?" 1800

255C "Almost Arithmetical Progression" "brute force,dp" "Gena loves sequences of numbers. Recently, he has discovered a new type of sequences which he called an almost arithmetical progression. A sequence is an almost arithmetical progression, if its elements can be represented as:  a1\xe2\x80\x89=\xe2\x80\x89p, where p is some integer;  ai\xe2\x80\x89=\xe2\x80\x89ai\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x89(\xe2\x80\x89-\xe2\x80\x891)i\xe2\x80\x89+\xe2\x80\x891\xc2\xb7q (i\xe2\x80\x89>\xe2\x80\x891), where q is some integer. Right now Gena has a piece of paper with sequence b, consisting of n integers. Help Gena, find there the longest subsequence of integers that is an almost arithmetical progression.Sequence s1,\xe2\x80\x89\xe2\x80\x89s2,\xe2\x80\x89\xe2\x80\x89...,\xe2\x80\x89\xe2\x80\x89sk is a subsequence of sequence b1,\xe2\x80\x89\xe2\x80\x89b2,\xe2\x80\x89\xe2\x80\x89...,\xe2\x80\x89\xe2\x80\x89bn, if there is such increasing sequence of indexes i1,\xe2\x80\x89i2,\xe2\x80\x89...,\xe2\x80\x89ik (1\xe2\x80\x89\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89\xe2\x80\x89i1\xe2\x80\x89\xe2\x80\x89<\xe2\x80\x89\xe2\x80\x89i2\xe2\x80\x89\xe2\x80\x89<\xe2\x80\x89... \xe2\x80\x89\xe2\x80\x89<\xe2\x80\x89\xe2\x80\x89ik\xe2\x80\x89\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89\xe2\x80\x89n), that bij\xe2\x80\x89\xe2\x80\x89=\xe2\x80\x89\xe2\x80\x89sj. In other words, sequence s can be obtained from b by crossing out some elements." 1500

255B "Code Parsing" implementation "Little Vitaly loves different algorithms. Today he has invented a new algorithm just for you. Vitaly\'s algorithm works with string s, consisting of characters ""x"" and ""y"", and uses two following operations at runtime:  Find two consecutive characters in the string, such that the first of them equals ""y"", and the second one equals ""x"" and swap them. If there are several suitable pairs of characters, we choose the pair of characters that is located closer to the beginning of the string.  Find in the string two consecutive characters, such that the first of them equals ""x"" and the second one equals ""y"". Remove these characters from the string. If there are several suitable pairs of characters, we choose the pair of characters that is located closer to the beginning of the string. The input for the new algorithm is string s, and the algorithm works as follows:  If you can apply at least one of the described operations to the string, go to step 2 of the algorithm. Otherwise, stop executing the algorithm and print the current string.  If you can apply operation 1, then apply it. Otherwise, apply operation 2. After you apply the operation, go to step 1 of the algorithm. Now Vitaly wonders, what is going to be printed as the result of the algorithm\'s work, if the input receives string s." 1200

255A "Greg\'s Workout" implementation "Little Vitaly loves different algorithms. Today he has invented a new algorithm just for you. Vitaly\'s algorithm works with string s, consisting of characters ""x"" and ""y"", and uses two following operations at runtime:  Find two consecutive characters in the string, such that the first of them equals ""y"", and the second one equals ""x"" and swap them. If there are several suitable pairs of characters, we choose the pair of characters that is located closer to the beginning of the string.  Find in the string two consecutive characters, such that the first of them equals ""x"" and the second one equals ""y"". Remove these characters from the string. If there are several suitable pairs of characters, we choose the pair of characters that is located closer to the beginning of the string. The input for the new algorithm is string s, and the algorithm works as follows:  If you can apply at least one of the described operations to the string, go to step 2 of the algorithm. Otherwise, stop executing the algorithm and print the current string.  If you can apply operation 1, then apply it. Otherwise, apply operation 2. After you apply the operation, go to step 1 of the algorithm. Now Vitaly wonders, what is going to be printed as the result of the algorithm\'s work, if the input receives string s." 800

254E Dormitory dp,implementation "Student Vasya came to study in Berland State University from the country, so he is living in a dormitory. A semester has n days, and in each of those days his parents send him some food. In the morning of the i-th day he receives ai kilograms of food that can be eaten on that day and on the next one (then the food goes bad and becomes unfit for consumption).Every day Vasya eats v kilograms of food. It is known that Vasya\'s parents do not allow him to starve, so there always is enough food for Vasya. Vasya has m friends who sometimes live with him. Let\'s index the friends from 1 to m. Friend number j lives with Vasya from day lj to day rj, inclusive. Also, the j-th friend requires fj kilograms of food per day. Usually Vasya\'s friends eat in the canteen, but sometimes generous Vasya feeds some of them. Every day Vasya can feed some friends who live with him this day (or may feed nobody).Every time Vasya feeds his friend, he gives him as much food as the friend needs for the day, and Vasya\'s popularity rating at the University increases by one. Vasya cannot feed the same friend multiple times in one day. In addition, he knows that eating habits must be regular, so he always eats v kilograms of food per day.Vasya wants so choose whom he will feed each day of the semester to make his rating as high as possible. Originally Vasya\'s rating is 0 because he is a freshman." 2100

254D Rats "brute force,dfs and similar,graphs,implementation,shortest paths" "Rats have bred to hundreds and hundreds in the basement of the store, owned by Vasily Petrovich. Vasily Petrovich may have not noticed their presence, but they got into the habit of sneaking into the warehouse and stealing food from there. Vasily Petrovich cannot put up with it anymore, he has to destroy the rats in the basement. Since mousetraps are outdated and do not help, and rat poison can poison inattentive people as well as rats, he chose a radical way: to blow up two grenades in the basement (he does not have more).In this problem, we will present the shop basement as a rectangular table of n\xe2\x80\x89\xc3\x97\xe2\x80\x89m cells. Some of the cells are occupied by walls, and the rest of them are empty. Vasily has been watching the rats and he found out that at a certain time they go to sleep, and all the time they sleep in the same places. He wants to blow up a grenade when this convenient time comes. On the plan of his basement, he marked cells with sleeping rats in them. Naturally, these cells are not occupied by walls.Grenades can only blow up in a cell that is not occupied by a wall. The blast wave from a grenade distributes as follows. We assume that the grenade blast occurs at time 0. During this initial time only the cell where the grenade blew up gets \'clear\'. If at time t some cell is clear, then at time t\xe2\x80\x89+\xe2\x80\x891 those side-neighbouring cells which are not occupied by the walls get clear too (some of them could have been cleared before). The blast wave distributes for exactly d seconds, then it dies immediately.  An example of a distributing blast wave: Picture 1 shows the situation before the blast, and the following pictures show ""clear"" cells by time 0,1,2,3 and 4. Thus, the blast wave on the picture distributes for d\xe2\x80\x89=\xe2\x80\x894 seconds. Vasily Petrovich wonders, whether he can choose two cells to blast the grenades so as to clear all cells with sleeping rats. Write the program that finds it out." 2300

254C Anagram greedy,strings "String x is an anagram of string y, if we can rearrange the letters in string x and get exact string y. For example, strings ""DOG"" and ""GOD"" are anagrams, so are strings ""BABA"" and ""AABB"", but strings ""ABBAC"" and ""CAABA"" are not.You are given two strings s and t of the same length, consisting of uppercase English letters. You need to get the anagram of string t from string s. You are permitted to perform the replacing operation: every operation is replacing some character from the string s by any other character. Get the anagram of string t in the least number of replacing operations. If you can get multiple anagrams of string t in the least number of operations, get the lexicographically minimal one.The lexicographic order of strings is the familiar to us ""dictionary"" order. Formally, the string p of length n is lexicographically smaller than string q of the same length, if p1\xe2\x80\x89=\xe2\x80\x89q1, p2\xe2\x80\x89=\xe2\x80\x89q2, ..., pk\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89=\xe2\x80\x89qk\xe2\x80\x89-\xe2\x80\x891, pk\xe2\x80\x89<\xe2\x80\x89qk for some k (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n). Here characters in the strings are numbered from 1. The characters of the strings are compared in the alphabetic order." 1800

254B "Jury Size" "brute force,implementation" "In 2013, the writers of Berland State University should prepare problems for n Olympiads. We will assume that the Olympiads are numbered with consecutive integers from 1 to n. For each Olympiad we know how many members of the jury must be involved in its preparation, as well as the time required to prepare the problems for her. Namely, the Olympiad number i should be prepared by pi people for ti days, the preparation for the Olympiad should be a continuous period of time and end exactly one day before the Olympiad. On the day of the Olympiad the juries who have prepared it, already do not work on it.For example, if the Olympiad is held on December 9th and the preparation takes 7 people and 6 days, all seven members of the jury will work on the problems of the Olympiad from December, 3rd to December, 8th (the jury members won\'t be working on the problems of this Olympiad on December 9th, that is, some of them can start preparing problems for some other Olympiad). And if the Olympiad is held on November 3rd and requires 5 days of training, the members of the jury will work from October 29th to November 2nd.In order not to overload the jury the following rule was introduced: one member of the jury can not work on the same day on the tasks for different Olympiads. Write a program that determines what the minimum number of people must be part of the jury so that all Olympiads could be prepared in time." 1500

254A "Cards with Numbers" "constructive algorithms,sortings" "Petya has got 2n cards, each card contains some integer. The numbers on the cards can be the same. Let\'s index all cards by consecutive integers from 1 to 2n. We\'ll denote the number that is written on a card with number i, as ai. In order to play one entertaining game with his friends, Petya needs to split the cards into pairs so that each pair had equal numbers on the cards. Help Petya do that." 1200

253E Printer "binary search,data structures,implementation,sortings" "Let\'s consider a network printer that functions like that. It starts working at time 0. In each second it can print one page of a text. At some moments of time the printer receives printing tasks. We know that a printer received n tasks. Let\'s number the tasks by consecutive integers from 1 to n. Then the task number i is characterised by three integers: ti is the time when the task came, si is the task\'s volume (in pages) and pi is the task\'s priority. The priorities of all tasks are distinct.When the printer receives a task, the task goes to the queue and remains there until all pages from this task are printed. The printer chooses a page to print each time when it either stops printing some page or when it is free and receives a new task. Among all tasks that are in the queue at this moment, the printer chooses the task with the highest priority and next second prints an unprinted page from this task. You can assume that a task goes to the queue immediately, that\'s why if a task has just arrived by time t, the printer can already choose it for printing.You are given full information about all tasks except for one: you don\'t know this task\'s priority. However, we know the time when the last page from this task was finished printing. Given this information, find the unknown priority value and determine the moments of time when the printer finished printing each task." 2200

253D "Table with Letters - 2" "brute force,two pointers" "Vasya has recently started to learn English. Now he needs to remember how to write English letters. He isn\'t sure about some of them, so he decided to train a little.He found a sheet of squared paper and began writing arbitrary English letters there. In the end Vasya wrote n lines containing m characters each. Thus, he got a rectangular n\xe2\x80\x89\xc3\x97\xe2\x80\x89m table, each cell of the table contained some English letter. Let\'s number the table rows from top to bottom with integers from 1 to n, and columns \xe2\x80\x94 from left to right with integers from 1 to m.After that Vasya looked at the resulting rectangular table and wondered, how many subtables are there, that matches both following conditions:  the subtable contains at most k cells with ""a"" letter;  all letters, located in all four corner cells of the subtable, are equal.  Formally, a subtable\'s definition is as follows. It is defined by four integers x1,\xe2\x80\x89y1,\xe2\x80\x89x2,\xe2\x80\x89y2 such that 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x1\xe2\x80\x89<\xe2\x80\x89x2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n, 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y1\xe2\x80\x89<\xe2\x80\x89y2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m. Then the subtable contains all such cells (x,\xe2\x80\x89y) (x is the row number, y is the column number), for which the following inequality holds x1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x2,\xe2\x80\x89y1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y2. The corner cells of the table are cells (x1,\xe2\x80\x89y1), (x1,\xe2\x80\x89y2), (x2,\xe2\x80\x89y1), (x2,\xe2\x80\x89y2).Vasya is already too tired after he\'s been writing letters to a piece of paper. That\'s why he asks you to count the value he is interested in." 2000

253C "Text Editor" "data structures,dfs and similar,graphs,greedy,shortest paths" "Vasya is pressing the keys on the keyboard reluctantly, squeezing out his ideas on the classical epos depicted in Homer\'s Odysseus... How can he explain to his literature teacher that he isn\'t going to become a writer? In fact, he is going to become a programmer. So, he would take great pleasure in writing a program, but none \xe2\x80\x94 in writing a composition.As Vasya was fishing for a sentence in the dark pond of his imagination, he suddenly wondered: what is the least number of times he should push a key to shift the cursor from one position to another one?Let\'s describe his question more formally: to type a text, Vasya is using the text editor. He has already written n lines, the i-th line contains ai characters (including spaces). If some line contains k characters, then this line overall contains (k\xe2\x80\x89+\xe2\x80\x891) positions where the cursor can stand: before some character or after all characters (at the end of the line). Thus, the cursor\'s position is determined by a pair of integers (r,\xe2\x80\x89c), where r is the number of the line and c is the cursor\'s position in the line (the positions are indexed starting from one from the beginning of the line).Vasya doesn\'t use the mouse to move the cursor. He uses keys ""Up"", ""Down"", ""Right"" and ""Left"". When he pushes each of these keys, the cursor shifts in the needed direction. Let\'s assume that before the corresponding key is pressed, the cursor was located in the position (r,\xe2\x80\x89c), then Vasya pushed key: ""Up"": if the cursor was located in the first line (r\xe2\x80\x89=\xe2\x80\x891), then it does not move. Otherwise, it moves to the previous line (with number r\xe2\x80\x89-\xe2\x80\x891), to the same position. At that, if the previous line was short, that is, the cursor couldn\'t occupy position c there, the cursor moves to the last position of the line with number r\xe2\x80\x89-\xe2\x80\x891; ""Down"": if the cursor was located in the last line (r\xe2\x80\x89=\xe2\x80\x89n), then it does not move. Otherwise, it moves to the next line (with number r\xe2\x80\x89+\xe2\x80\x891), to the same position. At that, if the next line was short, that is, the cursor couldn\'t occupy position c there, the cursor moves to the last position of the line with number r\xe2\x80\x89+\xe2\x80\x891; ""Right"": if the cursor can move to the right in this line (c\xe2\x80\x89<\xe2\x80\x89ar\xe2\x80\x89+\xe2\x80\x891), then it moves to the right (to position c\xe2\x80\x89+\xe2\x80\x891). Otherwise, it is located at the end of the line and doesn\'t move anywhere when Vasya presses the ""Right"" key; ""Left"": if the cursor can move to the left in this line (c\xe2\x80\x89>\xe2\x80\x891), then it moves to the left (to position c\xe2\x80\x89-\xe2\x80\x891). Otherwise, it is located at the beginning of the line and doesn\'t move anywhere when Vasya presses the ""Left"" key.You\'ve got the number of lines in the text file and the number of characters, written in each line of this file. Find the least number of times Vasya should push the keys, described above, to shift the cursor from position (r1,\xe2\x80\x89c1) to position (r2,\xe2\x80\x89c2)." 1600

253B "Physics Practical" "binary search,dp,sortings,two pointers" "One day Vasya was on a physics practical, performing the task on measuring the capacitance. He followed the teacher\'s advice and did as much as n measurements, and recorded the results in the notebook. After that he was about to show the results to the teacher, but he remembered that at the last lesson, the teacher had made his friend Petya redo the experiment because the largest and the smallest results differed by more than two times. Vasya is lazy, and he does not want to redo the experiment. He wants to do the task and go home play computer games. So he decided to cheat: before Vasya shows the measurements to the teacher, he will erase some of them, so as to make the largest and the smallest results of the remaining measurements differ in no more than two times. In other words, if the remaining measurements have the smallest result x, and the largest result y, then the inequality y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x892\xc2\xb7x must fulfill. Of course, to avoid the teacher\'s suspicion, Vasya wants to remove as few measurement results as possible from his notes.Help Vasya, find what minimum number of measurement results he will have to erase from his notes so that the largest and the smallest of the remaining results of the measurements differed in no more than two times." 1400

253A "Boys and Girls" greedy "There are n boys and m girls studying in the class. They should stand in a line so that boys and girls alternated there as much as possible. Let\'s assume that positions in the line are indexed from left to right by numbers from 1 to n\xe2\x80\x89+\xe2\x80\x89m. Then the number of integers i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89n\xe2\x80\x89+\xe2\x80\x89m) such that positions with indexes i and i\xe2\x80\x89+\xe2\x80\x891 contain children of different genders (position i has a girl and position i\xe2\x80\x89+\xe2\x80\x891 has a boy or vice versa) must be as large as possible. Help the children and tell them how to form the line." 1100

252B "Unsorting Array" "brute force,sortings" "Little Petya likes arrays of integers a lot. Recently his mother has presented him one such array consisting of n elements. Petya is now wondering whether he can swap any two distinct integers in the array so that the array got unsorted. Please note that Petya can not swap equal integers even if they are in distinct positions in the array. Also note that Petya must swap some two integers even if the original array meets all requirements.Array a (the array elements are indexed from 1) consisting of n elements is called sorted if it meets at least one of the following two conditions:  a1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89...\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89an;  a1\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89a2\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89...\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89an. Help Petya find the two required positions to swap or else say that they do not exist." 1800

252A "Little Xor" "brute force,implementation" "Little Petya likes arrays that consist of non-negative integers a lot. Recently his mom has presented him one such array consisting of n elements. Petya immediately decided to find there a segment of consecutive elements, such that the xor of all numbers from this segment was maximal possible. Help him with that.The xor operation is the bitwise exclusive ""OR"", that is denoted as ""xor"" in Pascal and ""^"" in C/C++/Java." 1100

251E "Tree and Table" "dfs and similar,dp,implementation,trees" "Little Petya likes trees a lot. Recently his mother has presented him a tree with 2n nodes. Petya immediately decided to place this tree on a rectangular table consisting of 2 rows and n columns so as to fulfill the following conditions:  Each cell of the table corresponds to exactly one tree node and vice versa, each tree node corresponds to exactly one table cell.  If two tree nodes are connected by an edge, then the corresponding cells have a common side. Now Petya wonders how many ways are there to place his tree on the table. He calls two placements distinct if there is a tree node which corresponds to distinct table cells in these two placements. Since large numbers can scare Petya, print the answer modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." 3000

251D "Two Sets" bitmasks,math "Little Petya likes numbers a lot. Recently his mother has presented him a collection of n non-negative integers. There\'s only one thing Petya likes more than numbers: playing with little Masha. He immediately decided to give a part of his new collection to her. To make the game even more interesting, Petya decided to give Masha such collection of numbers for which the following conditions fulfill:  Let\'s introduce x1 to denote the xor of all numbers Petya has got left; and let\'s introduce x2 to denote the xor of all numbers he gave to Masha. Value (x1\xe2\x80\x89+\xe2\x80\x89x2) must be as large as possible.  If there are multiple ways to divide the collection so that the previous condition fulfilled, then Petya minimizes the value x1. The xor operation is a bitwise excluding ""OR"", that is denoted as ""xor"" in the Pascal language and ""^"" in C/C++/Java.Help Petya divide the collection as described above. If there are multiple suitable ways to divide it, find any of them. Please note that after Petya gives a part of his numbers to Masha, he may have no numbers left. The reverse situation is also possible, when Petya gives nothing to Masha. In both cases we must assume that the xor of an empty set of numbers equals 0." 2700

251C "Number Transformation" "dp,greedy,number theory" "Little Petya likes positive integers a lot. Recently his mom has presented him a positive integer a. There\'s only one thing Petya likes more than numbers: playing with little Masha. It turned out that Masha already has a positive integer b. Petya decided to turn his number a into the number b consecutively performing the operations of the following two types:  Subtract 1 from his number.  Choose any integer x from 2 to k, inclusive. Then subtract number (a mod x) from his number a. Operation a mod x means taking the remainder from division of number a by number x. Petya performs one operation per second. Each time he chooses an operation to perform during the current move, no matter what kind of operations he has performed by that moment. In particular, this implies that he can perform the same operation any number of times in a row.Now he wonders in what minimum number of seconds he could transform his number a into number b. Please note that numbers x in the operations of the second type are selected anew each time, independently of each other." 2000

251B "Playing with Permutations" implementation,math "Little Petya likes permutations a lot. Recently his mom has presented him permutation q1,\xe2\x80\x89q2,\xe2\x80\x89...,\xe2\x80\x89qn of length n.A permutation a of length n is a sequence of integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ai\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n), all integers there are distinct. There is only one thing Petya likes more than permutations: playing with little Masha. As it turns out, Masha also has a permutation of length n. Petya decided to get the same permutation, whatever the cost may be. For that, he devised a game with the following rules:  Before the beginning of the game Petya writes permutation 1,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89n on the blackboard. After that Petya makes exactly k moves, which are described below.  During a move Petya tosses a coin. If the coin shows heads, he performs point 1, if the coin shows tails, he performs point 2.  Let\'s assume that the board contains permutation p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pn at the given moment. Then Petya removes the written permutation p from the board and writes another one instead: pq1,\xe2\x80\x89pq2,\xe2\x80\x89...,\xe2\x80\x89pqn. In other words, Petya applies permutation q (which he has got from his mother) to permutation p.  All actions are similar to point 1, except that Petya writes permutation t on the board, such that: tqi\xe2\x80\x89=\xe2\x80\x89pi for all i from 1 to n. In other words, Petya applies a permutation that is inverse to q to permutation p. We know that after the k-th move the board contained Masha\'s permutation s1,\xe2\x80\x89s2,\xe2\x80\x89...,\xe2\x80\x89sn. Besides, we know that throughout the game process Masha\'s permutation never occurred on the board before the k-th move. Note that the game has exactly k moves, that is, throughout the game the coin was tossed exactly k times.Your task is to determine whether the described situation is possible or else state that Petya was mistaken somewhere. See samples and notes to them for a better understanding." 1800

251A "Points on Line" "binary search,combinatorics,two pointers" "Little Petya likes points a lot. Recently his mom has presented him n points lying on the line OX. Now Petya is wondering in how many ways he can choose three distinct points so that the distance between the two farthest of them doesn\'t exceed d.Note that the order of the points inside the group of three chosen points doesn\'t matter." 1300

250E "Mad Joe" "brute force" "Joe has been hurt on the Internet. Now he is storming around the house, destroying everything in his path.Joe\'s house has n floors, each floor is a segment of m cells. Each cell either contains nothing (it is an empty cell), or has a brick or a concrete wall (always something one of three). It is believed that each floor is surrounded by a concrete wall on the left and on the right.Now Joe is on the n-th floor and in the first cell, counting from left to right. At each moment of time, Joe has the direction of his gaze, to the right or to the left (always one direction of the two). Initially, Joe looks to the right.Joe moves by a particular algorithm. Every second he makes one of the following actions:   If the cell directly under Joe is empty, then Joe falls down. That is, he moves to this cell, the gaze direction is preserved.  Otherwise consider the next cell in the current direction of the gaze.   If the cell is empty, then Joe moves into it, the gaze direction is preserved.  If this cell has bricks, then Joe breaks them with his forehead (the cell becomes empty), and changes the direction of his gaze to the opposite.  If this cell has a concrete wall, then Joe just changes the direction of his gaze to the opposite (concrete can withstand any number of forehead hits).  Joe calms down as soon as he reaches any cell of the first floor.The figure below shows an example Joe\'s movements around the house.  Determine how many seconds Joe will need to calm down." 2000

250D "Building Bridge" "geometry,ternary search,two pointers" "Two villages are separated by a river that flows from the north to the south. The villagers want to build a bridge across the river to make it easier to move across the villages.The river banks can be assumed to be vertical straight lines x\xe2\x80\x89=\xe2\x80\x89a and x\xe2\x80\x89=\xe2\x80\x89b (0\xe2\x80\x89<\xe2\x80\x89a\xe2\x80\x89<\xe2\x80\x89b).The west village lies in a steppe at point O\xe2\x80\x89=\xe2\x80\x89(0,\xe2\x80\x890). There are n pathways leading from the village to the river, they end at points Ai\xe2\x80\x89=\xe2\x80\x89(a,\xe2\x80\x89yi). The villagers there are plain and simple, so their pathways are straight segments as well.The east village has reserved and cunning people. Their village is in the forest on the east bank of the river, but its exact position is not clear. There are m twisted paths leading from this village to the river and ending at points Bi\xe2\x80\x89=\xe2\x80\x89(b,\xe2\x80\x89y\'i). The lengths of all these paths are known, the length of the path that leads from the eastern village to point Bi, equals li.The villagers want to choose exactly one point on the left bank of river Ai, exactly one point on the right bank Bj and connect them by a straight-line bridge so as to make the total distance between the villages (the sum of |OAi|\xe2\x80\x89+\xe2\x80\x89|AiBj|\xe2\x80\x89+\xe2\x80\x89lj, where |XY| is the Euclidean distance between points X and Y) were minimum. The Euclidean distance between points (x1,\xe2\x80\x89y1) and (x2,\xe2\x80\x89y2) equals .Help them and find the required pair of points." 1900

250C "Movie Critics" greedy "A film festival is coming up in the city N. The festival will last for exactly n days and each day will have a premiere of exactly one film. Each film has a genre \xe2\x80\x94 an integer from 1 to k.On the i-th day the festival will show a movie of genre ai. We know that a movie of each of k genres occurs in the festival programme at least once. In other words, each integer from 1 to k occurs in the sequence a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an at least once.Valentine is a movie critic. He wants to watch some movies of the festival and then describe his impressions on his site.As any creative person, Valentine is very susceptive. After he watched the movie of a certain genre, Valentine forms the mood he preserves until he watches the next movie. If the genre of the next movie is the same, it does not change Valentine\'s mood. If the genres are different, Valentine\'s mood changes according to the new genre and Valentine has a stress.Valentine can\'t watch all n movies, so he decided to exclude from his to-watch list movies of one of the genres. In other words, Valentine is going to choose exactly one of the k genres and will skip all the movies of this genre. He is sure to visit other movies.Valentine wants to choose such genre x (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k), that the total number of after-movie stresses (after all movies of genre x are excluded) were minimum." 1600

250B "Restoring IPv6" implementation,strings "An IPv6-address is a 128-bit number. For convenience, this number is recorded in blocks of 16 bits in hexadecimal record, the blocks are separated by colons \xe2\x80\x94 8 blocks in total, each block has four hexadecimal digits. Here is an example of the correct record of a IPv6 address: ""0124:5678:90ab:cdef:0124:5678:90ab:cdef"". We\'ll call such format of recording an IPv6-address full.Besides the full record of an IPv6 address there is a short record format. The record of an IPv6 address can be shortened by removing one or more leading zeroes at the beginning of each block. However, each block should contain at least one digit in the short format. For example, the leading zeroes can be removed like that: ""a56f:00d3:0000:0124:0001:f19a:1000:0000"" \xe2\x80\x89\xe2\x86\x92\xe2\x80\x89 ""a56f:d3:0:0124:01:f19a:1000:00"". There are more ways to shorten zeroes in this IPv6 address.Some IPv6 addresses contain long sequences of zeroes. Continuous sequences of 16-bit zero blocks can be shortened to ""::"". A sequence can consist of one or several consecutive blocks, with all 16 bits equal to 0. You can see examples of zero block shortenings below:  ""a56f:00d3:0000:0124:0001:0000:0000:0000"" \xe2\x80\x89\xe2\x86\x92\xe2\x80\x89 ""a56f:00d3:0000:0124:0001::"";  ""a56f:0000:0000:0124:0001:0000:1234:0ff0"" \xe2\x80\x89\xe2\x86\x92\xe2\x80\x89 ""a56f::0124:0001:0000:1234:0ff0"";  ""a56f:0000:0000:0000:0001:0000:1234:0ff0"" \xe2\x80\x89\xe2\x86\x92\xe2\x80\x89 ""a56f:0000::0000:0001:0000:1234:0ff0"";  ""a56f:00d3:0000:0124:0001:0000:0000:0000"" \xe2\x80\x89\xe2\x86\x92\xe2\x80\x89 ""a56f:00d3:0000:0124:0001::0000"";  ""0000:0000:0000:0000:0000:0000:0000:0000"" \xe2\x80\x89\xe2\x86\x92\xe2\x80\x89 ""::"". It is not allowed to shorten zero blocks in the address more than once. This means that the short record can\'t contain the sequence of characters ""::"" more than once. Otherwise, it will sometimes be impossible to determine the number of zero blocks, each represented by a double colon.The format of the record of the IPv6 address after removing the leading zeroes and shortening the zero blocks is called short.You\'ve got several short records of IPv6 addresses. Restore their full record." 1500

250A "Paper Work" greedy "Polycarpus has been working in the analytic department of the ""F.R.A.U.D."" company for as much as n days. Right now his task is to make a series of reports about the company\'s performance for the last n days. We know that the main information in a day report is value ai, the company\'s profit on the i-th day. If ai is negative, then the company suffered losses on the i-th day.Polycarpus should sort the daily reports into folders. Each folder should include data on the company\'s performance for several consecutive days. Of course, the information on each of the n days should be exactly in one folder. Thus, Polycarpus puts information on the first few days in the first folder. The information on the several following days goes to the second folder, and so on.It is known that the boss reads one daily report folder per day. If one folder has three or more reports for the days in which the company suffered losses (ai\xe2\x80\x89<\xe2\x80\x890), he loses his temper and his wrath is terrible.Therefore, Polycarpus wants to prepare the folders so that none of them contains information on three or more days with the loss, and the number of folders is minimal.Write a program that, given sequence ai, will print the minimum number of folders." 1000

249E "Endless Matrix" math "A Russian space traveller Alisa Selezneva, like any other schoolgirl of the late 21 century, is interested in science. She has recently visited the MIT (Moscow Institute of Time), where its chairman and the co-inventor of the time machine academician Petrov told her about the construction of a time machine.During the demonstration of the time machine performance Alisa noticed that the machine does not have high speed and the girl got interested in the reason for such disadvantage. As it turns out on closer examination, one of the problems that should be solved for the time machine isn\'t solved by an optimal algorithm. If you find a way to solve this problem optimally, the time machine will run faster and use less energy.A task that none of the staff can solve optimally is as follows. There exists a matrix a, which is filled by the following rule:The cells are consecutive positive integers, starting with one. Besides, ai,\xe2\x80\x89j\xe2\x80\x89<\xe2\x80\x89at,\xe2\x80\x89k (i,\xe2\x80\x89j,\xe2\x80\x89t,\xe2\x80\x89k\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x891), if:  max(i,\xe2\x80\x89j)\xe2\x80\x89<\xe2\x80\x89max(t,\xe2\x80\x89k);  max(i,\xe2\x80\x89j)\xe2\x80\x89=\xe2\x80\x89max(t,\xe2\x80\x89k) and j\xe2\x80\x89<\xe2\x80\x89k;  max(i,\xe2\x80\x89j)\xe2\x80\x89=\xe2\x80\x89max(t,\xe2\x80\x89k), j\xe2\x80\x89=\xe2\x80\x89k and i\xe2\x80\x89>\xe2\x80\x89t. So, after the first 36 numbers are inserted, matrix a will look as follows:  To solve the problem, you should learn to find rather quickly for the given values of x1,\xe2\x80\x89y1,\xe2\x80\x89x2 and y2 (x1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x2,\xe2\x80\x89y1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y2) the meaning of expression:As the meaning of this expression can be large enough, it is sufficient to know only the last 10 digits of the sought value.So, no one in MTI can solve the given task. Alice was brave enough to use the time machine and travel the past to help you.Your task is to write a program that uses the given values x1,\xe2\x80\x89y1,\xe2\x80\x89x2 and y2 finds the last 10 digits of the given expression." 2600

249D "Donkey and Stars" "data structures,dp,geometry,math,sortings" "In the evenings Donkey would join Shrek to look at the stars. They would sit on a log, sipping tea and they would watch the starry sky. The sky hung above the roof, right behind the chimney. Shrek\'s stars were to the right of the chimney and the Donkey\'s stars were to the left. Most days the Donkey would just count the stars, so he knew that they are exactly n. This time he wanted a challenge. He imagined a coordinate system: he put the origin of the coordinates at the intersection of the roof and the chimney, directed the OX axis to the left along the roof and the OY axis \xe2\x80\x94 up along the chimney (see figure). The Donkey imagined two rays emanating from he origin of axes at angles \xce\xb11 and \xce\xb12 to the OX axis.  Now he chooses any star that lies strictly between these rays. After that he imagines more rays that emanate from this star at the same angles \xce\xb11 and \xce\xb12 to the OX axis and chooses another star that lies strictly between the new rays. He repeats the operation as long as there still are stars he can choose between the rays that emanate from a star.   As a result, the Donkey gets a chain of stars. He can consecutively get to each star if he acts by the given rules.Your task is to find the maximum number of stars m that the Donkey\'s chain can contain.Note that the chain must necessarily start in the point of the origin of the axes, that isn\'t taken into consideration while counting the number m of stars in the chain." 2700

248E "Piglet\'s Birthday" dp,math,probabilities "In the evenings Donkey would join Shrek to look at the stars. They would sit on a log, sipping tea and they would watch the starry sky. The sky hung above the roof, right behind the chimney. Shrek\'s stars were to the right of the chimney and the Donkey\'s stars were to the left. Most days the Donkey would just count the stars, so he knew that they are exactly n. This time he wanted a challenge. He imagined a coordinate system: he put the origin of the coordinates at the intersection of the roof and the chimney, directed the OX axis to the left along the roof and the OY axis \xe2\x80\x94 up along the chimney (see figure). The Donkey imagined two rays emanating from he origin of axes at angles \xce\xb11 and \xce\xb12 to the OX axis.  Now he chooses any star that lies strictly between these rays. After that he imagines more rays that emanate from this star at the same angles \xce\xb11 and \xce\xb12 to the OX axis and chooses another star that lies strictly between the new rays. He repeats the operation as long as there still are stars he can choose between the rays that emanate from a star.   As a result, the Donkey gets a chain of stars. He can consecutively get to each star if he acts by the given rules.Your task is to find the maximum number of stars m that the Donkey\'s chain can contain.Note that the chain must necessarily start in the point of the origin of the axes, that isn\'t taken into consideration while counting the number m of stars in the chain." 2600

248D "Sweets for Everyone!" "binary search,greedy,implementation" "For he knew every Who down in Whoville beneath, Was busy now, hanging a mistletoe wreath. ""And they\'re hanging their stockings!"" he snarled with a sneer, ""Tomorrow is Christmas! It\'s practically here!""Dr. Suess, How The Grinch Stole ChristmasChristmas celebrations are coming to Whoville. Cindy Lou Who and her parents Lou Lou Who and Betty Lou Who decided to give sweets to all people in their street. They decided to give the residents of each house on the street, one kilogram of sweets. So they need as many kilos of sweets as there are homes on their street.The street, where the Lou Who family lives can be represented as n consecutive sections of equal length. You can go from any section to a neighbouring one in one unit of time. Each of the sections is one of three types: an empty piece of land, a house or a shop. Cindy Lou and her family can buy sweets in a shop, but no more than one kilogram of sweets in one shop (the vendors care about the residents of Whoville not to overeat on sweets).After the Lou Who family leave their home, they will be on the first section of the road. To get to this section of the road, they also require one unit of time. We can assume that Cindy and her mom and dad can carry an unlimited number of kilograms of sweets. Every time they are on a house section, they can give a kilogram of sweets to the inhabitants of the house, or they can simply move to another section. If the family have already given sweets to the residents of a house, they can\'t do it again. Similarly, if they are on the shop section, they can either buy a kilo of sweets in it or skip this shop. If they\'ve bought a kilo of sweets in a shop, the seller of the shop remembered them and the won\'t sell them a single candy if they come again. The time to buy and give sweets can be neglected. The Lou Whos do not want the people of any house to remain without food.The Lou Whos want to spend no more than t time units of time to give out sweets, as they really want to have enough time to prepare for the Christmas celebration. In order to have time to give all the sweets, they may have to initially bring additional k kilos of sweets.Cindy Lou wants to know the minimum number of k kilos of sweets they need to take with them, to have time to give sweets to the residents of each house in their street.Your task is to write a program that will determine the minimum possible value of k." 2300

248C Robo-Footballer "binary search,geometry" "It\'s a beautiful April day and Wallace is playing football with his friends. But his friends do not know that Wallace actually stayed home with Gromit and sent them his robotic self instead. Robo-Wallace has several advantages over the other guys. For example, he can hit the ball directly to the specified point. And yet, the notion of a giveaway is foreign to him. The combination of these features makes the Robo-Wallace the perfect footballer \xe2\x80\x94 as soon as the ball gets to him, he can just aim and hit the goal. He followed this tactics in the first half of the match, but he hit the goal rarely. The opposing team has a very good goalkeeper who catches most of the balls that fly directly into the goal. But Robo-Wallace is a quick thinker, he realized that he can cheat the goalkeeper. After all, they are playing in a football box with solid walls. Robo-Wallace can kick the ball to the other side, then the goalkeeper will not try to catch the ball. Then, if the ball bounces off the wall and flies into the goal, the goal will at last be scored.Your task is to help Robo-Wallace to detect a spot on the wall of the football box, to which the robot should kick the ball, so that the ball bounces once and only once off this wall and goes straight to the goal. In the first half of the match Robo-Wallace got a ball in the head and was severely hit. As a result, some of the schemes have been damaged. Because of the damage, Robo-Wallace can only aim to his right wall (Robo-Wallace is standing with his face to the opposing team\'s goal).The football box is rectangular. Let\'s introduce a two-dimensional coordinate system so that point (0, 0) lies in the lower left corner of the field, if you look at the box above. Robo-Wallace is playing for the team, whose goal is to the right. It is an improvised football field, so the gate of Robo-Wallace\'s rivals may be not in the middle of the left wall.  In the given coordinate system you are given:   y1, y2 \xe2\x80\x94 the y-coordinates of the side pillars of the goalposts of robo-Wallace\'s opponents;  yw \xe2\x80\x94 the y-coordinate of the wall to which Robo-Wallace is aiming;  xb, yb \xe2\x80\x94 the coordinates of the ball\'s position when it is hit;  r \xe2\x80\x94 the radius of the ball. A goal is scored when the center of the ball crosses the OY axis in the given coordinate system between (0, y1) and (0, y2). The ball moves along a straight line. The ball\'s hit on the wall is perfectly elastic (the ball does not shrink from the hit), the angle of incidence equals the angle of reflection. If the ball bounces off the wall not to the goal, that is, if it hits the other wall or the goal post, then the opposing team catches the ball and Robo-Wallace starts looking for miscalculation and gets dysfunctional. Such an outcome, if possible, should be avoided. We assume that the ball touches an object, if the distance from the center of the ball to the object is no greater than the ball radius r." 2000

248B "Chilly Willy" "math,number theory" "Chilly Willy loves playing with numbers. He only knows prime numbers that are digits yet. These numbers are 2, 3, 5 and 7. But Willy grew rather bored of such numbers, so he came up with a few games that were connected with them.Chilly Willy wants to find the minimum number of length n, such that it is simultaneously divisible by all numbers Willy already knows (2, 3, 5 and 7). Help him with that.A number\'s length is the number of digits in its decimal representation without leading zeros." 1400

248A Cupboards implementation "One foggy Stockholm morning, Karlsson decided to snack on some jam in his friend Lillebror Svantenson\'s house. Fortunately for Karlsson, there wasn\'t anybody in his friend\'s house. Karlsson was not going to be hungry any longer, so he decided to get some food in the house.Karlsson\'s gaze immediately fell on n wooden cupboards, standing in the kitchen. He immediately realized that these cupboards have hidden jam stocks. Karlsson began to fly greedily around the kitchen, opening and closing the cupboards\' doors, grab and empty all the jars of jam that he could find.And now all jars of jam are empty, Karlsson has had enough and does not want to leave traces of his stay, so as not to let down his friend. Each of the cupboards has two doors: the left one and the right one. Karlsson remembers that when he rushed to the kitchen, all the cupboards\' left doors were in the same position (open or closed), similarly, all the cupboards\' right doors were in the same position (open or closed). Karlsson wants the doors to meet this condition as well by the time the family returns. Karlsson does not remember the position of all the left doors, also, he cannot remember the position of all the right doors. Therefore, it does not matter to him in what position will be all left or right doors. It is important to leave all the left doors in the same position, and all the right doors in the same position. For example, all the left doors may be closed, and all the right ones may be open.Karlsson needs one second to open or close a door of a cupboard. He understands that he has very little time before the family returns, so he wants to know the minimum number of seconds t, in which he is able to bring all the cupboard doors in the required position.Your task is to write a program that will determine the required number of seconds t." 800

246E "Blood Cousins Return" "binary search,data structures,dfs and similar,dp,sortings" "Polycarpus got hold of a family tree. The found tree describes the family relations of n people, numbered from 1 to n. Every person in this tree has at most one direct ancestor. Also, each person in the tree has a name, the names are not necessarily unique.We call the man with a number a a 1-ancestor of the man with a number b, if the man with a number a is a direct ancestor of the man with a number b.We call the man with a number a a k-ancestor (k\xe2\x80\x89>\xe2\x80\x891) of the man with a number b, if the man with a number b has a 1-ancestor, and the man with a number a is a (k\xe2\x80\x89-\xe2\x80\x891)-ancestor of the 1-ancestor of the man with a number b.In the tree the family ties do not form cycles. In other words there isn\'t a person who is his own direct or indirect ancestor (that is, who is an x-ancestor of himself, for some x, x\xe2\x80\x89>\xe2\x80\x890).We call a man with a number a the k-son of the man with a number b, if the man with a number b is a k-ancestor of the man with a number a.Polycarpus is very much interested in how many sons and which sons each person has. He took a piece of paper and wrote m pairs of numbers vi, ki. Help him to learn for each pair vi, ki the number of distinct names among all names of the ki-sons of the man with number vi." 2400

246D "Colorful Graph" "brute force,dfs and similar,graphs" "You\'ve got an undirected graph, consisting of n vertices and m edges. We will consider the graph\'s vertices numbered with integers from 1 to n. Each vertex of the graph has a color. The color of the i-th vertex is an integer ci.Let\'s consider all vertices of the graph, that are painted some color k. Let\'s denote a set of such as V(k). Let\'s denote the value of the neighbouring color diversity for color k as the cardinality of the set Q(k)\xe2\x80\x89=\xe2\x80\x89{cu�:\xe2\x80\x89�cu\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89k and there is vertex v belonging to set V(k) such that nodes v and u are connected by an edge of the graph}.Your task is to find such color k, which makes the cardinality of set Q(k) maximum. In other words, you want to find the color that has the most diverse neighbours. Please note, that you want to find such color k, that the graph has at least one vertex with such color." 1600

246C "Beauty Pageant" "brute force,constructive algorithms,greedy" "General Payne has a battalion of n soldiers. The soldiers\' beauty contest is coming up, it will last for k days. Payne decided that his battalion will participate in the pageant. Now he has choose the participants.All soldiers in the battalion have different beauty that is represented by a positive integer. The value ai represents the beauty of the i-th soldier.On each of k days Generals has to send a detachment of soldiers to the pageant. The beauty of the detachment is the sum of the beauties of the soldiers, who are part of this detachment. Payne wants to surprise the jury of the beauty pageant, so each of k days the beauty of the sent detachment should be unique. In other words, all k beauties of the sent detachments must be distinct numbers.Help Payne choose k detachments of different beauties for the pageant. Please note that Payne cannot just forget to send soldiers on one day, that is, the detachment of soldiers he sends to the pageant should never be empty." 1600

246B "Increase and Decrease" greedy,math "Polycarpus has an array, consisting of n integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. Polycarpus likes it when numbers in an array match. That\'s why he wants the array to have as many equal numbers as possible. For that Polycarpus performs the following operation multiple times:  he chooses two elements of the array ai, aj (i\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89j);  he simultaneously increases number ai by 1 and decreases number aj by 1, that is, executes ai\xe2\x80\x89=\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x891 and aj\xe2\x80\x89=\xe2\x80\x89aj\xe2\x80\x89-\xe2\x80\x891. The given operation changes exactly two distinct array elements. Polycarpus can apply the described operation an infinite number of times. Now he wants to know what maximum number of equal array elements he can get if he performs an arbitrary number of such operation. Help Polycarpus." 1300

246A "Buggy Sorting" "constructive algorithms,greedy,sortings" "Little boy Valera studies an algorithm of sorting an integer array. After studying the theory, he went on to the practical tasks. As a result, he wrote a program that sorts an array of n integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an in the non-decreasing order. The pseudocode of the program, written by Valera, is given below. The input of the program gets number n and array a.loop integer variable i from 1 to n\xe2\x80\x89-\xe2\x80\x891����loop integer variable j from i to n\xe2\x80\x89-\xe2\x80\x891��������if (aj\xe2\x80\x89>\xe2\x80\x89aj\xe2\x80\x89+\xe2\x80\x891), then swap the values of elements aj and aj\xe2\x80\x89+\xe2\x80\x891But Valera could have made a mistake, because he hasn\'t yet fully learned the sorting algorithm. If Valera made a mistake in his program, you need to give a counter-example that makes his program work improperly (that is, the example that makes the program sort the array not in the non-decreasing order). If such example for the given value of n doesn\'t exist, print -1." 900

245H "Queries for Number of Palindromes" dp,hashing,strings "You\'ve got a string s\xe2\x80\x89=\xe2\x80\x89s1s2... s|s| of length |s|, consisting of lowercase English letters. There also are q queries, each query is described by two integers li,\xe2\x80\x89ri (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89li\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ri\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|s|). The answer to the query is the number of substrings of string s[li... ri], which are palindromes.String s[l... r]\xe2\x80\x89=\xe2\x80\x89slsl\xe2\x80\x89+\xe2\x80\x891... sr (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|s|) is a substring of string s\xe2\x80\x89=\xe2\x80\x89s1s2... s|s|.String t is called a palindrome, if it reads the same from left to right and from right to left. Formally, if t\xe2\x80\x89=\xe2\x80\x89t1t2... t|t|\xe2\x80\x89=\xe2\x80\x89t|t|t|t|\xe2\x80\x89-\xe2\x80\x891... t1." 1800

245G "Suggested Friends" "brute force,graphs" "Polycarpus works as a programmer in a start-up social network. His boss gave his a task to develop a mechanism for determining suggested friends. Polycarpus thought much about the task and came to the folowing conclusion. Let\'s say that all friendship relationships in a social network are given as m username pairs ai,\xe2\x80\x89bi (ai\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89bi). Each pair ai,\xe2\x80\x89bi means that users ai and bi are friends. Friendship is symmetric, that is, if ai is friends with bi, then bi is also friends with ai. User y is a suggested friend for user x, if the following conditions are met:  x\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89y;  x and y aren\'t friends;  among all network users who meet the first two conditions, user y has most of all common friends with user x. User z is a common friend of user x and user y (z\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89x,\xe2\x80\x89z\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89y), if x and z are friends, and y and z are also friends. Your task is to help Polycarpus to implement a mechanism for determining suggested friends." 2200

245F "Log Stream Analysis" "binary search,brute force,implementation,strings" "You\'ve got a list of program warning logs. Each record of a log stream is a string in this format:  ""2012-MM-DD HH:MM:SS:MESSAGE"" (without the quotes). String ""MESSAGE"" consists of spaces, uppercase and lowercase English letters and characters ""!"", ""."", "","", ""?"". String ""2012-MM-DD"" determines a correct date in the year of 2012. String ""HH:MM:SS"" determines a correct time in the 24 hour format.The described record of a log stream means that at a certain time the record has got some program warning (string ""MESSAGE"" contains the warning\'s description).Your task is to print the first moment of time, when the number of warnings for the last n seconds was not less than m." 2000

245E "Mishap in Club" greedy,implementation "Polycarpus just has been out of luck lately! As soon as he found a job in the ""Binary Cat"" cafe, the club got burgled. All ice-cream was stolen.On the burglary night Polycarpus kept a careful record of all club visitors. Each time a visitor entered the club, Polycarpus put down character ""+"" in his notes. Similarly, each time a visitor left the club, Polycarpus put character ""-"" in his notes. We know that all cases of going in and out happened consecutively, that is, no two events happened at the same time. Polycarpus doesn\'t remember whether there was somebody in the club at the moment when his shift begun and at the moment when it ended.Right now the police wonders what minimum number of distinct people Polycarpus could have seen. Assume that he sees anybody coming in or out of the club. Each person could have come in or out an arbitrary number of times." 1400

245D "Restoring Table" "constructive algorithms,greedy" "Recently Polycarpus has learned the ""bitwise AND"" operation (which is also called ""AND"") of non-negative integers. Now he wants to demonstrate the school IT teacher his superb manipulation with the learned operation.For that Polycarpus came to school a little earlier and wrote on the board a sequence of non-negative integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. He also wrote a square matrix b of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89n. The element of matrix b that sits in the i-th row in the j-th column (we\'ll denote it as bij) equals:  the ""bitwise AND"" of numbers ai and aj (that is, bij\xe2\x80\x89=\xe2\x80\x89ai�&�aj), if i\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89j;  -1, if i\xe2\x80\x89=\xe2\x80\x89j. Having written out matrix b, Polycarpus got very happy and wiped a off the blackboard. But the thing is, the teacher will want this sequence to check whether Polycarpus\' calculations were correct. Polycarus urgently needs to restore the removed sequence of integers, or else he won\'t prove that he can count correctly.Help Polycarpus, given matrix b, restore the sequence of numbers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an, that he has removed from the board. Polycarpus doesn\'t like large numbers, so any number in the restored sequence mustn\'t exceed 109." 1500

245C "Game with Coins" greedy "Two pirates Polycarpus and Vasily play a very interesting game. They have n chests with coins, the chests are numbered with integers from 1 to n. Chest number i has ai coins. Polycarpus and Vasily move in turns. Polycarpus moves first. During a move a player is allowed to choose a positive integer x (2\xc2\xb7x\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) and take a coin from each chest with numbers x, 2\xc2\xb7x, 2\xc2\xb7x\xe2\x80\x89+\xe2\x80\x891. It may turn out that some chest has no coins, in this case the player doesn\'t take a coin from this chest. The game finishes when all chests get emptied.Polycarpus isn\'t a greedy scrooge. Polycarpys is a lazy slob. So he wonders in what minimum number of moves the game can finish. Help Polycarpus, determine the minimum number of moves in which the game can finish. Note that Polycarpus counts not only his moves, he also counts Vasily\'s moves." 1700

245B "Internet Address" implementation,strings "Vasya is an active Internet user. One day he came across an Internet resource he liked, so he wrote its address in the notebook. We know that the address of the written resource has format: <protocol>://<domain>.ru[/<context>] where:  <protocol> can equal either ""http"" (without the quotes) or ""ftp"" (without the quotes),  <domain> is a non-empty string, consisting of lowercase English letters,  the /<context> part may not be present. If it is present, then <context> is a non-empty string, consisting of lowercase English letters. If string <context> isn\'t present in the address, then the additional character ""/"" isn\'t written. Thus, the address has either two characters ""/"" (the ones that go before the domain), or three (an extra one in front of the context).When the boy came home, he found out that the address he wrote in his notebook had no punctuation marks. Vasya must have been in a lot of hurry and didn\'t write characters "":"", ""/"", ""."".Help Vasya to restore the possible address of the recorded Internet resource." 1100

245A "System Administrator" implementation "Polycarpus is a system administrator. There are two servers under his strict guidance \xe2\x80\x94 a and b. To stay informed about the servers\' performance, Polycarpus executes commands ""ping a"" and ""ping b"". Each ping command sends exactly ten packets to the server specified in the argument of the command. Executing a program results in two integers x and y (x\xe2\x80\x89+\xe2\x80\x89y\xe2\x80\x89=\xe2\x80\x8910;�x,\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x890). These numbers mean that x packets successfully reached the corresponding server through the network and y packets were lost.Today Polycarpus has performed overall n ping commands during his workday. Now for each server Polycarpus wants to know whether the server is ""alive"" or not. Polycarpus thinks that the server is ""alive"", if at least half of the packets that we send to this server reached it successfully along the network.Help Polycarpus, determine for each server, whether it is ""alive"" or not by the given commands and their results." 800

244B "Undoubtedly Lucky Numbers" "bitmasks,brute force,dfs and similar" "Polycarpus loves lucky numbers. Everybody knows that lucky numbers are positive integers, whose decimal representation (without leading zeroes) contain only the lucky digits x and y. For example, if x\xe2\x80\x89=\xe2\x80\x894, and y\xe2\x80\x89=\xe2\x80\x897, then numbers 47, 744, 4 are lucky.Let\'s call a positive integer a undoubtedly lucky, if there are such digits x and y (0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x,\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x899), that the decimal representation of number a (without leading zeroes) contains only digits x and y.Polycarpus has integer n. He wants to know how many positive integers that do not exceed n, are undoubtedly lucky. Help him, count this number." 1600

244A "Dividing Orange" implementation "One day Ms Swan bought an orange in a shop. The orange consisted of n\xc2\xb7k segments, numbered with integers from 1 to n\xc2\xb7k. There were k children waiting for Ms Swan at home. The children have recently learned about the orange and they decided to divide it between them. For that each child took a piece of paper and wrote the number of the segment that he would like to get: the i-th (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k) child wrote the number ai (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ai\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xc2\xb7k). All numbers ai accidentally turned out to be different.Now the children wonder, how to divide the orange so as to meet these conditions:  each child gets exactly n orange segments;  the i-th child gets the segment with number ai for sure;  no segment goes to two children simultaneously. Help the children, divide the orange and fulfill the requirements, described above." 900

243E Matrix "data structures" "Let\'s consider an n\xe2\x80\x89\xc3\x97\xe2\x80\x89n square matrix, consisting of digits one and zero.We\'ll consider a matrix good, if it meets the following condition: in each row of the matrix all ones go in one group. That is, each row of the matrix looks like that 00...0011...1100...00 (or simply consists of zeroes if it has no ones).You are given matrix a of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89n, consisting of zeroes and ones. Your task is to determine whether you can get a good matrix b from it by rearranging the columns or not." 3000

243D Cubes "data structures,dp,geometry,two pointers" "One day Petya got a set of wooden cubes as a present from his mom. Petya immediately built a whole city from these cubes.The base of the city is an n\xe2\x80\x89\xc3\x97\xe2\x80\x89n square, divided into unit squares. The square\'s sides are parallel to the coordinate axes, the square\'s opposite corners have coordinates (0,\xe2\x80\x890) and (n,\xe2\x80\x89n). On each of the unit squares Petya built a tower of wooden cubes. The side of a wooden cube also has a unit length.After that Petya went an infinitely large distance away from his masterpiece and looked at it in the direction of vector v\xe2\x80\x89=\xe2\x80\x89(vx,\xe2\x80\x89vy,\xe2\x80\x890). Petya wonders, how many distinct cubes are visible from this position. Help him, find this number.Each cube includes the border. We think that a cube is visible if there is a ray emanating from some point p, belonging to the cube, in the direction of vector \xe2\x80\x89-\xe2\x80\x89v, that doesn\'t contain any points, belonging to other cubes." 2700

243C "Colorado Potato Beetle" "dfs and similar,implementation" "Old MacDonald has a farm and a large potato field, (1010\xe2\x80\x89+\xe2\x80\x891)\xe2\x80\x89\xc3\x97\xe2\x80\x89(1010\xe2\x80\x89+\xe2\x80\x891) square meters in size. The field is divided into square garden beds, each bed takes up one square meter.Old McDonald knows that the Colorado potato beetle is about to invade his farm and can destroy the entire harvest. To fight the insects, Old McDonald wants to spray some beds with insecticides.So Old McDonald went to the field, stood at the center of the central field bed and sprayed this bed with insecticides. Now he\'s going to make a series of movements and spray a few more beds. During each movement Old McDonald moves left, right, up or down the field some integer number of meters. As Old McDonald moves, he sprays all the beds he steps on. In other words, the beds that have any intersection at all with Old McDonald\'s trajectory, are sprayed with insecticides.When Old McDonald finished spraying, he wrote out all his movements on a piece of paper. Now he wants to know how many beds won\'t be infected after the invasion of the Colorado beetles.It is known that the invasion of the Colorado beetles goes as follows. First some bed on the field border gets infected. Than any bed that hasn\'t been infected, hasn\'t been sprayed with insecticides and has a common side with an infected bed, gets infected as well. Help Old McDonald and determine the number of beds that won\'t be infected by the Colorado potato beetle." 2200

243B Hydra graphs,sortings "One day Petya got a birthday present from his mom: a book called ""The Legends and Myths of Graph Theory"". From this book Petya learned about a hydra graph.A non-oriented graph is a hydra, if it has a structure, shown on the figure below. Namely, there are two nodes u and v connected by an edge, they are the hydra\'s chest and stomach, correspondingly. The chest is connected with h nodes, which are the hydra\'s heads. The stomach is connected with t nodes, which are the hydra\'s tails. Note that the hydra is a tree, consisting of h\xe2\x80\x89+\xe2\x80\x89t\xe2\x80\x89+\xe2\x80\x892 nodes.  Also, Petya\'s got a non-directed graph G, consisting of n nodes and m edges. Petya got this graph as a last year birthday present from his mom. Graph G contains no self-loops or multiple edges.Now Petya wants to find a hydra in graph G. Or else, to make sure that the graph doesn\'t have a hydra." 2000

243A "The Brand New Function" bitmasks "Polycarpus has a sequence, consisting of n non-negative integers: a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an.Let\'s define function f(l,\xe2\x80\x89r) (l,\xe2\x80\x89r are integer, 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) for sequence a as an operation of bitwise OR of all the sequence elements with indexes from l to r. Formally: f(l,\xe2\x80\x89r)\xe2\x80\x89=\xe2\x80\x89al�|�al\xe2\x80\x89+\xe2\x80\x891�|�... �|�ar. Polycarpus took a piece of paper and wrote out the values of function f(l,\xe2\x80\x89r) for all l,\xe2\x80\x89r (l,\xe2\x80\x89r are integer, 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n). Now he wants to know, how many distinct values he\'s got in the end. Help Polycarpus, count the number of distinct values of function f(l,\xe2\x80\x89r) for the given sequence a.Expression x�|�y means applying the operation of bitwise OR to numbers x and y. This operation exists in all modern programming languages, for example, in language C++ and Java it is marked as ""|"", in Pascal \xe2\x80\x94 as ""or""." 1600

242E "XOR on Segment" "bitmasks,data structures" "You\'ve got an array a, consisting of n integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. You are allowed to perform two operations on this array:  Calculate the sum of current array elements on the segment [l,\xe2\x80\x89r], that is, count value al\xe2\x80\x89+\xe2\x80\x89al\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89ar.  Apply the xor operation with a given number x to each array element on the segment [l,\xe2\x80\x89r], that is, execute . This operation changes exactly r\xe2\x80\x89-\xe2\x80\x89l\xe2\x80\x89+\xe2\x80\x891 array elements. Expression  means applying bitwise xor operation to numbers x and y. The given operation exists in all modern programming languages, for example in language C++ and Java it is marked as ""^"", in Pascal \xe2\x80\x94 as ""xor"".You\'ve got a list of m operations of the indicated type. Your task is to perform all given operations, for each sum query you should print the result you get." 2000

242D Dispute "dfs and similar,graphs,greedy" "Valera has n counters numbered from 1 to n. Some of them are connected by wires, and each of the counters has a special button.Initially, all the counters contain number 0. When you press a button on a certain counter, the value it has increases by one. Also, the values recorded in all the counters, directly connected to it by a wire, increase by one.Valera and Ignat started having a dispute, the dispute is as follows. Ignat thought of a sequence of n integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. Valera should choose some set of distinct counters and press buttons on each of them exactly once (on other counters the buttons won\'t be pressed). If after that there is a counter with the number i, which has value ai, then Valera loses the dispute, otherwise he wins the dispute.Help Valera to determine on which counters he needs to press a button to win the dispute." 2100

242C "King\'s Path" "dfs and similar,graphs,hashing,shortest paths" "Valera has n counters numbered from 1 to n. Some of them are connected by wires, and each of the counters has a special button.Initially, all the counters contain number 0. When you press a button on a certain counter, the value it has increases by one. Also, the values recorded in all the counters, directly connected to it by a wire, increase by one.Valera and Ignat started having a dispute, the dispute is as follows. Ignat thought of a sequence of n integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. Valera should choose some set of distinct counters and press buttons on each of them exactly once (on other counters the buttons won\'t be pressed). If after that there is a counter with the number i, which has value ai, then Valera loses the dispute, otherwise he wins the dispute.Help Valera to determine on which counters he needs to press a button to win the dispute." 1800

242B "Big Segment" implementation,sortings "A coordinate line has n segments, the i-th segment starts at the position li and ends at the position ri. We will denote such a segment as [li,\xe2\x80\x89ri].You have suggested that one of the defined segments covers all others. In other words, there is such segment in the given set, which contains all other ones. Now you want to test your assumption. Find in the given set the segment which covers all other segments, and print its number. If such a segment doesn\'t exist, print -1.Formally we will assume that segment [a,\xe2\x80\x89b] covers segment [c,\xe2\x80\x89d], if they meet this condition a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89c\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89d\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b." 1100

242A "Heads or Tails" "brute force,implementation" "Petya and Vasya are tossing a coin. Their friend Valera is appointed as a judge. The game is very simple. First Vasya tosses a coin x times, then Petya tosses a coin y times. If the tossing player gets head, he scores one point. If he gets tail, nobody gets any points. The winner is the player with most points by the end of the game. If boys have the same number of points, the game finishes with a draw.At some point, Valera lost his count, and so he can not say exactly what the score is at the end of the game. But there are things he remembers for sure. He remembers that the entire game Vasya got heads at least a times, and Petya got heads at least b times. Moreover, he knows that the winner of the game was Vasya. Valera wants to use this information to know every possible outcome of the game, which do not contradict his memories." 1100

241G "Challenging Balloons" "constructive algorithms" "Martha \xe2\x80\x94 as a professional problemsetter \xe2\x80\x94 proposed a problem for a world-class contest. This is the problem statement:Tomorrow is Nadia\'s birthday, and Bardia (her brother) is assigned to make the balloons ready!There are n balloons (initially empty) that are tied to a straight line on certain positions x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xn. Bardia inflates the balloons from left to right. As a result, i-th balloon gets bigger and bigger until its radius reaches the pressure endurance pi or it touches another previously-inflated balloon.  While Bardia was busy with the balloons, he wondered ""What will be the sum of radius of balloons after all of the balloons are inflated?"". Being a nerdy type of guy, he is now thinking about the problem instead of preparing his sister\'s birthday. Calculate the answer to Bardia\'s problem so that Nadia\'s birthday won\'t be balloon-less.Artha \xe2\x80\x94 Martha\'s student \xe2\x80\x94 claimed his solution got accepted. Martha (being his teacher for a long time!) knew he couldn\'t have solved the problem for real and thus thinks there is something wrong with the testcases. Artha isn\'t anyhow logical, which means there is no way for Martha to explain the wrong point in his algorithm. So, the only way is to find a testcase to prove him wrong!Artha\'s pseudo-code is shown below:  You should output a small testcase for the problem such that Artha\'s algorithm is incorrect. The algorithm\'s output is considered correct if it differs from the correct value by no more than 1." 1900

241F Race "brute force,implementation" "The Old City is a rectangular city represented as an m\xe2\x80\x89\xc3\x97\xe2\x80\x89n grid of blocks. This city contains many buildings, straight two-way streets and junctions. Each junction and each building is exactly one block. All the streets have width of one block and are either vertical or horizontal. There is a junction on both sides of each street. We call two blocks adjacent if and only if they share a common side. No two blocks of different streets are adjacent and no two junctions are adjacent. There is an annual festival and as a part of it, The Old Peykan follows a special path in the city. This path starts from a block in a street, continues with many junctions and ends in a block of some street. For each street block, we know how much time it takes for the Old Peykan to go from this block to an adjacent block. Also the Old Peykan can go from each junction to its adjacent street blocks in one minute. Of course Old Peykan can\'t go to building blocks.We know the initial position of the Old Peykan and the sequence of junctions that it passes to reach its destination. After passing all the junctions and reaching the destination, it will stay there forever. Your task is to find out where will the Old Peykan be k minutes after it starts moving. Consider that The Old Peykan always follows the shortest path that passes through the given sequence of junctions and reaches the destination.Note that the Old Peykan may visit some blocks more than once." 2300

241E Flights "graphs,shortest paths" "LiLand is a country, consisting of n cities. The cities are numbered from 1 to n. The country is well known because it has a very strange transportation system. There are many one-way flights that make it possible to travel between the cities, but the flights are arranged in a way that once you leave a city you will never be able to return to that city again.Previously each flight took exactly one hour, but recently Lily has become the new manager of transportation system and she wants to change the duration of some flights. Specifically, she wants to change the duration of some flights to exactly 2 hours in such a way that all trips from city 1 to city n take the same time regardless of their path.Your task is to help Lily to change the duration of flights." 2600

241D Numbers NA "You have a sequence of n distinct integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ai\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n). You want to remove some integers in such a way that the resulting sequence of integers satisfies the following three conditions:  the resulting sequence is not empty;  the exclusive or (xor operation) of all the integers in the resulting sequence equals 0;  if you write all the integers of the resulting sequence (from beginning to the end) in a row in the decimal numeral system and without any spaces, the written number is divisible by p. You are given the sequence of n integers a and a prime number p, find a way to satisfy the described conditions." 2900

241C "Mirror Box" geometry,implementation "Mirror Box is a name of a popular game in the Iranian National Amusement Park (INAP). There is a wooden box, 105 cm long and 100 cm high in this game. Some parts of the box\'s ceiling and floor are covered by mirrors. There are two negligibly small holes in the opposite sides of the box at heights hl and hr centimeters above the floor. The picture below shows what the box looks like.  In the game, you will be given a laser gun to shoot once. The laser beam must enter from one hole and exit from the other one. Each mirror has a preset number vi, which shows the number of points players gain if their laser beam hits that mirror. Also \xe2\x80\x94 to make things even funnier \xe2\x80\x94 the beam must not hit any mirror more than once.Given the information about the box, your task is to find the maximum score a player may gain. Please note that the reflection obeys the law ""the angle of incidence equals the angle of reflection""." 2000

241B Friends "binary search,bitmasks,data structures,math" "You have n friends and you want to take m pictures of them. Exactly two of your friends should appear in each picture and no two pictures should contain the same pair of your friends. So if you have n\xe2\x80\x89=\xe2\x80\x893 friends you can take 3 different pictures, each containing a pair of your friends.Each of your friends has an attractiveness level which is specified by the integer number ai for the i-th friend. You know that the attractiveness of a picture containing the i-th and the j-th friends is equal to the exclusive-or (xor operation) of integers ai and aj.You want to take pictures in a way that the total sum of attractiveness of your pictures is maximized. You have to calculate this value. Since the result may not fit in a 32-bit integer number, print it modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." 2700

241A "Old Peykan" greedy "There are n cities in the country where the Old Peykan lives. These cities are located on a straight line, we\'ll denote them from left to right as c1,\xe2\x80\x89c2,\xe2\x80\x89...,\xe2\x80\x89cn. The Old Peykan wants to travel from city c1 to cn using roads. There are (n\xe2\x80\x89-\xe2\x80\x891) one way roads, the i-th road goes from city ci to city ci\xe2\x80\x89+\xe2\x80\x891 and is di kilometers long.The Old Peykan travels 1 kilometer in 1 hour and consumes 1 liter of fuel during this time.Each city ci (except for the last city cn) has a supply of si liters of fuel which immediately transfers to the Old Peykan if it passes the city or stays in it. This supply refreshes instantly k hours after it transfers. The Old Peykan can stay in a city for a while and fill its fuel tank many times. Initially (at time zero) the Old Peykan is at city c1 and s1 liters of fuel is transferred to it\'s empty tank from c1\'s supply. The Old Peykan\'s fuel tank capacity is unlimited. Old Peykan can not continue its travel if its tank is emptied strictly between two cities.Find the minimum time the Old Peykan needs to reach city cn." 1300

240F TorCoder "data structures" "A boy named Leo doesn\'t miss a single TorCoder contest round. On the last TorCoder round number 100666 Leo stumbled over the following problem. He was given a string s, consisting of n lowercase English letters, and m queries. Each query is characterised by a pair of integers li,\xe2\x80\x89ri (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89li\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ri\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n). We\'ll consider the letters in the string numbered from 1 to n from left to right, that is, s\xe2\x80\x89=\xe2\x80\x89s1s2... sn. After each query he must swap letters with indexes from li to ri inclusive in string s so as to make substring (li,\xe2\x80\x89ri) a palindrome. If there are multiple such letter permutations, you should choose the one where string (li,\xe2\x80\x89ri) will be lexicographically minimum. If no such permutation exists, you should ignore the query (that is, not change string s).Everybody knows that on TorCoder rounds input line and array size limits never exceed 60, so Leo solved this problem easily. Your task is to solve the problem on a little bit larger limits. Given string s and m queries, print the string that results after applying all m queries to string s." 2600

240E "Road Repairs" "dfs and similar,graphs,greedy" "A country named Berland has n cities. They are numbered with integers from 1 to n. City with index 1 is the capital of the country. Some pairs of cities have monodirectional roads built between them. However, not all of them are in good condition. For each road we know whether it needs repairing or not. If a road needs repairing, then it is forbidden to use it. However, the Berland government can repair the road so that it can be used.Right now Berland is being threatened by the war with the neighbouring state. So the capital officials decided to send a military squad to each city. The squads can move only along the existing roads, as there\'s no time or money to build new roads. However, some roads will probably have to be repaired in order to get to some cities.Of course the country needs much resources to defeat the enemy, so you want to be careful with what you\'re going to throw the forces on. That\'s why the Berland government wants to repair the minimum number of roads that is enough for the military troops to get to any city from the capital, driving along good or repaired roads. Your task is to help the Berland government and to find out, which roads need to be repaired." 2800

239B "Easy Tape Programming" "brute force,implementation" "There is a programming language in which every program is a non-empty sequence of ""<"" and "">"" signs and digits. Let\'s explain how the interpreter of this programming language works. A program is interpreted using movement of instruction pointer (IP) which consists of two parts.  Current character pointer (CP);  Direction pointer (DP) which can point left or right; Initially CP points to the leftmost character of the sequence and DP points to the right.We repeat the following steps until the first moment that CP points to somewhere outside the sequence.  If CP is pointing to a digit the interpreter prints that digit then CP moves one step according to the direction of DP. After that the value of the printed digit in the sequence decreases by one. If the printed digit was 0 then it cannot be decreased therefore it\'s erased from the sequence and the length of the sequence decreases by one.  If CP is pointing to ""<"" or "">"" then the direction of DP changes to ""left"" or ""right"" correspondingly. Then CP moves one step according to DP. If the new character that CP is pointing to is ""<"" or "">"" then the previous character will be erased from the sequence. If at any moment the CP goes outside of the sequence the execution is terminated.It\'s obvious the every program in this language terminates after some steps.We have a sequence s1,\xe2\x80\x89s2,\xe2\x80\x89...,\xe2\x80\x89sn of ""<"", "">"" and digits. You should answer q queries. Each query gives you l and r and asks how many of each digit will be printed if we run the sequence sl,\xe2\x80\x89sl\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89sr as an independent program in this language." 1500

239A "Two Bags of Potatoes" greedy,implementation,math "Valera had two bags of potatoes, the first of these bags contains x (x\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x891) potatoes, and the second \xe2\x80\x94 y (y\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x891) potatoes. Valera \xe2\x80\x94 very scattered boy, so the first bag of potatoes (it contains x potatoes) Valera lost. Valera remembers that the total amount of potatoes (x\xe2\x80\x89+\xe2\x80\x89y) in the two bags, firstly, was not gerater than n, and, secondly, was divisible by k.Help Valera to determine how many potatoes could be in the first bag. Print all such possible numbers in ascending order." 1200

238E "Meeting Her" "dp,graphs,shortest paths" "Urpal lives in a big city. He has planned to meet his lover tonight. The city has n junctions numbered from 1 to n. The junctions are connected by m directed streets, all the roads have equal length. Urpal lives in junction a and the date is planned in a restaurant in junction b. He wants to use public transportation to get to junction b. There are k bus transportation companies. At the beginning of every second, a bus from the i-th company chooses a random shortest path between junction si and junction ti and passes through it. There might be no path from si to ti. In that case no bus will leave from si to ti. If a bus passes through a junction where Urpal stands, he can get on the bus. He can also get o\x1bff the bus at any junction along the path. Now Urpal wants to know if it\'s possible to go to the date using public transportation in a \x1cfinite amount of time (the time of travel is the sum of length of the traveled roads) and what is the minimum number of buses he should take in the worst case.At any moment Urpal knows only his own position and the place where the date will be. When he gets on the bus he knows only the index of the company of this bus. Of course Urpal knows the city map and the the pairs (si,\xe2\x80\x89ti) for each company.Note that Urpal doesn\'t know buses velocity." 2600

238D "Tape Programming" "data structures,implementation" "There is a programming language in which every program is a non-empty sequence of ""<"" and "">"" signs and digits. Let\'s explain how the interpreter of this programming language works. A program is interpreted using movement of instruction pointer (IP) which consists of two parts.  Current character pointer (CP);  Direction pointer (DP) which can point left or right; Initially CP points to the leftmost character of the sequence and DP points to the right.We repeat the following steps until the first moment that CP points to somewhere outside the sequence.  If CP is pointing to a digit the interpreter prints that digit then CP moves one step according to the direction of DP. After that the value of the printed digit in the sequence decreases by one. If the printed digit was 0 then it cannot be decreased therefore it\'s erased from the sequence and the length of the sequence decreases by one.  If CP is pointing to ""<"" or "">"" then the direction of DP changes to ""left"" or ""right"" correspondingly. Then CP moves one step according to DP. If the new character that CP is pointing to is ""<"" or "">"" then the previous character will be erased from the sequence. If at any moment the CP goes outside of the sequence the execution is terminated.It\'s obvious the every program in this language terminates after some steps.We have a sequence s1,\xe2\x80\x89s2,\xe2\x80\x89...,\xe2\x80\x89sn of ""<"", "">"" and digits. You should answer q queries. Each query gives you l and r and asks how many of each digit will be printed if we run the sequence sl,\xe2\x80\x89sl\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89sr as an independent program in this language." 2900

238C "World Eater Brothers" "dfs and similar,dp,greedy,trees" "You must have heard of the two brothers dreaming of ruling the world. With all their previous plans failed, this time they decided to cooperate with each other in order to rule the world. As you know there are n countries in the world. These countries are connected by n\xe2\x80\x89-\xe2\x80\x891 directed roads. If you don\'t consider direction of the roads there is a unique path between every pair of countries in the world, passing through each road at most once. Each of the brothers wants to establish his reign in some country, then it\'s possible for him to control the countries that can be reached from his country using directed roads. The brothers can rule the world if there exists at most two countries for brothers to choose (and establish their reign in these countries) so that any other country is under control of at least one of them. In order to make this possible they want to change the direction of minimum number of roads. Your task is to calculate this minimum number of roads." 2100

238B "Boring Partition" "constructive algorithms" "This problem is the most boring one you\'ve ever seen. Given a sequence of integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an and a non-negative integer h, our goal is to partition the sequence into two subsequences (not necessarily consist of continuous elements). Each element of the original sequence should be contained in exactly one of the result subsequences. Note, that one of the result subsequences can be empty.Let\'s define function f(ai,\xe2\x80\x89aj) on pairs of distinct elements (that is i\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89j) in the original sequence. If ai and aj are in the same subsequence in the current partition then f(ai,\xe2\x80\x89aj)\xe2\x80\x89=\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x89aj otherwise f(ai,\xe2\x80\x89aj)\xe2\x80\x89=\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x89aj\xe2\x80\x89+\xe2\x80\x89h. Consider all possible values of the function f for some partition. We\'ll call the goodness of this partiotion the difference between the maximum value of function f and the minimum value of function f.Your task is to find a partition of the given sequence a that have the minimal possible goodness among all possible partitions." 1800

238A "Not Wool Sequences" "constructive algorithms,math" "A sequence of non-negative integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an of length n is called a wool sequence if and only if there exists two integers l and r (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) such that . In other words each wool sequence contains a subsequence of consecutive elements with xor equal to 0.The expression  means applying the operation of a bitwise xor to numbers x and y. The given operation exists in all modern programming languages, for example, in languages C++ and Java it is marked as ""^"", in Pascal \xe2\x80\x94 as ""xor"".In this problem you are asked to compute the number of sequences made of n integers from 0 to 2m\xe2\x80\x89-\xe2\x80\x891 that are not a wool sequence. You should print this number modulo 1000000009 (109\xe2\x80\x89+\xe2\x80\x899)." 1300

237E "Build String" flows,graphs "You desperately need to build some string t. For that you\'ve got n more strings s1,\xe2\x80\x89s2,\xe2\x80\x89...,\xe2\x80\x89sn. To build string t, you are allowed to perform exactly |t| (|t| is the length of string t) operations on these strings. Each operation looks like that:  choose any non-empty string from strings s1,\xe2\x80\x89s2,\xe2\x80\x89...,\xe2\x80\x89sn;  choose an arbitrary character from the chosen string and write it on a piece of paper;  remove the chosen character from the chosen string. Note that after you perform the described operation, the total number of characters in strings s1,\xe2\x80\x89s2,\xe2\x80\x89...,\xe2\x80\x89sn decreases by 1. We are assumed to build string t, if the characters, written on the piece of paper, in the order of performed operations form string t.There are other limitations, though. For each string si you know number ai \xe2\x80\x94 the maximum number of characters you are allowed to delete from string si. You also know that each operation that results in deleting a character from string si, costs i rubles. That is, an operation on string s1 is the cheapest (it costs 1 ruble), and the operation on string sn is the most expensive one (it costs n rubles).Your task is to count the minimum amount of money (in rubles) you will need to build string t by the given rules. Consider the cost of building string t to be the sum of prices of the operations you use." 2000

237D T-decomposition "dfs and similar,graphs,greedy,trees" "You\'ve got a undirected tree s, consisting of n nodes. Your task is to build an optimal T-decomposition for it. Let\'s define a T-decomposition as follows.Let\'s denote the set of all nodes s as v. Let\'s consider an undirected tree t, whose nodes are some non-empty subsets of v, we\'ll call them xi . The tree t is a T-decomposition of s, if the following conditions holds:  the union of all xi equals v;  for any edge (a,\xe2\x80\x89b) of tree s exists the tree node t, containing both a and b;  if the nodes of the tree t xi and xj contain the node a of the tree s, then all nodes of the tree t, lying on the path from xi to xj also contain node a. So this condition is equivalent to the following: all nodes of the tree t, that contain node a of the tree s, form a connected subtree of tree t. There are obviously many distinct trees t, that are T-decompositions of the tree s. For example, a T-decomposition is a tree that consists of a single node, equal to set v.Let\'s define the cardinality of node xi as the number of nodes in tree s, containing in the node. Let\'s choose the node with the maximum cardinality in t. Let\'s assume that its cardinality equals w. Then the weight of T-decomposition t is value w. The optimal T-decomposition is the one with the minimum weight.Your task is to find the optimal T-decomposition of the given tree s that has the minimum number of nodes." 2000

237C "Primes on Interval" "binary search,number theory,two pointers" "You\'ve decided to carry out a survey in the theory of prime numbers. Let us remind you that a prime number is a positive integer that has exactly two distinct positive integer divisors.Consider positive integers a, a\xe2\x80\x89+\xe2\x80\x891, ..., b (a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b). You want to find the minimum integer l (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b\xe2\x80\x89-\xe2\x80\x89a\xe2\x80\x89+\xe2\x80\x891) such that for any integer x (a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b\xe2\x80\x89-\xe2\x80\x89l\xe2\x80\x89+\xe2\x80\x891) among l integers x, x\xe2\x80\x89+\xe2\x80\x891, ..., x\xe2\x80\x89+\xe2\x80\x89l\xe2\x80\x89-\xe2\x80\x891 there are at least k prime numbers. Find and print the required minimum l. If no value l meets the described limitations, print -1." 1600

237B "Young Table" implementation,sortings "You\'ve got table a, consisting of n rows, numbered from 1 to n. The i-th line of table a contains ci cells, at that for all i (1\xe2\x80\x89<\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) holds ci\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ci\xe2\x80\x89-\xe2\x80\x891. Let\'s denote s as the total number of cells of table a, that is, . We know that each cell of the table contains a single integer from 1 to s, at that all written integers are distinct. Let\'s assume that the cells of the i-th row of table a are numbered from 1 to ci, then let\'s denote the number written in the j-th cell of the i-th row as ai,\xe2\x80\x89j. Your task is to perform several swap operations to rearrange the numbers in the table so as to fulfill the following conditions:  for all i,\xe2\x80\x89j (1\xe2\x80\x89<\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n;�1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ci) holds ai,\xe2\x80\x89j\xe2\x80\x89>\xe2\x80\x89ai\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89j;  for all i,\xe2\x80\x89j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n;�1\xe2\x80\x89<\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ci) holds ai,\xe2\x80\x89j\xe2\x80\x89>\xe2\x80\x89ai,\xe2\x80\x89j\xe2\x80\x89-\xe2\x80\x891. In one swap operation you are allowed to choose two different cells of the table and swap the recorded there numbers, that is the number that was recorded in the first of the selected cells before the swap, is written in the second cell after it. Similarly, the number that was recorded in the second of the selected cells, is written in the first cell after the swap.Rearrange the numbers in the required manner. Note that you are allowed to perform any number of operations, but not more than s. You do not have to minimize the number of operations." 1500

237A "Free Cash" implementation "Valera runs a 24/7 fast food cafe. He magically learned that next day n people will visit his cafe. For each person we know the arrival time: the i-th person comes exactly at hi hours mi minutes. The cafe spends less than a minute to serve each client, but if a client comes in and sees that there is no free cash, than he doesn\'t want to wait and leaves the cafe immediately. Valera is very greedy, so he wants to serve all n customers next day (and get more profit). However, for that he needs to ensure that at each moment of time the number of working cashes is no less than the number of clients in the cafe. Help Valera count the minimum number of cashes to work at his cafe next day, so that they can serve all visitors." 1000

236B "Easy Number Challenge" "implementation,number theory" "Let\'s denote d(n) as the number of divisors of a positive integer n. You are given three integers a, b and c. Your task is to calculate the following sum:Find the sum modulo 1073741824 (230)." 1300

236A "Boy or Girl" "brute force,implementation,strings" "Those days, many boys use beautiful girls\' photos as avatars in forums. So it is pretty hard to tell the gender of a user at the first glance. Last year, our hero went to a forum and had a nice chat with a beauty (he thought so). After that they talked very often and eventually they became a couple in the network. But yesterday, he came to see ""her"" in the real world and found out ""she"" is actually a very strong man! Our hero is very sad and he is too tired to love again now. So he came up with a way to recognize users\' genders by their user names.This is his method: if the number of distinct characters in one\'s user name is odd, then he is a male, otherwise she is a female. You are given the string that denotes the user name, please help our hero to determine the gender of this user by his method." 800

235E "Number Challenge" "combinatorics,dp,implementation,math,number theory" "Let\'s denote d(n) as the number of divisors of a positive integer n. You are given three integers a, b and c. Your task is to calculate the following sum:Find the sum modulo 1073741824 (230)." 2600

235D "Graph Game" graphs "In computer science, there is a method called ""Divide And Conquer By Node"" to solve some hard problems about paths on a tree. Let\'s desribe how this method works by function:solve(t) (t is a tree):   Chose a node x (it\'s common to chose weight-center) in tree t. Let\'s call this step ""Line A"".  Deal with all paths that pass x.  Then delete x from tree t.  After that t becomes some subtrees.  Apply solve on each subtree. This ends when t has only one node because after deleting it, there\'s nothing. Now, WJMZBMR has mistakenly believed that it\'s ok to chose any node in ""Line A"". So he\'ll chose a node at random. To make the situation worse, he thinks a ""tree"" should have the same number of edges and nodes! So this procedure becomes like that.Let\'s define the variable totalCost. Initially the value of totalCost equal to 0. So, solve(t) (now t is a graph):   totalCost\xe2\x80\x89=\xe2\x80\x89totalCost\xe2\x80\x89+\xe2\x80\x89(size�of�t). The operation ""="" means assignment. (Size�of�t) means the number of nodes in t.  Choose a node x in graph t at random (uniformly among all nodes of t).  Then delete x from graph t.  After that t becomes some connected components.  Apply solve on each component. He\'ll apply solve on a connected graph with n nodes and n edges. He thinks it will work quickly, but it\'s very slow. So he wants to know the expectation of totalCost of this procedure. Can you help him?" 3000

235C "Cyclical Quest" "data structures,string suffix structures,strings" "Some days ago, WJMZBMR learned how to answer the query ""how many times does a string x occur in a string s"" quickly by preprocessing the string s. But now he wants to make it harder.So he wants to ask ""how many consecutive substrings of s are cyclical isomorphic to a given string x"". You are given string s and n strings xi, for each string xi find, how many consecutive substrings of s are cyclical isomorphic to xi.Two strings are called cyclical isomorphic if one can rotate one string to get the other one. \'Rotate\' here means \'to take some consecutive chars (maybe none) from the beginning of a string and put them back at the end of the string in the same order\'. For example, string ""abcde"" can be rotated to string ""deabc"". We can take characters ""abc"" from the beginning and put them at the end of ""de""." 2700

235B "Let\'s Play Osu!" dp,math,probabilities "Some days ago, WJMZBMR learned how to answer the query ""how many times does a string x occur in a string s"" quickly by preprocessing the string s. But now he wants to make it harder.So he wants to ask ""how many consecutive substrings of s are cyclical isomorphic to a given string x"". You are given string s and n strings xi, for each string xi find, how many consecutive substrings of s are cyclical isomorphic to xi.Two strings are called cyclical isomorphic if one can rotate one string to get the other one. \'Rotate\' here means \'to take some consecutive chars (maybe none) from the beginning of a string and put them back at the end of the string in the same order\'. For example, string ""abcde"" can be rotated to string ""deabc"". We can take characters ""abc"" from the beginning and put them at the end of ""de""." 2000

235A "LCM Challenge" "number theory" "Some days ago, I learned the concept of LCM (least common multiple). I\'ve played with it for several times and I want to make a big number with it.But I also don\'t want to use many numbers, so I\'ll choose three positive integers (they don\'t have to be distinct) which are not greater than n. Can you help me to find the maximum possible least common multiple of these three integers?" 1600

234H "Merging Two Decks" "constructive algorithms,greedy" "There are two decks of cards lying on the table in front of you, some cards in these decks lay face up, some of them lay face down. You want to merge them into one deck in which each card is face down. You\'re going to do it in two stages.The first stage is to merge the two decks in such a way that the relative order of the cards from the same deck doesn\'t change. That is, for any two different cards i and j in one deck, if card i lies above card j, then after the merge card i must also be above card j.The second stage is performed on the deck that resulted from the first stage. At this stage, the executed operation is the turning operation. In one turn you can take a few of the top cards, turn all of them, and put them back. Thus, each of the taken cards gets turned and the order of these cards is reversed. That is, the card that was on the bottom before the turn, will be on top after it.Your task is to make sure that all the cards are lying face down. Find such an order of merging cards in the first stage and the sequence of turning operations in the second stage, that make all the cards lie face down, and the number of turns is minimum." 2000

234G Practice "constructive algorithms,divide and conquer,implementation" "Little time is left before Berland annual football championship. Therefore the coach of team ""Losewille Rangers"" decided to resume the practice, that were indefinitely interrupted for uncertain reasons. Overall there are n players in ""Losewille Rangers"". Each player on the team has a number \xe2\x80\x94 a unique integer from 1 to n. To prepare for the championship, the coach Mr. Floppe decided to spend some number of practices.Mr. Floppe spent some long nights of his holiday planning how to conduct the practices. He came to a very complex practice system. Each practice consists of one game, all n players of the team take part in the game. The players are sorted into two teams in some way. In this case, the teams may have different numbers of players, but each team must have at least one player.The coach wants to be sure that after the series of the practice sessions each pair of players had at least one practice, when they played in different teams. As the players\' energy is limited, the coach wants to achieve the goal in the least number of practices.Help him to schedule the practices." 1600

234F Fence dp "Vasya should paint a fence in front of his own cottage. The fence is a sequence of n wooden boards arranged in a single row. Each board is a 1 centimeter wide rectangle. Let\'s number the board fence using numbers 1,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89n from left to right. The height of the i-th board is hi centimeters.Vasya has a 1 centimeter wide brush and the paint of two colors, red and green. Of course, the amount of the paint is limited. Vasya counted the area he can paint each of the colors. It turned out that he can not paint over a square centimeters of the fence red, and he can not paint over b square centimeters green. Each board of the fence should be painted exactly one of the two colors. Perhaps Vasya won\'t need one of the colors.In addition, Vasya wants his fence to look smart. To do this, he should paint the fence so as to minimize the value that Vasya called the fence unattractiveness value. Vasya believes that two consecutive fence boards, painted different colors, look unattractive. The unattractiveness value of a fence is the total length of contact between the neighboring boards of various colors. To make the fence look nice, you need to minimize the value as low as possible. Your task is to find what is the minimum unattractiveness Vasya can get, if he paints his fence completely.  The picture shows the fence, where the heights of boards (from left to right) are 2,3,2,4,3,1. The first and the fifth boards are painted red, the others are painted green. The first and the second boards have contact length 2, the fourth and fifth boards have contact length 3, the fifth and the sixth have contact length 1. Therefore, the unattractiveness of the given painted fence is 2+3+1=6." 1800

234E "Champions\' League" implementation "Vasya should paint a fence in front of his own cottage. The fence is a sequence of n wooden boards arranged in a single row. Each board is a 1 centimeter wide rectangle. Let\'s number the board fence using numbers 1,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89n from left to right. The height of the i-th board is hi centimeters.Vasya has a 1 centimeter wide brush and the paint of two colors, red and green. Of course, the amount of the paint is limited. Vasya counted the area he can paint each of the colors. It turned out that he can not paint over a square centimeters of the fence red, and he can not paint over b square centimeters green. Each board of the fence should be painted exactly one of the two colors. Perhaps Vasya won\'t need one of the colors.In addition, Vasya wants his fence to look smart. To do this, he should paint the fence so as to minimize the value that Vasya called the fence unattractiveness value. Vasya believes that two consecutive fence boards, painted different colors, look unattractive. The unattractiveness value of a fence is the total length of contact between the neighboring boards of various colors. To make the fence look nice, you need to minimize the value as low as possible. Your task is to find what is the minimum unattractiveness Vasya can get, if he paints his fence completely.  The picture shows the fence, where the heights of boards (from left to right) are 2,3,2,4,3,1. The first and the fifth boards are painted red, the others are painted green. The first and the second boards have contact length 2, the fourth and fifth boards have contact length 3, the fifth and the sixth have contact length 1. Therefore, the unattractiveness of the given painted fence is 2+3+1=6." 1600

234D Cinema implementation "Overall there are m actors in Berland. Each actor has a personal identifier \xe2\x80\x94 an integer from 1 to m (distinct actors have distinct identifiers). Vasya likes to watch Berland movies with Berland actors, and he has k favorite actors. He watched the movie trailers for the next month and wrote the following information for every movie: the movie title, the number of actors who starred in it, and the identifiers of these actors. Besides, he managed to copy the movie titles and how many actors starred there, but he didn\'t manage to write down the identifiers of some actors. Vasya looks at his records and wonders which movies may be his favourite, and which ones may not be. Once Vasya learns the exact cast of all movies, his favorite movies will be determined as follows: a movie becomes favorite movie, if no other movie from Vasya\'s list has more favorite actors.Help the boy to determine the following for each movie: whether it surely will be his favourite movie; whether it surely won\'t be his favourite movie;  can either be favourite or not." 1600

234C Weather dp,implementation "Scientists say a lot about the problems of global warming and cooling of the Earth. Indeed, such natural phenomena strongly influence all life on our planet.Our hero Vasya is quite concerned about the problems. He decided to try a little experiment and observe how outside daily temperature changes. He hung out a thermometer on the balcony every morning and recorded the temperature. He had been measuring the temperature for the last n days. Thus, he got a sequence of numbers t1,\xe2\x80\x89t2,\xe2\x80\x89...,\xe2\x80\x89tn, where the i-th number is the temperature on the i-th day.Vasya analyzed the temperature statistics in other cities, and came to the conclusion that the city has no environmental problems, if first the temperature outside is negative for some non-zero number of days, and then the temperature is positive for some non-zero number of days. More formally, there must be a positive integer k (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x891) such that t1\xe2\x80\x89<\xe2\x80\x890,\xe2\x80\x89t2\xe2\x80\x89<\xe2\x80\x890,\xe2\x80\x89...,\xe2\x80\x89tk\xe2\x80\x89<\xe2\x80\x890 and tk\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89>\xe2\x80\x890,\xe2\x80\x89tk\xe2\x80\x89+\xe2\x80\x892\xe2\x80\x89>\xe2\x80\x890,\xe2\x80\x89...,\xe2\x80\x89tn\xe2\x80\x89>\xe2\x80\x890. In particular, the temperature should never be zero. If this condition is not met, Vasya decides that his city has environmental problems, and gets upset.You do not want to upset Vasya. Therefore, you want to select multiple values of temperature and modify them to satisfy Vasya\'s condition. You need to know what the least number of temperature values needs to be changed for that." 1300

234B Reading sortings "Vasya is going to the Olympics in the city Ntown by train. The boy wants to read the textbook to prepare for the Olympics. He counted that he needed k hours for this. He also found that the light in the train changes every hour. The light is measured on a scale from 0 to 100, where 0 is very dark, and 100 is very light.Vasya has a train lighting schedule for all n hours of the trip \xe2\x80\x94 n numbers from 0 to 100 each (the light level in the first hour, the second hour and so on). During each of those hours he will either read the whole time, or not read at all. He wants to choose k hours to read a book, not necessarily consecutive, so that the minimum level of light among the selected hours were maximum. Vasya is very excited before the upcoming contest, help him choose reading hours." 1000

234A "Lefthanders and Righthanders" implementation "One fine October day a mathematics teacher Vasily Petrov went to a class and saw there n pupils who sat at the  desks, two people at each desk. Vasily quickly realized that number n is even. Like all true mathematicians, Vasily has all students numbered from 1 to n.But Vasily Petrov did not like the way the children were seated at the desks. According to him, the students whose numbers differ by 1, can not sit together, as they talk to each other all the time, distract others and misbehave.On the other hand, if a righthanded student sits at the left end of the desk and a lefthanded student sits at the right end of the desk, they hit elbows all the time and distract each other. In other cases, the students who sit at the same desk, do not interfere with each other.Vasily knows very well which students are lefthanders and which ones are righthanders, and he asks you to come up with any order that meets these two uncomplicated conditions (students do not talk to each other and do not bump their elbows). It is guaranteed that the input is such that at least one way to seat the students always exists." 1200

233B "Non-square Equation" "binary search,brute force,math" "Let\'s consider equation:x2\xe2\x80\x89+\xe2\x80\x89s(x)\xc2\xb7x\xe2\x80\x89-\xe2\x80\x89n\xe2\x80\x89=\xe2\x80\x890,\xe2\x80\x89 where x,\xe2\x80\x89n are positive integers, s(x) is the function, equal to the sum of digits of number x in the decimal number system.You are given an integer n, find the smallest positive integer root of equation x, or else determine that there are no such roots." 1400

233A "Perfect Permutation" implementation,math "A permutation is a sequence of integers p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pn, consisting of n distinct positive integers, each of them doesn\'t exceed n. Let\'s denote the i-th element of permutation p as pi. We\'ll call number n the size of permutation p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pn.Nickolas adores permutations. He likes some permutations more than the others. He calls such permutations perfect. A perfect permutation is such permutation p that for any i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) (n is the permutation size) the following equations hold ppi\xe2\x80\x89=\xe2\x80\x89i and pi\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89i. Nickolas asks you to print any perfect permutation of size n for the given n." 800

232E "Quick Tortoise" "bitmasks,divide and conquer,dp" "John Doe has a field, which is a rectangular table of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m. We assume that the field rows are numbered from 1 to n from top to bottom, and the field columns are numbered from 1 to m from left to right. Then the cell of the field at the intersection of the x-th row and the y-th column has coordinates (x; y).We know that some cells of John\'s field are painted white, and some are painted black. Also, John has a tortoise, which can move along the white cells of the field. The tortoise can get from a white cell with coordinates (x; y) into cell (x\xe2\x80\x89+\xe2\x80\x891; y) or (x; y\xe2\x80\x89+\xe2\x80\x891), if the corresponding cell is painted white. In other words, the turtle can move only along the white cells of the field to the right or down. The turtle can not go out of the bounds of the field.In addition, John has q queries, each of them is characterized by four numbers x1,\xe2\x80\x89y1,\xe2\x80\x89x2,\xe2\x80\x89y2 (x1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x2, y1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y2). For each query John wants to know whether the tortoise can start from the point with coordinates (x1; y1), and reach the point with coordinates (x2; y2), moving only along the white squares of the field." 3000

232D Fence "binary search,data structures,string suffix structures" "Vasya should paint a fence in front of his own cottage. The fence is a sequence of n wooden boards arranged in a single row. Each board is a 1 centimeter wide rectangle. Let\'s number the board fence using numbers 1,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89n from left to right. The height of the i-th board is hi centimeters.Vasya has a 1 centimeter wide brush and the paint of two colors, red and green. Of course, the amount of the paint is limited. Vasya counted the area he can paint each of the colors. It turned out that he can not paint over a square centimeters of the fence red, and he can not paint over b square centimeters green. Each board of the fence should be painted exactly one of the two colors. Perhaps Vasya won\'t need one of the colors.In addition, Vasya wants his fence to look smart. To do this, he should paint the fence so as to minimize the value that Vasya called the fence unattractiveness value. Vasya believes that two consecutive fence boards, painted different colors, look unattractive. The unattractiveness value of a fence is the total length of contact between the neighboring boards of various colors. To make the fence look nice, you need to minimize the value as low as possible. Your task is to find what is the minimum unattractiveness Vasya can get, if he paints his fence completely.  The picture shows the fence, where the heights of boards (from left to right) are 2,3,2,4,3,1. The first and the fifth boards are painted red, the others are painted green. The first and the second boards have contact length 2, the fourth and fifth boards have contact length 3, the fifth and the sixth have contact length 1. Therefore, the unattractiveness of the given painted fence is 2+3+1=6." 2900

232C "Doe Graphs" "constructive algorithms,divide and conquer,dp,graphs,shortest paths" "John Doe decided that some mathematical object must be named after him. So he invented the Doe graphs. The Doe graphs are a family of undirected graphs, each of them is characterized by a single non-negative number \xe2\x80\x94 its order. We\'ll denote a graph of order k as D(k), and we\'ll denote the number of vertices in the graph D(k) as |D(k)|. Then let\'s define the Doe graphs as follows:  D(0) consists of a single vertex, that has number 1.  D(1) consists of two vertices with numbers 1 and 2, connected by an edge.  D(n) for n\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x892 is obtained from graphs D(n\xe2\x80\x89-\xe2\x80\x891) and D(n\xe2\x80\x89-\xe2\x80\x892). D(n\xe2\x80\x89-\xe2\x80\x891) and D(n\xe2\x80\x89-\xe2\x80\x892) are joined in one graph, at that numbers of all vertices of graph D(n\xe2\x80\x89-\xe2\x80\x892) increase by |D(n\xe2\x80\x89-\xe2\x80\x891)| (for example, vertex number 1 of graph D(n\xe2\x80\x89-\xe2\x80\x892) becomes vertex number 1\xe2\x80\x89+\xe2\x80\x89|D(n\xe2\x80\x89-\xe2\x80\x891)|). After that two edges are added to the graph: the first one goes between vertices with numbers |D(n\xe2\x80\x89-\xe2\x80\x891)| and |D(n\xe2\x80\x89-\xe2\x80\x891)|\xe2\x80\x89+\xe2\x80\x891, the second one goes between vertices with numbers |D(n\xe2\x80\x89-\xe2\x80\x891)|\xe2\x80\x89+\xe2\x80\x891 and 1. Note that the definition of graph D(n) implies, that D(n) is a connected graph, its vertices are numbered from 1 to |D(n)|.   The picture shows the Doe graphs of order 1, 2, 3 and 4, from left to right. John thinks that Doe graphs are that great because for them exists a polynomial algorithm for the search of Hamiltonian path. However, your task is to answer queries of finding the shortest-length path between the vertices ai and bi in the graph D(n).A path between a pair of vertices u and v in the graph is a sequence of vertices x1, x2, ..., xk (k\xe2\x80\x89>\xe2\x80\x891) such, that x1\xe2\x80\x89=\xe2\x80\x89u, xk\xe2\x80\x89=\xe2\x80\x89v, and for any i (i\xe2\x80\x89<\xe2\x80\x89k) vertices xi and xi\xe2\x80\x89+\xe2\x80\x891 are connected by a graph edge. The length of path x1, x2, ..., xk is number (k\xe2\x80\x89-\xe2\x80\x891)." 2600

232B Table bitmasks,combinatorics,dp,math "John Doe has an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m table. John Doe can paint points in some table cells, not more than one point in one table cell. John Doe wants to use such operations to make each square subtable of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89n have exactly k points.John Doe wondered, how many distinct ways to fill the table with points are there, provided that the condition must hold. As this number can be rather large, John Doe asks to find its remainder after dividing by 1000000007 (109\xe2\x80\x89+\xe2\x80\x897).You should assume that John always paints a point exactly in the center of some cell. Two ways to fill a table are considered distinct, if there exists a table cell, that has a point in one way and doesn\'t have it in the other." 1900

232A Cycles "binary search,constructive algorithms,graphs,greedy" "John Doe started thinking about graphs. After some thought he decided that he wants to paint an undirected graph, containing exactly k cycles of length 3. A cycle of length 3 is an unordered group of three distinct graph vertices a, b and c, such that each pair of them is connected by a graph edge. John has been painting for long, but he has not been a success. Help him find such graph. Note that the number of vertices there shouldn\'t exceed 100, or else John will have problems painting it." 1600

231E Cactus "data structures,dfs and similar,dp,graphs,trees" "A connected undirected graph is called a vertex cactus, if each vertex of this graph belongs to at most one simple cycle.A simple cycle in a undirected graph is a sequence of distinct vertices v1,\xe2\x80\x89v2,\xe2\x80\x89...,\xe2\x80\x89vt (t\xe2\x80\x89>\xe2\x80\x892), such that for any i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89t) exists an edge between vertices vi and vi\xe2\x80\x89+\xe2\x80\x891, and also exists an edge between vertices v1 and vt.A simple path in a undirected graph is a sequence of not necessarily distinct vertices v1,\xe2\x80\x89v2,\xe2\x80\x89...,\xe2\x80\x89vt (t\xe2\x80\x89>\xe2\x80\x890), such that for any i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89t) exists an edge between vertices vi and vi\xe2\x80\x89+\xe2\x80\x891 and furthermore each edge occurs no more than once. We\'ll say that a simple path v1,\xe2\x80\x89v2,\xe2\x80\x89...,\xe2\x80\x89vt starts at vertex v1 and ends at vertex vt.You\'ve got a graph consisting of n vertices and m edges, that is a vertex cactus. Also, you\'ve got a list of k pairs of interesting vertices xi,\xe2\x80\x89yi, for which you want to know the following information \xe2\x80\x94 the number of distinct simple paths that start at vertex xi and end at vertex yi. We will consider two simple paths distinct if the sets of edges of the paths are distinct.For each pair of interesting vertices count the number of distinct simple paths between them. As this number can be rather large, you should calculate it modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." 2100

231D "Magic Box" "brute force,geometry" "One day Vasya was going home when he saw a box lying on the road. The box can be represented as a rectangular parallelepiped. Vasya needed no time to realize that the box is special, as all its edges are parallel to the coordinate axes, one of its vertices is at point (0,\xe2\x80\x890,\xe2\x80\x890), and the opposite one is at point (x1,\xe2\x80\x89y1,\xe2\x80\x89z1). The six faces of the box contain some numbers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89a6, exactly one number right in the center of each face.  The numbers are located on the box like that:   number a1 is written on the face that lies on the ZOX plane;  a2 is written on the face, parallel to the plane from the previous point;  a3 is written on the face that lies on the XOY plane;  a4 is written on the face, parallel to the plane from the previous point;  a5 is written on the face that lies on the YOZ plane;  a6 is written on the face, parallel to the plane from the previous point. At the moment Vasya is looking at the box from point (x,\xe2\x80\x89y,\xe2\x80\x89z). Find the sum of numbers that Vasya sees. Note that all faces of the box are not transparent and Vasya can\'t see the numbers through the box. The picture contains transparent faces just to make it easier to perceive. You can consider that if Vasya is looking from point, lying on the plane of some face, than he can not see the number that is written on this face. It is enough to see the center of a face to see the corresponding number for Vasya. Also note that Vasya always reads correctly the ai numbers that he sees, independently of their rotation, angle and other factors (that is, for example, if Vasya sees some ai\xe2\x80\x89=\xe2\x80\x896, then he can\'t mistake this number for 9 and so on)." 1600

231C "To Add or Not to Add" "binary search,sortings,two pointers" "A piece of paper contains an array of n integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. Your task is to find a number that occurs the maximum number of times in this array.However, before looking for such number, you are allowed to perform not more than k following operations \xe2\x80\x94 choose an arbitrary element from the array and add 1 to it. In other words, you are allowed to increase some array element by 1 no more than k times (you are allowed to increase the same element of the array multiple times).Your task is to find the maximum number of occurrences of some number in the array after performing no more than k allowed operations. If there are several such numbers, your task is to find the minimum one." 1600

231B "Magic, Wizardry and Wonders" "constructive algorithms,greedy" "Vasya the Great Magician and Conjurer loves all kinds of miracles and wizardry. In one wave of a magic wand he can turn an object into something else. But, as you all know, there is no better magic in the Universe than the magic of numbers. That\'s why Vasya adores math and spends a lot of time turning some numbers into some other ones.This morning he has n cards with integers lined up in front of him. Each integer is not less than 1, but not greater than l. When Vasya waves his magic wand, two rightmost cards vanish from the line and a new card magically appears in their place. It contains the difference between the left and the right numbers on the two vanished cards. Vasya was very interested to know what would happen next, and so he waved with his magic wand on and on, until the table had a single card left.Suppose that Vasya originally had the following cards: 4, 1, 1, 3 (listed from left to right). Then after the first wave the line would be: 4, 1, -2, and after the second one: 4, 3, and after the third one the table would have a single card with number 1.Please note that in spite of the fact that initially all the numbers on the cards were not less than 1 and not greater than l, the numbers on the appearing cards can be anything, no restrictions are imposed on them.It is now evening. Vasya is very tired and wants to return everything back, but does not remember which cards he had in the morning. He only remembers that there were n cards, they contained integers from 1 to l, and after all magical actions he was left with a single card containing number d.Help Vasya to recover the initial set of cards with numbers." 1500

231A Team "brute force,greedy" "One day three best friends Petya, Vasya and Tonya decided to form a team and take part in programming contests. Participants are usually offered several problems during programming contests. Long before the start the friends decided that they will implement a problem if at least two of them are sure about the solution. Otherwise, the friends won\'t write the problem\'s solution.This contest offers n problems to the participants. For each problem we know, which friend is sure about the solution. Help the friends find the number of problems for which they will write a solution." 800

230B T-primes "binary search,implementation,math,number theory" "We know that prime numbers are positive integers that have exactly two distinct positive divisors. Similarly, we\'ll call a positive integer t \xd0\xa2-prime, if t has exactly three distinct positive divisors.You are given an array of n positive integers. For each of them determine whether it is \xd0\xa2-prime or not." 1300

230A Dragons greedy,sortings "Kirito is stuck on a level of the MMORPG he is playing now. To move on in the game, he\'s got to defeat all n dragons that live on this level. Kirito and the dragons have strength, which is represented by an integer. In the duel between two opponents the duel\'s outcome is determined by their strength. Initially, Kirito\'s strength equals s.If Kirito starts duelling with the i-th (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) dragon and Kirito\'s strength is not greater than the dragon\'s strength xi, then Kirito loses the duel and dies. But if Kirito\'s strength is greater than the dragon\'s strength, then he defeats the dragon and gets a bonus strength increase by yi.Kirito can fight the dragons in any order. Determine whether he can move on to the next level of the game, that is, defeat all dragons without a single loss." 1000

229E Gifts combinatorics,dp,math,probabilities "Once upon a time an old man and his wife lived by the great blue sea. One day the old man went fishing and caught a real live gold fish. The fish said: ""Oh ye, old fisherman! Pray set me free to the ocean and I will grant you with n gifts, any gifts you wish!"". Then the fish gave the old man a list of gifts and their prices. Some gifts on the list can have the same names but distinct prices. However, there can\'t be two gifts with the same names and the same prices. Also, there can be gifts with distinct names and the same prices. The old man can ask for n names of items from the list. If the fish\'s list has p occurrences of the given name, then the old man can\'t ask for this name of item more than p times.The old man knows that if he asks for s gifts of the same name, the fish will randomly (i.e. uniformly amongst all possible choices) choose s gifts of distinct prices with such name from the list. The old man wants to please his greedy wife, so he will choose the n names in such a way that he can get n gifts with the maximum price. Besides, he isn\'t the brightest of fishermen, so if there are several such ways, he chooses one of them uniformly.The old man wondered, what is the probability that he can get n most expensive gifts. As the old man isn\'t good at probability theory, he asks you to help him." 2600

229D Towers "dp,greedy,two pointers" "The city of D consists of n towers, built consecutively on a straight line. The height of the tower that goes i-th (from left to right) in the sequence equals hi. The city mayor decided to rebuild the city to make it beautiful. In a beautiful city all towers are are arranged in non-descending order of their height from left to right.The rebuilding consists of performing several (perhaps zero) operations. An operation constitutes using a crane to take any tower and put it altogether on the top of some other neighboring tower. In other words, we can take the tower that stands i-th and put it on the top of either the (i\xe2\x80\x89-\xe2\x80\x891)-th tower (if it exists), or the (i\xe2\x80\x89+\xe2\x80\x891)-th tower (of it exists). The height of the resulting tower equals the sum of heights of the two towers that were put together. After that the two towers can\'t be split by any means, but more similar operations can be performed on the resulting tower. Note that after each operation the total number of towers on the straight line decreases by 1.Help the mayor determine the minimum number of operations required to make the city beautiful." 2100

229C Triangles combinatorics,graphs,math "Alice and Bob don\'t play games anymore. Now they study properties of all sorts of graphs together. Alice invented the following task: she takes a complete undirected graph with n vertices, chooses some m edges and keeps them. Bob gets the  remaining edges.Alice and Bob are fond of ""triangles"" in graphs, that is, cycles of length 3. That\'s why they wonder: what total number of triangles is there in the two graphs formed by Alice and Bob\'s edges, correspondingly?" 1900

229B Planets "binary search,data structures,graphs,shortest paths" "Goa\'uld Apophis captured Jack O\'Neill\'s team again! Jack himself was able to escape, but by that time Apophis\'s ship had already jumped to hyperspace. But Jack knows on what planet will Apophis land. In order to save his friends, Jack must repeatedly go through stargates to get to this planet.Overall the galaxy has n planets, indexed with numbers from 1 to n. Jack is on the planet with index 1, and Apophis will land on the planet with index n. Jack can move between some pairs of planets through stargates (he can move in both directions); the transfer takes a positive, and, perhaps, for different pairs of planets unequal number of seconds. Jack begins his journey at time 0.It can be that other travellers are arriving to the planet where Jack is currently located. In this case, Jack has to wait for exactly 1 second before he can use the stargate. That is, if at time t another traveller arrives to the planet, Jack can only pass through the stargate at time t\xe2\x80\x89+\xe2\x80\x891, unless there are more travellers arriving at time t\xe2\x80\x89+\xe2\x80\x891 to the same planet.Knowing the information about travel times between the planets, and the times when Jack would not be able to use the stargate on particular planets, determine the minimum time in which he can get to the planet with index n." 1700

229A Shifts "brute force,two pointers" "You are given a table consisting of n rows and m columns. Each cell of the table contains a number, 0 or 1. In one move we can choose some row of the table and cyclically shift its values either one cell to the left, or one cell to the right.To cyclically shift a table row one cell to the right means to move the value of each cell, except for the last one, to the right neighboring cell, and to move the value of the last cell to the first cell. A cyclical shift of a row to the left is performed similarly, but in the other direction. For example, if we cyclically shift a row ""00110"" one cell to the right, we get a row ""00011"", but if we shift a row ""00110"" one cell to the left, we get a row ""01100"".Determine the minimum number of moves needed to make some table column consist only of numbers 1." 1500

228E "The Road to Berland is Paved With Good Intentions" "2-sat,dfs and similar,dsu,graphs" "Berland has n cities, some of them are connected by bidirectional roads. For each road we know whether it is asphalted or not.The King of Berland Valera II wants to asphalt all roads of Berland, for that he gathered a group of workers. Every day Valera chooses exactly one city and orders the crew to asphalt all roads that come from the city. The valiant crew fulfilled the King\'s order in a day, then workers went home.Unfortunately, not everything is as great as Valera II would like. The main part of the group were gastarbeiters \xe2\x80\x94 illegal immigrants who are enthusiastic but not exactly good at understanding orders in Berlandian. Therefore, having received orders to asphalt the roads coming from some of the city, the group asphalted all non-asphalted roads coming from the city, and vice versa, took the asphalt from the roads that had it.Upon learning of this progress, Valera II was very upset, but since it was too late to change anything, he asked you to make a program that determines whether you can in some way asphalt Berlandian roads in at most n days. Help the king." 1900

228D Zigzag "data structures" "The court wizard Zigzag wants to become a famous mathematician. For that, he needs his own theorem, like the Cauchy theorem, or his sum, like the Minkowski sum. But most of all he wants to have his sequence, like the Fibonacci sequence, and his function, like the Euler\'s totient function.The Zigag\'s sequence with the zigzag factor z is an infinite sequence Siz (i\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x891;�z\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x892), that is determined as follows:  Siz\xe2\x80\x89=\xe2\x80\x892, when ;  , when ;  , when . Operation  means taking the remainder from dividing number x by number y. For example, the beginning of sequence Si3 (zigzag factor 3) looks as follows: 1, 2, 3, 2, 1, 2, 3, 2, 1.Let\'s assume that we are given an array a, consisting of n integers. Let\'s define element number i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) of the array as ai. The Zigzag function is function , where l,\xe2\x80\x89r,\xe2\x80\x89z satisfy the inequalities 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n, z\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x892.To become better acquainted with the Zigzag sequence and the Zigzag function, the wizard offers you to implement the following operations on the given array a.  The assignment operation. The operation parameters are (p,\xe2\x80\x89v). The operation denotes assigning value v to the p-th array element. After the operation is applied, the value of the array element ap equals v.  The Zigzag operation. The operation parameters are (l,\xe2\x80\x89r,\xe2\x80\x89z). The operation denotes calculating the Zigzag function Z(l,\xe2\x80\x89r,\xe2\x80\x89z). Explore the magical powers of zigzags, implement the described operations." 2100

228C "Fractal Detector" dp,hashing "Little Vasya likes painting fractals very much.He does it like this. First the boy cuts out a 2\xe2\x80\x89\xc3\x97\xe2\x80\x892-cell square out of squared paper. Then he paints some cells black. The boy calls the cut out square a fractal pattern. Then he takes a clean square sheet of paper and paints a fractal by the following algorithm:  He divides the sheet into four identical squares. A part of them is painted black according to the fractal pattern.  Each square that remained white, is split into 4 lesser white squares, some of them are painted according to the fractal pattern. Each square that remained black, is split into 4 lesser black squares.  In each of the following steps step 2 repeats. To draw a fractal, the boy can make an arbitrary positive number of steps of the algorithm. But he need to make at least two steps. In other words step 2 of the algorithm must be done at least once. The resulting picture (the square with painted cells) will be a fractal. The figure below shows drawing a fractal (here boy made three steps of the algorithm).  One evening Vasya got very tired, so he didn\'t paint the fractal, he just took a sheet of paper, painted a n\xe2\x80\x89\xc3\x97\xe2\x80\x89m-cell field. Then Vasya paint some cells black. Now he wonders, how many squares are on the field, such that there is a fractal, which can be obtained as described above, and which is equal to that square. Square is considered equal to some fractal if they consist of the same amount of elementary not divided cells and for each elementary cell of the square corresponding elementary cell of the fractal have the same color." 2000

228B "Two Tables" "brute force,implementation" "You\'ve got two rectangular tables with sizes na\xe2\x80\x89\xc3\x97\xe2\x80\x89ma and nb\xe2\x80\x89\xc3\x97\xe2\x80\x89mb cells. The tables consist of zeroes and ones. We will consider the rows and columns of both tables indexed starting from 1. Then we will define the element of the first table, located at the intersection of the i-th row and the j-th column, as ai,\xe2\x80\x89j; we will define the element of the second table, located at the intersection of the i-th row and the j-th column, as bi,\xe2\x80\x89j. We will call the pair of integers (x,\xe2\x80\x89y) a shift of the second table relative to the first one. We\'ll call the overlap factor of the shift (x,\xe2\x80\x89y) value:where the variables i,\xe2\x80\x89j take only such values, in which the expression ai,\xe2\x80\x89j\xc2\xb7bi\xe2\x80\x89+\xe2\x80\x89x,\xe2\x80\x89j\xe2\x80\x89+\xe2\x80\x89y makes sense. More formally, inequalities 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89na,\xe2\x80\x891\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ma,\xe2\x80\x891\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89+\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89nb,\xe2\x80\x891\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89+\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89mb must hold. If there are no values of variables i,\xe2\x80\x89j, that satisfy the given inequalities, the value of the sum is considered equal to 0. Your task is to find the shift with the maximum overlap factor among all possible shifts." 1400

228A "Is your horseshoe on the other hoof?" implementation "Valera the Horse is going to the party with friends. He has been following the fashion trends for a while, and he knows that it is very popular to wear all horseshoes of different color. Valera has got four horseshoes left from the last year, but maybe some of them have the same color. In this case he needs to go to the store and buy some few more horseshoes, not to lose face in front of his stylish comrades.Fortunately, the store sells horseshoes of all colors under the sun and Valera has enough money to buy any four of them. However, in order to save the money, he would like to spend as little money as possible, so you need to help Valera and determine what is the minimum number of horseshoes he needs to buy to wear four horseshoes of different colors to a party." 800

227B "Effective Approach" implementation "Once at a team training Vasya, Petya and Sasha got a problem on implementing linear search in an array.According to the boys, linear search works as follows. The array elements in a pre-selected order are in turn compared with the number that you need to find. Once you find the array element that is equal to the required one, the search ends. The efficiency of the algorithm is the number of performed comparisons. The fewer comparisons the linear search has made, the more effective it is.Vasya believes that a linear search would work better if it sequentially iterates through the elements, starting with the 1-st one (in this problem we consider the elements of the array indexed from 1 to n) and ending with the n-th one. And Petya says that Vasya is wrong: the search will need less comparisons if it sequentially iterates the elements starting from the n-th and ending with the 1-st one. Sasha argues that the two approaches are equivalent.To finally begin the task, the teammates decided to settle the debate and compare the two approaches on an example. For this, they took an array that is a permutation of integers from 1 to n, and generated m queries of the form: find element with value bi in the array. They want to calculate for both approaches how many comparisons in total the linear search will need to respond to all queries. If the first search needs fewer comparisons, then the winner of the dispute is Vasya. If the second one does, then the winner is Petya. If both approaches make the same number of comparisons, then Sasha\'s got the upper hand.But the problem is, linear search is too slow. That\'s why the boys aren\'t going to find out who is right before the end of the training, unless you come in here. Help them to determine who will win the dispute." 1100

227A "Where do I Turn?" geometry "Trouble came from the overseas lands: a three-headed dragon Gorynych arrived. The dragon settled at point C and began to terrorize the residents of the surrounding villages.A brave hero decided to put an end to the dragon. He moved from point A to fight with Gorynych. The hero rode from point A along a straight road and met point B on his way. The hero knows that in this land for every pair of roads it is true that they are either parallel to each other, or lie on a straight line, or are perpendicular to each other. He also knows well that points B and C are connected by a road. So the hero must either turn 90 degrees to the left or continue riding straight ahead or turn 90 degrees to the right. But he forgot where the point C is located.Fortunately, a Brave Falcon flew right by. It can see all three points from the sky. The hero asked him what way to go to get to the dragon\'s lair.If you have not got it, you are the falcon. Help the hero and tell him how to get him to point C: turn left, go straight or turn right.At this moment the hero is believed to stand at point B, turning his back to point A." 1300

226E "Noble Knight\'s Path" "data structures,trees" "Trouble came from the overseas lands: a three-headed dragon Gorynych arrived. The dragon settled at point C and began to terrorize the residents of the surrounding villages.A brave hero decided to put an end to the dragon. He moved from point A to fight with Gorynych. The hero rode from point A along a straight road and met point B on his way. The hero knows that in this land for every pair of roads it is true that they are either parallel to each other, or lie on a straight line, or are perpendicular to each other. He also knows well that points B and C are connected by a road. So the hero must either turn 90 degrees to the left or continue riding straight ahead or turn 90 degrees to the right. But he forgot where the point C is located.Fortunately, a Brave Falcon flew right by. It can see all three points from the sky. The hero asked him what way to go to get to the dragon\'s lair.If you have not got it, you are the falcon. Help the hero and tell him how to get him to point C: turn left, go straight or turn right.At this moment the hero is believed to stand at point B, turning his back to point A." 2900

226D "The table" "constructive algorithms,greedy" "Harry Potter has a difficult homework. Given a rectangular table, consisting of n\xe2\x80\x89\xc3\x97\xe2\x80\x89m cells. Each cell of the table contains the integer. Harry knows how to use two spells: the first spell change the sign of the integers in the selected row, the second \xe2\x80\x94 in the selected column. Harry\'s task is to make non-negative the sum of the numbers in each row and each column using these spells.Alone, the boy can not cope. Help the young magician!" 2100

226C Anniversary "data structures,implementation,math,matrices,number theory" "There are less than 60 years left till the 900-th birthday anniversary of a famous Italian mathematician Leonardo Fibonacci. Of course, such important anniversary needs much preparations.Dima is sure that it\'ll be great to learn to solve the following problem by the Big Day: You\'re given a set A, consisting of numbers l, l\xe2\x80\x89+\xe2\x80\x891, l\xe2\x80\x89+\xe2\x80\x892, ..., r; let\'s consider all its k-element subsets; for each such subset let\'s find the largest common divisor of Fibonacci numbers with indexes, determined by the subset elements. Among all found common divisors, Dima is interested in the largest one.Dima asked to remind you that Fibonacci numbers are elements of a numeric sequence, where F1\xe2\x80\x89=\xe2\x80\x891, F2\xe2\x80\x89=\xe2\x80\x891, Fn\xe2\x80\x89=\xe2\x80\x89Fn\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x89Fn\xe2\x80\x89-\xe2\x80\x892 for n\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x893.Dima has more than half a century ahead to solve the given task, but you only have two hours. Count the residue from dividing the sought largest common divisor by m." 2400

226B "Naughty Stone Piles" greedy "There are n piles of stones of sizes a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an lying on the table in front of you.During one move you can take one pile and add it to the other. As you add pile i to pile j, the size of pile j increases by the current size of pile i, and pile i stops existing. The cost of the adding operation equals the size of the added pile.Your task is to determine the minimum cost at which you can gather all stones in one pile. To add some challenge, the stone piles built up conspiracy and decided that each pile will let you add to it not more than k times (after that it can only be added to another pile). Moreover, the piles decided to puzzle you completely and told you q variants (not necessarily distinct) of what k might equal. Your task is to find the minimum cost for each of q variants." 1900

226A "Flying Saucer Segments" math "An expedition group flew from planet ACM-1 to Earth in order to study the bipedal species (its representatives don\'t even have antennas on their heads!).The flying saucer, on which the brave pioneers set off, consists of three sections. These sections are connected by a chain: the 1-st section is adjacent only to the 2-nd one, the 2-nd one \xe2\x80\x94 to the 1-st and the 3-rd ones, the 3-rd one \xe2\x80\x94 only to the 2-nd one. The transitions are possible only between the adjacent sections.The spacecraft team consists of n aliens. Each of them is given a rank \xe2\x80\x94 an integer from 1 to n. The ranks of all astronauts are distinct. The rules established on the Saucer, state that an alien may move from section a to section b only if it is senior in rank to all aliens who are in the segments a and b (besides, the segments a and b are of course required to be adjacent). Any alien requires exactly 1 minute to make a move. Besides, safety regulations require that no more than one alien moved at the same minute along the ship.Alien A is senior in rank to alien B, if the number indicating rank A, is more than the corresponding number for B.At the moment the whole saucer team is in the 3-rd segment. They all need to move to the 1-st segment. One member of the crew, the alien with the identification number CFR-140, decided to calculate the minimum time (in minutes) they will need to perform this task.Help CFR-140, figure out the minimum time (in minutes) that all the astronauts will need to move from the 3-rd segment to the 1-st one. Since this number can be rather large, count it modulo m." 1400

225E Unsolvable "math,number theory" "Consider the following equation:  where sign [a] represents the integer part of number a.Let\'s find all integer z (z\xe2\x80\x89>\xe2\x80\x890), for which this equation is unsolvable in positive integers. The phrase ""unsolvable in positive integers"" means that there are no such positive integers x and y (x,\xe2\x80\x89y\xe2\x80\x89>\xe2\x80\x890), for which the given above equation holds.Let\'s write out all such z in the increasing order: z1,\xe2\x80\x89z2,\xe2\x80\x89z3, and so on (zi\xe2\x80\x89<\xe2\x80\x89zi\xe2\x80\x89+\xe2\x80\x891). Your task is: given the number n, find the number zn." 2100

225D Snake "bitmasks,dfs and similar,graphs,implementation" "Let us remind you the rules of a very popular game called ""Snake"" (or sometimes ""Boa"", ""Python"" or ""Worm"").The game field is represented by an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m rectangular table. Some squares of the field are considered impassable (walls), all other squares of the fields are passable.You control a snake, the snake consists of segments. Each segment takes up exactly one passable square of the field, but any passable square contains at most one segment. All segments are indexed by integers from 1 to k, where k is the snake\'s length. The 1-th segment is the head and the k-th segment is the tail. For any i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89k), segments with indexes i and i\xe2\x80\x89+\xe2\x80\x891 are located in the adjacent squares of the field, that is, these squares share a common side.One of the passable field squares contains an apple. The snake\'s aim is to reach the apple and eat it (that is, to position its head in the square with the apple).The snake moves throughout the game. During one move the snake can move its head to an adjacent field square. All other segments follow the head. That is, each segment number i (1\xe2\x80\x89<\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k) moves to the square that has just had segment number i\xe2\x80\x89-\xe2\x80\x891. Consider that all segments including the head move simultaneously (see the second test sample). If the snake\'s head moves to an unpassable square or to the square, occupied by its other segment, the snake dies. That\'s why we will consider such moves unvalid.Your task is to determine the minimum number of valid moves that the snake needs to reach the apple." 2200

225C Barcode dp,matrices "You\'ve got an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m pixel picture. Each pixel can be white or black. Your task is to change the colors of as few pixels as possible to obtain a barcode picture.A picture is a barcode if the following conditions are fulfilled:   All pixels in each column are of the same color.  The width of each monochrome vertical line is at least x and at most y pixels. In other words, if we group all neighbouring columns of the pixels with equal color, the size of each group can not be less than x or greater than y." 1700

225B "Well-known Numbers" "binary search,greedy,number theory" "Numbers k-bonacci (k is integer, k\xe2\x80\x89>\xe2\x80\x891) are a generalization of Fibonacci numbers and are determined as follows:  F(k,\xe2\x80\x89n)\xe2\x80\x89=\xe2\x80\x890, for integer n, 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89<\xe2\x80\x89k;  F(k,\xe2\x80\x89k)\xe2\x80\x89=\xe2\x80\x891;  F(k,\xe2\x80\x89n)\xe2\x80\x89=\xe2\x80\x89F(k,\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x891)\xe2\x80\x89+\xe2\x80\x89F(k,\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x892)\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89F(k,\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x89k), for integer n, n\xe2\x80\x89>\xe2\x80\x89k. Note that we determine the k-bonacci numbers, F(k,\xe2\x80\x89n), only for integer values of n and k.You\'ve got a number s, represent it as a sum of several (at least two) distinct k-bonacci numbers." 1600

225A "Dice Tower" "constructive algorithms,greedy" "A dice is a cube, its faces contain distinct integers from 1 to 6 as black points. The sum of numbers at the opposite dice faces always equals 7. Please note that there are only two dice (these dices are mirror of each other) that satisfy the given constraints (both of them are shown on the picture on the left).  Alice and Bob play dice. Alice has built a tower from n dice. We know that in this tower the adjacent dice contact with faces with distinct numbers. Bob wants to uniquely identify the numbers written on the faces of all dice, from which the tower is built. Unfortunately, Bob is looking at the tower from the face, and so he does not see all the numbers on the faces. Bob sees the number on the top of the tower and the numbers on the two adjacent sides (on the right side of the picture shown what Bob sees).Help Bob, tell whether it is possible to uniquely identify the numbers on the faces of all the dice in the tower, or not." 1100

224B Array "bitmasks,implementation,two pointers" "You\'ve got an array a, consisting of n integers: a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. Your task is to find a minimal by inclusion segment [l,\xe2\x80\x89r] (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) such, that among numbers al,\xe2\x80\x89�al\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89�...,\xe2\x80\x89�ar there are exactly k distinct numbers.Segment [l,\xe2\x80\x89r] (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n; l,\xe2\x80\x89r are integers) of length m\xe2\x80\x89=\xe2\x80\x89r\xe2\x80\x89-\xe2\x80\x89l\xe2\x80\x89+\xe2\x80\x891, satisfying the given property, is called minimal by inclusion, if there is no segment [x,\xe2\x80\x89y] satisfying the property and less then m in length, such that 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n. Note that the segment [l,\xe2\x80\x89r] doesn\'t have to be minimal in length among all segments, satisfying the given property." 1500

224A Parallelepiped "brute force,geometry,math" "You\'ve got a rectangular parallelepiped with integer edge lengths. You know the areas of its three faces that have a common vertex. Your task is to find the sum of lengths of all 12 edges of this parallelepiped." 1100

223E "Planar Graph" flows,geometry,graphs "A graph is called planar, if it can be drawn in such a way that its edges intersect only at their vertexes.An articulation point is such a vertex of an undirected graph, that when removed increases the number of connected components of the graph.A bridge is such an edge of an undirected graph, that when removed increases the number of connected components of the graph.You\'ve got a connected undirected planar graph consisting of n vertexes, numbered from 1 to n, drawn on the plane. The graph has no bridges, articulation points, loops and multiple edges. You are also given q queries. Each query is a cycle in the graph. The query response is the number of graph vertexes, which (if you draw a graph and the cycle on the plane) are located either inside the cycle, or on it. Write a program that, given the graph and the queries, will answer each query." 3000

223D Spider geometry,graphs "A plane contains a not necessarily convex polygon without self-intersections, consisting of n vertexes, numbered from 1 to n. There is a spider sitting on the border of the polygon, the spider can move like that:  Transfer. The spider moves from the point p1 with coordinates (x1,\xe2\x80\x89y1), lying on the polygon border, to the point p2 with coordinates (x2,\xe2\x80\x89y2), also lying on the border. The spider can\'t go beyond the polygon border as it transfers, that is, the spider\'s path from point p1 to point p2 goes along the polygon border. It\'s up to the spider to choose the direction of walking round the polygon border (clockwise or counterclockwise).  Descend. The spider moves from point p1 with coordinates (x1,\xe2\x80\x89y1) to point p2 with coordinates (x2,\xe2\x80\x89y2), at that points p1 and p2 must lie on one vertical straight line (x1\xe2\x80\x89=\xe2\x80\x89x2), point p1 must be not lower than point p2 (y1\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89y2) and segment p1p2 mustn\'t have points, located strictly outside the polygon (specifically, the segment can have common points with the border). Initially the spider is located at the polygon vertex with number s. Find the length of the shortest path to the vertex number t, consisting of transfers and descends. The distance is determined by the usual Euclidean metric ." 3000

223C "Partial Sums" "combinatorics,math,number theory" "You\'ve got an array a, consisting of n integers. The array elements are indexed from 1 to n. Let\'s determine a two step operation like that:  First we build by the array a an array s of partial sums, consisting of n elements. Element number i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) of array s equals . The operation x�mod�y means that we take the remainder of the division of number x by number y.  Then we write the contents of the array s to the array a. Element number i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) of the array s becomes the i-th element of the array a (ai\xe2\x80\x89=\xe2\x80\x89si). You task is to find array a after exactly k described operations are applied." 1900

223B "Two Strings" "data structures,dp,strings" "A subsequence of length |x| of string s\xe2\x80\x89=\xe2\x80\x89s1s2... s|s| (where |s| is the length of string s) is a string x\xe2\x80\x89=\xe2\x80\x89sk1sk2... sk|x| (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k1\xe2\x80\x89<\xe2\x80\x89k2\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89k|x|\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|s|).You\'ve got two strings�\xe2\x80\x94 s and t. Let\'s consider all subsequences of string s, coinciding with string t. Is it true that each character of string s occurs in at least one of these subsequences? In other words, is it true that for all i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|s|), there is such subsequence x\xe2\x80\x89=\xe2\x80\x89sk1sk2... sk|x| of string s, that x\xe2\x80\x89=\xe2\x80\x89t and for some j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|x|) kj\xe2\x80\x89=\xe2\x80\x89i." 1900

223A "Bracket Sequence" "data structures,expression parsing,implementation" "A bracket sequence is a string, containing only characters ""("", "")"", ""["" and ""]"".A correct bracket sequence is a bracket sequence that can be transformed into a correct arithmetic expression by inserting characters ""1"" and ""+"" between the original characters of the sequence. For example, bracket sequences ""()[]"", ""([])"" are correct (the resulting expressions are: ""(1)+[1]"", ""([1+1]+1)""), and ""]("" and ""["" are not. The empty string is a correct bracket sequence by definition.A substring s[l... r] (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|s|) of string s\xe2\x80\x89=\xe2\x80\x89s1s2... s|s| (where |s| is the length of string s) is the string slsl\xe2\x80\x89+\xe2\x80\x891... sr. The empty string is a substring of any string by definition.You are given a bracket sequence, not necessarily correct. Find its substring which is a correct bracket sequence and contains as many opening square brackets \xc2\xab[\xc2\xbb as possible." 1700

222E "Decoding Genome" dp,matrices "Recently a top secret mission to Mars has taken place. As a result, scientists managed to obtain some information about the Martian DNA. Now we know that any Martian DNA contains at most m different nucleotides, numbered from 1 to m. Special characteristics of the Martian DNA prevent some nucleotide pairs from following consecutively in this chain. For example, if the nucleotide 1 and nucleotide 2 can not follow consecutively in the Martian DNA, then the chain of nucleotides [1, 2] is not a valid chain of Martian DNA, but the chain of nucleotides [2, 1] can be a valid chain (if there is no corresponding restriction). The number of nucleotide pairs that can\'t follow in the DNA chain consecutively, is k. The needs of gene research required information about the quantity of correct n-long chains of the Martian DNA. Your task is to write a program that will calculate this value." 1900

222D Olympiad "binary search,greedy,sortings,two pointers" "A boy named Vasya has taken part in an Olympiad. His teacher knows that in total Vasya got at least x points for both tours of the Olympiad. The teacher has the results of the first and the second tour of the Olympiad but the problem is, the results have only points, no names. The teacher has to know Vasya\'s chances.Help Vasya\'s teacher, find two numbers \xe2\x80\x94 the best and the worst place Vasya could have won. Note that the total results\' table sorts the participants by the sum of points for both tours (the first place has the participant who has got the most points). If two or more participants have got the same number of points, it\'s up to the jury to assign places to them according to their choice. It is guaranteed that each participant of the Olympiad participated in both tours of the Olympiad." 1900

222C "Reducing Fractions" "implementation,math,number theory,sortings" "To confuse the opponents, the Galactic Empire represents fractions in an unusual format. The fractions are represented as two sets of integers. The product of numbers from the first set gives the fraction numerator, the product of numbers from the second set gives the fraction denominator. However, it turned out that the programs that work with fractions in this representations aren\'t complete, they lack supporting the operation of reducing fractions. Implement this operation and the Empire won\'t forget you." 1800

222B "Cosmic Tables" "data structures,implementation" "The Free Meteor Association (FMA) has got a problem: as meteors are moving, the Universal Cosmic Descriptive Humorous Program (UCDHP) needs to add a special module that would analyze this movement. UCDHP stores some secret information about meteors as an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m table with integers in its cells. The order of meteors in the Universe is changing. That\'s why the main UCDHP module receives the following queries:  The query to swap two table rows;  The query to swap two table columns;  The query to obtain a secret number in a particular table cell. As the main UCDHP module is critical, writing the functional of working with the table has been commissioned to you." 1300

222A "Shooshuns and Sequence" "brute force,implementation" "One day shooshuns found a sequence of n integers, written on a blackboard. The shooshuns can perform one operation with it, the operation consists of two steps:  Find the number that goes k-th in the current sequence and add the same number to the end of the sequence;  Delete the first number of the current sequence. The shooshuns wonder after how many operations all numbers on the board will be the same and whether all numbers will ever be the same." 1200

221B "Little Elephant and Numbers" implementation "The Little Elephant loves numbers. He has a positive integer x. The Little Elephant wants to find the number of positive integers d, such that d is the divisor of x, and x and d have at least one common (the same) digit in their decimal representations. Help the Little Elephant to find the described number." 1300

221A "Little Elephant and Function" implementation,math "The Little Elephant enjoys recursive functions.This time he enjoys the sorting function. Let a is a permutation of an integers from 1 to n, inclusive, and ai denotes the i-th element of the permutation. The Little Elephant\'s recursive function f(x), that sorts the first x permutation\'s elements, works as follows:  If x\xe2\x80\x89=\xe2\x80\x891, exit the function.  Otherwise, call f(x\xe2\x80\x89-\xe2\x80\x891), and then make swap(ax\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89ax) (swap the x-th and (x\xe2\x80\x89-\xe2\x80\x891)-th elements of a). The Little Elephant\'s teacher believes that this function does not work correctly. But that-be do not get an F, the Little Elephant wants to show the performance of its function. Help him, find a permutation of numbers from 1 to n, such that after performing the Little Elephant\'s function (that is call f(n)), the permutation will be sorted in ascending order." 1000

220E "Little Elephant and Inversions" "data structures,two pointers" "The Little Elephant has array a, consisting of n positive integers, indexed from 1 to n. Let\'s denote the number with index i as ai.The Little Elephant wants to count, how many pairs of integers l and r are there, such that 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89<\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n and sequence b\xe2\x80\x89=\xe2\x80\x89a1a2... alarar\xe2\x80\x89+\xe2\x80\x891... an has no more than k inversions. An inversion in sequence b is a pair of elements of the sequence b, that change their relative order after a stable sorting of the sequence. In other words, an inversion is a pair of integers i and j, such that 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|b| and bi\xe2\x80\x89>\xe2\x80\x89bj, where |b| is the length of sequence b, and bj is its j-th element.Help the Little Elephant and count the number of the described pairs." 2400

220D "Little Elephant and Triangle" geometry,math "The Little Elephant is playing with the Cartesian coordinates\' system. Most of all he likes playing with integer points. The Little Elephant defines an integer point as a pair of integers (x;�y), such that 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89w and 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89h. Thus, the Little Elephant knows only (w\xe2\x80\x89+\xe2\x80\x891)\xc2\xb7(h\xe2\x80\x89+\xe2\x80\x891) distinct integer points.The Little Elephant wants to paint a triangle with vertexes at integer points, the triangle\'s area must be a positive integer. For that, he needs to find the number of groups of three points that form such triangle. At that, the order of points in a group matters, that is, the group of three points (0;0), (0;2), (2;2) isn\'t equal to the group (0;2), (0;0), (2;2).Help the Little Elephant to find the number of groups of three integer points that form a nondegenerate triangle with integer area." 2500

220C "Little Elephant and Shifts" "data structures" "The Little Elephant has two permutations a and b of length n, consisting of numbers from 1 to n, inclusive. Let\'s denote the i-th (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) element of the permutation a as ai, the j-th (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) element of the permutation b \xe2\x80\x94 as bj.The distance between permutations a and b is the minimum absolute value of the difference between the positions of the occurrences of some number in a and in b. More formally, it\'s such minimum |i\xe2\x80\x89-\xe2\x80\x89j|, that ai\xe2\x80\x89=\xe2\x80\x89bj.A cyclic shift number i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) of permutation b consisting from n elements is a permutation bibi\xe2\x80\x89+\xe2\x80\x891... bnb1b2... bi\xe2\x80\x89-\xe2\x80\x891. Overall a permutation has n cyclic shifts.The Little Elephant wonders, for all cyclic shifts of permutation b, what is the distance between the cyclic shift and permutation a?" 2100

220B "Little Elephant and Array" "constructive algorithms,data structures" "The Little Elephant loves playing with arrays. He has array a, consisting of n positive integers, indexed from 1 to n. Let\'s denote the number with index i as ai. Additionally the Little Elephant has m queries to the array, each query is characterised by a pair of integers lj and rj (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89lj\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89rj\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n). For each query lj,\xe2\x80\x89rj the Little Elephant has to count, how many numbers x exist, such that number x occurs exactly x times among numbers alj,\xe2\x80\x89alj\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89arj.Help the Little Elephant to count the answers to all queries." 1800

220A "Little Elephant and Problem" implementation,sortings "The Little Elephant has got a problem \xe2\x80\x94 somebody has been touching his sorted by non-decreasing array a of length n and possibly swapped some elements of the array.The Little Elephant doesn\'t want to call the police until he understands if he could have accidentally changed the array himself. He thinks that he could have accidentally changed array a, only if array a can be sorted in no more than one operation of swapping elements (not necessarily adjacent). That is, the Little Elephant could have accidentally swapped some two elements.Help the Little Elephant, determine if he could have accidentally changed the array a, sorted by non-decreasing, himself." 1300

219E "Parking Lot" "data structures" "A parking lot in the City consists of n parking spaces, standing in a line. The parking spaces are numbered from 1 to n from left to right. When a car arrives at the lot, the operator determines an empty parking space for it. For the safety\'s sake the chosen place should be located as far from the already occupied places as possible. That is, the closest occupied parking space must be as far away as possible. If there are several such places, then the operator chooses the place with the minimum index from them. If all parking lot places are empty, then the car gets place number 1.We consider the distance between the i-th and the j-th parking spaces equal to 4\xc2\xb7|i\xe2\x80\x89-\xe2\x80\x89j| meters.You are given the parking lot records of arriving and departing cars in the chronological order. For each record of an arriving car print the number of the parking lot that was given to this car." 2200

219D "Choosing Capital for Treeland" "dfs and similar,dp,graphs,trees" "The country Treeland consists of n cities, some pairs of them are connected with unidirectional roads. Overall there are n\xe2\x80\x89-\xe2\x80\x891 roads in the country. We know that if we don\'t take the direction of the roads into consideration, we can get from any city to any other one.The council of the elders has recently decided to choose the capital of Treeland. Of course it should be a city of this country. The council is supposed to meet in the capital and regularly move from the capital to other cities (at this stage nobody is thinking about getting back to the capital from these cities). For that reason if city a is chosen a capital, then all roads must be oriented so that if we move along them, we can get from city a to any other city. For that some roads may have to be inversed.Help the elders to choose the capital so that they have to inverse the minimum number of roads in the country." 1700

219C "Color Stripe" "brute force,dp,greedy" "A colored stripe is represented by a horizontal row of n square cells, each cell is pained one of k colors. Your task is to repaint the minimum number of cells so that no two neighbouring cells are of the same color. You can use any color from 1 to k to repaint the cells." 1600

219B "Special Offer! Super Price 999 Bourles!" implementation "Polycarpus is an amateur businessman. Recently he was surprised to find out that the market for paper scissors is completely free! Without further ado, Polycarpus decided to start producing and selling such scissors.Polycaprus calculated that the optimal celling price for such scissors would be p bourles. However, he read somewhere that customers are attracted by prices that say something like ""Special Offer! Super price 999 bourles!"". So Polycarpus decided to lower the price a little if it leads to the desired effect.Polycarpus agrees to lower the price by no more than d bourles so that the number of nines at the end of the resulting price is maximum. If there are several ways to do it, he chooses the maximum possible price.Note, Polycarpus counts only the trailing nines in a price." 1400

219A k-String implementation,strings "A string is called a k-string if it can be represented as k concatenated copies of some string. For example, the string ""aabaabaabaab"" is at the same time a 1-string, a 2-string and a 4-string, but it is not a 3-string, a 5-string, or a 6-string and so on. Obviously any string is a 1-string.You are given a string s, consisting of lowercase English letters and a positive integer k. Your task is to reorder the letters in the string s in such a way that the resulting string is a k-string." 1000

218B Airport implementation "Lolek and Bolek are about to travel abroad by plane. The local airport has a special ""Choose Your Plane"" offer. The offer\'s conditions are as follows:  it is up to a passenger to choose a plane to fly on;  if the chosen plane has x (x\xe2\x80\x89>\xe2\x80\x890) empty seats at the given moment, then the ticket for such a plane costs x zlotys (units of Polish currency). The only ticket office of the airport already has a queue of n passengers in front of it. Lolek and Bolek have not stood in the queue yet, but they are already wondering what is the maximum and the minimum number of zlotys the airport administration can earn if all n passengers buy tickets according to the conditions of this offer?The passengers buy tickets in turn, the first person in the queue goes first, then goes the second one, and so on up to n-th person." 1100

218A "Mountain Scenery" "brute force,constructive algorithms,implementation" "Little Bolek has found a picture with n mountain peaks painted on it. The n painted peaks are represented by a non-closed polyline, consisting of 2n segments. The segments go through 2n\xe2\x80\x89+\xe2\x80\x891 points with coordinates (1,\xe2\x80\x89y1), (2,\xe2\x80\x89y2), ..., (2n\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89y2n\xe2\x80\x89+\xe2\x80\x891), with the i-th segment connecting the point (i,\xe2\x80\x89yi) and the point (i\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89yi\xe2\x80\x89+\xe2\x80\x891). For any even i (2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x892n) the following condition holds: yi\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89<\xe2\x80\x89yi and yi\xe2\x80\x89>\xe2\x80\x89yi\xe2\x80\x89+\xe2\x80\x891. We shall call a vertex of a polyline with an even x coordinate a mountain peak.   The figure to the left shows the initial picture, the figure to the right shows what the picture looks like after Bolek\'s actions. The affected peaks are marked red, k = 2.  Bolek fancied a little mischief. He chose exactly k mountain peaks, rubbed out the segments that went through those peaks and increased each peak\'s height by one (that is, he increased the y coordinate of the corresponding points). Then he painted the missing segments to get a new picture of mountain peaks. Let us denote the points through which the new polyline passes on Bolek\'s new picture as (1,\xe2\x80\x89r1), (2,\xe2\x80\x89r2), ..., (2n\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89r2n\xe2\x80\x89+\xe2\x80\x891).Given Bolek\'s final picture, restore the initial one." 1100

217E "Alien DNA" "data structures,dsu,trees" "Professor Bajtocy is conducting experiments on alien DNA. He has discovered that it is subject to repetitive mutations \xe2\x80\x94 each mutation happens in the same way: some continuous subsequence of the alien DNA becomes active, copies itself, the copy gets mangled and inserts itself right after the original subsequence. The mangled copy of the activated continuous subsequence is formed by first joining all the elements at the even positions in that subsequence, and then joining all the elements at the odd ones at the end. That is, if the activated subsequence consists of 11 elements and represented as s1s2... s11, its mangled copy is s2s4s6s8s10s1s3s5s7s9s11.For example, if the original sequence was ""ACTGG"" and the mutation happened on the segment [2,\xe2\x80\x894] (that is the activated subsequence is ""CTG""), the mutated DNA is: ""ACTGTCGG"". The mangled copy of the activated subsequence is marked with bold font.Professor Bajtocy has written down the original DNA sequence and the mutations that sequentially happened to it, and he now asks you to recover the first k elements of the DNA sequence after all the mutations." 2800

217D "Bitonix\' Patrol" "bitmasks,brute force,combinatorics,dfs and similar,math" "Professor Bajtocy is conducting experiments on alien DNA. He has discovered that it is subject to repetitive mutations \xe2\x80\x94 each mutation happens in the same way: some continuous subsequence of the alien DNA becomes active, copies itself, the copy gets mangled and inserts itself right after the original subsequence. The mangled copy of the activated continuous subsequence is formed by first joining all the elements at the even positions in that subsequence, and then joining all the elements at the odd ones at the end. That is, if the activated subsequence consists of 11 elements and represented as s1s2... s11, its mangled copy is s2s4s6s8s10s1s3s5s7s9s11.For example, if the original sequence was ""ACTGG"" and the mutation happened on the segment [2,\xe2\x80\x894] (that is the activated subsequence is ""CTG""), the mutated DNA is: ""ACTGTCGG"". The mangled copy of the activated subsequence is marked with bold font.Professor Bajtocy has written down the original DNA sequence and the mutations that sequentially happened to it, and he now asks you to recover the first k elements of the DNA sequence after all the mutations." 2900

217C Formurosa "divide and conquer,dp,expression parsing" "The Bytelandian Institute for Biological Research (BIBR) is investigating the properties of two species of bacteria, named simply 0 and 1. Even under a microscope, bacteria of those two species are very difficult to distinguish. In fact, the only thing the scientists possess that is able to differentiate between them is a plant called Formurosa.If the scientists place a sample of colonies of bacteria on each on Formurosa\'s leaves, it will activate a complicated nutrition process. During that process color of Formurosa changes to reflect the result of a \xe2\x80\x94 possibly very complicated \xe2\x80\x94 logical formula on the species of bacteria, involving constants and the operators | (OR), & (AND) and ^ (XOR). If it is 0, the plant will turn red, otherwise \xe2\x80\x94 it will turn blue.For example, if the nutrition process of Formurosa is described by the formula: (((?^?)|?)&(1^?)); then Formurosa has four leaves (the ""?"" signs denote the leaves). If we place 0,\xe2\x80\x891,\xe2\x80\x890,\xe2\x80\x890 on the respective leaves, the result of the nutrition process will be (((0^1)|0)&(1^0))\xe2\x80\x89=\xe2\x80\x891, therefore the plant will turn blue.The scientists have n colonies of bacteria. They do not know their types; the only thing they know for sure is that not all colonies are of the same type. They want to attempt to determine the bacteria\'s species by repeated evaluations with Formurosa. During each evaluation they must place exactly one sample on every leaf of the plant. However, they may use multiple samples of one colony during a single evaluation; they can even cover the whole plant with bacteria from one colony!Is it possible for them to always determine the species of each colony, no matter what they are (assuming they are not all the same)?" 2600

217B "Blackboard Fibonacci" "brute force,math" "Fibonacci numbers are the sequence of integers: f0\xe2\x80\x89=\xe2\x80\x890, f1\xe2\x80\x89=\xe2\x80\x891, f2\xe2\x80\x89=\xe2\x80\x891, f3\xe2\x80\x89=\xe2\x80\x892, f4\xe2\x80\x89=\xe2\x80\x893, f5\xe2\x80\x89=\xe2\x80\x895, ..., fn\xe2\x80\x89=\xe2\x80\x89fn\xe2\x80\x89-\xe2\x80\x892\xe2\x80\x89+\xe2\x80\x89fn\xe2\x80\x89-\xe2\x80\x891. So every next number is the sum of the previous two.Bajtek has developed a nice way to compute Fibonacci numbers on a blackboard. First, he writes a 0. Then, below it, he writes a 1. Then he performs the following two operations:  operation ""T"": replace the top number with the sum of both numbers;  operation ""B"": replace the bottom number with the sum of both numbers. If he performs n operations, starting with ""T"" and then choosing operations alternately (so that the sequence of operations looks like ""TBTBTBTB...""), the last number written will be equal to fn\xe2\x80\x89+\xe2\x80\x891.Unfortunately, Bajtek sometimes makes mistakes and repeats an operation two or more times in a row. For example, if Bajtek wanted to compute f7, then he would want to do n\xe2\x80\x89=\xe2\x80\x896 operations: ""TBTBTB"". If he instead performs the sequence of operations ""TTTBBT"", then he will have made 3 mistakes, and he will incorrectly compute that the seventh Fibonacci number is 10. The number of mistakes in the sequence of operations is the number of neighbouring equal operations (\xc2\xabTT\xc2\xbb or \xc2\xabBB\xc2\xbb).You are given the number n of operations that Bajtek has made in an attempt to compute fn\xe2\x80\x89+\xe2\x80\x891 and the number r that is the result of his computations (that is last written number). Find the minimum possible number of mistakes that Bajtek must have made and any possible sequence of n operations resulting in r with that number of mistakes.Assume that Bajtek always correctly starts with operation ""T""." 2100

217A "Ice Skating" "brute force,dfs and similar,dsu,graphs" "Bajtek is learning to skate on ice. He\'s a beginner, so his only mode of transportation is pushing off from a snow drift to the north, east, south or west and sliding until he lands in another snow drift. He has noticed that in this way it\'s impossible to get from some snow drifts to some other by any sequence of moves. He now wants to heap up some additional snow drifts, so that he can get from any snow drift to any other one. He asked you to find the minimal number of snow drifts that need to be created.We assume that Bajtek can only heap up snow drifts at integer coordinates." 1200

216E "Martian Luck" "math,number theory" "You know that the Martians use a number system with base k. Digit b (0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b\xe2\x80\x89<\xe2\x80\x89k) is considered lucky, as the first contact between the Martians and the Earthlings occurred in year b (by Martian chronology).A digital root d(x) of number x is a number that consists of a single digit, resulting after cascading summing of all digits of number x. Word ""cascading"" means that if the first summing gives us a number that consists of several digits, then we sum up all digits again, and again, until we get a one digit number.For example, d(35047)\xe2\x80\x89=\xe2\x80\x89d((3\xe2\x80\x89+\xe2\x80\x895\xe2\x80\x89+\xe2\x80\x890\xe2\x80\x89+\xe2\x80\x894)7)\xe2\x80\x89=\xe2\x80\x89d(157)\xe2\x80\x89=\xe2\x80\x89d((1\xe2\x80\x89+\xe2\x80\x895)7)\xe2\x80\x89=\xe2\x80\x89d(67)\xe2\x80\x89=\xe2\x80\x8967. In this sample the calculations are performed in the 7-base notation.If a number\'s digital root equals b, the Martians also call this number lucky.You have string s, which consists of n digits in the k-base notation system. Your task is to find, how many distinct substrings of the given string are lucky numbers. Leading zeroes are permitted in the numbers.Note that substring s[i... j] of the string s\xe2\x80\x89=\xe2\x80\x89a1a2... an (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) is the string aiai\xe2\x80\x89+\xe2\x80\x891... aj. Two substrings s[i1... j1] and s[i2... j2] of the string s are different if either i1\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89i2 or j1\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89j2." 2000

216D "Spider\'s Web" "binary search,sortings,two pointers" "You know that the Martians use a number system with base k. Digit b (0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b\xe2\x80\x89<\xe2\x80\x89k) is considered lucky, as the first contact between the Martians and the Earthlings occurred in year b (by Martian chronology).A digital root d(x) of number x is a number that consists of a single digit, resulting after cascading summing of all digits of number x. Word ""cascading"" means that if the first summing gives us a number that consists of several digits, then we sum up all digits again, and again, until we get a one digit number.For example, d(35047)\xe2\x80\x89=\xe2\x80\x89d((3\xe2\x80\x89+\xe2\x80\x895\xe2\x80\x89+\xe2\x80\x890\xe2\x80\x89+\xe2\x80\x894)7)\xe2\x80\x89=\xe2\x80\x89d(157)\xe2\x80\x89=\xe2\x80\x89d((1\xe2\x80\x89+\xe2\x80\x895)7)\xe2\x80\x89=\xe2\x80\x89d(67)\xe2\x80\x89=\xe2\x80\x8967. In this sample the calculations are performed in the 7-base notation.If a number\'s digital root equals b, the Martians also call this number lucky.You have string s, which consists of n digits in the k-base notation system. Your task is to find, how many distinct substrings of the given string are lucky numbers. Leading zeroes are permitted in the numbers.Note that substring s[i... j] of the string s\xe2\x80\x89=\xe2\x80\x89a1a2... an (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) is the string aiai\xe2\x80\x89+\xe2\x80\x891... aj. Two substrings s[i1... j1] and s[i2... j2] of the string s are different if either i1\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89i2 or j1\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89j2." 1700

216C "Hiring Staff" greedy "A new Berland businessman Vitaly is going to open a household appliances\' store. All he\'s got to do now is to hire the staff.The store will work seven days a week, but not around the clock. Every day at least k people must work in the store.Berland has a law that determines the order of working days and non-working days. Namely, each employee must work for exactly n consecutive days, then rest for exactly m days, then work for n more days and rest for m more, and so on. Vitaly doesn\'t want to break the law. Fortunately, there is a loophole: the law comes into force on the day when the employee is hired. For example, if an employee is hired on day x, then he should work on days [x,\xe2\x80\x89x\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89x\xe2\x80\x89+\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x891], [x\xe2\x80\x89+\xe2\x80\x89m\xe2\x80\x89+\xe2\x80\x89n,\xe2\x80\x89x\xe2\x80\x89+\xe2\x80\x89m\xe2\x80\x89+\xe2\x80\x89n\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89x\xe2\x80\x89+\xe2\x80\x89m\xe2\x80\x89+\xe2\x80\x892n\xe2\x80\x89-\xe2\x80\x891], and so on. Day x can be chosen arbitrarily by Vitaly.There is one more thing: the key to the store. Berland law prohibits making copies of keys, so there is only one key. Vitaly is planning to entrust the key to the store employees. At the same time on each day the key must be with an employee who works that day \xe2\x80\x94 otherwise on this day no one can get inside the store. During the day the key holder can give the key to another employee, if he also works that day. The key will handed to the first hired employee at his first working day.Each employee has to be paid salary. Therefore, Vitaly wants to hire as few employees as possible provided that the store can operate normally on each day from 1 to infinity. In other words, on each day with index from 1 to infinity, the store must have at least k working employees, and one of the working employees should have the key to the store.Help Vitaly and determine the minimum required number of employees, as well as days on which they should be hired." 1800

216B "Forming Teams" "dfs and similar,implementation" "One day n students come to the stadium. They want to play football, and for that they need to split into teams, the teams must have an equal number of people.We know that this group of people has archenemies. Each student has at most two archenemies. Besides, if student A is an archenemy to student B, then student B is an archenemy to student A.The students want to split so as no two archenemies were in one team. If splitting in the required manner is impossible, some students will have to sit on the bench.Determine the minimum number of students you will have to send to the bench in order to form the two teams in the described manner and begin the game at last." 1700

216A "Tiling with Hexagons" implementation,math "Several ages ago Berland was a kingdom. The King of Berland adored math. That\'s why, when he first visited one of his many palaces, he first of all paid attention to the floor in one hall. The floor was tiled with hexagonal tiles.The hall also turned out hexagonal in its shape. The King walked along the perimeter of the hall and concluded that each of the six sides has a, b, c, a, b and c adjacent tiles, correspondingly.To better visualize the situation, look at the picture showing a similar hexagon for a\xe2\x80\x89=\xe2\x80\x892, b\xe2\x80\x89=\xe2\x80\x893 and c\xe2\x80\x89=\xe2\x80\x894.  According to the legend, as the King of Berland obtained the values a, b and c, he almost immediately calculated the total number of tiles on the hall floor. Can you do the same?" 1200

215E "Periodical Numbers" "combinatorics,dp,number theory" "A non-empty string s is called binary, if it consists only of characters ""0"" and ""1"". Let\'s number the characters of binary string s from 1 to the string\'s length and let\'s denote the i-th character in string s as si.Binary string s with length n is periodical, if there is an integer 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k\xe2\x80\x89<\xe2\x80\x89n such that:   k is a divisor of number n  for all 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x89k, the following condition fulfills: si\xe2\x80\x89=\xe2\x80\x89si\xe2\x80\x89+\xe2\x80\x89k For example, binary strings ""101010"" and ""11"" are periodical and ""10"" and ""10010"" are not.A positive integer x is periodical, if its binary representation (without leading zeroes) is a periodic string.Your task is to calculate, how many periodic numbers are in the interval from l to r (both ends are included)." 2100

215D "Hot Days" greedy "The official capital and the cultural capital of Berland are connected by a single road running through n regions. Each region has a unique climate, so the i-th (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) region has a stable temperature of ti degrees in summer.This summer a group of m schoolchildren wants to get from the official capital to the cultural capital to visit museums and sights. The trip organizers transport the children between the cities in buses, but sometimes it is very hot. Specifically, if the bus is driving through the i-th region and has k schoolchildren, then the temperature inside the bus is ti\xe2\x80\x89+\xe2\x80\x89k degrees.Of course, nobody likes it when the bus is hot. So, when the bus drives through the i-th region, if it has more than Ti degrees inside, each of the schoolchild in the bus demands compensation for the uncomfortable conditions. The compensation is as large as xi rubles and it is charged in each region where the temperature in the bus exceeds the limit.To save money, the organizers of the trip may arbitrarily add or remove extra buses in the beginning of the trip, and between regions (of course, they need at least one bus to pass any region). The organizers can also arbitrarily sort the children into buses, however, each of buses in the i-th region will cost the organizers costi rubles. Please note that sorting children into buses takes no money.Your task is to find the minimum number of rubles, which the organizers will have to spend to transport all schoolchildren." 1900

215C Crosses "brute force,implementation" "There is a board with a grid consisting of n rows and m columns, the rows are numbered from 1 from top to bottom and the columns are numbered from 1 from left to right. In this grid we will denote the cell that lies on row number i and column number j as (i,\xe2\x80\x89j).A group of six numbers (a,\xe2\x80\x89b,\xe2\x80\x89c,\xe2\x80\x89d,\xe2\x80\x89x0,\xe2\x80\x89y0), where 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a,\xe2\x80\x89b,\xe2\x80\x89c,\xe2\x80\x89d, is a cross, and there is a set of cells that are assigned to it. Cell (x,\xe2\x80\x89y) belongs to this set if at least one of two conditions are fulfilled:  |x0\xe2\x80\x89-\xe2\x80\x89x|\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a and |y0\xe2\x80\x89-\xe2\x80\x89y|\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b  |x0\xe2\x80\x89-\xe2\x80\x89x|\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89c and |y0\xe2\x80\x89-\xe2\x80\x89y|\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89d    The picture shows the cross (0,\xe2\x80\x891,\xe2\x80\x891,\xe2\x80\x890,\xe2\x80\x892,\xe2\x80\x893) on the grid 3\xe2\x80\x89\xc3\x97\xe2\x80\x894.  Your task is to find the number of different groups of six numbers, (a,\xe2\x80\x89b,\xe2\x80\x89c,\xe2\x80\x89d,\xe2\x80\x89x0,\xe2\x80\x89y0) that determine the crosses of an area equal to s, which are placed entirely on the grid. The cross is placed entirely on the grid, if any of its cells is in the range of the grid (that is for each cell (x,\xe2\x80\x89y) of the cross 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n;�1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m holds). The area of the cross is the number of cells it has.Note that two crosses are considered distinct if the ordered groups of six numbers that denote them are distinct, even if these crosses coincide as sets of points." 2100

215B "Olympic Medal" greedy,math "The World Programming Olympics Medal is a metal disk, consisting of two parts: the first part is a ring with outer radius of r1 cm, inner radius of r2 cm, (0\xe2\x80\x89<\xe2\x80\x89r2\xe2\x80\x89<\xe2\x80\x89r1) made of metal with density p1 g/cm3. The second part is an inner disk with radius r2 cm, it is made of metal with density p2 g/cm3. The disk is nested inside the ring.The Olympic jury decided that r1 will take one of possible values of x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xn. It is up to jury to decide which particular value r1 will take. Similarly, the Olympic jury decided that p1 will take one of possible value of y1,\xe2\x80\x89y2,\xe2\x80\x89...,\xe2\x80\x89ym, and p2 will take a value from list z1,\xe2\x80\x89z2,\xe2\x80\x89...,\xe2\x80\x89zk.According to most ancient traditions the ratio between the outer ring mass mout and the inner disk mass min must equal , where A,\xe2\x80\x89B are constants taken from ancient books. Now, to start making medals, the jury needs to take values for r1, p1, p2 and calculate the suitable value of r2.The jury wants to choose the value that would maximize radius r2. Help the jury find the sought value of r2. Value r2 doesn\'t have to be an integer.Medal has a uniform thickness throughout the area, the thickness of the inner disk is the same as the thickness of the outer ring." 1300

215A "Bicycle Chain" "brute force,implementation" "Vasya\'s bicycle chain drive consists of two parts: n stars are attached to the pedal axle, m stars are attached to the rear wheel axle. The chain helps to rotate the rear wheel by transmitting the pedal rotation.We know that the i-th star on the pedal axle has ai (0\xe2\x80\x89<\xe2\x80\x89a1\xe2\x80\x89<\xe2\x80\x89a2\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89an) teeth, and the j-th star on the rear wheel axle has bj (0\xe2\x80\x89<\xe2\x80\x89b1\xe2\x80\x89<\xe2\x80\x89b2\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89bm) teeth. Any pair (i,\xe2\x80\x89j) (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n;�1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m) is called a gear and sets the indexes of stars to which the chain is currently attached. Gear (i,\xe2\x80\x89j) has a gear ratio, equal to the value .Since Vasya likes integers, he wants to find such gears (i,\xe2\x80\x89j), that their ratios are integers. On the other hand, Vasya likes fast driving, so among all ""integer"" gears (i,\xe2\x80\x89j) he wants to choose a gear with the maximum ratio. Help him to find the number of such gears.In the problem, fraction  denotes division in real numbers, that is, no rounding is performed." 900

214B Hometask "brute force,constructive algorithms,greedy,math" "Furik loves math lessons very much, so he doesn\'t attend them, unlike Rubik. But now Furik wants to get a good mark for math. For that Ms. Ivanova, his math teacher, gave him a new task. Furik solved the task immediately. Can you?You are given a set of digits, your task is to find the maximum integer that you can make from these digits. The made number must be divisible by 2, 3, 5 without a residue. It is permitted to use not all digits from the set, it is forbidden to use leading zeroes.Each digit is allowed to occur in the number the same number of times it occurs in the set." 1600

214A "System of Equations" "brute force" "Furik loves math lessons very much, so he doesn\'t attend them, unlike Rubik. But now Furik wants to get a good mark for math. For that Ms. Ivanova, his math teacher, gave him a new task. Furik solved the task immediately. Can you?You are given a system of equations:   You should count, how many there are pairs of integers (a,\xe2\x80\x89b) (0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a,\xe2\x80\x89b) which satisfy the system." 800

213E "Two Permutations" "data structures,hashing,strings" "Rubik is very keen on number permutations. A permutation a with length n is a sequence, consisting of n different numbers from 1 to n. Element number i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) of this permutation will be denoted as ai.Furik decided to make a present to Rubik and came up with a new problem on permutations. Furik tells Rubik two number permutations: permutation a with length n and permutation b with length m. Rubik must give an answer to the problem: how many distinct integers d exist, such that sequence c (c1\xe2\x80\x89=\xe2\x80\x89a1\xe2\x80\x89+\xe2\x80\x89d,\xe2\x80\x89c2\xe2\x80\x89=\xe2\x80\x89a2\xe2\x80\x89+\xe2\x80\x89d,\xe2\x80\x89...,\xe2\x80\x89cn\xe2\x80\x89=\xe2\x80\x89an\xe2\x80\x89+\xe2\x80\x89d) of length n is a subsequence of b.Sequence a is a subsequence of sequence b, if there are such indices i1,\xe2\x80\x89i2,\xe2\x80\x89...,\xe2\x80\x89in (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i1\xe2\x80\x89<\xe2\x80\x89i2\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89in\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m), that a1\xe2\x80\x89=\xe2\x80\x89bi1, a2\xe2\x80\x89=\xe2\x80\x89bi2, ..., an\xe2\x80\x89=\xe2\x80\x89bin, where n is the length of sequence a, and m is the length of sequence b. You are given permutations a and b, help Rubik solve the given problem." 2700

213D Stars "constructive algorithms,geometry" "Furik loves painting stars. A star is a shape that results if we take a regular pentagon and paint all diagonals in it.   Recently he decided to teach Rubik to paint stars. After many years of training Rubik could paint stars easily. But now Furik decided to test Rubik and complicated the task. Rubik must paint n stars, observing the following rules:  all stars must be painted in a single move (i.e. it is forbidden to take the pen away from the paper);  it is forbidden to paint the same segment of non-zero length more than once;  the stars can intersect only in their vertexes;  the length of a side of the regular pentagon, in which Rubik paints each star, must equal 10. Help Rubik to cope with this hard task." 2300

213C "Relay Race" dp "Furik and Rubik take part in a relay race. The race will be set up on a large square with the side of n meters. The given square is split into n\xe2\x80\x89\xc3\x97\xe2\x80\x89n cells (represented as unit squares), each cell has some number.At the beginning of the race Furik stands in a cell with coordinates (1,\xe2\x80\x891), and Rubik stands in a cell with coordinates (n,\xe2\x80\x89n). Right after the start Furik runs towards Rubik, besides, if Furik stands at a cell with coordinates (i,\xe2\x80\x89j), then he can move to cell (i\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89j) or (i,\xe2\x80\x89j\xe2\x80\x89+\xe2\x80\x891). After Furik reaches Rubik, Rubik starts running from cell with coordinates (n,\xe2\x80\x89n) to cell with coordinates (1,\xe2\x80\x891). If Rubik stands in cell (i,\xe2\x80\x89j), then he can move to cell (i\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89j) or (i,\xe2\x80\x89j\xe2\x80\x89-\xe2\x80\x891). Neither Furik, nor Rubik are allowed to go beyond the boundaries of the field; if a player goes beyond the boundaries, he will be disqualified. To win the race, Furik and Rubik must earn as many points as possible. The number of points is the sum of numbers from the cells Furik and Rubik visited. Each cell counts only once in the sum.Print the maximum number of points Furik and Rubik can earn on the relay race." 2000

213B Numbers combinatorics,dp "Furik loves writing all sorts of problems, especially such that he can\'t solve himself. You\'ve got one of his problems, the one Furik gave to Rubik. And Rubik asks you to solve it.There is integer n and array a, consisting of ten integers, indexed by numbers from 0 to 9. Your task is to count the number of positive integers with the following properties:  the number\'s length does not exceed n;  the number doesn\'t have leading zeroes;  digit i (0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x899) occurs in the number at least a[i] times." 1900

213A Game "dfs and similar,greedy" "Furik and Rubik love playing computer games. Furik has recently found a new game that greatly interested Rubik. The game consists of n parts and to complete each part a player may probably need to complete some other ones. We know that the game can be fully completed, that is, its parts do not form cyclic dependencies. Rubik has 3 computers, on which he can play this game. All computers are located in different houses. Besides, it has turned out that each part of the game can be completed only on one of these computers. Let\'s number the computers with integers from 1 to 3. Rubik can perform the following actions:   Complete some part of the game on some computer. Rubik spends exactly 1 hour on completing any part on any computer.  Move from the 1-st computer to the 2-nd one. Rubik spends exactly 1 hour on that.  Move from the 1-st computer to the 3-rd one. Rubik spends exactly 2 hours on that.  Move from the 2-nd computer to the 1-st one. Rubik spends exactly 2 hours on that.  Move from the 2-nd computer to the 3-rd one. Rubik spends exactly 1 hour on that.  Move from the 3-rd computer to the 1-st one. Rubik spends exactly 1 hour on that.  Move from the 3-rd computer to the 2-nd one. Rubik spends exactly 2 hours on that. Help Rubik to find the minimum number of hours he will need to complete all parts of the game. Initially Rubik can be located at the computer he considers necessary." 1700

212E "IT Restaurants" "dfs and similar,dp,trees" "\xd0\xa1ity N. has a huge problem with roads, food and IT-infrastructure. In total the city has n junctions, some pairs of them are connected by bidirectional roads. The road network consists of n\xe2\x80\x89-\xe2\x80\x891 roads, you can get from any junction to any other one by these roads. Yes, you\'re right \xe2\x80\x94 the road network forms an undirected tree.Recently, the Mayor came up with a way that eliminates the problems with the food and the IT-infrastructure at the same time! He decided to put at the city junctions restaurants of two well-known cafe networks for IT professionals: ""iMac D0naldz"" and ""Burger Bing"". Since the network owners are not friends, it is strictly prohibited to place two restaurants of different networks on neighboring junctions. There are other requirements. Here\'s the full list:  each junction must have at most one restaurant;  each restaurant belongs either to ""iMac D0naldz"", or to ""Burger Bing"";  each network should build at least one restaurant;  there is no pair of junctions that are connected by a road and contains restaurants of different networks. The Mayor is going to take a large tax from each restaurant, so he is interested in making the total number of the restaurants as large as possible.Help the Mayor to analyze the situation. Find all such pairs of (a,\xe2\x80\x89b) that a restaurants can belong to ""iMac D0naldz"", b restaurants can belong to ""Burger Bing"", and the sum of a\xe2\x80\x89+\xe2\x80\x89b is as large as possible." 1500

212D "Cutting a Fence" "binary search,data structures,dsu" "Vasya the carpenter has an estate that is separated from the wood by a fence. The fence consists of n planks put in a line. The fence is not closed in a circle. The planks are numbered from left to right from 1 to n, the i-th plank is of height ai. All planks have the same width, the lower edge of each plank is located at the ground level.Recently a local newspaper ""Malevich and Life"" wrote that the most fashionable way to decorate a fence in the summer is to draw a fuchsia-colored rectangle on it, the lower side of the rectangle must be located at the lower edge of the fence.Vasya is delighted with this idea! He immediately bought some fuchsia-colored paint and began to decide what kind of the rectangle he should paint. Vasya is sure that the rectangle should cover k consecutive planks. In other words, he will paint planks number x, x\xe2\x80\x89+\xe2\x80\x891, ..., x\xe2\x80\x89+\xe2\x80\x89k\xe2\x80\x89-\xe2\x80\x891 for some x (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x89k\xe2\x80\x89+\xe2\x80\x891). He wants to paint the rectangle of maximal area, so the rectangle height equals min ai for x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89+\xe2\x80\x89k\xe2\x80\x89-\xe2\x80\x891, x is the number of the first colored plank.Vasya has already made up his mind that the rectangle width can be equal to one of numbers of the sequence k1,\xe2\x80\x89k2,\xe2\x80\x89...,\xe2\x80\x89km. For each ki he wants to know the expected height of the painted rectangle, provided that he selects x for such fence uniformly among all n\xe2\x80\x89-\xe2\x80\x89ki\xe2\x80\x89+\xe2\x80\x891 possible values. Help him to find the expected heights." 2500

212C Cowboys combinatorics,dp,math "A very tense moment: n cowboys stand in a circle and each one points his colt at a neighbor. Each cowboy can point the colt to the person who follows or precedes him in clockwise direction. Human life is worthless, just like in any real western.The picture changes each second! Every second the cowboys analyse the situation and, if a pair of cowboys realize that they aim at each other, they turn around. In a second all such pairs of neighboring cowboys aiming at each other turn around. All actions happen instantaneously and simultaneously in a second.We\'ll use character ""A"" to denote a cowboy who aims at his neighbour in the clockwise direction, and character ""B"" for a cowboy who aims at his neighbour in the counter clockwise direction. Then a string of letters ""A"" and ""B"" will denote the circle of cowboys, the record is made from the first of them in a clockwise direction.For example, a circle that looks like ""ABBBABBBA"" after a second transforms into ""BABBBABBA"" and a circle that looks like ""BABBA"" transforms into ""ABABB"".   This picture illustrates how the circle ""BABBA"" transforms into ""ABABB""  A second passed and now the cowboys\' position is described by string s. Your task is to determine the number of possible states that lead to s in a second. Two states are considered distinct if there is a cowboy who aims at his clockwise neighbor in one state and at his counter clockwise neighbor in the other state." 2100

212B "Polycarpus is Looking for Good Substrings" bitmasks,hashing,implementation "We\'ll call string s[a,\xe2\x80\x89b]\xe2\x80\x89=\xe2\x80\x89sasa\xe2\x80\x89+\xe2\x80\x891... sb (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|s|) a substring of string s\xe2\x80\x89=\xe2\x80\x89s1s2... s|s|, where |s| is the length of string s.The trace of a non-empty string t is a set of characters that the string consists of. For example, the trace of string ""aab"" equals {\'a\', \'b\'}.Let\'s consider an arbitrary string s and the set of its substrings with trace equal to C. We will denote the number of substrings from this set that are maximal by inclusion by r(C,\xe2\x80\x89s). Substring s[a,\xe2\x80\x89b] of length n\xe2\x80\x89=\xe2\x80\x89b\xe2\x80\x89-\xe2\x80\x89a\xe2\x80\x89+\xe2\x80\x891 belonging to some set is called maximal by inclusion, if there is no substring s[x,\xe2\x80\x89y] in this set with length greater than n, such that 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|s|. Two substrings of string s are considered different even if they are equal but they are located at different positions of s.Polycarpus got a challenging practical task on a stringology exam. He must do the following: given string s and non-empty sets of characters C1, C2, ..., Cm, find r(Ci,\xe2\x80\x89s) for each set Ci. Help Polycarpus to solve the problem as he really doesn\'t want to be expelled from the university and go to the army!" 2300

212A Privatization flows,graphs "There is a developed network of flights between Berland and Beerland. All of them belong to the Berland state company BerAvia. Each flight connects some Berland city with some Beerland city. For each flight airplanes fly in both directions.Changes are coming to Berland \xe2\x80\x94 the state decided to privatize BerAvia, namely, to sell out all flights to t private companies. Each of these companies wants to get the maximal number of flights, so if the Berland flights are sold unevenly, Berland can be accused of partiality. Berland Government decided to sell the flights as evenly as possible between the t companies.The unevenness of the distribution of flights between companies is calculated as follows. For each city i (both Berland and Beerland) we\'ll calculate the value of  where aij is the number of flights from city i, which belong to company j. The sum of wi for all cities in both countries is called the unevenness of the distribution. The distribution with the minimal unevenness is the most even one.Help the Berland government come up with the most even distribution plan of selling flights." 3000

209C "Trails and Glades" "constructive algorithms,dsu,graphs,greedy" "Vasya went for a walk in the park. The park has n glades, numbered from 1 to n. There are m trails between the glades. The trails are numbered from 1 to m, where the i-th trail connects glades xi and yi. The numbers of the connected glades may be the same (xi\xe2\x80\x89=\xe2\x80\x89yi), which means that a trail connects a glade to itself. Also, two glades may have several non-intersecting trails between them.Vasya is on glade 1, he wants to walk on all trails of the park exactly once, so that he can eventually return to glade 1. Unfortunately, Vasya does not know whether this walk is possible or not. Help Vasya, determine whether the walk is possible or not. If such walk is impossible, find the minimum number of trails the authorities need to add to the park in order to make the described walk possible.Vasya can shift from one trail to another one only on glades. He can move on the trails in both directions. If Vasya started going on the trail that connects glades a and b, from glade a, then he must finish this trail on glade b." 2400

209B Pixels "constructive algorithms,math" "Flatland is inhabited by pixels of three colors: red, green and blue. We know that if two pixels of different colors meet in a violent fight, only one of them survives the fight (that is, the total number of pixels decreases by one). Besides, if pixels of colors x and y (x\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89y) meet in a violent fight, then the pixel that survives the fight immediately changes its color to z (z\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89x;�z\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89y). Pixels of the same color are friends, so they don\'t fight.The King of Flatland knows that his land will be peaceful and prosperous when the pixels are of the same color. For each of the three colors you know the number of pixels of this color that inhabit Flatland. Help the king and determine whether fights can bring peace and prosperity to the country and if it is possible, find the minimum number of fights needed to make the land peaceful and prosperous." 2100

209A "Multicolored Marbles" dp,math "Polycarpus plays with red and blue marbles. He put n marbles from the left to the right in a row. As it turned out, the marbles form a zebroid.A non-empty sequence of red and blue marbles is a zebroid, if the colors of the marbles in this sequence alternate. For example, sequences (red; blue; red) and (blue) are zebroids and sequence (red; red) is not a zebroid.Now Polycarpus wonders, how many ways there are to pick a zebroid subsequence from this sequence. Help him solve the problem, find the number of ways modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." 1600

208E "Blood Cousins" "binary search,data structures,dfs and similar,trees" "Polycarpus got hold of a family relationship tree. The tree describes family relationships of n people, numbered 1 through n. Each person in the tree has no more than one parent.Let\'s call person a a 1-ancestor of person b, if a is the parent of b.Let\'s call person a a k-ancestor (k\xe2\x80\x89>\xe2\x80\x891) of person b, if person b has a 1-ancestor, and a is a (k\xe2\x80\x89-\xe2\x80\x891)-ancestor of b\'s 1-ancestor. Family relationships don\'t form cycles in the found tree. In other words, there is no person who is his own ancestor, directly or indirectly (that is, who is an x-ancestor for himself, for some x, x\xe2\x80\x89>\xe2\x80\x890).Let\'s call two people x and y (x\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89y) p-th cousins (p\xe2\x80\x89>\xe2\x80\x890), if there is person z, who is a p-ancestor of x and a p-ancestor of y.Polycarpus wonders how many counsins and what kinds of them everybody has. He took a piece of paper and wrote m pairs of integers vi, pi. Help him to calculate the number of pi-th cousins that person vi has, for each pair vi, pi." 2100

208D "Prizes, Prizes, more Prizes" implementation "Vasya, like many others, likes to participate in a variety of sweepstakes and lotteries. Now he collects wrappings from a famous chocolate bar ""Jupiter"". According to the sweepstake rules, each wrapping has an integer written on it \xe2\x80\x94 the number of points that the participant adds to his score as he buys the bar. After a participant earns a certain number of points, he can come to the prize distribution center and exchange the points for prizes. When somebody takes a prize, the prize\'s cost is simply subtracted from the number of his points.Vasya didn\'t only bought the bars, he also kept a record of how many points each wrapping cost. Also, he remembers that he always stucks to the greedy strategy \xe2\x80\x94 as soon as he could take at least one prize, he went to the prize distribution centre and exchanged the points for prizes. Moreover, if he could choose between multiple prizes, he chose the most expensive one. If after an exchange Vasya had enough points left to get at least one more prize, then he continued to exchange points.The sweepstake has the following prizes (the prizes are sorted by increasing of their cost):   a mug (costs a points),  a towel (costs b points),  a bag (costs c points),  a bicycle (costs d points),  a car (costs e points). Now Vasya wants to recollect what prizes he has received. You know sequence p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pn, where pi is the number of points Vasya got for the i-th bar. The sequence of points is given in the chronological order. You also know numbers a, b, c, d, e. Your task is to find, how many prizes Vasya received, what prizes they are and how many points he\'s got left after all operations are completed." 1200

208C "Police Station" "dp,graphs,shortest paths" "The Berland road network consists of n cities and of m bidirectional roads. The cities are numbered from 1 to n, where the main capital city has number n, and the culture capital \xe2\x80\x94 number 1. The road network is set up so that it is possible to reach any city from any other one by the roads. Moving on each road in any direction takes the same time.All residents of Berland are very lazy people, and so when they want to get from city v to city u, they always choose one of the shortest paths (no matter which one).The Berland government wants to make this country\'s road network safer. For that, it is going to put a police station in one city. The police station has a rather strange property: when a citizen of Berland is driving along the road with a police station at one end of it, the citizen drives more carefully, so all such roads are considered safe. The roads, both ends of which differ from the city with the police station, are dangerous.Now the government wonders where to put the police station so that the average number of safe roads for all the shortest paths from the cultural capital to the main capital would take the maximum value." 1900

208B Solitaire "dfs and similar,dp" "A boy named Vasya wants to play an old Russian solitaire called ""Accordion"". In this solitaire, the player must observe the following rules:  A deck of n cards is carefully shuffled, then all n cards are put on the table in a line from left to right;  Before each move the table has several piles of cards lying in a line (initially there are n piles, each pile has one card). Let\'s number the piles from left to right, from 1 to x. During one move, a player can take the whole pile with the maximum number x (that is the rightmost of remaining) and put it on the top of pile x\xe2\x80\x89-\xe2\x80\x891 (if it exists) or on the top of pile x\xe2\x80\x89-\xe2\x80\x893 (if it exists). The player can put one pile on top of another one only if the piles\' top cards have the same suits or values. Please note that if pile x goes on top of pile y, then the top card of pile x becomes the top card of the resulting pile. Also note that each move decreases the total number of piles by 1;  The solitaire is considered completed if all cards are in the same pile. Vasya has already shuffled the cards and put them on the table, help him understand whether completing this solitaire is possible or not." 1900

208A Dubstep strings "Vasya works as a DJ in the best Berland nightclub, and he often uses dubstep music in his performance. Recently, he has decided to take a couple of old songs and make dubstep remixes from them.Let\'s assume that a song consists of some number of words. To make the dubstep remix of this song, Vasya inserts a certain number of words ""WUB"" before the first word of the song (the number may be zero), after the last word (the number may be zero), and between words (at least one between any pair of neighbouring words), and then the boy glues together all the words, including ""WUB"", in one string and plays the song at the club.For example, a song with words ""I AM X"" can transform into a dubstep remix as ""WUBWUBIWUBAMWUBWUBX"" and cannot transform into ""WUBWUBIAMWUBX"".Recently, Petya has heard Vasya\'s new dubstep track, but since he isn\'t into modern music, he decided to find out what was the initial song that Vasya remixed. Help Petya restore the original song." 900

207D9 "The Beaver\'s Problem - 3" NA "Vasya works as a DJ in the best Berland nightclub, and he often uses dubstep music in his performance. Recently, he has decided to take a couple of old songs and make dubstep remixes from them.Let\'s assume that a song consists of some number of words. To make the dubstep remix of this song, Vasya inserts a certain number of words ""WUB"" before the first word of the song (the number may be zero), after the last word (the number may be zero), and between words (at least one between any pair of neighbouring words), and then the boy glues together all the words, including ""WUB"", in one string and plays the song at the club.For example, a song with words ""I AM X"" can transform into a dubstep remix as ""WUBWUBIWUBAMWUBWUBX"" and cannot transform into ""WUBWUBIAMWUBX"".Recently, Petya has heard Vasya\'s new dubstep track, but since he isn\'t into modern music, he decided to find out what was the initial song that Vasya remixed. Help Petya restore the original song." 1800

207D8 "The Beaver\'s Problem - 3" NA "Vasya works as a DJ in the best Berland nightclub, and he often uses dubstep music in his performance. Recently, he has decided to take a couple of old songs and make dubstep remixes from them.Let\'s assume that a song consists of some number of words. To make the dubstep remix of this song, Vasya inserts a certain number of words ""WUB"" before the first word of the song (the number may be zero), after the last word (the number may be zero), and between words (at least one between any pair of neighbouring words), and then the boy glues together all the words, including ""WUB"", in one string and plays the song at the club.For example, a song with words ""I AM X"" can transform into a dubstep remix as ""WUBWUBIWUBAMWUBWUBX"" and cannot transform into ""WUBWUBIAMWUBX"".Recently, Petya has heard Vasya\'s new dubstep track, but since he isn\'t into modern music, he decided to find out what was the initial song that Vasya remixed. Help Petya restore the original song." 2300

207D7 "The Beaver\'s Problem - 3" NA "Vasya works as a DJ in the best Berland nightclub, and he often uses dubstep music in his performance. Recently, he has decided to take a couple of old songs and make dubstep remixes from them.Let\'s assume that a song consists of some number of words. To make the dubstep remix of this song, Vasya inserts a certain number of words ""WUB"" before the first word of the song (the number may be zero), after the last word (the number may be zero), and between words (at least one between any pair of neighbouring words), and then the boy glues together all the words, including ""WUB"", in one string and plays the song at the club.For example, a song with words ""I AM X"" can transform into a dubstep remix as ""WUBWUBIWUBAMWUBWUBX"" and cannot transform into ""WUBWUBIAMWUBX"".Recently, Petya has heard Vasya\'s new dubstep track, but since he isn\'t into modern music, he decided to find out what was the initial song that Vasya remixed. Help Petya restore the original song." 1600

207D6 "The Beaver\'s Problem - 3" NA "Vasya works as a DJ in the best Berland nightclub, and he often uses dubstep music in his performance. Recently, he has decided to take a couple of old songs and make dubstep remixes from them.Let\'s assume that a song consists of some number of words. To make the dubstep remix of this song, Vasya inserts a certain number of words ""WUB"" before the first word of the song (the number may be zero), after the last word (the number may be zero), and between words (at least one between any pair of neighbouring words), and then the boy glues together all the words, including ""WUB"", in one string and plays the song at the club.For example, a song with words ""I AM X"" can transform into a dubstep remix as ""WUBWUBIWUBAMWUBWUBX"" and cannot transform into ""WUBWUBIAMWUBX"".Recently, Petya has heard Vasya\'s new dubstep track, but since he isn\'t into modern music, he decided to find out what was the initial song that Vasya remixed. Help Petya restore the original song." 2100

207D5 "The Beaver\'s Problem - 3" NA "Vasya works as a DJ in the best Berland nightclub, and he often uses dubstep music in his performance. Recently, he has decided to take a couple of old songs and make dubstep remixes from them.Let\'s assume that a song consists of some number of words. To make the dubstep remix of this song, Vasya inserts a certain number of words ""WUB"" before the first word of the song (the number may be zero), after the last word (the number may be zero), and between words (at least one between any pair of neighbouring words), and then the boy glues together all the words, including ""WUB"", in one string and plays the song at the club.For example, a song with words ""I AM X"" can transform into a dubstep remix as ""WUBWUBIWUBAMWUBWUBX"" and cannot transform into ""WUBWUBIAMWUBX"".Recently, Petya has heard Vasya\'s new dubstep track, but since he isn\'t into modern music, he decided to find out what was the initial song that Vasya remixed. Help Petya restore the original song." 1600

207D4 "The Beaver\'s Problem - 3" NA "Vasya works as a DJ in the best Berland nightclub, and he often uses dubstep music in his performance. Recently, he has decided to take a couple of old songs and make dubstep remixes from them.Let\'s assume that a song consists of some number of words. To make the dubstep remix of this song, Vasya inserts a certain number of words ""WUB"" before the first word of the song (the number may be zero), after the last word (the number may be zero), and between words (at least one between any pair of neighbouring words), and then the boy glues together all the words, including ""WUB"", in one string and plays the song at the club.For example, a song with words ""I AM X"" can transform into a dubstep remix as ""WUBWUBIWUBAMWUBWUBX"" and cannot transform into ""WUBWUBIAMWUBX"".Recently, Petya has heard Vasya\'s new dubstep track, but since he isn\'t into modern music, he decided to find out what was the initial song that Vasya remixed. Help Petya restore the original song." 2100

207D3 "The Beaver\'s Problem - 3" NA "Vasya works as a DJ in the best Berland nightclub, and he often uses dubstep music in his performance. Recently, he has decided to take a couple of old songs and make dubstep remixes from them.Let\'s assume that a song consists of some number of words. To make the dubstep remix of this song, Vasya inserts a certain number of words ""WUB"" before the first word of the song (the number may be zero), after the last word (the number may be zero), and between words (at least one between any pair of neighbouring words), and then the boy glues together all the words, including ""WUB"", in one string and plays the song at the club.For example, a song with words ""I AM X"" can transform into a dubstep remix as ""WUBWUBIWUBAMWUBWUBX"" and cannot transform into ""WUBWUBIAMWUBX"".Recently, Petya has heard Vasya\'s new dubstep track, but since he isn\'t into modern music, he decided to find out what was the initial song that Vasya remixed. Help Petya restore the original song." 2000

207D2 "The Beaver\'s Problem - 3" NA "Vasya works as a DJ in the best Berland nightclub, and he often uses dubstep music in his performance. Recently, he has decided to take a couple of old songs and make dubstep remixes from them.Let\'s assume that a song consists of some number of words. To make the dubstep remix of this song, Vasya inserts a certain number of words ""WUB"" before the first word of the song (the number may be zero), after the last word (the number may be zero), and between words (at least one between any pair of neighbouring words), and then the boy glues together all the words, including ""WUB"", in one string and plays the song at the club.For example, a song with words ""I AM X"" can transform into a dubstep remix as ""WUBWUBIWUBAMWUBWUBX"" and cannot transform into ""WUBWUBIAMWUBX"".Recently, Petya has heard Vasya\'s new dubstep track, but since he isn\'t into modern music, he decided to find out what was the initial song that Vasya remixed. Help Petya restore the original song." 2000

207D10 "The Beaver\'s Problem - 3" NA "Vasya works as a DJ in the best Berland nightclub, and he often uses dubstep music in his performance. Recently, he has decided to take a couple of old songs and make dubstep remixes from them.Let\'s assume that a song consists of some number of words. To make the dubstep remix of this song, Vasya inserts a certain number of words ""WUB"" before the first word of the song (the number may be zero), after the last word (the number may be zero), and between words (at least one between any pair of neighbouring words), and then the boy glues together all the words, including ""WUB"", in one string and plays the song at the club.For example, a song with words ""I AM X"" can transform into a dubstep remix as ""WUBWUBIWUBAMWUBWUBX"" and cannot transform into ""WUBWUBIAMWUBX"".Recently, Petya has heard Vasya\'s new dubstep track, but since he isn\'t into modern music, he decided to find out what was the initial song that Vasya remixed. Help Petya restore the original song." 2100

207D1 "The Beaver\'s Problem - 3" NA "Vasya works as a DJ in the best Berland nightclub, and he often uses dubstep music in his performance. Recently, he has decided to take a couple of old songs and make dubstep remixes from them.Let\'s assume that a song consists of some number of words. To make the dubstep remix of this song, Vasya inserts a certain number of words ""WUB"" before the first word of the song (the number may be zero), after the last word (the number may be zero), and between words (at least one between any pair of neighbouring words), and then the boy glues together all the words, including ""WUB"", in one string and plays the song at the club.For example, a song with words ""I AM X"" can transform into a dubstep remix as ""WUBWUBIWUBAMWUBWUBX"" and cannot transform into ""WUBWUBIAMWUBX"".Recently, Petya has heard Vasya\'s new dubstep track, but since he isn\'t into modern music, he decided to find out what was the initial song that Vasya remixed. Help Petya restore the original song." 1800

207C3 "Game with Two Trees" "data structures" "The Smart Beaver from ABBYY has come up with a new developing game for children. The Beaver thinks that this game will help children to understand programming better.The main object of the game is finite rooted trees, each of their edges contains some lowercase English letter. Vertices on any tree are always numbered sequentially from 1 to m, where m is the number of vertices in the tree. Before describing the actual game, let\'s introduce some definitions.We\'ll assume that the sequence of vertices with numbers v1, v2, ..., vk (k\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x891) is a forward path, if for any integer i from 1 to k\xe2\x80\x89-\xe2\x80\x891 vertex vi is a direct ancestor of vertex vi\xe2\x80\x89+\xe2\x80\x891. If we sequentially write out all letters from the the edges of the given path from v1 to vk, we get some string (k\xe2\x80\x89=\xe2\x80\x891 gives us an empty string). We\'ll say that such string corresponds to forward path v1, v2, ..., vk.We\'ll assume that the sequence of tree vertices with numbers v1, v2, ..., vk (k\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x891) is a backward path if for any integer i from 1 to k\xe2\x80\x89-\xe2\x80\x891 vertex vi is the direct descendant of vertex vi\xe2\x80\x89+\xe2\x80\x891. If we sequentially write out all the letters from the edges of the given path from v1 to vk, we get some string (k\xe2\x80\x89=\xe2\x80\x891 gives us an empty string). We\'ll say that such string corresponds to backward path v1, v2, ..., vk.Now let\'s describe the game that the Smart Beaver from ABBYY has come up with. The game uses two rooted trees, each of which initially consists of one vertex with number 1. The player is given some sequence of operations. Each operation is characterized by three values (t, v, c) where:   t is the number of the tree on which the operation is executed (1 or 2);  v is the vertex index in this tree (it is guaranteed that the tree contains a vertex with this index);  c is a lowercase English letter. The actual operation is as follows: vertex v of tree t gets a new descendant with number m\xe2\x80\x89+\xe2\x80\x891 (where m is the current number of vertices in tree t), and there should be letter c put on the new edge from vertex v to vertex m\xe2\x80\x89+\xe2\x80\x891.We\'ll say that an ordered group of three integers (i, j, q) is a good combination if:   1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m1, where m1 is the number of vertices in the first tree;  1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j,\xe2\x80\x89q\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m2, where m2 is the number of vertices in the second tree;  there exists a forward path v1, v2, ..., vk such that v1\xe2\x80\x89=\xe2\x80\x89j and vk\xe2\x80\x89=\xe2\x80\x89q in the second tree;  the string that corresponds to the forward path in the second tree from vertex j to vertex q equals the string that corresponds to the backward path in the first tree from vertex i to vertex 1 (note that both paths are determined uniquely). Your task is to calculate the number of existing good combinations after each operation on the trees." 2700

207C2 "Game with Two Trees" NA "The Smart Beaver from ABBYY has come up with a new developing game for children. The Beaver thinks that this game will help children to understand programming better.The main object of the game is finite rooted trees, each of their edges contains some lowercase English letter. Vertices on any tree are always numbered sequentially from 1 to m, where m is the number of vertices in the tree. Before describing the actual game, let\'s introduce some definitions.We\'ll assume that the sequence of vertices with numbers v1, v2, ..., vk (k\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x891) is a forward path, if for any integer i from 1 to k\xe2\x80\x89-\xe2\x80\x891 vertex vi is a direct ancestor of vertex vi\xe2\x80\x89+\xe2\x80\x891. If we sequentially write out all letters from the the edges of the given path from v1 to vk, we get some string (k\xe2\x80\x89=\xe2\x80\x891 gives us an empty string). We\'ll say that such string corresponds to forward path v1, v2, ..., vk.We\'ll assume that the sequence of tree vertices with numbers v1, v2, ..., vk (k\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x891) is a backward path if for any integer i from 1 to k\xe2\x80\x89-\xe2\x80\x891 vertex vi is the direct descendant of vertex vi\xe2\x80\x89+\xe2\x80\x891. If we sequentially write out all the letters from the edges of the given path from v1 to vk, we get some string (k\xe2\x80\x89=\xe2\x80\x891 gives us an empty string). We\'ll say that such string corresponds to backward path v1, v2, ..., vk.Now let\'s describe the game that the Smart Beaver from ABBYY has come up with. The game uses two rooted trees, each of which initially consists of one vertex with number 1. The player is given some sequence of operations. Each operation is characterized by three values (t, v, c) where:   t is the number of the tree on which the operation is executed (1 or 2);  v is the vertex index in this tree (it is guaranteed that the tree contains a vertex with this index);  c is a lowercase English letter. The actual operation is as follows: vertex v of tree t gets a new descendant with number m\xe2\x80\x89+\xe2\x80\x891 (where m is the current number of vertices in tree t), and there should be letter c put on the new edge from vertex v to vertex m\xe2\x80\x89+\xe2\x80\x891.We\'ll say that an ordered group of three integers (i, j, q) is a good combination if:   1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m1, where m1 is the number of vertices in the first tree;  1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j,\xe2\x80\x89q\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m2, where m2 is the number of vertices in the second tree;  there exists a forward path v1, v2, ..., vk such that v1\xe2\x80\x89=\xe2\x80\x89j and vk\xe2\x80\x89=\xe2\x80\x89q in the second tree;  the string that corresponds to the forward path in the second tree from vertex j to vertex q equals the string that corresponds to the backward path in the first tree from vertex i to vertex 1 (note that both paths are determined uniquely). Your task is to calculate the number of existing good combinations after each operation on the trees." 2200

207C1 "Game with Two Trees" NA "The Smart Beaver from ABBYY has come up with a new developing game for children. The Beaver thinks that this game will help children to understand programming better.The main object of the game is finite rooted trees, each of their edges contains some lowercase English letter. Vertices on any tree are always numbered sequentially from 1 to m, where m is the number of vertices in the tree. Before describing the actual game, let\'s introduce some definitions.We\'ll assume that the sequence of vertices with numbers v1, v2, ..., vk (k\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x891) is a forward path, if for any integer i from 1 to k\xe2\x80\x89-\xe2\x80\x891 vertex vi is a direct ancestor of vertex vi\xe2\x80\x89+\xe2\x80\x891. If we sequentially write out all letters from the the edges of the given path from v1 to vk, we get some string (k\xe2\x80\x89=\xe2\x80\x891 gives us an empty string). We\'ll say that such string corresponds to forward path v1, v2, ..., vk.We\'ll assume that the sequence of tree vertices with numbers v1, v2, ..., vk (k\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x891) is a backward path if for any integer i from 1 to k\xe2\x80\x89-\xe2\x80\x891 vertex vi is the direct descendant of vertex vi\xe2\x80\x89+\xe2\x80\x891. If we sequentially write out all the letters from the edges of the given path from v1 to vk, we get some string (k\xe2\x80\x89=\xe2\x80\x891 gives us an empty string). We\'ll say that such string corresponds to backward path v1, v2, ..., vk.Now let\'s describe the game that the Smart Beaver from ABBYY has come up with. The game uses two rooted trees, each of which initially consists of one vertex with number 1. The player is given some sequence of operations. Each operation is characterized by three values (t, v, c) where:   t is the number of the tree on which the operation is executed (1 or 2);  v is the vertex index in this tree (it is guaranteed that the tree contains a vertex with this index);  c is a lowercase English letter. The actual operation is as follows: vertex v of tree t gets a new descendant with number m\xe2\x80\x89+\xe2\x80\x891 (where m is the current number of vertices in tree t), and there should be letter c put on the new edge from vertex v to vertex m\xe2\x80\x89+\xe2\x80\x891.We\'ll say that an ordered group of three integers (i, j, q) is a good combination if:   1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m1, where m1 is the number of vertices in the first tree;  1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j,\xe2\x80\x89q\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m2, where m2 is the number of vertices in the second tree;  there exists a forward path v1, v2, ..., vk such that v1\xe2\x80\x89=\xe2\x80\x89j and vk\xe2\x80\x89=\xe2\x80\x89q in the second tree;  the string that corresponds to the forward path in the second tree from vertex j to vertex q equals the string that corresponds to the backward path in the first tree from vertex i to vertex 1 (note that both paths are determined uniquely). Your task is to calculate the number of existing good combinations after each operation on the trees." 2100

207B3 "Military Trainings" NA "The Smart Beaver from ABBYY started cooperating with the Ministry of Defence. Now they train soldiers to move armoured columns. The training involves testing a new type of tanks that can transmit information. To test the new type of tanks, the training has a special exercise, its essence is as follows.Initially, the column consists of n tanks sequentially numbered from 1 to n in the order of position in the column from its beginning to its end. During the whole exercise, exactly n messages must be transferred from the beginning of the column to its end.Transferring one message is as follows. The tank that goes first in the column transmits the message to some tank in the column. The tank which received the message sends it further down the column. The process is continued until the last tank receives the message. It is possible that not all tanks in the column will receive the message \xe2\x80\x94 it is important that the last tank in the column should receive the message.After the last tank (tank number n) receives the message, it moves to the beginning of the column and sends another message to the end of the column in the same manner. When the message reaches the last tank (tank number n\xe2\x80\x89-\xe2\x80\x891), that tank moves to the beginning of the column and sends the next message to the end of the column, and so on. Thus, the exercise is completed when the tanks in the column return to their original order, that is, immediately after tank number 1 moves to the beginning of the column.If the tanks were initially placed in the column in the order 1,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89n, then after the first message their order changes to n,\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x891, after the second message it changes to n\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89n,\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x892, and so on.The tanks are constructed in a very peculiar way. The tank with number i is characterized by one integer ai, which is called the message receiving radius of this tank.Transferring a message between two tanks takes one second, however, not always one tank can transmit a message to another one. Let\'s consider two tanks in the column such that the first of them is the i-th in the column counting from the beginning, and the second one is the j-th in the column, and suppose the second tank has number x. Then the first tank can transmit a message to the second tank if i\xe2\x80\x89<\xe2\x80\x89j and i\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89j\xe2\x80\x89-\xe2\x80\x89ax.The Ministry of Defense (and soon the Smart Beaver) faced the question of how to organize the training efficiently. The exercise should be finished as quickly as possible. We\'ll neglect the time that the tanks spend on moving along the column, since improving the tanks\' speed is not a priority for this training.You are given the number of tanks, as well as the message receiving radii of all tanks. You must help the Smart Beaver and organize the transferring of messages in a way that makes the total transmission time of all messages as small as possible." 1700

207B2 "Military Trainings" NA "The Smart Beaver from ABBYY started cooperating with the Ministry of Defence. Now they train soldiers to move armoured columns. The training involves testing a new type of tanks that can transmit information. To test the new type of tanks, the training has a special exercise, its essence is as follows.Initially, the column consists of n tanks sequentially numbered from 1 to n in the order of position in the column from its beginning to its end. During the whole exercise, exactly n messages must be transferred from the beginning of the column to its end.Transferring one message is as follows. The tank that goes first in the column transmits the message to some tank in the column. The tank which received the message sends it further down the column. The process is continued until the last tank receives the message. It is possible that not all tanks in the column will receive the message \xe2\x80\x94 it is important that the last tank in the column should receive the message.After the last tank (tank number n) receives the message, it moves to the beginning of the column and sends another message to the end of the column in the same manner. When the message reaches the last tank (tank number n\xe2\x80\x89-\xe2\x80\x891), that tank moves to the beginning of the column and sends the next message to the end of the column, and so on. Thus, the exercise is completed when the tanks in the column return to their original order, that is, immediately after tank number 1 moves to the beginning of the column.If the tanks were initially placed in the column in the order 1,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89n, then after the first message their order changes to n,\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x891, after the second message it changes to n\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89n,\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x892, and so on.The tanks are constructed in a very peculiar way. The tank with number i is characterized by one integer ai, which is called the message receiving radius of this tank.Transferring a message between two tanks takes one second, however, not always one tank can transmit a message to another one. Let\'s consider two tanks in the column such that the first of them is the i-th in the column counting from the beginning, and the second one is the j-th in the column, and suppose the second tank has number x. Then the first tank can transmit a message to the second tank if i\xe2\x80\x89<\xe2\x80\x89j and i\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89j\xe2\x80\x89-\xe2\x80\x89ax.The Ministry of Defense (and soon the Smart Beaver) faced the question of how to organize the training efficiently. The exercise should be finished as quickly as possible. We\'ll neglect the time that the tanks spend on moving along the column, since improving the tanks\' speed is not a priority for this training.You are given the number of tanks, as well as the message receiving radii of all tanks. You must help the Smart Beaver and organize the transferring of messages in a way that makes the total transmission time of all messages as small as possible." 1900

207B1 "Military Trainings" NA "The Smart Beaver from ABBYY started cooperating with the Ministry of Defence. Now they train soldiers to move armoured columns. The training involves testing a new type of tanks that can transmit information. To test the new type of tanks, the training has a special exercise, its essence is as follows.Initially, the column consists of n tanks sequentially numbered from 1 to n in the order of position in the column from its beginning to its end. During the whole exercise, exactly n messages must be transferred from the beginning of the column to its end.Transferring one message is as follows. The tank that goes first in the column transmits the message to some tank in the column. The tank which received the message sends it further down the column. The process is continued until the last tank receives the message. It is possible that not all tanks in the column will receive the message \xe2\x80\x94 it is important that the last tank in the column should receive the message.After the last tank (tank number n) receives the message, it moves to the beginning of the column and sends another message to the end of the column in the same manner. When the message reaches the last tank (tank number n\xe2\x80\x89-\xe2\x80\x891), that tank moves to the beginning of the column and sends the next message to the end of the column, and so on. Thus, the exercise is completed when the tanks in the column return to their original order, that is, immediately after tank number 1 moves to the beginning of the column.If the tanks were initially placed in the column in the order 1,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89n, then after the first message their order changes to n,\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x891, after the second message it changes to n\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89n,\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x892, and so on.The tanks are constructed in a very peculiar way. The tank with number i is characterized by one integer ai, which is called the message receiving radius of this tank.Transferring a message between two tanks takes one second, however, not always one tank can transmit a message to another one. Let\'s consider two tanks in the column such that the first of them is the i-th in the column counting from the beginning, and the second one is the j-th in the column, and suppose the second tank has number x. Then the first tank can transmit a message to the second tank if i\xe2\x80\x89<\xe2\x80\x89j and i\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89j\xe2\x80\x89-\xe2\x80\x89ax.The Ministry of Defense (and soon the Smart Beaver) faced the question of how to organize the training efficiently. The exercise should be finished as quickly as possible. We\'ll neglect the time that the tanks spend on moving along the column, since improving the tanks\' speed is not a priority for this training.You are given the number of tanks, as well as the message receiving radii of all tanks. You must help the Smart Beaver and organize the transferring of messages in a way that makes the total transmission time of all messages as small as possible." 1600

207A3 "Beaver\'s Calculator 1.0" greedy "The Smart Beaver from ABBYY started cooperating with the Ministry of Defence. Now they train soldiers to move armoured columns. The training involves testing a new type of tanks that can transmit information. To test the new type of tanks, the training has a special exercise, its essence is as follows.Initially, the column consists of n tanks sequentially numbered from 1 to n in the order of position in the column from its beginning to its end. During the whole exercise, exactly n messages must be transferred from the beginning of the column to its end.Transferring one message is as follows. The tank that goes first in the column transmits the message to some tank in the column. The tank which received the message sends it further down the column. The process is continued until the last tank receives the message. It is possible that not all tanks in the column will receive the message \xe2\x80\x94 it is important that the last tank in the column should receive the message.After the last tank (tank number n) receives the message, it moves to the beginning of the column and sends another message to the end of the column in the same manner. When the message reaches the last tank (tank number n\xe2\x80\x89-\xe2\x80\x891), that tank moves to the beginning of the column and sends the next message to the end of the column, and so on. Thus, the exercise is completed when the tanks in the column return to their original order, that is, immediately after tank number 1 moves to the beginning of the column.If the tanks were initially placed in the column in the order 1,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89n, then after the first message their order changes to n,\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x891, after the second message it changes to n\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89n,\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x892, and so on.The tanks are constructed in a very peculiar way. The tank with number i is characterized by one integer ai, which is called the message receiving radius of this tank.Transferring a message between two tanks takes one second, however, not always one tank can transmit a message to another one. Let\'s consider two tanks in the column such that the first of them is the i-th in the column counting from the beginning, and the second one is the j-th in the column, and suppose the second tank has number x. Then the first tank can transmit a message to the second tank if i\xe2\x80\x89<\xe2\x80\x89j and i\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89j\xe2\x80\x89-\xe2\x80\x89ax.The Ministry of Defense (and soon the Smart Beaver) faced the question of how to organize the training efficiently. The exercise should be finished as quickly as possible. We\'ll neglect the time that the tanks spend on moving along the column, since improving the tanks\' speed is not a priority for this training.You are given the number of tanks, as well as the message receiving radii of all tanks. You must help the Smart Beaver and organize the transferring of messages in a way that makes the total transmission time of all messages as small as possible." 2000

207A2 "Beaver\'s Calculator 1.0" greedy "The Smart Beaver from ABBYY started cooperating with the Ministry of Defence. Now they train soldiers to move armoured columns. The training involves testing a new type of tanks that can transmit information. To test the new type of tanks, the training has a special exercise, its essence is as follows.Initially, the column consists of n tanks sequentially numbered from 1 to n in the order of position in the column from its beginning to its end. During the whole exercise, exactly n messages must be transferred from the beginning of the column to its end.Transferring one message is as follows. The tank that goes first in the column transmits the message to some tank in the column. The tank which received the message sends it further down the column. The process is continued until the last tank receives the message. It is possible that not all tanks in the column will receive the message \xe2\x80\x94 it is important that the last tank in the column should receive the message.After the last tank (tank number n) receives the message, it moves to the beginning of the column and sends another message to the end of the column in the same manner. When the message reaches the last tank (tank number n\xe2\x80\x89-\xe2\x80\x891), that tank moves to the beginning of the column and sends the next message to the end of the column, and so on. Thus, the exercise is completed when the tanks in the column return to their original order, that is, immediately after tank number 1 moves to the beginning of the column.If the tanks were initially placed in the column in the order 1,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89n, then after the first message their order changes to n,\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x891, after the second message it changes to n\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89n,\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x892, and so on.The tanks are constructed in a very peculiar way. The tank with number i is characterized by one integer ai, which is called the message receiving radius of this tank.Transferring a message between two tanks takes one second, however, not always one tank can transmit a message to another one. Let\'s consider two tanks in the column such that the first of them is the i-th in the column counting from the beginning, and the second one is the j-th in the column, and suppose the second tank has number x. Then the first tank can transmit a message to the second tank if i\xe2\x80\x89<\xe2\x80\x89j and i\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89j\xe2\x80\x89-\xe2\x80\x89ax.The Ministry of Defense (and soon the Smart Beaver) faced the question of how to organize the training efficiently. The exercise should be finished as quickly as possible. We\'ll neglect the time that the tanks spend on moving along the column, since improving the tanks\' speed is not a priority for this training.You are given the number of tanks, as well as the message receiving radii of all tanks. You must help the Smart Beaver and organize the transferring of messages in a way that makes the total transmission time of all messages as small as possible." 1800

207A1 "Beaver\'s Calculator 1.0" greedy "The Smart Beaver from ABBYY started cooperating with the Ministry of Defence. Now they train soldiers to move armoured columns. The training involves testing a new type of tanks that can transmit information. To test the new type of tanks, the training has a special exercise, its essence is as follows.Initially, the column consists of n tanks sequentially numbered from 1 to n in the order of position in the column from its beginning to its end. During the whole exercise, exactly n messages must be transferred from the beginning of the column to its end.Transferring one message is as follows. The tank that goes first in the column transmits the message to some tank in the column. The tank which received the message sends it further down the column. The process is continued until the last tank receives the message. It is possible that not all tanks in the column will receive the message \xe2\x80\x94 it is important that the last tank in the column should receive the message.After the last tank (tank number n) receives the message, it moves to the beginning of the column and sends another message to the end of the column in the same manner. When the message reaches the last tank (tank number n\xe2\x80\x89-\xe2\x80\x891), that tank moves to the beginning of the column and sends the next message to the end of the column, and so on. Thus, the exercise is completed when the tanks in the column return to their original order, that is, immediately after tank number 1 moves to the beginning of the column.If the tanks were initially placed in the column in the order 1,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89n, then after the first message their order changes to n,\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x891, after the second message it changes to n\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89n,\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x892, and so on.The tanks are constructed in a very peculiar way. The tank with number i is characterized by one integer ai, which is called the message receiving radius of this tank.Transferring a message between two tanks takes one second, however, not always one tank can transmit a message to another one. Let\'s consider two tanks in the column such that the first of them is the i-th in the column counting from the beginning, and the second one is the j-th in the column, and suppose the second tank has number x. Then the first tank can transmit a message to the second tank if i\xe2\x80\x89<\xe2\x80\x89j and i\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89j\xe2\x80\x89-\xe2\x80\x89ax.The Ministry of Defense (and soon the Smart Beaver) faced the question of how to organize the training efficiently. The exercise should be finished as quickly as possible. We\'ll neglect the time that the tanks spend on moving along the column, since improving the tanks\' speed is not a priority for this training.You are given the number of tanks, as well as the message receiving radii of all tanks. You must help the Smart Beaver and organize the transferring of messages in a way that makes the total transmission time of all messages as small as possible." 1600

205B "Little Elephant and Sorting" "brute force,greedy" "The Little Elephant loves sortings.He has an array a consisting of n integers. Let\'s number the array elements from 1 to n, then the i-th element will be denoted as ai. The Little Elephant can make one move to choose an arbitrary pair of integers l and r (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) and increase ai by 1 for all i such that l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r.Help the Little Elephant find the minimum number of moves he needs to convert array a to an arbitrary array sorted in the non-decreasing order. Array a, consisting of n elements, is sorted in the non-decreasing order if for any i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89n) ai\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x891 holds." 1400

205A "Little Elephant and Rozdil" "brute force,implementation" "The Little Elephant loves Ukraine very much. Most of all he loves town Rozdol (ukr. ""Rozdil"").However, Rozdil is dangerous to settle, so the Little Elephant wants to go to some other town. The Little Elephant doesn\'t like to spend much time on travelling, so for his journey he will choose a town that needs minimum time to travel to. If there are multiple such cities, then the Little Elephant won\'t go anywhere.For each town except for Rozdil you know the time needed to travel to this town. Find the town the Little Elephant will go to or print ""Still Rozdil"", if he stays in Rozdil." 900

204E "Little Elephant and Strings" "data structures,implementation,string suffix structures,two pointers" "The Little Elephant loves strings very much. He has an array a from n strings, consisting of lowercase English letters. Let\'s number the elements of the array from 1 to n, then let\'s denote the element number i as ai. For each string ai (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) the Little Elephant wants to find the number of pairs of integers l and r (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|ai|) such that substring ai[l... r] is a substring to at least k strings from array a (including the i-th string).Help the Little Elephant solve this problem.If you are not familiar with the basic notation in string problems, you can find the corresponding definitions in the notes." 2800

204D "Little Elephant and Retro Strings" dp "The Little Elephant has found a ragged old black-and-white string s on the attic.The characters of string s are numbered from the left to the right from 1 to |s|, where |s| is the length of the string. Let\'s denote the i-th character of string s as si. As the string is black-and-white, each character of the string is either letter ""B"", or letter ""W"". Unfortunately, the string is very old and some characters are damaged. The damaged positions are denoted as ""X"".The Little Elephant in determined to restore the string and hang it on the wall. For that he needs to replace each character ""X"" by a ""B"" or a ""W"". The string must look good on the wall, so it must be beautiful. The Little Elephant considers a string beautiful if it has two non-intersecting substrings of a given length k, such that the left one fully consists of characters ""B"", and the right one fully consists of characters ""W"". More formally, there are four integers a,\xe2\x80\x89b,\xe2\x80\x89c,\xe2\x80\x89d (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b\xe2\x80\x89<\xe2\x80\x89c\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89d\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|s|;�b\xe2\x80\x89-\xe2\x80\x89a\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89=\xe2\x80\x89d\xe2\x80\x89-\xe2\x80\x89c\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89=\xe2\x80\x89k) such that si = ""B"" (a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b) and sj = ""W"" (c\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89d). Help the Little Elephant find the number of different beautiful strings he can obtain from string s. Two strings are considered different if there is such position, where the character in the first string differs from the corresponding character in the second string. If this string doesn\'t contain characters \xc2\xabX\xc2\xbb and it is already beautiful \xe2\x80\x94 the answer is 1.As the answer can be rather large, print it modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." 2400

204C "Little Elephant and Furik and Rubik" math,probabilities "Little Elephant loves Furik and Rubik, who he met in a small city Kremenchug.The Little Elephant has two strings of equal length a and b, consisting only of uppercase English letters. The Little Elephant selects a pair of substrings of equal length \xe2\x80\x94 the first one from string a, the second one from string b. The choice is equiprobable among all possible pairs. Let\'s denote the substring of a as x, and the substring of b \xe2\x80\x94 as y. The Little Elephant gives string x to Furik and string y \xe2\x80\x94 to Rubik.Let\'s assume that f(x,\xe2\x80\x89y) is the number of such positions of i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|x|), that xi\xe2\x80\x89=\xe2\x80\x89yi (where |x| is the length of lines x and y, and xi, yi are the i-th characters of strings x and y, correspondingly). Help Furik and Rubik find the expected value of f(x,\xe2\x80\x89y)." 2000

204B "Little Elephant and Cards" "binary search,data structures" "The Little Elephant loves to play with color cards.He has n cards, each has exactly two colors (the color of the front side and the color of the back side). Initially, all the cards lay on the table with the front side up. In one move the Little Elephant can turn any card to the other side. The Little Elephant thinks that a set of cards on the table is funny if at least half of the cards have the same color (for each card the color of the upper side is considered).Help the Little Elephant to find the minimum number of moves needed to make the set of n cards funny." 1500

204A "Little Elephant and Interval" "binary search,combinatorics,dp" "The Little Elephant very much loves sums on intervals.This time he has a pair of integers l and r (l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r). The Little Elephant has to find the number of such integers x (l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r), that the first digit of integer x equals the last one (in decimal notation). For example, such numbers as 101, 477474 or 9 will be included in the answer and 47, 253 or 1020 will not.Help him and count the number of described numbers x for a given pair l and r." 1500

203E Transportation "greedy,sortings,two pointers" "Valera came to Japan and bought many robots for his research. He\'s already at the airport, the plane will fly very soon and Valera urgently needs to bring all robots to the luggage compartment.The robots are self-propelled (they can potentially move on their own), some of them even have compartments to carry other robots. More precisely, for the i-th robot we know value ci \xe2\x80\x94 the number of robots it can carry. In this case, each of ci transported robots can additionally carry other robots.However, the robots need to be filled with fuel to go, so Valera spent all his last money and bought S liters of fuel. He learned that each robot has a restriction on travel distances. Thus, in addition to features ci, the i-th robot has two features fi and li \xe2\x80\x94 the amount of fuel (in liters) needed to move the i-th robot, and the maximum distance that the robot can go.Due to the limited amount of time and fuel, Valera wants to move the maximum number of robots to the luggage compartment. He operates as follows.   First Valera selects some robots that will travel to the luggage compartment on their own. In this case the total amount of fuel required to move all these robots must not exceed S.  Then Valera seats the robots into the compartments, so as to transport as many robots as possible. Note that if a robot doesn\'t move by itself, you can put it in another not moving robot that is moved directly or indirectly by a moving robot.  After that all selected and seated robots along with Valera go to the luggage compartment and the rest robots will be lost. There are d meters to the luggage compartment. Therefore, the robots that will carry the rest, must have feature li of not less than d. During the moving Valera cannot stop or change the location of the robots in any way.Help Valera calculate the maximum number of robots that he will be able to take home, and the minimum amount of fuel he will have to spend, because the remaining fuel will come in handy in Valera\'s research." 2300

203D "Hit Ball" geometry,implementation,math "When Valera was playing football on a stadium, it suddenly began to rain. Valera hid in the corridor under the grandstand not to get wet. However, the desire to play was so great that he decided to train his hitting the ball right in this corridor. Valera went back far enough, put the ball and hit it. The ball bounced off the walls, the ceiling and the floor corridor and finally hit the exit door. As the ball was wet, it left a spot on the door. Now Valera wants to know the coordinates for this spot.Let\'s describe the event more formally. The ball will be considered a point in space. The door of the corridor will be considered a rectangle located on plane xOz, such that the lower left corner of the door is located at point (0,\xe2\x80\x890,\xe2\x80\x890), and the upper right corner is located at point (a,\xe2\x80\x890,\xe2\x80\x89b) . The corridor will be considered as a rectangular parallelepiped, infinite in the direction of increasing coordinates of y. In this corridor the floor will be considered as plane xOy, and the ceiling as plane, parallel to xOy and passing through point (a,\xe2\x80\x890,\xe2\x80\x89b). We will also assume that one of the walls is plane yOz, and the other wall is plane, parallel to yOz and passing through point (a,\xe2\x80\x890,\xe2\x80\x89b).We\'ll say that the ball hit the door when its coordinate y was equal to 0. Thus the coordinates of the spot are point (x0,\xe2\x80\x890,\xe2\x80\x89z0), where 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a,\xe2\x80\x890\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89z0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b. To hit the ball, Valera steps away from the door at distance m and puts the ball in the center of the corridor at point . After the hit the ball flies at speed (vx,\xe2\x80\x89vy,\xe2\x80\x89vz). This means that if the ball has coordinates (x,\xe2\x80\x89y,\xe2\x80\x89z), then after one second it will have coordinates (x\xe2\x80\x89+\xe2\x80\x89vx,\xe2\x80\x89y\xe2\x80\x89+\xe2\x80\x89vy,\xe2\x80\x89z\xe2\x80\x89+\xe2\x80\x89vz).See image in notes for clarification.When the ball collides with the ceiling, the floor or a wall of the corridor, it bounces off in accordance with the laws of reflection (the angle of incidence equals the angle of reflection). In the problem we consider the ideal physical model, so we can assume that there is no air resistance, friction force, or any loss of energy." 1700

203C Photographer greedy,sortings "Valera\'s lifelong ambition was to be a photographer, so he bought a new camera. Every day he got more and more clients asking for photos, and one day Valera needed a program that would determine the maximum number of people he can serve.The camera\'s memory is d megabytes. Valera\'s camera can take photos of high and low quality. One low quality photo takes a megabytes of memory, one high quality photo take b megabytes of memory. For unknown reasons, each client asks him to make several low quality photos and several high quality photos. More formally, the i-th client asks to make xi low quality photos and yi high quality photos.Valera wants to serve as many clients per day as possible, provided that they will be pleased with his work. To please the i-th client, Valera needs to give him everything he wants, that is, to make xi low quality photos and yi high quality photos. To make one low quality photo, the camera must have at least a megabytes of free memory space. Similarly, to make one high quality photo, the camera must have at least b megabytes of free memory space. Initially the camera\'s memory is empty. Valera also does not delete photos from the camera so that the camera\'s memory gradually fills up.Calculate the maximum number of clients Valera can successfully serve and print the numbers of these clients." 1400

203B "Game on Paper" "brute force,implementation" "One not particularly beautiful evening Valera got very bored. To amuse himself a little bit, he found the following game.He took a checkered white square piece of paper, consisting of n\xe2\x80\x89\xc3\x97\xe2\x80\x89n cells. After that, he started to paint the white cells black one after the other. In total he painted m different cells on the piece of paper. Since Valera was keen on everything square, he wondered, how many moves (i.e. times the boy paints a square black) he should make till a black square with side 3 can be found on the piece of paper. But Valera does not know the answer to this question, so he asks you to help him.Your task is to find the minimum number of moves, till the checkered piece of paper has at least one black square with side of 3. Otherwise determine that such move does not exist." 1300

203A "Two Problems" "brute force,implementation" "A boy Valera registered on site Codeforces as Valera, and wrote his first Codeforces Round #300. He boasted to a friend Arkady about winning as much as x points for his first contest. But Arkady did not believe his friend\'s words and decided to check whether Valera could have shown such a result.He knows that the contest number 300 was unusual because there were only two problems. The contest lasted for t minutes, the minutes are numbered starting from zero. The first problem had the initial cost of a points, and every minute its cost reduced by da points. The second problem had the initial cost of b points, and every minute this cost reduced by db points. Thus, as soon as the zero minute of the contest is over, the first problem will cost a\xe2\x80\x89-\xe2\x80\x89da points, and the second problem will cost b\xe2\x80\x89-\xe2\x80\x89db points. It is guaranteed that at any moment of the contest each problem has a non-negative cost.Arkady asks you to find out whether Valera could have got exactly x points for this contest. You should assume that Valera could have solved any number of the offered problems. You should also assume that for each problem Valera made no more than one attempt, besides, he could have submitted both problems at the same minute of the contest, starting with minute 0 and ending with minute number t\xe2\x80\x89-\xe2\x80\x891. Please note that Valera can\'t submit a solution exactly t minutes after the start of the contest or later." 1200

202B "Brand New Easy Problem" "brute force" "A widely known among some people Belarusian sport programmer Lesha decided to make some money to buy a one square meter larger flat. To do this, he wants to make and carry out a Super Rated Match (SRM) on the site Torcoder.com. But there\'s a problem \xe2\x80\x94 a severe torcoder coordinator Ivan does not accept any Lesha\'s problem, calling each of them an offensive word ""duped"" (that is, duplicated). And one day they nearely quarrelled over yet another problem Ivan wouldn\'t accept.You are invited to act as a fair judge and determine whether the problem is indeed brand new, or Ivan is right and the problem bears some resemblance to those used in the previous SRMs.You are given the descriptions of Lesha\'s problem and each of Torcoder.com archive problems. The description of each problem is a sequence of words. Besides, it is guaranteed that Lesha\'s problem has no repeated words, while the description of an archive problem may contain any number of repeated words.The ""similarity"" between Lesha\'s problem and some archive problem can be found as follows. Among all permutations of words in Lesha\'s problem we choose the one that occurs in the archive problem as a subsequence. If there are multiple such permutations, we choose the one with the smallest number of inversions. Then the ""similarity"" of a problem can be written as , where n is the number of words in Lesha\'s problem and x is the number of inversions in the chosen permutation. Note that the ""similarity"" p is always a positive integer.The problem is called brand new if there is not a single problem in Ivan\'s archive which contains a permutation of words from Lesha\'s problem as a subsequence.Help the boys and determine whether the proposed problem is new, or specify the problem from the archive which resembles Lesha\'s problem the most, otherwise." 1700

202A LLPS "binary search,bitmasks,brute force,greedy,implementation,strings" "This problem\'s actual name, ""Lexicographically Largest Palindromic Subsequence"" is too long to fit into the page headline.You are given string s consisting of lowercase English letters only. Find its lexicographically largest palindromic subsequence.We\'ll call a non-empty string s[p1p2... pk] = sp1sp2... spk (1 \xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89 p1\xe2\x80\x89<\xe2\x80\x89p2\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89pk \xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89 |s|) a subsequence of string s = s1s2... s|s|, where |s| is the length of string s. For example, strings ""abcb"", ""b"" and ""abacaba"" are subsequences of string ""abacaba"".String x = x1x2... x|x| is lexicographically larger than string y = y1y2... y|y| if either |x| > |y| and x1\xe2\x80\x89=\xe2\x80\x89y1, x2\xe2\x80\x89=\xe2\x80\x89y2, ...,\xe2\x80\x89x|y|\xe2\x80\x89=\xe2\x80\x89y|y|, or there exists such number r (r\xe2\x80\x89<\xe2\x80\x89|x|, r\xe2\x80\x89<\xe2\x80\x89|y|) that x1\xe2\x80\x89=\xe2\x80\x89y1, x2\xe2\x80\x89=\xe2\x80\x89y2, ..., xr\xe2\x80\x89=\xe2\x80\x89yr and xr\xe2\x80\x89\xe2\x80\x89+\xe2\x80\x89\xe2\x80\x891\xe2\x80\x89>\xe2\x80\x89yr\xe2\x80\x89\xe2\x80\x89+\xe2\x80\x89\xe2\x80\x891. Characters in the strings are compared according to their ASCII codes. For example, string ""ranger"" is lexicographically larger than string ""racecar"" and string ""poster"" is lexicographically larger than string ""post"".String s = s1s2... s|s| is a palindrome if it matches string rev(s) = s|s|s|s|\xe2\x80\x89-\xe2\x80\x891... s1. In other words, a string is a palindrome if it reads the same way from left to right and from right to left. For example, palindromic strings are ""racecar"", ""refer"" and ""z""." 800

201E "Thoroughly Bureaucratic Organization" "binary search,combinatorics" "Once n people simultaneously signed in to the reception at the recently opened, but already thoroughly bureaucratic organization (abbreviated TBO). As the organization is thoroughly bureaucratic, it can accept and cater for exactly one person per day. As a consequence, each of n people made an appointment on one of the next n days, and no two persons have an appointment on the same day.However, the organization workers are very irresponsible about their job, so none of the signed in people was told the exact date of the appointment. The only way to know when people should come is to write some requests to TBO.The request form consists of m empty lines. Into each of these lines the name of a signed in person can be written (it can be left blank as well). Writing a person\'s name in the same form twice is forbidden, such requests are ignored. TBO responds very quickly to written requests, but the reply format is of very poor quality \xe2\x80\x94 that is, the response contains the correct appointment dates for all people from the request form, but the dates are in completely random order. Responds to all requests arrive simultaneously at the end of the day (each response specifies the request that it answers).Fortunately, you aren\'t among these n lucky guys. As an observer, you have the following task \xe2\x80\x94 given n and m, determine the minimum number of requests to submit to TBO to clearly determine the appointment date for each person." 2600

201D "Brand New Problem" "bitmasks,brute force,dp" "A widely known among some people Belarusian sport programmer Lesha decided to make some money to buy a one square meter larger flat. To do this, he wants to make and carry out a Super Rated Match (SRM) on the site Torcoder.com. But there\'s a problem \xe2\x80\x94 a severe torcoder coordinator Ivan does not accept any Lesha\'s problem, calling each of them an offensive word ""duped"" (that is, duplicated). And one day they nearely quarrelled over yet another problem Ivan wouldn\'t accept.You are invited to act as a fair judge and determine whether the problem is indeed brand new, or Ivan is right and the problem bears some resemblance to those used in the previous SRMs.You are given the descriptions of Lesha\'s problem and each of Torcoder.com archive problems. The description of each problem is a sequence of words. Besides, it is guaranteed that Lesha\'s problem has no repeated words, while the description of an archive problem may contain any number of repeated words.The ""similarity"" between Lesha\'s problem and some archive problem can be found as follows. Among all permutations of words in Lesha\'s problem we choose the one that occurs in the archive problem as a subsequence. If there are multiple such permutations, we choose the one with the smallest number of inversions. Then the ""similarity"" of a problem can be written as , where n is the number of words in Lesha\'s problem and x is the number of inversions in the chosen permutation. Note that the ""similarity"" p is always a positive integer.The problem is called brand new if there is not a single problem in Ivan\'s archive which contains a permutation of words from Lesha\'s problem as a subsequence.Help the boys and determine whether the proposed problem is new, or specify the problem from the archive which resembles Lesha\'s problem the most, otherwise." 2600

201C "Fragile Bridges" dp "You are playing a video game and you have just reached the bonus level, where the only possible goal is to score as many points as possible. Being a perfectionist, you\'ve decided that you won\'t leave this level until you\'ve gained the maximum possible number of points there.The bonus level consists of n small platforms placed in a line and numbered from 1 to n from left to right and (n\xe2\x80\x89-\xe2\x80\x891) bridges connecting adjacent platforms. The bridges between the platforms are very fragile, and for each bridge the number of times one can pass this bridge from one of its ends to the other before it collapses forever is known in advance.The player\'s actions are as follows. First, he selects one of the platforms to be the starting position for his hero. After that the player can freely move the hero across the platforms moving by the undestroyed bridges. As soon as the hero finds himself on a platform with no undestroyed bridge attached to it, the level is automatically ended. The number of points scored by the player at the end of the level is calculated as the number of transitions made by the hero between the platforms. Note that if the hero started moving by a certain bridge, he has to continue moving in the same direction until he is on a platform.Find how many points you need to score to be sure that nobody will beat your record, and move to the next level with a quiet heart." 2000

201B "Guess That Car!" "math,ternary search" "A widely known among some people Belarusian sport programmer Yura possesses lots of information about cars. That is why he has been invited to participate in a game show called ""Guess That Car!"".The game show takes place on a giant parking lot, which is 4n meters long from north to south and 4m meters wide from west to east. The lot has n\xe2\x80\x89+\xe2\x80\x891 dividing lines drawn from west to east and m\xe2\x80\x89+\xe2\x80\x891 dividing lines drawn from north to south, which divide the parking lot into n\xc2\xb7m 4 by 4 meter squares. There is a car parked strictly inside each square. The dividing lines are numbered from 0 to n from north to south and from 0 to m from west to east. Each square has coordinates (i,\xe2\x80\x89j) so that the square in the north-west corner has coordinates (1,\xe2\x80\x891) and the square in the south-east corner has coordinates (n,\xe2\x80\x89m). See the picture in the notes for clarifications.Before the game show the organizers offer Yura to occupy any of the (n\xe2\x80\x89+\xe2\x80\x891)\xc2\xb7(m\xe2\x80\x89+\xe2\x80\x891) intersection points of the dividing lines. After that he can start guessing the cars. After Yura chooses a point, he will be prohibited to move along the parking lot before the end of the game show. As Yura is a car expert, he will always guess all cars he is offered, it\'s just a matter of time. Yura knows that to guess each car he needs to spend time equal to the square of the euclidean distance between his point and the center of the square with this car, multiplied by some coefficient characterizing the machine\'s ""rarity"" (the rarer the car is, the harder it is to guess it). More formally, guessing a car with ""rarity"" c placed in a square whose center is at distance d from Yura takes c\xc2\xb7d2 seconds. The time Yura spends on turning his head can be neglected.It just so happened that Yura knows the ""rarity"" of each car on the parking lot in advance. Help him choose his point so that the total time of guessing all cars is the smallest possible." 1800

201A "Clear Symmetry" "constructive algorithms,dp,math" "Consider some square matrix A with side n consisting of zeros and ones. There are n rows numbered from 1 to n from top to bottom and n columns numbered from 1 to n from left to right in this matrix. We\'ll denote the element of the matrix which is located at the intersection of the i-row and the j-th column as Ai,\xe2\x80\x89j.Let\'s call matrix A clear if no two cells containing ones have a common side.Let\'s call matrix A symmetrical if it matches the matrices formed from it by a horizontal and/or a vertical reflection. Formally, for each pair (i,\xe2\x80\x89j) (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i,\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) both of the following conditions must be met: Ai,\xe2\x80\x89j\xe2\x80\x89=\xe2\x80\x89An\xe2\x80\x89-\xe2\x80\x89i\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89j and Ai,\xe2\x80\x89j\xe2\x80\x89=\xe2\x80\x89Ai,\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x89j\xe2\x80\x89+\xe2\x80\x891.Let\'s define the sharpness of matrix A as the number of ones in it.Given integer x, your task is to find the smallest positive integer n such that there exists a clear symmetrical matrix A with side n and sharpness x." 1700

200E "Tractor College" "implementation,math,number theory,ternary search" "While most students still sit their exams, the tractor college has completed the summer exam session. In fact, students study only one subject at this college \xe2\x80\x94 the Art of Operating a Tractor. Therefore, at the end of a term a student gets only one mark, a three (satisfactory), a four (good) or a five (excellent). Those who score lower marks are unfortunately expelled.The college has n students, and oddly enough, each of them can be on scholarship. The size of the scholarships varies each term. Since the end-of-the-term exam has just ended, it\'s time to determine the size of the scholarship to the end of next term.The monthly budget for the scholarships of the Tractor college is s rubles. To distribute the budget optimally, you must follow these rules:  The students who received the same mark for the exam, should receive the same scholarship; Let us denote the size of the scholarship (in roubles) for students who have received marks 3, 4 and 5 for the exam, as k3, k4 and k5, respectively. The values k3, k4 and k5 must be integers and satisfy the inequalities 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k3\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k4\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k5; Let\'s assume that c3, c4, c5 show how many students received marks 3, 4 and 5 for the exam, respectively. The budget of the scholarship should be fully spent on them, that is, c3\xc2\xb7k3\xe2\x80\x89+\xe2\x80\x89c4\xc2\xb7k4\xe2\x80\x89+\xe2\x80\x89c5\xc2\xb7k5\xe2\x80\x89=\xe2\x80\x89s; Let\'s introduce function  \xe2\x80\x94 the value that shows how well the scholarships are distributed between students. In the optimal distribution function f(k3,\xe2\x80\x89k4,\xe2\x80\x89k5) takes the minimum possible value. Given the results of the exam, and the budget size s, you have to find the optimal distribution of the scholarship." 2400

200D "Programming Language" "binary search,brute force,expression parsing,implementation" "Recently, Valery have come across an entirely new programming language. Most of all the language attracted him with template functions and procedures. Let us remind you that templates are tools of a language, designed to encode generic algorithms, without reference to some parameters (e.g., data types, buffer sizes, default values).Valery decided to examine template procedures in this language in more detail. The description of a template procedure consists of the procedure name and the list of its parameter types. The generic type T parameters can be used as parameters of template procedures.A procedure call consists of a procedure name and a list of variable parameters. Let\'s call a procedure suitable for this call if the following conditions are fulfilled:   its name equals to the name of the called procedure;  the number of its parameters equals to the number of parameters of the procedure call;  the types of variables in the procedure call match the corresponding types of its parameters. The variable type matches the type of a parameter if the parameter has a generic type T or the type of the variable and the parameter are the same. You are given a description of some set of template procedures. You are also given a list of variables used in the program, as well as direct procedure calls that use the described variables. For each call you need to count the number of procedures that are suitable for this call." 1800

200C "Football Championship" "brute force,implementation" "Any resemblance to any real championship and sport is accidental.The Berland National team takes part in the local Football championship which now has a group stage. Let\'s describe the formal rules of the local championship:   the team that kicked most balls in the enemy\'s goal area wins the game;  the victory gives 3 point to the team, the draw gives 1 point and the defeat gives 0 points;  a group consists of four teams, the teams are ranked by the results of six games: each team plays exactly once with each other team;  the teams that get places 1 and 2 in the group stage results, go to the next stage of the championship. In the group stage the team\'s place is defined by the total number of scored points: the more points, the higher the place is. If two or more teams have the same number of points, then the following criteria are used (the criteria are listed in the order of falling priority, starting from the most important one):   the difference between the total number of scored goals and the total number of missed goals in the championship: the team with a higher value gets a higher place;  the total number of scored goals in the championship: the team with a higher value gets a higher place;  the lexicographical order of the name of the teams\' countries: the country with the lexicographically smaller name gets a higher place. The Berland team plays in the group where the results of 5 out of 6 games are already known. To be exact, there is the last game left. There the Berand national team plays with some other team. The coach asks you to find such score X:Y (where X is the number of goals Berland scored and Y is the number of goals the opponent scored in the game), that fulfills the following conditions:   X > Y, that is, Berland is going to win this game;  after the game Berland gets the 1st or the 2nd place in the group;  if there are multiple variants, you should choose such score X:Y, where value X\xe2\x80\x89-\xe2\x80\x89Y is minimum;  if it is still impossible to come up with one score, you should choose the score where value Y (the number of goals Berland misses) is minimum." 1800

200B Drinks implementation,math "Little Vasya loves orange juice very much. That\'s why any food and drink in his kitchen necessarily contains orange juice. There are n drinks in his fridge, the volume fraction of orange juice in the i-th drink equals pi percent.One day Vasya decided to make himself an orange cocktail. He took equal proportions of each of the n drinks and mixed them. Then he wondered, how much orange juice the cocktail has.Find the volume fraction of orange juice in the final drink." 800

200A Cinema "brute force,data structures" "The capital of Berland has the only movie theater in the country. Besides, it consists of only one room. The room is divided into n rows, each row consists of m seats.There are k people lined up to the box office, each person wants to buy exactly one ticket for his own entertainment. Before the box office started selling tickets, each person found the seat that seemed best for him and remembered it as a pair of coordinates (xi,\xe2\x80\x89yi), where xi is the row number, and yi is the seat number in this row.It is possible that some people have chosen the same place, then when some people see their favorite seat taken in the plan of empty seats in the theater, they choose and buy a ticket to another place. Each of them has the following logic: let\'s assume that he originally wanted to buy a ticket to seat (x1,\xe2\x80\x89y1), then when he comes to the box office, he chooses such empty seat (x2,\xe2\x80\x89y2), which satisfies the following conditions:   the value of |x1\xe2\x80\x89-\xe2\x80\x89x2|\xe2\x80\x89+\xe2\x80\x89|y1\xe2\x80\x89-\xe2\x80\x89y2| is minimum  if the choice is not unique, then among the seats that satisfy the first condition, this person selects the one for which the value of x2 is minimum  if the choice is still not unique, among the seats that satisfy the first and second conditions, this person selects the one for which the value of y2 is minimum Your task is to find the coordinates of a seat for each person." 2400

199B "Special Olympics" geometry "A renowned abstract artist Sasha, drawing inspiration from nowhere, decided to paint a picture entitled ""Special Olympics"". He justly thought that, if the regular Olympic games have five rings, then the Special ones will do with exactly two rings just fine.Let us remind you that a ring is a region located between two concentric circles with radii r and R (r\xe2\x80\x89<\xe2\x80\x89R). These radii are called internal and external, respectively. Concentric circles are circles with centers located at the same point.Soon a white canvas, which can be considered as an infinite Cartesian plane, had two perfect rings, painted with solid black paint. As Sasha is very impulsive, the rings could have different radii and sizes, they intersect and overlap with each other in any way. We know only one thing for sure: the centers of the pair of rings are not the same.When Sasha got tired and fell into a deep sleep, a girl called Ilona came into the room and wanted to cut a circle for the sake of good memories. To make the circle beautiful, she decided to cut along the contour.We\'ll consider a contour to be a continuous closed line through which there is transition from one color to another (see notes for clarification). If the contour takes the form of a circle, then the result will be cutting out a circle, which Iona wants.But the girl\'s inquisitive mathematical mind does not rest: how many ways are there to cut a circle out of the canvas?" 1900

199A "Hexadecimal\'s theorem" "brute force,constructive algorithms,implementation,number theory" "A renowned abstract artist Sasha, drawing inspiration from nowhere, decided to paint a picture entitled ""Special Olympics"". He justly thought that, if the regular Olympic games have five rings, then the Special ones will do with exactly two rings just fine.Let us remind you that a ring is a region located between two concentric circles with radii r and R (r\xe2\x80\x89<\xe2\x80\x89R). These radii are called internal and external, respectively. Concentric circles are circles with centers located at the same point.Soon a white canvas, which can be considered as an infinite Cartesian plane, had two perfect rings, painted with solid black paint. As Sasha is very impulsive, the rings could have different radii and sizes, they intersect and overlap with each other in any way. We know only one thing for sure: the centers of the pair of rings are not the same.When Sasha got tired and fell into a deep sleep, a girl called Ilona came into the room and wanted to cut a circle for the sake of good memories. To make the circle beautiful, she decided to cut along the contour.We\'ll consider a contour to be a continuous closed line through which there is transition from one color to another (see notes for clarification). If the contour takes the form of a circle, then the result will be cutting out a circle, which Iona wants.But the girl\'s inquisitive mathematical mind does not rest: how many ways are there to cut a circle out of the canvas?" 900

198E "Gripping Story" "binary search,data structures,sortings" "One day Qwerty the Ranger witnessed two transport ships collide with each other. As a result, all contents of their cargo holds scattered around the space. And now Qwerty wants to pick as many lost items as possible to sell them later.The thing is, both ships had lots of new gravitational grippers, transported to sale. A gripper is a device that can be installed on a spaceship and than draw items in space to itself (""grip"") and transport them to the ship\'s cargo hold. Overall the crashed ships lost n gravitational grippers: the i-th gripper is located at a point with coordinates (xi,\xe2\x80\x89yi). Each gripper has two features \xe2\x80\x94 pi (the power) and ri (the action radius) and can grip any items with mass of no more than pi at distance no more than ri. A gripper itself is an item, too and it has its mass of mi.Qwerty\'s ship is located at point (x,\xe2\x80\x89y) and has an old magnetic gripper installed, its characteristics are p and r. There are no other grippers in the ship\'s cargo holds.Find the largest number of grippers Qwerty can get hold of. As he picks the items, he can arbitrarily install any gripper in the cargo hold of the ship, including the gripper he has just picked. At any moment of time the ship can have only one active gripper installed. We consider all items and the Qwerty\'s ship immobile when the ranger picks the items, except for when the gripper moves an item \xe2\x80\x94 then the item moves to the cargo holds and the ship still remains immobile. We can assume that the ship\'s cargo holds have enough room for all grippers. Qwerty can use any gripper he finds or the initial gripper an arbitrary number of times." 2400

198D "Cube Snake" "constructive algorithms" "You\'ve got an n\xe2\x80\x89\xc3\x97\xe2\x80\x89n\xe2\x80\x89\xc3\x97\xe2\x80\x89n cube, split into unit cubes. Your task is to number all unit cubes in this cube with positive integers from 1 to n3 so that:   each number was used as a cube\'s number exactly once;  for each 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89n3, unit cubes with numbers i and i\xe2\x80\x89+\xe2\x80\x891 were neighbouring (that is, shared a side);  for each 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89n there were at least two different subcubes with sizes i\xe2\x80\x89\xc3\x97\xe2\x80\x89i\xe2\x80\x89\xc3\x97\xe2\x80\x89i, made from unit cubes, which are numbered with consecutive numbers. That is, there are such two numbers x and y, that the unit cubes of the first subcube are numbered by numbers x, x\xe2\x80\x89+\xe2\x80\x891, ..., x\xe2\x80\x89+\xe2\x80\x89i3\xe2\x80\x89-\xe2\x80\x891, and the unit cubes of the second subcube are numbered by numbers y, y\xe2\x80\x89+\xe2\x80\x891, ..., y\xe2\x80\x89+\xe2\x80\x89i3\xe2\x80\x89-\xe2\x80\x891. Find and print the required numeration of unit cubes of the cube." 2700

198C "Delivering Carcinogen" "binary search,geometry" "Qwerty the Ranger arrived to the Diatar system with a very important task. He should deliver a special carcinogen for scientific research to planet Persephone. This is urgent, so Qwerty has to get to the planet as soon as possible. A lost day may fail negotiations as nobody is going to pay for an overdue carcinogen.You can consider Qwerty\'s ship, the planet Persephone and the star Diatar points on a plane. Diatar is located in the origin of coordinate axes \xe2\x80\x94 at point (0,\xe2\x80\x890). Persephone goes round Diatar along a circular orbit with radius R in the counter-clockwise direction at constant linear speed vp (thus, for instance, a full circle around the star takes  of time). At the initial moment of time Persephone is located at point (xp,\xe2\x80\x89yp).At the initial moment of time Qwerty\'s ship is at point (x,\xe2\x80\x89y). Qwerty can move in any direction at speed of at most v (v\xe2\x80\x89>\xe2\x80\x89vp). The star Diatar is hot (as all stars), so Qwerty can\'t get too close to it. The ship\'s metal sheathing melts at distance r (r\xe2\x80\x89<\xe2\x80\x89R) from the star.Find the minimum time Qwerty needs to get the carcinogen to planet Persephone." 2400

198B "Jumping on Walls" "shortest paths" "Vasya plays a computer game with ninjas. At this stage Vasya\'s ninja should get out of a deep canyon.The canyon consists of two vertical parallel walls, their height is n meters. Let\'s imagine that we split these walls into 1 meter-long areas and number them with positive integers from 1 to n from bottom to top. Some areas are safe and the ninja can climb them. Others are spiky and ninja can\'t be there. Let\'s call such areas dangerous.Initially the ninja is on the lower area of the left wall. He can use each second to perform one of the following actions:   climb one area up;  climb one area down;  jump to the opposite wall. That gets the ninja to the area that is exactly k meters higher than the area he jumped from. More formally, if before the jump the ninja is located at area x of one wall, then after the jump he is located at area x\xe2\x80\x89+\xe2\x80\x89k of the other wall. If at some point of time the ninja tries to get to an area with a number larger than n, then we can assume that the ninja got out of the canyon.The canyon gets flooded and each second the water level raises one meter. Initially the water level is at the lower border of the first area. Ninja cannot be on the area covered by water. We can assume that the ninja and the water ""move in turns"" \xe2\x80\x94 first the ninja performs some action, then the water raises for one meter, then the ninja performs one more action and so on.The level is considered completed if the ninja manages to get out of the canyon.After several failed attempts Vasya started to doubt whether it is possible to complete the level at all. Help him answer the question." 1400

198A "About Bacteria" implementation,math "Qwerty the Ranger took up a government job and arrived on planet Mars. He should stay in the secret lab and conduct some experiments on bacteria that have funny and abnormal properties. The job isn\'t difficult, but the salary is high.At the beginning of the first experiment there is a single bacterium in the test tube. Every second each bacterium in the test tube divides itself into k bacteria. After that some abnormal effects create b more bacteria in the test tube. Thus, if at the beginning of some second the test tube had x bacteria, then at the end of the second it will have kx\xe2\x80\x89+\xe2\x80\x89b bacteria.The experiment showed that after n seconds there were exactly z bacteria and the experiment ended at this point.For the second experiment Qwerty is going to sterilize the test tube and put there t bacteria. He hasn\'t started the experiment yet but he already wonders, how many seconds he will need to grow at least z bacteria. The ranger thinks that the bacteria will divide by the same rule as in the first experiment. Help Qwerty and find the minimum number of seconds needed to get a tube with at least z bacteria in the second experiment." 1700

197B Limit math "You are given two polynomials:  P(x)\xe2\x80\x89=\xe2\x80\x89a0\xc2\xb7xn\xe2\x80\x89+\xe2\x80\x89a1\xc2\xb7xn\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89an\xe2\x80\x89-\xe2\x80\x891\xc2\xb7x\xe2\x80\x89+\xe2\x80\x89an and  Q(x)\xe2\x80\x89=\xe2\x80\x89b0\xc2\xb7xm\xe2\x80\x89+\xe2\x80\x89b1\xc2\xb7xm\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89bm\xe2\x80\x89-\xe2\x80\x891\xc2\xb7x\xe2\x80\x89+\xe2\x80\x89bm.  Calculate limit ." 1400

197A "Plate Game" "constructive algorithms,games,math" "You\'ve got a rectangular table with length a and width b and the infinite number of plates of radius r. Two players play the following game: they take turns to put the plates on the table so that the plates don\'t lie on each other (but they can touch each other), and so that any point on any plate is located within the table\'s border. During the game one cannot move the plates that already lie on the table. The player who cannot make another move loses. Determine which player wins, the one who moves first or the one who moves second, provided that both players play optimally well." 1600

196E "Opening Portals" "dsu,graphs,shortest paths" "Pavel plays a famous computer game. A player is responsible for a whole country and he can travel there freely, complete quests and earn experience.This country has n cities connected by m bidirectional roads of different lengths so that it is possible to get from any city to any other one. There are portals in k of these cities. At the beginning of the game all portals are closed. When a player visits a portal city, the portal opens. Strange as it is, one can teleport from an open portal to an open one. The teleportation takes no time and that enables the player to travel quickly between rather remote regions of the country.At the beginning of the game Pavel is in city number 1. He wants to open all portals as quickly as possible. How much time will he need for that?" 2600

196D "The Next Good String" "data structures,greedy,hashing,strings" "In problems on strings one often has to find a string with some particular properties. The problem authors were reluctant to waste time on thinking of a name for some string so they called it good. A string is good if it doesn\'t have palindrome substrings longer than or equal to d. You are given string s, consisting only of lowercase English letters. Find a good string t with length |s|, consisting of lowercase English letters, which is lexicographically larger than s. Of all such strings string t must be lexicographically minimum.We will call a non-empty string s[a�...�b]\xe2\x80\x89=\xe2\x80\x89sasa\xe2\x80\x89+\xe2\x80\x891... sb (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|s|) a substring of string s\xe2\x80\x89=\xe2\x80\x89s1s2... s|s|.A non-empty string s\xe2\x80\x89=\xe2\x80\x89s1s2... sn is called a palindrome if for all i from 1 to n the following fulfills: si\xe2\x80\x89=\xe2\x80\x89sn\xe2\x80\x89-\xe2\x80\x89i\xe2\x80\x89+\xe2\x80\x891. In other words, palindrome read the same in both directions.String x\xe2\x80\x89=\xe2\x80\x89x1x2... x|x| is lexicographically larger than string y\xe2\x80\x89=\xe2\x80\x89y1y2... y|y|, if either |x|\xe2\x80\x89>\xe2\x80\x89|y| and x1\xe2\x80\x89=\xe2\x80\x89y1,\xe2\x80\x89x2\xe2\x80\x89=\xe2\x80\x89y2,\xe2\x80\x89... ,\xe2\x80\x89x|y|\xe2\x80\x89=\xe2\x80\x89y|y|, or there exists such number r (r\xe2\x80\x89<\xe2\x80\x89|x|,\xe2\x80\x89r\xe2\x80\x89<\xe2\x80\x89|y|), that x1\xe2\x80\x89=\xe2\x80\x89y1,\xe2\x80\x89x2\xe2\x80\x89=\xe2\x80\x89y2,\xe2\x80\x89... ,\xe2\x80\x89xr\xe2\x80\x89=\xe2\x80\x89yr and xr\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89>\xe2\x80\x89yr\xe2\x80\x89+\xe2\x80\x891. Characters in such strings are compared like their ASCII codes." 2800

196C "Paint Tree" "constructive algorithms,divide and conquer,geometry,sortings,trees" "You are given a tree with n vertexes and n points on a plane, no three points lie on one straight line.Your task is to paint the given tree on a plane, using the given points as vertexes. That is, you should correspond each vertex of the tree to exactly one point and each point should correspond to a vertex. If two vertexes of the tree are connected by an edge, then the corresponding points should have a segment painted between them. The segments that correspond to non-adjacent edges, should not have common points. The segments that correspond to adjacent edges should have exactly one common point." 2200

196B "Infinite Maze" "dfs and similar,graphs" "We\'ve got a rectangular n\xe2\x80\x89\xc3\x97\xe2\x80\x89m-cell maze. Each cell is either passable, or is a wall (impassable). A little boy found the maze and cyclically tiled a plane with it so that the plane became an infinite maze. Now on this plane cell (x,\xe2\x80\x89y) is a wall if and only if cell  is a wall.In this problem  is a remainder of dividing number a by number b.The little boy stood at some cell on the plane and he wondered whether he can walk infinitely far away from his starting position. From cell (x,\xe2\x80\x89y) he can go to one of the following cells: (x,\xe2\x80\x89y\xe2\x80\x89-\xe2\x80\x891), (x,\xe2\x80\x89y\xe2\x80\x89+\xe2\x80\x891), (x\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89y) and (x\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89y), provided that the cell he goes to is not a wall." 2000

196A "Lexicographically Maximum Subsequence" greedy,strings "You\'ve got string s, consisting of only lowercase English letters. Find its lexicographically maximum subsequence.We\'ll call a non-empty string s[p1p2... pk]\xe2\x80\x89=\xe2\x80\x89sp1sp2... spk(1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89p1\xe2\x80\x89<\xe2\x80\x89p2\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89pk\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|s|) a subsequence of string s\xe2\x80\x89=\xe2\x80\x89s1s2... s|s|.String x\xe2\x80\x89=\xe2\x80\x89x1x2... x|x| is lexicographically larger than string y\xe2\x80\x89=\xe2\x80\x89y1y2... y|y|, if either |x|\xe2\x80\x89>\xe2\x80\x89|y| and x1\xe2\x80\x89=\xe2\x80\x89y1,\xe2\x80\x89x2\xe2\x80\x89=\xe2\x80\x89y2,\xe2\x80\x89... ,\xe2\x80\x89x|y|\xe2\x80\x89=\xe2\x80\x89y|y|, or exists such number r (r\xe2\x80\x89<\xe2\x80\x89|x|,\xe2\x80\x89r\xe2\x80\x89<\xe2\x80\x89|y|), that x1\xe2\x80\x89=\xe2\x80\x89y1,\xe2\x80\x89x2\xe2\x80\x89=\xe2\x80\x89y2,\xe2\x80\x89... ,\xe2\x80\x89xr\xe2\x80\x89=\xe2\x80\x89yr and xr\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89>\xe2\x80\x89yr\xe2\x80\x89+\xe2\x80\x891. Characters in lines are compared like their ASCII codes." 1100

195E "Building Forest" "data structures,dsu,graphs" "An oriented weighted forest is an acyclic weighted digraph in which from each vertex at most one edge goes.The root of vertex v of an oriented weighted forest is a vertex from which no edge goes and which can be reached from vertex v moving along the edges of the weighted oriented forest. We denote the root of vertex v as root(v).The depth of vertex v is the sum of weights of paths passing from the vertex v to its root. Let\'s denote the depth of the vertex v as depth(v).Let\'s consider the process of constructing a weighted directed forest. Initially, the forest does not contain vertices. Vertices are added sequentially one by one. Overall, there are n performed operations of adding. The i-th (i\xe2\x80\x89>\xe2\x80\x890) adding operation is described by a set of numbers (k,\xe2\x80\x89\xe2\x80\x89v1,\xe2\x80\x89\xe2\x80\x89x1,\xe2\x80\x89\xe2\x80\x89v2,\xe2\x80\x89\xe2\x80\x89x2,\xe2\x80\x89\xe2\x80\x89... ,\xe2\x80\x89\xe2\x80\x89vk,\xe2\x80\x89\xe2\x80\x89xk) and means that we should add vertex number i and k edges to the graph: an edge from vertex root(v1) to vertex i with weight depth(v1)\xe2\x80\x89+\xe2\x80\x89x1, an edge from vertex root(v2) to vertex i with weight depth(v2)\xe2\x80\x89+\xe2\x80\x89x2 and so on. If k\xe2\x80\x89=\xe2\x80\x890, then only vertex i is added to the graph, there are no added edges.Your task is like this: given the operations of adding vertices, calculate the sum of the weights of all edges of the forest, resulting after the application of all defined operations, modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." 2000

195D "Analyzing Polyline" geometry,math,sortings "As Valeric and Valerko were watching one of the last Euro Championship games in a sports bar, they broke a mug. Of course, the guys paid for it but the barman said that he will let them watch football in his bar only if they help his son complete a programming task. The task goes like that.Let\'s consider a set of functions of the following form:  Let\'s define a sum of n functions y1(x),\xe2\x80\x89...,\xe2\x80\x89yn(x) of the given type as function s(x)\xe2\x80\x89=\xe2\x80\x89y1(x)\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89yn(x) for any x. It\'s easy to show that in this case the graph s(x) is a polyline. You are given n functions of the given type, your task is to find the number of angles that do not equal 180 degrees, in the graph s(x), that is the sum of the given functions.Valeric and Valerko really want to watch the next Euro Championship game, so they asked you to help them." 1900

195C "Try and Catch" "expression parsing,implementation" "Vasya is developing his own programming language VPL (Vasya Programming Language). Right now he is busy making the system of exceptions. He thinks that the system of exceptions must function like that.The exceptions are processed by try-catch-blocks. There are two operators that work with the blocks: The try operator. It opens a new try-catch-block.  The catch(<exception_type>, <message>) operator. It closes the try-catch-block that was started last and haven\'t yet been closed. This block can be activated only via exception of type <exception_type>. When we activate this block, the screen displays the <message>. If at the given moment there is no open try-catch-block, then we can\'t use the catch operator.The exceptions can occur in the program in only one case: when we use the throw operator. The throw(<exception_type>) operator creates the exception of the given type.Let\'s suggest that as a result of using some throw operator the program created an exception of type a. In this case a try-catch-block is activated, such that this block\'s try operator was described in the program earlier than the used throw operator. Also, this block\'s catch operator was given an exception type a as a parameter and this block\'s catch operator is described later that the used throw operator. If there are several such try-catch-blocks, then the system activates the block whose catch operator occurs earlier than others. If no try-catch-block was activated, then the screen displays message ""Unhandled Exception"".To test the system, Vasya wrote a program that contains only try, catch and throw operators, one line contains no more than one operator, the whole program contains exactly one throw operator.Your task is: given a program in VPL, determine, what message will be displayed on the screen." 1800

195B "After Training" "data structures,implementation,math" "After a team finished their training session on Euro football championship, Valeric was commissioned to gather the balls and sort them into baskets. Overall the stadium has n balls and m baskets. The baskets are positioned in a row from left to right and they are numbered with numbers from 1 to m, correspondingly. The balls are numbered with numbers from 1 to n.Valeric decided to sort the balls in the order of increasing of their numbers by the following scheme. He will put each new ball in the basket with the least number of balls. And if he\'s got several variants, he chooses the basket which stands closer to the middle. That means that he chooses the basket for which  is minimum, where i is the number of the basket. If in this case Valeric still has multiple variants, he chooses the basket with the minimum number.For every ball print the number of the basket where it will go according to Valeric\'s scheme.Note that the balls are sorted into baskets in the order of increasing numbers, that is, the first ball goes first, then goes the second ball and so on." 1300

195A "Let\'s Watch Football" "binary search,brute force,math" "After a team finished their training session on Euro football championship, Valeric was commissioned to gather the balls and sort them into baskets. Overall the stadium has n balls and m baskets. The baskets are positioned in a row from left to right and they are numbered with numbers from 1 to m, correspondingly. The balls are numbered with numbers from 1 to n.Valeric decided to sort the balls in the order of increasing of their numbers by the following scheme. He will put each new ball in the basket with the least number of balls. And if he\'s got several variants, he chooses the basket which stands closer to the middle. That means that he chooses the basket for which  is minimum, where i is the number of the basket. If in this case Valeric still has multiple variants, he chooses the basket with the minimum number.For every ball print the number of the basket where it will go according to Valeric\'s scheme.Note that the balls are sorted into baskets in the order of increasing numbers, that is, the first ball goes first, then goes the second ball and so on." 1000

194B Square math "There is a square painted on a piece of paper, the square\'s side equals n meters. John Doe draws crosses on the square\'s perimeter. John paints the first cross in the lower left corner of the square. Then John moves along the square\'s perimeter in the clockwise direction (first upwards, then to the right, then downwards, then to the left and so on). Every time he walks (n\xe2\x80\x89+\xe2\x80\x891) meters, he draws a cross (see picture for clarifications).John Doe stops only when the lower left corner of the square has two crosses. How many crosses will John draw?   The figure shows the order in which John draws crosses for a square with side 4. The lower left square has two crosses. Overall John paints 17 crosses." 1200

194A Exams implementation,math "One day the Codeforces round author sat exams. He had n exams and he needed to get an integer from 2 to 5 for each exam. He will have to re-sit each failed exam, i.e. the exam that gets mark 2. The author would need to spend too much time and effort to make the sum of his marks strictly more than k. That could have spoilt the Codeforces round. On the other hand, if the sum of his marks is strictly less than k, the author\'s mum won\'t be pleased at all. The Codeforces authors are very smart and they always get the mark they choose themselves. Also, the Codeforces authors just hate re-sitting exams. Help the author and find the minimum number of exams he will have to re-sit if he passes the exams in the way that makes the sum of marks for all n exams equal exactly k." 900

193E "Fibonacci Number" "brute force,math,matrices" "John Doe has a list of all Fibonacci numbers modulo 1013. This list is infinite, it starts with numbers 0 and 1. Each number in the list, apart from the first two, is a sum of previous two modulo 1013. That is, John\'s list is made from the Fibonacci numbers\' list by replacing each number there by the remainder when divided by 1013. John got interested in number f (0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89f\xe2\x80\x89<\xe2\x80\x891013) and now wants to find its first occurrence in the list given above. Help John and find the number of the first occurence of number f in the list or otherwise state that number f does not occur in the list. The numeration in John\'s list starts from zero. There, the 0-th position is the number 0, the 1-st position is the number 1, the 2-nd position is the number 1, the 3-rd position is the number 2, the 4-th position is the number 3 and so on. Thus, the beginning of the list looks like this: 0,\xe2\x80\x891,\xe2\x80\x891,\xe2\x80\x892,\xe2\x80\x893,\xe2\x80\x895,\xe2\x80\x898,\xe2\x80\x8913,\xe2\x80\x8921,\xe2\x80\x89..." 2900

193D "Two Segments" "data structures" "Nick has some permutation consisting of p integers from 1 to n. A segment [l,\xe2\x80\x89r] (l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r) is a set of elements pi satisfying l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r.Nick calls a pair of segments [a0,\xe2\x80\x89a1] and [b0,\xe2\x80\x89b1] (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a1\xe2\x80\x89<\xe2\x80\x89b0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) good if all their (a1\xe2\x80\x89-\xe2\x80\x89a0\xe2\x80\x89+\xe2\x80\x89b1\xe2\x80\x89-\xe2\x80\x89b0\xe2\x80\x89+\xe2\x80\x892) elements, when sorted in ascending order, form an arithmetic progression with a difference of 1. That is, when they sorted in ascending order, the elements are in the form {x,\xe2\x80\x89x\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89x\xe2\x80\x89+\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89x\xe2\x80\x89+\xe2\x80\x89m\xe2\x80\x89-\xe2\x80\x891}, for some x and m.Your task is to find the number of distinct pairs of good segments in the given permutation. Two pairs of segments are considered distinct if the sets of elements contained in these pairs of segments are distinct. For example, any segment [l,\xe2\x80\x89r] (l\xe2\x80\x89<\xe2\x80\x89r) can be represented as a pair of segments, as [l,\xe2\x80\x89i] and [i\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89r] (l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r). As all these pairs consist of the same set of elements, they are considered identical.See the notes accompanying the sample tests for clarification." 2900

193C "Hamming Distance" "constructive algorithms,greedy,math,matrices" "Hamming distance between strings a and b of equal length (denoted by h(a,\xe2\x80\x89b)) is equal to the number of distinct integers i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|a|), such that ai\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89bi, where ai is the i-th symbol of string a, bi is the i-th symbol of string b. For example, the Hamming distance between strings ""aba"" and ""bba"" equals 1, they have different first symbols. For strings ""bbba"" and ""aaab"" the Hamming distance equals 4.John Doe had a paper on which four strings of equal length s1, s2, s3 and s4 were written. Each string si consisted only of lowercase letters ""a"" and ""b"". John found the Hamming distances between all pairs of strings he had. Then he lost the paper with the strings but he didn\'t lose the Hamming distances between all pairs.Help John restore the strings; find some four strings s\'1, s\'2, s\'3,\xe2\x80\x89s\'4 of equal length that consist only of lowercase letters ""a"" and ""b"", such that the pairwise Hamming distances between them are the same as between John\'s strings. More formally, set s\'i must satisfy the condition . To make the strings easier to put down on a piece of paper, you should choose among all suitable sets of strings the one that has strings of minimum length." 2400

193B Xor "brute force" "John Doe has four arrays: a, b, k, and p. Each array consists of n integers. Elements of all arrays are indexed starting from 1. Array p is a permutation of integers 1 to n.John invented a game for his friends and himself. Initially a player is given array a. The player must consecutively execute exactly u operations on a. You are permitted to execute the following operations:  Operation 1: For each  change ai into . Expression  means applying the operation of a bitwise xor to numbers x and y. The given operation exists in all modern programming languages, for example, in language C++ and Java it is marked as ""^"", in Pascal \xe2\x80\x94 as ""xor"".  Operation 2: For each  change ai into api\xe2\x80\x89+\xe2\x80\x89r. When this operation is executed, all changes are made at the same time. After all u operations are applied, the number of points the player gets is determined by the formula . John wants to find out what maximum number of points a player can win in his game. Help him." 2000

193A "Cutting Figure" "constructive algorithms,graphs,trees" "You\'ve gotten an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m sheet of squared paper. Some of its squares are painted. Let\'s mark the set of all painted squares as A. Set A is connected. Your task is to find the minimum number of squares that we can delete from set A to make it not connected.A set of painted squares is called connected, if for every two squares a and b from this set there is a sequence of squares from the set, beginning in a and ending in b, such that in this sequence any square, except for the last one, shares a common side with the square that follows next in the sequence. An empty set and a set consisting of exactly one square are connected by definition." 1700

192B "Walking in the Rain" "brute force,implementation" "In Berland the opposition is going to arrange mass walking on the boulevard. The boulevard consists of n tiles that are lain in a row and are numbered from 1 to n from right to left. The opposition should start walking on the tile number 1 and the finish on the tile number n. During the walk it is allowed to move from right to left between adjacent tiles in a row, and jump over a tile. More formally, if you are standing on the tile number i (i\xe2\x80\x89<\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x891), you can reach the tiles number i\xe2\x80\x89+\xe2\x80\x891 or the tile number i\xe2\x80\x89+\xe2\x80\x892 from it (if you stand on the tile number n\xe2\x80\x89-\xe2\x80\x891, you can only reach tile number n). We can assume that all the opposition movements occur instantaneously.In order to thwart an opposition rally, the Berland bloody regime organized the rain. The tiles on the boulevard are of poor quality and they are rapidly destroyed in the rain. We know that the i-th tile is destroyed after ai days of rain (on day ai tile isn\'t destroyed yet, and on day ai\xe2\x80\x89+\xe2\x80\x891 it is already destroyed). Of course, no one is allowed to walk on the destroyed tiles! So the walk of the opposition is considered thwarted, if either the tile number 1 is broken, or the tile number n is broken, or it is impossible to reach the tile number n from the tile number 1 if we can walk on undestroyed tiles.The opposition wants to gather more supporters for their walk. Therefore, the more time they have to pack, the better. Help the opposition to calculate how much time they still have and tell us for how many days the walk from the tile number 1 to the tile number n will be possible." 1100

192A "Funky Numbers" "binary search,brute force,implementation" "As you very well know, this year\'s funkiest numbers are so called triangular numbers (that is, integers that are representable as , where k is some positive integer), and the coolest numbers are those that are representable as a sum of two triangular numbers.A well-known hipster Andrew adores everything funky and cool but unfortunately, he isn\'t good at maths. Given number n, help him define whether this number can be represented by a sum of two triangular numbers (not necessarily different)!" 1300

191E "Thwarting Demonstrations" "binary search,data structures,trees" "It is dark times in Berland. Berlyand opposition, funded from a neighboring state, has organized a demonstration in Berland capital Bertown. Through the work of intelligence we know that the demonstrations are planned to last for k days.Fortunately, Berland has a special police unit, which can save the country. It has exactly n soldiers numbered from 1 to n. Berland general, the commander of the detachment, must schedule the detachment\'s work in these difficult k days. In each of these days, the general must send a certain number of police officers to disperse riots. Since the detachment is large and the general is not very smart, he can only select a set of all soldiers numbered from l to r, inclusive, where l and r are selected arbitrarily.Now the general has exactly two problems. First, he cannot send the same group twice \xe2\x80\x94 then soldiers get bored and they rebel. Second, not all soldiers are equally reliable. Every soldier has a reliability of ai. The reliability of the detachment is counted as the sum of reliabilities of soldiers in it. The reliability of a single soldier can be negative, then when you include him in the detachment, he will only spoil things. The general is distinguished by his great greed and shortsightedness, so each day he sends to the dissolution the most reliable group of soldiers possible (that is, of all the groups that have not been sent yet).The Berland Government has decided to know what would be the minimum reliability of the detachment, sent to disperse the demonstrations during these k days. The general himself can not cope with such a difficult task. Help him to not embarrass himself in front of his superiors!" 2200

191D "Metro Scheme" graphs,greedy "Berland is very concerned with privacy, so almost all plans and blueprints are secret. However, a spy of the neighboring state managed to steal the Bertown subway scheme.The Bertown Subway has n stations, numbered from 1 to n, and m bidirectional tunnels connecting them. All Bertown Subway consists of lines. To be more precise, there are two types of lines: circular and radial.A radial line is a sequence of stations v1,\xe2\x80\x89...,\xe2\x80\x89vk (k\xe2\x80\x89>\xe2\x80\x891), where stations vi and vi\xe2\x80\x89+\xe2\x80\x891 (i\xe2\x80\x89<\xe2\x80\x89k) are connected by a tunnel and no station occurs in the line more than once (vi\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89vj for i\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89j).A loop line is a series of stations, v1,\xe2\x80\x89...,\xe2\x80\x89vk (k\xe2\x80\x89>\xe2\x80\x892), where stations vi \xd0\xb8 vi\xe2\x80\x89+\xe2\x80\x891 are connected by a tunnel. In addition, stations v1 and vk are also connected by a tunnel. No station is occurs in the loop line more than once.Note that a single station can be passed by any number of lines.According to Berland standards, there can\'t be more than one tunnel between two stations and each tunnel belongs to exactly one line. Naturally, each line has at least one tunnel. Between any two stations there is the way along the subway tunnels. In addition, in terms of graph theory, a subway is a vertex cactus: if we consider the subway as a graph in which the stations are the vertexes and the edges are tunnels, then each vertex lies on no more than one simple cycle.Unfortunately, scheme, stolen by the spy, had only the stations and the tunnels. It was impossible to determine to which line every tunnel corresponds. But to sabotage successfully, the spy needs to know what minimum and maximum number of lines may be in the Bertown subway.Help him!" 2700

191C "Fools and Roads" "data structures,dfs and similar,trees" "They say that Berland has exactly two problems, fools and roads. Besides, Berland has n cities, populated by the fools and connected by the roads. All Berland roads are bidirectional. As there are many fools in Berland, between each pair of cities there is a path (or else the fools would get upset). Also, between each pair of cities there is no more than one simple path (or else the fools would get lost). But that is not the end of Berland\'s special features. In this country fools sometimes visit each other and thus spoil the roads. The fools aren\'t very smart, so they always use only the simple paths.A simple path is the path which goes through every Berland city not more than once.The Berland government knows the paths which the fools use. Help the government count for each road, how many distinct fools can go on it.Note how the fools\' paths are given in the input." 1900

191B Demonstration greedy "In the capital city of Berland, Bertown, demonstrations are against the recent election of the King of Berland. Berland opposition, led by Mr. Ovalny, believes that the elections were not fair enough and wants to organize a demonstration at one of the squares.Bertown has n squares, numbered from 1 to n, they are numbered in the order of increasing distance between them and the city center. That is, square number 1 is central, and square number n is the farthest from the center. Naturally, the opposition wants to hold a meeting as close to the city center as possible (that is, they want an square with the minimum number).There are exactly k (k\xe2\x80\x89<\xe2\x80\x89n) days left before the demonstration. Now all squares are free. But the Bertown city administration never sleeps, and the approval of an application for the demonstration threatens to become a very complex process. The process of approval lasts several days, but every day the following procedure takes place:  The opposition shall apply to hold a demonstration at a free square (the one which isn\'t used by the administration).  The administration tries to move the demonstration to the worst free square left. To do this, the administration organizes some long-term activities on the square, which is specified in the application of opposition. In other words, the administration starts using the square and it is no longer free. Then the administration proposes to move the opposition demonstration to the worst free square. If the opposition has applied for the worst free square then request is accepted and administration doesn\'t spend money. If the administration does not have enough money to organize an event on the square in question, the opposition\'s application is accepted. If administration doesn\'t have enough money to organize activity, then rest of administration\'s money spends and application is accepted  If the application is not accepted, then the opposition can agree to the administration\'s proposal (that is, take the worst free square), or withdraw the current application and submit another one the next day. If there are no more days left before the meeting, the opposition has no choice but to agree to the proposal of City Hall. If application is accepted opposition can reject it. It means than opposition still can submit more applications later, but square remains free. In order to organize an event on the square i, the administration needs to spend ai bourles. Because of the crisis the administration has only b bourles to confront the opposition. What is the best square that the opposition can take, if the administration will keep trying to occupy the square in question each time? Note that the administration\'s actions always depend only on the actions of the opposition." 1700

191A "Dynasty Puzzles" dp "The ancient Berlanders believed that the longer the name, the more important its bearer is. Thus, Berland kings were famous for their long names. But long names are somewhat inconvenient, so the Berlanders started to abbreviate the names of their kings. They called every king by the first letters of its name. Thus, the king, whose name was Victorious Vasily Pupkin, was always called by the berlanders VVP.In Berland over its long history many dynasties of kings replaced each other, but they were all united by common traditions. Thus, according to one Berland traditions, to maintain stability in the country, the first name of the heir should be the same as the last name his predecessor (hence, the first letter of the abbreviated name of the heir coincides with the last letter of the abbreviated name of the predecessor). Berlanders appreciate stability, so this tradition has never been broken. Also Berlanders like perfection, so another tradition requires that the first name of the first king in the dynasty coincides with the last name of the last king in this dynasty (hence, the first letter of the abbreviated name of the first king coincides with the last letter of the abbreviated name of the last king). This tradition, of course, has also been always observed.The name of a dynasty is formed by very simple rules: we take all the short names of the kings in the order in which they ruled, and write them in one line. Thus, a dynasty of kings ""ab"" and ""ba"" is called ""abba"", and the dynasty, which had only the king ""abca"", is called ""abca"".Vasya, a historian, has recently found a list of abbreviated names of all Berland kings and their relatives. Help Vasya to find the maximally long name of the dynasty that could have existed in Berland.Note that in his list all the names are ordered by the time, that is, if name A is earlier in the list than B, then if A and B were kings, then king A ruled before king B." 1500

190E "Counter Attack" "data structures,dsu,graphs,hashing,sortings" "Berland has managed to repel the flatlanders\' attack and is now starting the counter attack.Flatland has n cities, numbered from 1 to n, and some pairs of them are connected by bidirectional roads. The Flatlandian maps show roads between cities if and only if there is in fact no road between this pair of cities (we do not know whether is it a clever spy-proof strategy or just saving ink). In other words, if two cities are connected by a road on a flatland map, then there is in fact no road between them. The opposite situation is also true: if two cities are not connected by a road on a flatland map, then in fact, there is a road between them.The berlanders got hold of a flatland map. Now Vasya the Corporal is commissioned by General Touristov to find all such groups of flatland cities, that in each group of cities you can get from any city to any other one, moving along the actual roads. Also the cities from different groups are unreachable from each other, moving along the actual roads. Indeed, destroying such groups one by one is much easier than surrounding all Flatland at once!Help the corporal complete this task and finally become a sergeant! Don\'t forget that a flatland map shows a road between cities if and only if there is in fact no road between them." 2100

190D "Non-Secret Cypher" "two pointers" "Berland starts to seize the initiative on the war with Flatland. To drive the enemy from their native land, the berlanders need to know exactly how many more flatland soldiers are left in the enemy\'s reserve. Fortunately, the scouts captured an enemy in the morning, who had a secret encrypted message with the information the berlanders needed so much.The captured enemy had an array of positive integers. Berland intelligence have long been aware of the flatland code: to convey the message, which contained a number m, the enemies use an array of integers a. The number of its subarrays, in which there are at least k equal numbers, equals m. The number k has long been known in the Berland army so General Touristov has once again asked Corporal Vasya to perform a simple task: to decipher the flatlanders\' message.Help Vasya, given an array of integers a and number k, find the number of subarrays of the array of numbers a, which has at least k equal numbers.Subarray a[i... j]�(1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) of array a\xe2\x80\x89=\xe2\x80\x89(a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an) is an array, made from its consecutive elements, starting from the i-th one and ending with the j-th one: a[i... j]\xe2\x80\x89=\xe2\x80\x89(ai,\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89aj)." 1900

190C STL "dfs and similar" "Vasya used to be an accountant before the war began and he is one of the few who knows how to operate a computer, so he was assigned as the programmer.We all know that programs often store sets of integers. For example, if we have a problem about a weighted directed graph, its edge can be represented by three integers: the number of the starting vertex, the number of the final vertex and the edge\'s weight. So, as Vasya was trying to represent characteristics of a recently invented robot in his program, he faced the following problem.Vasya is not a programmer, so he asked his friend Gena, what the convenient way to store n integers is. Gena used to code in language X-- and so he can use only the types that occur in this language. Let\'s define, what a ""type"" is in language X--:  First, a type is a string ""int"".  Second, a type is a string that starts with ""pair"", then followed by angle brackets listing exactly two comma-separated other types of language X--. This record contains no spaces.  No other strings can be regarded as types. More formally: type := int | pair<type,type>. For example, Gena uses the following type for graph edges: pair<int,pair<int,int>>.Gena was pleased to help Vasya, he dictated to Vasya a type of language X--, that stores n integers. Unfortunately, Gena was in a hurry, so he omitted the punctuation. Now Gena has already left and Vasya can\'t find the correct punctuation, resulting in a type of language X--, however hard he tries.Help Vasya and add the punctuation marks so as to receive the valid type of language X--. Otherwise say that the task is impossible to perform." 1500

190B Surrounded geometry "So, the Berland is at war with its eternal enemy Flatland again, and Vasya, an accountant, was assigned to fulfil his duty to the nation. Right now the situation in Berland is dismal \xe2\x80\x94 their both cities are surrounded! The armies of flatlanders stand on the borders of circles, the circles\' centers are in the surrounded cities. At any moment all points of the flatland ring can begin to move quickly in the direction of the city \xe2\x80\x94 that\'s the strategy the flatlanders usually follow when they besiege cities.The berlanders are sure that they can repel the enemy\'s attack if they learn the exact time the attack starts. For that they need to construct a radar that would register any movement at the distance of at most r from it. Thus, we can install a radar at such point, that at least one point of the enemy ring will be in its detecting range (that is, at a distance of at most r). Then the radar can immediately inform about the enemy\'s attack. Due to the newest technologies, we can place a radar at any point without any problems. But the problem is that the berlanders have the time to make only one radar. Besides, the larger the detection radius (r) is, the more the radar costs.That\'s why Vasya\'s task (that is, your task) is to find the minimum possible detection radius for the radar. In other words, your task is to find the minimum radius r (r\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x890) such, that a radar with radius r can be installed at some point and it can register the start of the movements of both flatland rings from that point. In this problem you can consider the cities as material points, the attacking enemy rings - as circles with centers in the cities, the radar\'s detection range \xe2\x80\x94 as a disk (including the border) with the center at the point where the radar is placed." 1800

190A "Vasya and the Bus" greedy,math "One day Vasya heard a story: ""In the city of High Bertown a bus number 62 left from the bus station. It had n grown-ups and m kids...""The latter events happen to be of no importance to us. Vasya is an accountant and he loves counting money. So he wondered what maximum and minimum sum of money these passengers could have paid for the ride.The bus fare equals one berland ruble in High Bertown. However, not everything is that easy \xe2\x80\x94 no more than one child can ride for free with each grown-up passenger. That means that a grown-up passenger who rides with his k (k\xe2\x80\x89>\xe2\x80\x890) children, pays overall k rubles: a ticket for himself and (k\xe2\x80\x89-\xe2\x80\x891) tickets for his children. Also, a grown-up can ride without children, in this case he only pays one ruble.We know that in High Bertown children can\'t ride in a bus unaccompanied by grown-ups.Help Vasya count the minimum and the maximum sum in Berland rubles, that all passengers of this bus could have paid in total." 1100

189B "Counting Rhombi" "brute force,math" "You have two positive integers w and h. Your task is to count the number of rhombi which have the following properties:   Have positive area.  With vertices at integer points.  All vertices of the rhombi are located inside or on the border of the rectangle with vertices at points (0,\xe2\x80\x890), (w,\xe2\x80\x890), (w,\xe2\x80\x89h), (0,\xe2\x80\x89h). In other words, for all vertices (xi,\xe2\x80\x89yi) of the rhombus the following conditions should fulfill: 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89xi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89w and 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89yi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89h.  Its diagonals are parallel to the axis.  Count the number of such rhombi.Let us remind you that a rhombus is a quadrilateral whose four sides all have the same length." 1300

189A "Cut Ribbon" "brute force,dp" "Polycarpus has a ribbon, its length is n. He wants to cut the ribbon in a way that fulfils the following two conditions:   After the cutting each ribbon piece should have length a, b or c.  After the cutting the number of ribbon pieces should be maximum. Help Polycarpus and find the number of ribbon pieces after the required cutting." 1300

188H Stack "*special problem,expression parsing,implementation" "In this problem we\'ll use a stack which supports two types of operations:  Push a given number on the stack.  Pop two numbers from the stack, perform a given operation (addition or multiplication) on them and push the result on the stack. You are given a string which describes the sequence of operations to be performed on the stack. i-th character corresponds to i-th operation:  If i-th character is a digit, push the corresponding number on the stack.  If i-th character is \xc2\xab+\xc2\xbb or \xc2\xab*\xc2\xbb, perform the corresponding operation. Initially the stack is empty. Output the topmost number on the stack after executing all given operations." 1800

188G "Array Sorting" "*special problem,implementation" "Sorting arrays is traditionally associated with high-level languages. How hard can it be in Roco? Sort the given array in non-descending order." 1600

188F "Binary Notation" "*special problem,implementation" "You are given a positive integer n. Output its binary notation." 1400

188E HQ9+ "*special problem,implementation" "HQ9+ is a joke programming language which has only four one-character instructions: ""H"" prints ""Hello, World!"", ""Q"" prints the whole source code of the program itself (at each call), ""9"" prints the lyrics of ""99 Bottles of Beer"" song,  ""+"" increments the value stored in the internal accumulator.Instructions ""H"" and ""Q"" are case-sensitive and must be uppercase. The characters of the program which are not instructions are ignored.You are given a program written in HQ9+. You have to figure out whether executing this program will produce any output." 1400

188D Asterisks "*special problem,implementation" "You are given a number n. Print n lines, i-th line should consist of i characters ""*"". Lines\' indices are 1-based." 1100

188C LCM "*special problem,implementation,math" "Least common multiple (LCM) of two numbers is the smallest positive integer which is divisible by both of them. You are given integers a and b. Calculate their LCM." 1400

188B "A + Reverse B" "*special problem,implementation" "You are given numbers a and b. Calculate the sum of a and reverse of b. A reverse of a number is a number which contains the same digits in reverse order. For example, reverse of 230 is 32, and reverse of 0 is 0." 1300

188A "Hexagonal Numbers" "*special problem" "Hexagonal numbers are figurate numbers which can be calculated using the formula hn\xe2\x80\x89=\xe2\x80\x892n2\xe2\x80\x89-\xe2\x80\x89n. You are given n; calculate n-th hexagonal number." 1100

187E "Heaven Tour" "data structures,greedy" "The story was not finished as PMP thought. God offered him one more chance to reincarnate and come back to life. But before he can come back, God told him that PMP should ask n great men including prominent programmers about their life experiences.The men are standing on a straight line. They are numbered 1 through n from left to right. The coordinate of the i-th man is xi (xi\xe2\x80\x89<\xe2\x80\x89xi\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89n). PMP should visit all these people one by one in arbitrary order. Each men should be visited exactly once. At the beginning of his tour, he starts at location of s-th man and asks him about his experiences.Each time PMP wants to change his location, he should give a ticket to an angel and the angel carries him to his destination. Angels take PMP from one location, fly to his destination and put him down there. Nobody else is visited in this movement. Moving from i-th man to j-th man, takes |xi\xe2\x80\x89-\xe2\x80\x89xj| time. PMP can get back to life as soon as he visits all men.There are two types of angels: Some angels are going to the right and they only accept right tickets. Others are going the left and they only accept left tickets. There are an unlimited number of angels of each type. PMP has l left tickets and n\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89-\xe2\x80\x89l right tickets.PMP wants to get back to life as soon as possible to be able to compete in this year\'s final instead of the final he missed last year. He wants to know the quickest way to visit all the men exactly once. He also needs to know the exact sequence moves he should make." 2900

187D "BRT Contract" "data structures" "In the last war of PMP, he defeated all his opponents and advanced to the final round. But after the end of semi-final round evil attacked him from behind and killed him! God bless him. Before his death, PMP signed a contract with the bus rapid transit (BRT) that improves public transportations by optimizing time of travel estimation. You should help PMP finish his last contract.Each BRT line is straight line that passes n intersecting on its ways. At each intersection there is traffic light that periodically cycles between green and red. It starts illuminating green at time zero. During the green phase which lasts for g seconds, traffic is allowed to proceed. After the green phase the light changes to red and remains in this color for r seconds. During the red phase traffic is prohibited from proceeding. If a vehicle reaches the intersection exactly at a time when the light changes to red, it should stop, but the vehicle is clear to proceed if the light has just changed to green.  All traffic lights have the same timing and are synchronized. In other words the period of red (and green) phase is the same for all of traffic lights and they all start illuminating green at time zero.The BRT Company has calculated the time that a bus requires to pass each road segment. A road segment is the distance between two consecutive traffic lights or between a traffic light and source (or destination) station. More precisely BRT specialists provide n\xe2\x80\x89+\xe2\x80\x891 positive integers li, the time in seconds that a bus needs to traverse i-th road segment in the path from source to destination. The l1 value denotes the time that a bus needs to pass the distance between source and the first intersection. The ln\xe2\x80\x89+\xe2\x80\x891 value denotes the time between the last intersection and destination.In one day q buses leave the source station. The i-th bus starts from source at time ti (in seconds). Decision makers of BRT Company want to know what time a bus gets to destination?The bus is considered as point. A bus will always move if it can. The buses do not interfere with each other." 2800

187C "Weak Memory" "dfs and similar,dsu" "Zart PMP is qualified for ICPC World Finals in Harbin, China. After team excursion to Sun Island Park for snow sculpture art exposition, PMP should get back to buses before they leave. But the park is really big and he does not know how to find them.The park has n intersections numbered 1 through n. There are m bidirectional roads that connect some pairs of these intersections. At k intersections, ICPC volunteers are helping the teams and showing them the way to their destinations. Locations of volunteers are fixed and distinct.When PMP asks a volunteer the way to bus station, he/she can tell him the whole path. But the park is fully covered with ice and snow and everywhere looks almost the same. So PMP can only memorize at most q intersections after each question (excluding the intersection they are currently standing). He always tells volunteers about his weak memory and if there is no direct path of length (in number of roads) at most q that leads to bus station, the volunteer will guide PMP to another volunteer (who is at most q intersections away, of course). ICPC volunteers know the area very well and always tell PMP the best way. So if there exists a way to bus stations, PMP will definitely find it.PMP\'s initial location is intersection s and the buses are at intersection t. There will always be a volunteer at intersection s. Your job is to find out the minimum q which guarantees that PMP can find the buses." 2000

187B AlgoRace "dp,shortest paths" "PMP is getting a warrior. He is practicing a lot, but the results are not acceptable yet. This time instead of programming contests, he decided to compete in a car racing to increase the spirit of victory. He decides to choose a competition that also exhibits algorithmic features.AlgoRace is a special league of car racing where different teams compete in a country of n cities. Cities are numbered 1 through n. Every two distinct cities in the country are connected with one bidirectional road. Each competing team should introduce one driver and a set of cars.The competition is held in r rounds. In i-th round, drivers will start at city si and finish at city ti. Drivers are allowed to change their cars at most ki times. Changing cars can take place in any city in no time. One car can be used multiple times in one round, but total number of changes should not exceed ki. Drivers can freely choose their path to destination.PMP has prepared m type of purpose-built cars. Beside for PMP\xe2\x80\x99s driving skills, depending on properties of the car and the road, a car traverses each road in each direction in different times. PMP Warriors wants to devise best strategies of choosing car and roads in each round to maximize the chance of winning the cup. For each round they want to find the minimum time required to finish it." 1800

187A Permutations greedy "Happy PMP is freshman and he is learning about algorithmic problems. He enjoys playing algorithmic games a lot.One of the seniors gave Happy PMP a nice game. He is given two permutations of numbers 1 through n and is asked to convert the first one to the second. In one move he can remove the last number from the permutation of numbers and inserts it back in an arbitrary position. He can either insert last number between any two consecutive numbers, or he can place it at the beginning of the permutation.Happy PMP has an algorithm that solves the problem. But it is not fast enough. He wants to know the minimum number of moves to convert the first permutation to the second." 1500

186B "Growing Mushrooms" greedy,sortings "Each year in the castle of Dwarven King there is a competition in growing mushrooms among the dwarves. The competition is one of the most prestigious ones, and the winner gets a wooden salad bowl. This year\'s event brought together the best mushroom growers from around the world, so we had to slightly change the rules so that the event gets more interesting to watch.Each mushroom grower has a mushroom that he will grow on the competition. Under the new rules, the competition consists of two parts. The first part lasts t1 seconds and the second part lasts t2 seconds. The first and the second part are separated by a little break.After the starting whistle the first part of the contest starts, and all mushroom growers start growing mushrooms at once, each at his individual speed of vi meters per second. After t1 seconds, the mushroom growers stop growing mushrooms and go to have a break. During the break, for unexplained reasons, the growth of all mushrooms is reduced by k percent. After the break the second part of the contest starts and all mushrooms growers at the same time continue to grow mushrooms, each at his individual speed of ui meters per second. After a t2 seconds after the end of the break, the competition ends. Note that the speeds before and after the break may vary.Before the match dwarf Pasha learned from all participants, what two speeds they have chosen. However, the participants did not want to disclose to him all their strategy and therefore, did not say in what order they will be using these speeds. That is, if a participant chose speeds ai and bi, then there are two strategies: he either uses speed ai before the break and speed bi after it, or vice versa.Dwarf Pasha really wants to win the totalizer. He knows that each participant chooses the strategy that maximizes the height of the mushroom. Help Dwarf Pasha make the final table of competition results.The participants are sorted in the result table by the mushroom height (the participants with higher mushrooms follow earlier in the table). In case of equal mushroom heights, the participants are sorted by their numbers (the participants with a smaller number follow earlier)." 1200

186A "Comparing Strings" implementation,strings "Some dwarves that are finishing the StUDY (State University for Dwarven Youngsters) Bachelor courses, have been told ""no genome, no degree"". That means that all dwarves should write a thesis on genome. Dwarven genome is far from simple. It is represented by a string that consists of lowercase Latin letters.Dwarf Misha has already chosen the subject for his thesis: determining by two dwarven genomes, whether they belong to the same race. Two dwarves belong to the same race if we can swap two characters in the first dwarf\'s genome and get the second dwarf\'s genome as a result. Help Dwarf Misha and find out whether two gnomes belong to the same race or not." 1100

185E "Soap Time! - 2" "binary search,data structures" "Imagine the Cartesian coordinate system. There are k different points containing subway stations. One can get from any subway station to any one instantly. That is, the duration of the transfer between any two subway stations can be considered equal to zero. You are allowed to travel only between subway stations, that is, you are not allowed to leave the subway somewhere in the middle of your path, in-between the stations. There are n dwarves, they are represented by their coordinates on the plane. The dwarves want to come together and watch a soap opera at some integer point on the plane. For that, they choose the gathering point and start moving towards it simultaneously. In one second a dwarf can move from point (x,\xe2\x80\x89y) to one of the following points: (x\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89y), (x\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89y), (x,\xe2\x80\x89y\xe2\x80\x89-\xe2\x80\x891), (x,\xe2\x80\x89y\xe2\x80\x89+\xe2\x80\x891). Besides, the dwarves can use the subway as many times as they want (the subway transfers the dwarves instantly). The dwarves do not interfere with each other as they move (that is, the dwarves move simultaneously and independently from each other). Help the dwarves and find the minimum time they need to gather at one point." 3000

185D "Visit of the Great" "math,number theory" "The Great Mushroom King descended to the dwarves, but not everyone managed to see him. Only the few chosen ones could see the King.We know that only LCM(k2l\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89k2l\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89k2r\xe2\x80\x89+\xe2\x80\x891) dwarves can see the Great Mushroom King. Numbers k, l, r are chosen by the Great Mushroom King himself in some complicated manner which is unclear to common dwarves. The dwarven historians decided to document all visits of the Great Mushroom King. For each visit the dwarven historians know three integers ki, li, ri, chosen by the Great Mushroom King for this visit. They also know a prime number pi. Help them to count the remainder of dividing the number of dwarves who can see the King, by number pi, for each visit." 2600

185C "Clever Fat Rat" dp "The Fat Rat and his friend \xd0\xa1erealguy have had a bet whether at least a few oats are going to descend to them by some clever construction. The figure below shows the clever construction.  A more formal description of the clever construction is as follows. The clever construction consists of n rows with scales. The first row has n scales, the second row has (n\xe2\x80\x89-\xe2\x80\x891) scales, the i-th row has (n\xe2\x80\x89-\xe2\x80\x89i\xe2\x80\x89+\xe2\x80\x891) scales, the last row has exactly one scale. Let\'s number the scales in each row from the left to the right, starting from 1. Then the value of wi,\xe2\x80\x89k in kilograms (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n;�1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x89i\xe2\x80\x89+\xe2\x80\x891) is the weight capacity parameter of the k-th scale in the i-th row. If a body whose mass is not less than wi,\xe2\x80\x89k falls on the scale with weight capacity wi,\xe2\x80\x89k, then the scale breaks. At that anything that the scale has on it, either falls one level down to the left (if possible) or one level down to the right (if possible). In other words, if the scale wi,\xe2\x80\x89k (i\xe2\x80\x89<\xe2\x80\x89n) breaks, then there are at most two possible variants in which the contents of the scale\'s pan can fall out: all contents of scale wi,\xe2\x80\x89k falls either on scale wi\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89k\xe2\x80\x89-\xe2\x80\x891 (if it exists), or on scale wi\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89k (if it exists). If scale wn,\xe2\x80\x891 breaks, then all its contents falls right in the Fat Rat\'s claws. Please note that the scales that are the first and the last in a row, have only one variant of dropping the contents.Initially, oats are simultaneously put on all scales of the first level. The i-th scale has ai kilograms of oats put on it. After that the scales start breaking and the oats start falling down in some way. You can consider everything to happen instantly. That is, the scale breaks instantly and the oats also fall instantly.The Fat Rat is sure that whatever happens, he will not get the oats from the first level. Cerealguy is sure that there is such a scenario, when the rat gets at least some number of the oats. Help the Fat Rat and the Cerealguy. Determine, which one is right." 2500

185B "Mushroom Scientists" "math,ternary search" "As you very well know, the whole Universe traditionally uses three-dimensional Cartesian system of coordinates. In this system each point corresponds to three real coordinates (x,\xe2\x80\x89y,\xe2\x80\x89z). In this coordinate system, the distance between the center of the Universe and the point is calculated by the following formula: . Mushroom scientists that work for the Great Mushroom King think that the Universe isn\'t exactly right and the distance from the center of the Universe to a point equals xa\xc2\xb7yb\xc2\xb7zc.To test the metric of mushroom scientists, the usual scientists offered them a task: find such x,\xe2\x80\x89y,\xe2\x80\x89z (0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x,\xe2\x80\x89y,\xe2\x80\x89z;�x\xe2\x80\x89+\xe2\x80\x89y\xe2\x80\x89+\xe2\x80\x89z\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89S), that the distance between the center of the Universe and the point (x,\xe2\x80\x89y,\xe2\x80\x89z) is maximum possible in the metric of mushroom scientists. The mushroom scientists aren\'t good at maths, so they commissioned you to do the task.Note that in this problem, it is considered that 00\xe2\x80\x89=\xe2\x80\x891." 1800

185A Plant math "Dwarfs have planted a very interesting plant, which is a triangle directed ""upwards"". This plant has an amusing feature. After one year a triangle plant directed ""upwards"" divides into four triangle plants: three of them will point ""upwards"" and one will point ""downwards"". After another year, each triangle plant divides into four triangle plants: three of them will be directed in the same direction as the parent plant, and one of them will be directed in the opposite direction. Then each year the process repeats. The figure below illustrates this process.  Help the dwarfs find out how many triangle plants that point ""upwards"" will be in n years." 1300

183E "Candy Shop" greedy "The prestigious Codeforces kindergarten consists of n kids, numbered 1 through n. Each of them are given allowance in rubles by their parents.Today, they are going to the most famous candy shop in the town. The shop sells candies in packages: for all i between 1 and m, inclusive, it sells a package containing exactly i candies. A candy costs one ruble, so a package containing x candies costs x rubles.The kids will purchase candies in turns, starting from kid 1. In a single turn, kid i will purchase one candy package. Due to the highly competitive nature of Codeforces kindergarten, during a turn, the number of candies contained in the package purchased by the kid will always be strictly greater than the number of candies contained in the package purchased by the kid in the preceding turn (an exception is in the first turn: the first kid may purchase any package). Then, the turn proceeds to kid i\xe2\x80\x89+\xe2\x80\x891, or to kid 1 if it was kid n\'s turn. This process can be ended at any time, but at the end of the purchase process, all the kids must have the same number of candy packages. Of course, the amount spent by each kid on the candies cannot exceed their allowance.You work at the candy shop and would like to prepare the candies for the kids. Print the maximum number of candies that can be sold by the candy shop to the kids. If the kids cannot purchase any candy (due to insufficient allowance), print 0." 2900

183D T-shirt dp,greedy,probabilities "You are going to work in Codeforces as an intern in a team of n engineers, numbered 1 through n. You want to give each engineer a souvenir: a T-shirt from your country (T-shirts are highly desirable in Codeforces). Unfortunately you don\'t know the size of the T-shirt each engineer fits in. There are m different sizes, numbered 1 through m, and each engineer will fit in a T-shirt of exactly one size.You don\'t know the engineers\' exact sizes, so you asked your friend, Gerald. Unfortunately, he wasn\'t able to obtain the exact sizes either, but he managed to obtain for each engineer i and for all sizes j, the probability that the size of the T-shirt that fits engineer i is j.Since you\'re planning to give each engineer one T-shirt, you are going to bring with you exactly n T-shirts. For those n T-shirts, you can bring any combination of sizes (you can bring multiple T-shirts with the same size too!). You don\'t know the sizes of T-shirts for each engineer when deciding what sizes to bring, so you have to pick this combination based only on the probabilities given by your friend, Gerald. Your task is to maximize the expected number of engineers that receive a T-shirt of his size. This is defined more formally as follows. When you finally arrive at the office, you will ask each engineer his T-shirt size. Then, if you still have a T-shirt of that size, you will give him one of them. Otherwise, you don\'t give him a T-shirt. You will ask the engineers in order starting from engineer 1, then engineer 2, and so on until engineer n." 2700

183C "Cyclic Coloring" "dfs and similar" "You are given a directed graph G with n vertices and m arcs (multiple arcs and self-loops are allowed). You have to paint each vertex of the graph into one of the k (k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) colors in such way that for all arcs of the graph leading from a vertex u to vertex v, vertex v is painted with the next color of the color used to paint vertex u.The colors are numbered cyclically 1 through k. This means that for each color i (i\xe2\x80\x89<\xe2\x80\x89k) its next color is color i\xe2\x80\x89+\xe2\x80\x891. In addition, the next color of color k is color 1. Note, that if k\xe2\x80\x89=\xe2\x80\x891, then the next color for color 1 is again color 1.Your task is to find and print the largest possible value of k (k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) such that it\'s possible to color G as described above with k colors. Note that you don\'t necessarily use all the k colors (that is, for each color i there does not necessarily exist a vertex that is colored with color i)." 2200

183B Zoo "brute force,geometry" "The Zoo in the Grid Kingdom is represented by an infinite grid. The Zoo has n observation binoculars located at the OX axis. For each i between 1 and n, inclusive, there exists a single binocular located at the point with coordinates (i,\xe2\x80\x890). There are m flamingos in the Zoo, located at points with positive coordinates. The flamingos are currently sleeping and you can assume that they don\'t move.In order to get a good view over the flamingos, each of the binoculars can be independently rotated to face any angle (not necessarily integer). Then, the binocular can be used to observe all flamingos that is located at the straight line passing through the binocular at the angle it is set. In other words, you can assign each binocular a direction corresponding to any straight line passing through the binocular, and the binocular will be able to see all flamingos located on that line.Today, some kids from the prestigious Codeforces kindergarten went on a Field Study to the Zoo. Their teacher would like to set each binocular an angle to maximize the number of flamingos that can be seen by the binocular. The teacher is very interested in the sum of these values over all binoculars. Please help him find this sum." 1700

183A Headquarters "constructive algorithms,math" "Sensation, sensation in the two-dimensional kingdom! The police have caught a highly dangerous outlaw, member of the notorious ""Pihters"" gang. The law department states that the outlaw was driving from the gang\'s headquarters in his car when he crashed into an ice cream stall. The stall, the car, and the headquarters each occupies exactly one point on the two-dimensional kingdom.The outlaw\'s car was equipped with a GPS transmitter. The transmitter showed that the car made exactly n movements on its way from the headquarters to the stall. A movement can move the car from point (x,\xe2\x80\x89y) to one of these four points: to point (x\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89y) which we will mark by letter ""L"", to point (x\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89y) \xe2\x80\x94 ""R"", to point (x,\xe2\x80\x89y\xe2\x80\x89-\xe2\x80\x891) \xe2\x80\x94 ""D"", to point (x,\xe2\x80\x89y\xe2\x80\x89+\xe2\x80\x891) \xe2\x80\x94 ""U"".The GPS transmitter is very inaccurate and it doesn\'t preserve the exact sequence of the car\'s movements. Instead, it keeps records of the car\'s possible movements. Each record is a string of one of these types: ""UL"", ""UR"", ""DL"", ""DR"" or ""ULDR"". Each such string means that the car made a single movement corresponding to one of the characters of the string. For example, string ""UL"" means that the car moved either ""U"", or ""L"".You\'ve received the journal with the outlaw\'s possible movements from the headquarters to the stall. The journal records are given in a chronological order. Given that the ice-cream stall is located at point (0,\xe2\x80\x890), your task is to print the number of different points that can contain the gang headquarters (that is, the number of different possible locations of the car\'s origin)." 1700

182E "Wooden Fence" dp "Vasya has recently bought some land and decided to surround it with a wooden fence.He went to a company called ""Wooden board"" that produces wooden boards for fences. Vasya read in the catalog of products that the company has at its disposal n different types of wood. The company uses the i-th type of wood to produce a board of this type that is a rectangular ai by bi block.Vasya decided to order boards in this company and build a fence from them. It turned out that the storehouse of the company is so large that Vasya can order arbitrary number of boards of every type. Note that Vasya is allowed to turn the boards as he builds the fence. However, Vasya cannot turn square boards.Vasya is required to construct a fence of length l, however, an arbitrary fence won\'t do. Vasya wants his fence to look beautiful. We\'ll say that a fence is beautiful if and only if the following two conditions are fulfilled:  there are no two successive boards of the same type  the first board of the fence has an arbitrary length, and the length of each subsequent board equals the width of the previous one In other words, the fence is considered beautiful, if the type of the i-th board in the fence is different from the i\xe2\x80\x89-\xe2\x80\x891-th board\'s type; besides, the i-th board\'s length is equal to the i\xe2\x80\x89-\xe2\x80\x891-th board\'s width (for all i, starting from 2).Now Vasya wonders, how many variants of arranging a fence for his land exist. Your task is to count the number of different beautiful fences of length l.Two fences will be considered the same if the corresponding sequences of fence boards types and rotations are the same, otherwise the fences are different. Since the sought number can be large enough, you need to calculate the answer modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." 1800

182D "Common Divisors" "brute force,hashing,implementation,math,strings" "Vasya has recently learned at school what a number\'s divisor is and decided to determine a string\'s divisor. Here is what he came up with.String a is the divisor of string b if and only if there exists a positive integer x such that if we write out string a consecutively x times, we get string b. For example, string ""abab"" has two divisors \xe2\x80\x94 ""ab"" and ""abab"".Now Vasya wants to write a program that calculates the number of common divisors of two strings. Please help him." 1400

182C "Optimal Sum" "data structures,greedy" "And here goes another problem on arrays. You are given positive integer len and array a which consists of n integers a1, a2, ..., an. Let\'s introduce two characteristics for the given array.  Let\'s consider an arbitrary interval of the array with length len, starting in position i. Value , is the modular sum on the chosen interval. In other words, the modular sum is the sum of integers on the chosen interval with length len, taken in its absolute value. Value  is the optimal sum of the array. In other words, the optimal sum of an array is the maximum of all modular sums on various intervals of array with length len. Your task is to calculate the optimal sum of the given array a. However, before you do the calculations, you are allowed to produce no more than k consecutive operations of the following form with this array: one operation means taking an arbitrary number from array ai and multiply it by -1. In other words, no more than k times you are allowed to take an arbitrary number ai from the array and replace it with \xe2\x80\x89-\xe2\x80\x89ai. Each number of the array is allowed to choose an arbitrary number of times.Your task is to calculate the maximum possible optimal sum of the array after at most k operations described above are completed." 2000

182B "Vasya\'s Calendar" implementation "And here goes another problem on arrays. You are given positive integer len and array a which consists of n integers a1, a2, ..., an. Let\'s introduce two characteristics for the given array.  Let\'s consider an arbitrary interval of the array with length len, starting in position i. Value , is the modular sum on the chosen interval. In other words, the modular sum is the sum of integers on the chosen interval with length len, taken in its absolute value. Value  is the optimal sum of the array. In other words, the optimal sum of an array is the maximum of all modular sums on various intervals of array with length len. Your task is to calculate the optimal sum of the given array a. However, before you do the calculations, you are allowed to produce no more than k consecutive operations of the following form with this array: one operation means taking an arbitrary number from array ai and multiply it by -1. In other words, no more than k times you are allowed to take an arbitrary number ai from the array and replace it with \xe2\x80\x89-\xe2\x80\x89ai. Each number of the array is allowed to choose an arbitrary number of times.Your task is to calculate the maximum possible optimal sum of the array after at most k operations described above are completed." 1000

182A Battlefield "geometry,graphs,implementation,shortest paths" "Vasya lagged behind at the University and got to the battlefield. Just joking! He\'s simply playing some computer game. The field is a flat platform with n trenches dug on it. The trenches are segments on a plane parallel to the coordinate axes. No two trenches intersect.There is a huge enemy laser far away from Vasya. The laser charges for a seconds, and then shoots continuously for b seconds. Then, it charges for a seconds again. Then it shoots continuously for b seconds again and so on. Vasya knows numbers a and b. He also knows that while the laser is shooting, Vasya must be in the trench, but while the laser is charging, Vasya can safely move around the field. The main thing is to have time to hide in the trench before the shot. If Vasya reaches the trench exactly at the moment when the laser starts shooting, we believe that Vasya managed to hide. Coincidentally, the length of any trench in meters numerically does not exceed b.Initially, Vasya is at point A. He needs to get to point B. Vasya moves at speed 1 meter per second in either direction. You can get in or out of the trench at any its point. Getting in or out of the trench takes no time. It is also possible to move in the trench, without leaving it.What is the minimum time Vasya needs to get from point A to point B, if at the initial time the laser has just started charging? If Vasya cannot get from point A to point B, print -1. If Vasya reaches point B at the moment when the laser begins to shoot, it is believed that Vasya managed to reach point B." 2200

181B "Number of Triplets" "binary search,brute force" "You are given n points on a plane. All points are different.Find the number of different groups of three points (A,\xe2\x80\x89B,\xe2\x80\x89C) such that point B is the middle of segment AC. The groups of three points are considered unordered, that is, if point B is the middle of segment AC, then groups (A,\xe2\x80\x89B,\xe2\x80\x89C) and (C,\xe2\x80\x89B,\xe2\x80\x89A) are considered the same." 1300

181A "Series of Crimes" "brute force,geometry,implementation" "The Berland capital is shaken with three bold crimes committed by the Pihsters, a notorious criminal gang.The Berland capital\'s map is represented by an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m rectangular table. Each cell of the table on the map represents some districts of the capital. The capital\'s main detective Polycarpus took a map and marked there the districts where the first three robberies had been committed as asterisks. Deduction tells Polycarpus that the fourth robbery will be committed in such district, that all four robbed districts will form the vertices of some rectangle, parallel to the sides of the map. Polycarpus is good at deduction but he\'s hopeless at math. So he asked you to find the district where the fourth robbery will be committed." 800

180F "Mathematical Analysis Rocks!" "constructive algorithms,implementation,math" "Students of group 199 have written their lectures dismally. Now an exam on Mathematical Analysis is approaching and something has to be done asap (that is, quickly). Let\'s number the students of the group from 1 to n. Each student i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) has a best friend p[i] (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89p[i]\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n). In fact, each student is a best friend of exactly one student. In other words, all p[i] are different. It is possible that the group also has some really ""special individuals"" for who i\xe2\x80\x89=\xe2\x80\x89p[i].Each student wrote exactly one notebook of lecture notes. We know that the students agreed to act by the following algorithm:   on the first day of revising each student studies his own Mathematical Analysis notes,  in the morning of each following day each student gives the notebook to his best friend and takes a notebook from the student who calls him the best friend. Thus, on the second day the student p[i] (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) studies the i-th student\'s notes, on the third day the notes go to student p[p[i]] and so on. Due to some characteristics of the boys\' friendship (see paragraph 1), each day each student has exactly one notebook to study.You are given two sequences that describe the situation on the third and fourth days of revising:  a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an, where ai means the student who gets the i-th student\'s notebook on the third day of revising;  b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bn, where bi means the student who gets the i-th student\'s notebook on the fourth day of revising. You do not know array p, that is you do not know who is the best friend to who. Write a program that finds p by the given sequences a and b." 1200

180E Cubes "binary search,dp,two pointers" "Let\'s imagine that you\'re playing the following simple computer game. The screen displays n lined-up cubes. Each cube is painted one of m colors. You are allowed to delete not more than k cubes (that do not necessarily go one after another). After that, the remaining cubes join together (so that the gaps are closed) and the system counts the score. The number of points you score equals to the length of the maximum sequence of cubes of the same color that follow consecutively. Write a program that determines the maximum possible number of points you can score.Remember, you may delete no more than k any cubes. It is allowed not to delete cubes at all." 1800

180D Name greedy,strings "Everything got unclear to us in a far away constellation Tau Ceti. Specifically, the Taucetians choose names to their children in a very peculiar manner.Two young parents abac and bbad think what name to give to their first-born child. They decided that the name will be the permutation of letters of string s. To keep up with the neighbours, they decided to call the baby so that the name was lexicographically strictly larger than the neighbour\'s son\'s name t.On the other hand, they suspect that a name tax will be introduced shortly. According to it, the Taucetians with lexicographically larger names will pay larger taxes. That\'s the reason abac and bbad want to call the newborn so that the name was lexicographically strictly larger than name t and lexicographically minimum at that.The lexicographical order of strings is the order we are all used to, the ""dictionary"" order. Such comparison is used in all modern programming languages to compare strings. Formally, a string p of length n is lexicographically less than string q of length m, if one of the two statements is correct:  n\xe2\x80\x89<\xe2\x80\x89m, and p is the beginning (prefix) of string q (for example, ""aba"" is less than string ""abaa""),  p1\xe2\x80\x89=\xe2\x80\x89q1, p2\xe2\x80\x89=\xe2\x80\x89q2, ..., pk\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89=\xe2\x80\x89qk\xe2\x80\x89-\xe2\x80\x891, pk\xe2\x80\x89<\xe2\x80\x89qk for some k (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89min(n,\xe2\x80\x89m)), here characters in strings are numbered starting from 1. Write a program that, given string s and the heighbours\' child\'s name t determines the string that is the result of permutation of letters in s. The string should be lexicographically strictly more than t and also, lexicographically minimum." 1900

180C Letter dp "Patrick has just finished writing a message to his sweetheart Stacey when he noticed that the message didn\'t look fancy. Patrick was nervous while writing the message, so some of the letters there were lowercase and some of them were uppercase.Patrick believes that a message is fancy if any uppercase letter stands to the left of any lowercase one. In other words, this rule describes the strings where first go zero or more uppercase letters, and then \xe2\x80\x94 zero or more lowercase letters.To make the message fancy, Patrick can erase some letter and add the same letter in the same place in the opposite case (that is, he can replace an uppercase letter with the lowercase one and vice versa). Patrick got interested in the following question: what minimum number of actions do we need to make a message fancy? Changing a letter\'s case in the message counts as one action. Patrick cannot perform any other actions." 1400

180B "Divisibility Rules" "math,number theory" "Vasya studies divisibility rules at school. Here are some of them: Divisibility by 2. A number is divisible by 2 if and only if its last digit is divisible by 2 or in other words, is even. Divisibility by 3. A number is divisible by 3 if and only if the sum of its digits is divisible by 3. Divisibility by 4. A number is divisible by 4 if and only if its last two digits form a number that is divisible by 4. Divisibility by 5. A number is divisible by 5 if and only if its last digit equals 5 or 0. Divisibility by 6. A number is divisible by 6 if and only if it is divisible by 2 and 3 simultaneously (that is, if the last digit is even and the sum of all digits is divisible by 3). Divisibility by 7. Vasya doesn\'t know such divisibility rule. Divisibility by 8. A number is divisible by 8 if and only if its last three digits form a number that is divisible by 8. Divisibility by 9. A number is divisible by 9 if and only if the sum of its digits is divisible by 9. Divisibility by 10. A number is divisible by 10 if and only if its last digit is a zero. Divisibility by 11. A number is divisible by 11 if and only if the sum of digits on its odd positions either equals to the sum of digits on the even positions, or they differ in a number that is divisible by 11.Vasya got interested by the fact that some divisibility rules resemble each other. In fact, to check a number\'s divisibility by 2, 4, 5, 8 and 10 it is enough to check fulfiling some condition for one or several last digits. Vasya calls such rules the 2-type rules.If checking divisibility means finding a sum of digits and checking whether the sum is divisible by the given number, then Vasya calls this rule the 3-type rule (because it works for numbers 3 and 9).If we need to find the difference between the sum of digits on odd and even positions and check whether the difference is divisible by the given divisor, this rule is called the 11-type rule (it works for number 11).In some cases we should divide the divisor into several factors and check whether rules of different types (2-type, 3-type or 11-type) work there. For example, for number 6 we check 2-type and 3-type rules, for number 66 we check all three types. Such mixed divisibility rules are called 6-type rules. And finally, there are some numbers for which no rule works: neither 2-type, nor 3-type, nor 11-type, nor 6-type. The least such number is number 7, so we\'ll say that in such cases the mysterious 7-type rule works, the one that Vasya hasn\'t discovered yet. Vasya\'s dream is finding divisibility rules for all possible numbers. He isn\'t going to stop on the decimal numbers only. As there are quite many numbers, ha can\'t do it all by himself. Vasya asked you to write a program that determines the divisibility rule type in the b-based notation for the given divisor d." 2300

180A Defragmentation implementation "In this problem you have to implement an algorithm to defragment your hard disk. The hard disk consists of a sequence of clusters, numbered by integers from 1 to n. The disk has m recorded files, the i-th file occupies clusters with numbers ai,\xe2\x80\x891, ai,\xe2\x80\x892, ..., ai,\xe2\x80\x89ni. These clusters are not necessarily located consecutively on the disk, but the order in which they are given corresponds to their sequence in the file (cluster ai,\xe2\x80\x891 contains the first fragment of the i-th file, cluster ai,\xe2\x80\x892 has the second fragment, etc.). Also the disc must have one or several clusters which are free from files.You are permitted to perform operations of copying the contents of cluster number i to cluster number j (i and j must be different). Moreover, if the cluster number j used to keep some information, it is lost forever. Clusters are not cleaned, but after the defragmentation is complete, some of them are simply declared unusable (although they may possibly still contain some fragments of files).Your task is to use a sequence of copy operations to ensure that each file occupies a contiguous area of memory. Each file should occupy a consecutive cluster section, the files must follow one after another from the beginning of the hard disk. After defragmentation all free (unused) clusters should be at the end of the hard disk. After defragmenting files can be placed in an arbitrary order. Clusters of each file should go consecutively from first to last. See explanatory examples in the notes.Print the sequence of operations leading to the disk defragmentation. Note that you do not have to minimize the number of operations, but it should not exceed 2n." 1800

178F3 "Representative Sampling" NA "The Smart Beaver from ABBYY has a long history of cooperating with the ""Institute of Cytology and Genetics"". Recently, the Institute staff challenged the Beaver with a new problem. The problem is as follows.There is a collection of n proteins (not necessarily distinct). Each protein is a string consisting of lowercase Latin letters. The problem that the scientists offered to the Beaver is to select a subcollection of size k from the initial collection of proteins so that the representativity of the selected subset of proteins is maximum possible.The Smart Beaver from ABBYY did some research and came to the conclusion that the representativity of a collection of proteins can be evaluated by a single number, which is simply calculated. Let\'s suppose we have a collection {a1,\xe2\x80\x89...,\xe2\x80\x89ak} consisting of k strings describing proteins. The representativity of this collection is the following value: where f(x,\xe2\x80\x89y) is the length of the longest common prefix of strings x and y; for example, f(""abc"", ""abd"")\xe2\x80\x89=\xe2\x80\x892, and f(""ab"", ""bcd"")\xe2\x80\x89=\xe2\x80\x890.Thus, the representativity of collection of proteins {""abc"", ""abd"", ""abe""} equals 6, and the representativity of collection {""aaa"", ""ba"", ""ba""} equals 2.Having discovered that, the Smart Beaver from ABBYY asked the Cup contestants to write a program that selects, from the given collection of proteins, a subcollection of size k which has the largest possible value of representativity. Help him to solve this problem!" 2500

178F2 "Representative Sampling" dp,sortings,strings "The Smart Beaver from ABBYY has a long history of cooperating with the ""Institute of Cytology and Genetics"". Recently, the Institute staff challenged the Beaver with a new problem. The problem is as follows.There is a collection of n proteins (not necessarily distinct). Each protein is a string consisting of lowercase Latin letters. The problem that the scientists offered to the Beaver is to select a subcollection of size k from the initial collection of proteins so that the representativity of the selected subset of proteins is maximum possible.The Smart Beaver from ABBYY did some research and came to the conclusion that the representativity of a collection of proteins can be evaluated by a single number, which is simply calculated. Let\'s suppose we have a collection {a1,\xe2\x80\x89...,\xe2\x80\x89ak} consisting of k strings describing proteins. The representativity of this collection is the following value: where f(x,\xe2\x80\x89y) is the length of the longest common prefix of strings x and y; for example, f(""abc"", ""abd"")\xe2\x80\x89=\xe2\x80\x892, and f(""ab"", ""bcd"")\xe2\x80\x89=\xe2\x80\x890.Thus, the representativity of collection of proteins {""abc"", ""abd"", ""abe""} equals 6, and the representativity of collection {""aaa"", ""ba"", ""ba""} equals 2.Having discovered that, the Smart Beaver from ABBYY asked the Cup contestants to write a program that selects, from the given collection of proteins, a subcollection of size k which has the largest possible value of representativity. Help him to solve this problem!" 2200

178F1 "Representative Sampling" NA "The Smart Beaver from ABBYY has a long history of cooperating with the ""Institute of Cytology and Genetics"". Recently, the Institute staff challenged the Beaver with a new problem. The problem is as follows.There is a collection of n proteins (not necessarily distinct). Each protein is a string consisting of lowercase Latin letters. The problem that the scientists offered to the Beaver is to select a subcollection of size k from the initial collection of proteins so that the representativity of the selected subset of proteins is maximum possible.The Smart Beaver from ABBYY did some research and came to the conclusion that the representativity of a collection of proteins can be evaluated by a single number, which is simply calculated. Let\'s suppose we have a collection {a1,\xe2\x80\x89...,\xe2\x80\x89ak} consisting of k strings describing proteins. The representativity of this collection is the following value: where f(x,\xe2\x80\x89y) is the length of the longest common prefix of strings x and y; for example, f(""abc"", ""abd"")\xe2\x80\x89=\xe2\x80\x892, and f(""ab"", ""bcd"")\xe2\x80\x89=\xe2\x80\x890.Thus, the representativity of collection of proteins {""abc"", ""abd"", ""abe""} equals 6, and the representativity of collection {""aaa"", ""ba"", ""ba""} equals 2.Having discovered that, the Smart Beaver from ABBYY asked the Cup contestants to write a program that selects, from the given collection of proteins, a subcollection of size k which has the largest possible value of representativity. Help him to solve this problem!" 1800

178E3 "The Beaver\'s Problem - 2" NA "The Smart Beaver from ABBYY has a long history of cooperating with the ""Institute of Cytology and Genetics"". Recently, the Institute staff challenged the Beaver with a new problem. The problem is as follows.There is a collection of n proteins (not necessarily distinct). Each protein is a string consisting of lowercase Latin letters. The problem that the scientists offered to the Beaver is to select a subcollection of size k from the initial collection of proteins so that the representativity of the selected subset of proteins is maximum possible.The Smart Beaver from ABBYY did some research and came to the conclusion that the representativity of a collection of proteins can be evaluated by a single number, which is simply calculated. Let\'s suppose we have a collection {a1,\xe2\x80\x89...,\xe2\x80\x89ak} consisting of k strings describing proteins. The representativity of this collection is the following value: where f(x,\xe2\x80\x89y) is the length of the longest common prefix of strings x and y; for example, f(""abc"", ""abd"")\xe2\x80\x89=\xe2\x80\x892, and f(""ab"", ""bcd"")\xe2\x80\x89=\xe2\x80\x890.Thus, the representativity of collection of proteins {""abc"", ""abd"", ""abe""} equals 6, and the representativity of collection {""aaa"", ""ba"", ""ba""} equals 2.Having discovered that, the Smart Beaver from ABBYY asked the Cup contestants to write a program that selects, from the given collection of proteins, a subcollection of size k which has the largest possible value of representativity. Help him to solve this problem!" 2300

178E2 "The Beaver\'s Problem - 2" NA "The Smart Beaver from ABBYY has a long history of cooperating with the ""Institute of Cytology and Genetics"". Recently, the Institute staff challenged the Beaver with a new problem. The problem is as follows.There is a collection of n proteins (not necessarily distinct). Each protein is a string consisting of lowercase Latin letters. The problem that the scientists offered to the Beaver is to select a subcollection of size k from the initial collection of proteins so that the representativity of the selected subset of proteins is maximum possible.The Smart Beaver from ABBYY did some research and came to the conclusion that the representativity of a collection of proteins can be evaluated by a single number, which is simply calculated. Let\'s suppose we have a collection {a1,\xe2\x80\x89...,\xe2\x80\x89ak} consisting of k strings describing proteins. The representativity of this collection is the following value: where f(x,\xe2\x80\x89y) is the length of the longest common prefix of strings x and y; for example, f(""abc"", ""abd"")\xe2\x80\x89=\xe2\x80\x892, and f(""ab"", ""bcd"")\xe2\x80\x89=\xe2\x80\x890.Thus, the representativity of collection of proteins {""abc"", ""abd"", ""abe""} equals 6, and the representativity of collection {""aaa"", ""ba"", ""ba""} equals 2.Having discovered that, the Smart Beaver from ABBYY asked the Cup contestants to write a program that selects, from the given collection of proteins, a subcollection of size k which has the largest possible value of representativity. Help him to solve this problem!" 2000

178E1 "The Beaver\'s Problem - 2" NA "The Smart Beaver from ABBYY has a long history of cooperating with the ""Institute of Cytology and Genetics"". Recently, the Institute staff challenged the Beaver with a new problem. The problem is as follows.There is a collection of n proteins (not necessarily distinct). Each protein is a string consisting of lowercase Latin letters. The problem that the scientists offered to the Beaver is to select a subcollection of size k from the initial collection of proteins so that the representativity of the selected subset of proteins is maximum possible.The Smart Beaver from ABBYY did some research and came to the conclusion that the representativity of a collection of proteins can be evaluated by a single number, which is simply calculated. Let\'s suppose we have a collection {a1,\xe2\x80\x89...,\xe2\x80\x89ak} consisting of k strings describing proteins. The representativity of this collection is the following value: where f(x,\xe2\x80\x89y) is the length of the longest common prefix of strings x and y; for example, f(""abc"", ""abd"")\xe2\x80\x89=\xe2\x80\x892, and f(""ab"", ""bcd"")\xe2\x80\x89=\xe2\x80\x890.Thus, the representativity of collection of proteins {""abc"", ""abd"", ""abe""} equals 6, and the representativity of collection {""aaa"", ""ba"", ""ba""} equals 2.Having discovered that, the Smart Beaver from ABBYY asked the Cup contestants to write a program that selects, from the given collection of proteins, a subcollection of size k which has the largest possible value of representativity. Help him to solve this problem!" 1900

178D3 "Magic Squares" NA "The Smart Beaver from ABBYY loves puzzles. One of his favorite puzzles is the magic square. He has recently had an idea to automate the solution of this puzzle. The Beaver decided to offer this challenge to the ABBYY Cup contestants.The magic square is a matrix of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89n. The elements of this matrix are integers. The sum of numbers in each row of the matrix is equal to some number s. The sum of numbers in each column of the matrix is also equal to s. In addition, the sum of the elements on the main diagonal is equal to s and the sum of elements on the secondary diagonal is equal to s. Examples of magic squares are given in the following figure:   Magic squares  You are given a set of n2 integers ai. It is required to place these numbers into a square matrix of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89n so that they form a magic square. Note that each number must occur in the matrix exactly the same number of times as it occurs in the original set.It is guaranteed that a solution exists!" 2100

178D2 "Magic Squares" NA "The Smart Beaver from ABBYY loves puzzles. One of his favorite puzzles is the magic square. He has recently had an idea to automate the solution of this puzzle. The Beaver decided to offer this challenge to the ABBYY Cup contestants.The magic square is a matrix of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89n. The elements of this matrix are integers. The sum of numbers in each row of the matrix is equal to some number s. The sum of numbers in each column of the matrix is also equal to s. In addition, the sum of the elements on the main diagonal is equal to s and the sum of elements on the secondary diagonal is equal to s. Examples of magic squares are given in the following figure:   Magic squares  You are given a set of n2 integers ai. It is required to place these numbers into a square matrix of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89n so that they form a magic square. Note that each number must occur in the matrix exactly the same number of times as it occurs in the original set.It is guaranteed that a solution exists!" 1900

178D1 "Magic Squares" NA "The Smart Beaver from ABBYY loves puzzles. One of his favorite puzzles is the magic square. He has recently had an idea to automate the solution of this puzzle. The Beaver decided to offer this challenge to the ABBYY Cup contestants.The magic square is a matrix of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89n. The elements of this matrix are integers. The sum of numbers in each row of the matrix is equal to some number s. The sum of numbers in each column of the matrix is also equal to s. In addition, the sum of the elements on the main diagonal is equal to s and the sum of elements on the secondary diagonal is equal to s. Examples of magic squares are given in the following figure:   Magic squares  You are given a set of n2 integers ai. It is required to place these numbers into a square matrix of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89n so that they form a magic square. Note that each number must occur in the matrix exactly the same number of times as it occurs in the original set.It is guaranteed that a solution exists!" 1500

178C3 "Smart Beaver and Resolving Collisions" NA "The Smart Beaver from ABBYY has a lot of hobbies. One of them is constructing efficient hash tables. One of the most serious problems in hash tables is resolving collisions. The Beaver is interested in this problem very much and he decided to explore it in detail.We assume that the hash table consists of h cells numbered from 0 to h\xe2\x80\x89-\xe2\x80\x891. Objects are added to and removed from it. Every object has its own unique identifier. In addition, every object has a corresponding hash value \xe2\x80\x94 an integer between 0 and h\xe2\x80\x89-\xe2\x80\x891, inclusive. When an object is added to the table, if the cell corresponding to the hash value of the object is free, then this object goes there. If the cell is already occupied by another object, there is a collision. When an object is deleted from the table, the cell which it occupied becomes empty.The Smart Beaver has recently learned about the method of linear probing to resolve collisions. It is as follows. Let\'s say that the hash value for the added object equals t and cell t of the table is already occupied. Then we try to add this object to cell (t\xe2\x80\x89+\xe2\x80\x89m)�mod�h. If it is also occupied, then we try cell (t\xe2\x80\x89+\xe2\x80\x892\xc2\xb7m)�mod�h, then cell (t\xe2\x80\x89+\xe2\x80\x893\xc2\xb7m)�mod�h, and so on. Note that in some cases it\'s possible that the new object can not be added to the table. It is guaranteed that the input for this problem doesn\'t contain such situations.The operation a�mod�b means that we take the remainder of the division of number a by number b.This technique immediately seemed very inoptimal to the Beaver, and he decided to assess its inefficiency. So, you are given a sequence of operations, each of which is either an addition of an object to the table or a deletion of an object from the table. When adding a new object, a sequence of calls to the table is performed. Calls to occupied cells are called dummy. In other words, if the result of the algorithm described above is the object being added to cell (t\xe2\x80\x89+\xe2\x80\x89i\xc2\xb7m)�mod�h (i\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x890), then exactly i dummy calls have been performed.Your task is to calculate the total number of dummy calls to the table for the given sequence of additions and deletions. When an object is deleted from the table, assume that no dummy calls are performed. The table is empty before performing the operations, that is, initially it doesn\'t contain any objects." 2000

178C2 "Smart Beaver and Resolving Collisions" NA "The Smart Beaver from ABBYY has a lot of hobbies. One of them is constructing efficient hash tables. One of the most serious problems in hash tables is resolving collisions. The Beaver is interested in this problem very much and he decided to explore it in detail.We assume that the hash table consists of h cells numbered from 0 to h\xe2\x80\x89-\xe2\x80\x891. Objects are added to and removed from it. Every object has its own unique identifier. In addition, every object has a corresponding hash value \xe2\x80\x94 an integer between 0 and h\xe2\x80\x89-\xe2\x80\x891, inclusive. When an object is added to the table, if the cell corresponding to the hash value of the object is free, then this object goes there. If the cell is already occupied by another object, there is a collision. When an object is deleted from the table, the cell which it occupied becomes empty.The Smart Beaver has recently learned about the method of linear probing to resolve collisions. It is as follows. Let\'s say that the hash value for the added object equals t and cell t of the table is already occupied. Then we try to add this object to cell (t\xe2\x80\x89+\xe2\x80\x89m)�mod�h. If it is also occupied, then we try cell (t\xe2\x80\x89+\xe2\x80\x892\xc2\xb7m)�mod�h, then cell (t\xe2\x80\x89+\xe2\x80\x893\xc2\xb7m)�mod�h, and so on. Note that in some cases it\'s possible that the new object can not be added to the table. It is guaranteed that the input for this problem doesn\'t contain such situations.The operation a�mod�b means that we take the remainder of the division of number a by number b.This technique immediately seemed very inoptimal to the Beaver, and he decided to assess its inefficiency. So, you are given a sequence of operations, each of which is either an addition of an object to the table or a deletion of an object from the table. When adding a new object, a sequence of calls to the table is performed. Calls to occupied cells are called dummy. In other words, if the result of the algorithm described above is the object being added to cell (t\xe2\x80\x89+\xe2\x80\x89i\xc2\xb7m)�mod�h (i\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x890), then exactly i dummy calls have been performed.Your task is to calculate the total number of dummy calls to the table for the given sequence of additions and deletions. When an object is deleted from the table, assume that no dummy calls are performed. The table is empty before performing the operations, that is, initially it doesn\'t contain any objects." 1900

178C1 "Smart Beaver and Resolving Collisions" NA "The Smart Beaver from ABBYY has a lot of hobbies. One of them is constructing efficient hash tables. One of the most serious problems in hash tables is resolving collisions. The Beaver is interested in this problem very much and he decided to explore it in detail.We assume that the hash table consists of h cells numbered from 0 to h\xe2\x80\x89-\xe2\x80\x891. Objects are added to and removed from it. Every object has its own unique identifier. In addition, every object has a corresponding hash value \xe2\x80\x94 an integer between 0 and h\xe2\x80\x89-\xe2\x80\x891, inclusive. When an object is added to the table, if the cell corresponding to the hash value of the object is free, then this object goes there. If the cell is already occupied by another object, there is a collision. When an object is deleted from the table, the cell which it occupied becomes empty.The Smart Beaver has recently learned about the method of linear probing to resolve collisions. It is as follows. Let\'s say that the hash value for the added object equals t and cell t of the table is already occupied. Then we try to add this object to cell (t\xe2\x80\x89+\xe2\x80\x89m)�mod�h. If it is also occupied, then we try cell (t\xe2\x80\x89+\xe2\x80\x892\xc2\xb7m)�mod�h, then cell (t\xe2\x80\x89+\xe2\x80\x893\xc2\xb7m)�mod�h, and so on. Note that in some cases it\'s possible that the new object can not be added to the table. It is guaranteed that the input for this problem doesn\'t contain such situations.The operation a�mod�b means that we take the remainder of the division of number a by number b.This technique immediately seemed very inoptimal to the Beaver, and he decided to assess its inefficiency. So, you are given a sequence of operations, each of which is either an addition of an object to the table or a deletion of an object from the table. When adding a new object, a sequence of calls to the table is performed. Calls to occupied cells are called dummy. In other words, if the result of the algorithm described above is the object being added to cell (t\xe2\x80\x89+\xe2\x80\x89i\xc2\xb7m)�mod�h (i\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x890), then exactly i dummy calls have been performed.Your task is to calculate the total number of dummy calls to the table for the given sequence of additions and deletions. When an object is deleted from the table, assume that no dummy calls are performed. The table is empty before performing the operations, that is, initially it doesn\'t contain any objects." 1600

178B3 "Greedy Merchants" NA "In ABBYY a wonderful Smart Beaver lives. This time, he began to study history. When he read about the Roman Empire, he became interested in the life of merchants.The Roman Empire consisted of n cities numbered from 1 to n. It also had m bidirectional roads numbered from 1 to m. Each road connected two different cities. Any two cities were connected by no more than one road.We say that there is a path between cities c1 and c2 if there exists a finite sequence of cities t1,\xe2\x80\x89t2,\xe2\x80\x89...,\xe2\x80\x89tp (p\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x891) such that:  t1\xe2\x80\x89=\xe2\x80\x89c1  tp\xe2\x80\x89=\xe2\x80\x89c2  for any i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89p), cities ti and ti\xe2\x80\x89+\xe2\x80\x891 are connected by a road We know that there existed a path between any two cities in the Roman Empire.In the Empire k merchants lived numbered from 1 to k. For each merchant we know a pair of numbers si and li, where si is the number of the city where this merchant\'s warehouse is, and li is the number of the city where his shop is. The shop and the warehouse could be located in different cities, so the merchants had to deliver goods from the warehouse to the shop.Let\'s call a road important for the merchant if its destruction threatens to ruin the merchant, that is, without this road there is no path from the merchant\'s warehouse to his shop. Merchants in the Roman Empire are very greedy, so each merchant pays a tax (1 dinar) only for those roads which are important for him. In other words, each merchant pays di dinars of tax, where di (di\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x890) is the number of roads important for the i-th merchant.The tax collection day came in the Empire. The Smart Beaver from ABBYY is very curious by nature, so he decided to count how many dinars each merchant had paid that day. And now he needs your help." 1800

178B2 "Greedy Merchants" NA "In ABBYY a wonderful Smart Beaver lives. This time, he began to study history. When he read about the Roman Empire, he became interested in the life of merchants.The Roman Empire consisted of n cities numbered from 1 to n. It also had m bidirectional roads numbered from 1 to m. Each road connected two different cities. Any two cities were connected by no more than one road.We say that there is a path between cities c1 and c2 if there exists a finite sequence of cities t1,\xe2\x80\x89t2,\xe2\x80\x89...,\xe2\x80\x89tp (p\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x891) such that:  t1\xe2\x80\x89=\xe2\x80\x89c1  tp\xe2\x80\x89=\xe2\x80\x89c2  for any i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89p), cities ti and ti\xe2\x80\x89+\xe2\x80\x891 are connected by a road We know that there existed a path between any two cities in the Roman Empire.In the Empire k merchants lived numbered from 1 to k. For each merchant we know a pair of numbers si and li, where si is the number of the city where this merchant\'s warehouse is, and li is the number of the city where his shop is. The shop and the warehouse could be located in different cities, so the merchants had to deliver goods from the warehouse to the shop.Let\'s call a road important for the merchant if its destruction threatens to ruin the merchant, that is, without this road there is no path from the merchant\'s warehouse to his shop. Merchants in the Roman Empire are very greedy, so each merchant pays a tax (1 dinar) only for those roads which are important for him. In other words, each merchant pays di dinars of tax, where di (di\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x890) is the number of roads important for the i-th merchant.The tax collection day came in the Empire. The Smart Beaver from ABBYY is very curious by nature, so he decided to count how many dinars each merchant had paid that day. And now he needs your help." 1600

178B1 "Greedy Merchants" NA "In ABBYY a wonderful Smart Beaver lives. This time, he began to study history. When he read about the Roman Empire, he became interested in the life of merchants.The Roman Empire consisted of n cities numbered from 1 to n. It also had m bidirectional roads numbered from 1 to m. Each road connected two different cities. Any two cities were connected by no more than one road.We say that there is a path between cities c1 and c2 if there exists a finite sequence of cities t1,\xe2\x80\x89t2,\xe2\x80\x89...,\xe2\x80\x89tp (p\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x891) such that:  t1\xe2\x80\x89=\xe2\x80\x89c1  tp\xe2\x80\x89=\xe2\x80\x89c2  for any i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89p), cities ti and ti\xe2\x80\x89+\xe2\x80\x891 are connected by a road We know that there existed a path between any two cities in the Roman Empire.In the Empire k merchants lived numbered from 1 to k. For each merchant we know a pair of numbers si and li, where si is the number of the city where this merchant\'s warehouse is, and li is the number of the city where his shop is. The shop and the warehouse could be located in different cities, so the merchants had to deliver goods from the warehouse to the shop.Let\'s call a road important for the merchant if its destruction threatens to ruin the merchant, that is, without this road there is no path from the merchant\'s warehouse to his shop. Merchants in the Roman Empire are very greedy, so each merchant pays a tax (1 dinar) only for those roads which are important for him. In other words, each merchant pays di dinars of tax, where di (di\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x890) is the number of roads important for the i-th merchant.The tax collection day came in the Empire. The Smart Beaver from ABBYY is very curious by nature, so he decided to count how many dinars each merchant had paid that day. And now he needs your help." 1600

178A3 "Educational Game" greedy "The Smart Beaver from ABBYY began to develop a new educational game for children. The rules of the game are fairly simple and are described below.The playing field is a sequence of n non-negative integers ai numbered from 1 to n. The goal of the game is to make numbers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89ak (i.e. some prefix of the sequence) equal to zero for some fixed k (k\xe2\x80\x89<\xe2\x80\x89n), and this should be done in the smallest possible number of moves.One move is choosing an integer i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) such that ai\xe2\x80\x89>\xe2\x80\x890 and an integer t (t\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x890) such that i\xe2\x80\x89+\xe2\x80\x892t\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n. After the values of i and t have been selected, the value of ai is decreased by 1, and the value of ai\xe2\x80\x89+\xe2\x80\x892t is increased by 1. For example, let n\xe2\x80\x89=\xe2\x80\x894 and a\xe2\x80\x89=\xe2\x80\x89(1,\xe2\x80\x890,\xe2\x80\x891,\xe2\x80\x892), then it is possible to make move i\xe2\x80\x89=\xe2\x80\x893, t\xe2\x80\x89=\xe2\x80\x890 and get a\xe2\x80\x89=\xe2\x80\x89(1,\xe2\x80\x890,\xe2\x80\x890,\xe2\x80\x893) or to make move i\xe2\x80\x89=\xe2\x80\x891, t\xe2\x80\x89=\xe2\x80\x891 and get a\xe2\x80\x89=\xe2\x80\x89(0,\xe2\x80\x890,\xe2\x80\x892,\xe2\x80\x892) (the only possible other move is i\xe2\x80\x89=\xe2\x80\x891, t\xe2\x80\x89=\xe2\x80\x890).You are given n and the initial sequence ai. The task is to calculate the minimum number of moves needed to make the first k elements of the original sequence equal to zero for each possible k (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k\xe2\x80\x89<\xe2\x80\x89n)." 1100

178A2 "Educational Game" greedy "The Smart Beaver from ABBYY began to develop a new educational game for children. The rules of the game are fairly simple and are described below.The playing field is a sequence of n non-negative integers ai numbered from 1 to n. The goal of the game is to make numbers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89ak (i.e. some prefix of the sequence) equal to zero for some fixed k (k\xe2\x80\x89<\xe2\x80\x89n), and this should be done in the smallest possible number of moves.One move is choosing an integer i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) such that ai\xe2\x80\x89>\xe2\x80\x890 and an integer t (t\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x890) such that i\xe2\x80\x89+\xe2\x80\x892t\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n. After the values of i and t have been selected, the value of ai is decreased by 1, and the value of ai\xe2\x80\x89+\xe2\x80\x892t is increased by 1. For example, let n\xe2\x80\x89=\xe2\x80\x894 and a\xe2\x80\x89=\xe2\x80\x89(1,\xe2\x80\x890,\xe2\x80\x891,\xe2\x80\x892), then it is possible to make move i\xe2\x80\x89=\xe2\x80\x893, t\xe2\x80\x89=\xe2\x80\x890 and get a\xe2\x80\x89=\xe2\x80\x89(1,\xe2\x80\x890,\xe2\x80\x890,\xe2\x80\x893) or to make move i\xe2\x80\x89=\xe2\x80\x891, t\xe2\x80\x89=\xe2\x80\x891 and get a\xe2\x80\x89=\xe2\x80\x89(0,\xe2\x80\x890,\xe2\x80\x892,\xe2\x80\x892) (the only possible other move is i\xe2\x80\x89=\xe2\x80\x891, t\xe2\x80\x89=\xe2\x80\x890).You are given n and the initial sequence ai. The task is to calculate the minimum number of moves needed to make the first k elements of the original sequence equal to zero for each possible k (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k\xe2\x80\x89<\xe2\x80\x89n)." 1000

178A1 "Educational Game" NA "The Smart Beaver from ABBYY began to develop a new educational game for children. The rules of the game are fairly simple and are described below.The playing field is a sequence of n non-negative integers ai numbered from 1 to n. The goal of the game is to make numbers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89ak (i.e. some prefix of the sequence) equal to zero for some fixed k (k\xe2\x80\x89<\xe2\x80\x89n), and this should be done in the smallest possible number of moves.One move is choosing an integer i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) such that ai\xe2\x80\x89>\xe2\x80\x890 and an integer t (t\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x890) such that i\xe2\x80\x89+\xe2\x80\x892t\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n. After the values of i and t have been selected, the value of ai is decreased by 1, and the value of ai\xe2\x80\x89+\xe2\x80\x892t is increased by 1. For example, let n\xe2\x80\x89=\xe2\x80\x894 and a\xe2\x80\x89=\xe2\x80\x89(1,\xe2\x80\x890,\xe2\x80\x891,\xe2\x80\x892), then it is possible to make move i\xe2\x80\x89=\xe2\x80\x893, t\xe2\x80\x89=\xe2\x80\x890 and get a\xe2\x80\x89=\xe2\x80\x89(1,\xe2\x80\x890,\xe2\x80\x890,\xe2\x80\x893) or to make move i\xe2\x80\x89=\xe2\x80\x891, t\xe2\x80\x89=\xe2\x80\x891 and get a\xe2\x80\x89=\xe2\x80\x89(0,\xe2\x80\x890,\xe2\x80\x892,\xe2\x80\x892) (the only possible other move is i\xe2\x80\x89=\xe2\x80\x891, t\xe2\x80\x89=\xe2\x80\x890).You are given n and the initial sequence ai. The task is to calculate the minimum number of moves needed to make the first k elements of the original sequence equal to zero for each possible k (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k\xe2\x80\x89<\xe2\x80\x89n)." 1000

177G2 "Fibonacci Strings" matrices,strings "Fibonacci strings are defined as follows:   f1 = \xc2\xaba\xc2\xbb  f2 = \xc2\xabb\xc2\xbb  fn = fn\xe2\x80\x89-\xe2\x80\x891�fn\xe2\x80\x89-\xe2\x80\x892, n\xe2\x80\x89>\xe2\x80\x892 Thus, the first five Fibonacci strings are: ""a"", ""b"", ""ba"", ""bab"", ""babba"".You are given a Fibonacci string and m strings si. For each string si, find the number of times it occurs in the given Fibonacci string as a substring." 2600

177G1 "Fibonacci Strings" strings "Fibonacci strings are defined as follows:   f1 = \xc2\xaba\xc2\xbb  f2 = \xc2\xabb\xc2\xbb  fn = fn\xe2\x80\x89-\xe2\x80\x891�fn\xe2\x80\x89-\xe2\x80\x892, n\xe2\x80\x89>\xe2\x80\x892 Thus, the first five Fibonacci strings are: ""a"", ""b"", ""ba"", ""bab"", ""babba"".You are given a Fibonacci string and m strings si. For each string si, find the number of times it occurs in the given Fibonacci string as a substring." 2400

177F2 "Script Generation" NA "The Smart Beaver from ABBYY was offered a job of a screenwriter for the ongoing TV series. In particular, he needs to automate the hard decision: which main characters will get married by the end of the series.There are n single men and n single women among the main characters. An opinion poll showed that viewers like several couples, and a marriage of any of them will make the audience happy. The Smart Beaver formalized this fact as k triples of numbers (h,\xe2\x80\x89w,\xe2\x80\x89r), where h is the index of the man, w is the index of the woman, and r is the measure of the audience\'s delight in case of the marriage of this couple. The same poll showed that the marriage of any other couple will leave the audience indifferent, so the screenwriters decided not to include any such marriages in the plot.The script allows you to arrange several marriages between the heroes or not to arrange marriages at all. A subset of some of the k marriages is considered acceptable if each man and each woman is involved in at most one marriage of the subset (the series won\'t allow any divorces). The value of the acceptable set of marriages is the total delight the spectators will get from the marriages included in this set.Obviously, there is a finite number of acceptable sets, and they all describe some variants of the script. The screenwriters do not want to choose a set with maximum value \xe2\x80\x94 it would make the plot too predictable. So the Smart Beaver offers the following option: sort all the acceptable sets in increasing order of value and choose the t-th set from the sorted list. Thus, t\xe2\x80\x89=\xe2\x80\x891 corresponds to a plot without marriages, t\xe2\x80\x89=\xe2\x80\x892 \xe2\x80\x94 to a single marriage resulting in minimal delight for the audience, and so on.Help the Beaver to implement the algorithm for selecting the desired set." 2300

177F1 "Script Generation" NA "The Smart Beaver from ABBYY was offered a job of a screenwriter for the ongoing TV series. In particular, he needs to automate the hard decision: which main characters will get married by the end of the series.There are n single men and n single women among the main characters. An opinion poll showed that viewers like several couples, and a marriage of any of them will make the audience happy. The Smart Beaver formalized this fact as k triples of numbers (h,\xe2\x80\x89w,\xe2\x80\x89r), where h is the index of the man, w is the index of the woman, and r is the measure of the audience\'s delight in case of the marriage of this couple. The same poll showed that the marriage of any other couple will leave the audience indifferent, so the screenwriters decided not to include any such marriages in the plot.The script allows you to arrange several marriages between the heroes or not to arrange marriages at all. A subset of some of the k marriages is considered acceptable if each man and each woman is involved in at most one marriage of the subset (the series won\'t allow any divorces). The value of the acceptable set of marriages is the total delight the spectators will get from the marriages included in this set.Obviously, there is a finite number of acceptable sets, and they all describe some variants of the script. The screenwriters do not want to choose a set with maximum value \xe2\x80\x94 it would make the plot too predictable. So the Smart Beaver offers the following option: sort all the acceptable sets in increasing order of value and choose the t-th set from the sorted list. Thus, t\xe2\x80\x89=\xe2\x80\x891 corresponds to a plot without marriages, t\xe2\x80\x89=\xe2\x80\x892 \xe2\x80\x94 to a single marriage resulting in minimal delight for the audience, and so on.Help the Beaver to implement the algorithm for selecting the desired set." 1800

177E2 "Space Voyage" "binary search" "The Smart Beaver from ABBYY plans a space travel on an ultramodern spaceship. During the voyage he plans to visit n planets. For planet i ai is the maximum number of suitcases that an alien tourist is allowed to bring to the planet, and bi is the number of citizens on the planet.The Smart Beaver is going to bring some presents from ABBYY to the planets he will be visiting. The presents are packed in suitcases, x presents in each. The Beaver will take to the ship exactly a1\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89an suitcases.As the Beaver lands on the i-th planet, he takes ai suitcases and goes out. On the first day on the planet the Beaver takes a walk and gets to know the citizens. On the second and all subsequent days the Beaver gives presents to the citizens \xe2\x80\x94 each of the bi citizens gets one present per day. The Beaver leaves the planet in the evening of the day when the number of presents left is strictly less than the number of citizens (i.e. as soon as he won\'t be able to give away the proper number of presents the next day). He leaves the remaining presents at the hotel.The Beaver is going to spend exactly c days traveling. The time spent on flights between the planets is considered to be zero. In how many ways can one choose the positive integer x so that the planned voyage will take exactly c days?" 1900

177E1 "Space Voyage" "binary search" "The Smart Beaver from ABBYY plans a space travel on an ultramodern spaceship. During the voyage he plans to visit n planets. For planet i ai is the maximum number of suitcases that an alien tourist is allowed to bring to the planet, and bi is the number of citizens on the planet.The Smart Beaver is going to bring some presents from ABBYY to the planets he will be visiting. The presents are packed in suitcases, x presents in each. The Beaver will take to the ship exactly a1\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89an suitcases.As the Beaver lands on the i-th planet, he takes ai suitcases and goes out. On the first day on the planet the Beaver takes a walk and gets to know the citizens. On the second and all subsequent days the Beaver gives presents to the citizens \xe2\x80\x94 each of the bi citizens gets one present per day. The Beaver leaves the planet in the evening of the day when the number of presents left is strictly less than the number of citizens (i.e. as soon as he won\'t be able to give away the proper number of presents the next day). He leaves the remaining presents at the hotel.The Beaver is going to spend exactly c days traveling. The time spent on flights between the planets is considered to be zero. In how many ways can one choose the positive integer x so that the planned voyage will take exactly c days?" 1700

177D2 "Encrypting Messages" "data structures" "The Smart Beaver from ABBYY invented a new message encryption method and now wants to check its performance. Checking it manually is long and tiresome, so he decided to ask the ABBYY Cup contestants for help.A message is a sequence of n integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. Encryption uses a key which is a sequence of m integers b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bm (m\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n). All numbers from the message and from the key belong to the interval from 0 to c\xe2\x80\x89-\xe2\x80\x891, inclusive, and all the calculations are performed modulo c.Encryption is performed in n\xe2\x80\x89-\xe2\x80\x89m\xe2\x80\x89+\xe2\x80\x891 steps. On the first step we add to each number a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89am a corresponding number b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bm. On the second step we add to each number a2,\xe2\x80\x89a3,\xe2\x80\x89...,\xe2\x80\x89am\xe2\x80\x89+\xe2\x80\x891 (changed on the previous step) a corresponding number b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bm. And so on: on step number i we add to each number ai,\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x89m\xe2\x80\x89-\xe2\x80\x891 a corresponding number b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bm. The result of the encryption is the sequence a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an after n\xe2\x80\x89-\xe2\x80\x89m\xe2\x80\x89+\xe2\x80\x891 steps.Help the Beaver to write a program that will encrypt messages in the described manner." 1500

177D1 "Encrypting Messages" "brute force" "The Smart Beaver from ABBYY invented a new message encryption method and now wants to check its performance. Checking it manually is long and tiresome, so he decided to ask the ABBYY Cup contestants for help.A message is a sequence of n integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. Encryption uses a key which is a sequence of m integers b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bm (m\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n). All numbers from the message and from the key belong to the interval from 0 to c\xe2\x80\x89-\xe2\x80\x891, inclusive, and all the calculations are performed modulo c.Encryption is performed in n\xe2\x80\x89-\xe2\x80\x89m\xe2\x80\x89+\xe2\x80\x891 steps. On the first step we add to each number a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89am a corresponding number b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bm. On the second step we add to each number a2,\xe2\x80\x89a3,\xe2\x80\x89...,\xe2\x80\x89am\xe2\x80\x89+\xe2\x80\x891 (changed on the previous step) a corresponding number b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bm. And so on: on step number i we add to each number ai,\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x89m\xe2\x80\x89-\xe2\x80\x891 a corresponding number b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bm. The result of the encryption is the sequence a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an after n\xe2\x80\x89-\xe2\x80\x89m\xe2\x80\x89+\xe2\x80\x891 steps.Help the Beaver to write a program that will encrypt messages in the described manner." 1200

177C2 Party "brute force,dfs and similar,dsu,graphs" "To celebrate the second ABBYY Cup tournament, the Smart Beaver decided to throw a party. The Beaver has a lot of acquaintances, some of them are friends with each other, and some of them dislike each other. To make party successful, the Smart Beaver wants to invite only those of his friends who are connected by friendship relations, and not to invite those who dislike each other. Both friendship and dislike are mutual feelings.More formally, for each invited person the following conditions should be fulfilled:   all his friends should also be invited to the party;  the party shouldn\'t have any people he dislikes;  all people who are invited to the party should be connected with him by friendship either directly or through a chain of common friends of arbitrary length. We\'ll say that people a1 and ap are connected through a chain of common friends if there exists a sequence of people a2,\xe2\x80\x89a3,\xe2\x80\x89...,\xe2\x80\x89ap\xe2\x80\x89-\xe2\x80\x891 such that all pairs of people ai and ai\xe2\x80\x89+\xe2\x80\x891 (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89p) are friends. Help the Beaver find the maximum number of acquaintances he can invite." 1500

177C1 Party "dfs and similar,dsu,graphs" "To celebrate the second ABBYY Cup tournament, the Smart Beaver decided to throw a party. The Beaver has a lot of acquaintances, some of them are friends with each other, and some of them dislike each other. To make party successful, the Smart Beaver wants to invite only those of his friends who are connected by friendship relations, and not to invite those who dislike each other. Both friendship and dislike are mutual feelings.More formally, for each invited person the following conditions should be fulfilled:   all his friends should also be invited to the party;  the party shouldn\'t have any people he dislikes;  all people who are invited to the party should be connected with him by friendship either directly or through a chain of common friends of arbitrary length. We\'ll say that people a1 and ap are connected through a chain of common friends if there exists a sequence of people a2,\xe2\x80\x89a3,\xe2\x80\x89...,\xe2\x80\x89ap\xe2\x80\x89-\xe2\x80\x891 such that all pairs of people ai and ai\xe2\x80\x89+\xe2\x80\x891 (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89p) are friends. Help the Beaver find the maximum number of acquaintances he can invite." 1500

177B2 "Rectangular Game" "number theory" "The Smart Beaver from ABBYY decided to have a day off. But doing nothing the whole day turned out to be too boring, and he decided to play a game with pebbles. Initially, the Beaver has n pebbles. He arranges them in a equal rows, each row has b pebbles (a\xe2\x80\x89>\xe2\x80\x891). Note that the Beaver must use all the pebbles he has, i. e. n\xe2\x80\x89=\xe2\x80\x89a\xc2\xb7b.   10 pebbles are arranged in two rows, each row has 5 pebbles  Once the Smart Beaver has arranged the pebbles, he takes back any of the resulting rows (that is, b pebbles) and discards all other pebbles. Then he arranges all his pebbles again (possibly choosing other values of a and b) and takes back one row, and so on. The game continues until at some point the Beaver ends up with exactly one pebble. The game process can be represented as a finite sequence of integers c1,\xe2\x80\x89...,\xe2\x80\x89ck, where:   c1\xe2\x80\x89=\xe2\x80\x89n  ci\xe2\x80\x89+\xe2\x80\x891 is the number of pebbles that the Beaver ends up with after the i-th move, that is, the number of pebbles in a row after some arrangement of ci pebbles (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89k). Note that ci\xe2\x80\x89>\xe2\x80\x89ci\xe2\x80\x89+\xe2\x80\x891.  ck\xe2\x80\x89=\xe2\x80\x891 The result of the game is the sum of numbers ci. You are given n. Find the maximum possible result of the game." 1200

177B1 "Rectangular Game" "number theory" "The Smart Beaver from ABBYY decided to have a day off. But doing nothing the whole day turned out to be too boring, and he decided to play a game with pebbles. Initially, the Beaver has n pebbles. He arranges them in a equal rows, each row has b pebbles (a\xe2\x80\x89>\xe2\x80\x891). Note that the Beaver must use all the pebbles he has, i. e. n\xe2\x80\x89=\xe2\x80\x89a\xc2\xb7b.   10 pebbles are arranged in two rows, each row has 5 pebbles  Once the Smart Beaver has arranged the pebbles, he takes back any of the resulting rows (that is, b pebbles) and discards all other pebbles. Then he arranges all his pebbles again (possibly choosing other values of a and b) and takes back one row, and so on. The game continues until at some point the Beaver ends up with exactly one pebble. The game process can be represented as a finite sequence of integers c1,\xe2\x80\x89...,\xe2\x80\x89ck, where:   c1\xe2\x80\x89=\xe2\x80\x89n  ci\xe2\x80\x89+\xe2\x80\x891 is the number of pebbles that the Beaver ends up with after the i-th move, that is, the number of pebbles in a row after some arrangement of ci pebbles (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89k). Note that ci\xe2\x80\x89>\xe2\x80\x89ci\xe2\x80\x89+\xe2\x80\x891.  ck\xe2\x80\x89=\xe2\x80\x891 The result of the game is the sum of numbers ci. You are given n. Find the maximum possible result of the game." 1000

177A2 "Good Matrix Elements" implementation "The Smart Beaver from ABBYY got hooked on square matrices. Now he is busy studying an n\xe2\x80\x89\xc3\x97\xe2\x80\x89n size matrix, where n is odd. The Smart Beaver considers the following matrix elements good:    Elements of the main diagonal.   Elements of the secondary diagonal.   Elements of the ""middle"" row \xe2\x80\x94 the row which has exactly  rows above it and the same number of rows below it.   Elements of the ""middle"" column \xe2\x80\x94 the column that has exactly  columns to the left of it and the same number of columns to the right of it.    The figure shows a 5\xe2\x80\x89\xc3\x97\xe2\x80\x895 matrix.   The good elements are marked with green.  Help the Smart Beaver count the sum of good elements of the given matrix." 800

177A1 "Good Matrix Elements" implementation "The Smart Beaver from ABBYY got hooked on square matrices. Now he is busy studying an n\xe2\x80\x89\xc3\x97\xe2\x80\x89n size matrix, where n is odd. The Smart Beaver considers the following matrix elements good:    Elements of the main diagonal.   Elements of the secondary diagonal.   Elements of the ""middle"" row \xe2\x80\x94 the row which has exactly  rows above it and the same number of rows below it.   Elements of the ""middle"" column \xe2\x80\x94 the column that has exactly  columns to the left of it and the same number of columns to the right of it.    The figure shows a 5\xe2\x80\x89\xc3\x97\xe2\x80\x895 matrix.   The good elements are marked with green.  Help the Smart Beaver count the sum of good elements of the given matrix." 800

176E Archaeology "data structures,dfs and similar,trees" "This time you should help a team of researchers on an island in the Pacific Ocean. They research the culture of the ancient tribes that used to inhabit the island many years ago.Overall they\'ve dug out n villages. Some pairs of villages were connected by roads. People could go on the roads in both directions. Overall there were exactly n\xe2\x80\x89-\xe2\x80\x891 roads, and from any village one could get to any other one.The tribes were not peaceful, and they had many wars. As a result of the wars, some villages were completely destroyed. During more peaceful years, some of the villages were restored.At each moment of time, people used only those roads that belonged to some shortest way between two villages that existed at the given moment. In other words, people used the minimum subset of roads in such a way that it was possible to get from any existing village to any other existing one. Note that throughout the island\'s whole history, there existed exactly n\xe2\x80\x89-\xe2\x80\x891 roads that have been found by the researchers. There never were any other roads.The researchers think that observing the total sum of used roads\' lengths at different moments of time can help to better understand the tribes\' culture and answer several historical questions.You will be given the full history of the tribes\' existence. Your task is to determine the total length of used roads at some moments of time." 3100

176D "Hyper String" dp "Paul Erd\xc5\x91s\'s prediction came true. Finally an alien force landed on the Earth. In contrary to our expectation they didn\'t asked the humans to compute the value of a Ramsey number (maybe they had solved it themselves). They asked another question which seemed as hard as calculating Ramsey numbers. Aliens threatened that if humans don\'t solve this problem in less than 2 hours they will destroy the Earth. Before telling the problem they introduced the concept of Hyper Strings. A Hyper String is made by concatenation of some base strings. Suppose you are given a list of base strings b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bn. Now the Hyper String made from indices list i1,\xe2\x80\x89i2,\xe2\x80\x89...,\xe2\x80\x89im is concatenation of base strings bi1,\xe2\x80\x89bi2,\xe2\x80\x89...,\xe2\x80\x89bim. A Hyper String can be very large and doing operations on it is very costly for computers. The aliens asked humans to compute the length of the longest common sub-sequence of a Hyper String t with a string s." 2500

176C "Playing with Superglue" "combinatorics,constructive algorithms" "Two players play a game. The game is played on a rectangular board with n\xe2\x80\x89\xc3\x97\xe2\x80\x89m squares. At the beginning of the game two different squares of the board have two chips. The first player\'s goal is to shift the chips to the same square. The second player aims to stop the first one with a tube of superglue.We\'ll describe the rules of the game in more detail.The players move in turns. The first player begins.With every move the first player chooses one of his unglued chips, and shifts it one square to the left, to the right, up or down. It is not allowed to move a chip beyond the board edge. At the beginning of a turn some squares of the board may be covered with a glue. The first player can move the chip to such square, in this case the chip gets tightly glued and cannot move any longer.At each move the second player selects one of the free squares (which do not contain a chip or a glue) and covers it with superglue. The glue dries long and squares covered with it remain sticky up to the end of the game.If, after some move of the first player both chips are in the same square, then the first player wins. If the first player cannot make a move (both of his chips are glued), then the second player wins. Note that the situation where the second player cannot make a move is impossible \xe2\x80\x94 he can always spread the glue on the square from which the first player has just moved the chip.We will further clarify the case where both chips are glued and are in the same square. In this case the first player wins as the game ends as soon as both chips are in the same square, and the condition of the loss (the inability to move) does not arise.You know the board sizes and the positions of the two chips on it. At the beginning of the game all board squares are glue-free. Find out who wins if the players play optimally." 2000

176B "Word Cut" dp "Let\'s consider one interesting word game. In this game you should transform one word into another through special operations. Let\'s say we have word w, let\'s split this word into two non-empty parts x and y so, that w\xe2\x80\x89=\xe2\x80\x89xy. A split operation is transforming word w\xe2\x80\x89=\xe2\x80\x89xy into word u\xe2\x80\x89=\xe2\x80\x89yx. For example, a split operation can transform word ""wordcut"" into word ""cutword"".You are given two words start and end. Count in how many ways we can transform word start into word end, if we apply exactly k split operations consecutively to word start. Two ways are considered different if the sequences of applied operations differ. Two operation sequences are different if exists such number i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k), that in the i-th operation of the first sequence the word splits into parts x and y, in the i-th operation of the second sequence the word splits into parts a and b, and additionally x\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89a holds." 1700

176A "Trading Business" greedy,sortings "To get money for a new aeonic blaster, ranger Qwerty decided to engage in trade for a while. He wants to buy some number of items (or probably not to buy anything at all) on one of the planets, and then sell the bought items on another planet. Note that this operation is not repeated, that is, the buying and the selling are made only once. To carry out his plan, Qwerty is going to take a bank loan that covers all expenses and to return the loaned money at the end of the operation (the money is returned without the interest). At the same time, Querty wants to get as much profit as possible.The system has n planets in total. On each of them Qwerty can buy or sell items of m types (such as food, medicine, weapons, alcohol, and so on). For each planet i and each type of items j Qwerty knows the following: aij \xe2\x80\x94 the cost of buying an item;  bij \xe2\x80\x94 the cost of selling an item;  cij \xe2\x80\x94 the number of remaining items.It is not allowed to buy more than cij items of type j on planet i, but it is allowed to sell any number of items of any kind.Knowing that the hold of Qwerty\'s ship has room for no more than k items, determine the maximum profit which Qwerty can get." 1200

175F "Gnomes of Might and Magic" "data structures,graphs,implementation,shortest paths" "Vasya plays a popular game the Gnomes of Might and Magic.In this game Vasya manages the kingdom of gnomes, consisting of several castles, connected by bidirectional roads. The kingdom road network has a special form. The kingdom has m main castles a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89am, which form the Good Path. This path consists of roads between the castles ai,\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x891 (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89m) as well as the road between am and a1. There are no other roads between the castles of the Good Path.In addition, for each pair of neighboring Good Path castles u and v there is exactly one Evil Shortcut \xe2\x80\x94 a path that goes along the roads leading from the first castle (u) to the second one (v) and not having any common vertexes with the Good Path except for the vertexes u and v. It is known that there are no other roads and castles in the kingdom there, that is, every road and every castle lies either on the Good Path or the Evil Shortcut (castles can lie in both of them). In addition, no two Evil Shortcuts have any common castles, different than the castles of the Good Path.At the beginning of each week in the kingdom appears one very bad gnome who stands on one of the roads of the kingdom, and begins to rob the corovans going through this road. One road may accumulate multiple very bad gnomes. Vasya cares about his corovans, so sometimes he sends the Mission of Death from one castle to another.Let\'s suggest that the Mission of Death should get from castle s to castle t. Then it will move from castle s to castle t, destroying all very bad gnomes, which are on the roads of the Mission\'s path. Vasya is so tough that his Mission of Death can destroy any number of gnomes on its way. However, Vasya is very kind, so he always chooses such path between castles s and t, following which he will destroy the smallest number of gnomes. If there are multiple such paths, then Vasya chooses the path that contains the smallest number of roads among them. If there are multiple such paths still, Vasya chooses the lexicographically minimal one among them.Help Vasya to simulate the life of the kingdom in the Gnomes of Might and Magic game.A path is a sequence of castles, such that each pair of the neighboring castles on the path is connected by a road. Also, path x1,\xe2\x80\x89x2,\xe2\x80\x89... ,\xe2\x80\x89xp is lexicographically less than path y1,\xe2\x80\x89y2,\xe2\x80\x89... ,\xe2\x80\x89yq, if either p\xe2\x80\x89<\xe2\x80\x89q and x1\xe2\x80\x89=\xe2\x80\x89y1,\xe2\x80\x89x2\xe2\x80\x89=\xe2\x80\x89y2,\xe2\x80\x89... ,\xe2\x80\x89xp\xe2\x80\x89=\xe2\x80\x89yp, or exists such number r (r\xe2\x80\x89<\xe2\x80\x89p,\xe2\x80\x89r\xe2\x80\x89<\xe2\x80\x89q), that x1\xe2\x80\x89=\xe2\x80\x89y1,\xe2\x80\x89x2\xe2\x80\x89=\xe2\x80\x89y2,\xe2\x80\x89... ,\xe2\x80\x89xr\xe2\x80\x89=\xe2\x80\x89yr and xr\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89<\xe2\x80\x89yr\xe2\x80\x89+\xe2\x80\x891." 3000

175E "Power Defence" "brute force,dp,geometry,greedy" "Vasya plays the Power Defence. He must pass the last level of the game. In order to do this he must kill the Main Villain, who moves in a straight line at speed 1 meter per second from the point (\xe2\x80\x89-\xe2\x80\x89\xe2\x88\x9e,\xe2\x80\x890) to the point (\xe2\x80\x89+\xe2\x80\x89\xe2\x88\x9e,\xe2\x80\x890) of the game world. In the points (x,\xe2\x80\x891) and (x,\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x891), where x is an integer number, Vasya can build towers of three types: fire-tower, electric-tower or freezing-tower. However, it is not allowed to build two towers at the same point. Towers of each type have a certain action radius and the value of damage per second (except freezing-tower). If at some point the Main Villain is in the range of action of k freezing towers then his speed is decreased by k\xe2\x80\x89+\xe2\x80\x891 times.The allowed number of towers of each type is known. It is necessary to determine the maximum possible damage we can inflict on the Main Villain.All distances in the problem are given in meters. The size of the Main Villain and the towers are so small, that they can be considered as points on the plane. The Main Villain is in the action radius of a tower if the distance between him and tower is less than or equal to the action radius of the tower." 2600

175D "Plane of Tanks: Duel" "brute force,dp,math,probabilities" "Vasya plays the Plane of Tanks.Tanks are described with the following attributes:   the number of hit points;  the interval between two gun shots (the time required to recharge the gun);  the probability that the gun shot will not pierce armor of the enemy tank;  the damage to the enemy\'s tank. The gun damage is described with a segment [l,\xe2\x80\x89r], where l and r are integer numbers. The potential gun damage x is chosen with equal probability among all integer numbers of the segment [l,\xe2\x80\x89r]. If the shot pierces the armor of an enemy\'s tank then the enemy loses x hit points. If the number of hit points becomes non-positive then the enemy tank is considered destroyed. It is possible that the shot does not pierce the armor of a tank. In this case the number of hit points doesn\'t change. The probability that the armor will not be pierced is considered as the shooting tank attribute and does not depend on players\' behavior.The victory is near and there is only one enemy tank left. Vasya is ready for the battle \xe2\x80\x94 one more battle between the Good and the Evil is inevitable! Two enemies saw each other and each of them fired a shot at the same moment... The last battle has begun! Help Vasya to determine what is the probability that he will win the battle by destroying the enemy tank? If both tanks are destroyed (after simultaneous shots), then Vasya is considered a winner. You can assume that each player fires a shot just after the gun recharge and each tank has infinite number of ammo." 2400

175C "Geometry Horse" "greedy,implementation,sortings,two pointers" "Vasya plays the Geometry Horse.The game goal is to destroy geometric figures of the game world. A certain number of points is given for destroying each figure depending on the figure type and the current factor value. There are n types of geometric figures. The number of figures of type ki and figure cost ci is known for each figure type. A player gets ci\xc2\xb7f  points for destroying one figure of type i, where f is the current factor. The factor value can be an integer number from 1 to t\xe2\x80\x89+\xe2\x80\x891, inclusive. At the beginning of the game the factor value is equal to 1. The factor is set to i\xe2\x80\x89+\xe2\x80\x891 after destruction of pi (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89t) figures, so the (pi\xe2\x80\x89+\xe2\x80\x891)-th figure to be destroyed is considered with factor equal to i\xe2\x80\x89+\xe2\x80\x891.Your task is to determine the maximum number of points Vasya can get after he destroys all figures. Take into account that Vasya is so tough that he can destroy figures in any order chosen by him." 1600

175B "Plane of Tanks: Pro" implementation "Vasya has been playing Plane of Tanks with his friends the whole year. Now it is time to divide the participants into several categories depending on their results. A player is given a non-negative integer number of points in each round of the Plane of Tanks. Vasya wrote results for each round of the last year. He has n records in total.In order to determine a player\'s category consider the best result obtained by the player and the best results of other players. The player belongs to category:   ""noob"" \xe2\x80\x94 if more than 50% of players have better results;  ""random"" \xe2\x80\x94 if his result is not worse than the result that 50% of players have, but more than 20% of players have better results;  ""average"" \xe2\x80\x94 if his result is not worse than the result that 80% of players have, but more than 10% of players have better results;  ""hardcore"" \xe2\x80\x94 if his result is not worse than the result that 90% of players have, but more than 1% of players have better results;  ""pro"" \xe2\x80\x94 if his result is not worse than the result that 99% of players have.  When the percentage is calculated the player himself is taken into account. That means that if two players played the game and the first one gained 100 points and the second one 1000 points, then the first player\'s result is not worse than the result that 50% of players have, and the second one is not worse than the result that 100% of players have.Vasya gave you the last year Plane of Tanks results. Help Vasya determine each player\'s category." 1400

175A "Robot Bicorn Attack" "brute force,implementation" "Vasya plays Robot Bicorn Attack.The game consists of three rounds. For each one a non-negative integer amount of points is given. The result of the game is the sum of obtained points. Vasya has already played three rounds and wrote obtained points one by one (without leading zeros) into the string s. Vasya decided to brag about his achievement to the friends. However, he has forgotten how many points he got for each round. The only thing he remembers is the string s.Help Vasya to find out what is the maximum amount of points he could get. Take into account that Vasya played Robot Bicorn Attack for the first time, so he could not get more than 1000000 (106) points for one round." 1400

174C "Range Increments" "data structures,greedy" "Polycarpus is an amateur programmer. Now he is analyzing a friend\'s program. He has already found there the function rangeIncrement(l, r), that adds 1 to each element of some array a for all indexes in the segment [l,\xe2\x80\x89r]. In other words, this function does the following: function rangeIncrement(l, r)    for i := l .. r do        a[i] = a[i] + 1Polycarpus knows the state of the array a after a series of function calls. He wants to determine the minimum number of function calls that lead to such state. In addition, he wants to find what function calls are needed in this case. It is guaranteed that the required number of calls does not exceed 105.Before calls of function rangeIncrement(l, r) all array elements equal zero." 1800

174B "File List" dp,greedy,implementation "Eudokimus, a system administrator is in trouble again. As a result of an error in some script, a list of names of very important files has been damaged. Since they were files in the BerFS file system, it is known that each file name has a form ""name.ext"", where:   name is a string consisting of lowercase Latin letters, its length is from 1 to 8 characters;  ext is a string consisting of lowercase Latin letters, its length is from 1 to 3 characters. For example, ""read.me"", ""example.txt"" and ""b.cpp"" are valid file names and ""version.info"", ""ntldr"" and ""contestdata.zip"" are not.Damage to the list meant that all the file names were recorded one after another, without any separators. So now Eudokimus has a single string.Eudokimus needs to set everything right as soon as possible. He should divide the resulting string into parts so that each part would be a valid file name in BerFS. Since Eudokimus has already proved that he is not good at programming, help him. The resulting file list can contain the same file names." 1400

174A "Problem About Equation" math "A group of n merry programmers celebrate Robert Floyd\'s birthday. Polucarpus has got an honourable task of pouring Ber-Cola to everybody. Pouring the same amount of Ber-Cola to everybody is really important. In other words, the drink\'s volume in each of the n mugs must be the same.Polycarpus has already began the process and he partially emptied the Ber-Cola bottle. Now the first mug has a1 milliliters of the drink, the second one has a2 milliliters and so on. The bottle has b milliliters left and Polycarpus plans to pour them into the mugs so that the main equation was fulfilled.Write a program that would determine what volume of the drink Polycarpus needs to add into each mug to ensure that the following two conditions were fulfilled simultaneously:   there were b milliliters poured in total. That is, the bottle need to be emptied;  after the process is over, the volumes of the drink in the mugs should be equal." 1100

173E "Camping Groups" "data structures,sortings" "A club wants to take its members camping. In order to organize the event better the club directors decided to partition the members into several groups. Club member i has a responsibility value ri and an age value ai. A group is a non-empty subset of club members with one member known as group leader. A group leader should be one of the most responsible members of the group (his responsibility value is not less than responsibility of any other group member) and his age absolute difference with any other group member should not exceed k. Some club members are friends and want to be in the same group. They also like their group to be as large as possible. Now you should write a program that answers a series of questions like ""What\'s the largest size of a group containing club member x and club member y?"". It\'s possible for x or y to be the group leader." 2600

173D Deputies "constructive algorithms,graphs,greedy,implementation" "The Trinitarian kingdom has exactly n\xe2\x80\x89=\xe2\x80\x893k cities. All of them are located on the shores of river Trissisipi, which flows through the whole kingdom. Some of the cities are located on one side of the river, and all the rest are on the other side.Some cities are connected by bridges built between them. Each bridge connects two cities that are located on the opposite sides of the river. Between any two cities exists no more than one bridge.The recently inaugurated King Tristan the Third is busy distributing his deputies among cities. In total there are k deputies and the king wants to commission each of them to control exactly three cities. However, no deputy can be entrusted to manage the cities, which are connected by a bridge \xe2\x80\x94 the deputy can set a too high fee for travelling over the bridge to benefit his pocket, which is bad for the reputation of the king.Help King Tristan the Third distribute the deputies between the cities, if it is possible." 2500

173C "Spiral Maximum" "brute force,dp" "Let\'s consider a k\xe2\x80\x89\xc3\x97\xe2\x80\x89k square, divided into unit squares. Please note that k\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x893 and is odd. We\'ll paint squares starting from the upper left square in the following order: first we move to the right, then down, then to the left, then up, then to the right again and so on. We finish moving in some direction in one of two cases: either we\'ve reached the square\'s border or the square following after the next square is already painted. We finish painting at the moment when we cannot move in any direction and paint a square. The figure that consists of the painted squares is a spiral.   The figure shows examples of spirals for k\xe2\x80\x89=\xe2\x80\x893,\xe2\x80\x895,\xe2\x80\x897,\xe2\x80\x899.  You have an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m table, each of its cells contains a number. Let\'s consider all possible spirals, formed by the table cells. It means that we consider all spirals of any size that don\'t go beyond the borders of the table. Let\'s find the sum of the numbers of the cells that form the spiral. You have to find the maximum of those values among all spirals." 1900

173B "Chamber of Secrets" "dfs and similar,shortest paths" """The Chamber of Secrets has been opened again"" \xe2\x80\x94 this news has spread all around Hogwarts and some of the students have been petrified due to seeing the basilisk. Dumbledore got fired and now Harry is trying to enter the Chamber of Secrets. These aren\'t good news for Lord Voldemort. The problem is, he doesn\'t want anybody to be able to enter the chamber. The Dark Lord is going to be busy sucking life out of Ginny.The Chamber of Secrets is an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m rectangular grid in which some of the cells are columns. A light ray (and a basilisk\'s gaze) passes through the columns without changing its direction. But with some spell we can make a column magic to reflect the light ray (or the gaze) in all four directions when it receives the ray. This is shown in the figure below.   The left light ray passes through a regular column, and the right ray \xe2\x80\x94 through the magic column.  The basilisk is located at the right side of the lower right cell of the grid and is looking to the left (in the direction of the lower left cell). According to the legend, anyone who meets a basilisk\'s gaze directly dies immediately. But if someone meets a basilisk\'s gaze through a column, this person will get petrified. We know that the door to the Chamber is located on the left side of the upper left corner of the grid and anyone who wants to enter will look in the direction of its movement (in the direction of the upper right cell) from that position.   This figure illustrates the first sample test.  Given the dimensions of the chamber and the location of regular columns, Lord Voldemort has asked you to find the minimum number of columns that we need to make magic so that anyone who wants to enter the chamber would be petrified or just declare that it\'s impossible to secure the chamber." 1800

173A Rock-Paper-Scissors implementation,math "Nikephoros and Polycarpus play rock-paper-scissors. The loser gets pinched (not too severely!).Let us remind you the rules of this game. Rock-paper-scissors is played by two players. In each round the players choose one of three items independently from each other. They show the items with their hands: a rock, scissors or paper. The winner is determined by the following rules: the rock beats the scissors, the scissors beat the paper and the paper beats the rock. If the players choose the same item, the round finishes with a draw.Nikephoros and Polycarpus have played n rounds. In each round the winner gave the loser a friendly pinch and the loser ended up with a fresh and new red spot on his body. If the round finished in a draw, the players did nothing and just played on.Nikephoros turned out to have worked out the following strategy: before the game began, he chose some sequence of items A\xe2\x80\x89=\xe2\x80\x89(a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89am), and then he cyclically showed the items from this sequence, starting from the first one. Cyclically means that Nikephoros shows signs in the following order: a1, a2, ..., am, a1, a2, ..., am, a1, ... and so on. Polycarpus had a similar strategy, only he had his own sequence of items B\xe2\x80\x89=\xe2\x80\x89(b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bk).Determine the number of red spots on both players after they\'ve played n rounds of the game. You can consider that when the game began, the boys had no red spots on them." 1300

172E BHTML+BCSS "*special problem,dfs and similar,expression parsing" "This problem is about imaginary languages BHTML and BCSS, which slightly resemble HTML and CSS. Read the problem statement carefully as the resemblance is rather slight and the problem uses very simplified analogs.You are given a BHTML document that resembles HTML but is much simpler. It is recorded as a sequence of opening and closing tags. A tag that looks like ""<tagname>"" is called an opening tag and a tag that looks like ""</tagname>"" is called a closing tag. Besides, there are self-closing tags that are written as ""<tagname/>"" and in this problem they are fully equivalent to ""<tagname></tagname>"". All tagnames in this problem are strings consisting of lowercase Latin letters with length from 1 to 10 characters. Tagnames of different tags may coincide.The document tags form a correct bracket sequence, that is, we can obtain an empty sequence from the given one using the following operations:   remove any self-closing tag ""<tagname/>"",  remove a pair of an opening and a closing tag that go consecutively (in this order) and have the same names. In other words, remove substring ""<tagname></tagname>"". For example, you may be given such document: ""<header><p><a/><b></b></p></header><footer></footer>"" but you may not be given documents ""<a>"", ""<a></b>"", ""</a><a>"" or ""<a><b></a></b>"".Obviously, for any opening tag there is the only matching closing one \xe2\x80\x94 each such pair is called an element. A self-closing tag also is an element. Let\'s consider that one element is nested inside another one, if tags of the first element are between tags of the second one. An element is not nested to itself. For instance, in the example above element ""b"" is nested in ""header"" and in ""p"", but it isn\'t nested in ""a"" and ""footer"", also it isn\'t nested to itself (""b""). Element ""header"" has three elements nested in it, and ""footer"" has zero.We need the BCSS rules to apply styles when displaying elements of the BHTML documents. Each rule is recorded as a subsequence of words ""x1 x2 ... xn"". This rule has effect over all such elements t, which satisfy both conditions from the list:  there is a sequence of nested elements with tagnames ""x1"", ""x2"", ..., ""xn"" (that is, the second element is nested in the first one, the third element is nested in the second one and so on),  this sequence ends with element t (i.e. tagname of element t equals ""xn""). For example, element ""b"" meets the conditions of the rule ""a b"" if for element ""b"" exists element ""a"" in which it is nested. Element ""c"" meets the conditions of the rule ""a b b c"", if three elements exist: ""a"", ""b"", ""b"", and in the chain ""a""-""b""-""b""-""c"" each following element is nested in the previous one.Given a BHTML document and a set of BCSS rules, write a program that determines the number of elements that meet the conditions of each rule." 2200

172D "Calendar Reform" "*special problem,number theory" "Reforms have started in Berland again! At this time, the Parliament is discussing the reform of the calendar. To make the lives of citizens of Berland more varied, it was decided to change the calendar. As more and more people are complaining that ""the years fly by..."", it was decided that starting from the next year the number of days per year will begin to grow. So the coming year will have exactly a days, the next after coming year will have a\xe2\x80\x89+\xe2\x80\x891 days, the next one will have a\xe2\x80\x89+\xe2\x80\x892 days and so on. This schedule is planned for the coming n years (in the n-th year the length of the year will be equal a\xe2\x80\x89+\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x891 day).No one has yet decided what will become of months. An MP Palevny made the following proposal.   The calendar for each month is comfortable to be printed on a square sheet of paper. We are proposed to make the number of days in each month be the square of some integer. The number of days per month should be the same for each month of any year, but may be different for different years.  The number of days in each year must be divisible by the number of days per month in this year. This rule ensures that the number of months in each year is an integer.  The number of days per month for each year must be chosen so as to save the maximum amount of paper to print the calendars. In other words, the number of days per month should be as much as possible. These rules provide an unambiguous method for choosing the number of days in each month for any given year length. For example, according to Palevny\'s proposition, a year that consists of 108 days will have three months, 36 days each. The year that consists of 99 days will have 11 months, 9 days each, and a year of 365 days will have 365 months, one day each.The proposal provoked heated discussion in the community, the famous mathematician Perelmanov quickly calculated that if the proposal is supported, then in a period of n years, beginning with the year that has a days, the country will spend p sheets of paper to print a set of calendars for these years. Perelmanov\'s calculations take into account the fact that the set will contain one calendar for each year and each month will be printed on a separate sheet.Repeat Perelmanov\'s achievement and print the required number p. You are given positive integers a and n. Perelmanov warns you that your program should not work longer than four seconds at the maximum test." 1500

172C Bus "*special problem,implementation,sortings" "There is a bus stop near the university. The lessons are over, and n students come to the stop. The i-th student will appear at the bus stop at time ti (all ti\'s are distinct).We shall assume that the stop is located on the coordinate axis Ox, at point x\xe2\x80\x89=\xe2\x80\x890, and the bus goes along the ray Ox, that is, towards the positive direction of the coordinate axis, and back. The i-th student needs to get to the point with coordinate xi (xi\xe2\x80\x89>\xe2\x80\x890).The bus moves by the following algorithm. Initially it is at point 0. The students consistently come to the stop and get on it. The bus has a seating capacity which is equal to m passengers. At the moment when m students get on the bus, it starts moving in the positive direction of the coordinate axis. Also it starts moving when the last (n-th) student gets on the bus. The bus is moving at a speed of 1 unit of distance per 1 unit of time, i.e. it covers distance y in time y.Every time the bus passes the point at which at least one student needs to get off, it stops and these students get off the bus. The students need 1\xe2\x80\x89+\xe2\x80\x89[k\xe2\x80\x89/\xe2\x80\x892] units of time to get off the bus, where k is the number of students who leave at this point. Expression [k\xe2\x80\x89/\xe2\x80\x892] denotes rounded down k\xe2\x80\x89/\xe2\x80\x892. As soon as the last student leaves the bus, the bus turns around and goes back to the point x\xe2\x80\x89=\xe2\x80\x890. It doesn\'t make any stops until it reaches the point. At the given point the bus fills with students once more, and everything is repeated.If students come to the stop when there\'s no bus, they form a line (queue) and get on the bus in the order in which they came. Any number of students get on the bus in negligible time, you should assume that it doesn\'t take any time. Any other actions also take no time. The bus has no other passengers apart from the students.Write a program that will determine for each student the time when he got off the bus. The moment a student got off the bus is the moment the bus stopped at the student\'s destination stop (despite the fact that the group of students need some time to get off)." 1500

172B "Pseudorandom Sequence Period" "*special problem,implementation,number theory" "Polycarpus has recently got interested in sequences of pseudorandom numbers. He learned that many programming languages generate such sequences in a similar way:  (for i\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x891). Here a, b, m are constants, fixed for the given realization of the pseudorandom numbers generator, r0 is the so-called randseed (this value can be set from the program using functions like RandSeed(r) or srand(n)), and  denotes the operation of taking the remainder of division.For example, if a\xe2\x80\x89=\xe2\x80\x892,\xe2\x80\x89b\xe2\x80\x89=\xe2\x80\x896,\xe2\x80\x89m\xe2\x80\x89=\xe2\x80\x8912,\xe2\x80\x89r0\xe2\x80\x89=\xe2\x80\x8911, the generated sequence will be: 4,\xe2\x80\x892,\xe2\x80\x8910,\xe2\x80\x892,\xe2\x80\x8910,\xe2\x80\x892,\xe2\x80\x8910,\xe2\x80\x892,\xe2\x80\x8910,\xe2\x80\x892,\xe2\x80\x8910,\xe2\x80\x89....Polycarpus realized that any such sequence will sooner or later form a cycle, but the cycle may occur not in the beginning, so there exist a preperiod and a period. The example above shows a preperiod equal to 1 and a period equal to 2.Your task is to find the period of a sequence defined by the given values of a,\xe2\x80\x89b,\xe2\x80\x89m and r0. Formally, you have to find such minimum positive integer t, for which exists such positive integer k, that for any i\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89k: ri\xe2\x80\x89=\xe2\x80\x89ri\xe2\x80\x89+\xe2\x80\x89t." 1200

172A "Phone Code" "*special problem,brute force,implementation" "Polycarpus has n friends in Tarasov city. Polycarpus knows phone numbers of all his friends: they are strings s1,\xe2\x80\x89s2,\xe2\x80\x89...,\xe2\x80\x89sn. All these strings consist only of digits and have the same length. Once Polycarpus needed to figure out Tarasov city phone code. He assumed that the phone code of the city is the longest common prefix of all phone numbers of his friends. In other words, it is the longest string c which is a prefix (the beginning) of each si for all i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n). Help Polycarpus determine the length of the city phone code." 800

171H "A polyline" "*special problem,implementation"  1700

171G "Mysterious numbers - 2" "*special problem" "InputThe only line of input contains three integers a1,\xe2\x80\x89a2,\xe2\x80\x89a3 (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a1,\xe2\x80\x89a2,\xe2\x80\x89a3\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x8920), separated by spaces.OutputOutput a single integer.ExamplesInputCopy2 3 2OutputCopy5InputCopy13 14 1OutputCopy14InputCopy14 5 9OutputCopy464InputCopy17 18 3OutputCopy53" 1600

171F ucyhf "*special problem,brute force,implementation,number theory" "qd ucyhf yi q fhycu dkcruh mxeiu huluhiu yi q tyvvuhudj fhycu dkcruh. oekh jqia yi je vydt jxu djx ucyhf." 1600

171E "MYSTERIOUS LANGUAGE" "*special problem" "You are given a mysterious language (codenamed ""Secret"") available in ""Custom Test"" tab. Find out what this language is and write a program which outputs its name. Note that the program must be written in this language." 2000

171D "Broken checker" "*special problem,brute force" """This problem is rubbish! There is not statement, and there are only 5 test cases. The problemsetter took liberties with this problem!"" \xe2\x80\x94 people complained in the comments to one round on Codeforces. And even more... No, wait, the checker for the problem was alright, that\'s a mercy." 1300

171C "A Piece of Cake" "*special problem,implementation" "How to make a cake you\'ll never eat.Ingredients.   2 carrots  0 calories  100 g chocolate spread  1 pack of flour  1 egg Method.   Put calories into the mixing bowl.  Take carrots from refrigerator.  Chop carrots.  Take chocolate spread from refrigerator.  Put chocolate spread into the mixing bowl.  Combine pack of flour into the mixing bowl.  Fold chocolate spread into the mixing bowl.  Add chocolate spread into the mixing bowl.  Put pack of flour into the mixing bowl.  Add egg into the mixing bowl.  Fold pack of flour into the mixing bowl.  Chop carrots until choped.  Pour contents of the mixing bowl into the baking dish. Serves 1." 2000

171B Star "*special problem,combinatorics"  1300

171A "Mysterious numbers - 1" "*special problem,constructive algorithms" "InputThe input contains two integers a1,\xe2\x80\x89a2 (0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ai\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89109), separated by a single space.OutputOutput a single integer.ExamplesInputCopy3 14OutputCopy44InputCopy27 12OutputCopy48InputCopy100 200OutputCopy102" 1200

169B "Replacing Digits" greedy "You are given an integer a that consists of n digits. You are also given a sequence of digits s of length m. The digit in position j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m) of sequence s means that you can choose an arbitrary position i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) in a and replace the digit in the chosen position i with sj. Each element in the sequence s can participate in no more than one replacing operation.Your task is to perform such sequence of replacements, that the given number a gets maximum value. You are allowed to use not all elements from s." 1100

169A Chores sortings "Petya and Vasya are brothers. Today is a special day for them as their parents left them home alone and commissioned them to do n chores. Each chore is characterized by a single parameter \xe2\x80\x94 its complexity. The complexity of the i-th chore equals hi.As Petya is older, he wants to take the chores with complexity larger than some value x (hi\xe2\x80\x89>\xe2\x80\x89x) to leave to Vasya the chores with complexity less than or equal to x (hi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x). The brothers have already decided that Petya will do exactly a chores and Vasya will do exactly b chores (a\xe2\x80\x89+\xe2\x80\x89b\xe2\x80\x89=\xe2\x80\x89n).In how many ways can they choose an integer x so that Petya got exactly a chores and Vasya got exactly b chores?" 800

168B "Wizards and Minimal Spell" implementation,strings "Let\'s dive into one of the most interesting areas of magic \xe2\x80\x94 writing spells. Learning this exciting but challenging science is very troublesome, so now you will not learn the magic words, but only get to know the basic rules of writing spells.Each spell consists of several lines. The line, whose first non-space character is character ""#"" is an amplifying line and it is responsible for spell power. The remaining lines are common, and determine the effect of the spell.You came across the text of some spell. Spell was too long, so you cannot understand its meaning. So you want to make it as short as possible without changing the meaning.The only way to shorten a spell that you know is the removal of some spaces and line breaks. We know that when it comes to texts of spells, the spaces carry meaning only in the amplifying lines, so we should remove all spaces in other lines. Newlines also do not matter, unless any of the two separated lines is amplifying. Thus, if two consecutive lines are not amplifying, they need to be joined into one (i.e. we should concatenate the second line to the first one). Removing spaces in amplifying lines and concatenating the amplifying lines to anything is forbidden.Note that empty lines must be processed just like all the others: they must be joined to the adjacent non-amplifying lines, or preserved in the output, if they are surrounded with amplifying lines on both sides (i.e. the line above it, if there is one, is amplifying, and the line below it, if there is one, is amplifying too).For now those are the only instructions for removing unnecessary characters that you have to follow (oh yes, a newline is a character, too).The input contains the text of the spell, which should be reduced. Remove the extra characters and print the result to the output." 1700

168A "Wizards and Demonstration" implementation,math "Some country is populated by wizards. They want to organize a demonstration.There are n people living in the city, x of them are the wizards who will surely go to the demonstration. Other city people (n\xe2\x80\x89-\xe2\x80\x89x people) do not support the wizards and aren\'t going to go to the demonstration. We know that the city administration will react only to the demonstration involving at least y percent of the city people. Having considered the matter, the wizards decided to create clone puppets which can substitute the city people on the demonstration. So all in all, the demonstration will involve only the wizards and their puppets. The city administration cannot tell the difference between a puppet and a person, so, as they calculate the percentage, the administration will consider the city to be consisting of only n people and not containing any clone puppets. Help the wizards and find the minimum number of clones to create to that the demonstration had no less than y percent of the city people." 900

167E "Wizards and Bets" "dfs and similar,graphs,math,matrices" "In some country live wizards. They like to make weird bets.Two wizards draw an acyclic directed graph with n vertices and m edges (the graph\'s vertices are numbered from 1 to n). A source is a vertex with no incoming edges, and a sink is the vertex with no outgoing edges. Note that a vertex could be the sink and the source simultaneously. In the wizards\' graph the number of the sinks and the sources is the same.Wizards numbered the sources in the order of increasing numbers of the vertices from 1 to k. The sinks are numbered from 1 to k in the similar way.To make a bet, they, as are real wizards, cast a spell, which selects a set of k paths from all sources to the sinks in such a way that no two paths intersect at the vertices. In this case, each sink has exactly one path going to it from exactly one source. Let\'s suppose that the i-th sink has a path going to it from the ai\'s source. Then let\'s call pair (i,\xe2\x80\x89j) an inversion if i\xe2\x80\x89<\xe2\x80\x89j and ai\xe2\x80\x89>\xe2\x80\x89aj. If the number of inversions among all possible pairs (i,\xe2\x80\x89j), such that (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k), is even, then the first wizard wins (the second one gives him one magic coin). Otherwise, the second wizard wins (he gets one magic coin from the first one).Our wizards are captured with feverish excitement, so they kept choosing new paths again and again for so long that eventually they have chosen every possible set of paths for exactly once. The two sets of non-intersecting pathes are considered to be different, if and only if there is an edge, which lies at some path in one set and doesn\'t lie at any path of another set. To check their notes, they asked you to count the total winnings of the first player for all possible sets of paths modulo a prime number p." 2900

167D "Wizards and Roads" "data structures,divide and conquer,graph matchings,graphs,greedy" "In some country live wizards. They love to build cities and roads.The country used to have k cities, the j-th city (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k) was located at a point (xj, yj). It was decided to create another n\xe2\x80\x89-\xe2\x80\x89k cities. And the i-th one (k\xe2\x80\x89<\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) was created at a point with coordinates (xi, yi):  xi\xe2\x80\x89=\xe2\x80\x89(a\xc2\xb7xi\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x89b)�mod�(109\xe2\x80\x89+\xe2\x80\x899)  yi\xe2\x80\x89=\xe2\x80\x89(c\xc2\xb7yi\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x89d)�mod�(109\xe2\x80\x89+\xe2\x80\x899) Here a, b, c, d are primes. Also, a\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89c,\xe2\x80\x89b\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89d.After the construction of all n cities, the wizards have noticed something surprising. It turned out that for every two different cities i and j, xi\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89xj and yi\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89yj holds.The cities are built, it\'s time to build roads! It was decided to use the most difficult (and, of course, the most powerful) spell for the construction of roads. Using this spell creates a road between the towns of u, v (yu > yv) if and only if for any city w which lies strictly inside the corner at the point u, v (see below), there is a city s that does not lie in the corner, which is located along the x-coordinate strictly between w and u and simultaneously ys\xe2\x80\x89>\xe2\x80\x89yv.A corner on the points p2(x2, y2), p1(x1, y1) (y1\xe2\x80\x89<\xe2\x80\x89y2) is the set of points (x,\xe2\x80\x89y), for which at least one of the two conditions is fulfilled:   min(x1,\xe2\x80\x89x2)\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89max(x1,\xe2\x80\x89x2) and y\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89y1  y1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y2 and (x\xe2\x80\x89-\xe2\x80\x89x2)\xc2\xb7(x1\xe2\x80\x89-\xe2\x80\x89x2)\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x890    The pictures showing two different corners  In order to test the spell, the wizards will apply it to all the cities that lie on the x-coordinate in the interval [L,\xe2\x80\x89R]. After the construction of roads the national government wants to choose the maximum number of pairs of cities connected by the road, so that no city occurs in two or more pairs. Your task is for each m offered variants of values L, R to calculate the maximum number of such pairs after the construction of the roads. Please note that the cities that do not lie in the interval [L,\xe2\x80\x89R] on the x-coordinate, do not affect the construction of roads in any way." 3000

167C "Wizards and Numbers" games,math "In some country live wizards. They love playing with numbers. The blackboard has two numbers written on it \xe2\x80\x94 a and b. The order of the numbers is not important. Let\'s consider a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b for the sake of definiteness. The players can cast one of the two spells in turns:  Replace b with b\xe2\x80\x89-\xe2\x80\x89ak. Number k can be chosen by the player, considering the limitations that k\xe2\x80\x89>\xe2\x80\x890 and b\xe2\x80\x89-\xe2\x80\x89ak\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x890. Number k is chosen independently each time an active player casts a spell.  Replace b with b�mod�a. If a\xe2\x80\x89>\xe2\x80\x89b, similar moves are possible.If at least one of the numbers equals zero, a player can\'t make a move, because taking a remainder modulo zero is considered somewhat uncivilized, and it is far too boring to subtract a zero. The player who cannot make a move, loses.To perform well in the magic totalizator, you need to learn to quickly determine which player wins, if both wizards play optimally: the one that moves first or the one that moves second." 2300

167B "Wizards and Huge Prize" dp,math,probabilities "One must train much to do well on wizardry contests. So, there are numerous wizardry schools and magic fees.One of such magic schools consists of n tours. A winner of each tour gets a huge prize. The school is organised quite far away, so one will have to take all the prizes home in one go. And the bags that you\'ve brought with you have space for no more than k huge prizes.Besides the fact that you want to take all the prizes home, you also want to perform well. You will consider your performance good if you win at least l tours.In fact, years of organizing contests proved to the organizers that transporting huge prizes is an issue for the participants. Alas, no one has ever invented a spell that would shrink the prizes... So, here\'s the solution: for some tours the winner gets a bag instead of a huge prize. Each bag is characterized by number ai \xe2\x80\x94 the number of huge prizes that will fit into it.You already know the subject of all tours, so you can estimate the probability pi of winning the i-th tour. You cannot skip the tour under any circumstances.Find the probability that you will perform well on the contest and will be able to take all won prizes home (that is, that you will be able to fit all the huge prizes that you won into the bags that you either won or brought from home)." 1800

167A "Wizards and Trolleybuses" implementation,math "In some country live wizards. They love to ride trolleybuses.A city in this country has a trolleybus depot with n trolleybuses. Every day the trolleybuses leave the depot, one by one and go to the final station. The final station is at a distance of d meters from the depot. We know for the i-th trolleybus that it leaves at the moment of time ti seconds, can go at a speed of no greater than vi meters per second, and accelerate with an acceleration no greater than a meters per second squared. A trolleybus can decelerate as quickly as you want (magic!). It can change its acceleration as fast as you want, as well. Note that the maximum acceleration is the same for all trolleys.Despite the magic the trolleys are still powered by an electric circuit and cannot overtake each other (the wires are to blame, of course). If a trolleybus catches up with another one, they go together one right after the other until they arrive at the final station. Also, the drivers are driving so as to arrive at the final station as quickly as possible.You, as head of the trolleybuses\' fans\' club, are to determine for each trolley the minimum time by which it can reach the final station. At the time of arrival at the destination station the trolleybus does not necessarily have zero speed. When a trolley is leaving the depot, its speed is considered equal to zero. From the point of view of physics, the trolleybuses can be considered as material points, and also we should ignore the impact on the speed of a trolley bus by everything, except for the acceleration and deceleration provided by the engine." 1600

166E Tetrahedron dp,math,matrices "You are given a tetrahedron. Let\'s mark its vertices with letters A, B, C and D correspondingly.  An ant is standing in the vertex D of the tetrahedron. The ant is quite active and he wouldn\'t stay idle. At each moment of time he makes a step from one vertex to another one along some edge of the tetrahedron. The ant just can\'t stand on one place.You do not have to do much to solve the problem: your task is to count the number of ways in which the ant can go from the initial vertex D to itself in exactly n steps. In other words, you are asked to find out the number of different cyclic paths with the length of n from vertex D to itself. As the number can be quite large, you should print it modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." 1500

166D "Shoe Store" "dp,graph matchings,greedy,sortings,two pointers" "The warehouse in your shop has n shoe pairs. Each pair is characterized by two integers: its price ci and its size si. We know that on this very day all numbers si are different, that is, there is no more than one pair of each size.The shop has m customers who came at the same time. The customer number i has di money and the size of his feet equals li. The customer number i can buy the pair number j, if cj\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89di, and also if li\xe2\x80\x89=\xe2\x80\x89sj or li\xe2\x80\x89=\xe2\x80\x89sj\xe2\x80\x89-\xe2\x80\x891; that is, it is necessary that he has enough money to pay for the shoes. It is also necessary that the size of his feet equals to or is less by 1 than the size of the shoes he chooses.Your task is to sell some customers pairs of shoes (a pair per person) so as to maximize the sum of the sold pairs cj that is, the profit. It is guaranteed that each customer buys no more than one pair and each pair will be bought by no more than one customer." 2500

166C Median greedy,math,sortings "A median in an array with the length of n is an element which occupies position number  after we sort the elements in the non-decreasing order (the array elements are numbered starting with 1). A median of an array (2,\xe2\x80\x896,\xe2\x80\x891,\xe2\x80\x892,\xe2\x80\x893) is the number 2, and a median of array (0,\xe2\x80\x8996,\xe2\x80\x8917,\xe2\x80\x8923) \xe2\x80\x94 the number 17.We define an expression  as the integer part of dividing number a by number b.One day Vasya showed Petya an array consisting of n integers and suggested finding the array\'s median. Petya didn\'t even look at the array and said that it equals x. Petya is a very honest boy, so he decided to add several numbers to the given array so that the median of the resulting array would be equal to x.Petya can add any integers from 1 to 105 to the array, including the same numbers. Of course, he can add nothing to the array. If a number is added multiple times, then we should consider it the number of times it occurs. It is not allowed to delete of change initial numbers of the array. While Petya is busy distracting Vasya, your task is to find the minimum number of elements he will need." 1500

166B Polygons geometry,sortings "You\'ve got another geometrical task. You are given two non-degenerate polygons A and B as vertex coordinates. Polygon A is strictly convex. Polygon B is an arbitrary polygon without any self-intersections and self-touches. The vertices of both polygons are given in the clockwise order. For each polygon no three consecutively following vertices are located on the same straight line.Your task is to check whether polygon B is positioned strictly inside polygon A. It means that any point of polygon B should be strictly inside polygon A. ""Strictly"" means that the vertex of polygon B cannot lie on the side of the polygon A." 2100

166A "Rank List" "binary search,implementation,sortings" "Another programming contest is over. You got hold of the contest\'s final results table. The table has the following data. For each team we are shown two numbers: the number of problems and the total penalty time. However, for no team we are shown its final place.You know the rules of comparing the results of two given teams very well. Let\'s say that team a solved pa problems with total penalty time ta and team b solved pb problems with total penalty time tb. Team a gets a higher place than team b in the end, if it either solved more problems on the contest, or solved the same number of problems but in less total time. In other words, team a gets a higher place than team b in the final results\' table if either pa\xe2\x80\x89>\xe2\x80\x89pb, or pa\xe2\x80\x89=\xe2\x80\x89pb and ta\xe2\x80\x89<\xe2\x80\x89tb. It is considered that the teams that solve the same number of problems with the same penalty time share all corresponding places. More formally, let\'s say there is a group of x teams that solved the same number of problems with the same penalty time. Let\'s also say that y teams performed better than the teams from this group. In this case all teams from the group share places y\xe2\x80\x89+\xe2\x80\x891, y\xe2\x80\x89+\xe2\x80\x892, ..., y\xe2\x80\x89+\xe2\x80\x89x. The teams that performed worse than the teams from this group, get their places in the results table starting from the y\xe2\x80\x89+\xe2\x80\x89x\xe2\x80\x89+\xe2\x80\x891-th place.Your task is to count what number of teams from the given list shared the k-th place." 1100

165E "Compatible Numbers" "bitmasks,brute force,dfs and similar,dp" "Two integers x and y are compatible, if the result of their bitwise ""AND"" equals zero, that is, a & b\xe2\x80\x89=\xe2\x80\x890. For example, numbers 90 (10110102) and 36 (1001002) are compatible, as 10110102 & 1001002\xe2\x80\x89=\xe2\x80\x8902, and numbers 3 (112) and 6 (1102) are not compatible, as 112 & 1102\xe2\x80\x89=\xe2\x80\x89102.You are given an array of integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. Your task is to find the following for each array element: is this element compatible with some other element from the given array? If the answer to this question is positive, then you also should find any suitable element." 2200

165D "Beard Graph" "data structures,dsu,trees" "Let\'s define a non-oriented connected graph of n vertices and n\xe2\x80\x89-\xe2\x80\x891 edges as a beard, if all of its vertices except, perhaps, one, have the degree of 2 or 1 (that is, there exists no more than one vertex, whose degree is more than two). Let us remind you that the degree of a vertex is the number of edges that connect to it. Let each edge be either black or white. Initially all edges are black.You are given the description of the beard graph. Your task is to analyze requests of the following types:   paint the edge number i black. The edge number i is the edge that has this number in the description. It is guaranteed that by the moment of this request the i-th edge is white  paint the edge number i white. It is guaranteed that by the moment of this request the i-th edge is black  find the length of the shortest path going only along the black edges between vertices a and b or indicate that no such path exists between them (a path\'s length is the number of edges in it) The vertices are numbered with integers from 1 to n, and the edges are numbered with integers from 1 to n\xe2\x80\x89-\xe2\x80\x891." 2100

165C "Another Problem on Strings" "binary search,brute force,dp,math,strings,two pointers" "A string is binary, if it consists only of characters ""0"" and ""1"".String v is a substring of string w if it has a non-zero length and can be read starting from some position in string w. For example, string ""010"" has six substrings: ""0"", ""1"", ""0"", ""01"", ""10"", ""010"". Two substrings are considered different if their positions of occurrence are different. So, if some string occurs multiple times, we should consider it the number of times it occurs.You are given a binary string s. Your task is to find the number of its substrings, containing exactly k characters ""1""." 1600

165B "Burning Midnight Oil" "binary search,implementation" "One day a highly important task was commissioned to Vasya \xe2\x80\x94 writing a program in a night. The program consists of n lines of code. Vasya is already exhausted, so he works like that: first he writes v lines of code, drinks a cup of tea, then he writes as much as  lines, drinks another cup of tea, then he writes  lines and so on: , , , ...The expression  is regarded as the integral part from dividing number a by number b.The moment the current value  equals 0, Vasya immediately falls asleep and he wakes up only in the morning, when the program should already be finished.Vasya is wondering, what minimum allowable value v can take to let him write not less than n lines of code before he falls asleep." 1500

165A "Supercentral Point" implementation "One day Vasya painted a Cartesian coordinate system on a piece of paper and marked some set of points (x1,\xe2\x80\x89y1),\xe2\x80\x89(x2,\xe2\x80\x89y2),\xe2\x80\x89...,\xe2\x80\x89(xn,\xe2\x80\x89yn). Let\'s define neighbors for some fixed point from the given set (x,\xe2\x80\x89y):   point (x\',\xe2\x80\x89y\') is (x,\xe2\x80\x89y)\'s right neighbor, if x\'\xe2\x80\x89>\xe2\x80\x89x and y\'\xe2\x80\x89=\xe2\x80\x89y  point (x\',\xe2\x80\x89y\') is (x,\xe2\x80\x89y)\'s left neighbor, if x\'\xe2\x80\x89<\xe2\x80\x89x and y\'\xe2\x80\x89=\xe2\x80\x89y  point (x\',\xe2\x80\x89y\') is (x,\xe2\x80\x89y)\'s lower neighbor, if x\'\xe2\x80\x89=\xe2\x80\x89x and y\'\xe2\x80\x89<\xe2\x80\x89y  point (x\',\xe2\x80\x89y\') is (x,\xe2\x80\x89y)\'s upper neighbor, if x\'\xe2\x80\x89=\xe2\x80\x89x and y\'\xe2\x80\x89>\xe2\x80\x89y We\'ll consider point (x,\xe2\x80\x89y) from the given set supercentral, if it has at least one upper, at least one lower, at least one left and at least one right neighbor among this set\'s points.Vasya marked quite many points on the paper. Analyzing the picture manually is rather a challenge, so Vasya asked you to help him. Your task is to find the number of supercentral points in the given set." 1000

164E "Polycarpus and Tasks" NA "Polycarpus has many tasks. Each task is characterized by three integers li, ri and ti. Three integers (li,\xe2\x80\x89ri,\xe2\x80\x89ti) mean that to perform task i, one needs to choose an integer si (li\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89si;�si\xe2\x80\x89+\xe2\x80\x89ti\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ri), then the task will be carried out continuously for ti units of time, starting at time si and up to time si\xe2\x80\x89+\xe2\x80\x89ti\xe2\x80\x89-\xe2\x80\x891, inclusive. In other words, a task is performed for a continuous period of time lasting ti, should be started no earlier than li, and completed no later than ri.Polycarpus\'s tasks have a surprising property: for any task j,\xe2\x80\x89k (with j\xe2\x80\x89<\xe2\x80\x89k) lj\xe2\x80\x89<\xe2\x80\x89lk and rj\xe2\x80\x89<\xe2\x80\x89rk.Let\'s suppose there is an ordered set of tasks A, containing |A| tasks. We\'ll assume that aj\xe2\x80\x89=\xe2\x80\x89(lj,\xe2\x80\x89rj,\xe2\x80\x89tj) (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|A|). Also, we\'ll assume that the tasks are ordered by increasing lj with the increase in number.Let\'s consider the following recursive function f, whose argument is an ordered set of tasks A, and the result is an integer. The function f(A) is defined by the greedy algorithm, which is described below in a pseudo-language of programming.  Step 1. , ans\xe2\x80\x89=\xe2\x80\x890.  Step 2. We consider all tasks in the order of increasing of their numbers in the set A. Lets define the current task counter i\xe2\x80\x89=\xe2\x80\x890.  Step 3. Consider the next task: i\xe2\x80\x89=\xe2\x80\x89i\xe2\x80\x89+\xe2\x80\x891. If i\xe2\x80\x89>\xe2\x80\x89|A| fulfilled, then go to the 8 step.  Step 4. If you can get the task done starting at time si = max(ans\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89li), then do the task i: si = max(ans\xe2\x80\x89+\xe2\x80\x891, li), ans\xe2\x80\x89=\xe2\x80\x89si\xe2\x80\x89+\xe2\x80\x89ti\xe2\x80\x89-\xe2\x80\x891, . Go to the next task (step 3).  Step 5. Otherwise, find such task , that first, task ai can be done at time si = max, and secondly, the value of  is positive and takes the maximum value among all bk that satisfy the first condition. If you can choose multiple tasks as bk, choose the one with the maximum number in set A.  Step 6. If you managed to choose task bk, then , . Go to the next task (step 3).  Step 7. If you didn\'t manage to choose task bk, then skip task i. Go to the next task (step 3).  Step 8. Return ans as a result of executing f(A). Polycarpus got entangled in all these formulas and definitions, so he asked you to simulate the execution of the function f, calculate the value of f(A)." 3100

164D "Minimum Diameter" "binary search,brute force" "You are given n points on the plane. You need to delete exactly k of them (k\xe2\x80\x89<\xe2\x80\x89n) so that the diameter of the set of the remaining n\xe2\x80\x89-\xe2\x80\x89k points were as small as possible. The diameter of a set of points is the maximum pairwise distance between the points of the set. The diameter of a one point set equals zero." 3100

164C "Machine Programming" flows,graphs "One remarkable day company ""X"" received k machines. And they were not simple machines, they were mechanical programmers! This was the last unsuccessful step before switching to android programmers, but that\'s another story.The company has now n tasks, for each of them we know the start time of its execution si, the duration of its execution ti, and the company profit from its completion ci. Any machine can perform any task, exactly one at a time. If a machine has started to perform the task, it is busy at all moments of time from si to si\xe2\x80\x89+\xe2\x80\x89ti\xe2\x80\x89-\xe2\x80\x891, inclusive, and it cannot switch to another task.You are required to select a set of tasks which can be done with these k machines, and which will bring the maximum total profit." 2400

164B "Ancient Berland Hieroglyphs" "two pointers" "Polycarpus enjoys studying Berland hieroglyphs. Once Polycarp got hold of two ancient Berland pictures, on each of which was drawn a circle of hieroglyphs. We know that no hieroglyph occurs twice in either the first or the second circle (but in can occur once in each of them).Polycarpus wants to save these pictures on his laptop, but the problem is, laptops do not allow to write hieroglyphs circles. So Polycarp had to break each circle and write down all of its hieroglyphs in a clockwise order in one line. A line obtained from the first circle will be called a, and the line obtained from the second one will be called b.There are quite many ways to break hieroglyphic circles, so Polycarpus chooses the method, that makes the length of the largest substring of string a, which occurs as a subsequence in string b, maximum.Help Polycarpus \xe2\x80\x94 find the maximum possible length of the desired substring (subsequence) if the first and the second circles are broken optimally.The length of string s is the number of characters in it. If we denote the length of string s as |s|, we can write the string as s\xe2\x80\x89=\xe2\x80\x89s1s2... s|s|.A substring of s is a non-empty string x\xe2\x80\x89=\xe2\x80\x89s[a... b]\xe2\x80\x89=\xe2\x80\x89sasa\xe2\x80\x89+\xe2\x80\x891... sb (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|s|). For example, ""code"" and ""force"" are substrings of ""codeforces"", while ""coders"" is not. A subsequence of s is a non-empty string y\xe2\x80\x89=\xe2\x80\x89s[p1p2... p|y|]\xe2\x80\x89=\xe2\x80\x89sp1sp2... sp|y| (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89p1\xe2\x80\x89<\xe2\x80\x89p2\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89p|y|\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|s|). For example, ""coders"" is a subsequence of ""codeforces""." 2000

164A "Variable, or There and Back Again" "dfs and similar,graphs" "Life is not easy for the perfectly common variable named Vasya. Wherever it goes, it is either assigned a value, or simply ignored, or is being used!Vasya\'s life goes in states of a program. In each state, Vasya can either be used (for example, to calculate the value of another variable), or be assigned a value, or ignored. Between some states are directed (oriented) transitions.A path is a sequence of states v1,\xe2\x80\x89v2,\xe2\x80\x89...,\xe2\x80\x89vx, where for any 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89x exists a transition from vi to vi\xe2\x80\x89+\xe2\x80\x891.Vasya\'s value in state v is interesting to the world, if exists path p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pk such, that pi\xe2\x80\x89=\xe2\x80\x89v for some i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k), in state p1 Vasya gets assigned a value, in state pk Vasya is used and there is no state pi (except for p1) where Vasya gets assigned a value.Help Vasya, find the states in which Vasya\'s value is interesting to the world." 1700

163E e-Government "data structures,dfs and similar,dp,strings,trees" "The best programmers of Embezzland compete to develop a part of the project called ""e-Government"" \xe2\x80\x94 the system of automated statistic collecting and press analysis.We know that any of the k citizens can become a member of the Embezzland government. The citizens\' surnames are a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89ak. All surnames are different. Initially all k citizens from this list are members of the government. The system should support the following options:  Include citizen ai to the government.  Exclude citizen ai from the government.  Given a newspaper article text, calculate how politicized it is. To do this, for every active government member the system counts the number of times his surname occurs in the text as a substring. All occurrences are taken into consideration, including the intersecting ones. The degree of politicization of a text is defined as the sum of these values for all active government members. Implement this system." 2800

163D "Large Refrigerator" "brute force" "Vasya wants to buy a new refrigerator. He believes that a refrigerator should be a rectangular parallelepiped with integer edge lengths. Vasya calculated that for daily use he will need a refrigerator with volume of at least V. Moreover, Vasya is a minimalist by nature, so the volume should be no more than V, either \xe2\x80\x94 why take up extra space in the apartment? Having made up his mind about the volume of the refrigerator, Vasya faced a new challenge \xe2\x80\x94 for a fixed volume of V the refrigerator must have the minimum surface area so that it is easier to clean.The volume and the surface area of a refrigerator with edges a, b, c are equal to V\xe2\x80\x89=\xe2\x80\x89abc and S\xe2\x80\x89=\xe2\x80\x892(ab\xe2\x80\x89+\xe2\x80\x89bc\xe2\x80\x89+\xe2\x80\x89ca), correspondingly.Given the volume V, help Vasya find the integer lengths for the refrigerator\'s edges a, b, c so that the refrigerator\'s volume equals V and its surface area S is minimized." 2900

163C Conveyor "sortings,two pointers" "Anton came to a chocolate factory. There he found a working conveyor and decided to run on it from the beginning to the end.The conveyor is a looped belt with a total length of 2l meters, of which l meters are located on the surface and are arranged in a straight line. The part of the belt which turns at any moment (the part which emerges from under the floor to the surface and returns from the surface under the floor) is assumed to be negligibly short.The belt is moving uniformly at speed v1 meters per second. Anton will be moving on it in the same direction at the constant speed of v2 meters per second, so his speed relatively to the floor will be v1\xe2\x80\x89+\xe2\x80\x89v2 meters per second. Anton will neither stop nor change the speed or the direction of movement.Here and there there are chocolates stuck to the belt (n chocolates). They move together with the belt, and do not come off it. Anton is keen on the chocolates, but he is more keen to move forward. So he will pick up all the chocolates he will pass by, but nothing more. If a chocolate is at the beginning of the belt at the moment when Anton starts running, he will take it, and if a chocolate is at the end of the belt at the moment when Anton comes off the belt, he will leave it.   The figure shows an example with two chocolates. One is located   in the position a1\xe2\x80\x89=\xe2\x80\x89l\xe2\x80\x89-\xe2\x80\x89d, and is now on the top half of the belt, the second one   is in the position a2\xe2\x80\x89=\xe2\x80\x892l\xe2\x80\x89-\xe2\x80\x89d, and is now on the bottom half of the belt.  You are given the positions of the chocolates relative to the initial start position of the belt 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a1\xe2\x80\x89<\xe2\x80\x89a2\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89an\xe2\x80\x89<\xe2\x80\x892l. The positions on the belt from 0 to l correspond to the top, and from l to 2l \xe2\x80\x94 to the the bottom half of the belt (see example). All coordinates are given in meters.Anton begins to run along the belt at a random moment of time. This means that all possible positions of the belt at the moment he starts running are equiprobable. For each i from 0 to n calculate the probability that Anton will pick up exactly i chocolates." 2100

163B Lemmings "binary search" "As you know, lemmings like jumping. For the next spectacular group jump n lemmings gathered near a high rock with k comfortable ledges on it. The first ledge is situated at the height of h meters, the second one is at the height of 2h meters, and so on (the i-th ledge is at the height of i\xc2\xb7h meters). The lemmings are going to jump at sunset, and there\'s not much time left.Each lemming is characterized by its climbing speed of vi meters per minute and its weight mi. This means that the i-th lemming can climb to the j-th ledge in  minutes.To make the jump beautiful, heavier lemmings should jump from higher ledges: if a lemming of weight mi jumps from ledge i, and a lemming of weight mj jumps from ledge j (for i\xe2\x80\x89<\xe2\x80\x89j), then the inequation mi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89mj should be fulfilled.Since there are n lemmings and only k ledges (k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n), the k lemmings that will take part in the jump need to be chosen. The chosen lemmings should be distributed on the ledges from 1 to k, one lemming per ledge. The lemmings are to be arranged in the order of non-decreasing weight with the increasing height of the ledge. In addition, each lemming should have enough time to get to his ledge, that is, the time of his climb should not exceed t minutes. The lemmings climb to their ledges all at the same time and they do not interfere with each other.Find the way to arrange the lemmings\' jump so that time t is minimized." 2000

163A "Substring and Subsequence" dp "One day Polycarpus got hold of two non-empty strings s and t, consisting of lowercase Latin letters. Polycarpus is quite good with strings, so he immediately wondered, how many different pairs of ""x y"" are there, such that x is a substring of string s, y is a subsequence of string t, and the content of x and y is the same. Two pairs are considered different, if they contain different substrings of string s or different subsequences of string t. Read the whole statement to understand the definition of different substrings and subsequences.The length of string s is the number of characters in it. If we denote the length of the string s as |s|, we can write the string as s\xe2\x80\x89=\xe2\x80\x89s1s2... s|s|.A substring of s is a non-empty string x\xe2\x80\x89=\xe2\x80\x89s[a... b]\xe2\x80\x89=\xe2\x80\x89sasa\xe2\x80\x89+\xe2\x80\x891... sb (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|s|). For example, ""code"" and ""force"" are substrings or ""codeforces"", while ""coders"" is not. Two substrings s[a... b] and s[c... d] are considered to be different if a\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89c or b\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89d. For example, if s=""codeforces"", s[2...2] and s[6...6] are different, though their content is the same.A subsequence of s is a non-empty string y\xe2\x80\x89=\xe2\x80\x89s[p1p2... p|y|]\xe2\x80\x89=\xe2\x80\x89sp1sp2... sp|y| (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89p1\xe2\x80\x89<\xe2\x80\x89p2\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89p|y|\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|s|). For example, ""coders"" is a subsequence of ""codeforces"". Two subsequences u\xe2\x80\x89=\xe2\x80\x89s[p1p2... p|u|] and v\xe2\x80\x89=\xe2\x80\x89s[q1q2... q|v|] are considered different if the sequences p and q are different." 1700

162J Brackets "*special problem" "A sequence of brackets is called balanced if one can turn it into a valid math expression by adding characters ""+"" and ""1"". For example, sequences ""(())()"", ""()"" and ""(()(()))"" are balanced, while "")("", ""(()"" and ""(()))("" are not.You are given a string which consists of opening and closing round brackets. Check whether it is a balanced bracket sequence." 1800

162I "Truncatable primes" "*special problem" "A truncatable prime is a prime number which contains no zeros in decimal notation and all its suffixes are primes. 1 is considered to be not a prime.You are given a positive integer n. Figure out whether it is a truncatable prime." 2000

162H "Alternating case" "*special problem" "You are given a string consisting of alphabet letters. Convert it to alternating case: the letters on odd positions should be in uppercase, and the letters on even positions should be lowercase. The letters are numbered staring from 1." 1800

162G "Non-decimal sum" "*special problem" "You are given an array of integers written in base radix. Calculate their sum and output it written in the same base." 2000

162F "Factorial zeros" "*special problem" "You are given a positive integer n. Output the number of trailing zeros in n! (n! denotes a product of integers between 1 and n, inclusive)." 1800

162E HQ9+ "*special problem" "HQ9+ is a joke programming language which has only four one-character instructions: ""H"" prints ""Hello, World!"", ""Q"" prints the whole source code of the program itself (at each call), ""9"" prints the lyrics of ""99 Bottles of Beer"" song,  ""+"" increments the value stored in the internal accumulator.Instructions ""H"" and ""Q"" are case-sensitive and must be uppercase. The characters of the program which are not instructions are ignored.You are given a program written in HQ9+. You have to figure out whether executing this program will produce any output." 1800

162D "Remove digits" "*special problem" "You are given a string. Remove all digits from it. When a character is removed from a string, all characters to the right of it are shifted one position to the left." 1900

162C "Prime factorization" "*special problem" "You are given a positive integer n. Output its prime factorization.If n = a1b1 a2b2 ... akbk (bi\xe2\x80\x89>\xe2\x80\x890), where ak are prime numbers, the output of your program should look as follows: a1*...*a1*a2*...*a2*...*ak*...*ak, where the factors are ordered in non-decreasing order, and each factor ai is printed bi times." 1800

162B "Binary notation" "*special problem" "You are given a positive integer n. Output its binary notation." 1800

162A "Pentagonal numbers" "*special problem,implementation" "Pentagonal numbers are figurate numbers which can be calculated using the formula pn\xe2\x80\x89=\xe2\x80\x89(3n2\xe2\x80\x89-\xe2\x80\x89n)\xe2\x80\x89/\xe2\x80\x892 (always integer). You are given n; calculate n-th pentagonal number." 1100

161E "Polycarpus the Safecracker" "brute force,dp" "Polycarpus has t safes. The password for each safe is a square matrix consisting of decimal digits \'0\' ... \'9\' (the sizes of passwords to the safes may vary). Alas, Polycarpus has forgotten all passwords, so now he has to restore them.Polycarpus enjoys prime numbers, so when he chose the matrix passwords, he wrote a prime number in each row of each matrix. To his surprise, he found that all the matrices turned out to be symmetrical (that is, they remain the same after transposition). Now, years later, Polycarp was irritated to find out that he remembers only the prime numbers pi, written in the first lines of the password matrices.For each safe find the number of matrices which can be passwords to it.The number of digits in pi determines the number of rows and columns of the i-th matrix. One prime number can occur in several rows of the password matrix or in several matrices. The prime numbers that are written not in the first row of the matrix may have leading zeros." 2500

161D "Distance in Tree" "dfs and similar,dp,trees" "A tree is a connected graph that doesn\'t contain any cycles.The distance between two vertices of a tree is the length (in edges) of the shortest path between these vertices.You are given a tree with n vertices and a positive number k. Find the number of distinct pairs of the vertices which have a distance of exactly k between them. Note that pairs (v, u) and (u, v) are considered to be the same pair." 1800

161C Abracadabra "divide and conquer" "Polycarpus analyzes a string called abracadabra. This string is constructed using the following algorithm:   On the first step the string consists of a single character ""a"".  On the k-th step Polycarpus concatenates two copies of the string obtained on the (k\xe2\x80\x89-\xe2\x80\x891)-th step, while inserting the k-th character of the alphabet between them. Polycarpus uses the alphabet that consists of lowercase Latin letters and digits (a total of 36 characters). The alphabet characters are numbered like this: the 1-st character is ""a"", the 2-nd \xe2\x80\x94 ""b"", ..., the 26-th \xe2\x80\x94 ""z"", the 27-th \xe2\x80\x94 ""0"", the 28-th \xe2\x80\x94 ""1"", ..., the 36-th \xe2\x80\x94 ""9"". Let\'s have a closer look at the algorithm. On the second step Polycarpus will concatenate two strings ""a"" and insert the character ""b"" between them, resulting in ""aba"" string. The third step will transform it into ""abacaba"", and the fourth one - into ""abacabadabacaba"". Thus, the string constructed on the k-th step will consist of 2k\xe2\x80\x89-\xe2\x80\x891 characters. Polycarpus wrote down the string he got after 30 steps of the given algorithm and chose two non-empty substrings of it. Your task is to find the length of the longest common substring of the two substrings selected by Polycarpus.A substring s[i... j] (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|s|) of string s = s1s2... s|s| is a string sisi\xe2\x80\x89+\xe2\x80\x891... sj. For example, substring s[2...4] of string s = ""abacaba"" equals ""bac"". The string is its own substring.The longest common substring of two strings s and t is the longest string that is a substring of both s and t. For example, the longest common substring of ""contest"" and ""systemtesting"" is string ""test"". There can be several common substrings of maximum length." 2400

161B Discounts "constructive algorithms,greedy,sortings" "One day Polycarpus stopped by a supermarket on his way home. It turns out that the supermarket is having a special offer for stools. The offer is as follows: if a customer\'s shopping cart contains at least one stool, the customer gets a 50% discount on the cheapest item in the cart (that is, it becomes two times cheaper). If there are several items with the same minimum price, the discount is available for only one of them!Polycarpus has k carts, and he wants to buy up all stools and pencils from the supermarket. Help him distribute the stools and the pencils among the shopping carts, so that the items\' total price (including the discounts) is the least possible.Polycarpus must use all k carts to purchase the items, no shopping cart can remain empty. Each shopping cart can contain an arbitrary number of stools and/or pencils." 1700

161A "Dress\'em in Vests!" "binary search,brute force,greedy,two pointers" "One day Polycarpus stopped by a supermarket on his way home. It turns out that the supermarket is having a special offer for stools. The offer is as follows: if a customer\'s shopping cart contains at least one stool, the customer gets a 50% discount on the cheapest item in the cart (that is, it becomes two times cheaper). If there are several items with the same minimum price, the discount is available for only one of them!Polycarpus has k carts, and he wants to buy up all stools and pencils from the supermarket. Help him distribute the stools and the pencils among the shopping carts, so that the items\' total price (including the discounts) is the least possible.Polycarpus must use all k carts to purchase the items, no shopping cart can remain empty. Each shopping cart can contain an arbitrary number of stools and/or pencils." 1300

160E "Buses and People" "binary search,data structures,sortings" "The main Bertown street is represented by a straight line. There are 109 bus stops located on the line. The stops are numbered with integers from 1 to 109 in the order in which they follow on the road. The city has n buses. Every day the i-th bus drives from stop number si to stop number fi (si\xe2\x80\x89<\xe2\x80\x89fi), it stops on all intermediate stops and returns only at night. The bus starts driving at time ti and drives so fast that it finishes driving also at time ti. The time ti is different for all buses. The buses have infinite capacity.Bertown has m citizens. Today the i-th person should get from stop number li to stop number ri (li\xe2\x80\x89<\xe2\x80\x89ri); the i-th citizen comes to his initial stop (li) at time bi. Each person, on the one hand, wants to get to the destination point as quickly as possible, and on the other hand, definitely does not want to change the buses as he rides. More formally: the i-th person chooses bus j, with minimum time tj, such that sj\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89li, ri\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89fj and bi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89tj. Your task is to determine for each citizen whether he can ride to the destination point today and if he can, find the number of the bus on which the citizen will ride." 2400

160D "Edges in MST" "dfs and similar,dsu,graphs,sortings" "You are given a connected weighted undirected graph without any loops and multiple edges. Let us remind you that a graph\'s spanning tree is defined as an acyclic connected subgraph of the given graph that includes all of the graph\'s vertexes. The weight of a tree is defined as the sum of weights of the edges that the given tree contains. The minimum spanning tree (MST) of a graph is defined as the graph\'s spanning tree having the minimum possible weight. For any connected graph obviously exists the minimum spanning tree, but in the general case, a graph\'s minimum spanning tree is not unique.Your task is to determine the following for each edge of the given graph: whether it is either included in any MST, or included at least in one MST, or not included in any MST." 2300

160C "Find Pair" implementation,math,sortings "You\'ve got another problem dealing with arrays. Let\'s consider an arbitrary sequence containing n (not necessarily different) integers a1, a2, ..., an. We are interested in all possible pairs of numbers (ai, aj), (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i,\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n). In other words, let\'s consider all n2 pairs of numbers, picked from the given array.For example, in sequence a\xe2\x80\x89=\xe2\x80\x89{3,\xe2\x80\x891,\xe2\x80\x895} are 9 pairs of numbers: (3,\xe2\x80\x893),\xe2\x80\x89(3,\xe2\x80\x891),\xe2\x80\x89(3,\xe2\x80\x895),\xe2\x80\x89(1,\xe2\x80\x893),\xe2\x80\x89(1,\xe2\x80\x891),\xe2\x80\x89(1,\xe2\x80\x895),\xe2\x80\x89(5,\xe2\x80\x893),\xe2\x80\x89(5,\xe2\x80\x891),\xe2\x80\x89(5,\xe2\x80\x895).Let\'s sort all resulting pairs lexicographically by non-decreasing. Let us remind you that pair (p1, q1) is lexicographically less than pair (p2, q2) only if either p1 < p2, or p1 = p2 and q1 < q2.Then the sequence, mentioned above, will be sorted like that: (1,\xe2\x80\x891),\xe2\x80\x89(1,\xe2\x80\x893),\xe2\x80\x89(1,\xe2\x80\x895),\xe2\x80\x89(3,\xe2\x80\x891),\xe2\x80\x89(3,\xe2\x80\x893),\xe2\x80\x89(3,\xe2\x80\x895),\xe2\x80\x89(5,\xe2\x80\x891),\xe2\x80\x89(5,\xe2\x80\x893),\xe2\x80\x89(5,\xe2\x80\x895)Let\'s number all the pair in the sorted list from 1 to n2. Your task is formulated like this: you should find the k-th pair in the ordered list of all possible pairs of the array you\'ve been given." 1700

160B "Unlucky Ticket" greedy,sortings "Each of you probably has your personal experience of riding public transportation and buying tickets. After a person buys a ticket (which traditionally has an even number of digits), he usually checks whether the ticket is lucky. Let us remind you that a ticket is lucky if the sum of digits in its first half matches the sum of digits in its second half.But of course, not every ticket can be lucky. Far from it! Moreover, sometimes one look at a ticket can be enough to say right away that the ticket is not lucky. So, let\'s consider the following unluckiness criterion that can definitely determine an unlucky ticket. We\'ll say that a ticket is definitely unlucky if each digit from the first half corresponds to some digit from the second half so that each digit from the first half is strictly less than the corresponding digit from the second one or each digit from the first half is strictly more than the corresponding digit from the second one. Each digit should be used exactly once in the comparisons. In other words, there is such bijective correspondence between the digits of the first and the second half of the ticket, that either each digit of the first half turns out strictly less than the corresponding digit of the second half or each digit of the first half turns out strictly more than the corresponding digit from the second half.For example, ticket 2421 meets the following unluckiness criterion and will not be considered lucky (the sought correspondence is 2\xe2\x80\x89>\xe2\x80\x891 and 4\xe2\x80\x89>\xe2\x80\x892), ticket 0135 also meets the criterion (the sought correspondence is 0\xe2\x80\x89<\xe2\x80\x893 and 1\xe2\x80\x89<\xe2\x80\x895), and ticket 3754 does not meet the criterion. You have a ticket in your hands, it contains 2n digits. Your task is to check whether it meets the unluckiness criterion." 1100

160A Twins greedy,sortings "Imagine that you have a twin brother or sister. Having another person that looks exactly like you seems very unusual. It\'s hard to say if having something of an alter ego is good or bad. And if you do have a twin, then you very well know what it\'s like.Now let\'s imagine a typical morning in your family. You haven\'t woken up yet, and Mom is already going to work. She has been so hasty that she has nearly forgotten to leave the two of her darling children some money to buy lunches in the school cafeteria. She fished in the purse and found some number of coins, or to be exact, n coins of arbitrary values a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. But as Mom was running out of time, she didn\'t split the coins for you two. So she scribbled a note asking you to split the money equally.As you woke up, you found Mom\'s coins and read her note. ""But why split the money equally?"" \xe2\x80\x94 you thought. After all, your twin is sleeping and he won\'t know anything. So you decided to act like that: pick for yourself some subset of coins so that the sum of values of your coins is strictly larger than the sum of values of the remaining coins that your twin will have. However, you correctly thought that if you take too many coins, the twin will suspect the deception. So, you\'ve decided to stick to the following strategy to avoid suspicions: you take the minimum number of coins, whose sum of values is strictly more than the sum of values of the remaining coins. On this basis, determine what minimum number of coins you need to take to divide them in the described manner." 900

159E "Zebra Tower" "*special problem,data structures,greedy,sortings" "Little Janet likes playing with cubes. Actually, she likes to play with anything whatsoever, cubes or tesseracts, as long as they are multicolored. Each cube is described by two parameters \xe2\x80\x94 color ci and size si. A Zebra Tower is a tower that consists of cubes of exactly two colors. Besides, the colors of the cubes in the tower must alternate (colors of adjacent cubes must differ). The Zebra Tower should have at least two cubes. There are no other limitations. The figure below shows an example of a Zebra Tower.  A Zebra Tower\'s height is the sum of sizes of all cubes that form the tower. Help little Janet build the Zebra Tower of the maximum possible height, using the available cubes." 1700

159D "Palindrome pairs" "*special problem,brute force,dp,strings" "You are given a non-empty string s consisting of lowercase letters. Find the number of pairs of non-overlapping palindromic substrings of this string.In a more formal way, you have to find the quantity of tuples (a,\xe2\x80\x89b,\xe2\x80\x89x,\xe2\x80\x89y) such that 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b\xe2\x80\x89<\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|s| and substrings s[a... b], s[x... y] are palindromes.A palindrome is a string that can be read the same way from left to right and from right to left. For example, ""abacaba"", ""z"", ""abba"" are palindromes.A substring s[i... j] (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|s|) of string s = s1s2... s|s| is a string sisi\xe2\x80\x89+\xe2\x80\x891... sj. For example, substring s[2...4] of string s = ""abacaba"" equals ""bac""." 1500

159C "String Manipulation 1.0" "*special problem,binary search,brute force,data structures,strings" "One popular website developed an unusual username editing procedure. One can change the username only by deleting some characters from it: to change the current name s, a user can pick number p and character c and delete the p-th occurrence of character c from the name. After the user changed his name, he can\'t undo the change.For example, one can change name ""arca"" by removing the second occurrence of character ""a"" to get ""arc"". Polycarpus learned that some user initially registered under nickname t, where t is a concatenation of k copies of string s. Also, Polycarpus knows the sequence of this user\'s name changes. Help Polycarpus figure out the user\'s final name." 1400

159B Matchmaker "*special problem,greedy,sortings" "Polycarpus has n markers and m marker caps. Each marker is described by two numbers: xi is the color and yi is the diameter. Correspondingly, each cap is described by two numbers: aj is the color and bj is the diameter. Cap (aj,\xe2\x80\x89bj) can close marker (xi,\xe2\x80\x89yi) only if their diameters match, that is, bj\xe2\x80\x89=\xe2\x80\x89yi. Besides, a marker is considered to be beautifully closed, if the cap color and the marker color match, that is, aj\xe2\x80\x89=\xe2\x80\x89xi.Find the way to close the maximum number of markers. If there are several such ways, then choose the one that has the maximum number of beautifully closed markers." 1100

159A "Friends or Not" "*special problem,greedy,implementation" "Polycarpus has a hobby \xe2\x80\x94 he develops an unusual social network. His work is almost completed, and there is only one more module to implement \xe2\x80\x94 the module which determines friends. Oh yes, in this social network one won\'t have to add friends manually! Pairs of friends are deduced in the following way. Let\'s assume that user A sent user B a message at time t1, and user B sent user A a message at time t2. If 0\xe2\x80\x89<\xe2\x80\x89t2\xe2\x80\x89-\xe2\x80\x89t1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89d, then user B\'s message was an answer to user A\'s one. Users A and B are considered to be friends if A answered at least one B\'s message or B answered at least one A\'s message.You are given the log of messages in chronological order and a number d. Find all pairs of users who will be considered to be friends." 1400

158E "Phone Talks" "*special problem,dp,sortings" "Cool J has recently become a businessman Mr. Jackson, and he has to make a lot of phone calls now. Today he has n calls planned. For each call we know the moment ti (in seconds since the start of the day) when it is scheduled to start and its duration di (in seconds). All ti are different. Mr. Jackson is a very important person, so he never dials anybody himself, all calls will be incoming.Mr. Jackson isn\'t Caesar and he can\'t do several things at once. If somebody calls him while he hasn\'t finished the previous conversation, Mr. Jackson puts the new call on hold in the queue. In this case immediately after the end of the current call Mr. Jackson takes the earliest incoming call from the queue and starts the conversation. If Mr. Jackson started the call at the second t, and the call continues for d seconds, then Mr. Jackson is busy at seconds t,\xe2\x80\x89t\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89t\xe2\x80\x89+\xe2\x80\x89d\xe2\x80\x89-\xe2\x80\x891, and he can start a new call at second t\xe2\x80\x89+\xe2\x80\x89d. Note that if Mr. Jackson is not busy talking when somebody calls, he can\'t put this call on hold.Mr. Jackson isn\'t Napoleon either, he likes to sleep. So sometimes he allows himself the luxury of ignoring a call, as if it never was scheduled. He can ignore at most k calls. Note that a call which comes while he is busy talking can be ignored as well.What is the maximum number of seconds Mr. Jackson can sleep today, assuming that he can choose an arbitrary continuous time segment from the current day (that is, with seconds from the 1-st to the 86400-th, inclusive) when he is not busy talking?Note that some calls can be continued or postponed to the next day or even later. However, the interval for sleep should be completely within the current day." 1900

158D "Ice Sculptures" "*special problem,brute force,number theory" "The Berland University is preparing to celebrate the 256-th anniversary of its founding! A specially appointed Vice Rector for the celebration prepares to decorate the campus. In the center of the campus n ice sculptures were erected. The sculptures are arranged in a circle at equal distances from each other, so they form a regular n-gon. They are numbered in clockwise order with numbers from 1 to n.The site of the University has already conducted a voting that estimated each sculpture\'s characteristic of ti \xe2\x80\x94 the degree of the sculpture\'s attractiveness. The values of ti can be positive, negative or zero.When the university rector came to evaluate the work, he said that this might be not the perfect arrangement. He suggested to melt some of the sculptures so that:   the remaining sculptures form a regular polygon (the number of vertices should be between 3 and n),  the sum of the ti values of the remaining sculptures is maximized. Help the Vice Rector to analyze the criticism \xe2\x80\x94 find the maximum value of ti sum which can be obtained in this way. It is allowed not to melt any sculptures at all. The sculptures can not be moved." 1300

158C "Cd and pwd commands" "*special problem,data structures,implementation" "Vasya is writing an operating system shell, and it should have commands for working with directories. To begin with, he decided to go with just two commands: cd (change the current directory) and pwd (display the current directory).Directories in Vasya\'s operating system form a traditional hierarchical tree structure. There is a single root directory, denoted by the slash character ""/"". Every other directory has a name \xe2\x80\x94 a non-empty string consisting of lowercase Latin letters. Each directory (except for the root) has a parent directory \xe2\x80\x94 the one that contains the given directory. It is denoted as "".."".The command cd takes a single parameter, which is a path in the file system. The command changes the current directory to the directory specified by the path. The path consists of the names of directories separated by slashes. The name of the directory can be "".."", which means a step up to the parent directory. \xc2\xab..\xc2\xbb can be used in any place of the path, maybe several times. If the path begins with a slash, it is considered to be an absolute path, that is, the directory changes to the specified one, starting from the root. If the parameter begins with a directory name (or ""..""), it is considered to be a relative path, that is, the directory changes to the specified directory, starting from the current one.The command pwd should display the absolute path to the current directory. This path must not contain "".."".Initially, the current directory is the root. All directories mentioned explicitly or passed indirectly within any command cd are considered to exist. It is guaranteed that there is no attempt of transition to the parent directory of the root directory." 1400

158B Taxi "*special problem,greedy,implementation" "After the lessons n groups of schoolchildren went outside and decided to visit Polycarpus to celebrate his birthday. We know that the i-th group consists of si friends (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89si\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x894), and they want to go to Polycarpus together. They decided to get there by taxi. Each car can carry at most four passengers. What minimum number of cars will the children need if all members of each group should ride in the same taxi (but one taxi can take more than one group)?" 1100

158A "Next Round" "*special problem,implementation" """Contestant who earns a score equal to or greater than the k-th place finisher\'s score will advance to the next round, as long as the contestant earns a positive score..."" \xe2\x80\x94 an excerpt from contest rules.A total of n participants took part in the contest (n\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89k), and you already know their scores. Calculate how many participants will advance to the next round." 800

157B Trace geometry,sortings "One day, as Sherlock Holmes was tracking down one very important criminal, he found a wonderful painting on the wall. This wall could be represented as a plane. The painting had several concentric circles that divided the wall into several parts. Some parts were painted red and all the other were painted blue. Besides, any two neighboring parts were painted different colors, that is, the red and the blue color were alternating, i. e. followed one after the other. The outer area of the wall (the area that lied outside all circles) was painted blue. Help Sherlock Holmes determine the total area of red parts of the wall.Let us remind you that two circles are called concentric if their centers coincide. Several circles are called concentric if any two of them are concentric." 1000

157A "Game Outcome" "brute force" "Sherlock Holmes and Dr. Watson played some game on a checkered board n\xe2\x80\x89\xc3\x97\xe2\x80\x89n in size. During the game they put numbers on the board\'s squares by some tricky rules we don\'t know. However, the game is now over and each square of the board contains exactly one number. To understand who has won, they need to count the number of winning squares. To determine if the particular square is winning you should do the following. Calculate the sum of all numbers on the squares that share this column (including the given square) and separately calculate the sum of all numbers on the squares that share this row (including the given square). A square is considered winning if the sum of the column numbers is strictly greater than the sum of the row numbers.For instance, lets game was ended like is shown in the picture. Then the purple cell is winning, because the sum of its column numbers equals 8\xe2\x80\x89+\xe2\x80\x893\xe2\x80\x89+\xe2\x80\x896\xe2\x80\x89+\xe2\x80\x897\xe2\x80\x89=\xe2\x80\x8924, sum of its row numbers equals 9\xe2\x80\x89+\xe2\x80\x895\xe2\x80\x89+\xe2\x80\x893\xe2\x80\x89+\xe2\x80\x892\xe2\x80\x89=\xe2\x80\x8919, and 24\xe2\x80\x89>\xe2\x80\x8919." 800

156E "Mrs. Hudson\'s Pancakes" "brute force,dp" "Sherlock Holmes and Dr. Watson played some game on a checkered board n\xe2\x80\x89\xc3\x97\xe2\x80\x89n in size. During the game they put numbers on the board\'s squares by some tricky rules we don\'t know. However, the game is now over and each square of the board contains exactly one number. To understand who has won, they need to count the number of winning squares. To determine if the particular square is winning you should do the following. Calculate the sum of all numbers on the squares that share this column (including the given square) and separately calculate the sum of all numbers on the squares that share this row (including the given square). A square is considered winning if the sum of the column numbers is strictly greater than the sum of the row numbers.For instance, lets game was ended like is shown in the picture. Then the purple cell is winning, because the sum of its column numbers equals 8\xe2\x80\x89+\xe2\x80\x893\xe2\x80\x89+\xe2\x80\x896\xe2\x80\x89+\xe2\x80\x897\xe2\x80\x89=\xe2\x80\x8924, sum of its row numbers equals 9\xe2\x80\x89+\xe2\x80\x895\xe2\x80\x89+\xe2\x80\x893\xe2\x80\x89+\xe2\x80\x892\xe2\x80\x89=\xe2\x80\x8919, and 24\xe2\x80\x89>\xe2\x80\x8919." 3000

156D Clues combinatorics,graphs "As Sherlock Holmes was investigating another crime, he found a certain number of clues. Also, he has already found direct links between some of those clues. The direct links between the clues are mutual. That is, the direct link between clues A and B and the direct link between clues B and A is the same thing. No more than one direct link can exist between two clues.Of course Sherlock is able to find direct links between all clues. But it will take too much time and the criminals can use this extra time to hide. To solve the crime, Sherlock needs each clue to be linked to all other clues (maybe not directly, via some other clues). Clues A and B are considered linked either if there is a direct link between them or if there is a direct link between A and some other clue C which is linked to B. Sherlock Holmes counted the minimum number of additional direct links that he needs to find to solve the crime. As it turns out, it equals T.Please count the number of different ways to find exactly T direct links between the clues so that the crime is solved in the end. Two ways to find direct links are considered different if there exist two clues which have a direct link in one way and do not have a direct link in the other way. As the number of different ways can turn out rather big, print it modulo k." 2500

156C Cipher combinatorics,dp "Sherlock Holmes found a mysterious correspondence of two VIPs and made up his mind to read it. But there is a problem! The correspondence turned out to be encrypted. The detective tried really hard to decipher the correspondence, but he couldn\'t understand anything. At last, after some thought, he thought of something. Let\'s say there is a word s, consisting of |s| lowercase Latin letters. Then for one operation you can choose a certain position p (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89p\xe2\x80\x89<\xe2\x80\x89|s|) and perform one of the following actions:   either replace letter sp with the one that alphabetically follows it and replace letter sp\xe2\x80\x89+\xe2\x80\x891 with the one that alphabetically precedes it;  or replace letter sp with the one that alphabetically precedes it and replace letter sp\xe2\x80\x89+\xe2\x80\x891 with the one that alphabetically follows it. Let us note that letter ""z"" doesn\'t have a defined following letter and letter ""a"" doesn\'t have a defined preceding letter. That\'s why the corresponding changes are not acceptable. If the operation requires performing at least one unacceptable change, then such operation cannot be performed.Two words coincide in their meaning iff one of them can be transformed into the other one as a result of zero or more operations.Sherlock Holmes needs to learn to quickly determine the following for each word: how many words can exist that coincide in their meaning with the given word, but differs from the given word in at least one character? Count this number for him modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." 2000

156B Suspects "constructive algorithms,data structures,implementation" "As Sherlock Holmes was investigating a crime, he identified n suspects. He knows for sure that exactly one of them committed the crime. To find out which one did it, the detective lines up the suspects and numbered them from 1 to n. After that, he asked each one: ""Which one committed the crime?"". Suspect number i answered either ""The crime was committed by suspect number ai"", or ""Suspect number ai didn\'t commit the crime"". Also, the suspect could say so about himself (ai\xe2\x80\x89=\xe2\x80\x89i).Sherlock Holmes understood for sure that exactly m answers were the truth and all other answers were a lie. Now help him understand this: which suspect lied and which one told the truth?" 1600

156A Message "brute force" "Dr. Moriarty is about to send a message to Sherlock Holmes. He has a string s. String p is called a substring of string s if you can read it starting from some position in the string s. For example, string ""aba"" has six substrings: ""a"", ""b"", ""a"", ""ab"", ""ba"", ""aba"".Dr. Moriarty plans to take string s and cut out some substring from it, let\'s call it t. Then he needs to change the substring t zero or more times. As a result, he should obtain a fixed string u (which is the string that should be sent to Sherlock Holmes). One change is defined as making one of the following actions:   Insert one letter to any end of the string.  Delete one letter from any end of the string.  Change one letter into any other one. Moriarty is very smart and after he chooses some substring t, he always makes the minimal number of changes to obtain u. Help Moriarty choose the best substring t from all substrings of the string s. The substring t should minimize the number of changes Moriarty should make to obtain the string u from it." 1700

155B Combination greedy,sortings "Ilya plays a card game by the following rules.A player has several cards. Each card contains two non-negative integers inscribed, one at the top of the card and one at the bottom. At the beginning of the round the player chooses one of his cards to play it. If the top of the card contains number ai, and the bottom contains number bi, then when the player is playing the card, he gets ai points and also gets the opportunity to play additional bi cards. After the playing the card is discarded.More formally: let\'s say that there is a counter of the cards that can be played. At the beginning of the round the counter equals one. When a card is played, the counter decreases by one for the played card and increases by the number bi, which is written at the bottom of the card. Then the played card is discarded. If after that the counter is not equal to zero, the player gets the opportunity to play another card from the remaining cards. The round ends when the counter reaches zero or the player runs out of cards.Of course, Ilya wants to get as many points as possible. Can you determine the maximum number of points he can score provided that you know his cards?" 1100

155A I_love_\\%username\\% "brute force" "Ilya plays a card game by the following rules.A player has several cards. Each card contains two non-negative integers inscribed, one at the top of the card and one at the bottom. At the beginning of the round the player chooses one of his cards to play it. If the top of the card contains number ai, and the bottom contains number bi, then when the player is playing the card, he gets ai points and also gets the opportunity to play additional bi cards. After the playing the card is discarded.More formally: let\'s say that there is a counter of the cards that can be played. At the beginning of the round the counter equals one. When a card is played, the counter decreases by one for the played card and increases by the number bi, which is written at the bottom of the card. Then the played card is discarded. If after that the counter is not equal to zero, the player gets the opportunity to play another card from the remaining cards. The round ends when the counter reaches zero or the player runs out of cards.Of course, Ilya wants to get as many points as possible. Can you determine the maximum number of points he can score provided that you know his cards?" 800

154E "Martian Colony" geometry "The first ship with the Earth settlers landed on Mars. The colonists managed to build n necessary structures on the surface of the planet (which can be regarded as a plane, and the construction can be regarded as points on it). But one day the scanners recorded suspicious activity on the outskirts of the colony. It was decided to use the protective force field generating system to protect the colony against possible trouble.The system works as follows: the surface contains a number of generators of the field (they can also be considered as points). The active range of each generator is a circle of radius r centered at the location of the generator (the boundary of the circle is also included in the range). After the system is activated, it stretches the protective force field only over the part of the surface, which is within the area of all generators\' activity. That is, the protected part is the intersection of the generators\' active ranges.The number of generators available to the colonists is not limited, but the system of field generation consumes a lot of energy. More precisely, the energy consumption does not depend on the number of generators, but it is directly proportional to the area, which is protected by the field. Also, it is necessary that all the existing buildings are located within the protected area.Determine the smallest possible area of the protected part of the surface containing all the buildings." 3000

154D "Flatland Fencing" games,math "The King of Flatland will organize a knights\' tournament! The winner will get half the kingdom and the favor of the princess of legendary beauty and wisdom. The final test of the applicants\' courage and strength will be a fencing tournament. The tournament is held by the following rules: the participants fight one on one, the winner (or rather, the survivor) transfers to the next round.Before the battle both participants stand at the specified points on the Ox axis with integer coordinates. Then they make moves in turn. The first participant moves first, naturally. During a move, the first participant can transfer from the point x to any integer point of the interval [x\xe2\x80\x89+\xe2\x80\x89a; x\xe2\x80\x89+\xe2\x80\x89b]. The second participant can transfer during a move to any integer point of the interval [x\xe2\x80\x89-\xe2\x80\x89b; x\xe2\x80\x89-\xe2\x80\x89a]. That is, the options for the players\' moves are symmetric (note that the numbers a and b are not required to be positive, and if a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x890\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b, then staying in one place is a correct move). At any time the participants can be located arbitrarily relative to each other, that is, it is allowed to ""jump"" over the enemy in any direction. A participant wins if he uses his move to transfer to the point where his opponent is.Of course, the princess has already chosen a husband and now she wants to make her sweetheart win the tournament. He has already reached the tournament finals and he is facing the last battle. The princess asks the tournament manager to arrange the tournament finalists in such a way that her sweetheart wins the tournament, considering that both players play optimally. However, the initial location of the participants has already been announced, and we can only pull some strings and determine which participant will be first and which one will be second. But how do we know which participant can secure the victory? Alas, the princess is not learned in the military affairs... Therefore, she asks you to determine how the battle will end considering that both opponents play optimally. Also, if the first player wins, your task is to determine his winning move." 2400

154C "Double Profiles" graphs,hashing,sortings "You have been offered a job in a company developing a large social network. Your first task is connected with searching profiles that most probably belong to the same user.The social network contains n registered profiles, numbered from 1 to n. Some pairs there are friends (the ""friendship"" relationship is mutual, that is, if i is friends with j, then j is also friends with i). Let\'s say that profiles i and j (i\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89j) are doubles, if for any profile k (k\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89i, k\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89j) one of the two statements is true: either k is friends with i and j, or k isn\'t friends with either of them. Also, i and j can be friends or not be friends.Your task is to count the number of different unordered pairs (i,\xe2\x80\x89j), such that the profiles i and j are doubles. Note that the pairs are unordered, that is, pairs (a,\xe2\x80\x89b) and (b,\xe2\x80\x89a) are considered identical." 2300

154B Colliders "math,number theory" "By 2312 there were n Large Hadron Colliders in the inhabited part of the universe. Each of them corresponded to a single natural number from 1 to n. However, scientists did not know what activating several colliders simultaneously could cause, so the colliders were deactivated.In 2312 there was a startling discovery: a collider\'s activity is safe if and only if all numbers of activated colliders are pairwise relatively prime to each other (two numbers are relatively prime if their greatest common divisor equals 1)! If two colliders with relatively nonprime numbers are activated, it will cause a global collapse.Upon learning this, physicists rushed to turn the colliders on and off and carry out all sorts of experiments. To make sure than the scientists\' quickness doesn\'t end with big trouble, the Large Hadron Colliders\' Large Remote Control was created. You are commissioned to write the software for the remote (well, you do not expect anybody to operate it manually, do you?).Initially, all colliders are deactivated. Your program receives multiple requests of the form ""activate/deactivate the i-th collider"". The program should handle requests in the order of receiving them. The program should print the processed results in the format described below.To the request of ""+ i"" (that is, to activate the i-th collider), the program should print exactly one of the following responses:   ""Success"" if the activation was successful.  ""Already on"", if the i-th collider was already activated before the request.  ""Conflict with j"", if there is a conflict with the j-th collider (that is, the j-th collider is on, and numbers i and j are not relatively prime). In this case, the i-th collider shouldn\'t be activated. If a conflict occurs with several colliders simultaneously, you should print the number of any of them. The request of ""- i"" (that is, to deactivate the i-th collider), should receive one of the following responses from the program:   ""Success"", if the deactivation was successful.  ""Already off"", if the i-th collider was already deactivated before the request. You don\'t need to print quotes in the output of the responses to the requests." 1600

154A Hometask greedy "Sergey attends lessons of the N-ish language. Each lesson he receives a hometask. This time the task is to translate some sentence to the N-ish language. Sentences of the N-ish language can be represented as strings consisting of lowercase Latin letters without spaces or punctuation marks.Sergey totally forgot about the task until half an hour before the next lesson and hastily scribbled something down. But then he recollected that in the last lesson he learned the grammar of N-ish. The spelling rules state that N-ish contains some ""forbidden"" pairs of letters: such letters can never occur in a sentence next to each other. Also, the order of the letters doesn\'t matter (for example, if the pair of letters ""ab"" is forbidden, then any occurrences of substrings ""ab"" and ""ba"" are also forbidden). Also, each pair has different letters and each letter occurs in no more than one forbidden pair.Now Sergey wants to correct his sentence so that it doesn\'t contain any ""forbidden"" pairs of letters that stand next to each other. However, he is running out of time, so he decided to simply cross out some letters from the sentence. What smallest number of letters will he have to cross out? When a letter is crossed out, it is ""removed"" so that the letters to its left and right (if they existed), become neighboring. For example, if we cross out the first letter from the string ""aba"", we get the string ""ba"", and if we cross out the second letter, we get ""aa""." 1600

153E "Euclidean Distance" "*special problem" "You are given a multiset of points on the plane with integer coordinates. Find the maximum distance between two points from this multiset." 2100

153D "Date Change" "*special problem" "You are given a date in ""DD.MM.YYYY"" (""day.month.year"") format and a number of days shift you have to add to this date. Output the resulting date." 2000

153C "Caesar Cipher" "*special problem" "Caesar cipher is one of the simplest encryption techniques. To transform the original message into encrypted one using key k, one has to replace each letter with a letter which is k positions later in the alphabet (if this takes the position beyond Z, the rest of it is counted from the start of the alphabet). In a more formal way, if letters of the alphabet are enumerated starting with 0, the result of encryption for character x will be  (26 is the number of letters in the Latin alphabet).You are given the original message and the encryption key k. Output the resulting cipher." 2200

153B "Binary notation" "*special problem" "You are given a positive integer n. Output its binary notation." 1800

153A "A + B" "*special problem" "You are given two integers A and B. Calculate their sum and output it without leading zeros." 1600

152E Garden bitmasks,dp,graphs,trees "Vasya has a very beautiful country garden that can be represented as an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m rectangular field divided into n\xc2\xb7m squares. One beautiful day Vasya remembered that he needs to pave roads between k important squares that contain buildings. To pave a road, he can cover some squares of his garden with concrete.For each garden square we know number aij that represents the number of flowers that grow in the square with coordinates (i,\xe2\x80\x89j). When a square is covered with concrete, all flowers that grow in the square die.Vasya wants to cover some squares with concrete so that the following conditions were fulfilled:   all k important squares should necessarily be covered with concrete  from each important square there should be a way to any other important square. The way should go be paved with concrete-covered squares considering that neighboring squares are squares that have a common side  the total number of dead plants should be minimum As Vasya has a rather large garden, he asks you to help him." 2500

152D Frames "brute force" "One day Vasya got hold of a sheet of checkered paper n\xe2\x80\x89\xc3\x97\xe2\x80\x89m squares in size. Our Vasya adores geometrical figures, so he painted two rectangles on the paper. The rectangles\' sides are parallel to the coordinates\' axes, also the length of each side of each rectangle is no less than 3 squares and the sides are painted by the grid lines. The sides can also be part of the sheet of paper\'s edge. Then Vasya hatched all squares on the rectangles\' frames.Let\'s define a rectangle\'s frame as the set of squares inside the rectangle that share at least one side with its border.A little later Vasya found a sheet of paper of exactly the same size and couldn\'t guess whether it is the same sheet of paper or a different one. So, he asked you to check whether the sheet of paper he had found contains two painted frames and nothing besides them.Please note that the frames painted by Vasya can arbitrarily intersect, overlap or even completely coincide.The coordinates on the sheet of paper are introduced in such a way that the X axis goes from top to bottom, the x coordinates of the squares\' numbers take values from 1 to n and the Y axis goes from the left to the right and the y coordinates of the squares\' numbers take values from 1 to m." 2600

152C "Pocket Book" combinatorics "One day little Vasya found mom\'s pocket book. The book had n names of her friends and unusually enough, each name was exactly m letters long. Let\'s number the names from 1 to n in the order in which they are written.As mom wasn\'t home, Vasya decided to play with names: he chose three integers i, j, k (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n, 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m), then he took names number i and j and swapped their prefixes of length k. For example, if we take names ""CBDAD"" and ""AABRD"" and swap their prefixes with the length of 3, the result will be names ""AABAD"" and ""CBDRD"".You wonder how many different names Vasya can write instead of name number 1, if Vasya is allowed to perform any number of the described actions. As Vasya performs each action, he chooses numbers i, j, k independently from the previous moves and his choice is based entirely on his will. The sought number can be very large, so you should only find it modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." 1400

152B Steps "binary search,implementation" "One day Vasya went out for a walk in the yard but there weren\'t any of his friends outside and he had no one to play touch and run. But the boy didn\'t lose the high spirits and decided to play touch and run with himself. You may ask: ""How did he do that?"" The answer is simple.Vasya noticed that the yard is a rectangular n\xe2\x80\x89\xc3\x97\xe2\x80\x89m field. The squares have coordinates (x,\xe2\x80\x89y) (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n,\xe2\x80\x891\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m), where x is the index of the row and y is the index of the column.Initially Vasya stands in the square with coordinates (xc,\xe2\x80\x89yc). To play, he has got a list of k vectors (dxi,\xe2\x80\x89dyi) of non-zero length. The game goes like this. The boy considers all vectors in the order from 1 to k, and consecutively chooses each vector as the current one. After the boy has chosen a current vector, he makes the maximally possible number of valid steps in the vector\'s direction (it is possible that he makes zero steps).A step is defined as one movement from the square where the boy is standing now, in the direction of the current vector. That is, if Vasya is positioned in square (x,\xe2\x80\x89y), and the current vector is (dx,\xe2\x80\x89dy), one step moves Vasya to square (x\xe2\x80\x89+\xe2\x80\x89dx,\xe2\x80\x89y\xe2\x80\x89+\xe2\x80\x89dy). A step is considered valid, if the boy does not go out of the yard if he performs the step.Vasya stepped on and on, on and on until he ran out of vectors in his list. Ha had been stepping for so long that he completely forgot how many steps he had made. Help the boy and count how many steps he had made." 1300

152A Marks implementation "Vasya, or Mr. Vasily Petrov is a dean of a department in a local university. After the winter exams he got his hands on a group\'s gradebook.Overall the group has n students. They received marks for m subjects. Each student got a mark from 1 to 9 (inclusive) for each subject.Let\'s consider a student the best at some subject, if there is no student who got a higher mark for this subject. Let\'s consider a student successful, if there exists a subject he is the best at.Your task is to find the number of successful students in the group." 900

151B "Phone Numbers" implementation,strings "Winters are just damn freezing cold in Nvodsk! That\'s why a group of n friends prefers to take a taxi, order a pizza and call girls. The phone numbers in the city consist of three pairs of digits (for example, 12-34-56). Each friend has a phonebook of size si (that\'s the number of phone numbers). We know that taxi numbers consist of six identical digits (for example, 22-22-22), the numbers of pizza deliveries should necessarily be decreasing sequences of six different digits (for example, 98-73-21), all other numbers are the girls\' numbers.You are given your friends\' phone books. Calculate which friend is best to go to when you are interested in each of those things (who has maximal number of phone numbers of each type). If the phone book of one person contains some number two times, you should count it twice. That is, each number should be taken into consideration the number of times it occurs in the phone book." 1200

151A "Soft Drinking" implementation,math "This winter is so cold in Nvodsk! A group of n friends decided to buy k bottles of a soft drink called ""Take-It-Light"" to warm up a bit. Each bottle has l milliliters of the drink. Also they bought c limes and cut each of them into d slices. After that they found p grams of salt.To make a toast, each friend needs nl milliliters of the drink, a slice of lime and np grams of salt. The friends want to make as many toasts as they can, provided they all drink the same amount. How many toasts can each friend make?" 800

150E "Freezing with Style" "binary search,data structures,divide and conquer,trees" "This winter is so... well, you\'ve got the idea :-) The Nvodsk road system can be represented as n junctions connected with n\xe2\x80\x89-\xe2\x80\x891 bidirectional roads so that there is a path between any two junctions. The organizers of some event want to choose a place to accommodate the participants (junction v), and the place to set up the contests (junction u). Besides, at the one hand, they want the participants to walk about the city and see the neighbourhood (that\'s why the distance between v and u should be no less than l). On the other hand, they don\'t want the participants to freeze (so the distance between v and u should be no more than r). Besides, for every street we know its beauty \xe2\x80\x94 some integer from 0 to 109. Your task is to choose the path that fits in the length limits and has the largest average beauty. We shall define the average beauty as a median of sequence of the beauties of all roads along the path.We can put it more formally like that: let there be a path with the length k. Let ai be a non-decreasing sequence that contains exactly k elements. Each number occurs there exactly the number of times a road with such beauty occurs along on path. We will represent the path median as number a\xe2\x8c\x8ak\xe2\x80\x89/\xe2\x80\x892\xe2\x8c\x8b, assuming that indexation starting from zero is used. \xe2\x8c\x8ax\xe2\x8c\x8b \xe2\x80\x94 is number \xd1\x85, rounded down to the nearest integer.For example, if a\xe2\x80\x89=\xe2\x80\x89{0,\xe2\x80\x895,\xe2\x80\x8912}, then the median equals to 5, and if a\xe2\x80\x89=\xe2\x80\x89{0,\xe2\x80\x895,\xe2\x80\x897,\xe2\x80\x8912}, then the median is number 7.It is guaranteed that there will be at least one path with the suitable quantity of roads." 3000

150D "Mission Impassable" dp,strings "Market stalls now have the long-awaited game The Colder Scrools V: Nvodsk. The game turned out to be difficult as hell and most students can\'t complete the last quest (""We don\'t go to Nvodsk...""). That threatened winter exams. The rector already started to wonder whether he should postpone the winter exams till April (in fact, he wanted to complete the quest himself). But all of a sudden a stranger appeared at the door of his office. ""Good afternoon. My name is Chuck and I solve any problems"" \xe2\x80\x94 he said.And here they are sitting side by side but still they can\'t complete the mission. The thing is, to kill the final boss one should prove one\'s perfect skills in the art of managing letters. One should be a real magician to do that. And can you imagine what happens when magicians start competing... But let\'s put it more formally: you are given a string and a set of integers ai. You are allowed to choose any substring that is a palindrome and delete it. At that we receive some number of points equal to ak, where k is the length of the deleted palindrome. For some k, ak\xe2\x80\x89=\xe2\x80\x89-1, which means that deleting palindrome strings of such length is forbidden. After a substring is deleted, the remaining part ""shifts together"", that is, at no moment of time the string has gaps. The process is repeated while the string has at least one palindrome substring that can be deleted. All gained points are summed up.Determine what maximum number of points can be earned.""Oh"" \xe2\x80\x94 said Chuck, raising from the chair, \xe2\x80\x94 ""I used to love deleting palindromes, just like you, but one day I took an arrow in the Knee""." 2600

150C "Smart Cheater" "data structures,math,probabilities" "I guess there\'s not much point in reminding you that Nvodsk winters aren\'t exactly hot. That increased the popularity of the public transport dramatically. The route of bus 62 has exactly n stops (stop 1 goes first on its way and stop n goes last). The stops are positioned on a straight line and their coordinates are 0\xe2\x80\x89=\xe2\x80\x89x1\xe2\x80\x89<\xe2\x80\x89x2\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89xn. Each day exactly m people use bus 62. For each person we know the number of the stop where he gets on the bus and the number of the stop where he gets off the bus. A ticket from stop a to stop b (a\xe2\x80\x89<\xe2\x80\x89b) costs xb\xe2\x80\x89-\xe2\x80\x89xa rubles. However, the conductor can choose no more than one segment NOT TO SELL a ticket for. We mean that conductor should choose C and D (\xd0\xa1 <= D) and sell a ticket for the segments [A, C] and [D, B], or not sell the ticket at all. The conductor and the passenger divide the saved money between themselves equally. The conductor\'s ""untaxed income"" is sometimes interrupted by inspections that take place as the bus drives on some segment of the route located between two consecutive stops. The inspector fines the conductor by c rubles for each passenger who doesn\'t have the ticket for this route\'s segment.You know the coordinated of all stops xi; the numbers of stops where the i-th passenger gets on and off, ai and bi (ai\xe2\x80\x89<\xe2\x80\x89bi); the fine c; and also pi \xe2\x80\x94 the probability of inspection on segment between the i-th and the i\xe2\x80\x89+\xe2\x80\x891-th stop. The conductor asked you to help him make a plan of selling tickets that maximizes the mathematical expectation of his profit." 2200

150B "Quantity of Strings" "combinatorics,dfs and similar,graphs,math" "Just in case somebody missed it: this winter is totally cold in Nvodsk! It is so cold that one gets funny thoughts. For example, let\'s say there are strings with the length exactly n, based on the alphabet of size m. Any its substring with length equal to k is a palindrome. How many such strings exist? Your task is to find their quantity modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897). Be careful and don\'t miss a string or two!Let us remind you that a string is a palindrome if it can be read the same way in either direction, from the left to the right and from the right to the left." 1600

150A "Win or Freeze" "games,math,number theory" "You can\'t possibly imagine how cold our friends are this winter in Nvodsk! Two of them play the following game to warm up: initially a piece of paper has an integer q. During a move a player should write any integer number that is a non-trivial divisor of the last written number. Then he should run this number of circles around the hotel. Let us remind you that a number\'s divisor is called non-trivial if it is different from one and from the divided number itself. The first person who can\'t make a move wins as he continues to lie in his warm bed under three blankets while the other one keeps running. Determine which player wins considering that both players play optimally. If the first player wins, print any winning first move." 1400

149E "Martian Strings" "string suffix structures,strings" "During the study of the Martians Petya clearly understood that the Martians are absolutely lazy. They like to sleep and don\'t like to wake up. Imagine a Martian who has exactly n eyes located in a row and numbered from the left to the right from 1 to n. When a Martian sleeps, he puts a patch on each eye (so that the Martian morning doesn\'t wake him up). The inner side of each patch has an uppercase Latin letter. So, when a Martian wakes up and opens all his eyes he sees a string s consisting of uppercase Latin letters. The string\'s length is n. ""Ding dong!"" \xe2\x80\x94 the alarm goes off. A Martian has already woken up but he hasn\'t opened any of his eyes. He feels that today is going to be a hard day, so he wants to open his eyes and see something good. The Martian considers only m Martian words beautiful. Besides, it is hard for him to open all eyes at once so early in the morning. So he opens two non-overlapping segments of consecutive eyes. More formally, the Martian chooses four numbers a, b, c, d, (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b\xe2\x80\x89<\xe2\x80\x89c\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89d\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) and opens all eyes with numbers i such that a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b or c\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89d. After the Martian opens the eyes he needs, he reads all the visible characters from the left to the right and thus, he sees some word.Let\'s consider all different words the Martian can see in the morning. Your task is to find out how many beautiful words are among them." 2300

149D "Coloring Brackets" dp "Once Petya read a problem about a bracket sequence. He gave it much thought but didn\'t find a solution. Today you will face it.You are given string s. It represents a correct bracket sequence. A correct bracket sequence is the sequence of opening (""("") and closing ("")"") brackets, such that it is possible to obtain a correct mathematical expression from it, inserting numbers and operators between the brackets. For example, such sequences as ""(())()"" and ""()"" are correct bracket sequences and such sequences as "")()"" and ""(()"" are not.In a correct bracket sequence each bracket corresponds to the matching bracket (an opening bracket corresponds to the matching closing bracket and vice versa). For example, in a bracket sequence shown of the figure below, the third bracket corresponds to the matching sixth one and the fifth bracket corresponds to the fourth one.   You are allowed to color some brackets in the bracket sequence so as all three conditions are fulfilled:   Each bracket is either not colored any color, or is colored red, or is colored blue.  For any pair of matching brackets exactly one of them is colored. In other words, for any bracket the following is true: either it or the matching bracket that corresponds to it is colored.  No two neighboring colored brackets have the same color. Find the number of different ways to color the bracket sequence. The ways should meet the above-given conditions. Two ways of coloring are considered different if they differ in the color of at least one bracket. As the result can be quite large, print it modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." 1900

149C "Division into Teams" greedy,math,sortings "Petya loves football very much, especially when his parents aren\'t home. Each morning he comes to the yard, gathers his friends and they play all day. From time to time they have a break to have some food or do some chores (for example, water the flowers).The key in football is to divide into teams fairly before the game begins. There are n boys playing football in the yard (including Petya), each boy\'s football playing skill is expressed with a non-negative characteristic ai (the larger it is, the better the boy plays). Let\'s denote the number of players in the first team as x, the number of players in the second team as y, the individual numbers of boys who play for the first team as pi and the individual numbers of boys who play for the second team as qi. Division n boys into two teams is considered fair if three conditions are fulfilled:  Each boy plays for exactly one team (x\xe2\x80\x89+\xe2\x80\x89y\xe2\x80\x89=\xe2\x80\x89n).  The sizes of teams differ in no more than one (|x\xe2\x80\x89-\xe2\x80\x89y|\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x891).  The total football playing skills for two teams differ in no more than by the value of skill the best player in the yard has. More formally: Your task is to help guys divide into two teams fairly. It is guaranteed that a fair division into two teams always exists." 1500

149B "Martian Clock" implementation "Having stayed home alone, Petya decided to watch forbidden films on the Net in secret. ""What ungentlemanly behavior!"" \xe2\x80\x94 you can say that, of course, but don\'t be too harsh on the kid. In his country films about the Martians and other extraterrestrial civilizations are forbidden. It was very unfair to Petya as he adored adventure stories that featured lasers and robots. Today Petya is watching a shocking blockbuster about the Martians called ""R2:D2"". What can ""R2:D2"" possibly mean? It might be the Martian time represented in the Martian numeral system. Petya knows that time on Mars is counted just like on the Earth (that is, there are 24 hours and each hour has 60 minutes). The time is written as ""a:b"", where the string a stands for the number of hours (from 0 to 23 inclusive), and string b stands for the number of minutes (from 0 to 59 inclusive). The only thing Petya doesn\'t know is in what numeral system the Martian time is written.Your task is to print the radixes of all numeral system which can contain the time ""a:b""." 1600

149A "Business trip" greedy,implementation,sortings "What joy! Petya\'s parents went on a business trip for the whole year and the playful kid is left all by himself. Petya got absolutely happy. He jumped on the bed and threw pillows all day long, until... Today Petya opened the cupboard and found a scary note there. His parents had left him with duties: he should water their favourite flower all year, each day, in the morning, in the afternoon and in the evening. ""Wait a second!"" \xe2\x80\x94 thought Petya. He know for a fact that if he fulfills the parents\' task in the i-th (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x8912) month of the year, then the flower will grow by ai centimeters, and if he doesn\'t water the flower in the i-th month, then the flower won\'t grow this month. Petya also knows that try as he might, his parents won\'t believe that he has been watering the flower if it grows strictly less than by k centimeters. Help Petya choose the minimum number of months when he will water the flower, given that the flower should grow no less than by k centimeters." 900

148E Porcelain dp "During her tantrums the princess usually smashes some collectable porcelain. Every furious shriek is accompanied with one item smashed.The collection of porcelain is arranged neatly on n shelves. Within each shelf the items are placed in one row, so that one can access only the outermost items \xe2\x80\x94 the leftmost or the rightmost item, not the ones in the middle of the shelf. Once an item is taken, the next item on that side of the shelf can be accessed (see example). Once an item is taken, it can\'t be returned to the shelves.You are given the values of all items. Your task is to find the maximal damage the princess\' tantrum of m shrieks can inflict on the collection of porcelain." 1900

148D "Bag of mice" dp,games,math,probabilities "The dragon and the princess are arguing about what to do on the New Year\'s Eve. The dragon suggests flying to the mountains to watch fairies dancing in the moonlight, while the princess thinks they should just go to bed early. They are desperate to come to an amicable agreement, so they decide to leave this up to chance.They take turns drawing a mouse from a bag which initially contains w white and b black mice. The person who is the first to draw a white mouse wins. After each mouse drawn by the dragon the rest of mice in the bag panic, and one of them jumps out of the bag itself (the princess draws her mice carefully and doesn\'t scare other mice). Princess draws first. What is the probability of the princess winning?If there are no more mice in the bag and nobody has drawn a white mouse, the dragon wins. Mice which jump out of the bag themselves are not considered to be drawn (do not define the winner). Once a mouse has left the bag, it never returns to it. Every mouse is drawn from the bag with the same probability as every other one, and every mouse jumps out of the bag with the same probability as every other one." 1800

148C "Terse princess" "constructive algorithms,greedy" "\xc2\xabNext please\xc2\xbb, \xe2\x80\x94 the princess called and cast an estimating glance at the next groom.The princess intends to choose the most worthy groom, this is, the richest one. Whenever she sees a groom who is more rich than each of the previous ones, she says a measured \xc2\xabOh...\xc2\xbb. Whenever the groom is richer than all previous ones added together, she exclaims \xc2\xabWow!\xc2\xbb (no \xc2\xabOh...\xc2\xbb in this case). At the sight of the first groom the princess stays calm and says nothing.The fortune of each groom is described with an integer between 1 and 50000. You know that during the day the princess saw n grooms, said \xc2\xabOh...\xc2\xbb exactly a times and exclaimed \xc2\xabWow!\xc2\xbb exactly b times. Your task is to output a sequence of n integers t1,\xe2\x80\x89t2,\xe2\x80\x89...,\xe2\x80\x89tn, where ti describes the fortune of i-th groom. If several sequences are possible, output any of them. If no sequence exists that would satisfy all the requirements, output a single number -1." 1700

148B Escape implementation,math "The princess is going to escape the dragon\'s cave, and she needs to plan it carefully.The princess runs at vp miles per hour, and the dragon flies at vd miles per hour. The dragon will discover the escape after t hours and will chase the princess immediately. Looks like there\'s no chance to success, but the princess noticed that the dragon is very greedy and not too smart. To delay him, the princess decides to borrow a couple of bijous from his treasury. Once the dragon overtakes the princess, she will drop one bijou to distract him. In this case he will stop, pick up the item, return to the cave and spend f hours to straighten the things out in the treasury. Only after this will he resume the chase again from the very beginning.The princess is going to run on the straight. The distance between the cave and the king\'s castle she\'s aiming for is c miles. How many bijous will she need to take from the treasury to be able to reach the castle? If the dragon overtakes the princess at exactly the same moment she has reached the castle, we assume that she reached the castle before the dragon reached her, and doesn\'t need an extra bijou to hold him off." 1500

148A "Insomnia cure" "constructive algorithms,implementation,math" "\xc2\xabOne dragon. Two dragon. Three dragon\xc2\xbb, \xe2\x80\x94 the princess was counting. She had trouble falling asleep, and she got bored of counting lambs when she was nine.However, just counting dragons was boring as well, so she entertained herself at best she could. Tonight she imagined that all dragons were here to steal her, and she was fighting them off. Every k-th dragon got punched in the face with a frying pan. Every l-th dragon got his tail shut into the balcony door. Every m-th dragon got his paws trampled with sharp heels. Finally, she threatened every n-th dragon to call her mom, and he withdrew in panic.How many imaginary dragons suffered moral or physical damage tonight, if the princess counted a total of d dragons?" 800

147B "Smile House" "binary search,graphs,matrices" "A smile house is created to raise the mood. It has n rooms. Some of the rooms are connected by doors. For each two rooms (number i and j), which are connected by a door, Petya knows their value cij \xe2\x80\x94 the value which is being added to his mood when he moves from room i to room j.Petya wondered whether he can raise his mood infinitely, moving along some cycle? And if he can, then what minimum number of rooms he will need to visit during one period of a cycle?" 2500

147A Punctuation implementation,strings "You are given a text that consists of lowercase Latin letters, spaces and punctuation marks (dot, comma, exclamation mark and question mark). A word is defined as a sequence of consecutive Latin letters.Your task is to add spaces to the text by the following rules:  if there is no punctuation mark between two words, then they should be separated by exactly one space  there should be no spaces before each punctuation mark  there should be exactly one space after each punctuation mark It is guaranteed that there is at least one word between any two punctuation marks. The text begins and ends with a Latin letter." 1300

146B "Lucky Mask" "brute force,implementation" "Petya loves lucky numbers very much. Everybody knows that lucky numbers are positive integers whose decimal record contains only the lucky digits 4 and 7. For example, numbers 47, 744, 4 are lucky and 5, 17, 467 are not.Petya calls a mask of a positive integer n the number that is obtained after successive writing of all lucky digits of number n from the left to the right. For example, the mask of number 72174994 is number 7744, the mask of 7 is 7, the mask of 9999047 is 47. Obviously, mask of any number is always a lucky number.Petya has two numbers \xe2\x80\x94 an arbitrary integer a and a lucky number b. Help him find the minimum number c (c\xe2\x80\x89>\xe2\x80\x89a) such that the mask of number c equals b." 1300

146A "Lucky Ticket" implementation "Petya loves lucky numbers very much. Everybody knows that lucky numbers are positive integers whose decimal record contains only the lucky digits 4 and 7. For example, numbers 47, 744, 4 are lucky and 5, 17, 467 are not.Petya loves tickets very much. As we know, each ticket has a number that is a positive integer. Its length equals n (n is always even). Petya calls a ticket lucky if the ticket\'s number is a lucky number and the sum of digits in the first half (the sum of the first n\xe2\x80\x89/\xe2\x80\x892 digits) equals the sum of digits in the second half (the sum of the last n\xe2\x80\x89/\xe2\x80\x892 digits). Check if the given ticket is lucky." 800

145E "Lucky Queries" "data structures" "Petya loves lucky numbers very much. Everybody knows that lucky numbers are positive integers whose decimal record contains only the lucky digits 4 and 7. For example, numbers 47, 744, 4 are lucky and 5, 17, 467 are not.Petya brought home string s with the length of n. The string only consists of lucky digits. The digits are numbered from the left to the right starting with 1. Now Petya should execute m queries of the following form:  switch l r \xe2\x80\x94 ""switch"" digits (i.e. replace them with their opposites) at all positions with indexes from l to r, inclusive: each digit 4 is replaced with 7 and each digit 7 is replaced with 4 (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n);  count \xe2\x80\x94 find and print on the screen the length of the longest non-decreasing subsequence of string s. Subsequence of a string s is a string that can be obtained from s by removing zero or more of its elements. A string is called non-decreasing if each successive digit is not less than the previous one.Help Petya process the requests." 2400

145D "Lucky Pair" "combinatorics,data structures,implementation" "Petya loves lucky numbers very much. Everybody knows that lucky numbers are positive integers whose decimal record contains only the lucky digits 4 and 7. For example, numbers 47, 744, 4 are lucky and 5, 17, 467 are not.Petya has an array a of n integers. The numbers in the array are numbered starting from 1. Unfortunately, Petya has been misbehaving and so, his parents don\'t allow him play with arrays that have many lucky numbers. It is guaranteed that no more than 1000 elements in the array a are lucky numbers. Petya needs to find the number of pairs of non-intersecting segments [l1;r1] and [l2;r2] (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r1\xe2\x80\x89<\xe2\x80\x89l2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n, all four numbers are integers) such that there\'s no such lucky number that occurs simultaneously in the subarray a[l1..r1] and in the subarray a[l2..r2]. Help Petya count the number of such pairs." 2900

145C "Lucky Subsequence" combinatorics,dp,math "Petya loves lucky numbers very much. Everybody knows that lucky numbers are positive integers whose decimal record contains only the lucky digits 4 and 7. For example, numbers 47, 744, 4 are lucky and 5, 17, 467 are not.Petya has sequence a consisting of n integers.The subsequence of the sequence a is such subsequence that can be obtained from a by removing zero or more of its elements.Two sequences are considered different if index sets of numbers included in them are different. That is, the values \xe2\x80\x8bof the elements \xe2\x80\x8bdo not matter in the comparison of subsequences. In particular, any sequence of length n has exactly 2n different subsequences (including an empty subsequence).A subsequence is considered lucky if it has a length exactly k and does not contain two identical lucky numbers (unlucky numbers can be repeated any number of times).Help Petya find the number of different lucky subsequences of the sequence a. As Petya\'s parents don\'t let him play with large numbers, you should print the result modulo prime number 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." 2100

145B "Lucky Number 2" "constructive algorithms" "Petya loves lucky numbers very much. Everybody knows that lucky numbers are positive integers whose decimal record contains only the lucky digits 4 and 7. For example, numbers 47, 744, 4 are lucky and 5, 17, 467 are not.Petya loves long lucky numbers very much. He is interested in the minimum lucky number d that meets some condition. Let cnt(x) be the number of occurrences of number x in number d as a substring. For example, if d\xe2\x80\x89=\xe2\x80\x89747747, then cnt(4)\xe2\x80\x89=\xe2\x80\x892, cnt(7)\xe2\x80\x89=\xe2\x80\x894, cnt(47)\xe2\x80\x89=\xe2\x80\x892, cnt(74)\xe2\x80\x89=\xe2\x80\x892. Petya wants the following condition to fulfil simultaneously: cnt(4)\xe2\x80\x89=\xe2\x80\x89a1, cnt(7)\xe2\x80\x89=\xe2\x80\x89a2, cnt(47)\xe2\x80\x89=\xe2\x80\x89a3, cnt(74)\xe2\x80\x89=\xe2\x80\x89a4. Petya is not interested in the occurrences of other numbers. Help him cope with this task." 1800

145A "Lucky Conversion" greedy,implementation "Petya loves lucky numbers very much. Everybody knows that lucky numbers are positive integers whose decimal record contains only the lucky digits 4 and 7. For example, numbers 47, 744, 4 are lucky and 5, 17, 467 are not.Petya has two strings a and b of the same length n. The strings consist only of lucky digits. Petya can perform operations of two types:   replace any one digit from string a by its opposite (i.e., replace 4 by 7 and 7 by 4);  swap any pair of digits in string a. Petya is interested in the minimum number of operations that are needed to make string a equal to string b. Help him with the task." 1200

144E Competition "data structures,greedy" "The secondary diagonal of a square matrix is a diagonal going from the top right to the bottom left corner. Let\'s define an n-degree staircase as a square matrix n\xe2\x80\x89\xc3\x97\xe2\x80\x89n containing no squares above the secondary diagonal (the picture below shows a 5-degree staircase).   The squares of the n-degree staircase contain m sportsmen. A sportsman needs one second to move to a side-neighboring square of the staircase. Before the beginning of the competition each sportsman must choose one of the shortest ways to the secondary diagonal. After the starting whistle the competition begins and all sportsmen start moving along the chosen paths. When a sportsman reaches a cell of the secondary diagonal, he stops and moves no more. The competition ends when all sportsmen reach the secondary diagonal. The competition is considered successful if during it no two sportsmen were present in the same square simultaneously. Any square belonging to the secondary diagonal also cannot contain more than one sportsman. If a sportsman at the given moment of time leaves a square and another sportsman comes to it, then they are not considered to occupy the same square simultaneously. Note that other extreme cases (for example, two sportsmen moving towards each other) are impossible as the chosen ways are the shortest ones.You are given positions of m sportsmen on the staircase. Your task is to choose among them the maximum number of sportsmen for who the competition can be successful, that is, so that there existed such choice of shortest ways for the sportsmen at which no two sportsmen find themselves in the same square simultaneously. All other sportsmen that are not chosen will be removed from the staircase before the competition starts." 2200

144D "Missile Silos" "data structures,dfs and similar,graphs,shortest paths" "A country called Berland consists of n cities, numbered with integer numbers from 1 to n. Some of them are connected by bidirectional roads. Each road has some length. There is a path from each city to any other one by these roads. According to some Super Duper Documents, Berland is protected by the Super Duper Missiles. The exact position of the Super Duper Secret Missile Silos is kept secret but Bob managed to get hold of the information. That information says that all silos are located exactly at a distance l from the capital. The capital is located in the city with number s.The documents give the formal definition: the Super Duper Secret Missile Silo is located at some place (which is either city or a point on a road) if and only if the shortest distance from this place to the capital along the roads of the country equals exactly l.Bob wants to know how many missile silos are located in Berland to sell the information then to enemy spies. Help Bob." 1900

144C "Anagram Search" implementation,strings "A string t is called an anagram of the string s, if it is possible to rearrange letters in t so that it is identical to the string s. For example, the string ""aab"" is an anagram of the string ""aba"" and the string ""aaa"" is not.The string t is called a substring of the string s if it can be read starting from some position in the string s. For example, the string ""aba"" has six substrings: ""a"", ""b"", ""a"", ""ab"", ""ba"", ""aba"".You are given a string s, consisting of lowercase Latin letters and characters ""?"". You are also given a string p, consisting of lowercase Latin letters only. Let\'s assume that a string is good if you can obtain an anagram of the string p from it, replacing the ""?"" characters by Latin letters. Each ""?"" can be replaced by exactly one character of the Latin alphabet. For example, if the string p = \xc2\xababa\xc2\xbb, then the string ""a??"" is good, and the string \xc2\xab?bc\xc2\xbb is not. Your task is to find the number of good substrings of the string s (identical substrings must be counted in the answer several times)." 1500

144B Meeting implementation "The Super Duper Secret Meeting of the Super Duper Secret Military Squad takes place in a Super Duper Secret Place. The place is an infinite plane with introduced Cartesian coordinate system. The meeting table is represented as a rectangle whose sides are parallel to the coordinate axes and whose vertexes are located at the integer points of the plane. At each integer point which belongs to the table perimeter there is a chair in which a general sits.Some points on the plane contain radiators for the generals not to freeze in winter. Each radiator is characterized by the number ri \xe2\x80\x94 the radius of the area this radiator can heat. That is, if the distance between some general and the given radiator is less than or equal to ri, than the general feels comfortable and warm. Here distance is defined as Euclidean distance, so the distance between points (x1,\xe2\x80\x89y1) and (x2,\xe2\x80\x89y2) is Each general who is located outside the radiators\' heating area can get sick. Thus, you should bring him a warm blanket. Your task is to count the number of warm blankets you should bring to the Super Duper Secret Place.The generals who are already comfortable do not need a blanket. Also the generals never overheat, ever if they are located in the heating area of several radiators. The radiators can be located at any integer points on the plane, even inside the rectangle (under the table) or on the perimeter (directly under some general). Even in this case their radius does not change." 1300

144A "Arrival of the General" implementation "A Ministry for Defense sent a general to inspect the Super Secret Military Squad under the command of the Colonel SuperDuper. Having learned the news, the colonel ordered to all n squad soldiers to line up on the parade ground.By the military charter the soldiers should stand in the order of non-increasing of their height. But as there\'s virtually no time to do that, the soldiers lined up in the arbitrary order. However, the general is rather short-sighted and he thinks that the soldiers lined up correctly if the first soldier in the line has the maximum height and the last soldier has the minimum height. Please note that the way other solders are positioned does not matter, including the case when there are several soldiers whose height is maximum or minimum. Only the heights of the first and the last soldier are important.For example, the general considers the sequence of heights (4, 3, 4, 2, 1, 1) correct and the sequence (4, 3, 1, 2, 2) wrong.Within one second the colonel can swap any two neighboring soldiers. Help him count the minimum time needed to form a line-up which the general will consider correct." 800

143B "Help Kingdom of Far Far Away 2" implementation,strings "For some time the program of rounding numbers that had been developed by the Codeforces participants during one of the previous rounds, helped the citizens of Far Far Away to convert numbers into a more easily readable format. However, as time went by, the economy of the Far Far Away developed and the scale of operations grew. So the King ordered to found the Bank of Far Far Away and very soon even the rounding didn\'t help to quickly determine even the order of the numbers involved in operations. Besides, rounding a number to an integer wasn\'t very convenient as a bank needed to operate with all numbers with accuracy of up to 0.01, and not up to an integer.The King issued yet another order: to introduce financial format to represent numbers denoting amounts of money. The formal rules of storing a number in the financial format are as follows:   A number contains the integer part and the fractional part. The two parts are separated with a character ""."" (decimal point).  To make digits in the integer part of a number easier to read, they are split into groups of three digits, starting from the least significant ones. The groups are separated with the character "","" (comma). For example, if the integer part of a number equals 12345678, then it will be stored in the financial format as 12,345,678  In the financial format a number\'s fractional part should contain exactly two digits. So, if the initial number (the number that is converted into the financial format) contains less than two digits in the fractional part (or contains no digits at all), it is complemented with zeros until its length equals 2. If the fractional part contains more than two digits, the extra digits are simply discarded (they are not rounded: see sample tests).  When a number is stored in the financial format, the minus sign is not written. Instead, if the initial number had the minus sign, the result is written in round brackets.  Please keep in mind that the bank of Far Far Away operates using an exotic foreign currency \xe2\x80\x94 snakes ($), that\'s why right before the number in the financial format we should put the sign ""$"". If the number should be written in the brackets, then the snake sign should also be inside the brackets. For example, by the above given rules number 2012 will be stored in the financial format as ""$2,012.00"" and number -12345678.9 will be stored as ""($12,345,678.90)"".The merchants of Far Far Away visited you again and expressed much hope that you supply them with the program that can convert arbitrary numbers to the financial format. Can you help them?" 1200

143A "Help Vasilisa the Wise 2" "brute force,math" "Vasilisa the Wise from the Kingdom of Far Far Away got a magic box with a secret as a present from her friend Hellawisa the Wise from the Kingdom of A Little Closer. However, Vasilisa the Wise does not know what the box\'s secret is, since she cannot open it again. She hopes that you will help her one more time with that.The box\'s lock looks as follows: it contains 4 identical deepenings for gems as a 2\xe2\x80\x89\xc3\x97\xe2\x80\x892 square, and some integer numbers are written at the lock\'s edge near the deepenings. The example of a lock is given on the picture below.  The box is accompanied with 9 gems. Their shapes match the deepenings\' shapes and each gem contains one number from 1 to 9 (each number is written on exactly one gem). The box will only open after it is decorated with gems correctly: that is, each deepening in the lock should be filled with exactly one gem. Also, the sums of numbers in the square\'s rows, columns and two diagonals of the square should match the numbers written at the lock\'s edge. For example, the above lock will open if we fill the deepenings with gems with numbers as is shown on the picture below.  Now Vasilisa the Wise wants to define, given the numbers on the box\'s lock, which gems she should put in the deepenings to open the box. Help Vasilisa to solve this challenging task." 1000

142E "Help Greg the Dwarf 2" geometry "Greg the Dwarf has been really busy recently with excavations by the Neverland Mountain. However for the well-known reasons (as you probably remember he is a very unusual dwarf and he cannot stand sunlight) Greg can only excavate at night. And in the morning he should be in his crypt before the first sun ray strikes. That\'s why he wants to find the shortest route from the excavation point to his crypt. Greg has recollected how the Codeforces participants successfully solved the problem of transporting his coffin to a crypt. So, in some miraculous way Greg appeared in your bedroom and asks you to help him in a highly persuasive manner. As usual, you didn\'t feel like turning him down.After some thought, you formalized the task as follows: as the Neverland mountain has a regular shape and ends with a rather sharp peak, it can be represented as a cone whose base radius equals r and whose height equals h. The graveyard where Greg is busy excavating and his crypt can be represented by two points on the cone\'s surface. All you\'ve got to do is find the distance between points on the cone\'s surface. The task is complicated by the fact that the mountain\'s base on the ground level and even everything below the mountain has been dug through by gnome (one may wonder whether they\'ve been looking for the same stuff as Greg...). So, one can consider the shortest way to pass not only along the side surface, but also along the cone\'s base (and in a specific case both points can lie on the cone\'s base \xe2\x80\x94 see the first sample test)Greg will be satisfied with the problem solution represented as the length of the shortest path between two points \xe2\x80\x94 he can find his way pretty well on his own. He gave you two hours to solve the problem and the time is ticking!" 3000

142D "Help Shrek and Donkey 2" games "Having learned (not without some help from the Codeforces participants) to play the card game from the previous round optimally, Shrek and Donkey (as you may remember, they too live now in the Kingdom of Far Far Away) have decided to quit the boring card games and play with toy soldiers.The rules of the game are as follows: there is a battlefield, its size equals n\xe2\x80\x89\xc3\x97\xe2\x80\x89m squares, some squares contain the toy soldiers (the green ones belong to Shrek and the red ones belong to Donkey). Besides, each of the n lines of the area contains not more than two soldiers. During a move a players should select not less than 1 and not more than k soldiers belonging to him and make them either attack or retreat.An attack is moving all of the selected soldiers along the lines on which they stand in the direction of an enemy soldier, if he is in this line. If this line doesn\'t have an enemy soldier, then the selected soldier on this line can move in any direction during the player\'s move. Each selected soldier has to move at least by one cell. Different soldiers can move by a different number of cells. During the attack the soldiers are not allowed to cross the cells where other soldiers stand (or stood immediately before the attack). It is also not allowed to go beyond the battlefield or finish the attack in the cells, where other soldiers stand (or stood immediately before attack).A retreat is moving all of the selected soldiers along the lines on which they stand in the direction from an enemy soldier, if he is in this line. The other rules repeat the rules of the attack.For example, let\'s suppose that the original battlefield had the form (here symbols ""G"" mark Shrek\'s green soldiers and symbols ""R"" mark Donkey\'s red ones):  -G-R--R-G-  Let\'s suppose that k\xe2\x80\x89=\xe2\x80\x892 and Shrek moves first. If he decides to attack, then after his move the battlefield can look like that:  --GR-     --GR-     -G-R--RG--     -R-G-     -RG--  If in the previous example Shrek decides to retreat, then after his move the battlefield can look like that:  G--R-     G--R-     -G-R--R--G     -R-G-     -R--G  On the other hand, the followings fields cannot result from Shrek\'s correct move:  G--R-     ---RG     --GR--RG--     -R-G-     GR---  Shrek starts the game. To make a move means to attack or to retreat by the rules. A player who cannot make a move loses and his opponent is the winner. Determine the winner of the given toy soldier game if Shrek and Donkey continue to be under the yellow pills from the last rounds\' problem. Thus, they always play optimally (that is, they try to win if it is possible, or finish the game in a draw, by ensuring that it lasts forever, if they cannot win)." 2600

142C "Help Caretaker" "brute force,dp" "Autumn came late to the kingdom of Far Far Away. The harvest was exuberant and it is now time to get ready for the winter. As most people celebrate the Harvest festival, Simon the Caretaker tries to solve a very non-trivial task of how to find place for the agricultural equipment in the warehouse.He\'s got problems with some particularly large piece of equipment, which is, of course, turboplows. The problem is that when a turboplow is stored, it takes up not some simply rectangular space. It takes up a T-shaped space like on one of the four pictures below (here character ""#"" stands for the space occupied by the turboplow and character ""."" stands for the free space):   ###      ..#      .#.      #...#.      ###      .#.      ###.#.      ..#      ###      #..   Simon faced a quite natural challenge: placing in the given n\xe2\x80\x89\xc3\x97\xe2\x80\x89m cells warehouse the maximum number of turboplows. As one stores the turboplows, he can rotate them in any manner (so that they take up the space like on one of the four pictures above). However, two turboplows cannot ""overlap"", that is, they cannot share the same cell in the warehouse.Simon feels that he alone cannot find the optimal way of positioning the plugs in the warehouse that would maximize their quantity. Can you help him?" 2300

142B "Help General" "constructive algorithms,greedy,implementation" "Once upon a time in the Kingdom of Far Far Away lived Sir Lancelot, the chief Royal General. He was very proud of his men and he liked to invite the King to come and watch drill exercises which demonstrated the fighting techniques and tactics of the squad he was in charge of. But time went by and one day Sir Lancelot had a major argument with the Fairy Godmother (there were rumors that the argument occurred after the general spoke badly of the Godmother\'s flying techniques. That seemed to hurt the Fairy Godmother very deeply). As the result of the argument, the Godmother put a rather strange curse upon the general. It sounded all complicated and quite harmless: ""If the squared distance between some two soldiers equals to 5, then those soldiers will conflict with each other!""The drill exercises are held on a rectangular n\xe2\x80\x89\xc3\x97\xe2\x80\x89m field, split into nm square 1\xe2\x80\x89\xc3\x97\xe2\x80\x891 segments for each soldier. Thus, the square of the distance between the soldiers that stand on squares (x1,\xe2\x80\x89y1) and (x2,\xe2\x80\x89y2) equals exactly (x1\xe2\x80\x89-\xe2\x80\x89x2)2\xe2\x80\x89+\xe2\x80\x89(y1\xe2\x80\x89-\xe2\x80\x89y2)2. Now not all nm squad soldiers can participate in the drill exercises as it was before the Fairy Godmother\'s curse. Unless, of course, the general wants the soldiers to fight with each other or even worse... For example, if he puts a soldier in the square (2,\xe2\x80\x892), then he cannot put soldiers in the squares (1,\xe2\x80\x894), (3,\xe2\x80\x894), (4,\xe2\x80\x891) and (4,\xe2\x80\x893) \xe2\x80\x94 each of them will conflict with the soldier in the square (2,\xe2\x80\x892).Your task is to help the general. You are given the size of the drill exercise field. You are asked to calculate the maximum number of soldiers that can be simultaneously positioned on this field, so that no two soldiers fall under the Fairy Godmother\'s curse." 1800

142A "Help Farmer" "brute force,math" "Once upon a time in the Kingdom of Far Far Away lived Sam the Farmer. Sam had a cow named Dawn and he was deeply attached to her. Sam would spend the whole summer stocking hay to feed Dawn in winter. Sam scythed hay and put it into haystack. As Sam was a bright farmer, he tried to make the process of storing hay simpler and more convenient to use. He collected the hay into cubical hay blocks of the same size. Then he stored the blocks in his barn. After a summer spent in hard toil Sam stored A\xc2\xb7B\xc2\xb7C hay blocks and stored them in a barn as a rectangular parallelepiped A layers high. Each layer had B rows and each row had C blocks.At the end of the autumn Sam came into the barn to admire one more time the hay he\'d been stacking during this hard summer. Unfortunately, Sam was horrified to see that the hay blocks had been carelessly scattered around the barn. The place was a complete mess. As it turned out, thieves had sneaked into the barn. They completely dissembled and took away a layer of blocks from the parallelepiped\'s front, back, top and sides. As a result, the barn only had a parallelepiped containing (A\xe2\x80\x89-\xe2\x80\x891)\xe2\x80\x89\xc3\x97\xe2\x80\x89(B\xe2\x80\x89-\xe2\x80\x892)\xe2\x80\x89\xc3\x97\xe2\x80\x89(C\xe2\x80\x89-\xe2\x80\x892) hay blocks. To hide the evidence of the crime, the thieves had dissembled the parallelepiped into single 1\xe2\x80\x89\xc3\x97\xe2\x80\x891\xe2\x80\x89\xc3\x97\xe2\x80\x891 blocks and scattered them around the barn. After the theft Sam counted n hay blocks in the barn but he forgot numbers A, B \xd0\xb8 C.Given number n, find the minimally possible and maximally possible number of stolen hay blocks." 1600

141E "Clearing Up" "constructive algorithms,dp,dsu,graphs" "After Santa Claus and his assistant Elf delivered all the presents and made all the wishes come true, they returned to the North Pole and found out that it is all covered with snow. Both of them were quite tired and they decided only to remove the snow from the roads connecting huts. The North Pole has n huts connected with m roads. One can go along the roads in both directions. The Elf offered to split: Santa Claus will clear up the wide roads and the Elf will tread out the narrow roads. For each road they decided who will clear it: Santa Claus or the Elf. To minimize the efforts they decided to clear the road so as to fulfill both those conditions:   between any two huts should exist exactly one simple path along the cleared roads;  Santa Claus and the Elf should clear the same number of roads. At this point Santa Claus and his assistant Elf wondered which roads should they clear up?" 2300

141D "Take-off Ramps" "graphs,shortest paths" "Vasya participates in a ski race along the X axis. The start is at point 0, and the finish is at L, that is, at a distance L meters from the start in the positive direction of the axis. Vasya has been training so hard that he can run one meter in exactly one second.Besides, there are n take-off ramps on the track, each ramp is characterized by four numbers:   xi represents the ramp\'s coordinate  di represents from how many meters Vasya will land if he goes down this ramp  ti represents the flight time in seconds  pi is the number, indicating for how many meters Vasya should gather speed to get ready and fly off the ramp. As Vasya gathers speed, he should ski on the snow (that is, he should not be flying), but his speed still equals one meter per second. Vasya is allowed to move in any direction on the X axis, but he is prohibited to cross the start line, that is go to the negative semiaxis. Vasya himself chooses which take-off ramps he will use and in what order, that is, he is not obliged to take off from all the ramps he encounters. Specifically, Vasya can skip the ramp. It is guaranteed that xi\xe2\x80\x89+\xe2\x80\x89di\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89L, that is, Vasya cannot cross the finish line in flight.Vasya can jump from the ramp only in the positive direction of X axis. More formally, when using the i-th ramp, Vasya starts gathering speed at point xi\xe2\x80\x89-\xe2\x80\x89pi, jumps at point xi, and lands at point xi\xe2\x80\x89+\xe2\x80\x89di. He cannot use the ramp in opposite direction.Your task is to find the minimum time that Vasya will spend to cover the distance." 2300

141C Queue "constructive algorithms,greedy,sortings" "In the Main Berland Bank n people stand in a queue at the cashier, everyone knows his/her height hi, and the heights of the other people in the queue. Each of them keeps in mind number ai \xe2\x80\x94 how many people who are taller than him/her and stand in queue in front of him.After a while the cashier has a lunch break and the people in the queue seat on the chairs in the waiting room in a random order.When the lunch break was over, it turned out that nobody can remember the exact order of the people in the queue, but everyone remembers his number ai.Your task is to restore the order in which the people stood in the queue if it is possible. There may be several acceptable orders, but you need to find any of them. Also, you need to print a possible set of numbers hi \xe2\x80\x94 the heights of people in the queue, so that the numbers ai are correct." 1800

141B Hopscotch geometry,math "So nearly half of the winter is over and Maria is dreaming about summer. She\'s fed up with skates and sleds, she was dreaming about Hopscotch all night long. It\'s a very popular children\'s game. The game field, the court, looks as is shown in the figure (all blocks are square and are numbered from bottom to top, blocks in the same row are numbered from left to right). Let us describe the hopscotch with numbers that denote the number of squares in the row, staring from the lowest one: 1-1-2-1-2-1-2-(1-2)..., where then the period is repeated (1-2).  The coordinate system is defined as shown in the figure. Side of all the squares are equal and have length a.Maria is a very smart and clever girl, and she is concerned with quite serious issues: if she throws a stone into a point with coordinates (x,\xe2\x80\x89y), then will she hit some square? If the answer is positive, you are also required to determine the number of the square.It is believed that the stone has fallen into the square if it is located strictly inside it. In other words a stone that has fallen on the square border is not considered a to hit a square." 1400

141A "Amusing Joke" implementation,sortings,strings "So, the New Year holidays are over. Santa Claus and his colleagues can take a rest and have guests at last. When two ""New Year and Christmas Men"" meet, thear assistants cut out of cardboard the letters from the guest\'s name and the host\'s name in honor of this event. Then the hung the letters above the main entrance. One night, when everyone went to bed, someone took all the letters of our characters\' names. Then he may have shuffled the letters and put them in one pile in front of the door.The next morning it was impossible to find the culprit who had made the disorder. But everybody wondered whether it is possible to restore the names of the host and his guests from the letters lying at the door? That is, we need to verify that there are no extra letters, and that nobody will need to cut more letters.Help the ""New Year and Christmas Men"" and their friends to cope with this problem. You are given both inscriptions that hung over the front door the previous night, and a pile of letters that were found at the front door next morning." 800

140F "New Year Snowflake" geometry,sortings "As Gerald ..., in other words, on a New Year Eve Constantine prepared an unusual present for the Beautiful Lady. The present is the magic New Year snowflake that can make any dream come true.The New Year snowflake consists of tiny ice crystals, which can be approximately regarded as points on the plane. The beauty of the New Year snowflake is that it has a center of symmetry. This is a point such that for each crystal of the snowflake exists another crystal, symmetrical to it relative to that point. One of the crystals can be placed directly in the center of symmetry.While Constantine was choosing a snowflake among millions of other snowflakes, no less symmetrical and no less magical, then endured a difficult path through the drifts to the house of his mistress, while he was waiting with bated breath for a few long moments before the Beautiful Lady opens the door, some of the snowflake crystals melted and naturally disappeared. Constantine is sure that there were no more than k of such crystals, because he handled the snowflake very carefully. Now he is ready to demonstrate to the Beautiful Lady all the power of nanotechnology and restore the symmetry of snowflakes.You are given the coordinates of the surviving snowflake crystals, given in nanometers. Your task is to identify all possible positions of the original center of symmetry." 2600

140E "New Year Garland" combinatorics,dp "As Gerald, Alexander, Sergey and Gennady are already busy with the usual New Year chores, Edward hastily decorates the New Year Tree. And any decent New Year Tree must be decorated with a good garland. Edward has lamps of m colors and he wants to make a garland from them. That garland should represent a sequence whose length equals L. Edward\'s tree is n layers high and Edward plans to hang the garland so as to decorate the first layer with the first l1 lamps, the second layer \xe2\x80\x94 with the next l2 lamps and so on. The last n-th layer should be decorated with the last ln lamps,  Edward adores all sorts of math puzzles, so he suddenly wondered: how many different ways to assemble the garland are there given that the both following two conditions are met:   Any two lamps that follow consecutively in the same layer should have different colors.  The sets of used colors in every two neighbouring layers must be different. We consider unordered sets (not multisets), where every color occurs no more than once. So the number of lamps of particular color does not matter. Help Edward find the answer to this nagging problem or else he won\'t manage to decorate the Tree by New Year. You may consider that Edward has an unlimited number of lamps of each of m colors and it is not obligatory to use all m colors. The garlands are considered different if they differ in at least one position when represented as sequences. Calculate the answer modulo p." 2600

140D "New Year Contest" greedy,sortings "As Gerald sets the table, Alexander sends the greeting cards, and Sergey and his twins create an army of clone snowmen, Gennady writes a New Year contest.The New Year contest begins at 18:00 (6.00 P.M.) on December 31 and ends at 6:00 (6.00 A.M.) on January 1. There are n problems for the contest. The penalty time for each solved problem is set as the distance from the moment of solution submission to the New Year in minutes. For example, the problem submitted at 21:00 (9.00 P.M.) gets penalty time 180, as well as the problem submitted at 3:00 (3.00 A.M.). The total penalty time is calculated as the sum of penalty time for all solved problems. It is allowed to submit a problem exactly at the end of the contest, at 6:00 (6.00 A.M.).Gennady opened the problems exactly at 18:00 (6.00 P.M.) and managed to estimate their complexity during the first 10 minutes of the contest. He believes that writing a solution for the i-th problem will take ai minutes. Gennady can submit a solution for evaluation at any time after he completes writing it. Probably he will have to distract from writing some solution to send the solutions of other problems for evaluation. The time needed to send the solutions can be neglected, i.e. this time can be considered to equal zero. Gennady can simultaneously submit multiple solutions. Besides, he can move at any time from writing one problem to another, and then return to the first problem from the very same place, where he has left it. Thus the total solution writing time of the i-th problem always equals ai minutes. Of course, Gennady does not commit wrong attempts, and his solutions are always correct and are accepted from the first attempt. He can begin to write the solutions starting from 18:10 (6.10 P.M.).Help Gennady choose from the strategies that help him solve the maximum possible number of problems, the one with which his total penalty time will be minimum." 1800

140C "New Year Snowmen" "binary search,data structures,greedy" "As meticulous Gerald sets the table and caring Alexander sends the postcards, Sergey makes snowmen. Each showman should consist of three snowballs: a big one, a medium one and a small one. Sergey\'s twins help him: they\'ve already made n snowballs with radii equal to r1, r2, ..., rn. To make a snowman, one needs any three snowballs whose radii are pairwise different. For example, the balls with radii 1, 2 and 3 can be used to make a snowman but 2, 2, 3 or 2, 2, 2 cannot. Help Sergey and his twins to determine what maximum number of snowmen they can make from those snowballs." 1800

140B "New Year Cards" "brute force,greedy,implementation" "As meticulous Gerald sets the table, Alexander finished another post on Codeforces and begins to respond to New Year greetings from friends. Alexander has n friends, and each of them sends to Alexander exactly one e-card. Let us number his friends by numbers from 1 to n in the order in which they send the cards. Let\'s introduce the same numbering for the cards, that is, according to the numbering the i-th friend sent to Alexander a card number i.Alexander also sends cards to friends, but he doesn\'t look for the new cards on the Net. He simply uses the cards previously sent to him (sometimes, however, he does need to add some crucial details). Initially Alexander doesn\'t have any cards. Alexander always follows the two rules:  He will never send to a firend a card that this friend has sent to him.  Among the other cards available to him at the moment, Alexander always chooses one that Alexander himself likes most. Alexander plans to send to each friend exactly one card. Of course, Alexander can send the same card multiple times.Alexander and each his friend has the list of preferences, which is a permutation of integers from 1 to n. The first number in the list is the number of the favorite card, the second number shows the second favorite, and so on, the last number shows the least favorite card.Your task is to find a schedule of sending cards for Alexander. Determine at which moments of time Alexander must send cards to his friends, to please each of them as much as possible. In other words, so that as a result of applying two Alexander\'s rules, each friend receives the card that is preferred for him as much as possible.Note that Alexander doesn\'t choose freely what card to send, but he always strictly follows the two rules." 1800

140A "New Year Table" geometry,math "Gerald is setting the New Year table. The table has the form of a circle; its radius equals R. Gerald invited many guests and is concerned whether the table has enough space for plates for all those guests. Consider all plates to be round and have the same radii that equal r. Each plate must be completely inside the table and must touch the edge of the table. Of course, the plates must not intersect, but they can touch each other. Help Gerald determine whether the table is large enough for n plates." 1700

139B Wallpaper implementation,math "Having bought his own apartment, Boris decided to paper the walls in every room. Boris\'s flat has n rooms, each of which has the form of a rectangular parallelepiped. For every room we known its length, width and height of the walls in meters (different rooms can have different dimensions, including height).Boris chose m types of wallpaper to paper the walls of the rooms with (but it is not necessary to use all the types). Each type of wallpaper is sold in rolls of a fixed length and width (the length, naturally, shows how long the unfolded roll will be). In addition, for each type we know the price of one roll of this type.The wallpaper of each type contains strips running along the length of the roll. When gluing the strips must be located strictly vertically (so the roll cannot be rotated, even if the length is less than the width). Besides, a roll can be cut in an arbitrary manner, but the joints of glued pieces should also be vertical. In addition, each room should be papered by only one type of wallpaper. And pieces of the same roll cannot be used to paper different rooms. That is, for each room the rolls are purchased separately. Also, some rolls can be used not completely.After buying an apartment Boris is short of cash, so he wants to spend the minimum money on wallpaper. Help him." 1600

139A "Petr and Book" implementation "One Sunday Petr went to a bookshop and bought a new book on sports programming. The book had exactly n pages.Petr decided to start reading it starting from the next day, that is, from Monday. Petr\'s got a very tight schedule and for each day of the week he knows how many pages he will be able to read on that day. Some days are so busy that Petr will have no time to read whatsoever. However, we know that he will be able to read at least one page a week.Assuming that Petr will not skip days and will read as much as he can every day, determine on which day of the week he will read the last page of the book." 1000

138E "Hellish Constraints" "brute force,dp,two pointers" "Katya recently started to invent programming tasks and prepare her own contests. What she does not like is boring and simple constraints. Katya is fed up with all those ""N does not exceed a thousand"" and ""the sum of ai does not exceed a million"" and she decided to come up with something a little more complicated.The last problem written by Katya deals with strings. The input is a string of small Latin letters. To make the statement longer and strike terror into the people who will solve the contest, Katya came up with the following set of k restrictions of the same type (characters in restrictions can be repeated and some restrictions may contradict each other):   The number of characters c1 in a string is not less than l1 and not more than r1.  ...  The number of characters ci in a string is not less than li and not more than ri.  ...  The number of characters ck in a string is not less than lk and not more than rk. However, having decided that it is too simple and obvious, Katya added the following condition: a string meets no less than L and not more than R constraints from the above given list.Katya does not like to compose difficult and mean tests, so she just took a big string s and wants to add to the tests all its substrings that meet the constraints. However, Katya got lost in her conditions and asked you to count the number of substrings of the string s that meet the conditions (each occurrence of the substring is counted separately)." 2900

138D "World of Darkraft" dp,games "Recently Roma has become the happy owner of a new game World of Darkraft. This game combines elements of virtually all known genres, and on one of the later stages of the game Roma faced difficulties solving a puzzle.In this part Roma fights with a cunning enemy magician. The battle takes place on a rectangular field plaid n\xe2\x80\x89\xc3\x97\xe2\x80\x89m. Each cell contains one magical character: L, R or X. Initially all the squares of the field are ""active"".The players, Roma and enemy magician, take turns. Roma makes the first move. During a move a player selects one of the active cells. Then depending on the image in the character in the cell one of the following actions takes place:   L \xe2\x80\x94 magical waves radiate from the cell to the left downwards and to the right upwards along diagonal paths. All cells on the path of the waves (including the selected cell too) become inactive. The waves continue until the next inactive cell or to the edge of the field if there are no inactive cells on the way.  R \xe2\x80\x94 the magical waves radiate to the left upwards and to the right downwards.  X \xe2\x80\x94 the magical waves radiate in all four diagonal directions. If the next player cannot make a move (i.e., all cells are inactive), he loses.Roma has been trying to defeat the computer opponent for three days but he just keeps losing. He asks you to help him and determine whether it is guaranteed that he can beat the opponent, or he will have to hack the game." 2500

138C "Mushroom Gnomes - 2" "binary search,data structures,probabilities,sortings" "One day Natalia was walking in the woods when she met a little mushroom gnome. The gnome told her the following story:Everybody knows that the mushroom gnomes\' power lies in the magic mushrooms that grow in the native woods of the gnomes. There are n trees and m magic mushrooms in the woods: the i-th tree grows at a point on a straight line with coordinates ai and has the height of hi, the j-th mushroom grows at the point with coordinates bj and has magical powers zj.But one day wild mushroommunchers, the sworn enemies of mushroom gnomes unleashed a terrible storm on their home forest. As a result, some of the trees began to fall and crush the magic mushrooms. The supreme oracle of mushroom gnomes calculated in advance the probability for each tree that it will fall to the left, to the right or will stand on. If the tree with the coordinate x and height h falls to the left, then all the mushrooms that belong to the right-open interval [x\xe2\x80\x89-\xe2\x80\x89h,\xe2\x80\x89x), are destroyed. If a tree falls to the right, then the mushrooms that belong to the left-open interval (x,\xe2\x80\x89x\xe2\x80\x89+\xe2\x80\x89h] are destroyed. Only those mushrooms that are not hit by a single tree survive.Knowing that all the trees fall independently of each other (i.e., all the events are mutually independent, and besides, the trees do not interfere with other trees falling in an arbitrary direction), the supreme oracle was also able to quickly calculate what would be the expectation of the total power of the mushrooms which survived after the storm. His calculations ultimately saved the mushroom gnomes from imminent death.Natalia, as a good Olympiad programmer, got interested in this story, and she decided to come up with a way to quickly calculate the expectation of the sum of the surviving mushrooms\' power." 2200

138B "Digits Permutations" greedy "Andrey\'s favourite number is n. Andrey\'s friends gave him two identical numbers n as a New Year present. He hung them on a wall and watched them adoringly.Then Andrey got bored from looking at the same number and he started to swap digits first in one, then in the other number, then again in the first number and so on (arbitrary number of changes could be made in each number). At some point it turned out that if we sum the resulting numbers, then the number of zeroes with which the sum will end would be maximum among the possible variants of digit permutations in those numbers.Given number n, can you find the two digit permutations that have this property?" 1900

138A "Literature Lesson" implementation "Vera adores poems. All the poems Vera knows are divided into quatrains (groups of four lines) and in each quatrain some lines contain rhymes.Let\'s consider that all lines in the poems consist of lowercase Latin letters (without spaces). Letters ""a"", ""e"", ""i"", ""o"", ""u"" are considered vowels.Two lines rhyme if their suffixes that start from the k-th vowels (counting from the end) match. If a line has less than k vowels, then such line can\'t rhyme with any other line. For example, if k\xe2\x80\x89=\xe2\x80\x891, lines commit and hermit rhyme (the corresponding suffixes equal it), and if k\xe2\x80\x89=\xe2\x80\x892, they do not rhyme (ommit\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89ermit).Today on a literature lesson Vera learned that quatrains can contain four different schemes of rhymes, namely the following ones (the same letters stand for rhyming lines):   Clerihew (aabb);  Alternating (abab);  Enclosed (abba). If all lines of a quatrain pairwise rhyme, then the quatrain can belong to any rhyme scheme (this situation is represented by aaaa).If all quatrains of a poem belong to the same rhyme scheme, then we can assume that the whole poem belongs to this rhyme scheme. If in each quatrain all lines pairwise rhyme, then the rhyme scheme of the poem is aaaa. Let us note that it doesn\'t matter whether lines from different quatrains rhyme with each other or not. In other words, it is possible that different quatrains aren\'t connected by a rhyme.Vera got a long poem as a home task. The girl has to analyse it and find the poem rhyme scheme. Help Vera cope with the task." 1600

137E "Last Chance" "data structures,implementation,strings" "Having read half of the book called ""Storm and Calm"" on the IT lesson, Innocentius was absolutely determined to finish the book on the maths lessons. All was fine until the math teacher Ms. Watkins saw Innocentius reading fiction books instead of solving equations of the fifth degree. As during the last maths class Innocentius suggested the algorithm of solving equations of the fifth degree in the general case, Ms. Watkins had no other choice but to give him a new task.The teacher asked to write consecutively (without spaces) all words from the ""Storm and Calm"" in one long string s. She thought that a string is good if the number of vowels in the string is no more than twice more than the number of consonants. That is, the string with v vowels and c consonants is good if and only if v\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x892c.The task Innocentius had to solve turned out to be rather simple: he should find the number of the longest good substrings of the string s." 2000

137D Palindromes dp,strings "Friday is Polycarpus\' favourite day of the week. Not because it is followed by the weekend, but because the lessons on Friday are 2 IT lessons, 2 math lessons and 2 literature lessons. Of course, Polycarpus has prepared to all of them, unlike his buddy Innocentius. Innocentius spent all evening playing his favourite game Fur2 and didn\'t have enough time to do the literature task. As Innocentius didn\'t want to get an F, he decided to do the task and read the book called ""Storm and Calm"" during the IT and Math lessons (he never used to have problems with these subjects). When the IT teacher Mr. Watkins saw this, he decided to give Innocentius another task so that the boy concentrated more on the lesson and less \xe2\x80\x94 on the staff that has nothing to do with IT. Mr. Watkins said that a palindrome is a string that can be read the same way in either direction, from the left to the right and from the right to the left. A concatenation of strings a, b is a string ab that results from consecutive adding of string b to string a. Of course, Innocentius knew it all but the task was much harder than he could have imagined. Mr. Watkins asked change in the ""Storm and Calm"" the minimum number of characters so that the text of the book would also be a concatenation of no more than k palindromes. Innocentius can\'t complete the task and therefore asks you to help him." 1900

137C History sortings "Polycarpus likes studying at school a lot and he is always diligent about his homework. Polycarpus has never had any problems with natural sciences as his great-great-grandfather was the great physicist Seinstein. On the other hand though, Polycarpus has never had an easy time with history.Everybody knows that the World history encompasses exactly n events: the i-th event had continued from the year ai to the year bi inclusive (ai\xe2\x80\x89<\xe2\x80\x89bi). Polycarpus easily learned the dates when each of n events started and ended (Polycarpus inherited excellent memory from his great-great-granddad). But the teacher gave him a more complicated task: Polycaprus should know when all events began and ended and he should also find out for each event whether it includes another event. Polycarpus\' teacher thinks that an event j includes an event i if aj\xe2\x80\x89<\xe2\x80\x89ai and bi\xe2\x80\x89<\xe2\x80\x89bj. Your task is simpler: find the number of events that are included in some other event." 1500

137B Permutation greedy """Hey, it\'s homework time"" \xe2\x80\x94 thought Polycarpus and of course he started with his favourite subject, IT. Polycarpus managed to solve all tasks but for the last one in 20 minutes. However, as he failed to solve the last task after some considerable time, the boy asked you to help him.The sequence of n integers is called a permutation if it contains all integers from 1 to n exactly once.You are given an arbitrary sequence a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an containing n integers. Each integer is not less than 1 and not greater than 5000. Determine what minimum number of elements Polycarpus needs to change to get a permutation (he should not delete or add numbers). In a single change he can modify any single sequence element (i. e. replace it with another integer)." 1000

137A "Postcards and photos" implementation "Polycarpus has postcards and photos hung in a row on the wall. He decided to put them away to the closet and hang on the wall a famous painter\'s picture. Polycarpus does it like that: he goes from the left to the right and removes the objects consecutively. As Polycarpus doesn\'t want any mix-ups to happen, he will not carry in his hands objects of two different types. In other words, Polycarpus can\'t carry both postcards and photos simultaneously. Sometimes he goes to the closet and puts the objects there, thus leaving his hands free. Polycarpus must put all the postcards and photos to the closet. He cannot skip objects. What minimum number of times he should visit the closet if he cannot carry more than 5 items?" 900

136B "Ternary Logic" implementation,math "Little Petya very much likes computers. Recently he has received a new ""Ternatron IV"" as a gift from his mother. Unlike other modern computers, ""Ternatron IV"" operates with ternary and not binary logic. Petya immediately wondered how the xor operation is performed on this computer (and whether there is anything like it).It turned out that the operation does exist (however, it is called tor) and it works like this. Suppose that we need to calculate the value of the expression a tor b. Both numbers a and b are written in the ternary notation one under the other one (b under a). If they have a different number of digits, then leading zeroes are added to the shorter number until the lengths are the same. Then the numbers are summed together digit by digit. The result of summing each two digits is calculated modulo 3. Note that there is no carry between digits (i. e. during this operation the digits aren\'t transferred). For example: 1410 tor 5010\xe2\x80\x89=\xe2\x80\x8901123 tor 12123\xe2\x80\x89=\xe2\x80\x8910213\xe2\x80\x89=\xe2\x80\x893410.Petya wrote numbers a and c on a piece of paper. Help him find such number b, that a tor b\xe2\x80\x89=\xe2\x80\x89c. If there are several such numbers, print the smallest one." 1100

136A Presents implementation "Little Petya very much likes gifts. Recently he has received a new laptop as a New Year gift from his mother. He immediately decided to give it to somebody else as what can be more pleasant than giving somebody gifts. And on this occasion he organized a New Year party at his place and invited n his friends there.If there\'s one thing Petya likes more that receiving gifts, that\'s watching others giving gifts to somebody else. Thus, he safely hid the laptop until the next New Year and made up his mind to watch his friends exchanging gifts while he does not participate in the process. He numbered all his friends with integers from 1 to n. Petya remembered that a friend number i gave a gift to a friend number pi. He also remembered that each of his friends received exactly one gift.Now Petya wants to know for each friend i the number of a friend who has given him a gift." 800

135E "Weak Subsequence" combinatorics "Little Petya very much likes strings. Recently he has received a voucher to purchase a string as a gift from his mother. The string can be bought in the local shop. One can consider that the shop has all sorts of strings over the alphabet of fixed size. The size of the alphabet is equal to k. However, the voucher has a string type limitation: specifically, the voucher can be used to purchase string s if the length of string\'s longest substring that is also its weak subsequence (see the definition given below) equals w.String a with the length of n is considered the weak subsequence of the string s with the length of m, if there exists such a set of indexes 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i1\xe2\x80\x89<\xe2\x80\x89i2\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89in\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m, that has the following two properties:   ak\xe2\x80\x89=\xe2\x80\x89sik for all k from 1 to n;  there exists at least one such k (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k\xe2\x80\x89<\xe2\x80\x89n), for which ik\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89\xe2\x80\x93\xe2\x80\x89ik\xe2\x80\x89>\xe2\x80\x891. Petya got interested how many different strings are available for him to purchase in the shop. As the number of strings can be very large, please find it modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897). If there are infinitely many such strings, print ""-1""." 3000

135D Cycle "brute force,dfs and similar,implementation" "Little Petya very much likes rectangular tables that consist of characters ""0"" and ""1"". Recently he has received one such table as a gift from his mother. The table contained n rows and m columns. The rows are numbered from top to bottom from 1 to n, the columns are numbered from the left to the right from 1 to m. Petya immediately decided to find the longest cool cycle whatever it takes.A cycle is a sequence of pairwise distinct cells where each two consecutive cells have a common side; besides, the first cell has a common side with the last cell. A cycle is called cool if it fulfills all the following conditions simultaneously:   The cycle entirely consists of the cells that contain ""1"".  Each cell that belongs to the cycle, has a common side with exactly two other cells that belong to the cycle.  Each cell of the table that contains ""1"" either belongs to the cycle or is positioned outside of it (see definition below). To define the notion of ""outside"" formally, let\'s draw a cycle on a plane. Let each cell of the cycle (i,\xe2\x80\x89j) (i is the row number, j is the column number) correspond to the point (i,\xe2\x80\x89j) on the coordinate plane. Let a straight line segment join each pair of points that correspond to the cells belonging to the cycle and sharing a side. Thus, we will get a closed polyline that has no self-intersections and self-touches. The polyline divides the plane into two connected parts: the part of an infinite area and the part of a finite area. It is considered that cell (r,\xe2\x80\x89c) lies outside of the cycle if it does not belong to the cycle and the corresponding point on the plane with coordinates (r,\xe2\x80\x89c) lies in the part with the infinite area.Help Petya to find the length of the longest cool cycle in the table. The cycle length is defined as the number of cells that belong to the cycle." 2500

135C Zero-One "constructive algorithms,games,greedy" "Little Petya very much likes playing with little Masha. Recently he has received a game called ""Zero-One"" as a gift from his mother. Petya immediately offered Masha to play the game with him.Before the very beginning of the game several cards are lain out on a table in one line from the left to the right. Each card contains a digit: 0 or 1. Players move in turns and Masha moves first. During each move a player should remove a card from the table and shift all other cards so as to close the gap left by the removed card. For example, if before somebody\'s move the cards on the table formed a sequence 01010101, then after the fourth card is removed (the cards are numbered starting from 1), the sequence will look like that: 0100101. The game ends when exactly two cards are left on the table. The digits on these cards determine the number in binary notation: the most significant bit is located to the left. Masha\'s aim is to minimize the number and Petya\'s aim is to maximize it.An unpleasant accident occurred before the game started. The kids spilled juice on some of the cards and the digits on the cards got blurred. Each one of the spoiled cards could have either 0 or 1 written on it. Consider all possible variants of initial arrangement of the digits (before the juice spilling). For each variant, let\'s find which two cards are left by the end of the game, assuming that both Petya and Masha play optimally. An ordered pair of digits written on those two cards is called an outcome. Your task is to find the set of outcomes for all variants of initial digits arrangement." 1900

135B "Rectangle and Square" "brute force,geometry,math" "Little Petya very much likes rectangles and especially squares. Recently he has received 8 points on the plane as a gift from his mother. The points are pairwise distinct. Petya decided to split them into two sets each containing 4 points so that the points from the first set lay at the vertexes of some square and the points from the second set lay at the vertexes of a rectangle. Each point of initial 8 should belong to exactly one set. It is acceptable for a rectangle from the second set was also a square. If there are several partitions, Petya will be satisfied by any of them. Help him find such partition. Note that the rectangle and the square from the partition should have non-zero areas. The sides of the figures do not have to be parallel to the coordinate axes, though it might be the case." 1600

135A Replacement greedy,implementation,sortings "Little Petya very much likes arrays consisting of n integers, where each of them is in the range from 1 to 109, inclusive. Recently he has received one such array as a gift from his mother. Petya didn\'t like it at once. He decided to choose exactly one element from the array and replace it with another integer that also lies in the range from 1 to 109, inclusive. It is not allowed to replace a number with itself or to change no number at all. After the replacement Petya sorted the array by the numbers\' non-decreasing. Now he wants to know for each position: what minimum number could occupy it after the replacement and the sorting." 1300

134C Swaps "constructive algorithms,graphs,greedy" "There are n players sitting at a round table. All of them have s cards of n colors in total. Besides, initially the first person had cards of only the first color, the second one had cards of only the second color and so on. They can swap the cards by the following rules:   as the players swap, a player can give a card of his color only;  a player can\'t accept a card of a color he already has (particularly, he can\'t take cards of his color, no matter whether he has given out all of them or not);  during one swap a pair of people swaps cards (each person gives one card and takes one card). The aim of all n people is as follows: each of them should give out all the cards he had initially (that is, all cards of his color). Your task is to denote whether such sequence of swaps is possible. If the answer is positive, you should list all the swaps." 2200

134B "Pairs of Numbers" "brute force,dfs and similar,math,number theory" "Let\'s assume that we have a pair of numbers (a,\xe2\x80\x89b). We can get a new pair (a\xe2\x80\x89+\xe2\x80\x89b,\xe2\x80\x89b) or (a,\xe2\x80\x89a\xe2\x80\x89+\xe2\x80\x89b) from the given pair in a single step.Let the initial pair of numbers be (1,1). Your task is to find number k, that is, the least number of steps needed to transform (1,1) into the pair where at least one number equals n." 1900

134A "Average Numbers" "brute force,implementation" "You are given a sequence of positive integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. Find all such indices i, that the i-th element equals the arithmetic mean of all other elements (that is all elements except for this one)." 1200

133B Unary implementation "Unary is a minimalistic Brainfuck dialect in which programs are written using only one token. Brainfuck programs use 8 commands: ""+"", ""-"", ""["", ""]"", ""<"", "">"", ""."" and "","" (their meaning is not important for the purposes of this problem). Unary programs are created from Brainfuck programs using the following algorithm. First, replace each command with a corresponding binary code, using the following conversion table:   "">"" \xe2\x80\x89\xe2\x86\x92\xe2\x80\x89 1000,  ""<"" \xe2\x80\x89\xe2\x86\x92\xe2\x80\x89 1001,  ""+"" \xe2\x80\x89\xe2\x86\x92\xe2\x80\x89 1010,  ""-"" \xe2\x80\x89\xe2\x86\x92\xe2\x80\x89 1011,  ""."" \xe2\x80\x89\xe2\x86\x92\xe2\x80\x89 1100,  "","" \xe2\x80\x89\xe2\x86\x92\xe2\x80\x89 1101,  ""["" \xe2\x80\x89\xe2\x86\x92\xe2\x80\x89 1110,  ""]"" \xe2\x80\x89\xe2\x86\x92\xe2\x80\x89 1111. Next, concatenate the resulting binary codes into one binary number in the same order as in the program. Finally, write this number using unary numeral system \xe2\x80\x94 this is the Unary program equivalent to the original Brainfuck one.You are given a Brainfuck program. Your task is to calculate the size of the equivalent Unary program, and print it modulo 1000003 (106\xe2\x80\x89+\xe2\x80\x893)." 1200

133A HQ9+ implementation "HQ9+ is a joke programming language which has only four one-character instructions: ""H"" prints ""Hello, World!"", ""Q"" prints the source code of the program itself, ""9"" prints the lyrics of ""99 Bottles of Beer"" song,  ""+"" increments the value stored in the internal accumulator.Instructions ""H"" and ""Q"" are case-sensitive and must be uppercase. The characters of the program which are not instructions are ignored.You are given a program written in HQ9+. You have to figure out whether executing this program will produce any output." 900

132E "Bits of merry old England" flows,graphs "Another feature of Shakespeare language is that the variables are named after characters of plays by Shakespeare, and all operations on them (value assignment, output etc.) look like a dialog with other characters. New values of variables are defined in a rather lengthy way, so a programmer should try to minimize their usage.You have to print the given sequence of n integers. To do this, you have m variables and two types of operations on them:  variable=integer  print(variable) Any of the m variables can be used as variable. Variables are denoted by lowercase letters between ""a"" and ""z"", inclusive. Any integer number can be used as integer.Let\'s say that the penalty for using first type of operations equals to the number of set bits in the number integer. There is no penalty on using second type of operations. Find and output the program which minimizes the penalty for printing the given sequence of numbers." 2700

132D "Constants in the language of Shakespeare" "constructive algorithms,dp,greedy" "Shakespeare is a widely known esoteric programming language in which programs look like plays by Shakespeare, and numbers are given by combinations of ornate epithets. In this problem we will have a closer look at the way the numbers are described in Shakespeare.Each constant in Shakespeare is created from non-negative powers of 2 using arithmetic operations. For simplicity we\'ll allow only addition and subtraction and will look for a representation of the given number which requires a minimal number of operations.You are given an integer n. You have to represent it as n\xe2\x80\x89=\xe2\x80\x89a1\xe2\x80\x89+\xe2\x80\x89a2\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89am, where each of ai is a non-negative power of 2, possibly multiplied by -1. Find a representation which minimizes the value of m." 2100

132C "Logo Turtle" dp "A lot of people associate Logo programming language with turtle graphics. In this case the turtle moves along the straight line and accepts commands ""T"" (""turn around"") and ""F"" (""move 1 unit forward"").You are given a list of commands that will be given to the turtle. You have to change exactly n commands from the list (one command can be changed several times). How far from the starting point can the turtle move after it follows all the commands of the modified list?" 1800

132B Piet implementation "Piet is one of the most known visual esoteric programming languages. The programs in Piet are constructed from colorful blocks of pixels and interpreted using pretty complicated rules. In this problem we will use a subset of Piet language with simplified rules.The program will be a rectangular image consisting of colored and black pixels. The color of each pixel will be given by an integer number between 0 and 9, inclusive, with 0 denoting black. A block of pixels is defined as a rectangle of pixels of the same color (not black). It is guaranteed that all connected groups of colored pixels of the same color will form rectangular blocks. Groups of black pixels can form arbitrary shapes.The program is interpreted using movement of instruction pointer (IP) which consists of three parts: current block pointer (BP); note that there is no concept of current pixel within the block; direction pointer (DP) which can point left, right, up or down; block chooser (CP) which can point to the left or to the right from the direction given by DP; in absolute values CP can differ from DP by 90 degrees counterclockwise or clockwise, respectively.Initially BP points to the block which contains the top-left corner of the program, DP points to the right, and CP points to the left (see the orange square on the image below).One step of program interpretation changes the state of IP in a following way. The interpreter finds the furthest edge of the current color block in the direction of the DP. From all pixels that form this edge, the interpreter selects the furthest one in the direction of CP. After this, BP attempts to move from this pixel into the next one in the direction of DP. If the next pixel belongs to a colored block, this block becomes the current one, and two other parts of IP stay the same. It the next pixel is black or outside of the program, BP stays the same but two other parts of IP change. If CP was pointing to the left, now it points to the right, and DP stays the same. If CP was pointing to the right, now it points to the left, and DP is rotated 90 degrees clockwise.This way BP will never point to a black block (it is guaranteed that top-left pixel of the program will not be black).You are given a Piet program. You have to figure out which block of the program will be current after n steps." 2100

132A "Turing Tape" implementation "INTERCAL is the oldest of esoteric programming languages. One of its many weird features is the method of character-based output, known as Turing Tape method. It converts an array of unsigned 8-bit integers into a sequence of characters to print, using the following method.The integers of the array are processed one by one, starting from the first. Processing i-th element of the array is done in three steps:1. The 8-bit binary notation of the ASCII-code of the previous printed character is reversed. When the first element of the array is processed, the result of this step is considered to be 0.2. The i-th element of the array is subtracted from the result of the previous step modulo 256.3. The binary notation of the result of the previous step is reversed again to produce ASCII-code of the i-th character to be printed.You are given the text printed using this method. Restore the array used to produce this text." 1300

131F "Present to Mom" "binary search,two pointers" "How many stars are there in the sky? A young programmer Polycarpus can\'t get this question out of his head! He took a photo of the starry sky using his digital camera and now he analyzes the resulting monochrome digital picture. The picture is represented by a rectangular matrix consisting of n lines each containing m characters. A character equals \'1\', if the corresponding photo pixel is white and \'0\', if it is black.Polycarpus thinks that he has found a star on the photo if he finds a white pixel surrounded by four side-neighboring pixels that are also white:   1 111 1  a star on the photo Polycarpus whats to cut out a rectangular area from the photo and give his mom as a present. This area should contain no less than k stars. The stars can intersect, have shared white pixels on the photo. The boy will cut out the rectangular area so that its borders will be parallel to the sides of the photo and the cuts will go straight between the pixel borders.Now Polycarpus keeps wondering how many ways there are to cut an area out of the photo so that it met the conditions given above. Help Polycarpus find this number." 2000

131E "Yet Another Task with Queens" sortings "A queen is the strongest chess piece. In modern chess the queen can move any number of squares in any horizontal, vertical or diagonal direction (considering that there\'re no other pieces on its way). The queen combines the options given to the rook and the bishop.There are m queens on a square n\xe2\x80\x89\xc3\x97\xe2\x80\x89n chessboard. You know each queen\'s positions, the i-th queen is positioned in the square (ri,\xe2\x80\x89ci), where ri is the board row number (numbered from the top to the bottom from 1 to n), and ci is the board\'s column number (numbered from the left to the right from 1 to n). No two queens share the same position.For each queen one can count w \xe2\x80\x94 the number of other queens that the given queen threatens (attacks). For a fixed attack direction only the first queen in this direction is under attack if there are many queens are on the ray of the attack. Obviously, for any queen w is between 0 and 8, inclusive.Print the sequence t0,\xe2\x80\x89t1,\xe2\x80\x89...,\xe2\x80\x89t8, where ti is the number of queens that threaten exactly i other queens, i.e. the number of queens that their w equals i." 1700

131D Subway "dfs and similar,graphs" "A subway scheme, classic for all Berland cities is represented by a set of n stations connected by n passages, each of which connects exactly two stations and does not pass through any others. Besides, in the classic scheme one can get from any station to any other one along the passages. The passages can be used to move in both directions. Between each pair of stations there is no more than one passage.Berland mathematicians have recently proved a theorem that states that any classic scheme has a ringroad. There can be only one ringroad. In other words, in any classic scheme one can find the only scheme consisting of stations (where any two neighbouring ones are linked by a passage) and this cycle doesn\'t contain any station more than once.This invention had a powerful social impact as now the stations could be compared according to their distance from the ringroad. For example, a citizen could say ""I live in three passages from the ringroad"" and another one could reply ""you loser, I live in one passage from the ringroad"". The Internet soon got filled with applications that promised to count the distance from the station to the ringroad (send a text message to a short number...).The Berland government decided to put an end to these disturbances and start to control the situation. You are requested to write a program that can determine the remoteness from the ringroad for each station by the city subway scheme." 1600

131C "The World is a Theatre" combinatorics,math "There are n boys and m girls attending a theatre club. To set a play ""The Big Bang Theory"", they need to choose a group containing exactly t actors containing no less than 4 boys and no less than one girl. How many ways are there to choose a group? Of course, the variants that only differ in the composition of the troupe are considered different.Perform all calculations in the 64-bit type: long long for \xd0\xa1/\xd0\xa1++, int64 for Delphi and long for Java." 1400

131B "Opposites Attract" implementation,math "Everybody knows that opposites attract. That is the key principle of the ""Perfect Matching"" dating agency. The ""Perfect Matching"" matchmakers have classified each registered customer by his interests and assigned to the i-th client number ti (\xe2\x80\x89-\xe2\x80\x8910\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ti\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x8910). Of course, one number can be assigned to any number of customers.""Perfect Matching"" wants to advertise its services and publish the number of opposite couples, that is, the couples who have opposite values of t. Each couple consists of exactly two clients. The customer can be included in a couple an arbitrary number of times. Help the agency and write the program that will find the sought number by the given sequence t1,\xe2\x80\x89t2,\xe2\x80\x89...,\xe2\x80\x89tn. For example, if t\xe2\x80\x89=\xe2\x80\x89(1,\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x891,\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x891), then any two elements ti and tj form a couple if i and j have different parity. Consequently, in this case the sought number equals 4.Of course, a client can\'t form a couple with him/herself." 1200

131A "cAPS lOCK" implementation,strings "wHAT DO WE NEED cAPS LOCK FOR?Caps lock is a computer keyboard key. Pressing it sets an input mode in which typed letters are capital by default. If it is pressed by accident, it leads to accidents like the one we had in the first passage. Let\'s consider that a word has been typed with the Caps lock key accidentally switched on, if:   either it only contains uppercase letters;  or all letters except for the first one are uppercase. In this case we should automatically change the case of all letters. For example, the case of the letters that form words ""hELLO"", ""HTTP"", ""z"" should be changed.Write a program that applies the rule mentioned above. If the rule cannot be applied, the program should leave the word unchanged." 1000

130J "Date calculation" "*special problem" "In Gregorian calendar a typical year consists of 365 days and 12 months. The numbers of days in the months are: 31,\xe2\x80\x8928,\xe2\x80\x8931,\xe2\x80\x8930,\xe2\x80\x8931,\xe2\x80\x8930,\xe2\x80\x8931,\xe2\x80\x8931,\xe2\x80\x8930,\xe2\x80\x8931,\xe2\x80\x8930,\xe2\x80\x8931. If year index is divisible by 400, or divisible by 4 but not by 100, the year becomes leap year, with one extra day in the second month (the one which typically has 28 days).You are given the index of the year and the index of the day in the year. Find out the date of this day (day and month it will fall upon)." 1800

130I "Array sorting" "*special problem,sortings" "Sorting arrays is traditionally associated with high-level languages. How hard can it be in Befunge? Sort the given array in non-descending order." 2300

130H "Balanced brackets" "*special problem" "A sequence of brackets is called balanced if one can turn it into a valid math expression by adding characters \xc2\xab+\xc2\xbb and \xc2\xab1\xc2\xbb. For example, sequences \xc2\xab(())()\xc2\xbb, \xc2\xab()\xc2\xbb and \xc2\xab(()(()))\xc2\xbb are balanced, while \xc2\xab)(\xc2\xbb, \xc2\xab(()\xc2\xbb and \xc2\xab(()))(\xc2\xbb are not.You are given a string which consists of opening and closing round brackets. Check whether it is a balanced bracket sequence." 1600

130G "CAPS LOCK ON" "*special problem" "You are given a string which consists of letters and other characters. Convert it to uppercase, i.e., replace all lowercase letters with corresponding uppercase ones. Keep the rest of characters unchanged." 1700

130F "Prime factorization" "*special problem" "You are given an integer n. Output its prime factorization.If n\xe2\x80\x89=\xe2\x80\x89a1b1a2b2 ... akbk, where ak are prime numbers, the output of your program should look as follows: a1 a1 ... a1 a2 a2 ... a2 ... ak ak ... ak, where factors are ordered in non-decreasing order, and each factor ai is printed bi times." 1600

130E "Tribonacci numbers" "*special problem" "Tribonacci numbers are a sequence of numbers, defined as follows: t0\xe2\x80\x89=\xe2\x80\x89t1\xe2\x80\x89=\xe2\x80\x890, t2\xe2\x80\x89=\xe2\x80\x891, ti\xe2\x80\x89=\xe2\x80\x89ti\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x89ti\xe2\x80\x89-\xe2\x80\x892\xe2\x80\x89+\xe2\x80\x89ti\xe2\x80\x89-\xe2\x80\x893.You are given n; calculate n-th tribonacci number modulo 26." 1600

130D Exponentiation "*special problem" "You are given integers a, b and c. Calculate ab modulo c." 1500

130C "Decimal sum" "*special problem" "You are given an array of integer numbers. Calculate the sum of its elements." 1500

130B "Gnikool Ssalg" "*special problem,implementation,strings" "You are given a string. Reverse its characters." 1400

130A "Hexagonal numbers" "*special problem,implementation" "Hexagonal numbers are figurate numbers which can be calculated using the formula hn\xe2\x80\x89=\xe2\x80\x892n2\xe2\x80\x89-\xe2\x80\x89n. You are given n; calculate n-th hexagonal number." 900

129B "Students and Shoelaces" "brute force,dfs and similar,graphs,implementation" "Anna and Maria are in charge of the math club for junior students. When the club gathers together, the students behave badly. They\'ve brought lots of shoe laces to the club and got tied with each other. Specifically, each string ties together two students. Besides, if two students are tied, then the lace connects the first student with the second one as well as the second student with the first one.To restore order, Anna and Maria do the following. First, for each student Anna finds out what other students he is tied to. If a student is tied to exactly one other student, Anna reprimands him. Then Maria gathers in a single group all the students who have been just reprimanded. She kicks them out from the club. This group of students immediately leaves the club. These students takes with them the laces that used to tie them. Then again for every student Anna finds out how many other students he is tied to and so on. And they do so until Anna can reprimand at least one student.Determine how many groups of students will be kicked out of the club." 1200

129A Cookies implementation "Olga came to visit the twins Anna and Maria and saw that they have many cookies. The cookies are distributed into bags. As there are many cookies, Olga decided that it\'s no big deal if she steals a bag. However, she doesn\'t want the sisters to quarrel because of nothing when they divide the cookies. That\'s why Olga wants to steal a bag with cookies so that the number of cookies in the remaining bags was even, that is, so that Anna and Maria could evenly divide it into two (even 0 remaining cookies will do, just as any other even number). How many ways there are to steal exactly one cookie bag so that the total number of cookies in the remaining bags was even?" 900

128E Birthday geometry,math "Anna\'s got a birthday today. She invited many guests and cooked a huge (nearly infinite) birthday cake decorated by n banana circles of different sizes. Maria\'s birthday is about to start in 7 minutes too, and while Anna is older, she decided to play the boss a little. She told Maria to cut the cake by k straight-line cuts (the cutting lines can intersect) to divide banana circles into banana pieces. Anna has many guests and she wants everyone to get at least one banana piece. That\'s why she told Maria to make the total number of banana pieces maximum. It\'s not a problem if some banana pieces end up on the same cake piece \xe2\x80\x94 the key is to make the maximum number of banana pieces. Determine what result Maria will achieve." 2900

128D Numbers "constructive algorithms,implementation" "One day Anna got the following task at school: to arrange several numbers in a circle so that any two neighboring numbers differs exactly by 1. Anna was given several numbers and arranged them in a circle to fulfill the task. Then she wanted to check if she had arranged the numbers correctly, but at this point her younger sister Maria came and shuffled all numbers. Anna got sick with anger but what\'s done is done and the results of her work had been destroyed. But please tell Anna: could she have hypothetically completed the task using all those given numbers?" 2000

128C "Games with Rectangle" combinatorics,dp "In this task Anna and Maria play the following game. Initially they have a checkered piece of paper with a painted n\xe2\x80\x89\xc3\x97\xe2\x80\x89m rectangle (only the border, no filling). Anna and Maria move in turns and Anna starts. During each move one should paint inside the last-painted rectangle a new lesser rectangle (along the grid lines). The new rectangle should have no common points with the previous one. Note that when we paint a rectangle, we always paint only the border, the rectangles aren\'t filled.Nobody wins the game \xe2\x80\x94 Anna and Maria simply play until they have done k moves in total. Count the number of different ways to play this game." 2000

128B String "brute force,constructive algorithms,hashing,implementation,string suffix structures,strings" "One day in the IT lesson Anna and Maria learned about the lexicographic order.String x is lexicographically less than string y, if either x is a prefix of y (and x\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89y), or there exists such i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89min(|x|,\xe2\x80\x89|y|)), that xi\xe2\x80\x89<\xe2\x80\x89yi, and for any j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89<\xe2\x80\x89i) xj\xe2\x80\x89=\xe2\x80\x89yj. Here |a| denotes the length of the string a. The lexicographic comparison of strings is implemented by operator < in modern programming languages\xe2\x80\x8b\xe2\x80\x8b.The teacher gave Anna and Maria homework. She gave them a string of length n. They should write out all substrings of the given string, including the whole initial string, and the equal substrings (for example, one should write out the following substrings from the string ""aab"": ""a"", ""a"", ""aa"", ""ab"", ""aab"", ""b""). The resulting strings should be sorted in the lexicographical order. The cunning teacher doesn\'t want to check all these strings. That\'s why she said to find only the k-th string from the list. Help Anna and Maria do the homework." 2100

128A Statues "dfs and similar" "In this task Anna and Maria play a game with a very unpleasant rival. Anna and Maria are in the opposite squares of a chessboard (8\xe2\x80\x89\xc3\x97\xe2\x80\x898): Anna is in the upper right corner, and Maria is in the lower left one. Apart from them, the board has several statues. Each statue occupies exactly one square. A square that contains a statue cannot have anything or anyone \xe2\x80\x94 neither any other statues, nor Anna, nor Maria.Anna is present on the board as a figurant (she stands still and never moves), and Maria has been actively involved in the game. Her goal is \xe2\x80\x94 to come to Anna\'s square. Maria and statues move in turn, Maria moves first. During one move Maria can go to any adjacent on the side or diagonal cell in which there is no statue, or she can stay in the cell where she is. The statues during their move must go one square down simultaneously, and those statues that were in the bottom row fall from the board and are no longer appeared.At that moment, when one of the statues is in the cell in which the Maria is, the statues are declared winners. At the moment when Maria comes into the cell where Anna has been waiting, Maria is declared the winner.Obviously, nothing depends on the statues, so it all depends on Maria. Determine who will win, if Maria does not make a strategic error." 1500

127B "Canvas Frames" implementation "Nicholas, a painter is going to paint several new canvases. Nicholas is sure that the canvases will turn out so great that each one will need framing and being hung on the wall. Frames are what Nicholas decided to begin with. Nicholas has n sticks whose lengths equal a1,\xe2\x80\x89a2,\xe2\x80\x89... an. Nicholas does not want to break the sticks or glue them together. To make a h\xe2\x80\x89\xc3\x97\xe2\x80\x89w-sized frame, he needs two sticks whose lengths equal h and two sticks whose lengths equal w. Specifically, to make a square frame (when h\xe2\x80\x89=\xe2\x80\x89w), he needs four sticks of the same length.Now Nicholas wants to make from the sticks that he has as many frames as possible; to be able to paint as many canvases as possible to fill the frames. Help him in this uneasy task. Note that it is not necessary to use all the sticks Nicholas has." 1000

127A "Wasted Time" geometry "Mr. Scrooge, a very busy man, decided to count the time he wastes on all sorts of useless stuff to evaluate the lost profit. He has already counted the time he wastes sleeping and eating. And now Mr. Scrooge wants to count the time he has wasted signing papers.Mr. Scrooge\'s signature can be represented as a polyline A1A2... An. Scrooge signs like that: first it places a pen at the point A1, then draws a segment from point A1 to point A2, then he draws a segment from point A2 to point A3 and so on to point An, where he stops signing and takes the pen off the paper. At that the resulting line can intersect with itself and partially repeat itself but Scrooge pays no attention to it and never changes his signing style. As Scrooge makes the signature, he never takes the pen off the paper and his writing speed is constant \xe2\x80\x94 50 millimeters per second.Scrooge signed exactly k papers throughout his life and all those signatures look the same.Find the total time Scrooge wasted signing the papers." 900

126E Pills "brute force,flows" "Doctor prescribed medicine to his patient. The medicine is represented by pills. Each pill consists of a shell and healing powder. The shell consists of two halves; each half has one of four colors \xe2\x80\x94 blue, red, white or yellow.The doctor wants to put 28 pills in a rectangular box 7\xe2\x80\x89\xc3\x97\xe2\x80\x898 in size. Besides, each pill occupies exactly two neighboring cells and any cell contains exactly one half of a pill. Thus, the result is a four colored picture 7\xe2\x80\x89\xc3\x97\xe2\x80\x898 in size.The doctor thinks that a patient will recover sooner if the picture made by the pills will be special. Unfortunately, putting the pills in the box so as to get the required picture is not a very easy task. That\'s why doctor asks you to help. Doctor has some amount of pills of each of 10 painting types. They all contain the same medicine, that\'s why it doesn\'t matter which 28 of them will be stored inside the box.Place the pills in the box so that the required picture was formed. If it is impossible to place the pills in the required manner, then place them so that the number of matching colors in all 56 cells in the final arrangement and the doctor\'s picture were maximum." 2900

126D "Fibonacci Sums" dp,math "Fibonacci numbers have the following form:F1\xe2\x80\x89=\xe2\x80\x891,\xe2\x80\x89 F2\xe2\x80\x89=\xe2\x80\x892,\xe2\x80\x89 Fi\xe2\x80\x89=\xe2\x80\x89Fi\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x89Fi\xe2\x80\x89-\xe2\x80\x892,\xe2\x80\x89i\xe2\x80\x89>\xe2\x80\x892.Let\'s consider some non-empty set S\xe2\x80\x89=\xe2\x80\x89{s1,\xe2\x80\x89s2,\xe2\x80\x89...,\xe2\x80\x89sk}, consisting of different Fibonacci numbers. Let\'s find the sum of values of this set\'s elements:Let\'s call the set S a number n\'s decomposition into Fibonacci sum. It\'s easy to see that several numbers have several decompositions into Fibonacci sum. For example, for 13 we have 13,\xe2\x80\x895\xe2\x80\x89+\xe2\x80\x898,\xe2\x80\x892\xe2\x80\x89+\xe2\x80\x893\xe2\x80\x89+\xe2\x80\x898 \xe2\x80\x94 three decompositions, and for 16: 3\xe2\x80\x89+\xe2\x80\x8913,\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x892\xe2\x80\x89+\xe2\x80\x8913,\xe2\x80\x893\xe2\x80\x89+\xe2\x80\x895\xe2\x80\x89+\xe2\x80\x898,\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x892\xe2\x80\x89+\xe2\x80\x895\xe2\x80\x89+\xe2\x80\x898 \xe2\x80\x94 four decompositions.By the given number n determine the number of its possible different decompositions into Fibonacci sum." 2300

126C "E-reader Display" "constructive algorithms,greedy" "After years of hard work scientists invented an absolutely new e-reader display. The new display has a larger resolution, consumes less energy and its production is cheaper. And besides, one can bend it. The only inconvenience is highly unusual management. For that very reason the developers decided to leave the e-readers\' software to programmers.The display is represented by n\xe2\x80\x89\xc3\x97\xe2\x80\x89n square of pixels, each of which can be either black or white. The display rows are numbered with integers from 1 to n upside down, the columns are numbered with integers from 1 to n from the left to the right. The display can perform commands like ""x,\xe2\x80\x89y"". When a traditional display fulfills such command, it simply inverts a color of (x,\xe2\x80\x89y), where x is the row number and y is the column number. But in our new display every pixel that belongs to at least one of the segments (x,\xe2\x80\x89x)\xe2\x80\x89-\xe2\x80\x89(x,\xe2\x80\x89y) and (y,\xe2\x80\x89y)\xe2\x80\x89-\xe2\x80\x89(x,\xe2\x80\x89y) (both ends of both segments are included) inverts a color.For example, if initially a display 5\xe2\x80\x89\xc3\x97\xe2\x80\x895 in size is absolutely white, then the sequence of commands (1,\xe2\x80\x894), (3,\xe2\x80\x895), (5,\xe2\x80\x891), (3,\xe2\x80\x893) leads to the following changes:  You are an e-reader software programmer and you should calculate minimal number of commands needed to display the picture. You can regard all display pixels as initially white." 2000

126B Password "binary search,dp,hashing,string suffix structures,strings" "Asterix, Obelix and their temporary buddies Suffix and Prefix has finally found the Harmony temple. However, its doors were firmly locked and even Obelix had no luck opening them.A little later they found a string s, carved on a rock below the temple\'s gates. Asterix supposed that that\'s the password that opens the temple and read the string aloud. However, nothing happened. Then Asterix supposed that a password is some substring t of the string s.Prefix supposed that the substring t is the beginning of the string s; Suffix supposed that the substring t should be the end of the string s; and Obelix supposed that t should be located somewhere inside the string s, that is, t is neither its beginning, nor its end.Asterix chose the substring t so as to please all his companions. Besides, from all acceptable variants Asterix chose the longest one (as Asterix loves long strings). When Asterix read the substring t aloud, the temple doors opened. You know the string s. Find the substring t or determine that such substring does not exist and all that\'s been written above is just a nice legend." 1700

126A "Hot Bath" "binary search,brute force,math" "Bob is about to take a hot bath. There are two taps to fill the bath: a hot water tap and a cold water tap. The cold water\'s temperature is t1, and the hot water\'s temperature is t2. The cold water tap can transmit any integer number of water units per second from 0 to x1, inclusive. Similarly, the hot water tap can transmit from 0 to x2 water units per second.If y1 water units per second flow through the first tap and y2 water units per second flow through the second tap, then the resulting bath water temperature will be:Bob wants to open both taps so that the bath water temperature was not less than t0. However, the temperature should be as close as possible to this value. If there are several optimal variants, Bob chooses the one that lets fill the bath in the quickest way possible.Determine how much each tap should be opened so that Bob was pleased with the result in the end." 1900

125E "MST Company" "binary search,graphs" "The MST (Meaningless State Team) company won another tender for an important state reform in Berland.There are n cities in Berland, some pairs of the cities are connected by roads. Each road has its price. One can move along any road in any direction. The MST team should carry out the repair works on some set of roads such that one can get from any city to any other one moving only along the repaired roads. Moreover, this set should contain exactly k capital roads (that is, the roads that start or finish in the capital). The number of the capital is 1.As the budget has already been approved, the MST Company will profit by finding the set with minimum lengths of roads." 2400

125D "Two progressions" "constructive algorithms,greedy" "An arithmetic progression is such a non-empty sequence of numbers where the difference between any two successive numbers is constant. This constant number is called common difference. For example, the sequence 3, 7, 11, 15 is an arithmetic progression. The definition implies that any sequences whose length equals 1 or 2 are arithmetic and all sequences whose length equals 0 are non-arithmetic.You are given a sequence of different integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. You should either split it into two arithmetic progressions or find out that the operation is impossible to perform. Splitting assigns each member of the given sequence to one of two progressions, but the relative order of numbers does not change. Splitting is an inverse operation to merging." 2200

125C "Hobbits\' Party" "constructive algorithms,greedy" "An arithmetic progression is such a non-empty sequence of numbers where the difference between any two successive numbers is constant. This constant number is called common difference. For example, the sequence 3, 7, 11, 15 is an arithmetic progression. The definition implies that any sequences whose length equals 1 or 2 are arithmetic and all sequences whose length equals 0 are non-arithmetic.You are given a sequence of different integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. You should either split it into two arithmetic progressions or find out that the operation is impossible to perform. Splitting assigns each member of the given sequence to one of two progressions, but the relative order of numbers does not change. Splitting is an inverse operation to merging." 1600

125B "Simple XML" implementation "Let\'s define a string <x> as an opening tag, where x is any small letter of the Latin alphabet. Each opening tag matches a closing tag of the type </x>, where x is the same letter.Tegs can be nested into each other: in this case one opening and closing tag pair is located inside another pair.Let\'s define the notion of a XML-text:   an empty string is a XML-text  if s is a XML-text, then s\'=<a>+s+</a> also is a XML-text, where a is any small Latin letter  if s1, s2 are XML-texts, then s1+s2 also is a XML-text You are given a XML-text (it is guaranteed that the text is valid), your task is to print in the following form:   each tag (opening and closing) is located on a single line  print before the tag 2\xe2\x80\x89*\xe2\x80\x89h spaces, where h is the level of the tag\'s nestedness." 1000

125A "Measuring Lengths in Baden" math "Lengths are measures in Baden in inches and feet. To a length from centimeters it is enough to know that an inch equals three centimeters in Baden and one foot contains 12 inches.You are given a length equal to n centimeters. Your task is to convert it to feet and inches so that the number of feet was maximum. The result should be an integer rounded to the closest value containing an integral number of inches.Note that when you round up, 1 cm rounds up to 0 inches and 2 cm round up to 1 inch." 1400

124B Permutations "brute force,combinatorics,implementation" "You are given n k-digit integers. You have to rearrange the digits in the integers so that the difference between the largest and the smallest number was minimum. Digits should be rearranged by the same rule in all integers." 1400

124A "The number of positions" math "Petr stands in line of n people, but he doesn\'t know exactly which position he occupies. He can say that there are no less than a people standing in front of him and no more than b people standing behind him. Find the number of different positions Petr can occupy." 1000

123E Maze "dfs and similar,dp,probabilities,trees" "A maze is represented by a tree (an undirected graph, where exactly one way exists between each pair of vertices). In the maze the entrance vertex and the exit vertex are chosen with some probability. The exit from the maze is sought by Deep First Search. If there are several possible ways to move, the move is chosen equiprobably. Consider the following pseudo-code:DFS(x)    if x == exit vertex then        finish search    flag[x] <- TRUE    random shuffle the vertices\' order in V(x) // here all permutations have equal probability to be chosen    for i <- 1 to length[V] do        if flag[V[i]] = FALSE then            count++;            DFS(y);    count++;V(x) is the list vertices adjacent to x. The flag array is initially filled as FALSE. DFS initially starts with a parameter of an entrance vertex. When the search is finished, variable count will contain the number of moves.Your task is to count the mathematical expectation of the number of moves one has to do to exit the maze." 2500

123D String "string suffix structures" "One day in the IT lesson Anna and Maria learned about the lexicographic order.String x is lexicographically less than string y, if either x is a prefix of y (and x\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89y), or there exists such i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89min(|x|,\xe2\x80\x89|y|)), that xi\xe2\x80\x89<\xe2\x80\x89yi, and for any j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89<\xe2\x80\x89i) xj\xe2\x80\x89=\xe2\x80\x89yj. Here |a| denotes the length of the string a. The lexicographic comparison of strings is implemented by operator < in modern programming languages\xe2\x80\x8b\xe2\x80\x8b.The teacher gave Anna and Maria homework. She gave them a string of length n. They should write out all substrings of the given string, including the whole initial string, and the equal substrings (for example, one should write out the following substrings from the string ""aab"": ""a"", ""a"", ""aa"", ""ab"", ""aab"", ""b""). The resulting strings should be sorted in the lexicographical order. The cunning teacher doesn\'t want to check all these strings. That\'s why she said to find only the k-th string from the list. Help Anna and Maria do the homework." 2300

123C Brackets combinatorics,dp,greedy "A two dimensional array is called a bracket array if each grid contains one of the two possible brackets \xe2\x80\x94 ""("" or "")"". A path through the two dimensional array cells is called monotonous if any two consecutive cells in the path are side-adjacent and each cell of the path is located below or to the right from the previous one. A two dimensional array whose size equals n\xe2\x80\x89\xc3\x97\xe2\x80\x89m is called a correct bracket array, if any string formed by writing out the brackets on some monotonous way from cell (1,\xe2\x80\x891) to cell (n,\xe2\x80\x89m) forms a correct bracket sequence. Let\'s define the operation of comparing two correct bracket arrays of equal size (a and b) like that. Let\'s consider a given two dimensional array of priorities (c) \xe2\x80\x94 a two dimensional array of same size, containing different integers from 1 to nm. Let\'s find such position (i,\xe2\x80\x89j) in the two dimensional array, that ai,\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89bi,\xe2\x80\x89j. If there are several such positions, let\'s choose the one where number ci,\xe2\x80\x89j is minimum. If ai,\xe2\x80\x89j\xe2\x80\x89=\xe2\x80\x89""("", then a\xe2\x80\x89<\xe2\x80\x89b, otherwise a\xe2\x80\x89>\xe2\x80\x89b. If the position (i,\xe2\x80\x89j) is not found, then the arrays are considered equal.Your task is to find a k-th two dimensional correct bracket array. It is guaranteed that for the given sizes of n and m there will be no less than k two dimensional correct bracket arrays." 2300

123B Squares math "You are given an infinite checkered field. You should get from a square (x1; y1) to a square (x2; y2). Using the shortest path is not necessary. You can move on the field squares in four directions. That is, when you are positioned in any square, you can move to any other side-neighboring one. A square (x; y) is considered bad, if at least one of the two conditions is fulfilled: |x\xe2\x80\x89+\xe2\x80\x89y|\xe2\x80\x89\xe2\x89\xa1\xe2\x80\x890 (mod�2a), |x\xe2\x80\x89-\xe2\x80\x89y|\xe2\x80\x89\xe2\x89\xa1\xe2\x80\x890 (mod�2b). Your task is to find the minimum number of bad cells one will have to visit on the way from (x1; y1) to (x2; y2)." 1800

123A "Prime Permutation" "implementation,number theory,strings" "You are given a string s, consisting of small Latin letters. Let\'s denote the length of the string as |s|. The characters in the string are numbered starting from 1. Your task is to find out if it is possible to rearrange characters in string s so that for any prime number p\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|s| and for any integer i ranging from 1 to |s|\xe2\x80\x89/\xe2\x80\x89p (inclusive) the following condition was fulfilled sp\xe2\x80\x89=\xe2\x80\x89sp\xe2\x80\x89\xc3\x97\xe2\x80\x89i. If the answer is positive, find one way to rearrange the characters." 1300

122B "Lucky Substring" "brute force,implementation" "Petya loves lucky numbers. Everybody knows that lucky numbers are positive integers whose decimal representation contains only the lucky digits 4 and 7. For example, numbers 47, 744, 4 are lucky and 5, 17, 467 are not.One day Petya was delivered a string s, containing only digits. He needs to find a string that represents a lucky number without leading zeroes, is not empty, is contained in s as a substring the maximum number of times.Among all the strings for which the three conditions given above are fulfilled, Petya only needs the lexicographically minimum one. Find this string for Petya." 1000

122A "Lucky Division" "brute force,number theory" "Petya loves lucky numbers. Everybody knows that lucky numbers are positive integers whose decimal representation contains only the lucky digits 4 and 7. For example, numbers 47, 744, 4 are lucky and 5, 17, 467 are not.Petya calls a number almost lucky if it could be evenly divided by some lucky number. Help him find out if the given number n is almost lucky." 1000

121E "Lucky Array" "data structures" "Petya loves lucky numbers. Everybody knows that lucky numbers are positive integers whose decimal representation contains only the lucky digits 4 and 7. For example, numbers 47, 744, 4 are lucky and 5, 17, 467 are not.Petya has an array consisting of n numbers. He wants to perform m operations of two types:   add l r d \xe2\x80\x94 add an integer d to all elements whose indexes belong to the interval from l to r, inclusive (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n,\xe2\x80\x891\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89d\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89104);  count l r \xe2\x80\x94 find and print on the screen how many lucky numbers there are among elements with indexes that belong to the interval from l to r inclusive (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n). Each lucky number should be counted as many times as it appears in the interval. Petya has a list of all operations. The operations are such that after all additions the array won\'t have numbers that would exceed 104. Help Petya write a program that would perform these operations." 2400

121D "Lucky Segments" "binary search,implementation,two pointers" "Petya loves lucky numbers. Everybody knows that lucky numbers are positive integers whose decimal representation contains only the lucky digits 4 and 7. For example, numbers 47, 744, 4 are lucky and 5, 17, 467 are not.Petya has n number segments [l1;�r1], [l2;�r2], ..., [ln;�rn]. During one move Petya can take any segment (let it be segment number i) and replace it with segment [li\xe2\x80\x89+\xe2\x80\x891;�ri\xe2\x80\x89+\xe2\x80\x891] or [li\xe2\x80\x89-\xe2\x80\x891;�ri\xe2\x80\x89-\xe2\x80\x891]. In other words, during one move Petya can shift any segment to the left or to the right by a unit distance. Petya calls a number full if it belongs to each segment. That is, number x is full if for any i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) the condition li\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ri is fulfilled.Petya makes no more than k moves. After that he counts the quantity of full lucky numbers. Find the maximal quantity that he can get." 2500

121C "Lucky Permutation" "brute force,combinatorics,number theory" "Petya loves lucky numbers. Everybody knows that lucky numbers are positive integers whose decimal representation contains only the lucky digits 4 and 7. For example, numbers 47, 744, 4 are lucky and 5, 17, 467 are not.One day Petya dreamt of a lexicographically k-th permutation of integers from 1 to n. Determine how many lucky numbers in the permutation are located on the positions whose indexes are also lucky numbers." 1900

121B "Lucky Transformation" strings "Petya loves lucky numbers. Everybody knows that lucky numbers are positive integers whose decimal representation contains only the lucky digits 4 and 7. For example, numbers 47, 744, 4 are lucky and 5, 17, 467 are not.Petya has a number consisting of n digits without leading zeroes. He represented it as an array of digits without leading zeroes. Let\'s call it d. The numeration starts with 1, starting from the most significant digit. Petya wants to perform the following operation k times: find the minimum x (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89<\xe2\x80\x89n) such that dx\xe2\x80\x89=\xe2\x80\x894 and dx\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89=\xe2\x80\x897, if x is odd, then to assign dx\xe2\x80\x89=\xe2\x80\x89dx\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89=\xe2\x80\x894, otherwise to assign dx\xe2\x80\x89=\xe2\x80\x89dx\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89=\xe2\x80\x897. Note that if no x was found, then the operation counts as completed and the array doesn\'t change at all.You are given the initial number as an array of digits and the number k. Help Petya find the result of completing k operations." 1500

121A "Lucky Sum" implementation "Petya loves lucky numbers. Everybody knows that lucky numbers are positive integers whose decimal representation contains only the lucky digits 4 and 7. For example, numbers 47, 744, 4 are lucky and 5, 17, 467 are not.Let next(x) be the minimum lucky number which is larger than or equals x. Petya is interested what is the value of the expression next(l)\xe2\x80\x89+\xe2\x80\x89next(l\xe2\x80\x89+\xe2\x80\x891)\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89next(r\xe2\x80\x89-\xe2\x80\x891)\xe2\x80\x89+\xe2\x80\x89next(r). Help him solve this problem." 1100

120J "Minimum Sum" "divide and conquer,geometry,sortings" "You are given a set of n vectors on a plane. For each vector you are allowed to multiply any of its coordinates by -1. Thus, each vector vi\xe2\x80\x89=\xe2\x80\x89(xi,\xe2\x80\x89yi) can be transformed into one of the following four vectors:  vi1\xe2\x80\x89=\xe2\x80\x89(xi,\xe2\x80\x89yi),  vi2\xe2\x80\x89=\xe2\x80\x89(\xe2\x80\x89-\xe2\x80\x89xi,\xe2\x80\x89yi),  vi3\xe2\x80\x89=\xe2\x80\x89(xi,\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x89yi),  vi4\xe2\x80\x89=\xe2\x80\x89(\xe2\x80\x89-\xe2\x80\x89xi,\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x89yi).  You should find two vectors from the set and determine which of their coordinates should be multiplied by -1 so that the absolute value of the sum of the resulting vectors was minimally possible. More formally, you should choose two vectors vi, vj (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i,\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n,\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89j) and two numbers k1, k2 (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k1,\xe2\x80\x89k2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x894), so that the value of the expression |vik1\xe2\x80\x89+\xe2\x80\x89vjk2| were minimum." 1900

120I "Luck is in Numbers" greedy "Vasya has been collecting transport tickets for quite a while now. His collection contains several thousands of tram, trolleybus and bus tickets. Vasya is already fed up with the traditional definition of what a lucky ticket is. Thus, he\'s looking for new perspectives on that. Besides, Vasya cannot understand why all tickets are only divided into lucky and unlucky ones. He thinks that all tickets are lucky but in different degrees. Having given the matter some thought, Vasya worked out the definition of a ticket\'s degree of luckiness. Let a ticket consist of 2n digits. Let\'s regard each digit as written as is shown on the picture:  You have seen such digits on electronic clocks: seven segments are used to show digits. Each segment can either be colored or not. The colored segments form a digit. Vasya regards the digits as written in this very way and takes the right half of the ticket and puts it one the left one, so that the first digit coincides with the n\xe2\x80\x89+\xe2\x80\x891-th one, the second digit coincides with the n\xe2\x80\x89+\xe2\x80\x892-th one, ..., the n-th digit coincides with the 2n-th one. For each pair of digits, put one on another, he counts the number of segments colored in both digits and summarizes the resulting numbers. The resulting value is called the degree of luckiness of a ticket. For example, the degree of luckiness of ticket 03 equals four and the degree of luckiness of ticket 2345 equals six.You are given the number of a ticket containing 2n digits. Your task is to find among the tickets whose number exceeds the number of this ticket but also consists of 2n digits such ticket, whose degree of luckiness exceeds the degrees of luckiness of the given ticket. Moreover, if there are several such tickets, you should only choose the one with the smallest number." 2200

120H "Brevity is Soul of Wit" "graph matchings" "As we communicate, we learn much new information. However, the process of communication takes too much time. It becomes clear if we look at the words we use in our everyday speech.We can list many simple words consisting of many letters: ""information"", ""technologies"", ""university"", ""construction"", ""conservatoire"", ""refrigerator"", ""stopwatch"", ""windowsill"", ""electricity"", ""government"" and so on. Of course, we can continue listing those words ad infinitum. Fortunately, the solution for that problem has been found. To make our speech clear and brief, we should replace the initial words with those that resemble them but are much shorter. This idea hasn\'t been brought into life yet, that\'s why you are chosen to improve the situation. Let\'s consider the following formal model of transforming words: we shall assume that one can use n words in a chat. For each words we shall introduce a notion of its shorter variant. We shall define shorter variant of an arbitrary word s as such word t, that meets the following conditions:  it occurs in s as a subsequence,  its length ranges from one to four characters. In other words, the word t consists at least of one and at most of four characters that occur in the same order in the word s. Note that those characters do not necessarily follow in s immediately one after another. You are allowed not to shorten the initial word if its length does not exceed four characters.You are given a list of n different words. Your task is to find a set of their shortened variants. The shortened variants of all words from the list should be different." 1800

120G Boom implementation "Let\'s consider the famous game called Boom (aka Hat) with simplified rules.There are n teams playing the game. Each team has two players. The purpose of the game is to explain the words to the teammate without using any words that contain the same root or that sound similarly. Player j from team i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n,\xe2\x80\x891\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x892) is characterized by two numbers: aij and bij. The numbers correspondingly represent the skill of explaining and the skill of understanding this particular player has. Besides, m cards are used for the game. Each card has a word written on it. The card number k (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m) is characterized by number ck \xe2\x80\x94 the complexity of the word it contains.Before the game starts the cards are put in a deck and shuffled. Then the teams play in turns like that: the 1-st player of the 1-st team, the 1-st player of the 2-nd team, ... , the 1-st player of the n-th team, the 2-nd player of the 1-st team, ... , the 2-nd player of the n-th team, the 1-st player of the 1-st team and so on.Each turn continues for t seconds. It goes like that: Initially the time for each turn is t. While the time left to a player is more than 0, a player takes a card from the top of the deck and starts explaining the word it has to his teammate. The time needed for the j-th player of the i-th team to explain the word from the card k to his teammate (the q-th player of the i-th team) equals max(1,\xe2\x80\x89ck\xe2\x80\x89-\xe2\x80\x89(aij\xe2\x80\x89+\xe2\x80\x89biq)\xe2\x80\x89-\xe2\x80\x89dik) (if j\xe2\x80\x89=\xe2\x80\x891,\xe2\x80\x89 then q\xe2\x80\x89=\xe2\x80\x892,\xe2\x80\x89 else q\xe2\x80\x89=\xe2\x80\x891). The value dik is the number of seconds the i-th team has already spent explaining the word k during the previous turns. Initially, all dik equal 0. If a team manages to guess the word before the end of the turn, then the time given above is substracted from the duration of the turn, the card containing the guessed word leaves the game, the team wins one point and the game continues. If the team doesn\'t manage to guess the word, then the card is put at the bottom of the deck, dik increases on the amount of time of the turn, spent on explaining the word. Thus, when this team gets the very same word, they start explaining it not from the beginning, but from the point where they stopped. The game ends when words from all m cards are guessed correctly.You are given n teams and a deck of m cards. You should determine for each team, how many points it will have by the end of the game and which words the team will have guessed." 1800

120F Spiders dp,greedy,trees "One day mum asked Petya to sort his toys and get rid of some of them. Petya found a whole box of toy spiders. They were quite dear to him and the boy didn\'t want to throw them away. Petya conjured a cunning plan: he will glue all the spiders together and attach them to the ceiling. Besides, Petya knows that the lower the spiders will hang, the more mum is going to like it and then she won\'t throw his favourite toys away. Help Petya carry out the plan.A spider consists of k beads tied together by k\xe2\x80\x89-\xe2\x80\x891 threads. Each thread connects two different beads, at that any pair of beads that make up a spider is either directly connected by a thread, or is connected via some chain of threads and beads.Petya may glue spiders together directly gluing their beads. The length of each thread equals 1. The sizes of the beads can be neglected. That\'s why we can consider that gluing spiders happens by identifying some of the beads (see the picture). Besides, the construction resulting from the gluing process should also represent a spider, that is, it should have the given features. After Petya glues all spiders together, he measures the length of the resulting toy. The distance between a pair of beads is identified as the total length of the threads that connect these two beads. The length of the resulting construction is the largest distance between all pairs of beads. Petya wants to make the spider whose length is as much as possible.    The picture two shows two spiders from the second sample. We can glue to the bead number 2 of the first spider the bead number 1 of the second spider. The threads in the spiders that form the sequence of threads of maximum lengths are highlighted on the picture." 1400

120E "Put Knight!" games,math "Petya and Gena play a very interesting game ""Put a Knight!"" on a chessboard n\xe2\x80\x89\xc3\x97\xe2\x80\x89n in size. In this game they take turns to put chess pieces called ""knights"" on the board so that no two knights could threat each other. A knight located in square (r,\xe2\x80\x89c) can threat squares (r\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89c\xe2\x80\x89+\xe2\x80\x892), (r\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89c\xe2\x80\x89-\xe2\x80\x892), (r\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89c\xe2\x80\x89+\xe2\x80\x892), (r\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89c\xe2\x80\x89-\xe2\x80\x892), (r\xe2\x80\x89-\xe2\x80\x892,\xe2\x80\x89c\xe2\x80\x89+\xe2\x80\x891), (r\xe2\x80\x89-\xe2\x80\x892,\xe2\x80\x89c\xe2\x80\x89-\xe2\x80\x891), (r\xe2\x80\x89+\xe2\x80\x892,\xe2\x80\x89c\xe2\x80\x89+\xe2\x80\x891) and (r\xe2\x80\x89+\xe2\x80\x892,\xe2\x80\x89c\xe2\x80\x89-\xe2\x80\x891) (some of the squares may be located outside the chessboard). The player who can\'t put a new knight during his move loses. Determine which player wins considering that both players play optimally well and Petya starts." 1400

120D "Three Sons" "brute force" "Three sons inherited from their father a rectangular corn fiend divided into n\xe2\x80\x89\xc3\x97\xe2\x80\x89m squares. For each square we know how many tons of corn grows on it. The father, an old farmer did not love all three sons equally, which is why he bequeathed to divide his field into three parts containing A, B and C tons of corn.The field should be divided by two parallel lines. The lines should be parallel to one side of the field and to each other. The lines should go strictly between the squares of the field. Each resulting part of the field should consist of at least one square. Your task is to find the number of ways to divide the field as is described above, that is, to mark two lines, dividing the field in three parts so that on one of the resulting parts grew A tons of corn, B on another one and C on the remaining one." 1400

120C "Winnie-the-Pooh and honey" implementation,math "As we all know, Winnie-the-Pooh just adores honey. Ones he and the Piglet found out that the Rabbit has recently gotten hold of an impressive amount of this sweet and healthy snack. As you may guess, Winnie and the Piglet asked to come at the Rabbit\'s place. Thus, there are n jars of honey lined up in front of Winnie-the-Pooh, jar number i contains ai kilos of honey. Winnie-the-Pooh eats the honey like that: each time he chooses a jar containing most honey. If the jar has less that k kilos of honey or if Winnie-the-Pooh has already eaten from it three times, he gives the jar to Piglet. Otherwise he eats exactly k kilos of honey from the jar and puts it back. Winnie does so until he gives all jars to the Piglet. Count how much honey Piglet will overall get after Winnie satisfies his hunger." 1100

120B "Quiz League" implementation "A team quiz game called ""What? Where? When?"" is very popular in Berland. The game is centered on two teams competing. They are the team of six Experts versus the team of the Audience. A person from the audience asks a question and the experts are allowed a minute on brainstorming and finding the right answer to the question. All it takes to answer a typical question is general knowledge and common logic. The question sent be the audience are in envelops lain out in a circle on a round table. Each envelop is marked by the name of the asker\'s town. Each question is positioned in a separate sector. In the centre of the table is a spinning arrow. Thus, the table rather resembles a roulette table with no ball but with a spinning arrow instead. The host sets off the spinning arrow to choose a question for the experts: when the arrow stops spinning, the question it is pointing at is chosen. If the arrow points at the question that has already been asked, the host chooses the next unanswered question in the clockwise direction. Your task is to determine which will be the number of the next asked question if the arrow points at sector number k." 1100

120A Elevator "brute force,implementation,math" "A sky scraper with 1000 floors has been built in the city of N. It has modern superfast elevators to help to travel from one floor to another. Each elevator has two doors, the front one and the back one. If one goes in through the front door, he goes out through the back one and vice versa. The elevator has two rails numbered with numbers 1 and 2. Rail 1 is located to the left of the entrance to the front door (or correspondingly, to the right of the entrance to the back door). Rail 2 is located opposite it, to the right of the entrance to the front door and to the left of the entrance to the back door. We know that each person in the city of N holds at a rail with the strongest hand. One day a VIP person visited the city and of course, he took a look at the skyscraper and took a ride in the elevator. We know the door through which he entered and the rail he was holding at. Now we need to determine as soon as possible whether he is left-handed or right-handed." 1000

119E "Alternative Reality" geometry "In the year of 3000 travelling around parallel realities became a routine thing. However one has to take into consideration that travelling like that is highly dangerous as you never know beforehand where you\'re gonna get...Little Vasya, for instance, found himself in a gaming reality and now he has to successfully complete all levels of a very weird game to get back. The gaming reality is a three-dimensional space where n points are given. The game has m levels and at the beginning of the i-th level the player is positioned at some plane Qi that passes through the origin. On each level Vasya has to use special robots to construct and activate n powerful energy spheres of the equal radius with centers at the given points. The player chooses the radius of the spheres himself. The player has to spend R units of money to construct spheres whose radius equals R (consequently, one can construct spheres whose radius equals zero for free). Besides, once for each level a player can choose any point in space and release a laser ray from there, perpendicular to plane Qi (this action costs nothing). The ray can either be directed towards the plane or from the plane. The spheres that share at least one point with the ray will be immediately activated. The level is considered completed if the player has managed to activate all spheres. Note that the centers of the spheres are the same for all m levels but the spheres do not remain: the player should construct them anew on each new level.Help Vasya find out what minimum sum of money will be enough to complete each level." 2400

119D "String Transformation" hashing,strings "Let s be a string whose length equals n. Its characters are numbered from 0 to n\xe2\x80\x89-\xe2\x80\x891, i and j are integers, 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89j\xe2\x80\x89<\xe2\x80\x89n. Let\'s define function f as follows:f(s,\xe2\x80\x89i,\xe2\x80\x89j)\xe2\x80\x89=\xe2\x80\x89s[i\xe2\x80\x89+\xe2\x80\x891... j\xe2\x80\x89-\xe2\x80\x891]\xe2\x80\x89+\xe2\x80\x89r(s[j... n\xe2\x80\x89-\xe2\x80\x891])\xe2\x80\x89+\xe2\x80\x89r(s[0... i]).Here s[p... q] is a substring of string s, that starts in position p and ends in position q (inclusive); ""+"" is the string concatenation operator; r(x) is a string resulting from writing the characters of the x string in the reverse order. If j\xe2\x80\x89=\xe2\x80\x89i\xe2\x80\x89+\xe2\x80\x891, then the substring s[i\xe2\x80\x89+\xe2\x80\x891... j\xe2\x80\x89-\xe2\x80\x891] is considered empty.You are given two strings a and b. Find such values of i and j, that f(a,\xe2\x80\x89i,\xe2\x80\x89j)\xe2\x80\x89=\xe2\x80\x89b. Number i should be maximally possible. If for this i there exists several valid values of j, choose the minimal j." 2500

119C "Education Reform" dp "Yet another education system reform has been carried out in Berland recently. The innovations are as follows:An academic year now consists of n days. Each day pupils study exactly one of m subjects, besides, each subject is studied for no more than one day. After the lessons of the i-th subject pupils get the home task that contains no less than ai and no more than bi exercises. Besides, each subject has a special attribute, the complexity (ci). A school can make its own timetable, considering the following conditions are satisfied:  the timetable should contain the subjects in the order of the complexity\'s strict increasing;  each day, except for the first one, the task should contain either k times more exercises, or more by k compared to the previous day (more formally: let\'s call the number of home task exercises in the i-th day as xi, then for each i (1\xe2\x80\x89<\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n): either xi\xe2\x80\x89=\xe2\x80\x89k\xe2\x80\x89+\xe2\x80\x89xi\xe2\x80\x89-\xe2\x80\x891 or xi\xe2\x80\x89=\xe2\x80\x89k\xc2\xb7xi\xe2\x80\x89-\xe2\x80\x891 must be true);  the total number of exercises in all home tasks should be maximal possible. All limitations are separately set for each school.It turned out that in many cases ai and bi reach 1016 (however, as the Berland Minister of Education is famous for his love to half-measures, the value of bi\xe2\x80\x89-\xe2\x80\x89ai doesn\'t exceed 100). That also happened in the Berland School \xe2\x84\x96256. Nevertheless, you as the school\'s principal still have to work out the timetable for the next academic year..." 2000

119B "Before Exam" "constructive algorithms,implementation,sortings" "Vasya is about to take his first university exam in about several minutes. And it\'s not just some ordinary exam, it\'s on mathematical analysis. Of course, right now Vasya can only think of one thing: what the result of his talk with the examiner will be...To prepare for the exam, one has to study proofs of n theorems. It is known that there will be k examination cards on the exam and each card contains  distinct theorems. Besides, no theorem is mentioned in more than one card (that is,  theorems won\'t be mentioned in any card). During the exam several students may get the same card.We do not know the exact way theorems are distributed by cards, however the students that took the exam before Vasya told him what theorems their cards contained. Vasya evaluates his level of proficiency in the i-th theorem by some number ai. The level of proficiency in some card is the average of the levels of proficiency in the theorems that are included in the card. Now Vasya wants to know the minimally and maximally possible levels of his proficiency in the card he gets on the exam. Vasya wants to determine it by the data he has collected from other students. Unfortunately, Vasya has no time left to do the math and he asked you to help him." 1900

119A "Epic Game" implementation "Simon and Antisimon play a game. Initially each player receives one fixed positive integer that doesn\'t change throughout the game. Simon receives number a and Antisimon receives number b. They also have a heap of n stones. The players take turns to make a move and Simon starts. During a move a player should take from the heap the number of stones equal to the greatest common divisor of the fixed number he has received and the number of stones left in the heap. A player loses when he cannot take the required number of stones (i. e. the heap has strictly less stones left than one needs to take). Your task is to determine by the given a, b and n who wins the game." 800

118E "Bertown roads" "dfs and similar,graphs" "Bertown has n junctions and m bidirectional roads. We know that one can get from any junction to any other one by the existing roads. As there were more and more cars in the city, traffic jams started to pose real problems. To deal with them the government decided to make the traffic one-directional on all the roads, thus easing down the traffic. Your task is to determine whether there is a way to make the traffic one-directional so that there still is the possibility to get from any junction to any other one. If the answer is positive, you should also find one of the possible ways to orient the roads." 2000

118D "Caesar\'s Legions" dp "Bertown has n junctions and m bidirectional roads. We know that one can get from any junction to any other one by the existing roads. As there were more and more cars in the city, traffic jams started to pose real problems. To deal with them the government decided to make the traffic one-directional on all the roads, thus easing down the traffic. Your task is to determine whether there is a way to make the traffic one-directional so that there still is the possibility to get from any junction to any other one. If the answer is positive, you should also find one of the possible ways to orient the roads." 1700

118C "Fancy Number" "brute force,greedy,sortings,strings" "A car number in Berland consists of exactly n digits. A number is called beautiful if it has at least k equal digits. Vasya wants to change the digits in his car\'s number so that the number became beautiful. To replace one of n digits Vasya has to pay the sum of money, equal to the absolute difference between the old digit and the new one.Help Vasya: find the minimum sum of money he should pay to make the number of his car beautiful. You should also find the resulting beautiful number. If there are several such numbers, then print the lexicographically minimum one." 1900

118B "Present from Lena" "constructive algorithms,implementation" "Vasya\'s birthday is approaching and Lena decided to sew a patterned handkerchief to him as a present. Lena chose digits from 0 to n as the pattern. The digits will form a rhombus. The largest digit n should be located in the centre. The digits should decrease as they approach the edges. For example, for n\xe2\x80\x89=\xe2\x80\x895 the handkerchief pattern should look like that: ����������0��������0�1�0������0�1�2�1�0����0�1�2�3�2�1�0��0�1�2�3�4�3�2�1�00�1�2�3�4�5�4�3�2�1�0��0�1�2�3�4�3�2�1�0����0�1�2�3�2�1�0������0�1�2�1�0��������0�1�0����������0Your task is to determine the way the handkerchief will look like by the given n." 1000

118A "String Task" implementation,strings "Petya started to attend programming lessons. On the first lesson his task was to write a simple program. The program was supposed to do the following: in the given string, consisting if uppercase and lowercase Latin letters, it:   deletes all the vowels,  inserts a character ""."" before each consonant,  replaces all uppercase consonants with corresponding lowercase ones. Vowels are letters ""A"", ""O"", ""Y"", ""E"", ""U"", ""I"", and the rest are consonants. The program\'s input is exactly one string, it should return the output as a single string, resulting after the program\'s processing the initial string.Help Petya cope with this easy task." 1000

117E "Tree or not Tree" "data structures,divide and conquer,implementation,trees" "You are given an undirected connected graph G consisting of n vertexes and n edges. G contains no self-loops or multiple edges. Let each edge has two states: on and off. Initially all edges are switched off.You are also given m queries represented as (v,\xe2\x80\x89u) \xe2\x80\x94 change the state of all edges on the shortest path from vertex v to vertex u in graph G. If there are several such paths, the lexicographically minimal one is chosen. More formally, let us consider all shortest paths from vertex v to vertex u as the sequences of vertexes v,\xe2\x80\x89v1,\xe2\x80\x89v2,\xe2\x80\x89...,\xe2\x80\x89u. Among such sequences we choose the lexicographically minimal one.After each query you should tell how many connected components has the graph whose vertexes coincide with the vertexes of graph G and edges coincide with the switched on edges of graph G." 2900

117D "Not Quick Transformation" "divide and conquer,math" "Let a be an array consisting of n numbers. The array\'s elements are numbered from 1 to n, even is an array consisting of the numerals whose numbers are even in a (eveni\xe2\x80\x89=\xe2\x80\x89a2i, 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x892i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n), odd is an array consisting of the numberals whose numbers are odd in \xd0\xb0 (oddi\xe2\x80\x89=\xe2\x80\x89a2i\xe2\x80\x89-\xe2\x80\x891, 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x892i\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n). Then let\'s define the transformation of array F(a) in the following manner:  if n\xe2\x80\x89>\xe2\x80\x891, F(a)\xe2\x80\x89=\xe2\x80\x89F(odd)\xe2\x80\x89+\xe2\x80\x89F(even), where operation ""\xe2\x80\x89+\xe2\x80\x89"" stands for the arrays\' concatenation (joining together)  if n\xe2\x80\x89=\xe2\x80\x891, F(a)\xe2\x80\x89=\xe2\x80\x89a Let a be an array consisting of n numbers 1,\xe2\x80\x892,\xe2\x80\x893,\xe2\x80\x89...,\xe2\x80\x89n. Then b is the result of applying the transformation to the array a (so b\xe2\x80\x89=\xe2\x80\x89F(a)). You are given m queries (l,\xe2\x80\x89r,\xe2\x80\x89u,\xe2\x80\x89v). Your task is to find for each query the sum of numbers bi, such that l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r and u\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89bi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89v. You should print the query results modulo mod." 2500

117C Cycle "dfs and similar,graphs" "A tournament is a directed graph without self-loops in which every pair of vertexes is connected by exactly one directed edge. That is, for any two vertexes u and v (u\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89v) exists either an edge going from u to v, or an edge from v to u.You are given a tournament consisting of n vertexes. Your task is to find there a cycle of length three." 2000

117B "Very Interesting Game" "brute force,number theory" "In a very ancient country the following game was popular. Two people play the game. Initially first player writes a string s1, consisting of exactly nine digits and representing a number that does not exceed a. After that second player looks at s1 and writes a string s2, consisting of exactly nine digits and representing a number that does not exceed b. Here a and b are some given constants, s1 and s2 are chosen by the players. The strings are allowed to contain leading zeroes.If a number obtained by the concatenation (joining together) of strings s1 and s2 is divisible by mod, then the second player wins. Otherwise the first player wins. You are given numbers a, b, mod. Your task is to determine who wins if both players play in the optimal manner. If the first player wins, you are also required to find the lexicographically minimum winning move." 1800

117A Elevator implementation,math "A sky scraper with 1000 floors has been built in the city of N. It has modern superfast elevators to help to travel from one floor to another. Each elevator has two doors, the front one and the back one. If one goes in through the front door, he goes out through the back one and vice versa. The elevator has two rails numbered with numbers 1 and 2. Rail 1 is located to the left of the entrance to the front door (or correspondingly, to the right of the entrance to the back door). Rail 2 is located opposite it, to the right of the entrance to the front door and to the left of the entrance to the back door. We know that each person in the city of N holds at a rail with the strongest hand. One day a VIP person visited the city and of course, he took a look at the skyscraper and took a ride in the elevator. We know the door through which he entered and the rail he was holding at. Now we need to determine as soon as possible whether he is left-handed or right-handed." 1300

116B "Little Pigs and Wolves" greedy,implementation "Once upon a time there were several little pigs and several wolves on a two-dimensional grid of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m. Each cell in this grid was either empty, containing one little pig, or containing one wolf.A little pig and a wolf are adjacent if the cells that they are located at share a side. The little pigs are afraid of wolves, so there will be at most one wolf adjacent to each little pig. But each wolf may be adjacent to any number of little pigs.They have been living peacefully for several years. But today the wolves got hungry. One by one, each wolf will choose one of the little pigs adjacent to it (if any), and eats the poor little pig. This process is not repeated. That is, each wolf will get to eat at most one little pig. Once a little pig gets eaten, it disappears and cannot be eaten by any other wolf.What is the maximum number of little pigs that may be eaten by the wolves?" 1100

116A Tram implementation "Linear Kingdom has exactly one tram line. It has n stops, numbered from 1 to n in the order of tram\'s movement. At the i-th stop ai passengers exit the tram, while bi passengers enter it. The tram is empty before it arrives at the first stop. Also, when the tram arrives at the last stop, all passengers exit so that it becomes empty.Your task is to calculate the tram\'s minimum capacity such that the number of people inside the tram at any time never exceeds this capacity. Note that at each stop all exiting passengers exit before any entering passenger enters the tram." 800

115E "Linear Kingdom Races" "data structures,dp" "You are a car race organizer and would like to arrange some races in Linear Kingdom.Linear Kingdom has n consecutive roads spanning from left to right. The roads are numbered from 1 to n from left to right, thus the roads follow in the order of their numbers\' increasing. There will be several races that may be held on these roads. Each race will use a consecutive subset of these roads. Also, each race will pay some amount of money to you if this race is held. No races overlap in time, so some roads can be used in several races.Unfortunately, some of the roads are in a bad condition and they need repair. Each road has repair costs associated with it, you are required to pay this cost to repair the road. A race can only take place if all the roads used in the race are renovated. Your task is to repair such roads (possibly all or none) that will maximize your profit. Your profit is defined as the total money you get from the races that are held minus the total money you spent to repair the roads. Note that you may decide not to repair any road and gain zero profit.Print the maximum profit you can gain." 2400

115D "Unambiguous Arithmetic Expression" "dp,expression parsing" "Let\'s define an unambiguous arithmetic expression (UAE) as follows.   All non-negative integers are UAE\'s. Integers may have leading zeroes (for example, 0000 and 0010 are considered valid integers).  If X and Y are two UAE\'s, then ""(X)\xe2\x80\x89+\xe2\x80\x89(Y)"", ""(X)\xe2\x80\x89-\xe2\x80\x89(Y)"", ""(X)\xe2\x80\x89*\xe2\x80\x89(Y)"", and ""(X)\xe2\x80\x89/\xe2\x80\x89(Y)"" (all without the double quotes) are UAE\'s.  If X is an UAE, then ""\xe2\x80\x89-\xe2\x80\x89(X)"" and ""\xe2\x80\x89+\xe2\x80\x89(X)"" (both without the double quotes) are UAE\'s.You are given a string consisting only of digits (""0"" - ""9"") and characters ""-"", ""+"", ""*"", and ""/"". Your task is to compute the number of different possible unambiguous arithmetic expressions such that if all brackets (characters ""("" and "")"") of that unambiguous arithmetic expression are removed, it becomes the input string. Since the answer may be very large, print it modulo 1000003 (106\xe2\x80\x89+\xe2\x80\x893)." 2600

115C Plumber math "Little John aspires to become a plumber! Today he has drawn a grid consisting of n rows and m columns, consisting of n\xe2\x80\x89\xc3\x97\xe2\x80\x89m square cells.In each cell he will draw a pipe segment. He can only draw four types of segments numbered from 1 to 4, illustrated as follows:  Each pipe segment has two ends, illustrated by the arrows in the picture above. For example, segment 1 has ends at top and left side of it.Little John considers the piping system to be leaking if there is at least one pipe segment inside the grid whose end is not connected to another pipe\'s end or to the border of the grid. The image below shows an example of leaking and non-leaking systems of size 1\xe2\x80\x89\xc3\x97\xe2\x80\x892.  Now, you will be given the grid that has been partially filled by Little John. Each cell will either contain one of the four segments above, or be empty. Find the number of possible different non-leaking final systems after Little John finishes filling all of the empty cells with pipe segments. Print this number modulo 1000003 (106\xe2\x80\x89+\xe2\x80\x893).Note that rotations or flipping of the grid are not allowed and so two configurations that are identical only when one of them has been rotated or flipped either horizontally or vertically are considered two different configurations." 2200

115B Lawnmower greedy,sortings "You have a garden consisting entirely of grass and weeds. Your garden is described by an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m grid, with rows numbered 1 to n from top to bottom, and columns 1 to m from left to right. Each cell is identified by a pair (r,\xe2\x80\x89c) which means that the cell is located at row r and column c. Each cell may contain either grass or weeds. For example, a 4\xe2\x80\x89\xc3\x97\xe2\x80\x895 garden may look as follows (empty cells denote grass):  You have a land-mower with you to mow all the weeds. Initially, you are standing with your lawnmower at the top-left corner of the garden. That is, at cell (1,\xe2\x80\x891). At any moment of time you are facing a certain direction \xe2\x80\x94 either left or right. And initially, you face right.In one move you can do either one of these:1) Move one cell in the direction that you are facing.  if you are facing right: move from cell (r,\xe2\x80\x89c) to cell (r,\xe2\x80\x89c\xe2\x80\x89+\xe2\x80\x891)     if you are facing left: move from cell (r,\xe2\x80\x89c) to cell (r,\xe2\x80\x89c\xe2\x80\x89-\xe2\x80\x891)    2) Move one cell down (that is, from cell (r,\xe2\x80\x89c) to cell (r\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89c)), and change your direction to the opposite one.  if you were facing right previously, you will face left     if you were facing left previously, you will face right    You are not allowed to leave the garden. Weeds will be mowed if you and your lawnmower are standing at the cell containing the weeds (your direction doesn\'t matter). This action isn\'t counted as a move.What is the minimum number of moves required to mow all the weeds?" 1500

115A Party "dfs and similar,graphs,trees" "A company has n employees numbered from 1 to n. Each employee either has no immediate manager or exactly one immediate manager, who is another employee with a different number. An employee A is said to be the superior of another employee B if at least one of the following is true:  Employee A is the immediate manager of employee B  Employee B has an immediate manager employee C such that employee A is the superior of employee C. The company will not have a managerial cycle. That is, there will not exist an employee who is the superior of his/her own immediate manager.Today the company is going to arrange a party. This involves dividing all n employees into several groups: every employee must belong to exactly one group. Furthermore, within any single group, there must not be two employees A and B such that A is the superior of B.What is the minimum number of groups that must be formed?" 900

114B "PFAST Inc." "bitmasks,brute force,graphs" "When little Petya grew up and entered the university, he started to take part in \xd0\x90\xd0\xa1\xd0\x9c contests. Later he realized that he doesn\'t like how the \xd0\x90\xd0\xa1\xd0\x9c contests are organised: the team could only have three members (and he couldn\'t take all his friends to the competitions and distribute the tasks between the team members efficiently), so he decided to organize his own contests PFAST Inc. \xe2\x80\x94 Petr and Friends Are Solving Tasks Corporation. PFAST Inc. rules allow a team to have unlimited number of members.To make this format of contests popular he organised his own tournament. To create the team he will prepare for the contest organised by the PFAST Inc. rules, he chose several volunteers (up to 16 people) and decided to compile a team from them. Petya understands perfectly that if a team has two people that don\'t get on well, then the team will perform poorly. Put together a team with as many players as possible given that all players should get on well with each other." 1500

114A Cifera math "When Petya went to school, he got interested in large numbers and what they were called in ancient times. For instance, he learned that the Russian word ""tma"" (which now means ""too much to be counted"") used to stand for a thousand and ""tma tmyschaya"" (which literally means ""the tma of tmas"") used to stand for a million.Petya wanted to modernize the words we use for numbers and invented a word petricium that represents number k. Moreover, petricium la petricium stands for number k2, petricium la petricium la petricium stands for k3 and so on. All numbers of this form are called petriciumus cifera, and the number\'s importance is the number of articles la in its title.Petya\'s invention brought on a challenge that needed to be solved quickly: does some number l belong to the set petriciumus cifera? As Petya is a very busy schoolboy he needs to automate the process, he asked you to solve it." 1000

113E Sleeping combinatorics,implementation,math "One day Vasya was lying in bed watching his electronic clock to fall asleep quicker.Vasya lives in a strange country, where days have h hours, and every hour has m minutes. Clock shows time in decimal number system, in format H:M, where the string H always has a fixed length equal to the number of digits in the decimal representation of number h\xe2\x80\x89-\xe2\x80\x891. To achieve this, leading zeros are added if necessary. The string M has a similar format, and its length is always equal to the number of digits in the decimal representation of number m\xe2\x80\x89-\xe2\x80\x891. For example, if h\xe2\x80\x89=\xe2\x80\x8917, m\xe2\x80\x89=\xe2\x80\x891000, then time equal to 13 hours and 75 minutes will be displayed as ""13:075"".Vasya had been watching the clock from h1 hours m1 minutes to h2 hours m2 minutes inclusive, and then he fell asleep. Now he asks you to count how many times he saw the moment at which at least k digits changed on the clock simultaneously.For example, when switching 04:19 \xe2\x80\x89\xe2\x86\x92\xe2\x80\x89 04:20 two digits change. When switching 23:59 \xe2\x80\x89\xe2\x86\x92\xe2\x80\x89 00:00, four digits change.Consider that Vasya has been watching the clock for strictly less than one day. Note that the last time Vasya saw on the clock before falling asleep was ""h2:m2"". That is, Vasya didn\'t see the moment at which time ""h2:m2"" switched to the next value." 2700

113D Museum math,matrices,probabilities "One day as Petya and his friend Vasya were having one of their numerous trips, they decided to visit a museum castle. The museum has a specific shape: it consists of n rooms connected with m corridors so that one can access any room from any other one.After the two friends had a little walk around the museum, they decided to split and watch the pieces of art each of them found interesting. They agreed to meet in one of the rooms at six p.m. However, they forgot one quite essential thing: they didn\'t specify the place to meet and when the time came, they started to rush about the museum looking for each other (they couldn\'t call each other as roaming made a call\'s cost skyrocket).Yet, even despite the whole rush, they couldn\'t get enough of the pieces of art, that\'s why each of them has the following strategy: each minute he make a decision where to go \xe2\x80\x94 with probability pi he doesn\'t move to any other place during this minute (i.e. he stays in the room). With probability 1\xe2\x80\x89-\xe2\x80\x89pi he equiprobably choose one of the adjacent rooms and went there along the corridor. Here i is the ordinal number of the current room. Building was expensive in ancient times, that\'s why each corridor connected two different rooms, and any two rooms had no more than one corridor between them. The boys act simultaneously. As the corridors are dark, it is impossible to meet there; however, one can walk along the corridors in both directions (besides, the two boys can be going through the same corridor simultaneously without meeting). The boys act like that until they meet each other. More formally, the two friends meet when at some moment of time both of them decided to appear in the same room.For each room find the probability that the boys will meet there considering that at 6 p.m. they are positioned in rooms a and b correspondingly." 2700

113C "Double Happiness" "brute force,math,number theory" "On the math lesson a teacher asked each pupil to come up with his own lucky numbers. As a fan of number theory Peter chose prime numbers. Bob was more original. He said that number t is his lucky number, if it can be represented as: t\xe2\x80\x89=\xe2\x80\x89a2\xe2\x80\x89+\xe2\x80\x89b2,\xe2\x80\x89 where a,\xe2\x80\x89b are arbitrary positive integers.Now, the boys decided to find out how many days of the interval [l,\xe2\x80\x89r] (l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r) are suitable for pair programming. They decided that the day i (l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r) is suitable for pair programming if and only if the number i is lucky for Peter and lucky for Bob at the same time. Help the boys to find the number of such days." 2200

113B Petr# "brute force,data structures,hashing,strings" "Long ago, when Petya was a schoolboy, he was very much interested in the Petr# language grammar. During one lesson Petya got interested in the following question: how many different continuous substrings starting with the sbegin and ending with the send (it is possible sbegin\xe2\x80\x89=\xe2\x80\x89send), the given string t has. Substrings are different if and only if their contents aren\'t equal, their positions of occurence don\'t matter. Petya wasn\'t quite good at math, that\'s why he couldn\'t count this number. Help him!" 2000

113A "Grammar Lessons" implementation,strings "Petya got interested in grammar on his third year in school. He invented his own language called Petya\'s. Petya wanted to create a maximally simple language that would be enough to chat with friends, that\'s why all the language\'s grammar can be described with the following set of rules: There are three parts of speech: the adjective, the noun, the verb. Each word in his language is an adjective, noun or verb.  There are two genders: masculine and feminine. Each word in his language has gender either masculine or feminine.  Masculine adjectives end with -lios, and feminine adjectives end with -liala.  Masculine nouns end with -etr, and feminime nouns end with -etra.  Masculine verbs end with -initis, and feminime verbs end with -inites.  Thus, each word in the Petya\'s language has one of the six endings, given above. There are no other endings in Petya\'s language.  It is accepted that the whole word consists of an ending. That is, words ""lios"", ""liala"", ""etr"" and so on belong to the Petya\'s language.  There aren\'t any punctuation marks, grammatical tenses, singular/plural forms or other language complications.  A sentence is either exactly one valid language word or exactly one statement. Statement is any sequence of the Petya\'s language, that satisfy both conditions: Words in statement follow in the following order (from the left to the right): zero or more adjectives followed by exactly one noun followed by zero or more verbs.  All words in the statement should have the same gender.After Petya\'s friend Vasya wrote instant messenger (an instant messaging program) that supported the Petya\'s language, Petya wanted to add spelling and grammar checking to the program. As Vasya was in the country and Petya didn\'t feel like waiting, he asked you to help him with this problem. Your task is to define by a given sequence of words, whether it is true that the given text represents exactly one sentence in Petya\'s language." 1600

112B "Petya and Square" implementation,math "Little Petya loves playing with squares. Mum bought him a square 2n\xe2\x80\x89\xc3\x97\xe2\x80\x892n in size. Petya marked a cell inside the square and now he is solving the following task.The task is to draw a broken line that would go along the grid lines and that would cut the square into two equal parts. The cutting line should not have any common points with the marked cell and the resulting two parts should be equal up to rotation.Petya wants to determine whether it is possible to cut the square in the required manner given the sizes of the square side and the coordinates of the marked cell. Help him." 1200

112A "Petya and Strings" implementation,strings "Little Petya loves presents. His mum bought him two strings of the same size for his birthday. The strings consist of uppercase and lowercase Latin letters. Now Petya wants to compare those two strings lexicographically. The letters\' case does not matter, that is an uppercase letter is considered equivalent to the corresponding lowercase letter. Help Petya perform the comparison." 800

111E "Petya and Rectangle" NA "Little Petya loves playing with rectangles. Mom bought Petya a rectangle divided into cells n\xe2\x80\x89\xc3\x97\xe2\x80\x89m in size (containing n rows, m columns). Petya marked two different cells of the rectangle and now he is solving the following task:Let\'s define a simple path between those two cells as a sequence of distinct cells a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89ak, where a1 and ak are the two marked cells. Besides, ai and ai\xe2\x80\x89+\xe2\x80\x891 are side-neighboring cells of the path (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89k). Let\'s denote the path length as number k (the sequence length). Petya\'s task is to find the longest simple path\'s length and to print the path. Help him." 2900

111D "Petya and Coloring" combinatorics,dp "Little Petya loves counting. He wants to count the number of ways to paint a rectangular checkered board of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m (n rows, m columns) in k colors. Besides, the coloring should have the following property: for any vertical line that passes along the grid lines and divides the board in two non-empty parts the number of distinct colors in both these parts should be the same. Help Petya to count these colorings." 2300

111C "Petya and Spiders" bitmasks,dp,dsu "Little Petya loves training spiders. Petya has a board n\xe2\x80\x89\xc3\x97\xe2\x80\x89m in size. Each cell of the board initially has a spider sitting on it. After one second Petya chooses a certain action for each spider, and all of them humbly perform its commands. There are 5 possible commands: to stay idle or to move from current cell to some of the four side-neighboring cells (that is, one command for each of the four possible directions). Petya gives the commands so that no spider leaves the field. It is allowed for spiders to pass through each other when they crawl towards each other in opposite directions. All spiders crawl simultaneously and several spiders may end up in one cell. Petya wants to know the maximum possible number of spider-free cells after one second." 2100

111B "Petya and Divisors" "binary search,data structures,number theory" "Little Petya loves looking for numbers\' divisors. One day Petya came across the following problem:You are given n queries in the form ""xi yi"". For each query Petya should count how many divisors of number xi divide none of the numbers xi\xe2\x80\x89-\xe2\x80\x89yi,\xe2\x80\x89xi\xe2\x80\x89-\xe2\x80\x89yi\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89xi\xe2\x80\x89-\xe2\x80\x891. Help him." 1900

111A "Petya and Inequiations" greedy "Little Petya loves inequations. Help him find n positive integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an, such that the following two conditions are satisfied: a12\xe2\x80\x89+\xe2\x80\x89a22\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89an2\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89x a1\xe2\x80\x89+\xe2\x80\x89a2\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89an\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y" 1400

110B "Lucky String" "constructive algorithms,strings" "Petya loves lucky numbers. We all know that lucky numbers are the positive integers whose decimal representations contain only the lucky digits 4 and 7. For example, numbers 47, 744, 4 are lucky and 5, 17, 467 are not.Petya recently learned to determine whether a string of lowercase Latin letters is lucky. For each individual letter all its positions in the string are written out in the increasing order. This results in 26 lists of numbers; some of them can be empty. A string is considered lucky if and only if in each list the absolute difference of any two adjacent numbers is a lucky number. For example, let\'s consider string ""zbcdzefdzc"". The lists of positions of equal letters are: b: 2 c: 3,\xe2\x80\x8910 d: 4,\xe2\x80\x898 e: 6 f: 7 z: 1,\xe2\x80\x895,\xe2\x80\x899 Lists of positions of letters a, g, h, ..., y are empty.This string is lucky as all differences are lucky numbers. For letters z: 5\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89=\xe2\x80\x894, 9\xe2\x80\x89-\xe2\x80\x895\xe2\x80\x89=\xe2\x80\x894, for letters c: 10\xe2\x80\x89-\xe2\x80\x893\xe2\x80\x89=\xe2\x80\x897, for letters d: 8\xe2\x80\x89-\xe2\x80\x894\xe2\x80\x89=\xe2\x80\x894. Note that if some letter occurs only once in a string, it doesn\'t influence the string\'s luckiness after building the lists of positions of equal letters. The string where all the letters are distinct is considered lucky.Find the lexicographically minimal lucky string whose length equals n." 1100

110A "Nearly Lucky Number" implementation "Petya loves lucky numbers. We all know that lucky numbers are the positive integers whose decimal representations contain only the lucky digits 4 and 7. For example, numbers 47, 744, 4 are lucky and 5, 17, 467 are not.Unfortunately, not all numbers are lucky. Petya calls a number nearly lucky if the number of lucky digits in it is a lucky number. He wonders whether number n is a nearly lucky number." 800

109E "Lucky Interval" "brute force,math" "Petya loves lucky numbers. We all know that lucky numbers are the positive integers whose decimal representations contain only the lucky digits 4 and 7. For example, numbers 47, 744, 4 are lucky and 5, 17, 467 are not.One day Petya came across an interval of numbers [a,\xe2\x80\x89a\xe2\x80\x89+\xe2\x80\x89l\xe2\x80\x89-\xe2\x80\x891]. Let F(x) be the number of lucky digits of number x. Find the minimum b (a\xe2\x80\x89<\xe2\x80\x89b) such, that F(a) = F(b), F(a\xe2\x80\x89+\xe2\x80\x891) = F(b\xe2\x80\x89+\xe2\x80\x891), ..., F(a\xe2\x80\x89+\xe2\x80\x89l\xe2\x80\x89-\xe2\x80\x891) = F(b\xe2\x80\x89+\xe2\x80\x89l\xe2\x80\x89-\xe2\x80\x891)." 2700

109D "Lucky Sorting" "constructive algorithms,sortings" "Petya loves lucky numbers. We all know that lucky numbers are the positive integers whose decimal representations contain only the lucky digits 4 and 7. For example, numbers 47, 744, 4 are lucky and 5, 17, 467 are not.Petya got an array consisting of n numbers, it is the gift for his birthday. Now he wants to sort it in the non-decreasing order. However, a usual sorting is boring to perform, that\'s why Petya invented the following limitation: one can swap any two numbers but only if at least one of them is lucky. Your task is to sort the array according to the specified limitation. Find any possible sequence of the swaps (the number of operations in the sequence should not exceed 2n)." 2000

109C "Lucky Tree" dp,dsu,trees "Petya loves lucky numbers. We all know that lucky numbers are the positive integers whose decimal representations contain only the lucky digits 4 and 7. For example, numbers 47, 744, 4 are lucky and 5, 17, 467 are not.One day Petya encountered a tree with n vertexes. Besides, the tree was weighted, i. e. each edge of the tree has weight (a positive integer). An edge is lucky if its weight is a lucky number. Note that a tree with n vertexes is an undirected connected graph that has exactly n\xe2\x80\x89-\xe2\x80\x891 edges.Petya wondered how many vertex triples (i,\xe2\x80\x89j,\xe2\x80\x89k) exists that on the way from i to j, as well as on the way from i to k there must be at least one lucky edge (all three vertexes are pairwise distinct). The order of numbers in the triple matters, that is, the triple (1,\xe2\x80\x892,\xe2\x80\x893) is not equal to the triple (2,\xe2\x80\x891,\xe2\x80\x893) and is not equal to the triple (1,\xe2\x80\x893,\xe2\x80\x892). Find how many such triples of vertexes exist." 1900

109B "Lucky Probability" "brute force,probabilities" "Petya loves lucky numbers. We all know that lucky numbers are the positive integers whose decimal representations contain only the lucky digits 4 and 7. For example, numbers 47, 744, 4 are lucky and 5, 17, 467 are not.Petya and his friend Vasya play an interesting game. Petya randomly chooses an integer p from the interval [pl,\xe2\x80\x89pr] and Vasya chooses an integer v from the interval [vl,\xe2\x80\x89vr] (also randomly). Both players choose their integers equiprobably. Find the probability that the interval [min(v,\xe2\x80\x89p),\xe2\x80\x89max(v,\xe2\x80\x89p)] contains exactly k lucky numbers." 1900

109A "Lucky Sum of Digits" "brute force,implementation" "Petya loves lucky numbers. We all know that lucky numbers are the positive integers whose decimal representations contain only the lucky digits 4 and 7. For example, numbers 47, 744, 4 are lucky and 5, 17, 467 are not.Petya wonders eagerly what minimum lucky number has the sum of digits equal to n. Help him cope with the task." 1000

108B Datatypes math,sortings "Tattah\'s youngest brother, Tuftuf, is new to programming.Since his older brother is such a good programmer, his biggest dream is to outshine him. Tuftuf is a student at the German University in Cairo (GUC) where he learns to write programs in Gava.Today, Tuftuf was introduced to Gava\'s unsigned integer datatypes. Gava has n unsigned integer datatypes of sizes (in bits) a1,\xe2\x80\x89a2,\xe2\x80\x89... an. The i-th datatype have size ai bits, so it can represent every integer between 0 and 2ai\xe2\x80\x89-\xe2\x80\x891 inclusive. Tuftuf is thinking of learning a better programming language. If there exists an integer x, such that x fits in some type i (in ai bits) and x\xc2\xb7x does not fit in some other type j (in aj bits) where ai\xe2\x80\x89<\xe2\x80\x89aj, then Tuftuf will stop using Gava.Your task is to determine Tuftuf\'s destiny." 1400

108A "Palindromic Times" implementation,strings "Tattah is asleep if and only if Tattah is attending a lecture. This is a well-known formula among Tattah\'s colleagues.On a Wednesday afternoon, Tattah was attending Professor HH\'s lecture. At 12:21, right before falling asleep, he was staring at the digital watch around Saher\'s wrist. He noticed that the digits on the clock were the same when read from both directions i.e. a palindrome.In his sleep, he started dreaming about such rare moments of the day when the time displayed on a digital clock is a palindrome. As soon as he woke up, he felt destined to write a program that finds the next such moment.However, he still hasn\'t mastered the skill of programming while sleeping, so your task is to help him." 1000

107E Darts geometry,probabilities "The night after the graduation ceremony graduate students of German University in Cairo (GUC) are playing darts. As there\'s no real dart board available, the photographs of members of the GUC upper management are being used.So, n rectangular photos are placed on the wall. They can overlap arbitrary and even coincide. The photos are not necessarily placed horizontally or vertically, they could also be rotated before being pinned to the wall.The score of one dart throw is simply the number of photos the dart went through.Fatma has made a throw but her score was not recorded. She only remembers that she did make it into at least one photo.Assuming that the probability distribution of the throw is equal across the whole wall, what would be the expectation of Fatma\'s score?" 2700

107D "Crime Management" dp,graphs,matrices "Zeyad wants to commit n crimes in Egypt and not be punished at the end. There are several types of crimes. For example, bribery is a crime but is not considered such when repeated twice. Therefore, bribery is not considered a crime when repeated an even number of times. Speeding is a crime, but is not considered such when repeated a number of times which is a multiple of five.More specifically, c conditions on crime repetitions are known. Each condition describes the crime type ti and its multiplicity mi. If the number of times Zeyad committed the crime ti is a multiple of mi, Zeyad will not be punished for crime ti. Some crimes may be listed more than once. In this case fulfilling at least one condition for this crime is enough to not be punished for it. Of course, if for certain crime the number of times Zeyad committed it is zero, he is innocent with respect to this crime.Now Zeyad is interested in a number of ways he can commit exactly n crimes without any punishment.The order of commiting the crimes matters. More formally, two ways, sequences w1 and w2, of committing n crimes are equal if w1i\xe2\x80\x89=\xe2\x80\x89w2i, for all 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n." 2400

107C Arrangement bitmasks,dp "In the year 2500 the annual graduation ceremony in the German University in Cairo (GUC) has run smoothly for almost 500 years so far.The most important part of the ceremony is related to the arrangement of the professors in the ceremonial hall.Traditionally GUC has n professors. Each professor has his seniority level. All seniorities are different. Let\'s enumerate the professors from 1 to n, with 1 being the most senior professor and n being the most junior professor.The ceremonial hall has n seats, one seat for each professor. Some places in this hall are meant for more senior professors than the others. More specifically, m pairs of seats are in ""senior-junior"" relation, and the tradition requires that for all m pairs of seats (ai,\xe2\x80\x89bi) the professor seated in ""senior"" position ai should be more senior than the professor seated in ""junior"" position bi.GUC is very strict about its traditions, which have been carefully observed starting from year 2001. The tradition requires that:   The seating of the professors changes every year.  Year 2001 ceremony was using lexicographically first arrangement of professors in the ceremonial hall.  Each consecutive year lexicographically next arrangement of the professors is used. The arrangement of the professors is the list of n integers, where the first integer is the seniority of the professor seated in position number one, the second integer is the seniority of the professor seated in position number two, etc.Given n, the number of professors, y, the current year and m pairs of restrictions, output the arrangement of the professors for this year." 2400

107B "Basketball Team" combinatorics,dp,math,probabilities "As a German University in Cairo (GUC) student and a basketball player, Herr Wafa was delighted once he heard the news. GUC is finally participating in the Annual Basketball Competition (ABC). A team is to be formed of n players, all of which are GUC students. However, the team might have players belonging to different departments. There are m departments in GUC, numbered from 1 to m. Herr Wafa\'s department has number h. For each department i, Herr Wafa knows number si \xe2\x80\x94 how many students who play basketball belong to this department.Herr Wafa was also able to guarantee a spot on the team, using his special powers. But since he hates floating-point numbers, he needs your help at finding the probability that he will have at least one teammate belonging to his department. Note that every possible team containing Herr Wafa is equally probable. Consider all the students different from each other." 1600

107A "Dorm Water Supply" "dfs and similar,graphs" "The German University in Cairo (GUC) dorm houses are numbered from 1 to n. Underground water pipes connect these houses together. Each pipe has certain direction (water can flow only in this direction and not vice versa), and diameter (which characterizes the maximal amount of water it can handle).For each house, there is at most one pipe going into it and at most one pipe going out of it. With the new semester starting, GUC student and dorm resident, Lulu, wants to install tanks and taps at the dorms. For every house with an outgoing water pipe and without an incoming water pipe, Lulu should install a water tank at that house. For every house with an incoming water pipe and without an outgoing water pipe, Lulu should install a water tap at that house. Each tank house will convey water to all houses that have a sequence of pipes from the tank to it. Accordingly, each tap house will receive water originating from some tank house.In order to avoid pipes from bursting one week later (like what happened last semester), Lulu also has to consider the diameter of the pipes. The amount of water each tank conveys should not exceed the diameter of the pipes connecting a tank to its corresponding tap. Lulu wants to find the maximal amount of water that can be safely conveyed from each tank to its corresponding tap." 1400

106E "Space Rescuers" "geometry,ternary search" "The Galaxy contains n planets, there are many different living creatures inhabiting each planet. And each creature can get into troubles! Space rescuers know it perfectly well and they are always ready to help anyone who really needs help. All you need to do is call for them. Now the space rescuers plan to build the largest in the history of the Galaxy rescue station; however, the rescue station\'s location is yet to be determined. As some cases are real emergencies, the rescuers want to find such a point in the Galaxy from which it would be possible to get to the remotest planet in the minimum possible time. In other words, the rescuers need such point in the space that the distance between it and the planet remotest from it was minimal (if we compare this point with all other possible points in the space). Unfortunately, the rescuers can\'t sole this problem.As the planets are quite remote from each other, they can be considered as points in Euclidean three-dimensional space. The distance between points (xi,\xe2\x80\x89yi,\xe2\x80\x89zi) and (xj,\xe2\x80\x89yj,\xe2\x80\x89zj) can be calculated by the formula . The rescue station can be positioned in any point in the space. It can also coincide with some planet. Galaxy is in danger! Save the space rescuers and find the required point for them." 2100

106D "Treasure Island" "brute force,implementation" "Our brave travelers reached an island where pirates had buried treasure. However as the ship was about to moor, the captain found out that some rat ate a piece of the treasure map.The treasure map can be represented as a rectangle n\xe2\x80\x89\xc3\x97\xe2\x80\x89m in size. Each cell stands for an islands\' square (the square\'s side length equals to a mile). Some cells stand for the sea and they are impenetrable. All other cells are penetrable (i.e. available) and some of them contain local sights. For example, the large tree on the hills or the cave in the rocks.Besides, the map also has a set of k instructions. Each instruction is in the following form:""Walk n miles in the y direction""The possible directions are: north, south, east, and west. If you follow these instructions carefully (you should fulfill all of them, one by one) then you should reach exactly the place where treasures are buried. Unfortunately the captain doesn\'t know the place where to start fulfilling the instructions \xe2\x80\x94 as that very piece of the map was lost. But the captain very well remembers that the place contained some local sight. Besides, the captain knows that the whole way goes through the island\'s penetrable squares.The captain wants to know which sights are worth checking. He asks you to help him with that." 1700

106C Buns dp "Lavrenty, a baker, is going to make several buns with stuffings and sell them.Lavrenty has n grams of dough as well as m different stuffing types. The stuffing types are numerated from 1 to m. Lavrenty knows that he has ai grams left of the i-th stuffing. It takes exactly bi grams of stuffing i and ci grams of dough to cook a bun with the i-th stuffing. Such bun can be sold for di tugriks.Also he can make buns without stuffings. Each of such buns requires c0 grams of dough and it can be sold for d0 tugriks. So Lavrenty can cook any number of buns with different stuffings or without it unless he runs out of dough and the stuffings. Lavrenty throws away all excess material left after baking.Find the maximum number of tugriks Lavrenty can earn." 1700

106B "Choosing Laptop" "brute force,implementation" "Vasya is choosing a laptop. The shop has n laptops to all tastes.Vasya is interested in the following properties: processor speed, ram and hdd. Vasya is a programmer and not a gamer which is why he is not interested in all other properties.If all three properties of a laptop are strictly less than those properties of some other laptop, then the first laptop is considered outdated by Vasya. Among all laptops Vasya does not consider outdated, he chooses the cheapest one.There are very many laptops, which is why Vasya decided to write a program that chooses the suitable laptop. However, Vasya doesn\'t have his own laptop yet and he asks you to help him." 1000

106A "Card Game" implementation "There is a card game called ""Durak"", which means ""Fool"" in Russian. The game is quite popular in the countries that used to form USSR. The problem does not state all the game\'s rules explicitly \xe2\x80\x94 you can find them later yourselves if you want.To play durak you need a pack of 36 cards. Each card has a suit (""S"", ""H"", ""D"" and ""C"") and a rank (in the increasing order ""6"", ""7"", ""8"", ""9"", ""T"", ""J"", ""Q"", ""K"" and ""A""). At the beginning of the game one suit is arbitrarily chosen as trump. The players move like that: one player puts one or several of his cards on the table and the other one should beat each of them with his cards.A card beats another one if both cards have similar suits and the first card has a higher rank then the second one. Besides, a trump card can beat any non-trump card whatever the cards\xe2\x80\x99 ranks are. In all other cases you can not beat the second card with the first one.You are given the trump suit and two different cards. Determine whether the first one beats the second one or not." 1000

105E "Lift and Throw" "brute force" "You are given a straight half-line divided into segments of unit length, which we will call positions. The positions are numbered by positive integers that start with 1 from the end of half-line, i. e. 1, 2, 3 and so on. The distance between the positions is the absolute difference between the respective numbers. Laharl, Etna and Flonne occupy some positions on the half-line and they want to get to the position with the largest possible number. They are originally placed in different positions. Each of the characters can perform each of the following actions no more than once:   Move a certain distance.  Grab another character and lift him above the head.  Throw the lifted character a certain distance.  Each character has a movement range parameter. They can only move to free positions, assuming that distance between those positions doesn\'t exceed the movement range. One character can lift another character if the distance between the two characters equals 1, and no one already holds that another character. We can assume that the lifted character moves to the same position as the person who has lifted him, and the position in which he stood before becomes free. A lifted character cannot perform any actions and the character that holds him cannot walk. Also, each character has a throwing range parameter. It is the distance at which this character can throw the one lifted above his head. He can only throw a character to a free position, and only when there is a lifted character. We accept the situation when one person grabs another one who in his turn has the third character in his hands. This forms a ""column"" of three characters. For example, Laharl can hold Etna while Etna holds Flonne. In this case, Etna and the Flonne cannot perform any actions, and Laharl can only throw Etna (together with Flonne) at some distance. Laharl, Etna and Flonne perform actions in any order. They perform actions in turns, that is no two of them can do actions at the same time.Determine the maximum number of position at least one of the characters can reach. That is, such maximal number x so that one of the characters can reach position x." 2500

105D "Entertaining Geodetics" "brute force,dsu,implementation" "The maps in the game are divided into square cells called Geo Panels. Some of these panels are painted. We shall assume that the Geo Panels without color are painted the transparent color. Besides, the map has so-called Geo Symbols. They look like pyramids of different colors (including Geo Symbols of the transparent color). Each Geo Symbol is located on one Geo Panel, and each Geo Panel may contain no more than one Geo Symbol. Geo Symbols can be eliminated. To understand better what happens when a Geo Symbol is eliminated, let us introduce some queue to which we will put the recently eliminated Geo Symbols. Let\'s put at the head of the queue a Geo Symbol that was eliminated just now. Next, we will repeat the following operation: Extract the Geo Symbol from the queue. Look at the color of the panel containing the given Geo Symbol. If it differs from transparent and differs from the color of the Geo Symbol, then all Geo Panels of this color are repainted in the color of the given Geo Symbol (transparent Geo Symbols repaint the Geo Panels transparent). Repainting is executed in an infinite spiral strictly in the following order starting from the panel, which contained the Geo Symbol:   In other words, we select all the panels that need to be repainted and find their numbers in the infinite spiral whose center is placed in the position of the given Geo Symbol. After that, we repaint them in the order of the number\'s increasing. If a panel contains another Geo Symbol and this panel is being repainted, then the Geo Symbol is removed from the field and placed at the tail of the queue. After repainting the Geo Symbol is completely eliminated and the next Geo Symbol is taken from the head of the queue (if there is any) and the process repeats. The process ends if the queue is empty. See the sample analysis for better understanding. You know the colors of all the Geo Panels and the location of all the Geo Symbols. Determine the number of repaintings, which will occur if you destroy one of the Geo Symbols." 2700

105C "Item World" "brute force,implementation,sortings" "Each item in the game has a level. The higher the level is, the higher basic parameters the item has. We shall consider only the following basic parameters: attack (atk), defense (def) and resistance to different types of impact (res).Each item belongs to one class. In this problem we will only consider three of such classes: weapon, armor, orb.Besides, there\'s a whole new world hidden inside each item. We can increase an item\'s level travelling to its world. We can also capture the so-called residents in the Item WorldResidents are the creatures that live inside items. Each resident gives some bonus to the item in which it is currently located. We will only consider residents of types: gladiator (who improves the item\'s atk), sentry (who improves def) and physician (who improves res).Each item has the size parameter. The parameter limits the maximum number of residents that can live inside an item. We can move residents between items. Within one moment of time we can take some resident from an item and move it to some other item if it has a free place for a new resident. We cannot remove a resident from the items and leave outside \xe2\x80\x94 any of them should be inside of some item at any moment of time.Laharl has a certain number of items. He wants to move the residents between items so as to equip himself with weapon, armor and a defensive orb. The weapon\'s atk should be largest possible in the end. Among all equipping patterns containing weapon\'s maximum atk parameter we should choose the ones where the armor\xe2\x80\x99s def parameter is the largest possible. Among all such equipment patterns we should choose the one where the defensive orb would have the largest possible res parameter. Values of the parameters def and res of weapon, atk and res of armor and atk and def of orb are indifferent for Laharl.Find the optimal equipment pattern Laharl can get." 2200

105B "Dark Assembly" "brute force,probabilities" "Dark Assembly is a governing body in the Netherworld. Here sit the senators who take the most important decisions for the player. For example, to expand the range of the shop or to improve certain characteristics of the character the Dark Assembly\'s approval is needed.The Dark Assembly consists of n senators. Each of them is characterized by his level and loyalty to the player. The level is a positive integer which reflects a senator\'s strength. Loyalty is the probability of a positive decision in the voting, which is measured as a percentage with precision of up to 10%. Senators make decisions by voting. Each of them makes a positive or negative decision in accordance with their loyalty. If strictly more than half of the senators take a positive decision, the player\'s proposal is approved. If the player\'s proposal is not approved after the voting, then the player may appeal against the decision of the Dark Assembly. To do that, player needs to kill all the senators that voted against (there\'s nothing wrong in killing senators, they will resurrect later and will treat the player even worse). The probability that a player will be able to kill a certain group of senators is equal to A\xe2\x80\x89/\xe2\x80\x89(A\xe2\x80\x89+\xe2\x80\x89B), where A is the sum of levels of all player\'s characters and B is the sum of levels of all senators in this group. If the player kills all undesired senators, then his proposal is approved.Senators are very fond of sweets. They can be bribed by giving them candies. For each received candy a senator increases his loyalty to the player by 10%. It\'s worth to mention that loyalty cannot exceed 100%. The player can take no more than k sweets to the courtroom. Candies should be given to the senators before the start of voting.Determine the probability that the Dark Assembly approves the player\'s proposal if the candies are distributed among the senators in the optimal way." 1800

105A Transmigration implementation "In Disgaea as in most role-playing games, characters have skills that determine the character\'s ability to use certain weapons or spells. If the character does not have the necessary skill, he cannot use it. The skill level is represented as an integer that increases when you use this skill. Different character classes are characterized by different skills. Unfortunately, the skills that are uncommon for the given character\'s class are quite difficult to obtain. To avoid this limitation, there is the so-called transmigration. Transmigration is reincarnation of the character in a new creature. His soul shifts to a new body and retains part of his experience from the previous life. As a result of transmigration the new character gets all the skills of the old character and the skill levels are reduced according to the k coefficient (if the skill level was equal to x, then after transmigration it becomes equal to [kx], where [y] is the integral part of y). If some skill\'s levels are strictly less than 100, these skills are forgotten (the character does not have them any more). After that the new character also gains the skills that are specific for his class, but are new to him. The levels of those additional skills are set to 0. Thus, one can create a character with skills specific for completely different character classes via transmigrations. For example, creating a mage archer or a thief warrior is possible. You are suggested to solve the following problem: what skills will the character have after transmigration and what will the levels of those skills be?" 1700

104A Blackjack implementation "One rainy gloomy evening when all modules hid in the nearby cafes to drink hot energetic cocktails, the Hexadecimal virus decided to fly over the Mainframe to look for a Great Idea. And she has found one!Why not make her own Codeforces, with blackjack and other really cool stuff? Many people will surely be willing to visit this splendid shrine of high culture.In Mainframe a standard pack of 52 cards is used to play blackjack. The pack contains cards of 13 values: 2, 3, 4, 5, 6, 7, 8, 9, 10, jacks, queens, kings and aces. Each value also exists in one of four suits: hearts, diamonds, clubs and spades. Also, each card earns some value in points assigned to it: cards with value from two to ten earn from 2 to 10 points, correspondingly. An ace can either earn 1 or 11, whatever the player wishes. The picture cards (king, queen and jack) earn 10 points. The number of points a card earns does not depend on the suit. The rules of the game are very simple. The player gets two cards, if the sum of points of those cards equals n, then the player wins, otherwise the player loses.The player has already got the first card, it\'s the queen of spades. To evaluate chances for victory, you should determine how many ways there are to get the second card so that the sum of points exactly equals n." 800

103E "Buying Sets" "flows,graph matchings" "The Hexadecimal virus loves playing with number sets \xe2\x80\x94 intersecting them, uniting them. One beautiful day she was surprised to find out that Scuzzy, her spherical pet cat, united all sets in one and ate the result! Something had to be done quickly and Hexadecimal rushed to the market.The market has n sets of numbers on sale. The virus wants to buy the following collection of sets: the number of sets in the collection should be exactly the same as the number of numbers in the union of all bought sets. Moreover, Hexadecimal wants to buy the cheapest suitable collection of set.Yet nothing\'s so easy! As Mainframe is a kingdom of pure rivalry markets, we know that the union of any k sets contains no less than k distinct numbers (for every positive integer k).Help the virus choose the suitable collection of sets. The collection can be empty." 2900

103D "Time to Raid Cowavans" "brute force,data structures,sortings" "As you know, the most intelligent beings on the Earth are, of course, cows. This conclusion was reached long ago by the Martian aliens, as well as a number of other intelligent civilizations from outer space. Sometimes cows gather into cowavans. This seems to be seasonal. But at this time the cows become passive and react poorly to external stimuli. A cowavan is a perfect target for the Martian scientific saucer, it\'s time for large-scale abductions, or, as the Martians say, raids. Simply put, a cowavan is a set of cows in a row. If we number all cows in the cowavan with positive integers from 1 to n, then we can formalize the popular model of abduction, known as the (a,\xe2\x80\x89b)-Cowavan Raid: first they steal a cow number a, then number a\xe2\x80\x89+\xe2\x80\x89b, then \xe2\x80\x94 number a\xe2\x80\x89+\xe2\x80\x892\xc2\xb7b, and so on, until the number of an abducted cow exceeds n. During one raid the cows are not renumbered. The aliens would be happy to place all the cows on board of their hospitable ship, but unfortunately, the amount of cargo space is very, very limited. The researchers, knowing the mass of each cow in the cowavan, made p scenarios of the (a,\xe2\x80\x89b)-raid. Now they want to identify the following thing for each scenario individually: what total mass of pure beef will get on board of the ship. All the scenarios are independent, in the process of performing the calculations the cows are not being stolen." 2100

103C "Russian Roulette" "constructive algorithms,greedy" "After all the events in Orlando we all know, Sasha and Roma decided to find out who is still the team\'s biggest loser. Thankfully, Masha found somewhere a revolver with a rotating cylinder of n bullet slots able to contain exactly k bullets, now the boys have a chance to resolve the problem once and for all. Sasha selects any k out of n slots he wishes and puts bullets there. Roma spins the cylinder so that every of n possible cylinder\'s shifts is equiprobable. Then the game starts, the players take turns, Sasha starts: he puts the gun to his head and shoots. If there was no bullet in front of the trigger, the cylinder shifts by one position and the weapon is given to Roma for make the same move. The game continues until someone is shot, the survivor is the winner. Sasha does not want to lose, so he must choose slots for bullets in such a way as to minimize the probability of its own loss. Of all the possible variant he wants to select the lexicographically minimal one, where an empty slot is lexicographically less than a charged one. More formally, the cylinder of n bullet slots able to contain k bullets can be represented as a string of n characters. Exactly k of them are ""X"" (charged slots) and the others are ""."" (uncharged slots). Let us describe the process of a shot. Suppose that the trigger is in front of the first character of the string (the first slot). If a shot doesn\'t kill anyone and the cylinder shifts, then the string shifts left. So the first character becomes the last one, the second character becomes the first one, and so on. But the trigger doesn\'t move. It will be in front of the first character of the resulting string.Among all the strings that give the minimal probability of loss, Sasha choose the lexicographically minimal one. According to this very string, he charges the gun. You have to help Sasha to charge the gun. For that, each xi query must be answered: is there a bullet in the positions xi?" 1900

103B Cthulhu "dfs and similar,dsu,graphs" "After all the events in Orlando we all know, Sasha and Roma decided to find out who is still the team\'s biggest loser. Thankfully, Masha found somewhere a revolver with a rotating cylinder of n bullet slots able to contain exactly k bullets, now the boys have a chance to resolve the problem once and for all. Sasha selects any k out of n slots he wishes and puts bullets there. Roma spins the cylinder so that every of n possible cylinder\'s shifts is equiprobable. Then the game starts, the players take turns, Sasha starts: he puts the gun to his head and shoots. If there was no bullet in front of the trigger, the cylinder shifts by one position and the weapon is given to Roma for make the same move. The game continues until someone is shot, the survivor is the winner. Sasha does not want to lose, so he must choose slots for bullets in such a way as to minimize the probability of its own loss. Of all the possible variant he wants to select the lexicographically minimal one, where an empty slot is lexicographically less than a charged one. More formally, the cylinder of n bullet slots able to contain k bullets can be represented as a string of n characters. Exactly k of them are ""X"" (charged slots) and the others are ""."" (uncharged slots). Let us describe the process of a shot. Suppose that the trigger is in front of the first character of the string (the first slot). If a shot doesn\'t kill anyone and the cylinder shifts, then the string shifts left. So the first character becomes the last one, the second character becomes the first one, and so on. But the trigger doesn\'t move. It will be in front of the first character of the resulting string.Among all the strings that give the minimal probability of loss, Sasha choose the lexicographically minimal one. According to this very string, he charges the gun. You have to help Sasha to charge the gun. For that, each xi query must be answered: is there a bullet in the positions xi?" 1500

103A "Testing Pants for Sadness" greedy,implementation,math "After all the events in Orlando we all know, Sasha and Roma decided to find out who is still the team\'s biggest loser. Thankfully, Masha found somewhere a revolver with a rotating cylinder of n bullet slots able to contain exactly k bullets, now the boys have a chance to resolve the problem once and for all. Sasha selects any k out of n slots he wishes and puts bullets there. Roma spins the cylinder so that every of n possible cylinder\'s shifts is equiprobable. Then the game starts, the players take turns, Sasha starts: he puts the gun to his head and shoots. If there was no bullet in front of the trigger, the cylinder shifts by one position and the weapon is given to Roma for make the same move. The game continues until someone is shot, the survivor is the winner. Sasha does not want to lose, so he must choose slots for bullets in such a way as to minimize the probability of its own loss. Of all the possible variant he wants to select the lexicographically minimal one, where an empty slot is lexicographically less than a charged one. More formally, the cylinder of n bullet slots able to contain k bullets can be represented as a string of n characters. Exactly k of them are ""X"" (charged slots) and the others are ""."" (uncharged slots). Let us describe the process of a shot. Suppose that the trigger is in front of the first character of the string (the first slot). If a shot doesn\'t kill anyone and the cylinder shifts, then the string shifts left. So the first character becomes the last one, the second character becomes the first one, and so on. But the trigger doesn\'t move. It will be in front of the first character of the resulting string.Among all the strings that give the minimal probability of loss, Sasha choose the lexicographically minimal one. According to this very string, he charges the gun. You have to help Sasha to charge the gun. For that, each xi query must be answered: is there a bullet in the positions xi?" 1100

102B "Sum of Digits" implementation "After all the events in Orlando we all know, Sasha and Roma decided to find out who is still the team\'s biggest loser. Thankfully, Masha found somewhere a revolver with a rotating cylinder of n bullet slots able to contain exactly k bullets, now the boys have a chance to resolve the problem once and for all. Sasha selects any k out of n slots he wishes and puts bullets there. Roma spins the cylinder so that every of n possible cylinder\'s shifts is equiprobable. Then the game starts, the players take turns, Sasha starts: he puts the gun to his head and shoots. If there was no bullet in front of the trigger, the cylinder shifts by one position and the weapon is given to Roma for make the same move. The game continues until someone is shot, the survivor is the winner. Sasha does not want to lose, so he must choose slots for bullets in such a way as to minimize the probability of its own loss. Of all the possible variant he wants to select the lexicographically minimal one, where an empty slot is lexicographically less than a charged one. More formally, the cylinder of n bullet slots able to contain k bullets can be represented as a string of n characters. Exactly k of them are ""X"" (charged slots) and the others are ""."" (uncharged slots). Let us describe the process of a shot. Suppose that the trigger is in front of the first character of the string (the first slot). If a shot doesn\'t kill anyone and the cylinder shifts, then the string shifts left. So the first character becomes the last one, the second character becomes the first one, and so on. But the trigger doesn\'t move. It will be in front of the first character of the resulting string.Among all the strings that give the minimal probability of loss, Sasha choose the lexicographically minimal one. According to this very string, he charges the gun. You have to help Sasha to charge the gun. For that, each xi query must be answered: is there a bullet in the positions xi?" 1000

102A Clothes "brute force" "After all the events in Orlando we all know, Sasha and Roma decided to find out who is still the team\'s biggest loser. Thankfully, Masha found somewhere a revolver with a rotating cylinder of n bullet slots able to contain exactly k bullets, now the boys have a chance to resolve the problem once and for all. Sasha selects any k out of n slots he wishes and puts bullets there. Roma spins the cylinder so that every of n possible cylinder\'s shifts is equiprobable. Then the game starts, the players take turns, Sasha starts: he puts the gun to his head and shoots. If there was no bullet in front of the trigger, the cylinder shifts by one position and the weapon is given to Roma for make the same move. The game continues until someone is shot, the survivor is the winner. Sasha does not want to lose, so he must choose slots for bullets in such a way as to minimize the probability of its own loss. Of all the possible variant he wants to select the lexicographically minimal one, where an empty slot is lexicographically less than a charged one. More formally, the cylinder of n bullet slots able to contain k bullets can be represented as a string of n characters. Exactly k of them are ""X"" (charged slots) and the others are ""."" (uncharged slots). Let us describe the process of a shot. Suppose that the trigger is in front of the first character of the string (the first slot). If a shot doesn\'t kill anyone and the cylinder shifts, then the string shifts left. So the first character becomes the last one, the second character becomes the first one, and so on. But the trigger doesn\'t move. It will be in front of the first character of the resulting string.Among all the strings that give the minimal probability of loss, Sasha choose the lexicographically minimal one. According to this very string, he charges the gun. You have to help Sasha to charge the gun. For that, each xi query must be answered: is there a bullet in the positions xi?" 1200

101E "Candies and Stones" "divide and conquer,dp" "After all the events in Orlando we all know, Sasha and Roma decided to find out who is still the team\'s biggest loser. Thankfully, Masha found somewhere a revolver with a rotating cylinder of n bullet slots able to contain exactly k bullets, now the boys have a chance to resolve the problem once and for all. Sasha selects any k out of n slots he wishes and puts bullets there. Roma spins the cylinder so that every of n possible cylinder\'s shifts is equiprobable. Then the game starts, the players take turns, Sasha starts: he puts the gun to his head and shoots. If there was no bullet in front of the trigger, the cylinder shifts by one position and the weapon is given to Roma for make the same move. The game continues until someone is shot, the survivor is the winner. Sasha does not want to lose, so he must choose slots for bullets in such a way as to minimize the probability of its own loss. Of all the possible variant he wants to select the lexicographically minimal one, where an empty slot is lexicographically less than a charged one. More formally, the cylinder of n bullet slots able to contain k bullets can be represented as a string of n characters. Exactly k of them are ""X"" (charged slots) and the others are ""."" (uncharged slots). Let us describe the process of a shot. Suppose that the trigger is in front of the first character of the string (the first slot). If a shot doesn\'t kill anyone and the cylinder shifts, then the string shifts left. So the first character becomes the last one, the second character becomes the first one, and so on. But the trigger doesn\'t move. It will be in front of the first character of the resulting string.Among all the strings that give the minimal probability of loss, Sasha choose the lexicographically minimal one. According to this very string, he charges the gun. You have to help Sasha to charge the gun. For that, each xi query must be answered: is there a bullet in the positions xi?" 2500

101D Castle dp,greedy,probabilities,sortings,trees "After all the events in Orlando we all know, Sasha and Roma decided to find out who is still the team\'s biggest loser. Thankfully, Masha found somewhere a revolver with a rotating cylinder of n bullet slots able to contain exactly k bullets, now the boys have a chance to resolve the problem once and for all. Sasha selects any k out of n slots he wishes and puts bullets there. Roma spins the cylinder so that every of n possible cylinder\'s shifts is equiprobable. Then the game starts, the players take turns, Sasha starts: he puts the gun to his head and shoots. If there was no bullet in front of the trigger, the cylinder shifts by one position and the weapon is given to Roma for make the same move. The game continues until someone is shot, the survivor is the winner. Sasha does not want to lose, so he must choose slots for bullets in such a way as to minimize the probability of its own loss. Of all the possible variant he wants to select the lexicographically minimal one, where an empty slot is lexicographically less than a charged one. More formally, the cylinder of n bullet slots able to contain k bullets can be represented as a string of n characters. Exactly k of them are ""X"" (charged slots) and the others are ""."" (uncharged slots). Let us describe the process of a shot. Suppose that the trigger is in front of the first character of the string (the first slot). If a shot doesn\'t kill anyone and the cylinder shifts, then the string shifts left. So the first character becomes the last one, the second character becomes the first one, and so on. But the trigger doesn\'t move. It will be in front of the first character of the resulting string.Among all the strings that give the minimal probability of loss, Sasha choose the lexicographically minimal one. According to this very string, he charges the gun. You have to help Sasha to charge the gun. For that, each xi query must be answered: is there a bullet in the positions xi?" 2300

101C Vectors implementation,math "After all the events in Orlando we all know, Sasha and Roma decided to find out who is still the team\'s biggest loser. Thankfully, Masha found somewhere a revolver with a rotating cylinder of n bullet slots able to contain exactly k bullets, now the boys have a chance to resolve the problem once and for all. Sasha selects any k out of n slots he wishes and puts bullets there. Roma spins the cylinder so that every of n possible cylinder\'s shifts is equiprobable. Then the game starts, the players take turns, Sasha starts: he puts the gun to his head and shoots. If there was no bullet in front of the trigger, the cylinder shifts by one position and the weapon is given to Roma for make the same move. The game continues until someone is shot, the survivor is the winner. Sasha does not want to lose, so he must choose slots for bullets in such a way as to minimize the probability of its own loss. Of all the possible variant he wants to select the lexicographically minimal one, where an empty slot is lexicographically less than a charged one. More formally, the cylinder of n bullet slots able to contain k bullets can be represented as a string of n characters. Exactly k of them are ""X"" (charged slots) and the others are ""."" (uncharged slots). Let us describe the process of a shot. Suppose that the trigger is in front of the first character of the string (the first slot). If a shot doesn\'t kill anyone and the cylinder shifts, then the string shifts left. So the first character becomes the last one, the second character becomes the first one, and so on. But the trigger doesn\'t move. It will be in front of the first character of the resulting string.Among all the strings that give the minimal probability of loss, Sasha choose the lexicographically minimal one. According to this very string, he charges the gun. You have to help Sasha to charge the gun. For that, each xi query must be answered: is there a bullet in the positions xi?" 2000

101B Buses "binary search,data structures,dp" "After all the events in Orlando we all know, Sasha and Roma decided to find out who is still the team\'s biggest loser. Thankfully, Masha found somewhere a revolver with a rotating cylinder of n bullet slots able to contain exactly k bullets, now the boys have a chance to resolve the problem once and for all. Sasha selects any k out of n slots he wishes and puts bullets there. Roma spins the cylinder so that every of n possible cylinder\'s shifts is equiprobable. Then the game starts, the players take turns, Sasha starts: he puts the gun to his head and shoots. If there was no bullet in front of the trigger, the cylinder shifts by one position and the weapon is given to Roma for make the same move. The game continues until someone is shot, the survivor is the winner. Sasha does not want to lose, so he must choose slots for bullets in such a way as to minimize the probability of its own loss. Of all the possible variant he wants to select the lexicographically minimal one, where an empty slot is lexicographically less than a charged one. More formally, the cylinder of n bullet slots able to contain k bullets can be represented as a string of n characters. Exactly k of them are ""X"" (charged slots) and the others are ""."" (uncharged slots). Let us describe the process of a shot. Suppose that the trigger is in front of the first character of the string (the first slot). If a shot doesn\'t kill anyone and the cylinder shifts, then the string shifts left. So the first character becomes the last one, the second character becomes the first one, and so on. But the trigger doesn\'t move. It will be in front of the first character of the resulting string.Among all the strings that give the minimal probability of loss, Sasha choose the lexicographically minimal one. According to this very string, he charges the gun. You have to help Sasha to charge the gun. For that, each xi query must be answered: is there a bullet in the positions xi?" 1700

101A Homework greedy "After all the events in Orlando we all know, Sasha and Roma decided to find out who is still the team\'s biggest loser. Thankfully, Masha found somewhere a revolver with a rotating cylinder of n bullet slots able to contain exactly k bullets, now the boys have a chance to resolve the problem once and for all. Sasha selects any k out of n slots he wishes and puts bullets there. Roma spins the cylinder so that every of n possible cylinder\'s shifts is equiprobable. Then the game starts, the players take turns, Sasha starts: he puts the gun to his head and shoots. If there was no bullet in front of the trigger, the cylinder shifts by one position and the weapon is given to Roma for make the same move. The game continues until someone is shot, the survivor is the winner. Sasha does not want to lose, so he must choose slots for bullets in such a way as to minimize the probability of its own loss. Of all the possible variant he wants to select the lexicographically minimal one, where an empty slot is lexicographically less than a charged one. More formally, the cylinder of n bullet slots able to contain k bullets can be represented as a string of n characters. Exactly k of them are ""X"" (charged slots) and the others are ""."" (uncharged slots). Let us describe the process of a shot. Suppose that the trigger is in front of the first character of the string (the first slot). If a shot doesn\'t kill anyone and the cylinder shifts, then the string shifts left. So the first character becomes the last one, the second character becomes the first one, and so on. But the trigger doesn\'t move. It will be in front of the first character of the resulting string.Among all the strings that give the minimal probability of loss, Sasha choose the lexicographically minimal one. According to this very string, he charges the gun. You have to help Sasha to charge the gun. For that, each xi query must be answered: is there a bullet in the positions xi?" 1200

100J "Interval Coloring" "*special problem,greedy,math" "After all the events in Orlando we all know, Sasha and Roma decided to find out who is still the team\'s biggest loser. Thankfully, Masha found somewhere a revolver with a rotating cylinder of n bullet slots able to contain exactly k bullets, now the boys have a chance to resolve the problem once and for all. Sasha selects any k out of n slots he wishes and puts bullets there. Roma spins the cylinder so that every of n possible cylinder\'s shifts is equiprobable. Then the game starts, the players take turns, Sasha starts: he puts the gun to his head and shoots. If there was no bullet in front of the trigger, the cylinder shifts by one position and the weapon is given to Roma for make the same move. The game continues until someone is shot, the survivor is the winner. Sasha does not want to lose, so he must choose slots for bullets in such a way as to minimize the probability of its own loss. Of all the possible variant he wants to select the lexicographically minimal one, where an empty slot is lexicographically less than a charged one. More formally, the cylinder of n bullet slots able to contain k bullets can be represented as a string of n characters. Exactly k of them are ""X"" (charged slots) and the others are ""."" (uncharged slots). Let us describe the process of a shot. Suppose that the trigger is in front of the first character of the string (the first slot). If a shot doesn\'t kill anyone and the cylinder shifts, then the string shifts left. So the first character becomes the last one, the second character becomes the first one, and so on. But the trigger doesn\'t move. It will be in front of the first character of the resulting string.Among all the strings that give the minimal probability of loss, Sasha choose the lexicographically minimal one. According to this very string, he charges the gun. You have to help Sasha to charge the gun. For that, each xi query must be answered: is there a bullet in the positions xi?" 2400

100I Rotation "*special problem,geometry,math" "After all the events in Orlando we all know, Sasha and Roma decided to find out who is still the team\'s biggest loser. Thankfully, Masha found somewhere a revolver with a rotating cylinder of n bullet slots able to contain exactly k bullets, now the boys have a chance to resolve the problem once and for all. Sasha selects any k out of n slots he wishes and puts bullets there. Roma spins the cylinder so that every of n possible cylinder\'s shifts is equiprobable. Then the game starts, the players take turns, Sasha starts: he puts the gun to his head and shoots. If there was no bullet in front of the trigger, the cylinder shifts by one position and the weapon is given to Roma for make the same move. The game continues until someone is shot, the survivor is the winner. Sasha does not want to lose, so he must choose slots for bullets in such a way as to minimize the probability of its own loss. Of all the possible variant he wants to select the lexicographically minimal one, where an empty slot is lexicographically less than a charged one. More formally, the cylinder of n bullet slots able to contain k bullets can be represented as a string of n characters. Exactly k of them are ""X"" (charged slots) and the others are ""."" (uncharged slots). Let us describe the process of a shot. Suppose that the trigger is in front of the first character of the string (the first slot). If a shot doesn\'t kill anyone and the cylinder shifts, then the string shifts left. So the first character becomes the last one, the second character becomes the first one, and so on. But the trigger doesn\'t move. It will be in front of the first character of the resulting string.Among all the strings that give the minimal probability of loss, Sasha choose the lexicographically minimal one. According to this very string, he charges the gun. You have to help Sasha to charge the gun. For that, each xi query must be answered: is there a bullet in the positions xi?" 1500

100H Battleship "*special problem,dfs and similar,implementation" "After all the events in Orlando we all know, Sasha and Roma decided to find out who is still the team\'s biggest loser. Thankfully, Masha found somewhere a revolver with a rotating cylinder of n bullet slots able to contain exactly k bullets, now the boys have a chance to resolve the problem once and for all. Sasha selects any k out of n slots he wishes and puts bullets there. Roma spins the cylinder so that every of n possible cylinder\'s shifts is equiprobable. Then the game starts, the players take turns, Sasha starts: he puts the gun to his head and shoots. If there was no bullet in front of the trigger, the cylinder shifts by one position and the weapon is given to Roma for make the same move. The game continues until someone is shot, the survivor is the winner. Sasha does not want to lose, so he must choose slots for bullets in such a way as to minimize the probability of its own loss. Of all the possible variant he wants to select the lexicographically minimal one, where an empty slot is lexicographically less than a charged one. More formally, the cylinder of n bullet slots able to contain k bullets can be represented as a string of n characters. Exactly k of them are ""X"" (charged slots) and the others are ""."" (uncharged slots). Let us describe the process of a shot. Suppose that the trigger is in front of the first character of the string (the first slot). If a shot doesn\'t kill anyone and the cylinder shifts, then the string shifts left. So the first character becomes the last one, the second character becomes the first one, and so on. But the trigger doesn\'t move. It will be in front of the first character of the resulting string.Among all the strings that give the minimal probability of loss, Sasha choose the lexicographically minimal one. According to this very string, he charges the gun. You have to help Sasha to charge the gun. For that, each xi query must be answered: is there a bullet in the positions xi?" 2100

100G "Name the album" "*special problem,data structures,implementation" "After all the events in Orlando we all know, Sasha and Roma decided to find out who is still the team\'s biggest loser. Thankfully, Masha found somewhere a revolver with a rotating cylinder of n bullet slots able to contain exactly k bullets, now the boys have a chance to resolve the problem once and for all. Sasha selects any k out of n slots he wishes and puts bullets there. Roma spins the cylinder so that every of n possible cylinder\'s shifts is equiprobable. Then the game starts, the players take turns, Sasha starts: he puts the gun to his head and shoots. If there was no bullet in front of the trigger, the cylinder shifts by one position and the weapon is given to Roma for make the same move. The game continues until someone is shot, the survivor is the winner. Sasha does not want to lose, so he must choose slots for bullets in such a way as to minimize the probability of its own loss. Of all the possible variant he wants to select the lexicographically minimal one, where an empty slot is lexicographically less than a charged one. More formally, the cylinder of n bullet slots able to contain k bullets can be represented as a string of n characters. Exactly k of them are ""X"" (charged slots) and the others are ""."" (uncharged slots). Let us describe the process of a shot. Suppose that the trigger is in front of the first character of the string (the first slot). If a shot doesn\'t kill anyone and the cylinder shifts, then the string shifts left. So the first character becomes the last one, the second character becomes the first one, and so on. But the trigger doesn\'t move. It will be in front of the first character of the resulting string.Among all the strings that give the minimal probability of loss, Sasha choose the lexicographically minimal one. According to this very string, he charges the gun. You have to help Sasha to charge the gun. For that, each xi query must be answered: is there a bullet in the positions xi?" 1800

100F Polynom "*special problem,implementation" "After all the events in Orlando we all know, Sasha and Roma decided to find out who is still the team\'s biggest loser. Thankfully, Masha found somewhere a revolver with a rotating cylinder of n bullet slots able to contain exactly k bullets, now the boys have a chance to resolve the problem once and for all. Sasha selects any k out of n slots he wishes and puts bullets there. Roma spins the cylinder so that every of n possible cylinder\'s shifts is equiprobable. Then the game starts, the players take turns, Sasha starts: he puts the gun to his head and shoots. If there was no bullet in front of the trigger, the cylinder shifts by one position and the weapon is given to Roma for make the same move. The game continues until someone is shot, the survivor is the winner. Sasha does not want to lose, so he must choose slots for bullets in such a way as to minimize the probability of its own loss. Of all the possible variant he wants to select the lexicographically minimal one, where an empty slot is lexicographically less than a charged one. More formally, the cylinder of n bullet slots able to contain k bullets can be represented as a string of n characters. Exactly k of them are ""X"" (charged slots) and the others are ""."" (uncharged slots). Let us describe the process of a shot. Suppose that the trigger is in front of the first character of the string (the first slot). If a shot doesn\'t kill anyone and the cylinder shifts, then the string shifts left. So the first character becomes the last one, the second character becomes the first one, and so on. But the trigger doesn\'t move. It will be in front of the first character of the resulting string.Among all the strings that give the minimal probability of loss, Sasha choose the lexicographically minimal one. According to this very string, he charges the gun. You have to help Sasha to charge the gun. For that, each xi query must be answered: is there a bullet in the positions xi?" 1800

100E "Lamps in a Line" "*special problem,math" "After all the events in Orlando we all know, Sasha and Roma decided to find out who is still the team\'s biggest loser. Thankfully, Masha found somewhere a revolver with a rotating cylinder of n bullet slots able to contain exactly k bullets, now the boys have a chance to resolve the problem once and for all. Sasha selects any k out of n slots he wishes and puts bullets there. Roma spins the cylinder so that every of n possible cylinder\'s shifts is equiprobable. Then the game starts, the players take turns, Sasha starts: he puts the gun to his head and shoots. If there was no bullet in front of the trigger, the cylinder shifts by one position and the weapon is given to Roma for make the same move. The game continues until someone is shot, the survivor is the winner. Sasha does not want to lose, so he must choose slots for bullets in such a way as to minimize the probability of its own loss. Of all the possible variant he wants to select the lexicographically minimal one, where an empty slot is lexicographically less than a charged one. More formally, the cylinder of n bullet slots able to contain k bullets can be represented as a string of n characters. Exactly k of them are ""X"" (charged slots) and the others are ""."" (uncharged slots). Let us describe the process of a shot. Suppose that the trigger is in front of the first character of the string (the first slot). If a shot doesn\'t kill anyone and the cylinder shifts, then the string shifts left. So the first character becomes the last one, the second character becomes the first one, and so on. But the trigger doesn\'t move. It will be in front of the first character of the resulting string.Among all the strings that give the minimal probability of loss, Sasha choose the lexicographically minimal one. According to this very string, he charges the gun. You have to help Sasha to charge the gun. For that, each xi query must be answered: is there a bullet in the positions xi?" 1600

100D "World of Mouth" "*special problem,strings" "After all the events in Orlando we all know, Sasha and Roma decided to find out who is still the team\'s biggest loser. Thankfully, Masha found somewhere a revolver with a rotating cylinder of n bullet slots able to contain exactly k bullets, now the boys have a chance to resolve the problem once and for all. Sasha selects any k out of n slots he wishes and puts bullets there. Roma spins the cylinder so that every of n possible cylinder\'s shifts is equiprobable. Then the game starts, the players take turns, Sasha starts: he puts the gun to his head and shoots. If there was no bullet in front of the trigger, the cylinder shifts by one position and the weapon is given to Roma for make the same move. The game continues until someone is shot, the survivor is the winner. Sasha does not want to lose, so he must choose slots for bullets in such a way as to minimize the probability of its own loss. Of all the possible variant he wants to select the lexicographically minimal one, where an empty slot is lexicographically less than a charged one. More formally, the cylinder of n bullet slots able to contain k bullets can be represented as a string of n characters. Exactly k of them are ""X"" (charged slots) and the others are ""."" (uncharged slots). Let us describe the process of a shot. Suppose that the trigger is in front of the first character of the string (the first slot). If a shot doesn\'t kill anyone and the cylinder shifts, then the string shifts left. So the first character becomes the last one, the second character becomes the first one, and so on. But the trigger doesn\'t move. It will be in front of the first character of the resulting string.Among all the strings that give the minimal probability of loss, Sasha choose the lexicographically minimal one. According to this very string, he charges the gun. You have to help Sasha to charge the gun. For that, each xi query must be answered: is there a bullet in the positions xi?" 1500

100C A+B "*special problem,implementation" "After all the events in Orlando we all know, Sasha and Roma decided to find out who is still the team\'s biggest loser. Thankfully, Masha found somewhere a revolver with a rotating cylinder of n bullet slots able to contain exactly k bullets, now the boys have a chance to resolve the problem once and for all. Sasha selects any k out of n slots he wishes and puts bullets there. Roma spins the cylinder so that every of n possible cylinder\'s shifts is equiprobable. Then the game starts, the players take turns, Sasha starts: he puts the gun to his head and shoots. If there was no bullet in front of the trigger, the cylinder shifts by one position and the weapon is given to Roma for make the same move. The game continues until someone is shot, the survivor is the winner. Sasha does not want to lose, so he must choose slots for bullets in such a way as to minimize the probability of its own loss. Of all the possible variant he wants to select the lexicographically minimal one, where an empty slot is lexicographically less than a charged one. More formally, the cylinder of n bullet slots able to contain k bullets can be represented as a string of n characters. Exactly k of them are ""X"" (charged slots) and the others are ""."" (uncharged slots). Let us describe the process of a shot. Suppose that the trigger is in front of the first character of the string (the first slot). If a shot doesn\'t kill anyone and the cylinder shifts, then the string shifts left. So the first character becomes the last one, the second character becomes the first one, and so on. But the trigger doesn\'t move. It will be in front of the first character of the resulting string.Among all the strings that give the minimal probability of loss, Sasha choose the lexicographically minimal one. According to this very string, he charges the gun. You have to help Sasha to charge the gun. For that, each xi query must be answered: is there a bullet in the positions xi?" 1400

100B "Friendly Numbers" "*special problem,implementation" "After all the events in Orlando we all know, Sasha and Roma decided to find out who is still the team\'s biggest loser. Thankfully, Masha found somewhere a revolver with a rotating cylinder of n bullet slots able to contain exactly k bullets, now the boys have a chance to resolve the problem once and for all. Sasha selects any k out of n slots he wishes and puts bullets there. Roma spins the cylinder so that every of n possible cylinder\'s shifts is equiprobable. Then the game starts, the players take turns, Sasha starts: he puts the gun to his head and shoots. If there was no bullet in front of the trigger, the cylinder shifts by one position and the weapon is given to Roma for make the same move. The game continues until someone is shot, the survivor is the winner. Sasha does not want to lose, so he must choose slots for bullets in such a way as to minimize the probability of its own loss. Of all the possible variant he wants to select the lexicographically minimal one, where an empty slot is lexicographically less than a charged one. More formally, the cylinder of n bullet slots able to contain k bullets can be represented as a string of n characters. Exactly k of them are ""X"" (charged slots) and the others are ""."" (uncharged slots). Let us describe the process of a shot. Suppose that the trigger is in front of the first character of the string (the first slot). If a shot doesn\'t kill anyone and the cylinder shifts, then the string shifts left. So the first character becomes the last one, the second character becomes the first one, and so on. But the trigger doesn\'t move. It will be in front of the first character of the resulting string.Among all the strings that give the minimal probability of loss, Sasha choose the lexicographically minimal one. According to this very string, he charges the gun. You have to help Sasha to charge the gun. For that, each xi query must be answered: is there a bullet in the positions xi?" 1500

100A "Carpeting the Room" "*special problem,implementation" "After all the events in Orlando we all know, Sasha and Roma decided to find out who is still the team\'s biggest loser. Thankfully, Masha found somewhere a revolver with a rotating cylinder of n bullet slots able to contain exactly k bullets, now the boys have a chance to resolve the problem once and for all. Sasha selects any k out of n slots he wishes and puts bullets there. Roma spins the cylinder so that every of n possible cylinder\'s shifts is equiprobable. Then the game starts, the players take turns, Sasha starts: he puts the gun to his head and shoots. If there was no bullet in front of the trigger, the cylinder shifts by one position and the weapon is given to Roma for make the same move. The game continues until someone is shot, the survivor is the winner. Sasha does not want to lose, so he must choose slots for bullets in such a way as to minimize the probability of its own loss. Of all the possible variant he wants to select the lexicographically minimal one, where an empty slot is lexicographically less than a charged one. More formally, the cylinder of n bullet slots able to contain k bullets can be represented as a string of n characters. Exactly k of them are ""X"" (charged slots) and the others are ""."" (uncharged slots). Let us describe the process of a shot. Suppose that the trigger is in front of the first character of the string (the first slot). If a shot doesn\'t kill anyone and the cylinder shifts, then the string shifts left. So the first character becomes the last one, the second character becomes the first one, and so on. But the trigger doesn\'t move. It will be in front of the first character of the resulting string.Among all the strings that give the minimal probability of loss, Sasha choose the lexicographically minimal one. According to this very string, he charges the gun. You have to help Sasha to charge the gun. For that, each xi query must be answered: is there a bullet in the positions xi?" 1100

99B "Help Chef Gerasim" implementation,sortings "After all the events in Orlando we all know, Sasha and Roma decided to find out who is still the team\'s biggest loser. Thankfully, Masha found somewhere a revolver with a rotating cylinder of n bullet slots able to contain exactly k bullets, now the boys have a chance to resolve the problem once and for all. Sasha selects any k out of n slots he wishes and puts bullets there. Roma spins the cylinder so that every of n possible cylinder\'s shifts is equiprobable. Then the game starts, the players take turns, Sasha starts: he puts the gun to his head and shoots. If there was no bullet in front of the trigger, the cylinder shifts by one position and the weapon is given to Roma for make the same move. The game continues until someone is shot, the survivor is the winner. Sasha does not want to lose, so he must choose slots for bullets in such a way as to minimize the probability of its own loss. Of all the possible variant he wants to select the lexicographically minimal one, where an empty slot is lexicographically less than a charged one. More formally, the cylinder of n bullet slots able to contain k bullets can be represented as a string of n characters. Exactly k of them are ""X"" (charged slots) and the others are ""."" (uncharged slots). Let us describe the process of a shot. Suppose that the trigger is in front of the first character of the string (the first slot). If a shot doesn\'t kill anyone and the cylinder shifts, then the string shifts left. So the first character becomes the last one, the second character becomes the first one, and so on. But the trigger doesn\'t move. It will be in front of the first character of the resulting string.Among all the strings that give the minimal probability of loss, Sasha choose the lexicographically minimal one. According to this very string, he charges the gun. You have to help Sasha to charge the gun. For that, each xi query must be answered: is there a bullet in the positions xi?" 1300

99A "Help Far Away Kingdom" strings "After all the events in Orlando we all know, Sasha and Roma decided to find out who is still the team\'s biggest loser. Thankfully, Masha found somewhere a revolver with a rotating cylinder of n bullet slots able to contain exactly k bullets, now the boys have a chance to resolve the problem once and for all. Sasha selects any k out of n slots he wishes and puts bullets there. Roma spins the cylinder so that every of n possible cylinder\'s shifts is equiprobable. Then the game starts, the players take turns, Sasha starts: he puts the gun to his head and shoots. If there was no bullet in front of the trigger, the cylinder shifts by one position and the weapon is given to Roma for make the same move. The game continues until someone is shot, the survivor is the winner. Sasha does not want to lose, so he must choose slots for bullets in such a way as to minimize the probability of its own loss. Of all the possible variant he wants to select the lexicographically minimal one, where an empty slot is lexicographically less than a charged one. More formally, the cylinder of n bullet slots able to contain k bullets can be represented as a string of n characters. Exactly k of them are ""X"" (charged slots) and the others are ""."" (uncharged slots). Let us describe the process of a shot. Suppose that the trigger is in front of the first character of the string (the first slot). If a shot doesn\'t kill anyone and the cylinder shifts, then the string shifts left. So the first character becomes the last one, the second character becomes the first one, and so on. But the trigger doesn\'t move. It will be in front of the first character of the resulting string.Among all the strings that give the minimal probability of loss, Sasha choose the lexicographically minimal one. According to this very string, he charges the gun. You have to help Sasha to charge the gun. For that, each xi query must be answered: is there a bullet in the positions xi?" 800

98E "Help Shrek and Donkey" dp,games,math,probabilities "After all the events in Orlando we all know, Sasha and Roma decided to find out who is still the team\'s biggest loser. Thankfully, Masha found somewhere a revolver with a rotating cylinder of n bullet slots able to contain exactly k bullets, now the boys have a chance to resolve the problem once and for all. Sasha selects any k out of n slots he wishes and puts bullets there. Roma spins the cylinder so that every of n possible cylinder\'s shifts is equiprobable. Then the game starts, the players take turns, Sasha starts: he puts the gun to his head and shoots. If there was no bullet in front of the trigger, the cylinder shifts by one position and the weapon is given to Roma for make the same move. The game continues until someone is shot, the survivor is the winner. Sasha does not want to lose, so he must choose slots for bullets in such a way as to minimize the probability of its own loss. Of all the possible variant he wants to select the lexicographically minimal one, where an empty slot is lexicographically less than a charged one. More formally, the cylinder of n bullet slots able to contain k bullets can be represented as a string of n characters. Exactly k of them are ""X"" (charged slots) and the others are ""."" (uncharged slots). Let us describe the process of a shot. Suppose that the trigger is in front of the first character of the string (the first slot). If a shot doesn\'t kill anyone and the cylinder shifts, then the string shifts left. So the first character becomes the last one, the second character becomes the first one, and so on. But the trigger doesn\'t move. It will be in front of the first character of the resulting string.Among all the strings that give the minimal probability of loss, Sasha choose the lexicographically minimal one. According to this very string, he charges the gun. You have to help Sasha to charge the gun. For that, each xi query must be answered: is there a bullet in the positions xi?" 2700

98D "Help Monks" "constructive algorithms" "After all the events in Orlando we all know, Sasha and Roma decided to find out who is still the team\'s biggest loser. Thankfully, Masha found somewhere a revolver with a rotating cylinder of n bullet slots able to contain exactly k bullets, now the boys have a chance to resolve the problem once and for all. Sasha selects any k out of n slots he wishes and puts bullets there. Roma spins the cylinder so that every of n possible cylinder\'s shifts is equiprobable. Then the game starts, the players take turns, Sasha starts: he puts the gun to his head and shoots. If there was no bullet in front of the trigger, the cylinder shifts by one position and the weapon is given to Roma for make the same move. The game continues until someone is shot, the survivor is the winner. Sasha does not want to lose, so he must choose slots for bullets in such a way as to minimize the probability of its own loss. Of all the possible variant he wants to select the lexicographically minimal one, where an empty slot is lexicographically less than a charged one. More formally, the cylinder of n bullet slots able to contain k bullets can be represented as a string of n characters. Exactly k of them are ""X"" (charged slots) and the others are ""."" (uncharged slots). Let us describe the process of a shot. Suppose that the trigger is in front of the first character of the string (the first slot). If a shot doesn\'t kill anyone and the cylinder shifts, then the string shifts left. So the first character becomes the last one, the second character becomes the first one, and so on. But the trigger doesn\'t move. It will be in front of the first character of the resulting string.Among all the strings that give the minimal probability of loss, Sasha choose the lexicographically minimal one. According to this very string, he charges the gun. You have to help Sasha to charge the gun. For that, each xi query must be answered: is there a bullet in the positions xi?" 2500

98C "Help Greg the Dwarf" "geometry,ternary search" "After all the events in Orlando we all know, Sasha and Roma decided to find out who is still the team\'s biggest loser. Thankfully, Masha found somewhere a revolver with a rotating cylinder of n bullet slots able to contain exactly k bullets, now the boys have a chance to resolve the problem once and for all. Sasha selects any k out of n slots he wishes and puts bullets there. Roma spins the cylinder so that every of n possible cylinder\'s shifts is equiprobable. Then the game starts, the players take turns, Sasha starts: he puts the gun to his head and shoots. If there was no bullet in front of the trigger, the cylinder shifts by one position and the weapon is given to Roma for make the same move. The game continues until someone is shot, the survivor is the winner. Sasha does not want to lose, so he must choose slots for bullets in such a way as to minimize the probability of its own loss. Of all the possible variant he wants to select the lexicographically minimal one, where an empty slot is lexicographically less than a charged one. More formally, the cylinder of n bullet slots able to contain k bullets can be represented as a string of n characters. Exactly k of them are ""X"" (charged slots) and the others are ""."" (uncharged slots). Let us describe the process of a shot. Suppose that the trigger is in front of the first character of the string (the first slot). If a shot doesn\'t kill anyone and the cylinder shifts, then the string shifts left. So the first character becomes the last one, the second character becomes the first one, and so on. But the trigger doesn\'t move. It will be in front of the first character of the resulting string.Among all the strings that give the minimal probability of loss, Sasha choose the lexicographically minimal one. According to this very string, he charges the gun. You have to help Sasha to charge the gun. For that, each xi query must be answered: is there a bullet in the positions xi?" 2500

98B "Help King" implementation,probabilities,trees "After all the events in Orlando we all know, Sasha and Roma decided to find out who is still the team\'s biggest loser. Thankfully, Masha found somewhere a revolver with a rotating cylinder of n bullet slots able to contain exactly k bullets, now the boys have a chance to resolve the problem once and for all. Sasha selects any k out of n slots he wishes and puts bullets there. Roma spins the cylinder so that every of n possible cylinder\'s shifts is equiprobable. Then the game starts, the players take turns, Sasha starts: he puts the gun to his head and shoots. If there was no bullet in front of the trigger, the cylinder shifts by one position and the weapon is given to Roma for make the same move. The game continues until someone is shot, the survivor is the winner. Sasha does not want to lose, so he must choose slots for bullets in such a way as to minimize the probability of its own loss. Of all the possible variant he wants to select the lexicographically minimal one, where an empty slot is lexicographically less than a charged one. More formally, the cylinder of n bullet slots able to contain k bullets can be represented as a string of n characters. Exactly k of them are ""X"" (charged slots) and the others are ""."" (uncharged slots). Let us describe the process of a shot. Suppose that the trigger is in front of the first character of the string (the first slot). If a shot doesn\'t kill anyone and the cylinder shifts, then the string shifts left. So the first character becomes the last one, the second character becomes the first one, and so on. But the trigger doesn\'t move. It will be in front of the first character of the resulting string.Among all the strings that give the minimal probability of loss, Sasha choose the lexicographically minimal one. According to this very string, he charges the gun. You have to help Sasha to charge the gun. For that, each xi query must be answered: is there a bullet in the positions xi?" 2200

98A "Help Victoria the Wise" "brute force,implementation" "After all the events in Orlando we all know, Sasha and Roma decided to find out who is still the team\'s biggest loser. Thankfully, Masha found somewhere a revolver with a rotating cylinder of n bullet slots able to contain exactly k bullets, now the boys have a chance to resolve the problem once and for all. Sasha selects any k out of n slots he wishes and puts bullets there. Roma spins the cylinder so that every of n possible cylinder\'s shifts is equiprobable. Then the game starts, the players take turns, Sasha starts: he puts the gun to his head and shoots. If there was no bullet in front of the trigger, the cylinder shifts by one position and the weapon is given to Roma for make the same move. The game continues until someone is shot, the survivor is the winner. Sasha does not want to lose, so he must choose slots for bullets in such a way as to minimize the probability of its own loss. Of all the possible variant he wants to select the lexicographically minimal one, where an empty slot is lexicographically less than a charged one. More formally, the cylinder of n bullet slots able to contain k bullets can be represented as a string of n characters. Exactly k of them are ""X"" (charged slots) and the others are ""."" (uncharged slots). Let us describe the process of a shot. Suppose that the trigger is in front of the first character of the string (the first slot). If a shot doesn\'t kill anyone and the cylinder shifts, then the string shifts left. So the first character becomes the last one, the second character becomes the first one, and so on. But the trigger doesn\'t move. It will be in front of the first character of the resulting string.Among all the strings that give the minimal probability of loss, Sasha choose the lexicographically minimal one. According to this very string, he charges the gun. You have to help Sasha to charge the gun. For that, each xi query must be answered: is there a bullet in the positions xi?" 1700

97E Leaders "dfs and similar,dsu,graphs,trees" "After all the events in Orlando we all know, Sasha and Roma decided to find out who is still the team\'s biggest loser. Thankfully, Masha found somewhere a revolver with a rotating cylinder of n bullet slots able to contain exactly k bullets, now the boys have a chance to resolve the problem once and for all. Sasha selects any k out of n slots he wishes and puts bullets there. Roma spins the cylinder so that every of n possible cylinder\'s shifts is equiprobable. Then the game starts, the players take turns, Sasha starts: he puts the gun to his head and shoots. If there was no bullet in front of the trigger, the cylinder shifts by one position and the weapon is given to Roma for make the same move. The game continues until someone is shot, the survivor is the winner. Sasha does not want to lose, so he must choose slots for bullets in such a way as to minimize the probability of its own loss. Of all the possible variant he wants to select the lexicographically minimal one, where an empty slot is lexicographically less than a charged one. More formally, the cylinder of n bullet slots able to contain k bullets can be represented as a string of n characters. Exactly k of them are ""X"" (charged slots) and the others are ""."" (uncharged slots). Let us describe the process of a shot. Suppose that the trigger is in front of the first character of the string (the first slot). If a shot doesn\'t kill anyone and the cylinder shifts, then the string shifts left. So the first character becomes the last one, the second character becomes the first one, and so on. But the trigger doesn\'t move. It will be in front of the first character of the resulting string.Among all the strings that give the minimal probability of loss, Sasha choose the lexicographically minimal one. According to this very string, he charges the gun. You have to help Sasha to charge the gun. For that, each xi query must be answered: is there a bullet in the positions xi?" 2200

97D "Robot in Basement" "bitmasks,brute force,implementation" "After all the events in Orlando we all know, Sasha and Roma decided to find out who is still the team\'s biggest loser. Thankfully, Masha found somewhere a revolver with a rotating cylinder of n bullet slots able to contain exactly k bullets, now the boys have a chance to resolve the problem once and for all. Sasha selects any k out of n slots he wishes and puts bullets there. Roma spins the cylinder so that every of n possible cylinder\'s shifts is equiprobable. Then the game starts, the players take turns, Sasha starts: he puts the gun to his head and shoots. If there was no bullet in front of the trigger, the cylinder shifts by one position and the weapon is given to Roma for make the same move. The game continues until someone is shot, the survivor is the winner. Sasha does not want to lose, so he must choose slots for bullets in such a way as to minimize the probability of its own loss. Of all the possible variant he wants to select the lexicographically minimal one, where an empty slot is lexicographically less than a charged one. More formally, the cylinder of n bullet slots able to contain k bullets can be represented as a string of n characters. Exactly k of them are ""X"" (charged slots) and the others are ""."" (uncharged slots). Let us describe the process of a shot. Suppose that the trigger is in front of the first character of the string (the first slot). If a shot doesn\'t kill anyone and the cylinder shifts, then the string shifts left. So the first character becomes the last one, the second character becomes the first one, and so on. But the trigger doesn\'t move. It will be in front of the first character of the resulting string.Among all the strings that give the minimal probability of loss, Sasha choose the lexicographically minimal one. According to this very string, he charges the gun. You have to help Sasha to charge the gun. For that, each xi query must be answered: is there a bullet in the positions xi?" 2700

97C "Winning Strategy" "binary search,graphs,math,shortest paths" "After all the events in Orlando we all know, Sasha and Roma decided to find out who is still the team\'s biggest loser. Thankfully, Masha found somewhere a revolver with a rotating cylinder of n bullet slots able to contain exactly k bullets, now the boys have a chance to resolve the problem once and for all. Sasha selects any k out of n slots he wishes and puts bullets there. Roma spins the cylinder so that every of n possible cylinder\'s shifts is equiprobable. Then the game starts, the players take turns, Sasha starts: he puts the gun to his head and shoots. If there was no bullet in front of the trigger, the cylinder shifts by one position and the weapon is given to Roma for make the same move. The game continues until someone is shot, the survivor is the winner. Sasha does not want to lose, so he must choose slots for bullets in such a way as to minimize the probability of its own loss. Of all the possible variant he wants to select the lexicographically minimal one, where an empty slot is lexicographically less than a charged one. More formally, the cylinder of n bullet slots able to contain k bullets can be represented as a string of n characters. Exactly k of them are ""X"" (charged slots) and the others are ""."" (uncharged slots). Let us describe the process of a shot. Suppose that the trigger is in front of the first character of the string (the first slot). If a shot doesn\'t kill anyone and the cylinder shifts, then the string shifts left. So the first character becomes the last one, the second character becomes the first one, and so on. But the trigger doesn\'t move. It will be in front of the first character of the resulting string.Among all the strings that give the minimal probability of loss, Sasha choose the lexicographically minimal one. According to this very string, he charges the gun. You have to help Sasha to charge the gun. For that, each xi query must be answered: is there a bullet in the positions xi?" 2400

97B Superset "constructive algorithms,divide and conquer" "After all the events in Orlando we all know, Sasha and Roma decided to find out who is still the team\'s biggest loser. Thankfully, Masha found somewhere a revolver with a rotating cylinder of n bullet slots able to contain exactly k bullets, now the boys have a chance to resolve the problem once and for all. Sasha selects any k out of n slots he wishes and puts bullets there. Roma spins the cylinder so that every of n possible cylinder\'s shifts is equiprobable. Then the game starts, the players take turns, Sasha starts: he puts the gun to his head and shoots. If there was no bullet in front of the trigger, the cylinder shifts by one position and the weapon is given to Roma for make the same move. The game continues until someone is shot, the survivor is the winner. Sasha does not want to lose, so he must choose slots for bullets in such a way as to minimize the probability of its own loss. Of all the possible variant he wants to select the lexicographically minimal one, where an empty slot is lexicographically less than a charged one. More formally, the cylinder of n bullet slots able to contain k bullets can be represented as a string of n characters. Exactly k of them are ""X"" (charged slots) and the others are ""."" (uncharged slots). Let us describe the process of a shot. Suppose that the trigger is in front of the first character of the string (the first slot). If a shot doesn\'t kill anyone and the cylinder shifts, then the string shifts left. So the first character becomes the last one, the second character becomes the first one, and so on. But the trigger doesn\'t move. It will be in front of the first character of the resulting string.Among all the strings that give the minimal probability of loss, Sasha choose the lexicographically minimal one. According to this very string, he charges the gun. You have to help Sasha to charge the gun. For that, each xi query must be answered: is there a bullet in the positions xi?" 2300

97A Domino "brute force,implementation" "After all the events in Orlando we all know, Sasha and Roma decided to find out who is still the team\'s biggest loser. Thankfully, Masha found somewhere a revolver with a rotating cylinder of n bullet slots able to contain exactly k bullets, now the boys have a chance to resolve the problem once and for all. Sasha selects any k out of n slots he wishes and puts bullets there. Roma spins the cylinder so that every of n possible cylinder\'s shifts is equiprobable. Then the game starts, the players take turns, Sasha starts: he puts the gun to his head and shoots. If there was no bullet in front of the trigger, the cylinder shifts by one position and the weapon is given to Roma for make the same move. The game continues until someone is shot, the survivor is the winner. Sasha does not want to lose, so he must choose slots for bullets in such a way as to minimize the probability of its own loss. Of all the possible variant he wants to select the lexicographically minimal one, where an empty slot is lexicographically less than a charged one. More formally, the cylinder of n bullet slots able to contain k bullets can be represented as a string of n characters. Exactly k of them are ""X"" (charged slots) and the others are ""."" (uncharged slots). Let us describe the process of a shot. Suppose that the trigger is in front of the first character of the string (the first slot). If a shot doesn\'t kill anyone and the cylinder shifts, then the string shifts left. So the first character becomes the last one, the second character becomes the first one, and so on. But the trigger doesn\'t move. It will be in front of the first character of the resulting string.Among all the strings that give the minimal probability of loss, Sasha choose the lexicographically minimal one. According to this very string, he charges the gun. You have to help Sasha to charge the gun. For that, each xi query must be answered: is there a bullet in the positions xi?" 2400

96B "Lucky Numbers (easy)" "binary search,bitmasks,brute force" "After all the events in Orlando we all know, Sasha and Roma decided to find out who is still the team\'s biggest loser. Thankfully, Masha found somewhere a revolver with a rotating cylinder of n bullet slots able to contain exactly k bullets, now the boys have a chance to resolve the problem once and for all. Sasha selects any k out of n slots he wishes and puts bullets there. Roma spins the cylinder so that every of n possible cylinder\'s shifts is equiprobable. Then the game starts, the players take turns, Sasha starts: he puts the gun to his head and shoots. If there was no bullet in front of the trigger, the cylinder shifts by one position and the weapon is given to Roma for make the same move. The game continues until someone is shot, the survivor is the winner. Sasha does not want to lose, so he must choose slots for bullets in such a way as to minimize the probability of its own loss. Of all the possible variant he wants to select the lexicographically minimal one, where an empty slot is lexicographically less than a charged one. More formally, the cylinder of n bullet slots able to contain k bullets can be represented as a string of n characters. Exactly k of them are ""X"" (charged slots) and the others are ""."" (uncharged slots). Let us describe the process of a shot. Suppose that the trigger is in front of the first character of the string (the first slot). If a shot doesn\'t kill anyone and the cylinder shifts, then the string shifts left. So the first character becomes the last one, the second character becomes the first one, and so on. But the trigger doesn\'t move. It will be in front of the first character of the resulting string.Among all the strings that give the minimal probability of loss, Sasha choose the lexicographically minimal one. According to this very string, he charges the gun. You have to help Sasha to charge the gun. For that, each xi query must be answered: is there a bullet in the positions xi?" 1300

96A Football implementation,strings "After all the events in Orlando we all know, Sasha and Roma decided to find out who is still the team\'s biggest loser. Thankfully, Masha found somewhere a revolver with a rotating cylinder of n bullet slots able to contain exactly k bullets, now the boys have a chance to resolve the problem once and for all. Sasha selects any k out of n slots he wishes and puts bullets there. Roma spins the cylinder so that every of n possible cylinder\'s shifts is equiprobable. Then the game starts, the players take turns, Sasha starts: he puts the gun to his head and shoots. If there was no bullet in front of the trigger, the cylinder shifts by one position and the weapon is given to Roma for make the same move. The game continues until someone is shot, the survivor is the winner. Sasha does not want to lose, so he must choose slots for bullets in such a way as to minimize the probability of its own loss. Of all the possible variant he wants to select the lexicographically minimal one, where an empty slot is lexicographically less than a charged one. More formally, the cylinder of n bullet slots able to contain k bullets can be represented as a string of n characters. Exactly k of them are ""X"" (charged slots) and the others are ""."" (uncharged slots). Let us describe the process of a shot. Suppose that the trigger is in front of the first character of the string (the first slot). If a shot doesn\'t kill anyone and the cylinder shifts, then the string shifts left. So the first character becomes the last one, the second character becomes the first one, and so on. But the trigger doesn\'t move. It will be in front of the first character of the resulting string.Among all the strings that give the minimal probability of loss, Sasha choose the lexicographically minimal one. According to this very string, he charges the gun. You have to help Sasha to charge the gun. For that, each xi query must be answered: is there a bullet in the positions xi?" 900

95E "Lucky Country" dp,dsu,graphs "After all the events in Orlando we all know, Sasha and Roma decided to find out who is still the team\'s biggest loser. Thankfully, Masha found somewhere a revolver with a rotating cylinder of n bullet slots able to contain exactly k bullets, now the boys have a chance to resolve the problem once and for all. Sasha selects any k out of n slots he wishes and puts bullets there. Roma spins the cylinder so that every of n possible cylinder\'s shifts is equiprobable. Then the game starts, the players take turns, Sasha starts: he puts the gun to his head and shoots. If there was no bullet in front of the trigger, the cylinder shifts by one position and the weapon is given to Roma for make the same move. The game continues until someone is shot, the survivor is the winner. Sasha does not want to lose, so he must choose slots for bullets in such a way as to minimize the probability of its own loss. Of all the possible variant he wants to select the lexicographically minimal one, where an empty slot is lexicographically less than a charged one. More formally, the cylinder of n bullet slots able to contain k bullets can be represented as a string of n characters. Exactly k of them are ""X"" (charged slots) and the others are ""."" (uncharged slots). Let us describe the process of a shot. Suppose that the trigger is in front of the first character of the string (the first slot). If a shot doesn\'t kill anyone and the cylinder shifts, then the string shifts left. So the first character becomes the last one, the second character becomes the first one, and so on. But the trigger doesn\'t move. It will be in front of the first character of the resulting string.Among all the strings that give the minimal probability of loss, Sasha choose the lexicographically minimal one. According to this very string, he charges the gun. You have to help Sasha to charge the gun. For that, each xi query must be answered: is there a bullet in the positions xi?" 2500

95D "Horse Races" dp,math "After all the events in Orlando we all know, Sasha and Roma decided to find out who is still the team\'s biggest loser. Thankfully, Masha found somewhere a revolver with a rotating cylinder of n bullet slots able to contain exactly k bullets, now the boys have a chance to resolve the problem once and for all. Sasha selects any k out of n slots he wishes and puts bullets there. Roma spins the cylinder so that every of n possible cylinder\'s shifts is equiprobable. Then the game starts, the players take turns, Sasha starts: he puts the gun to his head and shoots. If there was no bullet in front of the trigger, the cylinder shifts by one position and the weapon is given to Roma for make the same move. The game continues until someone is shot, the survivor is the winner. Sasha does not want to lose, so he must choose slots for bullets in such a way as to minimize the probability of its own loss. Of all the possible variant he wants to select the lexicographically minimal one, where an empty slot is lexicographically less than a charged one. More formally, the cylinder of n bullet slots able to contain k bullets can be represented as a string of n characters. Exactly k of them are ""X"" (charged slots) and the others are ""."" (uncharged slots). Let us describe the process of a shot. Suppose that the trigger is in front of the first character of the string (the first slot). If a shot doesn\'t kill anyone and the cylinder shifts, then the string shifts left. So the first character becomes the last one, the second character becomes the first one, and so on. But the trigger doesn\'t move. It will be in front of the first character of the resulting string.Among all the strings that give the minimal probability of loss, Sasha choose the lexicographically minimal one. According to this very string, he charges the gun. You have to help Sasha to charge the gun. For that, each xi query must be answered: is there a bullet in the positions xi?" 2500

95C Volleyball "shortest paths" "After all the events in Orlando we all know, Sasha and Roma decided to find out who is still the team\'s biggest loser. Thankfully, Masha found somewhere a revolver with a rotating cylinder of n bullet slots able to contain exactly k bullets, now the boys have a chance to resolve the problem once and for all. Sasha selects any k out of n slots he wishes and puts bullets there. Roma spins the cylinder so that every of n possible cylinder\'s shifts is equiprobable. Then the game starts, the players take turns, Sasha starts: he puts the gun to his head and shoots. If there was no bullet in front of the trigger, the cylinder shifts by one position and the weapon is given to Roma for make the same move. The game continues until someone is shot, the survivor is the winner. Sasha does not want to lose, so he must choose slots for bullets in such a way as to minimize the probability of its own loss. Of all the possible variant he wants to select the lexicographically minimal one, where an empty slot is lexicographically less than a charged one. More formally, the cylinder of n bullet slots able to contain k bullets can be represented as a string of n characters. Exactly k of them are ""X"" (charged slots) and the others are ""."" (uncharged slots). Let us describe the process of a shot. Suppose that the trigger is in front of the first character of the string (the first slot). If a shot doesn\'t kill anyone and the cylinder shifts, then the string shifts left. So the first character becomes the last one, the second character becomes the first one, and so on. But the trigger doesn\'t move. It will be in front of the first character of the resulting string.Among all the strings that give the minimal probability of loss, Sasha choose the lexicographically minimal one. According to this very string, he charges the gun. You have to help Sasha to charge the gun. For that, each xi query must be answered: is there a bullet in the positions xi?" 1900

95B "Lucky Numbers" dp,greedy "After all the events in Orlando we all know, Sasha and Roma decided to find out who is still the team\'s biggest loser. Thankfully, Masha found somewhere a revolver with a rotating cylinder of n bullet slots able to contain exactly k bullets, now the boys have a chance to resolve the problem once and for all. Sasha selects any k out of n slots he wishes and puts bullets there. Roma spins the cylinder so that every of n possible cylinder\'s shifts is equiprobable. Then the game starts, the players take turns, Sasha starts: he puts the gun to his head and shoots. If there was no bullet in front of the trigger, the cylinder shifts by one position and the weapon is given to Roma for make the same move. The game continues until someone is shot, the survivor is the winner. Sasha does not want to lose, so he must choose slots for bullets in such a way as to minimize the probability of its own loss. Of all the possible variant he wants to select the lexicographically minimal one, where an empty slot is lexicographically less than a charged one. More formally, the cylinder of n bullet slots able to contain k bullets can be represented as a string of n characters. Exactly k of them are ""X"" (charged slots) and the others are ""."" (uncharged slots). Let us describe the process of a shot. Suppose that the trigger is in front of the first character of the string (the first slot). If a shot doesn\'t kill anyone and the cylinder shifts, then the string shifts left. So the first character becomes the last one, the second character becomes the first one, and so on. But the trigger doesn\'t move. It will be in front of the first character of the resulting string.Among all the strings that give the minimal probability of loss, Sasha choose the lexicographically minimal one. According to this very string, he charges the gun. You have to help Sasha to charge the gun. For that, each xi query must be answered: is there a bullet in the positions xi?" 1800

95A Hockey implementation,strings "After all the events in Orlando we all know, Sasha and Roma decided to find out who is still the team\'s biggest loser. Thankfully, Masha found somewhere a revolver with a rotating cylinder of n bullet slots able to contain exactly k bullets, now the boys have a chance to resolve the problem once and for all. Sasha selects any k out of n slots he wishes and puts bullets there. Roma spins the cylinder so that every of n possible cylinder\'s shifts is equiprobable. Then the game starts, the players take turns, Sasha starts: he puts the gun to his head and shoots. If there was no bullet in front of the trigger, the cylinder shifts by one position and the weapon is given to Roma for make the same move. The game continues until someone is shot, the survivor is the winner. Sasha does not want to lose, so he must choose slots for bullets in such a way as to minimize the probability of its own loss. Of all the possible variant he wants to select the lexicographically minimal one, where an empty slot is lexicographically less than a charged one. More formally, the cylinder of n bullet slots able to contain k bullets can be represented as a string of n characters. Exactly k of them are ""X"" (charged slots) and the others are ""."" (uncharged slots). Let us describe the process of a shot. Suppose that the trigger is in front of the first character of the string (the first slot). If a shot doesn\'t kill anyone and the cylinder shifts, then the string shifts left. So the first character becomes the last one, the second character becomes the first one, and so on. But the trigger doesn\'t move. It will be in front of the first character of the resulting string.Among all the strings that give the minimal probability of loss, Sasha choose the lexicographically minimal one. According to this very string, he charges the gun. You have to help Sasha to charge the gun. For that, each xi query must be answered: is there a bullet in the positions xi?" 1600

94B Friends graphs,implementation,math "After all the events in Orlando we all know, Sasha and Roma decided to find out who is still the team\'s biggest loser. Thankfully, Masha found somewhere a revolver with a rotating cylinder of n bullet slots able to contain exactly k bullets, now the boys have a chance to resolve the problem once and for all. Sasha selects any k out of n slots he wishes and puts bullets there. Roma spins the cylinder so that every of n possible cylinder\'s shifts is equiprobable. Then the game starts, the players take turns, Sasha starts: he puts the gun to his head and shoots. If there was no bullet in front of the trigger, the cylinder shifts by one position and the weapon is given to Roma for make the same move. The game continues until someone is shot, the survivor is the winner. Sasha does not want to lose, so he must choose slots for bullets in such a way as to minimize the probability of its own loss. Of all the possible variant he wants to select the lexicographically minimal one, where an empty slot is lexicographically less than a charged one. More formally, the cylinder of n bullet slots able to contain k bullets can be represented as a string of n characters. Exactly k of them are ""X"" (charged slots) and the others are ""."" (uncharged slots). Let us describe the process of a shot. Suppose that the trigger is in front of the first character of the string (the first slot). If a shot doesn\'t kill anyone and the cylinder shifts, then the string shifts left. So the first character becomes the last one, the second character becomes the first one, and so on. But the trigger doesn\'t move. It will be in front of the first character of the resulting string.Among all the strings that give the minimal probability of loss, Sasha choose the lexicographically minimal one. According to this very string, he charges the gun. You have to help Sasha to charge the gun. For that, each xi query must be answered: is there a bullet in the positions xi?" 1300

94A "Restoring Password" implementation,strings "After all the events in Orlando we all know, Sasha and Roma decided to find out who is still the team\'s biggest loser. Thankfully, Masha found somewhere a revolver with a rotating cylinder of n bullet slots able to contain exactly k bullets, now the boys have a chance to resolve the problem once and for all. Sasha selects any k out of n slots he wishes and puts bullets there. Roma spins the cylinder so that every of n possible cylinder\'s shifts is equiprobable. Then the game starts, the players take turns, Sasha starts: he puts the gun to his head and shoots. If there was no bullet in front of the trigger, the cylinder shifts by one position and the weapon is given to Roma for make the same move. The game continues until someone is shot, the survivor is the winner. Sasha does not want to lose, so he must choose slots for bullets in such a way as to minimize the probability of its own loss. Of all the possible variant he wants to select the lexicographically minimal one, where an empty slot is lexicographically less than a charged one. More formally, the cylinder of n bullet slots able to contain k bullets can be represented as a string of n characters. Exactly k of them are ""X"" (charged slots) and the others are ""."" (uncharged slots). Let us describe the process of a shot. Suppose that the trigger is in front of the first character of the string (the first slot). If a shot doesn\'t kill anyone and the cylinder shifts, then the string shifts left. So the first character becomes the last one, the second character becomes the first one, and so on. But the trigger doesn\'t move. It will be in front of the first character of the resulting string.Among all the strings that give the minimal probability of loss, Sasha choose the lexicographically minimal one. According to this very string, he charges the gun. You have to help Sasha to charge the gun. For that, each xi query must be answered: is there a bullet in the positions xi?" 900

93E Lostborn "dp,math,number theory" "After all the events in Orlando we all know, Sasha and Roma decided to find out who is still the team\'s biggest loser. Thankfully, Masha found somewhere a revolver with a rotating cylinder of n bullet slots able to contain exactly k bullets, now the boys have a chance to resolve the problem once and for all. Sasha selects any k out of n slots he wishes and puts bullets there. Roma spins the cylinder so that every of n possible cylinder\'s shifts is equiprobable. Then the game starts, the players take turns, Sasha starts: he puts the gun to his head and shoots. If there was no bullet in front of the trigger, the cylinder shifts by one position and the weapon is given to Roma for make the same move. The game continues until someone is shot, the survivor is the winner. Sasha does not want to lose, so he must choose slots for bullets in such a way as to minimize the probability of its own loss. Of all the possible variant he wants to select the lexicographically minimal one, where an empty slot is lexicographically less than a charged one. More formally, the cylinder of n bullet slots able to contain k bullets can be represented as a string of n characters. Exactly k of them are ""X"" (charged slots) and the others are ""."" (uncharged slots). Let us describe the process of a shot. Suppose that the trigger is in front of the first character of the string (the first slot). If a shot doesn\'t kill anyone and the cylinder shifts, then the string shifts left. So the first character becomes the last one, the second character becomes the first one, and so on. But the trigger doesn\'t move. It will be in front of the first character of the resulting string.Among all the strings that give the minimal probability of loss, Sasha choose the lexicographically minimal one. According to this very string, he charges the gun. You have to help Sasha to charge the gun. For that, each xi query must be answered: is there a bullet in the positions xi?" 2600

93D Flags dp,math,matrices "After all the events in Orlando we all know, Sasha and Roma decided to find out who is still the team\'s biggest loser. Thankfully, Masha found somewhere a revolver with a rotating cylinder of n bullet slots able to contain exactly k bullets, now the boys have a chance to resolve the problem once and for all. Sasha selects any k out of n slots he wishes and puts bullets there. Roma spins the cylinder so that every of n possible cylinder\'s shifts is equiprobable. Then the game starts, the players take turns, Sasha starts: he puts the gun to his head and shoots. If there was no bullet in front of the trigger, the cylinder shifts by one position and the weapon is given to Roma for make the same move. The game continues until someone is shot, the survivor is the winner. Sasha does not want to lose, so he must choose slots for bullets in such a way as to minimize the probability of its own loss. Of all the possible variant he wants to select the lexicographically minimal one, where an empty slot is lexicographically less than a charged one. More formally, the cylinder of n bullet slots able to contain k bullets can be represented as a string of n characters. Exactly k of them are ""X"" (charged slots) and the others are ""."" (uncharged slots). Let us describe the process of a shot. Suppose that the trigger is in front of the first character of the string (the first slot). If a shot doesn\'t kill anyone and the cylinder shifts, then the string shifts left. So the first character becomes the last one, the second character becomes the first one, and so on. But the trigger doesn\'t move. It will be in front of the first character of the resulting string.Among all the strings that give the minimal probability of loss, Sasha choose the lexicographically minimal one. According to this very string, he charges the gun. You have to help Sasha to charge the gun. For that, each xi query must be answered: is there a bullet in the positions xi?" 2500

93C Azembler "brute force,implementation" "After all the events in Orlando we all know, Sasha and Roma decided to find out who is still the team\'s biggest loser. Thankfully, Masha found somewhere a revolver with a rotating cylinder of n bullet slots able to contain exactly k bullets, now the boys have a chance to resolve the problem once and for all. Sasha selects any k out of n slots he wishes and puts bullets there. Roma spins the cylinder so that every of n possible cylinder\'s shifts is equiprobable. Then the game starts, the players take turns, Sasha starts: he puts the gun to his head and shoots. If there was no bullet in front of the trigger, the cylinder shifts by one position and the weapon is given to Roma for make the same move. The game continues until someone is shot, the survivor is the winner. Sasha does not want to lose, so he must choose slots for bullets in such a way as to minimize the probability of its own loss. Of all the possible variant he wants to select the lexicographically minimal one, where an empty slot is lexicographically less than a charged one. More formally, the cylinder of n bullet slots able to contain k bullets can be represented as a string of n characters. Exactly k of them are ""X"" (charged slots) and the others are ""."" (uncharged slots). Let us describe the process of a shot. Suppose that the trigger is in front of the first character of the string (the first slot). If a shot doesn\'t kill anyone and the cylinder shifts, then the string shifts left. So the first character becomes the last one, the second character becomes the first one, and so on. But the trigger doesn\'t move. It will be in front of the first character of the resulting string.Among all the strings that give the minimal probability of loss, Sasha choose the lexicographically minimal one. According to this very string, he charges the gun. You have to help Sasha to charge the gun. For that, each xi query must be answered: is there a bullet in the positions xi?" 2500

93B "End of Exams" greedy "After all the events in Orlando we all know, Sasha and Roma decided to find out who is still the team\'s biggest loser. Thankfully, Masha found somewhere a revolver with a rotating cylinder of n bullet slots able to contain exactly k bullets, now the boys have a chance to resolve the problem once and for all. Sasha selects any k out of n slots he wishes and puts bullets there. Roma spins the cylinder so that every of n possible cylinder\'s shifts is equiprobable. Then the game starts, the players take turns, Sasha starts: he puts the gun to his head and shoots. If there was no bullet in front of the trigger, the cylinder shifts by one position and the weapon is given to Roma for make the same move. The game continues until someone is shot, the survivor is the winner. Sasha does not want to lose, so he must choose slots for bullets in such a way as to minimize the probability of its own loss. Of all the possible variant he wants to select the lexicographically minimal one, where an empty slot is lexicographically less than a charged one. More formally, the cylinder of n bullet slots able to contain k bullets can be represented as a string of n characters. Exactly k of them are ""X"" (charged slots) and the others are ""."" (uncharged slots). Let us describe the process of a shot. Suppose that the trigger is in front of the first character of the string (the first slot). If a shot doesn\'t kill anyone and the cylinder shifts, then the string shifts left. So the first character becomes the last one, the second character becomes the first one, and so on. But the trigger doesn\'t move. It will be in front of the first character of the resulting string.Among all the strings that give the minimal probability of loss, Sasha choose the lexicographically minimal one. According to this very string, he charges the gun. You have to help Sasha to charge the gun. For that, each xi query must be answered: is there a bullet in the positions xi?" 1900

93A Frames implementation "After all the events in Orlando we all know, Sasha and Roma decided to find out who is still the team\'s biggest loser. Thankfully, Masha found somewhere a revolver with a rotating cylinder of n bullet slots able to contain exactly k bullets, now the boys have a chance to resolve the problem once and for all. Sasha selects any k out of n slots he wishes and puts bullets there. Roma spins the cylinder so that every of n possible cylinder\'s shifts is equiprobable. Then the game starts, the players take turns, Sasha starts: he puts the gun to his head and shoots. If there was no bullet in front of the trigger, the cylinder shifts by one position and the weapon is given to Roma for make the same move. The game continues until someone is shot, the survivor is the winner. Sasha does not want to lose, so he must choose slots for bullets in such a way as to minimize the probability of its own loss. Of all the possible variant he wants to select the lexicographically minimal one, where an empty slot is lexicographically less than a charged one. More formally, the cylinder of n bullet slots able to contain k bullets can be represented as a string of n characters. Exactly k of them are ""X"" (charged slots) and the others are ""."" (uncharged slots). Let us describe the process of a shot. Suppose that the trigger is in front of the first character of the string (the first slot). If a shot doesn\'t kill anyone and the cylinder shifts, then the string shifts left. So the first character becomes the last one, the second character becomes the first one, and so on. But the trigger doesn\'t move. It will be in front of the first character of the resulting string.Among all the strings that give the minimal probability of loss, Sasha choose the lexicographically minimal one. According to this very string, he charges the gun. You have to help Sasha to charge the gun. For that, each xi query must be answered: is there a bullet in the positions xi?" 1700

92B "Binary Number" greedy "After all the events in Orlando we all know, Sasha and Roma decided to find out who is still the team\'s biggest loser. Thankfully, Masha found somewhere a revolver with a rotating cylinder of n bullet slots able to contain exactly k bullets, now the boys have a chance to resolve the problem once and for all. Sasha selects any k out of n slots he wishes and puts bullets there. Roma spins the cylinder so that every of n possible cylinder\'s shifts is equiprobable. Then the game starts, the players take turns, Sasha starts: he puts the gun to his head and shoots. If there was no bullet in front of the trigger, the cylinder shifts by one position and the weapon is given to Roma for make the same move. The game continues until someone is shot, the survivor is the winner. Sasha does not want to lose, so he must choose slots for bullets in such a way as to minimize the probability of its own loss. Of all the possible variant he wants to select the lexicographically minimal one, where an empty slot is lexicographically less than a charged one. More formally, the cylinder of n bullet slots able to contain k bullets can be represented as a string of n characters. Exactly k of them are ""X"" (charged slots) and the others are ""."" (uncharged slots). Let us describe the process of a shot. Suppose that the trigger is in front of the first character of the string (the first slot). If a shot doesn\'t kill anyone and the cylinder shifts, then the string shifts left. So the first character becomes the last one, the second character becomes the first one, and so on. But the trigger doesn\'t move. It will be in front of the first character of the resulting string.Among all the strings that give the minimal probability of loss, Sasha choose the lexicographically minimal one. According to this very string, he charges the gun. You have to help Sasha to charge the gun. For that, each xi query must be answered: is there a bullet in the positions xi?" 1300

92A Chips implementation,math "After all the events in Orlando we all know, Sasha and Roma decided to find out who is still the team\'s biggest loser. Thankfully, Masha found somewhere a revolver with a rotating cylinder of n bullet slots able to contain exactly k bullets, now the boys have a chance to resolve the problem once and for all. Sasha selects any k out of n slots he wishes and puts bullets there. Roma spins the cylinder so that every of n possible cylinder\'s shifts is equiprobable. Then the game starts, the players take turns, Sasha starts: he puts the gun to his head and shoots. If there was no bullet in front of the trigger, the cylinder shifts by one position and the weapon is given to Roma for make the same move. The game continues until someone is shot, the survivor is the winner. Sasha does not want to lose, so he must choose slots for bullets in such a way as to minimize the probability of its own loss. Of all the possible variant he wants to select the lexicographically minimal one, where an empty slot is lexicographically less than a charged one. More formally, the cylinder of n bullet slots able to contain k bullets can be represented as a string of n characters. Exactly k of them are ""X"" (charged slots) and the others are ""."" (uncharged slots). Let us describe the process of a shot. Suppose that the trigger is in front of the first character of the string (the first slot). If a shot doesn\'t kill anyone and the cylinder shifts, then the string shifts left. So the first character becomes the last one, the second character becomes the first one, and so on. But the trigger doesn\'t move. It will be in front of the first character of the resulting string.Among all the strings that give the minimal probability of loss, Sasha choose the lexicographically minimal one. According to this very string, he charges the gun. You have to help Sasha to charge the gun. For that, each xi query must be answered: is there a bullet in the positions xi?" 800

91E "Igloo Skyscraper" "data structures,geometry" "After all the events in Orlando we all know, Sasha and Roma decided to find out who is still the team\'s biggest loser. Thankfully, Masha found somewhere a revolver with a rotating cylinder of n bullet slots able to contain exactly k bullets, now the boys have a chance to resolve the problem once and for all. Sasha selects any k out of n slots he wishes and puts bullets there. Roma spins the cylinder so that every of n possible cylinder\'s shifts is equiprobable. Then the game starts, the players take turns, Sasha starts: he puts the gun to his head and shoots. If there was no bullet in front of the trigger, the cylinder shifts by one position and the weapon is given to Roma for make the same move. The game continues until someone is shot, the survivor is the winner. Sasha does not want to lose, so he must choose slots for bullets in such a way as to minimize the probability of its own loss. Of all the possible variant he wants to select the lexicographically minimal one, where an empty slot is lexicographically less than a charged one. More formally, the cylinder of n bullet slots able to contain k bullets can be represented as a string of n characters. Exactly k of them are ""X"" (charged slots) and the others are ""."" (uncharged slots). Let us describe the process of a shot. Suppose that the trigger is in front of the first character of the string (the first slot). If a shot doesn\'t kill anyone and the cylinder shifts, then the string shifts left. So the first character becomes the last one, the second character becomes the first one, and so on. But the trigger doesn\'t move. It will be in front of the first character of the resulting string.Among all the strings that give the minimal probability of loss, Sasha choose the lexicographically minimal one. According to this very string, he charges the gun. You have to help Sasha to charge the gun. For that, each xi query must be answered: is there a bullet in the positions xi?" 2500

91D "Grocer\'s Problem" "constructive algorithms,graphs,greedy" "After all the events in Orlando we all know, Sasha and Roma decided to find out who is still the team\'s biggest loser. Thankfully, Masha found somewhere a revolver with a rotating cylinder of n bullet slots able to contain exactly k bullets, now the boys have a chance to resolve the problem once and for all. Sasha selects any k out of n slots he wishes and puts bullets there. Roma spins the cylinder so that every of n possible cylinder\'s shifts is equiprobable. Then the game starts, the players take turns, Sasha starts: he puts the gun to his head and shoots. If there was no bullet in front of the trigger, the cylinder shifts by one position and the weapon is given to Roma for make the same move. The game continues until someone is shot, the survivor is the winner. Sasha does not want to lose, so he must choose slots for bullets in such a way as to minimize the probability of its own loss. Of all the possible variant he wants to select the lexicographically minimal one, where an empty slot is lexicographically less than a charged one. More formally, the cylinder of n bullet slots able to contain k bullets can be represented as a string of n characters. Exactly k of them are ""X"" (charged slots) and the others are ""."" (uncharged slots). Let us describe the process of a shot. Suppose that the trigger is in front of the first character of the string (the first slot). If a shot doesn\'t kill anyone and the cylinder shifts, then the string shifts left. So the first character becomes the last one, the second character becomes the first one, and so on. But the trigger doesn\'t move. It will be in front of the first character of the resulting string.Among all the strings that give the minimal probability of loss, Sasha choose the lexicographically minimal one. According to this very string, he charges the gun. You have to help Sasha to charge the gun. For that, each xi query must be answered: is there a bullet in the positions xi?" 2600

91C "Ski Base" combinatorics,dsu,graphs "After all the events in Orlando we all know, Sasha and Roma decided to find out who is still the team\'s biggest loser. Thankfully, Masha found somewhere a revolver with a rotating cylinder of n bullet slots able to contain exactly k bullets, now the boys have a chance to resolve the problem once and for all. Sasha selects any k out of n slots he wishes and puts bullets there. Roma spins the cylinder so that every of n possible cylinder\'s shifts is equiprobable. Then the game starts, the players take turns, Sasha starts: he puts the gun to his head and shoots. If there was no bullet in front of the trigger, the cylinder shifts by one position and the weapon is given to Roma for make the same move. The game continues until someone is shot, the survivor is the winner. Sasha does not want to lose, so he must choose slots for bullets in such a way as to minimize the probability of its own loss. Of all the possible variant he wants to select the lexicographically minimal one, where an empty slot is lexicographically less than a charged one. More formally, the cylinder of n bullet slots able to contain k bullets can be represented as a string of n characters. Exactly k of them are ""X"" (charged slots) and the others are ""."" (uncharged slots). Let us describe the process of a shot. Suppose that the trigger is in front of the first character of the string (the first slot). If a shot doesn\'t kill anyone and the cylinder shifts, then the string shifts left. So the first character becomes the last one, the second character becomes the first one, and so on. But the trigger doesn\'t move. It will be in front of the first character of the resulting string.Among all the strings that give the minimal probability of loss, Sasha choose the lexicographically minimal one. According to this very string, he charges the gun. You have to help Sasha to charge the gun. For that, each xi query must be answered: is there a bullet in the positions xi?" 2300

91B Queue "binary search,data structures" "After all the events in Orlando we all know, Sasha and Roma decided to find out who is still the team\'s biggest loser. Thankfully, Masha found somewhere a revolver with a rotating cylinder of n bullet slots able to contain exactly k bullets, now the boys have a chance to resolve the problem once and for all. Sasha selects any k out of n slots he wishes and puts bullets there. Roma spins the cylinder so that every of n possible cylinder\'s shifts is equiprobable. Then the game starts, the players take turns, Sasha starts: he puts the gun to his head and shoots. If there was no bullet in front of the trigger, the cylinder shifts by one position and the weapon is given to Roma for make the same move. The game continues until someone is shot, the survivor is the winner. Sasha does not want to lose, so he must choose slots for bullets in such a way as to minimize the probability of its own loss. Of all the possible variant he wants to select the lexicographically minimal one, where an empty slot is lexicographically less than a charged one. More formally, the cylinder of n bullet slots able to contain k bullets can be represented as a string of n characters. Exactly k of them are ""X"" (charged slots) and the others are ""."" (uncharged slots). Let us describe the process of a shot. Suppose that the trigger is in front of the first character of the string (the first slot). If a shot doesn\'t kill anyone and the cylinder shifts, then the string shifts left. So the first character becomes the last one, the second character becomes the first one, and so on. But the trigger doesn\'t move. It will be in front of the first character of the resulting string.Among all the strings that give the minimal probability of loss, Sasha choose the lexicographically minimal one. According to this very string, he charges the gun. You have to help Sasha to charge the gun. For that, each xi query must be answered: is there a bullet in the positions xi?" 1500

91A "Newspaper Headline" greedy,strings "After all the events in Orlando we all know, Sasha and Roma decided to find out who is still the team\'s biggest loser. Thankfully, Masha found somewhere a revolver with a rotating cylinder of n bullet slots able to contain exactly k bullets, now the boys have a chance to resolve the problem once and for all. Sasha selects any k out of n slots he wishes and puts bullets there. Roma spins the cylinder so that every of n possible cylinder\'s shifts is equiprobable. Then the game starts, the players take turns, Sasha starts: he puts the gun to his head and shoots. If there was no bullet in front of the trigger, the cylinder shifts by one position and the weapon is given to Roma for make the same move. The game continues until someone is shot, the survivor is the winner. Sasha does not want to lose, so he must choose slots for bullets in such a way as to minimize the probability of its own loss. Of all the possible variant he wants to select the lexicographically minimal one, where an empty slot is lexicographically less than a charged one. More formally, the cylinder of n bullet slots able to contain k bullets can be represented as a string of n characters. Exactly k of them are ""X"" (charged slots) and the others are ""."" (uncharged slots). Let us describe the process of a shot. Suppose that the trigger is in front of the first character of the string (the first slot). If a shot doesn\'t kill anyone and the cylinder shifts, then the string shifts left. So the first character becomes the last one, the second character becomes the first one, and so on. But the trigger doesn\'t move. It will be in front of the first character of the resulting string.Among all the strings that give the minimal probability of loss, Sasha choose the lexicographically minimal one. According to this very string, he charges the gun. You have to help Sasha to charge the gun. For that, each xi query must be answered: is there a bullet in the positions xi?" 1500

90B "African Crossword" implementation,strings "After all the events in Orlando we all know, Sasha and Roma decided to find out who is still the team\'s biggest loser. Thankfully, Masha found somewhere a revolver with a rotating cylinder of n bullet slots able to contain exactly k bullets, now the boys have a chance to resolve the problem once and for all. Sasha selects any k out of n slots he wishes and puts bullets there. Roma spins the cylinder so that every of n possible cylinder\'s shifts is equiprobable. Then the game starts, the players take turns, Sasha starts: he puts the gun to his head and shoots. If there was no bullet in front of the trigger, the cylinder shifts by one position and the weapon is given to Roma for make the same move. The game continues until someone is shot, the survivor is the winner. Sasha does not want to lose, so he must choose slots for bullets in such a way as to minimize the probability of its own loss. Of all the possible variant he wants to select the lexicographically minimal one, where an empty slot is lexicographically less than a charged one. More formally, the cylinder of n bullet slots able to contain k bullets can be represented as a string of n characters. Exactly k of them are ""X"" (charged slots) and the others are ""."" (uncharged slots). Let us describe the process of a shot. Suppose that the trigger is in front of the first character of the string (the first slot). If a shot doesn\'t kill anyone and the cylinder shifts, then the string shifts left. So the first character becomes the last one, the second character becomes the first one, and so on. But the trigger doesn\'t move. It will be in front of the first character of the resulting string.Among all the strings that give the minimal probability of loss, Sasha choose the lexicographically minimal one. According to this very string, he charges the gun. You have to help Sasha to charge the gun. For that, each xi query must be answered: is there a bullet in the positions xi?" 1100

90A Cableway greedy,math "After all the events in Orlando we all know, Sasha and Roma decided to find out who is still the team\'s biggest loser. Thankfully, Masha found somewhere a revolver with a rotating cylinder of n bullet slots able to contain exactly k bullets, now the boys have a chance to resolve the problem once and for all. Sasha selects any k out of n slots he wishes and puts bullets there. Roma spins the cylinder so that every of n possible cylinder\'s shifts is equiprobable. Then the game starts, the players take turns, Sasha starts: he puts the gun to his head and shoots. If there was no bullet in front of the trigger, the cylinder shifts by one position and the weapon is given to Roma for make the same move. The game continues until someone is shot, the survivor is the winner. Sasha does not want to lose, so he must choose slots for bullets in such a way as to minimize the probability of its own loss. Of all the possible variant he wants to select the lexicographically minimal one, where an empty slot is lexicographically less than a charged one. More formally, the cylinder of n bullet slots able to contain k bullets can be represented as a string of n characters. Exactly k of them are ""X"" (charged slots) and the others are ""."" (uncharged slots). Let us describe the process of a shot. Suppose that the trigger is in front of the first character of the string (the first slot). If a shot doesn\'t kill anyone and the cylinder shifts, then the string shifts left. So the first character becomes the last one, the second character becomes the first one, and so on. But the trigger doesn\'t move. It will be in front of the first character of the resulting string.Among all the strings that give the minimal probability of loss, Sasha choose the lexicographically minimal one. According to this very string, he charges the gun. You have to help Sasha to charge the gun. For that, each xi query must be answered: is there a bullet in the positions xi?" 1000

89E "Fire and Ice" greedy "After all the events in Orlando we all know, Sasha and Roma decided to find out who is still the team\'s biggest loser. Thankfully, Masha found somewhere a revolver with a rotating cylinder of n bullet slots able to contain exactly k bullets, now the boys have a chance to resolve the problem once and for all. Sasha selects any k out of n slots he wishes and puts bullets there. Roma spins the cylinder so that every of n possible cylinder\'s shifts is equiprobable. Then the game starts, the players take turns, Sasha starts: he puts the gun to his head and shoots. If there was no bullet in front of the trigger, the cylinder shifts by one position and the weapon is given to Roma for make the same move. The game continues until someone is shot, the survivor is the winner. Sasha does not want to lose, so he must choose slots for bullets in such a way as to minimize the probability of its own loss. Of all the possible variant he wants to select the lexicographically minimal one, where an empty slot is lexicographically less than a charged one. More formally, the cylinder of n bullet slots able to contain k bullets can be represented as a string of n characters. Exactly k of them are ""X"" (charged slots) and the others are ""."" (uncharged slots). Let us describe the process of a shot. Suppose that the trigger is in front of the first character of the string (the first slot). If a shot doesn\'t kill anyone and the cylinder shifts, then the string shifts left. So the first character becomes the last one, the second character becomes the first one, and so on. But the trigger doesn\'t move. It will be in front of the first character of the resulting string.Among all the strings that give the minimal probability of loss, Sasha choose the lexicographically minimal one. According to this very string, he charges the gun. You have to help Sasha to charge the gun. For that, each xi query must be answered: is there a bullet in the positions xi?" 2900

89D "Space mines" geometry "After all the events in Orlando we all know, Sasha and Roma decided to find out who is still the team\'s biggest loser. Thankfully, Masha found somewhere a revolver with a rotating cylinder of n bullet slots able to contain exactly k bullets, now the boys have a chance to resolve the problem once and for all. Sasha selects any k out of n slots he wishes and puts bullets there. Roma spins the cylinder so that every of n possible cylinder\'s shifts is equiprobable. Then the game starts, the players take turns, Sasha starts: he puts the gun to his head and shoots. If there was no bullet in front of the trigger, the cylinder shifts by one position and the weapon is given to Roma for make the same move. The game continues until someone is shot, the survivor is the winner. Sasha does not want to lose, so he must choose slots for bullets in such a way as to minimize the probability of its own loss. Of all the possible variant he wants to select the lexicographically minimal one, where an empty slot is lexicographically less than a charged one. More formally, the cylinder of n bullet slots able to contain k bullets can be represented as a string of n characters. Exactly k of them are ""X"" (charged slots) and the others are ""."" (uncharged slots). Let us describe the process of a shot. Suppose that the trigger is in front of the first character of the string (the first slot). If a shot doesn\'t kill anyone and the cylinder shifts, then the string shifts left. So the first character becomes the last one, the second character becomes the first one, and so on. But the trigger doesn\'t move. It will be in front of the first character of the resulting string.Among all the strings that give the minimal probability of loss, Sasha choose the lexicographically minimal one. According to this very string, he charges the gun. You have to help Sasha to charge the gun. For that, each xi query must be answered: is there a bullet in the positions xi?" 2500

89C "Chip Play" "brute force,data structures,implementation" "After all the events in Orlando we all know, Sasha and Roma decided to find out who is still the team\'s biggest loser. Thankfully, Masha found somewhere a revolver with a rotating cylinder of n bullet slots able to contain exactly k bullets, now the boys have a chance to resolve the problem once and for all. Sasha selects any k out of n slots he wishes and puts bullets there. Roma spins the cylinder so that every of n possible cylinder\'s shifts is equiprobable. Then the game starts, the players take turns, Sasha starts: he puts the gun to his head and shoots. If there was no bullet in front of the trigger, the cylinder shifts by one position and the weapon is given to Roma for make the same move. The game continues until someone is shot, the survivor is the winner. Sasha does not want to lose, so he must choose slots for bullets in such a way as to minimize the probability of its own loss. Of all the possible variant he wants to select the lexicographically minimal one, where an empty slot is lexicographically less than a charged one. More formally, the cylinder of n bullet slots able to contain k bullets can be represented as a string of n characters. Exactly k of them are ""X"" (charged slots) and the others are ""."" (uncharged slots). Let us describe the process of a shot. Suppose that the trigger is in front of the first character of the string (the first slot). If a shot doesn\'t kill anyone and the cylinder shifts, then the string shifts left. So the first character becomes the last one, the second character becomes the first one, and so on. But the trigger doesn\'t move. It will be in front of the first character of the resulting string.Among all the strings that give the minimal probability of loss, Sasha choose the lexicographically minimal one. According to this very string, he charges the gun. You have to help Sasha to charge the gun. For that, each xi query must be answered: is there a bullet in the positions xi?" 2300

89B "Widget Library" "dp,expression parsing,graphs,implementation" "After all the events in Orlando we all know, Sasha and Roma decided to find out who is still the team\'s biggest loser. Thankfully, Masha found somewhere a revolver with a rotating cylinder of n bullet slots able to contain exactly k bullets, now the boys have a chance to resolve the problem once and for all. Sasha selects any k out of n slots he wishes and puts bullets there. Roma spins the cylinder so that every of n possible cylinder\'s shifts is equiprobable. Then the game starts, the players take turns, Sasha starts: he puts the gun to his head and shoots. If there was no bullet in front of the trigger, the cylinder shifts by one position and the weapon is given to Roma for make the same move. The game continues until someone is shot, the survivor is the winner. Sasha does not want to lose, so he must choose slots for bullets in such a way as to minimize the probability of its own loss. Of all the possible variant he wants to select the lexicographically minimal one, where an empty slot is lexicographically less than a charged one. More formally, the cylinder of n bullet slots able to contain k bullets can be represented as a string of n characters. Exactly k of them are ""X"" (charged slots) and the others are ""."" (uncharged slots). Let us describe the process of a shot. Suppose that the trigger is in front of the first character of the string (the first slot). If a shot doesn\'t kill anyone and the cylinder shifts, then the string shifts left. So the first character becomes the last one, the second character becomes the first one, and so on. But the trigger doesn\'t move. It will be in front of the first character of the resulting string.Among all the strings that give the minimal probability of loss, Sasha choose the lexicographically minimal one. According to this very string, he charges the gun. You have to help Sasha to charge the gun. For that, each xi query must be answered: is there a bullet in the positions xi?" 2300

89A Robbery greedy "After all the events in Orlando we all know, Sasha and Roma decided to find out who is still the team\'s biggest loser. Thankfully, Masha found somewhere a revolver with a rotating cylinder of n bullet slots able to contain exactly k bullets, now the boys have a chance to resolve the problem once and for all. Sasha selects any k out of n slots he wishes and puts bullets there. Roma spins the cylinder so that every of n possible cylinder\'s shifts is equiprobable. Then the game starts, the players take turns, Sasha starts: he puts the gun to his head and shoots. If there was no bullet in front of the trigger, the cylinder shifts by one position and the weapon is given to Roma for make the same move. The game continues until someone is shot, the survivor is the winner. Sasha does not want to lose, so he must choose slots for bullets in such a way as to minimize the probability of its own loss. Of all the possible variant he wants to select the lexicographically minimal one, where an empty slot is lexicographically less than a charged one. More formally, the cylinder of n bullet slots able to contain k bullets can be represented as a string of n characters. Exactly k of them are ""X"" (charged slots) and the others are ""."" (uncharged slots). Let us describe the process of a shot. Suppose that the trigger is in front of the first character of the string (the first slot). If a shot doesn\'t kill anyone and the cylinder shifts, then the string shifts left. So the first character becomes the last one, the second character becomes the first one, and so on. But the trigger doesn\'t move. It will be in front of the first character of the resulting string.Among all the strings that give the minimal probability of loss, Sasha choose the lexicographically minimal one. According to this very string, he charges the gun. You have to help Sasha to charge the gun. For that, each xi query must be answered: is there a bullet in the positions xi?" 1800

88B Keyboard implementation "After all the events in Orlando we all know, Sasha and Roma decided to find out who is still the team\'s biggest loser. Thankfully, Masha found somewhere a revolver with a rotating cylinder of n bullet slots able to contain exactly k bullets, now the boys have a chance to resolve the problem once and for all. Sasha selects any k out of n slots he wishes and puts bullets there. Roma spins the cylinder so that every of n possible cylinder\'s shifts is equiprobable. Then the game starts, the players take turns, Sasha starts: he puts the gun to his head and shoots. If there was no bullet in front of the trigger, the cylinder shifts by one position and the weapon is given to Roma for make the same move. The game continues until someone is shot, the survivor is the winner. Sasha does not want to lose, so he must choose slots for bullets in such a way as to minimize the probability of its own loss. Of all the possible variant he wants to select the lexicographically minimal one, where an empty slot is lexicographically less than a charged one. More formally, the cylinder of n bullet slots able to contain k bullets can be represented as a string of n characters. Exactly k of them are ""X"" (charged slots) and the others are ""."" (uncharged slots). Let us describe the process of a shot. Suppose that the trigger is in front of the first character of the string (the first slot). If a shot doesn\'t kill anyone and the cylinder shifts, then the string shifts left. So the first character becomes the last one, the second character becomes the first one, and so on. But the trigger doesn\'t move. It will be in front of the first character of the resulting string.Among all the strings that give the minimal probability of loss, Sasha choose the lexicographically minimal one. According to this very string, he charges the gun. You have to help Sasha to charge the gun. For that, each xi query must be answered: is there a bullet in the positions xi?" 1500

88A Chord "brute force,implementation" "After all the events in Orlando we all know, Sasha and Roma decided to find out who is still the team\'s biggest loser. Thankfully, Masha found somewhere a revolver with a rotating cylinder of n bullet slots able to contain exactly k bullets, now the boys have a chance to resolve the problem once and for all. Sasha selects any k out of n slots he wishes and puts bullets there. Roma spins the cylinder so that every of n possible cylinder\'s shifts is equiprobable. Then the game starts, the players take turns, Sasha starts: he puts the gun to his head and shoots. If there was no bullet in front of the trigger, the cylinder shifts by one position and the weapon is given to Roma for make the same move. The game continues until someone is shot, the survivor is the winner. Sasha does not want to lose, so he must choose slots for bullets in such a way as to minimize the probability of its own loss. Of all the possible variant he wants to select the lexicographically minimal one, where an empty slot is lexicographically less than a charged one. More formally, the cylinder of n bullet slots able to contain k bullets can be represented as a string of n characters. Exactly k of them are ""X"" (charged slots) and the others are ""."" (uncharged slots). Let us describe the process of a shot. Suppose that the trigger is in front of the first character of the string (the first slot). If a shot doesn\'t kill anyone and the cylinder shifts, then the string shifts left. So the first character becomes the last one, the second character becomes the first one, and so on. But the trigger doesn\'t move. It will be in front of the first character of the resulting string.Among all the strings that give the minimal probability of loss, Sasha choose the lexicographically minimal one. According to this very string, he charges the gun. You have to help Sasha to charge the gun. For that, each xi query must be answered: is there a bullet in the positions xi?" 1200

87E "Mogohu-Rea Idol" geometry "After all the events in Orlando we all know, Sasha and Roma decided to find out who is still the team\'s biggest loser. Thankfully, Masha found somewhere a revolver with a rotating cylinder of n bullet slots able to contain exactly k bullets, now the boys have a chance to resolve the problem once and for all. Sasha selects any k out of n slots he wishes and puts bullets there. Roma spins the cylinder so that every of n possible cylinder\'s shifts is equiprobable. Then the game starts, the players take turns, Sasha starts: he puts the gun to his head and shoots. If there was no bullet in front of the trigger, the cylinder shifts by one position and the weapon is given to Roma for make the same move. The game continues until someone is shot, the survivor is the winner. Sasha does not want to lose, so he must choose slots for bullets in such a way as to minimize the probability of its own loss. Of all the possible variant he wants to select the lexicographically minimal one, where an empty slot is lexicographically less than a charged one. More formally, the cylinder of n bullet slots able to contain k bullets can be represented as a string of n characters. Exactly k of them are ""X"" (charged slots) and the others are ""."" (uncharged slots). Let us describe the process of a shot. Suppose that the trigger is in front of the first character of the string (the first slot). If a shot doesn\'t kill anyone and the cylinder shifts, then the string shifts left. So the first character becomes the last one, the second character becomes the first one, and so on. But the trigger doesn\'t move. It will be in front of the first character of the resulting string.Among all the strings that give the minimal probability of loss, Sasha choose the lexicographically minimal one. According to this very string, he charges the gun. You have to help Sasha to charge the gun. For that, each xi query must be answered: is there a bullet in the positions xi?" 2600

87D "Beautiful Road" "dfs and similar,dp,dsu,graphs,implementation,sortings,trees" "After all the events in Orlando we all know, Sasha and Roma decided to find out who is still the team\'s biggest loser. Thankfully, Masha found somewhere a revolver with a rotating cylinder of n bullet slots able to contain exactly k bullets, now the boys have a chance to resolve the problem once and for all. Sasha selects any k out of n slots he wishes and puts bullets there. Roma spins the cylinder so that every of n possible cylinder\'s shifts is equiprobable. Then the game starts, the players take turns, Sasha starts: he puts the gun to his head and shoots. If there was no bullet in front of the trigger, the cylinder shifts by one position and the weapon is given to Roma for make the same move. The game continues until someone is shot, the survivor is the winner. Sasha does not want to lose, so he must choose slots for bullets in such a way as to minimize the probability of its own loss. Of all the possible variant he wants to select the lexicographically minimal one, where an empty slot is lexicographically less than a charged one. More formally, the cylinder of n bullet slots able to contain k bullets can be represented as a string of n characters. Exactly k of them are ""X"" (charged slots) and the others are ""."" (uncharged slots). Let us describe the process of a shot. Suppose that the trigger is in front of the first character of the string (the first slot). If a shot doesn\'t kill anyone and the cylinder shifts, then the string shifts left. So the first character becomes the last one, the second character becomes the first one, and so on. But the trigger doesn\'t move. It will be in front of the first character of the resulting string.Among all the strings that give the minimal probability of loss, Sasha choose the lexicographically minimal one. According to this very string, he charges the gun. You have to help Sasha to charge the gun. For that, each xi query must be answered: is there a bullet in the positions xi?" 2300

87C "Interesting Game" dp,games,math "After all the events in Orlando we all know, Sasha and Roma decided to find out who is still the team\'s biggest loser. Thankfully, Masha found somewhere a revolver with a rotating cylinder of n bullet slots able to contain exactly k bullets, now the boys have a chance to resolve the problem once and for all. Sasha selects any k out of n slots he wishes and puts bullets there. Roma spins the cylinder so that every of n possible cylinder\'s shifts is equiprobable. Then the game starts, the players take turns, Sasha starts: he puts the gun to his head and shoots. If there was no bullet in front of the trigger, the cylinder shifts by one position and the weapon is given to Roma for make the same move. The game continues until someone is shot, the survivor is the winner. Sasha does not want to lose, so he must choose slots for bullets in such a way as to minimize the probability of its own loss. Of all the possible variant he wants to select the lexicographically minimal one, where an empty slot is lexicographically less than a charged one. More formally, the cylinder of n bullet slots able to contain k bullets can be represented as a string of n characters. Exactly k of them are ""X"" (charged slots) and the others are ""."" (uncharged slots). Let us describe the process of a shot. Suppose that the trigger is in front of the first character of the string (the first slot). If a shot doesn\'t kill anyone and the cylinder shifts, then the string shifts left. So the first character becomes the last one, the second character becomes the first one, and so on. But the trigger doesn\'t move. It will be in front of the first character of the resulting string.Among all the strings that give the minimal probability of loss, Sasha choose the lexicographically minimal one. According to this very string, he charges the gun. You have to help Sasha to charge the gun. For that, each xi query must be answered: is there a bullet in the positions xi?" 2000

87B "Vasya and Types" implementation,strings "After all the events in Orlando we all know, Sasha and Roma decided to find out who is still the team\'s biggest loser. Thankfully, Masha found somewhere a revolver with a rotating cylinder of n bullet slots able to contain exactly k bullets, now the boys have a chance to resolve the problem once and for all. Sasha selects any k out of n slots he wishes and puts bullets there. Roma spins the cylinder so that every of n possible cylinder\'s shifts is equiprobable. Then the game starts, the players take turns, Sasha starts: he puts the gun to his head and shoots. If there was no bullet in front of the trigger, the cylinder shifts by one position and the weapon is given to Roma for make the same move. The game continues until someone is shot, the survivor is the winner. Sasha does not want to lose, so he must choose slots for bullets in such a way as to minimize the probability of its own loss. Of all the possible variant he wants to select the lexicographically minimal one, where an empty slot is lexicographically less than a charged one. More formally, the cylinder of n bullet slots able to contain k bullets can be represented as a string of n characters. Exactly k of them are ""X"" (charged slots) and the others are ""."" (uncharged slots). Let us describe the process of a shot. Suppose that the trigger is in front of the first character of the string (the first slot). If a shot doesn\'t kill anyone and the cylinder shifts, then the string shifts left. So the first character becomes the last one, the second character becomes the first one, and so on. But the trigger doesn\'t move. It will be in front of the first character of the resulting string.Among all the strings that give the minimal probability of loss, Sasha choose the lexicographically minimal one. According to this very string, he charges the gun. You have to help Sasha to charge the gun. For that, each xi query must be answered: is there a bullet in the positions xi?" 1800

87A Trains implementation,math "After all the events in Orlando we all know, Sasha and Roma decided to find out who is still the team\'s biggest loser. Thankfully, Masha found somewhere a revolver with a rotating cylinder of n bullet slots able to contain exactly k bullets, now the boys have a chance to resolve the problem once and for all. Sasha selects any k out of n slots he wishes and puts bullets there. Roma spins the cylinder so that every of n possible cylinder\'s shifts is equiprobable. Then the game starts, the players take turns, Sasha starts: he puts the gun to his head and shoots. If there was no bullet in front of the trigger, the cylinder shifts by one position and the weapon is given to Roma for make the same move. The game continues until someone is shot, the survivor is the winner. Sasha does not want to lose, so he must choose slots for bullets in such a way as to minimize the probability of its own loss. Of all the possible variant he wants to select the lexicographically minimal one, where an empty slot is lexicographically less than a charged one. More formally, the cylinder of n bullet slots able to contain k bullets can be represented as a string of n characters. Exactly k of them are ""X"" (charged slots) and the others are ""."" (uncharged slots). Let us describe the process of a shot. Suppose that the trigger is in front of the first character of the string (the first slot). If a shot doesn\'t kill anyone and the cylinder shifts, then the string shifts left. So the first character becomes the last one, the second character becomes the first one, and so on. But the trigger doesn\'t move. It will be in front of the first character of the resulting string.Among all the strings that give the minimal probability of loss, Sasha choose the lexicographically minimal one. According to this very string, he charges the gun. You have to help Sasha to charge the gun. For that, each xi query must be answered: is there a bullet in the positions xi?" 1500

86E "Long sequence" "brute force,math,matrices" "After all the events in Orlando we all know, Sasha and Roma decided to find out who is still the team\'s biggest loser. Thankfully, Masha found somewhere a revolver with a rotating cylinder of n bullet slots able to contain exactly k bullets, now the boys have a chance to resolve the problem once and for all. Sasha selects any k out of n slots he wishes and puts bullets there. Roma spins the cylinder so that every of n possible cylinder\'s shifts is equiprobable. Then the game starts, the players take turns, Sasha starts: he puts the gun to his head and shoots. If there was no bullet in front of the trigger, the cylinder shifts by one position and the weapon is given to Roma for make the same move. The game continues until someone is shot, the survivor is the winner. Sasha does not want to lose, so he must choose slots for bullets in such a way as to minimize the probability of its own loss. Of all the possible variant he wants to select the lexicographically minimal one, where an empty slot is lexicographically less than a charged one. More formally, the cylinder of n bullet slots able to contain k bullets can be represented as a string of n characters. Exactly k of them are ""X"" (charged slots) and the others are ""."" (uncharged slots). Let us describe the process of a shot. Suppose that the trigger is in front of the first character of the string (the first slot). If a shot doesn\'t kill anyone and the cylinder shifts, then the string shifts left. So the first character becomes the last one, the second character becomes the first one, and so on. But the trigger doesn\'t move. It will be in front of the first character of the resulting string.Among all the strings that give the minimal probability of loss, Sasha choose the lexicographically minimal one. According to this very string, he charges the gun. You have to help Sasha to charge the gun. For that, each xi query must be answered: is there a bullet in the positions xi?" 2700

86D "Powerful array" "data structures,implementation,math,two pointers" "After all the events in Orlando we all know, Sasha and Roma decided to find out who is still the team\'s biggest loser. Thankfully, Masha found somewhere a revolver with a rotating cylinder of n bullet slots able to contain exactly k bullets, now the boys have a chance to resolve the problem once and for all. Sasha selects any k out of n slots he wishes and puts bullets there. Roma spins the cylinder so that every of n possible cylinder\'s shifts is equiprobable. Then the game starts, the players take turns, Sasha starts: he puts the gun to his head and shoots. If there was no bullet in front of the trigger, the cylinder shifts by one position and the weapon is given to Roma for make the same move. The game continues until someone is shot, the survivor is the winner. Sasha does not want to lose, so he must choose slots for bullets in such a way as to minimize the probability of its own loss. Of all the possible variant he wants to select the lexicographically minimal one, where an empty slot is lexicographically less than a charged one. More formally, the cylinder of n bullet slots able to contain k bullets can be represented as a string of n characters. Exactly k of them are ""X"" (charged slots) and the others are ""."" (uncharged slots). Let us describe the process of a shot. Suppose that the trigger is in front of the first character of the string (the first slot). If a shot doesn\'t kill anyone and the cylinder shifts, then the string shifts left. So the first character becomes the last one, the second character becomes the first one, and so on. But the trigger doesn\'t move. It will be in front of the first character of the resulting string.Among all the strings that give the minimal probability of loss, Sasha choose the lexicographically minimal one. According to this very string, he charges the gun. You have to help Sasha to charge the gun. For that, each xi query must be answered: is there a bullet in the positions xi?" 2200

86C "Genetic engineering" "dp,string suffix structures,trees" """Multidimensional spaces are completely out of style these days, unlike genetics problems"" \xe2\x80\x94 thought physicist Woll and changed his subject of study to bioinformatics. Analysing results of sequencing he faced the following problem concerning DNA sequences. We will further think of a DNA sequence as an arbitrary string of uppercase letters ""A"", ""C"", ""G"" and ""T"" (of course, this is a simplified interpretation).Let w be a long DNA sequence and s1,\xe2\x80\x89s2,\xe2\x80\x89...,\xe2\x80\x89sm \xe2\x80\x94 collection of short DNA sequences. Let us say that the collection filters w iff w can be covered with the sequences from the collection. Certainly, substrings corresponding to the different positions of the string may intersect or even cover each other. More formally: denote by |w| the length of w, let symbols of w be numbered from 1 to |w|. Then for each position i in w there exist pair of indices l,\xe2\x80\x89r (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|w|) such that the substring w[l�...�r] equals one of the elements s1,\xe2\x80\x89s2,\xe2\x80\x89...,\xe2\x80\x89sm of the collection.Woll wants to calculate the number of DNA sequences of a given length filtered by a given collection, but he doesn\'t know how to deal with it. Help him! Your task is to find the number of different DNA sequences of length n filtered by the collection {si}.Answer may appear very large, so output it modulo 1000000009." 2500

86B "Tetris revisited" "constructive algorithms,graph matchings,greedy,math" "Physicist Woll likes to play one relaxing game in between his search of the theory of everything.Game interface consists of a rectangular n\xe2\x80\x89\xc3\x97\xe2\x80\x89m playing field and a dashboard. Initially some cells of the playing field are filled while others are empty. Dashboard contains images of all various connected (we mean connectivity by side) figures of 2, 3, 4 and 5 cells, with all their rotations and reflections. Player can copy any figure from the dashboard and place it anywhere at the still empty cells of the playing field. Of course any figure can be used as many times as needed.Woll\'s aim is to fill the whole field in such a way that there are no empty cells left, and also... just have some fun.Every initially empty cell should be filled with exactly one cell of some figure. Every figure should be entirely inside the board.  In the picture black cells stand for initially filled cells of the field, and one-colour regions represent the figures." 2200

86A Reflection math "For each positive integer n consider the integer \xcf\x88(n) which is obtained from n by replacing every digit a in the decimal notation of n with the digit (9\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x89\xe2\x80\x89a). We say that \xcf\x88(n) is the reflection of n. For example, reflection of 192 equals 807. Note that leading zeros (if any) should be omitted. So reflection of 9 equals 0, reflection of 91 equals 8.Let us call the weight of the number the product of the number and its reflection. Thus, the weight of the number 10 is equal to 10\xc2\xb789\xe2\x80\x89=\xe2\x80\x89890.Your task is to find the maximum weight of the numbers in the given range [l,\xe2\x80\x89r] (boundaries are included)." 1600

85E "Guard Towers" "binary search,dsu,geometry,graphs,sortings" "In a far away kingdom lives a very greedy king. To defend his land, he built n guard towers. Apart from the towers the kingdom has two armies, each headed by a tyrannical and narcissistic general. The generals can\'t stand each other, specifically, they will never let soldiers of two armies be present in one tower.During defence operations to manage a guard tower a general has to send part of his army to that tower. Each general asks some fee from the king for managing towers. As they live in a really far away kingdom, each general evaluates his fee in the following weird manner: he finds two remotest (the most distant) towers, where the soldiers of his army are situated and asks for the fee equal to the distance. Each tower is represented by a point on the plane with coordinates (x,\xe2\x80\x89y), and the distance between two points with coordinates (x1,\xe2\x80\x89y1) and (x2,\xe2\x80\x89y2) is determined in this kingdom as |x1\xe2\x80\x89-\xe2\x80\x89x2|\xe2\x80\x89+\xe2\x80\x89|y1\xe2\x80\x89-\xe2\x80\x89y2|.The greedy king was not exactly satisfied with such a requirement from the generals, that\'s why he only agreed to pay one fee for two generals, equal to the maximum of two demanded fees. However, the king is still green with greed, and among all the ways to arrange towers between armies, he wants to find the cheapest one. Each tower should be occupied by soldiers of exactly one army.He hired you for that. You should find the minimum amount of money that will be enough to pay the fees. And as the king is also very scrupulous, you should also count the number of arrangements that will cost the same amount of money. As their number can be quite large, it is enough for the king to know it as a remainder from dividing by 109\xe2\x80\x89+\xe2\x80\x897.Two arrangements are distinct if the sets of towers occupied by soldiers of the first general are distinct." 2600

85D "Sum of Medians" "binary search,brute force,data structures,implementation" "In one well-known algorithm of finding the k-th order statistics we should divide all elements into groups of five consecutive elements and find the median of each five. A median is called the middle element of a sorted array (it\'s the third largest element for a group of five). To increase the algorithm\'s performance speed on a modern video card, you should be able to find a sum of medians in each five of the array.A sum of medians of a sorted k-element set S\xe2\x80\x89=\xe2\x80\x89{a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89ak}, where a1\xe2\x80\x89<\xe2\x80\x89a2\xe2\x80\x89<\xe2\x80\x89a3\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89ak, will be understood by as The  operator stands for taking the remainder, that is  stands for the remainder of dividing x by y.To organize exercise testing quickly calculating the sum of medians for a changing set was needed." 2300

85C "Petya and Tree" "binary search,dfs and similar,probabilities,sortings,trees" "One night, having had a hard day at work, Petya saw a nightmare. There was a binary search tree in the dream. But it was not the actual tree that scared Petya. The horrifying thing was that Petya couldn\'t search for elements in this tree. Petya tried many times to choose key and look for it in the tree, and each time he arrived at a wrong place. Petya has been racking his brains for long, choosing keys many times, but the result was no better. But the moment before Petya would start to despair, he had an epiphany: every time he was looking for keys, the tree didn\'t have the key, and occured exactly one mistake. ""That\'s not a problem!"", thought Petya. ""Why not count the expectation value of an element, which is found when I search for the key"". The moment he was about to do just that, however, Petya suddenly woke up.Thus, you are given a binary search tree, that is a tree containing some number written in the node. This number is called the node key. The number of children of every node of the tree is equal either to 0 or to 2. The nodes that have 0 children are called leaves and the nodes that have 2 children, are called inner. An inner node has the left child, that is the child whose key is less than the current node\'s key, and the right child, whose key is more than the current node\'s key. Also, a key of any node is strictly larger than all the keys of the left subtree of the node and strictly smaller than all the keys of the right subtree of the node.Also you are given a set of search keys, all of which are distinct and differ from the node keys contained in the tree. For each key from the set its search in the tree is realised. The search is arranged like this: initially we are located in the tree root, if the key of the current node is larger that our search key, then we move to the left child of the node, otherwise we go to the right child of the node and the process is repeated. As it is guaranteed that the search key is not contained in the tree, the search will always finish in some leaf. The key lying in the leaf is declared the search result.It is known for sure that during the search we make a mistake in comparing exactly once, that is we go the wrong way, but we won\'t make any mistakes later. All possible mistakes are equiprobable, that is we should consider all such searches where exactly one mistake occurs. Your task is to find the expectation (the average value) of the search result for every search key, considering that exactly one mistake occurs in the search. That is, for a set of paths containing exactly one mistake in the given key search, you should count the average value of keys containing in the leaves of those paths." 2200

85B "Embassy Queue" "data structures,greedy" "In an embassy of a well-known kingdom an electronic queue is organised. Every person who comes to the embassy, needs to make the following three actions: show the ID, pay money to the cashier and be fingerprinted. Besides, the actions should be performed in the given order.For each action several separate windows are singled out: k1 separate windows for the first action (the first type windows), k2 windows for the second one (the second type windows), and k3 for the third one (the third type windows). The service time for one person in any of the first type window equals to t1. Similarly, it takes t2 time to serve a person in any of the second type windows. And it takes t3 to serve one person in any of the third type windows. Thus, the service time depends only on the window type and is independent from the person who is applying for visa.At some moment n people come to the embassy, the i-th person comes at the moment of time ci. The person is registered under some number. After that he sits in the hall and waits for his number to be shown on a special board. Besides the person\'s number the board shows the number of the window where one should go and the person goes there immediately. Let\'s consider that the time needed to approach the window is negligible. The table can show information for no more than one person at a time. The electronic queue works so as to immediately start working with the person who has approached the window, as there are no other people in front of the window.The Client Service Quality inspectors noticed that several people spend too much time in the embassy (this is particularly tiresome as the embassy has no mobile phone reception and 3G). It was decided to organise the system so that the largest time a person spends in the embassy were minimum. Help the inspectors organise the queue. Consider that all actions except for being served in at the window, happen instantly." 1800

85A Domino "constructive algorithms,implementation" "We all know the problem about the number of ways one can tile a 2\xe2\x80\x89\xc3\x97\xe2\x80\x89n field by 1\xe2\x80\x89\xc3\x97\xe2\x80\x892 dominoes. You probably remember that it goes down to Fibonacci numbers. We will talk about some other problem below, there you also are going to deal with tiling a rectangular field with dominoes.You are given a 4\xe2\x80\x89\xc3\x97\xe2\x80\x89n rectangular field, that is the field that contains four lines and n columns. You have to find for it any tiling by 1\xe2\x80\x89\xc3\x97\xe2\x80\x892 dominoes such that each of the n\xe2\x80\x89-\xe2\x80\x891 potential vertical cuts along the grid lines intersects at least one domino, splitting it in two. No two dominoes in the sought tiling should overlap, each square of the field should be covered by exactly one domino. It is allowed to rotate the dominoes, that is, you can use 2\xe2\x80\x89\xc3\x97\xe2\x80\x891 as well as 1\xe2\x80\x89\xc3\x97\xe2\x80\x892 dominoes.Write a program that finds an arbitrary sought tiling." 1300

84C Biathlon "binary search,implementation" "Perhaps many have heard that the World Biathlon Championship has finished. Although our hero Valera was not present at this spectacular event himself and only watched it on TV, it excited him so much that he decided to enroll in a biathlon section.Of course, biathlon as any sport, proved very difficult in practice. It takes much time and effort. Workouts, workouts, and workouts, \xe2\x80\x94 that\'s what awaited Valera on his way to great achievements in biathlon.As for the workouts, you all probably know that every professional biathlete should ski fast and shoot precisely at the shooting range. Only in this case you can hope to be successful, because running and shooting are the two main components of biathlon. Valera has been diligent in his ski trainings, which is why he runs really fast, however, his shooting accuracy is nothing to write home about.On a biathlon base where Valera is preparing for the competition, there is a huge rifle range with n targets. Each target have shape of a circle, and the center of each circle is located on the Ox axis. At the last training session Valera made the total of m shots. To make monitoring of his own results easier for him, one rather well-known programmer (of course it is you) was commissioned to write a program that would reveal how many and which targets Valera hit. More specifically, for each target the program must print the number of the first successful shot (in the target), or ""-1"" if this was not hit. The target is considered hit if the shot is inside the circle or on its boundary. Valera is counting on you and perhaps, thanks to you he will one day win international competitions." 1700

84A "Toy Army" "math,number theory" "The hero of our story, Valera, and his best friend Arcady are still in school, and therefore they spend all the free time playing turn-based strategy ""GAGA: Go And Go Again"". The gameplay is as follows. There are two armies on the playing field each of which consists of n men (n is always even). The current player specifies for each of her soldiers an enemy\'s soldier he will shoot (a target) and then all the player\'s soldiers shot simultaneously. This is a game world, and so each soldier shoots perfectly, that is he absolutely always hits the specified target. If an enemy soldier is hit, he will surely die. It may happen that several soldiers had been indicated the same target. Killed soldiers do not participate in the game anymore. The game ""GAGA"" consists of three steps: first Valera makes a move, then Arcady, then Valera again and the game ends. You are asked to calculate the maximum total number of soldiers that may be killed during the game." 900

83E "Two Subsequences" bitmasks,dp "On an IT lesson Valera studied data compression. The teacher told about a new method, which we shall now describe to you.Let {a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an} be the given sequence of lines needed to be compressed. Here and below we shall assume that all lines are of the same length and consist only of the digits 0 and 1. Let\'s define the compression function:  f(empty sequence)\xe2\x80\x89=\xe2\x80\x89empty string  f(s)\xe2\x80\x89=\xe2\x80\x89s.  f(s1,\xe2\x80\x89s2)\xe2\x80\x89=\xe2\x80\x89 the smallest in length string, which has one of the prefixes equal to s1 and one of the suffixes equal to s2. For example, f(001,\xe2\x80\x89011)\xe2\x80\x89=\xe2\x80\x890011, f(111,\xe2\x80\x89011)\xe2\x80\x89=\xe2\x80\x89111011.  f(a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an)\xe2\x80\x89=\xe2\x80\x89f(f(a1,\xe2\x80\x89a2,\xe2\x80\x89an\xe2\x80\x89-\xe2\x80\x891),\xe2\x80\x89an). For example, f(000,\xe2\x80\x89000,\xe2\x80\x89111)\xe2\x80\x89=\xe2\x80\x89f(f(000,\xe2\x80\x89000),\xe2\x80\x89111)\xe2\x80\x89=\xe2\x80\x89f(000,\xe2\x80\x89111)\xe2\x80\x89=\xe2\x80\x89000111. Valera faces a real challenge: he should divide the given sequence {a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an} into two subsequences {b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bk} and {c1,\xe2\x80\x89c2,\xe2\x80\x89...,\xe2\x80\x89cm}, m\xe2\x80\x89+\xe2\x80\x89k\xe2\x80\x89=\xe2\x80\x89n, so that the value of S\xe2\x80\x89=\xe2\x80\x89|f(b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bk)|\xe2\x80\x89+\xe2\x80\x89|f(c1,\xe2\x80\x89c2,\xe2\x80\x89...,\xe2\x80\x89cm)| took the minimum possible value. Here |p| denotes the length of the string p.Note that it is not allowed to change the relative order of lines in the subsequences. It is allowed to make one of the subsequences empty. Each string from the initial sequence should belong to exactly one subsequence. Elements of subsequences b and c don\'t have to be consecutive in the original sequence a, i. e. elements of b and c can alternate in a (see samples 2 and 3).Help Valera to find the minimum possible value of S." 2800

83D Numbers "dp,math,number theory" "One quite ordinary day Valera went to school (there\'s nowhere else he should go on a week day). In a maths lesson his favorite teacher Ms. Evans told students about divisors. Despite the fact that Valera loved math, he didn\'t find this particular topic interesting. Even more, it seemed so boring that he fell asleep in the middle of a lesson. And only a loud ringing of a school bell could interrupt his sweet dream. Of course, the valuable material and the teacher\'s explanations were lost. However, Valera will one way or another have to do the homework. As he does not know the new material absolutely, he cannot do the job himself. That\'s why he asked you to help. You\'re his best friend after all, you just cannot refuse to help. Valera\'s home task has only one problem, which, though formulated in a very simple way, has not a trivial solution. Its statement looks as follows: if we consider all positive integers in the interval [a;b] then it is required to count the amount of such numbers in this interval that their smallest divisor will be a certain integer k (you do not have to consider divisor equal to one). In other words, you should count the amount of such numbers from the interval [a;b], that are not divisible by any number between 2 and k\xe2\x80\x89-\xe2\x80\x891 and yet are divisible by k." 2400

83C Track "graphs,greedy,shortest paths" "You already know that Valery\'s favorite sport is biathlon. Due to your help, he learned to shoot without missing, and his skills are unmatched at the shooting range. But now a smaller task is to be performed, he should learn to complete the path fastest.The track\'s map is represented by a rectangle n\xe2\x80\x89\xc3\x97\xe2\x80\x89m in size divided into squares. Each square is marked with a lowercase Latin letter (which means the type of the plot), with the exception of the starting square (it is marked with a capital Latin letters S) and the terminating square (it is marked with a capital Latin letter T). The time of movement from one square to another is equal to 1 minute. The time of movement within the cell can be neglected. We can move from the cell only to side-adjacent ones, but it is forbidden to go beyond the map edges. Also the following restriction is imposed on the path: it is not allowed to visit more than k different types of squares (squares of one type can be visited an infinite number of times). Squares marked with S and T have no type, so they are not counted. But S must be visited exactly once \xe2\x80\x94 at the very beginning, and T must be visited exactly once \xe2\x80\x94 at the very end.Your task is to find the path from the square S to the square T that takes minimum time. Among all shortest paths you should choose the lexicographically minimal one. When comparing paths you should lexicographically represent them as a sequence of characters, that is, of plot types." 2400

83B Doctor "binary search,math,sortings" "There are n animals in the queue to Dr. Dolittle. When an animal comes into the office, the doctor examines him, gives prescriptions, appoints tests and may appoint extra examination. Doc knows all the forest animals perfectly well and therefore knows exactly that the animal number i in the queue will have to visit his office exactly ai times. We will assume that an examination takes much more time than making tests and other extra procedures, and therefore we will assume that once an animal leaves the room, it immediately gets to the end of the queue to the doctor. Of course, if the animal has visited the doctor as many times as necessary, then it doesn\'t have to stand at the end of the queue and it immediately goes home. Doctor plans to go home after receiving k animals, and therefore what the queue will look like at that moment is important for him. Since the doctor works long hours and she can\'t get distracted like that after all, she asked you to figure it out." 1800

83A "Magical Array" math "Valery is very interested in magic. Magic attracts him so much that he sees it everywhere. He explains any strange and weird phenomenon through intervention of supernatural forces. But who would have thought that even in a regular array of numbers Valera manages to see something beautiful and magical.Valera absolutely accidentally got a piece of ancient parchment on which an array of numbers was written. He immediately thought that the numbers in this array were not random. As a result of extensive research Valera worked out a wonderful property that a magical array should have: an array is defined as magic if its minimum and maximum coincide.He decided to share this outstanding discovery with you, but he asks you for help in return. Despite the tremendous intelligence and wit, Valera counts very badly and so you will have to complete his work. All you have to do is count the number of magical subarrays of the original array of numbers, written on the parchment. Subarray is defined as non-empty sequence of consecutive elements." 1300

82E Corridor geometry "Consider a house plan. Let the house be represented by an infinite horizontal strip defined by the inequality \xe2\x80\x89-\xe2\x80\x89h\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89h. Strictly outside the house there are two light sources at the points (0,\xe2\x80\x89f) and (0,\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x89f). Windows are located in the walls, the windows are represented by segments on the lines y\xe2\x80\x89=\xe2\x80\x89h and y\xe2\x80\x89=\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x89h. Also, the windows are arranged symmetrically about the line y\xe2\x80\x89=\xe2\x80\x890.Your task is to find the area of the floor at the home, which will be lighted by the sources of light." 2600

82D "Two out of Three" dp "Vasya has recently developed a new algorithm to optimize the reception of customer flow and he considered the following problem.Let the queue to the cashier contain n people, at that each of them is characterized by a positive integer ai \xe2\x80\x94 that is the time needed to work with this customer. What is special about this very cashier is that it can serve two customers simultaneously. However, if two customers need ai and aj of time to be served, the time needed to work with both of them customers is equal to max(ai,\xe2\x80\x89aj). Please note that working with customers is an uninterruptable process, and therefore, if two people simultaneously come to the cashier, it means that they begin to be served simultaneously, and will both finish simultaneously (it is possible that one of them will have to wait).Vasya used in his algorithm an ingenious heuristic \xe2\x80\x94 as long as the queue has more than one person waiting, then some two people of the first three standing in front of the queue are sent simultaneously. If the queue has only one customer number i, then he goes to the cashier, and is served within ai of time. Note that the total number of phases of serving a customer will always be equal to \xe2\x8c\x88n\xe2\x80\x89/\xe2\x80\x892\xe2\x8c\x89.Vasya thinks that this method will help to cope with the queues we all hate. That\'s why he asked you to work out a program that will determine the minimum time during which the whole queue will be served using this algorithm." 2000

82C "General Mobilization" "data structures,dfs and similar,sortings" "The Berland Kingdom is a set of n cities connected with each other with n\xe2\x80\x89-\xe2\x80\x891 railways. Each road connects exactly two different cities. The capital is located in city 1. For each city there is a way to get from there to the capital by rail.In the i-th city there is a soldier division number i, each division is characterized by a number of ai. It represents the priority, the smaller the number, the higher the priority of this division. All values of ai are different.One day the Berland King Berl Great declared a general mobilization, and for that, each division should arrive in the capital. Every day from every city except the capital a train departs. So there are exactly n\xe2\x80\x89-\xe2\x80\x891 departing trains each day. Each train moves toward the capital and finishes movement on the opposite endpoint of the railway on the next day. It has some finite capacity of cj, expressed in the maximum number of divisions, which this train can transport in one go. Each train moves in the direction of reducing the distance to the capital. So each train passes exactly one railway moving from a city to the neighboring (where it stops) toward the capital.In the first place among the divisions that are in the city, division with the smallest number of ai get on the train, then with the next smallest and so on, until either the train is full or all the divisions are be loaded. So it is possible for a division to stay in a city for a several days.The duration of train\'s progress from one city to another is always equal to 1 day. All divisions start moving at the same time and end up in the capital, from where they don\'t go anywhere else any more. Each division moves along a simple path from its city to the capital, regardless of how much time this journey will take.Your goal is to find for each division, in how many days it will arrive to the capital of Berland. The countdown begins from day 0." 2000

82B Sets "constructive algorithms,hashing,implementation" "Little Vasya likes very much to play with sets consisting of positive integers. To make the game more interesting, Vasya chose n non-empty sets in such a way, that no two of them have common elements.One day he wanted to show his friends just how interesting playing with numbers is. For that he wrote out all possible unions of two different sets on n\xc2\xb7(n\xe2\x80\x89-\xe2\x80\x891)\xe2\x80\x89/\xe2\x80\x892 pieces of paper. Then he shuffled the pieces of paper. He had written out the numbers in the unions in an arbitrary order.For example, if n\xe2\x80\x89=\xe2\x80\x894, and the actual sets have the following form {1,\xe2\x80\x893}, {5}, {2,\xe2\x80\x894}, {7}, then the number of set pairs equals to six. The six pieces of paper can contain the following numbers:   2,\xe2\x80\x897,\xe2\x80\x894.  1,\xe2\x80\x897,\xe2\x80\x893;  5,\xe2\x80\x894,\xe2\x80\x892;  1,\xe2\x80\x893,\xe2\x80\x895;  3,\xe2\x80\x891,\xe2\x80\x892,\xe2\x80\x894;  5,\xe2\x80\x897. Then Vasya showed the pieces of paper to his friends, but kept the n sets secret from them. His friends managed to calculate which sets Vasya had thought of in the first place. And how about you, can you restore the sets by the given pieces of paper?" 1700

82A "Double Cola" implementation,math "Sheldon, Leonard, Penny, Rajesh and Howard are in the queue for a ""Double Cola"" drink vending machine; there are no other people in the queue. The first one in the queue (Sheldon) buys a can, drinks it and doubles! The resulting two Sheldons go to the end of the queue. Then the next in the queue (Leonard) buys a can, drinks it and gets to the end of the queue as two Leonards, and so on. This process continues ad infinitum.For example, Penny drinks the third can of cola and the queue will look like this: Rajesh, Howard, Sheldon, Sheldon, Leonard, Leonard, Penny, Penny.Write a program that will print the name of a man who will drink the n-th can.Note that in the very beginning the queue looks like that: Sheldon, Leonard, Penny, Rajesh, Howard. The first person is Sheldon." 1100

81E Pairs "dfs and similar,dp,dsu,graphs,implementation,trees" "There are n students in Polycarp\'s class (including himself). A few days ago all students wrote an essay ""My best friend"". Each student\'s essay was dedicated to one of the students of class, to his/her best friend. Note that student b\'s best friend is not necessarily student a, if a\'s best friend is b.And now the teacher leads the whole class to the museum of the history of sports programming. Exciting stories of legendary heroes await the students: tourist, Petr, tomek, SnapDragon \xe2\x80\x94 that\'s who they will hear about!The teacher decided to divide students into pairs so that each pair consisted of a student and his best friend. She may not be able to split all the students into pairs, it\'s not a problem \xe2\x80\x94 she wants to pick out the maximum number of such pairs. If there is more than one variant of doing so, she wants to pick out the pairs so that there were as much boy-girl pairs as possible. Of course, each student must not be included in more than one pair." 2700

81D "Polycarp\'s Picture Gallery" "constructive algorithms,greedy" "There are n students in Polycarp\'s class (including himself). A few days ago all students wrote an essay ""My best friend"". Each student\'s essay was dedicated to one of the students of class, to his/her best friend. Note that student b\'s best friend is not necessarily student a, if a\'s best friend is b.And now the teacher leads the whole class to the museum of the history of sports programming. Exciting stories of legendary heroes await the students: tourist, Petr, tomek, SnapDragon \xe2\x80\x94 that\'s who they will hear about!The teacher decided to divide students into pairs so that each pair consisted of a student and his best friend. She may not be able to split all the students into pairs, it\'s not a problem \xe2\x80\x94 she wants to pick out the maximum number of such pairs. If there is more than one variant of doing so, she wants to pick out the pairs so that there were as much boy-girl pairs as possible. Of course, each student must not be included in more than one pair." 2100

81C "Average Score" greedy,math,sortings "After the educational reform Polycarp studies only two subjects at school, Safety Studies and PE (Physical Education). During the long months of the fourth term, he received n marks in them. When teachers wrote a mark in the journal, they didn\'t write in what subject the mark was for, they just wrote the mark.Now it\'s time to show the journal to his strict parents. Polycarp knows that recently at the Parent Meeting the parents were told that he received a Safety Studies marks and b PE marks (a\xe2\x80\x89+\xe2\x80\x89b\xe2\x80\x89=\xe2\x80\x89n). Now Polycarp wants to write a subject\'s name in front of each mark so that:   there are exactly a Safety Studies marks,  there are exactly b PE marks,  the total average score in both subjects is maximum. An average subject grade is the sum of all marks in it, divided by the number of them. Of course, the division is performed in real numbers without rounding up or down. Polycarp aims to maximize the x1\xe2\x80\x89+\xe2\x80\x89x2, where x1 is the average score in the first subject (Safety Studies), and x2 is the average score in the second one (Physical Education)." 1700

81B "Sequence Formatting" implementation,strings "Polycarp is very careful. He even types numeric sequences carefully, unlike his classmates. If he sees a sequence without a space after the comma, with two spaces in a row, or when something else does not look neat, he rushes to correct it. For example, number sequence written like ""1,2�,3,...,���10"" will be corrected to ""1,�2,�3,�...,�10"".In this task you are given a string s, which is composed by a concatination of terms, each of which may be:   a positive integer of an arbitrary length (leading zeroes are not allowed),  a ""comma"" symbol ("",""),  a ""space"" symbol ("" ""),  ""three dots"" (""..."", that is, exactly three points written one after another, also known as suspension points). Polycarp wants to add and remove spaces in the string s to ensure the following:   each comma is followed by exactly one space (if the comma is the last character in the string, this rule does not apply to it),  each ""three dots"" term is preceded by exactly one space (if the dots are at the beginning of the string, this rule does not apply to the term),  if two consecutive numbers were separated by spaces only (one or more), then exactly one of them should be left,  there should not be other spaces. Automate Polycarp\'s work and write a program that will process the given string s." 1700

81A Plug-in implementation "Polycarp thinks about the meaning of life very often. He does this constantly, even when typing in the editor. Every time he starts brooding he can no longer fully concentrate and repeatedly presses the keys that need to be pressed only once. For example, instead of the phrase ""how are you"" he can type ""hhoow aaaare yyoouu"". Polycarp decided to automate the process of correcting such errors. He decided to write a plug-in to the text editor that will remove pairs of identical consecutive letters (if there are any in the text). Of course, this is not exactly what Polycarp needs, but he\'s got to start from something! Help Polycarp and write the main plug-in module. Your program should remove from a string all pairs of identical letters, which are consecutive. If after the removal there appear new pairs, the program should remove them as well. Technically, its work should be equivalent to the following: while the string contains a pair of consecutive identical letters, the pair should be deleted. Note that deleting of the consecutive identical letters can be done in any order, as any order leads to the same result." 1400

80B Depression geometry,math "Do you remember a kind cartoon ""Beauty and the Beast""? No, no, there was no firing from machine guns or radiation mutants time-travels!There was a beauty named Belle. Once she had violated the Beast\'s order and visited the West Wing. After that she was banished from the castle... Everybody was upset. The beautiful Belle was upset, so was the Beast, so was Lumiere the candlestick. But the worst thing was that Cogsworth was upset. Cogsworth is not a human, but is the mantel clock, which was often used as an alarm clock.Due to Cogsworth\'s frustration all the inhabitants of the castle were in trouble: now they could not determine when it was time to drink morning tea, and when it was time for an evening stroll. Fortunately, deep in the basement are lying digital clock showing the time in the format HH:MM. Now the residents of the castle face a difficult task. They should turn Cogsworth\'s hour and minute mustache hands in such a way, that Cogsworth began to show the correct time. Moreover they need to find turn angles in degrees for each mustache hands. The initial time showed by Cogsworth is 12:00.You can only rotate the hands forward, that is, as is shown in the picture:   As since there are many ways too select such angles because of full rotations, choose the smallest angles in the right (non-negative) direction.Note that Cogsworth\'s hour and minute mustache hands move evenly and continuously. Hands are moving independently, so when turning one hand the other hand remains standing still." 1200

80A "Panoramix\'s Prediction" "brute force" "Do you remember a kind cartoon ""Beauty and the Beast""? No, no, there was no firing from machine guns or radiation mutants time-travels!There was a beauty named Belle. Once she had violated the Beast\'s order and visited the West Wing. After that she was banished from the castle... Everybody was upset. The beautiful Belle was upset, so was the Beast, so was Lumiere the candlestick. But the worst thing was that Cogsworth was upset. Cogsworth is not a human, but is the mantel clock, which was often used as an alarm clock.Due to Cogsworth\'s frustration all the inhabitants of the castle were in trouble: now they could not determine when it was time to drink morning tea, and when it was time for an evening stroll. Fortunately, deep in the basement are lying digital clock showing the time in the format HH:MM. Now the residents of the castle face a difficult task. They should turn Cogsworth\'s hour and minute mustache hands in such a way, that Cogsworth began to show the correct time. Moreover they need to find turn angles in degrees for each mustache hands. The initial time showed by Cogsworth is 12:00.You can only rotate the hands forward, that is, as is shown in the picture:   As since there are many ways too select such angles because of full rotations, choose the smallest angles in the right (non-negative) direction.Note that Cogsworth\'s hour and minute mustache hands move evenly and continuously. Hands are moving independently, so when turning one hand the other hand remains standing still." 800

79E "Security System" math "Fox Ciel safely returned to her castle, but there was something wrong with the security system of the castle: sensors attached in the castle were covering her.Ciel is at point (1,\xe2\x80\x891) of the castle now, and wants to move to point (n,\xe2\x80\x89n), which is the position of her room. By one step, Ciel can move from point (x,\xe2\x80\x89y) to either (x\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89y) (rightward) or (x,\xe2\x80\x89y\xe2\x80\x89+\xe2\x80\x891) (upward).In her castle, c2 sensors are set at points (a\xe2\x80\x89+\xe2\x80\x89i,\xe2\x80\x89b\xe2\x80\x89+\xe2\x80\x89j) (for every integer i and j such that: 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89c,\xe2\x80\x890\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89<\xe2\x80\x89c).Each sensor has a count value and decreases its count value every time Ciel moves. Initially, the count value of each sensor is t. Every time Ciel moves to point (x,\xe2\x80\x89y), the count value of a sensor at point (u,\xe2\x80\x89v) decreases by (|u\xe2\x80\x89-\xe2\x80\x89x|\xe2\x80\x89+\xe2\x80\x89|v\xe2\x80\x89-\xe2\x80\x89y|). When the count value of some sensor becomes strictly less than 0, the sensor will catch Ciel as a suspicious individual!Determine whether Ciel can move from (1,\xe2\x80\x891) to (n,\xe2\x80\x89n) without being caught by a sensor, and if it is possible, output her steps. Assume that Ciel can move to every point even if there is a censor on the point." 2900

79D Password "bitmasks,dp,shortest paths" "Finally Fox Ciel arrived in front of her castle!She have to type a password to enter her castle. An input device attached to her castle is a bit unusual.The input device is a 1\xe2\x80\x89\xc3\x97\xe2\x80\x89n rectangle divided into n square panels. They are numbered 1 to n from left to right. Each panel has a state either ON or OFF. Initially all panels are in the OFF state. She can enter her castle if and only if x1-th, x2-th, ..., xk-th panels are in the ON state and other panels are in the OFF state.She is given an array a1, ..., al. In each move, she can perform the following operation: choose an index i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l), choose consecutive ai panels, and flip the states of those panels (i.e. ON\xe2\x80\x89\xe2\x86\x92\xe2\x80\x89OFF, OFF\xe2\x80\x89\xe2\x86\x92\xe2\x80\x89ON).Unfortunately she forgets how to type the password with only above operations. Determine the minimal number of operations required to enter her castle." 2800

79C Beaver "data structures,dp,greedy,hashing,strings,two pointers" "After Fox Ciel got off a bus, she found that the bus she was on was a wrong bus and she lost her way in a strange town. However, she fortunately met her friend Beaver Taro and asked which way to go to her castle. Taro\'s response to her was a string s, and she tried to remember the string s correctly.However, Ciel feels n strings b1,\xe2\x80\x89b2,\xe2\x80\x89... ,\xe2\x80\x89bn are really boring, and unfortunately she dislikes to remember a string that contains a boring substring. To make the thing worse, what she can remember is only the contiguous substring of s.Determine the longest contiguous substring of s that does not contain any boring string, so that she can remember the longest part of Taro\'s response." 1800

79B "Colorful Field" implementation,sortings "Fox Ciel saw a large field while she was on a bus. The field was a n\xe2\x80\x89\xc3\x97\xe2\x80\x89m rectangle divided into 1\xe2\x80\x89\xc3\x97\xe2\x80\x891 cells. Some cells were wasteland, and other each cell contained crop plants: either carrots or kiwis or grapes. After seeing the field carefully, Ciel found that the crop plants of each cell were planted in following procedure:  Assume that the rows are numbered 1 to n from top to bottom and the columns are numbered 1 to m from left to right, and a cell in row i and column j is represented as (i,\xe2\x80\x89j).  First, each field is either cultivated or waste. Crop plants will be planted in the cultivated cells in the order of (1,\xe2\x80\x891)\xe2\x80\x89\xe2\x86\x92\xe2\x80\x89...\xe2\x80\x89\xe2\x86\x92\xe2\x80\x89(1,\xe2\x80\x89m)\xe2\x80\x89\xe2\x86\x92\xe2\x80\x89(2,\xe2\x80\x891)\xe2\x80\x89\xe2\x86\x92\xe2\x80\x89...\xe2\x80\x89\xe2\x86\x92\xe2\x80\x89(2,\xe2\x80\x89m)\xe2\x80\x89\xe2\x86\x92\xe2\x80\x89...\xe2\x80\x89\xe2\x86\x92\xe2\x80\x89(n,\xe2\x80\x891)\xe2\x80\x89\xe2\x86\x92\xe2\x80\x89...\xe2\x80\x89\xe2\x86\x92\xe2\x80\x89(n,\xe2\x80\x89m). Waste cells will be ignored.  Crop plants (either carrots or kiwis or grapes) will be planted in each cell one after another cyclically. Carrots will be planted in the first cell, then kiwis in the second one, grapes in the third one, carrots in the forth one, kiwis in the fifth one, and so on. The following figure will show you the example of this procedure. Here, a white square represents a cultivated cell, and a black square represents a waste cell.  Now she is wondering how to determine the crop plants in some certain cells." 1400

79A "Bus Game" greedy "After Fox Ciel won an onsite round of a programming contest, she took a bus to return to her castle. The fee of the bus was 220 yen. She met Rabbit Hanako in the bus. They decided to play the following game because they got bored in the bus.  Initially, there is a pile that contains x 100-yen coins and y 10-yen coins.  They take turns alternatively. Ciel takes the first turn.  In each turn, they must take exactly 220 yen from the pile. In Ciel\'s turn, if there are multiple ways to take 220 yen, she will choose the way that contains the maximal number of 100-yen coins. In Hanako\'s turn, if there are multiple ways to take 220 yen, she will choose the way that contains the maximal number of 10-yen coins.  If Ciel or Hanako can\'t take exactly 220 yen from the pile, she loses.  Determine the winner of the game." 1200

78E Evacuation "flows,graphs,shortest paths" "They\'ve screwed something up yet again... In one nuclear reactor of a research station an uncontrolled reaction is in progress and explosion which will destroy the whole station will happen soon.The station is represented by a square n\xe2\x80\x89\xc3\x97\xe2\x80\x89n divided into 1\xe2\x80\x89\xc3\x97\xe2\x80\x891 blocks. Each block is either a reactor or a laboratory. There can be several reactors and exactly one of them will explode soon. The reactors can be considered impassable blocks, but one can move through laboratories. Between any two laboratories, which are in adjacent blocks, there is a corridor. Blocks are considered adjacent if they have a common edge.In each laboratory there is some number of scientists and some number of rescue capsules. Once the scientist climbs into a capsule, he is considered to be saved. Each capsule has room for not more than one scientist.The reactor, which is about to explode, is damaged and a toxic coolant trickles from it into the neighboring blocks. The block, which contains the reactor, is considered infected. Every minute the coolant spreads over the laboratories through corridors. If at some moment one of the blocks is infected, then the next minute all the neighboring laboratories also become infected. Once a lab is infected, all the scientists there that are not in rescue capsules die. The coolant does not spread through reactor blocks.There are exactly t minutes to the explosion. Any scientist in a minute can move down the corridor to the next lab, if it is not infected. On any corridor an unlimited number of scientists can simultaneously move in both directions. It is believed that the scientists inside a lab moves without consuming time. Moreover, any scientist could get into the rescue capsule instantly. It is also believed that any scientist at any given moment always has the time to perform their actions (move from the given laboratory into the next one, or climb into the rescue capsule) before the laboratory will be infected.Find the maximum number of scientists who will be able to escape." 2300

78D "Archer\'s Shot" "binary search,geometry,math,two pointers" "They\'ve screwed something up yet again... In one nuclear reactor of a research station an uncontrolled reaction is in progress and explosion which will destroy the whole station will happen soon.The station is represented by a square n\xe2\x80\x89\xc3\x97\xe2\x80\x89n divided into 1\xe2\x80\x89\xc3\x97\xe2\x80\x891 blocks. Each block is either a reactor or a laboratory. There can be several reactors and exactly one of them will explode soon. The reactors can be considered impassable blocks, but one can move through laboratories. Between any two laboratories, which are in adjacent blocks, there is a corridor. Blocks are considered adjacent if they have a common edge.In each laboratory there is some number of scientists and some number of rescue capsules. Once the scientist climbs into a capsule, he is considered to be saved. Each capsule has room for not more than one scientist.The reactor, which is about to explode, is damaged and a toxic coolant trickles from it into the neighboring blocks. The block, which contains the reactor, is considered infected. Every minute the coolant spreads over the laboratories through corridors. If at some moment one of the blocks is infected, then the next minute all the neighboring laboratories also become infected. Once a lab is infected, all the scientists there that are not in rescue capsules die. The coolant does not spread through reactor blocks.There are exactly t minutes to the explosion. Any scientist in a minute can move down the corridor to the next lab, if it is not infected. On any corridor an unlimited number of scientists can simultaneously move in both directions. It is believed that the scientists inside a lab moves without consuming time. Moreover, any scientist could get into the rescue capsule instantly. It is also believed that any scientist at any given moment always has the time to perform their actions (move from the given laboratory into the next one, or climb into the rescue capsule) before the laboratory will be infected.Find the maximum number of scientists who will be able to escape." 2300

78C "Beaver Game" "dp,games,number theory" "Two beavers, Timur and Marsel, play the following game.There are n logs, each of exactly m meters in length. The beavers move in turns. For each move a beaver chooses a log and gnaws it into some number (more than one) of equal parts, the length of each one is expressed by an integer and is no less than k meters. Each resulting part is also a log which can be gnawed in future by any beaver. The beaver that can\'t make a move loses. Thus, the other beaver wins.Timur makes the first move. The players play in the optimal way. Determine the winner." 2000

78B "Easter Eggs" "constructive algorithms,implementation" "The Easter Rabbit laid n eggs in a circle and is about to paint them. Each egg should be painted one color out of 7: red, orange, yellow, green, blue, indigo or violet. Also, the following conditions should be satisfied:  Each of the seven colors should be used to paint at least one egg.  Any four eggs lying sequentially should be painted different colors. Help the Easter Rabbit paint the eggs in the required manner. We know that it is always possible." 1200

78A Haiku implementation,strings "Haiku is a genre of Japanese traditional poetry.A haiku poem consists of 17 syllables split into three phrases, containing 5, 7 and 5 syllables correspondingly (the first phrase should contain exactly 5 syllables, the second phrase should contain exactly 7 syllables, and the third phrase should contain exactly 5 syllables). A haiku masterpiece contains a description of a moment in those three phrases. Every word is important in a small poem, which is why haiku are rich with symbols. Each word has a special meaning, a special role. The main principle of haiku is to say much using a few words.To simplify the matter, in the given problem we will consider that the number of syllable in the phrase is equal to the number of vowel letters there. Only the following letters are regarded as vowel letters: ""a"", ""e"", ""i"", ""o"" and ""u"".Three phases from a certain poem are given. Determine whether it is haiku or not." 800

77E "Martian Food" geometry "Have you ever tasted Martian food? Well, you should.Their signature dish is served on a completely black plate with the radius of R, flat as a pancake.First, they put a perfectly circular portion of the Golden Honduras on the plate. It has the radius of r and is located as close to the edge of the plate as possible staying entirely within the plate. I. e. Golden Honduras touches the edge of the plate from the inside. It is believed that the proximity of the portion of the Golden Honduras to the edge of a plate demonstrates the neatness and exactness of the Martians.Then a perfectly round portion of Pink Guadeloupe is put on the plate. The Guadeloupe should not overlap with Honduras, should not go beyond the border of the plate, but should have the maximum radius. I. e. Pink Guadeloupe should touch the edge of the plate from the inside, and touch Golden Honduras from the outside. For it is the size of the Rose Guadeloupe that shows the generosity and the hospitality of the Martians.Further, the first portion (of the same perfectly round shape) of Green Bull Terrier is put on the plate. It should come in contact with Honduras and Guadeloupe, should not go beyond the border of the plate and should have maximum radius.Each of the following portions of the Green Bull Terrier must necessarily touch the Golden Honduras, the previous portion of the Green Bull Terrier and touch the edge of a plate, but should not go beyond the border.To determine whether a stranger is worthy to touch the food, the Martians ask him to find the radius of the k-th portion of the Green Bull Terrier knowing the radii of a plate and a portion of the Golden Honduras. And are you worthy?" 2800

77D "Domino Carpet" dp,implementation "...Mike the TV greets you again! Tired of the monotonous furniture? Sick of gray routine? Dreaming about dizzying changes in your humble abode? We have something to offer you! This domino carpet for only $99.99 will change your life! You can lay it on the floor, hang it on the wall or even on the ceiling! Among other things ... Having watched the commercial, virus Hexadecimal also wanted to get a Domino Carpet and wanted badly to be photographed in front of it. But of course, a virus will never consent to buying a licensed Carpet! So she ordered a truck of dominoes and decided to make such a Carpet herself. The original Domino Carpet is a field of squares n\xe2\x80\x89\xc3\x97\xe2\x80\x89m in size. Each square is half of a domino, and can be rotated either vertically or horizontally, independently from its neighbors. Vertically rotated domino halves look like this:    And horizontally rotated halves look like this:   Notice, that some halves looks the same in both rotations, but other halves differ.Dominoes bought by Hexadecimal are represented by uncuttable chips 1\xe2\x80\x89\xc3\x97\xe2\x80\x892 in size, which can be laid either vertically or horizontally. If the chip is laid vertically, then both of it\'s halves should be laid vertically orientated; if the chip is laid horizontally, then both of it\'s halves should be laid horizontally.The samples of valid and invalid dominoes laid vertically and horizontally are:    Virus Hexadecimal assembles her own Domino Carpet so that the following conditions are satisfied:  each carpet square is covered by a domino chip, i.e. there are no empty squares;  all domino chips lie entirely within the carpet and don\'t overlap with each other;  if there is a horizontal domino chip with its left half in column j then there are no horizontal domino chips with their left halves in columns j\xe2\x80\x89-\xe2\x80\x891 or j\xe2\x80\x89+\xe2\x80\x891. Before starting to assemble her own Domino Carpet, the virus wants to know the number of ways to achieve the intended purpose modulo 109\xe2\x80\x89+\xe2\x80\x897.You can assume that the virus has an infinitely large number of dominoes of each type." 2300

77C Beavermuncher-0xFF "dfs and similar,dp,dsu,greedy,trees" """Eat a beaver, save a tree!"" \xe2\x80\x94 That will be the motto of ecologists\' urgent meeting in Beaverley Hills.And the whole point is that the population of beavers on the Earth has reached incredible sizes! Each day their number increases in several times and they don\'t even realize how much their unhealthy obsession with trees harms the nature and the humankind. The amount of oxygen in the atmosphere has dropped to 17 per cent and, as the best minds of the world think, that is not the end.In the middle of the 50-s of the previous century a group of soviet scientists succeed in foreseeing the situation with beavers and worked out a secret technology to clean territory. The technology bears a mysterious title ""Beavermuncher-0xFF"". Now the fate of the planet lies on the fragile shoulders of a small group of people who has dedicated their lives to science.The prototype is ready, you now need to urgently carry out its experiments in practice. You are given a tree, completely occupied by beavers. A tree is a connected undirected graph without cycles. The tree consists of n vertices, the i-th vertex contains ki beavers. ""Beavermuncher-0xFF"" works by the following principle: being at some vertex u, it can go to the vertex v, if they are connected by an edge, and eat exactly one beaver located at the vertex v. It is impossible to move to the vertex v if there are no beavers left in v. ""Beavermuncher-0xFF"" cannot just stand at some vertex and eat beavers in it. ""Beavermuncher-0xFF"" must move without stops.Why does the ""Beavermuncher-0xFF"" works like this? Because the developers have not provided place for the battery in it and eating beavers is necessary for converting their mass into pure energy.It is guaranteed that the beavers will be shocked by what is happening, which is why they will not be able to move from a vertex of the tree to another one. As for the ""Beavermuncher-0xFF"", it can move along each edge in both directions while conditions described above are fulfilled.The root of the tree is located at the vertex s. This means that the ""Beavermuncher-0xFF"" begins its mission at the vertex s and it must return there at the end of experiment, because no one is going to take it down from a high place. Determine the maximum number of beavers ""Beavermuncher-0xFF"" can eat and return to the starting vertex." 2100

77B "Falling Anvils" math,probabilities "For some reason in many American cartoons anvils fall from time to time onto heroes\' heads. Of course, safes, wardrobes, cruisers, planes fall sometimes too... But anvils do so most of all.Anvils come in different sizes and shapes. Quite often they get the hero stuck deep in the ground. But have you ever thought who throws anvils from the sky? From what height? We are sure that such questions have never troubled you!It turns out that throwing an anvil properly is not an easy task at all. Let\'s describe one of the most popular anvil throwing models.Let the height p of the potential victim vary in the range [0;a] and the direction of the wind q vary in the range [\xe2\x80\x89-\xe2\x80\x89b;b]. p and q could be any real (floating) numbers. Then we can assume that the anvil will fit the toon\'s head perfectly only if the following equation has at least one real root:   Determine the probability with which an aim can be successfully hit by an anvil.You can assume that the p and q coefficients are chosen equiprobably and independently in their ranges." 1800

77A Heroes "brute force,implementation" "The year of 2012 is coming...According to an ancient choradrican legend in this very year, in 2012, Diablo and his brothers Mephisto and Baal will escape from hell, and innumerable hordes of demons will enslave the human world. But seven brave heroes have already gathered on the top of a mountain Arreat to protect us mere mortals from the effect of this terrible evil.The seven great heroes are: amazon Anka, barbarian Chapay, sorceress Cleo, druid Troll, necromancer Dracul, paladin Snowy and a professional hit girl Hexadecimal. Heroes already know how much experience will be given for each of the three megabosses: a for Mephisto, b for Diablo and c for Baal.Here\'s the problem: heroes are as much as seven and megabosses are only three! Then our heroes decided to split into three teams, where each team will go to destroy their own megaboss. Each team member will receive a  of experience, rounded down, where x will be the amount of experience for the killed megaboss and y \xe2\x80\x94 the number of people in the team.Heroes do not want to hurt each other\'s feelings, so they want to split into teams so that the difference between the hero who received the maximum number of experience and the hero who received the minimum number of experience were minimal. Since there can be several divisions into teams, then you need to find the one in which the total amount of liking in teams were maximum.It is known that some heroes like others. But if hero p likes hero q, this does not mean that the hero q likes hero p. No hero likes himself.The total amount of liking in teams is the amount of ordered pairs (p,\xe2\x80\x89q), such that heroes p and q are in the same group, and hero p likes hero q (but it is not important if hero q likes hero p). In case of heroes p and q likes each other and they are in the same group, this pair should be counted twice, as (p,\xe2\x80\x89q) and (q,\xe2\x80\x89p).A team can consist even of a single hero, but it is important that every megaboss was destroyed. All heroes must be involved in the campaign against evil. None of the heroes can be in more than one team.It is guaranteed that every hero is able to destroy any megaboss alone." 1400

76F Tourist "binary search,data structures,dp" "Tourist walks along the X axis. He can choose either of two directions and any speed not exceeding V. He can also stand without moving anywhere. He knows from newspapers that at time t1 in the point with coordinate x1 an interesting event will occur, at time t2 in the point with coordinate x2 \xe2\x80\x94 another one, and so on up to (xn,\xe2\x80\x89tn). Interesting events are short so we can assume they are immediate. Event i counts visited if at time ti tourist was at point with coordinate xi.Write program tourist that will find maximum number of events tourist if:   at the beginning (when time is equal to 0) tourist appears at point 0,  tourist can choose initial point for himself. Yes, you should answer on two similar but different questions." 2300

76E Points implementation,math "You are given N points on a plane. Write a program which will find the sum of squares of distances between all pairs of points." 1700

76D "Plus and xor" dp,greedy,math "Bitwise exclusive OR (or bitwise addition modulo two) is a binary operation which is equivalent to applying logical exclusive OR to every pair of bits located on the same positions in binary notation of operands. In other words, a binary digit of the result is equal to 1 if and only if bits on the respective positions in the operands are different.For example, if X\xe2\x80\x89=\xe2\x80\x8910910\xe2\x80\x89=\xe2\x80\x8911011012, Y\xe2\x80\x89=\xe2\x80\x894110\xe2\x80\x89=\xe2\x80\x891010012, then:  X xor Y�\xe2\x80\x89=\xe2\x80\x89�6810�\xe2\x80\x89=\xe2\x80\x89�10001002. Write a program, which takes two non-negative integers A and B as an input and finds two non-negative integers X and Y, which satisfy the following conditions:   A\xe2\x80\x89=\xe2\x80\x89X\xe2\x80\x89+\xe2\x80\x89Y  B�\xe2\x80\x89=\xe2\x80\x89�X xor Y, where xor is bitwise exclusive or.  X is the smallest number among all numbers for which the first two conditions are true." 1700

76C Mutation bitmasks,dp,math "Scientists of planet Olympia are conducting an experiment in mutation of primitive organisms. Genome of organism from this planet can be represented as a string of the first K capital English letters. For each pair of types of genes they assigned ai,\xe2\x80\x89j \xe2\x80\x94 a risk of disease occurence in the organism provided that genes of these types are adjacent in the genome, where i \xe2\x80\x94 the 1-based index of the first gene and j \xe2\x80\x94 the index of the second gene. The gene \'A\' has index 1, \'B\' has index 2 and so on. For example, a3,\xe2\x80\x892 stands for the risk of \'CB\' fragment. Risk of disease occurence in the organism is equal to the sum of risks for each pair of adjacent genes in the genome.Scientists have already obtained a base organism. Some new organisms can be obtained by mutation of this organism. Mutation involves removal of all genes of some particular types. Such removal increases the total risk of disease occurence additionally. For each type of genes scientists determined ti \xe2\x80\x94 the increasement of the total risk of disease occurence provided by removal of all genes having type with index i. For example, t4 stands for the value of additional total risk increasement in case of removing all the \'D\' genes.Scientists want to find a number of different organisms that can be obtained from the given one which have the total risk of disease occurence not greater than T. They can use only the process of mutation described above. Two organisms are considered different if strings representing their genomes are different. Genome should contain at least one gene." 2700

76B Mice "greedy,two pointers" "Modern researches has shown that a flock of hungry mice searching for a piece of cheese acts as follows: if there are several pieces of cheese then each mouse chooses the closest one. After that all mice start moving towards the chosen piece of cheese. When a mouse or several mice achieve the destination point and there is still a piece of cheese in it, they eat it and become well-fed. Each mice that reaches this point after that remains hungry. Moving speeds of all mice are equal.If there are several ways to choose closest pieces then mice will choose it in a way that would minimize the number of hungry mice. To check this theory scientists decided to conduct an experiment. They located N mice and M pieces of cheese on a cartesian plane where all mice are located on the line y\xe2\x80\x89=\xe2\x80\x89Y0 and all pieces of cheese \xe2\x80\x94 on another line y\xe2\x80\x89=\xe2\x80\x89Y1. To check the results of the experiment the scientists need a program which simulates the behavior of a flock of hungry mice.Write a program that computes the minimal number of mice which will remain hungry, i.e. without cheese." 2100

76A Gift dsu,graphs,sortings,trees "The kingdom of Olympia consists of N cities and M bidirectional roads. Each road connects exactly two cities and two cities can be connected with more than one road. Also it possible that some roads connect city with itself making a loop.All roads are constantly plundered with bandits. After a while bandits became bored of wasting time in road robberies, so they suggested the king of Olympia to pay off. According to the offer, bandits want to get a gift consisted of gold and silver coins. Offer also contains a list of restrictions: for each road it is known gi \xe2\x80\x94 the smallest amount of gold and si \xe2\x80\x94 the smallest amount of silver coins that should be in the gift to stop robberies on the road. That is, if the gift contains a gold and b silver coins, then bandits will stop robberies on all the roads that gi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a and si\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b.Unfortunately kingdom treasury doesn\'t contain neither gold nor silver coins, but there are Olympian tugriks in it. The cost of one gold coin in tugriks is G, and the cost of one silver coin in tugriks is S. King really wants to send bandits such gift that for any two cities there will exist a safe path between them. Your task is to find the minimal cost in Olympian tugriks of the required gift." 2200

75E "Ship\'s Shortest Path" "geometry,shortest paths" "The kingdom of Olympia consists of N cities and M bidirectional roads. Each road connects exactly two cities and two cities can be connected with more than one road. Also it possible that some roads connect city with itself making a loop.All roads are constantly plundered with bandits. After a while bandits became bored of wasting time in road robberies, so they suggested the king of Olympia to pay off. According to the offer, bandits want to get a gift consisted of gold and silver coins. Offer also contains a list of restrictions: for each road it is known gi \xe2\x80\x94 the smallest amount of gold and si \xe2\x80\x94 the smallest amount of silver coins that should be in the gift to stop robberies on the road. That is, if the gift contains a gold and b silver coins, then bandits will stop robberies on all the roads that gi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a and si\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b.Unfortunately kingdom treasury doesn\'t contain neither gold nor silver coins, but there are Olympian tugriks in it. The cost of one gold coin in tugriks is G, and the cost of one silver coin in tugriks is S. King really wants to send bandits such gift that for any two cities there will exist a safe path between them. Your task is to find the minimal cost in Olympian tugriks of the required gift." 2400

75D "Big Maximum Sum" "data structures,dp,greedy,implementation,math,trees" "Ahmed and Mostafa used to compete together in many programming contests for several years. Their coach Fegla asked them to solve one challenging problem, of course Ahmed was able to solve it but Mostafa couldn\'t.This problem is similar to a standard problem but it has a different format and constraints.In the standard problem you are given an array of integers, and you have to find one or more consecutive elements in this array where their sum is the maximum possible sum.But in this problem you are given n small arrays, and you will create one big array from the concatenation of one or more instances of the small arrays (each small array could occur more than once). The big array will be given as an array of indexes (1-based) of the small arrays, and the concatenation should be done in the same order as in this array. Then you should apply the standard problem mentioned above on the resulting big array.For example let\'s suppose that the small arrays are {1, 6, -2}, {3, 3} and {-5, 1}. And the indexes in the big array are {2, 3, 1, 3}. So the actual values in the big array after formatting it as concatenation of the small arrays will be {3, 3, -5, 1, 1, 6, -2, -5, 1}. In this example the maximum sum is 9.Can you help Mostafa solve this problem?" 2000

75C "Modified GCD" "binary search,number theory" "Well, here is another math class task. In mathematics, GCD is the greatest common divisor, and it\'s an easy task to calculate the GCD between two positive integers.A common divisor for two positive numbers is a number which both numbers are divisible by.But your teacher wants to give you a harder task, in this task you have to find the greatest common divisor d between two integers a and b that is in a given range from low to high (inclusive), i.e. low\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89d\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89high. It is possible that there is no common divisor in the given range.You will be given the two integers a and b, then n queries. Each query is a range from low to high and you have to answer each query." 1600

75B "Facetook Priority Wall" "expression parsing,implementation,strings" "Facetook is a well known social network website, and it will launch a new feature called Facetook Priority Wall. This feature will sort all posts from your friends according to the priority factor (it will be described).This priority factor will be affected by three types of actions:   1. ""X posted on Y\'s wall"" (15 points),  2. ""X commented on Y\'s post"" (10 points),  3. ""X likes Y\'s post"" (5 points). X and Y will be two distinct names. And each action will increase the priority factor between X and Y (and vice versa) by the above value of points (the priority factor between X and Y is the same as the priority factor between Y and X).You will be given n actions with the above format (without the action number and the number of points), and you have to print all the distinct names in these actions sorted according to the priority factor with you." 1500

75A "Life Without Zeros" implementation "Can you imagine our life if we removed all zeros from it? For sure we will have many problems.In this problem we will have a simple example if we removed all zeros from our life, it\'s the addition operation. Let\'s assume you are given this equation a\xe2\x80\x89+\xe2\x80\x89b\xe2\x80\x89=\xe2\x80\x89c, where a and b are positive integers, and c is the sum of a and b. Now let\'s remove all zeros from this equation. Will the equation remain correct after removing all zeros?For example if the equation is 101\xe2\x80\x89+\xe2\x80\x89102\xe2\x80\x89=\xe2\x80\x89203, if we removed all zeros it will be 11\xe2\x80\x89+\xe2\x80\x8912\xe2\x80\x89=\xe2\x80\x8923 which is still a correct equation.But if the equation is 105\xe2\x80\x89+\xe2\x80\x89106\xe2\x80\x89=\xe2\x80\x89211, if we removed all zeros it will be 15\xe2\x80\x89+\xe2\x80\x8916\xe2\x80\x89=\xe2\x80\x89211 which is not a correct equation." 1000

74E "Shift It!" "constructive algorithms" "There is a square box 6\xe2\x80\x89\xc3\x97\xe2\x80\x896 in size. It contains 36 chips 1\xe2\x80\x89\xc3\x97\xe2\x80\x891 in size. Those chips contain 36 different characters \xe2\x80\x94 ""0""-""9"" and ""A""-""Z"". There is exactly one chip with each character.You are allowed to make the following operations: you may choose one of 6 rows or one of 6 columns and cyclically shift the chips there to one position to the left or to the right (for the row) or upwards or downwards (for the column). Those operations are allowed to perform several times. To solve the puzzle is to shift the chips using the above described operations so that they were written in the increasing order (exactly equal to the right picture). An example of solving the puzzle is shown on a picture below.  Write a program that finds the sequence of operations that solves the puzzle. That sequence should not necessarily be shortest, but you should not exceed the limit of 10000 operations. It is guaranteed that the solution always exists." 2800

74D Hanger "data structures" "In one very large and very respectable company there is a cloakroom with a coat hanger. It is represented by n hooks, positioned in a row. The hooks are numbered with positive integers from 1 to n from the left to the right.The company workers have a very complicated work schedule. At the beginning of a work day all the employees are not there and the coat hanger in the cloakroom is empty. At some moments of time the employees arrive and some of them leave.When some employee arrives, he hangs his cloak on one of the available hooks. To be of as little discomfort to his colleagues as possible, the hook where the coat will hang, is chosen like this. First the employee chooses the longest segment among available hooks following in a row. If there are several of such segments, then he chooses the one closest to the right. After that the coat is hung on the hook located in the middle of this segment. If the segment has an even number of hooks, then among two central hooks we choose the one closest to the right.When an employee leaves, he takes his coat. As all the company workers deeply respect each other, no one takes somebody else\'s coat.From time to time the director of this respectable company gets bored and he sends his secretary to see how many coats hang on the coat hanger from the i-th to the j-th hook inclusive. And this whim is always to be fulfilled, otherwise the director gets angry and has a mental breakdown.Not to spend too much time traversing from the director\'s office to the cloakroom and back again, the secretary asked you to write a program, emulating the company cloakroom\'s work." 2400

74C "Chessboard Billiard" "dfs and similar,dsu,graphs,number theory" "Let\'s imagine: there is a chess piece billiard ball. Its movements resemble the ones of a bishop chess piece. The only difference is that when a billiard ball hits the board\'s border, it can reflect from it and continue moving.More formally, first one of four diagonal directions is chosen and the billiard ball moves in that direction. When it reaches the square located on the board\'s edge, the billiard ball reflects from it; it changes the direction of its movement by 90 degrees and continues moving. Specifically, having reached a corner square, the billiard ball is reflected twice and starts to move the opposite way. While it moves, the billiard ball can make an infinite number of reflections. At any square of its trajectory the billiard ball can stop and on that the move is considered completed.  It is considered that one billiard ball a beats another billiard ball b if a can reach a point where b is located.You are suggested to find the maximal number of billiard balls, that pairwise do not beat each other and that can be positioned on a chessboard n\xe2\x80\x89\xc3\x97\xe2\x80\x89m in size." 2100

74B Train dp,games,greedy "A stowaway and a controller play the following game. The train is represented by n wagons which are numbered with positive integers from 1 to n from the head to the tail. The stowaway and the controller are initially in some two different wagons. Every minute the train can be in one of two conditions \xe2\x80\x94 moving or idle. Every minute the players move.The controller\'s move is as follows. The controller has the movement direction \xe2\x80\x94 to the train\'s head or to its tail. During a move the controller moves to the neighbouring wagon correspondingly to its movement direction. If at the end of his move the controller enters the 1-st or the n-th wagon, that he changes the direction of his movement into the other one. In other words, the controller cyclically goes from the train\'s head to its tail and back again during all the time of a game, shifting during each move by one wagon. Note, that the controller always have exactly one possible move.The stowaway\'s move depends from the state of the train. If the train is moving, then the stowaway can shift to one of neighbouring wagons or he can stay where he is without moving. If the train is at a station and is idle, then the stowaway leaves the train (i.e. he is now not present in any train wagon) and then, if it is not the terminal train station, he enters the train again into any of n wagons (not necessarily into the one he\'s just left and not necessarily into the neighbouring one). If the train is idle for several minutes then each such minute the stowaway leaves the train and enters it back.Let\'s determine the order of the players\' moves. If at the given minute the train is moving, then first the stowaway moves and then the controller does. If at this minute the train is idle, then first the stowaway leaves the train, then the controller moves and then the stowaway enters the train.If at some point in time the stowaway and the controller happen to be in one wagon, then the controller wins: he makes the stowaway pay fine. If after a while the stowaway reaches the terminal train station, then the stowaway wins: he simply leaves the station during his move and never returns there again.At any moment of time the players know each other\'s positions. The players play in the optimal way. Specifically, if the controller wins, then the stowaway plays so as to lose as late as possible. As all the possible moves for the controller are determined uniquely, then he is considered to play optimally always. Determine the winner." 1500

74A "Room Leader" implementation "Let us remind you part of the rules of Codeforces. The given rules slightly simplified, use the problem statement as a formal document.In the beginning of the round the contestants are divided into rooms. Each room contains exactly n participants. During the contest the participants are suggested to solve five problems, A, B, C, D and E. For each of these problem, depending on when the given problem was solved and whether it was solved at all, the participants receive some points. Besides, a contestant can perform hacks on other contestants. For each successful hack a contestant earns 100 points, for each unsuccessful hack a contestant loses 50 points. The number of points for every contestant is represented by the sum of points he has received from all his problems, including hacks.You are suggested to determine the leader for some room; the leader is a participant who has maximum points." 1000

73F "Plane of Tanks" "brute force,geometry" "Vasya plays the Plane of Tanks. The tanks in this game keep trying to finish each other off. But your ""Pedalny"" is not like that... He just needs to drive in a straight line from point A to point B on the plane. Unfortunately, on the same plane are n enemy tanks. We shall regard all the tanks as points. At the initial moment of time Pedalny is at the point A. Enemy tanks would be happy to destroy it immediately, but initially their turrets are tuned in other directions. Specifically, for each tank we know the initial rotation of the turret ai (the angle in radians relative to the OX axis in the counterclockwise direction) and the maximum speed of rotation of the turret wi (radians per second). If at any point of time a tank turret will be aimed precisely at the tank Pedalny, then the enemy fires and it never misses. Pedalny can endure no more than k shots. Gun reloading takes very much time, so we can assume that every enemy will produce no more than one shot. Your task is to determine what minimum speed of v Pedalny must have to get to the point B. It is believed that Pedalny is able to instantly develop the speed of v, and the first k shots at him do not reduce the speed and do not change the coordinates of the tank." 2900

73E Morrowindows "math,number theory" "Vasya plays The Elder Trolls III: Morrowindows. He has a huge list of items in the inventory, however, there is no limits on the size of things. Vasya does not know the total amount of items but he is sure that are not more than x and not less than 2 items in his inventory. A new patch for the game appeared to view inventory in n different modes. Displaying in mode i is a partition of all inventory items on pages, each of which (except for maybe the last one) shows exactly ai items. In addition, each mode shows how many pages bi is in a complete list. Great! Perhaps this information will be enough for Vasya to find the required number. Moreover, it is very interesting, what is the fewest number of modes in which Vasya can see inventory to determine the number of items in it?Vasya cannot use the information that was received while looking on inventory in some mode for selection of next actions. I. e. Vasya chooses some set of modes first, and then sees all the results and determines the size.Knowing the number of ai, x and assuming that Vasya is very smart, check whether he can uniquely determine the number of items in his inventory, and how many modes he will need to do that if he knows numbers ai, x and he is able to know number bi after viewing items in mode i." 2400

73D FreeDiv "dfs and similar,graphs,greedy" "Vasya plays FreeDiv. In this game he manages a huge state, which has n cities and m two-way roads between them. Unfortunately, not from every city you can reach any other one moving along these roads. Therefore Vasya decided to divide the state into provinces so that in every province, one could reach from every city all the cities of the province, but there are no roads between provinces. Unlike other turn-based strategies, in FreeDiv a player has the opportunity to build tunnels between cities. The tunnels are two-way roads along which one can move armies undetected by the enemy. However, no more than one tunnel can be connected to each city. As for Vasya, he wants to build a network of tunnels so that any pair of cities in his state were reachable by some path consisting of roads and a tunnels. But at that no more than k tunnels are connected to each province (otherwise, the province will be difficult to keep in case other provinces are captured by enemy armies).Vasya discovered that maybe he will not be able to build such a network for the current condition of the state. Maybe he\'ll have first to build several roads between cities in different provinces to merge the provinces. Your task is to determine the minimum number of roads Vasya needs to build so that it was possible to build the required network of tunnels in the resulting state." 2200

73C "LionAge II" dp "Vasya plays the LionAge II. He was bored of playing with a stupid computer, so he installed this popular MMORPG, to fight with his friends. Vasya came up with the name of his character \xe2\x80\x94 non-empty string s, consisting of a lowercase Latin letters. However, in order not to put up a front of friends, Vasya has decided to change no more than k letters of the character name so that the new name sounded as good as possible. Euphony of the line is defined as follows: for each pair of adjacent letters x and y (x immediately precedes y) the bonus c(x,\xe2\x80\x89y) is added to the result. Your task is to determine what the greatest Euphony can be obtained by changing at most k letters in the name of the Vasya\'s character." 1800

73B "Need For Brake" "binary search,greedy,sortings" "Vasya plays the Need For Brake. He plays because he was presented with a new computer wheel for birthday! Now he is sure that he will win the first place in the championship in his favourite racing computer game! n racers take part in the championship, which consists of a number of races. After each race racers are arranged from place first to n-th (no two racers share the same place) and first m places are awarded. Racer gains bi points for i-th awarded place, which are added to total points, obtained by him for previous races. It is known that current summary score of racer i is ai points. In the final standings of championship all the racers will be sorted in descending order of points. Racers with an equal amount of points are sorted by increasing of the name in lexicographical order.Unfortunately, the championship has come to an end, and there is only one race left. Vasya decided to find out what the highest and lowest place he can take up as a result of the championship." 2000

73A "The Elder Trolls IV: Oblivon" greedy,math "Vasya plays The Elder Trolls IV: Oblivon. Oh, those creators of computer games! What they do not come up with! Absolutely unique monsters have been added to the The Elder Trolls IV: Oblivon. One of these monsters is Unkillable Slug. Why it is ""Unkillable""? Firstly, because it can be killed with cutting weapon only, so lovers of two-handed amber hammers should find suitable knife themselves. Secondly, it is necessary to make so many cutting strokes to Unkillable Slug. Extremely many. Too many! Vasya has already promoted his character to 80-th level and in order to gain level 81 he was asked to kill Unkillable Slug. The monster has a very interesting shape. It looks like a rectangular parallelepiped with size x\xe2\x80\x89\xc3\x97\xe2\x80\x89y\xe2\x80\x89\xc3\x97\xe2\x80\x89z, consisting of undestructable cells 1\xe2\x80\x89\xc3\x97\xe2\x80\x891\xe2\x80\x89\xc3\x97\xe2\x80\x891. At one stroke Vasya can cut the Slug along an imaginary grid, i.e. cut with a plane parallel to one of the parallelepiped side. Monster dies when amount of parts it is divided reaches some critical value.All parts of monster do not fall after each cut, they remains exactly on its places. I. e. Vasya can cut several parts with one cut.Vasya wants to know what the maximum number of pieces he can cut the Unkillable Slug into striking him at most k times.Vasya\'s character uses absolutely thin sword with infinite length." 1600

72I "Goofy Numbers" "*special problem,implementation" "The non-negative integer a is a divisor of the non-negative integer b if and only if there exists a positive integer c such that a\xe2\x80\x89\xc3\x97\xe2\x80\x89c\xe2\x80\x89=\xe2\x80\x89b. Some numbers are really interesting. Commander Surena defines some interesting properties for non-negative integers:  An integer is happy if it is divisible by at least one of its digits and not by all of them.  An integer is happier if it is divisible by all of its digits.  An integer is upset if it\'s divisible by none of its digits. Surena asks you to find out if a given number is happy, happier or upset." 1500

72H "Reverse It!" "*special problem,implementation" "The 14th of March was the international day of mathematics, because of number \xcf\x80\xe2\x80\x89=\xe2\x80\x893.1415926...In the occasion of this day Goofy Nephews Unity Organization (GNU) wants to publish the fastest program in math at 1:59:26 AM. Now the time is 1:11:11 AM and the project team haven\'t checked their program yet. Because of shortage of time they want to check their program with some queries. So they hired Hormizd (one of the greatest programmers in world) to write a tester for GNU\'s new program. Because Hormizd has much more important things to do, he wants you to write a small part of tester and it is reversing the numbers. Help him before 1:59:26.We can reverse numbers easily. For example by reversing 1234 we get 4321.Note, that if the integer is negative then its reverse would be also negative. For example reverse of \xe2\x80\x89-\xe2\x80\x89123 is \xe2\x80\x89-\xe2\x80\x89321.Also, you have to delete all the leading zeroes before and after the reverse.Given an integer you have to help Hormizd reverse it." 1600

72G "Fibonacci army" "*special problem,dp" "King Cambyses loves Fibonacci numbers. He has several armies. Today he wants to make a new army for himself and he wants the number of men in this army to be the n-th Fibonacci number.Given n you should find n-th Fibonacci number. The set of Fibonacci numbers start with f0\xe2\x80\x89=\xe2\x80\x89f1\xe2\x80\x89=\xe2\x80\x891 and for each i\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x892, fi\xe2\x80\x89=\xe2\x80\x89fi\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x89fi\xe2\x80\x89-\xe2\x80\x892." 1000

72F Oil "*special problem,greedy,math" "After the nationalization of the oil industry, Dr. Mosaddegh wants to dig some oil wells to extract all the oil in Persian Gulf. But Persian Gulf is huge and has an infinite amount of oil. So Dr. Mosaddegh works only on a rectangular plane of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m of the Persian Gulf. Each of the cells in this rectangle either contains an infinite amount of oil or nothing.Two cells are considered adjacent if and only if they have a common edge, a path is a sequence c1,\xe2\x80\x89c2,\xe2\x80\x89...,\xe2\x80\x89cx of cells so that all of them contain oil and for each i, ci is adjacent to ci\xe2\x80\x89-\xe2\x80\x891 and ci\xe2\x80\x89+\xe2\x80\x891 (if they exist). Two cells are considered connected to each other if and only if there exists a path between them. If we dig a well in a certain cell, we can extract oil from all the cells that are connected to it by oil paths. It is not allowed to dig wells on empty cells.Dr. Mosaddegh also knows that in Persian Gulf, the empty cells form rows and columns. I. e. if some cell is empty, then it\'s column is completely empty or it\'s row is completely empty, or both.Help Dr. Mosaddegh find out how many wells he has to dig to access all the oil in that region." 1900

72E "Ali goes shopping" "*special problem,brute force,strings" "Ali Koochooloo is going to buy new clothes since we\'re reaching Noruz, the ancient Persian festival and the beginning of new Persian year.When Ali entered a shop, he saw that the shopkeeper was a programmer and since there is no money in programming he had changed his career. The shopkeeper told Ali that he can buy anything for free if he could answer a simple question in 10 seconds. But to see the question Ali has to pay 3 tomans.Ali agreed instantly and the shopkeeper handed him a piece of paper containing the task. The task was indeed very simple. It said: Let string A be ababababababab. Which non-empty substring of A is repeated the most times in it?Ali answered fast. He said the answer is a. But the shopkeeper said that Ali is wrong and asked him to read the rest of statement:If several substrings have the maximal repeat time, then the substring with maximal length would be the answer, in case of a tie the alphabetically latest substring will be chosen.So the answer is ab.Now Ali wants us to solve this problem for different strings. We don\'t have a great advantage over Ali, we just have a computer and a weird language." 1800

72D Perse-script "*special problem,expression parsing" "Two good friends were trying to make a new programming language called Perse-script.The most important part of this language is strings. A string in Perse-script is put between characters ""So for example ""Hello"" is a string. But Hello is a variable name or a keyword, which are not considered in this problem.Perse-script is function-based. So there are no operators in this language. For example for summing two numbers you have to write sum(a,b) and not a+b.There are several functions for working on strings. These include:   concat(x,y) is a function which gets two strings x and y and puts y at the end of x and returns the result. For example concat(""Hello"",""World"") returns ""HelloWorld"".  reverse(x) gets a single string x and reverses it. For example reverse(""Hello"") returns ""olleH"".  substr(x,a,b) gets a string x and two integers a and b (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n, where n is the length of x). And returns the substring of x between indexes a and b, inclusive. For example substr(""Hello"",2,4) returns ""ell"".  substr(x,a,b,c) is another version of substr which works just like the last one but c is the step of adding. c is positive. For example substr(""HelloWorld"",1,10,2) returns ""Hlool"". This substr means that you put the ath character , and then every cth character until you reach b.You\'re going to manipulate the string part of Perse-script. Given a string expression, you should print its result. It is guaranteed that the expression contains only strings shown by characters "" and the above functions.Commands in Perse-script are case-insensitive. So to call substr function you can write SUBsTr(). But you can\'t print as the result ""hElLo"" instead of printing ""Hello"".See the samples for more information." 2300

72C "Extraordinarily Nice Numbers" "*special problem,math" "The positive integer a is a divisor of the positive integer b if and only if there exists a positive integer c such that a\xe2\x80\x89\xc3\x97\xe2\x80\x89c\xe2\x80\x89=\xe2\x80\x89b. King Astyages thinks a positive integer x is extraordinarily nice if the number of its even divisors is equal to the number of its odd divisors.For example 3 has two positive divisors 3 and 1, both of which are odd, so 3 is not extraordinarily nice. On the other hand 2 is only divisible by 2 and 1, so it has one odd and one even divisor. Therefore 2 is extraordinarily nice.Given a positive integer x determine whether it\'s extraordinarily nice." 1200

72B INI-file "*special problem,implementation" "The INI file format is a de facto standard for configuration files. INI files are simple text files with a basic structure. They are commonly associated with Microsoft Windows, but are also used on other platforms.Each line in INI-file stands for key-value mapping or defines new section. A key-value line has a format ""key=value"",where key \xe2\x80\x94 is the name of some property, and value \xe2\x80\x94 it\'s value. It is possible that it will be spaces from the both sides of key and/or value, the spaces should be ignored.A section line has a format ""[section]"". It means that all key-value lines after it define properties of the specified section. Of cause, the following section line changes the current section. A section line may have spaces around any of brackets.Also you should ignore comment lines \xe2\x80\x94 the first non-space character of comment line is "";"".You task is to write the program which will format given INI-file in a special way:   first, print key-value lines which do not belong to any section;  print all the sections in the lexicographical (alphabetical) order of their names;  inside each of two previous items, order key-value lines lexicographically by ""key"";  if there are more than one key-value lines with the same key inside a single section (or outside any sections), leave only one line (which appears later in the input data);  remove all redundant spaces and lines." 2200

72A "Goshtasp, Vishtasp and Eidi" "*special problem,greedy,math" "Goshtasp was known to be a good programmer in his school. One day Vishtasp, Goshtasp\'s friend, asked him to solve this task:Given a positive integer n, you should determine whether n is rich.The positive integer x is rich, if there exists some set of distinct numbers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89am such that . In addition: every ai should be either a prime number, or equal to 1.Vishtasp said that he would share his Eidi 50\xe2\x80\x89/\xe2\x80\x8950 with Goshtasp, if he could solve the task. Eidi is money given to children for Noruz by their parents and/or relatives.Goshtasp needs to solve this problem to get money, you need to solve it to get score!" 1800

71E "Nuclear Fusion" bitmasks,dp "There is the following puzzle popular among nuclear physicists.A reactor contains a set of n atoms of some chemical elements. We shall understand the phrase ""atomic number"" as the number of this atom\'s element in the periodic table of the chemical elements.You are allowed to take any two different atoms and fuse a new one from them. That results in a new atom, whose number is equal to the sum of the numbers of original atoms. The fusion operation can be performed several times.The aim is getting a new pregiven set of k atoms.The puzzle\'s difficulty is that it is only allowed to fuse two atoms into one, it is not allowed to split an atom into several atoms. You are suggested to try to solve the puzzle." 2200

71D Solitaire "brute force,implementation" "Vasya has a pack of 54 cards (52 standard cards and 2 distinct jokers). That is all he has at the moment. Not to die from boredom, Vasya plays Solitaire with them.Vasya lays out nm cards as a rectangle n\xe2\x80\x89\xc3\x97\xe2\x80\x89m. If there are jokers among them, then Vasya should change them with some of the rest of 54\xe2\x80\x89-\xe2\x80\x89nm cards (which are not layed out) so that there were no jokers left. Vasya can pick the cards to replace the jokers arbitrarily. Remember, that each card presents in pack exactly once (i. e. in a single copy). Vasya tries to perform the replacements so that the solitaire was solved.Vasya thinks that the solitaire is solved if after the jokers are replaced, there exist two non-overlapping squares 3\xe2\x80\x89\xc3\x97\xe2\x80\x893, inside each of which all the cards either have the same suit, or pairwise different ranks.Determine by the initial position whether the solitaire can be solved or not. If it can be solved, show the way in which it is possible." 2200

71C "Round Table Knights" "dp,math,number theory" "There are n knights sitting at the Round Table at an equal distance from each other. Each of them is either in a good or in a bad mood.Merlin, the wizard predicted to King Arthur that the next month will turn out to be particularly fortunate if the regular polygon can be found. On all vertices of the polygon knights in a good mood should be located. Otherwise, the next month will bring misfortunes.A convex polygon is regular if all its sides have same length and all his angles are equal. In this problem we consider only regular polygons with at least 3 vertices, i. e. only nondegenerated.On a picture below some examples of such polygons are present. Green points mean knights in a good mood. Red points mean ones in a bad mood.  King Arthur knows the knights\' moods. Help him find out if the next month will be fortunate or not." 1600

71B "Progress Bar" implementation,math "A progress bar is an element of graphical interface that displays the progress of a process for this very moment before it is completed. Let\'s take a look at the following form of such a bar.A bar is represented as n squares, located in line. To add clarity, let\'s number them with positive integers from 1 to n from the left to the right. Each square has saturation (ai for the i-th square), which is measured by an integer from 0 to k. When the bar for some i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) is displayed, squares 1,\xe2\x80\x892,\xe2\x80\x89... ,\xe2\x80\x89i\xe2\x80\x89-\xe2\x80\x891 has the saturation k, squares i\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89i\xe2\x80\x89+\xe2\x80\x892,\xe2\x80\x89... ,\xe2\x80\x89n has the saturation 0, and the saturation of the square i can have any value from 0 to k.So some first squares of the progress bar always have the saturation k. Some last squares always have the saturation 0. And there is no more than one square that has the saturation different from 0 and k.The degree of the process\'s completion is measured in percents. Let the process be t% completed. Then the following inequation is fulfilled: An example of such a bar can be seen on the picture.  For the given n, k, t determine the measures of saturation for all the squares ai of the progress bar." 1300

71A "Way Too Long Words" strings "Sometimes some words like ""localization"" or ""internationalization"" are so long that writing them many times in one text is quite tiresome.Let\'s consider a word too long, if its length is strictly more than 10 characters. All too long words should be replaced with a special abbreviation.This abbreviation is made like this: we write down the first and the last letter of a word and between them we write the number of letters between the first and the last letters. That number is in decimal system and doesn\'t contain any leading zeroes.Thus, ""localization"" will be spelt as ""l10n"", and ""internationalization\xc2\xbb will be spelt as ""i18n"".You are suggested to automatize the process of changing the words with abbreviations. At that all too long words should be replaced by the abbreviation and the words that are not too long should not undergo any changes." 800

70E "Information Reform" dp,implementation,trees "Thought it is already the XXI century, the Mass Media isn\'t very popular in Walrusland. The cities get news from messengers who can only travel along roads. The network of roads in Walrusland is built so that it is possible to get to any city from any other one in exactly one way, and the roads\' lengths are equal.The North Pole governor decided to carry out an information reform. Several cities were decided to be chosen and made regional centers. Maintaining a region center takes k fishlars (which is a local currency) per year. It is assumed that a regional center always has information on the latest news.For every city which is not a regional center, it was decided to appoint a regional center which will be responsible for keeping this city informed. In that case the maintenance costs will be equal to dlen fishlars per year, where len is the distance from a city to the corresponding regional center, measured in the number of roads along which one needs to go.Your task is to minimize the costs to carry out the reform." 2700

70D "Professor\'s task" "data structures,geometry" "Thought it is already the XXI century, the Mass Media isn\'t very popular in Walrusland. The cities get news from messengers who can only travel along roads. The network of roads in Walrusland is built so that it is possible to get to any city from any other one in exactly one way, and the roads\' lengths are equal.The North Pole governor decided to carry out an information reform. Several cities were decided to be chosen and made regional centers. Maintaining a region center takes k fishlars (which is a local currency) per year. It is assumed that a regional center always has information on the latest news.For every city which is not a regional center, it was decided to appoint a regional center which will be responsible for keeping this city informed. In that case the maintenance costs will be equal to dlen fishlars per year, where len is the distance from a city to the corresponding regional center, measured in the number of roads along which one needs to go.Your task is to minimize the costs to carry out the reform." 2700

70C "Lucky Tickets" "binary search,data structures,sortings,two pointers" "In Walrusland public transport tickets are characterized by two integers: by the number of the series and by the number of the ticket in the series. Let the series number be represented by a and the ticket number \xe2\x80\x94 by b, then a ticket is described by the ordered pair of numbers (a,\xe2\x80\x89b). The walruses believe that a ticket is lucky if a\xe2\x80\x89*\xe2\x80\x89b\xe2\x80\x89=\xe2\x80\x89rev(a)\xe2\x80\x89*\xe2\x80\x89rev(b). The function rev(x) reverses a number written in the decimal system, at that the leading zeroes disappear. For example, rev(12343)\xe2\x80\x89=\xe2\x80\x8934321, rev(1200)\xe2\x80\x89=\xe2\x80\x8921.The Public Transport Management Committee wants to release x series, each containing y tickets, so that at least w lucky tickets were released and the total number of released tickets (x\xe2\x80\x89*\xe2\x80\x89y) were minimum. The series are numbered from 1 to x inclusive. The tickets in each series are numbered from 1 to y inclusive. The Transport Committee cannot release more than maxx series and more than maxy tickets in one series." 2200

70B "Text Messaging" "expression parsing,greedy,strings" "Fangy the little walrus, as all the modern walruses, loves to communicate via text messaging. One day he faced the following problem: When he sends large texts, they are split into parts each containing n characters (which is the size of one text message). Thus, whole sentences and words get split!Fangy did not like it, so he faced the task of breaking the text into minimal messages on his own so that no sentence were broken into pieces when it is sent and the number of text messages to be sent would be minimal. If two consecutive sentences are in different messages, the space between them can be ignored (Fangy does not write this space).The little walrus\'s text looks in the following manner: TEXT ::= SENTENCE | SENTENCE SPACE TEXTSENTENCE ::= WORD SPACE SENTENCE | WORD ENDEND ::= {\'.\', \'?\', \'!\'}WORD ::= LETTER | LETTER WORDLETTER ::= {\'a\'..\'z\', \'A\'..\'Z\'}SPACE ::= \' \'SPACE stands for the symbol of a space.So, how many messages did Fangy send?" 1600

70A Cookies math "Fangy collects cookies. Once he decided to take a box and put cookies into it in some way. If we take a square k\xe2\x80\x89\xc3\x97\xe2\x80\x89k in size, divided into blocks 1\xe2\x80\x89\xc3\x97\xe2\x80\x891 in size and paint there the main diagonal together with cells, which lie above it, then the painted area will be equal to the area occupied by one cookie k in size. Fangy also has a box with a square base 2n\xe2\x80\x89\xc3\x97\xe2\x80\x892n, divided into blocks 1\xe2\x80\x89\xc3\x97\xe2\x80\x891 in size. In a box the cookies should not overlap, and they should not be turned over or rotated. See cookies of sizes 2 and 4 respectively on the figure:    To stack the cookies the little walrus uses the following algorithm. He takes out of the repository the largest cookie which can fit in some place in the box and puts it there. Everything could be perfect but alas, in the repository the little walrus has infinitely many cookies of size 2 and larger, and there are no cookies of size 1, therefore, empty cells will remain in the box. Fangy wants to know how many empty cells will be left in the end." 1300

69E Subsegments "data structures,implementation" "Programmer Sasha has recently begun to study data structures. His coach Stas told him to solve the problem of finding a minimum on the segment of the array in , which Sasha coped with. For Sasha not to think that he had learned all, Stas gave him a new task. For each segment of the fixed length Sasha must find the maximum element of those that occur on the given segment exactly once. Help Sasha solve this problem." 1800

69D Dot dp,games "Anton and Dasha like to play different games during breaks on checkered paper. By the 11th grade they managed to play all the games of this type and asked Vova the programmer to come up with a new game. Vova suggested to them to play a game under the code name ""dot"" with the following rules:  On the checkered paper a coordinate system is drawn. A dot is initially put in the position (x,\xe2\x80\x89y).  A move is shifting a dot to one of the pre-selected vectors. Also each player can once per game symmetrically reflect a dot relatively to the line y\xe2\x80\x89=\xe2\x80\x89x.  Anton and Dasha take turns. Anton goes first.  The player after whose move the distance from the dot to the coordinates\' origin exceeds d, loses. Help them to determine the winner." 1900

69C Game implementation "In one school with Vasya there is a student Kostya. Kostya does not like physics, he likes different online games. Every day, having come home, Kostya throws his bag in the farthest corner and sits down at his beloved computer. Kostya even eats glued to the game. A few days ago Kostya bought a new RPG game ""HaresButtle"", which differs from all other games in this genre. It has a huge number of artifacts. As we know, artifacts are divided into basic and composite ones. Only the basic artifacts are available on sale. More powerful composite artifacts are collected from some number of basic artifacts.After the composing composite artifact, all the components disappear.Kostya is the head of the alliance, so he has to remember, what artifacts has not only himself, but also his allies. You must identify by sequence of artifacts purchased by Kostya and his allies, how many and which artifacts has been collected by each of them. It is believed that initially no one has any artifacts." 2000

69B Bets greedy,implementation "In Chelyabinsk lives a much respected businessman Nikita with a strange nickname ""Boss"". Once Nikita decided to go with his friend Alex to the Summer Biathlon World Cup. Nikita, as a very important person, received a token which allows to place bets on each section no more than on one competitor.To begin with friends learned the rules: in the race there are n sections of equal length and m participants. The participants numbered from 1 to m. About each participant the following is known: li \xe2\x80\x94 the number of the starting section,  ri \xe2\x80\x94 the number of the finishing section (li\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ri), ti \xe2\x80\x94 the time a biathlete needs to complete an section of the path, ci \xe2\x80\x94 the profit in roubles. If the i-th sportsman wins on one of the sections, the profit will be given to the man who had placed a bet on that sportsman. The i-th biathlete passes the sections from li to ri inclusive. The competitor runs the whole way in (ri\xe2\x80\x89-\xe2\x80\x89li\xe2\x80\x89+\xe2\x80\x891)\xc2\xb7ti time units. It takes him exactly ti time units to pass each section. In case of the athlete\'s victory on k sections the man who has betted on him receives k\xc2\xb7ci roubles.In each section the winner is determined independently as follows: if there is at least one biathlete running this in this section, then among all of them the winner is the one who has ran this section in minimum time (spent minimum time passing this section). In case of equality of times the athlete with the smaller index number wins. If there are no participants in this section, then the winner in this section in not determined. We have to say that in the summer biathlon all the participants are moving at a constant speed.We should also add that Nikita can bet on each section and on any contestant running in this section.Help the friends find the maximum possible profit." 1200

69A "Young Physicist" implementation,math "A guy named Vasya attends the final grade of a high school. One day Vasya decided to watch a match of his favorite hockey team. And, as the boy loves hockey very much, even more than physics, he forgot to do the homework. Specifically, he forgot to complete his physics tasks. Next day the teacher got very angry at Vasya and decided to teach him a lesson. He gave the lazy student a seemingly easy task: You are given an idle body in space and the forces that affect it. The body can be considered as a material point with coordinates (0; 0; 0). Vasya had only to answer whether it is in equilibrium. ""Piece of cake"" \xe2\x80\x94 thought Vasya, we need only to check if the sum of all vectors is equal to 0. So, Vasya began to solve the problem. But later it turned out that there can be lots and lots of these forces, and Vasya can not cope without your help. Help him. Write a program that determines whether a body is idle or is moving by the given vectors of forces." 1000

68E Contact geometry "Little Petya is preparing for the first contact with aliens. He knows that alien spaceships have shapes of non-degenerate triangles and there will be exactly 4 ships. Landing platform for a ship can be made of 3 special columns located at some points of a Cartesian plane such that these 3 points form a triangle equal to the ship with respect to rotations, translations (parallel shifts along some vector) and reflections (symmetries along the edges). The ships can overlap after the landing.Each column can be used to land more than one ship, for example, if there are two equal ships, we don\'t need to build 6 columns to land both ships, 3 will be enough. Petya wants to know what minimum number of columns will be enough to land all ships." 2900

68D "Half-decay tree" "data structures,divide and conquer,dp,math,probabilities" "Recently Petya has become keen on physics. Anna V., his teacher noticed Petya\'s interest and gave him a fascinating physical puzzle \xe2\x80\x94 a half-decay tree. A half-decay tree is a complete binary tree with the height h. The height of a tree is the length of the path (in edges) from the root to a leaf in the tree. While studying the tree Petya can add electrons to vertices or induce random decay with synchrophasotron. Random decay is a process during which the edges of some path from the root to the random leaf of the tree are deleted. All the leaves are equiprobable. As the half-decay tree is the school property, Petya will return back the deleted edges into the tree after each decay.After being desintegrated, the tree decomposes into connected components. Charge of each component is the total quantity of electrons placed in vertices of the component. Potential of desintegerated tree is the maximum from the charges of its connected components. Each time before inducing random decay Petya is curious about the mathematical expectation of potential of the tree after being desintegrated." 2500

68C Synchrophasotron "brute force" "For some experiments little Petya needs a synchrophasotron. He has already got the device, all that\'s left is to set the fuel supply. Fuel comes through a system of nodes numbered from 1 to n and connected by pipes. Pipes go from every node with smaller number to every node with greater number. Fuel can only flow through pipes in direction from node with smaller number to node with greater number. Any amount of fuel can enter through the first node and the last node is connected directly to the synchrophasotron. It is known that every pipe has three attributes: the minimum amount of fuel that should go through it, the maximum amount of fuel that can possibly go through it and the cost of pipe activation. If cij units of fuel (cij\xe2\x80\x89>\xe2\x80\x890) flow from node i to node j, it will cost aij\xe2\x80\x89+\xe2\x80\x89cij2 tugriks (aij is the cost of pipe activation), and if fuel doesn\'t flow through the pipe, it doesn\'t cost anything. Only integer number of units of fuel can flow through each pipe.Constraints on the minimal and the maximal fuel capacity of a pipe take place always, not only if it is active. You may assume that the pipe is active if and only if the flow through it is strictly greater than zero.Petya doesn\'t want the pipe system to be overloaded, so he wants to find the minimal amount of fuel, that, having entered the first node, can reach the synchrophasotron. Besides that he wants to impress the sponsors, so the sum of money needed to be paid for fuel to go through each pipe, must be as big as possible." 2200

68B "Energy exchange" "binary search" "It is well known that the planet suffers from the energy crisis. Little Petya doesn\'t like that and wants to save the world. For this purpose he needs every accumulator to contain the same amount of energy. Initially every accumulator has some amount of energy: the i-th accumulator has ai units of energy. Energy can be transferred from one accumulator to the other. Every time x units of energy are transferred (x is not necessarily an integer) k percent of it is lost. That is, if x units were transferred from one accumulator to the other, amount of energy in the first one decreased by x units and in other increased by  units.Your task is to help Petya find what maximum equal amount of energy can be stored in each accumulator after the transfers." 1600

68A "Irrational problem" "implementation,number theory" "Little Petya was given this problem for homework:You are given function  (here  represents the operation of taking the remainder). His task is to count the number of integers x in range [a;b] with property f(x)\xe2\x80\x89=\xe2\x80\x89x.It is a pity that Petya forgot the order in which the remainders should be taken and wrote down only 4 numbers. Each of 24 possible orders of taking the remainder has equal probability of being chosen. For example, if Petya has numbers 1, 2, 3, 4 then he can take remainders in that order or first take remainder modulo 4, then modulo 2, 3, 1. There also are 22 other permutations of these numbers that represent orders in which remainder can be taken. In this problem 4 numbers wrote down by Petya will be pairwise distinct.Now it is impossible for Petya to complete the task given by teacher but just for fun he decided to find the number of integers  with property that probability that f(x)\xe2\x80\x89=\xe2\x80\x89x is not less than 31.4159265352718281828459045%. In other words, Petya will pick up the number x if there exist at least 7 permutations of numbers p1,\xe2\x80\x89p2,\xe2\x80\x89p3,\xe2\x80\x89p4, for which f(x)\xe2\x80\x89=\xe2\x80\x89x." 1100

67E "Save the City!" geometry "In the town of Aalam-Aara (meaning the Light of the Earth), previously there was no crime, no criminals but as the time progressed, sins started creeping into the hearts of once righteous people. Seeking solution to the problem, some of the elders found that as long as the corrupted part of population was kept away from the uncorrupted part, the crimes could be stopped. So, they are trying to set up a compound where they can keep the corrupted people. To ensure that the criminals don\'t escape the compound, a watchtower needs to be set up, so that they can be watched.Since the people of Aalam-Aara aren\'t very rich, they met up with a merchant from some rich town who agreed to sell them a land-plot which has already a straight line fence AB along which a few points are set up where they can put up a watchtower. Your task is to help them find out the number of points on that fence where the tower can be put up, so that all the criminals can be watched from there. Only one watchtower can be set up. A criminal is watchable from the watchtower if the line of visibility from the watchtower to him doesn\'t cross the plot-edges at any point between him and the tower i.e. as shown in figure 1 below, points X, Y, C and A are visible from point B but the points E and D are not.    Figure 1     Figure 2 Assume that the land plot is in the shape of a polygon and coordinate axes have been setup such that the fence AB is parallel to x-axis and the points where the watchtower can be set up are the integer points on the line. For example, in given figure 2, watchtower can be setup on any of five integer points on AB i.e. (4,\xe2\x80\x898), (5,\xe2\x80\x898), (6,\xe2\x80\x898), (7,\xe2\x80\x898) or (8,\xe2\x80\x898). You can assume that no three consecutive points are collinear and all the corner points other than A and B, lie towards same side of fence AB. The given polygon doesn\'t contain self-intersections." 2500

67D "Optical Experiment" "binary search,data structures,dp" "Professor Phunsuk Wangdu has performed some experiments on rays. The setup for n rays is as follows.There is a rectangular box having exactly n holes on the opposite faces. All rays enter from the holes of the first side and exit from the holes of the other side of the box. Exactly one ray can enter or exit from each hole. The holes are in a straight line.  Professor Wangdu is showing his experiment to his students. He shows that there are cases, when all the rays are intersected by every other ray. A curious student asked the professor: ""Sir, there are some groups of rays such that all rays in that group intersect every other ray in that group. Can we determine the number of rays in the largest of such groups?"".Professor Wangdu now is in trouble and knowing your intellect he asks you to help him." 1900

67C "Sequence of Balls" dp "You are given a sequence of balls A by your teacher, each labeled with a lowercase Latin letter \'a\'-\'z\'. You don\'t like the given sequence. You want to change it into a new sequence, B that suits you better. So, you allow yourself four operations:  You can insert any ball with any label into the sequence at any position.  You can delete (remove) any ball from any position.  You can replace any ball with any other ball.  You can exchange (swap) two adjacent balls. Your teacher now places time constraints on each operation, meaning that an operation can only be performed in certain time. So, the first operation takes time ti, the second one takes td, the third one takes tr and the fourth one takes te. Also, it is given that 2\xc2\xb7te\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89ti\xe2\x80\x89+\xe2\x80\x89td.Find the minimal time to convert the sequence A to the sequence B." 2600

67B "Restoration of the Permutation" greedy "Let A\xe2\x80\x89=\xe2\x80\x89{a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an} be any permutation of the first n natural numbers {1,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89n}. You are given a positive integer k and another sequence B\xe2\x80\x89=\xe2\x80\x89{b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bn}, where bi is the number of elements aj in A to the left of the element at\xe2\x80\x89=\xe2\x80\x89i such that aj\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89(i\xe2\x80\x89+\xe2\x80\x89k).For example, if n\xe2\x80\x89=\xe2\x80\x895, a possible A is {5,\xe2\x80\x891,\xe2\x80\x894,\xe2\x80\x892,\xe2\x80\x893}. For k\xe2\x80\x89=\xe2\x80\x892, B is given by {1,\xe2\x80\x892,\xe2\x80\x891,\xe2\x80\x890,\xe2\x80\x890}. But if k\xe2\x80\x89=\xe2\x80\x893, then B\xe2\x80\x89=\xe2\x80\x89{1,\xe2\x80\x891,\xe2\x80\x890,\xe2\x80\x890,\xe2\x80\x890}.For two sequences X\xe2\x80\x89=\xe2\x80\x89{x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xn} and Y\xe2\x80\x89=\xe2\x80\x89{y1,\xe2\x80\x89y2,\xe2\x80\x89...,\xe2\x80\x89yn}, let i-th elements be the first elements such that xi\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89yi. If xi\xe2\x80\x89<\xe2\x80\x89yi, then X is lexicographically smaller than Y, while if xi\xe2\x80\x89>\xe2\x80\x89yi, then X is lexicographically greater than Y.Given n, k and B, you need to determine the lexicographically smallest A." 1800

67A "Partial Teacher" dp,graphs,greedy,implementation "A teacher decides to give toffees to his students. He asks n students to stand in a queue. Since the teacher is very partial, he follows the following rule to distribute toffees.He looks at the first two students and gives more toffees to the student having higher marks than the other one. If they have the same marks they get the same number of toffees. The same procedure is followed for each pair of adjacent students starting from the first one to the last one.It is given that each student receives at least one toffee. You have to find the number of toffees given to each student by the teacher such that the total number of toffees is minimum." 1800

66E "Petya and Post" "data structures,dp" "Little Vasya\'s uncle is a postman. The post offices are located on one circular road. Besides, each post office has its own gas station located next to it. Petya\'s uncle works as follows: in the morning he should leave the house and go to some post office. In the office he receives a portion of letters and a car. Then he must drive in the given car exactly one round along the circular road and return to the starting post office (the uncle can drive along the circle in any direction, counterclockwise or clockwise). Besides, since the car belongs to the city post, it should also be fuelled with gasoline only at the Post Office stations. The total number of stations equals to n. One can fuel the car at the i-th station with no more than ai liters of gasoline. Besides, one can fuel the car no more than once at each station. Also, the distance between the 1-st and the 2-nd station is b1 kilometers, the distance between the 2-nd and the 3-rd one is b2 kilometers, ..., between the (n\xe2\x80\x89-\xe2\x80\x891)-th and the n-th ones the distance is bn\xe2\x80\x89-\xe2\x80\x891 kilometers and between the n-th and the 1-st one the distance is bn kilometers. Petya\'s uncle\'s high-tech car uses only one liter of gasoline per kilometer. It is known that the stations are located so that the sum of all ai is equal to the sum of all bi. The i-th gas station and i-th post office are very close, so the distance between them is 0 kilometers.Thus, it becomes clear that if we start from some post offices, then it is not always possible to drive one round along a circular road. The uncle faces the following problem: to what stations can he go in the morning to be able to ride exactly one circle along the circular road and visit all the post offices that are on it?Petya, who used to attend programming classes, has volunteered to help his uncle, but his knowledge turned out to be not enough, so he asks you to help him write the program that will solve the posed problem." 2000

66D "Petya and His Friends" "constructive algorithms,math,number theory" "Little Petya has a birthday soon. Due this wonderful event, Petya\'s friends decided to give him sweets. The total number of Petya\'s friends equals to n.Let us remind you the definition of the greatest common divisor: GCD(a1,\xe2\x80\x89...,\xe2\x80\x89ak)\xe2\x80\x89=\xe2\x80\x89d, where d represents such a maximal positive number that each ai (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k) is evenly divisible by d. At that, we assume that all ai\'s are greater than zero.Knowing that Petya is keen on programming, his friends has agreed beforehand that the 1-st friend gives a1 sweets, the 2-nd one gives a2 sweets, ..., the n-th one gives an sweets. At the same time, for any i and j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i,\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) they want the GCD(ai,\xe2\x80\x89aj) not to be equal to 1. However, they also want the following condition to be satisfied: GCD(a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an)\xe2\x80\x89=\xe2\x80\x891. One more: all the ai should be distinct.Help the friends to choose the suitable numbers a1,\xe2\x80\x89...,\xe2\x80\x89an." 1700

66C "Petya and File System" "data structures,implementation" "Recently, on a programming lesson little Petya showed how quickly he can create files and folders on the computer. But he got soon fed up with this activity, and he decided to do a much more useful thing. He decided to calculate what folder contains most subfolders (including nested folders, nested folders of nested folders, and so on) and what folder contains most files (including the files in the subfolders).More formally, the subfolders of the folder are all its directly nested folders and the subfolders of these nested folders. The given folder is not considered the subfolder of itself. A file is regarded as lying in a folder, if and only if it either lies directly in this folder, or lies in some subfolder of the folder.For a better understanding of how to count subfolders and files for calculating the answer, see notes and answers to the samples.You are given a few files that Petya has managed to create. The path to each file looks as follows:diskName:\\folder1\\folder2\\...\\ foldern\\fileName  diskName is single capital letter from the set {C,D,E,F,G}. folder1, ..., foldern are folder names. Each folder name is nonempty sequence of lowercase Latin letters and digits from 0 to 9. (n\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x891) fileName is a file name in the form of name.extension, where the name and the extension are nonempty sequences of lowercase Latin letters and digits from 0 to 9. It is also known that there is no file whose path looks like diskName:\\fileName. That is, each file is stored in some folder, but there are no files directly in the root. Also let us assume that the disk root is not a folder.Help Petya to find the largest number of subfolders, which can be in some folder, and the largest number of files that can be in some folder, counting all its subfolders." 1800

66B "Petya and Countryside" "brute force,implementation" "Little Petya often travels to his grandmother in the countryside. The grandmother has a large garden, which can be represented as a rectangle 1\xe2\x80\x89\xc3\x97\xe2\x80\x89n in size, when viewed from above. This rectangle is divided into n equal square sections. The garden is very unusual as each of the square sections possesses its own fixed height and due to the newest irrigation system we can create artificial rain above each section.Creating artificial rain is an expensive operation. That\'s why we limit ourselves to creating the artificial rain only above one section. At that, the water from each watered section will flow into its neighbouring sections if their height does not exceed the height of the section. That is, for example, the garden can be represented by a 1\xe2\x80\x89\xc3\x97\xe2\x80\x895 rectangle, where the section heights are equal to 4, 2, 3, 3, 2. Then if we create an artificial rain over any of the sections with the height of 3, the water will flow over all the sections, except the ones with the height of 4. See the illustration of this example at the picture:  As Petya is keen on programming, he decided to find such a section that if we create artificial rain above it, the number of watered sections will be maximal. Help him." 1100

66A "Petya and Java" implementation,strings "Little Petya has recently started attending a programming club. Naturally he is facing the problem of choosing a programming language. After long considerations he realized that Java is the best choice. The main argument in favor of choosing Java was that it has a very large integer data type, called BigInteger.But having attended several classes of the club, Petya realized that not all tasks require using the BigInteger type. It turned out that in some tasks it is much easier to use small data types. That\'s why a question arises: ""Which integer type to use if one wants to store a positive integer n?""Petya knows only 5 integer types:1) byte occupies 1 byte and allows you to store numbers from \xe2\x80\x89-\xe2\x80\x89128 to 1272) short occupies 2 bytes and allows you to store numbers from \xe2\x80\x89-\xe2\x80\x8932768 to 327673) int occupies 4 bytes and allows you to store numbers from \xe2\x80\x89-\xe2\x80\x892147483648 to 21474836474) long occupies 8 bytes and allows you to store numbers from \xe2\x80\x89-\xe2\x80\x899223372036854775808 to 92233720368547758075) BigInteger can store any integer number, but at that it is not a primitive type, and operations with it are much slower.For all the types given above the boundary values are included in the value range.From this list, Petya wants to choose the smallest type that can store a positive integer n. Since BigInteger works much slower, Peter regards it last. Help him." 1300

65E "Harry Potter and Moving Staircases" "dfs and similar,implementation" "Harry Potter lost his Invisibility Cloak, running from the school caretaker Filch. Finding an invisible object is not an easy task. Fortunately, Harry has friends who are willing to help. Hermione Granger had read ""The Invisibility Cloaks, and Everything about Them"", as well as six volumes of ""The Encyclopedia of Quick Search of Shortest Paths in Graphs, Network Flows, the Maximal Increasing Subsequences and Other Magical Objects"". She has already developed a search algorithm for the invisibility cloak in complex dynamic systems (Hogwarts is one of them).Hogwarts consists of n floors, numbered by integers from 1 to n. Some pairs of floors are connected by staircases. The staircases may change its position, moving exactly one end. Formally the situation is like this: if a staircase connects the floors a and b, then in one move it may modify its position so as to connect the floors a and c or b and c, where c is any floor different from a and b. Under no circumstances the staircase can connect a floor with itself. At the same time there can be multiple stairs between a pair of floors.Initially, Harry is on the floor with the number 1. He does not remember on what floor he has lost the cloak and wants to look for it on each of the floors. Therefore, his goal is to visit each of n floors at least once. Harry can visit the floors in any order and finish the searching at any floor.Nowadays the staircases move quite rarely. However, Ron and Hermione are willing to put a spell on any of them to help Harry find the cloak. To cause less suspicion, the three friends plan to move the staircases one by one, and no more than once for each staircase. In between shifting the staircases Harry will be able to move about the floors, reachable at the moment from the staircases, and look for his Invisibility Cloak. It is assumed that during all this time the staircases will not move spontaneously.Help the three friends to compose a searching plan. If there are several variants to solve the problem, any valid option (not necessarily the optimal one) will be accepted." 2900

65D "Harry Potter and the Sorting Hat" "brute force,dfs and similar,hashing" "As you know, Hogwarts has four houses: Gryffindor, Hufflepuff, Ravenclaw and Slytherin. The sorting of the first-years into houses is done by the Sorting Hat. The pupils are called one by one in the alphabetical order, each of them should put a hat on his head and, after some thought, the hat solemnly announces the name of the house the student should enter.At that the Hat is believed to base its considerations on the student\'s personal qualities: it sends the brave and noble ones to Gryffindor, the smart and shrewd ones \xe2\x80\x94 to Ravenclaw, the persistent and honest ones \xe2\x80\x94 to Hufflepuff and the clever and cunning ones \xe2\x80\x94 to Slytherin. However, a first year student Hermione Granger got very concerned about the forthcoming sorting. She studied all the literature on the Sorting Hat and came to the conclusion that it is much simpler than that. If the relatives of the student have already studied at Hogwarts, the hat puts the student to the same house, where his family used to study. In controversial situations, when the relatives studied in different houses or when they were all Muggles like Hermione\'s parents, then the Hat sorts the student to the house, to which the least number of first years has been sent at that moment. If there are several such houses, the choice is given to the student himself. Then the student can choose any of the houses, to which the least number of first years has been sent so far. Hermione has already asked the students that are on the list before her about their relatives. Now she and her new friends Harry Potter and Ron Weasley want to find out into what house the Hat will put Hermione." 2200

65C "Harry Potter and the Golden Snitch" "binary search,geometry" "Brothers Fred and George Weasley once got into the sporting goods store and opened a box of Quidditch balls. After long and painful experiments they found out that the Golden Snitch is not enchanted at all. It is simply a programmed device. It always moves along the same trajectory, which is a polyline with vertices at the points (x0,\xe2\x80\x89y0,\xe2\x80\x89z0), (x1,\xe2\x80\x89y1,\xe2\x80\x89z1), ..., (xn,\xe2\x80\x89yn,\xe2\x80\x89zn). At the beginning of the game the snitch is positioned at the point (x0,\xe2\x80\x89y0,\xe2\x80\x89z0), and then moves along the polyline at the constant speed vs. The twins have not yet found out how the snitch behaves then. Nevertheless, they hope that the retrieved information will help Harry Potter and his team in the upcoming match against Slytherin. Harry Potter learned that at the beginning the game he will be at the point (Px,\xe2\x80\x89Py,\xe2\x80\x89Pz) and his super fast Nimbus 2011 broom allows him to move at the constant speed vp in any direction or remain idle. vp is not less than the speed of the snitch vs. Harry Potter, of course, wants to catch the snitch as soon as possible. Or, if catching the snitch while it is moving along the polyline is impossible, he wants to hurry the Weasley brothers with their experiments. Harry Potter catches the snitch at the time when they are at the same point. Help Harry." 2100

65B "Harry Potter and the History of Magic" "brute force,greedy,implementation" "The History of Magic is perhaps the most boring subject in the Hogwarts school of Witchcraft and Wizardry. Harry Potter is usually asleep during history lessons, and his magical quill writes the lectures for him. Professor Binns, the history of magic teacher, lectures in such a boring and monotonous voice, that he has a soporific effect even on the quill. That\'s why the quill often makes mistakes, especially in dates.So, at the end of the semester Professor Binns decided to collect the students\' parchments with notes and check them. Ron Weasley is in a panic: Harry\'s notes may contain errors, but at least he has some notes, whereas Ron does not have any. Ronald also has been sleeping during the lectures and his quill had been eaten by his rat Scabbers. Hermione Granger refused to give Ron her notes, because, in her opinion, everyone should learn on their own. Therefore, Ron has no choice but to copy Harry\'s notes.Due to the quill\'s errors Harry\'s dates are absolutely confused: the years of goblin rebellions and other important events for the wizarding world do not follow in order, and sometimes even dates from the future occur. Now Ron wants to change some of the digits while he copies the notes so that the dates were in the chronological (i.e. non-decreasing) order and so that the notes did not have any dates strictly later than 2011, or strictly before than 1000. To make the resulting sequence as close as possible to the one dictated by Professor Binns, Ron will change no more than one digit in each date into other digit. Help him do it." 1700

65A "Harry Potter and Three Spells" implementation,math "A long time ago (probably even in the first book), Nicholas Flamel, a great alchemist and the creator of the Philosopher\'s Stone, taught Harry Potter three useful spells. The first one allows you to convert a grams of sand into b grams of lead, the second one allows you to convert c grams of lead into d grams of gold and third one allows you to convert e grams of gold into f grams of sand. When Harry told his friends about these spells, Ron Weasley was amazed. After all, if they succeed in turning sand into lead, lead into gold, and then turning part of the gold into sand again and so on, then it will be possible to start with a small amount of sand and get huge amounts of gold! Even an infinite amount of gold! Hermione Granger, by contrast, was skeptical about that idea. She argues that according to the law of conservation of matter getting an infinite amount of matter, even using magic, is impossible. On the contrary, the amount of matter may even decrease during transformation, being converted to magical energy. Though Hermione\'s theory seems convincing, Ron won\'t believe her. As far as Ron is concerned, Hermione made up her law of conservation of matter to stop Harry and Ron wasting their time with this nonsense, and to make them go and do homework instead. That\'s why Ron has already collected a certain amount of sand for the experiments. A quarrel between the friends seems unavoidable...Help Harry to determine which one of his friends is right, and avoid the quarrel after all. To do this you have to figure out whether it is possible to get the amount of gold greater than any preassigned number from some finite amount of sand." 1800

64I "Sort the Table" "*special problem,sortings" "You are given a rectangular table containing words. Each of its columns has its own name. You are also given the list of rules of sorting in form ""FIELD_NAME SORT_ORDER"", where SORT_ORDER is either ASC (nondescending order) or DESC (nonascending order). Rules in the list are separated by a single comma with a single space. You have to sort rows of the table primarily by the first rule, then, in case of a tie sort by the second rule. And so on. If two rows are equal in terms of every rule, then preserve their relative order. You can assume that each element of the table has type ""string"", so you have to use lexicographic comparison." 2400

64H "Table Bowling" "*special problem,sortings" "Table bowling tournament participant completed the competition according to the given final standings table. The table is given as a sequence of lines, each line has a format ""name score"". Your task is to prepare another table consisting of lines in the form ""place name"". Sort participant by score (desc.) and by the name lexicographically in the case of a tie. Places are numerated from 1. If more than one participant has some score, all of them share the places and you should output something like ""12-14 john"".Please, look into the samples for clarification." 2300

64G "Path Canonization" "*special problem" "A path in some Unix-similar file system is given. The path consists of elements separated with characters ""/"". For example: ""/usr/share/mysql/../tomcat6/conf/server.xml"". The path starts with the root directory (i.e. starts with the character ""/""). Each element means a name of file or directory, or it is one of two special elements: ""."" \xd0\xb8\xd0\xbb\xd0\xb8 "".."". First of them stands for the current directory (for example, path ""/./usr/././share"" is equal to ""/usr/share""). The second element "".."" stands for the moving to the parent directory (for example, path ""/usr/share/../lib"" is equal to ""/usr/lib"").You task is to convert the given path to such a path, which doesn\'t contain special elements ""."" and/or "".."". If it is impossible, print ""-1"". The only reason for it is an attempt to move to the parent directory from the root." 2200

64F Domain "*special problem,expression parsing" "This problem doesn\'t contain real-world specifications about domains, just use the problem statement as a formal document to solve the problem.The given string s is a domain name if it contains the characters ""a""-""z"", ""0""-""9"" and dots. No two dots shoud follow one after another (consecutive). The dots split the given string s into the parts, the last (most right) part should have the length 2 or 3. Domain can\'t start or end with a dot.You are given the string s, check if it is domain name." 2000

64E "Prime Segment" "*special problem,brute force,math,number theory" "Positive integer number x is called prime, if it has exactly two positive integer divisors. For example, 2, 3, 17, 97 are primes, but 1, 10, 120 are not.You are given an integer number n, find the shortest segment [a,\xe2\x80\x89b], which contains n (i.e. a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b) and a,\xe2\x80\x89b are primes." 1800

64D Presents "*special problem,greedy" "You are given the prices of three presents. Also there are three sisters. It is known that the most valuable present is for the eldest sister. The second (by price) is for the second sister. And the less valuable present is for the youngest sister. If two (or three) presents have the same price, corresponding sisters may get the in a random way." 1800

64C Table "*special problem,greedy,implementation,math" "The integer numbers from 1 to nm was put into rectangular table having n rows and m columns. The numbers was put from left to right, from top to bottom, i.e. the first row contains integers 1,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89m, the second \xe2\x80\x94 m\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89m\xe2\x80\x89+\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x892\xe2\x80\x89*\xe2\x80\x89m and so on.After it these numbers was written on the paper in another order: from top to bottom, from left to right. First, the numbers in the first column was written (from top to bottom) and so on.Print the k-th number on the paper." 1600

64B Expression "*special problem,expression parsing" "You are given a line \xc2\xabn#m\xc2\xbb, where \xc2\xabn\xc2\xbb and \xc2\xabm\xc2\xbb are digits, and \xc2\xab#\xc2\xbb is a sign \xc2\xab+\xc2\xbb or \xc2\xab-\xc2\xbb. Print the value of the given expression." 1500

64A Factorial "*special problem,implementation" "Print the factorial of the given integer number n. The factorial of n is equal to 1\xc2\xb72\xc2\xb7...\xc2\xb7n." 1300

63E "Sweets Game" "bitmasks,dfs and similar,dp,games,implementation" "Karlsson has visited Lillebror again. They found a box of chocolates and a big whipped cream cake at Lillebror\'s place. Karlsson immediately suggested to divide the sweets fairly between Lillebror and himself. Specifically, to play together a game he has just invented with the chocolates. The winner will get the cake as a reward.The box of chocolates has the form of a hexagon. It contains 19 cells for the chocolates, some of which contain a chocolate. The players move in turns. During one move it is allowed to eat one or several chocolates that lay in the neighboring cells on one line, parallel to one of the box\'s sides. The picture below shows the examples of allowed moves and of an unacceptable one. The player who cannot make a move loses.  Karlsson makes the first move as he is Lillebror\'s guest and not vice versa. The players play optimally. Determine who will get the cake." 2000

63D "Dividing Island" "constructive algorithms" "A revolution took place on the Buka Island. New government replaced the old one. The new government includes n parties and each of them is entitled to some part of the island according to their contribution to the revolution. However, they can\'t divide the island.The island can be conventionally represented as two rectangles a\xe2\x80\x89\xc3\x97\xe2\x80\x89b and c\xe2\x80\x89\xc3\x97\xe2\x80\x89d unit squares in size correspondingly. The rectangles are located close to each other. At that, one of the sides with the length of a and one of the sides with the length of c lie on one line. You can see this in more details on the picture.  The i-th party is entitled to a part of the island equal to xi unit squares. Every such part should fully cover several squares of the island (it is not allowed to cover the squares partially) and be a connected figure. A ""connected figure"" presupposes that from any square of this party one can move to any other square of the same party moving through edge-adjacent squares also belonging to that party.Your task is to divide the island between parties." 1900

63C "Bulls and Cows" "brute force,implementation" "The ""Bulls and Cows"" game needs two people to play. The thinker thinks of a number and the guesser tries to guess it.The thinker thinks of a four-digit number in the decimal system. All the digits in the number are different and the number may have a leading zero. It can\'t have more than one leading zero, because all it\'s digits should be different. The guesser tries to guess the number. He makes a series of guesses, trying experimental numbers and receives answers from the first person in the format ""x bulls y cows"". x represents the number of digits in the experimental number that occupy the same positions as in the sought number. y represents the number of digits of the experimental number that present in the sought number, but occupy different positions. Naturally, the experimental numbers, as well as the sought number, are represented by four-digit numbers where all digits are different and a leading zero can be present.For example, let\'s suppose that the thinker thought of the number 0123. Then the guessers\' experimental number 1263 will receive a reply ""1 bull 2 cows"" (3 occupies the same positions in both numbers and 1 and 2 are present in both numbers but they occupy different positions). Also, the answer to number 8103 will be ""2 bulls 1 cow"" (analogically, 1 and 3 occupy the same positions and 0 occupies a different one). When the guesser is answered ""4 bulls 0 cows"", the game is over.Now the guesser has already made several guesses and wants to know whether his next guess can possibly be the last one." 1700

63B "Settlers\' Training" implementation "The ""Bulls and Cows"" game needs two people to play. The thinker thinks of a number and the guesser tries to guess it.The thinker thinks of a four-digit number in the decimal system. All the digits in the number are different and the number may have a leading zero. It can\'t have more than one leading zero, because all it\'s digits should be different. The guesser tries to guess the number. He makes a series of guesses, trying experimental numbers and receives answers from the first person in the format ""x bulls y cows"". x represents the number of digits in the experimental number that occupy the same positions as in the sought number. y represents the number of digits of the experimental number that present in the sought number, but occupy different positions. Naturally, the experimental numbers, as well as the sought number, are represented by four-digit numbers where all digits are different and a leading zero can be present.For example, let\'s suppose that the thinker thought of the number 0123. Then the guessers\' experimental number 1263 will receive a reply ""1 bull 2 cows"" (3 occupies the same positions in both numbers and 1 and 2 are present in both numbers but they occupy different positions). Also, the answer to number 8103 will be ""2 bulls 1 cow"" (analogically, 1 and 3 occupy the same positions and 0 occupies a different one). When the guesser is answered ""4 bulls 0 cows"", the game is over.Now the guesser has already made several guesses and wants to know whether his next guess can possibly be the last one." 1200

63A "Sinking Ship" implementation,sortings,strings "The ship crashed into a reef and is sinking. Now the entire crew must be evacuated. All n crew members have already lined up in a row (for convenience let\'s label them all from left to right with positive integers from 1 to n) and await further instructions. However, one should evacuate the crew properly, in a strict order. Specifically:The first crew members to leave the ship are rats. Then women and children (both groups have the same priority) leave the ship. After that all men are evacuated from the ship. The captain leaves the sinking ship last.If we cannot determine exactly who should leave the ship first for any two members of the crew by the rules from the previous paragraph, then the one who stands to the left in the line leaves the ship first (or in other words, the one whose number in the line is less).For each crew member we know his status as a crew member, and also his name. All crew members have different names. Determine the order in which to evacuate the crew." 900

62E "World Evil" dp,flows "As a result of Pinky and Brain\'s mysterious experiments in the Large Hadron Collider some portals or black holes opened to the parallel dimension. And the World Evil has crept to the veil between their world and ours. Brain quickly evaluated the situation and he understood that the more evil tentacles creep out and become free, the higher is the possibility that Brain will rule the world.The collider\'s constriction is a rectangular grid rolled into a cylinder and consisting of n rows and m columns such as is shown in the picture below:  In this example n\xe2\x80\x89=\xe2\x80\x894, m\xe2\x80\x89=\xe2\x80\x895. Dotted lines are corridores that close each column to a ring, i. e. connect the n-th and the 1-th rows of the grid.In the leftmost column of the grid the portals are situated and the tentacles of the World Evil are ready to creep out from there. In the rightmost column the exit doors are located. The tentacles can only get out through those doors. The segments joining the nodes of the grid are corridors.Brain would be glad to let all the tentacles out but he faces a problem: the infinite number of tentacles can creep out of the portals, every tentacle possesses infinite length and some width and the volume of the corridors are, unfortunately, quite limited. Brain could approximately evaluate the maximal number of tentacles that will be able to crawl through every corridor.Now help the mice to determine the maximal number of tentacles of the World Evil that will crawl out of the Large Hadron Collider." 2700

62D Wormhouse "dfs and similar,graphs" "Arnie the Worm has finished eating an apple house yet again and decided to move. He made up his mind on the plan, the way the rooms are located and how they are joined by corridors. He numbered all the rooms from 1 to n. All the corridors are bidirectional.Arnie wants the new house to look just like the previous one. That is, it should have exactly n rooms and, if a corridor from room i to room j existed in the old house, it should be built in the new one. We know that during the house constructing process Arnie starts to eat an apple starting from some room and only stops when he eats his way through all the corridors and returns to the starting room. It is also known that Arnie eats without stopping. That is, until Arnie finishes constructing the house, he is busy every moment of his time gnawing a new corridor. Arnie doesn\'t move along the already built corridors.However, gnawing out corridors in one and the same order any time you change a house is a very difficult activity. That\'s why Arnie, knowing the order in which the corridors were located in the previous house, wants to gnaw corridors in another order. It is represented as a list of rooms in the order in which they should be visited. The new list should be lexicographically smallest, but it also should be strictly lexicographically greater than the previous one. Help the worm." 2300

62C Inquisition geometry,implementation,sortings "In Medieval times existed the tradition of burning witches at steaks together with their pets, black cats. By the end of the 15-th century the population of black cats ceased to exist. The difficulty of the situation led to creating the EIC - the Emergency Inquisitory Commission.The resolution #666 says that a white cat is considered black when and only when the perimeter of its black spots exceeds the acceptable norm. But what does the acceptable norm equal to? Every inquisitor will choose it himself depending on the situation. And your task is to find the perimeter of black spots on the cat\'s fur.The very same resolution says that the cat\'s fur is a white square with the length of 105. During the measurement of spots it is customary to put the lower left corner of the fur into the origin of axes (0;0) and the upper right one \xe2\x80\x94 to the point with coordinates (105;105). The cats\' spots are nondegenerate triangles. The spots can intersect and overlap with each other, but it is guaranteed that each pair of the triangular spots\' sides have no more than one common point.We\'ll regard the perimeter in this problem as the total length of the boarders where a cat\'s fur changes color." 2300

62B Tyndex.Brome "binary search,implementation" "Tyndex is again well ahead of the rivals! The reaction to the release of Zoozle Chrome browser was the release of a new browser Tyndex.Brome!The popularity of the new browser is growing daily. And the secret is not even the Tyndex.Bar installed (the Tyndex.Bar automatically fills the glass with the finest 1664 cognac after you buy Tyndex.Bottles and insert in into a USB port). It is highly popular due to the well-thought interaction with the user.Let us take, for example, the system of automatic address correction. Have you entered codehorses instead of codeforces? The gloomy Zoozle Chrome will sadly say that the address does not exist. Tyndex.Brome at the same time will automatically find the closest address and sent you there. That\'s brilliant!How does this splendid function work? That\'s simple! For each potential address a function of the F error is calculated by the following rules:  for every letter ci from the potential address c the closest position j of the letter ci in the address (s) entered by the user is found. The absolute difference |i\xe2\x80\x89-\xe2\x80\x89j| of these positions is added to F. So for every i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|c|) the position j is chosen such, that ci\xe2\x80\x89=\xe2\x80\x89sj, and |i\xe2\x80\x89-\xe2\x80\x89j| is minimal possible.  if no such letter ci exists in the address entered by the user, then the length of the potential address |c| is added to F. After the values of the error function have been calculated for all the potential addresses the most suitable one is found. To understand the special features of the above described method better, it is recommended to realize the algorithm of calculating the F function for an address given by the user and some set of potential addresses. Good luck!" 1800

62A "A Student\'s Dream" greedy,math "Tyndex is again well ahead of the rivals! The reaction to the release of Zoozle Chrome browser was the release of a new browser Tyndex.Brome!The popularity of the new browser is growing daily. And the secret is not even the Tyndex.Bar installed (the Tyndex.Bar automatically fills the glass with the finest 1664 cognac after you buy Tyndex.Bottles and insert in into a USB port). It is highly popular due to the well-thought interaction with the user.Let us take, for example, the system of automatic address correction. Have you entered codehorses instead of codeforces? The gloomy Zoozle Chrome will sadly say that the address does not exist. Tyndex.Brome at the same time will automatically find the closest address and sent you there. That\'s brilliant!How does this splendid function work? That\'s simple! For each potential address a function of the F error is calculated by the following rules:  for every letter ci from the potential address c the closest position j of the letter ci in the address (s) entered by the user is found. The absolute difference |i\xe2\x80\x89-\xe2\x80\x89j| of these positions is added to F. So for every i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|c|) the position j is chosen such, that ci\xe2\x80\x89=\xe2\x80\x89sj, and |i\xe2\x80\x89-\xe2\x80\x89j| is minimal possible.  if no such letter ci exists in the address entered by the user, then the length of the potential address |c| is added to F. After the values of the error function have been calculated for all the potential addresses the most suitable one is found. To understand the special features of the above described method better, it is recommended to realize the algorithm of calculating the F function for an address given by the user and some set of potential addresses. Good luck!" 1300

61E "Enemy is weak" "data structures,trees" "The Romans have attacked again. This time they are much more than the Persians but Shapur is ready to defeat them. He says: ""A lion is never afraid of a hundred sheep"". Nevertheless Shapur has to find weaknesses in the Roman army to defeat them. So he gives the army a weakness number.In Shapur\'s opinion the weakness of an army is equal to the number of triplets i,\xe2\x80\x89j,\xe2\x80\x89k such that i\xe2\x80\x89<\xe2\x80\x89j\xe2\x80\x89<\xe2\x80\x89k and ai\xe2\x80\x89>\xe2\x80\x89aj\xe2\x80\x89>\xe2\x80\x89ak where ax is the power of man standing at position x. The Roman army has one special trait \xe2\x80\x94 powers of all the people in it are distinct.Help Shapur find out how weak the Romans are." 1900

61D "Eternal Victory" "dfs and similar,graphs,greedy,shortest paths,trees" "Valerian was captured by Shapur. The victory was such a great one that Shapur decided to carve a scene of Valerian\'s defeat on a mountain. So he had to find the best place to make his victory eternal!He decided to visit all n cities of Persia to find the best available mountain, but after the recent war he was too tired and didn\'t want to traverse a lot. So he wanted to visit each of these n cities at least once with smallest possible traverse. Persian cities are connected with bidirectional roads. You can go from any city to any other one using these roads and there is a unique path between each two cities.All cities are numbered 1 to n. Shapur is currently in the city 1 and he wants to visit all other cities with minimum possible traverse. He can finish his travels in any city.Help Shapur find how much He should travel." 1800

61C "Capture Valerian" math "It\'s now 260 AD. Shapur, being extremely smart, became the King of Persia. He is now called Shapur, His majesty King of kings of Iran and Aniran.Recently the Romans declared war on Persia. They dreamed to occupy Armenia. In the recent war, the Romans were badly defeated. Now their senior army general, Philip is captured by Shapur and Shapur is now going to capture Valerian, the Roman emperor.Being defeated, the cowardly Valerian hid in a room at the top of one of his castles. To capture him, Shapur has to open many doors. Fortunately Valerian was too scared to make impenetrable locks for the doors.Each door has 4 parts. The first part is an integer number a. The second part is either an integer number b or some really odd sign which looks like R. The third one is an integer c and the fourth part is empty! As if it was laid for writing something. Being extremely gifted, after opening the first few doors, Shapur found out the secret behind the locks.c is an integer written in base a, to open the door we should write it in base b. The only bad news is that this R is some sort of special numbering system that is used only in Roman empire, so opening the doors is not just a piece of cake!Here\'s an explanation of this really weird number system that even doesn\'t have zero:Roman numerals are based on seven symbols: a stroke (identified with the letter I) for a unit, a chevron (identified with the letter V) for a five, a cross-stroke (identified with the letter X) for a ten, a C (identified as an abbreviation of Centum) for a hundred, etc.: I=1 V=5 X=10 L=50 C=100 D=500 M=1000Symbols are iterated to produce multiples of the decimal (1, 10, 100, 1,\xe2\x80\x89000) values, with V, L, D substituted for a multiple of five, and the iteration continuing: I 1, II 2, III 3, V 5, VI 6, VII 7, etc., and the same for other bases: X 10, XX 20, XXX 30, L 50, LXXX 80; CC 200, DCC 700, etc. At the fourth and ninth iteration, a subtractive principle must be employed, with the base placed before the higher base: IV 4, IX 9, XL 40, XC 90, CD 400, CM 900.Also in bases greater than 10 we use A for 10, B for 11, etc.Help Shapur capture Valerian and bring peace back to Persia, especially Armenia." 2000

61B "Hard Work" strings "After the contest in comparing numbers, Shapur\'s teacher found out that he is a real genius and that no one could possibly do the calculations faster than him even using a super computer!Some days before the contest, the teacher took a very simple-looking exam and all his n students took part in the exam. The teacher gave them 3 strings and asked them to concatenate them. Concatenating strings means to put them in some arbitrary order one after the other. For example from concatenating Alireza and Amir we can get to AlirezaAmir or AmirAlireza depending on the order of concatenation.Unfortunately enough, the teacher forgot to ask students to concatenate their strings in a pre-defined order so each student did it the way he/she liked.Now the teacher knows that Shapur is such a fast-calculating genius boy and asks him to correct the students\' papers.Shapur is not good at doing such a time-taking task. He rather likes to finish up with it as soon as possible and take his time to solve 3-SAT in polynomial time. Moreover, the teacher has given some advice that Shapur has to follow. Here\'s what the teacher said:   As I expect you know, the strings I gave to my students (including you) contained only lowercase and uppercase Persian Mikhi-Script letters. These letters are too much like Latin letters, so to make your task much harder I converted all the initial strings and all of the students\' answers to Latin.  As latin alphabet has much less characters than Mikhi-Script, I added three odd-looking characters to the answers, these include ""-"", "";"" and ""_"". These characters are my own invention of course! And I call them Signs.  The length of all initial strings was less than or equal to 100 and the lengths of my students\' answers are less than or equal to 600  My son, not all students are genius as you are. It is quite possible that they make minor mistakes changing case of some characters. For example they may write ALiReZaAmIR instead of AlirezaAmir. Don\'t be picky and ignore these mistakes.  Those signs which I previously talked to you about are not important. You can ignore them, since many students are in the mood for adding extra signs or forgetting about a sign. So something like Iran;;-- is the same as --;IRAN  You should indicate for any of my students if his answer was right or wrong. Do this by writing ""WA"" for Wrong answer or ""ACC"" for a correct answer.  I should remind you that none of the strings (initial strings or answers) are empty.  Finally, do these as soon as possible. You have less than 2 hours to complete this." 1300

61A "Ultra-Fast Mathematician" implementation "Shapur was an extremely gifted student. He was great at everything including Combinatorics, Algebra, Number Theory, Geometry, Calculus, etc. He was not only smart but extraordinarily fast! He could manage to sum 1018 numbers in a single second.One day in 230 AD Shapur was trying to find out if any one can possibly do calculations faster than him. As a result he made a very great contest and asked every one to come and take part.In his contest he gave the contestants many different pairs of numbers. Each number is made from digits 0 or 1. The contestants should write a new number corresponding to the given pair of numbers. The rule is simple: The i-th digit of the answer is 1 if and only if the i-th digit of the two given numbers differ. In the other case the i-th digit of the answer is 0.Shapur made many numbers and first tried his own speed. He saw that he can perform these operations on numbers of length \xe2\x88\x9e (length of a number is number of digits in it) in a glance! He always gives correct answers so he expects the contestants to give correct answers, too. He is a good fellow so he won\'t give anyone very big numbers and he always gives one person numbers of same length.Now you are going to take part in Shapur\'s contest. See if you are faster and more accurate." 800

60E "Mushroom Gnomes" math,matrices "Once upon a time in the thicket of the mushroom forest lived mushroom gnomes. They were famous among their neighbors for their magic mushrooms. Their magic nature made it possible that between every two neighboring mushrooms every minute grew another mushroom with the weight equal to the sum of weights of two neighboring ones. The mushroom gnomes loved it when everything was in order, that\'s why they always planted the mushrooms in one line in the order of their weights\' increasing. Well... The gnomes planted the mushrooms and went to eat. After x minutes they returned and saw that new mushrooms had grown up, so that the increasing order had been violated. The gnomes replanted all the mushrooms in the correct order, that is, they sorted the mushrooms in the order of the weights\' increasing. And went to eat again (those gnomes were quite big eaters). What total weights modulo p will the mushrooms have in another y minutes?" 2600

60D Savior "brute force,dsu,math" "Misha decided to help Pasha and Akim be friends again. He had a cunning plan \xe2\x80\x94 to destroy all the laughy mushrooms. He knows that the laughy mushrooms can easily burst when they laugh. Mushrooms grow on the lawns. There are a[t] mushrooms on the t-th lawn.Misha knows that the lawns where the mushrooms grow have a unique ability. A lawn (say, i) can transfer laugh to other lawn (say, j) if there exists an integer (say, b) such, that some permutation of numbers a[i],\xe2\x80\x89a[j] and b is a beautiful triple (i\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89j). A beautiful triple is such three pairwise coprime numbers x,\xe2\x80\x89y,\xe2\x80\x89z, which satisfy the following condition: x2\xe2\x80\x89+\xe2\x80\x89y2\xe2\x80\x89=\xe2\x80\x89z2.Misha wants to know on which minimal number of lawns he should laugh for all the laughy mushrooms to burst." 2500

60C "Mushroom Strife" "brute force,dfs and similar" "Pasha and Akim were making a forest map \xe2\x80\x94 the lawns were the graph\'s vertexes and the roads joining the lawns were its edges. They decided to encode the number of laughy mushrooms on every lawn in the following way: on every edge between two lawns they wrote two numbers, the greatest common divisor (GCD) and the least common multiple (LCM) of the number of mushrooms on these lawns. But one day Pasha and Akim had an argument about the laughy mushrooms and tore the map. Pasha was left with just some part of it, containing only m roads. Your task is to help Pasha \xe2\x80\x94 use the map he has to restore the number of mushrooms on every lawn. As the result is not necessarily unique, help Pasha to restore any one or report that such arrangement of mushrooms does not exist. It is guaranteed that the numbers on the roads on the initial map were no less that 1 and did not exceed 106." 2100

60B "Serial Time!" "dfs and similar,dsu" "The Cereal Guy\'s friend Serial Guy likes to watch soap operas. An episode is about to start, and he hasn\'t washed his plate yet. But he decided to at least put in under the tap to be filled with water. The plate can be represented by a parallelepiped k\xe2\x80\x89\xc3\x97\xe2\x80\x89n\xe2\x80\x89\xc3\x97\xe2\x80\x89m, that is, it has k layers (the first layer is the upper one), each of which is a rectangle n\xe2\x80\x89\xc3\x97\xe2\x80\x89m with empty squares (\'.\') and obstacles (\'#\'). The water can only be present in the empty squares. The tap is positioned above the square (x,\xe2\x80\x89y) of the first layer, it is guaranteed that this square is empty. Every minute a cubical unit of water falls into the plate. Find out in how many minutes the Serial Guy should unglue himself from the soap opera and turn the water off for it not to overfill the plate. That is, you should find the moment of time when the plate is absolutely full and is going to be overfilled in the next moment.Note: the water fills all the area within reach (see sample 4). Water flows in each of the 6 directions, through faces of 1\xe2\x80\x89\xc3\x97\xe2\x80\x891\xe2\x80\x89\xc3\x97\xe2\x80\x891 cubes." 1400

60A "Where Are My Flakes?" "implementation,two pointers" "One morning the Cereal Guy found out that all his cereal flakes were gone. He found a note instead of them. It turned out that his smart roommate hid the flakes in one of n boxes. The boxes stand in one row, they are numbered from 1 to n from the left to the right. The roommate left hints like ""Hidden to the left of the i-th box"" (""To the left of i""), ""Hidden to the right of the i-th box"" (""To the right of i""). Such hints mean that there are no flakes in the i-th box as well. The Cereal Guy wants to know the minimal number of boxes he necessarily needs to check to find the flakes considering all the hints. Or he wants to find out that the hints are contradictory and the roommate lied to him, that is, no box has the flakes." 1300

59E "Shortest Path" "graphs,shortest paths" "In Ancient Berland there were n cities and m two-way roads of equal length. The cities are numbered with integers from 1 to n inclusively. According to an ancient superstition, if a traveller visits three cities ai, bi, ci in row, without visiting other cities between them, a great disaster awaits him. Overall there are k such city triplets. Each triplet is ordered, which means that, for example, you are allowed to visit the cities in the following order: ai, ci, bi. Vasya wants to get from the city 1 to the city n and not fulfil the superstition. Find out which minimal number of roads he should take. Also you are required to find one of his possible path routes." 2000

59D "Team Arrangement" "constructive algorithms,greedy,implementation" "Recently personal training sessions have finished in the Berland State University Olympiad Programmer Training Centre. By the results of these training sessions teams are composed for the oncoming team contest season. Each team consists of three people. All the students of the Centre possess numbers from 1 to 3n, and all the teams possess numbers from 1 to n. The splitting of students into teams is performed in the following manner: while there are people who are not part of a team, a person with the best total score is chosen among them (the captain of a new team), this person chooses for himself two teammates from those who is left according to his list of priorities. The list of every person\'s priorities is represented as a permutation from the rest of 3n\xe2\x80\x89-\xe2\x80\x891 students who attend the centre, besides himself.You are given the results of personal training sessions which are a permutation of numbers from 1 to 3n, where the i-th number is the number of student who has won the i-th place. No two students share a place. You are also given the arrangement of the already formed teams in the order in which they has been created. Your task is to determine the list of priorities for the student number k. If there are several priority lists, choose the lexicographically minimal one." 2000

59C Title "expression parsing" "Vasya has recently finished writing a book. Now he faces the problem of giving it the title. Vasya wants the title to be vague and mysterious for his book to be noticeable among others. That\'s why the title should be represented by a single word containing at least once each of the first k Latin letters and not containing any other ones. Also, the title should be a palindrome, that is it should be read similarly from the left to the right and from the right to the left.Vasya has already composed the approximate variant of the title. You are given the title template s consisting of lowercase Latin letters and question marks. Your task is to replace all the question marks by lowercase Latin letters so that the resulting word satisfies the requirements, described above. Each question mark should be replaced by exactly one letter, it is not allowed to delete characters or add new ones to the template. If there are several suitable titles, choose the first in the alphabetical order, for Vasya\'s book to appear as early as possible in all the catalogues." 1600

59B "Fortune Telling" "implementation,number theory" "Marina loves Sasha. But she keeps wondering whether Sasha loves her. Of course, the best way to know it is fortune telling. There are many ways of telling fortune, but Marina has picked the easiest one. She takes in her hand one or several camomiles and tears off the petals one by one. After each petal she pronounces alternatively ""Loves"" and ""Doesn\'t love"", at that Marina always starts with ""Loves"". There are n camomiles growing in the field, possessing the numbers of petals equal to a1,\xe2\x80\x89a2,\xe2\x80\x89... an. Marina wants to pick a bouquet with the maximal possible total number of petals so that the result would still be ""Loves"". Help her do that; find the maximal number of petals possible in the bouquet." 1200

59A Word implementation,strings "Vasya is very upset that many people on the Net mix uppercase and lowercase letters in one word. That\'s why he decided to invent an extension for his favorite browser that would change the letters\' register in every word so that it either only consisted of lowercase letters or, vice versa, only of uppercase ones. At that as little as possible letters should be changed in the word. For example, the word HoUse must be replaced with house, and the word ViP \xe2\x80\x94 with VIP. If a word contains an equal number of uppercase and lowercase letters, you should replace all the letters with lowercase ones. For example, maTRIx should be replaced by matrix. Your task is to use the given method on one given word." 800

58E Expression dp "You are given a line \xc2\xabn#m\xc2\xbb, where \xc2\xabn\xc2\xbb and \xc2\xabm\xc2\xbb are digits, and \xc2\xab#\xc2\xbb is a sign \xc2\xab+\xc2\xbb or \xc2\xab-\xc2\xbb. Print the value of the given expression." 2400

58D Calendar greedy,strings "BerOilGasDiamondBank has branches in n cities, at that n is an even number. The bank management wants to publish a calendar with the names of all those cities written in two columns: the calendar should consist of exactly n\xe2\x80\x89/\xe2\x80\x892 lines of strictly equal length, each of which contains exactly two names and exactly one separator character between them. The name of every city should be used in the calendar exactly once. For historical reasons the symbol d is used as the separator of words in the calendar. The BerOilGasDiamondBank management wants to show that all its branches are equally important to it, that\'s why the order of their appearance in the calendar should be following: if we ""glue""(concatinate) all the n\xe2\x80\x89/\xe2\x80\x892 calendar lines (from top to bottom) to make a single line, then the lexicographically minimal line is obtained. No separator character will be used to separate calendar lines. For example, if the lines are ""bertown!berville"", ""newberville!bera"", then the resulting line is ""bertown!bervillenewberville!bera"". In some sense one has to find the lexicographically minimal calendar, where the comparison of calendars happens line by line.Help BerOilGasDiamondBank and construct the required calendar." 2000

58C Trees "brute force" "On Bertown\'s main street n trees are growing, the tree number i has the height of ai meters (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n). By the arrival of the President of Berland these trees were decided to be changed so that their heights formed a beautiful sequence. This means that the heights of trees on ends (the 1st one and the n-th one) should be equal to each other, the heights of the 2-nd and the (n\xe2\x80\x89-\xe2\x80\x891)-th tree must also be equal to each other, at that the height of the 2-nd tree should be larger than the height of the first tree by 1, and so on. In other words, the heights of the trees, standing at equal distance from the edge (of one end of the sequence) must be equal to each other, and with the increasing of the distance from the edge by 1 the tree height must also increase by 1. For example, the sequences ""2 3 4 5 5 4 3 2"" and ""1 2 3 2 1"" are beautiful, and \'1 3 3 1"" and ""1 2 3 1"" are not. Changing the height of a tree is a very expensive operation, using advanced technologies invented by Berland scientists. In one operation you can choose any tree and change its height to any number, either increase or decrease. Note that even after the change the height should remain a positive integer, i. e, it can\'t be less than or equal to zero. Identify the smallest number of changes of the trees\' height needed for the sequence of their heights to become beautiful." 1800

58B Coins greedy "In Berland a money reform is being prepared. New coins are being introduced. After long economic calculations was decided that the most expensive coin should possess the denomination of exactly n Berland dollars. Also the following restriction has been introduced for comfort: the denomination of each coin should be divisible by the denomination of any cheaper coin. It is known that among all the possible variants the variant with the largest number of new coins will be chosen. Find this variant. Print in the order of decreasing of the coins\' denominations." 1300

58A "Chat room" greedy,strings "Vasya has recently learned to type and log on to the Internet. He immediately entered a chat room and decided to say hello to everybody. Vasya typed the word s. It is considered that Vasya managed to say hello if several letters can be deleted from the typed word so that it resulted in the word ""hello"". For example, if Vasya types the word ""ahhellllloou"", it will be considered that he said hello, and if he types ""hlelo"", it will be considered that Vasya got misunderstood and he didn\'t manage to say hello. Determine whether Vasya managed to say hello by the given word s." 1000

57E Chess "math,shortest paths" "Brian the Rabbit adores chess. Not long ago he argued with Stewie the Rabbit that a knight is better than a king. To prove his point he tries to show that the knight is very fast but Stewie doesn\'t accept statements without evidence. He constructed an infinite chessboard for Brian, where he deleted several squares to add some more interest to the game. Brian only needs to count how many different board squares a knight standing on a square with coordinates of (0,\xe2\x80\x890) can reach in no more than k moves. Naturally, it is forbidden to move to the deleted squares.Brian doesn\'t very much like exact sciences himself and is not acquainted with programming, that\'s why he will hardly be able to get ahead of Stewie who has already started solving the problem. Help Brian to solve the problem faster than Stewie." 3000

57D Journey dp,math "Stewie the Rabbit explores a new parallel universe. This two dimensional universe has the shape of a rectangular grid, containing n lines and m columns. The universe is very small: one cell of the grid can only contain one particle. Each particle in this universe is either static or dynamic. Each static particle always remains in one and the same position. Due to unintelligible gravitation laws no two static particles in the parallel universe can be present in one column or row, and they also can\'t be present in the diagonally adjacent cells. A dynamic particle appears in a random empty cell, randomly chooses the destination cell (destination cell may coincide with the start cell, see the samples) and moves there along the shortest path through the cells, unoccupied by the static particles. All empty cells have the same probability of being selected as the beginning or end of the path. Having reached the destination cell, the particle disappears. Only one dynamic particle can exist at one moment of time. This particle can move from a cell to a cell if they have an adjacent side, and this transition takes exactly one galactic second. Stewie got interested in what is the average lifespan of one particle in the given universe." 2500

57C Array combinatorics,math "Chris the Rabbit has been interested in arrays ever since he was a child. At the moment he is researching arrays with the length of n, containing only integers from 1 to n. He is not good at math, that\'s why some simple things drive him crazy. For example, yesterday he grew keen on counting how many different beautiful arrays there are. Chris thinks that an array is beautiful if it meets one of the two conditions:   each elements, starting from the second one, is no more than the preceding one  each element, starting from the second one, is no less than the preceding one Having got absolutely mad at himself and at math, Chris came to Stewie and Brian to ask them for help. However, they only laughed at him and said that the answer is too simple and not interesting. Help Chris the Rabbit to find the answer at last." 1900

57B "Martian Architecture" implementation "Chris the Rabbit found the traces of an ancient Martian civilization. The brave astronomer managed to see through a small telescope an architecture masterpiece \xe2\x80\x94 ""A Road to the Sun"". The building stands on cubical stones of the same size. The foundation divides the entire ""road"" into cells, into which the cubical stones are fit tightly. Thus, to any cell of the foundation a coordinate can be assigned. To become the leader of the tribe, a Martian should build a Road to the Sun, that is to build from those cubical stones on a given foundation a stairway. The stairway should be described by the number of stones in the initial coordinate and the coordinates of the stairway\'s beginning and end. Each following cell in the coordinate\'s increasing order should contain one cubical stone more than the previous one. At that if the cell has already got stones, they do not count in this building process, the stairways were simply built on them. In other words, let us assume that a stairway is built with the initial coordinate of l, the final coordinate of r and the number of stones in the initial coordinate x. That means that x stones will be added in the cell l, x\xe2\x80\x89+\xe2\x80\x891 stones will be added in the cell l\xe2\x80\x89+\xe2\x80\x891, ..., x\xe2\x80\x89+\xe2\x80\x89r\xe2\x80\x89-\xe2\x80\x89l stones will be added in the cell r.Chris managed to find an ancient manuscript, containing the descriptions of all the stairways. Now he wants to compare the data to be sure that he has really found ""A Road to the Sun"". For that he chose some road cells and counted the total number of cubical stones that has been accumulated throughout the Martian history and then asked you to count using the manuscript to what the sum should ideally total." 1600

57A "Square Earth?" "dfs and similar,greedy,implementation" "Meg the Rabbit decided to do something nice, specifically \xe2\x80\x94 to determine the shortest distance between two points on the surface of our planet. But Meg... what can you say, she wants everything simple. So, she already regards our planet as a two-dimensional circle. No, wait, it\'s even worse \xe2\x80\x94 as a square of side n. Thus, the task has been reduced to finding the shortest path between two dots on a square (the path should go through the square sides). To simplify the task let us consider the vertices of the square to lie at points whose coordinates are: (0,\xe2\x80\x890), (n,\xe2\x80\x890), (0,\xe2\x80\x89n) and (n,\xe2\x80\x89n)." 1300

56E "Domino Principle" "binary search,data structures,sortings" "Vasya is interested in arranging dominoes. He is fed up with common dominoes and he uses the dominoes of different heights. He put n dominoes on the table along one axis, going from left to right. Every domino stands perpendicular to that axis so that the axis passes through the center of its base. The i-th domino has the coordinate xi and the height hi. Now Vasya wants to learn for every domino, how many dominoes will fall if he pushes it to the right. Help him do that. Consider that a domino falls if it is touched strictly above the base. In other words, the fall of the domino with the initial coordinate x and height h leads to the fall of all dominoes on the segment [x\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89x\xe2\x80\x89+\xe2\x80\x89h\xe2\x80\x89-\xe2\x80\x891]." 2200

56D "Changing a String" dp "There is a string s, consisting of capital Latin letters. Let\'s denote its current length as |s|. During one move it is allowed to apply one of the following operations to it:   INSERT pos ch \xe2\x80\x94 insert a letter ch in the string s in the position pos (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89pos\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|s|\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89A\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ch\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89Z). The letter ch becomes the pos-th symbol of the string s, at that the letters shift aside and the length of the string increases by 1.  DELETE pos \xe2\x80\x94 delete a character number pos (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89pos\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|s|) from the string s. At that the letters shift together and the length of the string decreases by 1.  REPLACE pos ch \xe2\x80\x94 the letter in the position pos of the line s is replaced by ch (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89pos\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|s|,\xe2\x80\x89A\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ch\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89Z). At that the length of the string does not change. Your task is to find in which minimal number of moves one can get a t string from an s string. You should also find the sequence of actions leading to the required results." 2100

56C "Corporation Mail" "data structures,expression parsing,implementation" "The Beroil corporation structure is hierarchical, that is it can be represented as a tree. Let\'s examine the presentation of this structure as follows:  employee ::= name. | name:employee1,employee2, ... ,employeek.  name ::= name of an employee That is, the description of each employee consists of his name, a colon (:), the descriptions of all his subordinates separated by commas, and, finally, a dot. If an employee has no subordinates, then the colon is not present in his description.For example, line MIKE:MAX.,ARTEM:MIKE..,DMITRY:DMITRY.,DMITRY... is the correct way of recording the structure of a corporation where the director MIKE has subordinates MAX, ARTEM and DMITRY. ARTEM has a subordinate whose name is MIKE, just as the name of his boss and two subordinates of DMITRY are called DMITRY, just like himself.In the Beroil corporation every employee can only correspond with his subordinates, at that the subordinates are not necessarily direct. Let\'s call an uncomfortable situation the situation when a person whose name is s writes a letter to another person whose name is also s. In the example given above are two such pairs: a pair involving MIKE, and two pairs for DMITRY (a pair for each of his subordinates).Your task is by the given structure of the corporation to find the number of uncomfortable pairs in it." 1700

56B "Spoilt Permutation" implementation "Vasya collects coins: he has exactly one coin for every year from 1 to n. Naturally, Vasya keeps all the coins in his collection in the order in which they were released. Once Vasya\'s younger brother made a change \xe2\x80\x94 he took all the coins whose release year dated from l to r inclusively and put them in the reverse order. That is, he took a certain segment [l,\xe2\x80\x89r] and reversed it. At that the segment\'s endpoints did not coincide. For example, if n\xe2\x80\x89=\xe2\x80\x898, then initially Vasya\'s coins were kept in the order 1 2 3 4 5 6 7 8. If Vasya\'s younger brother chose the segment [2,\xe2\x80\x896], then after the reversal the coin order will change to 1 6 5 4 3 2 7 8. Vasya suspects that someone else could have spoilt the permutation after his brother. Help him to find that out. Check if the given permutation can be obtained from the permutation 1 2 ... n using exactly one segment reversal. If it is possible, find the segment itself." 1300

56A Bar implementation "According to Berland laws it is only allowed to sell alcohol to people not younger than 18 years. Vasya\'s job is to monitor the law\'s enforcement. Tonight he entered a bar and saw n people sitting there. For every one of them Vasya happened to determine either the age or the drink the person is having. Vasya can check any person, i.e. learn his age and the drink he is having at the same time. What minimal number of people should Vasya check additionally to make sure that there are no clients under 18 having alcohol drinks?The list of all alcohol drinks in Berland is: ABSINTH, BEER, BRANDY, CHAMPAGNE, GIN, RUM, SAKE, TEQUILA, VODKA, WHISKEY, WINE" 1000

55E "Very simple problem" "geometry,two pointers" "You are given a convex polygon. Count, please, the number of triangles that contain a given point in the plane and their vertices are the vertices of the polygon. It is guaranteed, that the point doesn\'t lie on the sides and the diagonals of the polygon." 2500

55D "Beautiful numbers" "dp,number theory" "Volodya is an odd boy and his taste is strange as well. It seems to him that a positive integer number is beautiful if and only if it is divisible by each of its nonzero digits. We will not argue with this and just count the quantity of beautiful numbers in given ranges." 2500

55C "Pie or die" games "Volodya and Vlad play the following game. There are k pies at the cells of n\xe2\x80\x89\xe2\x80\x89\xc3\x97\xe2\x80\x89\xe2\x80\x89m board. Each turn Volodya moves one pie to the neighbouring (by side) cell. If the pie lies at the border of the board then Volodya can move it outside the board, get the pie and win. After Volodya\'s move, Vlad bans some edge at the border of the board of length 1 (between two knots of the board) so that Volodya is not able to move the pie outside the board through this edge anymore. The question is: will Volodya win this game? We suppose both players follow the optimal strategy." 1900

55B "Smallest number" "brute force" "Recently, Vladimir got bad mark in algebra again. To avoid such unpleasant events in future he decided to train his arithmetic skills. He wrote four integer numbers a, b, c, d on the blackboard. During each of the next three minutes he took two numbers from the blackboard (not necessarily adjacent) and replaced them with their sum or their product. In the end he got one number. Unfortunately, due to the awful memory he forgot that number, but he remembers four original numbers, sequence of the operations and his surprise because of the very small result. Help Vladimir remember the forgotten number: find the smallest number that can be obtained from the original numbers by the given sequence of operations." 1600

55A "Flea travel" implementation,math "A flea is sitting at one of the n hassocks, arranged in a circle, at the moment. After minute number k the flea jumps through k\xe2\x80\x89-\xe2\x80\x891 hasso\xd1\x81ks (clockwise). For example, after the first minute the flea jumps to the neighboring hassock. You should answer: will the flea visit all the hassocks or not. We assume that flea has infinitely much time for this jumping." 1200

54E "Vacuum \xd0\xa1leaner" geometry "A flea is sitting at one of the n hassocks, arranged in a circle, at the moment. After minute number k the flea jumps through k\xe2\x80\x89-\xe2\x80\x891 hasso\xd1\x81ks (clockwise). For example, after the first minute the flea jumps to the neighboring hassock. You should answer: will the flea visit all the hassocks or not. We assume that flea has infinitely much time for this jumping." 2700

54D "Writing a Song" "brute force,dp,strings" "One of the Hedgehog and his friend\'s favorite entertainments is to take some sentence or a song and replace half of the words (sometimes even all of them) with each other\'s names.The friend\'s birthday is approaching and the Hedgehog decided to make a special present to his friend: a very long song, where his name will be repeated many times. But try as he might, he can\'t write a decent song!The problem is that the Hedgehog has already decided how long the resulting sentence should be (i.e. how many letters it should contain) and in which positions in the sentence the friend\'s name should occur, and it must not occur in any other position in the sentence. Besides, the Hedgehog decided to limit himself to using only the first K letters of an English alphabet in this sentence (so it will be not even a sentence, but one long word).The resulting problem is indeed quite complicated, that\'s why the Hedgehog asks you to help him and write a program that will make the desired word by the given name P, the length N of the required word, the given positions of the occurrences of the name P in the desired word and the alphabet\'s size K. Note that the occurrences of the name can overlap with each other." 2100

54C "First Digit Law" dp,math,probabilities "In the probability theory the following paradox called Benford\'s law is known: ""In many lists of random numbers taken from real sources, numbers starting with digit 1 occur much more often than numbers starting with any other digit"" (that\'s the simplest form of the law).Having read about it on Codeforces, the Hedgehog got intrigued by the statement and wishes to thoroughly explore it. He finds the following similar problem interesting in particular: there are N random variables, the i-th of which can take any integer value from some segment [Li;Ri] (all numbers from this segment are equiprobable). It means that the value of the i-th quantity can be equal to any integer number from a given interval [Li;Ri] with probability 1\xe2\x80\x89/\xe2\x80\x89(Ri\xe2\x80\x89-\xe2\x80\x89Li\xe2\x80\x89+\xe2\x80\x891).The Hedgehog wants to know the probability of the event that the first digits of at least K% of those values will be equal to one. In other words, let us consider some set of fixed values of these random variables and leave only the first digit (the MSD \xe2\x80\x94 most significant digit) of each value. Then let\'s count how many times the digit 1 is encountered and if it is encountered in at least K per cent of those N values, than such set of values will be called a good one. You have to find the probability that a set of values of the given random variables will be a good one." 2000

54B "Cutting Jigsaw Puzzle" hashing,implementation "The Hedgehog recently remembered one of his favorite childhood activities, \xe2\x80\x94 solving puzzles, and got into it with new vigor. He would sit day in, day out with his friend buried into thousands of tiny pieces of the picture, looking for the required items one by one.Soon the Hedgehog came up with a brilliant idea: instead of buying ready-made puzzles, one can take his own large piece of paper with some picture and cut it into many small rectangular pieces, then mix them and solve the resulting puzzle, trying to piece together the picture. The resulting task is even more challenging than the classic puzzle: now all the fragments have the same rectangular shape, and one can assemble the puzzle only relying on the picture drawn on the pieces.All puzzle pieces turn out to be of the same size X\xe2\x80\x89\xc3\x97\xe2\x80\x89Y, because the picture is cut first by horizontal cuts with the pitch of X, then with vertical cuts with the pitch of Y. If we denote the initial size of the picture as A\xe2\x80\x89\xc3\x97\xe2\x80\x89B, then A must be divisible by X and B must be divisible by Y (X and Y are integer numbers). However, not every such cutting of the picture will result in a good puzzle. The Hedgehog finds a puzzle good if no two pieces in it are the same (It is allowed to rotate the pieces when comparing them, but it is forbidden to turn them over). Your task is to count for a given picture the number of good puzzles that you can make from it, and also to find the puzzle with the minimal piece size." 1800

54A Presents implementation "You are given the prices of three presents. Also there are three sisters. It is known that the most valuable present is for the eldest sister. The second (by price) is for the second sister. And the less valuable present is for the youngest sister. If two (or three) presents have the same price, corresponding sisters may get the in a random way." 1300

53E "Dead Ends" bitmasks,dp "Life in Bertown has become hard. The city has too many roads and the government spends too much to maintain them. There are n junctions and m two way roads, at which one can get from each junction to any other one. The mayor wants to close some roads so that the number of roads left totaled to n\xe2\x80\x89-\xe2\x80\x891 roads and it were still possible to get from each junction to any other one. Besides, the mayor is concerned with the number of dead ends which are the junctions from which only one road goes. There shouldn\'t be too many or too few junctions. Having discussed the problem, the mayor and his assistants decided that after the roads are closed, the road map should contain exactly k dead ends. Your task is to count the number of different ways of closing the roads at which the following conditions are met:   There are exactly n\xe2\x80\x89-\xe2\x80\x891 roads left.  It is possible to get from each junction to any other one.  There are exactly k dead ends on the resulting map. Two ways are considered different if there is a road that is closed in the first way, and is open in the second one." 2500

53D "Physical Education" sortings "Vasya is a school PE teacher. Unlike other PE teachers, Vasya doesn\'t like it when the students stand in line according to their height. Instead, he demands that the children stand in the following order: a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an, where ai is the height of the i-th student in the line and n is the number of students in the line. The children find it hard to keep in mind this strange arrangement, and today they formed the line in the following order: b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bn, which upset Vasya immensely. Now Vasya wants to rearrange the children so that the resulting order is like this: a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. During each move Vasya can swap two people who stand next to each other in the line. Help Vasya, find the sequence of swaps leading to the arrangement Vasya needs. It is not required to minimize the number of moves." 1500

53C "Little Frog" "constructive algorithms" "Once upon a time a little frog whose name was Vasya decided to travel around his home swamp. Overall there are n mounds on the swamp, located on one line. The distance between the neighboring mounds is one meter. Vasya wants to visit all the mounds in one day; besides, he wants to visit each one exactly once. For that he makes a route plan, to decide the order in which to jump on the mounds. Vasya can pick any mound as the first one. He thinks it boring to jump two times at the same distance. That\'s why he wants any two jumps on his route to have different lengths. Help Vasya the Frog and make the plan for him." 1200

53B "Blog Photo" "binary search,implementation" "One popular blog site edits the uploaded photos like this. It cuts a rectangular area out of them so that the ratio of height to width (i.e. the height\xe2\x80\x89/\xe2\x80\x89width quotient) can vary from 0.8 to 1.25 inclusively. Besides, at least one side of the cut area should have a size, equal to some power of number 2 (2x for some integer x). If those rules don\'t indicate the size of the cut are clearly, then the way with which the cut part possesses the largest area is chosen. Of course, both sides of the cut area should be integer. If there are several answers to this problem, you should choose the answer with the maximal height." 1700

53A Autocomplete implementation "Autocomplete is a program function that enables inputting the text (in editors, command line shells, browsers etc.) completing the text by its inputted part. Vasya is busy working on a new browser called \'BERowser\'. He happens to be working on the autocomplete function in the address line at this very moment. A list consisting of n last visited by the user pages and the inputted part s are known. Your task is to complete s to make it an address of one of the pages from the list. You have to find the lexicographically smallest address having a prefix s." 1100

52C "Circular RMQ" "data structures" "You are given circular array a0,\xe2\x80\x89a1,\xe2\x80\x89...,\xe2\x80\x89an\xe2\x80\x89-\xe2\x80\x891. There are two types of operations with it:   inc(lf,\xe2\x80\x89rg,\xe2\x80\x89v) \xe2\x80\x94 this operation increases each element on the segment [lf,\xe2\x80\x89rg] (inclusively) by v;  rmq(lf,\xe2\x80\x89rg) \xe2\x80\x94 this operation returns minimal value on the segment [lf,\xe2\x80\x89rg] (inclusively). Assume segments to be circular, so if n\xe2\x80\x89=\xe2\x80\x895 and lf\xe2\x80\x89=\xe2\x80\x893,\xe2\x80\x89rg\xe2\x80\x89=\xe2\x80\x891, it means the index sequence: 3,\xe2\x80\x894,\xe2\x80\x890,\xe2\x80\x891.Write program to process given sequence of operations." 2200

52B "Right Triangles" combinatorics "You are given a n\xe2\x80\x89\xc3\x97\xe2\x80\x89m field consisting only of periods (\'.\') and asterisks (\'*\'). Your task is to count all right triangles with two sides parallel to the square sides, whose vertices are in the centers of \'*\'-cells. A right triangle is a triangle in which one angle is a right angle (that is, a 90 degree angle)." 1600

52A 123-sequence implementation "There is a given sequence of integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an, where every number is from 1 to 3 inclusively. You have to replace the minimum number of numbers in it so that all the numbers in the sequence are equal to each other." 900

51F Caterpillar "dfs and similar,dp,graphs,trees" "An undirected graph is called a caterpillar if it is a connected graph without cycles and it has such a path p that any vertex is located at a distance of at most 1 from the path p. The caterpillar can contain loops (edges from a vertex to itself) but cannot contain multiple (parallel) edges.The picture contains an example of a caterpillar:   You are given an undirected graph G. You are allowed to do a merging operations, each such operation merges two vertices into one vertex. For that two any vertices a and b (a\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89b) are chosen. These verteces are deleted together with their edges (which are incident to at least one of the vertices a or b) but a new vertex w is added together with edges (x,\xe2\x80\x89w) for each edge (a,\xe2\x80\x89w) and/or (b,\xe2\x80\x89w). If there was the edge (a,\xe2\x80\x89b) it transforms to the loop (w,\xe2\x80\x89w). The resulting graph (after the merging operation) may contain multiple (parallel) edges between pairs of vertices and loops. Let us note that this operation decreases the number of vertices of graph by 1 but leaves the number of edges in the graph unchanged.The merging operation can be informally described as a unity of two vertices of the graph into one with the natural transformation of the graph edges.You may apply this operation consecutively and make the given graph to be a caterpillar. Write a program that will print the minimal number of merging operations required to make the given graph a caterpillar." 2800

51E Pentagon combinatorics,graphs,matrices "According to the last order issued by the president of Berland every city of the country must have its own Ministry Defense building (their own Pentagon). A megapolis Berbourg was not an exception. This city has n junctions, some pairs of which are connected by two-way roads. Overall there are m roads in the city, no more than one between each pair of junctions.At the moment choosing a location place for Pentagon in Berbourg is being discussed. It has been decided that Pentagon should cover the territory of five different junctions which are joined into a cycle by roads. In the order to build Pentagon a special wall will be built along the roads (with high-tension razor, high-voltage wire and other attributes). Thus, the number of possible ways of building Pentagon in the city is equal to the number of different cycles at lengths of 5, composed of junctions and roads.Your task is to prints the number of ways of building Pentagon in Berbourg. Only well-optimized solutions will be accepted. Please, test your code on the maximal testcase." 2400

51D "Geometrical problem" implementation "Polycarp loves geometric progressions \xe2\x80\x94 he collects them. However, as such progressions occur very rarely, he also loves the sequences of numbers where it is enough to delete a single element to get a geometric progression.In this task we shall define geometric progressions as finite sequences of numbers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89ak, where ai\xe2\x80\x89=\xe2\x80\x89c\xc2\xb7bi\xe2\x80\x89-\xe2\x80\x891 for some real numbers c and b. For example, the sequences [2, -4, 8], [0, 0, 0, 0], [199] are geometric progressions and [0, 1, 2, 3] is not.Recently Polycarp has found a sequence and he can\'t classify it. Help him to do it. Determine whether it is a geometric progression. If it is not, check if it can become a geometric progression if an element is deleted from it." 2200

51C "Three Base Stations" "binary search,greedy" "The New Vasjuki village is stretched along the motorway and that\'s why every house on it is characterized by its shift relative to some fixed point \xe2\x80\x94 the xi coordinate. The village consists of n houses, the i-th house is located in the point with coordinates of xi.TELE3, a cellular communication provider planned to locate three base stations so as to provide every house in the village with cellular communication. The base station having power d located in the point t provides with communication all the houses on the segment [t\xe2\x80\x89-\xe2\x80\x89d,\xe2\x80\x89t\xe2\x80\x89+\xe2\x80\x89d] (including boundaries).To simplify the integration (and simply not to mix anything up) all the three stations are planned to possess the equal power of d. Which minimal value of d is enough to provide all the houses in the village with cellular communication." 1800

51B "bHTML Tables Analisys" "expression parsing" "In this problem is used an extremely simplified version of HTML table markup. Please use the statement as a formal document and read it carefully.A string is a bHTML table, if it satisfies the grammar: TABLE ::= <table>ROWS</table>ROWS ::= ROW | ROW ROWSROW ::= <tr>CELLS</tr>CELLS ::= CELL | CELL CELLSCELL ::= <td></td> | <td>TABLE</td>Blanks in the grammar are only for purposes of illustration, in the given data there will be no spaces. The bHTML table is very similar to a simple regular HTML table in which meet only the following tags : ""table"", ""tr"", ""td"", all the tags are paired and the table contains at least one row and at least one cell in each row. Have a look at the sample tests as examples of tables.As can be seen, the tables may be nested. You are given a table (which may contain other(s)). You need to write a program that analyzes all the tables and finds the number of cells in each of them. The tables are not required to be rectangular." 1700

51A "Cheaterius\'s Problem" implementation "In this problem is used an extremely simplified version of HTML table markup. Please use the statement as a formal document and read it carefully.A string is a bHTML table, if it satisfies the grammar: TABLE ::= <table>ROWS</table>ROWS ::= ROW | ROW ROWSROW ::= <tr>CELLS</tr>CELLS ::= CELL | CELL CELLSCELL ::= <td></td> | <td>TABLE</td>Blanks in the grammar are only for purposes of illustration, in the given data there will be no spaces. The bHTML table is very similar to a simple regular HTML table in which meet only the following tags : ""table"", ""tr"", ""td"", all the tags are paired and the table contains at least one row and at least one cell in each row. Have a look at the sample tests as examples of tables.As can be seen, the tables may be nested. You are given a table (which may contain other(s)). You need to write a program that analyzes all the tables and finds the number of cells in each of them. The tables are not required to be rectangular." 1300

50E "Square Equation Roots" math "A schoolboy Petya studies square equations. The equations that are included in the school curriculum, usually look simple: x2\xe2\x80\x89+\xe2\x80\x892bx\xe2\x80\x89+\xe2\x80\x89c\xe2\x80\x89=\xe2\x80\x890 where b, c are natural numbers.Petya noticed that some equations have two real roots, some of them have only one root and some equations don\'t have real roots at all. Moreover it turned out that several different square equations can have a common root.Petya is interested in how many different real roots have all the equations of the type described above for all the possible pairs of numbers b and c such that 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n, 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89c\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m. Help Petya find that number." 2300

50D Bombing "binary search,dp,probabilities" "The commanding officers decided to drop a nuclear bomb on the enemy\'s forces. You are ordered to determine the power of the warhead that needs to be used.The enemy has N strategically important objects. Their positions are known due to the intelligence service. The aim of the strike is to deactivate at least K important objects of the enemy. The bombing impact point is already determined and has coordinates of [X0; Y0].The nuclear warhead is marked by the estimated impact radius R\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x890. All the buildings that are located closer than R to the bombing epicentre will be destroyed. All the buildings that are located further than R from the epicentre, can also be deactivated with some degree of probability. Let\'s assume that D is the distance between a building and the epicentre. This building\'s deactivation probability P(D,\xe2\x80\x89R) is calculated according to the following formula:  We should regard  as ea, where e\xe2\x80\x89\xe2\x89\x88\xe2\x80\x892.7182818284590452353602874713527If the estimated impact radius of the warhead is equal to zero, then all the buildings located in the impact point will be completely demolished and all the rest of important objects will not be damaged.The commanding officers want the probability of failing the task to be no more than \xce\xb5. Nuclear warheads are too expensive a luxury, that\'s why you have to minimise the estimated impact radius of the warhead." 2100

50C "Happy Farm 5" geometry "The Happy Farm 5 creators decided to invent the mechanism of cow grazing. The cows in the game are very slow and they move very slowly, it can even be considered that they stand still. However, carnivores should always be chased off them. For that a young player Vasya decided to make the shepherd run round the cows along one and the same closed path. It is very important that the cows stayed strictly inside the area limited by the path, as otherwise some cows will sooner or later be eaten. To be absolutely sure in the cows\' safety, Vasya wants the path completion time to be minimum.The new game is launched for different devices, including mobile phones. That\'s why the developers decided to quit using the arithmetics with the floating decimal point and use only the arithmetics of integers. The cows and the shepherd in the game are represented as points on the plane with integer coordinates. The playing time is modeled by the turns. During every turn the shepherd can either stay where he stands or step in one of eight directions: horizontally, vertically, or diagonally. As the coordinates should always remain integer, then the length of a horizontal and vertical step is equal to 1, and the length of a diagonal step is equal to . The cows do not move. You have to minimize the number of moves the shepherd needs to run round the whole herd." 2000

50B "Choosing Symbol Pairs" strings "There is a given string S consisting of N symbols. Your task is to find the number of ordered pairs of integers i and j such that1. 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i,\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89N2. S[i]\xe2\x80\x89=\xe2\x80\x89S[j], that is the i-th symbol of string S is equal to the j-th." 1500

50A "Domino piling" greedy,math "You are given a rectangular board of M\xe2\x80\x89\xc3\x97\xe2\x80\x89N squares. Also you are given an unlimited number of standard domino pieces of 2\xe2\x80\x89\xc3\x97\xe2\x80\x891 squares. You are allowed to rotate the pieces. You are asked to place as many dominoes as possible on the board so as to meet the following conditions:1. Each domino completely covers two squares.2. No two dominoes overlap.3. Each domino lies entirely inside the board. It is allowed to touch the edges of the board.Find the maximum number of dominoes, which can be placed under these restrictions." 800

49E "Common ancestor" dp "The DNA sequence for every living creature in Berland can be represented as a non-empty line consisting of lowercase Latin letters. Berland scientists found out that all the creatures evolve by stages. During one stage exactly one symbol of the DNA line is replaced by exactly two other ones. At that overall there are n permissible substitutions. The substitution ai->bici means that any one symbol ai can be replaced with two symbols bici. Every substitution could happen an unlimited number of times.They say that two creatures with DNA sequences s1 and s2 can have a common ancestor if there exists such a DNA sequence s3 that throughout evolution it can result in s1 and s2, perhaps after a different number of stages. Your task is to find out by the given s1 and s2 whether the creatures possessing such DNA sequences can have a common ancestor. If the answer is positive, you have to find the length of the shortest sequence of the common ancestor\xe2\x80\x99s DNA." 2300

49D Game "brute force,dp,implementation" "Vasya and Petya have invented a new game. Vasya takes a stripe consisting of 1\xe2\x80\x89\xc3\x97\xe2\x80\x89n square and paints the squares black and white. After that Petya can start moves \xe2\x80\x94 during a move he may choose any two neighboring squares of one color and repaint these two squares any way he wants, perhaps in different colors. Petya can only repaint the squares in white and black colors. Petya\xe2\x80\x99s aim is to repaint the stripe so that no two neighboring squares were of one color. Help Petya, using the given initial coloring, find the minimum number of moves Petya needs to win." 1800

49C Disposition "constructive algorithms,math" "Vasya bought the collected works of a well-known Berland poet Petya in n volumes. The volumes are numbered from 1 to n. He thinks that it does not do to arrange the book simply according to their order. Vasya wants to minimize the number of the disposition\xe2\x80\x99s divisors \xe2\x80\x94 the positive integers i such that for at least one j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) is true both: j mod i\xe2\x80\x89=\xe2\x80\x890 and at the same time p(j) mod i\xe2\x80\x89=\xe2\x80\x890, where p(j) is the number of the tome that stands on the j-th place and mod is the operation of taking the division remainder. Naturally, one volume can occupy exactly one place and in one place can stand exactly one volume.Help Vasya \xe2\x80\x94 find the volume disposition with the minimum number of divisors." 1700

49B Sum math "Vasya studies positional numeral systems. Unfortunately, he often forgets to write the base of notation in which the expression is written. Once he saw a note in his notebook saying a\xe2\x80\x89+\xe2\x80\x89b\xe2\x80\x89=\xe2\x80\x89?, and that the base of the positional notation wasn\xe2\x80\x99t written anywhere. Now Vasya has to choose a base p and regard the expression as written in the base p positional notation. Vasya understood that he can get different results with different bases, and some bases are even invalid. For example, expression 78\xe2\x80\x89+\xe2\x80\x8987 in the base 16 positional notation is equal to FF16, in the base 15 positional notation it is equal to 11015, in the base 10 one \xe2\x80\x94 to 16510, in the base 9 one \xe2\x80\x94 to 1769, and in the base 8 or lesser-based positional notations the expression is invalid as all the numbers should be strictly less than the positional notation base. Vasya got interested in what is the length of the longest possible expression value. Help him to find this length.The length of a number should be understood as the number of numeric characters in it. For example, the length of the longest answer for 78\xe2\x80\x89+\xe2\x80\x8987\xe2\x80\x89=\xe2\x80\x89? is 3. It is calculated like that in the base 15 (11015), base 10 (16510), base 9 (1769) positional notations, for example, and in some other ones." 1500

49A Sleuth implementation "Vasya plays the sleuth with his friends. The rules of the game are as follows: those who play for the first time, that is Vasya is the sleuth, he should investigate a ""crime"" and find out what is happening. He can ask any questions whatsoever that can be answered with ""Yes"" or ""No"". All the rest agree beforehand to answer the questions like that: if the question\xe2\x80\x99s last letter is a vowel, they answer ""Yes"" and if the last letter is a consonant, they answer ""No"". Of course, the sleuth knows nothing about it and his task is to understand that.Unfortunately, Vasya is not very smart. After 5 hours of endless stupid questions everybody except Vasya got bored. That\xe2\x80\x99s why Vasya\xe2\x80\x99s friends ask you to write a program that would give answers instead of them.The English alphabet vowels are: A, E, I, O, U, YThe English alphabet consonants are: B, C, D, F, G, H, J, K, L, M, N, P, Q, R, S, T, V, W, X, Z" 800

48H "Black and White" "constructive algorithms" "According to the legends the king of Berland Berl I was noted for his love of beauty and order. One day he ordered to tile the palace hall\'s floor where balls and receptions used to take place with black and white tiles according to a regular geometrical pattern invented by him. However, as is after the case, due to low financing there were only a black and b white tiles delivered to the palace. The other c tiles were black and white (see the picture).  The initial plan failed! Having learned of that, the king gave a new command: tile the floor with the available tiles so that no black side of a tile touched a white one. The tiles are squares of one size 1\xe2\x80\x89\xc3\x97\xe2\x80\x891, every black and white tile can be rotated in one of the four ways. The court programmer was given the task to work out the plan of tiling and he coped with the task and didn\'t suffer the consequences of disobedience. And can you cope with it?" 2800

48G "Galaxy Union" "dp,trees,two pointers" "In a far away galaxy there are n inhabited planets numbered with numbers from 1 to n. One day the presidents of all the n planets independently from each other came up with an idea of creating the Galaxy Union. Now they need to share this wonderful idea with their galaxymates, that\xe2\x80\x99s why each president is busy working out a project of negotiating with the other presidents.For negotiations between some pairs of the planets there are bidirectional communication channels, each of which is characterized with ""dial duration"" ti which, as a rule, takes several hours and exceeds the call duration greatly. Overall the galaxy has n communication channels and they unite all the planets into a uniform network. That means that it is possible to phone to any planet v from any planet u, perhaps, using some transitional planets v1, v2, ..., vm via the existing channels between u and v1, v1 and v2, ..., vm\xe2\x80\x89-\xe2\x80\x891 and vm, vm and v. At that the dial duration from u to v will be equal to the sum of dial durations of the used channels.So, every president has to talk one by one to the presidents of all the rest n\xe2\x80\x89-\xe2\x80\x891 planets. At that the negotiations take place strictly consecutively, and until the negotiations with a planet stop, the dial to another one does not begin. As the matter is urgent, from the different ways to call the needed planet every time the quickest one is chosen. Little time is needed to assure another president on the importance of the Galaxy Union, that\xe2\x80\x99s why the duration of the negotiations with each planet can be considered equal to the dial duration time for those planets. As the presidents know nothing about each other\xe2\x80\x99s plans, they do not take into consideration the possibility that, for example, the sought president may call himself or already know about the founding of the Galaxy Union from other sources.The governments of all the n planets asked you to work out the negotiation plans. First you are to find out for every president how much time his supposed negotiations will take." 2700

48F "Snow sellers" greedy,sortings "The New Year celebrations in Berland last n days. Only this year the winter is snowless, that\xe2\x80\x99s why the winter celebrations\xe2\x80\x99 organizers should buy artificial snow. There are m snow selling companies in Berland. Every day the i-th company produces wi cubic meters of snow. Next day the snow thaws and the company has to produce wi cubic meters of snow again. During the celebration new year discounts are on, that\xe2\x80\x99s why the snow cost decreases every day. It is known that on the first day the total cost of all the snow produced by the i-th company is equal to ci bourles. Every day this total cost decreases by ai bourles, i.e. on the second day it is equal to ci\xe2\x80\x89-\xe2\x80\x89ai,and on the third day \xe2\x80\x94 to ci\xe2\x80\x89-\xe2\x80\x892ai, and so on. It is known that for one company the cost of the snow produced by it does not get negative or equal to zero. You have to organize the snow purchase so as to buy every day exactly W snow cubic meters. At that it is not necessary to buy from any company all the snow produced by it. If you buy ni cubic meters of snow (0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ni\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89wi, the number ni is not necessarily integer!) from the i-th company at one of the days when the cost of its snow is equal to si, then its price will total to  bourles. During one day one can buy the snow from several companies. In different days one can buy the snow from different companies. It is required to make the purchases so as to spend as little money as possible. It is guaranteed that the snow produced by the companies will be enough." 2800

48E "Ivan the Fool VS Gorynych the Dragon" dp,games,graphs "Once upon a time in a kingdom far, far away\xe2\x80\xa6 Okay, let\xe2\x80\x99s start at the point where Ivan the Fool met Gorynych the Dragon. Ivan took out his magic sword and the battle began. First Gorynych had h heads and t tails. With each strike of the sword Ivan can either cut off several heads (from 1 to n, but not more than Gorynych has at the moment), or several tails (from 1 to m, but not more than Gorynych has at the moment). At the same time, horrible though it seems, Gorynych the Dragon can also grow new heads and tails. And the number of growing heads and tails is determined uniquely by the number of heads or tails cut by the current strike. When the total number of heads and tails exceeds R, Gorynych the Dragon strikes its final blow and destroys Ivan the Fool. That\xe2\x80\x99s why Ivan aims to cut off all the dragon\xe2\x80\x99s heads and tails as quickly as possible and win. The events can also develop in a third way: neither of the opponents can win over the other one and they will continue fighting forever.The tale goes like this; easy to say, hard to do. Your task is to write a program that will determine the battle\xe2\x80\x99s outcome. Consider that Ivan strikes consecutively. After each blow Gorynych grows a number of new heads and tails depending on the number of cut ones. Gorynych the Dragon is defeated if after the blow he loses all his heads and tails and can\xe2\x80\x99t grow new ones. Ivan fights in the optimal way (fools are lucky), i.e.   if Ivan can win, he wins having struck the least number of blows;  if it is impossible to defeat Gorynych, but is possible to resist him for an infinitely long period of time, then that\xe2\x80\x99s the strategy Ivan chooses;  if Gorynych wins in any case, Ivan aims to resist him for as long as possible." 2100

48D Permutations greedy "A permutation is a sequence of integers from 1 to n of length n containing each number exactly once. For example, (1), (4,\xe2\x80\x893,\xe2\x80\x895,\xe2\x80\x891,\xe2\x80\x892), (3,\xe2\x80\x892,\xe2\x80\x891) are permutations, and (1,\xe2\x80\x891), (4,\xe2\x80\x893,\xe2\x80\x891), (2,\xe2\x80\x893,\xe2\x80\x894) are not. There are many tasks on permutations. Today you are going to solve one of them. Let\xe2\x80\x99s imagine that somebody took several permutations (perhaps, with a different number of elements), wrote them down consecutively as one array and then shuffled the resulting array. The task is to restore the initial permutations if it is possible." 1500

48C "The Race" math "Every year a race takes place on the motorway between cities A and B. This year Vanya decided to take part in the race and drive his own car that has been around and bears its own noble name \xe2\x80\x94 The Huff-puffer.So, Vasya leaves city A on the Huff-puffer, besides, at the very beginning he fills the petrol tank with \xce\xb1 liters of petrol (\xce\xb1\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x8910 is Vanya\'s favorite number, it is not necessarily integer). Petrol stations are located on the motorway at an interval of 100 kilometers, i.e. the first station is located 100 kilometers away from the city A, the second one is 200 kilometers away from the city A, the third one is 300 kilometers away from the city A and so on. The Huff-puffer spends 10 liters of petrol every 100 kilometers. Vanya checks the petrol tank every time he passes by a petrol station. If the petrol left in the tank is not enough to get to the next station, Vanya fills the tank with \xce\xb1 liters of petrol. Otherwise, he doesn\'t stop at the station and drives on. For example, if \xce\xb1\xe2\x80\x89=\xe2\x80\x8943.21, then the car will be fuelled up for the first time at the station number 4, when there\'ll be 3.21 petrol liters left. After the fuelling up the car will have 46.42 liters. Then Vanya stops at the station number 8 and ends up with 6.42\xe2\x80\x89+\xe2\x80\x8943.21\xe2\x80\x89=\xe2\x80\x8949.63 liters. The next stop is at the station number 12, 9.63\xe2\x80\x89+\xe2\x80\x8943.21\xe2\x80\x89=\xe2\x80\x8952.84. The next stop is at the station number 17 and so on. You won\'t believe this but the Huff-puffer has been leading in the race! Perhaps it is due to unexpected snow. Perhaps it is due to video cameras that have been installed along the motorway which register speed limit breaking. Perhaps it is due to the fact that Vanya threatened to junk the Huff-puffer unless the car wins. Whatever the reason is, the Huff-puffer is leading, and jealous people together with other contestants wrack their brains trying to think of a way to stop that outrage.One way to do this is to mine the next petrol station where Vanya will stop. Your task is to calculate at which station this will happen and warn Vanya. You don\'t know the \xce\xb1 number, however, you are given the succession of the numbers of the stations where Vanya has stopped. Find the number of the station where the next stop will be." 1800

48B "Land Lot" "brute force,implementation" "Vasya has a beautiful garden where wonderful fruit trees grow and yield fantastic harvest every year. But lately thieves started to sneak into the garden at nights and steal the fruit too often. Vasya can\xe2\x80\x99t spend the nights in the garden and guard the fruit because there\xe2\x80\x99s no house in the garden! Vasya had been saving in for some time and finally he decided to build the house. The rest is simple: he should choose in which part of the garden to build the house. In the evening he sat at his table and drew the garden\xe2\x80\x99s plan. On the plan the garden is represented as a rectangular checkered field n\xe2\x80\x89\xc3\x97\xe2\x80\x89m in size divided into squares whose side length is 1. In some squares Vasya marked the trees growing there (one shouldn\xe2\x80\x99t plant the trees too close to each other that\xe2\x80\x99s why one square contains no more than one tree). Vasya wants to find a rectangular land lot a\xe2\x80\x89\xc3\x97\xe2\x80\x89b squares in size to build a house on, at that the land lot border should go along the lines of the grid that separates the squares. All the trees that grow on the building lot will have to be chopped off. Vasya loves his garden very much, so help him choose the building land lot location so that the number of chopped trees would be as little as possible." 1200

48A Rock-paper-scissors implementation,schedules "Uncle Fyodor, Matroskin the Cat and Sharic the Dog live their simple but happy lives in Prostokvashino. Sometimes they receive parcels from Uncle Fyodor\xe2\x80\x99s parents and sometimes from anonymous benefactors, in which case it is hard to determine to which one of them the package has been sent. A photographic rifle is obviously for Sharic who loves hunting and fish is for Matroskin, but for whom was a new video game console meant? Every one of the three friends claimed that the present is for him and nearly quarreled. Uncle Fyodor had an idea how to solve the problem justly: they should suppose that the console was sent to all three of them and play it in turns. Everybody got relieved but then yet another burning problem popped up \xe2\x80\x94 who will play first? This time Matroskin came up with a brilliant solution, suggesting the most fair way to find it out: play rock-paper-scissors together. The rules of the game are very simple. On the count of three every player shows a combination with his hand (or paw). The combination corresponds to one of three things: a rock, scissors or paper. Some of the gestures win over some other ones according to well-known rules: the rock breaks the scissors, the scissors cut the paper, and the paper gets wrapped over the stone. Usually there are two players. Yet there are three friends, that\xe2\x80\x99s why they decided to choose the winner like that: If someone shows the gesture that wins over the other two players, then that player wins. Otherwise, another game round is required. Write a program that will determine the winner by the gestures they have shown." 900

47E Cannon "data structures,geometry,sortings" "Bertown is under siege! The attackers have blocked all the ways out and their cannon is bombarding the city. Fortunately, Berland intelligence managed to intercept the enemies\' shooting plan. Let\'s introduce the Cartesian system of coordinates, the origin of which coincides with the cannon\'s position, the Ox axis is directed rightwards in the city\'s direction, the Oy axis is directed upwards (to the sky). The cannon will make n more shots. The cannon balls\' initial speeds are the same in all the shots and are equal to V, so that every shot is characterized by only one number alphai which represents the angle at which the cannon fires. Due to the cannon\'s technical peculiarities this angle does not exceed 45 angles (\xcf\x80\xe2\x80\x89/\xe2\x80\x894). We disregard the cannon sizes and consider the firing made from the point (0,\xe2\x80\x890).The balls fly according to the known physical laws of a body thrown towards the horizon at an angle: vx(t)\xe2\x80\x89=\xe2\x80\x89V\xc2\xb7cos(alpha) vy(t)\xe2\x80\x89=\xe2\x80\x89V\xc2\xb7sin(alpha)�\xe2\x80\x89\xe2\x80\x93\xe2\x80\x89�g\xc2\xb7t x(t)\xe2\x80\x89=\xe2\x80\x89V\xc2\xb7cos(alpha)\xc2\xb7t y(t)\xe2\x80\x89=\xe2\x80\x89V\xc2\xb7sin(alpha)\xc2\xb7t�\xe2\x80\x89\xe2\x80\x93\xe2\x80\x89�g\xc2\xb7t2\xe2\x80\x89/\xe2\x80\x892Think of the acceleration of gravity g as equal to 9.8.Bertown defends m walls. The i-th wall is represented as a vertical segment (xi,\xe2\x80\x890)\xe2\x80\x89-\xe2\x80\x89(xi,\xe2\x80\x89yi). When a ball hits a wall, it gets stuck in it and doesn\'t fly on. If a ball doesn\'t hit any wall it falls on the ground (y\xe2\x80\x89=\xe2\x80\x890) and stops. If the ball exactly hits the point (xi,\xe2\x80\x89yi), it is considered stuck. Your task is to find for each ball the coordinates of the point where it will be located in the end." 2200

47D Safe "brute force" "Vasya tries to break in a safe. He knows that a code consists of n numbers, and every number is a 0 or a 1. Vasya has made m attempts to enter the code. After each attempt the system told him in how many position stand the right numbers. It is not said in which positions the wrong numbers stand. Vasya has been so unlucky that he hasn\xe2\x80\x99t entered the code where would be more than 5 correct numbers. Now Vasya is completely bewildered: he thinks there\xe2\x80\x99s a mistake in the system and it is self-contradictory. Help Vasya \xe2\x80\x94 calculate how many possible code variants are left that do not contradict the previous system responses." 2200

47C Crossword implementation "Vasya trains to compose crossword puzzles. He can only compose crosswords of a very simpl\xd0\xb5 type so far. All of them consist of exactly six words; the words can be read only from top to bottom vertically and from the left to the right horizontally. The words are arranged in the form of a rectangular ""eight"" or infinity sign, not necessarily symmetrical.The top-left corner of the crossword coincides with the top-left corner of the rectangle. The same thing is correct for the right-bottom corners. The crossword can\'t degrade, i.e. it always has exactly four blank areas, two of which are surrounded by letters. Look into the output for the samples for clarification.Help Vasya \xe2\x80\x94 compose a crossword of the described type using the given six words. It is allowed to use the words in any order." 2000

47B Coins implementation "One day Vasya came across three Berland coins. They didn\'t have any numbers that\'s why Vasya didn\'t understand how their denominations differ. He supposed that if one coin is heavier than the other one, then it should be worth more. Vasya weighed all the three pairs of coins on pan balance scales and told you the results. Find out how the deminations of the coins differ or if Vasya has a mistake in the weighting results. No two coins are equal." 1200

47A "Triangular numbers" "brute force,math" "A triangular number is the number of dots in an equilateral triangle uniformly filled with dots. For example, three dots can be arranged in a triangle; thus three is a triangular number. The n-th triangular number is the number of dots in a triangle with n dots on a side. . You can learn more about these numbers from Wikipedia (http://en.wikipedia.org/wiki/Triangular_number).Your task is to find out if a given integer is a triangular number." 800

46G "Emperor\'s Problem" geometry "A triangular number is the number of dots in an equilateral triangle uniformly filled with dots. For example, three dots can be arranged in a triangle; thus three is a triangular number. The n-th triangular number is the number of dots in a triangle with n dots on a side. . You can learn more about these numbers from Wikipedia (http://en.wikipedia.org/wiki/Triangular_number).Your task is to find out if a given integer is a triangular number." 2500

46F "Hercule Poirot Problem" dsu,graphs "Today you are to solve the problem even the famous Hercule Poirot can\'t cope with! That\'s why this crime has not yet been solved and this story was never included in Agatha Christie\'s detective story books. You are not informed on what crime was committed, when and where the corpse was found and other details. We only know that the crime was committed in a house that has n rooms and m doors between the pairs of rooms. The house residents are very suspicious, that\'s why all the doors can be locked with keys and all the keys are different. According to the provided evidence on Thursday night all the doors in the house were locked, and it is known in what rooms were the residents, and what kind of keys had any one of them. The same is known for the Friday night, when all the doors were also locked. On Friday it was raining heavily, that\'s why nobody left the house and nobody entered it. During the day the house residents could  open and close doors to the neighboring rooms using the keys at their disposal (every door can be opened and closed from each side);  move freely from a room to a room if a corresponding door is open;  give keys to one another, being in one room.  ""Little grey matter"" of Hercule Poirot are not capable of coping with such amount of information. Find out if the positions of people and keys on the Thursday night could result in the positions on Friday night, otherwise somebody among the witnesses is surely lying." 2300

46E Comb "data structures,dp" "Having endured all the hardships, Lara Croft finally found herself in a room with treasures. To her surprise she didn\'t find golden mountains there. Lara looked around and noticed on the floor a painted table n\xe2\x80\x89\xc3\x97\xe2\x80\x89m panels in size with integers written on the panels. There also was a huge number of stones lying by the wall. On the pillar near the table Lara found a guidance note which said that to get hold of the treasures one has to choose some non-zero number of the first panels in each row of the table and put stones on all those panels to push them down. After that she will receive a number of golden coins equal to the sum of numbers written on the chosen panels. Lara quickly made up her mind on how to arrange the stones and was about to start when she noticed an addition to the note in small font below. According to the addition, for the room ceiling not to crush and smash the adventurer, the chosen panels should form a comb. It was explained that the chosen panels form a comb when the sequence c1,\xe2\x80\x89c2,\xe2\x80\x89...,\xe2\x80\x89cn made from the quantities of panels chosen in each table line satisfies the following property: c1\xe2\x80\x89>\xe2\x80\x89c2\xe2\x80\x89<\xe2\x80\x89c3\xe2\x80\x89>\xe2\x80\x89c4\xe2\x80\x89<\xe2\x80\x89..., i.e. the inequation mark interchanges between the neighboring elements. Now Lara is bewildered and doesn\'t know what to do. Help her to determine the largest number of coins she can get and survive at the same time." 1900

46D "Parking Lot" "data structures,implementation" "Nowadays it is becoming increasingly difficult to park a car in cities successfully. Let\'s imagine a segment of a street as long as L meters along which a parking lot is located. Drivers should park their cars strictly parallel to the pavement on the right side of the street (remember that in the country the authors of the tasks come from the driving is right side!). Every driver when parking wants to leave for themselves some extra space to move their car freely, that\'s why a driver is looking for a place where the distance between his car and the one behind his will be no less than b meters and the distance between his car and the one in front of his will be no less than f meters (if there\'s no car behind then the car can be parked at the parking lot segment edge; the same is true for the case when there\'re no cars parked in front of the car). Let\'s introduce an axis of coordinates along the pavement. Let the parking lot begin at point 0 and end at point L. The drivers drive in the direction of the coordinates\' increasing and look for the earliest place (with the smallest possible coordinate) where they can park the car. In case there\'s no such place, the driver drives on searching for his perfect peaceful haven. Sometimes some cars leave the street and free some space for parking. Considering that there never are two moving cars on a street at a time write a program that can use the data on the drivers, entering the street hoping to park there and the drivers leaving it, to model the process and determine a parking lot space for each car." 1800

46C "Hamsters and Tigers" "two pointers" "Today there is going to be an unusual performance at the circus \xe2\x80\x94 hamsters and tigers will perform together! All of them stand in circle along the arena edge and now the trainer faces a difficult task: he wants to swap the animals\' positions so that all the hamsters stood together and all the tigers also stood together. The trainer swaps the animals in pairs not to create a mess. He orders two animals to step out of the circle and swap places. As hamsters feel highly uncomfortable when tigers are nearby as well as tigers get nervous when there\'s so much potential prey around (consisting not only of hamsters but also of yummier spectators), the trainer wants to spend as little time as possible moving the animals, i.e. he wants to achieve it with the minimal number of swaps. Your task is to help him." 1600

46B "T-shirts from Sponsor" implementation "One day a well-known sponsor of a well-known contest decided to give every participant of the contest a T-shirt as a present. A natural problem occurred: on the one hand, it is not clear how many T-shirts of what sizes should be ordered, and on the other hand, one doesn\'t want to order too many T-shirts (and we do not exactly paper the walls with the oversupply). After considerable brain racking and some pre-estimating, the sponsor representatives ordered a certain number of T-shirts of sizes S, M, L, XL and XXL. The T-shirts turned out to bring good luck, that\'s why on the contest day there built up a line of K participants willing to get one. Every contestant is characterized by his/her desired T-shirt size (so it happens that for all the participants it is also one of the sizes S, M, L, XL and XXL). The participants come up to get a T-shirt one by one and try to choose the most suitable one, choosing it like this. If there is still a T-shirt of the optimal size left, that he/she takes it without further ado. Otherwise the contestant would prefer to choose a T-shirt with the size as close to the optimal one as possible (the distance between neighboring sizes is considered equal to one). If the variant of choice is not unique, the contestant will take a T-shirt of a bigger size (in case he/she grows more). For example, for a person whose optimal size is L the preference list looks like this: L, XL, M, XXL, S. Using the data on how many T-shirts of every size had been ordered by the organizers, on the size of contestants in the line determine who got a T-shirt of what size." 1100

46A "Ball Game" "brute force,implementation" "A kindergarten teacher Natalia Pavlovna has invented a new ball game. This game not only develops the children\'s physique, but also teaches them how to count. The game goes as follows. Kids stand in circle. Let\'s agree to think of the children as numbered with numbers from 1 to n clockwise and the child number 1 is holding the ball. First the first child throws the ball to the next one clockwise, i.e. to the child number 2. Then the child number 2 throws the ball to the next but one child, i.e. to the child number 4, then the fourth child throws the ball to the child that stands two children away from him, i.e. to the child number 7, then the ball is thrown to the child who stands 3 children away from the child number 7, then the ball is thrown to the child who stands 4 children away from the last one, and so on. It should be mentioned that when a ball is thrown it may pass the beginning of the circle. For example, if n\xe2\x80\x89=\xe2\x80\x895, then after the third throw the child number 2 has the ball again. Overall, n\xe2\x80\x89-\xe2\x80\x891 throws are made, and the game ends.The problem is that not all the children get the ball during the game. If a child doesn\'t get the ball, he gets very upset and cries until Natalia Pavlovna gives him a candy. That\'s why Natalia Pavlovna asks you to help her to identify the numbers of the children who will get the ball after each throw." 800

45J "Planting Trees" "constructive algorithms" "Vasya is a Greencode wildlife preservation society proponent. One day he found an empty field nobody owned, divided it into n\xe2\x80\x89\xc3\x97\xe2\x80\x89m squares and decided to plant a forest there. Vasya will plant nm trees of all different heights from 1 to nm. For his forest to look more natural he wants any two trees growing in the side neighbouring squares to have the absolute value of difference in heights to be strictly more than 1. Help Vasya: make the plan of the forest planting for which this condition is fulfilled." 1800

45I TCMCF+++ greedy "Vasya has gotten interested in programming contests in TCMCF+++ rules. On the contest n problems were suggested and every problem had a cost \xe2\x80\x94 a certain integral number of points (perhaps, negative or even equal to zero). According to TCMCF+++ rules, only accepted problems can earn points and the overall number of points of a contestant was equal to the product of the costs of all the problems he/she had completed. If a person didn\'t solve anything, then he/she didn\'t even appear in final standings and wasn\'t considered as participant. Vasya understood that to get the maximal number of points it is not always useful to solve all the problems. Unfortunately, he understood it only after the contest was finished. Now he asks you to help him: find out what problems he had to solve to earn the maximal number of points." 1400

45H "Road Problem" graphs "The Berland capital (as you very well know) contains n junctions, some pairs of which are connected by two-way roads. Unfortunately, the number of traffic jams in the capital has increased dramatically, that\'s why it was decided to build several new roads. Every road should connect two junctions. The city administration noticed that in the cities of all the developed countries between any two roads one can drive along at least two paths so that the paths don\'t share any roads (but they may share the same junction). The administration decided to add the minimal number of roads so that this rules was fulfilled in the Berland capital as well. In the city road network should exist no more than one road between every pair of junctions before or after the reform." 2100

45G "Prime Problem" "number theory" "In Berland prime numbers are fashionable \xe2\x80\x94 the respectable citizens dwell only on the floors with numbers that are prime numbers. The numismatists value particularly high the coins with prime nominal values. All the prime days are announced holidays!Yet even this is not enough to make the Berland people happy. On the main street of the capital stand n houses, numbered from 1 to n. The government decided to paint every house a color so that the sum of the numbers of the houses painted every color is a prime number.However it turned out that not all the citizens approve of this decision \xe2\x80\x94 many of them protest because they don\'t want many colored houses on the capital\'s main street. That\'s why it is decided to use the minimal possible number of colors. The houses don\'t have to be painted consecutively, but every one of n houses should be painted some color. The one-colored houses should not stand consecutively, any way of painting is acceptable.There are no more than 5 hours left before the start of painting, help the government find the way when the sum of house numbers for every color is a prime number and the number of used colors is minimal." 2200

45F "Goats and Wolves" greedy "Once Vasya needed to transport m goats and m wolves from riverbank to the other as quickly as possible. The boat can hold n animals and Vasya, in addition, he is permitted to put less than n animals in the boat. If in one place (on one of the banks or in the boat) the wolves happen to strictly outnumber the goats, then the wolves eat the goats and Vasya gets upset. When Vasya swims on the boat from one shore to the other, he must take at least one animal to accompany him, otherwise he will get bored and he will, yet again, feel upset. When the boat reaches the bank, first all the animals get off simultaneously, and then the animals chosen by Vasya simultaneously get on the boat. That means that at the moment when the animals that have just arrived have already got off and the animals that are going to leave haven\'t yet got on, somebody might eat someone. Vasya needs to transport all the animals from one river bank to the other so that nobody eats anyone and Vasya doesn\'t get upset. What is the minimal number of times he will have to cross the river?" 2500

45E Director "constructive algorithms,greedy" "Vasya is a born Berland film director, he is currently working on a new blockbuster, ""The Unexpected"". Vasya knows from his own experience how important it is to choose the main characters\' names and surnames wisely. He made up a list of n names and n surnames that he wants to use. Vasya haven\'t decided yet how to call characters, so he is free to match any name to any surname. Now he has to make the list of all the main characters in the following format: ""Name1 Surname1, Name2 Surname2, ..., Namen Surnamen"", i.e. all the name-surname pairs should be separated by exactly one comma and exactly one space, and the name should be separated from the surname by exactly one space. First of all Vasya wants to maximize the number of the pairs, in which the name and the surname start from one letter. If there are several such variants, Vasya wants to get the lexicographically minimal one. Help him.An answer will be verified a line in the format as is shown above, including the needed commas and spaces. It\'s the lexicographical minimality of such a line that needs to be ensured. The output line shouldn\'t end with a space or with a comma." 2000

45D "Event Dates" greedy,meet-in-the-middle,sortings "On a history lesson the teacher asked Vasya to name the dates when n famous events took place. He doesn\'t remembers the exact dates but he remembers a segment of days [li,\xe2\x80\x89ri] (inclusive) on which the event could have taken place. However Vasya also remembers that there was at most one event in one day. Help him choose such n dates of famous events that will fulfill both conditions. It is guaranteed that it is possible." 1900

45C "Dancing Lessons" "data structures" "There are n people taking dancing lessons. Every person is characterized by his/her dancing skill ai. At the beginning of the lesson they line up from left to right. While there is at least one couple of a boy and a girl in the line, the following process is repeated: the boy and girl who stand next to each other, having the minimal difference in dancing skills start to dance. If there are several such couples, the one first from the left starts to dance. After a couple leaves to dance, the line closes again, i.e. as a result the line is always continuous. The difference in dancing skills is understood as the absolute value of difference of ai variable. Your task is to find out what pairs and in what order will start dancing." 1900

45B School dp,dsu "There are n students studying in the 6th grade, in group ""B"" of a berland secondary school. Every one of them has exactly one friend whom he calls when he has some news. Let us denote the friend of the person number i by g(i). Note that the friendships are not mutual, i.e. g(g(i)) is not necessarily equal to i.On day i the person numbered as ai learns the news with the rating of bi (bi\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x891). He phones the friend immediately and tells it. While he is doing it, the news becomes old and its rating falls a little and becomes equal to bi\xe2\x80\x89-\xe2\x80\x891. The friend does the same thing \xe2\x80\x94 he also calls his friend and also tells the news. The friend of the friend gets the news already rated as bi\xe2\x80\x89-\xe2\x80\x892. It all continues until the rating of the news reaches zero as nobody wants to tell the news with zero rating. More formally, everybody acts like this: if a person x learns the news with a non-zero rating y, he calls his friend g(i) and his friend learns the news with the rating of y\xe2\x80\x89-\xe2\x80\x891 and, if it is possible, continues the process.Let us note that during a day one and the same person may call his friend and tell him one and the same news with different ratings. Thus, the news with the rating of bi will lead to as much as bi calls.Your task is to count the values of resi \xe2\x80\x94 how many students learned their first news on day i.The values of bi are known initially, whereas ai is determined from the following formula:  where mod stands for the operation of taking the excess from the cleavage, res0 is considered equal to zero and vi \xe2\x80\x94 some given integers." 2200

45A "Codecraft III" implementation "Today Vasya visited a widely known site and learned that the continuation of his favourite game Codecraft II will appear after exactly k months. He looked at the calendar and learned that at the moment is the month number s. Vasya immediately got interested in what month Codecraft III will appear. Help him understand that.All the twelve months in Vasya\'s calendar are named using their usual English names: January, February, March, April, May, June, July, August, September, October, November, December." 900

44J Triminoes "constructive algorithms,greedy" "There are many interesting tasks on domino tilings. For example, an interesting fact is known. Let us take a standard chessboard (8\xe2\x80\x89\xc3\x97\xe2\x80\x898) and cut exactly two squares out of it. It turns out that the resulting board can always be tiled using dominoes 1\xe2\x80\x89\xc3\x97\xe2\x80\x892, if the two cut out squares are of the same color, otherwise it is impossible. Petya grew bored with dominoes, that\'s why he took a chessboard (not necessarily 8\xe2\x80\x89\xc3\x97\xe2\x80\x898), cut some squares out of it and tries to tile it using triminoes. Triminoes are reactangles 1\xe2\x80\x89\xc3\x97\xe2\x80\x893 (or 3\xe2\x80\x89\xc3\x97\xe2\x80\x891, because triminoes can be rotated freely), also the two extreme squares of a trimino are necessarily white and the square in the middle is black. The triminoes are allowed to put on the chessboard so that their squares matched the colors of the uncut squares of the chessboard, and also the colors must match: the black squares must be matched with the black ones only and the white ones \xe2\x80\x94 with the white squares. The triminoes must not protrude above the chessboard or overlap each other. All the uncut squares of the board must be covered with triminoes. Help Petya find out if it is possible to tile his board using triminos in the described way and print one of the variants of tiling." 2000

44I Toys "brute force,combinatorics" "Little Masha loves arranging her toys into piles on the floor. And she also hates it when somebody touches her toys. One day Masha arranged all her n toys into several piles and then her elder brother Sasha came and gathered all the piles into one. Having seen it, Masha got very upset and started crying. Sasha still can\'t calm Masha down and mom is going to come home soon and punish Sasha for having made Masha crying. That\'s why he decides to restore the piles\' arrangement. However, he doesn\'t remember at all the way the toys used to lie. Of course, Masha remembers it, but she can\'t talk yet and can only help Sasha by shouting happily when he arranges the toys in the way they used to lie. That means that Sasha will have to arrange the toys in every possible way until Masha recognizes the needed arrangement. The relative position of the piles and toys in every pile is irrelevant, that\'s why the two ways of arranging the toys are considered different if can be found two such toys that when arranged in the first way lie in one and the same pile and do not if arranged in the second way. Sasha is looking for the fastest way of trying all the ways because mom will come soon. With every action Sasha can take a toy from any pile and move it to any other pile (as a result a new pile may appear or the old one may disappear). Sasha wants to find the sequence of actions as a result of which all the pile arrangement variants will be tried exactly one time each. Help Sasha. As we remember, initially all the toys are located in one pile." 2300

44H "Phone Number" dp "Alas, finding one\'s true love is not easy. Masha has been unsuccessful in that yet. Her friend Dasha told Masha about a way to determine the phone number of one\'s Prince Charming through arithmancy. The phone number is divined like that. First one needs to write down one\'s own phone numbers. For example, let\'s suppose that Masha\'s phone number is 12345. After that one should write her favorite digit from 0 to 9 under the first digit of her number. That will be the first digit of the needed number. For example, Masha\'s favorite digit is 9. The second digit is determined as a half sum of the second digit of Masha\'s number and the already written down first digit from her beloved one\'s number. In this case the arithmetic average equals to (2\xe2\x80\x89+\xe2\x80\x899)\xe2\x80\x89/\xe2\x80\x892\xe2\x80\x89=\xe2\x80\x895.5. Masha can round the number up or down, depending on her wishes. For example, she chooses the digit 5. Having written down the resulting digit under the second digit of her number, Masha moves to finding the third digit in the same way, i.e. finding the half sum the the third digit of her number and the second digit of the new number. The result is (5\xe2\x80\x89+\xe2\x80\x893)\xe2\x80\x89/\xe2\x80\x892\xe2\x80\x89=\xe2\x80\x894. In this case the answer is unique. Thus, every i-th digit is determined as an arithmetic average of the i-th digit of Masha\'s number and the i\xe2\x80\x89-\xe2\x80\x891-th digit of her true love\'s number. If needed, the digit can be rounded up or down. For example, Masha can get: 12345 95444 Unfortunately, when Masha tried dialing the number, she got disappointed: as it turned out, the number was unavailable or outside the coverage area. But Masha won\'t give up. Perhaps, she rounded to a wrong digit or chose the first digit badly. That\'s why she keeps finding more and more new numbers and calling them. Count the number of numbers Masha calls. Masha calls all the possible numbers that can be found by the described means of arithmancy, except for, perhaps, her own one." 1700

44G "Shooting Gallery" "data structures,implementation" "Berland amusement park shooting gallery is rightly acknowledged as one of the best in the world. Every day the country\'s best shooters master their skills there and the many visitors compete in clay pigeon shooting to win decent prizes. And the head of the park has recently decided to make an online version of the shooting gallery. During the elaboration process it turned out that the program that imitates the process of shooting effectively, is needed. To formulate the requirements to the program, the shooting gallery was formally described. A 3D Cartesian system of coordinates was introduced, where the X axis ran across the gallery floor along the line, along which the shooters are located, the Y axis ran vertically along the gallery wall and the positive direction of the Z axis matched the shooting direction. Let\'s call the XOY plane a shooting plane and let\'s assume that all the bullets are out of the muzzles at the points of this area and fly parallel to the Z axis. Every clay pigeon can be represented as a rectangle whose sides are parallel to X and Y axes, and it has a positive z-coordinate. The distance between a clay pigeon and the shooting plane is always different for every target. The bullet hits the target if it goes through the inner area or border of the rectangle corresponding to it. When the bullet hits the target, the target falls down vertically into the crawl-space of the shooting gallery and cannot be shot at any more. The targets are tough enough, that\'s why a bullet can not pierce a target all the way through and if a bullet hits a target it can\'t fly on. In input the simulator program is given the arrangement of all the targets and also of all the shots in the order of their appearance. The program should determine which target was hit by which shot. If you haven\'t guessed it yet, you are the one who is to write such a program." 2500

44F BerPaint geometry,graphs "Anfisa the monkey got disappointed in word processors as they aren\'t good enough at reflecting all the range of her emotions, that\'s why she decided to switch to graphics editors. Having opened the BerPaint, she saw a white rectangle W\xe2\x80\x89\xc3\x97\xe2\x80\x89H in size which can be painted on. First Anfisa learnt to navigate the drawing tool which is used to paint segments and quickly painted on that rectangle a certain number of black-colored segments. The resulting picture didn\'t seem bright enough to Anfisa, that\'s why she turned her attention to the ""fill"" tool which is used to find a point on the rectangle to paint and choose a color, after which all the area which is the same color as the point it contains, is completely painted the chosen color. Having applied the fill several times, Anfisa expressed her emotions completely and stopped painting. Your task is by the information on the painted segments and applied fills to find out for every color the total area of the areas painted this color after all the fills." 2700

44E "Anfisa the Monkey" dp "Anfisa the monkey learns to type. She is yet unfamiliar with the ""space"" key and can only type in lower-case Latin letters. Having typed for a fairly long line, Anfisa understood that it would be great to divide what she has written into k lines not shorter than a and not longer than b, for the text to resemble human speech more. Help Anfisa." 1400

44D Hyperdrive math "In a far away galaxy there are n inhabited planets, numbered with numbers from 1 to n. They are located at large distances from each other, that\'s why the communication between them was very difficult until on the planet number 1 a hyperdrive was invented. As soon as this significant event took place, n\xe2\x80\x89-\xe2\x80\x891 spaceships were built on the planet number 1, and those ships were sent to other planets to inform about the revolutionary invention. Paradoxical thought it may be, but the hyperspace is represented as simple three-dimensional Euclidean space. The inhabited planets may be considered fixed points in it, and no two points coincide and no three points lie on the same straight line. The movement of a ship with a hyperdrive between two planets is performed along a straight line at the constant speed, the same for all the ships. That\'s why the distance in the hyperspace are measured in hyperyears (a ship with a hyperdrive covers a distance of s hyperyears in s years).When the ship reaches an inhabited planet, the inhabitants of the planet dissemble it, make n\xe2\x80\x89-\xe2\x80\x892 identical to it ships with a hyperdrive and send them to other n\xe2\x80\x89-\xe2\x80\x892 planets (except for the one from which the ship arrived). The time to make a new ship compared to the time in which they move from one planet to another is so small that it can be disregarded. New ships are absolutely identical to the ones sent initially: they move at the same constant speed along a straight line trajectory and, having reached a planet, perform the very same mission, i.e. are dissembled to build new n\xe2\x80\x89-\xe2\x80\x892 ships and send them to all the planets except for the one from which the ship arrived. Thus, the process of spreading the important news around the galaxy continues.However the hyperdrive creators hurried to spread the news about their invention so much that they didn\'t study completely what goes on when two ships collide in the hyperspace. If two moving ships find themselves at one point, they provoke an explosion of colossal power, leading to the destruction of the galaxy!Your task is to find the time the galaxy will continue to exist from the moment of the ships\' launch from the first planet." 1800

44C Holidays implementation "School holidays come in Berland. The holidays are going to continue for n days. The students of school \xe2\x84\x96N are having the time of their lives and the IT teacher Marina Sergeyevna, who has spent all the summer busy checking the BSE (Berland State Examination) results, has finally taken a vacation break! Some people are in charge of the daily watering of flowers in shifts according to the schedule. However when Marina Sergeyevna was making the schedule, she was so tired from work and so lost in dreams of the oncoming vacation that she perhaps made several mistakes. In fact, it is possible that according to the schedule, on some days during the holidays the flowers will not be watered or will be watered multiple times. Help Marina Sergeyevna to find a mistake." 1300

44B Cola implementation "To celebrate the opening of the Winter Computer School the organizers decided to buy in n liters of cola. However, an unexpected difficulty occurred in the shop: it turned out that cola is sold in bottles 0.5, 1 and 2 liters in volume. At that, there are exactly a bottles 0.5 in volume, b one-liter bottles and c of two-liter ones. The organizers have enough money to buy any amount of cola. What did cause the heated arguments was how many bottles of every kind to buy, as this question is pivotal for the distribution of cola among the participants (and organizers as well).Thus, while the organizers are having the argument, discussing different variants of buying cola, the Winter School can\'t start. Your task is to count the number of all the possible ways to buy exactly n liters of cola and persuade the organizers that this number is too large, and if they keep on arguing, then the Winter Computer School will have to be organized in summer.All the bottles of cola are considered indistinguishable, i.e. two variants of buying are different from each other only if they differ in the number of bottles of at least one kind." 1500

44A "Indian Summer" implementation "Indian summer is such a beautiful time of the year! A girl named Alyona is walking in the forest and picking a bouquet from fallen leaves. Alyona is very choosy \xe2\x80\x94 she doesn\'t take a leaf if it matches the color and the species of the tree of one of the leaves she already has. Find out how many leaves Alyona has picked." 900

43E Race "brute force,implementation,two pointers" "Today s kilometer long auto race takes place in Berland. The track is represented by a straight line as long as s kilometers. There are n cars taking part in the race, all of them start simultaneously at the very beginning of the track. For every car is known its behavior \xe2\x80\x94 the system of segments on each of which the speed of the car is constant. The j-th segment of the i-th car is pair (vi,\xe2\x80\x89j,\xe2\x80\x89ti,\xe2\x80\x89j), where vi,\xe2\x80\x89j is the car\'s speed on the whole segment in kilometers per hour and ti,\xe2\x80\x89j is for how many hours the car had been driving at that speed. The segments are given in the order in which they are ""being driven on"" by the cars.Your task is to find out how many times during the race some car managed to have a lead over another car. A lead is considered a situation when one car appears in front of another car. It is known, that all the leads happen instantly, i. e. there are no such time segment of positive length, during which some two cars drive ""together"". At one moment of time on one and the same point several leads may appear. In this case all of them should be taken individually. Meetings of cars at the start and finish are not considered to be counted as leads." 2300

43D Journey "brute force,constructive algorithms,implementation" "The territory of Berland is represented by a rectangular field n\xe2\x80\x89\xc3\x97\xe2\x80\x89m in size. The king of Berland lives in the capital, located on the upper left square (1,\xe2\x80\x891). The lower right square has coordinates (n,\xe2\x80\x89m). One day the king decided to travel through the whole country and return back to the capital, having visited every square (except the capital) exactly one time. The king must visit the capital exactly two times, at the very beginning and at the very end of his journey. The king can only move to the side-neighboring squares. However, the royal advise said that the King possibly will not be able to do it. But there is a way out \xe2\x80\x94 one can build the system of one way teleporters between some squares so that the king could fulfill his plan. No more than one teleporter can be installed on one square, every teleporter can be used any number of times, however every time it is used, it transports to the same given for any single teleporter square. When the king reaches a square with an installed teleporter he chooses himself whether he is or is not going to use the teleport. What minimum number of teleporters should be installed for the king to complete the journey? You should also compose the journey path route for the king." 2000

43C "Lucky Tickets" greedy "Vasya thinks that lucky tickets are the tickets whose numbers are divisible by 3. He gathered quite a large collection of such tickets but one day his younger brother Leonid was having a sulk and decided to destroy the collection. First he tore every ticket exactly in two, but he didn\xe2\x80\x99t think it was enough and Leonid also threw part of the pieces away. Having seen this, Vasya got terrified but still tried to restore the collection. He chose several piece pairs and glued each pair together so that each pair formed a lucky ticket. The rest of the pieces Vasya threw away reluctantly. Thus, after the gluing of the 2t pieces he ended up with t tickets, each of which was lucky.When Leonid tore the tickets in two pieces, one piece contained the first several letters of his number and the second piece contained the rest.Vasya can glue every pair of pieces in any way he likes, but it is important that he gets a lucky ticket in the end. For example, pieces 123 and 99 can be glued in two ways: 12399 and 99123.What maximum number of tickets could Vasya get after that?" 1300

43B Letter implementation,strings "Vasya decided to write an anonymous letter cutting the letters out of a newspaper heading. He knows heading s1 and text s2 that he wants to send. Vasya can use every single heading letter no more than once. Vasya doesn\'t have to cut the spaces out of the heading \xe2\x80\x94 he just leaves some blank space to mark them. Help him; find out if he will manage to compose the needed text." 1100

43A Football strings "One day Vasya decided to have a look at the results of Berland 1910 Football Championship\xe2\x80\x99s finals. Unfortunately he didn\'t find the overall score of the match; however, he got hold of a profound description of the match\'s process. On the whole there are n lines in that description each of which described one goal. Every goal was marked with the name of the team that had scored it. Help Vasya, learn the name of the team that won the finals. It is guaranteed that the match did not end in a tie." 1000

42E "Baldman and the military" "dfs and similar,graphs,trees" "Baldman is a warp master. He possesses a unique ability \xe2\x80\x94 creating wormholes! Given two positions in space, Baldman can make a wormhole which makes it possible to move between them in both directions. Unfortunately, such operation isn\'t free for Baldman: each created wormhole makes him lose plenty of hair from his head.Because of such extraordinary abilities, Baldman has caught the military\'s attention. He has been charged with a special task. But first things first.The military base consists of several underground objects, some of which are connected with bidirectional tunnels. There necessarily exists a path through the tunnel system between each pair of objects. Additionally, exactly two objects are connected with surface. For the purposes of security, a patrol inspects the tunnel system every day: he enters one of the objects which are connected with surface, walks the base passing each tunnel at least once and leaves through one of the objects connected with surface. He can enter and leave either through the same object, or through different objects. The military management noticed that the patrol visits some of the tunnels multiple times and decided to optimize the process. Now they are faced with a problem: a system of wormholes needs to be made to allow of a patrolling which passes each tunnel exactly once. At the same time a patrol is allowed to pass each wormhole any number of times.This is where Baldman comes to operation: he is the one to plan and build the system of the wormholes. Unfortunately for him, because of strict confidentiality the military can\'t tell him the arrangement of tunnels. Instead, they insist that his system of portals solves the problem for any arrangement of tunnels which satisfies the given condition. Nevertheless, Baldman has some information: he knows which pairs of objects he can potentially connect and how much it would cost him (in hair). Moreover, tomorrow he will be told which objects (exactly two) are connected with surface. Of course, our hero decided not to waste any time and calculate the minimal cost of getting the job done for some pairs of objects (which he finds likely to be the ones connected with surface). Help Baldman!" 2700

42D "Strange town" "constructive algorithms,math" "Volodya has recently visited a very odd town. There are N tourist attractions in the town and every two of them are connected by a bidirectional road. Each road has some travel price (natural number) assigned to it and all prices are distinct. But the most striking thing about this town is that each city sightseeing tour has the same total price! That is, if we choose any city sightseeing tour \xe2\x80\x94 a cycle which visits every attraction exactly once \xe2\x80\x94 the sum of the costs of the tour roads is independent of the tour. Volodya is curious if you can find such price system with all road prices not greater than 1000." 2300

42C "Safe cracking" "brute force,constructive algorithms" "Right now you are to solve a very, very simple problem \xe2\x80\x94 to crack the safe. Four positive integers stand one by one on a circle protecting the safe. You know that to unlock this striking safe you have to make all four numbers equal to one. Operations are as follows: you may choose two adjacent numbers and increase both by one; you may choose two adjacent even numbers and divide both by two. Nothing else. Crack the safe!" 2200

42B "Game of chess unfinished" implementation "Once Volodya was at the museum and saw a regular chessboard as a museum piece. And there were only four chess pieces on it: two white rooks, a white king and a black king. ""Aha, blacks certainly didn\'t win!"", \xe2\x80\x94 Volodya said and was right for sure. And your task is to say whether whites had won or not.Pieces on the chessboard are guaranteed to represent a correct position (every piece occupies one cell, no two pieces occupy the same cell and kings cannot take each other). Thus, your task is only to decide whether whites mate blacks. We would remind you that it means that the black king can be taken by one of the opponent\'s pieces at the moment and also it cannot move to an unbeaten position. A rook moves vertically or horizontally by any number of free cells (assuming there are no other pieces on its path), a king \xe2\x80\x94 to the adjacent cells (either by corner or by side). Certainly, pieces cannot leave the board. The black king might be able to take opponent\'s rooks at his turn (see sample 3)." 1700

42A "Guilty --- to the kitchen!" greedy,implementation "It\'s a very unfortunate day for Volodya today. He got bad mark in algebra and was therefore forced to do some work in the kitchen, namely to cook borscht (traditional Russian soup). This should also improve his algebra skills.According to the borscht recipe it consists of n ingredients that have to be mixed in proportion  litres (thus, there should be a1\xe2\x80\x89\xc2\xb7x,\xe2\x80\x89...,\xe2\x80\x89an\xe2\x80\x89\xc2\xb7x litres of corresponding ingredients mixed for some non-negative x). In the kitchen Volodya found out that he has b1,\xe2\x80\x89...,\xe2\x80\x89bn litres of these ingredients at his disposal correspondingly. In order to correct his algebra mistakes he ought to cook as much soup as possible in a V litres volume pan (which means the amount of soup cooked can be between 0 and V litres). What is the volume of borscht Volodya will cook ultimately?" 1400

41E 3-cycles "constructive algorithms,graphs,greedy" "During a recent research Berland scientists found out that there were n cities in Ancient Berland, joined by two-way paths. Any two cities are joined by no more than one path. No path joins a city with itself. According to a well-known tradition, the road network was built so that it would be impossible to choose three cities from each of which one can get to any other one directly. That is, there was no cycle exactly as long as 3. Unfortunately, the road map has not been preserved till nowadays. Now the scientists are interested how much developed a country Ancient Berland was. Help them - find, what maximal number of roads could be in the country. You also have to restore any of the possible road maps." 1900

41D Pawn dp "On some square in the lowest row of a chessboard a stands a pawn. It has only two variants of moving: upwards and leftwards or upwards and rightwards. The pawn can choose from which square of the lowest row it can start its journey. On each square lay from 0 to 9 peas. The pawn wants to reach the uppermost row having collected as many peas as possible. As there it will have to divide the peas between itself and its k brothers, the number of peas must be divisible by k\xe2\x80\x89+\xe2\x80\x891. Find the maximal number of peas it will be able to collect and which moves it should make to do it.The pawn cannot throw peas away or leave the board. When a pawn appears in some square of the board (including the first and last square of the way), it necessarily takes all the peas." 1900

41C "Email address" "expression parsing,implementation" "Sometimes one has to spell email addresses over the phone. Then one usually pronounces a dot as dot, an at sign as at. As a result, we get something like vasyaatgmaildotcom. Your task is to transform it into a proper email address (vasya@gmail.com). It is known that a proper email address contains only such symbols as . @ and lower-case Latin letters, doesn\'t start with and doesn\'t end with a dot. Also, a proper email address doesn\'t start with and doesn\'t end with an at sign. Moreover, an email address contains exactly one such symbol as @, yet may contain any number (possible, zero) of dots. You have to carry out a series of replacements so that the length of the result was as short as possible and it was a proper email address. If the lengths are equal, you should print the lexicographically minimal result. Overall, two variants of replacement are possible: dot can be replaced by a dot, at can be replaced by an at." 1300

41B "Martian Dollar" "brute force" "One day Vasya got hold of information on the Martian dollar course in bourles for the next n days. The buying prices and the selling prices for one dollar on day i are the same and are equal to ai. Vasya has b bourles. He can buy a certain number of dollars and then sell it no more than once in n days. According to Martian laws, one can buy only an integer number of dollars. Which maximal sum of money in bourles can Vasya get by the end of day n?" 1400

41A Translation implementation,strings "The translation from the Berland language into the Birland language is not an easy task. Those languages are very similar: a Berlandish word differs from a Birlandish word with the same meaning a little: it is spelled (and pronounced) reversely. For example, a Berlandish word code corresponds to a Birlandish word edoc. However, making a mistake during the ""translation"" is easy. Vasya translated the word s from Berlandish into Birlandish as t. Help him: find out if he translated the word correctly." 800

40E "Number Table" combinatorics "As it has been found out recently, all the Berland\'s current economical state can be described using a simple table n\xe2\x80\x89\xc3\x97\xe2\x80\x89m in size. n \xe2\x80\x94 the number of days in each Berland month, m \xe2\x80\x94 the number of months. Thus, a table cell corresponds to a day and a month of the Berland\'s year. Each cell will contain either 1, or -1, which means the state\'s gains in a particular month, on a particular day. 1 corresponds to profits, -1 corresponds to losses. It turned out important for successful development to analyze the data on the state of the economy of the previous year, however when the treasurers referred to the archives to retrieve the data, it turned out that the table had been substantially damaged. In some table cells the number values had faded and were impossible to be deciphered. It is known that the number of cells in which the data had been preserved is strictly less than max(n,\xe2\x80\x89m). However, there is additional information \xe2\x80\x94 the product of the numbers in each line and column equaled -1. Your task is to find out how many different tables may conform to the preserved data. As the answer to the task can be quite large, you have to find it modulo p." 2500

40D "Interesting Sequence" math "Berland scientists noticed long ago that the world around them depends on Berland population. Due to persistent research in this area the scientists managed to find out that the Berland chronology starts from the moment when the first two people came to that land (it is considered to have happened in the first year). After one Berland year after the start of the chronology the population had already equaled 13 people (the second year). However, tracing the population number during the following years was an ultimately difficult task, still it was found out that if di \xe2\x80\x94 the number of people in Berland in the year of i, then either di\xe2\x80\x89=\xe2\x80\x8912di\xe2\x80\x89-\xe2\x80\x892, or di\xe2\x80\x89=\xe2\x80\x8913di\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89-\xe2\x80\x8912di\xe2\x80\x89-\xe2\x80\x892. Of course no one knows how many people are living in Berland at the moment, but now we can tell if there could possibly be a year in which the country population equaled A. That\'s what we ask you to determine. Also, if possible, you have to find out in which years it could be (from the beginning of Berland chronology). Let\'s suppose that it could be in the years of a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89ak. Then you have to define how many residents could be in the country during those years apart from the A variant. Look at the examples for further explanation." 2600

40C "Berland Square" implementation,math "Last year the world\'s largest square was built in Berland. It is known that the square can be represented as an infinite plane with an introduced Cartesian system of coordinates. On that square two sets of concentric circles were painted. Let\'s call the set of concentric circles with radii 1,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89K and the center in the point (z,\xe2\x80\x890) a (K,\xe2\x80\x89z)-set. Thus, on the square were painted a (N,\xe2\x80\x89x)-set and a (M,\xe2\x80\x89y)-set. You have to find out how many parts those sets divided the square into." 2300

40B Repaintings math "A chessboard n\xe2\x80\x89\xc3\x97\xe2\x80\x89m in size is given. During the zero minute we repaint all the black squares to the 0 color. During the i-th minute we repaint to the i color the initially black squares that have exactly four corner-adjacent squares painted i\xe2\x80\x89-\xe2\x80\x891 (all such squares are repainted simultaneously). This process continues ad infinitum. You have to figure out how many squares we repainted exactly x times.The upper left square of the board has to be assumed to be always black. Two squares are called corner-adjacent, if they have exactly one common point." 1600

40A "Find Color" "constructive algorithms,geometry,implementation,math" "Not so long ago as a result of combat operations the main Berland place of interest \xe2\x80\x94 the magic clock \xe2\x80\x94 was damaged. The cannon\'s balls made several holes in the clock, that\'s why the residents are concerned about the repair. The magic clock can be represented as an infinite Cartesian plane, where the origin corresponds to the clock center. The clock was painted two colors as is shown in the picture:  The picture shows only the central part of the clock. This coloring naturally extends to infinity.The balls can be taken to be points on the plane. Your task is to find the color of the area, damaged by the given ball.All the points located on the border of one of the areas have to be considered painted black." 1300

39K Testing NA "You take part in the testing of new weapon. For the testing a polygon was created. The polygon is a rectangular field n\xe2\x80\x89\xc3\x97\xe2\x80\x89m in size, divided into unit squares 1\xe2\x80\x89\xc3\x97\xe2\x80\x891 in size. The polygon contains k objects, each of which is a rectangle with sides, parallel to the polygon sides and entirely occupying several unit squares. The objects don\'t intersect and don\'t touch each other.The principle according to which the weapon works is highly secret. You only know that one can use it to strike any rectangular area whose area is not equal to zero with sides, parallel to the sides of the polygon. The area must completely cover some of the unit squares into which the polygon is divided and it must not touch the other squares. Of course the area mustn\'t cross the polygon border. Your task is as follows: you should hit no less than one and no more than three rectangular objects. Each object must either lay completely inside the area (in that case it is considered to be hit), or lay completely outside the area.Find the number of ways of hitting." 2600

39J "Spelling Check" hashing,implementation,strings "Petya has noticed that when he types using a keyboard, he often presses extra buttons and adds extra letters to the words. Of course, the spell-checking system underlines the words for him and he has to click every word and choose the right variant. Petya got fed up with correcting his mistakes himself, that\xe2\x80\x99s why he decided to invent the function that will correct the words itself. Petya started from analyzing the case that happens to him most of the time, when all one needs is to delete one letter for the word to match a word from the dictionary. Thus, Petya faces one mini-task: he has a printed word and a word from the dictionary, and he should delete one letter from the first word to get the second one. And now the very non-trivial question that Petya faces is: which letter should he delete?" 1500

39I Tram NA "In a Berland city S*** there is a tram engine house and only one tram. Three people work in the house \xe2\x80\x94 the tram driver, the conductor and the head of the engine house. The tram used to leave the engine house every morning and drove along his loop route. The tram needed exactly c minutes to complete the route. The head of the engine house controlled the tram\xe2\x80\x99s movement, going outside every c minutes when the tram drove by the engine house, and the head left the driver without a bonus if he was even one second late.It used to be so. Afterwards the Berland Federal Budget gave money to make more tramlines in S***, and, as it sometimes happens, the means were used as it was planned. The tramlines were rebuilt and as a result they turned into a huge network. The previous loop route may have been destroyed. S*** has n crossroads and now m tramlines that links the pairs of crossroads. The traffic in Berland is one way so the tram can move along each tramline only in one direction. There may be several tramlines between two crossroads, which go same way or opposite ways. Every tramline links two different crossroads and for each crossroad there is at least one outgoing tramline.So, the tramlines were built but for some reason nobody gave a thought to increasing the number of trams in S***! The tram continued to ride alone but now the driver had an excellent opportunity to get rid of the unending control of the engine house head. For now due to the tramline network he could choose the route freely! Now at every crossroad the driver can arbitrarily choose the way he can go. The tram may even go to the parts of S*** from where it cannot return due to one way traffic. The driver is not afraid of the challenge: at night, when the city is asleep, he can return to the engine house safely, driving along the tramlines in the opposite direction.The city people were rejoicing for some of the had been waiting for the tram to appear on their streets for several years. However, the driver\xe2\x80\x99s behavior enraged the engine house head. Now he tries to carry out an insidious plan of installing cameras to look after the rebellious tram.The plan goes as follows. The head of the engine house wants to install cameras at some crossroads, to choose a period of time t and every t minutes turn away from the favourite TV show to check where the tram is. Also the head of the engine house wants at all moments of time, divisible by t, and only at such moments the tram to appear on a crossroad under a camera. There must be a camera on the crossroad by the engine house to prevent possible terrorist attacks on the engine house head. Among all the possible plans the engine house head chooses the plan with the largest possible value of t (as he hates being distracted from his favourite TV show but he has to). If such a plan is not unique, pick the plan that requires the minimal possible number of cameras. Find such a plan." 2500

39H "Multiplication Table" implementation "Petya studies positional notations. He has already learned to add and subtract numbers in the systems of notations with different radices and has moved on to a more complicated action \xe2\x80\x94 multiplication. To multiply large numbers one has to learn the multiplication table. Unfortunately, in the second grade students learn only the multiplication table of decimals (and some students even learn it in the first grade). Help Petya make a multiplication table for numbers in the system of notations with the radix k." 1300

39G "Inverse Function" implementation "Petya wrote a programme on C++ that calculated a very interesting function f(n). Petya ran the program with a certain value of n and went to the kitchen to have some tea. The history has no records concerning how long the program had been working. By the time Petya returned, it had completed the calculations and had the result. However while Petya was drinking tea, a sly virus managed to destroy the input file so that Petya can\'t figure out for which value of n the program was run. Help Petya, carry out the inverse function!Mostly, the program consists of a function in C++ with the following simplified syntax:  function ::= int f(int n) {operatorSequence} operatorSequence ::= operator�|�operator�operatorSequence operator ::= return arithmExpr; | if (logicalExpr) return arithmExpr; logicalExpr ::= arithmExpr\xe2\x80\x89>\xe2\x80\x89arithmExpr | arithmExpr\xe2\x80\x89<\xe2\x80\x89arithmExpr | arithmExpr == arithmExpr arithmExpr ::= sum sum ::= product | sum\xe2\x80\x89+\xe2\x80\x89product | sum\xe2\x80\x89-\xe2\x80\x89product product ::= multiplier | product\xe2\x80\x89*\xe2\x80\x89multiplier | product\xe2\x80\x89/\xe2\x80\x89multiplier multiplier ::= n | number | f(arithmExpr) number ::= 0|1|2|... |32767 The whitespaces in a operatorSequence are optional.Thus, we have a function, in which body there are two kinds of operators. There is the operator ""return arithmExpr;"" that returns the value of the expression as the value of the function, and there is the conditional operator ""if (logicalExpr) return arithmExpr;"" that returns the value of the arithmetical expression when and only when the logical expression is true. Guaranteed that no other constructions of C++ language \xe2\x80\x94 cycles, assignment operators, nested conditional operators etc, and other variables except the n parameter are used in the function. All the constants are integers in the interval [0..32767].The operators are performed sequentially. After the function has returned a value other operators in the sequence are not performed. Arithmetical expressions are performed taking into consideration the standard priority of the operations. It means that first all the products that are part of the sum are calculated. During the calculation of the products the operations of multiplying and division are performed from the left to the right. Then the summands are summed, and the addition and the subtraction are also performed from the left to the right. Operations "">"" (more), ""<"" (less) and ""=="" (equals) also have standard meanings.Now you\'ve got to pay close attention! The program is compiled with the help of 15-bit Berland C++ compiler invented by a Berland company BerSoft, that\'s why arithmetical operations are performed in a non-standard way. Addition, subtraction and multiplication are performed modulo 32768 (if the result of subtraction is negative, then 32768 is added to it until the number belongs to the interval [0..32767]). Division ""/"" is a usual integer division where the remainder is omitted.Examples of arithmetical operations: Guaranteed that for all values of n from 0 to 32767 the given function is performed correctly. That means that:1. Division by 0 never occures.2. When performing a function for the value n\xe2\x80\x89=\xe2\x80\x89N recursive calls of the function f may occur only for the parameter value of 0,\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89N\xe2\x80\x89-\xe2\x80\x891. Consequently, the program never has an infinite recursion.3. As the result of the sequence of the operators, the function always returns a value.We have to mention that due to all the limitations the value returned by the function f is independent from either global variables or the order of performing the calculations of arithmetical expressions as part of the logical one, or from anything else except the value of n parameter. That\'s why the f function can be regarded as a function in its mathematical sense, i.e. as a unique correspondence between any value of n from the interval [0..32767] and a value of f(n) from the same interval.Given the value of f(n), and you should find n. If the suitable n value is not unique, you should find the maximal one (from the interval [0..32767])." 2400

39F "Pacifist frogs" implementation "Thumbelina has had an accident. She has found herself on a little island in the middle of a swamp and wants to get to the shore very much.One can get to the shore only by hills that are situated along a straight line that connects the little island with the shore. Let us assume that the hills are numbered from 1 to n and the number of a hill is equal to the distance in meters between it and the island. The distance between the n-th hill and the shore is also 1 meter.Thumbelina is too small to make such jumps. Fortunately, a family of frogs living in the swamp suggests to help her. Each frog agrees to give Thumbelina a ride but Thumbelina should choose only one frog. Each frog has a certain jump length. If Thumbelina agrees to accept help from a frog whose jump length is d, the frog will jump from the island on the hill d, then \xe2\x80\x94 on the hill 2d, then 3d and so on until they get to the shore (i.e. find itself beyond the hill n).However, there is one more problem: mosquitoes also live in the swamp. At the moment they have a siesta, and they are having a nap on some hills. If the frog jumps on a hill with a mosquito the frog will smash it. The frogs Thumbelina has met are pacifists, so they will find the death of each mosquito very much sad. Help Thumbelina choose a frog that will bring her to the shore and smash as small number of mosquitoes as possible." 1300

39E "What Has Dirichlet Got to Do with That?" dp,games "You all know the Dirichlet principle, the point of which is that if n boxes have no less than n\xe2\x80\x89+\xe2\x80\x891 items, that leads to the existence of a box in which there are at least two items.Having heard of that principle, but having not mastered the technique of logical thinking, 8 year olds Stas and Masha invented a game. There are a different boxes and b different items, and each turn a player can either add a new box or a new item. The player, after whose turn the number of ways of putting b items into a boxes becomes no less then a certain given number n, loses. All the boxes and items are considered to be different. Boxes may remain empty.Who loses if both players play optimally and Stas\'s turn is first?" 2000

39D "Cubical Planet" math "You can find anything whatsoever in our Galaxy! A cubical planet goes round an icosahedral star. Let us introduce a system of axes so that the edges of the cubical planet are parallel to the coordinate axes and two opposite vertices lay in the points (0,\xe2\x80\x890,\xe2\x80\x890) and (1,\xe2\x80\x891,\xe2\x80\x891). Two flies live on the planet. At the moment they are sitting on two different vertices of the cubical planet. Your task is to determine whether they see each other or not. The flies see each other when the vertices they occupy lie on the same face of the cube." 1100

39C "Moon Craters" dp,sortings "There are lots of theories concerning the origin of moon craters. Most scientists stick to the meteorite theory, which says that the craters were formed as a result of celestial bodies colliding with the Moon. The other version is that the craters were parts of volcanoes.An extraterrestrial intelligence research specialist professor Okulov (the namesake of the Okulov, the author of famous textbooks on programming) put forward an alternate hypothesis. Guess what kind of a hypothesis it was \xe2\x80\x93\xe2\x80\x93 sure, the one including extraterrestrial mind involvement. Now the professor is looking for proofs of his hypothesis.Professor has data from the moon robot that moves linearly in one direction along the Moon surface. The moon craters are circular in form with integer-valued radii. The moon robot records only the craters whose centers lay on his path and sends to the Earth the information on the distance from the centers of the craters to the initial point of its path and on the radii of the craters.According to the theory of professor Okulov two craters made by an extraterrestrial intelligence for the aims yet unknown either are fully enclosed one in the other or do not intersect at all. Internal or external tangency is acceptable. However the experimental data from the moon robot do not confirm this theory! Nevertheless, professor Okulov is hopeful. He perfectly understands that to create any logical theory one has to ignore some data that are wrong due to faulty measuring (or skillful disguise by the extraterrestrial intelligence that will be sooner or later found by professor Okulov!) That\xe2\x80\x99s why Okulov wants to choose among the available crater descriptions the largest set that would satisfy his theory." 2100

39B "Company Income Growth" greedy "Petya works as a PR manager for a successful Berland company BerSoft. He needs to prepare a presentation on the company income growth since 2001 (the year of its founding) till now. Petya knows that in 2001 the company income amounted to a1 billion bourles, in 2002 \xe2\x80\x94 to a2 billion, ..., and in the current (2000\xe2\x80\x89+\xe2\x80\x89n)-th year \xe2\x80\x94 an billion bourles. On the base of the information Petya decided to show in his presentation the linear progress history which is in his opinion perfect. According to a graph Petya has already made, in the first year BerSoft company income must amount to 1 billion bourles, in the second year \xe2\x80\x94 2 billion bourles etc., each following year the income increases by 1 billion bourles. Unfortunately, the real numbers are different from the perfect ones. Among the numbers ai can even occur negative ones that are a sign of the company\xe2\x80\x99s losses in some years. That is why Petya wants to ignore some data, in other words, cross some numbers ai from the sequence and leave only some subsequence that has perfect growth.Thus Petya has to choose a sequence of years y1, y2, ..., yk,so that in the year y1 the company income amounted to 1 billion bourles, in the year y2 \xe2\x80\x94 2 billion bourles etc., in accordance with the perfect growth dynamics. Help him to choose the longest such sequence." 1300

39A "C*++ Calculations" "expression parsing,greedy" "C*++ language is quite similar to C++. The similarity manifests itself in the fact that the programs written in C*++ sometimes behave unpredictably and lead to absolutely unexpected effects. For example, let\'s imagine an arithmetic expression in C*++ that looks like this (expression is the main term):  expression ::= summand | expression\xe2\x80\x89+\xe2\x80\x89summand | expression\xe2\x80\x89-\xe2\x80\x89summand  summand ::= increment | coefficient*increment  increment ::= a++ | ++a  coefficient ::= 0|1|2|...|1000 For example, ""5*a++-3*++a+a++"" is a valid expression in C*++.Thus, we have a sum consisting of several summands divided by signs ""+"" or ""-"". Every summand is an expression ""a++"" or ""++a"" multiplied by some integer coefficient. If the coefficient is omitted, it is suggested being equal to 1.The calculation of such sum in C*++ goes the following way. First all the summands are calculated one after another, then they are summed by the usual arithmetic rules. If the summand contains ""a++"", then during the calculation first the value of the ""a"" variable is multiplied by the coefficient, then value of ""a"" is increased by 1. If the summand contains ""++a"", then the actions on it are performed in the reverse order: first ""a"" is increased by 1, then \xe2\x80\x94 multiplied by the coefficient.The summands may be calculated in any order, that\'s why sometimes the result of the calculation is completely unpredictable! Your task is to find its largest possible value." 2000

38H "The Great Marathon" dp "On the Berland Dependence Day it was decided to organize a great marathon. Berland consists of n cities, some of which are linked by two-way roads. Each road has a certain length. The cities are numbered from 1 to n. It is known that one can get from any city to any other one by the roads.n runners take part in the competition, one from each city. But Berland runners are talkative by nature and that\'s why the juries took measures to avoid large crowds of marathon participants. The jury decided that every runner should start the marathon from their hometown. Before the start every sportsman will get a piece of paper containing the name of the city where the sportsman\'s finishing line is. The finish is chosen randomly for every sportsman but it can\'t coincide with the sportsman\'s starting point. Several sportsmen are allowed to finish in one and the same city. All the sportsmen start simultaneously and everyone runs the shortest route from the starting point to the finishing one. All the sportsmen run at one speed which equals to 1.After the competition a follow-up table of the results will be composed where the sportsmen will be sorted according to the nondecrease of time they spent to cover the distance. The first g sportsmen in the table will get golden medals, the next s sportsmen will get silver medals and the rest will get bronze medals. Besides, if two or more sportsmen spend the same amount of time to cover the distance, they are sorted according to the number of the city where a sportsman started to run in the ascending order. That means no two sportsmen share one and the same place.According to the rules of the competition the number of gold medals g must satisfy the inequation g1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89g\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89g2, where g1 and g2 are values formed historically. In a similar way, the number of silver medals s must satisfy the inequation s1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89s\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89s2, where s1 and s2 are also values formed historically.At present, before the start of the competition, the destination points of every sportsman are unknown. However, the press demands details and that\'s why you are given the task of counting the number of the ways to distribute the medals. Two ways to distribute the medals are considered different if at least one sportsman could have received during those distributions different kinds of medals." 2400

38G Queue "data structures" "On a cold winter evening our hero Vasya stood in a railway queue to buy a ticket for Codeforces championship final. As it usually happens, the cashier said he was going to be away for 5 minutes and left for an hour. Then Vasya, not to get bored, started to analyze such a mechanism as a queue. The findings astonished Vasya.Every man is characterized by two numbers: ai, which is the importance of his current task (the greater the number is, the more important the task is) and number ci, which is a picture of his conscience. Numbers ai form the permutation of numbers from 1 to n.Let the queue consist of n\xe2\x80\x89-\xe2\x80\x891 people at the moment. Let\'s look at the way the person who came number n behaves. First, he stands at the end of the queue and the does the following: if importance of the task ai of the man in front of him is less than an, they swap their places (it looks like this: the man number n asks the one before him: ""Erm... Excuse me please but it\'s very important for me... could you please let me move up the queue?""), then he again poses the question to the man in front of him and so on. But in case when ai is greater than an, moving up the queue stops. However, the man number n can perform the operation no more than cn times.In our task let us suppose that by the moment when the man number n joins the queue, the process of swaps between n\xe2\x80\x89-\xe2\x80\x891 will have stopped. If the swap is possible it necessarily takes place.Your task is to help Vasya model the described process and find the order in which the people will stand in queue when all the swaps stops." 2300

38F "Smart Boy" dp,games,strings "Once Petya and Vasya invented a new game and called it ""Smart Boy"". They located a certain set of words \xe2\x80\x94 the dictionary \xe2\x80\x94 for the game. It is admissible for the dictionary to contain similar words. The rules of the game are as follows: first the first player chooses any letter (a word as long as 1) from any word from the dictionary and writes it down on a piece of paper. The second player adds some other letter to this one\'s initial or final position, thus making a word as long as 2, then it\'s the first player\'s turn again, he adds a letter in the beginning or in the end thus making a word as long as 3 and so on. But the player mustn\'t break one condition: the newly created word must be a substring of a word from a dictionary. The player who can\'t add a letter to the current word without breaking the condition loses.Also if by the end of a turn a certain string s is written on paper, then the player, whose turn it just has been, gets a number of points according to the formula:where    is a sequence number of symbol c in Latin alphabet, numbered starting from 1. For example, , and .   is the number of words from the dictionary where the line s occurs as a substring at least once. Your task is to learn who will win the game and what the final score will be. Every player plays optimally and most of all tries to win, then \xe2\x80\x94 to maximize the number of his points, then \xe2\x80\x94 to minimize the number of the points of the opponent." 2100

38E "Let\'s Go Rolling!" dp,sortings "Once Petya and Vasya invented a new game and called it ""Smart Boy"". They located a certain set of words \xe2\x80\x94 the dictionary \xe2\x80\x94 for the game. It is admissible for the dictionary to contain similar words. The rules of the game are as follows: first the first player chooses any letter (a word as long as 1) from any word from the dictionary and writes it down on a piece of paper. The second player adds some other letter to this one\'s initial or final position, thus making a word as long as 2, then it\'s the first player\'s turn again, he adds a letter in the beginning or in the end thus making a word as long as 3 and so on. But the player mustn\'t break one condition: the newly created word must be a substring of a word from a dictionary. The player who can\'t add a letter to the current word without breaking the condition loses.Also if by the end of a turn a certain string s is written on paper, then the player, whose turn it just has been, gets a number of points according to the formula:where    is a sequence number of symbol c in Latin alphabet, numbered starting from 1. For example, , and .   is the number of words from the dictionary where the line s occurs as a substring at least once. Your task is to learn who will win the game and what the final score will be. Every player plays optimally and most of all tries to win, then \xe2\x80\x94 to maximize the number of his points, then \xe2\x80\x94 to minimize the number of the points of the opponent." 1800

38D "Vasya the Architect" implementation "Once Vasya played bricks. All the bricks in the set had regular cubical shape. Vasya vas a talented architect, however the tower he built kept falling apart.Let us consider the building process. Vasya takes a brick and puts it on top of the already built tower so that the sides of the brick are parallel to the sides of the bricks he has already used. Let\'s introduce a Cartesian coordinate system on the horizontal plane, where Vasya puts the first brick. Then the projection of brick number i on the plane is a square with sides parallel to the axes of coordinates with opposite corners in points (xi,\xe2\x80\x891,\xe2\x80\x89yi,\xe2\x80\x891) and (xi,\xe2\x80\x892,\xe2\x80\x89yi,\xe2\x80\x892). The bricks are cast from homogeneous plastic and the weight of a brick a\xe2\x80\x89\xc3\x97\xe2\x80\x89a\xe2\x80\x89\xc3\x97\xe2\x80\x89a is a3 grams.It is guaranteed that Vasya puts any brick except the first one on the previous one, that is the area of intersection of the upper side of the previous brick and the lower side of the next brick is always positive.We (Vasya included) live in a normal world where the laws of physical statics work. And that is why, perhaps, if we put yet another brick, the tower will collapse under its own weight. Vasya puts the cubes consecutively one on top of the other until at least one cube loses the balance and falls down. If it happens, Vasya gets upset and stops the construction. Print the number of bricks in the maximal stable tower, that is the maximal number m satisfying the condition that all the towers consisting of bricks 1, 2, ..., k for every integer k from 1 to m remain stable." 1900

38C Blinds "brute force" "The blinds are known to consist of opaque horizontal stripes that can be rotated thus regulating the amount of light flowing in the room. There are n blind stripes with the width of 1 in the factory warehouse for blind production. The problem is that all of them are spare details from different orders, that is, they may not have the same length (it is even possible for them to have different lengths)Every stripe can be cut into two or more parts. The cuttings are made perpendicularly to the side along which the length is measured. Thus the cuttings do not change the width of a stripe but each of the resulting pieces has a lesser length (the sum of which is equal to the length of the initial stripe)After all the cuttings the blinds are constructed through consecutive joining of several parts, similar in length, along sides, along which length is measured. Also, apart from the resulting pieces an initial stripe can be used as a blind if it hasn\'t been cut. It is forbidden to construct blinds in any other way.Thus, if the blinds consist of k pieces each d in length, then they are of form of a rectangle of k\xe2\x80\x89\xc3\x97\xe2\x80\x89d bourlemeters. Your task is to find for what window possessing the largest possible area the blinds can be made from the given stripes if on technical grounds it is forbidden to use pieces shorter than l bourlemeter. The window is of form of a rectangle with side lengths as positive integers." 1400

38B Chess "brute force,implementation,math" "Two chess pieces, a rook and a knight, stand on a standard chessboard 8\xe2\x80\x89\xc3\x97\xe2\x80\x898 in size. The positions in which they are situated are known. It is guaranteed that none of them beats the other one.Your task is to find the number of ways to place another knight on the board so that none of the three pieces on the board beat another one. A new piece can only be placed on an empty square." 1200

38A Army implementation "The Berland Armed Forces System consists of n ranks that are numbered using natural numbers from 1 to n, where 1 is the lowest rank and n is the highest rank.One needs exactly di years to rise from rank i to rank i\xe2\x80\x89+\xe2\x80\x891. Reaching a certain rank i having not reached all the previous i\xe2\x80\x89-\xe2\x80\x891 ranks is impossible.Vasya has just reached a new rank of a, but he dreams of holding the rank of b. Find for how many more years Vasya should serve in the army until he can finally realize his dream." 800

37E "Trial for Chief" "graphs,greedy,shortest paths" "Having unraveled the Berland Dictionary, the scientists managed to read the notes of the chroniclers of that time. For example, they learned how the chief of the ancient Berland tribe was chosen.As soon as enough pretenders was picked, the following test took place among them: the chief of the tribe took a slab divided by horizontal and vertical stripes into identical squares (the slab consisted of N lines and M columns) and painted every square black or white. Then every pretender was given a slab of the same size but painted entirely white. Within a day a pretender could paint any side-linked set of the squares of the slab some color. The set is called linked if for any two squares belonging to the set there is a path belonging the set on which any two neighboring squares share a side. The aim of each pretender is to paint his slab in the exactly the same way as the chief\xe2\x80\x99s slab is painted. The one who paints a slab like that first becomes the new chief.Scientists found the slab painted by the ancient Berland tribe chief. Help them to determine the minimal amount of days needed to find a new chief if he had to paint his slab in the given way." 2600

37D "Lesson Timetable" combinatorics,dp,math "When Petya has free from computer games time, he attends university classes. Every day the lessons on Petya\xe2\x80\x99s faculty consist of two double classes. The floor where the lessons take place is a long corridor with M classrooms numbered from 1 to M, situated along it.All the students of Petya\xe2\x80\x99s year are divided into N groups. Petya has noticed recently that these groups\xe2\x80\x99 timetable has the following peculiarity: the number of the classroom where the first lesson of a group takes place does not exceed the number of the classroom where the second lesson of this group takes place. Once Petya decided to count the number of ways in which one can make a lesson timetable for all these groups. The timetable is a set of 2N numbers: for each group the number of the rooms where the first and the second lessons take place. Unfortunately, he quickly lost the track of his calculations and decided to count only the timetables that satisfy the following conditions:1) On the first lesson in classroom i exactly Xi groups must be present.2) In classroom i no more than Yi groups may be placed.Help Petya count the number of timetables satisfying all those conditions\xd1\x8e As there can be a lot of such timetables, output modulo 109\xe2\x80\x89+\xe2\x80\x897." 2300

37C "Old Berland Language" "data structures,greedy,trees" "Berland scientists know that the Old Berland language had exactly n words. Those words had lengths of l1,\xe2\x80\x89l2,\xe2\x80\x89...,\xe2\x80\x89ln letters. Every word consisted of two letters, 0 and 1. Ancient Berland people spoke quickly and didn\xe2\x80\x99t make pauses between the words, but at the same time they could always understand each other perfectly. It was possible because no word was a prefix of another one. The prefix of a string is considered to be one of its substrings that starts from the initial symbol.Help the scientists determine whether all the words of the Old Berland language can be reconstructed and if they can, output the words themselves." 1900

37B "Computer Game" greedy,implementation "Vasya\xe2\x80\x99s elder brother Petya loves playing computer games. In one of his favourite computer games Petya reached the final level where a fight with the boss take place.While playing the game Petya found spell scrolls and now he is about to use them. Let\xe2\x80\x99s describe the way fighting goes on this level:1) The boss has two parameters: max \xe2\x80\x94 the initial amount of health and reg \xe2\x80\x94 regeneration rate per second.2) Every scroll also has two parameters: powi \xe2\x80\x94 spell power measured in percents \xe2\x80\x94 the maximal amount of health counted off the initial one, which allows to use the scroll (i.e. if the boss has more than powi percent of health the scroll cannot be used); and dmgi the damage per second inflicted upon the boss if the scroll is used. As soon as a scroll is used it disappears and another spell is cast upon the boss that inflicts dmgi of damage per second upon him until the end of the game.During the battle the actions per second are performed in the following order: first the boss gets the damage from all the spells cast upon him, then he regenerates reg of health (at the same time he can\xe2\x80\x99t have more than max of health), then the player may use another scroll (no more than one per second).The boss is considered to be defeated if at the end of a second he has nonpositive (\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x890) amount of health.Help Petya to determine whether he can win with the set of scrolls available to him and if he can, determine the minimal number of seconds he needs to do it." 1800

37A Towers sortings "Little Vasya has received a young builder\xe2\x80\x99s kit. The kit consists of several wooden bars, the lengths of all of them are known. The bars can be put one on the top of the other if their lengths are the same.Vasya wants to construct the minimal number of towers from the bars. Help Vasya to use the bars in the best way possible." 1000

36E "Two Paths" "constructive algorithms,dsu,graphs,implementation" "Once archaeologists found m mysterious papers, each of which had a pair of integers written on them. Ancient people were known to like writing down the indexes of the roads they walked along, as \xc2\xaba b\xc2\xbb or \xc2\xabb a\xc2\xbb, where a,\xe2\x80\x89b are the indexes of two different cities joint by the road . It is also known that the mysterious papers are pages of two travel journals (those days a new journal was written for every new journey).During one journey the traveler could walk along one and the same road several times in one or several directions but in that case he wrote a new entry for each time in his journal. Besides, the archaeologists think that the direction the traveler took on a road had no effect upon the entry: the entry that looks like \xc2\xaba b\xc2\xbb could refer to the road from a to b as well as to the road from b to a.The archaeologists want to put the pages in the right order and reconstruct the two travel paths but unfortunately, they are bad at programming. That\xe2\x80\x99s where you come in. Go help them!" 2600

36D "New Game with a Chess Piece" games "Petya and Vasya are inventing a new game that requires a rectangular board and one chess piece. At the beginning of the game the piece stands in the upper-left corner of the board. Two players move the piece in turns. Each turn the chess piece can be moved either one square to the right or one square down or jump k squares diagonally down and to the right. The player who can\xe2\x80\x99t move the piece loses.   The guys haven\xe2\x80\x99t yet thought what to call the game or the best size of the board for it. Your task is to write a program that can determine the outcome of the game depending on the board size." 2300

36C Bowls geometry,implementation "Once Petya was in such a good mood that he decided to help his mum with the washing-up. There were n dirty bowls in the sink. From the geometrical point of view each bowl looks like a blunted cone. We can disregard the width of the walls and bottom. Petya puts the clean bowls one on another naturally, i. e. so that their vertical axes coincide (see the picture). You will be given the order in which Petya washes the bowls. Determine the height of the construction, i.e. the distance from the bottom of the lowest bowl to the top of the highest one." 2200

36B Fractal implementation "Ever since Kalevitch, a famous Berland abstractionist, heard of fractals, he made them the main topic of his canvases. Every morning the artist takes a piece of graph paper and starts with making a model of his future canvas. He takes a square as big as n\xe2\x80\x89\xc3\x97\xe2\x80\x89n squares and paints some of them black. Then he takes a clean square piece of paper and paints the fractal using the following algorithm: Step 1. The paper is divided into n2 identical squares and some of them are painted black according to the model.Step 2. Every square that remains white is divided into n2 smaller squares and some of them are painted black according to the model.Every following step repeats step 2.  Unfortunately, this tiresome work demands too much time from the painting genius. Kalevitch has been dreaming of making the process automatic to move to making 3D or even 4D fractals." 1600

36A "Extra-terrestrial Intelligence" implementation "Recently Vasya got interested in finding extra-terrestrial intelligence. He made a simple extra-terrestrial signals\xe2\x80\x99 receiver and was keeping a record of the signals for n days in a row. Each of those n days Vasya wrote a 1 in his notebook if he had received a signal that day and a 0 if he hadn\xe2\x80\x99t. Vasya thinks that he has found extra-terrestrial intelligence if there is a system in the way the signals has been received, i.e. if all the intervals between successive signals are equal. Otherwise, Vasya thinks that the signals were sent by some stupid aliens no one cares about. Help Vasya to deduce from the information given by the receiver if he has found extra-terrestrial intelligence or not." 1300

35E Parade "data structures,sortings" "No Great Victory anniversary in Berland has ever passed without the war parade. This year is not an exception. That\xe2\x80\x99s why the preparations are on in full strength. Tanks are building a line, artillery mounts are ready to fire, soldiers are marching on the main square... And the air forces general Mr. Generalov is in trouble again. This year a lot of sky-scrapers have been built which makes it difficult for the airplanes to fly above the city. It was decided that the planes should fly strictly from south to north. Moreover, there must be no sky scraper on a plane\xe2\x80\x99s route, otherwise the anniversary will become a tragedy. The Ministry of Building gave the data on n sky scrapers (the rest of the buildings are rather small and will not be a problem to the planes). When looking at the city from south to north as a geometrical plane, the i-th building is a rectangle of height hi. Its westernmost point has the x-coordinate of li and the easternmost \xe2\x80\x94 of ri. The terrain of the area is plain so that all the buildings stand on one level. Your task as the Ministry of Defence\xe2\x80\x99s head programmer is to find an enveloping polyline using the data on the sky-scrapers. The polyline\xe2\x80\x99s properties are as follows:  If you look at the city from south to north as a plane, then any part of any building will be inside or on the boarder of the area that the polyline encloses together with the land surface.  The polyline starts and ends on the land level, i.e. at the height equal to 0.  The segments of the polyline are parallel to the coordinate axes, i.e. they can only be vertical or horizontal.  The polyline\xe2\x80\x99s vertices should have integer coordinates.  If you look at the city from south to north the polyline (together with the land surface) must enclose the minimum possible area.  The polyline must have the smallest length among all the polylines, enclosing the minimum possible area with the land.  The consecutive segments of the polyline must be perpendicular.    Picture to the second sample test (the enveloping polyline is marked on the right)." 2100

35D Animals dp,greedy "Once upon a time DravDe, an outstanding person famous for his professional achievements (as you must remember, he works in a warehouse storing Ogudar-Olok, a magical but non-alcoholic drink) came home after a hard day. That day he had to drink 9875 boxes of the drink and, having come home, he went to bed at once.DravDe dreamt about managing a successful farm. He dreamt that every day one animal came to him and asked him to let it settle there. However, DravDe, being unimaginably kind, could send the animal away and it went, rejected. There were exactly n days in DravDe\xe2\x80\x99s dream and the animal that came on the i-th day, ate exactly ci tons of food daily starting from day i. But if one day the animal could not get the food it needed, it got really sad. At the very beginning of the dream there were exactly X tons of food on the farm.DravDe woke up terrified...When he retold the dream to you, he couldn\xe2\x80\x99t remember how many animals were on the farm by the end of the n-th day any more, but he did remember that nobody got sad (as it was a happy farm) and that there was the maximum possible amount of the animals. That\xe2\x80\x99s the number he wants you to find out. It should be noticed that the animals arrived in the morning and DravDe only started to feed them in the afternoon, so that if an animal willing to join them is rejected, it can\xe2\x80\x99t eat any farm food. But if the animal does join the farm, it eats daily from that day to the n-th." 1700

35C "Fire Again" "brute force,dfs and similar,shortest paths" "After a terrifying forest fire in Berland a forest rebirth program was carried out. Due to it N rows with M trees each were planted and the rows were so neat that one could map it on a system of coordinates so that the j-th tree in the i-th row would have the coordinates of (i,\xe2\x80\x89j). However a terrible thing happened and the young forest caught fire. Now we must find the coordinates of the tree that will catch fire last to plan evacuation.The burning began in K points simultaneously, which means that initially K trees started to burn. Every minute the fire gets from the burning trees to the ones that aren\xe2\x80\x99t burning and that the distance from them to the nearest burning tree equals to 1.Find the tree that will be the last to start burning. If there are several such trees, output any." 1500

35B Warehouse implementation "Once upon a time, when the world was more beautiful, the sun shone brighter, the grass was greener and the sausages tasted better Arlandia was the most powerful country. And its capital was the place where our hero DravDe worked. He couldn\xe2\x80\x99t program or make up problems (in fact, few people saw a computer those days) but he was nevertheless happy. He worked in a warehouse where a magical but non-alcoholic drink Ogudar-Olok was kept. We won\xe2\x80\x99t describe his work in detail and take a better look at a simplified version of the warehouse.The warehouse has one set of shelving. It has n shelves, each of which is divided into m sections. The shelves are numbered from top to bottom starting from 1 and the sections of each shelf are numbered from left to right also starting from 1. Each section can contain exactly one box of the drink, and try as he might, DravDe can never put a box in a section that already has one. In the course of his work DravDe frequently notices that he has to put a box in a filled section. In that case his solution is simple. DravDe ignores that section and looks at the next one to the right. If it is empty, he puts the box there. Otherwise he keeps looking for the first empty section to the right. If no empty section is found by the end of the shelf, he looks at the shelf which is under it, then the next one, etc. Also each time he looks at a new shelf he starts from the shelf\xe2\x80\x99s beginning. If DravDe still can\xe2\x80\x99t find an empty section for the box, he immediately drinks it all up and throws the empty bottles away not to be caught.After one great party with a lot of Ogudar-Olok drunk DravDe asked you to help him. Unlike him, you can program and therefore modeling the process of counting the boxes in the warehouse will be easy work for you.The process of counting contains two types of query messages:   \xc2\xab+1 x y id\xc2\xbb (where x, y are integers, 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n, 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m, and id is a string of lower case Latin letters \xe2\x80\x94 from 1 to 10 characters long). That query means that the warehouse got a box identified as id, which should be put in the section y on the shelf x. If the section is full, use the rules described above. It is guaranteed that every moment of the process the identifiers of all the boxes in the warehouse are different. You don\xe2\x80\x99t have to answer this query.  \xc2\xab-1 id\xc2\xbb (where id is a string of lower case Latin letters \xe2\x80\x94 from 1 to 10 characters long). That query means that a box identified as id is removed from the warehouse. You have to answer this query (see output format)." 1700

35A "Shell Game" implementation "Today the \xc2\xabZ\xc2\xbb city residents enjoy a shell game competition. The residents are gathered on the main square to watch the breath-taking performance. The performer puts 3 non-transparent cups upside down in a row. Then he openly puts a small ball under one of the cups and starts to shuffle the cups around very quickly so that on the whole he makes exactly 3 shuffles. After that the spectators have exactly one attempt to guess in which cup they think the ball is and if the answer is correct they get a prize. Maybe you can try to find the ball too?" 1000

34E Collisions "brute force,implementation,math" "On a number line there are n balls. At time moment 0 for each ball the following data is known: its coordinate xi, speed vi (possibly, negative) and weight mi. The radius of the balls can be ignored.The balls collide elastically, i.e. if two balls weighing m1 and m2 and with speeds v1 and v2 collide, their new speeds will be: .Your task is to find out, where each ball will be t seconds after." 2000

34D "Road Map" "dfs and similar,graphs" "There are n cities in Berland. Each city has its index \xe2\x80\x94 an integer number from 1 to n. The capital has index r1. All the roads in Berland are two-way. The road system is such that there is exactly one path from the capital to each city, i.e. the road map looks like a tree. In Berland\'s chronicles the road map is kept in the following way: for each city i, different from the capital, there is kept number pi \xe2\x80\x94 index of the last city on the way from the capital to i.Once the king of Berland Berl XXXIV decided to move the capital from city r1 to city r2. Naturally, after this the old representation of the road map in Berland\'s chronicles became incorrect. Please, help the king find out a new representation of the road map in the way described above." 1600

34C "Page Numbers" "expression parsing,implementation,sortings,strings" "\xc2\xabBersoft\xc2\xbb company is working on a new version of its most popular text editor \xe2\x80\x94 Bord 2010. Bord, like many other text editors, should be able to print out multipage documents. A user keys a sequence of the document page numbers that he wants to print out (separates them with a comma, without spaces).Your task is to write a part of the program, responsible for \xc2\xabstandardization\xc2\xbb of this sequence. Your program gets the sequence, keyed by the user, as input. The program should output this sequence in format l1-r1,l2-r2,...,lk-rk, where ri\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89<\xe2\x80\x89li\xe2\x80\x89+\xe2\x80\x891 for all i from 1 to k\xe2\x80\x89-\xe2\x80\x891, and li\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ri. The new sequence should contain all the page numbers, keyed by the user, and nothing else. If some page number appears in the input sequence several times, its appearances, starting from the second one, should be ignored. If for some element i from the new sequence li\xe2\x80\x89=\xe2\x80\x89ri, this element should be output as li, and not as \xc2\xabli\xe2\x80\x89-\xe2\x80\x89li\xc2\xbb.For example, sequence 1,2,3,1,1,2,6,6,2 should be output as 1-3,6." 1300

34B Sale greedy,sortings "Once Bob got to a sale of old TV sets. There were n TV sets at that sale. TV set with index i costs ai bellars. Some TV sets have a negative price \xe2\x80\x94 their owners are ready to pay Bob if he buys their useless apparatus. Bob can \xc2\xabbuy\xc2\xbb any TV sets he wants. Though he\'s very strong, Bob can carry at most m TV sets, and he has no desire to go to the sale for the second time. Please, help Bob find out the maximum sum of money that he can earn." 900

34A "Reconnaissance 2" implementation "n soldiers stand in a circle. For each soldier his height ai is known. A reconnaissance unit can be made of such two neighbouring soldiers, whose heights difference is minimal, i.e. |ai\xe2\x80\x89-\xe2\x80\x89aj| is minimal. So each of them will be less noticeable with the other. Output any pair of soldiers that can form a reconnaissance unit." 800

33E Helper NA "It\'s unbelievable, but an exam period has started at the OhWord University. It\'s even more unbelievable, that Valera got all the tests before the exam period for excellent work during the term. As now he\'s free, he wants to earn money by solving problems for his groupmates. He\'s made a list of subjects that he can help with. Having spoken with n of his groupmates, Valera found out the following information about them: what subject each of them passes, time of the exam and sum of money that each person is ready to pay for Valera\'s help.Having this data, Valera\'s decided to draw up a timetable, according to which he will solve problems for his groupmates. For sure, Valera can\'t solve problems round the clock, that\'s why he\'s found for himself an optimum order of day and plans to stick to it during the whole exam period. Valera assigned time segments for sleep, breakfast, lunch and dinner. The rest of the time he can work.Obviously, Valera can help a student with some subject, only if this subject is on the list. It happened, that all the students, to whom Valera spoke, have different, but one-type problems, that\'s why Valera can solve any problem of subject listi in ti minutes.Moreover, if Valera starts working at some problem, he can break off only for sleep or meals, but he can\'t start a new problem, not having finished the current one. Having solved the problem, Valera can send it instantly to the corresponding student via the Internet.If this student\'s exam hasn\'t started yet, he can make a crib, use it to pass the exam successfully, and pay Valera the promised sum. Since Valera has little time, he asks you to write a program that finds the order of solving problems, which can bring Valera maximum profit." 2600

33D Knights "geometry,graphs,shortest paths,sortings" "Berland is facing dark times again. The army of evil lord Van de Mart is going to conquer the whole kingdom. To the council of war called by the Berland\'s king Valery the Severe came n knights. After long discussions it became clear that the kingdom has exactly n control points (if the enemy conquers at least one of these points, the war is lost) and each knight will occupy one of these points. Berland is divided into m\xe2\x80\x89+\xe2\x80\x891 regions with m fences, and the only way to get from one region to another is to climb over the fence. Each fence is a circle on a plane, no two fences have common points, and no control point is on the fence. You are given k pairs of numbers ai, bi. For each pair you have to find out: how many fences a knight from control point with index ai has to climb over to reach control point bi (in case when Van de Mart attacks control point bi first). As each knight rides a horse (it is very difficult to throw a horse over a fence), you are to find out for each pair the minimum amount of fences to climb over." 2000

33C "Wonderful Randomized Sum" greedy "Learn, learn and learn again \xe2\x80\x94 Valera has to do this every day. He is studying at mathematical school, where math is the main discipline. The mathematics teacher loves her discipline very much and tries to cultivate this love in children. That\'s why she always gives her students large and difficult homework. Despite that Valera is one of the best students, he failed to manage with the new homework. That\'s why he asks for your help. He has the following task. A sequence of n numbers is given. A prefix of a sequence is the part of the sequence (possibly empty), taken from the start of the sequence. A suffix of a sequence is the part of the sequence (possibly empty), taken from the end of the sequence. It is allowed to sequentially make two operations with the sequence. The first operation is to take some prefix of the sequence and multiply all numbers in this prefix by \xe2\x80\x89-\xe2\x80\x891. The second operation is to take some suffix and multiply all numbers in it by \xe2\x80\x89-\xe2\x80\x891. The chosen prefix and suffix may intersect. What is the maximum total sum of the sequence that can be obtained by applying the described operations?" 1800

33B "String Problem" "shortest paths" "Boy Valera likes strings. And even more he likes them, when they are identical. That\'s why in his spare time Valera plays the following game. He takes any two strings, consisting of lower case Latin letters, and tries to make them identical. According to the game rules, with each move Valera can change one arbitrary character Ai in one of the strings into arbitrary character Bi, but he has to pay for every move a particular sum of money, equal to Wi. He is allowed to make as many moves as he needs. Since Valera is a very economical boy and never wastes his money, he asked you, an experienced programmer, to help him answer the question: what minimum amount of money should Valera have to get identical strings." 1800

33A "What is for dinner?" greedy,implementation "In one little known, but very beautiful country called Waterland, lives a lovely shark Valerie. Like all the sharks, she has several rows of teeth, and feeds on crucians. One of Valerie\'s distinguishing features is that while eating one crucian she uses only one row of her teeth, the rest of the teeth are ""relaxing"".For a long time our heroine had been searching the sea for crucians, but a great misfortune happened. Her teeth started to ache, and she had to see the local dentist, lobster Ashot. As a professional, Ashot quickly relieved Valerie from her toothache. Moreover, he managed to determine the cause of Valerie\'s developing caries (for what he was later nicknamed Cap).It turned that Valerie eats too many crucians. To help Valerie avoid further reoccurrence of toothache, Ashot found for each Valerie\'s tooth its residual viability. Residual viability of a tooth is a value equal to the amount of crucians that Valerie can eat with this tooth. Every time Valerie eats a crucian, viability of all the teeth used for it will decrease by one. When the viability of at least one tooth becomes negative, the shark will have to see the dentist again. Unhappy, Valerie came back home, where a portion of crucians was waiting for her. For sure, the shark couldn\'t say no to her favourite meal, but she had no desire to go back to the dentist. That\'s why she decided to eat the maximum amount of crucians from the portion but so that the viability of no tooth becomes negative. As Valerie is not good at mathematics, she asked you to help her to find out the total amount of crucians that she can consume for dinner.We should remind you that while eating one crucian Valerie uses exactly one row of teeth and the viability of each tooth from this row decreases by one." 1200

32E Hide-and-Seek geometry,implementation "Victor and Peter are playing hide-and-seek. Peter has hidden, and Victor is to find him. In the room where they are playing, there is only one non-transparent wall and one double-sided mirror. Victor and Peter are points with coordinates (xv,\xe2\x80\x89yv) and (xp,\xe2\x80\x89yp) respectively. The wall is a segment joining points with coordinates (xw,\xe2\x80\x891,\xe2\x80\x89yw,\xe2\x80\x891) and (xw,\xe2\x80\x892,\xe2\x80\x89yw,\xe2\x80\x892), the mirror \xe2\x80\x94 a segment joining points (xm,\xe2\x80\x891,\xe2\x80\x89ym,\xe2\x80\x891) and (xm,\xe2\x80\x892,\xe2\x80\x89ym,\xe2\x80\x892).If an obstacle has a common point with a line of vision, it\'s considered, that the boys can\'t see each other with this line of vision. If the mirror has a common point with the line of vision, it\'s considered, that the boys can see each other in the mirror, i.e. reflection takes place. The reflection process is governed by laws of physics \xe2\x80\x94 the angle of incidence is equal to the angle of reflection. The incident ray is in the same half-plane as the reflected ray, relative to the mirror. I.e. to see each other Victor and Peter should be to the same side of the line, containing the mirror (see example 1). If the line of vision is parallel to the mirror, reflection doesn\'t take place, and the mirror isn\'t regarded as an obstacle (see example 4).Victor got interested if he can see Peter, while standing at the same spot. Help him solve this problem." 2400

32D Constellation implementation "A star map in Berland is a checked field n\xe2\x80\x89\xc3\x97\xe2\x80\x89m squares. In each square there is or there is not a star. The favourite constellation of all Berland\'s astronomers is the constellation of the Cross. This constellation can be formed by any 5 stars so, that for some integer x (radius of the constellation) the following is true:   the 2nd is on the same vertical line as the 1st, but x squares up  the 3rd is on the same vertical line as the 1st, but x squares down  the 4th is on the same horizontal line as the 1st, but x squares left  the 5th is on the same horizontal line as the 1st, but x squares right Such constellations can be very numerous, that\'s why they are numbered with integers from 1 on the following principle: when two constellations are compared, the one with a smaller radius gets a smaller index; if their radii are equal \xe2\x80\x94 the one, whose central star if higher than the central star of the other one; if their central stars are at the same level \xe2\x80\x94 the one, whose central star is to the left of the central star of the other one.Your task is to find the constellation with index k by the given Berland\'s star map." 1600

32C Flea math "It is known that fleas in Berland can jump only vertically and horizontally, and the length of the jump is always equal to s centimeters. A flea has found herself at the center of some cell of the checked board of the size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m centimeters (each cell is 1\xe2\x80\x89\xc3\x97\xe2\x80\x891 centimeters). She can jump as she wishes for an arbitrary number of times, she can even visit a cell more than once. The only restriction is that she cannot jump out of the board.The flea can count the amount of cells that she can reach from the starting position (x,\xe2\x80\x89y). Let\'s denote this amount by dx,\xe2\x80\x89y. Your task is to find the number of such starting positions (x,\xe2\x80\x89y), which have the maximum possible value of dx,\xe2\x80\x89y." 1700

32B Borze "expression parsing,implementation" "Ternary numeric notation is quite popular in Berland. To telegraph the ternary number the Borze alphabet is used. Digit 0 is transmitted as \xc2\xab.\xc2\xbb, 1 as \xc2\xab-.\xc2\xbb and 2 as \xc2\xab--\xc2\xbb. You are to decode the Borze code, i.e. to find out the ternary number given its representation in Borze alphabet." 800

32A Reconnaissance "brute force" "According to the regulations of Berland\'s army, a reconnaissance unit should consist of exactly two soldiers. Since these two soldiers shouldn\'t differ much, their heights can differ by at most d centimeters. Captain Bob has n soldiers in his detachment. Their heights are a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an centimeters. Some soldiers are of the same height. Bob wants to know, how many ways exist to form a reconnaissance unit of two soldiers from his detachment.Ways (1,\xe2\x80\x892) and (2,\xe2\x80\x891) should be regarded as different." 800

31E "TV Game" dp "There is a new TV game on BerTV. In this game two players get a number A consisting of 2n digits. Before each turn players determine who will make the next move. Each player should make exactly n moves. On it\'s turn i-th player takes the leftmost digit of A and appends it to his or her number Si. After that this leftmost digit is erased from A. Initially the numbers of both players (S1 and S2) are \xc2\xabempty\xc2\xbb. Leading zeroes in numbers A,\xe2\x80\x89S1,\xe2\x80\x89S2 are allowed. In the end of the game the first player gets S1 dollars, and the second gets S2 dollars.One day Homer and Marge came to play the game. They managed to know the number A beforehand. They want to find such sequence of their moves that both of them makes exactly n moves and which maximizes their total prize. Help them." 2400

31D Chocolate "dfs and similar,implementation" "Bob has a rectangular chocolate bar of the size W\xe2\x80\x89\xc3\x97\xe2\x80\x89H. He introduced a cartesian coordinate system so that the point (0,\xe2\x80\x890) corresponds to the lower-left corner of the bar, and the point (W,\xe2\x80\x89H) corresponds to the upper-right corner. Bob decided to split the bar into pieces by breaking it. Each break is a segment parallel to one of the coordinate axes, which connects the edges of the bar. More formally, each break goes along the line x\xe2\x80\x89=\xe2\x80\x89xc or y\xe2\x80\x89=\xe2\x80\x89yc, where xc and yc are integers. It should divide one part of the bar into two non-empty parts. After Bob breaks some part into two parts, he breaks the resulting parts separately and independently from each other. Also he doesn\'t move the parts of the bar. Bob made n breaks and wrote them down in his notebook in arbitrary order. At the end he got n\xe2\x80\x89+\xe2\x80\x891 parts. Now he wants to calculate their areas. Bob is lazy, so he asks you to do this task." 2000

31C Schedule implementation "At the beginning of the new semester there is new schedule in the Berland State University. According to this schedule, n groups have lessons at the room 31. For each group the starting time of the lesson and the finishing time of the lesson are known. It has turned out that it is impossible to hold all lessons, because for some groups periods of their lessons intersect. If at some moment of time one groups finishes it\'s lesson, and the other group starts the lesson, their lessons don\'t intersect.The dean wants to cancel the lesson in one group so that no two time periods of lessons of the remaining groups intersect. You are to find all ways to do that." 1700

31B "Sysadmin Bob" greedy,implementation,strings "Email address in Berland is a string of the form A@B, where A and B are arbitrary strings consisting of small Latin letters. Bob is a system administrator in \xc2\xabBersoft\xc2\xbb company. He keeps a list of email addresses of the company\'s staff. This list is as a large string, where all addresses are written in arbitrary order, separated by commas. The same address can be written more than once.Suddenly, because of unknown reasons, all commas in Bob\'s list disappeared. Now Bob has a string, where all addresses are written one after another without any separators, and there is impossible to determine, where the boundaries between addresses are. Unfortunately, on the same day his chief asked him to bring the initial list of addresses. Now Bob wants to disjoin addresses in some valid way. Help him to do that." 1500

31A "Worms Evolution" implementation "Professor Vasechkin is studying evolution of worms. Recently he put forward hypotheses that all worms evolve by division. There are n forms of worms. Worms of these forms have lengths a1, a2, ..., an. To prove his theory, professor needs to find 3 different forms that the length of the first form is equal to sum of lengths of the other two forms. Help him to do this." 1200

30E "Tricky and Clever Password" "binary search,constructive algorithms,data structures,greedy,hashing,strings" "In his very young years the hero of our story, king Copa, decided that his private data was hidden not enough securely, what is unacceptable for the king. That\'s why he invented tricky and clever password (later he learned that his password is a palindrome of odd length), and coded all his data using it. Copa is afraid to forget his password, so he decided to write it on a piece of paper. He is aware that it is insecure to keep password in such way, so he decided to cipher it the following way: he cut x characters from the start of his password and from the end of it (x can be 0, and 2x is strictly less than the password length). He obtained 3 parts of the password. Let\'s call it prefix, middle and suffix correspondingly, both prefix and suffix having equal length and middle always having odd length. From these parts he made a string A\xe2\x80\x89+\xe2\x80\x89prefix\xe2\x80\x89+\xe2\x80\x89B\xe2\x80\x89+\xe2\x80\x89middle\xe2\x80\x89+\xe2\x80\x89C\xe2\x80\x89+\xe2\x80\x89suffix, where A, B and C are some (possibly empty) strings invented by Copa, and \xc2\xab\xe2\x80\x89+\xe2\x80\x89\xc2\xbb means concatenation.Many years have passed, and just yesterday the king Copa found the piece of paper where his ciphered password was written. The password, as well as the strings A, B and C, was completely forgotten by Copa, so he asks you to find a password of maximum possible length, which could be invented, ciphered and written by Copa." 2800

30D "King\'s Problem?" geometry,greedy "In his very young years the hero of our story, king Copa, decided that his private data was hidden not enough securely, what is unacceptable for the king. That\'s why he invented tricky and clever password (later he learned that his password is a palindrome of odd length), and coded all his data using it. Copa is afraid to forget his password, so he decided to write it on a piece of paper. He is aware that it is insecure to keep password in such way, so he decided to cipher it the following way: he cut x characters from the start of his password and from the end of it (x can be 0, and 2x is strictly less than the password length). He obtained 3 parts of the password. Let\'s call it prefix, middle and suffix correspondingly, both prefix and suffix having equal length and middle always having odd length. From these parts he made a string A\xe2\x80\x89+\xe2\x80\x89prefix\xe2\x80\x89+\xe2\x80\x89B\xe2\x80\x89+\xe2\x80\x89middle\xe2\x80\x89+\xe2\x80\x89C\xe2\x80\x89+\xe2\x80\x89suffix, where A, B and C are some (possibly empty) strings invented by Copa, and \xc2\xab\xe2\x80\x89+\xe2\x80\x89\xc2\xbb means concatenation.Many years have passed, and just yesterday the king Copa found the piece of paper where his ciphered password was written. The password, as well as the strings A, B and C, was completely forgotten by Copa, so he asks you to find a password of maximum possible length, which could be invented, ciphered and written by Copa." 2600

30C "Shooting Gallery" dp,probabilities "One warm and sunny day king Copa decided to visit the shooting gallery, located at the Central Park, and try to win the main prize \xe2\x80\x94 big pink plush panda. The king is not good at shooting, so he invited you to help him.The shooting gallery is an infinite vertical plane with Cartesian coordinate system on it. The targets are points on this plane. Each target is described by it\'s coordinates xi, and yi, by the time of it\'s appearance ti and by the number pi, which gives the probability that Copa hits this target if he aims at it.A target appears and disappears instantly, so Copa can hit the target only if at the moment ti his gun sight aimed at (xi,\xe2\x80\x89yi). Speed of movement of the gun sight on the plane is equal to 1. Copa knows all the information about the targets beforehand (remember, he is a king!). He wants to play in the optimal way, which maximizes the expected value of the amount of hit targets. He can aim at any target at the moment 0." 1800

30B "Codeforces World Finals" implementation "The king Copa often has been reported about the Codeforces site, which is rapidly getting more and more popular among the brightest minds of the humanity, who are using it for training and competing. Recently Copa understood that to conquer the world he needs to organize the world Codeforces tournament. He hopes that after it the brightest minds will become his subordinates, and the toughest part of conquering the world will be completed.The final round of the Codeforces World Finals 20YY is scheduled for DD.MM.YY, where DD is the day of the round, MM is the month and YY are the last two digits of the year. Bob is lucky to be the first finalist form Berland. But there is one problem: according to the rules of the competition, all participants must be at least 18 years old at the moment of the finals. Bob was born on BD.BM.BY. This date is recorded in his passport, the copy of which he has already mailed to the organizers. But Bob learned that in different countries the way, in which the dates are written, differs. For example, in the US the month is written first, then the day and finally the year. Bob wonders if it is possible to rearrange the numbers in his date of birth so that he will be at least 18 years old on the day DD.MM.YY. He can always tell that in his motherland dates are written differently. Help him.According to another strange rule, eligible participant must be born in the same century as the date of the finals. If the day of the finals is participant\'s 18-th birthday, he is allowed to participate. As we are considering only the years from 2001 to 2099 for the year of the finals, use the following rule: the year is leap if it\'s number is divisible by four." 1700

30A Accounting "brute force,math" "A long time ago in some far country lived king Copa. After the recent king\'s reform, he got so large powers that started to keep the books by himself.The total income A of his kingdom during 0-th year is known, as well as the total income B during n-th year (these numbers can be negative \xe2\x80\x94 it means that there was a loss in the correspondent year). King wants to show financial stability. To do this, he needs to find common coefficient X \xe2\x80\x94 the coefficient of income growth during one year. This coefficient should satisfy the equation:A\xc2\xb7Xn\xe2\x80\x89=\xe2\x80\x89B.Surely, the king is not going to do this job by himself, and demands you to find such number X.It is necessary to point out that the fractional numbers are not used in kingdom\'s economy. That\'s why all input numbers as well as coefficient X must be integers. The number X may be zero or negative." 1400

29E Quarrel "graphs,shortest paths" "Friends Alex and Bob live in Bertown. In this town there are n crossroads, some of them are connected by bidirectional roads of equal length. Bob lives in a house at the crossroads number 1, Alex \xe2\x80\x94 in a house at the crossroads number n.One day Alex and Bob had a big quarrel, and they refused to see each other. It occurred that today Bob needs to get from his house to the crossroads n and Alex needs to get from his house to the crossroads 1. And they don\'t want to meet at any of the crossroads, but they can meet in the middle of the street, when passing it in opposite directions. Alex and Bob asked you, as their mutual friend, to help them with this difficult task.Find for Alex and Bob such routes with equal number of streets that the guys can follow these routes and never appear at the same crossroads at the same time. They are allowed to meet in the middle of the street when moving toward each other (see Sample 1). Among all possible routes, select such that the number of streets in it is the least possible. Until both guys reach their destinations, none of them can stay without moving. The guys are moving simultaneously with equal speeds, i.e. it is possible that when one of them reaches some of the crossroads, the other one leaves it. For example, Alex can move from crossroad 1 to crossroad 2, while Bob moves from crossroad 2 to crossroad 3.If the required routes don\'t exist, your program should output -1." 2400

29D "Ant on the Tree" "constructive algorithms,dfs and similar,trees" "Connected undirected graph without cycles is called a tree. Trees is a class of graphs which is interesting not only for people, but for ants too.An ant stands at the root of some tree. He sees that there are n vertexes in the tree, and they are connected by n\xe2\x80\x89-\xe2\x80\x891 edges so that there is a path between any pair of vertexes. A leaf is a distinct from root vertex, which is connected with exactly one other vertex.The ant wants to visit every vertex in the tree and return to the root, passing every edge twice. In addition, he wants to visit the leaves in a specific order. You are to find some possible route of the ant." 2000

29C "Mail Stamps" "data structures,dfs and similar,graphs,implementation" "One day Bob got a letter in an envelope. Bob knows that when Berland\'s post officers send a letter directly from city \xc2\xabA\xc2\xbb to city \xc2\xabB\xc2\xbb, they stamp it with \xc2\xabA B\xc2\xbb, or \xc2\xabB A\xc2\xbb. Unfortunately, often it is impossible to send a letter directly from the city of the sender to the city of the receiver, that\'s why the letter is sent via some intermediate cities. Post officers never send a letter in such a way that the route of this letter contains some city more than once. Bob is sure that the post officers stamp the letters accurately.There are n stamps on the envelope of Bob\'s letter. He understands that the possible routes of this letter are only two. But the stamps are numerous, and Bob can\'t determine himself none of these routes. That\'s why he asks you to help him. Find one of the possible routes of the letter." 1700

29B "Traffic Lights" implementation "A car moves from point A to point B at speed v meters per second. The action takes place on the X-axis. At the distance d meters from A there are traffic lights. Starting from time 0, for the first g seconds the green light is on, then for the following r seconds the red light is on, then again the green light is on for the g seconds, and so on.The car can be instantly accelerated from 0 to v and vice versa, can instantly slow down from the v to 0. Consider that it passes the traffic lights at the green light instantly. If the car approaches the traffic lights at the moment when the red light has just turned on, it doesn\'t have time to pass it. But if it approaches the traffic lights at the moment when the green light has just turned on, it can move. The car leaves point A at the time 0.What is the minimum time for the car to get from point A to point B without breaking the traffic rules?" 1500

29A "Spit Problem" "brute force" "In a Berland\'s zoo there is an enclosure with camels. It is known that camels like to spit. Bob watched these interesting animals for the whole day and registered in his notepad where each animal spitted. Now he wants to know if in the zoo there are two camels, which spitted at each other. Help him to solve this task.The trajectory of a camel\'s spit is an arc, i.e. if the camel in position x spits d meters right, he can hit only the camel in position x\xe2\x80\x89+\xe2\x80\x89d, if such a camel exists." 1000

28E "DravDe saves the world" geometry,math "How horrible! The empire of galactic chickens tries to conquer a beautiful city ""Z"", they have built a huge incubator that produces millions of chicken soldiers a day, and fenced it around. The huge incubator looks like a polygon on the plane Oxy with n vertices. Naturally, DravDe can\'t keep still, he wants to destroy the chicken empire. For sure, he will start with the incubator.DravDe is strictly outside the incubator\'s territory in point A(xa,\xe2\x80\x89ya), and wants to get inside and kill all the chickens working there. But it takes a lot of doing! The problem is that recently DravDe went roller skating and has broken both his legs. He will get to the incubator\'s territory in his jet airplane LEVAP-41.LEVAP-41 flies at speed V(xv,\xe2\x80\x89yv,\xe2\x80\x89zv). DravDe can get on the plane in point A, fly for some time, and then air drop himself. DravDe is very heavy, that\'s why he falls vertically at speed Fdown, but in each point of his free fall DravDe can open his parachute, and from that moment he starts to fall at the wind speed U(xu,\xe2\x80\x89yu,\xe2\x80\x89zu) until he lands. Unfortunately, DravDe isn\'t good at mathematics. Would you help poor world\'s saviour find such an air dropping plan, that allows him to land on the incubator\'s territory? If the answer is not unique, DravDe wants to find the plan with the minimum time of his flight on the plane. If the answers are still multiple, he wants to find the one with the minimum time of his free fall before opening his parachute" 2800

28D "Don\'t fear, DravDe is kind" "binary search,data structures,dp,hashing" "How horrible! The empire of galactic chickens tries to conquer a beautiful city ""Z"", they have built a huge incubator that produces millions of chicken soldiers a day, and fenced it around. The huge incubator looks like a polygon on the plane Oxy with n vertices. Naturally, DravDe can\'t keep still, he wants to destroy the chicken empire. For sure, he will start with the incubator.DravDe is strictly outside the incubator\'s territory in point A(xa,\xe2\x80\x89ya), and wants to get inside and kill all the chickens working there. But it takes a lot of doing! The problem is that recently DravDe went roller skating and has broken both his legs. He will get to the incubator\'s territory in his jet airplane LEVAP-41.LEVAP-41 flies at speed V(xv,\xe2\x80\x89yv,\xe2\x80\x89zv). DravDe can get on the plane in point A, fly for some time, and then air drop himself. DravDe is very heavy, that\'s why he falls vertically at speed Fdown, but in each point of his free fall DravDe can open his parachute, and from that moment he starts to fall at the wind speed U(xu,\xe2\x80\x89yu,\xe2\x80\x89zu) until he lands. Unfortunately, DravDe isn\'t good at mathematics. Would you help poor world\'s saviour find such an air dropping plan, that allows him to land on the incubator\'s territory? If the answer is not unique, DravDe wants to find the plan with the minimum time of his flight on the plane. If the answers are still multiple, he wants to find the one with the minimum time of his free fall before opening his parachute" 2400

28C "Bath Queue" combinatorics,dp,probabilities "There are n students living in the campus. Every morning all students wake up at the same time and go to wash. There are m rooms with wash basins. The i-th of these rooms contains ai wash basins. Every student independently select one the rooms with equal probability and goes to it. After all students selected their rooms, students in each room divide into queues by the number of wash basins so that the size of the largest queue is the least possible. Calculate the expected value of the size of the largest queue among all rooms." 2200

28B pSort "dfs and similar,dsu,graphs" "One day n cells of some array decided to play the following game. Initially each cell contains a number which is equal to it\'s ordinal number (starting from 1). Also each cell determined it\'s favourite number. On it\'s move i-th cell can exchange it\'s value with the value of some other j-th cell, if |i\xe2\x80\x89-\xe2\x80\x89j|\xe2\x80\x89=\xe2\x80\x89di, where di is a favourite number of i-th cell. Cells make moves in any order, the number of moves is unlimited.The favourite number of each cell will be given to you. You will also be given a permutation of numbers from 1 to n. You are to determine whether the game could move to this state." 1600

28A "Bender Problem" implementation "Robot Bender decided to make Fray a birthday present. He drove n nails and numbered them from 1 to n in some order. Bender decided to make a picture using metal rods. The picture is a closed polyline, which vertices should be nails (in the given order). The segments of the polyline should be parallel to the coordinate axes. Polyline is allowed to have self-intersections. Bender can take a rod and fold it exactly once in any place to form an angle of 90 degrees. Then he can attach the place of the fold to some unoccupied nail and attach two ends of this rod to adjacent nails. A nail is considered unoccupied if there is no rod attached to it (neither by it\'s end nor the by the fold place). No rod could be used twice. It is not required to use all the rods.Help Bender to solve this difficult task." 1600

27E "Number With The Given Amount Of Divisors" "brute force,dp,number theory" "Given the number n, find the smallest positive integer which has exactly n divisors. It is guaranteed that for the given n the answer will not exceed 1018." 2000

27D "Ring Road 2" "2-sat,dfs and similar,dsu,graphs" "It is well known that Berland has n cities, which form the Silver ring \xe2\x80\x94 cities i and i\xe2\x80\x89+\xe2\x80\x891 (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89n) are connected by a road, as well as the cities n and 1. The goverment have decided to build m new roads. The list of the roads to build was prepared. Each road will connect two cities. Each road should be a curve which lies inside or outside the ring. New roads will have no common points with the ring (except the endpoints of the road).Now the designers of the constructing plan wonder if it is possible to build the roads in such a way that no two roads intersect (note that the roads may intersect at their endpoints). If it is possible to do, which roads should be inside the ring, and which should be outside?" 2200

27C "Unordered Subsequence" "constructive algorithms,greedy" "The sequence is called ordered if it is non-decreasing or non-increasing. For example, sequnces [3, 1, 1, 0] and [1, 2, 3, 100] are ordered, but the sequence [1, 3, 3, 1] is not. You are given a sequence of numbers. You are to find it\'s shortest subsequence which is not ordered.A subsequence is a sequence that can be derived from the given sequence by deleting zero or more elements without changing the order of the remaining elements." 1900

27B Tournament "bitmasks,brute force,dfs and similar,greedy" "The tournament \xc2\xabSleepyhead-2010\xc2\xbb in the rapid falling asleep has just finished in Berland. n best participants from the country have participated in it. The tournament consists of games, each of them is a match between two participants. n\xc2\xb7(n\xe2\x80\x89-\xe2\x80\x891)\xe2\x80\x89/\xe2\x80\x892 games were played during the tournament, and each participant had a match with each other participant. The rules of the game are quite simple \xe2\x80\x94 the participant who falls asleep first wins. The secretary made a record of each game in the form \xc2\xabxi yi\xc2\xbb, where xi and yi are the numbers of participants. The first number in each pair is a winner (i.e. xi is a winner and yi is a loser). There is no draws.Recently researches form the \xc2\xabInstitute Of Sleep\xc2\xbb have found that every person is characterized by a value pj \xe2\x80\x94 the speed of falling asleep. The person who has lower speed wins. Every person has its own value pj, constant during the life. It is known that all participants of the tournament have distinct speeds of falling asleep. Also it was found that the secretary made records about all the games except one. You are to find the result of the missing game." 1300

27A "Next Test" implementation,sortings "\xc2\xabPolygon\xc2\xbb is a system which allows to create programming tasks in a simple and professional way. When you add a test to the problem, the corresponding form asks you for the test index. As in most cases it is clear which index the next test will have, the system suggests the default value of the index. It is calculated as the smallest positive integer which is not used as an index for some previously added test.You are to implement this feature. Create a program which determines the default index of the next test, given the indexes of the previously added tests." 1200

26E Multithreading "constructive algorithms" "You are given the following concurrent program. There are N processes and the i-th process has the following pseudocode: repeat ni times    yi := y    y := yi\xe2\x80\x89+\xe2\x80\x891end repeatHere y is a shared variable. Everything else is local for the process. All actions on a given row are atomic, i.e. when the process starts executing a row it is never interrupted. Beyond that all interleavings are possible, i.e. every process that has yet work to do can be granted the rights to execute its next row. In the beginning y\xe2\x80\x89=\xe2\x80\x890. You will be given an integer W and ni, for i\xe2\x80\x89=\xe2\x80\x891,\xe2\x80\x89... ,\xe2\x80\x89N. Determine if it is possible that after all processes terminate, y\xe2\x80\x89=\xe2\x80\x89W, and if it is possible output an arbitrary schedule that will produce this final value." 2400

26D Tickets combinatorics,math,probabilities "As a big fan of Formula One, Charlie is really happy with the fact that he has to organize ticket sells for the next Grand Prix race in his own city. Unfortunately, the finacial crisis is striking everywhere and all the banknotes left in his country are valued either 10 euros or 20 euros. The price of all tickets for the race is 10 euros, so whenever someone comes to the ticket store only with 20 euro banknote Charlie must have a 10 euro banknote to give them change. Charlie realize that with the huge deficit of banknotes this could be a problem. Charlie has some priceless information but couldn\'t make use of it, so he needs your help. Exactly n\xe2\x80\x89+\xe2\x80\x89m people will come to buy a ticket. n of them will have only a single 10 euro banknote, and m of them will have only a single 20 euro banknote. Currently Charlie has k 10 euro banknotes, which he can use for change if needed. All n\xe2\x80\x89+\xe2\x80\x89m people will come to the ticket store in random order, all orders are equiprobable. Return the probability that the ticket selling process will run smoothly, i.e. Charlie will have change for every person with 20 euro banknote." 2400

26C Parquet "combinatorics,constructive algorithms,greedy,implementation" "Once Bob decided to lay a parquet floor in his living room. The living room is of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m metres. Bob had planks of three types: a planks 1\xe2\x80\x89\xc3\x97\xe2\x80\x892 meters, b planks 2\xe2\x80\x89\xc3\x97\xe2\x80\x891 meters, and c planks 2\xe2\x80\x89\xc3\x97\xe2\x80\x892 meters. Help Bob find out, if it is possible to parquet the living room with such a set of planks, and if it is possible, find one of the possible ways to do so. Bob doesn\'t have to use all the planks." 2000

26B "Regular Bracket Sequence" greedy "A bracket sequence is called regular if it is possible to obtain correct arithmetic expression by inserting characters \xc2\xab+\xc2\xbb and \xc2\xab1\xc2\xbb into this sequence. For example, sequences \xc2\xab(())()\xc2\xbb, \xc2\xab()\xc2\xbb and \xc2\xab(()(()))\xc2\xbb are regular, while \xc2\xab)(\xc2\xbb, \xc2\xab(()\xc2\xbb and \xc2\xab(()))(\xc2\xbb are not.One day Johnny got bracket sequence. He decided to remove some of the brackets from it in order to obtain a regular bracket sequence. What is the maximum length of a regular bracket sequence which can be obtained?" 1400

26A "Almost Prime" "number theory" "A number is called almost prime if it has exactly two distinct prime divisors. For example, numbers 6, 18, 24 are almost prime, while 4, 8, 9, 42 are not. Find the amount of almost prime numbers which are between 1 and n, inclusive." 900

25E Test hashing,strings "Sometimes it is hard to prepare tests for programming problems. Now Bob is preparing tests to new problem about strings \xe2\x80\x94 input data to his problem is one string. Bob has 3 wrong solutions to this problem. The first gives the wrong answer if the input data contains the substring s1, the second enters an infinite loop if the input data contains the substring s2, and the third requires too much memory if the input data contains the substring s3. Bob wants these solutions to fail single test. What is the minimal length of test, which couldn\'t be passed by all three Bob\'s solutions?" 2200

25D "Roads not only in Berland" dsu,graphs,trees "Berland Government decided to improve relations with neighboring countries. First of all, it was decided to build new roads so that from each city of Berland and neighboring countries it became possible to reach all the others. There are n cities in Berland and neighboring countries in total and exactly n\xe2\x80\x89-\xe2\x80\x891 two-way roads. Because of the recent financial crisis, the Berland Government is strongly pressed for money, so to build a new road it has to close some of the existing ones. Every day it is possible to close one existing road and immediately build a new one. Your task is to determine how many days would be needed to rebuild roads so that from each city it became possible to reach all the others, and to draw a plan of closure of old roads and building of new ones." 1900

25C "Roads in Berland" "graphs,shortest paths" "There are n cities numbered from 1 to n in Berland. Some of them are connected by two-way roads. Each road has its own length \xe2\x80\x94 an integer number from 1 to 1000. It is known that from each city it is possible to get to any other city by existing roads. Also for each pair of cities it is known the shortest distance between them. Berland Government plans to build k new roads. For each of the planned road it is known its length, and what cities it will connect. To control the correctness of the construction of new roads, after the opening of another road Berland government wants to check the sum of the shortest distances between all pairs of cities. Help them \xe2\x80\x94 for a given matrix of shortest distances on the old roads and plans of all new roads, find out how the sum of the shortest distances between all pairs of cities changes after construction of each road." 1900

25B "Phone numbers" implementation "Phone number in Berland is a sequence of n digits. Often, to make it easier to memorize the number, it is divided into groups of two or three digits. For example, the phone number 1198733 is easier to remember as 11-987-33. Your task is to find for a given phone number any of its divisions into groups of two or three digits." 1100

25A "IQ test" "brute force" "Bob is preparing to pass IQ test. The most frequent task in this test is to find out which one of the given n numbers differs from the others. Bob observed that one number usually differs from the others in evenness. Help Bob \xe2\x80\x94 to check his answers, he needs a program that among the given n numbers finds one that is different in evenness." 1300

24E "Berland collider" "binary search" "Recently the construction of Berland collider has been completed. Collider can be represented as a long narrow tunnel that contains n particles. We associate with collider 1-dimensional coordinate system, going from left to right. For each particle we know its coordinate and velocity at the moment of start of the collider. The velocities of the particles don\'t change after the launch of the collider. Berland scientists think that the big bang will happen at the first collision of particles, whose velocities differs in directions. Help them to determine how much time elapses after the launch of the collider before the big bang happens." 2300

24D "Broken robot" dp,math,probabilities "You received as a gift a very clever robot walking on a rectangular board. Unfortunately, you understood that it is broken and behaves rather strangely (randomly). The board consists of N rows and M columns of cells. The robot is initially at some cell on the i-th row and the j-th column. Then at every step the robot could go to some another cell. The aim is to go to the bottommost (N-th) row. The robot can stay at it\'s current cell, move to the left, move to the right, or move to the cell below the current. If the robot is in the leftmost column it cannot move to the left, and if it is in the rightmost column it cannot move to the right. At every step all possible moves are equally probable. Return the expected number of step to reach the bottommost row." 2400

24C "Sequence of points" geometry,implementation,math "You are given the following points with integer coordinates on the plane: M0,\xe2\x80\x89A0,\xe2\x80\x89A1,\xe2\x80\x89...,\xe2\x80\x89An\xe2\x80\x89-\xe2\x80\x891, where n is odd number. Now we define the following infinite sequence of points Mi: Mi is symmetric to Mi\xe2\x80\x89-\xe2\x80\x891 according  (for every natural number i). Here point B is symmetric to A according M, if M is the center of the line segment AB. Given index j find the point Mj." 1800

24B "F1 Champions" implementation "Formula One championship consists of series of races called Grand Prix. After every race drivers receive points according to their final position. Only the top 10 drivers receive points in the following order 25, 18, 15, 12, 10, 8, 6, 4, 2, 1. At the conclusion of the championship the driver with most points is the champion. If there is a tie, champion is the one with most wins (i.e. first places). If a tie still exists, it is chosen the one with most second places, and so on, until there are no more place to use for compare. Last year another scoring system was proposed but rejected. In it the champion is the one with most wins. If there is tie, champion is the one with most points. If a tie still exists it is proceeded the same way as in the original scoring system, that is comparing number of second, third, forth, and so on, places.You are given the result of all races during the season and you are to determine the champion according to both scoring systems. It is guaranteed, that both systems will produce unique champion." 1500

24A "Ring road" graphs "Nowadays the one-way traffic is introduced all over the world in order to improve driving safety and reduce traffic jams. The government of Berland decided to keep up with new trends. Formerly all n cities of Berland were connected by n two-way roads in the ring, i. e. each city was connected directly to exactly two other cities, and from each city it was possible to get to any other city. Government of Berland introduced one-way traffic on all n roads, but it soon became clear that it\'s impossible to get from some of the cities to some others. Now for each road is known in which direction the traffic is directed at it, and the cost of redirecting the traffic. What is the smallest amount of money the government should spend on the redirecting of roads so that from every city you can get to any other?" 1400

23E Tree dp "Recently Bob invented a new game with a tree (we should remind you, that a tree is a connected graph without cycles): he deletes any (possibly, zero) amount of edges of the tree, and counts the product of sizes of the connected components left after the deletion. Your task is to find out the maximum number that Bob can get in his new game for a given tree." 2500

23D Tetragon geometry,math "You\'re given the centers of three equal sides of a strictly convex tetragon. Your task is to restore the initial tetragon." 2600

23C "Oranges and Apples" "constructive algorithms,sortings" "In 2N\xe2\x80\x89-\xe2\x80\x891 boxes there are apples and oranges. Your task is to choose N boxes so, that they will contain not less than half of all the apples and not less than half of all the oranges." 2500

23B Party "constructive algorithms,graphs,math" "n people came to a party. Then those, who had no friends among people at the party, left. Then those, who had exactly 1 friend among those who stayed, left as well. Then those, who had exactly 2,\xe2\x80\x893,\xe2\x80\x89...,\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x891 friends among those who stayed by the moment of their leaving, did the same.What is the maximum amount of people that could stay at the party in the end?" 1600

23A "You\'re Given a String..." "brute force,greedy" "n people came to a party. Then those, who had no friends among people at the party, left. Then those, who had exactly 1 friend among those who stayed, left as well. Then those, who had exactly 2,\xe2\x80\x893,\xe2\x80\x89...,\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x891 friends among those who stayed by the moment of their leaving, did the same.What is the maximum amount of people that could stay at the party in the end?" 1200

22E Scheme "dfs and similar,graphs,trees" "To learn as soon as possible the latest news about their favourite fundamentally new operating system, BolgenOS community from Nizhni Tagil decided to develop a scheme. According to this scheme a community member, who is the first to learn the news, calls some other member, the latter, in his turn, calls some third member, and so on; i.e. a person with index i got a person with index fi, to whom he has to call, if he learns the news. With time BolgenOS community members understood that their scheme doesn\'t work sometimes \xe2\x80\x94 there were cases when some members didn\'t learn the news at all. Now they want to supplement the scheme: they add into the scheme some instructions of type (xi,\xe2\x80\x89yi), which mean that person xi has to call person yi as well. What is the minimum amount of instructions that they need to add so, that at the end everyone learns the news, no matter who is the first to learn it?" 2300

22D Segments greedy,sortings "You are given n segments on the Ox-axis. You can drive a nail in any integer point on the Ox-axis line nail so, that all segments containing this point, are considered nailed down. If the nail passes through endpoint of some segment, this segment is considered to be nailed too. What is the smallest number of nails needed to nail all the segments down?" 1900

22C "System Administrator" graphs "Bob got a job as a system administrator in X corporation. His first task was to connect n servers with the help of m two-way direct connection so that it becomes possible to transmit data from one server to any other server via these connections. Each direct connection has to link two different servers, each pair of servers should have at most one direct connection. Y corporation, a business rival of X corporation, made Bob an offer that he couldn\'t refuse: Bob was asked to connect the servers in such a way, that when server with index v fails, the transmission of data between some other two servers becomes impossible, i.e. the system stops being connected. Help Bob connect the servers." 1700

22B "Bargaining Table" "brute force,dp" "Bob wants to put a new bargaining table in his office. To do so he measured the office room thoroughly and drew its plan: Bob\'s office room is a rectangular room n\xe2\x80\x89\xc3\x97\xe2\x80\x89m meters. Each square meter of the room is either occupied by some furniture, or free. A bargaining table is rectangular, and should be placed so, that its sides are parallel to the office walls. Bob doesn\'t want to change or rearrange anything, that\'s why all the squares that will be occupied by the table should be initially free. Bob wants the new table to sit as many people as possible, thus its perimeter should be maximal. Help Bob find out the maximum possible perimeter of a bargaining table for his office." 1500

22A "Second Order Statistics" "brute force" "Once Bob needed to find the second order statistics of a sequence of integer numbers. Lets choose each number from the sequence exactly once and sort them. The value on the second position is the second order statistics of the given sequence. In other words it is the smallest element strictly greater than the minimum. Help Bob solve this problem." 800

21D "Traveling Graph" "bitmasks,graph matchings,graphs" "You are given undirected weighted graph. Find the length of the shortest cycle which starts from the vertex 1 and passes throught all the edges at least once. Graph may contain multiply edges between a pair of vertices and loops (edges from the vertex to itself)." 2400

21C "Stripe 2" "binary search,dp,sortings" "Once Bob took a paper stripe of n squares (the height of the stripe is 1 square). In each square he wrote an integer number, possibly negative. He became interested in how many ways exist to cut this stripe into three pieces so that the sum of numbers from each piece is equal to the sum of numbers from any other piece, and each piece contains positive integer amount of squares. Would you help Bob solve this problem?" 2000

21B Intersection implementation,math "You are given two set of points. The first set is determined by the equation A1x\xe2\x80\x89+\xe2\x80\x89B1y\xe2\x80\x89+\xe2\x80\x89C1\xe2\x80\x89=\xe2\x80\x890, and the second one is determined by the equation A2x\xe2\x80\x89+\xe2\x80\x89B2y\xe2\x80\x89+\xe2\x80\x89C2\xe2\x80\x89=\xe2\x80\x890.Write the program which finds the number of points in the intersection of two given sets." 2000

21A "Jabber ID" implementation,strings "Jabber ID on the national Berland service \xc2\xabBabber\xc2\xbb has a form <username>@<hostname>[/resource], where   <username> \xe2\x80\x94 is a sequence of Latin letters (lowercase or uppercase), digits or underscores characters \xc2\xab_\xc2\xbb, the length of <username> is between 1 and 16, inclusive.  <hostname> \xe2\x80\x94 is a sequence of word separated by periods (characters \xc2\xab.\xc2\xbb), where each word should contain only characters allowed for <username>, the length of each word is between 1 and 16, inclusive. The length of <hostname> is between 1 and 32, inclusive.  <resource> \xe2\x80\x94 is a sequence of Latin letters (lowercase or uppercase), digits or underscores characters \xc2\xab_\xc2\xbb, the length of <resource> is between 1 and 16, inclusive. The content of square brackets is optional \xe2\x80\x94 it can be present or can be absent.There are the samples of correct Jabber IDs: mike@codeforces.com, 007@en.codeforces.com/contest.Your task is to write program which checks if given string is a correct Jabber ID." 1900

20C Dijkstra? "graphs,shortest paths" "You are given a weighted undirected graph. The vertices are enumerated from 1 to n. Your task is to find the shortest path between the vertex 1 and the vertex n." 1900

20B Equation math "You are given an equation:  Ax2\xe2\x80\x89+\xe2\x80\x89Bx\xe2\x80\x89+\xe2\x80\x89C\xe2\x80\x89=\xe2\x80\x890. Your task is to find the number of distinct roots of the equation and print all of them in ascending order." 2000

20A "BerOS file system" implementation "The new operating system BerOS has a nice feature. It is possible to use any number of characters \'/\' as a delimiter in path instead of one traditional \'/\'. For example, strings //usr///local//nginx/sbin// and /usr/local/nginx///sbin are equivalent. The character \'/\' (or some sequence of such characters) at the end of the path is required only in case of the path to the root directory, which can be represented as single character \'/\'.A path called normalized if it contains the smallest possible number of characters \'/\'.Your task is to transform a given path to the normalized form." 1700

19E Fairy "dfs and similar,divide and conquer,dsu" "Once upon a time there lived a good fairy A. One day a fine young man B came to her and asked to predict his future. The fairy looked into her magic ball and said that soon the fine young man will meet the most beautiful princess ever and will marry her. Then she drew on a sheet of paper n points and joined some of them with segments, each of the segments starts in some point and ends in some other point. Having drawn that picture, she asked the young man to erase one of the segments from the sheet. Then she tries to colour each point red or blue so, that there is no segment having points of the same colour as its ends. If she manages to do so, the prediction will come true. B wants to meet the most beautiful princess, that\'s why he asks you to help him. Find all the segments that will help him to meet the princess." 2900

19D Points "data structures" "Pete and Bob invented a new interesting game. Bob takes a sheet of paper and locates a Cartesian coordinate system on it as follows: point (0,\xe2\x80\x890) is located in the bottom-left corner, Ox axis is directed right, Oy axis is directed up. Pete gives Bob requests of three types:   add x y \xe2\x80\x94 on the sheet of paper Bob marks a point with coordinates (x,\xe2\x80\x89y). For each request of this type it\'s guaranteed that point (x,\xe2\x80\x89y) is not yet marked on Bob\'s sheet at the time of the request.  remove x y \xe2\x80\x94 on the sheet of paper Bob erases the previously marked point with coordinates (x,\xe2\x80\x89y). For each request of this type it\'s guaranteed that point (x,\xe2\x80\x89y) is already marked on Bob\'s sheet at the time of the request.  find x y \xe2\x80\x94 on the sheet of paper Bob finds all the marked points, lying strictly above and strictly to the right of point (x,\xe2\x80\x89y). Among these points Bob chooses the leftmost one, if it is not unique, he chooses the bottommost one, and gives its coordinates to Pete. Bob managed to answer the requests, when they were 10, 100 or 1000, but when their amount grew up to 2\xc2\xb7105, Bob failed to cope. Now he needs a program that will answer all Pete\'s requests. Help Bob, please!" 2800

19C "Deletion of Repeats" "greedy,hashing,string suffix structures" "Once Bob saw a string. It contained so many different letters, that the letters were marked by numbers, but at the same time each letter could be met in the string at most 10 times. Bob didn\'t like that string, because it contained repeats: a repeat of length x is such a substring of length 2x, that its first half coincides character by character with its second half. Bob started deleting all the repeats from the string. He does it as follows: while it\'s possible, Bob takes the shortest repeat, if it is not unique, he takes the leftmost one, and deletes its left half and everything that is to the left of this repeat.You\'re given the string seen by Bob. Find out, what it will look like after Bob deletes all the repeats in the way described above." 2200

19B "Checkout Assistant" dp "Bob came to a cash & carry store, put n items into his trolley, and went to the checkout counter to pay. Each item is described by its price ci and time ti in seconds that a checkout assistant spends on this item. While the checkout assistant is occupied with some item, Bob can steal some other items from his trolley. To steal one item Bob needs exactly 1 second. What is the minimum amount of money that Bob will have to pay to the checkout assistant? Remember, please, that it is Bob, who determines the order of items for the checkout assistant." 1900

19A "World Football Cup" implementation "Everyone knows that 2010 FIFA World Cup is being held in South Africa now. By the decision of BFA (Berland\'s Football Association) next World Cup will be held in Berland. BFA took the decision to change some World Cup regulations:  the final tournament features n teams (n is always even)  the first n\xe2\x80\x89/\xe2\x80\x892 teams (according to the standings) come through to the knockout stage  the standings are made on the following principle: for a victory a team gets 3 points, for a draw \xe2\x80\x94 1 point, for a defeat \xe2\x80\x94 0 points. In the first place, teams are ordered in the standings in decreasing order of their points; in the second place \xe2\x80\x94 in decreasing order of the difference between scored and missed goals; in the third place \xe2\x80\x94 in the decreasing order of scored goals  it\'s written in Berland\'s Constitution that the previous regulation helps to order the teams without ambiguity. You are asked to write a program that, by the given list of the competing teams and the results of all the matches, will find the list of teams that managed to get through to the knockout stage." 1400

18E "Flag 2" dp "According to a new ISO standard, a flag of every country should have, strangely enough, a chequered field n\xe2\x80\x89\xc3\x97\xe2\x80\x89m, each square should be wholly painted one of 26 colours. The following restrictions are set:   In each row at most two different colours can be used.  No two adjacent squares can be painted the same colour. Pay attention, please, that in one column more than two different colours can be used.Berland\'s government took a decision to introduce changes into their country\'s flag in accordance with the new standard, at the same time they want these changes to be minimal. By the given description of Berland\'s flag you should find out the minimum amount of squares that need to be painted different colour to make the flag meet the new ISO standard. You are as well to build one of the possible variants of the new Berland\'s flag." 2000

18D "Seller Bob" "brute force,dp,greedy" "Last year Bob earned by selling memory sticks. During each of n days of his work one of the two following events took place:   A customer came to Bob and asked to sell him a 2x MB memory stick. If Bob had such a stick, he sold it and got 2x berllars.  Bob won some programming competition and got a 2x MB memory stick as a prize. Bob could choose whether to present this memory stick to one of his friends, or keep it. Bob never kept more than one memory stick, as he feared to mix up their capacities, and deceive a customer unintentionally. It is also known that for each memory stick capacity there was at most one customer, who wanted to buy that memory stick. Now, knowing all the customers\' demands and all the prizes won at programming competitions during the last n days, Bob wants to know, how much money he could have earned, if he had acted optimally." 2000

18C Stripe "data structures,implementation" "Once Bob took a paper stripe of n squares (the height of the stripe is 1 square). In each square he wrote an integer number, possibly negative. He became interested in how many ways exist to cut this stripe into two pieces so that the sum of numbers from one piece is equal to the sum of numbers from the other piece, and each piece contains positive integer amount of squares. Would you help Bob solve this problem?" 1200

18B Platforms "brute force,math" "In one one-dimensional world there are n platforms. Platform with index k (platforms are numbered from 1) is a segment with coordinates [(k\xe2\x80\x89-\xe2\x80\x891)m,\xe2\x80\x89(k\xe2\x80\x89-\xe2\x80\x891)m\xe2\x80\x89+\xe2\x80\x89l], and l\xe2\x80\x89<\xe2\x80\x89m. Grasshopper Bob starts to jump along the platforms from point 0, with each jump he moves exactly d units right. Find out the coordinate of the point, where Bob will fall down. The grasshopper falls down, if he finds himself not on the platform, but if he finds himself on the edge of the platform, he doesn\'t fall down." 1700

18A Triangle "brute force,geometry" "At a geometry lesson Bob learnt that a triangle is called right-angled if it is nondegenerate and one of its angles is right. Bob decided to draw such a triangle immediately: on a sheet of paper he drew three points with integer coordinates, and joined them with segments of straight lines, then he showed the triangle to Peter. Peter said that Bob\'s triangle is not right-angled, but is almost right-angled: the triangle itself is not right-angled, but it is possible to move one of the points exactly by distance 1 so, that all the coordinates remain integer, and the triangle become right-angled. Bob asks you to help him and find out if Peter tricks him. By the given coordinates of the triangle you should find out if it is right-angled, almost right-angled, or neither of these." 1500

17E Palisection strings "In an English class Nick had nothing to do at all, and remembered about wonderful strings called palindromes. We should remind you that a string is called a palindrome if it can be read the same way both from left to right and from right to left. Here are examples of such strings: \xc2\xabeye\xc2\xbb, \xc2\xabpop\xc2\xbb, \xc2\xablevel\xc2\xbb, \xc2\xababa\xc2\xbb, \xc2\xabdeed\xc2\xbb, \xc2\xabracecar\xc2\xbb, \xc2\xabrotor\xc2\xbb, \xc2\xabmadam\xc2\xbb. Nick started to look carefully for all palindromes in the text that they were reading in the class. For each occurrence of each palindrome in the text he wrote a pair \xe2\x80\x94 the position of the beginning and the position of the ending of this occurrence in the text. Nick called each occurrence of each palindrome he found in the text subpalindrome. When he found all the subpalindromes, he decided to find out how many different pairs among these subpalindromes cross. Two subpalindromes cross if they cover common positions in the text. No palindrome can cross itself.Let\'s look at the actions, performed by Nick, by the example of text \xc2\xabbabb\xc2\xbb. At first he wrote out all subpalindromes:\xe2\x80\xa2 \xc2\xabb\xc2\xbb \xe2\x80\x94 1..1 \xe2\x80\xa2 \xc2\xabbab\xc2\xbb \xe2\x80\x94 1..3 \xe2\x80\xa2 \xc2\xaba\xc2\xbb \xe2\x80\x94 2..2 \xe2\x80\xa2 \xc2\xabb\xc2\xbb \xe2\x80\x94 3..3 \xe2\x80\xa2 \xc2\xabbb\xc2\xbb \xe2\x80\x94 3..4 \xe2\x80\xa2 \xc2\xabb\xc2\xbb \xe2\x80\x94 4..4 Then Nick counted the amount of different pairs among these subpalindromes that cross. These pairs were six: 1. 1..1 cross with 1..3  2. 1..3 cross with 2..2  3. 1..3 cross with 3..3  4. 1..3 cross with 3..4  5. 3..3 cross with 3..4  6. 3..4 cross with 4..4 Since it\'s very exhausting to perform all the described actions manually, Nick asked you to help him and write a program that can find out the amount of different subpalindrome pairs that cross. Two subpalindrome pairs are regarded as different if one of the pairs contains a subpalindrome that the other does not." 2900

17D Notepad "number theory" "Nick is attracted by everything unconventional. He doesn\'t like decimal number system any more, and he decided to study other number systems. A number system with base b caught his attention. Before he starts studying it, he wants to write in his notepad all the numbers of length n without leading zeros in this number system. Each page in Nick\'s notepad has enough space for c numbers exactly. Nick writes every suitable number only once, starting with the first clean page and leaving no clean spaces. Nick never writes number 0 as he has unpleasant memories about zero divide.Would you help Nick find out how many numbers will be written on the last page." 2400

17C Balance dp "Nick likes strings very much, he likes to rotate them, sort them, rearrange characters within a string... Once he wrote a random string of characters a, b, c on a piece of paper and began to perform the following operations:   to take two adjacent characters and replace the second character with the first one,  to take two adjacent characters and replace the first character with the second one To understand these actions better, let\'s take a look at a string \xc2\xababc\xc2\xbb. All of the following strings can be obtained by performing one of the described operations on \xc2\xababc\xc2\xbb: \xc2\xabbbc\xc2\xbb, \xc2\xababb\xc2\xbb, \xc2\xabacc\xc2\xbb. Let\'s denote the frequency of a character for each of the characters a, b and c as the number of occurrences of this character in the string. For example, for string \xc2\xababc\xc2\xbb: |a| = 1, |b| = 1, |c| = 1, and for string \xc2\xabbbc\xc2\xbb: |a| = 0, |b| = 2, |c| = 1. While performing the described operations, Nick sometimes got balanced strings. Let\'s say that a string is balanced, if the frequencies of each character differ by at most 1. That is \xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|a|\xe2\x80\x89-\xe2\x80\x89|b|\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x891, \xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|a|\xe2\x80\x89-\xe2\x80\x89|c|\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x891 \xd0\xb8 \xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|b|\xe2\x80\x89-\xe2\x80\x89|c|\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x891. Would you help Nick find the number of different balanced strings that can be obtained by performing the operations described above, perhaps multiple times, on the given string s. This number should be calculated modulo 51123987." 2500

17B Hierarchy "dfs and similar,dsu,greedy,shortest paths" "Nick\'s company employed n people. Now Nick needs to build a tree hierarchy of \xc2\xabsupervisor-surbodinate\xc2\xbb relations in the company (this is to say that each employee, except one, has exactly one supervisor). There are m applications written in the following form: \xc2\xabemployee ai is ready to become a supervisor of employee bi at extra cost ci\xc2\xbb. The qualification qj of each employee is known, and for each application the following is true: qai\xe2\x80\x89>\xe2\x80\x89qbi. Would you help Nick calculate the minimum cost of such a hierarchy, or find out that it is impossible to build it." 1500

17A "Noldbach problem" "brute force,math,number theory" "Nick is interested in prime numbers. Once he read about Goldbach problem. It states that every even integer greater than 2 can be expressed as the sum of two primes. That got Nick\'s attention and he decided to invent a problem of his own and call it Noldbach problem. Since Nick is interested only in prime numbers, Noldbach problem states that at least k prime numbers from 2 to n inclusively can be expressed as the sum of three integer numbers: two neighboring prime numbers and 1. For example, 19 = 7 + 11 + 1, or 13 = 5 + 7 + 1.Two prime numbers are called neighboring if there are no other prime numbers between them.You are to help Nick, and find out if he is right or wrong." 1000

16E Fish bitmasks,dp,probabilities "n fish, numbered from 1 to n, live in a lake. Every day right one pair of fish meet, and the probability of each other pair meeting is the same. If two fish with indexes i and j meet, the first will eat up the second with the probability aij, and the second will eat up the first with the probability aji\xe2\x80\x89=\xe2\x80\x891\xe2\x80\x89-\xe2\x80\x89aij. The described process goes on until there are at least two fish in the lake. For each fish find out the probability that it will survive to be the last in the lake." 1900

16D Logging implementation,strings "The main server of Gomble company received a log of one top-secret process, the name of which can\'t be revealed. The log was written in the following format: \xc2\xab[date:time]: message\xc2\xbb, where for each \xc2\xab[date:time]\xc2\xbb value existed not more than 10 lines. All the files were encoded in a very complicated manner, and only one programmer \xe2\x80\x94 Alex \xe2\x80\x94 managed to decode them. The code was so complicated that Alex needed four weeks to decode it. Right after the decoding process was finished, all the files were deleted. But after the files deletion, Alex noticed that he saved the recordings in format \xc2\xab[time]: message\xc2\xbb. So, information about the dates was lost. However, as the lines were added into the log in chronological order, it\'s not difficult to say if the recordings could appear during one day or not. It is possible also to find the minimum amount of days during which the log was written.So, to make up for his mistake Alex has to find the minimum amount of days covered by the log. Note that Alex doesn\'t have to find the minimum amount of days between the beginning and the end of the logging, he has to find the minimum amount of dates in which records could be done. (See Sample test 2 for further clarifications).We should remind you that the process made not more than 10 recordings in a minute. Consider that a midnight belongs to coming day." 1900

16C Monitor "binary search,number theory" "Reca company makes monitors, the most popular of their models is AB999 with the screen size a\xe2\x80\x89\xc3\x97\xe2\x80\x89b centimeters. Because of some production peculiarities a screen parameters are integer numbers. Recently the screen sides ratio x:\xe2\x80\x89y became popular with users. That\'s why the company wants to reduce monitor AB999 size so that its screen sides ratio becomes x:\xe2\x80\x89y, at the same time they want its total area to be maximal of all possible variants. Your task is to find the screen parameters of the reduced size model, or find out that such a reduction can\'t be performed." 1800

16B "Burglar and Matches" greedy,implementation,sortings "A burglar got into a matches warehouse and wants to steal as many matches as possible. In the warehouse there are m containers, in the i-th container there are ai matchboxes, and each matchbox contains bi matches. All the matchboxes are of the same size. The burglar\'s rucksack can hold n matchboxes exactly. Your task is to find out the maximum amount of matches that a burglar can carry away. He has no time to rearrange matches in the matchboxes, that\'s why he just chooses not more than n matchboxes so that the total amount of matches in them is maximal." 900

16A Flag implementation "According to a new ISO standard, a flag of every country should have a chequered field n\xe2\x80\x89\xc3\x97\xe2\x80\x89m, each square should be of one of 10 colours, and the flag should be \xc2\xabstriped\xc2\xbb: each horizontal row of the flag should contain squares of the same colour, and the colours of adjacent horizontal rows should be different. Berland\'s government asked you to find out whether their flag meets the new ISO standard." 800

15E Triangles combinatorics,dp "Last summer Peter was at his granny\'s in the country, when a wolf attacked sheep in the nearby forest. Now he fears to walk through the forest, to walk round the forest, even to get out of the house. He explains this not by the fear of the wolf, but by a strange, in his opinion, pattern of the forest that has n levels, where n is an even number.In the local council you were given an area map, where the granny\'s house is marked by point H, parts of dense forest are marked grey (see the picture to understand better).After a long time at home Peter decided to yield to his granny\'s persuasions and step out for a breath of fresh air. Being prudent, Peter plans the route beforehand. The route, that Peter considers the most suitable, has the following characteristics:   it starts and ends in the same place \xe2\x80\x94 the granny\'s house;  the route goes along the forest paths only (these are the segments marked black in the picture);  the route has positive length (to step out for a breath of fresh air Peter has to cover some distance anyway);  the route cannot cross itself;  there shouldn\'t be any part of dense forest within the part marked out by this route; You should find the amount of such suitable oriented routes modulo 1000000009.  The example of the area map for n\xe2\x80\x89=\xe2\x80\x8912 is given in the picture. Since the map has a regular structure, you can construct it for other n by analogy using the example." 2600

15D Map "data structures,implementation,sortings" "There is an area map that is a rectangular matrix n\xe2\x80\x89\xc3\x97\xe2\x80\x89m, each cell of the matrix contains the average height of a corresponding area part. Peter works for a company that has to build several cities within this area, each of the cities will occupy a rectangle a\xe2\x80\x89\xc3\x97\xe2\x80\x89b cells on the map. To start construction works in a particular place Peter needs to remove excess ground from the construction site where a new city will be built. To do so he chooses a cell of the minimum height within this site, and removes excess ground from other cells of the site down to this minimum level. Let\'s consider that to lower the ground level from h2 to h1 (h1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89h2) they need to remove h2\xe2\x80\x89-\xe2\x80\x89h1 ground units.Let\'s call a site\'s position optimal, if the amount of the ground removed from this site is minimal compared to other possible positions. Peter constructs cities according to the following algorithm: from all the optimum site\'s positions he chooses the uppermost one. If this position is not unique, he chooses the leftmost one. Then he builds a city on this site. Peter repeats this process untill he can build at least one more city. For sure, he cannot carry out construction works on the occupied cells. Would you, please, help Peter place cities according to the algorithm?" 2500

15C "Industrial Nim" games "There are n stone quarries in Petrograd.Each quarry owns mi dumpers (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n). It is known that the first dumper of the i-th quarry has xi stones in it, the second dumper has xi\xe2\x80\x89+\xe2\x80\x891 stones in it, the third has xi\xe2\x80\x89+\xe2\x80\x892, and the mi-th dumper (the last for the i-th quarry) has xi\xe2\x80\x89+\xe2\x80\x89mi\xe2\x80\x89-\xe2\x80\x891 stones in it.Two oligarchs play a well-known game Nim. Players take turns removing stones from dumpers. On each turn, a player can select any dumper and remove any non-zero amount of stones from it. The player who cannot take a stone loses.Your task is to find out which oligarch will win, provided that both of them play optimally. The oligarchs asked you not to reveal their names. So, let\'s call the one who takes the first stone \xc2\xabtolik\xc2\xbb and the other one \xc2\xabbolik\xc2\xbb." 2000

15B Laser math "Petya is the most responsible worker in the Research Institute. So he was asked to make a very important experiment: to melt the chocolate bar with a new laser device. The device consists of a rectangular field of n\xe2\x80\x89\xc3\x97\xe2\x80\x89m cells and a robotic arm. Each cell of the field is a 1\xe2\x80\x89\xc3\x97\xe2\x80\x891 square. The robotic arm has two lasers pointed at the field perpendicularly to its surface. At any one time lasers are pointed at the centres of some two cells. Since the lasers are on the robotic hand, their movements are synchronized \xe2\x80\x94 if you move one of the lasers by a vector, another one moves by the same vector.The following facts about the experiment are known:   initially the whole field is covered with a chocolate bar of the size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m, both lasers are located above the field and are active;  the chocolate melts within one cell of the field at which the laser is pointed;  all moves of the robotic arm should be parallel to the sides of the field, after each move the lasers should be pointed at the centres of some two cells;  at any one time both lasers should be pointed at the field. Petya doesn\'t want to become a second Gordon Freeman. You are given n, m and the cells (x1,\xe2\x80\x89y1) and (x2,\xe2\x80\x89y2), where the lasers are initially pointed at (xi is a column number, yi is a row number). Rows are numbered from 1 to m from top to bottom and columns are numbered from 1 to n from left to right. You are to find the amount of cells of the field on which the chocolate can\'t be melted in the given conditions." 1800

15A "Cottage Village" implementation,sortings "A new cottage village called \xc2\xabFlatville\xc2\xbb is being built in Flatland. By now they have already built in \xc2\xabFlatville\xc2\xbb n square houses with the centres on the \xd0\x9ex-axis. The houses\' sides are parallel to the coordinate axes. It\'s known that no two houses overlap, but they can touch each other.The architect bureau, where Peter works, was commissioned to build a new house in \xc2\xabFlatville\xc2\xbb. The customer wants his future house to be on the \xd0\x9ex-axis, to be square in shape, have a side t, and touch at least one of the already built houses. For sure, its sides should be parallel to the coordinate axes, its centre should be on the Ox-axis and it shouldn\'t overlap any of the houses in the village.Peter was given a list of all the houses in \xc2\xabFlatville\xc2\xbb. Would you help him find the amount of possible positions of the new house?" 1200

14E Camels dp "Bob likes to draw camels: with a single hump, two humps, three humps, etc. He draws a camel by connecting points on a coordinate plane. Now he\'s drawing camels with t humps, representing them as polylines in the plane. Each polyline consists of n vertices with coordinates (x1,\xe2\x80\x89y1), (x2,\xe2\x80\x89y2), ..., (xn,\xe2\x80\x89yn). The first vertex has a coordinate x1\xe2\x80\x89=\xe2\x80\x891, the second \xe2\x80\x94 x2\xe2\x80\x89=\xe2\x80\x892, etc. Coordinates yi might be any, but should satisfy the following conditions:  there should be t humps precisely, i.e. such indexes j (2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x891), so that yj\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89<\xe2\x80\x89yj\xe2\x80\x89>\xe2\x80\x89yj\xe2\x80\x89+\xe2\x80\x891,  there should be precisely t\xe2\x80\x89-\xe2\x80\x891 such indexes j (2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x891), so that yj\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89>\xe2\x80\x89yj\xe2\x80\x89<\xe2\x80\x89yj\xe2\x80\x89+\xe2\x80\x891,  no segment of a polyline should be parallel to the Ox-axis,  all yi are integers between 1 and 4. For a series of his drawings of camels with t humps Bob wants to buy a notebook, but he doesn\'t know how many pages he will need. Output the amount of different polylines that can be drawn to represent camels with t humps for a given number n." 1900

14D "Two Paths" "dfs and similar,dp,graphs,shortest paths,trees,two pointers" "As you know, Bob\'s brother lives in Flatland. In Flatland there are n cities, connected by n\xe2\x80\x89-\xe2\x80\x891 two-way roads. The cities are numbered from 1 to n. You can get from one city to another moving along the roads.The \xc2\xabTwo Paths\xc2\xbb company, where Bob\'s brother works, has won a tender to repair two paths in Flatland. A path is a sequence of different cities, connected sequentially by roads. The company is allowed to choose by itself the paths to repair. The only condition they have to meet is that the two paths shouldn\'t cross (i.e. shouldn\'t have common cities).It is known that the profit, the \xc2\xabTwo Paths\xc2\xbb company will get, equals the product of the lengths of the two paths. Let\'s consider the length of each road equals 1, and the length of a path equals the amount of roads in it. Find the maximum possible profit for the company." 1900

14C "Four Segments" "brute force,constructive algorithms,geometry,implementation,math" "Several months later Alex finally got his brother Bob\'s creation by post. And now, in his turn, Alex wants to boast about something to his brother. He thought for a while, and came to the conclusion that he has no ready creations, and decided to write a program for rectangles detection. According to his plan, the program detects if the four given segments form a rectangle of a positive area and with sides parallel to coordinate axes. As Alex does badly at school and can\'t write this program by himself, he asks you to help him." 1700

14B "Young Photographer" implementation "Among other things, Bob is keen on photography. Especially he likes to take pictures of sportsmen. That was the reason why he placed himself in position x0 of a long straight racetrack and got ready to take pictures. But the problem was that not all the runners passed him. The total amount of sportsmen, training at that racetrack, equals n. And each of them regularly runs distances within a particular segment of the racetrack, which is the same for each sportsman. For example, the first sportsman runs from position a1 to position b1, the second \xe2\x80\x94 from a2 to b2What is the minimum distance that Bob should move to have a chance to take pictures of each sportsman? Bob can take a picture of a sportsman, if he stands within the segment that this sportsman covers on the racetrack." 1000

14A Letter implementation "A boy Bob likes to draw. Not long ago he bought a rectangular graph (checked) sheet with n rows and m columns. Bob shaded some of the squares on the sheet. Having seen his masterpiece, he decided to share it with his elder brother, who lives in Flatland. Now Bob has to send his picture by post, but because of the world economic crisis and high oil prices, he wants to send his creation, but to spend as little money as possible. For each sent square of paper (no matter whether it is shaded or not) Bob has to pay 3.14 burles. Please, help Bob cut out of his masterpiece a rectangle of the minimum cost, that will contain all the shaded squares. The rectangle\'s sides should be parallel to the sheet\'s sides." 800

13E Holes "data structures,dsu" "Little Petya likes to play a lot. Most of all he likes to play a game \xc2\xabHoles\xc2\xbb. This is a game for one person with following rules:There are N holes located in a single row and numbered from left to right with numbers from 1 to N. Each hole has it\'s own power (hole number i has the power ai). If you throw a ball into hole i it will immediately jump to hole i\xe2\x80\x89+\xe2\x80\x89ai, then it will jump out of it and so on. If there is no hole with such number, the ball will just jump out of the row. On each of the M moves the player can perform one of two actions:   Set the power of the hole a to value b.  Throw a ball into the hole a and count the number of jumps of a ball before it jump out of the row and also write down the number of the hole from which it jumped out just before leaving the row. Petya is not good at math, so, as you have already guessed, you are to perform all computations." 2700

13D Triangles dp,geometry "Last summer Peter was at his granny\'s in the country, when a wolf attacked sheep in the nearby forest. Now he fears to walk through the forest, to walk round the forest, even to get out of the house. He explains this not by the fear of the wolf, but by a strange, in his opinion, pattern of the forest that has n levels, where n is an even number.In the local council you were given an area map, where the granny\'s house is marked by point H, parts of dense forest are marked grey (see the picture to understand better).After a long time at home Peter decided to yield to his granny\'s persuasions and step out for a breath of fresh air. Being prudent, Peter plans the route beforehand. The route, that Peter considers the most suitable, has the following characteristics:   it starts and ends in the same place \xe2\x80\x94 the granny\'s house;  the route goes along the forest paths only (these are the segments marked black in the picture);  the route has positive length (to step out for a breath of fresh air Peter has to cover some distance anyway);  the route cannot cross itself;  there shouldn\'t be any part of dense forest within the part marked out by this route; You should find the amount of such suitable oriented routes modulo 1000000009.  The example of the area map for n\xe2\x80\x89=\xe2\x80\x8912 is given in the picture. Since the map has a regular structure, you can construct it for other n by analogy using the example." 2600

13C Sequence dp,sortings "Little Petya likes to play very much. And most of all he likes to play the following game:He is given a sequence of N integer numbers. At each step it is allowed to increase the value of any number by 1 or to decrease it by 1. The goal of the game is to make the sequence non-decreasing with the smallest number of steps. Petya is not good at math, so he asks for your help.The sequence a is called non-decreasing if a1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89...\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89aN holds, where N is the length of the sequence." 2200

13B "Letter A" geometry,implementation "Little Petya learns how to write. The teacher gave pupils the task to write the letter A on the sheet of paper. It is required to check whether Petya really had written the letter A.You are given three segments on the plane. They form the letter A if the following conditions hold:  Two segments have common endpoint (lets call these segments first and second), while the third segment connects two points on the different segments.  The angle between the first and the second segments is greater than 0 and do not exceed 90 degrees.  The third segment divides each of the first two segments in proportion not less than 1\xe2\x80\x89/\xe2\x80\x894 (i.e. the ratio of the length of the shortest part to the length of the longest part is not less than 1\xe2\x80\x89/\xe2\x80\x894)." 2000

13A Numbers implementation,math "Little Petya likes numbers a lot. He found that number 123 in base 16 consists of two digits: the first is 7 and the second is 11. So the sum of digits of 123 in base 16 is equal to 18.Now he wonders what is an average value of sum of digits of the number A written in all bases from 2 to A\xe2\x80\x89-\xe2\x80\x891.Note that all computations should be done in base 10. You should find the result as an irreducible fraction, written in base 10." 1000

12E "Start of the session" "constructive algorithms" "Before the start of the football season in Berland a strange magic ritual is held. The most experienced magicians have to find a magic matrix of the size n\xe2\x80\x89\xc3\x97\xe2\x80\x89n (n is even number). Gods will never allow to start the championship without it. Matrix should contain integers from 0 to n\xe2\x80\x89-\xe2\x80\x891, main diagonal should contain only zeroes and matrix should be symmetric. Moreover, all numbers in each row should be different. Magicians are very tired of the thinking process, so they ask you to write a program to find such matrix." 2100

12D Ball "data structures,sortings" "N ladies attend the ball in the King\'s palace. Every lady can be described with three values: beauty, intellect and richness. King\'s Master of Ceremonies knows that ladies are very special creatures. If some lady understands that there is other lady at the ball which is more beautiful, smarter and more rich, she can jump out of the window. He knows values of all ladies and wants to find out how many probable self-murderers will be on the ball. Lets denote beauty of the i-th lady by Bi, her intellect by Ii and her richness by Ri. Then i-th lady is a probable self-murderer if there is some j-th lady that Bi\xe2\x80\x89<\xe2\x80\x89Bj,\xe2\x80\x89Ii\xe2\x80\x89<\xe2\x80\x89Ij,\xe2\x80\x89Ri\xe2\x80\x89<\xe2\x80\x89Rj. Find the number of probable self-murderers." 2400

12C Fruits greedy,implementation,sortings "The spring is coming and it means that a lot of fruits appear on the counters. One sunny day little boy Valera decided to go shopping. He made a list of m fruits he wanted to buy. If Valera want to buy more than one fruit of some kind, he includes it into the list several times. When he came to the fruit stall of Ashot, he saw that the seller hadn\'t distributed price tags to the goods, but put all price tags on the counter. Later Ashot will attach every price tag to some kind of fruits, and Valera will be able to count the total price of all fruits from his list. But Valera wants to know now what can be the smallest total price (in case of the most \xc2\xablucky\xc2\xbb for him distribution of price tags) and the largest total price (in case of the most \xc2\xabunlucky\xc2\xbb for him distribution of price tags)." 1100

12B "Correct Solution?" implementation,sortings "One cold winter evening Alice and her older brother Bob was sitting at home near the fireplace and giving each other interesting problems to solve. When it was Alice\'s turn, she told the number n to Bob and said:\xe2\x80\x94Shuffle the digits in this number in order to obtain the smallest possible number without leading zeroes.\xe2\x80\x94No problem! \xe2\x80\x94 said Bob and immediately gave her an answer.Alice said a random number, so she doesn\'t know whether Bob\'s answer is correct. Help her to find this out, because impatient brother is waiting for the verdict." 1100

12A "Super Agent" implementation "There is a very secret base in Potatoland where potato mash is made according to a special recipe. The neighbours from Porridgia decided to seize this recipe and to sell it to Pilauland. For this mission they have been preparing special agent Pearlo for many years. When, finally, Pearlo learned all secrets of espionage, he penetrated into the Potatoland territory and reached the secret base.Now he is standing at the entrance, but to get inside he need to pass combination lock. Minute ago one of the workers entered the password on the terminal and opened the door. The terminal is a square digital keyboard 3\xe2\x80\x89\xc3\x97\xe2\x80\x893 with digits from 1 to 9.Pearlo knows that the password consists from distinct digits and is probably symmetric with respect to the central button of the terminal. He has heat sensor which allowed him to detect the digits which the worker pressed. Now he wants to check whether the password entered by the worker is symmetric with respect to the central button of the terminal. This fact can Help Pearlo to reduce the number of different possible password combinations." 800

11E "Forward, march!" "binary search,dp,greedy" "Jack has become a soldier now. Unfortunately, he has trouble with the drill. Instead of marching beginning with the left foot and then changing legs with each step, as ordered, he keeps repeating a sequence of steps, in which he sometimes makes the wrong steps or \xe2\x80\x94 horror of horrors! \xe2\x80\x94 stops for a while. For example, if Jack uses the sequence \'right, left, break\', when the sergeant yells: \'Left! Right! Left! Right! Left! Right!\', Jack first makes a step with the right foot, then one with the left foot, then he is confused and stops for a moment, then again - this time according to the order - starts with the right foot, then uses the left foot, then - to the sergeant\'s irritation - he stops to catch his breath, to incorrectly start with the right foot again... Marching this way, Jack will make the step that he is supposed to in the given moment in only one third of cases.When the officers convinced him he should do something about it, Jack decided to modify the basic sequence of steps that he repeats. However, in order not to get too tired, he has decided that the only thing he\'ll do is adding any number of breaks in any positions of the original sequence (a break corresponds to stopping for the duration of one step). Of course, Jack can\'t make a step on the same foot twice in a row, if there is no pause between these steps. It is, however, not impossible that the sequence of steps he used so far is incorrect (it would explain a lot, actually).Help Private Jack! Given the sequence of steps he keeps repeating, calculate the maximal percentage of time that he can spend marching correctly after adding some breaks to his scheme." 2800

11D "A Simple Task" bitmasks,dp,graphs "Given a simple graph, output the number of simple cycles in it. A simple cycle is a cycle with no repeated vertices or edges." 2200

11C "How Many Squares?" implementation "You are given a 0-1 rectangular matrix. What is the number of squares in it? A square is a solid square frame (border) with linewidth equal to 1. A square should be at least 2\xe2\x80\x89\xc3\x97\xe2\x80\x892. We are only interested in two types of squares:   squares with each side parallel to a side of the matrix;  squares with each side parallel to a diagonal of the matrix. For example the following matrix contains only one square of the first type: 0000000 0111100 0100100 0100100 0111100The following matrix contains only one square of the second type:00000000010000010100000100000000000Regardless of type, a square must contain at least one 1 and can\'t touch (by side or corner) any foreign 1. Of course, the lengths of the sides of each square should be equal.How many squares are in the given matrix?" 2200

11B "Jumping Jack" math "Jack is working on his jumping skills recently. Currently he\'s located at point zero of the number line. He would like to get to the point x. In order to train, he has decided that he\'ll first jump by only one unit, and each subsequent jump will be exactly one longer than the previous one. He can go either left or right with each jump. He wonders how many jumps he needs to reach x." 1600

11A "Increasing Sequence" "constructive algorithms,implementation,math" "A sequence a0,\xe2\x80\x89a1,\xe2\x80\x89...,\xe2\x80\x89at\xe2\x80\x89-\xe2\x80\x891 is called increasing if ai\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89<\xe2\x80\x89ai for each i:\xe2\x80\x890\xe2\x80\x89<\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89t.You are given a sequence b0,\xe2\x80\x89b1,\xe2\x80\x89...,\xe2\x80\x89bn\xe2\x80\x89-\xe2\x80\x891 and a positive integer d. In each move you may choose one element of the given sequence and add d to it. What is the least number of moves required to make the given sequence increasing?" 900

10E "Greedy Change" "constructive algorithms" "Billy investigates the question of applying greedy algorithm to different spheres of life. At the moment he is studying the application of greedy algorithm to the problem about change. There is an amount of n coins of different face values, and the coins of each value are not limited in number. The task is to collect the sum x with the minimum amount of coins. Greedy algorithm with each its step takes the coin of the highest face value, not exceeding x. Obviously, if among the coins\' face values exists the face value 1, any sum x can be collected with the help of greedy algorithm. However, greedy algorithm does not always give the optimal representation of the sum, i.e. the representation with the minimum amount of coins. For example, if there are face values {1,\xe2\x80\x893,\xe2\x80\x894} and it is asked to collect the sum 6, greedy algorithm will represent the sum as 4\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x891, while the optimal representation is 3\xe2\x80\x89+\xe2\x80\x893, containing one coin less. By the given set of face values find out if there exist such a sum x that greedy algorithm will collect in a non-optimal way. If such a sum exists, find out the smallest of these sums." 2600

10D LCIS dp "This problem differs from one which was on the online contest.The sequence a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an is called increasing, if ai\xe2\x80\x89<\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x891 for i\xe2\x80\x89<\xe2\x80\x89n.The sequence s1,\xe2\x80\x89s2,\xe2\x80\x89...,\xe2\x80\x89sk is called the subsequence of the sequence a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an, if there exist such a set of indexes 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i1\xe2\x80\x89<\xe2\x80\x89i2\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89ik\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n that aij\xe2\x80\x89=\xe2\x80\x89sj. In other words, the sequence s can be derived from the sequence a by crossing out some elements.You are given two sequences of integer numbers. You are to find their longest common increasing subsequence, i.e. an increasing sequence of maximum length that is the subsequence of both sequences." 2800

10C "Digital Root" "number theory" "Not long ago Billy came across such a problem, where there were given three natural numbers A, B and C from the range [1,\xe2\x80\x89N], and it was asked to check whether the equation AB\xe2\x80\x89=\xe2\x80\x89C is correct. Recently Billy studied the concept of a digital root of a number. We should remind you that a digital root d(x) of the number x is the sum s(x) of all the digits of this number, if s(x)\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x899, otherwise it is d(s(x)). For example, a digital root of the number 6543 is calculated as follows: d(6543)\xe2\x80\x89=\xe2\x80\x89d(6\xe2\x80\x89+\xe2\x80\x895\xe2\x80\x89+\xe2\x80\x894\xe2\x80\x89+\xe2\x80\x893)\xe2\x80\x89=\xe2\x80\x89d(18)\xe2\x80\x89=\xe2\x80\x899. Billy has counted that the digital root of a product of numbers is equal to the digital root of the product of the factors\' digital roots, i.e. d(xy)\xe2\x80\x89=\xe2\x80\x89d(d(x)d(y)). And the following solution to the problem came to his mind: to calculate the digital roots and check if this condition is met. However, Billy has doubts that this condition is sufficient. That\'s why he asks you to find out the amount of test examples for the given problem such that the algorithm proposed by Billy makes mistakes." 2000

10B "Cinema Cashier" dp,implementation "All cinema halls in Berland are rectangles with K rows of K seats each, and K is an odd number. Rows and seats are numbered from 1 to K. For safety reasons people, who come to the box office to buy tickets, are not allowed to choose seats themselves. Formerly the choice was made by a cashier, but now this is the responsibility of a special seating program. It was found out that the large majority of Berland\'s inhabitants go to the cinema in order to watch a movie, that\'s why they want to sit as close to the hall center as possible. Moreover, a company of M people, who come to watch a movie, want necessarily to occupy M successive seats in one row. Let\'s formulate the algorithm, according to which the program chooses seats and sells tickets. As the request for M seats comes, the program should determine the row number x and the segment [yl,\xe2\x80\x89yr] of the seats numbers in this row, where yr\xe2\x80\x89-\xe2\x80\x89yl\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89=\xe2\x80\x89M. From all such possible variants as a final result the program should choose the one with the minimum function value of total seats remoteness from the center. Say,  \xe2\x80\x94 the row and the seat numbers of the most ""central"" seat. Then the function value of seats remoteness from the hall center is . If the amount of minimum function values is more than one, the program should choose the one that is closer to the screen (i.e. the row number x is lower). If the variants are still multiple, it should choose the one with the minimum yl. If you did not get yet, your task is to simulate the work of this program." 1500

10A "Power Consumption Calculation" implementation "Tom is interested in power consumption of his favourite laptop. His laptop has three modes. In normal mode laptop consumes P1 watt per minute. T1 minutes after Tom moved the mouse or touched the keyboard for the last time, a screensaver starts and power consumption changes to P2 watt per minute. Finally, after T2 minutes from the start of the screensaver, laptop switches to the ""sleep"" mode and consumes P3 watt per minute. If Tom moves the mouse or touches the keyboard when the laptop is in the second or in the third mode, it switches to the first (normal) mode. Tom\'s work with the laptop can be divided into n time periods [l1,\xe2\x80\x89r1],\xe2\x80\x89[l2,\xe2\x80\x89r2],\xe2\x80\x89...,\xe2\x80\x89[ln,\xe2\x80\x89rn]. During each interval Tom continuously moves the mouse and presses buttons on the keyboard. Between the periods Tom stays away from the laptop. Find out the total amount of power consumed by the laptop during the period [l1,\xe2\x80\x89rn]." 900

9E "Interestring graph and Apples" "dfs and similar,dsu,graphs" "Hexadecimal likes drawing. She has drawn many graphs already, both directed and not. Recently she has started to work on a still-life \xc2\xabinteresting graph and apples\xc2\xbb. An undirected graph is called interesting, if each of its vertices belongs to one cycle only \xe2\x80\x94 a funny ring \xe2\x80\x94 and does not belong to any other cycles. A funny ring is a cycle that goes through all the vertices just once. Moreover, loops are funny rings too.She has already drawn the apples and some of the graph edges. But now it is not clear, how to connect the rest of the vertices to get an interesting graph as a result. The answer should contain the minimal amount of added edges. And furthermore, the answer should be the lexicographically smallest one. The set of edges (x1,\xe2\x80\x89y1),\xe2\x80\x89(x2,\xe2\x80\x89y2),\xe2\x80\x89...,\xe2\x80\x89(xn,\xe2\x80\x89yn), where xi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89yi, is lexicographically smaller than the set (u1,\xe2\x80\x89v1),\xe2\x80\x89(u2,\xe2\x80\x89v2),\xe2\x80\x89...,\xe2\x80\x89(un,\xe2\x80\x89vn), where ui\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89vi, provided that the sequence of integers x1,\xe2\x80\x89y1,\xe2\x80\x89x2,\xe2\x80\x89y2,\xe2\x80\x89...,\xe2\x80\x89xn,\xe2\x80\x89yn is lexicographically smaller than the sequence u1,\xe2\x80\x89v1,\xe2\x80\x89u2,\xe2\x80\x89v2,\xe2\x80\x89...,\xe2\x80\x89un,\xe2\x80\x89vn. If you do not cope, Hexadecimal will eat you. ...eat you alive." 2300

9D "How many trees?" "combinatorics,divide and conquer,dp" "In one very old text file there was written Great Wisdom. This Wisdom was so Great that nobody could decipher it, even Phong \xe2\x80\x94 the oldest among the inhabitants of Mainframe. But still he managed to get some information from there. For example, he managed to learn that User launches games for pleasure \xe2\x80\x94 and then terrible Game Cubes fall down on the city, bringing death to those modules, who cannot win the game...For sure, as guard Bob appeared in Mainframe many modules stopped fearing Game Cubes. Because Bob (as he is alive yet) has never been defeated by User, and he always meddles with Game Cubes, because he is programmed to this.However, unpleasant situations can happen, when a Game Cube falls down on Lost Angles. Because there lives a nasty virus \xe2\x80\x94 Hexadecimal, who is... mmm... very strange. And she likes to play very much. So, willy-nilly, Bob has to play with her first, and then with User.This time Hexadecimal invented the following entertainment: Bob has to leap over binary search trees with n nodes. We should remind you that a binary search tree is a binary tree, each node has a distinct key, for each node the following is true: the left sub-tree of a node contains only nodes with keys less than the node\'s key, the right sub-tree of a node contains only nodes with keys greater than the node\'s key. All the keys are different positive integer numbers from 1 to n. Each node of such a tree can have up to two children, or have no children at all (in the case when a node is a leaf).In Hexadecimal\'s game all the trees are different, but the height of each is not lower than h. In this problem \xc2\xabheight\xc2\xbb stands for the maximum amount of nodes on the way from the root to the remotest leaf, the root node and the leaf itself included. When Bob leaps over a tree, it disappears. Bob gets the access to a Cube, when there are no trees left. He knows how many trees he will have to leap over in the worst case. And you?" 1900

9C "Hexadecimal\'s Numbers" "brute force,implementation,math" "In one very old text file there was written Great Wisdom. This Wisdom was so Great that nobody could decipher it, even Phong \xe2\x80\x94 the oldest among the inhabitants of Mainframe. But still he managed to get some information from there. For example, he managed to learn that User launches games for pleasure \xe2\x80\x94 and then terrible Game Cubes fall down on the city, bringing death to those modules, who cannot win the game...For sure, as guard Bob appeared in Mainframe many modules stopped fearing Game Cubes. Because Bob (as he is alive yet) has never been defeated by User, and he always meddles with Game Cubes, because he is programmed to this.However, unpleasant situations can happen, when a Game Cube falls down on Lost Angles. Because there lives a nasty virus \xe2\x80\x94 Hexadecimal, who is... mmm... very strange. And she likes to play very much. So, willy-nilly, Bob has to play with her first, and then with User.This time Hexadecimal invented the following entertainment: Bob has to leap over binary search trees with n nodes. We should remind you that a binary search tree is a binary tree, each node has a distinct key, for each node the following is true: the left sub-tree of a node contains only nodes with keys less than the node\'s key, the right sub-tree of a node contains only nodes with keys greater than the node\'s key. All the keys are different positive integer numbers from 1 to n. Each node of such a tree can have up to two children, or have no children at all (in the case when a node is a leaf).In Hexadecimal\'s game all the trees are different, but the height of each is not lower than h. In this problem \xc2\xabheight\xc2\xbb stands for the maximum amount of nodes on the way from the root to the remotest leaf, the root node and the leaf itself included. When Bob leaps over a tree, it disappears. Bob gets the access to a Cube, when there are no trees left. He knows how many trees he will have to leap over in the worst case. And you?" 1200

9B "Running Student" "brute force,geometry,implementation" "And again a misfortune fell on Poor Student. He is being late for an exam.Having rushed to a bus stop that is in point (0,\xe2\x80\x890), he got on a minibus and they drove along a straight line, parallel to axis OX, in the direction of increasing x.Poor Student knows the following:   during one run the minibus makes n stops, the i-th stop is in point (xi,\xe2\x80\x890)  coordinates of all the stops are different  the minibus drives at a constant speed, equal to vb  it can be assumed the passengers get on and off the minibus at a bus stop momentarily  Student can get off the minibus only at a bus stop  Student will have to get off the minibus at a terminal stop, if he does not get off earlier  the University, where the exam will be held, is in point (xu,\xe2\x80\x89yu)  Student can run from a bus stop to the University at a constant speed vs as long as needed  a distance between two points can be calculated according to the following formula:   Student is already on the minibus, so, he cannot get off at the first bus stop Poor Student wants to get to the University as soon as possible. Help him to choose the bus stop, where he should get off. If such bus stops are multiple, choose the bus stop closest to the University." 1200

9A "Die Roll" math,probabilities "Yakko, Wakko and Dot, world-famous animaniacs, decided to rest from acting in cartoons, and take a leave to travel a bit. Yakko dreamt to go to Pennsylvania, his Motherland and the Motherland of his ancestors. Wakko thought about Tasmania, its beaches, sun and sea. Dot chose Transylvania as the most mysterious and unpredictable place.But to their great regret, the leave turned to be very short, so it will be enough to visit one of the three above named places. That\'s why Yakko, as the cleverest, came up with a truly genius idea: let each of the three roll an ordinary six-sided die, and the one with the highest amount of points will be the winner, and will take the other two to the place of his/her dreams.Yakko thrown a die and got Y points, Wakko \xe2\x80\x94 W points. It was Dot\'s turn. But she didn\'t hurry. Dot wanted to know for sure what were her chances to visit Transylvania.It is known that Yakko and Wakko are true gentlemen, that\'s why if they have the same amount of points with Dot, they will let Dot win." 800

8E Beads dp,graphs "One Martian boy called Zorg wants to present a string of beads to his friend from the Earth \xe2\x80\x94 Masha. He knows that Masha likes two colours: blue and red, \xe2\x80\x94 and right in the shop where he has come, there is a variety of adornments with beads of these two colours. All the strings of beads have a small fastener, and if one unfastens it, one might notice that all the strings of beads in the shop are of the same length. Because of the peculiarities of the Martian eyesight, if Zorg sees one blue-and-red string of beads first, and then the other with red beads instead of blue ones, and blue \xe2\x80\x94 instead of red, he regards these two strings of beads as identical. In other words, Zorg regards as identical not only those strings of beads that can be derived from each other by the string turnover, but as well those that can be derived from each other by a mutual replacement of colours and/or by the string turnover.It is known that all Martians are very orderly, and if a Martian sees some amount of objects, he tries to put them in good order. Zorg thinks that a red bead is smaller than a blue one. Let\'s put 0 for a red bead, and 1 \xe2\x80\x94 for a blue one. From two strings the Martian puts earlier the string with a red bead in the i-th position, providing that the second string has a blue bead in the i-th position, and the first two beads i\xe2\x80\x89-\xe2\x80\x891 are identical.At first Zorg unfastens all the strings of beads, and puts them into small heaps so, that in each heap strings are identical, in his opinion. Then he sorts out the heaps and chooses the minimum string in each heap, in his opinion. He gives the unnecassary strings back to the shop assistant and says he doesn\'t need them any more. Then Zorg sorts out the remaining strings of beads and buys the string with index k. All these manupulations will take Zorg a lot of time, that\'s why he asks you to help and find the string of beads for Masha." 2600

8D "Two Friends" "binary search,geometry" "Two neighbours, Alan and Bob, live in the city, where there are three buildings only: a cinema, a shop and the house, where they live. The rest is a big asphalt square. Once they went to the cinema, and the film impressed them so deeply, that when they left the cinema, they did not want to stop discussing it.Bob wants to get home, but Alan has to go to the shop first, and only then go home. So, they agreed to cover some distance together discussing the film (their common path might pass through the shop, or they might walk circles around the cinema together), and then to part each other\'s company and go each his own way. After they part, they will start thinking about their daily pursuits; and even if they meet again, they won\'t be able to go on with the discussion. Thus, Bob\'s path will be a continuous curve, having the cinema and the house as its ends. Alan\'s path \xe2\x80\x94 a continuous curve, going through the shop, and having the cinema and the house as its ends.The film ended late, that\'s why the whole distance covered by Alan should not differ from the shortest one by more than t1, and the distance covered by Bob should not differ from the shortest one by more than t2.Find the maximum distance that Alan and Bob will cover together, discussing the film." 2600

8C "Looking for Order" bitmasks,dp "Girl Lena likes it when everything is in order, and looks for order everywhere. Once she was getting ready for the University and noticed that the room was in a mess \xe2\x80\x94 all the objects from her handbag were thrown about the room. Of course, she wanted to put them back into her handbag. The problem is that the girl cannot carry more than two objects at a time, and cannot move the handbag. Also, if he has taken an object, she cannot put it anywhere except her handbag \xe2\x80\x94 her inherent sense of order does not let her do so.You are given the coordinates of the handbag and the coordinates of the objects in some \xd0\xa1artesian coordinate system. It is known that the girl covers the distance between any two objects in the time equal to the squared length of the segment between the points of the objects. It is also known that initially the coordinates of the girl and the handbag are the same. You are asked to find such an order of actions, that the girl can put all the objects back into her handbag in a minimum time period." 2000

8B "Obsession with Robots" "constructive algorithms,graphs,implementation" "The whole world got obsessed with robots,and to keep pace with the progress, great Berland\'s programmer Draude decided to build his own robot. He was working hard at the robot. He taught it to walk the shortest path from one point to another, to record all its movements, but like in many Draude\'s programs, there was a bug \xe2\x80\x94 the robot didn\'t always walk the shortest path. Fortunately, the robot recorded its own movements correctly. Now Draude wants to find out when his robot functions wrong. Heh, if Draude only remembered the map of the field, where he tested the robot, he would easily say if the robot walked in the right direction or not. But the field map was lost never to be found, that\'s why he asks you to find out if there exist at least one map, where the path recorded by the robot is the shortest.The map is an infinite checkered field, where each square is either empty, or contains an obstruction. It is also known that the robot never tries to run into the obstruction. By the recorded robot\'s movements find out if there exist at least one such map, that it is possible to choose for the robot a starting square (the starting square should be empty) such that when the robot moves from this square its movements coincide with the recorded ones (the robot doesn\'t run into anything, moving along empty squares only), and the path from the starting square to the end one is the shortest.In one movement the robot can move into the square (providing there are no obstrutions in this square) that has common sides with the square the robot is currently in." 1400

8A "Train and Peter" strings "Peter likes to travel by train. He likes it so much that on the train he falls asleep. Once in summer Peter was going by train from city A to city B, and as usual, was sleeping. Then he woke up, started to look through the window and noticed that every railway station has a flag of a particular colour.The boy started to memorize the order of the flags\' colours that he had seen. But soon he fell asleep again. Unfortunately, he didn\'t sleep long, he woke up and went on memorizing the colours. Then he fell asleep again, and that time he slept till the end of the journey.At the station he told his parents about what he was doing, and wrote two sequences of the colours that he had seen before and after his sleep, respectively.Peter\'s parents know that their son likes to fantasize. They give you the list of the flags\' colours at the stations that the train passes sequentially on the way from A to B, and ask you to find out if Peter could see those sequences on the way from A to B, or from B to A. Remember, please, that Peter had two periods of wakefulness.Peter\'s parents put lowercase Latin letters for colours. The same letter stands for the same colour, different letters \xe2\x80\x94 for different colours." 1200

7E "Defining Macros" "dp,expression parsing,implementation" "Most C/C++ programmers know about excellent opportunities that preprocessor #define directives give; but many know as well about the problems that can arise because of their careless use.In this problem we consider the following model of #define constructions (also called macros). Each macro has its name and value. The generic syntax for declaring a macro is the following:#define macro_name macro_valueAfter the macro has been declared, ""macro_name"" is replaced with ""macro_value"" each time it is met in the program (only the whole tokens can be replaced; i.e. ""macro_name"" is replaced only when it is surrounded by spaces or other non-alphabetic symbol). A ""macro_value"" within our model can only be an arithmetic expression consisting of variables, four arithmetic operations, brackets, and also the names of previously declared macros (in this case replacement is performed sequentially). The process of replacing macros with their values is called substitution.One of the main problems arising while using macros \xe2\x80\x94 the situation when as a result of substitution we get an arithmetic expression with the changed order of calculation because of different priorities of the operations.Let\'s consider the following example. Say, we declared such a #define construction:#define sum x + yand further in the program the expression ""2 * sum"" is calculated. After macro substitution is performed we get ""2 * x + y"", instead of intuitively expected ""2 * (x + y)"".Let\'s call the situation ""suspicious"", if after the macro substitution the order of calculation changes, falling outside the bounds of some macro. Thus, your task is to find out by the given set of #define definitions and the given expression if this expression is suspicious or not.Let\'s speak more formally. We should perform an ordinary macros substitution in the given expression. Moreover, we should perform a ""safe"" macros substitution in the expression, putting in brackets each macro value; after this, guided by arithmetic rules of brackets expansion, we can omit some of the brackets. If there exist a way to get an expression, absolutely coinciding with the expression that is the result of an ordinary substitution (character-by-character, but ignoring spaces), then this expression and the macros system are called correct, otherwise \xe2\x80\x94 suspicious.Note that we consider the ""/"" operation as the usual mathematical division, not the integer division like in C/C++. That\'s why, for example, in the expression ""a*(b/c)"" we can omit brackets to get the expression ""a*b/c""." 2600

7D "Palindrome Degree" hashing,strings "String s of length n is called k-palindrome, if it is a palindrome itself, and its prefix and suffix of length  are (k\xe2\x80\x89-\xe2\x80\x891)-palindromes. By definition, any string (even empty) is 0-palindrome.Let\'s call the palindrome degree of string s such a maximum number k, for which s is k-palindrome. For example, ""abaaba"" has degree equals to 3.You are given a string. Your task is to find the sum of the palindrome degrees of all its prefixes." 2200

7C Line "math,number theory" "A line on the plane is described by an equation Ax\xe2\x80\x89+\xe2\x80\x89By\xe2\x80\x89+\xe2\x80\x89C\xe2\x80\x89=\xe2\x80\x890. You are to find any point on this line, whose coordinates are integer numbers from \xe2\x80\x89-\xe2\x80\x895\xc2\xb71018 to 5\xc2\xb71018 inclusive, or to find out that such points do not exist." 1800

7B "Memory Manager" implementation "There is little time left before the release of the first national operating system BerlOS. Some of its components are not finished yet \xe2\x80\x94 the memory manager is among them. According to the developers\' plan, in the first release the memory manager will be very simple and rectilinear. It will support three operations:   alloc n \xe2\x80\x94 to allocate n bytes of the memory and return the allocated block\'s identifier x;  erase x \xe2\x80\x94 to erase the block with the identifier x;  defragment \xe2\x80\x94 to defragment the free memory, bringing all the blocks as close to the beginning of the memory as possible and preserving their respective order; The memory model in this case is very simple. It is a sequence of m bytes, numbered for convenience from the first to the m-th.The first operation alloc n takes as the only parameter the size of the memory block that is to be allocated. While processing this operation, a free block of n successive bytes is being allocated in the memory. If the amount of such blocks is more than one, the block closest to the beginning of the memory (i.e. to the first byte) is prefered. All these bytes are marked as not free, and the memory manager returns a 32-bit integer numerical token that is the identifier of this block. If it is impossible to allocate a free block of this size, the function returns NULL.The second operation erase x takes as its parameter the identifier of some block. This operation frees the system memory, marking the bytes of this block as free for further use. In the case when this identifier does not point to the previously allocated block, which has not been erased yet, the function returns ILLEGAL_ERASE_ARGUMENT.The last operation defragment does not have any arguments and simply brings the occupied memory sections closer to the beginning of the memory without changing their respective order.In the current implementation you are to use successive integers, starting with 1, as identifiers. Each successful alloc operation procession should return following number. Unsuccessful alloc operations do not affect numeration.You are to write the implementation of the memory manager. You should output the returned value for each alloc command. You should also output ILLEGAL_ERASE_ARGUMENT for all the failed erase commands." 1600

7A "Kalevitch and Chess" "brute force,constructive algorithms" "A famous Berland\'s painter Kalevitch likes to shock the public. One of his last obsessions is chess. For more than a thousand years people have been playing this old game on uninteresting, monotonous boards. Kalevitch decided to put an end to this tradition and to introduce a new attitude to chessboards.As before, the chessboard is a square-checkered board with the squares arranged in a 8\xe2\x80\x89\xc3\x97\xe2\x80\x898 grid, each square is painted black or white. Kalevitch suggests that chessboards should be painted in the following manner: there should be chosen a horizontal or a vertical line of 8 squares (i.e. a row or a column), and painted black. Initially the whole chessboard is white, and it can be painted in the above described way one or more times. It is allowed to paint a square many times, but after the first time it does not change its colour any more and remains black. Kalevitch paints chessboards neatly, and it is impossible to judge by an individual square if it was painted with a vertical or a horizontal stroke.Kalevitch hopes that such chessboards will gain popularity, and he will be commissioned to paint chessboards, which will help him ensure a comfortable old age. The clients will inform him what chessboard they want to have, and the painter will paint a white chessboard meeting the client\'s requirements.It goes without saying that in such business one should economize on everything \xe2\x80\x94 for each commission he wants to know the minimum amount of strokes that he has to paint to fulfill the client\'s needs. You are asked to help Kalevitch with this task." 1100

6E Exposition "binary search,data structures,dsu,trees,two pointers" "There are several days left before the fiftieth birthday of a famous Berland\'s writer Berlbury. In this connection the local library decided to make an exposition of the works of this famous science-fiction writer. It was decided as well that it is necessary to include into the exposition only those books that were published during a particular time period. It is obvious that if the books differ much in size, the visitors will not like it. That was why the organizers came to the opinion, that the difference between the highest and the lowest books in the exposition should be not more than k millimeters.The library has n volumes of books by Berlbury, arranged in chronological order of their appearance. The height of each book in millimeters is know, it is hi. As Berlbury is highly respected in the city, the organizers want to include into the exposition as many books as possible, and to find out what periods of his creative work they will manage to cover. You are asked to help the organizers cope with this hard task." 1900

6D "Lizards and Basements 2" "brute force,dp" "This is simplified version of the problem used on the original contest. The original problem seems to have too difiicult solution. The constraints for input data have been reduced.Polycarp likes to play computer role-playing game \xc2\xabLizards and Basements\xc2\xbb. At the moment he is playing it as a magician. At one of the last levels he has to fight the line of archers. The only spell with which he can damage them is a fire ball. If Polycarp hits the i-th archer with his fire ball (they are numbered from left to right), the archer loses a health points. At the same time the spell damages the archers adjacent to the i-th (if any) \xe2\x80\x94 they lose b (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b\xe2\x80\x89<\xe2\x80\x89a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x8910) health points each.As the extreme archers (i.e. archers numbered 1 and n) are very far, the fire ball cannot reach them. Polycarp can hit any other archer with his fire ball.The amount of health points for each archer is known. An archer will be killed when this amount is less than 0. What is the minimum amount of spells Polycarp can use to kill all the enemies?Polycarp can throw his fire ball into an archer if the latter is already killed." 2600

6C "Alice, Bob and Chocolate" "greedy,two pointers" "Alice and Bob like games. And now they are ready to start a new game. They have placed n chocolate bars in a line. Alice starts to eat chocolate bars one by one from left to right, and Bob \xe2\x80\x94 from right to left. For each chocololate bar the time, needed for the player to consume it, is known (Alice and Bob eat them with equal speed). When the player consumes a chocolate bar, he immediately starts with another. It is not allowed to eat two chocolate bars at the same time, to leave the bar unfinished and to make pauses. If both players start to eat the same bar simultaneously, Bob leaves it to Alice as a true gentleman.How many bars each of the players will consume?" 1200

6B "President\'s Office" implementation "Alice and Bob like games. And now they are ready to start a new game. They have placed n chocolate bars in a line. Alice starts to eat chocolate bars one by one from left to right, and Bob \xe2\x80\x94 from right to left. For each chocololate bar the time, needed for the player to consume it, is known (Alice and Bob eat them with equal speed). When the player consumes a chocolate bar, he immediately starts with another. It is not allowed to eat two chocolate bars at the same time, to leave the bar unfinished and to make pauses. If both players start to eat the same bar simultaneously, Bob leaves it to Alice as a true gentleman.How many bars each of the players will consume?" 1100

6A Triangle "brute force,geometry" "Johnny has a younger sister Anne, who is very clever and smart. As she came home from the kindergarten, she told his brother about the task that her kindergartener asked her to solve. The task was just to construct a triangle out of four sticks of different colours. Naturally, one of the sticks is extra. It is not allowed to break the sticks or use their partial length. Anne has perfectly solved this task, now she is asking Johnny to do the same.The boy answered that he would cope with it without any difficulty. However, after a while he found out that different tricky things can occur. It can happen that it is impossible to construct a triangle of a positive area, but it is possible to construct a degenerate triangle. It can be so, that it is impossible to construct a degenerate triangle even. As Johnny is very lazy, he does not want to consider such a big amount of cases, he asks you to help him." 900

5E "Bindian Signalizing" "data structures" "Everyone knows that long ago on the territory of present-day Berland there lived Bindian tribes. Their capital was surrounded by n hills, forming a circle. On each hill there was a watchman, who watched the neighbourhood day and night.In case of any danger the watchman could make a fire on the hill. One watchman could see the signal of another watchman, if on the circle arc connecting the two hills there was no hill higher than any of the two. As for any two hills there are two different circle arcs connecting them, the signal was seen if the above mentioned condition was satisfied on at least one of the arcs. For example, for any two neighbouring watchmen it is true that the signal of one will be seen by the other.An important characteristics of this watch system was the amount of pairs of watchmen able to see each other\'s signals. You are to find this amount by the given heights of the hills." 2400

5D "Follow Traffic Rules" implementation,math "Everybody knows that the capital of Berland is connected to Bercouver (the Olympic capital) by a direct road. To improve the road\'s traffic capacity, there was placed just one traffic sign, limiting the maximum speed. Traffic signs in Berland are a bit peculiar, because they limit the speed only at that point on the road where they are placed. Right after passing the sign it is allowed to drive at any speed.It is known that the car of an average Berland citizen has the acceleration (deceleration) speed of a km/h2, and has maximum speed of v km/h. The road has the length of l km, and the speed sign, limiting the speed to w km/h, is placed d km (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89d\xe2\x80\x89<\xe2\x80\x89l) away from the capital of Berland. The car has a zero speed at the beginning of the journey. Find the minimum time that an average Berland citizen will need to get from the capital to Bercouver, if he drives at the optimal speed.The car can enter Bercouver at any speed." 2100

5C "Longest Regular Bracket Sequence" "constructive algorithms,data structures,dp,greedy,sortings,strings" "This is yet another problem dealing with regular bracket sequences.We should remind you that a bracket sequence is called regular, if by inserting \xc2\xab+\xc2\xbb and \xc2\xab1\xc2\xbb into it we can get a correct mathematical expression. For example, sequences \xc2\xab(())()\xc2\xbb, \xc2\xab()\xc2\xbb and \xc2\xab(()(()))\xc2\xbb are regular, while \xc2\xab)(\xc2\xbb, \xc2\xab(()\xc2\xbb and \xc2\xab(()))(\xc2\xbb are not. You are given a string of \xc2\xab(\xc2\xbb and \xc2\xab)\xc2\xbb characters. You are to find its longest substring that is a regular bracket sequence. You are to find the number of such substrings as well." 1900

5B "Center Alignment" implementation,strings "Almost every text editor has a built-in function of center text alignment. The developers of the popular in Berland text editor \xc2\xabTextpad\xc2\xbb decided to introduce this functionality into the fourth release of the product.You are to implement the alignment in the shortest possible time. Good luck!" 1200

5A "Chat Servers Outgoing Traffic" implementation "Polycarp is working on a new project called ""Polychat"". Following modern tendencies in IT, he decided, that this project should contain chat as well. To achieve this goal, Polycarp has spent several hours in front of his laptop and implemented a chat server that can process three types of commands:  Include a person to the chat (\'Add\' command).  Remove a person from the chat (\'Remove\' command).  Send a message from a person to all people, who are currently in the chat, including the one, who sends the message (\'Send\' command). Now Polycarp wants to find out the amount of outgoing traffic that the server will produce while processing a particular set of commands.Polycarp knows that chat server sends no traffic for \'Add\' and \'Remove\' commands. When \'Send\' command is processed, server sends l bytes to each participant of the chat, where l is the length of the message.As Polycarp has no time, he is asking for your help in solving this problem." 1000

4D "Mysterious Present" dp,sortings "Peter decided to wish happy birthday to his friend from Australia and send him a card. To make his present more mysterious, he decided to make a chain. Chain here is such a sequence of envelopes A\xe2\x80\x89=\xe2\x80\x89{a1,\xe2\x80\x89\xe2\x80\x89a2,\xe2\x80\x89\xe2\x80\x89...,\xe2\x80\x89\xe2\x80\x89an}, where the width and the height of the i-th envelope is strictly higher than the width and the height of the (i\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x89\xe2\x80\x891)-th envelope respectively. Chain size is the number of envelopes in the chain. Peter wants to make the chain of the maximum size from the envelopes he has, the chain should be such, that he\'ll be able to put a card into it. The card fits into the chain if its width and height is lower than the width and the height of the smallest envelope in the chain respectively. It\'s forbidden to turn the card and the envelopes. Peter has very many envelopes and very little time, this hard task is entrusted to you." 1700

4C "Registration System" "data structures,hashing,implementation" "A new e-mail service ""Berlandesk"" is going to be opened in Berland in the near future. The site administration wants to launch their project as soon as possible, that\'s why they ask you to help. You\'re suggested to implement the prototype of site registration system. The system should work on the following principle. Each time a new user wants to register, he sends to the system a request with his name. If such a name does not exist in the system database, it is inserted into the database, and the user gets the response OK, confirming the successful registration. If the name already exists in the system database, the system makes up a new user name, sends it to the user as a prompt and also inserts the prompt into the database. The new name is formed by the following rule. Numbers, starting with 1, are appended one after another to name (name1, name2, ...), among these numbers the least i is found so that namei does not yet exist in the database." 1300

4B "Before an Exam" "constructive algorithms,greedy" "Tomorrow Peter has a Biology exam. He does not like this subject much, but d days ago he learnt that he would have to take this exam. Peter\'s strict parents made him prepare for the exam immediately, for this purpose he has to study not less than minTimei and not more than maxTimei hours per each i-th day. Moreover, they warned Peter that a day before the exam they would check how he has followed their instructions.So, today is the day when Peter\'s parents ask him to show the timetable of his preparatory studies. But the boy has counted only the sum of hours sumTime spent him on preparation, and now he wants to know if he can show his parents a timetable s\xd1\x81hedule with d numbers, where each number s\xd1\x81hedulei stands for the time in hours spent by Peter each i-th day on biology studies, and satisfying the limitations imposed by his parents, and at the same time the sum total of all schedulei should equal to sumTime." 1200

4A Watermelon "brute force,math" "One hot summer day Pete and his friend Billy decided to buy a watermelon. They chose the biggest and the ripest one, in their opinion. After that the watermelon was weighed, and the scales showed w kilos. They rushed home, dying of thirst, and decided to divide the berry, however they faced a hard problem.Pete and Billy are great fans of even numbers, that\'s why they want to divide the watermelon in such a way that each of the two parts weighs even number of kilos, at the same time it is not obligatory that the parts are equal. The boys are extremely tired and want to start their meal as soon as possible, that\'s why you should help them and find out, if they can divide the watermelon in the way they want. For sure, each of them should get a part of positive weight." 800

3D "Least Cost Bracket Sequence" greedy "This is yet another problem on regular bracket sequences.A bracket sequence is called regular, if by inserting ""+"" and ""1"" into it we get a correct mathematical expression. For example, sequences ""(())()"", ""()"" and ""(()(()))"" are regular, while "")("", ""(()"" and ""(()))("" are not. You have a pattern of a bracket sequence that consists of characters ""("", "")"" and ""?"". You have to replace each character ""?"" with a bracket so, that you get a regular bracket sequence.For each character ""?"" the cost of its replacement with ""("" and "")"" is given. Among all the possible variants your should choose the cheapest." 2600

3C Tic-tac-toe "brute force,games,implementation" "Certainly, everyone is familiar with tic-tac-toe game. The rules are very simple indeed. Two players take turns marking the cells in a 3\xe2\x80\x89\xc3\x97\xe2\x80\x893 grid (one player always draws crosses, the other \xe2\x80\x94 noughts). The player who succeeds first in placing three of his marks in a horizontal, vertical or diagonal line wins, and the game is finished. The player who draws crosses goes first. If the grid is filled, but neither Xs, nor 0s form the required line, a draw is announced.You are given a 3\xe2\x80\x89\xc3\x97\xe2\x80\x893 grid, each grid cell is empty, or occupied by a cross or a nought. You have to find the player (first or second), whose turn is next, or print one of the verdicts below:   illegal \xe2\x80\x94 if the given board layout can\'t appear during a valid game;  the first player won \xe2\x80\x94 if in the given board layout the first player has just won;  the second player won \xe2\x80\x94 if in the given board layout the second player has just won;  draw \xe2\x80\x94 if the given board layout has just let to a draw." 1800

3B Lorry greedy,sortings "A group of tourists is going to kayak and catamaran tour. A rented lorry has arrived to the boat depot to take kayaks and catamarans to the point of departure. It\'s known that all kayaks are of the same size (and each of them occupies the space of 1 cubic metre), and all catamarans are of the same size, but two times bigger than kayaks (and occupy the space of 2 cubic metres).Each waterborne vehicle has a particular carrying capacity, and it should be noted that waterborne vehicles that look the same can have different carrying capacities. Knowing the truck body volume and the list of waterborne vehicles in the boat depot (for each one its type and carrying capacity are known), find out such set of vehicles that can be taken in the lorry, and that has the maximum total carrying capacity. The truck body volume of the lorry can be used effectively, that is to say you can always put into the lorry a waterborne vehicle that occupies the space not exceeding the free space left in the truck body." 1900

3A "Shortest path of the king" "greedy,shortest paths" "The king is left alone on the chessboard. In spite of this loneliness, he doesn\'t lose heart, because he has business of national importance. For example, he has to pay an official visit to square t. As the king is not in habit of wasting his time, he wants to get from his current position s to square t in the least number of moves. Help him to do this.  In one move the king can get to the square that has a common side or a common vertex with the square the king is currently in (generally there are 8 different squares he can move to)." 1000

2C "Commentator problem" geometry "The Olympic Games in Bercouver are in full swing now. Here everyone has their own objectives: sportsmen compete for medals, and sport commentators compete for more convenient positions to give a running commentary. Today the main sport events take place at three round stadiums, and the commentator\'s objective is to choose the best point of observation, that is to say the point from where all the three stadiums can be observed. As all the sport competitions are of the same importance, the stadiums should be observed at the same angle. If the number of points meeting the conditions is more than one, the point with the maximum angle of observation is prefered. Would you, please, help the famous Berland commentator G. Berniev to find the best point of observation. It should be noted, that the stadiums do not hide each other, the commentator can easily see one stadium through the other." 2600

2B "The least round way" dp,math "There is a square matrix n\xe2\x80\x89\xc3\x97\xe2\x80\x89n, consisting of non-negative integer numbers. You should find such a way on it that   starts in the upper left cell of the matrix;  each following cell is to the right or down from the current cell;  the way ends in the bottom right cell. Moreover, if we multiply together all the numbers along the way, the result should be the least ""round"". In other words, it should end in the least possible number of zeros." 2000

2A Winner hashing,implementation "The winner of the card game popular in Berland ""Berlogging"" is determined according to the following rules. If at the end of the game there is only one player with the maximum number of points, he is the winner. The situation becomes more difficult if the number of such players is more than one. During each round a player gains or loses a particular number of points. In the course of the game the number of points is registered in the line ""name score"", where name is a player\'s name, and score is the number of points gained in this round, which is an integer number. If score is negative, this means that the player has lost in the round. So, if two or more players have the maximum number of points (say, it equals to m) at the end of the game, than wins the one of them who scored at least m points first. Initially each player has 0 points. It\'s guaranteed that at the end of the game at least one player has a positive number of points." 1500

1C "Ancient Berland Circus" geometry,math "Nowadays all circuses in Berland have a round arena with diameter 13 meters, but in the past things were different.In Ancient Berland arenas in circuses were shaped as a regular (equiangular) polygon, the size and the number of angles could vary from one circus to another. In each corner of the arena there was a special pillar, and the rope strung between the pillars marked the arena edges.Recently the scientists from Berland have discovered the remains of the ancient circus arena. They found only three pillars, the others were destroyed by the time.You are given the coordinates of these three pillars. Find out what is the smallest area that the arena could have." 2100

1B Spreadsheet implementation,math "In the popular spreadsheets systems (for example, in Excel) the following numeration of columns is used. The first column has number A, the second \xe2\x80\x94 number B, etc. till column 26 that is marked by Z. Then there are two-letter numbers: column 27 has number AA, 28 \xe2\x80\x94 AB, column 52 is marked by AZ. After ZZ there follow three-letter numbers, etc.The rows are marked by integer numbers starting with 1. The cell name is the concatenation of the column and the row numbers. For example, BC23 is the name for the cell that is in column 55, row 23. Sometimes another numeration system is used: RXCY, where X and Y are integer numbers, showing the column and the row numbers respectfully. For instance, R23C55 is the cell from the previous example.Your task is to write a program that reads the given sequence of cell coordinates and produce each item written according to the rules of another numeration system." 1600

1A "Theatre Square" math "Theatre Square in the capital city of Berland has a rectangular shape with the size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m meters. On the occasion of the city\'s anniversary, a decision was taken to pave the Square with square granite flagstones. Each flagstone is of the size a\xe2\x80\x89\xc3\x97\xe2\x80\x89a.What is the least number of flagstones needed to pave the Square? It\'s allowed to cover the surface larger than the Theatre Square, but the Square has to be covered. It\'s not allowed to break the flagstones. The sides of flagstones should be parallel to the sides of the Square." 1000

