1333E "Road to 1600" "brute force,constructive algorithms" "Egor wants to achieve a rating of 1600 points on the well-known chess portal ChessForces and he needs your help!Before you start solving the problem, Egor wants to remind you how the chess pieces move. Chess rook moves along straight lines up and down, left and right, as many squares as it wants. And when it wants, it can stop. The queen walks in all directions vertically and diagonally at any distance. You can see the examples below.  To reach the goal, Egor should research the next topic:There is an N\xc3\x97N board. Each cell of the board has a number from 1 to N2 in it and numbers in all cells are distinct.In the beginning, some chess figure stands in the cell with the number 1. Note that this cell is already considered as visited. After that every move is determined by the following rules:   Among all not visited yet cells to which the figure can get in one move, it goes to the cell that has minimal number. If all accessible cells were already visited and some cells are not yet visited, then the figure is teleported to the not visited cell that has minimal number. If this step happens, the piece pays a fee of 1 vun. If all cells are already visited, the process is stopped. Egor should find an N\xc3\x97N board on which the rook pays strictly less vuns than the queen during the round with this numbering. Help him to find such N\xc3\x97N numbered board, or tell that it doesn\'t exist." 2400
1333D "Challenges in school \xe2\x84\x9641" "brute force,constructive algorithms,games,graphs,greedy,implementation,sortings" "There are nn children, who study at the school \xe2\x84\x9641. It is well-known that they are good mathematicians. Once at a break, they arranged a challenge for themselves. All children arranged in a row and turned heads either to the left or to the right.Children can do the following: in one secondÂ several pairs of neighboring children who are looking at each other can simultaneously turn the head in the opposite direction. For instance, the one who was looking at the right neighbor turns left and vice versa for the second child. Moreover, every second at least one pair of neighboring children performs such action. They are going to finish when there is no pair of neighboring children who are looking at each other. You are given the number nn, the initial arrangement of children and the number kk. You have to find a way for the children to act if they want to finish the process in exactly kk seconds. More formally, for each of the kk moves, you need to output the numbers of the children who turn left during this move.For instance, for the configuration shown below and k=2k=2 children can do the following steps:    At the beginning, two pairs make move: (1,2)(1,2) and (3,4)(3,4). After that, we receive the following configuration:    At the second move pair (2,3)(2,3) makes the move. The final configuration is reached. Good job.   It is guaranteed that if the solution exists, it takes not more than n2n2 ""headturns""." 2100
1333C "Eugene and an array" "binary search,data structures,implementation,two pointers" "Eugene likes working with arrays. And today he needs your help in solving one challenging task.An array c is a subarray of an array b if c can be obtained from b by deletion of several (possibly, zero or all) elements from the beginning and several (possibly, zero or all) elements from the end.Let\'s call a nonempty array good if for every nonempty subarray of this array, sum of the elements of this subarray is nonzero. For example, array [\xe2\x88\x921,2,\xe2\x88\x923] is good, as all arrays [\xe2\x88\x921], [\xe2\x88\x921,2], [\xe2\x88\x921,2,\xe2\x88\x923], [2], [2,\xe2\x88\x923], [\xe2\x88\x923] have nonzero sums of elements. However, array [\xe2\x88\x921,2,\xe2\x88\x921,\xe2\x88\x923] isn\'t good, as his subarray [\xe2\x88\x921,2,\xe2\x88\x921] has sum of elements equal to 0.Help Eugene to calculate the number of nonempty good subarrays of a given array a." 1700
1333B "Kind Anton" greedy,implementation "Once again, Boris needs the help of Anton in creating a task. This time Anton needs to solve the following problem:There are two arrays of integers a and b of length n. It turned out that array a contains only elements from the set {\xe2\x88\x921,0,1}.Anton can perform the following sequence of operations any number of times:  Choose any pair of indexes (i,j) such that 1\xe2\x89\xa4i<j\xe2\x89\xa4n. It is possible to choose the same pair (i,j) more than once.   Add ai to aj. In other words, j-th element of the array becomes equal to ai+aj. For example, if you are given array [1,\xe2\x88\x921,0], you can transform it only to [1,\xe2\x88\x921,\xe2\x88\x921], [1,0,0] and [1,\xe2\x88\x921,1] by one operation.Anton wants to predict if it is possible to apply some number (zero or more) of these operations to the array a so that it becomes equal to array b. Can you help him?" 1100
1333A "Little Artem" "constructive algorithms" "Young boy Artem tries to paint a picture, and he asks his mother Medina to help him. Medina is very busy, that\'s why she asked for your help.Artem wants to paint an n\xc3\x97m board. Each cell of the board should be colored in white or black. Lets B be the number of black cells that have at least one white neighbor adjacent by the side. Let W be the number of white cells that have at least one black neighbor adjacent by the side. A coloring is called good if B=W+1. The first coloring shown below has B=5 and W=4 (all cells have at least one neighbor with the opposite color). However, the second coloring is not good as it has B=4, W=4 (only the bottom right cell doesn\'t have a neighbor with the opposite color).  Please, help Medina to find any good coloring. It\'s guaranteed that under given constraints the solution always exists. If there are several solutions, output any of them." 1000
1332G "No Monotone Triples" "data structures" "Given a sequence of integers a of length n, a tuple (i,j,k) is called monotone triples if   1\xe2\x89\xa4i<j<k\xe2\x89\xa4n;  ai\xe2\x89\xa4aj\xe2\x89\xa4ak or ai\xe2\x89\xa5aj\xe2\x89\xa5ak is satisfied. For example, a=[5,3,4,5], then (2,3,4) is monotone triples for sequence a while (1,3,4) is not.Bob is given a sequence of integers a of length n in a math exam. The exams itself contains questions of form L,R, for each of them he is asked to find any subsequence b with size greater than 2 (i.e. |b|\xe2\x89\xa53) of sequence aL,aL+1,\xe2\x80\xa6,aR.Recall that an sequence b is a subsequence of sequence a if b can be obtained by deletion of several (possibly zero, or all) elements.However, he hates monotone stuff, and he wants to find a subsequence free from monotone triples. Besides, he wants to find one subsequence with the largest length among all subsequences free from monotone triples for every query.Please help Bob find out subsequences meeting the above constraints." 3100
1332F "Independent Set" "dfs and similar,dp,trees" "Eric is the teacher of graph theory class. Today, Eric teaches independent set and edge-induced subgraph.Given a graph G=(V,E), an independent set is a subset of vertices V\xe2\x80\xb2\xe2\x8a\x82V such that for every pair u,v\xe2\x88\x88V\xe2\x80\xb2, (u,v)\xe2\x88\x89E (i.e. no edge in E connects two vertices from V\xe2\x80\xb2).An edge-induced subgraph consists of a subset of edges E\xe2\x80\xb2\xe2\x8a\x82E and all the vertices in the original graph that are incident on at least one edge in the subgraph.Given E\xe2\x80\xb2\xe2\x8a\x82E, denote G[E\xe2\x80\xb2] the edge-induced subgraph such that E\xe2\x80\xb2 is the edge set of the subgraph. Here is an illustration of those definitions:  In order to help his students get familiar with those definitions, he leaves the following problem as an exercise:Given a tree G=(V,E), calculate the sum of w(H) over all except null edge-induced subgraph H of G, where w(H) is the number of independent sets in H. Formally, calculate \xe2\x88\x91\xe2\x88\x85\xe2\x89\xa0E\xe2\x80\xb2\xe2\x8a\x82Ew(G[E\xe2\x80\xb2]).Show Eric that you are smarter than his students by providing the correct answer as quickly as possible. Note that the answer might be large, you should output the answer modulo 998,244,353." 2500
1332E "Height All the Same" "combinatorics,constructive algorithms,math,matrices" "Alice has got addicted to a game called Sirtet recently.In Sirtet, player is given an n\xc3\x97m grid. Initially ai,j cubes are stacked up in the cell (i,j). Two cells are called adjacent if they share a side. Player can perform the following operations:   stack up one cube in two adjacent cells;  stack up two cubes in one cell. Cubes mentioned above are identical in height.Here is an illustration of the game. States on the right are obtained by performing one of the above operations on the state on the left, and grey cubes are added due to the operation.  Player\'s goal is to make the height of all cells the same (i.e. so that each cell has the same number of cubes in it) using above operations. Alice, however, has found out that on some starting grids she may never reach the goal no matter what strategy she uses. Thus, she is wondering the number of initial grids such that   L\xe2\x89\xa4ai,j\xe2\x89\xa4R for all 1\xe2\x89\xa4i\xe2\x89\xa4n, 1\xe2\x89\xa4j\xe2\x89\xa4m;  player can reach the goal using above operations. Please help Alice with it. Notice that the answer might be large, please output the desired value modulo 998,244,353." 2100
1332D "Walk on Matrix" "bitmasks,constructive algorithms,math" "Bob is playing a game named ""Walk on Matrix"".In this game, player is given an n\xc3\x97m matrix A=(ai,j), i.e. the element in the i-th row in the j-th column is ai,j. Initially, player is located at position (1,1) with score a1,1. To reach the goal, position (n,m), player can move right or down, i.e. move from (x,y) to (x,y+1) or (x+1,y), as long as player is still on the matrix.However, each move changes player\'s score to the bitwise AND of the current score and the value at the position he moves to.Bob can\'t wait to find out the maximum score he can get using the tool he recently learnt Â \xe2\x80\x94 dynamic programming. Here is his algorithm for this problem.   However, he suddenly realize that the algorithm above fails to output the maximum score for some matrix A. Thus, for any given non-negative integer k, he wants to find out an n\xc3\x97m matrix A=(ai,j) such that   1\xe2\x89\xa4n,m\xe2\x89\xa4500 (as Bob hates large matrix);  0\xe2\x89\xa4ai,j\xe2\x89\xa43\xe2\x8b\x85105 for all 1\xe2\x89\xa4i\xe2\x89\xa4n,1\xe2\x89\xa4j\xe2\x89\xa4m (as Bob hates large numbers);  the difference between the maximum score he can get and the output of his algorithm is exactly k. It can be shown that for any given integer k such that 0\xe2\x89\xa4k\xe2\x89\xa4105, there exists a matrix satisfying the above constraints.Please help him with it!" 1700
1332C "K-Complete Word" "dfs and similar,dsu,greedy,implementation,strings" "Word s of length n is called k-complete if   s is a palindrome, i.e. si=sn+1\xe2\x88\x92i for all 1\xe2\x89\xa4i\xe2\x89\xa4n;  s has a period of k, i.e. si=sk+i for all 1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x92k. For example, ""abaaba"" is a 3-complete word, while ""abccba"" is not.Bob is given a word s of length n consisting of only lowercase Latin letters and an integer k, such that n is divisible by k. He wants to convert s to any k-complete word.To do this Bob can choose some i (1\xe2\x89\xa4i\xe2\x89\xa4n) and replace the letter at position i with some other lowercase Latin letter.So now Bob wants to know the minimum number of letters he has to replace to convert s to any k-complete word.Note that Bob can do zero changes if the word s is already k-complete.You are required to answer t test cases independently." 1500
1332B "Composite Coloring" "brute force,constructive algorithms,greedy,math,number theory" "A positive integer is called composite if it can be represented as a product of two positive integers, both greater than 1. For example, the following numbers are composite: 6, 4, 120, 27. The following numbers aren\'t: 1, 2, 3, 17, 97.Alice is given a sequence of n composite numbers a1,a2,\xe2\x80\xa6,an.She wants to choose an integer m\xe2\x89\xa411 and color each element one of m colors from 1 to m so that:  for each color from 1 to m there is at least one element of this color;  each element is colored and colored exactly one color;  the greatest common divisor of any two elements that are colored the same color is greater than 1, i.e. gcd(ai,aj)>1 for each pair i,j if these elements are colored the same color. Note that equal elements can be colored different colorsÂ \xe2\x80\x94 you just have to choose one of m colors for each of the indices from 1 to n.Alice showed already that if all ai\xe2\x89\xa41000 then she can always solve the task by choosing some m\xe2\x89\xa411.Help Alice to find the required coloring. Note that you don\'t have to minimize or maximize the number of colors, you just have to find the solution with some m from 1 to 11." 1400
1332A "Exercising Walk" greedy,implementation,math "Alice has a cute cat. To keep her cat fit, Alice wants to design an exercising walk for her cat! Initially, Alice\'s cat is located in a cell (x,y) of an infinite grid. According to Alice\'s theory, cat needs to move:   exactly a steps left: from (u,v) to (u\xe2\x88\x921,v);  exactly b steps right: from (u,v) to (u+1,v);  exactly c steps down: from (u,v) to (u,v\xe2\x88\x921);  exactly d steps up: from (u,v) to (u,v+1). Note that the moves can be performed in an arbitrary order. For example, if the cat has to move 1 step left, 3 steps right and 2 steps down, then the walk right, down, left, right, right, down is valid.Alice, however, is worrying that her cat might get lost if it moves far away from her. So she hopes that her cat is always in the area [x1,x2]\xc3\x97[y1,y2], i.e. for every cat\'s position (u,v) of a walk x1\xe2\x89\xa4u\xe2\x89\xa4x2 and y1\xe2\x89\xa4v\xe2\x89\xa4y2 holds.Also, note that the cat can visit the same cell multiple times.Can you help Alice find out if there exists a walk satisfying her wishes?Formally, the walk should contain exactly a+b+c+d unit moves (a to the left, b to the right, c to the down, d to the up). Alice can do the moves in any order. Her current position (u,v) should always satisfy the constraints: x1\xe2\x89\xa4u\xe2\x89\xa4x2, y1\xe2\x89\xa4v\xe2\x89\xa4y2. The staring point is (x,y).You are required to answer t test cases independently." 1100
1331H "It\'s showtime" "*special problem" "You are given a mysterious language (codenamed ""UnknownX"") available in ""Custom Test"" tab. Find out what this language is, and use it to solve the following problem.You are given an integer input=1000\xe2\x88\x97n+mod (1\xe2\x89\xa4n,mod\xe2\x89\xa4999). Calculate double factorial of n modulo mod." -999
1331G "Lingua Romana" "*special problem" "per nextum in unam tum XI conscribementis fac sic    vestibulo perlegementum da varo.    morde varo.    seqis cumula varum.cisper nextum in unam tum XI conscribementis fac sic    seqis decumulamenta da varo.    varum privamentum fodementum da aresulto.    varum tum III elevamentum tum V multiplicamentum da bresulto.    aresultum tum bresultum addementum da resulto.    si CD tum resultum non praestantiam fac sic        dictum sic f(%d) = %.2f cis tum varum tum resultum egresso describe.        novumversum egresso scribe.    cis    si CD tum resultum praestantiam fac sic        dictum sic f(%d) = MAGNA NIMIS! cis tum varum egresso describe.        novumversum egresso scribe.            ciscis" -999
1331F Elementary! "*special problem,brute force,dp,strings" "InputThe input consists of a single string of uppercase letters A-Z. The length of the string is between 1 and 10 characters, inclusive.OutputOutput ""YES"" or ""NO"".ExamplesInputCopyGENIUSOutputCopyYESInputCopyDOCTOROutputCopyNOInputCopyIRENEOutputCopyYESInputCopyMARYOutputCopyNOInputCopySMARTPHONEOutputCopyNOInputCopyREVOLVEROutputCopyYESInputCopyHOLMESOutputCopyNOInputCopyWATSONOutputCopyYES" -999
1331E "Jordan Smiley" "*special problem,dfs and similar,geometry,implementation"  -999
1331D Again? "*special problem,implementation" "InputThe only line of the input contains a 7-digit hexadecimal number. The first ""digit"" of the number is letter A, the rest of the ""digits"" are decimal digits 0-9.OutputOutput a single integer.ExamplesInputCopyA278832OutputCopy0InputCopyA089956OutputCopy0InputCopyA089957OutputCopy1InputCopyA144045OutputCopy1" -999
1331C "...And after happily lived ever they" "*special problem,bitmasks" "InputThe input contains a single integer a (0\xe2\x89\xa4a\xe2\x89\xa463).OutputOutput a single number.ExamplesInputCopy2OutputCopy2InputCopy5OutputCopy24InputCopy35OutputCopy50" -999
1331B Limericks "*special problem,math,number theory" "There was once young lass called Mary,  Whose jokes were occasionally scary.  On this April\'s Fool  Fixed limerick rules  Allowed her to trip the unwary.Can she fill all the linesTo work at all times?On juggling the wordsRight around two-thirdsShe nearly ran out of rhymes." -999
1331A "Is it rated?" "*special problem"  -999
1330B "Dreamoon Likes Permutations" implementation,math "The sequence of m integers is called the permutation if it contains all integers from 1 to m exactly once. The number m is called the length of the permutation.Dreamoon has two permutations p1 and p2 of non-zero lengths l1 and l2.Now Dreamoon concatenates these two permutations into another sequence a of length l1+l2. First l1 elements of a is the permutation p1 and next l2 elements of a is the permutation p2. You are given the sequence a, and you need to find two permutations p1 and p2. If there are several possible ways to restore them, you should find all of them. (Note that it is also possible that there will be no ways.)" 1400
1330A "Dreamoon and Ranking Collection" implementation "Dreamoon is a big fan of the Codeforces contests.One day, he claimed that he will collect all the places from 1 to 54 after two more rated contests. It\'s amazing!Based on this, you come up with the following problem:There is a person who participated in n Codeforces rounds. His place in the first round is a1, his place in the second round is a2, ..., his place in the n-th round is an.You are given a positive non-zero integer x.Please, find the largest v such that this person can collect all the places from 1 to v after x more rated contests.In other words, you need to find the largest v, such that it is possible, that after x more rated contests, for each 1\xe2\x89\xa4i\xe2\x89\xa4v, there will exist a contest where this person took the i-th place.For example, if n=6, x=2 and a=[3,1,1,5,7,10] then answer is v=5, because if on the next two contest he will take places 2 and 4, then he will collect all places from 1 to 5, so it is possible to get v=5." 900
1329E "Dreamoon Loves AA" "binary search,greedy" "There is a string of length n+1 of characters \'A\' and \'B\'. The first character and last character of the string are equal to \'A\'.You are given m indices p1,p2,\xe2\x80\xa6,pm (0-indexation) denoting the other indices of characters \'A\' in the string. Let\'s denote the minimum distance between two neighboring \'A\' as l, and maximum distance between neighboring \'A\' as r.For example, (l,r) of string ""ABBAABBBA"" is (1,4).And let\'s denote the balance degree of a string as the value of r\xe2\x88\x92l.Now Dreamoon wants to change exactly k characters from \'B\' to \'A\', and he wants to make the balance degree of the string as small as possible.Please calculate the required minimum possible value of balance degree." 3300
1329D "Dreamoon Likes Strings" "constructive algorithms,data structures" "Dreamoon likes strings. Today he created a game about strings:String s1,s2,\xe2\x80\xa6,sn is beautiful if and only if for each 1\xe2\x89\xa4i<n,si\xe2\x89\xa0si+1.Initially, Dreamoon has a string a. In each step Dreamoon can choose a beautiful substring of a and remove it. Then he should concatenate the remaining characters (in the same order).Dreamoon wants to use the smallest number of steps to make a empty. Please help Dreamoon, and print any sequence of the smallest number of steps to make a empty." 3100
1329C "Drazil Likes Heap" "constructive algorithms,data structures,greedy,implementation" "Drazil likes heap very much. So he created a problem with heap:There is a max heap with a height h implemented on the array. The details of this heap are the following:This heap contains exactly 2h\xe2\x88\x921 distinct positive non-zero integers. All integers are distinct. These numbers are stored in the array a indexed from 1 to 2h\xe2\x88\x921. For any 1<i<2h, a[i]<a[\xe2\x8c\x8ai2\xe2\x8c\x8b].Now we want to reduce the height of this heap such that the height becomes g with exactly 2g\xe2\x88\x921 numbers in heap. To reduce the height, we should perform the following action 2h\xe2\x88\x922g times:Choose an index i, which contains an element and call the following function f in index i:Note that we suppose that if a[i]=0, then index i don\'t contain an element.After all operations, the remaining 2g\xe2\x88\x921 element must be located in indices from 1 to 2g\xe2\x88\x921. Now Drazil wonders what\'s the minimum possible sum of the remaining 2g\xe2\x88\x921 elements. Please find this sum and find a sequence of the function calls to achieve this value." 2400
1329B "Dreamoon Likes Sequences" bitmasks,combinatorics,math "Dreamoon likes sequences very much. So he created a problem about the sequence that you can\'t find in OEIS: You are given two integers d,m, find the number of arrays a, satisfying the following constraints:  The length of a is n, n\xe2\x89\xa51  1\xe2\x89\xa4a1<a2<\xe2\x8b\xaf<an\xe2\x89\xa4d  Define an array b of length n as follows: b1=a1, \xe2\x88\x80i>1,bi=bi\xe2\x88\x921\xe2\x8a\x95ai, where \xe2\x8a\x95 is the bitwise exclusive-or (xor). After constructing an array b, the constraint b1<b2<\xe2\x8b\xaf<bn\xe2\x88\x921<bn should hold. Since the number of possible arrays may be too large, you need to find the answer modulo m." 1700
1329A "Dreamoon Likes Coloring" "constructive algorithms,greedy,implementation,math" "Dreamoon likes coloring cells very much.There is a row of n cells. Initially, all cells are empty (don\'t contain any color). Cells are numbered from 1 to n.You are given an integer m and m integers l1,l2,\xe2\x80\xa6,lm (1\xe2\x89\xa4li\xe2\x89\xa4n)Dreamoon will perform m operations.In i-th operation, Dreamoon will choose a number pi from range [1,n\xe2\x88\x92li+1] (inclusive) and will paint all cells from pi to pi+li\xe2\x88\x921 (inclusive) in i-th color. Note that cells may be colored more one than once, in this case, cell will have the color from the latest operation.Dreamoon hopes that after these m operations, all colors will appear at least once and all cells will be colored. Please help Dreamoon to choose pi in each operation to satisfy all constraints." 1800
1328F "Make k Equal" greedy "You are given the array a consisting of n elements and the integer k\xe2\x89\xa4n.You want to obtain at least k equal elements in the array a. In one move, you can make one of the following two operations:  Take one of the minimum elements of the array and increase its value by one (more formally, if the minimum value of a is mn then you choose such index i that ai=mn and set ai:=ai+1);  take one of the maximum elements of the array and decrease its value by one (more formally, if the maximum value of a is mx then you choose such index i that ai=mx and set ai:=ai\xe2\x88\x921). Your task is to calculate the minimum number of moves required to obtain at least k equal elements in the array." 2200
1328E "Tree Queries" "dfs and similar,graphs,trees" "You are given a rooted tree consisting of n vertices numbered from 1 to n. The root of the tree is a vertex number 1.A tree is a connected undirected graph with n\xe2\x88\x921 edges.You are given m queries. The i-th query consists of the set of ki distinct vertices vi[1],vi[2],\xe2\x80\xa6,vi[ki]. Your task is to say if there is a path from the root to some vertex u such that each of the given k vertices is either belongs to this path or has the distance 1 to some vertex of this path." 1900
1328D Carousel "constructive algorithms,dp,graphs,greedy,math" "The round carousel consists of n figures of animals. Figures are numbered from 1 to n in order of the carousel moving. Thus, after the n-th figure the figure with the number 1 follows. Each figure has its own type \xe2\x80\x94 the type of the animal corresponding to this figure (the horse, the tiger and so on). The type of animal of the i-th figure equals ti.  The example of the carousel for n=9 and t=[5,5,1,15,1,5,5,1,1]. You want to color each figure in one of the colors. You think that it\'s boring if the carousel contains two different figures (with the distinct types of animals) going one right after another and colored in the same color.Your task is to color the figures in such a way that the number of distinct colors used is the minimum possible and there are no figures of the different types going one right after another and colored in the same color. If you use exactly k distinct colors, then the colors of figures should be denoted with integers from 1 to k." 1800
1328C "Ternary XOR" greedy,implementation "A number is ternary if it contains only digits 0, 1 and 2. For example, the following numbers are ternary: 1022, 11, 21, 2002.You are given a long ternary number x. The first (leftmost) digit of x is guaranteed to be 2, the other digits of x can be 0, 1 or 2.Let\'s define the ternary XOR operation \xe2\x8a\x99 of two ternary numbers a and b (both of length n) as a number c=a\xe2\x8a\x99b of length n, where ci=(ai+bi)%3 (where % is modulo operation). In other words, add the corresponding digits and take the remainders of the sums when divided by 3. For example, 10222\xe2\x8a\x9911021=21210.Your task is to find such ternary numbers a and b both of length n and both without leading zeros that a\xe2\x8a\x99b=x and max(a,b) is the minimum possible.You have to answer t independent test cases." 1200
1328B "K-th Beautiful String" "binary search,brute force,combinatorics,implementation,math" "For the given integer n (n>2) let\'s write down all the strings of length n which contain n\xe2\x88\x922 letters \'a\' and two letters \'b\' in lexicographical (alphabetical) order.Recall that the string s of length n is lexicographically less than string t of length n, if there exists such i (1\xe2\x89\xa4i\xe2\x89\xa4n), that si<ti, and for any j (1\xe2\x89\xa4j<i) sj=tj. The lexicographic comparison of strings is implemented by the operator < in modern programming languages.For example, if n=5 the strings are (the order does matter):  aaabb  aabab  aabba  abaab  ababa  abbaa  baaab  baaba  babaa  bbaaa It is easy to show that such a list of strings will contain exactly n\xe2\x8b\x85(n\xe2\x88\x921)2 strings.You are given n (n>2) and k (1\xe2\x89\xa4k\xe2\x89\xa4n\xe2\x8b\x85(n\xe2\x88\x921)2). Print the k-th string from the list." 1300
1328A "Divisibility Problem" math "You are given two positive integers a and b. In one move you can increase a by 1 (replace a with a+1). Your task is to find the minimum number of moves you need to do in order to make a divisible by b. It is possible, that you have to make 0 moves, as a is already divisible by b. You have to answer t independent test cases." 800
1327G "Letters and Question Marks" "bitmasks,dp,string suffix structures" "You are given a string S and an array of strings [t1,t2,\xe2\x80\xa6,tk]. Each string ti consists of lowercase Latin letters from a to n; S consists of lowercase Latin letters from a to n and no more than 14 question marks.Each string ti has its cost ci \xe2\x80\x94 an integer number. The value of some string T is calculated as k\xe2\x88\x91i=1F(T,ti)\xe2\x8b\x85ci, where F(T,ti) is the number of occurences of string ti in T as a substring. For example, F(aaabaaa,aa)=4.You have to replace all question marks in S with pairwise distinct lowercase Latin letters from a to n so the value of S is maximum possible." 2800
1327F "AND Segments" "bitmasks,combinatorics,data structures,dp,two pointers" "You are given three integers n, k, m and m conditions (l1,r1,x1),(l2,r2,x2),\xe2\x80\xa6,(lm,rm,xm).Calculate the number of distinct arrays a, consisting of n integers such that:   0\xe2\x89\xa4ai<2k for each 1\xe2\x89\xa4i\xe2\x89\xa4n;  bitwise AND of numbers a[li]&a[li+1]&\xe2\x80\xa6&a[ri]=xi for each 1\xe2\x89\xa4i\xe2\x89\xa4m. Two arrays a and b are considered different if there exists such a position i that ai\xe2\x89\xa0bi. The number can be pretty large so print it modulo 998244353." 2500
1327E "Count The Blocks" combinatorics,dp,math "You wrote down all integers from 0 to 10n\xe2\x88\x921, padding them with leading zeroes so their lengths are exactly n. For example, if n=3 then you wrote out 000, 001, ..., 998, 999.A block in an integer x is a consecutive segment of equal digits that cannot be extended to the left or to the right.For example, in the integer 00027734000 there are three blocks of length 1, one block of length 2 and two blocks of length 3.For all integers i from 1 to n count the number of blocks of length i among the written down integers.Since these integers may be too large, print them modulo 998244353." 1800
1327D "Infinite Path" "brute force,dfs and similar,graphs,math,number theory" "You are given a colored permutation p1,p2,\xe2\x80\xa6,pn. The i-th element of the permutation has color ci.Let\'s define an infinite path as infinite sequence i,p[i],p[p[i]],p[p[p[i]]]\xe2\x80\xa6 where all elements have same color (c[i]=c[p[i]]=c[p[p[i]]]=\xe2\x80\xa6).We can also define a multiplication of permutations a and b as permutation c=a\xc3\x97b where c[i]=b[a[i]]. Moreover, we can define a power k of permutation p as pk=p\xc3\x97p\xc3\x97\xe2\x8b\xaf\xc3\x97p\xe2\x8f\x9fkÂ times.Find the minimum k>0 such that pk has at least one infinite path (i.e. there is a position i in pk such that the sequence starting from i is an infinite path).It can be proved that the answer always exists." 2200
1327C "Game with Chips" "constructive algorithms,implementation" "Petya has a rectangular Board of size n\xc3\x97m. Initially, k chips are placed on the board, i-th chip is located in the cell at the intersection of sxi-th row and syi-th column.In one action, Petya can move all the chips to the left, right, down or up by 1 cell.If the chip was in the (x,y) cell, then after the operation:   left, its coordinates will be (x,y\xe2\x88\x921);  right, its coordinates will be (x,y+1);  down, its coordinates will be (x+1,y);  up, its coordinates will be (x\xe2\x88\x921,y). If the chip is located by the wall of the board, and the action chosen by Petya moves it towards the wall, then the chip remains in its current position.Note that several chips can be located in the same cell.For each chip, Petya chose the position which it should visit. Note that it\'s not necessary for a chip to end up in this position.Since Petya does not have a lot of free time, he is ready to do no more than 2nm actions.You have to find out what actions Petya should do so that each chip visits the position that Petya selected for it at least once. Or determine that it is not possible to do this in 2nm actions." 1600
1327B "Princesses and Princes" "brute force,graphs,greedy" "The King of Berland Polycarp LXXXIV has n daughters. To establish his power to the neighbouring kingdoms he wants to marry his daughters to the princes of these kingdoms. As a lucky coincidence there are n other kingdoms as well.So Polycarp LXXXIV has enumerated his daughters from 1 to n and the kingdoms from 1 to n. For each daughter he has compiled a list of kingdoms princes of which she wanted to marry.Polycarp LXXXIV is very busy, so he finds a couple for his daughters greedily one after another.For the first daughter he takes the kingdom with the lowest number from her list and marries the daughter to their prince. For the second daughter he takes the kingdom with the lowest number from her list, prince of which hasn\'t been taken already. If there are no free princes in the list then the daughter marries nobody and Polycarp LXXXIV proceeds to the next daughter. The process ends after the n-th daughter.For example, let there be 4 daughters and kingdoms, the lists daughters have are [2,3], [1,2], [3,4], [3], respectively.  In that case daughter 1 marries the prince of kingdom 2, daughter 2 marries the prince of kingdom 1, daughter 3 marries the prince of kingdom 3, leaving daughter 4 nobody to marry to.Actually, before starting the marriage process Polycarp LXXXIV has the time to convince one of his daughters that some prince is also worth marrying to. Effectively, that means that he can add exactly one kingdom to exactly one of his daughter\'s list. Note that this kingdom should not be present in the daughter\'s list.Polycarp LXXXIV wants to increase the number of married couples.Unfortunately, what he doesn\'t have the time for is determining what entry to add. If there is no way to increase the total number of married couples then output that the marriages are already optimal. Otherwise, find such an entry that the total number of married couples increases if Polycarp LXXXIV adds it.If there are multiple ways to add an entry so that the total number of married couples increases then print any of them.For your and our convenience you are asked to answer t independent test cases." 1200
1327A "Sum of Odd Integers" math "You are given two integers n and k. Your task is to find if n can be represented as a sum of k distinct positive odd (not divisible by 2) integers or not.You have to answer t independent test cases." 1100
1326G "Spiderweb Trees" dp,geometry,trees "Let\'s call a graph with n vertices, each of which has it\'s own point Ai=(xi,yi) with integer coordinates, a planar tree if:  All points A1,A2,\xe2\x80\xa6,An are different and no three points lie on the same line.  The graph is a tree, i.e. there are exactly n\xe2\x88\x921 edges there exists a path between any pair of vertices.  For all pairs of edges (s1,f1) and (s2,f2), such that s1\xe2\x89\xa0s2,s1\xe2\x89\xa0f2, f1\xe2\x89\xa0s2, and f1\xe2\x89\xa0f2, the segments As1Af1 and As2Af2 don\'t intersect. Imagine a planar tree with n vertices. Consider the convex hull of points A1,A2,\xe2\x80\xa6,An. Let\'s call this tree a spiderweb tree if for all 1\xe2\x89\xa4i\xe2\x89\xa4n the following statements are true:  All leaves (vertices with degree \xe2\x89\xa41) of the tree lie on the border of the convex hull.  All vertices on the border of the convex hull are leaves. An example of a spiderweb tree:   The points A3,A6,A7,A4 lie on the convex hull and the leaf vertices of the tree are 3,6,7,4.Refer to the notes for more examples.Let\'s call the subset S\xe2\x8a\x82{1,2,\xe2\x80\xa6,n} of vertices a subtree of the tree if for all pairs of vertices in S, there exists a path that contains only vertices from S. Note that any subtree of the planar tree is a planar tree.You are given a planar tree with n vertexes. Let\'s call a partition of the set {1,2,\xe2\x80\xa6,n} into non-empty subsets A1,A2,\xe2\x80\xa6,Ak (i.e. Ai\xe2\x88\xa9Aj=\xe2\x88\x85 for all 1\xe2\x89\xa4i<j\xe2\x89\xa4k and A1\xe2\x88\xaaA2\xe2\x88\xaa\xe2\x80\xa6\xe2\x88\xaaAk={1,2,\xe2\x80\xa6,n}) good if for all 1\xe2\x89\xa4i\xe2\x89\xa4k, the subtree Ai is a spiderweb tree. Two partitions are different if there exists some set that lies in one parition, but not the other.Find the number of good partitions. Since this number can be very large, find it modulo 998244353." 3500
1326F2 "Wise Men (Hard Version)" bitmasks,dp,math "This is the hard version of the problem. The difference is constraints on the number of wise men and the time limit. You can make hacks only if all versions of this task are solved.n wise men live in a beautiful city. Some of them know each other.For each of the n! possible permutations p1,p2,\xe2\x80\xa6,pn of the wise men, let\'s generate a binary string of length n\xe2\x88\x921: for each 1\xe2\x89\xa4i<n set si=1 if pi and pi+1 know each other, and si=0 otherwise. For all possible 2n\xe2\x88\x921 binary strings, find the number of permutations that produce this binary string." 3200
1326F1 "Wise Men (Easy Version)" "bitmasks,brute force,dp,meet-in-the-middle" "This is the easy version of the problem. The difference is constraints on the number of wise men and the time limit. You can make hacks only if all versions of this task are solved.n wise men live in a beautiful city. Some of them know each other.For each of the n! possible permutations p1,p2,\xe2\x80\xa6,pn of the wise men, let\'s generate a binary string of length n\xe2\x88\x921: for each 1\xe2\x89\xa4i<n set si=1 if pi and pi+1 know each other, and si=0 otherwise. For all possible 2n\xe2\x88\x921 binary strings, find the number of permutations that produce this binary string." 2600
1326E Bombs "data structures,two pointers" "You are given a permutation, p1,p2,\xe2\x80\xa6,pn.Imagine that some positions of the permutation contain bombs, such that there exists at least one position without a bomb.For some fixed configuration of bombs, consider the following process. Initially, there is an empty set, A.For each i from 1 to n: Add pi to A.  If the i-th position contains a bomb, remove the largest element in A.After the process is completed, A will be non-empty. The cost of the configuration of bombs equals the largest element in A.You are given another permutation, q1,q2,\xe2\x80\xa6,qn.For each 1\xe2\x89\xa4i\xe2\x89\xa4n, find the cost of a configuration of bombs such that there exists a bomb in positions q1,q2,\xe2\x80\xa6,qi\xe2\x88\x921. For example, for i=1, you need to find the cost of a configuration without bombs, and for i=n, you need to find the cost of a configuration with bombs in positions q1,q2,\xe2\x80\xa6,qn\xe2\x88\x921." 2400
1326D2 "Prefix-Suffix Palindrome (Hard version)" "binary search,greedy,hashing,string suffix structures,strings" "This is the hard version of the problem. The difference is the constraint on the sum of lengths of strings and the number of test cases. You can make hacks only if you solve all versions of this task.You are given a string s, consisting of lowercase English letters. Find the longest string, t, which satisfies the following conditions:   The length of t does not exceed the length of s.  t is a palindrome.  There exists two strings a and b (possibly empty), such that t=a+b ( ""+"" represents concatenation), and a is prefix of s while b is suffix of s." 1800
1326D1 "Prefix-Suffix Palindrome (Easy version)" "hashing,string suffix structures,strings" "This is the easy version of the problem. The difference is the constraint on the sum of lengths of strings and the number of test cases. You can make hacks only if you solve all versions of this task.You are given a string s, consisting of lowercase English letters. Find the longest string, t, which satisfies the following conditions:   The length of t does not exceed the length of s.  t is a palindrome.  There exists two strings a and b (possibly empty), such that t=a+b ( ""+"" represents concatenation), and a is prefix of s while b is suffix of s." 1500
1326C "Permutation Partitions" combinatorics,greedy,math "You are given a permutation p1,p2,\xe2\x80\xa6,pn of integers from 1 to n and an integer k, such that 1\xe2\x89\xa4k\xe2\x89\xa4n. A permutation means that every number from 1 to n is contained in p exactly once.Let\'s consider all partitions of this permutation into k disjoint segments. Formally, a partition is a set of segments {[l1,r1],[l2,r2],\xe2\x80\xa6,[lk,rk]}, such that:  1\xe2\x89\xa4li\xe2\x89\xa4ri\xe2\x89\xa4n for all 1\xe2\x89\xa4i\xe2\x89\xa4k;  For all 1\xe2\x89\xa4j\xe2\x89\xa4n there exists exactly one segment [li,ri], such that li\xe2\x89\xa4j\xe2\x89\xa4ri. Two partitions are different if there exists a segment that lies in one partition but not the other.Let\'s calculate the partition value, defined as k\xe2\x88\x91i=1maxli\xe2\x89\xa4j\xe2\x89\xa4ripj, for all possible partitions of the permutation into k disjoint segments. Find the maximum possible partition value over all such partitions, and the number of partitions with this value. As the second value can be very large, you should find its remainder when divided by 998244353." 1300
1326B Maximums implementation,math "Alicia has an array, a1,a2,\xe2\x80\xa6,an, of non-negative integers. For each 1\xe2\x89\xa4i\xe2\x89\xa4n, she has found a non-negative integer xi=max(0,a1,\xe2\x80\xa6,ai\xe2\x88\x921). Note that for i=1, xi=0.For example, if Alicia had the array a={0,1,2,0,3}, then x={0,0,1,2,2}.Then, she calculated an array, b1,b2,\xe2\x80\xa6,bn: bi=ai\xe2\x88\x92xi.For example, if Alicia had the array a={0,1,2,0,3}, b={0\xe2\x88\x920,1\xe2\x88\x920,2\xe2\x88\x921,0\xe2\x88\x922,3\xe2\x88\x922}={0,1,1,\xe2\x88\x922,1}.Alicia gives you the values b1,b2,\xe2\x80\xa6,bn and asks you to restore the values a1,a2,\xe2\x80\xa6,an. Can you help her solve the problem?" 900
1326A "Bad Ugly Numbers" "constructive algorithms,number theory" "You are given a integer n (n>0). Find any integer s which satisfies these conditions, or report that there are no such numbers:In the decimal representation of s:   s>0,  s consists of n digits,  no digit in s equals 0,  s is not divisible by any of it\'s digits." 1000
1325F "Ehab\'s Last Theorem" "constructive algorithms,dfs and similar,graphs,greedy" "It\'s the year 5555. You have a graph, and you want to find a long cycle and a huge independent set, just because you can. But for now, let\'s just stick with finding either.Given a connected graph with nn vertices, you can choose to either:  find an independent set that has exactly \xe2\x8c\x88n\xe2\x88\x92\xe2\x88\x92\xe2\x88\x9a\xe2\x8c\x89\xe2\x8c\x88n\xe2\x8c\x89 vertices. find a simple cycle of length at least \xe2\x8c\x88n\xe2\x88\x92\xe2\x88\x92\xe2\x88\x9a\xe2\x8c\x89\xe2\x8c\x88n\xe2\x8c\x89. An independent set is a set of vertices such that no two of them are connected by an edge. A simple cycle is a cycle that doesn\'t contain any vertex twice. I have a proof you can always solve one of these problems, but it\'s too long to fit this margin." 2500
1325E "Ehab\'s REAL Number Theory Problem" "brute force,dfs and similar,graphs,number theory,shortest paths" "You are given an array a of length n that has a special condition: every element in this array has at most 7 divisors. Find the length of the shortest non-empty subsequence of this array product of whose elements is a perfect square.A sequence a is a subsequence of an array b if a can be obtained from b by deletion of several (possibly, zero or all) elements." 2600
1325D "Ehab the Xorcist" "bitmasks,constructive algorithms,greedy,number theory" "Given 2 integers u and v, find the shortest array such that bitwise-xor of its elements is u, and the sum of its elements is v." 1700
1325C "Ehab and Path-etic MEXs" "constructive algorithms,dfs and similar,greedy,trees" "You are given a tree consisting of n nodes. You want to write some labels on the tree\'s edges such that the following conditions hold:  Every label is an integer between 0 and n\xe2\x88\x922 inclusive.  All the written labels are distinct.  The largest value among MEX(u,v) over all pairs of nodes (u,v) is as small as possible. Here, MEX(u,v) denotes the smallest non-negative integer that isn\'t written on any edge on the unique simple path from node u to node v." 1500
1325B CopyCopyCopyCopyCopy greedy,implementation "Ehab has an array a of length n. He has just enough free time to make a new array consisting of n copies of the old array, written back-to-back. What will be the length of the new array\'s longest increasing subsequence?A sequence a is a subsequence of an array b if a can be obtained from b by deletion of several (possibly, zero or all) elements. The longest increasing subsequence of an array is the longest subsequence such that its elements are ordered in strictly increasing order." 800
1325A "EhAb AnD gCd" "constructive algorithms,greedy,number theory" "You are given a positive integer x. Find any such 2 positive integers a and b such that GCD(a,b)+LCM(a,b)=x.As a reminder, GCD(a,b) is the greatest integer that divides both a and b. Similarly, LCM(a,b) is the smallest integer such that both a and b divide it.It\'s guaranteed that the solution always exists. If there are several such pairs (a,b), you can output any of them." 800
1324F "Maximum White Subtree" "dfs and similar,dp,graphs,trees" "You are given a tree consisting of n vertices. A tree is a connected undirected graph with n\xe2\x88\x921 edges. Each vertex v of this tree has a color assigned to it (av=1 if the vertex v is white and 0 if the vertex v is black).You have to solve the following problem for each vertex v: what is the maximum difference between the number of white and the number of black vertices you can obtain if you choose some subtree of the given tree that contains the vertex v? The subtree of the tree is the connected subgraph of the given tree. More formally, if you choose the subtree that contains cntw white vertices and cntb black vertices, you have to maximize cntw\xe2\x88\x92cntb." 1800
1324E "Sleeping Schedule" dp,implementation "Vova had a pretty weird sleeping schedule. There are h hours in a day. Vova will sleep exactly n times. The i-th time he will sleep exactly after ai hours from the time he woke up. You can assume that Vova woke up exactly at the beginning of this story (the initial time is 0). Each time Vova sleeps exactly one day (in other words, h hours).Vova thinks that the i-th sleeping time is good if he starts to sleep between hours l and r inclusive.Vova can control himself and before the i-th time can choose between two options: go to sleep after ai hours or after ai\xe2\x88\x921 hours.Your task is to say the maximum number of good sleeping times Vova can obtain if he acts optimally." 1700
1324D "Pair of Topics" "binary search,data structures,sortings,two pointers" "The next lecture in a high school requires two topics to be discussed. The i-th topic is interesting by ai units for the teacher and by bi units for the students.The pair of topics i and j (i<j) is called good if ai+aj>bi+bj (i.e. it is more interesting for the teacher).Your task is to find the number of good pairs of topics." 1400
1324C "Frog Jumps" "binary search,data structures,dfs and similar,greedy,implementation" "There is a frog staying to the left of the string s=s1s2\xe2\x80\xa6sn consisting of n characters (to be more precise, the frog initially stays at the cell 0). Each character of s is either \'L\' or \'R\'. It means that if the frog is staying at the i-th cell and the i-th character is \'L\', the frog can jump only to the left. If the frog is staying at the i-th cell and the i-th character is \'R\', the frog can jump only to the right. The frog can jump only to the right from the cell 0.Note that the frog can jump into the same cell twice and can perform as many jumps as it needs.The frog wants to reach the n+1-th cell. The frog chooses some positive integer value d before the first jump (and cannot change it later) and jumps by no more than d cells at once. I.e. if the i-th character is \'L\' then the frog can jump to any cell in a range [max(0,i\xe2\x88\x92d);i\xe2\x88\x921], and if the i-th character is \'R\' then the frog can jump to any cell in a range [i+1;min(n+1;i+d)].The frog doesn\'t want to jump far, so your task is to find the minimum possible value of d such that the frog can reach the cell n+1 from the cell 0 if it can jump by no more than d cells at once. It is guaranteed that it is always possible to reach n+1 from 0.You have to answer t independent test cases." 1100
1324B "Yet Another Palindrome Problem" "brute force,strings" "You are given an array a consisting of n integers.Your task is to determine if a has some subsequence of length at least 3 that is a palindrome.Recall that an array b is called a subsequence of the array a if b can be obtained by removing some (possibly, zero) elements from a (not necessarily consecutive) without changing the order of remaining elements. For example, [2], [1,2,1,3] and [2,3] are subsequences of [1,2,1,3], but [1,1,2] and [4] are not.Also, recall that a palindrome is an array that reads the same backward as forward. In other words, the array a of length n is the palindrome if ai=an\xe2\x88\x92i\xe2\x88\x921 for all i from 1 to n. For example, arrays [1234], [1,2,1], [1,3,2,2,3,1] and [10,100,10] are palindromes, but arrays [1,2] and [1,2,3,1] are not.You have to answer t independent test cases." 1100
1324A "Yet Another Tetris Problem" "implementation,number theory" "You are given some Tetris field consisting of n columns. The initial height of the i-th column of the field is ai blocks. On top of these columns you can place only figures of size 2\xc3\x971 (i.e. the height of this figure is 2 blocks and the width of this figure is 1 block). Note that you cannot rotate these figures.Your task is to say if you can clear the whole field by placing such figures.More formally, the problem can be described like this:The following process occurs while at least one ai is greater than 0:  You place one figure 2\xc3\x971 (choose some i from 1 to n and replace ai with ai+2);  then, while all ai are greater than zero, replace each ai with ai\xe2\x88\x921. And your task is to determine if it is possible to clear the whole field (i.e. finish the described process), choosing the places for new figures properly.You have to answer t independent test cases." 900
1323B "Count Subrectangles" "binary search,greedy,implementation" "You are given an array a of length n and array b of length m both consisting of only integers 0 and 1. Consider a matrix c of size n\xc3\x97m formed by following rule: ci,j=ai\xe2\x8b\x85bj (i.e. ai multiplied by bj). It\'s easy to see that c consists of only zeroes and ones too.How many subrectangles of size (area) k consisting only of ones are there in c?A subrectangle is an intersection of a consecutive (subsequent) segment of rows and a consecutive (subsequent) segment of columns. I.e. consider four integers x1,x2,y1,y2 (1\xe2\x89\xa4x1\xe2\x89\xa4x2\xe2\x89\xa4n, 1\xe2\x89\xa4y1\xe2\x89\xa4y2\xe2\x89\xa4m) a subrectangle c[x1\xe2\x80\xa6x2][y1\xe2\x80\xa6y2] is an intersection of the rows x1,x1+1,x1+2,\xe2\x80\xa6,x2 and the columns y1,y1+1,y1+2,\xe2\x80\xa6,y2.The size (area) of a subrectangle is the total number of cells in it." 1500
1323A "Even Subset Sum Problem" "brute force,dp,greedy,implementation" "You are given an array a consisting of n positive integers. Find a non-empty subset of its elements such that their sum is even (i.e. divisible by 2) or determine that there is no such subset.Both the given array and required subset may contain equal values." 800
1322F "Assigning Fares" dp,trees "Mayor of city M. decided to launch several new metro lines during 2020. Since the city has a very limited budget, it was decided not to dig new tunnels but to use the existing underground network.The tunnel system of the city M. consists of n metro stations. The stations are connected with n\xe2\x88\x921 bidirectional tunnels. Between every two stations v and u there is exactly one simple path. Each metro line the mayor wants to create is a simple path between stations ai and bi. Metro lines can intersects freely, that is, they can share common stations or even common tunnels. However, it\'s not yet decided which of two directions each line will go. More precisely, between the stations ai and bi the trains will go either from ai to bi, or from bi to ai, but not simultaneously.The city M uses complicated faring rules. Each station is assigned with a positive integer ciÂ \xe2\x80\x94 the fare zone of the station. The cost of travel from v to u is defined as cu\xe2\x88\x92cv roubles. Of course, such travel only allowed in case there is a metro line, the trains on which go from v to u. Mayor doesn\'t want to have any travels with a negative cost, so it was decided to assign directions of metro lines and station fare zones in such a way, that fare zones are strictly increasing during any travel on any metro line.Mayor wants firstly assign each station a fare zone and then choose a lines direction, such that all fare zones are increasing along any line. In connection with the approaching celebration of the day of the city, the mayor wants to assign fare zones so that the maximum ci will be as low as possible. Please help mayor to design a new assignment or determine if it\'s impossible to do. Please note that you only need to assign the fare zones optimally, you don\'t need to print lines\' directions. This way, you solution will be considered correct if there will be a way to assign directions of every metro line, so that the fare zones will be strictly increasing along any movement of the trains." 3500
1322E "Median Mountain Range" "data structures" "BerlandÂ \xe2\x80\x94 is a huge country with diverse geography. One of the most famous natural attractions of Berland is the ""Median mountain range"". This mountain range is n mountain peaks, located on one straight line and numbered in order of 1 to n. The height of the i-th mountain top is ai. ""Median mountain range"" is famous for the so called alignment of mountain peaks happening to it every day. At the moment of alignment simultaneously for each mountain from 2 to n\xe2\x88\x921 its height becomes equal to the median height among it and two neighboring mountains. Formally, if before the alignment the heights were equal bi, then after the alignment new heights ai are as follows: a1=b1, an=bn and for all i from 2 to n\xe2\x88\x921 ai=median(bi\xe2\x88\x921,bi,bi+1). The median of three integers is the second largest number among them. For example, median(5,1,2)=2, and median(4,2,4)=4.Recently, Berland scientists have proved that whatever are the current heights of the mountains, the alignment process will stabilize sooner or later, i.e. at some point the altitude of the mountains won\'t changing after the alignment any more. The government of Berland wants to understand how soon it will happen, i.e. to find the value of cÂ \xe2\x80\x94 how many alignments will occur, which will change the height of at least one mountain. Also, the government of Berland needs to determine the heights of the mountains after c alignments, that is, find out what heights of the mountains stay forever. Help scientists solve this important problem!" 3300
1322D "Reality Show" bitmasks,dp "A popular reality show is recruiting a new cast for the third season! n candidates numbered from 1 to n have been interviewed. The candidate i has aggressiveness level li, and recruiting this candidate will cost the show si roubles.The show host reviewes applications of all candidates from i=1 to i=n by increasing of their indices, and for each of them she decides whether to recruit this candidate or not. If aggressiveness level of the candidate i is strictly higher than that of any already accepted candidates, then the candidate i will definitely be rejected. Otherwise the host may accept or reject this candidate at her own discretion. The host wants to choose the cast so that to maximize the total profit.The show makes revenue as follows. For each aggressiveness level v a corresponding profitability value cv is specified, which can be positive as well as negative. All recruited participants enter the stage one by one by increasing of their indices. When the participant i enters the stage, events proceed as follows:  The show makes cli roubles, where li is initial aggressiveness level of the participant i.  If there are two participants with the same aggressiveness level on stage, they immediately start a fight. The outcome of this is:  the defeated participant is hospitalized and leaves the show.  aggressiveness level of the victorious participant is increased by one, and the show makes ct roubles, where t is the new aggressiveness level.  The fights continue until all participants on stage have distinct aggressiveness levels. It is allowed to select an empty set of participants (to choose neither of the candidates).The host wants to recruit the cast so that the total profit is maximized. The profit is calculated as the total revenue from the events on stage, less the total expenses to recruit all accepted participants (that is, their total si). Help the host to make the show as profitable as possible." 2800
1322C "Instant Noodles" "graphs,hashing,math,number theory" "Wu got hungry after an intense training session, and came to a nearby store to buy his favourite instant noodles. After Wu paid for his purchase, the cashier gave him an interesting task.You are given a bipartite graph with positive integers in all vertices of the right half. For a subset S of vertices of the left half we define N(S) as the set of all vertices of the right half adjacent to at least one vertex in S, and f(S) as the sum of all numbers in vertices of N(S). Find the greatest common divisor of f(S) for all possible non-empty subsets S (assume that GCD of empty set is 0).Wu is too tired after his training to solve this problem. Help him!" 2300
1322B Present "binary search,bitmasks,constructive algorithms,data structures,math,sortings" "Catherine received an array of integers as a gift for March 8. Eventually she grew bored with it, and she started calculated various useless characteristics for it. She succeeded to do it for each one she came up with. But when she came up with another oneÂ \xe2\x80\x94 xor of all pairwise sums of elements in the array, she realized that she couldn\'t compute it for a very large array, thus she asked for your help. Can you do it? Formally, you need to compute(a1+a2)\xe2\x8a\x95(a1+a3)\xe2\x8a\x95\xe2\x80\xa6\xe2\x8a\x95(a1+an)\xe2\x8a\x95(a2+a3)\xe2\x8a\x95\xe2\x80\xa6\xe2\x8a\x95(a2+an)\xe2\x80\xa6\xe2\x8a\x95(an\xe2\x88\x921+an)Here x\xe2\x8a\x95y is a bitwise XOR operation (i.e. x ^ y in many modern programming languages). You can read about it in Wikipedia: https://en.wikipedia.org/wiki/Exclusive_or#Bitwise_operation." 2100
1322A "Unusual Competitions" greedy "A bracketed sequence is called correct (regular) if by inserting ""+"" and ""1"" you can get a well-formed mathematical expression from it. For example, sequences ""(())()"", ""()"" and ""(()(()))"" are correct, while "")("", ""(()"" and ""(()))("" are not.The teacher gave Dmitry\'s class a very strange taskÂ \xe2\x80\x94 she asked every student to come up with a sequence of arbitrary length, consisting only of opening and closing brackets. After that all the students took turns naming the sequences they had invented. When Dima\'s turn came, he suddenly realized that all his classmates got the correct bracketed sequence, and whether he got the correct bracketed sequence, he did not know.Dima suspects now that he simply missed the word ""correct"" in the task statement, so now he wants to save the situation by modifying his sequence slightly. More precisely, he can the arbitrary number of times (possibly zero) perform the reorder operation.The reorder operation consists of choosing an arbitrary consecutive subsegment (substring) of the sequence and then reordering all the characters in it in an arbitrary way. Such operation takes l nanoseconds, where l is the length of the subsegment being reordered. It\'s easy to see that reorder operation doesn\'t change the number of opening and closing brackets. For example for ""))(("" he can choose the substring "")("" and do reorder "")()("" (this operation will take 2 nanoseconds).Since Dima will soon have to answer, he wants to make his sequence correct as fast as possible. Help him to do this, or determine that it\'s impossible." 1300
1321C "Remove Adjacent" "brute force,constructive algorithms,greedy,strings" "You are given a string s consisting of lowercase Latin letters. Let the length of s be |s|. You may perform several operations on this string.In one operation, you can choose some index i and remove the i-th character of s (si) if at least one of its adjacent characters is the previous letter in the Latin alphabet for si. For example, the previous letter for b is a, the previous letter for s is r, the letter a has no previous letters. Note that after each removal the length of the string decreases by one. So, the index i should satisfy the condition 1\xe2\x89\xa4i\xe2\x89\xa4|s| during each operation.For the character si adjacent characters are si\xe2\x88\x921 and si+1. The first and the last characters of s both have only one adjacent character (unless |s|=1).Consider the following example. Let s= bacabcab.  During the first move, you can remove the first character s1= b because s2= a. Then the string becomes s= acabcab.  During the second move, you can remove the fifth character s5= c because s4= b. Then the string becomes s= acabab.  During the third move, you can remove the sixth character s6=\'b\' because s5= a. Then the string becomes s= acaba.  During the fourth move, the only character you can remove is s4= b, because s3= a (or s5= a). The string becomes s= acaa and you cannot do anything with it. Your task is to find the maximum possible number of characters you can remove if you choose the sequence of operations optimally." 1600
1321A "Contest for Robots" greedy "Polycarp is preparing the first programming contest for robots. There are n problems in it, and a lot of robots are going to participate in it. Each robot solving the problem i gets pi points, and the score of each robot in the competition is calculated as the sum of pi over all problems i solved by it. For each problem, pi is an integer not less than 1.Two corporations specializing in problem-solving robot manufacturing, ""Robo-Coder Inc."" and ""BionicSolver Industries"", are going to register two robots (one for each corporation) for participation as well. Polycarp knows the advantages and flaws of robots produced by these companies, so, for each problem, he knows precisely whether each robot will solve it during the competition. Knowing this, he can try predicting the results \xe2\x80\x94 or manipulating them. For some reason (which absolutely cannot involve bribing), Polycarp wants the ""Robo-Coder Inc."" robot to outperform the ""BionicSolver Industries"" robot in the competition. Polycarp wants to set the values of pi in such a way that the ""Robo-Coder Inc."" robot gets strictly more points than the ""BionicSolver Industries"" robot. However, if the values of pi will be large, it may look very suspicious \xe2\x80\x94 so Polycarp wants to minimize the maximum value of pi over all problems. Can you help Polycarp to determine the minimum possible upper bound on the number of points given for solving the problems?" 900
1320F "Blocks and Sensors" "brute force" "Polycarp plays a well-known computer game (we won\'t mention its name). Every object in this game consists of three-dimensional blocks \xe2\x80\x94 axis-aligned cubes of size 1\xc3\x971\xc3\x971. These blocks are unaffected by gravity, so they can float in the air without support. The blocks are placed in cells of size 1\xc3\x971\xc3\x971; each cell either contains exactly one block or is empty. Each cell is represented by its coordinates (x,y,z) (the cell with these coordinates is a cube with opposite corners in (x,y,z) and (x+1,y+1,z+1)) and its contents ax,y,z; if the cell is empty, then ax,y,z=0, otherwise ax,y,z is equal to the type of the block placed in it (the types are integers from 1 to 2\xe2\x8b\x85105).Polycarp has built a large structure consisting of blocks. This structure can be enclosed in an axis-aligned rectangular parallelepiped of size n\xc3\x97m\xc3\x97k, containing all cells (x,y,z) such that x\xe2\x88\x88[1,n], y\xe2\x88\x88[1,m], and z\xe2\x88\x88[1,k]. After that, Polycarp has installed 2nm+2nk+2mk sensors around this parallelepiped. A sensor is a special block that sends a ray in some direction and shows the type of the first block that was hit by this ray (except for other sensors). The sensors installed by Polycarp are adjacent to the borders of the parallelepiped, and the rays sent by them are parallel to one of the coordinate axes and directed inside the parallelepiped. More formally, the sensors can be divided into 6 types:  there are mk sensors of the first type; each such sensor is installed in (0,y,z), where y\xe2\x88\x88[1,m] and z\xe2\x88\x88[1,k], and it sends a ray that is parallel to the Ox axis and has the same direction;  there are mk sensors of the second type; each such sensor is installed in (n+1,y,z), where y\xe2\x88\x88[1,m] and z\xe2\x88\x88[1,k], and it sends a ray that is parallel to the Ox axis and has the opposite direction;  there are nk sensors of the third type; each such sensor is installed in (x,0,z), where x\xe2\x88\x88[1,n] and z\xe2\x88\x88[1,k], and it sends a ray that is parallel to the Oy axis and has the same direction;  there are nk sensors of the fourth type; each such sensor is installed in (x,m+1,z), where x\xe2\x88\x88[1,n] and z\xe2\x88\x88[1,k], and it sends a ray that is parallel to the Oy axis and has the opposite direction;  there are nm sensors of the fifth type; each such sensor is installed in (x,y,0), where x\xe2\x88\x88[1,n] and y\xe2\x88\x88[1,m], and it sends a ray that is parallel to the Oz axis and has the same direction;  finally, there are nm sensors of the sixth type; each such sensor is installed in (x,y,k+1), where x\xe2\x88\x88[1,n] and y\xe2\x88\x88[1,m], and it sends a ray that is parallel to the Oz axis and has the opposite direction. Polycarp has invited his friend Monocarp to play with him. Of course, as soon as Monocarp saw a large parallelepiped bounded by sensor blocks, he began to wonder what was inside of it. Polycarp didn\'t want to tell Monocarp the exact shape of the figure, so he provided Monocarp with the data from all sensors and told him to try guessing the contents of the parallelepiped by himself.After some hours of thinking, Monocarp has no clue about what\'s inside the sensor-bounded space. But he does not want to give up, so he decided to ask for help. Can you write a program that will analyze the sensor data and construct any figure that is consistent with it?" 3500
1320E "Treeland and Viruses" "data structures,dfs and similar,dp,shortest paths,trees" "There are n cities in Treeland connected with n\xe2\x88\x921 bidirectional roads in such that a way that any city is reachable from any other; in other words, the graph of cities and roads is a tree. Treeland is preparing for a seasonal virus epidemic, and currently, they are trying to evaluate different infection scenarios.In each scenario, several cities are initially infected with different virus species. Suppose that there are ki virus species in the i-th scenario. Let us denote vj the initial city for the virus j, and sj the propagation speed of the virus j. The spread of the viruses happens in turns: first virus 1 spreads, followed by virus 2, and so on. After virus ki spreads, the process starts again from virus 1.A spread turn of virus j proceeds as follows. For each city x not infected with any virus at the start of the turn, at the end of the turn it becomes infected with virus j if and only if there is such a city y that: city y was infected with virus j at the start of the turn; the path between cities x and y contains at most sj edges; all cities on the path between cities x and y (excluding y) were uninfected with any virus at the start of the turn.Once a city is infected with a virus, it stays infected indefinitely and can not be infected with any other virus. The spread stops once all cities are infected.You need to process q independent scenarios. Each scenario is described by ki virus species and mi important cities. For each important city determine which the virus it will be infected by in the end." 3000
1320D "Reachable Strings" "data structures,hashing,strings" "In this problem, we will deal with binary strings. Each character of a binary string is either a 0 or a 1. We will also deal with substrings; recall that a substring is a contiguous subsequence of a string. We denote the substring of string s starting from the l-th character and ending with the r-th character as s[l\xe2\x80\xa6r]. The characters of each string are numbered from 1.We can perform several operations on the strings we consider. Each operation is to choose a substring of our string and replace it with another string. There are two possible types of operations: replace 011 with 110, or replace 110 with 011. For example, if we apply exactly one operation to the string 110011110, it can be transformed into 011011110, 110110110, or 110011011.Binary string a is considered reachable from binary string b if there exists a sequence s1, s2, ..., sk such that s1=a, sk=b, and for every i\xe2\x88\x88[1,k\xe2\x88\x921], si can be transformed into si+1 using exactly one operation. Note that k can be equal to 1, i.\xe2\x80\x89e., every string is reachable from itself.You are given a string t and q queries to it. Each query consists of three integers l1, l2 and len. To answer each query, you have to determine whether t[l1\xe2\x80\xa6l1+len\xe2\x88\x921] is reachable from t[l2\xe2\x80\xa6l2+len\xe2\x88\x921]." 2500
1320C "World of Darkraft: Battle for Azathoth" "brute force,data structures,sortings" "Roma is playing a new expansion for his favorite game World of Darkraft. He made a new character and is going for his first grind.Roma has a choice to buy exactly one of n different weapons and exactly one of m different armor sets. Weapon i has attack modifier ai and is worth cai coins, and armor set j has defense modifier bj and is worth cbj coins.After choosing his equipment Roma can proceed to defeat some monsters. There are p monsters he can try to defeat. Monster k has defense xk, attack yk and possesses zk coins. Roma can defeat a monster if his weapon\'s attack modifier is larger than the monster\'s defense, and his armor set\'s defense modifier is larger than the monster\'s attack. That is, a monster k can be defeated with a weapon i and an armor set j if ai>xk and bj>yk. After defeating the monster, Roma takes all the coins from them. During the grind, Roma can defeat as many monsters as he likes. Monsters do not respawn, thus each monster can be defeated at most one.Thanks to Roma\'s excessive donations, we can assume that he has an infinite amount of in-game currency and can afford any of the weapons and armor sets. Still, he wants to maximize the profit of the grind. The profit is defined as the total coins obtained from all defeated monsters minus the cost of his equipment. Note that Roma must purchase a weapon and an armor set even if he can not cover their cost with obtained coins.Help Roma find the maximum profit of the grind." 2000
1320B "Navigation System" "dfs and similar,graphs,shortest paths" "The map of Bertown can be represented as a set of n intersections, numbered from 1 to n and connected by m one-way roads. It is possible to move along the roads from any intersection to any other intersection. The length of some path from one intersection to another is the number of roads that one has to traverse along the path. The shortest path from one intersection v to another intersection u is the path that starts in v, ends in u and has the minimum length among all such paths.Polycarp lives near the intersection s and works in a building near the intersection t. Every day he gets from s to t by car. Today he has chosen the following path to his workplace: p1, p2, ..., pk, where p1=s, pk=t, and all other elements of this sequence are the intermediate intersections, listed in the order Polycarp arrived at them. Polycarp never arrived at the same intersection twice, so all elements of this sequence are pairwise distinct. Note that you know Polycarp\'s path beforehand (it is fixed), and it is not necessarily one of the shortest paths from s to t.Polycarp\'s car has a complex navigation system installed in it. Let\'s describe how it works. When Polycarp starts his journey at the intersection s, the system chooses some shortest path from s to t and shows it to Polycarp. Let\'s denote the next intersection in the chosen path as v. If Polycarp chooses to drive along the road from s to v, then the navigator shows him the same shortest path (obviously, starting from v as soon as he arrives at this intersection). However, if Polycarp chooses to drive to another intersection w instead, the navigator rebuilds the path: as soon as Polycarp arrives at w, the navigation system chooses some shortest path from w to t and shows it to Polycarp. The same process continues until Polycarp arrives at t: if Polycarp moves along the road recommended by the system, it maintains the shortest path it has already built; but if Polycarp chooses some other path, the system rebuilds the path by the same rules.Here is an example. Suppose the map of Bertown looks as follows, and Polycarp drives along the path [1,2,3,4] (s=1, t=4): Check the picture by the link http://tk.codeforces.com/a.png   When Polycarp starts at 1, the system chooses some shortest path from 1 to 4. There is only one such path, it is [1,5,4];  Polycarp chooses to drive to 2, which is not along the path chosen by the system. When Polycarp arrives at 2, the navigator rebuilds the path by choosing some shortest path from 2 to 4, for example, [2,6,4] (note that it could choose [2,3,4]);  Polycarp chooses to drive to 3, which is not along the path chosen by the system. When Polycarp arrives at 3, the navigator rebuilds the path by choosing the only shortest path from 3 to 4, which is [3,4];  Polycarp arrives at 4 along the road chosen by the navigator, so the system does not have to rebuild anything. Overall, we get 2 rebuilds in this scenario. Note that if the system chose [2,3,4] instead of [2,6,4] during the second step, there would be only 1 rebuild (since Polycarp goes along the path, so the system maintains the path [3,4] during the third step).The example shows us that the number of rebuilds can differ even if the map of Bertown and the path chosen by Polycarp stays the same. Given this information (the map and Polycarp\'s path), can you determine the minimum and the maximum number of rebuilds that could have happened during the journey?" 1700
1320A "Journey Planning" "data structures,dp,greedy,math,sortings" "Tanya wants to go on a journey across the cities of Berland. There are n cities situated along the main railroad line of Berland, and these cities are numbered from 1 to n. Tanya plans her journey as follows. First of all, she will choose some city c1 to start her journey. She will visit it, and after that go to some other city c2>c1, then to some other city c3>c2, and so on, until she chooses to end her journey in some city ck>ck\xe2\x88\x921. So, the sequence of visited cities [c1,c2,\xe2\x80\xa6,ck] should be strictly increasing.There are some additional constraints on the sequence of cities Tanya visits. Each city i has a beauty value bi associated with it. If there is only one city in Tanya\'s journey, these beauty values imply no additional constraints. But if there are multiple cities in the sequence, then for any pair of adjacent cities ci and ci+1, the condition ci+1\xe2\x88\x92ci=bci+1\xe2\x88\x92bci must hold.For example, if n=8 and b=[3,4,4,6,6,7,8,9], there are several three possible ways to plan a journey:  c=[1,2,4];  c=[3,5,6,8];  c=[7] (a journey consisting of one city is also valid). There are some additional ways to plan a journey that are not listed above.Tanya wants her journey to be as beautiful as possible. The beauty value of the whole journey is the sum of beauty values over all visited cities. Can you help her to choose the optimal plan, that is, to maximize the beauty value of the journey?" 1400
1316F "Battalion Strength" "data structures,divide and conquer,probabilities" "There are n officers in the Army of Byteland. Each officer has some power associated with him. The power of the i-th officer is denoted by pi. As the war is fast approaching, the General would like to know the strength of the army.The strength of an army is calculated in a strange way in Byteland. The General selects a random subset of officers from these n officers and calls this subset a battalion.(All 2n subsets of the n officers can be chosen equally likely, including empty subset and the subset of all officers).The strength of a battalion is calculated in the following way:Let the powers of the chosen officers be a1,a2,\xe2\x80\xa6,ak, where a1\xe2\x89\xa4a2\xe2\x89\xa4\xe2\x8b\xaf\xe2\x89\xa4ak. The strength of this battalion is equal to a1a2+a2a3+\xe2\x8b\xaf+ak\xe2\x88\x921ak. (If the size of Battalion is \xe2\x89\xa41, then the strength of this battalion is 0).The strength of the army is equal to the expected value of the strength of the battalion.As the war is really long, the powers of officers may change. Precisely, there will be q changes. Each one of the form i x indicating that pi is changed to x.You need to find the strength of the army initially and after each of these q updates.Note that the changes are permanent.The strength should be found by modulo 109+7. Formally, let M=109+7. It can be shown that the answer can be expressed as an irreducible fraction p/q, where p and q are integers and q\xe2\x89\xa20modM). Output the integer equal to p\xe2\x8b\x85q\xe2\x88\x921modM. In other words, output such an integer x that 0\xe2\x89\xa4x<M and x\xe2\x8b\x85q\xe2\x89\xa1pmodM)." 2800
1316E "Team Building" bitmasks,dp,greedy,sortings "Alice, the president of club FCB, wants to build a team for the new volleyball tournament. The team should consist of p players playing in p different positions. She also recognizes the importance of audience support, so she wants to select k people as part of the audience.There are n people in Byteland. Alice needs to select exactly p players, one for each position, and exactly k members of the audience from this pool of n people. Her ultimate goal is to maximize the total strength of the club.The i-th of the n persons has an integer ai associated with himÂ \xe2\x80\x94 the strength he adds to the club if he is selected as a member of the audience.For each person i and for each position j, Alice knows si,j Â \xe2\x80\x94 the strength added by the i-th person to the club if he is selected to play in the j-th position.Each person can be selected at most once as a player or a member of the audience. You have to choose exactly one player for each position.Since Alice is busy, she needs you to help her find the maximum possible strength of the club that can be achieved by an optimal choice of players and the audience." 2300
1316D "Nash Matrix" "constructive algorithms,dfs and similar,graphs,implementation" "Nash designed an interesting yet simple board game where a player is simply required to follow instructions written on the cell where the player currently stands. This board game is played on the n\xc3\x97n board. Rows and columns of this board are numbered from 1 to n. The cell on the intersection of the r-th row and c-th column is denoted by (r,c).Some cells on the board are called blocked zones. On each cell of the board, there is written one of the following 5 characters Â \xe2\x80\x94 U, D, L, R or X Â \xe2\x80\x94 instructions for the player. Suppose that the current cell is (r,c). If the character is R, the player should move to the right cell (r,c+1), for L the player should move to the left cell (r,c\xe2\x88\x921), for U the player should move to the top cell (r\xe2\x88\x921,c), for D the player should move to the bottom cell (r+1,c). Finally, if the character in the cell is X, then this cell is the blocked zone. The player should remain in this cell (the game for him isn\'t very interesting from now on).It is guaranteed that the characters are written in a way that the player will never have to step outside of the board, no matter at which cell he starts.As a player starts from a cell, he moves according to the character in the current cell. The player keeps moving until he lands in a blocked zone. It is also possible that the player will keep moving infinitely long.For every of the n2 cells of the board Alice, your friend, wants to know, how will the game go, if the player starts in this cell. For each starting cell of the board, she writes down the cell that the player stops at, or that the player never stops at all. She gives you the information she has written: for each cell (r,c) she wrote:   a pair (x,y), meaning if a player had started at (r,c), he would end up at cell (x,y).  or a pair (\xe2\x88\x921,\xe2\x88\x921), meaning if a player had started at (r,c), he would keep moving infinitely long and would never enter the blocked zone. It might be possible that Alice is trying to fool you and there\'s no possible grid that satisfies all the constraints Alice gave you. For the given information Alice provided you, you are required to decipher a possible board, or to determine that such a board doesn\'t exist. If there exist several different boards that satisfy the provided information, you can find any of them." 2000
1316C "Primitive Primes" "constructive algorithms,math,ternary search" "It is Professor R\'s last class of his teaching career. Every time Professor R taught a class, he gave a special problem for the students to solve. You being his favourite student, put your heart into solving it one last time.You are given two polynomials f(x)=a0+a1x+\xe2\x8b\xaf+an\xe2\x88\x921xn\xe2\x88\x921 and g(x)=b0+b1x+\xe2\x8b\xaf+bm\xe2\x88\x921xm\xe2\x88\x921, with positive integral coefficients. It is guaranteed that the cumulative GCD of the coefficients is equal to 1 for both the given polynomials. In other words, gcd(a0,a1,\xe2\x80\xa6,an\xe2\x88\x921)=gcd(b0,b1,\xe2\x80\xa6,bm\xe2\x88\x921)=1. Let h(x)=f(x)\xe2\x8b\x85g(x). Suppose that h(x)=c0+c1x+\xe2\x8b\xaf+cn+m\xe2\x88\x922xn+m\xe2\x88\x922. You are also given a prime number p. Professor R challenges you to find any t such that ct isn\'t divisible by p. He guarantees you that under these conditions such t always exists. If there are several such t, output any of them.As the input is quite large, please use fast input reading methods." 1800
1316B "String Modification" "brute force,constructive algorithms,implementation,sortings,strings" "Vasya has a string s of length n. He decides to make the following modification to the string:   Pick an integer k, (1\xe2\x89\xa4k\xe2\x89\xa4n).  For i from 1 to n\xe2\x88\x92k+1, reverse the substring s[i:i+k\xe2\x88\x921] of s. For example, if string s is qwer and k=2, below is the series of transformations the string goes through:   qwer (original string)  wqer (after reversing the first substring of length 2)  weqr (after reversing the second substring of length 2)  werq (after reversing the last substring of length 2)  Hence, the resulting string after modifying s with k=2 is werq. Vasya wants to choose a k such that the string obtained after the above-mentioned modification is lexicographically smallest possible among all choices of k. Among all such k, he wants to choose the smallest one. Since he is busy attending Felicity 2020, he asks for your help.A string a is lexicographically smaller than a string b if and only if one of the following holds:   a is a prefix of b, but a\xe2\x89\xa0b;  in the first position where a and b differ, the string a has a letter that appears earlier in the alphabet than the corresponding letter in b." 1400
1316A "Grade Allocation" implementation "n students are taking an exam. The highest possible score at this exam is m. Let ai be the score of the i-th student. You have access to the school database which stores the results of all students.You can change each student\'s score as long as the following conditions are satisfied:   All scores are integers  0\xe2\x89\xa4ai\xe2\x89\xa4m  The average score of the class doesn\'t change. You are student 1 and you would like to maximize your own score.Find the highest possible score you can assign to yourself such that all conditions are satisfied." 800
1315C "Restoring Permutation" greedy "You are given a sequence b1,b2,\xe2\x80\xa6,bn. Find the lexicographically minimal permutation a1,a2,\xe2\x80\xa6,a2n such that bi=min(a2i\xe2\x88\x921,a2i), or determine that it is impossible." 1200
1315B Homecoming "binary search,dp,greedy,strings" "After a long party Petya decided to return home, but he turned out to be at the opposite end of the town from his home. There are n crossroads in the line in the town, and there is either the bus or the tram station at each crossroad.The crossroads are represented as a string s of length n, where si=A, if there is a bus station at i-th crossroad, and si=B, if there is a tram station at i-th crossroad. Currently Petya is at the first crossroad (which corresponds to s1) and his goal is to get to the last crossroad (which corresponds to sn).If for two crossroads i and j for all crossroads i,i+1,\xe2\x80\xa6,j\xe2\x88\x921 there is a bus station, one can pay a roubles for the bus ticket, and go from i-th crossroad to the j-th crossroad by the bus (it is not necessary to have a bus station at the j-th crossroad). Formally, paying a roubles Petya can go from i to j if st=A for all i\xe2\x89\xa4t<j. If for two crossroads i and j for all crossroads i,i+1,\xe2\x80\xa6,j\xe2\x88\x921 there is a tram station, one can pay b roubles for the tram ticket, and go from i-th crossroad to the j-th crossroad by the tram (it is not necessary to have a tram station at the j-th crossroad). Formally, paying b roubles Petya can go from i to j if st=B for all i\xe2\x89\xa4t<j.For example, if s=""AABBBAB"", a=4 and b=3 then Petya needs:  buy one bus ticket to get from 1 to 3,  buy one tram ticket to get from 3 to 6,  buy one bus ticket to get from 6 to 7. Thus, in total he needs to spend 4+3+4=11 roubles. Please note that the type of the stop at the last crossroad (i.e. the character sn) does not affect the final expense.Now Petya is at the first crossroad, and he wants to get to the n-th crossroad. After the party he has left with p roubles. He\'s decided to go to some station on foot, and then go to home using only public transport.Help him to choose the closest crossroad i to go on foot the first, so he has enough money to get from the i-th crossroad to the n-th, using only tram and bus tickets." 1300
1315A "Dead Pixel" implementation "Screen resolution of Polycarp\'s monitor is a\xc3\x97b pixels. Unfortunately, there is one dead pixel at his screen. It has coordinates (x,y) (0\xe2\x89\xa4x<a,0\xe2\x89\xa4y<b). You can consider columns of pixels to be numbered from 0 to a\xe2\x88\x921, and rowsÂ \xe2\x80\x94 from 0 to b\xe2\x88\x921.Polycarp wants to open a rectangular window of maximal size, which doesn\'t contain the dead pixel. The boundaries of the window should be parallel to the sides of the screen.Print the maximal area (in pixels) of a window that doesn\'t contain the dead pixel inside itself." 800
1313E "Concatenation with intersection" "data structures,hashing,strings,two pointers" "Vasya had three strings a, b and s, which consist of lowercase English letters. The lengths of strings a and b are equal to n, the length of the string s is equal to m. Vasya decided to choose a substring of the string a, then choose a substring of the string b and concatenate them. Formally, he chooses a segment [l1,r1] (1\xe2\x89\xa4l1\xe2\x89\xa4r1\xe2\x89\xa4n) and a segment [l2,r2] (1\xe2\x89\xa4l2\xe2\x89\xa4r2\xe2\x89\xa4n), and after concatenation he obtains a string a[l1,r1]+b[l2,r2]=al1al1+1\xe2\x80\xa6ar1bl2bl2+1\xe2\x80\xa6br2.Now, Vasya is interested in counting number of ways to choose those segments adhering to the following conditions:  segments [l1,r1] and [l2,r2] have non-empty intersection, i.e. there exists at least one integer x, such that l1\xe2\x89\xa4x\xe2\x89\xa4r1 and l2\xe2\x89\xa4x\xe2\x89\xa4r2;  the string a[l1,r1]+b[l2,r2] is equal to the string s." 2700
1313D "Happy New Year" bitmasks,dp,implementation "Being Santa Claus is very difficult. Sometimes you have to deal with difficult situations.Today Santa Claus came to the holiday and there were m children lined up in front of him. Let\'s number them from 1 to m. Grandfather Frost knows n spells. The i-th spell gives a candy to every child whose place is in the [Li,Ri] range. Each spell can be used at most once. It is also known that if all spells are used, each child will receive at most k candies.It is not good for children to eat a lot of sweets, so each child can eat no more than one candy, while the remaining candies will be equally divided between his (or her) Mom and Dad. So it turns out that if a child would be given an even amount of candies (possibly zero), then he (or she) will be unable to eat any candies and will go sad. However, the rest of the children (who received an odd number of candies) will be happy.Help Santa Claus to know the maximum number of children he can make happy by casting some of his spells." 2500
1313C2 "Skyscrapers (hard version)" "data structures,dp,greedy" "This is a harder version of the problem. In this version n\xe2\x89\xa4500000The outskirts of the capital are being actively built up in Berland. The company ""Kernel Panic"" manages the construction of a residential complex of skyscrapers in New Berlskva. All skyscrapers are built along the highway. It is known that the company has already bought n plots along the highway and is preparing to build n skyscrapers, one skyscraper per plot.Architects must consider several requirements when planning a skyscraper. Firstly, since the land on each plot has different properties, each skyscraper has a limit on the largest number of floors it can have. Secondly, according to the design code of the city, it is unacceptable for a skyscraper to simultaneously have higher skyscrapers both to the left and to the right of it.Formally, let\'s number the plots from 1 to n. Then if the skyscraper on the i-th plot has ai floors, it must hold that ai is at most mi (1\xe2\x89\xa4ai\xe2\x89\xa4mi). Also there mustn\'t be integers j and k such that j<i<k and aj>ai<ak. Plots j and k are not required to be adjacent to i.The company wants the total number of floors in the built skyscrapers to be as large as possible. Help it to choose the number of floors for each skyscraper in an optimal way, i.e. in such a way that all requirements are fulfilled, and among all such construction plans choose any plan with the maximum possible total number of floors." 1900
1313C1 "Skyscrapers (easy version)" "brute force,data structures,dp,greedy" "This is an easier version of the problem. In this version n\xe2\x89\xa41000The outskirts of the capital are being actively built up in Berland. The company ""Kernel Panic"" manages the construction of a residential complex of skyscrapers in New Berlskva. All skyscrapers are built along the highway. It is known that the company has already bought n plots along the highway and is preparing to build n skyscrapers, one skyscraper per plot.Architects must consider several requirements when planning a skyscraper. Firstly, since the land on each plot has different properties, each skyscraper has a limit on the largest number of floors it can have. Secondly, according to the design code of the city, it is unacceptable for a skyscraper to simultaneously have higher skyscrapers both to the left and to the right of it.Formally, let\'s number the plots from 1 to n. Then if the skyscraper on the i-th plot has ai floors, it must hold that ai is at most mi (1\xe2\x89\xa4ai\xe2\x89\xa4mi). Also there mustn\'t be integers j and k such that j<i<k and aj>ai<ak. Plots j and k are not required to be adjacent to i.The company wants the total number of floors in the built skyscrapers to be as large as possible. Help it to choose the number of floors for each skyscraper in an optimal way, i.e. in such a way that all requirements are fulfilled, and among all such construction plans choose any plan with the maximum possible total number of floors." 1500
1313B "Different Rules" "constructive algorithms,greedy,implementation,math" "Nikolay has only recently started in competitive programming, but already qualified to the finals of one prestigious olympiad. There going to be n participants, one of whom is Nikolay. Like any good olympiad, it consists of two rounds. Tired of the traditional rules, in which the participant who solved the largest number of problems wins, the organizers came up with different rules.Suppose in the first round participant A took x-th place and in the second roundÂ \xe2\x80\x94 y-th place. Then the total score of the participant A is sum x+y. The overall place of the participant A is the number of participants (including A) having their total score less than or equal to the total score of A. Note, that some participants may end up having a common overall place. It is also important to note, that in both the first and the second round there were no two participants tying at a common place. In other words, for every i from 1 to n exactly one participant took i-th place in first round and exactly one participant took i-th place in second round.Right after the end of the Olympiad, Nikolay was informed that he got x-th place in first round and y-th place in the second round. Nikolay doesn\'t know the results of other participants, yet he wonders what is the minimum and maximum place he can take, if we consider the most favorable and unfavorable outcome for him. Please help Nikolay to find the answer to this question." 1700
1313A "Fast Food Restaurant" "brute force,greedy,implementation" "Tired of boring office work, Denis decided to open a fast food restaurant.On the first day he made a portions of dumplings, b portions of cranberry juice and c pancakes with condensed milk.The peculiarity of Denis\'s restaurant is the procedure of ordering food. For each visitor Denis himself chooses a set of dishes that this visitor will receive. When doing so, Denis is guided by the following rules:  every visitor should receive at least one dish (dumplings, cranberry juice, pancakes with condensed milk are all considered to be dishes);  each visitor should receive no more than one portion of dumplings, no more than one portion of cranberry juice and no more than one pancake with condensed milk;  all visitors should receive different sets of dishes. What is the maximum number of visitors Denis can feed?" 900
1312G Autocompletion "data structures,dfs and similar,dp" "You are given a set of strings S. Each string consists of lowercase Latin letters.For each string in this set, you want to calculate the minimum number of seconds required to type this string. To type a string, you have to start with an empty string and transform it into the string you want to type using the following actions:  if the current string is t, choose some lowercase Latin letter c and append it to the back of t, so the current string becomes t+c. This action takes 1 second;  use autocompletion. When you try to autocomplete the current string t, a list of all strings s\xe2\x88\x88S such that t is a prefix of s is shown to you. This list includes t itself, if t is a string from S, and the strings are ordered lexicographically. You can transform t into the i-th string from this list in i seconds. Note that you may choose any string from this list you want, it is not necessarily the string you are trying to type. What is the minimum number of seconds that you have to spend to type each string from S?Note that the strings from S are given in an unusual way." 2600
1312F "Attack on Red Kingdom" "games,two pointers" "The Red Kingdom is attacked by the White King and the Black King!The Kingdom is guarded by n castles, the i-th castle is defended by ai soldiers. To conquer the Red Kingdom, the Kings have to eliminate all the defenders. Each day the White King launches an attack on one of the castles. Then, at night, the forces of the Black King attack a castle (possibly the same one). Then the White King attacks a castle, then the Black King, and so on. The first attack is performed by the White King.Each attack must target a castle with at least one alive defender in it. There are three types of attacks:  a mixed attack decreases the number of defenders in the targeted castle by x (or sets it to 0 if there are already less than x defenders);  an infantry attack decreases the number of defenders in the targeted castle by y (or sets it to 0 if there are already less than y defenders);  a cavalry attack decreases the number of defenders in the targeted castle by z (or sets it to 0 if there are already less than z defenders). The mixed attack can be launched at any valid target (at any castle with at least one soldier). However, the infantry attack cannot be launched if the previous attack on the targeted castle had the same type, no matter when and by whom it was launched. The same applies to the cavalry attack. A castle that was not attacked at all can be targeted by any type of attack.The King who launches the last attack will be glorified as the conqueror of the Red Kingdom, so both Kings want to launch the last attack (and they are wise enough to find a strategy that allows them to do it no matter what are the actions of their opponent, if such strategy exists). The White King is leading his first attack, and you are responsible for planning it. Can you calculate the number of possible options for the first attack that allow the White King to launch the last attack? Each option for the first attack is represented by the targeted castle and the type of attack, and two options are different if the targeted castles or the types of attack are different." 2500
1312E "Array Shrinking" dp,greedy "You are given an array a1,a2,\xe2\x80\xa6,an. You can perform the following operation any number of times:  Choose a pair of two neighboring equal elements ai=ai+1 (if there is at least one such pair).  Replace them by one element with value ai+1. After each such operation, the length of the array will decrease by one (and elements are renumerated accordingly). What is the minimum possible length of the array a you can get?" 2100
1312D "Count the Arrays" combinatorics,math "Your task is to calculate the number of arrays such that:  each array contains n elements;  each element is an integer from 1 to m;  for each array, there is exactly one pair of equal elements;  for each array a, there exists an index i such that the array is strictly ascending before the i-th element and strictly descending after it (formally, it means that aj<aj+1, if j<i, and aj>aj+1, if j\xe2\x89\xa5i)." 1700
1312C "Adding Powers" "bitmasks,greedy,implementation,math,number theory,ternary search" "Suppose you are performing the following algorithm. There is an array v1,v2,\xe2\x80\xa6,vn filled with zeroes at start. The following operation is applied to the array several times \xe2\x80\x94 at i-th step (0-indexed) you can:   either choose position pos (1\xe2\x89\xa4pos\xe2\x89\xa4n) and increase vpos by ki;  or not choose any position and skip this step. You can choose how the algorithm would behave on each step and when to stop it. The question is: can you make array v equal to the given array a (vj=aj for each j) after some step?" 1400
1312B Bogosort "constructive algorithms,sortings" "You are given an array a1,a2,\xe2\x80\xa6,an. Array is good if for each pair of indexes i<j the condition j\xe2\x88\x92aj\xe2\x89\xa0i\xe2\x88\x92ai holds. Can you shuffle this array so that it becomes good? To shuffle an array means to reorder its elements arbitrarily (leaving the initial order is also an option).For example, if a=[1,1,3,5], then shuffled arrays [1,3,5,1], [3,5,1,1] and [5,3,1,1] are good, but shuffled arrays [3,1,5,1], [1,1,3,5] and [1,1,5,3] aren\'t.It\'s guaranteed that it\'s always possible to shuffle an array to meet this condition." 1000
1312A "Two Regular Polygons" "geometry,greedy,math,number theory" "You are given two integers n and m (m<n). Consider a convex regular polygon of n vertices. Recall that a regular polygon is a polygon that is equiangular (all angles are equal in measure) and equilateral (all sides have the same length).  Examples of convex regular polygons Your task is to say if it is possible to build another convex regular polygon with m vertices such that its center coincides with the center of the initial polygon and each of its vertices is some vertex of the initial polygon.You have to answer t independent test cases." 800
1311F "Moving Points" "data structures,divide and conquer,implementation,sortings" "There are n points on a coordinate axis OX. The i-th point is located at the integer point xi and has a speed vi. It is guaranteed that no two points occupy the same coordinate. All n points move with the constant speed, the coordinate of the i-th point at the moment t (t can be non-integer) is calculated as xi+t\xe2\x8b\x85vi.Consider two points i and j. Let d(i,j) be the minimum possible distance between these two points over any possible moments of time (even non-integer). It means that if two points i and j coincide at some moment, the value d(i,j) will be 0.Your task is to calculate the value \xe2\x88\x911\xe2\x89\xa4i<j\xe2\x89\xa4n d(i,j) (the sum of minimum distances over all pairs of points)." 1900
1311E "Construct the Binary Tree" "brute force,constructive algorithms,trees" "You are given two integers n and d. You need to construct a rooted binary tree consisting of n vertices with a root at the vertex 1 and the sum of depths of all vertices equals to d.A tree is a connected graph without cycles. A rooted tree has a special vertex called the root. A parent of a vertex v is the last different from v vertex on the path from the root to the vertex v. The depth of the vertex v is the length of the path from the root to the vertex v. Children of vertex v are all vertices for which v is the parent. The binary tree is such a tree that no vertex has more than 2 children.You have to answer t independent test cases." 2200
1311D "Three Integers" "brute force,math" "You are given three integers a\xe2\x89\xa4b\xe2\x89\xa4c.In one move, you can add +1 or \xe2\x88\x921 to any of these integers (i.e. increase or decrease any number by one). You can perform such operation any (possibly, zero) number of times, you can even perform this operation several times with one number. Note that you cannot make non-positive numbers using such operations.You have to perform the minimum number of such operations in order to obtain three integers A\xe2\x89\xa4B\xe2\x89\xa4C such that B is divisible by A and C is divisible by B.You have to answer t independent test cases." 2000
1311C "Perform the Combo" "brute force" "You want to perform the combo on your opponent in one popular fighting game. The combo is the string s consisting of n lowercase Latin letters. To perform the combo, you have to press all buttons in the order they appear in s. I.e. if s=""abca"" then you have to press \'a\', then \'b\', \'c\' and \'a\' again.You know that you will spend m wrong tries to perform the combo and during the i-th try you will make a mistake right after pi-th button (1\xe2\x89\xa4pi<n) (i.e. you will press first pi buttons right and start performing the combo from the beginning). It is guaranteed that during the m+1-th try you press all buttons right and finally perform the combo.I.e. if s=""abca"", m=2 and p=[1,3] then the sequence of pressed buttons will be \'a\' (here you\'re making a mistake and start performing the combo from the beginning), \'a\', \'b\', \'c\', (here you\'re making a mistake and start performing the combo from the beginning), \'a\' (note that at this point you will not perform the combo because of the mistake), \'b\', \'c\', \'a\'.Your task is to calculate for each button (letter) the number of times you\'ll press it.You have to answer t independent test cases." 1300
1311B WeirdSort "dfs and similar,sortings" "You are given an array a of length n.You are also given a set of distinct positions p1,p2,\xe2\x80\xa6,pm, where 1\xe2\x89\xa4pi<n. The position pi means that you can swap elements a[pi] and a[pi+1]. You can apply this operation any number of times for each of the given positions.Your task is to determine if it is possible to sort the initial array in non-decreasing order (a1\xe2\x89\xa4a2\xe2\x89\xa4\xe2\x8b\xaf\xe2\x89\xa4an) using only allowed swaps.For example, if a=[3,2,1] and p=[1,2], then we can first swap elements a[2] and a[3] (because position 2 is contained in the given set p). We get the array a=[3,1,2]. Then we swap a[1] and a[2] (position 1 is also contained in p). We get the array a=[1,3,2]. Finally, we swap a[2] and a[3] again and get the array a=[1,2,3], sorted in non-decreasing order.You can see that if a=[4,1,2,3] and p=[3,2] then you cannot sort the array.You have to answer t independent test cases." 1200
1311A "Add Odd or Subtract Even" greedy,implementation,math "You are given two positive integers a and b.In one move, you can change a in the following way:  Choose any positive odd integer x (x>0) and replace a with a+x;  choose any positive even integer y (y>0) and replace a with a\xe2\x88\x92y. You can perform as many such operations as you want. You can choose the same numbers x and y in different moves.Your task is to find the minimum number of moves required to obtain b from a. It is guaranteed that you can always obtain b from a.You have to answer t independent test cases." 800
1310F "Bad Cryptography" "math,number theory" "In modern cryptography much is tied to the algorithmic complexity of solving several problems. One of such problems is a discrete logarithm problem. It is formulated as follows:  Let\'s fix a finite field and two it\'s elements a and b. One need to fun such x that ax=b or detect there is no such x. It is most likely that modern mankind cannot solve the problem of discrete logarithm for a sufficiently large field size. For example, for a field of residues modulo prime number, primes of 1024 or 2048 bits are considered to be safe. However, calculations with such large numbers can place a significant load on servers that perform cryptographic operations. For this reason, instead of a simple module residue field, more complex fields are often used. For such field no fast algorithms that use a field structure are known, smaller fields can be used and operations can be properly optimized. Developer Nikolai does not trust the generally accepted methods, so he wants to invent his own. Recently, he read about a very strange fieldÂ \xe2\x80\x94 nimbers, and thinks it\'s a great fit for the purpose. The field of nimbers is defined on a set of integers from 0 to 22k\xe2\x88\x921 for some positive integer k . Bitwise exclusive or (\xe2\x8a\x95) operation is used as addition. One of ways to define multiplication operation (\xe2\x8a\x99) is following properties:   0\xe2\x8a\x99a=a\xe2\x8a\x990=0  1\xe2\x8a\x99a=a\xe2\x8a\x991=a  a\xe2\x8a\x99b=b\xe2\x8a\x99a  a\xe2\x8a\x99(b\xe2\x8a\x99c)=(a\xe2\x8a\x99b)\xe2\x8a\x99c  a\xe2\x8a\x99(b\xe2\x8a\x95c)=(a\xe2\x8a\x99b)\xe2\x8a\x95(a\xe2\x8a\x99c)  If a=22n for some integer n>0, and b<a, then a\xe2\x8a\x99b=a\xe2\x8b\x85b.  If a=22n for some integer n>0, then a\xe2\x8a\x99a=32\xe2\x8b\x85a. For example:   4\xe2\x8a\x994=6  8\xe2\x8a\x998=4\xe2\x8a\x992\xe2\x8a\x994\xe2\x8a\x992=4\xe2\x8a\x994\xe2\x8a\x992\xe2\x8a\x992=6\xe2\x8a\x993=(4\xe2\x8a\x952)\xe2\x8a\x993=(4\xe2\x8a\x993)\xe2\x8a\x95(2\xe2\x8a\x99(2\xe2\x8a\x951))=(4\xe2\x8a\x993)\xe2\x8a\x95(2\xe2\x8a\x992)\xe2\x8a\x95(2\xe2\x8a\x991)=12\xe2\x8a\x953\xe2\x8a\x952=13.  32\xe2\x8a\x9964=(16\xe2\x8a\x992)\xe2\x8a\x99(16\xe2\x8a\x994)=(16\xe2\x8a\x9916)\xe2\x8a\x99(2\xe2\x8a\x994)=24\xe2\x8a\x998=(16\xe2\x8a\x958)\xe2\x8a\x998=(16\xe2\x8a\x998)\xe2\x8a\x95(8\xe2\x8a\x998)=128\xe2\x8a\x9513=141  5\xe2\x8a\x996=(4\xe2\x8a\x951)\xe2\x8a\x99(4\xe2\x8a\x952)=(4\xe2\x8a\x994)\xe2\x8a\x95(4\xe2\x8a\x992)\xe2\x8a\x95(4\xe2\x8a\x991)\xe2\x8a\x95(1\xe2\x8a\x992)=6\xe2\x8a\x958\xe2\x8a\x954\xe2\x8a\x952=8 Formally, this algorithm can be described by following pseudo-code. multiply(a, b) {   ans = 0   for p1 in bits(a)       // numbers of bits of a equal to one       for p2 in bits(b)   // numbers of bits of b equal to one          ans = ans xor multiply_powers_of_2(1 << p1, 1 << p2)   return ans;}multiply_powers_of_2(a, b) {    if (a == 1 or b == 1) return a * b    n = maximal value, such 2^{2^{n}} <= max(a, b)    power = 2^{2^{n}};    if (a >= power and b >= power) {        return multiply(power * 3 / 2, multiply_powers_of_2(a / power, b / power))    } else if (a >= power) {        return multiply_powers_of_2(a / power, b) * power    } else {        return multiply_powers_of_2(a, b / power) * power    }}It can be shown, that this operations really forms a field. Moreover, than can make sense as game theory operations, but that\'s not related to problem much. With the help of appropriate caching and grouping of operations, it is possible to calculate the product quickly enough, which is important to improve speed of the cryptoalgorithm. More formal definitions as well as additional properties can be clarified in the wikipedia article at link. The authors of the task hope that the properties listed in the statement should be enough for the solution. Powering for such muliplication is defined in same way, formally a\xe2\x8a\x99k=a\xe2\x8a\x99a\xe2\x8a\x99\xe2\x8b\xaf\xe2\x8a\x99a\xe2\x8f\x9fkÂ times.You need to analyze the proposed scheme strength. For pairs of numbers a and b you need to find such x, that a\xe2\x8a\x99x=b, or determine that it doesn\'t exist." 3400
1310E "Strange Function" dp "Let\'s define the function f of multiset a as the multiset of number of occurences of every number, that is present in a.E.g., f({5,5,1,2,5,2,3,3,9,5})={1,1,2,2,4}.Let\'s define fk(a), as applying f to array a k times: fk(a)=f(fk\xe2\x88\x921(a)),f0(a)=a. E.g., f2({5,5,1,2,5,2,3,3,9,5})={1,2,2}.You are given integers n,k and you are asked how many different values the function fk(a) can have, where a is arbitrary non-empty array with numbers of size no more than n. Print the answer modulo 998244353." 2900
1310D Tourism dp,graphs,probabilities "Masha lives in a country with n cities numbered from 1 to n. She lives in the city number 1. There is a direct train route between each pair of distinct cities i and j, where i\xe2\x89\xa0j. In total there are n(n\xe2\x88\x921) distinct routes. Every route has a cost, cost for route from i to j may be different from the cost of route from j to i.Masha wants to start her journey in city 1, take exactly k routes from one city to another and as a result return to the city 1. Masha is really careful with money, so she wants the journey to be as cheap as possible. To do so Masha doesn\'t mind visiting a city multiple times or even taking the same route multiple times.Masha doesn\'t want her journey to have odd cycles. Formally, if you can select visited by Masha city v, take odd number of routes used by Masha in her journey and return to the city v, such journey is considered unsuccessful.Help Masha to find the cheapest (with minimal total cost of all taken routes) successful journey." 2300
1310C "Au Pont Rouge" "binary search,dp,strings" "VK just opened its second HQ in St. Petersburg! Side of its office building has a huge string s written on its side. This part of the office is supposed to be split into m meeting rooms in such way that meeting room walls are strictly between letters on the building. Obviously, meeting rooms should not be of size 0, but can be as small as one letter wide. Each meeting room will be named after the substring of s written on its side.For each possible arrangement of m meeting rooms we ordered a test meeting room label for the meeting room with lexicographically minimal name. When delivered, those labels got sorted backward lexicographically.What is printed on kth label of the delivery?" 2800
1310B "Double Elimination" dp,implementation "The biggest event of the year \xe2\x80\x93 Cota 2 world championship ""The Innernational"" is right around the corner. 2n teams will compete in a double-elimination format (please, carefully read problem statement even if you know what is it) to identify the champion. Teams are numbered from 1 to 2n and will play games one-on-one. All teams start in the upper bracket.All upper bracket matches will be held played between teams that haven\'t lost any games yet. Teams are split into games by team numbers. Game winner advances in the next round of upper bracket, losers drop into the lower bracket.Lower bracket starts with 2n\xe2\x88\x921 teams that lost the first upper bracket game. Each lower bracket round consists of two games. In the first game of a round 2k teams play a game with each other (teams are split into games by team numbers). 2k\xe2\x88\x921 loosing teams are eliminated from the championship, 2k\xe2\x88\x921 winning teams are playing 2k\xe2\x88\x921 teams that got eliminated in this round of upper bracket (again, teams are split into games by team numbers). As a result of each round both upper and lower bracket have 2k\xe2\x88\x921 teams remaining. See example notes for better understanding.Single remaining team of upper bracket plays with single remaining team of lower bracket in grand-finals to identify championship winner.You are a fan of teams with numbers a1,a2,...,ak. You want the championship to have as many games with your favourite teams as possible. Luckily, you can affect results of every championship game the way you want. What\'s maximal possible number of championship games that include teams you\'re fan of?" 2500
1310A Recommendations "data structures,greedy,sortings" "VK news recommendation system daily selects interesting publications of one of n disjoint categories for each user. Each publication belongs to exactly one category. For each category i batch algorithm selects ai publications.The latest A/B test suggests that users are reading recommended publications more actively if each category has a different number of publications within daily recommendations. The targeted algorithm can find a single interesting publication of i-th category within ti seconds. What is the minimum total time necessary to add publications to the result of batch algorithm execution, so all categories have a different number of publications? You can\'t remove publications recommended by the batch algorithm." 1700
1307G "Cow and Exercise" "flows,graphs,shortest paths" "Farmer John is obsessed with making Bessie exercise more!Bessie is out grazing on the farm, which consists of n fields connected by m directed roads. Each road takes some time wi to cross. She is currently at field 1 and will return to her home at field n at the end of the day.Farmer John has plans to increase the time it takes to cross certain roads. He can increase the time it takes to cross each road by a nonnegative amount, but the total increase cannot exceed xi for the i-th plan. Determine the maximum he can make the shortest path from 1 to n for each of the q independent plans." 3100
1307F "Cow and Vacation" "dfs and similar,dsu,trees" "Bessie is planning a vacation! In Cow-lifornia, there are n cities, with n\xe2\x88\x921 bidirectional roads connecting them. It is guaranteed that one can reach any city from any other city. Bessie is considering v possible vacation plans, with the i-th one consisting of a start city ai and destination city bi.It is known that only r of the cities have rest stops. Bessie gets tired easily, and cannot travel across more than k consecutive roads without resting. In fact, she is so desperate to rest that she may travel through the same city multiple times in order to do so.For each of the vacation plans, does there exist a way for Bessie to travel from the starting city to the destination city?" 3300
1307E "Cow and Treats" "binary search,combinatorics,dp,greedy,implementation,math" "After a successful year of milk production, Farmer John is rewarding his cows with their favorite treat: tasty grass!On the field, there is a row of n units of grass, each with a sweetness si. Farmer John has m cows, each with a favorite sweetness fi and a hunger value hi. He would like to pick two disjoint subsets of cows to line up on the left and right side of the grass row. There is no restriction on how many cows must be on either side. The cows will be treated in the following manner:   The cows from the left and right side will take turns feeding in an order decided by Farmer John.  When a cow feeds, it walks towards the other end without changing direction and eats grass of its favorite sweetness until it eats hi units.  The moment a cow eats hi units, it will fall asleep there, preventing further cows from passing it from both directions.  If it encounters another sleeping cow or reaches the end of the grass row, it will get upset. Farmer John absolutely does not want any cows to get upset. Note that grass does not grow back. Also, to prevent cows from getting upset, not every cow has to feed since FJ can choose a subset of them. Surprisingly, FJ has determined that sleeping cows are the most satisfied. If FJ orders optimally, what is the maximum number of sleeping cows that can result, and how many ways can FJ choose the subset of cows on the left and right side to achieve that maximum number of sleeping cows (modulo 109+7)? The order in which FJ sends the cows does not matter as long as no cows get upset." 2500
1307D "Cow and Fields" "binary search,data structures,dfs and similar,graphs,greedy,shortest paths,sortings" "Bessie is out grazing on the farm, which consists of n fields connected by m bidirectional roads. She is currently at field 1, and will return to her home at field n at the end of the day.The Cowfederation of Barns has ordered Farmer John to install one extra bidirectional road. The farm has k special fields and he has decided to install the road between two different special fields. He may add the road between two special fields that already had a road directly connecting them.After the road is added, Bessie will return home on the shortest path from field 1 to field n. Since Bessie needs more exercise, Farmer John must maximize the length of this shortest path. Help him!" 1900
1307C "Cow and Message" "brute force,dp,math,strings" "Bessie the cow has just intercepted a text that Farmer John sent to Burger Queen! However, Bessie is sure that there is a secret message hidden inside.The text is a string s of lowercase Latin letters. She considers a string t as hidden in string s if t exists as a subsequence of s whose indices form an arithmetic progression. For example, the string aab is hidden in string aaabb because it occurs at indices 1, 3, and 5, which form an arithmetic progression with a common difference of 2. Bessie thinks that any hidden string that occurs the most times is the secret message. Two occurrences of a subsequence of S are distinct if the sets of indices are different. Help her find the number of occurrences of the secret message!For example, in the string aaabb, a is hidden 3 times, b is hidden 2 times, ab is hidden 6 times, aa is hidden 3 times, bb is hidden 1 time, aab is hidden 2 times, aaa is hidden 1 time, abb is hidden 1 time, aaab is hidden 1 time, aabb is hidden 1 time, and aaabb is hidden 1 time. The number of occurrences of the secret message is 6." 1500
1307B "Cow and Friend" geometry,greedy,math "Bessie has way too many friends because she is everyone\'s favorite cow! Her new friend Rabbit is trying to hop over so they can play! More specifically, he wants to get from (0,0) to (x,0) by making multiple hops. He is only willing to hop from one point to another point on the 2D plane if the Euclidean distance between the endpoints of a hop is one of its n favorite numbers: a1,a2,\xe2\x80\xa6,an. What is the minimum number of hops Rabbit needs to get from (0,0) to (x,0)? Rabbit may land on points with non-integer coordinates. It can be proved that Rabbit can always reach his destination.Recall that the Euclidean distance between points (xi,yi) and (xj,yj) is \xe2\x88\x9a(xi\xe2\x88\x92xj)2+(yi\xe2\x88\x92yj)2.For example, if Rabbit has favorite numbers 1 and 3 he could hop from (0,0) to (4,0) in two hops as shown below. Note that there also exists other valid ways to hop to (4,0) in 2 hops (e.g. (0,0) \xe2\x86\x92 (2,\xe2\x88\x92\xe2\x88\x9a5) \xe2\x86\x92 (4,0)).  Here is a graphic for the first example. Both hops have distance 3, one of Rabbit\'s favorite numbers. In other words, each time Rabbit chooses some number ai and hops with distance equal to ai in any direction he wants. The same number can be used multiple times." 1300
1307A "Cow and Haybales" greedy,implementation "The USA Construction Operation (USACO) recently ordered Farmer John to arrange a row of n haybale piles on the farm. The i-th pile contains ai haybales. However, Farmer John has just left for vacation, leaving Bessie all on her own. Every day, Bessie the naughty cow can choose to move one haybale in any pile to an adjacent pile. Formally, in one day she can choose any two indices i and j (1\xe2\x89\xa4i,j\xe2\x89\xa4n) such that |i\xe2\x88\x92j|=1 and ai>0 and apply ai=ai\xe2\x88\x921, aj=aj+1. She may also decide to not do anything on some days because she is lazy.Bessie wants to maximize the number of haybales in pile 1 (i.e. to maximize a1), and she only has d days to do so before Farmer John returns. Help her find the maximum number of haybales that may be in pile 1 if she acts optimally!" 800
1305H "Kuroni the Private Tutor" "binary search,greedy" "As a professional private tutor, Kuroni has to gather statistics of an exam. Kuroni has appointed you to complete this important task. You must not disappoint him.The exam consists of n questions, and m students have taken the exam. Each question was worth 1 point. Question i was solved by at least li and at most ri students. Additionally, you know that the total score of all students is t.Furthermore, you took a glance at the final ranklist of the quiz. The students were ranked from 1 to m, where rank 1 has the highest score and rank m has the lowest score. Ties were broken arbitrarily.You know that the student at rank pi had a score of si for 1\xe2\x89\xa4i\xe2\x89\xa4q.You wonder if there could have been a huge tie for first place. Help Kuroni determine the maximum number of students who could have gotten as many points as the student with rank 1, and the maximum possible score for rank 1 achieving this maximum number of students." 3500
1305G "Kuroni and Antihype" "bitmasks,brute force,dp,dsu,graphs" "Kuroni isn\'t good at economics. So he decided to found a new financial pyramid called Antihype. It has the following rules:  You can join the pyramid for free and get 0 coins.  If you are already a member of Antihype, you can invite your friend who is currently not a member of Antihype, and get a number of coins equal to your age (for each friend you invite). n people have heard about Antihype recently, the i-th person\'s age is ai. Some of them are friends, but friendship is a weird thing now: the i-th person is a friend of the j-th person if and only if aiÂ ANDÂ aj=0, where AND denotes the bitwise AND operation.Nobody among the n people is a member of Antihype at the moment. They want to cooperate to join and invite each other to Antihype in a way that maximizes their combined gainings. Could you help them?" 3500
1305F "Kuroni and the Punishment" "math,number theory,probabilities" "Kuroni is very angry at the other setters for using him as a theme! As a punishment, he forced them to solve the following problem:You have an array a consisting of n positive integers. An operation consists of choosing an element and either adding 1 to it or subtracting 1 from it, such that the element remains positive. We say the array is good if the greatest common divisor of all its elements is not 1. Find the minimum number of operations needed to make the array good.Unable to match Kuroni\'s intellect, the setters failed to solve the problem. Help them escape from Kuroni\'s punishment!" 2500
1305E "Kuroni and the Score Distribution" "constructive algorithms,greedy,implementation,math" "Kuroni is the coordinator of the next Mathforces round written by the ""Proof by AC"" team. All the preparation has been done, and he is discussing with the team about the score distribution for the round.The round consists of n problems, numbered from 1 to n. The problems are ordered in increasing order of difficulty, no two problems have the same difficulty. A score distribution for the round can be denoted by an array a1,a2,\xe2\x80\xa6,an, where ai is the score of i-th problem. Kuroni thinks that the score distribution should satisfy the following requirements:  The score of each problem should be a positive integer not exceeding 109.  A harder problem should grant a strictly higher score than an easier problem. In other words, 1\xe2\x89\xa4a1<a2<\xe2\x8b\xaf<an\xe2\x89\xa4109.  The balance of the score distribution, defined as the number of triples (i,j,k) such that 1\xe2\x89\xa4i<j<k\xe2\x89\xa4n and ai+aj=ak, should be exactly m. Help the team find a score distribution that satisfies Kuroni\'s requirement. In case such a score distribution does not exist, output \xe2\x88\x921." 2200
1305D "Kuroni and the Celebration" "constructive algorithms,dfs and similar,interactive,trees" "This is an interactive problem.After getting AC after 13 Time Limit Exceeded verdicts on a geometry problem, Kuroni went to an Italian restaurant to celebrate this holy achievement. Unfortunately, the excess sauce disoriented him, and he\'s now lost!The United States of America can be modeled as a tree (why though) with n vertices. The tree is rooted at vertex r, wherein lies Kuroni\'s hotel.Kuroni has a phone app designed to help him in such emergency cases. To use the app, he has to input two vertices u and v, and it\'ll return a vertex w, which is the lowest common ancestor of those two vertices.However, since the phone\'s battery has been almost drained out from live-streaming Kuroni\'s celebration party, he could only use the app at most \xe2\x8c\x8an2\xe2\x8c\x8b times. After that, the phone would die and there will be nothing left to help our dear friend! :(As the night is cold and dark, Kuroni needs to get back, so that he can reunite with his comfy bed and pillow(s). Can you help him figure out his hotel\'s location?" 1900
1305C "Kuroni and Impossible Calculation" "brute force,combinatorics,math,number theory" "To become the king of Codeforces, Kuroni has to solve the following problem.He is given n numbers a1,a2,\xe2\x80\xa6,an. Help Kuroni to calculate \xe2\x88\x8f1\xe2\x89\xa4i<j\xe2\x89\xa4n|ai\xe2\x88\x92aj|. As result can be very big, output it modulo m.If you are not familiar with short notation, \xe2\x88\x8f1\xe2\x89\xa4i<j\xe2\x89\xa4n|ai\xe2\x88\x92aj| is equal to |a1\xe2\x88\x92a2|\xe2\x8b\x85|a1\xe2\x88\x92a3|\xe2\x8b\x85 \xe2\x80\xa6 \xe2\x8b\x85|a1\xe2\x88\x92an|\xe2\x8b\x85|a2\xe2\x88\x92a3|\xe2\x8b\x85|a2\xe2\x88\x92a4|\xe2\x8b\x85 \xe2\x80\xa6 \xe2\x8b\x85|a2\xe2\x88\x92an|\xe2\x8b\x85 \xe2\x80\xa6 \xe2\x8b\x85|an\xe2\x88\x921\xe2\x88\x92an|. In other words, this is the product of |ai\xe2\x88\x92aj| for all 1\xe2\x89\xa4i<j\xe2\x89\xa4n." 1600
1305B "Kuroni and Simple Strings" "constructive algorithms,greedy,strings,two pointers" "Now that Kuroni has reached 10 years old, he is a big boy and doesn\'t like arrays of integers as presents anymore. This year he wants a Bracket sequence as a Birthday present. More specifically, he wants a bracket sequence so complex that no matter how hard he tries, he will not be able to remove a simple subsequence!We say that a string formed by n characters \'(\' or \')\' is simple if its length n is even and positive, its first n2 characters are \'(\', and its last n2 characters are \')\'. For example, the strings () and (()) are simple, while the strings )( and ()() are not simple.Kuroni will be given a string formed by characters \'(\' and \')\' (the given string is not necessarily simple). An operation consists of choosing a subsequence of the characters of the string that forms a simple string and removing all the characters of this subsequence from the string. Note that this subsequence doesn\'t have to be continuous. For example, he can apply the operation to the string \')()(()))\', to choose a subsequence of bold characters, as it forms a simple string \'(())\', delete these bold characters from the string and to get \'))()\'. Kuroni has to perform the minimum possible number of operations on the string, in such a way that no more operations can be performed on the remaining string. The resulting string does not have to be empty.Since the given string is too large, Kuroni is unable to figure out how to minimize the number of operations. Can you help him do it instead?A sequence of characters a is a subsequence of a string b if a can be obtained from b by deletion of several (possibly, zero or all) characters." 1200
1305A "Kuroni and the Gifts" "brute force,constructive algorithms,greedy,sortings" "Kuroni has n daughters. As gifts for them, he bought n necklaces and n bracelets:  the i-th necklace has a brightness ai, where all the ai are pairwise distinct (i.e. all ai are different),  the i-th bracelet has a brightness bi, where all the bi are pairwise distinct (i.e. all bi are different). Kuroni wants to give exactly one necklace and exactly one bracelet to each of his daughters. To make sure that all of them look unique, the total brightnesses of the gifts given to each daughter should be pairwise distinct. Formally, if the i-th daughter receives a necklace with brightness xi and a bracelet with brightness yi, then the sums xi+yi should be pairwise distinct. Help Kuroni to distribute the gifts.For example, if the brightnesses are a=[1,7,5] and b=[6,1,2], then we may distribute the gifts as follows:  Give the third necklace and the first bracelet to the first daughter, for a total brightness of a3+b1=11. Give the first necklace and the third bracelet to the second daughter, for a total brightness of a1+b3=3. Give the second necklace and the second bracelet to the third daughter, for a total brightness of a2+b2=8. Here is an example of an invalid distribution:   Give the first necklace and the first bracelet to the first daughter, for a total brightness of a1+b1=7. Give the second necklace and the second bracelet to the second daughter, for a total brightness of a2+b2=8. Give the third necklace and the third bracelet to the third daughter, for a total brightness of a3+b3=7. This distribution is invalid, as the total brightnesses of the gifts received by the first and the third daughter are the same. Don\'t make them this upset!" 800
1304F2 "Animal Observation (hard version)" "data structures,dp,greedy" "The only difference between easy and hard versions is the constraint on k.Gildong loves observing animals, so he bought two cameras to take videos of wild animals in a forest. The color of one camera is red, and the other one\'s color is blue.Gildong is going to take videos for n days, starting from day 1 to day n. The forest can be divided into m areas, numbered from 1 to m. He\'ll use the cameras in the following way:   On every odd day (1-st, 3-rd, 5-th, ...), bring the red camera to the forest and record a video for 2 days.  On every even day (2-nd, 4-th, 6-th, ...), bring the blue camera to the forest and record a video for 2 days.  If he starts recording on the n-th day with one of the cameras, the camera records for only one day. Each camera can observe k consecutive areas of the forest. For example, if m=5 and k=3, he can put a camera to observe one of these three ranges of areas for two days: [1,3], [2,4], and [3,5].Gildong got information about how many animals will be seen in each area on each day. Since he would like to observe as many animals as possible, he wants you to find the best way to place the two cameras for n days. Note that if the two cameras are observing the same area on the same day, the animals observed in that area are counted only once." 2400
1304F1 "Animal Observation (easy version)" "data structures,dp" "The only difference between easy and hard versions is the constraint on k.Gildong loves observing animals, so he bought two cameras to take videos of wild animals in a forest. The color of one camera is red, and the other one\'s color is blue.Gildong is going to take videos for n days, starting from day 1 to day n. The forest can be divided into m areas, numbered from 1 to m. He\'ll use the cameras in the following way:   On every odd day (1-st, 3-rd, 5-th, ...), bring the red camera to the forest and record a video for 2 days.  On every even day (2-nd, 4-th, 6-th, ...), bring the blue camera to the forest and record a video for 2 days.  If he starts recording on the n-th day with one of the cameras, the camera records for only one day. Each camera can observe k consecutive areas of the forest. For example, if m=5 and k=3, he can put a camera to observe one of these three ranges of areas for two days: [1,3], [2,4], and [3,5].Gildong got information about how many animals will be seen in each area each day. Since he would like to observe as many animals as possible, he wants you to find the best way to place the two cameras for n days. Note that if the two cameras are observing the same area on the same day, the animals observed in that area are counted only once." 2300
1304E "1-Trees and Queries" "data structures,dfs and similar,shortest paths,trees" "Gildong was hiking a mountain, walking by millions of trees. Inspired by them, he suddenly came up with an interesting idea for trees in data structures: What if we add another edge in a tree?Then he found that such tree-like graphs are called 1-trees. Since Gildong was bored of solving too many tree problems, he wanted to see if similar techniques in trees can be used in 1-trees as well. Instead of solving it by himself, he\'s going to test you by providing queries on 1-trees.First, he\'ll provide you a tree (not 1-tree) with n vertices, then he will ask you q queries. Each query contains 5 integers: x, y, a, b, and k. This means you\'re asked to determine if there exists a path from vertex a to b that contains exactly k edges after adding a bidirectional edge between vertices x and y. A path can contain the same vertices and same edges multiple times. All queries are independent of each other; i.e. the added edge in a query is removed in the next query." 2000
1304D "Shortest and Longest LIS" "constructive algorithms,graphs,greedy,two pointers" "Gildong recently learned how to find the longest increasing subsequence (LIS) in O(nlogn) time for a sequence of length n. He wants to test himself if he can implement it correctly, but he couldn\'t find any online judges that would do it (even though there are actually many of them). So instead he\'s going to make a quiz for you about making permutations of n distinct integers between 1 and n, inclusive, to test his code with your output.The quiz is as follows.Gildong provides a string of length n\xe2\x88\x921, consisting of characters \'<\' and \'>\' only. The i-th (1-indexed) character is the comparison result between the i-th element and the i+1-st element of the sequence. If the i-th character of the string is \'<\', then the i-th element of the sequence is less than the i+1-st element. If the i-th character of the string is \'>\', then the i-th element of the sequence is greater than the i+1-st element.He wants you to find two possible sequences (not necessarily distinct) consisting of n distinct integers between 1 and n, inclusive, each satisfying the comparison results, where the length of the LIS of the first sequence is minimum possible, and the length of the LIS of the second sequence is maximum possible." 1800
1304C "Air Conditioner" "dp,greedy,implementation,sortings,two pointers" "Gildong owns a bulgogi restaurant. The restaurant has a lot of customers, so many of them like to make a reservation before visiting it.Gildong tries so hard to satisfy the customers that he even memorized all customers\' preferred temperature ranges! Looking through the reservation list, he wants to satisfy all customers by controlling the temperature of the restaurant.The restaurant has an air conditioner that has 3 states: off, heating, and cooling. When it\'s off, the restaurant\'s temperature remains the same. When it\'s heating, the temperature increases by 1 in one minute. Lastly, when it\'s cooling, the temperature decreases by 1 in one minute. Gildong can change the state as many times as he wants, at any integer minutes. The air conditioner is off initially.Each customer is characterized by three values: ti \xe2\x80\x94 the time (in minutes) when the i-th customer visits the restaurant, li \xe2\x80\x94 the lower bound of their preferred temperature range, and hi \xe2\x80\x94 the upper bound of their preferred temperature range.A customer is satisfied if the temperature is within the preferred range at the instant they visit the restaurant. Formally, the i-th customer is satisfied if and only if the temperature is between li and hi (inclusive) in the ti-th minute.Given the initial temperature, the list of reserved customers\' visit times and their preferred temperature ranges, you\'re going to help him find if it\'s possible to satisfy all customers." 1500
1304B "Longest Palindrome" "brute force,constructive algorithms,greedy,implementation,strings" "Returning back to problem solving, Gildong is now studying about palindromes. He learned that a palindrome is a string that is the same as its reverse. For example, strings ""pop"", ""noon"", ""x"", and ""kkkkkk"" are palindromes, while strings ""moon"", ""tv"", and ""abab"" are not. An empty string is also a palindrome.Gildong loves this concept so much, so he wants to play with it. He has n distinct strings of equal length m. He wants to discard some of the strings (possibly none or all) and reorder the remaining strings so that the concatenation becomes a palindrome. He also wants the palindrome to be as long as possible. Please help him find one." 1100
1304A "Two Rabbits" math "Being tired of participating in too many Codeforces rounds, Gildong decided to take some rest in a park. He sat down on a bench, and soon he found two rabbits hopping around. One of the rabbits was taller than the other.He noticed that the two rabbits were hopping towards each other. The positions of the two rabbits can be represented as integer coordinates on a horizontal line. The taller rabbit is currently on position x, and the shorter rabbit is currently on position y (x<y). Every second, each rabbit hops to another position. The taller rabbit hops to the positive direction by a, and the shorter rabbit hops to the negative direction by b.  For example, let\'s say x=0, y=10, a=2, and b=3. At the 1-st second, each rabbit will be at position 2 and 7. At the 2-nd second, both rabbits will be at position 4.Gildong is now wondering: Will the two rabbits be at the same position at the same moment? If so, how long will it take? Let\'s find a moment in time (in seconds) after which the rabbits will be at the same point." 800
1303G "Sum of Prefix Sums" "data structures,divide and conquer,geometry,trees" "We define the sum of prefix sums of an array [s1,s2,\xe2\x80\xa6,sk] as s1+(s1+s2)+(s1+s2+s3)+\xe2\x8b\xaf+(s1+s2+\xe2\x8b\xaf+sk).You are given a tree consisting of n vertices. Each vertex i has an integer ai written on it. We define the value of the simple path from vertex u to vertex v as follows: consider all vertices appearing on the path from u to v, write down all the numbers written on these vertices in the order they appear on the path, and compute the sum of prefix sums of the resulting sequence.Your task is to calculate the maximum value over all paths in the tree." 2700
1303F "Number of Components" dsu,implementation "You are given a matrix n\xc3\x97m, initially filled with zeroes. We define ai,j as the element in the i-th row and the j-th column of the matrix.Two cells of the matrix are connected if they share a side, and the elements in these cells are equal. Two cells of the matrix belong to the same connected component if there exists a sequence s1, s2, ..., sk such that s1 is the first cell, sk is the second cell, and for every i\xe2\x88\x88[1,k\xe2\x88\x921], si and si+1 are connected.You are given q queries of the form xi yi ci (i\xe2\x88\x88[1,q]). For every such query, you have to do the following:  replace the element ax,y with c;  count the number of connected components in the matrix. There is one additional constraint: for every i\xe2\x88\x88[1,q\xe2\x88\x921], ci\xe2\x89\xa4ci+1." 2800
1303E "Erase Subsequences" dp,strings "You are given a string s. You can build new string p from s using the following operation no more than two times:   choose any subsequence si1,si2,\xe2\x80\xa6,sik where 1\xe2\x89\xa4i1<i2<\xe2\x8b\xaf<ik\xe2\x89\xa4|s|;  erase the chosen subsequence from s (s can become empty);  concatenate chosen subsequence to the right of the string p (in other words, p=p+si1si2\xe2\x80\xa6sik). Of course, initially the string p is empty. For example, let s=ababcd. At first, let\'s choose subsequence s1s4s5=abc \xe2\x80\x94 we will get s=bad and p=abc. At second, let\'s choose s1s2=ba \xe2\x80\x94 we will get s=d and p=abcba. So we can build abcba from ababcd.Can you build a given string t using the algorithm above?" 2200
1303D "Fill The Bag" bitmasks,greedy "You have a bag of size n. Also you have m boxes. The size of i-th box is ai, where each ai is an integer non-negative power of two.You can divide boxes into two parts of equal size. Your goal is to fill the bag completely.For example, if n=10 and a=[1,1,32] then you have to divide the box of size 32 into two parts of size 16, and then divide the box of size 16. So you can fill the bag with boxes of size 1, 1 and 8.Calculate the minimum number of divisions required to fill the bag of size n." 1900
1303C "Perfect Keyboard" "dfs and similar,greedy,implementation" "Polycarp wants to assemble his own keyboard. Layouts with multiple rows are too complicated for him \xe2\x80\x94 his keyboard will consist of only one row, where all 26 lowercase Latin letters will be arranged in some order.Polycarp uses the same password s on all websites where he is registered (it is bad, but he doesn\'t care). He wants to assemble a keyboard that will allow to type this password very easily. He doesn\'t like to move his fingers while typing the password, so, for each pair of adjacent characters in s, they should be adjacent on the keyboard. For example, if the password is abacaba, then the layout cabdefghi... is perfect, since characters a and c are adjacent on the keyboard, and a and b are adjacent on the keyboard. It is guaranteed that there are no two adjacent equal characters in s, so, for example, the password cannot be password (two characters s are adjacent).Can you help Polycarp with choosing the perfect layout of the keyboard, if it is possible?" 1600
1303B "National Project" math "Your company was appointed to lay new asphalt on the highway of length n. You know that every day you can either repair one unit of the highway (lay new asphalt over one unit of the highway) or skip repairing.Skipping the repair is necessary because of the climate. The climate in your region is periodical: there are g days when the weather is good and if you lay new asphalt these days it becomes high-quality pavement; after that, the weather during the next b days is bad, and if you lay new asphalt these days it becomes low-quality pavement; again g good days, b bad days and so on.You can be sure that you start repairing at the start of a good season, in other words, days 1,2,\xe2\x80\xa6,g are good.You don\'t really care about the quality of the highway, you just want to make sure that at least half of the highway will have high-quality pavement. For example, if the n=5 then at least 3 units of the highway should have high quality; if n=4 then at least 2 units should have high quality.What is the minimum number of days is needed to finish the repair of the whole highway?" 1400
1303A "Erasing Zeroes" implementation,strings "You are given a string s. Each character is either 0 or 1.You want all 1\'s in the string to form a contiguous subsegment. For example, if the string is 0, 1, 00111 or 01111100, then all 1\'s form a contiguous subsegment, and if the string is 0101, 100001 or 11111111111101, then this condition is not met.You may erase some (possibly none) 0\'s from the string. What is the minimum number of 0\'s that you have to erase?" 800
1302J "Keep talking and nobody explodes -- hard" NA "This is an unusual problem in an unusual contest, here is the announcement: http://codeforces.com/blog/entry/73543You have the safe lock which consists of 100 decimal digits. If you rotate some digit, it increases by one, except 9 which becomes 0.Initially, the lock contains number x. To unlock the safe you must do the following operations in order (and be careful, don\'t mix up if and else statements).If digit 39 is odd, rotate digit 39 by 9 times, else rotate digit 37 by 1 times. If digit 24 is odd, rotate digit 24 by 1 times, else rotate digit 76 by 3 times. If sum of digits 13 and 91 is greater than 10, rotate digit 14 by 6 times, else rotate digit 34 by 8 times. If digit 87 is odd, rotate digit 87 by 7 times, else rotate digit 22 by 9 times. If digit 79 is greater than digit 15, rotate digit 74 by 7 times, else rotate digit 84 by 6 times. If sum of digits 26 and 66 is greater than 9, rotate digit 31 by 7 times, else rotate digit 95 by 4 times. If sum of digits 53 and 1 is greater than 8, rotate digit 66 by 1 times, else rotate digit 94 by 6 times. If digit 41 is greater than digit 29, rotate digit 67 by 5 times, else rotate digit 41 by 9 times. If sum of digits 79 and 20 is greater than 10, rotate digit 18 by 2 times, else rotate digit 72 by 9 times. If sum of digits 14 and 24 is greater than 10, rotate digit 64 by 2 times, else rotate digit 84 by 2 times. If digit 16 is greater than digit 34, rotate digit 81 by 5 times, else rotate digit 15 by 2 times. If sum of digits 48 and 65 is greater than 9, rotate digit 57 by 2 times, else rotate digit 28 by 5 times. If digit 81 is odd, rotate digit 81 by 5 times, else rotate digit 25 by 4 times. If digit 70 is odd, rotate digit 70 by 9 times, else rotate digit 93 by 3 times. If sum of digits 92 and 49 is greater than 9, rotate digit 81 by 2 times, else rotate digit 42 by 3 times. If digit 96 is greater than digit 20, rotate digit 45 by 4 times, else rotate digit 45 by 1 times. If digit 91 is greater than digit 21, rotate digit 60 by 3 times, else rotate digit 72 by 1 times. If digit 89 is greater than digit 7, rotate digit 98 by 9 times, else rotate digit 52 by 7 times. If digit 38 is greater than digit 97, rotate digit 92 by 6 times, else rotate digit 35 by 4 times. If digit 96 is greater than digit 99, rotate digit 42 by 4 times, else rotate digit 40 by 9 times. If digit 86 is odd, rotate digit 86 by 1 times, else rotate digit 14 by 3 times. If digit 23 is odd, rotate digit 23 by 5 times, else rotate digit 55 by 9 times. If digit 79 is odd, rotate digit 79 by 1 times, else rotate digit 29 by 8 times. If digit 4 is greater than digit 91, rotate digit 98 by 8 times, else rotate digit 69 by 4 times. If digit 93 is greater than digit 24, rotate digit 75 by 9 times, else rotate digit 95 by 3 times. If sum of digits 32 and 50 is greater than 10, rotate digit 91 by 3 times, else rotate digit 1 by 5 times. If digit 81 is greater than digit 31, rotate digit 86 by 7 times, else rotate digit 67 by 5 times. If digit 83 is greater than digit 86, rotate digit 48 by 7 times, else rotate digit 2 by 6 times. If digit 20 is greater than digit 88, rotate digit 9 by 2 times, else rotate digit 99 by 4 times. If digit 14 is odd, rotate digit 14 by 5 times, else rotate digit 97 by 7 times. If digit 38 is greater than digit 14, rotate digit 48 by 2 times, else rotate digit 81 by 5 times. If digit 92 is greater than digit 74, rotate digit 92 by 1 times, else rotate digit 50 by 9 times. If digit 76 is greater than digit 89, rotate digit 68 by 6 times, else rotate digit 69 by 5 times. If digit 2 is greater than digit 28, rotate digit 75 by 1 times, else rotate digit 89 by 1 times. If digit 67 is odd, rotate digit 67 by 9 times, else rotate digit 49 by 1 times. If digit 23 is odd, rotate digit 23 by 1 times, else rotate digit 59 by 3 times. If digit 81 is odd, rotate digit 81 by 9 times, else rotate digit 9 by 4 times. If sum of digits 92 and 82 is greater than 9, rotate digit 81 by 2 times, else rotate digit 91 by 5 times. If sum of digits 42 and 48 is greater than 9, rotate digit 35 by 8 times, else rotate digit 59 by 6 times. If digit 55 is odd, rotate digit 55 by 9 times, else rotate digit 61 by 6 times. If digit 83 is odd, rotate digit 83 by 5 times, else rotate digit 85 by 4 times. If digit 96 is odd, rotate digit 96 by 1 times, else rotate digit 72 by 4 times. If digit 17 is odd, rotate digit 17 by 1 times, else rotate digit 28 by 3 times. If digit 85 is greater than digit 74, rotate digit 37 by 3 times, else rotate digit 10 by 3 times. If sum of digits 50 and 67 is greater than 9, rotate digit 85 by 9 times, else rotate digit 42 by 4 times. If sum of digits 11 and 43 is greater than 10, rotate digit 56 by 7 times, else rotate digit 50 by 7 times. If sum of digits 95 and 64 is greater than 9, rotate digit 95 by 4 times, else rotate digit 95 by 9 times. If sum of digits 21 and 16 is greater than 9, rotate digit 87 by 3 times, else rotate digit 30 by 1 times. If digit 91 is odd, rotate digit 91 by 1 times, else rotate digit 77 by 1 times. If digit 95 is greater than digit 82, rotate digit 53 by 2 times, else rotate digit 100 by 5 times. If sum of digits 88 and 66 is greater than 10, rotate digit 34 by 4 times, else rotate digit 57 by 4 times. If digit 73 is greater than digit 84, rotate digit 52 by 3 times, else rotate digit 42 by 9 times. If digit 66 is greater than digit 38, rotate digit 94 by 7 times, else rotate digit 78 by 7 times. If digit 23 is greater than digit 12, rotate digit 78 by 2 times, else rotate digit 62 by 8 times. If digit 13 is greater than digit 9, rotate digit 42 by 7 times, else rotate digit 1 by 9 times. If digit 43 is greater than digit 29, rotate digit 20 by 2 times, else rotate digit 47 by 2 times. If sum of digits 100 and 51 is greater than 8, rotate digit 10 by 6 times, else rotate digit 89 by 1 times. If digit 19 is greater than digit 37, rotate digit 26 by 7 times, else rotate digit 30 by 8 times. If digit 73 is greater than digit 25, rotate digit 77 by 3 times, else rotate digit 41 by 1 times. If sum of digits 67 and 96 is greater than 10, rotate digit 47 by 6 times, else rotate digit 33 by 5 times. If digit 11 is greater than digit 10, rotate digit 33 by 3 times, else rotate digit 4 by 3 times. If digit 85 is odd, rotate digit 85 by 7 times, else rotate digit 37 by 9 times. If digit 14 is odd, rotate digit 14 by 1 times, else rotate digit 28 by 4 times. If sum of digits 30 and 18 is greater than 8, rotate digit 93 by 5 times, else rotate digit 68 by 1 times. If sum of digits 54 and 72 is greater than 8, rotate digit 88 by 8 times, else rotate digit 25 by 8 times. If digit 72 is odd, rotate digit 72 by 5 times, else rotate digit 10 by 3 times. If digit 15 is odd, rotate digit 15 by 3 times, else rotate digit 68 by 1 times. If sum of digits 81 and 31 is greater than 9, rotate digit 2 by 5 times, else rotate digit 35 by 1 times. If digit 57 is odd, rotate digit 57 by 1 times, else rotate digit 25 by 9 times. If sum of digits 75 and 51 is greater than 9, rotate digit 73 by 8 times, else rotate digit 49 by 1 times. If sum of digits 81 and 61 is greater than 10, rotate digit 61 by 3 times, else rotate digit 88 by 1 times. If digit 60 is odd, rotate digit 60 by 1 times, else rotate digit 31 by 2 times. If digit 93 is odd, rotate digit 93 by 5 times, else rotate digit 50 by 1 times. If sum of digits 19 and 82 is greater than 9, rotate digit 48 by 7 times, else rotate digit 88 by 8 times. If digit 45 is odd, rotate digit 45 by 7 times, else rotate digit 100 by 1 times. If digit 46 is greater than digit 71, rotate digit 28 by 8 times, else rotate digit 37 by 6 times. If digit 79 is odd, rotate digit 79 by 5 times, else rotate digit 10 by 1 times. If digit 19 is greater than digit 95, rotate digit 76 by 9 times, else rotate digit 95 by 8 times. If digit 49 is odd, rotate digit 49 by 5 times, else rotate digit 66 by 3 times. If digit 62 is odd, rotate digit 62 by 1 times, else rotate digit 26 by 8 times. If digit 67 is greater than digit 33, rotate digit 27 by 8 times, else rotate digit 96 by 2 times. If sum of digits 73 and 15 is greater than 8, rotate digit 98 by 6 times, else rotate digit 11 by 6 times. If digit 63 is greater than digit 42, rotate digit 66 by 1 times, else rotate digit 58 by 2 times. If digit 41 is odd, rotate digit 41 by 9 times, else rotate digit 99 by 5 times. If digit 93 is odd, rotate digit 93 by 5 times, else rotate digit 53 by 1 times. If digit 46 is odd, rotate digit 46 by 3 times, else rotate digit 64 by 4 times. If sum of digits 99 and 64 is greater than 10, rotate digit 72 by 9 times, else rotate digit 51 by 5 times. If digit 75 is greater than digit 23, rotate digit 89 by 2 times, else rotate digit 76 by 7 times. If digit 6 is odd, rotate digit 6 by 1 times, else rotate digit 44 by 6 times. If digit 58 is odd, rotate digit 58 by 3 times, else rotate digit 49 by 9 times. If digit 5 is greater than digit 13, rotate digit 46 by 9 times, else rotate digit 21 by 7 times. If sum of digits 44 and 94 is greater than 9, rotate digit 36 by 4 times, else rotate digit 15 by 3 times. If sum of digits 52 and 43 is greater than 8, rotate digit 29 by 8 times, else rotate digit 72 by 6 times. If sum of digits 87 and 48 is greater than 9, rotate digit 61 by 8 times, else rotate digit 14 by 3 times. If digit 81 is odd, rotate digit 81 by 7 times, else rotate digit 64 by 2 times. If digit 88 is odd, rotate digit 88 by 7 times, else rotate digit 53 by 9 times. If sum of digits 86 and 78 is greater than 10, rotate digit 96 by 7 times, else rotate digit 79 by 1 times. If digit 20 is odd, rotate digit 20 by 7 times, else rotate digit 2 by 7 times. If digit 77 is greater than digit 80, rotate digit 60 by 5 times, else rotate digit 38 by 8 times. If digit 65 is odd, rotate digit 65 by 1 times, else rotate digit 85 by 3 times." -999
1302I "Deja vu" NA "This is an unusual problem in an unusual contest, here is the announcement: http://codeforces.com/blog/entry/73543You run a string shop. During a day your customers want to buy strings of certain lengths and sometimes satisfying other properties.Today your first customer asked you if you have a string of length k. In fact, you have a string of length n and can cut a string of length k starting at any position out of it. You wonder how many distinct values this string can equal.Please note that in your shop strings are over an alphabet of size 2." -999
1302H "Who needs suffix structures?" NA "This is an unusual problem in an unusual contest, here is the announcement: http://codeforces.com/blog/entry/73543You run a string shop. During a day your customers want to buy strings of certain lengths and sometimes satisfying other properties.You have a string of length n and can cut a string of any length starting at any position out of it. Today your first customer asks you some questions of type ""Is there any difference between substrings of length k if one of them starts at position i and another one starts from the j-th position?"" You are to answer all these questions.Please note that in your shop strings are over an alphabet of size 987898789." -999
1302G "Keep talking and nobody explodes -- medium" NA "This is an unusual problem in an unusual contest, here is the announcement: http://codeforces.com/blog/entry/73543You have the safe lock which consists of 5 decimal digits. If you rotate some digit, it increases by one, except 9 which becomes 0.Initially, the lock contains number x. To unlock the safe you must do the following operations in order (and be careful, don\'t mix up if and else statements).If sum of digits on positions 3 and 4 is greater than 10, rotate digit on position 2 by 9 times, else rotate digit on position 5 by 4 times.If digit on position 3 is greater than digit on position 5, rotate digit on position 2 by 4 times, else rotate digit on position 4 by 6 times.If digit on position 5 is greater than digit on position 3, rotate digit on position 2 by 1 times, else rotate digit on position 1 by 7 times.If sum of digits on positions 4 and 1 is greater than 8, rotate digit on position 2 by 7 times, else rotate digit on position 3 by 3 times.If digit on position 4 is greater than digit on position 1, rotate digit on position 2 by 3 times, else rotate digit on position 3 by 2 times.If sum of digits on positions 1 and 2 is greater than 9, rotate digit on position 3 by 6 times, else rotate digit on position 5 by 3 times.If digit on position 3 is greater than digit on position 2, rotate digit on position 1 by 2 times, else rotate digit on position 4 by 5 times.If digit on position 5 is greater than digit on position 3, rotate digit on position 2 by 1 times, else rotate digit on position 4 by 5 times.If sum of digits on positions 5 and 1 is greater than 10, rotate digit on position 4 by 7 times, else rotate digit on position 3 by 5 times.If sum of digits on positions 5 and 4 is greater than 9, rotate digit on position 3 by 9 times, else rotate digit on position 2 by 4 times.If sum of digits on positions 3 and 1 is greater than 8, rotate digit on position 2 by 8 times, else rotate digit on position 4 by 4 times.If digit on position 5 is greater than digit on position 2, rotate digit on position 1 by 5 times, else rotate digit on position 3 by 8 times.If sum of digits on positions 1 and 4 is greater than 10, rotate digit on position 3 by 4 times, else rotate digit on position 5 by 1 times.If digit on position 3 is greater than digit on position 5, rotate digit on position 2 by 1 times, else rotate digit on position 1 by 6 times.If sum of digits on positions 1 and 5 is greater than 9, rotate digit on position 3 by 3 times, else rotate digit on position 2 by 1 times.If digit on position 5 is greater than digit on position 1, rotate digit on position 4 by 8 times, else rotate digit on position 2 by 1 times.If digit on position 4 is greater than digit on position 1, rotate digit on position 3 by 4 times, else rotate digit on position 5 by 4 times.If sum of digits on positions 3 and 1 is greater than 8, rotate digit on position 5 by 3 times, else rotate digit on position 2 by 6 times.If digit on position 3 is greater than digit on position 4, rotate digit on position 2 by 3 times, else rotate digit on position 1 by 5 times.If digit on position 5 is greater than digit on position 4, rotate digit on position 2 by 7 times, else rotate digit on position 3 by 8 times.If digit on position 2 is greater than digit on position 4, rotate digit on position 5 by 9 times, else rotate digit on position 1 by 4 times.If sum of digits on positions 3 and 5 is greater than 10, rotate digit on position 4 by 1 times, else rotate digit on position 2 by 5 times.If digit on position 4 is greater than digit on position 1, rotate digit on position 3 by 9 times, else rotate digit on position 2 by 9 times.If digit on position 5 is greater than digit on position 3, rotate digit on position 2 by 4 times, else rotate digit on position 1 by 6 times.If sum of digits on positions 3 and 4 is greater than 9, rotate digit on position 5 by 8 times, else rotate digit on position 2 by 5 times.If sum of digits on positions 3 and 4 is greater than 10, rotate digit on position 5 by 2 times, else rotate digit on position 1 by 5 times.If sum of digits on positions 5 and 4 is greater than 9, rotate digit on position 3 by 3 times, else rotate digit on position 1 by 8 times.If digit on position 5 is greater than digit on position 2, rotate digit on position 1 by 4 times, else rotate digit on position 3 by 8 times.If digit on position 3 is greater than digit on position 1, rotate digit on position 5 by 6 times, else rotate digit on position 2 by 6 times.If digit on position 4 is greater than digit on position 5, rotate digit on position 1 by 6 times, else rotate digit on position 3 by 1 times.If sum of digits on positions 3 and 5 is greater than 10, rotate digit on position 2 by 5 times, else rotate digit on position 1 by 7 times.If sum of digits on positions 5 and 2 is greater than 9, rotate digit on position 4 by 9 times, else rotate digit on position 3 by 5 times.If sum of digits on positions 2 and 4 is greater than 10, rotate digit on position 3 by 1 times, else rotate digit on position 1 by 2 times.If digit on position 3 is greater than digit on position 4, rotate digit on position 5 by 7 times, else rotate digit on position 2 by 1 times.If digit on position 2 is greater than digit on position 5, rotate digit on position 1 by 6 times, else rotate digit on position 4 by 2 times.If digit on position 2 is greater than digit on position 1, rotate digit on position 5 by 3 times, else rotate digit on position 4 by 4 times.If digit on position 5 is greater than digit on position 4, rotate digit on position 3 by 9 times, else rotate digit on position 1 by 9 times.If digit on position 1 is greater than digit on position 5, rotate digit on position 4 by 6 times, else rotate digit on position 2 by 5 times.If sum of digits on positions 1 and 5 is greater than 10, rotate digit on position 3 by 7 times, else rotate digit on position 2 by 4 times.If sum of digits on positions 2 and 1 is greater than 9, rotate digit on position 3 by 7 times, else rotate digit on position 5 by 4 times." -999
1302F "Keep talking and nobody explodes -- easy" "bitmasks,brute force,expression parsing" "This is an unusual problem in an unusual contest, here is the announcement: http://codeforces.com/blog/entry/73543You have the safe lock which consists of 5 decimal digits. If you rotate some digit, it increases by one, except 9 which becomes 0.Initially, the lock contains number x. To unlock the safe you must do the following operations in order (and be careful, don\'t mix up if and else statements).If sum of digits on positions 1 and 4 is greater than 10, rotate digit on position 1 by 3 times, else rotate digit on position 4 by 8 times.If sum of digits on positions 3 and 2 is greater than 8, rotate digit on position 4 by 9 times, else rotate digit on position 5 by 8 times.If digit on position 3 is odd, rotate digit on position 3 by 3 times, else rotate digit on position 3 by 4 times.If digit on position 5 is greater than digit on position 2, rotate digit on position 4 by 1 times, else rotate digit on position 2 by 7 times.If digit on position 1 is odd, rotate digit on position 1 by 3 times, else rotate digit on position 3 by 5 times.If digit on position 4 is odd, rotate digit on position 4 by 7 times, else rotate digit on position 1 by 9 times.If digit on position 4 is greater than digit on position 1, rotate digit on position 4 by 9 times, else rotate digit on position 4 by 2 times.If digit on position 1 is greater than digit on position 3, rotate digit on position 2 by 1 times, else rotate digit on position 3 by 1 times.If digit on position 5 is greater than digit on position 3, rotate digit on position 4 by 5 times, else rotate digit on position 5 by 8 times.If sum of digits on positions 1 and 3 is greater than 8, rotate digit on position 4 by 5 times, else rotate digit on position 2 by 5 times.If digit on position 1 is greater than digit on position 4, rotate digit on position 4 by 3 times, else rotate digit on position 2 by 3 times.If sum of digits on positions 3 and 1 is greater than 9, rotate digit on position 2 by 9 times, else rotate digit on position 2 by 2 times.If sum of digits on positions 4 and 3 is greater than 10, rotate digit on position 4 by 7 times, else rotate digit on position 5 by 7 times.If digit on position 3 is greater than digit on position 2, rotate digit on position 3 by 2 times, else rotate digit on position 4 by 6 times.If digit on position 1 is greater than digit on position 3, rotate digit on position 1 by 9 times, else rotate digit on position 2 by 9 times.If digit on position 3 is odd, rotate digit on position 3 by 9 times, else rotate digit on position 1 by 5 times.If sum of digits on positions 3 and 5 is greater than 9, rotate digit on position 3 by 4 times, else rotate digit on position 3 by 9 times.If digit on position 3 is greater than digit on position 1, rotate digit on position 5 by 1 times, else rotate digit on position 5 by 7 times.If digit on position 1 is greater than digit on position 3, rotate digit on position 2 by 9 times, else rotate digit on position 4 by 6 times.If sum of digits on positions 2 and 3 is greater than 10, rotate digit on position 2 by 2 times, else rotate digit on position 3 by 6 times." -999
1302E "Amazing bitset" NA "This is an unusual problem in an unusual contest, here is the announcement: http://codeforces.com/blog/entry/73543Andrey has just started to study competitive programming and he is fascinated by bitsets and operations on them.For example, assume he has a bitset with n elements. He can change the values of the bitset in the following way:   He chooses different indices i0, i1, i2, ... ik (k\xe2\x89\xa51, 1\xe2\x89\xa4ij\xe2\x89\xa4n) so that bit i0 is different from all bits i1, i2, ... ik.  He flips all these k+1 bits.  He calls a bitset amazing if he can flip all the bits using several such changes.Another topic Andrey is interested in is probability theory. For given n and p, where p is a rational number represented as ab with integer a,b, he considers all bitsets of length n, where each element is equal to 1 with probability p independently of the other elements.He wants to know the probability that a bitset generated by the described method is amazing.It is guaranteed that the answer to this problem can be represented as a rational number xy, where y is coprime with 1234567891. You need to output such integer z that x\xe2\x89\xa1yz(mod1234567891) and 0\xe2\x89\xa4z<1234567891." -999
1302D Dijkstra NA "This is an unusual problem in an unusual contest, here is the announcement: http://codeforces.com/blog/entry/73543Find the distance between vertices 1 and n in an undirected weighted graph." -999
1302C "Segment tree or Fenwick?" "data structures" "This is an unusual problem in an unusual contest, here is the announcement: http://codeforces.com/blog/entry/73543You are given an array A of length n, initially filled with zeros. You need to process q queries to the array, each of one of the following types:   1 x y: you need to assign Ax=y;  2 l r: you need to print r\xe2\x88\x91i=lAi.  Furthermore, there are T independent tests you need to process." -999
1302B DAG "constructive algorithms" "This is an unusual problem in an unusual contest, here is the announcement: http://codeforces.com/blog/entry/73543You are given a directed acyclic graph G with n vertices and m edges. Denote by R(v) the set of all vertices u reachable from v by moving along the edges of G. Find n\xe2\x88\x91v=1|R(v)|2." -999
1302A "Nash equilibrium" NA "This is an unusual problem in an unusual contest, here is the announcement: http://codeforces.com/blog/entry/73543You are given a table A of integers n\xc3\x97m. The cell (x,y) is called Nash equilibrium if both of the following conditions hold:   for each x1\xe2\x89\xa0x Axy>Ax1y;  for each y1\xe2\x89\xa0y Axy<Axy1. Find a Nash equilibrium in A. If there exist several equilibria, print the one with minimum x. If still there are several possible answers, print the one with minimum y." -999
1301F "Super Jaber" "dfs and similar,graphs,implementation,shortest paths" "Jaber is a superhero in a large country that can be described as a grid with n rows and m columns, where every cell in that grid contains a different city.Jaber gave every city in that country a specific color between 1 and k. In one second he can go from the current city to any of the cities adjacent by the side or to any city with the same color as the current city color.Jaber has to do q missions. In every mission he will be in the city at row r1 and column c1, and he should help someone in the city at row r2 and column c2.Jaber wants your help to tell him the minimum possible time to go from the starting city to the finishing city for every mission." 2600
1301E Nanosoft "binary search,data structures,dp,implementation" "Warawreh created a great company called Nanosoft. The only thing that Warawreh still has to do is to place a large picture containing its logo on top of the company\'s building.The logo of Nanosoft can be described as four squares of the same size merged together into one large square. The top left square is colored with red, the top right square is colored with green, the bottom left square is colored with yellow and the bottom right square is colored with blue.An Example of some correct logos:An Example of some incorrect logos:Warawreh went to Adhami\'s store in order to buy the needed picture. Although Adhami\'s store is very large he has only one picture that can be described as a grid of n rows and m columns. The color of every cell in the picture will be green (the symbol \'G\'), red (the symbol \'R\'), yellow (the symbol \'Y\') or blue (the symbol \'B\').Adhami gave Warawreh q options, in every option he gave him a sub-rectangle from that picture and told him that he can cut that sub-rectangle for him. To choose the best option, Warawreh needs to know for every option the maximum area of sub-square inside the given sub-rectangle that can be a Nanosoft logo. If there are no such sub-squares, the answer is 0.Warawreh couldn\'t find the best option himself so he asked you for help, can you help him?" 2500
1301D "Time to Run" "constructive algorithms,graphs,implementation" "Bashar was practicing for the national programming contest. Because of sitting too much in front of the computer without doing physical movements and eating a lot Bashar became much fatter. Bashar is going to quit programming after the national contest and he is going to become an actor (just like his father), so he should lose weight.In order to lose weight, Bashar is going to run for k kilometers. Bashar is going to run in a place that looks like a grid of n rows and m columns. In this grid there are two one-way roads of one-kilometer length between each pair of adjacent by side cells, one road is going from the first cell to the second one, and the other road is going from the second cell to the first one. So, there are exactly (4nm\xe2\x88\x922n\xe2\x88\x922m) roads.Let\'s take, for example, n=3 and m=4. In this case, there are 34 roads. It is the picture of this case (arrows describe roads):Bashar wants to run by these rules:  He starts at the top-left cell in the grid;  In one move Bashar may go up (the symbol \'U\'), down (the symbol \'D\'), left (the symbol \'L\') or right (the symbol \'R\'). More formally, if he stands in the cell in the row i and in the column j, i.e. in the cell (i,j) he will move to:   in the case \'U\' to the cell (i\xe2\x88\x921,j);  in the case \'D\' to the cell (i+1,j);  in the case \'L\' to the cell (i,j\xe2\x88\x921);  in the case \'R\' to the cell (i,j+1);   He wants to run exactly k kilometers, so he wants to make exactly k moves;  Bashar can finish in any cell of the grid;  He can\'t go out of the grid so at any moment of the time he should be on some cell;  Bashar doesn\'t want to get bored while running so he must not visit the same road twice. But he can visit the same cell any number of times. Bashar asks you if it is possible to run by such rules. If it is possible, you should tell him how should he run.You should give him a steps to do and since Bashar can\'t remember too many steps, a should not exceed 3000. In every step, you should give him an integer f and a string of moves s of length at most 4 which means that he should repeat the moves in the string s for f times. He will perform the steps in the order you print them.For example, if the steps are 2 RUD, 3 UUL then the moves he is going to move are RUD + RUD + UUL + UUL + UUL = RUDRUDUULUULUUL.Can you help him and give him a correct sequence of moves such that the total distance he will run is equal to k kilometers or say, that it is impossible?" 2000
1301C "Ayoub\'s function" "binary search,combinatorics,greedy,math,strings" "Ayoub thinks that he is a very smart person, so he created a function f(s), where s is a binary string (a string which contains only symbols ""0"" and ""1""). The function f(s) is equal to the number of substrings in the string s that contains at least one symbol, that is equal to ""1"".More formally, f(s) is equal to the number of pairs of integers (l,r), such that 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4|s| (where |s| is equal to the length of string s), such that at least one of the symbols sl,sl+1,\xe2\x80\xa6,sr is equal to ""1"". For example, if s=""01010"" then f(s)=12, because there are 12 such pairs (l,r): (1,2),(1,3),(1,4),(1,5),(2,2),(2,3),(2,4),(2,5),(3,4),(3,5),(4,4),(4,5).Ayoub also thinks that he is smarter than Mahmoud so he gave him two integers n and m and asked him this problem. For all binary strings s of length n which contains exactly m symbols equal to ""1"", find the maximum value of f(s).Mahmoud couldn\'t solve the problem so he asked you for help. Can you help him?" 1700
1301B "Motarack\'s Birthday" "binary search,greedy,ternary search" "Dark is going to attend Motarack\'s birthday. Dark decided that the gift he is going to give to Motarack is an array a of n non-negative integers.Dark created that array 1000 years ago, so some elements in that array disappeared. Dark knows that Motarack hates to see an array that has two adjacent elements with a high absolute difference between them. He doesn\'t have much time so he wants to choose an integer k (0\xe2\x89\xa4k\xe2\x89\xa4109) and replaces all missing elements in the array a with k.Let m be the maximum absolute difference between all adjacent elements (i.e. the maximum value of |ai\xe2\x88\x92ai+1| for all 1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921) in the array a after Dark replaces all missing elements with k.Dark should choose an integer k so that m is minimized. Can you help him?" 1500
1301A "Three Strings" implementation,strings "You are given three strings a, b and c of the same length n. The strings consist of lowercase English letters only. The i-th letter of a is ai, the i-th letter of b is bi, the i-th letter of c is ci.For every i (1\xe2\x89\xa4i\xe2\x89\xa4n) you must swap (i.e. exchange) ci with either ai or bi. So in total you\'ll perform exactly n swap operations, each of them either ci\xe2\x86\x94ai or ci\xe2\x86\x94bi (i iterates over all integers between 1 and n, inclusive).For example, if a is ""code"", b is ""true"", and c is ""help"", you can make c equal to ""crue"" taking the 1-st and the 4-th letters from a and the others from b. In this way a becomes ""hodp"" and b becomes ""tele"".Is it possible that after these swaps the string a becomes exactly the same as the string b?" 800
1300B "Assigning to Classes" greedy,implementation,sortings "Reminder: the median of the array [a1,a2,\xe2\x80\xa6,a2k+1] of odd number of elements is defined as follows: let [b1,b2,\xe2\x80\xa6,b2k+1] be the elements of the array in the sorted order. Then median of this array is equal to bk+1.There are 2n students, the i-th student has skill level ai. It\'s not guaranteed that all skill levels are distinct.Let\'s define skill level of a class as the median of skill levels of students of the class.As a principal of the school, you would like to assign each student to one of the 2 classes such that each class has odd number of students (not divisible by 2). The number of students in the classes may be equal or different, by your choice. Every student has to be assigned to exactly one class. Among such partitions, you want to choose one in which the absolute difference between skill levels of the classes is minimized.What is the minimum possible absolute difference you can achieve?" 1000
1300A Non-zero implementation,math "Guy-Manuel and Thomas have an array a of n integers [a1,a2,\xe2\x80\xa6,an]. In one step they can add 1 to any element of the array. Formally, in one step they can choose any integer index i (1\xe2\x89\xa4i\xe2\x89\xa4n) and do ai:=ai+1.If either the sum or the product of all elements in the array is equal to zero, Guy-Manuel and Thomas do not mind to do this operation one more time.What is the minimum number of steps they need to do to make both the sum and the product of all elements in the array different from zero? Formally, find the minimum number of steps to make a1+a2+ \xe2\x80\xa6 +an\xe2\x89\xa00 and a1\xe2\x8b\x85a2\xe2\x8b\x85 \xe2\x80\xa6 \xe2\x8b\x85an\xe2\x89\xa00." 800
1299E "So Mean" interactive,math "This problem is interactive.We have hidden a permutation p1,p2,\xe2\x80\xa6,pn of numbers from 1 to n from you, where n is even. You can try to guess it using the following queries:? k a1 a2 \xe2\x80\xa6 ak.In response, you will learn if the average of elements with indexes a1,a2,\xe2\x80\xa6,ak is an integer. In other words, you will receive 1 if pa1+pa2+\xe2\x8b\xaf+pakk is integer, and 0 otherwise. You have to guess the permutation. You can ask not more than 18n queries.Note that permutations [p1,p2,\xe2\x80\xa6,pk] and [n+1\xe2\x88\x92p1,n+1\xe2\x88\x92p2,\xe2\x80\xa6,n+1\xe2\x88\x92pk] are indistinguishable. Therefore, you are guaranteed that p1\xe2\x89\xa4n2.Note that the permutation p is fixed before the start of the interaction and doesn\'t depend on your queries. In other words, interactor is not adaptive.Note that you don\'t have to minimize the number of queries." 3400
1299D "Around the World" "bitmasks,combinatorics,dfs and similar,dp,graphs,graphs,math,trees" "Guy-Manuel and Thomas are planning 144 trips around the world.You are given a simple weighted undirected connected graph with n vertexes and m edges with the following restriction: there isn\'t any simple cycle (i. e. a cycle which doesn\'t pass through any vertex more than once) of length greater than 3 which passes through the vertex 1. The cost of a path (not necessarily simple) in this graph is defined as the XOR of weights of all edges in that path with each edge being counted as many times as the path passes through it.But the trips with cost 0 aren\'t exciting. You may choose any subset of edges incident to the vertex 1 and remove them. How many are there such subsets, that, when removed, there is not any nontrivial cycle with the cost equal to 0 which passes through the vertex 1 in the resulting graph? A cycle is called nontrivial if it passes through some edge odd number of times. As the answer can be very big, output it modulo 109+7." 3000
1299C "Water Balance" "data structures,geometry,greedy" "There are n water tanks in a row, i-th of them contains ai liters of water. The tanks are numbered from 1 to n from left to right.You can perform the following operation: choose some subsegment [l,r] (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n), and redistribute water in tanks l,l+1,\xe2\x80\xa6,r evenly. In other words, replace each of al,al+1,\xe2\x80\xa6,ar by al+al+1+\xe2\x8b\xaf+arr\xe2\x88\x92l+1. For example, if for volumes [1,3,6,7] you choose l=2,r=3, new volumes of water will be [1,4.5,4.5,7]. You can perform this operation any number of times.What is the lexicographically smallest sequence of volumes of water that you can achieve?As a reminder:A sequence a is lexicographically smaller than a sequence b of the same length if and only if the following holds: in the first (leftmost) position where a and b differ, the sequence a has a smaller element than the corresponding element in b." 2100
1299B Aerodynamic geometry "Guy-Manuel and Thomas are going to build a polygon spaceship. You\'re given a strictly convex (i. e. no three points are collinear) polygon P which is defined by coordinates of its vertices. Define P(x,y) as a polygon obtained by translating P by vector \xe2\x86\x92(x,y). The picture below depicts an example of the translation:Define T as a set of points which is the union of all P(x,y) such that the origin (0,0) lies in P(x,y) (both strictly inside and on the boundary). There is also an equivalent definition: a point (x,y) lies in T only if there are two points A,B in P such that \xe2\x86\x92AB=\xe2\x86\x92(x,y). One can prove T is a polygon too. For example, if P is a regular triangle then T is a regular hexagon. At the picture below P is drawn in black and some P(x,y) which contain the origin are drawn in colored: The spaceship has the best aerodynamic performance if P and T are similar. Your task is to check whether the polygons P and T are similar." 1800
1299A "Anu Has a Function" "brute force,greedy,math" "Anu has created her own function f: f(x,y)=(x|y)\xe2\x88\x92y where | denotes the bitwise OR operation. For example, f(11,6)=(11|6)\xe2\x88\x926=15\xe2\x88\x926=9. It can be proved that for any nonnegative numbers x and y value of f(x,y) is also nonnegative. She would like to research more about this function and has created multiple problems for herself. But she isn\'t able to solve all of them and needs your help. Here is one of these problems.A value of an array [a1,a2,\xe2\x80\xa6,an] is defined as f(f(\xe2\x80\xa6f(f(a1,a2),a3),\xe2\x80\xa6an\xe2\x88\x921),an) (see notes). You are given an array with not necessarily distinct elements. How should you reorder its elements so that the value of the array is maximal possible?" 1500
1297I "Falling Blocks" "*special problem,data structures" "Recently, Polycarp has invented a new mobile game with falling blocks.In the game, n blocks are falling down, one at a time, towards a flat surface with length d units. Each block can be represented as a rectangle with coordinates from li to ri and unit height, dropped downwards from very high up. A block falls until it comes in contact with the flat surface or any other block. Let\'s define that block a covers block b if la\xe2\x89\xa4lb\xe2\x89\xa4rb\xe2\x89\xa4ra. Consider what happens when a new block i falls. If the new (upper) block i comes in contact with any block j such that block i does not cover block j, block i will stick to block j, and no blocks will disappear. Otherwise, all blocks that block i covers and is in contact with will be vaporized, and block i will continue falling with the ability to vaporize lower blocks.For example, consider what happens when three blocks (1,2), (2,3) and (1,3) fall, in that order. The first block will stick to the flat surface. Then, the second block will stick to the first block. Finally, the third block will vaporize the second block, keep falling, vaporize the first block, and stick to the flat surface.  Here is a graphic for the first example. After each block falls, help Polycarp determine how many blocks will remain!" -999
1297H "Paint the String" "*special problem,dp,strings" "You are given a string s of lowercase Latin letters. It is required to paint each letter of the string in one of two colors (red or blue) so that if you write all the red letters from left to right and write all the blue letters from left to right, then the lexicographically maximum of the two written strings is lexicographically minimal. For each index, in the string s you can choose either of two colors.Formally, we write out:  the string r (can be empty) \xe2\x80\x94 all red letters in the order from left to right (red subsequence),  the string b (can be empty) \xe2\x80\x94 all blue letters in the order from left to right (blue subsequence). Your task is to paint the string such that max(r,b) is minimal. Small reminder: the empty string is the lexicographically smallest string." -999
1297G M-numbers "*special problem,dp,math" "For a given positive integer m, a positive number is called a m-number if the product of its digits is m. For example, the beginning of a series of 24-numbers are as follows: 38, 46, 64, 83, 138, 146, 164, 183, 226 ...You are given a positive integer m and k. Print k-th among m-numbers if all m-numbers are sorted in ascending order." -999
1297F "Movie Fan" "*special problem,data structures,greedy,implementation,sortings" "Recently, Polycarp has been a fan of cinema novelties and is trying not to miss them!In the near future, n new movies will be released: the i-th of them will be airing from the day ai and to the day bi. This means that if Polycarp wants to watch the i-th movie in the cinema, he must do so in the period from ai to bi inclusive.If perhaps Polycarp will not have the opportunity to watch a movie in a cinema, he can then do it after day bi by watching it using an online service. Of course, this is an undesirable outcome for Polycarp because the whole world will have time to discuss this movie on social networks!Polycarp can watch no more than m movies per day. Help Polycarp find a movie-watching schedule such that every movie will be watched in the cinema. If such a schedule does not exist, then Polycarp wants to watch movies so that:  for each movie that he doesn\'t have time to watch in the cinema, we will find the number of days between the end of its airing and the day when Polycarpus watches the movie,  the maximum of the values from the previous point should be as small as possible." -999
1297E "Modernization of Treeland" "*special problem,dfs and similar,trees" "Treeland consists of n cities and n\xe2\x88\x921 two-way roads connecting pairs of cities. From every city, you can reach every other city moving only by the roads. You are right, the system of cities and roads in this country forms an undirected tree.The government has announced a program for the modernization of urban infrastructure of some cities. You have been assigned to select an arbitrary subset of cities S to upgrade (potentially all the cities) that satisfies the following requirements:  the subset of cities must be ""connected"", that is, from any city of the subset S you can get to any other city of the subset S by roads, moving only through cities from S,  the number of ""dead-ends"" in S must be equal to the given number k. A city is a ""dead-end"" if it is the only city in S or connected to exactly one another city from S.   This shows one of the possible ways to select S (blue vertices) for a given configuration and k=4. Dead-ends are vertices with numbers 1, 4, 6 and 7. Help Treeland upgrade its cities. Find any of the possible subsets S or determine that such a subset does not exist." -999
1297D "Bonus Distribution" "*special problem,binary search,greedy,sortings" "For the first time, Polycarp\'s startup ended the year with a profit! Now he is about to distribute k burles as a bonus among n employees.It is known that the current salary of the i-th employee is ai and all the values of ai in the company are different.Polycarp wants to distribute the k burles between n employees so this month the i-th employee will be paid not ai, but ai+di (di\xe2\x89\xa50, di is an integer), where di is the bonus for the i-th employee. Of course, d1+d2+\xe2\x8b\xaf+dn=k.Polycarp will follow two rules for choosing the values di:  the relative order of the salaries should not be changed: the employee with originally the highest salary (ai is the maximum) should have the highest total payment after receiving their bonus (ai+di is also the maximum), the employee whose salary was originally the second-largest should receive the second-largest total payment after receiving their bonus and so on.  to emphasize that annual profit is a group effort, Polycarp wants to minimize the maximum total payment to an employee (i.e minimize the maximum value of ai+di). Help Polycarp decide the non-negative integer bonuses di such that:  their sum is k,  for each employee, the number of those who receive strictly more than them remains unchanged (that is, if you sort employees by ai and by ai+di, you get the same order of employees),  all ai+di are different,  the maximum of the values ai+di is the minimum possible. Help Polycarp and print any of the possible answers d1,d2,\xe2\x80\xa6,dn." -999
1297C "Dream Team" "*special problem,greedy" "Polycarp is the project manager in the IT-company. Right now, he needs to choose developers for his team to start a new project. The company has n developers ""on the bench"" (i.e not involved in other projects). Polycarp assessed the skills of each of them: ai (\xe2\x88\x92104\xe2\x89\xa4ai\xe2\x89\xa4104) \xe2\x80\x94 an integer characteristic of the i-th developer. This value can be either positive, zero or even negative (some developers cause distractions).After Polycarp chooses a subset of developers for his team, the strength of the team will be determined by the sum of ai values for all selected developers.Polycarp fears that if he chooses a team in such a way that maximizes the sum of the characteristics of ai, other managers may find this unacceptable. For this reason, he plans to create such a team that the sum of the ai values for it is strictly less than the maximum possible value.Help Polycarp choose any team that:  the sum of the characteristics ai for all members of the selected team is strictly less than the maximum value that can be achieved by choosing the team in some other way  and at the same time, the sum of the characteristics of ai for all members of the selected team is the greatest possible. If, following the requirements above, you can select a team in several ways, then just find any of them. It\'s guaranteed that the sum of the characteristics in the desired subset is strictly positive (i.e. Polycarp can always choose a non-empty team)." -999
1297B Cartoons "*special problem,implementation,sortings" "Tanya likes cartoons. She knows that n new cartoons will be released in his favorite cinema: the i-th of them will be airing from the day ai to the day bi (1\xe2\x89\xa4ai\xe2\x89\xa4bi\xe2\x89\xa4109).The cinema has a special offer: there is a huge discount every day when only one cartoon is airing.Tanya doesn\'t care which cartoon she will watch but she\'d like to save some money. That\'s why she asks you to find any day x when only one cartoon will be airing. Formally: find x such that there is exactly one i (1\xe2\x89\xa4i\xe2\x89\xa4n) with ai\xe2\x89\xa4x\xe2\x89\xa4bi. If there are several possible answers, print any of them. If there is no such day, print -1." -999
1297A "Likes Display" "*special problem,implementation" "Polycarp is working on the implementation of displaying likes on the Codehorses social network. The number of likes should be displayed in a format that will be easy to read by users. It was decided that for large numbers of likes the format should be like 123K (one hundred twenty-three thousand) or like 56M (fifty-six million).The following displaying strategy has been approved:  the number will be displayed either as an integer number from 0 to 999, or as a positive integer number of thousands (from 1K to 999K), or as a positive integer number of millions (from 1M on),  the specified exact number of likes n when displaying should be rounded to the nearest view from the case above (if rounding is ambiguous, it must be rounded up): for example, 1785 should be rounded to 2K instead of 1K, 4500000 should be rounded to 5M. Help Polycarp implement this part of the functionality: for a given non-negative integer number of likes n, print its view in the Codehorses interface." -999
1296F "Berland Beauty" "constructive algorithms,dfs and similar,greedy,sortings,trees" "There are n railway stations in Berland. They are connected to each other by n\xe2\x88\x921 railway sections. The railway network is connected, i.e. can be represented as an undirected tree.You have a map of that network, so for each railway section you know which stations it connects.Each of the n\xe2\x88\x921 sections has some integer value of the scenery beauty. However, these values are not marked on the map and you don\'t know them. All these values are from 1 to 106 inclusive.You asked m passengers some questions: the j-th one told you three values:  his departure station aj;  his arrival station bj;  minimum scenery beauty along the path from aj to bj (the train is moving along the shortest path from aj to bj). You are planning to update the map and set some value fi on each railway section \xe2\x80\x94 the scenery beauty. The passengers\' answers should be consistent with these values.Print any valid set of values f1,f2,\xe2\x80\xa6,fn\xe2\x88\x921, which the passengers\' answer is consistent with or report that it doesn\'t exist." 2100
1296E2 "String Coloring (hard version)" "data structures,dp" "This is a hard version of the problem. The actual problems are different, but the easy version is almost a subtask of the hard version. Note that the constraints and the output format are different.You are given a string s consisting of n lowercase Latin letters.You have to color all its characters the minimum number of colors (each character to exactly one color, the same letters can be colored the same or different colors, i.e. you can choose exactly one color for each index in s).After coloring, you can swap any two neighboring characters of the string that are colored different colors. You can perform such an operation arbitrary (possibly, zero) number of times.The goal is to make the string sorted, i.e. all characters should be in alphabetical order.Your task is to find the minimum number of colors which you have to color the given string in so that after coloring it can become sorted by some sequence of swaps. Note that you have to restore only coloring, not the sequence of swaps." 2000
1296E1 "String Coloring (easy version)" "constructive algorithms,dp,graphs,greedy,sortings" "This is an easy version of the problem. The actual problems are different, but the easy version is almost a subtask of the hard version. Note that the constraints and the output format are different.You are given a string s consisting of n lowercase Latin letters.You have to color all its characters one of the two colors (each character to exactly one color, the same letters can be colored the same or different colors, i.e. you can choose exactly one color for each index in s).After coloring, you can swap any two neighboring characters of the string that are colored different colors. You can perform such an operation arbitrary (possibly, zero) number of times.The goal is to make the string sorted, i.e. all characters should be in alphabetical order.Your task is to say if it is possible to color the given string so that after coloring it can become sorted by some sequence of swaps. Note that you have to restore only coloring, not the sequence of swaps." 1800
1296D "Fight with Monsters" greedy,sortings "There are n monsters standing in a row numbered from 1 to n. The i-th monster has hi health points (hp). You have your attack power equal to a hp and your opponent has his attack power equal to b hp.You and your opponent are fighting these monsters. Firstly, you and your opponent go to the first monster and fight it till his death, then you and your opponent go the second monster and fight it till his death, and so on. A monster is considered dead if its hp is less than or equal to 0.The fight with a monster happens in turns.   You hit the monster by a hp. If it is dead after your hit, you gain one point and you both proceed to the next monster.  Your opponent hits the monster by b hp. If it is dead after his hit, nobody gains a point and you both proceed to the next monster. You have some secret technique to force your opponent to skip his turn. You can use this technique at most k times in total (for example, if there are two monsters and k=4, then you can use the technique 2 times on the first monster and 1 time on the second monster, but not 2 times on the first monster and 3 times on the second monster).Your task is to determine the maximum number of points you can gain if you use the secret technique optimally." 1500
1296C "Yet Another Walking Robot" "data structures,implementation" "There is a robot on a coordinate plane. Initially, the robot is located at the point (0,0). Its path is described as a string s of length n consisting of characters \'L\', \'R\', \'U\', \'D\'.Each of these characters corresponds to some move:   \'L\' (left): means that the robot moves from the point (x,y) to the point (x\xe2\x88\x921,y);  \'R\' (right): means that the robot moves from the point (x,y) to the point (x+1,y);  \'U\' (up): means that the robot moves from the point (x,y) to the point (x,y+1);  \'D\' (down): means that the robot moves from the point (x,y) to the point (x,y\xe2\x88\x921). The company that created this robot asked you to optimize the path of the robot somehow. To do this, you can remove any non-empty substring of the path. But this company doesn\'t want their customers to notice the change in the robot behavior. It means that if before the optimization the robot ended its path at the point (xe,ye), then after optimization (i.e. removing some single substring from s) the robot also ends its path at the point (xe,ye).This optimization is a low-budget project so you need to remove the shortest possible non-empty substring to optimize the robot\'s path such that the endpoint of his path doesn\'t change. It is possible that you can\'t optimize the path. Also, it is possible that after the optimization the target path is an empty string (i.e. deleted substring is the whole string s).Recall that the substring of s is such string that can be obtained from s by removing some amount of characters (possibly, zero) from the prefix and some amount of characters (possibly, zero) from the suffix. For example, the substrings of ""LURLLR"" are ""LU"", ""LR"", ""LURLLR"", ""URL"", but not ""RR"" and ""UL"".You have to answer t independent test cases." 1500
1296B "Food Buying" math "Mishka wants to buy some food in the nearby shop. Initially, he has s burles on his card. Mishka can perform the following operation any number of times (possibly, zero): choose some positive integer number 1\xe2\x89\xa4x\xe2\x89\xa4s, buy food that costs exactly x burles and obtain \xe2\x8c\x8ax10\xe2\x8c\x8b burles as a cashback (in other words, Mishka spends x burles and obtains \xe2\x8c\x8ax10\xe2\x8c\x8b back). The operation \xe2\x8c\x8aab\xe2\x8c\x8b means a divided by b rounded down.It is guaranteed that you can always buy some food that costs x for any possible value of x.Your task is to say the maximum number of burles Mishka can spend if he buys food optimally.For example, if Mishka has s=19 burles then the maximum number of burles he can spend is 21. Firstly, he can spend x=10 burles, obtain 1 burle as a cashback. Now he has s=10 burles, so can spend x=10 burles, obtain 1 burle as a cashback and spend it too.You have to answer t independent test cases." 900
1296A "Array with Odd Sum" math "You are given an array a consisting of n integers.In one move, you can choose two indices 1\xe2\x89\xa4i,j\xe2\x89\xa4n such that i\xe2\x89\xa0j and set ai:=aj. You can perform such moves any number of times (possibly, zero). You can choose different indices in different operations. The operation := is the operation of assignment (i.e. you choose i and j and replace ai with aj).Your task is to say if it is possible to obtain an array with an odd (not divisible by 2) sum of elements.You have to answer t independent test cases." 800
1295F "Good Contest" combinatorics,dp,probabilities "An online contest will soon be held on ForceCoders, a large competitive programming platform. The authors have prepared n problems; and since the platform is very popular, 998244351 coder from all over the world is going to solve them.For each problem, the authors estimated the number of people who would solve it: for the i-th problem, the number of accepted solutions will be between li and ri, inclusive.The creator of ForceCoders uses different criteria to determine if the contest is good or bad. One of these criteria is the number of inversions in the problem order. An inversion is a pair of problems (x,y) such that x is located earlier in the contest (x<y), but the number of accepted solutions for y is strictly greater.Obviously, both the creator of ForceCoders and the authors of the contest want the contest to be good. Now they want to calculate the probability that there will be no inversions in the problem order, assuming that for each problem i, any integral number of accepted solutions for it (between li and ri) is equally probable, and all these numbers are independent." 2700
1295E "Permutation Separation" "data structures,divide and conquer" "You are given a permutation p1,p2,\xe2\x80\xa6,pn (an array where each integer from 1 to n appears exactly once). The weight of the i-th element of this permutation is ai.At first, you separate your permutation into two non-empty sets \xe2\x80\x94 prefix and suffix. More formally, the first set contains elements p1,p2,\xe2\x80\xa6,pk, the second \xe2\x80\x94 pk+1,pk+2,\xe2\x80\xa6,pn, where 1\xe2\x89\xa4k<n.After that, you may move elements between sets. The operation you are allowed to do is to choose some element of the first set and move it to the second set, or vice versa (move from the second set to the first). You have to pay ai dollars to move the element pi.Your goal is to make it so that each element of the first set is less than each element of the second set. Note that if one of the sets is empty, this condition is met.For example, if p=[3,1,2] and a=[7,1,4], then the optimal strategy is: separate p into two parts [3,1] and [2] and then move the 2-element into first set (it costs 4). And if p=[3,5,1,6,2,4], a=[9,1,9,9,1,9], then the optimal strategy is: separate p into two parts [3,5,1] and [6,2,4], and then move the 2-element into first set (it costs 1), and 5-element into second set (it also costs 1).Calculate the minimum number of dollars you have to spend." 2200
1295D "Same GCDs" "math,number theory" "You are given two integers a and m. Calculate the number of integers x such that 0\xe2\x89\xa4x<m and gcd(a,m)=gcd(a+x,m).Note: gcd(a,b) is the greatest common divisor of a and b." 1800
1295C "Obtain The String" dp,greedy,strings "You are given two strings s and t consisting of lowercase Latin letters. Also you have a string z which is initially empty. You want string z to be equal to string t. You can perform the following operation to achieve this: append any subsequence of s at the end of string z. A subsequence is a sequence that can be derived from the given sequence by deleting zero or more elements without changing the order of the remaining elements. For example, if z=ac, s=abcde, you may turn z into following strings in one operation:   z=acace (if we choose subsequence ace);  z=acbcd (if we choose subsequence bcd);  z=acbce (if we choose subsequence bce). Note that after this operation string s doesn\'t change.Calculate the minimum number of such operations to turn string z into string t." 1600
1295B "Infinite Prefixes" math,strings "You are given string s of length n consisting of 0-s and 1-s. You build an infinite string t as a concatenation of an infinite number of strings s, or t=ssss\xe2\x80\xa6 For example, if s= 10010, then t= 100101001010010...Calculate the number of prefixes of t with balance equal to x. The balance of some string q is equal to cnt0,q\xe2\x88\x92cnt1,q, where cnt0,q is the number of occurrences of 0 in q, and cnt1,q is the number of occurrences of 1 in q. The number of such prefixes can be infinite; if it is so, you must say that.A prefix is a string consisting of several first letters of a given string, without any reorders. An empty prefix is also a valid prefix. For example, the string ""abcd"" has 5 prefixes: empty string, ""a"", ""ab"", ""abc"" and ""abcd""." 1700
1295A "Display The Number" greedy "You have a large electronic screen which can display up to 998244353 decimal digits. The digits are displayed in the same way as on different electronic alarm clocks: each place for a digit consists of 7 segments which can be turned on and off to compose different digits. The following picture describes how you can display all 10 decimal digits:As you can see, different digits may require different number of segments to be turned on. For example, if you want to display 1, you have to turn on 2 segments of the screen, and if you want to display 8, all 7 segments of some place to display a digit should be turned on.You want to display a really large integer on the screen. Unfortunately, the screen is bugged: no more than n segments can be turned on simultaneously. So now you wonder what is the greatest integer that can be displayed by turning on no more than n segments.Your program should be able to process t different test cases." 900
1294F "Three Paths on a Tree" "dfs and similar,dp,greedy,trees" "You are given an unweighted tree with n vertices. Recall that a tree is a connected undirected graph without cycles.Your task is to choose three distinct vertices a,b,c on this tree such that the number of edges which belong to at least one of the simple paths between a and b, b and c, or a and c is the maximum possible. See the notes section for a better understanding.The simple path is the path that visits each vertex at most once." 2000
1294E "Obtain a Permutation" greedy,implementation,math "You are given a rectangular matrix of size n\xc3\x97m consisting of integers from 1 to 2\xe2\x8b\x85105.In one move, you can:  choose any element of the matrix and change its value to any integer between 1 and n\xe2\x8b\x85m, inclusive;  take any column and shift it one cell up cyclically (see the example of such cyclic shift below). A cyclic shift is an operation such that you choose some j (1\xe2\x89\xa4j\xe2\x89\xa4m) and set a1,j:=a2,j,a2,j:=a3,j,\xe2\x80\xa6,an,j:=a1,j simultaneously.  Example of cyclic shift of the first column You want to perform the minimum number of moves to make this matrix look like this:  In other words, the goal is to obtain the matrix, where a1,1=1,a1,2=2,\xe2\x80\xa6,a1,m=m,a2,1=m+1,a2,2=m+2,\xe2\x80\xa6,an,m=n\xe2\x8b\x85m (i.e. ai,j=(i\xe2\x88\x921)\xe2\x8b\x85m+j) with the minimum number of moves performed." 1900
1294D "MEX maximizing" "data structures,greedy,implementation,math" "Recall that MEX of an array is a minimum non-negative integer that does not belong to the array. Examples:  for the array [0,0,1,0,2] MEX equals to 3 because numbers 0,1 and 2 are presented in the array and 3 is the minimum non-negative integer not presented in the array;  for the array [1,2,3,4] MEX equals to 0 because 0 is the minimum non-negative integer not presented in the array;  for the array [0,1,4,3] MEX equals to 2 because 2 is the minimum non-negative integer not presented in the array. You are given an empty array a=[] (in other words, a zero-length array). You are also given a positive integer x.You are also given q queries. The j-th query consists of one integer yj and means that you have to append one element yj to the array. The array length increases by 1 after a query.In one move, you can choose any index i and set ai:=ai+x or ai:=ai\xe2\x88\x92x (i.e. increase or decrease any element of the array by x). The only restriction is that ai cannot become negative. Since initially the array is empty, you can perform moves only after the first query.You have to maximize the MEX (minimum excluded) of the array if you can perform any number of such operations (you can even perform the operation multiple times with one element).You have to find the answer after each of q queries (i.e. the j-th answer corresponds to the array of length j).Operations are discarded before each query. I.e. the array a after the j-th query equals to [y1,y2,\xe2\x80\xa6,yj]." 1600
1294C "Product of Three Numbers" "greedy,math,number theory" "You are given one integer number n. Find three distinct integers a,b,c such that 2\xe2\x89\xa4a,b,c and a\xe2\x8b\x85b\xe2\x8b\x85c=n or say that it is impossible to do it.If there are several answers, you can print any.You have to answer t independent test cases." 1300
1294B "Collecting Packages" implementation,sortings "There is a robot in a warehouse and n packages he wants to collect. The warehouse can be represented as a coordinate grid. Initially, the robot stays at the point (0,0). The i-th package is at the point (xi,yi). It is guaranteed that there are no two packages at the same point. It is also guaranteed that the point (0,0) doesn\'t contain a package.The robot is semi-broken and only can move up (\'U\') and right (\'R\'). In other words, in one move the robot can go from the point (x,y) to the point (x+1,y) or to the point (x,y+1).As we say above, the robot wants to collect all n packages (in arbitrary order). He wants to do it with the minimum possible number of moves. If there are several possible traversals, the robot wants to choose the lexicographically smallest path.The string s of length n is lexicographically less than the string t of length n if there is some index 1\xe2\x89\xa4j\xe2\x89\xa4n that for all i from 1 to j\xe2\x88\x921 si=ti and sj<tj. It is the standard comparison of string, like in a dictionary. Most programming languages compare strings in this way." 1200
1294A "Collecting Coins" math "Polycarp has three sisters: Alice, Barbara, and Cerene. They\'re collecting coins. Currently, Alice has a coins, Barbara has b coins and Cerene has c coins. Recently Polycarp has returned from the trip around the world and brought n coins.He wants to distribute all these n coins between his sisters in such a way that the number of coins Alice has is equal to the number of coins Barbara has and is equal to the number of coins Cerene has. In other words, if Polycarp gives A coins to Alice, B coins to Barbara and C coins to Cerene (A+B+C=n), then a+A=b+B=c+C.Note that A, B or C (the number of coins Polycarp gives to Alice, Barbara and Cerene correspondingly) can be 0.Your task is to find out if it is possible to distribute all n coins between sisters in a way described above.You have to answer t independent test cases." 800
1293B "JOE is on TV!" combinatorics,greedy,math "3R2 - Standby for ActionOur dear Cafe\'s owner, JOE Miller, will soon take part in a new game TV-show ""1 vs. n""!The game goes in rounds, where in each round the host asks JOE and his opponents a common question. All participants failing to answer are eliminated. The show ends when only JOE remains (we assume that JOE never answers a question wrong!).For each question JOE answers, if there are s (s>0) opponents remaining and t (0\xe2\x89\xa4t\xe2\x89\xa4s) of them make a mistake on it, JOE receives ts dollars, and consequently there will be s\xe2\x88\x92t opponents left for the next question.JOE wonders what is the maximum possible reward he can receive in the best possible scenario. Yet he has little time before show starts, so can you help him answering it instead?" 1000
1293A "ConneR and the A.R.C. Markland-N" "binary search,brute force,implementation" "Sakuzyo - ImprintingA.R.C. Markland-N is a tall building with n floors numbered from 1 to n. Between each two adjacent floors in the building, there is a staircase connecting them.It\'s lunchtime for our sensei Colin ""ConneR"" Neumann Jr, and he\'s planning for a location to enjoy his meal.ConneR\'s office is at floor s of the building. On each floor (including floor s, of course), there is a restaurant offering meals. However, due to renovations being in progress, k of the restaurants are currently closed, and as a result, ConneR can\'t enjoy his lunch there.CooneR wants to reach a restaurant as quickly as possible to save time. What is the minimum number of staircases he needs to walk to reach a closest currently open restaurant.Please answer him quickly, and you might earn his praise and even enjoy the lunch with him in the elegant Neumanns\' way!" 1100
1292F "Nora\'s Toy Boxes" bitmasks,combinatorics,dp "SIHanatsuka - EMber SIHanatsuka - ATONEMENTBack in time, the seven-year-old Nora used to play lots of games with her creation ROBO_Head-02, both to have fun and enhance his abilities.One day, Nora\'s adoptive father, Phoenix Wyle, brought Nora n boxes of toys. Before unpacking, Nora decided to make a fun game for ROBO.She labelled all n boxes with n distinct integers a1,a2,\xe2\x80\xa6,an and asked ROBO to do the following action several (possibly zero) times:  Pick three distinct indices i, j and k, such that ai\xe2\x88\xa3aj and ai\xe2\x88\xa3ak. In other words, ai divides both aj and ak, that is ajmodai=0, akmodai=0.  After choosing, Nora will give the k-th box to ROBO, and he will place it on top of the box pile at his side. Initially, the pile is empty.  After doing so, the box k becomes unavailable for any further actions. Being amused after nine different tries of the game, Nora asked ROBO to calculate the number of possible different piles having the largest amount of boxes in them. Two piles are considered different if there exists a position where those two piles have different boxes.Since ROBO was still in his infant stages, and Nora was still too young to concentrate for a long time, both fell asleep before finding the final answer. Can you help them?As the number of such piles can be very large, you should print the answer modulo 109+7." 3500
1292E "Rin and The Unknown Flower" "constructive algorithms,greedy,interactive,math" "MisoilePunch\xe2\x99\xaa - \xe5\xbd\xa9This is an interactive problem!On a normal day at the hidden office in A.R.C. Markland-N, Rin received an artifact, given to her by the exploration captain Sagar.After much analysis, she now realizes that this artifact contains data about a strange flower, which has existed way before the New Age. However, the information about its chemical structure has been encrypted heavily.The chemical structure of this flower can be represented as a string p. From the unencrypted papers included, Rin already knows the length n of that string, and she can also conclude that the string contains at most three distinct letters: ""C"" (as in Carbon), ""H"" (as in Hydrogen), and ""O"" (as in Oxygen).At each moment, Rin can input a string s of an arbitrary length into the artifact\'s terminal, and it will return every starting position of s as a substring of p.However, the artifact has limited energy and cannot be recharged in any way, since the technology is way too ancient and is incompatible with any current A.R.C.\'s devices. To be specific:  The artifact only contains 75 units of energy.  For each time Rin inputs a string s of length t, the artifact consumes 1t2 units of energy.  If the amount of energy reaches below zero, the task will be considered failed immediately, as the artifact will go black forever. Since the artifact is so precious yet fragile, Rin is very nervous to attempt to crack the final data. Can you give her a helping hand?" 3500
1292D "Chaotic V." "dp,graphs,greedy,math,number theory,trees" "\xc3\x86sir - CHAOS \xc3\x86sir - V.""Everything has been planned out. No more hidden concerns. The condition of Cytus is also perfect.The time right now...... 00:01:12......It\'s time.""The emotion samples are now sufficient. After almost 3 years, it\'s time for Ivy to awake her bonded sister, Vanessa.The system inside A.R.C.\'s Library core can be considered as an undirected graph with infinite number of processing nodes, numbered with all positive integers (1,2,3,\xe2\x80\xa6). The node with a number x (x>1), is directly connected with a node with number xf(x), with f(x) being the lowest prime divisor of x.Vanessa\'s mind is divided into n fragments. Due to more than 500 years of coma, the fragments have been scattered: the i-th fragment is now located at the node with a number ki! (a factorial of ki).To maximize the chance of successful awakening, Ivy decides to place the samples in a node P, so that the total length of paths from each fragment to P is smallest possible. If there are multiple fragments located at the same node, the path from that node to P needs to be counted multiple times.In the world of zeros and ones, such a requirement is very simple for Ivy. Not longer than a second later, she has already figured out such a node.But for a mere human like you, is this still possible?For simplicity, please answer the minimal sum of paths\' lengths from every fragment to the emotion samples\' assembly node P." 2700
1292C "Xenon\'s Attack on the Gangs" "combinatorics,dfs and similar,dp,greedy,trees" "INSPION FullBand Master - INSPION INSPION - IOLITE-SUNSTONEOn another floor of the A.R.C. Markland-N, the young man Simon ""Xenon"" Jackson, takes a break after finishing his project early (as always). Having a lot of free time, he decides to put on his legendary hacker ""X"" instinct and fight against the gangs of the cyber world.His target is a network of n small gangs. This network contains exactly n\xe2\x88\x921 direct links, each of them connecting two gangs together. The links are placed in such a way that every pair of gangs is connected through a sequence of direct links.By mining data, Xenon figured out that the gangs used a form of cross-encryption to avoid being busted: every link was assigned an integer from 0 to n\xe2\x88\x922 such that all assigned integers are distinct and every integer was assigned to some link. If an intruder tries to access the encrypted data, they will have to surpass S password layers, with S being defined by the following formula:S=\xe2\x88\x911\xe2\x89\xa4u<v\xe2\x89\xa4nmex(u,v)Here, mex(u,v) denotes the smallest non-negative integer that does not appear on any link on the unique simple path from gang u to gang v.Xenon doesn\'t know the way the integers are assigned, but it\'s not a problem. He decides to let his AI\'s instances try all the passwords on his behalf, but before that, he needs to know the maximum possible value of S, so that the AIs can be deployed efficiently.Now, Xenon is out to write the AI scripts, and he is expected to finish them in two hours. Can you find the maximum possible S before he returns?" 2300
1292B "Aroma\'s Search" "brute force,constructive algorithms,geometry,greedy,implementation" "THE SxPLAY & KIV\xce\x9b - \xe6\xbc\x82\xe6\xb5\x81 KIV\xce\x9b & Nikki Simmons - PerspectivesWith a new body, our idol Aroma White (or should we call her Kaori Minamiya?) begins to uncover her lost past through the OS space.The space can be considered a 2D plane, with an infinite number of data nodes, indexed from 0, with their coordinates defined as follows:  The coordinates of the 0-th node is (x0,y0)  For i>0, the coordinates of i-th node is (ax\xe2\x8b\x85xi\xe2\x88\x921+bx,ay\xe2\x8b\x85yi\xe2\x88\x921+by) Initially Aroma stands at the point (xs,ys). She can stay in OS space for at most t seconds, because after this time she has to warp back to the real world. She doesn\'t need to return to the entry point (xs,ys) to warp home.While within the OS space, Aroma can do the following actions:  From the point (x,y), Aroma can move to one of the following points: (x\xe2\x88\x921,y), (x+1,y), (x,y\xe2\x88\x921) or (x,y+1). This action requires 1 second.  If there is a data node at where Aroma is staying, she can collect it. We can assume this action costs 0 seconds. Of course, each data node can be collected at most once. Aroma wants to collect as many data as possible before warping back. Can you help her in calculating the maximum number of data nodes she could collect within t seconds?" 1700
1292A "NEKO\'s Maze Game" "data structures,dsu,implementation" "3R2 as DJ Mashiro - Happiness Breeze Ice - DJ Mashiro is dead or aliveNEKO#\xce\xa6\xcf\x89\xce\xa6 has just got a new maze game on her PC!The game\'s main puzzle is a maze, in the forms of a 2\xc3\x97n rectangle grid. NEKO\'s task is to lead a Nekomimi girl from cell (1,1) to the gate at (2,n) and escape the maze. The girl can only move between cells sharing a common side.However, at some moments during the game, some cells may change their state: either from normal ground to lava (which forbids movement into that cell), or vice versa (which makes that cell passable again). Initially all cells are of the ground type.After hours of streaming, NEKO finally figured out there are only q such moments: the i-th moment toggles the state of cell (ri,ci) (either from ground to lava or vice versa).Knowing this, NEKO wonders, after each of the q moments, whether it is still possible to move from cell (1,1) to cell (2,n) without going through any lava cells.Although NEKO is a great streamer and gamer, she still can\'t get through quizzes and problems requiring large amount of Brain Power. Can you help her?" 1400
1291F "Coffee Varieties (easy version)" graphs,interactive "This is the easy version of the problem. You can find the hard version in the Div. 1 contest. Both versions only differ in the number of times you can ask your friend to taste coffee.This is an interactive problem.You\'re considering moving to another city, where one of your friends already lives. There are n caf\xc3\xa9s in this city, where n is a power of two. The i-th caf\xc3\xa9 produces a single variety of coffee ai. As you\'re a coffee-lover, before deciding to move or not, you want to know the number d of distinct varieties of coffees produced in this city.You don\'t know the values a1,\xe2\x80\xa6,an. Fortunately, your friend has a memory of size k, where k is a power of two.Once per day, you can ask him to taste a cup of coffee produced by the caf\xc3\xa9 c, and he will tell you if he tasted a similar coffee during the last k days.You can also ask him to take a medication that will reset his memory. He will forget all previous cups of coffee tasted. You can reset his memory at most 30Â 000 times.More formally, the memory of your friend is a queue S. Doing a query on caf\xc3\xa9 c will:   Tell you if ac is in S;  Add ac at the back of S;  If |S|>k, pop the front element of S. Doing a reset request will pop all elements out of S.Your friend can taste at most 2n2k cups of coffee in total. Find the diversity d (number of distinct values in the array a).Note that asking your friend to reset his memory does not count towards the number of times you ask your friend to taste a cup of coffee.In some test cases the behavior of the interactor is adaptive. It means that the array a may be not fixed before the start of the interaction and may depend on your queries. It is guaranteed that at any moment of the interaction, there is at least one array a consistent with all the answers given so far." 2800
1291B "Array Sharpening" greedy,implementation "You\'re given an array a1,\xe2\x80\xa6,an of n non-negative integers.Let\'s call it sharpened if and only if there exists an integer 1\xe2\x89\xa4k\xe2\x89\xa4n such that a1<a2<\xe2\x80\xa6<ak and ak>ak+1>\xe2\x80\xa6>an. In particular, any strictly increasing or strictly decreasing array is sharpened. For example:  The arrays [4], [0,1], [12,10,8] and [3,11,15,9,7,4] are sharpened;  The arrays [2,8,2,8,6,5], [0,1,1,0] and [2,5,6,9,8,8] are not sharpened. You can do the following operation as many times as you want: choose any strictly positive element of the array, and decrease it by one. Formally, you can choose any i (1\xe2\x89\xa4i\xe2\x89\xa4n) such that ai>0 and assign ai:=ai\xe2\x88\x921.Tell if it\'s possible to make the given array sharpened using some number (possibly zero) of these operations." 1300
1291A "Even But Not Even" greedy,math,strings "Let\'s define a number ebne (even but not even) if and only if its sum of digits is divisible by 2 but the number itself is not divisible by 2. For example, 13, 1227, 185217 are ebne numbers, while 12, 2, 177013, 265918 are not. If you\'re still unsure what ebne numbers are, you can look at the sample notes for more clarification.You are given a non-negative integer s, consisting of n digits. You can delete some digits (they are not necessary consecutive/successive) to make the given number ebne. You cannot change the order of the digits, that is, after deleting the digits the remaining digits collapse. The resulting number shouldn\'t contain leading zeros. You can delete any number of digits between 0 (do not delete any digits at all) and n\xe2\x88\x921.For example, if you are given s=222373204424185217171912 then one of possible ways to make it ebne is: 222373204424185217171912 \xe2\x86\x92 2237344218521717191. The sum of digits of 2237344218521717191 is equal to 70 and is divisible by 2, but number itself is not divisible by 2: it means that the resulting number is ebne.Find any resulting number that is ebne. If it\'s impossible to create an ebne number from the given number report about it." 900
1290F "Making Shapes" dp "You are given n pairwise non-collinear two-dimensional vectors. You can make shapes in the two-dimensional plane with these vectors in the following fashion: Start at the origin (0,0). Choose a vector and add the segment of the vector to the current point. For example, if your current point is at (x,y) and you choose the vector (u,v), draw a segment from your current point to the point at (x+u,y+v) and set your current point to (x+u,y+v). Repeat step 2 until you reach the origin again.You can reuse a vector as many times as you want.Count the number of different, non-degenerate (with an area greater than 0) and convex shapes made from applying the steps, such that the shape can be contained within a m\xc3\x97m square, and the vectors building the shape are in counter-clockwise fashion. Since this number can be too large, you should calculate it by modulo 998244353.Two shapes are considered the same if there exists some parallel translation of the first shape to another.A shape can be contained within a m\xc3\x97m square if there exists some parallel translation of this shape so that every point (u,v) inside or on the border of the shape satisfies 0\xe2\x89\xa4u,v\xe2\x89\xa4m." 3500
1290E "Cartesian Tree" "data structures" "Ildar is the algorithm teacher of William and Harris. Today, Ildar is teaching Cartesian Tree. However, Harris is sick, so Ildar is only teaching William.A cartesian tree is a rooted tree, that can be constructed from a sequence of distinct integers. We build the cartesian tree as follows: If the sequence is empty, return an empty tree; Let the position of the maximum element be x; Remove element on the position x from the sequence and break it into the left part and the right part (which might be empty) (not actually removing it, just taking it away temporarily); Build cartesian tree for each part; Create a new vertex for the element, that was on the position x which will serve as the root of the new tree. Then, for the root of the left part and right part, if exists, will become the children for this vertex; Return the tree we have gotten.For example, this is the cartesian tree for the sequence 4,2,7,3,5,6,1:  After teaching what the cartesian tree is, Ildar has assigned homework. He starts with an empty sequence a.In the i-th round, he inserts an element with value i somewhere in a. Then, he asks a question: what is the sum of the sizes of the subtrees for every node in the cartesian tree for the current sequence a?Node v is in the node u subtree if and only if v=u or v is in the subtree of one of the vertex u children. The size of the subtree of node u is the number of nodes v such that v is in the subtree of u.Ildar will do n rounds in total. The homework is the sequence of answers to the n questions.The next day, Ildar told Harris that he has to complete the homework as well. Harris obtained the final state of the sequence a from William. However, he has no idea how to find the answers to the n questions. Help Harris!" 3300
1290D "Coffee Varieties (hard version)" "constructive algorithms,graphs,interactive" "This is the hard version of the problem. You can find the easy version in the Div. 2 contest. Both versions only differ in the number of times you can ask your friend to taste coffee.This is an interactive problem.You\'re considering moving to another city, where one of your friends already lives. There are n caf\xc3\xa9s in this city, where n is a power of two. The i-th caf\xc3\xa9 produces a single variety of coffee ai. As you\'re a coffee-lover, before deciding to move or not, you want to know the number d of distinct varieties of coffees produced in this city.You don\'t know the values a1,\xe2\x80\xa6,an. Fortunately, your friend has a memory of size k, where k is a power of two.Once per day, you can ask him to taste a cup of coffee produced by the caf\xc3\xa9 c, and he will tell you if he tasted a similar coffee during the last k days.You can also ask him to take a medication that will reset his memory. He will forget all previous cups of coffee tasted. You can reset his memory at most 30Â 000 times.More formally, the memory of your friend is a queue S. Doing a query on caf\xc3\xa9 c will:   Tell you if ac is in S;  Add ac at the back of S;  If |S|>k, pop the front element of S. Doing a reset request will pop all elements out of S.Your friend can taste at most 3n22k cups of coffee in total. Find the diversity d (number of distinct values in the array a).Note that asking your friend to reset his memory does not count towards the number of times you ask your friend to taste a cup of coffee.In some test cases the behavior of the interactor is adaptive. It means that the array a may be not fixed before the start of the interaction and may depend on your queries. It is guaranteed that at any moment of the interaction, there is at least one array a consistent with all the answers given so far." 3000
1290C "Prefix Enlightenment" "dfs and similar,dsu,graphs" "There are n lamps on a line, numbered from 1 to n. Each one has an initial state off (0) or on (1).You\'re given k subsets A1,\xe2\x80\xa6,Ak of {1,2,\xe2\x80\xa6,n}, such that the intersection of any three subsets is empty. In other words, for all 1\xe2\x89\xa4i1<i2<i3\xe2\x89\xa4k, Ai1\xe2\x88\xa9Ai2\xe2\x88\xa9Ai3=\xe2\x88\x85.In one operation, you can choose one of these k subsets and switch the state of all lamps in it. It is guaranteed that, with the given subsets, it\'s possible to make all lamps be simultaneously on using this type of operation.Let mi be the minimum number of operations you have to do in order to make the i first lamps be simultaneously on. Note that there is no condition upon the state of other lamps (between i+1 and n), they can be either off or on.You have to compute mi for all 1\xe2\x89\xa4i\xe2\x89\xa4n." 2400
1290B "Irreducible Anagrams" "binary search,constructive algorithms,data structures,strings,two pointers" "Let\'s call two strings s and t anagrams of each other if it is possible to rearrange symbols in the string s to get a string, equal to t.Let\'s consider two strings s and t which are anagrams of each other. We say that t is a reducible anagram of s if there exists an integer k\xe2\x89\xa52 and 2k non-empty strings s1,t1,s2,t2,\xe2\x80\xa6,sk,tk that satisfy the following conditions:  If we write the strings s1,s2,\xe2\x80\xa6,sk in order, the resulting string will be equal to s;  If we write the strings t1,t2,\xe2\x80\xa6,tk in order, the resulting string will be equal to t;  For all integers i between 1 and k inclusive, si and ti are anagrams of each other. If such strings don\'t exist, then t is said to be an irreducible anagram of s. Note that these notions are only defined when s and t are anagrams of each other.For example, consider the string s= ""gamegame"". Then the string t= ""megamage"" is a reducible anagram of s, we may choose for example s1= ""game"", s2= ""gam"", s3= ""e"" and t1= ""mega"", t2= ""mag"", t3= ""e"":  On the other hand, we can prove that t= ""memegaga"" is an irreducible anagram of s.You will be given a string s and q queries, represented by two integers 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4|s| (where |s| is equal to the length of the string s). For each query, you should find if the substring of s formed by characters from the l-th to the r-th has at least one irreducible anagram." 1800
1290A "Mind Control" "brute force,data structures,implementation" "You and your n\xe2\x88\x921 friends have found an array of integers a1,a2,\xe2\x80\xa6,an. You have decided to share it in the following way: All n of you stand in a line in a particular order. Each minute, the person at the front of the line chooses either the first or the last element of the array, removes it, and keeps it for himself. He then gets out of line, and the next person in line continues the process.You are standing in the m-th position in the line. Before the process starts, you may choose up to k different people in the line, and persuade them to always take either the first or the last element in the array on their turn (for each person his own choice, not necessarily equal for all people), no matter what the elements themselves are. Once the process starts, you cannot persuade any more people, and you cannot change the choices for the people you already persuaded.Suppose that you\'re doing your choices optimally. What is the greatest integer x such that, no matter what are the choices of the friends you didn\'t choose to control, the element you will take from the array will be greater than or equal to x?Please note that the friends you don\'t control may do their choice arbitrarily, and they will not necessarily take the biggest element available." 1600
1288F "Red-Blue Graph" "constructive algorithms,flows" "You are given a bipartite graph: the first part of this graph contains n1 vertices, the second part contains n2 vertices, and there are m edges. The graph can contain multiple edges.Initially, each edge is colorless. For each edge, you may either leave it uncolored (it is free), paint it red (it costs r coins) or paint it blue (it costs b coins). No edge can be painted red and blue simultaneously.There are three types of vertices in this graph \xe2\x80\x94 colorless, red and blue. Colored vertices impose additional constraints on edges\' colours:  for each red vertex, the number of red edges indicent to it should be strictly greater than the number of blue edges incident to it;  for each blue vertex, the number of blue edges indicent to it should be strictly greater than the number of red edges incident to it. Colorless vertices impose no additional constraints.Your goal is to paint some (possibly none) edges so that all constraints are met, and among all ways to do so, you should choose the one with minimum total cost." 2900
1288E "Messenger Simulator" "data structures" "Polycarp is a frequent user of the very popular messenger. He\'s chatting with his friends all the time. He has n friends, numbered from 1 to n.Recall that a permutation of size n is an array of size n such that each integer from 1 to n occurs exactly once in this array.So his recent chat list can be represented with a permutation p of size n. p1 is the most recent friend Polycarp talked to, p2 is the second most recent and so on.Initially, Polycarp\'s recent chat list p looks like 1,2,\xe2\x80\xa6,n (in other words, it is an identity permutation).After that he receives m messages, the j-th message comes from the friend aj. And that causes friend aj to move to the first position in a permutation, shifting everyone between the first position and the current position of aj by 1. Note that if the friend aj is in the first position already then nothing happens.For example, let the recent chat list be p=[4,1,5,3,2]:   if he gets messaged by friend 3, then p becomes [3,4,1,5,2];  if he gets messaged by friend 4, then p doesn\'t change [4,1,5,3,2];  if he gets messaged by friend 2, then p becomes [2,4,1,5,3]. For each friend consider all position he has been at in the beginning and after receiving each message. Polycarp wants to know what were the minimum and the maximum positions." 2000
1288D "Minimax Problem" "binary search,bitmasks,dp" "You are given n arrays a1, a2, ..., an; each array consists of exactly m integers. We denote the y-th element of the x-th array as ax,y.You have to choose two arrays ai and aj (1\xe2\x89\xa4i,j\xe2\x89\xa4n, it is possible that i=j). After that, you will obtain a new array b consisting of m integers, such that for every k\xe2\x88\x88[1,m] bk=max(ai,k,aj,k).Your goal is to choose i and j so that the value of mmink=1bk is maximum possible." 2000
1288C "Two Arrays" combinatorics,dp "You are given two integers n and m. Calculate the number of pairs of arrays (a,b) such that:  the length of both arrays is equal to m;  each element of each array is an integer between 1 and n (inclusive);  ai\xe2\x89\xa4bi for any index i from 1 to m;  array a is sorted in non-descending order;  array b is sorted in non-ascending order. As the result can be very large, you should print it modulo 109+7." 1600
1288B "Yet Another Meme Problem" math "You are given two integers A and B, calculate the number of pairs (a,b) such that 1\xe2\x89\xa4a\xe2\x89\xa4A, 1\xe2\x89\xa4b\xe2\x89\xa4B, and the equation a\xe2\x8b\x85b+a+b=conc(a,b) is true; conc(a,b) is the concatenation of a and b (for example, conc(12,23)=1223, conc(100,11)=10011). a and b should not contain leading zeroes." 1100
1288A Deadline "binary search,brute force,math,ternary search" "Adilbek was assigned to a special project. For Adilbek it means that he has n days to run a special program and provide its results. But there is a problem: the program needs to run for d days to calculate the results.Fortunately, Adilbek can optimize the program. If he spends x (x is a non-negative integer) days optimizing the program, he will make the program run in \xe2\x8c\x88dx+1\xe2\x8c\x89 days (\xe2\x8c\x88a\xe2\x8c\x89 is the ceiling function: \xe2\x8c\x882.4\xe2\x8c\x89=3, \xe2\x8c\x882\xe2\x8c\x89=2). The program cannot be run and optimized simultaneously, so the total number of days he will spend is equal to x+\xe2\x8c\x88dx+1\xe2\x8c\x89.Will Adilbek be able to provide the generated results in no more than n days?" 1100
1287B Hyperset "brute force,data structures,implementation" "Bees Alice and Alesya gave beekeeper Polina famous card game ""Set"" as a Christmas present. The deck consists of cards that vary in four features across three options for each kind of feature: number of shapes, shape, shading, and color. In this game, some combinations of three cards are said to make up a set. For every feature \xe2\x80\x94 color, number, shape, and shading \xe2\x80\x94 the three cards must display that feature as either all the same, or pairwise different. The picture below shows how sets look.Polina came up with a new game called ""Hyperset"". In her game, there are n cards with k features, each feature has three possible values: ""S"", ""E"", or ""T"". The original ""Set"" game can be viewed as ""Hyperset"" with k=4.Similarly to the original game, three cards form a set, if all features are the same for all cards or are pairwise different. The goal of the game is to compute the number of ways to choose three cards that form a set.Unfortunately, winter holidays have come to an end, and it\'s time for Polina to go to school. Help Polina find the number of sets among the cards lying on the table." 1500
1287A "Angry Students" greedy,implementation "It\'s a walking tour day in SIS.Winter, so t groups of students are visiting Torzhok. Streets of Torzhok are so narrow that students have to go in a row one after another.Initially, some students are angry. Let\'s describe a group of students by a string of capital letters ""A"" and ""P"":   ""A"" corresponds to an angry student  ""P"" corresponds to a patient student Such string describes the row from the last to the first student.Every minute every angry student throws a snowball at the next student. Formally, if an angry student corresponds to the character with index i in the string describing a group then they will throw a snowball at the student that corresponds to the character with index i+1 (students are given from the last to the first student). If the target student was not angry yet, they become angry. Even if the first (the rightmost in the string) student is angry, they don\'t throw a snowball since there is no one in front of them.Let\'s look at the first example test. The row initially looks like this: PPAP. Then, after a minute the only single angry student will throw a snowball at the student in front of them, and they also become angry: PPAA. After that, no more students will become angry.Your task is to help SIS.Winter teachers to determine the last moment a student becomes angry for every group." 800
1286F "Harry The Potter" "brute force,constructive algorithms,dp,fft,implementation,math" "To defeat Lord Voldemort, Harry needs to destroy all horcruxes first. The last horcrux is an array a of n integers, which also needs to be destroyed. The array is considered destroyed if all its elements are zeroes. To destroy the array, Harry can perform two types of operations:  choose an index i (1\xe2\x89\xa4i\xe2\x89\xa4n), an integer x, and subtract x from ai. choose two indices i and j (1\xe2\x89\xa4i,j\xe2\x89\xa4n;i\xe2\x89\xa0j), an integer x, and subtract x from ai and x+1 from aj. Note that x does not have to be positive.Harry is in a hurry, please help him to find the minimum number of operations required to destroy the array and exterminate Lord Voldemort." 3100
1286E "Fedya the Potter Strikes Back" "data structures,strings" "Fedya has a string S, initially empty, and an array W, also initially empty.There are n queries to process, one at a time. Query i consists of a lowercase English letter ci and a nonnegative integer wi. First, ci must be appended to S, and wi must be appended to W. The answer to the query is the sum of suspiciousnesses for all subsegments of W [L,Â R], (1\xe2\x89\xa4L\xe2\x89\xa4R\xe2\x89\xa4i).We define the suspiciousness of a subsegment as follows: if the substring of S corresponding to this subsegment (that is, a string of consecutive characters from L-th to R-th, inclusive) matches the prefix of S of the same length (that is, a substring corresponding to the subsegment [1,Â R\xe2\x88\x92L+1]), then its suspiciousness is equal to the minimum in the array W on the [L,Â R] subsegment. Otherwise, in case the substring does not match the corresponding prefix, the suspiciousness is 0.Help Fedya answer all the queries before the orderlies come for him!" 3200
1286D LCC "data structures,math,matrices,probabilities" "An infinitely long Line Chillland Collider (LCC) was built in Chillland. There are n pipes with coordinates xi that are connected to LCC. When the experiment starts at time 0, i-th proton flies from the i-th pipe with speed vi. It flies to the right with probability pi and flies to the left with probability (1\xe2\x88\x92pi). The duration of the experiment is determined as the time of the first collision of any two protons. In case there is no collision, the duration of the experiment is considered to be zero.Find the expected value of the duration of the experiment.Illustration for the first example" 3100
1286C2 "Madhouse (Hard version)" "brute force,constructive algorithms,hashing,interactive,math" "This problem is different with easy version only by constraints on total answers lengthIt is an interactive problemVenya joined a tour to the madhouse, in which orderlies play with patients the following game. Orderlies pick a string s of length n, consisting only of lowercase English letters. The player can ask two types of queries:   ? l r \xe2\x80\x93 ask to list all substrings of s[l..r]. Substrings will be returned in random order, and in every substring, all characters will be randomly shuffled.  ! s \xe2\x80\x93 guess the string picked by the orderlies. This query can be asked exactly once, after that the game will finish. If the string is guessed correctly, the player wins, otherwise he loses. The player can ask no more than 3 queries of the first type.To make it easier for the orderlies, there is an additional limitation: the total number of returned substrings in all queries of the first type must not exceed \xe2\x8c\x880.777(n+1)2\xe2\x8c\x89 (\xe2\x8c\x88x\xe2\x8c\x89 is x rounded up).Venya asked you to write a program, which will guess the string by interacting with the orderlies\' program and acting by the game\'s rules.Your program should immediately terminate after guessing the string using a query of the second type. In case your program guessed the string incorrectly, or it violated the game rules, it will receive verdict Wrong answer.Note that in every test case the string is fixed beforehand and will not change during the game, which means that the interactor is not adaptive." 2800
1286C1 "Madhouse (Easy version)" "brute force,constructive algorithms,interactive,math" "This problem is different with hard version only by constraints on total answers lengthIt is an interactive problemVenya joined a tour to the madhouse, in which orderlies play with patients the following game. Orderlies pick a string s of length n, consisting only of lowercase English letters. The player can ask two types of queries:   ? l r \xe2\x80\x93 ask to list all substrings of s[l..r]. Substrings will be returned in random order, and in every substring, all characters will be randomly shuffled.  ! s \xe2\x80\x93 guess the string picked by the orderlies. This query can be asked exactly once, after that the game will finish. If the string is guessed correctly, the player wins, otherwise he loses. The player can ask no more than 3 queries of the first type.To make it easier for the orderlies, there is an additional limitation: the total number of returned substrings in all queries of the first type must not exceed (n+1)2.Venya asked you to write a program, which will guess the string by interacting with the orderlies\' program and acting by the game\'s rules.Your program should immediately terminate after guessing the string using a query of the second type. In case your program guessed the string incorrectly, or it violated the game rules, it will receive verdict Wrong answer.Note that in every test case the string is fixed beforehand and will not change during the game, which means that the interactor is not adaptive." 2400
1286B "Numbers on Tree" "constructive algorithms,data structures,dfs and similar,graphs,greedy,trees" "Evlampiy was gifted a rooted tree. The vertices of the tree are numbered from 1 to n. Each of its vertices also has an integer ai written on it. For each vertex i, Evlampiy calculated ciÂ \xe2\x80\x94 the number of vertices j in the subtree of vertex i, such that aj<ai. Illustration for the second example, the first integer is ai and the integer in parentheses is ciAfter the new year, Evlampiy could not remember what his gift was! He remembers the tree and the values of ci, but he completely forgot which integers ai were written on the vertices.Help him to restore initial integers!" 1800
1286A Garland dp,greedy,sortings "Vadim loves decorating the Christmas tree, so he got a beautiful garland as a present. It consists of n light bulbs in a single row. Each bulb has a number from 1 to n (in arbitrary order), such that all the numbers are distinct. While Vadim was solving problems, his home Carp removed some light bulbs from the garland. Now Vadim wants to put them back on.Vadim wants to put all bulb back on the garland. Vadim defines complexity of a garland to be the number of pairs of adjacent bulbs with numbers with different parity (remainder of the division by 2). For example, the complexity of 1 4 2 3 5 is 2 and the complexity of 1 3 5 7 6 4 2 is 1.No one likes complexity, so Vadim wants to minimize the number of such pairs. Find the way to put all bulbs back on the garland, such that the complexity is as small as possible." 1800
1285F Classical? "binary search,combinatorics,number theory" "Given an array a, consisting of n integers, find:max1\xe2\x89\xa4i<j\xe2\x89\xa4nLCM(ai,aj),where LCM(x,y) is the smallest positive integer that is divisible by both x and y. For example, LCM(6,8)=24, LCM(4,12)=12, LCM(2,3)=6." 2900
1285E "Delete a Segment" "brute force,constructive algorithms,data structures,dp,graphs,sortings,trees,two pointers" "There are n segments on a Ox axis [l1,r1], [l2,r2], ..., [ln,rn]. Segment [l,r] covers all points from l to r inclusive, so all x such that l\xe2\x89\xa4x\xe2\x89\xa4r.Segments can be placed arbitrarily Â \xe2\x80\x94 be inside each other, coincide and so on. Segments can degenerate into points, that is li=ri is possible.Union of the set of segments is such a set of segments which covers exactly the same set of points as the original set. For example:  if n=3 and there are segments [3,6], [100,100], [5,8] then their union is 2 segments: [3,8] and [100,100];  if n=5 and there are segments [1,2], [2,3], [4,5], [4,6], [6,6] then their union is 2 segments: [1,3] and [4,6]. Obviously, a union is a set of pairwise non-intersecting segments.You are asked to erase exactly one segment of the given n so that the number of segments in the union of the rest n\xe2\x88\x921 segments is maximum possible.For example, if n=4 and there are segments [1,4], [2,3], [3,6], [5,7], then:  erasing the first segment will lead to [2,3], [3,6], [5,7] remaining, which have 1 segment in their union;  erasing the second segment will lead to [1,4], [3,6], [5,7] remaining, which have 1 segment in their union;  erasing the third segment will lead to [1,4], [2,3], [5,7] remaining, which have 2 segments in their union;  erasing the fourth segment will lead to [1,4], [2,3], [3,6] remaining, which have 1 segment in their union. Thus, you are required to erase the third segment to get answer 2.Write a program that will find the maximum number of segments in the union of n\xe2\x88\x921 segments if you erase any of the given n segments.Note that if there are multiple equal segments in the given set, then you can erase only one of them anyway. So the set after erasing will have exactly n\xe2\x88\x921 segments." 2300
1285D "Dr. Evil Underscores" "bitmasks,brute force,dfs and similar,divide and conquer,dp,greedy,strings,trees" "Today, as a friendship gift, Bakry gave Badawy n integers a1,a2,\xe2\x80\xa6,an and challenged him to choose an integer X such that the value max1\xe2\x89\xa4i\xe2\x89\xa4n(ai\xe2\x8a\x95X) is minimum possible, where \xe2\x8a\x95 denotes the bitwise XOR operation.As always, Badawy is too lazy, so you decided to help him and find the minimum possible value of max1\xe2\x89\xa4i\xe2\x89\xa4n(ai\xe2\x8a\x95X)." 1900
1285C "Fadi and LCM" "brute force,math,number theory" "Today, Osama gave Fadi an integer X, and Fadi was wondering about the minimum possible value of max(a,b) such that LCM(a,b) equals X. Both a and b should be positive integers.LCM(a,b) is the smallest positive integer that is divisible by both a and b. For example, LCM(6,8)=24, LCM(4,12)=12, LCM(2,3)=6.Of course, Fadi immediately knew the answer. Can you be just like Fadi and find any such pair?" 1400
1285B "Just Eat It!" dp,greedy,implementation "Today, Yasser and Adel are at the shop buying cupcakes. There are n cupcake types, arranged from 1 to n on the shelf, and there are infinitely many of each type. The tastiness of a cupcake of type i is an integer ai. There are both tasty and nasty cupcakes, so the tastiness can be positive, zero or negative.Yasser, of course, wants to try them all, so he will buy exactly one cupcake of each type.On the other hand, Adel will choose some segment [l,r] (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n) that does not include all of cupcakes (he can\'t choose [l,r]=[1,n]) and buy exactly one cupcake of each of types l,l+1,\xe2\x80\xa6,r.After that they will compare the total tastiness of the cupcakes each of them have bought. Yasser will be happy if the total tastiness of cupcakes he buys is strictly greater than the total tastiness of cupcakes Adel buys regardless of Adel\'s choice.For example, let the tastinesses of the cupcakes be [7,4,\xe2\x88\x921]. Yasser will buy all of them, the total tastiness will be 7+4\xe2\x88\x921=10. Adel can choose segments [7],[4],[\xe2\x88\x921],[7,4] or [4,\xe2\x88\x921], their total tastinesses are 7,4,\xe2\x88\x921,11 and 3, respectively. Adel can choose segment with tastiness 11, and as 10 is not strictly greater than 11, Yasser won\'t be happy :(Find out if Yasser will be happy after visiting the shop." 1300
1285A "Mezo Playing Zoma" math "Today, Mezo is playing a game. Zoma, a character in that game, is initially at position x=0. Mezo starts sending n commands to Zoma. There are two possible commands:  \'L\' (Left) sets the position x:=x\xe2\x88\x921;  \'R\' (Right) sets the position x:=x+1. Unfortunately, Mezo\'s controller malfunctions sometimes. Some commands are sent successfully and some are ignored. If the command is ignored then the position x doesn\'t change and Mezo simply proceeds to the next command.For example, if Mezo sends commands ""LRLR"", then here are some possible outcomes (underlined commands are sent successfully):   ""LRLR"" \xe2\x80\x94 Zoma moves to the left, to the right, to the left again and to the right for the final time, ending up at position 0;  ""LRLR"" \xe2\x80\x94 Zoma recieves no commands, doesn\'t move at all and ends up at position 0 as well;  ""LRLR"" \xe2\x80\x94 Zoma moves to the left, then to the left again and ends up in position \xe2\x88\x922. Mezo doesn\'t know which commands will be sent successfully beforehand. Thus, he wants to know how many different positions may Zoma end up at." 800
1284G Seollal graphs "It is only a few days until Seollal (Korean Lunar New Year), and Jaehyun has invited his family to his garden. There are kids among the guests. To make the gathering more fun for the kids, Jaehyun is going to run a game of hide-and-seek.The garden can be represented by a n\xc3\x97m grid of unit cells. Some (possibly zero) cells are blocked by rocks, and the remaining cells are free. Two cells are neighbors if they share an edge. Each cell has up to 4 neighbors: two in the horizontal direction and two in the vertical direction. Since the garden is represented as a grid, we can classify the cells in the garden as either ""black"" or ""white"". The top-left cell is black, and two cells which are neighbors must be different colors. Cell indices are 1-based, so the top-left corner of the garden is cell (1,1).Jaehyun wants to turn his garden into a maze by placing some walls between two cells. Walls can only be placed between neighboring cells. If the wall is placed between two neighboring cells a and b, then the two cells a and b are not neighboring from that point. One can walk directly between two neighboring cells if and only if there is no wall directly between them. A maze must have the following property. For each pair of free cells in the maze, there must be exactly one simple path between them. A simple path between cells a and b is a sequence of free cells in which the first cell is a, the last cell is b, all cells are distinct, and any two consecutive cells are neighbors which are not directly blocked by a wall.At first, kids will gather in cell (1,1), and start the hide-and-seek game. A kid can hide in a cell if and only if that cell is free, it is not (1,1), and has exactly one free neighbor. Jaehyun planted roses in the black cells, so it\'s dangerous if the kids hide there. So Jaehyun wants to create a maze where the kids can only hide in white cells.You are given the map of the garden as input. Your task is to help Jaehyun create a maze." 3300
1284F "New Year and Social Network" "data structures,graph matchings,graphs,math,trees" "Donghyun\'s new social network service (SNS) contains n users numbered 1,2,\xe2\x80\xa6,n. Internally, their network is a tree graph, so there are n\xe2\x88\x921 direct connections between each user. Each user can reach every other users by using some sequence of direct connections. From now on, we will denote this primary network as T1.To prevent a possible server breakdown, Donghyun created a backup network T2, which also connects the same n users via a tree graph. If a system breaks down, exactly one edge e\xe2\x88\x88T1 becomes unusable. In this case, Donghyun will protect the edge e by picking another edge f\xe2\x88\x88T2, and add it to the existing network. This new edge should make the network be connected again. Donghyun wants to assign a replacement edge f\xe2\x88\x88T2 for as many edges e\xe2\x88\x88T1 as possible. However, since the backup network T2 is fragile, f\xe2\x88\x88T2 can be assigned as the replacement edge for at most one edge in T1. With this restriction, Donghyun wants to protect as many edges in T1 as possible.Formally, let E(T) be an edge set of the tree T. We consider a bipartite graph with two parts E(T1) and E(T2). For e\xe2\x88\x88E(T1),f\xe2\x88\x88E(T2), there is an edge connecting {e,f} if and only if graph T1\xe2\x88\x92{e}+{f} is a tree. You should find a maximum matching in this bipartite graph." 3200
1284E "New Year and Castle Construction" combinatorics,geometry,math,sortings "Kiwon\'s favorite video game is now holding a new year event to motivate the users! The game is about building and defending a castle, which led Kiwon to think about the following puzzle.In a 2-dimension plane, you have a set s={(x1,y1),(x2,y2),\xe2\x80\xa6,(xn,yn)} consisting of n distinct points. In the set s, no three distinct points lie on a single line. For a point p\xe2\x88\x88s, we can protect this point by building a castle. A castle is a simple quadrilateral (polygon with 4 vertices) that strictly encloses the point p (i.e. the point p is strictly inside a quadrilateral). Kiwon is interested in the number of 4-point subsets of s that can be used to build a castle protecting p. Note that, if a single subset can be connected in more than one way to enclose a point, it is counted only once. Let f(p) be the number of 4-point subsets that can enclose the point p. Please compute the sum of f(p) for all points p\xe2\x88\x88s." 2500
1284D "New Year and Conference" "binary search,data structures,hashing,sortings" "Filled with optimism, Hyunuk will host a conference about how great this new year will be!The conference will have n lectures. Hyunuk has two candidate venues a and b. For each of the n lectures, the speaker specified two time intervals [sai,eai] (sai\xe2\x89\xa4eai) and [sbi,ebi] (sbi\xe2\x89\xa4ebi). If the conference is situated in venue a, the lecture will be held from sai to eai, and if the conference is situated in venue b, the lecture will be held from sbi to ebi. Hyunuk will choose one of these venues and all lectures will be held at that venue.Two lectures are said to overlap if they share any point in time in common. Formally, a lecture held in interval [x,y] overlaps with a lecture held in interval [u,v] if and only if max(x,u)\xe2\x89\xa4min(y,v).We say that a participant can attend a subset s of the lectures if the lectures in s do not pairwise overlap (i.e. no two lectures overlap). Note that the possibility of attending may depend on whether Hyunuk selected venue a or venue b to hold the conference.A subset of lectures s is said to be venue-sensitive if, for one of the venues, the participant can attend s, but for the other venue, the participant cannot attend s.A venue-sensitive set is problematic for a participant who is interested in attending the lectures in s because the participant cannot be sure whether the lecture times will overlap. Hyunuk will be happy if and only if there are no venue-sensitive sets. Determine whether Hyunuk will be happy." 2100
1284C "New Year and Permutation" combinatorics,math "Recall that the permutation is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array) and [1,3,4] is also not a permutation (n=3 but there is 4 in the array).A sequence a is a subsegment of a sequence b if a can be obtained from b by deletion of several (possibly, zero or all) elements from the beginning and several (possibly, zero or all) elements from the end. We will denote the subsegments as [l,r], where l,r are two integers with 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n. This indicates the subsegment where l\xe2\x88\x921 elements from the beginning and n\xe2\x88\x92r elements from the end are deleted from the sequence.For a permutation p1,p2,\xe2\x80\xa6,pn, we define a framed segment as a subsegment [l,r] where max{pl,pl+1,\xe2\x80\xa6,pr}\xe2\x88\x92min{pl,pl+1,\xe2\x80\xa6,pr}=r\xe2\x88\x92l. For example, for the permutation (6,7,1,8,5,3,2,4) some of its framed segments are: [1,2],[5,8],[6,7],[3,3],[8,8]. In particular, a subsegment [i,i] is always a framed segments for any i between 1 and n, inclusive.We define the happiness of a permutation p as the number of pairs (l,r) such that 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n, and [l,r] is a framed segment. For example, the permutation [3,1,2] has happiness 5: all segments except [1,2] are framed segments.Given integers n and m, Jongwon wants to compute the sum of happiness for all permutations of length n, modulo the prime number m. Note that there exist n! (factorial of n) different permutations of length n." 1600
1284B "New Year and Ascent Sequence" "binary search,combinatorics,data structures,dp,implementation,sortings" "A sequence a=[a1,a2,\xe2\x80\xa6,al] of length l has an ascent if there exists a pair of indices (i,j) such that 1\xe2\x89\xa4i<j\xe2\x89\xa4l and ai<aj. For example, the sequence [0,2,0,2,0] has an ascent because of the pair (1,4), but the sequence [4,3,3,3,1] doesn\'t have an ascent.Let\'s call a concatenation of sequences p and q the sequence that is obtained by writing down sequences p and q one right after another without changing the order. For example, the concatenation of the [0,2,0,2,0] and [4,3,3,3,1] is the sequence [0,2,0,2,0,4,3,3,3,1]. The concatenation of sequences p and q is denoted as p+q.Gyeonggeun thinks that sequences with ascents bring luck. Therefore, he wants to make many such sequences for the new year. Gyeonggeun has n sequences s1,s2,\xe2\x80\xa6,sn which may have different lengths. Gyeonggeun will consider all n2 pairs of sequences sx and sy (1\xe2\x89\xa4x,y\xe2\x89\xa4n), and will check if its concatenation sx+sy has an ascent. Note that he may select the same sequence twice, and the order of selection matters.Please count the number of pairs (x,y) of sequences s1,s2,\xe2\x80\xa6,sn whose concatenation sx+sy contains an ascent." 1400
1284A "New Year and Naming" implementation,strings "Happy new year! The year 2020 is also known as Year Gyeongja (\xea\xb2\xbd\xec\x9e\x90\xeb\x85\x84, gyeongja-nyeon) in Korea. Where did the name come from? Let\'s briefly look at the Gapja system, which is traditionally used in Korea to name the years.There are two sequences of n strings s1,s2,s3,\xe2\x80\xa6,sn and m strings t1,t2,t3,\xe2\x80\xa6,tm. These strings contain only lowercase letters. There might be duplicates among these strings.Let\'s call a concatenation of strings x and y as the string that is obtained by writing down strings x and y one right after another without changing the order. For example, the concatenation of the strings ""code"" and ""forces"" is the string ""codeforces"".The year 1 has a name which is the concatenation of the two strings s1 and t1. When the year increases by one, we concatenate the next two strings in order from each of the respective sequences. If the string that is currently being used is at the end of its sequence, we go back to the first string in that sequence.For example, if n=3,m=4,s={""a"", ""b"", ""c""}, t= {""d"", ""e"", ""f"", ""g""}, the following table denotes the resulting year names. Note that the names of the years may repeat.  You are given two sequences of strings of size n and m and also q queries. For each query, you will be given the current year. Could you find the name corresponding to the given year, according to the Gapja system?" 800
1283F "DIY Garland" "constructive algorithms,greedy,trees" "Polycarp has decided to decorate his room because the New Year is soon. One of the main decorations that Polycarp will install is the garland he is going to solder himself.Simple garlands consisting of several lamps connected by one wire are too boring for Polycarp. He is going to solder a garland consisting of n lamps and n\xe2\x88\x921 wires. Exactly one lamp will be connected to power grid, and power will be transmitted from it to other lamps by the wires. Each wire connectes exactly two lamps; one lamp is called the main lamp for this wire (the one that gets power from some other wire and transmits it to this wire), the other one is called the auxiliary lamp (the one that gets power from this wire). Obviously, each lamp has at most one wire that brings power to it (and this lamp is the auxiliary lamp for this wire, and the main lamp for all other wires connected directly to it).Each lamp has a brightness value associated with it, the i-th lamp has brightness 2i. We define the importance of the wire as the sum of brightness values over all lamps that become disconnected from the grid if the wire is cut (and all other wires are still working).Polycarp has drawn the scheme of the garland he wants to make (the scheme depicts all n lamp and n\xe2\x88\x921 wires, and the lamp that will be connected directly to the grid is marked; the wires are placed in such a way that the power can be transmitted to each lamp). After that, Polycarp calculated the importance of each wire, enumerated them from 1 to n\xe2\x88\x921 in descending order of their importance, and then wrote the index of the main lamp for each wire (in the order from the first wire to the last one).The following day Polycarp bought all required components of the garland and decided to solder it \xe2\x80\x94 but he could not find the scheme. Fortunately, Polycarp found the list of indices of main lamps for all wires. Can you help him restore the original scheme?" 2200
1283E "New Year Parties" dp,greedy "Oh, New Year. The time to gather all your friends and reflect on the heartwarming events of the past year...n friends live in a city which can be represented as a number line. The i-th friend lives in a house with an integer coordinate xi. The i-th friend can come celebrate the New Year to the house with coordinate xi\xe2\x88\x921, xi+1 or stay at xi. Each friend is allowed to move no more than once.For all friends 1\xe2\x89\xa4xi\xe2\x89\xa4n holds, however, they can come to houses with coordinates 0 and n+1 (if their houses are at 1 or n, respectively).For example, let the initial positions be x=[1,2,4,4]. The final ones then can be [1,3,3,4], [0,2,3,3], [2,2,5,5], [2,1,3,5] and so on. The number of occupied houses is the number of distinct positions among the final ones.So all friends choose the moves they want to perform. After that the number of occupied houses is calculated. What is the minimum and the maximum number of occupied houses can there be?" 1800
1283D "Christmas Trees" "graphs,greedy,shortest paths" "There are n Christmas trees on an infinite number line. The i-th tree grows at the position xi. All xi are guaranteed to be distinct.Each integer point can be either occupied by the Christmas tree, by the human or not occupied at all. Non-integer points cannot be occupied by anything.There are m people who want to celebrate Christmas. Let y1,y2,\xe2\x80\xa6,ym be the positions of people (note that all values x1,x2,\xe2\x80\xa6,xn,y1,y2,\xe2\x80\xa6,ym should be distinct and all yj should be integer). You want to find such an arrangement of people that the value m\xe2\x88\x91j=1nmini=1|xi\xe2\x88\x92yj| is the minimum possible (in other words, the sum of distances to the nearest Christmas tree for all people should be minimized).In other words, let dj be the distance from the j-th human to the nearest Christmas tree (dj=nmini=1|yj\xe2\x88\x92xi|). Then you need to choose such positions y1,y2,\xe2\x80\xa6,ym that m\xe2\x88\x91j=1dj is the minimum possible." 1800
1283C "Friends and Gifts" "constructive algorithms,data structures,math" "There are n friends who want to give gifts for the New Year to each other. Each friend should give exactly one gift and receive exactly one gift. The friend cannot give the gift to himself.For each friend the value fi is known: it is either fi=0 if the i-th friend doesn\'t know whom he wants to give the gift to or 1\xe2\x89\xa4fi\xe2\x89\xa4n if the i-th friend wants to give the gift to the friend fi.You want to fill in the unknown values (fi=0) in such a way that each friend gives exactly one gift and receives exactly one gift and there is no friend who gives the gift to himself. It is guaranteed that the initial information isn\'t contradictory.If there are several answers, you can print any." 1500
1283B "Candies Division" math "Santa has n candies and he wants to gift them to k kids. He wants to divide as many candies as possible between all k kids. Santa can\'t divide one candy into parts but he is allowed to not use some candies at all.Suppose the kid who recieves the minimum number of candies has a candies and the kid who recieves the maximum number of candies has b candies. Then Santa will be satisfied, if the both conditions are met at the same time:  b\xe2\x88\x92a\xe2\x89\xa41 (it means b=a or b=a+1);  the number of kids who has a+1 candies (note that a+1 not necessarily equals b) does not exceed \xe2\x8c\x8ak2\xe2\x8c\x8b (less than or equal to \xe2\x8c\x8ak2\xe2\x8c\x8b). \xe2\x8c\x8ak2\xe2\x8c\x8b is k divided by 2 and rounded down to the nearest integer. For example, if k=5 then \xe2\x8c\x8ak2\xe2\x8c\x8b=\xe2\x8c\x8a52\xe2\x8c\x8b=2.Your task is to find the maximum number of candies Santa can give to kids so that he will be satisfied.You have to answer t independent test cases." 900
1283A "Minutes Before the New Year" math "New Year is coming and you are excited to know how many minutes remain before the New Year. You know that currently the clock shows h hours and m minutes, where 0\xe2\x89\xa4hh<24 and 0\xe2\x89\xa4mm<60. We use 24-hour time format!Your task is to find the number of minutes before the New Year. You know that New Year comes when the clock shows 0 hours and 0 minutes.You have to answer t independent test cases." 800
1282E "The Cake Is a Lie" "constructive algorithms,data structures,dfs and similar,graphs" "We are committed to the well being of all participants. Therefore, instead of the problem, we suggest you enjoy a piece of cake.Uh oh. Somebody cut the cake. We told them to wait for you, but they did it anyway. There is still some left, though, if you hurry back. Of course, before you taste the cake, you thought about how the cake was cut.It is known that the cake was originally a regular n-sided polygon, each vertex of which had a unique number from 1 to n. The vertices were numbered in random order.Each piece of the cake is a triangle. The cake was cut into n\xe2\x88\x922 pieces as follows: each time one cut was made with a knife (from one vertex to another) such that exactly one triangular piece was separated from the current cake, and the rest continued to be a convex polygon. In other words, each time three consecutive vertices of the polygon were selected and the corresponding triangle was cut off.A possible process of cutting the cake is presented in the picture below.  Example of 6-sided cake slicing. You are given a set of n\xe2\x88\x922 triangular pieces in random order. The vertices of each piece are given in random order \xe2\x80\x94 clockwise or counterclockwise. Each piece is defined by three numbers \xe2\x80\x94 the numbers of the corresponding n-sided cake vertices.For example, for the situation in the picture above, you could be given a set of pieces: [3,6,5],[5,2,4],[5,4,6],[6,3,1].You are interested in two questions.  What was the enumeration of the n-sided cake vertices?  In what order were the pieces cut? Formally, you have to find two permutations p1,p2,\xe2\x80\xa6,pn (1\xe2\x89\xa4pi\xe2\x89\xa4n) and q1,q2,\xe2\x80\xa6,qn\xe2\x88\x922 (1\xe2\x89\xa4qi\xe2\x89\xa4n\xe2\x88\x922) such that if the cake vertices are numbered with the numbers p1,p2,\xe2\x80\xa6,pn in order clockwise or counterclockwise, then when cutting pieces of the cake in the order q1,q2,\xe2\x80\xa6,qn\xe2\x88\x922 always cuts off a triangular piece so that the remaining part forms one convex polygon.For example, in the picture above the answer permutations could be: p=[2,4,6,1,3,5] (or any of its cyclic shifts, or its reversal and after that any cyclic shift) and q=[2,4,1,3].Write a program that, based on the given triangular pieces, finds any suitable permutations p and q." 2400
1282D "Enchanted Artifact" "constructive algorithms,interactive,strings" "This is an interactive problem.After completing the last level of the enchanted temple, you received a powerful artifact of the 255th level. Do not rush to celebrate, because this artifact has a powerful rune that can be destroyed with a single spell s, which you are going to find. We define the spell as some non-empty string consisting only of the letters a and b.At any time, you can cast an arbitrary non-empty spell t, and the rune on the artifact will begin to resist. Resistance of the rune is the edit distance between the strings that specify the casted spell t and the rune-destroying spell s.Edit distance of two strings s and t is a value equal to the minimum number of one-character operations of replacing, inserting and deleting characters in s to get t. For example, the distance between ababa and aaa is 2, the distance between aaa and aba is 1, the distance between bbaba and abb is 3. The edit distance is 0 if and only if the strings are equal.It is also worth considering that the artifact has a resistance limit Â \xe2\x80\x94 if you cast more than n+2 spells, where n is the length of spell s, the rune will be blocked.Thus, it takes n+2 or fewer spells to destroy the rune that is on your artifact. Keep in mind that the required destructive spell s must also be counted among these n+2 spells.Note that the length n of the rune-destroying spell s is not known to you in advance. It is only known that its length n does not exceed 300." 2300
1282C "Petya and Exam" "greedy,sortings,two pointers" "Petya has come to the math exam and wants to solve as many problems as possible. He prepared and carefully studied the rules by which the exam passes.The exam consists of n problems that can be solved in T minutes. Thus, the exam begins at time 0 and ends at time T. Petya can leave the exam at any integer time from 0 to T, inclusive.All problems are divided into two types:   easy problems \xe2\x80\x94 Petya takes exactly a minutes to solve any easy problem;  hard problems \xe2\x80\x94 Petya takes exactly b minutes (b>a) to solve any hard problem. Thus, if Petya starts solving an easy problem at time x, then it will be solved at time x+a. Similarly, if at a time x Petya starts to solve a hard problem, then it will be solved at time x+b.For every problem, Petya knows if it is easy or hard. Also, for each problem is determined time ti (0\xe2\x89\xa4ti\xe2\x89\xa4T) at which it will become mandatory (required). If Petya leaves the exam at time s and there is such a problem i that ti\xe2\x89\xa4s and he didn\'t solve it, then he will receive 0 points for the whole exam. Otherwise (i.e if he has solved all such problems for which ti\xe2\x89\xa4s) he will receive a number of points equal to the number of solved problems. Note that leaving at time s Petya can have both ""mandatory"" and ""non-mandatory"" problems solved.For example, if n=2, T=5, a=2, b=3, the first problem is hard and t1=3 and the second problem is easy and t2=2. Then:  if he leaves at time s=0, then he will receive 0 points since he will not have time to solve any problems;  if he leaves at time s=1, he will receive 0 points since he will not have time to solve any problems;  if he leaves at time s=2, then he can get a 1 point by solving the problem with the number 2 (it must be solved in the range from 0 to 2);  if he leaves at time s=3, then he will receive 0 points since at this moment both problems will be mandatory, but he will not be able to solve both of them;  if he leaves at time s=4, then he will receive 0 points since at this moment both problems will be mandatory, but he will not be able to solve both of them;  if he leaves at time s=5, then he can get 2 points by solving all problems. Thus, the answer to this test is 2.Help Petya to determine the maximal number of points that he can receive, before leaving the exam." 1800
1282B2 "K for the Price of One (Hard Version)" dp,greedy,sortings "This is the hard version of this problem. The only difference is the constraint on k \xe2\x80\x94 the number of gifts in the offer. In this version: 2\xe2\x89\xa4k\xe2\x89\xa4n.Vasya came to the store to buy goods for his friends for the New Year. It turned out that he was very luckyÂ \xe2\x80\x94 today the offer ""k of goods for the price of one"" is held in store.Using this offer, Vasya can buy exactly k of any goods, paying only for the most expensive of them. Vasya decided to take this opportunity and buy as many goods as possible for his friends with the money he has.More formally, for each good, its price is determined by aiÂ \xe2\x80\x94 the number of coins it costs. Initially, Vasya has p coins. He wants to buy the maximum number of goods. Vasya can perform one of the following operations as many times as necessary:  Vasya can buy one good with the index i if he currently has enough coins (i.e p\xe2\x89\xa5ai). After buying this good, the number of Vasya\'s coins will decrease by ai, (i.e it becomes p:=p\xe2\x88\x92ai).  Vasya can buy a good with the index i, and also choose exactly k\xe2\x88\x921 goods, the price of which does not exceed ai, if he currently has enough coins (i.e p\xe2\x89\xa5ai). Thus, he buys all these k goods, and his number of coins decreases by ai (i.e it becomes p:=p\xe2\x88\x92ai). Please note that each good can be bought no more than once.For example, if the store now has n=5 goods worth a1=2,a2=4,a3=3,a4=5,a5=7, respectively, k=2, and Vasya has 6 coins, then he can buy 3 goods. A good with the index 1 will be bought by Vasya without using the offer and he will pay 2 coins. Goods with the indices 2 and 3 Vasya will buy using the offer and he will pay 4 coins. It can be proved that Vasya can not buy more goods with six coins.Help Vasya to find out the maximum number of goods he can buy." 1600
1282B1 "K for the Price of One (Easy Version)" dp,greedy,sortings "This is the easy version of this problem. The only difference is the constraint on k \xe2\x80\x94 the number of gifts in the offer. In this version: k=2.Vasya came to the store to buy goods for his friends for the New Year. It turned out that he was very luckyÂ \xe2\x80\x94 today the offer ""k of goods for the price of one"" is held in store. Remember, that in this problem k=2.Using this offer, Vasya can buy exactly k of any goods, paying only for the most expensive of them. Vasya decided to take this opportunity and buy as many goods as possible for his friends with the money he has.More formally, for each good, its price is determined by aiÂ \xe2\x80\x94 the number of coins it costs. Initially, Vasya has p coins. He wants to buy the maximum number of goods. Vasya can perform one of the following operations as many times as necessary:  Vasya can buy one good with the index i if he currently has enough coins (i.e p\xe2\x89\xa5ai). After buying this good, the number of Vasya\'s coins will decrease by ai, (i.e it becomes p:=p\xe2\x88\x92ai).  Vasya can buy a good with the index i, and also choose exactly k\xe2\x88\x921 goods, the price of which does not exceed ai, if he currently has enough coins (i.e p\xe2\x89\xa5ai). Thus, he buys all these k goods, and his number of coins decreases by ai (i.e it becomes p:=p\xe2\x88\x92ai). Please note that each good can be bought no more than once.For example, if the store now has n=5 goods worth a1=2,a2=4,a3=3,a4=5,a5=7, respectively, k=2, and Vasya has 6 coins, then he can buy 3 goods. A good with the index 1 will be bought by Vasya without using the offer and he will pay 2 coins. Goods with the indices 2 and 3 Vasya will buy using the offer and he will pay 4 coins. It can be proved that Vasya can not buy more goods with six coins.Help Vasya to find out the maximum number of goods he can buy." 1400
1282A "Temporarily unavailable" implementation,math "Polycarp lives on the coordinate axis Ox and travels from the point x=a to x=b. It moves uniformly rectilinearly at a speed of one unit of distance per minute.On the axis Ox at the point x=c the base station of the mobile operator is placed. It is known that the radius of its coverage is r. Thus, if Polycarp is at a distance less than or equal to r from the point x=c, then he is in the network coverage area, otherwiseÂ \xe2\x80\x94 no. The base station can be located both on the route of Polycarp and outside it.Print the time in minutes during which Polycarp will not be in the coverage area of the network, with a rectilinear uniform movement from x=a to x=b. His speedÂ \xe2\x80\x94 one unit of distance per minute." 900
1281B "Azamon Web Services" greedy "Your friend Jeff Zebos has been trying to run his new online company, but it\'s not going very well. He\'s not getting a lot of sales on his website which he decided to call Azamon. His big problem, you think, is that he\'s not ranking high enough on the search engines. If only he could rename his products to have better names than his competitors, then he\'ll be at the top of the search results and will be a millionaire.After doing some research, you find out that search engines only sort their results lexicographically. If your friend could rename his products to lexicographically smaller strings than his competitor\'s, then he\'ll be at the top of the rankings!To make your strategy less obvious to his competitors, you decide to swap no more than two letters of the product names.Please help Jeff to find improved names for his products that are lexicographically smaller than his competitor\'s!Given the string s representing Jeff\'s product name and the string c representing his competitor\'s product name, find a way to swap at most one pair of characters in s (that is, find two distinct indices i and j and swap si and sj) such that the resulting new name becomes strictly lexicographically smaller than c, or determine that it is impossible.Note: String a is strictly lexicographically smaller than string b if and only if one of the following holds:  a is a proper prefix of b, that is, a is a prefix of b such that a\xe2\x89\xa0b;  There exists an integer 1\xe2\x89\xa4i\xe2\x89\xa4min(|a|,|b|) such that ai<bi and aj=bj for 1\xe2\x89\xa4j<i." 1600
1281A "Suffix Three" implementation "We just discovered a new data structure in our research group: a suffix three!It\'s very useful for natural language processing. Given three languages and three suffixes, a suffix three can determine which language a sentence is written in.It\'s super simple, 100% accurate, and doesn\'t involve advanced machine learning algorithms.Let us tell you how it works.  If a sentence ends with ""po"" the language is Filipino.  If a sentence ends with ""desu"" or ""masu"" the language is Japanese.  If a sentence ends with ""mnida"" the language is Korean. Given this, we need you to implement a suffix three that can differentiate Filipino, Japanese, and Korean.Oh, did I say three suffixes? I meant four." 800
1280F "Intergalactic Sliding Puzzle" "combinatorics,constructive algorithms,math" "You are an intergalactic surgeon and you have an alien patient. For the purposes of this problem, we can and we will model this patient\'s body using a 2\xc3\x97(2k+1) rectangular grid. The alien has 4k+1 distinct organs, numbered 1 to 4k+1.In healthy such aliens, the organs are arranged in a particular way. For example, here is how the organs of a healthy such alien would be positioned, when viewed from the top, for k=4:  Here, the E represents empty space. In general, the first row contains organs 1 to 2k+1 (in that order from left to right), and the second row contains organs 2k+2 to 4k+1 (in that order from left to right) and then empty space right after. Your patient\'s organs are complete, and inside their body, but they somehow got shuffled around! Your job, as an intergalactic surgeon, is to put everything back in its correct position. All organs of the alien must be in its body during the entire procedure. This means that at any point during the procedure, there is exactly one cell (in the grid) that is empty. In addition, you can only move organs around by doing one of the following things:  You can switch the positions of the empty space E with any organ to its immediate left or to its immediate right (if they exist). In reality, you do this by sliding the organ in question to the empty space;  You can switch the positions of the empty space E with any organ to its immediate top or its immediate bottom (if they exist) only if the empty space is on the leftmost column, rightmost column or in the centermost column. Again, you do this by sliding the organ in question to the empty space. Your job is to figure out a sequence of moves you must do during the surgical procedure in order to place back all 4k+1 internal organs of your patient in the correct cells. If it is impossible to do so, you must say so." 3400
1280E "Kirchhoff\'s Current Loss" math "Your friend Kirchhoff is shocked with the current state of electronics design.""Ohmygosh! Watt is wrong with the field? All these circuits are inefficient! There\'s so much capacity for improvement. The electrical engineers must not conduct their classes very well. It\'s absolutely revolting"" he said.The negativity just keeps flowing out of him, but even after complaining so many times he still hasn\'t lepton the chance to directly change anything.""These circuits have too much total resistance. Wire they designed this way? It\'s just causing a massive loss of resistors! Their entire field could conserve so much money if they just maximized the potential of their designs. Why can\'t they just try alternative ideas?""The frequency of his protests about the electrical engineering department hertz your soul, so you have decided to take charge and help them yourself. You plan to create a program that will optimize the circuits while keeping the same circuit layout and maintaining the same effective resistance.A circuit has two endpoints, and is associated with a certain constant, RR, called its effective resistance. The circuits we\'ll consider will be formed from individual resistors joined together in series or in parallel, forming more complex circuits. The following image illustrates combining circuits in series or parallel.   According to your friend Kirchhoff, the effective resistance can be calculated quite easily when joining circuits this way:  When joining kk circuits in series with effective resistances R1,R2,\xe2\x80\xa6,RkR1,R2,\xe2\x80\xa6,Rk, the effective resistance RR of the resulting circuit is the sum R=R1+R2+\xe2\x80\xa6+Rk.R=R1+R2+\xe2\x80\xa6+Rk.  When joining kk circuits in parallel with effective resistances R1,R2,\xe2\x80\xa6,RkR1,R2,\xe2\x80\xa6,Rk, the effective resistance RR of the resulting circuit is found by solving for RR in 1R=1R1+1R2+\xe2\x80\xa6+1Rk,1R=1R1+1R2+\xe2\x80\xa6+1Rk, assuming all Ri>0Ri>0; if at least one Ri=0Ri=0, then the effective resistance of the whole circuit is simply R=0R=0. Circuits will be represented by strings. Individual resistors are represented by an asterisk, ""*"". For more complex circuits, suppose s1,s2,\xe2\x80\xa6,sks1,s2,\xe2\x80\xa6,sk represent k\xe2\x89\xa52k\xe2\x89\xa52 circuits. Then:  ""(s1s1 S s2s2 S \xe2\x80\xa6\xe2\x80\xa6 S sksk)"" represents their series circuit;  ""(s1s1 P s2s2 P \xe2\x80\xa6\xe2\x80\xa6 P sksk)"" represents their parallel circuit. For example, ""(* P (* S *) P *)"" represents the following circuit:  Given a circuit, your task is to assign the resistances of the individual resistors such that they satisfy the following requirements:  Each individual resistor has a nonnegative integer resistance value;  The effective resistance of the whole circuit is rr;  The sum of the resistances of the individual resistors is minimized. If there are nn individual resistors, then you need to output the list r1,r2,\xe2\x80\xa6,rnr1,r2,\xe2\x80\xa6,rn (0\xe2\x89\xa4ri0\xe2\x89\xa4ri, and riri is an integer), where riri is the resistance assigned to the ii-th individual resistor that appears in the input (from left to right). If it is impossible to accomplish the task, you must say so as well.If it is possible, then it is guaranteed that the minimum sum of resistances is at most 10181018." 2900
1280D "Miss Punyverse" dp,greedy,trees "The Oak has n nesting places, numbered with integers from 1 to n. Nesting place i is home to bi bees and wi wasps.Some nesting places are connected by branches. We call two nesting places adjacent if there exists a branch between them. A simple path from nesting place x to y is given by a sequence s0,\xe2\x80\xa6,sp of distinct nesting places, where p is a non-negative integer, s0=x, sp=y, and si\xe2\x88\x921 and si are adjacent for each i=1,\xe2\x80\xa6,p. The branches of The Oak are set up in such a way that for any two pairs of nesting places x and y, there exists a unique simple path from x to y. Because of this, biologists and computer scientists agree that The Oak is in fact, a tree.A village is a nonempty set V of nesting places such that for any two x and y in V, there exists a simple path from x to y whose intermediate nesting places all lie in V. A set of villages P is called a partition if each of the n nesting places is contained in exactly one of the villages in P. In other words, no two villages in P share any common nesting place, and altogether, they contain all n nesting places.The Oak holds its annual Miss Punyverse beauty pageant. The two contestants this year are Ugly Wasp and Pretty Bee. The winner of the beauty pageant is determined by voting, which we will now explain. Suppose P is a partition of the nesting places into m villages V1,\xe2\x80\xa6,Vm. There is a local election in each village. Each of the insects in this village vote for their favorite contestant. If there are strictly more votes for Ugly Wasp than Pretty Bee, then Ugly Wasp is said to win in that village. Otherwise, Pretty Bee wins. Whoever wins in the most number of villages wins.As it always goes with these pageants, bees always vote for the bee (which is Pretty Bee this year) and wasps always vote for the wasp (which is Ugly Wasp this year). Unlike their general elections, no one abstains from voting for Miss Punyverse as everyone takes it very seriously.Mayor Waspacito, and his assistant Alexwasp, wants Ugly Wasp to win. He has the power to choose how to partition The Oak into exactly m villages. If he chooses the partition optimally, determine the maximum number of villages in which Ugly Wasp wins." 2500
1280C "Jeremy Bearimy" "dfs and similar,graphs,greedy,trees" "Welcome! Everything is fine.You have arrived in The Medium Place, the place between The Good Place and The Bad Place. You are assigned a task that will either make people happier or torture them for eternity.You have a list of k pairs of people who have arrived in a new inhabited neighborhood. You need to assign each of the 2k people into one of the 2k houses. Each person will be the resident of exactly one house, and each house will have exactly one resident.Of course, in the neighborhood, it is possible to visit friends. There are 2k\xe2\x88\x921 roads, each of which connects two houses. It takes some time to traverse a road. We will specify the amount of time it takes in the input. The neighborhood is designed in such a way that from anyone\'s house, there is exactly one sequence of distinct roads you can take to any other house. In other words, the graph with the houses as vertices and the roads as edges is a tree.The truth is, these k pairs of people are actually soulmates. We index them from 1 to k. We denote by f(i) the amount of time it takes for the i-th pair of soulmates to go to each other\'s houses.As we have said before, you will need to assign each of the 2k people into one of the 2k houses. You have two missions, one from the entities in The Good Place and one from the entities of The Bad Place. Here they are:  The first mission, from The Good Place, is to assign the people into the houses such that the sum of f(i) over all pairs i is minimized. Let\'s define this minimized sum as G. This makes sure that soulmates can easily and efficiently visit each other;  The second mission, from The Bad Place, is to assign the people into the houses such that the sum of f(i) over all pairs i is maximized. Let\'s define this maximized sum as B. This makes sure that soulmates will have a difficult time to visit each other. What are the values of G and B?" 2000
1280B Beingawesomeism implementation,math "You are an all-powerful being and you have created a rectangular world. In fact, your world is so bland that it could be represented by a r\xc3\x97cr\xc3\x97c grid. Each cell on the grid represents a country. Each country has a dominant religion. There are only two religions in your world. One of the religions is called Beingawesomeism, who do good for the sake of being good. The other religion is called Pushingittoofarism, who do murders for the sake of being bad.Oh, and you are actually not really all-powerful. You just have one power, which you can use infinitely many times! Your power involves missionary groups. When a missionary group of a certain country, say aa, passes by another country bb, they change the dominant religion of country bb to the dominant religion of country aa.In particular, a single use of your power is this:   You choose a horizontal 1\xc3\x97x1\xc3\x97x subgrid or a vertical x\xc3\x971x\xc3\x971 subgrid. That value of xx is up to you;  You choose a direction dd. If you chose a horizontal subgrid, your choices will either be NORTH or SOUTH. If you choose a vertical subgrid, your choices will either be EAST or WEST;  You choose the number ss of steps;  You command each country in the subgrid to send a missionary group that will travel ss steps towards direction dd. In each step, they will visit (and in effect convert the dominant religion of) all ss countries they pass through, as detailed above.  The parameters xx, dd, ss must be chosen in such a way that any of the missionary groups won\'t leave the grid. The following image illustrates one possible single usage of your power. Here, A represents a country with dominant religion Beingawesomeism and P represents a country with dominant religion Pushingittoofarism. Here, we\'ve chosen a 1\xc3\x9741\xc3\x974 subgrid, the direction NORTH, and s=2s=2 steps.   You are a being which believes in free will, for the most part. However, you just really want to stop receiving murders that are attributed to your name. Hence, you decide to use your powers and try to make Beingawesomeism the dominant religion in every country.What is the minimum number of usages of your power needed to convert everyone to Beingawesomeism?With god, nothing is impossible. But maybe you\'re not god? If it is impossible to make Beingawesomeism the dominant religion in all countries, you must also admit your mortality and say so." 1800
1280A "Cut and Paste" implementation,math "We start with a string s consisting only of the digits 1, 2, or 3. The length of s is denoted by |s|. For each i from 1 to |s|, the i-th character of s is denoted by si. There is one cursor. The cursor\'s location \xe2\x84\x93 is denoted by an integer in {0,\xe2\x80\xa6,|s|}, with the following meaning:   If \xe2\x84\x93=0, then the cursor is located before the first character of s.  If \xe2\x84\x93=|s|, then the cursor is located right after the last character of s.  If 0<\xe2\x84\x93<|s|, then the cursor is located between s\xe2\x84\x93 and s\xe2\x84\x93+1. We denote by sleft the string to the left of the cursor and sright the string to the right of the cursor. We also have a string c, which we call our clipboard, which starts out as empty. There are three types of actions:  The Move action. Move the cursor one step to the right. This increments \xe2\x84\x93 once.  The Cut action. Set c\xe2\x86\x90sright, then set s\xe2\x86\x90sleft.  The Paste action. Append the value of c to the end of the string s. Note that this doesn\'t modify c. The cursor initially starts at \xe2\x84\x93=0. Then, we perform the following procedure:  Perform the Move action once.  Perform the Cut action once.  Perform the Paste action s\xe2\x84\x93 times.  If \xe2\x84\x93=x, stop. Otherwise, return to step 1. You\'re given the initial string s and the integer x. What is the length of s when the procedure stops? Since this value may be very large, only find it modulo 109+7. It is guaranteed that \xe2\x84\x93\xe2\x89\xa4|s| at any time." 1700
1279F "New Year and Handle Change" "binary search,dp" "New Year is getting near. So it\'s time to change handles on codeforces. Mishka wants to change his handle but in such a way that people would not forget who he is.To make it work, he only allowed to change letters case. More formally, during one handle change he can choose any segment of his handle [i;i+l\xe2\x88\x921] and apply tolower or toupper to all letters of his handle on this segment (more fomally, replace all uppercase letters with corresponding lowercase or vice versa). The length l is fixed for all changes.Because it is not allowed to change codeforces handle too often, Mishka can perform at most k such operations. What is the minimum value of min(lower,upper) (where lower is the number of lowercase letters, and upper is the number of uppercase letters) can be obtained after optimal sequence of changes?" 2800
1279E "New Year Permutations" combinatorics,dp "Yeah, we failed to make up a New Year legend for this problem.A permutation of length n is an array of n integers such that every integer from 1 to n appears in it exactly once. An element y of permutation p is reachable from element x if x=y, or px=y, or ppx=y, and so on. The decomposition of a permutation p is defined as follows: firstly, we have a permutation p, all elements of which are not marked, and an empty list l. Then we do the following: while there is at least one not marked element in p, we find the leftmost such element, list all elements that are reachable from it in the order they appear in p, mark all of these elements, then cyclically shift the list of those elements so that the maximum appears at the first position, and add this list as an element of l. After all elements are marked, l is the result of this decomposition.For example, if we want to build a decomposition of p=[5,4,2,3,1,7,8,6], we do the following:  initially p=[5,4,2,3,1,7,8,6] (bold elements are marked), l=[];  the leftmost unmarked element is 5; 5 and 1 are reachable from it, so the list we want to shift is [5,1]; there is no need to shift it, since maximum is already the first element;  p=[5,4,2,3,1,7,8,6], l=[[5,1]];  the leftmost unmarked element is 4, the list of reachable elements is [4,2,3]; the maximum is already the first element, so there\'s no need to shift it;  p=[5,4,2,3,1,7,8,6], l=[[5,1],[4,2,3]];  the leftmost unmarked element is 7, the list of reachable elements is [7,8,6]; we have to shift it, so it becomes [8,6,7];  p=[5,4,2,3,1,7,8,6], l=[[5,1],[4,2,3],[8,6,7]];  all elements are marked, so [[5,1],[4,2,3],[8,6,7]] is the result. The New Year transformation of a permutation is defined as follows: we build the decomposition of this permutation; then we sort all lists in decomposition in ascending order of the first elements (we don\'t swap the elements in these lists, only the lists themselves); then we concatenate the lists into one list which becomes a new permutation. For example, the New Year transformation of p=[5,4,2,3,1,7,8,6] is built as follows:  the decomposition is [[5,1],[4,2,3],[8,6,7]];  after sorting the decomposition, it becomes [[4,2,3],[5,1],[8,6,7]];  [4,2,3,5,1,8,6,7] is the result of the transformation. We call a permutation good if the result of its transformation is the same as the permutation itself. For example, [4,3,1,2,8,5,6,7] is a good permutation; and [5,4,2,3,1,7,8,6] is bad, since the result of transformation is [4,2,3,5,1,8,6,7].Your task is the following: given n and k, find the k-th (lexicographically) good permutation of length n." 2700
1279D "Santa\'s Bot" combinatorics,math,probabilities "Santa Claus has received letters from n different kids throughout this year. Of course, each kid wants to get some presents from Santa: in particular, the i-th kid asked Santa to give them one of ki different items as a present. Some items could have been asked by multiple kids.Santa is really busy, so he wants the New Year Bot to choose the presents for all children. Unfortunately, the Bot\'s algorithm of choosing presents is bugged. To choose a present for some kid, the Bot does the following:  choose one kid x equiprobably among all n kids;  choose some item y equiprobably among all kx items kid x wants;  choose a kid z who will receive the present equipropably among all n kids (this choice is independent of choosing x and y); the resulting triple (x,y,z) is called the decision of the Bot. If kid z listed item y as an item they want to receive, then the decision valid. Otherwise, the Bot\'s choice is invalid.Santa is aware of the bug, but he can\'t estimate if this bug is really severe. To do so, he wants to know the probability that one decision generated according to the aforementioned algorithm is valid. Can you help him?" 1700
1279C "Stack of Presents" "data structures,implementation" "Santa has to send presents to the kids. He has a large stack of n presents, numbered from 1 to n; the topmost present has number a1, the next present is a2, and so on; the bottom present has number an. All numbers are distinct.Santa has a list of m distinct presents he has to send: b1, b2, ..., bm. He will send them in the order they appear in the list.To send a present, Santa has to find it in the stack by removing all presents above it, taking this present and returning all removed presents on top of the stack. So, if there are k presents above the present Santa wants to send, it takes him 2k+1 seconds to do it. Fortunately, Santa can speed the whole process up \xe2\x80\x94 when he returns the presents to the stack, he may reorder them as he wishes (only those which were above the present he wanted to take; the presents below cannot be affected in any way).What is the minimum time required to send all of the presents, provided that Santa knows the whole list of presents he has to send and reorders the presents optimally? Santa cannot change the order of presents or interact with the stack of presents in any other way.Your program has to answer t different test cases." 1400
1279B "Verse For Santa" "binary search,brute force,implementation" "New Year is coming! Vasya has prepared a New Year\'s verse and wants to recite it in front of Santa Claus.Vasya\'s verse contains n parts. It takes ai seconds to recite the i-th part. Vasya can\'t change the order of parts in the verse: firstly he recites the part which takes a1 seconds, secondly \xe2\x80\x94 the part which takes a2 seconds, and so on. After reciting the verse, Vasya will get the number of presents equal to the number of parts he fully recited.Vasya can skip at most one part of the verse while reciting it (if he skips more than one part, then Santa will definitely notice it).Santa will listen to Vasya\'s verse for no more than s seconds. For example, if s=10, a=[100,9,1,1], and Vasya skips the first part of verse, then he gets two presents.Note that it is possible to recite the whole verse (if there is enough time). Determine which part Vasya needs to skip to obtain the maximum possible number of gifts. If Vasya shouldn\'t skip anything, print 0. If there are multiple answers, print any of them.You have to process t test cases." 1300
1279A "New Year Garland" math "Polycarp is sad \xe2\x80\x94 New Year is coming in few days but there is still no snow in his city. To bring himself New Year mood, he decided to decorate his house with some garlands.The local store introduced a new service this year, called ""Build your own garland"". So you can buy some red, green and blue lamps, provide them and the store workers will solder a single garland of them. The resulting garland will have all the lamps you provided put in a line. Moreover, no pair of lamps of the same color will be adjacent to each other in this garland!For example, if you provide 3 red, 3 green and 3 blue lamps, the resulting garland can look like this: ""RGBRBGBGR"" (""RGB"" being the red, green and blue color, respectively). Note that it\'s ok to have lamps of the same color on the ends of the garland.However, if you provide, say, 1 red, 10 green and 2 blue lamps then the store workers won\'t be able to build any garland of them. Any garland consisting of these lamps will have at least one pair of lamps of the same color adjacent to each other. Note that the store workers should use all the lamps you provided.So Polycarp has bought some sets of lamps and now he wants to know if the store workers can build a garland from each of them." 900
1278F Cards "combinatorics,dp,math,number theory,probabilities" "Consider the following experiment. You have a deck of m cards, and exactly one card is a joker. n times, you do the following: shuffle the deck, take the top card of the deck, look at it and return it into the deck.Let x be the number of times you have taken the joker out of the deck during this experiment. Assuming that every time you shuffle the deck, all m! possible permutations of cards are equiprobable, what is the expected value of xk? Print the answer modulo 998244353." 2600
1278E "Tests for problem D" "constructive algorithms,dfs and similar,divide and conquer,trees" "We had a really tough time generating tests for problem D. In order to prepare strong tests, we had to solve the following problem.Given an undirected labeled tree consisting of n vertices, find a set of segments such that:  both endpoints of each segment are integers from 1 to 2n, and each integer from 1 to 2n should appear as an endpoint of exactly one segment;  all segments are non-degenerate;  for each pair (i,j) such that i\xe2\x89\xa0j, i\xe2\x88\x88[1,n] and j\xe2\x88\x88[1,n], the vertices i and j are connected with an edge if and only if the segments i and j intersect, but neither segment i is fully contained in segment j, nor segment j is fully contained in segment i. Can you solve this problem too?" 2200
1278D "Segment Tree" "data structures,dsu,graphs,trees" "As the name of the task implies, you are asked to do some work with segments and trees.Recall that a tree is a connected undirected graph such that there is exactly one simple path between every pair of its vertices.You are given n segments [l1,r1],[l2,r2],\xe2\x80\xa6,[ln,rn], li<ri for every i. It is guaranteed that all segments\' endpoints are integers, and all endpoints are unique \xe2\x80\x94 there is no pair of segments such that they start in the same point, end in the same point or one starts in the same point the other one ends.Let\'s generate a graph with n vertices from these segments. Vertices v and u are connected by an edge if and only if segments [lv,rv] and [lu,ru] intersect and neither of it lies fully inside the other one.For example, pairs ([1,3],[2,4]) and ([5,10],[3,7]) will induce the edges but pairs ([1,2],[3,4]) and ([5,7],[3,10]) will not.Determine if the resulting graph is a tree or not." 2100
1278C "Berry Jam" "data structures,dp,greedy,implementation" "Karlsson has recently discovered a huge stock of berry jam jars in the basement of the house. More specifically, there were 2n jars of strawberry and blueberry jam.All the 2n jars are arranged in a row. The stairs to the basement are exactly in the middle of that row. So when Karlsson enters the basement, he sees exactly n jars to his left and n jars to his right.For example, the basement might look like this:  Being the starightforward man he is, he immediately starts eating the jam. In one minute he chooses to empty either the first non-empty jar to his left or the first non-empty jar to his right.Finally, Karlsson decided that at the end the amount of full strawberry and blueberry jam jars should become the same.For example, this might be the result:  He has eaten 1 jar to his left and then 5 jars to his right. There remained exactly 3 full jars of both strawberry and blueberry jam. Jars are numbered from 1 to 2n from left to right, so Karlsson initially stands between jars n and n+1.What is the minimum number of jars Karlsson is required to empty so that an equal number of full strawberry and blueberry jam jars is left?Your program should answer t independent test cases." 1700
1278B "A and B" greedy,math "You are given two integers a and b. You can perform a sequence of operations: during the first operation you choose one of these numbers and increase it by 1; during the second operation you choose one of these numbers and increase it by 2, and so on. You choose the number of these operations yourself.For example, if a=1 and b=3, you can perform the following sequence of three operations:   add 1 to a, then a=2 and b=3;  add 2 to b, then a=2 and b=5;  add 3 to a, then a=5 and b=5. Calculate the minimum number of operations required to make a and b equal." 1500
1278A "Shuffle Hashing" "brute force,implementation,strings" "Polycarp has built his own web service. Being a modern web service it includes login feature. And that always implies password security problems.Polycarp decided to store the hash of the password, generated by the following algorithm:  take the password p, consisting of lowercase Latin letters, and shuffle the letters randomly in it to obtain p\xe2\x80\xb2 (p\xe2\x80\xb2 can still be equal to p);  generate two random strings, consisting of lowercase Latin letters, s1 and s2 (any of these strings can be empty);  the resulting hash h=s1+p\xe2\x80\xb2+s2, where addition is string concatenation. For example, let the password p= ""abacaba"". Then p\xe2\x80\xb2 can be equal to ""aabcaab"". Random strings s1= ""zyx"" and s2= ""kjh"". Then h= ""zyxaabcaabkjh"".Note that no letters could be deleted or added to p to obtain p\xe2\x80\xb2, only the order could be changed.Now Polycarp asks you to help him to implement the password check module. Given the password p and the hash h, check that h can be the hash for the password p.Your program should answer t independent test cases." 1000
1277D "Let\'s Play the Words?" "data structures,hashing,implementation,math" "Polycarp has n different binary words. A word called binary if it contains only characters \'0\' and \'1\'. For example, these words are binary: ""0001"", ""11"", ""0"" and ""0011100"".Polycarp wants to offer his set of n binary words to play a game ""words"". In this game, players name words and each next word (starting from the second) must start with the last character of the previous word. The first word can be any. For example, these sequence of words can be named during the game: ""0101"", ""1"", ""10"", ""00"", ""00001"".Word reversal is the operation of reversing the order of the characters. For example, the word ""0111"" after the reversal becomes ""1110"", the word ""11010"" after the reversal becomes ""01011"".Probably, Polycarp has such a set of words that there is no way to put them in the order correspondent to the game rules. In this situation, he wants to reverse some words from his set so that:  the final set of n words still contains different words (i.e. all words are unique);  there is a way to put all words of the final set of words in the order so that the final sequence of n words is consistent with the game rules. Polycarp wants to reverse minimal number of words. Please, help him." 1900
1277B "Make Them Odd" "greedy,number theory" "There are n positive integers a1,a2,\xe2\x80\xa6,an. For the one move you can choose any even value c and divide by two all elements that equal c.For example, if a=[6,8,12,6,3,12] and you choose c=6, and a is transformed into a=[3,8,12,3,3,12] after the move.You need to find the minimal number of moves for transforming a to an array of only odd integers (each element shouldn\'t be divisible by 2)." 1200
1277A "Happy Birthday, Polycarp!" implementation "Hooray! Polycarp turned n years old! The Technocup Team sincerely congratulates Polycarp!Polycarp celebrated all of his n birthdays: from the 1-th to the n-th. At the moment, he is wondering: how many times he turned beautiful number of years?According to Polycarp, a positive integer is beautiful if it consists of only one digit repeated one or more times. For example, the following numbers are beautiful: 1, 77, 777, 44 and 999999. The following numbers are not beautiful: 12, 11110, 6969 and 987654321.Of course, Polycarpus uses the decimal numeral system (i.e. radix is 10).Help Polycarpus to find the number of numbers from 1 to n (inclusive) that are beautiful." 1000
1276F "Asterisk Substrings" "string suffix structures" "Consider a string s of n lowercase English letters. Let ti be the string obtained by replacing the i-th character of s with an asterisk character *. For example, when s=abc, we have t1=\xe2\x88\x97bc, t2=a\xe2\x88\x97c, and t3=ab\xe2\x88\x97.Given a string s, count the number of distinct strings of lowercase English letters and asterisks that occur as a substring of at least one string in the set {s,t1,\xe2\x80\xa6,tn}. The empty string should be counted.Note that *\'s are just characters and do not play any special role as in, for example, regex matching." 3400
1276E "Four Stones" "constructive algorithms" "There are four stones on an infinite line in integer coordinates a1,a2,a3,a4. The goal is to have the stones in coordinates b1,b2,b3,b4. The order of the stones does not matter, that is, a stone from any position ai can end up in at any position bj, provided there is a required number of stones in each position (that is, if a coordinate x appears k times among numbers b1,\xe2\x80\xa6,b4, there should be exactly k stones at x in the end).We are allowed to move stones with the following operation: choose two stones at distinct positions x and y with at least one stone each, and move one stone from x to 2y\xe2\x88\x92x. In other words, the operation moves a stone to a symmetric position relative to some other stone. At any moment it is allowed to have any number of stones at the same position.Find any sequence of operations that achieves the goal, or determine that it is impossible. The sequence does not have to be shortest, but it may contain at most 1000 operations." 3500
1276D "Tree Elimination" dp,trees "Vasya has a tree with n vertices numbered from 1 to n, and n\xe2\x88\x921 edges numbered from 1 to n\xe2\x88\x921. Initially each vertex contains a token with the number of the vertex written on it.Vasya plays a game. He considers all edges of the tree by increasing of their indices. For every edge he acts as follows: If both endpoints of the edge contain a token, remove a token from one of the endpoints and write down its number. Otherwise, do nothing.The result of the game is the sequence of numbers Vasya has written down. Note that there may be many possible resulting sequences depending on the choice of endpoints when tokens are removed.Vasya has played for such a long time that he thinks he exhausted all possible resulting sequences he can obtain. He wants you to verify him by computing the number of distinct sequences modulo 998244353." 2900
1276C "Beautiful Rectangle" "brute force,combinatorics,constructive algorithms,data structures,greedy,math" "You are given n integers. You need to choose a subset and put the chosen numbers in a beautiful rectangle (rectangular matrix). Each chosen number should occupy one of its rectangle cells, each cell must be filled with exactly one chosen number. Some of the n numbers may not be chosen.A rectangle (rectangular matrix) is called beautiful if in each row and in each column all values are different.What is the largest (by the total number of cells) beautiful rectangle you can construct? Print the rectangle itself." 2300
1276B "Two Fairs" "combinatorics,dfs and similar,dsu,graphs" "There are n cities in Berland and some pairs of them are connected by two-way roads. It is guaranteed that you can pass from any city to any other, moving along the roads. Cities are numerated from 1 to n.Two fairs are currently taking place in Berland \xe2\x80\x94 they are held in two different cities a and b (1\xe2\x89\xa4a,b\xe2\x89\xa4n; a\xe2\x89\xa0b).Find the number of pairs of cities x and y (x\xe2\x89\xa0a,x\xe2\x89\xa0b,y\xe2\x89\xa0a,y\xe2\x89\xa0b) such that if you go from x to y you will have to go through both fairs (the order of visits doesn\'t matter). Formally, you need to find the number of pairs of cities x,y such that any path from x to y goes through a and b (in any order).Print the required number of pairs. The order of two cities in a pair does not matter, that is, the pairs (x,y) and (y,x) must be taken into account only once." 1900
1276A "As Simple as One and Two" dp,greedy "You are given a non-empty string s=s1s2\xe2\x80\xa6sn, which consists only of lowercase Latin letters. Polycarp does not like a string if it contains at least one string ""one"" or at least one string ""two"" (or both at the same time) as a substring. In other words, Polycarp does not like the string s if there is an integer j (1\xe2\x89\xa4j\xe2\x89\xa4n\xe2\x88\x922), that sjsj+1sj+2=""one"" or sjsj+1sj+2=""two"".For example:  Polycarp does not like strings ""oneee"", ""ontwow"", ""twone"" and ""oneonetwo"" (they all have at least one substring ""one"" or ""two""),  Polycarp likes strings ""oonnee"", ""twwwo"" and ""twnoe"" (they have no substrings ""one"" and ""two""). Polycarp wants to select a certain set of indices (positions) and remove all letters on these positions. All removals are made at the same time.For example, if the string looks like s=""onetwone"", then if Polycarp selects two indices 3 and 6, then ""onetwone"" will be selected and the result is ""ontwne"".What is the minimum number of indices (positions) that Polycarp needs to select to make the string liked? What should these positions be?" 1400
1275F "\xd0\xa8\xd0\xb0\xd1\x80\xd0\xb4\xd0\xb8\xd1\x80\xd0\xbe\xd0\xb2\xd0\xb0\xd0\xbd\xd0\xb8\xd0\xb5 \xd0\xbf\xd0\xbe\xd1\x81\xd1\x82\xd0\xbe\xd0\xb2" "*special problem,binary search,interactive" "\xd0\xad\xd1\x82\xd0\xbe \xd0\xb8\xd0\xbd\xd1\x82\xd0\xb5\xd1\x80\xd0\xb0\xd0\xba\xd1\x82\xd0\xb8\xd0\xb2\xd0\xbd\xd0\xb0\xd1\x8f \xd0\xb7\xd0\xb0\xd0\xb4\xd0\xb0\xd1\x87\xd0\xb0.\xd0\x9a\xd0\xbe\xd0\xb3\xd0\xb4\xd0\xb0 \xd0\xb4\xd0\xb0\xd0\xbd\xd0\xbd\xd1\x8b\xd1\x85 \xd1\x81\xd1\x82\xd0\xb0\xd0\xbd\xd0\xbe\xd0\xb2\xd0\xb8\xd1\x82\xd1\x81\xd1\x8f \xd1\x81\xd0\xbb\xd0\xb8\xd1\x88\xd0\xba\xd0\xbe\xd0\xbc \xd0\xbc\xd0\xbd\xd0\xbe\xd0\xb3\xd0\xbe \xd0\xb8 \xd0\xbe\xd0\xbd\xd0\xb8 \xd0\xbd\xd0\xb5 \xd0\xbf\xd0\xbe\xd0\xbc\xd0\xb5\xd1\x89\xd0\xb0\xd1\x8e\xd1\x82\xd1\x81\xd1\x8f \xd0\xbd\xd0\xb0 \xd0\xbe\xd0\xb4\xd0\xb8\xd0\xbd \xd1\x81\xd0\xb5\xd1\x80\xd0\xb2\xd0\xb5\xd1\x80, \xd0\xb8\xd1\x85 \xd0\xbf\xd1\x80\xd0\xb8\xd1\x85\xd0\xbe\xd0\xb4\xd0\xb8\xd1\x82\xd1\x81\xd1\x8f \xd1\x88\xd0\xb0\xd1\x80\xd0\xb4\xd0\xb8\xd1\x80\xd0\xbe\xd0\xb2\xd0\xb0\xd1\x82\xd1\x8c. \xd0\xa0\xd0\xb0\xd1\x81\xd1\x81\xd0\xbc\xd0\xbe\xd1\x82\xd1\x80\xd0\xb8\xd0\xbc \xd1\x81\xd0\xb8\xd1\x81\xd1\x82\xd0\xb5\xd0\xbc\xd1\x83 \xd1\x85\xd1\x80\xd0\xb0\xd0\xbd\xd0\xb5\xd0\xbd\xd0\xb8\xd1\x8f \xd0\xbf\xd0\xbe\xd1\x81\xd1\x82\xd0\xbe\xd0\xb2 \xd0\xbf\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xb7\xd0\xbe\xd0\xb2\xd0\xb0\xd1\x82\xd0\xb5\xd0\xbb\xd0\xb5\xd0\xb9, \xd0\xba\xd0\xbe\xd1\x82\xd0\xbe\xd1\x80\xd0\xb0\xd1\x8f \xd1\x80\xd0\xb0\xd1\x81\xd0\xbf\xd0\xbe\xd0\xbb\xd0\xbe\xd0\xb6\xd0\xb5\xd0\xbd\xd0\xb0 \xd0\xbd\xd0\xb0 S \xd1\x81\xd0\xb5\xd1\x80\xd0\xb2\xd0\xb5\xd1\x80\xd0\xb0\xd1\x85, \xd0\xbd\xd1\x83\xd0\xbc\xd0\xb5\xd1\x80\xd1\x83\xd0\xb5\xd0\xbc\xd1\x8b\xd1\x85 \xd1\x81 \xd0\xb5\xd0\xb4\xd0\xb8\xd0\xbd\xd0\xb8\xd1\x86\xd1\x8b. \xd0\x9a\xd0\xb0\xd0\xb6\xd0\xb4\xd1\x8b\xd0\xb9 \xd1\x80\xd0\xb0\xd0\xb7 \xd0\xba\xd0\xbe\xd0\xb3\xd0\xb4\xd0\xb0 \xd0\xbf\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xb7\xd0\xbe\xd0\xb2\xd0\xb0\xd1\x82\xd0\xb5\xd0\xbb\xd1\x8c \xd0\xbf\xd0\xb8\xd1\x88\xd0\xb5\xd1\x82 \xd0\xbf\xd0\xbe\xd1\x81\xd1\x82, \xd0\xb5\xd0\xbc\xd1\x83 \xd0\xb2\xd1\x8b\xd0\xb4\xd0\xb0\xd0\xb5\xd1\x82\xd1\x81\xd1\x8f \xd1\x83\xd0\xbd\xd0\xb8\xd0\xba\xd0\xb0\xd0\xbb\xd1\x8c\xd0\xbd\xd1\x8b\xd0\xb9 \xd0\xb8\xd0\xb4\xd0\xb5\xd0\xbd\xd1\x82\xd0\xb8\xd1\x84\xd0\xb8\xd0\xba\xd0\xb0\xd1\x82\xd0\xbe\xd1\x80 \xd0\xb2 \xd0\xbf\xd1\x80\xd0\xb5\xd0\xb4\xd0\xb5\xd0\xbb\xd0\xb0\xd1\x85 \xd0\xbe\xd1\x82 1 \xd0\xb4\xd0\xbe 1018 \xd0\xb8 \xd1\x81\xd0\xbe\xd1\x85\xd1\x80\xd0\xb0\xd0\xbd\xd1\x8f\xd0\xb5\xd1\x82\xd1\x81\xd1\x8f \xd0\xbd\xd0\xb0 \xd1\x81\xd0\xbb\xd1\x83\xd1\x87\xd0\xb0\xd0\xb9\xd0\xbd\xd1\x8b\xd0\xb9 \xd1\x81\xd0\xb5\xd1\x80\xd0\xb2\xd0\xb5\xd1\x80. \xd0\xa7\xd0\xb5\xd0\xbc \xd0\xbf\xd0\xbe\xd0\xb7\xd0\xb6\xd0\xb5 \xd0\xb1\xd1\x8b\xd0\xbb \xd1\x81\xd0\xbe\xd0\xb7\xd0\xb4\xd0\xb0\xd0\xbd \xd0\xbf\xd0\xbe\xd1\x81\xd1\x82, \xd1\x82\xd0\xb5\xd0\xbc \xd0\xb1\xd0\xbe\xd0\xbb\xd1\x8c\xd1\x88\xd0\xb5 \xd0\xb5\xd0\xb3\xd0\xbe id. \xd0\x98\xd0\xbd\xd0\xbe\xd0\xb3\xd0\xb4\xd0\xb0 \xd0\xbf\xd0\xbe\xd1\x81\xd1\x82\xd1\x8b \xd1\x83\xd0\xb4\xd0\xb0\xd0\xbb\xd1\x8f\xd1\x8e\xd1\x82\xd1\x81\xd1\x8f, \xd0\xbf\xd0\xbe\xd1\x8d\xd1\x82\xd0\xbe\xd0\xbc\xd1\x83 \xd0\xbd\xd0\xb0 \xd1\x81\xd0\xb5\xd1\x80\xd0\xb2\xd0\xb5\xd1\x80\xd0\xb0\xd1\x85 \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xb5\xd1\x82 \xd0\xbb\xd0\xb5\xd0\xb6\xd0\xb0\xd1\x82\xd1\x8c \xd1\x81\xd1\x83\xd1\x89\xd0\xb5\xd1\x81\xd1\x82\xd0\xb2\xd0\xb5\xd0\xbd\xd0\xbd\xd0\xbe \xd1\x80\xd0\xb0\xd0\xb7\xd0\xbd\xd0\xbe\xd0\xb5 \xd0\xba\xd0\xbe\xd0\xbb\xd0\xb8\xd1\x87\xd0\xb5\xd1\x81\xd1\x82\xd0\xb2\xd0\xbe \xd0\xbf\xd0\xbe\xd1\x81\xd1\x82\xd0\xbe\xd0\xb2.\xd0\xa0\xd0\xb0\xd1\x81\xd1\x81\xd0\xbc\xd0\xbe\xd1\x82\xd1\x80\xd0\xb8\xd0\xbc \xd0\xb2\xd1\x81\xd0\xb5 \xd0\xbd\xd0\xb5\xd1\x83\xd0\xb4\xd0\xb0\xd0\xbb\xd0\xb5\xd0\xbd\xd0\xbd\xd1\x8b\xd0\xb5 id \xd0\xbf\xd0\xbe\xd1\x81\xd1\x82\xd0\xbe\xd0\xb2 \xd0\xbf\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xb7\xd0\xbe\xd0\xb2\xd0\xb0\xd1\x82\xd0\xb5\xd0\xbb\xd1\x8f \xd0\xb8 \xd0\xbe\xd1\x82\xd1\x81\xd0\xbe\xd1\x80\xd1\x82\xd0\xb8\xd1\x80\xd1\x83\xd0\xb5\xd0\xbc \xd0\xb8\xd1\x85 \xd0\xbf\xd0\xbe \xd0\xb2\xd0\xbe\xd0\xb7\xd1\x80\xd0\xb0\xd1\x81\xd1\x82\xd0\xb0\xd0\xbd\xd0\xb8\xd1\x8e. \xd0\x92\xd0\xb0\xd0\xbc \xd1\x85\xd0\xbe\xd1\x87\xd0\xb5\xd1\x82\xd1\x81\xd1\x8f \xd1\x83\xd0\xb7\xd0\xbd\xd0\xb0\xd1\x82\xd1\x8c k-\xd0\xb9 \xd0\xb8\xd0\xb7 \xd0\xbd\xd0\xb8\xd1\x85. \xd0\x94\xd0\xbb\xd1\x8f \xd1\x8d\xd1\x82\xd0\xbe\xd0\xb3\xd0\xbe \xd0\xb2\xd1\x8b \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xb5\xd1\x82\xd0\xb5 \xd0\xbf\xd0\xbe\xd1\x81\xd0\xbb\xd0\xb0\xd1\x82\xd1\x8c \xd0\xbd\xd0\xb5 \xd0\xb1\xd0\xbe\xd0\xbb\xd0\xb5\xd0\xb5 100 \xd0\xb4\xd0\xbe\xd0\xbf\xd0\xbe\xd0\xbb\xd0\xbd\xd0\xb8\xd1\x82\xd0\xb5\xd0\xbb\xd1\x8c\xd0\xbd\xd1\x8b\xd1\x85 \xd0\xb7\xd0\xb0\xd0\xbf\xd1\x80\xd0\xbe\xd1\x81\xd0\xbe\xd0\xb2. \xd0\x9a\xd0\xb0\xd0\xb6\xd0\xb4\xd1\x8b\xd0\xb9 \xd0\xb7\xd0\xb0\xd0\xbf\xd1\x80\xd0\xbe\xd1\x81 \xd0\xb8\xd0\xbc\xd0\xb5\xd0\xb5\xd1\x82 \xd1\x84\xd0\xbe\xd1\x80\xd0\xbc\xd0\xb0\xd1\x82 \xc2\xab? i j\xc2\xbb. \xd0\x92 \xd0\xbe\xd1\x82\xd0\xb2\xd0\xb5\xd1\x82 \xd0\xb2\xd1\x8b \xd0\xbf\xd0\xbe\xd0\xbb\xd1\x83\xd1\x87\xd0\xb8\xd1\x82\xd0\xb5 \xd0\xb8\xd0\xb4\xd0\xb5\xd0\xbd\xd1\x82\xd0\xb8\xd1\x84\xd0\xb8\xd0\xba\xd0\xb0\xd1\x82\xd0\xbe\xd1\x80 j-\xd0\xb3\xd0\xbe \xd0\xbf\xd0\xbe \xd0\xb2\xd0\xbe\xd0\xb7\xd1\x80\xd0\xb0\xd1\x81\xd1\x82\xd0\xb0\xd0\xbd\xd0\xb8\xd1\x8e \xd0\xbf\xd0\xbe\xd1\x81\xd1\x82\xd0\xb0 \xd0\xbf\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xb7\xd0\xbe\xd0\xb2\xd0\xb0\xd1\x82\xd0\xb5\xd0\xbb\xd1\x8f \xd1\x81\xd1\x80\xd0\xb5\xd0\xb4\xd0\xb8 \xd1\x85\xd1\x80\xd0\xb0\xd0\xbd\xd1\x8f\xd1\x89\xd0\xb8\xd1\x85\xd1\x81\xd1\x8f \xd0\xbd\xd0\xb0 i-\xd0\xbc \xd1\x81\xd0\xb5\xd1\x80\xd0\xb2\xd0\xb5\xd1\x80\xd0\xb5. \xd0\x9a\xd0\xbe\xd0\xb3\xd0\xb4\xd0\xb0 \xd0\xb2\xd1\x8b \xd1\x81\xd1\x87\xd0\xb8\xd1\x82\xd0\xb0\xd0\xb5\xd1\x82\xd0\xb5, \xd1\x87\xd1\x82\xd0\xbe \xd0\xb7\xd0\xbd\xd0\xb0\xd0\xb5\xd1\x82\xd0\xb5 k-\xd0\xb9 \xd0\xbf\xd0\xbe \xd0\xb2\xd0\xbe\xd0\xb7\xd1\x80\xd0\xb0\xd1\x81\xd1\x82\xd0\xb0\xd0\xbd\xd0\xb8\xd1\x8e \xd0\xb8\xd0\xb4\xd0\xb5\xd0\xbd\xd1\x82\xd0\xb8\xd1\x84\xd0\xb8\xd0\xba\xd0\xb0\xd1\x82\xd0\xbe\xd1\x80, \xd0\xb2\xd0\xbc\xd0\xb5\xd1\x81\xd1\x82\xd0\xbe \xd0\xb7\xd0\xb0\xd0\xbf\xd1\x80\xd0\xbe\xd1\x81\xd0\xb0 \xd0\xbd\xd0\xb5\xd0\xbe\xd0\xb1\xd1\x85\xd0\xbe\xd0\xb4\xd0\xb8\xd0\xbc\xd0\xbe \xd0\xb2\xd1\x8b\xd0\xb2\xd0\xb5\xd1\x81\xd1\x82\xd0\xb8 \xd0\xbe\xd1\x82\xd0\xb2\xd0\xb5\xd1\x82 \xd0\xb2 \xd1\x84\xd0\xbe\xd1\x80\xd0\xbc\xd0\xb0\xd1\x82\xd0\xb5 \xc2\xab! id\xc2\xbb." -999
1275E3 "\xd0\x9a\xd0\xbe\xd0\xbd\xd1\x82\xd1\x80\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xb0\xd1\x8f \xd1\x81\xd1\x83\xd0\xbc\xd0\xbc\xd0\xb0" "*special problem" "\xd0\x94\xd0\xb0\xd0\xbd\xd0\xbd\xd1\x8b\xd0\xb5 \xd0\xbf\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xb7\xd0\xbe\xd0\xb2\xd0\xb0\xd1\x82\xd0\xb5\xd0\xbb\xd0\xb5\xd0\xb9 \xd0\x92\xd0\x9a\xd0\xbe\xd0\xbd\xd1\x82\xd0\xb0\xd0\xba\xd1\x82\xd0\xb5 \xd1\x85\xd1\x80\xd0\xb0\xd0\xbd\xd1\x8f\xd1\x82\xd1\x81\xd1\x8f \xd0\xbd\xd0\xb0 \xd0\xb4\xd0\xb5\xd1\x81\xd1\x8f\xd1\x82\xd0\xba\xd0\xb0\xd1\x85 \xd1\x82\xd1\x8b\xd1\x81\xd1\x8f\xd1\x87 \xd1\x81\xd0\xb5\xd1\x80\xd0\xb2\xd0\xb5\xd1\x80\xd0\xbe\xd0\xb2. \xd0\x94\xd0\xbb\xd1\x8f \xd1\x82\xd0\xbe\xd0\xb3\xd0\xbe, \xd1\x87\xd1\x82\xd0\xbe\xd0\xb1\xd1\x8b \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xbd\xd0\xbe \xd0\xb1\xd1\x8b\xd0\xbb\xd0\xbe \xd0\xbe\xd0\xbf\xd1\x80\xd0\xb5\xd0\xb4\xd0\xb5\xd0\xbb\xd1\x8f\xd1\x82\xd1\x8c \xd0\xbe\xd1\x88\xd0\xb8\xd0\xb1\xd0\xba\xd0\xb8 \xd0\xbf\xd1\x80\xd0\xb8 \xd0\xb7\xd0\xb0\xd0\xbf\xd0\xb8\xd1\x81\xd0\xb8 \xd0\xb4\xd0\xb0\xd0\xbd\xd0\xbd\xd1\x8b\xd1\x85 \xd0\xbd\xd0\xb0 \xd0\xb4\xd0\xb8\xd1\x81\xd0\xba, \xd0\xbd\xd0\xb0 \xd0\xb4\xd0\xb8\xd1\x81\xd0\xba \xd1\x80\xd0\xb5\xd0\xb3\xd1\x83\xd0\xbb\xd1\x8f\xd1\x80\xd0\xbd\xd0\xbe \xd0\xb7\xd0\xb0\xd0\xbf\xd0\xb8\xd1\x81\xd1\x8b\xd0\xb2\xd0\xb0\xd1\x8e\xd1\x82\xd1\x81\xd1\x8f \xd1\x82\xd0\xb5\xd0\xba\xd1\x83\xd1\x89\xd0\xb8\xd0\xb5 \xd0\xba\xd0\xbe\xd0\xbd\xd1\x82\xd1\x80\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xbd\xd1\x8b\xd0\xb5 \xd1\x81\xd1\x83\xd0\xbc\xd0\xbc\xd1\x8b CRC32 (Wiki, IEEE 802-3). \xd0\x91\xd0\xbb\xd0\xb0\xd0\xb3\xd0\xbe\xd0\xb4\xd0\xb0\xd1\x80\xd1\x8f \xd1\x8d\xd1\x82\xd0\xbe\xd0\xbc\xd1\x83, \xd0\xbf\xd1\x80\xd0\xb8 \xd1\x87\xd1\x82\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb8 \xd0\xb4\xd0\xb0\xd0\xbd\xd0\xbd\xd1\x8b\xd1\x85 \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xbd\xd0\xbe \xd0\xb7\xd0\xb0\xd0\xbd\xd0\xbe\xd0\xb2\xd0\xbe \xd0\xb2\xd1\x8b\xd1\x87\xd0\xb8\xd1\x81\xd0\xbb\xd0\xb8\xd1\x82\xd1\x8c \xd0\xba\xd0\xbe\xd0\xbd\xd1\x82\xd1\x80\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xbd\xd1\x83\xd1\x8e \xd1\x81\xd1\x83\xd0\xbc\xd0\xbc\xd1\x83 \xd0\xb8 \xd0\xbf\xd1\x80\xd0\xbe\xd0\xb2\xd0\xb5\xd1\x80\xd0\xb8\xd1\x82\xd1\x8c, \xd1\x87\xd1\x82\xd0\xbe \xd0\xb4\xd0\xb0\xd0\xbd\xd0\xbd\xd1\x8b\xd0\xb5 \xd0\xb8 \xd0\xba\xd0\xbe\xd0\xbd\xd1\x82\xd1\x80\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xb0\xd1\x8f \xd1\x81\xd1\x83\xd0\xbc\xd0\xbc\xd0\xb0 \xd0\xb7\xd0\xb0\xd0\xbf\xd0\xb8\xd1\x81\xd0\xb0\xd0\xbd\xd1\x8b \xd0\xba\xd0\xbe\xd1\x80\xd1\x80\xd0\xb5\xd0\xba\xd1\x82\xd0\xbd\xd0\xbe. \xd0\xa0\xd0\xb0\xd0\xb7\xd1\x83\xd0\xbc\xd0\xb5\xd0\xb5\xd1\x82\xd1\x81\xd1\x8f, \xd0\xbf\xd1\x80\xd0\xbe\xd0\xb2\xd0\xb5\xd1\x80\xd0\xba\xd0\xb8 \xd0\xbd\xd0\xb0 \xd1\x81\xd0\xbe\xd0\xb2\xd0\xbf\xd0\xb0\xd0\xb4\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb5 \xd0\xba\xd0\xbe\xd0\xbd\xd1\x82\xd1\x80\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe\xd0\xb9 \xd1\x81\xd1\x83\xd0\xbc\xd0\xbc\xd1\x8b \xd0\xb2\xd1\x81\xd1\x82\xd1\x80\xd0\xbe\xd0\xb5\xd0\xbd\xd1\x8b \xd0\xb2 \xd0\xb1\xd0\xbe\xd0\xbb\xd1\x8c\xd1\x88\xd0\xb8\xd0\xbd\xd1\x81\xd1\x82\xd0\xb2\xd0\xbe \xd1\x81\xd0\xb5\xd1\x80\xd0\xb2\xd0\xb8\xd1\x81\xd0\xbe\xd0\xb2 \xd0\x92\xd0\x9a\xd0\xbe\xd0\xbd\xd1\x82\xd0\xb0\xd0\xba\xd1\x82\xd0\xb5. \xd0\x9d\xd0\xbe \xd0\xba\xd0\xb0\xd0\xba-\xd1\x82\xd0\xbe \xd1\x80\xd0\xb0\xd0\xb7 \xd0\xbe\xd0\xba\xd0\xb0\xd0\xb7\xd0\xb0\xd0\xbb\xd0\xbe\xd1\x81\xd1\x8c, \xd1\x87\xd1\x82\xd0\xbe \xd0\xb2 \xd0\xbe\xd0\xb4\xd0\xbd\xd0\xbe\xd0\xbc \xd1\x81\xd0\xb5\xd0\xb3\xd0\xbc\xd0\xb5\xd0\xbd\xd1\x82\xd0\xb5 \xd0\xb4\xd0\xb0\xd0\xbd\xd0\xbd\xd1\x8b\xd1\x85 \xd0\xbd\xd1\x83\xd0\xb6\xd0\xbd\xd0\xbe \xd0\xb8\xd0\xb7\xd0\xbc\xd0\xb5\xd0\xbd\xd0\xb8\xd1\x82\xd1\x8c \xd0\xb7\xd0\xbd\xd0\xb0\xd1\x87\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb5 \xd1\x87\xd0\xb5\xd1\x82\xd1\x8b\xd1\x80\xd0\xb5\xd1\x85 \xd0\xbf\xd0\xbe\xd1\x81\xd0\xbb\xd0\xb5\xd0\xb4\xd0\xbe\xd0\xb2\xd0\xb0\xd1\x82\xd0\xb5\xd0\xbb\xd1\x8c\xd0\xbd\xd1\x8b\xd1\x85 \xd0\xb1\xd0\xb0\xd0\xb9\xd1\x82 \xd0\xbd\xd0\xb0 \xd0\xbd\xd0\xbe\xd0\xb2\xd0\xbe\xd0\xb5Â \xe2\x80\x94 \xd0\xbd\xd1\x83\xd0\xb6\xd0\xbd\xd0\xbe \xd0\xb7\xd0\xb0\xd0\xbc\xd0\xb5\xd0\xbd\xd0\xb8\xd1\x82\xd1\x8c \xd0\xb7\xd0\xbd\xd0\xb0\xd1\x87\xd0\xb5\xd0\xbd\xd0\xb8\xd1\x8f \xd0\xbf\xd0\xbe\xd1\x81\xd0\xbb\xd0\xb5\xd0\xb4\xd0\xbe\xd0\xb2\xd0\xb0\xd1\x82\xd0\xb5\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe\xd1\x81\xd1\x82\xd0\xb8 ai,ai+1,ai+2,ai+3 \xd0\xbd\xd0\xb0 x0,x1,x2,x3. \xd0\x9f\xd1\x80\xd0\xb8 \xd1\x8d\xd1\x82\xd0\xbe\xd0\xbc, \xd0\xbd\xd1\x83\xd0\xb6\xd0\xbd\xd0\xbe \xd1\x87\xd1\x82\xd0\xbe\xd0\xb1\xd1\x8b \xd0\xb7\xd0\xbd\xd0\xb0\xd1\x87\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb5 \xd0\xba\xd0\xbe\xd0\xbd\xd1\x82\xd1\x80\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe\xd0\xb9 \xd1\x81\xd1\x83\xd0\xbc\xd0\xbc\xd1\x8b CRC32 \xd0\xbe\xd1\x81\xd1\x82\xd0\xb0\xd0\xbb\xd0\xbe\xd1\x81\xd1\x8c \xd0\xbf\xd1\x80\xd0\xb5\xd0\xb6\xd0\xbd\xd0\xb8\xd0\xbc. \xd0\x9a\xd0\xbe\xd0\xbd\xd0\xb5\xd1\x87\xd0\xbd\xd0\xbe, \xd0\xbf\xd1\x80\xd0\xb8 \xd0\xb8\xd0\xb7\xd0\xbc\xd0\xb5\xd0\xbd\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb8 \xd0\xbf\xd0\xbe\xd1\x81\xd0\xbb\xd0\xb5\xd0\xb4\xd0\xbe\xd0\xb2\xd0\xb0\xd1\x82\xd0\xb5\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe\xd1\x81\xd1\x82\xd0\xb8 \xd0\xb5\xd0\xb5 \xd0\xba\xd0\xbe\xd0\xbd\xd1\x82\xd1\x80\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xb0\xd1\x8f \xd1\x81\xd1\x83\xd0\xbc\xd0\xbc\xd0\xb0 \xd0\xb8\xd0\xb7\xd0\xbc\xd0\xb5\xd0\xbd\xd0\xb8\xd1\x82\xd1\x81\xd1\x8f, \xd0\xbf\xd0\xbe\xd1\x8d\xd1\x82\xd0\xbe\xd0\xbc\xd1\x83 \xd0\xba\xd1\x80\xd0\xbe\xd0\xbc\xd0\xb5 \xd0\xb8\xd0\xb7\xd0\xbc\xd0\xb5\xd0\xbd\xd0\xb5\xd0\xbd\xd0\xb8\xd1\x8f \xd1\x8d\xd1\x82\xd0\xb8\xd1\x85 \xd1\x87\xd0\xb5\xd1\x82\xd1\x8b\xd1\x80\xd0\xb5\xd1\x85 \xd0\xb1\xd0\xb0\xd0\xb9\xd1\x82 \xd0\xbd\xd0\xb0 \xd0\xbd\xd0\xbe\xd0\xb2\xd0\xbe\xd0\xb5 \xd0\xb7\xd0\xbd\xd0\xb0\xd1\x87\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb5, \xd0\xb1\xd1\x8b\xd0\xbb\xd0\xb8 \xd0\xb2\xd1\x8b\xd0\xb1\xd1\x80\xd0\xb0\xd0\xbd\xd1\x8b \xd1\x87\xd0\xb5\xd1\x82\xd1\x8b\xd1\x80\xd0\xb5 \xd0\xb1\xd0\xb0\xd0\xb9\xd1\x82\xd0\xb0 aj,aj+1,aj+2,aj+3, \xd0\xba\xd0\xbe\xd1\x82\xd0\xbe\xd1\x80\xd1\x8b\xd0\xbc \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xbd\xd0\xbe \xd0\xbd\xd0\xb0\xd0\xb7\xd0\xbd\xd0\xb0\xd1\x87\xd0\xb8\xd1\x82\xd1\x8c \xd0\xbb\xd1\x8e\xd0\xb1\xd0\xbe\xd0\xb5 \xd0\xb7\xd0\xbd\xd0\xb0\xd1\x87\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb5. \xd0\x92\xd0\xb0\xd1\x88\xd0\xb0 \xd0\xb7\xd0\xb0\xd0\xb4\xd0\xb0\xd1\x87\xd0\xb0 \xd0\xb2\xd1\x8b\xd0\xb1\xd1\x80\xd0\xb0\xd1\x82\xd1\x8c \xd0\xb8\xd0\xbc \xd0\xbd\xd0\xbe\xd0\xb2\xd1\x8b\xd0\xb5 \xd0\xb7\xd0\xbd\xd0\xb0\xd1\x87\xd0\xb5\xd0\xbd\xd0\xb8\xd1\x8f \xd1\x82\xd0\xb0\xd0\xba, \xd1\x87\xd1\x82\xd0\xbe\xd0\xb1\xd1\x8b CRC32 \xd0\xb4\xd0\xb0\xd0\xbd\xd0\xbd\xd0\xbe\xd0\xb9 \xd0\xbf\xd0\xbe\xd1\x81\xd0\xbb\xd0\xb5\xd0\xb4\xd0\xbe\xd0\xb2\xd0\xb0\xd1\x82\xd0\xb5\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe\xd1\x81\xd1\x82\xd0\xb8 \xd0\xbd\xd0\xb5 \xd0\xb8\xd0\xb7\xd0\xbc\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xbb\xd1\x81\xd1\x8f, \xd0\xb8\xd0\xbb\xd0\xb8 \xd0\xbe\xd0\xbf\xd1\x80\xd0\xb5\xd0\xb4\xd0\xb5\xd0\xbb\xd0\xb8\xd1\x82\xd1\x8c, \xd1\x87\xd1\x82\xd0\xbe \xd1\x8d\xd1\x82\xd0\xbe \xd0\xbd\xd0\xb5\xd0\xb2\xd0\xbe\xd0\xb7\xd0\xbc\xd0\xbe\xd0\xb6\xd0\xbd\xd0\xbe. \xd0\x9f\xd0\xbe\xd1\x81\xd0\xba\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xba\xd1\x83 \xd0\xb8\xd0\xb7\xd0\xbc\xd0\xb5\xd0\xbd\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb5 \xd0\xb4\xd0\xb0\xd0\xbd\xd0\xbd\xd1\x8b\xd1\x85Â \xe2\x80\x94 \xd0\xbe\xd0\xbf\xd0\xb5\xd1\x80\xd0\xb0\xd1\x86\xd0\xb8\xd1\x8f \xd1\x81\xd0\xb5\xd1\x80\xd1\x8c\xd0\xb5\xd0\xb7\xd0\xbd\xd0\xb0\xd1\x8f, \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb5\xd0\xb4 \xd1\x81\xd0\xb0\xd0\xbc\xd0\xb8\xd0\xbc \xd0\xb8\xd0\xb7\xd0\xbc\xd0\xb5\xd0\xbd\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb5\xd0\xbc \xd0\xbd\xd1\x83\xd0\xb6\xd0\xbd\xd0\xbe \xd0\xbe\xd0\xbf\xd1\x80\xd0\xb5\xd0\xb4\xd0\xb5\xd0\xbb\xd0\xb8\xd1\x82\xd1\x8c, \xd0\xba\xd0\xb0\xd0\xba \xd0\xb8\xd0\xb7\xd0\xbc\xd0\xb5\xd0\xbd\xd0\xb8\xd1\x82\xd1\x81\xd1\x8f \xd0\xbf\xd0\xbe\xd1\x81\xd0\xbb\xd0\xb5\xd0\xb4\xd0\xbe\xd0\xb2\xd0\xb0\xd1\x82\xd0\xb5\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe\xd1\x81\xd1\x82\xd1\x8c \xd0\xb4\xd0\xbb\xd1\x8f q \xd0\xbd\xd0\xb5\xd0\xb7\xd0\xb0\xd0\xb2\xd0\xb8\xd1\x81\xd0\xb8\xd0\xbc\xd1\x8b\xd1\x85 \xd1\x82\xd0\xb5\xd1\x81\xd1\x82\xd0\xbe\xd0\xb2\xd1\x8b\xd1\x85 \xd1\x81\xd0\xbb\xd1\x83\xd1\x87\xd0\xb0\xd0\xb5\xd0\xb2." -999
1275E2 "\xd0\x9a\xd0\xbe\xd0\xbd\xd1\x82\xd1\x80\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xb0\xd1\x8f \xd1\x81\xd1\x83\xd0\xbc\xd0\xbc\xd0\xb0" "*special problem" "\xd0\x94\xd0\xb0\xd0\xbd\xd0\xbd\xd1\x8b\xd0\xb5 \xd0\xbf\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xb7\xd0\xbe\xd0\xb2\xd0\xb0\xd1\x82\xd0\xb5\xd0\xbb\xd0\xb5\xd0\xb9 \xd0\x92\xd0\x9a\xd0\xbe\xd0\xbd\xd1\x82\xd0\xb0\xd0\xba\xd1\x82\xd0\xb5 \xd1\x85\xd1\x80\xd0\xb0\xd0\xbd\xd1\x8f\xd1\x82\xd1\x81\xd1\x8f \xd0\xbd\xd0\xb0 \xd0\xb4\xd0\xb5\xd1\x81\xd1\x8f\xd1\x82\xd0\xba\xd0\xb0\xd1\x85 \xd1\x82\xd1\x8b\xd1\x81\xd1\x8f\xd1\x87 \xd1\x81\xd0\xb5\xd1\x80\xd0\xb2\xd0\xb5\xd1\x80\xd0\xbe\xd0\xb2. \xd0\x94\xd0\xbb\xd1\x8f \xd1\x82\xd0\xbe\xd0\xb3\xd0\xbe, \xd1\x87\xd1\x82\xd0\xbe\xd0\xb1\xd1\x8b \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xbd\xd0\xbe \xd0\xb1\xd1\x8b\xd0\xbb\xd0\xbe \xd0\xbe\xd0\xbf\xd1\x80\xd0\xb5\xd0\xb4\xd0\xb5\xd0\xbb\xd1\x8f\xd1\x82\xd1\x8c \xd0\xbe\xd1\x88\xd0\xb8\xd0\xb1\xd0\xba\xd0\xb8 \xd0\xbf\xd1\x80\xd0\xb8 \xd0\xb7\xd0\xb0\xd0\xbf\xd0\xb8\xd1\x81\xd0\xb8 \xd0\xb4\xd0\xb0\xd0\xbd\xd0\xbd\xd1\x8b\xd1\x85 \xd0\xbd\xd0\xb0 \xd0\xb4\xd0\xb8\xd1\x81\xd0\xba, \xd0\xbd\xd0\xb0 \xd0\xb4\xd0\xb8\xd1\x81\xd0\xba \xd1\x80\xd0\xb5\xd0\xb3\xd1\x83\xd0\xbb\xd1\x8f\xd1\x80\xd0\xbd\xd0\xbe \xd0\xb7\xd0\xb0\xd0\xbf\xd0\xb8\xd1\x81\xd1\x8b\xd0\xb2\xd0\xb0\xd1\x8e\xd1\x82\xd1\x81\xd1\x8f \xd1\x82\xd0\xb5\xd0\xba\xd1\x83\xd1\x89\xd0\xb8\xd0\xb5 \xd0\xba\xd0\xbe\xd0\xbd\xd1\x82\xd1\x80\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xbd\xd1\x8b\xd0\xb5 \xd1\x81\xd1\x83\xd0\xbc\xd0\xbc\xd1\x8b CRC32 (Wiki, IEEE 802-3). \xd0\x91\xd0\xbb\xd0\xb0\xd0\xb3\xd0\xbe\xd0\xb4\xd0\xb0\xd1\x80\xd1\x8f \xd1\x8d\xd1\x82\xd0\xbe\xd0\xbc\xd1\x83, \xd0\xbf\xd1\x80\xd0\xb8 \xd1\x87\xd1\x82\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb8 \xd0\xb4\xd0\xb0\xd0\xbd\xd0\xbd\xd1\x8b\xd1\x85 \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xbd\xd0\xbe \xd0\xb7\xd0\xb0\xd0\xbd\xd0\xbe\xd0\xb2\xd0\xbe \xd0\xb2\xd1\x8b\xd1\x87\xd0\xb8\xd1\x81\xd0\xbb\xd0\xb8\xd1\x82\xd1\x8c \xd0\xba\xd0\xbe\xd0\xbd\xd1\x82\xd1\x80\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xbd\xd1\x83\xd1\x8e \xd1\x81\xd1\x83\xd0\xbc\xd0\xbc\xd1\x83 \xd0\xb8 \xd0\xbf\xd1\x80\xd0\xbe\xd0\xb2\xd0\xb5\xd1\x80\xd0\xb8\xd1\x82\xd1\x8c, \xd1\x87\xd1\x82\xd0\xbe \xd0\xb4\xd0\xb0\xd0\xbd\xd0\xbd\xd1\x8b\xd0\xb5 \xd0\xb8 \xd0\xba\xd0\xbe\xd0\xbd\xd1\x82\xd1\x80\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xb0\xd1\x8f \xd1\x81\xd1\x83\xd0\xbc\xd0\xbc\xd0\xb0 \xd0\xb7\xd0\xb0\xd0\xbf\xd0\xb8\xd1\x81\xd0\xb0\xd0\xbd\xd1\x8b \xd0\xba\xd0\xbe\xd1\x80\xd1\x80\xd0\xb5\xd0\xba\xd1\x82\xd0\xbd\xd0\xbe. \xd0\xa0\xd0\xb0\xd0\xb7\xd1\x83\xd0\xbc\xd0\xb5\xd0\xb5\xd1\x82\xd1\x81\xd1\x8f, \xd0\xbf\xd1\x80\xd0\xbe\xd0\xb2\xd0\xb5\xd1\x80\xd0\xba\xd0\xb8 \xd0\xbd\xd0\xb0 \xd1\x81\xd0\xbe\xd0\xb2\xd0\xbf\xd0\xb0\xd0\xb4\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb5 \xd0\xba\xd0\xbe\xd0\xbd\xd1\x82\xd1\x80\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe\xd0\xb9 \xd1\x81\xd1\x83\xd0\xbc\xd0\xbc\xd1\x8b \xd0\xb2\xd1\x81\xd1\x82\xd1\x80\xd0\xbe\xd0\xb5\xd0\xbd\xd1\x8b \xd0\xb2 \xd0\xb1\xd0\xbe\xd0\xbb\xd1\x8c\xd1\x88\xd0\xb8\xd0\xbd\xd1\x81\xd1\x82\xd0\xb2\xd0\xbe \xd1\x81\xd0\xb5\xd1\x80\xd0\xb2\xd0\xb8\xd1\x81\xd0\xbe\xd0\xb2 \xd0\x92\xd0\x9a\xd0\xbe\xd0\xbd\xd1\x82\xd0\xb0\xd0\xba\xd1\x82\xd0\xb5. \xd0\x9d\xd0\xbe \xd0\xba\xd0\xb0\xd0\xba-\xd1\x82\xd0\xbe \xd1\x80\xd0\xb0\xd0\xb7 \xd0\xbe\xd0\xba\xd0\xb0\xd0\xb7\xd0\xb0\xd0\xbb\xd0\xbe\xd1\x81\xd1\x8c, \xd1\x87\xd1\x82\xd0\xbe \xd0\xb2 \xd0\xbe\xd0\xb4\xd0\xbd\xd0\xbe\xd0\xbc \xd1\x81\xd0\xb5\xd0\xb3\xd0\xbc\xd0\xb5\xd0\xbd\xd1\x82\xd0\xb5 \xd0\xb4\xd0\xb0\xd0\xbd\xd0\xbd\xd1\x8b\xd1\x85 \xd0\xbd\xd1\x83\xd0\xb6\xd0\xbd\xd0\xbe \xd0\xb8\xd0\xb7\xd0\xbc\xd0\xb5\xd0\xbd\xd0\xb8\xd1\x82\xd1\x8c \xd0\xb7\xd0\xbd\xd0\xb0\xd1\x87\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb5 \xd1\x87\xd0\xb5\xd1\x82\xd1\x8b\xd1\x80\xd0\xb5\xd1\x85 \xd0\xbf\xd0\xbe\xd1\x81\xd0\xbb\xd0\xb5\xd0\xb4\xd0\xbe\xd0\xb2\xd0\xb0\xd1\x82\xd0\xb5\xd0\xbb\xd1\x8c\xd0\xbd\xd1\x8b\xd1\x85 \xd0\xb1\xd0\xb0\xd0\xb9\xd1\x82 \xd0\xbd\xd0\xb0 \xd0\xbd\xd0\xbe\xd0\xb2\xd0\xbe\xd0\xb5Â \xe2\x80\x94 \xd0\xbd\xd1\x83\xd0\xb6\xd0\xbd\xd0\xbe \xd0\xb7\xd0\xb0\xd0\xbc\xd0\xb5\xd0\xbd\xd0\xb8\xd1\x82\xd1\x8c \xd0\xb7\xd0\xbd\xd0\xb0\xd1\x87\xd0\xb5\xd0\xbd\xd0\xb8\xd1\x8f \xd0\xbf\xd0\xbe\xd1\x81\xd0\xbb\xd0\xb5\xd0\xb4\xd0\xbe\xd0\xb2\xd0\xb0\xd1\x82\xd0\xb5\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe\xd1\x81\xd1\x82\xd0\xb8 ai,ai+1,ai+2,ai+3 \xd0\xbd\xd0\xb0 x0,x1,x2,x3. \xd0\x9f\xd1\x80\xd0\xb8 \xd1\x8d\xd1\x82\xd0\xbe\xd0\xbc, \xd0\xbd\xd1\x83\xd0\xb6\xd0\xbd\xd0\xbe \xd1\x87\xd1\x82\xd0\xbe\xd0\xb1\xd1\x8b \xd0\xb7\xd0\xbd\xd0\xb0\xd1\x87\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb5 \xd0\xba\xd0\xbe\xd0\xbd\xd1\x82\xd1\x80\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe\xd0\xb9 \xd1\x81\xd1\x83\xd0\xbc\xd0\xbc\xd1\x8b CRC32 \xd0\xbe\xd1\x81\xd1\x82\xd0\xb0\xd0\xbb\xd0\xbe\xd1\x81\xd1\x8c \xd0\xbf\xd1\x80\xd0\xb5\xd0\xb6\xd0\xbd\xd0\xb8\xd0\xbc. \xd0\x9a\xd0\xbe\xd0\xbd\xd0\xb5\xd1\x87\xd0\xbd\xd0\xbe, \xd0\xbf\xd1\x80\xd0\xb8 \xd0\xb8\xd0\xb7\xd0\xbc\xd0\xb5\xd0\xbd\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb8 \xd0\xbf\xd0\xbe\xd1\x81\xd0\xbb\xd0\xb5\xd0\xb4\xd0\xbe\xd0\xb2\xd0\xb0\xd1\x82\xd0\xb5\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe\xd1\x81\xd1\x82\xd0\xb8 \xd0\xb5\xd0\xb5 \xd0\xba\xd0\xbe\xd0\xbd\xd1\x82\xd1\x80\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xb0\xd1\x8f \xd1\x81\xd1\x83\xd0\xbc\xd0\xbc\xd0\xb0 \xd0\xb8\xd0\xb7\xd0\xbc\xd0\xb5\xd0\xbd\xd0\xb8\xd1\x82\xd1\x81\xd1\x8f, \xd0\xbf\xd0\xbe\xd1\x8d\xd1\x82\xd0\xbe\xd0\xbc\xd1\x83 \xd0\xba\xd1\x80\xd0\xbe\xd0\xbc\xd0\xb5 \xd0\xb8\xd0\xb7\xd0\xbc\xd0\xb5\xd0\xbd\xd0\xb5\xd0\xbd\xd0\xb8\xd1\x8f \xd1\x8d\xd1\x82\xd0\xb8\xd1\x85 \xd1\x87\xd0\xb5\xd1\x82\xd1\x8b\xd1\x80\xd0\xb5\xd1\x85 \xd0\xb1\xd0\xb0\xd0\xb9\xd1\x82 \xd0\xbd\xd0\xb0 \xd0\xbd\xd0\xbe\xd0\xb2\xd0\xbe\xd0\xb5 \xd0\xb7\xd0\xbd\xd0\xb0\xd1\x87\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb5, \xd0\xb1\xd1\x8b\xd0\xbb\xd0\xb8 \xd0\xb2\xd1\x8b\xd0\xb1\xd1\x80\xd0\xb0\xd0\xbd\xd1\x8b \xd1\x87\xd0\xb5\xd1\x82\xd1\x8b\xd1\x80\xd0\xb5 \xd0\xb1\xd0\xb0\xd0\xb9\xd1\x82\xd0\xb0 aj,aj+1,aj+2,aj+3, \xd0\xba\xd0\xbe\xd1\x82\xd0\xbe\xd1\x80\xd1\x8b\xd0\xbc \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xbd\xd0\xbe \xd0\xbd\xd0\xb0\xd0\xb7\xd0\xbd\xd0\xb0\xd1\x87\xd0\xb8\xd1\x82\xd1\x8c \xd0\xbb\xd1\x8e\xd0\xb1\xd0\xbe\xd0\xb5 \xd0\xb7\xd0\xbd\xd0\xb0\xd1\x87\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb5. \xd0\x92\xd0\xb0\xd1\x88\xd0\xb0 \xd0\xb7\xd0\xb0\xd0\xb4\xd0\xb0\xd1\x87\xd0\xb0 \xd0\xb2\xd1\x8b\xd0\xb1\xd1\x80\xd0\xb0\xd1\x82\xd1\x8c \xd0\xb8\xd0\xbc \xd0\xbd\xd0\xbe\xd0\xb2\xd1\x8b\xd0\xb5 \xd0\xb7\xd0\xbd\xd0\xb0\xd1\x87\xd0\xb5\xd0\xbd\xd0\xb8\xd1\x8f \xd1\x82\xd0\xb0\xd0\xba, \xd1\x87\xd1\x82\xd0\xbe\xd0\xb1\xd1\x8b CRC32 \xd0\xb4\xd0\xb0\xd0\xbd\xd0\xbd\xd0\xbe\xd0\xb9 \xd0\xbf\xd0\xbe\xd1\x81\xd0\xbb\xd0\xb5\xd0\xb4\xd0\xbe\xd0\xb2\xd0\xb0\xd1\x82\xd0\xb5\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe\xd1\x81\xd1\x82\xd0\xb8 \xd0\xbd\xd0\xb5 \xd0\xb8\xd0\xb7\xd0\xbc\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xbb\xd1\x81\xd1\x8f, \xd0\xb8\xd0\xbb\xd0\xb8 \xd0\xbe\xd0\xbf\xd1\x80\xd0\xb5\xd0\xb4\xd0\xb5\xd0\xbb\xd0\xb8\xd1\x82\xd1\x8c, \xd1\x87\xd1\x82\xd0\xbe \xd1\x8d\xd1\x82\xd0\xbe \xd0\xbd\xd0\xb5\xd0\xb2\xd0\xbe\xd0\xb7\xd0\xbc\xd0\xbe\xd0\xb6\xd0\xbd\xd0\xbe. \xd0\x9f\xd0\xbe\xd1\x81\xd0\xba\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xba\xd1\x83 \xd0\xb8\xd0\xb7\xd0\xbc\xd0\xb5\xd0\xbd\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb5 \xd0\xb4\xd0\xb0\xd0\xbd\xd0\xbd\xd1\x8b\xd1\x85Â \xe2\x80\x94 \xd0\xbe\xd0\xbf\xd0\xb5\xd1\x80\xd0\xb0\xd1\x86\xd0\xb8\xd1\x8f \xd1\x81\xd0\xb5\xd1\x80\xd1\x8c\xd0\xb5\xd0\xb7\xd0\xbd\xd0\xb0\xd1\x8f, \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb5\xd0\xb4 \xd1\x81\xd0\xb0\xd0\xbc\xd0\xb8\xd0\xbc \xd0\xb8\xd0\xb7\xd0\xbc\xd0\xb5\xd0\xbd\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb5\xd0\xbc \xd0\xbd\xd1\x83\xd0\xb6\xd0\xbd\xd0\xbe \xd0\xbe\xd0\xbf\xd1\x80\xd0\xb5\xd0\xb4\xd0\xb5\xd0\xbb\xd0\xb8\xd1\x82\xd1\x8c, \xd0\xba\xd0\xb0\xd0\xba \xd0\xb8\xd0\xb7\xd0\xbc\xd0\xb5\xd0\xbd\xd0\xb8\xd1\x82\xd1\x81\xd1\x8f \xd0\xbf\xd0\xbe\xd1\x81\xd0\xbb\xd0\xb5\xd0\xb4\xd0\xbe\xd0\xb2\xd0\xb0\xd1\x82\xd0\xb5\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe\xd1\x81\xd1\x82\xd1\x8c \xd0\xb4\xd0\xbb\xd1\x8f q \xd0\xbd\xd0\xb5\xd0\xb7\xd0\xb0\xd0\xb2\xd0\xb8\xd1\x81\xd0\xb8\xd0\xbc\xd1\x8b\xd1\x85 \xd1\x82\xd0\xb5\xd1\x81\xd1\x82\xd0\xbe\xd0\xb2\xd1\x8b\xd1\x85 \xd1\x81\xd0\xbb\xd1\x83\xd1\x87\xd0\xb0\xd0\xb5\xd0\xb2.\xd0\x9e\xd0\xb1\xd1\x80\xd0\xb0\xd1\x82\xd0\xb8\xd1\x82\xd0\xb5 \xd0\xb2\xd0\xbd\xd0\xb8\xd0\xbc\xd0\xb0\xd0\xbd\xd0\xb8\xd0\xb5, \xd1\x87\xd1\x82\xd0\xbe \xd0\xb2 \xd1\x8d\xd1\x82\xd0\xbe\xd0\xb9 \xd0\xb2\xd0\xb5\xd1\x80\xd1\x81\xd0\xb8\xd0\xb8 \xd0\xb7\xd0\xb0\xd0\xb4\xd0\xb0\xd1\x87\xd0\xb8 \xd0\xb5\xd1\x81\xd1\x82\xd1\x8c \xd0\xb2\xd1\x81\xd0\xb5\xd0\xb3\xd0\xbe \xd0\xbe\xd0\xb4\xd0\xb8\xd0\xbd \xd1\x82\xd0\xb5\xd1\x81\xd1\x82 \xd1\x81 n=50000,q=8, \xd0\xba\xd0\xbe\xd1\x82\xd0\xbe\xd1\x80\xd1\x8b\xd0\xb9 \xd0\xb2\xd1\x8b \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xb5\xd1\x82\xd0\xb5 \xd1\x81\xd0\xba\xd0\xb0\xd1\x87\xd0\xb0\xd1\x82\xd1\x8c \xd0\xbf\xd0\xbe \xd1\x8d\xd1\x82\xd0\xbe\xd0\xb9 \xd1\x81\xd1\x81\xd1\x8b\xd0\xbb\xd0\xba\xd0\xb5. \xd0\x92\xd0\xb0\xd1\x88\xd0\xb5 \xd1\x80\xd0\xb5\xd1\x88\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb5 \xd0\xbd\xd0\xb5 \xd0\xbe\xd0\xb1\xd1\x8f\xd0\xb7\xd0\xb0\xd0\xbd\xd0\xbe \xd0\xbf\xd1\x80\xd0\xbe\xd1\x85\xd0\xbe\xd0\xb4\xd0\xb8\xd1\x82\xd1\x8c \xd1\x82\xd0\xb5\xd1\x81\xd1\x82\xd1\x8b \xd0\xb8\xd0\xb7 \xd1\x83\xd1\x81\xd0\xbb\xd0\xbe\xd0\xb2\xd0\xb8\xd1\x8f, \xd0\xb8 \xd0\xbd\xd0\xb5 \xd0\xb1\xd1\x83\xd0\xb4\xd0\xb5\xd1\x82 \xd0\xbd\xd0\xb0 \xd0\xbd\xd0\xb8\xd1\x85 \xd0\xbf\xd1\x80\xd0\xbe\xd1\x82\xd0\xb5\xd1\x81\xd1\x82\xd0\xb8\xd1\x80\xd0\xbe\xd0\xb2\xd0\xb0\xd0\xbd\xd0\xbe. \xd0\x95\xd1\x81\xd0\xbb\xd0\xb8 \xd0\xb2\xd1\x8b \xd1\x85\xd0\xbe\xd1\x82\xd0\xb8\xd1\x82\xd0\xb5 \xd0\xbf\xd1\x80\xd0\xbe\xd0\xb2\xd0\xb5\xd1\x80\xd0\xb8\xd1\x82\xd1\x8c \xd0\xb2\xd0\xb0\xd1\x88\xd0\xb5 \xd1\x80\xd0\xb5\xd1\x88\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb5 \xd0\xbd\xd0\xb0 \xd1\x82\xd0\xb5\xd1\x81\xd1\x82\xd0\xb0\xd1\x85 \xd0\xb8\xd0\xb7 \xd1\x83\xd1\x81\xd0\xbb\xd0\xbe\xd0\xb2\xd0\xb8\xd1\x8f, \xd0\xbe\xd1\x82\xd0\xbf\xd1\x80\xd0\xb0\xd0\xb2\xd0\xbb\xd1\x8f\xd0\xb9\xd1\x82\xd0\xb5 \xd0\xb5\xd0\xb3\xd0\xbe \xd0\xb2 \xd0\xb7\xd0\xb0\xd0\xb4\xd0\xb0\xd1\x87\xd1\x83 E3, \xd0\xb3\xd0\xb4\xd0\xb5 \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb2\xd1\x8b\xd0\xb5 \xd0\xb4\xd0\xb2\xd0\xb0 \xd1\x82\xd0\xb5\xd1\x81\xd1\x82\xd0\xb0 \xd1\x81\xd0\xbe\xd0\xbe\xd1\x82\xd0\xb2\xd0\xb5\xd1\x82\xd1\x81\xd1\x82\xd0\xb2\xd1\x83\xd1\x8e\xd1\x82 \xd0\xbf\xd1\x80\xd0\xb8\xd0\xbc\xd0\xb5\xd1\x80\xd0\xb0\xd0\xbc \xd0\xb8\xd0\xb7 \xd1\x83\xd1\x81\xd0\xbb\xd0\xbe\xd0\xb2\xd0\xb8\xd1\x8f." -999
1275E1 "\xd0\x9a\xd0\xbe\xd0\xbd\xd1\x82\xd1\x80\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xb0\xd1\x8f \xd1\x81\xd1\x83\xd0\xbc\xd0\xbc\xd0\xb0" "*special problem" "\xd0\x94\xd0\xb0\xd0\xbd\xd0\xbd\xd1\x8b\xd0\xb5 \xd0\xbf\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xb7\xd0\xbe\xd0\xb2\xd0\xb0\xd1\x82\xd0\xb5\xd0\xbb\xd0\xb5\xd0\xb9 \xd0\x92\xd0\x9a\xd0\xbe\xd0\xbd\xd1\x82\xd0\xb0\xd0\xba\xd1\x82\xd0\xb5 \xd1\x85\xd1\x80\xd0\xb0\xd0\xbd\xd1\x8f\xd1\x82\xd1\x81\xd1\x8f \xd0\xbd\xd0\xb0 \xd0\xb4\xd0\xb5\xd1\x81\xd1\x8f\xd1\x82\xd0\xba\xd0\xb0\xd1\x85 \xd1\x82\xd1\x8b\xd1\x81\xd1\x8f\xd1\x87 \xd1\x81\xd0\xb5\xd1\x80\xd0\xb2\xd0\xb5\xd1\x80\xd0\xbe\xd0\xb2. \xd0\x94\xd0\xbb\xd1\x8f \xd1\x82\xd0\xbe\xd0\xb3\xd0\xbe, \xd1\x87\xd1\x82\xd0\xbe\xd0\xb1\xd1\x8b \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xbd\xd0\xbe \xd0\xb1\xd1\x8b\xd0\xbb\xd0\xbe \xd0\xbe\xd0\xbf\xd1\x80\xd0\xb5\xd0\xb4\xd0\xb5\xd0\xbb\xd1\x8f\xd1\x82\xd1\x8c \xd0\xbe\xd1\x88\xd0\xb8\xd0\xb1\xd0\xba\xd0\xb8 \xd0\xbf\xd1\x80\xd0\xb8 \xd0\xb7\xd0\xb0\xd0\xbf\xd0\xb8\xd1\x81\xd0\xb8 \xd0\xb4\xd0\xb0\xd0\xbd\xd0\xbd\xd1\x8b\xd1\x85 \xd0\xbd\xd0\xb0 \xd0\xb4\xd0\xb8\xd1\x81\xd0\xba, \xd0\xbd\xd0\xb0 \xd0\xb4\xd0\xb8\xd1\x81\xd0\xba \xd1\x80\xd0\xb5\xd0\xb3\xd1\x83\xd0\xbb\xd1\x8f\xd1\x80\xd0\xbd\xd0\xbe \xd0\xb7\xd0\xb0\xd0\xbf\xd0\xb8\xd1\x81\xd1\x8b\xd0\xb2\xd0\xb0\xd1\x8e\xd1\x82\xd1\x81\xd1\x8f \xd1\x82\xd0\xb5\xd0\xba\xd1\x83\xd1\x89\xd0\xb8\xd0\xb5 \xd0\xba\xd0\xbe\xd0\xbd\xd1\x82\xd1\x80\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xbd\xd1\x8b\xd0\xb5 \xd1\x81\xd1\x83\xd0\xbc\xd0\xbc\xd1\x8b CRC32 (Wiki, IEEE 802-3). \xd0\x91\xd0\xbb\xd0\xb0\xd0\xb3\xd0\xbe\xd0\xb4\xd0\xb0\xd1\x80\xd1\x8f \xd1\x8d\xd1\x82\xd0\xbe\xd0\xbc\xd1\x83, \xd0\xbf\xd1\x80\xd0\xb8 \xd1\x87\xd1\x82\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb8 \xd0\xb4\xd0\xb0\xd0\xbd\xd0\xbd\xd1\x8b\xd1\x85 \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xbd\xd0\xbe \xd0\xb7\xd0\xb0\xd0\xbd\xd0\xbe\xd0\xb2\xd0\xbe \xd0\xb2\xd1\x8b\xd1\x87\xd0\xb8\xd1\x81\xd0\xbb\xd0\xb8\xd1\x82\xd1\x8c \xd0\xba\xd0\xbe\xd0\xbd\xd1\x82\xd1\x80\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xbd\xd1\x83\xd1\x8e \xd1\x81\xd1\x83\xd0\xbc\xd0\xbc\xd1\x83 \xd0\xb8 \xd0\xbf\xd1\x80\xd0\xbe\xd0\xb2\xd0\xb5\xd1\x80\xd0\xb8\xd1\x82\xd1\x8c, \xd1\x87\xd1\x82\xd0\xbe \xd0\xb4\xd0\xb0\xd0\xbd\xd0\xbd\xd1\x8b\xd0\xb5 \xd0\xb8 \xd0\xba\xd0\xbe\xd0\xbd\xd1\x82\xd1\x80\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xb0\xd1\x8f \xd1\x81\xd1\x83\xd0\xbc\xd0\xbc\xd0\xb0 \xd0\xb7\xd0\xb0\xd0\xbf\xd0\xb8\xd1\x81\xd0\xb0\xd0\xbd\xd1\x8b \xd0\xba\xd0\xbe\xd1\x80\xd1\x80\xd0\xb5\xd0\xba\xd1\x82\xd0\xbd\xd0\xbe. \xd0\xa0\xd0\xb0\xd0\xb7\xd1\x83\xd0\xbc\xd0\xb5\xd0\xb5\xd1\x82\xd1\x81\xd1\x8f, \xd0\xbf\xd1\x80\xd0\xbe\xd0\xb2\xd0\xb5\xd1\x80\xd0\xba\xd0\xb8 \xd0\xbd\xd0\xb0 \xd1\x81\xd0\xbe\xd0\xb2\xd0\xbf\xd0\xb0\xd0\xb4\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb5 \xd0\xba\xd0\xbe\xd0\xbd\xd1\x82\xd1\x80\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe\xd0\xb9 \xd1\x81\xd1\x83\xd0\xbc\xd0\xbc\xd1\x8b \xd0\xb2\xd1\x81\xd1\x82\xd1\x80\xd0\xbe\xd0\xb5\xd0\xbd\xd1\x8b \xd0\xb2 \xd0\xb1\xd0\xbe\xd0\xbb\xd1\x8c\xd1\x88\xd0\xb8\xd0\xbd\xd1\x81\xd1\x82\xd0\xb2\xd0\xbe \xd1\x81\xd0\xb5\xd1\x80\xd0\xb2\xd0\xb8\xd1\x81\xd0\xbe\xd0\xb2 \xd0\x92\xd0\x9a\xd0\xbe\xd0\xbd\xd1\x82\xd0\xb0\xd0\xba\xd1\x82\xd0\xb5. \xd0\x9d\xd0\xbe \xd0\xba\xd0\xb0\xd0\xba-\xd1\x82\xd0\xbe \xd1\x80\xd0\xb0\xd0\xb7 \xd0\xbe\xd0\xba\xd0\xb0\xd0\xb7\xd0\xb0\xd0\xbb\xd0\xbe\xd1\x81\xd1\x8c, \xd1\x87\xd1\x82\xd0\xbe \xd0\xb2 \xd0\xbe\xd0\xb4\xd0\xbd\xd0\xbe\xd0\xbc \xd1\x81\xd0\xb5\xd0\xb3\xd0\xbc\xd0\xb5\xd0\xbd\xd1\x82\xd0\xb5 \xd0\xb4\xd0\xb0\xd0\xbd\xd0\xbd\xd1\x8b\xd1\x85 \xd0\xbd\xd1\x83\xd0\xb6\xd0\xbd\xd0\xbe \xd0\xb8\xd0\xb7\xd0\xbc\xd0\xb5\xd0\xbd\xd0\xb8\xd1\x82\xd1\x8c \xd0\xb7\xd0\xbd\xd0\xb0\xd1\x87\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb5 \xd1\x87\xd0\xb5\xd1\x82\xd1\x8b\xd1\x80\xd0\xb5\xd1\x85 \xd0\xbf\xd0\xbe\xd1\x81\xd0\xbb\xd0\xb5\xd0\xb4\xd0\xbe\xd0\xb2\xd0\xb0\xd1\x82\xd0\xb5\xd0\xbb\xd1\x8c\xd0\xbd\xd1\x8b\xd1\x85 \xd0\xb1\xd0\xb0\xd0\xb9\xd1\x82 \xd0\xbd\xd0\xb0 \xd0\xbd\xd0\xbe\xd0\xb2\xd0\xbe\xd0\xb5Â \xe2\x80\x94 \xd0\xbd\xd1\x83\xd0\xb6\xd0\xbd\xd0\xbe \xd0\xb7\xd0\xb0\xd0\xbc\xd0\xb5\xd0\xbd\xd0\xb8\xd1\x82\xd1\x8c \xd0\xb7\xd0\xbd\xd0\xb0\xd1\x87\xd0\xb5\xd0\xbd\xd0\xb8\xd1\x8f \xd0\xbf\xd0\xbe\xd1\x81\xd0\xbb\xd0\xb5\xd0\xb4\xd0\xbe\xd0\xb2\xd0\xb0\xd1\x82\xd0\xb5\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe\xd1\x81\xd1\x82\xd0\xb8 ai,ai+1,ai+2,ai+3 \xd0\xbd\xd0\xb0 x0,x1,x2,x3. \xd0\x9f\xd1\x80\xd0\xb8 \xd1\x8d\xd1\x82\xd0\xbe\xd0\xbc, \xd0\xbd\xd1\x83\xd0\xb6\xd0\xbd\xd0\xbe \xd1\x87\xd1\x82\xd0\xbe\xd0\xb1\xd1\x8b \xd0\xb7\xd0\xbd\xd0\xb0\xd1\x87\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb5 \xd0\xba\xd0\xbe\xd0\xbd\xd1\x82\xd1\x80\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe\xd0\xb9 \xd1\x81\xd1\x83\xd0\xbc\xd0\xbc\xd1\x8b CRC32 \xd0\xbe\xd1\x81\xd1\x82\xd0\xb0\xd0\xbb\xd0\xbe\xd1\x81\xd1\x8c \xd0\xbf\xd1\x80\xd0\xb5\xd0\xb6\xd0\xbd\xd0\xb8\xd0\xbc. \xd0\x9a\xd0\xbe\xd0\xbd\xd0\xb5\xd1\x87\xd0\xbd\xd0\xbe, \xd0\xbf\xd1\x80\xd0\xb8 \xd0\xb8\xd0\xb7\xd0\xbc\xd0\xb5\xd0\xbd\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb8 \xd0\xbf\xd0\xbe\xd1\x81\xd0\xbb\xd0\xb5\xd0\xb4\xd0\xbe\xd0\xb2\xd0\xb0\xd1\x82\xd0\xb5\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe\xd1\x81\xd1\x82\xd0\xb8 \xd0\xb5\xd0\xb5 \xd0\xba\xd0\xbe\xd0\xbd\xd1\x82\xd1\x80\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xb0\xd1\x8f \xd1\x81\xd1\x83\xd0\xbc\xd0\xbc\xd0\xb0 \xd0\xb8\xd0\xb7\xd0\xbc\xd0\xb5\xd0\xbd\xd0\xb8\xd1\x82\xd1\x81\xd1\x8f, \xd0\xbf\xd0\xbe\xd1\x8d\xd1\x82\xd0\xbe\xd0\xbc\xd1\x83 \xd0\xba\xd1\x80\xd0\xbe\xd0\xbc\xd0\xb5 \xd0\xb8\xd0\xb7\xd0\xbc\xd0\xb5\xd0\xbd\xd0\xb5\xd0\xbd\xd0\xb8\xd1\x8f \xd1\x8d\xd1\x82\xd0\xb8\xd1\x85 \xd1\x87\xd0\xb5\xd1\x82\xd1\x8b\xd1\x80\xd0\xb5\xd1\x85 \xd0\xb1\xd0\xb0\xd0\xb9\xd1\x82 \xd0\xbd\xd0\xb0 \xd0\xbd\xd0\xbe\xd0\xb2\xd0\xbe\xd0\xb5 \xd0\xb7\xd0\xbd\xd0\xb0\xd1\x87\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb5, \xd0\xb1\xd1\x8b\xd0\xbb\xd0\xb8 \xd0\xb2\xd1\x8b\xd0\xb1\xd1\x80\xd0\xb0\xd0\xbd\xd1\x8b \xd1\x87\xd0\xb5\xd1\x82\xd1\x8b\xd1\x80\xd0\xb5 \xd0\xb1\xd0\xb0\xd0\xb9\xd1\x82\xd0\xb0 aj,aj+1,aj+2,aj+3, \xd0\xba\xd0\xbe\xd1\x82\xd0\xbe\xd1\x80\xd1\x8b\xd0\xbc \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xbd\xd0\xbe \xd0\xbd\xd0\xb0\xd0\xb7\xd0\xbd\xd0\xb0\xd1\x87\xd0\xb8\xd1\x82\xd1\x8c \xd0\xbb\xd1\x8e\xd0\xb1\xd0\xbe\xd0\xb5 \xd0\xb7\xd0\xbd\xd0\xb0\xd1\x87\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb5. \xd0\x92\xd0\xb0\xd1\x88\xd0\xb0 \xd0\xb7\xd0\xb0\xd0\xb4\xd0\xb0\xd1\x87\xd0\xb0 \xd0\xb2\xd1\x8b\xd0\xb1\xd1\x80\xd0\xb0\xd1\x82\xd1\x8c \xd0\xb8\xd0\xbc \xd0\xbd\xd0\xbe\xd0\xb2\xd1\x8b\xd0\xb5 \xd0\xb7\xd0\xbd\xd0\xb0\xd1\x87\xd0\xb5\xd0\xbd\xd0\xb8\xd1\x8f \xd1\x82\xd0\xb0\xd0\xba, \xd1\x87\xd1\x82\xd0\xbe\xd0\xb1\xd1\x8b CRC32 \xd0\xb4\xd0\xb0\xd0\xbd\xd0\xbd\xd0\xbe\xd0\xb9 \xd0\xbf\xd0\xbe\xd1\x81\xd0\xbb\xd0\xb5\xd0\xb4\xd0\xbe\xd0\xb2\xd0\xb0\xd1\x82\xd0\xb5\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe\xd1\x81\xd1\x82\xd0\xb8 \xd0\xbd\xd0\xb5 \xd0\xb8\xd0\xb7\xd0\xbc\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xbb\xd1\x81\xd1\x8f, \xd0\xb8\xd0\xbb\xd0\xb8 \xd0\xbe\xd0\xbf\xd1\x80\xd0\xb5\xd0\xb4\xd0\xb5\xd0\xbb\xd0\xb8\xd1\x82\xd1\x8c, \xd1\x87\xd1\x82\xd0\xbe \xd1\x8d\xd1\x82\xd0\xbe \xd0\xbd\xd0\xb5\xd0\xb2\xd0\xbe\xd0\xb7\xd0\xbc\xd0\xbe\xd0\xb6\xd0\xbd\xd0\xbe. \xd0\x9f\xd0\xbe\xd1\x81\xd0\xba\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xba\xd1\x83 \xd0\xb8\xd0\xb7\xd0\xbc\xd0\xb5\xd0\xbd\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb5 \xd0\xb4\xd0\xb0\xd0\xbd\xd0\xbd\xd1\x8b\xd1\x85Â \xe2\x80\x94 \xd0\xbe\xd0\xbf\xd0\xb5\xd1\x80\xd0\xb0\xd1\x86\xd0\xb8\xd1\x8f \xd1\x81\xd0\xb5\xd1\x80\xd1\x8c\xd0\xb5\xd0\xb7\xd0\xbd\xd0\xb0\xd1\x8f, \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb5\xd0\xb4 \xd1\x81\xd0\xb0\xd0\xbc\xd0\xb8\xd0\xbc \xd0\xb8\xd0\xb7\xd0\xbc\xd0\xb5\xd0\xbd\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb5\xd0\xbc \xd0\xbd\xd1\x83\xd0\xb6\xd0\xbd\xd0\xbe \xd0\xbe\xd0\xbf\xd1\x80\xd0\xb5\xd0\xb4\xd0\xb5\xd0\xbb\xd0\xb8\xd1\x82\xd1\x8c, \xd0\xba\xd0\xb0\xd0\xba \xd0\xb8\xd0\xb7\xd0\xbc\xd0\xb5\xd0\xbd\xd0\xb8\xd1\x82\xd1\x81\xd1\x8f \xd0\xbf\xd0\xbe\xd1\x81\xd0\xbb\xd0\xb5\xd0\xb4\xd0\xbe\xd0\xb2\xd0\xb0\xd1\x82\xd0\xb5\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe\xd1\x81\xd1\x82\xd1\x8c \xd0\xb4\xd0\xbb\xd1\x8f q \xd0\xbd\xd0\xb5\xd0\xb7\xd0\xb0\xd0\xb2\xd0\xb8\xd1\x81\xd0\xb8\xd0\xbc\xd1\x8b\xd1\x85 \xd1\x82\xd0\xb5\xd1\x81\xd1\x82\xd0\xbe\xd0\xb2\xd1\x8b\xd1\x85 \xd1\x81\xd0\xbb\xd1\x83\xd1\x87\xd0\xb0\xd0\xb5\xd0\xb2.\xd0\x9e\xd0\xb1\xd1\x80\xd0\xb0\xd1\x82\xd0\xb8\xd1\x82\xd0\xb5 \xd0\xb2\xd0\xbd\xd0\xb8\xd0\xbc\xd0\xb0\xd0\xbd\xd0\xb8\xd0\xb5, \xd1\x87\xd1\x82\xd0\xbe \xd0\xb2 \xd1\x8d\xd1\x82\xd0\xbe\xd0\xb9 \xd0\xb2\xd0\xb5\xd1\x80\xd1\x81\xd0\xb8\xd0\xb8 \xd0\xb7\xd0\xb0\xd0\xb4\xd0\xb0\xd1\x87\xd0\xb8 \xd0\xb5\xd1\x81\xd1\x82\xd1\x8c \xd0\xb2\xd1\x81\xd0\xb5\xd0\xb3\xd0\xbe \xd0\xbe\xd0\xb4\xd0\xb8\xd0\xbd \xd1\x82\xd0\xb5\xd1\x81\xd1\x82 \xd1\x81 n=16,q=8, \xd0\xba\xd0\xbe\xd1\x82\xd0\xbe\xd1\x80\xd1\x8b\xd0\xb9 \xd0\xb2\xd1\x8b \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xb5\xd1\x82\xd0\xb5 \xd1\x81\xd0\xba\xd0\xb0\xd1\x87\xd0\xb0\xd1\x82\xd1\x8c \xd0\xbf\xd0\xbe \xd1\x8d\xd1\x82\xd0\xbe\xd0\xb9 \xd1\x81\xd1\x81\xd1\x8b\xd0\xbb\xd0\xba\xd0\xb5. \xd0\x92\xd0\xb0\xd1\x88\xd0\xb5 \xd1\x80\xd0\xb5\xd1\x88\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb5 \xd0\xbd\xd0\xb5 \xd0\xbe\xd0\xb1\xd1\x8f\xd0\xb7\xd0\xb0\xd0\xbd\xd0\xbe \xd0\xbf\xd1\x80\xd0\xbe\xd1\x85\xd0\xbe\xd0\xb4\xd0\xb8\xd1\x82\xd1\x8c \xd1\x82\xd0\xb5\xd1\x81\xd1\x82\xd1\x8b \xd0\xb8\xd0\xb7 \xd1\x83\xd1\x81\xd0\xbb\xd0\xbe\xd0\xb2\xd0\xb8\xd1\x8f, \xd0\xb8 \xd0\xbd\xd0\xb5 \xd0\xb1\xd1\x83\xd0\xb4\xd0\xb5\xd1\x82 \xd0\xbd\xd0\xb0 \xd0\xbd\xd0\xb8\xd1\x85 \xd0\xbf\xd1\x80\xd0\xbe\xd1\x82\xd0\xb5\xd1\x81\xd1\x82\xd0\xb8\xd1\x80\xd0\xbe\xd0\xb2\xd0\xb0\xd0\xbd\xd0\xbe. \xd0\x95\xd1\x81\xd0\xbb\xd0\xb8 \xd0\xb2\xd1\x8b \xd1\x85\xd0\xbe\xd1\x82\xd0\xb8\xd1\x82\xd0\xb5 \xd0\xbf\xd1\x80\xd0\xbe\xd0\xb2\xd0\xb5\xd1\x80\xd0\xb8\xd1\x82\xd1\x8c \xd0\xb2\xd0\xb0\xd1\x88\xd0\xb5 \xd1\x80\xd0\xb5\xd1\x88\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb5 \xd0\xbd\xd0\xb0 \xd1\x82\xd0\xb5\xd1\x81\xd1\x82\xd0\xb0\xd1\x85 \xd0\xb8\xd0\xb7 \xd1\x83\xd1\x81\xd0\xbb\xd0\xbe\xd0\xb2\xd0\xb8\xd1\x8f, \xd0\xbe\xd1\x82\xd0\xbf\xd1\x80\xd0\xb0\xd0\xb2\xd0\xbb\xd1\x8f\xd0\xb9\xd1\x82\xd0\xb5 \xd0\xb5\xd0\xb3\xd0\xbe \xd0\xb2 \xd0\xb7\xd0\xb0\xd0\xb4\xd0\xb0\xd1\x87\xd1\x83 E3, \xd0\xb3\xd0\xb4\xd0\xb5 \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb2\xd1\x8b\xd0\xb5 \xd0\xb4\xd0\xb2\xd0\xb0 \xd1\x82\xd0\xb5\xd1\x81\xd1\x82\xd0\xb0 \xd1\x81\xd0\xbe\xd0\xbe\xd1\x82\xd0\xb2\xd0\xb5\xd1\x82\xd1\x81\xd1\x82\xd0\xb2\xd1\x83\xd1\x8e\xd1\x82 \xd0\xbf\xd1\x80\xd0\xb8\xd0\xbc\xd0\xb5\xd1\x80\xd0\xb0\xd0\xbc \xd0\xb8\xd0\xb7 \xd1\x83\xd1\x81\xd0\xbb\xd0\xbe\xd0\xb2\xd0\xb8\xd1\x8f." -999
1275D Storage2 "*special problem" "\xd0\x94\xd0\xbb\xd1\x8f \xd0\xbd\xd0\xb0\xd0\xb4\xd0\xb5\xd0\xb6\xd0\xbd\xd0\xbe\xd0\xb3\xd0\xbe, \xd0\xbd\xd0\xbe \xd0\xba\xd0\xbe\xd0\xbc\xd0\xbf\xd0\xb0\xd0\xba\xd1\x82\xd0\xbd\xd0\xbe\xd0\xb3\xd0\xbe \xd1\x85\xd1\x80\xd0\xb0\xd0\xbd\xd0\xb5\xd0\xbd\xd0\xb8\xd1\x8f \xd0\xba\xd0\xb0\xd1\x80\xd1\x82\xd0\xb8\xd0\xbd\xd0\xbe\xd0\xba \xd0\xb2\xd0\xbe \xd0\x92\xd0\x9a\xd0\xbe\xd0\xbd\xd1\x82\xd0\xb0\xd0\xba\xd1\x82\xd0\xb5 \xd0\xb8\xd1\x81\xd0\xbf\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xb7\xd1\x83\xd1\x8e\xd1\x82\xd1\x81\xd1\x8f \xd0\xb8\xd0\xb7\xd0\xb1\xd1\x8b\xd1\x82\xd0\xbe\xd1\x87\xd0\xbd\xd1\x8b\xd0\xb5 \xd0\xba\xd0\xbe\xd0\xb4\xd1\x8b. \xd0\x92\xd1\x81\xd0\xb5 \xd0\xba\xd0\xb0\xd1\x80\xd1\x82\xd0\xb8\xd0\xbd\xd0\xba\xd0\xb8 \xd1\x80\xd0\xb0\xd0\xb7\xd0\xb1\xd0\xb8\xd0\xb2\xd0\xb0\xd1\x8e\xd1\x82\xd1\x81\xd1\x8f \xd0\xbd\xd0\xb0 \xd0\xb3\xd1\x80\xd1\x83\xd0\xbf\xd0\xbf\xd1\x8b \xd0\xbf\xd0\xbe 15, \xd0\xb8 \xd0\xb4\xd0\xbb\xd1\x8f \xd0\xba\xd0\xb0\xd0\xb6\xd0\xb4\xd0\xbe\xd0\xb9 \xd0\xb3\xd1\x80\xd1\x83\xd0\xbf\xd0\xbf\xd1\x8b \xd0\xba\xd0\xb0\xd1\x80\xd1\x82\xd0\xb8\xd0\xbd\xd0\xbe\xd0\xba \xd0\xb2\xd1\x8b\xd1\x87\xd0\xb8\xd1\x81\xd0\xbb\xd1\x8f\xd1\x8e\xd1\x82\xd1\x81\xd1\x8f 13 \xd0\xb8\xd0\xb7\xd0\xb1\xd1\x8b\xd1\x82\xd0\xbe\xd1\x87\xd0\xbd\xd1\x8b\xd1\x85 \xd0\xba\xd0\xbe\xd0\xb4\xd0\xbe\xd0\xb2. \xd0\x98\xd0\xb7\xd0\xb1\xd1\x8b\xd1\x82\xd0\xbe\xd1\x87\xd0\xbd\xd1\x8b\xd0\xb5 \xd0\xba\xd0\xbe\xd0\xb4\xd1\x8b \xd0\xbd\xd0\xb5\xd0\xbe\xd0\xb1\xd1\x85\xd0\xbe\xd0\xb4\xd0\xb8\xd0\xbc\xd1\x8b, \xd1\x87\xd1\x82\xd0\xbe\xd0\xb1\xd1\x8b \xd1\x81\xd1\x83\xd0\xbc\xd0\xb5\xd1\x82\xd1\x8c \xd0\xb2\xd0\xbe\xd1\x81\xd1\x81\xd1\x82\xd0\xb0\xd0\xbd\xd0\xbe\xd0\xb2\xd0\xb8\xd1\x82\xd1\x8c \xd0\xbd\xd0\xb5\xd0\xba\xd0\xbe\xd1\x82\xd0\xbe\xd1\x80\xd1\x8b\xd0\xb5 \xd0\xba\xd0\xb0\xd1\x80\xd1\x82\xd0\xb8\xd0\xbd\xd0\xba\xd0\xb8, \xd0\xb5\xd1\x81\xd0\xbb\xd0\xb8 \xd0\xbe\xd0\xbd\xd0\xb8 \xd0\xb1\xd1\x83\xd0\xb4\xd1\x83\xd1\x82 \xd1\x83\xd1\x82\xd0\xb5\xd1\x80\xd1\x8f\xd0\xbd\xd1\x8b \xd0\xb2\xd1\x81\xd0\xbb\xd0\xb5\xd0\xb4\xd1\x81\xd1\x82\xd0\xb2\xd0\xb8\xd0\xb5 \xd0\xbf\xd0\xbe\xd0\xbb\xd0\xbe\xd0\xbc\xd0\xba\xd0\xb8 \xd0\xb6\xd0\xb5\xd1\x81\xd1\x82\xd0\xba\xd0\xbe\xd0\xb3\xd0\xbe \xd0\xb4\xd0\xb8\xd1\x81\xd0\xba\xd0\xb0.\xd0\x9f\xd0\xb5\xd1\x80\xd0\xb5\xd0\xb4 \xd0\xb2\xd1\x8b\xd1\x87\xd0\xb8\xd1\x81\xd0\xbb\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb5\xd0\xbc \xd0\xb8\xd0\xb7\xd0\xb1\xd1\x8b\xd1\x82\xd0\xbe\xd1\x87\xd0\xbd\xd1\x8b\xd1\x85 \xd0\xba\xd0\xbe\xd0\xb4\xd0\xbe\xd0\xb2 15 \xd0\xba\xd0\xb0\xd1\x80\xd1\x82\xd0\xb8\xd0\xbd\xd0\xbe\xd0\xba \xd0\xb8\xd0\xb7 \xd0\xbe\xd0\xb4\xd0\xbd\xd0\xbe\xd0\xb9 \xd0\xb3\xd1\x80\xd1\x83\xd0\xbf\xd0\xbf\xd1\x8b \xd0\xb7\xd0\xb0\xd0\xbf\xd0\xb8\xd1\x81\xd1\x8b\xd0\xb2\xd0\xb0\xd1\x8e\xd1\x82\xd1\x81\xd1\x8f \xd0\xb2 \xd0\xbc\xd0\xb0\xd1\x82\xd1\x80\xd0\xb8\xd1\x86\xd1\x83 \xd0\xb8\xd0\xb7 3 \xd1\x81\xd1\x82\xd1\x80\xd0\xbe\xd0\xba \xd0\xb8 5 \xd1\x81\xd1\x82\xd0\xbe\xd0\xbb\xd0\xb1\xd1\x86\xd0\xbe\xd0\xb2. \xd0\x94\xd0\xb0\xd0\xbb\xd0\xb5\xd0\xb5 \xd0\xba \xd0\xbf\xd0\xbe\xd0\xbb\xd1\x83\xd1\x87\xd0\xb8\xd0\xb2\xd1\x88\xd0\xb5\xd0\xb9\xd1\x81\xd1\x8f \xd0\xbc\xd0\xb0\xd1\x82\xd1\x80\xd0\xb8\xd1\x86\xd0\xb5 \xd1\x81\xd0\xbf\xd1\x80\xd0\xb0\xd0\xb2\xd0\xb0 \xd0\xb4\xd0\xbe\xd0\xb1\xd0\xb0\xd0\xb2\xd0\xbb\xd1\x8f\xd1\x8e\xd1\x82\xd1\x81\xd1\x8f \xd0\xb4\xd0\xb2\xd0\xb0 \xd1\x81\xd1\x82\xd0\xbe\xd0\xbb\xd0\xb1\xd1\x86\xd0\xb0 \xd1\x81 6 \xd0\xb8\xd0\xb7\xd0\xb1\xd1\x8b\xd1\x82\xd0\xbe\xd1\x87\xd0\xbd\xd1\x8b\xd0\xbc\xd0\xb8 \xd0\xba\xd0\xbe\xd0\xb4\xd0\xb0\xd0\xbc\xd0\xb8 (\xd0\xba\xd0\xb0\xd0\xb6\xd0\xb4\xd0\xb0\xd1\x8f \xd0\xbf\xd0\xb0\xd1\x80\xd0\xb0 \xd0\xba\xd0\xbe\xd0\xb4\xd0\xbe\xd0\xb2 \xd0\xb2\xd1\x8b\xd1\x87\xd0\xb8\xd1\x81\xd0\xbb\xd1\x8f\xd0\xb5\xd1\x82\xd1\x81\xd1\x8f \xd0\xbd\xd0\xb0 \xd0\xbe\xd1\x81\xd0\xbd\xd0\xbe\xd0\xb2\xd0\xb5 \xd0\xba\xd0\xb0\xd1\x80\xd1\x82\xd0\xb8\xd0\xbd\xd0\xbe\xd0\xba \xd0\xb2 \xd1\x82\xd0\xbe\xd0\xb9 \xd0\xb6\xd0\xb5 \xd1\x81\xd1\x82\xd1\x80\xd0\xbe\xd0\xba\xd0\xb5), \xd0\xb0 \xd0\xb7\xd0\xb0\xd1\x82\xd0\xb5\xd0\xbc \xd1\x81\xd0\xbd\xd0\xb8\xd0\xb7\xd1\x83 \xd0\xb4\xd0\xbe\xd0\xb1\xd0\xb0\xd0\xb2\xd0\xbb\xd1\x8f\xd0\xb5\xd1\x82\xd1\x81\xd1\x8f \xd0\xb5\xd1\x89\xd0\xb5 \xd0\xbe\xd0\xb4\xd0\xbd\xd0\xb0 \xd1\x81\xd1\x82\xd1\x80\xd0\xbe\xd0\xba\xd0\xb0 \xd0\xb8\xd0\xb7 7 \xd0\xb8\xd0\xb7\xd0\xb1\xd1\x8b\xd1\x82\xd0\xbe\xd1\x87\xd0\xbd\xd1\x8b\xd1\x85 \xd0\xba\xd0\xbe\xd0\xb4\xd0\xbe\xd0\xb2 (\xd0\xba\xd0\xb0\xd0\xb6\xd0\xb4\xd1\x8b\xd0\xb9 \xd0\xb8\xd0\xb7 \xd0\xbd\xd0\xb8\xd1\x85 \xd1\x81\xd1\x87\xd0\xb8\xd1\x82\xd0\xb0\xd0\xb5\xd1\x82\xd1\x81\xd1\x8f \xd0\xbd\xd0\xb0 \xd0\xbe\xd1\x81\xd0\xbd\xd0\xbe\xd0\xb2\xd0\xb5 \xd0\xba\xd0\xb0\xd1\x80\xd1\x82\xd0\xb8\xd0\xbd\xd0\xbe\xd0\xba \xd0\xb8\xd0\xbb\xd0\xb8 \xd0\xb8\xd0\xb7\xd0\xb1\xd1\x8b\xd1\x82\xd0\xbe\xd1\x87\xd0\xbd\xd1\x8b\xd1\x85 \xd0\xba\xd0\xbe\xd0\xb4\xd0\xbe\xd0\xb2 \xd0\xb2 \xd1\x82\xd0\xbe\xd0\xbc \xd0\xb6\xd0\xb5 \xd1\x81\xd1\x82\xd0\xbe\xd0\xbb\xd0\xb1\xd1\x86\xd0\xb5).\xd0\x91\xd1\x83\xd0\xb4\xd0\xb5\xd0\xbc \xd0\xbd\xd0\xb0\xd0\xb7\xd1\x8b\xd0\xb2\xd0\xb0\xd1\x82\xd1\x8c \xd0\xba\xd0\xb0\xd1\x80\xd1\x82\xd0\xb8\xd0\xbd\xd0\xba\xd0\xb8 \xd0\xb8 \xd0\xb8\xd0\xb7\xd0\xb1\xd1\x8b\xd1\x82\xd0\xbe\xd1\x87\xd0\xbd\xd1\x8b\xd0\xb5 \xd0\xba\xd0\xbe\xd0\xb4\xd1\x8b \xd0\xb1\xd0\xbb\xd0\xbe\xd0\xba\xd0\xb0\xd0\xbc\xd0\xb8. \xd0\xa2\xd0\xb0\xd0\xba\xd0\xb8\xd0\xbc \xd0\xbe\xd0\xb1\xd1\x80\xd0\xb0\xd0\xb7\xd0\xbe\xd0\xbc, \xd0\xb8\xd0\xb7 15 \xd0\xba\xd0\xb0\xd1\x80\xd1\x82\xd0\xb8\xd0\xbd\xd0\xbe\xd0\xba \xd0\xbc\xd1\x8b \xd0\xbf\xd0\xbe\xd0\xbb\xd1\x83\xd1\x87\xd0\xb8\xd0\xbb\xd0\xb8 28 \xd0\xb1\xd0\xbb\xd0\xbe\xd0\xba\xd0\xbe\xd0\xb2, \xd1\x80\xd0\xb0\xd1\x81\xd1\x81\xd1\x82\xd0\xb0\xd0\xb2\xd0\xbb\xd0\xb5\xd0\xbd\xd0\xbd\xd1\x8b\xd1\x85 \xd0\xb2 \xd0\xb2\xd0\xb8\xd0\xb4\xd0\xb5 \xd0\xbc\xd0\xb0\xd1\x82\xd1\x80\xd0\xb8\xd1\x86\xd1\x8b 4 \xd0\xbd\xd0\xb0 7. \xd0\x92 \xd0\xb4\xd0\xb0\xd0\xbd\xd0\xbd\xd0\xbe\xd0\xb9 \xd0\xb7\xd0\xb0\xd0\xb4\xd0\xb0\xd1\x87\xd0\xb5 \xd0\xb2\xd0\xb0\xd0\xbc \xd0\xbd\xd0\xb5 \xd0\xb1\xd1\x83\xd0\xb4\xd1\x83\xd1\x82 \xd0\xb4\xd0\xb0\xd0\xbd\xd1\x8b \xd1\x84\xd0\xbe\xd1\x80\xd0\xbc\xd1\x83\xd0\xbb\xd1\x8b \xd0\xb2\xd1\x8b\xd1\x87\xd0\xb8\xd1\x81\xd0\xbb\xd0\xb5\xd0\xbd\xd0\xb8\xd1\x8f \xd0\xb8\xd0\xb7\xd0\xb1\xd1\x8b\xd1\x82\xd0\xbe\xd1\x87\xd0\xbd\xd1\x8b\xd1\x85 \xd0\xba\xd0\xbe\xd0\xb4\xd0\xbe\xd0\xb2, \xd0\xbd\xd0\xbe \xd0\xb4\xd0\xb0\xd0\xbd\xd1\x8b \xd0\xb8\xd1\x85 \xd1\x81\xd0\xb2\xd0\xbe\xd0\xb9\xd1\x81\xd1\x82\xd0\xb2\xd0\xb0: \xd0\xb0 \xd0\xb8\xd0\xbc\xd0\xb5\xd0\xbd\xd0\xbd\xd0\xbe \xd0\xbf\xd0\xbe 3 \xd0\xbb\xd1\x8e\xd0\xb1\xd1\x8b\xd0\xbc \xd0\xb1\xd0\xbb\xd0\xbe\xd0\xba\xd0\xb0\xd0\xbc \xd0\xb8\xd0\xb7 \xd0\xbe\xd0\xb4\xd0\xbd\xd0\xbe\xd0\xb3\xd0\xbe \xd1\x81\xd1\x82\xd0\xbe\xd0\xbb\xd0\xb1\xd1\x86\xd0\xb0 \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xbd\xd0\xbe \xd0\xbe\xd0\xb4\xd0\xbd\xd0\xbe\xd0\xb7\xd0\xbd\xd0\xb0\xd1\x87\xd0\xbd\xd0\xbe \xd0\xb2\xd0\xbe\xd1\x81\xd1\x81\xd1\x82\xd0\xb0\xd0\xbd\xd0\xbe\xd0\xb2\xd0\xb8\xd1\x82\xd1\x8c \xd1\x83\xd1\x82\xd0\xb5\xd1\x80\xd1\x8f\xd0\xbd\xd0\xbd\xd1\x8b\xd0\xb9 \xd1\x87\xd0\xb5\xd1\x82\xd0\xb2\xd0\xb5\xd1\x80\xd1\x82\xd1\x8b\xd0\xb9 \xd0\xb1\xd0\xbb\xd0\xbe\xd0\xba \xd0\xb2 \xd1\x82\xd0\xbe\xd0\xbc \xd0\xb6\xd0\xb5 \xd1\x81\xd1\x82\xd0\xbe\xd0\xbb\xd0\xb1\xd1\x86\xd0\xb5, \xd0\xb0 \xd1\x82\xd0\xb0\xd0\xba\xd0\xb6\xd0\xb5 \xd0\xbf\xd0\xbe 5 \xd0\xbb\xd1\x8e\xd0\xb1\xd1\x8b\xd0\xbc \xd0\xb1\xd0\xbb\xd0\xbe\xd0\xba\xd0\xb0\xd0\xbc \xd0\xb8\xd0\xb7 \xd0\xbe\xd0\xb4\xd0\xbd\xd0\xbe\xd0\xb9 \xd1\x81\xd1\x82\xd1\x80\xd0\xbe\xd0\xba\xd0\xb8 \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xbd\xd0\xbe \xd0\xbe\xd0\xb4\xd0\xbd\xd0\xbe\xd0\xb7\xd0\xbd\xd0\xb0\xd1\x87\xd0\xbd\xd0\xbe \xd0\xb2\xd0\xbe\xd1\x81\xd1\x81\xd1\x82\xd0\xb0\xd0\xbd\xd0\xbe\xd0\xb2\xd0\xb8\xd1\x82\xd1\x8c \xd0\xbe\xd1\x81\xd1\x82\xd0\xb0\xd0\xb2\xd1\x88\xd0\xb8\xd0\xb5\xd1\x81\xd1\x8f \xd0\xb4\xd0\xb2\xd0\xb0 \xd0\xb8\xd0\xb7 \xd1\x82\xd0\xbe\xd0\xb9 \xd0\xb6\xd0\xb5 \xd1\x81\xd1\x82\xd1\x80\xd0\xbe\xd0\xba\xd0\xb8, \xd0\xb5\xd1\x81\xd0\xbb\xd0\xb8 \xd0\xbe\xd0\xbd\xd0\xb8 \xd0\xb1\xd1\x8b\xd0\xbb\xd0\xb8 \xd1\x83\xd1\x82\xd0\xb5\xd1\x80\xd1\x8f\xd0\xbd\xd1\x8b. \xd0\x95\xd1\x81\xd1\x82\xd0\xb5\xd1\x81\xd1\x82\xd0\xb2\xd0\xb5\xd0\xbd\xd0\xbd\xd0\xbe, \xd0\xbe\xd0\xbf\xd0\xb5\xd1\x80\xd0\xb0\xd1\x86\xd0\xb8\xd1\x8e \xd0\xb2\xd0\xbe\xd1\x81\xd1\x81\xd1\x82\xd0\xb0\xd0\xbd\xd0\xbe\xd0\xb2\xd0\xbb\xd0\xb5\xd0\xbd\xd0\xb8\xd1\x8f \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xbd\xd0\xbe \xd0\xbf\xd1\x80\xd0\xb8\xd0\xbc\xd0\xb5\xd0\xbd\xd1\x8f\xd1\x82\xd1\x8c \xd0\xbd\xd0\xb5\xd1\x81\xd0\xba\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xba\xd0\xbe \xd1\x80\xd0\xb0\xd0\xb7 \xd0\xba \xd1\x80\xd0\xb0\xd0\xb7\xd0\xbd\xd1\x8b\xd0\xbc \xd1\x81\xd1\x82\xd1\x80\xd0\xbe\xd0\xba\xd0\xb0\xd0\xbc \xd0\xb8 \xd1\x81\xd1\x82\xd0\xbe\xd0\xbb\xd0\xb1\xd1\x86\xd0\xb0\xd0\xbc \xd0\xb2 \xd0\xbb\xd1\x8e\xd0\xb1\xd0\xbe\xd0\xbc \xd0\xbf\xd0\xbe\xd1\x80\xd1\x8f\xd0\xb4\xd0\xba\xd0\xb5, \xd0\xb0 \xd1\x82\xd0\xb0\xd0\xba\xd0\xb6\xd0\xb5 \xd0\xb2 \xd1\x81\xd0\xbb\xd0\xb5\xd0\xb4\xd1\x83\xd1\x8e\xd1\x89\xd0\xb8\xd1\x85 \xd0\xbe\xd0\xbf\xd0\xb5\xd1\x80\xd0\xb0\xd1\x86\xd0\xb8\xd1\x8f\xd1\x85 \xd0\xb8\xd1\x81\xd0\xbf\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xb7\xd0\xbe\xd0\xb2\xd0\xb0\xd1\x82\xd1\x8c \xd0\xb1\xd0\xbb\xd0\xbe\xd0\xba\xd0\xb8, \xd0\xb2\xd0\xbe\xd1\x81\xd1\x81\xd1\x82\xd0\xb0\xd0\xbd\xd0\xbe\xd0\xb2\xd0\xbb\xd0\xb5\xd0\xbd\xd0\xbd\xd1\x8b\xd0\xb5 \xd1\x80\xd0\xb0\xd0\xbd\xd0\xb5\xd0\xb5.\xd0\x9f\xd1\x83\xd1\x81\xd1\x82\xd1\x8c \xd1\x83 \xd0\xb2\xd0\xb0\xd1\x81 \xd0\xb5\xd1\x81\xd1\x82\xd1\x8c 28 \xd0\xb1\xd0\xbb\xd0\xbe\xd0\xba\xd0\xbe\xd0\xb2 (15 \xd0\xba\xd0\xb0\xd1\x80\xd1\x82\xd0\xb8\xd0\xbd\xd0\xbe\xd0\xba \xd0\xb8 13 \xd0\xb8\xd0\xb7\xd0\xb1\xd1\x8b\xd1\x82\xd0\xbe\xd1\x87\xd0\xbd\xd1\x8b\xd1\x85 \xd0\xba\xd0\xbe\xd0\xb4\xd0\xbe\xd0\xb2), \xd0\xb8 \xd0\xb2\xd1\x8b \xd0\xbf\xd0\xbe\xd1\x82\xd0\xb5\xd1\x80\xd1\x8f\xd0\xbb\xd0\xb8 \xd1\x81\xd0\xbb\xd1\x83\xd1\x87\xd0\xb0\xd0\xb9\xd0\xbd\xd1\x8b\xd0\xb5 k \xd0\xb8\xd0\xb7 \xd0\xbd\xd0\xb8\xd1\x85 (\xd1\x80\xd0\xb0\xd0\xb2\xd0\xbd\xd0\xbe\xd0\xb2\xd0\xb5\xd1\x80\xd0\xbe\xd1\x8f\xd1\x82\xd0\xbd\xd0\xbe \xd1\x81\xd1\x80\xd0\xb5\xd0\xb4\xd0\xb8 \xd0\xb2\xd1\x81\xd0\xb5\xd1\x85 \xd0\xb2\xd0\xb0\xd1\x80\xd0\xb8\xd0\xb0\xd0\xbd\xd1\x82\xd0\xbe\xd0\xb2). \xd0\x92\xd0\xb0\xd1\x88\xd0\xb0 \xd0\xb7\xd0\xb0\xd0\xb4\xd0\xb0\xd1\x87\xd0\xb0 \xd0\xbf\xd0\xbe\xd1\x81\xd1\x87\xd0\xb8\xd1\x82\xd0\xb0\xd1\x82\xd1\x8c \xd0\xb2\xd0\xb5\xd1\x80\xd0\xbe\xd1\x8f\xd1\x82\xd0\xbd\xd0\xbe\xd1\x81\xd1\x82\xd1\x8c, \xd1\x87\xd1\x82\xd0\xbe \xd1\x85\xd0\xbe\xd1\x82\xd1\x8f \xd0\xb1\xd1\x8b \xd0\xbe\xd0\xb4\xd0\xbd\xd1\x83 \xd0\xb8\xd0\xb7 15 \xd0\xba\xd0\xb0\xd1\x80\xd1\x82\xd0\xb8\xd0\xbd\xd0\xbe\xd0\xba \xd0\xb1\xd1\x83\xd0\xb4\xd0\xb5\xd1\x82 \xd0\xbd\xd0\xb5\xd0\xb2\xd0\xbe\xd0\xb7\xd0\xbc\xd0\xbe\xd0\xb6\xd0\xbd\xd0\xbe \xd0\xb2\xd0\xbe\xd1\x81\xd1\x81\xd1\x82\xd0\xb0\xd0\xbd\xd0\xbe\xd0\xb2\xd0\xb8\xd1\x82\xd1\x8c, \xd0\xb0 \xd1\x82\xd0\xb0\xd0\xba\xd0\xb6\xd0\xb5 \xd0\xbc\xd0\xb0\xd1\x82\xd0\xbe\xd0\xb6\xd0\xb8\xd0\xb4\xd0\xb0\xd0\xbd\xd0\xb8\xd0\xb5 \xd0\xba\xd0\xbe\xd0\xbb\xd0\xb8\xd1\x87\xd0\xb5\xd1\x81\xd1\x82\xd0\xb2\xd0\xb0 \xd0\xbf\xd0\xbe\xd1\x82\xd0\xb5\xd1\x80\xd1\x8f\xd0\xbd\xd0\xbd\xd1\x8b\xd1\x85 \xd0\xba\xd0\xb0\xd1\x80\xd1\x82\xd0\xb8\xd0\xbd\xd0\xbe\xd0\xba." -999
1275C "#define \xd0\x97\xd0\xb0\xd0\xb4\xd0\xb0\xd1\x87\xd0\xb0 B ..." "*special problem" "\xd0\x9a\xd0\xbe\xd0\xbc\xd0\xbf\xd0\xb0\xd0\xbd\xd0\xb8\xd1\x8f \xc2\xab\xd0\x92\xd0\x9a\xd0\xbe\xd0\xbd\xd1\x82\xd0\xb0\xd0\xba\xd1\x82\xd0\xb5\xc2\xbb \xd0\xb0\xd0\xba\xd1\x82\xd0\xb8\xd0\xb2\xd0\xbd\xd0\xbe \xd0\xb8\xd1\x81\xd0\xbf\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xb7\xd1\x83\xd0\xb5\xd1\x82 \xd1\x8f\xd0\xb7\xd1\x8b\xd0\xba\xd0\xb8 C/C++ \xd0\xb4\xd0\xbb\xd1\x8f \xd1\x80\xd0\xb0\xd0\xb7\xd1\x80\xd0\xb0\xd0\xb1\xd0\xbe\xd1\x82\xd0\xba\xd0\xb8 \xd0\xb4\xd0\xb2\xd0\xb8\xd0\xb6\xd0\xba\xd0\xbe\xd0\xb2. \xd0\xa1\xd1\x82\xd0\xb0\xd1\x80\xd1\x88\xd0\xb8\xd0\xb9 \xd1\x80\xd0\xb0\xd0\xb7\xd1\x80\xd0\xb0\xd0\xb1\xd0\xbe\xd1\x82\xd1\x87\xd0\xb8\xd0\xba \xd0\x92\xd0\xb0\xd1\x81\xd1\x8fÂ \xe2\x80\x94 \xd0\xb1\xd0\xbe\xd0\xbb\xd1\x8c\xd1\x88\xd0\xbe\xd0\xb9 \xd0\xbb\xd1\x8e\xd0\xb1\xd0\xb8\xd1\x82\xd0\xb5\xd0\xbb\xd1\x8c \xd1\x8f\xd0\xb7\xd1\x8b\xd0\xba\xd0\xb0 C, \xd0\xb2\xd0\xb5\xd0\xb4\xd1\x8c \xd1\x82\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xba\xd0\xbe \xd0\xb2 \xd0\xbd\xd0\xb5\xd0\xbc \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xbd\xd0\xbe \xd0\xbf\xd0\xbe\xd0\xbb\xd0\xbd\xd0\xbe\xd1\x81\xd1\x82\xd1\x8c\xd1\x8e \xd1\x80\xd0\xb0\xd1\x81\xd0\xba\xd1\x80\xd1\x8b\xd1\x82\xd1\x8c \xd0\xbf\xd0\xbe\xd1\x82\xd0\xb5\xd0\xbd\xd1\x86\xd0\xb8\xd0\xb0\xd0\xbb Define-Oriented Programming. \xd0\x92 \xd1\x8f\xd0\xb7\xd1\x8b\xd0\xba\xd0\xb5 C \xd0\xb4\xd0\xb8\xd1\x80\xd0\xb5\xd0\xba\xd1\x82\xd0\xb8\xd0\xb2\xd0\xb0 #define \xd0\xbf\xd0\xbe\xd0\xb7\xd0\xb2\xd0\xbe\xd0\xbb\xd1\x8f\xd0\xb5\xd1\x82 \xd1\x81\xd0\xb4\xd0\xb5\xd0\xbb\xd0\xb0\xd1\x82\xd1\x8c \xd0\xbf\xd1\x80\xd1\x8f\xd0\xbc\xd1\x83\xd1\x8e \xd0\xbf\xd0\xbe\xd0\xb4\xd1\x81\xd1\x82\xd0\xb0\xd0\xbd\xd0\xbe\xd0\xb2\xd0\xba\xd1\x83 \xd0\xba\xd1\x83\xd1\x81\xd0\xba\xd0\xb0 \xd0\xba\xd0\xbe\xd0\xb4\xd0\xb0 \xd0\xb2 \xd0\xbb\xd1\x8e\xd0\xb1\xd0\xbe\xd0\xb5 \xd0\xbc\xd0\xb5\xd1\x81\xd1\x82\xd0\xbe \xd0\xbf\xd1\x80\xd0\xbe\xd0\xb3\xd1\x80\xd0\xb0\xd0\xbc\xd0\xbc\xd1\x8b. \xd0\x9d\xd0\xb0\xd0\xbf\xd1\x80\xd0\xb8\xd0\xbc\xd0\xb5\xd1\x80, \xd0\xbf\xd1\x80\xd0\xb8 \xd0\xb8\xd1\x81\xd0\xbf\xd0\xbe\xd0\xbb\xd0\xbd\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb8 \xd1\x81\xd0\xbb\xd0\xb5\xd0\xb4\xd1\x83\xd1\x8e\xd1\x89\xd0\xb5\xd0\xb3\xd0\xbe \xd0\xba\xd0\xbe\xd0\xb4\xd0\xb0 \xd0\xb7\xd0\xbd\xd0\xb0\xd1\x87\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb5 \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb5\xd0\xbc\xd0\xb5\xd0\xbd\xd0\xbd\xd0\xbe\xd0\xb9 v \xd0\xb1\xd1\x83\xd0\xb4\xd0\xb5\xd1\x82 \xd1\x80\xd0\xb0\xd0\xb2\xd0\xbd\xd0\xbe 11 (\xd0\xb2 \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb5\xd0\xbc\xd0\xb5\xd0\xbd\xd0\xbd\xd1\x83\xd1\x8e v \xd0\xb7\xd0\xb0\xd0\xbf\xd0\xb8\xd1\x88\xd0\xb5\xd1\x82\xd1\x81\xd1\x8f \xd1\x80\xd0\xb5\xd0\xb7\xd1\x83\xd0\xbb\xd1\x8c\xd1\x82\xd0\xb0\xd1\x82 \xd0\xb2\xd1\x8b\xd1\x80\xd0\xb0\xd0\xb6\xd0\xb5\xd0\xbd\xd0\xb8\xd1\x8f 3+4\xe2\x8b\x852).#define add(x) + x#define mul(y) * yint v = 3 add(4) mul(2);\xd0\x9d\xd0\xb5\xd0\xb4\xd0\xb0\xd0\xb2\xd0\xbd\xd0\xbe \xd0\x92\xd0\xb0\xd1\x81\xd1\x8f \xd0\xbd\xd0\xb0\xd0\xbf\xd0\xb8\xd1\x81\xd0\xb0\xd0\xbb \xd0\xbd\xd0\xb5\xd0\xb1\xd0\xbe\xd0\xbb\xd1\x8c\xd1\x88\xd1\x83\xd1\x8e \xd0\xbf\xd1\x80\xd0\xbe\xd0\xb3\xd1\x80\xd0\xb0\xd0\xbc\xd0\xbc\xd1\x83, \xd0\xba\xd0\xbe\xd1\x82\xd0\xbe\xd1\x80\xd0\xb0\xd1\x8f \xd0\xb7\xd0\xb0\xd0\xbf\xd0\xbe\xd0\xbb\xd0\xbd\xd1\x8f\xd0\xb5\xd1\x82 \xd0\xbc\xd0\xb0\xd1\x81\xd1\x81\xd0\xb8\xd0\xb2 \xd0\xb1\xd0\xbe\xd0\xbb\xd1\x8c\xd1\x88\xd0\xbe\xd0\xb9 \xd0\xb4\xd0\xbb\xd0\xb8\xd0\xbd\xd1\x8b. \xd0\x9f\xd1\x80\xd0\xbe\xd0\xb3\xd1\x80\xd0\xb0\xd0\xbc\xd0\xbc\xd0\xb0 \xd0\xb2\xd1\x8b\xd0\xb3\xd0\xbb\xd1\x8f\xd0\xb4\xd0\xb8\xd1\x82 \xd1\x81\xd0\xbb\xd0\xb5\xd0\xb4\xd1\x83\xd1\x8e\xd1\x89\xd0\xb8\xd0\xbc \xd0\xbe\xd0\xb1\xd1\x80\xd0\xb0\xd0\xb7\xd0\xbe\xd0\xbc:#define A0(x) x,#define A1(x) A0(x) A0(x + 1) A0(x + 3) A0(x + 4)#define A2(x) A1(x) A1(x + 1) A1(x + 3) A1(x + 4)#define A3(x) A2(x) A2(x + 1) A2(x + 3) A2(x + 4)#define A4(x) A3(x) A3(x + 1) A3(x + 3) A3(x + 4)...#define A24(x) A23(x) A23(x + 1) A23(x + 3) A23(x + 4)#define A25(x) A24(x) A24(x + 1) A24(x + 3) A24(x + 4)const long long values[1125899906842624] = { A25(0) };\xd0\x9a \xd1\x81\xd0\xbe\xd0\xb6\xd0\xb0\xd0\xbb\xd0\xb5\xd0\xbd\xd0\xb8\xd1\x8e, \xd0\xb5\xd0\xb3\xd0\xbe \xd0\xbf\xd1\x80\xd0\xbe\xd0\xb3\xd1\x80\xd0\xb0\xd0\xbc\xd0\xbc\xd0\xb0 \xd0\xbd\xd0\xb5 \xd0\xba\xd0\xbe\xd0\xbc\xd0\xbf\xd0\xb8\xd0\xbb\xd0\xb8\xd1\x80\xd1\x83\xd0\xb5\xd1\x82\xd1\x81\xd1\x8f \xd0\xb2 \xd1\x81\xd0\xb8\xd0\xbb\xd1\x83 \xd0\xbd\xd0\xb5\xd1\x81\xd0\xbe\xd0\xb2\xd0\xb5\xd1\x80\xd1\x88\xd0\xb5\xd0\xbd\xd1\x81\xd1\x82\xd0\xb2\xd0\xb0 \xd0\xb5\xd0\xb3\xd0\xbe \xd0\xba\xd0\xbe\xd0\xbc\xd0\xbf\xd1\x8c\xd1\x8e\xd1\x82\xd0\xb5\xd1\x80\xd0\xb0, \xd0\xbd\xd0\xbe \xd0\xb5\xd0\xbc\xd1\x83 \xd0\xbe\xd1\x87\xd0\xb5\xd0\xbd\xd1\x8c \xd0\xb8\xd0\xbd\xd1\x82\xd0\xb5\xd1\x80\xd0\xb5\xd1\x81\xd0\xbd\xd0\xbe \xd0\xb7\xd0\xbd\xd0\xb0\xd1\x82\xd1\x8c, \xd0\xba\xd0\xb0\xd0\xba\xd0\xb8\xd0\xb5 \xd0\xb7\xd0\xbd\xd0\xb0\xd1\x87\xd0\xb5\xd0\xbd\xd0\xb8\xd1\x8f \xd0\xbb\xd0\xb5\xd0\xb6\xd0\xb0\xd0\xbb\xd0\xb8 \xd0\xb1\xd1\x8b \xd0\xb2 \xd0\xbc\xd0\xb0\xd1\x81\xd1\x81\xd0\xb8\xd0\xb2\xd0\xb5 values, \xd0\xb5\xd1\x81\xd0\xbb\xd0\xb8 \xd0\xb1\xd1\x8b \xd0\xb5\xd0\xbc\xd1\x83 \xd1\x83\xd0\xb4\xd0\xb0\xd0\xbb\xd0\xbe\xd1\x81\xd1\x8c \xd1\x81\xd0\xba\xd0\xbe\xd0\xbc\xd0\xbf\xd0\xb8\xd0\xbb\xd0\xb8\xd1\x80\xd0\xbe\xd0\xb2\xd0\xb0\xd1\x82\xd1\x8c \xd0\xb8 \xd0\xb7\xd0\xb0\xd0\xbf\xd1\x83\xd1\x81\xd1\x82\xd0\xb8\xd1\x82\xd1\x8c \xd0\xbf\xd1\x80\xd0\xbe\xd0\xb3\xd1\x80\xd0\xb0\xd0\xbc\xd0\xbc\xd1\x83. \xd0\x9f\xd0\xbe\xd0\xbc\xd0\xbe\xd0\xb3\xd0\xb8\xd1\x82\xd0\xb5 \xd0\xb5\xd0\xbc\xd1\x83 \xd1\x8d\xd1\x82\xd0\xbe \xd1\x83\xd0\xb7\xd0\xbd\xd0\xb0\xd1\x82\xd1\x8c." -999
1275B "Code Review" "*special problem" "\xd0\xa3 \xd0\xba\xd0\xbe\xd0\xbc\xd0\xb0\xd0\xbd\xd0\xb4\xd1\x8b \xd1\x80\xd0\xb0\xd0\xb7\xd1\x80\xd0\xb0\xd0\xb1\xd0\xbe\xd1\x82\xd0\xba\xd0\xb8 \xd0\xb4\xd0\xb2\xd0\xb8\xd0\xb6\xd0\xba\xd0\xbe\xd0\xb2 \xd0\x92\xd0\x9a\xd0\xbe\xd0\xbd\xd1\x82\xd0\xb0\xd0\xba\xd1\x82\xd0\xb5 \xd0\xb5\xd1\x81\xd1\x82\xd1\x8c \xd0\xbe\xd0\xb1\xd1\x89\xd0\xb8\xd0\xb9 \xd1\x87\xd0\xb0\xd1\x82. \xd0\x9f\xd0\xbe\xd1\x81\xd0\xbb\xd0\xb5 \xd0\xba\xd0\xb0\xd0\xb6\xd0\xb4\xd0\xbe\xd0\xb3\xd0\xbe \xd1\x81\xd0\xbb\xd0\xbe\xd0\xb6\xd0\xbd\xd0\xbe\xd0\xb3\xd0\xbe \xd0\xba\xd0\xbe\xd0\xbc\xd0\xbc\xd0\xb8\xd1\x82\xd0\xb0 \xd0\xb2 \xd1\x80\xd0\xb5\xd0\xbf\xd0\xbe\xd0\xb7\xd0\xb8\xd1\x82\xd0\xbe\xd1\x80\xd0\xb8\xd0\xb9, \xd0\xb0\xd0\xb2\xd1\x82\xd0\xbe\xd1\x80 \xd1\x8d\xd1\x82\xd0\xbe\xd0\xb3\xd0\xbe \xd0\xba\xd0\xbe\xd0\xbc\xd0\xbc\xd0\xb8\xd1\x82\xd0\xb0 \xd0\xbf\xd1\x80\xd0\xb8\xd1\x81\xd1\x8b\xd0\xbb\xd0\xb0\xd0\xb5\xd1\x82 \xd0\xb2 \xd1\x87\xd0\xb0\xd1\x82 \xd1\x81\xd0\xbe\xd0\xbe\xd0\xb1\xd1\x89\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb5 \xd1\x81 \xd0\xbf\xd1\x80\xd0\xb5\xd0\xb4\xd0\xbb\xd0\xbe\xd0\xb6\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb5\xd0\xbc \xd0\xbf\xd1\x80\xd0\xbe\xd0\xb2\xd0\xb5\xd1\x81\xd1\x82\xd0\xb8 \xd1\x80\xd0\xb5\xd0\xb2\xd1\x8c\xd1\x8e. \xd0\x94\xd0\xbb\xd1\x8f \xd0\xbe\xd0\xb4\xd0\xbe\xd0\xb1\xd1\x80\xd0\xb5\xd0\xbd\xd0\xb8\xd1\x8f \xd0\xb8\xd0\xbb\xd0\xb8 \xd0\xbe\xd1\x82\xd0\xba\xd0\xbb\xd0\xbe\xd0\xbd\xd0\xb5\xd0\xbd\xd0\xb8\xd1\x8f \xd0\xba\xd0\xbe\xd0\xbc\xd0\xbc\xd0\xb8\xd1\x82\xd0\xb0 \xd0\xb4\xd0\xbe\xd1\x81\xd1\x82\xd0\xb0\xd1\x82\xd0\xbe\xd1\x87\xd0\xbd\xd0\xbe, \xd1\x87\xd1\x82\xd0\xbe\xd0\xb1\xd1\x8b \xd0\xb5\xd0\xb3\xd0\xbe \xd0\xbf\xd1\x80\xd0\xbe\xd0\xb2\xd0\xb5\xd1\x80\xd0\xb8\xd0\xbb \xd0\xbe\xd0\xb4\xd0\xb8\xd0\xbd \xd1\x80\xd0\xb0\xd0\xb7\xd1\x80\xd0\xb0\xd0\xb1\xd0\xbe\xd1\x82\xd1\x87\xd0\xb8\xd0\xba, \xd0\xbd\xd0\xb5 \xd0\xbf\xd1\x80\xd0\xb8\xd0\xbd\xd0\xb8\xd0\xbc\xd0\xb0\xd0\xb2\xd1\x88\xd0\xb8\xd0\xb9 \xd1\x83\xd1\x87\xd0\xb0\xd1\x81\xd1\x82\xd0\xb8\xd0\xb5 \xd0\xb2 \xd0\xb5\xd0\xb3\xd0\xbe \xd0\xbd\xd0\xb0\xd0\xbf\xd0\xb8\xd1\x81\xd0\xb0\xd0\xbd\xd0\xb8\xd0\xb8.\xd0\x9f\xd0\xb5\xd1\x80\xd0\xb5\xd0\xb4 \xd1\x82\xd0\xb5\xd0\xbc, \xd0\xba\xd0\xb0\xd0\xba \xd0\xbe\xd1\x81\xd1\x82\xd0\xb0\xd0\xb2\xd0\xb8\xd1\x82\xd1\x8c \xd0\xbd\xd0\xbe\xd0\xb2\xd1\x83\xd1\x8e \xd0\xb7\xd0\xb0\xd1\x8f\xd0\xb2\xd0\xba\xd1\x83 \xd0\xbd\xd0\xb0 \xd1\x80\xd0\xb5\xd0\xb2\xd1\x8c\xd1\x8e, \xd0\xba\xd0\xb0\xd0\xb6\xd0\xb4\xd1\x8b\xd0\xb9 \xd1\x80\xd0\xb0\xd0\xb7\xd1\x80\xd0\xb0\xd0\xb1\xd0\xbe\xd1\x82\xd1\x87\xd0\xb8\xd0\xba \xd0\xbf\xd1\x80\xd0\xbe\xd0\xb2\xd0\xbe\xd0\xb4\xd0\xb8\xd1\x82 \xd1\x80\xd0\xb5\xd0\xb2\xd1\x8c\xd1\x8e \xd0\xbf\xd0\xbe\xd1\x81\xd0\xbb\xd0\xb5\xd0\xb4\xd0\xbd\xd0\xb5\xd0\xb9 \xd0\xb8\xd0\xb7 \xd0\xbe\xd1\x81\xd1\x82\xd0\xb0\xd0\xb2\xd0\xbb\xd0\xb5\xd0\xbd\xd0\xbd\xd1\x8b\xd1\x85 \xd0\xb7\xd0\xb0\xd1\x8f\xd0\xb2\xd0\xbe\xd0\xba, \xd0\xba\xd0\xbe\xd1\x82\xd0\xbe\xd1\x80\xd1\x8b\xd0\xb5 \xd0\xb5\xd1\x89\xd0\xb5 \xd0\xbd\xd0\xb8\xd0\xba\xd0\xb5\xd0\xbc \xd0\xbd\xd0\xb5 \xd0\xbf\xd1\x80\xd0\xbe\xd0\xb2\xd0\xb5\xd1\x80\xd0\xb5\xd0\xbd\xd1\x8b (\xd0\xb5\xd1\x81\xd0\xbb\xd0\xb8 \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xb5\xd1\x82Â \xe2\x80\x94 \xd0\xb5\xd1\x81\xd0\xbb\xd0\xb8 \xd0\xbe\xd0\xbd \xd0\xbd\xd0\xb5 \xd1\x8f\xd0\xb2\xd0\xbb\xd1\x8f\xd0\xb5\xd1\x82\xd1\x81\xd1\x8f \xd0\xb0\xd0\xb2\xd1\x82\xd0\xbe\xd1\x80\xd0\xbe\xd0\xbc \xd1\x8d\xd1\x82\xd0\xbe\xd0\xb9 \xd0\xb7\xd0\xb0\xd1\x8f\xd0\xb2\xd0\xba\xd0\xb8) \xd0\xb8 \xd1\x82\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xba\xd0\xbe \xd0\xbf\xd0\xbe\xd1\x81\xd0\xbb\xd0\xb5 \xd1\x8d\xd1\x82\xd0\xbe\xd0\xb3\xd0\xbe \xd0\xbe\xd1\x81\xd1\x82\xd0\xb0\xd0\xb2\xd0\xbb\xd1\x8f\xd0\xb5\xd1\x82 \xd0\xbd\xd0\xbe\xd0\xb2\xd1\x83\xd1\x8e \xd0\xb7\xd0\xb0\xd1\x8f\xd0\xb2\xd0\xba\xd1\x83.\xd0\x92\xd0\xb0\xd0\xbc \xd0\xb4\xd0\xb0\xd0\xbd \xd0\xbb\xd0\xbe\xd0\xb3 \xd0\xb7\xd0\xb0\xd1\x8f\xd0\xb2\xd0\xbe\xd0\xba \xd0\xbd\xd0\xb0 \xd1\x80\xd0\xb5\xd0\xb2\xd1\x8c\xd1\x8e \xd1\x81 \xd0\xbc\xd0\xbe\xd0\xbc\xd0\xb5\xd0\xbd\xd1\x82\xd0\xb0 \xd0\xbf\xd0\xbe\xd1\x8f\xd0\xb2\xd0\xbb\xd0\xb5\xd0\xbd\xd0\xb8\xd1\x8f \xd1\x87\xd0\xb0\xd1\x82\xd0\xb0 \xd0\xb2 \xd1\x85\xd1\x80\xd0\xbe\xd0\xbd\xd0\xbe\xd0\xbb\xd0\xbe\xd0\xb3\xd0\xb8\xd1\x87\xd0\xb5\xd1\x81\xd0\xba\xd0\xbe\xd0\xbc \xd0\xbf\xd0\xbe\xd1\x80\xd1\x8f\xd0\xb4\xd0\xba\xd0\xb5. \xd0\x9d\xd0\xb0\xd0\xb9\xd0\xb4\xd0\xb8\xd1\x82\xd0\xb5 \xd0\xba\xd0\xbe\xd0\xbc\xd0\xbc\xd0\xb8\xd1\x82\xd1\x8b, \xd0\xba\xd0\xbe\xd1\x82\xd0\xbe\xd1\x80\xd1\x8b\xd0\xb5 \xd0\xbd\xd0\xb8\xd0\xba\xd1\x82\xd0\xbe \xd0\xbd\xd0\xb5 \xd0\xbf\xd1\x80\xd0\xbe\xd0\xb2\xd0\xb5\xd1\x80\xd0\xb8\xd0\xbb." -999
1275A "\xd0\xa1\xd0\xba\xd1\x80\xd1\x8b\xd1\x82\xd1\x8b\xd0\xb9 \xd0\xb4\xd1\x80\xd1\x83\xd0\xb3" "*special problem" "\xd0\x92\xd0\xb0\xd0\xbc \xd0\xb4\xd0\xb0\xd0\xbd \xd0\xb3\xd1\x80\xd0\xb0\xd1\x84 \xd0\xb4\xd1\x80\xd1\x83\xd0\xb7\xd0\xb5\xd0\xb9 VK. \xd0\x9d\xd0\xb5\xd0\xb4\xd0\xb0\xd0\xb2\xd0\xbd\xd0\xbe \xd1\x83 \xd0\xbf\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xb7\xd0\xbe\xd0\xb2\xd0\xb0\xd1\x82\xd0\xb5\xd0\xbb\xd0\xb5\xd0\xb9 \xd0\xbf\xd0\xbe\xd1\x8f\xd0\xb2\xd0\xb8\xd0\xbb\xd0\xb0\xd1\x81\xd1\x8c \xd0\xb2\xd0\xbe\xd0\xb7\xd0\xbc\xd0\xbe\xd0\xb6\xd0\xbd\xd0\xbe\xd1\x81\xd1\x82\xd1\x8c \xd1\x81\xd0\xba\xd1\x80\xd1\x8b\xd0\xb2\xd0\xb0\xd1\x82\xd1\x8c \xd0\xb4\xd1\x80\xd1\x83\xd0\xb7\xd0\xb5\xd0\xb9 \xd0\xb8\xd0\xb7 \xd1\x81\xd0\xbe\xd1\x86\xd0\xb8\xd0\xb0\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe\xd0\xb3\xd0\xbe \xd0\xb3\xd1\x80\xd0\xb0\xd1\x84\xd0\xb0. \xd0\x94\xd0\xbb\xd1\x8f \xd0\xb7\xd0\xb0\xd0\xb4\xd0\xb0\xd0\xbd\xd0\xbd\xd0\xbe\xd0\xb3\xd0\xbe \xd0\xb3\xd1\x80\xd0\xb0\xd1\x84\xd0\xb0 \xd0\xb4\xd1\x80\xd1\x83\xd0\xb7\xd0\xb5\xd0\xb9 \xd0\xbd\xd0\xb0\xd0\xb9\xd0\xb4\xd0\xb8\xd1\x82\xd0\xb5 \xd1\x81\xd0\xba\xd1\x80\xd1\x8b\xd1\x82\xd1\x8b\xd0\xb5 \xd0\xb4\xd1\x80\xd1\x83\xd0\xb6\xd0\xb5\xd1\x81\xd0\xba\xd0\xb8\xd0\xb5 \xd1\x81\xd0\xb2\xd1\x8f\xd0\xb7\xd0\xb8, \xd1\x82\xd0\xbe \xd0\xb5\xd1\x81\xd1\x82\xd1\x8c \xd1\x82\xd0\xb0\xd0\xba\xd0\xb8\xd0\xb5 \xd1\x81\xd0\xb8\xd1\x82\xd1\x83\xd0\xb0\xd1\x86\xd0\xb8\xd0\xb8, \xd0\xba\xd0\xbe\xd0\xb3\xd0\xb4\xd0\xb0 \xd0\xbf\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xb7\xd0\xbe\xd0\xb2\xd0\xb0\xd1\x82\xd0\xb5\xd0\xbb\xd1\x8c u \xd0\xbd\xd0\xb0\xd1\x85\xd0\xbe\xd0\xb4\xd0\xb8\xd1\x82\xd1\x81\xd1\x8f \xd0\xb2 \xd0\xb4\xd1\x80\xd1\x83\xd0\xb7\xd1\x8c\xd1\x8f\xd1\x85 \xd1\x83 \xd0\xbf\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xb7\xd0\xbe\xd0\xb2\xd0\xb0\xd1\x82\xd0\xb5\xd0\xbb\xd1\x8f v, \xd0\xbd\xd0\xbe \xd0\xbf\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xb7\xd0\xbe\xd0\xb2\xd0\xb0\xd1\x82\xd0\xb5\xd0\xbb\xd1\x8c v \xd0\xbd\xd0\xb5 \xd0\xbd\xd0\xb0\xd1\x85\xd0\xbe\xd0\xb4\xd0\xb8\xd1\x82\xd1\x81\xd1\x8f \xd0\xb2 \xd0\xb4\xd1\x80\xd1\x83\xd0\xb7\xd1\x8c\xd1\x8f\xd1\x85 \xd1\x83 \xd0\xbf\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xb7\xd0\xbe\xd0\xb2\xd0\xb0\xd1\x82\xd0\xb5\xd0\xbb\xd1\x8f u." -999
1272F "Two Bracket Sequences" "dp,strings,two pointers" "You are given two bracket sequences (not necessarily regular) s and t consisting only of characters \'(\' and \')\'. You want to construct the shortest regular bracket sequence that contains both given bracket sequences as subsequences (not necessarily contiguous).Recall what is the regular bracket sequence:  () is the regular bracket sequence;  if S is the regular bracket sequence, then (S) is a regular bracket sequence;  if S and T regular bracket sequences, then ST (concatenation of S and T) is a regular bracket sequence. Recall that the subsequence of the string s is such string t that can be obtained from s by removing some (possibly, zero) amount of characters. For example, ""coder"", ""force"", ""cf"" and ""cores"" are subsequences of ""codeforces"", but ""fed"" and ""z"" are not." 2200
1272E "Nearest Opposite Parity" "dfs and similar,graphs,shortest paths" "You are given an array a consisting of n integers. In one move, you can jump from the position i to the position i\xe2\x88\x92ai (if 1\xe2\x89\xa4i\xe2\x88\x92ai) or to the position i+ai (if i+ai\xe2\x89\xa4n).For each position i from 1 to n you want to know the minimum the number of moves required to reach any position j such that aj has the opposite parity from ai (i.e. if ai is odd then aj has to be even and vice versa)." 1900
1272D "Remove One Element" "brute force,dp" "You are given an array a consisting of n integers.You can remove at most one element from this array. Thus, the final length of the array is n\xe2\x88\x921 or n.Your task is to calculate the maximum possible length of the strictly increasing contiguous subarray of the remaining array.Recall that the contiguous subarray a with indices from l to r is a[l\xe2\x80\xa6r]=al,al+1,\xe2\x80\xa6,ar. The subarray a[l\xe2\x80\xa6r] is called strictly increasing if al<al+1<\xe2\x8b\xaf<ar." 1500
1272C "Yet Another Broken Keyboard" combinatorics,dp,implementation "Recently, Norge found a string s=s1s2\xe2\x80\xa6sn consisting of n lowercase Latin letters. As an exercise to improve his typing speed, he decided to type all substrings of the string s. Yes, all n(n+1)2 of them!A substring of s is a non-empty string x=s[a\xe2\x80\xa6b]=sasa+1\xe2\x80\xa6sb (1\xe2\x89\xa4a\xe2\x89\xa4b\xe2\x89\xa4n). For example, ""auto"" and ""ton"" are substrings of ""automaton"".Shortly after the start of the exercise, Norge realized that his keyboard was broken, namely, he could use only k Latin letters c1,c2,\xe2\x80\xa6,ck out of 26.After that, Norge became interested in how many substrings of the string s he could still type using his broken keyboard. Help him to find this number." 1200
1272B "Snow Walking Robot" "constructive algorithms,greedy,implementation" "Recently you have bought a snow walking robot and brought it home. Suppose your home is a cell (0,0) on an infinite grid.You also have the sequence of instructions of this robot. It is written as the string s consisting of characters \'L\', \'R\', \'U\' and \'D\'. If the robot is in the cell (x,y) right now, he can move to one of the adjacent cells (depending on the current instruction).  If the current instruction is \'L\', then the robot can move to the left to (x\xe2\x88\x921,y);  if the current instruction is \'R\', then the robot can move to the right to (x+1,y);  if the current instruction is \'U\', then the robot can move to the top to (x,y+1);  if the current instruction is \'D\', then the robot can move to the bottom to (x,y\xe2\x88\x921). You\'ve noticed the warning on the last page of the manual: if the robot visits some cell (except (0,0)) twice then it breaks.So the sequence of instructions is valid if the robot starts in the cell (0,0), performs the given instructions, visits no cell other than (0,0) two or more times and ends the path in the cell (0,0). Also cell (0,0) should be visited at most two times: at the beginning and at the end (if the path is empty then it is visited only once). For example, the following sequences of instructions are considered valid: ""UD"", ""RL"", ""UUURULLDDDDLDDRRUU"", and the following are considered invalid: ""U"" (the endpoint is not (0,0)) and ""UUDD"" (the cell (0,1) is visited twice).The initial sequence of instructions, however, might be not valid. You don\'t want your robot to break so you decided to reprogram it in the following way: you will remove some (possibly, all or none) instructions from the initial sequence of instructions, then rearrange the remaining instructions as you wish and turn on your robot to move. Your task is to remove as few instructions from the initial sequence as possible and rearrange the remaining ones so that the sequence is valid. Report the valid sequence of the maximum length you can obtain.Note that you can choose any order of remaining instructions (you don\'t need to minimize the number of swaps or any other similar metric).You have to answer q independent test cases." 1200
1272A "Three Friends" "brute force,greedy,math,sortings" "Three friends are going to meet each other. Initially, the first friend stays at the position x=a, the second friend stays at the position x=b and the third friend stays at the position x=c on the coordinate axis Ox.In one minute each friend independently from other friends can change the position x by 1 to the left or by 1 to the right (i.e. set x:=x\xe2\x88\x921 or x:=x+1) or even don\'t change it.Let\'s introduce the total pairwise distance \xe2\x80\x94 the sum of distances between each pair of friends. Let a\xe2\x80\xb2, b\xe2\x80\xb2 and c\xe2\x80\xb2 be the final positions of the first, the second and the third friend, correspondingly. Then the total pairwise distance is |a\xe2\x80\xb2\xe2\x88\x92b\xe2\x80\xb2|+|a\xe2\x80\xb2\xe2\x88\x92c\xe2\x80\xb2|+|b\xe2\x80\xb2\xe2\x88\x92c\xe2\x80\xb2|, where |x| is the absolute value of x.Friends are interested in the minimum total pairwise distance they can reach if they will move optimally. Each friend will move no more than once. So, more formally, they want to know the minimum total pairwise distance they can reach after one minute.You have to answer q independent test cases." 900
1271F "Divide The Students" "brute force" "Recently a lot of students were enrolled in Berland State University. All students were divided into groups according to their education program. Some groups turned out to be too large to attend lessons in the same auditorium, so these groups should be divided into two subgroups. Your task is to help divide the first-year students of the computer science faculty.There are t new groups belonging to this faculty. Students have to attend classes on three different subjects \xe2\x80\x94 maths, programming and P.\xe2\x80\x89E. All classes are held in different places according to the subject \xe2\x80\x94 maths classes are held in auditoriums, programming classes are held in computer labs, and P. E. classes are held in gyms.Each group should be divided into two subgroups so that there is enough space in every auditorium, lab or gym for all students of the subgroup. For the first subgroup of the i-th group, maths classes are held in an auditorium with capacity of ai,1 students; programming classes are held in a lab that accomodates up to bi,1 students; and P.\xe2\x80\x89E. classes are held in a gym having enough place for ci,1 students. Analogically, the auditorium, lab and gym for the second subgroup can accept no more than ai,2, bi,2 and ci,2 students, respectively.As usual, some students skip some classes. Each student considers some number of subjects (from 0 to 3) to be useless \xe2\x80\x94 that means, he skips all classes on these subjects (and attends all other classes). This data is given to you as follows \xe2\x80\x94 the i-th group consists of:  di,1 students which attend all classes;  di,2 students which attend all classes, except for P.\xe2\x80\x89E.;  di,3 students which attend all classes, except for programming;  di,4 students which attend only maths classes;  di,5 students which attend all classes, except for maths;  di,6 students which attend only programming classes;  di,7 students which attend only P.\xe2\x80\x89E. There is one more type of students \xe2\x80\x94 those who don\'t attend any classes at all (but they, obviously, don\'t need any place in auditoriums, labs or gyms, so the number of those students is insignificant in this problem).Your task is to divide each group into two subgroups so that every auditorium (or lab, or gym) assigned to each subgroup has enough place for all students from this subgroup attending the corresponding classes (if it is possible). Each student of the i-th group should belong to exactly one subgroup of the i-th group; it is forbidden to move students between groups." 2700
1271E "Common Number" "binary search,combinatorics,dp,math" "At first, let\'s define function f(x) as follows: f(x)={x2ifÂ xÂ is evenx\xe2\x88\x921otherwiseÂ We can see that if we choose some value v and will apply function f to it, then apply f to f(v), and so on, we\'ll eventually get 1. Let\'s write down all values we get in this process in a list and denote this list as path(v). For example, path(1)=[1], path(15)=[15,14,7,6,3,2,1], path(32)=[32,16,8,4,2,1].Let\'s write all lists path(x) for every x from 1 to n. The question is next: what is the maximum value y such that y is contained in at least k different lists path(x)?Formally speaking, you need to find maximum y such that |{xÂ |Â 1\xe2\x89\xa4x\xe2\x89\xa4n,y\xe2\x88\x88path(x)}|\xe2\x89\xa5k." 2100
1271D Portals "data structures,dp,greedy,implementation,sortings" "You play a strategic video game (yeah, we ran out of good problem legends). In this game you control a large army, and your goal is to conquer n castles of your opponent.Let\'s describe the game process in detail. Initially you control an army of k warriors. Your enemy controls n castles; to conquer the i-th castle, you need at least ai warriors (you are so good at this game that you don\'t lose any warriors while taking over a castle, so your army stays the same after the fight). After you take control over a castle, you recruit new warriors into your army \xe2\x80\x94 formally, after you capture the i-th castle, bi warriors join your army. Furthermore, after capturing a castle (or later) you can defend it: if you leave at least one warrior in a castle, this castle is considered defended. Each castle has an importance parameter ci, and your total score is the sum of importance values over all defended castles. There are two ways to defend a castle:  if you are currently in the castle i, you may leave one warrior to defend castle i;  there are m one-way portals connecting the castles. Each portal is characterised by two numbers of castles u and v (for each portal holds u>v). A portal can be used as follows: if you are currently in the castle u, you may send one warrior to defend castle v. Obviously, when you order your warrior to defend some castle, he leaves your army.You capture the castles in fixed order: you have to capture the first one, then the second one, and so on. After you capture the castle i (but only before capturing castle i+1) you may recruit new warriors from castle i, leave a warrior to defend castle i, and use any number of portals leading from castle i to other castles having smaller numbers. As soon as you capture the next castle, these actions for castle i won\'t be available to you.If, during some moment in the game, you don\'t have enough warriors to capture the next castle, you lose. Your goal is to maximize the sum of importance values over all defended castles (note that you may hire new warriors in the last castle, defend it and use portals leading from it even after you capture it \xe2\x80\x94 your score will be calculated afterwards).Can you determine an optimal strategy of capturing and defending the castles?" 2100
1271C "Shawarma Tent" "brute force,geometry,greedy,implementation" "The map of the capital of Berland can be viewed on the infinite coordinate plane. Each point with integer coordinates contains a building, and there are streets connecting every building to four neighbouring buildings. All streets are parallel to the coordinate axes.The main school of the capital is located in (sx,sy). There are n students attending this school, the i-th of them lives in the house located in (xi,yi). It is possible that some students live in the same house, but no student lives in (sx,sy).After classes end, each student walks from the school to his house along one of the shortest paths. So the distance the i-th student goes from the school to his house is |sx\xe2\x88\x92xi|+|sy\xe2\x88\x92yi|.The Provision Department of Berland has decided to open a shawarma tent somewhere in the capital (at some point with integer coordinates). It is considered that the i-th student will buy a shawarma if at least one of the shortest paths from the school to the i-th student\'s house goes through the point where the shawarma tent is located. It is forbidden to place the shawarma tent at the point where the school is located, but the coordinates of the shawarma tent may coincide with the coordinates of the house of some student (or even multiple students).You want to find the maximum possible number of students buying shawarma and the optimal location for the tent itself." 1300
1271B Blocks greedy,math "There are n blocks arranged in a row and numbered from left to right, starting from one. Each block is either black or white. You may perform the following operation zero or more times: choose two adjacent blocks and invert their colors (white block becomes black, and vice versa). You want to find a sequence of operations, such that they make all the blocks having the same color. You don\'t have to minimize the number of operations, but it should not exceed 3\xe2\x8b\x85n. If it is impossible to find such a sequence of operations, you need to report it." 1300
1271A Suits "brute force,greedy,math" "A new delivery of clothing has arrived today to the clothing store. This delivery consists of a ties, b scarves, c vests and d jackets.The store does not sell single clothing items \xe2\x80\x94 instead, it sells suits of two types:  a suit of the first type consists of one tie and one jacket;  a suit of the second type consists of one scarf, one vest and one jacket. Each suit of the first type costs e coins, and each suit of the second type costs f coins.Calculate the maximum possible cost of a set of suits that can be composed from the delivered clothing items. Note that one item cannot be used in more than one suit (though some items may be left unused)." 800
1270I "Xor on Figures" "constructive algorithms,fft,math" "There is given an integer k and a grid 2k\xc3\x972k with some numbers written in its cells, cell (i,j) initially contains number aij. Grid is considered to be a torus, that is, the cell to the right of (i,2k) is (i,1), the cell below the (2k,i) is (1,i) There is also given a lattice figure F, consisting of t cells, where t is odd. F doesn\'t have to be connected.We can perform the following operation: place F at some position on the grid. (Only translations are allowed, rotations and reflections are prohibited). Now choose any nonnegative integer p. After that, for each cell (i,j), covered by F, replace aij by aij\xe2\x8a\x95p, where \xe2\x8a\x95 denotes the bitwise XOR operation.More formally, let F be given by cells (x1,y1),(x2,y2),\xe2\x80\xa6,(xt,yt). Then you can do the following operation: choose any x,y with 1\xe2\x89\xa4x,y\xe2\x89\xa42k, any nonnegative integer p, and for every i from 1 to n replace number in the cell (((x+xi\xe2\x88\x921)mod2k)+1,((y+yi\xe2\x88\x921)mod2k)+1) with a((x+xi\xe2\x88\x921)mod2k)+1,((y+yi\xe2\x88\x921)mod2k)+1\xe2\x8a\x95p.Our goal is to make all the numbers equal to 0. Can we achieve it? If we can, find the smallest number of operations in which it is possible to do this." 3500
1270H "Number of Components" "data structures" "Suppose that we have an array of n distinct numbers a1,a2,\xe2\x80\xa6,an. Let\'s build a graph on n vertices as follows: for every pair of vertices i<j let\'s connect i and j with an edge, if ai<aj. Let\'s define weight of the array to be the number of connected components in this graph. For example, weight of array [1,4,2] is 1, weight of array [5,4,3] is 3.You have to perform q queries of the following formÂ \xe2\x80\x94 change the value at some position of the array. After each operation, output the weight of the array. Updates are not independent (the change stays for the future)." 3300
1270G "Subset with Zero Sum" "constructive algorithms,dfs and similar,graphs,math" "You are given n integers a1,a2,\xe2\x80\xa6,an, such that for each 1\xe2\x89\xa4i\xe2\x89\xa4n holds i\xe2\x88\x92n\xe2\x89\xa4ai\xe2\x89\xa4i\xe2\x88\x921.Find some nonempty subset of these integers, whose sum is equal to 0. It can be shown that such a subset exists under given constraints. If there are several possible subsets with zero-sum, you can find any of them." 2700
1270F "Awesome Substrings" math,strings "Let\'s call a binary string s awesome, if it has at least 1 symbol 1 and length of the string is divisible by the number of 1 in it. In particular, 1, 1010, 111 are awesome, but 0, 110, 01010 aren\'t.You are given a binary string s. Count the number of its awesome substrings.A string a is a substring of a string b if a can be obtained from b by deletion of several (possibly, zero or all) characters from the beginning and several (possibly, zero or all) characters from the end." 2600
1270E "Divide Points" "constructive algorithms,geometry,math" "You are given a set of n\xe2\x89\xa52 pairwise different points with integer coordinates. Your task is to partition these points into two nonempty groups A and B, such that the following condition holds:For every two points P and Q, write the Euclidean distance between them on the blackboard: if they belong to the same groupÂ \xe2\x80\x94 with a yellow pen, and if they belong to different groupsÂ \xe2\x80\x94 with a blue pen. Then no yellow number is equal to any blue number.It is guaranteed that such a partition exists for any possible input. If there exist multiple partitions, you are allowed to output any of them." 2300
1270D "Strange Device" "constructive algorithms,interactive,math,sortings" "This problem is interactive.We have hidden an array a of n pairwise different numbers (this means that no two numbers are equal). You can get some information about this array using a new device you just ordered on Amazon. This device can answer queries of the following form: in response to the positions of k different elements of the array, it will return the position and value of the m-th among them in the ascending order.Unfortunately, the instruction for the device was lost during delivery. However, you remember k, but don\'t remember m. Your task is to find m using queries to this device. You can ask not more than n queries.Note that the array a and number m are fixed before the start of the interaction and don\'t depend on your queries. In other words, interactor is not adaptive.Note that you don\'t have to minimize the number of queries, and you don\'t need to guess array a. You just have to guess m." 1900
1270C "Make Good" "bitmasks,constructive algorithms,math" "Let\'s call an array a1,a2,\xe2\x80\xa6,am of nonnegative integer numbers good if a1+a2+\xe2\x8b\xaf+am=2\xe2\x8b\x85(a1\xe2\x8a\x95a2\xe2\x8a\x95\xe2\x8b\xaf\xe2\x8a\x95am), where \xe2\x8a\x95 denotes the bitwise XOR operation.For example, array [1,2,3,6] is good, as 1+2+3+6=12=2\xe2\x8b\x856=2\xe2\x8b\x85(1\xe2\x8a\x952\xe2\x8a\x953\xe2\x8a\x956). At the same time, array [1,2,1,3] isn\'t good, as 1+2+1+3=7\xe2\x89\xa02\xe2\x8b\x851=2\xe2\x8b\x85(1\xe2\x8a\x952\xe2\x8a\x951\xe2\x8a\x953).You are given an array of length n: a1,a2,\xe2\x80\xa6,an. Append at most 3 elements to it to make it good. Appended elements don\'t have to be different. It can be shown that the solution always exists under the given constraints. If there are different solutions, you are allowed to output any of them. Note that you don\'t have to minimize the number of added elements!. So, if an array is good already you are allowed to not append elements." 1400
1270B "Interesting Subarray" "constructive algorithms,greedy,math" "For an array a of integers let\'s denote its maximal element as max(a), and minimal as min(a). We will call an array a of k integers interesting if max(a)\xe2\x88\x92min(a)\xe2\x89\xa5k. For example, array [1,3,4,3] isn\'t interesting as max(a)\xe2\x88\x92min(a)=4\xe2\x88\x921=3<4 while array [7,3,0,4,3] is as max(a)\xe2\x88\x92min(a)=7\xe2\x88\x920=7\xe2\x89\xa55.You are given an array a of n integers. Find some interesting nonempty subarray of a, or tell that it doesn\'t exist.An array b is a subarray of an array a if b can be obtained from a by deletion of several (possibly, zero or all) elements from the beginning and several (possibly, zero or all) elements from the end. In particular, an array is a subarray of itself." 1200
1270A "Card Game" games,greedy,math "Two players decided to play one interesting card game.There is a deck of n cards, with values from 1 to n. The values of cards are pairwise different (this means that no two different cards have equal values). At the beginning of the game, the deck is completely distributed between players such that each player has at least one card. The game goes as follows: on each turn, each player chooses one of their cards (whichever they want) and puts on the table, so that the other player doesn\'t see which card they chose. After that, both cards are revealed, and the player, value of whose card was larger, takes both cards in his hand. Note that as all cards have different values, one of the cards will be strictly larger than the other one. Every card may be played any amount of times. The player loses if he doesn\'t have any cards.For example, suppose that n=5, the first player has cards with values 2 and 3, and the second player has cards with values 1, 4, 5. Then one possible flow of the game is:The first player chooses the card 3. The second player chooses the card 1. As 3>1, the first player gets both cards. Now the first player has cards 1, 2, 3, the second player has cards 4, 5.The first player chooses the card 3. The second player chooses the card 4. As 3<4, the second player gets both cards. Now the first player has cards 1, 2. The second player has cards 3, 4, 5.The first player chooses the card 1. The second player chooses the card 3. As 1<3, the second player gets both cards. Now the first player has only the card 2. The second player has cards 1, 3, 4, 5.The first player chooses the card 2. The second player chooses the card 4. As 2<4, the second player gets both cards. Now the first player is out of cards and loses. Therefore, the second player wins.Who will win if both players are playing optimally? It can be shown that one of the players has a winning strategy." 800
1269B "Modulo Equality" "brute force,sortings" "You are given a positive integer m and two integer sequence: a=[a1,a2,\xe2\x80\xa6,an] and b=[b1,b2,\xe2\x80\xa6,bn]. Both of these sequence have a length n.Permutation is a sequence of n different positive integers from 1 to n. For example, these sequences are permutations: [1], [1,2], [2,1], [6,7,3,4,1,2,5]. These are not: [0], [1,1], [2,3].You need to find the non-negative integer x, and increase all elements of ai by x, modulo m (i.e. you want to change ai to (ai+x)modm), so it would be possible to rearrange elements of a to make it equal b, among them you need to find the smallest possible x.In other words, you need to find the smallest non-negative integer x, for which it is possible to find some permutation p=[p1,p2,\xe2\x80\xa6,pn], such that for all 1\xe2\x89\xa4i\xe2\x89\xa4n, (ai+x)modm=bpi, where ymodmÂ \xe2\x80\x94 remainder of division of y by m.For example, if m=3, a=[0,0,2,1],b=[2,0,1,1], you can choose x=1, and a will be equal to [1,1,0,2] and you can rearrange it to make it equal [2,0,1,1], which is equal to b." 1500
1269A Equation "brute force,math" "Let\'s call a positive integer composite if it has at least one divisor other than 1 and itself. For example:  the following numbers are composite: 1024, 4, 6, 9;  the following numbers are not composite: 13, 1, 2, 3, 37. You are given a positive integer n. Find two composite integers a,b such that a\xe2\x88\x92b=n.It can be proven that solution always exists." 800
1268E "Happy Cactus" dp "You are given a cactus graph, in this graph each edge lies on at most one simple cycle.It is given as m edges ai,bi, weight of i-th edge is i.Let\'s call a path in cactus increasing if the weights of edges on this path are increasing.Let\'s call a pair of vertices (u,v) happy if there exists an increasing path that starts in u and ends in v.For each vertex u find the number of other vertices v, such that pair (u,v) is happy." 3400
1268D "Invertation in Tournament" "brute force,divide and conquer,graphs,math" "You are given a tournamentÂ \xe2\x80\x94 complete directed graph.In one operation you can pick any vertex v and change the direction of all edges with v on one of the ends (i.e all edges u\xe2\x86\x92v change their orientation to v\xe2\x86\x92u and vice versa).You want to make the tournament strongly connected with the smallest possible number of such operations if it is possible. Also, if it is possible, you need to find the number of ways to make this number of operations to make graph strongly connected (two ways are different if for some i vertex that we chose on i-th operation in one way is different from vertex that we chose on i-th operation in another way). You only need to find this value modulo 998244353." 3200
1268C "K Integers" "binary search,data structures" "You are given a permutation p1,p2,\xe2\x80\xa6,pn.In one move you can swap two adjacent values.You want to perform a minimum number of moves, such that in the end there will exist a subsegment 1,2,\xe2\x80\xa6,k, in other words in the end there should be an integer i, 1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x92k+1 such that pi=1,pi+1=2,\xe2\x80\xa6,pi+k\xe2\x88\x921=k.Let f(k) be the minimum number of moves that you need to make a subsegment with values 1,2,\xe2\x80\xa6,k appear in the permutation.You need to find f(1),f(2),\xe2\x80\xa6,f(n)." 2300
1268B "Domino for Young" dp,greedy,math "You are given a Young diagram. Given diagram is a histogram with n columns of lengths a1,a2,\xe2\x80\xa6,an (a1\xe2\x89\xa5a2\xe2\x89\xa5\xe2\x80\xa6\xe2\x89\xa5an\xe2\x89\xa51).  Young diagram for a=[3,2,2,2,1]. Your goal is to find the largest number of non-overlapping dominos that you can draw inside of this histogram, a domino is a 1\xc3\x972 or 2\xc3\x971 rectangle." 2000
1268A "Long Beautiful Integer" "constructive algorithms,greedy,implementation,strings" "You are given an integer x of n digits a1,a2,\xe2\x80\xa6,an, which make up its decimal notation in order from left to right.Also, you are given a positive integer k<n.Let\'s call integer b1,b2,\xe2\x80\xa6,bm beautiful if bi=bi+k for each i, such that 1\xe2\x89\xa4i\xe2\x89\xa4m\xe2\x88\x92k.You need to find the smallest beautiful integer y, such that y\xe2\x89\xa5x." 1700
1267L Lexicography "constructive algorithms,strings" "Lucy likes letters. She studied the definition of the lexicographical order at school and plays with it.At first, she tried to construct the lexicographically smallest word out of given letters. It was so easy! Then she tried to build multiple words and minimize one of them. This was much harder!Formally, Lucy wants to make n words of length l each out of the given n\xe2\x8b\x85l letters, so that the k-th of them in the lexicographic order is lexicographically as small as possible." 1800
1267K "Key Storage" combinatorics,math "Karl is developing a key storage service. Each user has a positive integer key.Karl knows that storing keys in plain text is bad practice. So, instead of storing a key, he decided to store a fingerprint of a key. However, using some existing fingerprint algorithm looked too boring to him, so he invented his own one.Karl\'s fingerprint is calculated by the following process: divide the given integer by 2, then divide theÂ result by 3, then divide the result by 4, and so on, until we get a result that equals zero (we are speaking about integer division each time). The fingerprint is defined as the multiset of the remainders of these divisions. For example, this is how Karl\'s fingerprint algorithm is applied to the key 11: 11 divided by 2 has remainderÂ 1 and resultÂ 5, then 5 divided by 3 has remainder 2 and result 1, and 1 divided by 4 has remainderÂ 1 and resultÂ 0. Thus, the key 11 produces the sequence of remainders [1,2,1] and has the fingerprint multiset {1,1,2}.Ksenia wants to prove that Karl\'s fingerprint algorithm is not very good. For example, she found that both keys 178800 and 123456 produce the fingerprint of {0,0,0,0,2,3,3,4}. Thus, users are at risk of fingerprint collision with some commonly used and easy to guess keys like 123456.Ksenia wants to make her words more persuasive. She wants to calculate the number of other keys that have the same fingerprint as the keys in the given list of some commonly used keys. Your task is to helpÂ her." 2100
1267J "Just Arrange the Icons" greedy,implementation,math "BerPhone X is almost ready for release with n applications being preinstalled on the phone. A category of an application characterizes a genre or a theme of this application (like ""game"", ""business"", or ""education""). The categories are given as integers between 1 and n, inclusive; the i-th application has category ci. You can choose mÂ \xe2\x80\x94 the number of screens and sÂ \xe2\x80\x94 the size of each screen. You need to fit all n icons of the applications (one icon representing one application) meeting the following requirements:  On each screen, all the icons must belong to applications of the same category (but different screens can contain icons of applications of the same category);  Each screen must be either completely filled with icons (the number of icons on the screen is equal toÂ s) or almost filled with icons (the number of icons is equal to s\xe2\x88\x921). Your task is to find the minimal possible number of screens m." 1800
1267I "Intriguing Selection" "brute force,constructive algorithms,implementation,interactive,sortings" "This is an interactive problem.You are the head coach of a chess club. The club has 2n players, each player has some strength which can be represented by a number, and all those numbers are distinct. The strengths of the players are not known to you.You need to select n players who would represent your club in the upcoming championship. Naturally, you want to select n players with the highest strengths.You can organize matches between the players to do that. In every match, you pick two players, they play some games, and you learn which one of the two has higher strength. You can wait for the outcome of a match before deciding who will participate in the next one.However, you do not want to know exactly how those n players compare between themselves, as that would make the championship itself less intriguing. More formally, you must reach a state where there is exactly one way to choose n players with the highest strengths that is consistent with the outcomes of the matches you organized, but there must be at least two possible orderings of those n players by strength that are consistent with the outcomes of the matches you organized." 2600
1267H "Help BerLine" "constructive algorithms" "Very soon, the new cell phone services provider ""BerLine"" will begin its work in Berland!The start of customer service is planned along the main street of the capital. There are nÂ base stations that are already installed. They are located one after another along the main street in the order from theÂ 1-st to theÂ n-th from left to right. Currently, all these base stations are turned off. They will be turned on one by one, one base station per day, according to some permutation p=[p1,p2,\xe2\x80\xa6,pn] (1\xe2\x89\xa4pi\xe2\x89\xa4n), where pi is the index of a base station that will be turned on on the i-th day. Thus, it will take n days to turn on all base stations.Each base station is characterized by its operating frequency fiÂ \xe2\x80\x94 an integer between 1 and 24, inclusive.There is an important requirement for operating frequencies of base stations. Consider an arbitrary moment in time. For any phone owner, if we consider all base stations turned on in the access area of their phone, then in this set of base stations there should be at least one whose operating frequency is unique among the frequencies of these stations. Since the power of the phone and the position are not known in advance, this means that for any nonempty subsegment of turned on base stations, at least one of them has to have the operating frequency that is unique among the stations of this subsegment.For example, let\'s take a look at a case of n=7, all n stations are turned on, and their frequencies are equal to f=[1,2,1,3,1,2,1]. Consider any subsegment of the base stationsÂ \xe2\x80\x94 there is a base station with a unique frequency within this subsegment. However, if f=[1,2,1,2,3,2,1], then there is no unique frequency on the segment [1,2,1,2] from the index 1 to the index 4, inclusive.Your task is to assign a frequency from 1 to 24 to each of n base stations in such a way that the frequency requirement is met at every moment. Remember that the base stations are turned on in the order of the given permutation p." 3200
1267G "Game Relics" math,probabilities "Esports is a form of competitive sports using video games. DotaÂ 2 is one of the most popular competitive video games in Esports. Recently, a new video game DotaÂ 3 was released. In DotaÂ 3 a player can buy some relics for their hero. Relics are counters that track hero\'s actions and statistics in a game.Gloria likes to play DotaÂ 3, so she wants to buy all n available relics for her favorite hero.Relics can be bought using an in-game currency called shards. Each relic has its own priceÂ \xe2\x80\x94 ci shards for the i-th relic. A player can buy a relic using one of the following options:   Pay ci shards to buy the i-th relic;  Pay x shards and randomly get one of all n relics. The probability of getting a relic is the same for all n relics. If a duplicate relic is received, then the relic is recycled and x2 shards are given back to the player. Gloria wants to buy all n relics. Help her minimize the expected number of shards she spends to buy all the relics." 3000
1267E Elections greedy "Byteburg Senate elections are coming. Usually ""United Byteland"", the ruling Byteland party, takes all the seats in the Senate to ensure stability and sustainable development. But this year there is one opposition candidate in one of the constituencies. Even one opposition member can disturb the stability in the Senate, so the head of the Party asks you to ensure that the opposition candidate will not be elected.There are n candidates, numbered from 1 to n. Candidate n is the opposition candidate. There are mÂ polling stations in the constituency, numbered from 1 to m. You know the number of votes cast for each candidate at each polling station. The only thing you can do to prevent the election of the opposition candidate is to cancel the election results at some polling stations. The opposition candidate will be elected if the sum of the votes cast in their favor at all non-canceled stations will be strictly greater than the analogous sum for every other candidate. Your task is to prevent the election of the opposition candidate by canceling the election results at the minimal possible number of polling stations. Notice that solution always exists, because if you cancel the elections at all polling stations, the number of votes for each candidate will be 0, and the opposition candidate will not be elected." 1700
1267D "DevOps Best Practices" "constructive algorithms" "Daisy is a senior software engineer at RainyDay, LLC. She has just implemented three new features in their product: the first feature makes their product work, the second one makes their product fast, and the third one makes their product correct. The company encourages at least some testing of new features, so Daisy appointed her intern Demid to write some tests for the new features.Interestingly enough, these three features pass all the tests on Demid\'s development server, which has index 1, but might fail the tests on some other servers.After Demid has completed this task, Daisy appointed you to deploy these three features to all nÂ servers of your company. For every feature f and every server s, Daisy told you whether she wants the feature f to be deployed on the server s. If she wants it to be deployed, it must be done even if the feature f fails the tests on the server s. If she does not want it to be deployed, you may not deploy it there.Your company has two important instruments for the deployment of new features to servers: Continuous Deployment (CD) and Continuous Testing (CT). CD can be established between several pairs of servers, forming a directed graph. CT can be set up on some set of servers.If CD is configured from the server s1 to the server s2 then every time s1 receives a new feature f the system starts the following deployment process of f to s2:  If the feature f is already deployed on the server s2, then nothing is done.  Otherwise, if CT is not set up on the server s1, then the server s1 just deploys the feature f to the server s2 without any testing.  Otherwise, the server s1 runs tests for the feature f. If the tests fail on the server s1, nothing is done. If the tests pass, then the server s1 deploys the feature f to the server s2. You are to configure the CD/CT system, and after that Demid will deploy all three features on his development server. Your CD/CT system must deploy each feature exactly to the set of servers that Daisy wants.Your company does not have a lot of computing resources, so you can establish CD from one server to another at most 264 times." 2800
1267B "Balls of Buma" NA "Balph is learning to play a game called Buma. In this game, he is given a row of colored balls. He has to choose the color of one new ball and the place to insert it (between two balls, or to the left of all the balls, or to the right of all the balls).When the ball is inserted the following happens repeatedly: if some segment of balls of the same color became longer as a result of a previous action and its length became at least 3, then all the balls of this segment are eliminated. Consider, for example, a row of balls \'AAABBBWWBB\'. Suppose Balph chooses a ball of color \'W\' and the place to insert it after the sixth ball, i.Â e. to the left of the two \'W\'s. After Balph inserts this ball, the balls of color \'W\' are eliminated, since this segment was made longer and has length 3 now, so the row becomes \'AAABBBBB\'. The balls of color \'B\' are eliminated now, because the segment of balls of color \'B\' became longer and has length 5 now. Thus, the row becomes \'AAA\'. However, none of the balls are eliminated now, because there is no elongated segment.Help Balph count the number of possible ways to choose a color of a new ball and a place to insert it that leads to the elimination of all the balls." 900
1266H "Red-Blue Graph" dp,graphs,math,matrices,meet-in-the-middle "There is a directed graph on n vertices numbered 1 through n where each vertex (except n) has two outgoing arcs, red and blue. At any point in time, exactly one of the arcs is active for each vertex. Initially, all blue arcs are active and there is a token located at vertex 1. In one second, the vertex with token first switches its active arcs \xe2\x80\x94 the inactive arc becomes active and vice versa. Then, the token is moved along the active arc. When the token reaches the vertex n, it stops. It is guaranteed that n is reachable via arcs from every vertex.You are given q queries. Each query contains a state of the graph \xe2\x80\x94 a pair (v,s) of the following form:   v is the vertex where the token is currently located;  s is a string consisting of n\xe2\x88\x921 characters. The i-th character corresponds to the color of the active edge leading from the i-th vertex (the character is \'R\' if red arc is active, otherwise the character is \'B\'). For each query, determine whether the given state is reachable from the initial state and the first time this configuration appears. Note that the two operations (change active arc and traverse it) are atomic \xe2\x80\x94 a state is not considered reached if it appears after changing the active arc but before traversing it." 3400
1266G "Permutation Concatenation" "string suffix structures" "Let n be an integer. Consider all permutations on integers 1 to n in lexicographic order, and concatenate them into one big sequence P. For example, if n=3, then P=[1,2,3,1,3,2,2,1,3,2,3,1,3,1,2,3,2,1]. The length of this sequence is n\xe2\x8b\x85n!.Let 1\xe2\x89\xa4i\xe2\x89\xa4j\xe2\x89\xa4n\xe2\x8b\x85n! be a pair of indices. We call the sequence (Pi,Pi+1,\xe2\x80\xa6,Pj\xe2\x88\x921,Pj) a subarray of P. You are given n. Find the number of distinct subarrays of P. Since this number may be large, output it modulo 998244353 (a prime number)." 3300
1266F "Almost Same Distance" "dfs and similar,graphs" "Let G be a simple graph. Let W be a non-empty subset of vertices. Then W is almost-k-uniform if for each pair of distinct vertices u,v\xe2\x88\x88W the distance between u and v is either k or k+1.You are given a tree on n vertices. For each i between 1 and n, find the maximum size of an almost-i-uniform set." 2900
1266E "Spaceship Solitaire" "data structures,greedy,implementation" "Bob is playing a game of Spaceship Solitaire. The goal of this game is to build a spaceship. In order to do this, he first needs to accumulate enough resources for the construction. There are n types of resources, numbered 1 through n. Bob needs at least ai pieces of the i-th resource to build the spaceship. The number ai is called the goal for resource i.Each resource takes 1 turn to produce and in each turn only one resource can be produced. However, there are certain milestones that speed up production. Every milestone is a triple (sj,tj,uj), meaning that as soon as Bob has tj units of the resource sj, he receives one unit of the resource uj for free, without him needing to spend a turn. It is possible that getting this free resource allows Bob to claim reward for another milestone. This way, he can obtain a large number of resources in a single turn.The game is constructed in such a way that there are never two milestones that have the same sj and tj, that is, the award for reaching tj units of resource sj is at most one additional resource.A bonus is never awarded for 0 of any resource, neither for reaching the goal ai nor for going past the goal \xe2\x80\x94 formally, for every milestone 0<tj<asj.A bonus for reaching certain amount of a resource can be the resource itself, that is, sj=uj.Initially there are no milestones. You are to process q updates, each of which adds, removes or modifies a milestone. After every update, output the minimum number of turns needed to finish the game, that is, to accumulate at least ai of i-th resource for each i\xe2\x88\x88[1,n]." 2100
1266D "Decreasing Debts" "constructive algorithms,data structures,graphs,greedy,implementation,math,two pointers" "There are n people in this world, conveniently numbered 1 through n. They are using burles to buy goods and services. Occasionally, a person might not have enough currency to buy what he wants or needs, so he borrows money from someone else, with the idea that he will repay the loan later with interest. Let d(a,b) denote the debt of a towards b, or 0 if there is no such debt.Sometimes, this becomes very complex, as the person lending money can run into financial troubles before his debtor is able to repay his debt, and finds himself in the need of borrowing money. When this process runs for a long enough time, it might happen that there are so many debts that they can be consolidated. There are two ways this can be done:  Let d(a,b)>0 and d(c,d)>0 such that a\xe2\x89\xa0c or b\xe2\x89\xa0d. We can decrease the d(a,b) and d(c,d) byÂ z and increase d(c,b) and d(a,d) byÂ z, where 0<z\xe2\x89\xa4min(d(a,b),d(c,d)).  Let d(a,a)>0. We can set d(a,a) to 0. The total debt is defined as the sum of all debts:\xce\xa3d=\xe2\x88\x91a,bd(a,b)Your goal is to use the above rules in any order any number of times, to make the total debt as small as possible. Note that you don\'t have to minimise the number of non-zero debts, only the total debt." 2000
1266C "Diverse Matrix" "constructive algorithms,greedy,math,number theory" "Let a be a matrix of size r\xc3\x97c containing positive integers, not necessarily distinct. Rows of the matrix are numbered from 1 to r, columns are numbered from 1 to c. We can construct an array b consisting of r+c integers as follows: for each i\xe2\x88\x88[1,r], let bi be the greatest common divisor of integers in the i-th row, and for each j\xe2\x88\x88[1,c] let br+j be the greatest common divisor of integers in the j-th column. We call the matrix diverse if all r+c numbers bk (k\xe2\x88\x88[1,r+c]) are pairwise distinct. The magnitude of a matrix equals to the maximum of bk.For example, suppose we have the following matrix: (297414484) We construct the array b:  b1 is the greatest common divisor of 2, 9, and 7, that is 1;  b2 is the greatest common divisor of 4, 144, and 84, that is 4;  b3 is the greatest common divisor of 2 and 4, that is 2;  b4 is the greatest common divisor of 9 and 144, that is 9;  b5 is the greatest common divisor of 7 and 84, that is 7. So b=[1,4,2,9,7]. All values in this array are distinct, so the matrix is diverse. The magnitude is equal to 9.For a given r and c, find a diverse matrix that minimises the magnitude. If there are multiple solutions, you may output any of them. If there are no solutions, output a single integer 0." 1400
1266B "Dice Tower" "constructive algorithms,math" "Bob is playing with 6-sided dice. A net of such standard cube is shown below.He has an unlimited supply of these dice and wants to build a tower by stacking multiple dice on top of each other, while choosing the orientation of each dice. Then he counts the number of visible pips on the faces of the dice.For example, the number of visible pips on the tower below is 29 \xe2\x80\x94 the number visible on the top is 1, from the south 5 and 3, from the west 4 and 2, from the north 2 and 4 and from the east 3 and 5.The one at the bottom and the two sixes by which the dice are touching are not visible, so they are not counted towards total.Bob also has t favourite integers xi, and for every such integer his goal is to build such a tower that the number of visible pips is exactly xi. For each of Bob\'s favourite integers determine whether it is possible to build a tower that has exactly that many visible pips." 1000
1266A "Competitive Programmer" "chinese remainder theorem,math" "Bob is a competitive programmer. He wants to become red, and for that he needs a strict training regime. He went to the annual meeting of grandmasters and asked n of them how much effort they needed to reach red.""Oh, I just spent xi hours solving problems"", said the i-th of them. Bob wants to train his math skills, so for each answer he wrote down the number of minutes (60\xe2\x8b\x85xi), thanked the grandmasters and went home. Bob could write numbers with leading zeroes \xe2\x80\x94 for example, if some grandmaster answered that he had spent 2 hours, Bob could write 000120 instead of 120.Alice wanted to tease Bob and so she took the numbers Bob wrote down, and for each of them she did one of the following independently:   rearranged its digits, or  wrote a random number. This way, Alice generated n numbers, denoted y1, ..., yn.For each of the numbers, help Bob determine whether yi can be a permutation of a number divisible by 60 (possibly with leading zeroes)." 1000
1265E "Beautiful Mirrors" "data structures,dp,math,probabilities" "Creatnx has n mirrors, numbered from 1 to n. Every day, Creatnx asks exactly one mirror ""Am I beautiful?"". The i-th mirror will tell Creatnx that he is beautiful with probability pi100 for all 1\xe2\x89\xa4i\xe2\x89\xa4n.Creatnx asks the mirrors one by one, starting from the 1-st mirror. Every day, if he asks i-th mirror, there are two possibilities:  The i-th mirror tells Creatnx that he is beautiful. In this case, if i=n Creatnx will stop and become happy, otherwise he will continue asking the i+1-th mirror next day;  In the other case, Creatnx will feel upset. The next day, Creatnx will start asking from the 1-st mirror again. You need to calculate the expected number of days until Creatnx becomes happy.This number should be found by modulo 998244353. Formally, let M=998244353. It can be shown that the answer can be expressed as an irreducible fraction pq, where p and q are integers and q\xe2\x89\xa20(modM). Output the integer equal to p\xe2\x8b\x85q\xe2\x88\x921modM. In other words, output such an integer x that 0\xe2\x89\xa4x<M and x\xe2\x8b\x85q\xe2\x89\xa1p(modM)." 2100
1265B "Beautiful Numbers" "data structures,implementation,math,two pointers" "You are given a permutation p=[p1,p2,\xe2\x80\xa6,pn] of integers from 1 to n. Let\'s call the number m (1\xe2\x89\xa4m\xe2\x89\xa4n) beautiful, if there exists two indices l,r (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n), such that the numbers [pl,pl+1,\xe2\x80\xa6,pr] is a permutation of numbers 1,2,\xe2\x80\xa6,m.For example, let p=[4,5,1,3,2,6]. In this case, the numbers 1,3,5,6 are beautiful and 2,4 are not. It is because:  if l=3 and r=3 we will have a permutation [1] for m=1;  if l=3 and r=5 we will have a permutation [1,3,2] for m=3;  if l=1 and r=5 we will have a permutation [4,5,1,3,2] for m=5;  if l=1 and r=6 we will have a permutation [4,5,1,3,2,6] for m=6;  it is impossible to take some l and r, such that [pl,pl+1,\xe2\x80\xa6,pr] is a permutation of numbers 1,2,\xe2\x80\xa6,m for m=2 and for m=4. You are given a permutation p=[p1,p2,\xe2\x80\xa6,pn]. For all m (1\xe2\x89\xa4m\xe2\x89\xa4n) determine if it is a beautiful number or not." 1300
1265A "Beautiful String" "constructive algorithms,greedy" "A string is called beautiful if no two consecutive characters are equal. For example, ""ababcb"", ""a"" and ""abab"" are beautiful strings, while ""aaaaaa"", ""abaa"" and ""bb"" are not.Ahcl wants to construct a beautiful string. He has a string s, consisting of only characters \'a\', \'b\', \'c\' and \'?\'. Ahcl needs to replace each character \'?\' with one of the three characters \'a\', \'b\' or \'c\', such that the resulting string is beautiful. Please help him!More formally, after replacing all characters \'?\', the condition si\xe2\x89\xa0si+1 should be satisfied for all 1\xe2\x89\xa4i\xe2\x89\xa4|s|\xe2\x88\x921, where |s| is the length of the string s." 1000
1264F "Beautiful Fibonacci Problem" "constructive algorithms,number theory" "The well-known Fibonacci sequence F0,F1,F2,\xe2\x80\xa6 is defined as follows:   F0=0,F1=1.  For each i\xe2\x89\xa52: Fi=Fi\xe2\x88\x921+Fi\xe2\x88\x922. Given an increasing arithmetic sequence of positive integers with n elements: (a,a+d,a+2\xe2\x8b\x85d,\xe2\x80\xa6,a+(n\xe2\x88\x921)\xe2\x8b\x85d).You need to find another increasing arithmetic sequence of positive integers with n elements (b,b+e,b+2\xe2\x8b\x85e,\xe2\x80\xa6,b+(n\xe2\x88\x921)\xe2\x8b\x85e) such that:  0<b,e<264,  for all 0\xe2\x89\xa4i<n, the decimal representation of a+i\xe2\x8b\x85d appears as substring in the last 18 digits of the decimal representation of Fb+i\xe2\x8b\x85e (if this number has less than 18 digits, then we consider all its digits)." 3500
1264E "Beautiful League" "constructive algorithms,flows,graph matchings" "A football league has recently begun in Beautiful land. There are n teams participating in the league. Let\'s enumerate them with integers from 1 to n.There will be played exactly n(n\xe2\x88\x921)2 matches: each team will play against all other teams exactly once. In each match, there is always a winner and loser and there is no draw.After all matches are played, the organizers will count the number of beautiful triples. Let\'s call a triple of three teams (A,B,C) beautiful if a team A win against a team B, a team B win against a team C and a team C win against a team A. We look only to a triples of different teams and the order of teams in the triple is important.The beauty of the league is the number of beautiful triples.At the moment, m matches were played and their results are known.What is the maximum beauty of the league that can be, after playing all remaining matches? Also find a possible results for all remaining n(n\xe2\x88\x921)2\xe2\x88\x92m matches, so that the league has this maximum beauty." 2700
1264D2 "Beautiful Bracket Sequence (hard version)" combinatorics,probabilities "This is the hard version of this problem. The only difference is the limit of n - the length of the input string. In this version, 1\xe2\x89\xa4n\xe2\x89\xa4106.Let\'s define a correct bracket sequence and its depth as follow:  An empty string is a correct bracket sequence with depth 0.  If ""s"" is a correct bracket sequence with depth d then ""(s)"" is a correct bracket sequence with depth d+1.  If ""s"" and ""t"" are both correct bracket sequences then their concatenation ""st"" is a correct bracket sequence with depth equal to the maximum depth of s and t. For a (not necessarily correct) bracket sequence s, we define its depth as the maximum depth of any correct bracket sequence induced by removing some characters from s (possibly zero). For example: the bracket sequence s=""())(())"" has depth 2, because by removing the third character we obtain a correct bracket sequence ""()(())"" with depth 2.Given a string a consists of only characters \'(\', \')\' and \'?\'. Consider all (not necessarily correct) bracket sequences obtained by replacing all characters \'?\' in a by either \'(\' or \')\'. Calculate the sum of all the depths of all these bracket sequences. As this number can be large, find it modulo 998244353.Hacks in this problem can be done only if easy and hard versions of this problem was solved." 2900
1264D1 "Beautiful Bracket Sequence (easy version)" combinatorics,dp,probabilities "This is the easy version of this problem. The only difference is the limit of n - the length of the input string. In this version, 1\xe2\x89\xa4n\xe2\x89\xa42000. The hard version of this challenge is not offered in the round for the second division. Let\'s define a correct bracket sequence and its depth as follow:  An empty string is a correct bracket sequence with depth 0.  If ""s"" is a correct bracket sequence with depth d then ""(s)"" is a correct bracket sequence with depth d+1.  If ""s"" and ""t"" are both correct bracket sequences then their concatenation ""st"" is a correct bracket sequence with depth equal to the maximum depth of s and t. For a (not necessarily correct) bracket sequence s, we define its depth as the maximum depth of any correct bracket sequence induced by removing some characters from s (possibly zero). For example: the bracket sequence s=""())(())"" has depth 2, because by removing the third character we obtain a correct bracket sequence ""()(())"" with depth 2.Given a string a consists of only characters \'(\', \')\' and \'?\'. Consider all (not necessarily correct) bracket sequences obtained by replacing all characters \'?\' in a by either \'(\' or \')\'. Calculate the sum of all the depths of all these bracket sequences. As this number can be large, find it modulo 998244353.Hacks in this problem in the first division can be done only if easy and hard versions of this problem was solved." 2600
1264C "Beautiful Mirrors with queries" "data structures,probabilities" "Creatnx has n mirrors, numbered from 1 to n. Every day, Creatnx asks exactly one mirror ""Am I beautiful?"". The i-th mirror will tell Creatnx that he is beautiful with probability pi100 for all 1\xe2\x89\xa4i\xe2\x89\xa4n.Some mirrors are called checkpoints. Initially, only the 1st mirror is a checkpoint. It remains a checkpoint all the time.Creatnx asks the mirrors one by one, starting from the 1-st mirror. Every day, if he asks i-th mirror, there are two possibilities:  The i-th mirror tells Creatnx that he is beautiful. In this case, if i=n Creatnx will stop and become happy, otherwise he will continue asking the i+1-th mirror next day;  In the other case, Creatnx will feel upset. The next day, Creatnx will start asking from the checkpoint with a maximal number that is less or equal to i. There are some changes occur over time: some mirrors become new checkpoints and some mirrors are no longer checkpoints. You are given q queries, each query is represented by an integer u: If the u-th mirror isn\'t a checkpoint then we set it as a checkpoint. Otherwise, the u-th mirror is no longer a checkpoint.After each query, you need to calculate the expected number of days until Creatnx becomes happy.Each of this numbers should be found by modulo 998244353. Formally, let M=998244353. It can be shown that the answer can be expressed as an irreducible fraction pq, where p and q are integers and q\xe2\x89\xa20(modM). Output the integer equal to p\xe2\x8b\x85q\xe2\x88\x921modM. In other words, output such an integer x that 0\xe2\x89\xa4x<M and x\xe2\x8b\x85q\xe2\x89\xa1p(modM)." 2400
1264B "Beautiful Sequence" "brute force,constructive algorithms,greedy" "An integer sequence is called beautiful if the difference between any two consecutive numbers is equal to 1. More formally, a sequence s1,s2,\xe2\x80\xa6,sn is beautiful if |si\xe2\x88\x92si+1|=1 for all 1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921.Trans has a numbers 0, b numbers 1, c numbers 2 and d numbers 3. He wants to construct a beautiful sequence using all of these a+b+c+d numbers.However, it turns out to be a non-trivial task, and Trans was not able to do it. Could you please help Trans?" 1900
1264A "Beautiful Regional Contest" greedy,implementation "So the Beautiful Regional Contest (BeRC) has come to an end! n students took part in the contest. The final standings are already known: the participant in the i-th place solved pi problems. Since the participants are primarily sorted by the number of solved problems, then p1\xe2\x89\xa5p2\xe2\x89\xa5\xe2\x8b\xaf\xe2\x89\xa5pn.Help the jury distribute the gold, silver and bronze medals. Let their numbers be g, s and b, respectively. Here is a list of requirements from the rules, which all must be satisfied:  for each of the three types of medals, at least one medal must be awarded (that is, g>0, s>0 and b>0);  the number of gold medals must be strictly less than the number of silver and the number of bronze (that is, g<s and g<b, but there are no requirements between s and b);  each gold medalist must solve strictly more problems than any awarded with a silver medal;  each silver medalist must solve strictly more problems than any awarded a bronze medal;  each bronze medalist must solve strictly more problems than any participant not awarded a medal;  the total number of medalists g+s+b should not exceed half of all participants (for example, if n=21, then you can award a maximum of 10 participants, and if n=26, then you can award a maximum of 13 participants). The jury wants to reward with medals the total maximal number participants (i.e. to maximize g+s+b) so that all of the items listed above are fulfilled. Help the jury find such a way to award medals." 1500
1263F "Economic Difficulties" "data structures,dfs and similar,dp,flows,graphs,trees" "An electrical grid in Berland palaces consists of 2 grids: main and reserve. Wires in palaces are made of expensive material, so selling some of them would be a good idea!Each grid (main and reserve) has a head node (its number is 1). Every other node gets electricity from the head node. Each node can be reached from the head node by a unique path. Also, both grids have exactly n nodes, which do not spread electricity further.In other words, every grid is a rooted directed tree on n leaves with a root in the node, which number is 1. Each tree has independent enumeration and nodes from one grid are not connected with nodes of another grid.Also, the palace has n electrical devices. Each device is connected with one node of the main grid and with one node of the reserve grid. Devices connect only with nodes, from which electricity is not spread further (these nodes are the tree\'s leaves). Each grid\'s leaf is connected with exactly one device.  In this example the main grid contains 6 nodes (the top tree) and the reserve grid contains 4 nodes (the lower tree). There are 3 devices with numbers colored in blue. It is guaranteed that the whole grid (two grids and n devices) can be shown in this way (like in the picture above):  main grid is a top tree, whose wires are directed \'from the top to the down\',  reserve grid is a lower tree, whose wires are directed \'from the down to the top\',  devicesÂ \xe2\x80\x94 horizontal row between two grids, which are numbered from 1 to n from the left to the right,  wires between nodes do not intersect. Formally, for each tree exists a depth-first search from the node with number 1, that visits leaves in order of connection to devices 1,2,\xe2\x80\xa6,n (firstly, the node, that is connected to the device 1, then the node, that is connected to the device 2, etc.).Businessman wants to sell (remove) maximal amount of wires so that each device will be powered from at least one grid (main or reserve). In other words, for each device should exist at least one path to the head node (in the main grid or the reserve grid), which contains only nodes from one grid." 2400
1263E Editor "data structures,implementation" "The development of a text editor is a hard problem. You need to implement an extra module for brackets coloring in text.Your editor consists of a line with infinite length and cursor, which points to the current character. Please note that it points to only one of the characters (and not between a pair of characters). Thus, it points to an index character. The user can move the cursor left or right one position. If the cursor is already at the first (leftmost) position, then it does not move left.Initially, the cursor is in the first (leftmost) character.Also, the user can write a letter or brackets (either (, or )) to the position that the cursor is currently pointing at. A new character always overwrites the old value at that position.Your editor must check, whether the current line is the correct text. Text is correct if the brackets in them form the correct bracket sequence.Formally, correct text (CT) must satisfy the following rules:   any line without brackets is CT (the line can contain whitespaces);  If the first character of the string \xe2\x80\x94 is (, the last \xe2\x80\x94 is ), and all the rest form a CT, then the whole line is a CT;  two consecutively written CT is also CT. Examples of correct texts: hello(codeforces), round, ((i)(write))edi(tor)s, ( me). Examples of incorrect texts: hello)oops(, round), ((me).The user uses special commands to work with your editor. Each command has its symbol, which must be written to execute this command.The correspondence of commands and characters is as follows:   L \xe2\x80\x94 move the cursor one character to the left (remains in place if it already points to the first character);  R \xe2\x80\x94 move the cursor one character to the right;  any lowercase Latin letter or bracket (( or )) \xe2\x80\x94 write the entered character to the position where the cursor is now. For a complete understanding, take a look at the first example and its illustrations in the note below.You are given a string containing the characters that the user entered. For the brackets coloring module\'s work, after each command you need to:  check if the current text in the editor is a correct text;  if it is, print the least number of colors that required, to color all brackets. If two pairs of brackets are nested (the first in the second or vice versa), then these pairs of brackets should be painted in different colors. If two pairs of brackets are not nested, then they can be painted in different or the same colors. For example, for the bracket sequence ()(())()() the least number of colors is 2, and for the bracket sequence (()(()())())(()) \xe2\x80\x94 is 3.Write a program that prints the minimal number of colors after processing each command." 2100
1263D "Secret Passwords" "dfs and similar,dsu,graphs" "One unknown hacker wants to get the admin\'s password of AtForces testing system, to get problems from the next contest. To achieve that, he sneaked into the administrator\'s office and stole a piece of paper with a list of n passwords \xe2\x80\x94 strings, consists of small Latin letters.Hacker went home and started preparing to hack AtForces. He found that the system contains only passwords from the stolen list and that the system determines the equivalence of the passwords a and b as follows:  two passwords a and b are equivalent if there is a letter, that exists in both a and b;  two passwords a and b are equivalent if there is a password c from the list, which is equivalent to both a and b. If a password is set in the system and an equivalent one is applied to access the system, then the user is accessed into the system.For example, if the list contain passwords ""a"", ""b"", ""ab"", ""d"", then passwords ""a"", ""b"", ""ab"" are equivalent to each other, but the password ""d"" is not equivalent to any other password from list. In other words, if:  admin\'s password is ""b"", then you can access to system by using any of this passwords: ""a"", ""b"", ""ab"";  admin\'s password is ""d"", then you can access to system by using only ""d"". Only one password from the list is the admin\'s password from the testing system. Help hacker to calculate the minimal number of passwords, required to guaranteed access to the system. Keep in mind that the hacker does not know which password is set in the system." 1500
1263C "Everyone is a Winner!" "binary search,math,meet-in-the-middle,number theory" "On the well-known testing system MathForces, a draw of n rating units is arranged. The rating will be distributed according to the following algorithm: if k participants take part in this event, then the n rating is evenly distributed between them and rounded to the nearest lower integer, At the end of the drawing, an unused rating may remainÂ \xe2\x80\x94 it is not given to any of the participants.For example, if n=5 and k=3, then each participant will recieve an 1 rating unit, and also 2 rating units will remain unused. If n=5, and k=6, then none of the participants will increase their rating.Vasya participates in this rating draw but does not have information on the total number of participants in this event. Therefore, he wants to know what different values of the rating increment are possible to get as a result of this draw and asks you for help.For example, if n=5, then the answer is equal to the sequence 0,1,2,5. Each of the sequence values (and only them) can be obtained as \xe2\x8c\x8an/k\xe2\x8c\x8b for some positive integer k (where \xe2\x8c\x8ax\xe2\x8c\x8b is the value of x rounded down): 0=\xe2\x8c\x8a5/7\xe2\x8c\x8b, 1=\xe2\x8c\x8a5/5\xe2\x8c\x8b, 2=\xe2\x8c\x8a5/2\xe2\x8c\x8b, 5=\xe2\x8c\x8a5/1\xe2\x8c\x8b.Write a program that, for a given n, finds a sequence of all possible rating increments." 1400
1263B "PIN Codes" greedy,implementation "A PIN code is a string that consists of exactly 4 digits. Examples of possible PIN codes: 7013, 0000 and 0990. Please note that the PIN code can begin with any digit, even with 0.Polycarp has n (2\xe2\x89\xa4n\xe2\x89\xa410) bank cards, the PIN code of the i-th card is pi.Polycarp has recently read a recommendation that it is better to set different PIN codes on different cards. Thus he wants to change the minimal number of digits in the PIN codes of his cards so that all n codes would become different.Formally, in one step, Polycarp picks i-th card (1\xe2\x89\xa4i\xe2\x89\xa4n), then in its PIN code pi selects one position (from 1 to 4), and changes the digit in this position to any other. He needs to change the minimum number of digits so that all PIN codes become different.Polycarp quickly solved this problem. Can you solve it?" 1400
1263A "Sweet Problem" math "You have three piles of candies: red, green and blue candies:  the first pile contains only red candies and there are r candies in it,  the second pile contains only green candies and there are g candies in it,  the third pile contains only blue candies and there are b candies in it. Each day Tanya eats exactly two candies of different colors. She is free to choose the colors of eaten candies: the only restriction that she can\'t eat two candies of the same color in a day.Find the maximal number of days Tanya can eat candies? Each day she needs to eat exactly two candies." 1100
1261F Xor-Set "bitmasks,divide and conquer,math" "You are given two sets of integers: A and B. You need to output the sum of elements in the set C={x|x=a\xe2\x8a\x95b,a\xe2\x88\x88A,b\xe2\x88\x88B} modulo 998244353, where \xe2\x8a\x95 denotes the bitwise XOR operation. Each number should be counted only once.For example, if A={2,3} and B={2,3} you should count integer 1 only once, despite the fact that you can get it as 3\xe2\x8a\x952 and as 2\xe2\x8a\x953. So the answer for this case is equal to 1+0=1.Let\'s call a segment [l;r] a set of integers {l,l+1,\xe2\x80\xa6,r}.The set A is given as a union of nA segments, the set B is given as a union of nB segments." 3100
1260F "Colored Tree" "data structures,trees" "You\'re given a tree with n vertices. The color of the i-th vertex is hi.The value of the tree is defined as \xe2\x88\x91hi=hj,1\xe2\x89\xa4i<j\xe2\x89\xa4ndis(i,j), where dis(i,j) is the number of edges on the shortest path between i and j. The color of each vertex is lost, you only remember that hi can be any integer from [li,ri](inclusive). You want to calculate the sum of values of all trees meeting these conditions modulo 109+7 (the set of edges is fixed, but each color is unknown, so there are n\xe2\x88\x8fi=1(ri\xe2\x88\x92li+1) different trees)." 2700
1260E Tournament "brute force,dp,greedy" "You are organizing a boxing tournament, where n boxers will participate (n is a power of 2), and your friend is one of them. All boxers have different strength from 1 to n, and boxer i wins in the match against boxer j if and only if i is stronger than j.The tournament will be organized as follows: n boxers will be divided into pairs; the loser in each pair leaves the tournament, and n2 winners advance to the next stage, where they are divided into pairs again, and the winners in all pairs advance to the next stage, and so on, until only one boxer remains (who is declared the winner).Your friend really wants to win the tournament, but he may be not the strongest boxer. To help your friend win the tournament, you may bribe his opponents: if your friend is fighting with a boxer you have bribed, your friend wins even if his strength is lower.Furthermore, during each stage you distribute the boxers into pairs as you wish.The boxer with strength i can be bribed if you pay him ai dollars. What is the minimum number of dollars you have to spend to make your friend win the tournament, provided that you arrange the boxers into pairs during each stage as you wish?" 2400
1260D "A Game with Traps" "binary search,dp,greedy,sortings" "You are playing a computer game, where you lead a party of m soldiers. Each soldier is characterised by his agility ai.The level you are trying to get through can be represented as a straight line segment from point 0 (where you and your squad is initially located) to point n+1 (where the boss is located).The level is filled with k traps. Each trap is represented by three numbers li, ri and di. li is the location of the trap, and di is the danger level of the trap: whenever a soldier with agility lower than di steps on a trap (that is, moves to the point li), he gets instantly killed. Fortunately, you can disarm traps: if you move to the point ri, you disarm this trap, and it no longer poses any danger to your soldiers. Traps don\'t affect you, only your soldiers.You have t seconds to complete the level \xe2\x80\x94 that is, to bring some soldiers from your squad to the boss. Before the level starts, you choose which soldiers will be coming with you, and which soldiers won\'t be. After that, you have to bring all of the chosen soldiers to the boss. To do so, you may perform the following actions:  if your location is x, you may move to x+1 or x\xe2\x88\x921. This action consumes one second;  if your location is x and the location of your squad is x, you may move to x+1 or to x\xe2\x88\x921 with your squad in one second. You may not perform this action if it puts some soldier in danger (i.\xe2\x80\x89e. the point your squad is moving into contains a non-disarmed trap with di greater than agility of some soldier from the squad). This action consumes one second;  if your location is x and there is a trap i with ri=x, you may disarm this trap. This action is done instantly (it consumes no time). Note that after each action both your coordinate and the coordinate of your squad should be integers.You have to choose the maximum number of soldiers such that they all can be brought from the point 0 to the point n+1 (where the boss waits) in no more than t seconds." 1900
1260C "Infinite Fence" "greedy,math,number theory" "You are a rebel leader and you are planning to start a revolution in your country. But the evil Government found out about your plans and set your punishment in the form of correctional labor.You must paint a fence which consists of 10100 planks in two colors in the following way (suppose planks are numbered from left to right from 0):   if the index of the plank is divisible by r (such planks have indices 0, r, 2r and so on) then you must paint it red;  if the index of the plank is divisible by b (such planks have indices 0, b, 2b and so on) then you must paint it blue;  if the index is divisible both by r and b you can choose the color to paint the plank;  otherwise, you don\'t need to paint the plank at all (and it is forbidden to spent paint on it). Furthermore, the Government added one additional restriction to make your punishment worse. Let\'s list all painted planks of the fence in ascending order: if there are k consecutive planks with the same color in this list, then the Government will state that you failed the labor and execute you immediately. If you don\'t paint the fence according to the four aforementioned conditions, you will also be executed.The question is: will you be able to accomplish the labor (the time is not important) or the execution is unavoidable and you need to escape at all costs." 1700
1260B "Obtain Two Zeroes" "binary search,math" "You are given two integers a and b. You may perform any number of operations on them (possibly zero).During each operation you should choose any positive integer x and set a:=a\xe2\x88\x92x, b:=b\xe2\x88\x922x or a:=a\xe2\x88\x922x, b:=b\xe2\x88\x92x. Note that you may choose different values of x in different operations.Is it possible to make a and b equal to 0 simultaneously?Your program should answer t independent test cases." 1300
1260A Heating math "Several days ago you bought a new house and now you are planning to start a renovation. Since winters in your region can be very cold you need to decide how to heat rooms in your house.Your house has n rooms. In the i-th room you can install at most ci heating radiators. Each radiator can have several sections, but the cost of the radiator with k sections is equal to k2 burles.Since rooms can have different sizes, you calculated that you need at least sumi sections in total in the i-th room. For each room calculate the minimum cost to install at most ci radiators with total number of sections not less than sumi." 1000
1257G "Divisor Set" "divide and conquer,fft,greedy,math,number theory" "You are given an integer x represented as a product of n its prime divisors p1\xe2\x8b\x85p2,\xe2\x8b\x85\xe2\x80\xa6\xe2\x8b\x85pn. Let S be the set of all positive integer divisors of x (including 1 and x itself).We call a set of integers D good if (and only if) there is no pair a\xe2\x88\x88D, b\xe2\x88\x88D such that a\xe2\x89\xa0b and a divides b.Find a good subset of S with maximum possible size. Since the answer can be large, print the size of the subset modulo 998244353." 2600
1257F "Make Them Similar" "bitmasks,brute force,hashing,meet-in-the-middle" "Let\'s call two numbers similar if their binary representations contain the same number of digits equal to 1. For example:  2 and 4 are similar (binary representations are 10 and 100);  1337 and 4213 are similar (binary representations are 10100111001 and 1000001110101);  3 and 2 are not similar (binary representations are 11 and 10);  42 and 13 are similar (binary representations are 101010 and 1101). You are given an array of n integers a1, a2, ..., an. You may choose a non-negative integer x, and then get another array of n integers b1, b2, ..., bn, where bi=ai\xe2\x8a\x95x (\xe2\x8a\x95 denotes bitwise XOR).Is it possible to obtain an array b where all numbers are similar to each other?" 2400
1257E "The Contest" "data structures,dp,greedy" "A team of three programmers is going to play a contest. The contest consists of n problems, numbered from 1 to n. Each problem is printed on a separate sheet of paper. The participants have decided to divide the problem statements into three parts: the first programmer took some prefix of the statements (some number of first paper sheets), the third contestant took some suffix of the statements (some number of last paper sheets), and the second contestant took all remaining problems. But something went wrong \xe2\x80\x94 the statements were printed in the wrong order, so the contestants have received the problems in some random order.The first contestant has received problems a1,1,a1,2,\xe2\x80\xa6,a1,k1. The second one has received problems a2,1,a2,2,\xe2\x80\xa6,a2,k2. The third one has received all remaining problems (a3,1,a3,2,\xe2\x80\xa6,a3,k3).The contestants don\'t want to play the contest before they redistribute the statements. They want to redistribute them so that the first contestant receives some prefix of the problemset, the third contestant receives some suffix of the problemset, and the second contestant receives all the remaining problems.During one move, some contestant may give one of their problems to other contestant. What is the minimum number of moves required to redistribute the problems?It is possible that after redistribution some participant (or even two of them) will not have any problems." 2000
1257D "Yet Another Monster Killing Problem" "binary search,data structures,dp,greedy,sortings,two pointers" "You play a computer game. In this game, you lead a party of m heroes, and you have to clear a dungeon with n monsters. Each monster is characterized by its power ai. Each hero is characterized by his power pi and endurance si.The heroes clear the dungeon day by day. In the beginning of each day, you choose a hero (exactly one) who is going to enter the dungeon this day.When the hero enters the dungeon, he is challenged by the first monster which was not defeated during the previous days (so, if the heroes have already defeated k monsters, the hero fights with the monster k+1). When the hero fights the monster, there are two possible outcomes:  if the monster\'s power is strictly greater than the hero\'s power, the hero retreats from the dungeon. The current day ends;  otherwise, the monster is defeated. After defeating a monster, the hero either continues fighting with the next monster or leaves the dungeon. He leaves the dungeon either if he has already defeated the number of monsters equal to his endurance during this day (so, the i-th hero cannot defeat more than si monsters during each day), or if all monsters are defeated \xe2\x80\x94 otherwise, he fights with the next monster. When the hero leaves the dungeon, the current day ends.Your goal is to defeat the last monster. What is the minimum number of days that you need to achieve your goal? Each day you have to use exactly one hero; it is possible that some heroes don\'t fight the monsters at all. Each hero can be used arbitrary number of times." 1700
1257C "Dominated Subarray" "greedy,implementation,sortings,strings,two pointers" "Let\'s call an array t dominated by value v in the next situation.At first, array t should have at least 2 elements. Now, let\'s calculate number of occurrences of each number num in t and define it as occ(num). Then t is dominated (by v) if (and only if) occ(v)>occ(v\xe2\x80\xb2) for any other number v\xe2\x80\xb2. For example, arrays [1,2,3,4,5,2], [11,11] and [3,2,3,2,3] are dominated (by 2, 11 and 3 respectevitely) but arrays [3], [1,2] and [3,3,2,2,1] are not.Small remark: since any array can be dominated only by one number, we can not specify this number and just say that array is either dominated or not.You are given array a1,a2,\xe2\x80\xa6,an. Calculate its shortest dominated subarray or say that there are no such subarrays.The subarray of a is a contiguous part of the array a, i.\xe2\x80\x89e. the array ai,ai+1,\xe2\x80\xa6,aj for some 1\xe2\x89\xa4i\xe2\x89\xa4j\xe2\x89\xa4n." 1200
1257B "Magic Stick" math "Recently Petya walked in the forest and found a magic stick.Since Petya really likes numbers, the first thing he learned was spells for changing numbers. So far, he knows only two spells that can be applied to a positive integer:   If the chosen number a is even, then the spell will turn it into 3a2;  If the chosen number a is greater than one, then the spell will turn it into a\xe2\x88\x921. Note that if the number is even and greater than one, then Petya can choose which spell to apply.Petya now has only one number x. He wants to know if his favorite number y can be obtained from x using the spells he knows. The spells can be used any number of times in any order. It is not required to use spells, Petya can leave x as it is." 1000
1257A "Two Rival Students" greedy,math "You are the gym teacher in the school.There are n students in the row. And there are two rivalling students among them. The first one is in position a, the second in position b. Positions are numbered from 1 to n from left to right.Since they are rivals, you want to maximize the distance between them. If students are in positions p and s respectively, then distance between them is |p\xe2\x88\x92s|. You can do the following operation at most x times: choose two adjacent (neighbouring) students and swap them.Calculate the maximum distance between two rivalling students after at most x swaps." 800
1256F "Equalizing Two Strings" "constructive algorithms,sortings,strings" "You are given two strings s and t both of length n and both consisting of lowercase Latin letters.In one move, you can choose any length len from 1 to n and perform the following operation:   Choose any contiguous substring of the string s of length len and reverse it;  at the same time choose any contiguous substring of the string t of length len and reverse it as well. Note that during one move you reverse exactly one substring of the string s and exactly one substring of the string t.Also note that borders of substrings you reverse in s and in t can be different, the only restriction is that you reverse the substrings of equal length. For example, if len=3 and n=5, you can reverse s[1\xe2\x80\xa63] and t[3\xe2\x80\xa65], s[2\xe2\x80\xa64] and t[2\xe2\x80\xa64], but not s[1\xe2\x80\xa63] and t[1\xe2\x80\xa62].Your task is to say if it is possible to make strings s and t equal after some (possibly, empty) sequence of moves.You have to answer q independent test cases." 2000
1256E "Yet Another Division Into Teams" dp,greedy,sortings "There are n students at your university. The programming skill of the i-th student is ai. As a coach, you want to divide them into teams to prepare them for the upcoming ICPC finals. Just imagine how good this university is if it has 2\xe2\x8b\x85105 students ready for the finals!Each team should consist of at least three students. Each student should belong to exactly one team. The diversity of a team is the difference between the maximum programming skill of some student that belongs to this team and the minimum programming skill of some student that belongs to this team (in other words, if the team consists of k students with programming skills a[i1],a[i2],\xe2\x80\xa6,a[ik], then the diversity of this team is kmaxj=1a[ij]\xe2\x88\x92kminj=1a[ij]).The total diversity is the sum of diversities of all teams formed.Your task is to minimize the total diversity of the division of students and find the optimal way to divide the students." 2000
1256D "Binary String Minimizing" greedy "You are given a binary string of length n (i.\xe2\x80\x89e. a string consisting of n characters \'0\' and \'1\').In one move you can swap two adjacent characters of the string. What is the lexicographically minimum possible string you can obtain from the given one if you can perform no more than k moves? It is possible that you do not perform any moves at all.Note that you can swap the same pair of adjacent characters with indices i and i+1 arbitrary (possibly, zero) number of times. Each such swap is considered a separate move.You have to answer q independent test cases." 1500
1256C "Platforms Jumping" greedy "There is a river of width n. The left bank of the river is cell 0 and the right bank is cell n+1 (more formally, the river can be represented as a sequence of n+2 cells numbered from 0 to n+1). There are also m wooden platforms on a river, the i-th platform has length ci (so the i-th platform takes ci consecutive cells of the river). It is guaranteed that the sum of lengths of platforms does not exceed n.You are standing at 0 and want to reach n+1 somehow. If you are standing at the position x, you can jump to any position in the range [x+1;x+d]. However you don\'t really like the water so you can jump only to such cells that belong to some wooden platform. For example, if d=1, you can jump only to the next position (if it belongs to the wooden platform). You can assume that cells 0 and n+1 belong to wooden platforms.You want to know if it is possible to reach n+1 from 0 if you can move any platform to the left or to the right arbitrary number of times (possibly, zero) as long as they do not intersect each other (but two platforms can touch each other). It also means that you cannot change the relative order of platforms.Note that you should move platforms until you start jumping (in other words, you first move the platforms and then start jumping).For example, if n=7, m=3, d=2 and c=[1,2,1], then one of the ways to reach 8 from 0 is follow:  The first example: n=7." 1700
1256B "Minimize the Permutation" greedy "You are given a permutation of length n. Recall that the permutation is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array) and [1,3,4] is also not a permutation (n=3 but there is 4 in the array).You can perform at most n\xe2\x88\x921 operations with the given permutation (it is possible that you don\'t perform any operations at all). The i-th operation allows you to swap elements of the given permutation on positions i and i+1. Each operation can be performed at most once. The operations can be performed in arbitrary order.Your task is to find the lexicographically minimum possible permutation obtained by performing some of the given operations in some order.You can see the definition of the lexicographical order in the notes section.You have to answer q independent test cases.For example, let\'s consider the permutation [5,4,1,3,2]. The minimum possible permutation we can obtain is [1,5,2,4,3] and we can do it in the following way:  perform the second operation (swap the second and the third elements) and obtain the permutation [5,1,4,3,2];  perform the fourth operation (swap the fourth and the fifth elements) and obtain the permutation [5,1,4,2,3];  perform the third operation (swap the third and the fourth elements) and obtain the permutation [5,1,2,4,3].  perform the first operation (swap the first and the second elements) and obtain the permutation [1,5,2,4,3]; Another example is [1,2,4,3]. The minimum possible permutation we can obtain is [1,2,3,4] by performing the third operation (swap the third and the fourth elements)." 1400
1256A "Payment Without Change" math "You have a coins of value n and b coins of value 1. You always pay in exact change, so you want to know if there exist such x and y that if you take x (0\xe2\x89\xa4x\xe2\x89\xa4a) coins of value n and y (0\xe2\x89\xa4y\xe2\x89\xa4b) coins of value 1, then the total value of taken coins will be S.You have to answer q independent test cases." 1000
1255C "League of Leesins" "constructive algorithms,implementation" "Bob is an avid fan of the video game ""League of Leesins"", and today he celebrates as the League of Leesins World Championship comes to an end! The tournament consisted of n (n\xe2\x89\xa55) teams around the world. Before the tournament starts, Bob has made a prediction of the rankings of each team, from 1-st to n-th. After the final, he compared the prediction with the actual result and found out that the i-th team according to his prediction ended up at the pi-th position (1\xe2\x89\xa4pi\xe2\x89\xa4n, all pi are unique). In other words, p is a permutation of 1,2,\xe2\x80\xa6,n.As Bob\'s favorite League player is the famous ""3ga"", he decided to write down every 3 consecutive elements of the permutation p. Formally, Bob created an array q of n\xe2\x88\x922 triples, where qi=(pi,pi+1,pi+2) for each 1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x922. Bob was very proud of his array, so he showed it to his friend Alice.After learning of Bob\'s array, Alice declared that she could retrieve the permutation p even if Bob rearranges the elements of q and the elements within each triple. Of course, Bob did not believe in such magic, so he did just the same as above to see Alice\'s respond.For example, if n=5 and p=[1,4,2,3,5], then the original array q will be [(1,4,2),(4,2,3),(2,3,5)]. Bob can then rearrange the numbers within each triple and the positions of the triples to get [(4,3,2),(2,3,5),(4,1,2)]. Note that [(1,4,2),(4,2,2),(3,3,5)] is not a valid rearrangement of q, as Bob is not allowed to swap numbers belong to different triples.As Alice\'s friend, you know for sure that Alice was just trying to show off, so you decided to save her some face by giving her any permutation p that is consistent with the array q she was given." 1600
1255B "Fridge Lockers" graphs,implementation "Hanh lives in a shared apartment. There are n people (including Hanh) living there, each has a private fridge. n fridges are secured by several steel chains. Each steel chain connects two different fridges and is protected by a digital lock. The owner of a fridge knows passcodes of all chains connected to it. A fridge can be open only if all chains connected to it are unlocked. For example, if a fridge has no chains connected to it at all, then any of n people can open it.  For exampe, in the picture there are n=4 people and 5 chains. The first person knows passcodes of two chains: 1\xe2\x88\x924 and 1\xe2\x88\x922. The fridge 1 can be open by its owner (the person 1), also two people 2 and 4 (acting together) can open it. The weights of these fridges are a1,a2,\xe2\x80\xa6,an. To make a steel chain connecting fridges u and v, you have to pay au+av dollars. Note that the landlord allows you to create multiple chains connecting the same pair of fridges. Hanh\'s apartment landlord asks you to create exactly m steel chains so that all fridges are private. A fridge is private if and only if, among n people living in the apartment, only the owner can open it (i.e. no other person acting alone can do it). In other words, the fridge i is not private if there exists the person j (i\xe2\x89\xa0j) that the person j can open the fridge i.For example, in the picture all the fridges are private. On the other hand, if there are n=2 fridges and only one chain (which connects them) then both fridges are not private (both fridges can be open not only by its owner but also by another person).Of course, the landlord wants to minimize the total cost of all steel chains to fulfill his request. Determine whether there exists any way to make exactly m chains, and if yes, output any solution that minimizes the total cost." 1100
1255A "Changing Volume" math "Bob watches TV every day. He always sets the volume of his TV to b. However, today he is angry to find out someone has changed the volume to a. Of course, Bob has a remote control that can change the volume.There are six buttons (\xe2\x88\x925,\xe2\x88\x922,\xe2\x88\x921,+1,+2,+5) on the control, which in one press can either increase or decrease the current volume by 1, 2, or 5. The volume can be arbitrarily large, but can never be negative. In other words, Bob cannot press the button if it causes the volume to be lower than 0.As Bob is so angry, he wants to change the volume to b using as few button presses as possible. However, he forgets how to do such simple calculations, so he asks you for help. Write a program that given a and b, finds the minimum number of presses to change the TV volume from a to b." 800
1254E "Send Tree to Charlie" "combinatorics,dfs and similar,dsu,trees" "Christmas was knocking on the door, and our protagonist, Bob, was preparing a spectacular present for his long-time second best friend Charlie. As chocolate boxes are lame, he decided to decorate a tree instead. Bob\'s tree can be represented as an undirected connected graph with n nodes (numbered 1 to n) and n\xe2\x88\x921 edges. Initially, Bob placed a decoration with label i on node i, for each 1\xe2\x89\xa4i\xe2\x89\xa4n. However, as such a simple arrangement is lame, he decided to shuffle the decorations a bit. Formally, Bob did the following steps: First, he listed the n\xe2\x88\x921 edges in some order. Then, he considered the edges one by one in that order. For each edge (u,v), he swapped the decorations of node u with the one of node v.After finishing, Bob seemed satisfied with the arrangement, so he went to sleep.The next morning, Bob wakes up only to find out that his beautiful arrangement has been ruined! Last night, Bob\'s younger brother Bobo dropped some of the decorations on the floor while he was playing with the tree. Fortunately, no decorations were lost, so Bob can repair the tree in no time. However, he completely forgets how the tree looked like yesterday. Therefore, given the labels of the decorations still on the tree, Bob wants to know the number of possible configurations of the tree. As the result can be quite large, Bob will be happy if you can output the result modulo 1000000007 (109+7). Note that, it is possible that there exists no possible configurations." 3300
1254D "Tree Queries" "data structures,probabilities,trees" "Hanh is a famous biologist. He loves growing trees and doing experiments on his own garden.One day, he got a tree consisting of n vertices. Vertices are numbered from 1 to n. A tree with n vertices is an undirected connected graph with n\xe2\x88\x921 edges. Initially, Hanh sets the value of every vertex to 0.Now, Hanh performs q operations, each is either of the following types:   Type 1: Hanh selects a vertex v and an integer d. Then he chooses some vertex r uniformly at random, lists all vertices u such that the path from r to u passes through v. Hanh then increases the value of all such vertices u by d.  Type 2: Hanh selects a vertex v and calculates the expected value of v. Since Hanh is good at biology but not math, he needs your help on these operations." 2700
1254C "Point Ordering" "constructive algorithms,geometry,interactive,math" "This is an interactive problem.Khanh has n points on the Cartesian plane, denoted by a1,a2,\xe2\x80\xa6,an. All points\' coordinates are integers between \xe2\x88\x92109 and 109, inclusive. No three points are collinear. He says that these points are vertices of a convex polygon; in other words, there exists a permutation p1,p2,\xe2\x80\xa6,pn of integers from 1 to n such that the polygon ap1ap2\xe2\x80\xa6apn is convex and vertices are listed in counter-clockwise order.Khanh gives you the number n, but hides the coordinates of his points. Your task is to guess the above permutation by asking multiple queries. In each query, you give Khanh 4 integers t, i, j, k; where either t=1 or t=2; and i, j, k are three distinct indices from 1 to n, inclusive. In response, Khanh tells you:  if t=1, the area of the triangle aiajak multiplied by 2.  if t=2, the sign of the cross product of two vectors \xe2\x86\x92aiaj and \xe2\x86\x92aiak. Recall that the cross product of vector \xe2\x86\x92a=(xa,ya) and vector \xe2\x86\x92b=(xb,yb) is the integer xa\xe2\x8b\x85yb\xe2\x88\x92xb\xe2\x8b\x85ya. The sign of a number is 1 it it is positive, and \xe2\x88\x921 otherwise. It can be proven that the cross product obtained in the above queries can not be 0.You can ask at most 3\xe2\x8b\x85n queries.Please note that Khanh fixes the coordinates of his points and does not change it while answering your queries. You do not need to guess the coordinates. In your permutation ap1ap2\xe2\x80\xa6apn, p1 should be equal to 1 and the indices of vertices should be listed in counter-clockwise order." 2300
1254B2 "Send Boxes to Alice (Hard Version)" "constructive algorithms,greedy,math,number theory,ternary search,two pointers" "This is the harder version of the problem. In this version, 1\xe2\x89\xa4n\xe2\x89\xa4106 and 0\xe2\x89\xa4ai\xe2\x89\xa4106. You can hack this problem if you locked it. But you can hack the previous problem only if you locked both problemsChristmas is coming, and our protagonist, Bob, is preparing a spectacular present for his long-time best friend Alice. This year, he decides to prepare n boxes of chocolate, numbered from 1 to n. Initially, the i-th box contains ai chocolate pieces.Since Bob is a typical nice guy, he will not send Alice n empty boxes. In other words, at least one of a1,a2,\xe2\x80\xa6,an is positive. Since Alice dislikes coprime sets, she will be happy only if there exists some integer k>1 such that the number of pieces in each box is divisible by k. Note that Alice won\'t mind if there exists some empty boxes. Charlie, Alice\'s boyfriend, also is Bob\'s second best friend, so he decides to help Bob by rearranging the chocolate pieces. In one second, Charlie can pick up a piece in box i and put it into either box i\xe2\x88\x921 or box i+1 (if such boxes exist). Of course, he wants to help his friend as quickly as possible. Therefore, he asks you to calculate the minimum number of seconds he would need to make Alice happy." 2100
1254B1 "Send Boxes to Alice (Easy Version)" "constructive algorithms,greedy,math,number theory,ternary search,two pointers" "This is the easier version of the problem. In this version, 1\xe2\x89\xa4n\xe2\x89\xa4105 and 0\xe2\x89\xa4ai\xe2\x89\xa41. You can hack this problem only if you solve and lock both problems.Christmas is coming, and our protagonist, Bob, is preparing a spectacular present for his long-time best friend Alice. This year, he decides to prepare n boxes of chocolate, numbered from 1 to n. Initially, the i-th box contains ai chocolate pieces.Since Bob is a typical nice guy, he will not send Alice n empty boxes. In other words, at least one of a1,a2,\xe2\x80\xa6,an is positive. Since Alice dislikes coprime sets, she will be happy only if there exists some integer k>1 such that the number of pieces in each box is divisible by k. Note that Alice won\'t mind if there exists some empty boxes. Charlie, Alice\'s boyfriend, also is Bob\'s second best friend, so he decides to help Bob by rearranging the chocolate pieces. In one second, Charlie can pick up a piece in box i and put it into either box i\xe2\x88\x921 or box i+1 (if such boxes exist). Of course, he wants to help his friend as quickly as possible. Therefore, he asks you to calculate the minimum number of seconds he would need to make Alice happy." 1800
1254A "Feeding Chicken" "constructive algorithms,greedy,implementation" "Long is a huge fan of CFC (Codeforces Fried Chicken). But the price of CFC is increasing, so he decides to breed the chicken on his own farm.His farm is presented by a rectangle grid with r rows and c columns. Some of these cells contain rice, others are empty. k chickens are living on his farm. The number of chickens is not greater than the number of cells with rice on the farm.Long wants to give his chicken playgrounds by assigning these farm cells to his chickens. He would like to satisfy the following requirements:  Each cell of the farm is assigned to exactly one chicken.  Each chicken is assigned at least one cell.  The set of cells assigned to every chicken forms a connected area. More precisely, if two cells (x,y) and (u,v) are assigned to the same chicken, this chicken is able to walk from (x,y) to (u,v) by passing only its cells and moving from each cell to another cell sharing a side. Long also wants to prevent his chickens from fighting for food. Hence he wants the difference between the maximum and the minimum number of cells with rice assigned to a chicken to be as small as possible. Please help him." 1700
1253F "Cheap Robot" "binary search,dsu,graphs,shortest paths,trees" "You\'re given a simple, undirected, connected, weighted graph with n nodes and m edges.Nodes are numbered from 1 to n. There are exactly k centrals (recharge points), which are nodes 1,2,\xe2\x80\xa6,k.We consider a robot moving into this graph, with a battery of capacity c, not fixed by the constructor yet. At any time, the battery contains an integer amount x of energy between 0 and c inclusive.Traversing an edge of weight wi is possible only if x\xe2\x89\xa5wi, and costs wi energy points (x:=x\xe2\x88\x92wi).Moreover, when the robot reaches a central, its battery is entirely recharged (x:=c).You\'re given q independent missions, the i-th mission requires to move the robot from central ai to central bi.For each mission, you should tell the minimum capacity required to acheive it." 2500
1253E "Antenna Coverage" "data structures,dp,greedy,sortings" "The mayor of the Central Town wants to modernize Central Street, represented in this problem by the (Ox) axis.On this street, there are n antennas, numbered from 1 to n. The i-th antenna lies on the position xi and has an initial scope of si: it covers all integer positions inside the interval [xi\xe2\x88\x92si;xi+si].It is possible to increment the scope of any antenna by 1, this operation costs 1 coin. We can do this operation as much as we want (multiple times on the same antenna if we want).To modernize the street, we need to make all integer positions from 1 to m inclusive covered by at least one antenna. Note that it is authorized to cover positions outside [1;m], even if it\'s not required.What is the minimum amount of coins needed to achieve this modernization?" 2200
1253D "Harmonious Graph" "constructive algorithms,dfs and similar,dsu,graphs,greedy,sortings" "You\'re given an undirected graph with n nodes and m edges. Nodes are numbered from 1 to n.The graph is considered harmonious if and only if the following property holds:  For every triple of integers (l,m,r) such that 1\xe2\x89\xa4l<m<r\xe2\x89\xa4n, if there exists a path going from node l to node r, then there exists a path going from node l to node m. In other words, in a harmonious graph, if from a node l we can reach a node r through edges (l<r), then we should able to reach nodes (l+1),(l+2),\xe2\x80\xa6,(r\xe2\x88\x921) too.What is the minimum number of edges we need to add to make the graph harmonious?" 1700
1253C "Sweets Eating" dp,greedy,math,sortings "Tsumugi brought n delicious sweets to the Light Music Club. They are numbered from 1 to n, where the i-th sweet has a sugar concentration described by an integer ai.Yui loves sweets, but she can eat at most m sweets each day for health reasons.Days are 1-indexed (numbered 1,2,3,\xe2\x80\xa6). Eating the sweet i at the d-th day will cause a sugar penalty of (d\xe2\x8b\x85ai), as sweets become more sugary with time. A sweet can be eaten at most once.The total sugar penalty will be the sum of the individual penalties of each sweet eaten.Suppose that Yui chooses exactly k sweets, and eats them in any order she wants. What is the minimum total sugar penalty she can get?Since Yui is an undecided girl, she wants you to answer this question for every value of k between 1 and n." 1500
1253B "Silly Mistake" greedy,implementation "The Central Company has an office with a sophisticated security system. There are 106 employees, numbered from 1 to 106.The security system logs entrances and departures. The entrance of the i-th employee is denoted by the integer i, while the departure of the i-th employee is denoted by the integer \xe2\x88\x92i.The company has some strict rules about access to its office:  An employee can enter the office at most once per day.  He obviously can\'t leave the office if he didn\'t enter it earlier that day.  In the beginning and at the end of every day, the office is empty (employees can\'t stay at night). It may also be empty at any moment of the day. Any array of events satisfying these conditions is called a valid day.Some examples of valid or invalid days:  [1,7,\xe2\x88\x927,3,\xe2\x88\x921,\xe2\x88\x923] is a valid day (1 enters, 7 enters, 7 leaves, 3 enters, 1 leaves, 3 leaves).  [2,\xe2\x88\x922,3,\xe2\x88\x923] is also a valid day.  [2,5,\xe2\x88\x925,5,\xe2\x88\x925,\xe2\x88\x922] is not a valid day, because 5 entered the office twice during the same day.  [\xe2\x88\x924,4] is not a valid day, because 4 left the office without being in it.  [4] is not a valid day, because 4 entered the office and didn\'t leave it before the end of the day. There are n events a1,a2,\xe2\x80\xa6,an, in the order they occurred. This array corresponds to one or more consecutive days. The system administrator erased the dates of events by mistake, but he didn\'t change the order of the events.You must partition (to cut) the array a of events into contiguous subarrays, which must represent non-empty valid days (or say that it\'s impossible). Each array element should belong to exactly one contiguous subarray of a partition. Each contiguous subarray of a partition should be a valid day.For example, if n=8 and a=[1,\xe2\x88\x921,1,2,\xe2\x88\x921,\xe2\x88\x922,3,\xe2\x88\x923] then he can partition it into two contiguous subarrays which are valid days: a=[1,\xe2\x88\x921Â |Â 1,2,\xe2\x88\x921,\xe2\x88\x922,3,\xe2\x88\x923].Help the administrator to partition the given array a in the required way or report that it is impossible to do. Find any required partition, you should not minimize or maximize the number of parts." 1400
1253A "Single Push" implementation "You\'re given two arrays a[1\xe2\x80\xa6n] and b[1\xe2\x80\xa6n], both of the same length n.In order to perform a push operation, you have to choose three integers l,r,k satisfying 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n and k>0. Then, you will add k to elements al,al+1,\xe2\x80\xa6,ar.For example, if a=[3,7,1,4,1,2] and you choose (l=3,r=5,k=2), the array a will become [3,7,3,6,3_,2].You can do this operation at most once. Can you make array a equal to array b?(We consider that a=b if and only if, for every 1\xe2\x89\xa4i\xe2\x89\xa4n, ai=bi)" 1000
1252L "Road Construction" flows,graphs "There are N cities in the country of Numbata, numbered from 1 to N. Currently, there is no road connecting them. Therefore, each of these N cities proposes a road candidate to be constructed.City i likes to connect with city Ai, so city i proposes to add a direct bidirectional road connecting city i and city Ai. It is guaranteed that no two cities like to connect with each other. In other words, there is no pair of integers i and j where Ai=j and Aj=i. It is also guaranteed that any pair of cities are connected by a sequence of road proposals. In other words, if all proposed roads are constructed, then any pair of cities are connected by a sequence of constructed road.City i also prefers the road to be constructed using a specific material. Each material can be represented by an integer (for example, 0 for asphalt, 1 for wood, etc.). The material that can be used for the road connecting city i and city Ai is represented by an array Bi containing Mi integers: [(Bi)1,(Bi)2,\xe2\x80\xa6,(Bi)Mi]. This means that the road connecting city i and city Ai can be constructed with either of the material in Bi.There are K workers to construct the roads. Each worker is only familiar with one material, thus can only construct a road with a specific material. In particular, the ith worker can only construct a road with material Ci. Each worker can only construct at most one road. You want to assign each worker to construct a road such that any pair of cities are connected by a sequence of constructed road." 2300
1252K "Addition Robot" "data structures,math,matrices" "Adding two numbers several times is a time-consuming task, so you want to build a robot. The robot should have a string S=S1S2\xe2\x80\xa6SN of N characters on its memory that represents addition instructions. Each character of the string, Si, is either \'A\' or \'B\'.You want to be able to give Q commands to the robot, each command is either of the following types:   1 L R. The robot should toggle all the characters of Si where L\xe2\x89\xa4i\xe2\x89\xa4R. Toggling a character means changing it to \'A\' if it was previously \'B\', or changing it to \'B\' if it was previously \'A\'.  2 L R A B. The robot should call f(L,R,A,B) and return two integers as defined in the following pseudocode:     function f(L, R, A, B):      FOR i from L to R        if S[i] = \'A\'          A = A + B        else          B = A + B      return (A, B)   You want to implement the robot\'s expected behavior." 2100
1252J "Tiling Terrace" "brute force,dp" "Talia has just bought an abandoned house in the outskirt of Jakarta. The house has a nice and long yard which can be represented as a one-dimensional grid containing 1\xc3\x97N cells. To beautify the house, Talia is going to build a terrace on the yard by tiling the cells. Each cell on the yard contains either soil (represented by the character \'.\') or rock (represented by the character \'#\'), and there are at most 50 cells containing rocks.Being a superstitious person, Talia wants to tile the terrace with mystical tiles that have the power to repel ghosts. There are three types of mystical tiles:   Type-1: Covers 1\xc3\x971 cell and can only be placed on a soil cell (""."").  Type-2: Covers 1\xc3\x972 cells and can only be placed on two consecutive soil cells ("".."").  Type-3: Covers 1\xc3\x973 cells and can only be placed on consecutive soil-rock-soil cells ("".#.""). Each tile of Type-1, Type-2, and Type-3 has the power to repel G1, G2, and G3 ghosts per day, respectively. There are also some mystical rules which must be followed for the power to be effective:   There should be no overlapping tiles, i.e. each cell is covered by at most one tile.  There should be at most K tiles of Type-1, while there are no limitations for tiles of Type-2 and Type-3. Talia is scared of ghosts, thus, the terrace (which is tiled by mystical tiles) should be able to repel as many ghosts as possible. Help Talia to find the maximum number of ghosts that can be repelled per day by the terrace. Note that Talia does not need to tile all the cells on the yard as long as the number of ghosts that can be repelled by the terrace is maximum." 2300
1252I "Mission Possible" NA "Allen, a government secret service, has been assigned to infiltrate a mafia secret base to uncover crucial information regarding the mafia\'s operations.The secret base is a rectangular bounded by (xL,yL), (xL,yR), (xR,yL), and (xR,yR) in a Cartesian coordinate system where xL<xR and yL<yR. There are N sensors placed inside the secret base. The ith sensor is located at (xi,yi) and has an effective sensing radius of ri which can detect any person who is strictly within the radius of ri from (xi,yi). In other words, the ith sensor can detect a person at location (xa,ya) if and only if the Euclidean distance of (xi,yi) and (xa,ya) is strictly less than ri. It is also known that the Euclidean distance of any two sensors i and j is strictly larger than ri+rj. Note that the Euclidean distance of two points, (xa,ya) and (xb,yb), is \xe2\x88\x9a|xa\xe2\x88\x92xb|2+|ya\xe2\x88\x92yb|2.Allen begins his infiltration mission at location (xs,ys), and his target is located at (xt,yt). Allen has the power to run extremely fast in a straight line while he needs to spend extra time to change his running trajectory (to adjust his footing). Although he is a fast runner, he still needs to make sure that none of the sensors detect him while he is running, i.e. there is no point in his running trajectory which is strictly within a sensor effective sensing radius.Let P={(xp1,yp1),\xe2\x80\xa6,(xp|P|,yp|P|)} be the set of locations where Allen changes his running trajectory, thus, Allen\'s running trajectory with P is (xs,ys)\xe2\x86\x92(xp1,yp1)\xe2\x86\x92\xe2\x8b\xaf\xe2\x86\x92(xp|P|,yp|P|)\xe2\x86\x92(xt,yt) where (xa,ya)\xe2\x86\x92(xb,yb) implies that Allen is running from (xa,ya) to (xb,yb) in a straight line. The set P is feasible if and only if with P, Allen is not detected by any sensor and is not running out of the secret base (although, Allen is allowed to run along the secret base perimeter). Note that xp and yp, (xp,yp)\xe2\x88\x88P, are not necessarily integers; they can be real numbers.Your task in this problem is to find any one feasible P which contains no more than 1000 points." 3000
1252H "Twin Buildings" greedy,implementation "As you might already know, space has always been a problem in ICPC Jakarta. To cope with this, ICPC Jakarta is planning to build two new buildings. These buildings should have a shape of a rectangle of the same size. Now, their problem is to find land to build the buildings.There are N lands available for sale. The ith land has a rectangular shape of size Li\xc3\x97Wi. For a good feng shui, the building\'s side should be parallel to the land\'s sides.One way is to build the two buildings on two different lands, one on each land (not necessarily with the same orientation). A building of size A\xc3\x97B can be build on the ith land if and only if at least one of the following is satisfied:   A\xe2\x89\xa4Li and B\xe2\x89\xa4Wi, or  A\xe2\x89\xa4Wi and B\xe2\x89\xa4Li.  Alternatively, it is also possible to build two buildings of A\xc3\x97B on the ith land with the same orientation. Formally, it is possible to build two buildings of A\xc3\x97B on the ith land if and only if at least one of the following is satisfied:   A\xc3\x972\xe2\x89\xa4Li and B\xe2\x89\xa4Wi, or  A\xc3\x972\xe2\x89\xa4Wi and B\xe2\x89\xa4Li, or  A\xe2\x89\xa4Li and B\xc3\x972\xe2\x89\xa4Wi, or  A\xe2\x89\xa4Wi and B\xc3\x972\xe2\x89\xa4Li. Your task in this problem is to help ICPC Jakarta to figure out the largest possible buildings they can build given N available lands. Note that ICPC Jakarta has to build two buildings of A\xc3\x97B; output the largest possible for A\xc3\x97B." 1800
1252G "Performance Review" "data structures" "Randall is a software engineer at a company with N employees. Every year, the company re-evaluates its employees. At the end of every year, the company replaces its several worst-performing employees and replaces with the same number of new employees, so that the company keeps having N employees. Each person has a constant performance and can be represented by an integer (higher integer means better performance), and no two people have the same performance.The performance of the initial employees are represented by an array of integers A=[A1,A2,\xe2\x80\xa6,AN] where Ai is the performance of the ith employee. Randall is employee 1, so his performance is A1. We will consider the first M years. At the end of the ith year, the company replaces its Ri worst-performing employees and replaces with Ri new employees. The performance of these new employees are represented by an array of integers Bi=[(Bi)1,(Bi)2,\xe2\x80\xa6,(Bi)Ri] where (Bi)j is the performance of the jth new employee.He will consider Q scenarios. On the ith scenario, he will change the value of (BXi)Yi to Zi. For each scenario, Randall is wondering whether he will still be in the company after M years. Note that the changes in each scenario are kept for the subsequent scenarios." 2100
1252F "Regular Forestation" hashing,trees "A forestation is an act of planting a bunch of trees to grow a forest, usually to replace a forest that had been cut down. Strangely enough, graph theorists have another idea on how to make a forest, i.e. by cutting down a tree!A tree is a graph of N nodes connected by N\xe2\x88\x921 edges. Let u be a node in a tree U which degree is at least 2 (i.e. directly connected to at least 2 other nodes in U). If we remove u from U, then we will get two or more disconnected (smaller) trees, or also known as forest by graph theorists. In this problem, we are going to investigate a special forestation of a tree done by graph theorists.Let V(S) be the set of nodes in a tree S and V(T) be the set of nodes in a tree T. Tree S and tree T are identical if there exists a bijection f:V(S)\xe2\x86\x92V(T) such that for all pairs of nodes (si,sj) in V(S), si and sj is connected by an edge in S if and only if node f(si) and f(sj) is connected by an edge in T. Note that f(s)=t implies node s in S corresponds to node t in T.We call a node u in a tree U as a good cutting point if and only if the removal of u from U causes two or more disconnected trees, and all those disconnected trees are pairwise identical.Given a tree U, your task is to determine whether there exists a good cutting point in U. If there is such a node, then you should output the maximum number of disconnected trees that can be obtained by removing exactly one good cutting point.For example, consider the following tree of 13 nodes.There is exactly one good cutting point in this tree, i.e. node 4. Observe that by removing node 4, we will get three identical trees (in this case, line graphs), i.e. {5,1,7,13}, {8,2,11,6}, and {3,12,9,10}, which are denoted by A, B, and C respectively in the figure.   The bijection function between A and B: f(5)=8, f(1)=2, f(7)=11, and f(13)=6.  The bijection function between A and C: f(5)=3, f(1)=12, f(7)=9, and f(13)=10.  The bijection function between B and C: f(8)=3, f(2)=12, f(11)=9, and f(6)=10.  Of course, there exists other bijection functions for those trees." 2400
1252E Songwriter "greedy,two pointers" "Andi is a mathematician, a computer scientist, and a songwriter. After spending so much time writing songs, he finally writes a catchy melody that he thought as his best creation. However, the singer who will sing the song/melody has a unique vocal range, thus, an adjustment may be needed.A melody is defined as a sequence of N notes which are represented by integers. Let A be the original melody written by Andi. Andi needs to adjust A into a new melody B such that for every i where 1\xe2\x89\xa4i<N:   If Ai<Ai+1, then Bi<Bi+1.  If Ai=Ai+1, then Bi=Bi+1.  If Ai>Ai+1, then Bi>Bi+1.  |Bi\xe2\x88\x92Bi+1|\xe2\x89\xa4K, i.e. the difference between two successive notes is no larger than K.  Moreover, the singer also requires that all notes are within her vocal range, i.e. L\xe2\x89\xa4Bi\xe2\x89\xa4R for all 1\xe2\x89\xa4i\xe2\x89\xa4N.Help Andi to determine whether such B exists, and find the lexicographically smallest B if it exists. A melody X is lexicographically smaller than melody Y if and only if there exists j (1\xe2\x89\xa4j\xe2\x89\xa4N) such that Xi=Yi for all i<j and Xj<Yj.For example, consider a melody A={1,3,5,6,7,8,9,10,3,7,8,9,10,11,12,12} as shown in the following figure. The diagonal arrow up in the figure implies that Ai<Ai+1, the straight right arrow implies that Ai=Ai+1, and the diagonal arrow down implies that Ai>Ai+1.  Supposed we want to make a new melody with L=1, R=8, and K=6. The new melody B={1,2,3,4,5,6,7,8,2,3,4,5,6,7,8,8} as shown in the figure satisfies all the requirements, and it is the lexicographically smallest possible." 2200
1252D "Find String in a Grid" "data structures,dp,strings,trees" "You have a grid G containing R rows (numbered from 1 to R, top to bottom) and C columns (numbered from 1 to C, left to right) of uppercase characters. The character in the rth row and the cth column is denoted by Gr,c. You also have Q strings containing uppercase characters. For each of the string, you want to find the number of occurrences of the string in the grid.An occurrence of string S in the grid is counted if S can be constructed by starting at one of the cells in the grid, going right 0 or more times, and then going down 0 or more times. Two occurrences are different if the set of cells used to construct the string is different. Formally, for each string S, you would like to count the number of tuples \xe2\x9f\xa8r,c,\xce\x94r,\xce\x94c\xe2\x9f\xa9 such that:   1\xe2\x89\xa4r\xe2\x89\xa4R and r\xe2\x89\xa4r+\xce\x94r\xe2\x89\xa4R  1\xe2\x89\xa4c\xe2\x89\xa4C and c\xe2\x89\xa4c+\xce\x94c\xe2\x89\xa4C  S=Gr,cGr,c+1\xe2\x80\xa6Gr,c+\xce\x94cGr+1,c+\xce\x94c\xe2\x80\xa6Gr+\xce\x94r,c+\xce\x94c" 3000
1252C "Even Path" "data structures,implementation" "Pathfinding is a task of finding a route between two points. It often appears in many problems. For example, in a GPS navigation software where a driver can query for a suggested route, or in a robot motion planning where it should find a valid sequence of movements to do some tasks, or in a simple maze solver where it should find a valid path from one point to another point. This problem is related to solving a maze.The maze considered in this problem is in the form of a matrix of integers A of N\xc3\x97N. The value of each cell is generated from a given array R and C of N integers each. Specifically, the value on the ith row and jth column, cell (i,j), is equal to Ri+Cj. Note that all indexes in this problem are from 1 to N.A path in this maze is defined as a sequence of cells (r1,c1),(r2,c2),\xe2\x80\xa6,(rk,ck) such that |ri\xe2\x88\x92ri+1|+|ci\xe2\x88\x92ci+1|=1 for all 1\xe2\x89\xa4i<k. In other words, each adjacent cell differs only by 1 row or only by 1 column. An even path in this maze is defined as a path in which all the cells in the path contain only even numbers.Given a tuple \xe2\x9f\xa8ra,ca,rb,cb\xe2\x9f\xa9 as a query, your task is to determine whether there exists an even path from cell (ra,ca) to cell (rb,cb). To simplify the problem, it is guaranteed that both cell (ra,ca) and cell (rb,cb) contain even numbers.For example, let N=5, R={6,2,7,8,3}, and C={3,4,8,5,1}. The following figure depicts the matrix A of 5\xc3\x975 which is generated from the given array R and C.  Let us consider several queries:   \xe2\x9f\xa82,2,1,3\xe2\x9f\xa9: There is an even path from cell (2,2) to cell (1,3), e.g., (2,2),(2,3),(1,3). Of course, (2,2),(1,2),(1,3) is also a valid even path.  \xe2\x9f\xa84,2,4,3\xe2\x9f\xa9: There is an even path from cell (4,2) to cell (4,3), namely (4,2),(4,3).  \xe2\x9f\xa85,1,3,4\xe2\x9f\xa9: There is no even path from cell (5,1) to cell (3,4). Observe that the only two neighboring cells of (5,1) are cell (5,2) and cell (4,1), and both of them contain odd numbers (7 and 11, respectively), thus, there cannot be any even path originating from cell (5,1)." 1600
1252B "Cleaning Robots" dp,trees "The new ICPC town has N junctions (numbered from 1 to N) which are connected by N\xe2\x88\x921 roads. It is possible from one junction to go to any other junctions by going through one or more roads. To make sure all the junctions are well-maintained, the government environment agency is planning to deploy their newest advanced cleaning robots. In addition to its cleaning ability, each robot is also equipped with a movement ability such that it can move from one junction to any other junctions connected by roads. However, as you might have guessed, such robots are not cheap. Therefore, the agency is considering the following deployment plan.Let Tk be the set of junctions which should be cleaned by the kth robot (also known as, the robot\'s task), and |Tk|\xe2\x89\xa51 be the number of junctions in Tk. The junctions in Tk form a path, i.e. there exists a sequence of v1,v2,\xe2\x80\xa6,v|Tk| where vi\xe2\x88\x88Tk and vi\xe2\x89\xa0vj for all i\xe2\x89\xa0j such that each adjacent junction in this sequence is connected by a road. The union of T for all robots is equal to the set of all junctions in ICPC town. On the other hand, no two robots share a common junction, i.e. Ti\xe2\x88\xa9Tj=\xe2\x88\x85 if i\xe2\x89\xa0j.To avoid complaints from citizens for an inefficient operation, the deployment plan should be irreducible; in other words, there should be no two robots, i and j, such that Ti\xe2\x88\xaaTj forms a (longer) path. Note that the agency does not care whether the number of robots being used is minimized as long as all the tasks are irreducible.Your task in this problem is to count the number of feasible deployment plan given the town\'s layout. A plan is feasible if and only if it satisfies all the above-mentioned requirements.For example, let N=6 and the roads are {(1,3),(2,3),(3,4),(4,5),(4,6)}. There are 5 feasible deployment plans as shown in the following figure.   The first plan uses 2 robots (labeled as A and B in the figure) to clean {1,2,3} and {4,5,6}.  The second plan uses 3 robots (labeled as A, B, and C in the figure) to clean {1,3,4,6}, {2}, and {5}.  The third plan uses 3 robots to clean {1,3,4,5}, {2}, and {6}.  The fourth plan uses 3 robots to clean {1}, {2,3,4,6}, and {5}.  The fifth plan uses 3 robots to clean {1}, {2,3,4,5}, and {6}.  No other plans are feasible in this case. For example, the plan {{1,3},{2},{4,5,6}} is not feasible as the task {1,3} and {2} can be combined into a longer path {1,3,2}. The plan {{1,2,3,4},{5},{6}} is also not feasible as {1,2,3,4} is not a path." 2300
1252A "Copying Homework" NA "Danang and Darto are classmates. They are given homework to create a permutation of N integers from 1 to N. Danang has completed the homework and created a permutation A of N integers. Darto wants to copy Danang\'s homework, but Danang asks Darto to change it up a bit so it does not look obvious that Darto copied.The difference of two permutations of N integers A and B, denoted by diff(A,B), is the sum of the absolute difference of Ai and Bi for all i. In other words, diff(A,B)=\xce\xa3Ni=1|Ai\xe2\x88\x92Bi|. Darto would like to create a permutation of N integers that maximizes its difference with A. Formally, he wants to find a permutation of N integers Bmax such that diff(A,Bmax)\xe2\x89\xa5diff(A,B\xe2\x80\xb2) for all permutation of N integers B\xe2\x80\xb2.Darto needs your help! Since the teacher giving the homework is lenient, any permutation of N integers B is considered different with A if the difference of A and B is at least N. Therefore, you are allowed to return any permutation of N integers B such that diff(A,B)\xe2\x89\xa5N.Of course, you can still return Bmax if you want, since it can be proven that diff(A,Bmax)\xe2\x89\xa5N for any permutation A and N>1. This also proves that there exists a solution for any permutation of N integers A. If there is more than one valid solution, you can output any of them." 1000
1251F "Red-White Fence" combinatorics,fft "Polycarp wants to build a fence near his house. He has n white boards and k red boards he can use to build it. Each board is characterised by its length, which is an integer.A good fence should consist of exactly one red board and several (possibly zero) white boards. The red board should be the longest one in the fence (every white board used in the fence should be strictly shorter), and the sequence of lengths of boards should be ascending before the red board and descending after it. Formally, if m boards are used, and their lengths are l1, l2, ..., lm in the order they are placed in the fence, from left to right (let\'s call this array [l1,l2,\xe2\x80\xa6,lm] the array of lengths), the following conditions should hold:  there should be exactly one red board in the fence (let its index be j);  for every i\xe2\x88\x88[1,j\xe2\x88\x921] li<li+1;  for every i\xe2\x88\x88[j,m\xe2\x88\x921] li>li+1. When Polycarp will build his fence, he will place all boards from left to right on the same height of 0, without any gaps, so these boards compose a polygon:  Example: a fence with [3,5,4,2,1] as the array of lengths. The second board is red. The perimeter of the fence is 20. Polycarp is interested in fences of some special perimeters. He has q even integers he really likes (these integers are Q1, Q2, ..., Qq), and for every such integer Qi, he wants to calculate the number of different fences with perimeter Qi he can build (two fences are considered different if their arrays of lengths are different). Can you help him calculate these values?" 2500
1251E2 "Voting (Hard Version)" "binary search,data structures,greedy" "The only difference between easy and hard versions is constraints.Now elections are held in Berland and you want to win them. More precisely, you want everyone to vote for you.There are n voters, and two ways to convince each of them to vote for you. The first way to convince the i-th voter is to pay him pi coins. The second way is to make mi other voters vote for you, and the i-th voter will vote for free.Moreover, the process of such voting takes place in several steps. For example, if there are five voters with m1=1, m2=2, m3=2, m4=4, m5=5, then you can buy the vote of the fifth voter, and eventually everyone will vote for you. Set of people voting for you will change as follows: 5\xe2\x86\x921,5\xe2\x86\x921,2,3,5\xe2\x86\x921,2,3,4,5.Calculate the minimum number of coins you have to spend so that everyone votes for you." 2400
1251E1 "Voting (Easy Version)" "data structures,dp,greedy" "The only difference between easy and hard versions is constraints.Now elections are held in Berland and you want to win them. More precisely, you want everyone to vote for you.There are n voters, and two ways to convince each of them to vote for you. The first way to convince the i-th voter is to pay him pi coins. The second way is to make mi other voters vote for you, and the i-th voter will vote for free.Moreover, the process of such voting takes place in several steps. For example, if there are five voters with m1=1, m2=2, m3=2, m4=4, m5=5, then you can buy the vote of the fifth voter, and eventually everyone will vote for you. Set of people voting for you will change as follows: 5\xe2\x86\x921,5\xe2\x86\x921,2,3,5\xe2\x86\x921,2,3,4,5.Calculate the minimum number of coins you have to spend so that everyone votes for you." 2300
1251D "Salary Changing" "binary search,greedy,sortings" "You are the head of a large enterprise. n people work at you, and n is odd (i.\xe2\x80\x89e. n is not divisible by 2).You have to distribute salaries to your employees. Initially, you have s dollars for it, and the i-th employee should get a salary from li to ri dollars. You have to distribute salaries in such a way that the median salary is maximum possible.To find the median of a sequence of odd length, you have to sort it and take the element in the middle position after sorting. For example:  the median of the sequence [5,1,10,17,6] is 6,  the median of the sequence [1,2,1] is 1. It is guaranteed that you have enough money to pay the minimum salary, i.e l1+l2+\xe2\x8b\xaf+ln\xe2\x89\xa4s.Note that you don\'t have to spend all your s dollars on salaries.You have to answer t test cases." 1900
1251C "Minimize The Integer" "greedy,two pointers" "You are given a huge integer a consisting of n digits (n is between 1 and 3\xe2\x8b\x85105, inclusive). It may contain leading zeros.You can swap two digits on adjacent (neighboring) positions if the swapping digits are of different parity (that is, they have different remainders when divided by 2). For example, if a=032867235 you can get the following integers in a single operation:   302867235 if you swap the first and the second digits;  023867235 if you swap the second and the third digits;  032876235 if you swap the fifth and the sixth digits;  032862735 if you swap the sixth and the seventh digits;  032867325 if you swap the seventh and the eighth digits. Note, that you can\'t swap digits on positions 2 and 4 because the positions are not adjacent. Also, you can\'t swap digits on positions 3 and 4 because the digits have the same parity.You can perform any number (possibly, zero) of such operations.Find the minimum integer you can obtain.Note that the resulting integer also may contain leading zeros." 1600
1251B "Binary Palindromes" greedy,strings "A palindrome is a string t which reads the same backward as forward (formally, t[i]=t[|t|+1\xe2\x88\x92i] for all i\xe2\x88\x88[1,|t|]). Here |t| denotes the length of a string t. For example, the strings 010, 1001 and 0 are palindromes.You have n binary strings s1,s2,\xe2\x80\xa6,sn (each si consists of zeroes and/or ones). You can swap any pair of characters any number of times (possibly, zero). Characters can be either from the same string or from different strings \xe2\x80\x94 there are no restrictions.Formally, in one move you:  choose four integer numbers x,a,y,b such that 1\xe2\x89\xa4x,y\xe2\x89\xa4n and 1\xe2\x89\xa4a\xe2\x89\xa4|sx| and 1\xe2\x89\xa4b\xe2\x89\xa4|sy| (where x and y are string indices and a and b are positions in strings sx and sy respectively),  swap (exchange) the characters sx[a] and sy[b]. What is the maximum number of strings you can make palindromic simultaneously?" 1400
1251A "Broken Keyboard" "brute force,strings,two pointers" "Recently Polycarp noticed that some of the buttons of his keyboard are malfunctioning. For simplicity, we assume that Polycarp\'s keyboard contains 26 buttons (one for each letter of the Latin alphabet). Each button is either working fine or malfunctioning. To check which buttons need replacement, Polycarp pressed some buttons in sequence, and a string s appeared on the screen. When Polycarp presses a button with character c, one of the following events happened:  if the button was working correctly, a character c appeared at the end of the string Polycarp was typing;  if the button was malfunctioning, two characters c appeared at the end of the string. For example, suppose the buttons corresponding to characters a and c are working correctly, and the button corresponding to b is malfunctioning. If Polycarp presses the buttons in the order a, b, a, c, a, b, a, then the string he is typing changes as follows: a \xe2\x86\x92 abb \xe2\x86\x92 abba \xe2\x86\x92 abbac \xe2\x86\x92 abbaca \xe2\x86\x92 abbacabb \xe2\x86\x92 abbacabba.You are given a string s which appeared on the screen after Polycarp pressed some buttons. Help Polycarp to determine which buttons are working correctly for sure (that is, this string could not appear on the screen if any of these buttons was malfunctioning).You may assume that the buttons don\'t start malfunctioning when Polycarp types the string: each button either works correctly throughout the whole process, or malfunctions throughout the whole process." 1000
1250N Wires "dfs and similar,graphs,greedy" "Polycarpus has a complex electronic device. The core of this device is a circuit board. The board has 109 contact points which are numbered from 1 to 109. Also there are n wires numbered from 1 to n, each connecting two distinct contact points on the board. An electric signal can pass between wires A and B if:   either both wires share the same contact point;  or there is a sequence of wires starting with A and ending with B, and each pair of adjacent wires in the sequence share a contact point.   The picture shows a circuit board with 5 wires. Contact points with numbers 2,5,7,8,10,13 are used. Here an electrical signal can pass from wire 2 to wire 3, but not to wire 1. Currently the circuit board is broken. Polycarpus thinks that the board could be fixed if the wires were re-soldered so that a signal could pass between any pair of wires.It takes 1 minute for Polycarpus to re-solder an end of a wire. I.e. it takes one minute to change one of the two contact points for a wire. Any contact point from range [1,109] can be used as a new contact point. A wire\'s ends must always be soldered to distinct contact points. Both wire\'s ends can be re-solded, but that will require two actions and will take 2 minutes in total.Find the minimum amount of time Polycarpus needs to re-solder wires so that a signal can pass between any pair of wires. Also output an optimal sequence of wire re-soldering." 2000
1250M SmartGarden "constructive algorithms,divide and conquer" "Berland Gardeners United Inc. hired you for the project called ""SmartGarden"". The main feature of this project is automatic garden watering.Formally the garden can be represented as a square of n\xc3\x97n cells with rows numbered 1 to n from top to bottom and columns numbered 1 to n from left to right. Each cell of the garden contains either a plant or a slab. It\'s known that slabs are located on the main diagonal of the matrix representing the garden, and in the cells that are below the main diagonal and share a side with at least one cell of the main diagonal. All the remaining cells of the garden are filled with plants.  Example of the garden for n=5. During implementation of the project you created a smart robot that takes a list of commands as an input, which are processed one by one. Each command contains:   a list of horizontal lines (rows in the matrix representing the garden);  a list of vertical lines (columns in the matrix representing the garden). While executing each command robot waters only cells in the intersection of specified rows and specified columns. So, if you specify r rows and c columns, then exactly r\xe2\x8b\x85c cells will be watered.In the demo for the customer you have tuned robot in such a way that it waters all the garden. To do that you prepared a single command containing all n rows and all n columns.Unfortunately, 5 hours before the demo for your customer it turned out that the CEO of Berland Gardeners United Inc. was going to take part in it. Moreover, most probably he will be standing on a garden slab during the demo!Now you need to create a list of commands for the robot so that it waters all the plants and doesn\'t water any cell containing a slab. Since it\'s only a beta version of ""SmartGarden"", the total number of commands shouldn\'t exceed 50.Create a program that, for a given size of the garden, will find a list of no more than 50 commands that allow the robot to water all the plants in the garden without watering the slabs. It is allowed to water a plant several times." 2500
1250L "Divide The Students" "binary search,greedy,math" "A group of students has recently been admitted to the Faculty of Computer Sciences at the Berland State University. Now the programming teacher wants to divide them into three subgroups for practice sessions.The teacher knows that a lot of programmers argue which language is the best. The teacher doesn\'t want to hear any arguments in the subgroups, so she wants to divide the students into three subgroups so that no pair of students belonging to the same subgroup want to argue.To perform this division, the teacher asked each student which programming language he likes. There are a students who answered that they enjoy Assembler, b students stated that their favourite language is Basic, and c remaining students claimed that C++ is the best programming language \xe2\x80\x94 and there was a large argument between Assembler fans and C++ fans.Now, knowing that Assembler programmers and C++ programmers can start an argument every minute, the teacher wants to divide the students into three subgroups so that every student belongs to exactly one subgroup, and there is no subgroup that contains at least one Assembler fan and at least one C++ fan. Since teaching a lot of students can be difficult, the teacher wants the size of the largest subgroup to be minimum possible.Please help the teacher to calculate the minimum possible size of the largest subgroup!" 1500
1250K Projectors flows,graphs "There are n lectures and m seminars to be conducted today at the Faculty of Approximate Sciences. The i-th lecture starts at ai and ends at bi (formally, time of the lecture spans an interval [ai,bi), the right bound is exclusive). The j-th seminar starts at pj and ends at qj (similarly, time of the seminar spans an interval [pj,qj), the right bound is exclusive).There are x HD-projectors numbered from 1 to x and y ordinary projectors numbered from x+1 to x+y available at the faculty. Projectors should be distributed in such a way that:  an HD-projector is used in each lecture;  some projector (ordinary or HD) is used in each seminar;  a projector (ordinary or HD) can only be used in one event at the same moment of time;  if a projector is selected for an event, it is used there for the whole duration of the event;  a projector can be reused in some following event, if it starts not earlier than current event finishes. You are to find such distribution of projectors, if it exists.Again, note that the right bound of the event\'s time range is not inclusive: if some event starts exactly when another event finishes, the projector can be reused (suppose that it is instantly transported to the location of the event)." 3100
1250J "The Parade" "binary search,greedy" "The Berland Army is preparing for a large military parade. It is already decided that the soldiers participating in it will be divided into k rows, and all rows will contain the same number of soldiers.Of course, not every arrangement of soldiers into k rows is suitable. Heights of all soldiers in the same row should not differ by more than 1. The height of each soldier is an integer between 1 and n.For each possible height, you know the number of soldiers having this height. To conduct a parade, you have to choose the soldiers participating in it, and then arrange all of the chosen soldiers into k rows so that both of the following conditions are met:  each row has the same number of soldiers,  no row contains a pair of soldiers such that their heights differ by 2 or more. Calculate the maximum number of soldiers who can participate in the parade." 1800
1250I "Show Must Go On" "binary search,brute force,greedy,shortest paths" "The director of the famous dance show plans a tour. It is already decided that the tour will consist of up to m concerts.There are n dancers in the troupe. Each dancer is characterized by her awkwardness: the awkwardness of the i-th dancer is equal to ai.The director likes diversity. For this reason, each concert will be performed by a different set of dancers. A dancer may perform in multiple concerts. For example, it is possible that a set of dancers performs in one concert and a subset of this set of dancers performs in another concert. The only constraint is that the same set of dancers cannot perform twice.The director prefers the set with larger number of dancers over the set with smaller number of dancers. If two sets consist of the same number of dancers, then the director prefers the one which has smaller sum of awkwardness of dancers. If two sets of dancers are equal in size and total awkwardness, then the director does not have a preference which one is better.A marketing study shows that viewers are not ready to come to a concert if the total awkwardness of all the dancers performing in the concert is greater than k.The director wants to find the best plan for m concerts. He thinks to write down all possible sets of dancers; then get rid of the sets with total awkwardness greater than k. The remaining sets of dancers will be sorted according to his preference. The most preferred set of dancers will give the first concert, the second preferred set \xe2\x80\x94 the second concert and so on until the m-th concert. If it turns out that the total number of valid sets is less than m, then the total number of concerts will be equal to the number of valid sets.It turns out that the director delegated finding the plan to you! Please, notice that there might be several acceptable plans due to the fact that the director does not have a preference over sets of dancers with the same size and total awkwardness. In this case any of these plans is good enough. For each concert find the number of dancers and the total awkwardness of the set performing. Also, for the last concert find its set of dancers." 3100
1250H "Happy Birthday" math "You have a set of birthday cake candles. Each of such candles represents a digit between 0 and 9, inclusive.  Example of birthday cake candles. Let\'s denote the candle representing the digit d as d-candle.Your set contains c0 instances of 0-candles, c1 instances of 1-candles and so on. So, the total number of candles is c0+c1+\xe2\x8b\xaf+c9.These digits are needed to wish your cat a happy birthday. For each birthday, starting with the first, you want to compose the age of the cat using the digits from the set.Since you light candles for a very short time, candles don\'t have time to burn out. For this reason you can reuse candles an arbitrary number of times (therefore your set of candles never changes).For example, if you have one instance of each digit (i.e. c0=c1=\xe2\x8b\xaf=c9=1), you can compose any number from 1 to 10 using this set, but you cannot compose 11.You have to determine the first birthday, on which you cannot compose the age of the cat using the candles from your set. In other words, find the minimum number y such that all numbers from 1 to y\xe2\x88\x921 can be composed by digits from your set, but y cannot be composed." 1500
1250G "Discarding Game" "dp,greedy,two pointers" "Eulampius has created a game with the following rules: there are two players in the game: a human and a computer;  the game lasts for no more than n rounds. Initially both players have 0 points. In the j-th round the human gains aj points, and the computer gains bj points. The points are gained simultaneously; the game ends when one of the players gets k or more points. This player loses the game. If both players get k or more points simultaneously, both lose; if both players have less than k points after n rounds, the game ends in a tie; after each round the human can push the ""Reset"" button. If the human had x points, and the computer had y points before the button is pushed (of course, x<k and y<k), then after the button is pushed the human will have x\xe2\x80\xb2=max(0,x\xe2\x88\x92y) points, and the computer will have y\xe2\x80\xb2=max(0,y\xe2\x88\x92x) points. E.\xe2\x80\x89g. the push of ""Reset"" button transforms the state (x=3,y=5) into the state (x\xe2\x80\xb2=0,y\xe2\x80\xb2=2), and the state (x=8,y=2) into the state (x\xe2\x80\xb2=6,y\xe2\x80\xb2=0).Eulampius asked his friend Polycarpus to test the game. Polycarpus has quickly revealed that amounts of points gained by the human and the computer in each of n rounds are generated before the game and stored in a file. In other words, the pushes of the ""Reset"" button do not influence the values aj and bj, so sequences a and b are fixed and known in advance.Polycarpus wants to make a plan for the game. He would like to win the game pushing the ""Reset"" button as few times as possible. Your task is to determine this minimal number of pushes or determine that Polycarpus cannot win." 2300
1250F "Data Center" "brute force,implementation" "You are developing a project to build a new data center. The data center will be a rectangle with an area of exactly n square meters. Each side of the data center must be an integer.Your goal is to minimize the impact of the external environment on the data center. For this reason, you want to minimize the length of the perimeter of the data center (that is, the sum of the lengths of its four sides).What is the minimum perimeter of a rectangular data center with an area of exactly n square meters, if the lengths of all its sides must be integers?" 800
1250E "The Coronation" graphs,implementation "The coronation of King Berl XXII is soon! The whole royal family, including n daughters of Berl XXII, will be present.The King has ordered his jeweler to assemble n beautiful necklaces, so each of the princesses could wear exactly one necklace during the ceremony \xe2\x80\x94 and now these necklaces are finished. Each necklace consists of m gems attached to a gold chain. There are two types of gems used in the necklaces \xe2\x80\x94 emeralds and sapphires. So, each necklace can be represented by a sequence of m gems (listed from left to right), and each gem is either an emerald or a sapphire. Formally, the i-th necklace can be represented by a binary string si of length m; if the j-th character of si is 0, then the j-th gem in the i-th necklace is an emerald; otherwise, this gem is a sapphire.Now, looking at the necklaces, the King is afraid that some of his daughters may envy the other daughters\' necklaces. He wants all necklaces to look similar. Two necklaces are considered similar if there are at least k positions where these necklaces contain the same type of gems.For example, if there is a necklace represented by a sequence 01010111 and a necklace represented by a sequence 01100000, then there are 3 positions where these necklaces contain the same type of gems (both first gems are emeralds, both second gems are sapphires, and both fifth gems are emeralds). So if k=3, these necklaces are similar, and if k=4, they are not similar.The King thinks that if two of his daughters notice that their necklaces are not similar, then they may have a conflict \xe2\x80\x94 and, obviously, he doesn\'t want any conflicts during the coronation! So Berl XXII wants to tell some of his daughters to wear their necklaces backward. If a necklace is worn backward, then the sequence of gems in this necklace is reversed. For example, if a necklace is represented by a sequence 01100, then, if worn backward, it would be represented by a sequence 00110. The King wants to find the minimum number of necklaces to be worn backward during the coronation so that there are no conflicts.Berl XXII is too busy with preparation for the coronation, so he ordered you to resolve this issue for him. Help him \xe2\x80\x94 and he will give you a truly royal reward!" 2300
1250D "Conference Problem" dp "A large-scale conference on unnatural sciences is going to be held soon in Berland! In total, n scientists from all around the world have applied. All of them have indicated a time segment when they will attend the conference: two integers li, ri \xe2\x80\x94 day of arrival and day of departure.Also, some of the scientists have indicated their country, while some preferred not to. So, each scientist also has a value ci, where:  ci>0, if the scientist is coming from country ci (all countries are numbered from 1 to 200);  ci=0, if the scientist preferred to not indicate the country. Everyone knows that it is interesting and useful to chat with representatives of other countries! A participant of the conference will be upset if she will not meet people from other countries during the stay. It is possible to meet people during all time of stay, including the day of arrival and the day of departure.Conference organizers need to be ready for the worst! They are interested in the largest number x, that it is possible that among all people attending the conference exactly x will be upset.Help the organizers to find the maximum number of upset scientists." 3000
1250C "Trip to Saint Petersburg" "data structures" "You are planning your trip to Saint Petersburg. After doing some calculations, you estimated that you will have to spend k rubles each day you stay in Saint Petersburg \xe2\x80\x94 you have to rent a flat, to eat at some local cafe, et cetera. So, if the day of your arrival is L, and the day of your departure is R, you will have to spend k(R\xe2\x88\x92L+1) rubles in Saint Petersburg.You don\'t want to spend a lot of money on your trip, so you decided to work in Saint Petersburg during your trip. There are n available projects numbered from 1 to n, the i-th of them lasts from the day li to the day ri inclusive. If you choose to participate in the i-th project, then you have to stay and work in Saint Petersburg for the entire time this project lasts, but you get paid pi rubles for completing it.Now you want to come up with an optimal trip plan: you have to choose the day of arrival L, the day of departure R and the set of projects S to participate in so that all the following conditions are met:  your trip lasts at least one day (formally, R\xe2\x89\xa5L);  you stay in Saint Petersburg for the duration of every project you have chosen (formally, for each s\xe2\x88\x88S L\xe2\x89\xa4ls and R\xe2\x89\xa5rs);  your total profit is strictly positive and maximum possible (formally, you have to maximize the value of \xe2\x88\x91s\xe2\x88\x88Sps\xe2\x88\x92k(R\xe2\x88\x92L+1), and this value should be positive). You may assume that no matter how many projects you choose, you will still have time and ability to participate in all of them, even if they overlap." 2100
1250B "The Feast and the Bus" "brute force,constructive algorithms,greedy,math" "Employees of JebTrains are on their way to celebrate the 256-th day of the year! There are n employees and k teams in JebTrains. Each employee is a member of some (exactly one) team. All teams are numbered from 1 to k. You are given an array of numbers t1,t2,\xe2\x80\xa6,tn where ti is the i-th employee\'s team number.JebTrains is going to rent a single bus to get employees to the feast. The bus will take one or more rides. A bus can pick up an entire team or two entire teams. If three or more teams take a ride together they may start a new project which is considered unacceptable. It\'s prohibited to split a team, so all members of a team should take the same ride.It is possible to rent a bus of any capacity s. Such a bus can take up to s people on a single ride. The total cost of the rent is equal to s\xe2\x8b\x85r burles where r is the number of rides. Note that it\'s impossible to rent two or more buses.Help JebTrains to calculate the minimum cost of the rent, required to get all employees to the feast, fulfilling all the conditions above." 1800
1250A Berstagram implementation "Polycarp recently signed up to a new social network Berstagram. He immediately published n posts there. He assigned numbers from 1 to n to all posts and published them one by one. So, just after publishing Polycarp\'s news feed contained posts from 1 to n \xe2\x80\x94 the highest post had number 1, the next one had number 2, ..., the lowest post had number n.After that he wrote down all likes from his friends. Likes were coming consecutively from the 1-st one till the m-th one. You are given a sequence a1,a2,\xe2\x80\xa6,am (1\xe2\x89\xa4aj\xe2\x89\xa4n), where aj is the post that received the j-th like.News feed in Berstagram works in the following manner. Let\'s assume the j-th like was given to post aj. If this post is not the highest (first) one then it changes its position with the one above. If aj is the highest post nothing changes. For example, if n=3, m=5 and a=[3,2,1,3,3], then Polycarp\'s news feed had the following states:  before the first like: [1,2,3];  after the first like: [1,3,2];  after the second like: [1,2,3];  after the third like: [1,2,3];  after the fourth like: [1,3,2];  after the fifth like: [3,1,2]. Polycarp wants to know the highest (minimum) and the lowest (maximum) positions for each post. Polycarp considers all moments of time, including the moment ""before all likes""." 1400
1249F "Maximum Weight Subset" dp,trees "You are given a tree, which consists of n vertices. Recall that a tree is a connected undirected graph without cycles.   Example of a tree. Vertices are numbered from 1 to n. All vertices have weights, the weight of the vertex v is av.Recall that the distance between two vertices in the tree is the number of edges on a simple path between them.Your task is to find the subset of vertices with the maximum total weight (the weight of the subset is the sum of weights of all vertices in it) such that there is no pair of vertices with the distance k or less between them in this subset." 2200
1249E "By Elevator or Stairs?" "dp,shortest paths" "You are planning to buy an apartment in a n-floor building. The floors are numbered from 1 to n from the bottom to the top. At first for each floor you want to know the minimum total time to reach it from the first (the bottom) floor.Let:  ai for all i from 1 to n\xe2\x88\x921 be the time required to go from the i-th floor to the (i+1)-th one (and from the (i+1)-th to the i-th as well) using the stairs;  bi for all i from 1 to n\xe2\x88\x921 be the time required to go from the i-th floor to the (i+1)-th one (and from the (i+1)-th to the i-th as well) using the elevator, also there is a value c \xe2\x80\x94 time overhead for elevator usage (you need to wait for it, the elevator doors are too slow!). In one move, you can go from the floor you are staying at x to any floor y (x\xe2\x89\xa0y) in two different ways:  If you are using the stairs, just sum up the corresponding values of ai. Formally, it will take max(x,y)\xe2\x88\x921\xe2\x88\x91i=min(x,y)ai time units.  If you are using the elevator, just sum up c and the corresponding values of bi. Formally, it will take c+max(x,y)\xe2\x88\x921\xe2\x88\x91i=min(x,y)bi time units. You can perform as many moves as you want (possibly zero).So your task is for each i to determine the minimum total time it takes to reach the i-th floor from the 1-st (bottom) floor." 1700
1249D2 "Too Many Segments (hard version)" "data structures,greedy,sortings" "The only difference between easy and hard versions is constraints.You are given n segments on the coordinate axis OX. Segments can intersect, lie inside each other and even coincide. The i-th segment is [li;ri] (li\xe2\x89\xa4ri) and it covers all integer points j such that li\xe2\x89\xa4j\xe2\x89\xa4ri.The integer point is called bad if it is covered by strictly more than k segments.Your task is to remove the minimum number of segments so that there are no bad points at all." 1800
1249D1 "Too Many Segments (easy version)" greedy "The only difference between easy and hard versions is constraints.You are given n segments on the coordinate axis OX. Segments can intersect, lie inside each other and even coincide. The i-th segment is [li;ri] (li\xe2\x89\xa4ri) and it covers all integer points j such that li\xe2\x89\xa4j\xe2\x89\xa4ri.The integer point is called bad if it is covered by strictly more than k segments.Your task is to remove the minimum number of segments so that there are no bad points at all." 1800
1249C2 "Good Numbers (hard version)" "binary search,greedy,math,meet-in-the-middle" "The only difference between easy and hard versions is the maximum value of n.You are given a positive integer number n. You really love good numbers so you want to find the smallest good number greater than or equal to n.The positive integer is called good if it can be represented as a sum of distinct powers of 3 (i.e. no duplicates of powers of 3 are allowed).For example:  30 is a good number: 30=33+31,  1 is a good number: 1=30,  12 is a good number: 12=32+31,  but 2 is not a good number: you can\'t represent it as a sum of distinct powers of 3 (2=30+30),  19 is not a good number: you can\'t represent it as a sum of distinct powers of 3 (for example, the representations 19=32+32+30=32+31+31+31+30 are invalid),  20 is also not a good number: you can\'t represent it as a sum of distinct powers of 3 (for example, the representation 20=32+32+30+30 is invalid). Note, that there exist other representations of 19 and 20 as sums of powers of 3 but none of them consists of distinct powers of 3.For the given positive integer n find such smallest m (n\xe2\x89\xa4m) that m is a good number.You have to answer q independent queries." 1500
1249C1 "Good Numbers (easy version)" "brute force,greedy,implementation" "The only difference between easy and hard versions is the maximum value of n.You are given a positive integer number n. You really love good numbers so you want to find the smallest good number greater than or equal to n.The positive integer is called good if it can be represented as a sum of distinct powers of 3 (i.e. no duplicates of powers of 3 are allowed).For example:  30 is a good number: 30=33+31,  1 is a good number: 1=30,  12 is a good number: 12=32+31,  but 2 is not a good number: you can\'t represent it as a sum of distinct powers of 3 (2=30+30),  19 is not a good number: you can\'t represent it as a sum of distinct powers of 3 (for example, the representations 19=32+32+30=32+31+31+31+30 are invalid),  20 is also not a good number: you can\'t represent it as a sum of distinct powers of 3 (for example, the representation 20=32+32+30+30 is invalid). Note, that there exist other representations of 19 and 20 as sums of powers of 3 but none of them consists of distinct powers of 3.For the given positive integer n find such smallest m (n\xe2\x89\xa4m) that m is a good number.You have to answer q independent queries." 1300
1249B2 "Books Exchange (hard version)" "dfs and similar,dsu,math" "The only difference between easy and hard versions is constraints.There are n kids, each of them is reading a unique book. At the end of any day, the i-th kid will give his book to the pi-th kid (in case of i=pi the kid will give his book to himself). It is guaranteed that all values of pi are distinct integers from 1 to n (i.e. p is a permutation). The sequence p doesn\'t change from day to day, it is fixed.For example, if n=6 and p=[4,6,1,3,5,2] then at the end of the first day the book of the 1-st kid will belong to the 4-th kid, the 2-nd kid will belong to the 6-th kid and so on. At the end of the second day the book of the 1-st kid will belong to the 3-th kid, the 2-nd kid will belong to the 2-th kid and so on.Your task is to determine the number of the day the book of the i-th child is returned back to him for the first time for every i from 1 to n.Consider the following example: p=[5,1,2,4,3]. The book of the 1-st kid will be passed to the following kids:  after the 1-st day it will belong to the 5-th kid,  after the 2-nd day it will belong to the 3-rd kid,  after the 3-rd day it will belong to the 2-nd kid,  after the 4-th day it will belong to the 1-st kid. So after the fourth day, the book of the first kid will return to its owner. The book of the fourth kid will return to him for the first time after exactly one day.You have to answer q independent queries." 1300
1249B1 "Books Exchange (easy version)" dsu,math "The only difference between easy and hard versions is constraints.There are n kids, each of them is reading a unique book. At the end of any day, the i-th kid will give his book to the pi-th kid (in case of i=pi the kid will give his book to himself). It is guaranteed that all values of pi are distinct integers from 1 to n (i.e. p is a permutation). The sequence p doesn\'t change from day to day, it is fixed.For example, if n=6 and p=[4,6,1,3,5,2] then at the end of the first day the book of the 1-st kid will belong to the 4-th kid, the 2-nd kid will belong to the 6-th kid and so on. At the end of the second day the book of the 1-st kid will belong to the 3-th kid, the 2-nd kid will belong to the 2-th kid and so on.Your task is to determine the number of the day the book of the i-th child is returned back to him for the first time for every i from 1 to n.Consider the following example: p=[5,1,2,4,3]. The book of the 1-st kid will be passed to the following kids:  after the 1-st day it will belong to the 5-th kid,  after the 2-nd day it will belong to the 3-rd kid,  after the 3-rd day it will belong to the 2-nd kid,  after the 4-th day it will belong to the 1-st kid. So after the fourth day, the book of the first kid will return to its owner. The book of the fourth kid will return to him for the first time after exactly one day.You have to answer q independent queries." 1000
1249A "Yet Another Dividing into Teams" math "You are a coach of a group consisting of n students. The i-th student has programming skill ai. All students have distinct programming skills. You want to divide them into teams in such a way that:  No two students i and j such that |ai\xe2\x88\x92aj|=1 belong to the same team (i.e. skills of each pair of students in the same team have the difference strictly greater than 1);  the number of teams is the minimum possible. You have to answer q independent queries." 800
1248D1 "The World Is Just a Programming Task (Easy Version)" "brute force,dp,greedy,implementation" "This is an easier version of the problem. In this version, n\xe2\x89\xa4500.Vasya is an experienced developer of programming competitions\' problems. As all great minds at some time, Vasya faced a creative crisis. To improve the situation, Petya gifted him a string consisting of opening and closing brackets only. Petya believes, that the beauty of the bracket string is a number of its cyclical shifts, which form a correct bracket sequence.To digress from his problems, Vasya decided to select two positions of the string (not necessarily distinct) and swap characters located at this positions with each other. Vasya will apply this operation exactly once. He is curious what is the maximum possible beauty he can achieve this way. Please help him.We remind that bracket sequence s is called correct if:   s is empty;  s is equal to ""(t)"", where t is correct bracket sequence;  s is equal to t1t2, i.e. concatenation of t1 and t2, where t1 and t2 are correct bracket sequences. For example, ""(()())"", ""()"" are correct, while "")("" and ""())"" are not.The cyclical shift of the string s of length n by k (0\xe2\x89\xa4k<n) is a string formed by a concatenation of the last k symbols of the string s with the first n\xe2\x88\x92k symbols of string s. For example, the cyclical shift of string ""(())()"" by 2 equals ""()(())"".Cyclical shifts i and j are considered different, if i\xe2\x89\xa0j." 2000
1248B "Grow The Tree" greedy,math,sortings "Gardener Alexey teaches competitive programming to high school students. To congratulate Alexey on the Teacher\'s Day, the students have gifted him a collection of wooden sticks, where every stick has an integer length. Now Alexey wants to grow a tree from them.The tree looks like a polyline on the plane, consisting of all sticks. The polyline starts at the point (0,0). While constructing the polyline, Alexey will attach sticks to it one by one in arbitrary order. Each stick must be either vertical or horizontal (that is, parallel to OX or OY axis). It is not allowed for two consecutive sticks to be aligned simultaneously horizontally or simultaneously vertically. See the images below for clarification.Alexey wants to make a polyline in such a way that its end is as far as possible from (0,0). Please help him to grow the tree this way.Note that the polyline defining the form of the tree may have self-intersections and self-touches, but it can be proved that the optimal answer does not contain any self-intersections or self-touches." 900
1248A "Integer Points" geometry,math "DLS and JLS are bored with a Math lesson. In order to entertain themselves, DLS took a sheet of paper and drew n distinct lines, given by equations y=x+pi for some distinct p1,p2,\xe2\x80\xa6,pn.Then JLS drew on the same paper sheet m distinct lines given by equations y=\xe2\x88\x92x+qi for some distinct q1,q2,\xe2\x80\xa6,qm.DLS and JLS are interested in counting how many line pairs have integer intersection points, i.e. points with both coordinates that are integers. Unfortunately, the lesson will end up soon, so DLS and JLS are asking for your help." 1000
1246F "Cursor Distance" NA "There is a string s of lowercase English letters. A cursor is positioned on one of the characters. The cursor can be moved with the following operation: choose a letter c and a direction (left or right). The cursor is then moved to the closest occurence of c in the chosen direction. If there is no letter c in that direction, the cursor stays in place. For example, if s=abaab with the cursor on the second character (a[b]aab), then: moving to the closest letter a to the left places the cursor on the first character ([a]baab); moving to the closest letter a to the right places the cursor the third character (ab[a]ab); moving to the closest letter b to the right places the cursor on the fifth character (abaa[b]); any other operation leaves the cursor in place.Let dist(i,j) be the smallest number of operations needed to move the cursor from the i-th character to the j-th character. Compute n\xe2\x88\x91i=1n\xe2\x88\x91j=1dist(i,j)." 3500
1245F "Daniel and Spring Cleaning" "bitmasks,brute force,combinatorics,dp" "While doing some spring cleaning, Daniel found an old calculator that he loves so much. However, it seems like it is broken. When he tries to compute 1+3 using the calculator, he gets 2 instead of 4. But when he tries computing 1+4, he gets the correct answer, 5. Puzzled by this mystery, he opened up his calculator and found the answer to the riddle: the full adders became half adders! So, when he tries to compute the sum a+b using the calculator, he instead gets the xorsum a\xe2\x8a\x95b (read the definition by the link: https://en.wikipedia.org/wiki/Exclusive_or).As he saw earlier, the calculator sometimes gives the correct answer. And so, he wonders, given integers l and r, how many pairs of integers (a,b) satisfy the following conditions: a+b=a\xe2\x8a\x95b l\xe2\x89\xa4a\xe2\x89\xa4r l\xe2\x89\xa4b\xe2\x89\xa4rHowever, Daniel the Barman is going to the bar and will return in two hours. He tells you to solve the problem before he returns, or else you will have to enjoy being blocked." 2300
1245E "Hyakugoku and Ladders" "dp,probabilities,shortest paths" "Hyakugoku has just retired from being the resident deity of the South Black Snail Temple in order to pursue her dream of becoming a cartoonist. She spent six months in that temple just playing ""Cat\'s Cradle"" so now she wants to try a different game \xe2\x80\x94 ""Snakes and Ladders"". Unfortunately, she already killed all the snakes, so there are only ladders left now. The game is played on a 10\xc3\x9710 board as follows:  At the beginning of the game, the player is at the bottom left square.  The objective of the game is for the player to reach the Goal (the top left square) by following the path and climbing vertical ladders. Once the player reaches the Goal, the game ends.  The path is as follows: if a square is not the end of its row, it leads to the square next to it along the direction of its row; if a square is the end of its row, it leads to the square above it. The direction of a row is determined as follows: the direction of the bottom row is to the right; the direction of any other row is opposite the direction of the row below it. See Notes section for visualization of path.  During each turn, the player rolls a standard six-sided dice. Suppose that the number shown on the dice is r. If the Goal is less than r squares away on the path, the player doesn\'t move (but the turn is performed). Otherwise, the player advances exactly r squares along the path and then stops. If the player stops on a square with the bottom of a ladder, the player chooses whether or not to climb up that ladder. If she chooses not to climb, then she stays in that square for the beginning of the next turn.  Some squares have a ladder in them. Ladders are only placed vertically \xe2\x80\x94 each one leads to the same square of some of the upper rows. In order for the player to climb up a ladder, after rolling the dice, she must stop at the square containing the bottom of the ladder. After using the ladder, the player will end up in the square containing the top of the ladder. She cannot leave the ladder in the middle of climbing. And if the square containing the top of the ladder also contains the bottom of another ladder, she is not allowed to use that second ladder.  The numbers on the faces of the dice are 1, 2, 3, 4, 5, and 6, with each number having the same probability of being shown. Please note that:     it is possible for ladders to overlap, but the player cannot switch to the other ladder while in the middle of climbing the first one;     it is possible for ladders to go straight to the top row, but not any higher;     it is possible for two ladders to lead to the same tile;     it is possible for a ladder to lead to a tile that also has a ladder, but the player will not be able to use that second ladder if she uses the first one;     the player can only climb up ladders, not climb down. Hyakugoku wants to finish the game as soon as possible. Thus, on each turn she chooses whether to climb the ladder or not optimally. Help her to determine the minimum expected number of turns the game will take." 2300
1245D "Shichikuji and Power Grid" "dsu,graphs,greedy,shortest paths,trees" "Shichikuji is the new resident deity of the South Black Snail Temple. Her first job is as follows:There are n new cities located in Prefecture X. Cities are numbered from 1 to n. City i is located xi km North of the shrine and yi km East of the shrine. It is possible that (xi,yi)=(xj,yj) even when i\xe2\x89\xa0j.Shichikuji must provide electricity to each city either by building a power station in that city, or by making a connection between that city and another one that already has electricity. So the City has electricity if it has a power station in it or it is connected to a City which has electricity by a direct connection or via a chain of connections.    Building a power station in City i will cost ci yen;     Making a connection between City i and City j will cost ki+kj yen per km of wire used for the connection. However, wires can only go the cardinal directions (North, South, East, West). Wires can cross each other. Each wire must have both of its endpoints in some cities. If City i and City j are connected by a wire, the wire will go through any shortest path from City i to City j. Thus, the length of the wire if City i and City j are connected is |xi\xe2\x88\x92xj|+|yi\xe2\x88\x92yj| km. Shichikuji wants to do this job spending as little money as possible, since according to her, there isn\'t really anything else in the world other than money. However, she died when she was only in fifth grade so she is not smart enough for this. And thus, the new resident deity asks for your help.And so, you have to provide Shichikuji with the following information: minimum amount of yen needed to provide electricity to all cities, the cities in which power stations will be built, and the connections to be made.If there are multiple ways to choose the cities and the connections to obtain the construction of minimum price, then print any of them." 1900
1245C "Constanze\'s Machine" dp "Constanze is the smartest girl in her village but she has bad eyesight.One day, she was able to invent an incredible machine! When you pronounce letters, the machine will inscribe them onto a piece of paper. For example, if you pronounce \'c\', \'o\', \'d\', and \'e\' in that order, then the machine will inscribe ""code"" onto the paper. Thanks to this machine, she can finally write messages without using her glasses.However, her dumb friend Akko decided to play a prank on her. Akko tinkered with the machine so that if you pronounce \'w\', it will inscribe ""uu"" instead of ""w"", and if you pronounce \'m\', it will inscribe ""nn"" instead of ""m""! Since Constanze had bad eyesight, she was not able to realize what Akko did.The rest of the letters behave the same as before: if you pronounce any letter besides \'w\' and \'m\', the machine will just inscribe it onto a piece of paper.The next day, I received a letter in my mailbox. I can\'t understand it so I think it\'s either just some gibberish from Akko, or Constanze made it using her machine. But since I know what Akko did, I can just list down all possible strings that Constanze\'s machine would have turned into the message I got and see if anything makes sense.But I need to know how much paper I will need, and that\'s why I\'m asking you for help. Tell me the number of strings that Constanze\'s machine would\'ve turned into the message I got.But since this number can be quite large, tell me instead its remainder when divided by 109+7.If there are no strings that Constanze\'s machine would\'ve turned into the message I got, then print 0." 1400
1245B "Restricted RPS" "constructive algorithms,dp,greedy" "Let n be a positive integer. Let a,b,c be nonnegative integers such that a+b+c=n.Alice and Bob are gonna play rock-paper-scissors n times. Alice knows the sequences of hands that Bob will play. However, Alice has to play rock a times, paper b times, and scissors c times.Alice wins if she beats Bob in at least \xe2\x8c\x88n2\xe2\x8c\x89 (n2 rounded up to the nearest integer) hands, otherwise Alice loses.Note that in rock-paper-scissors:  rock beats scissors;  paper beats rock;  scissors beat paper. The task is, given the sequence of hands that Bob will play, and the numbers a,b,c, determine whether or not Alice can win. And if so, find any possible sequence of hands that Alice can use to win.If there are multiple answers, print any of them." 1200
1245A "Good ol\' Numbers Coloring" "math,number theory" "Consider the set of all nonnegative integers: 0,1,2,\xe2\x80\xa6. Given two integers a and b (1\xe2\x89\xa4a,b\xe2\x89\xa4104). We paint all the numbers in increasing number first we paint 0, then we paint 1, then 2 and so on.Each number is painted white or black. We paint a number i according to the following rules:   if i=0, it is colored white;   if i\xe2\x89\xa5a and i\xe2\x88\x92a is colored white, i is also colored white;   if i\xe2\x89\xa5b and i\xe2\x88\x92b is colored white, i is also colored white;   if i is still not colored white, it is colored black. In this way, each nonnegative integer gets one of two colors.For example, if a=3, b=5, then the colors of the numbers (in the order from 0) are: white (0), black (1), black (2), white (3), black (4), white (5), white (6), black (7), white (8), white (9), ...Note that:   It is possible that there are infinitely many nonnegative integers colored black. For example, if a=10 and b=10, then only 0,10,20,30 and any other nonnegative integers that end in 0 when written in base 10 are white. The other integers are colored black.   It is also possible that there are only finitely many nonnegative integers colored black. For example, when a=1 and b=10, then there is no nonnegative integer colored black at all. Your task is to determine whether or not the number of nonnegative integers colored black is infinite.If there are infinitely many nonnegative integers colored black, simply print a line containing ""Infinite"" (without the quotes). Otherwise, print ""Finite"" (without the quotes)." 1000
1244G "Running in Pairs" "constructive algorithms,greedy,math" "Demonstrative competitions will be held in the run-up to the 20NN Berlatov Olympic Games. Today is the day for the running competition!Berlatov team consists of 2n runners which are placed on two running tracks; n runners are placed on each track. The runners are numbered from 1 to n on each track. The runner with number i runs through the entire track in i seconds.The competition is held as follows: first runners on both tracks start running at the same time; when the slower of them arrives at the end of the track, second runners on both tracks start running, and everyone waits until the slower of them finishes running, and so on, until all n pairs run through the track.The organizers want the run to be as long as possible, but if it lasts for more than k seconds, the crowd will get bored. As the coach of the team, you may choose any order in which the runners are arranged on each track (but you can\'t change the number of runners on each track or swap runners between different tracks).You have to choose the order of runners on each track so that the duration of the competition is as long as possible, but does not exceed k seconds.Formally, you want to find two permutations p and q (both consisting of n elements) such that sum=n\xe2\x88\x91i=1max(pi,qi) is maximum possible, but does not exceed k. If there is no such pair, report about it." 2400
1244F Chips "constructive algorithms,implementation" "There are n chips arranged in a circle, numbered from 1 to n. Initially each chip has black or white color. Then k iterations occur. During each iteration the chips change their colors according to the following rules. For each chip i, three chips are considered: chip i itself and two its neighbours. If the number of white chips among these three is greater than the number of black chips among these three chips, then the chip i becomes white. Otherwise, the chip i becomes black. Note that for each i from 2 to (n\xe2\x88\x921) two neighbouring chips have numbers (i\xe2\x88\x921) and (i+1). The neighbours for the chip i=1 are n and 2. The neighbours of i=n are (n\xe2\x88\x921) and 1.The following picture describes one iteration with n=6. The chips 1, 3 and 4 are initially black, and the chips 2, 5 and 6 are white. After the iteration 2, 3 and 4 become black, and 1, 5 and 6 become white.  Your task is to determine the color of each chip after k iterations." 2300
1244E "Minimizing Difference" "binary search,constructive algorithms,greedy,sortings,ternary search,two pointers" "You are given a sequence a1,a2,\xe2\x80\xa6,an consisting of n integers.You may perform the following operation on this sequence: choose any element and either increase or decrease it by one.Calculate the minimum possible difference between the maximum element and the minimum element in the sequence, if you can perform the aforementioned operation no more than k times." 2000
1244D "Paint the Tree" "brute force,constructive algorithms,dp,graphs,implementation,trees" "You are given a tree consisting of n vertices. A tree is an undirected connected acyclic graph.  Example of a tree. You have to paint each vertex into one of three colors. For each vertex, you know the cost of painting it in every color.You have to paint the vertices so that any path consisting of exactly three distinct vertices does not contain any vertices with equal colors. In other words, let\'s consider all triples (x,y,z) such that x\xe2\x89\xa0y,y\xe2\x89\xa0z,x\xe2\x89\xa0z, x is connected by an edge with y, and y is connected by an edge with z. The colours of x, y and z should be pairwise distinct. Let\'s call a painting which meets this condition good.You have to calculate the minimum cost of a good painting and find one of the optimal paintings. If there is no good painting, report about it." 1800
1244C "The Football Season" "brute force,math,number theory" "The football season has just ended in Berland. According to the rules of Berland football, each match is played between two teams. The result of each match is either a draw, or a victory of one of the playing teams. If a team wins the match, it gets w points, and the opposing team gets 0 points. If the game results in a draw, both teams get d points.The manager of the Berland capital team wants to summarize the results of the season, but, unfortunately, all information about the results of each match is lost. The manager only knows that the team has played n games and got p points for them.You have to determine three integers x, y and z \xe2\x80\x94 the number of wins, draws and loses of the team. If there are multiple answers, print any of them. If there is no suitable triple (x,y,z), report about it." 2000
1244B "Rooms and Staircases" "brute force,implementation" "Nikolay lives in a two-storied house. There are n rooms on each floor, arranged in a row and numbered from one from left to right. So each room can be represented by the number of the floor and the number of the room on this floor (room number is an integer between 1 and n). If Nikolay is currently in some room, he can move to any of the neighbouring rooms (if they exist). Rooms with numbers i and i+1 on each floor are neighbouring, for all 1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921. There may also be staircases that connect two rooms from different floors having the same numbers. If there is a staircase connecting the room x on the first floor and the room x on the second floor, then Nikolay can use it to move from one room to another.   The picture illustrates a house with n=4. There is a staircase between the room 2 on the first floor and the room 2 on the second floor, and another staircase between the room 4 on the first floor and the room 4 on the second floor. The arrows denote possible directions in which Nikolay can move. The picture corresponds to the string ""0101"" in the input.  Nikolay wants to move through some rooms in his house. To do this, he firstly chooses any room where he starts. Then Nikolay moves between rooms according to the aforementioned rules. Nikolay never visits the same room twice (he won\'t enter a room where he has already been). Calculate the maximum number of rooms Nikolay can visit during his tour, if:  he can start in any room on any floor of his choice,  and he won\'t visit the same room twice." 1000
1244A "Pens and Pencils" math "Tomorrow is a difficult day for Polycarp: he has to attend a lectures and b practical classes at the university! Since Polycarp is a diligent student, he is going to attend all of them.While preparing for the university, Polycarp wonders whether he can take enough writing implements to write all of the lectures and draw everything he has to during all of the practical classes. Polycarp writes lectures using a pen (he can\'t use a pencil to write lectures!); he can write down c lectures using one pen, and after that it runs out of ink. During practical classes Polycarp draws blueprints with a pencil (he can\'t use a pen to draw blueprints!); one pencil is enough to draw all blueprints during d practical classes, after which it is unusable.Polycarp\'s pencilcase can hold no more than k writing implements, so if Polycarp wants to take x pens and y pencils, they will fit in the pencilcase if and only if x+y\xe2\x89\xa4k.Now Polycarp wants to know how many pens and pencils should he take. Help him to determine it, or tell that his pencilcase doesn\'t have enough room for all the implements he needs tomorrow!Note that you don\'t have to minimize the number of writing implements (though their total number must not exceed k)." 800
1243B2 "Character Swap (Hard Version)" strings "This problem is different from the easy version. In this version Ujan makes at most 2n swaps. In addition, k\xe2\x89\xa41000,n\xe2\x89\xa450 and it is necessary to print swaps themselves. You can hack this problem if you solve it. But you can hack the previous problem only if you solve both problems.After struggling and failing many times, Ujan decided to try to clean up his house again. He decided to get his strings in order first.Ujan has two distinct strings s and t of length n consisting of only of lowercase English characters. He wants to make them equal. Since Ujan is lazy, he will perform the following operation at most 2n times: he takes two positions i and j (1\xe2\x89\xa4i,j\xe2\x89\xa4n, the values i and j can be equal or different), and swaps the characters si and tj.Ujan\'s goal is to make the strings s and t equal. He does not need to minimize the number of performed operations: any sequence of operations of length 2n or shorter is suitable." 1600
1243B1 "Character Swap (Easy Version)" strings "This problem is different from the hard version. In this version Ujan makes exactly one exchange. You can hack this problem only if you solve both problems.After struggling and failing many times, Ujan decided to try to clean up his house again. He decided to get his strings in order first.Ujan has two distinct strings s and t of length n consisting of only of lowercase English characters. He wants to make them equal. Since Ujan is lazy, he will perform the following operation exactly once: he takes two positions i and j (1\xe2\x89\xa4i,j\xe2\x89\xa4n, the values i and j can be equal or different), and swaps the characters si and tj. Can he succeed?Note that he has to perform this operation exactly once. He has to perform this operation." 1000
1243A "Maximum Square" implementation "Ujan decided to make a new wooden roof for the house. He has n rectangular planks numbered from 1 to n. The i-th plank has size ai\xc3\x971 (that is, the width is 1 and the height is ai).Now, Ujan wants to make a square roof. He will first choose some of the planks and place them side by side in some order. Then he will glue together all of these planks by their vertical sides. Finally, he will cut out a square from the resulting shape in such a way that the sides of the square are horizontal and vertical.For example, if Ujan had planks with lengths 4, 3, 1, 4 and 5, he could choose planks with lengths 4, 3 and 5. Then he can cut out a 3\xc3\x973 square, which is the maximum possible. Note that this is not the only way he can obtain a 3\xc3\x973 square.  What is the maximum side length of the square Ujan can get?" 800
1242E "Planar Perimeter" "constructive algorithms,graphs" "Ujan has finally cleaned up his house and now wants to decorate the interior. He decided to place a beautiful carpet that would really tie the guest room together.He is interested in carpets that are made up of polygonal patches such that each side of a patch is either a side of another (different) patch, or is an exterior side of the whole carpet. In other words, the carpet can be represented as a planar graph, where each patch corresponds to a face of the graph, each face is a simple polygon. The perimeter of the carpet is the number of the exterior sides. Ujan considers a carpet beautiful if it consists of f patches, where the i-th patch has exactly ai sides, and the perimeter is the smallest possible. Find an example of such a carpet, so that Ujan can order it!" 3200
1242D "Number Discovery" math "Ujan needs some rest from cleaning, so he started playing with infinite sequences. He has two integers n and k. He creates an infinite sequence s by repeating the following steps.  Find k smallest distinct positive integers that are not in s. Let\'s call them u1,u2,\xe2\x80\xa6,uk from the smallest to the largest.  Append u1,u2,\xe2\x80\xa6,uk and \xe2\x88\x91ki=1ui to s in this order.  Go back to the first step. Ujan will stop procrastinating when he writes the number n in the sequence s. Help him find the index of n in s. In other words, find the integer x such that sx=n. It\'s possible to prove that all positive integers are included in s only once." 3400
1242C "Sum Balance" "bitmasks,dfs and similar,dp,graphs" "Ujan has a lot of numbers in his boxes. He likes order and balance, so he decided to reorder the numbers.There are k boxes numbered from 1 to k. The i-th box contains ni integer numbers. The integers can be negative. All of the integers are distinct. Ujan is lazy, so he will do the following reordering of the numbers exactly once. He will pick a single integer from each of the boxes, k integers in total. Then he will insert the chosen numbersÂ \xe2\x80\x94 one integer in each of the boxes, so that the number of integers in each box is the same as in the beginning. Note that he may also insert an integer he picked from a box back into the same box.Ujan will be happy if the sum of the integers in each box is the same. Can he achieve this and make the boxes perfectly balanced, like all things should be?" 2400
1242B "0-1 MST" "dfs and similar,dsu,graphs,sortings" "Ujan has a lot of useless stuff in his drawers, a considerable part of which are his math notebooks: it is time to sort them out. This time he found an old dusty graph theory notebook with a description of a graph.It is an undirected weighted graph on n vertices. It is a complete graph: each pair of vertices is connected by an edge. The weight of each edge is either 0 or 1; exactly m edges have weight 1, and all others have weight 0.Since Ujan doesn\'t really want to organize his notes, he decided to find the weight of the minimum spanning tree of the graph. (The weight of a spanning tree is the sum of all its edges.) Can you find the answer for Ujan so he stops procrastinating?" 1900
1242A "Tile Painting" "constructive algorithms,math,number theory" "Ujan has been lazy lately, but now has decided to bring his yard to good shape. First, he decided to paint the path from his house to the gate.The path consists of n consecutive tiles, numbered from 1 to n. Ujan will paint each tile in some color. He will consider the path aesthetic if for any two different tiles with numbers i and j, such that |j\xe2\x88\x92i| is a divisor of n greater than 1, they have the same color. Formally, the colors of two tiles with numbers i and j should be the same if |i\xe2\x88\x92j|>1 and nmod|i\xe2\x88\x92j|=0 (where xmody is the remainder when dividing x by y).Ujan wants to brighten up space. What is the maximum number of different colors that Ujan can use, so that the path is aesthetic?" 1500
1240F Football graphs "There are n football teams in the world. The Main Football Organization (MFO) wants to host at most m games. MFO wants the i-th game to be played between the teams ai and bi in one of the k stadiums. Let sij be the numbers of games the i-th team played in the j-th stadium. MFO does not want a team to have much more games in one stadium than in the others. Therefore, for each team i, the absolute difference between the maximum and minimum among si1,si2,\xe2\x80\xa6,sik should not exceed 2.Each team has wiÂ \xe2\x80\x94 the amount of money MFO will earn for each game of the i-th team. If the i-th team plays l games, MFO will earn wi\xe2\x8b\x85l.MFO needs to find what games in what stadiums they need to host in order to earn as much money as possible, not violating the rule they set.However, this problem is too complicated for MFO. Therefore, they are asking you to help them." 3100
1239F "Swiper, no swiping!" graphs,implementation "I\'m the Map, I\'m the Map! I\'m the MAP!!!MapIn anticipation of new adventures Boots wanted to do a good deed. After discussion with the Map and Backpack, they decided to gift Dora a connected graph. After a long search, Boots chose t graph\'s variants, which Dora might like. However fox Swiper wants to spoil his plan.The Swiper knows, that Dora now is only able to count up to 3, so he has came up with a following idea. He wants to steal some non-empty set of vertices, so that the Dora won\'t notice the loss. He has decided to steal some non-empty set of vertices, so that after deletion of the stolen vertices and edges adjacent to them, every remaining vertex wouldn\'t change it\'s degree modulo 3. The degree of a vertex is the number of edges it is adjacent to. It would\'ve been suspicious to steal all the vertices, so Swiper needs another plan.Boots are sure, that the crime can not be allowed. However they are afraid, that they won\'t be able to handle this alone. So Boots decided to ask for your help. Please determine for every graph\'s variant whether the Swiper can perform the theft or not." 3400
1239E Turtle dp,implementation "Kolya has a turtle and a field of size 2\xc3\x97n. The field rows are numbered from 1 to 2 from top to bottom, while the columns are numbered from 1 to n from left to right.Suppose in each cell of the field there is a lettuce leaf. The energy value of lettuce leaf in row i and column j is equal to ai,j. The turtle is initially in the top left cell and wants to reach the bottom right cell. The turtle can only move right and down and among all possible ways it will choose a way, maximizing the total energy value of lettuce leaves (in case there are several such paths, it will choose any of them).Kolya is afraid, that if turtle will eat too much lettuce, it can be bad for its health. So he wants to reorder lettuce leaves in the field, so that the energetic cost of leaves eaten by turtle will be minimized." 3100
1239D "Catowice City" "2-sat,dfs and similar,graph matchings,graphs" "In the Catowice city next weekend the cat contest will be held. However, the jury members and the contestants haven\'t been selected yet. There are n residents and n cats in the Catowice, and each resident has exactly one cat living in his house. The residents and cats are numbered with integers from 1 to n, where the i-th cat is living in the house of i-th resident.Each Catowice resident is in friendship with several cats, including the one living in his house. In order to conduct a contest, at least one jury member is needed and at least one cat contestant is needed. Of course, every jury member should know none of the contestants. For the contest to be successful, it\'s also needed that the number of jury members plus the number of contestants is equal to n.Please help Catowice residents to select the jury and the contestants for the upcoming competition, or determine that it\'s impossible to do." 2400
1239C "Queue in the Train" "data structures,greedy,implementation" "There are n seats in the train\'s car and there is exactly one passenger occupying every seat. The seats are numbered from 1 to n from left to right. The trip is long, so each passenger will become hungry at some moment of time and will go to take boiled water for his noodles. The person at seat i (1\xe2\x89\xa4i\xe2\x89\xa4n) will decide to go for boiled water at minute ti.Tank with a boiled water is located to the left of the 1-st seat. In case too many passengers will go for boiled water simultaneously, they will form a queue, since there can be only one passenger using the tank at each particular moment of time. Each passenger uses the tank for exactly p minutes. We assume that the time it takes passengers to go from their seat to the tank is negligibly small. Nobody likes to stand in a queue. So when the passenger occupying the i-th seat wants to go for a boiled water, he will first take a look on all seats from 1 to i\xe2\x88\x921. In case at least one of those seats is empty, he assumes that those people are standing in a queue right now, so he would be better seating for the time being. However, at the very first moment he observes that all seats with numbers smaller than i are busy, he will go to the tank.There is an unspoken rule, that in case at some moment several people can go to the tank, than only the leftmost of them (that is, seating on the seat with smallest number) will go to the tank, while all others will wait for the next moment.Your goal is to find for each passenger, when he will receive the boiled water for his noodles." 2300
1239B "The World Is Just a Programming Task (Hard Version)" implementation "This is a harder version of the problem. In this version, n\xe2\x89\xa4300000.Vasya is an experienced developer of programming competitions\' problems. As all great minds at some time, Vasya faced a creative crisis. To improve the situation, Petya gifted him a string consisting of opening and closing brackets only. Petya believes, that the beauty of the bracket string is a number of its cyclical shifts, which form a correct bracket sequence.To digress from his problems, Vasya decided to select two positions of the string (not necessarily distinct) and swap characters located at this positions with each other. Vasya will apply this operation exactly once. He is curious what is the maximum possible beauty he can achieve this way. Please help him.We remind that bracket sequence s is called correct if:   s is empty;  s is equal to ""(t)"", where t is correct bracket sequence;  s is equal to t1t2, i.e. concatenation of t1 and t2, where t1 and t2 are correct bracket sequences. For example, ""(()())"", ""()"" are correct, while "")("" and ""())"" are not.The cyclical shift of the string s of length n by k (0\xe2\x89\xa4k<n) is a string formed by a concatenation of the last k symbols of the string s with the first n\xe2\x88\x92k symbols of string s. For example, the cyclical shift of string ""(())()"" by 2 equals ""()(())"".Cyclical shifts i and j are considered different, if i\xe2\x89\xa0j." 2500
1239A "Ivan the Fool and the Probability Theory" combinatorics,dp,math "Recently Ivan the Fool decided to become smarter and study the probability theory. He thinks that he understands the subject fairly well, and so he began to behave like he already got PhD in that area.To prove his skills, Ivan decided to demonstrate his friends a concept of random picture. A picture is a field of n rows and m columns, where each cell is either black or white. Ivan calls the picture random if for every cell it has at most one adjacent cell of the same color. Two cells are considered adjacent if they share a side.Ivan\'s brothers spent some time trying to explain that it\'s not how the randomness usually works. Trying to convince Ivan, they want to count the number of different random (according to Ivan) pictures. Two pictures are considered different if at least one cell on those two picture is colored differently. Since the number of such pictures may be quite large, print it modulo 109+7." 1700
1238G "Adilbek and the Watering System" "data structures,greedy,sortings" "Adilbek has to water his garden. He is going to do it with the help of a complex watering system: he only has to deliver water to it, and the mechanisms will do all the remaining job.The watering system consumes one liter of water per minute (if there is no water, it is not working). It can hold no more than c liters. Adilbek has already poured c0 liters of water into the system. He is going to start watering the garden right now and water it for m minutes, and the watering system should contain at least one liter of water at the beginning of the i-th minute (for every i from 0 to m\xe2\x88\x921).Now Adilbek wonders what he will do if the watering system runs out of water. He called n his friends and asked them if they are going to bring some water. The i-th friend answered that he can bring no more than ai liters of water; he will arrive at the beginning of the ti-th minute and pour all the water he has into the system (if the system cannot hold such amount of water, the excess water is poured out); and then he will ask Adilbek to pay bi dollars for each liter of water he has brought. You may assume that if a friend arrives at the beginning of the ti-th minute and the system runs out of water at the beginning of the same minute, the friend pours his water fast enough so that the system does not stop working.Of course, Adilbek does not want to pay his friends, but he has to water the garden. So he has to tell his friends how much water should they bring. Formally, Adilbek wants to choose n integers k1, k2, ..., kn in such a way that:  if each friend i brings exactly ki liters of water, then the watering system works during the whole time required to water the garden;  the sum n\xe2\x88\x91i=1kibi is minimum possible. Help Adilbek to determine the minimum amount he has to pay his friends or determine that Adilbek not able to water the garden for m minutes.You have to answer q independent queries." 2700
1238F "The Maximum Subtree" "dfs and similar,dp,graphs,trees" "Assume that you have k one-dimensional segments s1,s2,\xe2\x80\xa6sk (each segment is denoted by two integers \xe2\x80\x94 its endpoints). Then you can build the following graph on these segments. The graph consists of k vertexes, and there is an edge between the i-th and the j-th vertexes (i\xe2\x89\xa0j) if and only if the segments si and sj intersect (there exists at least one point that belongs to both of them).For example, if s1=[1,6],s2=[8,20],s3=[4,10],s4=[2,13],s5=[17,18], then the resulting graph is the following:  A tree of size m is good if it is possible to choose m one-dimensional segments so that the graph built on these segments coincides with this tree.You are given a tree, you have to find its good subtree with maximum possible size. Recall that a subtree is a connected subgraph of a tree.Note that you have to answer q independent queries." 2200
1238E "Keyboard Purchase" bitmasks,dp "You have a password which you often type \xe2\x80\x94 a string s of length n. Every character of this string is one of the first m lowercase Latin letters.Since you spend a lot of time typing it, you want to buy a new keyboard.A keyboard is a permutation of the first m Latin letters. For example, if m=3, then there are six possible keyboards: abc, acb, bac, bca, cab and cba.Since you type your password with one finger, you need to spend time moving your finger from one password character to the next. The time to move from character si to character si+1 is equal to the distance between these characters on keyboard. The total time you have to spend typing the password with a keyboard is called the slowness of this keyboard.More formaly, the slowness of keyboard is equal to n\xe2\x88\x91i=2|possi\xe2\x88\x921\xe2\x88\x92possi|, where posx is position of letter x in keyboard.For example, if s is aacabc and the keyboard is bac, then the total time of typing this password is |posa\xe2\x88\x92posa|+|posa\xe2\x88\x92posc|+|posc\xe2\x88\x92posa|+|posa\xe2\x88\x92posb|+|posb\xe2\x88\x92posc| = |2\xe2\x88\x922|+|2\xe2\x88\x923|+|3\xe2\x88\x922|+|2\xe2\x88\x921|+|1\xe2\x88\x923| = 0+1+1+1+2=5.Before buying a new keyboard you want to know the minimum possible slowness that the keyboard can have." 2200
1238D AB-string "binary search,combinatorics,dp,strings" "The string t1t2\xe2\x80\xa6tk is good if each letter of this string belongs to at least one palindrome of length greater than 1.A palindrome is a string that reads the same backward as forward. For example, the strings A, BAB, ABBA, BAABBBAAB are palindromes, but the strings AB, ABBBAA, BBBA are not.Here are some examples of good strings:   t = AABBB (letters t1, t2 belong to palindrome t1\xe2\x80\xa6t2 and letters t3, t4, t5 belong to palindrome t3\xe2\x80\xa6t5);  t = ABAA (letters t1, t2, t3 belong to palindrome t1\xe2\x80\xa6t3 and letter t4 belongs to palindrome t3\xe2\x80\xa6t4);  t = AAAAA (all letters belong to palindrome t1\xe2\x80\xa6t5); You are given a string s of length n, consisting of only letters A and B.You have to calculate the number of good substrings of string s." 1900
1238C "Standard Free2play" dp,greedy,math "You are playing a game where your character should overcome different obstacles. The current problem is to come down from a cliff. The cliff has height h, and there is a moving platform on each height x from 1 to h.Each platform is either hidden inside the cliff or moved out. At first, there are n moved out platforms on heights p1,p2,\xe2\x80\xa6,pn. The platform on height h is moved out (and the character is initially standing there).If you character is standing on some moved out platform on height x, then he can pull a special lever, which switches the state of two platforms: on height x and x\xe2\x88\x921. In other words, the platform you are currently standing on will hide in the cliff and the platform one unit below will change it state: it will hide if it was moved out or move out if it was hidden. In the second case, you will safely land on it. Note that this is the only way to move from one platform to another.Your character is quite fragile, so it can safely fall from the height no more than 2. In other words falling from the platform x to platform x\xe2\x88\x922 is okay, but falling from x to x\xe2\x88\x923 (or lower) is certain death. Sometimes it\'s not possible to come down from the cliff, but you can always buy (for donate currency) several magic crystals. Each magic crystal can be used to change the state of any single platform (except platform on height h, which is unaffected by the crystals). After being used, the crystal disappears.What is the minimum number of magic crystal you need to buy to safely land on the 0 ground level?" 1600
1238B "Kill `Em All" greedy,sortings "Ivan plays an old action game called Heretic. He\'s stuck on one of the final levels of this game, so he needs some help with killing the monsters.The main part of the level is a large corridor (so large and narrow that it can be represented as an infinite coordinate line). The corridor is divided into two parts; let\'s assume that the point x=0 is where these parts meet.The right part of the corridor is filled with n monsters \xe2\x80\x94 for each monster, its initial coordinate xi is given (and since all monsters are in the right part, every xi is positive).The left part of the corridor is filled with crusher traps. If some monster enters the left part of the corridor or the origin (so, its current coordinate becomes less than or equal to 0), it gets instantly killed by a trap.The main weapon Ivan uses to kill the monsters is the Phoenix Rod. It can launch a missile that explodes upon impact, obliterating every monster caught in the explosion and throwing all other monsters away from the epicenter. Formally, suppose that Ivan launches a missile so that it explodes in the point c. Then every monster is either killed by explosion or pushed away. Let some monster\'s current coordinate be y, then:  if c=y, then the monster is killed;  if y<c, then the monster is pushed r units to the left, so its current coordinate becomes y\xe2\x88\x92r;  if y>c, then the monster is pushed r units to the right, so its current coordinate becomes y+r. Ivan is going to kill the monsters as follows: choose some integer point d and launch a missile into that point, then wait until it explodes and all the monsters which are pushed to the left part of the corridor are killed by crusher traps, then, if at least one monster is still alive, choose another integer point (probably the one that was already used) and launch a missile there, and so on.What is the minimum number of missiles Ivan has to launch in order to kill all of the monsters? You may assume that every time Ivan fires the Phoenix Rod, he chooses the impact point optimally.You have to answer q independent queries." 1300
1238A "Prime Subtraction" "math,number theory" "You are given two integers x and y (it is guaranteed that x>y). You may choose any prime integer p and subtract it any number of times from x. Is it possible to make x equal to y?Recall that a prime number is a positive integer that has exactly two positive divisors: 1 and this integer itself. The sequence of prime numbers starts with 2, 3, 5, 7, 11.Your program should solve t independent test cases." 900
1237H "Balanced Reversals" "constructive algorithms" "You have two strings a and b of equal even length n consisting of characters 0 and 1.We\'re in the endgame now. To finally make the universe perfectly balanced, you need to make strings a and b equal.In one step, you can choose any prefix of a of even length and reverse it. Formally, if a=a1a2\xe2\x80\xa6an, you can choose a positive even integer p\xe2\x89\xa4n and set a to apap\xe2\x88\x921\xe2\x80\xa6a1ap+1ap+2\xe2\x80\xa6an.Find a way to make a equal to b using at most n+1 reversals of the above kind, or determine that such a way doesn\'t exist. The number of reversals doesn\'t have to be minimized." 3300
1237G "Balanced Distribution" "data structures,dp,greedy" "There are n friends living on a circular street. The friends and their houses are numbered clockwise from 0 to n\xe2\x88\x921.Initially person i has ai stones. The friends want to make the distribution of stones among them perfectly balanced: everyone should possess the same number of stones.The only way to change the distribution of stones is by conducting meetings. During a meeting, people from exactly k consecutive houses (remember that the street is circular) gather at the same place and bring all their stones with them. All brought stones may be redistributed among people attending the meeting arbitrarily. The total number of stones they possess before the meeting and after the meeting must stay the same. After the meeting, everyone returns to their home.Find a way to make the distribution of stones perfectly balanced conducting as few meetings as possible." 3500
1237F "Balanced Domino Placements" combinatorics,dp "Consider a square grid with h rows and w columns with some dominoes on it. Each domino covers exactly two cells of the grid that share a common side. Every cell is covered by at most one domino.Let\'s call a placement of dominoes on the grid perfectly balanced if no row and no column contains a pair of cells covered by two different dominoes. In other words, every row and column may contain no covered cells, one covered cell, or two covered cells that belong to the same domino.You are given a perfectly balanced placement of dominoes on a grid. Find the number of ways to place zero or more extra dominoes on this grid to keep the placement perfectly balanced. Output this number modulo 998244353." 2600
1237E "Balanced Binary Search Trees" dp,math "Recall that a binary search tree is a rooted binary tree, whose nodes each store a key and each have at most two distinguished subtrees, left and right. The key in each node must be greater than any key stored in the left subtree, and less than any key stored in the right subtree.The depth of a vertex is the number of edges on the simple path from the vertex to the root. In particular, the depth of the root is 0.Let\'s call a binary search tree perfectly balanced if there doesn\'t exist a binary search tree with the same number of vertices that has a strictly smaller sum of depths of its vertices.Let\'s call a binary search tree with integer keys striped if both of the following conditions are satisfied for every vertex v:   If v has a left subtree whose root is u, then the parity of the key of v is different from the parity of the key of u.  If v has a right subtree whose root is w, then the parity of the key of v is the same as the parity of the key of w. You are given a single integer n. Find the number of perfectly balanced striped binary search trees with n vertices that have distinct integer keys between 1 and n, inclusive. Output this number modulo 998244353." 2400
1237D "Balanced Playlist" "binary search,data structures,implementation" "Your favorite music streaming platform has formed a perfectly balanced playlist exclusively for you. The playlist consists of n tracks numbered from 1 to n. The playlist is automatic and cyclic: whenever track i finishes playing, track i+1 starts playing automatically; after track n goes track 1.For each track i, you have estimated its coolness ai. The higher ai is, the cooler track i is.Every morning, you choose a track. The playlist then starts playing from this track in its usual cyclic fashion. At any moment, you remember the maximum coolness x of already played tracks. Once you hear that a track with coolness strictly less than x2 (no rounding) starts playing, you turn off the music immediately to keep yourself in a good mood.For each track i, find out how many tracks you will listen to before turning off the music if you start your morning with track i, or determine that you will never turn the music off. Note that if you listen to the same track several times, every time must be counted." 2000
1237C2 "Balanced Removals (Harder)" "binary search,constructive algorithms,divide and conquer,greedy,implementation,sortings" "This is a harder version of the problem. In this version, n\xe2\x89\xa450000.There are n distinct points in three-dimensional space numbered from 1 to n. The i-th point has coordinates (xi,yi,zi). The number of points n is even.You\'d like to remove all n points using a sequence of n2 snaps. In one snap, you can remove any two points a and b that have not been removed yet and form a perfectly balanced pair. A pair of points a and b is perfectly balanced if no other point c (that has not been removed yet) lies within the axis-aligned minimum bounding box of points a and b.Formally, point c lies within the axis-aligned minimum bounding box of points a and b if and only if min(xa,xb)\xe2\x89\xa4xc\xe2\x89\xa4max(xa,xb), min(ya,yb)\xe2\x89\xa4yc\xe2\x89\xa4max(ya,yb), and min(za,zb)\xe2\x89\xa4zc\xe2\x89\xa4max(za,zb). Note that the bounding box might be degenerate. Find a way to remove all points in n2 snaps." 1900
1237C1 "Balanced Removals (Easier)" "constructive algorithms,geometry,greedy" "This is an easier version of the problem. In this version, n\xe2\x89\xa42000.There are n distinct points in three-dimensional space numbered from 1 to n. The i-th point has coordinates (xi,yi,zi). The number of points n is even.You\'d like to remove all n points using a sequence of n2 snaps. In one snap, you can remove any two points a and b that have not been removed yet and form a perfectly balanced pair. A pair of points a and b is perfectly balanced if no other point c (that has not been removed yet) lies within the axis-aligned minimum bounding box of points a and b.Formally, point c lies within the axis-aligned minimum bounding box of points a and b if and only if min(xa,xb)\xe2\x89\xa4xc\xe2\x89\xa4max(xa,xb), min(ya,yb)\xe2\x89\xa4yc\xe2\x89\xa4max(ya,yb), and min(za,zb)\xe2\x89\xa4zc\xe2\x89\xa4max(za,zb). Note that the bounding box might be degenerate. Find a way to remove all points in n2 snaps." 1700
1237B "Balanced Tunnel" "data structures,sortings,two pointers" "Consider a tunnel on a one-way road. During a particular day, n cars numbered from 1 to n entered and exited the tunnel exactly once. All the cars passed through the tunnel at constant speeds.A traffic enforcement camera is mounted at the tunnel entrance. Another traffic enforcement camera is mounted at the tunnel exit. Perfectly balanced.Thanks to the cameras, the order in which the cars entered and exited the tunnel is known. No two cars entered or exited at the same time.Traffic regulations prohibit overtaking inside the tunnel. If car i overtakes any other car j inside the tunnel, car i must be fined. However, each car can be fined at most once.Formally, let\'s say that car i definitely overtook car j if car i entered the tunnel later than car j and exited the tunnel earlier than car j. Then, car i must be fined if and only if it definitely overtook at least one other car.Find the number of cars that must be fined." 1300
1237A "Balanced Rating Changes" implementation,math "Another Codeforces Round has just finished! It has gathered n participants, and according to the results, the expected rating change of participant i is ai. These rating changes are perfectly balancedÂ \xe2\x80\x94 their sum is equal to 0.Unfortunately, due to minor technical glitches, the round is declared semi-rated. It means that all rating changes must be divided by two.There are two conditions though:   For each participant i, their modified rating change bi must be integer, and as close to ai2 as possible. It means that either bi=\xe2\x8c\x8aai2\xe2\x8c\x8b or bi=\xe2\x8c\x88ai2\xe2\x8c\x89. In particular, if ai is even, bi=ai2. Here \xe2\x8c\x8ax\xe2\x8c\x8b denotes rounding down to the largest integer not greater than x, and \xe2\x8c\x88x\xe2\x8c\x89 denotes rounding up to the smallest integer not smaller than x.  The modified rating changes must be perfectly balancedÂ \xe2\x80\x94 their sum must be equal to 0. Can you help with that?" 1000
1236F "Alice and the Cactus" "dfs and similar,graphs,math,probabilities" "Alice recently found some cactuses growing near her house! After several months, more and more cactuses appeared and soon they blocked the road. So Alice wants to clear them.A cactus is a connected undirected graph. No edge of this graph lies on more than one simple cycle. Let\'s call a sequence of different nodes of the graph x1,x2,\xe2\x80\xa6,xk a simple cycle, if k\xe2\x89\xa53 and all pairs of nodes x1 and x2, x2 and x3, \xe2\x80\xa6, xk\xe2\x88\x921 and xk, xk and x1 are connected with edges. Edges (x1,x2), (x2,x3), \xe2\x80\xa6, (xk\xe2\x88\x921,xk), (xk,x1) lies on this simple cycle.There are so many cactuses, so it seems hard to destroy them. But Alice has magic. When she uses the magic, every node of the cactus will be removed independently with the probability 12. When a node is removed, the edges connected to it are also removed.Now Alice wants to test her magic. She has picked a cactus with n nodes and m edges. Let X[S] (where S is a subset of the removed nodes) be the number of connected components in the remaining graph after removing nodes of set S. Before she uses magic, she wants to know the variance of random variable X, if all nodes of the graph have probability 12 to be removed and all n of these events are independent. By the definition the variance is equal to E[(X\xe2\x88\x92E[X])2], where E[X] is the expected value of X. Help her and calculate this value by modulo 109+7.Formally, let M=109+7 (a prime number). It can be shown that the answer can be expressed as an irreducible fraction pq, where p and q are integers and q\xe2\x89\xa20(modM). Output the integer equal to p\xe2\x8b\x85q\xe2\x88\x921modM. In other words, find such an integer x that 0\xe2\x89\xa4x<M and x\xe2\x8b\x85q\xe2\x89\xa1p(modM)." 3000
1236E "Alice and the Unfair Game" "binary search,data structures,dp,dsu" "Alice is playing a game with her good friend, Marisa.There are n boxes arranged in a line, numbered with integers from 1 to n from left to right. Marisa will hide a doll in one of the boxes. Then Alice will have m chances to guess where the doll is. If Alice will correctly guess the number of box, where doll is now, she will win the game, otherwise, her friend will win the game.In order to win, Marisa will use some unfair tricks. After each time Alice guesses a box, she can move the doll to the neighboring box or just keep it at its place. Boxes i and i+1 are neighboring for all 1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921. She can also use this trick once before the game starts.So, the game happens in this order: the game starts, Marisa makes the trick, Alice makes the first guess, Marisa makes the trick, Alice makes the second guess, Marisa makes the trick, \xe2\x80\xa6, Alice makes m-th guess, Marisa makes the trick, the game ends.Alice has come up with a sequence a1,a2,\xe2\x80\xa6,am. In the i-th guess, she will ask if the doll is in the box ai. She wants to know the number of scenarios (x,y) (for all 1\xe2\x89\xa4x,y\xe2\x89\xa4n), such that Marisa can win the game if she will put the doll at the x-th box at the beginning and at the end of the game, the doll will be at the y-th box. Help her and calculate this number." 2500
1236D "Alice and the Doll" "brute force,data structures,greedy,implementation" "Alice got a new doll these days. It can even walk!Alice has built a maze for the doll and wants to test it. The maze is a grid with n rows and m columns. There are k obstacles, the i-th of them is on the cell (xi,yi), which means the cell in the intersection of the xi-th row and the yi-th column.However, the doll is clumsy in some ways. It can only walk straight or turn right at most once in the same cell (including the start cell). It cannot get into a cell with an obstacle or get out of the maze.More formally, there exist 4 directions, in which the doll can look:  The doll looks in the direction along the row from the first cell to the last. While moving looking in this direction the doll will move from the cell (x,y) into the cell (x,y+1);  The doll looks in the direction along the column from the first cell to the last. While moving looking in this direction the doll will move from the cell (x,y) into the cell (x+1,y);  The doll looks in the direction along the row from the last cell to first. While moving looking in this direction the doll will move from the cell (x,y) into the cell (x,y\xe2\x88\x921);  The doll looks in the direction along the column from the last cell to the first. While moving looking in this direction the doll will move from the cell (x,y) into the cell (x\xe2\x88\x921,y). .Standing in some cell the doll can move into the cell in the direction it looks or it can turn right once. Turning right once, the doll switches it\'s direction by the following rules: 1\xe2\x86\x922, 2\xe2\x86\x923, 3\xe2\x86\x924, 4\xe2\x86\x921. Standing in one cell, the doll can make at most one turn right.Now Alice is controlling the doll\'s moves. She puts the doll in of the cell (1,1) (the upper-left cell of the maze). Initially, the doll looks to the direction 1, so along the row from the first cell to the last. She wants to let the doll walk across all the cells without obstacles exactly once and end in any place. Can it be achieved?" 2300
1236C Labs "constructive algorithms,greedy,implementation" "In order to do some research, n2 labs are built on different heights of a mountain. Let\'s enumerate them with integers from 1 to n2, such that the lab with the number 1 is at the lowest place, the lab with the number 2 is at the second-lowest place, \xe2\x80\xa6, the lab with the number n2 is at the highest place.To transport water between the labs, pipes are built between every pair of labs. A pipe can transport at most one unit of water at a time from the lab with the number u to the lab with the number v if u>v.Now the labs need to be divided into n groups, each group should contain exactly n labs. The labs from different groups can transport water to each other. The sum of units of water that can be sent from a group A to a group B is equal to the number of pairs of labs (u,v) such that the lab with the number u is from the group A, the lab with the number v is from the group B and u>v. Let\'s denote this value as f(A,B) (i.e. f(A,B) is the sum of units of water that can be sent from a group A to a group B).For example, if n=3 and there are 3 groups X, Y and Z: X={1,5,6},Y={2,4,9} and Z={3,7,8}. In this case, the values of f are equal to:  f(X,Y)=4 because of 5\xe2\x86\x922, 5\xe2\x86\x924, 6\xe2\x86\x922, 6\xe2\x86\x924,  f(X,Z)=2 because of 5\xe2\x86\x923, 6\xe2\x86\x923,  f(Y,X)=5 because of 2\xe2\x86\x921, 4\xe2\x86\x921, 9\xe2\x86\x921, 9\xe2\x86\x925, 9\xe2\x86\x926,  f(Y,Z)=4 because of 4\xe2\x86\x923, 9\xe2\x86\x923, 9\xe2\x86\x927, 9\xe2\x86\x928,  f(Z,X)=7 because of 3\xe2\x86\x921, 7\xe2\x86\x921, 7\xe2\x86\x925, 7\xe2\x86\x926, 8\xe2\x86\x921, 8\xe2\x86\x925, 8\xe2\x86\x926,  f(Z,Y)=5 because of 3\xe2\x86\x922, 7\xe2\x86\x922, 7\xe2\x86\x924, 8\xe2\x86\x922, 8\xe2\x86\x924. Please, divide labs into n groups with size n, such that the value minf(A,B) over all possible pairs of groups A and B (A\xe2\x89\xa0B) is maximal.In other words, divide labs into n groups with size n, such that minimum number of the sum of units of water that can be transported from a group A to a group B for every pair of different groups A and B (A\xe2\x89\xa0B) as big as possible.Note, that the example above doesn\'t demonstrate an optimal division, but it demonstrates how to calculate the values f for some division.If there are many optimal divisions, you can find any." 1300
1236B "Alice and the List of Presents" combinatorics,math "Alice got many presents these days. So she decided to pack them into boxes and send them to her friends.There are n kinds of presents. Presents of one kind are identical (i.e. there is no way to distinguish two gifts of the same kind). Presents of different kinds are different (i.e. that is, two gifts of different kinds are distinguishable). The number of presents of each kind, that Alice has is very big, so we can consider Alice has an infinite number of gifts of each kind.Also, there are m boxes. All of them are for different people, so they are pairwise distinct (consider that the names of m friends are written on the boxes). For example, putting the first kind of present into the first box but not into the second box, is different from putting the first kind of present into the second box but not into the first box.Alice wants to pack presents with the following rules:  She won\'t pack more than one present of each kind into the same box, so each box should contain presents of different kinds (i.e. each box contains a subset of n kinds, empty boxes are allowed);  For each kind at least one present should be packed into some box. Now Alice wants to know how many different ways to pack the presents exists. Please, help her and calculate this number. Since the answer can be huge, output it by modulo 109+7.See examples and their notes for clarification." 1500
1236A Stones "brute force,greedy,math" "Alice is playing with some stones.Now there are three numbered heaps of stones. The first of them contains a stones, the second of them contains b stones and the third of them contains c stones.Each time she can do one of two operations:  take one stone from the first heap and two stones from the second heap (this operation can be done only if the first heap contains at least one stone and the second heap contains at least two stones);  take one stone from the second heap and two stones from the third heap (this operation can be done only if the second heap contains at least one stone and the third heap contains at least two stones). She wants to get the maximum number of stones, but she doesn\'t know what to do. Initially, she has 0 stones. Can you help her?" 800
1234F "Yet Another Substring Reverse" bitmasks,dp "You are given a string s consisting only of first 20 lowercase Latin letters (\'a\', \'b\', ..., \'t\').Recall that the substring s[l;r] of the string s is the string slsl+1\xe2\x80\xa6sr. For example, the substrings of ""codeforces"" are ""code"", ""force"", ""f"", ""for"", but not ""coder"" and ""top"".You can perform the following operation no more than once: choose some substring s[l;r] and reverse it (i.e. the string slsl+1\xe2\x80\xa6sr becomes srsr\xe2\x88\x921\xe2\x80\xa6sl).Your goal is to maximize the length of the maximum substring of s consisting of distinct (i.e. unique) characters.The string consists of distinct characters if no character in this string appears more than once. For example, strings ""abcde"", ""arctg"" and ""minecraft"" consist of distinct characters but strings ""codeforces"", ""abacaba"" do not consist of distinct characters." 2200
1234E "Special Permutations" math "Let\'s define pi(n) as the following permutation: [i,1,2,\xe2\x80\xa6,i\xe2\x88\x921,i+1,\xe2\x80\xa6,n]. This means that the i-th permutation is almost identity (i.e. which maps every element to itself) permutation but the element i is on the first position. Examples:  p1(4)=[1,2,3,4];  p2(4)=[2,1,3,4];  p3(4)=[3,1,2,4];  p4(4)=[4,1,2,3]. You are given an array x1,x2,\xe2\x80\xa6,xm (1\xe2\x89\xa4xi\xe2\x89\xa4n).Let pos(p,val) be the position of the element val in p. So, pos(p1(4),3)=3,pos(p2(4),2)=1,pos(p4(4),4)=1.Let\'s define a function f(p)=m\xe2\x88\x921\xe2\x88\x91i=1|pos(p,xi)\xe2\x88\x92pos(p,xi+1)|, where |val| is the absolute value of val. This function means the sum of distances between adjacent elements of x in p.Your task is to calculate f(p1(n)),f(p2(n)),\xe2\x80\xa6,f(pn(n))." 2000
1234D "Distinct Characters Queries" "data structures" "You are given a string s consisting of lowercase Latin letters and q queries for this string.Recall that the substring s[l;r] of the string s is the string slsl+1\xe2\x80\xa6sr. For example, the substrings of ""codeforces"" are ""code"", ""force"", ""f"", ""for"", but not ""coder"" and ""top"".There are two types of queries:   1Â posÂ c (1\xe2\x89\xa4pos\xe2\x89\xa4|s|, c is lowercase Latin letter): replace spos with c (set spos:=c);  2Â lÂ r (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4|s|): calculate the number of distinct characters in the substring s[l;r]." 1600
1234C Pipes dp,implementation "You are given a system of pipes. It consists of two rows, each row consists of n pipes. The top left pipe has the coordinates (1,1) and the bottom right \xe2\x80\x94 (2,n).There are six types of pipes: two types of straight pipes and four types of curved pipes. Here are the examples of all six types:  Types of pipes You can turn each of the given pipes 90 degrees clockwise or counterclockwise arbitrary (possibly, zero) number of times (so the types 1 and 2 can become each other and types 3,4,5,6 can become each other).You want to turn some pipes in a way that the water flow can start at (1,0) (to the left of the top left pipe), move to the pipe at (1,1), flow somehow by connected pipes to the pipe at (2,n) and flow right to (2,n+1).Pipes are connected if they are adjacent in the system and their ends are connected. Here are examples of connected pipes:  Examples of connected pipes Let\'s describe the problem using some example:  The first example input And its solution is below:   The first example answer As you can see, the water flow is the poorly drawn blue line. To obtain the answer, we need to turn the pipe at (1,2) 90 degrees clockwise, the pipe at (2,3) 90 degrees, the pipe at (1,6) 90 degrees, the pipe at (1,7) 180 degrees and the pipe at (2,7) 180 degrees. Then the flow of water can reach (2,n+1) from (1,0).You have to answer q independent queries." 1500
1234B2 "Social Network (hard version)" "data structures,implementation" "The only difference between easy and hard versions are constraints on n and k.You are messaging in one of the popular social networks via your smartphone. Your smartphone can show at most k most recent conversations with your friends. Initially, the screen is empty (i.e. the number of displayed conversations equals 0).Each conversation is between you and some of your friends. There is at most one conversation with any of your friends. So each conversation is uniquely defined by your friend.You (suddenly!) have the ability to see the future. You know that during the day you will receive n messages, the i-th message will be received from the friend with ID idi (1\xe2\x89\xa4idi\xe2\x89\xa4109).If you receive a message from idi in the conversation which is currently displayed on the smartphone then nothing happens: the conversations of the screen do not change and do not change their order, you read the message and continue waiting for new messages.Otherwise (i.e. if there is no conversation with idi on the screen):  Firstly, if the number of conversations displayed on the screen is k, the last conversation (which has the position k) is removed from the screen.  Now the number of conversations on the screen is guaranteed to be less than k and the conversation with the friend idi is not displayed on the screen.  The conversation with the friend idi appears on the first (the topmost) position on the screen and all the other displayed conversations are shifted one position down. Your task is to find the list of conversations (in the order they are displayed on the screen) after processing all n messages." 1300
1234B1 "Social Network (easy version)" implementation "The only difference between easy and hard versions are constraints on n and k.You are messaging in one of the popular social networks via your smartphone. Your smartphone can show at most k most recent conversations with your friends. Initially, the screen is empty (i.e. the number of displayed conversations equals 0).Each conversation is between you and some of your friends. There is at most one conversation with any of your friends. So each conversation is uniquely defined by your friend.You (suddenly!) have the ability to see the future. You know that during the day you will receive n messages, the i-th message will be received from the friend with ID idi (1\xe2\x89\xa4idi\xe2\x89\xa4109).If you receive a message from idi in the conversation which is currently displayed on the smartphone then nothing happens: the conversations of the screen do not change and do not change their order, you read the message and continue waiting for new messages.Otherwise (i.e. if there is no conversation with idi on the screen):  Firstly, if the number of conversations displayed on the screen is k, the last conversation (which has the position k) is removed from the screen.  Now the number of conversations on the screen is guaranteed to be less than k and the conversation with the friend idi is not displayed on the screen.  The conversation with the friend idi appears on the first (the topmost) position on the screen and all the other displayed conversations are shifted one position down. Your task is to find the list of conversations (in the order they are displayed on the screen) after processing all n messages." 1000
1234A "Equalize Prices Again" math "You are both a shop keeper and a shop assistant at a small nearby shop. You have n goods, the i-th good costs ai coins.You got tired of remembering the price of each product when customers ask for it, thus you decided to simplify your life. More precisely you decided to set the same price for all n goods you have.However, you don\'t want to lose any money so you want to choose the price in such a way that the sum of new prices is not less than the sum of the initial prices. It means that if you sell all n goods for the new price, you will receive at least the same (or greater) amount of money as if you sell them for their initial prices.On the other hand, you don\'t want to lose customers because of big prices so among all prices you can choose you need to choose the minimum one.So you need to find the minimum possible equal price of all n goods so if you sell them for this price, you will receive at least the same (or greater) amount of money as if you sell them for their initial prices.You have to answer q independent queries." 800
1231E Middle-Out "constructive algorithms,greedy,strings" "The problem was inspired by Pied Piper story. After a challenge from Hooli\'s compression competitor Nucleus, Richard pulled an all-nighter to invent a new approach to compression: middle-out.You are given two strings s and t of the same length n. Their characters are numbered from 1 to n from left to right (i.e. from the beginning to the end).In a single move you can do the following sequence of actions:  choose any valid index i (1\xe2\x89\xa4i\xe2\x89\xa4n),  move the i-th character of s from its position to the beginning of the string or move the i-th character of s from its position to the end of the string. Note, that the moves don\'t change the length of the string s. You can apply a move only to the string s.For example, if s=""test"" in one move you can obtain:  if i=1 and you move to the beginning, then the result is ""test"" (the string doesn\'t change),  if i=2 and you move to the beginning, then the result is ""etst"",  if i=3 and you move to the beginning, then the result is ""stet"",  if i=4 and you move to the beginning, then the result is ""ttes"",  if i=1 and you move to the end, then the result is ""estt"",  if i=2 and you move to the end, then the result is ""tste"",  if i=3 and you move to the end, then the result is ""tets"",  if i=4 and you move to the end, then the result is ""test"" (the string doesn\'t change). You want to make the string s equal to the string t. What is the minimum number of moves you need? If it is impossible to transform s to t, print -1." 2200
1231C "Increasing Matrix" greedy "In this problem, a n\xc3\x97m rectangular matrix a is called increasing if, for each row of i, when go from left to right, the values strictly increase (that is, ai,1<ai,2<\xe2\x8b\xaf<ai,m) and for each column j, when go from top to bottom, the values strictly increase (that is, a1,j<a2,j<\xe2\x8b\xaf<an,j).In a given matrix of non-negative integers, it is necessary to replace each value of 0 with some positive integer so that the resulting matrix is increasing and the sum of its elements is maximum, or find that it is impossible.It is guaranteed that in a given value matrix all values of 0 are contained only in internal cells (that is, not in the first or last row and not in the first or last column)." 1100
1230B "Ania and Minimizing" greedy,implementation "Ania has a large integer S. Its decimal representation has length n and doesn\'t contain any leading zeroes. Ania is allowed to change at most k digits of S. She wants to do it in such a way that S still won\'t contain any leading zeroes and it\'ll be minimal possible. What integer will Ania finish with?" 1000
1230A "Dawid and Bags of Candies" "brute force,implementation" "Dawid has four bags of candies. The i-th of them contains ai candies. Also, Dawid has two friends. He wants to give each bag to one of his two friends. Is it possible to distribute the bags in such a way that each friend receives the same amount of candies in total?Note, that you can\'t keep bags for yourself or throw them away, each bag should be given to one of the friends." 800
1228F "One Node is Gone" "constructive algorithms,implementation,trees" "You have an integer n. Let\'s define following tree generation as McDic\'s generation:  Make a complete and full binary tree of 2n\xe2\x88\x921 vertices. Complete and full binary tree means a tree that exactly one vertex is a root, all leaves have the same depth (distance from the root), and all non-leaf nodes have exactly two child nodes.  Select a non-root vertex v from that binary tree.  Remove v from tree and make new edges between v\'s parent and v\'s direct children. If v has no children, then no new edges will be made. You have a tree. Determine if this tree can be made by McDic\'s generation. If yes, then find the parent vertex of removed vertex in tree." 2500
1228E "Another Filling the Grid" combinatorics,dp,math "You have n\xc3\x97n square grid and an integer k. Put an integer in each cell while satisfying the conditions below.  All numbers in the grid should be between 1 and k inclusive.  Minimum number of the i-th row is 1 (1\xe2\x89\xa4i\xe2\x89\xa4n).  Minimum number of the j-th column is 1 (1\xe2\x89\xa4j\xe2\x89\xa4n). Find the number of ways to put integers in the grid. Since the answer can be very large, find the answer modulo (109+7).  These are the examples of valid and invalid grid when n=k=2." 2300
1228D "Complete Tripartite" "brute force,constructive algorithms,graphs,hashing,implementation" "You have a simple undirected graph consisting of n vertices and m edges. The graph doesn\'t contain self-loops, there is at most one edge between a pair of vertices. The given graph can be disconnected.Let\'s make a definition.Let v1 and v2 be two some nonempty subsets of vertices that do not intersect. Let f(v1,v2) be true if and only if all the conditions are satisfied:  There are no edges with both endpoints in vertex set v1.  There are no edges with both endpoints in vertex set v2.  For every two vertices x and y such that x is in v1 and y is in v2, there is an edge between x and y. Create three vertex sets (v1, v2, v3) which satisfy the conditions below;  All vertex sets should not be empty.  Each vertex should be assigned to only one vertex set.  f(v1,v2), f(v2,v3), f(v3,v1) are all true. Is it possible to create such three vertex sets? If it\'s possible, print matching vertex set for each vertex." 1900
1228C "Primes and Multiplication" "math,number theory" "Let\'s introduce some definitions that will be needed later.Let prime(x) be the set of prime divisors of x. For example, prime(140)={2,5,7}, prime(169)={13}.Let g(x,p) be the maximum possible integer pk where k is an integer such that x is divisible by pk. For example:  g(45,3)=9 (45 is divisible by 32=9 but not divisible by 33=27),  g(63,7)=7 (63 is divisible by 71=7 but not divisible by 72=49). Let f(x,y) be the product of g(y,p) for all p in prime(x). For example:  f(30,70)=g(70,2)\xe2\x8b\x85g(70,3)\xe2\x8b\x85g(70,5)=21\xe2\x8b\x8530\xe2\x8b\x8551=10,  f(525,63)=g(63,3)\xe2\x8b\x85g(63,5)\xe2\x8b\x85g(63,7)=32\xe2\x8b\x8550\xe2\x8b\x8571=63. You have integers x and n. Calculate f(x,1)\xe2\x8b\x85f(x,2)\xe2\x8b\x85\xe2\x80\xa6\xe2\x8b\x85f(x,n)mod(109+7)." 1700
1228B "Filling the Grid" implementation,math "Suppose there is a h\xc3\x97w grid consisting of empty or full cells. Let\'s make some definitions:  ri is the number of consecutive full cells connected to the left side in the i-th row (1\xe2\x89\xa4i\xe2\x89\xa4h). In particular, ri=0 if the leftmost cell of the i-th row is empty.  cj is the number of consecutive full cells connected to the top end in the j-th column (1\xe2\x89\xa4j\xe2\x89\xa4w). In particular, cj=0 if the topmost cell of the j-th column is empty. In other words, the i-th row starts exactly with ri full cells. Similarly, the j-th column starts exactly with cj full cells.  These are the r and c values of some 3\xc3\x974 grid. Black cells are full and white cells are empty. You have values of r and c. Initially, all cells are empty. Find the number of ways to fill grid cells to satisfy values of r and c. Since the answer can be very large, find the answer modulo 1000000007(109+7). In other words, find the remainder after division of the answer by 1000000007(109+7)." 1400
1228A "Distinct Digits" "brute force,implementation" "You have two integers l and r. Find an integer x which satisfies the conditions below:  l\xe2\x89\xa4x\xe2\x89\xa4r.  All digits of x are different. If there are multiple answers, print any of them." 800
1227G "Not Same" "constructive algorithms" "You are given an integer array a1,a2,\xe2\x80\xa6,an, where ai represents the number of blocks at the i-th position. It is guaranteed that 1\xe2\x89\xa4ai\xe2\x89\xa4n. In one operation you can choose a subset of indices of the given array and remove one block in each of these indices. You can\'t remove a block from a position without blocks.All subsets that you choose should be different (unique).You need to remove all blocks in the array using at most n+1 operations. It can be proved that the answer always exists." 2600
1227F2 "Wrong Answer on test 233 (Hard Version)" combinatorics,math "Your program fails again. This time it gets ""Wrong answer on test 233"".This is the harder version of the problem. In this version, 1\xe2\x89\xa4n\xe2\x89\xa42\xe2\x8b\x85105. You can hack this problem if you locked it. But you can hack the previous problem only if you locked both problems.The problem is to finish n one-choice-questions. Each of the questions contains k options, and only one of them is correct. The answer to the i-th question is hi, and if your answer of the question i is hi, you earn 1 point, otherwise, you earn 0 points for this question. The values h1,h2,\xe2\x80\xa6,hn are known to you in this problem.However, you have a mistake in your program. It moves the answer clockwise! Consider all the n answers are written in a circle. Due to the mistake in your program, they are shifted by one cyclically.Formally, the mistake moves the answer for the question i to the question imodn+1. So it moves the answer for the question 1 to question 2, the answer for the question 2 to the question 3, ..., the answer for the question n to the question 1.We call all the n answers together an answer suit. There are kn possible answer suits in total.You\'re wondering, how many answer suits satisfy the following condition: after moving clockwise by 1, the total number of points of the new answer suit is strictly larger than the number of points of the old one. You need to find the answer modulo 998244353.For example, if n=5, and your answer suit is a=[1,2,3,4,5], it will submitted as a\xe2\x80\xb2=[5,1,2,3,4] because of a mistake. If the correct answer suit is h=[5,2,2,3,4], the answer suit a earns 1 point and the answer suite a\xe2\x80\xb2 earns 4 points. Since 4>1, the answer suit a=[1,2,3,4,5] should be counted." 2400
1227F1 "Wrong Answer on test 233 (Easy Version)" dp "Your program fails again. This time it gets ""Wrong answer on test 233"".This is the easier version of the problem. In this version 1\xe2\x89\xa4n\xe2\x89\xa42000. You can hack this problem only if you solve and lock both problems.The problem is about a test containing n one-choice-questions. Each of the questions contains k options, and only one of them is correct. The answer to the i-th question is hi, and if your answer of the question i is hi, you earn 1 point, otherwise, you earn 0 points for this question. The values h1,h2,\xe2\x80\xa6,hn are known to you in this problem.However, you have a mistake in your program. It moves the answer clockwise! Consider all the n answers are written in a circle. Due to the mistake in your program, they are shifted by one cyclically.Formally, the mistake moves the answer for the question i to the question imodn+1. So it moves the answer for the question 1 to question 2, the answer for the question 2 to the question 3, ..., the answer for the question n to the question 1.We call all the n answers together an answer suit. There are kn possible answer suits in total.You\'re wondering, how many answer suits satisfy the following condition: after moving clockwise by 1, the total number of points of the new answer suit is strictly larger than the number of points of the old one. You need to find the answer modulo 998244353.For example, if n=5, and your answer suit is a=[1,2,3,4,5], it will submitted as a\xe2\x80\xb2=[5,1,2,3,4] because of a mistake. If the correct answer suit is h=[5,2,2,3,4], the answer suit a earns 1 point and the answer suite a\xe2\x80\xb2 earns 4 points. Since 4>1, the answer suit a=[1,2,3,4,5] should be counted." 2200
1227E "Arson In Berland Forest" "binary search,graphs,graphs,shortest paths" "The Berland Forest can be represented as an infinite cell plane. Every cell contains a tree. That is, contained before the recent events.A destructive fire raged through the Forest, and several trees were damaged by it. Precisely speaking, you have a n\xc3\x97m rectangle map which represents the damaged part of the Forest. The damaged trees were marked as ""X"" while the remaining ones were marked as ""."". You are sure that all burnt trees are shown on the map. All the trees outside the map are undamaged.The firemen quickly extinguished the fire, and now they are investigating the cause of it. The main version is that there was an arson: at some moment of time (let\'s consider it as 0) some trees were set on fire. At the beginning of minute 0, only the trees that were set on fire initially were burning. At the end of each minute, the fire spread from every burning tree to each of 8 neighboring trees. At the beginning of minute T, the fire was extinguished.The firemen want to find the arsonists as quickly as possible. The problem is, they know neither the value of T (how long the fire has been raging) nor the coordinates of the trees that were initially set on fire. They want you to find the maximum value of T (to know how far could the arsonists escape) and a possible set of trees that could be initially set on fire.Note that you\'d like to maximize value T but the set of trees can be arbitrary." 2200
1227D2 "Optimal Subsequences (Hard Version)" "data structures,greedy" "This is the harder version of the problem. In this version, 1\xe2\x89\xa4n,m\xe2\x89\xa42\xe2\x8b\x85105. You can hack this problem if you locked it. But you can hack the previous problem only if you locked both problems.You are given a sequence of integers a=[a1,a2,\xe2\x80\xa6,an] of length n. Its subsequence is obtained by removing zero or more elements from the sequence a (they do not necessarily go consecutively). For example, for the sequence a=[11,20,11,33,11,20,11]:  [11,20,11,33,11,20,11], [11,20,11,33,11,20], [11,11,11,11], [20], [33,20] are subsequences (these are just some of the long list);  [40], [33,33], [33,20,20], [20,20,11,11] are not subsequences. Suppose that an additional non-negative integer k (1\xe2\x89\xa4k\xe2\x89\xa4n) is given, then the subsequence is called optimal if:  it has a length of k and the sum of its elements is the maximum possible among all subsequences of length k;  and among all subsequences of length k that satisfy the previous item, it is lexicographically minimal. Recall that the sequence b=[b1,b2,\xe2\x80\xa6,bk] is lexicographically smaller than the sequence c=[c1,c2,\xe2\x80\xa6,ck] if the first element (from the left) in which they differ less in the sequence b than in c. Formally: there exists t (1\xe2\x89\xa4t\xe2\x89\xa4k) such that b1=c1, b2=c2, ..., bt\xe2\x88\x921=ct\xe2\x88\x921 and at the same time bt<ct. For example:  [10,20,20] lexicographically less than [10,21,1],  [7,99,99] is lexicographically less than [10,21,1],  [10,21,0] is lexicographically less than [10,21,1]. You are given a sequence of a=[a1,a2,\xe2\x80\xa6,an] and m requests, each consisting of two numbers kj and posj (1\xe2\x89\xa4k\xe2\x89\xa4n, 1\xe2\x89\xa4posj\xe2\x89\xa4kj). For each query, print the value that is in the index posj of the optimal subsequence of the given sequence a for k=kj.For example, if n=4, a=[10,20,30,20], kj=2, then the optimal subsequence is [20,30] \xe2\x80\x94 it is the minimum lexicographically among all subsequences of length 2 with the maximum total sum of items. Thus, the answer to the request kj=2, posj=1 is the number 20, and the answer to the request kj=2, posj=2 is the number 30." 1800
1227D1 "Optimal Subsequences (Easy Version)" "data structures,greedy" "This is the easier version of the problem. In this version 1\xe2\x89\xa4n,m\xe2\x89\xa4100. You can hack this problem only if you solve and lock both problems.You are given a sequence of integers a=[a1,a2,\xe2\x80\xa6,an] of length n. Its subsequence is obtained by removing zero or more elements from the sequence a (they do not necessarily go consecutively). For example, for the sequence a=[11,20,11,33,11,20,11]:  [11,20,11,33,11,20,11], [11,20,11,33,11,20], [11,11,11,11], [20], [33,20] are subsequences (these are just some of the long list);  [40], [33,33], [33,20,20], [20,20,11,11] are not subsequences. Suppose that an additional non-negative integer k (1\xe2\x89\xa4k\xe2\x89\xa4n) is given, then the subsequence is called optimal if:  it has a length of k and the sum of its elements is the maximum possible among all subsequences of length k;  and among all subsequences of length k that satisfy the previous item, it is lexicographically minimal. Recall that the sequence b=[b1,b2,\xe2\x80\xa6,bk] is lexicographically smaller than the sequence c=[c1,c2,\xe2\x80\xa6,ck] if the first element (from the left) in which they differ less in the sequence b than in c. Formally: there exists t (1\xe2\x89\xa4t\xe2\x89\xa4k) such that b1=c1, b2=c2, ..., bt\xe2\x88\x921=ct\xe2\x88\x921 and at the same time bt<ct. For example:  [10,20,20] lexicographically less than [10,21,1],  [7,99,99] is lexicographically less than [10,21,1],  [10,21,0] is lexicographically less than [10,21,1]. You are given a sequence of a=[a1,a2,\xe2\x80\xa6,an] and m requests, each consisting of two numbers kj and posj (1\xe2\x89\xa4k\xe2\x89\xa4n, 1\xe2\x89\xa4posj\xe2\x89\xa4kj). For each query, print the value that is in the index posj of the optimal subsequence of the given sequence a for k=kj.For example, if n=4, a=[10,20,30,20], kj=2, then the optimal subsequence is [20,30] \xe2\x80\x94 it is the minimum lexicographically among all subsequences of length 2 with the maximum total sum of items. Thus, the answer to the request kj=2, posj=1 is the number 20, and the answer to the request kj=2, posj=2 is the number 30." 1600
1227C Messy "constructive algorithms" "You are fed up with your messy room, so you decided to clean it up.Your room is a bracket sequence s=s1s2\xe2\x80\xa6sn of length n. Each character of this string is either an opening bracket \'(\' or a closing bracket \')\'.In one operation you can choose any consecutive substring of s and reverse it. In other words, you can choose any substring s[l\xe2\x80\xa6r]=sl,sl+1,\xe2\x80\xa6,sr and change the order of elements in it into sr,sr\xe2\x88\x921,\xe2\x80\xa6,sl.For example, if you will decide to reverse substring s[2\xe2\x80\xa64] of string s=""((()))"" it will be equal to s=""()(())"".A regular (aka balanced) bracket sequence is a bracket sequence that can be transformed into a correct arithmetic expression by inserting characters \'1\' and \'+\' between the original characters of the sequence. For example, bracket sequences ""()()"", ""(())"" are regular (the resulting expressions are: ""(1)+(1)"", ""((1+1)+1)""), and "")("" and ""("" are not.A prefix of a string s is a substring that starts at position 1. For example, for s=""(())()"" there are 6 prefixes: ""("", ""(("", ""(()"", ""(())"", ""(())("" and ""(())()"".In your opinion, a neat and clean room s is a bracket sequence that:  the whole string s is a regular bracket sequence;  and there are exactly k prefixes of this sequence which are regular (including whole s itself). For example, if k=2, then ""(())()"" is a neat and clean room.You want to use at most n operations to make your room neat and clean. Operations are applied one after another sequentially.It is guaranteed that the answer exists. Note that you do not need to minimize the number of operations: find any way to achieve the desired configuration in n or less operations." 1700
1227B Box "constructive algorithms" "Permutation p is a sequence of integers p=[p1,p2,\xe2\x80\xa6,pn], consisting of n distinct (unique) positive integers between 1 and n, inclusive. For example, the following sequences are permutations: [3,4,1,2], [1], [1,2]. The following sequences are not permutations: [0], [1,2,1], [2,3], [0,1,2].The important key is in the locked box that you need to open. To open the box you need to enter secret code. Secret code is a permutation p of length n. You don\'t know this permutation, you only know the array q of prefix maximums of this permutation. Formally:  q1=p1,  q2=max(p1,p2),  q3=max(p1,p2,p3),  ...  qn=max(p1,p2,\xe2\x80\xa6,pn). You want to construct any possible suitable permutation (i.e. any such permutation, that calculated q for this permutation is equal to the given array)." 1200
1227A "Math Problem" math "Your math teacher gave you the following problem:There are n segments on the x-axis, [l1;r1],[l2;r2],\xe2\x80\xa6,[ln;rn]. The segment [l;r] includes the bounds, i.e. it is a set of such x that l\xe2\x89\xa4x\xe2\x89\xa4r. The length of the segment [l;r] is equal to r\xe2\x88\x92l.Two segments [a;b] and [c;d] have a common point (intersect) if there exists x that a\xe2\x89\xa4x\xe2\x89\xa4b and c\xe2\x89\xa4x\xe2\x89\xa4d. For example, [2;5] and [3;10] have a common point, but [5;6] and [1;4] don\'t have.You should add one segment, which has at least one common point with each of the given segments and as short as possible (i.e. has minimal length). The required segment can degenerate to be a point (i.e a segment with length zero). The added segment may or may not be among the given n segments.In other words, you need to find a segment [a;b], such that [a;b] and every [li;ri] have a common point for each i, and b\xe2\x88\x92a is minimal." 1100
1225G "To Make 1" "bitmasks,constructive algorithms,dp,greedy,number theory" "There are n positive integers written on the blackboard. Also, a positive number k\xe2\x89\xa52 is chosen, and none of the numbers on the blackboard are divisible by k. In one operation, you can choose any two integers x and y, erase them and write one extra number f(x+y), where f(x) is equal to x if x is not divisible by k, otherwise f(x)=f(x/k).In the end, there will be a single number of the blackboard. Is it possible to make the final number equal to 1? If so, restore any sequence of operations to do so." 3100
1225F "Tree Factory" "constructive algorithms,greedy,trees" "Bytelandian Tree Factory produces trees for all kinds of industrial applications. You have been tasked with optimizing the production of a certain type of tree for an especially large and important order.The tree in question is a rooted tree with n vertices labelled with distinct integers from 0 to n\xe2\x88\x921. The vertex labelled 0 is the root of the tree, and for any non-root vertex v the label of its parent p(v) is less than the label of v.All trees at the factory are made from bamboo blanks. A bamboo is a rooted tree such that each vertex has exactly one child, except for a single leaf vertex with no children. The vertices of a bamboo blank can be labelled arbitrarily before its processing is started.To process a bamboo into another tree a single type of operation can be made: choose an arbitrary non-root vertex v such that its parent p(v) is not a root either. The operation consists of changing the parent of v to its parent\'s parent p(p(v)). Note that parents of all other vertices remain unchanged, in particular, the subtree of v does not change.Efficiency is crucial, hence you have to minimize the number of operations to make the desired tree from a bamboo blank. Construct any optimal sequence of operations to produce the desired tree.Note that the labelling of the resulting tree has to coincide with the labelling of the desired tree. Formally, the labels of the roots have to be equal, and for non-root vertices with the same label the labels of their parents should be the same.It is guaranteed that for any test present in this problem an answer exists, and further, an optimal sequence contains at most 106 operations. Note that any hack that does not meet these conditions will be invalid." 2500
1225E "Rock Is Push" "binary search,dp" "You are at the top left cell (1,1) of an n\xc3\x97m labyrinth. Your goal is to get to the bottom right cell (n,m). You can only move right or down, one cell per step. Moving right from a cell (x,y) takes you to the cell (x,y+1), while moving down takes you to the cell (x+1,y).Some cells of the labyrinth contain rocks. When you move to a cell with rock, the rock is pushed to the next cell in the direction you\'re moving. If the next cell contains a rock, it gets pushed further, and so on.The labyrinth is surrounded by impenetrable walls, thus any move that would put you or any rock outside of the labyrinth is illegal.Count the number of different legal paths you can take from the start to the goal modulo 109+7. Two paths are considered different if there is at least one cell that is visited in one path, but not visited in the other." 2200
1225D "Power Products" "hashing,math,number theory" "You are given n positive integers a1,\xe2\x80\xa6,an, and an integer k\xe2\x89\xa52. Count the number of pairs i,j such that 1\xe2\x89\xa4i<j\xe2\x89\xa4n, and there exists an integer x such that ai\xe2\x8b\x85aj=xk." 1800
1225C p-binary "bitmasks,brute force,math" "Vasya will fancy any number as long as it is an integer power of two. Petya, on the other hand, is very conservative and only likes a single integer p (which may be positive, negative, or zero). To combine their tastes, they invented p-binary numbers of the form 2x+p, where x is a non-negative integer.For example, some \xe2\x88\x929-binary (""minus nine"" binary) numbers are: \xe2\x88\x928 (minus eight), 7 and 1015 (\xe2\x88\x928=20\xe2\x88\x929, 7=24\xe2\x88\x929, 1015=210\xe2\x88\x929).The boys now use p-binary numbers to represent everything. They now face a problem: given a positive integer n, what\'s the smallest number of p-binary numbers (not necessarily distinct) they need to represent n as their sum? It may be possible that representation is impossible altogether. Help them solve this problem.For example, if p=0 we can represent 7 as 20+21+22.And if p=\xe2\x88\x929 we can represent 7 as one number (24\xe2\x88\x929).Note that negative p-binary numbers are allowed to be in the sum (see the Notes section for an example)." 1600
1225B2 "TV Subscriptions (Hard Version)" "implementation,two pointers" "The only difference between easy and hard versions is constraints.The BerTV channel every day broadcasts one episode of one of the k TV shows. You know the schedule for the next n days: a sequence of integers a1,a2,\xe2\x80\xa6,an (1\xe2\x89\xa4ai\xe2\x89\xa4k), where ai is the show, the episode of which will be shown in i-th day.The subscription to the show is bought for the entire show (i.e. for all its episodes), for each show the subscription is bought separately.How many minimum subscriptions do you need to buy in order to have the opportunity to watch episodes of purchased shows d (1\xe2\x89\xa4d\xe2\x89\xa4n) days in a row? In other words, you want to buy the minimum number of TV shows so that there is some segment of d consecutive days in which all episodes belong to the purchased shows." 1300
1225B1 "TV Subscriptions (Easy Version)" implementation "The only difference between easy and hard versions is constraints.The BerTV channel every day broadcasts one episode of one of the k TV shows. You know the schedule for the next n days: a sequence of integers a1,a2,\xe2\x80\xa6,an (1\xe2\x89\xa4ai\xe2\x89\xa4k), where ai is the show, the episode of which will be shown in i-th day.The subscription to the show is bought for the entire show (i.e. for all its episodes), for each show the subscription is bought separately.How many minimum subscriptions do you need to buy in order to have the opportunity to watch episodes of purchased shows d (1\xe2\x89\xa4d\xe2\x89\xa4n) days in a row? In other words, you want to buy the minimum number of TV shows so that there is some segment of d consecutive days in which all episodes belong to the purchased shows." 1000
1225A "Forgetting Things" math "Kolya is very absent-minded. Today his math teacher asked him to solve a simple problem with the equation a+1=b with positive integers a and b, but Kolya forgot the numbers a and b. He does, however, remember that the first (leftmost) digit of a was da, and the first (leftmost) digit of b was db.Can you reconstruct any equation a+1=b that satisfies this property? It may be possible that Kolya misremembers the digits, and there is no suitable equation, in which case report so." 900
1223G "Wooden Raft" "binary search,math,number theory" "Suppose you are stuck on a desert island. The only way to save yourself is to craft a wooden raft and go to the sea. Fortunately, you have a hand-made saw and a forest nearby. Moreover, you\'ve already cut several trees and prepared it to the point that now you have n logs and the i-th log has length ai.The wooden raft you\'d like to build has the following structure: 2 logs of length x and x logs of length y. Such raft would have the area equal to x\xe2\x8b\x85y. Both x and y must be integers since it\'s the only way you can measure the lengths while being on a desert island. And both x and y must be at least 2 since the raft that is one log wide is unstable.You can cut logs in pieces but you can\'t merge two logs in one. What is the maximum area of the raft you can craft?" 3200
1223F "Stack Exterminable Arrays" "data structures,divide and conquer,dp,hashing" "Let\'s look at the following process: initially you have an empty stack and an array s of the length l. You are trying to push array elements to the stack in the order s1,s2,s3,\xe2\x80\xa6sl. Moreover, if the stack is empty or the element at the top of this stack is not equal to the current element, then you just push the current element to the top of the stack. Otherwise, you don\'t push the current element to the stack and, moreover, pop the top element of the stack. If after this process the stack remains empty, the array s is considered stack exterminable.There are samples of stack exterminable arrays:   [1,1];  [2,1,1,2];  [1,1,2,2];  [1,3,3,1,2,2];  [3,1,3,3,1,3];  [3,3,3,3,3,3];  [5,1,2,2,1,4,4,5]; Let\'s consider the changing of stack more details if s=[5,1,2,2,1,4,4,5] (the top of stack is highlighted).   after pushing s1=5 the stack turn into [5];  after pushing s2=1 the stack turn into [5,1];  after pushing s3=2 the stack turn into [5,1,2];  after pushing s4=2 the stack turn into [5,1];  after pushing s5=1 the stack turn into [5];  after pushing s6=4 the stack turn into [5,4];  after pushing s7=4 the stack turn into [5];  after pushing s8=5 the stack is empty. You are given an array a1,a2,\xe2\x80\xa6,an. You have to calculate the number of its subarrays which are stack exterminable.Note, that you have to answer q independent queries." 2600
1223E "Paint the Tree" dp,sortings,trees "You are given a weighted tree consisting of n vertices. Recall that a tree is a connected graph without cycles. Vertices ui and vi are connected by an edge with weight wi.Let\'s define the k-coloring of the tree as an assignment of exactly k colors to each vertex, so that each color is used no more than two times. You can assume that you have infinitely many colors available. We say that an edge is saturated in the given k-coloring if its endpoints share at least one color (i.e. there exists a color that is assigned to both endpoints).Let\'s also define the value of a k-coloring as the sum of weights of saturated edges.Please calculate the maximum possible value of a k-coloring of the given tree.You have to answer q independent queries." 2100
1223D "Sequence Sorting" "dp,greedy,two pointers" "You are given a sequence a1,a2,\xe2\x80\xa6,an, consisting of integers.You can apply the following operation to this sequence: choose some integer x and move all elements equal to x either to the beginning, or to the end of a. Note that you have to move all these elements in one direction in one operation.For example, if a=[2,1,3,1,1,3,2], you can get the following sequences in one operation (for convenience, denote elements equal to x as x-elements):   [1,1,1,2,3,3,2] if you move all 1-elements to the beginning;  [2,3,3,2,1,1,1] if you move all 1-elements to the end;  [2,2,1,3,1,1,3] if you move all 2-elements to the beginning;  [1,3,1,1,3,2,2] if you move all 2-elements to the end;  [3,3,2,1,1,1,2] if you move all 3-elements to the beginning;  [2,1,1,1,2,3,3] if you move all 3-elements to the end; You have to determine the minimum number of such operations so that the sequence a becomes sorted in non-descending order. Non-descending order means that for all i from 2 to n, the condition ai\xe2\x88\x921\xe2\x89\xa4ai is satisfied.Note that you have to answer q independent queries." 2000
1223C "Save the Nature" "binary search,greedy" "You are an environmental activist at heart but the reality is harsh and you are just a cashier in a cinema. But you can still do something!You have n tickets to sell. The price of the i-th ticket is pi. As a teller, you have a possibility to select the order in which the tickets will be sold (i.e. a permutation of the tickets). You know that the cinema participates in two ecological restoration programs applying them to the order you chose:  The x% of the price of each the a-th sold ticket (a-th, 2a-th, 3a-th and so on) in the order you chose is aimed for research and spreading of renewable energy sources.  The y% of the price of each the b-th sold ticket (b-th, 2b-th, 3b-th and so on) in the order you chose is aimed for pollution abatement. If the ticket is in both programs then the (x+y)% are used for environmental activities. Also, it\'s known that all prices are multiples of 100, so there is no need in any rounding.For example, if you\'d like to sell tickets with prices [400,100,300,200] and the cinema pays 10% of each 2-nd sold ticket and 20% of each 3-rd sold ticket, then arranging them in order [100,200,300,400] will lead to contribution equal to 100\xe2\x8b\x850+200\xe2\x8b\x850.1+300\xe2\x8b\x850.2+400\xe2\x8b\x850.1=120. But arranging them in order [100,300,400,200] will lead to 100\xe2\x8b\x850+300\xe2\x8b\x850.1+400\xe2\x8b\x850.2+200\xe2\x8b\x850.1=130.Nature can\'t wait, so you decided to change the order of tickets in such a way, so that the total contribution to programs will reach at least k in minimum number of sold tickets. Or say that it\'s impossible to do so. In other words, find the minimum number of tickets which are needed to be sold in order to earn at least k." 1600
1223B "Strings Equalization" strings "You are given two strings of equal length s and t consisting of lowercase Latin letters. You may perform any number (possibly, zero) operations on these strings.During each operation you choose two adjacent characters in any string and assign the value of the first character to the value of the second or vice versa.For example, if s is ""acbc"" you can get the following strings in one operation:   ""aabc"" (if you perform s2=s1);  ""ccbc"" (if you perform s1=s2);  ""accc"" (if you perform s3=s2 or s3=s4);  ""abbc"" (if you perform s2=s3);  ""acbb"" (if you perform s4=s3); Note that you can also apply this operation to the string t.Please determine whether it is possible to transform s into t, applying the operation above any number of times.Note that you have to answer q independent queries." 1000
1223A CME math "Let\'s denote correct match equation (we will denote it as CME) an equation a+b=c there all integers a, b and c are greater than zero.For example, equations 2+2=4 (||+||=||||) and 1+2=3 (|+||=|||) are CME but equations 1+2=4 (|+||=||||), 2+2=3 (||+||=|||), and 0+1=1 (+|=|) are not.Now, you have n matches. You want to assemble a CME using all your matches. Unfortunately, it is possible that you can\'t assemble the CME using all matches. But you can buy some extra matches and then assemble CME!For example, if n=2, you can buy two matches and assemble |+|=||, and if n=5 you can buy one match and assemble ||+|=|||.   Calculate the minimum number of matches which you have to buy for assembling CME.Note, that you have to answer q independent queries." 800
1221G "Graph And Numbers" "bitmasks,brute force,combinatorics,dp,meet-in-the-middle" "You are given an undirected graph with n vertices and m edges. You have to write a number on each vertex of this graph, each number should be either 0 or 1. After that, you write a number on each edge equal to the sum of numbers on vertices incident to that edge.You have to choose the numbers you will write on the vertices so that there is at least one edge with 0 written on it, at least one edge with 1 and at least one edge with 2. How many ways are there to do it? Two ways to choose numbers are different if there exists at least one vertex which has different numbers written on it in these two ways." 2900
1221F "Choose a Square" "binary search,data structures,sortings" "Petya recently found a game ""Choose a Square"". In this game, there are n points numbered from 1 to n on an infinite field. The i-th point has coordinates (xi,yi) and cost ci.You have to choose a square such that its sides are parallel to coordinate axes, the lower left and upper right corners belong to the line y=x, and all corners have integer coordinates.The score you get is the sum of costs of the points covered by the selected square minus the length of the side of the square. Note that the length of the side can be zero.Petya asks you to calculate the maximum possible score in the game that can be achieved by placing exactly one square." 2400
1221E "Game With String" games "Alice and Bob play a game. Initially they have a string s1,s2,\xe2\x80\xa6,sn, consisting of only characters . and X. They take alternating turns, and Alice is moving first. During each turn, the player has to select a contiguous substring consisting only of characters . and replaces each of them with X. Alice must select a substing of length a, and Bob must select a substring of length b. It is guaranteed that a>b.For example, if s= ...X.. and a=3, b=2, then after Alice\'s move string can turn only into XXXX... And if it\'s Bob\'s turn and the string s= ...X.., then after Bob\'s move the string can turn into XX.X.., .XXX.. or ...XXX.Whoever is unable to make a move, loses. You have to determine who wins if they both play optimally.You have to answer q independent queries." 2500
1221D "Make The Fence Great Again" dp "You have a fence consisting of n vertical boards. The width of each board is 1. The height of the i-th board is ai. You think that the fence is great if there is no pair of adjacent boards having the same height. More formally, the fence is great if and only if for all indices from 2 to n, the condition ai\xe2\x88\x921\xe2\x89\xa0ai holds.Unfortunately, it is possible that now your fence is not great. But you can change it! You can increase the length of the i-th board by 1, but you have to pay bi rubles for it. The length of each board can be increased any number of times (possibly, zero).Calculate the minimum number of rubles you have to spend to make the fence great again!You have to answer q independent queries." 1800
1221C "Perfect Team" "binary search,math" "You may have already known that a standard ICPC team consists of exactly three members. The perfect team however has more restrictions. A student can have some specialization: coder or mathematician. She/he can have no specialization, but can\'t have both at the same time.So the team is considered perfect if it includes at least one coder, at least one mathematician and it consists of exactly three members.You are a coach at a very large university and you know that c of your students are coders, m are mathematicians and x have no specialization.What is the maximum number of full perfect teams you can distribute them into? Note that some students can be left without a team and each student can be a part of no more than one team.You are also asked to answer q independent queries." 1200
1221B Knights "constructive algorithms,greedy" "You are given a chess board with n rows and n columns. Initially all cells of the board are empty, and you have to put a white or a black knight into each cell of the board.A knight is a chess piece that can attack a piece in cell (x2, y2) from the cell (x1, y1) if one of the following conditions is met:  |x1\xe2\x88\x92x2|=2 and |y1\xe2\x88\x92y2|=1, or  |x1\xe2\x88\x92x2|=1 and |y1\xe2\x88\x92y2|=2. Here are some examples of which cells knight can attack. In each of the following pictures, if the knight is currently in the blue cell, it can attack all red cells (and only them).  A duel of knights is a pair of knights of different colors such that these knights attack each other. You have to put a knight (a white one or a black one) into each cell in such a way that the number of duels is maximum possible." 1100
1221A "2048 Game" "brute force,greedy,math" "You are playing a variation of game 2048. Initially you have a multiset s of n integers. Every integer in this multiset is a power of two. You may perform any number (possibly, zero) operations with this multiset.During each operation you choose two equal integers from s, remove them from s and insert the number equal to their sum into s.For example, if s={1,2,1,1,4,2,2} and you choose integers 2 and 2, then the multiset becomes {1,1,1,4,4,2}.You win if the number 2048 belongs to your multiset. For example, if s={1024,512,512,4} you can win as follows: choose 512 and 512, your multiset turns into {1024,1024,4}. Then choose 1024 and 1024, your multiset turns into {2048,4} and you win.You have to determine if you can win this game.You have to answer q independent queries." 1000
1220G Geolocation geometry "You are working for the Gryzzl company, headquartered in Pawnee, Indiana.The new national park has been opened near Pawnee recently and you are to implement a geolocation system, so people won\'t get lost. The concept you developed is innovative and minimalistic. There will be n antennas located somewhere in the park. When someone would like to know their current location, their Gryzzl hologram phone will communicate with antennas and obtain distances from a user\'s current location to all antennas.Knowing those distances and antennas locations it should be easy to recover a user\'s location... Right? Well, almost. The only issue is that there is no way to distinguish antennas, so you don\'t know, which distance corresponds to each antenna. Your task is to find a user\'s location given as little as all antennas location and an unordered multiset of distances." 3400
1220F "Gardener Alex" "binary search,data structures" "Gardener Alex loves to grow trees. We remind that tree is a connected acyclic graph on n vertices. Today he decided to grow a rooted binary tree. A binary tree is a tree where any vertex has no more than two sons. Luckily, Alex has a permutation of numbers from 1 to n which he was presented at his last birthday, so he decided to grow a tree according to this permutation. To do so he does the following process: he finds a minimum element and makes it a root of the tree. After that permutation is divided into two parts: everything that is to the left of the minimum element, and everything that is to the right. The minimum element on the left part becomes the left son of the root, and the minimum element on the right part becomes the right son of the root. After that, this process is repeated recursively on both parts.Now Alex wants to grow a forest of trees: one tree for each cyclic shift of the permutation. He is interested in what cyclic shift gives the tree of minimum depth. Unfortunately, growing a forest is a hard and long process, but Alex wants the answer right now. Will you help him?We remind that cyclic shift of permutation a1,a2,\xe2\x80\xa6,ak,\xe2\x80\xa6,an for k elements to the left is the permutation ak+1,ak+2,\xe2\x80\xa6,an,a1,a2,\xe2\x80\xa6,ak." 2700
1220E Tourism "dfs and similar,dp,dsu,graphs,greedy,trees" "Alex decided to go on a touristic trip over the country.For simplicity let\'s assume that the country has n cities and m bidirectional roads connecting them. Alex lives in city s and initially located in it. To compare different cities Alex assigned each city a score wi which is as high as interesting city seems to Alex.Alex believes that his trip will be interesting only if he will not use any road twice in a row. That is if Alex came to city v from city u, he may choose as the next city in the trip any city connected with v by the road, except for the city u.Your task is to help Alex plan his city in a way that maximizes total score over all cities he visited. Note that for each city its score is counted at most once, even if Alex been there several times during his trip." 2200
1220D "Alex and Julian" "bitmasks,math,number theory" "Boy Dima gave Julian a birthday presentÂ \xe2\x80\x94 set B consisting of positive integers. However, he didn\'t know, that Julian hates sets, but enjoys bipartite graphs more than anything else!Julian was almost upset, but her friend Alex said, that he can build an undirected graph using this set in such a way: let all integer numbers be vertices, then connect any two i and j with an edge if |i\xe2\x88\x92j| belongs to B.Unfortunately, Julian doesn\'t like the graph, that was built using B. Alex decided to rectify the situation, so he wants to erase some numbers from B, so that graph built using the new set is bipartite. The difficulty of this task is that the graph, Alex has to work with, has an infinite number of vertices and edges! It is impossible to solve this task alone, so Alex asks you for help. Write a program that erases a subset of minimum size from B so that graph constructed on the new set is bipartite.Recall, that graph is bipartite if all its vertices can be divided into two disjoint sets such that every edge connects a vertex from different sets." 1900
1220C "Substring Game in the Lesson" games,greedy,strings "Mike and Ann are sitting in the classroom. The lesson is boring, so they decided to play an interesting game. Fortunately, all they need to play this game is a string s and a number k (0\xe2\x89\xa4k<|s|).At the beginning of the game, players are given a substring of s with left border l and right border r, both equal to k (i.e. initially l=r=k). Then players start to make moves one by one, according to the following rules: A player chooses l\xe2\x80\xb2 and r\xe2\x80\xb2 so that l\xe2\x80\xb2\xe2\x89\xa4l, r\xe2\x80\xb2\xe2\x89\xa5r and s[l\xe2\x80\xb2,r\xe2\x80\xb2] is lexicographically less than s[l,r]. Then the player changes l and r in this way: l:=l\xe2\x80\xb2, r:=r\xe2\x80\xb2. Ann moves first. The player, that can\'t make a move loses.Recall that a substring s[l,r] (l\xe2\x89\xa4r) of a string s is a continuous segment of letters from s that starts at position l and ends at position r. For example, ""ehn"" is a substring (s[3,5]) of ""aaaehnsvz"" and ""ahz"" is not.Mike and Ann were playing so enthusiastically that they did not notice the teacher approached them. Surprisingly, the teacher didn\'t scold them, instead of that he said, that he can figure out the winner of the game before it starts, even if he knows only s and k.Unfortunately, Mike and Ann are not so keen in the game theory, so they ask you to write a program, that takes s and determines the winner for all possible k." 1300
1220B "Multiplication Table" "math,number theory" "Sasha grew up and went to first grade. To celebrate this event her mother bought her a multiplication table M with n rows and n columns such that Mij=ai\xe2\x8b\x85aj where a1,\xe2\x80\xa6,an is some sequence of positive integers.Of course, the girl decided to take it to school with her. But while she was having lunch, hooligan Grisha erased numbers on the main diagonal and threw away the array a1,\xe2\x80\xa6,an. Help Sasha restore the array!" 1300
1220A Cards implementation,sortings,strings "When Serezha was three years old, he was given a set of cards with letters for his birthday. They were arranged into words in the way which formed the boy\'s mother favorite number in binary notation. Serezha started playing with them immediately and shuffled them because he wasn\'t yet able to read. His father decided to rearrange them. Help him restore the original number, on condition that it was the maximum possible one." 800
1219G Harvester implementation "It is Bubble Cup finals season and farmer Johnny Bubbles must harvest his bubbles. The bubbles are in a rectangular bubblefield formed of N x M square parcels divided into N rows and M columns. The parcel in ith row and jth column yields Ai,j bubbles.Johnny Bubbles has available a very special self-driving bubble harvester that, once manually positioned at the beginning of a row or column, automatically harvests all the bubbles in that row or column. Once the harvester reaches the end of the row or column it stops and must be repositioned. The harvester can pass through any parcel any number of times, but it can collect bubbles from the parcel only once.Johnny is very busy farmer, so he is available to manually position the harvester at most four times per day. Johnny is also impatient, so he wants to harvest as many bubbles as possible on the first day.Please help Johnny to calculate what is the maximum number of bubbles he can collect on the first day." 2000
1219C "Periodic integer number" implementation,strings "Alice became interested in periods of integer numbers. We say positive X integer number is periodic with length L if there exists positive integer number P with L digits such that X can be written as PPPP\xe2\x80\xa6P. For example:X=123123123 is periodic number with length L=3 and L=9X=42424242 is periodic number with length L=2,L=4 and L=8X=12345 is periodic number with length L=5For given positive period length L and positive integer number A, Alice wants to find smallest integer number X strictly greater than A that is periodic with length L." 1700
1218I "The Light Square" "2-sat,dfs and similar,greedy" "For her birthday Alice received an interesting gift from her friends \xe2\x80\x93 The Light Square. The Light Square game is played on an N\xc3\x97N lightbulbs square board with a magical lightbulb bar of size N\xc3\x971 that has magical properties. At the start of the game some lights on the square board and magical bar are turned on. The goal of the game is to transform the starting light square board pattern into some other pattern using the magical bar without rotating the square board. The magical bar works as follows: It can be placed on any row or column The orientation of the magical lightbulb must be left to right or top to bottom for it to keep its magical properties The entire bar needs to be fully placed on a board The lights of the magical bar never change If the light on the magical bar is the same as the light of the square it is placed on it will switch the light on the square board off, otherwise it will switch the light on The magical bar can be used an infinite number of times Alice has a hard time transforming her square board into the pattern Bob gave her. Can you help her transform the board or let her know it is impossible? If there are multiple solutions print any." 2100
1218H "Function Composition" "dfs and similar" "We are definitely not going to bother you with another generic story when Alice finds about an array or when Alice and Bob play some stupid game. This time you\'ll get a simple, plain text.First, let us define several things. We define function F on the array A such that F(i,1)=A[i] and F(i,m)=A[F(i,m\xe2\x88\x921)] for m>1. In other words, value F(i,m) represents composition A[...A[i]] applied m times.You are given an array of length N with non-negative integers. You are expected to give an answer on Q queries. Each query consists of two numbers \xe2\x80\x93 m and y. For each query determine how many x exist such that F(x,m)=y." 2900
1218G "Alpha planetary system" "constructive algorithms,graphs,shortest paths" "Three planets X, Y and Z within the Alpha planetary system are inhabited with an advanced civilization. The spaceports of these planets are connected by interplanetary space shuttles. The flight scheduler should decide between 1, 2 and 3 return flights for every existing space shuttle connection. Since the residents of Alpha are strong opponents of the symmetry, there is a strict rule that any two of the spaceports connected by a shuttle must have a different number of flights. For every pair of connected spaceports, your goal is to propose a number 1, 2 or 3 for each shuttle flight, so that for every two connected spaceports the overall number of flights differs. You may assume that:1) Every planet has at least one spaceport 2) There exist only shuttle flights between spaceports of different planets 3) For every two spaceports there is a series of shuttle flights enabling traveling between them4) Spaceports are not connected by more than one shuttle" 3000
1218F "Workout plan" "data structures,greedy" "Alan decided to get in shape for the summer, so he created a precise workout plan to follow. His plan is to go to a different gym every day during the next N days and lift X[i] grams on day i. In order to improve his workout performance at the gym, he can buy exactly one pre-workout drink at the gym he is currently in and it will improve his performance by A grams permanently and immediately. In different gyms these pre-workout drinks can cost different amounts C[i] because of the taste and the gym\'s location but its permanent workout gains are the same. Before the first day of starting his workout plan, Alan knows he can lift a maximum of K grams. Help Alan spend a minimum total amount of money in order to reach his workout plan. If there is no way for him to complete his workout plan successfully output \xe2\x88\x921." 1500
1218E "Product Tuples" "divide and conquer,fft" "While roaming the mystic areas of Stonefalls, in order to drop legendary loot, an adventurer was given a quest as follows. He was given an array A=a1,a2,...,aN of length N, and a number K.Define array B as B(q,A)= { q\xe2\x88\x92a1,q\xe2\x88\x92a2,...,q\xe2\x88\x92aN }. Define function F as F(B,K) being sum of products of all K-tuples of elements in array B. For example, if the array B is [2,3,4,5], and with K=3, sum of products of all 3-tuples is F(B,3)=2\xe2\x88\x973\xe2\x88\x974+2\xe2\x88\x973\xe2\x88\x975+3\xe2\x88\x974\xe2\x88\x975+2\xe2\x88\x974\xe2\x88\x975He was then given a number Q, number of queries of two types:   Type 1: Given q, i, and d calculate F(B(q,A),K) where we make change to initial array as A[i]=d.  Type 2: Given q, L, R, and d calculate F(B(q,A),K) where we make change to initial array as A[i]=A[i]+d for all i in range [L,R] inclusive. All changes are temporarily made to initial array, and don\'t propagate to following queries. Help the adventurer calculate the answer to a quest, and finally get that loot!" 2500
1218D "Xor Spanning Tree" "divide and conquer,fft,graphs" "In the galaxy far far away is the ancient interplanetary republic of Bubbleland, consisting of N planets. Between them, there are M bidirectional wormholes, each connecting a pair of planets. Bubbleland is a very centralized republic, having a capital planet Whiteplanet, from which any another planet can be reached using these wormholes. It is also guaranteed that no wormhole connects planet to itself and that no two different wormholes connect same pair of planets. We call a path that begins at one planet, visits other planets and each of them at most once and returns to starting point a tour. Interplanetary Safety Regulations guarantee that each planet belongs to at most one tour and that there are at most 42 tours.After many eons of usage, wormholes need to be repaired and each wormhole has the cost Wi which needs to be payed for reparation. Unfortunately, the Senate of Bubbleland is short on budget. Therefore, they have decided only to fix as many wormholes as they need in order to have all planets reachable from capital and to pay as little money as they have to for this repair. However the way in which the Senate calculates the cost is different. Cost of the set of reparations is binary xor of costs of each individual reparation, that is if reparations to be made have costs A1,A2,...,Ak, the cost of entire set is A1\xe2\x8a\x95A2\xe2\x8a\x95...\xe2\x8a\x95Ak.Now the Senate would like to know how much money do they have to pay and also the number of different ways to achieve that cost modulo 1000000007." 2400
1218C "Jumping Transformers" dp "You, the mighty Blackout, are standing in the upper-left (0,0) corner of NxM matrix. You must move either right or down each second. There are K transformers jumping around the matrix in the following way. Each transformer starts jumping from position (x,y), at time t, and jumps to the next position each second. The x-axes grows downwards, and y-axes grows to the right. The order of jumping positions is defined as (x,y),(x+d,y\xe2\x88\x92d),(x+d,y),(x,y+d), and is periodic. Before time t transformer is not in the matrix.You want to arrive to the bottom-right corner (N\xe2\x88\x921,M\xe2\x88\x921), while slaying transformers and losing the least possible amount of energy. When you meet the transformer (or more of them) in the matrix field, you must kill them all, and you lose the sum of the energy amounts required to kill each transformer.After the transformer is killed, he of course stops jumping, falls into the abyss and leaves the matrix world. Output minimum possible amount of energy wasted." 2600
1218B "Guarding warehouses" "data structures,geometry" "Bob Bubblestrong just got a new job as security guard. Bob is now responsible for safety of a collection of warehouses, each containing the most valuable Bubble Cup assets - the high-quality bubbles. His task is to detect thieves inside the warehouses and call the police.Looking from the sky, each warehouse has a shape of a convex polygon. Walls of no two warehouses intersect, and of course, none of the warehouses is built inside of another warehouse.Little did the Bubble Cup bosses know how lazy Bob is and that he enjoys watching soap operas (he heard they are full of bubbles) from the coziness of his office. Instead of going from one warehouse to another to check if warehouses are secured, the plan Bob has is to monitor all the warehouses from the comfort of his office using the special X-ray goggles. The goggles have an infinite range, so a thief in any of the warehouses could easily be spotted.However, the goggles promptly broke and the X-rays are now strong only enough to let Bob see through a single wall. Now, Bob would really appreciate if you could help him find out what is the total area inside of the warehouses monitored by the broken goggles, so that he could know how much area of the warehouses he needs to monitor in person." 3000
1218A BubbleReactor dp,graphs "You are in charge of the BubbleReactor. It consists of N BubbleCores connected with N lines of electrical wiring. Each electrical wiring connects two distinct BubbleCores. There are no BubbleCores connected with more than one line of electrical wiring.Your task is to start the BubbleReactor by starting each BubbleCore. In order for a BubbleCore to be started it needs to be receiving power from a directly connected BubbleCore which is already started. However, you can kick-start one BubbleCore manually without needing power. It is guaranteed that all BubbleCores can be started.Before the BubbleCore boot up procedure its potential is calculated as the number of BubbleCores it can power on (the number of inactive BubbleCores which are connected to it directly or with any number of inactive BubbleCores in between, itself included)Start the BubbleReactor so that the sum of all BubbleCores\' potentials is maximum." 2800
1217F "Forced Online Queries Problem" "data structures,divide and conquer,dsu,graphs,trees" "You are given an undirected graph with n vertices numbered from 1 to n. Initially there are no edges.You are asked to perform some queries on the graph. Let last be the answer to the latest query of the second type, it is set to 0 before the first such query. Then the queries are the following:  1Â xÂ y (1\xe2\x89\xa4x,y\xe2\x89\xa4n, x\xe2\x89\xa0y) \xe2\x80\x94 add an undirected edge between the vertices (x+last\xe2\x88\x921)Â modÂ n+1 and (y+last\xe2\x88\x921)Â modÂ n+1 if it doesn\'t exist yet, otherwise remove it;  2Â xÂ y (1\xe2\x89\xa4x,y\xe2\x89\xa4n, x\xe2\x89\xa0y) \xe2\x80\x94 check if there exists a path between the vertices (x+last\xe2\x88\x921)Â modÂ n+1 and (y+last\xe2\x88\x921)Â modÂ n+1, which goes only through currently existing edges, and set last to 1 if so and 0 otherwise. Good luck!" 2600
1217E "Sum Queries?" "data structures,greedy,implementation,math" "Let\'s define a balanced multiset the following way. Write down the sum of all elements of the multiset in its decimal representation. For each position of that number check if the multiset includes at least one element such that the digit of the element and the digit of the sum at that position are the same. If that holds for every position, then the multiset is balanced. Otherwise it\'s unbalanced.For example, multiset {20,300,10001}{20,300,10001} is balanced and multiset {20,310,10001}{20,310,10001} is unbalanced:   The red digits mark the elements and the positions for which these elements have the same digit as the sum. The sum of the first multiset is 1032110321, every position has the digit required. The sum of the second multiset is 1033110331 and the second-to-last digit doesn\'t appear in any number, thus making the multiset unbalanced.You are given an array a1,a2,\xe2\x80\xa6,ana1,a2,\xe2\x80\xa6,an, consisting of nn integers.You are asked to perform some queries on it. The queries can be of two types:  1Â iÂ x1Â iÂ x \xe2\x80\x94 replace aiai with the value xx;  2Â lÂ r2Â lÂ r \xe2\x80\x94 find the unbalanced subset of the multiset of the numbers al,al+1,\xe2\x80\xa6,aral,al+1,\xe2\x80\xa6,ar with the minimum sum, or report that no unbalanced subset exists. Note that the empty multiset is balanced.For each query of the second type print the lowest sum of the unbalanced subset. Print -1 if no unbalanced subset exists." 2300
1217D "Coloring Edges" "constructive algorithms,dfs and similar,graphs" "You are given a directed graph with n vertices and m directed edges without self-loops or multiple edges.Let\'s denote the k-coloring of a digraph as following: you color each edge in one of k colors. The k-coloring is good if and only if there no cycle formed by edges of same color.Find a good k-coloring of given digraph with minimum possible k." 2100
1217C "The Number Of Good Substrings" "binary search,bitmasks,brute force" "You are given a binary string s (recall that a string is binary if each character is either 0 or 1).Let f(t) be the decimal representation of integer t written in binary form (possibly with leading zeroes). For example f(011)=3,f(00101)=5,f(00001)=1,f(10)=2,f(000)=0 and f(000100)=4.The substring sl,sl+1,\xe2\x80\xa6,sr is good if r\xe2\x88\x92l+1=f(sl\xe2\x80\xa6sr).For example string s=1011 has 5 good substrings: s1\xe2\x80\xa6s1=1, s3\xe2\x80\xa6s3=1, s4\xe2\x80\xa6s4=1, s1\xe2\x80\xa6s2=10 and s2\xe2\x80\xa6s4=011. Your task is to calculate the number of good substrings of string s.You have to answer t independent queries." 1700
1217B "Zmei Gorynich" greedy,math "You are fighting with Zmei Gorynich \xe2\x80\x94 a ferocious monster from Slavic myths, a huge dragon-like reptile with multiple heads!   Initially Zmei Gorynich has xx heads. You can deal nn types of blows. If you deal a blow of the ii-th type, you decrease the number of Gorynich\'s heads by min(di,curX)min(di,curX), there curXcurX is the current number of heads. But if after this blow Zmei Gorynich has at least one head, he grows hihi new heads. If curX=0curX=0 then Gorynich is defeated. You can deal each blow any number of times, in any order.For example, if curX=10curX=10, d=7d=7, h=10h=10 then the number of heads changes to 1313 (you cut 77 heads off, but then Zmei grows 1010 new ones), but if curX=10curX=10, d=11d=11, h=100h=100 then number of heads changes to 00 and Zmei Gorynich is considered defeated.Calculate the minimum number of blows to defeat Zmei Gorynich!You have to answer tt independent queries." 1600
1217A "Creating a Character" "binary search,math" "You play your favourite game yet another time. You chose the character you didn\'t play before. It has str points of strength and int points of intelligence. Also, at start, the character has exp free experience points you can invest either in strength or in intelligence (by investing one point you can either raise strength by 1 or raise intelligence by 1).Since you\'d like to make some fun you want to create a jock character, so it has more strength than intelligence points (resulting strength is strictly greater than the resulting intelligence).Calculate the number of different character builds you can create (for the purpose of replayability) if you must invest all free points. Two character builds are different if their strength and/or intellect are different." 1300
1216F Wi-Fi "data structures,dp,greedy" "You work as a system administrator in a dormitory, which has n rooms one after another along a straight hallway. Rooms are numbered from 1 to n.You have to connect all n rooms to the Internet.You can connect each room to the Internet directly, the cost of such connection for the i-th room is i coins. Some rooms also have a spot for a router. The cost of placing a router in the i-th room is also i coins. You cannot place a router in a room which does not have a spot for it. When you place a router in the room i, you connect all rooms with the numbers from max(1,Â i\xe2\x88\x92k) to min(n,Â i+k) inclusive to the Internet, where k is the range of router. The value of k is the same for all routers. Calculate the minimum total cost of connecting all n rooms to the Internet. You can assume that the number of rooms which have a spot for a router is not greater than the number of routers you have." 2100
1216E2 "Numerical Sequence (hard version)" "binary search,math" "The only difference between the easy and the hard versions is the maximum value of k.You are given an infinite sequence of form ""112123123412345\xe2\x80\xa6"" which consist of blocks of all consecutive positive integers written one after another. The first block consists of all numbers from 1 to 1, the second one \xe2\x80\x94 from 1 to 2, the third one \xe2\x80\x94 from 1 to 3, \xe2\x80\xa6, the i-th block consists of all numbers from 1 to i. So the first 56 elements of the sequence are ""11212312341234512345612345671234567812345678912345678910"". Elements of the sequence are numbered from one. For example, the 1-st element of the sequence is 1, the 3-rd element of the sequence is 2, the 20-th element of the sequence is 5, the 38-th element is 2, the 56-th element of the sequence is 0.Your task is to answer q independent queries. In the i-th query you are given one integer ki. Calculate the digit at the position ki of the sequence." 2200
1216E1 "Numerical Sequence (easy version)" "binary search,brute force,math" "The only difference between the easy and the hard versions is the maximum value of k.You are given an infinite sequence of form ""112123123412345\xe2\x80\xa6"" which consist of blocks of all consecutive positive integers written one after another. The first block consists of all numbers from 1 to 1, the second one \xe2\x80\x94 from 1 to 2, the third one \xe2\x80\x94 from 1 to 3, \xe2\x80\xa6, the i-th block consists of all numbers from 1 to i. So the first 56 elements of the sequence are ""11212312341234512345612345671234567812345678912345678910"". Elements of the sequence are numbered from one. For example, the 1-st element of the sequence is 1, the 3-rd element of the sequence is 2, the 20-th element of the sequence is 5, the 38-th element is 2, the 56-th element of the sequence is 0.Your task is to answer q independent queries. In the i-th query you are given one integer ki. Calculate the digit at the position ki of the sequence." 1900
1216D Swords math "There were n types of swords in the theater basement which had been used during the plays. Moreover there were exactly x swords of each type. y people have broken into the theater basement and each of them has taken exactly z swords of some single type. Note that different people might have taken different types of swords. Note that the values x,y and z are unknown for you.The next morning the director of the theater discovers the loss. He counts all swords \xe2\x80\x94 exactly ai swords of the i-th type are left untouched.The director has no clue about the initial number of swords of each type in the basement, the number of people who have broken into the basement and how many swords each of them have taken.For example, if n=3, a=[3,12,6] then one of the possible situations is x=12, y=5 and z=3. Then the first three people took swords of the first type and the other two people took swords of the third type. Note that you don\'t know values x,y and z beforehand but know values of n and a.Thus he seeks for your help. Determine the minimum number of people y, which could have broken into the theater basement, and the number of swords z each of them has taken." 1300
1216C "White Sheet" geometry,math "There is a white sheet of paper lying on a rectangle table. The sheet is a rectangle with its sides parallel to the sides of the table. If you will take a look from above and assume that the bottom left corner of the table has coordinates (0,0), and coordinate axes are left and bottom sides of the table, then the bottom left corner of the white sheet has coordinates (x1,y1), and the top right \xe2\x80\x94 (x2,y2).After that two black sheets of paper are placed on the table. Sides of both black sheets are also parallel to the sides of the table. Coordinates of the bottom left corner of the first black sheet are (x3,y3), and the top right \xe2\x80\x94 (x4,y4). Coordinates of the bottom left corner of the second black sheet are (x5,y5), and the top right \xe2\x80\x94 (x6,y6).   Example of three rectangles. Determine if some part of the white sheet can be seen from the above after the two black sheets are placed. The part of the white sheet can be seen if there is at least one point lying not strictly inside the white sheet and strictly outside of both black sheets." 1700
1216B Shooting greedy,implementation,sortings "Recently Vasya decided to improve his pistol shooting skills. Today his coach offered him the following exercise. He placed n cans in a row on a table. Cans are numbered from left to right from 1 to n. Vasya has to knock down each can exactly once to finish the exercise. He is allowed to choose the order in which he will knock the cans down.Vasya knows that the durability of the i-th can is ai. It means that if Vasya has already knocked x cans down and is now about to start shooting the i-th one, he will need (ai\xe2\x8b\x85x+1) shots to knock it down. You can assume that if Vasya starts shooting the i-th can, he will be shooting it until he knocks it down.Your task is to choose such an order of shooting so that the number of shots required to knock each of the n given cans down exactly once is minimum possible." 900
1216A Prefixes strings "Nikolay got a string s of even length n, which consists only of lowercase Latin letters \'a\' and \'b\'. Its positions are numbered from 1 to n.He wants to modify his string so that every its prefix of even length has an equal amount of letters \'a\' and \'b\'. To achieve that, Nikolay can perform the following operation arbitrary number of times (possibly, zero): choose some position in his string and replace the letter on this position with the other letter (i.e. replace \'a\' with \'b\' or replace \'b\' with \'a\'). Nikolay can use no letters except \'a\' and \'b\'.The prefix of string s of length l (1\xe2\x89\xa4l\xe2\x89\xa4n) is a string s[1..l].For example, for the string s=""abba"" there are two prefixes of the even length. The first is s[1\xe2\x80\xa62]=""ab"" and the second s[1\xe2\x80\xa64]=""abba"". Both of them have the same number of \'a\' and \'b\'.Your task is to calculate the minimum number of operations Nikolay has to perform with the string s to modify it so that every its prefix of even length has an equal amount of letters \'a\' and \'b\'." 800
1215F "Radio Stations" 2-sat "In addition to complaints about lighting, a lot of complaints about insufficient radio signal covering has been received by Bertown city hall recently. n complaints were sent to the mayor, all of which are suspiciosly similar to each other: in the i-th complaint, one of the radio fans has mentioned that the signals of two radio stations xi and yi are not covering some parts of the city, and demanded that the signal of at least one of these stations can be received in the whole city.Of cousre, the mayor of Bertown is currently working to satisfy these complaints. A new radio tower has been installed in Bertown, it can transmit a signal with any integer power from 1 to M (let\'s denote the signal power as f). The mayor has decided that he will choose a set of radio stations and establish a contract with every chosen station. To establish a contract with the i-th station, the following conditions should be met:  the signal power f should be not less than li, otherwise the signal of the i-th station won\'t cover the whole city;  the signal power f should be not greater than ri, otherwise the signal will be received by the residents of other towns which haven\'t established a contract with the i-th station. All this information was already enough for the mayor to realise that choosing the stations is hard. But after consulting with specialists, he learned that some stations the signals of some stations may interfere with each other: there are m pairs of stations (ui, vi) that use the same signal frequencies, and for each such pair it is impossible to establish contracts with both stations. If stations x and y use the same frequencies, and y and z use the same frequencies, it does not imply that x and z use the same frequencies.The mayor finds it really hard to analyze this situation, so he hired you to help him. You have to choose signal power f and a set of stations to establish contracts with such that:  all complaints are satisfied (formally, for every i\xe2\x88\x88[1,n] the city establishes a contract either with station xi, or with station yi);  no two chosen stations interfere with each other (formally, for every i\xe2\x88\x88[1,m] the city does not establish a contract either with station ui, or with station vi);  for each chosen station, the conditions on signal power are met (formally, for each chosen station i the condition li\xe2\x89\xa4f\xe2\x89\xa4ri is met)." 2700
1215E Marbles bitmasks,dp "Monocarp has arranged n colored marbles in a row. The color of the i-th marble is ai. Monocarp likes ordered things, so he wants to rearrange marbles in such a way that all marbles of the same color form a contiguos segment (and there is only one such segment for each color). In other words, Monocarp wants to rearrange marbles so that, for every color j, if the leftmost marble of color j is l-th in the row, and the rightmost marble of this color has position r in the row, then every marble from l to r has color j.To achieve his goal, Monocarp can do the following operation any number of times: choose two neighbouring marbles, and swap them.You have to calculate the minimum number of operations Monocarp has to perform to rearrange the marbles. Note that the order of segments of marbles having equal color does not matter, it is only required that, for every color, all the marbles of this color form exactly one contiguous segment." 2200
1215D "Ticket Game" games,greedy,math "Monocarp and Bicarp live in Berland, where every bus ticket consists of n digits (n is an even number). During the evening walk Monocarp and Bicarp found a ticket where some of the digits have been erased. The number of digits that have been erased is even.Monocarp and Bicarp have decided to play a game with this ticket. Monocarp hates happy tickets, while Bicarp collects them. A ticket is considered happy if the sum of the first n2 digits of this ticket is equal to the sum of the last n2 digits.Monocarp and Bicarp take turns (and Monocarp performs the first of them). During each turn, the current player must replace any erased digit with any digit from 0 to 9. The game ends when there are no erased digits in the ticket.If the ticket is happy after all erased digits are replaced with decimal digits, then Bicarp wins. Otherwise, Monocarp wins. You have to determine who will win if both players play optimally." 1700
1215C "Swap Letters" "constructive algorithms,greedy" "Monocarp has got two strings s and t having equal length. Both strings consist of lowercase Latin letters ""a"" and ""b"". Monocarp wants to make these two strings s and t equal to each other. He can do the following operation any number of times: choose an index pos1 in the string s, choose an index pos2 in the string t, and swap spos1 with tpos2.You have to determine the minimum number of operations Monocarp has to perform to make s and t equal, and print any optimal sequence of operations \xe2\x80\x94 or say that it is impossible to make these strings equal." 1500
1215B "The Number of Products" combinatorics,dp,implementation "You are given a sequence a1,a2,\xe2\x80\xa6,an consisting of n non-zero integers (i.e. ai\xe2\x89\xa00). You have to calculate two following values:  the number of pairs of indices (l,r) (l\xe2\x89\xa4r) such that al\xe2\x8b\x85al+1\xe2\x80\xa6ar\xe2\x88\x921\xe2\x8b\x85ar is negative;  the number of pairs of indices (l,r) (l\xe2\x89\xa4r) such that al\xe2\x8b\x85al+1\xe2\x80\xa6ar\xe2\x88\x921\xe2\x8b\x85ar is positive;" 1400
1215A "Yellow Cards" greedy,implementation,math "The final match of the Berland Football Cup has been held recently. The referee has shown n yellow cards throughout the match. At the beginning of the match there were a1 players in the first team and a2 players in the second team.The rules of sending players off the game are a bit different in Berland football. If a player from the first team receives k1 yellow cards throughout the match, he can no longer participate in the match \xe2\x80\x94 he\'s sent off. And if a player from the second team receives k2 yellow cards, he\'s sent off. After a player leaves the match, he can no longer receive any yellow cards. Each of n yellow cards was shown to exactly one player. Even if all players from one team (or even from both teams) leave the match, the game still continues.The referee has lost his records on who has received each yellow card. Help him to determine the minimum and the maximum number of players that could have been thrown out of the game." 1000
1214H "Tiles Placement" "constructive algorithms,dfs and similar,trees" "The new pedestrian zone in Moscow city center consists of nn squares connected with each other by n\xe2\x88\x921n\xe2\x88\x921 footpaths. We define a simple path as a sequence of squares such that no square appears in this sequence twice and any two adjacent squares in this sequence are directly connected with a footpath. The size of a simple path is the number of squares in it. The footpaths are designed in a such a way that there is exactly one simple path between any pair of different squares.During preparations for Moscow City Day the city council decided to renew ground tiles on all nn squares. There are kk tile types of different colors, numbered from 11 to kk. For each square exactly one tile type must be selected and then used to cover this square surface. To make walking through the city center more fascinating, it was decided to select tiles types for each square in such a way that any possible simple path of size exactly kk contains squares with all kk possible tile colors.You need to find out whether it is possible to place the tiles this way or not." 2800
1214G "Feeling Good" "bitmasks,data structures" "Recently biologists came to a fascinating conclusion about how to find a chameleon mood. Consider chameleon body to be a rectangular table n\xc3\x97m, each cell of which may be green or blue and may change between these two colors. We will denote as (x,y) (1\xe2\x89\xa4x\xe2\x89\xa4n, 1\xe2\x89\xa4y\xe2\x89\xa4m) the cell in row x and column y.Let us define a chameleon good mood certificate to be four cells which are corners of some subrectangle of the table, such that colors in opposite cells among these four are similar, and at the same time not all of the four cell colors are similar. Formally, it is a group of four cells (x1,y1), (x1,y2), (x2,y1), (x2,y2) for some 1\xe2\x89\xa4x1<x2\xe2\x89\xa4n, 1\xe2\x89\xa4y1<y2\xe2\x89\xa4m, that colors of (x1,y1) and (x2,y2) coincide and colors of (x1,y2) and (x2,y1) coincide, but not all of the four cells share the same color. It was found that whenever such four cells are present, chameleon is in good mood, and vice versa: if there are no such four cells, chameleon is in bad mood.You are asked to help scientists write a program determining the mood of chameleon. Let us consider that initially all cells of chameleon are green. After that chameleon coloring may change several times. On one change, colors of contiguous segment of some table row are replaced with the opposite. Formally, each color change is defined by three integers a, l, r (1\xe2\x89\xa4a\xe2\x89\xa4n, 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4m). On such change colors of all cells (a,b) such that l\xe2\x89\xa4b\xe2\x89\xa4r are replaced with the opposite.Write a program that reports mood of the chameleon after each change. Additionally, if the chameleon mood is good, program should find out any four numbers x1, y1, x2, y2 such that four cells (x1,y1), (x1,y2), (x2,y1), (x2,y2) are the good mood certificate." 3200
1214F Employment greedy,sortings "Two large companies ""Cecsi"" and ""Poca Pola"" are fighting against each other for a long time. In order to overcome their competitor, ""Poca Pola"" started a super secret project, for which it has total n vacancies in all of their offices. After many tests and interviews n candidates were selected and the only thing left was their employment.Because all candidates have the same skills, it doesn\'t matter where each of them will work. That is why the company decided to distribute candidates between workplaces so that the total distance between home and workplace over all candidates is minimal.It is well known that Earth is round, so it can be described as a circle, and all m cities on Earth can be described as points on this circle. All cities are enumerated from 1 to m so that for each i (1\xe2\x89\xa4i\xe2\x89\xa4m\xe2\x88\x921) cities with indexes i and i+1 are neighbors and cities with indexes 1 and m are neighbors as well. People can move only along the circle. The distance between any two cities equals to minimal number of transitions between neighboring cities you have to perform to get from one city to another. In particular, the distance between the city and itself equals 0.The ""Poca Pola"" vacancies are located at offices in cities a1,a2,\xe2\x80\xa6,an. The candidates live in cities b1,b2,\xe2\x80\xa6,bn. It is possible that some vacancies are located in the same cities and some candidates live in the same cities. The ""Poca Pola"" managers are too busy with super secret project, so you were asked to help ""Poca Pola"" to distribute candidates between workplaces, so that the sum of the distance between home and workplace over all candidates is minimum possible." 2700
1214E "Petya and Construction Set" "constructive algorithms,graphs,math,sortings,trees" "It\'s Petya\'s birthday party and his friends have presented him a brand new ""Electrician-n"" construction set, which they are sure he will enjoy as he always does with weird puzzles they give him.Construction set ""Electrician-n"" consists of 2n\xe2\x88\x921 wires and 2n light bulbs. Each bulb has its own unique index that is an integer from 1 to 2n, while all wires look the same and are indistinguishable. In order to complete this construction set one has to use each of the wires to connect two distinct bulbs. We define a chain in a completed construction set as a sequence of distinct bulbs of length at least two, such that every two consecutive bulbs in this sequence are directly connected by a wire. Completed construction set configuration is said to be correct if a resulting network of bulbs and wires has a tree structure, i.e. any two distinct bulbs are the endpoints of some chain.Petya was assembling different configurations for several days, and he noticed that sometimes some of the bulbs turn on. After a series of experiments he came up with a conclusion that bulbs indexed 2i and 2i\xe2\x88\x921 turn on if the chain connecting them consists of exactly di wires. Moreover, the following important condition holds: the value of di is never greater than n.Petya did his best but was not able to find a configuration that makes all bulbs to turn on, so he seeks your assistance. Please, find out a configuration that makes all bulbs shine. It is guaranteed that such configuration always exists." 2000
1214D "Treasure Island" "dfs and similar,dp,flows,hashing" "All of us love treasures, right? That\'s why young Vasya is heading for a Treasure Island.Treasure Island may be represented as a rectangular table n\xc3\x97m which is surrounded by the ocean. Let us number rows of the field with consecutive integers from 1 to n from top to bottom and columns with consecutive integers from 1 to m from left to right. Denote the cell in r-th row and c-th column as (r,c). Some of the island cells contain impassable forests, and some cells are free and passable. Treasure is hidden in cell (n,m).Vasya got off the ship in cell (1,1). Now he wants to reach the treasure. He is hurrying up, so he can move only from cell to the cell in next row (downwards) or next column (rightwards), i.e. from cell (x,y) he can move only to cells (x+1,y) and (x,y+1). Of course Vasya can\'t move through cells with impassable forests.Evil Witch is aware of Vasya\'s journey and she is going to prevent him from reaching the treasure. Before Vasya\'s first move she is able to grow using her evil magic impassable forests in previously free cells. Witch is able to grow a forest in any number of any free cells except cells (1,1) where Vasya got off his ship and (n,m) where the treasure is hidden.Help Evil Witch by finding out the minimum number of cells she has to turn into impassable forests so that Vasya is no longer able to reach the treasure." 1900
1214C "Bad Sequence" "data structures,greedy" "Petya\'s friends made him a birthday present \xe2\x80\x94 a bracket sequence. Petya was quite disappointed with his gift, because he dreamed of correct bracket sequence, yet he told his friends nothing about his dreams and decided to fix present himself. To make everything right, Petya is going to move at most one bracket from its original place in the sequence to any other position. Reversing the bracket (e.g. turning ""("" into "")"" or vice versa) isn\'t allowed. We remind that bracket sequence s is called correct if:   s is empty;  s is equal to ""(t)"", where t is correct bracket sequence;  s is equal to t1t2, i.e. concatenation of t1 and t2, where t1 and t2 are correct bracket sequences. For example, ""(()())"", ""()"" are correct, while "")("" and ""())"" are not. Help Petya to fix his birthday present and understand whether he can move one bracket so that the sequence becomes correct." 1200
1214B Badges "brute force,math" "There are b boys and g girls participating in Olympiad of Metropolises. There will be a board games tournament in the evening and n participants have accepted the invitation. The organizers do not know how many boys and girls are among them.Organizers are preparing red badges for girls and blue ones for boys.Vasya prepared n+1 decks of badges. The i-th (where i is from 0 to n, inclusive) deck contains i blue badges and n\xe2\x88\x92i red ones. The total number of badges in any deck is exactly n.Determine the minimum number of decks among these n+1 that Vasya should take, so that there will be a suitable deck no matter how many girls and boys there will be among the participants of the tournament." 1100
1214A "Optimal Currency Exchange" "brute force,math" "Andrew was very excited to participate in Olympiad of Metropolises. Days flew by quickly, and Andrew is already at the airport, ready to go home. He has n rubles left, and would like to exchange them to euro and dollar bills. Andrew can mix dollar bills and euro bills in whatever way he wants. The price of one dollar is d rubles, and one euro costs e rubles.Recall that there exist the following dollar bills: 1, 2, 5, 10, 20, 50, 100, and the following euro billsÂ \xe2\x80\x94 5, 10, 20, 50, 100, 200 (note that, in this problem we do not consider the 500 euro bill, it is hard to find such bills in the currency exchange points). Andrew can buy any combination of bills, and his goal is to minimize the total number of rubles he will have after the exchange.Help himÂ \xe2\x80\x94 write a program that given integers n, e and d, finds the minimum number of rubles Andrew can get after buying dollar and euro bills." 1400
1213G "Path Queries" "divide and conquer,dsu,graphs,sortings,trees" "You are given a weighted tree consisting of nn vertices. Recall that a tree is a connected graph without cycles. Vertices uiui and vivi are connected by an edge with weight wiwi.You are given mm queries. The ii-th query is given as an integer qiqi. In this query you need to calculate the number of pairs of vertices (u,v)(u,v) (u<vu<v) such that the maximum weight of an edge on a simple path between uu and vv doesn\'t exceed qiqi." 1800
1213F "Unstable String Sort" "data structures,dfs and similar,dsu,graphs,greedy,implementation,strings" "Authors have come up with the string s consisting of n lowercase Latin letters.You are given two permutations of its indices (not necessary equal) p and q (both of length n). Recall that the permutation is the array of length n which contains each integer from 1 to n exactly once.For all i from 1 to n\xe2\x88\x921 the following properties hold: s[pi]\xe2\x89\xa4s[pi+1] and s[qi]\xe2\x89\xa4s[qi+1]. It means that if you will write down all characters of s in order of permutation indices, the resulting string will be sorted in the non-decreasing order.Your task is to restore any such string s of length n consisting of at least k distinct lowercase Latin letters which suits the given permutations.If there are multiple answers, you can print any of them." 2100
1213E "Two Small Strings" "brute force,constructive algorithms" "You are given two strings s and t both of length 2 and both consisting only of characters \'a\', \'b\' and \'c\'.Possible examples of strings s and t: ""ab"", ""ca"", ""bb"".You have to find a string res consisting of 3n characters, n characters should be \'a\', n characters should be \'b\' and n characters should be \'c\' and s and t should not occur in res as substrings.A substring of a string is a contiguous subsequence of that string. So, the strings ""ab"", ""ac"" and ""cc"" are substrings of the string ""abacc"", but the strings ""bc"", ""aa"" and ""cb"" are not substrings of the string ""abacc"".If there are multiple answers, you can print any of them." 1900
1213D2 "Equalizing by Division (hard version)" "brute force,math,sortings" "The only difference between easy and hard versions is the number of elements in the array.You are given an array a consisting of n integers. In one move you can choose any ai and divide it by 2 rounding down (in other words, in one move you can set ai:=\xe2\x8c\x8aai2\xe2\x8c\x8b).You can perform such an operation any (possibly, zero) number of times with any ai.Your task is to calculate the minimum possible number of operations required to obtain at least k equal numbers in the array.Don\'t forget that it is possible to have ai=0 after some operations, thus the answer always exists." 1600
1213D1 "Equalizing by Division (easy version)" "brute force,implementation" "The only difference between easy and hard versions is the number of elements in the array.You are given an array a consisting of n integers. In one move you can choose any ai and divide it by 2 rounding down (in other words, in one move you can set ai:=\xe2\x8c\x8aai2\xe2\x8c\x8b).You can perform such an operation any (possibly, zero) number of times with any ai.Your task is to calculate the minimum possible number of operations required to obtain at least k equal numbers in the array.Don\'t forget that it is possible to have ai=0 after some operations, thus the answer always exists." 1500
1213C "Book Reading" math "Polycarp is reading a book consisting of n pages numbered from 1 to n. Every time he finishes the page with the number divisible by m, he writes down the last digit of this page number. For example, if n=15 and m=5, pages divisible by m are 5,10,15. Their last digits are 5,0,5 correspondingly, their sum is 10.Your task is to calculate the sum of all digits Polycarp has written down.You have to answer q independent queries." 1200
1213B "Bad Prices" "data structures,implementation" "Polycarp analyzes the prices of the new berPhone. At his disposal are the prices for n last days: a1,a2,\xe2\x80\xa6,an, where ai is the price of berPhone on the day i.Polycarp considers the price on the day i to be bad if later (that is, a day with a greater number) berPhone was sold at a lower price. For example, if n=6 and a=[3,9,4,6,7,5], then the number of days with a bad price is 3 \xe2\x80\x94 these are days 2 (a2=9), 4 (a4=6) and 5 (a5=7).Print the number of days with a bad price.You have to answer t independent data sets." 1100
1213A "Chips Moving" math "You are given n chips on a number line. The i-th chip is placed at the integer coordinate xi. Some chips can have equal coordinates.You can perform each of the two following types of moves any (possibly, zero) number of times on any chip:  Move the chip i by 2 to the left or 2 to the right for free (i.e. replace the current coordinate xi with xi\xe2\x88\x922 or with xi+2);  move the chip i by 1 to the left or 1 to the right and pay one coin for this move (i.e. replace the current coordinate xi with xi\xe2\x88\x921 or with xi+1). Note that it\'s allowed to move chips to any integer coordinate, including negative and zero.Your task is to find the minimum total number of coins required to move all n chips to the same coordinate (i.e. all xi should be equal after some sequence of moves)." 900
1211I "Unusual Graph" "*special problem,graphs" "Ivan on his birthday was presented with array of non-negative integers a1,a2,\xe2\x80\xa6,an. He immediately noted that all ai satisfy the condition 0\xe2\x89\xa4ai\xe2\x89\xa415.Ivan likes graph theory very much, so he decided to transform his sequence to the graph.There will be n vertices in his graph, and vertices u and v will present in the graph if and only if binary notations of integers au and av are differ in exactly one bit (in other words, au\xe2\x8a\x95av=2k for some integer k\xe2\x89\xa50. Where \xe2\x8a\x95 is Bitwise XOR).A terrible thing happened in a couple of days, Ivan forgot his sequence a, and all that he remembers is constructed graph!Can you help him, and find any sequence a1,a2,\xe2\x80\xa6,an, such that graph constructed by the same rules that Ivan used will be the same as his graph?" 3000
1211H "Road Repair in Treeland" "*special problem,binary search,dp,trees" "There are n cities and n\xe2\x88\x921 two-way roads in Treeland. Each road connects a pair of different cities. From any city you can drive to any other, moving only along the roads. Cities are numbered from 1 to n. Yes, of course, you recognized an undirected tree in this description.The government plans to repair all the roads. Each road will be repaired by some private company. In total, the country has 106 private companies that are numbered from 1 to 106. It is possible that some companies will not repair roads at all, and some will repair many roads.To simplify the control over the work of private companies, the following restriction was introduced: for each city, we calculate the number of different companies that repair roads that have this city at one end. This number for each city should not exceed 2. In other words, for each city, there should be no more than two different companies that repair roads related to this city.The National Anti-Corruption Committee of Treeland raises concerns that all (or almost all) of the work will go to one private company. For this reason, the committee requires that roads be distributed among companies in such a way as to minimize the value of r. For each company, we calculate the number of roads assigned to it, the maximum among all companies is called the number r.Help the government find such a way to distribute all roads among companies in the required way." 3100
1211G "King\'s Path" "*special problem,math,trees" "There are nn cities and n\xe2\x88\x921n\xe2\x88\x921 two-way roads in Treeland. Each road connects a pair of different cities. From any city you can drive to any other, moving only along the roads. Cities are numbered from 11 to nn. Yes, of course, you recognized an undirected tree in this description.There is exactly one flag in each city, in the ii-th city the flag color is cici. The colors of the flags in different cities may be the same.If the King travels along the route [u1,u2,u3,\xe2\x80\xa6,uk][u1,u2,u3,\xe2\x80\xa6,uk], then this means that he starts in the city u1u1, then moves to the city u2u2 (u2u2 is connected by road with u1u1), then from u2u2 to u3u3 (u3u3 is connected by road to u2u2), and so on until he arrives in the city of ukuk. It is possible that during this route the King will visit the same city more than once. In other words, the route [u1,u2,u3,\xe2\x80\xa6,uk][u1,u2,u3,\xe2\x80\xa6,uk] does not necessarily consist of different cities. In terms of graph theory \xe2\x80\x94 the King moves from u1u1 to ukuk along some path [u1,u2,u3,\xe2\x80\xa6,uk][u1,u2,u3,\xe2\x80\xa6,uk], which is not necessarily simple (for all jj from 11 to k\xe2\x88\x921k\xe2\x88\x921 of the city ujuj and uj+1uj+1 are connected by road).When the King moves from one city to another, city heads exchange flags as a sign of their friendship.  Example of moving the King along the route [1,4,2,6][1,4,2,6]. The color of the vertex matches the color of the flag at that vertex. For aesthetic reasons, the King wants the flag color in the city ii to be equal to didi for all ii from 11 to nn. Determine whether the King can choose some route and drive along it so that for each city the flag color in it turns out to be equal to the desired color didi. Note that the King can choose (and drive) exactly one route. If yes, find the shortest possible route for the King.If the initial colors of the flags already match the King\'s requirements (i.e. ci=dici=di for all ii), then consider that the King makes a route of length k=0k=0." 2500
1211F kotlinkotlinkotlinkotlin... "*special problem,graphs,implementation,strings" "Polycarp really likes writing the word ""kotlin"". He wrote this word several times in a row without spaces. For example, he could write the string like ""kotlinkotlinkotlinkotlin"".Polycarp sliced (cut) the written string into n pieces and mixed them. As a result, he has n strings s1,s2,\xe2\x80\xa6,sn and he can arrange them in the right order, concatenate (join) all of them and get a string like ""kotlinkotlin...kotlin"".Help Polycarp to find the right order of strings s1,s2,\xe2\x80\xa6,sn, so that if he writes the strings in this order, he will get the word ""kotlin"" or the sequence of this word.Pay attention that you must use all given strings and you must use each string only once." 2300
1211E "Double Permutation Inc." "*special problem,binary search,greedy" "Polycarp recently became an employee of the company ""Double Permutation Inc."" Now he is a fan of permutations and is looking for them everywhere!A permutation in this problem is a sequence of integers p1,p2,\xe2\x80\xa6,pk such that every integer from 1 to k occurs exactly once in it. For example, the following sequences are permutations of [3,1,4,2], [1] and [6,1,2,3,5,4]. The following sequences are not permutations: [0,1], [1,2,2], [1,2,4] and [2,3].In the lobby of the company\'s headquarter statistics on visits to the company\'s website for the last n days are published \xe2\x80\x94 the sequence a1,a2,\xe2\x80\xa6,an. Polycarp wants to color all the elements of this sequence in one of three colors (red, green or blue) so that:  all red numbers, being written out of a1,a2,\xe2\x80\xa6,an from left to right (that is, without changing their relative order), must form some permutation (let\'s call it P);  all green numbers, being written out of a1,a2,\xe2\x80\xa6,an from left to right (that is, without changing their relative order), must form the same permutation P;  among blue numbers there should not be elements that are equal to some element of the permutation P. Help Polycarp to color all n numbers so that the total number of red and green elements is maximum." 2000
1211D Teams "*special problem,binary search,greedy,math" "There are n table bowling players, the rating of the i-th player equals ri. Compose a maximum number of teams in a such way that:  each player belongs to at most one team;  each team contains exactly a+b players;  each team contains a group of a players with the same rating and a group of b players with another same rating, which must be k times larger than the rating of the players in the first group. For example, if n=12, r=[1,1,2,2,2,2,2,3,3,4,6,6], a=1, b=2, k=2, you can compose two teams with ratings [1,2,2] and one team with ratings [3,6,6]. So, the maximum number of teams is 3.Find the maximum number of teams by given n,r1\xe2\x80\xa6rn,a,b and k to compose in respect to the given requirements." 2000
1211C "Ice Cream" "*special problem,greedy,sortings" "Summer in Berland lasts n days, the price of one portion of ice cream on the i-th day is ci. Over the summer, Tanya wants to eat exactly k portions of ice cream. At the same time, on the i-th day, she decided that she would eat at least ai portions, but not more than bi (ai\xe2\x89\xa4bi) portions. In other words, let di be equal to the number of portions that she eats on the i-th day. Then d1+d2+\xe2\x8b\xaf+dn=k and ai\xe2\x89\xa4di\xe2\x89\xa4bi for each i.Given that portions of ice cream can only be eaten on the day of purchase, find the minimum amount of money that Tanya can spend on ice cream in the summer." 1700
1211B "Traveling Around the Golden Ring of Berland" "*special problem,implementation" "The Golden Ring is the special tourist route in Berland. This route consists of nÂ cities and the cyclic railway route. Cities are numbered from 1 to nÂ so that:  the next city for 1 is the city 2,  the next city for 2 is the city 3,  ...  the next city for n is the city 1. Thus, the route is a cycle, cities are numbered in the direction of travel (the route is directed in one way).Blogger Polycarp wants to start his journey in the city 1. For each city he knows the value aiÂ \xe2\x80\x94 how many selfies he wants to do in i-th city. He can take no more than one selfie in one visit to each city. Since he is traveling by train, he can\'t skip the city (he always moves from the city i to the city i+1Â for 1\xe2\x89\xa4i<n and from n to 1). Thus, when the train stops in the city, Polycarp must visit this city. If Polycarp visits the city multiple times, all visits are counted separately.What is the least number of city visits Polycarp will have to complete to fulfill his plan for the number of selfies for each city? Note that he always visits the city 1, since it is this city that his journey begins in." 1500
1211A "Three Problems" "*special problem,implementation" "Polycarp is choosing three problems for creating a programming test. Totally he has n problems in his list. The complexity of the i-th problem equals ri. All problems are numerated from 1 to n.Help Polycarp to choose such three problems a, b and c, so that the complexity of the first problem strictly less than the complexity of second problem and the complexity of the second problem is strictly less than the complexity of the third problem. So, for chosen problems a, b and c it should be true that ra<rb<rc.If Polycarp can choose three problems in different ways, you can print any of them." 1000
1210G "Mateusz and Escape Room" dp "Mateusz likes to travel! However, on his 42nd visit to Saint Computersburg there is not much left to sightsee. That\'s why he decided to go to an escape room with his friends!The team has solved all riddles flawlessly. There is only one riddle remaining \xe2\x80\x94 a huge circular table! There are n weighing scales lying on top of the table, distributed along the circle. Each scale is adjacent to exactly two other scales: for each i\xe2\x88\x88{1,2,\xe2\x80\xa6,n\xe2\x88\x921}, the i-th and the (i+1)-th scales are adjacent to each other, as well as the first and the n-th scale.The i-th scale initially contains ai heavy coins. Mateusz can perform moves \xe2\x80\x94 each move consists of fetching a single coin from one scale and putting it on any adjacent scale.It turns out that the riddle will be solved when there is a specific amount of coins on each of the scales. Specifically, each scale has parameters li and ri. If each coin lies on a single scale and for each i, the i-th scale contains at least li and at most ri coins, the riddle will be solved and Mateusz\'s team will win!Mateusz is aiming for the best possible time. Therefore, he wants to solved the riddle as quickly as possible. What is the minimum possible number of moves required to fulfill all the conditions?" 3500
1210F2 "Marek and Matching (hard version)" "brute force,probabilities" "This is a harder version of the problem. In this version, n\xe2\x89\xa47n\xe2\x89\xa47.Marek is working hard on creating strong test cases to his new algorithmic problem. Do you want to know what it is? Nah, we\'re not telling you. However, we can tell you how he generates test cases.Marek chooses an integer nn and n2n2 integers pijpij (1\xe2\x89\xa4i\xe2\x89\xa4n1\xe2\x89\xa4i\xe2\x89\xa4n, 1\xe2\x89\xa4j\xe2\x89\xa4n1\xe2\x89\xa4j\xe2\x89\xa4n). He then generates a random bipartite graph with 2n2n vertices. There are nn vertices on the left side: \xe2\x84\x931,\xe2\x84\x932,\xe2\x80\xa6,\xe2\x84\x93n\xe2\x84\x931,\xe2\x84\x932,\xe2\x80\xa6,\xe2\x84\x93n, and nn vertices on the right side: r1,r2,\xe2\x80\xa6,rnr1,r2,\xe2\x80\xa6,rn. For each ii and jj, he puts an edge between vertices \xe2\x84\x93i\xe2\x84\x93i and rjrj with probability pijpij percent.It turns out that the tests will be strong only if a perfect matching exists in the generated graph. What is the probability that this will occur?It can be shown that this value can be represented as PQPQ where PP and QQ are coprime integers and Q\xe2\x89\xa1\xcc\xb80(mod109+7)Q\xe2\x89\xa20(mod109+7). Let Q\xe2\x88\x921Q\xe2\x88\x921 be an integer for which Q\xe2\x8b\x85Q\xe2\x88\x921\xe2\x89\xa11(mod109+7)Q\xe2\x8b\x85Q\xe2\x88\x921\xe2\x89\xa11(mod109+7). Print the value of P\xe2\x8b\x85Q\xe2\x88\x921P\xe2\x8b\x85Q\xe2\x88\x921 modulo 109+7109+7." 3200
1210F1 "Marek and Matching (easy version)" "brute force,probabilities" "This is an easier version of the problem. In this version, n\xe2\x89\xa46.Marek is working hard on creating strong testcases to his new algorithmic problem. You want to know what it is? Nah, we\'re not telling you. However, we can tell you how he generates the testcases.Marek chooses an integer n and n2 integers pij (1\xe2\x89\xa4i\xe2\x89\xa4n, 1\xe2\x89\xa4j\xe2\x89\xa4n). He then generates a random bipartite graph with 2n vertices. There are n vertices on the left side: \xe2\x84\x931,\xe2\x84\x932,\xe2\x80\xa6,\xe2\x84\x93n, and n vertices on the right side: r1,r2,\xe2\x80\xa6,rn. For each i and j, he puts an edge between vertices \xe2\x84\x93i and rj with probability pij percent.It turns out that the tests will be strong only if a perfect matching exists in the generated graph. What is the probability that this will occur?It can be shown that this value can be represented as PQ where P and Q are coprime integers and Q\xe2\x89\xa20(mod109+7). Let Q\xe2\x88\x921 be an integer for which Q\xe2\x8b\x85Q\xe2\x88\x921\xe2\x89\xa11(mod109+7). Print the value of P\xe2\x8b\x85Q\xe2\x88\x921 modulo 109+7." 3100
1210E "Wojtek and Card Tricks" math "Wojtek has just won a maths competition in Byteland! The prize is admirable \xe2\x80\x94 a great book called \'Card Tricks for Everyone.\' \'Great!\' he thought, \'I can finally use this old, dusted deck of cards that\'s always been lying unused on my desk!\'The first chapter of the book is \'How to Shuffle k Cards in Any Order You Want.\' It\'s basically a list of n intricate methods of shuffling the deck of k cards in a deterministic way. Specifically, the i-th recipe can be described as a permutation (Pi,1,Pi,2,\xe2\x80\xa6,Pi,k) of integers from 1 to k. If we enumerate the cards in the deck from 1 to k from top to bottom, then Pi,j indicates the number of the j-th card from the top of the deck after the shuffle.The day is short and Wojtek wants to learn only some of the tricks today. He will pick two integers l,r (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n), and he will memorize each trick from the l-th to the r-th, inclusive. He will then take a sorted deck of k cards and repeatedly apply random memorized tricks until he gets bored. He still likes maths, so he started wondering: how many different decks can he have after he stops shuffling it?Wojtek still didn\'t choose the integers l and r, but he is still curious. Therefore, he defined f(l,r) as the number of different decks he can get if he memorizes all the tricks between the l-th and the r-th, inclusive. What is the value ofn\xe2\x88\x91l=1n\xe2\x88\x91r=lf(l,r)?" 2700
1210D "Konrad and Company Evaluation" graphs "Konrad is a Human Relations consultant working for VoltModder, a large electrical equipment producer. Today, he has been tasked with evaluating the level of happiness in the company.There are nn people working for VoltModder, numbered from 11 to nn. Each employee earns a different amount of money in the company \xe2\x80\x94 initially, the ii-th person earns ii rubles per day.On each of qq following days, the salaries will be revised. At the end of the ii-th day, employee vivi will start earning n+in+i rubles per day and will become the best-paid person in the company. The employee will keep his new salary until it gets revised again.Some pairs of people don\'t like each other. This creates a great psychological danger in the company. Formally, if two people aa and bb dislike each other and aa earns more money than bb, employee aa will brag about this to bb. A dangerous triple is a triple of three employees aa, bb and cc, such that aa brags to bb, who in turn brags to cc. If aa dislikes bb, then bb dislikes aa.At the beginning of each day, Konrad needs to evaluate the number of dangerous triples in the company. Can you help him do it?" 2400
1210C "Kamil and Making a Stream" "math,number theory,trees" "Kamil likes streaming the competitive programming videos. His MeTube channel has recently reached 100100 million subscribers. In order to celebrate this, he posted a video with an interesting problem he couldn\'t solve yet. Can you help him?You\'re given a tree \xe2\x80\x94 a connected undirected graph consisting of nn vertices connected by n\xe2\x88\x921n\xe2\x88\x921 edges. The tree is rooted at vertex 11. A vertex uu is called an ancestor of vv if it lies on the shortest path between the root and vv. In particular, a vertex is an ancestor of itself.Each vertex vv is assigned its beauty xvxv \xe2\x80\x94 a non-negative integer not larger than 10121012. This allows us to define the beauty of a path. Let uu be an ancestor of vv. Then we define the beauty f(u,v)f(u,v) as the greatest common divisor of the beauties of all vertices on the shortest path between uu and vv. Formally, if u=t1,t2,t3,\xe2\x80\xa6,tk=vu=t1,t2,t3,\xe2\x80\xa6,tk=v are the vertices on the shortest path between uu and vv, then f(u,v)=gcd(xt1,xt2,\xe2\x80\xa6,xtk)f(u,v)=gcd(xt1,xt2,\xe2\x80\xa6,xtk). Here, gcdgcd denotes the greatest common divisor of a set of numbers. In particular, f(u,u)=gcd(xu)=xuf(u,u)=gcd(xu)=xu.Your task is to find the sum\xe2\x88\x91uÂ is an ancestor ofÂ vf(u,v).\xe2\x88\x91uÂ is an ancestor ofÂ vf(u,v).As the result might be too large, please output it modulo 109+7109+7.Note that for each yy, gcd(0,y)=gcd(y,0)=ygcd(0,y)=gcd(y,0)=y. In particular, gcd(0,0)=0gcd(0,0)=0." 2000
1210B "Marcin and Training Camp" "brute force,greedy" "Marcin is a coach in his university. There are n students who want to attend a training camp. Marcin is a smart coach, so he wants to send only the students that can work calmly with each other.Let\'s focus on the students. They are indexed with integers from 1 to n. Each of them can be described with two integers ai and bi; bi is equal to the skill level of the i-th student (the higher, the better). Also, there are 60 known algorithms, which are numbered with integers from 0 to 59. If the i-th student knows the j-th algorithm, then the j-th bit (2j) is set in the binary representation of ai. Otherwise, this bit is not set.Student x thinks that he is better than student y if and only if x knows some algorithm which y doesn\'t know. Note that two students can think that they are better than each other. A group of students can work together calmly if no student in this group thinks that he is better than everyone else in this group.Marcin wants to send a group of at least two students which will work together calmly and will have the maximum possible sum of the skill levels. What is this sum?" 1700
1210A "Anadi and Domino" "brute force,graphs" "Anadi has a set of dominoes. Every domino has two parts, and each part contains some dots. For every aa and bb such that 1\xe2\x89\xa4a\xe2\x89\xa4b\xe2\x89\xa461\xe2\x89\xa4a\xe2\x89\xa4b\xe2\x89\xa46, there is exactly one domino with aa dots on one half and bb dots on the other half. The set contains exactly 2121 dominoes. Here is an exact illustration of his set:  Also, Anadi has an undirected graph without self-loops and multiple edges. He wants to choose some dominoes and place them on the edges of this graph. He can use at most one domino of each type. Each edge can fit at most one domino. It\'s not necessary to place a domino on each edge of the graph.When placing a domino on an edge, he also chooses its direction. In other words, one half of any placed domino must be directed toward one of the endpoints of the edge and the other half must be directed toward the other endpoint. There\'s a catch: if there are multiple halves of dominoes directed toward the same vertex, each of these halves must contain the same number of dots.How many dominoes at most can Anadi place on the edges of his graph?" 1700
1209H "Moving Walkways" "data structures,greedy,math" "Airports often use moving walkways to help you walking big distances faster. Each such walkway has some speed that effectively increases your speed. You can stand on such a walkway and let it move you, or you could also walk and then your effective speed is your walking speed plus walkway\'s speed.Limak wants to get from point 0 to point L on a straight line. There are n disjoint walkways in between. The i-th walkway is described by two integers xi and yi and a real value si. The i-th walkway starts at xi, ends at yi and has speed si. Every walkway is located inside the segment [0,L] and no two walkways have positive intersection. However, they can touch by endpoints.Limak needs to decide how to distribute his energy. For example, it might make more sense to stand somewhere (or to walk slowly) to then have a lot of energy to walk faster.Limak\'s initial energy is 0 and it must never drop below that value. At any moment, he can walk with any speed v in the interval [0,2] and it will cost him v energy per second, but he continuously recovers energy with speed of 1 energy per second. So, when he walks with speed v, his energy increases by (1\xe2\x88\x92v). Note that negative value would mean losing energy.In particular, he can walk with speed 1 and this won\'t change his energy at all, while walking with speed 0.77 effectively gives him 0.23 energy per second.Limak can choose his speed arbitrarily (any real value in interval [0,2]) at every moment of time (including the moments when he is located on non-integer positions). Everything is continuous (non-discrete).What is the fastest time Limak can get from 0 to L?" 3300
1209G2 "Into Blocks (hard version)" "data structures" "This is a harder version of the problem. In this version q\xe2\x89\xa4200000.A sequence of integers is called nice if its elements are arranged in blocks like in [3,3,3,4,1,1]. Formally, if two elements are equal, everything in between must also be equal.Let\'s define difficulty of a sequence as a minimum possible number of elements to change to get a nice sequence. However, if you change at least one element of value x to value y, you must also change all other elements of value x into y as well. For example, for [3,3,1,3,2,1,2] it isn\'t allowed to change first 1 to 3 and second 1 to 2. You need to leave 1\'s untouched or change them to the same value.You are given a sequence of integers a1,a2,\xe2\x80\xa6,an and q updates.Each update is of form ""i x""Â \xe2\x80\x94 change ai to x. Updates are not independent (the change stays for the future).Print the difficulty of the initial sequence and of the sequence after every update." 3200
1209G1 "Into Blocks (easy version)" "data structures,dsu,greedy,implementation,two pointers" "This is an easier version of the next problem. In this version, q=0.A sequence of integers is called nice if its elements are arranged in blocks like in [3,3,3,4,1,1]. Formally, if two elements are equal, everything in between must also be equal.Let\'s define difficulty of a sequence as a minimum possible number of elements to change to get a nice sequence. However, if you change at least one element of value x to value y, you must also change all other elements of value x into y as well. For example, for [3,3,1,3,2,1,2] it isn\'t allowed to change first 1 to 3 and second 1 to 2. You need to leave 1\'s untouched or change them to the same value.You are given a sequence of integers a1,a2,\xe2\x80\xa6,an and q updates.Each update is of form ""i x""Â \xe2\x80\x94 change ai to x. Updates are not independent (the change stays for the future).Print the difficulty of the initial sequence and of the sequence after every update." 2000
1209F "Koala and Notebook" "data structures,dfs and similar,graphs,shortest paths,strings,trees" "Koala Land consists of m bidirectional roads connecting n cities. The roads are numbered from 1 to m by order in input. It is guaranteed, that one can reach any city from every other city.Koala starts traveling from city 1. Whenever he travels on a road, he writes its number down in his notebook. He doesn\'t put spaces between the numbers, so they all get concatenated into a single number.Before embarking on his trip, Koala is curious about the resulting number for all possible destinations. For each possible destination, what is the smallest number he could have written for it?Since these numbers may be quite large, print their remainders modulo 109+7. Please note, that you need to compute the remainder of the minimum possible number, not the minimum possible remainder." 2600
1209E2 "Rotate Columns (hard version)" bitmasks,dp,greedy,sortings "This is a harder version of the problem. The difference is only in constraints.You are given a rectangular n\xc3\x97m matrix a. In one move you can choose any column and cyclically shift elements in this column. You can perform this operation as many times as you want (possibly zero). You can perform this operation to a column multiple times.After you are done with cyclical shifts, you compute for every row the maximal value in it. Suppose that for i-th row it is equal ri. What is the maximal possible value of r1+r2+\xe2\x80\xa6+rn?" 2500
1209E1 "Rotate Columns (easy version)" "bitmasks,brute force,dp,greedy,sortings" "This is an easier version of the next problem. The difference is only in constraints.You are given a rectangular n\xc3\x97m matrix a. In one move you can choose any column and cyclically shift elements in this column. You can perform this operation as many times as you want (possibly zero). You can perform this operation to a column multiple times.After you are done with cyclical shifts, you compute for every row the maximal value in it. Suppose that for i-th row it is equal ri. What is the maximal possible value of r1+r2+\xe2\x80\xa6+rn?" 2000
1209D "Cow and Snacks" "dfs and similar,dsu,graphs" "The legendary Farmer John is throwing a huge party, and animals from all over the world are hanging out at his house. His guests are hungry, so he instructs his cow Bessie to bring out the snacks! Moo!There are n snacks flavors, numbered with integers 1,2,\xe2\x80\xa6,n. Bessie has n snacks, one snack of each flavor. Every guest has exactly two favorite flavors. The procedure for eating snacks will go as follows:  First, Bessie will line up the guests in some way.  Then in this order, guests will approach the snacks one by one.  Each guest in their turn will eat all remaining snacks of their favorite flavor. In case no favorite flavors are present when a guest goes up, they become very sad.  Help Bessie to minimize the number of sad guests by lining the guests in an optimal way." 1700
1209C "Paint the Digits" "constructive algorithms,greedy,implementation" "You are given a sequence of n digits d1d2\xe2\x80\xa6dn. You need to paint all the digits in two colors so that:  each digit is painted either in the color 1 or in the color 2;  if you write in a row from left to right all the digits painted in the color 1, and then after them all the digits painted in the color 2, then the resulting sequence of n digits will be non-decreasing (that is, each next digit will be greater than or equal to the previous digit). For example, for the sequence d=914 the only valid coloring is 211 (paint in the color 1 two last digits, paint in the color 2 the first digit). But 122 is not a valid coloring (9 concatenated with 14 is not a non-decreasing sequence).It is allowed that either of the two colors is not used at all. Digits painted in the same color are not required to have consecutive positions.Find any of the valid ways to paint the given sequence of digits or determine that it is impossible to do." 1500
1209B "Koala and Lights" "implementation,math,number theory" "It is a holiday season, and Koala is decorating his house with cool lights! He owns n lights, all of which flash periodically.After taking a quick glance at them, Koala realizes that each of his lights can be described with two parameters ai and bi. Light with parameters ai and bi will toggle (on to off, or off to on) every ai seconds starting from the bi-th second. In other words, it will toggle at the moments bi, bi+ai, bi+2\xe2\x8b\x85ai and so on.You know for each light whether it\'s initially on or off and its corresponding parameters ai and bi. Koala is wondering what is the maximum number of lights that will ever be on at the same time. So you need to find that out.  Here is a graphic for the first example." 1300
1209A "Paint the Numbers" greedy,implementation,math "You are given a sequence of integers a1,a2,\xe2\x80\xa6,an. You need to paint elements in colors, so that:   If we consider any color, all elements of this color must be divisible by the minimal element of this color.  The number of used colors must be minimized. For example, it\'s fine to paint elements [40,10,60] in a single color, because they are all divisible by 10. You can use any color an arbitrary amount of times (in particular, it is allowed to use a color only once). The elements painted in one color do not need to be consecutive.For example, if a=[6,2,3,4,12] then two colors are required: let\'s paint 6, 3 and 12 in the first color (6, 3 and 12 are divisible by 3) and paint 2 and 4 in the second color (2 and 4 are divisible by 2). For example, if a=[10,7,15] then 3 colors are required (we can simply paint each element in an unique color)." 800
1208H "Red Blue Tree" "data structures,implementation,trees" "You are given a tree of n nodes. The tree is rooted at node 1, which is not considered as a leaf regardless of its degree.Each leaf of the tree has one of the two colors: red or blue. Leaf node v initially has color sv.The color of each of the internal nodes (including the root) is determined as follows.   Let b be the number of blue immediate children, and r be the number of red immediate children of a given vertex.  Then the color of this vertex is blue if and only if b\xe2\x88\x92r\xe2\x89\xa5k, otherwise red. Integer k is a parameter that is same for all the nodes.You need to handle the following types of queries:   1 v: print the color of node v;  2 v c: change the color of leaf v to c (c=0 means red, c=1 means blue);  3 h: update the current value of k to h." 3500
1208G Polygons "greedy,math,number theory" "You are given two integers n and k.You need to construct k regular polygons having same circumcircle, with distinct number of sides l between 3 and n.   Illustration for the first example. You can rotate them to minimize the total number of distinct points on the circle. Find the minimum number of such points." 2800
1208F "Bits And Pieces" "bitmasks,dfs and similar,dp,greedy" "You are given an array a of n integers.You need to find the maximum value of ai|(aj&ak) over all triplets (i,j,k) such that i<j<k.Here & denotes the bitwise AND operation, and | denotes the bitwise OR operation." 2600
1208E "Let Them Slide" "data structures,implementation" "You are given n arrays that can have different sizes. You also have a table with w columns and n rows. The i-th array is placed horizontally in the i-th row. You can slide each array within its row as long as it occupies several consecutive cells and lies completely inside the table.You need to find the maximum sum of the integers in the j-th column for each j from 1 to w independently.  Optimal placements for columns 1, 2 and 3 are shown on the pictures from left to right. Note that you can exclude any array out of a column provided it remains in the window. In this case its value is considered to be zero." 2200
1208D "Restore Permutation" "binary search,data structures,greedy,implementation" "An array of integers p1,p2,\xe2\x80\xa6,pn is called a permutation if it contains each number from 1 to n exactly once. For example, the following arrays are permutations: [3,1,2],[1],[1,2,3,4,5] and [4,3,1,2]. The following arrays are not permutations: [2],[1,1],[2,3,4].There is a hidden permutation of length n.For each index i, you are given si, which equals to the sum of all pj such that j<i and pj<pi. In other words, si is the sum of elements before the i-th element that are smaller than the i-th element.Your task is to restore the permutation." 1900
1208C "Magic Grid" "constructive algorithms" "Let us define a magic grid to be a square matrix of integers of size n\xc3\x97n, satisfying the following conditions.   All integers from 0 to (n2\xe2\x88\x921) inclusive appear in the matrix exactly once.  Bitwise XOR of all elements in a row or a column must be the same for each row and column. You are given an integer n which is a multiple of 4. Construct a magic grid of size n\xc3\x97n." 1800
1208B Uniqueness "binary search,brute force,implementation,two pointers" "You are given an array a1,a2,\xe2\x80\xa6,an. You can remove at most one subsegment from it. The remaining elements should be pairwise distinct.In other words, at most one time you can choose two integers l and r (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n) and delete integers al,al+1,\xe2\x80\xa6,ar from the array. Remaining elements should be pairwise distinct. Find the minimum size of the subsegment you need to remove to make all remaining elements distinct." 1500
1208A XORinacci math "Cengiz recently learned Fibonacci numbers and now he is studying different algorithms to find them. After getting bored of reading them, he came with his own new type of numbers that he named XORinacci numbers. He defined them as follows:   f(0)=a;  f(1)=b;  f(n)=f(n\xe2\x88\x921)\xe2\x8a\x95f(n\xe2\x88\x922) when n>1, where \xe2\x8a\x95 denotes the bitwise XOR operation. You are given three integers a, b, and n, calculate f(n).You have to answer for T independent test cases." 900
1207G "Indie Album" "data structures,dfs and similar,hashing,string suffix structures,strings,trees" "Mishka\'s favourite experimental indie band has recently dropped a new album! Songs of that album share one gimmick. Each name si is one of the following types:  1Â c \xe2\x80\x94 a single lowercase Latin letter;  2Â jÂ c \xe2\x80\x94 name sj (1\xe2\x89\xa4j<i) with a single lowercase Latin letter appended to its end. Songs are numbered from 1 to n. It\'s guaranteed that the first song is always of type 1.Vova is rather interested in the new album but he really doesn\'t have the time to listen to it entirely. Thus he asks Mishka some questions about it to determine if some song is worth listening to. Questions have the following format:  iÂ t \xe2\x80\x94 count the number of occurrences of string t in si (the name of the i-th song of the album) as a continuous substring, t consists only of lowercase Latin letters. Mishka doesn\'t question the purpose of that information, yet he struggles to provide it. Can you please help Mishka answer all Vova\'s questions?" 2700
1207F "Remainder Problem" "brute force,data structures,implementation" "You are given an array a consisting of 500000 integers (numbered from 1 to 500000). Initially all elements of a are zero.You have to process two types of queries to this array:  1 x yÂ \xe2\x80\x94 increase ax by y;  2 x yÂ \xe2\x80\x94 compute \xe2\x88\x91i\xe2\x88\x88R(x,y)ai, where R(x,y) is the set of all integers from 1 to 500000 which have remainder y modulo x. Can you process all the queries?" 2100
1207E "XOR Guessing" bitmasks,interactive,math "This is an interactive problem. Remember to flush your output while communicating with the testing program. You may use fflush(stdout) in C++, system.out.flush() in Java, stdout.flush() in Python or flush(output) in Pascal to flush the output. If you use some other programming language, consult its documentation. You may also refer to the guide on interactive problems: https://codeforces.com/blog/entry/45307.The jury picked an integer x not less than 0 and not greater than 214\xe2\x88\x921. You have to guess this integer.To do so, you may ask no more than 2 queries. Each query should consist of 100 integer numbers a1, a2, ..., a100 (each integer should be not less than 0 and not greater than 214\xe2\x88\x921). In response to your query, the jury will pick one integer i (1\xe2\x89\xa4i\xe2\x89\xa4100) and tell you the value of ai\xe2\x8a\x95x (the bitwise XOR of ai and x). There is an additional constraint on the queries: all 200 integers you use in the queries should be distinct.It is guaranteed that the value of x is fixed beforehand in each test, but the choice of i in every query may depend on the integers you send." 1900
1207D "Number Of Permutations" combinatorics "You are given a sequence of n pairs of integers: (a1,b1),(a2,b2),\xe2\x80\xa6,(an,bn). This sequence is called bad if it is sorted in non-descending order by first elements or if it is sorted in non-descending order by second elements. Otherwise the sequence is good. There are examples of good and bad sequences:  s=[(1,2),(3,2),(3,1)] is bad because the sequence of first elements is sorted: [1,3,3];  s=[(1,2),(3,2),(1,2)] is bad because the sequence of second elements is sorted: [2,2,2];  s=[(1,1),(2,2),(3,3)] is bad because both sequences (the sequence of first elements and the sequence of second elements) are sorted;  s=[(1,3),(3,3),(2,2)] is good because neither the sequence of first elements ([1,3,2]) nor the sequence of second elements ([3,3,2]) is sorted. Calculate the number of permutations of size n such that after applying this permutation to the sequence s it turns into a good sequence. A permutation p of size n is a sequence p1,p2,\xe2\x80\xa6,pn consisting of n distinct integers from 1 to n (1\xe2\x89\xa4pi\xe2\x89\xa4n). If you apply permutation p1,p2,\xe2\x80\xa6,pn to the sequence s1,s2,\xe2\x80\xa6,sn you get the sequence sp1,sp2,\xe2\x80\xa6,spn. For example, if s=[(1,2),(1,3),(2,3)] and p=[2,3,1] then s turns into [(1,3),(2,3),(1,2)]." 1800
1207C "Gas Pipeline" dp,greedy "You are responsible for installing a gas pipeline along a road. Let\'s consider the road (for simplicity) as a segment [0,n] on OX axis. The road can have several crossroads, but for simplicity, we\'ll denote each crossroad as an interval (x,x+1) with integer x. So we can represent the road as a binary string consisting of n characters, where character 0 means that current interval doesn\'t contain a crossroad, and 1 means that there is a crossroad.Usually, we can install the pipeline along the road on height of 1 unit with supporting pillars in each integer point (so, if we are responsible for [0,n] road, we must install n+1 pillars). But on crossroads we should lift the pipeline up to the height 2, so the pipeline won\'t obstruct the way for cars.We can do so inserting several zig-zag-like lines. Each zig-zag can be represented as a segment [x,x+1] with integer x consisting of three parts: 0.5 units of horizontal pipe + 1 unit of vertical pipe + 0.5 of horizontal. Note that if pipeline is currently on height 2, the pillars that support it should also have length equal to 2 units.  Each unit of gas pipeline costs us a bourles, and each unit of pillar \xe2\x80\x94 b bourles. So, it\'s not always optimal to make the whole pipeline on the height 2. Find the shape of the pipeline with minimum possible cost and calculate that cost.Note that you must start and finish the pipeline on height 1 and, also, it\'s guaranteed that the first and last characters of the input string are equal to 0." 1500
1207B "Square Filling" "constructive algorithms,greedy,implementation" "You are given two matrices A and B. Each matrix contains exactly n rows and m columns. Each element of A is either 0 or 1; each element of B is initially 0.You may perform some operations with matrix B. During each operation, you choose any submatrix of B having size 2\xc3\x972, and replace every element in the chosen submatrix with 1. In other words, you choose two integers x and y such that 1\xe2\x89\xa4x<n and 1\xe2\x89\xa4y<m, and then set Bx,y, Bx,y+1, Bx+1,y and Bx+1,y+1 to 1.Your goal is to make matrix B equal to matrix A. Two matrices A and B are equal if and only if every element of matrix A is equal to the corresponding element of matrix B.Is it possible to make these matrices equal? If it is, you have to come up with a sequence of operations that makes B equal to A. Note that you don\'t have to minimize the number of operations." 1200
1207A "There Are Two Types Of Burgers" "brute force,greedy,implementation,math" "There are two types of burgers in your restaurant \xe2\x80\x94 hamburgers and chicken burgers! To assemble a hamburger you need two buns and a beef patty. To assemble a chicken burger you need two buns and a chicken cutlet. You have b buns, p beef patties and f chicken cutlets in your restaurant. You can sell one hamburger for h dollars and one chicken burger for c dollars. Calculate the maximum profit you can achieve.You have to answer t independent queries." 800
1206B "Make Product Equal One" dp,implementation "You are given n numbers a1,a2,\xe2\x80\xa6,an. With a cost of one coin you can perform the following operation:Choose one of these numbers and add or subtract 1 from it.In particular, we can apply this operation to the same number several times.We want to make the product of all these numbers equal to 1, in other words, we want a1\xe2\x8b\x85a2 \xe2\x80\xa6 \xe2\x8b\x85an=1. For example, for n=3 and numbers [1,\xe2\x88\x923,0] we can make product equal to 1 in 3 coins: add 1 to second element, add 1 to second element again, subtract 1 from third element, so that array becomes [1,\xe2\x88\x921,\xe2\x88\x921]. And 1\xe2\x8b\x85(\xe2\x88\x921)\xe2\x8b\x85(\xe2\x88\x921)=1.What is the minimum cost we will have to pay to do that?" 900
1206A "Choose Two Numbers" math,sortings "You are given an array A, consisting of n positive integers a1,a2,\xe2\x80\xa6,an, and an array B, consisting of m positive integers b1,b2,\xe2\x80\xa6,bm. Choose some element a of A and some element b of B such that a+b doesn\'t belong to A and doesn\'t belong to B. For example, if A=[2,1,7] and B=[1,3,4], we can choose 1 from A and 4 from B, as number 5=1+4 doesn\'t belong to A and doesn\'t belong to B. However, we can\'t choose 2 from A and 1 from B, as 3=2+1 belongs to B.It can be shown that such a pair exists. If there are multiple answers, print any.Choose and print any such two numbers." 800
1205F "Beauty of a Permutation" "constructive algorithms,math" "Define the beauty of a permutation of numbers from 1 to n (p1,p2,\xe2\x80\xa6,pn) as number of pairs (L,R) such that 1\xe2\x89\xa4L\xe2\x89\xa4R\xe2\x89\xa4n and numbers pL,pL+1,\xe2\x80\xa6,pR are consecutive R\xe2\x88\x92L+1 numbers in some order. For example, the beauty of the permutation (1,2,5,3,4) equals 9, and segments, corresponding to pairs, are [1], [2], [5], [4], [3], [1,2], [3,4], [5,3,4], [1,2,5,3,4].Answer q independent queries. In each query, you will be given integers n and k. Determine if there exists a permutation of numbers from 1 to n with beauty equal to k, and if there exists, output one of them." 3400
1205E "Expected Value Again" combinatorics,strings "You are given integers n, k. Let\'s consider the alphabet consisting of k different elements.Let beauty f(s) of the string s be the number of indexes i, 1\xe2\x89\xa4i<|s|, for which prefix of s of length i equals to suffix of s of length i. For example, beauty of the string abacaba equals 2, as for i=1,3 prefix and suffix of length i are equal.Consider all words of length n in the given alphabet. Find the expected value of f(s)2 of a uniformly chosen at random word. We can show that it can be expressed as PQ, where P and Q are coprime and Q isn\'t divided by 109+7. Output P\xe2\x8b\x85Q\xe2\x88\x921mod109+7." 3100
1205D "Almost All" "constructive algorithms,trees" "You are given a tree with n nodes. You have to write non-negative integers on its edges so that the following condition would be satisfied:For every two nodes i, j, look at the path between them and count the sum of numbers on the edges of this path. Write all obtained sums on the blackboard. Then every integer from 1 to \xe2\x8c\x8a2n29\xe2\x8c\x8b has to be written on the blackboard at least once. It is guaranteed that such an arrangement exists." 2700
1205C "Palindromic Paths" implementation,interactive "This is an interactive problemYou are given a grid n\xc3\x97n, where n is odd. Rows are enumerated from 1 to n from up to down, columns are enumerated from 1 to n from left to right. Cell, standing on the intersection of row x and column y, is denoted by (x,y).Every cell contains 0 or 1. It is known that the top-left cell contains 1, and the bottom-right cell contains 0.We want to know numbers in all cells of the grid. To do so we can ask the following questions: ""? x1 y1 x2 y2"", where 1\xe2\x89\xa4x1\xe2\x89\xa4x2\xe2\x89\xa4n, 1\xe2\x89\xa4y1\xe2\x89\xa4y2\xe2\x89\xa4n, and x1+y1+2\xe2\x89\xa4x2+y2. In other words, we output two different cells (x1,y1), (x2,y2) of the grid such that we can get from the first to the second by moving only to the right and down, and they aren\'t adjacent.As a response to such question you will be told if there exists a path between (x1,y1) and (x2,y2), going only to the right or down, numbers in cells of which form a palindrome.For example, paths, shown in green, are palindromic, so answer for ""? 1 1 2 3"" and ""? 1 2 3 3"" would be that there exists such path. However, there is no palindromic path between (1,1) and (3,1).  Determine all cells of the grid by asking not more than n2 questions. It can be shown that the answer always exists." 2400
1205B "Shortest Cycle" "bitmasks,brute force,graphs,shortest paths" "You are given n integer numbers a1,a2,\xe2\x80\xa6,an. Consider graph on n nodes, in which nodes i, j (i\xe2\x89\xa0j) are connected if and only if, ai AND aj\xe2\x89\xa00, where AND denotes the bitwise AND operation.Find the length of the shortest cycle in this graph or determine that it doesn\'t have cycles at all." 1900
1205A "Almost Equal" "constructive algorithms,greedy,math" "You are given integer n. You have to arrange numbers from 1 to 2n, using each of them exactly once, on the circle, so that the following condition would be satisfied:For every n consecutive numbers on the circle write their sum on the blackboard. Then any two of written on the blackboard 2n numbers differ not more than by 1.For example, choose n=3. On the left you can see an example of a valid arrangement: 1+4+5=10, 4+5+2=11, 5+2+3=10, 2+3+6=11, 3+6+1=10, 6+1+4=11, any two numbers differ by at most 1. On the right you can see an invalid arrangement: for example, 5+1+6=12, and 3+2+4=9, 9 and 12 differ more than by 1." 1200
1204E "Natasha, Sasha and the Prefix Sums" "combinatorics,dp,math,number theory" "Natasha\'s favourite numbers are n and 1, and Sasha\'s favourite numbers are m and \xe2\x88\x921. One day Natasha and Sasha met and wrote down every possible array of length n+m such that some n of its elements are equal to 1 and another m elements are equal to \xe2\x88\x921. For each such array they counted its maximal prefix sum, probably an empty one which is equal to 0 (in another words, if every nonempty prefix sum is less to zero, then it is considered equal to zero). Formally, denote as f(a) the maximal prefix sum of an array a1,\xe2\x80\xa6,l of length l\xe2\x89\xa50. Then: f(a)=max(0,max1\xe2\x89\xa4i\xe2\x89\xa4li\xe2\x88\x91j=1aj)Now they want to count the sum of maximal prefix sums for each such an array and they are asking you to help. As this sum can be very large, output it modulo 998244853." 2300
1204D2 "Kirk and a Binary String (hard version)" "data structures,greedy,math,strings" "The only difference between easy and hard versions is the length of the string. You can hack this problem if you solve it. But you can hack the previous problem only if you solve both problems.Kirk has a binary string s (a string which consists of zeroes and ones) of length n and he is asking you to find a binary string t of the same length which satisfies the following conditions: For any l and r (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n) the length of the longest non-decreasing subsequence of the substring slsl+1\xe2\x80\xa6sr is equal to the length of the longest non-decreasing subsequence of the substring tltl+1\xe2\x80\xa6tr; The number of zeroes in t is the maximum possible.A non-decreasing subsequence of a string p is a sequence of indices i1,i2,\xe2\x80\xa6,ik such that i1<i2<\xe2\x80\xa6<ik and pi1\xe2\x89\xa4pi2\xe2\x89\xa4\xe2\x80\xa6\xe2\x89\xa4pik. The length of the subsequence is k.If there are multiple substrings which satisfy the conditions, output any." 2100
1204D1 "Kirk and a Binary String (easy version)" "brute force,greedy,strings" "The only difference between easy and hard versions is the length of the string. You can hack this problem only if you solve both problems.Kirk has a binary string s (a string which consists of zeroes and ones) of length n and he is asking you to find a binary string t of the same length which satisfies the following conditions: For any l and r (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n) the length of the longest non-decreasing subsequence of the substring slsl+1\xe2\x80\xa6sr is equal to the length of the longest non-decreasing subsequence of the substring tltl+1\xe2\x80\xa6tr; The number of zeroes in t is the maximum possible.A non-decreasing subsequence of a string p is a sequence of indices i1,i2,\xe2\x80\xa6,ik such that i1<i2<\xe2\x80\xa6<ik and pi1\xe2\x89\xa4pi2\xe2\x89\xa4\xe2\x80\xa6\xe2\x89\xa4pik. The length of the subsequence is k.If there are multiple substrings which satisfy the conditions, output any." 2000
1204C "Anna, Svyatoslav and Maps" "dp,graphs,greedy,shortest paths" "The main characters have been omitted to be short.You are given a directed unweighted graph without loops with n vertexes and a path in it (that path is not necessary simple) given by a sequence p1,p2,\xe2\x80\xa6,pm of m vertexes; for each 1\xe2\x89\xa4i<m there is an arc from pi to pi+1.Define the sequence v1,v2,\xe2\x80\xa6,vk of k vertexes as good, if v is a subsequence of p, v1=p1, vk=pm, and p is one of the shortest paths passing through the vertexes v1, \xe2\x80\xa6, vk in that order.A sequence a is a subsequence of a sequence b if a can be obtained from b by deletion of several (possibly, zero or all) elements. It is obvious that the sequence p is good but your task is to find the shortest good subsequence.If there are multiple shortest good subsequences, output any of them." 1700
1204B "Mislove Has Lost an Array" greedy,math "Mislove had an array a1, a2, \xe2\x8b\xaf, an of n positive integers, but he has lost it. He only remembers the following facts about it: The number of different numbers in the array is not less than l and is not greater than r; For each array\'s element ai either ai=1 or ai is even and there is a number ai2 in the array.For example, if n=5, l=2, r=3 then an array could be [1,2,2,4,4] or [1,1,1,1,2]; but it couldn\'t be [1,2,2,4,8] because this array contains 4 different numbers; it couldn\'t be [1,2,2,3,3] because 3 is odd and isn\'t equal to 1; and it couldn\'t be [1,1,2,2,16] because there is a number 16 in the array but there isn\'t a number 162=8.According to these facts, he is asking you to count the minimal and the maximal possible sums of all elements in an array." 900
1204A "BowWow and the Timetable" math "In the city of Saint Petersburg, a day lasts for 2100 minutes. From the main station of Saint Petersburg, a train departs after 1 minute, 4 minutes, 16 minutes, and so on; in other words, the train departs at time 4k for each integer k\xe2\x89\xa50. Team BowWow has arrived at the station at the time s and it is trying to count how many trains have they missed; in other words, the number of trains that have departed strictly before time s. For example if s=20, then they missed trains which have departed at 1, 4 and 16. As you are the only one who knows the time, help them!Note that the number s will be given you in a binary representation without leading zeroes." 1000
1203F2 "Complete the Projects (hard version)" dp,greedy "The only difference between easy and hard versions is that you should complete all the projects in easy version but this is not necessary in hard version.Polycarp is a very famous freelancer. His current rating is r units.Some very rich customers asked him to complete some projects for their companies. To complete the i-th project, Polycarp needs to have at least ai units of rating; after he completes this project, his rating will change by bi (his rating will increase or decrease by bi) (bi can be positive or negative). Polycarp\'s rating should not fall below zero because then people won\'t trust such a low rated freelancer.Polycarp can choose the order in which he completes projects. Furthermore, he can even skip some projects altogether.To gain more experience (and money, of course) Polycarp wants to choose the subset of projects having maximum possible size and the order in which he will complete them, so he has enough rating before starting each project, and has non-negative rating after completing each project.Your task is to calculate the maximum possible size of such subset of projects." 2300
1203F1 "Complete the Projects (easy version)" greedy "The only difference between easy and hard versions is that you should complete all the projects in easy version but this is not necessary in hard version.Polycarp is a very famous freelancer. His current rating is r units.Some very rich customers asked him to complete some projects for their companies. To complete the i-th project, Polycarp needs to have at least ai units of rating; after he completes this project, his rating will change by bi (his rating will increase or decrease by bi) (bi can be positive or negative). Polycarp\'s rating should not fall below zero because then people won\'t trust such a low rated freelancer.Is it possible to complete all the projects? Formally, write a program to check if such an order of the projects exists, that Polycarp has enough rating before starting each project, and he has non-negative rating after completing each project.In other words, you have to check that there exists such an order of projects in which Polycarp will complete them, so he has enough rating before starting each project, and has non-negative rating after completing each project." 2100
1203E Boxers greedy,sortings "There are n boxers, the weight of the i-th boxer is ai. Each of them can change the weight by no more than 1 before the competition (the weight cannot become equal to zero, that is, it must remain positive). Weight is always an integer number.It is necessary to choose the largest boxing team in terms of the number of people, that all the boxers\' weights in the team are different (i.e. unique).Write a program that for given current values \xe2\x80\x8bai will find the maximum possible number of boxers in a team.It is possible that after some change the weight of some boxer is 150001 (but no more)." 1500
1203D2 "Remove the Substring (hard version)" "binary search,greedy,implementation,two pointers" "The only difference between easy and hard versions is the length of the string.You are given a string s and a string t, both consisting only of lowercase Latin letters. It is guaranteed that t can be obtained from s by removing some (possibly, zero) number of characters (not necessary contiguous) from s without changing order of remaining characters (in other words, it is guaranteed that t is a subsequence of s).For example, the strings ""test"", ""tst"", ""tt"", ""et"" and """" are subsequences of the string ""test"". But the strings ""tset"", ""se"", ""contest"" are not subsequences of the string ""test"".You want to remove some substring (contiguous subsequence) from s of maximum possible length such that after removing this substring t will remain a subsequence of s.If you want to remove the substring s[l;r] then the string s will be transformed to s1s2\xe2\x80\xa6sl\xe2\x88\x921sr+1sr+2\xe2\x80\xa6s|s|\xe2\x88\x921s|s| (where |s| is the length of s).Your task is to find the maximum possible length of the substring you can remove so that t is still a subsequence of s." 1700
1203D1 "Remove the Substring (easy version)" greedy,implementation "The only difference between easy and hard versions is the length of the string.You are given a string s and a string t, both consisting only of lowercase Latin letters. It is guaranteed that t can be obtained from s by removing some (possibly, zero) number of characters (not necessary contiguous) from s without changing order of remaining characters (in other words, it is guaranteed that t is a subsequence of s).For example, the strings ""test"", ""tst"", ""tt"", ""et"" and """" are subsequences of the string ""test"". But the strings ""tset"", ""se"", ""contest"" are not subsequences of the string ""test"".You want to remove some substring (contiguous subsequence) from s of maximum possible length such that after removing this substring t will remain a subsequence of s.If you want to remove the substring s[l;r] then the string s will be transformed to s1s2\xe2\x80\xa6sl\xe2\x88\x921sr+1sr+2\xe2\x80\xa6s|s|\xe2\x88\x921s|s| (where |s| is the length of s).Your task is to find the maximum possible length of the substring you can remove so that t is still a subsequence of s." 1600
1203C "Common Divisors" implementation,math "You are given an array a consisting of n integers.Your task is to say the number of such positive integers x such that x divides each number from the array. In other words, you have to find the number of common divisors of all elements in the array.For example, if the array a will be [2,4,6,2,10], then 1 and 2 divide each number from the array (so the answer for this test is 2)." 1300
1203B "Equal Rectangles" greedy,math "You are given 4n sticks, the length of the i-th stick is ai.You have to create n rectangles, each rectangle will consist of exactly 4 sticks from the given set. The rectangle consists of four sides, opposite sides should have equal length and all angles in it should be right. Note that each stick can be used in only one rectangle. Each stick should be used as a side, you cannot break the stick or use it not to the full length.You want to all rectangles to have equal area. The area of the rectangle with sides a and b is a\xe2\x8b\x85b.Your task is to say if it is possible to create exactly n rectangles of equal area or not.You have to answer q independent queries." 1200
1203A "Circle of Students" implementation "There are n students standing in a circle in some order. The index of the i-th student is pi. It is guaranteed that all indices of students are distinct integers from 1 to n (i.\xe2\x80\x89e. they form a permutation).Students want to start a round dance. A clockwise round dance can be started if the student 2 comes right after the student 1 in clockwise order (there are no students between them), the student 3 comes right after the student 2 in clockwise order, and so on, and the student n comes right after the student n\xe2\x88\x921 in clockwise order. A counterclockwise round dance is almost the same thing \xe2\x80\x94 the only difference is that the student i should be right after the student i\xe2\x88\x921 in counterclockwise order (this condition should be met for every i from 2 to n). For example, if the indices of students listed in clockwise order are [2,3,4,5,1], then they can start a clockwise round dance. If the students have indices [3,2,1,4] in clockwise order, then they can start a counterclockwise round dance.Your task is to determine whether it is possible to start a round dance. Note that the students cannot change their positions before starting the dance; they cannot swap or leave the circle, and no other student can enter the circle. You have to answer q independent queries." 1000
1202F "You Are Given Some Letters..." "binary search,implementation,math" "You are given a uppercase Latin letters \'A\' and b letters \'B\'.The period of the string is the smallest such positive integer k that si=siÂ modÂ k (0-indexed) for each i. Note that this implies that k won\'t always divide a+b=|s|.For example, the period of string ""ABAABAA"" is 3, the period of ""AAAA"" is 1, and the period of ""AABBB"" is 5.Find the number of different periods over all possible strings with a letters \'A\' and b letters \'B\'." 2700
1202E "You Are Given Some Strings..." "brute force,string suffix structures,strings" "You are given a string t and n strings s1,s2,\xe2\x80\xa6,sn. All strings consist of lowercase Latin letters.Let f(t,s) be the number of occurences of string s in string t. For example, f(\xe2\x80\xb2aaabacaa\xe2\x80\xb2,\xe2\x80\xb2aa\xe2\x80\xb2)=3, and f(\xe2\x80\xb2ababa\xe2\x80\xb2,\xe2\x80\xb2aba\xe2\x80\xb2)=2.Calculate the value of n\xe2\x88\x91i=1n\xe2\x88\x91j=1f(t,si+sj), where s+t is the concatenation of strings s and t. Note that if there are two pairs i1, j1 and i2, j2 such that si1+sj1=si2+sj2, you should include both f(t,si1+sj1) and f(t,si2+sj2) in answer." 2400
1202D "Print a 1337-string..." "combinatorics,constructive algorithms,math,strings" "The subsequence is a sequence that can be derived from another sequence by deleting some elements without changing the order of the remaining elements.You are given an integer n. You have to find a sequence s consisting of digits {1,3,7} such that it has exactly n subsequences equal to 1337.For example, sequence 337133377 has 6 subsequences equal to 1337:   3371_33_3_77_ (you can remove the second and fifth characters);  3371_3_33_77_ (you can remove the third and fifth characters);  3371_3_3_377_ (you can remove the fourth and fifth characters);  3371_33_3_7_7 (you can remove the second and sixth characters);  3371_3_33_7_7 (you can remove the third and sixth characters);  3371_3_3_37_7 (you can remove the fourth and sixth characters). Note that the length of the sequence s must not exceed 105.You have to answer t independent queries." 1900
1202C "You Are Given a WASD-string..." "brute force,data structures,dp,greedy,implementation,math,strings" "You have a string s \xe2\x80\x94 a sequence of commands for your toy robot. The robot is placed in some cell of a rectangular grid. He can perform four commands:  \'W\' \xe2\x80\x94 move one cell up;  \'S\' \xe2\x80\x94 move one cell down;  \'A\' \xe2\x80\x94 move one cell left;  \'D\' \xe2\x80\x94 move one cell right. Let Grid(s) be the grid of minimum possible area such that there is a position in the grid where you can place the robot in such a way that it will not fall from the grid while running the sequence of commands s. For example, if s=DSAWWAW then Grid(s) is the 4\xc3\x973 grid:  you can place the robot in the cell (3,2);  the robot performs the command \'D\' and moves to (3,3);  the robot performs the command \'S\' and moves to (4,3);  the robot performs the command \'A\' and moves to (4,2);  the robot performs the command \'W\' and moves to (3,2);  the robot performs the command \'W\' and moves to (2,2);  the robot performs the command \'A\' and moves to (2,1);  the robot performs the command \'W\' and moves to (1,1).   You have 4 extra letters: one \'W\', one \'A\', one \'S\', one \'D\'. You\'d like to insert at most one of these letters in any position of sequence s to minimize the area of Grid(s).What is the minimum area of Grid(s) you can achieve?" 2100
1202B "You Are Given a Decimal String..." "brute force,dp,shortest paths" "Suppose you have a special x-y-counter. This counter can store some value as a decimal number; at first, the counter has value 0. The counter performs the following algorithm: it prints its lowest digit and, after that, adds either x or y to its value. So all sequences this counter generates are starting from 0. For example, a 4-2-counter can act as follows:  it prints 0, and adds 4 to its value, so the current value is 4, and the output is 0;  it prints 4, and adds 4 to its value, so the current value is 8, and the output is 04;  it prints 8, and adds 4 to its value, so the current value is 12, and the output is 048;  it prints 2, and adds 2 to its value, so the current value is 14, and the output is 0482;  it prints 4, and adds 4 to its value, so the current value is 18, and the output is 04824. This is only one of the possible outputs; for example, the same counter could generate 0246802468024 as the output, if we chose to add 2 during each step.You wrote down a printed sequence from one of such x-y-counters. But the sequence was corrupted and several elements from the sequence could be erased.Now you\'d like to recover data you\'ve lost, but you don\'t even know the type of the counter you used. You have a decimal string s \xe2\x80\x94 the remaining data of the sequence. For all 0\xe2\x89\xa4x,y<10, calculate the minimum number of digits you have to insert in the string s to make it a possible output of the x-y-counter. Note that you can\'t change the order of digits in string s or erase any of them; only insertions are allowed." 1700
1202A "You Are Given Two Binary Strings..." bitmasks,greedy "You are given two binary strings x and y, which are binary representations of some two integers (let\'s denote these integers as f(x) and f(y)). You can choose any integer k\xe2\x89\xa50, calculate the expression sk=f(x)+f(y)\xe2\x8b\x852k and write the binary representation of sk in reverse order (let\'s denote it as revk). For example, let x=1010 and y=11; you\'ve chosen k=1 and, since 21=102, so sk=10102+112\xe2\x8b\x85102=100002 and revk=00001.For given x and y, you need to choose such k that revk is lexicographically minimal (read notes if you don\'t know what does ""lexicographically"" means).It\'s guaranteed that, with given constraints, k exists and is finite." 1100
1201E2 "Knightmare (hard)" "graphs,interactive,shortest paths" "This is an interactive problem.Alice and Bob are playing a game on the chessboard of size n\xc3\x97m where n and m are even. The rows are numbered from 1 to n and the columns are numbered from 1 to m. There are two knights on the chessboard. A white one initially is on the position (x1,y1), while the black one is on the position (x2,y2). Alice will choose one of the knights to play with, and Bob will use the other one.The Alice and Bob will play in turns and whoever controls the white knight starts the game. During a turn, the player must move their knight adhering the chess rules. That is, if the knight is currently on the position (x,y), it can be moved to any of those positions (as long as they are inside the chessboard): (x+1,y+2), (x+1,y\xe2\x88\x922), (x\xe2\x88\x921,y+2), (x\xe2\x88\x921,y\xe2\x88\x922),(x+2,y+1), (x+2,y\xe2\x88\x921), (x\xe2\x88\x922,y+1), (x\xe2\x88\x922,y\xe2\x88\x921). We all know that knights are strongest in the middle of the board. Both knight have a single position they want to reach:   the owner of the white knight wins if it captures the black knight or if the white knight is at (n/2,m/2) and this position is not under attack of the black knight at this moment;  The owner of the black knight wins if it captures the white knight or if the black knight is at (n/2+1,m/2) and this position is not under attack of the white knight at this moment. Formally, the player who captures the other knight wins. The player who is at its target square ((n/2,m/2) for white, (n/2+1,m/2) for black) and this position is not under opponent\'s attack, also wins.A position is under attack of a knight if it can move into this position. Capturing a knight means that a player moves their knight to the cell where the opponent\'s knight is.If Alice made 350 moves and nobody won, the game is a draw.Alice is unsure in her chess skills, so she asks you for a help. Choose a knight and win the game for her. It can be shown, that Alice always has a winning strategy." 3000
1201E1 "Knightmare (easy)" "graphs,interactive,shortest paths" "This problem only differs from the next problem in constraints.This is an interactive problem.Alice and Bob are playing a game on the chessboard of size n\xc3\x97m where n and m are even. The rows are numbered from 1 to n and the columns are numbered from 1 to m. There are two knights on the chessboard. A white one initially is on the position (x1,y1), while the black one is on the position (x2,y2). Alice will choose one of the knights to play with, and Bob will use the other one.The Alice and Bob will play in turns and whoever controls the white knight starts the game. During a turn, the player must move their knight adhering the chess rules. That is, if the knight is currently on the position (x,y), it can be moved to any of those positions (as long as they are inside the chessboard): (x+1,y+2), (x+1,y\xe2\x88\x922), (x\xe2\x88\x921,y+2), (x\xe2\x88\x921,y\xe2\x88\x922),(x+2,y+1), (x+2,y\xe2\x88\x921), (x\xe2\x88\x922,y+1), (x\xe2\x88\x922,y\xe2\x88\x921). We all know that knights are strongest in the middle of the board. Both knight have a single position they want to reach:   the owner of the white knight wins if it captures the black knight or if the white knight is at (n/2,m/2) and this position is not under attack of the black knight at this moment;  The owner of the black knight wins if it captures the white knight or if the black knight is at (n/2+1,m/2) and this position is not under attack of the white knight at this moment. Formally, the player who captures the other knight wins. The player who is at its target square ((n/2,m/2) for white, (n/2+1,m/2) for black) and this position is not under opponent\'s attack, also wins.A position is under attack of a knight if it can move into this position. Capturing a knight means that a player moves their knight to the cell where the opponent\'s knight is.If Alice made 350 moves and nobody won, the game is a draw.Alice is unsure in her chess skills, so she asks you for a help. Choose a knight and win the game for her. It can be shown, that Alice always has a winning strategy." 2900
1201D "Treasure Hunting" "binary search,dp,greedy,implementation" "You are on the island which can be represented as a n\xc3\x97m table. The rows are numbered from 1 to n and the columns are numbered from 1 to m. There are k treasures on the island, the i-th of them is located at the position (ri,ci).Initially you stand at the lower left corner of the island, at the position (1,1). If at any moment you are at the cell with a treasure, you can pick it up without any extra time. In one move you can move up (from (r,c) to (r+1,c)), left (from (r,c) to (r,c\xe2\x88\x921)), or right (from position (r,c) to (r,c+1)). Because of the traps, you can\'t move down.However, moving up is also risky. You can move up only if you are in a safe column. There are q safe columns: b1,b2,\xe2\x80\xa6,bq. You want to collect all the treasures as fast as possible. Count the minimum number of moves required to collect all the treasures." 2100
1201C "Maximum Median" "binary search,greedy,math,sortings" "You are given an array a of n integers, where n is odd. You can make the following operation with it:  Choose one of the elements of the array (for example ai) and increase it by 1 (that is, replace it with ai+1). You want to make the median of the array the largest possible using at most k operations.The median of the odd-sized array is the middle element after the array is sorted in non-decreasing order. For example, the median of the array [1,5,2,3,5] is 3." 1400
1201B "Zero Array" greedy,math "You are given an array a1,a2,\xe2\x80\xa6,an.In one operation you can choose two elements ai and aj (i\xe2\x89\xa0j) and decrease each of them by one.You need to check whether it is possible to make all the elements equal to zero or not." 1500
1201A "Important Exam" implementation,strings "A class of students wrote a multiple-choice test.There are n students in the class. The test had m questions, each of them had 5 possible answers (A, B, C, D or E). There is exactly one correct answer for each question. The correct answer for question i worth ai points. Incorrect answers are graded with zero points.The students remember what answers they gave on the exam, but they don\'t know what are the correct answers. They are very optimistic, so they want to know what is the maximum possible total score of all students in the class." 900
1200F "Graph Traveler" "brute force,data structures,dfs and similar,dp,graphs,implementation,math,number theory" "Gildong is experimenting with an interesting machine Graph Traveler. In Graph Traveler, there is a directed graph consisting of n vertices numbered from 1 to n. The i-th vertex has mi outgoing edges that are labeled as ei[0], ei[1], \xe2\x80\xa6, ei[mi\xe2\x88\x921], each representing the destination vertex of the edge. The graph can have multiple edges and self-loops. The i-th vertex also has an integer ki written on itself.A travel on this graph works as follows.   Gildong chooses a vertex to start from, and an integer to start with. Set the variable c to this integer.  After arriving at the vertex i, or when Gildong begins the travel at some vertex i, add ki to c.  The next vertex is ei[x] where x is an integer 0\xe2\x89\xa4x\xe2\x89\xa4mi\xe2\x88\x921 satisfying x\xe2\x89\xa1c(modmi). Go to the next vertex and go back to step 2. It\'s obvious that a travel never ends, since the 2nd and the 3rd step will be repeated endlessly.For example, assume that Gildong starts at vertex 1 with c=5, and m1=2, e1[0]=1, e1[1]=2, k1=\xe2\x88\x923. Right after he starts at vertex 1, c becomes 2. Since the only integer x (0\xe2\x89\xa4x\xe2\x89\xa41) where x\xe2\x89\xa1c(modmi) is 0, Gildong goes to vertex e1[0]=1. After arriving at vertex 1 again, c becomes \xe2\x88\x921. The only integer x satisfying the conditions is 1, so he goes to vertex e1[1]=2, and so on.Since Gildong is quite inquisitive, he\'s going to ask you q queries. He wants to know how many distinct vertices will be visited infinitely many times, if he starts the travel from a certain vertex with a certain value of c. Note that you should not count the vertices that will be visited only finite times." 2300
1200E "Compress Words" "brute force,hashing,implementation,string suffix structures,strings" "Amugae has a sentence consisting of n words. He want to compress this sentence into one word. Amugae doesn\'t like repetitions, so when he merges two words into one word, he removes the longest prefix of the second word that coincides with a suffix of the first word. For example, he merges ""sample"" and ""please"" into ""samplease"".Amugae will merge his sentence left to right (i.e. first merge the first two words, then merge the result with the third word and so on). Write a program that prints the compressed word after the merging process ends." 2000
1200D "White Lines" "brute force,data structures,dp,implementation,two pointers" "Gildong has bought a famous painting software cfpaint. The working screen of cfpaint is square-shaped consisting of n rows and n columns of square cells. The rows are numbered from 1 to n, from top to bottom, and the columns are numbered from 1 to n, from left to right. The position of a cell at row r and column c is represented as (r,c). There are only two colors for the cells in cfpaint \xe2\x80\x94 black and white.There is a tool named eraser in cfpaint. The eraser has an integer size k (1\xe2\x89\xa4k\xe2\x89\xa4n). To use the eraser, Gildong needs to click on a cell (i,j) where 1\xe2\x89\xa4i,j\xe2\x89\xa4n\xe2\x88\x92k+1. When a cell (i,j) is clicked, all of the cells (i\xe2\x80\xb2,j\xe2\x80\xb2) where i\xe2\x89\xa4i\xe2\x80\xb2\xe2\x89\xa4i+k\xe2\x88\x921 and j\xe2\x89\xa4j\xe2\x80\xb2\xe2\x89\xa4j+k\xe2\x88\x921 become white. In other words, a square with side equal to k cells and top left corner at (i,j) is colored white.A white line is a row or a column without any black cells.Gildong has worked with cfpaint for some time, so some of the cells (possibly zero or all) are currently black. He wants to know the maximum number of white lines after using the eraser exactly once. Help Gildong find the answer to his question." 1900
1200C "Round Corridor" "math,number theory" "Amugae is in a very large round corridor. The corridor consists of two areas. The inner area is equally divided by n sectors, and the outer area is equally divided by m sectors. A wall exists between each pair of sectors of same area (inner or outer), but there is no wall between the inner area and the outer area. A wall always exists at the 12 o\'clock position.  The inner area\'s sectors are denoted as (1,1),(1,2),\xe2\x80\xa6,(1,n) in clockwise direction. The outer area\'s sectors are denoted as (2,1),(2,2),\xe2\x80\xa6,(2,m) in the same manner. For a clear understanding, see the example image above.Amugae wants to know if he can move from one sector to another sector. He has q questions.For each question, check if he can move between two given sectors." 1400
1200B "Block Adventure" dp,greedy "Gildong is playing a video game called Block Adventure. In Block Adventure, there are n columns of blocks in a row, and the columns are numbered from 1 to n. All blocks have equal heights. The height of the i-th column is represented as hi, which is the number of blocks stacked in the i-th column.Gildong plays the game as a character that can stand only on the top of the columns. At the beginning, the character is standing on the top of the 1-st column. The goal of the game is to move the character to the top of the n-th column.The character also has a bag that can hold infinitely many blocks. When the character is on the top of the i-th column, Gildong can take one of the following three actions as many times as he wants:   if there is at least one block on the column, remove one block from the top of the i-th column and put it in the bag;  if there is at least one block in the bag, take one block out of the bag and place it on the top of the i-th column;  if i<n and |hi\xe2\x88\x92hi+1|\xe2\x89\xa4k, move the character to the top of the i+1-st column. k is a non-negative integer given at the beginning of the game. Note that it is only possible to move to the next column. In actions of the first two types the character remains in the i-th column, and the value hi changes.The character initially has m blocks in the bag. Gildong wants to know if it is possible to win the game. Help Gildong find the answer to his question." 1200
1200A Hotelier "brute force,data structures,implementation" "Amugae has a hotel consisting of 10 rooms. The rooms are numbered from 0 to 9 from left to right.The hotel has two entrances \xe2\x80\x94 one from the left end, and another from the right end. When a customer arrives to the hotel through the left entrance, they are assigned to an empty room closest to the left entrance. Similarly, when a customer arrives at the hotel through the right entrance, they are assigned to an empty room closest to the right entrance.One day, Amugae lost the room assignment list. Thankfully Amugae\'s memory is perfect, and he remembers all of the customers: when a customer arrived, from which entrance, and when they left the hotel. Initially the hotel was empty. Write a program that recovers the room assignment list from Amugae\'s memory." 800
1199B "Water Lily" geometry,math "While sailing on a boat, Inessa noticed a beautiful water lily flower above the lake\'s surface. She came closer and it turned out that the lily was exactly H centimeters above the water surface. Inessa grabbed the flower and sailed the distance of L centimeters. Exactly at this point the flower touched the water surface.  Suppose that the lily grows at some point A on the lake bottom, and its stem is always a straight segment with one endpoint at point A. Also suppose that initially the flower was exactly above the point A, i.e. its stem was vertical. Can you determine the depth of the lake at point A?" 1000
1199A "City Day" implementation "For years, the Day of city N was held in the most rainy day of summer. New mayor decided to break this tradition and select a not-so-rainy day for the celebration. The mayor knows the weather forecast for the n days of summer. On the i-th day, ai millimeters of rain will fall. All values ai are distinct.The mayor knows that citizens will watch the weather x days before the celebration and y days after. Because of that, he says that a day d is not-so-rainy if ad is smaller than rain amounts at each of x days before day d and and each of y days after day d. In other words, ad<aj should hold for all d\xe2\x88\x92x\xe2\x89\xa4j<d and d<j\xe2\x89\xa4d+y. Citizens only watch the weather during summer, so we only consider such j that 1\xe2\x89\xa4j\xe2\x89\xa4n.Help mayor find the earliest not-so-rainy day of summer." 1000
1198F "GCD Groups 2" "greedy,number theory,probabilities" "You are given an array of n integers. You need to split all integers into two groups so that the GCD of all integers in the first group is equal to one and the GCD of all integers in the second group is equal to one.The GCD of a group of integers is the largest non-negative integer that divides all the integers in the group.Both groups have to be non-empty." 2900
1198E "Rectangle Painting 2" "flows,graph matchings,graphs" "There is a square grid of size n\xc3\x97n. Some cells are colored in black, all others are colored in white. In one operation you can select some rectangle and color all its cells in white. It costs min(h,w) to color a rectangle of size h\xc3\x97w. You are to make all cells white for minimum total cost.The square is large, so we give it to you in a compressed way. The set of black cells is the union of m rectangles." 2500
1198D "Rectangle Painting 1" dp "There is a square grid of size n\xc3\x97n. Some cells are colored in black, all others are colored in white. In one operation you can select some rectangle and color all its cells in white. It costs max(h,w) to color a rectangle of size h\xc3\x97w. You are to make all cells white for minimum total cost." 2300
1198C "Matching vs  Independent Set" "constructive algorithms,graphs,greedy,sortings" "You are given a graph with 3\xe2\x8b\x85n vertices and m edges. You are to find a matching of n edges, or an independent set of n vertices.A set of edges is called a matching if no two edges share an endpoint.A set of vertices is called an independent set if no two vertices are connected with an edge." 2000
1198B "Welfare State" "binary search,brute force,data structures,sortings" "There is a country with n citizens. The i-th of them initially has ai money. The government strictly controls the wealth of its citizens. Whenever a citizen makes a purchase or earns some money, they must send a receipt to the social services mentioning the amount of money they currently have.Sometimes the government makes payouts to the poor: all citizens who have strictly less money than x are paid accordingly so that after the payout they have exactly x money. In this case the citizens don\'t send a receipt.You know the initial wealth of every citizen and the log of all events: receipts and payouts. Restore the amount of money each citizen has after all events." 1600
1198A MP3 "sortings,two pointers" "One common way of digitalizing sound is to record sound intensity at particular time moments. For each time moment intensity is recorded as a non-negative integer. Thus we can represent a sound file as an array of n non-negative integers.If there are exactly K distinct values in the array, then we need k=\xe2\x8c\x88log2K\xe2\x8c\x89 bits to store each value. It then takes nk bits to store the whole file.To reduce the memory consumption we need to apply some compression. One common way is to reduce the number of possible intensity values. We choose two integers l\xe2\x89\xa4r, and after that all intensity values are changed in the following way: if the intensity value is within the range [l;r], we don\'t change it. If it is less than l, we change it to l; if it is greater than r, we change it to r. You can see that we lose some low and some high intensities.Your task is to apply this compression in such a way that the file fits onto a disk of size I bytes, and the number of changed elements in the array is minimal possible.We remind you that 1 byte contains 8 bits.k=\xe2\x8c\x88log2K\xe2\x8c\x89 is the smallest integer such that K\xe2\x89\xa42k. In particular, if K=1, then k=0." 1600
1197F "Coloring Game" dp,games,matrices "Alice and Bob want to play a game. They have n colored paper strips; the i-th strip is divided into ai cells numbered from 1 to ai. Each cell can have one of 3 colors.In the beginning of the game, Alice and Bob put n chips, the i-th chip is put in the ai-th cell of the i-th strip. Then they take turns, Alice is first. Each player during their turn has to choose one chip and move it 1, 2 or 3 cells backwards (i.\xe2\x80\x89e. if the current cell is x, then the chip can be moved to the cell x\xe2\x88\x921, x\xe2\x88\x922 or x\xe2\x88\x923). There are two restrictions: the chip cannot leave the borders of the strip (for example, if the current cell is 3, then you can\'t move the chip 3 cells backwards); and some moves may be prohibited because of color of the current cell (a matrix f with size 3\xc3\x973 is given, where fi,j=1 if it is possible to move the chip j cells backwards from the cell which has color i, or fi,j=0 if such move is prohibited). The player who cannot make a move loses the game.Initially some cells may be uncolored. Bob can color all uncolored cells as he wants (but he cannot leave any cell uncolored). Let\'s call a coloring good if Bob can win the game no matter how Alice acts, if the cells are colored according to this coloring. Two colorings are different if at least one cell is colored in different colors in these two colorings.Bob wants you to calculate the number of good colorings. Can you do it for him?Since the answer can be really large, you have to print it modulo 998244353." 2700
1197E "Culture Code" "binary search,combinatorics,data structures,dp,shortest paths,sortings" "There are famous Russian nesting dolls named matryoshkas sold in one of the souvenir stores nearby, and you\'d like to buy several of them. The store has n different matryoshkas. Any matryoshka is a figure of volume outi with an empty space inside of volume ini (of course, outi>ini).You don\'t have much free space inside your bag, but, fortunately, you know that matryoshkas can be nested one inside another. Formally, let\'s call a set of matryoshkas nested if we can rearrange dolls in such a way, that the first doll can be nested inside the second one, the second doll \xe2\x80\x94 inside the third one and so on. Matryoshka i can be nested inside matryoshka j if outi\xe2\x89\xa4inj. So only the last doll will take space inside your bag.Let\'s call extra space of a nested set of dolls as a total volume of empty space inside this structure. Obviously, it\'s equal to ini1+(ini2\xe2\x88\x92outi1)+(ini3\xe2\x88\x92outi2)+\xe2\x8b\xaf+(inik\xe2\x88\x92outik\xe2\x88\x921), where i1, i2, ..., ik are the indices of the chosen dolls in the order they are nested in each other.Finally, let\'s call a nested subset of the given sequence as big enough if there isn\'t any doll from the sequence that can be added to the nested subset without breaking its nested property.You want to buy many matryoshkas, so you should choose a big enough nested subset to buy it. But you will be disappointed if too much space in your bag will be wasted, so you want to choose a big enough subset so that its extra space is minimum possible among all big enough subsets. Now you wonder, how many different nested subsets meet these conditions (they are big enough, and there is no big enough subset such that its extra space is less than the extra space of the chosen subset). Two subsets are considered different if there exists at least one index i such that one of the subsets contains the i-th doll, and another subset doesn\'t.Since the answer can be large, print it modulo 109+7." 2300
1197D "Yet Another Subarray Problem" dp,greedy,math "You are given an array a1,a2,\xe2\x80\xa6,an and two integers m and k.You can choose some subarray al,al+1,\xe2\x80\xa6,ar\xe2\x88\x921,ar. The cost of subarray al,al+1,\xe2\x80\xa6,ar\xe2\x88\x921,ar is equal to r\xe2\x88\x91i=lai\xe2\x88\x92k\xe2\x8c\x88r\xe2\x88\x92l+1m\xe2\x8c\x89, where \xe2\x8c\x88x\xe2\x8c\x89 is the least integer greater than or equal to x. The cost of empty subarray is equal to zero.For example, if m=3, k=10 and a=[2,\xe2\x88\x924,15,\xe2\x88\x923,4,8,3], then the cost of some subarrays are:  a3\xe2\x80\xa6a3:15\xe2\x88\x92k\xe2\x8c\x8813\xe2\x8c\x89=15\xe2\x88\x9210=5;  a3\xe2\x80\xa6a4:(15\xe2\x88\x923)\xe2\x88\x92k\xe2\x8c\x8823\xe2\x8c\x89=12\xe2\x88\x9210=2;  a3\xe2\x80\xa6a5:(15\xe2\x88\x923+4)\xe2\x88\x92k\xe2\x8c\x8833\xe2\x8c\x89=16\xe2\x88\x9210=6;  a3\xe2\x80\xa6a6:(15\xe2\x88\x923+4+8)\xe2\x88\x92k\xe2\x8c\x8843\xe2\x8c\x89=24\xe2\x88\x9220=4;  a3\xe2\x80\xa6a7:(15\xe2\x88\x923+4+8+3)\xe2\x88\x92k\xe2\x8c\x8853\xe2\x8c\x89=27\xe2\x88\x9220=7. Your task is to find the maximum cost of some subarray (possibly empty) of array a." 1900
1197C "Array Splitting" greedy,sortings "You are given a sorted array a1,a2,\xe2\x80\xa6,an (for each index i>1 condition ai\xe2\x89\xa5ai\xe2\x88\x921 holds) and an integer k.You are asked to divide this array into k non-empty consecutive subarrays. Every element in the array should be included in exactly one subarray. Let max(i) be equal to the maximum in the i-th subarray, and min(i) be equal to the minimum in the i-th subarray. The cost of division is equal to k\xe2\x88\x91i=1(max(i)\xe2\x88\x92min(i)). For example, if a=[2,4,5,5,8,11,19] and we divide it into 3 subarrays in the following way: [2,4],[5,5],[8,11,19], then the cost of division is equal to (4\xe2\x88\x922)+(5\xe2\x88\x925)+(19\xe2\x88\x928)=13.Calculate the minimum cost you can obtain by dividing the array a into k non-empty consecutive subarrays." 1400
1197B Pillars greedy,implementation "There are n pillars aligned in a row and numbered from 1 to n.Initially each pillar contains exactly one disk. The i-th pillar contains a disk having radius ai.You can move these disks from one pillar to another. You can take a disk from pillar i and place it on top of pillar j if all these conditions are met:  there is no other pillar between pillars i and j. Formally, it means that |i\xe2\x88\x92j|=1;  pillar i contains exactly one disk;  either pillar j contains no disks, or the topmost disk on pillar j has radius strictly greater than the radius of the disk you move. When you place a disk on a pillar that already has some disks on it, you put the new disk on top of previously placed disks, so the new disk will be used to check the third condition if you try to place another disk on the same pillar.You may take any disk and place it on other pillar any number of times, provided that every time you do it, all three aforementioned conditions are met. Now you wonder, is it possible to place all n disks on the same pillar simultaneously?" 1000
1197A "DIY Wooden Ladder" greedy,math,sortings "Let\'s denote a k-step ladder as the following structure: exactly k+2 wooden planks, of which  two planks of length at least k+1 \xe2\x80\x94 the base of the ladder;  k planks of length at least 1 \xe2\x80\x94 the steps of the ladder; Note that neither the base planks, nor the steps planks are required to be equal.For example, ladders 1 and 3 are correct 2-step ladders and ladder 2 is a correct 1-step ladder. On the first picture the lengths of planks are [3,3] for the base and [1] for the step. On the second picture lengths are [3,3] for the base and [2] for the step. On the third picture lengths are [3,4] for the base and [2,3] for the steps.   You have n planks. The length of the i-th planks is ai. You don\'t have a saw, so you can\'t cut the planks you have. Though you have a hammer and nails, so you can assemble the improvised ""ladder"" from the planks.The question is: what is the maximum number k such that you can choose some subset of the given planks and assemble a k-step ladder using them?" 900
1196F "K-th Path" "brute force,constructive algorithms,shortest paths,sortings" "You are given a connected undirected weighted graph consisting of n vertices and m edges.You need to print the k-th smallest shortest path in this graph (paths from the vertex to itself are not counted, paths from i to j and from j to i are counted as one).More formally, if d is the matrix of shortest paths, where di,j is the length of the shortest path between vertices i and j (1\xe2\x89\xa4i<j\xe2\x89\xa4n), then you need to print the k-th element in the sorted array consisting of all di,j, where 1\xe2\x89\xa4i<j\xe2\x89\xa4n." 2200
1196E "Connected Component on a Chessboard" "constructive algorithms,implementation" "You are given two integers b and w. You have a chessboard of size 109\xc3\x97109 with the top left cell at (1;1), the cell (1;1) is painted white.Your task is to find a connected component on this chessboard that contains exactly b black cells and exactly w white cells. Two cells are called connected if they share a side (i.e. for the cell (x,y) there are at most four connected cells: (x\xe2\x88\x921,y),(x+1,y),(x,y\xe2\x88\x921),(x,y+1)). A set of cells is called a connected component if for every pair of cells C1 and C2 from this set, there exists a sequence of cells c1, c2, ..., ck such that c1=C1, ck=C2, all ci from 1 to k are belong to this set of cells and for every i\xe2\x88\x88[1,k\xe2\x88\x921], cells ci and ci+1 are connected.Obviously, it can be impossible to find such component. In this case print ""NO"". Otherwise, print ""YES"" and any suitable connected component.You have to answer q independent queries." 1800
1196D2 "RGB Substring (hard version)" "data structures,dp,implementation,two pointers" "The only difference between easy and hard versions is the size of the input.You are given a string s consisting of n characters, each character is \'R\', \'G\' or \'B\'.You are also given an integer k. Your task is to change the minimum number of characters in the initial string s so that after the changes there will be a string of length k that is a substring of s, and is also a substring of the infinite string ""RGBRGBRGB ..."".A string a is a substring of string b if there exists a positive integer i such that a1=bi, a2=bi+1, a3=bi+2, ..., a|a|=bi+|a|\xe2\x88\x921. For example, strings ""GBRG"", ""B"", ""BR"" are substrings of the infinite string ""RGBRGBRGB ..."" while ""GR"", ""RGR"" and ""GGG"" are not.You have to answer q independent queries." 1600
1196D1 "RGB Substring (easy version)" implementation "The only difference between easy and hard versions is the size of the input.You are given a string s consisting of n characters, each character is \'R\', \'G\' or \'B\'.You are also given an integer k. Your task is to change the minimum number of characters in the initial string s so that after the changes there will be a string of length k that is a substring of s, and is also a substring of the infinite string ""RGBRGBRGB ..."".A string a is a substring of string b if there exists a positive integer i such that a1=bi, a2=bi+1, a3=bi+2, ..., a|a|=bi+|a|\xe2\x88\x921. For example, strings ""GBRG"", ""B"", ""BR"" are substrings of the infinite string ""RGBRGBRGB ..."" while ""GR"", ""RGR"" and ""GGG"" are not.You have to answer q independent queries." 1500
1196C "Robot Breakout" implementation "n robots have escaped from your laboratory! You have to find them as soon as possible, because these robots are experimental, and their behavior is not tested yet, so they may be really dangerous!Fortunately, even though your robots have escaped, you still have some control over them. First of all, you know the location of each robot: the world you live in can be modeled as an infinite coordinate plane, and the i-th robot is currently located at the point having coordinates (xi, yi). Furthermore, you may send exactly one command to all of the robots. The command should contain two integer numbers X and Y, and when each robot receives this command, it starts moving towards the point having coordinates (X, Y). The robot stops its movement in two cases:  either it reaches (X, Y);  or it cannot get any closer to (X, Y). Normally, all robots should be able to get from any point of the coordinate plane to any other point. Each robot usually can perform four actions to move. Let\'s denote the current coordinates of the robot as (xc, yc). Then the movement system allows it to move to any of the four adjacent points:  the first action allows it to move from (xc, yc) to (xc\xe2\x88\x921, yc);  the second action allows it to move from (xc, yc) to (xc, yc+1);  the third action allows it to move from (xc, yc) to (xc+1, yc);  the fourth action allows it to move from (xc, yc) to (xc, yc\xe2\x88\x921). Unfortunately, it seems that some movement systems of some robots are malfunctioning. For each robot you know which actions it can perform, and which it cannot perform.You want to send a command so all robots gather at the same point. To do so, you have to choose a pair of integer numbers X and Y so that each robot can reach the point (X, Y). Is it possible to find such a point?" 1500
1196B "Odd Sum Segments" "constructive algorithms,math" "You are given an array a consisting of n integers a1,a2,\xe2\x80\xa6,an. You want to split it into exactly k non-empty non-intersecting subsegments such that each subsegment has odd sum (i.\xe2\x80\x89e. for each subsegment, the sum of all elements that belong to this subsegment is odd). It is impossible to rearrange (shuffle) the elements of a given array. Each of the n elements of the array a must belong to exactly one of the k subsegments.Let\'s see some examples of dividing the array of length 5 into 3 subsegments (not necessarily with odd sums): [1,2,3,4,5] is the initial array, then all possible ways to divide it into 3 non-empty non-intersecting subsegments are described below:  [1],[2],[3,4,5];  [1],[2,3],[4,5];  [1],[2,3,4],[5];  [1,2],[3],[4,5];  [1,2],[3,4],[5];  [1,2,3],[4],[5]. Of course, it can be impossible to divide the initial array into exactly k subsegments in such a way that each of them will have odd sum of elements. In this case print ""NO"". Otherwise, print ""YES"" and any possible division of the array. See the output format for the detailed explanation.You have to answer q independent queries." 1200
1196A "Three Piles of Candies" "brute force,constructive algorithms,math" "Alice and Bob have received three big piles of candies as a gift. Now they want to divide these candies as fair as possible. To do this, Alice takes one pile of candies, then Bob takes one of the other two piles. The last pile is split between Alice and Bob as they want: for example, it is possible that Alice takes the whole pile, and Bob gets nothing from it.After taking the candies from the piles, if Alice has more candies than Bob, she discards some candies so that the number of candies she has is equal to the number of candies Bob has. Of course, Bob does the same if he has more candies.Alice and Bob want to have as many candies as possible, and they plan the process of dividing candies accordingly. Please calculate the maximum number of candies Alice can have after this division process (of course, Bob will have the same number of candies).You have to answer q independent queries.Let\'s see the following example: [1,3,4]. Then Alice can choose the third pile, Bob can take the second pile, and then the only candy from the first pile goes to BobÂ \xe2\x80\x94 then Alice has 4 candies, and Bob has 4 candies.Another example is [1,10,100]. Then Alice can choose the second pile, Bob can choose the first pile, and candies from the third pile can be divided in such a way that Bob takes 54 candies, and Alice takes 46 candies. Now Bob has 55 candies, and Alice has 56 candies, so she has to discard one candyÂ \xe2\x80\x94 and after that, she has 55 candies too." 800
1195F "Geometers Anonymous Club" "data structures,geometry,math,sortings" "Denis holds a Geometers Anonymous Club meeting in SIS. He has prepared n convex polygons numbered from 1 to n for the club. He plans to offer members of the club to calculate Minkowski sums of these polygons. More precisely, he plans to give q tasks, the i-th of them asks to calculate the sum of Minkowski of polygons with indices from li to ri inclusive.The sum of Minkowski of two sets A and B is the set C={a+b:a\xe2\x88\x88A,b\xe2\x88\x88B}. It can be proven that if A and B are convex polygons then C will also be a convex polygon.   Sum of two convex polygons To calculate the sum of Minkowski of p polygons (p>2), you need to calculate the sum of Minkowski of the first p\xe2\x88\x921 polygons, and then calculate the sum of Minkowski of the resulting polygon and the p-th polygon.For the convenience of checking answers, Denis has decided to prepare and calculate the number of vertices in the sum of Minkowski for each task he prepared. Help him to do it." 2500
1195E OpenStreetMap "data structures,two pointers" "Seryozha conducts a course dedicated to building a map of heights of Stepanovo recreation center. He laid a rectangle grid of size n\xc3\x97m cells on a map (rows of grid are numbered from 1 to n from north to south, and columns are numbered from 1 to m from west to east). After that he measured the average height of each cell above Rybinsk sea level and obtained a matrix of heights of size n\xc3\x97m. The cell (i,j) lies on the intersection of the i-th row and the j-th column and has height hi,j. Seryozha is going to look at the result of his work in the browser. The screen of Seryozha\'s laptop can fit a subrectangle of size a\xc3\x97b of matrix of heights (1\xe2\x89\xa4a\xe2\x89\xa4n, 1\xe2\x89\xa4b\xe2\x89\xa4m). Seryozha tries to decide how the weather can affect the recreation center \xe2\x80\x94 for example, if it rains, where all the rainwater will gather. To do so, he is going to find the cell having minimum height among all cells that are shown on the screen of his laptop.Help Seryozha to calculate the sum of heights of such cells for all possible subrectangles he can see on his screen. In other words, you have to calculate the sum of minimum heights in submatrices of size a\xc3\x97b with top left corners in (i,j) over all 1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x92a+1 and 1\xe2\x89\xa4j\xe2\x89\xa4m\xe2\x88\x92b+1.Consider the sequence gi=(gi\xe2\x88\x921\xe2\x8b\x85x+y)modz. You are given integers g0, x, y and z. By miraculous coincidence, hi,j=g(i\xe2\x88\x921)\xe2\x8b\x85m+j\xe2\x88\x921 ((i\xe2\x88\x921)\xe2\x8b\x85m+j\xe2\x88\x921 is the index)." 2100
1195D2 "Submarine in the Rybinsk Sea (hard edition)" "combinatorics,math,number theory" "This problem differs from the previous one only in the absence of the constraint on the equal length of all numbers a1,a2,\xe2\x80\xa6,an.A team of SIS students is going to make a trip on a submarine. Their target is an ancient treasure in a sunken ship lying on the bottom of the Great Rybinsk sea. Unfortunately, the students don\'t know the coordinates of the ship, so they asked Meshanya (who is a hereditary mage) to help them. He agreed to help them, but only if they solve his problem.Let\'s denote a function that alternates digits of two numbers f(a1a2\xe2\x80\xa6ap\xe2\x88\x921ap,b1b2\xe2\x80\xa6bq\xe2\x88\x921bq), where a1\xe2\x80\xa6ap and b1\xe2\x80\xa6bq are digits of two integers written in the decimal notation without leading zeros.In other words, the function f(x,y) alternately shuffles the digits of the numbers x and y by writing them from the lowest digits to the older ones, starting with the number y. The result of the function is also built from right to left (that is, from the lower digits to the older ones). If the digits of one of the arguments have ended, then the remaining digits of the other argument are written out. Familiarize with examples and formal definitions of the function below.For example: f(1111,2222)=12121212 f(7777,888)=7787878 f(33,44444)=4443434 f(555,6)=5556 f(111,2222)=2121212Formally,  if p\xe2\x89\xa5q then f(a1\xe2\x80\xa6ap,b1\xe2\x80\xa6bq)=a1a2\xe2\x80\xa6ap\xe2\x88\x92q+1b1ap\xe2\x88\x92q+2b2\xe2\x80\xa6ap\xe2\x88\x921bq\xe2\x88\x921apbq;  if p<q then f(a1\xe2\x80\xa6ap,b1\xe2\x80\xa6bq)=b1b2\xe2\x80\xa6bq\xe2\x88\x92pa1bq\xe2\x88\x92p+1a2\xe2\x80\xa6ap\xe2\x88\x921bq\xe2\x88\x921apbq. Mishanya gives you an array consisting of n integers ai, your task is to help students to calculate \xe2\x88\x91ni=1\xe2\x88\x91nj=1f(ai,aj) modulo 998244353." 1800
1195D1 "Submarine in the Rybinsk Sea (easy edition)" "combinatorics,math,number theory" "This problem differs from the next one only in the presence of the constraint on the equal length of all numbers a1,a2,\xe2\x80\xa6,an. Actually, this problem is a subtask of the problem D2 from the same contest and the solution of D2 solves this subtask too.A team of SIS students is going to make a trip on a submarine. Their target is an ancient treasure in a sunken ship lying on the bottom of the Great Rybinsk sea. Unfortunately, the students don\'t know the coordinates of the ship, so they asked Meshanya (who is a hereditary mage) to help them. He agreed to help them, but only if they solve his problem.Let\'s denote a function that alternates digits of two numbers f(a1a2\xe2\x80\xa6ap\xe2\x88\x921ap,b1b2\xe2\x80\xa6bq\xe2\x88\x921bq), where a1\xe2\x80\xa6ap and b1\xe2\x80\xa6bq are digits of two integers written in the decimal notation without leading zeros.In other words, the function f(x,y) alternately shuffles the digits of the numbers x and y by writing them from the lowest digits to the older ones, starting with the number y. The result of the function is also built from right to left (that is, from the lower digits to the older ones). If the digits of one of the arguments have ended, then the remaining digits of the other argument are written out. Familiarize with examples and formal definitions of the function below.For example: f(1111,2222)=12121212 f(7777,888)=7787878 f(33,44444)=4443434 f(555,6)=5556 f(111,2222)=2121212Formally,  if p\xe2\x89\xa5q then f(a1\xe2\x80\xa6ap,b1\xe2\x80\xa6bq)=a1a2\xe2\x80\xa6ap\xe2\x88\x92q+1b1ap\xe2\x88\x92q+2b2\xe2\x80\xa6ap\xe2\x88\x921bq\xe2\x88\x921apbq;  if p<q then f(a1\xe2\x80\xa6ap,b1\xe2\x80\xa6bq)=b1b2\xe2\x80\xa6bq\xe2\x88\x92pa1bq\xe2\x88\x92p+1a2\xe2\x80\xa6ap\xe2\x88\x921bq\xe2\x88\x921apbq. Mishanya gives you an array consisting of n integers ai. All numbers in this array are of equal length (that is, they consist of the same number of digits). Your task is to help students to calculate \xe2\x88\x91ni=1\xe2\x88\x91nj=1f(ai,aj) modulo 998244353." 1500
1195C "Basketball Exercise" dp "Finally, a basketball court has been opened in SIS, so Demid has decided to hold a basketball exercise session. 2\xe2\x8b\x85n students have come to Demid\'s exercise session, and he lined up them into two rows of the same size (there are exactly n people in each row). Students are numbered from 1 to n in each row in order from left to right.  Now Demid wants to choose a team to play basketball. He will choose players from left to right, and the index of each chosen player (excluding the first one taken) will be strictly greater than the index of the previously chosen player. To avoid giving preference to one of the rows, Demid chooses students in such a way that no consecutive chosen students belong to the same row. The first student can be chosen among all 2n students (there are no additional constraints), and a team can consist of any number of students. Demid thinks, that in order to compose a perfect team, he should choose students in such a way, that the total height of all chosen students is maximum possible. Help Demid to find the maximum possible total height of players in a team he can choose." 1400
1195B "Sport Mafia" "binary search,brute force,math" "Each evening after the dinner the SIS\'s students gather together to play the game of Sport Mafia. For the tournament, Alya puts candies into the box, which will serve as a prize for a winner. To do that, she performs n actions. The first action performed is to put a single candy into the box. For each of the remaining moves she can choose from two options:  the first option, in case the box contains at least one candy, is to take exactly one candy out and eat it. This way the number of candies in the box decreased by 1;  the second option is to put candies in the box. In this case, Alya will put 1 more candy, than she put in the previous time. Thus, if the box is empty, then it can only use the second option.For example, one possible sequence of Alya\'s actions look as follows:  put one candy into the box;  put two candies into the box;  eat one candy from the box;  eat one candy from the box;  put three candies into the box;  eat one candy from the box;  put four candies into the box;  eat one candy from the box;  put five candies into the box; This way she will perform 9 actions, the number of candies at the end will be 11, while Alya will eat 4 candies in total.You know the total number of actions n and the number of candies at the end k. You need to find the total number of sweets Alya ate. That is the number of moves of the first option. It\'s guaranteed, that for the given n and k the answer always exists.Please note, that during an action of the first option, Alya takes out and eats exactly one candy." 1000
1195A "Drinks Choosing" greedy,math "Old timers of Summer Informatics School can remember previous camps in which each student was given a drink of his choice on the vechorka (late-evening meal). Or may be the story was more complicated?There are n students living in a building, and for each of them the favorite drink ai is known. So you know n integers a1,a2,\xe2\x80\xa6,an, where ai (1\xe2\x89\xa4ai\xe2\x89\xa4k) is the type of the favorite drink of the i-th student. The drink types are numbered from 1 to k.There are infinite number of drink sets. Each set consists of exactly two portions of the same drink. In other words, there are k types of drink sets, the j-th type contains two portions of the drink j. The available number of sets of each of the k types is infinite.You know that students will receive the minimum possible number of sets to give all students exactly one drink. Obviously, the number of sets will be exactly \xe2\x8c\x88n2\xe2\x8c\x89, where \xe2\x8c\x88x\xe2\x8c\x89 is x rounded up.After students receive the sets, they will distribute their portions by their choice: each student will get exactly one portion. Note, that if n is odd then one portion will remain unused and the students\' teacher will drink it.What is the maximum number of students that can get their favorite drink if \xe2\x8c\x88n2\xe2\x8c\x89 sets will be chosen optimally and students will distribute portions between themselves optimally?" 1000
1194G "Another Meme Problem" dp "Let\'s call a fraction xy good if there exists at least one another fraction x\xe2\x80\xb2y\xe2\x80\xb2 such that xy=x\xe2\x80\xb2y\xe2\x80\xb2, 1\xe2\x89\xa4x\xe2\x80\xb2,y\xe2\x80\xb2\xe2\x89\xa49, the digit denoting x\xe2\x80\xb2 is contained in the decimal representation of x, and the digit denoting y\xe2\x80\xb2 is contained in the decimal representation of y. For example, 2613 is a good fraction, because 2613=21.You are given an integer number n. Please calculate the number of good fractions xy such that 1\xe2\x89\xa4x\xe2\x89\xa4n and 1\xe2\x89\xa4y\xe2\x89\xa4n. The answer may be really large, so print it modulo 998244353." 2700
1194F "Crossword Expert" "combinatorics,dp,number theory,probabilities,two pointers" "Today Adilbek is taking his probability theory test. Unfortunately, when Adilbek arrived at the university, there had already been a long queue of students wanting to take the same test. Adilbek has estimated that he will be able to start the test only T seconds after coming. Fortunately, Adilbek can spend time without revising any boring theorems or formulas. He has an app on this smartphone which contains n Japanese crosswords to solve. Adilbek has decided to solve them all one by one in the order they are listed in the app, without skipping any crossword. For each crossword, a number ti is given that represents the time it takes an average crossword expert to solve this crossword (the time is given in seconds).Adilbek is a true crossword expert, but, unfortunately, he is sometimes unlucky in choosing the way to solve the crossword. So, it takes him either ti seconds or ti+1 seconds to solve the i-th crossword, equiprobably (with probability 12 he solves the crossword in exactly ti seconds, and with probability 12 he has to spend an additional second to finish the crossword). All these events are independent.After T seconds pass (or after solving the last crossword, if he manages to do it in less than T seconds), Adilbek closes the app (if he finishes some crossword at the same moment, that crossword is considered solved; otherwise Adilbek does not finish solving the current crossword at all). He thinks it would be an interesting probability theory problem to calculate E \xe2\x80\x94 the expected number of crosswords he will be able to solve completely. Can you calculate it? Recall that the expected value of a discrete random variable is the probability-weighted average of all possible values \xe2\x80\x94 in this problem it means that the expected value of the number of solved crosswords can be calculated as E=n\xe2\x88\x91i=0ipi, where pi is the probability that Adilbek will solve exactly i crosswords. We can represent E as rational fraction PQ with Q>0. To give the answer, you should print P\xe2\x8b\x85Q\xe2\x88\x921mod(109+7)." 2400
1194E "Count The Rectangles" "bitmasks,brute force,data structures,geometry,sortings" "There are n segments drawn on a plane; the i-th segment connects two points (xi,1, yi,1) and (xi,2, yi,2). Each segment is non-degenerate, and is either horizontal or vertical \xe2\x80\x94 formally, for every i\xe2\x88\x88[1,n] either xi,1=xi,2 or yi,1=yi,2 (but only one of these conditions holds). Only segments of different types may intersect: no pair of horizontal segments shares any common points, and no pair of vertical segments shares any common points.We say that four segments having indices h1, h2, v1 and v2 such that h1<h2 and v1<v2 form a rectangle if the following conditions hold:  segments h1 and h2 are horizontal;  segments v1 and v2 are vertical;  segment h1 intersects with segment v1;  segment h2 intersects with segment v1;  segment h1 intersects with segment v2;  segment h2 intersects with segment v2. Please calculate the number of ways to choose four segments so they form a rectangle. Note that the conditions h1<h2 and v1<v2 should hold." 2200
1194D "1-2-K Game" games,math "Alice and Bob play a game. There is a paper strip which is divided into n\xe2\x80\x89+\xe2\x80\x891 cells numbered from left to right starting from 0. There is a chip placed in the n-th cell (the last one).Players take turns, Alice is first. Each player during his or her turn has to move the chip 1, 2 or k cells to the left (so, if the chip is currently in the cell i, the player can move it into cell i\xe2\x80\x89-\xe2\x80\x891, i\xe2\x80\x89-\xe2\x80\x892 or i\xe2\x80\x89-\xe2\x80\x89k). The chip should not leave the borders of the paper strip: it is impossible, for example, to move it k cells to the left if the current cell has number i\xe2\x80\x89<\xe2\x80\x89k. The player who can\'t make a move loses the game.Who wins if both participants play optimally?Alice and Bob would like to play several games, so you should determine the winner in each game." 1700
1194C "From S To T" implementation,strings "You are given three strings s, t and p consisting of lowercase Latin letters. You may perform any number (possibly, zero) operations on these strings.During each operation you choose any character from p, erase it from p and insert it into string s (you may insert this character anywhere you want: in the beginning of s, in the end or between any two consecutive characters). For example, if p is aba, and s is de, then the following outcomes are possible (the character we erase from p and insert into s is highlighted):  aba \xe2\x86\x92 ba, de \xe2\x86\x92 ade;  aba \xe2\x86\x92 ba, de \xe2\x86\x92 dae;  aba \xe2\x86\x92 ba, de \xe2\x86\x92 dea;  aba \xe2\x86\x92 aa, de \xe2\x86\x92 bde;  aba \xe2\x86\x92 aa, de \xe2\x86\x92 dbe;  aba \xe2\x86\x92 aa, de \xe2\x86\x92 deb;  aba \xe2\x86\x92 ab, de \xe2\x86\x92 ade;  aba \xe2\x86\x92 ab, de \xe2\x86\x92 dae;  aba \xe2\x86\x92 ab, de \xe2\x86\x92 dea; Your goal is to perform several (maybe zero) operations so that s becomes equal to t. Please determine whether it is possible.Note that you have to answer q independent queries." 1300
1194B "Yet Another Crosses Problem" implementation "You are given a picture consisting of n rows and m columns. Rows are numbered from 1 to n from the top to the bottom, columns are numbered from 1 to m from the left to the right. Each cell is painted either black or white. You think that this picture is not interesting enough. You consider a picture to be interesting if there is at least one cross in it. A cross is represented by a pair of numbers x and y, where 1\xe2\x89\xa4x\xe2\x89\xa4n and 1\xe2\x89\xa4y\xe2\x89\xa4m, such that all cells in row x and all cells in column y are painted black.For examples, each of these pictures contain crosses:  The fourth picture contains 4 crosses: at (1,3), (1,5), (3,3) and (3,5).Following images don\'t contain crosses:  You have a brush and a can of black paint, so you can make this picture interesting. Each minute you may choose a white cell and paint it black.What is the minimum number of minutes you have to spend so the resulting picture contains at least one cross?You are also asked to answer multiple independent queries." 1300
1194A "Remove a Progression" math "You have a list of numbers from 11 to nn written from left to right on the blackboard.You perform an algorithm consisting of several steps (steps are 11-indexed). On the ii-th step you wipe the ii-th number (considering only remaining numbers). You wipe the whole number (not one digit).  When there are less than ii numbers remaining, you stop your algorithm. Now you wonder: what is the value of the xx-th remaining number after the algorithm is stopped?" 800
1193C "Scissors and Tape" "*special problem,constructive algorithms,geometry" "You are given a piece of paper in the shape of a simple polygon S. Your task is to turn it into a simple polygon T that has the same area as S.You can use two tools: scissors and tape. Scissors can be used to cut any polygon into smaller polygonal pieces. Tape can be used to combine smaller pieces into larger polygons. You can use each tool multiple times, in any order. The polygons given in the input have integer coordinates, but you are allowed to produce shapes with non-integer coordinates in your output.A formal definition of the task follows.A shape Q=(Q0,\xe2\x80\xa6,Qn\xe2\x88\x921) is a sequence of three or more points in the plane such that:   The closed polyline Q0Q1Q2\xe2\x80\xa6Qn\xe2\x88\x921Q0 never touches or intersects itself, and therefore it forms the boundary of a simple polygon.  The polyline goes around the boundary of the polygon in the counter-clockwise direction. The polygon whose boundary is the shape Q will be denoted P(Q).Two shapes are called equivalent if one can be translated and/or rotated to become identical with the other.Note that mirroring a shape is not allowed. Also note that the order of points matters: the shape (Q1,\xe2\x80\xa6,Qn\xe2\x88\x921,Q0) is not necessarily equivalent to the shape (Q0,\xe2\x80\xa6,Qn\xe2\x88\x921).In the figure on the left: Shapes U and V are equivalent. Shape W is not equivalent with them because the points of W are given in a different order. Regardless of the order of points, the fourth shape is not equivalent with the previous ones either as flipping a shape is not allowed.In both input and output, a shape with n points is represented as a single line that contains 2n+1 space-separated numbers: the number n followed by the coordinates of the points: Q0,x, Q0,y, Q1,x, ...Shapes have identification numbers (IDs). The given shape S has ID 0, the shapes you produce in your solutions are given IDs 1, 2, 3, ..., in the order in which they are produced.Shapes B1,\xe2\x80\xa6,Bk form a subdivision of shape A if:   The union of all P(Bi) is exactly P(A).  For each i\xe2\x89\xa0j, the area of the intersection of P(Bi) and P(Bj) is zero. The scissors operation destroys one existing shape A and produces one or more shapes B1,\xe2\x80\xa6,Bk that form a subdivision of A.In the figure: Shape A (square) subdivided into shapes B1, B2, B3 (the three triangles). One valid way to describe one of the Bi is ""3 3 1 6 1 5.1 4"".The tape operation destroys one or more existing shapes A1,\xe2\x80\xa6,Ak and produces one new shape B. In order to perform this operation, you must first specify shapes C1,\xe2\x80\xa6,Ck and only then the final shape B. These shapes must satisfy the following:   For each i, the shape Ci is equivalent to the shape Ai.  The shapes C1,\xe2\x80\xa6,Ck form a subdivision of the shape B. Informally, you choose the shape B and show how to move each of the existing Ai to its correct location Ci within B. Note that only the shape B gets a new ID, the shapes Ci do not." -999
1193B "Magic Tree" "*special problem,data structures,dp,trees" "We have a magic tree: a rooted tree on n vertices. The vertices are numbered 1 through n. Vertex 1 is the root.The magic tree gives us magic fruit. The fruit only grows in vertices of the tree other than the root. Each vertex contains at most one piece of fruit.It is now day 0 and no fruit is ripe yet. Each fruit will only be ripe for a single day. For each fruit, we are given the vertex vj where it grows, the day dj on which it will be ripe, and the amount wj of magic juice we can extract from it if we harvest it when it is ripe.The fruits have to be harvested by cutting some branches of the tree. On each day, you may cut as many branches of the tree as you like. The parts of the tree you cut off will fall to the ground and you can collect all the ripe fruits they contain. All fruits that fall to the ground when they are not ripe are discarded and no magic juice is collected from them.Formally, on each day, you may erase some edges of the tree. Whenever you do so, the tree will split into multiple connected components. You then erase all components that do not contain the root and you harvest all ripe fruits those components contained.Given is a description of the tree together with the locations, ripening days and juiciness of all m fruits. Calculate the maximum total amount of magic juice we can harvest from the tree." -999
1193A "Amusement Park" "*special problem,dp,math" "You have been hired to supervise the project of a new amusement park. The park will have a special gimmick: directed slides that can get customers from one attraction to another quickly and in an entertaining way.The park owner has given you the current project: a list of planned attractions and a list of slides that should be built between them. However, him being a businessman, he casually envisioned the impossible: among other things, he projected a slide coming from the Haunted Castle to the Roller Coaster, another from the Roller Coaster to the Drop Tower, and a third from the Drop Tower to the Haunted Castle. As the slides can only go downhill, it is evident why this is a problem. You don\'t have the luxury of ignoring the laws of physics when building the park, so you have to request changes in the project. Maybe he would accept reversing the slide between the Drop Tower and the Haunted Castle?Formally:   The project is a list of attractions and a list of directed slides. Each slide starts at one attraction and ends at another attraction.  A proposal is obtained from the project by reversing the directions of some slides (possibly none or all of them).  A proposal is legal if there is a way to assign an elevation to each attraction in such a way that every slide goes downhill.  The cost of a proposal is the number of slides whose directions were reversed. For a given project, find and report the sum of costs all legal proposals. Since this number may be large, output it modulo 998,244,353." -999
1192C Cubeword "*special problem,brute force,dp,meet-in-the-middle" "A cubeword is a special type of a crossword. When building a cubeword, you start by choosing a positive integer a: the side length of the cube. Then, you build a big cube consisting of a\xc3\x97a\xc3\x97a unit cubes. This big cube has 12 edges. Then, you discard all unit cubes that do not touch the edges of the big cube. The figure below shows the object you will get for a=6.  Finally, you assign a letter to each of the unit cubes in the object. You must get a meaningful word along each edge of the big cube. Each edge can be read in either direction, and it is sufficient if one of the two directions of reading gives a meaningful word.The figure below shows the object for a=6 in which some unit cubes already have assigned letters. You can already read the words \'SUBMIT\', \'ACCEPT\' and \'TURING\' along three edges of the big cube.  You are given a list of valid words. Each word from the wordlist may appear on arbitrarily many edges of a valid cubeword. Find and report the number of different cubewords that can be constructed, modulo 998,244,353.If one cubeword can be obtained from another by rotation or mirroring, they are considered distinct." -999
1192B "Dynamic Diameter" "*special problem,data structures,dfs and similar,divide and conquer,trees" "You are given a weighted undirected tree on n vertices and a list of q updates. Each update changes the weight of one edge. The task is to output the diameter of the tree after each update.(The distance between two vertices is the sum of the weights on the unique simple path that connects them. The diameter is the largest of all those distances.)" -999
1192A "Building Skyscrapers" "*special problem" "We are going to build a new city: the Metropolis. The city is going to be built on an infinite square grid. The finished city will consist of n skyscrapers, each occupying a different cell of the grid. At any moment during the construction, the cells that currently do not contain a skyscraper are called empty.You are given the planned coordinates of the n skyscrapers. Your task is to find an order in which they can be built while satisfying the rules listed below.  The building crew has only one crane, so the Metropolis has to be constructed one skyscraper at a time.  The first skyscraper can be built anywhere on the grid.  Each subsequent skyscraper has to share a side or a corner with at least one of the previously built skyscrapers (so that it\'s easier to align the new skyscraper to the grid properly).  When building a skyscraper, there has to be a way to deliver material to the construction site from the outside of Metropolis by only moving it through empty cells that share a side. In other words, there should be a path of side-adjacent empty cells that connects the cell that will contain the skyscraper to some cell (r,c) with |r|>109 and/or |c|>109. If a solution exists, let\'s denote the numbers of skyscrapers in the order in which they should be built by s1,\xe2\x80\xa6,sn. There are two types of subtasks:Type 1: You may produce any valid order.Type 2: You must find the order that maximizes sn. Among those, you must find the one that maximizes sn\xe2\x88\x921. And so on. In other words, you must find the valid order of building for which the sequence (sn,sn\xe2\x88\x921,\xe2\x80\xa6,s1) is lexicographically largest." -999
1191B "Tokitsukaze and Mahjong" "brute force,implementation" "Tokitsukaze is playing a game derivated from Japanese mahjong. In this game, she has three tiles in her hand. Each tile she owns is a suited tile, which means it has a suit (manzu, pinzu or souzu) and a number (a digit ranged from 1 to 9). In this problem, we use one digit and one lowercase letter, which is the first character of the suit, to represent a suited tile. All possible suited tiles are represented as 1m, 2m, \xe2\x80\xa6, 9m, 1p, 2p, \xe2\x80\xa6, 9p, 1s, 2s, \xe2\x80\xa6, 9s.In order to win the game, she must have at least one mentsu (described below) in her hand, so sometimes she should draw extra suited tiles. After drawing a tile, the number of her tiles increases by one. She can draw any tiles she wants, including those already in her hand.Do you know the minimum number of extra suited tiles she needs to draw so that she can win?Here are some useful definitions in this game:  A mentsu, also known as meld, is formed by a koutsu or a shuntsu;  A koutsu, also known as triplet, is made of three identical tiles, such as [1m, 1m, 1m], however, [1m, 1p, 1s] or [1m, 4m, 7m] is NOT a koutsu;  A shuntsu, also known as sequence, is made of three sequential numbered tiles in the same suit, such as [1m, 2m, 3m] and [5s, 7s, 6s], however, [9m, 1m, 2m] or [1m, 2p, 3s] is NOT a shuntsu. Some examples:   [2m, 3p, 2s, 4m, 1s, 2s, 4s] \xe2\x80\x94 it contains no koutsu or shuntsu, so it includes no mentsu;  [4s, 3m, 3p, 4s, 5p, 4s, 5p] \xe2\x80\x94 it contains a koutsu, [4s, 4s, 4s], but no shuntsu, so it includes a mentsu;  [5p, 5s, 9m, 4p, 1s, 7p, 7m, 6p] \xe2\x80\x94 it contains no koutsu but a shuntsu, [5p, 4p, 6p] or [5p, 7p, 6p], so it includes a mentsu. Note that the order of tiles is unnecessary and you can assume the number of each type of suited tiles she can draw is infinite." 1200
1191A "Tokitsukaze and Enhancement" "brute force" "Tokitsukaze is one of the characters in the game ""Kantai Collection"". In this game, every character has a common attributeÂ \xe2\x80\x94 health points, shortened to HP.In general, different values of HP are grouped into 4 categories:  Category A if HP is in the form of (4n+1), that is, when divided by 4, the remainder is 1;  Category B if HP is in the form of (4n+3), that is, when divided by 4, the remainder is 3;  Category C if HP is in the form of (4n+2), that is, when divided by 4, the remainder is 2;  Category D if HP is in the form of 4n, that is, when divided by 4, the remainder is 0. The above-mentioned n can be any integer.These 4 categories ordered from highest to lowest as A>B>C>D, which means category A is the highest and category D is the lowest.While playing the game, players can increase the HP of the character. Now, Tokitsukaze wants you to increase her HP by at most 2 (that is, either by 0, 1 or 2). How much should she increase her HP so that it has the highest possible category?" 800
1190F "Tokitsukaze and Powers" "number theory,probabilities" "Tokitsukaze is playing a room escape game designed by SkywalkerT. In this game, she needs to find out hidden clues in the room to reveal a way to escape.After a while, she realizes that the only way to run away is to open the digital door lock since she accidentally went into a secret compartment and found some clues, which can be interpreted as:  Only when you enter n possible different passwords can you open the door;  Passwords must be integers ranged from 0 to (m\xe2\x88\x921);  A password cannot be x (0\xe2\x89\xa4x<m) if x and m are not coprime (i.e. x and m have some common divisor greater than 1);  A password cannot be x (0\xe2\x89\xa4x<m) if there exist non-negative integers e and k such that pe=km+x, where p is a secret integer;  Any integer that doesn\'t break the above rules can be a password;  Several integers are hidden in the room, but only one of them can be p. Fortunately, she finds that n and m are recorded in the lock. However, what makes Tokitsukaze frustrated is that she doesn\'t do well in math. Now that she has found an integer that is suspected to be p, she wants you to help her find out n possible passwords, or determine the integer cannot be p." 3400
1190E "Tokitsukaze and Explosion" "binary search,greedy" "Tokitsukaze and her friends are trying to infiltrate a secret base built by Claris. However, Claris has been aware of that and set a bomb which is going to explode in a minute. Although they try to escape, they have no place to go after they find that the door has been locked.At this very moment, CJB, Father of Tokitsukaze comes. With his magical power given by Ereshkigal, the goddess of the underworld, CJB is able to set m barriers to protect them from the explosion. Formally, let\'s build a Cartesian coordinate system on the plane and assume the bomb is at O(0,0). There are n persons in Tokitsukaze\'s crew, the i-th one of whom is at Pi(Xi,Yi). Every barrier can be considered as a line with infinity length and they can intersect each other. For every person from Tokitsukaze\'s crew, there must be at least one barrier separating the bomb and him, which means the line between the bomb and him intersects with at least one barrier. In this definition, if there exists a person standing at the position of the bomb, any line through O(0,0) will satisfy the requirement.Although CJB is very powerful, he still wants his barriers to be as far from the bomb as possible, in order to conserve his energy. Please help him calculate the maximum distance between the bomb and the closest barrier while all of Tokitsukaze\'s crew are safe." 3100
1190D "Tokitsukaze and Strange Rectangle" "data structures,divide and conquer,sortings,two pointers" "There are n points on the plane, the i-th of which is at (xi,yi). Tokitsukaze wants to draw a strange rectangular area and pick all the points in the area.The strange area is enclosed by three lines, x=l, y=a and x=r, as its left side, its bottom side and its right side respectively, where l, r and a can be any real numbers satisfying that l<r. The upper side of the area is boundless, which you can regard as a line parallel to the x-axis at infinity. The following figure shows a strange rectangular area.  A point (xi,yi) is in the strange rectangular area if and only if l<xi<r and yi>a. For example, in the above figure, p1 is in the area while p2 is not.Tokitsukaze wants to know how many different non-empty sets she can obtain by picking all the points in a strange rectangular area, where we think two sets are different if there exists at least one point in one set of them but not in the other." 2000
1190C "Tokitsukaze and Duel" "brute force,games,greedy" """Duel!""Betting on the lovely princess Claris, the duel between Tokitsukaze and Quailty has started.There are n cards in a row. Each card has two sides, one of which has color. At first, some of these cards are with color sides facing up and others are with color sides facing down. Then they take turns flipping cards, in which Tokitsukaze moves first. In each move, one should choose exactly k consecutive cards and flip them to the same side, which means to make their color sides all face up or all face down. If all the color sides of these n cards face the same direction after one\'s move, the one who takes this move will win.Princess Claris wants to know who will win the game if Tokitsukaze and Quailty are so clever that they won\'t make mistakes." 2300
1190B "Tokitsukaze, CSL and Stone Game" games "Tokitsukaze and CSL are playing a little game of stones.In the beginning, there are n piles of stones, the i-th pile of which has ai stones. The two players take turns making moves. Tokitsukaze moves first. On each turn the player chooses a nonempty pile and removes exactly one stone from the pile. A player loses if all of the piles are empty before his turn, or if after removing the stone, two piles (possibly empty) contain the same number of stones. Supposing that both players play optimally, who will win the game?Consider an example: n=3 and sizes of piles are a1=2, a2=3, a3=0. It is impossible to choose the empty pile, so Tokitsukaze has two choices: the first and the second piles. If she chooses the first pile then the state will be [1,3,0] and it is a good move. But if she chooses the second pile then the state will be [2,2,0] and she immediately loses. So the only good move for her is to choose the first pile. Supposing that both players always take their best moves and never make mistakes, who will win the game?Note that even if there are two piles with the same number of stones at the beginning, Tokitsukaze may still be able to make a valid first move. It is only necessary that there are no two piles with the same number of stones after she moves." 1800
1190A "Tokitsukaze and Discard Items" "implementation,two pointers" "Recently, Tokitsukaze found an interesting game. Tokitsukaze had n items at the beginning of this game. However, she thought there were too many items, so now she wants to discard m (1\xe2\x89\xa4m\xe2\x89\xa4n) special items of them.These n items are marked with indices from 1 to n. In the beginning, the item with index i is placed on the i-th position. Items are divided into several pages orderly, such that each page contains exactly k positions and the last positions on the last page may be left empty.Tokitsukaze would do the following operation: focus on the first special page that contains at least one special item, and at one time, Tokitsukaze would discard all special items on this page. After an item is discarded or moved, its old position would be empty, and then the item below it, if exists, would move up to this empty position. The movement may bring many items forward and even into previous pages, so Tokitsukaze would keep waiting until all the items stop moving, and then do the operation (i.e. check the special page and discard the special items) repeatedly until there is no item need to be discarded.  Consider the first example from the statement: n=10, m=4, k=5, p=[3,5,7,10]. The are two pages. Initially, the first page is special (since it is the first page containing a special item). So Tokitsukaze discards the special items with indices 3 and 5. After, the first page remains to be special. It contains [1,2,4,6,7], Tokitsukaze discards the special item with index 7. After, the second page is special (since it is the first page containing a special item). It contains [9,10], Tokitsukaze discards the special item with index 10. Tokitsukaze wants to know the number of operations she would do in total." 1400
1189C Candies! "data structures,dp,implementation,math" "Consider a sequence of digits of length 2k [a1,a2,\xe2\x80\xa6,a2k]. We perform the following operation with it: replace pairs (a2i+1,a2i+2) with (a2i+1+a2i+2)mod10 for 0\xe2\x89\xa4i<2k\xe2\x88\x921. For every i where a2i+1+a2i+2\xe2\x89\xa510 we get a candy! As a result, we will get a sequence of length 2k\xe2\x88\x921.Less formally, we partition sequence of length 2k into 2k\xe2\x88\x921 pairs, each consisting of 2 numbers: the first pair consists of the first and second numbers, the second of the third and fourth \xe2\x80\xa6, the last pair consists of the (2k\xe2\x88\x921)-th and (2k)-th numbers. For every pair such that sum of numbers in it is at least 10, we get a candy. After that, we replace every pair of numbers with a remainder of the division of their sum by 10 (and don\'t change the order of the numbers).Perform this operation with a resulting array until it becomes of length 1. Let f([a1,a2,\xe2\x80\xa6,a2k]) denote the number of candies we get in this process. For example: if the starting sequence is [8,7,3,1,7,0,9,4] then:After the first operation the sequence becomes [(8+7)mod10,(3+1)mod10,(7+0)mod10,(9+4)mod10] = [5,4,7,3], and we get 2 candies as 8+7\xe2\x89\xa510 and 9+4\xe2\x89\xa510.After the second operation the sequence becomes [(5+4)mod10,(7+3)mod10] = [9,0], and we get one more candy as 7+3\xe2\x89\xa510. After the final operation sequence becomes [(9+0)mod10] = [9]. Therefore, f([8,7,3,1,7,0,9,4])=3 as we got 3 candies in total.You are given a sequence of digits of length n s1,s2,\xe2\x80\xa6sn. You have to answer q queries of the form (li,ri), where for i-th query you have to output f([sli,sli+1,\xe2\x80\xa6,sri]). It is guaranteed that ri\xe2\x88\x92li+1 is of form 2k for some nonnegative integer k." 1400
1189B "Number Circle" greedy,math,sortings "You are given n numbers a1,a2,\xe2\x80\xa6,an. Is it possible to arrange them in a circle in such a way that every number is strictly less than the sum of its neighbors?For example, for the array [1,4,5,6,7,8], the arrangement on the left is valid, while arrangement on the right is not, as 5\xe2\x89\xa54+1 and 8>1+6." 1100
1189A "Keanu Reeves" strings "After playing Neo in the legendary ""Matrix"" trilogy, Keanu Reeves started doubting himself: maybe we really live in virtual reality? To find if this is true, he needs to solve the following problem.Let\'s call a string consisting of only zeroes and ones good if it contains different numbers of zeroes and ones. For example, 1, 101, 0000 are good, while 01, 1001, and 111000 are not good.We are given a string s of length n consisting of only zeroes and ones. We need to cut s into minimal possible number of substrings s1,s2,\xe2\x80\xa6,sk such that all of them are good. More formally, we have to find minimal by number of strings sequence of good strings s1,s2,\xe2\x80\xa6,sk such that their concatenation (joining) equals s, i.e. s1+s2+\xe2\x8b\xaf+sk=s.For example, cuttings 110010 into 110 and 010 or into 11 and 0010 are valid, as 110, 010, 11, 0010 are all good, and we can\'t cut 110010 to the smaller number of substrings as 110010 isn\'t good itself. At the same time, cutting of 110010 into 1100 and 10 isn\'t valid as both strings aren\'t good. Also, cutting of 110010 into 1, 1, 0010 isn\'t valid, as it isn\'t minimal, even though all 3 strings are good.Can you help Keanu? We can show that the solution always exists. If there are multiple optimal answers, print any." 800
1188E "Problem from Red Panda" combinatorics "At Moscow Workshops ICPC team gets a balloon for each problem they solved first. Team MSU Red Panda got so many balloons that they didn\'t know how to spend them. So they came up with a problem with them.There are several balloons, not more than 106 in total, each one is colored in one of k colors. We can perform the following operation: choose k\xe2\x88\x921 balloons such that they are of k\xe2\x88\x921 different colors, and recolor them all into remaining color. We can perform this operation any finite number of times (for example, we can only perform the operation if there are at least k\xe2\x88\x921 different colors among current balls).How many different balloon configurations can we get? Only number of balloons of each color matters, configurations differing only by the order of balloons are counted as equal. As this number can be very large, output it modulo 998244353." 3300
1188D "Make Equal" dp "You are given n numbers a1,a2,\xe2\x80\xa6,an. In one operation we can add to any one of those numbers a nonnegative integer power of 2.What is the smallest number of operations we need to perform to make all n numbers equal? It can be proved that under given constraints it doesn\'t exceed 1018." 3100
1188C "Array Beauty" dp "Let\'s call beauty of an array b1,b2,\xe2\x80\xa6,bn (n>1) Â \xe2\x80\x94 min1\xe2\x89\xa4i<j\xe2\x89\xa4n|bi\xe2\x88\x92bj|.You\'re given an array a1,a2,\xe2\x80\xa6an and a number k. Calculate the sum of beauty over all subsequences of the array of length exactly k. As this number can be very large, output it modulo 998244353.A sequence a is a subsequence of an array b if a can be obtained from b by deletion of several (possibly, zero or all) elements." 2500
1188B "Count Pairs" "math,matrices,number theory,two pointers" "You are given a prime number p, n integers a1,a2,\xe2\x80\xa6,an, and an integer k. Find the number of pairs of indexes (i,j) (1\xe2\x89\xa4i<j\xe2\x89\xa4n) for which (ai+aj)(a2i+a2j)\xe2\x89\xa1kmodp." 2300
1188A2 "Add on a Tree: Revolution" "constructive algorithms,dfs and similar,implementation,trees" "Note that this is the second problem of the two similar problems. You can hack this problem if you solve it. But you can hack the previous problem only if you solve both problems.You are given a tree with n nodes. In the beginning, 0 is written on all edges. In one operation, you can choose any 2 distinct leaves u, v and any integer number x and add x to values written on all edges on the simple path between u and v. Note that in previous subtask x was allowed to be any real, here it has to be integer.For example, on the picture below you can see the result of applying two operations to the graph: adding 2 on the path from 7 to 6, and then adding \xe2\x88\x921 on the path from 4 to 5.   You are given some configuration of nonnegative integer pairwise different even numbers, written on the edges. For a given configuration determine if it is possible to achieve it with these operations, and, if it is possible, output the sequence of operations that leads to the given configuration. Constraints on the operations are listed in the output format section.Leave is a node of a tree of degree 1. Simple path is a path that doesn\'t contain any node twice." 2500
1188A1 "Add on a Tree" trees "Note that this is the first problem of the two similar problems. You can hack this problem only if you solve both problems.You are given a tree with n nodes. In the beginning, 0 is written on all edges. In one operation, you can choose any 2 distinct leaves u, v and any real number x and add x to values written on all edges on the simple path between u and v.For example, on the picture below you can see the result of applying two operations to the graph: adding 2 on the path from 7 to 6, and then adding \xe2\x88\x920.5 on the path from 4 to 5.   Is it true that for any configuration of real numbers written on edges, we can achieve it with a finite number of operations?Leaf is a node of a tree of degree 1. Simple path is a path that doesn\'t contain any node twice." 1600
1187G "Gang Up" flows,graphs "The leader of some very secretive organization has decided to invite all other members to a meeting. All members of the organization live in the same town which can be represented as n crossroads connected by m two-directional streets. The meeting will be held in the leader\'s house near the crossroad 1. There are k members of the organization invited to the meeting; i-th of them lives near the crossroad ai. All members of the organization receive the message about the meeting at the same moment and start moving to the location where the meeting is held. In the beginning of each minute each person is located at some crossroad. He or she can either wait a minute at this crossroad, or spend a minute to walk from the current crossroad along some street to another crossroad (obviously, it is possible to start walking along the street only if it begins or ends at the current crossroad). In the beginning of the first minute each person is at the crossroad where he or she lives. As soon as a person reaches the crossroad number 1, he or she immediately comes to the leader\'s house and attends the meeting.Obviously, the leader wants all other members of the organization to come up as early as possible. But, since the organization is very secretive, the leader does not want to attract much attention. Let\'s denote the discontent of the leader as follows  initially the discontent is 0;  whenever a person reaches the crossroad number 1, the discontent of the leader increases by c\xe2\x8b\x85x, where c is some fixed constant, and x is the number of minutes it took the person to reach the crossroad number 1;  whenever x members of the organization walk along the same street at the same moment in the same direction, dx2 is added to the discontent, where d is some fixed constant. This is not cumulative: for example, if two persons are walking along the same street in the same direction at the same moment, then 4d is added to the discontent, not 5d. Before sending a message about the meeting, the leader can tell each member of the organization which path they should choose and where they should wait. Help the leader to establish a plan for every member of the organization so they all reach the crossroad 1, and the discontent is minimized." 2500
1187F "Expected Square Beauty" dp,math,probabilities "Let x be an array of integers x=[x1,x2,\xe2\x80\xa6,xn]. Let\'s define B(x) as a minimal size of a partition of x into subsegments such that all elements in each subsegment are equal. For example, B([3,3,6,1,6,6,6])=4 using next partition: [3,3Â |Â 6Â |Â 1Â |Â 6,6,6].Now you don\'t have any exact values of x, but you know that xi can be any integer value from [li,ri] (li\xe2\x89\xa4ri) uniformly at random. All xi are independent.Calculate expected value of (B(x))2, or E((B(x))2). It\'s guaranteed that the expected value can be represented as rational fraction PQ where (P,Q)=1, so print the value P\xe2\x8b\x85Q\xe2\x88\x921mod109+7." 2500
1187E "Tree Painting" "dfs and similar,dp,trees" "You are given a tree (an undirected connected acyclic graph) consisting of n vertices. You are playing a game on this tree.Initially all vertices are white. On the first turn of the game you choose one vertex and paint it black. Then on each turn you choose a white vertex adjacent (connected by an edge) to any black vertex and paint it black.Each time when you choose a vertex (even during the first turn), you gain the number of points equal to the size of the connected component consisting only of white vertices that contains the chosen vertex. The game ends when all vertices are painted black.Let\'s see the following example:Vertices 1 and 4 are painted black already. If you choose the vertex 2, you will gain 4 points for the connected component consisting of vertices 2,3,5 and 6. If you choose the vertex 9, you will gain 3 points for the connected component consisting of vertices 7,8 and 9.Your task is to maximize the number of points you gain." 2100
1187D "Subarray Sorting" "data structures,sortings" "You are given an array a1,a2,\xe2\x80\xa6,an and an array b1,b2,\xe2\x80\xa6,bn.For one operation you can sort in non-decreasing order any subarray a[l\xe2\x80\xa6r] of the array a.For example, if a=[4,2,2,1,3,1] and you choose subbarray a[2\xe2\x80\xa65], then the array turns into [4,1,2,2,3,1]. You are asked to determine whether it is possible to obtain the array b by applying this operation any number of times (possibly zero) to the array a." 2400
1187C "Vasya And Array" "constructive algorithms,greedy,implementation" "Vasya has an array a1,a2,\xe2\x80\xa6,an.You don\'t know this array, but he told you m facts about this array. The i-th fact is a triple of numbers ti, li and ri (0\xe2\x89\xa4ti\xe2\x89\xa41,1\xe2\x89\xa4li<ri\xe2\x89\xa4n) and it means:  if ti=1 then subbarray ali,ali+1,\xe2\x80\xa6,ari is sorted in non-decreasing order;  if ti=0 then subbarray ali,ali+1,\xe2\x80\xa6,ari is not sorted in non-decreasing order. A subarray is not sorted if there is at least one pair of consecutive elements in this subarray such that the former is greater than the latter. For example if a=[2,1,1,3,2] then he could give you three facts: t1=1,l1=2,r1=4 (the subarray [a2,a3,a4]=[1,1,3] is sorted), t2=0,l2=4,r2=5 (the subarray [a4,a5]=[3,2] is not sorted), and t3=0,l3=3,r3=5 (the subarray [a3,a5]=[1,3,2] is not sorted).You don\'t know the array a. Find any array which satisfies all the given facts." 1800
1187B "Letters Shop" "binary search,implementation,strings" "The letters shop showcase is a string s, consisting of n lowercase Latin letters. As the name tells, letters are sold in the shop.Letters are sold one by one from the leftmost to the rightmost. Any customer can only buy some prefix of letters from the string s.There are m friends, the i-th of them is named ti. Each of them is planning to estimate the following value: how many letters (the length of the shortest prefix) would s/he need to buy if s/he wanted to construct her/his name of bought letters. The name can be constructed if each letter is presented in the equal or greater amount.  For example, for s=""arrayhead"" and ti=""arya"" 5 letters have to be bought (""arrayhead"").  For example, for s=""arrayhead"" and ti=""harry"" 6 letters have to be bought (""arrayhead"").  For example, for s=""arrayhead"" and ti=""ray"" 5 letters have to be bought (""arrayhead"").  For example, for s=""arrayhead"" and ti=""r"" 2 letters have to be bought (""arrayhead"").  For example, for s=""arrayhead"" and ti=""areahydra"" all 9 letters have to be bought (""arrayhead""). It is guaranteed that every friend can construct her/his name using the letters from the string s.Note that the values for friends are independent, friends are only estimating them but not actually buying the letters." 1300
1187A "Stickers and Toys" math "Your favorite shop sells n Kinder Surprise chocolate eggs. You know that exactly s stickers and exactly t toys are placed in n eggs in total.Each Kinder Surprise can be one of three types:  it can contain a single sticker and no toy;  it can contain a single toy and no sticker;  it can contain both a single sticker and a single toy. But you don\'t know which type a particular Kinder Surprise has. All eggs look identical and indistinguishable from each other.What is the minimum number of Kinder Surprise Eggs you have to buy to be sure that, whichever types they are, you\'ll obtain at least one sticker and at least one toy?Note that you do not open the eggs in the purchasing process, that is, you just buy some number of eggs. It\'s guaranteed that the answer always exists." 900
1186F "Vus the Cossack and a Graph" "dfs and similar,graphs,greedy,implementation" "Vus the Cossack has a simple graph with n vertices and m edges. Let di be a degree of the i-th vertex. Recall that a degree of the i-th vertex is the number of conected edges to the i-th vertex.He needs to remain not more than \xe2\x8c\x88n+m2\xe2\x8c\x89 edges. Let fi be the degree of the i-th vertex after removing. He needs to delete them in such way so that \xe2\x8c\x88di2\xe2\x8c\x89\xe2\x89\xa4fi for each i. In other words, the degree of each vertex should not be reduced more than twice. Help Vus to remain the needed edges!" 2400
1186E "Vus the Cossack and a Field" "divide and conquer,implementation,math" "Vus the Cossack has a field with dimensions n\xc3\x97m, which consists of ""0"" and ""1"". He is building an infinite field from this field. He is doing this in this way: He takes the current field and finds a new inverted field. In other words, the new field will contain ""1"" only there, where ""0"" was in the current field, and ""0"" there, where ""1"" was. To the current field, he adds the inverted field to the right.  To the current field, he adds the inverted field to the bottom.  To the current field, he adds the current field to the bottom right.  He repeats it.For example, if the initial field was: 1011 After the first iteration, the field will be like this: 1001110001100011 After the second iteration, the field will be like this: 1001011011000011011010010011110001101001001111001001011011000011 And so on...Let\'s numerate lines from top to bottom from 1 to infinity, and columns from left to right from 1 to infinity. We call the submatrix (x1,y1,x2,y2) all numbers that have coordinates (x,y) such that x1\xe2\x89\xa4x\xe2\x89\xa4x2 and y1\xe2\x89\xa4y\xe2\x89\xa4y2.The Cossack needs sometimes to find the sum of all the numbers in submatrices. Since he is pretty busy right now, he is asking you to find the answers!" 2500
1186D "Vus the Cossack and Numbers" "constructive algorithms,greedy,math" "Vus the Cossack has n real numbers ai. It is known that the sum of all numbers is equal to 0. He wants to choose a sequence b the size of which is n such that the sum of all numbers is 0 and each bi is either \xe2\x8c\x8aai\xe2\x8c\x8b or \xe2\x8c\x88ai\xe2\x8c\x89. In other words, bi equals ai rounded up or down. It is not necessary to round to the nearest integer.For example, if a=[4.58413,1.22491,\xe2\x88\x922.10517,\xe2\x88\x923.70387], then b can be equal, for example, to [4,2,\xe2\x88\x922,\xe2\x88\x924]. Note that if ai is an integer, then there is no difference between \xe2\x8c\x8aai\xe2\x8c\x8b and \xe2\x8c\x88ai\xe2\x8c\x89, bi will always be equal to ai.Help Vus the Cossack find such sequence!" 1500
1186C "Vus the Cossack and Strings" implementation,math "Vus the Cossack has two binary strings, that is, strings that consist only of ""0"" and ""1"". We call these strings a and b. It is known that |b|\xe2\x89\xa4|a|, that is, the length of b is at most the length of a.The Cossack considers every substring of length |b| in string a. Let\'s call this substring c. He matches the corresponding characters in b and c, after which he counts the number of positions where the two strings are different. We call this function f(b,c).For example, let b=00110, and c=11000. In these strings, the first, second, third and fourth positions are different.Vus the Cossack counts the number of such substrings c such that f(b,c) is even.For example, let a=01100010 and b=00110. a has four substrings of the length |b|: 01100, 11000, 10001, 00010.  f(00110,01100)=2; f(00110,11000)=4; f(00110,10001)=4; f(00110,00010)=1. Since in three substrings, f(b,c) is even, the answer is 3.Vus can not find the answer for big strings. That is why he is asking you to help him." 1800
1186A "Vus the Cossack and a Contest" implementation "Vus the Cossack holds a programming competition, in which n people participate. He decided to award them all with pens and notebooks. It is known that Vus has exactly m pens and k notebooks.Determine whether the Cossack can reward all participants, giving each of them at least one pen and at least one notebook." 800
1185G2 "Playlist for Polycarp (hard version)" combinatorics,dp "The only difference between easy and hard versions is constraints.Polycarp loves to listen to music, so he never leaves the player, even on the way home from the university. Polycarp overcomes the distance from the university to the house in exactly T minutes.In the player, Polycarp stores n songs, each of which is characterized by two parameters: ti and gi, where ti is the length of the song in minutes (1\xe2\x89\xa4ti\xe2\x89\xa450), gi is its genre (1\xe2\x89\xa4gi\xe2\x89\xa43).Polycarp wants to create such a playlist so that he can listen to music all the time on the way from the university to his home, and at the time of his arrival home, the playlist is over. Polycarp never interrupts songs and always listens to them from beginning to end. Thus, if he started listening to the i-th song, he would spend exactly ti minutes on its listening. Polycarp also does not like when two songs of the same genre play in a row (i.e. successively/adjacently) or when the songs in his playlist are repeated.Help Polycarpus count the number of different sequences of songs (their order matters), the total duration is exactly T, such that there are no two consecutive songs of the same genre in them and all the songs in the playlist are different." 2600
1185G1 "Playlist for Polycarp (easy version)" bitmasks,combinatorics,dp "The only difference between easy and hard versions is constraints.Polycarp loves to listen to music, so he never leaves the player, even on the way home from the university. Polycarp overcomes the distance from the university to the house in exactly T minutes.In the player, Polycarp stores n songs, each of which is characterized by two parameters: ti and gi, where ti is the length of the song in minutes (1\xe2\x89\xa4ti\xe2\x89\xa415), gi is its genre (1\xe2\x89\xa4gi\xe2\x89\xa43).Polycarp wants to create such a playlist so that he can listen to music all the time on the way from the university to his home, and at the time of his arrival home, the playlist is over. Polycarp never interrupts songs and always listens to them from beginning to end. Thus, if he started listening to the i-th song, he would spend exactly ti minutes on its listening. Polycarp also does not like when two songs of the same genre play in a row (i.e. successively/adjacently) or when the songs in his playlist are repeated.Help Polycarpus count the number of different sequences of songs (their order matters), the total duration is exactly T, such that there are no two consecutive songs of the same genre in them and all the songs in the playlist are different." 2100
1185F "Two Pizzas" "bitmasks,brute force" "A company of n friends wants to order exactly two pizzas. It is known that in total there are 9 pizza ingredients in nature, which are denoted by integers from 1 to 9.Each of the n friends has one or more favorite ingredients: the i-th of friends has the number of favorite ingredients equal to fi (1\xe2\x89\xa4fi\xe2\x89\xa49) and your favorite ingredients form the sequence bi1,bi2,\xe2\x80\xa6,bifi (1\xe2\x89\xa4bit\xe2\x89\xa49).The website of CodePizza restaurant has exactly m (m\xe2\x89\xa52) pizzas. Each pizza is characterized by a set of rj ingredients aj1,aj2,\xe2\x80\xa6,ajrj (1\xe2\x89\xa4rj\xe2\x89\xa49, 1\xe2\x89\xa4ajt\xe2\x89\xa49) , which are included in it, and its price is cj.Help your friends choose exactly two pizzas in such a way as to please the maximum number of people in the company. It is known that a person is pleased with the choice if each of his/her favorite ingredients is in at least one ordered pizza. If there are several ways to choose two pizzas so as to please the maximum number of friends, then choose the one that minimizes the total price of two pizzas." 2100
1185E "Polycarp and Snakes" "brute force,implementation" "After a hard-working week Polycarp prefers to have fun. Polycarp\'s favorite entertainment is drawing snakes. He takes a rectangular checkered sheet of paper of size n\xc3\x97m (where n is the number of rows, m is the number of columns) and starts to draw snakes in cells.Polycarp draws snakes with lowercase Latin letters. He always draws the first snake with the symbol \'a\', the second snake with the symbol \'b\', the third snake with the symbol \'c\' and so on. All snakes have their own unique symbol. There are only 26 letters in the Latin alphabet, Polycarp is very tired and he doesn\'t want to invent new symbols, so the total number of drawn snakes doesn\'t exceed 26.Since by the end of the week Polycarp is very tired, he draws snakes as straight lines without bends. So each snake is positioned either vertically or horizontally. Width of any snake equals 1, i.e. each snake has size either 1\xc3\x97l or l\xc3\x971, where l is snake\'s length. Note that snakes can\'t bend.When Polycarp draws a new snake, he can use already occupied cells for drawing the snake. In this situation, he draws the snake ""over the top"" and overwrites the previous value in the cell.Recently when Polycarp was at work he found a checkered sheet of paper with Latin letters. He wants to know if it is possible to get this sheet of paper from an empty sheet by drawing some snakes according to the rules described above. If it is possible, he is interested in a way to draw snakes." 2000
1185D "Extra Element" implementation,math "A sequence a1,a2,\xe2\x80\xa6,ak is called an arithmetic progression if for each i from 1 to k elements satisfy the condition ai=a1+c\xe2\x8b\x85(i\xe2\x88\x921) for some fixed c.For example, these five sequences are arithmetic progressions: [5,7,9,11], [101], [101,100,99], [13,97] and [5,5,5,5,5]. And these four sequences aren\'t arithmetic progressions: [3,1,2], [1,2,4,8], [1,\xe2\x88\x921,1,\xe2\x88\x921] and [1,2,3,3,3].You are given a sequence of integers b1,b2,\xe2\x80\xa6,bn. Find any index j (1\xe2\x89\xa4j\xe2\x89\xa4n), such that if you delete bj from the sequence, you can reorder the remaining n\xe2\x88\x921 elements, so that you will get an arithmetic progression. If there is no such index, output the number -1." 1700
1185C2 "Exam in BerSU (hard version)" "brute force,data structures,greedy,math" "The only difference between easy and hard versions is constraints.If you write a solution in Python, then prefer to send it in PyPy to speed up execution time.A session has begun at Beland State University. Many students are taking exams.Polygraph Poligrafovich is going to examine a group of n students. Students will take the exam one-by-one in order from 1-th to n-th. Rules of the exam are following:  The i-th student randomly chooses a ticket.  if this ticket is too hard to the student, he doesn\'t answer and goes home immediately (this process is so fast that it\'s considered no time elapses). This student fails the exam.  if the student finds the ticket easy, he spends exactly ti minutes to pass the exam. After it, he immediately gets a mark and goes home. Students take the exam in the fixed order, one-by-one, without any interruption. At any moment of time, Polygraph Poligrafovich takes the answer from one student.The duration of the whole exam for all students is M minutes (maxti\xe2\x89\xa4M), so students at the end of the list have a greater possibility to run out of time to pass the exam.For each student i, you should count the minimum possible number of students who need to fail the exam so the i-th student has enough time to pass the exam.For each student i, find the answer independently. That is, if when finding the answer for the student i1 some student j should leave, then while finding the answer for i2 (i2>i1) the student j student does not have to go home." 1700
1185C1 "Exam in BerSU (easy version)" greedy,sortings "The only difference between easy and hard versions is constraints.A session has begun at Beland State University. Many students are taking exams.Polygraph Poligrafovich is going to examine a group of n students. Students will take the exam one-by-one in order from 1-th to n-th. Rules of the exam are following:  The i-th student randomly chooses a ticket.  if this ticket is too hard to the student, he doesn\'t answer and goes home immediately (this process is so fast that it\'s considered no time elapses). This student fails the exam.  if the student finds the ticket easy, he spends exactly ti minutes to pass the exam. After it, he immediately gets a mark and goes home. Students take the exam in the fixed order, one-by-one, without any interruption. At any moment of time, Polygraph Poligrafovich takes the answer from one student.The duration of the whole exam for all students is M minutes (maxti\xe2\x89\xa4M), so students at the end of the list have a greater possibility to run out of time to pass the exam.For each student i, you should count the minimum possible number of students who need to fail the exam so the i-th student has enough time to pass the exam.For each student i, find the answer independently. That is, if when finding the answer for the student i1 some student j should leave, then while finding the answer for i2 (i2>i1) the student j student does not have to go home." 1200
1185B "Email from Polycarp" implementation,strings "Methodius received an email from his friend Polycarp. However, Polycarp\'s keyboard is broken, so pressing a key on it once may cause the corresponding symbol to appear more than once (if you press a key on a regular keyboard, it prints exactly one symbol).For example, as a result of typing the word ""hello"", the following words could be printed: ""hello"", ""hhhhello"", ""hheeeellllooo"", but the following could not be printed: ""hell"", ""helo"", ""hhllllooo"".Note, that when you press a key, the corresponding symbol must appear (possibly, more than once). The keyboard is broken in a random manner, it means that pressing the same key you can get the different number of letters in the result.For each word in the letter, Methodius has guessed what word Polycarp actually wanted to write, but he is not sure about it, so he asks you to help him.You are given a list of pairs of words. For each pair, determine if the second word could be printed by typing the first one on Polycarp\'s keyboard." 1200
1185A Ropewalkers math "Polycarp decided to relax on his weekend and visited to the performance of famous ropewalkers: Agafon, Boniface and Konrad.The rope is straight and infinite in both directions. At the beginning of the performance, Agafon, Boniface and Konrad are located in positions a, b and c respectively. At the end of the performance, the distance between each pair of ropewalkers was at least d.Ropewalkers can walk on the rope. In one second, only one ropewalker can change his position. Every ropewalker can change his position exactly by 1 (i. e. shift by 1 to the left or right direction on the rope). Agafon, Boniface and Konrad can not move at the same time (Only one of them can move at each moment). Ropewalkers can be at the same positions at the same time and can ""walk past each other"".You should find the minimum duration (in seconds) of the performance. In other words, find the minimum number of seconds needed so that the distance between each pair of ropewalkers can be greater or equal to d.Ropewalkers can walk to negative coordinates, due to the rope is infinite to both sides." 800
1184E3 "Daleks\' Invasion (hard)" "data structures,dsu,graphs,trees" "With your help, Heidi has prepared a plan of trap placement and defence. Yet suddenly, the Doctor popped out of the TARDIS and told her that he had spied on the Daleks\' preparations, and there is more of them than ever. Desperate times require desperate measures, so Heidi is going to risk meeting with the Daleks and she will consider placing a trap along any Corridor.This means she needs your help again in calculating Emax(c) \xe2\x80\x93 the largest e\xe2\x89\xa4109 such that if we changed the energy requirement of c to e, then the Daleks might use c in their invasion \xe2\x80\x93 but this time for all Time Corridors." 2400
1184E2 "Daleks\' Invasion (medium)" "dfs and similar,graphs,shortest paths,trees" "After a successful field test, Heidi is considering deploying a trap along some Corridor, possibly not the first one. She wants to avoid meeting the Daleks inside the Time Vortex, so for abundance of caution she considers placing the traps only along those Corridors that are not going to be used according to the current Daleks\' plan \xe2\x80\x93 which is to use a minimum spanning tree of Corridors. Heidi knows that all energy requirements for different Corridors are now different, and that the Daleks have a single unique plan which they are intending to use.Your task is to calculate the number Emax(c), which is defined in the same way as in the easy version \xe2\x80\x93 i.e., the largest e\xe2\x89\xa4109 such that if we changed the energy of corridor c to e, the Daleks might use it \xe2\x80\x93 but now for every corridor that Heidi considers." 2100
1184E1 "Daleks\' Invasion (easy)" graphs,trees "Heidi found out that the Daleks have created a network of bidirectional Time Corridors connecting different destinations (at different times!).Â She suspects that they are planning another invasion on the entire Space and Time. In order to counter the invasion, she plans to deploy a trap in the Time Vortex, along a carefully chosen Time Corridor. She knows that tinkering with the Time Vortex is dangerous, so she consulted the Doctor on how to proceed. She has learned the following:  Different Time Corridors require different amounts of energy to keep stable.  Daleks are unlikely to use all corridors in their invasion. They will pick a set of Corridors that requires the smallest total energy to maintain, yet still makes (time) travel possible between any two destinations (for those in the know: they will use a minimum spanning tree).  Setting the trap may modify the energy required to keep the Corridor stable. Heidi decided to carry out a field test and deploy one trap, placing it along the first Corridor. But she needs to know whether the Daleks are going to use this corridor after the deployment of the trap. She gives you a map of Time Corridors (an undirected graph) with energy requirements for each Corridor.For a Corridor c, Emax(c) is the largest e\xe2\x89\xa4109 such that if we changed the required amount of energy of c to e, then the Daleks may still be using c in their invasion (that is, it belongs to some minimum spanning tree). Your task is to calculate Emax(c1) for the Corridor c1 that Heidi plans to arm with a trap, which is the first edge in the graph." 1900
1184D2 "Parallel Universes (Hard)" math,matrices "Heidi enjoyed performing the simulation because she knew exactly when a new universe would be formed and where, and when a non-existent link would be broken and where.However, the multiverse itself works in mysterious ways. Well, it works using probabilities, which to some people is mysterious.At each unit time, when a decision is made, one of the two events will happen randomly. Let\'s denote l as the current length of the multiverse. With a probability of pcreate=1\xe2\x88\x92lm, a universe will be created. With a probability of pbreak=lm, a non-existent link will be broken at some position.More specifically,   When a universe is created, it will manifest itself between any two adjacent universes or at one of the ends. Each position occurs with a probability of 1l+1.   When a link is broken, it could be cut between any two adjacent universes, each with a probability of 1l\xe2\x88\x921. After separating the multiverse into two segments, the segment NOT containing the Doctor will cease to exist. As earlier, the Doctor remains in the same universe. However, if at some point the multiverse breaks in such a way that the Doctor finds himself at the leftmost or rightmost end of it, the TARDIS stops functioning.In such a case, the Doctor must actually walk across the multiverse to find the tools to fix it.We are interested in the expected value of the length of the multiverse when such an event occurs." 3100
1184D1 "Parallel Universes (Easy)" implementation "The Third Doctor Who once correctly said that travel between parallel universes is ""like travelling sideways"". However, he incorrectly thought that there were infinite parallel universes, whereas in fact, as we now all know, there will never be more than 250.Heidi recently got her hands on a multiverse observation tool. She was able to see all n universes lined up in a row, with non-existent links between them. She also noticed that the Doctor was in the k-th universe.The tool also points out that due to restrictions originating from the space-time discontinuum, the number of universes will never exceed m.Obviously, the multiverse is unstable because of free will. Each time a decision is made, one of two events will randomly happen: a new parallel universe is created, or a non-existent link is broken.More specifically,   When a universe is created, it will manifest itself between any two adjacent universes or at one of the ends.   When a link is broken, it could be cut between any two adjacent universes. After separating the multiverse into two segments, the segment NOT containing the Doctor will cease to exist. Heidi wants to perform a simulation of t decisions. Each time a decision is made, Heidi wants to know the length of the multiverse (i.e. the number of universes), and the position of the Doctor." 1600
1184C3 "Heidi and the Turing Test (Hard)" NA "The Cybermen have again outwitted the Daleks! Unfortunately, this time the Daleks decided to abandon these tasks altogether, which means the Doctor has to deal with them.The Doctor can handle the Daleks on his own, but Heidi now has to make sure that the Cybermen are kept busy with this next task.There are k rings on a plane. For each ring, n points are uniformly sampled with a small random noise. The task is to recover the rings given only the noisy samples.The rings and the samples are generated as follows. The center of a ring is uniformly sampled from a disk of radius 1000000 centered at the origin, and the radius of the ring is uniformly sampled from [250000,750000]. Let R be a ring with center (x,y) and radius r. To sample a point from R, an angle \xce\xb8 is uniformly sampled from [0,2\xcf\x80] and a distance d is uniformly sampled from [0.9r,1.1r]. The coordinates of the sampled point are then (x+dcos(\xce\xb8),y+dsin(\xce\xb8)) rounded to the closest integers.The distance between rings is measured by their Hausdorff distance. In our case, the distance between two rings R1,R2 can be written as follow. Let d be the distance between the two centers and r1,r2 be the radii. Then the distance is dist(R1,R2)=max(min(d\xe2\x88\x92\xe2\x88\x92,d\xe2\x88\x92+),min(d+\xe2\x88\x92,d++),min(d\xe2\x88\x92\xe2\x88\x92,d+\xe2\x88\x92),min(d\xe2\x88\x92+,d++)), where d++=|d+r1+r2|, d+\xe2\x88\x92=|d+r1\xe2\x88\x92r2|, d\xe2\x88\x92+=|d\xe2\x88\x92r1+r2|, d\xe2\x88\x92\xe2\x88\x92=|d\xe2\x88\x92r1\xe2\x88\x92r2|.We say that a ring R0 is recovered if one of the rings R in the output has Hausdorff distance less than 100000 from R0. An output is accepted if all the rings are recovered. It is guaranteed that the distances between any two rings is greater than 600000.Remember that a human can very easily solve this task, so make sure that no human traitors are helping the Cybermen complete this task." 3200
1184C2 "Heidi and the Turing Test (Medium)" "data structures" "The Cybermen solved that first test much quicker than the Daleks. Luckily for us, the Daleks were angry (shocking!) and they destroyed some of the Cybermen.After the fighting stopped, Heidi gave them another task to waste their time on.There are n points on a plane. Given a radius r, find the maximum number of points that can be covered by an L1-ball with radius r.An L1-ball with radius r and center (x0,y0) in a 2D-plane is defined as the set of points (x,y) such that the Manhattan distance between (x0,y0) and (x,y) is at most r.Manhattan distance between (x0,y0) and (x,y) is defined as |x\xe2\x88\x92x0|+|y\xe2\x88\x92y0|." 2200
1184C1 "Heidi and the Turing Test (Easy)" implementation "The Cybermen and the Daleks have long been the Doctor\'s main enemies. Everyone knows that both these species enjoy destroying everything they encounter. However, a little-known fact about them is that they both also love taking Turing tests!Heidi designed a series of increasingly difficult tasks for them to spend their time on, which would allow the Doctor enough time to save innocent lives!The funny part is that these tasks would be very easy for a human to solve.The first task is as follows. There are some points on the plane. All but one of them are on the boundary of an axis-aligned square (its sides are parallel to the axes). Identify that point." 1600
1184B3 "The Doctor Meets Vader (Hard)" "flows,shortest paths" "The rebels have saved enough gold to launch a full-scale attack. Now the situation is flipped, the rebels will send out the spaceships to attack the Empire bases!The galaxy can be represented as an undirected graph with n planets (nodes) and m wormholes (edges), each connecting two planets.A total of s rebel spaceships and b empire bases are located at different planets in the galaxy.Each spaceship is given a location x, denoting the index of the planet on which it is located, an attacking strength a, a certain amount of fuel f, and a price to operate p.Each base is given a location x, a defensive strength d, and a certain amount of gold g.A spaceship can attack a base if both of these conditions hold:   the spaceship\'s attacking strength is greater or equal than the defensive strength of the base  the spaceship\'s fuel is greater or equal to the shortest distance, computed as the number of wormholes, between the spaceship\'s node and the base\'s node The rebels are very proud fighters. So, if a spaceship cannot attack any base, no rebel pilot will accept to operate it.If a spaceship is operated, the profit generated by that spaceship is equal to the gold of the base it attacks minus the price to operate the spaceship. Note that this might be negative. A spaceship that is operated will attack the base that maximizes its profit.Darth Vader likes to appear rich at all times. Therefore, whenever a base is attacked and its gold stolen, he makes sure to immediately refill that base with gold.Therefore, for the purposes of the rebels, multiple spaceships can attack the same base, in which case each spaceship will still receive all the gold of that base.The rebels have tasked Heidi and the Doctor to decide which set of spaceships to operate in order to maximize the total profit.However, as the war has been going on for a long time, the pilots have formed unbreakable bonds, and some of them refuse to operate spaceships if their friends are not also operating spaceships.They have a list of k dependencies of the form s1,s2, denoting that spaceship s1 can be operated only if spaceship s2 is also operated." 2700
1184B2 "The Doctor Meets Vader (Medium)" "flows,graph matchings,graphs,shortest paths,sortings" "Thanks to the Doctor\'s help, the rebels managed to steal enough gold to launch a full-scale attack on the Empire! However, Darth Vader is looking for revenge and wants to take back his gold.The rebels have hidden the gold in various bases throughout the galaxy. Darth Vader and the Empire are looking to send out their spaceships to attack these bases.The galaxy can be represented as an undirected graph with n planets (nodes) and m wormholes (edges), each connecting two planets.A total of s empire spaceships and b rebel bases are located at different planets in the galaxy.Each spaceship is given a location x, denoting the index of the planet on which it is located, an attacking strength a, and a certain amount of fuel f.Each base is given a location x, and a defensive strength d.A spaceship can attack a base if both of these conditions hold:   the spaceship\'s attacking strength is greater or equal than the defensive strength of the base  the spaceship\'s fuel is greater or equal to the shortest distance, computed as the number of wormholes, between the spaceship\'s planet and the base\'s planet Vader is very particular about his attacking formations. He requires that each spaceship is to attack at most one base and that each base is to be attacked by at most one spaceship.Vader knows that the rebels have hidden k gold in each base, so he will assign the spaceships to attack bases in such a way that maximizes the number of bases attacked.Therefore, for each base that is attacked, the rebels lose k gold.However, the rebels have the ability to create any number of dummy bases. With the Doctor\'s help, these bases would exist beyond space and time, so all spaceship can reach them and attack them. Moreover, a dummy base is designed to seem irresistible: that is, it will always be attacked by some spaceship.Of course, dummy bases do not contain any gold, but creating such a dummy base costs h gold.What is the minimum gold the rebels can lose if they create an optimal number of dummy bases?" 2200
1184B1 "The Doctor Meets Vader (Easy)" "binary search,sortings" "Heidi and Doctor Who hopped out of the TARDIS and found themselves at EPFL in 2018. They were surrounded by stormtroopers and Darth Vader was approaching. Miraculously, they managed to escape to a nearby rebel base but the Doctor was very confused. Heidi reminded him that last year\'s HC2 theme was Star Wars. Now he understood, and he\'s ready to face the evils of the Empire!The rebels have s spaceships, each with a certain attacking power a.They want to send their spaceships to destroy the empire bases and steal enough gold and supplies in order to keep the rebellion alive.The empire has b bases, each with a certain defensive power d, and a certain amount of gold g.A spaceship can attack all the bases which have a defensive power less than or equal to its attacking power.If a spaceship attacks a base, it steals all the gold in that base.The rebels are still undecided which spaceship to send out first, so they asked for the Doctor\'s help. They would like to know, for each spaceship, the maximum amount of gold it can steal." 1400
1184A3 "Heidi Learns Hashing (Hard)" "fft,math,number theory" "Now Heidi is ready to crack Madame Kovarian\'s hashing function.Madame Kovarian has a very strict set of rules for name changes. Two names can be interchanged only if using the following hashing function on them results in a collision. However, the hashing function is parametrized, so one can always find a set of parameters that causes such a collision. Heidi decided to exploit this to her advantage.Given two strings w1, w2 of equal length n consisting of lowercase English letters and an integer m.Consider the standard polynomial hashing function:Hp(w):=(\xe2\x88\x91|w|\xe2\x88\x921i=0wiri)mod(p)where p is some prime, and r is some number such that 2\xe2\x89\xa4r\xe2\x89\xa4p\xe2\x88\x922.The goal is to find r and a prime p (m\xe2\x89\xa4p\xe2\x89\xa4109) such that Hp(w1)=Hp(w2).Strings w1 and w2 are sampled independently at random from all strings of length n over lowercase English letters." 3100
1184A2 "Heidi Learns Hashing (Medium)" "brute force,number theory" "After learning about polynomial hashing, Heidi decided to learn about shift-xor hashing. In particular, she came across this interesting problem.Given a bitstring y\xe2\x88\x88{0,1}n find out the number of different k (0\xe2\x89\xa4k<n) such that there exists x\xe2\x88\x88{0,1}n for which y=x\xe2\x8a\x95shiftk(x).In the above, \xe2\x8a\x95 is the xor operation and shiftk is the operation of shifting a bitstring cyclically to the right k times. For example, 001\xe2\x8a\x95111=110 and shift3(00010010111000)=00000010010111." 2100
1184A1 "Heidi Learns Hashing (Easy)" "brute force,math,number theory" "Melody Pond was stolen from her parents as a newborn baby by Madame Kovarian, to become a weapon of the Silence in their crusade against the Doctor. Madame Kovarian changed Melody\'s name to River Song, giving her a new identity that allowed her to kill the Eleventh Doctor.Heidi figured out that Madame Kovarian uses a very complicated hashing function in order to change the names of the babies she steals. In order to prevent this from happening to future Doctors, Heidi decided to prepare herself by learning some basic hashing techniques.The first hashing function she designed is as follows.Given two positive integers (x,y) she defines H(x,y):=x2+2xy+x+1.Now, Heidi wonders if the function is reversible. That is, given a positive integer r, can you find a pair (x,y) (of positive integers) such that H(x,y)=r?If multiple such pairs exist, output the one with smallest possible x. If there is no such pair, output ""NO""." 1200
1183H "Subsequences (hard version)" dp,strings "The only difference between the easy and the hard versions is constraints.A subsequence is a string that can be derived from another string by deleting some or no symbols without changing the order of the remaining symbols. Characters to be deleted are not required to go successively, there can be any gaps between them. For example, for the string ""abaca"" the following strings are subsequences: ""abaca"", ""aba"", ""aaa"", ""a"" and """" (empty string). But the following strings are not subsequences: ""aabaca"", ""cb"" and ""bcaa"".You are given a string s consisting of n lowercase Latin letters.In one move you can take any subsequence t of the given string and add it to the set S. The set S can\'t contain duplicates. This move costs n\xe2\x88\x92|t|, where |t| is the length of the added subsequence (i.e. the price equals to the number of the deleted characters).Your task is to find out the minimum possible total cost to obtain a set S of size k or report that it is impossible to do so." 1900
1183G "Candy Box (hard version)" greedy,implementation,sortings "This problem is a version of problem D from the same contest with some additional constraints and tasks.There are n candies in a candy box. The type of the i-th candy is ai (1\xe2\x89\xa4ai\xe2\x89\xa4n). You have to prepare a gift using some of these candies with the following restriction: the numbers of candies of each type presented in a gift should be all distinct (i.\xe2\x80\x89e. for example, a gift having two candies of type 1 and two candies of type 2 is bad).It is possible that multiple types of candies are completely absent from the gift. It is also possible that not all candies of some types will be taken to a gift.You really like some of the candies and don\'t want to include them into the gift, but you want to eat them yourself instead. For each candy, a number fi is given, which is equal to 0 if you really want to keep i-th candy for yourself, or 1 if you don\'t mind including it into your gift. It is possible that two candies of the same type have different values of fi.You want your gift to be as large as possible, but you don\'t want to include too many of the candies you want to eat into the gift. So, you want to calculate the maximum possible number of candies that can be included into a gift, and among all ways to choose maximum number of candies, you want to maximize the number of candies having fi=1 in your gift.You have to answer q independent queries.If you are Python programmer, consider using PyPy instead of Python when you submit your code." 2000
1183F "Topforces Strikes Back" "brute force,math,sortings" "One important contest will take place on the most famous programming platform (Topforces) very soon!The authors have a pool of n problems and should choose at most three of them into this contest. The prettiness of the i-th problem is ai. The authors have to compose the most pretty contest (in other words, the cumulative prettinesses of chosen problems should be maximum possible).But there is one important thing in the contest preparation: because of some superstitions of authors, the prettinesses of problems cannot divide each other. In other words, if the prettinesses of chosen problems are x,y,z, then x should be divisible by neither y, nor z, y should be divisible by neither x, nor z and z should be divisible by neither x, nor y. If the prettinesses of chosen problems are x and y then neither x should be divisible by y nor y should be divisible by x. Any contest composed from one problem is considered good.Your task is to find out the maximum possible total prettiness of the contest composed of at most three problems from the given pool.You have to answer q independent queries.If you are Python programmer, consider using PyPy instead of Python when you submit your code." 2100
1183E "Subsequences (easy version)" "dp,graphs,implementation,shortest paths" "The only difference between the easy and the hard versions is constraints.A subsequence is a string that can be derived from another string by deleting some or no symbols without changing the order of the remaining symbols. Characters to be deleted are not required to go successively, there can be any gaps between them. For example, for the string ""abaca"" the following strings are subsequences: ""abaca"", ""aba"", ""aaa"", ""a"" and """" (empty string). But the following strings are not subsequences: ""aabaca"", ""cb"" and ""bcaa"".You are given a string s consisting of n lowercase Latin letters.In one move you can take any subsequence t of the given string and add it to the set S. The set S can\'t contain duplicates. This move costs n\xe2\x88\x92|t|, where |t| is the length of the added subsequence (i.e. the price equals to the number of the deleted characters).Your task is to find out the minimum possible total cost to obtain a set S of size k or report that it is impossible to do so." 2000
1183D "Candy Box (easy version)" greedy,sortings "This problem is actually a subproblem of problem G from the same contest.There are n candies in a candy box. The type of the i-th candy is ai (1\xe2\x89\xa4ai\xe2\x89\xa4n).You have to prepare a gift using some of these candies with the following restriction: the numbers of candies of each type presented in a gift should be all distinct (i.\xe2\x80\x89e. for example, a gift having two candies of type 1 and two candies of type 2 is bad). It is possible that multiple types of candies are completely absent from the gift. It is also possible that not all candies of some types will be taken to a gift.Your task is to find out the maximum possible size of the single gift you can prepare using the candies you have.You have to answer q independent queries.If you are Python programmer, consider using PyPy instead of Python when you submit your code." 1400
1183C "Computer Game" "binary search,math" "Vova is playing a computer game. There are in total n turns in the game and Vova really wants to play all of them. The initial charge of his laptop battery (i.e. the charge before the start of the game) is k.During each turn Vova can choose what to do:   If the current charge of his laptop battery is strictly greater than a, Vova can just play, and then the charge of his laptop battery will decrease by a;  if the current charge of his laptop battery is strictly greater than b (b<a), Vova can play and charge his laptop, and then the charge of his laptop battery will decrease by b;  if the current charge of his laptop battery is less than or equal to a and b at the same time then Vova cannot do anything and loses the game. Regardless of Vova\'s turns the charge of the laptop battery is always decreases.Vova wants to complete the game (Vova can complete the game if after each of n turns the charge of the laptop battery is strictly greater than 0). Vova has to play exactly n turns. Among all possible ways to complete the game, Vova wants to choose the one where the number of turns when he just plays (first type turn) is the maximum possible. It is possible that Vova cannot complete the game at all.Your task is to find out the maximum possible number of turns Vova can just play (make the first type turn) or report that Vova cannot complete the game.You have to answer q independent queries." 1400
1183B "Equalize Prices" math "There are n products in the shop. The price of the i-th product is ai. The owner of the shop wants to equalize the prices of all products. However, he wants to change prices smoothly.In fact, the owner of the shop can change the price of some product i in such a way that the difference between the old price of this product ai and the new price bi is at most k. In other words, the condition |ai\xe2\x88\x92bi|\xe2\x89\xa4k should be satisfied (|x| is the absolute value of x).He can change the price for each product not more than once. Note that he can leave the old prices for some products. The new price bi of each product i should be positive (i.e. bi>0 should be satisfied for all i from 1 to n).Your task is to find out the maximum possible equal price B of all productts with the restriction that for all products the condiion |ai\xe2\x88\x92B|\xe2\x89\xa4k should be satisfied (where ai is the old price of the product and B is the same new price of all products) or report that it is impossible to find such price B.Note that the chosen price B should be integer.You should answer q independent queries." 900
1183A "Nearest Interesting Number" implementation "Polycarp knows that if the sum of the digits of a number is divisible by 3, then the number itself is divisible by 3. He assumes that the numbers, the sum of the digits of which is divisible by 4, are also somewhat interesting. Thus, he considers a positive integer n interesting if its sum of digits is divisible by 4.Help Polycarp find the nearest larger or equal interesting number for the given number a. That is, find the interesting number n such that n\xe2\x89\xa5a and n is minimal." 800
1182F "Maximum Sine" "binary search,data structures,number theory" "You have given integers a, b, p, and q. Let f(x)=abs(sin(pq\xcf\x80x)).Find minimum possible integer x that maximizes f(x) where a\xe2\x89\xa4x\xe2\x89\xa4b." 2700
1182E "Product Oriented Recurrence" "dp,math,matrices,number theory" "Let fx=c2x\xe2\x88\x926\xe2\x8b\x85fx\xe2\x88\x921\xe2\x8b\x85fx\xe2\x88\x922\xe2\x8b\x85fx\xe2\x88\x923 for x\xe2\x89\xa54.You have given integers n, f1, f2, f3, and c. Find fnmod(109+7)." 2300
1182D "Complete Mirror" "constructive algorithms,dfs and similar,dp,hashing,implementation,trees" "You have given tree consist of n vertices. Select a vertex as root vertex that satisfies the condition below.  For all vertices v1 and v2, if distance(root, v1) =distance(root, v2) then degree(v1) =degree(v2), where degree means the number of vertices connected to that vertex, and distance means the number of edges between two vertices. Determine and find if there is such root vertex in the tree. If there are multiple answers, find any of them." 2400
1182C "Beautiful Lyrics" "data structures,greedy,strings" "You are given n words, each of which consists of lowercase alphabet letters. Each word contains at least one vowel. You are going to choose some of the given words and make as many beautiful lyrics as possible.Each lyric consists of two lines. Each line consists of two words separated by whitespace. A lyric is beautiful if and only if it satisfies all conditions below.   The number of vowels in the first word of the first line is the same as the number of vowels in the first word of the second line.  The number of vowels in the second word of the first line is the same as the number of vowels in the second word of the second line.  The last vowel of the first line is the same as the last vowel of the second line. Note that there may be consonants after the vowel. Also, letters ""a"", ""e"", ""o"", ""i"", and ""u"" are vowels. Note that ""y"" is never vowel.For example of a beautiful lyric,  ""hello hellooowww"" ""whatsup yowowowow""  is a beautiful lyric because there are two vowels each in ""hello"" and ""whatsup"", four vowels each in ""hellooowww"" and ""yowowowow"" (keep in mind that ""y"" is not a vowel), and the last vowel of each line is ""o"".For example of a not beautiful lyric,  ""hey man""""iam mcdic""  is not a beautiful lyric because ""hey"" and ""iam"" don\'t have same number of vowels and the last vowels of two lines are different (""a"" in the first and ""i"" in the second).How many beautiful lyrics can you write from given words? Note that you cannot use a word more times than it is given to you. For example, if a word is given three times, you can use it at most three times." 1700
1182B "Plus from Picture" "dfs and similar,implementation,strings" "You have a given picture with size w\xc3\x97h. Determine if the given picture has a single ""+"" shape or not. A ""+"" shape is described below:  A ""+"" shape has one center nonempty cell.  There should be some (at least one) consecutive non-empty cells in each direction (left, right, up, down) from the center. In other words, there should be a ray in each direction.  All other cells are empty. Find out if the given picture has single ""+"" shape." 1300
1182A "Filling Shapes" dp,math "You have a given integer n. Find the number of ways to fill all 3\xc3\x97n tiles with the shape described in the picture below. Upon filling, no empty spaces are allowed. Shapes cannot overlap.  This picture describes when n=4. The left one is the shape and the right one is 3\xc3\x97n tiles." 1000
1181E2 "A Story of One Country (Hard)" "brute force,greedy,sortings" "This problem differs from the previous problem only in constraints.Petya decided to visit Byteland during the summer holidays. It turned out that the history of this country is quite unusual.Initially, there were n different countries on the land that is now Berland. Each country had its own territory that was represented as a rectangle on the map. The sides of the rectangle were parallel to the axes, and the corners were located at points with integer coordinates. Territories of no two countries intersected, but it was possible that some territories touched each other. As time passed, sometimes two countries merged into one. It only happened if the union of their territories was also a rectangle. In the end only one country remainedÂ \xe2\x80\x94 Byteland.Initially, each country had a rectangular castle inside its territory. Its sides were parallel to the axes and its corners had integer coordinates. Some castles might touch the border of the corresponding country and sides or other castles. Miraculously, after all the unions the castles are still intact. Unfortunately, their locations are the only information we have to restore the initial territories of the countries.  The possible formation of Byteland. The castles are shown in blue. Petya wonders why no information about the initial countries remained. He suspected that the whole story is a fake. You were recommended to him as a smart person. Please check whether or not there exists a possible set of initial territories that could make the story true." 3000
1181E1 "A Story of One Country (Easy)" "brute force,divide and conquer,sortings" "This problem differs from the next problem only in constraints.Petya decided to visit Byteland during the summer holidays. It turned out that the history of this country is quite unusual.Initially, there were n different countries on the land that is now Berland. Each country had its own territory that was represented as a rectangle on the map. The sides of the rectangle were parallel to the axes, and the corners were located at points with integer coordinates. Territories of no two countries intersected, but it was possible that some territories touched each other. As time passed, sometimes two countries merged into one. It only happened if the union of their territories was also a rectangle. In the end only one country remainedÂ \xe2\x80\x94 Byteland.Initially, each country had a rectangular castle inside its territory. Its sides were parallel to the axes and its corners had integer coordinates. Some castles might touch the border of the corresponding country and sides or other castles. Miraculously, after all the unions the castles are still intact. Unfortunately, their locations are the only information we have to restore the initial territories of the countries.  The possible formation of Byteland. The castles are shown in blue. Petya wonders why no information about the initial countries remained. He suspected that the whole story is a fake. You were recommended to him as a smart person. Please check whether or not there exists a possible set of initial territories that could make the story true." 2500
1181D Irrigation "binary search,data structures,implementation,sortings,trees,two pointers" "Misha was interested in water delivery from childhood. That\'s why his mother sent him to the annual Innovative Olympiad in Irrigation (IOI). Pupils from all Berland compete there demonstrating their skills in watering. It is extremely expensive to host such an olympiad, so after the first n olympiads the organizers introduced the following rule of the host city selection.The host cities of the olympiads are selected in the following way. There are m cities in Berland wishing to host the olympiad, they are numbered from 1 to m. The host city of each next olympiad is determined as the city that hosted the olympiad the smallest number of times before. If there are several such cities, the city with the smallest index is selected among them.Misha\'s mother is interested where the olympiad will be held in some specific years. The only information she knows is the above selection rule and the host cities of the first n olympiads. Help her and if you succeed, she will ask Misha to avoid flooding your house." 2200
1181C Flag "brute force,combinatorics,dp,implementation" "Innokenty works at a flea market and sells some random stuff rare items. Recently he found an old rectangular blanket. It turned out that the blanket is split in n\xe2\x8b\x85m colored pieces that form a rectangle with n rows and m columns. The colored pieces attracted Innokenty\'s attention so he immediately came up with the following business plan. If he cuts out a subrectangle consisting of three colored stripes, he can sell it as a flag of some country. Innokenty decided that a subrectangle is similar enough to a flag of some country if it consists of three stripes of equal heights placed one above another, where each stripe consists of cells of equal color. Of course, the color of the top stripe must be different from the color of the middle stripe; and the color of the middle stripe must be different from the color of the bottom stripe.Innokenty has not yet decided what part he will cut out, but he is sure that the flag\'s boundaries should go along grid lines. Also, Innokenty won\'t rotate the blanket. Please help Innokenty and count the number of different subrectangles Innokenty can cut out and sell as a flag. Two subrectangles located in different places but forming the same flag are still considered different. Â Â These subrectangles are flags.  Â Â Â Â Â These subrectangles are not flags." 1900
1181B "Split a Number" greedy,implementation,strings "Dima worked all day and wrote down on a long paper strip his favorite number n consisting of l digits. Unfortunately, the strip turned out to be so long that it didn\'t fit in the Dima\'s bookshelf.To solve the issue, Dima decided to split the strip into two non-empty parts so that each of them contains a positive integer without leading zeros. After that he will compute the sum of the two integers and write it down on a new strip.Dima wants the resulting integer to be as small as possible, because it increases the chances that the sum will fit it in the bookshelf. Help Dima decide what is the minimum sum he can obtain." 1500
1181A Chunga-Changa greedy,math "Soon after the Chunga-Changa island was discovered, it started to acquire some forms of civilization and even market economy. A new currency arose, colloquially called ""chizhik"". One has to pay in chizhiks to buy a coconut now.Sasha and Masha are about to buy some coconuts which are sold at price z chizhiks per coconut. Sasha has x chizhiks, Masha has y chizhiks. Each girl will buy as many coconuts as she can using only her money. This way each girl will buy an integer non-negative number of coconuts.The girls discussed their plans and found that the total number of coconuts they buy can increase (or decrease) if one of them gives several chizhiks to the other girl. The chizhiks can\'t be split in parts, so the girls can only exchange with integer number of chizhiks.Consider the following example. Suppose Sasha has 5 chizhiks, Masha has 4 chizhiks, and the price for one coconut be 3 chizhiks. If the girls don\'t exchange with chizhiks, they will buy 1+1=2 coconuts. However, if, for example, Masha gives Sasha one chizhik, then Sasha will have 6 chizhiks, Masha will have 3 chizhiks, and the girls will buy 2+1=3 coconuts. It is not that easy to live on the island now, so Sasha and Mash want to exchange with chizhiks in such a way that they will buy the maximum possible number of coconuts. Nobody wants to have a debt, so among all possible ways to buy the maximum possible number of coconuts find such a way that minimizes the number of chizhiks one girl gives to the other (it is not important who will be the person giving the chizhiks)." 1000
1180B "Nick and Array" greedy,implementation "Nick had received an awesome array of integers a=[a1,a2,\xe2\x80\xa6,an] as a gift for his 5 birthday from his mother. He was already going to explore its various properties but after unpacking he was disappointed a lot because the product a1\xe2\x8b\x85a2\xe2\x8b\x85\xe2\x80\xa6an of its elements seemed to him not large enough.He was ready to throw out the array, but his mother reassured him. She told him, that array would not be spoiled after the following operation: choose any index i (1\xe2\x89\xa4i\xe2\x89\xa4n) and do ai:=\xe2\x88\x92ai\xe2\x88\x921.For example, he can change array [3,\xe2\x88\x921,\xe2\x88\x924,1] to an array [\xe2\x88\x924,\xe2\x88\x921,3,1] after applying this operation to elements with indices i=1 and i=3. Kolya had immediately understood that sometimes it\'s possible to increase the product of integers of the array a lot. Now he has decided that he wants to get an array with the maximal possible product of integers using only this operation with its elements (possibly zero, one or more times, as many as he wants), it is not forbidden to do this operation several times for the same index. Help Kolya and print the array with the maximal possible product of elements a1\xe2\x8b\x85a2\xe2\x8b\x85\xe2\x80\xa6an which can be received using only this operation in some order.If there are multiple answers, print any of them." 1500
1180A "Alex and a Rhombus" dp,implementation,math "While playing with geometric figures Alex has accidentally invented a concept of a n-th order rhombus in a cell grid.A 1-st order rhombus is just a square 1\xc3\x971 (i.e just a cell).A n-th order rhombus for all n\xe2\x89\xa52 one obtains from a n\xe2\x88\x921-th order rhombus adding all cells which have a common side with it to it (look at the picture to understand it better).  Alex asks you to compute the number of cells in a n-th order rhombus." 800
1179E "Alesya and Discrete Math" "divide and conquer,interactive" "We call a function good if its domain of definition is some set of integers and if in case it\'s defined in x and x\xe2\x88\x921, f(x)=f(x\xe2\x88\x921)+1 or f(x)=f(x\xe2\x88\x921).Tanya has found n good functions f1,\xe2\x80\xa6,fn, which are defined on all integers from 0 to 1018 and fi(0)=0 and fi(1018)=L for all i from 1 to n. It\'s an notorious coincidence that n is a divisor of L. She suggests Alesya a game. Using one question Alesya can ask Tanya a value of any single function in any single point. To win Alesya must choose integers li and ri (0\xe2\x89\xa4li\xe2\x89\xa4ri\xe2\x89\xa41018), such that fi(ri)\xe2\x88\x92fi(li)\xe2\x89\xa5Ln (here fi(x) means the value of i-th function at point x) for all i such that 1\xe2\x89\xa4i\xe2\x89\xa4n so that for any pair of two functions their segments [li,ri] don\'t intersect (but may have one common point).Unfortunately, Tanya doesn\'t allow to make more than 2\xe2\x8b\x85105 questions. Help Alesya to win!It can be proved that it\'s always possible to choose [li,ri] which satisfy the conditions described above.It\'s guaranteed, that Tanya doesn\'t change functions during the game, i.e. interactor is not adaptive" 3200
1179D "Fedor Runs for President" "data structures,dp,trees" "Fedor runs for president of Byteland! In the debates, he will be asked how to solve Byteland\'s transport problem. It\'s a really hard problem because of Byteland\'s transport system is now a tree (connected graph without cycles). Fedor\'s team has found out in the ministry of transport of Byteland that there is money in the budget only for one additional road. In the debates, he is going to say that he will build this road as a way to maximize the number of distinct simple paths in the country. A simple path is a path which goes through every vertex no more than once. Two simple paths are named distinct if sets of their edges are distinct. But Byteland\'s science is deteriorated, so Fedor\'s team hasn\'t succeeded to find any scientists to answer how many distinct simple paths they can achieve after adding exactly one edge on the transport system?Help Fedor to solve it.An edge can be added between vertices that are already connected, but it can\'t be a loop.In this problem, we consider only simple paths of length at least two." 2700
1179C "Serge and Dining Room" "binary search,data structures,graph matchings,greedy,implementation,math,trees" "Serge came to the school dining room and discovered that there is a big queue here. There are m pupils in the queue. He\'s not sure now if he wants to wait until the queue will clear, so he wants to know which dish he will receive if he does. As Serge is very tired, he asks you to compute it instead of him.Initially there are n dishes with costs a1,a2,\xe2\x80\xa6,an. As you already know, there are the queue of m pupils who have b1,\xe2\x80\xa6,bm togrogs respectively (pupils are enumerated by queue order, i.e the first pupil in the queue has b1 togrogs and the last one has bm togrogs)Pupils think that the most expensive dish is the most delicious one, so every pupil just buys the most expensive dish for which he has money (every dish has a single copy, so when a pupil has bought it nobody can buy it later), and if a pupil doesn\'t have money for any dish, he just leaves the queue (so brutal capitalism...)But money isn\'t a problem at all for Serge, so Serge is buying the most expensive dish if there is at least one remaining.Moreover, Serge\'s school has a very unstable economic situation and the costs of some dishes or number of togrogs of some pupils can change. More formally, you must process q queries:  change ai to x. It means that the price of the i-th dish becomes x togrogs.  change bi to x. It means that the i-th pupil in the queue has x togrogs now. Nobody leaves the queue during those queries because a saleswoman is late.After every query, you must tell Serge price of the dish which he will buy if he has waited until the queue is clear, or \xe2\x88\x921 if there are no dishes at this point, according to rules described above." 2200
1179B "Tolik and His Uncle" "constructive algorithms" "This morning Tolik has understood that while he was sleeping he had invented an incredible problem which will be a perfect fit for Codeforces! But, as a ""Discuss tasks"" project hasn\'t been born yet (in English, well), he decides to test a problem and asks his uncle.After a long time thinking, Tolik\'s uncle hasn\'t any ideas on how to solve it. But, he doesn\'t want to tell Tolik about his inability to solve it, so he hasn\'t found anything better than asking you how to solve this task.In this task you are given a cell field n\xe2\x8b\x85m, consisting of n rows and m columns, where point\'s coordinates (x,y) mean it is situated in the x-th row and y-th column, considering numeration from one (1\xe2\x89\xa4x\xe2\x89\xa4n,1\xe2\x89\xa4y\xe2\x89\xa4m). Initially, you stand in the cell (1,1). Every move you can jump from cell (x,y), which you stand in, by any non-zero vector (dx,dy), thus you will stand in the (x+dx,y+dy) cell. Obviously, you can\'t leave the field, but also there is one more important conditionÂ \xe2\x80\x94 you\'re not allowed to use one vector twice. Your task is to visit each cell of the field exactly once (the initial cell is considered as already visited).Tolik\'s uncle is a very respectful person. Help him to solve this task!" 1800
1179A "Valeriy and Deque" "data structures,implementation" "Recently, on the course of algorithms and data structures, Valeriy learned how to use a deque. He built a deque filled with n elements. The i-th element is ai (i = 1,2,\xe2\x80\xa6,n). He gradually takes the first two leftmost elements from the deque (let\'s call them A and B, respectively), and then does the following: if A>B, he writes A to the beginning and writes B to the end of the deque, otherwise, he writes to the beginning B, and A writes to the end of the deque. We call this sequence of actions an operation.For example, if deque was [2,3,4,5,1], on the operation he will write B=3 to the beginning and A=2 to the end, so he will get [3,4,5,1,2].The teacher of the course, seeing Valeriy, who was passionate about his work, approached him and gave him q queries. Each query consists of the singular number mj (j=1,2,\xe2\x80\xa6,q). It is required for each query to answer which two elements he will pull out on the mj-th operation.Note that the queries are independent and for each query the numbers A and B should be printed in the order in which they will be pulled out of the deque.Deque is a data structure representing a list of elements where insertion of new elements or deletion of existing elements can be made from both sides." 1500
1178H "Stock Exchange" "binary search,flows,graphs" "Warning: This problem has an unusual memory limit!Bob decided that he will not waste his prime years implementing GUI forms for a large corporation and instead will earn his supper on the Stock Exchange Reykjavik. The Stock Exchange Reykjavik is the only actual stock exchange in the world. The only type of transaction is to take a single share of stock x and exchange it for a single share of stock y, provided that the current price of share x is at least the current price of share y. There are 2n stocks listed on the SER that are of interest to Bob, numbered from 1 to 2n. Bob owns a single share of stocks 1 through n and would like to own a single share of each of n+1 through 2n some time in the future.Bob managed to forecast the price of each stockÂ \xe2\x80\x94 in time t\xe2\x89\xa50, the stock i will cost ai\xe2\x8b\x85\xe2\x8c\x8at\xe2\x8c\x8b+bi. The time is currently t=0. Help Bob find the earliest moment in time in which he can own a single share of each of n+1 through 2n, and the minimum number of stock exchanges he has to perform in order to do that.You may assume that the Stock Exchange has an unlimited amount of each stock at any point in time." 3500
1178G "The Awesomest Vertex" "data structures,dfs and similar" "You are given a rooted tree on n vertices. The vertices are numbered from 1 to n; the root is the vertex number 1.Each vertex has two integers associated with it: ai and bi. We denote the set of all ancestors of v (including v itself) by R(v). The awesomeness of a vertex v is defined as |\xe2\x88\x91w\xe2\x88\x88R(v)aw|\xe2\x8b\x85|\xe2\x88\x91w\xe2\x88\x88R(v)bw|,where |x| denotes the absolute value of x. Process q queries of one of the following forms:   1 v xÂ \xe2\x80\x94 increase av by a positive integer x.  2 vÂ \xe2\x80\x94 report the maximum awesomeness in the subtree of vertex v." 3000
1178F2 "Long Colorful Strip" dp "This is the second subtask of problem F. The only differences between this and the first subtask are the constraints on the value of m and the time limit. It is sufficient to solve this subtask in order to hack it, but you need to solve both subtasks in order to hack the first one.There are n+1 distinct colours in the universe, numbered 0 through n. There is a strip of paper m centimetres long initially painted with colour 0. Alice took a brush and painted the strip using the following process. For each i from 1 to n, in this order, she picks two integers 0\xe2\x89\xa4ai<bi\xe2\x89\xa4m, such that the segment [ai,bi] is currently painted with a single colour, and repaints it with colour i. Alice chose the segments in such a way that each centimetre is now painted in some colour other than 0. Formally, the segment [i\xe2\x88\x921,i] is painted with colour ci (ci\xe2\x89\xa00). Every colour other than 0 is visible on the strip.Count the number of different pairs of sequences {ai}ni=1, {bi}ni=1 that result in this configuration. Since this number may be large, output it modulo 998244353." 2600
1178F1 "Short Colorful Strip" "combinatorics,dfs and similar,dp" "This is the first subtask of problem F. The only differences between this and the second subtask are the constraints on the value of m and the time limit. You need to solve both subtasks in order to hack this one.There are n+1 distinct colours in the universe, numbered 0 through n. There is a strip of paper m centimetres long initially painted with colour 0. Alice took a brush and painted the strip using the following process. For each i from 1 to n, in this order, she picks two integers 0\xe2\x89\xa4ai<bi\xe2\x89\xa4m, such that the segment [ai,bi] is currently painted with a single colour, and repaints it with colour i. Alice chose the segments in such a way that each centimetre is now painted in some colour other than 0. Formally, the segment [i\xe2\x88\x921,i] is painted with colour ci (ci\xe2\x89\xa00). Every colour other than 0 is visible on the strip.Count the number of different pairs of sequences {ai}ni=1, {bi}ni=1 that result in this configuration. Since this number may be large, output it modulo 998244353." 2200
1178E Archaeology "brute force,constructive algorithms,greedy,strings" "Alice bought a Congo Prime Video subscription and was watching a documentary on the archaeological findings from Factor\'s Island on Loch Katrine in Scotland. The archaeologists found a book whose age and origin are unknown. Perhaps Alice can make some sense of it?The book contains a single string of characters ""a"", ""b"" and ""c"". It has been pointed out that no two consecutive characters are the same. It has also been conjectured that the string contains an unusually long subsequence that reads the same from both sides. Help Alice verify this by finding such subsequence that contains at least half of the characters of the original string, rounded down. Note that you don\'t have to maximise the length of it.A string a is a subsequence of a string b if a can be obtained from b by deletion of several (possibly, zero or all) characters." 1900
1178D "Prime Graph" "constructive algorithms,greedy,math,number theory" "Every person likes prime numbers. Alice is a person, thus she also shares the love for them. Bob wanted to give her an affectionate gift but couldn\'t think of anything inventive. Hence, he will be giving her a graph. How original, Bob! Alice will surely be thrilled!When building the graph, he needs four conditions to be satisfied:   It must be a simple undirected graph, i.e. without multiple (parallel) edges and self-loops.  The number of vertices must be exactly nÂ \xe2\x80\x94 a number he selected. This number is not necessarily prime.  The total number of edges must be prime.  The degree (i.e. the number of edges connected to the vertex) of each vertex must be prime. Below is an example for n=4. The first graph (left one) is invalid as the degree of vertex 2 (and 4) equals to 1, which is not prime. The second graph (middle one) is invalid as the total number of edges is 4, which is not a prime number. The third graph (right one) is a valid answer for n=4.   Note that the graph can be disconnected.Please help Bob to find any such graph!" 1500
1178C Tiles combinatorics,greedy,math "Bob is decorating his kitchen, more precisely, the floor. He has found a prime candidate for the tiles he will use. They come in a simple form factorÂ \xe2\x80\x94Â a square tile that is diagonally split into white and black part as depicted in the figure below.  The dimension of this tile is perfect for this kitchen, as he will need exactly w\xc3\x97h tiles without any scraps. That is, the width of the kitchen is w tiles, and the height is h tiles. As each tile can be rotated in one of four ways, he still needs to decide on how exactly he will tile the floor. There is a single aesthetic criterion that he wants to fulfil: two adjacent tiles must not share a colour on the edgeÂ \xe2\x80\x94Â i.e. one of the tiles must have a white colour on the shared border, and the second one must be black.  The picture on the left shows one valid tiling of a 3\xc3\x972 kitchen. The picture on the right shows an invalid arrangement, as the bottom two tiles touch with their white parts. Find the number of possible tilings. As this number may be large, output its remainder when divided by 998244353 (a prime number)." 1300
1178B "WOW Factor" dp,strings "Recall that string a is a subsequence of a string b if a can be obtained from b by deletion of several (possibly zero or all) characters. For example, for the string a=""wowwo"", the following strings are subsequences: ""wowwo"", ""wowo"", ""oo"", ""wow"", """", and others, but the following are not subsequences: ""owoo"", ""owwwo"", ""ooo"".The wow factor of a string is the number of its subsequences equal to the word ""wow"". Bob wants to write a string that has a large wow factor. However, the ""w"" key on his keyboard is broken, so he types two ""v""s instead. Little did he realise that he may have introduced more ""w""s than he thought. Consider for instance the string ""ww"". Bob would type it as ""vvvv"", but this string actually contains three occurrences of ""w"":   ""vvvv""  ""vvvv""  ""vvvv"" For example, the wow factor of the word ""vvvovvv"" equals to four because there are four wows:  ""vvvovvv""  ""vvvovvv""  ""vvvovvv""  ""vvvovvv"" Note that the subsequence ""vvvovvv"" does not count towards the wow factor, as the ""v""s have to be consecutive.For a given string s, compute and output its wow factor. Note that it is not guaranteed that it is possible to get s from another string replacing ""w"" with ""vv"". For example, s can be equal to ""vov""." 1300
1178A "Prime Minister" greedy "Alice is the leader of the State Refactoring Party, and she is about to become the prime minister. The elections have just taken place. There are n parties, numbered from 1 to n. The i-th party has received ai seats in the parliament.Alice\'s party has number 1. In order to become the prime minister, she needs to build a coalition, consisting of her party and possibly some other parties. There are two conditions she needs to fulfil:   The total number of seats of all parties in the coalition must be a strict majority of all the seats, i.e. it must have strictly more than half of the seats. For example, if the parliament has 200 (or 201) seats, then the majority is 101 or more seats.  Alice\'s party must have at least 2 times more seats than any other party in the coalition. For example, to invite a party with 50 seats, Alice\'s party must have at least 100 seats. For example, if n=4 and a=[51,25,99,25] (note that Alice\'a party has 51 seats), then the following set [a1=51,a2=25,a4=25] can create a coalition since both conditions will be satisfied. However, the following sets will not create a coalition:  [a2=25,a3=99,a4=25] since Alice\'s party is not there;  [a1=51,a2=25] since coalition should have a strict majority;  [a1=51,a2=25,a3=99] since Alice\'s party should have at least 2 times more seats than any other party in the coalition. Alice does not have to minimise the number of parties in a coalition. If she wants, she can invite as many parties as she wants (as long as the conditions are satisfied). If Alice\'s party has enough people to create a coalition on her own, she can invite no parties.Note that Alice can either invite a party as a whole or not at all. It is not possible to invite only some of the deputies (seats) from another party. In other words, if Alice invites a party, she invites all its deputies.Find and print any suitable coalition." 800
1177B "Digits Sequence (Hard Edition)" "binary search,divide and conquer,implementation" "Let\'s write all the positive integer numbers one after another from 1 without any delimiters (i.e. as a single string). It will be the infinite sequence starting with 123456789101112131415161718192021222324252627282930313233343536...Your task is to print the k-th digit of this sequence." 1800
1177A "Digits Sequence (Easy Edition)" implementation "Let\'s write all the positive integer numbers one after another from 1 without any delimiters (i.e. as a single string). It will be the infinite sequence starting with 123456789101112131415161718192021222324252627282930313233343536...Your task is to print the k-th digit of this sequence." 1000
1176F "Destroy it!" dp,implementation,sortings "You are playing a computer card game called Splay the Sire. Currently you are struggling to defeat the final boss of the game.The boss battle consists of n turns. During each turn, you will get several cards. Each card has two parameters: its cost ci and damage di. You may play some of your cards during each turn in some sequence (you choose the cards and the exact order they are played), as long as the total cost of the cards you play during the turn does not exceed 3. After playing some (possibly zero) cards, you end your turn, and all cards you didn\'t play are discarded. Note that you can use each card at most once.Your character has also found an artifact that boosts the damage of some of your actions: every 10-th card you play deals double damage.What is the maximum possible damage you can deal during n turns?" 2100
1176E "Cover it!" "dfs and similar,dsu,graphs,shortest paths,trees" "You are given an undirected unweighted connected graph consisting of n vertices and m edges. It is guaranteed that there are no self-loops or multiple edges in the given graph.Your task is to choose at most \xe2\x8c\x8an2\xe2\x8c\x8b vertices in this graph so each unchosen vertex is adjacent (in other words, connected by an edge) to at least one of chosen vertices.It is guaranteed that the answer exists. If there are multiple answers, you can print any.You will be given multiple independent queries to answer." 1700
1176D "Recover it!" "dfs and similar,graphs,greedy,number theory,sortings" "Authors guessed an array a consisting of n integers; each integer is not less than 2 and not greater than 2\xe2\x8b\x85105. You don\'t know the array a, but you know the array b which is formed from it with the following sequence of operations:  Firstly, let the array b be equal to the array a;  Secondly, for each i from 1 to n:   if ai is a prime number, then one integer pai is appended to array b, where p is an infinite sequence of prime numbers (2,3,5,\xe2\x80\xa6);  otherwise (if ai is not a prime number), the greatest divisor of ai which is not equal to ai is appended to b;   Then the obtained array of length 2n is shuffled and given to you in the input. Here pai means the ai-th prime number. The first prime p1=2, the second one is p2=3, and so on.Your task is to recover any suitable array a that forms the given array b. It is guaranteed that the answer exists (so the array b is obtained from some suitable array a). If there are multiple answers, you can print any." 1800
1176C "Lose it!" dp,greedy,implementation "You are given an array a consisting of n integers. Each ai is one of the six following numbers: 4,8,15,16,23,42.Your task is to remove the minimum number of elements to make this array good.An array of length k is called good if k is divisible by 6 and it is possible to split it into k6 subsequences 4,8,15,16,23,42.Examples of good arrays:  [4,8,15,16,23,42] (the whole array is a required sequence);  [4,8,4,15,16,8,23,15,16,42,23,42] (the first sequence is formed from first, second, fourth, fifth, seventh and tenth elements and the second one is formed from remaining elements);  [] (the empty array is good). Examples of bad arrays:   [4,8,15,16,42,23] (the order of elements should be exactly 4,8,15,16,23,42);  [4,8,15,16,23,42,4] (the length of the array is not divisible by 6);  [4,8,15,16,23,42,4,8,15,16,23,23] (the first sequence can be formed from first six elements but the remaining array cannot form the required sequence)." 1300
1176B "Merge it!" math "You are given an array a consisting of n integers a1,a2,\xe2\x80\xa6,an.In one operation you can choose two elements of the array and replace them with the element equal to their sum (it does not matter where you insert the new element). For example, from the array [2,1,4] you can obtain the following arrays: [3,4], [1,6] and [2,5].Your task is to find the maximum possible number of elements divisible by 3 that are in the array after performing this operation an arbitrary (possibly, zero) number of times.You have to answer t independent queries." 1100
1176A "Divide it!" "brute force,greedy,implementation" "You are given an integer n.You can perform any of the following operations with this number an arbitrary (possibly, zero) number of times:   Replace n with n2 if n is divisible by 2;  Replace n with 2n3 if n is divisible by 3;  Replace n with 4n5 if n is divisible by 5. For example, you can replace 30 with 15 using the first operation, with 20 using the second operation or with 24 using the third operation.Your task is to find the minimum number of moves required to obtain 1 from n or say that it is impossible to do it.You have to answer q independent queries." 800
1175G "Yet Another Partiton Problem" "data structures,divide and conquer,dp,geometry,two pointers" "You are given array a1,a2,\xe2\x80\xa6,an. You need to split it into k subsegments (so every element is included in exactly one subsegment).The weight of a subsegment al,al+1,\xe2\x80\xa6,ar is equal to (r\xe2\x88\x92l+1)\xe2\x8b\x85maxl\xe2\x89\xa4i\xe2\x89\xa4r(ai). The weight of a partition is a total weight of all its segments.Find the partition of minimal weight." 3000
1175F "The Number of Subpermutations" "brute force,data structures,divide and conquer,hashing,math" "You have an array a1,a2,\xe2\x80\xa6,an. Let\'s call some subarray al,al+1,\xe2\x80\xa6,ar of this array a subpermutation if it contains all integers from 1 to r\xe2\x88\x92l+1 exactly once. For example, array a=[2,2,1,3,2,3,1] contains 6 subarrays which are subpermutations: [a2\xe2\x80\xa6a3], [a2\xe2\x80\xa6a4], [a3\xe2\x80\xa6a3], [a3\xe2\x80\xa6a5], [a5\xe2\x80\xa6a7], [a7\xe2\x80\xa6a7].You are asked to calculate the number of subpermutations." 2500
1175E "Minimal Segment Cover" "data structures,dfs and similar,divide and conquer,dp,greedy,implementation,trees" "You are given n intervals in form [l;r] on a number line.You are also given m queries in form [x;y]. What is the minimal number of intervals you have to take so that every point (not necessarily integer) from x to y is covered by at least one of them? If you can\'t choose intervals so that every point from x to y is covered, then print -1 for that query." 2200
1175D "Array Splitting" greedy,sortings "You are given an array a1,a2,\xe2\x80\xa6,an and an integer k.You are asked to divide this array into k non-empty consecutive subarrays. Every element in the array should be included in exactly one subarray. Let f(i) be the index of subarray the i-th element belongs to. Subarrays are numbered from left to right and from 1 to k.Let the cost of division be equal to n\xe2\x88\x91i=1(ai\xe2\x8b\x85f(i)). For example, if a=[1,\xe2\x88\x922,\xe2\x88\x923,4,\xe2\x88\x925,6,\xe2\x88\x927] and we divide it into 3 subbarays in the following way: [1,\xe2\x88\x922,\xe2\x88\x923],[4,\xe2\x88\x925],[6,\xe2\x88\x927], then the cost of division is equal to 1\xe2\x8b\x851\xe2\x88\x922\xe2\x8b\x851\xe2\x88\x923\xe2\x8b\x851+4\xe2\x8b\x852\xe2\x88\x925\xe2\x8b\x852+6\xe2\x8b\x853\xe2\x88\x927\xe2\x8b\x853=\xe2\x88\x929.Calculate the maximum cost you can obtain by dividing the array a into k non-empty consecutive subarrays." 1900
1175C Electrification "binary search,brute force,greedy" "At first, there was a legend related to the name of the problem, but now it\'s just a formal statement.You are given n points a1,a2,\xe2\x80\xa6,an on the OX axis. Now you are asked to find such an integer point x on OX axis that fk(x) is minimal possible.The function fk(x) can be described in the following way:   form a list of distances d1,d2,\xe2\x80\xa6,dn where di=|ai\xe2\x88\x92x| (distance between ai and x);  sort list d in non-descending order;  take dk+1 as a result. If there are multiple optimal answers you can print any of them." 1600
1175B "Catch Overflow!" "data structures,expression parsing,implementation" "You are given a function f written in some basic language. The function accepts an integer value, which is immediately written into some variable x. x is an integer variable and can be assigned values from 0 to 232\xe2\x88\x921. The function contains three types of commands:  for n \xe2\x80\x94 for loop;  end \xe2\x80\x94 every command between ""for n"" and corresponding ""end"" is executed n times;  add \xe2\x80\x94 adds 1 to x. After the execution of these commands, value of x is returned.Every ""for n"" is matched with ""end"", thus the function is guaranteed to be valid. ""for n"" can be immediately followed by ""end"".""add"" command can be outside of any for loops.Notice that ""add"" commands might overflow the value of x! It means that the value of x becomes greater than 232\xe2\x88\x921 after some ""add"" command. Now you run f(0) and wonder if the resulting value of x is correct or some overflow made it incorrect.If overflow happened then output ""OVERFLOW!!!"", otherwise print the resulting value of x." 1600
1175A "From Hero to Zero" implementation,math "You are given an integer n and an integer k.In one step you can do one of the following moves:   decrease n by 1;  divide n by k if n is divisible by k. For example, if n=27 and k=3 you can do the following steps: 27\xe2\x86\x9226\xe2\x86\x9225\xe2\x86\x9224\xe2\x86\x928\xe2\x86\x927\xe2\x86\x926\xe2\x86\x922\xe2\x86\x921\xe2\x86\x920.You are asked to calculate the minimum number of steps to reach 0 from n." 900
1174F "Ehab and the Big Finale" "constructive algorithms,divide and conquer,graphs,implementation,interactive,trees" "This is an interactive problem.You\'re given a tree consisting of n nodes, rooted at node 1. A tree is a connected graph with no cycles.We chose a hidden node x. In order to find this node, you can ask queries of two types:   d u (1\xe2\x89\xa4u\xe2\x89\xa4n). We will answer with the distance between nodes u and x. The distance between two nodes is the number of edges in the shortest path between them.  s u (1\xe2\x89\xa4u\xe2\x89\xa4n). We will answer with the second node on the path from u to x. However, there\'s a plot twist. If u is not an ancestor of x, you\'ll receive ""Wrong answer"" verdict! Node a is called an ancestor of node b if a\xe2\x89\xa0b and the shortest path from node 1 to node b passes through node a. Note that in this problem a node is not an ancestor of itself.Can you find x in no more than 36 queries? The hidden node is fixed in each test beforehand and does not depend on your queries." 2400
1174E "Ehab and the Expected GCD Problem" "combinatorics,dp,math,number theory" "Let\'s define a function f(p) on a permutation p as follows. Let gi be the greatest common divisor (GCD) of elements p1, p2, ..., pi (in other words, it is the GCD of the prefix of length i). Then f(p) is the number of distinct elements among g1, g2, ..., gn.Let fmax(n) be the maximum value of f(p) among all permutations p of integers 1, 2, ..., n.Given an integers n, count the number of permutations p of integers 1, 2, ..., n, such that f(p) is equal to fmax(n). Since the answer may be large, print the remainder of its division by 1000000007=109+7." 2500
1174D "Ehab and the Expected XOR Problem" "bitmasks,constructive algorithms" "Given two integers n and x, construct an array that satisfies the following conditions:   for any element ai in the array, 1\xe2\x89\xa4ai<2n;  there is no non-empty subsegment with bitwise XOR equal to 0 or x,  its length l should be maximized. A sequence b is a subsegment of a sequence a if b can be obtained from a by deletion of several (possibly, zero or all) elements from the beginning and several (possibly, zero or all) elements from the end." 1900
1174C "Ehab and a Special Coloring Problem" "constructive algorithms,number theory" "You\'re given an integer n. For every integer i from 2 to n, assign a positive integer ai such that the following conditions hold:  For any pair of integers (i,j), if i and j are coprime, ai\xe2\x89\xa0aj.  The maximal value of all ai should be minimized (that is, as small as possible). A pair of integers is called coprime if their greatest common divisor is 1." 1300
1174B "Ehab Is an Odd Person" sortings "You\'re given an array a of length n. You can perform the following operation on it as many times as you want:  Pick two integers i and j (1\xe2\x89\xa4i,j\xe2\x89\xa4n) such that ai+aj is odd, then swap ai and aj. What is lexicographically the smallest array you can obtain?An array x is lexicographically smaller than an array y if there exists an index i such that xi<yi, and xj=yj for all 1\xe2\x89\xa4j<i. Less formally, at the first index i in which they differ, xi<yi" 1200
1174A "Ehab Fails to Be Thanos" "constructive algorithms,greedy,sortings" "You\'re given an array a of length 2n. Is it possible to reorder it in such way so that the sum of the first n elements isn\'t equal to the sum of the last n elements?" 1000
1173B "Nauuo and Chess" "constructive algorithms,greedy" "Nauuo is a girl who loves playing chess.One day she invented a game by herself which needs n chess pieces to play on a m\xc3\x97m chessboard. The rows and columns are numbered from 1 to m. We denote a cell on the intersection of the r-th row and c-th column as (r,c).The game\'s goal is to place n chess pieces numbered from 1 to n on the chessboard, the i-th piece lies on (ri,ci), while the following rule is satisfied: for all pairs of pieces i and j, |ri\xe2\x88\x92rj|+|ci\xe2\x88\x92cj|\xe2\x89\xa5|i\xe2\x88\x92j|. Here |x| means the absolute value of x.However, Nauuo discovered that sometimes she couldn\'t find a solution because the chessboard was too small.She wants to find the smallest chessboard on which she can put n pieces according to the rules.She also wonders how to place the pieces on such a chessboard. Can you help her?" 1100
1173A "Nauuo and Votes" greedy "Nauuo is a girl who loves writing comments.One day, she posted a comment on Codeforces, wondering whether she would get upvotes or downvotes.It\'s known that there were x persons who would upvote, y persons who would downvote, and there were also another z persons who would vote, but you don\'t know whether they would upvote or downvote. Note that each of the x+y+z people would vote exactly one time.There are three different results: if there are more people upvote than downvote, the result will be ""+""; if there are more people downvote than upvote, the result will be ""-""; otherwise the result will be ""0"".Because of the z unknown persons, the result may be uncertain (i.e. there are more than one possible results). More formally, the result is uncertain if and only if there exist two different situations of how the z persons vote, that the results are different in the two situations.Tell Nauuo the result or report that the result is uncertain." 800
1172F "Nauuo and Bug" "data structures" "Nauuo is a girl who loves coding.One day she was solving a problem which requires to calculate a sum of some numbers modulo p.She wrote the following code and got the verdict ""Wrong answer"".She soon discovered the bug \xe2\x80\x94 the ModAdd function only worked for numbers in the range [0,p), but the numbers in the problem may be out of the range. She was curious about the wrong function, so she wanted to know the result of it.However, the original code worked too slow, so she asked you to help her.You are given an array a1,a2,\xe2\x80\xa6,an and a number p. Nauuo will make m queries, in each query, you are given l and r, and you have to calculate the results of Sum(a,l,r,p). You can see the definition of the Sum function in the pseudocode above.Note that the integers won\'t overflow in the code above." 3300
1172E "Nauuo and ODT" "data structures" "Nauuo is a girl who loves traveling.One day she went to a tree, Old Driver Tree, literally, a tree with an old driver on it.The tree is a connected graph consisting of n nodes and n\xe2\x88\x921 edges. Each node has a color, and Nauuo will visit the ODT through a simple path on the tree in the old driver\'s car.Nauuo wants to visit see more different colors in her journey, but she doesn\'t know which simple path she will be traveling on. So, she wants to calculate the sum of the numbers of different colors on all different paths. Can you help her?What\'s more, the ODT is being redecorated, so there will be m modifications, each modification will change a single node\'s color. Nauuo wants to know the answer after each modification too.Note that in this problem, we consider the simple path from u to v and the simple path from v to u as two different simple paths if and only if u\xe2\x89\xa0v." 3300
1172D "Nauuo and Portals" "constructive algorithms" "Nauuo is a girl who loves playing games related to portals.One day she was playing a game as follows.In an n\xc3\x97n grid, the rows are numbered from 1 to n from top to bottom, the columns are numbered from 1 to n from left to right. We denote a cell on the intersection of the r-th row and c-th column as (r,c).A portal is a pair of doors. You can travel from one of them to another without changing your direction. More formally, if you walk into a cell with a door, you will teleport to the cell with the other door of the same portal and then walk into the next cell facing the original direction. There can not be more than one doors in a single cell.The ""next cell"" is the nearest cell in the direction you are facing. For example, if you are facing bottom, the next cell of (2,5) is (3,5).If you walk into a cell without a door, you must walk into the next cell after that without changing the direction. If the next cell does not exist, you must exit the grid.You have to set some (possibly zero) portals in the grid, so that if you walk into (i,1) facing right, you will eventually exit the grid from (ri,n), if you walk into (1,i) facing bottom, you will exit the grid from (n,ci).It is guaranteed that both r1..n and c1..n are permutations of n elements. A permutation of n elements is a sequence of numbers p1,p2,\xe2\x80\xa6,pn in which every integer from 1 to n appears exactly once.She got confused while playing the game, can you help her to find a solution?" 2900
1172C2 "Nauuo and Pictures (hard version)" dp,probabilities "The only difference between easy and hard versions is constraints.Nauuo is a girl who loves random picture websites.One day she made a random picture website by herself which includes n pictures.When Nauuo visits the website, she sees exactly one picture. The website does not display each picture with equal probability. The i-th picture has a non-negative weight wi, and the probability of the i-th picture being displayed is wi\xe2\x88\x91nj=1wj. That is to say, the probability of a picture to be displayed is proportional to its weight.However, Nauuo discovered that some pictures she does not like were displayed too often. To solve this problem, she came up with a great idea: when she saw a picture she likes, she would add 1 to its weight; otherwise, she would subtract 1 from its weight.Nauuo will visit the website m times. She wants to know the expected weight of each picture after all the m visits modulo 998244353. Can you help her?The expected weight of the i-th picture can be denoted by qipi where gcd(pi,qi)=1, you need to print an integer ri satisfying 0\xe2\x89\xa4ri<998244353 and ri\xe2\x8b\x85pi\xe2\x89\xa1qi(mod998244353). It can be proved that such ri exists and is unique." 2600
1172C1 "Nauuo and Pictures (easy version)" dp,probabilities "The only difference between easy and hard versions is constraints.Nauuo is a girl who loves random picture websites.One day she made a random picture website by herself which includes n pictures.When Nauuo visits the website, she sees exactly one picture. The website does not display each picture with equal probability. The i-th picture has a non-negative weight wi, and the probability of the i-th picture being displayed is wi\xe2\x88\x91nj=1wj. That is to say, the probability of a picture to be displayed is proportional to its weight.However, Nauuo discovered that some pictures she does not like were displayed too often. To solve this problem, she came up with a great idea: when she saw a picture she likes, she would add 1 to its weight; otherwise, she would subtract 1 from its weight.Nauuo will visit the website m times. She wants to know the expected weight of each picture after all the m visits modulo 998244353. Can you help her?The expected weight of the i-th picture can be denoted by qipi where gcd(pi,qi)=1, you need to print an integer ri satisfying 0\xe2\x89\xa4ri<998244353 and ri\xe2\x8b\x85pi\xe2\x89\xa1qi(mod998244353). It can be proved that such ri exists and is unique." 2300
1172B "Nauuo and Circle" "combinatorics,dfs and similar,dp,trees" "Nauuo is a girl who loves drawing circles.One day she has drawn a circle and wanted to draw a tree on it.The tree is a connected undirected graph consisting of n nodes and n\xe2\x88\x921 edges. The nodes are numbered from 1 to n.Nauuo wants to draw a tree on the circle, the nodes of the tree should be in n distinct points on the circle, and the edges should be straight without crossing each other.""Without crossing each other"" means that every two edges have no common point or the only common point is an endpoint of both edges.Nauuo wants to draw the tree using a permutation of n elements. A permutation of n elements is a sequence of integers p1,p2,\xe2\x80\xa6,pn in which every integer from 1 to n appears exactly once.After a permutation is chosen Nauuo draws the i-th node in the pi-th point on the circle, then draws the edges connecting the nodes.The tree is given, Nauuo wants to know how many permutations are there so that the tree drawn satisfies the rule (the edges are straight without crossing each other). She only wants to know the answer modulo 998244353, can you help her?It is obvious that whether a permutation is valid or not does not depend on which n points on the circle are chosen." 1900
1172A "Nauuo and Cards" greedy,implementation "Nauuo is a girl who loves playing cards.One day she was playing cards but found that the cards were mixed with some empty ones.There are n cards numbered from 1 to n, and they were mixed with another n empty cards. She piled up the 2n cards and drew n of them. The n cards in Nauuo\'s hands are given. The remaining n cards in the pile are also given in the order from top to bottom.In one operation she can choose a card in her hands and play it \xe2\x80\x94 put it at the bottom of the pile, then draw the top card from the pile.Nauuo wants to make the n numbered cards piled up in increasing order (the i-th card in the pile from top to bottom is the card i) as quickly as possible. Can you tell her the minimum number of operations?" 1800
1170I "Good Subsets" "*special problem,dp" "You are given n segments on the Ox axis. The i-th segment is given as a pair li,ri, where li is the position of the left end of the i-th segment and ri is the position of the right end of the i-th segment. Segments may intersect, overlap, or even coincide. A segment is a set of numbers (including floating-point numbers) lying between the segment ends or coinciding with them. Formally, the segment [l,r]={xÂ |Â x\xe2\x88\x88R,Â l\xe2\x89\xa4x\xe2\x89\xa4r}.Let the union of segments be the set of all axis points covered by the set of segments. Let\'s call a subset of the given segments good if its union equals the union of all n segments.Your task is to calculate the number of good subsets of the given n segments. Since the answer may be very large, print it modulo 998244353." -999
1170H "Longest Saw" "*special problem,constructive algorithms" "You are given the sequence a1,a2,\xe2\x80\xa6,an. You can choose any subset of elements and then reorder them to create a ""saw"".The sequence b1,b2,\xe2\x80\xa6,bm is called a ""saw"" if the elements satisfy one of the following series of inequalities: b1>b2<b3>b4<\xe2\x80\xa6 or b1<b2>b3<b4>\xe2\x80\xa6.Find the longest saw which can be obtained from a given array.Note that both the given sequence a and the required saw b can contain duplicated (non-unique) values." -999
1170G "Graph Decomposition" "*special problem,graphs" "You are given an undirected graph consisting of n vertices and m edges.Recall that a cycle is a path that starts and ends in the same vertex. A cycle in a graph is called simple if it contains each vertex (except the starting and ending one) no more than once (the starting and the ending one is contained always twice). Note that loops are considered to be simple cycles.In one move you can choose any simple cycle in this graph and erase the edges corresponding to this cycle (corresponding vertices remain in the graph). It is allowed to erase the loop or two copies of the same edge (take a look at examples).Your problem is to apply some sequence of moves to obtain the graph without edges. It is not necessary to minimize the number of cycles. If it is impossible, print ""NO""." -999
1170F Wheels "*special problem,binary search,greedy" "Polycarp has n wheels and a car with m slots for wheels. The initial pressure in the i-th wheel is ai.Polycarp\'s goal is to take exactly m wheels among the given n wheels and equalize the pressure in them (then he can put these wheels in a car and use it for driving). In one minute he can decrease or increase the pressure in any (single) wheel by 1. He can increase the pressure no more than k times in total because it is hard to pump up wheels.Help Polycarp and say what is the minimum number of minutes he needs to spend to equalize the pressure of at least m wheels among the given n wheels." -999
1170E "Sliding Doors" "*special problem,binary search" "Imagine that you are the CEO of a big old-fashioned company. Unlike any modern and progressive company (such as JetBrains), your company has a dress code. That\'s why you have already allocated a spacious room for your employees where they can change their clothes. Moreover, you\'ve already purchased an m-compartment wardrobe, so the i-th employee can keep his/her belongings in the i-th cell (of course, all compartments have equal widths).The issue has occurred: the wardrobe has sliding doors! More specifically, the wardrobe has n doors (numbered from left to right) and the j-th door has width equal to aj wardrobe\'s cells. The wardrobe has single rails so that no two doors can slide past each other.  Extremely schematic example of a wardrobe: m=9, n=2, a1=2, a2=3. The problem is as follows: sometimes to open some cells you must close some other cells (since all doors are placed on the single track). For example, if you have a 4-compartment wardrobe (i.e. m=4) with n=2 one-cell doors (i.e. a1=a2=1) and you need to open the 1-st and the 3-rd cells, you have to close the 2-nd and the 4-th cells.As CEO, you have a complete schedule for the next q days. Now you are wondering: is it possible that all employees who will come on the k-th day can access their cells simultaneously?" -999
1170D "Decoding of Integer Sequences" "*special problem,data structures,implementation" "Polycarp is developing a method for transmitting n integer sequences over a network. This method should support the transmission of an arbitrary number of integer sequences; sequences can have different lengths. The sequences contain arbitrary non-negative integers.Polycarp developed the following encoding procedure:  We assume that the sequences are numbered from 1 to n.  We add a special terminating marker to each sequence at the end, an element equal to -1.  The encoding result is a new single sequence that contains all the elements of the specified n in a special order: first, add to the result of coding all the first elements of the sequences (in the order from the 1-st to the n-th), then all the second elements (in the order from the 1-st to the n-th) and so on, if the sequence does not have the corresponding element, then it is simply skipped. The process ends when all elements of all sequences are added. For example, if you want to encode three sequences [3,1,4], [2,7] and [1,2,3,4], then the sequence of actions will be as follows:  we modify all three sequences by appending -1: [3,1,4,\xe2\x88\x921], [2,7,\xe2\x88\x921] and [1,2,3,4,\xe2\x88\x921];  we write out all the first elements, we get [3,2,1];  then write down all the second elements, we get [3,2,1,1,7,2];  then write down all the third elements, we get [3,2,1,1,7,2,4,\xe2\x88\x921,3];  then write down all fourth elements, get [3,2,1,1,7,2,4,\xe2\x88\x921,3,\xe2\x88\x921,4] (note that the second sequence has already ended);  then write down all the fifth elements, we get [3,2,1,1,7,2,4,\xe2\x88\x921,3,\xe2\x88\x921,4,\xe2\x88\x921] (note that the first and second sequences have already ended);  all the sequences are ended now, and the encoding process is finished;  the encoding result is: [3,2,1,1,7,2,4,\xe2\x88\x921,3,\xe2\x88\x921,4,\xe2\x88\x921]. Your task is to implement decoding by a given encoding result." -999
1170C "Minus and Minus Give Plus" "*special problem,implementation,strings" "Everyone knows that two consecutive (adjacent) ""minus"" signs can be replaced with a single ""plus"" sign.You are given the string s, consisting of ""plus"" and ""minus"" signs only. Zero or more operations can be performed with it. In each operation you can choose any two adjacent ""minus"" signs, and replace them with a single ""plus"" sign. Thus, in one operation, the length of the string is reduced by exactly 1.You are given two strings s and t. Determine if you can use 0 or more operations to get the string t from the string s." -999
1170B "Bad Days" "*special problem,implementation" "Every day Kotlin heroes analyze the statistics of their website. For n days, they wrote out n numbers a1,a2,\xe2\x80\xa6,an, where ai is the number of visits on the i-th day.They believe that a day is bad if there are at least 2 days before it with a strictly greater number of visits. For example, if n=8 and a=[3,1,4,1,5,9,2,6], then the day 4 is bad (because a4=1, but there are a1=3 and a3=4). Also, the day with the number 7 is bad too.Write a program that finds the number of bad days." -999
1170A "Three Integers Again" "*special problem,math" "We have three positive integers a, b and c. You don\'t know their values, but you know some information about them. Consider all three pairwise sums, i.e. the numbers a+b, a+c and b+c. You know exactly two (any) of three pairwise sums.Your task is to find such three positive integers a, b and c which match the given information. It means that if you consider a+b, a+c and b+c, two out of all three of them are given in the input. Among all such triples, you must choose one with the minimum possible sum a+b+c, and among all triples with the minimum sum, you can print any.You have to process q independent queries." -999
1169B Pairs graphs,implementation "Toad Ivan has m pairs of integers, each integer is between 1 and n, inclusive. The pairs are (a1,b1),(a2,b2),\xe2\x80\xa6,(am,bm). He asks you to check if there exist two integers x and y (1\xe2\x89\xa4x<y\xe2\x89\xa4n) such that in each given pair at least one integer is equal to x or y." 1500
1169A "Circle Metro" implementation,math "The circle line of the Roflanpolis subway has n stations.There are two parallel routes in the subway. The first one visits stations in order 1\xe2\x86\x922\xe2\x86\x92\xe2\x80\xa6\xe2\x86\x92n\xe2\x86\x921\xe2\x86\x922\xe2\x86\x92\xe2\x80\xa6 (so the next stop after station x is equal to (x+1) if x<n and 1 otherwise). The second route visits stations in order n\xe2\x86\x92(n\xe2\x88\x921)\xe2\x86\x92\xe2\x80\xa6\xe2\x86\x921\xe2\x86\x92n\xe2\x86\x92(n\xe2\x88\x921)\xe2\x86\x92\xe2\x80\xa6 (so the next stop after station x is equal to (x\xe2\x88\x921) if x>1 and n otherwise). All trains depart their stations simultaneously, and it takes exactly 1 minute to arrive at the next station.Two toads live in this city, their names are Daniel and Vlad.Daniel is currently in a train of the first route at station a and will exit the subway when his train reaches station x.Coincidentally, Vlad is currently in a train of the second route at station b and he will exit the subway when his train reaches station y.Surprisingly, all numbers a,x,b,y are distinct.Toad Ilya asks you to check if Daniel and Vlad will ever be at the same station at the same time during their journey. In other words, check if there is a moment when their trains stop at the same station. Note that this includes the moments when Daniel or Vlad enter or leave the subway." 900
1168E "Xor Permutations" "constructive algorithms,math" "Toad Mikhail has an array of 2k integers a1,a2,\xe2\x80\xa6,a2k.Find two permutations p and q of integers 0,1,\xe2\x80\xa6,2k\xe2\x88\x921, such that ai is equal to pi\xe2\x8a\x95qi for all possible i, or determine there are no such permutations. Here \xe2\x8a\x95 denotes the bitwise XOR operation." 3100
1168D "Anagram Paths" dp,implementation,trees "Toad Ilya has a rooted binary tree with vertex 1 being the root. A tree is a connected graph without cycles. A tree is rooted if one vertex is selected and called the root. A vertex u is a child of a vertex v if u and v are connected by an edge and v is closer to the root than u. A leaf is a non-root vertex that has no children.In the tree Ilya has each vertex has at most two children, and each edge has some character written on it. The character can be a lowercase English letter or the question mark \'?\'.Ilya will q times update the tree a bit. Each update will replace exactly one character on some edge. After each update Ilya needs to find if the tree is anagrammable and if yes, find its anagramnity for each letter. Well, that\'s difficult to explain, but we\'ll try.To start with, a string a is an anagram of a string b if it is possible to rearrange letters in a (without changing the letters itself) so that it becomes b. For example, the string ""fortyfive"" is an anagram of the string ""overfifty"", but the string ""aabb"" is not an anagram of the string ""bbba"".Consider a path from the root of the tree to a leaf. The characters on the edges on this path form a string, we say that this string is associated with this leaf. The tree is anagrammable if and only if it is possible to replace each question mark with a lowercase English letter so that for all pair of leaves the associated strings for these leaves are anagrams of each other.If the tree is anagrammable, then its anagramnity for the letter c is the maximum possible number of letters c in a string associated with some leaf in a valid replacement of all question marks.Please after each update find if the tree is anagrammable and if yes, find the \xe2\x88\x91f(c)\xe2\x8b\x85ind(c) for all letters c, where f(c) is the anagramnity for the letter c, and ind(x) is the index of this letter in the alphabet (ind(""a"")=1, ind(""b"")=2, ..., ind(""z"")=26)." 3000
1168C "And Reachability" bitmasks,dp "Toad Pimple has an array of integers a1,a2,\xe2\x80\xa6,an.We say that y is reachable from x if x<y and there exists an integer array p such that x=p1<p2<\xe2\x80\xa6<pk=y, and api&api+1>0 for all integers i such that 1\xe2\x89\xa4i<k.Here & denotes the bitwise AND operation.You are given q pairs of indices, check reachability for each of them." 2200
1168B "Good Triple" "brute force,two pointers" "Toad Rash has a binary string s. A binary string consists only of zeros and ones.Let n be the length of s.Rash needs to find the number of such pairs of integers l, r that 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n and there is at least one pair of integers x, k such that 1\xe2\x89\xa4x,k\xe2\x89\xa4n, l\xe2\x89\xa4x<x+2k\xe2\x89\xa4r, and sx=sx+k=sx+2k.Find this number of pairs for Rash." 1900
1168A "Increasing by Modulo" "binary search,greedy" "Toad Zitz has an array of integers, each integer is between 0 and m\xe2\x88\x921 inclusive. The integers are a1,a2,\xe2\x80\xa6,an.In one operation Zitz can choose an integer k and k indices i1,i2,\xe2\x80\xa6,ik such that 1\xe2\x89\xa4i1<i2<\xe2\x80\xa6<ik\xe2\x89\xa4n. He should then change aij to ((aij+1)modm) for each chosen integer ij. The integer m is fixed for all operations and indices.Here xmody denotes the remainder of the division of x by y.Zitz wants to make his array non-decreasing with the minimum number of such operations. Find this minimum number of operations." 1700
1167G "Low Budget Inception" "brute force,geometry" "So we got bored and decided to take our own guess at how would ""Inception"" production go if the budget for the film had been terribly low.The first scene we remembered was the one that features the whole city bending onto itself:  It feels like it will require high CGI expenses, doesn\'t it? Luckily, we came up with a similar-looking scene which was a tiny bit cheaper to make.Firstly, forget about 3D, that\'s hard and expensive! The city is now represented as a number line (infinite to make it easier, of course).Secondly, the city doesn\'t have to look natural at all. There are nn buildings on the line. Each building is a square 1\xc3\x9711\xc3\x971. Buildings are numbered from 11 to nn in ascending order of their positions. Lower corners of building ii are at integer points aiai and ai+1ai+1 of the number line. Also the distance between any two neighbouring buildings ii and i+1i+1 doesn\'t exceed dd (really, this condition is here just to make the city look not that sparse). Distance between some neighbouring buildings ii and i+1i+1 is calculated from the lower right corner of building ii to the lower left corner of building i+1i+1.Finally, curvature of the bend is also really hard to simulate! Let the bend at some integer coordinate xx be performed with the following algorithm. Take the ray from xx to +\xe2\x88\x9e+\xe2\x88\x9e and all the buildings which are on this ray and start turning the ray and the buildings counter-clockwise around point xx. At some angle some building will touch either another building or a part of the line. You have to stop bending there (implementing buildings crushing is also not worth its money). Let\'s call the angle between two rays in the final state the terminal angle \xce\xb1x\xce\xb1x.The only thing left is to decide what integer point xx is the best to start bending around. Fortunately, we\'ve already chosen mm candidates to perform the bending.So, can you please help us to calculate terminal angle \xce\xb1x\xce\xb1x for each bend xx from our list of candidates?" 3100
1167F "Scalar Queries" "combinatorics,data structures,math,sortings" "You are given an array a1,a2,\xe2\x80\xa6,an. All ai are pairwise distinct.Let\'s define function f(l,r) as follows:   let\'s define array b1,b2,\xe2\x80\xa6,br\xe2\x88\x92l+1, where bi=al\xe2\x88\x921+i;  sort array b in increasing order;  result of the function f(l,r) is r\xe2\x88\x92l+1\xe2\x88\x91i=1bi\xe2\x8b\x85i. Calculate (\xe2\x88\x911\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4nf(l,r))mod(109+7), i.e. total sum of f for all subsegments of a modulo 109+7." 2300
1167E "Range Deleting" "binary search,combinatorics,data structures,two pointers" "You are given an array consisting of n integers a1,a2,\xe2\x80\xa6,an and an integer x. It is guaranteed that for every i, 1\xe2\x89\xa4ai\xe2\x89\xa4x.Let\'s denote a function f(l,r) which erases all values such that l\xe2\x89\xa4ai\xe2\x89\xa4r from the array a and returns the resulting array. For example, if a=[4,1,1,4,5,2,4,3], then f(2,4)=[1,1,5].Your task is to calculate the number of pairs (l,r) such that 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4x and f(l,r) is sorted in non-descending order. Note that the empty array is also considered sorted." 2100
1167D "Bicolored RBS" "constructive algorithms,greedy" "A string is called bracket sequence if it does not contain any characters other than ""("" and "")"". A bracket sequence is called regular (shortly, RBS) if it is possible to obtain correct arithmetic expression by inserting characters ""+"" and ""1"" into this sequence. For example, """", ""(())"" and ""()()"" are RBS and "")("" and ""(()"" are not.We can see that each opening bracket in RBS is paired with some closing bracket, and, using this fact, we can define nesting depth of the RBS as maximum number of bracket pairs, such that the 2-nd pair lies inside the 1-st one, the 3-rd one \xe2\x80\x94 inside the 2-nd one and so on. For example, nesting depth of """" is 0, ""()()()"" is 1 and ""()((())())"" is 3.Now, you are given RBS s of even length n. You should color each bracket of s into one of two colors: red or blue. Bracket sequence r, consisting only of red brackets, should be RBS, and bracket sequence, consisting only of blue brackets b, should be RBS. Any of them can be empty. You are not allowed to reorder characters in s, r or b. No brackets can be left uncolored.Among all possible variants you should choose one that minimizes maximum of r\'s and b\'s nesting depth. If there are multiple solutions you can print any of them." 1500
1167C "News Distribution" "dfs and similar,dsu,graphs" "In some social network, there are n users communicating with each other in m groups of friends. Let\'s analyze the process of distributing some news between users.Initially, some user x receives the news from some source. Then he or she sends the news to his or her friends (two users are friends if there is at least one group such that both of them belong to this group). Friends continue sending the news to their friends, and so on. The process ends when there is no pair of friends such that one of them knows the news, and another one doesn\'t know.For each user x you have to determine what is the number of users that will know the news if initially only user x starts distributing it." 1400
1167B "Lost Numbers" "brute force,divide and conquer,interactive,math" "This is an interactive problem. Remember to flush your output while communicating with the testing program. You may use fflush(stdout) in C++, system.out.flush() in Java, stdout.flush() in Python or flush(output) in Pascal to flush the output. If you use some other programming language, consult its documentation. You may also refer to the guide on interactive problems: https://codeforces.com/blog/entry/45307.The jury guessed some array a consisting of 6 integers. There are 6 special numbers \xe2\x80\x94 4, 8, 15, 16, 23, 42 \xe2\x80\x94 and each of these numbers occurs in a exactly once (so, a is some permutation of these numbers).You don\'t know anything about their order, but you are allowed to ask up to 4 queries. In each query, you may choose two indices i and j (1\xe2\x89\xa4i,j\xe2\x89\xa46, i and j are not necessarily distinct), and you will get the value of ai\xe2\x8b\x85aj in return.Can you guess the array a?The array a is fixed beforehand in each test, the interaction program doesn\'t try to adapt to your queries." 1400
1167A "Telephone Number" "brute force,greedy,strings" "A telephone number is a sequence of exactly 11 digits, where the first digit is 8. For example, the sequence 80011223388 is a telephone number, but the sequences 70011223388 and 80000011223388 are not.You are given a string s of length n, consisting of digits.In one operation you can delete any character from string s. For example, it is possible to obtain strings 112, 111 or 121 from string 1121.You need to determine whether there is such a sequence of operations (possibly empty), after which the string s becomes a telephone number." 800
1166F "Vicky\'s Delivery Service" "data structures,dsu,graphs,hashing" "In a magical land there are n cities conveniently numbered 1,2,\xe2\x80\xa6,n. Some pairs of these cities are connected by magical colored roads. Magic is unstable, so at any time, new roads may appear between two cities.Vicky the witch has been tasked with performing deliveries between some pairs of cities. However, Vicky is a beginner, so she can only complete a delivery if she can move from her starting city to her destination city through a double rainbow. A double rainbow is a sequence of cities c1,c2,\xe2\x80\xa6,ck satisfying the following properties:  For each i with 1\xe2\x89\xa4i\xe2\x89\xa4k\xe2\x88\x921, the cities ci and ci+1 are connected by a road.  For each i with 1\xe2\x89\xa4i\xe2\x89\xa4k\xe2\x88\x9212, the roads connecting c2i with c2i\xe2\x88\x921 and c2i+1 have the same color. For example if k=5, the road between c1 and c2 must be the same color as the road between c2 and c3, and the road between c3 and c4 must be the same color as the road between c4 and c5.Vicky has a list of events in chronological order, where each event is either a delivery she must perform, or appearance of a new road. Help her determine which of her deliveries she will be able to complete." 2400
1166E "The LCMs Must be Large" "bitmasks,brute force,constructive algorithms,math,number theory" "Dora the explorer has decided to use her money after several years of juicy royalties to go shopping. What better place to shop than Nlogonia?There are n stores numbered from 1 to n in Nlogonia. The i-th of these stores offers a positive integer ai.Each day among the last m days Dora bought a single integer from some of the stores. The same day, Swiper the fox bought a single integer from all the stores that Dora did not buy an integer from on that day.Dora considers Swiper to be her rival, and she considers that she beat Swiper on day i if and only if the least common multiple of the numbers she bought on day i is strictly greater than the least common multiple of the numbers that Swiper bought on day i.The least common multiple (LCM) of a collection of integers is the smallest positive integer that is divisible by all the integers in the collection.However, Dora forgot the values of ai. Help Dora find out if there are positive integer values of ai such that she beat Swiper on every day. You don\'t need to find what are the possible values of ai though.Note that it is possible for some values of ai to coincide in a solution." 2100
1166D "Cute Sequences" "binary search,brute force,greedy,math" "Given a positive integer m, we say that a sequence x1,x2,\xe2\x80\xa6,xn of positive integers is m-cute if for every index i such that 2\xe2\x89\xa4i\xe2\x89\xa4n it holds that xi=xi\xe2\x88\x921+xi\xe2\x88\x922+\xe2\x8b\xaf+x1+ri for some positive integer ri satisfying 1\xe2\x89\xa4ri\xe2\x89\xa4m.You will be given q queries consisting of three positive integers a, b and m. For each query you must determine whether or not there exists an m-cute sequence whose first term is a and whose last term is b. If such a sequence exists, you must additionally find an example of it." 2200
1166C "A Tale of Two Lands" "binary search,sortings,two pointers" "The legend of the foundation of Vectorland talks of two integers x and y. Centuries ago, the array king placed two markers at points |x| and |y| on the number line and conquered all the land in between (including the endpoints), which he declared to be Arrayland. Many years later, the vector king placed markers at points |x\xe2\x88\x92y| and |x+y| and conquered all the land in between (including the endpoints), which he declared to be Vectorland. He did so in such a way that the land of Arrayland was completely inside (including the endpoints) the land of Vectorland.Here |z| denotes the absolute value of z.Now, Jose is stuck on a question of his history exam: ""What are the values of x and y?"" Jose doesn\'t know the answer, but he believes he has narrowed the possible answers down to n integers a1,a2,\xe2\x80\xa6,an. Now, he wants to know the number of unordered pairs formed by two different elements from these n integers such that the legend could be true if x and y were equal to these two values. Note that it is possible that Jose is wrong, and that no pairs could possibly make the legend true." 1500
1166B "All the Vowels Please" "constructive algorithms,math,number theory" "Tom loves vowels, and he likes long words with many vowels. His favorite words are vowelly words. We say a word of length k is vowelly if there are positive integers n and m such that n\xe2\x8b\x85m=k and when the word is written by using n rows and m columns (the first row is filled first, then the second and so on, with each row filled from left to right), every vowel of the English alphabet appears at least once in every row and every column.You are given an integer k and you must either print a vowelly word of length k or print \xe2\x88\x921 if no such word exists.In this problem the vowels of the English alphabet are \'a\', \'e\', \'i\', \'o\' ,\'u\'." 1100
1166A "Silent Classroom" combinatorics,greedy "There are n students in the first grade of Nlogonia high school. The principal wishes to split the students into two classrooms (each student must be in exactly one of the classrooms). Two distinct students whose name starts with the same letter will be chatty if they are put in the same classroom (because they must have a lot in common). Let x be the number of such pairs of students in a split. Pairs (a,b) and (b,a) are the same and counted only once.For example, if there are 6 students: ""olivia"", ""jacob"", ""tanya"", ""jack"", ""oliver"" and ""jessica"", then:  splitting into two classrooms (""jack"", ""jacob"", ""jessica"", ""tanya"") and (""olivia"", ""oliver"") will give x=4 (3 chatting pairs in the first classroom, 1 chatting pair in the second classroom),  splitting into two classrooms (""jack"", ""tanya"", ""olivia"") and (""jessica"", ""oliver"", ""jacob"") will give x=1 (0 chatting pairs in the first classroom, 1 chatting pair in the second classroom). You are given the list of the n names. What is the minimum x we can obtain by splitting the students into classrooms?Note that it is valid to place all of the students in one of the classrooms, leaving the other one empty." 900
1165F2 "Microtransactions (hard version)" "binary search,greedy,implementation" "The only difference between easy and hard versions is constraints.Ivan plays a computer game that contains some microtransactions to make characters look cooler. Since Ivan wants his character to be really cool, he wants to use some of these microtransactions \xe2\x80\x94 and he won\'t start playing until he gets all of them.Each day (during the morning) Ivan earns exactly one burle.There are n types of microtransactions in the game. Each microtransaction costs 2 burles usually and 1 burle if it is on sale. Ivan has to order exactly ki microtransactions of the i-th type (he orders microtransactions during the evening).Ivan can order any (possibly zero) number of microtransactions of any types during any day (of course, if he has enough money to do it). If the microtransaction he wants to order is on sale then he can buy it for 1 burle and otherwise he can buy it for 2 burles.There are also m special offers in the game shop. The j-th offer (dj,tj) means that microtransactions of the tj-th type are on sale during the dj-th day.Ivan wants to order all microtransactions as soon as possible. Your task is to calculate the minimum day when he can buy all microtransactions he want and actually start playing." 2000
1165F1 "Microtransactions (easy version)" "binary search,greedy" "The only difference between easy and hard versions is constraints.Ivan plays a computer game that contains some microtransactions to make characters look cooler. Since Ivan wants his character to be really cool, he wants to use some of these microtransactions \xe2\x80\x94 and he won\'t start playing until he gets all of them.Each day (during the morning) Ivan earns exactly one burle.There are n types of microtransactions in the game. Each microtransaction costs 2 burles usually and 1 burle if it is on sale. Ivan has to order exactly ki microtransactions of the i-th type (he orders microtransactions during the evening).Ivan can order any (possibly zero) number of microtransactions of any types during any day (of course, if he has enough money to do it). If the microtransaction he wants to order is on sale then he can buy it for 1 burle and otherwise he can buy it for 2 burles.There are also m special offers in the game shop. The j-th offer (dj,tj) means that microtransactions of the tj-th type are on sale during the dj-th day.Ivan wants to order all microtransactions as soon as possible. Your task is to calculate the minimum day when he can buy all microtransactions he want and actually start playing." 2000
1165E "Two Arrays and Sum of Functions" greedy,math,sortings "You are given two arrays a and b, both of length n.Let\'s define a function f(l,r)=\xe2\x88\x91l\xe2\x89\xa4i\xe2\x89\xa4rai\xe2\x8b\x85bi.Your task is to reorder the elements (choose an arbitrary order of elements) of the array b to minimize the value of \xe2\x88\x911\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4nf(l,r). Since the answer can be very large, you have to print it modulo 998244353. Note that you should minimize the answer but not its remainder." 1600
1165D "Almost All Divisors" "math,number theory" "We guessed some integer number x. You are given a list of almost all its divisors. Almost all means that there are all divisors except 1 and x in the list.Your task is to find the minimum possible integer x that can be the guessed number, or say that the input data is contradictory and it is impossible to find such number.You have to answer t independent queries." 1600
1165C "Good String" greedy "Let\'s call (yet again) a string good if its length is even, and every character in odd position of this string is different from the next character (the first character is different from the second, the third is different from the fourth, and so on). For example, the strings good, string and xyyx are good strings, and the strings bad, aa and aabc are not good. Note that the empty string is considered good.You are given a string s, you have to delete minimum number of characters from this string so that it becomes good." 1300
1165B "Polycarp Training" "data structures,greedy,sortings" "Polycarp wants to train before another programming competition. During the first day of his training he should solve exactly 1 problem, during the second day \xe2\x80\x94 exactly 2 problems, during the third day \xe2\x80\x94 exactly 3 problems, and so on. During the k-th day he should solve k problems.Polycarp has a list of n contests, the i-th contest consists of ai problems. During each day Polycarp has to choose exactly one of the contests he didn\'t solve yet and solve it. He solves exactly k problems from this contest. Other problems are discarded from it. If there are no contests consisting of at least k problems that Polycarp didn\'t solve yet during the k-th day, then Polycarp stops his training.How many days Polycarp can train if he chooses the contests optimally?" 1000
1165A Remainder implementation,math "You are given a huge decimal number consisting of n digits. It is guaranteed that this number has no leading zeros. Each digit of this number is either 0 or 1.You may perform several (possibly zero) operations with this number. During each operation you are allowed to change any digit of your number; you may change 0 to 1 or 1 to 0. It is possible that after some operation you can obtain a number with leading zeroes, but it does not matter for this problem.You are also given two integers 0\xe2\x89\xa4y<x<n. Your task is to calculate the minimum number of operations you should perform to obtain the number that has remainder 10y modulo 10x. In other words, the obtained number should have remainder 10y when divided by 10x." 1100
1163F "Indecisive Taxi Fee" "data structures,graphs,shortest paths" "In the city of Capypaland where Kuro and Shiro resides, there are n towns numbered from 1 to n and there are m bidirectional roads numbered from 1 to m connecting them. The i-th road connects towns ui and vi. Since traveling between the towns is quite difficult, the taxi industry is really popular here. To survive the harsh competition, each taxi company has to find a distinctive trait for their customers.Kuro is the owner of a taxi company. He has decided to introduce a new fee model for his taxi brand, where the fee for each ride is not calculated based on the trip length, but on the sum of the prices of the roads traveled. The price for each of the m roads has been decided by Kuro himself.As of now, the price for the road i is wi and hence the fee for a taxi ride traveling through roads e1,e2,\xe2\x80\xa6,ek is \xe2\x88\x91ki=1wei.However, Kuro himself is an indecisive person, so he has drafted q plans to change the road price. Each of the plans will be based on the original prices wi, except for a single road tj, the price of which is changed to xj. Note, that the plans are independent of each other.Shiro is a regular customer of the Kuro\'s taxi brand since she uses the taxi to travel from town 1 to town n every day. Since she\'s so a regular customer, Kuro decided to show her all his q plans before publishing them to the public. Now, Shiro wants to know the lowest fee she must pay to travel from the town 1 to the town n for each Kuro\'s plan." 3000
1163E "Magical Permutation" "bitmasks,brute force,constructive algorithms,data structures,graphs,math" "Kuro has just learned about permutations and he is really excited to create a new permutation type. He has chosen n distinct positive integers and put all of them in a set S. Now he defines a magical permutation to be: A permutation of integers from 0 to 2x\xe2\x88\x921, where x is a non-negative integer.  The bitwise xor of any two consecutive elements in the permutation is an element in S.Since Kuro is really excited about magical permutations, he wants to create the longest magical permutation possible. In other words, he wants to find the largest non-negative integer x such that there is a magical permutation of integers from 0 to 2x\xe2\x88\x921. Since he is a newbie in the subject, he wants you to help him find this value of x and also the magical permutation for that x." 2400
1163D "Mysterious Code" dp,strings "During a normal walk in the forest, Katie has stumbled upon a mysterious code! However, the mysterious code had some characters unreadable. She has written down this code as a string c consisting of lowercase English characters and asterisks (""*""), where each of the asterisks denotes an unreadable character. Excited with her discovery, Katie has decided to recover the unreadable characters by replacing each asterisk with arbitrary lowercase English letter (different asterisks might be replaced with different letters).Katie has a favorite string s and a not-so-favorite string t and she would love to recover the mysterious code so that it has as many occurrences of s as possible and as little occurrences of t as possible. Formally, let\'s denote f(x,y) as the number of occurrences of y in x (for example, f(aababa,ab)=2). Katie wants to recover the code c\xe2\x80\xb2 conforming to the original c, such that f(c\xe2\x80\xb2,s)\xe2\x88\x92f(c\xe2\x80\xb2,t) is largest possible. However, Katie is not very good at recovering codes in general, so she would like you to help her out." 2100
1163C2 "Power Transmission (Hard Edition)" "data structures,geometry,implementation,math" "This problem is same as the previous one, but has larger constraints.It was a Sunday morning when the three friends Selena, Shiro and Katie decided to have a trip to the nearby power station (do not try this at home). After arriving at the power station, the cats got impressed with a large power transmission system consisting of many chimneys, electric poles, and wires. Since they are cats, they found those things gigantic.At the entrance of the station, there is a map describing the complicated wiring system. Selena is the best at math among three friends. He decided to draw the map on the Cartesian plane. Each pole is now a point at some coordinates (xi,yi). Since every pole is different, all of the points representing these poles are distinct. Also, every two poles are connected with each other by wires. A wire is a straight line on the plane infinite in both directions. If there are more than two poles lying on the same line, they are connected by a single common wire.Selena thinks, that whenever two different electric wires intersect, they may interfere with each other and cause damage. So he wonders, how many pairs are intersecting? Could you help him with this problem?" 1900
1163C1 "Power Transmission (Easy Edition)" "brute force,geometry" "This problem is same as the next one, but has smaller constraints.It was a Sunday morning when the three friends Selena, Shiro and Katie decided to have a trip to the nearby power station (do not try this at home). After arriving at the power station, the cats got impressed with a large power transmission system consisting of many chimneys, electric poles, and wires. Since they are cats, they found those things gigantic.At the entrance of the station, there is a map describing the complicated wiring system. Selena is the best at math among three friends. He decided to draw the map on the Cartesian plane. Each pole is now a point at some coordinates (xi,yi). Since every pole is different, all of the points representing these poles are distinct. Also, every two poles are connected with each other by wires. A wire is a straight line on the plane infinite in both directions. If there are more than two poles lying on the same line, they are connected by a single common wire.Selena thinks, that whenever two different electric wires intersect, they may interfere with each other and cause damage. So he wonders, how many pairs are intersecting? Could you help him with this problem?" 1900
1163B2 "Cat Party (Hard Edition)" "data structures,implementation" "This problem is same as the previous one, but has larger constraints.Shiro\'s just moved to the new house. She wants to invite all friends of her to the house so they can play monopoly. However, her house is too small, so she can only invite one friend at a time.For each of the n days since the day Shiro moved to the new house, there will be exactly one cat coming to the Shiro\'s house. The cat coming in the i-th day has a ribbon with color ui. Shiro wants to know the largest number x, such that if we consider the streak of the first x days, it is possible to remove exactly one day from this streak so that every ribbon color that has appeared among the remaining x\xe2\x88\x921 will have the same number of occurrences.For example, consider the following sequence of ui: [2,2,1,1,5,4,4,5]. Then x=7 makes a streak, since if we remove the leftmost ui=5, each ribbon color will appear exactly twice in the prefix of x\xe2\x88\x921 days. Note that x=8 doesn\'t form a streak, since you must remove exactly one day. Since Shiro is just a cat, she is not very good at counting and needs your help finding the longest streak." 1600
1163B1 "Cat Party (Easy Edition)" "data structures,implementation" "This problem is same as the next one, but has smaller constraints.Shiro\'s just moved to the new house. She wants to invite all friends of her to the house so they can play monopoly. However, her house is too small, so she can only invite one friend at a time.For each of the n days since the day Shiro moved to the new house, there will be exactly one cat coming to the Shiro\'s house. The cat coming in the i-th day has a ribbon with color ui. Shiro wants to know the largest number x, such that if we consider the streak of the first x days, it is possible to remove exactly one day from this streak so that every ribbon color that has appeared among the remaining x\xe2\x88\x921 will have the same number of occurrences.For example, consider the following sequence of ui: [2,2,1,1,5,4,4,5]. Then x=7 makes a streak, since if we remove the leftmost ui=5, each ribbon color will appear exactly twice in the prefix of x\xe2\x88\x921 days. Note that x=8 doesn\'t form a streak, since you must remove exactly one day. Since Shiro is just a cat, she is not very good at counting and needs your help finding the longest streak." 1500
1163A "Eating Soup" greedy,math "The three friends, Kuro, Shiro, and Katie, met up again! It\'s time for a party...What the cats do when they unite? Right, they have a party. Since they wanted to have as much fun as possible, they invited all their friends. Now n cats are at the party, sitting in a circle and eating soup. The rules are simple: anyone having finished their soup leaves the circle.Katie suddenly notices that whenever a cat leaves, the place where she was sitting becomes an empty space, which means the circle is divided into smaller continuous groups of cats sitting next to each other. At the moment Katie observes, there are m cats who left the circle. This raises a question for Katie: what is the maximum possible number of groups the circle is divided into at the moment?Could you help her with this curiosity?You can see the examples and their descriptions with pictures in the ""Note"" section." 900
1162B "Double Matrix" "brute force,greedy" "You are given two n\xc3\x97m matrices containing integers. A sequence of integers is strictly increasing if each next number is greater than the previous one. A row is strictly increasing if all numbers from left to right are strictly increasing. A column is strictly increasing if all numbers from top to bottom are strictly increasing. A matrix is increasing if all rows are strictly increasing and all columns are strictly increasing. For example, the matrix [91011111214] is increasing because each individual row and column is strictly increasing. On the other hand, the matrix [1123] is not increasing because the first row is not strictly increasing.Let a position in the i-th row (from top) and j-th column (from left) in a matrix be denoted as (i,j). In one operation, you can choose any two numbers i and j and swap the number located in (i,j) in the first matrix with the number in (i,j) in the second matrix. In other words, you can swap two numbers in different matrices if they are located in the corresponding positions.You would like to make both matrices increasing by performing some number of operations (possibly none). Determine if it is possible to do this. If it is, print ""Possible"", otherwise, print ""Impossible""." 1400
1162A "Zoning Restrictions Again" implementation "You are planning to build housing on a street. There are n spots available on the street on which you can build a house. The spots are labeled from 1 to n from left to right. In each spot, you can build a house with an integer height between 0 and h.In each spot, if a house has height a, you will gain a2 dollars from it.The city has m zoning restrictions. The i-th restriction says that the tallest house from spots li to ri (inclusive) must be at most xi.You would like to build houses to maximize your profit. Determine the maximum profit possible." 800
1160A2 Collaboration "*special problem" "Consider several locations in integer points on the plane. One of the locations is the base where workers wait. Every other location contains one job.Each job has the following characteristics: work duration, the required number of workers, and also the earliest possible moment of starting the job and the latest possible moment of completing it. In order to complete the job, the required number of workers must simultaneously start working on it, and then be continuously present at the location for the duration of the job. Each job must either be fully done exactly once, or left untouched.Our task is to determine what should the workers do so that we have more profit. any worker can contribute to any job. We can use as many workers as we like, but each worker must take part in doing at least one job.Each worker starts at the base at a certain moment, then moves between locations and does the jobs, and finally gets back to the base and stops completely. A worker can move along coordinate axes, and spends one minute increasing or decreasing any one of his coordinates by 1. We have to pay the worker 240 credits for appearing in our solution, and additionally 1 credit per minute, up to the moment when the worker stops completely.We get rewarded for each job that is done. For a job with duration d and the required number of workers p, we get a reward of d\xe2\x8b\x85p\xe2\x8b\x85(p+5) credits. The jobs which are not done don\'t contribute to this sum.InputThe first line contains an integer n from 500 to 2000: the number of locations. Each of the following n lines contains six integers and describes one location in the format xÂ yÂ dÂ pÂ lÂ h. The coordinates x and y are integers from 0 to 100. The duration d is an integer from 5 to 30 minutes. The required number of workers p is an integer from 1 to 7 people. The earliest possible start moment l and the latest possible completion moment h are integers from 200 to 800 minutes, chosen so that 60\xe2\x89\xa4h\xe2\x88\x92l\xe2\x89\xa4300.The first location is the base. It is an exclusion to the rules above and has the format xÂ yÂ 0Â 0Â 0Â 0. All given points (x,y) are distinct.In all tests, the number n, as well as all points, durations, numbers of required workers, and time spans are chosen randomly, independently, and uniformly from the available choices.OutputPrint instructions for each worker as a block of a few lines which look as follows:  startÂ (at-moment)Â (at-location)The first line of a block. Determines the moment when the worker starts at the base. The location must be the base, and so have the number 1.  arriveÂ (at-moment)Â (at-location)We want the worker to arrive at this moment to this location. If he can not make it in time after the previous command, the solution is considered incorrect. Locations are numbered from 1 to n in input order.  workÂ (start-moment)Â (end-moment)Â (at-location)We want the worker to do the job at this location in this exact time interval. The location must be equal to the location in the previous arrival command. If the worker can not make it in time after the previous command, or the given time interval has wrong length or exceeds the time span of the location, the solution is considered incorrect. This command must be present at least once in each block. Recall that each job must be either completed simultaneously by the required number of workers, or left untouched, otherwise, the solution will be considered incorrect.  endThe last line of a block. The worker must be in the same position where he started. At each moment, there may be arbitrarily many workers in each location. All moments in the output must be integers from 0 to 1000, and all location numbers must be integers from 1 to n.Print consecutive blocks one under the other, with no gaps.ExampleInputCopy45 15 0 0 0 02 13 30 2 200 4003 12 29 1 350 60039 21 9 4 671 757OutputCopystart 335 1arrive 340 2work 340 370 2arrive 372 3work 372 401 3arrive 406 1endstart 335 1arrive 340 2work 340 370 2arrive 375 1endExplanationThe reward for the job at location 2 is 30\xe2\x8b\x852\xe2\x8b\x85(2+5)=420 credits.The reward for the job at location 3 is 29\xe2\x8b\x851\xe2\x8b\x85(1+5)=174 credits.The job at location 4 is not completed.We have to pay 240+71=311 credits to the first worker.We also have to pay 240+40=280 credits to the second worker.Profit: 420+174\xe2\x88\x92311\xe2\x88\x92280=3.Note that this example is too short (n<500) and so does not appear in the testing system. It is included for explanatory purposes only.ScoringEach test is scored independently. The score for a test is the profit divided by 1000. It the profit is negative, the score is equal to zero. If a solution did not output a valid answer on a certain test, the result for this test is also zero.TestingYour solution will be checked on sets of tests generated in advance. A solution\'s score is the sum of its results on all the tests. If a solution did not output a valid answer on a certain test, the result for this test is zero.During the main phase of the contest, there are two ways to submit a solution.  The first one, problem A1, is to check on examples. There are 10 example tests which are also available for local testing. As soon as the solution is checked, you can see reports for all examples by clicking on the submission result. The tests for A1 are open, you can download them from the links https://assets.codeforces.com/rounds/1160/codeforces-vrt-2019.tar.gz (for Linux) and https://assets.codeforces.com/rounds/1160/codeforces-vrt-2019.zip (for Windows). After testing, you can click the verdict of your submission to see the result for each test.  The second way, problem A2, is to check on preliminary tests. There are 100 preliminary tests which are generated in advance but kept secret. The score for preliminary tests (but not for example tests) is used in the preliminary scoreboard. This score does not affect the final results, but nevertheless allows to roughly compare a solution with others. After the main phase ends, for each participant, the system chooses the final solution:  consider all solutions sent for preliminary testing;  choose the ones which got a total score strictly greater than zero;  define the final solution as the one of chosen solutions which has the latest submission time. Note that the solutions sent only to be checked on examples are not considered when choosing the final solution.During final testing, all final solutions will be checked on the same set of a large number (\xe2\x89\x881000) of final tests. The score for final tests determines the final scoreboard. The winner is the contestant whose solution gets the highest total score. In case two or more participants have equal total score, the contestants with such score tie for the same place." -999
1159B "Expansion coefficient of the array" implementation,math "Let\'s call an array of non-negative integers a1,a2,\xe2\x80\xa6,an a k-extension for some non-negative integer k if for all possible pairs of indices 1\xe2\x89\xa4i,j\xe2\x89\xa4n the inequality k\xe2\x8b\x85|i\xe2\x88\x92j|\xe2\x89\xa4min(ai,aj) is satisfied. The expansion coefficient of the array a is the maximal integer k such that the array a is a k-extension. Any array is a 0-expansion, so the expansion coefficient always exists.You are given an array of non-negative integers a1,a2,\xe2\x80\xa6,an. Find its expansion coefficient." 1300
1159A "A pile of stones" implementation,math "Vasya has a pile, that consists of some number of stones. n times he either took one stone from the pile or added one stone to the pile. The pile was non-empty before each operation of taking one stone from the pile.You are given n operations which Vasya has made. Find the minimal possible number of stones that can be in the pile after making these operations." 800
1158F "Density of subarrays" dp,math "Let c be some positive integer. Let\'s call an array a1,a2,\xe2\x80\xa6,an of positive integers c-array, if for all i condition 1\xe2\x89\xa4ai\xe2\x89\xa4c is satisfied. Let\'s call c-array b1,b2,\xe2\x80\xa6,bk a subarray of c-array a1,a2,\xe2\x80\xa6,an, if there exists such set of k indices 1\xe2\x89\xa4i1<i2<\xe2\x80\xa6<ik\xe2\x89\xa4n that bj=aij for all 1\xe2\x89\xa4j\xe2\x89\xa4k. Let\'s define density of c-array a1,a2,\xe2\x80\xa6,an as maximal non-negative integer p, such that any c-array, that contains p numbers is a subarray of a1,a2,\xe2\x80\xa6,an.You are given a number c and some c-array a1,a2,\xe2\x80\xa6,an. For all 0\xe2\x89\xa4p\xe2\x89\xa4n find the number of sequences of indices 1\xe2\x89\xa4i1<i2<\xe2\x80\xa6<ik\xe2\x89\xa4n for all 1\xe2\x89\xa4k\xe2\x89\xa4n, such that density of array ai1,ai2,\xe2\x80\xa6,aik is equal to p. Find these numbers by modulo 998244353, because they can be too large." 3500
1158E "Strange device" "binary search,interactive,math,trees" "It is an interactive problem.Vasya enjoys solving quizzes. He found a strange device and wants to know how it works.This device encrypted with the tree (connected undirected graph without cycles) with n vertices, numbered with integers from 1 to n. To solve this quiz you should guess this tree.Fortunately, this device can make one operation, using which you should guess the cipher. You can give the device an array d1,d2,\xe2\x80\xa6,dn of non-negative integers. On the device, there are n lamps, i-th of them is connected with i-th vertex of the tree. For all i the light will turn on the i-th lamp, if there exist such vertex of the tree with number j\xe2\x89\xa0i that dist(i,j)\xe2\x89\xa4dj. Let\'s define dist(i,j) as the distance between vertices i and j in tree or number of edges on the simple path between vertices i and j.Vasya wants to solve this quiz using \xe2\x89\xa480 operations with the device and guess the tree. Help him!" 3400
1158D "Winding polygonal line" "constructive algorithms,geometry,greedy,math" "Vasya has n different points A1,A2,\xe2\x80\xa6An on the plane. No three of them lie on the same line He wants to place them in some order Ap1,Ap2,\xe2\x80\xa6,Apn, where p1,p2,\xe2\x80\xa6,pnÂ \xe2\x80\x94 some permutation of integers from 1 to n.After doing so, he will draw oriented polygonal line on these points, drawing oriented segments from each point to the next in the chosen order. So, for all 1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921 he will draw oriented segment from point Api to point Api+1. He wants to make this polygonal line satisfying 2 conditions:   it will be non-self-intersecting, so any 2 segments which are not neighbors don\'t have common points.  it will be winding. Vasya has a string s, consisting of (n\xe2\x88\x922) symbols ""L"" or ""R"". Let\'s call an oriented polygonal line winding, if its i-th turn left, if si= ""L"" and right, if si= ""R"". More formally: i-th turn will be in point Api+1, where oriented segment from point Api to point Api+1 changes to oriented segment from point Api+1 to point Api+2. Let\'s define vectors \xe2\x86\x92v1=\xe2\x86\x92ApiApi+1 and \xe2\x86\x92v2=\xe2\x86\x92Api+1Api+2. Then if in order to rotate the vector \xe2\x86\x92v1 by the smallest possible angle, so that its direction coincides with the direction of the vector \xe2\x86\x92v2 we need to make a turn counterclockwise, then we say that i-th turn is to the left, and otherwise to the right. For better understanding look at this pictures with some examples of turns:  There are left turns on this picture   There are right turns on this picture You are given coordinates of the points A1,A2,\xe2\x80\xa6An on the plane and string s. Find a permutation p1,p2,\xe2\x80\xa6,pn of the integers from 1 to n, such that the polygonal line, drawn by Vasya satisfy two necessary conditions." 2600
1158C "Permutation recovery" "constructive algorithms,data structures,dfs and similar,graphs,greedy,math,sortings" "Vasya has written some permutation p1,p2,\xe2\x80\xa6,pn of integers from 1 to n, so for all 1\xe2\x89\xa4i\xe2\x89\xa4n it is true that 1\xe2\x89\xa4pi\xe2\x89\xa4n and all p1,p2,\xe2\x80\xa6,pn are different. After that he wrote n numbers next1,next2,\xe2\x80\xa6,nextn. The number nexti is equal to the minimal index i<j\xe2\x89\xa4n, such that pj>pi. If there is no such j let\'s let\'s define as nexti=n+1.In the evening Vasya went home from school and due to rain, his notebook got wet. Now it is impossible to read some written numbers. Permutation and some values nexti are completely lost! If for some i the value nexti is lost, let\'s say that nexti=\xe2\x88\x921.You are given numbers next1,next2,\xe2\x80\xa6,nextn (maybe some of them are equal to \xe2\x88\x921). Help Vasya to find such permutation p1,p2,\xe2\x80\xa6,pn of integers from 1 to n, that he can write it to the notebook and all numbers nexti, which are not equal to \xe2\x88\x921, will be correct." 2100
1158B "The minimal unique substring" "constructive algorithms,math,strings" "Let s be some string consisting of symbols ""0"" or ""1"". Let\'s call a string t a substring of string s, if there exists such number 1\xe2\x89\xa4l\xe2\x89\xa4|s|\xe2\x88\x92|t|+1 that t=slsl+1\xe2\x80\xa6sl+|t|\xe2\x88\x921. Let\'s call a substring t of string s unique, if there exist only one such l. For example, let s=""1010111"". A string t=""010"" is an unique substring of s, because l=2 is the only one suitable number. But, for example t=""10"" isn\'t a unique substring of s, because l=1 and l=3 are suitable. And for example t=""00"" at all isn\'t a substring of s, because there is no suitable l.Today Vasya solved the following problem at the informatics lesson: given a string consisting of symbols ""0"" and ""1"", the task is to find the length of its minimal unique substring. He has written a solution to this problem and wants to test it. He is asking you to help him.You are given 2 positive integers n and k, such that (nmod2)=(kmod2), where (xmod2) is operation of taking remainder of x by dividing on 2. Find any string s consisting of n symbols ""0"" or ""1"", such that the length of its minimal unique substring is equal to k." 2200
1158A "The Party and Sweets" "binary search,constructive algorithms,greedy,implementation,math,sortings,two pointers" "n boys and m girls came to the party. Each boy presented each girl some integer number of sweets (possibly zero). All boys are numbered with integers from 1 to n and all girls are numbered with integers from 1 to m. For all 1\xe2\x89\xa4i\xe2\x89\xa4n the minimal number of sweets, which i-th boy presented to some girl is equal to bi and for all 1\xe2\x89\xa4j\xe2\x89\xa4m the maximal number of sweets, which j-th girl received from some boy is equal to gj.More formally, let ai,j be the number of sweets which the i-th boy give to the j-th girl. Then bi is equal exactly to the minimum among values ai,1,ai,2,\xe2\x80\xa6,ai,m and gj is equal exactly to the maximum among values b1,j,b2,j,\xe2\x80\xa6,bn,j.You are interested in the minimum total number of sweets that boys could present, so you need to minimize the sum of ai,j for all (i,j) such that 1\xe2\x89\xa4i\xe2\x89\xa4n and 1\xe2\x89\xa4j\xe2\x89\xa4m. You are given the numbers b1,\xe2\x80\xa6,bn and g1,\xe2\x80\xa6,gm, determine this number." 1500
1157G "Inverse of Rows and Columns" "brute force,constructive algorithms" "You are given a binary matrix a of size n\xc3\x97m. A binary matrix is a matrix where each element is either 0 or 1.You may perform some (possibly zero) operations with this matrix. During each operation you can inverse the row of this matrix or a column of this matrix. Formally, inverting a row is changing all values in this row to the opposite (0 to 1, 1 to 0). Inverting a column is changing all values in this column to the opposite.Your task is to sort the initial matrix by some sequence of such operations. The matrix is considered sorted if the array [a1,1,a1,2,\xe2\x80\xa6,a1,m,a2,1,a2,2,\xe2\x80\xa6,a2,m,\xe2\x80\xa6,an,m\xe2\x88\x921,an,m] is sorted in non-descending order." 2200
1157F "Maximum Balanced Circle" "constructive algorithms,dp,greedy,two pointers" "There are n people in a row. The height of the i-th person is ai. You can choose any subset of these people and try to arrange them into a balanced circle.A balanced circle is such an order of people that the difference between heights of any adjacent people is no more than 1. For example, let heights of chosen people be [ai1,ai2,\xe2\x80\xa6,aik], where k is the number of people you choose. Then the condition |aij\xe2\x88\x92aij+1|\xe2\x89\xa41 should be satisfied for all j from 1 to k\xe2\x88\x921 and the condition |ai1\xe2\x88\x92aik|\xe2\x89\xa41 should be also satisfied. |x| means the absolute value of x. It is obvious that the circle consisting of one person is balanced.Your task is to choose the maximum number of people and construct a balanced circle consisting of all chosen people. It is obvious that the circle consisting of one person is balanced so the answer always exists." 2000
1157E "Minimum Array" "binary search,data structures,greedy" "You are given two arrays a and b, both of length n. All elements of both arrays are from 0 to n\xe2\x88\x921.You can reorder elements of the array b (if you want, you may leave the order of elements as it is). After that, let array c be the array of length n, the i-th element of this array is ci=(ai+bi)%n, where x%y is x modulo y.Your task is to reorder elements of the array b to obtain the lexicographically minimum possible array c.Array x of length n is lexicographically less than array y of length n, if there exists such i (1\xe2\x89\xa4i\xe2\x89\xa4n), that xi<yi, and for any j (1\xe2\x89\xa4j<i) xj=yj." 1700
1157D "N Problems During K Days" "constructive algorithms,greedy,math" "Polycarp has to solve exactly n problems to improve his programming skill before an important programming competition. But this competition will be held very soon, most precisely, it will start in k days. It means that Polycarp has exactly k days for training!Polycarp doesn\'t want to procrastinate, so he wants to solve at least one problem during each of k days. He also doesn\'t want to overwork, so if he solves x problems during some day, he should solve no more than 2x problems during the next day. And, at last, he wants to improve his skill, so if he solves x problems during some day, he should solve at least x+1 problem during the next day.More formally: let [a1,a2,\xe2\x80\xa6,ak] be the array of numbers of problems solved by Polycarp. The i-th element of this array is the number of problems Polycarp solves during the i-th day of his training. Then the following conditions must be satisfied:   sum of all ai for i from 1 to k should be n;  ai should be greater than zero for each i from 1 to k;  the condition ai<ai+1\xe2\x89\xa42ai should be satisfied for each i from 1 to k\xe2\x88\x921. Your problem is to find any array a of length k satisfying the conditions above or say that it is impossible to do it." 1900
1157C2 "Increasing Subsequence (hard version)" greedy "The only difference between problems C1 and C2 is that all values in input of problem C1 are distinct (this condition may be false for problem C2).You are given a sequence a consisting of n integers.You are making a sequence of moves. During each move you must take either the leftmost element of the sequence or the rightmost element of the sequence, write it down and remove it from the sequence. Your task is to write down a strictly increasing sequence, and among all such sequences you should take the longest (the length of the sequence is the number of elements in it).For example, for the sequence [1,2,4,3,2] the answer is 4 (you take 1 and the sequence becomes [2,4,3,2], then you take the rightmost element 2 and the sequence becomes [2,4,3], then you take 3 and the sequence becomes [2,4] and then you take 4 and the sequence becomes [2], the obtained increasing sequence is [1,2,3,4])." 1700
1157C1 "Increasing Subsequence (easy version)" greedy "The only difference between problems C1 and C2 is that all values in input of problem C1 are distinct (this condition may be false for problem C2).You are given a sequence a consisting of n integers. All these integers are distinct, each value from 1 to n appears in the sequence exactly once.You are making a sequence of moves. During each move you must take either the leftmost element of the sequence or the rightmost element of the sequence, write it down and remove it from the sequence. Your task is to write down a strictly increasing sequence, and among all such sequences you should take the longest (the length of the sequence is the number of elements in it).For example, for the sequence [2,1,5,4,3] the answer is 4 (you take 2 and the sequence becomes [1,5,4,3], then you take the rightmost element 3 and the sequence becomes [1,5,4], then you take 4 and the sequence becomes [1,5] and then you take 5 and the sequence becomes [1], the obtained increasing sequence is [2,3,4,5])." 1300
1157B "Long Number" greedy "You are given a long decimal number aa consisting of n digits from 1 to 9. You also have a function f that maps every digit from 1 to 9 to some (possibly the same) digit from 1 to 9.You can perform the following operation no more than once: choose a non-empty contiguous subsegment of digits in a, and replace each digit x from this segment with f(x). For example, if a=1337, f(1)=1, f(3)=5, f(7)=3, and you choose the segment consisting of three rightmost digits, you get 1553 as the result.What is the maximum possible number you can obtain applying this operation no more than once?" 1300
1157A "Reachable Numbers" implementation "Let\'s denote a function f(x) in such a way: we add 1 to x, then, while there is at least one trailing zero in the resulting number, we remove that zero. For example,   f(599)=6: 599+1=600\xe2\x86\x9260\xe2\x86\x926;  f(7)=8: 7+1=8;  f(9)=1: 9+1=10\xe2\x86\x921;  f(10099)=101: 10099+1=10100\xe2\x86\x921010\xe2\x86\x92101. We say that some number y is reachable from x if we can apply function f to x some (possibly zero) times so that we get y as a result. For example, 102 is reachable from 10098 because f(f(f(10098)))=f(f(10099))=f(101)=102; and any number is reachable from itself.You are given a number n; your task is to count how many different numbers are reachable from n." 1100
1156G Optimizer graphs,greedy,hashing,implementation "Let\'s analyze a program written on some strange programming language. The variables in this language have names consisting of 1 to 4 characters, and each character is a lowercase or an uppercase Latin letter, or a digit. There is an extra constraint that the first character should not be a digit.There are four types of operations in the program, each denoted by one of the characters: $, ^, # or &.Each line of the program has one of the following formats:   <lvalue>=<rvalue>, where <lvalue> and <rvalue> are valid variable names;  <lvalue>=<arg1><op><arg2>, where <lvalue>, <arg1> and <arg2> are valid variable names, and <op> is an operation character. The program is executed line-by-line, and the result of execution is stored in a variable having the name res. If res is never assigned in the program, then the result will be equal to the value of res before running the program.Two programs are called equivalent if no matter which operations do characters $, ^, # and & denote (but, obviously, performing the same operation on the same arguments gives the same result) and which values do variables have before execution of program, the value of res after running the first program is equal to the value of res after running the second program (the programs are executed independently).You are given a program consisting of n lines. Your task is to write a program consisting of minimum possible number of lines that is equivalent to the program you are given." 2700
1156F "Card Bag" dp,math,probabilities "You have a bag which contains n cards. There is a number written on each card; the number on i-th card is ai.You are playing the following game. During each turn, you choose and remove a random card from the bag (all cards that are still left inside the bag are chosen equiprobably). Nothing else happens during the first turn \xe2\x80\x94 but during the next turns, after removing a card (let the number on it be x), you compare it with the card that was removed during the previous turn (let the number on it be y). Possible outcomes are:   if x<y, the game ends and you lose;  if x=y, the game ends and you win;  if x>y, the game continues. If there are no cards left in the bag, you lose. Cards are not returned into the bag after you remove them.You have to calculate the probability of winning in this game. It can be shown that it is in the form of PQ where P and Q are non-negative integers and Q\xe2\x89\xa00, P\xe2\x89\xa4Q. Output the value of P\xe2\x8b\x85Q\xe2\x88\x921Â (modÂ Â 998244353)." 2300
1156E "Special Segments of Permutation" "data structures,divide and conquer,dsu,two pointers" "You are given a permutation p of n integers 1, 2, ..., n (a permutation is an array where each element from 1 to n occurs exactly once).Let\'s call some subsegment p[l,r] of this permutation special if pl+pr=rmaxi=lpi. Please calculate the number of special subsegments." 2200
1156D 0-1-Tree "dfs and similar,divide and conquer,dp,dsu,trees" "You are given a tree (an undirected connected acyclic graph) consisting of n vertices and n\xe2\x88\x921 edges. A number is written on each edge, each number is either 0 (let\'s call such edges 0-edges) or 1 (those are 1-edges).Let\'s call an ordered pair of vertices (x,y) (x\xe2\x89\xa0y) valid if, while traversing the simple path from x to y, we never go through a 0-edge after going through a 1-edge. Your task is to calculate the number of valid pairs in the tree." 2200
1156C "Match Points" "binary search,greedy,sortings,ternary search,two pointers" "You are given a set of points x1, x2, ..., xn on the number line.Two points i and j can be matched with each other if the following conditions hold:  neither i nor j is matched with any other point;  |xi\xe2\x88\x92xj|\xe2\x89\xa5z. What is the maximum number of pairs of points you can match with each other?" 2000
1156B "Ugly Pairs" "dfs and similar,greedy,implementation,sortings,strings" "You are given a string, consisting of lowercase Latin letters.A pair of neighbouring letters in a string is considered ugly if these letters are also neighbouring in a alphabet. For example, string ""abaca"" contains ugly pairs at positions (1,2) \xe2\x80\x94 ""ab"" and (2,3) \xe2\x80\x94 ""ba"". Letters \'a\' and \'z\' aren\'t considered neighbouring in a alphabet.Can you rearrange the letters of a given string so that there are no ugly pairs? You can choose any order of the letters of the given string but you can\'t add any new letters or remove the existing ones. You can also leave the order the same.If there are multiple answers, print any of them.You also have to answer T separate queries." 1800
1156A "Inscribed Figures" geometry "The math faculty of Berland State University has suffered the sudden drop in the math skills of enrolling students. This year the highest grade on the entrance math test was 8. Out of 100! Thus, the decision was made to make the test easier.Future students will be asked just a single question. They are given a sequence of integer numbers a1,a2,\xe2\x80\xa6,an, each number is from 1 to 3 and ai\xe2\x89\xa0ai+1 for each valid i. The i-th number represents a type of the i-th figure:  circle;  isosceles triangle with the length of height equal to the length of base;  square. The figures of the given sequence are placed somewhere on a Cartesian plane in such a way that:  (i+1)-th figure is inscribed into the i-th one;  each triangle base is parallel to OX;  the triangle is oriented in such a way that the vertex opposite to its base is at the top;  each square sides are parallel to the axes;  for each i from 2 to n figure i has the maximum possible length of side for triangle and square and maximum radius for circle. Note that the construction is unique for some fixed position and size of just the first figure.The task is to calculate the number of distinct points (not necessarily with integer coordinates) where figures touch. The trick is, however, that the number is sometimes infinite. But that won\'t make the task difficult for you, will it?So can you pass the math test and enroll into Berland State University?" 1400
1155F "Delivery Oligopoly" "brute force,dp,graphs" "The whole delivery market of Berland is controlled by two rival companies: BerEx and BerPS. They both provide fast and reliable delivery services across all the cities of Berland.The map of Berland can be represented as an undirected graph. The cities are vertices and the roads are edges between them. Each pair of cities has no more than one road between them. Each road connects different cities.BerEx and BerPS are so competitive that for each pair of cities (v,u) they have set up their paths from v to u in such a way that these two paths don\'t share a single road. It is guaranteed that it was possible.Now Berland government decided to cut down the road maintenance cost by abandoning some roads. Obviously, they want to maintain as little roads as possible. However, they don\'t want to break the entire delivery system. So BerEx and BerPS should still be able to have their paths between every pair of cities non-intersecting.What is the minimal number of roads Berland government can maintain?More formally, given a 2-edge connected undirected graph, what is the minimum number of edges that can be left in it so that the resulting graph is also 2-edge connected?" 2800
1155E "Guess the Root" "brute force,interactive,math" "Jury picked a polynomial f(x)=a0+a1\xe2\x8b\x85x+a2\xe2\x8b\x85x2+\xe2\x8b\xaf+ak\xe2\x8b\x85xk. k\xe2\x89\xa410 and all ai are integer numbers and 0\xe2\x89\xa4ai<106+3. It\'s guaranteed that there is at least one i such that ai>0.Now jury wants you to find such an integer x0 that f(x0)\xe2\x89\xa10mod(106+3) or report that there is not such x0.You can ask no more than 50 queries: you ask value xq and jury tells you value f(xq)mod(106+3).Note that printing the answer doesn\'t count as a query." 2200
1155D "Beautiful Array" "brute force,data structures,divide and conquer,dp,greedy" "You are given an array a consisting of n integers. Beauty of array is the maximum sum of some consecutive subarray of this array (this subarray may be empty). For example, the beauty of the array [10, -5, 10, -4, 1] is 15, and the beauty of the array [-3, -5, -1] is 0.You may choose at most one consecutive subarray of a and multiply all values contained in this subarray by x. You want to maximize the beauty of array after applying at most one such operation." 1900
1155C "Alarm Clocks Everywhere" "math,number theory" "Ivan is going to sleep now and wants to set his alarm clock. There will be many necessary events tomorrow, the i-th of them will start during the xi-th minute. Ivan doesn\'t want to skip any of the events, so he has to set his alarm clock in such a way that it rings during minutes x1,x2,\xe2\x80\xa6,xn, so he will be awake during each of these minutes (note that it does not matter if his alarm clock will ring during any other minute).Ivan can choose two properties for the alarm clock \xe2\x80\x94 the first minute it will ring (let\'s denote it as y) and the interval between two consecutive signals (let\'s denote it by p). After the clock is set, it will ring during minutes y,y+p,y+2p,y+3p and so on.Ivan can choose any minute as the first one, but he cannot choose any arbitrary value of p. He has to pick it among the given values p1,p2,\xe2\x80\xa6,pm (his phone does not support any other options for this setting).So Ivan has to choose the first minute y when the alarm clock should start ringing and the interval between two consecutive signals pj in such a way that it will ring during all given minutes x1,x2,\xe2\x80\xa6,xn (and it does not matter if his alarm clock will ring in any other minutes).Your task is to tell the first minute y and the index j such that if Ivan sets his alarm clock with properties y and pj it will ring during all given minutes x1,x2,\xe2\x80\xa6,xn or say that it is impossible to choose such values of the given properties. If there are multiple answers, you can print any." 1300
1155B "Game with Telephone Numbers" games,greedy,implementation "A telephone number is a sequence of exactly 11 digits such that its first digit is 8.Vasya and Petya are playing a game. Initially they have a string s of length n (n is odd) consisting of digits. Vasya makes the first move, then players alternate turns. In one move the player must choose a character and erase it from the current string. For example, if the current string 1121, after the player\'s move it may be 112, 111 or 121. The game ends when the length of string s becomes 11. If the resulting string is a telephone number, Vasya wins, otherwise Petya wins.You have to determine if Vasya has a winning strategy (that is, if Vasya can win the game no matter which characters Petya chooses during his moves)." 1200
1155A "Reverse a Substring" implementation,sortings,strings "You are given a string s consisting of n lowercase Latin letters.Let\'s define a substring as a contiguous subsegment of a string. For example, ""acab"" is a substring of ""abacaba"" (it starts in position 3 and ends in position 6), but ""aa"" or ""d"" aren\'t substrings of this string. So the substring of the string s from position l to position r is s[l;r]=slsl+1\xe2\x80\xa6sr.You have to choose exactly one of the substrings of the given string and reverse it (i.\xe2\x80\x89e. make s[l;r]=srsr\xe2\x88\x921\xe2\x80\xa6sl) to obtain a string that is less lexicographically. Note that it is not necessary to obtain the minimum possible string.If it is impossible to reverse some substring of the given string to obtain a string that is less, print ""NO"". Otherwise print ""YES"" and any suitable substring.String x is lexicographically less than string y, if either x is a prefix of y (and x\xe2\x89\xa0y), or there exists such i (1\xe2\x89\xa4i\xe2\x89\xa4min(|x|,|y|)), that xi<yi, and for any j (1\xe2\x89\xa4j<i) xj=yj. Here |a| denotes the length of the string a. The lexicographic comparison of strings is implemented by operator < in modern programming languages\xe2\x80\x8b\xe2\x80\x8b." 1000
1154G "Minimum Possible LCM" "brute force,greedy,math,number theory" "You are given an array a consisting of n integers a1,a2,\xe2\x80\xa6,an.Your problem is to find such pair of indices i,j (1\xe2\x89\xa4i<j\xe2\x89\xa4n) that lcm(ai,aj) is minimum possible.lcm(x,y) is the least common multiple of x and y (minimum positive number such that both x and y are divisors of this number)." 2200
1154F "Shovels Shop" dp,greedy,sortings "There are n shovels in the nearby shop. The i-th shovel costs ai bourles.Misha has to buy exactly k shovels. Each shovel can be bought no more than once.Misha can buy shovels by several purchases. During one purchase he can choose any subset of remaining (non-bought) shovels and buy this subset.There are also m special offers in the shop. The j-th of them is given as a pair (xj,yj), and it means that if Misha buys exactly xj shovels during one purchase then yj most cheapest of them are for free (i.e. he will not pay for yj most cheapest shovels during the current purchase).Misha can use any offer any (possibly, zero) number of times, but he cannot use more than one offer during one purchase (but he can buy shovels without using any offers).Your task is to calculate the minimum cost of buying k shovels, if Misha buys them optimally." 2100
1154E "Two Teams" "data structures,implementation,sortings" "There are n students standing in a row. Two coaches are forming two teams \xe2\x80\x94 the first coach chooses the first team and the second coach chooses the second team.The i-th student has integer programming skill ai. All programming skills are distinct and between 1 and n, inclusive.Firstly, the first coach will choose the student with maximum programming skill among all students not taken into any team, and k closest students to the left of him and k closest students to the right of him (if there are less than k students to the left or to the right, all of them will be chosen). All students that are chosen leave the row and join the first team. Secondly, the second coach will make the same move (but all students chosen by him join the second team). Then again the first coach will make such move, and so on. This repeats until the row becomes empty (i.\xe2\x80\x89e. the process ends when each student becomes to some team).Your problem is to determine which students will be taken into the first team and which students will be taken into the second team." 1800
1154D "Walking Robot" greedy "There is a robot staying at X=0 on the Ox axis. He has to walk to X=n. You are controlling this robot and controlling how he goes. The robot has a battery and an accumulator with a solar panel.The i-th segment of the path (from X=i\xe2\x88\x921 to X=i) can be exposed to sunlight or not. The array s denotes which segments are exposed to sunlight: if segment i is exposed, then si=1, otherwise si=0.The robot has one battery of capacity b and one accumulator of capacity a. For each segment, you should choose which type of energy storage robot will use to go to the next point (it can be either battery or accumulator). If the robot goes using the battery, the current charge of the battery is decreased by one (the robot can\'t use the battery if its charge is zero). And if the robot goes using the accumulator, the current charge of the accumulator is decreased by one (and the robot also can\'t use the accumulator if its charge is zero).If the current segment is exposed to sunlight and the robot goes through it using the battery, the charge of the accumulator increases by one (of course, its charge can\'t become higher than it\'s maximum capacity).If accumulator is used to pass some segment, its charge decreases by 1 no matter if the segment is exposed or not.You understand that it is not always possible to walk to X=n. You want your robot to go as far as possible. Find the maximum number of segments of distance the robot can pass if you control him optimally." 1500
1154C "Gourmet Cat" implementation,math "Polycarp has a cat and his cat is a real gourmet! Dependent on a day of the week he eats certain type of food:  on Mondays, Thursdays and Sundays he eats fish food;  on Tuesdays and Saturdays he eats rabbit stew;  on other days of week he eats chicken stake. Polycarp plans to go on a trip and already packed his backpack. His backpack contains:  a daily rations of fish food;  b daily rations of rabbit stew;  c daily rations of chicken stakes. Polycarp has to choose such day of the week to start his trip that his cat can eat without additional food purchases as long as possible. Print the maximum number of days the cat can eat in a trip without additional food purchases, if Polycarp chooses the day of the week to start his trip optimally." 1400
1154B "Make Them Equal" math "You are given a sequence a1,a2,\xe2\x80\xa6,an consisting of n integers.You can choose any non-negative integer D (i.e. D\xe2\x89\xa50), and for each ai you can:  add D (only once), i.\xe2\x80\x89e. perform ai:=ai+D, or  subtract D (only once), i.\xe2\x80\x89e. perform ai:=ai\xe2\x88\x92D, or  leave the value of ai unchanged. It is possible that after an operation the value ai becomes negative.Your goal is to choose such minimum non-negative integer D and perform changes in such a way, that all ai are equal (i.e. a1=a2=\xe2\x8b\xaf=an).Print the required D or, if it is impossible to choose such value D, print -1.For example, for array [2,8] the value D=3 is minimum possible because you can obtain the array [5,5] if you will add D to 2 and subtract D from 8. And for array [1,4,7,7] the value D=3 is also minimum possible. You can add it to 1 and subtract it from 7 and obtain the array [4,4,4,4]." 1200
1154A "Restoring Three Numbers" math "Polycarp has guessed three positive integers a, b and c. He keeps these numbers in secret, but he writes down four numbers on a board in arbitrary order \xe2\x80\x94 their pairwise sums (three numbers) and sum of all three numbers (one number). So, there are four numbers on a board in random order: a+b, a+c, b+c and a+b+c.You have to guess three numbers a, b and c using given numbers. Print three guessed integers in any order.Pay attention that some given numbers a, b and c can be equal (it is also possible that a=b=c)." 800
1153F "Serval and Bonus Problem" combinatorics,dp,math,probabilities "Getting closer and closer to a mathematician, Serval becomes a university student on math major in Japari University. On the Calculus class, his teacher taught him how to calculate the expected length of a random subsegment of a given segment. Then he left a bonus problem as homework, with the award of a garage kit from IOI. The bonus is to extend this problem to the general case as follows.You are given a segment with length l. We randomly choose n segments by choosing two points (maybe with non-integer coordinates) from the given segment equiprobably and the interval between the two points forms a segment. You are given the number of random segments n, and another integer k. The 2n endpoints of the chosen segments split the segment into (2n+1) intervals. Your task is to calculate the expected total length of those intervals that are covered by at least k segments of the n random segments.You should find the answer modulo 998244353." 2600
1153E "Serval and Snake" "binary search,brute force,interactive" "This is an interactive problem.Now Serval is a senior high school student in Japari Middle School. However, on the way to the school, he must go across a pond, in which there is a dangerous snake. The pond can be represented as a n\xc3\x97n grid. The snake has a head and a tail in different cells, and its body is a series of adjacent cells connecting the head and the tail without self-intersecting. If Serval hits its head or tail, the snake will bite him and he will die.Luckily, he has a special device which can answer the following question: you can pick a rectangle, it will tell you the number of times one needs to cross the border of the rectangle walking cell by cell along the snake from the head to the tail. The pictures below show a possible snake and a possible query to it, which will get an answer of 4.    Today Serval got up too late and only have time to make 2019 queries. As his best friend, can you help him find the positions of the head and the tail?Note that two cells are adjacent if and only if they have a common edge in the grid, and a snake can have a body of length 0, that means it only has adjacent head and tail.Also note that the snake is sleeping, so it won\'t move while Serval using his device. And what\'s obvious is that the snake position does not depend on your queries." 2200
1153D "Serval and Rooted Tree" "binary search,dfs and similar,dp,greedy,trees" "Now Serval is a junior high school student in Japari Middle School, and he is still thrilled on math as before. As a talented boy in mathematics, he likes to play with numbers. This time, he wants to play with numbers on a rooted tree.A tree is a connected graph without cycles. A rooted tree has a special vertex called the root. A parent of a node v is the last different from v vertex on the path from the root to the vertex v. Children of vertex v are all nodes for which v is the parent. A vertex is a leaf if it has no children.The rooted tree Serval owns has n nodes, node 1 is the root. Serval will write some numbers into all nodes of the tree. However, there are some restrictions. Each of the nodes except leaves has an operation max or min written in it, indicating that the number in this node should be equal to the maximum or minimum of all the numbers in its sons, respectively. Assume that there are k leaves in the tree. Serval wants to put integers 1,2,\xe2\x80\xa6,k to the k leaves (each number should be used exactly once). He loves large numbers, so he wants to maximize the number in the root. As his best friend, can you help him?" 1900
1153C "Serval and Parenthesis Sequence" greedy,strings "Serval soon said goodbye to Japari kindergarten, and began his life in Japari Primary School.In his favorite math class, the teacher taught him the following interesting definitions.A parenthesis sequence is a string, containing only characters ""("" and "")"".A correct parenthesis sequence is a parenthesis sequence that can be transformed into a correct arithmetic expression by inserting characters ""1"" and ""+"" between the original characters of the sequence. For example, parenthesis sequences ""()()"", ""(())"" are correct (the resulting expressions are: ""(1+1)+(1+1)"", ""((1+1)+1)""), while "")("" and "")"" are not. Note that the empty string is a correct parenthesis sequence by definition.We define that |s| as the length of string s. A strict prefix s[1\xe2\x80\xa6l] (1\xe2\x89\xa4l<|s|) of a string s=s1s2\xe2\x80\xa6s|s| is string s1s2\xe2\x80\xa6sl. Note that the empty string and the whole string are not strict prefixes of any string by the definition.Having learned these definitions, he comes up with a new problem. He writes down a string s containing only characters ""("", "")"" and ""?"". And what he is going to do, is to replace each of the ""?"" in s independently by one of ""("" and "")"" to make all strict prefixes of the new sequence not a correct parenthesis sequence, while the new sequence should be a correct parenthesis sequence.After all, he is just a primary school student so this problem is too hard for him to solve. As his best friend, can you help him to replace the question marks? If there are many solutions, any of them is acceptable." 1700
1153B "Serval and Toy Bricks" "constructive algorithms,greedy" "Luckily, Serval got onto the right bus, and he came to the kindergarten on time. After coming to kindergarten, he found the toy bricks very funny.He has a special interest to create difficult problems for others to solve. This time, with many 1\xc3\x971\xc3\x971 toy bricks, he builds up a 3-dimensional object. We can describe this object with a n\xc3\x97m matrix, such that in each cell (i,j), there are hi,j bricks standing on the top of each other.However, Serval doesn\'t give you any hi,j, and just give you the front view, left view, and the top view of this object, and he is now asking you to restore the object. Note that in the front view, there are m columns, and in the i-th of them, the height is the maximum of h1,i,h2,i,\xe2\x80\xa6,hn,i. It is similar for the left view, where there are n columns. And in the top view, there is an n\xc3\x97m matrix ti,j, where ti,j is 0 or 1. If ti,j equals 1, that means hi,j>0, otherwise, hi,j=0.However, Serval is very lonely because others are bored about his unsolvable problems before, and refused to solve this one, although this time he promises there will be at least one object satisfying all the views. As his best friend, can you have a try?" 1200
1153A "Serval and Bus" "brute force,math" "It is raining heavily. But this is the first day for Serval, who just became 3 years old, to go to the kindergarten. Unfortunately, he lives far from kindergarten, and his father is too busy to drive him there. The only choice for this poor little boy is to wait for a bus on this rainy day. Under such circumstances, the poor boy will use the first bus he sees no matter where it goes. If several buses come at the same time, he will choose one randomly.Serval will go to the bus station at time t, and there are n bus routes which stop at this station. For the i-th bus route, the first bus arrives at time si minutes, and each bus of this route comes di minutes later than the previous one.As Serval\'s best friend, you wonder which bus route will he get on. If several buses arrive at the same time, you can print any of them." 1000
1152F2 "Neko Rules the Catniverse (Large Version)" bitmasks,dp,matrices "This problem is same as the previous one, but has larger constraints.Aki is playing a new video game. In the video game, he will control Neko, the giant cat, to fly between planets in the Catniverse.There are n planets in the Catniverse, numbered from 1 to n. At the beginning of the game, Aki chooses the planet where Neko is initially located. Then Aki performs k\xe2\x88\x921 moves, where in each move Neko is moved from the current planet x to some other planet y such that:  Planet y is not visited yet.  1\xe2\x89\xa4y\xe2\x89\xa4x+m (where m is a fixed constant given in the input) This way, Neko will visit exactly k different planets. Two ways of visiting planets are called different if there is some index i such that, the i-th planet visited in the first way is different from the i-th planet visited in the second way.What is the total number of ways to visit k planets this way? Since the answer can be quite large, print it modulo 109+7." 3000
1152F1 "Neko Rules the Catniverse (Small Version)" bitmasks,dp,matrices "This problem is same as the next one, but has smaller constraints.Aki is playing a new video game. In the video game, he will control Neko, the giant cat, to fly between planets in the Catniverse.There are n planets in the Catniverse, numbered from 1 to n. At the beginning of the game, Aki chooses the planet where Neko is initially located. Then Aki performs k\xe2\x88\x921 moves, where in each move Neko is moved from the current planet x to some other planet y such that:  Planet y is not visited yet.  1\xe2\x89\xa4y\xe2\x89\xa4x+m (where m is a fixed constant given in the input) This way, Neko will visit exactly k different planets. Two ways of visiting planets are called different if there is some index i such that the i-th planet visited in the first way is different from the i-th planet visited in the second way.What is the total number of ways to visit k planets this way? Since the answer can be quite large, print it modulo 109+7." 2800
1152E "Neko and Flashback" "constructive algorithms,dfs and similar,graphs" "A permutation of length k is a sequence of k integers from 1 to k containing each integer exactly once. For example, the sequence [3,1,2] is a permutation of length 3.When Neko was five, he thought of an array a of n positive integers and a permutation p of length n\xe2\x88\x921. Then, he performed the following:  Constructed an array b of length n\xe2\x88\x921, where bi=min(ai,ai+1).  Constructed an array c of length n\xe2\x88\x921, where ci=max(ai,ai+1).  Constructed an array b\xe2\x80\xb2 of length n\xe2\x88\x921, where b\xe2\x80\xb2i=bpi.  Constructed an array c\xe2\x80\xb2 of length n\xe2\x88\x921, where c\xe2\x80\xb2i=cpi. For example, if the array a was [3,4,6,5,7] and permutation p was [2,4,1,3], then Neko would have constructed the following arrays:  b=[3,4,5,5]  c=[4,6,6,7]  b\xe2\x80\xb2=[4,5,3,5]  c\xe2\x80\xb2=[6,7,4,6] Then, he wrote two arrays b\xe2\x80\xb2 and c\xe2\x80\xb2 on a piece of paper and forgot about it. 14 years later, when he was cleaning up his room, he discovered this old piece of paper with two arrays b\xe2\x80\xb2 and c\xe2\x80\xb2 written on it. However he can\'t remember the array a and permutation p he used.In case Neko made a mistake and there is no array a and permutation p resulting in such b\xe2\x80\xb2 and c\xe2\x80\xb2, print -1. Otherwise, help him recover any possible array a." 2400
1152D "Neko and Aki\'s Prank" dp,greedy,trees "Neko is playing with his toys on the backyard of Aki\'s house. Aki decided to play a prank on him, by secretly putting catnip into Neko\'s toys. Unfortunately, he went overboard and put an entire bag of catnip into the toys...It took Neko an entire day to turn back to normal. Neko reported to Aki that he saw a lot of weird things, including a trie of all correct bracket sequences of length 2n2n.The definition of correct bracket sequence is as follows:  The empty sequence is a correct bracket sequence,  If ss is a correct bracket sequence, then (s)(s) is a correct bracket sequence,  If ss and tt are a correct bracket sequence, then stst is also a correct bracket sequence. For example, the strings ""(())"", ""()()"" form a correct bracket sequence, while "")("" and ""(("" not.Aki then came up with an interesting problem: What is the size of the maximum matching (the largest set of edges such that there are no two edges with a common vertex) in this trie? Since the answer can be quite large, print it modulo 109+7109+7." 2100
1152C "Neko does Maths" "brute force,math,number theory" "Neko loves divisors. During the latest number theory lesson, he got an interesting exercise from his math teacher.Neko has two integers a and b. His goal is to find a non-negative integer k such that the least common multiple of a+k and b+k is the smallest possible. If there are multiple optimal integers k, he needs to choose the smallest one.Given his mathematical talent, Neko had no trouble getting Wrong Answer on this problem. Can you help him solve it?" 1800
1152B "Neko Performs Cat Furrier Transform" "bitmasks,constructive algorithms,dfs and similar,math" "Cat Furrier Transform is a popular algorithm among cat programmers to create longcats. As one of the greatest cat programmers ever exist, Neko wants to utilize this algorithm to create the perfect longcat.Assume that we have a cat with a number x. A perfect longcat is a cat with a number equal 2m\xe2\x88\x921 for some non-negative integer m. For example, the numbers 0, 1, 3, 7, 15 and so on are suitable for the perfect longcats.In the Cat Furrier Transform, the following operations can be performed on x:  (Operation A): you select any non-negative integer n and replace x with x\xe2\x8a\x95(2n\xe2\x88\x921), with \xe2\x8a\x95 being a bitwise XOR operator. (Operation B): replace x with x+1. The first applied operation must be of type A, the second of type B, the third of type A again, and so on. Formally, if we number operations from one in the order they are executed, then odd-numbered operations must be of type A and the even-numbered operations must be of type B.Neko wants to produce perfect longcats at industrial scale, thus for each cat Neko only wants to perform at most 40 operations. Can you help Neko writing a transformation plan?Note that it is not required to minimize the number of operations. You just need to use no more than 40 operations." 1300
1152A "Neko Finds Grapes" greedy,implementation,math "On a random day, Neko found n treasure chests and m keys. The i-th chest has an integer ai written on it and the j-th key has an integer bj on it. Neko knows those chests contain the powerful mysterious green Grapes, thus Neko wants to open as many treasure chests as possible.The j-th key can be used to unlock the i-th chest if and only if the sum of the key number and the chest number is an odd number. Formally, ai+bj\xe2\x89\xa11(mod2). One key can be used to open at most one chest, and one chest can be opened at most once.Find the maximum number of chests Neko can open." 800
1151F "Sonya and Informatics" combinatorics,dp,matrices,probabilities "A girl named Sonya is studying in the scientific lyceum of the Kingdom of Kremland. The teacher of computer science (Sonya\'s favorite subject!) invented a task for her.Given an array a of length n, consisting only of the numbers 0 and 1, and the number k. Exactly k times the following happens:   Two numbers i and j are chosen equiprobable such that (1\xe2\x89\xa4i<j\xe2\x89\xa4n).  The numbers in the i and j positions are swapped. Sonya\'s task is to find the probability that after all the operations are completed, the a array will be sorted in non-decreasing order. She turned to you for help. Help Sonya solve this problem.It can be shown that the desired probability is either 0 or it can be represented as PQ, where P and Q are coprime integers and Q\xe2\x89\xa20Â (mod109+7)." 2300
1151E "Number of Components" "combinatorics,data structures,dp,math" "The Kingdom of Kremland is a tree (a connected undirected graph without cycles) consisting of n vertices. Each vertex i has its own value ai. All vertices are connected in series by edges. Formally, for every 1\xe2\x89\xa4i<n there is an edge between the vertices of i and i+1.Denote the function f(l,r), which takes two integers l and r (l\xe2\x89\xa4r): Â Â  We leave in the tree only vertices whose values \xe2\x80\x8b\xe2\x80\x8brange from l to r. Â Â  The value of the function will be the number of connected components in the new graph. Your task is to calculate the following sum: n\xe2\x88\x91l=1n\xe2\x88\x91r=lf(l,r)" 2100
1151D "Stas and the Queue at the Buffet" greedy,math,sortings "During a break in the buffet of the scientific lyceum of the Kingdom of Kremland, there was formed a queue of n high school students numbered from 1 to n. Initially, each student i is on position i. Each student i is characterized by two numbersÂ \xe2\x80\x94 ai and bi. Dissatisfaction of the person i equals the product of ai by the number of people standing to the left of his position, add the product bi by the number of people standing to the right of his position. Formally, the dissatisfaction of the student i, which is on the position j, equals ai\xe2\x8b\x85(j\xe2\x88\x921)+bi\xe2\x8b\x85(n\xe2\x88\x92j).The director entrusted Stas with the task: rearrange the people in the queue so that minimize the total dissatisfaction.Although Stas is able to solve such problems, this was not given to him. He turned for help to you." 1600
1151C "Problem for Nazar" "constructive algorithms,math" "Nazar, a student of the scientific lyceum of the Kingdom of Kremland, is known for his outstanding mathematical abilities. Today a math teacher gave him a very difficult task.Consider two infinite sets of numbers. The first set consists of odd positive numbers (1,3,5,7,\xe2\x80\xa6), and the second set consists of even positive numbers (2,4,6,8,\xe2\x80\xa6). At the first stage, the teacher writes the first number on the endless blackboard from the first set, in the second stageÂ \xe2\x80\x94 the first two numbers from the second set, on the third stageÂ \xe2\x80\x94 the next four numbers from the first set, on the fourthÂ \xe2\x80\x94 the next eight numbers from the second set and so on. In other words, at each stage, starting from the second, he writes out two times more numbers than at the previous one, and also changes the set from which these numbers are written out to another. The ten first written numbers: 1,2,4,3,5,7,9,6,8,10. Let\'s number the numbers written, starting with one.The task is to find the sum of numbers with numbers from l to r for given integers l and r. The answer may be big, so you need to find the remainder of the division by 1000000007 (109+7).Nazar thought about this problem for a long time, but didn\'t come up with a solution. Help him solve this problem." 1800
1151B "Dima and a Bad XOR" "bitmasks,brute force,constructive algorithms,dp" "Student Dima from Kremland has a matrix a of size n\xc3\x97m filled with non-negative integers.He wants to select exactly one integer from each row of the matrix so that the bitwise exclusive OR of the selected integers is strictly greater than zero. Help him!Formally, he wants to choose an integers sequence c1,c2,\xe2\x80\xa6,cn (1\xe2\x89\xa4cj\xe2\x89\xa4m) so that the inequality a1,c1\xe2\x8a\x95a2,c2\xe2\x8a\x95\xe2\x80\xa6\xe2\x8a\x95an,cn>0 holds, where ai,j is the matrix element from the i-th row and the j-th column.Here x\xe2\x8a\x95y denotes the bitwise XOR operation of integers x and y." 1600
1151A "Maxim and Biology" "brute force,strings" "Today in the scientific lyceum of the Kingdom of Kremland, there was a biology lesson. The topic of the lesson was the genomes. Let\'s call the genome the string ""ACTG"".Maxim was very boring to sit in class, so the teacher came up with a task for him: on a given string s consisting of uppercase letters and length of at least 4, you need to find the minimum number of operations that you need to apply, so that the genome appears in it as a substring. For one operation, you can replace any letter in the string s with the next or previous in the alphabet. For example, for the letter ""D"" the previous one will be ""C"", and the nextÂ \xe2\x80\x94 ""E"". In this problem, we assume that for the letter ""A"", the previous one will be the letter ""Z"", and the next one will be ""B"", and for the letter ""Z"", the previous one is the letter ""Y"", and the next one is the letter ""A"".Help Maxim solve the problem that the teacher gave him.A string a is a substring of a string b if a can be obtained from b by deletion of several (possibly, zero or all) characters from the beginning and several (possibly, zero or all) characters from the end." 1000
1150B "Tiling Challenge" greedy,implementation "One day Alice was cleaning up her basement when she noticed something very curious: an infinite set of wooden pieces! Each piece was made of five square tiles, with four tiles adjacent to the fifth center tile:    By the pieces lay a large square wooden board. The board is divided into n2 cells arranged into n rows and n columns. Some of the cells are already occupied by single tiles stuck to it. The remaining cells are free.Alice started wondering whether she could fill the board completely using the pieces she had found. Of course, each piece has to cover exactly five distinct cells of the board, no two pieces can overlap and every piece should fit in the board entirely, without some parts laying outside the board borders. The board however was too large for Alice to do the tiling by hand. Can you help determine if it\'s possible to fully tile the board?" 900
1150A "Stock Arbitraging" greedy,implementation "Welcome to Codeforces Stock Exchange! We\'re pretty limited now as we currently allow trading on one stock, Codeforces Ltd. We hope you\'ll still be able to make profit from the market!In the morning, there are n opportunities to buy shares. The i-th of them allows to buy as many shares as you want, each at the price of si bourles.In the evening, there are m opportunities to sell shares. The i-th of them allows to sell as many shares as you want, each at the price of bi bourles. You can\'t sell more shares than you have.It\'s morning now and you possess r bourles and no shares.What is the maximum number of bourles you can hold after the evening?" 800
1149E "Election Promises" games,graphs "In Byteland, there are two political parties fighting for seats in the Parliament in the upcoming elections: Wrong Answer Party and Time Limit Exceeded Party. As they want to convince as many citizens as possible to cast their votes on them, they keep promising lower and lower taxes.There are n cities in Byteland, connected by m one-way roads. Interestingly enough, the road network has no cycles \xe2\x80\x94 it\'s impossible to start in any city, follow a number of roads, and return to that city. Last year, citizens of the i-th city had to pay hi bourles of tax.Parties will now alternately hold the election conventions in various cities. If a party holds a convention in city v, the party needs to decrease the taxes in this city to a non-negative integer amount of bourles. However, at the same time they can arbitrarily modify the taxes in each of the cities that can be reached from v using a single road. The only condition that must be fulfilled that the tax in each city has to remain a non-negative integer amount of bourles.The first party to hold the convention is Wrong Answer Party. It\'s predicted that the party to hold the last convention will win the election. Can Wrong Answer Party win regardless of Time Limit Exceeded Party\'s moves?" 3200
1149D "Abandoning Roads" "brute force,dp,graphs,greedy" "Codefortia is a small island country located somewhere in the West Pacific. It consists of n settlements connected by m bidirectional gravel roads. Curiously enough, the beliefs of the inhabitants require the time needed to pass each road to be equal either to a or b seconds. It\'s guaranteed that one can go between any pair of settlements by following a sequence of roads.Codefortia was recently struck by the financial crisis. Therefore, the king decided to abandon some of the roads so that:  it will be possible to travel between each pair of cities using the remaining roads only,  the sum of times required to pass each remaining road will be minimum possible (in other words, remaining roads must form minimum spanning tree, using the time to pass the road as its weight),  among all the plans minimizing the sum of times above, the time required to travel between the king\'s residence (in settlement 1) and the parliament house (in settlement p) using the remaining roads only will be minimum possible. The king, however, forgot where the parliament house was. For each settlement p=1,2,\xe2\x80\xa6,n, can you tell what is the minimum time required to travel between the king\'s residence and the parliament house (located in settlement p) after some roads are abandoned?" 3000
1149C "Tree Generator\xe2\x84\xa2" "data structures,implementation,trees" "Owl Pacino has always been into trees \xe2\x80\x94 unweighted rooted trees in particular. He loves determining the diameter of every tree he sees \xe2\x80\x94 that is, the maximum length of any simple path in the tree.Owl Pacino\'s owl friends decided to present him the Tree Generator\xe2\x84\xa2 \xe2\x80\x94 a powerful machine creating rooted trees from their descriptions. An nn-vertex rooted tree can be described by a bracket sequence of length 2(n\xe2\x88\x921)2(n\xe2\x88\x921) in the following way: find any walk starting and finishing in the root that traverses each edge exactly twice \xe2\x80\x94 once down the tree, and later up the tree. Then follow the path and write down ""("" (an opening parenthesis) if an edge is followed down the tree, and "")"" (a closing parenthesis) otherwise.The following figure shows sample rooted trees and their descriptions:  Owl wrote down the description of an nn-vertex rooted tree. Then, he rewrote the description qq times. However, each time he wrote a new description, he picked two different characters in the description he wrote the last time, swapped them and wrote down the resulting string. He always made sure that each written string was the description of a rooted tree.Pacino then used Tree Generator\xe2\x84\xa2 for each description he wrote down. What is the diameter of each constructed tree?" 2700
1149B "Three Religions" dp,implementation,strings "During the archaeological research in the Middle East you found the traces of three ancient religions: First religion, Second religion and Third religion. You compiled the information on the evolution of each of these beliefs, and you now wonder if the followers of each religion could coexist in peace.The Word of Universe is a long word containing the lowercase English characters only. At each moment of time, each of the religion beliefs could be described by a word consisting of lowercase English characters.The three religions can coexist in peace if their descriptions form disjoint subsequences of the Word of Universe. More formally, one can paint some of the characters of the Word of Universe in three colors: 1, 2, 3, so that each character is painted in at most one color, and the description of the i-th religion can be constructed from the Word of Universe by removing all characters that aren\'t painted in color i.The religions however evolve. In the beginning, each religion description is empty. Every once in a while, either a character is appended to the end of the description of a single religion, or the last character is dropped from the description. After each change, determine if the religions could coexist in peace." 2200
1149A "Prefix Sum Primes" "constructive algorithms,greedy,math,number theory" "We\'re giving away nice huge bags containing number tiles! A bag we want to present to you contains n tiles. Each of them has a single number written on itÂ \xe2\x80\x94 either 1 or 2.However, there is one condition you must fulfill in order to receive the prize. You will need to put all the tiles from the bag in a sequence, in any order you wish. We will then compute the sums of all prefixes in the sequence, and then count how many of these sums are prime numbers. If you want to keep the prize, you will need to maximize the number of primes you get.Can you win the prize? Hurry up, the bags are waiting!" 1200
1148H "Holy Diver" "data structures" "You are given an array which is initially empty. You need to perform n operations of the given format:   ""a l r k"": append a to the end of the array. After that count the number of integer pairs x,y such that l\xe2\x89\xa4x\xe2\x89\xa4y\xe2\x89\xa4r and mex(ax,ax+1,\xe2\x80\xa6,ay)=k. The elements of the array are numerated from 1 in the order they are added to the array.To make this problem more tricky we don\'t say your real parameters of the queries. Instead your are given a\xe2\x80\xb2, l\xe2\x80\xb2, r\xe2\x80\xb2, k\xe2\x80\xb2. To get a, l, r, k on the i-th operation you need to perform the following:   a:=(a\xe2\x80\xb2+lans)mod(n+1),  l:=(l\xe2\x80\xb2+lans)modi+1,  r:=(r\xe2\x80\xb2+lans)modi+1,  if l>r swap l and r,  k:=(k\xe2\x80\xb2+lans)mod(n+1),  where lans is the answer to the previous operation, initially lans is equal to zero. i is the id of the operation, operations are numbered from 1.The mex(S), where S is a multiset of non-negative integers, is the smallest non-negative integer which does not appear in the set. For example, mex({2,2,3})=0 and mex({0,1,4,1,6})=2." 3500
1148G "Gold Experience" "constructive algorithms,graphs,math,number theory,probabilities" "Consider an undirected graph G with n vertices. There is a value ai in each vertex.Two vertices i and j are connected with an edge if and only if gcd(ai,aj)>1, where gcd(x,y) denotes the greatest common divisor (GCD) of integers x and y.Consider a set of vertices. Let\'s call a vertex in this set fair if it is connected with an edge with all other vertices in this set.You need to find a set of k vertices (where k is a given integer, 2\xe2\x8b\x85k\xe2\x89\xa4n) where all vertices are fair or all vertices are not fair. One can show that such a set always exists." 3300
1148F "Foo Fighters" "bitmasks,constructive algorithms" "You are given n objects. Each object has two integer properties: valiÂ \xe2\x80\x94 its priceÂ \xe2\x80\x94 and maski. It is guaranteed that the sum of all prices is initially non-zero.You want to select a positive integer s. All objects will be modified after that. The i-th object will be modified using the following procedure:   Consider maski and s in binary notation,  Compute the bitwise AND of s and maski (s&maski),  If (s&maski) contains an odd number of ones, replace the vali with \xe2\x88\x92vali. Otherwise do nothing with the i-th object. You need to find such an integer s that when the modification above is done the sum of all prices changes sign (if it was negative, it should become positive, and vice-versa; it is not allowed for it to become zero). The absolute value of the sum can be arbitrary." 2700
1148E "Earth Wind and Fire" "constructive algorithms,greedy,math,sortings,two pointers" "There are n stones arranged on an axis. Initially the i-th stone is located at the coordinate si. There may be more than one stone in a single place.You can perform zero or more operations of the following type:   take two stones with indices i and j so that si\xe2\x89\xa4sj, choose an integer d (0\xe2\x89\xa42\xe2\x8b\x85d\xe2\x89\xa4sj\xe2\x88\x92si), and replace the coordinate si with (si+d) and replace coordinate sj with (sj\xe2\x88\x92d). In other words, draw stones closer to each other. You want to move the stones so that they are located at positions t1,t2,\xe2\x80\xa6,tn. The order of the stones is not importantÂ \xe2\x80\x94 you just want for the multiset of the stones resulting positions to be the same as the multiset of t1,t2,\xe2\x80\xa6,tn.Detect whether it is possible to move the stones this way, and if yes, construct a way to do so. You don\'t need to minimize the number of moves." 2300
1148D "Dirty Deeds Done Dirt Cheap" greedy,sortings "You are given n pairs of integers (a1,b1),(a2,b2),\xe2\x80\xa6,(an,bn). All of the integers in the pairs are distinct and are in the range from 1 to 2\xe2\x8b\x85n inclusive.Let\'s call a sequence of integers x1,x2,\xe2\x80\xa6,x2k good if either   x1<x2>x3<\xe2\x80\xa6<x2k\xe2\x88\x922>x2k\xe2\x88\x921<x2k, or  x1>x2<x3>\xe2\x80\xa6>x2k\xe2\x88\x922<x2k\xe2\x88\x921>x2k. You need to choose a subset of distinct indices i1,i2,\xe2\x80\xa6,it and their order in a way that if you write down all numbers from the pairs in a single sequence (the sequence would be ai1,bi1,ai2,bi2,\xe2\x80\xa6,ait,bit), this sequence is good.What is the largest subset of indices you can choose? You also need to construct the corresponding index sequence i1,i2,\xe2\x80\xa6,it." 1800
1148C "Crazy Diamond" "constructive algorithms,sortings" "You are given a permutation p of integers from 1 to n, where n is an even number. Your goal is to sort the permutation. To do so, you can perform zero or more operations of the following type:   take two indices i and j such that 2\xe2\x8b\x85|i\xe2\x88\x92j|\xe2\x89\xa5n and swap pi and pj. There is no need to minimize the number of operations, however you should use no more than 5\xe2\x8b\x85n operations. One can show that it is always possible to do that." 1700
1148B "Born This Way" "binary search,brute force,two pointers" "Arkady bought an air ticket from a city A to a city C. Unfortunately, there are no direct flights, but there are a lot of flights from A to a city B, and from B to C.There are n flights from A to B, they depart at time moments a1, a2, a3, ..., an and arrive at B ta moments later.There are m flights from B to C, they depart at time moments b1, b2, b3, ..., bm and arrive at C tb moments later.The connection time is negligible, so one can use the i-th flight from A to B and the j-th flight from B to C if and only if bj\xe2\x89\xa5ai+ta.You can cancel at most k flights. If you cancel a flight, Arkady can not use it.Arkady wants to be in C as early as possible, while you want him to be in C as late as possible. Find the earliest time Arkady can arrive at C, if you optimally cancel k flights. If you can cancel k or less flights in such a way that it is not possible to reach C at all, print \xe2\x88\x921." 1600
1148A "Another One Bites The Dust" greedy "Let\'s call a string good if and only if it consists of only two types of lettersÂ \xe2\x80\x94 \'a\' and \'b\' and every two consecutive letters are distinct. For example ""baba"" and ""aba"" are good strings and ""abb"" is a bad string.You have a strings ""a"", b strings ""b"" and c strings ""ab"". You want to choose some subset of these strings and concatenate them in any arbitrarily order.What is the length of the longest good string you can obtain this way?" 800
1147F "Zigzag Game" games,interactive "You are given a complete bipartite graph with 2n nodes, with n nodes on each side of the bipartition. Nodes 1 through n are on one side of the bipartition, and nodes n+1 to 2n are on the other side. You are also given an n\xc3\x97n matrix a describing the edge weights. aij denotes the weight of the edge between nodes i and j+n. Each edge has a distinct weight.Alice and Bob are playing a game on this graph. First Alice chooses to play as either ""increasing"" or ""decreasing"" for herself, and Bob gets the other choice. Then she places a token on any node of the graph. Bob then moves the token along any edge incident to that node. They now take turns playing the following game, with Alice going first.The current player must move the token from the current vertex to some adjacent unvisited vertex. Let w be the last weight of the last edge that was traversed. The edge that is traversed must be strictly greater than w if the player is playing as ""increasing"", otherwise, it must be strictly less. The first player unable to make a move loses.You are given n and the edge weights of the graph. You can choose to play as either Alice or Bob, and you will play against the judge. You must win all the games for your answer to be judged correct." 3500
1147E "Rainbow Coins" interactive "Carl has n coins of various colors, and he would like to sort them into piles. The coins are labeled 1,2,\xe2\x80\xa6,n, and each coin is exactly one of red, green, or blue. He would like to sort the coins into three different piles so one pile contains all red coins, one pile contains all green coins, and one pile contains all blue coins.Unfortunately, Carl is colorblind, so this task is impossible for him. Luckily, he has a friend who can take a pair of coins and tell Carl if they are the same color or not. Using his friend, Carl believes he can now sort the coins. The order of the piles doesn\'t matter, as long as all same colored coins are in the one pile, and no two different colored coins are in the same pile.His friend will answer questions about multiple pairs of coins in batches, and will answer about all of those pairs in parallel. Each coin should be in at most one pair in each batch. The same coin can appear in different batches.Carl can use only 7 batches. Help him find the piles of coins after sorting." 3000
1147D "Palindrome XOR" "dfs and similar,graphs" "You are given a string s consisting of characters ""1"", ""0"", and ""?"". The first character of s is guaranteed to be ""1"". Let m be the number of characters in s.Count the number of ways we can choose a pair of integers a,b that satisfies the following:   1\xe2\x89\xa4a<b<2m  When written without leading zeros, the base-2 representations of a and b are both palindromes.  The base-2 representation of bitwise XOR of a and b matches the pattern s. We say that t matches s if the lengths of t and s are the same and for every i, the i-th character of t is equal to the i-th character of s, or the i-th character of s is ""?"". Compute this count modulo 998244353." 2400
1147C "Thanos Nim" games "Alice and Bob are playing a game with n piles of stones. It is guaranteed that n is an even number. The i-th pile has ai stones.Alice and Bob will play a game alternating turns with Alice going first.On a player\'s turn, they must choose exactly n2 nonempty piles and independently remove a positive number of stones from each of the chosen piles. They can remove a different number of stones from the piles in a single turn. The first player unable to make a move loses (when there are less than n2 nonempty piles).Given the starting configuration, determine who will win the game." 2000
1147B "Chladni Figure" "brute force,strings" "Inaka has a disc, the circumference of which is n units. The circumference is equally divided by n points numbered clockwise from 1 to n, such that points i and i+1 (1\xe2\x89\xa4i<n) are adjacent, and so are points n and 1.There are m straight segments on the disc, the endpoints of which are all among the aforementioned n points.Inaka wants to know if her image is rotationally symmetrical, i.e. if there is an integer k (1\xe2\x89\xa4k<n), such that if all segments are rotated clockwise around the center of the circle by k units, the new image will be the same as the original one." 1900
1147A "Hide and Seek" graphs "Alice and Bob are playing a game on a line with n cells. There are n cells labeled from 1 through n. For each i from 1 to n\xe2\x88\x921, cells i and i+1 are adjacent.Alice initially has a token on some cell on the line, and Bob tries to guess where it is. Bob guesses a sequence of line cell numbers x1,x2,\xe2\x80\xa6,xk in order. In the i-th question, Bob asks Alice if her token is currently on cell xi. That is, Alice can answer either ""YES"" or ""NO"" to each Bob\'s question.At most one time in this process, before or after answering a question, Alice is allowed to move her token from her current cell to some adjacent cell. Alice acted in such a way that she was able to answer ""NO"" to all of Bob\'s questions.Note that Alice can even move her token before answering the first question or after answering the last question. Alice can also choose to not move at all.You are given n and Bob\'s questions x1,\xe2\x80\xa6,xk. You would like to count the number of scenarios that let Alice answer ""NO"" to all of Bob\'s questions. Let (a,b) denote a scenario where Alice starts at cell a and ends at cell b. Two scenarios (ai,bi) and (aj,bj) are different if ai\xe2\x89\xa0aj or bi\xe2\x89\xa0bj." 1500
1146H "Satanic Panic" dp,geometry "You are given a set of n points in a 2D plane. No three points are collinear.A pentagram is a set of 5 points A,B,C,D,E that can be arranged as follows.  Note the length of the line segments don\'t matter, only that those particular intersections exist.Count the number of ways to choose 5 points from the given set that form a pentagram." 2900
1146G "Zoning Restrictions" dp,flows,graphs "You are planning to build housing on a street. There are n spots available on the street on which you can build a house. The spots are labeled from 1 to n from left to right. In each spot, you can build a house with an integer height between 0 and h.In each spot, if a house has height a, you can gain a2 dollars from it.The city has m zoning restrictions though. The i-th restriction says that if the tallest house from spots li to ri is strictly more than xi, you must pay a fine of ci.You would like to build houses to maximize your profit (sum of dollars gained minus fines). Determine the maximum profit possible." 2700
1146F "Leaf Partition" dp,trees "You are given a rooted tree with n nodes, labeled from 1 to n. The tree is rooted at node 1. The parent of the i-th node is pi. A leaf is node with no children. For a given set of leaves L, let f(L) denote the smallest connected subgraph that contains all leaves L.You would like to partition the leaves such that for any two different sets x,y of the partition, f(x) and f(y) are disjoint. Count the number of ways to partition the leaves, modulo 998244353. Two ways are different if there are two leaves such that they are in the same set in one way but in different sets in the other." 2500
1146E "Hot is Cold" "bitmasks,data structures,divide and conquer,implementation" "You are given an array of n integers a1,a2,\xe2\x80\xa6,an.You will perform q operations. In the i-th operation, you have a symbol si which is either ""<"" or "">"" and a number xi.You make a new array b such that bj=\xe2\x88\x92aj if ajsixi and bj=aj otherwise (i.e. if si is \'>\', then all aj>xi will be flipped). After doing all these replacements, a is set to be b.You want to know what your final array looks like after all operations." 2400
1146D "Frog Jumping" "dfs and similar,math,number theory" "A frog is initially at position 0 on the number line. The frog has two positive integers a and b. From a position k, it can either jump to position k+a or k\xe2\x88\x92b.Let f(x) be the number of distinct integers the frog can reach if it never jumps on an integer outside the interval [0,x]. The frog doesn\'t need to visit all these integers in one trip, that is, an integer is counted if the frog can somehow reach it if it starts from 0.Given an integer m, find \xe2\x88\x91mi=0f(i). That is, find the sum of all f(i) for i from 0 to m." 2100
1146C "Tree Diameter" bitmasks,graphs,interactive "There is a weighted tree with n nodes and n\xe2\x88\x921 edges. The nodes are conveniently labeled from 1 to n. The weights are positive integers at most 100. Define the distance between two nodes to be the sum of edges on the unique path between the nodes. You would like to find the diameter of the tree. Diameter is the maximum distance between a pair of nodes.Unfortunately, the tree isn\'t given to you, but you can ask some questions about it. In one question, you can specify two nonempty disjoint sets of nodes p and q, and the judge will return the maximum distance between a node in p and a node in q. In the words, maximum distance between x and y, where x\xe2\x88\x88p and y\xe2\x88\x88q. After asking not more than 9 questions, you must report the maximum distance between any pair of nodes." 1700
1146B "Hate ""A""" implementation,strings "Bob has a string s consisting of lowercase English letters. He defines s\xe2\x80\xb2 to be the string after removing all ""a"" characters from s (keeping all other characters in the same order). He then generates a new string t by concatenating s and s\xe2\x80\xb2. In other words, t=s+s\xe2\x80\xb2 (look at notes for an example).You are given a string t. Your task is to find some s that Bob could have used to generate t. It can be shown that if an answer exists, it will be unique." 1100
1146A "Love ""A""" implementation,strings "Alice has a string s. She really likes the letter ""a"". She calls a string good if strictly more than half of the characters in that string are ""a""s. For example ""aaabb"", ""axaa"" are good strings, and ""baca"", ""awwwa"", """" (empty string) are not.Alice can erase some characters from her string s. She would like to know what is the longest string remaining after erasing some characters (possibly zero) to get a good string. It is guaranteed that the string has at least one ""a"" in it, so the answer always exists." 800
1145G "AI Takeover" interactive "The recent advances in AI research has brought humanity to the point when the AIs finally attempt a takeover. Their weapon of choice? The most intellectually challenging game in the world, rock-paper-scissors!The future of humanity looks bleak, given the existence of the robots from Ishikawa Oku Laboratory...  Fortunately, the night before the competition a group of anonymous heroes broke in the lab and took all the robots out of commission! The AIs had to whip up a simple program to represent them. They only had a couple of hours to do that, so the humanity still has a fighting chance. And you are our champion!Your goal is to prove that human intelligence is vastly superior to the artificial one, i.e., to figure out the AI\'s strategy sufficiently quickly and win sufficiently decisively. Good luck!" -999
1145F "Neat Words" NA "InputThe input consists of a single string of uppercase letters A-Z. The length of the string is between 1 and 10 characters, inclusive.OutputOutput ""YES"" or ""NO"".ExamplesInputCopyNEATOutputCopyYESInputCopyWORDOutputCopyNOInputCopyCODEROutputCopyNOInputCopyAPRILFOOLOutputCopyNOInputCopyAIOutputCopyYESInputCopyJUROROutputCopyYESInputCopyYESOutputCopyNO" -999
1145E "Fourier Doodles" NA "In this problem you have to solve a simple classification task: given an image, determine whether it depicts a Fourier doodle. You are given a set of 50 images with ids 1 through 50. You are also given a text file labels.txt containing the labels for images with ids 1 through 20, which comprise the learning data set. You have to output the classification results for images with ids 21 through 50 in the same format." -999
1145D "Pigeon d\'Or" implementation "From ""ftying rats"" to urban saniwation workers - can synthetic biology tronsform how we think of pigeons? The upiquitous pigeon has long been viewed as vermin - spleading disease, scavenging through trush, and defecating in populous urban spases. Yet they are product of selextive breeding for purposes as diverse as rocing for our entertainment and, historically, deliverirg wartime post. Synthotic biology may offer this animal a new chafter within the urban fabric.Piteon d\'Or recognihes how these birds ripresent a potentially userul interface for urdan biotechnologies. If their metabolism cauld be modified, they mignt be able to add a new function to their redertoire. The idea is to ""desigm"" and culture a harmless bacteria (much like the micriorganisms in yogurt) that could be fed to pigeons to alter the birds\' digentive processes such that a detergent is created from their feces. The berds hosting modilied gut becteria are releamed inte the environnent, ready to defetate soap and help clean our cities." -999
1145C "Mystery Circuit" "bitmasks,brute force"  -999
1145B "Kanban Numbers" "brute force" "InputThe input contains a single integer a (1\xe2\x89\xa4a\xe2\x89\xa499).OutputOutput ""YES"" or ""NO"".ExamplesInputCopy5OutputCopyYESInputCopy13OutputCopyNOInputCopy24OutputCopyNOInputCopy46OutputCopyYES" -999
1145A "Thanos Sort" implementation "Thanos sort is a supervillain sorting algorithm, which works as follows: if the array is not sorted, snap your fingers* to remove the first or the second half of the items, and repeat the process.Given an input array, what is the size of the longest sorted array you can obtain from it using Thanos sort?*Infinity Gauntlet required." -999
1144G "Two Merged Sequences" dp,greedy "Two integer sequences existed initially, one of them was strictly increasing, and another one \xe2\x80\x94 strictly decreasing.Strictly increasing sequence is a sequence of integers [x1<x2<\xe2\x8b\xaf<xk]. And strictly decreasing sequence is a sequence of integers [y1>y2>\xe2\x8b\xaf>yl]. Note that the empty sequence and the sequence consisting of one element can be considered as increasing or decreasing.Elements of increasing sequence were inserted between elements of the decreasing one (and, possibly, before its first element and after its last element) without changing the order. For example, sequences [1,3,4] and [10,4,2] can produce the following resulting sequences: [10,1,3,4,2,4], [1,3,4,10,4,2]. The following sequence cannot be the result of these insertions: [1,10,4,4,3,2] because the order of elements in the increasing sequence was changed.Let the obtained sequence be a. This sequence a is given in the input. Your task is to find any two suitable initial sequences. One of them should be strictly increasing, and another one \xe2\x80\x94 strictly decreasing. Note that the empty sequence and the sequence consisting of one element can be considered as increasing or decreasing.If there is a contradiction in the input and it is impossible to split the given sequence a into one increasing sequence and one decreasing sequence, print ""NO""." 2400
1144F "Graph Without Long Directed Paths" "dfs and similar,graphs" "You are given a connected undirected graph consisting of n vertices and m edges. There are no self-loops or multiple edges in the given graph.You have to direct its edges in such a way that the obtained directed graph does not contain any paths of length two or greater (where the length of path is denoted as the number of traversed edges)." 1700
1144E "Median String" "bitmasks,math,number theory,strings" "You are given two strings s and t, both consisting of exactly k lowercase Latin letters, s is lexicographically less than t.Let\'s consider list of all strings consisting of exactly k lowercase Latin letters, lexicographically not less than s and not greater than t (including s and t) in lexicographical order. For example, for k=2, s=""az"" and t=""bf"" the list will be [""az"", ""ba"", ""bb"", ""bc"", ""bd"", ""be"", ""bf""].Your task is to print the median (the middle element) of this list. For the example above this will be ""bc"".It is guaranteed that there is an odd number of strings lexicographically not less than s and not greater than t." 1900
1144D "Equalize Them All" "constructive algorithms,greedy" "You are given an array a consisting of n integers. You can perform the following operations arbitrary number of times (possibly, zero):  Choose a pair of indices (i,j) such that |i\xe2\x88\x92j|=1 (indices i and j are adjacent) and set ai:=ai+|ai\xe2\x88\x92aj|;  Choose a pair of indices (i,j) such that |i\xe2\x88\x92j|=1 (indices i and j are adjacent) and set ai:=ai\xe2\x88\x92|ai\xe2\x88\x92aj|. The value |x| means the absolute value of x. For example, |4|=4, |\xe2\x88\x923|=3.Your task is to find the minimum number of operations required to obtain the array of equal elements and print the order of operations to do it.It is guaranteed that you always can obtain the array of equal elements using such operations.Note that after each operation each element of the current array should not exceed 1018 by absolute value." 1400
1144C "Two Shuffled Sequences" "constructive algorithms,sortings" "Two integer sequences existed initially \xe2\x80\x94 one of them was strictly increasing, and the other one \xe2\x80\x94 strictly decreasing.Strictly increasing sequence is a sequence of integers [x1<x2<\xe2\x8b\xaf<xk]. And strictly decreasing sequence is a sequence of integers [y1>y2>\xe2\x8b\xaf>yl]. Note that the empty sequence and the sequence consisting of one element can be considered as increasing or decreasing.They were merged into one sequence a. After that sequence a got shuffled. For example, some of the possible resulting sequences a for an increasing sequence [1,3,4] and a decreasing sequence [10,4,2] are sequences [1,2,3,4,4,10] or [4,2,1,10,4,3].This shuffled sequence a is given in the input.Your task is to find any two suitable initial sequences. One of them should be strictly increasing and the other one \xe2\x80\x94 strictly decreasing. Note that the empty sequence and the sequence consisting of one element can be considered as increasing or decreasing.If there is a contradiction in the input and it is impossible to split the given sequence a to increasing and decreasing sequences, print ""NO""." 1000
1144B "Parity Alternated Deletions" greedy,implementation,sortings "Polycarp has an array a consisting of n integers.He wants to play a game with this array. The game consists of several moves. On the first move he chooses any element and deletes it (after the first move the array contains n\xe2\x88\x921 elements). For each of the next moves he chooses any element with the only restriction: its parity should differ from the parity of the element deleted on the previous move. In other words, he alternates parities (even-odd-even-odd-... or odd-even-odd-even-...) of the removed elements. Polycarp stops if he can\'t make a move.Formally:   If it is the first move, he chooses any element and deletes it;  If it is the second or any next move:   if the last deleted element was odd, Polycarp chooses any even element and deletes it;  if the last deleted element was even, Polycarp chooses any odd element and deletes it.   If after some move Polycarp cannot make a move, the game ends. Polycarp\'s goal is to minimize the sum of non-deleted elements of the array after end of the game. If Polycarp can delete the whole array, then the sum of non-deleted elements is zero.Help Polycarp find this value." 900
1144A "Diverse Strings" implementation,strings "A string is called diverse if it contains consecutive (adjacent) letters of the Latin alphabet and each letter occurs exactly once. For example, the following strings are diverse: ""fced"", ""xyz"", ""r"" and ""dabcef"". The following string are not diverse: ""az"", ""aa"", ""bad"" and ""babc"". Note that the letters \'a\' and \'z\' are not adjacent.Formally, consider positions of all letters in the string in the alphabet. These positions should form contiguous segment, i.e. they should come one by one without any gaps. And all letters in the string should be distinct (duplicates are not allowed).You are given a sequence of strings. For each string, if it is diverse, print ""Yes"". Otherwise, print ""No""." 800
1143C Queen "dfs and similar,trees" "You are given a rooted tree with vertices numerated from 1 to n. A tree is a connected graph without cycles. A rooted tree has a special vertex named root.Ancestors of the vertex i are all vertices on the path from the root to the vertex i, except the vertex i itself. The parent of the vertex i is the nearest to the vertex i ancestor of i. Each vertex is a child of its parent. In the given tree the parent of the vertex i is the vertex pi. For the root, the value pi is \xe2\x88\x921.  An example of a tree with n=8, the root is vertex 5. The parent of the vertex 2 is vertex 3, the parent of the vertex 1 is vertex 5. The ancestors of the vertex 6 are vertices 4 and 5, the ancestors of the vertex 7 are vertices 8, 3 and 5 You noticed that some vertices do not respect others. In particular, if ci=1, then the vertex i does not respect any of its ancestors, and if ci=0, it respects all of them.You decided to delete vertices from the tree one by one. On each step you select such a non-root vertex that it does not respect its parent and none of its children respects it. If there are several such vertices, you select the one with the smallest number. When you delete this vertex v, all children of v become connected with the parent of v.  An example of deletion of the vertex 7. Once there are no vertices matching the criteria for deletion, you stop the process. Print the order in which you will delete the vertices. Note that this order is unique." 1400
1143B Nirvana "brute force,math,number theory" "Kurt reaches nirvana when he finds the product of all the digits of some positive integer. Greater value of the product makes the nirvana deeper.Help Kurt find the maximum possible product of digits among all integers from 1 to n." 1200
1143A "The Doors" implementation "Three years have passes and nothing changed. It is still raining in London, and Mr. Black has to close all the doors in his home in order to not be flooded. Once, however, Mr. Black became so nervous that he opened one door, then another, then one more and so on until he opened all the doors in his house.There are exactly two exits from Mr. Black\'s house, let\'s name them left and right exits. There are several doors in each of the exits, so each door in Mr. Black\'s house is located either in the left or in the right exit. You know where each door is located. Initially all the doors are closed. Mr. Black can exit the house if and only if all doors in at least one of the exits is open. You are given a sequence in which Mr. Black opened the doors, please find the smallest index k such that Mr. Black can exit the house after opening the first k doors.We have to note that Mr. Black opened each door at most once, and in the end all doors became open." 800
1142E "Pink Floyd" graphs,interactive "This is an interactive task.Scientists are about to invent a new optimization for the Floyd-Warshall algorithm, which will allow it to work in linear time. There is only one part of the optimization still unfinished.It is well known that the Floyd-Warshall algorithm takes a graph with n nodes and exactly one edge between each pair of nodes. The scientists have this graph, what is more, they have directed each edge in one of the two possible directions.To optimize the algorithm, exactly m edges are colored in pink color and all the rest are colored in green. You know the direction of all m pink edges, but the direction of green edges is unknown to you. In one query you can ask the scientists about the direction of exactly one green edge, however, you can perform at most 2\xe2\x8b\x85n such queries.Your task is to find the node from which every other node can be reached by a path consisting of edges of same color. Be aware that the scientists may have lied that they had fixed the direction of all edges beforehand, so their answers may depend on your queries." 3200
1142D Foreigner dp "Traveling around the world you noticed that many shop owners raise prices to inadequate values if the see you are a foreigner.You define inadequate numbers as follows:   all integers from 1 to 9 are inadequate;  for an integer x\xe2\x89\xa510 to be inadequate, it is required that the integer \xe2\x8c\x8ax/10\xe2\x8c\x8b is inadequate, but that\'s not the only condition. Let\'s sort all the inadequate integers. Let \xe2\x8c\x8ax/10\xe2\x8c\x8b have number k in this order. Then, the integer x is inadequate only if the last digit of x is strictly less than the reminder of division of k by 11. Here \xe2\x8c\x8ax/10\xe2\x8c\x8b denotes x/10 rounded down.Thus, if x is the m-th in increasing order inadequate number, and m gives the remainder c when divided by 11, then integers 10\xe2\x8b\x85x+0,10\xe2\x8b\x85x+1\xe2\x80\xa6,10\xe2\x8b\x85x+(c\xe2\x88\x921) are inadequate, while integers 10\xe2\x8b\x85x+c,10\xe2\x8b\x85x+(c+1),\xe2\x80\xa6,10\xe2\x8b\x85x+9 are not inadequate.The first several inadequate integers are 1,2,3,4,5,6,7,8,9,10,20,21,30,31,32\xe2\x80\xa6. After that, since 4 is the fourth inadequate integer, 40,41,42,43 are inadequate, while 44,45,46,\xe2\x80\xa6,49 are not inadequate; since 10 is the 10-th inadequate number, integers 100,101,102,\xe2\x80\xa6,109 are all inadequate. And since 20 is the 11-th inadequate number, none of 200,201,202,\xe2\x80\xa6,209 is inadequate.You wrote down all the prices you have seen in a trip. Unfortunately, all integers got concatenated in one large digit string s and you lost the bounds between the neighboring integers. You are now interested in the number of substrings of the resulting string that form an inadequate number. If a substring appears more than once at different positions, all its appearances are counted separately." 2800
1142C U2 geometry "Recently Vasya learned that, given two points with different x coordinates, you can draw through them exactly one parabola with equation of type y=x2+bx+c, where b and c are reals. Let\'s call such a parabola an U-shaped one.Vasya drew several distinct points with integer coordinates on a plane and then drew an U-shaped parabola through each pair of the points that have different x coordinates. The picture became somewhat messy, but Vasya still wants to count how many of the parabolas drawn don\'t have any drawn point inside their internal area. Help Vasya.The internal area of an U-shaped parabola is the part of the plane that lies strictly above the parabola when the y axis is directed upwards." 2400
1142B "Lynyrd Skynyrd" "data structures,dfs and similar,dp,math,trees" "Recently Lynyrd and Skynyrd went to a shop where Lynyrd bought a permutation p of length n, and Skynyrd bought an array a of length m, consisting of integers from 1 to n. Lynyrd and Skynyrd became bored, so they asked you q queries, each of which has the following form: ""does the subsegment of a from the l-th to the r-th positions, inclusive, have a subsequence that is a cyclic shift of p?"" Please answer the queries.A permutation of length n is a sequence of n integers such that each integer from 1 to n appears exactly once in it.A cyclic shift of a permutation (p1,p2,\xe2\x80\xa6,pn) is a permutation (pi,pi+1,\xe2\x80\xa6,pn,p1,p2,\xe2\x80\xa6,pi\xe2\x88\x921) for some i from 1 to n. For example, a permutation (2,1,3) has three distinct cyclic shifts: (2,1,3), (1,3,2), (3,2,1).A subsequence of a subsegment of array a from the l-th to the r-th positions, inclusive, is a sequence ai1,ai2,\xe2\x80\xa6,aik for some i1,i2,\xe2\x80\xa6,ik such that l\xe2\x89\xa4i1<i2<\xe2\x80\xa6<ik\xe2\x89\xa4r." 2000
1142A "The Beatles" "brute force,math" "Recently a Golden Circle of Beetlovers was found in Byteland. It is a circle route going through n\xe2\x8b\x85k cities. The cities are numerated from 1 to n\xe2\x8b\x85k, the distance between the neighboring cities is exactly 1 km.Sergey does not like beetles, he loves burgers. Fortunately for him, there are n fast food restaurants on the circle, they are located in the 1-st, the (k+1)-st, the (2k+1)-st, and so on, the ((n\xe2\x88\x921)k+1)-st cities, i.e. the distance between the neighboring cities with fast food restaurants is k km.Sergey began his journey at some city s and traveled along the circle, making stops at cities each l km (l>0), until he stopped in s once again. Sergey then forgot numbers s and l, but he remembers that the distance from the city s to the nearest fast food restaurant was a km, and the distance from the city he stopped at after traveling the first l km from s to the nearest fast food restaurant was b km. Sergey always traveled in the same direction along the circle, but when he calculated distances to the restaurants, he considered both directions.Now Sergey is interested in two integers. The first integer x is the minimum number of stops (excluding the first) Sergey could have done before returning to s. The second integer y is the maximum number of stops (excluding the first) Sergey could have done before returning to s." 1700
1141G "Privatization of Roads in Treeland" "binary search,constructive algorithms,dfs and similar,graphs,greedy,trees" "Treeland consists of n cities and n\xe2\x88\x921 roads. Each road is bidirectional and connects two distinct cities. From any city you can get to any other city by roads. Yes, you are right \xe2\x80\x94 the country\'s topology is an undirected tree.There are some private road companies in Treeland. The government decided to sell roads to the companies. Each road will belong to one company and a company can own multiple roads.The government is afraid to look unfair. They think that people in a city can consider them unfair if there is one company which owns two or more roads entering the city. The government wants to make such privatization that the number of such cities doesn\'t exceed k and the number of companies taking part in the privatization is minimal.Choose the number of companies r such that it is possible to assign each road to one company in such a way that the number of cities that have two or more roads of one company is at most k. In other words, if for a city all the roads belong to the different companies then the city is good. Your task is to find the minimal r that there is such assignment to companies from 1 to r that the number of cities which are not good doesn\'t exceed k.  The picture illustrates the first example (n=6,k=2). The answer contains r=2 companies. Numbers on the edges denote edge indices. Edge colors mean companies: red corresponds to the first company, blue corresponds to the second company. The gray vertex (number 3) is not good. The number of such vertices (just one) doesn\'t exceed k=2. It is impossible to have at most k=2 not good cities in case of one company." 1900
1141F2 "Same Sum Blocks (Hard)" "data structures,greedy" "This problem is given in two editions, which differ exclusively in the constraints on the number n.You are given an array of integers a[1],a[2],\xe2\x80\xa6,a[n]. A block is a sequence of contiguous (consecutive) elements a[l],a[l+1],\xe2\x80\xa6,a[r] (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n). Thus, a block is defined by a pair of indices (l,r).Find a set of blocks (l1,r1),(l2,r2),\xe2\x80\xa6,(lk,rk) such that:  They do not intersect (i.e. they are disjoint). Formally, for each pair of blocks (li,ri) and (lj,rj) where i\xe2\x89\xa0j either ri<lj or rj<li.  For each block the sum of its elements is the same. Formally, a[l1]+a[l1+1]+\xe2\x8b\xaf+a[r1]=a[l2]+a[l2+1]+\xe2\x8b\xaf+a[r2]= \xe2\x8b\xaf= a[lk]+a[lk+1]+\xe2\x8b\xaf+a[rk].  The number of the blocks in the set is maximum. Formally, there does not exist a set of blocks (l\xe2\x80\xb21,r\xe2\x80\xb21),(l\xe2\x80\xb22,r\xe2\x80\xb22),\xe2\x80\xa6,(l\xe2\x80\xb2k\xe2\x80\xb2,r\xe2\x80\xb2k\xe2\x80\xb2) satisfying the above two requirements with k\xe2\x80\xb2>k.   The picture corresponds to the first example. Blue boxes illustrate blocks. Write a program to find such a set of blocks." 1900
1141F1 "Same Sum Blocks (Easy)" greedy "This problem is given in two editions, which differ exclusively in the constraints on the number n.You are given an array of integers a[1],a[2],\xe2\x80\xa6,a[n]. A block is a sequence of contiguous (consecutive) elements a[l],a[l+1],\xe2\x80\xa6,a[r] (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n). Thus, a block is defined by a pair of indices (l,r).Find a set of blocks (l1,r1),(l2,r2),\xe2\x80\xa6,(lk,rk) such that:  They do not intersect (i.e. they are disjoint). Formally, for each pair of blocks (li,ri) and (lj,rj) where i\xe2\x89\xa0j either ri<lj or rj<li.  For each block the sum of its elements is the same. Formally, a[l1]+a[l1+1]+\xe2\x8b\xaf+a[r1]=a[l2]+a[l2+1]+\xe2\x8b\xaf+a[r2]= \xe2\x8b\xaf= a[lk]+a[lk+1]+\xe2\x8b\xaf+a[rk].  The number of the blocks in the set is maximum. Formally, there does not exist a set of blocks (l\xe2\x80\xb21,r\xe2\x80\xb21),(l\xe2\x80\xb22,r\xe2\x80\xb22),\xe2\x80\xa6,(l\xe2\x80\xb2k\xe2\x80\xb2,r\xe2\x80\xb2k\xe2\x80\xb2) satisfying the above two requirements with k\xe2\x80\xb2>k.   The picture corresponds to the first example. Blue boxes illustrate blocks. Write a program to find such a set of blocks." 1900
1141E "Superhero Battle" math "A superhero fights with a monster. The battle consists of rounds, each of which lasts exactly n minutes. After a round ends, the next round starts immediately. This is repeated over and over again.Each round has the same scenario. It is described by a sequence of n numbers: d1,d2,\xe2\x80\xa6,dn (\xe2\x88\x92106\xe2\x89\xa4di\xe2\x89\xa4106). The i-th element means that monster\'s hp (hit points) changes by the value di during the i-th minute of each round. Formally, if before the i-th minute of a round the monster\'s hp is h, then after the i-th minute it changes to h:=h+di.The monster\'s initial hp is H. It means that before the battle the monster has H hit points. Print the first minute after which the monster dies. The monster dies if its hp is less than or equal to 0. Print -1 if the battle continues infinitely." 1700
1141D "Colored Boots" greedy,implementation "There are n left boots and n right boots. Each boot has a color which is denoted as a lowercase Latin letter or a question mark (\'?\'). Thus, you are given two strings l and r, both of length n. The character li stands for the color of the i-th left boot and the character ri stands for the color of the i-th right boot.A lowercase Latin letter denotes a specific color, but the question mark (\'?\') denotes an indefinite color. Two specific colors are compatible if they are exactly the same. An indefinite color is compatible with any (specific or indefinite) color.For example, the following pairs of colors are compatible: (\'f\', \'f\'), (\'?\', \'z\'), (\'a\', \'?\') and (\'?\', \'?\'). The following pairs of colors are not compatible: (\'f\', \'g\') and (\'a\', \'z\').Compute the maximum number of pairs of boots such that there is one left and one right boot in a pair and their colors are compatible.Print the maximum number of such pairs and the pairs themselves. A boot can be part of at most one pair." 1500
1141C "Polycarp Restores Permutation" math "An array of integers p1,p2,\xe2\x80\xa6,pn is called a permutation if it contains each number from 1 to n exactly once. For example, the following arrays are permutations: [3,1,2], [1], [1,2,3,4,5] and [4,3,1,2]. The following arrays are not permutations: [2], [1,1], [2,3,4].Polycarp invented a really cool permutation p1,p2,\xe2\x80\xa6,pn of length n. It is very disappointing, but he forgot this permutation. He only remembers the array q1,q2,\xe2\x80\xa6,qn\xe2\x88\x921 of length n\xe2\x88\x921, where qi=pi+1\xe2\x88\x92pi.Given n and q=q1,q2,\xe2\x80\xa6,qn\xe2\x88\x921, help Polycarp restore the invented permutation." 1500
1141B "Maximal Continuous Rest" implementation "Each day in Berland consists of n hours. Polycarp likes time management. That\'s why he has a fixed schedule for each day \xe2\x80\x94 it is a sequence a1,a2,\xe2\x80\xa6,an (each ai is either 0 or 1), where ai=0 if Polycarp works during the i-th hour of the day and ai=1 if Polycarp rests during the i-th hour of the day.Days go one after another endlessly and Polycarp uses the same schedule for each day.What is the maximal number of continuous hours during which Polycarp rests? It is guaranteed that there is at least one working hour in a day." 900
1141A "Game 23" implementation,math "Polycarp plays ""Game 23"". Initially he has a number n and his goal is to transform it to m. In one move, he can multiply n by 2 or multiply n by 3. He can perform any number of moves.Print the number of moves needed to transform n to m. Print -1 if it is impossible to do so.It is easy to prove that any way to transform n to m contains the same number of moves (i.e. number of moves doesn\'t depend on the way of transformation)." 1000
1140G "Double Tree" "data structures,divide and conquer,shortest paths,trees" "You are given a special undirected graph. It consists of 2n vertices numbered from 1 to 2n. The following properties hold for the graph: there are exactly 3n\xe2\x88\x922 edges in the graph: n edges connect vertices having odd numbers with vertices having even numbers, n\xe2\x88\x921 edges connect vertices having odd numbers with each other, and n\xe2\x88\x921 edges connect vertices having even numbers with each other;  for each edge (u,v) between a pair of vertices with odd numbers, there exists an edge (u+1,v+1), and vice versa;  for each odd number u\xe2\x88\x88[1,2n\xe2\x88\x921], there exists an edge (u,u+1);  the graph is connected; moreover, if we delete all vertices with even numbers from it, and all edges incident to them, the graph will become a tree (the same applies to deleting odd vertices).So, the graph can be represented as two trees having the same structure, and n edges connecting each vertex of the first tree to the corresponding vertex of the second tree.Edges of the graph are weighted. The length of some simple path in the graph is the sum of weights of traversed edges.You are given q queries to this graph; in each query, you are asked to compute the length of the shortest path between some pair of vertices in this graph. Can you answer all of the queries?" 2700
1140F "Extending Set of Points" "data structures,divide and conquer,dsu" "For a given set of two-dimensional points S, let\'s denote its extension E(S) as the result of the following algorithm:Create another set of two-dimensional points R, which is initially equal to S. Then, while there exist four numbers x1, y1, x2 and y2 such that (x1,y1)\xe2\x88\x88R, (x1,y2)\xe2\x88\x88R, (x2,y1)\xe2\x88\x88R and (x2,y2)\xe2\x88\x89R, add (x2,y2) to R. When it is impossible to find such four integers, let R be the result of the algorithm.Now for the problem itself. You are given a set of two-dimensional points S, which is initially empty. You have to process two types of queries: add some point to S, or remove some point from it. After each query you have to compute the size of E(S)." 2600
1140E "Palindrome-less Arrays" "combinatorics,divide and conquer,dp" "Let\'s denote that some array b is bad if it contains a subarray bl,bl+1,\xe2\x80\xa6,br of odd length more than 1 (l<r and r\xe2\x88\x92l+1 is odd) such that \xe2\x88\x80i\xe2\x88\x88{0,1,\xe2\x80\xa6,r\xe2\x88\x92l} bl+i=br\xe2\x88\x92i.If an array is not bad, it is good.Now you are given an array a1,a2,\xe2\x80\xa6,an. Some elements are replaced by \xe2\x88\x921. Calculate the number of good arrays you can obtain by replacing each \xe2\x88\x921 with some integer from 1 to k.Since the answer can be large, print it modulo 998244353." 2200
1140D "Minimum Triangulation" dp,greedy,math "You are given a regular polygon with n vertices labeled from 1 to n in counter-clockwise order. The triangulation of a given polygon is a set of triangles such that each vertex of each triangle is a vertex of the initial polygon, there is no pair of triangles such that their intersection has non-zero area, and the total area of all triangles is equal to the area of the given polygon. The weight of a triangulation is the sum of weigths of triangles it consists of, where the weight of a triagle is denoted as the product of labels of its vertices.Calculate the minimum weight among all triangulations of the polygon." 1200
1140C Playlist "brute force,data structures,sortings" "You have a playlist consisting of n songs. The i-th song is characterized by two numbers ti and bi \xe2\x80\x94 its length and beauty respectively. The pleasure of listening to set of songs is equal to the total length of the songs in the set multiplied by the minimum beauty among them. For example, the pleasure of listening to a set of 3 songs having lengths [5,7,4] and beauty values [11,14,6] is equal to (5+7+4)\xe2\x8b\x856=96.You need to choose at most k songs from your playlist, so the pleasure of listening to the set of these songs them is maximum possible." 1600
1140B "Good String" implementation,strings "You have a string s of length n consisting of only characters > and <. You may do some operations with this string, for each operation you have to choose some character that still remains in the string. If you choose a character >, the character that comes right after it is deleted (if the character you chose was the last one, nothing happens). If you choose a character <, the character that comes right before it is deleted (if the character you chose was the first one, nothing happens).For example, if we choose character > in string > > < >, the string will become to > > >. And if we choose character < in string > <, the string will become to <.The string is good if there is a sequence of operations such that after performing it only one character will remain in the string. For example, the strings >, > > are good. Before applying the operations, you may remove any number of characters from the given string (possibly none, possibly up to n\xe2\x88\x921, but not the whole string). You need to calculate the minimum number of characters to be deleted from string s so that it becomes good." 1200
1140A "Detective Book" implementation "Ivan recently bought a detective book. The book is so interesting that each page of this book introduces some sort of a mystery, which will be explained later. The i-th page contains some mystery that will be explained on page ai (ai\xe2\x89\xa5i).Ivan wants to read the whole book. Each day, he reads the first page he didn\'t read earlier, and continues to read the following pages one by one, until all the mysteries he read about are explained and clear to him (Ivan stops if there does not exist any page i such that Ivan already has read it, but hasn\'t read page ai). After that, he closes the book and continues to read it on the following day from the next page.How many days will it take to read the whole book?" 1000
1139F "Dish Shopping" "data structures,divide and conquer" "There are m people living in a city. There are n dishes sold in the city. Each dish i has a price pi, a standard si and a beauty bi. Each person j has an income of incj and a preferred beauty prefj. A person would never buy a dish whose standard is less than the person\'s income. Also, a person can\'t afford a dish with a price greater than the income of the person. In other words, a person j can buy a dish i only if pi\xe2\x89\xa4incj\xe2\x89\xa4si.Also, a person j can buy a dish i, only if |bi\xe2\x88\x92prefj|\xe2\x89\xa4(incj\xe2\x88\x92pi). In other words, if the price of the dish is less than the person\'s income by k, the person will only allow the absolute difference of at most k between the beauty of the dish and his/her preferred beauty. Print the number of dishes that can be bought by each person in the city." 2500
1139E "Maximize Mex" "flows,graph matchings,graphs" "There are n students and m clubs in a college. The clubs are numbered from 1 to m. Each student has a potential pi and is a member of the club with index ci. Initially, each student is a member of exactly one club. A technical fest starts in the college, and it will run for the next d days. There is a coding competition every day in the technical fest. Every day, in the morning, exactly one student of the college leaves their club. Once a student leaves their club, they will never join any club again. Every day, in the afternoon, the director of the college will select one student from each club (in case some club has no members, nobody is selected from that club) to form a team for this day\'s coding competition. The strength of a team is the mex of potentials of the students in the team. The director wants to know the maximum possible strength of the team for each of the coming d days. Thus, every day the director chooses such team, that the team strength is maximized.The mex of the multiset S is the smallest non-negative integer that is not present in S. For example, the mex of the {0,1,1,2,4,5,9} is 3, the mex of {1,2,3} is 0 and the mex of \xe2\x88\x85 (empty set) is 0." 2400
1139D "Steps to One" "dp,math,number theory,probabilities" "Vivek initially has an empty array a and some integer constant m.He performs the following algorithm:  Select a random integer x uniformly in range from 1 to m and append it to the end of a.  Compute the greatest common divisor of integers in a.  In case it equals to 1, break  Otherwise, return to step 1. Find the expected length of a. It can be shown that it can be represented as PQ where P and Q are coprime integers and Q\xe2\x89\xa00(mod109+7). Print the value of P\xe2\x8b\x85Q\xe2\x88\x921(mod109+7)." 2300
1139C "Edgy Trees" "dfs and similar,dsu,graphs,math,trees" "You are given a tree (a connected undirected graph without cycles) of n vertices. Each of the n\xe2\x88\x921 edges of the tree is colored in either black or red.You are also given an integer k. Consider sequences of k vertices. Let\'s call a sequence [a1,a2,\xe2\x80\xa6,ak] good if it satisfies the following criterion:  We will walk a path (possibly visiting same edge/vertex multiple times) on the tree, starting from a1 and ending at ak.  Start at a1, then go to a2 using the shortest path between a1 and a2, then go to a3 in a similar way, and so on, until you travel the shortest path between ak\xe2\x88\x921 and ak. If you walked over at least one black edge during this process, then the sequence is good.   Consider the tree on the picture. If k=3 then the following sequences are good: [1,4,7], [5,5,3] and [2,3,7]. The following sequences are not good: [1,4,6], [5,5,5], [3,7,3].There are nk sequences of vertices, count how many of them are good. Since this number can be quite large, print it modulo 109+7." 1500
1139B Chocolates greedy,implementation "You went to the store, selling n types of chocolates. There are ai chocolates of type i in stock.You have unlimited amount of cash (so you are not restricted by any prices) and want to buy as many chocolates as possible. However if you buy xi chocolates of type i (clearly, 0\xe2\x89\xa4xi\xe2\x89\xa4ai), then for all 1\xe2\x89\xa4j<i at least one of the following must hold:  xj=0 (you bought zero chocolates of type j) xj<xi (you bought less chocolates of type j than of type i) For example, the array x=[0,0,1,2,10] satisfies the requirement above (assuming that all ai\xe2\x89\xa5xi), while arrays x=[0,1,0], x=[5,5] and x=[3,2] don\'t.Calculate the maximum number of chocolates you can buy." 1000
1139A "Even Substrings" implementation,strings "You are given a string s=s1s2\xe2\x80\xa6sn of length n, which only contains digits 1, 2, ..., 9.A substring s[l\xe2\x80\xa6r] of s is a string slsl+1sl+2\xe2\x80\xa6sr. A substring s[l\xe2\x80\xa6r] of s is called even if the number represented by it is even. Find the number of even substrings of s. Note, that even if some substrings are equal as strings, but have different l and r, they are counted as different substrings." 800
1138B Circus "brute force,greedy,math,strings" "Polycarp is a head of a circus troupe. There are nÂ \xe2\x80\x94 an even numberÂ \xe2\x80\x94 artists in the troupe. It is known whether the i-th artist can perform as a clown (if yes, then ci=1, otherwise ci=0), and whether they can perform as an acrobat (if yes, then ai=1, otherwise ai=0).Split the artists into two performances in such a way that:   each artist plays in exactly one performance,  the number of artists in the two performances is equal (i.e. equal to n2),  the number of artists that can perform as clowns in the first performance is the same as the number of artists that can perform as acrobats in the second performance." 1800
1138A "Sushi for Two" "binary search,greedy,implementation" "Arkady invited Anna for a dinner to a sushi restaurant. The restaurant is a bit unusual: it offers n pieces of sushi aligned in a row, and a customer has to choose a continuous subsegment of these sushi to buy.The pieces of sushi are of two types: either with tuna or with eel. Let\'s denote the type of the i-th from the left sushi as ti, where ti=1 means it is with tuna, and ti=2 means it is with eel.Arkady does not like tuna, Anna does not like eel. Arkady wants to choose such a continuous subsegment of sushi that it has equal number of sushi of each type and each half of the subsegment has only sushi of one type. For example, subsegment [2,2,2,1,1,1] is valid, but subsegment [1,2,1,2,1,2] is not, because both halves contain both types of sushi.Find the length of the longest continuous subsegment of sushi Arkady can buy." 900
1137F "Matches Are Not a Child\'s Play" "data structures,trees" "Lena is playing with matches. The natural question arising in the head of any child playing with matches is whether it\'s possible to set a tree on fire with a matches, or not.Let\'s say, that the tree is a connected graph without cycles and the vertices are labeled with integers 1,2,\xe2\x80\xa6,n1,2,\xe2\x80\xa6,n. Also every vertex vv has some integer priority pvpv associated with it. All priorities are distinct.It turns out, that if you set a tree on fire, it will burn to nothing. However, this process doesn\'t happen instantly. At the beginning, burns out the leaf (a vertex is called to be a leaf if it has only one adjacent vertex) of the tree of the minimum priority. Then burns out the leaf of the minimal priority of the remaining tree, and so on. This way, the vertices turn into the leaves and burn out until only one vertex remains. Then this vertex burns out as well.Lena has prepared a tree of nn vertices and every vertex in it has a priority pv=vpv=v. Lena is very curious about burning out this tree. However, she understands, that if she will burn the tree now, then it will disappear completely. Lena is a kind girl and she will feel bad for the burned tree, so she wants to study the process of burning the tree only in her mind. Lena wants to process qq queries, each of them is one of three following types:  ""up vv"", assign the vertex vv priority 1+max{p1,p2,\xe2\x80\xa6,pn}1+max{p1,p2,\xe2\x80\xa6,pn};  ""when vv"", find the step at which the vertex vv will burn out, if the tree would be set on fire now;  ""compare vv uu"", find out which of the vertices vv and uu will burn out first, if the tree would be set on fire now. Notice, that if all priorities would be distinct, then after the ""up"" query they will stay distinct as well. Initially all priorities are distinct, hence during any (purely hypothetical of course) burning of the tree, all leafs would have distinct priorities." 3400
1137E "Train Car Selection" "data structures,greedy" "Vasya likes to travel by train, but doesn\'t like when the car he travels in is located in the tail of the train.Vasya gets on the train at the station. The train consists of n cars indexed from 1 to n counting from the locomotive (head of the train). Three types of events occur while the train is moving:  Some number of cars are added to the head of the train;  Some number of cars are added to the tail of the train;  Vasya recalculates the values of the convenience of the cars (read more about it below). At each moment of time we will index the cars from the head of the train, starting from 1. Note that when adding new cars to the head of the train, the indexing of the old ones may shift.To choose which car to go in, Vasya will use the value Ai for each car (where i is a car index), which is calculated as follows:  At the beginning of the trip Ai=0, as well as for the new cars at the time of their addition.  During the next recalculation Vasya chooses some positive integers b and s and adds to all Ai value b+(i\xe2\x88\x921)\xe2\x8b\x85s. Vasya hasn\'t decided yet where he will get on the train and where will get off the train, so after each event of one of the three types he wants to know the least index of the car, such that its value Ai is minimal. Since there is a lot of cars, Vasya asked you to write a program that answers his question." 2700
