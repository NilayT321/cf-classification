1706B "Making Towers" dp,greedy,math "You have a sequence of n colored blocks. The color of the i-th block is ci, an integer between 1 and n.You will place the blocks down in sequence on an infinite coordinate grid in the following way.   Initially, you place block 1 at (0,0).  For 2\xe2\x89\xa4i\xe2\x89\xa4n, if the (i\xe2\x88\x921)-th block is placed at position (x,y), then the i-th block can be placed at one of positions (x+1,y), (x\xe2\x88\x921,y), (x,y+1) (but not at position (x,y\xe2\x88\x921)), as long no previous block was placed at that position. A tower is formed by s blocks such that they are placed at positions (x,y),(x,y+1),\xe2\x80\xa6,(x,y+s\xe2\x88\x921) for some position (x,y) and integer s. The size of the tower is s, the number of blocks in it. A tower of color r is a tower such that all blocks in it have the color r.For each color r from 1 to n, solve the following problem independently:   Find the maximum size of a tower of color r that you can form by placing down the blocks according to the rules." 1100
1706A "Another String Minimization Problem" "2-sat,constructive algorithms,greedy,string suffix structures,strings" "You have a sequence a1,a2,\xe2\x80\xa6,an of length n, consisting of integers between 1 and m. You also have a string s, consisting of m characters B.You are going to perform the following n operations.   At the i-th (1\xe2\x89\xa4i\xe2\x89\xa4n) operation, you replace either the ai-th or the (m+1\xe2\x88\x92ai)-th character of s with A. You can replace the character at any position multiple times through the operations. Find the lexicographically smallest string you can get after these operations.A string x is lexicographically smaller than a string y of the same length if and only if in the first position where x and y differ, the string x has a letter that appears earlier in the alphabet than the corresponding letter in y." 800
1705F "Mark and the Online Exam" "bitmasks,constructive algorithms,interactive,probabilities" "Mark is administering an online exam consisting of n true-false questions. However, he has lost all answer keys. He needs a way to retrieve the answers before his client gets infuriated.Fortunately, he has access to the grading system. Thus, for each query, you can input the answers to all n questions, and the grading system will output how many of them are correct.He doesn\'t have much time, so he can use the grading system at most 675 times. Help Mark determine the answer keys.Note that answer keys are fixed in advance and will not change depending on your queries." 2900
1705E "Mark and Professor Koro" "binary search,bitmasks,brute force,combinatorics,data structures,greedy" "After watching a certain anime before going to sleep, Mark dreams of standing in an old classroom with a blackboard that has a sequence of n positive integers a1,a2,\xe2\x80\xa6,an on it.Then, professor Koro comes in. He can perform the following operation:  select an integer x that appears at least 2 times on the board,  erase those 2 appearances, and  write x+1 on the board. Professor Koro then asks Mark the question, ""what is the maximum possible number that could appear on the board after some operations?""Mark quickly solves this question, but he is still slower than professor Koro. Thus, professor Koro decides to give Mark additional challenges. He will update the initial sequence of integers q times. Each time, he will choose positive integers k and l, then change ak to l. After each update, he will ask Mark the same question again.Help Mark answer these questions faster than Professor Koro!Note that the updates are persistent. Changes made to the sequence a will apply when processing future updates." 2300
1705D "Mark and Lightbulbs" "combinatorics,constructive algorithms,greedy,math,sortings" "Mark has just purchased a rack of n lightbulbs. The state of the lightbulbs can be described with binary string s=s1s2\xe2\x80\xa6sn, where si=1 means that the i-th lightbulb is turned on, while si=0 means that the i-th lightbulb is turned off.Unfortunately, the lightbulbs are broken, and the only operation he can perform to change the state of the lightbulbs is the following:  Select an index i from 2,3,\xe2\x80\xa6,n\xe2\x88\x921 such that si\xe2\x88\x921\xe2\x89\xa0si+1.  Toggle si. Namely, if si is 0, set si to 1 or vice versa. Mark wants the state of the lightbulbs to be another binary string t. Help Mark determine the minimum number of operations to do so." 1800
1705C "Mark and His Unfinished Essay" "brute force,implementation" "One night, Mark realized that there is an essay due tomorrow. He hasn\'t written anything yet, so Mark decided to randomly copy-paste substrings from the prompt to make the essay.More formally, the prompt is a string s of initial length n. Mark will perform the copy-pasting operation c times. Each operation is described by two integers l and r, which means that Mark will append letters slsl+1\xe2\x80\xa6sr to the end of string s. Note that the length of s increases after this operation.Of course, Mark needs to be able to see what has been written. After copying, Mark will ask q queries: given an integer k, determine the k-th letter of the final string s." 1400
1705B "Mark the Dust Sweeper" "constructive algorithms,greedy,implementation" "Mark is cleaning a row of n rooms. The i-th room has a nonnegative dust level ai. He has a magical cleaning machine that can do the following three-step operation.   Select two indices i<j such that the dust levels ai, ai+1, \xe2\x80\xa6, aj\xe2\x88\x921 are all strictly greater than 0.  Set ai to ai\xe2\x88\x921.  Set aj to aj+1.  Mark\'s goal is to make a1=a2=\xe2\x80\xa6=an\xe2\x88\x921=0 so that he can nicely sweep the n-th room. Determine the minimum number of operations needed to reach his goal." 900
1705A "Mark the Photographer" greedy,sortings "Mark is asked to take a group photo of 2n people. The i-th person has height hi units.To do so, he ordered these people into two rows, the front row and the back row, each consisting of n people. However, to ensure that everyone is seen properly, the j-th person of the back row must be at least x units taller than the j-th person of the front row for each j between 1 and n, inclusive.Help Mark determine if this is possible." 800
1704H2 "Game of AI (hard version)" combinatorics,fft,math "This is the hard version of this problem. The difference between easy and hard versions is the constraint on k and the time limit. Notice that you need to calculate the answer for all positive integers n\xe2\x88\x88[1,k] in this version. You can make hacks only if both versions of the problem are solved.Cirno is playing a war simulator game with n towers (numbered from 1 to n) and n bots (numbered from 1 to n). The i-th tower is initially occupied by the i-th bot for 1\xe2\x89\xa4i\xe2\x89\xa4n.Before the game, Cirno first chooses a permutation p=[p1,p2,\xe2\x80\xa6,pn] of length n (A permutation of length n is an array of length n where each integer between 1 and n appears exactly once). After that, she can choose a sequence a=[a1,a2,\xe2\x80\xa6,an] (1\xe2\x89\xa4ai\xe2\x89\xa4n and ai\xe2\x89\xa0i for all 1\xe2\x89\xa4i\xe2\x89\xa4n).The game has n rounds of attacks. In the i-th round, if the pi-th bot is still in the game, it will begin its attack, and as the result the api-th tower becomes occupied by the pi-th bot; the bot that previously occupied the api-th tower will no longer occupy it. If the pi-th bot is not in the game, nothing will happen in this round.After each round, if a bot doesn\'t occupy any towers, it will be eliminated and leave the game. Please note that no tower can be occupied by more than one bot, but one bot can occupy more than one tower during the game.At the end of the game, Cirno will record the result as a sequence b=[b1,b2,\xe2\x80\xa6,bn], where bi is the number of the bot that occupies the i-th tower at the end of the game.However, as a mathematics master, she wants you to solve the following counting problem instead of playing games:Count the number of different pairs of sequences a, b from all possible choices of sequence a and permutation p.Calculate the answers for all n such that 1\xe2\x89\xa4n\xe2\x89\xa4k. Since these numbers may be large, output them modulo M." 3500
1704H1 "Game of AI (easy version)" "combinatorics,constructive algorithms,dp,fft,math" "This is the easy version of this problem. The difference between easy and hard versions is the constraint on k and the time limit. Also, in this version of the problem, you only need to calculate the answer when n=k. You can make hacks only if both versions of the problem are solved.Cirno is playing a war simulator game with n towers (numbered from 1 to n) and n bots (numbered from 1 to n). The i-th tower is initially occupied by the i-th bot for 1\xe2\x89\xa4i\xe2\x89\xa4n.Before the game, Cirno first chooses a permutation p=[p1,p2,\xe2\x80\xa6,pn] of length n (A permutation of length n is an array of length n where each integer between 1 and n appears exactly once). After that, she can choose a sequence a=[a1,a2,\xe2\x80\xa6,an] (1\xe2\x89\xa4ai\xe2\x89\xa4n and ai\xe2\x89\xa0i for all 1\xe2\x89\xa4i\xe2\x89\xa4n).The game has n rounds of attacks. In the i-th round, if the pi-th bot is still in the game, it will begin its attack, and as the result the api-th tower becomes occupied by the pi-th bot; the bot that previously occupied the api-th tower will no longer occupy it. If the pi-th bot is not in the game, nothing will happen in this round.After each round, if a bot doesn\'t occupy any towers, it will be eliminated and leave the game. Please note that no tower can be occupied by more than one bot, but one bot can occupy more than one tower during the game.At the end of the game, Cirno will record the result as a sequence b=[b1,b2,\xe2\x80\xa6,bn], where bi is the number of the bot that occupies the i-th tower at the end of the game.However, as a mathematics master, she wants you to solve the following counting problem instead of playing games:Count the number of different pairs of sequences a and b that we can get from all possible choices of sequence a and permutation p.Since this number may be large, output it modulo M." 3200
1704G "Mio and Lucky Array" "constructive algorithms,fft,math,strings" "Mio has an array a consisting of n integers, and an array b consisting of m integers. Mio can do the following operation to a:  Choose an integer i (1\xe2\x89\xa4i\xe2\x89\xa4n) that has not been chosen before, then add 1 to ai, subtract 2 from ai+1, add 3 to ai+2 an so on. Formally, the operation is to add (\xe2\x88\x921)j\xe2\x88\x92i\xe2\x8b\x85(j\xe2\x88\x92i+1) to aj for i\xe2\x89\xa4j\xe2\x89\xa4n.Mio wants to transform a so that it will contain b as a subarray. Could you answer her question, and provide a sequence of operations to do so, if it is possible?An array b is a subarray of an array a if b can be obtained from a by deletion of several (possibly, zero or all) elements from the beginning and several (possibly, zero or all) elements from the end." 3500
1704F "Colouring Game" "constructive algorithms,dp,games" "Alice and Bob are playing a game. There are n cells in a row. Initially each cell is either red or blue. Alice goes first.On each turn, Alice chooses two neighbouring cells which contain at least one red cell, and paints that two cells white. Then, Bob chooses two neighbouring cells which contain at least one blue cell, and paints that two cells white. The player who cannot make a move loses.Find the winner if both Alice and Bob play optimally.Note that a chosen cell can be white, as long as the other cell satisfies the constraints." 2600
1704E "Count Seconds" "brute force,constructive algorithms,dp,graphs,implementation,math" "Cirno has a DAG (Directed Acyclic Graph) with n nodes and m edges. The graph has exactly one node that has no out edges. The i-th node has an integer ai on it.Every second the following happens: Let S be the set of nodes x that have ax>0. For all x\xe2\x88\x88S, 1 is subtracted from ax, and then for each node y, such that there is an edge from x to y, 1 is added to ay.Find the first moment of time when all ai become 0. Since the answer can be very large, output it modulo 998244353." 2200
1704D "Magical Array" "constructive algorithms,hashing,implementation,math" "Eric has an array b of length m, then he generates n additional arrays c1,c2,\xe2\x80\xa6,cn, each of length m, from the array b, by the following way:Initially, ci=b for every 1\xe2\x89\xa4i\xe2\x89\xa4n. Eric secretly chooses an integer k (1\xe2\x89\xa4k\xe2\x89\xa4n) and chooses ck to be the special array.There are two operations that Eric can perform on an array ct: Operation 1: Choose two integers i and j (2\xe2\x89\xa4i<j\xe2\x89\xa4m\xe2\x88\x921), subtract 1 from both ct[i] and ct[j], and add 1 to both ct[i\xe2\x88\x921] and ct[j+1]. That operation can only be used on a non-special array, that is when t\xe2\x89\xa0k.; Operation 2: Choose two integers i and j (2\xe2\x89\xa4i<j\xe2\x89\xa4m\xe2\x88\x922), subtract 1 from both ct[i] and ct[j], and add 1 to both ct[i\xe2\x88\x921] and ct[j+2]. That operation can only be used on a special array, that is when t=k.Note that Eric can\'t perform an operation if any element of the array will become less than 0 after that operation.Now, Eric does the following:  For every non-special array ci (i\xe2\x89\xa0k), Eric uses only operation 1 on it at least once. For the special array ck, Eric uses only operation 2 on it at least once.Lastly, Eric discards the array b.For given arrays c1,c2,\xe2\x80\xa6,cn, your task is to find out the special array, i.e. the value k. Also, you need to find the number of times of operation 2 was used on it." 1900
1704C Virus greedy,implementation,sortings "There are n houses numbered from 1 to n on a circle. For each 1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921, house i and house i+1 are neighbours; additionally, house n and house 1 are also neighbours.Initially, m of these n houses are infected by a deadly virus. Each morning, Cirno can choose a house which is uninfected and protect the house from being infected permanently.Every day, the following things happen in order:  Cirno chooses an uninfected house, and protect it permanently.  All uninfected, unprotected houses which have at least one infected neighbor become infected. Cirno wants to stop the virus from spreading. Find the minimum number of houses that will be infected in the end, if she optimally choose the houses to protect.Note that every day Cirno always chooses a house to protect before the virus spreads. Also, a protected house will not be infected forever." 1200
1704B "Luke is a Foodie" "brute force,greedy,implementation" "Luke likes to eat. There are n piles of food aligned in a straight line in front of him. The i-th pile contains ai units of food. Luke will walk from the 1-st pile towards the n-th pile, and he wants to eat every pile of food without walking back. When Luke reaches the i-th pile, he can eat that pile if and only if |v\xe2\x88\x92ai|\xe2\x89\xa4x, where x is a fixed integer, and v is Luke\'s food affinity.Before Luke starts to walk, he can set v to any integer. Also, for each i (1\xe2\x89\xa4i\xe2\x89\xa4n), Luke can change his food affinity to any integer before he eats the i-th pile.Find the minimum number of changes needed to eat every pile of food.Note that the initial choice for v is not considered as a change." 1000
1704A "Two 0-1 Sequences" "constructive algorithms,greedy" "AquaMoon has two binary sequences a and b, which contain only 0 and 1. AquaMoon can perform the following two operations any number of times (a1 is the first element of a, a2 is the second element of a, and so on): Operation 1: if a contains at least two elements, change a2 to min(a1,a2), and remove the first element of a. Operation 2: if a contains at least two elements, change a2 to max(a1,a2), and remove the first element of a.Note that after a removal of the first element of a, the former a2 becomes the first element of a, the former a3 becomes the second element of a and so on, and the length of a reduces by one.Determine if AquaMoon can make a equal to b by using these operations." 800
1703G "Good Key, Bad Key" "bitmasks,brute force,dp,greedy,math" "There are n chests. The i-th chest contains ai coins. You need to open all n chests in order from chest 1 to chest n.There are two types of keys you can use to open a chest:   a good key, which costs k coins to use;  a bad key, which does not cost any coins, but will halve all the coins in each unopened chest, including the chest it is about to open. The halving operation will round down to the nearest integer for each chest halved. In other words using a bad key to open chest i will do ai=\xe2\x8c\x8aai2\xe2\x8c\x8b, ai+1=\xe2\x8c\x8aai+12\xe2\x8c\x8b,\xe2\x80\xa6,an=\xe2\x8c\x8aan2\xe2\x8c\x8b;  any key (both good and bad) breaks after a usage, that is, it is a one-time use. You need to use in total n keys, one for each chest. Initially, you have no coins and no keys. If you want to use a good key, then you need to buy it.During the process, you are allowed to go into debt; for example, if you have 1 coin, you are allowed to buy a good key worth k=3 coins, and your balance will become \xe2\x88\x922 coins.Find the maximum number of coins you can have after opening all n chests in order from chest 1 to chest n." 1600
1703F "Yet Another Problem About Pairs Satisfying an Inequality" "binary search,data structures,dp,greedy,sortings" "You are given an array a1,a2,\xe2\x80\xa6an. Count the number of pairs of indices 1\xe2\x89\xa4i,j\xe2\x89\xa4n such that ai<i<aj<j." 1300
1703E "Mirror Grid" implementation "You are given a square grid with n rows and n columns. Each cell contains either 0 or 1. In an operation, you can select a cell of the grid and flip it (from 0\xe2\x86\x921 or 1\xe2\x86\x920). Find the minimum number of operations you need to obtain a square that remains the same when rotated 0\xe2\x88\x98, 90\xe2\x88\x98, 180\xe2\x88\x98 and 270\xe2\x88\x98.The picture below shows an example of all rotations of a grid." 1200
1703D "Double Strings" "brute force,data structures,strings" "You are given n strings s1,s2,\xe2\x80\xa6,sn of length at most 8. For each string si, determine if there exist two strings sj and sk such that si=sj+sk. That is, si is the concatenation of sj and sk. Note that j can be equal to k.Recall that the concatenation of strings s and t is s+t=s1s2\xe2\x80\xa6spt1t2\xe2\x80\xa6tq, where p and q are the lengths of strings s and t respectively. For example, concatenation of ""code"" and ""forces"" is ""codeforces""." 1100
1703C Cypher "brute force,implementation,strings" "Luca has a cypher made up of a sequence of n wheels, each with a digit ai written on it. On the i-th wheel, he made bi moves. Each move is one of two types:   up move (denoted by U): it increases the i-th digit by 1. After applying the up move on 9, it becomes 0.  down move (denoted by D): it decreases the i-th digit by 1. After applying the down move on 0, it becomes 9.   Example for n=4. The current sequence is 0 0 0 0. Luca knows the final sequence of wheels and the moves for each wheel. Help him find the original sequence and crack the cypher." 800
1703B "ICPC Balloons" "data structures,implementation" "In an ICPC contest, balloons are distributed as follows:   Whenever a team solves a problem, that team gets a balloon.  The first team to solve a problem gets an additional balloon.  A contest has 26 problems, labelled A, B, C, ..., Z. You are given the order of solved problems in the contest, denoted as a string s, where the i-th character indicates that the problem si has been solved by some team. No team will solve the same problem twice.Determine the total number of balloons that the teams received. Note that some problems may be solved by none of the teams." 800
1703A "YES or YES?" "brute force,implementation,strings" "There is a string s of length 3, consisting of uppercase and lowercase English letters. Check if it is equal to ""YES"" (without quotes), where each letter can be in any case. For example, ""yES"", ""Yes"", ""yes"" are all allowable." 800
1702G2 "Passable Paths (hard version)" "data structures,dfs and similar,trees" "This is a hard version of the problem. The only difference between an easy and a hard version is in the number of queries.Polycarp grew a tree from n vertices. We remind you that a tree of n vertices is an undirected connected graph of n vertices and n\xe2\x88\x921 edges that does not contain cycles.He calls a set of vertices passable if there is such a path in the tree that passes through each vertex of this set without passing through any edge twice. The path can visit other vertices (not from this set).In other words, a set of vertices is called passable if there is a simple path that passes through all the vertices of this set (and possibly some other).For example, for a tree below sets {3,2,5}, {1,5,4}, {1,4} are passable, and {1,3,5}, {1,2,3,4,5} are not.  Polycarp asks you to answer q queries. Each query is a set of vertices. For each query, you need to determine whether the corresponding set of vertices is passable." 2000
1702G1 "Passable Paths (easy version)" "dfs and similar,trees" "This is an easy version of the problem. The only difference between an easy and a hard version is in the number of queries.Polycarp grew a tree from n vertices. We remind you that a tree of n vertices is an undirected connected graph of n vertices and n\xe2\x88\x921 edges that does not contain cycles.He calls a set of vertices passable if there is such a path in the tree that passes through each vertex of this set without passing through any edge twice. The path can visit other vertices (not from this set).In other words, a set of vertices is called passable if there is a simple path that passes through all the vertices of this set (and possibly some other).For example, for a tree below sets {3,2,5}, {1,5,4}, {1,4} are passable, and {1,3,5}, {1,2,3,4,5} are not.  Polycarp asks you to answer q queries. Each query is a set of vertices. For each query, you need to determine whether the corresponding set of vertices is passable." 1900
1702F "Equate Multisets" "constructive algorithms,data structures,greedy,math,number theory" "Multiset \xe2\x80\x94is a set of numbers in which there can be equal elements, and the order of the numbers does not matter. Two multisets are equal when each value occurs the same number of times. For example, the multisets {2,2,4} and {2,4,2} are equal, but the multisets {1,2,2} and {1,1,2} \xe2\x80\x94 are not.You are given two multisets a and b, each consisting of n integers.In a single operation, any element of the b multiset can be doubled or halved (rounded down). In other words, you have one of the following operations available for an element x of the b multiset:   replace x with x\xe2\x8b\x852,  or replace x with \xe2\x8c\x8ax2\xe2\x8c\x8b (round down).  Note that you cannot change the elements of the a multiset.See if you can make the multiset b become equal to the multiset a in an arbitrary number of operations (maybe 0).For example, if n=4, a={4,24,5,2}, b={4,1,6,11}, then the answer is yes. We can proceed as follows:   Replace 1 with 1\xe2\x8b\x852=2. We get b={4,2,6,11}.  Replace 11 with \xe2\x8c\x8a112\xe2\x8c\x8b=5. We get b={4,2,6,5}.  Replace 6 with 6\xe2\x8b\x852=12. We get b={4,2,12,5}.  Replace 12 with 12\xe2\x8b\x852=24. We get b={4,2,24,5}.  Got equal multisets a={4,24,5,2} and b={4,2,24,5}." 1700
1702E "Split Into Two Sets" "dfs and similar,dsu,graphs" "Polycarp was recently given a set of n (number n \xe2\x80\x94 even) dominoes. Each domino contains two integers from 1 to n.Can he divide all the dominoes into two sets so that all the numbers on the dominoes of each set are different? Each domino must go into exactly one of the two sets.For example, if he has 4 dominoes: {1,4}, {1,3}, {3,2} and {4,2}, then Polycarp will be able to divide them into two sets in the required way. The first set can include the first and third dominoes ({1,4} and {3,2}), and the second set \xe2\x80\x94 the second and fourth ones ({1,3} and {4,2})." 1600
1702D "Not a Cheap String" greedy "Let s be a string of lowercase Latin letters. Its price is the sum of the indices of letters (an integer between 1 and 26) that are included in it. For example, the price of the string abca is 1+2+3+1=7.The string w and the integer p are given. Remove the minimal number of letters from w so that its price becomes less than or equal to p and print the resulting string. Note that the resulting string may be empty. You can delete arbitrary letters, they do not have to go in a row. If the price of a given string w is less than or equal to p, then nothing needs to be deleted and w must be output.Note that when you delete a letter from w, the order of the remaining letters is preserved. For example, if you delete the letter e from the string test, you get tst." 1000
1702C "Train and Queries" "data structures,greedy" "Along the railroad there are stations indexed from 1 to 109. An express train always travels along a route consisting of n stations with indices u1,u2,\xe2\x80\xa6,un, where (1\xe2\x89\xa4ui\xe2\x89\xa4109). The train travels along the route from left to right. It starts at station u1, then stops at station u2, then at u3, and so on. Station un \xe2\x80\x94 the terminus.It is possible that the train will visit the same station more than once. That is, there may be duplicates among the values u1,u2,\xe2\x80\xa6,un.You are given k queries, each containing two different integers aj and bj (1\xe2\x89\xa4aj,bj\xe2\x89\xa4109). For each query, determine whether it is possible to travel by train from the station with index aj to the station with index bj.For example, let the train route consist of 6 of stations with indices [3,7,1,5,1,4] and give 3 of the following queries:   a1=3, b1=5It is possible to travel from station 3 to station 5 by taking a section of the route consisting of stations [3,7,1,5]. Answer: YES.  a2=1, b2=7You cannot travel from station 1 to station 7 because the train cannot travel in the opposite direction. Answer: NO.  a3=3, b3=10It is not possible to travel from station 3 to station 10 because station 10 is not part of the train\'s route. Answer: NO." 1100
1702B "Polycarp Writes a String from Memory" greedy "Polycarp has a poor memory. Each day he can remember no more than 3 of different letters. Polycarp wants to write a non-empty string of s consisting of lowercase Latin letters, taking minimum number of days. In how many days will he be able to do it?Polycarp initially has an empty string and can only add characters to the end of that string.For example, if Polycarp wants to write the string lollipops, he will do it in 2 days:   on the first day Polycarp will memorize the letters l, o, i and write lolli;  On the second day Polycarp will remember the letters p, o, s, add pops to the resulting line and get the line lollipops. If Polycarp wants to write the string stringology, he will do it in 4 days:   in the first day will be written part str;  on day two will be written part ing;  on the third day, part of olog will be written;  on the fourth day, part of y will be written. For a given string s, print the minimum number of days it will take Polycarp to write it." 800
1702A "Round Down the Price" "constructive algorithms" "At the store, the salespeople want to make all prices round. In this problem, a number that is a power of 10 is called a round number. For example, the numbers 100=1, 101=10, 102=100 are round numbers, but 20, 110 and 256 are not round numbers. So, if an item is worth m bourles (the value of the item is not greater than 109), the sellers want to change its value to the nearest round number that is not greater than m. They ask you: by how many bourles should you decrease the value of the item to make it worth exactly 10k bourles, where the value of k \xe2\x80\x94 is the maximum possible (k \xe2\x80\x94 any non-negative integer).For example, let the item have a value of 178-bourles. Then the new price of the item will be 100, and the answer will be 178\xe2\x88\x92100=78." 800
1701F Points "combinatorics,data structures,implementation,math,matrices" "A triple of points i, j and k on a coordinate line is called beautiful if i<j<k and k\xe2\x88\x92i\xe2\x89\xa4d.You are given a set of points on a coordinate line, initially empty. You have to process queries of three types:  add a point;  remove a point;  calculate the number of beautiful triples consisting of points belonging to the set." 2500
1701E "Text Editor" "brute force,dp,greedy,strings" "You wanted to write a text t consisting of m lowercase Latin letters. But instead, you have written a text s consisting of n lowercase Latin letters, and now you want to fix it by obtaining the text t from the text s.Initially, the cursor of your text editor is at the end of the text s (after its last character). In one move, you can do one of the following actions:  press the ""left"" button, so the cursor is moved to the left by one position (or does nothing if it is pointing at the beginning of the text, i.\xe2\x80\x89e. before its first character);  press the ""right"" button, so the cursor is moved to the right by one position (or does nothing if it is pointing at the end of the text, i.\xe2\x80\x89e. after its last character);  press the ""home"" button, so the cursor is moved to the beginning of the text (before the first character of the text);  press the ""end"" button, so the cursor is moved to the end of the text (after the last character of the text);  press the ""backspace"" button, so the character before the cursor is removed from the text (if there is no such character, nothing happens). Your task is to calculate the minimum number of moves required to obtain the text t from the text s using the given set of actions, or determine it is impossible to obtain the text t from the text s.You have to answer T independent test cases." 2500
1701D "Permutation Restoration" "binary search,data structures,greedy,math,sortings,two pointers" "Monocarp had a permutation a of n integers 1, 2, ..., n (a permutation is an array where each element from 1 to n occurs exactly once).Then Monocarp calculated an array of integers b of size n, where bi=\xe2\x8c\x8aiai\xe2\x8c\x8b. For example, if the permutation a is [2,1,4,3], then the array b is equal to [\xe2\x8c\x8a12\xe2\x8c\x8b,\xe2\x8c\x8a21\xe2\x8c\x8b,\xe2\x8c\x8a34\xe2\x8c\x8b,\xe2\x8c\x8a43\xe2\x8c\x8b]=[0,2,0,1].Unfortunately, the Monocarp has lost his permutation, so he wants to restore it. Your task is to find a permutation a that corresponds to the given array b. If there are multiple possible permutations, then print any of them. The tests are constructed in such a way that least one suitable permutation exists." 1900
1701C "Schedule Management" "binary search,greedy,implementation,two pointers" "There are n workers and m tasks. The workers are numbered from 1 to n. Each task i has a value ai \xe2\x80\x94 the index of worker who is proficient in this task.Every task should have a worker assigned to it. If a worker is proficient in the task, they complete it in 1 hour. Otherwise, it takes them 2 hours.The workers work in parallel, independently of each other. Each worker can only work on one task at once.Assign the workers to all tasks in such a way that the tasks are completed as early as possible. The work starts at time 0. What\'s the minimum time all tasks can be completed by?" 1400
1701B Permutation greedy "Recall that a permutation of length n is an array where each element from 1 to n occurs exactly once.For a fixed positive integer d, let\'s define the cost of the permutation p of length n as the number of indices i (1\xe2\x89\xa4i<n) such that pi\xe2\x8b\x85d=pi+1.For example, if d=3 and p=[5,2,6,7,1,3,4], then the cost of such a permutation is 2, because p2\xe2\x8b\x853=p3 and p5\xe2\x8b\x853=p6.Your task is the following one: for a given value n, find the permutation of length n and the value d with maximum possible cost (over all ways to choose the permutation and d). If there are multiple answers, then print any of them." 800
1701A "Grass Field" implementation "There is a field of size 2\xc3\x972. Each cell of this field can either contain grass or be empty. The value ai,j is 1 if the cell (i,j) contains grass, or 0 otherwise.In one move, you can choose one row and one column and cut all the grass in this row and this column. In other words, you choose the row x and the column y, then you cut the grass in all cells ax,i and all cells ai,y for all i from 1 to 2. After you cut the grass from a cell, it becomes empty (i.\xe2\x80\x89e. its value is replaced by 0).Your task is to find the minimum number of moves required to cut the grass in all non-empty cells of the field (i.\xe2\x80\x89e. make all ai,j zeros).You have to answer t independent test cases." 800
1700F Puzzle "constructive algorithms,dp,greedy" "Pupils Alice and Ibragim are best friends. It\'s Ibragim\'s birthday soon, so Alice decided to gift him a new puzzle. The puzzle can be represented as a matrix with 2 rows and n columns, every element of which is either 0 or 1. In one move you can swap two values in neighboring cells.More formally, let\'s number rows 1 to 2 from top to bottom, and columns 1 to n from left to right. Also, let\'s denote a cell in row x and column y as (x,y). We consider cells (x1,y1) and (x2,y2) neighboring if |x1\xe2\x88\x92x2|+|y1\xe2\x88\x92y2|=1.Alice doesn\'t like the way in which the cells are currently arranged, so she came up with her own arrangement, with which she wants to gift the puzzle to Ibragim. Since you are her smartest friend, she asked you to help her find the minimal possible number of operations in which she can get the desired arrangement. Find this number, or determine that it\'s not possible to get the new arrangement." 2600
1700E "Serega the Pirate" "brute force,constructive algorithms" "Little pirate Serega robbed a ship with puzzles of different kinds. Among all kinds, he liked only one, the hardest.A puzzle is a table of n rows and m columns, whose cells contain each number from 1 to n\xe2\x8b\x85m exactly once.To solve a puzzle, you have to find a sequence of cells in the table, such that any two consecutive cells are adjacent by the side in the table. The sequence can have arbitrary length and should visit each cell one or more times. For a cell containing the number i, denote the position of the first occurrence of this cell in the sequence as ti. The sequence solves the puzzle, if t1<t2<\xe2\x8b\xaf<tnm. In other words, the cell with number x should be first visited before the cell with number x+1 for each x.Let\'s call a puzzle solvable, if there exists at least one suitable sequence.In one move Serega can choose two arbitrary cells in the table (not necessarily adjacent by the side) and swap their numbers. He would like to know the minimum number of moves to make his puzzle solvable, but he is too impatient. Thus, please tell if the minimum number of moves is 0, 1, or at least 2. In the case, where 1 move is required, please also find the number of suitable cell pairs to swap." 2600
1700D "River Locks" "binary search,dp,greedy,math" "Recently in Divanovo, a huge river locks system was built. There are now n locks, the i-th of them has the volume of vi liters, so that it can contain any amount of water between 0 and vi liters. Each lock has a pipe attached to it. When the pipe is open, 1 liter of water enters the lock every second.The locks system is built in a way to immediately transfer all water exceeding the volume of the lock i to the lock i+1. If the lock i+1 is also full, water will be transferred further. Water exceeding the volume of the last lock pours out to the river.   The picture illustrates 5 locks with two open pipes at locks 1 and 3. Because locks 1, 3, and 4 are already filled, effectively the water goes to locks 2 and 5. Note that the volume of the i-th lock may be greater than the volume of the i+1-th lock.To make all locks work, you need to completely fill each one of them. The mayor of Divanovo is interested in q independent queries. For each query, suppose that initially all locks are empty and all pipes are closed. Then, some pipes are opened simultaneously. For the j-th query the mayor asks you to calculate the minimum number of pipes to open so that all locks are filled no later than after tj seconds.Please help the mayor to solve this tricky problem and answer his queries." 1900
1700C "Helping the Nature" "constructive algorithms,data structures,greedy" "Little Leon lives in the forest. He has recently noticed that some trees near his favourite path are withering, while the other ones are overhydrated so he decided to learn how to control the level of the soil moisture to save the trees.There are n trees growing near the path, the current levels of moisture of each tree are denoted by the array a1,a2,\xe2\x80\xa6,an. Leon has learned three abilities which will help him to dry and water the soil.  Choose a position i and decrease the level of moisture of the trees 1,2,\xe2\x80\xa6,i by 1.  Choose a position i and decrease the level of moisture of the trees i,i+1,\xe2\x80\xa6,n by 1.  Increase the level of moisture of all trees by 1. Leon wants to know the minimum number of actions he needs to perform to make the moisture of each tree equal to 0." 1700
1700B "Palindromic Numbers" "constructive algorithms,implementation,math" "During a daily walk Alina noticed a long number written on the ground. Now Alina wants to find some positive number of same length without leading zeroes, such that the sum of these two numbers is a palindrome. Recall that a number is called a palindrome, if it reads the same right to left and left to right. For example, numbers 121,66,98989 are palindromes, and 103,239,1241 are not palindromes.Alina understands that a valid number always exist. Help her find one!" 1100
1700A "Optimal Path" "constructive algorithms,greedy,math" "You are given a table a of size n\xc3\x97m. We will consider the table rows numbered from top to bottom from 1 to n, and the columns numbered from left to right from 1 to m. We will denote a cell that is in the i-th row and in the j-th column as (i,j). In the cell (i,j) there is written a number (i\xe2\x88\x921)\xe2\x8b\x85m+j, that is aij=(i\xe2\x88\x921)\xe2\x8b\x85m+j.A turtle initially stands in the cell (1,1) and it wants to come to the cell (n,m). From the cell (i,j) it can in one step go to one of the cells (i+1,j) or (i,j+1), if it exists. A path is a sequence of cells in which for every two adjacent in the sequence cells the following satisfies: the turtle can reach from the first cell to the second cell in one step. A cost of a path is the sum of numbers that are written in the cells of the path.  For example, with n=2 and m=3 the table will look as shown above. The turtle can take the following path: (1,1)\xe2\x86\x92(1,2)\xe2\x86\x92(1,3)\xe2\x86\x92(2,3). The cost of such way is equal to a11+a12+a13+a23=12. On the other hand, the paths (1,1)\xe2\x86\x92(1,2)\xe2\x86\x92(2,2)\xe2\x86\x92(2,1) and (1,1)\xe2\x86\x92(1,3) are incorrect, because in the first path the turtle can\'t make a step (2,2)\xe2\x86\x92(2,1), and in the second path it can\'t make a step (1,1)\xe2\x86\x92(1,3).You are asked to tell the turtle a minimal possible cost of a path from the cell (1,1) to the cell (n,m). Please note that the cells (1,1) and (n,m) are a part of the way." 800
1699E "Three Days Grace" "data structures,dp,greedy,math,number theory,two pointers" "Ibti was thinking about a good title for this problem that would fit the round theme (numerus ternarium). He immediately thought about the third derivative, but that was pretty lame so he decided to include the best band in the world \xe2\x80\x94 Three Days Grace.You are given a multiset A with initial size n, whose elements are integers between 1 and m. In one operation, do the following:   select a value x from the multiset A, then  select two integers p and q such that p,q>1 and p\xe2\x8b\x85q=x. Insert p and q to A, delete x from A. Note that the size of the multiset A increases by 1 after each operation. We define the balance of the multiset A as max(ai)\xe2\x88\x92min(ai). Find the minimum possible balance after performing any number (possible zero) of operations." 2600
1699D "Almost Triple Deletions" "data structures,dp,greedy" "You are given an integer n and an array a1,a2,\xe2\x80\xa6,an.In one operation, you can choose an index i (1\xe2\x89\xa4i<n) for which ai\xe2\x89\xa0ai+1 and delete both ai and ai+1 from the array. After deleting ai and ai+1, the remaining parts of the array are concatenated.For example, if a=[1,4,3,3,6,2], then after performing an operation with i=2, the resulting array will be [1,3,6,2].What is the maximum possible length of an array of equal elements obtainable from a by performing several (perhaps none) of the aforementioned operations?" 2300
1699C "The Third Problem" "combinatorics,constructive algorithms,math" "You are given a permutation a1,a2,\xe2\x80\xa6,an of integers from 0 to n\xe2\x88\x921. Your task is to find how many permutations b1,b2,\xe2\x80\xa6,bn are similar to permutation a. Two permutations a and b of size n are considered similar if for all intervals [l,r] (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n), the following condition is satisfied: MEX([al,al+1,\xe2\x80\xa6,ar])=MEX([bl,bl+1,\xe2\x80\xa6,br]), where the MEX of a collection of integers c1,c2,\xe2\x80\xa6,ck is defined as the smallest non-negative integer x which does not occur in collection c. For example, MEX([1,2,3,4,5])=0, and MEX([0,1,2,4,5])=3.Since the total number of such permutations can be very large, you will have to print its remainder modulo 109+7.In this problem, a permutation of size n is an array consisting of n distinct integers from 0 to n\xe2\x88\x921 in arbitrary order. For example, [1,0,2,4,3] is a permutation, while [0,1,1] is not, since 1 appears twice in the array. [0,1,3] is also not a permutation, since n=3 and there is a 3 in the array." 1700
1699B "Almost Ternary Matrix" "bitmasks,constructive algorithms,matrices" "You are given two even integers nn and mm. Your task is to find any binary matrix aa with nn rows and mm columns where every cell (i,j)(i,j) has exactly two neighbours with a different value than ai,jai,j.Two cells in the matrix are considered neighbours if and only if they share a side. More formally, the neighbours of cell (x,y)(x,y) are: (x\xe2\x88\x921,y)(x\xe2\x88\x921,y), (x,y+1)(x,y+1), (x+1,y)(x+1,y) and (x,y\xe2\x88\x921)(x,y\xe2\x88\x921).It can be proven that under the given constraints, an answer always exists." 900
1699A "The Third Three Number Problem" "constructive algorithms,math" "You are given a positive integer n. Your task is to find any three integers a, b and c (0\xe2\x89\xa4a,b,c\xe2\x89\xa4109) for which (a\xe2\x8a\x95b)+(b\xe2\x8a\x95c)+(a\xe2\x8a\x95c)=n, or determine that there are no such integers.Here a\xe2\x8a\x95b denotes the bitwise XOR of a and b. For example, 2\xe2\x8a\x954=6 and 3\xe2\x8a\x951=2." 800
1698G "Long Binary String" "bitmasks,math,matrices,meet-in-the-middle,number theory" "There is a binary string t of length 10100, and initally all of its bits are 0. You are given a binary string s, and perform the following operation some times:   Select some substring of t, and replace it with its XOR with s.\xe2\x80\xa0  After several operations, the string t has exactly two bits 1; that is, there are exactly two distinct indices p and q such that the p-th and q-th bits of t are 1, and the rest of the bits are 0. Find the lexicographically largest\xe2\x80\xa1 string t satisfying these constraints, or report that no such string exists.\xe2\x80\xa0 Formally, choose an index i such that 0\xe2\x89\xa4i\xe2\x89\xa410100\xe2\x88\x92|s|. For all 1\xe2\x89\xa4j\xe2\x89\xa4|s|, if sj=1, then toggle ti+j. That is, if ti+j=0, set ti+j=1. Otherwise if ti+j=1, set ti+j=0.\xe2\x80\xa1 A binary string a is lexicographically larger than a binary string b of the same length if in the first position where a and b differ, the string a has a bit 1 and the corresponding bit in b is 0." 2900
1698F "Equal Reversal" "constructive algorithms,graphs,implementation,math" "There is an array a of length n. You may perform the following operation on it:  Choose two indices l and r where 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n and al=ar. Then, reverse the subsegment from the l-th to the r-th element, i. e. set [al,al+1,\xe2\x80\xa6,ar\xe2\x88\x921,ar] to [ar,ar\xe2\x88\x921,\xe2\x80\xa6,al+1,al]. You are also given another array b of length n which is a permutation of a. Find a sequence of at most n2 operations that transforms array a into b, or report that no such sequence exists." 2800
1698E "PermutationForces II" "brute force,combinatorics,greedy,sortings,trees,two pointers" "You are given a permutation a of length n. Recall that permutation is an array consisting of n distinct integers from 1 to n in arbitrary order.You have a strength of s and perform n moves on the permutation a. The i-th move consists of the following:   Pick two integers x and y such that i\xe2\x89\xa4x\xe2\x89\xa4y\xe2\x89\xa4min(i+s,n), and swap the positions of the integers x and y in the permutation a. Note that you can select x=y in the operation, in which case no swap will occur. You want to turn a into another permutation b after n moves. However, some elements of b are missing and are replaced with \xe2\x88\x921 instead. Count the number of ways to replace each \xe2\x88\x921 in b with some integer from 1 to n so that b is a permutation and it is possible to turn a into b with a strength of s. Since the answer can be large, output it modulo 998244353." 2300
1698D "Fixed Point Guessing" "binary search,constructive algorithms,interactive" "This is an interactive problem.Initially, there is an array a=[1,2,\xe2\x80\xa6,n], where n is an odd positive integer. The jury has selected n\xe2\x88\x9212 disjoint pairs of elements, and then the elements in those pairs are swapped. For example, if a=[1,2,3,4,5], and the pairs 1\xe2\x86\x944 and 3\xe2\x86\x945 are swapped, then the resulting array is [4,2,5,1,3]. As a result of these swaps, exactly one element will not change position. You need to find this element.To do this, you can ask several queries. In each query, you can pick two integers l and r (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n). In return, you will be given the elements of the subarray [al,al+1,\xe2\x80\xa6,ar] sorted in increasing order. Find the element which did not change position. You can make at most 15 queries.The array a is fixed before the interaction and does not change after your queries.Recall that an array b is a subarray of the array a if b can be obtained from a by deletion of several (possibly, zero or all) elements from the beginning and several (possibly, zero or all) elements from the end." 1600
1698C "3SUM Closure" "brute force,data structures" "You are given an array a of length n. The array is called 3SUM-closed if for all distinct indices i, j, k, the sum ai+aj+ak is an element of the array. More formally, a is 3SUM-closed if for all integers 1\xe2\x89\xa4i<j<k\xe2\x89\xa4n, there exists some integer 1\xe2\x89\xa4l\xe2\x89\xa4n such that ai+aj+ak=al.Determine if a is 3SUM-closed." 1300
1698B "Rising Sand" "constructive algorithms,greedy,implementation" "There are n piles of sand where the i-th pile has ai blocks of sand. The i-th pile is called too tall if 1<i<n and ai>ai\xe2\x88\x921+ai+1. That is, a pile is too tall if it has more sand than its two neighbours combined. (Note that piles on the ends of the array cannot be too tall.)You are given an integer k. An operation consists of picking k consecutive piles of sand and adding one unit of sand to them all. Formally, pick 1\xe2\x89\xa4l,r\xe2\x89\xa4n such that r\xe2\x88\x92l+1=k. Then for all l\xe2\x89\xa4i\xe2\x89\xa4r, update ai\xe2\x86\x90ai+1.What is the maximum number of piles that can simultaneously be too tall after some (possibly zero) operations?" 800
1698A "XOR Mixup" "bitmasks,brute force" "There is an array a with n\xe2\x88\x921 integers. Let x be the bitwise XOR of all elements of the array. The number x is added to the end of the array a (now it has length n), and then the elements are shuffled.You are given the newly formed array a. What is x? If there are multiple possible values of x, you can output any of them." 800
1697F "Too Many Constraints" "2-sat,constructive algorithms,graphs,implementation" "You are asked to build an array a, consisting of n integers, each element should be from 1 to k.The array should be non-decreasing (ai\xe2\x89\xa4ai+1 for all i from 1 to n\xe2\x88\x921). You are also given additional constraints on it. Each constraint is of one of three following types:   1 i x: ai should not be equal to x;  2 i j x: ai+aj should be less than or equal to x;  3 i j x: ai+aj should be greater than or equal to x. Build any non-decreasing array that satisfies all constraints or report that no such array exists." 2800
1697E Coloring "brute force,combinatorics,constructive algorithms,dp,geometry,graphs,greedy,implementation,math" "You are given n points on the plane, the coordinates of the i-th point are (xi,yi). No two points have the same coordinates.The distance between points i and j is defined as d(i,j)=|xi\xe2\x88\x92xj|+|yi\xe2\x88\x92yj|.For each point, you have to choose a color, represented by an integer from 1 to n. For every ordered triple of different points (a,b,c), the following constraints should be met:  if a, b and c have the same color, then d(a,b)=d(a,c)=d(b,c);  if a and b have the same color, and the color of c is different from the color of a, then d(a,b)<d(a,c) and d(a,b)<d(b,c). Calculate the number of different ways to choose the colors that meet these constraints." 2400
1697D "Guess The String" "binary search,constructive algorithms,interactive" "This is an interactive problem. Remember to flush your output while communicating with the testing program. You may use fflush(stdout) in C++, system.out.flush() in Java, stdout.flush() in Python or flush(output) in Pascal to flush the output. If you use some other programming language, consult its documentation. You may also refer to the guide on interactive problems: https://codeforces.com/blog/entry/45307.The jury has chosen a string s consisting of n characters; each character of s is a lowercase Latin letter. Your task is to guess this string; initially, you know only its length.You may ask queries of two types:  1 i \xe2\x80\x94 the query of the first type, where i is an integer from 1 to n. In response to this query, the jury will tell you the character si;  2 l r \xe2\x80\x94 the query of the second type, where l and r are integers such that 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n. In response to this query, the jury will tell you the number of different characters among sl,sl+1,\xe2\x80\xa6,sr. You are allowed to ask no more than 26 queries of the first type, and no more than 6000 queries of the second type. Your task is to restore the string s.For each test in this problem, the string s is fixed beforehand, and will be the same for every submission." 1900
1697C "awoo\'s Favorite Problem" "binary search,constructive algorithms,data structures,greedy,implementation,strings,two pointers" "You are given two strings s and t, both of length n. Each character in both string is \'a\', \'b\' or \'c\'.In one move, you can perform one of the following actions:   choose an occurrence of ""ab"" in s and replace it with ""ba"";  choose an occurrence of ""bc"" in s and replace it with ""cb"". You are allowed to perform an arbitrary amount of moves (possibly, zero). Can you change string s to make it equal to string t?" 1400
1697B Promo greedy,sortings "The store sells n items, the price of the i-th item is pi. The store\'s management is going to hold a promotion: if a customer purchases at least x items, y cheapest of them are free.The management has not yet decided on the exact values of x and y. Therefore, they ask you to process q queries: for the given values of x and y, determine the maximum total value of items received for free, if a customer makes one purchase.Note that all queries are independent; they don\'t affect the store\'s stock." 900
1697A "Parkway Walk" greedy,implementation "You are walking through a parkway near your house. The parkway has n+1 benches in a row numbered from 1 to n+1 from left to right. The distance between the bench i and i+1 is ai meters.Initially, you have m units of energy. To walk 1 meter of distance, you spend 1 unit of your energy. You can\'t walk if you have no energy. Also, you can restore your energy by sitting on benches (and this is the only way to restore the energy). When you are sitting, you can restore any integer amount of energy you want (if you sit longer, you restore more energy). Note that the amount of your energy can exceed m.Your task is to find the minimum amount of energy you have to restore (by sitting on benches) to reach the bench n+1 from the bench 1 (and end your walk).You have to answer t independent test cases." 800
1696H "Maximum Product?" "brute force,combinatorics,dp,greedy,implementation,math,two pointers" "You are given a positive integer k. For a multiset of integers S, define f(S) as the following.  If the number of elements in S is less than k, f(S)=0.  Otherwise, define f(S) as the maximum product you can get by choosing exactly k integers from S. More formally, let |S| denote the number of elements in S. Then,  If |S|<k, f(S)=0.  Otherwise, f(S)=maxT\xe2\x8a\x86S,|T|=k(\xe2\x88\x8fi\xe2\x88\x88Ti). You are given a multiset of integers, A. Compute \xe2\x88\x91B\xe2\x8a\x86Af(B) modulo 109+7.Note that in this problem, we distinguish the elements by indices instead of values. That is, a multiset consisting of n elements always has 2n distinct subsets regardless of whether some of its elements are equal." 3500
1696G "Fishingprince Plays With Array Again" "brute force,data structures,geometry,math" "Suppose you are given a 1-indexed sequence a of non-negative integers, whose length is n, and two integers x, y. In consecutive t seconds (t can be any positive real number), you can do one of the following operations:  Select 1\xe2\x89\xa4i<n, decrease ai by x\xe2\x8b\x85t, and decrease ai+1 by y\xe2\x8b\x85t.  Select 1\xe2\x89\xa4i<n, decrease ai by y\xe2\x8b\x85t, and decrease ai+1 by x\xe2\x8b\x85t. Define the minimum amount of time (it might be a real number) required to make all elements in the sequence less than or equal to 0 as f(a).For example, when x=1, y=2, it takes 3 seconds to deal with the array [3,1,1,3]. We can:  In the first 1.5 seconds do the second operation with i=1.  In the next 1.5 seconds do the first operation with i=3. We can prove that it\'s not possible to make all elements less than or equal to 0 in less than 3 seconds, so f([3,1,1,3])=3.Now you are given a 1-indexed sequence b of positive integers, whose length is n. You are also given positive integers x, y. Process q queries of the following two types:  1 k v: change bk to v.  2 l r: print f([bl,bl+1,\xe2\x80\xa6,br])." 3300
1696F "Tree Recovery" "brute force,constructive algorithms,dfs and similar,dsu,graphs,trees" "Fishingprince loves trees. A tree is a connected undirected graph without cycles.Fishingprince has a tree of n vertices. The vertices are numbered 1 through n. Let d(x,y) denote the shortest distance on the tree from vertex x to vertex y, assuming that the length of each edge is 1.However, the tree was lost in an accident. Fortunately, Fishingprince still remembers some information about the tree. More specifically, for every triple of integers x,y,z (1\xe2\x89\xa4x<y\xe2\x89\xa4n, 1\xe2\x89\xa4z\xe2\x89\xa4n) he remembers whether d(x,z)=d(y,z) or not.Help him recover the structure of the tree, or report that no tree satisfying the constraints exists." 2600
1696E "Placing Jinas" combinatorics,math "We say an infinite sequence a0,a1,a2,\xe2\x80\xa6 is non-increasing if and only if for all i\xe2\x89\xa50, ai\xe2\x89\xa5ai+1.There is an infinite right and down grid. The upper-left cell has coordinates (0,0). Rows are numbered 0 to infinity from top to bottom, columns are numbered from 0 to infinity from left to right.There is also a non-increasing infinite sequence a0,a1,a2,\xe2\x80\xa6. You are given a0, a1, \xe2\x80\xa6, an; for all i>n, ai=0. For every pair of x, y, the cell with coordinates (x,y) (which is located at the intersection of x-th row and y-th column) is white if y<ax and black otherwise.Initially there is one doll named Jina on (0,0). You can do the following operation.  Select one doll on (x,y). Remove it and place a doll on (x,y+1) and place a doll on (x+1,y). Note that multiple dolls can be present at a cell at the same time; in one operation, you remove only one. Your goal is to make all white cells contain 0 dolls.What\'s the minimum number of operations needed to achieve the goal? Print the answer modulo 109+7." 2000
1696D "Permutation Graph" "binary search,constructive algorithms,data structures,divide and conquer,greedy,shortest paths" "A permutation is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array) and [1,3,4] is also not a permutation (n=3 but there is 4 in the array).You are given a permutation of 1,2,\xe2\x80\xa6,n, [a1,a2,\xe2\x80\xa6,an]. For integers i, j such that 1\xe2\x89\xa4i<j\xe2\x89\xa4n, define mn(i,j) as jmink=iak, and define mx(i,j) as jmaxk=iak.Let us build an undirected graph of n vertices, numbered 1 to n. For every pair of integers 1\xe2\x89\xa4i<j\xe2\x89\xa4n, if mn(i,j)=ai and mx(i,j)=aj both holds, or mn(i,j)=aj and mx(i,j)=ai both holds, add an undirected edge of length 1 between vertices i and j.In this graph, find the length of the shortest path from vertex 1 to vertex n. We can prove that 1 and n will always be connected via some path, so a shortest path always exists." 1900
1696C "Fishingprince Plays With Array" "constructive algorithms,greedy,implementation,math" "Fishingprince is playing with an array [a1,a2,\xe2\x80\xa6,an]. He also has a magic number m.He can do the following two operations on it:  Select 1\xe2\x89\xa4i\xe2\x89\xa4n such that ai is divisible by m (that is, there exists an integer t such that m\xe2\x8b\x85t=ai). Replace ai with m copies of aim. The order of the other elements doesn\'t change. For example, when m=2 and a=[2,3] and i=1, a changes into [1,1,3].  Select 1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x92m+1 such that ai=ai+1=\xe2\x8b\xaf=ai+m\xe2\x88\x921. Replace these m elements with a single m\xe2\x8b\x85ai. The order of the other elements doesn\'t change. For example, when m=2 and a=[3,2,2,3] and i=2, a changes into [3,4,3]. Note that the array length might change during the process. The value of n above is defined as the current length of the array (might differ from the n in the input).Fishingprince has another array [b1,b2,\xe2\x80\xa6,bk]. Please determine if he can turn a into b using any number (possibly zero) of operations." 1400
1696B "NIT Destroys the Universe" greedy "For a collection of integers S, define mex(S) as the smallest non-negative integer that does not appear in S.NIT, the cleaver, decides to destroy the universe. He is not so powerful as Thanos, so he can only destroy the universe by snapping his fingers several times.The universe can be represented as a 1-indexed array a of length n. When NIT snaps his fingers, he does the following operation on the array:  He selects positive integers l and r such that 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n. Let w=mex({al,al+1,\xe2\x80\xa6,ar}). Then, for all l\xe2\x89\xa4i\xe2\x89\xa4r, set ai to w. We say the universe is destroyed if and only if for all 1\xe2\x89\xa4i\xe2\x89\xa4n, ai=0 holds.Find the minimum number of times NIT needs to snap his fingers to destroy the universe. That is, find the minimum number of operations NIT needs to perform to make all elements in the array equal to 0." 900
1696A "NIT orz!" bitmasks,greedy "NIT, the cleaver, is new in town! Thousands of people line up to orz him. To keep his orzers entertained, NIT decided to let them solve the following problem related to orz. Can you solve this problem too?You are given a 1-indexed array of n integers, a, and an integer z. You can do the following operation any number (possibly zero) of times:  Select a positive integer i such that 1\xe2\x89\xa4i\xe2\x89\xa4n. Then, simutaneously set ai to (aiorz) and set z to (aiandz). In other words, let x and y respectively be the current values of ai and z. Then set ai to (xory) and set z to (xandy). Here or and and denote the bitwise operations OR and AND respectively.Find the maximum possible value of the maximum value in a after any number (possibly zero) of operations." 800
1695E "Ambiguous Dominoes" "constructive algorithms,dfs and similar,graphs" "Polycarp and Monocarp are both solving the same puzzle with dominoes. They are given the same set of n dominoes, the i-th of which contains two numbers xi and yi. They are also both given the same m by k grid of values aij such that m\xe2\x8b\x85k=2n.The puzzle asks them to place the n dominoes on the grid in such a way that none of them overlap, and the values on each domino match the aij values that domino covers. Dominoes can be rotated arbitrarily before being placed on the grid, so the domino (xi,yi) is equivalent to the domino (yi,xi).They have both solved the puzzle, and compared their answers, but noticed that not only did their solutions not match, but none of the n dominoes were in the same location in both solutions! Formally, if two squares were covered by the same domino in Polycarp\'s solution, they were covered by different dominoes in Monocarp\'s solution. The diagram below shows one potential a grid, along with the two players\' solutions.  Polycarp and Monocarp remember the set of dominoes they started with, but they have lost the grid a. Help them reconstruct one possible grid a, along with both of their solutions, or determine that no such grid exists." 2700
1695D2 "Tree Queries (Hard Version)" "constructive algorithms,dfs and similar,dp,greedy,trees" "The only difference between this problem and D1 is the bound on the size of the tree.You are given an unrooted tree with n vertices. There is some hidden vertex x in that tree that you are trying to find.To do this, you may ask k queries v1,v2,\xe2\x80\xa6,vk where the vi are vertices in the tree. After you are finished asking all of the queries, you are given k numbers d1,d2,\xe2\x80\xa6,dk, where di is the number of edges on the shortest path between vi and x. Note that you know which distance corresponds to which query.What is the minimum k such that there exists some queries v1,v2,\xe2\x80\xa6,vk that let you always uniquely identify x (no matter what x is).Note that you don\'t actually need to output these queries." 2300
1695D1 "Tree Queries (Easy Version)" "brute force,constructive algorithms,dfs and similar,dp,greedy,trees" "The only difference between this problem and D2 is the bound on the size of the tree.You are given an unrooted tree with n vertices. There is some hidden vertex x in that tree that you are trying to find.To do this, you may ask k queries v1,v2,\xe2\x80\xa6,vk where the vi are vertices in the tree. After you are finished asking all of the queries, you are given k numbers d1,d2,\xe2\x80\xa6,dk, where di is the number of edges on the shortest path between vi and x. Note that you know which distance corresponds to which query.What is the minimum k such that there exists some queries v1,v2,\xe2\x80\xa6,vk that let you always uniquely identify x (no matter what x is).Note that you don\'t actually need to output these queries." 2200
1695C "Zero Path" "brute force,data structures,dp,graphs,greedy,shortest paths" "You are given a grid with n rows and m columns. We denote the square on the i-th (1\xe2\x89\xa4i\xe2\x89\xa4n) row and j-th (1\xe2\x89\xa4j\xe2\x89\xa4m) column by (i,j) and the number there by aij. All numbers are equal to 1 or to \xe2\x88\x921. You start from the square (1,1) and can move one square down or one square to the right at a time. In the end, you want to end up at the square (n,m).Is it possible to move in such a way so that the sum of the values written in all the visited cells (including a11 and anm) is 0?" 1700
1695B "Circle Game" games,greedy "Mike and Joe are playing a game with some stones. Specifically, they have n piles of stones of sizes a1,a2,\xe2\x80\xa6,an. These piles are arranged in a circle.The game goes as follows. Players take turns removing some positive number of stones from a pile in clockwise order starting from pile 1. Formally, if a player removed stones from pile i on a turn, the other player removes stones from pile ((imodn)+1) on the next turn.If a player cannot remove any stones on their turn (because the pile is empty), they lose. Mike goes first.If Mike and Joe play optimally, who will win?" 1000
1695A "Subrectangle Guess" games "Michael and Joe are playing a game. The game is played on a grid with n rows and m columns, filled with distinct integers. We denote the square on the i-th (1\xe2\x89\xa4i\xe2\x89\xa4n) row and j-th (1\xe2\x89\xa4j\xe2\x89\xa4m) column by (i,j) and the number there by aij.Michael starts by saying two numbers h (1\xe2\x89\xa4h\xe2\x89\xa4n) and w (1\xe2\x89\xa4w\xe2\x89\xa4m). Then Joe picks any h\xc3\x97w subrectangle of the board (without Michael seeing).Formally, an h\xc3\x97w subrectangle starts at some square (a,b) where 1\xe2\x89\xa4a\xe2\x89\xa4n\xe2\x88\x92h+1 and 1\xe2\x89\xa4b\xe2\x89\xa4m\xe2\x88\x92w+1. It contains all squares (i,j) for a\xe2\x89\xa4i\xe2\x89\xa4a+h\xe2\x88\x921 and b\xe2\x89\xa4j\xe2\x89\xa4b+w\xe2\x88\x921.  Possible move by Joe if Michael says 3\xc3\x972 (with maximum of 15). Finally, Michael has to guess the maximum number in the subrectangle. He wins if he gets it right.Because Michael doesn\'t like big numbers, he wants the area of the chosen subrectangle (that is, h\xe2\x8b\x85w), to be as small as possible, while still ensuring that he wins, not depending on Joe\'s choice. Help Michael out by finding this minimum possible area. It can be shown that Michael can always choose h,w for which he can ensure that he wins." 800
1694B "Paranoid String" "constructive algorithms,greedy" "Let\'s call a binary string T of length m indexed from 1 to m paranoid if we can obtain a string of length 1 by performing the following two kinds of operations m\xe2\x88\x921 times in any order : Select any substring of T that is equal to 01, and then replace it with 1. Select any substring of T that is equal to 10, and then replace it with 0.For example, if T= 001, we can select the substring [T2T3] and perform the first operation. So we obtain T= 01.You are given a binary string S of length n indexed from 1 to n. Find the number of pairs of integers (l,r) 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n such that S[l\xe2\x80\xa6r] (the substring of S from l to r) is a paranoid string." 1200
1694A Creep greedy,implementation "Define the score of some binary string T as the absolute difference between the number of zeroes and ones in it. (for example, T= 010001 contains 4 zeroes and 2 ones, so the score of T is |4\xe2\x88\x922|=2).Define the creepiness of some binary string S as the maximum score among all of its prefixes (for example, the creepiness of S= 01001 is equal to 2 because the score of the prefix S[1\xe2\x80\xa64] is 2 and the rest of the prefixes have a score of 2 or less).Given two integers a and b, construct a binary string consisting of a zeroes and b ones with the minimum possible creepiness." 800
1693F "I Might Be Wrong" "binary search,greedy,two pointers" "You are given a binary string S of length n indexed from 1 to n. You can perform the following operation any number of times (possibly zero):Choose two integers l and r (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n). Let cnt0 be the number of times 0 occurs in S[l\xe2\x80\xa6r] and cnt1 be the number of times 1 occurs in S[l\xe2\x80\xa6r]. You can pay |cnt0\xe2\x88\x92cnt1|+1 coins and sort the S[l\xe2\x80\xa6r]. (by S[l\xe2\x80\xa6r] we mean the substring of S starting at position l and ending at position r)For example if S= 11001, we can perform the operation on S[2\xe2\x80\xa64], paying |2\xe2\x88\x921|+1=2 coins, and obtain S= 10011 as a new string.Find the minimum total number of coins required to sort S in increasing order." 3400
1693E "Outermost Maximums" "data structures,greedy" "Yeri has an array of n+2 non-negative integers : a0,a1,...,an,an+1.We know that a0=an+1=0.She wants to make all the elements of a equal to zero in the minimum number of operations.In one operation she can do one of the following:  Choose the leftmost maximum element and change it to the maximum of the elements on its left. Choose the rightmost maximum element and change it to the maximum of the elements on its right.Help her find the minimum number of operations needed to make all elements of a equal to zero." 3400
1693D "Decinc Dividing" "brute force,data structures,divide and conquer,dp,greedy" "Let\'s call an array a of m integers a1,a2,\xe2\x80\xa6,am Decinc if a can be made increasing by removing a decreasing subsequence (possibly empty) from it. For example, if a=[3,2,4,1,5], we can remove the decreasing subsequence [a1,a4] from a and obtain a=[2,4,5], which is increasing.You are given a permutation p of numbers from 1 to n. Find the number of pairs of integers (l,r) with 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n such that p[l\xe2\x80\xa6r] (the subarray of p from l to r) is a Decinc array." 2800
1693C "Keshi in Search of AmShZ" "graphs,greedy,shortest paths" "AmShZ has traveled to Italy from Iran for the Thom Yorke concert. There are n cities in Italy indexed from 1 to n and m directed roads indexed from 1 to m. Initially, Keshi is located in the city 1 and wants to go to AmShZ\'s house in the city n. Since Keshi doesn\'t know the map of Italy, AmShZ helps him to see each other as soon as possible.In the beginning of each day, AmShZ can send one of the following two messages to Keshi: AmShZ sends the index of one road to Keshi as a blocked road. Then Keshi will understand that he should never use that road and he will remain in his current city for the day. AmShZ tells Keshi to move. Then, Keshi will randomly choose one of the cities reachable from his current city and move there. (city B is reachable from city A if there\'s an out-going road from city A to city B which hasn\'t become blocked yet). If there are no such cities, Keshi will remain in his current city.Note that AmShZ always knows Keshi\'s current location. AmShZ and Keshi want to find the smallest possible integer d for which they can make sure that they will see each other after at most d days. Help them find d." 2300
1693B "Fake Plastic Trees" "dfs and similar,dp,greedy,trees" "We are given a rooted tree consisting of n vertices numbered from 1 to n. The root of the tree is the vertex 1 and the parent of the vertex v is pv.There is a number written on each vertex, initially all numbers are equal to 0. Let\'s denote the number written on the vertex v as av.For each v, we want av to be between lv and rv (lv\xe2\x89\xa4av\xe2\x89\xa4rv).In a single operation we do the following:   Choose some vertex v. Let b1,b2,\xe2\x80\xa6,bk be vertices on the path from the vertex 1 to vertex v (meaning b1=1, bk=v and bi=pbi+1). Choose a non-decreasing array c of length k of nonnegative integers: 0\xe2\x89\xa4c1\xe2\x89\xa4c2\xe2\x89\xa4\xe2\x80\xa6\xe2\x89\xa4ck. For each i (1\xe2\x89\xa4i\xe2\x89\xa4k), increase abi by ci. What\'s the minimum number of operations needed to achieve our goal?" 1700
1693A "Directional Increase" greedy "We have an array of length n. Initially, each element is equal to 0 and there is a pointer located on the first element.We can do the following two kinds of operations any number of times (possibly zero) in any order: If the pointer is not on the last element, increase the element the pointer is currently on by 1. Then move it to the next element. If the pointer is not on the first element, decrease the element the pointer is currently on by 1. Then move it to the previous element.But there is one additional rule. After we are done, the pointer has to be on the first element.You are given an array a. Determine whether it\'s possible to obtain a after some operations or not." 1300
1692H Gambling "data structures,dp,greedy,math" "Marian is at a casino. The game at the casino works like this.Before each round, the player selects a number between 1 and 109. After that, a dice with 109 faces is rolled so that a random number between 1 and 109 appears. If the player guesses the number correctly their total money is doubled, else their total money is halved. Marian predicted the future and knows all the numbers x1,x2,\xe2\x80\xa6,xn that the dice will show in the next n rounds. He will pick three integers a, l and r (l\xe2\x89\xa4r). He will play r\xe2\x88\x92l+1 rounds (rounds between l and r inclusive). In each of these rounds, he will guess the same number a. At the start (before the round l) he has 1 dollar.Marian asks you to determine the integers a, l and r (1\xe2\x89\xa4a\xe2\x89\xa4109, 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n) such that he makes the most money at the end.Note that during halving and multiplying there is no rounding and there are no precision errors. So, for example during a game, Marian could have money equal to 11024, 1128, 12, 1, 2, 4, etc. (any value of 2t, where t is an integer of any sign)." 1700
1692G 2^Sort "data structures,dp,sortings,two pointers" "Given an array a of length n and an integer k, find the number of indices 1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x92k such that the subarray [ai,\xe2\x80\xa6,ai+k] with length k+1 (not with length k) has the following property:   If you multiply the first element by 20, the second element by 21, ..., and the (k+1)-st element by 2k, then this subarray is sorted in strictly increasing order.  More formally, count the number of indices 1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x92k such that 20\xe2\x8b\x85ai<21\xe2\x8b\x85ai+1<22\xe2\x8b\x85ai+2<\xe2\x8b\xaf<2k\xe2\x8b\x85ai+k." 1400
1692F 3SUM "brute force,math" "Given an array a of positive integers with length n, determine if there exist three distinct indices i, j, k such that ai+aj+ak ends in the digit 3." 1300
1692E "Binary Deque" "binary search,implementation,two pointers" "Slavic has an array of length n consisting only of zeroes and ones. In one operation, he removes either the first or the last element of the array. What is the minimum number of operations Slavic has to perform such that the total sum of the array is equal to s after performing all the operations? In case the sum s can\'t be obtained after any amount of operations, you should output -1." 1200
1692D "The Clock" "brute force,implementation" "Victor has a 24-hour clock that shows the time in the format ""HH:MM"" (00 \xe2\x89\xa4 HH \xe2\x89\xa4 23, 00 \xe2\x89\xa4 MM \xe2\x89\xa4 59). He looks at the clock every x minutes, and the clock is currently showing time s. How many different palindromes will Victor see in total after looking at the clock every x minutes, the first time being at time s?For example, if the clock starts out as 03:12 and Victor looks at the clock every 360 minutes (i.e. every 6 hours), then he will see the times 03:12, 09:12, 15:12, 21:12, 03:12, and the times will continue to repeat. Here the time 21:12 is the only palindrome he will ever see, so the answer is 1.A palindrome is a string that reads the same backward as forward. For example, the times 12:21, 05:50, 11:11 are palindromes but 13:13, 22:10, 02:22 are not." 1100
1692C "Where\'s the Bishop?" implementation "Mihai has an 8\xc3\x978 chessboard whose rows are numbered from 1 to 8 from top to bottom and whose columns are numbered from 1 to 8 from left to right.Mihai has placed exactly one bishop on the chessboard. The bishop is not placed on the edges of the board. (In other words, the row and column of the bishop are between 2 and 7, inclusive.)The bishop attacks in all directions diagonally, and there is no limit to the distance which the bishop can attack. Note that the cell on which the bishop is placed is also considered attacked.   An example of a bishop on a chessboard. The squares it attacks are marked in red. Mihai has marked all squares the bishop attacks, but forgot where the bishop was! Help Mihai find the position of the bishop." 800
1692B "All Distinct" greedy,sortings "Sho has an array a consisting of n integers. An operation consists of choosing two distinct indices i and j and removing ai and aj from the array.For example, for the array [2,3,4,2,5], Sho can choose to remove indices 1 and 3. After this operation, the array becomes [3,2,5]. Note that after any operation, the length of the array is reduced by two.After he made some operations, Sho has an array that has only distinct elements. In addition, he made operations such that the resulting array is the longest possible. More formally, the array after Sho has made his operations respects these criteria:   No pairs such that (i<j) and ai=aj exist.  The length of a is maximized. Output the length of the final array." 800
1692A Marathon implementation "You are given four distinct integers a, b, c, d. Timur and three other people are running a marathon. The value a is the distance that Timur has run and b, c, d correspond to the distances the other three participants ran. Output the number of participants in front of Timur." 800
1691F "K-Set Tree" "combinatorics,dfs and similar,dp,math,trees" "You are given a tree G with n vertices and an integer k. The vertices of the tree are numbered from 1 to n.For a vertex r and a subset S of vertices of G, such that |S|=k, we define f(r,S) as the size of the smallest rooted subtree containing all vertices in S when the tree is rooted at r. A set of vertices T is called a rooted subtree, if all the vertices in T are connected, and for each vertex in T, all its descendants belong to T.You need to calculate the sum of f(r,S) over all possible distinct combinations of vertices r and subsets S, where |S|=k. Formally, compute the following: \xe2\x88\x91r\xe2\x88\x88V\xe2\x88\x91S\xe2\x8a\x86V,|S|=kf(r,S), where V is the set of vertices in G.Output the answer modulo 109+7." 2500
1691E "Number of Groups" "data structures,dfs and similar,dsu,graphs,greedy,sortings" "You are given n colored segments on the number line. Each segment is either colored red or blue. The i-th segment can be represented by a tuple (ci,li,ri). The segment contains all the points in the range [li,ri], inclusive, and its color denoted by ci:   if ci=0, it is a red segment;  if ci=1, it is a blue segment. We say that two segments of different colors are connected, if they share at least one common point. Two segments belong to the same group, if they are either connected directly, or through a sequence of directly connected segments. Find the number of groups of segments." 2300
1691D "Max GEQ Sum" "binary search,constructive algorithms,data structures,divide and conquer,implementation,two pointers" "You are given an array a of n integers. You are asked to find out if the inequality max(ai,ai+1,\xe2\x80\xa6,aj\xe2\x88\x921,aj)\xe2\x89\xa5ai+ai+1+\xe2\x8b\xaf+aj\xe2\x88\x921+aj holds for all pairs of indices (i,j), where 1\xe2\x89\xa4i\xe2\x89\xa4j\xe2\x89\xa4n." 1800
1691C "Sum of Substrings" "brute force,constructive algorithms,greedy,math,strings" "You are given a binary string s of length n.Let\'s define di as the number whose decimal representation is sisi+1 (possibly, with a leading zero). We define f(s) to be the sum of all the valid di. In other words, f(s)=n\xe2\x88\x921\xe2\x88\x91i=1di.For example, for the string s=1011:   d1=10 (ten);  d2=01 (one)  d3=11 (eleven);  f(s)=10+01+11=22. In one operation you can swap any two adjacent elements of the string. Find the minimum value of f(s) that can be achieved if at most k operations are allowed." 1400
1691B "Shoe Shuffling" "constructive algorithms,greedy,implementation,two pointers" "A class of students got bored wearing the same pair of shoes every day, so they decided to shuffle their shoes among themselves. In this problem, a pair of shoes is inseparable and is considered as a single object.There are n students in the class, and you are given an array s in non-decreasing order, where si is the shoe size of the i-th student. A shuffling of shoes is valid only if no student gets their own shoes and if every student gets shoes of size greater than or equal to their size. You have to output a permutation p of {1,2,\xe2\x80\xa6,n} denoting a valid shuffling of shoes, where the i-th student gets the shoes of the pi-th student (pi\xe2\x89\xa0i). And output \xe2\x88\x921 if a valid shuffling does not exist.A permutation is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array) and [1,3,4] is also not a permutation (n=3 but there is 4 in the array)." 1000
1691A "Beat The Odds" "brute force,greedy,math" "Given a sequence a1,a2,\xe2\x80\xa6,an, find the minimum number of elements to remove from the sequence such that after the removal, the sum of every 2 consecutive elements is even." 800
1690G "Count the Trains" "binary search,data structures,greedy,sortings" "There are n of independent carriages on the rails. The carriages are numbered from left to right from 1 to n. The carriages are not connected to each other. The carriages move to the left, so that the carriage with number 1 moves ahead of all of them.The i-th carriage has its own engine, which can accelerate the carriage to ai km/h, but the carriage cannot go faster than the carriage in front of it. See example for explanation.All carriages start moving to the left at the same time, and they naturally form trains. We will call trains \xe2\x80\x94 consecutive moving carriages having the same speed.For example, we have n=5 carriages and array a=[10,13,5,2,6]. Then the final speeds of the carriages will be [10,10,5,2,2]. Respectively, 3 of the train will be formed.There are also messages saying that some engine has been corrupted:  message ""k d"" means that the speed of the k-th carriage has decreased by d (that is, there has been a change in the maximum speed of the carriage ak=ak\xe2\x88\x92d).  Messages arrive sequentially, the processing of the next message takes into account the changes from all previous messages.After each message determine the number of formed trains." 2000
1690F "Shifting String" "graphs,math,number theory,strings" "Polycarp found the string s and the permutation p. Their lengths turned out to be the same and equal to n.A permutation of n elements \xe2\x80\x94 is an array of length n, in which every integer from 1 to n occurs exactly once. For example, [1,2,3] and [4,3,5,1,2] are permutations, but [1,2,4], [4,3,2,1,2] and [0,1,2] are not.In one operation he can multiply s by p, so he replaces s with string new, in which for any i from 1 to n it is true that newi=spi. For example, with s=wmbe and p=[3,1,4,2], after operation the string will turn to s=s3s1s4s2=bwem.Polycarp wondered after how many operations the string would become equal to its initial value for the first time. Since it may take too long, he asks for your help in this matter.It can be proved that the required number of operations always exists. It can be very large, so use a 64-bit integer type." 1700
1690E "Price Maximization" "binary search,greedy,math,two pointers" "A batch of n goods (n \xe2\x80\x94 an even number) is brought to the store, i-th of which has weight ai. Before selling the goods, they must be packed into packages. After packing, the following will be done:   There will be n2 packages, each package contains exactly two goods;  The weight of the package that contains goods with indices i and j (1\xe2\x89\xa4i,j\xe2\x89\xa4n) is ai+aj. With this, the cost of a package of weight x is always \xe2\x8c\x8axk\xe2\x8c\x8b burles (rounded down), where k \xe2\x80\x94 a fixed and given value.Pack the goods to the packages so that the revenue from their sale is maximized. In other words, make such n2 pairs of given goods that the sum of the values \xe2\x8c\x8axik\xe2\x8c\x8b, where xi is the weight of the package number i (1\xe2\x89\xa4i\xe2\x89\xa4n2), is maximal.For example, let n=6,k=3, weights of goods a=[3,2,7,1,4,8]. Let\'s pack them into the following packages.   In the first package we will put the third and sixth goods. Its weight will be a3+a6=7+8=15. The cost of the package will be \xe2\x8c\x8a153\xe2\x8c\x8b=5 burles.  In the second package put the first and fifth goods, the weight is a1+a5=3+4=7. The cost of the package is \xe2\x8c\x8a73\xe2\x8c\x8b=2 burles.  In the third package put the second and fourth goods, the weight is a2+a4=2+1=3. The cost of the package is \xe2\x8c\x8a33\xe2\x8c\x8b=1 burle. With this packing, the total cost of all packs would be 5+2+1=8 burles." 1500
1690D "Black and White Stripe" "implementation,two pointers" "You have a stripe of checkered paper of length n. Each cell is either white or black.What is the minimum number of cells that must be recolored from white to black in order to have a segment of k consecutive black cells on the stripe?If the input data is such that a segment of k consecutive black cells already exists, then print 0." 1000
1690C "Restoring the Duration of Tasks" "data structures,greedy,implementation" "Recently, Polycarp completed n successive tasks.For each completed task, the time si is known when it was given, no two tasks were given at the same time. Also given is the time fi when the task was completed. For each task, there is an unknown value di (di>0) \xe2\x80\x94 duration of task execution.It is known that the tasks were completed in the order in which they came. Polycarp performed the tasks as follows:  As soon as the very first task came, Polycarp immediately began to carry it out.  If a new task arrived before Polycarp finished the previous one, he put the new task at the end of the queue.  When Polycarp finished executing the next task and the queue was not empty, he immediately took a new task from the head of the queue (if the queue is empty \xe2\x80\x94 he just waited for the next task). Find di (duration) of each task." 800
1690B "Array Decrements" greedy,implementation "Kristina has two arrays a and b, each containing n non-negative integers. She can perform the following operation on array a any number of times:   apply a decrement to each non-zero element of the array, that is, replace the value of each element ai such that ai>0 with the value ai\xe2\x88\x921 (1\xe2\x89\xa4i\xe2\x89\xa4n). If ai was 0, its value does not change. Determine whether Kristina can get an array b from an array a in some number of operations (probably zero). In other words, can she make ai=bi after some number of operations for each 1\xe2\x89\xa4i\xe2\x89\xa4n?For example, let n=4, a=[3,5,4,1] and b=[1,3,2,0]. In this case, she can apply the operation twice:   after the first application of the operation she gets a=[2,4,3,0];  after the second use of the operation she gets a=[1,3,2,0]. Thus, in two operations, she can get an array b from an array a." 800
1690A "Print a Pedestal (Codeforces logo?)" "constructive algorithms,greedy" "Given the integer n \xe2\x80\x94 the number of available blocks. You must use all blocks to build a pedestal. The pedestal consists of 3 platforms for 2-nd, 1-st and 3-rd places respectively. The platform for the 1-st place must be strictly higher than for the 2-nd place, and the platform for the 2-nd place must be strictly higher than for the 3-rd place. Also, the height of each platform must be greater than zero (that is, each platform must contain at least one block).  Example pedestal of n=11 blocks: second place height equals 4 blocks, first place height equals 5 blocks, third place height equals 2 blocks.Among all possible pedestals of n blocks, deduce one such that the platform height for the 1-st place minimum as possible. If there are several of them, output any of them." 800
1689E ANDfinity "bitmasks,brute force,constructive algorithms,dfs and similar,dsu,graphs" "Bit Lightyear, to the ANDfinity and beyond!After graduating from computer sciences, Vlad has been awarded an array a1,a2,\xe2\x80\xa6,an of n non-negative integers. As it is natural, he wanted to construct a graph consisting of n vertices, numbered 1,2,\xe2\x80\xa6,n. He decided to add an edge between i and j if and only if ai&aj>0, where & denotes the bitwise AND operation.Vlad also wants the graph to be connected, which might not be the case initially. In order to satisfy that, he can do the following two types of operations on the array:  Choose some element ai and increment it by 1.  Choose some element ai and decrement it by 1 (possible only if ai>0). It can be proven that there exists a finite sequence of operations such that the graph will be connected. So, can you please help Vlad find the minimum possible number of operations to do that and also provide the way how to do that?" 2500
1689D "Lena and Matrix" "data structures,dp,geometry,shortest paths" "Lena is a beautiful girl who likes logical puzzles.As a gift for her birthday, Lena got a matrix puzzle!The matrix consists of n rows and m columns, and each cell is either black or white. The coordinates (i,j) denote the cell which belongs to the i-th row and j-th column for every 1\xe2\x89\xa4i\xe2\x89\xa4n and 1\xe2\x89\xa4j\xe2\x89\xa4m. To solve the puzzle, Lena has to choose a cell that minimizes the Manhattan distance to the farthest black cell from the chosen cell.More formally, let there be k\xe2\x89\xa51 black cells in the matrix with coordinates (xi,yi) for every 1\xe2\x89\xa4i\xe2\x89\xa4k. Lena should choose a cell (a,b) that minimizes kmaxi=1(|a\xe2\x88\x92xi|+|b\xe2\x88\x92yi|).As Lena has no skill, she asked you for help. Will you tell her the optimal cell to choose?" 1900
1689C "Infected Tree" "dfs and similar,dp,trees" "Byteland is a beautiful land known because of its beautiful trees.Misha has found a binary tree with n vertices, numbered from 1 to n. A binary tree is an acyclic connected bidirectional graph containing n vertices and n\xe2\x88\x921 edges. Each vertex has a degree at most 3, whereas the root is the vertex with the number 1 and it has a degree at most 2.Unfortunately, the root got infected.The following process happens n times:  Misha either chooses a non-infected (and not deleted) vertex and deletes it with all edges which have an end in this vertex or just does nothing.  Then, the infection spreads to each vertex that is connected by an edge to an already infected vertex (all already infected vertices remain infected). As Misha does not have much time to think, please tell him what is the maximum number of vertices he can save from the infection (note that deleted vertices are not counted as saved)." 1600
1689B "Mystic Permutation" "data structures,greedy" "Monocarp is a little boy who lives in Byteland and he loves programming.Recently, he found a permutation of length n. He has to come up with a mystic permutation. It has to be a new permutation such that it differs from the old one in each position.More formally, if the old permutation is p1,p2,\xe2\x80\xa6,pn and the new one is q1,q2,\xe2\x80\xa6,qn it must hold that p1\xe2\x89\xa0q1,p2\xe2\x89\xa0q2,\xe2\x80\xa6,pn\xe2\x89\xa0qn.Monocarp is afraid of lexicographically large permutations. Can you please help him to find the lexicographically minimal mystic permutation?" 900
1689A "Lex String" "brute force,greedy,implementation,sortings,two pointers" "Kuznecov likes art, poetry, and music. And strings consisting of lowercase English letters.Recently, Kuznecov has found two strings, a and b, of lengths n and m respectively. They consist of lowercase English letters and no character is contained in both strings. Let another string c be initially empty. Kuznecov can do the following two types of operations:  Choose any character from the string a, remove it from a, and add it to the end of c.  Choose any character from the string b, remove it from b, and add it to the end of c. But, he can not do more than k operations of the same type in a row. He must perform operations until either a or b becomes empty. What is the lexicographically smallest possible value of c after he finishes?A string x is lexicographically smaller than a string y if and only if one of the following holds: x is a prefix of y, but x\xe2\x89\xa0y;  in the first position where x and y differ, the string x has a letter that appears earlier in the alphabet than the corresponding letter in y." 800
1688C "Manipulating History" "constructive algorithms,greedy,strings" "As a human, she can erase history of its entirety. As a Bai Ze (Hakutaku), she can create history out of nothingness.\xe2\x80\x94Perfect Memento in Strict SenseKeine has the ability to manipulate history. The history of Gensokyo is a string s of length 1 initially. To fix the chaos caused by Yukari, she needs to do the following operations n times, for the i-th time:  She chooses a non-empty substring t2i\xe2\x88\x921 of s. She replaces t2i\xe2\x88\x921 with a non-empty string, t2i. Note that the lengths of strings t2i\xe2\x88\x921 and t2i can be different.Note that if t2i\xe2\x88\x921 occurs more than once in s, exactly one of them will be replaced.For example, let s=""marisa"", t2i\xe2\x88\x921=""a"", and t2i=""z"". After the operation, s becomes ""mzrisa"" or ""marisz"".After n operations, Keine got the final string and an operation sequence t of length 2n. Just as Keine thinks she has finished, Yukari appears again and shuffles the order of t. Worse still, Keine forgets the initial history. Help Keine find the initial history of Gensokyo!Recall that a substring is a sequence of consecutive characters of the string. For example, for string ""abc"" its substrings are: ""ab"", ""c"", ""bc"" and some others. But the following strings are not its substring: ""ac"", ""cba"", ""acb"".HacksYou cannot make hacks in this problem." 1700
1688B "Patchouli\'s Magical Talisman" "bitmasks,constructive algorithms,greedy,sortings" "She is skilled in all kinds of magics, and is keen on inventing new one.\xe2\x80\x94Perfect Memento in Strict SensePatchouli is making a magical talisman. She initially has n magical tokens. Their magical power can be represented with positive integers a1,a2,\xe2\x80\xa6,an. Patchouli may perform the following two operations on the tokens.  Fusion: Patchouli chooses two tokens, removes them, and creates a new token with magical power equal to the sum of the two chosen tokens.  Reduction: Patchouli chooses a token with an even value of magical power x, removes it and creates a new token with magical power equal to x2. Tokens are more effective when their magical powers are odd values. Please help Patchouli to find the minimum number of operations she needs to make magical powers of all tokens odd values." 800
1688A "Cirno\'s Perfect Bitmasks Classroom" "bitmasks,brute force" "Even if it\'s a really easy question, she won\'t be able to answer it\xe2\x80\x94 Perfect Memento in Strict SenseCirno\'s perfect bitmasks classroom has just started!Cirno gave her students a positive integer x. As an assignment, her students need to find the minimum positive integer y, which satisfies the following two conditions:x and y>0 x xor y>0Where and is the bitwise AND operation, and xor is the bitwise XOR operation.Among the students was Mystia, who was truly baffled by all these new operators. Please help her!" 800
1687F "Koishi\'s Unconscious Permutation" fft,math "As she closed the Satori\'s eye that could read minds, Koishi gained the ability to live in unconsciousness. Even she herself does not know what she is up to.\xe2\x80\x94 Subterranean AnimismKoishi is unconsciously permuting n numbers: 1,2,\xe2\x80\xa6,n.She thinks the permutation p is beautiful if s=n\xe2\x88\x921\xe2\x88\x91i=1[pi+1=pi+1]. [x] equals to 1 if x holds, or 0 otherwise.For each k\xe2\x88\x88[0,n\xe2\x88\x921], she wants to know the number of beautiful permutations of length n satisfying k=n\xe2\x88\x921\xe2\x88\x91i=1[pi<pi+1]." 3500
1687E "Become Big For Me" "combinatorics,constructive algorithms,greedy,math,number theory" "Come, let\'s build a world where even the weak are not forgotten!\xe2\x80\x94Kijin Seija, Double Dealing CharactersShinmyoumaru has a mallet that can turn objects bigger or smaller. She is testing it out on a sequence a and a number v whose initial value is 1. She wants to make v=gcdi\xe2\x89\xa0j{ai\xe2\x8b\x85aj} by no more than 105 operations (gcdi\xe2\x89\xa0j{ai\xe2\x8b\x85aj} denotes the gcd of all products of two distinct elements of the sequence a). In each operation, she picks a subsequence b of a, and does one of the followings:   Enlarge: v=v\xe2\x8b\x85lcm(b)  Reduce: v=vlcm(b) Note that she does not need to guarantee that v is an integer, that is, v does not need to be a multiple of lcm(b) when performing Reduce.Moreover, she wants to guarantee that the total length of b chosen over the operations does not exceed 106. Fine a possible operation sequence for her. You don\'t need to minimize anything." 3500
1687D "Cute number" "binary search,brute force,data structures,dsu,implementation,math" "Ran is especially skilled in computation and mathematics. It is said that she can do unimaginable calculation work in an instant.\xe2\x80\x94Perfect Memento in Strict SenseRan Yakumo is a cute girl who loves creating cute Maths problems.Let f(x) be the minimal square number strictly greater than x, and g(x) be the maximal square number less than or equal to x. For example, f(1)=f(2)=g(4)=g(8)=4.A positive integer x is cute if x\xe2\x88\x92g(x)<f(x)\xe2\x88\x92x. For example, 1,5,11 are cute integers, while 3,8,15 are not. Ran gives you an array a of length n. She wants you to find the smallest non-negative integer k such that ai+k is a cute number for any element of a." 2900
1687C "Sanae and Giant Robot" "binary search,brute force,data structures,dsu,greedy,sortings" "Is it really?! The robot only existing in my imagination?! The Colossal Walking Robot?!!\xe2\x80\x94 Kochiya Sanae Sanae made a giant robot \xe2\x80\x94 Hisoutensoku, but something is wrong with it. To make matters worse, Sanae can not figure out how to stop it, and she is forced to fix it on-the-fly.The state of a robot can be represented by an array of integers of length n. Initially, the robot is at state a. She wishes to turn it into state b. As a great programmer, Sanae knows the art of copy-and-paste. In one operation, she can choose some segment from given segments, copy the segment from b and paste it into the same place of the robot, replacing the original state there. However, she has to ensure that the sum of a does not change after each copy operation in case the robot go haywire. Formally, Sanae can choose segment [l,r] and assign ai=bi (l\xe2\x89\xa4i\xe2\x89\xa4r) if n\xe2\x88\x91i=1ai does not change after the operation.Determine whether it is possible for Sanae to successfully turn the robot from the initial state a to the desired state b with any (possibly, zero) operations." 2500
1687B "Railway System" "constructive algorithms,graphs,greedy,interactive,sortings" "As for the technology in the outside world, it is really too advanced for Gensokyo to even look up to.\xe2\x80\x94Yasaka Kanako, Symposium of Post-mysticismThis is an interactive problem.Under the direct supervision of Kanako and the Moriya Shrine, the railway system of Gensokyo is finally finished. GSKR (Gensokyo Railways) consists of n stations with m bidirectional tracks connecting them. The i-th track has length li (1\xe2\x89\xa4li\xe2\x89\xa4106). Due to budget limits, the railway system may not be connected, though there may be more than one track between two stations.The value of a railway system is defined as the total length of its all tracks. The maximum (or minimum) capacity of a railway system is defined as the maximum (or minimum) value among all of the currently functional system\'s full spanning forest.In brief, full spanning forest of a graph is a spanning forest with the same connectivity as the given graph.Kanako has a simulator only able to process no more than 2m queries. The input of the simulator is a string s of length m, consisting of characters 0 and/or 1. The simulator will assume the i-th track functional if si= 1. The device will then tell Kanako the maximum capacity of the system in the simulated state.Kanako wants to know the the minimum capacity of the system with all tracks functional with the help of the simulator.The structure of the railway system is fixed in advance. In other words, the interactor is not adaptive." 1700
1687A "The Enchanted Forest" "brute force,greedy" "The enchanted forest got its name from the magical mushrooms growing here. They may cause illusions and generally should not be approached.\xe2\x80\x94Perfect Memento in Strict SenseMarisa comes to pick mushrooms in the Enchanted Forest. The Enchanted forest can be represented by n points on the X-axis numbered 1 through n. Before Marisa started, her friend, Patchouli, used magic to detect the initial number of mushroom on each point, represented by a1,a2,\xe2\x80\xa6,an.Marisa can start out at any point in the forest on minute 0. Each minute, the followings happen in order:  She moves from point x to y (|x\xe2\x88\x92y|\xe2\x89\xa41, possibly y=x).  She collects all mushrooms on point y.  A new mushroom appears on each point in the forest. Note that she cannot collect mushrooms on minute 0.Now, Marisa wants to know the maximum number of mushrooms she can pick after k minutes." 1600
1686B "Odd Subarrays" dp,greedy "For an array [b1,b2,\xe2\x80\xa6,bm][b1,b2,\xe2\x80\xa6,bm] define its number of inversions as the number of pairs (i,j)(i,j) of integers such that 1\xe2\x89\xa4i<j\xe2\x89\xa4m1\xe2\x89\xa4i<j\xe2\x89\xa4m and bi>bjbi>bj. Let\'s call array bb odd if its number of inversions is odd. For example, array [4,2,7][4,2,7] is odd, as its number of inversions is 11, while array [2,1,4,3][2,1,4,3] isn\'t, as its number of inversions is 22.You are given a permutation [p1,p2,\xe2\x80\xa6,pn][p1,p2,\xe2\x80\xa6,pn] of integers from 11 to nn (each of them appears exactly once in the permutation). You want to split it into several consecutive subarrays (maybe just one), so that the number of the odd subarrays among them is as large as possible. What largest number of these subarrays may be odd?" 800
1686A "Everything Everywhere All But One" greedy "You are given an array of n integers a1,a2,\xe2\x80\xa6,an. After you watched the amazing film ""Everything Everywhere All At Once"", you came up with the following operation.In one operation, you choose n\xe2\x88\x921 elements of the array and replace each of them with their arithmetic mean (which doesn\'t have to be an integer). For example, from the array [1,2,3,1] we can get the array [2,2,2,1], if we choose the first three elements, or we can get the array [43,43,3,43], if we choose all elements except the third.Is it possible to make all elements of the array equal by performing a finite number of such operations?" 800
1685E "The Ultimate LIS Problem" "data structures,greedy" "It turns out that this is exactly the 100-th problem of mine that appears in some programming competition. So it has to be special! And what can be more special than another problem about LIS...You are given a permutation p1,p2,\xe2\x80\xa6,p2n+1 of integers from 1 to 2n+1. You will have to process q updates, where the i-th update consists in swapping pui,pvi.After each update, find any cyclic shift of p with LIS\xe2\x89\xa4n, or determine that there is no such shift. (Refer to the output section for details).Here LIS(a) denotes the length of longest strictly increasing subsequence of a.Hacks are disabled in this problem. Don\'t ask why." 3500
1685D2 "Permutation Weight (Hard Version)" "constructive algorithms,greedy" "This is a hard version of the problem. The difference between the easy and hard versions is that in this version, you have to output the lexicographically smallest permutation with the smallest weight.You are given a permutation p1,p2,\xe2\x80\xa6,pn of integers from 1 to n.Let\'s define the weight of the permutation q1,q2,\xe2\x80\xa6,qn of integers from 1 to n as |q1\xe2\x88\x92pq2|+|q2\xe2\x88\x92pq3|+\xe2\x80\xa6+|qn\xe2\x88\x921\xe2\x88\x92pqn|+|qn\xe2\x88\x92pq1|You want your permutation to be as lightweight as possible. Among the permutations q with the smallest possible weight, find the lexicographically smallest.Permutation a1,a2,\xe2\x80\xa6,an is lexicographically smaller than permutation b1,b2,\xe2\x80\xa6,bn, if there exists some 1\xe2\x89\xa4i\xe2\x89\xa4n such that aj=bj for all 1\xe2\x89\xa4j<i and ai<bi." 3500
1685D1 "Permutation Weight (Easy Version)" "constructive algorithms,dfs and similar,dsu" "This is an easy version of the problem. The difference between the easy and hard versions is that in this version, you can output any permutation with the smallest weight.You are given a permutation p1,p2,\xe2\x80\xa6,pn of integers from 1 to n.Let\'s define the weight of the permutation q1,q2,\xe2\x80\xa6,qn of integers from 1 to n as |q1\xe2\x88\x92pq2|+|q2\xe2\x88\x92pq3|+\xe2\x80\xa6+|qn\xe2\x88\x921\xe2\x88\x92pqn|+|qn\xe2\x88\x92pq1|You want your permutation to be as lightweight as possible. Find any permutation q with the smallest possible weight." 2800
1685C "Bring Balance" "brute force,constructive algorithms,greedy" "Alina has a bracket sequence s of length 2n, consisting of n opening brackets \'(\' and n closing brackets \')\'. As she likes balance, she wants to turn this bracket sequence into a balanced bracket sequence.In one operation, she can reverse any substring of s.What\'s the smallest number of operations that she needs to turn s into a balanced bracket sequence? It can be shown that it\'s always possible in at most n operations.As a reminder, a sequence of brackets is called balanced if one can turn it into a valid math expression by adding characters + and 1. For example, sequences (())(), (), and (()(())) are balanced, while )(, ((), and (()))( are not." 2600
1685B Linguistics greedy,implementation,sortings,strings "Alina has discovered a weird language, which contains only 4 words: A, B, AB, BA. It also turned out that there are no spaces in this language: a sentence is written by just concatenating its words into a single string.Alina has found one such sentence s and she is curious: is it possible that it consists of precisely a words A, b words B, c words AB, and d words BA?In other words, determine, if it\'s possible to concatenate these a+b+c+d words in some order so that the resulting string is s. Each of the a+b+c+d words must be used exactly once in the concatenation, but you can choose the order in which they are concatenated." 2000
1685A "Circular Local MiniMax" "constructive algorithms,greedy,sortings" "You are given n integers a1,a2,\xe2\x80\xa6,an. Is it possible to arrange them on a circle so that each number is strictly greater than both its neighbors or strictly smaller than both its neighbors?In other words, check if there exists a rearrangement b1,b2,\xe2\x80\xa6,bn of the integers a1,a2,\xe2\x80\xa6,an such that for each i from 1 to n at least one of the following conditions holds: bi\xe2\x88\x921<bi>bi+1 bi\xe2\x88\x921>bi<bi+1To make sense of the previous formulas for i=1 and i=n, one shall define b0=bn and bn+1=b1." 1100
1684H "Hard Cut" "constructive algorithms,dfs and similar,divide and conquer,math" "You are given a binary string s. You have to cut it into any number of non-intersecting substrings, so that the sum of binary integers denoted by these substrings is a power of 2. Each element of s should be in exactly one substring." 3400
1684G "Euclid Guess" "constructive algorithms,flows,graph matchings,math,number theory" "Let\'s consider Euclid\'s algorithm for finding the greatest common divisor, where t is a list:function Euclid(a, b):    if a < b:        swap(a, b)    if b == 0:        return a    r = reminder from dividing a by b    if r > 0:        append r to the back of t    return Euclid(b, r)There is an array p of pairs of positive integers that are not greater than m. Initially, the list t is empty. Then the function is run on each pair in p. After that the list t is shuffled and given to you.You have to find an array p of any size not greater than 2\xe2\x8b\x85104 that produces the given list t, or tell that no such array exists." 2800
1684F "Diverse Segments" "data structures,two pointers" "You are given an array a of n integers. Also you are given m subsegments of that array. The left and the right endpoints of the j-th segment are lj and rj respectively.You are allowed to make no more than one operation. In that operation you choose any subsegment of the array a and replace each value on this segment with any integer (you are also allowed to keep elements the same).You have to apply this operation so that for the given m segments, the elements on each segment are distinct. More formally, for each 1\xe2\x89\xa4j\xe2\x89\xa4m all elements alj,alj+1,\xe2\x80\xa6,arj\xe2\x88\x921,arj should be distinct.You don\'t want to use the operation on a big segment, so you have to find the smallest length of a segment, so that you can apply the operation to this segment and meet the above-mentioned conditions. If it is not needed to use this operation, the answer is 0." 2600
1684E "MEX vs DIFF" "binary search,brute force,constructive algorithms,data structures,greedy,two pointers" "You are given an array a of n non-negative integers. In one operation you can change any number in the array to any other non-negative integer.Let\'s define the cost of the array as DIFF(a)\xe2\x88\x92MEX(a), where MEX of a set of non-negative integers is the smallest non-negative integer not present in the set, and DIFF is the number of different numbers in the array.For example, MEX({1,2,3})=0, MEX({0,1,2,4,5})=3.You should find the minimal cost of the array a if you are allowed to make at most k operations." 2100
1684D Traps "constructive algorithms,greedy,sortings" "There are n traps numbered from 1 to n. You will go through them one by one in order. The i-th trap deals ai base damage to you.Instead of going through a trap, you can jump it over. You can jump over no more than k traps. If you jump over a trap, it does not deal any damage to you. But there is an additional rule: if you jump over a trap, all next traps damages increase by 1 (this is a bonus damage).Note that if you jump over a trap, you don\'t get any damage (neither base damage nor bonus damage). Also, the bonus damage stacks so, for example, if you go through a trap i with base damage ai, and you have already jumped over 3 traps, you get (ai+3) damage.You have to find the minimal damage that it is possible to get if you are allowed to jump over no more than k traps." 1700
1684C "Column Swapping" "brute force,constructive algorithms,greedy,implementation,sortings" "You are given a grid with n rows and m columns, where each cell has a positive integer written on it. Let\'s call a grid good, if in each row the sequence of numbers is sorted in a non-decreasing order. It means, that for each 1\xe2\x89\xa4i\xe2\x89\xa4n and 2\xe2\x89\xa4j\xe2\x89\xa4m the following holds: ai,j\xe2\x89\xa5ai,j\xe2\x88\x921.You have to to do the following operation exactly once: choose two columns with indexes i and j (not necessarily different), 1\xe2\x89\xa4i,j\xe2\x89\xa4m, and swap them.You are asked to determine whether it is possible to make the grid good after the swap and, if it is, find the columns that need to be swapped." 1400
1684B "Z mod X = C" "constructive algorithms,math" "You are given three positive integers a, b, c (a<b<c). You have to find three positive integers x, y, z such that:xmody=a, ymodz=b, zmodx=c.Here pmodq denotes the remainder from dividing p by q. It is possible to show that for such constraints the answer always exists." 800
1684A "Digit Minimization" "constructive algorithms,games,math,strings" "There is an integer n without zeros in its decimal representation. Alice and Bob are playing a game with this integer. Alice starts first. They play the game in turns.On her turn, Alice must swap any two digits of the integer that are on different positions. Bob on his turn always removes the last digit of the integer. The game ends when there is only one digit left.You have to find the smallest integer Alice can get in the end, if she plays optimally." 800
1682F MCMF? "data structures,flows,graphs,greedy,sortings,two pointers" "You are given two integer arrays a and b (bi\xe2\x89\xa00 and |bi|\xe2\x89\xa4109). Array a is sorted in non-decreasing order.The cost of a subarray a[l:r] is defined as follows:If r\xe2\x88\x91j=lbj\xe2\x89\xa00, then the cost is not defined.Otherwise: Construct a bipartite flow graph with r\xe2\x88\x92l+1 vertices, labeled from l to r, with all vertices having bi<0 on the left and those with bi>0 on right. For each i,j such that l\xe2\x89\xa4i,j\xe2\x89\xa4r, bi<0 and bj>0, draw an edge from i to j with infinite capacity and cost of unit flow as |ai\xe2\x88\x92aj|. Add two more vertices: source S and sink T. For each i such that l\xe2\x89\xa4i\xe2\x89\xa4r and bi<0, add an edge from S to i with cost 0 and capacity |bi|. For each i such that l\xe2\x89\xa4i\xe2\x89\xa4r and bi>0, add an edge from i to T with cost 0 and capacity |bi|. The cost of the subarray is then defined as the minimum cost of maximum flow from S to T.You are given q queries in the form of two integers l and r. You have to compute the cost of subarray a[l:r] for each query, modulo 109+7.If you don\'t know what the minimum cost of maximum flow means, read here." 2700
1682E "Unordered Swaps" "constructive algorithms,dfs and similar,graphs,greedy,math,sortings,trees" "Alice had a permutation p of numbers from 1 to n. Alice can swap a pair (x,y) which means swapping elements at positions x and y in p (i.e. swap px and py). Alice recently learned her first sorting algorithm, so she decided to sort her permutation in the minimum number of swaps possible. She wrote down all the swaps in the order in which she performed them to sort the permutation on a piece of paper. For example,  [(2,3),(1,3)] is a valid swap sequence by Alice for permutation p=[3,1,2] whereas [(1,3),(2,3)] is not because it doesn\'t sort the permutation. Note that we cannot sort the permutation in less than 2 swaps.  [(1,2),(2,3),(2,4),(2,3)] cannot be a sequence of swaps by Alice for p=[2,1,4,3] even if it sorts the permutation because p can be sorted in 2 swaps, for example using the sequence [(4,3),(1,2)]. Unfortunately, Bob shuffled the sequence of swaps written by Alice.You are given Alice\'s permutation p and the swaps performed by Alice in arbitrary order. Can you restore the correct sequence of swaps that sorts the permutation p? Since Alice wrote correct swaps before Bob shuffled them up, it is guaranteed that there exists some order of swaps that sorts the permutation." 2700
1682D "Circular Spanning Tree" "constructive algorithms,implementation,trees" "There are n nodes arranged in a circle numbered from 1 to n in the clockwise order. You are also given a binary string s of length n.Your task is to construct a tree on the given n nodes satisfying the two conditions below or report that there such tree does not exist:  For each node i (1\xe2\x89\xa4i\xe2\x89\xa4n), the degree of node is even if si=0 and odd if si=1.  No two edges of the tree intersect internally in the circle. The edges are allowed to intersect on the circumference.  Note that all edges are drawn as straight line segments. For example, edge (u,v) in the tree is drawn as a line segment connecting u and v on the circle.A tree on n nodes is a connected graph with n\xe2\x88\x921 edges." 2000
1682C "LIS or Reverse LIS?" "constructive algorithms,greedy,implementation,math" "You are given an array a of n positive integers. Let LIS(a) denote the length of longest strictly increasing subsequence of a. For example,  LIS([2,1_,1,3_]) = 2.  LIS([3_,5_,10_,20_]) = 4.  LIS([3,1_,2_,4_]) = 3.  We define array a\xe2\x80\xb2 as the array obtained after reversing the array a i.e. a\xe2\x80\xb2=[an,an\xe2\x88\x921,\xe2\x80\xa6,a1].The beauty of array a is defined as min(LIS(a),LIS(a\xe2\x80\xb2)).Your task is to determine the maximum possible beauty of the array a if you can rearrange the array a arbitrarily." 1400
1682B "AND Sorting" "bitmasks,constructive algorithms,sortings" "You are given a permutation p of integers from 0 to n\xe2\x88\x921 (each of them occurs exactly once). Initially, the permutation is not sorted (that is, pi>pi+1 for at least one 1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921). The permutation is called X-sortable for some non-negative integer X if it is possible to sort the permutation by performing the operation below some finite number of times:   Choose two indices i and j (1\xe2\x89\xa4i<j\xe2\x89\xa4n) such that pi&pj=X.  Swap pi and pj. Here & denotes the bitwise AND operation.Find the maximum value of X such that p is X-sortable. It can be shown that there always exists some value of X such that p is X-sortable." 1100
1682A "Palindromic Indices" greedy,strings "You are given a palindromic string s of length n.You have to count the number of indices i (1\xe2\x89\xa4i\xe2\x89\xa4n) such that the string after removing si from s still remains a palindrome. For example, consider s = ""aba""  If we remove s1 from s, the string becomes ""ba"" which is not a palindrome.  If we remove s2 from s, the string becomes ""aa"" which is a palindrome.  If we remove s3 from s, the string becomes ""ab"" which is not a palindrome. A palindrome is a string that reads the same backward as forward. For example, ""abba"", ""a"", ""fef"" are palindromes whereas ""codeforces"", ""acd"", ""xy"" are not." 800
1681F "Unique Occurrences" "data structures,dfs and similar,divide and conquer,dp,dsu,trees" "You are given a tree, consisting of n vertices. Each edge has an integer value written on it.Let f(v,u) be the number of values that appear exactly once on the edges of a simple path between vertices v and u.Calculate the sum of f(v,u) over all pairs of vertices v and u such that 1\xe2\x89\xa4v<u\xe2\x89\xa4n." 2300
1681E "Labyrinth Adventures" "data structures,dp,matrices,shortest paths" "You found a map of a weirdly shaped labyrinth. The map is a grid, consisting of n rows and n columns. The rows of the grid are numbered from 1 to n from bottom to top. The columns of the grid are numbered from 1 to n from left to right.The labyrinth has n layers. The first layer is the bottom left corner (cell (1,1)). The second layer consists of all cells that are in the grid and adjacent to the first layer by a side or a corner. The third layer consists of all cells that are in the grid and adjacent to the second layer by a side or a corner. And so on. The labyrinth with 5 layers, for example, is shaped as follows:   The layers are separated from one another with walls. However, there are doors in these walls.Each layer (except for layer n) has exactly two doors to the next layer. One door is placed on the top wall of the layer and another door is placed on the right wall of the layer. For each layer from 1 to n\xe2\x88\x921 you are given positions of these two doors. The doors can be passed in both directions: either from layer i to layer i+1 or from layer i+1 to layer i.If you are standing in some cell, you can move to an adjacent by a side cell if a wall doesn\'t block your move (e.g. you can\'t move to a cell in another layer if there is no door between the cells).Now you have m queries of sort: what\'s the minimum number of moves one has to make to go from cell (x1,y1) to cell (x2,y2)." 2600
1681D "Required Length" "brute force,dfs and similar,dp,hashing,shortest paths" "You are given two integer numbers, n and x. You may perform several operations with the integer x.Each operation you perform is the following one: choose any digit y that occurs in the decimal representation of x at least once, and replace x by x\xe2\x8b\x85y.You want to make the length of decimal representation of x (without leading zeroes) equal to n. What is the minimum number of operations required to do that?" 1700
1681C "Double Sort" implementation,sortings "You are given two arrays a and b, both consisting of n integers.In one move, you can choose two indices i and j (1\xe2\x89\xa4i,j\xe2\x89\xa4n; i\xe2\x89\xa0j) and swap ai with aj and bi with bj. You have to perform the swap in both arrays.You are allowed to perform at most 104 moves (possibly, zero). Can you make both arrays sorted in a non-decreasing order at the end? If you can, print any sequence of moves that makes both arrays sorted." 1200
1681B "Card Trick" implementation,math "Monocarp has just learned a new card trick, and can\'t wait to present it to you. He shows you the entire deck of n cards. You see that the values of cards from the topmost to the bottommost are integers a1,a2,\xe2\x80\xa6,an, and all values are different.Then he asks you to shuffle the deck m times. With the j-th shuffle, you should take bj topmost cards and move them under the remaining (n\xe2\x88\x92bj) cards without changing the order.And then, using some magic, Monocarp tells you the topmost card of the deck. However, you are not really buying that magic. You tell him that you know the topmost card yourself. Can you surprise Monocarp and tell him the topmost card before he shows it?" 800
1681A "Game with Cards" games,greedy "Alice and Bob play a game. Alice has n cards, the i-th of them has the integer ai written on it. Bob has m cards, the j-th of them has the integer bj written on it.On the first turn of the game, the first player chooses one of his/her cards and puts it on the table (plays it). On the second turn, the second player chooses one of his/her cards such that the integer on it is greater than the integer on the card played on the first turn, and plays it. On the third turn, the first player chooses one of his/her cards such that the integer on it is greater than the integer on the card played on the second turn, and plays it, and so on \xe2\x80\x94 the players take turns, and each player has to choose one of his/her cards with greater integer than the card played by the other player on the last turn.If some player cannot make a turn, he/she loses.For example, if Alice has 4 cards with numbers [10,5,3,8], and Bob has 3 cards with numbers [6,11,6], the game may go as follows:  Alice can choose any of her cards. She chooses the card with integer 5 and plays it.  Bob can choose any of his cards with number greater than 5. He chooses a card with integer 6 and plays it.  Alice can choose any of her cards with number greater than 6. She chooses the card with integer 10 and plays it.  Bob can choose any of his cards with number greater than 10. He chooses a card with integer 11 and plays it.  Alice can choose any of her cards with number greater than 11, but she has no such cards, so she loses. Both Alice and Bob play optimally (if a player is able to win the game no matter how the other player plays, the former player will definitely win the game).You have to answer two questions:  who wins if Alice is the first player?  who wins if Bob is the first player?" 800
1680F "Lenient Vertex Cover" "dfs and similar,divide and conquer,dsu,graphs,trees" "You are given a simple connected undirected graph, consisting of n vertices and m edges. The vertices are numbered from 1 to n.A vertex cover of a graph is a set of vertices such that each edge has at least one of its endpoints in the set.Let\'s call a lenient vertex cover such a vertex cover that at most one edge in it has both endpoints in the set.Find a lenient vertex cover of a graph or report that there is none. If there are multiple answers, then print any of them." 2600
1680E "Moving Chips" bitmasks,dp,greedy "You are given a board of size 2\xc3\x97n (2 rows, n columns). Some cells of the board contain chips. The chip is represented as \'*\', and an empty space is represented as \'.\'. It is guaranteed that there is at least one chip on the board.In one move, you can choose any chip and move it to any adjacent (by side) cell of the board (if this cell is inside the board). It means that if the chip is in the first row, you can move it left, right or down (but it shouldn\'t leave the board). Same, if the chip is in the second row, you can move it left, right or up.If the chip moves to the cell with another chip, the chip in the destination cell disappears (i.\xe2\x80\x89e. our chip captures it).Your task is to calculate the minimum number of moves required to leave exactly one chip on the board.You have to answer t independent test cases." 2000
1680D "Dog Walking" "brute force,greedy,math" "You are walking with your dog, and now you are at the promenade. The promenade can be represented as an infinite line. Initially, you are in the point 0 with your dog. You decided to give some freedom to your dog, so you untied her and let her run for a while. Also, you watched what your dog is doing, so you have some writings about how she ran. During the i-th minute, the dog position changed from her previous position by the value ai (it means, that the dog ran for ai meters during the i-th minute). If ai is positive, the dog ran ai meters to the right, otherwise (if ai is negative) she ran ai meters to the left.During some minutes, you were chatting with your friend, so you don\'t have writings about your dog movement during these minutes. These values ai equal zero.You want your dog to return to you after the end of the walk, so the destination point of the dog after n minutes should be 0.Now you are wondering: what is the maximum possible number of different integer points of the line your dog could visit on her way, if you replace every 0 with some integer from \xe2\x88\x92k to k (and your dog should return to 0 after the walk)? The dog visits an integer point if she runs through that point or reaches in it at the end of any minute. Point 0 is always visited by the dog, since she is initially there.If the dog cannot return to the point 0 after n minutes regardless of the integers you place, print -1." 2400
1680C "Binary String" "binary search,greedy,strings,two pointers" "You are given a string s consisting of characters 0 and/or 1.You have to remove several (possibly zero) characters from the beginning of the string, and then several (possibly zero) characters from the end of the string. The string may become empty after the removals. The cost of the removal is the maximum of the following two values:  the number of characters 0 left in the string;  the number of characters 1 removed from the string. What is the minimum cost of removal you can achieve?" 1600
1680B Robots implementation "There is a field divided into n rows and m columns. Some cells are empty (denoted as E), other cells contain robots (denoted as R).You can send a command to all robots at the same time. The command can be of one of the four types:  move up;  move right;  move down;  move left. When you send a command, all robots at the same time attempt to take one step in the direction you picked. If a robot tries to move outside the field, it explodes; otherwise, every robot moves to an adjacent cell in the chosen direction.You can send as many commands as you want (possibly, zero), in any order. Your goal is to make at least one robot reach the upper left corner of the field. Can you do this without forcing any of the robots to explode?" 800
1680A "Minimums and Maximums" "brute force,math" "An array is beautiful if both of the following two conditions meet:  there are at least l1 and at most r1 elements in the array equal to its minimum;  there are at least l2 and at most r2 elements in the array equal to its maximum. For example, the array [2,3,2,4,4,3,2] has 3 elements equal to its minimum (1-st, 3-rd and 7-th) and 2 elements equal to its maximum (4-th and 5-th).Another example: the array [42,42,42] has 3 elements equal to its minimum and 3 elements equal to its maximum.Your task is to calculate the minimum possible number of elements in a beautiful array." 800
1679F "Formalism for Formalism" bitmasks,dp,math "Yura is a mathematician, and his cognition of the world is so absolute as if he have been solving formal problems a hundred of trillions of billions of years. This problem is just that!Consider all non-negative integers from the interval [0,10n). For convenience we complement all numbers with leading zeros in such way that each number from the given interval consists of exactly n decimal digits.You are given a set of pairs (ui,vi), where ui and vi are distinct decimal digits from 0 to 9.Consider a number x consisting of n digits. We will enumerate all digits from left to right and denote them as d1,d2,\xe2\x80\xa6,dn. In one operation you can swap digits di and di+1 if and only if there is a pair (uj,vj) in the set such that at least one of the following conditions is satisfied:  di=uj and di+1=vj,  di=vj and di+1=uj. We will call the numbers x and y, consisting of n digits, equivalent if the number x can be transformed into the number y using some number of operations described above. In particular, every number is considered equivalent to itself.You are given an integer n and a set of m pairs of digits (ui,vi). You have to find the maximum integer k such that there exists a set of integers x1,x2,\xe2\x80\xa6,xk (0\xe2\x89\xa4xi<10n) such that for each 1\xe2\x89\xa4i<j\xe2\x89\xa4k the number xi is not equivalent to the number xj." 2600
1679E "Typical Party in Dorm" bitmasks,combinatorics,dp,strings "Today is a holiday in the residence hall \xe2\x80\x94 Oleh arrived, in honor of which the girls gave him a string. Oleh liked the gift a lot, so he immediately thought up and offered you, his best friend, the following problem.You are given a string s of length n, which consists of the first 17 lowercase Latin letters {a, b, c, \xe2\x80\xa6, p, q} and question marks. And q queries. Each query is defined by a set of pairwise distinct lowercase first 17 letters of the Latin alphabet, which can be used to replace the question marks in the string s.The answer to the query is the sum of the number of distinct substrings that are palindromes over all strings that can be obtained from the original string s by replacing question marks with available characters. The answer must be calculated modulo 998244353.Pay attention! Two substrings are different when their start and end positions in the string are different. So, the number of different substrings that are palindromes for the string aba will be 4: a, b, a, aba.Consider examples of replacing question marks with letters. For example, from the string aba??ee when querying {a, b} you can get the strings ababaee or abaaaee but you cannot get the strings pizza,  abaee, abacaba, aba?fee, aba47ee, or abatree.Recall that a palindrome is a string that reads the same from left to right as from right to left." 2400
1679D "Toss a Coin to Your Graph..." "binary search,dfs and similar,dp,graphs" "One day Masha was walking in the park and found a graph under a tree... Surprised? Did you think that this problem would have some logical and reasoned story? No way! So, the problem...Masha has an oriented graph which i-th vertex contains some positive integer ai. Initially Masha can put a coin at some vertex. In one operation she can move a coin placed in some vertex u to any other vertex v such that there is an oriented edge u\xe2\x86\x92v in the graph. Each time when the coin is placed in some vertex i, Masha write down an integer ai in her notebook (in particular, when Masha initially puts a coin at some vertex, she writes an integer written at this vertex in her notebook). Masha wants to make exactly k\xe2\x88\x921 operations in such way that the maximum number written in her notebook is as small as possible." 1900
1679C "Rooks Defenders" "data structures,implementation" "You have a square chessboard of size n\xc3\x97n. Rows are numbered from top to bottom with numbers from 1 to n, and columns \xe2\x80\x94 from left to right with numbers from 1 to n. So, each cell is denoted with pair of integers (x,y) (1\xe2\x89\xa4x,y\xe2\x89\xa4n), where x is a row number and y is a column number.You have to perform q queries of three types:  Put a new rook in cell (x,y).  Remove a rook from cell (x,y). It\'s guaranteed that the rook was put in this cell before.  Check if each cell of subrectangle (x1,y1)\xe2\x88\x92(x2,y2) of the board is attacked by at least one rook. Subrectangle is a set of cells (x,y) such that for each cell two conditions are satisfied: x1\xe2\x89\xa4x\xe2\x89\xa4x2 and y1\xe2\x89\xa4y\xe2\x89\xa4y2.Recall that cell (a,b) is attacked by a rook placed in cell (c,d) if either a=c or b=d. In particular, the cell containing a rook is attacked by this rook." 1400
1679B "Stone Age Problem" "data structures,implementation" "Once upon a time Mike and Mike decided to come up with an outstanding problem for some stage of ROI (rare olympiad in informatics). One of them came up with a problem prototype but another stole the idea and proposed that problem for another stage of the same olympiad. Since then the first Mike has been waiting for an opportunity to propose the original idea for some other contest... Mike waited until this moment!You are given an array a of n integers. You are also given q queries of two types:  Replace i-th element in the array with integer x.  Replace each element in the array with integer x. After performing each query you have to calculate the sum of all elements in the array." 1200
1679A AvtoBus "brute force,greedy,math,number theory" "Spring has come, and the management of the AvtoBus bus fleet has given the order to replace winter tires with summer tires on all buses.You own a small bus service business and you have just received an order to replace n tires. You know that the bus fleet owns two types of buses: with two axles (these buses have 4 wheels) and with three axles (these buses have 6 wheels).You don\'t know how many buses of which type the AvtoBus bus fleet owns, so you wonder how many buses the fleet might have. You have to determine the minimum and the maximum number of buses that can be in the fleet if you know that the total number of wheels for all buses is n." 900
1678B2 "Tokitsukaze and Good 01-String (hard version)" dp,greedy,implementation "This is the hard version of the problem. The only difference between the two versions is that the harder version asks additionally for a minimum number of subsegments.Tokitsukaze has a binary string s of length n, consisting only of zeros and ones, n is even.Now Tokitsukaze divides s into the minimum number of contiguous subsegments, and for each subsegment, all bits in each subsegment are the same. After that, s is considered good if the lengths of all subsegments are even.For example, if s is ""11001111"", it will be divided into ""11"", ""00"" and ""1111"". Their lengths are 2, 2, 4 respectively, which are all even numbers, so ""11001111"" is good. Another example, if s is ""1110011000"", it will be divided into ""111"", ""00"", ""11"" and ""000"", and their lengths are 3, 2, 2, 3. Obviously, ""1110011000"" is not good.Tokitsukaze wants to make s good by changing the values of some positions in s. Specifically, she can perform the operation any number of times: change the value of si to \'0\' or \'1\' (1\xe2\x89\xa4i\xe2\x89\xa4n). Can you tell her the minimum number of operations to make s good? Meanwhile, she also wants to know the minimum number of subsegments that s can be divided into among all solutions with the minimum number of operations." 1800
1678B1 "Tokitsukaze and Good 01-String (easy version)" implementation "This is the easy version of the problem. The only difference between the two versions is that the harder version asks additionally for a minimum number of subsegments.Tokitsukaze has a binary string s of length n, consisting only of zeros and ones, n is even.Now Tokitsukaze divides s into the minimum number of contiguous subsegments, and for each subsegment, all bits in each subsegment are the same. After that, s is considered good if the lengths of all subsegments are even.For example, if s is ""11001111"", it will be divided into ""11"", ""00"" and ""1111"". Their lengths are 2, 2, 4 respectively, which are all even numbers, so ""11001111"" is good. Another example, if s is ""1110011000"", it will be divided into ""111"", ""00"", ""11"" and ""000"", and their lengths are 3, 2, 2, 3. Obviously, ""1110011000"" is not good.Tokitsukaze wants to make s good by changing the values of some positions in s. Specifically, she can perform the operation any number of times: change the value of si to \'0\' or \'1\'(1\xe2\x89\xa4i\xe2\x89\xa4n). Can you tell her the minimum number of operations to make s good?" 800
1678A "Tokitsukaze and All Zero Sequence" implementation "Tokitsukaze has a sequence a of length n. For each operation, she selects two numbers ai and aj (i\xe2\x89\xa0j; 1\xe2\x89\xa4i,j\xe2\x89\xa4n).   If ai=aj, change one of them to 0.  Otherwise change both of them to min(ai,aj). Tokitsukaze wants to know the minimum number of operations to change all numbers in the sequence to 0. It can be proved that the answer always exists." 800
1677F "Tokitsukaze and Gems" dp,math "Tokitsukaze has a sequence with length of n. She likes gems very much. There are n kinds of gems. The gems of the i-th kind are on the i-th position, and there are ai gems of the same kind on that position. Define G(l,r) as the multiset containing all gems on the segment [l,r] (inclusive).A multiset of gems can be represented as S=[s1,s2,\xe2\x80\xa6,sn], which is a non-negative integer sequence of length n and means that S contains si gems of the i-th kind in the multiset. A multiset T=[t1,t2,\xe2\x80\xa6,tn] is a multisubset of S=[s1,s2,\xe2\x80\xa6,sn] if and only if ti\xe2\x89\xa4si for any i satisfying 1\xe2\x89\xa4i\xe2\x89\xa4n.Now, given two positive integers k and p, you need to calculate the result ofn\xe2\x88\x91l=1n\xe2\x88\x91r=l\xe2\x88\x91[t1,t2,\xe2\x8b\xaf,tn]\xe2\x8a\x86G(l,r)((n\xe2\x88\x91i=1ptitki)(n\xe2\x88\x91i=1[ti>0])),where [ti>0]=1 if ti>0 and [ti>0]=0 if ti=0.Since the answer can be quite large, print it modulo 998244353." 3500
1677E "Tokitsukaze and Beautiful Subsegments" "data structures" "Tokitsukaze has a permutation p of length n.Let\'s call a segment [l,r] beautiful if there exist i and j satisfying pi\xe2\x8b\x85pj=max{pl,pl+1,\xe2\x80\xa6,pr}, where l\xe2\x89\xa4i<j\xe2\x89\xa4r.Now Tokitsukaze has q queries, in the i-th query she wants to know how many beautiful subsegments [x,y] there are in the segment [li,ri] (i. e. li\xe2\x89\xa4x\xe2\x89\xa4y\xe2\x89\xa4ri)." 2900
1677D "Tokitsukaze and Permutations" dp,math "Tokitsukaze has a permutation p. She performed the following operation to p exactly k times: in one operation, for each i from 1 to n\xe2\x88\x921 in order, if pi > pi+1, swap pi, pi+1. After exactly k times of operations, Tokitsukaze got a new sequence a, obviously the sequence a is also a permutation.After that, Tokitsukaze wrote down the value sequence v of a on paper. Denote the value sequence v of the permutation a of length n as vi=\xe2\x88\x91i\xe2\x88\x921j=1[ai<aj], where the value of [ai<aj] define as if ai<aj, the value is 1, otherwise is 0 (in other words, vi is equal to the number of elements greater than ai that are to the left of position i). Then Tokitsukaze went out to work.There are three naughty cats in Tokitsukaze\'s house. When she came home, she found the paper with the value sequence v to be bitten out by the cats, leaving several holes, so that the value of some positions could not be seen clearly. She forgot what the original permutation p was. She wants to know how many different permutations p there are, so that the value sequence v of the new permutation a after exactly k operations is the same as the v written on the paper (not taking into account the unclear positions).Since the answer may be too large, print it modulo 998244353." 2500
1677C "Tokitsukaze and Two Colorful Tapes" "constructive algorithms,dfs and similar,graphs,greedy" "Tokitsukaze has two colorful tapes. There are n distinct colors, numbered 1 through n, and each color appears exactly once on each of the two tapes. Denote the color of the i-th position of the first tape as cai, and the color of the i-th position of the second tape as cbi.Now Tokitsukaze wants to select each color an integer value from 1 to n, distinct for all the colors. After that she will put down the color values in each colored position on the tapes. Denote the number of the i-th position of the first tape as numai, and the number of the i-th position of the second tape as numbi.  For example, for the above picture, assuming that the color red has value x (1\xe2\x89\xa4x\xe2\x89\xa4n), it appears at the 1-st position of the first tape and the 3-rd position of the second tape, so numa1=numb3=x.Note that each color i from 1 to n should have a distinct value, and the same color which appears in both tapes has the same value. After labeling each color, the beauty of the two tapes is calculated as n\xe2\x88\x91i=1|numai\xe2\x88\x92numbi|.Please help Tokitsukaze to find the highest possible beauty." 1900
1677B "Tokitsukaze and Meeting" "data structures,implementation,math" "Tokitsukaze is arranging a meeting. There are n rows and m columns of seats in the meeting hall.There are exactly n\xe2\x8b\x85m students attending the meeting, including several naughty students and several serious students. The students are numerated from 1 to n\xe2\x8b\x85m. The students will enter the meeting hall in order. When the i-th student enters the meeting hall, he will sit in the 1-st column of the 1-st row, and the students who are already seated will move back one seat. Specifically, the student sitting in the j-th (1\xe2\x89\xa4j\xe2\x89\xa4m\xe2\x88\x921) column of the i-th row will move to the (j+1)-th column of the i-th row, and the student sitting in m-th column of the i-th row will move to the 1-st column of the (i+1)-th row.For example, there is a meeting hall with 2 rows and 2 columns of seats shown as below:  There will be 4 students entering the meeting hall in order, represented as a binary string ""1100"", of which \'0\' represents naughty students and \'1\' represents serious students. The changes of seats in the meeting hall are as follows:  Denote a row or a column good if and only if there is at least one serious student in this row or column. Please predict the number of good rows and columns just after the i-th student enters the meeting hall, for all i." 1700
1677A "Tokitsukaze and Strange Inequality" "brute force,data structures,dp" "Tokitsukaze has a permutation p of length n. Recall that a permutation p of length n is a sequence p1,p2,\xe2\x80\xa6,pn consisting of n distinct integers, each of which from 1 to n (1\xe2\x89\xa4pi\xe2\x89\xa4n).She wants to know how many different indices tuples [a,b,c,d] (1\xe2\x89\xa4a<b<c<d\xe2\x89\xa4n) in this permutation satisfy the following two inequalities: pa<pc and pb>pd. Note that two tuples [a1,b1,c1,d1] and [a2,b2,c2,d2] are considered to be different if a1\xe2\x89\xa0a2 or b1\xe2\x89\xa0b2 or c1\xe2\x89\xa0c2 or d1\xe2\x89\xa0d2." 1600
1676H2 "Maximum Crossings (Hard Version)" "data structures,divide and conquer,sortings" "The only difference between the two versions is that in this version n\xe2\x89\xa42\xe2\x8b\x85105 and the sum of n over all test cases does not exceed 2\xe2\x8b\x85105.A terminal is a row of n equal segments numbered 1 to n in order. There are two terminals, one above the other. You are given an array a of length n. For all i=1,2,\xe2\x80\xa6,n, there should be a straight wire from some point on segment i of the top terminal to some point on segment ai of the bottom terminal. You can\'t select the endpoints of a segment. For example, the following pictures show two possible wirings if n=7 and a=[4,1,4,6,7,7,5].  A crossing occurs when two wires share a point in common. In the picture above, crossings are circled in red.What is the maximum number of crossings there can be if you place the wires optimally?" 1500
1676H1 "Maximum Crossings (Easy Version)" "brute force" "The only difference between the two versions is that in this version n\xe2\x89\xa41000 and the sum of n over all test cases does not exceed 1000.A terminal is a row of n equal segments numbered 1 to n in order. There are two terminals, one above the other. You are given an array a of length n. For all i=1,2,\xe2\x80\xa6,n, there should be a straight wire from some point on segment i of the top terminal to some point on segment ai of the bottom terminal. You can\'t select the endpoints of a segment. For example, the following pictures show two possible wirings if n=7 and a=[4,1,4,6,7,7,5].  A crossing occurs when two wires share a point in common. In the picture above, crossings are circled in red.What is the maximum number of crossings there can be if you place the wires optimally?" 1400
1676G "White-Black Balanced Subtrees" "dfs and similar,dp,graphs,trees" "You are given a rooted tree consisting of n vertices numbered from 1 to n. The root is vertex 1. There is also a string s denoting the color of each vertex: if si=B, then vertex i is black, and if si=W, then vertex i is white.A subtree of the tree is called balanced if the number of white vertices equals the number of black vertices. Count the number of balanced subtrees.A tree is a connected undirected graph without cycles. A rooted tree is a tree with a selected vertex, which is called the root. In this problem, all trees have root 1.The tree is specified by an array of parents a2,\xe2\x80\xa6,an containing n\xe2\x88\x921 numbers: ai is the parent of the vertex with the number i for all i=2,\xe2\x80\xa6,n. The parent of a vertex u is a vertex that is the next vertex on a simple path from u to the root.The subtree of a vertex u is the set of all vertices that pass through u on a simple path to the root. For example, in the picture below, 7 is in the subtree of 3 because the simple path 7\xe2\x86\x925\xe2\x86\x923\xe2\x86\x921 passes through 3. Note that a vertex is included in its subtree, and the subtree of the root is the entire tree.  The picture shows the tree for n=7, a=[1,1,2,3,3,5], and s=WBBWWBW. The subtree at the vertex 3 is balanced." 1300
1676F "Longest Strike" "data structures,greedy,implementation,sortings,two pointers" "Given an array a of length n and an integer k, you are tasked to find any two numbers l and r (l\xe2\x89\xa4r) such that:   For each x (l\xe2\x89\xa4x\xe2\x89\xa4r), x appears in a at least k times (i.e. k or more array elements are equal to x).  The value r\xe2\x88\x92l is maximized. If no numbers satisfy the conditions, output -1.For example, if a=[11,11,12,13,13,14,14] and k=2, then:   for l=12, r=14 the first condition fails because 12 does not appear at least k=2 times.  for l=13, r=14 the first condition holds, because 13 occurs at least k=2 times in a and 14 occurs at least k=2 times in a.  for l=11, r=11 the first condition holds, because 11 occurs at least k=2 times in a. A pair of l and r for which the first condition holds and r\xe2\x88\x92l is maximal is l=13, r=14." 1300
1676E "Eating Queries" "binary search,greedy,sortings" "Timur has n candies. The i-th candy has a quantity of sugar equal to ai. So, by eating the i-th candy, Timur consumes a quantity of sugar equal to ai.Timur will ask you q queries regarding his candies. For the j-th query you have to answer what is the minimum number of candies he needs to eat in order to reach a quantity of sugar greater than or equal to xj or print -1 if it\'s not possible to obtain such a quantity. In other words, you should print the minimum possible k such that after eating k candies, Timur consumes a quantity of sugar of at least xj or say that no possible k exists.Note that he can\'t eat the same candy twice and queries are independent of each other (Timur can use the same candy in different queries)." 1100
1676D X-Sum "brute force,greedy,implementation" "Timur\'s grandfather gifted him a chessboard to practice his chess skills. This chessboard is a grid a with n rows and m columns with each cell having a non-negative integer written on it. Timur\'s challenge is to place a bishop on the board such that the sum of all cells attacked by the bishop is maximal. The bishop attacks in all directions diagonally, and there is no limit to the distance which the bishop can attack. Note that the cell on which the bishop is placed is also considered attacked. Help him find the maximal sum he can get." 1000
1676C "Most Similar Words" "brute force,greedy,implementation,implementation,math,strings" "You are given n words of equal length m, consisting of lowercase Latin alphabet letters. The i-th word is denoted si.In one move you can choose any position in any single word and change the letter at that position to the previous or next letter in alphabetical order. For example:  you can change \'e\' to \'d\' or to \'f\';  \'a\' can only be changed to \'b\';  \'z\' can only be changed to \'y\'. The difference between two words is the minimum number of moves required to make them equal. For example, the difference between ""best"" and ""cost"" is 1+10+0+0=11.Find the minimum difference of si and sj such that (i<j). In other words, find the minimum difference over all possible pairs of the n words." 800
1676B "Equal Candies" greedy,math,sortings "There are n boxes with different quantities of candies in each of them. The i-th box has ai candies inside.You also have n friends that you want to give the candies to, so you decided to give each friend a box of candies. But, you don\'t want any friends to get upset so you decided to eat some (possibly none) candies from each box so that all boxes have the same quantity of candies in them. Note that you may eat a different number of candies from different boxes and you cannot add candies to any of the boxes.What\'s the minimum total number of candies you have to eat to satisfy the requirements?" 800
1676A Lucky? implementation "A ticket is a string consisting of six digits. A ticket is considered lucky if the sum of the first three digits is equal to the sum of the last three digits. Given a ticket, output if it is lucky or not. Note that a ticket can have leading zeroes." 800
1675G "Sorting Pancakes" dp "Nastya baked m pancakes and spread them on n dishes. The dishes are in a row and numbered from left to right. She put ai pancakes on the dish with the index i.Seeing the dishes, Vlad decided to bring order to the stacks and move some pancakes. In one move, he can shift one pancake from any dish to the closest one, that is, select the dish i (ai>0) and do one of the following: if i>1, put the pancake on a dish with the previous index, after this move ai=ai\xe2\x88\x921 and ai\xe2\x88\x921=ai\xe2\x88\x921+1; if i<n, put the pancake on a dish with the following index, after this move ai=ai\xe2\x88\x921 and ai+1=ai+1+1.Vlad wants to make the array anon-increasing, after moving as few pancakes as possible. Help him find the minimum number of moves needed for this.The array a=[a1,a2,\xe2\x80\xa6,an] is called non-increasing if ai\xe2\x89\xa5ai+1 for all i from 1 to n\xe2\x88\x921." 2300
1675F "Vlad and Unfinished Business" "dfs and similar,dp,greedy,trees" "Vlad and Nastya live in a city consisting of n houses and n\xe2\x88\x921 road. From each house, you can get to the other by moving only along the roads. That is, the city is a tree.Vlad lives in a house with index x, and Nastya lives in a house with index y. Vlad decided to visit Nastya. However, he remembered that he had postponed for later k things that he has to do before coming to Nastya. To do the i-th thing, he needs to come to the ai-th house, things can be done in any order. In 1 minute, he can walk from one house to another if they are connected by a road.Vlad does not really like walking, so he is interested what is the minimum number of minutes he has to spend on the road to do all things and then come to Nastya. Houses a1,a2,\xe2\x80\xa6,ak he can visit in any order. He can visit any house multiple times (if he wants)." 1800
1675E "Replace With the Previous, Minimize" dsu,greedy,strings "You are given a string s of lowercase Latin letters. The following operation can be used:   select one character (from \'a\' to \'z\') that occurs at least once in the string. And replace all such characters in the string with the previous one in alphabetical order on the loop. For example, replace all \'c\' with \'b\' or replace all \'a\' with \'z\'. And you are given the integer k \xe2\x80\x94 the maximum number of operations that can be performed. Find the minimum lexicographically possible string that can be obtained by performing no more than k operations.The string a=a1a2\xe2\x80\xa6an is lexicographically smaller than the string b=b1b2\xe2\x80\xa6bn if there exists an index k (1\xe2\x89\xa4k\xe2\x89\xa4n) such that a1=b1, a2=b2, ..., ak\xe2\x88\x921=bk\xe2\x88\x921, but ak<bk." 1500
1675D "Vertical Paths" graphs,implementation,trees "You are given a rooted tree consisting of n vertices. Vertices are numbered from 1 to n. Any vertex can be the root of a tree.A tree is a connected undirected graph without cycles. A rooted tree is a tree with a selected vertex, which is called the root.The tree is specified by an array of parents p containing n numbers: pi is a parent of the vertex with the index i. The parent of a vertex u is a vertex that is the next vertex on the shortest path from u to the root. For example, on the simple path from 5 to 3 (the root), the next vertex would be 1, so the parent of 5 is 1.The root has no parent, so for it, the value of pi is i (the root is the only vertex for which pi=i).Find such a set of paths that:  each vertex belongs to exactly one path, each path can contain one or more vertices;  in each path each next vertex \xe2\x80\x94 is a son of the current vertex (that is, paths always lead down \xe2\x80\x94 from parent to son);  number of paths is minimal. For example, if n=5 and p=[3,1,3,3,1], then the tree can be divided into three paths:   3\xe2\x86\x921\xe2\x86\x925 (path of 3 vertices),  4 (path of 1 vertices).  2 (path of 1 vertices).   Example of splitting a root tree into three paths for n=5, the root of the tree \xe2\x80\x94 node 3." 1300
1675C "Detective Task" implementation "Polycarp bought a new expensive painting and decided to show it to his n friends. He hung it in his room. n of his friends entered and exited there one by one. At one moment there was no more than one person in the room. In other words, the first friend entered and left first, then the second, and so on.It is known that at the beginning (before visiting friends) a picture hung in the room. At the end (after the n-th friend) it turned out that it disappeared. At what exact moment it disappeared \xe2\x80\x94 there is no information.Polycarp asked his friends one by one. He asked each one if there was a picture when he entered the room. Each friend answered one of three:  no (response encoded with 0);  yes (response encoded as 1);  can\'t remember (response is encoded with ?). Everyone except the thief either doesn\'t remember or told the truth. The thief can say anything (any of the three options).Polycarp cannot understand who the thief is. He asks you to find out the number of those who can be considered a thief according to the answers." 1100
1675B "Make It Increasing" greedy,implementation "Given n integers a1,a2,\xe2\x80\xa6,an. You can perform the following operation on them:  select any element ai (1\xe2\x89\xa4i\xe2\x89\xa4n) and divide it by 2 (round down). In other words, you can replace any selected element ai with the value \xe2\x8c\x8aai2\xe2\x8c\x8b (where \xe2\x8c\x8ax\xe2\x8c\x8b is \xe2\x80\x93 round down the real number x). Output the minimum number of operations that must be done for a sequence of integers to become strictly increasing (that is, for the condition a1<a2<\xe2\x8b\xaf<an to be satisfied). Or determine that it is impossible to obtain such a sequence. Note that elements cannot be swapped. The only possible operation is described above.For example, let n=3 and a sequence of numbers [3,6,5] be given. Then it is enough to perform two operations on it:   Write the number \xe2\x8c\x8a62\xe2\x8c\x8b=3 instead of the number a2=6 and get the sequence [3,3,5];  Then replace a1=3 with \xe2\x8c\x8a32\xe2\x8c\x8b=1 and get the sequence [1,3,5]. The resulting sequence is strictly increasing because 1<3<5." 900
1675A "Food for Animals" greedy,math "In the pet store on sale there are:  a packs of dog food;  b packs of cat food;  c packs of universal food (such food is suitable for both dogs and cats). Polycarp has x dogs and y cats. Is it possible that he will be able to buy food for all his animals in the store? Each of his dogs and each of his cats should receive one pack of suitable food for it." 800
1674G "Remove Directed Edges" "dfs and similar,dp,graphs" "You are given a directed acyclic graph, consisting of n vertices and m edges. The vertices are numbered from 1 to n. There are no multiple edges and self-loops.Let inv be the number of incoming edges (indegree) and outv be the number of outgoing edges (outdegree) of vertex v.You are asked to remove some edges from the graph. Let the new degrees be in\xe2\x80\xb2v and out\xe2\x80\xb2v.You are only allowed to remove the edges if the following conditions hold for every vertex v:   in\xe2\x80\xb2v<inv or in\xe2\x80\xb2v=inv=0;  out\xe2\x80\xb2v<outv or out\xe2\x80\xb2v=outv=0. Let\'s call a set of vertices S cute if for each pair of vertices v and u (v\xe2\x89\xa0u) such that v\xe2\x88\x88S and u\xe2\x88\x88S, there exists a path either from v to u or from u to v over the non-removed edges.What is the maximum possible size of a cute set S after you remove some edges from the graph and both indegrees and outdegrees of all vertices either decrease or remain equal to 0?" 2000
1674F "Desktop Rearrangement" "data structures,greedy,implementation" "Your friend Ivan asked you to help him rearrange his desktop. The desktop can be represented as a rectangle matrix of size n\xc3\x97m consisting of characters \'.\' (empty cell of the desktop) and \'*\' (an icon).The desktop is called good if all its icons are occupying some prefix of full columns and, possibly, the prefix of the next column (and there are no icons outside this figure). In other words, some amount of first columns will be filled with icons and, possibly, some amount of first cells of the next (after the last full column) column will be also filled with icons (and all the icons on the desktop belong to this figure). This is pretty much the same as the real life icons arrangement.In one move, you can take one icon and move it to any empty cell in the desktop.Ivan loves to add some icons to his desktop and remove them from it, so he is asking you to answer q queries: what is the minimum number of moves required to make the desktop good after adding/removing one icon?Note that queries are permanent and change the state of the desktop." 1800
1674E "Breaking the Wall" "binary search,brute force,constructive algorithms,greedy,math" "Monocarp plays ""Rage of Empires II: Definitive Edition"" \xe2\x80\x94 a strategic computer game. Right now he\'s planning to attack his opponent in the game, but Monocarp\'s forces cannot enter the opponent\'s territory since the opponent has built a wall.The wall consists of n sections, aligned in a row. The i-th section initially has durability ai. If durability of some section becomes 0 or less, this section is considered broken.To attack the opponent, Monocarp needs to break at least two sections of the wall (any two sections: possibly adjacent, possibly not). To do this, he plans to use an onager \xe2\x80\x94 a special siege weapon. The onager can be used to shoot any section of the wall; the shot deals 2 damage to the target section and 1 damage to adjacent sections. In other words, if the onager shoots at the section x, then the durability of the section x decreases by 2, and the durability of the sections x\xe2\x88\x921 and x+1 (if they exist) decreases by 1 each. Monocarp can shoot at any sections any number of times, he can even shoot at broken sections.Monocarp wants to calculate the minimum number of onager shots needed to break at least two sections. Help him!" 2000
1674D "A-B-C Sort" "constructive algorithms,implementation,sortings" "You are given three arrays a, b and c. Initially, array a consists of n elements, arrays b and c are empty.You are performing the following algorithm that consists of two steps:   Step 1: while a is not empty, you take the last element from a and move it in the middle of array b. If b currently has odd length, you can choose: place the element from a to the left or to the right of the middle element of b. As a result, a becomes empty and b consists of n elements.  Step 2: while b is not empty, you take the middle element from b and move it to the end of array c. If b currently has even length, you can choose which of two middle elements to take. As a result, b becomes empty and c now consists of n elements.  Refer to the Note section for examples.Can you make array c sorted in non-decreasing order?" 1200
1674C "Infinite Replacement" combinatorics,implementation,strings "You are given a string s, consisting only of Latin letters \'a\', and a string t, consisting of lowercase Latin letters.In one move, you can replace any letter \'a\' in the string s with a string t. Note that after the replacement string s might contain letters other than \'a\'.You can perform an arbitrary number of moves (including zero). How many different strings can you obtain? Print the number, or report that it is infinitely large.Two strings are considered different if they have different length, or they differ at some index." 1000
1674B Dictionary combinatorics,math "The Berland language consists of words having exactly two letters. Moreover, the first letter of a word is different from the second letter. Any combination of two different Berland letters (which, by the way, are the same as the lowercase letters of Latin alphabet) is a correct word in Berland language.The Berland dictionary contains all words of this language. The words are listed in a way they are usually ordered in dictionaries. Formally, word a comes earlier than word b in the dictionary if one of the following conditions hold:  the first letter of a is less than the first letter of b;  the first letters of a and b are the same, and the second letter of a is less than the second letter of b. So, the dictionary looks like that:  Word 1: ab  Word 2: ac  ...  Word 25: az  Word 26: ba  Word 27: bc  ...  Word 649: zx  Word 650: zy You are given a word s from the Berland language. Your task is to find its index in the dictionary." 800
1674A "Number Transformation" "constructive algorithms,math" "You are given two integers x and y. You want to choose two strictly positive (greater than zero) integers a and b, and then apply the following operation to x exactly a times: replace x with b\xe2\x8b\x85x.You want to find two positive integers a and b such that x becomes equal to y after this process. If there are multiple possible pairs, you can choose any of them. If there is no such pair, report it.For example:   if x=3 and y=75, you may choose a=2 and b=5, so that x becomes equal to 3\xe2\x8b\x855\xe2\x8b\x855=75;  if x=100 and y=100, you may choose a=3 and b=1, so that x becomes equal to 100\xe2\x8b\x851\xe2\x8b\x851\xe2\x8b\x851=100;  if x=42 and y=13, there is no answer since you cannot decrease x with the given operations." 800
1673F "Anti-Theft Road Planning" "bitmasks,constructive algorithms,divide and conquer,greedy,interactive,math" "This is an interactive problem.A city has n2 buildings divided into a grid of n rows and n columns. You need to build a road of some length D(A,B) of your choice between each pair of adjacent by side buildings A and B. Due to budget limitations and legal restrictions, the length of each road must be a positive integer and the total length of all roads should not exceed 48000.There is a thief in the city who will start from the topmost, leftmost building (in the first row and the first column) and roam around the city, occasionally stealing artifacts from some of the buildings. He can move from one building to another adjacent building by travelling through the road which connects them.You are unable to track down what buildings he visits and what path he follows to reach them. But there is one tracking mechanism in the city. The tracker is capable of storing a single integer x which is initially 0. Each time the thief travels from a building A to another adjacent building B through a road of length D(A,B), the tracker changes x to x\xe2\x8a\x95D(A,B). Each time the thief steals from a building, the tracker reports the value x stored in it and resets it back to 0.It is known beforehand that the thief will steal in exactly k buildings but you will know the values returned by the tracker only after the thefts actually happen. Your task is to choose the lengths of roads in such a way that no matter what strategy or routes the thief follows, you will be able to exactly tell the location of all the buildings where the thefts occurred from the values returned by the tracker." 2400
1673E "Power or XOR?" "bitmasks,combinatorics,math,number theory" "The symbol \xe2\x88\xa7 is quite ambiguous, especially when used without context. Sometimes it is used to denote a power (a\xe2\x88\xa7b=ab) and sometimes it is used to denote the XOR operation (a\xe2\x88\xa7b=a\xe2\x8a\x95b). You have an ambiguous expression E=A1\xe2\x88\xa7A2\xe2\x88\xa7A3\xe2\x88\xa7\xe2\x80\xa6\xe2\x88\xa7An. You can replace each \xe2\x88\xa7 symbol with either a Power operation or a XOR operation to get an unambiguous expression E\xe2\x80\xb2.The value of this expression E\xe2\x80\xb2 is determined according to the following rules:   All Power operations are performed before any XOR operation. In other words, the Power operation takes precedence over XOR operation. For example, 4XOR6Power2=4\xe2\x8a\x95(62)=4\xe2\x8a\x9536=32.  Consecutive powers are calculated from left to right. For example, 2Power3Power4=(23)4=84=4096. You are given an array B of length n and an integer k. The array A is given by Ai=2Bi and the expression E is given by E=A1\xe2\x88\xa7A2\xe2\x88\xa7A3\xe2\x88\xa7\xe2\x80\xa6\xe2\x88\xa7An. You need to find the XOR of the values of all possible unambiguous expressions E\xe2\x80\xb2 which can be obtained from E and has at least k \xe2\x88\xa7 symbols used as XOR operation. Since the answer can be very large, you need to find it modulo 2220. Since this number can also be very large, you need to print its binary representation without leading zeroes. If the answer is equal to 0, print 0." 2500
1673D "Lost Arithmetic Progression" "combinatorics,math,number theory" "Long ago, you thought of two finite arithmetic progressions A and B. Then you found out another sequence C containing all elements common to both A and B. It is not hard to see that C is also a finite arithmetic progression. After many years, you forgot what A was but remember B and C. You are, for some reason, determined to find this lost arithmetic progression. Before you begin this eternal search, you want to know how many different finite arithmetic progressions exist which can be your lost progression A. Two arithmetic progressions are considered different if they differ in their first term, common difference or number of terms.It may be possible that there are infinitely many such progressions, in which case you won\'t even try to look for them! Print \xe2\x88\x921 in all such cases. Even if there are finite number of them, the answer might be very large. So, you are only interested to find the answer modulo 109+7." 1900
1673C "Palindrome Basis" "brute force,dp,math,number theory" "You are given a positive integer n. Let\'s call some positive integer a without leading zeroes palindromic if it remains the same after reversing the order of its digits. Find the number of distinct ways to express n as a sum of positive palindromic integers. Two ways are considered different if the frequency of at least one palindromic integer is different in them. For example, 5=4+1 and 5=3+1+1 are considered different but 5=3+1+1 and 5=1+3+1 are considered the same. Formally, you need to find the number of distinct multisets of positive palindromic integers the sum of which is equal to n.Since the answer can be quite large, print it modulo 109+7." 1500
1673B "A Perfectly Balanced String?" "brute force,greedy,strings" "Let\'s call a string s perfectly balanced if for all possible triplets (t,u,v) such that t is a non-empty substring of s and u and v are characters present in s, the difference between the frequencies of u and v in t is not more than 1.For example, the strings ""aba"" and ""abc"" are perfectly balanced but ""abb"" is not because for the triplet (""bb"",\'a\',\'b\'), the condition is not satisfied.You are given a string s consisting of lowercase English letters only. Your task is to determine whether s is perfectly balanced or not.A string b is called a substring of another string a if b can be obtained by deleting some characters (possibly 0) from the start and some characters (possibly 0) from the end of a." 1100
1673A "Subtle Substring Subtraction" games,greedy,strings "Alice and Bob are playing a game with strings. There will be t rounds in the game. In each round, there will be a string s consisting of lowercase English letters. Alice moves first and both the players take alternate turns. Alice is allowed to remove any substring of even length (possibly empty) and Bob is allowed to remove any substring of odd length from s.More formally, if there was a string s=s1s2\xe2\x80\xa6sk the player can choose a substring slsl+1\xe2\x80\xa6sr\xe2\x88\x921sr with length of corresponding parity and remove it. After that the string will become s=s1\xe2\x80\xa6sl\xe2\x88\x921sr+1\xe2\x80\xa6sk.After the string becomes empty, the round ends and each player calculates his/her score for this round. The score of a player is the sum of values of all characters removed by him/her. The value of a is 1, the value of b is 2, the value of c is 3, \xe2\x80\xa6, and the value of z is 26. The player with higher score wins the round. For each round, determine the winner and the difference between winner\'s and loser\'s scores. Assume that both players play optimally to maximize their score. It can be proved that a draw is impossible." 800
1672I PermutationForces "data structures,greedy" "You have a permutation p of integers from 1 to n.You have a strength of s and will perform the following operation some times:  Choose an index i such that 1\xe2\x89\xa4i\xe2\x89\xa4|p| and |i\xe2\x88\x92pi|\xe2\x89\xa4s.  For all j such that 1\xe2\x89\xa4j\xe2\x89\xa4|p| and pi<pj, update pj to pj\xe2\x88\x921.  Delete the i-th element from p. Formally, update p to [p1,\xe2\x80\xa6,pi\xe2\x88\x921,pi+1,\xe2\x80\xa6,pn]. It can be shown that no matter what i you have chosen, p will be a permutation of integers from 1 to |p| after all operations.You want to be able to transform p into the empty permutation. Find the minimum strength s that will allow you to do so." 3000
1672H "Zigu Zagu" "constructive algorithms,data structures,greedy" "You have a binary string a of length n consisting only of digits 0 and 1. You are given q queries. In the i-th query, you are given two indices l and r such that 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n. Let s=a[l,r]. You are allowed to do the following operation on s:  Choose two indices x and y such that 1\xe2\x89\xa4x\xe2\x89\xa4y\xe2\x89\xa4|s|. Let t be the substring t=s[x,y]. Then for all 1\xe2\x89\xa4i\xe2\x89\xa4|t|\xe2\x88\x921, the condition ti\xe2\x89\xa0ti+1 has to hold. Note that x=y is always a valid substring.  Delete the substring s[x,y] from s. For each of the q queries, find the minimum number of operations needed to make s an empty string.Note that for a string s, s[l,r] denotes the subsegment sl,sl+1,\xe2\x80\xa6,sr." 2700
1672G "Cross Xor" "constructive algorithms,graphs,math,matrices" "There is a grid with r rows and c columns, where the square on the i-th row and j-th column has an integer ai,j written on it. Initially, all elements are set to 0. We are allowed to do the following operation:  Choose indices 1\xe2\x89\xa4i\xe2\x89\xa4r and 1\xe2\x89\xa4j\xe2\x89\xa4c, then replace all values on the same row or column as (i,j) with the value xor 1. In other words, for all ax,y where x=i or y=j or both, replace ax,y with ax,y xor 1. You want to form grid b by doing the above operations a finite number of times. However, some elements of b are missing and are replaced with \'?\' instead.Let k be the number of \'?\' characters. Among all the 2k ways of filling up the grid b by replacing each \'?\' with \'0\' or \'1\', count the number of grids, that can be formed by doing the above operation a finite number of times, starting from the grid filled with 0. As this number can be large, output it modulo 998244353." 3200
1672F2 "Checker for Array Shuffling" "constructive algorithms,dfs and similar,graphs" "oolimry has an array a of length n which he really likes. Today, you have changed his array to b, a permutation of a, to make him sad.Because oolimry is only a duck, he can only perform the following operation to restore his array:   Choose two integers i,j such that 1\xe2\x89\xa4i,j\xe2\x89\xa4n.  Swap bi and bj. The sadness of the array b is the minimum number of operations needed to transform b into a.Given the arrays a and b, where b is a permutation of a, determine if b has the maximum sadness over all permutations of a." 2800
1672F1 "Array Shuffling" "constructive algorithms,graphs,greedy" "oolimry has an array a of length n which he really likes. Today, you have changed his array to b, a permutation of a, to make him sad.Because oolimry is only a duck, he can only perform the following operation to restore his array:   Choose two integers i,j such that 1\xe2\x89\xa4i,j\xe2\x89\xa4n.  Swap bi and bj. The sadness of the array b is the minimum number of operations needed to transform b into a.Given the array a, find any array b which is a permutation of a that has the maximum sadness over all permutations of the array a." 2000
1672E notepad.exe "binary search,constructive algorithms,greedy,interactive" "This is an interactive problem.There are n words in a text editor. The i-th word has length li (1\xe2\x89\xa4li\xe2\x89\xa42000). The array l is hidden and only known by the grader. The text editor displays words in lines, splitting each two words in a line with at least one space. Note that a line does not have to end with a space. Let the height of the text editor refer to the number of lines used. For the given width, the text editor will display words in such a way that the height is minimized.More formally, suppose that the text editor has width w. Let a be an array of length k+1 where 1=a1<a2<\xe2\x80\xa6<ak+1=n+1. a is a valid array if for all 1\xe2\x89\xa4i\xe2\x89\xa4k, lai+1+lai+1+1+\xe2\x80\xa6+1+lai+1\xe2\x88\x921\xe2\x89\xa4w. Then the height of the text editor is the minimum k over all valid arrays.Note that if w<max(li), the text editor cannot display all the words properly and will crash, and the height of the text editor will be 0 instead.You can ask n+30 queries. In one query, you provide a width w. Then, the grader will return the height hw of the text editor when its width is w.Find the minimum area of the text editor, which is the minimum value of w\xe2\x8b\x85hw over all w for which hw\xe2\x89\xa00.The lengths are fixed in advance. In other words, the interactor is not adaptive." 2200
1672D "Cyclic Rotation" "constructive algorithms,greedy,implementation,two pointers" "There is an array a of length n. You may perform the following operation any number of times:  Choose two indices l and r where 1\xe2\x89\xa4l<r\xe2\x89\xa4n and al=ar. Then, set a[l\xe2\x80\xa6r]=[al+1,al+2,\xe2\x80\xa6,ar,al]. You are also given another array b of length n which is a permutation of a. Determine whether it is possible to transform array a into an array b using the above operation some number of times." 1700
1672C "Unequal Array" "constructive algorithms,greedy,implementation" "You are given an array a of length n. We define the equality of the array as the number of indices 1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921 such that ai=ai+1. We are allowed to do the following operation:  Select two integers i and x such that 1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921 and 1\xe2\x89\xa4x\xe2\x89\xa4109. Then, set ai and ai+1 to be equal to x. Find the minimum number of operations needed such that the equality of the array is less than or equal to 1." 1100
1672B "I love AAAB" "constructive algorithms,implementation" "Let\'s call a string good if its length is at least 2 and all of its characters are A except for the last character which is B. The good strings are AB,AAB,AAAB,\xe2\x80\xa6. Note that B is not a good string.You are given an initially empty string s1.You can perform the following operation any number of times:   Choose any position of s1 and insert some good string in that position. Given a string s2, can we turn s1 into s2 after some number of operations?" 800
1672A "Log Chopping" games,implementation,math "There are n logs, the i-th log has a length of ai meters. Since chopping logs is tiring work, errorgorn and maomao90 have decided to play a game.errorgorn and maomao90 will take turns chopping the logs with errorgorn chopping first. On his turn, the player will pick a log and chop it into 2 pieces. If the length of the chosen log is x, and the lengths of the resulting pieces are y and z, then y and z have to be positive integers, and x=y+z must hold. For example, you can chop a log of length 3 into logs of lengths 2 and 1, but not into logs of lengths 3 and 0, 2 and 2, or 1.5 and 1.5.The player who is unable to make a chop will be the loser. Assuming that both errorgorn and maomao90 play optimally, who will be the winner?" 800
1671F "Permutation Counting" "brute force,combinatorics,dp,fft,math" "Calculate the number of permutations p of size n with exactly k inversions (pairs of indices (i,j) such that i<j and pi>pj) and exactly x indices i such that pi>pi+1.Yep, that\'s the whole problem. Good luck!" 2700
1671E Preorder "combinatorics,divide and conquer,dp,dsu,hashing,sortings,trees" "You are given a rooted tree of 2n\xe2\x88\x921 vertices. Every vertex of this tree has either 0 children, or 2 children. All leaves of this tree have the same distance from the root, and for every non-leaf vertex, one of its children is the left one, and the other child is the right one. Formally, you are given a perfect binary tree.The vertices of the tree are numbered in the following order:  the root has index 1;  if a vertex has index x, then its left child has index 2x, and its right child has index 2x+1. Every vertex of the tree has a letter written on it, either A or B. Let\'s define the character on the vertex x as sx.Let the preorder string of some vertex x be defined in the following way:  if the vertex x is a leaf, then the preorder string of x be consisting of only one character sx;  otherwise, the preorder string of x is sx+f(lx)+f(rx), where + operator defines concatenation of strings, f(lx) is the preorder string of the left child of x, and f(rx) is the preorder string of the right child of x. The preorder string of the tree is the preorder string of its root.Now, for the problem itself...You have to calculate the number of different strings that can be obtained as the preorder string of the given tree, if you are allowed to perform the following operation any number of times before constructing the preorder string of the tree:  choose any non-leaf vertex x, and swap its children (so, the left child becomes the right one, and vice versa)." 2100
1671D "Insert a Progression" "brute force,constructive algorithms,greedy" "You are given a sequence of n integers a1,a2,\xe2\x80\xa6,an. You are also given x integers 1,2,\xe2\x80\xa6,x.You are asked to insert each of the extra integers into the sequence a. Each integer can be inserted at the beginning of the sequence, at the end of the sequence, or between any elements of the sequence.The score of the resulting sequence a\xe2\x80\xb2 is the sum of absolute differences of adjacent elements in it (n+x\xe2\x88\x921\xe2\x88\x91i=1|a\xe2\x80\xb2i\xe2\x88\x92a\xe2\x80\xb2i+1|).What is the smallest possible score of the resulting sequence a\xe2\x80\xb2?" 1600
1671C "Dolce Vita" "binary search,brute force,greedy,math" "Turbulent times are coming, so you decided to buy sugar in advance. There are n shops around that sell sugar: the i-th shop sells one pack of sugar for ai coins, but only one pack to one customer each day. So in order to buy several packs, you need to visit several shops.Another problem is that prices are increasing each day: during the first day the cost is ai, during the second day cost is ai+1, during the third day \xe2\x80\x94 ai+2 and so on for each shop i.On the contrary, your everyday budget is only x coins. In other words, each day you go and buy as many packs as possible with total cost not exceeding x. Note that if you don\'t spend some amount of coins during a day, you can\'t use these coins during the next days.Eventually, the cost for each pack will exceed x, and you won\'t be able to buy even a single pack. So, how many packs will you be able to buy till that moment in total?" 1200
1671B "Consecutive Points Segment" "brute force,math,sortings" "You are given n points with integer coordinates on a coordinate axis OX. The coordinate of the i-th point is xi. All points\' coordinates are distinct and given in strictly increasing order.For each point i, you can do the following operation no more than once: take this point and move it by 1 to the left or to the right (i..e., you can change its coordinate xi to xi\xe2\x88\x921 or to xi+1). In other words, for each point, you choose (separately) its new coordinate. For the i-th point, it can be either xi\xe2\x88\x921, xi or xi+1.Your task is to determine if you can move some points as described above in such a way that the new set of points forms a consecutive segment of integers, i.\xe2\x80\x89e. for some integer l the coordinates of points should be equal to l,l+1,\xe2\x80\xa6,l+n\xe2\x88\x921.Note that the resulting points should have distinct coordinates.You have to answer t independent test cases." 1000
1671A "String Building" implementation "You are given a string s. You have to determine whether it is possible to build the string s out of strings aa, aaa, bb and/or bbb by concatenating them. You can use the strings aa, aaa, bb and/or bbb any number of times and in any order.For example:  aaaabbb can be built as aa + aa + bbb;  bbaaaaabbb can be built as bb + aaa + aa + bbb;  aaaaaa can be built as aa + aa + aa;  abab cannot be built from aa, aaa, bb and/or bbb." 800
1670F "Jee, You See?" bitmasks,combinatorics,dp "During their training for the ICPC competitions, team ""Jee You See"" stumbled upon a very basic counting problem. After many ""Wrong answer"" verdicts, they finally decided to give up and destroy turn-off the PC. Now they want your help in up-solving the problem.You are given 4 integers n, l, r, and z. Count the number of arrays a of length n containing non-negative integers such that:  l\xe2\x89\xa4a1+a2+\xe2\x80\xa6+an\xe2\x89\xa4r, and  a1\xe2\x8a\x95a2\xe2\x8a\x95\xe2\x80\xa6\xe2\x8a\x95an=z, where \xe2\x8a\x95 denotes the bitwise XOR operation. Since the answer can be large, print it modulo 109+7." 2400
1670E "Hemose on the Tree" "bitmasks,constructive algorithms,dfs and similar,trees" "After the last regional contest, Hemose and his teammates finally qualified to the ICPC World Finals, so for this great achievement and his love of trees, he gave you this problem as the name of his team ""Hemose 3al shagra"" (Hemose on the tree).You are given a tree of n vertices where n is a power of 2. You have to give each node and edge an integer value in the range [1,2n\xe2\x88\x921] (inclusive), where all the values are distinct.After giving each node and edge a value, you should select some root for the tree such that the maximum cost of any simple path starting from the root and ending at any node or edge is minimized.The cost of the path between two nodes u and v or any node u and edge e is defined as the bitwise XOR of all the node\'s and edge\'s values between them, including the endpoints (note that in a tree there is only one simple path between two nodes or between a node and an edge)." 2200
1670D "Very Suspicious" "binary search,brute force,geometry,greedy,implementation,math" "Sehr Sus is an infinite hexagonal grid as pictured below, controlled by MennaFadali, ZerooCool and Hosssam.They love equilateral triangles and want to create n equilateral triangles on the grid by adding some straight lines. The triangles must all be empty from the inside (in other words, no straight line or hexagon edge should pass through any of the triangles).You are allowed to add straight lines parallel to the edges of the hexagons. Given n, what is the minimum number of lines you need to add to create at least n equilateral triangles as described?  Adding two red lines results in two new yellow equilateral triangles." 1700
1670C "Where is the Pizza?" "data structures,dfs and similar,dsu,graphs,implementation,math" "While searching for the pizza, baby Hosssam came across two permutations a and b of length n.Recall that a permutation is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array) and [1,3,4] is also not a permutation (n=3 but there is 4 in the array).Baby Hosssam forgot about the pizza and started playing around with the two permutations. While he was playing with them, some elements of the first permutation got mixed up with some elements of the second permutation, and to his surprise those elements also formed a permutation of size n.Specifically, he mixed up the permutations to form a new array c in the following way.  For each i (1\xe2\x89\xa4i\xe2\x89\xa4n), he either made ci=ai or ci=bi.  The array c is a permutation. You know permutations a, b, and values at some positions in c. Please count the number different permutations c that are consistent with the described process and the given values. Since the answer can be large, print it modulo 109+7.It is guaranteed that there exists at least one permutation c that satisfies all the requirements." 1400
1670B "Dorms War" "brute force,implementation,strings" "Hosssam decided to sneak into Hemose\'s room while he is sleeping and change his laptop\'s password. He already knows the password, which is a string s of length n. He also knows that there are k special letters of the alphabet: c1,c2,\xe2\x80\xa6,ck.Hosssam made a program that can do the following.  The program considers the current password s of some length m.  Then it finds all positions i (1\xe2\x89\xa4i<m) such that si+1 is one of the k special letters.  Then it deletes all of those positions from the password s even if si is a special character. If there are no positions to delete, then the program displays an error message which has a very loud sound. For example, suppose the string s is ""abcdef"" and the special characters are \'b\' and \'d\'. If he runs the program once, the positions 1 and 3 will be deleted as they come before special characters, so the password becomes ""bdef"". If he runs the program again, it deletes position 1, and the password becomes ""def"". If he is wise, he won\'t run it a third time.Hosssam wants to know how many times he can run the program on Hemose\'s laptop without waking him up from the sound of the error message. Can you help him?" 1100
1670A "Prof. Slim" greedy,implementation,sortings "One day Prof. Slim decided to leave the kingdom of the GUC to join the kingdom of the GIU. He was given an easy online assessment to solve before joining the GIU. Citizens of the GUC were happy sad to see the prof leaving, so they decided to hack into the system and change the online assessment into a harder one so that he stays at the GUC. After a long argument, they decided to change it into the following problem.Given an array of n integers a1,a2,\xe2\x80\xa6,an, where ai\xe2\x89\xa00, check if you can make this array sorted by using the following operation any number of times (possibly zero). An array is sorted if its elements are arranged in a non-decreasing order.  select two indices i and j (1\xe2\x89\xa4i,j\xe2\x89\xa4n) such that ai and aj have different signs. In other words, one must be positive and one must be negative.  swap the signs of ai and aj. For example if you select ai=3 and aj=\xe2\x88\x922, then they will change to ai=\xe2\x88\x923 and aj=2. Prof. Slim saw that the problem is still too easy and isn\'t worth his time, so he decided to give it to you to solve." 800
1669H "Maximal AND" bitmasks,greedy,math "Let AND denote the bitwise AND operation, and OR denote the bitwise OR operation.You are given an array a of length n and a non-negative integer k. You can perform at most k operations on the array of the following type:  Select an index i (1\xe2\x89\xa4i\xe2\x89\xa4n) and replace ai with ai OR 2j where j is any integer between 0 and 30 inclusive. In other words, in an operation you can choose an index i (1\xe2\x89\xa4i\xe2\x89\xa4n) and set the j-th bit of ai to 1 (0\xe2\x89\xa4j\xe2\x89\xa430). Output the maximum possible value of a1 AND a2 AND \xe2\x80\xa6 AND an after performing at most k operations." 1300
1669G "Fall Down" "dfs and similar,implementation" "There is a grid with n rows and m columns, and three types of cells:   An empty cell, denoted with \'.\'.  A stone, denoted with \'*\'.  An obstacle, denoted with the lowercase Latin letter \'o\'. All stones fall down until they meet the floor (the bottom row), an obstacle, or other stone which is already immovable. (In other words, all the stones just fall down as long as they can fall.)Simulate the process. What does the resulting grid look like?" 1200
1669F "Eating Candies" "binary search,data structures,greedy,two pointers" "There are n candies put from left to right on a table. The candies are numbered from left to right. The i-th candy has weight wi. Alice and Bob eat candies. Alice can eat any number of candies from the left (she can\'t skip candies, she eats them in a row). Bob can eat any number of candies from the right (he can\'t skip candies, he eats them in a row). Of course, if Alice ate a candy, Bob can\'t eat it (and vice versa).They want to be fair. Their goal is to eat the same total weight of candies. What is the most number of candies they can eat in total?" 1100
1669E "2-Letter Strings" "data structures,math,strings" "Given n strings, each of length 2, consisting of lowercase Latin alphabet letters from \'a\' to \'k\', output the number of pairs of indices (i,j) such that i<j and the i-th string and the j-th string differ in exactly one position.In other words, count the number of pairs (i,j) (i<j) such that the i-th string and the j-th string have exactly one position p (1\xe2\x89\xa4p\xe2\x89\xa42) such that sip\xe2\x89\xa0sjp.The answer may not fit into 32-bit integer type, so you should use 64-bit integers like long long in C++ to avoid integer overflow." 1200
1669D "Colorful Stamp" implementation "A row of n cells is given, all initially white. Using a stamp, you can stamp any two neighboring cells such that one becomes red and the other becomes blue. A stamp can be rotated, i.e. it can be used in both ways: as BR and as RB.During use, the stamp must completely fit on the given n cells (it cannot be partially outside the cells). The stamp can be applied multiple times to the same cell. Each usage of the stamp recolors both cells that are under the stamp.For example, one possible sequence of stamps to make the picture BRBBW could be WWWWW\xe2\x86\x92WWRB_W\xe2\x86\x92BR_RBW\xe2\x86\x92BRB_BW. Here W, R, and B represent a white, red, or blue cell, respectively, and the cells that the stamp is used on are marked with an underline.Given a final picture, is it possible to make it using the stamp zero or more times?" 1100
1669C "Odd/Even Increments" greedy,greedy,implementation,math "Given an array a=[a1,a2,\xe2\x80\xa6,an] of n positive integers, you can do operations of two types on it:  Add 1 to every element with an odd index. In other words change the array as follows: a1:=a1+1,a3:=a3+1,a5:=a5+1,\xe2\x80\xa6.  Add 1 to every element with an even index. In other words change the array as follows: a2:=a2+1,a4:=a4+1,a6:=a6+1,\xe2\x80\xa6.Determine if after any number of operations it is possible to make the final array contain only even numbers or only odd numbers. In other words, determine if you can make all elements of the array have the same parity after any number of operations.Note that you can do operations of both types any number of times (even none). Operations of different types can be performed a different number of times." 800
1669B Triple implementation,sortings "Given an array a of n elements, print any value that appears at least three times or print -1 if there is no such value." 800
1669A Division? implementation "Codeforces separates its users into 4 divisions by their rating:  For Division 1: 1900\xe2\x89\xa4rating  For Division 2: 1600\xe2\x89\xa4rating\xe2\x89\xa41899  For Division 3: 1400\xe2\x89\xa4rating\xe2\x89\xa41599  For Division 4: rating\xe2\x89\xa41399 Given a rating, print in which division the rating belongs." 800
1668B "Social Distance" greedy,math,sortings "m chairs are arranged in a circle sequentially. The chairs are numbered from 0 to m\xe2\x88\x921. n people want to sit in these chairs. The i-th of them wants at least a[i] empty chairs both on his right and left side. More formally, if the i-th person sits in the j-th chair, then no one else should sit in the following chairs: (j\xe2\x88\x92a[i])modm, (j\xe2\x88\x92a[i]+1)modm, ... (j+a[i]\xe2\x88\x921)modm, (j+a[i])modm.Decide if it is possible to sit down for all of them, under the given limitations." 900
1668A "Direction Change" implementation,math "You are given a grid with n rows and m columns. Rows and columns are numbered from 1 to n, and from 1 to m. The intersection of the a-th row and b-th column is denoted by (a,b). Initially, you are standing in the top left corner (1,1). Your goal is to reach the bottom right corner (n,m).You can move in four directions from (a,b): up to (a\xe2\x88\x921,b), down to (a+1,b), left to (a,b\xe2\x88\x921) or right to (a,b+1).You cannot move in the same direction in two consecutive moves, and you cannot leave the grid. What is the minimum number of moves to reach (n,m)?" 800
1667F "Yin Yang" implementation "You are given a rectangular grid with n rows and m columns. n and m are divisible by 4. Some of the cells are already colored black or white. It is guaranteed that no two colored cells share a corner or an edge.Color the remaining cells in a way that both the black and the white cells becomes orthogonally connected or determine that it is impossible.Consider a graph, where the black cells are the nodes. Two nodes are adjacent if the corresponding cells share an edge. If the described graph is connected, the black cells are orthogonally connected. Same for white cells." 3500
1667E "Centroid Probabilities" combinatorics,dp,fft,math "Consider every tree (connected undirected acyclic graph) with n vertices (n is odd, vertices numbered from 1 to n), and for each 2\xe2\x89\xa4i\xe2\x89\xa4n the i-th vertex is adjacent to exactly one vertex with a smaller index.For each i (1\xe2\x89\xa4i\xe2\x89\xa4n) calculate the number of trees for which the i-th vertex will be the centroid. The answer can be huge, output it modulo 998244353.A vertex is called a centroid if its removal splits the tree into subtrees with at most (n\xe2\x88\x921)/2 vertices each." 3000
1667D "Edge Elimination" "constructive algorithms,dfs and similar,dp,trees" "You are given a tree (connected, undirected, acyclic graph) with n vertices. Two edges are adjacent if they share exactly one endpoint. In one move you can remove an arbitrary edge, if that edge is adjacent to an even number of remaining edges.Remove all of the edges, or determine that it is impossible. If there are multiple solutions, print any." 2900
1667C "Half Queen Cover" "constructive algorithms,math" "You are given a board with n rows and n columns, numbered from 1 to n. The intersection of the a-th row and b-th column is denoted by (a,b).A half-queen attacks cells in the same row, same column, and on one diagonal. More formally, a half-queen on (a,b) attacks the cell (c,d) if a=c or b=d or a\xe2\x88\x92b=c\xe2\x88\x92d.  The blue cells are under attack.  What is the minimum number of half-queens that can be placed on that board so as to ensure that each square is attacked by at least one half-queen?Construct an optimal solution." 2400
1667B "Optimal Partition" "data structures,dp" "You are given an array a consisting of n integers. You should divide a into continuous non-empty subarrays (there are 2n\xe2\x88\x921 ways to do that).Let s=al+al+1+\xe2\x80\xa6+ar. The value of a subarray al,al+1,\xe2\x80\xa6,ar is:   (r\xe2\x88\x92l+1) if s>0, 0 if s=0, \xe2\x88\x92(r\xe2\x88\x92l+1) if s<0.  What is the maximum sum of values you can get with a partition?" 2100
1667A "Make it Increasing" "brute force,greedy,math" "You are given an array a consisting of n positive integers, and an array b, with length n. Initially bi=0 for each 1\xe2\x89\xa4i\xe2\x89\xa4n.In one move you can choose an integer i (1\xe2\x89\xa4i\xe2\x89\xa4n), and add ai to bi or subtract ai from bi. What is the minimum number of moves needed to make b increasing (that is, every element is strictly greater than every element before it)?" 1300
1666L Labyrinth "dfs and similar,graphs" "Leslie and Leon entered a labyrinth. The labyrinth consists of n halls and m one-way passages between them. The halls are numbered from 1 to n.Leslie and Leon start their journey in the hall s. Right away, they quarrel and decide to explore the labyrinth separately. However, they want to meet again at the end of their journey.To help Leslie and Leon, your task is to find two different paths from the given hall s to some other hall t, such that these two paths do not share halls other than the staring hall s and the ending hall t. The hall t has not been determined yet, so you can choose any of the labyrinth\'s halls as t except s.Leslie\'s and Leon\'s paths do not have to be the shortest ones, but their paths must be simple, visiting any hall at most once. Also, they cannot visit any common halls except s and t during their journey, even at different times." 1800
1666K "Kingdom Partition" flows "The King is gone. After the King\'s rule, all the roads in the Kingdom are run down and need repair. Three of the King\'s children, Adrian, Beatrice and Cecilia, are dividing the Kingdom between themselves.Adrian and Beatrice do not like each other and do not plan to maintain any relations between themselves in the future. Cecilia is on good terms with both of them. Moreover, most of the Kingdom\'s workers support Cecilia, so she has better resources and more opportunity to repair the infrastructure and develop the economy. Cecilia proposes to partition the Kingdom into three districts: A (for Adrian), B (for Beatrice), and C (for Cecilia), and let Adrian and Beatrice to negotiate and choose any towns they want to be in their districts, and agree on how they want to partition the Kingdom into three districts.Adrian\'s castle is located in town a, and Beatrice\'s one is located in town b. So Adrian and Beatrice want their castles to be located in districts A and B, respectively. Cecilia doesn\'t have a castle, so district C can consist of no towns.There is an issue for Adrian and Beatrice. When they choose the towns, they will have to pay for the roads\' repair.The cost to repair the road of length l is 2l gold. However, Adrian and Beatrice don\'t have to bear all the repair costs. The repair cost for the road of length l that they bear depends on what towns it connects:  For a road between two towns inside district A, Adrian has to pay 2l gold;  For a road between two towns inside district B, Beatrice has to pay 2l gold;  For a road between towns from district A and district C, Adrian has to pay l gold, Cecilia bears the remaining cost;  For a road between towns from district B and district C, Beatrice has to pay l gold, Cecilia bears the remaining cost. The roads that connect towns from district A and district B won\'t be repaired, since Adrian and Beatrice are not planning to use them, so no one pays for them. Cecilia herself will repair the roads that connect the towns inside district C, so Adrian and Beatrice won\'t bear the cost of their repair either.Adrian and Beatrice want to minimize the total cost they spend on roads\' repair. Find the cheapest way for them to partition the Kingdom into three districts." 3200
1666J "Job Lookup" "constructive algorithms,dp,shortest paths,trees" "Julia\'s n friends want to organize a startup in a new country they moved to. They assigned each other numbers from 1 to n according to the jobs they have, from the most front-end tasks to the most back-end ones. They also estimated a matrix c, where cij=cji is the average number of messages per month between people doing jobs i and j.Now they want to make a hierarchy tree. It will be a binary tree with each node containing one member of the team. Some member will be selected as a leader of the team and will be contained in the root node. In order for the leader to be able to easily reach any subordinate, for each node v of the tree, the following should apply: all members in its left subtree must have smaller numbers than v, and all members in its right subtree must have larger numbers than v.After the hierarchy tree is settled, people doing jobs i and j will be communicating via the shortest path in the tree between their nodes. Let\'s denote the length of this path as dij. Thus, the cost of their communication is cij\xe2\x8b\x85dij.Your task is to find a hierarchy tree that minimizes the total cost of communication over all pairs: \xe2\x88\x911\xe2\x89\xa4i<j\xe2\x89\xa4ncij\xe2\x8b\x85dij." 2100
1666I "Interactive Treasure Hunt" "brute force,constructive algorithms,geometry,interactive,math" "This is an interactive problem.There is a grid of n\xc3\x97m cells. Two treasure chests are buried in two different cells of the grid. Your task is to find both of them. You can make two types of operations:    DIG r c: try to find the treasure in the cell (r,c). The interactor will tell you if you found the treasure or not.  SCAN r c: scan from the cell (r,c). The result of this operation is the sum of Manhattan distances from the cell (r,c) to the cells where the treasures are hidden. Manhattan distance from a cell (r1,c1) to a cell (r2,c2) is calculated as |r1\xe2\x88\x92r2|+|c1\xe2\x88\x92c2|. You need to find the treasures in at most 7 operations. This includes both DIG and SCAN operations in total. To solve the test you need to call DIG operation at least once in both of the cells where the treasures are hidden." 2200
1666F "Fancy Stack" combinatorics,dp,implementation "Little Fiona has a collection of n blocks of various sizes a1,a2,\xe2\x80\xa6,an, where n is even. Some of the blocks can be equal in size. She would like to put all these blocks one onto another to form a fancy stack.Let b1,b2,\xe2\x80\xa6,bn be the sizes of blocks in the stack from top to bottom. Since Fiona is using all her blocks, b1,b2,\xe2\x80\xa6,bn must be a permutation of a1,a2,\xe2\x80\xa6,an. Fiona thinks the stack is fancy if both of the following conditions are satisfied:   The second block is strictly bigger than the first one, and then each block is alternately strictly smaller or strictly bigger than the previous one. Formally, b1<b2>b3<b4>\xe2\x80\xa6>bn\xe2\x88\x921<bn.  The sizes of the blocks on even positions are strictly increasing. Formally, b2<b4<b6<\xe2\x80\xa6<bn (remember that n is even).   Two stacks are considered different if their corresponding sequences b1,b2,\xe2\x80\xa6,bn differ in at least one position.Fiona wants to know how many different fancy stacks she can build with all of her blocks. Since large numbers scare Fiona, find this number modulo 998244353." 2200
1666E "Even Split" "binary search,constructive algorithms,greedy,math" "A revolution has recently happened in Segmentland. The new government is committed to equality, and they hired you to help with land redistribution in the country.Segmentland is a segment of length l kilometers, with the capital in one of its ends. There are n citizens in Segmentland, the home of i-th citizen is located at the point ai kilometers from the capital. No two homes are located at the same point. Each citizen should receive a segment of positive length with ends at integer distances from the capital that contains her home. The union of these segments should be the whole of Segmentland, and they should not have common points besides their ends. To ensure equality, the difference between the lengths of the longest and the shortest segments should be as small as possible." 2500
1666D "Deletive Editing" greedy "Daisy loves playing games with words. Recently, she has been playing the following Deletive Editing word game with Daniel. Daisy picks a word, for example, ""DETERMINED"". On each game turn, Daniel calls out a letter, for example, \'E\', and Daisy removes the first occurrence of this letter from the word, getting ""DTERMINED"". On the next turn, Daniel calls out a letter again, for example, \'D\', and Daisy removes its first occurrence, getting ""TERMINED"". They continue with \'I\', getting ""TERMNED"", with \'N\', getting ""TERMED"", and with \'D\', getting ""TERME"". Now, if Daniel calls out the letter \'E\', Daisy gets ""TRME"", but there is no way she can get the word ""TERM"" if they start playing with the word ""DETERMINED"".Daisy is curious if she can get the final word of her choice, starting from the given initial word, by playing this game for zero or more turns. Your task it help her to figure this out." 900
1666C "Connect the Points" "brute force,constructive algorithms,geometry" "You are given three points on a plane. You should choose some segments on the plane that are parallel to coordinate axes, so that all three points become connected. The total length of the chosen segments should be the minimal possible.Two points a and b are considered connected if there is a sequence of points p0=a,p1,\xe2\x80\xa6,pk=b such that points pi and pi+1 lie on the same segment." 1800
1666B "Budget Distribution" NA "Distributing budgeted money with limited resources and many constraints is a hard problem. A budget plan consists of t topics; i-th topic consists of ni items. For each topic, the optimal relative money distribution is known. The optimal relative distribution for the topic i is a list of real numbers pi,j, where ni\xe2\x88\x91j=1pi,j=1. Let\'s denote the amount of money assigned to j-th item of the topic i as ci,j; the total amount of money for the topic is Ci=ni\xe2\x88\x91j=1ci,j. A non-optimality of the plan for the topic i is defined as ni\xe2\x88\x91j=1|ci,jCi\xe2\x88\x92pi,j|. Informally, the non-optimality is the total difference between the optimal and the actual ratios of money assigned to all the items in the topic. The total plan non-optimality is the sum of non-optimalities of all t topics. Your task is to minimize the total plan non-optimality.However, the exact amount of money available is not known yet. j-th item of i-th topic already has \xcb\x86ci,j dollars assigned to it and they cannot be taken back. Also, there are q possible values of the extra unassigned amounts of money available xk. For each of them, you need to calculate the minimal possible total non-optimality among all ways to distribute this extra money. You don\'t need to assign an integer amount of money to an item, any real number is possible, but all the extra money must be distributed among all the items in addition to \xcb\x86ci,j already assigned. Formally, for each value of extra money xk you\'ll need to find its distribution di,j such that di,j\xe2\x89\xa50 and t\xe2\x88\x91i=1ni\xe2\x88\x91j=1di,j=xk, giving the resulting budget assignments ci,j=\xcb\x86ci,j+di,j that minimize the total plan non-optimality." 3300
1666A "Admissible Map" NA "A map is a matrix consisting of symbols from the set of \'U\', \'L\', \'D\', and \'R\'.A map graph of a map matrix a is a directed graph with n\xe2\x8b\x85m vertices numbered as (i,j) (1\xe2\x89\xa4i\xe2\x89\xa4n;1\xe2\x89\xa4j\xe2\x89\xa4m), where n is the number of rows in the matrix, m is the number of columns in the matrix. The graph has n\xe2\x8b\x85m directed edges (i,j)\xe2\x86\x92(i+diai,j,j+djai,j), where (diU,djU)=(\xe2\x88\x921,0); (diL,djL)=(0,\xe2\x88\x921); (diD,djD)=(1,0); (diR,djR)=(0,1). A map graph is valid when all edges point to valid vertices in the graph.An admissible map is a map such that its map graph is valid and consists of a set of cycles.A description of a map a is a concatenation of all rows of the map \xe2\x80\x94 a string a1,1a1,2\xe2\x80\xa6a1,ma2,1\xe2\x80\xa6an,m.You are given a string s. Your task is to find how many substrings of this string can constitute a description of some admissible map. A substring of a string s1s2\xe2\x80\xa6sl of length l is defined by a pair of indices p and q (1\xe2\x89\xa4p\xe2\x89\xa4q\xe2\x89\xa4l) and is equal to spsp+1\xe2\x80\xa6sq. Two substrings of s are considered different when the pair of their indices (p,q) differs, even if they represent the same resulting string." 3300
1665E MinimizOR "bitmasks,brute force,data structures,divide and conquer,greedy,implementation,two pointers" "You are given an array a of n non-negative integers, numbered from 1 to n.Let\'s define the cost of the array a as mini\xe2\x89\xa0jai|aj, where | denotes the bitwise OR operation.There are q queries. For each query you are given two integers l and r (l<r). For each query you should find the cost of the subarray al,al+1,\xe2\x80\xa6,ar." 2500
1665D "GCD Guess" "bitmasks,chinese remainder theorem,constructive algorithms,games,interactive,math,number theory" "This is an interactive problem.There is a positive integer 1\xe2\x89\xa4x\xe2\x89\xa4109 that you have to guess.In one query you can choose two positive integers a\xe2\x89\xa0b. As an answer to this query you will get gcd(x+a,x+b), where gcd(n,m) is the greatest common divisor of the numbers n and m.To guess one hidden number x you are allowed to make no more than 30 queries." 2000
1665C "Tree Infection" "binary search,greedy,sortings,trees" "A tree is a connected graph without cycles. A rooted tree has a special vertex called the root. The parent of a vertex v (different from root) is the previous to v vertex on the shortest path from the root to the vertex v. Children of the vertex v are all vertices for which v is the parent.You are given a rooted tree with n vertices. The vertex 1 is the root. Initially, all vertices are healthy.Each second you do two operations, the spreading operation and, after that, the injection operation:   Spreading: for each vertex v, if at least one child of v is infected, you can spread the disease by infecting at most one other child of v of your choice.  Injection: you can choose any healthy vertex and infect it. This process repeats each second until the whole tree is infected. You need to find the minimal number of seconds needed to infect the whole tree." 1600
1665B "Array Cloning Technique" "constructive algorithms,greedy,sortings" "You are given an array a of n integers. Initially there is only one copy of the given array.You can do operations of two types:  Choose any array and clone it. After that there is one more copy of the chosen array.  Swap two elements from any two copies (maybe in the same copy) on any positions. You need to find the minimal number of operations needed to obtain a copy where all elements are equal." 900
1665A "GCD vs LCM" "constructive algorithms,math" "You are given a positive integer n. You have to find 4 positive integers a,b,c,d such that  a+b+c+d=n, and gcd(a,b)=lcm(c,d).If there are several possible answers you can output any of them. It is possible to show that the answer always exists.In this problem gcd(a,b) denotes the greatest common divisor of a and b, and lcm(c,d) denotes the least common multiple of c and d." 800
1663H "Cross-Language Program" "*special problem,constructive algorithms" "Write a program that is compilable simultaneously in two languages: C++ (GCC 10.3.1, -std=c++11) and FreePascal (3.0.4).It absolutely does not matter what this program does, the only requirement is that it successfully compiles into an executable file in both C++ and Pascal.Please use the language Text to submit your solution. Just choose Text as a language in the submission form.The submitted file can\'t exceed 2048 bytes. It should compile fast on both compilers." -999
1663G "Six Characters" "*special problem,constructive algorithms,strings" "Aenar should go to the string\'s home." -999
1663F "In Every Generation..." "*special problem,strings" "In every generation there is a Chosen One. She alone will stand against the vampires, the demons, and the forces of darkness. She is the Slayer. \xe2\x80\x94 Joss Whedon" -999
1663E "Are You Safe?" "*special problem,implementation" "Seven boys and seven girls from Athens were brought before King Minos. The evil king laughed and said ""I hope you enjoy your stay in Crete"".With a loud clang, the doors behind them shut, and darkness reigned. The terrified children huddled together. In the distance they heard a bellowing, unholy roar.Bravely, they advanced forward, to their doom." -999
1663D "Is it rated - 3" "*special problem,combinatorics,dp,math" "InputThe first line contains a string S.The second line contains an integer X.Constraints   |S|=3  0\xe2\x89\xa4X\xe2\x89\xa4109  The input is guaranteed to be valid." -999
1663C "P\xc5\x8dja Verdon" "*special problem,implementation,math" "Aenar has an array a consisting of n integers." -999
1663B "Mike\'s Sequence" "*special problem,divide and conquer,implementation,math" "You won\'t find this sequence on OEIS." -999
1663A "Who Tested?" "*special problem,expression parsing,trees"  -999
1662O "Circular Maze" "brute force,dfs and similar,graphs,implementation" "You are given a circular maze such as the ones shown in the figures.    Determine if it can be solved, i.e., if there is a path which goes from the center to the outside of the maze which does not touch any wall. The maze is described by n walls. Each wall can be either circular or straight.   Circular walls are described by a radius r, the distance from the center, and two angles \xce\xb81,\xce\xb82 describing the beginning and the end of the wall in the clockwise direction. Notice that swapping the two angles changes the wall.  Straight walls are described by an angle \xce\xb8, the direction of the wall, and two radii r1<r2 describing the beginning and the end of the wall. Angles are measured in degrees; the angle 0 corresponds to the upward pointing direction; and angles increase clockwise (hence the east direction corresponds to the angle 90)." -999
1662N "Drone Photo" combinatorics,math,sortings "Today, like every year at SWERC, the n2 contestants have gathered outside the venue to take a drone photo. Jennifer, the social media manager for the event, has arranged them into an n\xc3\x97n square. Being very good at her job, she knows that the contestant standing on the intersection of the i-th row with the j-th column is ai,j years old. Coincidentally, she notices that no two contestants have the same age, and that everyone is between 1 and n2 years old.Jennifer is planning to have some contestants hold a banner with the ICPC logo parallel to the ground, so that it is clearly visible in the aerial picture. Here are the steps that she is going to follow in order to take the perfect SWERC drone photo.  First of all, Jennifer is going to select four contestants standing on the vertices of an axis-aligned rectangle.  Then, she will have the two younger contestants hold one of the poles, while the two older contestants will hold the other pole.  Finally, she will unfold the banner, using the poles to support its two ends. Obviously, this can only be done if the two poles are parallel and do not cross, as shown in the pictures below.    Being very indecisive, Jennifer would like to try out all possible arrangements for the banner, but she is worried that this may cause the contestants to be late for the competition. How many different ways are there to choose the four contestants holding the poles in order to take a perfect photo? Two choices are considered different if at least one contestant is included in one but not the other." -999
1662M "Bottle Arrangements" "constructive algorithms" "Gabriella has been instructed to organize a renowned wine tasting event which will be attended by m critics. On display, there will be n different varieties of wine, each of which can either be a red wine or a white wine.The wines will come in n bottles arranged in a line on the table, and, for convenience, each critic will sip from a contiguous interval of bottles: that is, he/she will taste exactly the bottles at position a,a+1,\xe2\x80\xa6,b for some 1\xe2\x89\xa4a\xe2\x89\xa4b\xe2\x89\xa4n. The interval depends on the critic, who will select it on the spot according to their preferences. In fact, the i-th critic (1\xe2\x89\xa4i\xe2\x89\xa4m) has requested that he/she wants to taste exactly ri red wines and wi white wines.Gabriella has yet to choose how many bottles of red wine and white wine there will be, and in what order they will appear. Help her find an arrangement (that is, a sequence of n bottles of either red or white wine) that satisfies the requests of all the critics, or state that no such arrangement exists." -999
1662L "Il Derby della Madonnina" "data structures,dp,math" "The derby between Milan and Inter is happening soon, and you have been chosen as the assistant referee for the match, also known as linesman. Your task is to move along the touch-line, namely the side of the field, always looking very carefully at the match to check for offside positions and other offences.Football is an extremely serious matter in Italy, and thus it is fundamental that you keep very close track of the ball for as much time as possible. This means that you want to maximise the number of kicks which you monitor closely. You are able to monitor closely a kick if, when it happens, you are in the position along the touch-line with minimum distance from the place where the kick happens.Fortunately, expert analysts have been able to accurately predict all the kicks which will occur during the game. That is, you have been given two lists of integers, t1,\xe2\x80\xa6,tn and a1,\xe2\x80\xa6,an, indicating that ti seconds after the beginning of the match the ball will be kicked and you can monitor closely such kick if you are at the position ai along the touch-line. At the beginning of the game you start at position 0 and the maximum speed at which you can walk along the touch-line is v units per second (i.e., you can change your position by at most v each second). What is the maximum number of kicks that you can monitor closely?" -999
1662K "Pandemic Restrictions" "geometry,ternary search" "After a long time living abroad, you have decided to move back to Italy and have to find a place to live, but things are not so easy due to the ongoing global pandemic.Your three friends Fabio, Flavio and Francesco live at the points with coordinates (x1,y1),(x2,y2) and (x3,y3), respectively. Due to the mobility restrictions in response to the pandemic, meetings are limited to 3 persons, so you will only be able to meet 2 of your friends at a time. Moreover, in order to contain the spread of the infection, the authorities have imposed the following additional measure: for each meeting, the sum of the lengths travelled by each of the attendees from their residence place to the place of the meeting must not exceed r.What is the minimum value of r (which can be any nonnegative real number) for which there exists a place of residence that allows you to hold the three possible meetings involving you and two of your friends? Note that the chosen place of residence need not have integer coordinates." -999
1662J "Training Camp" flows,graphs "You are organizing a training camp to teach algorithms to young kids. There are n2 kids, organized in an n by n grid. Each kid is between 1 and n years old (inclusive) and any two kids who are in the same row or in the same column have different ages.You want to select exactly n kids for a programming competition, with exactly one kid from each row and one kid from each column. Moreover, kids who are not selected must be either older than both kids selected in their row and column, or younger than both kids selected in their row and column (otherwise they will complain). Notice that it is always possible to select n kids satisfying these requirements (for example by selecting n kids who have the same age).During the training camp, you observed that some kids are good at programming, and the others are not. What is the maximum number of kids good at programming that you can select while satisfying all the requirements?" -999
1662I "Ice Cream Shop" "brute force,implementation,sortings" "On a beach there are n huts in a perfect line, hut 1 being at the left and hut i+1 being 100 meters to the right of hut i, for all 1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921. In hut i there are pi people.There are m ice cream sellers, also aligned in a perfect line with all the huts. The i-th ice cream seller has their shop xi meters to the right of the first hut. All ice cream shops are at distinct locations, but they may be at the same location as a hut.You want to open a new ice cream shop and you wonder what the best location for your shop is. You can place your ice cream shop anywhere on the beach (not necessarily at an integer distance from the first hut) as long as it is aligned with the huts and the other ice cream shops, even if there is already another ice cream shop or a hut at that location. You know that people would come to your shop only if it is strictly closer to their hut than any other ice cream shop.If every person living in the huts wants to buy exactly one ice cream, what is the maximum number of ice creams that you can sell if you place the shop optimally?" -999
1662H Boundary "brute force,math" "Bethany would like to tile her bathroom. The bathroom has width w centimeters and length l centimeters. If Bethany simply used the basic tiles of size 1\xc3\x971 centimeters, she would use w\xe2\x8b\x85l of them. However, she has something different in mind.   On the interior of the floor she wants to use the 1\xc3\x971 tiles. She needs exactly (w\xe2\x88\x922)\xe2\x8b\x85(l\xe2\x88\x922) of these.  On the floor boundary she wants to use tiles of size 1\xc3\x97a for some positive integer a. The tiles can also be rotated by 90 degrees. For which values of a can Bethany tile the bathroom floor as described? Note that a can also be 1." -999
1662G "Gastronomic Event" dp,greedy,trees "SWERC organizers want to hold a gastronomic event.The location of the event is a building with n rooms connected by n\xe2\x88\x921 corridors (each corridor connects two rooms) so that it is possible to go from any room to any other room.In each room you have to set up the tasting of a typical Italian dish. You can choose from n typical Italian dishes rated from 1 to n depending on how good they are (n is the best possible rating). The n dishes have distinct ratings.You want to assign the n dishes to the n rooms so that the number of pleasing tours is maximal. A pleasing tour is a nonempty sequence of rooms so that:  Each room in the sequence is connected to the next one in the sequence by a corridor.  The ratings of the dishes in the rooms (in the order given by the sequence) are increasing.  If you assign the n dishes optimally, what is the maximum number of pleasing tours?" -999
1662F Antennas "data structures,dfs and similar,graphs,graphs,implementation,implementation,shortest paths,shortest paths" "There are n equidistant antennas on a line, numbered from 1 to n. Each antenna has a power rating, the power of the i-th antenna is pi. The i-th and the j-th antenna can communicate directly if and only if their distance is at most the minimum of their powers, i.e., |i\xe2\x88\x92j|\xe2\x89\xa4min(pi,pj). Sending a message directly between two such antennas takes 1 second.What is the minimum amount of time necessary to send a message from antenna a to antenna b, possibly using other antennas as relays?" -999
1662E "Round Table" math "There are n people, numbered from 1 to n, sitting at a round table. Person i+1 is sitting to the right of person i (with person 1 sitting to the right of person n).You have come up with a better seating arrangement, which is given as a permutation p1,p2,\xe2\x80\xa6,pn. More specifically, you want to change the seats of the people so that at the end person pi+1 is sitting to the right of person pi (with person p1 sitting to the right of person pn). Notice that for each seating arrangement there are n permutations that describe it (which can be obtained by rotations).In order to achieve that, you can swap two people sitting at adjacent places; but there is a catch: for all 1\xe2\x89\xa4x\xe2\x89\xa4n\xe2\x88\x921 you cannot swap person x and person x+1 (notice that you can swap person n and person 1). What is the minimum number of swaps necessary? It can be proven that any arrangement can be achieved." -999
1662D "Evolution of Weasels" greedy,implementation,strings "A wild basilisk just appeared at your doorstep. You are not entirely sure what a basilisk is and you wonder whether it evolved from your favorite animal, the weasel. How can you find out whether basilisks evolved from weasels? Certainly, a good first step is to sequence both of their DNAs. Then you can try to check whether there is a sequence of possible mutations from the DNA of the weasel to the DNA of the basilisk. Your friend Ron is a talented alchemist and has studied DNA sequences in many of his experiments. He has found out that DNA strings consist of the letters A, B and C and that single mutations can only remove or add substrings at any position in the string (a substring is a contiguous sequence of characters). The substrings that can be removed or added by a mutation are AA, BB, CC, ABAB or BCBC. During a sequence of mutations a DNA string may even become empty.Ron has agreed to sequence the DNA of the weasel and the basilisk for you, but finding out whether there is a sequence of possible mutations that leads from one to the other is too difficult for him, so you have to do it on your own." -999
1662C "European Trip" dp,graphs,math,matrices "The map of Europe can be represented by a set of n cities, numbered from 1 through n, which are connected by m bidirectional roads, each of which connects two distinct cities. A trip of length k is a sequence of k+1 cities v1,v2,\xe2\x80\xa6,vk+1 such that there is a road connecting each consecutive pair vi, vi+1 of cities, for all 1\xe2\x89\xa4i\xe2\x89\xa4k. A special trip is a trip that does not use the same road twice in a row, i.e., a sequence of k+1 cities v1,v2,\xe2\x80\xa6,vk+1 such that it forms a trip and vi\xe2\x89\xa0vi+2, for all 1\xe2\x89\xa4i\xe2\x89\xa4k\xe2\x88\x921.Given an integer k, compute the number of distinct special trips of length k which begin and end in the same city. Since the answer might be large, give the answer modulo 998244353." -999
1662B Toys greedy,strings "Vittorio has three favorite toys: a teddy bear, an owl, and a raccoon. Each of them has a name. Vittorio takes several sheets of paper and writes a letter on each side of every sheet so that it is possible to spell any of the three names by arranging some of the sheets in a row (sheets can be reordered and flipped as needed). The three names do not have to be spelled at the same time, it is sufficient that it is possible to spell each of them using all the available sheets (and the same sheet can be used to spell different names).Find the minimum number of sheets required. In addition, produce a list of sheets with minimum cardinality which can be used to spell the three names (if there are multiple answers, print any)." -999
1662A "Organizing SWERC" "brute force,implementation" "Gianni, SWERC\'s chief judge, received a huge amount of high quality problems from the judges and now he has to choose a problem set for SWERC.He received n problems and he assigned a beauty score and a difficulty to each of them. The i-th problem has beauty score equal to bi and difficulty equal to di. The beauty and the difficulty are integers between 1 and 10. If there are no problems with a certain difficulty (the possible difficulties are 1,2,\xe2\x80\xa6,10) then Gianni will ask for more problems to the judges.Otherwise, for each difficulty between 1 and 10, he will put in the problem set one of the most beautiful problems with such difficulty (so the problem set will contain exactly 10 problems with distinct difficulties). You shall compute the total beauty of the problem set, that is the sum of the beauty scores of the problems chosen by Gianni." -999
1661F Teleporters "binary search,greedy" "There are n+1 teleporters on a straight line, located in points 0, a1, a2, a3, ..., an. It\'s possible to teleport from point x to point y if there are teleporters in both of those points, and it costs (x\xe2\x88\x92y)2 energy.You want to install some additional teleporters so that it is possible to get from the point 0 to the point an (possibly through some other teleporters) spending no more than m energy in total. Each teleporter you install must be located in an integer point.What is the minimum number of teleporters you have to install?" 2600
1661E "Narrow Components" "brute force,data structures,dp,dsu,math,trees" "You are given a matrix a, consisting of 3 rows and n columns. Each cell of the matrix is either free or taken.A free cell y is reachable from a free cell x if at least one of these conditions hold:   x and y share a side;  there exists a free cell z such that z is reachable from x and y is reachable from z. A connected component is a set of free cells of the matrix such that all cells in it are reachable from one another, but adding any other free cell to the set violates this rule.You are asked q queries about the matrix. Each query is the following:   l r \xe2\x80\x94 count the number of connected components of the matrix, consisting of columns from l to r of the matrix a, inclusive. Print the answers to all queries." 2500
1661D "Progressions Covering" "data structures,greedy" "You are given two arrays: an array a consisting of n zeros and an array b consisting of n integers.You can apply the following operation to the array a an arbitrary number of times: choose some subsegment of a of length k and add the arithmetic progression 1,2,\xe2\x80\xa6,k to this subsegment \xe2\x80\x94 i.\xe2\x80\x89e. add 1 to the first element of the subsegment, 2 to the second element, and so on. The chosen subsegment should be inside the borders of the array a (i.e., if the left border of the chosen subsegment is l, then the condition 1\xe2\x89\xa4l\xe2\x89\xa4l+k\xe2\x88\x921\xe2\x89\xa4n should be satisfied). Note that the progression added is always 1,2,\xe2\x80\xa6,k but not the k,k\xe2\x88\x921,\xe2\x80\xa6,1 or anything else (i.e., the leftmost element of the subsegment always increases by 1, the second element always increases by 2 and so on).Your task is to find the minimum possible number of operations required to satisfy the condition ai\xe2\x89\xa5bi for each i from 1 to n. Note that the condition ai\xe2\x89\xa5bi should be satisfied for all elements at once." 1900
1661C "Water the Trees" "binary search,greedy,math" "There are n trees in a park, numbered from 1 to n. The initial height of the i-th tree is hi.You want to water these trees, so they all grow to the same height.The watering process goes as follows. You start watering trees at day 1. During the j-th day you can:   Choose a tree and water it. If the day is odd (e.g. 1,3,5,7,\xe2\x80\xa6), then the height of the tree increases by 1. If the day is even (e.g. 2,4,6,8,\xe2\x80\xa6), then the height of the tree increases by 2.  Or skip a day without watering any tree. Note that you can\'t water more than one tree in a day. Your task is to determine the minimum number of days required to water the trees so they grow to the same height.You have to answer t independent test cases." 1700
1661B "Getting Zero" "bitmasks,brute force,dfs and similar,dp,graphs,greedy,shortest paths" "Suppose you have an integer v. In one operation, you can:   either set v=(v+1)mod32768  or set v=(2\xe2\x8b\x85v)mod32768. You are given n integers a1,a2,\xe2\x80\xa6,an. What is the minimum number of operations you need to make each ai equal to 0?" 1300
1661A "Array Balancing" greedy,math "You are given two arrays of length n: a1,a2,\xe2\x80\xa6,an and b1,b2,\xe2\x80\xa6,bn.You can perform the following operation any number of times:   Choose integer index i (1\xe2\x89\xa4i\xe2\x89\xa4n);  Swap ai and bi. What is the minimum possible sum |a1\xe2\x88\x92a2|+|a2\xe2\x88\x92a3|+\xe2\x8b\xaf+|an\xe2\x88\x921\xe2\x88\x92an| + |b1\xe2\x88\x92b2|+|b2\xe2\x88\x92b3|+\xe2\x8b\xaf+|bn\xe2\x88\x921\xe2\x88\x92bn| (in other words, n\xe2\x88\x921\xe2\x88\x91i=1(|ai\xe2\x88\x92ai+1|+|bi\xe2\x88\x92bi+1|)) you can achieve after performing several (possibly, zero) operations?" 800
1660F2 "Promising String (hard version)" "data structures,implementation,math,strings" "This is the hard version of Problem F. The only difference between the easy version and the hard version is the constraints.We will call a non-empty string balanced if it contains the same number of plus and minus signs. For example: strings ""+--+"" and ""++-+--"" are balanced, and strings ""+--"", ""--"" and """" are not balanced.We will call a string promising if the string can be made balanced by several (possibly zero) uses of the following operation:  replace two adjacent minus signs with one plus sign. In particular, every balanced string is promising. However, the converse is not true: not every promising string is balanced.For example, the string ""-+---"" is promising, because you can replace two adjacent minuses with plus and get a balanced string ""-++-"", or get another balanced string ""-+-+"".How many non-empty substrings of the given string s are promising? Each non-empty promising substring must be counted in the answer as many times as it occurs in string s.Recall that a substring is a sequence of consecutive characters of the string. For example, for string ""+-+"" its substring are: ""+-"", ""-+"", ""+"", ""+-+"" (the string is a substring of itself) and some others. But the following strings are not its substring: ""--"", ""++"", ""-++""." 2100
1660F1 "Promising String (easy version)" "brute force,implementation,math,strings" "This is the easy version of Problem F. The only difference between the easy version and the hard version is the constraints.We will call a non-empty string balanced if it contains the same number of plus and minus signs. For example: strings ""+--+"" and ""++-+--"" are balanced, and strings ""+--"", ""--"" and """" are not balanced.We will call a string promising if the string can be made balanced by several (possibly zero) uses of the following operation:  replace two adjacent minus signs with one plus sign. In particular, every balanced string is promising. However, the converse is not true: not every promising string is balanced.For example, the string ""-+---"" is promising, because you can replace two adjacent minuses with plus and get a balanced string ""-++-"", or get another balanced string ""-+-+"".How many non-empty substrings of the given string s are promising? Each non-empty promising substring must be counted in the answer as many times as it occurs in string s.Recall that a substring is a sequence of consecutive characters of the string. For example, for string ""+-+"" its substring are: ""+-"", ""-+"", ""+"", ""+-+"" (the string is a substring of itself) and some others. But the following strings are not its substring: ""--"", ""++"", ""-++""." 1700
1660E "Matrix and Shifts" "brute force,constructive algorithms,greedy,implementation" "You are given a binary matrix A of size n\xc3\x97n. Rows are numbered from top to bottom from 1 to n, columns are numbered from left to right from 1 to n. The element located at the intersection of row i and column j is called Aij. Consider a set of 4 operations:  Cyclically shift all rows up. The row with index i will be written in place of the row i\xe2\x88\x921 (2\xe2\x89\xa4i\xe2\x89\xa4n), the row with index 1 will be written in place of the row n.  Cyclically shift all rows down. The row with index i will be written in place of the row i+1 (1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921), the row with index n will be written in place of the row 1.  Cyclically shift all columns to the left. The column with index j will be written in place of the column j\xe2\x88\x921 (2\xe2\x89\xa4j\xe2\x89\xa4n), the column with index 1 will be written in place of the column n.  Cyclically shift all columns to the right. The column with index j will be written in place of the column j+1 (1\xe2\x89\xa4j\xe2\x89\xa4n\xe2\x88\x921), the column with index n will be written in place of the column 1.   The 3\xc3\x973 matrix is shown on the left before the 3-rd operation is applied to it, on the right \xe2\x80\x94 after. You can perform an arbitrary (possibly zero) number of operations on the matrix; the operations can be performed in any order.After that, you can perform an arbitrary (possibly zero) number of new xor-operations:  Select any element Aij and assign it with new value Aij\xe2\x8a\x951. In other words, the value of (Aij+1)mod2 will have to be written into element Aij. Each application of this xor-operation costs one burl. Note that the 4 shift operations \xe2\x80\x94 are free. These 4 operations can only be performed before xor-operations are performed.Output the minimum number of burles you would have to pay to make the A matrix unitary. A unitary matrix is a matrix with ones on the main diagonal and the rest of its elements are zeros (that is, Aij=1 if i=j and Aij=0 otherwise)." 1600
1660D "Maximum Product Strikes Back" "brute force,implementation,math,two pointers" "You are given an array a consisting of n integers. For each i (1\xe2\x89\xa4i\xe2\x89\xa4n) the following inequality is true: \xe2\x88\x922\xe2\x89\xa4ai\xe2\x89\xa42.You can remove any number (possibly 0) of elements from the beginning of the array and any number (possibly 0) of elements from the end of the array. You are allowed to delete the whole array.You need to answer the question: how many elements should be removed from the beginning of the array, and how many elements should be removed from the end of the array, so that the result will be an array whose product (multiplication) of elements is maximal. If there is more than one way to get an array with the maximum product of elements on it, you are allowed to output any of them. The product of elements of an empty array (array of length 0) should be assumed to be 1." 1600
1660C "Get an Even String" dp,greedy,strings "A string a=a1a2\xe2\x80\xa6an is called even if it consists of a concatenation (joining) of strings of length 2 consisting of the same characters. In other words, a string a is even if two conditions are satisfied at the same time:  its length n is even;  for all odd i (1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921), ai=ai+1 is satisfied. For example, the following strings are even: """" (empty string), ""tt"", ""aabb"", ""oooo"", and ""ttrrrroouuuuuuuukk"". The following strings are not even: ""aaa"", ""abab"" and ""abba"".Given a string s consisting of lowercase Latin letters. Find the minimum number of characters to remove from the string s to make it even. The deleted characters do not have to be consecutive." 1300
1660B "Vlad and Candies" math "Not so long ago, Vlad had a birthday, for which he was presented with a package of candies. There were n types of candies, there are ai candies of the type i (1\xe2\x89\xa4i\xe2\x89\xa4n).Vlad decided to eat exactly one candy every time, choosing any of the candies of a type that is currently the most frequent (if there are several such types, he can choose any of them). To get the maximum pleasure from eating, Vlad does not want to eat two candies of the same type in a row.Help him figure out if he can eat all the candies without eating two identical candies in a row." 800
1660A "Vasya and Coins" greedy,math "Vasya decided to go to the grocery store. He found in his wallet a coins of 1 burle and b coins of 2 burles. He does not yet know the total cost of all goods, so help him find out s (s>0): the minimum positive integer amount of money he cannot pay without change or pay at all using only his coins.For example, if a=1 and b=1 (he has one 1-burle coin and one 2-burle coin), then:  he can pay 1 burle without change, paying with one 1-burle coin,  he can pay 2 burle without change, paying with one 2-burle coin,  he can pay 3 burle without change by paying with one 1-burle coin and one 2-burle coin,  he cannot pay 4 burle without change (moreover, he cannot pay this amount at all). So for a=1 and b=1 the answer is s=4." 800
1659F "Tree and Permutation Game" "dfs and similar,games,graphs,trees" "There is a tree of n vertices and a permutation p of size n. A token is present on vertex x of the tree.Alice and Bob are playing a game. Alice is in control of the permutation p, and Bob is in control of the token on the tree. In Alice\'s turn, she must pick two distinct numbers u and v (not positions; u\xe2\x89\xa0v), such that the token is neither at vertex u nor vertex v on the tree, and swap their positions in the permutation p. In Bob\'s turn, he must move the token to an adjacent vertex from the one it is currently on.Alice wants to sort the permutation in increasing order. Bob wants to prevent that. Alice wins if the permutation is sorted in increasing order at the beginning or end of her turn. Bob wins if he can make the game go on for an infinite number of moves (which means that Alice is never able to get a sorted permutation). Both players play optimally. Alice makes the first move.Given the tree, the permutation p, and the vertex x on which the token initially is, find the winner of the game." 3000
1659E "AND-MEX Walk" "bitmasks,brute force,constructive algorithms,dfs and similar,dsu,graphs" "There is an undirected, connected graph with n vertices and m weighted edges. A walk from vertex u to vertex v is defined as a sequence of vertices p1,p2,\xe2\x80\xa6,pk (which are not necessarily distinct) starting with u and ending with v, such that pi and pi+1 are connected by an edge for 1\xe2\x89\xa4i<k.We define the length of a walk as follows: take the ordered sequence of edges and write down the weights on each of them in an array. Now, write down the bitwise AND of every nonempty prefix of this array. The length of the walk is the MEX of all these values.More formally, let us have [w1,w2,\xe2\x80\xa6,wk\xe2\x88\x921] where wi is the weight of the edge between pi and pi+1. Then the length of the walk is given by MEX({w1,w1&w2,\xe2\x80\xa6,w1&w2&\xe2\x80\xa6&wk\xe2\x88\x921}), where & denotes the bitwise AND operation.Now you must process q queries of the form u v. For each query, find the minimum possible length of a walk from u to v.The MEX (minimum excluded) of a set is the smallest non-negative integer that does not belong to the set. For instance:   The MEX of {2,1} is 0, because 0 does not belong to the set.  The MEX of {3,1,0} is 2, because 0 and 1 belong to the set, but 2 does not.  The MEX of {0,3,1,2} is 4 because 0, 1, 2 and 3 belong to the set, but 4 does not." 2200
1659D "Reverse Sort Sum" "constructive algorithms,data structures,greedy,implementation,math,two pointers" "Suppose you had an array A of n elements, each of which is 0 or 1.Let us define a function f(k,A) which returns another array B, the result of sorting the first k elements of A in non-decreasing order. For example, f(4,[0,1,1,0,0,1,0])=[0,0,1,1,0,1,0]. Note that the first 4 elements were sorted.Now consider the arrays B1,B2,\xe2\x80\xa6,Bn generated by f(1,A),f(2,A),\xe2\x80\xa6,f(n,A). Let C be the array obtained by taking the element-wise sum of B1,B2,\xe2\x80\xa6,Bn.For example, let A=[0,1,0,1]. Then we have B1=[0,1,0,1], B2=[0,1,0,1], B3=[0,0,1,1], B4=[0,0,1,1]. Then C=B1+B2+B3+B4=[0,1,0,1]+[0,1,0,1]+[0,0,1,1]+[0,0,1,1]=[0,2,2,4].You are given C. Determine a binary array A that would give C when processed as above. It is guaranteed that an array A exists for given C in the input." 1900
1659C "Line Empire" "binary search,brute force,dp,greedy,implementation,math" "You are an ambitious king who wants to be the Emperor of The Reals. But to do that, you must first become Emperor of The Integers.Consider a number axis. The capital of your empire is initially at 0. There are n unconquered kingdoms at positions 0<x1<x2<\xe2\x80\xa6<xn. You want to conquer all other kingdoms.There are two actions available to you:   You can change the location of your capital (let its current position be c1) to any other conquered kingdom (let its position be c2) at a cost of a\xe2\x8b\x85|c1\xe2\x88\x92c2|.  From the current capital (let its current position be c1) you can conquer an unconquered kingdom (let its position be c2) at a cost of b\xe2\x8b\x85|c1\xe2\x88\x92c2|. You cannot conquer a kingdom if there is an unconquered kingdom between the target and your capital. Note that you cannot place the capital at a point without a kingdom. In other words, at any point, your capital can only be at 0 or one of x1,x2,\xe2\x80\xa6,xn. Also note that conquering a kingdom does not change the position of your capital.Find the minimum total cost to conquer all kingdoms. Your capital can be anywhere at the end." 1500
1659B "Bit Flipping" "bitmasks,constructive algorithms,greedy,strings" "You are given a binary string of length n. You have exactly k moves. In one move, you must select a single bit. The state of all bits except that bit will get flipped (0 becomes 1, 1 becomes 0). You need to output the lexicographically largest string that you can get after using all k moves. Also, output the number of times you will select each bit. If there are multiple ways to do this, you may output any of them.A binary string a is lexicographically larger than a binary string b of the same length, if and only if the following holds:   in the first position where a and b differ, the string a contains a 1, and the string b contains a 0." 1300
1659A "Red Versus Blue" "constructive algorithms,greedy,implementation,math" "Team Red and Team Blue competed in a competitive FPS. Their match was streamed around the world. They played a series of n matches.In the end, it turned out Team Red won r times and Team Blue won b times. Team Blue was less skilled than Team Red, so b was strictly less than r.You missed the stream since you overslept, but you think that the match must have been neck and neck since so many people watched it. So you imagine a string of length n where the i-th character denotes who won the i-th match  \xe2\x80\x94 it is R if Team Red won or B if Team Blue won. You imagine the string was such that the maximum number of times a team won in a row was as small as possible. For example, in the series of matches RBBRRRB, Team Red won 3 times in a row, which is the maximum.You must find a string satisfying the above conditions. If there are multiple answers, print any." 1000
1658F "Juju and Binary String" "brute force,constructive algorithms,greedy,math" "The cuteness of a binary string is the number of 1s divided by the length of the string. For example, the cuteness of 01101 is 35.Juju has a binary string s of length n. She wants to choose some non-intersecting subsegments of s such that their concatenation has length m and it has the same cuteness as the string s. More specifically, she wants to find two arrays l and r of equal length k such that 1\xe2\x89\xa4l1\xe2\x89\xa4r1<l2\xe2\x89\xa4r2<\xe2\x80\xa6<lk\xe2\x89\xa4rk\xe2\x89\xa4n, and also:  k\xe2\x88\x91i=1(ri\xe2\x88\x92li+1)=m;  The cuteness of s[l1,r1]+s[l2,r2]+\xe2\x80\xa6+s[lk,rk] is equal to the cuteness of s, where s[x,y] denotes the subsegment sxsx+1\xe2\x80\xa6sy, and + denotes string concatenation. Juju does not like splitting the string into many parts, so she also wants to minimize the value of k. Find the minimum value of k such that there exist l and r that satisfy the constraints above or determine that it is impossible to find such l and r for any k." 2700
1658E "Gojou and Matrix Game" "data structures,dp,games,hashing,implementation,math,number theory,sortings" "Marin feels exhausted after a long day of cosplay, so Gojou invites her to play a game!Marin and Gojou take turns to place one of their tokens on an n\xc3\x97n grid with Marin starting first. There are some restrictions and allowances on where to place tokens:   Apart from the first move, the token placed by a player must be more than Manhattan distance k away from the previous token placed on the matrix. In other words, if a player places a token at (x1,y1), then the token placed by the other player in the next move must be in a cell (x2,y2) satisfying |x2\xe2\x88\x92x1|+|y2\xe2\x88\x92y1|>k.  Apart from the previous restriction, a token can be placed anywhere on the matrix, including cells where tokens were previously placed by any player. Whenever a player places a token on cell (x,y), that player gets vx, y points. All values of v on the grid are distinct. You still get points from a cell even if tokens were already placed onto the cell. The game finishes when each player makes 10100 moves.Marin and Gojou will play n2 games. For each cell of the grid, there will be exactly one game where Marin places a token on that cell on her first move. Please answer for each game, if Marin and Gojou play optimally (after Marin\'s first move), who will have more points at the end? Or will the game end in a draw (both players have the same points at the end)?" 2500
1658D2 "388535 (Hard Version)" "bitmasks,brute force,data structures,math" "This is the hard version of the problem. The difference in the constraints between both versions are colored below in red. You can make hacks only if all versions of the problem are solved.Marin and Gojou are playing hide-and-seek with an array.Gojou initially perform the following steps:   First, Gojou chooses 2 integers l and r such that l\xe2\x89\xa4r.  Then, Gojou will make an array a of length r\xe2\x88\x92l+1 which is a permutation of the array [l,l+1,\xe2\x80\xa6,r].  Finally, Gojou chooses a secret integer x and sets ai to ai\xe2\x8a\x95x for all i (where \xe2\x8a\x95 denotes the bitwise XOR operation). Marin is then given the values of l,r and the final array a. She needs to find the secret integer x to win. Can you help her?Note that there may be multiple possible x that Gojou could have chosen. Marin can find any possible x that could have resulted in the final value of a." 2300
1658D1 "388535 (Easy Version)" bitmasks,math "This is the easy version of the problem. The difference in the constraints between both versions is colored below in red. You can make hacks only if all versions of the problem are solved.Marin and Gojou are playing hide-and-seek with an array.Gojou initially performs the following steps:   First, Gojou chooses 2 integers l and r such that l\xe2\x89\xa4r.  Then, Gojou makes an array a of length r\xe2\x88\x92l+1 which is a permutation of the array [l,l+1,\xe2\x80\xa6,r].  Finally, Gojou chooses a secret integer x and sets ai to ai\xe2\x8a\x95x for all i (where \xe2\x8a\x95 denotes the bitwise XOR operation). Marin is then given the values of l,r and the final array a. She needs to find the secret integer x to win. Can you help her?Note that there may be multiple possible x that Gojou could have chosen. Marin can find any possible x that could have resulted in the final value of a." 1600
1658C "Shinju and the Lost Permutation" "constructive algorithms,math" "Shinju loves permutations very much! Today, she has borrowed a permutation p from Juju to play with.The i-th cyclic shift of a permutation p is a transformation on the permutation such that p=[p1,p2,\xe2\x80\xa6,pn] will now become p=[pn\xe2\x88\x92i+1,\xe2\x80\xa6,pn,p1,p2,\xe2\x80\xa6,pn\xe2\x88\x92i].Let\'s define the power of permutation p as the number of distinct elements in the prefix maximums array b of the permutation. The prefix maximums array b is the array of length n such that bi=max(p1,p2,\xe2\x80\xa6,pi). For example, the power of [1,2,5,4,6,3] is 4 since b=[1,2,5,5,6,6] and there are 4 distinct elements in b.Unfortunately, Shinju has lost the permutation p! The only information she remembers is an array c, where ci is the power of the (i\xe2\x88\x921)-th cyclic shift of the permutation p. She\'s also not confident that she remembers it correctly, so she wants to know if her memory is good enough.Given the array c, determine if there exists a permutation p that is consistent with c. You do not have to construct the permutation p.A permutation is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array) and [1,3,4] is also not a permutation (n=3 but there is 4 in the array)." 1700
1658B "Marin and Anti-coprime Permutation" "combinatorics,math,number theory" "Marin wants you to count number of permutations that are beautiful. A beautiful permutation of length n is a permutation that has the following property: gcd(1\xe2\x8b\x85p1,2\xe2\x8b\x85p2,\xe2\x80\xa6,n\xe2\x8b\x85pn)>1, where gcd is the greatest common divisor.A permutation is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array) and [1,3,4] is also not a permutation (n=3 but there is 4 in the array)." 800
1658A "Marin and Photoshoot" "constructive algorithms,implementation,math" "Today, Marin is at a cosplay exhibition and is preparing for a group photoshoot!For the group picture, the cosplayers form a horizontal line. A group picture is considered beautiful if for every contiguous segment of at least 2 cosplayers, the number of males does not exceed the number of females (obviously).Currently, the line has n cosplayers which can be described by a binary string s. The i-th cosplayer is male if si=0 and female if si=1. To ensure that the line is beautiful, you can invite some additional cosplayers (possibly zero) to join the line at any position. You can\'t remove any cosplayer from the line.Marin wants to know the minimum number of cosplayers you need to invite so that the group picture of all the cosplayers is beautiful. She can\'t do this on her own, so she\'s asking you for help. Can you help her?" 800
1657F "Words on Tree" "2-sat,dfs and similar,dsu,graphs,trees" "You are given a tree consisting of n vertices, and q triples (xi,yi,si), where xi and yi are integers from 1 to n, and si is a string with length equal to the number of vertices on the simple path from xi to yi.You want to write a lowercase Latin letter on each vertex in such a way that, for each of q given triples, at least one of the following conditions holds:  if you write out the letters on the vertices on the simple path from xi to yi in the order they appear on this path, you get the string si;  if you write out the letters on the vertices on the simple path from yi to xi in the order they appear on this path, you get the string si. Find any possible way to write a letter on each vertex to meet these constraints, or report that it is impossible." 2600
1657E "Star MST" "combinatorics,dp,graph matchings,math" "In this problem, we will consider complete undirected graphs consisting of n vertices with weighted edges. The weight of each edge is an integer from 1 to k.An undirected graph is considered beautiful if the sum of weights of all edges incident to vertex 1 is equal to the weight of MST in the graph. MST is the minimum spanning tree \xe2\x80\x94 a tree consisting of n\xe2\x88\x921 edges of the graph, which connects all n vertices and has the minimum sum of weights among all such trees; the weight of MST is the sum of weights of all edges in it.Calculate the number of complete beautiful graphs having exactly n vertices and the weights of edges from 1 to k. Since the answer might be large, print it modulo 998244353." 2200
1657D "For Gamers. By Gamers." "binary search,brute force,greedy,math,sortings" "Monocarp is playing a strategy game. In the game, he recruits a squad to fight monsters. Before each battle, Monocarp has C coins to spend on his squad.Before each battle starts, his squad is empty. Monocarp chooses one type of units and recruits no more units of that type than he can recruit with C coins.There are n types of units. Every unit type has three parameters:   ci \xe2\x80\x94 the cost of recruiting one unit of the i-th type;  di \xe2\x80\x94 the damage that one unit of the i-th type deals in a second;  hi \xe2\x80\x94 the amount of health of one unit of the i-th type. Monocarp has to face m monsters. Every monster has two parameters:   Dj \xe2\x80\x94 the damage that the j-th monster deals in a second;  Hj \xe2\x80\x94 the amount of health the j-th monster has. Monocarp has to fight only the j-th monster during the j-th battle. He wants all his recruited units to stay alive. Both Monocarp\'s squad and the monster attack continuously (not once per second) and at the same time. Thus, Monocarp wins the battle if and only if his squad kills the monster strictly faster than the monster kills one of his units. The time is compared with no rounding.For each monster, Monocarp wants to know the minimum amount of coins he has to spend to kill that monster. If this amount is greater than C, then report that it\'s impossible to kill that monster." 2000
1657C "Bracket Sequence Deletion" greedy,implementation "You are given a bracket sequence consisting of n characters \'(\' and/or )\'. You perform several operations with it.During one operation, you choose the shortest prefix of this string (some amount of first characters of the string) that is good and remove it from the string.The prefix is considered good if one of the following two conditions is satisfied:  this prefix is a regular bracket sequence;  this prefix is a palindrome of length at least two. A bracket sequence is called regular if it is possible to obtain a correct arithmetic expression by inserting characters \'+\' and \'1\' into this sequence. For example, sequences (())(), () and (()(())) are regular, while )(, (() and (()))( are not.The bracket sequence is called palindrome if it reads the same back and forth. For example, the bracket sequences )), (( and )(() are palindromes, while bracket sequences (), )( and ))( are not palindromes.You stop performing the operations when it\'s not possible to find a good prefix. Your task is to find the number of operations you will perform on the given string and the number of remaining characters in the string.You have to answer t independent test cases." 1200
1657B "XY Sequence" greedy "You are given four integers n, B, x and y. You should build a sequence a0,a1,a2,\xe2\x80\xa6,an where a0=0 and for each i\xe2\x89\xa51 you can choose:   either ai=ai\xe2\x88\x921+x  or ai=ai\xe2\x88\x921\xe2\x88\x92y. Your goal is to build such a sequence a that ai\xe2\x89\xa4B for all i and n\xe2\x88\x91i=0ai is maximum possible." 800
1657A "Integer Moves" "brute force,math" "There\'s a chip in the point (0,0) of the coordinate plane. In one operation, you can move the chip from some point (x1,y1) to some point (x2,y2) if the Euclidean distance between these two points is an integer (i.e. \xe2\x88\x9a(x1\xe2\x88\x92x2)2+(y1\xe2\x88\x92y2)2 is integer).Your task is to determine the minimum number of operations required to move the chip from the point (0,0) to the point (x,y)." 800
1656I "Neighbour Ordering" "constructive algorithms,graphs" "Given an undirected graph G, we say that a neighbour ordering is an ordered list of all the neighbours of a vertex for each of the vertices of G. Consider a given neighbour ordering of G and three vertices u, v and w, such that v is a neighbor of u and w. We write u<vw if u comes after w in v\'s neighbor list.A neighbour ordering is said to be good if, for each simple cycle v1,v2,\xe2\x80\xa6,vc of the graph, one of the following is satisfied:  v1<v2v3,v2<v3v4,\xe2\x80\xa6,vc\xe2\x88\x922<vc\xe2\x88\x921vc,vc\xe2\x88\x921<vcv1,vc<v1v2. v1>v2v3,v2>v3v4,\xe2\x80\xa6,vc\xe2\x88\x922>vc\xe2\x88\x921vc,vc\xe2\x88\x921>vcv1,vc>v1v2. Given a graph G, determine whether there exists a good neighbour ordering for it and construct one if it does." 3500
1656H "Equal LCM Subsets" "data structures,math,number theory" "You are given two sets of positive integers A and B. You have to find two non-empty subsets SA\xe2\x8a\x86A, SB\xe2\x8a\x86B so that the least common multiple (LCM) of the elements of SA is equal to the least common multiple (LCM) of the elements of SB." 3200
1656G "Cycle Palindrome" "constructive algorithms,graphs,math" "We say that a sequence of n integers a1,a2,\xe2\x80\xa6,an is a palindrome if for all 1\xe2\x89\xa4i\xe2\x89\xa4n, ai=an\xe2\x88\x92i+1. You are given a sequence of n integers a1,a2,\xe2\x80\xa6,an and you have to find, if it exists, a cycle permutation \xcf\x83 so that the sequence a\xcf\x83(1),a\xcf\x83(2),\xe2\x80\xa6,a\xcf\x83(n) is a palindrome. A permutation of 1,2,\xe2\x80\xa6,n is a bijective function from {1,2,\xe2\x80\xa6,n} to {1,2,\xe2\x80\xa6,n}. We say that a permutation \xcf\x83 is a cycle permutation if 1,\xcf\x83(1),\xcf\x832(1),\xe2\x80\xa6,\xcf\x83n\xe2\x88\x921(1) are pairwise different numbers. Here \xcf\x83m(1) denotes \xcf\x83(\xcf\x83(\xe2\x80\xa6\xcf\x83\xe2\x8f\x9fm times(1)\xe2\x80\xa6))." 3200
1656F "Parametric MST" "binary search,constructive algorithms,graphs,greedy,math,sortings" "You are given n integers a1,a2,\xe2\x80\xa6,an. For any real number t, consider the complete weighted graph on n vertices Kn(t) with weight of the edge between vertices i and j equal to wij(t)=ai\xe2\x8b\x85aj+t\xe2\x8b\x85(ai+aj). Let f(t) be the cost of the minimum spanning tree of Kn(t). Determine whether f(t) is bounded above and, if so, output the maximum value it attains." 2600
1656E "Equal Tree Sums" "constructive algorithms,dfs and similar,math,trees" "You are given an undirected unrooted tree, i.e. a connected undirected graph without cycles.You must assign a nonzero integer weight to each vertex so that the following is satisfied: if any vertex of the tree is removed, then each of the remaining connected components has the same sum of weights in its vertices." 2200
1656D K-good "constructive algorithms,math,number theory" "We say that a positive integer n is k-good for some positive integer k if n can be expressed as a sum of k positive integers which give k distinct remainders when divided by k.Given a positive integer n, find some k\xe2\x89\xa52 so that n is k-good or tell that such a k does not exist." 1900
1656C "Make Equal With Mod" "constructive algorithms,math,number theory,sortings" "You are given an array of n non-negative integers a1,a2,\xe2\x80\xa6,an. You can make the following operation: choose an integer x\xe2\x89\xa52 and replace each number of the array by the remainder when dividing that number by x, that is, for all 1\xe2\x89\xa4i\xe2\x89\xa4n set ai to aimodx.Determine if it is possible to make all the elements of the array equal by applying the operation zero or more times." 1200
1656B "Subtract Operation" "data structures,greedy,math,two pointers" "You are given a list of n integers. You can perform the following operation: you choose an element x from the list, erase x from the list, and subtract the value of x from all the remaining elements. Thus, in one operation, the length of the list is decreased by exactly 1.Given an integer k (k>0), find if there is some sequence of n\xe2\x88\x921 operations such that, after applying the operations, the only remaining element of the list is equal to k." 1100
1656A "Good Pairs" math,sortings "You are given an array a1,a2,\xe2\x80\xa6,an of positive integers. A good pair is a pair of indices (i,j) with 1\xe2\x89\xa4i,j\xe2\x89\xa4n such that, for all 1\xe2\x89\xa4k\xe2\x89\xa4n, the following equality holds:|ai\xe2\x88\x92ak|+|ak\xe2\x88\x92aj|=|ai\xe2\x88\x92aj|, where |x| denotes the absolute value of x.Find a good pair. Note that i can be equal to j." 800
1654H "Three Minimums" "combinatorics,constructive algorithms,divide and conquer,dp,fft,math" "Given a list of distinct values, we denote with first minimum, second minimum, and third minimum the three smallest values (in increasing order).A permutation p1,p2,\xe2\x80\xa6,pn is good if the following statement holds for all pairs (l,r) with 1\xe2\x89\xa4l<l+2\xe2\x89\xa4r\xe2\x89\xa4n.   If {pl,pr} are (not necessarily in this order) the first and second minimum of pl,pl+1,\xe2\x80\xa6,pr then the third minimum of pl,pl+1,\xe2\x80\xa6,pr is either pl+1 or pr\xe2\x88\x921. You are given an integer n and a string s of length m consisting of characters ""<"" and "">"".Count the number of good permutations p1,p2,\xe2\x80\xa6,pn such that, for all 1\xe2\x89\xa4i\xe2\x89\xa4m,   pi<pi+1 if si= ""<"";  pi>pi+1 if si= "">"".  As the result can be very large, you should print it modulo 998244353." 3500
1654G "Snowy Mountain" "data structures,dfs and similar,graphs,greedy,shortest paths,trees" "There are n locations on a snowy mountain range (numbered from 1 to n), connected by n\xe2\x88\x921 trails in the shape of a tree. Each trail has length 1. Some of the locations are base lodges. The height hi of each location is equal to the distance to the nearest base lodge (a base lodge has height 0).There is a skier at each location, each skier has initial kinetic energy 0. Each skier wants to ski along as many trails as possible. Suppose that the skier is skiing along a trail from location i to j. Skiers are not allowed to ski uphill (i.e., if hi<hj). It costs one unit of kinetic energy to ski along flat ground (i.e., if hi=hj), and a skier gains one unit of kinetic energy by skiing downhill (i.e., if hi>hj). For each location, compute the length of the longest sequence of trails that the skier starting at that location can ski along without their kinetic energy ever becoming negative. Skiers are allowed to visit the same location or trail multiple times." 2900
1654F "Minimal String Xoration" "bitmasks,data structures,divide and conquer,greedy,hashing,sortings,strings" "You are given an integer n and a string s consisting of 2n lowercase letters of the English alphabet. The characters of the string s are s0s1s2\xe2\x8b\xafs2n\xe2\x88\x921.A string t of length 2n (whose characters are denoted by t0t1t2\xe2\x8b\xaft2n\xe2\x88\x921) is a xoration of s if there exists an integer j (0\xe2\x89\xa4j\xe2\x89\xa42n\xe2\x88\x921) such that, for each 0\xe2\x89\xa4i\xe2\x89\xa42n\xe2\x88\x921, ti=si\xe2\x8a\x95j (where \xe2\x8a\x95 denotes the operation bitwise XOR).Find the lexicographically minimal xoration of s.A string a is lexicographically smaller than a string b if and only if one of the following holds:   a is a prefix of b, but a\xe2\x89\xa0b;  in the first position where a and b differ, the string a has a letter that appears earlier in the alphabet than the corresponding letter in b." 2800
1654E "Arithmetic Operations" "brute force,data structures,graphs,math" "You are given an array of integers a1,a2,\xe2\x80\xa6,an.You can do the following operation any number of times (possibly zero):   Choose any index i and set ai to any integer (positive, negative or 0). What is the minimum number of operations needed to turn a into an arithmetic progression? The array a is an arithmetic progression if ai+1\xe2\x88\x92ai=ai\xe2\x88\x92ai\xe2\x88\x921 for any 2\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921." 2300
1654D "Potion Brewing Class" "dfs and similar,math,number theory,trees" "Alice\'s potion making professor gave the following assignment to his students: brew a potion using n ingredients, such that the proportion of ingredient i in the final potion is ri>0 (and r1+r2+\xe2\x8b\xaf+rn=1).He forgot the recipe, and now all he remembers is a set of n\xe2\x88\x921 facts of the form, ""ingredients i and j should have a ratio of x to y"" (i.e., if ai and aj are the amounts of ingredient i and j in the potion respectively, then it must hold ai/aj=x/y), where x and y are positive integers. However, it is guaranteed that the set of facts he remembers is sufficient to uniquely determine the original values ri.He decided that he will allow the students to pass the class as long as they submit a potion which satisfies all of the n\xe2\x88\x921 requirements (there may be many such satisfactory potions), and contains a positive integer amount of each ingredient.Find the minimum total amount of ingredients needed to make a potion which passes the class. As the result can be very large, you should print the answer modulo 998244353." 2100
1654C "Alice and the Cake" "data structures,greedy,implementation,sortings" "Alice has a cake, and she is going to cut it. She will perform the following operation n\xe2\x88\x921 times: choose a piece of the cake (initially, the cake is all one piece) with weight w\xe2\x89\xa52 and cut it into two smaller pieces of weight \xe2\x8c\x8aw2\xe2\x8c\x8b and \xe2\x8c\x88w2\xe2\x8c\x89 (\xe2\x8c\x8ax\xe2\x8c\x8b and \xe2\x8c\x88x\xe2\x8c\x89 denote floor and ceiling functions, respectively).After cutting the cake in n pieces, she will line up these n pieces on a table in an arbitrary order. Let ai be the weight of the i-th piece in the line.You are given the array a. Determine whether there exists an initial weight and sequence of operations which results in a." 1400
1654B "Prefix Removals" strings "You are given a string s consisting of lowercase letters of the English alphabet. You must perform the following algorithm on s:  Let x be the length of the longest prefix of s which occurs somewhere else in s as a contiguous substring (the other occurrence may also intersect the prefix). If x=0, break. Otherwise, remove the first x characters of s, and repeat. A prefix is a string consisting of several first letters of a given string, without any reorders. An empty prefix is also a valid prefix. For example, the string ""abcd"" has 5 prefixes: empty string, ""a"", ""ab"", ""abc"" and ""abcd"".For instance, if we perform the algorithm on s= ""abcabdc"",   Initially, ""ab"" is the longest prefix that also appears somewhere else as a substring in s, so s= ""cabdc"" after 1 operation.  Then, ""c"" is the longest prefix that also appears somewhere else as a substring in s, so s= ""abdc"" after 2 operations.  Now x=0 (because there are no non-empty prefixes of ""abdc"" that also appear somewhere else as a substring in s), so the algorithm terminates. Find the final state of the string after performing the algorithm." 800
1654A "Maximum Cake Tastiness" "brute force,greedy,implementation,sortings" "There are n pieces of cake on a line. The i-th piece of cake has weight ai (1\xe2\x89\xa4i\xe2\x89\xa4n).The tastiness of the cake is the maximum total weight of two adjacent pieces of cake (i. e., max(a1+a2,a2+a3,\xe2\x80\xa6,an\xe2\x88\x921+an)).You want to maximize the tastiness of the cake. You are allowed to do the following operation at most once (doing more operations would ruin the cake):   Choose a contiguous subsegment a[l,r] of pieces of cake (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n), and reverse it. The subsegment a[l,r] of the array a is the sequence al,al+1,\xe2\x80\xa6,ar.If you reverse it, the array will become a1,a2,\xe2\x80\xa6,al\xe2\x88\x922,al\xe2\x88\x921,ar_,ar\xe2\x88\x921_,\xe2\x80\xa6_,al+1_,al_,ar+1,ar+2,\xe2\x80\xa6,an\xe2\x88\x921,an.For example, if the weights are initially [5,2,1,4,7,3], you can reverse the subsegment a[2,5], getting [5,7_,4_,1_,2_,3]. The tastiness of the cake is now 5+7=12 (while before the operation the tastiness was 4+7=11).Find the maximum tastiness of the cake after doing the operation at most once." 800
1651F "Tower Defense" "binary search,brute force,data structures" "Monocarp is playing a tower defense game. A level in the game can be represented as an OX axis, where each lattice point from 1 to n contains a tower in it.The tower in the i-th point has ci mana capacity and ri mana regeneration rate. In the beginning, before the 0-th second, each tower has full mana. If, at the end of some second, the i-th tower has x mana, then it becomes min(x+ri,ci) mana for the next second.There are q monsters spawning on a level. The j-th monster spawns at point 1 at the beginning of tj-th second, and it has hj health. Every monster is moving 1 point per second in the direction of increasing coordinate.When a monster passes the tower, the tower deals min(H,M) damage to it, where H is the current health of the monster and M is the current mana amount of the tower. This amount gets subtracted from both monster\'s health and tower\'s mana.Unfortunately, sometimes some monsters can pass all n towers and remain alive. Monocarp wants to know what will be the total health of the monsters after they pass all towers." 3000
1651E "Sum of Matchings" "brute force,combinatorics,constructive algorithms,dfs and similar,graph matchings,greedy,math" "Let\'s denote the size of the maximum matching in a graph G as MM(G).You are given a bipartite graph. The vertices of the first part are numbered from 1 to n, the vertices of the second part are numbered from n+1 to 2n. Each vertex\'s degree is 2.For a tuple of four integers (l,r,L,R), where 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n and n+1\xe2\x89\xa4L\xe2\x89\xa4R\xe2\x89\xa42n, let\'s define G\xe2\x80\xb2(l,r,L,R) as the graph which consists of all vertices of the given graph that are included in the segment [l,r] or in the segment [L,R], and all edges of the given graph such that each of their endpoints belongs to one of these segments. In other words, to obtain G\xe2\x80\xb2(l,r,L,R) from the original graph, you have to remove all vertices i such that i\xe2\x88\x89[l,r] and i\xe2\x88\x89[L,R], and all edges incident to these vertices.Calculate the sum of MM(G(l,r,L,R)) over all tuples of integers (l,r,L,R) having 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n and n+1\xe2\x89\xa4L\xe2\x89\xa4R\xe2\x89\xa42n." 2600
1651D "Nearest Excluded Points" "binary search,data structures,dfs and similar,graphs,shortest paths" "You are given n distinct points on a plane. The coordinates of the i-th point are (xi,yi).For each point i, find the nearest (in terms of Manhattan distance) point with integer coordinates that is not among the given n points. If there are multiple such points \xe2\x80\x94 you can choose any of them.The Manhattan distance between two points (x1,y1) and (x2,y2) is |x1\xe2\x88\x92x2|+|y1\xe2\x88\x92y2|." 1900
1651C "Fault-tolerant Network" "brute force,data structures,implementation" "There is a classroom with two rows of computers. There are n computers in each row and each computer has its own grade. Computers in the first row has grades a1,a2,\xe2\x80\xa6,an and in the second row \xe2\x80\x94 b1,b2,\xe2\x80\xa6,bn.Initially, all pairs of neighboring computers in each row are connected by wire (pairs (i,i+1) for all 1\xe2\x89\xa4i<n), so two rows form two independent computer networks.Your task is to combine them in one common network by connecting one or more pairs of computers from different rows. Connecting the i-th computer from the first row and the j-th computer from the second row costs |ai\xe2\x88\x92bj|.You can connect one computer to several other computers, but you need to provide at least a basic fault tolerance: you need to connect computers in such a way that the network stays connected, despite one of its computer failing. In other words, if one computer is broken (no matter which one), the network won\'t split in two or more parts.That is the minimum total cost to make a fault-tolerant network?" 1500
1651B "Prove Him Wrong" "constructive algorithms,greedy" "Recently, your friend discovered one special operation on an integer array a:   Choose two indices i and j (i\xe2\x89\xa0j);  Set ai=aj=|ai\xe2\x88\x92aj|. After playing with this operation for a while, he came to the next conclusion:   For every array a of n integers, where 1\xe2\x89\xa4ai\xe2\x89\xa4109, you can find a pair of indices (i,j) such that the total sum of a will decrease after performing the operation. This statement sounds fishy to you, so you want to find a counterexample for a given integer n. Can you find such counterexample and prove him wrong?In other words, find an array a consisting of n integers a1,a2,\xe2\x80\xa6,an (1\xe2\x89\xa4ai\xe2\x89\xa4109) such that for all pairs of indices (i,j) performing the operation won\'t decrease the total sum (it will increase or not change the sum)." 800
1651A Playoff implementation "Consider a playoff tournament where 2n athletes compete. The athletes are numbered from 1 to 2n.The tournament is held in n stages. In each stage, the athletes are split into pairs in such a way that each athlete belongs exactly to one pair. In each pair, the athletes compete against each other, and exactly one of them wins. The winner of each pair advances to the next stage, the athlete who was defeated gets eliminated from the tournament.The pairs are formed as follows:  in the first stage, athlete 1 competes against athlete 2; 3 competes against 4; 5 competes against 6, and so on;  in the second stage, the winner of the match ""1\xe2\x80\x932"" competes against the winner of the match ""3\xe2\x80\x934""; the winner of the match ""5\xe2\x80\x936"" competes against the winner of the match ""7\xe2\x80\x938"", and so on;  the next stages are held according to the same rules. When athletes x and y compete, the winner is decided as follows:  if x+y is odd, the athlete with the lower index wins (i.\xe2\x80\x89e. if x<y, then x wins, otherwise y wins);  if x+y is even, the athlete with the higher index wins. The following picture describes the way the tournament with n=3 goes.  Your task is the following one: given the integer n, determine the index of the athlete who wins the tournament." 800
1650G "Counting Shortcuts" "data structures,dfs and similar,dp,graphs,shortest paths" "Given an undirected connected graph with n vertices and m edges. The graph contains no loops (edges from a vertex to itself) and multiple edges (i.e. no more than one edge between each pair of vertices). The vertices of the graph are numbered from 1 to n. Find the number of paths from a vertex s to t whose length differs from the shortest path from s to t by no more than 1. It is necessary to consider all suitable paths, even if they pass through the same vertex or edge more than once (i.e. they are not simple).  Graph consisting of 6 of vertices and 8 of edges For example, let n=6, m=8, s=6 and t=1, and let the graph look like the figure above. Then the length of the shortest path from s to t is 1. Consider all paths whose length is at most 1+1=2.   6\xe2\x86\x921. The length of the path is 1.  6\xe2\x86\x924\xe2\x86\x921. Path length is 2.  6\xe2\x86\x922\xe2\x86\x921. Path length is 2.  6\xe2\x86\x925\xe2\x86\x921. Path length is 2. There is a total of 4 of matching paths." 2100
1650F "Vitaly and Advanced Useless Algorithms" dp,greedy,implementation "Vitaly enrolled in the course Advanced Useless Algorithms. The course consists of n tasks. Vitaly calculated that he has ai hours to do the task i from the day he enrolled in the course. That is, the deadline before the i-th task is ai hours. The array a is sorted in ascending order, in other words, the job numbers correspond to the order in which the assignments are turned in.Vitaly does everything conscientiously, so he wants to complete each task by 100 percent, or more. Initially, his completion rate for each task is 0 percent.Vitaly has m training options, each option can be used not more than once. The ith option is characterized by three integers: ei,ti and pi. If Vitaly uses the ith option, then after ti hours (from the current moment) he will increase the progress of the task ei by pi percent. For example, let Vitaly have 3 of tasks to complete. Let the array a have the form: a=[5,7,8]. Suppose Vitaly has 5 of options: [e1=1,t1=1,p1=30], [e2=2,t2=3,p2=50], [e3=2,t3=3,p3=100], [e4=1,t4=1,p4=80], [e5=3,t5=3,p5=100]. Then, if Vitaly prepares in the following way, he will be able to complete everything in time:   Vitaly chooses the 4-th option. Then in 1 hour, he will complete the 1-st task at 80 percent. He still has 4 hours left before the deadline for the 1-st task.  Vitaly chooses the 3-rd option. Then in 3 hours, he will complete the 2-nd task in its entirety. He has another 1 hour left before the deadline for the 1-st task and 4 hours left before the deadline for the 3-rd task.  Vitaly chooses the 1-st option. Then after 1 hour, he will complete the 1-st task for 110 percent, which means that he will complete the 1-st task just in time for the deadline.  Vitaly chooses the 5-th option. He will complete the 3-rd task for 2 hours, and after another 1 hour, Vitaly will complete the 3-rd task in its entirety. Thus, Vitaly has managed to complete the course completely and on time, using the 4 options.Help Vitaly \xe2\x80\x94 print the options for Vitaly to complete the tasks in the correct order. Please note: each option can be used not more than once. If there are several possible answers, it is allowed to output any of them." 2200
1650E "Rescheduling the Exam" "binary search,data structures,greedy,implementation,math,sortings" "Now Dmitry has a session, and he has to pass n exams. The session starts on day 1 and lasts d days. The ith exam will take place on the day of ai (1\xe2\x89\xa4ai\xe2\x89\xa4d), all ai \xe2\x80\x94 are different.  Sample, where n=3, d=12, a=[3,5,9]. Orange \xe2\x80\x94 exam days. Before the first exam Dmitry will rest 2 days, before the second he will rest 1 day and before the third he will rest 3 days. For the session schedule, Dmitry considers a special value \xce\xbc \xe2\x80\x94 the smallest of the rest times before the exam for all exams. For example, for the image above, \xce\xbc=1. In other words, for the schedule, he counts exactly n numbers  \xe2\x80\x94 how many days he rests between the exam i\xe2\x88\x921 and i (for i=0 between the start of the session and the exam i). Then it finds \xce\xbc \xe2\x80\x94 the minimum among these n numbers.Dmitry believes that he can improve the schedule of the session. He may ask to change the date of one exam (change one arbitrary value of ai). Help him change the date so that all ai remain different, and the value of \xce\xbc is as large as possible.For example, for the schedule above, it is most advantageous for Dmitry to move the second exam to the very end of the session. The new schedule will take the form:  Now the rest periods before exams are equal to [2,2,5]. So, \xce\xbc=2. Dmitry can leave the proposed schedule unchanged (if there is no way to move one exam so that it will lead to an improvement in the situation)." 1900
1650D "Twist the Permutation" "brute force,constructive algorithms,implementation,math" "Petya got an array a of numbers from 1 to n, where a[i]=i.He performed n operations sequentially. In the end, he received a new state of the a array.At the i-th operation, Petya chose the first i elements of the array and cyclically shifted them to the right an arbitrary number of times (elements with indexes i+1 and more remain in their places). One cyclic shift to the right is such a transformation that the array a=[a1,a2,\xe2\x80\xa6,an] becomes equal to the array a=[ai,a1,a2,\xe2\x80\xa6,ai\xe2\x88\x922,ai\xe2\x88\x921,ai+1,ai+2,\xe2\x80\xa6,an].For example, if a=[5,4,2,1,3] and i=3 (that is, this is the third operation), then as a result of this operation, he could get any of these three arrays:  a=[5,4,2,1,3] (makes 0 cyclic shifts, or any number that is divisible by 3);  a=[2,5,4,1,3] (makes 1 cyclic shift, or any number that has a remainder of 1 when divided by 3);  a=[4,2,5,1,3] (makes 2 cyclic shifts, or any number that has a remainder of 2 when divided by 3). Let\'s look at an example. Let n=6, i.e. initially a=[1,2,3,4,5,6]. A possible scenario is described below.  i=1: no matter how many cyclic shifts Petya makes, the array a does not change.  i=2: let\'s say Petya decided to make a 1 cyclic shift, then the array will look like a=[2,1,3,4,5,6].  i=3: let\'s say Petya decided to make 1 cyclic shift, then the array will look like a=[3,2,1,4,5,6].  i=4: let\'s say Petya decided to make 2 cyclic shifts, the original array will look like a=[1,4,3,2,5,6].  i=5: let\'s say Petya decided to make 0 cyclic shifts, then the array won\'t change.  i=6: let\'s say Petya decided to make 4 cyclic shifts, the array will look like a=[3,2,5,6,1,4]. You are given a final array state a after all n operations. Determine if there is a way to perform the operation that produces this result. In this case, if an answer exists, print the numbers of cyclical shifts that occurred during each of the n operations." 1300
1650C "Weight of the System of Nested Segments" greedy,hashing,implementation,sortings "On the number line there are m points, i-th of which has integer coordinate xi and integer weight wi. The coordinates of all points are different, and the points are numbered from 1 to m.A sequence of n segments [l1,r1],[l2,r2],\xe2\x80\xa6,[ln,rn] is called system of nested segments if for each pair i,j (1\xe2\x89\xa4i<j\xe2\x89\xa4n) the condition li<lj<rj<ri is satisfied. In other words, the second segment is strictly inside the first one, the third segment is strictly inside the second one, and so on.For a given number n, find a system of nested segments such that:  both ends of each segment are one of m given points;  the sum of the weights 2\xe2\x8b\x85n of the points used as ends of the segments is minimal. For example, let m=8. The given points are marked in the picture, their weights are marked in red, their coordinates are marked in blue. Make a system of three nested segments:  weight of the first segment: 1+1=2  weight of the second segment: 10+(\xe2\x88\x921)=9  weight of the third segment: 3+(\xe2\x88\x922)=1  sum of the weights of all the segments in the system: 2+9+1=12   System of three nested segments" 1200
1650B "DIV + MOD" math "Not so long ago, Vlad came up with an interesting function: fa(x)=\xe2\x8c\x8axa\xe2\x8c\x8b+xmoda, where \xe2\x8c\x8axa\xe2\x8c\x8b is xa, rounded down, xmoda \xe2\x80\x94 the remainder of the integer division of x by a.For example, with a=3 and x=11, the value f3(11)=\xe2\x8c\x8a113\xe2\x8c\x8b+11mod3=3+2=5.The number a is fixed and known to Vlad. Help Vlad find the maximum value of fa(x) if x can take any integer value from l to r inclusive (l\xe2\x89\xa4x\xe2\x89\xa4r)." 900
1650A "Deletions of Two Adjacent Letters" implementation,strings "The string s is given, the string length is odd number. The string consists of lowercase letters of the Latin alphabet.As long as the string length is greater than 1, the following operation can be performed on it: select any two adjacent letters in the string s and delete them from the string. For example, from the string ""lemma"" in one operation, you can get any of the four strings: ""mma"", ""lma"", ""lea"" or ""lem"" In particular, in one operation, the length of the string reduces by 2.Formally, let the string s have the form s=s1s2\xe2\x80\xa6sn (n>1). During one operation, you choose an arbitrary index i (1\xe2\x89\xa4i<n) and replace s=s1s2\xe2\x80\xa6si\xe2\x88\x921si+2\xe2\x80\xa6sn.For the given string s and the letter c, determine whether it is possible to make such a sequence of operations that in the end the equality s=c will be true? In other words, is there such a sequence of operations that the process will end with a string of length 1, which consists of the letter c?" 800
1649B "Game of Ball Passing" greedy,implementation "Daniel is watching a football team playing a game during their training session. They want to improve their passing skills during that session.The game involves n players, making multiple passes towards each other. Unfortunately, since the balls were moving too fast, after the session Daniel is unable to know how many balls were involved during the game. The only thing he knows is the number of passes delivered by each player during all the session.Find the minimum possible amount of balls that were involved in the game." 1300
1649A Game implementation "You are playing a very popular computer game. The next level consists of n consecutive locations, numbered from 1 to n, each of them containing either land or water. It is known that the first and last locations contain land, and for completing the level you have to move from the first location to the last. Also, if you become inside a location with water, you will die, so you can only move between locations with land.You can jump between adjacent locations for free, as well as no more than once jump from any location with land i to any location with land i+x, spending x coins (x\xe2\x89\xa50).Your task is to spend the minimum possible number of coins to move from the first location to the last one.Note that this is always possible since both the first and last locations are the land locations." 800
1648F "Two Avenues" "data structures,dfs and similar,graphs" "In order to make the capital of Berland a more attractive place for tourists, the great king came up with the following plan: choose two streets of the city and call them avenues. Certainly, these avenues will be proclaimed extremely important historical places, which should attract tourists from all over the world.The capital of Berland can be represented as a graph, the vertices of which are crossroads, and the edges are streets connecting two crossroads. In total, there are n vertices and m edges in the graph, you can move in both directions along any street, you can get from any crossroad to any other by moving only along the streets, each street connects two different crossroads, and no two streets connect the same pair of crossroads.In order to reduce the flow of ordinary citizens moving along the great avenues, it was decided to introduce a toll on each avenue in both directions. Now you need to pay 1 tugrik for one passage along the avenue. You don\'t have to pay for the rest of the streets.Analysts have collected a sample of k citizens, i-th of them needs to go to work from the crossroad ai to the crossroad bi. After two avenues are chosen, each citizen will go to work along the path with minimal cost.In order to earn as much money as possible, it was decided to choose two streets as two avenues, so that the total number of tugriks paid by these k citizens is maximized. Help the king: according to the given scheme of the city and a sample of citizens, find out which two streets should be made avenues, and how many tugriks the citizens will pay according to this choice." 3500
1648E "Air Reform" "data structures,dfs and similar,divide and conquer,dsu,graphs,implementation,trees" "Berland is a large country with developed airlines. In total, there are n cities in the country that are historically served by the Berlaflot airline. The airline operates bi-directional flights between m pairs of cities, i-th of them connects cities with numbers ai and bi and has a price ci for a flight in both directions.It is known that Berlaflot flights can be used to get from any city to any other (possibly with transfers), and the cost of any route that consists of several consequent flights is equal to the cost of the most expensive of them. More formally, the cost of the route from a city t1 to a city tk with (k\xe2\x88\x922) transfers using cities t2, t3, t4, \xe2\x80\xa6, tk\xe2\x88\x921 is equal to the maximum cost of flights from t1 to t2, from t2 to t3, from t3 to t4 and so on until the flight from tk\xe2\x88\x921 to tk. Of course, all these flights must be operated by Berlaflot.A new airline, S8 Airlines, has recently started operating in Berland. This airline provides bi-directional flights between all pairs of cities that are not connected by Berlaflot direct flights. Thus, between each pair of cities there is a flight of either Berlaflot or S8 Airlines.The cost of S8 Airlines flights is calculated as follows: for each pair of cities x and y that is connected by a S8 Airlines flight, the cost of this flight is equal to the minimum cost of the route between the cities x and y at Berlaflot according to the pricing described earlier.It is known that with the help of S8 Airlines flights you can get from any city to any other with possible transfers, and, similarly to Berlaflot, the cost of a route between any two cities that consists of several S8 Airlines flights is equal to the cost of the most expensive flight.Due to the increased competition with S8 Airlines, Berlaflot decided to introduce an air reform and change the costs of its flights. Namely, for the i-th of its flight between the cities ai and bi, Berlaflot wants to make the cost of this flight equal to the minimum cost of the route between the cities ai and bi at S8 Airlines. Help Berlaflot managers calculate new flight costs." 3200
1648D "Serious Business" "data structures,divide and conquer,dp,implementation,shortest paths" "Dima is taking part in a show organized by his friend Peter. In this show Dima is required to cross a 3\xc3\x97n rectangular field. Rows are numbered from 1 to 3 and columns are numbered from 1 to n.The cell in the intersection of the i-th row and the j-th column of the field contains an integer ai,j. Initially Dima\'s score equals zero, and whenever Dima reaches a cell in the row i and the column j, his score changes by ai,j. Note that the score can become negative.Initially all cells in the first and the third row are marked as available, and all cells in the second row are marked as unavailable. However, Peter offered Dima some help: there are q special offers in the show, the i-th special offer allows Dima to mark cells in the second row between li and ri as available, though Dima\'s score reduces by ki whenever he accepts a special offer. Dima is allowed to use as many special offers as he wants, and might mark the same cell as available multiple times.Dima starts his journey in the cell (1,1) and would like to reach the cell (3,n). He can move either down to the next row or right to the next column (meaning he could increase the current row or column by 1), thus making n+1 moves in total, out of which exactly n\xe2\x88\x921 would be horizontal and 2 would be vertical.Peter promised Dima to pay him based on his final score, so the sum of all numbers of all visited cells minus the cost of all special offers used. Please help Dima to maximize his final score." 2800
1648C "Tyler and Strings" "combinatorics,data structures,implementation" "While looking at the kitchen fridge, the little boy Tyler noticed magnets with symbols, that can be aligned into a string s.Tyler likes strings, and especially those that are lexicographically smaller than another string, t. After playing with magnets on the fridge, he is wondering, how many distinct strings can be composed out of letters of string s by rearranging them, so that the resulting string is lexicographically smaller than the string t? Tyler is too young, so he can\'t answer this question. The alphabet Tyler uses is very large, so for your convenience he has already replaced the same letters in s and t to the same integers, keeping that different letters have been replaced to different integers.We call a string x lexicographically smaller than a string y if one of the followings conditions is fulfilled:   There exists such position of symbol m that is presented in both strings, so that before m-th symbol the strings are equal, and the m-th symbol of string x is smaller than m-th symbol of string y.  String x is the prefix of string y and x\xe2\x89\xa0y. Because the answer can be too large, print it modulo 998244353." 1900
1648B "Integral Array" "brute force,constructive algorithms,data structures,math" "You are given an array a of n positive integers numbered from 1 to n. Let\'s call an array integral if for any two, not necessarily different, numbers x and y from this array, x\xe2\x89\xa5y, the number \xe2\x8c\x8axy\xe2\x8c\x8b (x divided by y with rounding down) is also in this array.You are guaranteed that all numbers in a do not exceed c. Your task is to check whether this array is integral." 1800
1648A "Weird Sum" "combinatorics,data structures,geometry,math,matrices,sortings" "Egor has a table of size n\xc3\x97m, with lines numbered from 1 to n and columns numbered from 1 to m. Each cell has a color that can be presented as an integer from 1 to 105.Let us denote the cell that lies in the intersection of the r-th row and the c-th column as (r,c). We define the manhattan distance between two cells (r1,c1) and (r2,c2) as the length of a shortest path between them where each consecutive cells in the path must have a common side. The path can go through cells of any color. For example, in the table 3\xc3\x974 the manhattan distance between (1,2) and (3,3) is 3, one of the shortest paths is the following: (1,2)\xe2\x86\x92(2,2)\xe2\x86\x92(2,3)\xe2\x86\x92(3,3). Egor decided to calculate the sum of manhattan distances between each pair of cells of the same color. Help him to calculate this sum." 1400
1647F "Madoka and Laziness" dp,greedy "Madoka has become too lazy to write a legend, so let\'s go straight to the formal description of the problem.An array of integers a1,a2,\xe2\x80\xa6,an is called a hill if it is not empty and there is an index i in it, for which the following is true: a1<a2<\xe2\x80\xa6<ai>ai+1>ai+2>\xe2\x80\xa6>an.A sequence x is a subsequence of a sequence y if x can be obtained from y by deletion of several (possibly, zero or all) elements keeping the order of the other elements. For example, for an array [69,1000,228,\xe2\x88\x927] the array [1000,\xe2\x88\x927] is a subsequence, while [1] and [\xe2\x88\x927,1000] are not.Splitting an array into two subsequences is called good if each element belongs to exactly one subsequence, and also each of these subsequences is a hill.You are given an array of distinct positive integers a1,a2,\xe2\x80\xa6an. It is required to find the number of different pairs of maxima of the first and second subsequences among all good splits. Two pairs that only differ in the order of elements are considered same." 3100
1647E "Madoka and the Sixth-graders" "data structures,dfs and similar,greedy" "After the most stunning success with the fifth-graders, Madoka has been trusted with teaching the sixth-graders.There\'s n single-place desks in her classroom. At the very beginning Madoka decided that the student number bi (1\xe2\x89\xa4bi\xe2\x89\xa4n) will sit at the desk number i. Also there\'s an infinite line of students with numbers n+1,n+2,n+3,\xe2\x80\xa6 waiting at the door with the hope of being able to learn something from the Madoka herself. Pay attention that each student has his unique number.After each lesson, the following happens in sequence.   The student sitting at the desk i moves to the desk pi. All students move simultaneously.  If there is more than one student at a desk, the student with the lowest number keeps the place, and the others are removed from the class forever.  For all empty desks in ascending order, the student from the lowest number from the outside line occupies the desk. Note that in the end there is exactly one student at each desk again. It is guaranteed that the numbers p are such that at least one student is removed after each lesson. Check out the explanation to the first example for a better understanding.After several (possibly, zero) lessons the desk i is occupied by student ai. Given the values a1,a2,\xe2\x80\xa6,an and p1,p2,\xe2\x80\xa6,pn, find the lexicographically smallest suitable initial seating permutation b1,b2,\xe2\x80\xa6,bn.The permutation is an array of n different integers from 1 up to n in any order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not (2 occurs twice). [1,3,4] is not a permutation either (n=3 but there\'s 4 in the array).For two different permutations a and b of the same length, a is lexicographically less than b if in the first position where a and b differ, the permutation a has a smaller element than the corresponding element in b." 2500
1647D "Madoka and the Best School in Russia" "constructive algorithms,dp,math,number theory" "Madoka is going to enroll in ""TSUNS PTU"". But she stumbled upon a difficult task during the entrance computer science exam:  A number is called good if it is a multiple of d.  A number is called beatiful if it is good and it cannot be represented as a product of two good numbers. Notice that a beautiful number must be good.Given a good number x, determine whether it can be represented in at least two different ways as a product of several (possibly, one) beautiful numbers. Two ways are different if the sets of numbers used are different.Solve this problem for Madoka and help her to enroll in the best school in Russia!" 1900
1647C "Madoka and Childish Pranks" "constructive algorithms,greedy" "Madoka as a child was an extremely capricious girl, and one of her favorite pranks was drawing on her wall. According to Madoka\'s memories, the wall was a table of n rows and m columns, consisting only of zeroes and ones. The coordinate of the cell in the i-th row and the j-th column (1\xe2\x89\xa4i\xe2\x89\xa4n, 1\xe2\x89\xa4j\xe2\x89\xa4m) is (i,j).One day she saw a picture ""Mahou Shoujo Madoka Magica"" and decided to draw it on her wall. Initially, the Madoka\'s table is a table of size n\xc3\x97m filled with zeroes. Then she applies the following operation any number of times:Madoka selects any rectangular subtable of the table and paints it in a chess coloring (the upper left corner of the subtable always has the color 0). Note that some cells may be colored several times. In this case, the final color of the cell is equal to the color obtained during the last repainting.  White color means 0, black means 1. So, for example, the table in the first picture is painted in a chess coloring, and the others are not. For better understanding of the statement, we recommend you to read the explanation of the first test.Help Madoka and find some sequence of no more than n\xe2\x8b\x85m operations that allows you to obtain the picture she wants, or determine that this is impossible." 1300
1647B "Madoka and the Elegant Gift" "brute force,constructive algorithms,graphs,implementation" "Madoka\'s father just reached 1 million subscribers on Mathub! So the website decided to send him a personalized award \xe2\x80\x94 The Mathhub\'s Bit Button! The Bit Button is a rectangular table with n rows and m columns with 0 or 1 in each cell. After exploring the table Madoka found out that: A subrectangle A is contained in a subrectangle B if there\'s no cell contained in A but not contained in B. Two subrectangles intersect if there is a cell contained in both of them. A subrectangle is called black if there\'s no cell with value 0 inside it. A subrectangle is called nice if it\'s black and it\'s not contained in another black subrectangle. The table is called elegant if there are no two nice intersecting subrectangles.For example, in the first illustration the red subrectangle is nice, but in the second one it\'s not, because it\'s contained in the purple subrectangle.  Help Madoka to determine whether the table is elegant." 1200
1647A "Madoka and Math Dad" implementation,math "Madoka finally found the administrator password for her computer. Her father is a well-known popularizer of mathematics, so the password is the answer to the following problem.Find the maximum decimal number without zeroes and with no equal digits in a row, such that the sum of its digits is n.Madoka is too tired of math to solve it herself, so help her to solve this problem!" 800
1646F "Playing Around the Table" "constructive algorithms,greedy,implementation" "There are n players, numbered from 1 to n sitting around a round table. The (i+1)-th player sits to the right of the i-th player for 1\xe2\x89\xa4i<n, and the 1-st player sits to the right of the n-th player.There are n2 cards, each of which has an integer between 1 and n written on it. For each integer from 1 to n, there are exactly n cards having this number.Initially, all these cards are distributed among all the players, in such a way that each of them has exactly n cards. In one operation, each player chooses one of his cards and passes it to the player to his right. All these actions are performed simultaneously. Player i is called solid if all his cards have the integer i written on them. Their objective is to reach a configuration in which everyone is solid. Find a way to do it using at most (n2\xe2\x88\x92n) operations. You do not need to minimize the number of operations." 2900
1646E "Power Board" "brute force,dp,math,number theory" "You have a rectangular board of size n\xc3\x97m (n rows, m columns). The n rows are numbered from 1 to n from top to bottom, and the m columns are numbered from 1 to m from left to right. The cell at the intersection of row i and column j contains the number ij (i raised to the power of j). For example, if n=3 and m=3 the board is as follows:  Find the number of distinct integers written on the board." 2200
1646D "Weight the Tree" "constructive algorithms,dfs and similar,dp,implementation,trees" "You are given a tree of n vertices numbered from 1 to n. A tree is a connected undirected graph without cycles. For each i=1,2,\xe2\x80\xa6,n, let wi be the weight of the i-th vertex. A vertex is called good if its weight is equal to the sum of the weights of all its neighbors.Initially, the weights of all nodes are unassigned. Assign positive integer weights to each vertex of the tree, such that the number of good vertices in the tree is maximized. If there are multiple ways to do it, you have to find one that minimizes the sum of weights of all vertices in the tree." 2000
1646C "Factorials and Powers of Two" "bitmasks,brute force,constructive algorithms,dp,math" "A number is called powerful if it is a power of two or a factorial. In other words, the number m is powerful if there exists a non-negative integer d such that m=2d or m=d!, where d!=1\xe2\x8b\x852\xe2\x8b\x85\xe2\x80\xa6\xe2\x8b\x85d (in particular, 0!=1). For example 1, 4, and 6 are powerful numbers, because 1=1!, 4=22, and 6=3! but 7, 10, or 18 are not.You are given a positive integer n. Find the minimum number k such that n can be represented as the sum of k distinct powerful numbers, or say that there is no such k." 1500
1646B "Quality vs Quantity" "brute force,constructive algorithms,greedy,sortings,two pointers" "You are given a sequence of n non-negative integers a1,a2,\xe2\x80\xa6,an. Initially, all the elements of the sequence are unpainted. You can paint each number Red_ or \xc2\xafBlue (but not both), or leave it unpainted. For a color c, Count(c) is the number of elements in the sequence painted with that color and Sum(c) is the sum of the elements in the sequence painted with that color.For example, if the given sequence is [2,8,6,3,1] and it is painted this way: [\xc2\xaf2,8,6_,\xc2\xaf3,1] (where 6 is painted red, 2 and 3 are painted blue, 1 and 8 are unpainted) then Sum(Red_)=6, Sum(\xc2\xafBlue)=2+3=5, Count(Red_)=1, and Count(\xc2\xafBlue)=2.Determine if it is possible to paint the sequence so that Sum(Red_)>Sum(\xc2\xafBlue) and Count(Red_)<Count(\xc2\xafBlue)." 800
1646A "Square Counting" math "Luis has a sequence of n+1 integers a1,a2,\xe2\x80\xa6,an+1. For each i=1,2,\xe2\x80\xa6,n+1 it is guaranteed that 0\xe2\x89\xa4ai<n, or ai=n2. He has calculated the sum of all the elements of the sequence, and called this value s. Luis has lost his sequence, but he remembers the values of n and s. Can you find the number of elements in the sequence that are equal to n2?We can show that the answer is unique under the given constraints." 800
1644F Basis "combinatorics,fft,math,number theory" "For an array of integers a, let\'s define |a| as the number of elements in it.Let\'s denote two functions: F(a,k) is a function that takes an array of integers a and a positive integer k. The result of this function is the array containing |a| first elements of the array that you get by replacing each element of a with exactly k copies of that element.For example, F([2,2,1,3,5,6,8],2) is calculated as follows: first, you replace each element of the array with 2 copies of it, so you obtain [2,2,2,2,1,1,3,3,5,5,6,6,8,8]. Then, you take the first 7 elements of the array you obtained, so the result of the function is [2,2,2,2,1,1,3]. G(a,x,y) is a function that takes an array of integers a and two different integers x and y. The result of this function is the array a with every element equal to x replaced by y, and every element equal to y replaced by x.For example, G([1,1,2,3,5],3,1)=[3,3,2,1,5].An array a is a parent of the array b if:  either there exists a positive integer k such that F(a,k)=b;  or there exist two different integers x and y such that G(a,x,y)=b. An array a is an ancestor of the array b if there exists a finite sequence of arrays c0,c1,\xe2\x80\xa6,cm (m\xe2\x89\xa50) such that c0 is a, cm is b, and for every i\xe2\x88\x88[1,m], ci\xe2\x88\x921 is a parent of ci.And now, the problem itself.You are given two integers n and k. Your goal is to construct a sequence of arrays s1,s2,\xe2\x80\xa6,sm in such a way that:  every array si contains exactly n elements, and all elements are integers from 1 to k;  for every array a consisting of exactly n integers from 1 to k, the sequence contains at least one array si such that si is an ancestor of a. Print the minimum number of arrays in such sequence." 2900
1644E "Expand the Path" "brute force,combinatorics,data structures,implementation,math" "Consider a grid of size n\xc3\x97n. The rows are numbered top to bottom from 1 to n, the columns are numbered left to right from 1 to n.The robot is positioned in a cell (1,1). It can perform two types of moves:  D \xe2\x80\x94 move one cell down;  R \xe2\x80\x94 move one cell right. The robot is not allowed to move outside the grid.You are given a sequence of moves s \xe2\x80\x94 the initial path of the robot. This path doesn\'t lead the robot outside the grid.You are allowed to perform an arbitrary number of modifications to it (possibly, zero). With one modification, you can duplicate one move in the sequence. That is, replace a single occurrence of D with DD or a single occurrence of R with RR.Count the number of cells such that there exists at least one sequence of modifications that the robot visits this cell on the modified path and doesn\'t move outside the grid." 1900
1644D "Cross Coloring" "data structures,implementation,math" "There is a sheet of paper that can be represented with a grid of size n\xc3\x97m: n rows and m columns of cells. All cells are colored in white initially.q operations have been applied to the sheet. The i-th of them can be described as follows:   xi yi \xe2\x80\x94 choose one of k non-white colors and color the entire row xi and the entire column yi in it. The new color is applied to each cell, regardless of whether the cell was colored before the operation. The sheet after applying all q operations is called a coloring. Two colorings are different if there exists at least one cell that is colored in different colors.How many different colorings are there? Print the number modulo 998244353." 1700
1644C "Increase Subarray Sums" "brute force,dp,greedy,implementation" "You are given an array a1,a2,\xe2\x80\xa6,an, consisting of n integers. You are also given an integer value x.Let f(k) be the maximum sum of a contiguous subarray of a after applying the following operation: add x to the elements on exactly k distinct positions. An empty subarray should also be considered, it has sum 0.Note that the subarray doesn\'t have to include all of the increased elements.Calculate the maximum value of f(k) for all k from 0 to n independently." 1400
1644B "Anti-Fibonacci Permutation" "brute force,constructive algorithms,implementation" "Let\'s call a permutation p of length n anti-Fibonacci if the condition pi\xe2\x88\x922+pi\xe2\x88\x921\xe2\x89\xa0pi holds for all i (3\xe2\x89\xa4i\xe2\x89\xa4n). Recall that the permutation is the array of length n which contains each integer from 1 to n exactly once.Your task is for a given number n print n distinct anti-Fibonacci permutations of length n." 800
1644A "Doors and Keys" implementation "The knight is standing in front of a long and narrow hallway. A princess is waiting at the end of it.In a hallway there are three doors: a red door, a green door and a blue door. The doors are placed one after another, however, possibly in a different order. To proceed to the next door, the knight must first open the door before.Each door can be only opened with a key of the corresponding color. So three keys: a red key, a green key and a blue key \xe2\x80\x94 are also placed somewhere in the hallway. To open the door, the knight should first pick up the key of its color.The knight has a map of the hallway. It can be transcribed as a string, consisting of six characters:   R, G, B \xe2\x80\x94 denoting red, green and blue doors, respectively;  r, g, b \xe2\x80\x94 denoting red, green and blue keys, respectively. Each of these six characters appears in the string exactly once.The knight is standing at the beginning of the hallway \xe2\x80\x94 on the left on the map.Given a map of the hallway, determine if the knight can open all doors and meet the princess at the end of the hallway." 800
1642B "Power Walking" greedy "Sam is a kindergartener, and there are n children in his group. He decided to create a team with some of his children to play ""brawl:go 2"".Sam has n power-ups, the i-th has type ai. A child\'s strength is equal to the number of different types among power-ups he has.For a team of size k, Sam will distribute all n power-ups to k children in such a way that each of the k children receives at least one power-up, and each power-up is given to someone.For each integer k from 1 to n, find the minimum sum of strengths of a team of k children Sam can get." 900
1642A "Hard Way" geometry "Sam lives in Awesomeburg, its downtown has a triangular shape. Also, the following is true about the triangle:  its vertices have integer coordinates,  the coordinates of vertices are non-negative, and  its vertices are not on a single line. He calls a point on the downtown\'s border (that is the border of the triangle) safe if he can reach this point from at least one point of the line y=0y=0 walking along some straight line, without crossing the interior of the triangle.  In the picture the downtown is marked with grey color. The first path is invalid because it does not go along a straight line. The second path is invalid because it intersects with the interior of the downtown. The third and fourth paths are correct. Find the total length of the unsafe parts of the downtown border. It can be proven that these parts are segments and their number is finite." 800
1641F "Covering Circle" geometry "Sam started playing with round buckets in the sandbox, while also scattering pebbles. His mom decided to buy him a new bucket, so she needs to solve the following task.You are given n distinct points with integer coordinates A1,A2,\xe2\x80\xa6,An. All points were generated from the square [\xe2\x88\x92108,108]\xc3\x97[\xe2\x88\x92108,108] uniformly and independently.You are given positive integers k, l, such that k\xe2\x89\xa4l\xe2\x89\xa4n. You want to select a subsegment Ai,Ai+1,\xe2\x80\xa6,Ai+l\xe2\x88\x921 of the points array (for some 1\xe2\x89\xa4i\xe2\x89\xa4n+1\xe2\x88\x92l), and some circle on the plane, containing \xe2\x89\xa5k points of the selected subsegment (inside or on the border).What is the smallest possible radius of that circle?" 3500
1641E "Special Positions" "combinatorics,divide and conquer,fft,math" "You are given an array a of length n. Also you are given m distinct positions p1,p2,\xe2\x80\xa6,pm (1\xe2\x89\xa4pi\xe2\x89\xa4n).A non-empty subset of these positions T is randomly selected with equal probability and the following value is calculated: n\xe2\x88\x91i=1(ai\xe2\x8b\x85minj\xe2\x88\x88T|i\xe2\x88\x92j|). In other word, for each index of the array, ai and the distance to the closest chosen position are multiplied, and then these values are summed up.Find the expected value of this sum.This value must be found modulo 998244353. More formally, let M=998244353. It can be shown that the answer can be represented as an irreducible fraction pq, where p and q are integers and q\xe2\x89\xa00 (mod M). Output the integer equal to p\xe2\x8b\x85q\xe2\x88\x921 (mod M). In other words, output such integer x that 0\xe2\x89\xa4x<M and x\xe2\x8b\x85q=p (mod M)." 3300
1641D "Two Arrays" "bitmasks,brute force,combinatorics,greedy,hashing,math,two pointers" "Sam changed his school and on the first biology lesson he got a very interesting task about genes.You are given n arrays, the i-th of them contains m different integers \xe2\x80\x94 ai,1,ai,2,\xe2\x80\xa6,ai,m. Also you are given an array of integers w of length n.Find the minimum value of wi+wj among all pairs of integers (i,j) (1\xe2\x89\xa4i,j\xe2\x89\xa4n), such that the numbers ai,1,ai,2,\xe2\x80\xa6,ai,m,aj,1,aj,2,\xe2\x80\xa6,aj,m are distinct." 2700
1641C "Anonymity Is Important" "binary search,brute force,data structures,dsu,greedy,sortings" "In the work of a doctor, it is important to maintain the anonymity of clients and the results of tests. The test results are sent to everyone personally by email, but people are very impatient and they want to know the results right away.That\'s why in the testing lab ""De-vitro"" doctors came up with an experimental way to report the results. Let\'s assume that n people took the tests in the order of the queue. Then the chief doctor Sam can make several statements, in each telling if there is a sick person among the people in the queue from l-th to r-th (inclusive), for some values l and r.During the process, Sam will check how well this scheme works and will be interested in whether it is possible to find out the test result of i-th person from the information he announced. And if it can be done, then is that patient sick or not.Help Sam to test his scheme." 2200
1641B "Repetitions Decoding" "constructive algorithms,implementation,sortings" "Olya has an array of integers a1,a2,\xe2\x80\xa6,an. She wants to split it into tandem repeats. Since it\'s rarely possible, before that she wants to perform the following operation several (possibly, zero) number of times: insert a pair of equal numbers into an arbitrary position. Help her!More formally:  A tandem repeat is a sequence x of even length 2k such that for each 1\xe2\x89\xa4i\xe2\x89\xa4k the condition xi=xi+k is satisfied.  An array a could be split into tandem repeats if you can split it into several parts, each being a subsegment of the array, such that each part is a tandem repeat.  In one operation you can choose an arbitrary letter c and insert [c,c] to any position in the array (at the beginning, between any two integers, or at the end).  You are to perform several operations and split the array into tandem repeats or determine that it is impossible. Please note that you do not have to minimize the number of operations." 2000
1641A "Great Sequence" "brute force,greedy,sortings" "A sequence of positive integers is called great for a positive integer x, if we can split it into pairs in such a way that in each pair the first number multiplied by x is equal to the second number. More formally, a sequence a of size n is great for a positive integer x, if n is even and there exists a permutation p of size n, such that for each i (1\xe2\x89\xa4i\xe2\x89\xa4n2) ap2i\xe2\x88\x921\xe2\x8b\x85x=ap2i. Sam has a sequence a and a positive integer x. Help him to make the sequence great: find the minimum possible number of positive integers that should be added to the sequence a to make it great for the number x." 1200
1639K "Treasure Hunt" graphs,interactive "All problems in this contest share the same statement, the only difference is the test your solution runs on. For further information on scoring please refer to ""Scoring"" section of the statement.This is an interactive problem.Imagine you are a treasure hunter, a very skillful one. One day you came across an ancient map which could help you to become rich. The map shows multiple forestry roads, and at each junction there is a treasure. So, you start your journey hoping to retrieve all the hidden treasures, but you don\'t know yet that there is a wicked wizard standing against you and craving to tangle up these roads and impede your achievements.The treasure map is represented as an undirected graph in which vertices correspond to junctions and edges correspond to roads. Your path begins at a certain fixed vertex with a label known to you. Every time you come to a vertex that you have not been to before, you dig up a treasure chest and put a flag in this vertex. At the initial vertex you\'ll find a treasure chest immediately and, consequently, you\'ll put a flag there immediately as well.When you are standing at the junction you can see for each of the adjacent vertices its degree and if there is a flag there. There are no other things you can see from there. Besides, the power of the wicked wizard is so great that he is able to change the location of the roads and junctions on the map without changing the graph structure. Therefore, the sequence of the roads coming from the junction v might be different each time you come in the junction v. However, keep in mind that the set of adjacent crossroads does not change, and you are well aware of previously dug treasures at each adjacent to v vertex.Your goal is to collect treasures from all vertices of the graph as fast as you can. Good luck in hunting!" -999
1639J "Treasure Hunt" graphs,interactive "All problems in this contest share the same statement, the only difference is the test your solution runs on. For further information on scoring please refer to ""Scoring"" section of the statement.This is an interactive problem.Imagine you are a treasure hunter, a very skillful one. One day you came across an ancient map which could help you to become rich. The map shows multiple forestry roads, and at each junction there is a treasure. So, you start your journey hoping to retrieve all the hidden treasures, but you don\'t know yet that there is a wicked wizard standing against you and craving to tangle up these roads and impede your achievements.The treasure map is represented as an undirected graph in which vertices correspond to junctions and edges correspond to roads. Your path begins at a certain fixed vertex with a label known to you. Every time you come to a vertex that you have not been to before, you dig up a treasure chest and put a flag in this vertex. At the initial vertex you\'ll find a treasure chest immediately and, consequently, you\'ll put a flag there immediately as well.When you are standing at the junction you can see for each of the adjacent vertices its degree and if there is a flag there. There are no other things you can see from there. Besides, the power of the wicked wizard is so great that he is able to change the location of the roads and junctions on the map without changing the graph structure. Therefore, the sequence of the roads coming from the junction v might be different each time you come in the junction v. However, keep in mind that the set of adjacent crossroads does not change, and you are well aware of previously dug treasures at each adjacent to v vertex.Your goal is to collect treasures from all vertices of the graph as fast as you can. Good luck in hunting!" -999
1639I "Treasure Hunt" graphs,interactive "All problems in this contest share the same statement, the only difference is the test your solution runs on. For further information on scoring please refer to ""Scoring"" section of the statement.This is an interactive problem.Imagine you are a treasure hunter, a very skillful one. One day you came across an ancient map which could help you to become rich. The map shows multiple forestry roads, and at each junction there is a treasure. So, you start your journey hoping to retrieve all the hidden treasures, but you don\'t know yet that there is a wicked wizard standing against you and craving to tangle up these roads and impede your achievements.The treasure map is represented as an undirected graph in which vertices correspond to junctions and edges correspond to roads. Your path begins at a certain fixed vertex with a label known to you. Every time you come to a vertex that you have not been to before, you dig up a treasure chest and put a flag in this vertex. At the initial vertex you\'ll find a treasure chest immediately and, consequently, you\'ll put a flag there immediately as well.When you are standing at the junction you can see for each of the adjacent vertices its degree and if there is a flag there. There are no other things you can see from there. Besides, the power of the wicked wizard is so great that he is able to change the location of the roads and junctions on the map without changing the graph structure. Therefore, the sequence of the roads coming from the junction v might be different each time you come in the junction v. However, keep in mind that the set of adjacent crossroads does not change, and you are well aware of previously dug treasures at each adjacent to v vertex.Your goal is to collect treasures from all vertices of the graph as fast as you can. Good luck in hunting!" -999
1639H "Treasure Hunt" graphs,interactive "All problems in this contest share the same statement, the only difference is the test your solution runs on. For further information on scoring please refer to ""Scoring"" section of the statement.This is an interactive problem.Imagine you are a treasure hunter, a very skillful one. One day you came across an ancient map which could help you to become rich. The map shows multiple forestry roads, and at each junction there is a treasure. So, you start your journey hoping to retrieve all the hidden treasures, but you don\'t know yet that there is a wicked wizard standing against you and craving to tangle up these roads and impede your achievements.The treasure map is represented as an undirected graph in which vertices correspond to junctions and edges correspond to roads. Your path begins at a certain fixed vertex with a label known to you. Every time you come to a vertex that you have not been to before, you dig up a treasure chest and put a flag in this vertex. At the initial vertex you\'ll find a treasure chest immediately and, consequently, you\'ll put a flag there immediately as well.When you are standing at the junction you can see for each of the adjacent vertices its degree and if there is a flag there. There are no other things you can see from there. Besides, the power of the wicked wizard is so great that he is able to change the location of the roads and junctions on the map without changing the graph structure. Therefore, the sequence of the roads coming from the junction v might be different each time you come in the junction v. However, keep in mind that the set of adjacent crossroads does not change, and you are well aware of previously dug treasures at each adjacent to v vertex.Your goal is to collect treasures from all vertices of the graph as fast as you can. Good luck in hunting!" -999
1639G "Treasure Hunt" graphs,interactive "All problems in this contest share the same statement, the only difference is the test your solution runs on. For further information on scoring please refer to ""Scoring"" section of the statement.This is an interactive problem.Imagine you are a treasure hunter, a very skillful one. One day you came across an ancient map which could help you to become rich. The map shows multiple forestry roads, and at each junction there is a treasure. So, you start your journey hoping to retrieve all the hidden treasures, but you don\'t know yet that there is a wicked wizard standing against you and craving to tangle up these roads and impede your achievements.The treasure map is represented as an undirected graph in which vertices correspond to junctions and edges correspond to roads. Your path begins at a certain fixed vertex with a label known to you. Every time you come to a vertex that you have not been to before, you dig up a treasure chest and put a flag in this vertex. At the initial vertex you\'ll find a treasure chest immediately and, consequently, you\'ll put a flag there immediately as well.When you are standing at the junction you can see for each of the adjacent vertices its degree and if there is a flag there. There are no other things you can see from there. Besides, the power of the wicked wizard is so great that he is able to change the location of the roads and junctions on the map without changing the graph structure. Therefore, the sequence of the roads coming from the junction v might be different each time you come in the junction v. However, keep in mind that the set of adjacent crossroads does not change, and you are well aware of previously dug treasures at each adjacent to v vertex.Your goal is to collect treasures from all vertices of the graph as fast as you can. Good luck in hunting!" -999
1639F "Treasure Hunt" graphs,interactive "All problems in this contest share the same statement, the only difference is the test your solution runs on. For further information on scoring please refer to ""Scoring"" section of the statement.This is an interactive problem.Imagine you are a treasure hunter, a very skillful one. One day you came across an ancient map which could help you to become rich. The map shows multiple forestry roads, and at each junction there is a treasure. So, you start your journey hoping to retrieve all the hidden treasures, but you don\'t know yet that there is a wicked wizard standing against you and craving to tangle up these roads and impede your achievements.The treasure map is represented as an undirected graph in which vertices correspond to junctions and edges correspond to roads. Your path begins at a certain fixed vertex with a label known to you. Every time you come to a vertex that you have not been to before, you dig up a treasure chest and put a flag in this vertex. At the initial vertex you\'ll find a treasure chest immediately and, consequently, you\'ll put a flag there immediately as well.When you are standing at the junction you can see for each of the adjacent vertices its degree and if there is a flag there. There are no other things you can see from there. Besides, the power of the wicked wizard is so great that he is able to change the location of the roads and junctions on the map without changing the graph structure. Therefore, the sequence of the roads coming from the junction v might be different each time you come in the junction v. However, keep in mind that the set of adjacent crossroads does not change, and you are well aware of previously dug treasures at each adjacent to v vertex.Your goal is to collect treasures from all vertices of the graph as fast as you can. Good luck in hunting!" -999
1639E "Treasure Hunt" graphs,interactive "All problems in this contest share the same statement, the only difference is the test your solution runs on. For further information on scoring please refer to ""Scoring"" section of the statement.This is an interactive problem.Imagine you are a treasure hunter, a very skillful one. One day you came across an ancient map which could help you to become rich. The map shows multiple forestry roads, and at each junction there is a treasure. So, you start your journey hoping to retrieve all the hidden treasures, but you don\'t know yet that there is a wicked wizard standing against you and craving to tangle up these roads and impede your achievements.The treasure map is represented as an undirected graph in which vertices correspond to junctions and edges correspond to roads. Your path begins at a certain fixed vertex with a label known to you. Every time you come to a vertex that you have not been to before, you dig up a treasure chest and put a flag in this vertex. At the initial vertex you\'ll find a treasure chest immediately and, consequently, you\'ll put a flag there immediately as well.When you are standing at the junction you can see for each of the adjacent vertices its degree and if there is a flag there. There are no other things you can see from there. Besides, the power of the wicked wizard is so great that he is able to change the location of the roads and junctions on the map without changing the graph structure. Therefore, the sequence of the roads coming from the junction v might be different each time you come in the junction v. However, keep in mind that the set of adjacent crossroads does not change, and you are well aware of previously dug treasures at each adjacent to v vertex.Your goal is to collect treasures from all vertices of the graph as fast as you can. Good luck in hunting!" -999
1639D "Treasure Hunt" graphs,interactive "All problems in this contest share the same statement, the only difference is the test your solution runs on. For further information on scoring please refer to ""Scoring"" section of the statement.This is an interactive problem.Imagine you are a treasure hunter, a very skillful one. One day you came across an ancient map which could help you to become rich. The map shows multiple forestry roads, and at each junction there is a treasure. So, you start your journey hoping to retrieve all the hidden treasures, but you don\'t know yet that there is a wicked wizard standing against you and craving to tangle up these roads and impede your achievements.The treasure map is represented as an undirected graph in which vertices correspond to junctions and edges correspond to roads. Your path begins at a certain fixed vertex with a label known to you. Every time you come to a vertex that you have not been to before, you dig up a treasure chest and put a flag in this vertex. At the initial vertex you\'ll find a treasure chest immediately and, consequently, you\'ll put a flag there immediately as well.When you are standing at the junction you can see for each of the adjacent vertices its degree and if there is a flag there. There are no other things you can see from there. Besides, the power of the wicked wizard is so great that he is able to change the location of the roads and junctions on the map without changing the graph structure. Therefore, the sequence of the roads coming from the junction v might be different each time you come in the junction v. However, keep in mind that the set of adjacent crossroads does not change, and you are well aware of previously dug treasures at each adjacent to v vertex.Your goal is to collect treasures from all vertices of the graph as fast as you can. Good luck in hunting!" -999
1639C "Treasure Hunt" graphs,interactive "All problems in this contest share the same statement, the only difference is the test your solution runs on. For further information on scoring please refer to ""Scoring"" section of the statement.This is an interactive problem.Imagine you are a treasure hunter, a very skillful one. One day you came across an ancient map which could help you to become rich. The map shows multiple forestry roads, and at each junction there is a treasure. So, you start your journey hoping to retrieve all the hidden treasures, but you don\'t know yet that there is a wicked wizard standing against you and craving to tangle up these roads and impede your achievements.The treasure map is represented as an undirected graph in which vertices correspond to junctions and edges correspond to roads. Your path begins at a certain fixed vertex with a label known to you. Every time you come to a vertex that you have not been to before, you dig up a treasure chest and put a flag in this vertex. At the initial vertex you\'ll find a treasure chest immediately and, consequently, you\'ll put a flag there immediately as well.When you are standing at the junction you can see for each of the adjacent vertices its degree and if there is a flag there. There are no other things you can see from there. Besides, the power of the wicked wizard is so great that he is able to change the location of the roads and junctions on the map without changing the graph structure. Therefore, the sequence of the roads coming from the junction v might be different each time you come in the junction v. However, keep in mind that the set of adjacent crossroads does not change, and you are well aware of previously dug treasures at each adjacent to v vertex.Your goal is to collect treasures from all vertices of the graph as fast as you can. Good luck in hunting!" -999
1639B "Treasure Hunt" graphs,interactive "All problems in this contest share the same statement, the only difference is the test your solution runs on. For further information on scoring please refer to ""Scoring"" section of the statement.This is an interactive problem.Imagine you are a treasure hunter, a very skillful one. One day you came across an ancient map which could help you to become rich. The map shows multiple forestry roads, and at each junction there is a treasure. So, you start your journey hoping to retrieve all the hidden treasures, but you don\'t know yet that there is a wicked wizard standing against you and craving to tangle up these roads and impede your achievements.The treasure map is represented as an undirected graph in which vertices correspond to junctions and edges correspond to roads. Your path begins at a certain fixed vertex with a label known to you. Every time you come to a vertex that you have not been to before, you dig up a treasure chest and put a flag in this vertex. At the initial vertex you\'ll find a treasure chest immediately and, consequently, you\'ll put a flag there immediately as well.When you are standing at the junction you can see for each of the adjacent vertices its degree and if there is a flag there. There are no other things you can see from there. Besides, the power of the wicked wizard is so great that he is able to change the location of the roads and junctions on the map without changing the graph structure. Therefore, the sequence of the roads coming from the junction v might be different each time you come in the junction v. However, keep in mind that the set of adjacent crossroads does not change, and you are well aware of previously dug treasures at each adjacent to v vertex.Your goal is to collect treasures from all vertices of the graph as fast as you can. Good luck in hunting!" -999
1639A "Treasure Hunt" graphs,interactive "All problems in this contest share the same statement, the only difference is the test your solution runs on. For further information on scoring please refer to ""Scoring"" section of the statement.This is an interactive problem.Imagine you are a treasure hunter, a very skillful one. One day you came across an ancient map which could help you to become rich. The map shows multiple forestry roads, and at each junction there is a treasure. So, you start your journey hoping to retrieve all the hidden treasures, but you don\'t know yet that there is a wicked wizard standing against you and craving to tangle up these roads and impede your achievements.The treasure map is represented as an undirected graph in which vertices correspond to junctions and edges correspond to roads. Your path begins at a certain fixed vertex with a label known to you. Every time you come to a vertex that you have not been to before, you dig up a treasure chest and put a flag in this vertex. At the initial vertex you\'ll find a treasure chest immediately and, consequently, you\'ll put a flag there immediately as well.When you are standing at the junction you can see for each of the adjacent vertices its degree and if there is a flag there. There are no other things you can see from there. Besides, the power of the wicked wizard is so great that he is able to change the location of the roads and junctions on the map without changing the graph structure. Therefore, the sequence of the roads coming from the junction v might be different each time you come in the junction v. However, keep in mind that the set of adjacent crossroads does not change, and you are well aware of previously dug treasures at each adjacent to v vertex.Your goal is to collect treasures from all vertices of the graph as fast as you can. Good luck in hunting!" -999
1638F "Two Posters" "brute force,data structures,greedy,two pointers" "You want to advertise your new business, so you are going to place two posters on a billboard in the city center. The billboard consists of n vertical panels of width 1 and varying integer heights, held together by a horizontal bar. The i-th of the n panels has height hi.  Initially, all panels hang down from the bar (their top edges lie on it), but before placing the two posters, you are allowed to move each panel up by any integer length, as long as it is still connected to the bar (its bottom edge lies below or on it).After the moves are done, you will place two posters: one below the bar and one above it. They are not allowed to go over the bar and they must be positioned completely inside of the panels.What is the maximum total area the two posters can cover together if you make the optimal moves? Note that you can also place a poster of 0 area. This case is equivalent to placing a single poster." 3200
1638E "Colorful Operations" "brute force,data structures,implementation" "You have an array a1,a2,\xe2\x80\xa6,an. Each element initially has value 0 and color 1. You are also given q queries to perform:   Color l r c: Change the color of elements al,al+1,\xe2\x8b\xaf,ar to c (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n, 1\xe2\x89\xa4c\xe2\x89\xa4n).  Add c x: Add x to values of all elements ai (1\xe2\x89\xa4i\xe2\x89\xa4n) of color c (1\xe2\x89\xa4c\xe2\x89\xa4n, \xe2\x88\x92109\xe2\x89\xa4x\xe2\x89\xa4109).  Query i: Print ai (1\xe2\x89\xa4i\xe2\x89\xa4n)." 2400
1638D "Big Brush" "constructive algorithms,data structures,greedy,implementation" "You found a painting on a canvas of size n\xc3\x97m. The canvas can be represented as a grid with n rows and m columns. Each cell has some color. Cell (i,j) has color ci,j.Near the painting you also found a brush in the shape of a 2\xc3\x972 square, so the canvas was surely painted in the following way: initially, no cell was painted. Then, the following painting operation has been performed some number of times:  Choose two integers i and j (1\xe2\x89\xa4i<n, 1\xe2\x89\xa4j<m) and some color k (1\xe2\x89\xa4k\xe2\x89\xa4nm).  Paint cells (i,j), (i+1,j), (i,j+1), (i+1,j+1) in color k. All cells must be painted at least once. A cell can be painted multiple times. In this case, its final color will be the last one.Find any sequence of at most nm operations that could have led to the painting you found or state that it\'s impossible." 2000
1638C "Inversion Graph" "data structures,dsu,graphs,math" "You are given a permutation p1,p2,\xe2\x80\xa6,pn. Then, an undirected graph is constructed in the following way: add an edge between vertices i, j such that i<j if and only if pi>pj. Your task is to count the number of connected components in this graph.Two vertices u and v belong to the same connected component if and only if there is at least one path along edges connecting u and v.A permutation is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array) and [1,3,4] is also not a permutation (n=3 but there is 4 in the array)." 1300
1638B "Odd Swap Sort" "data structures,math,sortings" "You are given an array a1,a2,\xe2\x80\xa6,an. You can perform operations on the array. In each operation you can choose an integer i (1\xe2\x89\xa4i<n), and swap elements ai and ai+1 of the array, if ai+ai+1 is odd.Determine whether it can be sorted in non-decreasing order using this operation any number of times." 1100
1638A Reverse "constructive algorithms,greedy,math" "You are given a permutation p1,p2,\xe2\x80\xa6,pn of length n. You have to choose two integers l,r (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n) and reverse the subsegment [l,r] of the permutation. The permutation will become p1,p2,\xe2\x80\xa6,pl\xe2\x88\x921,pr,pr\xe2\x88\x921,\xe2\x80\xa6,pl,pr+1,pr+2,\xe2\x80\xa6,pn.Find the lexicographically smallest permutation that can be obtained by performing exactly one reverse operation on the initial permutation.Note that for two distinct permutations of equal length a and b, a is lexicographically smaller than b if at the first position they differ, a has the smaller element.A permutation is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array) and [1,3,4] is also not a permutation (n=3 but there is 4 in the array)." 800
1637H "Minimize Inversions Number" "data structures,greedy,math,sortings" "You are given a permutation p of length n.You can choose any subsequence, remove it from the permutation, and insert it at the beginning of the permutation keeping the same order.For every k from 0 to n, find the minimal possible number of inversions in the permutation after you choose a subsequence of length exactly k." 3500
1637G Birthday "constructive algorithms,greedy,math" "Vitaly gave Maxim n numbers 1,2,\xe2\x80\xa6,n for his 16-th birthday. Maxim was tired of playing board games during the celebration, so he decided to play with these numbers. In one step Maxim can choose two numbers x and y from the numbers he has, throw them away, and add two numbers x+y and |x\xe2\x88\x92y| instead. He wants all his numbers to be equal after several steps and the sum of the numbers to be minimal.Help Maxim to find a solution. Maxim\'s friends don\'t want to wait long, so the number of steps in the solution should not exceed 20n. It is guaranteed that under the given constraints, if a solution exists, then there exists a solution that makes all numbers equal, minimizes their sum, and spends no more than 20n moves." 3000
1637F Towers "constructive algorithms,dfs and similar,dp,greedy,trees" "You are given a tree with n vertices numbered from 1 to n. The height of the i-th vertex is hi. You can place any number of towers into vertices, for each tower you can choose which vertex to put it in, as well as choose its efficiency. Setting up a tower with efficiency e costs e coins, where e>0.It is considered that a vertex x gets a signal if for some pair of towers at the vertices u and v (u\xe2\x89\xa0v, but it is allowed that x=u or x=v) with efficiencies eu and ev, respectively, it is satisfied that min(eu,ev)\xe2\x89\xa5hx and x lies on the path between u and v.Find the minimum number of coins required to set up towers so that you can get a signal at all vertices." 2500
1637E "Best Pair" "binary search,brute force,implementation" "You are given an array a of length n. Let cntx be the number of elements from the array which are equal to x. Let\'s also define f(x,y) as (cntx+cnty)\xe2\x8b\x85(x+y).Also you are given m bad pairs (xi,yi). Note that if (x,y) is a bad pair, then (y,x) is also bad.Your task is to find the maximum value of f(u,v) over all pairs (u,v), such that u\xe2\x89\xa0v, that this pair is not bad, and also that u and v each occur in the array a. It is guaranteed that such a pair exists." 2100
1637D "Yet Another Minimization Problem" dp,greedy,math "You are given two arrays a and b, both of length n.You can perform the following operation any number of times (possibly zero): select an index i (1\xe2\x89\xa4i\xe2\x89\xa4n) and swap ai and bi.Let\'s define the cost of the array a as \xe2\x88\x91ni=1\xe2\x88\x91nj=i+1(ai+aj)2. Similarly, the cost of the array b is \xe2\x88\x91ni=1\xe2\x88\x91nj=i+1(bi+bj)2.Your task is to minimize the total cost of two arrays." 1800
1637C "Andrew and Stones" greedy,implementation "Andrew has n piles with stones. The i-th pile contains ai stones. He wants to make his table clean so he decided to put every stone either to the 1-st or the n-th pile.Andrew can perform the following operation any number of times: choose 3 indices 1\xe2\x89\xa4i<j<k\xe2\x89\xa4n, such that the j-th pile contains at least 2 stones, then he takes 2 stones from the pile j and puts one stone into pile i and one stone into pile k. Tell Andrew what is the minimum number of operations needed to move all the stones to piles 1 and n, or determine if it\'s impossible." 1200
1637B "MEX and Array" "brute force,dp,greedy,math" "Let there be an array b1,b2,\xe2\x80\xa6,bk. Let there be a partition of this array into segments [l1;r1],[l2;r2],\xe2\x80\xa6,[lc;rc], where l1=1, rc=k, and for any 2\xe2\x89\xa4i\xe2\x89\xa4c holds that ri\xe2\x88\x921+1=li. In other words, each element of the array belongs to exactly one segment.Let\'s define the cost of a partition as c+c\xe2\x88\x91i=1mex({bli,bli+1,\xe2\x80\xa6,bri}), where mex of a set of numbers S is the smallest non-negative integer that does not occur in the set S. In other words, the cost of a partition is the number of segments plus the sum of MEX over all segments. Let\'s define the value of an array b1,b2,\xe2\x80\xa6,bk as the maximum possible cost over all partitions of this array.You are given an array a of size n. Find the sum of values of all its subsegments.An array x is a subsegment of an array y if x can be obtained from y by deletion of several (possibly, zero or all) elements from the beginning and several (possibly, zero or all) elements from the end." 1100
1637A "Sorting Parts" "brute force,sortings" "You have an array a of length n. You can exactly once select an integer len between 1 and n\xe2\x88\x921 inclusively, and then sort in non-decreasing order the prefix of the array of length len and the suffix of the array of length n\xe2\x88\x92len independently.For example, if the array is a=[3,1,4,5,2], and you choose len=2, then after that the array will be equal to [1,3,2,4,5].Could it be that after performing this operation, the array will not be sorted in non-decreasing order?" 800
1635F "Closest Pair" "data structures,greedy" "There are n weighted points on the OX-axis. The coordinate and the weight of the i-th point is xi and wi, respectively. All points have distinct coordinates and positive weights. Also, xi<xi+1 holds for any 1\xe2\x89\xa4i<n. The weighted distance between i-th point and j-th point is defined as |xi\xe2\x88\x92xj|\xe2\x8b\x85(wi+wj), where |val| denotes the absolute value of val.You should answer q queries, where the i-th query asks the following: Find the minimum weighted distance among all pairs of distinct points among the points in subarray [li,ri]." 2800
1635E Cars "2-sat,constructive algorithms,dfs and similar,dsu,graphs,greedy,sortings" "There are n cars on a coordinate axis OX. Each car is located at an integer point initially and no two cars are located at the same point. Also, each car is oriented either left or right, and they can move at any constant positive speed in that direction at any moment.More formally, we can describe the i-th car with a letter and an integer: its orientation orii and its location xi. If orii=L, then xi is decreasing at a constant rate with respect to time. Similarly, if orii=R, then xi is increasing at a constant rate with respect to time. We call two cars irrelevant if they never end up in the same point regardless of their speed. In other words, they won\'t share the same coordinate at any moment.We call two cars destined if they always end up in the same point regardless of their speed. In other words, they must share the same coordinate at some moment.Unfortunately, we lost all information about our cars, but we do remember m relationships. There are two types of relationships:1 i j \xe2\x80\x94i-th car and j-th car are irrelevant.2 i j \xe2\x80\x94i-th car and j-th car are destined.Restore the orientations and the locations of the cars satisfying the relationships, or report that it is impossible. If there are multiple solutions, you can output any.Note that if two cars share the same coordinate, they will intersect, but at the same moment they will continue their movement in their directions." 2200
1635D "Infinite Set" "bitmasks,dp,math,matrices,number theory,strings" "You are given an array a consisting of n distinct positive integers.Let\'s consider an infinite integer set S which contains all integers x that satisfy at least one of the following conditions: x=ai for some 1\xe2\x89\xa4i\xe2\x89\xa4n. x=2y+1 and y is in S. x=4y and y is in S.For example, if a=[1,2] then the 10 smallest elements in S will be {1,2,3,4,5,7,8,9,11,12}.Find the number of elements in S that are strictly smaller than 2p. Since this number may be too large, print it modulo 109+7." 1800
1635C "Differential Sorting" "constructive algorithms,greedy" "You are given an array a of n elements. Your can perform the following operation no more than n times: Select three indices x,y,z (1\xe2\x89\xa4x<y<z\xe2\x89\xa4n) and replace ax with ay\xe2\x88\x92az. After the operation, |ax| need to be less than 1018.Your goal is to make the resulting array non-decreasing. If there are multiple solutions, you can output any. If it is impossible to achieve, you should report it as well." 1200
1635B "Avoid Local Maximums" greedy "You are given an array a of size n. Each element in this array is an integer between 1 and 109.You can perform several operations to this array. During an operation, you can replace an element in the array with any integer between 1 and 109. Output the minimum number of operations needed such that the resulting array doesn\'t contain any local maximums, and the resulting array after the operations.An element ai is a local maximum if it is strictly larger than both of its neighbors (that is, ai>ai\xe2\x88\x921 and ai>ai+1). Since a1 and an have only one neighbor each, they will never be a local maximum." 800
1635A "Min Or Sum" bitmasks,greedy "You are given an array a of size n.You can perform the following operation on the array:   Choose two different integers i,j (1\xe2\x89\xa4i<j\xe2\x89\xa4n), replace ai with x and aj with y. In order not to break the array, ai|aj=x|y must be held, where | denotes the bitwise OR operation. Notice that x and y are non-negative integers. Please output the minimum sum of the array you can get after using the operation above any number of times." 800
1634F "Fibonacci Additions" "brute force,data structures,hashing,implementation,math" "One of my most productive days was throwing away 1,000 lines of code.\xe2\x80\x94 Ken ThompsonFibonacci addition is an operation on an array X of integers, parametrized by indices l and r. Fibonacci addition increases Xl by F1, increases Xl+1 by F2, and so on up to Xr which is increased by Fr\xe2\x88\x92l+1.Fi denotes the i-th Fibonacci number (F1=1, F2=1, Fi=Fi\xe2\x88\x921+Fi\xe2\x88\x922 for i>2), and all operations are performed modulo MOD.You are given two arrays A and B of the same length. We will ask you to perform several Fibonacci additions on these arrays with different parameters, and after each operation you have to report whether arrays A and B are equal modulo MOD." 2700
1634E "Fair Share" "constructive algorithms,data structures,dfs and similar,graph matchings,graphs" "Even a cat has things it can do that AI cannot.\xe2\x80\x94 Fei-Fei LiYou are given m arrays of positive integers. Each array is of even length.You need to split all these integers into two equal multisets L and R, that is, each element of each array should go into one of two multisets (but not both). Additionally, for each of the m arrays, exactly half of its elements should go into L, and the rest should go into R.Give an example of such a division or determine that no such division exists." 2400
1634D "Finding Zero" "constructive algorithms,interactive,math" "This is an interactive problem.We picked an array of whole numbers a1,a2,\xe2\x80\xa6,an (0\xe2\x89\xa4ai\xe2\x89\xa4109) and concealed exactly one zero in it! Your goal is to find the location of this zero, that is, to find i such that ai=0.You are allowed to make several queries to guess the answer. For each query, you can think up three distinct indices i,j,k, and we will tell you the value of max(ai,aj,ak)\xe2\x88\x92min(ai,aj,ak). In other words, we will tell you the difference between the maximum and the minimum number among ai, aj and ak.You are allowed to make no more than 2\xe2\x8b\x85n\xe2\x88\x922 queries, and after that you have two tries to guess where the zero is. That is, you have to tell us two numbers i and j and you win if ai=0 or aj=0.Can you guess where we hid the zero?Note that the array in each test case is fixed beforehand and will not change during the game. In other words, the interactor is not adaptive." 2000
1634C OKEA "constructive algorithms" "People worry that computers will get too smart and take over the world, but the real problem is that they\'re too stupid and they\'ve already taken over the world.\xe2\x80\x94 Pedro DomingosYou work for a well-known department store that uses leading technologies and employs mechanistic work \xe2\x80\x94 that is, robots!The department you work in sells n\xe2\x8b\x85k items. The first item costs 1 dollar, the second item costs 2 dollars, and so on: i-th item costs i dollars. The items are situated on shelves. The items form a rectangular grid: there are n shelves in total, and each shelf contains exactly k items. We will denote by ai,j the price of j-th item (counting from the left) on the i-th shelf, 1\xe2\x89\xa4i\xe2\x89\xa4n,1\xe2\x89\xa4j\xe2\x89\xa4k.Occasionally robots get curious and ponder on the following question: what is the mean price (arithmetic average) of items ai,l,ai,l+1,\xe2\x80\xa6,ai,r for some shelf i and indices l\xe2\x89\xa4r? Unfortunately, the old robots can only work with whole numbers. If the mean price turns out not to be an integer, they break down.You care about robots\' welfare. You want to arrange the items in such a way that the robots cannot theoretically break. Formally, you want to choose such a two-dimensional array a that:  Every number from 1 to n\xe2\x8b\x85k (inclusively) occurs exactly once.  For each i,l,r, the mean price of items from l to r on i-th shelf is an integer. Find out if such an arrangement is possible, and if it is, give any example of such arrangement." 1000
1634B "Fortune Telling" bitmasks,math "Haha, try to solve this, SelectorUnlimited!\xe2\x80\x94 antontrygubO_oYour friends Alice and Bob practice fortune telling.Fortune telling is performed as follows. There is a well-known array a of n non-negative integers indexed from 1 to n. The tellee starts with some non-negative number d and performs one of the two operations for each i=1,2,\xe2\x80\xa6,n, in the increasing order of i. The possible operations are: replace their current number d with d+ai replace their current number d with d\xe2\x8a\x95ai (hereinafter \xe2\x8a\x95 denotes the bitwise XOR operation)Notice that the chosen operation may be different for different i and for different tellees.One time, Alice decided to start with d=x and Bob started with d=x+3. Each of them performed fortune telling and got a particular number in the end. Notice that the friends chose operations independently of each other, that is, they could apply different operations for the same i.You learnt that either Alice or Bob ended up with number y in the end, but you don\'t know whose of the two it was. Given the numbers Alice and Bob started with and y, find out who (Alice or Bob) could get the number y after performing the operations. It is guaranteed that on the jury tests, exactly one of your friends could have actually gotten that number.HacksYou cannot make hacks in this problem." 1400
1634A "Reverse and Concatenate" greedy,strings "Real stupidity beats artificial intelligence every time.\xe2\x80\x94 Terry Pratchett, Hogfather, DiscworldYou are given a string s of length n and a number k. Let\'s denote by rev(s) the reversed string s (i.e. rev(s)=snsn\xe2\x88\x921...s1). You can apply one of the two kinds of operations to the string: replace the string s with s+rev(s) replace the string s with rev(s)+sHow many different strings can you get as a result of performing exactly k operations (possibly of different kinds) on the original string s?In this statement we denoted the concatenation of strings s and t as s+t. In other words, s+t=s1s2...snt1t2...tm, where n and m are the lengths of strings s and t respectively." 800
1633F "Perfect Matching" "data structures,divide and conquer,interactive,trees" "You are given a tree consisting of n vertices (numbered from 1 to n) and n\xe2\x88\x921 edges (numbered from 1 to n\xe2\x88\x921). Initially, all vertices except vertex 1 are inactive.You have to process queries of three types:  1 v \xe2\x80\x94 activate the vertex v. It is guaranteed that the vertex v is inactive before this query, and one of its neighbors is active. After activating the vertex, you have to choose a subset of edges of the tree such that each active vertex is incident to exactly one chosen edge, and each inactive vertex is not incident to any of the chosen edges \xe2\x80\x94 in other words, this subset should represent a perfect matching on the active part of the tree. If any such subset of edges exists, print the sum of indices of edges in it; otherwise, print 0.  2 \xe2\x80\x94 queries of this type will be asked only right after a query of type 1, and there will be at most 10 such queries. If your answer to the previous query was 0, simply print 0; otherwise, print the subset of edges for the previous query as follows: first, print the number of edges in the subset, then print the indices of the chosen edges in ascending order. The sum of indices should be equal to your answer to the previous query.  3 \xe2\x80\x94 terminate the program. Note that you should solve the problem in online mode. It means that you can\'t read the whole input at once. You can read each query only after writing the answer for the last query. Use functions fflush in C++ and BufferedWriter.flush in Java languages after each writing in your program." 2800
1633E "Spanning Tree Queries" "binary search,data structures,dfs and similar,dsu,graphs,greedy,math,sortings,trees" "You are given a connected weighted undirected graph, consisting of n vertices and m edges.You are asked k queries about it. Each query consists of a single integer x. For each query, you select a spanning tree in the graph. Let the weights of its edges be w1,w2,\xe2\x80\xa6,wn\xe2\x88\x921. The cost of a spanning tree is n\xe2\x88\x921\xe2\x88\x91i=1|wi\xe2\x88\x92x| (the sum of absolute differences between the weights and x). The answer to a query is the lowest cost of a spanning tree.The queries are given in a compressed format. The first p (1\xe2\x89\xa4p\xe2\x89\xa4k) queries q1,q2,\xe2\x80\xa6,qp are provided explicitly. For queries from p+1 to k, qj=(qj\xe2\x88\x921\xe2\x8b\x85a+b)modc.Print the xor of answers to all queries." 2400
1633D "Make Them Equal" dp,greedy "You have an array of integers a of size n. Initially, all elements of the array are equal to 1. You can perform the following operation: choose two integers i (1\xe2\x89\xa4i\xe2\x89\xa4n) and x (x>0), and then increase the value of ai by \xe2\x8c\x8aaix\xe2\x8c\x8b (i.e. make ai=ai+\xe2\x8c\x8aaix\xe2\x8c\x8b).After performing all operations, you will receive ci coins for all such i that ai=bi.Your task is to determine the maximum number of coins that you can receive by performing no more than k operations." 1600
1633C "Kill the Monster" "brute force,math" "Monocarp is playing a computer game. In this game, his character fights different monsters.A fight between a character and a monster goes as follows. Suppose the character initially has health hC and attack dC; the monster initially has health hM and attack dM. The fight consists of several steps:  the character attacks the monster, decreasing the monster\'s health by dC;  the monster attacks the character, decreasing the character\'s health by dM;  the character attacks the monster, decreasing the monster\'s health by dC;  the monster attacks the character, decreasing the character\'s health by dM;  and so on, until the end of the fight. The fight ends when someone\'s health becomes non-positive (i.\xe2\x80\x89e. 0 or less). If the monster\'s health becomes non-positive, the character wins, otherwise the monster wins.Monocarp\'s character currently has health equal to hC and attack equal to dC. He wants to slay a monster with health equal to hM and attack equal to dM. Before the fight, Monocarp can spend up to k coins to upgrade his character\'s weapon and/or armor; each upgrade costs exactly one coin, each weapon upgrade increases the character\'s attack by w, and each armor upgrade increases the character\'s health by a.Can Monocarp\'s character slay the monster if Monocarp spends coins on upgrades optimally?" 1100
1633B Minority greedy "You are given a string s, consisting only of characters \'0\' and \'1\'.You have to choose a contiguous substring of s and remove all occurrences of the character, which is a strict minority in it, from the substring.That is, if the amount of \'0\'s in the substring is strictly smaller than the amount of \'1\'s, remove all occurrences of \'0\' from the substring. If the amount of \'1\'s is strictly smaller than the amount of \'0\'s, remove all occurrences of \'1\'. If the amounts are the same, do nothing.You have to apply the operation exactly once. What is the maximum amount of characters that can be removed?" 800
1633A "Div. 7" "brute force" "You are given an integer n. You have to change the minimum number of digits in it in such a way that the resulting number does not have any leading zeroes and is divisible by 7.If there are multiple ways to do it, print any of them. If the given number is already divisible by 7, leave it unchanged." 800
1632E2 "Distance Tree (hard version)" "binary search,dfs and similar,shortest paths,trees" "This version of the problem differs from the previous one only in the constraint on n.A tree is a connected undirected graph without cycles. A weighted tree has a weight assigned to each edge. The distance between two vertices is the minimum sum of weights on the path connecting them.You are given a weighted tree with n vertices, each edge has a weight of 1. Denote d(v) as the distance between vertex 1 and vertex v.Let f(x) be the minimum possible value of max1\xe2\x89\xa4v\xe2\x89\xa4n d(v) if you can temporarily add an edge with weight x between any two vertices a and b (1\xe2\x89\xa4a,b\xe2\x89\xa4n). Note that after this operation, the graph is no longer a tree.For each integer x from 1 to n, find f(x)." 2700
1632E1 "Distance Tree (easy version)" "binary search,data structures,dfs and similar,graphs,shortest paths,trees" "This version of the problem differs from the next one only in the constraint on n.A tree is a connected undirected graph without cycles. A weighted tree has a weight assigned to each edge. The distance between two vertices is the minimum sum of weights on the path connecting them.You are given a weighted tree with n vertices, each edge has a weight of 1. Denote d(v) as the distance between vertex 1 and vertex v.Let f(x) be the minimum possible value of max1\xe2\x89\xa4v\xe2\x89\xa4n d(v) if you can temporarily add an edge with weight x between any two vertices a and b (1\xe2\x89\xa4a,b\xe2\x89\xa4n). Note that after this operation, the graph is no longer a tree.For each integer x from 1 to n, find f(x)." 2400
1632D "New Year Concert" "binary search,data structures,greedy,math,number theory,two pointers" "New Year is just around the corner, which means that in School 179, preparations for the concert are in full swing.There are n classes in the school, numbered from 1 to n, the i-th class has prepared a scene of length ai minutes.As the main one responsible for holding the concert, Idnar knows that if a concert has k scenes of lengths b1, b2, \xe2\x80\xa6, bk minutes, then the audience will get bored if there exist two integers l and r such that 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4k and gcd(bl,bl+1,\xe2\x80\xa6,br\xe2\x88\x921,br)=r\xe2\x88\x92l+1, where gcd(bl,bl+1,\xe2\x80\xa6,br\xe2\x88\x921,br) is equal to the greatest common divisor (GCD) of the numbers bl, bl+1, \xe2\x80\xa6, br\xe2\x88\x921, br.To avoid boring the audience, Idnar can ask any number of times (possibly zero) for the t-th class (1\xe2\x89\xa4t\xe2\x89\xa4k) to make a new scene d minutes in length, where d can be any positive integer. Thus, after this operation, bt is equal to d. Note that t and d can be different for each operation.For a sequence of scene lengths b1, b2, \xe2\x80\xa6, bk, let f(b) be the minimum number of classes Idnar has to ask to change their scene if he wants to avoid boring the audience.Idnar hasn\'t decided which scenes will be allowed for the concert, so he wants to know the value of f for each non-empty prefix of a. In other words, Idnar wants to know the values of f(a1), f(a1,a2), \xe2\x80\xa6, f(a1,a2,\xe2\x80\xa6,an)." 2000
1632C "Strange Test" "binary search,bitmasks,brute force,dp,math" "Igor is in 11th grade. Tomorrow he will have to write an informatics test by the strictest teacher in the school, Pavel Denisovich. Igor knows how the test will be conducted: first of all, the teacher will give each student two positive integers a and b (a<b). After that, the student can apply any of the following operations any number of times:   a:=a+1 (increase a by 1),  b:=b+1 (increase b by 1),  a:=a | b (replace a with the bitwise OR of a and b). To get full marks on the test, the student has to tell the teacher the minimum required number of operations to make a and b equal.Igor already knows which numbers the teacher will give him. Help him figure out what is the minimum number of operations needed to make a equal to b." 1600
1632B "Roof Construction" "bitmasks,constructive algorithms" "It has finally been decided to build a roof over the football field in School 179. Its construction will require placing n consecutive vertical pillars. Furthermore, the headmaster wants the heights of all the pillars to form a permutation p of integers from 0 to n\xe2\x88\x921, where pi is the height of the i-th pillar from the left (1\xe2\x89\xa4i\xe2\x89\xa4n).As the chief, you know that the cost of construction of consecutive pillars is equal to the maximum value of the bitwise XOR of heights of all pairs of adjacent pillars. In other words, the cost of construction is equal to max1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921pi\xe2\x8a\x95pi+1, where \xe2\x8a\x95 denotes the bitwise XOR operation.Find any sequence of pillar heights p of length n with the smallest construction cost.In this problem, a permutation is an array consisting of n distinct integers from 0 to n\xe2\x88\x921 in arbitrary order. For example, [2,3,1,0,4] is a permutation, but [1,0,1] is not a permutation (1 appears twice in the array) and [1,0,3] is also not a permutation (n=3, but 3 is in the array)." 1000
1632A ABC implementation "Recently, the students of School 179 have developed a unique algorithm, which takes in a binary string s as input. However, they soon found out that if some substring t of s is a palindrome of length greater than 1, the algorithm will work incorrectly. Can the students somehow reorder the characters of s so that the algorithm will work correctly on the string?A binary string is a string where each character is either 0 or 1.A string a is a substring of a string b if a can be obtained from b by deletion of several (possibly, zero or all) characters from the beginning and several (possibly, zero or all) characters from the end.A palindrome is a string that reads the same backwards as forwards." 800
1631B "Fun with Even Subarrays" dp,greedy "You are given an array a of n elements. You can apply the following operation to it any number of times:  Select some subarray from a of even size 2k that begins at position l (1\xe2\x89\xa4l\xe2\x89\xa4l+2\xe2\x8b\x85k\xe2\x88\x921\xe2\x89\xa4n, k\xe2\x89\xa51) and for each i between 0 and k\xe2\x88\x921 (inclusive), assign the value al+k+i to al+i. For example, if a=[2,1,3,4,5,3], then choose l=1 and k=2, applying this operation the array will become a=[3,4,3,4,5,3].Find the minimum number of operations (possibly zero) needed to make all the elements of the array equal." 1100
1631A "Min Max Swap" greedy "You are given two arrays a and b of n positive integers each. You can apply the following operation to them any number of times:  Select an index i (1\xe2\x89\xa4i\xe2\x89\xa4n) and swap ai with bi (i. e. ai becomes bi and vice versa). Find the minimum possible value of max(a1,a2,\xe2\x80\xa6,an)\xe2\x8b\x85max(b1,b2,\xe2\x80\xa6,bn) you can get after applying such operation any number of times (possibly zero)." 800
1630F "Making It Bipartite" "flows,graph matchings,graphs,number theory" "You are given an undirected graph of n vertices indexed from 1 to n, where vertex i has a value ai assigned to it and all values ai are different. There is an edge between two vertices u and v if either au divides av or av divides au.Find the minimum number of vertices to remove such that the remaining graph is bipartite, when you remove a vertex you remove all the edges incident to it." 3400
1630E "Expected Components" "combinatorics,math,number theory,probabilities" "Given a cyclic array a of size n, where ai is the value of a in the i-th position, there may be repeated values. Let us define that a permutation of a is equal to another permutation of a if and only if their values are the same for each position i or we can transform them to each other by performing some cyclic rotation. Let us define for a cyclic array b its number of components as the number of connected components in a graph, where the vertices are the positions of b and we add an edge between each pair of adjacent positions of b with equal values (note that in a cyclic array the first and last position are also adjacents).Find the expected value of components of a permutation of a if we select it equiprobably over the set of all the different permutations of a." 2900
1630D "Flipping Range" "constructive algorithms,dp,greedy,number theory" "You are given an array a of n integers and a set B of m positive integers such that 1\xe2\x89\xa4bi\xe2\x89\xa4\xe2\x8c\x8an2\xe2\x8c\x8b for 1\xe2\x89\xa4i\xe2\x89\xa4m, where bi is the i-th element of B. You can make the following operation on a:  Select some x such that x appears in B. Select an interval from array a of size x and multiply by \xe2\x88\x921 every element in the interval. Formally, select l and r such that 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n and r\xe2\x88\x92l+1=x, then assign ai:=\xe2\x88\x92ai for every i such that l\xe2\x89\xa4i\xe2\x89\xa4r. Consider the following example, let a=[0,6,\xe2\x88\x922,1,\xe2\x88\x924,5] and B={1,2}:  [0,6,\xe2\x88\x922,\xe2\x88\x921,4,5] is obtained after choosing size 2 and l=4, r=5. [0,6,2,\xe2\x88\x921,4,5] is obtained after choosing size 1 and l=3, r=3. Find the maximum n\xe2\x88\x91i=1ai you can get after applying such operation any number of times (possibly zero)." 2400
1630C "Paint the Middle" "dp,greedy,sortings,two pointers" "You are given n elements numbered from 1 to n, the element i has value ai and color ci, initially, ci=0 for all i.The following operation can be applied:  Select three elements i, j and k (1\xe2\x89\xa4i<j<k\xe2\x89\xa4n), such that ci, cj and ck are all equal to 0 and ai=ak, then set cj=1. Find the maximum value of n\xe2\x88\x91i=1ci that can be obtained after applying the given operation any number of times." 2200
1630B "Range and Partition" "binary search,constructive algorithms,data structures,greedy,two pointers" "Given an array a of n integers, find a range of values [x,y] (x\xe2\x89\xa4y), and split a into exactly k (1\xe2\x89\xa4k\xe2\x89\xa4n) subarrays in such a way that:  Each subarray is formed by several continuous elements of a, that is, it is equal to al,al+1,\xe2\x80\xa6,ar for some l and r (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n).  Each element from a belongs to exactly one subarray.  In each subarray the number of elements inside the range [x,y] (inclusive) is strictly greater than the number of elements outside the range. An element with index i is inside the range [x,y] if and only if x\xe2\x89\xa4ai\xe2\x89\xa4y.  Print any solution that minimizes y\xe2\x88\x92x." 1800
1630A "And Matching" "bitmasks,constructive algorithms" "You are given a set of n (n is always a power of 2) elements containing all integers 0,1,2,\xe2\x80\xa6,n\xe2\x88\x921 exactly once.Find n2 pairs of elements such that:  Each element in the set is in exactly one pair.  The sum over all pairs of the bitwise AND of its elements must be exactly equal to k. Formally, if ai and bi are the elements of the i-th pair, then the following must hold: n/2\xe2\x88\x91i=1ai&bi=k, where & denotes the bitwise AND operation. If there are many solutions, print any of them, if there is no solution, print \xe2\x88\x921 instead." 1500
1629B "GCD Arrays" "greedy,math,number theory" "Consider the array a composed of all the integers in the range [l,r]. For example, if l=3 and r=7, then a=[3,4,5,6,7].Given l, r, and k, is it possible for gcd(a) to be greater than 1 after doing the following operation at most k times?   Choose 2 numbers from a.  Permanently remove one occurrence of each of them from the array.  Insert their product back into a. gcd(b) denotes the greatest common divisor (GCD) of the integers in b." 800
1629A "Download More RAM" "brute force,greedy,sortings" "Did you know you can download more RAM? There is a shop with n different pieces of software that increase your RAM. The i-th RAM increasing software takes ai GB of memory to run (temporarily, once the program is done running, you get the RAM back), and gives you an additional bi GB of RAM (permanently). Each software can only be used once. Your PC currently has k GB of RAM.Note that you can\'t use a RAM-increasing software if it takes more GB of RAM to use than what you currently have.Since RAM is the most important thing in the world, you wonder, what is the maximum possible amount of RAM achievable?" 800
1628F "Spaceship Crisis Management" "binary search,data structures,geometry,sortings" "NASA (Norwegian Astronaut Stuff Association) is developing a new steering system for spaceships. But in its current state, it wouldn\'t be very safe if the spaceship would end up in a bunch of space junk. To make the steering system safe, they need to answer the following:Given the target position t=(0,0), a set of n pieces of space junk l described by line segments li=((aix,aiy),(bix,biy)), and a starting position s=(sx,sy), is there a direction such that floating in that direction from the starting position would lead to the target position?When the spaceship hits a piece of space junk, what happens depends on the absolute difference in angle between the floating direction and the line segment, \xce\xb8:  If \xce\xb8<45\xe2\x88\x98, the spaceship slides along the piece of space junk in the direction that minimizes the change in angle, and when the spaceship slides off the end of the space junk, it continues floating in the direction it came in (before hitting the space junk).  If \xce\xb8\xe2\x89\xa545\xe2\x88\x98, the spaceship stops, because there is too much friction to slide along the space junk. You are only given the set of pieces of space junk once, and the target position is always (0,0), but there are q queries, each with a starting position sj=(sjx,sjy).Answer the above question for each query." 3500
1628E "Groceries in Meteor Town" "binary search,data structures,dsu,trees" "Mihai lives in a town where meteor storms are a common problem. It\'s annoying, because Mihai has to buy groceries sometimes, and getting hit by meteors isn\'t fun. Therefore, we ask you to find the most dangerous way to buy groceries so that we can trick him to go there.The town has n buildings numbered from 1 to n. Some buildings have roads between them, and there is exactly 1 simple path from any building to any other building. Each road has a certain meteor danger level. The buildings all have grocery stores, but Mihai only cares about the open ones, of course. Initially, all the grocery stores are closed.You are given q queries of three types:  Given the integers l and r, the buildings numbered from l to r open their grocery stores (nothing happens to buildings in the range that already have an open grocery store). Given the integers l and r, the buildings numbered from l to r close their grocery stores (nothing happens to buildings in the range that didn\'t have an open grocery store). Given the integer x, find the maximum meteor danger level on the simple path from x to any open grocery store, or \xe2\x88\x921 if there is no edge on any simple path to an open store." 3100
1628D2 "Game on Sum (Hard Version)" combinatorics,dp,games,math "This is the hard version of the problem. The difference is the constraints on n, m and t. You can make hacks only if all versions of the problem are solved.Alice and Bob are given the numbers n, m and k, and play a game as follows:The game has a score that Alice tries to maximize, and Bob tries to minimize. The score is initially 0. The game consists of n turns. Each turn, Alice picks a real number from 0 to k (inclusive) which Bob either adds to or subtracts from the score of the game. But throughout the game, Bob has to choose to add at least m out of the n turns.Bob gets to know which number Alice picked before deciding whether to add or subtract the number from the score, and Alice gets to know whether Bob added or subtracted the number for the previous turn before picking the number for the current turn (except on the first turn since there was no previous turn).If Alice and Bob play optimally, what will the final score of the game be?" 2400
1628D1 "Game on Sum (Easy Version)" combinatorics,dp,games,math "This is the easy version of the problem. The difference is the constraints on n, m and t. You can make hacks only if all versions of the problem are solved.Alice and Bob are given the numbers n, m and k, and play a game as follows:The game has a score that Alice tries to maximize, and Bob tries to minimize. The score is initially 0. The game consists of n turns. Each turn, Alice picks a real number from 0 to k (inclusive) which Bob either adds to or subtracts from the score of the game. But throughout the game, Bob has to choose to add at least m out of the n turns.Bob gets to know which number Alice picked before deciding whether to add or subtract the number from the score, and Alice gets to know whether Bob added or subtracted the number for the previous turn before picking the number for the current turn (except on the first turn since there was no previous turn).If Alice and Bob play optimally, what will the final score of the game be?" 2100
1628C "Grid Xor" "constructive algorithms,greedy,implementation,interactive,math" "Note: The XOR-sum of set {s1,s2,\xe2\x80\xa6,sm} is defined as s1\xe2\x8a\x95s2\xe2\x8a\x95\xe2\x80\xa6\xe2\x8a\x95sm, where \xe2\x8a\x95 denotes the bitwise XOR operation.After almost winning IOI, Victor bought himself an n\xc3\x97n grid containing integers in each cell. n is an even integer. The integer in the cell in the i-th row and j-th column is ai,j.Sadly, Mihai stole the grid from Victor and told him he would return it with only one condition: Victor has to tell Mihai the XOR-sum of all the integers in the whole grid.Victor doesn\'t remember all the elements of the grid, but he remembers some information about it: For each cell, Victor remembers the XOR-sum of all its neighboring cells.Two cells are considered neighbors if they share an edge \xe2\x80\x94 in other words, for some integers 1\xe2\x89\xa4i,j,k,l\xe2\x89\xa4n, the cell in the i-th row and j-th column is a neighbor of the cell in the k-th row and l-th column if |i\xe2\x88\x92k|=1 and j=l, or if i=k and |j\xe2\x88\x92l|=1.To get his grid back, Victor is asking you for your help. Can you use the information Victor remembers to find the XOR-sum of the whole grid?It can be proven that the answer is unique." 2300
1628B "Peculiar Movie Preferences" greedy,strings "Mihai plans to watch a movie. He only likes palindromic movies, so he wants to skip some (possibly zero) scenes to make the remaining parts of the movie palindromic.You are given a list s of n non-empty strings of length at most 3, representing the scenes of Mihai\'s movie.A subsequence of s is called awesome if it is non-empty and the concatenation of the strings in the subsequence, in order, is a palindrome.Can you help Mihai check if there is at least one awesome subsequence of s?A palindrome is a string that reads the same backward as forward, for example strings ""z"", ""aaa"", ""aba"", ""abccba"" are palindromes, but strings ""codeforces"", ""reality"", ""ab"" are not.A sequence a is a non-empty subsequence of a non-empty sequence b if a can be obtained from b by deletion of several (possibly zero, but not all) elements." 1700
1628A "Meximum Array" "binary search,constructive algorithms,greedy,implementation,math,two pointers" "Mihai has just learned about the MEX concept and since he liked it so much, he decided to use it right away.Given an array a of n non-negative integers, Mihai wants to create a new array b that is formed in the following way:While a is not empty:   Choose an integer k (1\xe2\x89\xa4k\xe2\x89\xa4|a|).  Append the MEX of the first k numbers of the array a to the end of array b and erase them from the array a, shifting the positions of the remaining numbers in a. But, since Mihai loves big arrays as much as the MEX concept, he wants the new array b to be the lexicographically maximum. So, Mihai asks you to tell him what the maximum array b that can be created by constructing the array optimally is.An array x is lexicographically greater than an array y if in the first position where x and y differ xi>yi or if |x|>|y| and y is a prefix of x (where |x| denotes the size of the array x).The MEX of a set of non-negative integers is the minimal non-negative integer such that it is not in the set. For example, MEX({1,2,3}) =0 and MEX({0,1,2,4,5}) =3." 1400
1627F "Not Splitting" "geometry,graphs,greedy,implementation,shortest paths" "There is a k\xc3\x97k grid, where k is even. The square in row r and column c is denoted by (r,c). Two squares (r1,c1) and (r2,c2) are considered adjacent if |r1\xe2\x88\x92r2|+|c1\xe2\x88\x92c2|=1.An array of adjacent pairs of squares is called strong if it is possible to cut the grid along grid lines into two connected, congruent pieces so that each pair is part of the same piece. Two pieces are congruent if one can be matched with the other by translation, rotation, and reflection, or a combination of these.  The picture above represents the first test case. Arrows indicate pairs of squares, and the thick black line represents the cut. You are given an array a of n pairs of adjacent squares. Find the size of the largest strong subsequence of a. An array p is a subsequence of an array q if p can be obtained from q by deletion of several (possibly, zero or all) elements." 2700
1627E "Not Escaping" "data structures,dp,implementation,shortest paths,two pointers" "Major Ram is being chased by his arch enemy Raghav. Ram must reach the top of the building to escape via helicopter. The building, however, is on fire. Ram must choose the optimal path to reach the top of the building to lose the minimum amount of health.The building consists of n floors, each with m rooms each. Let (i,j) represent the j-th room on the i-th floor. Additionally, there are k ladders installed. The i-th ladder allows Ram to travel from (ai,bi) to (ci,di), but not in the other direction. Ram also gains hi health points if he uses the ladder i. It is guaranteed ai<ci for all ladders.If Ram is on the i-th floor, he can move either left or right. Travelling across floors, however, is treacherous. If Ram travels from (i,j) to (i,k), he loses |j\xe2\x88\x92k|\xe2\x8b\x85xi health points.Ram enters the building at (1,1) while his helicopter is waiting at (n,m). What is the minimum amount of health Ram loses if he takes the most optimal path? Note this answer may be negative (in which case he gains health). Output ""NO ESCAPE"" if no matter what path Ram takes, he cannot escape the clutches of Raghav." 2200
1627D "Not Adding" "brute force,dp,math,number theory" "You have an array a1,a2,\xe2\x80\xa6,an consisting of n distinct integers. You are allowed to perform the following operation on it:  Choose two elements from the array ai and aj (i\xe2\x89\xa0j) such that gcd(ai,aj) is not present in the array, and add gcd(ai,aj) to the end of the array. Here gcd(x,y) denotes greatest common divisor (GCD) of integers x and y. Note that the array changes after each operation, and the subsequent operations are performed on the new array.What is the maximum number of times you can perform the operation on the array?" 1900
1627C "Not Assigning" "constructive algorithms,dfs and similar,number theory,trees" "You are given a tree of n vertices numbered from 1 to n, with edges numbered from 1 to n\xe2\x88\x921. A tree is a connected undirected graph without cycles. You have to assign integer weights to each edge of the tree, such that the resultant graph is a prime tree.A prime tree is a tree where the weight of every path consisting of one or two edges is prime. A path should not visit any vertex twice. The weight of a path is the sum of edge weights on that path.Consider the graph below. It is a prime tree as the weight of every path of two or less edges is prime. For example, the following path of two edges: 2\xe2\x86\x921\xe2\x86\x923 has a weight of 11+2=13, which is prime. Similarly, the path of one edge: 4\xe2\x86\x923 has a weight of 5, which is also prime.  Print any valid assignment of weights such that the resultant tree is a prime tree. If there is no such assignment, then print \xe2\x88\x921. It can be proven that if a valid assignment exists, one exists with weights between 1 and 105 as well." 1400
1627B "Not Sitting" games,greedy,sortings "Rahul and Tina are looking forward to starting their new year at college. As they enter their new classroom, they observe the seats of students are arranged in a n\xc3\x97m grid. The seat in row r and column c is denoted by (r,c), and the distance between two seats (a,b) and (c,d) is |a\xe2\x88\x92c|+|b\xe2\x88\x92d|. As the class president, Tina has access to exactly k buckets of pink paint. The following process occurs.   First, Tina chooses exactly k seats in the classroom to paint with pink paint. One bucket of paint can paint exactly one seat.  After Tina has painted k seats in the previous step, Rahul chooses where he sits. He will not choose a seat that has been painted pink due to his hatred of the colour pink.  After Rahul has chosen his seat, Tina chooses a seat for herself. She can choose any of the seats, painted or not, other than the one chosen by Rahul. Rahul wants to choose a seat such that he sits as close to Tina as possible. However, Tina wants to sit as far away from Rahul as possible due to some complicated relationship history that we couldn\'t fit into the statement!Now, Rahul wonders for k=0,1,\xe2\x80\xa6,n\xe2\x8b\x85m\xe2\x88\x921, if Tina has k buckets of paint, how close can Rahul sit to Tina, if both Rahul and Tina are aware of each other\'s intentions and they both act as strategically as possible? Please help satisfy Rahul\'s curiosity!" 1300
1627A "Not Shading" "constructive algorithms,implementation" "There is a grid with n rows and m columns. Some cells are colored black, and the rest of the cells are colored white.In one operation, you can select some black cell and do exactly one of the following:   color all cells in its row black, or  color all cells in its column black. You are given two integers r and c. Find the minimum number of operations required to make the cell in row r and column c black, or determine that it is impossible." 800
1626F "A Random Code Problem" "combinatorics,dp,math,number theory,probabilities" "You are given an integer array a0,a1,\xe2\x80\xa6,an\xe2\x88\x921, and an integer k. You perform the following code with it:long long ans = 0; // create a 64-bit signed variable which is initially equal to 0for(int i = 1; i <= k; i++){  int idx = rnd.next(0, n - 1); // generate a random integer between 0 and n - 1, both inclusive                                // each integer from 0 to n - 1 has the same probability of being chosen  ans += a[idx];  a[idx] -= (a[idx] % i);}Your task is to calculate the expected value of the variable ans after performing this code.Note that the input is generated according to special rules (see the input format section)." 2800
1626E "Black and White Tree" "dfs and similar,greedy,trees" "You are given a tree consisting of n vertices. Some of the vertices (at least two) are black, all the other vertices are white.You place a chip on one of the vertices of the tree, and then perform the following operations:  let the current vertex where the chip is located is x. You choose a black vertex y, and then move the chip along the first edge on the simple path from x to y. You are not allowed to choose the same black vertex y in two operations in a row (i.\xe2\x80\x89e., for every two consecutive operations, the chosen black vertex should be different).You end your operations when the chip moves to the black vertex (if it is initially placed in a black vertex, you don\'t perform the operations at all), or when the number of performed operations exceeds 100500.For every vertex i, you have to determine if there exists a (possibly empty) sequence of operations that moves the chip to some black vertex, if the chip is initially placed on the vertex i." 2400
1626D "Martial Arts Tournament" "binary search,brute force,greedy,math" "Monocarp is planning to host a martial arts tournament. There will be three divisions based on weight: lightweight, middleweight and heavyweight. The winner of each division will be determined by a single elimination system.In particular, that implies that the number of participants in each division should be a power of two. Additionally, each division should have a non-zero amount of participants.n participants have registered for the tournament so far, the i-th of them weighs ai. To split participants into divisions, Monocarp is going to establish two integer weight boundaries x and y (x<y). All participants who weigh strictly less than x will be considered lightweight. All participants who weigh greater or equal to y will be considered heavyweight. The remaining participants will be considered middleweight.It\'s possible that the distribution doesn\'t make the number of participants in each division a power of two. It can also lead to empty divisions. To fix the issues, Monocarp can invite an arbitrary number of participants to each division.Note that Monocarp can\'t kick out any of the n participants who have already registered for the tournament.However, he wants to invite as little extra participants as possible. Help Monocarp to choose x and y in such a way that the total amount of extra participants required is as small as possible. Output that amount." 2100
1626C "Monsters And Spells" "binary search,data structures,dp,greedy,implementation,math,two pointers" "Monocarp is playing a computer game once again. He is a wizard apprentice, who only knows a single spell. Luckily, this spell can damage the monsters.The level he\'s currently on contains n monsters. The i-th of them appears ki seconds after the start of the level and has hi health points. As an additional constraint, hi\xe2\x89\xa4ki for all 1\xe2\x89\xa4i\xe2\x89\xa4n. All ki are different.Monocarp can cast the spell at moments which are positive integer amounts of second after the start of the level: 1,2,3,\xe2\x80\xa6 The damage of the spell is calculated as follows. If he didn\'t cast the spell at the previous second, the damage is 1. Otherwise, let the damage at the previous second be x. Then he can choose the damage to be either x+1 or 1. A spell uses mana: casting a spell with damage x uses x mana. Mana doesn\'t regenerate.To kill the i-th monster, Monocarp has to cast a spell with damage at least hi at the exact moment the monster appears, which is ki.Note that Monocarp can cast the spell even when there is no monster at the current second.The mana amount required to cast the spells is the sum of mana usages for all cast spells. Calculate the least amount of mana required for Monocarp to kill all monsters.It can be shown that it\'s always possible to kill all monsters under the constraints of the problem." 1700
1626B "Minor Reduction" greedy,strings "You are given a decimal representation of an integer x without leading zeros.You have to perform the following reduction on it exactly once: take two neighboring digits in x and replace them with their sum without leading zeros (if the sum is 0, it\'s represented as a single 0).For example, if x=10057, the possible reductions are:   choose the first and the second digits 1 and 0, replace them with 1+0=1; the result is 1057;  choose the second and the third digits 0 and 0, replace them with 0+0=0; the result is also 1057;  choose the third and the fourth digits 0 and 5, replace them with 0+5=5; the result is still 1057;  choose the fourth and the fifth digits 5 and 7, replace them with 5+7=12; the result is 10012. What\'s the largest number that can be obtained?" 1100
1626A "Equidistant Letters" "constructive algorithms,sortings" "You are given a string s, consisting of lowercase Latin letters. Every letter appears in it no more than twice.Your task is to rearrange the letters in the string in such a way that for each pair of letters that appear exactly twice, the distance between the letters in the pair is the same. You are not allowed to add or remove letters.It can be shown that the answer always exists. If there are multiple answers, print any of them." 800
1625E2 "Cats on the Upgrade (hard version)" "binary search,data structures,dfs and similar,graphs,trees" "This is the hard version of the problem. The only difference between the easy and the hard versions are removal queries, they are present only in the hard version.""Interplanetary Software, Inc."" together with ""Robots of Cydonia, Ltd."" has developed and released robot cats. These electronic pets can meow, catch mice and entertain the owner in various ways.The developers from ""Interplanetary Software, Inc."" have recently decided to release a software update for these robots. After the update, the cats must solve the problems about bracket sequences. One of the problems is described below.  First, we need to learn a bit of bracket sequence theory. Consider the strings that contain characters ""("", "")"" and ""."". Call a string regular bracket sequence (RBS), if it can be transformed to an empty string by one or more operations of removing either single ""."" characters, or a continuous substring ""()"". For instance, the string ""(()(.))"" is an RBS, as it can be transformed to an empty string with the following sequence of removals: ""(()(.))"" \xe2\x86\x92 ""(()())"" \xe2\x86\x92 ""(())"" \xe2\x86\x92 ""()"" \xe2\x86\x92 """". We got an empty string, so the initial string was an RBS. At the same time, the string "")("" is not an RBS, as it is not possible to apply such removal operations to it.An RBS is simple if this RBS is not empty, doesn\'t start with ""."", and doesn\'t end with ""."".Denote the substring of the string s as its sequential subsegment. In particular, s[l\xe2\x80\xa6r]=slsl+1\xe2\x80\xa6sr, where si is the i-th character of the string s.Now, move on to the problem statement itself. You are given a string s, initially consisting of characters ""("" and "")"". You need to answer the following queries:  Given two indices, l and r (1\xe2\x89\xa4l<r\xe2\x89\xa4n). It\'s guaranteed that the l-th character is equal to ""("", the r-th character is equal to "")"", and the characters between them are equal to ""."". Then the l-th and the r-th characters must be set to ""."".  Given two indices, l and r (1\xe2\x89\xa4l<r\xe2\x89\xa4n), and it\'s guaranteed that the substring s[l\xe2\x80\xa6r] is a simple RBS. You need to find the number of substrings in s[l\xe2\x80\xa6r] such that they are simple RBS. In other words, find the number of index pairs i, j such that l\xe2\x89\xa4i<j\xe2\x89\xa4r and s[i\xe2\x80\xa6j] is a simple RBS. You are an employee in ""Interplanetary Software, Inc."" and you were given the task to teach the cats to solve the problem above, after the update." 2800
1625E1 "Cats on the Upgrade (easy version)" "brute force,data structures,dfs and similar,divide and conquer,dp,graphs,trees" "This is the easy version of the problem. The only difference between the easy and the hard versions are removal queries, they are present only in the hard version.""Interplanetary Software, Inc."" together with ""Robots of Cydonia, Ltd."" has developed and released robot cats. These electronic pets can meow, catch mice and entertain the owner in various ways.The developers from ""Interplanetary Software, Inc."" have recently decided to release a software update for these robots. After the update, the cats must solve the problems about bracket sequences. One of the problems is described below.  First, we need to learn a bit of bracket sequence theory. Consider the strings that contain characters ""("", "")"" and ""."". Call a string regular bracket sequence (RBS), if it can be transformed to an empty string by one or more operations of removing either single ""."" characters, or a continuous substring ""()"". For instance, the string ""(()(.))"" is an RBS, as it can be transformed to an empty string with the following sequence of removals: ""(()(.))"" \xe2\x86\x92 ""(()())"" \xe2\x86\x92 ""(())"" \xe2\x86\x92 ""()"" \xe2\x86\x92 """". We got an empty string, so the initial string was an RBS. At the same time, the string "")("" is not an RBS, as it is not possible to apply such removal operations to it.An RBS is simple if this RBS is not empty, doesn\'t start with ""."", and doesn\'t end with ""."".Denote the substring of the string s as its sequential subsegment. In particular, s[l\xe2\x80\xa6r]=slsl+1\xe2\x80\xa6sr, where si is the i-th character of the string s.Now, move on to the problem statement itself. You are given a string s, initially consisting of characters ""("" and "")"". You need to answer the queries of the following kind.Given two indices, l and r (1\xe2\x89\xa4l<r\xe2\x89\xa4n), and it\'s guaranteed that the substring s[l\xe2\x80\xa6r] is a simple RBS. You need to find the number of substrings in s[l\xe2\x80\xa6r] such that they are simple RBS. In other words, find the number of index pairs i, j such that l\xe2\x89\xa4i<j\xe2\x89\xa4r and s[i\xe2\x80\xa6j] is a simple RBS.You are an employee in ""Interplanetary Software, Inc."" and you were given the task to teach the cats to solve the problem above, after the update.Note that the ""."" character cannot appear in the string in this version of the problem. It is only needed for the hard version." 2500
1625D "Binary Spiders" "bitmasks,data structures,implementation,math,sortings,trees" "Binary Spiders are species of spiders that live on Mars. These spiders weave their webs to defend themselves from enemies.To weave a web, spiders join in pairs. If the first spider in pair has x legs, and the second spider has y legs, then they weave a web with durability x\xe2\x8a\x95y. Here, \xe2\x8a\x95 means bitwise XOR.Binary Spiders live in large groups. You observe a group of n spiders, and the i-th spider has ai legs.When the group is threatened, some of the spiders become defenders. Defenders are chosen in the following way. First, there must be at least two defenders. Second, any pair of defenders must be able to weave a web with durability at least k. Third, there must be as much defenders as possible.Scientists have researched the behaviour of Binary Spiders for a long time, and now they have a hypothesis that they can always choose the defenders in an optimal way, satisfying the conditions above. You need to verify this hypothesis on your group of spiders. So, you need to understand how many spiders must become defenders. You are not a Binary Spider, so you decided to use a computer to solve this problem." 2300
1625C "Road Optimization" dp "The Government of Mars is not only interested in optimizing space flights, but also wants to improve the road system of the planet.One of the most important highways of Mars connects Olymp City and Kstolop, the capital of Cydonia. In this problem, we only consider the way from Kstolop to Olymp City, but not the reverse path (i. e. the path from Olymp City to Kstolop).The road from Kstolop to Olymp City is \xe2\x84\x93 kilometers long. Each point of the road has a coordinate x (0\xe2\x89\xa4x\xe2\x89\xa4\xe2\x84\x93), which is equal to the distance from Kstolop in kilometers. So, Kstolop is located in the point with coordinate 0, and Olymp City is located in the point with coordinate \xe2\x84\x93.There are n signs along the road, i-th of which sets a speed limit ai. This limit means that the next kilometer must be passed in ai minutes and is active until you encounter the next along the road. There is a road sign at the start of the road (i. e. in the point with coordinate 0), which sets the initial speed limit.If you know the location of all the signs, it\'s not hard to calculate how much time it takes to drive from Kstolop to Olymp City. Consider an example:  Here, you need to drive the first three kilometers in five minutes each, then one kilometer in eight minutes, then four kilometers in three minutes each, and finally the last two kilometers must be passed in six minutes each. Total time is 3\xe2\x8b\x855+1\xe2\x8b\x858+4\xe2\x8b\x853+2\xe2\x8b\x856=47 minutes.To optimize the road traffic, the Government of Mars decided to remove no more than k road signs. It cannot remove the sign at the start of the road, otherwise, there will be no limit at the start. By removing these signs, the Government also wants to make the time needed to drive from Kstolop to Olymp City as small as possible.The largest industrial enterprises are located in Cydonia, so it\'s the priority task to optimize the road traffic from Olymp City. So, the Government of Mars wants you to remove the signs in the way described above." 1700
1625B "Elementary Particles" "brute force,greedy,sortings" "Martians are actively engaged in interplanetary trade. Olymp City, the Martian city known for its spaceport, has become a place where goods from all the corners of our Galaxy come. To deliver even more freight from faraway planets, Martians need fast spaceships.A group of scientists conducts experiments to build a fast engine for the new spaceship. In the current experiment, there are n elementary particles, the i-th of them has type ai.Denote a subsegment of the particle sequence (a1,a2,\xe2\x80\xa6,an) as a sequence (al,al+1,\xe2\x80\xa6,ar) for some left bound l and right bound r (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n). For instance, the sequence (1 4 2 8 5 7) for l=2 and r=4 has the sequence (4 2 8) as a subsegment. Two subsegments are considered different if at least one bound of those subsegments differs.Note that the subsegments can be equal as sequences but still considered different. For example, consider the sequence (1 1 1 1 1) and two of its subsegments: one with l=1 and r=3 and another with l=2 and r=4. Both subsegments are equal to (1 1 1), but still considered different, as their left and right bounds differ.The scientists want to conduct a reaction to get two different subsegments of the same length. Denote this length k. The resulting pair of subsegments must be harmonious, i. e. for some i (1\xe2\x89\xa4i\xe2\x89\xa4k) it must be true that the types of particles on the i-th position are the same for these two subsegments. For example, the pair (1 7 3) and (4 7 8) is harmonious, as both subsegments have 7 on the second position. The pair (1 2 3) and (3 1 2) is not harmonious.The longer are harmonious subsegments, the more chances for the scientists to design a fast engine. So, they asked you to calculate the maximal possible length of harmonious pair made of different subsegments." 1100
1625A "Ancient Civilization" bitmasks,greedy,math "Martian scientists explore Ganymede, one of Jupiter\'s numerous moons. Recently, they have found ruins of an ancient civilization. The scientists brought to Mars some tablets with writings in a language unknown to science.They found out that the inhabitants of Ganymede used an alphabet consisting of two letters, and each word was exactly \xe2\x84\x93 letters long. So, the scientists decided to write each word of this language as an integer from 0 to 2\xe2\x84\x93\xe2\x88\x921 inclusively. The first letter of the alphabet corresponds to zero bit in this integer, and the second letter corresponds to one bit.The same word may have various forms in this language. Then, you need to restore the initial form. The process of doing it is described below.Denote the distance between two words as the amount of positions, in which these words differ. For example, the distance between 10012 and 11002 (in binary) is equal to two, as these words have different letters in the second and the fourth positions, counting from left to right. Further, denote the distance between words x and y as d(x,y).Let the word have n forms, the i-th of which is described with an integer xi. All the xi are not necessarily different, as two various forms of the word can be written the same. Consider some word y. Then, closeness of the word y is equal to the sum of distances to each of the word forms, i. e. the sum d(xi,y) over all 1\xe2\x89\xa4i\xe2\x89\xa4n.The initial form is the word y with minimal possible nearness.You need to help the scientists and write the program which finds the initial form of the word given all its known forms. Note that the initial form is not necessarily equal to any of the n given forms." 800
1624G "MinOr Tree" "bitmasks,dfs and similar,dsu,graphs,greedy" "Recently, Vlad has been carried away by spanning trees, so his friends, without hesitation, gave him a connected weighted undirected graph of n vertices and m edges for his birthday.Vlad defined the ority of a spanning tree as the bitwise OR of all its weights, and now he is interested in what is the minimum possible ority that can be achieved by choosing a certain spanning tree. A spanning tree is a connected subgraph of a given graph that does not contain cycles.In other words, you want to keep n\xe2\x88\x921 edges so that the graph remains connected and the bitwise OR weights of the edges are as small as possible. You have to find the minimum bitwise OR itself." 1900
1624F "Interacdive Problem" "binary search,constructive algorithms,interactive" "This problem is interactive.We decided to play a game with you and guess the number x (1\xe2\x89\xa4x<n), where you know the number n.You can make queries like this: + c: this command assigns x=x+c (1\xe2\x89\xa4c<n) and then returns you the value \xe2\x8c\x8axn\xe2\x8c\x8b (x divide by n and round down).You win if you guess the current number with no more than 10 queries." 2000
1624E Masha-forgetful "brute force,constructive algorithms,dp,hashing,implementation,strings" "Masha meets a new friend and learns his phone number \xe2\x80\x94 s. She wants to remember it as soon as possible. The phone number \xe2\x80\x94 is a string of length m that consists of digits from 0 to 9. The phone number may start with 0.Masha already knows n phone numbers (all numbers have the same length m). It will be easier for her to remember a new number if the s is represented as segments of numbers she already knows. Each such segment must be of length at least 2, otherwise there will be too many segments and Masha will get confused.For example, Masha needs to remember the number: s= \'12345678\' and she already knows n=4 numbers: \'12340219\', \'20215601\', \'56782022\', \'12300678\'. You can represent s as a 3 segment: \'1234\' of number one, \'56\' of number two, and \'78\' of number three. There are other ways to represent s.Masha asks you for help, she asks you to break the string s into segments of length 2 or more of the numbers she already knows. If there are several possible answers, print any of them." 2000
1624D "Palindromes Coloring" "binary search,greedy,sortings,strings" "You have a string s consisting of lowercase Latin alphabet letters. You can color some letters in colors from 1 to k. It is not necessary to paint all the letters. But for each color, there must be a letter painted in that color.Then you can swap any two symbols painted in the same color as many times as you want. After that, k strings will be created, i-th of them will contain all the characters colored in the color i, written in the order of their sequence in the string s.Your task is to color the characters of the string so that all the resulting k strings are palindromes, and the length of the shortest of these k strings is as large as possible.Read the note for the first test case of the example if you need a clarification.Recall that a string is a palindrome if it reads the same way both from left to right and from right to left. For example, the strings abacaba, cccc, z and dxd are palindromes, but the strings abab and aaabaa \xe2\x80\x94 are not." 1400
1624C "Division by Two and Permutation" "constructive algorithms,flows,graph matchings,greedy,math" "You are given an array a consisting of n positive integers. You can perform operations on it.In one operation you can replace any element of the array ai with \xe2\x8c\x8aai2\xe2\x8c\x8b, that is, by an integer part of dividing ai by 2 (rounding down).See if you can apply the operation some number of times (possible 0) to make the array a become a permutation of numbers from 1 to n \xe2\x80\x94that is, so that it contains all numbers from 1 to n, each exactly once.For example, if a=[1,8,25,2], n=4, then the answer is yes. You could do the following:  Replace 8 with \xe2\x8c\x8a82\xe2\x8c\x8b=4, then a=[1,4,25,2].  Replace 25 with \xe2\x8c\x8a252\xe2\x8c\x8b=12, then a=[1,4,12,2].  Replace 12 with \xe2\x8c\x8a122\xe2\x8c\x8b=6, then a=[1,4,6,2].  Replace 6 with \xe2\x8c\x8a62\xe2\x8c\x8b=3, then a=[1,4,3,2]." 1100
1624B "Make AP" implementation,math "Polycarp has 3 positive integers a, b and c. He can perform the following operation exactly once.  Choose a positive integer m and multiply exactly one of the integers a, b or c by m. Can Polycarp make it so that after performing the operation, the sequence of three numbers a, b, c (in this order) forms an arithmetic progression? Note that you cannot change the order of a, b and c.Formally, a sequence x1,x2,\xe2\x80\xa6,xn is called an arithmetic progression (AP) if there exists a number d (called ""common difference"") such that xi+1=xi+d for all i from 1 to n\xe2\x88\x921. In this problem, n=3.For example, the following sequences are AP: [5,10,15], [3,2,1], [1,1,1], and [13,10,7]. The following sequences are not AP: [1,2,4], [0,1,0] and [1,3,2].You need to answer t independent test cases." 900
1624A "Plus One on the Subset" math "Polycarp got an array of integers a[1\xe2\x80\xa6n] as a gift. Now he wants to perform a certain number of operations (possibly zero) so that all elements of the array become the same (that is, to become a1=a2=\xe2\x8b\xaf=an). In one operation, he can take some indices in the array and increase the elements of the array at those indices by 1.For example, let a=[4,2,1,6,2]. He can perform the following operation: select indices 1, 2, and 4 and increase elements of the array in those indices by 1. As a result, in one operation, he can get a new state of the array a=[5,3,1,7,2].What is the minimum number of operations it can take so that all elements of the array become equal to each other (that is, to become a1=a2=\xe2\x8b\xaf=an)?" 800
1623E "Middle Duplication" "data structures,dfs and similar,greedy,strings,trees" "A binary tree of n nodes is given. Nodes of the tree are numbered from 1 to n and the root is the node 1. Each node can have no child, only one left child, only one right child, or both children. For convenience, let\'s denote lu and ru as the left and the right child of the node u respectively, lu=0 if u does not have the left child, and ru=0 if the node u does not have the right child.Each node has a string label, initially is a single character cu. Let\'s define the string representation of the binary tree as the concatenation of the labels of the nodes in the in-order. Formally, let f(u) be the string representation of the tree rooted at the node u. f(u) is defined as follows: f(u)={<empty string>,if u=0;f(lu)+cu+f(ru)otherwise, where + denotes the string concatenation operation.This way, the string representation of the tree is f(1).For each node, we can duplicate its label at most once, that is, assign cu with cu+cu, but only if u is the root of the tree, or if its parent also has its label duplicated.You are given the tree and an integer k. What is the lexicographically smallest string representation of the tree, if we can duplicate labels of at most k nodes?A string a is lexicographically smaller than a string b if and only if one of the following holds:   a is a prefix of b, but a\xe2\x89\xa0b;  in the first position where a and b differ, the string a has a letter that appears earlier in the alphabet than the corresponding letter in b." 2500
1623D "Robot Cleaner Revisit" implementation,math,probabilities "The statement of this problem shares a lot with problem A. The differences are that in this problem, the probability is introduced, and the constraint is different.A robot cleaner is placed on the floor of a rectangle room, surrounded by walls. The floor consists of n rows and m columns. The rows of the floor are numbered from 1 to n from top to bottom, and columns of the floor are numbered from 1 to m from left to right. The cell on the intersection of the r-th row and the c-th column is denoted as (r,c). The initial position of the robot is (rb,cb).In one second, the robot moves by dr rows and dc columns, that is, after one second, the robot moves from the cell (r,c) to (r+dr,c+dc). Initially dr=1, dc=1. If there is a vertical wall (the left or the right walls) in the movement direction, dc is reflected before the movement, so the new value of dc is \xe2\x88\x92dc. And if there is a horizontal wall (the upper or lower walls), dr is reflected before the movement, so the new value of dr is \xe2\x88\x92dr.Each second (including the moment before the robot starts moving), the robot cleans every cell lying in the same row or the same column as its position. There is only one dirty cell at (rd,cd). The job of the robot is to clean that dirty cell. After a lot of testings in problem A, the robot is now broken. It cleans the floor as described above, but at each second the cleaning operation is performed with probability p100 only, and not performed with probability 1\xe2\x88\x92p100. The cleaning or not cleaning outcomes are independent each second.Given the floor size n and m, the robot\'s initial position (rb,cb) and the dirty cell\'s position (rd,cd), find the expected time for the robot to do its job.It can be shown that the answer can be expressed as an irreducible fraction xy, where x and y are integers and y\xe2\x89\xa20(mod109+7). Output the integer equal to x\xe2\x8b\x85y\xe2\x88\x921mod(109+7). In other words, output such an integer a that 0\xe2\x89\xa4a<109+7 and a\xe2\x8b\x85y\xe2\x89\xa1x(mod109+7)." 2300
1623C "Balanced Stone Heaps" "binary search,greedy" "There are n heaps of stone. The i-th heap has hi stones. You want to change the number of stones in the heap by performing the following process once:   You go through the heaps from the 3-rd heap to the n-th heap, in this order.  Let i be the number of the current heap.  You can choose a number d (0\xe2\x89\xa43\xe2\x8b\x85d\xe2\x89\xa4hi), move d stones from the i-th heap to the (i\xe2\x88\x921)-th heap, and 2\xe2\x8b\x85d stones from the i-th heap to the (i\xe2\x88\x922)-th heap.  So after that hi is decreased by 3\xe2\x8b\x85d, hi\xe2\x88\x921 is increased by d, and hi\xe2\x88\x922 is increased by 2\xe2\x8b\x85d.  You can choose different or same d for different operations. Some heaps may become empty, but they still count as heaps. What is the maximum number of stones in the smallest heap after the process?" 1600
1623B "Game on Ranges" "brute force,dfs and similar,implementation,sortings" "Alice and Bob play the following game. Alice has a set S of disjoint ranges of integers, initially containing only one range [1,n]. In one turn, Alice picks a range [l,r] from the set S and asks Bob to pick a number in the range. Bob chooses a number d (l\xe2\x89\xa4d\xe2\x89\xa4r). Then Alice removes [l,r] from S and puts into the set S the range [l,d\xe2\x88\x921] (if l\xe2\x89\xa4d\xe2\x88\x921) and the range [d+1,r] (if d+1\xe2\x89\xa4r). The game ends when the set S is empty. We can show that the number of turns in each game is exactly n.After playing the game, Alice remembers all the ranges [l,r] she picked from the set S, but Bob does not remember any of the numbers that he picked. But Bob is smart, and he knows he can find out his numbers d from Alice\'s ranges, and so he asks you for help with your programming skill.Given the list of ranges that Alice has picked ([l,r]), for each range, help Bob find the number d that Bob has picked.We can show that there is always a unique way for Bob to choose his number for a list of valid ranges picked by Alice." 1100
1623A "Robot Cleaner" "brute force,implementation,math" "A robot cleaner is placed on the floor of a rectangle room, surrounded by walls. The floor consists of nn rows and mm columns. The rows of the floor are numbered from 11 to nn from top to bottom, and columns of the floor are numbered from 11 to mm from left to right. The cell on the intersection of the rr-th row and the cc-th column is denoted as (r,c)(r,c). The initial position of the robot is (rb,cb)(rb,cb).In one second, the robot moves by drdr rows and dcdc columns, that is, after one second, the robot moves from the cell (r,c)(r,c) to (r+dr,c+dc)(r+dr,c+dc). Initially dr=1dr=1, dc=1dc=1. If there is a vertical wall (the left or the right walls) in the movement direction, dcdc is reflected before the movement, so the new value of dcdc is \xe2\x88\x92dc\xe2\x88\x92dc. And if there is a horizontal wall (the upper or lower walls), drdr is reflected before the movement, so the new value of drdr is \xe2\x88\x92dr\xe2\x88\x92dr.Each second (including the moment before the robot starts moving), the robot cleans every cell lying in the same row or the same column as its position. There is only one dirty cell at (rd,cd)(rd,cd). The job of the robot is to clean that dirty cell.  Illustration for the first example. The blue arc is the robot. The red star is the target dirty cell. Each second the robot cleans a row and a column, denoted by yellow stripes. Given the floor size nn and mm, the robot\'s initial position (rb,cb)(rb,cb) and the dirty cell\'s position (rd,cd)(rd,cd), find the time for the robot to do its job." 800
1622F "Quadratic Set" "constructive algorithms,hashing,math,number theory" "Let\'s call a set of positive integers a1,a2,\xe2\x80\xa6,ak quadratic if the product of the factorials of its elements is a square of an integer, i.\xe2\x80\x89e. k\xe2\x88\x8fi=1ai!=m2, for some integer m.You are given a positive integer n.Your task is to find a quadratic subset of a set 1,2,\xe2\x80\xa6,n of maximum size. If there are multiple answers, print any of them." 2900
1622E "Math Test" "bitmasks,brute force,greedy" "Petya is a math teacher. n of his students has written a test consisting of m questions. For each student, it is known which questions he has answered correctly and which he has not.If the student answers the j-th question correctly, he gets pj points (otherwise, he gets 0 points). Moreover, the points for the questions are distributed in such a way that the array p is a permutation of numbers from 1 to m.For the i-th student, Petya knows that he expects to get xi points for the test. Petya wonders how unexpected the results could be. Petya believes that the surprise value of the results for students is equal to n\xe2\x88\x91i=1|xi\xe2\x88\x92ri|, where ri is the number of points that the i-th student has got for the test.Your task is to help Petya find such a permutation p for which the surprise value of the results is maximum possible. If there are multiple answers, print any of them." 2200
1622D Shuffle "combinatorics,math,two pointers" "You are given a binary string (i.\xe2\x80\x89e. a string consisting of characters 0 and/or 1) s of length n. You can perform the following operation with the string s at most once: choose a substring (a contiguous subsequence) of s having exactly k characters 1 in it, and shuffle it (reorder the characters in the substring as you wish).Calculate the number of different strings which can be obtained from s by performing this operation at most once." 2000
1622C "Set or Decrease" "binary search,brute force,greedy,sortings" "You are given an integer array a1,a2,\xe2\x80\xa6,an and integer k.In one step you can   either choose some index i and decrease ai by one (make ai=ai\xe2\x88\x921);  or choose two indices i and j and set ai equal to aj (make ai=aj). What is the minimum number of steps you need to make the sum of array n\xe2\x88\x91i=1ai\xe2\x89\xa4k? (You are allowed to make values of array negative)." 1600
1622B "Berland Music" "data structures,greedy,math,sortings" "Berland Music is a music streaming service built specifically to support Berland local artist. Its developers are currently working on a song recommendation module.So imagine Monocarp got recommended n songs, numbered from 1 to n. The i-th song had its predicted rating equal to pi, where 1\xe2\x89\xa4pi\xe2\x89\xa4n and every integer from 1 to n appears exactly once. In other words, p is a permutation.After listening to each of them, Monocarp pressed either a like or a dislike button. Let his vote sequence be represented with a string s, such that si=0 means that he disliked the i-th song, and si=1 means that he liked it.Now the service has to re-evaluate the song ratings in such a way that:  the new ratings q1,q2,\xe2\x80\xa6,qn still form a permutation (1\xe2\x89\xa4qi\xe2\x89\xa4n; each integer from 1 to n appears exactly once);  every song that Monocarp liked should have a greater rating than every song that Monocarp disliked (formally, for all i,j such that si=1 and sj=0, qi>qj should hold). Among all valid permutations q find the one that has the smallest value of n\xe2\x88\x91i=1|pi\xe2\x88\x92qi|, where |x| is an absolute value of x.Print the permutation q1,q2,\xe2\x80\xa6,qn. If there are multiple answers, you can print any of them." 1000
1622A "Construct a Rectangle" geometry,math "There are three sticks with integer lengths l1,l2 and l3.You are asked to break exactly one of them into two pieces in such a way that:   both pieces have positive (strictly greater than 0) integer length;  the total length of the pieces is equal to the original length of the stick;  it\'s possible to construct a rectangle from the resulting four sticks such that each stick is used as exactly one of its sides. A square is also considered a rectangle.Determine if it\'s possible to do that." 800
1621I "Two Sequences" "data structures,hashing,string suffix structures" "Consider an array of integers C=[c1,c2,\xe2\x80\xa6,cn] of length n. Let\'s build the sequence of arrays D0,D1,D2,\xe2\x80\xa6,Dn of length n+1 in the following way:  The first element of this sequence will be equals C: D0=C.  For each 1\xe2\x89\xa4i\xe2\x89\xa4n array Di will be constructed from Di\xe2\x88\x921 in the following way:   Let\'s find the lexicographically smallest subarray of Di\xe2\x88\x921 of length i. Then, the first n\xe2\x88\x92i elements of Di will be equals to the corresponding n\xe2\x88\x92i elements of array Di\xe2\x88\x921 and the last i elements of Di will be equals to the corresponding elements of the found subarray of length i.  Array x is subarray of array y, if x can be obtained by deletion of several (possibly, zero or all) elements from the beginning of y and several (possibly, zero or all) elements from the end of y.For array C let\'s denote array Dn as op(C).Alice has an array of integers A=[a1,a2,\xe2\x80\xa6,an] of length n. She will build the sequence of arrays B0,B1,\xe2\x80\xa6,Bn of length n+1 in the following way:  The first element of this sequence will be equals A: B0=A.  For each 1\xe2\x89\xa4i\xe2\x89\xa4n array Bi will be equals op(Bi\xe2\x88\x921), where op is the transformation described above. She will ask you q queries about elements of sequence of arrays B0,B1,\xe2\x80\xa6,Bn. Each query consists of two integers i and j, and the answer to this query is the value of the j-th element of array Bi." 3500
1621H "Trains and Airplanes" "dfs and similar,graphs,shortest paths,trees" "Railway network of one city consists of n stations connected by n\xe2\x88\x921 roads. These stations and roads forms a tree. Station 1 is a city center. For each road you know the time trains spend to pass this road. You can assume that trains don\'t spend time on stops. Let\'s define dist(v) as the time that trains spend to get from the station v to the station 1.This railway network is splitted into zones named by first k capital latin letters. The zone of the i-th station is zi. City center is in the zone A. For all other stations it is guaranteed that the first station on the road from this station to the city center is either in the same zone or in the zone with lexicographically smaller name. Any road is completely owned by the zone of the most distant end from the city center.Tourist will arrive at the airport soon and then he will go to the city center. Here\'s how the trip from station v to station 1 happends:   At the moment 0, tourist enters the train that follows directly from the station v to the station 1. The trip will last for dist(v) minutes.  Tourist can buy tickets for any subset of zones at any moment. Ticket for zone i costs passi euro.  Every T minutes since the start of the trip (that is, at the moments T,2T,\xe2\x80\xa6) the control system will scan tourist. If at the moment of scan tourist is in the zone i without zone i ticket, he should pay finei euro. Formally, the zone of tourist is determined in the following way:   If tourist is at the station 1, then he already at the city center so he shouldn\'t pay fine.  If tourist is at the station u\xe2\x89\xa01, then he is in the zone zu.  If tourist is moving from the station x to the station y that are directly connected by road, then he is in the zone zx.  Note, that tourist can pay fine multiple times in the same zone. Tourist always selects such way to buy tickets and pay fines that minimizes the total cost of trip. Let f(v) be such cost for station v.Unfortunately, tourist doesn\'t know the current values of passi and finei for different zones and he has forgot the location of the airport. He will ask you queries of 3 types:  1 i c \xe2\x80\x94 the cost of ticket in zone i has changed. Now passi is c.  2 i c \xe2\x80\x94 the cost of fine in zone i has changed. Now finei is c.  3 u \xe2\x80\x94 solve the following problem for current values of pass and fine:   You are given the station u. Consider all the stations v that satisfy the following conditions:   zv=zu  The station u is on the path from the station v to the station 1.  Find the value of min(f(v)) over all such stations v with the following assumption: tourist has the ticket for the zone of station zu." 3500
1621G "Weighted Increasing Subsequences" "data structures,dp,math" "You are given the sequence of integers a1,a2,\xe2\x80\xa6,an of length n. The sequence of indices i1<i2<\xe2\x80\xa6<ik of length k denotes the subsequence ai1,ai2,\xe2\x80\xa6,aik of length k of sequence a.The subsequence ai1,ai2,\xe2\x80\xa6,aik of length k of sequence a is called increasing subsequence if aij<aij+1 for each 1\xe2\x89\xa4j<k.The weight of the increasing subsequence ai1,ai2,\xe2\x80\xa6,aik of length k of sequence a is the number of 1\xe2\x89\xa4j\xe2\x89\xa4k, such that exists index ik<x\xe2\x89\xa4n and ax>aij.For example, if a=[6,4,8,6,5], then the sequence of indices i=[2,4] denotes increasing subsequence [4,6] of sequence a. The weight of this increasing subsequence is 1, because for j=1 exists x=5 and a5=5>ai1=4, but for j=2 such x doesn\'t exist.Find the sum of weights of all increasing subsequences of a modulo 109+7." 3200
1621F "Strange Instructions" "data structures,greedy,implementation" "Dasha has 10100 coins. Recently, she found a binary string s of length n and some operations that allows to change this string (she can do each operation any number of times):  Replace substring 00 of s by 0 and receive a coins.  Replace substring 11 of s by 1 and receive b coins.  Remove 0 from any position in s and pay c coins. It turned out that while doing this operations Dasha should follow the rule:  It is forbidden to do two operations with the same parity in a row. Operations are numbered by integers 1-3 in the order they are given above. Please, calculate what is the maximum profit Dasha can get by doing these operations and following this rule." 2700
1621E "New School" "binary search,data structures,dp,greedy,implementation,sortings" "You have decided to open a new school. You have already found n teachers and m groups of students. The i-th group of students consists of ki\xe2\x89\xa52 students. You know age of each teacher and each student. The ages of teachers are a1,a2,\xe2\x80\xa6,an and the ages of students of the i-th group are bi,1,bi,2,\xe2\x80\xa6,bi,ki.To start lessons you should assign the teacher to each group of students. Such assignment should satisfy the following requirements:  To each group exactly one teacher assigned.  To each teacher at most 1 group of students assigned.  The average of students\' ages in each group doesn\'t exceed the age of the teacher assigned to this group. The average of set x1,x2,\xe2\x80\xa6,xk of k integers is x1+x2+\xe2\x80\xa6+xkk.Recently you have heard that one of the students will refuse to study in your school. After this, the size of one group will decrease by 1 while all other groups will remain unchanged.You don\'t know who will refuse to study. For each student determine if you can start lessons in case of his refusal.Note, that it is not guaranteed that it is possible to start lessons before any refusal." 2300
1621D "The Winter Hike" "constructive algorithms,greedy,math" "Circular land is an 2n\xc3\x972n grid. Rows of this grid are numbered by integers from 1 to 2n from top to bottom and columns of this grid are numbered by integers from 1 to 2n from left to right. The cell (x,y) is the cell on the intersection of row x and column y for 1\xe2\x89\xa4x\xe2\x89\xa42n and 1\xe2\x89\xa4y\xe2\x89\xa42n.There are n2 of your friends in the top left corner of the grid. That is, in each cell (x,y) with 1\xe2\x89\xa4x,y\xe2\x89\xa4n there is exactly one friend. Some of the other cells are covered with snow.Your friends want to get to the bottom right corner of the grid. For this in each cell (x,y) with n+1\xe2\x89\xa4x,y\xe2\x89\xa42n there should be exactly one friend. It doesn\'t matter in what cell each of friends will be.You have decided to help your friends to get to the bottom right corner of the grid.For this, you can give instructions of the following types:   You select a row x. All friends in this row should move to the next cell in this row. That is, friend from the cell (x,y) with 1\xe2\x89\xa4y<2n will move to the cell (x,y+1) and friend from the cell (x,2n) will move to the cell (x,1).  You select a row x. All friends in this row should move to the previous cell in this row. That is, friend from the cell (x,y) with 1<y\xe2\x89\xa42n will move to the cell (x,y\xe2\x88\x921) and friend from the cell (x,1) will move to the cell (x,2n).  You select a column y. All friends in this column should move to the next cell in this column. That is, friend from the cell (x,y) with 1\xe2\x89\xa4x<2n will move to the cell (x+1,y) and friend from the cell (2n,y) will move to the cell (1,y).  You select a column y. All friends in this column should move to the previous cell in this column. That is, friend from the cell (x,y) with 1<x\xe2\x89\xa42n will move to the cell (x\xe2\x88\x921,y) and friend from the cell (1,y) will move to the cell (2n,y). Note how friends on the grid border behave in these instructions.  Example of applying the third operation to the second column. Here, colorful circles denote your friends and blue cells are covered with snow. You can give such instructions any number of times. You can give instructions of different types. If after any instruction one of your friends is in the cell covered with snow he becomes ill.In order to save your friends you can remove snow from some cells before giving the first instruction:   You can select the cell (x,y) that is covered with snow now and remove snow from this cell for cx,y coins. You can do this operation any number of times.You want to spend the minimal number of coins and give some instructions to your friends. After this, all your friends should be in the bottom right corner of the grid and none of them should be ill.Please, find how many coins you will spend." 2100
1621C "Hidden Permutations" "dfs and similar,interactive,math" "This is an interactive problem.The jury has a permutation p of length n and wants you to guess it. For this, the jury created another permutation q of length n. Initially, q is an identity permutation (qi=i for all i).You can ask queries to get qi for any i you want. After each query, the jury will change q in the following way:   At first, the jury will create a new permutation q\xe2\x80\xb2 of length n such that q\xe2\x80\xb2i=qpi for all i.  Then the jury will replace permutation q with pemutation q\xe2\x80\xb2. You can make no more than 2n queries in order to quess p." 1700
1621B "Integers Shop" "data structures,greedy,implementation" "The integers shop sells n segments. The i-th of them contains all integers from li to ri and costs ci coins.Tomorrow Vasya will go to this shop and will buy some segments there. He will get all integers that appear in at least one of bought segments. The total cost of the purchase is the sum of costs of all segments in it.After shopping, Vasya will get some more integers as a gift. He will get integer x as a gift if and only if all of the following conditions are satisfied:   Vasya hasn\'t bought x.  Vasya has bought integer l that is less than x.  Vasya has bought integer r that is greater than x. Vasya can get integer x as a gift only once so he won\'t have the same integers after receiving a gift.For example, if Vasya buys segment [2,4] for 20 coins and segment [7,8] for 22 coins, he spends 42 coins and receives integers 2,3,4,7,8 from these segments. He also gets integers 5 and 6 as a gift.Due to the technical issues only the first s segments (that is, segments [l1,r1],[l2,r2],\xe2\x80\xa6,[ls,rs]) will be available tomorrow in the shop.Vasya wants to get (to buy or to get as a gift) as many integers as possible. If he can do this in differents ways, he selects the cheapest of them.For each s from 1 to n, find how many coins will Vasya spend if only the first s segments will be available." 1500
1621A "Stable Arrangement of Rooks" "constructive algorithms" "You have an n\xc3\x97n chessboard and k rooks. Rows of this chessboard are numbered by integers from 1 to n from top to bottom and columns of this chessboard are numbered by integers from 1 to n from left to right. The cell (x,y) is the cell on the intersection of row x and collumn y for 1\xe2\x89\xa4x\xe2\x89\xa4n and 1\xe2\x89\xa4y\xe2\x89\xa4n.The arrangement of rooks on this board is called good, if no rook is beaten by another rook.A rook beats all the rooks that shares the same row or collumn with it.The good arrangement of rooks on this board is called not stable, if it is possible to move one rook to the adjacent cell so arrangement becomes not good. Otherwise, the good arrangement is stable. Here, adjacent cells are the cells that share a side.  Such arrangement of 3 rooks on the 4\xc3\x974 chessboard is good, but it is not stable: the rook from (1,1) can be moved to the adjacent cell (2,1) and rooks on cells (2,1) and (2,4) will beat each other. Please, find any stable arrangement of k rooks on the n\xc3\x97n chessboard or report that there is no such arrangement." 800
1620G "Subsequences Galore" bitmasks,combinatorics,dp "For a sequence of strings [t1,t2,\xe2\x80\xa6,tm], let\'s define the function f([t1,t2,\xe2\x80\xa6,tm]) as the number of different strings (including the empty string) that are subsequences of at least one string ti. f([])=0 (i.\xe2\x80\x89e. the number of such strings for an empty sequence is 0).You are given a sequence of strings [s1,s2,\xe2\x80\xa6,sn]. Every string in this sequence consists of lowercase Latin letters and is sorted (i.\xe2\x80\x89e., each string begins with several (maybe zero) characters a, then several (maybe zero) characters b, ..., ends with several (maybe zero) characters z).For each of 2n subsequences of [s1,s2,\xe2\x80\xa6,sn], calculate the value of the function f modulo 998244353." 2400
1620F "Bipartite Array" dp,greedy "You are given a permutation p consisting of n integers 1,2,\xe2\x80\xa6,n (a permutation is an array where each element from 1 to n occurs exactly once).Let\'s call an array a bipartite if the following undirected graph is bipartite:  the graph consists of n vertices;  two vertices i and j are connected by an edge if i<j and ai>aj. Your task is to find a bipartite array of integers a of size n, such that ai=pi or ai=\xe2\x88\x92pi, or report that no such array exists. If there are multiple answers, print any of them." 2800
1620E "Replace the Numbers" "constructive algorithms,data structures,dsu,implementation" "You have an array of integers (initially empty).You have to perform q queries. Each query is of one of two types:   ""1 x"" \xe2\x80\x94 add the element x to the end of the array;  ""2 x y"" \xe2\x80\x94 replace all occurrences of x in the array with y. Find the resulting array after performing all the queries." 1900
1620D "Exact Change" "brute force,constructive algorithms,greedy" "One day, early in the morning, you decided to buy yourself a bag of chips in the nearby store. The store has chips of n different flavors. A bag of the i-th flavor costs ai burles.The store may run out of some flavors, so you\'ll decide which one to buy after arriving there. But there are two major flaws in this plan:   you have only coins of 1, 2 and 3 burles;  since it\'s morning, the store will ask you to pay in exact change, i. e. if you choose the i-th flavor, you\'ll have to pay exactly ai burles. Coins are heavy, so you\'d like to take the least possible number of coins in total. That\'s why you are wondering: what is the minimum total number of coins you should take with you, so you can buy a bag of chips of any flavor in exact change?" 2000
1620C BA-String "brute force,dp,greedy,implementation,math" "You are given an integer k and a string s that consists only of characters \'a\' (a lowercase Latin letter) and \'*\' (an asterisk).Each asterisk should be replaced with several (from 0 to k inclusive) lowercase Latin letters \'b\'. Different asterisk can be replaced with different counts of letter \'b\'.The result of the replacement is called a BA-string.Two strings a and b are different if they either have different lengths or there exists such a position i that ai\xe2\x89\xa0bi.A string a is lexicographically smaller than a string b if and only if one of the following holds:   a is a prefix of b, but a\xe2\x89\xa0b;  in the first position where a and b differ, the string a has a letter that appears earlier in the alphabet than the corresponding letter in b. Now consider all different BA-strings and find the x-th lexicographically smallest of them." 1800
1620B "Triangles on a Rectangle" geometry,greedy,math "A rectangle with its opposite corners in (0,0) and (w,h) and sides parallel to the axes is drawn on a plane.You are given a list of lattice points such that each point lies on a side of a rectangle but not in its corner. Also, there are at least two points on every side of a rectangle.Your task is to choose three points in such a way that:   exactly two of them belong to the same side of a rectangle;  the area of a triangle formed by them is maximum possible. Print the doubled area of this triangle. It can be shown that the doubled area of any triangle formed by lattice points is always an integer." 1000
1620A "Equal or Not Equal" "constructive algorithms,dsu,implementation" "You had n positive integers a1,a2,\xe2\x80\xa6,an arranged in a circle. For each pair of neighboring numbers (a1 and a2, a2 and a3, ..., an\xe2\x88\x921 and an, and an and a1), you wrote down: are the numbers in the pair equal or not.Unfortunately, you\'ve lost a piece of paper with the array a. Moreover, you are afraid that even information about equality of neighboring elements may be inconsistent. So, you are wondering: is there any array a which is consistent with information you have about equality or non-equality of corresponding pairs?" 800
1619H "Permutation and Queries" "brute force,data structures,divide and conquer,two pointers" "You are given a permutation p of n elements. A permutation of n elements is an array of length n containing each integer from 1 to n exactly once. For example, [1,2,3] and [4,3,5,1,2] are permutations, but [1,2,4] and [4,3,2,1,2] are not permutations. You should perform q queries.There are two types of queries:  1 x y \xe2\x80\x94 swap px and py.  2 i k \xe2\x80\x94 print the number that i will become if we assign i=pi k times." 2400
1619G "Unusual Minesweeper" "binary search,dfs and similar,dsu,greedy,sortings" "Polycarp is very fond of playing the game Minesweeper. Recently he found a similar game and there are such rules.There are mines on the field, for each the coordinates of its location are known (xi,yi). Each mine has a lifetime in seconds, after which it will explode. After the explosion, the mine also detonates all mines vertically and horizontally at a distance of k (two perpendicular lines). As a result, we get an explosion on the field in the form of a ""plus"" symbol (\'+\'). Thus, one explosion can cause new explosions, and so on.Also, Polycarp can detonate anyone mine every second, starting from zero seconds. After that, a chain reaction of explosions also takes place. Mines explode instantly and also instantly detonate other mines according to the rules described above.Polycarp wants to set a new record and asks you to help him calculate in what minimum number of seconds all mines can be detonated." 2000
1619F "Let\'s Play the Hat?" "brute force,constructive algorithms,greedy,math" "The Hat is a game of speedy explanation/guessing words (similar to Alias). It\'s fun. Try it! In this problem, we are talking about a variant of the game when the players are sitting at the table and everyone plays individually (i.e. not teams, but individual gamers play).n people gathered in a room with m tables (n\xe2\x89\xa52m). They want to play the Hat k times. Thus, k games will be played at each table. Each player will play in k games.To do this, they are distributed among the tables for each game. During each game, one player plays at exactly one table. A player can play at different tables.Players want to have the most ""fair"" schedule of games. For this reason, they are looking for a schedule (table distribution for each game) such that:  At any table in each game there are either \xe2\x8c\x8anm\xe2\x8c\x8b people or \xe2\x8c\x88nm\xe2\x8c\x89 people (that is, either n/m rounded down, or n/m rounded up). Different numbers of people can play different games at the same table. Let\'s calculate for each player the value bi \xe2\x80\x94 the number of times the i-th player played at a table with \xe2\x8c\x88nm\xe2\x8c\x89 persons (n/m rounded up). Any two values of bimust differ by no more than 1. In other words, for any two players i and j, it must be true |bi\xe2\x88\x92bj|\xe2\x89\xa41. For example, if n=5, m=2 and k=2, then at the request of the first item either two players or three players should play at each table. Consider the following schedules:  First game: 1,2,3 are played at the first table, and 4,5 at the second one. The second game: at the first table they play 5,1, and at the second  \xe2\x80\x94 2,3,4. This schedule is not ""fair"" since b2=2 (the second player played twice at a big table) and b5=0 (the fifth player did not play at a big table). First game: 1,2,3 are played at the first table, and 4,5 at the second one. The second game: at the first table they play 4,5,2, and at the second one  \xe2\x80\x94 1,3. This schedule is ""fair"": b=[1,2,1,1,1] (any two values of bi differ by no more than 1). Find any ""fair"" game schedule for n people if they play on the m tables of k games." 2000
1619E "MEX and Increments" "constructive algorithms,data structures,dp,greedy,implementation,math,sortings" "Dmitry has an array of n non-negative integers a1,a2,\xe2\x80\xa6,an.In one operation, Dmitry can choose any index j (1\xe2\x89\xa4j\xe2\x89\xa4n) and increase the value of the element aj by 1. He can choose the same index j multiple times.For each i from 0 to n, determine whether Dmitry can make the MEX of the array equal to exactly i. If it is possible, then determine the minimum number of operations to do it.The MEX of the array is equal to the minimum non-negative integer that is not in the array. For example, the MEX of the array [3,1,0] is equal to 2, and the array [3,3,1,4] is equal to 0." 1700
1619D "New Year\'s Problem" "binary search,greedy,sortings" "Vlad has n friends, for each of whom he wants to buy one gift for the New Year.There are m shops in the city, in each of which he can buy a gift for any of his friends. If the j-th friend (1\xe2\x89\xa4j\xe2\x89\xa4n) receives a gift bought in the shop with the number i (1\xe2\x89\xa4i\xe2\x89\xa4m), then the friend receives pij units of joy. The rectangular table pij is given in the input.Vlad has time to visit at most n\xe2\x88\x921 shops (where n is the number of friends). He chooses which shops he will visit and for which friends he will buy gifts in each of them.Let the j-th friend receive aj units of joy from Vlad\'s gift. Let\'s find the value \xce\xb1=min{a1,a2,\xe2\x80\xa6,an}. Vlad\'s goal is to buy gifts so that the value of \xce\xb1 is as large as possible. In other words, Vlad wants to maximize the minimum of the joys of his friends.For example, let m=2, n=2. Let the joy from the gifts that we can buy in the first shop: p11=1, p12=2, in the second shop: p21=3, p22=4.Then it is enough for Vlad to go only to the second shop and buy a gift for the first friend, bringing joy 3, and for the second \xe2\x80\x94 bringing joy 4. In this case, the value \xce\xb1 will be equal to min{3,4}=3Help Vlad choose gifts for his friends so that the value of \xce\xb1 is as high as possible. Please note that each friend must receive one gift. Vlad can visit at most n\xe2\x88\x921 shops (where n is the number of friends). In the shop, he can buy any number of gifts." 1800
1619C "Wrong Addition" implementation "Tanya is learning how to add numbers, but so far she is not doing it correctly. She is adding two numbers a and b using the following algorithm:  If one of the numbers is shorter than the other, Tanya adds leading zeros so that the numbers are the same length.  The numbers are processed from right to left (that is, from the least significant digits to the most significant).  In the first step, she adds the last digit of a to the last digit of b and writes their sum in the answer.  At each next step, she performs the same operation on each pair of digits in the same place and writes the result to the left side of the answer.  For example, the numbers a=17236 and b=3465 Tanya adds up as follows:+17236034651106911  calculates the sum of 6+5=11 and writes 11 in the answer.  calculates the sum of 3+6=9 and writes the result to the left side of the answer to get 911.  calculates the sum of 2+4=6 and writes the result to the left side of the answer to get 6911.  calculates the sum of 7+3=10, and writes the result to the left side of the answer to get 106911.  calculates the sum of 1+0=1 and writes the result to the left side of the answer and get 1106911. As a result, she gets 1106911.You are given two positive integers a and s. Find the number b such that by adding a and b as described above, Tanya will get s. Or determine that no suitable b exists." 1200
1619B "Squares and Cubes" implementation,math "Polycarp likes squares and cubes of positive integers. Here is the beginning of the sequence of numbers he likes: 1, 4, 8, 9, ....For a given number n, count the number of integers from 1 to n that Polycarp likes. In other words, find the number of such x that x is a square of a positive integer number or a cube of a positive integer number (or both a square and a cube simultaneously)." 800
1619A "Square String?" implementation,strings "A string is called square if it is some string written twice in a row. For example, the strings ""aa"", ""abcabc"", ""abab"" and ""baabaa"" are square. But the strings ""aaa"", ""abaaab"" and ""abcdabc"" are not square.For a given string s determine if it is square." 800
1618G "Trader Problem" "data structures,dsu,greedy,sortings" "Monocarp plays a computer game (yet again!). This game has a unique trading mechanics.To trade with a character, Monocarp has to choose one of the items he possesses and trade it for some item the other character possesses. Each item has an integer price. If Monocarp\'s chosen item has price x, then he can trade it for any item (exactly one item) with price not greater than x+k.Monocarp initially has n items, the price of the i-th item he has is ai. The character Monocarp is trading with has m items, the price of the i-th item they have is bi. Monocarp can trade with this character as many times as he wants (possibly even zero times), each time exchanging one of his items with one of the other character\'s items according to the aforementioned constraints. Note that if Monocarp gets some item during an exchange, he can trade it for another item (since now the item belongs to him), and vice versa: if Monocarp trades one of his items for another item, he can get his item back by trading something for it.You have to answer q queries. Each query consists of one integer, which is the value of k, and asks you to calculate the maximum possible total cost of items Monocarp can have after some sequence of trades, assuming that he can trade an item of cost x for an item of cost not greater than x+k during each trade. Note that the queries are independent: the trades do not actually occur, Monocarp only wants to calculate the maximum total cost he can get." 2200
1618F Reverse "bitmasks,constructive algorithms,dfs and similar,implementation,math,strings" "You are given two positive integers x and y. You can perform the following operation with x: write it in its binary form without leading zeros, add 0 or 1 to the right of it, reverse the binary form and turn it into a decimal number which is assigned as the new value of x.For example:   34 can be turned into 81 via one operation: the binary form of 34 is 100010, if you add 1, reverse it and remove leading zeros, you will get 1010001, which is the binary form of 81.  34 can be turned into 17 via one operation: the binary form of 34 is 100010, if you add 0, reverse it and remove leading zeros, you will get 10001, which is the binary form of 17.  81 can be turned into 69 via one operation: the binary form of 81 is 1010001, if you add 0, reverse it and remove leading zeros, you will get 1000101, which is the binary form of 69.  34 can be turned into 69 via two operations: first you turn 34 into 81 and then 81 into 69. Your task is to find out whether x can be turned into y after a certain number of operations (possibly zero)." 2000
1618E "Singers\' Tour" "constructive algorithms,math" "n towns are arranged in a circle sequentially. The towns are numbered from 1 to n in clockwise order. In the i-th town, there lives a singer with a repertoire of ai minutes for each i\xe2\x88\x88[1,n].Each singer visited all n towns in clockwise order, starting with the town he lives in, and gave exactly one concert in each town. In addition, in each town, the i-th singer got inspired and came up with a song that lasts ai minutes. The song was added to his repertoire so that he could perform it in the rest of the cities.Hence, for the i-th singer, the concert in the i-th town will last ai minutes, in the (i+1)-th town the concert will last 2\xe2\x8b\x85ai minutes, ..., in the ((i+k)modn+1)-th town the duration of the concert will be (k+2)\xe2\x8b\x85ai, ..., in the town ((i+n\xe2\x88\x922)modn+1) \xe2\x80\x94 n\xe2\x8b\x85ai minutes.You are given an array of b integer numbers, where bi is the total duration of concerts in the i-th town. Reconstruct any correct sequence of positive integers a or say that it is impossible." 1700
1618D "Array and Operations" dp,greedy,math "You are given an array a of n integers, and another integer k such that 2k\xe2\x89\xa4n.You have to perform exactly k operations with this array. In one operation, you have to choose two elements of the array (let them be ai and aj; they can be equal or different, but their positions in the array must not be the same), remove them from the array, and add \xe2\x8c\x8aaiaj\xe2\x8c\x8b to your score, where \xe2\x8c\x8axy\xe2\x8c\x8b is the maximum integer not exceeding xy.Initially, your score is 0. After you perform exactly k operations, you add all the remaining elements of the array to the score.Calculate the minimum possible score you can get." 1300
1618C "Paint the Array" math "You are given an array a consisting of n positive integers. You have to choose a positive integer d and paint all elements into two colors. All elements which are divisible by d will be painted red, and all other elements will be painted blue.The coloring is called beautiful if there are no pairs of adjacent elements with the same color in the array. Your task is to find any value of d which yields a beautiful coloring, or report that it is impossible." 1100
1618B "Missing Bigram" implementation "Polycarp has come up with a new game to play with you. He calls it ""A missing bigram"".A bigram of a word is a sequence of two adjacent letters in it.For example, word ""abbaaba"" contains bigrams ""ab"", ""bb"", ""ba"", ""aa"", ""ab"" and ""ba"".The game goes as follows. First, Polycarp comes up with a word, consisting only of lowercase letters \'a\' and \'b\'. Then, he writes down all its bigrams on a whiteboard in the same order as they appear in the word. After that, he wipes one of them off the whiteboard.Finally, Polycarp invites you to guess what the word that he has come up with was.Your goal is to find any word such that it\'s possible to write down all its bigrams and remove one of them, so that the resulting sequence of bigrams is the same as the one Polycarp ended up with.The tests are generated in such a way that the answer exists. If there are multiple answers, you can print any of them." 800
1618A "Polycarp and Sums of Subsequences" math,sortings "Polycarp had an array a of 3 positive integers. He wrote out the sums of all non-empty subsequences of this array, sorted them in non-decreasing order, and got an array b of 7 integers.For example, if a={1,4,3}, then Polycarp wrote out 1, 4, 3, 1+4=5, 1+3=4, 4+3=7, 1+4+3=8. After sorting, he got an array b={1,3,4,4,5,7,8}.Unfortunately, Polycarp lost the array a. He only has the array b left. Help him to restore the array a." 800
1617E "Christmas Chocolates" "dfs and similar,dp,games,graphs,implementation,math,number theory,shortest paths,trees" "Christmas is coming, Icy has just received a box of chocolates from her grandparents! The box contains n chocolates. The i-th chocolate has a non-negative integer type ai.Icy believes that good things come in pairs. Unfortunately, all types of chocolates are distinct (all ai are distinct). Icy wants to make at least one pair of chocolates the same type. As a result, she asks her grandparents to perform some chocolate exchanges. Before performing any chocolate exchanges, Icy chooses two chocolates with indices x and y (1\xe2\x89\xa4x,y\xe2\x89\xa4n, x\xe2\x89\xa0y).In a chocolate exchange, Icy\'s grandparents choose a non-negative integer k, such that 2k\xe2\x89\xa5ax, and change the type of the chocolate x from ax to 2k\xe2\x88\x92ax (that is, perform ax:=2k\xe2\x88\x92ax).The chocolate exchanges will be stopped only when ax=ay. Note that other pairs of equal chocolate types do not stop the procedure.Icy\'s grandparents are smart, so they would choose the sequence of chocolate exchanges that minimizes the number of exchanges needed. Since Icy likes causing trouble, she wants to maximize the minimum number of exchanges needed by choosing x and y appropriately. She wonders what is the optimal pair (x,y) such that the minimum number of exchanges needed is maximized across all possible choices of (x,y).Since Icy is not good at math, she hopes that you can help her solve the problem." 2700
1617D2 "Too Many Impostors (hard version)" "constructive algorithms,implementation,interactive,math" "This is an interactive problem. The only difference between the easy and hard version is the limit on number of questions.There are n players labelled from 1 to n. It is guaranteed that n is a multiple of 3.Among them, there are k impostors and n\xe2\x88\x92k crewmates. The number of impostors, k, is not given to you. It is guaranteed that n3<k<2n3.In each question, you can choose three distinct integers a, b, c (1\xe2\x89\xa4a,b,c\xe2\x89\xa4n) and ask: ""Among the players labelled a, b and c, are there more impostors or more crewmates?"" You will be given the integer 0 if there are more impostors than crewmates, and 1 otherwise.Find the number of impostors k and the indices of players that are impostors after asking at most n+6 questions.The jury is adaptive, which means the indices of impostors may not be fixed beforehand and can depend on your questions. It is guaranteed that there is at least one set of impostors which fulfills the constraints and the answers to your questions at any time." 2400
1617D1 "Too Many Impostors (easy version)" "constructive algorithms,implementation,interactive" "This is an interactive problem. The only difference between the easy and hard version is the limit on number of questions.There are n players labelled from 1 to n. It is guaranteed that n is a multiple of 3.Among them, there are k impostors and n\xe2\x88\x92k crewmates. The number of impostors, k, is not given to you. It is guaranteed that n3<k<2n3.In each question, you can choose three distinct integers a, b, c (1\xe2\x89\xa4a,b,c\xe2\x89\xa4n) and ask: ""Among the players labelled a, b and c, are there more impostors or more crewmates?"" You will be given the integer 0 if there are more impostors than crewmates, and 1 otherwise.Find the number of impostors k and the indices of players that are impostors after asking at most 2n questions.The jury is adaptive, which means the indices of impostors may not be fixed beforehand and can depend on your questions. It is guaranteed that there is at least one set of impostors which fulfills the constraints and the answers to your questions at any time." 1800
1617C "Paprika and Permutation" "binary search,greedy,math,sortings" "Paprika loves permutations. She has an array a1,a2,\xe2\x80\xa6,an. She wants to make the array a permutation of integers 1 to n.In order to achieve this goal, she can perform operations on the array. In each operation she can choose two integers i (1\xe2\x89\xa4i\xe2\x89\xa4n) and x (x>0), then perform ai:=aimodx (that is, replace ai by the remainder of ai divided by x). In different operations, the chosen i and x can be different.Determine the minimum number of operations needed to make the array a permutation of integers 1 to n. If it is impossible, output \xe2\x88\x921.A permutation is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array) and [1,3,4] is also not a permutation (n=3 but there is 4 in the array)." 1300
1617B "GCD Problem" "brute force,constructive algorithms,math,number theory" "Given a positive integer n. Find three distinct positive integers a, b, c such that a+b+c=n and gcd(a,b)=c, where gcd(x,y) denotes the greatest common divisor (GCD) of integers x and y." 900
1617A "Forbidden Subsequence" "constructive algorithms,greedy,sortings,strings" "You are given strings S and T, consisting of lowercase English letters. It is guaranteed that T is a permutation of the string abc. Find string S\xe2\x80\xb2, the lexicographically smallest permutation of S such that T is not a subsequence of S\xe2\x80\xb2.String a is a permutation of string b if the number of occurrences of each distinct character is the same in both strings.A string a is a subsequence of a string b if a can be obtained from b by deletion of several (possibly, zero or all) elements.A string a is lexicographically smaller than a string b if and only if one of the following holds: a is a prefix of b, but a\xe2\x89\xa0b; in the first position where a and b differ, the string a has a letter that appears earlier in the alphabet than the corresponding letter in b." 800
1616H "Keep XOR Low" "bitmasks,combinatorics,data structures,divide and conquer,dp,math" "You are given an array a1,a2,\xe2\x80\xa6,an and an integer x.Find the number of non-empty subsets of indices of this array 1\xe2\x89\xa4b1<b2<\xe2\x80\xa6<bk\xe2\x89\xa4n, such that for all pairs (i,j) where 1\xe2\x89\xa4i<j\xe2\x89\xa4k, the inequality abi\xe2\x8a\x95abj\xe2\x89\xa4x is held. Here, \xe2\x8a\x95 denotes the bitwise XOR operation. As the answer may be very large, output it modulo 998244353." 3000
1616G "Just Add an Edge" "dfs and similar,dp,graphs" "You are given a directed acyclic graph with n vertices and m edges. For all edges a\xe2\x86\x92b in the graph, a<b holds.You need to find the number of pairs of vertices x, y, such that x>y and after adding the edge x\xe2\x86\x92y to the graph, it has a Hamiltonian path." 3500
1616F "Tricolor Triangles" "brute force,graphs,math,matrices" "You are given a simple undirected graph with n vertices and m edges. Edge i is colored in the color ci, which is either 1, 2, or 3, or left uncolored (in this case, ci=\xe2\x88\x921).You need to color all of the uncolored edges in such a way that for any three pairwise adjacent vertices 1\xe2\x89\xa4a<b<c\xe2\x89\xa4n, the colors of the edges a\xe2\x86\x94b, b\xe2\x86\x94c, and a\xe2\x86\x94c are either pairwise different, or all equal. In case no such coloring exists, you need to determine that." 2900
1616E "Lexicographically Small Enough" "brute force,data structures,greedy,strings" "You are given two strings s and t of equal length n. In one move, you can swap any two adjacent characters of the string s.You need to find the minimal number of operations you need to make string s lexicographically smaller than string t.A string a is lexicographically smaller than a string b if and only if one of the following holds:   a is a prefix of b, but a\xe2\x89\xa0b;  in the first position where a and b differ, the string a has a letter that appears earlier in the alphabet than the corresponding letter in b." 2200
1616D "Keep the Average High" dp,greedy,math "You are given an array of integers a1,a2,\xe2\x80\xa6,an and an integer x.You need to select the maximum number of elements in the array, such that for every subsegment al,al+1,\xe2\x80\xa6,ar containing strictly more than one element (l<r), either:   At least one element on this subsegment is not selected, or  al+al+1+\xe2\x80\xa6+ar\xe2\x89\xa5x\xe2\x8b\x85(r\xe2\x88\x92l+1)." 2000
1616C "Representative Edges" "brute force,geometry,implementation,math" "An array a1,a2,\xe2\x80\xa6,an is good if and only if for every subsegment 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n, the following holds: al+al+1+\xe2\x80\xa6+ar=12(al+ar)\xe2\x8b\x85(r\xe2\x88\x92l+1). You are given an array of integers a1,a2,\xe2\x80\xa6,an. In one operation, you can replace any one element of this array with any real number. Find the minimum number of operations you need to make this array good." 1500
1616B "Mirror in the String" greedy,strings "You have a string s1s2\xe2\x80\xa6sn and you stand on the left of the string looking right. You want to choose an index k (1\xe2\x89\xa4k\xe2\x89\xa4n) and place a mirror after the k-th letter, so that what you see is s1s2\xe2\x80\xa6sksksk\xe2\x88\x921\xe2\x80\xa6s1. What is the lexicographically smallest string you can see?A string a is lexicographically smaller than a string b if and only if one of the following holds:   a is a prefix of b, but a\xe2\x89\xa0b;  in the first position where a and b differ, the string a has a letter that appears earlier in the alphabet than the corresponding letter in b." 1100
1616A "Integer Diversity" implementation "You are given n integers a1,a2,\xe2\x80\xa6,an. You choose any subset of the given numbers (possibly, none or all numbers) and negate these numbers (i. e. change x\xe2\x86\x92(\xe2\x88\x92x)). What is the maximum number of different values in the array you can achieve?" 800
1615H "Reindeer Games" "binary search,constructive algorithms,data structures,divide and conquer,flows,graphs,shortest paths" "There are n reindeer at the North Pole, all battling for the highest spot on the ""Top Reindeer"" leaderboard on the front page of CodeNorses (a popular competitive reindeer gaming website). Interestingly, the ""Top Reindeer"" title is just a measure of upvotes and has nothing to do with their skill level in the reindeer games, but they still give it the utmost importance.Currently, the i-th reindeer has a score of ai. You would like to influence the leaderboard with some operations. In an operation, you can choose a reindeer, and either increase or decrease his score by 1 unit. Negative scores are allowed.You have m requirements for the resulting scores. Each requirement is given by an ordered pair (u,v), meaning that after all operations, the score of reindeer u must be less than or equal to the score of reindeer v.Your task is to perform the minimum number of operations so that all requirements will be satisfied." 3000
1615G "Maximum Adjacent Pairs" "constructive algorithms,graph matchings" "You are given an array a consisting of n non-negative integers.You have to replace each 0 in a with an integer from 1 to n (different elements equal to 0 can be replaced by different integers).The value of the array you obtain is the number of integers k from 1 to n such that the following condition holds: there exist a pair of adjacent elements equal to k (i.\xe2\x80\x89e. there exists some i\xe2\x88\x88[1,n\xe2\x88\x921] such that ai=ai+1=k). If there are multiple such pairs for some integer k, this integer is counted in the value only once.Your task is to obtain the array with the maximum possible value." 3300
1615F "LEGOndary Grandmaster" combinatorics,dp,math "After getting bored by playing with crayons, you decided to switch to Legos! Today, you\'re working with a long strip, with height 1 and length n, some positions of which are occupied by 1 by 1 Lego pieces.In one second, you can either remove two adjacent Lego pieces from the strip (if both are present), or add two Lego pieces to adjacent positions (if both are absent). You can only add or remove Lego\'s at two adjacent positions at the same time, as otherwise your chubby fingers run into precision issues.You want to know exactly how much time you\'ll spend playing with Legos. You value efficiency, so given some starting state and some ending state, you\'ll always spend the least number of seconds to transform the starting state into the ending state. If it\'s impossible to transform the starting state into the ending state, you just skip it (so you spend 0 seconds).The issue is that, for some positions, you don\'t remember whether there were Legos there or not (in either the starting state, the ending state, or both). Over all pairs of (starting state, ending state) that are consistent with your memory, find the total amount of time it will take to transform the starting state to the ending state. Print this value modulo 1000000007 (109+7)." 2800
1615E "Purple Crayon" "data structures,dfs and similar,games,graphs,greedy,math,sortings,trees" "Two players, Red and Blue, are at it again, and this time they\'re playing with crayons! The mischievous duo is now vandalizing a rooted tree, by coloring the nodes while playing their favorite game.The game works as follows: there is a tree of size n, rooted at node 1, where each node is initially white. Red and Blue get one turn each. Red goes first. In Red\'s turn, he can do the following operation any number of times:   Pick any subtree of the rooted tree, and color every node in the subtree red.  However, to make the game fair, Red is only allowed to color k nodes of the tree. In other words, after Red\'s turn, at most k of the nodes can be colored red.Then, it\'s Blue\'s turn. Blue can do the following operation any number of times:   Pick any subtree of the rooted tree, and color every node in the subtree blue. However, he\'s not allowed to choose a subtree that contains a node already colored red, as that would make the node purple and no one likes purple crayon.  Note: there\'s no restriction on the number of nodes Blue can color, as long as he doesn\'t color a node that Red has already colored.After the two turns, the score of the game is determined as follows: let w be the number of white nodes, r be the number of red nodes, and b be the number of blue nodes. The score of the game is w\xe2\x8b\x85(r\xe2\x88\x92b).Red wants to maximize this score, and Blue wants to minimize it. If both players play optimally, what will the final score of the game be?" 2400
1615D "X(or)-mas Tree" "bitmasks,dfs and similar,dsu,graphs,trees" "\'Twas the night before Christmas, and Santa\'s frantically setting up his new Christmas tree! There are n nodes in the tree, connected by n\xe2\x88\x921 edges. On each edge of the tree, there\'s a set of Christmas lights, which can be represented by an integer in binary representation.  He has m elves come over and admire his tree. Each elf is assigned two nodes, a and b, and that elf looks at all lights on the simple path between the two nodes. After this, the elf\'s favorite number becomes the bitwise XOR of the values of the lights on the edges in that path.However, the North Pole has been recovering from a nasty bout of flu. Because of this, Santa forgot some of the configurations of lights he had put on the tree, and he has already left the North Pole! Fortunately, the elves came to the rescue, and each one told Santa what pair of nodes he was assigned (ai,bi), as well as the parity of the number of set bits in his favorite number. In other words, he remembers whether the number of 1\'s when his favorite number is written in binary is odd or even.Help Santa determine if it\'s possible that the memories are consistent, and if it is, remember what his tree looked like, and maybe you\'ll go down in history!" 2200
1615C Menorah "brute force,graphs,greedy,math" "There are n candles on a Hanukkah menorah, and some of its candles are initially lit. We can describe which candles are lit with a binary string s, where the i-th candle is lit if and only if si=1.  Initially, the candle lights are described by a string a. In an operation, you select a candle that is currently lit. By doing so, the candle you selected will remain lit, and every other candle will change (if it was lit, it will become unlit and if it was unlit, it will become lit).You would like to make the candles look the same as string b. Your task is to determine if it is possible, and if it is, find the minimum number of operations required." 1600
1615B "And It\'s Non-Zero" bitmasks,greedy,math "You are given an array consisting of all integers from [l,r] inclusive. For example, if l=2 and r=5, the array would be [2,3,4,5]. What\'s the minimum number of elements you can delete to make the bitwise AND of the array non-zero?A bitwise AND is a binary operation that takes two equal-length binary representations and performs the AND operation on each pair of the corresponding bits." 1300
1615A "Closing The Gap" greedy,math "There are n block towers in a row, where tower i has a height of ai. You\'re part of a building crew, and you want to make the buildings look as nice as possible. In a single day, you can perform the following operation:  Choose two indices i and j (1\xe2\x89\xa4i,j\xe2\x89\xa4n; i\xe2\x89\xa0j), and move a block from tower i to tower j. This essentially decreases ai by 1 and increases aj by 1. You think the ugliness of the buildings is the height difference between the tallest and shortest buildings. Formally, the ugliness is defined as max(a)\xe2\x88\x92min(a). What\'s the minimum possible ugliness you can achieve, after any number of days?" 800
1614E "Divan and a Cottage" "binary search,data structures" "Divan\'s new cottage is finally complete! However, after a thorough inspection, it turned out that the workers had installed the insulation incorrectly, and now the temperature in the house directly depends on the temperature outside. More precisely, if the temperature in the house is P in the morning, and the street temperature is T, then by the next morning the temperature in the house changes according to the following rule:   Pnew=P+1, if P<T,  Pnew=P\xe2\x88\x921, if P>T,  Pnew=P, if P=T.  Here Pnew is the temperature in the house next morning.Divan is a very busy businessman, so sometimes he is not at home for long periods and does not know what the temperature is there now, so he hired you to find it. You will work for n days. In the beginning of the i-th day, the temperature outside Ti is first given to you. After that, on the i-th day, you will receive ki queries. Each query asks the following: ""if the temperature in the house was xi at the morning of the first day, what would be the temperature in the house next morning (after day i)?""Please answer all the businessman\'s queries." 2600
1614D2 "Divan and Kostomuksha (hard version)" "dp,number theory" "This is the hard version of the problem. The only difference is maximum value of ai.Once in Kostomuksha Divan found an array a consisting of positive integers. Now he wants to reorder the elements of a to maximize the value of the following function: n\xe2\x88\x91i=1gcd(a1,a2,\xe2\x80\xa6,ai), where gcd(x1,x2,\xe2\x80\xa6,xk) denotes the greatest common divisor of integers x1,x2,\xe2\x80\xa6,xk, and gcd(x)=x for any integer x.Reordering elements of an array means changing the order of elements in the array arbitrary, or leaving the initial order.Of course, Divan can solve this problem. However, he found it interesting, so he decided to share it with you." 2300
1614D1 "Divan and Kostomuksha (easy version)" "dp,number theory" "This is the easy version of the problem. The only difference is maximum value of ai.Once in Kostomuksha Divan found an array a consisting of positive integers. Now he wants to reorder the elements of a to maximize the value of the following function: n\xe2\x88\x91i=1gcd(a1,a2,\xe2\x80\xa6,ai), where gcd(x1,x2,\xe2\x80\xa6,xk) denotes the greatest common divisor of integers x1,x2,\xe2\x80\xa6,xk, and gcd(x)=x for any integer x.Reordering elements of an array means changing the order of elements in the array arbitrary, or leaving the initial order.Of course, Divan can solve this problem. However, he found it interesting, so he decided to share it with you." 2100
1614C "Divan and bitwise operations" "bitmasks,combinatorics,constructive algorithms,dp,math" "Once Divan analyzed a sequence a1,a2,\xe2\x80\xa6,an consisting of n non-negative integers as follows. He considered each non-empty subsequence of the sequence a, computed the bitwise XOR of its elements and added up all the XORs, obtaining the coziness of the sequence a.A sequence c is a subsequence of a sequence d if c can be obtained from d by deletion of several (possibly, zero or all) elements. For example, [1,2,3,4], [2,4], and [2] are subsequences of [1,2,3,4], but [4,3] and [0] are not.Divan was very proud of his analysis, but now he lost the sequence a, and also the coziness value! However, Divan remembers the value of bitwise OR on m contiguous subsegments of the sequence a. It turns out that each element of the original sequence is contained in at least one of these m segments.Divan asks you to help find the coziness of the sequence a using the information he remembers. If several coziness values are possible, print any.As the result can be very large, print the value modulo 109+7." 1500
1614B "Divan and a New Project" "constructive algorithms,sortings" "The company ""Divan\'s Sofas"" is planning to build n+1 different buildings on a coordinate line so that:   the coordinate of each building is an integer number;  no two buildings stand at the same point. Let xi be the coordinate of the i-th building. To get from the building i to the building j, Divan spends |xi\xe2\x88\x92xj| minutes, where |y| is the absolute value of y.All buildings that Divan is going to build can be numbered from 0 to n. The businessman will live in the building 0, the new headquarters of ""Divan\'s Sofas"". In the first ten years after construction Divan will visit the i-th building ai times, each time spending 2\xe2\x8b\x85|x0\xe2\x88\x92xi| minutes for walking.Divan asks you to choose the coordinates for all n+1 buildings so that over the next ten years the businessman will spend as little time for walking as possible." 1000
1614A "Divan and a Store" "brute force,constructive algorithms,greedy" "Businessman Divan loves chocolate! Today he came to a store to buy some chocolate. Like all businessmen, Divan knows the value of money, so he will not buy too expensive chocolate. At the same time, too cheap chocolate tastes bad, so he will not buy it as well.The store he came to has n different chocolate bars, and the price of the i-th chocolate bar is ai dollars. Divan considers a chocolate bar too expensive if it costs strictly more than r dollars. Similarly, he considers a bar of chocolate to be too cheap if it costs strictly less than l dollars. Divan will not buy too cheap or too expensive bars.Divan is not going to spend all his money on chocolate bars, so he will spend at most k dollars on chocolates.Please determine the maximum number of chocolate bars Divan can buy." 800
1613F "Tree Coloring" "combinatorics,divide and conquer,fft" "You are given a rooted tree consisting of n vertices numbered from 1 to n. The root of the tree is the vertex 1.You have to color all vertices of the tree into n colors (also numbered from 1 to n) so that there is exactly one vertex for each color. Let ci be the color of vertex i, and pi be the parent of vertex i in the rooted tree. The coloring is considered beautiful if there is no vertex k (k>1) such that ck=cpk\xe2\x88\x921, i.\xe2\x80\x89e. no vertex such that its color is less than the color of its parent by exactly 1.Calculate the number of beautiful colorings, and print it modulo 998244353." 2600
1613E "Crazy Robot" "dfs and similar,graphs" "There is a grid, consisting of n rows and m columns. Each cell of the grid is either free or blocked. One of the free cells contains a lab. All the cells beyond the borders of the grid are also blocked.A crazy robot has escaped from this lab. It is currently in some free cell of the grid. You can send one of the following commands to the robot: ""move right"", ""move down"", ""move left"" or ""move up"". Each command means moving to a neighbouring cell in the corresponding direction.However, as the robot is crazy, it will do anything except following the command. Upon receiving a command, it will choose a direction such that it differs from the one in command and the cell in that direction is not blocked. If there is such a direction, then it will move to a neighbouring cell in that direction. Otherwise, it will do nothing.We want to get the robot to the lab to get it fixed. For each free cell, determine if the robot can be forced to reach the lab starting in this cell. That is, after each step of the robot a command can be sent to a robot such that no matter what different directions the robot chooses, it will end up in a lab." 2000
1613D "MEX Sequences" dp,math "Let\'s call a sequence of integers x1,x2,\xe2\x80\xa6,xk MEX-correct if for all i (1\xe2\x89\xa4i\xe2\x89\xa4k) |xi\xe2\x88\x92MEX(x1,x2,\xe2\x80\xa6,xi)|\xe2\x89\xa41 holds. Where MEX(x1,\xe2\x80\xa6,xk) is the minimum non-negative integer that doesn\'t belong to the set x1,\xe2\x80\xa6,xk. For example, MEX(1,0,1,3)=2 and MEX(2,1,5)=0.You are given an array a consisting of n non-negative integers. Calculate the number of non-empty MEX-correct subsequences of a given array. The number of subsequences can be very large, so print it modulo 998244353. Note: a subsequence of an array a is a sequence [ai1,ai2,\xe2\x80\xa6,aim] meeting the constraints 1\xe2\x89\xa4i1<i2<\xe2\x8b\xaf<im\xe2\x89\xa4n. If two different ways to choose the sequence of indices [i1,i2,\xe2\x80\xa6,im] yield the same subsequence, the resulting subsequence should be counted twice (i.\xe2\x80\x89e. two subsequences are different if their sequences of indices [i1,i2,\xe2\x80\xa6,im] are not the same)." 1900
1613C "Poisoned Dagger" "binary search" "Monocarp is playing yet another computer game. In this game, his character has to kill a dragon. The battle with the dragon lasts 100500 seconds, during which Monocarp attacks the dragon with a poisoned dagger. The i-th attack is performed at the beginning of the ai-th second from the battle start. The dagger itself does not deal damage, but it applies a poison effect on the dragon, which deals 1 damage during each of the next k seconds (starting with the same second when the dragon was stabbed by the dagger). However, if the dragon has already been poisoned, then the dagger updates the poison effect (i.e. cancels the current poison effect and applies a new one).For example, suppose k=4, and Monocarp stabs the dragon during the seconds 2, 4 and 10. Then the poison effect is applied at the start of the 2-nd second and deals 1 damage during the 2-nd and 3-rd seconds; then, at the beginning of the 4-th second, the poison effect is reapplied, so it deals exactly 1 damage during the seconds 4, 5, 6 and 7; then, during the 10-th second, the poison effect is applied again, and it deals 1 damage during the seconds 10, 11, 12 and 13. In total, the dragon receives 10 damage.Monocarp knows that the dragon has h hit points, and if he deals at least h damage to the dragon during the battle \xe2\x80\x94 he slays the dragon. Monocarp has not decided on the strength of the poison he will use during the battle, so he wants to find the minimum possible value of k (the number of seconds the poison effect lasts) that is enough to deal at least h damage to the dragon." 1200
1613B "Absent Remainder" greedy,implementation,sortings "You are given a sequence a1,a2,\xe2\x80\xa6,an consisting of n pairwise distinct positive integers.Find \xe2\x8c\x8an2\xe2\x8c\x8b different pairs of integers x and y such that:   x\xe2\x89\xa0y;  x and y appear in a;  x mod y doesn\'t appear in a. Note that some x or y can belong to multiple pairs.\xe2\x8c\x8ax\xe2\x8c\x8b denotes the floor function \xe2\x80\x94 the largest integer less than or equal to x. x mod y denotes the remainder from dividing x by y.If there are multiple solutions, print any of them. It can be shown that at least one solution always exists." 1000
1613A "Long Comparison" implementation,math "Monocarp wrote down two numbers on a whiteboard. Both numbers follow a specific format: a positive integer x with p zeros appended to its end.Now Monocarp asks you to compare these two numbers. Can you help him?" 900
1612G "Max Sum Array" "combinatorics,constructive algorithms,greedy,sortings" "You are given an array c=[c1,c2,\xe2\x80\xa6,cm]. An array a=[a1,a2,\xe2\x80\xa6,an] is constructed in such a way that it consists of integers 1,2,\xe2\x80\xa6,m, and for each i\xe2\x88\x88[1,m], there are exactly ci occurrences of integer i in a. So, the number of elements in a is exactly m\xe2\x88\x91i=1ci.Let\'s define for such array a the value f(a) as f(a)=\xe2\x88\x911\xe2\x89\xa4i<j\xe2\x89\xa4nai=ajj\xe2\x88\x92i.In other words, f(a) is the total sum of distances between all pairs of equal elements.Your task is to calculate the maximum possible value of f(a) and the number of arrays yielding the maximum possible value of f(a). Two arrays are considered different, if elements at some position differ." 2500
1612F "Armor and Weapons" "brute force,dp,greedy,shortest paths" "Monocarp plays a computer game. There are n different sets of armor and m different weapons in this game. If a character equips the i-th set of armor and wields the j-th weapon, their power is usually equal to i+j; but some combinations of armor and weapons synergize well. Formally, there is a list of q ordered pairs, and if the pair (i,j) belongs to this list, the power of the character equipped with the i-th set of armor and wielding the j-th weapon is not i+j, but i+j+1.Initially, Monocarp\'s character has got only the 1-st armor set and the 1-st weapon. Monocarp can obtain a new weapon or a new set of armor in one hour. If he wants to obtain the k-th armor set or the k-th weapon, he must possess a combination of an armor set and a weapon that gets his power to k or greater. Of course, after Monocarp obtains a weapon or an armor set, he can use it to obtain new armor sets or weapons, but he can go with any of the older armor sets and/or weapons as well.Monocarp wants to obtain the n-th armor set and the m-th weapon. What is the minimum number of hours he has to spend on it?" 2800
1612E Messages "brute force,dp,greedy,probabilities,sortings" "Monocarp is a tutor of a group of n students. He communicates with them using a conference in a popular messenger.Today was a busy day for Monocarp \xe2\x80\x94 he was asked to forward a lot of posts and announcements to his group, that\'s why he had to write a very large number of messages in the conference. Monocarp knows the students in the group he is tutoring quite well, so he understands which message should each student read: Monocarp wants the student i to read the message mi.Of course, no one\'s going to read all the messages in the conference. That\'s why Monocarp decided to pin some of them. Monocarp can pin any number of messages, and if he wants anyone to read some message, he should pin it \xe2\x80\x94 otherwise it will definitely be skipped by everyone.Unfortunately, even if a message is pinned, some students may skip it anyway. For each student i, Monocarp knows that they will read at most ki messages. Suppose Monocarp pins t messages; if t\xe2\x89\xa4ki, then the i-th student will read all the pinned messages; but if t>ki, the i-th student will choose exactly ki random pinned messages (all possible subsets of pinned messages of size ki are equiprobable) and read only the chosen messages.Monocarp wants to maximize the expected number of students that read their respective messages (i.e. the number of such indices i that student i reads the message mi). Help him to choose how many (and which) messages should he pin!" 2000
1612D "X-Magic Pair" "math,number theory" "You are given a pair of integers (a,b) and an integer x.You can change the pair in two different ways:   set (assign) a:=|a\xe2\x88\x92b|;  set (assign) b:=|a\xe2\x88\x92b|,  where |a\xe2\x88\x92b| is the absolute difference between a and b.The pair (a,b) is called x-magic if x is obtainable either as a or as b using only the given operations (i.e. the pair (a,b) is x-magic if a=x or b=x after some number of operations applied). You can apply the operations any number of times (even zero).Your task is to find out if the pair (a,b) is x-magic or not.You have to answer t independent test cases." 1600
1612C "Chat Ban" "binary search,math" "You are a usual chat user on the most famous streaming platform. Of course, there are some moments when you just want to chill and spam something.More precisely, you want to spam the emote triangle of size k. It consists of 2k\xe2\x88\x921 messages. The first message consists of one emote, the second one \xe2\x80\x94 of two emotes, ..., the k-th one \xe2\x80\x94 of k emotes, the k+1-th one \xe2\x80\x94 of k\xe2\x88\x921 emotes, ..., and the last one \xe2\x80\x94 of one emote.For example, the emote triangle for k=3 consists of 5 messages:  Of course, most of the channels have auto moderation. Auto moderator of the current chat will ban you right after you spam at least x emotes in succession (you can assume you are the only user in the chat). Now you are interested \xe2\x80\x94 how many messages will you write before getting banned? Or maybe you will not get banned at all (i.e. will write all 2k\xe2\x88\x921 messages and complete your emote triangle successfully)? Note that if you get banned as a result of writing a message, this message is also counted.You have to answer t independent test cases." 1300
1612B "Special Permutation" "constructive algorithms,greedy" "A permutation of length n is an array p=[p1,p2,\xe2\x80\xa6,pn] which contains every integer from 1 to n (inclusive) exactly once. For example, p=[4,2,6,5,3,1] is a permutation of length 6.You are given three integers n, a and b, where n is an even number. Print any permutation of length n that the minimum among all its elements of the left half equals a and the maximum among all its elements of the right half equals b. Print -1 if no such permutation exists." 900
1612A Distance "brute force,constructive algorithms" "Let\'s denote the Manhattan distance between two points p1 (with coordinates (x1,y1)) and p2 (with coordinates (x2,y2)) as d(p1,p2)=|x1\xe2\x88\x92x2|+|y1\xe2\x88\x92y2|. For example, the distance between two points with coordinates (1,3) and (4,2) is |1\xe2\x88\x924|+|3\xe2\x88\x922|=4.You are given two points, A and B. The point A has coordinates (0,0), the point B has coordinates (x,y).Your goal is to find a point C such that:  both coordinates of C are non-negative integers;  d(A,C)=d(A,B)2 (without any rounding);  d(B,C)=d(A,B)2 (without any rounding). Find any point C that meets these constraints, or report that no such point exists." 800
1611G "Robot and Candies" "data structures,graph matchings,greedy" "Polycarp has a rectangular field of n\xc3\x97m cells (the size of the n\xe2\x8b\x85m field does not exceed 106 cells, m\xe2\x89\xa52), in each cell of which there can be candy. There are n rows and m columns in the field.Let\'s denote a cell with coordinates x vertically and y horizontally by (x,y). Then the top-left cell will be denoted as (1,1), and the bottom-right cell will be denoted as (n,m).If there is candy in the cell, then the cell is marked with the symbol \'1\', otherwise \xe2\x80\x94 with the symbol \'0\'.Polycarp made a Robot that can collect candy. The Robot can move from (x,y) either to (x+1,y+1), or to (x+1,y\xe2\x88\x921). If the Robot is in a cell that contains candy, it takes it.While there is at least one candy on the field, the following procedure is executed:   Polycarp puts the Robot in an arbitrary cell on the topmost row of the field. He himself chooses in which cell to place the Robot. It is allowed to put the Robot in the same cell multiple times.  The Robot moves across the field and collects candies. He controls the Robot.  When the Robot leaves the field, Polycarp takes it. If there are still candies left, Polycarp repeats the procedure. Find the minimum number of times Polycarp needs to put the Robot on the topmost row of the field in order to collect all the candies. It is guaranteed that Polycarp can always collect all the candies." 2500
1611F "ATM and Students" "binary search,data structures,two pointers" "Polycarp started working at a bank. He was assigned to monitor the ATM. The ATM initially contains s rubles.A queue of n students lined up to him. Each student wants to either withdraw a certain amount of money or deposit it into an account. If ai is positive, then the student credits that amount of money via ATM. Otherwise, the student withdraws |ai| rubles.In the beginning, the ATM is turned off and an arbitrary number of students are not served. At some point, Polycarp turns on the ATM, which has an initial amount of s rubles. Then, the remaining students start queueing at the ATM. If at some point in time there is less money in the ATM than the student wants to withdraw, then the student is not served and Polycarp turns off the ATM and does not turn it on anymore.More formally, the students that are served are forming a contiguous subsequence.Polycarp wants the ATM to serve the maximum number of students. Help him in this matter. Print the numbers of the first and last student, or determine that he will not be able to serve anyone.In other words, find such a longest continuous segment of students that, starting with the sum of s at the ATM, all these students will be served. ATM serves students consistently (i.e. one after another in the order of the queue)." 1800
1611E2 "Escape The Maze (hard version)" "dfs and similar,dp,greedy,shortest paths,trees" "The only difference with E1 is the question of the problem.Vlad built a maze out of n rooms and n\xe2\x88\x921 bidirectional corridors. From any room u any other room v can be reached through a sequence of corridors. Thus, the room system forms an undirected tree.Vlad invited k friends to play a game with them.Vlad starts the game in the room 1 and wins if he reaches a room other than 1, into which exactly one corridor leads. Friends are placed in the maze: the friend with number i is in the room xi, and no two friends are in the same room (that is, xi\xe2\x89\xa0xj for all i\xe2\x89\xa0j). Friends win if one of them meets Vlad in any room or corridor before he wins.For one unit of time, each participant of the game can go through one corridor. All participants move at the same time. Participants may not move. Each room can fit all participants at the same time.Friends know the plan of a maze and intend to win. They don\'t want to waste too much energy. They ask you to determine if they can win and if they can, what minimum number of friends must remain in the maze so that they can always catch Vlad.In other words, you need to determine the size of the minimum (by the number of elements) subset of friends who can catch Vlad or say that such a subset does not exist." 1900
1611E1 "Escape The Maze (easy version)" "dfs and similar,greedy,shortest paths,trees,two pointers" "The only difference with E2 is the question of the problem..Vlad built a maze out of n rooms and n\xe2\x88\x921 bidirectional corridors. From any room u any other room v can be reached through a sequence of corridors. Thus, the room system forms an undirected tree.Vlad invited k friends to play a game with them.Vlad starts the game in the room 1 and wins if he reaches a room other than 1, into which exactly one corridor leads.Friends are placed in the maze: the friend with number i is in the room xi, and no two friends are in the same room (that is, xi\xe2\x89\xa0xj for all i\xe2\x89\xa0j). Friends win if one of them meets Vlad in any room or corridor before he wins.For one unit of time, each participant of the game can go through one corridor. All participants move at the same time. Participants may not move. Each room can fit all participants at the same time. Friends know the plan of a maze and intend to win. Vlad is a bit afraid of their ardor. Determine if he can guarantee victory (i.e. can he win in any way friends play).In other words, determine if there is such a sequence of Vlad\'s moves that lets Vlad win in any way friends play." 1700
1611D "Weights Assignment For Tree Edges" "constructive algorithms,trees" "You are given a rooted tree consisting of n vertices. Vertices are numbered from 1 to n. Any vertex can be the root of a tree.A tree is a connected undirected graph without cycles. A rooted tree is a tree with a selected vertex, which is called the root.The tree is specified by an array of ancestors b containing n numbers: bi is an ancestor of the vertex with the number i. The ancestor of a vertex u is a vertex that is the next vertex on a simple path from u to the root. For example, on the simple path from 5 to 3 (the root), the next vertex would be 1, so the ancestor of 5 is 1.The root has no ancestor, so for it, the value of bi is i (the root is the only vertex for which bi=i).For example, if n=5 and b=[3,1,3,3,1], then the tree looks like this.  An example of a rooted tree for n=5, the root of the tree is a vertex number 3. You are given an array p \xe2\x80\x94 a permutation of the vertices of the tree. If it is possible, assign any positive integer weights on the edges, so that the vertices sorted by distance from the root would form the given permutation p.In other words, for a given permutation of vertices p, it is necessary to choose such edge weights so that the condition dist[pi]<dist[pi+1] is true for each i from 1 to n\xe2\x88\x921. dist[u] is a sum of the weights of the edges on the path from the root to u. In particular, dist[u]=0 if the vertex u is the root of the tree.For example, assume that p=[3,1,2,5,4]. In this case, the following edge weights satisfy this permutation:  the edge (3,4) has a weight of 102;  the edge (3,1) has weight of 1;  the edge (1,2) has a weight of 10;  the edge (1,5) has a weight of 100. The array of distances from the root looks like: dist=[1,11,0,102,101]. The vertices sorted by increasing the distance from the root form the given permutation p.Print the required edge weights or determine that there is no suitable way to assign weights. If there are several solutions, then print any of them." 1500
1611C "Polycarp Recovers the Permutation" "constructive algorithms" "Polycarp wrote on a whiteboard an array p of length n, which is a permutation of numbers from 1 to n. In other words, in p each number from 1 to n occurs exactly once.He also prepared a resulting array a, which is initially empty (that is, it has a length of 0).After that, he did exactly n steps. Each step looked like this:  Look at the leftmost and rightmost elements of p, and pick the smaller of the two. If you picked the leftmost element of p, append it to the left of a; otherwise, if you picked the rightmost element of p, append it to the right of a. The picked element is erased from p. Note that on the last step, p has a length of 1 and its minimum element is both leftmost and rightmost. In this case, Polycarp can choose what role the minimum element plays. In other words, this element can be added to a both on the left and on the right (at the discretion of Polycarp).Let\'s look at an example. Let n=4, p=[3,1,4,2]. Initially a=[]. Then: During the first step, the minimum is on the right (with a value of 2), so after this step, p=[3,1,4] and a=[2] (he added the value 2 to the right).  During the second step, the minimum is on the left (with a value of 3), so after this step, p=[1,4] and a=[3,2] (he added the value 3 to the left).  During the third step, the minimum is on the left (with a value of 1), so after this step, p=[4] and a=[1,3,2] (he added the value 1 to the left).  During the fourth step, the minimum is both left and right (this value is 4). Let\'s say Polycarp chose the right option. After this step, p=[] and a=[1,3,2,4] (he added the value 4 to the right).Thus, a possible value of a after n steps could be a=[1,3,2,4].You are given the final value of the resulting array a. Find any possible initial value for p that can result the given a, or determine that there is no solution." 1000
1611B "Team Composition: Programmers and Mathematicians" "binary search,constructive algorithms,math" "The All-Berland Team Programming Contest will take place very soon. This year, teams of four are allowed to participate.There are a programmers and b mathematicians at Berland State University. How many maximum teams can be made if:  each team must consist of exactly 4 students,  teams of 4 mathematicians or 4 programmers are unlikely to perform well, so the decision was made not to compose such teams. Thus, each team must have at least one programmer and at least one mathematician.Print the required maximum number of teams. Each person can be a member of no more than one team." 800
1611A "Make Even" "constructive algorithms,math" "Polycarp has an integer n that doesn\'t contain the digit 0. He can do the following operation with his number several (possibly zero) times: Reverse the prefix of length l (in other words, l leftmost digits) of n. So, the leftmost digit is swapped with the l-th digit from the left, the second digit from the left swapped with (l\xe2\x88\x921)-th left, etc. For example, if n=123456789 and l=5, then the new value of n will be 543216789.Note that for different operations, the values of l can be different. The number l can be equal to the length of the number n \xe2\x80\x94 in this case, the whole number n is reversed.Polycarp loves even numbers. Therefore, he wants to make his number even. At the same time, Polycarp is very impatient. He wants to do as few operations as possible.Help Polycarp. Determine the minimum number of operations he needs to perform with the number n to make it even or determine that this is impossible.You need to answer t independent test cases." 800
1610I "Mashtali vs AtCoder" games,trees "After many unsuccessful tries, Mashtali decided to copy modify an AtCoder problem. So here is his copied new problem:There is a tree with n vertices and some non-empty set of the vertices are pinned to the ground.Two players play a game against each other on the tree. They alternately perform the following action:  Remove an edge from the tree, then remove every connected component that has no pinned vertex.The player who cannot move loses(every edge has been deleted already). You are given the tree, but not the set of the pinned vertices. Your task is to determine, for each k, the winner of the game, if only the vertices 1,2,3,\xe2\x80\xa6,k are pinned and both players play optimally." 3100
1610H "Squid Game" "data structures,dfs and similar,greedy,trees" "After watching the new over-rated series Squid Game, Mashtali and Soroush decided to hold their own Squid Games! Soroush agreed to be the host and will provide money for the winner\'s prize, and Mashtali became the Front Man!m players registered to play in the games to win the great prize, but when Mashtali found out how huge the winner\'s prize is going to be, he decided to kill eliminate all the players so he could take the money for himself!Here is how evil Mashtali is going to eliminate players:There is an unrooted tree with n vertices. Every player has 2 special vertices xi and yi.In one operation, Mashtali can choose any vertex v of the tree. Then, for each remaining player i he finds a vertex w on the simple path from xi to yi, which is the closest to v. If w\xe2\x89\xa0xi and w\xe2\x89\xa0yi, player i will be eliminated.Now Mashtali wondered: ""What is the minimum number of operations I should perform so that I can remove every player from the game and take the money for myself?""Since he was only thinking about the money, he couldn\'t solve the problem by himself and asked for your help!" 3100
1610G "AmShZ Wins a Bet" "data structures,greedy,hashing" "Right before the UEFA Euro 2020, AmShZ and Safar placed bets on who\'d be the champion, AmShZ betting on Italy, and Safar betting on France.Of course, AmShZ won. Hence, Safar gave him a bracket sequence S. Note that a bracket sequence is a string made of \'(\' and \')\' characters.AmShZ can perform the following operation any number of times:  First, he cuts his string S into three (possibly empty) contiguous substrings A,B and C. Then, he glues them back by using a \'(\' and a \')\' characters, resulting in a new string S = A + ""("" + B + "")"" + C.For example, if S = ""))(("" and AmShZ cuts it into A = """", B = ""))"", and C = ""(("", He will obtain S = ""()))(("" as a new string. After performing some (possibly none) operations, AmShZ gives his string to Keshi and asks him to find the initial string. Of course, Keshi might be able to come up with more than one possible initial string. Keshi is interested in finding the lexicographically smallest possible initial string.Your task is to help Keshi in achieving his goal.A string a is lexicographically smaller than a string b if and only if one of the following holds: a is a prefix of b, but a\xe2\x89\xa0b; in the first position where a and b differ, the string a has a letter that appears earlier in the alphabet than the corresponding letter in b." 3300
1610F "Mashtali: a Space Oddysey" "constructive algorithms,dfs and similar,graphs" "Lee was planning to get closer to Mashtali\'s heart to proceed with his evil plan(which we\'re not aware of, yet), so he decided to beautify Mashtali\'s graph. But he made several rules for himself. And also he was too busy with his plans that he didn\'t have time for such minor tasks, so he asked you for help.Mashtali\'s graph is an undirected weighted graph with n vertices and m edges with weights equal to either 1 or 2. Lee wants to direct the edges of Mashtali\'s graph so that it will be as beautiful as possible.Lee thinks that the beauty of a directed weighted graph is equal to the number of its Oddysey vertices. A vertex v is an Oddysey vertex if |d+(v)\xe2\x88\x92d\xe2\x88\x92(v)|=1, where d+(v) is the sum of weights of the outgoing from v edges, and d\xe2\x88\x92(v) is the sum of the weights of the incoming to v edges.Find the largest possible beauty of a graph that Lee can achieve by directing the edges of Mashtali\'s graph. In addition, find any way to achieve it.Note that you have to orient each edge." 3000
1610E "AmShZ and G.O.A.T." "binary search,brute force,greedy,implementation,math" "Let\'s call an array of k integers c1,c2,\xe2\x80\xa6,ck terrible, if the following condition holds:Let AVG be the c1+c2+\xe2\x80\xa6+ckk(the average of all the elements of the array, it doesn\'t have to be integer). Then the number of elements of the array which are bigger than AVG should be strictly larger than the number of elements of the array which are smaller than AVG. Note that elements equal to AVG don\'t count.For example c={1,4,4,5,6} is terrible because AVG=4.0 and 5-th and 4-th elements are greater than AVG and 1-st element is smaller than AVG.Let\'s call an array of m integers b1,b2,\xe2\x80\xa6,bm bad, if at least one of its non-empty subsequences is terrible, and good otherwise.You are given an array of n integers a1,a2,\xe2\x80\xa6,an. Find the minimum number of elements that you have to delete from it to obtain a good array.An array is a subsequence of another array if it can be obtained from it by deletion of several (possibly, zero or all) elements." 2300
1610D "Not Quite Lee" "combinatorics,dp,math,number theory" "Lee couldn\'t sleep lately, because he had nightmares. In one of his nightmares (which was about an unbalanced global round), he decided to fight back and propose a problem below (which you should solve) to balance the round, hopefully setting him free from the nightmares.A non-empty array b1,b2,\xe2\x80\xa6,bmb1,b2,\xe2\x80\xa6,bm is called good, if there exist mm integer sequences which satisfy the following properties:  The ii-th sequence consists of bibi consecutive integers (for example if bi=3bi=3 then the ii-th sequence can be (\xe2\x88\x921,0,1)(\xe2\x88\x921,0,1) or (\xe2\x88\x925,\xe2\x88\x924,\xe2\x88\x923)(\xe2\x88\x925,\xe2\x88\x924,\xe2\x88\x923) but not (0,\xe2\x88\x921,1)(0,\xe2\x88\x921,1) or (1,2,3,4)(1,2,3,4)).  Assuming the sum of integers in the ii-th sequence is sumisumi, we want sum1+sum2+\xe2\x80\xa6+summsum1+sum2+\xe2\x80\xa6+summ to be equal to 00. You are given an array a1,a2,\xe2\x80\xa6,ana1,a2,\xe2\x80\xa6,an. It has 2n\xe2\x88\x9212n\xe2\x88\x921 nonempty subsequences. Find how many of them are good.As this number can be very large, output it modulo 109+7109+7.An array cc is a subsequence of an array dd if cc can be obtained from dd by deletion of several (possibly, zero or all) elements." 2000
1610C "Keshi Is Throwing a Party" "binary search,greedy" "Keshi is throwing a party and he wants everybody in the party to be happy.He has n friends. His i-th friend has i dollars. If you invite the i-th friend to the party, he will be happy only if at most ai people in the party are strictly richer than him and at most bi people are strictly poorer than him.Keshi wants to invite as many people as possible. Find the maximum number of people he can invite to the party so that every invited person would be happy." 1600
1610B "Kalindrome Array" "greedy,two pointers" "An array [b1,b2,\xe2\x80\xa6,bm] is a palindrome, if bi=bm+1\xe2\x88\x92i for each i from 1 to m. Empty array is also a palindrome.An array is called kalindrome, if the following condition holds: It\'s possible to select some integer x and delete some of the elements of the array equal to x, so that the remaining array (after gluing together the remaining parts) is a palindrome. Note that you don\'t have to delete all elements equal to x, and you don\'t have to delete at least one element equal to x.For example :   [1,2,1] is kalindrome because you can simply not delete a single element.  [3,1,2,3,1] is kalindrome because you can choose x=3 and delete both elements equal to 3, obtaining array [1,2,1], which is a palindrome.  [1,2,3] is not kalindrome. You are given an array [a1,a2,\xe2\x80\xa6,an]. Determine if a is kalindrome or not." 1100
1610A "Anti Light\'s Cell Guessing" math "You are playing a game on a n\xc3\x97m grid, in which the computer has selected some cell (x,y) of the grid, and you have to determine which one. To do so, you will choose some k and some k cells (x1,y1),(x2,y2),\xe2\x80\xa6,(xk,yk), and give them to the computer. In response, you will get k numbers b1,b2,\xe2\x80\xa6bk, where bi is the manhattan distance from (xi,yi) to the hidden cell (x,y) (so you know which distance corresponds to which of k input cells). After receiving these b1,b2,\xe2\x80\xa6,bk, you have to be able to determine the hidden cell. What is the smallest k for which is it possible to always guess the hidden cell correctly, no matter what cell computer chooses?As a reminder, the manhattan distance between cells (a1,b1) and (a2,b2) is equal to |a1\xe2\x88\x92a2|+|b1\xe2\x88\x92b2|." 900
1609H "Pushing Robots" NA "There\'re n robots placed on a number line. Initially, i-th of them occupies unit segment [xi,xi+1]. Each robot has a program, consisting of k instructions numbered from 1 to k. The robot performs instructions in a cycle. Each instruction is described by an integer number. Let\'s denote the number corresponding to the j-th instruction of the i-th robot as fi,j.Initial placement of robots corresponds to the moment of time 0. During one second from moment of time t (0\xe2\x89\xa4t) until t+1 the following process occurs:   Each robot performs (tmodk+1)-th instruction from its list of instructions. Robot number i takes number F=fi,(tmodk+1). If this number is negative (less than zero), the robot is trying to move to the left with force |F|. If the number is positive (more than zero), the robot is trying to move to the right with force F. Otherwise, the robot does nothing.  Let\'s imaginary divide robots into groups of consecutive, using the following algorithm:   Initially, each robot belongs to its own group.  Let\'s sum up numbers corresponding to the instructions of the robots from one group. Note that we are summing numbers without taking them by absolute value. Denote this sum as S. We say that the whole group moves together, and does it with force S by the same rules as a single robot. That is if S is negative, the group is trying to move to the left with force |S|. If S is positive, the group is trying to move to the right with force S. Otherwise, the group does nothing.  If one group is trying to move, and in the direction of movement touches another group, let\'s unite them. One group is touching another if their outermost robots occupy adjacent unit segments.  Continue this process until groups stop uniting.   Each robot moves by 1 in the direction of movement of its group or stays in place if its group isn\'t moving. But there\'s one exception.  The exception is if there\'re two groups of robots, divided by exactly one unit segment, such that the left group is trying to move to the right and the right group is trying to move to the left. Let\'s denote sum in the left group as Sl and sum in the right group as Sr. If |Sl|\xe2\x89\xa4|Sr| only the right group will move. Otherwise, only the left group will move.  Note that robots from one group don\'t glue together. They may separate in the future. The division into groups is imaginary and is needed only to understand how robots will move during one second [t,t+1]. An illustration of the process happening during one second:   Rectangles represent robots. Numbers inside rectangles correspond to instructions of robots. The final division into groups is marked with arcs. Below are the positions of the robots after moving. Only the left of the two rightmost groups moved. That\'s because these two groups tried to move towards each other, and were separated by exactly one unit segment.Look at the examples for a better understanding of the process.You need to answer several questions. What is the position of ai-th robot at the moment of time ti?" 3500
1609G "A Stroll Around the Matrix" "data structures,greedy,math" "William has two arrays of numbers a1,a2,\xe2\x80\xa6,ana1,a2,\xe2\x80\xa6,an and b1,b2,\xe2\x80\xa6,bm. The arrays satisfy the conditions of being convex. Formally an array c of length k is considered convex if ci\xe2\x88\x92ci\xe2\x88\x921<ci+1\xe2\x88\x92ci for all i from 2 to k\xe2\x88\x921 and c1<c2.Throughout William\'s life he observed q changes of two types happening to the arrays:   Add the arithmetic progression d,d\xe2\x8b\x852,d\xe2\x8b\x853,\xe2\x80\xa6,d\xe2\x8b\x85k to the suffix of the array a of length k. The array after the change looks like this: [a1,a2,\xe2\x80\xa6,an\xe2\x88\x92k,an\xe2\x88\x92k+1+d,an\xe2\x88\x92k+2+d\xe2\x8b\x852,\xe2\x80\xa6,an+d\xe2\x8b\x85k].  The same operation, but for array b. After each change a matrix d is created from arrays a and b, of size n\xc3\x97m, where di,j=ai+bj. William wants to get from cell (1,1) to cell (n,m) of this matrix. From cell (x,y) he can only move to cells (x+1,y) and (x,y+1). The length of a path is calculated as the sum of numbers in cells visited by William, including the first and the last cells.After each change William wants you to help find out the minimal length of the path he could take." 3000
1609F "Interesting Sections" "data structures,divide and conquer,meet-in-the-middle,two pointers" "William has an array of non-negative numbers a1,a2,\xe2\x80\xa6,an. He wants you to find out how many segments l\xe2\x89\xa4r pass the check. The check is performed in the following manner:   The minimum and maximum numbers are found on the segment of the array starting at l and ending at r.  The check is considered to be passed if the binary representation of the minimum and maximum numbers have the same number of bits equal to 1." 2800
1609E "William The Oblivious" "bitmasks,data structures,dp,matrices" "Before becoming a successful trader William got a university degree. During his education an interesting situation happened, after which William started to listen to homework assignments much more attentively. What follows is a formal description of the homework assignment as William heard it:You are given a string s of length n only consisting of characters ""a"", ""b"" and ""c"". There are q queries of format (pos,c), meaning replacing the element of string s at position pos with character c. After each query you must output the minimal number of characters in the string, which have to be replaced, so that the string doesn\'t contain string ""abc"" as a subsequence. A valid replacement of a character is replacing it with ""a"", ""b"" or ""c"".A string x is said to be a subsequence of string y if x can be obtained from y by deleting some characters without changing the ordering of the remaining characters." 2400
1609D "Social Network" dsu,graphs,greedy,implementation,trees "William arrived at a conference dedicated to cryptocurrencies. Networking, meeting new people, and using friends\' connections are essential to stay up to date with the latest news from the world of cryptocurrencies.The conference has n participants, who are initially unfamiliar with each other. William can introduce any two people, a and b, who were not familiar before, to each other. William has d conditions, i\'th of which requires person xi to have a connection to person yi. Formally, two people x and y have a connection if there is such a chain p1=x,p2,p3,\xe2\x80\xa6,pk=y for which for all i from 1 to k\xe2\x88\x921 it\'s true that two people with numbers pi and pi+1 know each other.For every i (1\xe2\x89\xa4i\xe2\x89\xa4d) William wants you to calculate the maximal number of acquaintances one person can have, assuming that William satisfied all conditions from 1 and up to and including i and performed exactly i introductions. The conditions are being checked after William performed i introductions. The answer for each i must be calculated independently. It means that when you compute an answer for i, you should assume that no two people have been introduced to each other yet." 1600
1609C "Complex Market Analysis" "binary search,dp,implementation,number theory,schedules,two pointers" "While performing complex market analysis William encountered the following problem:For a given array a of size n and a natural number e, calculate the number of pairs of natural numbers (i,k) which satisfy the following conditions:   1\xe2\x89\xa4i,k  i+e\xe2\x8b\x85k\xe2\x89\xa4n.  Product ai\xe2\x8b\x85ai+e\xe2\x8b\x85ai+2\xe2\x8b\x85e\xe2\x8b\x85\xe2\x80\xa6\xe2\x8b\x85ai+k\xe2\x8b\x85e is a prime number. A prime number (or a prime) is a natural number greater than 1 that is not a product of two smaller natural numbers." 1400
1609B "William the Vigilant" implementation,strings "Before becoming a successful trader William got a university degree. During his education an interesting situation happened, after which William started to listen to homework assignments much more attentively. What follows is the correct formal description of the homework assignment:You are given a string s of length n only consisting of characters ""a"", ""b"" and ""c"". There are q queries of format (pos,c), meaning replacing the element of string s at position pos with character c. After each query you must output the minimal number of characters in the string, which have to be replaced, so that the string doesn\'t contain string ""abc"" as a substring. A valid replacement of a character is replacing it with ""a"", ""b"" or ""c"".A string x is a substring of a string y if x can be obtained from y by deletion of several (possibly, zero or all) characters from the beginning and several (possibly, zero or all) characters from the end." 1100
1609A "Divide and Multiply" "greedy,implementation,math,number theory" "William has array of n numbers a1,a2,\xe2\x80\xa6,an. He can perform the following sequence of operations any number of times:   Pick any two items from array ai and aj, where ai must be a multiple of 2  ai=ai2  aj=aj\xe2\x8b\x852 Help William find the maximal sum of array elements, which he can get by performing the sequence of operations described above." 900
1608G "Alphabetic Tree" "binary search,data structures,dfs and similar,hashing,string suffix structures,strings,trees" "You are given m strings and a tree on n nodes. Each edge has some letter written on it.You have to answer q queries. Each query is described by 4 integers u, v, l and r. The answer to the query is the total number of occurrences of str(u,v) in strings with indices from l to r. str(u,v) is defined as the string that is made by concatenating letters written on the edges on the shortest path from u to v (in order that they are traversed)." 3500
1608F "MEX counting" combinatorics,dp,implementation "For an array c of nonnegative integers, MEX(c) denotes the smallest nonnegative integer that doesn\'t appear in it. For example, MEX([0,1,3])=2, MEX([42])=0.You are given integers n,k, and an array [b1,b2,\xe2\x80\xa6,bn].Find the number of arrays [a1,a2,\xe2\x80\xa6,an], for which the following conditions hold:0\xe2\x89\xa4ai\xe2\x89\xa4n for each i for each i from 1 to n.|MEX([a1,a2,\xe2\x80\xa6,ai])\xe2\x88\x92bi|\xe2\x89\xa4k for each i from 1 to n.As this number can be very big, output it modulo 998244353." 3200
1608E "The Cells on the Paper" "binary search,implementation,sortings" "On an endless checkered sheet of paper, n cells are chosen and colored in three colors, where n is divisible by 3. It turns out that there are exactly n3 marked cells of each of three colors! Find the largest such k that it\'s possible to choose k3 cells of each color, remove all other marked cells, and then select three rectangles with sides parallel to the grid lines so that the following conditions hold:  No two rectangles can intersect (but they can share a part of the boundary). In other words, the area of intersection of any two of these rectangles must be 0. The i-th rectangle contains all the chosen cells of the i-th color and no chosen cells of other colors, for i=1,2,3." 2800
1608D Dominoes "combinatorics,fft,graphs,math,number theory" "You are given n dominoes. Each domino has a left and a right cell. Each cell can be colored either black or white. Some cells are already colored, while some aren\'t yet.The coloring is said to be valid if and only if it is possible to rearrange the dominoes in some order such that for each 1\xe2\x89\xa4i\xe2\x89\xa4n the color of the right cell of the i-th domino is different from the color of the left cell of the ((imodn)+1)-st domino. Note that you can\'t rotate the dominoes, so the left cell always remains the left cell, and the right cell always remains the right cell.Count the number of valid ways to color the yet uncolored cells of dominoes. Two ways are considered different if there is a cell that is colored white in one way and black in the other. In particular, colorings BW WB and WB BW different (and both invalid).As this number can be very big, output it modulo 998244353." 2400
1608C "Game Master" "data structures,dfs and similar,dp,graphs,greedy,two pointers" "n players are playing a game. There are two different maps in the game. For each player, we know his strength on each map. When two players fight on a specific map, the player with higher strength on that map always wins. No two players have the same strength on the same map. You are the game master and want to organize a tournament. There will be a total of n\xe2\x88\x921 battles. While there is more than one player in the tournament, choose any map and any two remaining players to fight on it. The player who loses will be eliminated from the tournament. In the end, exactly one player will remain, and he is declared the winner of the tournament. For each player determine if he can win the tournament." 1700
1608B "Build the Permutation" "constructive algorithms,greedy" "You are given three integers n,a,b. Determine if there exists a permutation p1,p2,\xe2\x80\xa6,pn of integers from 1 to n, such that:There are exactly a integers i with 2\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921 such that pi\xe2\x88\x921<pi>pi+1 (in other words, there are exactly a local maximums).There are exactly b integers i with 2\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921 such that pi\xe2\x88\x921>pi<pi+1 (in other words, there are exactly b local minimums).If such permutations exist, find any such permutation." 1200
1608A "Find Array" "constructive algorithms,math" "Given n, find any array a1,a2,\xe2\x80\xa6,an of integers such that all of the following conditions hold: 1\xe2\x89\xa4ai\xe2\x89\xa4109 for every i from 1 to n.a1<a2<\xe2\x80\xa6<anFor every i from 2 to n, ai isn\'t divisible by ai\xe2\x88\x921It can be shown that such an array always exists under the constraints of the problem." 800
1607H "Banquet Preparations 2" "greedy,sortings,two pointers" "The chef has cooked n dishes yet again: the i-th dish consists of ai grams of fish and bi grams of meat. Banquet organizers consider two dishes i and j equal if ai=aj and bi=bj at the same time.The banquet organizers estimate the variety of n dishes as follows. The variety of a set of dishes is equal to the number of different dishes in it. The less variety is, the better.In order to reduce the variety, a taster was invited. He will eat exactly mi grams of food from each dish. For each dish, the taster determines separately how much fish and how much meat he will eat. The only condition is that he will eat exactly mi grams of the i-th dish in total.Determine how much of what type of food the taster should eat from each dish so that the value of variety is the minimum possible. If there are several correct answers, you may output any of them." 2200
1607G "Banquet Preparations 1" greedy "A known chef has prepared n dishes: the i-th dish consists of ai grams of fish and bi grams of meat. The banquet organizers estimate the balance of n dishes as follows. The balance is equal to the absolute value of the difference between the total mass of fish and the total mass of meat.Technically, the balance equals to |n\xe2\x88\x91i=1ai\xe2\x88\x92n\xe2\x88\x91i=1bi|. The smaller the balance, the better.In order to improve the balance, a taster was invited. He will eat exactly m grams of food from each dish. For each dish, the taster determines separately how much fish and how much meat he will eat. The only condition is that he should eat exactly m grams of each dish in total.Determine how much of what type of food the taster should eat from each dish so that the value of the balance is as minimal as possible. If there are several correct answers, you may choose any of them." 2200
1607F "Robot on the Board 2" "brute force,dfs and similar,graphs,implementation" "The robot is located on a checkered rectangular board of size n\xc3\x97m (n rows, m columns). The rows in the board are numbered from 1 to n from top to bottom, and the columns \xe2\x80\x94 from 1 to m from left to right.The robot is able to move from the current cell to one of the four cells adjacent by side.Each cell has one of the symbols \'L\', \'R\', \'D\' or \'U\' written on it, indicating the direction in which the robot will move when it gets in that cell \xe2\x80\x94 left, right, down or up, respectively.The robot can start its movement in any cell. He then moves to the adjacent square in the direction indicated on the current square in one move.   If the robot moves beyond the edge of the board, it falls and breaks.  If the robot appears in the cell it already visited before, it breaks (it stops and doesn\'t move anymore). Robot can choose any cell as the starting cell. Its goal is to make the maximum number of steps before it breaks or stops.Determine from which square the robot should start its movement in order to execute as many commands as possible. A command is considered successfully completed if the robot has moved from the square on which that command was written (it does not matter whether to another square or beyond the edge of the board)." 2300
1607E "Robot on the Board 1" implementation "The robot is located on a checkered rectangular board of size n\xc3\x97m (n rows, m columns). The rows in the board are numbered from 1 to n from top to bottom, and the columns \xe2\x80\x94 from 1 to m from left to right.The robot is able to move from the current cell to one of the four cells adjacent by side.The sequence of commands s executed by the robot is given. Each command is denoted by one of the symbols \'L\', \'R\', \'D\' or \'U\', and triggers the movement to left, right, down or up, respectively.The robot can start its movement in any cell. The robot executes the commands starting from the first one, strictly in the order in which they are listed in s. If the robot moves beyond the edge of the board, it falls and breaks. A command that causes the robot to break is not considered successfully executed.The robot\'s task is to execute as many commands as possible without falling off the board. For example, on board 3\xc3\x973, if the robot starts a sequence of actions s=""RRDLUU"" (""right"", ""right"", ""down"", ""left"", ""up"", ""up"") from the central cell, the robot will perform one command, then the next command will force him to cross the edge. If the robot starts moving from the cell (2,1) (second row, first column) then all commands will be executed successfully and the robot will stop at the cell (1,2) (first row, second column).  The robot starts from cell (2,1) (second row, first column). It moves right, right, down, left, up, and up. In this case it ends in the cell (1,2) (first row, second column). Determine the cell from which the robot should start its movement in order to execute as many commands as possible." 1600
1607D "Blue-Red Permutation" greedy,math,sortings "You are given an array of integers a of length n. The elements of the array can be either different or the same. Each element of the array is colored either blue or red. There are no unpainted elements in the array. One of the two operations described below can be applied to an array in a single step:  either you can select any blue element and decrease its value by 1;  or you can select any red element and increase its value by 1. Situations in which there are no elements of some color at all are also possible. For example, if the whole array is colored blue or red, one of the operations becomes unavailable.Determine whether it is possible to make 0 or more steps such that the resulting array is a permutation of numbers from 1 to n?In other words, check whether there exists a sequence of steps (possibly empty) such that after applying it, the array a contains in some order all numbers from 1 to n (inclusive), each exactly once." 1300
1607C "Minimum Extraction" "brute force,sortings" "Yelisey has an array a of n integers.If a has length strictly greater than 1, then Yelisei can apply an operation called minimum extraction to it:   First, Yelisei finds the minimal number m in the array. If there are several identical minima, Yelisey can choose any of them.  Then the selected minimal element is removed from the array. After that, m is subtracted from each remaining element. Thus, after each operation, the length of the array is reduced by 1.For example, if a=[1,6,\xe2\x88\x924,\xe2\x88\x922,\xe2\x88\x924], then the minimum element in it is a3=\xe2\x88\x924, which means that after this operation the array will be equal to a=[1\xe2\x88\x92(\xe2\x88\x924),6\xe2\x88\x92(\xe2\x88\x924),\xe2\x88\x922\xe2\x88\x92(\xe2\x88\x924),\xe2\x88\x924\xe2\x88\x92(\xe2\x88\x924)]=[5,10,2,0].Since Yelisey likes big numbers, he wants the numbers in the array a to be as big as possible.Formally speaking, he wants to make the minimum of the numbers in array a to be maximal possible (i.e. he want to maximize a minimum). To do this, Yelisey can apply the minimum extraction operation to the array as many times as he wants (possibly, zero). Note that the operation cannot be applied to an array of length 1.Help him find what maximal value can the minimal element of the array have after applying several (possibly, zero) minimum extraction operations to the array." 1000
1607B "Odd Grasshopper" math "The grasshopper is located on the numeric axis at the point with coordinate x0.Having nothing else to do he starts jumping between integer points on the axis. Making a jump from a point with coordinate x with a distance d to the left moves the grasshopper to a point with a coordinate x\xe2\x88\x92d, while jumping to the right moves him to a point with a coordinate x+d.The grasshopper is very fond of positive integers, so for each integer i starting with 1 the following holds: exactly i minutes after the start he makes a jump with a distance of exactly i. So, in the first minutes he jumps by 1, then by 2, and so on.The direction of a jump is determined as follows: if the point where the grasshopper was before the jump has an even coordinate, the grasshopper jumps to the left, otherwise he jumps to the right.For example, if after 18 consecutive jumps he arrives at the point with a coordinate 7, he will jump by a distance of 19 to the right, since 7 is an odd number, and will end up at a point 7+19=26. Since 26 is an even number, the next jump the grasshopper will make to the left by a distance of 20, and it will move him to the point 26\xe2\x88\x9220=6.Find exactly which point the grasshopper will be at after exactly n jumps." 900
1607A "Linear Keyboard" implementation,strings "You are given a keyboard that consists of 26 keys. The keys are arranged sequentially in one row in a certain order. Each key corresponds to a unique lowercase Latin letter.You have to type the word s on this keyboard. It also consists only of lowercase Latin letters.To type a word, you need to type all its letters consecutively one by one. To type each letter you must position your hand exactly over the corresponding key and press it.Moving the hand between the keys takes time which is equal to the absolute value of the difference between positions of these keys (the keys are numbered from left to right). No time is spent on pressing the keys and on placing your hand over the first letter of the word.For example, consider a keyboard where the letters from \'a\' to \'z\' are arranged in consecutive alphabetical order. The letters \'h\', \'e\', \'l\' and \'o\' then are on the positions 8, 5, 12 and 15, respectively. Therefore, it will take |5\xe2\x88\x928|+|12\xe2\x88\x925|+|12\xe2\x88\x9212|+|15\xe2\x88\x9212|=13 units of time to type the word ""hello"". Determine how long it will take to print the word s." 800
1606F "Tree Queries" "brute force,dp,trees" "You are given a tree consisting of n vertices. Recall that a tree is an undirected connected acyclic graph. The given tree is rooted at the vertex 1.You have to process q queries. In each query, you are given a vertex of the tree v and an integer k.To process a query, you may delete any vertices from the tree in any order, except for the root and the vertex v. When a vertex is deleted, its children become the children of its parent. You have to process a query in such a way that maximizes the value of c(v)\xe2\x88\x92m\xe2\x8b\x85k (where c(v) is the resulting number of children of the vertex v, and m is the number of vertices you have deleted). Print the maximum possible value you can obtain.The queries are independent: the changes you make to the tree while processing a query don\'t affect the tree in other queries." 2800
1606E Arena combinatorics,dp,math "There are n heroes fighting in the arena. Initially, the i-th hero has ai health points.The fight in the arena takes place in several rounds. At the beginning of each round, each alive hero deals 1 damage to all other heroes. Hits of all heroes occur simultaneously. Heroes whose health is less than 1 at the end of the round are considered killed.If exactly 1 hero remains alive after a certain round, then he is declared the winner. Otherwise, there is no winner.Your task is to calculate the number of ways to choose the initial health points for each hero ai, where 1\xe2\x89\xa4ai\xe2\x89\xa4x, so that there is no winner of the fight. The number of ways can be very large, so print it modulo 998244353. Two ways are considered different if at least one hero has a different amount of health. For example, [1,2,1] and [2,1,1] are different." 2100
1606D "Red-Blue Matrix" "brute force,constructive algorithms,implementation,sortings" "You are given a matrix, consisting of n rows and m columns. The j-th cell of the i-th row contains an integer aij.First, you have to color each row of the matrix either red or blue in such a way that at least one row is colored red and at least one row is colored blue.Then, you have to choose an integer k (1\xe2\x89\xa4k<m) and cut the colored matrix in such a way that the first k columns become a separate matrix (the left matrix) and the last m\xe2\x88\x92k columns become a separate matrix (the right matrix).The coloring and the cut are called perfect if two properties hold:   every red cell in the left matrix contains an integer greater than every blue cell in the left matrix;  every blue cell in the right matrix contains an integer greater than every red cell in the right matrix. Find any perfect coloring and cut, or report that there are none." 2400
1606C Banknotes "greedy,number theory" "In Berland, n different types of banknotes are used. Banknotes of the i-th type have denomination 10ai burles (burles are the currency used in Berland); the denomination of banknotes of the first type is exactly 1.Let\'s denote f(s) as the minimum number of banknotes required to represent exactly s burles. For example, if the denominations of banknotes used in Berland are 1, 10 and 100, then f(59)=14: 9 banknotes with denomination of 1 burle and 5 banknotes with denomination of 10 burles can be used to represent exactly 9\xe2\x8b\x851+5\xe2\x8b\x8510=59 burles, and there\'s no way to do it with fewer banknotes.For a given integer k, find the minimum positive number of burles s that cannot be represented with k or fewer banknotes (that is, f(s)>k)." 1400
1606B "Update Files" greedy,implementation,math "Berland State University has received a new update for the operating system. Initially it is installed only on the 1-st computer.Update files should be copied to all n computers. The computers are not connected to the internet, so the only way to transfer update files from one computer to another is to copy them using a patch cable (a cable connecting two computers directly). Only one patch cable can be connected to a computer at a time. Thus, from any computer where the update files are installed, they can be copied to some other computer in exactly one hour.Your task is to find the minimum number of hours required to copy the update files to all n computers if there are only k patch cables in Berland State University." 1100
1606A "AB Balance" strings "You are given a string s of length n consisting of characters a and/or b.Let AB(s) be the number of occurrences of string ab in s as a substring. Analogically, BA(s) is the number of occurrences of ba in s as a substring.In one step, you can choose any index i and replace si with character a or b.What is the minimum number of steps you need to make to achieve AB(s)=BA(s)?Reminder:The number of occurrences of string d in s as substring is the number of indices i (1\xe2\x89\xa4i\xe2\x89\xa4|s|\xe2\x88\x92|d|+1) such that substring sisi+1\xe2\x80\xa6si+|d|\xe2\x88\x921 is equal to d. For example, AB(aabbbabaa)=2 since there are two indices i: i=2 where aabbbabaa and i=6 where aabbbabaa." 900
1605F PalindORme combinatorics,dp "An integer array a of length n is said to be a PalindORme if (a1 | a2 | \xe2\x80\xa6 | ai)=(an\xe2\x88\x92i+1 | \xe2\x80\xa6 | an\xe2\x88\x921 | an) for all 1\xe2\x89\xa4i\xe2\x89\xa4n, where | denotes the bitwise OR operation.An integer array a of length n is considered to be good if its elements can be rearranged to form a PalindORme. Formally, array a is good if there exists a permutation p1,p2,\xe2\x80\xa6pn (an array where each integer from 1 to n appears exactly once) for which ap1,ap2,\xe2\x80\xa6apn is a PalindORme.Find the number of good arrays of length n, consisting only of integers in the range [0,2k\xe2\x88\x921], and print it modulo some prime m.Two arrays a1,a2,\xe2\x80\xa6,an and b1,b2,\xe2\x80\xa6,bn are considered to be different if there exists any i (1\xe2\x89\xa4i\xe2\x89\xa4n) such that ai\xe2\x89\xa0bi." 2900
1605E "Array Equalizer" "binary search,greedy,implementation,math,number theory,sortings,two pointers" "Jeevan has two arrays a and b of size n. He is fond of performing weird operations on arrays. This time, he comes up with two types of operations:  Choose any i (1\xe2\x89\xa4i\xe2\x89\xa4n) and increment aj by 1 for every j which is a multiple of i and 1\xe2\x89\xa4j\xe2\x89\xa4n.  Choose any i (1\xe2\x89\xa4i\xe2\x89\xa4n) and decrement aj by 1 for every j which is a multiple of i and 1\xe2\x89\xa4j\xe2\x89\xa4n. He wants to convert array a into an array b using the minimum total number of operations. However, Jeevan seems to have forgotten the value of b1. So he makes some guesses. He will ask you q questions corresponding to his q guesses, the i-th of which is of the form:   If b1=xi, what is the minimum number of operations required to convert a to b? Help him by answering each question." 2400
1605D Treelabeling "bitmasks,constructive algorithms,dfs and similar,games,greedy,implementation,trees" "Eikooc and Sushi play a game.The game is played on a tree having n nodes numbered 1 to n. Recall that a tree having n nodes is an undirected, connected graph with n\xe2\x88\x921 edges.They take turns alternately moving a token on the tree. Eikooc makes the first move, placing the token on any node of her choice. Sushi makes the next move, followed by Eikooc, followed by Sushi, and so on. In each turn after the first, a player must move the token to a node u such that   u is adjacent to the node v the token is currently on  u has not been visited before  u\xe2\x8a\x95v\xe2\x89\xa4min(u,v) Here x\xe2\x8a\x95y denotes the bitwise XOR operation on integers x and y.Both the players play optimally. The player who is unable to make a move loses.The following are examples which demonstrate the rules of the game.     Suppose Eikooc starts the game by placing the token at node 4. Sushi then moves the token to node 6, which is unvisited and adjacent to 4. It also holds that 6\xe2\x8a\x954=2\xe2\x89\xa4min(6,4). In the next turn, Eikooc moves the token to node 5, which is unvisited and adjacent to 6. It holds that 5\xe2\x8a\x956=3\xe2\x89\xa4min(5,6). Sushi has no more moves to play, so she loses.   Suppose Eikooc starts the game by placing the token at node 3. Sushi moves the token to node 2, which is unvisited and adjacent to 3. It also holds that 3\xe2\x8a\x952=1\xe2\x89\xa4min(3,2). Eikooc cannot move the token to node 6 since 6\xe2\x8a\x952=4\xe2\x89\xb0min(6,2). Since Eikooc has no moves to play, she loses. Before the game begins, Eikooc decides to sneakily relabel the nodes of the tree in her favour. Formally, a relabeling is a permutation p of length n (sequence of n integers wherein each integer from 1 to n occurs exactly once) where pi denotes the new numbering of node i.She wants to maximize the number of nodes she can choose in the first turn which will guarantee her a win. Help Eikooc find any relabeling which will help her do so." 2100
1605C "Dominant Character" "brute force,greedy,implementation,strings" "Ashish has a string s of length n containing only characters \'a\', \'b\' and \'c\'.He wants to find the length of the smallest substring, which satisfies the following conditions:   Length of the substring is at least 2  \'a\' occurs strictly more times in this substring than \'b\'  \'a\' occurs strictly more times in this substring than \'c\'  Ashish is busy planning his next Codeforces round. Help him solve the problem.A string a is a substring of a string b if a can be obtained from b by deletion of several (possibly, zero or all) characters from the beginning and several (possibly, zero or all) characters from the end." 1400
1605B "Reverse Sort" greedy,sortings "Ashish has a binary string s of length n that he wants to sort in non-decreasing order.He can perform the following operation:   Choose a subsequence of any length such that its elements are in non-increasing order. Formally, choose any k such that 1\xe2\x89\xa4k\xe2\x89\xa4n and any sequence of k indices 1\xe2\x89\xa4i1<i2<\xe2\x80\xa6<ik\xe2\x89\xa4n such that si1\xe2\x89\xa5si2\xe2\x89\xa5\xe2\x80\xa6\xe2\x89\xa5sik.  Reverse this subsequence in-place. Formally, swap si1 with sik, swap si2 with sik\xe2\x88\x921, \xe2\x80\xa6 and swap si\xe2\x8c\x8ak/2\xe2\x8c\x8b with si\xe2\x8c\x88k/2\xe2\x8c\x89+1 (Here \xe2\x8c\x8ax\xe2\x8c\x8b denotes the largest integer not exceeding x, and \xe2\x8c\x88x\xe2\x8c\x89 denotes the smallest integer not less than x) Find the minimum number of operations required to sort the string in non-decreasing order. It can be proven that it is always possible to sort the given binary string in at most n operations." 1000
1605A "A.M. Deviation" "math,number theory" "A number a2 is said to be the arithmetic mean of two numbers a1 and a3, if the following condition holds: a1+a3=2\xe2\x8b\x85a2. We define an arithmetic mean deviation of three numbers a1, a2 and a3 as follows: d(a1,a2,a3)=|a1+a3\xe2\x88\x922\xe2\x8b\x85a2|.Arithmetic means a lot to Jeevan. He has three numbers a1, a2 and a3 and he wants to minimize the arithmetic mean deviation d(a1,a2,a3). To do so, he can perform the following operation any number of times (possibly zero):  Choose i,j from {1,2,3} such that i\xe2\x89\xa0j and increment ai by 1 and decrement aj by 1 Help Jeevan find out the minimum value of d(a1,a2,a3) that can be obtained after applying the operation any number of times." 800
1604B "XOR Specia-LIS-t" NA "YouKn0wWho has an integer sequence a1,a2,\xe2\x80\xa6an. Now he will split the sequence a into one or more consecutive subarrays so that each element of a belongs to exactly one subarray. Let k be the number of resulting subarrays, and h1,h2,\xe2\x80\xa6,hk be the lengths of the longest increasing subsequences of corresponding subarrays.For example, if we split [2,5,3,1,4,3,2,2,5,1] into [2,5,3,1,4], [3,2,2,5], [1], then h=[3,2,1].YouKn0wWho wonders if it is possible to split the sequence a in such a way that the bitwise XOR of h1,h2,\xe2\x80\xa6,hk is equal to 0. You have to tell whether it is possible.The longest increasing subsequence (LIS) of a sequence b1,b2,\xe2\x80\xa6,bm is the longest sequence of valid indices i1,i2,\xe2\x80\xa6,ik such that i1<i2<\xe2\x80\xa6<ik and bi1<bi2<\xe2\x80\xa6<bik. For example, the LIS of [2,5,3,3,5] is [2,3,5], which has length 3.An array c is a subarray of an array b if c can be obtained from b by deletion of several (possibly, zero or all) elements from the beginning and several (possibly, zero or all) elements from the end." 1100
1604A Era greedy "Shohag has an integer sequence a1,a2,\xe2\x80\xa6,an. He can perform the following operation any number of times (possibly, zero):  Select any positive integer k (it can be different in different operations).  Choose any position in the sequence (possibly the beginning or end of the sequence, or in between any two elements) and insert k into the sequence at this position.  This way, the sequence a changes, and the next operation is performed on this changed sequence. For example, if a=[3,3,4] and he selects k=2, then after the operation he can obtain one of the sequences [2_,3,3,4], [3,2_,3,4], [3,3,2_,4], or [3,3,4,2_].Shohag wants this sequence to satisfy the following condition: for each 1\xe2\x89\xa4i\xe2\x89\xa4|a|, ai\xe2\x89\xa4i. Here, |a| denotes the size of a.Help him to find the minimum number of operations that he has to perform to achieve this goal. We can show that under the constraints of the problem it\'s always possible to achieve this goal in a finite number of operations." 800
1603F "October 18, 2017" combinatorics,dp,implementation,math "It was October 18, 2017. Shohag, a melancholic soul, made a strong determination that he will pursue Competitive Programming seriously, by heart, because he found it fascinating. Fast forward to 4 years, he is happy that he took this road. He is now creating a contest on Codeforces. He found an astounding problem but has no idea how to solve this. Help him to solve the final problem of the round.You are given three integers n, k and x. Find the number, modulo 998244353, of integer sequences a1,a2,\xe2\x80\xa6,an such that the following conditions are satisfied:   0\xe2\x89\xa4ai<2k for each integer i from 1 to n.  There is no non-empty subsequence in a such that the bitwise XOR of the elements of the subsequence is x. A sequence b is a subsequence of a sequence c if b can be obtained from c by deletion of several (possibly, zero or all) elements." 2700
1603E "A Perfect Problem" combinatorics,dp,math "A sequence of integers b1,b2,\xe2\x80\xa6,bm is called good if max(b1,b2,\xe2\x80\xa6,bm)\xe2\x8b\x85min(b1,b2,\xe2\x80\xa6,bm)\xe2\x89\xa5b1+b2+\xe2\x80\xa6+bm.A sequence of integers a1,a2,\xe2\x80\xa6,an is called perfect if every non-empty subsequence of a is good.YouKn0wWho has two integers n and M, M is prime. Help him find the number, modulo M, of perfect sequences a1,a2,\xe2\x80\xa6,an such that 1\xe2\x89\xa4ai\xe2\x89\xa4n+1 for each integer i from 1 to n.A sequence d is a subsequence of a sequence c if d can be obtained from c by deletion of several (possibly, zero or all) elements." 3200
1603D "Artistic Partition" "divide and conquer,dp,number theory" "For two positive integers l and r (l\xe2\x89\xa4r) let c(l,r) denote the number of integer pairs (i,j) such that l\xe2\x89\xa4i\xe2\x89\xa4j\xe2\x89\xa4r and gcd(i,j)\xe2\x89\xa5l. Here, gcd(i,j) is the greatest common divisor (GCD) of integers i and j.YouKn0wWho has two integers n and k where 1\xe2\x89\xa4k\xe2\x89\xa4n. Let f(n,k) denote the minimum of k\xe2\x88\x91i=1c(xi+1,xi+1) over all integer sequences 0=x1<x2<\xe2\x80\xa6<xk<xk+1=n.Help YouKn0wWho find f(n,k)." 3000
1603C "Extreme Extension" "dp,greedy,math,number theory" "For an array b of n integers, the extreme value of this array is the minimum number of times (possibly, zero) the following operation has to be performed to make b non-decreasing:   Select an index i such that 1\xe2\x89\xa4i\xe2\x89\xa4|b|, where |b| is the current length of b.  Replace bi with two elements x and y such that x and y both are positive integers and x+y=bi.  This way, the array b changes and the next operation is performed on this modified array. For example, if b=[2,4,3] and index 2 gets selected, then the possible arrays after this operation are [2,1_,3_,3], [2,2_,2_,3], or [2,3_,1_,3]. And consequently, for this array, this single operation is enough to make it non-decreasing: [2,4,3]\xe2\x86\x92[2,2_,2_,3].It\'s easy to see that every array of positive integers can be made non-decreasing this way.YouKn0wWho has an array a of n integers. Help him find the sum of extreme values of all nonempty subarrays of a modulo 998244353. If a subarray appears in a multiple times, its extreme value should be counted the number of times it appears.An array d is a subarray of an array c if d can be obtained from c by deletion of several (possibly, zero or all) elements from the beginning and several (possibly, zero or all) elements from the end." 2300
1603B "Moderate Modular Mode" "constructive algorithms,math,number theory" "YouKn0wWho has two even integers x and y. Help him to find an integer n such that 1\xe2\x89\xa4n\xe2\x89\xa42\xe2\x8b\x851018 and nmodx=ymodn. Here, amodb denotes the remainder of a after division by b. If there are multiple such integers, output any. It can be shown that such an integer always exists under the given constraints." 1600
1603A "Di-visible Confusion" "constructive algorithms,math,number theory" "YouKn0wWho has an integer sequence a1,a2,\xe2\x80\xa6,an. He will perform the following operation until the sequence becomes empty: select an index i such that 1\xe2\x89\xa4i\xe2\x89\xa4|a| and ai is not divisible by (i+1), and erase this element from the sequence. Here |a| is the length of sequence a at the moment of operation. Note that the sequence a changes and the next operation is performed on this changed sequence.For example, if a=[3,5,4,5], then he can select i=2, because a2=5 is not divisible by i+1=3. After this operation the sequence is [3,4,5].Help YouKn0wWho determine if it is possible to erase the whole sequence using the aforementioned operation." 1300
1602B "Divine Array" "constructive algorithms,implementation" "Black is gifted with a Divine array a consisting of n (1\xe2\x89\xa4n\xe2\x89\xa42000) integers. Each position in a has an initial value. After shouting a curse over the array, it becomes angry and starts an unstoppable transformation.The transformation consists of infinite steps. Array a changes at the i-th step in the following way: for every position j, aj becomes equal to the number of occurrences of aj in a before starting this step.Here is an example to help you understand the process better:  Initial array:2 1 1 4 3 1 2After the 1-st step:2 3 3 1 1 3 2After the 2-nd step:2 3 3 2 2 3 2After the 3-rd step:4 3 3 4 4 3 4...... In the initial array, we had two 2-s, three 1-s, only one 4 and only one 3, so after the first step, each element became equal to the number of its occurrences in the initial array: all twos changed to 2, all ones changed to 3, four changed to 1 and three changed to 1.The transformation steps continue forever.You have to process q queries: in each query, Black is curious to know the value of ax after the k-th step of transformation." 1100
1602A "Two Subsequences" implementation "You are given a string s. You need to find two non-empty strings a and b such that the following conditions are satisfied:  Strings a and b are both subsequences of s.  For each index i, character si of string s must belong to exactly one of strings a or b.  String a is lexicographically minimum possible; string b may be any possible string. Given string s, print any valid a and b.Reminder:A string a (b) is a subsequence of a string s if a (b) can be obtained from s by deletion of several (possibly, zero) elements. For example, ""dores"", ""cf"", and ""for"" are subsequences of ""codeforces"", while ""decor"" and ""fork"" are not.A string x is lexicographically smaller than a string y if and only if one of the following holds:  x is a prefix of y, but x\xe2\x89\xa0y;  in the first position where x and y differ, the string x has a letter that appears earlier in the alphabet than the corresponding letter in y." 800
1601F "Two Sorts" "binary search,dfs and similar,math,meet-in-the-middle" "Integers from 1 to n (inclusive) were sorted lexicographically (considering integers as strings). As a result, array a1,a2,\xe2\x80\xa6,an was obtained.Calculate value of (\xe2\x88\x91ni=1((i\xe2\x88\x92ai)mod998244353))mod109+7.xmody here means the remainder after division x by y. This remainder is always non-negative and doesn\'t exceed y\xe2\x88\x921. For example, 5mod3=2, (\xe2\x88\x921)mod6=5." 3400
1601E "Phys Ed Online" "data structures,dp,greedy" "Students of one unknown college don\'t have PE courses. That\'s why q of them decided to visit a gym nearby by themselves. The gym is open for n days and has a ticket system. At the i-th day, the cost of one ticket is equal to ai. You are free to buy more than one ticket per day.You can activate a ticket purchased at day i either at day i or any day later. Each activated ticket is valid only for k days. In other words, if you activate ticket at day t, it will be valid only at days t,t+1,\xe2\x80\xa6,t+k\xe2\x88\x921. You know that the j-th student wants to visit the gym at each day from lj to rj inclusive. Each student will use the following strategy of visiting the gym at any day i (lj\xe2\x89\xa4i\xe2\x89\xa4rj):  person comes to a desk selling tickets placed near the entrance and buy several tickets with cost ai apiece (possibly, zero tickets);  if the person has at least one activated and still valid ticket, they just go in. Otherwise, they activate one of tickets purchased today or earlier and go in. Note that each student will visit gym only starting lj, so each student has to buy at least one ticket at day lj.Help students to calculate the minimum amount of money they have to spend in order to go to the gym." 2900
1601D "Difficult Mountain" "data structures,dp,greedy,sortings" "A group of n alpinists has just reached the foot of the mountain. The initial difficulty of climbing this mountain can be described as an integer d.Each alpinist can be described by two integers s and a, where s is his skill of climbing mountains and a is his neatness.An alpinist of skill level s is able to climb a mountain of difficulty p only if p\xe2\x89\xa4s. As an alpinist climbs a mountain, they affect the path and thus may change mountain difficulty. Specifically, if an alpinist of neatness a climbs a mountain of difficulty p the difficulty of this mountain becomes max(p,a). Alpinists will climb the mountain one by one. And before the start, they wonder, what is the maximum number of alpinists who will be able to climb the mountain if they choose the right order. As you are the only person in the group who does programming, you are to answer the question.Note that after the order is chosen, each alpinist who can climb the mountain, must climb the mountain at that time." 2700
1601C "Optimal Insertion" "data structures,divide and conquer,dp,greedy,sortings" "You are given two arrays of integers a1,a2,\xe2\x80\xa6,an and b1,b2,\xe2\x80\xa6,bm.You need to insert all elements of b into a in an arbitrary way. As a result you will get an array c1,c2,\xe2\x80\xa6,cn+m of size n+m.Note that you are not allowed to change the order of elements in a, while you can insert elements of b at arbitrary positions. They can be inserted at the beginning, between any elements of a, or at the end. Moreover, elements of b can appear in the resulting array in any order.What is the minimum possible number of inversions in the resulting array c? Recall that an inversion is a pair of indices (i,j) such that i<j and ci>cj." 2300
1601B "Frog Traveler" "data structures,dfs and similar,dp,graphs,shortest paths,two pointers" "Frog Gorf is traveling through Swamp kingdom. Unfortunately, after a poor jump, he fell into a well of n meters depth. Now Gorf is on the bottom of the well and has a long way up.The surface of the well\'s walls vary in quality: somewhere they are slippery, but somewhere have convenient ledges. In other words, if Gorf is on x meters below ground level, then in one jump he can go up on any integer distance from 0 to ax meters inclusive. (Note that Gorf can\'t jump down, only up).Unfortunately, Gorf has to take a break after each jump (including jump on 0 meters). And after jumping up to position x meters below ground level, he\'ll slip exactly bx meters down while resting.Calculate the minimum number of jumps Gorf needs to reach ground level." 1900
1601A "Array Elimination" "bitmasks,greedy,math,number theory" "You are given array a1,a2,\xe2\x80\xa6,an, consisting of non-negative integers.Let\'s define operation of ""elimination"" with integer parameter k (1\xe2\x89\xa4k\xe2\x89\xa4n) as follows:  Choose k distinct array indices 1\xe2\x89\xa4i1<i2<\xe2\x80\xa6<ik\xe2\x89\xa4n.  Calculate x=ai1 & ai2 & \xe2\x80\xa6 & aik, where & denotes the bitwise AND operation (notes section contains formal definition).  Subtract x from each of ai1,ai2,\xe2\x80\xa6,aik; all other elements remain untouched. Find all possible values of k, such that it\'s possible to make all elements of array a equal to 0 using a finite number of elimination operations with parameter k. It can be proven that exists at least one possible k for any array a.Note that you firstly choose k and only after that perform elimination operations with value k you\'ve chosen initially." 1300
1600J "Robot Factory" "bitmasks,dfs and similar" "You have received data from a Bubble bot. You know your task is to make factory facilities, but before you even start, you need to know how big the factory is and how many rooms it has. When you look at the data you see that you have the dimensions of the construction, which is in rectangle shape: N x M. Then in the next N lines you have M numbers. These numbers represent factory tiles and they can go from 0 to 15. Each of these numbers should be looked in its binary form. Because from each number you know on which side the tile has walls. For example number 10 in it\'s binary form is 1010, which means that it has a wall from the North side, it doesn\'t have a wall from the East, it has a wall on the South side and it doesn\'t have a wall on the West side. So it goes North, East, South, West. It is guaranteed that the construction always has walls on it\'s edges. The input will be correct. Your task is to print the size of the rooms from biggest to smallest." 1400
1600F "Party Organization" "brute force,math,probabilities" "On the great island of Baltia, there live N people, numbered from 1 to N. There are exactly M pairs of people that are friends with each other. The people of Baltia want to organize a successful party, but they have very strict rules on what a party is and when the party is successful. On the island of Baltia, a party is a gathering of exactly 5 people. The party is considered to be successful if either all the people at the party are friends with each other (so that they can all talk to each other without having to worry about talking to someone they are not friends with) or no two people at the party are friends with each other (so that everyone can just be on their phones without anyone else bothering them). Please help the people of Baltia organize a successful party or tell them that it\'s impossible to do so." 2300
1600E "Array Game" "games,greedy,two pointers" "Alice and Bob are playing a game. They are given an array A of length N. The array consists of integers. They are building a sequence together. In the beginning, the sequence is empty. In one turn a player can remove a number from the left or right side of the array and append it to the sequence. The rule is that the sequence they are building must be strictly increasing. The winner is the player that makes the last move. Alice is playing first. Given the starting array, under the assumption that they both play optimally, who wins the game?" 1900
1599J "Bob\'s Beautiful Array" "bitmasks,brute force,greedy" "Bob really likes playing with arrays of numbers. That\'s why for his birthday, his friends bought him a really interesting machine \xe2\x80\x93 an array beautifier. The array beautifier takes an array A consisting of N integers, and it outputs a new array B of length N that it constructed based on the array given to it. The array beautifier constructs the new array in the following way: it takes two numbers at different indices from the original array and writes their sum to the end of the new array. It does this step N times - resulting in an output array of length N. During this process, the machine can take the same index multiple times in different steps. Bob was very excited about the gift that his friends gave him, so he put his favorite array in the machine. However, when the machine finished, Bob was not happy with the resulting array. He misses his favorite array very much, and hopes to get it back. Given the array that the machine outputted, help Bob find an array that could be the original array that he put in the machine. Sometimes the machine makes mistakes, so it is possible that no appropriate input array exists for the array it has outputted. In such case, let Bob know that his array is forever lost." 2600
1599I Desert "data structures,graphs" "You are given an undirected graph of N nodes and M edges, E1,E2,\xe2\x80\xa6EM.A connected graph is a cactus if each of it\'s edges belogs to at most one simple cycle. A graph is a desert if each of it\'s connected components is a cactus. Find the number of pairs (L,R), (1\xe2\x89\xa4L\xe2\x89\xa4R\xe2\x89\xa4M) such that, if we delete all the edges except for EL,EL+1,\xe2\x80\xa6ER, the graph is a desert." 2700
1599H "Hidden Fortress" interactive,math "This is an interactive problem!As part of your contribution in the Great Bubble War, you have been tasked with finding the newly built enemy fortress. The world you live in is a giant 109\xc3\x97109 grid, with squares having both coordinates between 1 and 109. You know that the enemy base has the shape of a rectangle, with the sides parallel to the sides of the grid. The people of your world are extremely scared of being at the edge of the world, so you know that the base doesn\'t contain any of the squares on the edges of the grid (the x or y coordinate being 1 or 109). To help you locate the base, you have been given a device that you can place in any square of the grid, and it will tell you the manhattan distance to the closest square of the base. The manhattan distance from square (a,b) to square (p,q) is calculated as |a\xe2\x88\x92p|+|b\xe2\x88\x92q|. If you try to place the device inside the enemy base, you will be captured by the enemy. Because of this, you need to make sure to never place the device inside the enemy base. Unfortunately, the device is powered by a battery and you can\'t recharge it. This means that you can use the device at most 40 times." 2100
1599G "Shortest path" "brute force,geometry,math,shortest paths" "You are given N points on an infinite plane with the Cartesian coordinate system on it. N\xe2\x88\x921 points lay on one line, and one point isn\'t on that line. You are on point K at the start, and the goal is to visit every point. You can move between any two points in a straight line, and you can revisit points. What is the minimum length of the path?" 2700
1599F Mars hashing "In the year 2420 humans have finally built a colony on Mars thanks to the work of Elon Tusk. There are 109+7 cities arranged in a circle in this colony and none of them are connected yet. Elon Tusk wants to connect some of those cities using only roads of the same size in order to lower the production cost of those roads. Because of that he gave a list on N cites where some cites can appear more than once and Q queries that you need to answer. For the query you need to determine if it is possible to connect all the cities from Li to Ri on that list using only roads of length Di." 2700
1599E "Two Arrays" "data structures,matrices" "You are given two integer arrays of length N, A1 and A2. You are also given Q queries of 4 types: 1 k l r x: set Aki:=min(Aki,x) for each l\xe2\x89\xa4i\xe2\x89\xa4r.2 k l r x: set Aki:=max(Aki,x) for each l\xe2\x89\xa4i\xe2\x89\xa4r.3 k l r x: set Aki:=Aki+x for each l\xe2\x89\xa4i\xe2\x89\xa4r.4 l r: find the (\xe2\x88\x91ri=lF(A1i+A2i))%(109+7) where F(k) is the k-th Fibonacci number (F(0)=0,F(1)=1,F(k)=F(k\xe2\x88\x921)+F(k\xe2\x88\x922)), and x%y denotes the remainder of the division of x by y.You should process these queries and answer each query of the fourth type." 3200
1599D "Bubble Popping" NA "There are N bubbles in a coordinate plane. Bubbles are so tiny that it can be assumed that each bubble is a point (Xi,Yi). Q Bubble Cup finalists plan to play with the bubbles. Each finalist would link to use infinitely long Bubble Cup stick to pop some bubbles. The i-th finalist would like to place the stick in the direction of vector (dxi,dyi), and plays the following game until Ki bubbles are popped. The game starts with finalist placing the stick in the direction of vector (dxi,dyi), and sweeping it from the infinity to the left until it hits some bubble, which is immediately popped. It is guaranteed that only one bubble will be hit in this step. After that the finalist starts rotating the stick in the counter clockwise direction with the center of rotation in point where the previous bubble was popped. When the next bubble is hit, it is immediately popped and becomes the new center of rotation. The process continues until Ki bubbles have been popped. It is guaranteed that the stick won\'t hit two bubbles simultaneously in this process. For each finalist find which bubble would be popped the last. Note that each game starts with the configuration of all N bubbles, so the games don\'t depend on the previous games." 3200
1599C "Bubble Strike" "combinatorics,math,probabilities,ternary search" "Little Johnny Bubbles enjoys spending hours in front of his computer playing video games. His favorite game is Bubble Strike, fast-paced bubble shooting online game for two players.Each game is set in one of the N maps, each having different terrain configuration. First phase of each game decides on which map the game will be played. The game system randomly selects three maps and shows them to the players. Each player must pick one of those three maps to be discarded. The game system then randomly selects one of the maps that were not picked by any of the players and starts the game.Johnny is deeply enthusiastic about the game and wants to spend some time studying maps, thus increasing chances to win games played on those maps. However, he also needs to do his homework, so he does not have time to study all the maps. That is why he asked himself the following question: ""What is the minimum number of maps I have to study, so that the probability to play one of those maps is at least P""?Can you help Johnny find the answer for this question? You can assume Johnny\'s opponents do not know him, and they will randomly pick maps." 2000
1599B "Restaurant Game" NA "Alice and Bob always had hard time choosing restaurant for the dinner. Previously they performed Eenie Meenie Miney Mo game, but eventually as their restaurant list grew, they had to create a new game. This new game starts as they write restaurant names on N cards and align the cards in one line. Before the game begins, they both choose starting card and starting direction they are going to. They take turns in order one after another. After each turn, they move one card in their current direction. If they reach the end or beginning of the line of cards they change direction. Once they meet in a card, the card is marked for removal and is removed the first moment they both leave the card.  Example of how card is removed They repeat this process until there is only one restaurant card left. Since there are a lot of restaurant cards, they are bored to simulate this process over and over and need your help to determine the last card that remains. Can you help them?" 3100
1599A Weights "constructive algorithms,greedy,two pointers" "You are given an array A of length N weights of masses A1, A2...AN.\xe2\x80\xafNo two weights have the same mass. You can put every weight on one side of the balance (left or right).\xe2\x80\xafYou\xe2\x80\xafdon\'t have to put\xe2\x80\xafweights\xe2\x80\xafin order A1,...,AN.\xe2\x80\xafThere is also a\xe2\x80\xafstring S\xe2\x80\xafconsisting of characters ""L"" and ""R"",\xe2\x80\xafmeaning that after putting the\xe2\x80\xafi\xe2\x88\x92th\xe2\x80\xafweight (not Ai, but\xe2\x80\xafi\xe2\x88\x92th\xe2\x80\xafweight of your choice) left or right side of the balance should be heavier. Find the order of putting the weights on the balance such that rules of string S are satisfied.\xe2\x80\xaf" 2600
1598G "The Sum of Good Numbers" "hashing,math,string suffix structures,strings" "Let\'s call a positive integer good if there is no digit 0 in its decimal representation.For an array of a good numbers a, one found out that the sum of some two neighboring elements is equal to x (i.e. x=ai+ai+1 for some i). x had turned out to be a good number as well.Then the elements of the array a were written out one after another without separators into one string s. For example, if a=[12,5,6,133], then s=1256133.You are given a string s and a number x. Your task is to determine the positions in the string that correspond to the adjacent elements of the array that have sum x. If there are several possible answers, you can print any of them." 3200
1598F RBS "binary search,bitmasks,brute force,data structures,dp" "A bracket sequence is a string containing only characters ""("" and "")"". A regular bracket sequence (or, shortly, an RBS) is a bracket sequence that can be transformed into a correct arithmetic expression by inserting characters ""1"" and ""+"" between the original characters of the sequence. For example:  bracket sequences ""()()"" and ""(())"" are regular (the resulting expressions are: ""(1)+(1)"" and ""((1+1)+1)"");  bracket sequences "")("", ""("" and "")"" are not. Let\'s denote the concatenation of two strings x and y as x+y. For example, ""()()"" + "")("" = ""()())("".You are given n bracket sequences s1,s2,\xe2\x80\xa6,sn. You can rearrange them in any order (you can rearrange only the strings themselves, but not the characters in them).Your task is to rearrange the strings in such a way that the string s1+s2+\xe2\x8b\xaf+sn has as many non-empty prefixes that are RBS as possible." 2400
1598E Staircases "brute force,combinatorics,data structures,dfs and similar,dp,implementation,math" "You are given a matrix, consisting of n rows and m columns. The rows are numbered top to bottom, the columns are numbered left to right.Each cell of the matrix can be either free or locked.Let\'s call a path in the matrix a staircase if it:   starts and ends in the free cell;  visits only free cells;  has one of the two following structures:   the second cell is 1 to the right from the first one, the third cell is 1 to the bottom from the second one, the fourth cell is 1 to the right from the third one, and so on;  the second cell is 1 to the bottom from the first one, the third cell is 1 to the right from the second one, the fourth cell is 1 to the bottom from the third one, and so on.  In particular, a path, consisting of a single cell, is considered to be a staircase.Here are some examples of staircases:  Initially all the cells of the matrix are free.You have to process q queries, each of them flips the state of a single cell. So, if a cell is currently free, it makes it locked, and if a cell is currently locked, it makes it free.Print the number of different staircases after each query. Two staircases are considered different if there exists such a cell that appears in one path and doesn\'t appear in the other path." 2100
1598D "Training Session" "combinatorics,data structures,geometry,implementation,math" "Monocarp is the coach of the Berland State University programming teams. He decided to compose a problemset for a training session for his teams.Monocarp has n problems that none of his students have seen yet. The i-th problem has a topic ai (an integer from 1 to n) and a difficulty bi (an integer from 1 to n). All problems are different, that is, there are no two tasks that have the same topic and difficulty at the same time.Monocarp decided to select exactly 3 problems from n problems for the problemset. The problems should satisfy at least one of two conditions (possibly, both):  the topics of all three selected problems are different;  the difficulties of all three selected problems are different. Your task is to determine the number of ways to select three problems for the problemset." 1700
1598C "Delete Two Elements" "data structures,dp,implementation,math,two pointers" "Monocarp has got an array a consisting of n integers. Let\'s denote k as the mathematic mean of these elements (note that it\'s possible that k is not an integer). The mathematic mean of an array of n elements is the sum of elements divided by the number of these elements (i.\xe2\x80\x89e. sum divided by n).Monocarp wants to delete exactly two elements from a so that the mathematic mean of the remaining (n\xe2\x88\x922) elements is still equal to k.Your task is to calculate the number of pairs of positions [i,j] (i<j) such that if the elements on these positions are deleted, the mathematic mean of (n\xe2\x88\x922) remaining elements is equal to k (that is, it is equal to the mathematic mean of n elements of the original array a)." 1200
1598B Groups "brute force,implementation" "n students attended the first meeting of the Berland SU programming course (n is even). All students will be divided into two groups. Each group will be attending exactly one lesson each week during one of the five working days (Monday, Tuesday, Wednesday, Thursday and Friday), and the days chosen for the groups must be different. Furthermore, both groups should contain the same number of students.Each student has filled a survey in which they told which days of the week are convenient for them to attend a lesson, and which are not. Your task is to determine if it is possible to choose two different week days to schedule the lessons for the group (the first group will attend the lesson on the first chosen day, the second group will attend the lesson on the second chosen day), and divide the students into two groups, so the groups have equal sizes, and for each student, the chosen lesson day for their group is convenient." 1000
1598A "Computer Game" "brute force,dfs and similar,dp,implementation" "Monocarp is playing a computer game. Now he wants to complete the first level of this game.A level is a rectangular grid of 2 rows and n columns. Monocarp controls a character, which starts in cell (1,1) \xe2\x80\x94 at the intersection of the 1-st row and the 1-st column.Monocarp\'s character can move from one cell to another in one step if the cells are adjacent by side and/or corner. Formally, it is possible to move from cell (x1,y1) to cell (x2,y2) in one step if |x1\xe2\x88\x92x2|\xe2\x89\xa41 and |y1\xe2\x88\x92y2|\xe2\x89\xa41. Obviously, it is prohibited to go outside the grid.There are traps in some cells. If Monocarp\'s character finds himself in such a cell, he dies, and the game ends.To complete a level, Monocarp\'s character should reach cell (2,n) \xe2\x80\x94 at the intersection of row 2 and column n.Help Monocarp determine if it is possible to complete the level." 800
1594F "Ideal Farm" "constructive algorithms,math" "Theofanis decided to visit his uncle\'s farm. There are s animals and n animal pens on the farm. For utility purpose, animal pens are constructed in one row.Uncle told Theofanis that a farm is lucky if you can distribute all animals in all pens in such a way that there are no empty pens and there is at least one continuous segment of pens that has exactly k animals in total.Moreover, a farm is ideal if it\'s lucky for any distribution without empty pens.Neither Theofanis nor his uncle knows if their farm is ideal or not. Can you help them to figure it out?" 2400
1594E2 "Rubik\'s Cube Coloring (hard version)" "brute force,dp,implementation,math,trees" "It is the hard version of the problem. The difference is that in this version, there are nodes with already chosen colors.Theofanis is starving, and he wants to eat his favorite food, sheftalia. However, he should first finish his homework. Can you help him with this problem?You have a perfect binary tree of 2k\xe2\x88\x9212k\xe2\x88\x921 nodes \xe2\x80\x94 a binary tree where all vertices ii from 11 to 2k\xe2\x88\x921\xe2\x88\x9212k\xe2\x88\x921\xe2\x88\x921 have exactly two children: vertices 2i2i and 2i+12i+1. Vertices from 2k\xe2\x88\x9212k\xe2\x88\x921 to 2k\xe2\x88\x9212k\xe2\x88\x921 don\'t have any children. You want to color its vertices with the 66 Rubik\'s cube colors (White, Green, Red, Blue, Orange and Yellow).Let\'s call a coloring good when all edges connect nodes with colors that are neighboring sides in the Rubik\'s cube.  A picture of Rubik\'s cube and its 2D map. More formally:   a white node can not be neighboring with white and yellow nodes;  a yellow node can not be neighboring with white and yellow nodes;  a green node can not be neighboring with green and blue nodes;  a blue node can not be neighboring with green and blue nodes;  a red node can not be neighboring with red and orange nodes;  an orange node can not be neighboring with red and orange nodes; However, there are nn special nodes in the tree, colors of which are already chosen.You want to calculate the number of the good colorings of the binary tree. Two colorings are considered different if at least one node is colored with a different color.The answer may be too large, so output the answer modulo 109+7109+7." 2300
1594E1 "Rubik\'s Cube Coloring (easy version)" combinatorics,math "It is the easy version of the problem. The difference is that in this version, there are no nodes with already chosen colors.Theofanis is starving, and he wants to eat his favorite food, sheftalia. However, he should first finish his homework. Can you help him with this problem?You have a perfect binary tree of 2k\xe2\x88\x921 nodes \xe2\x80\x94 a binary tree where all vertices i from 1 to 2k\xe2\x88\x921\xe2\x88\x921 have exactly two children: vertices 2i and 2i+1. Vertices from 2k\xe2\x88\x921 to 2k\xe2\x88\x921 don\'t have any children. You want to color its vertices with the 6 Rubik\'s cube colors (White, Green, Red, Blue, Orange and Yellow).Let\'s call a coloring good when all edges connect nodes with colors that are neighboring sides in the Rubik\'s cube.  A picture of Rubik\'s cube and its 2D map. More formally:   a white node can not be neighboring with white and yellow nodes;  a yellow node can not be neighboring with white and yellow nodes;  a green node can not be neighboring with green and blue nodes;  a blue node can not be neighboring with green and blue nodes;  a red node can not be neighboring with red and orange nodes;  an orange node can not be neighboring with red and orange nodes; You want to calculate the number of the good colorings of the binary tree. Two colorings are considered different if at least one node is colored with a different color.The answer may be too large, so output the answer modulo 109+7." 1300
1594D "The Number of Imposters" "constructive algorithms,dfs and similar,dp,dsu,graphs" "Theofanis started playing the new online game called ""Among them"". However, he always plays with Cypriot players, and they all have the same name: ""Andreas"" (the most common name in Cyprus).In each game, Theofanis plays with n other players. Since they all have the same name, they are numbered from 1 to n.The players write m comments in the chat. A comment has the structure of ""i j c"" where i and j are two distinct integers and c is a string (1\xe2\x89\xa4i,j\xe2\x89\xa4n; i\xe2\x89\xa0j; c is either imposter or crewmate). The comment means that player i said that player j has the role c.An imposter always lies, and a crewmate always tells the truth. Help Theofanis find the maximum possible number of imposters among all the other Cypriot players, or determine that the comments contradict each other (see the notes for further explanation).Note that each player has exactly one role: either imposter or crewmate." 1700
1594C "Make Them Equal" "brute force,greedy,math,strings" "Theofanis has a string s1s2\xe2\x80\xa6sn and a character c. He wants to make all characters of the string equal to c using the minimum number of operations.In one operation he can choose a number x (1\xe2\x89\xa4x\xe2\x89\xa4n) and for every position i, where i is not divisible by x, replace si with c. Find the minimum number of operations required to make all the characters equal to c and the x-s that he should use in his operations." 1200
1594B "Special Numbers" bitmasks,math "Theofanis really likes sequences of positive integers, thus his teacher (Yeltsa Kcir) gave him a problem about a sequence that consists of only special numbers.Let\'s call a positive number special if it can be written as a sum of different non-negative powers of n. For example, for n=4 number 17 is special, because it can be written as 40+42=1+16=17, but 9 is not.Theofanis asks you to help him find the k-th special number if they are sorted in increasing order. Since this number may be too large, output it modulo 109+7." 1100
1594A "Consecutive Sum Riddle" math "Theofanis has a riddle for you and if you manage to solve it, he will give you a Cypriot snack halloumi for free (Cypriot cheese).You are given an integer n. You need to find two integers l and r such that \xe2\x88\x921018\xe2\x89\xa4l<r\xe2\x89\xa41018 and l+(l+1)+\xe2\x80\xa6+(r\xe2\x88\x921)+r=n." 800
1593G "Changing Brackets" "constructive algorithms,data structures,dp,greedy" "A sequence of round and square brackets is given. You can change the sequence by performing the following operations:  change the direction of a bracket from opening to closing and vice versa without changing the form of the bracket: i.e. you can change \'(\' to \')\' and \')\' to \'(\'; you can change \'[\' to \']\' and \']\' to \'[\'. The operation costs 0 burles. change any square bracket to round bracket having the same direction: i.e. you can change \'[\' to \'(\' but not from \'(\' to \'[\'; similarly, you can change \']\' to \')\' but not from \')\' to \']\'. The operation costs 1 burle. The operations can be performed in any order any number of times.You are given a string s of the length n and q queries of the type ""l r"" where 1\xe2\x89\xa4l<r\xe2\x89\xa4n. For every substring s[l\xe2\x80\xa6r], find the minimum cost to pay to make it a correct bracket sequence. It is guaranteed that the substring s[l\xe2\x80\xa6r] has an even length.The queries must be processed independently, i.e. the changes made in the string for the answer to a question i don\'t affect the queries j (j>i). In other words, for every query, the substring s[l\xe2\x80\xa6r] is given from the initially given string s.A correct bracket sequence is a sequence that can be built according the following rules:  an empty sequence is a correct bracket sequence;  if ""s"" is a correct bracket sequence, the sequences ""(s)"" and ""[s]"" are correct bracket sequences.  if ""s"" and ""t"" are correct bracket sequences, the sequence ""st"" (the concatenation of the sequences) is a correct bracket sequence. E.g. the sequences """", ""(()[])"", ""[()()]()"" and ""(())()"" are correct bracket sequences whereas ""("", ""[(])"" and "")))"" are not." 2200
1593F "Red-Black Number" "dfs and similar,dp,implementation,math,meet-in-the-middle" "It is given a non-negative integer x, the decimal representation of which contains n digits. You need to color each its digit in red or black, so that the number formed by the red digits is divisible by A, and the number formed by the black digits is divisible by B.At least one digit must be colored in each of two colors. Consider, the count of digits colored in red is r and the count of digits colored in black is b. Among all possible colorings of the given number x, you need to output any such that the value of |r\xe2\x88\x92b| is the minimum possible.Note that the number x and the numbers formed by digits of each color, may contain leading zeros.  Example of painting a number for A=3 and B=13 The figure above shows an example of painting the number x=02165 of n=5 digits for A=3 and B=13. The red digits form the number 015, which is divisible by 3, and the black ones \xe2\x80\x94 26, which is divisible by 13. Note that the absolute value of the difference between the counts of red and black digits is 1, it is impossible to achieve a smaller value." 2100
1593E "Gardener and Tree" "brute force,data structures,dfs and similar,greedy,implementation,trees" "A tree is an undirected connected graph in which there are no cycles. This problem is about non-rooted trees. A leaf of a tree is a vertex that is connected to at most one vertex.The gardener Vitaly grew a tree from n vertices. He decided to trim the tree. To do this, he performs a number of operations. In one operation, he removes all leaves of the tree.  Example of a tree. For example, consider the tree shown in the figure above. The figure below shows the result of applying exactly one operation to the tree.  The result of applying the operation ""remove all leaves"" to the tree. Note the special cases of the operation:  applying an operation to an empty tree (of 0 vertices) does not change it;  applying an operation to a tree of one vertex removes this vertex (this vertex is treated as a leaf);  applying an operation to a tree of two vertices removes both vertices (both vertices are treated as leaves). Vitaly applied k operations sequentially to the tree. How many vertices remain?" 1600
1593D2 "Half of Same" "brute force,math,number theory" "This problem is a complicated version of D1, but it has significant differences, so read the whole statement.Polycarp has an array of n (n is even) integers a1,a2,\xe2\x80\xa6,an. Polycarp conceived of a positive integer k. After that, Polycarp began performing the following operations on the array: take an index i (1\xe2\x89\xa4i\xe2\x89\xa4n) and reduce the number ai by k.After Polycarp performed some (possibly zero) number of such operations, it turned out that at least half of the numbers in the array became the same. Find the maximum k at which such a situation is possible, or print \xe2\x88\x921 if such a number can be arbitrarily large." 1900
1593D1 "All are Same" "math,number theory" "This problem is a simplified version of D2, but it has significant differences, so read the whole statement.Polycarp has an array of n (n is even) integers a1,a2,\xe2\x80\xa6,an. Polycarp conceived of a positive integer k. After that, Polycarp began performing the following operations on the array: take an index i (1\xe2\x89\xa4i\xe2\x89\xa4n) and reduce the number ai by k.After Polycarp performed some (possibly zero) number of such operations, it turned out that all numbers in the array became the same. Find the maximum k at which such a situation is possible, or print \xe2\x88\x921 if such a number can be arbitrarily large." 1100
1593C "Save More Mice" "binary search,greedy,greedy" "There are one cat, k mice, and one hole on a coordinate line. The cat is located at the point 0, the hole is located at the point n. All mice are located between the cat and the hole: the i-th mouse is located at the point xi (0<xi<n). At each point, many mice can be located.In one second, the following happens. First, exactly one mouse moves to the right by 1. If the mouse reaches the hole, it hides (i.e. the mouse will not any more move to any point and will not be eaten by the cat). Then (after that the mouse has finished its move) the cat moves to the right by 1. If at the new cat\'s position, some mice are located, the cat eats them (they will not be able to move after that). The actions are performed until any mouse hasn\'t been hidden or isn\'t eaten.In other words, the first move is made by a mouse. If the mouse has reached the hole, it\'s saved. Then the cat makes a move. The cat eats the mice located at the pointed the cat has reached (if the cat has reached the hole, it eats nobody).Each second, you can select a mouse that will make a move. What is the maximum number of mice that can reach the hole without being eaten?" 1000
1593B "Make it Divisible by 25" "dfs and similar,dp,greedy,math,math" "It is given a positive integer n. In 1 move, one can select any single digit and remove it (i.e. one selects some position in the number and removes the digit located at this position). The operation cannot be performed if only one digit remains. If the resulting number contains leading zeroes, they are automatically removed.E.g. if one removes from the number 32925 the 3-rd digit, the resulting number will be 3225. If one removes from the number 20099050 the first digit, the resulting number will be 99050 (the 2 zeroes going next to the first digit are automatically removed).What is the minimum number of steps to get a number such that it is divisible by 25 and positive? It is guaranteed that, for each n occurring in the input, the answer exists. It is guaranteed that the number n has no leading zeros." 900
1593A Elections math "The elections in which three candidates participated have recently ended. The first candidate received a votes, the second one received b votes, the third one received c votes. For each candidate, solve the following problem: how many votes should be added to this candidate so that he wins the election (i.e. the number of votes for this candidate was strictly greater than the number of votes for any other candidate)?Please note that for each candidate it is necessary to solve this problem independently, i.e. the added votes for any candidate do not affect the calculations when getting the answer for the other two candidates." 800
1592F2 "Alice and Recoloring 2" "constructive algorithms,flows,graph matchings,greedy" "The difference between the versions is in the costs of operations. Solution for one version won\'t work for another!Alice has a grid of size n\xc3\x97m, initially all its cells are colored white. The cell on the intersection of i-th row and j-th column is denoted as (i,j). Alice can do the following operations with this grid:Choose any subrectangle containing cell (1,1), and flip the colors of all its cells. (Flipping means changing its color from white to black or from black to white). This operation costs 1 coin.Choose any subrectangle containing cell (n,1), and flip the colors of all its cells. This operation costs 3 coins.Choose any subrectangle containing cell (1,m), and flip the colors of all its cells. This operation costs 4 coins.Choose any subrectangle containing cell (n,m), and flip the colors of all its cells. This operation costs 2 coins. As a reminder, subrectangle is a set of all cells (x,y) with x1\xe2\x89\xa4x\xe2\x89\xa4x2, y1\xe2\x89\xa4y\xe2\x89\xa4y2 for some 1\xe2\x89\xa4x1\xe2\x89\xa4x2\xe2\x89\xa4n, 1\xe2\x89\xa4y1\xe2\x89\xa4y2\xe2\x89\xa4m.Alice wants to obtain her favorite coloring with these operations. What\'s the smallest number of coins that she would have to spend? It can be shown that it\'s always possible to transform the initial grid into any other." 2800
1592F1 "Alice and Recoloring 1" "constructive algorithms,greedy" "The difference between the versions is in the costs of operations. Solution for one version won\'t work for another!Alice has a grid of size n\xc3\x97m, initially all its cells are colored white. The cell on the intersection of i-th row and j-th column is denoted as (i,j). Alice can do the following operations with this grid:Choose any subrectangle containing cell (1,1), and flip the colors of all its cells. (Flipping means changing its color from white to black or from black to white). This operation costs 1 coin.Choose any subrectangle containing cell (n,1), and flip the colors of all its cells. This operation costs 2 coins.Choose any subrectangle containing cell (1,m), and flip the colors of all its cells. This operation costs 4 coins.Choose any subrectangle containing cell (n,m), and flip the colors of all its cells. This operation costs 3 coins. As a reminder, subrectangle is a set of all cells (x,y) with x1\xe2\x89\xa4x\xe2\x89\xa4x2, y1\xe2\x89\xa4y\xe2\x89\xa4y2 for some 1\xe2\x89\xa4x1\xe2\x89\xa4x2\xe2\x89\xa4n, 1\xe2\x89\xa4y1\xe2\x89\xa4y2\xe2\x89\xa4m.Alice wants to obtain her favorite coloring with these operations. What\'s the smallest number of coins that she would have to spend? It can be shown that it\'s always possible to transform the initial grid into any other." 2600
1592E "Bored Bakry" "bitmasks,greedy,math,two pointers" "Bakry got bored of solving problems related to xor, so he asked you to solve this problem for him.You are given an array a of n integers [a1,a2,\xe2\x80\xa6,an].Let\'s call a subarray al,al+1,al+2,\xe2\x80\xa6,ar good if al&al+1&al+2\xe2\x80\xa6&ar>al\xe2\x8a\x95al+1\xe2\x8a\x95al+2\xe2\x80\xa6\xe2\x8a\x95ar, where \xe2\x8a\x95 denotes the bitwise XOR operation and & denotes the bitwise AND operation.Find the length of the longest good subarray of a, or determine that no such subarray exists." 2400
1592D "Hemose in ICPC ?" "binary search,dfs and similar,implementation,interactive,math,number theory,trees" "This is an interactive problem!In the last regional contest Hemose, ZeyadKhattab and YahiaSherif \xe2\x80\x94 members of the team Carpe Diem \xe2\x80\x94 did not qualify to ICPC because of some unknown reasons. Hemose was very sad and had a bad day after the contest, but ZeyadKhattab is very wise and knows Hemose very well, and does not want to see him sad.Zeyad knows that Hemose loves tree problems, so he gave him a tree problem with a very special device.Hemose has a weighted tree with n nodes and n\xe2\x88\x921 edges. Unfortunately, Hemose doesn\'t remember the weights of edges.Let\'s define Dist(u,v) for u\xe2\x89\xa0v as the greatest common divisor of the weights of all edges on the path from node u to node v.Hemose has a special device. Hemose can give the device a set of nodes, and the device will return the largest Dist between any two nodes from the set. More formally, if Hemose gives the device a set S of nodes, the device will return the largest value of Dist(u,v) over all pairs (u,v) with u, v \xe2\x88\x88 S and u\xe2\x89\xa0v.Hemose can use this Device at most 12 times, and wants to find any two distinct nodes a, b, such that Dist(a,b) is maximum possible. Can you help him?" 2300
1592C "Bakry and Partitioning" "bitmasks,constructive algorithms,dfs and similar,dp,graphs,trees" "Bakry faced a problem, but since he\'s lazy to solve it, he asks for your help.You are given a tree of n nodes, the i-th node has value ai assigned to it for each i from 1 to n. As a reminder, a tree on n nodes is a connected graph with n\xe2\x88\x921 edges.You want to delete at least 1, but at most k\xe2\x88\x921 edges from the tree, so that the following condition would hold:For every connected component calculate the bitwise XOR of the values of the nodes in it. Then, these values have to be the same for all connected components.Is it possible to achieve this condition?" 1700
1592B "Hemose Shopping" "constructive algorithms,dsu,math,sortings" "Hemose was shopping with his friends Samez, AhmedZ, AshrafEzz, TheSawan and O_E in Germany. As you know, Hemose and his friends are problem solvers, so they are very clever. Therefore, they will go to all discount markets in Germany.Hemose has an array of n integers. He wants Samez to sort the array in the non-decreasing order. Since it would be a too easy problem for Samez, Hemose allows Samez to use only the following operation:Choose indices i and j such that 1\xe2\x89\xa4i,j\xe2\x89\xa4n, and |i\xe2\x88\x92j|\xe2\x89\xa5x. Then, swap elements ai and aj.Can you tell Samez if there\'s a way to sort the array in the non-decreasing order by using the operation written above some finite number of times (possibly 0)?" 1200
1592A "Gamer Hemose" "binary search,greedy,math,sortings" "One day, Ahmed_Hossam went to Hemose and said ""Let\'s solve a gym contest!"". Hemose didn\'t want to do that, as he was playing Valorant, so he came up with a problem and told it to Ahmed to distract him. Sadly, Ahmed can\'t solve it... Could you help him?There is an Agent in Valorant, and he has n weapons. The i-th weapon has a damage value ai, and the Agent will face an enemy whose health value is H.The Agent will perform one or more moves until the enemy dies.In one move, he will choose a weapon and decrease the enemy\'s health by its damage value. The enemy will die when his health will become less than or equal to 0. However, not everything is so easy: the Agent can\'t choose the same weapon for 2 times in a row.What is the minimum number of times that the Agent will need to use the weapons to kill the enemy?" 800
1588F "Jumping Through the Array" "binary search,data structures,graphs,two pointers" "You are given an array of integers a of size n and a permutation p of size n. There are q queries of three types coming to you:  For given numbers l and r, calculate the sum in array a on the segment from l to r: r\xe2\x88\x91i=lai.  You are given two numbers v and x. Let\'s build a directed graph from the permutation p: it has n vertices and n edges i\xe2\x86\x92pi. Let C be the set of vertices that are reachable from v in this graph. You should add x to all au such that u is in C.  You are given indices i and j. You should swap pi and pj.   The graph corresponding to the permutation [2,3,1,5,4]. Please, process all queries and print answers to queries of type 1." 3500
1586I "Omkar and Mosaic" "combinatorics,constructive algorithms,math" "Omkar is creating a mosaic using colored square tiles, which he places in an n\xc3\x97n grid. When the mosaic is complete, each cell in the grid will have either a glaucous or sinoper tile. However, currently he has only placed tiles in some cells. A completed mosaic will be a mastapeece if and only if each tile is adjacent to exactly 2 tiles of the same color (2 tiles are adjacent if they share a side.) Omkar wants to fill the rest of the tiles so that the mosaic becomes a mastapeece. Now he is wondering, is the way to do this unique, and if it is, what is it?" 3500
1585G Poachers dp,games,graphs,trees "Alice and Bob are two poachers who cut trees in a forest.A forest is a set of zero or more trees. A tree is a connected graph without cycles. A rooted tree has a special vertex called the root. The parent of a node v is the next vertex on the shortest path from v to the root. Children of vertex v are all nodes for which v is the parent. A vertex is a leaf if it has no children.In this problem we define the depth of vertex as number of vertices on the simple path from this vertex to the root. The rank of a tree is the minimum depth among its leaves.Initially there is a forest of rooted trees. Alice and Bob play a game on this forest. They play alternating turns with Alice going first. At the beginning of their turn, the player chooses a tree from the forest. Then the player chooses a positive cutting depth, which should not exceed the rank of the chosen tree. Then the player removes all vertices of that tree whose depth is less that or equal to the cutting depth. All other vertices of the tree form a set of rooted trees with root being the vertex with the smallest depth before the cut. All these trees are included in the game forest and the game continues.A player loses if the forest is empty at the beginning of his move.You are to determine whether Alice wins the game if both players play optimally." 2500
1585F "Non-equal Neighbours" combinatorics,dp,math "You are given an array of n positive integers a1,a2,\xe2\x80\xa6,an. Your task is to calculate the number of arrays of n positive integers b1,b2,\xe2\x80\xa6,bn such that:   1\xe2\x89\xa4bi\xe2\x89\xa4ai for every i (1\xe2\x89\xa4i\xe2\x89\xa4n), and  bi\xe2\x89\xa0bi+1 for every i (1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921). The number of such arrays can be very large, so print it modulo 998244353." 2400
1585E "Frequency Queries" "data structures,dfs and similar,trees" "Petya has a rooted tree with an integer written on each vertex. The vertex 1 is the root. You are to answer some questions about the tree.A tree is a connected graph without cycles. A rooted tree has a special vertex called the root. The parent of a node v is the next vertex on the shortest path from v to the root.Each question is defined by three integers v, l, and k. To get the answer to the question, you need to perform the following steps:   First, write down the sequence of all integers written on the shortest path from the vertex v to the root (including those written in the v and the root).  Count the number of times each integer occurs. Remove all integers with less than l occurrences.  Replace the sequence, removing all duplicates and ordering the elements by the number of occurrences in the original list in increasing order. In case of a tie, you can choose the order of these elements arbitrary.  The answer to the question is the k-th number in the remaining sequence. Note that the answer is not always uniquely determined, because there could be several orderings. Also, it is possible that the length of the sequence on this step is less than k, in this case the answer is \xe2\x88\x921. For example, if the sequence of integers on the path from v to the root is [2,2,1,7,1,1,4,4,4,4], l=2 and k=2, then the answer is 1.Please answer all questions about the tree." 2400
1585D "Yet Another Sorting Problem" "data structures,math" "Petya has an array of integers a1,a2,\xe2\x80\xa6,an. He only likes sorted arrays. Unfortunately, the given array could be arbitrary, so Petya wants to sort it.Petya likes to challenge himself, so he wants to sort array using only 3-cycles. More formally, in one operation he can pick 3 pairwise distinct indices i, j, and k (1\xe2\x89\xa4i,j,k\xe2\x89\xa4n) and apply i\xe2\x86\x92j\xe2\x86\x92k\xe2\x86\x92i cycle to the array a. It simultaneously places ai on position j, aj on position k, and ak on position i, without changing any other element.For example, if a is [10,50,20,30,40,60] and he chooses i=2, j=1, k=5, then the array becomes [50_,40_,20,30,10_,60].Petya can apply arbitrary number of 3-cycles (possibly, zero). You are to determine if Petya can sort his array a, i. e. make it non-decreasing." 1900
1585C "Minimize Distance" greedy "A total of n depots are located on a number line. Depot i lies at the point xi for 1\xe2\x89\xa4i\xe2\x89\xa4n.You are a salesman with n bags of goods, attempting to deliver one bag to each of the n depots. You and the n bags are initially at the origin 0. You can carry up to k bags at a time. You must collect the required number of goods from the origin, deliver them to the respective depots, and then return to the origin to collect your next batch of goods.Calculate the minimum distance you need to cover to deliver all the bags of goods to the depots. You do not have to return to the origin after you have delivered all the bags." 1300
1585B "Array Eversion" greedy "You are given an array a of length n.Let\'s define the eversion operation. Let x=an. Then array a is partitioned into two parts: left and right. The left part contains the elements of a that are not greater than x (\xe2\x89\xa4x). The right part contains the elements of a that are strictly greater than x (>x). The order of elements in each part is kept the same as before the operation, i. e. the partition is stable. Then the array is replaced with the concatenation of the left and the right parts.For example, if the array a is [2,4,1,5,3], the eversion goes like this: [2,4,1,5,3]\xe2\x86\x92[2,1,3],[4,5]\xe2\x86\x92[2,1,3,4,5].We start with the array a and perform eversions on this array. We can prove that after several eversions the array a stops changing. Output the minimum number k such that the array stops changing after k eversions." 900
1585A "Life of a Flower" implementation "Petya has got an interesting flower. Petya is a busy person, so he sometimes forgets to water it. You are given n days from Petya\'s live and you have to determine what happened with his flower in the end.The flower grows as follows:   If the flower isn\'t watered for two days in a row, it dies.  If the flower is watered in the i-th day, it grows by 1 centimeter.  If the flower is watered in the i-th and in the (i\xe2\x88\x921)-th day (i>1), then it grows by 5 centimeters instead of 1.  If the flower is not watered in the i-th day, it does not grow. At the beginning of the 1-st day the flower is 1 centimeter tall. What is its height after n days?" 800
1584G "Eligible Segments" geometry "You are given n distinct points p1,p2,\xe2\x80\xa6,pn on the plane and a positive integer R. Find the number of pairs of indices (i,j) such that 1\xe2\x89\xa4i<j\xe2\x89\xa4n, and for every possible k (1\xe2\x89\xa4k\xe2\x89\xa4n) the distance from the point pk to the segment between points pi and pj is at most R." 3200
1584F "Strange LCS" bitmasks,dp,graphs,greedy,strings "You are given n strings s1,s2,\xe2\x80\xa6,sn, each consisting of lowercase and uppercase English letters. In addition, it\'s guaranteed that each character occurs in each string at most twice. Find the longest common subsequence of these strings.A string t is a subsequence of a string s if t can be obtained from s by deletion of several (possibly, zero or all) symbols." 2600
1584E "Game with Stones" "binary search,data structures,games,greedy" "Bob decided to take a break from calculus homework and designed a game for himself. The game is played on a sequence of piles of stones, which can be described with a sequence of integers s1,\xe2\x80\xa6,sk, where si is the number of stones in the i-th pile. On each turn, Bob picks a pair of non-empty adjacent piles i and i+1 and takes one stone from each. If a pile becomes empty, its adjacent piles do not become adjacent. The game ends when Bob can\'t make turns anymore. Bob considers himself a winner if at the end all piles are empty.We consider a sequence of piles winning if Bob can start with it and win with some sequence of moves.You are given a sequence a1,\xe2\x80\xa6,an, count the number of subsegments of a that describe a winning sequence of piles. In other words find the number of segments [l,r] (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n), such that the sequence al,al+1,\xe2\x80\xa6,ar is winning." 2300
1584D "Guess the Permutation" "binary search,combinatorics,interactive,math" "This is an interactive problem.Jury initially had a sequence a of length n, such that ai=i.The jury chose three integers i, j, k, such that 1\xe2\x89\xa4i<j<k\xe2\x89\xa4n, j\xe2\x88\x92i>1. After that, Jury reversed subsegments [i,j\xe2\x88\x921] and [j,k] of the sequence a.Reversing a subsegment [l,r] of the sequence a means reversing the order of elements al,al+1,\xe2\x80\xa6,ar in the sequence, i. e. al is swapped with ar, al+1 is swapped with ar\xe2\x88\x921, etc.You are given the number n and you should find i, j, k after asking some questions.In one question you can choose two integers l and r (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n) and ask the number of inversions on the subsegment [l,r] of the sequence a. You will be given the number of pairs (i,j) such that l\xe2\x89\xa4i<j\xe2\x89\xa4r, and ai>aj.Find the chosen numbers i, j, k after at most 40 questions.The numbers i, j, and k are fixed before the start of your program and do not depend on your queries." 2000
1584C "Two Arrays" greedy,math,sortings "You are given two arrays of integers a1,a2,\xe2\x80\xa6,an and b1,b2,\xe2\x80\xa6,bn.Let\'s define a transformation of the array a:  Choose any non-negative integer k such that 0\xe2\x89\xa4k\xe2\x89\xa4n.  Choose k distinct array indices 1\xe2\x89\xa4i1<i2<\xe2\x80\xa6<ik\xe2\x89\xa4n.  Add 1 to each of ai1,ai2,\xe2\x80\xa6,aik, all other elements of array a remain unchanged.  Permute the elements of array a in any order. Is it possible to perform some transformation of the array a exactly once, so that the resulting array is equal to b?" 900
1584B "Coloring Rectangles" greedy,math "David was given a red checkered rectangle of size n\xc3\x97m. But he doesn\'t like it. So David cuts the original or any other rectangle piece obtained during the cutting into two new pieces along the grid lines. He can do this operation as many times as he wants.As a result, he will get a set of rectangles. Rectangles 1\xc3\x971 are forbidden.David also knows how to paint the cells blue. He wants each rectangle from the resulting set of pieces to be colored such that any pair of adjacent cells by side (from the same piece) have different colors.What is the minimum number of cells David will have to paint?" 1000
1584A "Mathematical Addition" math "Ivan decided to prepare for the test on solving integer equations. He noticed that all tasks in the test have the following form:  You are given two positive integers u and v, find any pair of integers (not necessarily positive) x, y, such that: xu+yv=x+yu+v.  The solution x=0, y=0 is forbidden, so you should find any solution with (x,y)\xe2\x89\xa0(0,0). Please help Ivan to solve some equations of this form." 800
1583H "Omkar and Tours" "data structures,divide and conquer,sortings,trees" "Omkar is hosting tours of his country, Omkarland! There are n cities in Omkarland, and, rather curiously, there are exactly n\xe2\x88\x921 bidirectional roads connecting the cities to each other. It is guaranteed that you can reach any city from any other city through the road network.Every city has an enjoyment value e. Each road has a capacity c, denoting the maximum number of vehicles that can be on it, and an associated toll t. However, the toll system in Omkarland has an interesting quirk: if a vehicle travels on multiple roads on a single journey, they pay only the highest toll of any single road on which they traveled. (In other words, they pay maxt over all the roads on which they traveled.) If a vehicle traverses no roads, they pay 0 toll.Omkar has decided to host q tour groups. Each tour group consists of v vehicles starting at city x. (Keep in mind that a tour group with v vehicles can travel only on roads with capacity \xe2\x89\xa5v.) Being the tour organizer, Omkar wants his groups to have as much fun as they possibly can, but also must reimburse his groups for the tolls that they have to pay. Thus, for each tour group, Omkar wants to know two things: first, what is the enjoyment value of the city y with maximum enjoyment value that the tour group can reach from their starting city, and second, how much per vehicle will Omkar have to pay to reimburse the entire group for their trip from x to y? (This trip from x to y will always be on the shortest path from x to y.)In the case that there are multiple reachable cities with the maximum enjoyment value, Omkar will let his tour group choose which one they want to go to. Therefore, to prepare for all possible scenarios, he wants to know the amount of money per vehicle that he needs to guarantee that he can reimburse the group regardless of which city they choose." 3300
1583G "Omkar and Time Travel" "data structures,math" "El Psy Kongroo.Omkar is watching Steins;Gate.In Steins;Gate, Okabe Rintarou needs to complete n tasks (1\xe2\x89\xa4n\xe2\x89\xa42\xe2\x8b\x85105). Unfortunately, he doesn\'t know when he needs to complete the tasks.Initially, the time is 0. Time travel will now happen according to the following rules:For each k=1,2,\xe2\x80\xa6,n, Okabe will realize at time bk that he was supposed to complete the k-th task at time ak (ak<bk). When he realizes this, if k-th task was already completed at time ak, Okabe keeps the usual flow of time. Otherwise, he time travels to time ak then immediately completes the task.If Okabe time travels to time ak, all tasks completed after this time will become incomplete again. That is, for every j, if aj>ak, the j-th task will become incomplete, if it was complete (if it was incomplete, nothing will change).Okabe has bad memory, so he can time travel to time ak only immediately after getting to time bk and learning that he was supposed to complete the k-th task at time ak. That is, even if Okabe already had to perform k-th task before, he wouldn\'t remember it before stumbling on the info about this task at time bk again.Please refer to the notes for an example of time travelling.There is a certain set s of tasks such that the first moment that all of the tasks in s are simultaneously completed (regardless of whether any other tasks are currently completed), a funny scene will take place. Omkar loves this scene and wants to know how many times Okabe will time travel before this scene takes place. Find this number modulo 109+7. It can be proven that eventually all n tasks will be completed and so the answer always exists." 3000
1583F "Defender of Childhood Dreams" "bitmasks,constructive algorithms,divide and conquer" "Even if you just leave them be, they will fall to pieces all by themselves. So, someone has to protect them, right?You find yourself playing with Teucer again in the city of Liyue. As you take the eccentric little kid around, you notice something interesting about the structure of the city.Liyue can be represented as a directed graph containing n nodes. Nodes are labeled from 1 to n. There is a directed edge from node a to node b if and only if a<b.A path between nodes a and b is defined as a sequence of edges such that you can start at a, travel along all of these edges in the corresponding direction, and end at b. The length of a path is defined by the number of edges. A rainbow path of length x is defined as a path in the graph such that there exists at least 2 distinct colors among the set of x edges.Teucer\'s favorite number is k. You are curious about the following scenario: If you were to label each edge with a color, what is the minimum number of colors needed to ensure that all paths of length k or longer are rainbow paths?Teucer wants to surprise his older brother with a map of Liyue. He also wants to know a valid coloring of edges that uses the minimum number of colors. Please help him with this task!" 2500
1583E "Moment of Bloom" "constructive algorithms,dfs and similar,graph matchings,graphs,greedy,trees" "She does her utmost to flawlessly carry out a person\'s last rites and preserve the world\'s balance of yin and yang.Hu Tao, being the little prankster she is, has tried to scare you with this graph problem! You are given a connected undirected graph of n nodes with m edges. You also have q queries. Each query consists of two nodes a and b.Initially, all edges in the graph have a weight of 0. For each query, you must choose a simple path starting from a and ending at b. Then you add 1 to every edge along this path. Determine if it\'s possible, after processing all q queries, for all edges in this graph to have an even weight. If so, output the choice of paths for each query. If it is not possible, determine the smallest number of extra queries you could add to make it possible. It can be shown that this number will not exceed 1018 under the given constraints.A simple path is defined as any path that does not visit a node more than once.An edge is said to have an even weight if its value is divisible by 2." 2200
1583D "Omkar and the Meaning of Life" "constructive algorithms,greedy,interactive" "It turns out that the meaning of life is a permutation p1,p2,\xe2\x80\xa6,pn of the integers 1,2,\xe2\x80\xa6,n (2\xe2\x89\xa4n\xe2\x89\xa4100). Omkar, having created all life, knows this permutation, and will allow you to figure it out using some queries.A query consists of an array a1,a2,\xe2\x80\xa6,an of integers between 1 and n. a is not required to be a permutation. Omkar will first compute the pairwise sum of a and p, meaning that he will compute an array s where sj=pj+aj for all j=1,2,\xe2\x80\xa6,n. Then, he will find the smallest index k such that sk occurs more than once in s, and answer with k. If there is no such index k, then he will answer with 0.You can perform at most 2n queries. Figure out the meaning of life p." 1800
1583C "Omkar and Determination" "data structures,dp" "The problem statement looms below, filling you with determination.Consider a grid in which some cells are empty and some cells are filled. Call a cell in this grid exitable if, starting at that cell, you can exit the grid by moving up and left through only empty cells. This includes the cell itself, so all filled in cells are not exitable. Note that you can exit the grid from any leftmost empty cell (cell in the first column) by going left, and from any topmost empty cell (cell in the first row) by going up.Let\'s call a grid determinable if, given only which cells are exitable, we can exactly determine which cells are filled in and which aren\'t.You are given a grid a of dimensions n\xc3\x97m , i. e. a grid with n rows and m columns. You need to answer q queries (1\xe2\x89\xa4q\xe2\x89\xa42\xe2\x8b\x85105). Each query gives two integers x1,x2 (1\xe2\x89\xa4x1\xe2\x89\xa4x2\xe2\x89\xa4m) and asks whether the subgrid of a consisting of the columns x1,x1+1,\xe2\x80\xa6,x2\xe2\x88\x921,x2 is determinable." 1700
1583B "Omkar and Heavenly Tree" "constructive algorithms,trees" "Lord Omkar would like to have a tree with n nodes (3\xe2\x89\xa4n\xe2\x89\xa4105) and has asked his disciples to construct the tree. However, Lord Omkar has created m (1\xe2\x89\xa4m<n) restrictions to ensure that the tree will be as heavenly as possible. A tree with n nodes is an connected undirected graph with n nodes and n\xe2\x88\x921 edges. Note that for any two nodes, there is exactly one simple path between them, where a simple path is a path between two nodes that does not contain any node more than once.Here is an example of a tree:   A restriction consists of 3 pairwise distinct integers, a, b, and c (1\xe2\x89\xa4a,b,c\xe2\x89\xa4n). It signifies that node b cannot lie on the simple path between node a and node c. Can you help Lord Omkar and become his most trusted disciple? You will need to find heavenly trees for multiple sets of restrictions. It can be shown that a heavenly tree will always exist for any set of restrictions under the given constraints." 1200
1583A "Windblume Ode" "math,number theory" "A bow adorned with nameless flowers that bears the earnest hopes of an equally nameless person.You have obtained the elegant bow known as the Windblume Ode. Inscribed in the weapon is an array of n (n\xe2\x89\xa53) positive distinct integers (i.e. different, no duplicates are allowed).Find the largest subset (i.e. having the maximum number of elements) of this array such that its sum is a composite number. A positive integer x is called composite if there exists a positive integer y such that 1<y<x and x is divisible by y.If there are multiple subsets with this largest size with the composite sum, you can output any of them. It can be proven that under the constraints of the problem such a non-empty subset always exists." 800
1582G "Kuzya and Homework" "data structures,number theory" "Kuzya started going to school. He was given math homework in which he was given an array a of length n and an array of symbols b of length n, consisting of symbols \'*\' and \'/\'.Let\'s denote a path of calculations for a segment [l;r] (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n) in the following way:   Let x=1 initially. For every i from l to r we will consequently do the following: if bi= \'*\', x=x\xe2\x88\x97ai, and if bi= \'/\', then x=xai. Let\'s call a path of calculations for the segment [l;r] a list of all x that we got during the calculations (the number of them is exactly r\xe2\x88\x92l+1). For example, let a=[7, 12, 3, 5, 4, 10, 9], b=[/, \xe2\x88\x97, /, /, /, \xe2\x88\x97, \xe2\x88\x97], l=2, r=6, then the path of calculations for that segment is [12, 4, 0.8, 0.2, 2].Let\'s call a segment [l;r] simple if the path of calculations for it contains only integer numbers. Kuzya needs to find the number of simple segments [l;r] (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n). Since he obviously has no time and no interest to do the calculations for each option, he asked you to write a program to get to find that number!" 2600
1582F2 "Korney Korneevich and XOR (hard version)" "binary search,brute force,dp,greedy,two pointers" "This is a harder version of the problem with bigger constraints.Korney Korneevich dag up an array a of length n. Korney Korneevich has recently read about the operation bitwise XOR, so he wished to experiment with it. For this purpose, he decided to find all integers x\xe2\x89\xa50 such that there exists an increasing subsequence of the array a, in which the bitwise XOR of numbers is equal to x.It didn\'t take a long time for Korney Korneevich to find all such x, and he wants to check his result. That\'s why he asked you to solve this problem!A sequence s is a subsequence of a sequence b if s can be obtained from b by deletion of several (possibly, zero or all) elements.A sequence s1,s2,\xe2\x80\xa6,sm is called increasing if s1<s2<\xe2\x80\xa6<sm." 2400
1582F1 "Korney Korneevich and XOR (easy version)" bitmasks,dp,greedy "This is an easier version of the problem with smaller constraints.Korney Korneevich dag up an array a of length n. Korney Korneevich has recently read about the operation bitwise XOR, so he wished to experiment with it. For this purpose, he decided to find all integers x\xe2\x89\xa50 such that there exists an increasing subsequence of the array a, in which the bitwise XOR of numbers is equal to x.It didn\'t take a long time for Korney Korneevich to find all such x, and he wants to check his result. That\'s why he asked you to solve this problem!A sequence s is a subsequence of a sequence b if s can be obtained from b by deletion of several (possibly, zero or all) elements.A sequence s1,s2,\xe2\x80\xa6,sm is called increasing if s1<s2<\xe2\x80\xa6<sm." 1800
1582E "Pchelyonok and Segments" "binary search,data structures,dp,greedy,math" "Pchelyonok decided to give Mila a gift. Pchelenok has already bought an array a of length n, but gifting an array is too common. Instead of that, he decided to gift Mila the segments of that array!Pchelyonok wants his gift to be beautiful, so he decided to choose k non-overlapping segments of the array [l1,r1], [l2,r2], \xe2\x80\xa6 [lk,rk] such that:  the length of the first segment [l1,r1] is k, the length of the second segment [l2,r2] is k\xe2\x88\x921, \xe2\x80\xa6, the length of the k-th segment [lk,rk] is 1  for each i<j, the i-th segment occurs in the array earlier than the j-th (i.e. ri<lj)  the sums in these segments are strictly increasing (i.e. let sum(l\xe2\x80\xa6r)=r\xe2\x88\x91i=lai \xe2\x80\x94 the sum of numbers in the segment [l,r] of the array, then sum(l1\xe2\x80\xa6r1)<sum(l2\xe2\x80\xa6r2)<\xe2\x80\xa6<sum(lk\xe2\x80\xa6rk)). Pchelenok also wants his gift to be as beautiful as possible, so he asks you to find the maximal value of k such that he can give Mila a gift!" 2000
1582D "Vupsen, Pupsen and 0" "constructive algorithms,math" "Vupsen and Pupsen were gifted an integer array. Since Vupsen doesn\'t like the number 0, he threw away all numbers equal to 0 from the array. As a result, he got an array a of length n.Pupsen, on the contrary, likes the number 0 and he got upset when he saw the array without zeroes. To cheer Pupsen up, Vupsen decided to come up with another array b of length n such that \xe2\x88\x91ni=1ai\xe2\x8b\x85bi=0. Since Vupsen doesn\'t like number 0, the array b must not contain numbers equal to 0. Also, the numbers in that array must not be huge, so the sum of their absolute values cannot exceed 109. Please help Vupsen to find any such array b!" 1600
1582C "Grandma Capa Knits a Scarf" "brute force,data structures,greedy,strings,two pointers" "Grandma Capa has decided to knit a scarf and asked Grandpa Sher to make a pattern for it, a pattern is a string consisting of lowercase English letters. Grandpa Sher wrote a string s of length n.Grandma Capa wants to knit a beautiful scarf, and in her opinion, a beautiful scarf can only be knit from a string that is a palindrome. She wants to change the pattern written by Grandpa Sher, but to avoid offending him, she will choose one lowercase English letter and erase some (at her choice, possibly none or all) occurrences of that letter in string s.She also wants to minimize the number of erased symbols from the pattern. Please help her and find the minimum number of symbols she can erase to make string s a palindrome, or tell her that it\'s impossible. Notice that she can only erase symbols equal to the one letter she chose.A string is a palindrome if it is the same from the left to the right and from the right to the left. For example, the strings \'kek\', \'abacaba\', \'r\' and \'papicipap\' are palindromes, while the strings \'abb\' and \'iq\' are not." 1200
1582B "Luntik and Subsequences" combinatorics,math "Luntik came out for a morning stroll and found an array a of length n. He calculated the sum s of the elements of the array (s=\xe2\x88\x91ni=1ai). Luntik calls a subsequence of the array a nearly full if the sum of the numbers in that subsequence is equal to s\xe2\x88\x921.Luntik really wants to know the number of nearly full subsequences of the array a. But he needs to come home so he asks you to solve that problem!A sequence x is a subsequence of a sequence y if x can be obtained from y by deletion of several (possibly, zero or all) elements." 900
1582A "Luntik and Concerts" math "Luntik has decided to try singing. He has a one-minute songs, b two-minute songs and c three-minute songs. He wants to distribute all songs into two concerts such that every song should be included to exactly one concert.He wants to make the absolute difference of durations of the concerts as small as possible. The duration of the concert is the sum of durations of all songs in that concert.Please help Luntik and find the minimal possible difference in minutes between the concerts durations." 800
1581B "Diameter of Graph" "constructive algorithms,graphs,greedy,math" "CQXYM wants to create a connected undirected graph with n nodes and m edges, and the diameter of the graph must be strictly less than k\xe2\x88\x921. Also, CQXYM doesn\'t want a graph that contains self-loops or multiple edges (i.e. each edge connects two different vertices and between each pair of vertices there is at most one edge).The diameter of a graph is the maximum distance between any two nodes.The distance between two nodes is the minimum number of the edges on the path which endpoints are the two nodes.CQXYM wonders whether it is possible to create such a graph." 1200
1581A "CQXYM Count Permutations" "combinatorics,math,number theory" "CQXYM is counting permutations length of 2n.A permutation is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array) and [1,3,4] is also not a permutation (n=3 but there is 4 in the array).A permutation p(length of 2n) will be counted only if the number of i satisfying pi<pi+1 is no less than n. For example:  Permutation [1,2,3,4] will count, because the number of such i that pi<pi+1 equals 3 (i=1, i=2, i=3). Permutation [3,2,1,4] won\'t count, because the number of such i that pi<pi+1 equals 1 (i=3). CQXYM wants you to help him to count the number of such permutations modulo 1000000007 (109+7).In addition, modulo operation is to get the remainder. For example:  7mod3=1, because 7=3\xe2\x8b\x852+1,  15mod4=3, because 15=4\xe2\x8b\x853+3." 800
1580F "Problems for Codeforces" combinatorics,fft,math "XYMXYM and CQXYM will prepare n problems for Codeforces. The difficulty of the problem i will be an integer ai, where ai\xe2\x89\xa50. The difficulty of the problems must satisfy ai+ai+1<m (1\xe2\x89\xa4i<n), and a1+an<m, where m is a fixed integer. XYMXYM wants to know how many plans of the difficulty of the problems there are modulo 998244353.Two plans of difficulty a and b are different only if there is an integer i (1\xe2\x89\xa4i\xe2\x89\xa4n) satisfying ai\xe2\x89\xa0bi." 3300
1580E "Railway Construction" "brute force,constructive algorithms,data structures,graphs,shortest paths" "Because the railway system in Gensokyo is often congested, as an enthusiastic engineer, Kawasiro Nitori plans to construct more railway to ease the congestion.There are n stations numbered from 1 to n and m two-way railways in Gensokyo. Every two-way railway connects two different stations and has a positive integer length d. No two two-way railways connect the same two stations. Besides, it is possible to travel from any station to any other using those railways. Among these n stations, station 1 is the main station. You can get to any station from any other station using only two-way railways.Because of the technological limitation, Nitori can only construct one-way railways, whose length can be arbitrary positive integer. Constructing a one-way railway from station u will costs wu units of resources, no matter where the railway ends. To ease the congestion, Nitori plans that after construction there are at least two shortest paths from station 1 to any other station, and these two shortest paths do not pass the same station except station 1 and the terminal. Besides, Nitori also does not want to change the distance of the shortest path from station 1 to any other station.Due to various reasons, sometimes the cost of building a new railway will increase uncontrollably. There will be a total of q occurrences of this kind of incident, and the i-th event will add additional amount of xi to the cost of building a new railway from the station ki.To save resources, before all incidents and after each incident, Nitori wants you to help her calculate the minimal cost of railway construction." 3400
1580D Subsequence "brute force,divide and conquer,dp,greedy,trees" "Alice has an integer sequence a of length n and all elements are different. She will choose a subsequence of a of length m, and defines the value of a subsequence ab1,ab2,\xe2\x80\xa6,abm as m\xe2\x88\x91i=1(m\xe2\x8b\x85abi)\xe2\x88\x92m\xe2\x88\x91i=1m\xe2\x88\x91j=1f(min(bi,bj),max(bi,bj)), where f(i,j) denotes min(ai,ai+1,\xe2\x80\xa6,aj).Alice wants you to help her to maximize the value of the subsequence she choose.A sequence s is a subsequence of a sequence t if s can be obtained from t by deletion of several (possibly, zero or all) elements." 2900
1580C "Train Maintenance" "brute force,data structures,implementation" "Kawasiro Nitori is excellent in engineering. Thus she has been appointed to help maintain trains.There are n models of trains, and Nitori\'s department will only have at most one train of each model at any moment. In the beginning, there are no trains, at each of the following m days, one train will be added, or one train will be removed. When a train of model i is added at day t, it works for xi days (day t inclusive), then it is in maintenance for yi days, then in work for xi days again, and so on until it is removed.In order to make management easier, Nitori wants you to help her calculate how many trains are in maintenance in each day.On a day a train is removed, it is not counted as in maintenance." 2200
1580B "Mathematics Curriculum" "brute force,combinatorics,dp,trees" "Let c1,c2,\xe2\x80\xa6,cn be a permutation of integers 1,2,\xe2\x80\xa6,n. Consider all subsegments of this permutation containing an integer x. Given an integer m, we call the integer x good if there are exactly m different values of maximum on these subsegments.Cirno is studying mathematics, and the teacher asks her to count the number of permutations of length n with exactly k good numbers.Unfortunately, Cirno isn\'t good at mathematics, and she can\'t answer this question. Therefore, she asks you for help.Since the answer may be very big, you only need to tell her the number of permutations modulo p.A permutation is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array) and [1,3,4] is also not a permutation (n=3 but there is 4 in the array).A sequence a is a subsegment of a sequence b if a can be obtained from b by deletion of several (possibly, zero or all) elements from the beginning and several (possibly, zero or all) elements from the end." 2600
1580A Portal "brute force,data structures,dp,greedy,implementation" "CQXYM found a rectangle A of size n\xc3\x97m. There are n rows and m columns of blocks. Each block of the rectangle is an obsidian block or empty. CQXYM can change an obsidian block to an empty block or an empty block to an obsidian block in one operation.A rectangle M size of a\xc3\x97b is called a portal if and only if it satisfies the following conditions:  a\xe2\x89\xa55,b\xe2\x89\xa54.  For all 1<x<a, blocks Mx,1 and Mx,b are obsidian blocks.  For all 1<x<b, blocks M1,x and Ma,x are obsidian blocks.  For all 1<x<a,1<y<b, block Mx,y is an empty block.  M1,1,M1,b,Ma,1,Ma,b can be any type.  Note that the there must be a rows and b columns, not b rows and a columns.Note that corners can be any typeCQXYM wants to know the minimum number of operations he needs to make at least one sub-rectangle a portal." 1700
1579G "Minimal Coverage" dp "You are given n lengths of segments that need to be placed on an infinite axis with coordinates.The first segment is placed on the axis so that one of its endpoints lies at the point with coordinate 0. Let\'s call this endpoint the ""start"" of the first segment and let\'s call its ""end"" as that endpoint that is not the start. The ""start"" of each following segment must coincide with the ""end"" of the previous one. Thus, if the length of the next segment is d and the ""end"" of the previous one has the coordinate x, the segment can be placed either on the coordinates [x\xe2\x88\x92d,x], and then the coordinate of its ""end"" is x\xe2\x88\x92d, or on the coordinates [x,x+d], in which case its ""end"" coordinate is x+d.The total coverage of the axis by these segments is defined as their overall union which is basically the set of points covered by at least one of the segments. It\'s easy to show that the coverage will also be a segment on the axis. Determine the minimal possible length of the coverage that can be obtained by placing all the segments on the axis without changing their order." 2200
1579F "Array Stabilization (AND version)" "brute force,graphs,math,number theory,shortest paths" "You are given an array a[0\xe2\x80\xa6n\xe2\x88\x921]=[a0,a1,\xe2\x80\xa6,an\xe2\x88\x921] of zeroes and ones only. Note that in this problem, unlike the others, the array indexes are numbered from zero, not from one.In one step, the array a is replaced by another array of length n according to the following rules:   First, a new array a\xe2\x86\x92d is defined as a cyclic shift of the array a to the right by d cells. The elements of this array can be defined as a\xe2\x86\x92di=a(i+n\xe2\x88\x92d)modn, where (i+n\xe2\x88\x92d)modn is the remainder of integer division of i+n\xe2\x88\x92d by n.  It means that the whole array a\xe2\x86\x92d can be represented as a sequence a\xe2\x86\x92d=[an\xe2\x88\x92d,an\xe2\x88\x92d+1,\xe2\x80\xa6,an\xe2\x88\x921,a0,a1,\xe2\x80\xa6,an\xe2\x88\x92d\xe2\x88\x921]  Then each element of the array ai is replaced by ai&a\xe2\x86\x92di, where & is a logical ""AND"" operator. For example, if a=[0,0,1,1] and d=1, then a\xe2\x86\x92d=[1,0,0,1] and the value of a after the first step will be [0&1,0&0,1&0,1&1], that is [0,0,0,1].The process ends when the array stops changing. For a given array a, determine whether it will consist of only zeros at the end of the process. If yes, also find the number of steps the process will take before it finishes." 1700
1579E2 "Array Optimization by Deque" "data structures,greedy" "In fact, the problems E1 and E2 do not have much in common. You should probably think of them as two separate problems.You are given an integer array a[1\xe2\x80\xa6n]=[a1,a2,\xe2\x80\xa6,an].Let us consider an empty deque (double-ended queue). A deque is a data structure that supports adding elements to both the beginning and the end. So, if there are elements [3,4,4] currently in the deque, adding an element 1 to the beginning will produce the sequence [1,3,4,4], and adding the same element to the end will produce [3,4,4,1].The elements of the array are sequentially added to the initially empty deque, starting with a1 and finishing with an. Before adding each element to the deque, you may choose whether to add it to the beginning or to the end.For example, if we consider an array a=[3,7,5,5], one of the possible sequences of actions looks like this:  1.add 3 to the beginning of the deque:deque has a sequence [3] in it; 2.add 7 to the end of the deque:deque has a sequence [3,7] in it; 3.add 5 to the end of the deque:deque has a sequence [3,7,5] in it; 4.add 5 to the beginning of the deque:deque has a sequence [5,3,7,5] in it;Find the minimal possible number of inversions in the deque after the whole array is processed. An inversion in sequence d is a pair of indices (i,j) such that i<j and di>dj. For example, the array d=[5,3,7,5] has exactly two inversions \xe2\x80\x94 (1,2) and (3,4), since d1=5>3=d2 and d3=7>5=d4." 1700
1579E1 "Permutation Minimization by Deque" "constructive algorithms,greedy,math" "In fact, the problems E1 and E2 do not have much in common. You should probably think of them as two separate problems.A permutation p of size n is given. A permutation of size n is an array of size n in which each integer from 1 to n occurs exactly once. For example, [1,4,3,2] and [4,2,1,3] are correct permutations while [1,2,4] and [1,2,2] are not.Let us consider an empty deque (double-ended queue). A deque is a data structure that supports adding elements to both the beginning and the end. So, if there are elements [1,5,2] currently in the deque, adding an element 4 to the beginning will produce the sequence [4,1,5,2], and adding same element to the end will produce [1,5,2,4].The elements of the permutation are sequentially added to the initially empty deque, starting with p1 and finishing with pn. Before adding each element to the deque, you may choose whether to add it to the beginning or the end.For example, if we consider a permutation p=[3,1,2,4], one of the possible sequences of actions looks like this:  1.add 3 to the end of the deque:deque has a sequence [3] in it; 2.add 1 to the beginning of the deque:deque has a sequence [1,3] in it; 3.add 2 to the end of the deque:deque has a sequence [1,3,2] in it; 4.add 4 to the end of the deque:deque has a sequence [1,3,2,4] in it;Find the lexicographically smallest possible sequence of elements in the deque after the entire permutation has been processed. A sequence [x1,x2,\xe2\x80\xa6,xn] is lexicographically smaller than the sequence [y1,y2,\xe2\x80\xa6,yn] if there exists such i\xe2\x89\xa4n that x1=y1, x2=y2, \xe2\x80\xa6, xi\xe2\x88\x921=yi\xe2\x88\x921 and xi<yi. In other words, if the sequences x and y have some (possibly empty) matching prefix, and the next element of the sequence x is strictly smaller than the corresponding element of the sequence y. For example, the sequence [1,3,2,4] is smaller than the sequence [1,3,4,2] because after the two matching elements [1,3] in the start the first sequence has an element 2 which is smaller than the corresponding element 4 in the second sequence." 1000
1579D "Productive Meeting" "constructive algorithms,graphs,greedy" "An important meeting is to be held and there are exactly n people invited. At any moment, any two people can step back and talk in private. The same two people can talk several (as many as they want) times per meeting.Each person has limited sociability. The sociability of the i-th person is a non-negative integer ai. This means that after exactly ai talks this person leaves the meeting (and does not talk to anyone else anymore). If ai=0, the i-th person leaves the meeting immediately after it starts.A meeting is considered most productive if the maximum possible number of talks took place during it.You are given an array of sociability a, determine which people should talk to each other so that the total number of talks is as large as possible." 1400
1579C Ticks greedy,implementation "Casimir has a rectangular piece of paper with a checkered field of size n\xc3\x97m. Initially, all cells of the field are white.Let us denote the cell with coordinates i vertically and j horizontally by (i,j). The upper left cell will be referred to as (1,1) and the lower right cell as (n,m).Casimir draws ticks of different sizes on the field. A tick of size d (d>0) with its center in cell (i,j) is drawn as follows:   First, the center cell (i,j) is painted black.  Then exactly d cells on the top-left diagonally to the center and exactly d cells on the top-right diagonally to the center are also painted black.  That is all the cells with coordinates (i\xe2\x88\x92h,j\xc2\xb1h) for all h between 0 and d are painted. In particular, a tick consists of 2d+1 black cells. An already painted cell will remain black if painted again. Below you can find an example of the 4\xc3\x979 box, with two ticks of sizes 2 and 3.  You are given a description of a checkered field of size n\xc3\x97m. Casimir claims that this field came about after he drew some (possibly 0) ticks on it. The ticks could be of different sizes, but the size of each tick is at least k (that is, d\xe2\x89\xa5k for all the ticks).Determine whether this field can indeed be obtained by drawing some (possibly none) ticks of sizes d\xe2\x89\xa5k or not." 1500
1579B "Shifting Sort" implementation,sortings "The new generation external memory contains an array of integers a[1\xe2\x80\xa6n]=[a1,a2,\xe2\x80\xa6,an].This type of memory does not support changing the value of an arbitrary element. Instead, it allows you to cut out any segment of the given array, cyclically shift (rotate) it by any offset and insert it back into the same place.Technically, each cyclic shift consists of two consecutive actions:   You may select arbitrary indices l and r (1\xe2\x89\xa4l<r\xe2\x89\xa4n) as the boundaries of the segment.  Then you replace the segment a[l\xe2\x80\xa6r] with it\'s cyclic shift to the left by an arbitrary offset d. The concept of a cyclic shift can be also explained by following relations: the sequence [1,4,1,3] is a cyclic shift of the sequence [3,1,4,1] to the left by the offset 1 and the sequence [4,1,3,1] is a cyclic shift of the sequence [3,1,4,1] to the left by the offset 2. For example, if a=[1,3,2,8,5], then choosing l=2, r=4 and d=2 yields a segment a[2\xe2\x80\xa64]=[3,2,8]. This segment is then shifted by the offset d=2 to the left, and you get a segment [8,3,2] which then takes the place of of the original elements of the segment. In the end you get a=[1,8,3,2,5].Sort the given array a using no more than n cyclic shifts of any of its segments. Note that you don\'t need to minimize the number of cyclic shifts. Any method that requires n or less cyclic shifts will be accepted." 1100
1579A "Casimir\'s String Solitaire" math,strings "Casimir has a string s which consists of capital Latin letters \'A\', \'B\', and \'C\' only. Each turn he can choose to do one of the two following actions:  he can either erase exactly one letter \'A\' and exactly one letter \'B\' from arbitrary places of the string (these letters don\'t have to be adjacent);  or he can erase exactly one letter \'B\' and exactly one letter \'C\' from arbitrary places in the string (these letters don\'t have to be adjacent). Therefore, each turn the length of the string is decreased exactly by 2. All turns are independent so for each turn, Casimir can choose any of two possible actions.For example, with s = ""ABCABC"" he can obtain a string s = ""ACBC"" in one turn (by erasing the first occurrence of \'B\' and the second occurrence of \'A\'). There are also many other options for a turn aside from this particular example.For a given string s determine whether there is a sequence of actions leading to an empty string. In other words, Casimir\'s goal is to erase all letters from the string. Is there a way to do this?" 800
1578M "The Mind" "constructive algorithms,interactive,probabilities" "This is an interactive problem.In this problem, you need to come up with a strategy for a cooperative game. This game is played by two players. Each player receives 5 cards. Each card has a random integer between 1 and 100 on it. It is guaranteed that all numbers on cards are distinct.The goal of the game is to play a card with a minimal number on it out of all 10 cards dealt to the players before any other card. The problem is that each player can only see their own cards and cannot communicate with another player in any way.The game consists of 5 turns. During each turn, players simultaneously make a move. Each player can either play their smallest card or do nothing. If on some turn the smallest card is played, and no other card is played on or before that turn, players win. If two cards are played at the same turn or if after all 5 turns, no card is still played, players lose.Players cannot communicate, so a strategy for the game should only be based on 5 cards that the player has. You can describe a strategy as five numbers 0.0\xe2\x89\xa4pi\xe2\x89\xa41.0,\xe2\x88\x915i=1pi\xe2\x89\xa41, where pi \xe2\x80\x94 the probability of playing the player\'s smallest card in their hand on i-th turn. If you know the cards dealt to the players, and the strategies that players choose, you can compute the probability of winning by a simple formula. You will be given n=1000 randomly generated hands of 5 cards. You need to generate a strategy for each of the hands to maximize the probability of winning. After the judge program receives all n strategies, it generates all possible valid pairs of those hands (pairs which have the same numbers are discarded), and computes a probability of winning based on two strategies provided by your program. To ensure that answers for different hands are independent, you must output a strategy for a hand and flush the standard output before reading information about the next hand.If the average probability of winning a game is more than 85% over all valid pairs of hands, the test is considered passed. This problem contains the sample test and 20 randomly generated tests with n=1000." 2700
1578L Labyrinth "binary search,dsu,greedy" "In a dream, Lucy found herself in a labyrinth. This labyrinth consists of n rooms, connected by m passages (i-th passage is wi cm wide). Each passage can be traversed in both directions. It is guaranteed that it is possible to get from any room to any other room. But this is not an ordinary labyrinth \xe2\x80\x94 each room in this labyrinth contains a magic candy. When Lucy eats this magic candy, she is getting wider. Specifically, if she eats candy from room i she becomes wider by ci cm. Note that she is not obliged to eat candy the first time she visits a particular room, but she can eat each candy only once. Unfortunately, passages in this labyrinth are pretty narrow, so after eating some candy, Lucy can get too wide and will not be able to traverse them \xe2\x80\x94 her width should not be greater than the width of the corresponding passage.Lucy starts her journey in a room number 1. She wants to eat all the candies. After that, she will just wake up, so she does not have to be able to return to the room 1. She realizes that with her current width, she may not be able to do so, so she plans a workout before embarking on her journey. Lucy wants to know if it is possible to start with some positive width and still eat all the candies. If yes, then what is the maximal starting width with which it is possible." 2400
1578K "Kingdom of Islands" "brute force,graphs,implementation" "The Kingdom of Islands consists of p islands. As the king, you rule over the whole kingdom, while each island is ruled over by one or several jarls under your rule. In total, there are n jarls under your jurisdiction.Each island of the kingdom has its own strong traditions, so jarls that rule over the same island support each other and never have conflicts. The downsides of such strength are cultural conflicts between people inhabiting different islands. Thus, two jarls that rule over different islands are in conflict.However, recent years brought a few changes to traditional relations between the jarls. To your knowledge, there are exactly k pairs of jarls such that relationships between two jarls in the pair are different from the traditional. That is, if two jarls of the pair you know rule over the same island, these jarls are in conflict. If they rule over different islands, then they overcome cultural disagreement and there is no conflict between them anymore.As a true responsible king, you are worried about whether the kingdom is close to a major conflict. In order to estimate the current situation, you would like to find the largest possible group of jarls such that every two jarls in the group are in conflict." 2800
1578J "Just Kingdom" "brute force,data structures,dfs and similar" "The Just Kingdom is ruled by a king and his n lords, numbered 1 to n. Each of the lords is a vassal of some overlord, who might be the king himself, or a different lord closer to the king. The king, and all his lords, are just and kind.Each lord has certain needs, which can be expressed as a certain amount of money they need. However, if a lord, or the king, receives any money, they will first split it equally between all their vassals who still have unmet needs. Only if all the needs of all their vassals are met, they will take the money to fulfill their own needs. If there is any money left over, they will return the excess to their overlord (who follows the standard procedure for distributing money).At the beginning of the year, the king receives a certain sum of tax money and proceeds to split it according to the rules above. If the amount of tax money is greater than the total needs of all the lords, the procedure guarantees everybody\'s needs will be fulfilled, and the excess money will be left with the king. However, if there is not enough money, some lords will not have their needs met.For each lord, determine the minimum amount of tax money the king has to receive so that this lord\'s needs are met." 3100
1578I "Interactive Rays" geometry,interactive "This is an interactive problem.Your goal is to find a circle on a plane by shooting rays and getting the distance to the circle as a result. Interactor has three hidden integer parameters that are determined in advance for each test, but which you don\'t know \xe2\x80\x94 xc, yc, and rc. (xc,yc) are coordinates of the circle\'s center and rc is its radius. The absolute values of xc, yc, and rc do not exceed 105, and 1\xe2\x89\xa4rc\xe2\x89\xa4\xe2\x88\x9ax2c+y2c\xe2\x88\x921.You can shoot rays that extend from the origin (0,0) and go via a point (xq,yq) with the integer coordinates you specify. For each ray, you get a distance from the ray to the circle or 0 if the ray intersects the circle." 3300
1578H "Higher Order Functions" implementation,strings "Helen studies functional programming and she is fascinated with a concept of higher order functions \xe2\x80\x94 functions that are taking other functions as parameters. She decides to generalize the concept of the function order and to test it on some examples. For her study, she defines a simple grammar of types. In her grammar, a type non-terminal T is defined as one of the following grammar productions, together with order(T), defining an order of the corresponding type: ""()"" is a unit type, order(""()"")=0. ""("" T "")"" is a parenthesized type, order(""(""T"")"")=order(T). T1 ""->"" T2 is a functional type, order(T1""->""T2)=max(order(T1)+1,order(T2)). The function constructor T1 ""->"" T2 is right-to-left associative, so the type ""()->()->()"" is the same as the type ""()->(()->())"" of a function returning a function, and it has an order of 1. While ""(()->())->()"" is a function that has an order-1 type ""(()->())"" as a parameter, and it has an order of 2.  Helen asks for your help in writing a program that computes an order of the given type." 1700
1578G "Game of Chance" math,probabilities "The King wants to marry off his daughter, and he wants her husband to have the greatest innate luckiness possible. To find such a person he decided to hold a heads-or-tails tournament. If person A with luckiness x and person B with luckiness y play heads-or-tails against each other, person A wins with probability x/(x+y). The tournament has several rounds. Each round some participants are split into pairs. Each pair plays against each other, and the loser leaves the tournament. The participants are numbered from 1 to n. During the first round, a number k (1\xe2\x89\xa4k\xe2\x89\xa4n) is selected such that n\xe2\x88\x92k/2 is a power of 2 (such k always exists and is unique). Only participants numbered from 1 to k take part in the first round. It ensures that in all other rounds the number of participants is the power of 2. During other rounds, all the participants who still have not left the tournament take part. If during some round, participants numbered p1<\xe2\x80\xa6<p2m take part, then they are split into pairs in the following manner: participant p2i\xe2\x88\x921 plays against participant p2i for each i from 1 to m. The rounds are held until only one participant is left. He is declared the winner of the tournament and he will marry the King\'s daughter. The princess can\'t wait to find out who is her future husband. She asked every participant to tell her his luckiness. Assuming they did not lie, she wants to know the probability of each participant winning the tournament. As you are the best friend of the princess, she asks you to help her." 3500
1578F "Framing Pictures" geometry "Life has been discovered on Venus! What is more, the life forms appear to be convex polygons. An international consortium is designing a probe to send to Venus to take pictures, but they need to estimate the bandwidth needed to send back pictures.When the probe takes a picture of a life form and wishes to send it back to Earth, the bandwidth required is proportional to the area of the bounding box (in other words, the smallest axis-aligned rectangle that contains the life-form). The shape and size of the life forms are known, but the orientation relative to the camera is random. You must thus determine the expected (average) area of the bounding box across all orientations." 2900
1578E "Easy Scheduling" implementation,math "Eonathan Eostar decided to learn the magic of multiprocessor systems. He has a full binary tree of tasks with height h. In the beginning, there is only one ready task in the tree \xe2\x80\x94 the task in the root. At each moment of time, p processes choose at most p ready tasks and perform them. After that, tasks whose parents were performed become ready for the next moment of time. Once the task becomes ready, it stays ready until it is performed. You shall calculate the smallest number of time moments the system needs to perform all the tasks." 1200
1578D "Dragon Curve" NA "A dragon curve is a self-similar fractal curve. In this problem, it is a curve that consists of straight-line segments of the same length connected at right angles. A simple way to construct a dragon curve is as follows: take a strip of paper, fold it in half n times in the same direction, then partially unfold it such that the segments are joined at right angles. This is illustrated here:  In this example, a dragon curve of order 3 is constructed. In general, a dragon curve of a higher order will have a dragon curve of a lower order as its prefix. This allows us to define a dragon curve of infinite order, which is the limit of dragon curves of a finite order as the order approaches infinity.Consider four dragon curves of infinite order. Each starts at the origin (the point (0,0)), and the length of each segment is \xe2\x88\x9a2. The first segments of the curves end at the points (1,1), (\xe2\x88\x921,1), (\xe2\x88\x921,\xe2\x88\x921) and (1,\xe2\x88\x921), respectively. The first turn of each curve is left (that is, the second segment of the first curve ends at the point (0,2)). In this case, every segment is a diagonal of an axis-aligned unit square with integer coordinates, and it can be proven that there is exactly one segment passing through every such square.Given a point (x,y), your task is to find on which of the four curves lies the segment passing through the square with the opposite corners at (x,y) and (x+1,y+1), as well as the position of that segment on that curve. The curves are numbered 1 through 4. Curve 1 goes through (1,1), 2 through (\xe2\x88\x921,1), 3 through (\xe2\x88\x921,\xe2\x88\x921), and 4 through (1,\xe2\x88\x921). The segments are numbered starting with 1." 3200
1578C "Cactus Lady and her Cing" NA "Cactus lady loves her cactuses very much. Especially she likes a small cactus named Cing. Cing can be seen as a connected undirected graph in which every vertex lies on at most one simple cycle. Intuitively, a cactus is a generalization of a tree where some cycles are allowed. Multiedges (multiple edges between a pair of vertices) and loops (edges that connect a vertex to itself) are not allowed.She bought a special grid for her special little cactus Cing. This grid can be represented as a graph consisting of two paths of length 400000, u(0,\xe2\x88\x92200000)\xe2\x88\x92u(0,\xe2\x88\x92199999)\xe2\x88\x92\xe2\x80\xa6\xe2\x88\x92u(0,200000) and u(1,\xe2\x88\x92200000)\xe2\x88\x92u(1,\xe2\x88\x92199999)\xe2\x88\x92\xe2\x80\xa6\xe2\x88\x92u(1,200000), connected together by 400001 edges (u(0,i),u(1,i)) for each i. In other words, a grid can be seen as a ladder.  Cactus lady wants to know whether she can embed Cing into this grid, i.e., map each vertex of the cactus onto a separate vertex of the grid while each edge of the cactus will be mapped onto some edge of the grid." 3500
1578B "Building Forest Trails" "data structures,dsu" "There are n villages lying equidistant on a circle in the middle of a thick, impassable forest. From ancient times, it was impossible to move from one village to another, but technical progress has changed a lot. Now, there is a technology to build passable trails in the forest. The building process consists of m events. Each event is either building a trail or querying if two villages are connected. Trails are built as straight lines connecting two villages. After a trail is built, anybody can walk along the trail from one village to another. Moreover, if two trails cross, anybody can turn at the intersection, and if other trails leave a village you have just reached, they can also be used to walk along. So, for example, if villages are numbered 1 to 6 in the order around the circle, and there are trails 1 to 3, 2 to 4, and 4 to 6, then all villages, except the 5-th, are reachable from the 1-st village.Given a list of m events, for each query, find if two given villages are reachable from each other at that moment." 2800
1578A Anti-Tetris "constructive algorithms,graphs,shortest paths" "Let us consider the game ""Sticky Tetris"". In this game, there is a field of n\xc3\x97m squares. Tiles appear on the field and the player can move the tiles. Each tile is a 4-connected set of at most 7 squares.Each new tile appears in any position that fits inside the field, does not intersect any other tile, and the top cell of the tile is at the top row of the field. The player can move the tile left, right, and down, and at any moment the tile must still entirely fit inside the field and must not intersect other tiles. The player can stop the tile at any position at any time. After that, it cannot be moved. Since this is ""Sticky Tetris,"" the tile will not fall once stopped.You are given a final configuration of a ""Sticky Tetris"" game. You need to restore a sequence of steps that leads to that configuration if it exists." 2800
1576A "Communication Routing Challenge" "*special problem" "In optical communication networks, appropriate path planning can improve the utilization of communication resources and bring a smooth communication experience to users. The following figure shows an inter-satellite optical communication network. User messages are sent from one terrestrial base station (nodes 4 to 7) and transmitted through satellites (nodes 0 to 3) in space to another terrestrial base station (nodes 4 to 7).   In the preceding figures, there are communication connections (edges for short) between base stations and satellites and between satellites. The base stations and satellites are referred to as nodes. User messages are transmitted on these edges and referred to as flows. Some users may make video calls with friends, and some users may send short messages to their family members. Therefore, the message traffic (called flow rate) of each user differs. There are many parallel edges (for example, edges 0, 1, and 2) between two nodes, and the capacity of each edge also differs. Larger capacity indicates that more user messages can be transmitted, as well as shorter transmission distance indicates lower latency and better communication quality. Nodes also have their internal structure. As shown below, some edges inside a node cannot communicate with each other because these edges (constrained edge pair) are not fully connected. For example, edge 5 and edge 7 inside node 2 cannot communicate with each other, and therefore flows cannot pass through node 2 by traversing the two unconnected edges.   Now, in the input network, the source node, target node, and required flow rate for each user flow are specified. Because network resources are limited, paths may not be successfully calculated for all user flows. We hope that you can provide a solution with the highest score.Note, that   all edges are undirected, so flows may come in both directions,  edges has both capacity and length (named distance),  several flows may use the same edge,  flows may come through the same edge in opposite directions simultaneously,  for the purpose of this problem, there is no difference between satellites and base stations, so flows may come through several base stations before reaching the destination station.  Constraints   The capacity of each edge is limited. The total rate of all flows carried by an edge cannot exceed the capacity of the edge. The capacity limits the total flows in both directions.   The calculated flow path does not allow loops or cycles.   Due to the hardware limitation inside satellites, the number of flows passing through a node (including source and target node) cannot exceed the site flow limit (SFL) of the node. The value of SFL is 200.   There are multiple parallel edges between two nodes, which may belong to different groups. Links in each group are managed by the same chip on a node, and there is a group flow limit (GFL). The total number of different flows on all the edges in a group cannot exceed the GFL of the group. The value of GFL is 100.   By default, all edges are connected to each other in each node. But there are some constrained edge pairs \xe2\x80\x94 the pairs of edges inside specified nodes that cannot communicate with each other.   You can make no more than 2 submissions on each 5 minutes interval." -999
1575M "Managing Telephone Poles" "data structures,geometry" "Mr. Chanek\'s city can be represented as a plane. He wants to build a housing complex in the city.There are some telephone poles on the plane, which is represented by a grid a of size (n+1)\xc3\x97(m+1). There is a telephone pole at (x,y) if ax,y=1.For each point (x,y), define S(x,y) as the square of the Euclidean distance between the nearest pole and (x,y). Formally, the square of the Euclidean distance between two points (x1,y1) and (x2,y2) is (x2\xe2\x88\x92x1)2+(y2\xe2\x88\x92y1)2.To optimize the building plan, the project supervisor asks you the sum of all S(x,y) for each 0\xe2\x89\xa4x\xe2\x89\xa4n and 0\xe2\x89\xa4y\xe2\x89\xa4m. Help him by finding the value of \xe2\x88\x91nx=0\xe2\x88\x91my=0S(x,y)." 2400
1575L "Longest Array Deconstruction" "data structures,divide and conquer,dp,sortings" "Mr. Chanek gives you a sequence a indexed from 1 to n. Define f(a) as the number of indices where ai=i. You can pick an element from the current sequence and remove it, then concatenate the remaining elements together. For example, if you remove the 3-rd element from the sequence [4,2,3,1], the resulting sequence will be [4,2,1]. You want to remove some elements from a in order to maximize f(a), using zero or more operations. Find the largest possible f(a)." 2100
1575K "Knitting Batik" implementation,math "Mr. Chanek wants to knit a batik, a traditional cloth from Indonesia. The cloth forms a grid a with size n\xc3\x97m. There are k colors, and each cell in the grid can be one of the k colors.Define a sub-rectangle as an ordered pair of two cells ((x1,y1),(x2,y2)), denoting the top-left cell and bottom-right cell (inclusively) of a sub-rectangle in a. Two sub-rectangles ((x1,y1),(x2,y2)) and ((x3,y3),(x4,y4)) have the same pattern if and only if the following holds:   they have the same width (x2\xe2\x88\x92x1=x4\xe2\x88\x92x3);  they have the same height (y2\xe2\x88\x92y1=y4\xe2\x88\x92y3);  for every pair (i,j) where 0\xe2\x89\xa4i\xe2\x89\xa4x2\xe2\x88\x92x1 and 0\xe2\x89\xa4j\xe2\x89\xa4y2\xe2\x88\x92y1, the color of cells (x1+i,y1+j) and (x3+i,y3+j) are equal. Count the number of possible batik color combinations, such that the subrectangles ((ax,ay),(ax+r\xe2\x88\x921,ay+c\xe2\x88\x921)) and ((bx,by),(bx+r\xe2\x88\x921,by+c\xe2\x88\x921)) have the same pattern.Output the answer modulo 109+7." 2200
1575J "Jeopardy of Dropped Balls" "binary search,brute force,dsu,implementation" "Mr. Chanek has a new game called Dropping Balls. Initially, Mr. Chanek has a grid a of size n\xc3\x97mEach cell (x,y) contains an integer ax,y denoting the direction of how the ball will move.  ax,y=1 \xe2\x80\x94 the ball will move to the right (the next cell is (x,y+1));  ax,y=2 \xe2\x80\x94 the ball will move to the bottom (the next cell is (x+1,y));  ax,y=3 \xe2\x80\x94 the ball will move to the left (the next cell is (x,y\xe2\x88\x921)). Every time a ball leaves a cell (x,y), the integer ax,y will change to 2. Mr. Chanek will drop k balls sequentially, each starting from the first row, and on the c1,c2,\xe2\x80\xa6,ck-th (1\xe2\x89\xa4ci\xe2\x89\xa4m) columns.Determine in which column each ball will end up in (position of the ball after leaving the grid)." 1500
1575I "Illusions of the Desert" "data structures,trees" "Chanek Jones is back, helping his long-lost relative Indiana Jones, to find a secret treasure in a maze buried below a desert full of illusions.The map of the labyrinth forms a tree with n rooms numbered from 1 to n and n\xe2\x88\x921 tunnels connecting them such that it is possible to travel between each pair of rooms through several tunnels.The i-th room (1\xe2\x89\xa4i\xe2\x89\xa4n) has ai illusion rate. To go from the x-th room to the y-th room, there must exist a tunnel between x and y, and it takes max(|ax+ay|,|ax\xe2\x88\x92ay|) energy. |z| denotes the absolute value of z.To prevent grave robbers, the maze can change the illusion rate of any room in it. Chanek and Indiana would ask q queries.There are two types of queries to be done:  1 u c \xe2\x80\x94 The illusion rate of the x-th room is changed to c (1\xe2\x89\xa4u\xe2\x89\xa4n, 0\xe2\x89\xa4|c|\xe2\x89\xa4109).  2 u v \xe2\x80\x94 Chanek and Indiana ask you the minimum sum of energy needed to take the secret treasure at room v if they are initially at room u (1\xe2\x89\xa4u,v\xe2\x89\xa4n). Help them, so you can get a portion of the treasure!" 2300
1575H "Holiday Wall Ornaments" dp,strings "The Winter holiday will be here soon. Mr. Chanek wants to decorate his house\'s wall with ornaments. The wall can be represented as a binary string a of length n. His favorite nephew has another binary string b of length m (m\xe2\x89\xa4n).Mr. Chanek\'s nephew loves the non-negative integer k. His nephew wants exactly k occurrences of b as substrings in a. However, Mr. Chanek does not know the value of k. So, for each k (0\xe2\x89\xa4k\xe2\x89\xa4n\xe2\x88\x92m+1), find the minimum number of elements in a that have to be changed such that there are exactly k occurrences of b in a.A string s occurs exactly k times in t if there are exactly k different pairs (p,q) such that we can obtain s by deleting p characters from the beginning and q characters from the end of t." 2200
1575G "GCD Festival" "math,number theory" "Mr. Chanek has an array a of n integers. The prettiness value of a is denoted as:n\xe2\x88\x91i=1n\xe2\x88\x91j=1gcd(ai,aj)\xe2\x8b\x85gcd(i,j)where gcd(x,y) denotes the greatest common divisor (GCD) of integers x and y.In other words, the prettiness value of an array a is the total sum of gcd(ai,aj)\xe2\x8b\x85gcd(i,j) for all pairs (i,j).Help Mr. Chanek find the prettiness value of a, and output the result modulo 109+7!" 2200
1575F "Finding Expected Value" math "Mr. Chanek opened a letter from his fellow, who is currently studying at Singanesia. Here is what it says.Define an array b (0\xe2\x89\xa4bi<k) with n integers. While there exists a pair (i,j) such that bi\xe2\x89\xa0bj, do the following operation:  Randomly pick a number i satisfying 0\xe2\x89\xa4i<n. Note that each number i has a probability of 1n to be picked.  Randomly Pick a number j satisfying 0\xe2\x89\xa4j<k.  Change the value of bi to j. It is possible for bi to be changed to the same value. Denote f(b) as the expected number of operations done to b until all elements of b are equal. You are given two integers n and k, and an array a (\xe2\x88\x921\xe2\x89\xa4ai<k) of n integers. For every index i with ai=\xe2\x88\x921, replace ai with a random number j satisfying 0\xe2\x89\xa4j<k. Let c be the number of occurrences of \xe2\x88\x921 in a. There are kc possibilites of a after the replacement, each with equal probability of being the final array.Find the expected value of f(a) modulo 109+7. Formally, let M=109+7. It can be shown that the answer can be expressed as an irreducible fraction pq, where p and q are integers and q\xe2\x89\xa20(modM). Output the integer equal to p\xe2\x8b\x85q\xe2\x88\x921modM. In other words, output such an integer x that 0\xe2\x89\xa4x<M and x\xe2\x8b\x85q\xe2\x89\xa1p(modM).After reading the letter, Mr. Chanek gave the task to you. Solve it for the sake of their friendship!" 2900
1575E "Eye-Pleasing City Park Tour" "data structures,trees" "There is a city park represented as a tree with n attractions as its vertices and n\xe2\x88\x921 rails as its edges. The i-th attraction has happiness value ai.Each rail has a color. It is either black if ti=0, or white if ti=1. Black trains only operate on a black rail track, and white trains only operate on a white rail track. If you are previously on a black train and want to ride a white train, or you are previously on a white train and want to ride a black train, you need to use 1 ticket.The path of a tour must be a simple path \xe2\x80\x94 it must not visit an attraction more than once. You do not need a ticket the first time you board a train. You only have k tickets, meaning you can only switch train types at most k times. In particular, you do not need a ticket to go through a path consisting of one rail color.Define f(u,v) as the sum of happiness values of the attractions in the tour (u,v), which is a simple path that starts at the u-th attraction and ends at the v-th attraction. Find the sum of f(u,v) for all valid tours (u,v) (1\xe2\x89\xa4u\xe2\x89\xa4v\xe2\x89\xa4n) that does not need more than k tickets, modulo 109+7." 2600
1575D "Divisible by Twenty-Five" "brute force,dfs and similar,dp" "Mr. Chanek has an integer represented by a string s. Zero or more digits have been erased and are denoted by the character _. There are also zero or more digits marked by the character X, meaning they\'re the same digit.Mr. Chanek wants to count the number of possible integer s, where s is divisible by 25. Of course, s must not contain any leading zero. He can replace the character _ with any digit. He can also replace the character X with any digit, but it must be the same for every character X.As a note, a leading zero is any 0 digit that comes before the first nonzero digit in a number string in positional notation. For example, 0025 has two leading zeroes. An exception is the integer zero, (0 has no leading zero, but 0000 has three leading zeroes)." 1800
1575C "Cyclic Sum" "data structures,fft,number theory" "Denote a cyclic sequence of size n as an array s such that sn is adjacent to s1. The segment s[r,l] where l<r is the concatenation of s[r,n] and s[1,l].You are given an array a consisting of n integers. Define b as the cyclic sequence obtained from concatenating m copies of a. Note that b has size n\xe2\x8b\x85m.You are given an integer k where k=1 or k is a prime number. Find the number of different segments in b where the sum of elements in the segment is divisible by k.Two segments are considered different if the set of indices of the segments are different. For example, when n=3 and m=2, the set of indices for segment s[2,5] is {2,3,4,5}, and for segment s[5,2] is {5,6,1,2}. In particular, the segments s[1,6],s[2,1],\xe2\x80\xa6,s[6,5] are considered as the same segment.Output the answer modulo 109+7." 3000
1575B "Building an Amusement Park" "binary search,geometry" "Mr. Chanek lives in a city represented as a plane. He wants to build an amusement park in the shape of a circle of radius r. The circle must touch the origin (point (0,0)).There are n bird habitats that can be a photo spot for the tourists in the park. The i-th bird habitat is at point pi=(xi,yi). Find the minimum radius r of a park with at least k bird habitats inside. A point is considered to be inside the park if and only if the distance between pi and the center of the park is less than or equal to the radius of the park. Note that the center and the radius of the park do not need to be integers.In this problem, it is guaranteed that the given input always has a solution with r\xe2\x89\xa42\xe2\x8b\x85105." 2300
1575A "Another Sorting Problem" "data structures,sortings,strings" "Andi and Budi were given an assignment to tidy up their bookshelf of n books. Each book is represented by the book title \xe2\x80\x94 a string si numbered from 1 to n, each with length m. Andi really wants to sort the book lexicographically ascending, while Budi wants to sort it lexicographically descending.Settling their fight, they decided to combine their idea and sort it asc-desc-endingly, where the odd-indexed characters will be compared ascendingly, and the even-indexed characters will be compared descendingly.A string a occurs before a string b in asc-desc-ending order if and only if in the first position where a and b differ, the following holds:  if it is an odd position, the string a has a letter that appears earlier in the alphabet than the corresponding letter in b;  if it is an even position, the string a has a letter that appears later in the alphabet than the corresponding letter in b." 1100
1574F Occurrences "combinatorics,dfs and similar,dp,dsu,fft,graphs" "A subarray of array a from index l to the index r is the array [al,al+1,\xe2\x80\xa6,ar]. The number of occurrences of the array b in the array a is the number of subarrays of a such that they are equal to b.You are given n arrays A1,A2,\xe2\x80\xa6,An; the elements of these arrays are integers from 1 to k. You have to build an array a consisting of m integers from 1 to k in such a way that, for every given subarray Ai, the number of occurrences of Ai in the array a is not less than the number of occurrences of each non-empty subarray of Ai in a. Note that if Ai doesn\'t occur in a, and no subarray of Ai occurs in a, this condition is still met for Ai.Your task is to calculate the number of different arrays a you can build, and print it modulo 998244353." 2700
1574E Coloring "combinatorics,constructive algorithms,implementation,math" "A matrix of size n\xc3\x97m, such that each cell of it contains either 0 or 1, is considered beautiful if the sum in every contiguous submatrix of size 2\xc3\x972 is exactly 2, i.\xe2\x80\x89e. every ""square"" of size 2\xc3\x972 contains exactly two 1\'s and exactly two 0\'s.You are given a matrix of size n\xc3\x97m. Initially each cell of this matrix is empty. Let\'s denote the cell on the intersection of the x-th row and the y-th column as (x,y). You have to process the queries of three types:  x y \xe2\x88\x921 \xe2\x80\x94 clear the cell (x,y), if there was a number in it;  x y 0 \xe2\x80\x94 write the number 0 in the cell (x,y), overwriting the number that was there previously (if any);  x y 1 \xe2\x80\x94 write the number 1 in the cell (x,y), overwriting the number that was there previously (if any). After each query, print the number of ways to fill the empty cells of the matrix so that the resulting matrix is beautiful. Since the answers can be large, print them modulo 998244353." 2500
1574D "The Strongest Build" "binary search,brute force,data structures,dfs and similar,graphs,greedy,hashing,implementation" "Ivan is playing yet another roguelike computer game. He controls a single hero in the game. The hero has n equipment slots. There is a list of ci items for the i-th slot, the j-th of them increases the hero strength by ai,j. The items for each slot are pairwise distinct and are listed in the increasing order of their strength increase. So, ai,1<ai,2<\xe2\x8b\xaf<ai,ci.For each slot Ivan chooses exactly one item. Let the chosen item for the i-th slot be the bi-th item in the corresponding list. The sequence of choices [b1,b2,\xe2\x80\xa6,bn] is called a build.The strength of a build is the sum of the strength increases of the items in it. Some builds are banned from the game. There is a list of m pairwise distinct banned builds. It\'s guaranteed that there\'s at least one build that\'s not banned.What is the build with the maximum strength that is not banned from the game? If there are multiple builds with maximum strength, print any of them." 2000
1574C "Slay the Dragon" "binary search,greedy,sortings,ternary search" "Recently, Petya learned about a new game ""Slay the Dragon"". As the name suggests, the player will have to fight with dragons. To defeat a dragon, you have to kill it and defend your castle. To do this, the player has a squad of n heroes, the strength of the i-th hero is equal to ai.According to the rules of the game, exactly one hero should go kill the dragon, all the others will defend the castle. If the dragon\'s defense is equal to x, then you have to send a hero with a strength of at least x to kill it. If the dragon\'s attack power is y, then the total strength of the heroes defending the castle should be at least y.The player can increase the strength of any hero by 1 for one gold coin. This operation can be done any number of times.There are m dragons in the game, the i-th of them has defense equal to xi and attack power equal to yi. Petya was wondering what is the minimum number of coins he needs to spend to defeat the i-th dragon.Note that the task is solved independently for each dragon (improvements are not saved)." 1300
1574B "Combinatorics Homework" combinatorics,greedy,math "You are given four integer values a, b, c and m.Check if there exists a string that contains:   a letters \'A\';  b letters \'B\';  c letters \'C\';  no other letters;  exactly m pairs of adjacent equal letters (exactly m such positions i that the i-th letter is equal to the (i+1)-th one)." 1100
1574A "Regular Bracket Sequences" "constructive algorithms" "A bracket sequence is a string containing only characters ""("" and "")"". A regular bracket sequence is a bracket sequence that can be transformed into a correct arithmetic expression by inserting characters ""1"" and ""+"" between the original characters of the sequence. For example, bracket sequences ""()()"" and ""(())"" are regular (the resulting expressions are: ""(1)+(1)"" and ""((1+1)+1)""), and "")("", ""("" and "")"" are not.You are given an integer n. Your goal is to construct and print exactly n different regular bracket sequences of length 2n." 800
1573B Swaps greedy,math,sortings "You are given two arrays a and b of length n. Array a contains each odd integer from 1 to 2n in an arbitrary order, and array b contains each even integer from 1 to 2n in an arbitrary order.You can perform the following operation on those arrays:   choose one of the two arrays  pick an index i from 1 to n\xe2\x88\x921  swap the i-th and the (i+1)-th elements of the chosen array  Compute the minimum number of operations needed to make array a lexicographically smaller than array b.For two different arrays x and y of the same length n, we say that x is lexicographically smaller than y if in the first position where x and y differ, the array x has a smaller element than the corresponding element in y." 1400
1573A Countdown greedy "You are given a digital clock with n digits. Each digit shows an integer from 0 to 9, so the whole clock shows an integer from 0 to 10n\xe2\x88\x921. The clock will show leading zeroes if the number is smaller than 10n\xe2\x88\x921.You want the clock to show 0 with as few operations as possible. In an operation, you can do one of the following:   decrease the number on the clock by 1, or  swap two digits (you can choose which digits to swap, and they don\'t have to be adjacent). Your task is to determine the minimum number of operations needed to make the clock show 0." 800
1572F Stations "data structures" "There are n cities in a row numbered from 1 to n.The cities will be building broadcasting stations. The station in the i-th city has height hi and range wi. It can broadcast information to city j if the following constraints are met:   i\xe2\x89\xa4j\xe2\x89\xa4wi, and  for each k such that i<k\xe2\x89\xa4j, the following condition holds: hk<hi.  In other words, the station in city i can broadcast information to city j if j\xe2\x89\xa5i, j is in the range of i-th station, and i is strictly highest on the range from i to j (including city j).At the beginning, for every city i, hi=0 and wi=i.Then q events will take place. During i-th event one of the following will happen:   City ci will rebuild its station so that its height will be strictly highest among all stations and wci will be set to gi.  Let bj be the number of stations that can broadcast information to city j. Print the sum of bj over all j satisfying li\xe2\x89\xa4j\xe2\x89\xa4ri. Your task is to react to all events and print answers to all queries." 3400
1572E Polygon "binary search,dp,geometry" "You are given a strictly convex polygon with n vertices.You will make k cuts that meet the following conditions:   each cut is a segment that connects two different nonadjacent vertices;  two cuts can intersect only at vertices of the polygon. Your task is to maximize the area of the smallest region that will be formed by the polygon and those k cuts." 3000
1572D "Bridge Club" "flows,graph matchings,graphs,greedy" "There are currently n hot topics numbered from 0 to n\xe2\x88\x921 at your local bridge club and 2n players numbered from 0 to 2n\xe2\x88\x921. Each player holds a different set of views on those n topics, more specifically, the i-th player holds a positive view on the j-th topic if i & 2j>0, and a negative view otherwise. Here & denotes the bitwise AND operation.You are going to organize a bridge tournament capable of accommodating at most k pairs of players (bridge is played in teams of two people). You can select teams arbitrarily while each player is in at most one team, but there is one catch: two players cannot be in the same pair if they disagree on 2 or more of those n topics, as they would argue too much during the play.You know that the i-th player will pay you ai dollars if they play in this tournament. Compute the maximum amount of money that you can earn if you pair the players in your club optimally." 2800
1572C Paint dp,greedy "You are given a 1 by n pixel image. The i-th pixel of the image has color ai. For each color, the number of pixels of that color is at most 20.You can perform the following operation, which works like the bucket tool in paint programs, on this image:   pick a color \xe2\x80\x94 an integer from 1 to n;  choose a pixel in the image;  for all pixels connected to the selected pixel, change their colors to the selected color (two pixels of the same color are considered connected if all the pixels between them have the same color as those two pixels). Compute the minimum number of operations needed to make all the pixels in the image have the same color." 2700
1572B "Xor of 3" "brute force,constructive algorithms,greedy,two pointers" "You are given a sequence a of length n consisting of 0s and 1s.You can perform the following operation on this sequence:   Pick an index i from 1 to n\xe2\x88\x922 (inclusive).  Change all of ai, ai+1, ai+2 to ai\xe2\x8a\x95ai+1\xe2\x8a\x95ai+2 simultaneously, where \xe2\x8a\x95 denotes the bitwise XOR operation  Find a sequence of at most n operations that changes all elements of a to 0s or report that it\'s impossible.We can prove that if there exists a sequence of operations of any length that changes all elements of a to 0s, then there is also such a sequence of length not greater than n." 2500
1572A Book "binary search,brute force,data structures,dp,graphs,implementation,sortings" "You are given a book with n chapters.Each chapter has a specified list of other chapters that need to be understood in order to understand this chapter. To understand a chapter, you must read it after you understand every chapter on its required list.Currently you don\'t understand any of the chapters. You are going to read the book from the beginning till the end repeatedly until you understand the whole book. Note that if you read a chapter at a moment when you don\'t understand some of the required chapters, you don\'t understand this chapter.Determine how many times you will read the book to understand every chapter, or determine that you will never understand every chapter no matter how many times you read the book." 1800
1571J "Two Railroads" "*special problem" "There are n cities in Berland, and they are connected by two railroads \xe2\x80\x94 the Main railroad and the Auxiliary railroad. Each city has two railway stations, one connected to the Main railroad (called the Main station), and the other connected to the Auxiliary railroad.The railroads are identical in their structure. The Main railroad consists of n\xe2\x88\x921 railroad segments; the i-th railroad segment connects the Main station of the city i with the Main station of the city i+1. Similarly, the Auxiliary railroad consists of n\xe2\x88\x921 railroad segments; the i-th railroad segment connects the Auxiliary station of the city i with the Auxiliary station of the city i+1.These railroads are used to transfer different goods and resources from one city to another. In particular, the Ministry of Energetics is interested in using these railroads to transfer coal.The Ministry has estimated the following capabilities of the railroads:  for every i\xe2\x88\x88[1,n\xe2\x88\x921], at most ai tons of coal per day can be transferred from the Main station i to the Main station i+1 (only in this direction);  for every i\xe2\x88\x88[1,n\xe2\x88\x921], at most bi tons of coal per day can be transferred from the Auxiliary station i to the Auxiliary station i+1 (only in this direction);  for every i\xe2\x88\x88[1,n], at most ci tons of coal per day can be transferred from the Main station i to the Auxiliary station i, or in the opposite direction. To analyze the capacity of the whole railroad network, the Ministry requires a software that would process and answer queries of the following format:  calculate the maximum number of tons of coal that can be transferred per day from the Main station li to the Main station ri. Your task is to implement this software." 3000
1571I "Physical Examination" "*special problem,binary search,data structures" "Polycarp plans to undergo a full physical examination at his local clinic. There are n doctors, numbered from 1 to n. The i-th doctor takes patients from minute Li to minute Ri, so Polycarp can visit him at any minute in this range. It takes each doctor exactly one minute to examine Polycarp\'s health.Polycarp wants to arrive at the clinic at some minute x and visit all n doctors in some order without waiting or visiting any doctor several times.More formally, he chooses an integer x and a permutation p1,p2,\xe2\x80\xa6,pn (a sequence of n integers from 1 to n such that each integer appears exactly once), then proceeds to visit:   doctor p1 at minute x;  doctor p2 at minute x+1;  ...  doctor pn at minute x+n\xe2\x88\x921. The pi-th doctor should be able to take patients at minute x+i\xe2\x88\x921, so the following should hold: L[pi]\xe2\x89\xa4x+i\xe2\x88\x921\xe2\x89\xa4R[pi].Determine if it\'s possible for Polycarp to choose such a minute x and a permutation p that he\'ll be able to visit all n doctors in without waiting or visiting any doctor several times. If there are multiple answers, print any of them." 3200
1571H "Laser Beams" "*special problem,geometry,probabilities" "Ira is developing a computer game. This game features randomized generation and difficulty of levels. To achieve randomized difficulty, some enemies in each level are randomly replaced with stronger ones.To describe how do the levels in the game look, let\'s introduce a coordinate system in such a way that Ox axis goes from left to right, and Oy axis goes from bottom to top. A level is a rectangle with opposite corners in points (0,0) and (a,b). Each enemy\'s position is a point in this rectangle.As for now, Ira has implemented one type of enemy in the game, in two different versions \xe2\x80\x94 basic and upgraded. Both versions of enemies Ira has implemented fire laser rays in several directions:  basic enemies fire four laser rays in four directions: to the right (in the same direction as the vector (1,0)), to the left (in the same direction as the vector (\xe2\x88\x921,0)), up (in the same direction as the vector (0,1)), and down (in the same direction as the vector (0,\xe2\x88\x921));  upgraded enemies fire eight laser rays in eight directions: four directions listed for basic enemies, and four directions corresponding to vectors (1,1), (1,\xe2\x88\x921), (\xe2\x88\x921,1), (\xe2\x88\x921,\xe2\x88\x921). Laser rays pass through enemies and are blocked only by the borders of the level (sides of the rectangle that denotes the level). Enemies are unaffected by lasers.The level Ira is working on has n enemies. The i-th enemy is in the point (xi,yi), and it has a probability of pi to be upgraded (it\'s either upgraded with probability pi, or basic with probability 1\xe2\x88\x92pi). All these events are independent.Ira wants to estimate the expected difficulty. She considers that a good way to evaluate the difficulty of the level is to count the number of parts in which the level is divided by the laser rays. So, she wants to calculate the expected number of these parts.Help her to do the evaluation of the level!" 2900
1571G "A Battle Against a Dragon" "*special problem,data structures,dp" "A squad of n warriors is defending a castle from a dragon attack. There are m barricades between the castle and the dragon.The warriors are numbered from 1 to n. The i-th warrior knows ki attacks: the j-th of them deals ai,j damage to the dragon and can only be applied if there are exactly bi,j barricades between the castle and the dragon.The warriors make turns one after another, starting from warrior 1. After warrior n makes his turn, the total damage to the dragon is calculated. The i-th warrior performs exactly one of three possible moves in his turn:  destroys one barricade (if there are any left);  deploys one of his ki attacks;  skips a turn. The total damage is the sum of damages dealt by the warriors who chose to deploy their attacks in their turn. What is the maximum total damage the warriors can deal to the dragon?" 2500
1571F Kotlinforces "*special problem,constructive algorithms,dp" "Kotlinforces is a web platfrom that hosts programming competitions.The staff of Kotlinforces is asked to schedule n programming competitions on the next m days. Each competition is held in multiple stages; the regulations of the i-th competition state that this competition should consist of exactly ki stages, and each stage, starting from the second one, should be scheduled exactly ti days after the previous stage. In other words, if the first stage of the i-th competition is scheduled on day x, the second stage should be scheduled on day x+ti, the third stage \xe2\x80\x94 on day x+2ti, ..., the ki-th stage (which is the last one) \xe2\x80\x94 on day x+(ki\xe2\x88\x921)ti.All n competitions should be scheduled in such a way that they start and finish during the next m days, and on any of these m days, at most one stage of one competition is held (two stages of different competitions should not be scheduled on the same day).Is it possible to schedule all n competitions to meet these constraints?" 2000
1571E "Fix the String" "*special problem,bitmasks,dp,greedy" "A regular bracket sequence is a bracket sequence that can be transformed into a correct arithmetic expression by inserting characters ""1"" and ""+"" between the original characters of the sequence. For example:  bracket sequences ""()()"" and ""(())"" are regular (the resulting expressions are: ""(1)+(1)"" and ""((1+1)+1)"");  bracket sequences "")("", ""("" and "")"" are not. You are given two strings s and a, the string s has length n, the string a has length n\xe2\x88\x923. The string s is a bracket sequence (i.\xe2\x80\x89e. each element of this string is either an opening bracket character or a closing bracket character). The string a is a binary string (i.\xe2\x80\x89e. each element of this string is either 1 or 0).The string a imposes some constraints on the string s: for every i such that ai is 1, the string sisi+1si+2si+3 should be a regular bracket sequence. Characters of a equal to 0 don\'t impose any constraints.Initially, the string s may or may not meet these constraints. You can perform the following operation any number of times: replace some character of s with its inverse (i.\xe2\x80\x89e. you can replace an opening bracket with a closing bracket, or vice versa).Determine if it is possible to change some characters in s so that it meets all of the constraints, and if it is possible, calculate the minimum number of characters to be changed." 1700
1571D Sweepstake "*special problem,brute force,constructive algorithms,implementation,math" "Kotlin Heroes competition is nearing completion. This time n programmers took part in the competition. Now organizers are thinking how to entertain spectators as well. One of the possibilities is holding sweepstakes. So for now they decided to conduct a survey among spectators.In total, organizers asked m viewers two questions:   Who will take the first place?  Who will take the last place? After receiving answers, organizers ranked all spectators based on the number of programmers they guessed right. Suppose, there are c2 viewers who guessed right both first and last place, c1 viewers who guessed either first or last place right and c0 viewers who didn\'t guess at all. All c2 viewers will get rank 1, all viewers with one right answer will get rank c2+1 and all remaining viewers \xe2\x80\x94 rank c2+c1+1.You were one of the interviewed spectators. Also, as one of the organizers, you have access to survey results, but not to competition results. Calculate, what is the worst rank you can possibly get according to organizers\' ranking system?" 1800
1571C Rhyme "*special problem,implementation" "Let\'s say that two strings s and t rhyme if both strings have length at least k, and their last k characters are equal. For example, if k=3, the strings abcd and cebcd rhyme, the strings ab and ab don\'t rhyme, the strings aaaa and aaaaa rhyme, the strings abcd and abce don\'t rhyme.You have n pairs of strings (si,ti), and for each pair of strings you know, should they rhyme or should not.Find all possible non-negative integer values for k such that pairs that have to rhyme, rhyme and pairs that must not rhyme, don\'t rhyme." 1800
1571B "Epic Novel" "*special problem,math" "Alex has bought a new novel that was published in n volumes. He has read these volumes one by one, and each volume has taken him several (maybe one) full days to read. So, on the first day, he was reading the first volume, and on each of the following days, he was reading either the same volume he had been reading on the previous day, or the next volume.Let vi be the number of the volume Alex was reading on the i-th day. Here are some examples:  one of the possible situations is v1=1, v2=1, v3=2, v4=3, v5=3 \xe2\x80\x94 this situation means that Alex has spent two days (1-st and 2-nd) on the first volume, one day (3-rd) on the second volume, and two days (4-th and 5-th) on the third volume;  a situation v1=2, v2=2, v3=3 is impossible, since Alex started with the first volume (so v1 cannot be anything but 1);  a situation v1=1, v2=2, v3=3, v4=1 is impossible, since Alex won\'t return to the first volume after reading the third one;  a situation v1=1, v2=3 is impossible, since Alex doesn\'t skip volumes. You know that Alex was reading the volume va on the day a, and the volume vc on the day c. Now you want to guess which volume was he reading on the day b, which is between the days a and c (so a<b<c). There may be some ambiguity, so you want to make any valid guess (i.\xe2\x80\x89e. choose some volume number vb so it\'s possible that Alex was reading volume va on day a, volume vb on day b, and volume vc on day c)." 1300
1571A "Sequence of Comparisons" "*special problem" "Once upon a time, Petya had an array of integers a of length n. But over time, the array itself was lost, and only n\xe2\x88\x921 results of comparisons of neighboring array elements remained. In other words, for every i from 1 to n\xe2\x88\x921, Petya knows exactly one of these three facts:  ai<ai+1;  ai=ai+1;  ai>ai+1. Petya wonders if it is possible to uniquely determine the result of comparing a1 and an.You have to help Petya determine the result of comparing a1 and an or report that the result cannot be determined unambiguously." 800
1569F "Palindromic Hamiltonian Path" "brute force,dfs and similar,dp,graphs,hashing" "You are given a simple undirected graph with n vertices, n is even. You are going to write a letter on each vertex. Each letter should be one of the first k letters of the Latin alphabet.A path in the graph is called Hamiltonian if it visits each vertex exactly once. A string is called palindromic if it reads the same from left to right and from right to left. A path in the graph is called palindromic if the letters on the vertices in it spell a palindromic string without changing the order.A string of length n is good if:   each letter is one of the first k lowercase Latin letters;  if you write the i-th letter of the string on the i-th vertex of the graph, there will exist a palindromic Hamiltonian path in the graph. Note that the path doesn\'t necesserily go through the vertices in order 1,2,\xe2\x80\xa6,n.Count the number of good strings." 3000
1569E "Playoff Restoration" "bitmasks,brute force,hashing,implementation,meet-in-the-middle" "2k teams participate in a playoff tournament. The tournament consists of 2k\xe2\x88\x921 games. They are held as follows: first of all, the teams are split into pairs: team 1 plays against team 2, team 3 plays against team 4 (exactly in this order), and so on (so, 2k\xe2\x88\x921 games are played in that phase). When a team loses a game, it is eliminated, and each game results in elimination of one team (there are no ties). After that, only 2k\xe2\x88\x921 teams remain. If only one team remains, it is declared the champion; otherwise, 2k\xe2\x88\x922 games are played: in the first one of them, the winner of the game ""1 vs 2"" plays against the winner of the game ""3 vs 4"", then the winner of the game ""5 vs 6"" plays against the winner of the game ""7 vs 8"", and so on. This process repeats until only one team remains.After the tournament ends, the teams are assigned places according to the tournament phase when they were eliminated. In particular:  the winner of the tournament gets place 1;  the team eliminated in the finals gets place 2;  both teams eliminated in the semifinals get place 3;  all teams eliminated in the quarterfinals get place 5;  all teams eliminated in the 1/8 finals get place 9, and so on. For example, this picture describes one of the possible ways the tournament can go with k=3, and the resulting places of the teams:  After a tournament which was conducted by the aforementioned rules ended, its results were encoded in the following way. Let pi be the place of the i-th team in the tournament. The hash value of the tournament h is calculated as h=(2k\xe2\x88\x91i=1i\xe2\x8b\x85Api)mod998244353, where A is some given integer.Unfortunately, due to a system crash, almost all tournament-related data was lost. The only pieces of data that remain are the values of k, A and h. You are asked to restore the resulting placing of the teams in the tournament, if it is possible at all." 2600
1569D "Inconvenient Pairs" "binary search,data structures,implementation,sortings,two pointers" "There is a city that can be represented as a square grid with corner points in (0,0) and (106,106).The city has n vertical and m horizontal streets that goes across the whole city, i. e. the i-th vertical streets goes from (xi,0) to (xi,106) and the j-th horizontal street goes from (0,yj) to (106,yj). All streets are bidirectional. Borders of the city are streets as well.There are k persons staying on the streets: the p-th person at point (xp,yp) (so either xp equal to some xi or yp equal to some yj, or both).Let\'s say that a pair of persons form an inconvenient pair if the shortest path from one person to another going only by streets is strictly greater than the Manhattan distance between them.Calculate the number of inconvenient pairs of persons (pairs (x,y) and (y,x) are the same pair).Let\'s recall that Manhattan distance between points (x1,y1) and (x2,y2) is |x1\xe2\x88\x92x2|+|y1\xe2\x88\x92y2|." 1900
1569C "Jury Meeting" combinatorics,math "n people gathered to hold a jury meeting of the upcoming competition, the i-th member of the jury came up with ai tasks, which they want to share with each other.First, the jury decides on the order which they will follow while describing the tasks. Let that be a permutation p of numbers from 1 to n (an array of size n where each integer from 1 to n occurs exactly once).Then the discussion goes as follows:  If a jury member p1 has some tasks left to tell, then they tell one task to others. Otherwise, they are skipped.  If a jury member p2 has some tasks left to tell, then they tell one task to others. Otherwise, they are skipped.  ...  If a jury member pn has some tasks left to tell, then they tell one task to others. Otherwise, they are skipped.  If there are still members with tasks left, then the process repeats from the start. Otherwise, the discussion ends. A permutation p is nice if none of the jury members tell two or more of their own tasks in a row. Count the number of nice permutations. The answer may be really large, so print it modulo 998244353." 1500
1569B "Chess Tournament" "constructive algorithms" "A chess tournament will be held soon, where n chess players will take part. Every participant will play one game against every other participant. Each game ends in either a win for one player and a loss for another player, or a draw for both players.Each of the players has their own expectations about the tournament, they can be one of two types:  a player wants not to lose any game (i.\xe2\x80\x89e. finish the tournament with zero losses);  a player wants to win at least one game. You have to determine if there exists an outcome for all the matches such that all the players meet their expectations. If there are several possible outcomes, print any of them. If there are none, report that it\'s impossible." 1000
1569A "Balanced Substring" implementation "You are given a string s, consisting of n letters, each letter is either \'a\' or \'b\'. The letters in the string are numbered from 1 to n.s[l;r] is a continuous substring of letters from index l to r of the string inclusive. A string is called balanced if the number of letters \'a\' in it is equal to the number of letters \'b\'. For example, strings ""baba"" and ""aabbab"" are balanced and strings ""aaab"" and ""b"" are not.Find any non-empty balanced substring s[l;r] of string s. Print its l and r (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n). If there is no such substring, then print \xe2\x88\x921 \xe2\x88\x921." 800
1567F "One-Four Overload" "2-sat,constructive algorithms,dfs and similar,dsu,graphs,implementation" "Alice has an empty grid with n rows and m columns. Some of the cells are marked, and no marked cells are adjacent to the edge of the grid. (Two squares are adjacent if they share a side.) Alice wants to fill each cell with a number such that the following statements are true:   every unmarked cell contains either the number 1 or 4;  every marked cell contains the sum of the numbers in all unmarked cells adjacent to it (if a marked cell is not adjacent to any unmarked cell, this sum is 0);  every marked cell contains a multiple of 5.  Alice couldn\'t figure it out, so she asks Bob to help her. Help Bob find any such grid, or state that no such grid exists." 2700
1567E "Non-Decreasing Dilemma" "data structures,divide and conquer,math" "Alice has recently received an array a1,a2,\xe2\x80\xa6,an for her birthday! She is very proud of her array, and when she showed her friend Bob the array, he was very happy with her present too!However, soon Bob became curious, and as any sane friend would do, asked Alice to perform q operations of two types on her array:  1 x y: update the element ax to y (set ax=y).  2 l r: calculate how many non-decreasing subarrays exist within the subarray [al,al+1,\xe2\x80\xa6,ar]. More formally, count the number of pairs of integers (p,q) such that l\xe2\x89\xa4p\xe2\x89\xa4q\xe2\x89\xa4r and ap\xe2\x89\xa4ap+1\xe2\x89\xa4\xe2\x8b\xaf\xe2\x89\xa4aq\xe2\x88\x921\xe2\x89\xa4aq. Help Alice answer Bob\'s queries!" 2200
1567D "Expression Evaluation Error" "constructive algorithms,greedy,implementation,math" "On the board, Bob wrote n positive integers in base 10 with sum s (i. e. in decimal numeral system). Alice sees the board, but accidentally interprets the numbers on the board as base-11 integers and adds them up (in base 11).What numbers should Bob write on the board, so Alice\'s sum is as large as possible?" 2000
1567C "Carrying Conundrum" bitmasks,combinatorics,dp,math "Alice has just learned addition. However, she hasn\'t learned the concept of ""carrying"" fully \xe2\x80\x94 instead of carrying to the next column, she carries to the column two columns to the left.For example, the regular way to evaluate the sum 2039+2976 would be as shown:   However, Alice evaluates it as shown:   In particular, this is what she does:   add 9 and 6 to make 15, and carry the 1 to the column two columns to the left, i. e. to the column ""0 9"";  add 3 and 7 to make 10 and carry the 1 to the column two columns to the left, i. e. to the column ""2 2"";  add 1, 0, and 9 to make 10 and carry the 1 to the column two columns to the left, i. e. to the column above the plus sign;  add 1, 2 and 2 to make 5;  add 1 to make 1.  Thus, she ends up with the incorrect result of 15005.Alice comes up to Bob and says that she has added two numbers to get a result of n. However, Bob knows that Alice adds in her own way. Help Bob find the number of ordered pairs of positive integers such that when Alice adds them, she will get a result of n. Note that pairs (a,b) and (b,a) are considered different if a\xe2\x89\xa0b." 1600
1567B "MEXor Mixup" bitmasks,greedy "Alice gave Bob two integers a and b (a>0 and b\xe2\x89\xa50). Being a curious boy, Bob wrote down an array of non-negative integers with MEX value of all elements equal to a and XOR value of all elements equal to b.What is the shortest possible length of the array Bob wrote?Recall that the MEX (Minimum EXcluded) of an array is the minimum non-negative integer that does not belong to the array and the XOR of an array is the bitwise XOR of all the elements of the array." 1000
1567A "Domino Disaster" implementation,strings "Alice has a grid with 2 rows and n columns. She fully covers the grid using n dominoes of size 1\xc3\x972 \xe2\x80\x94 Alice may place them vertically or horizontally, and each cell should be covered by exactly one domino.Now, she decided to show one row of the grid to Bob. Help Bob and figure out what the other row of the grid looks like!" 800
1566H Xor-quiz "constructive algorithms,dp,interactive,math,number theory" "This is an interactive problem.You are given two integers c and n. The jury has a randomly generated set A of distinct positive integers not greater than c (it is generated from all such possible sets with equal probability). The size of A is equal to n.Your task is to guess the set A. In order to guess it, you can ask at most \xe2\x8c\x880.65\xe2\x8b\x85c\xe2\x8c\x89 queries.In each query, you choose a single integer 1\xe2\x89\xa4x\xe2\x89\xa4c. As the answer to this query you will be given the bitwise xor sum of all y, such that y\xe2\x88\x88A and gcd(x,y)=1 (i.e. x and y are coprime). If there is no such y this xor sum is equal to 0.You can ask all queries at the beginning and you will receive the answers to all your queries. After that, you won\'t have the possibility to ask queries.You should find any set A\xe2\x80\xb2, such that |A\xe2\x80\xb2|=n and A\xe2\x80\xb2 and A have the same answers for all c possible queries." 3200
1566G "Four Vertices" "constructive algorithms,data structures,graphs,greedy,implementation,shortest paths" "You are given an undirected weighted graph, consisting of n vertices and m edges.Some queries happen with this graph:  Delete an existing edge from the graph.  Add a non-existing edge to the graph. At the beginning and after each query, you should find four different vertices a, b, c, d such that there exists a path between a and b, there exists a path between c and d, and the sum of lengths of two shortest paths from a to b and from c to d is minimal. The answer to the query is the sum of the lengths of these two shortest paths. The length of the path is equal to the sum of weights of edges in this path." 3100
1566F "Points Movement" "data structures,dp,greedy,implementation,sortings" "There are n points and m segments on the coordinate line. The initial coordinate of the i-th point is ai. The endpoints of the j-th segment are lj and rj \xe2\x80\x94 left and right endpoints, respectively.You can move the points. In one move you can move any point from its current coordinate x to the coordinate x\xe2\x88\x921 or the coordinate x+1. The cost of this move is 1.You should move the points in such a way that each segment is visited by at least one point. A point visits the segment [l,r] if there is a moment when its coordinate was on the segment [l,r] (including endpoints).You should find the minimal possible total cost of all moves such that all segments are visited." 2600
1566E "Buds Re-hanging" "constructive algorithms,dfs and similar,dp,greedy,trees" "A tree is a connected graph without cycles. A rooted tree has a special vertex called the root. The parent of a vertex v (different from root) is the previous to v vertex on the shortest path from the root to the vertex v. Children of the vertex v are all vertices for which v is the parent.A vertex is a leaf if it has no children. We call a vertex a bud, if the following three conditions are satisfied:   it is not a root,  it has at least one child, and  all its children are leaves. You are given a rooted tree with n vertices. The vertex 1 is the root. In one operation you can choose any bud with all its children (they are leaves) and re-hang them to any other vertex of the tree. By doing that you delete the edge connecting the bud and its parent and add an edge between the bud and the chosen vertex of the tree. The chosen vertex cannot be the bud itself or any of its children. All children of the bud stay connected to the bud.What is the minimum number of leaves it is possible to get if you can make any number of the above-mentioned operations (possibly zero)?" 2000
1566D2 "Seating Arrangements (hard version)" "data structures,greedy,implementation,sortings,two pointers" "It is the hard version of the problem. The only difference is that in this version 1\xe2\x89\xa4n\xe2\x89\xa4300.In the cinema seats can be represented as the table with n rows and m columns. The rows are numbered with integers from 1 to n. The seats in each row are numbered with consecutive integers from left to right: in the k-th row from m(k\xe2\x88\x921)+1 to mk for all rows 1\xe2\x89\xa4k\xe2\x89\xa4n. 12\xe2\x8b\xafm\xe2\x88\x921mm+1m+2\xe2\x8b\xaf2m\xe2\x88\x9212m2m+12m+2\xe2\x8b\xaf3m\xe2\x88\x9213m\xe2\x8b\xae\xe2\x8b\xae\xe2\x8b\xb1\xe2\x8b\xae\xe2\x8b\xaem(n\xe2\x88\x921)+1m(n\xe2\x88\x921)+2\xe2\x8b\xafnm\xe2\x88\x921nm The table with seats indices There are nm people who want to go to the cinema to watch a new film. They are numbered with integers from 1 to nm. You should give exactly one seat to each person.It is known, that in this cinema as lower seat index you have as better you can see everything happening on the screen. i-th person has the level of sight ai. Let\'s define si as the seat index, that will be given to i-th person. You want to give better places for people with lower sight levels, so for any two people i, j such that ai<aj it should be satisfied that si<sj.After you will give seats to all people they will start coming to their seats. In the order from 1 to nm, each person will enter the hall and sit in their seat. To get to their place, the person will go to their seat\'s row and start moving from the first seat in this row to theirs from left to right. While moving some places will be free, some will be occupied with people already seated. The inconvenience of the person is equal to the number of occupied seats he or she will go through.Let\'s consider an example: m=5, the person has the seat 4 in the first row, the seats 1, 3, 5 in the first row are already occupied, the seats 2 and 4 are free. The inconvenience of this person will be 2, because he will go through occupied seats 1 and 3.Find the minimal total inconvenience (the sum of inconveniences of all people), that is possible to have by giving places for all people (all conditions should be satisfied)." 1600
1566D1 "Seating Arrangements (easy version)" "data structures,greedy,sortings" "It is the easy version of the problem. The only difference is that in this version n=1.In the cinema seats can be represented as the table with n rows and m columns. The rows are numbered with integers from 1 to n. The seats in each row are numbered with consecutive integers from left to right: in the k-th row from m(k\xe2\x88\x921)+1 to mk for all rows 1\xe2\x89\xa4k\xe2\x89\xa4n. 12\xe2\x8b\xafm\xe2\x88\x921mm+1m+2\xe2\x8b\xaf2m\xe2\x88\x9212m2m+12m+2\xe2\x8b\xaf3m\xe2\x88\x9213m\xe2\x8b\xae\xe2\x8b\xae\xe2\x8b\xb1\xe2\x8b\xae\xe2\x8b\xaem(n\xe2\x88\x921)+1m(n\xe2\x88\x921)+2\xe2\x8b\xafnm\xe2\x88\x921nm The table with seats indices There are nm people who want to go to the cinema to watch a new film. They are numbered with integers from 1 to nm. You should give exactly one seat to each person.It is known, that in this cinema as lower seat index you have as better you can see everything happening on the screen. i-th person has the level of sight ai. Let\'s define si as the seat index, that will be given to i-th person. You want to give better places for people with lower sight levels, so for any two people i, j such that ai<aj it should be satisfied that si<sj.After you will give seats to all people they will start coming to their seats. In the order from 1 to nm, each person will enter the hall and sit in their seat. To get to their place, the person will go to their seat\'s row and start moving from the first seat in this row to theirs from left to right. While moving some places will be free, some will be occupied with people already seated. The inconvenience of the person is equal to the number of occupied seats he or she will go through.Let\'s consider an example: m=5, the person has the seat 4 in the first row, the seats 1, 3, 5 in the first row are already occupied, the seats 2 and 4 are free. The inconvenience of this person will be 2, because he will go through occupied seats 1 and 3.Find the minimal total inconvenience (the sum of inconveniences of all people), that is possible to have by giving places for all people (all conditions should be satisfied)." 1100
1566C "MAX-MEX Cut" "bitmasks,constructive algorithms,dp,greedy" "A binary string is a string that consists of characters 0 and 1. A bi-table is a table that has exactly two rows of equal length, each being a binary string.Let MEX of a bi-table be the smallest digit among 0, 1, or 2 that does not occur in the bi-table. For example, MEX for [00111010] is 2, because 0 and 1 occur in the bi-table at least once. MEX for [111111] is 0, because 0 and 2 do not occur in the bi-table, and 0<2.You are given a bi-table with n columns. You should cut it into any number of bi-tables (each consisting of consecutive columns) so that each column is in exactly one bi-table. It is possible to cut the bi-table into a single bi-table \xe2\x80\x94 the whole bi-table.What is the maximal sum of MEX of all resulting bi-tables can be?" 1000
1566B "MIN-MEX Cut" "bitmasks,constructive algorithms,dp,greedy" "A binary string is a string that consists of characters 0 and 1.Let MEX of a binary string be the smallest digit among 0, 1, or 2 that does not occur in the string. For example, MEX of 001011 is 2, because 0 and 1 occur in the string at least once, MEX of 1111 is 0, because 0 and 2 do not occur in the string and 0<2.A binary string s is given. You should cut it into any number of substrings such that each character is in exactly one substring. It is possible to cut the string into a single substring \xe2\x80\x94 the whole string.A string a is a substring of a string b if a can be obtained from b by deletion of several (possibly, zero or all) characters from the beginning and several (possibly, zero or all) characters from the end.What is the minimal sum of MEX of all substrings pieces can be?" 800
1566A "Median Maximization" "binary search,greedy,math" "You are given two positive integers n and s. Find the maximum possible median of an array of n non-negative integers (not necessarily distinct), such that the sum of its elements is equal to s.A median of an array of integers of length m is the number standing on the \xe2\x8c\x88m2\xe2\x8c\x89-th (rounding up) position in the non-decreasing ordering of its elements. Positions are numbered starting from 1. For example, a median of the array [20,40,20,50,50,30] is the \xe2\x8c\x88m2\xe2\x8c\x89-th element of [20,20,30,40,50,50], so it is 30. There exist other definitions of the median, but in this problem we use the described definition." 800
1562F "Tubular Bells" "interactive,math,number theory,probabilities" "Do you know what tubular bells are? They are a musical instrument made up of cylindrical metal tubes. In an orchestra, tubular bells are used to mimic the ringing of bells.Mike has tubular bells, too! They consist of n tubes, and each of the tubes has a length that can be expressed by a integer from l to r inclusive. It is clear that the lengths of all the tubes are different (it makes no sense to make the same tubes). It is also known that r\xe2\x88\x92l+1=n.Formally, we can say that Mike\'s tubular bells are described by a permutation a of length n that contains all numbers from l to r inclusive, with ai denoting the length of the i-th tube.You are offered an interesting task: to guess what Mike\'s instrument looks like. Simply, you must guess the permutation.Mike won\'t tell you l or r. He will only tell you n, and will allow you to ask no more than n+5000 queries.In each query, you name two positive integers x, y such that 1\xe2\x89\xa4x,y\xe2\x89\xa4n,x\xe2\x89\xa0y. In response to this query, the program written by Mike will give you lcm(ax,ay), where lcm(c,d) denotes the least common multiple of c and d.Solve Mike\'s problem!" 2900
1562E "Rescue Niwen!" "dp,greedy,string suffix structures,strings" "Morning desert sun horizonRise above the sands of time...Fates Warning, ""Exodus""After crossing the Windswept Wastes, Ori has finally reached the Windtorn Ruins to find the Heart of the Forest! However, the ancient repository containing this priceless Willow light did not want to open!Ori was taken aback, but the Voice of the Forest explained to him that the cunning Gorleks had decided to add protection to the repository.The Gorleks were very fond of the ""string expansion"" operation. They were also very fond of increasing subsequences.Suppose a string s1s2s3\xe2\x80\xa6sn is given. Then its ""expansion"" is defined as the sequence of strings s1, s1s2, ..., s1s2\xe2\x80\xa6sn, s2, s2s3, ..., s2s3\xe2\x80\xa6sn, s3, s3s4, ..., sn\xe2\x88\x921sn, sn. For example, the ""expansion"" the string \'abcd\' will be the following sequence of strings: \'a\', \'ab\', \'abc\', \'abcd\', \'b\', \'bc\', \'bcd\', \'c\', \'cd\', \'d\'. To open the ancient repository, Ori must find the size of the largest increasing subsequence of the ""expansion"" of the string s. Here, strings are compared lexicographically.Help Ori with this task!A string a is lexicographically smaller than a string b if and only if one of the following holds: a is a prefix of b, but a\xe2\x89\xa0b; in the first position where a and b differ, the string a has a letter that appears earlier in the alphabet than the corresponding letter in b." 2500
1562D2 "Two Hundred Twenty One (hard version)" "data structures,math" "This is the hard version of the problem. The difference between the versions is that the hard version does require you to output the numbers of the rods to be removed. You can make hacks only if all versions of the problem are solved.Stitch likes experimenting with different machines with his friend Sparky. Today they built another machine.The main element of this machine are n rods arranged along one straight line and numbered from 1 to n inclusive. Each of these rods must carry an electric charge quantitatively equal to either 1 or \xe2\x88\x921 (otherwise the machine will not work). Another condition for this machine to work is that the sign-variable sum of the charge on all rods must be zero.More formally, the rods can be represented as an array of n numbers characterizing the charge: either 1 or \xe2\x88\x921. Then the condition must hold: a1\xe2\x88\x92a2+a3\xe2\x88\x92a4+\xe2\x80\xa6=0, or n\xe2\x88\x91i=1(\xe2\x88\x921)i\xe2\x88\x921\xe2\x8b\x85ai=0.Sparky charged all n rods with an electric current, but unfortunately it happened that the rods were not charged correctly (the sign-variable sum of the charge is not zero). The friends decided to leave only some of the rods in the machine. Sparky has q questions. In the ith question Sparky asks: if the machine consisted only of rods with numbers li to ri inclusive, what minimal number of rods could be removed from the machine so that the sign-variable sum of charges on the remaining ones would be zero? Also Sparky wants to know the numbers of these rods. Perhaps the friends got something wrong, and the sign-variable sum is already zero. In that case, you don\'t have to remove the rods at all.If the number of rods is zero, we will assume that the sign-variable sum of charges is zero, that is, we can always remove all rods.Help your friends and answer all of Sparky\'s questions!" 2200
1562D1 "Two Hundred Twenty One (easy version)" "data structures,dp,math" "This is the easy version of the problem. The difference between the versions is that the easy version does not require you to output the numbers of the rods to be removed. You can make hacks only if all versions of the problem are solved.Stitch likes experimenting with different machines with his friend Sparky. Today they built another machine.The main element of this machine are n rods arranged along one straight line and numbered from 1 to n inclusive. Each of these rods must carry an electric charge quantitatively equal to either 1 or \xe2\x88\x921 (otherwise the machine will not work). Another condition for this machine to work is that the sign-variable sum of the charge on all rods must be zero.More formally, the rods can be represented as an array of n numbers characterizing the charge: either 1 or \xe2\x88\x921. Then the condition must hold: a1\xe2\x88\x92a2+a3\xe2\x88\x92a4+\xe2\x80\xa6=0, or n\xe2\x88\x91i=1(\xe2\x88\x921)i\xe2\x88\x921\xe2\x8b\x85ai=0.Sparky charged all n rods with an electric current, but unfortunately it happened that the rods were not charged correctly (the sign-variable sum of the charge is not zero). The friends decided to leave only some of the rods in the machine. Sparky has q questions. In the ith question Sparky asks: if the machine consisted only of rods with numbers li to ri inclusive, what minimal number of rods could be removed from the machine so that the sign-variable sum of charges on the remaining ones would be zero? Perhaps the friends got something wrong, and the sign-variable sum is already zero. In that case, you don\'t have to remove the rods at all.If the number of rods is zero, we will assume that the sign-variable sum of charges is zero, that is, we can always remove all rods.Help your friends and answer all of Sparky\'s questions!" 1700
1562C Rings "constructive algorithms,math" "Frodo was caught by Saruman. He tore a pouch from Frodo\'s neck, shook out its contents \xe2\x80\x94there was a pile of different rings: gold and silver...""How am I to tell which is the One?!"" the mage howled.""Throw them one by one into the Cracks of Doom and watch when Mordor falls!"" Somewhere in a parallel Middle-earth, when Saruman caught Frodo, he only found n rings. And the i-th ring was either gold or silver. For convenience Saruman wrote down a binary string s of n characters, where the i-th character was 0 if the i-th ring was gold, and 1 if it was silver.Saruman has a magic function f, which takes a binary string and returns a number obtained by converting the string into a binary number and then converting the binary number into a decimal number. For example, f(001010)=10,f(111)=7,f(11011101)=221.Saruman, however, thinks that the order of the rings plays some important role. He wants to find 2 pairs of integers (l1,r1),(l2,r2), such that: 1\xe2\x89\xa4l1\xe2\x89\xa4n, 1\xe2\x89\xa4r1\xe2\x89\xa4n, r1\xe2\x88\x92l1+1\xe2\x89\xa5\xe2\x8c\x8an2\xe2\x8c\x8b  1\xe2\x89\xa4l2\xe2\x89\xa4n, 1\xe2\x89\xa4r2\xe2\x89\xa4n, r2\xe2\x88\x92l2+1\xe2\x89\xa5\xe2\x8c\x8an2\xe2\x8c\x8b  Pairs (l1,r1) and (l2,r2) are distinct. That is, at least one of l1\xe2\x89\xa0l2 and r1\xe2\x89\xa0r2 must hold. Let t be the substring s[l1:r1] of s, and w be the substring s[l2:r2] of s. Then there exists non-negative integer k, such that f(t)=f(w)\xe2\x8b\x85k.Here substring s[l:r] denotes slsl+1\xe2\x80\xa6sr\xe2\x88\x921sr, and \xe2\x8c\x8ax\xe2\x8c\x8b denotes rounding the number down to the nearest integer.Help Saruman solve this problem! It is guaranteed that under the constraints of the problem at least one solution exists." 1500
1562B "Scenes From a Memory" "brute force,constructive algorithms,implementation,math,number theory" "During the hypnosis session, Nicholas suddenly remembered a positive integer n, which doesn\'t contain zeros in decimal notation. Soon, when he returned home, he got curious: what is the maximum number of digits that can be removed from the number so that the number becomes not prime, that is, either composite or equal to one?For some numbers doing so is impossible: for example, for number 53 it\'s impossible to delete some of its digits to obtain a not prime integer. However, for all n in the test cases of this problem, it\'s guaranteed that it\'s possible to delete some of their digits to obtain a not prime number.Note that you cannot remove all the digits from the number.A prime number is a number that has no divisors except one and itself. A composite is a number that has more than two divisors. 1 is neither a prime nor a composite number." 1000
1562A "The Miracle and the Sleeper" greedy,math "You are given two integers l and r, l\xe2\x89\xa4r. Find the largest possible value of amodb over all pairs (a,b) of integers for which r\xe2\x89\xa5a\xe2\x89\xa5b\xe2\x89\xa5l.As a reminder, amodb is a remainder we get when dividing a by b. For example, 26mod8=2." 800
1561D1 "Up the Strip (simplified version)" "brute force,data structures,dp,math,number theory" "This version of the problem differs from the next one only in the constraint on n.Note that the memory limit in this problem is lower than in others.You have a vertical strip with n cells, numbered consecutively from 1 to n from top to bottom.You also have a token that is initially placed in cell n. You will move the token up until it arrives at cell 1.Let the token be in cell x>1 at some moment. One shift of the token can have either of the following kinds:   Subtraction: you choose an integer y between 1 and x\xe2\x88\x921, inclusive, and move the token from cell x to cell x\xe2\x88\x92y.  Floored division: you choose an integer z between 2 and x, inclusive, and move the token from cell x to cell \xe2\x8c\x8axz\xe2\x8c\x8b (x divided by z rounded down). Find the number of ways to move the token from cell n to cell 1 using one or more shifts, and print it modulo m. Note that if there are several ways to move the token from one cell to another in one shift, all these ways are considered distinct (check example explanation for a better understanding)." 1700
1561C "Deep Down Below" "binary search,greedy,sortings" "In a certain video game, the player controls a hero characterized by a single integer value: power. The hero will have to beat monsters that are also characterized by a single integer value: armor.On the current level, the hero is facing n caves. To pass the level, the hero must enter all the caves in some order, each cave exactly once, and exit every cave safe and sound. When the hero enters cave i, he will have to fight ki monsters in a row: first a monster with armor ai,1, then a monster with armor ai,2 and so on, finally, a monster with armor ai,ki.The hero can beat a monster if and only if the hero\'s power is strictly greater than the monster\'s armor. If the hero can\'t beat the monster he\'s fighting, the game ends and the player loses. Note that once the hero enters a cave, he can\'t exit it before he fights all the monsters in it, strictly in the given order.Each time the hero beats a monster, the hero\'s power increases by 1.Find the smallest possible power the hero must start the level with to be able to enter all the caves in some order and beat all the monsters." 1300
1561A "Simply Strange Sort" "brute force,implementation,sortings" "You have a permutation: an array a=[a1,a2,\xe2\x80\xa6,an] of distinct integers from 1 to n. The length of the permutation n is odd.Consider the following algorithm of sorting the permutation in increasing order.A helper procedure of the algorithm, f(i), takes a single argument i (1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921) and does the following. If ai>ai+1, the values of ai and ai+1 are exchanged. Otherwise, the permutation doesn\'t change.The algorithm consists of iterations, numbered with consecutive integers starting with 1. On the i-th iteration, the algorithm does the following:   if i is odd, call f(1),f(3),\xe2\x80\xa6,f(n\xe2\x88\x922);  if i is even, call f(2),f(4),\xe2\x80\xa6,f(n\xe2\x88\x921). It can be proven that after a finite number of iterations the permutation will be sorted in increasing order.After how many iterations will this happen for the first time?" 800
1560F2 "Nearest Beautiful Number (hard version)" "bitmasks,brute force,constructive algorithms,dfs and similar,dp,greedy" "It is a complicated version of problem F1. The difference between them is the constraints (F1: k\xe2\x89\xa42, F2: k\xe2\x89\xa410).You are given an integer n. Find the minimum integer x such that x\xe2\x89\xa5n and the number x is k-beautiful.A number is called k-beautiful if its decimal representation having no leading zeroes contains no more than k different digits. E.g. if k=2, the numbers 3434443, 55550, 777 and 21 are k-beautiful whereas the numbers 120, 445435 and 998244353 are not." 2100
1560F1 "Nearest Beautiful Number (easy version)" "binary search,bitmasks,brute force,constructive algorithms,dfs and similar,greedy" "It is a simplified version of problem F2. The difference between them is the constraints (F1: k\xe2\x89\xa42, F2: k\xe2\x89\xa410).You are given an integer n. Find the minimum integer x such that x\xe2\x89\xa5n and the number x is k-beautiful.A number is called k-beautiful if its decimal representation having no leading zeroes contains no more than k different digits. E.g. if k=2, the numbers 3434443, 55550, 777 and 21 are k-beautiful whereas the numbers 120, 445435 and 998244353 are not." 1900
1560E "Polycarp and String Transformation" "binary search,implementation,sortings,strings" "Polycarp has a string s. Polycarp performs the following actions until the string s is empty (t is initially an empty string):  he adds to the right to the string t the string s, i.e. he does t=t+s, where t+s is a concatenation of the strings t and s;  he selects an arbitrary letter of s and removes from s all its occurrences (the selected letter must occur in the string s at the moment of performing this action). Polycarp performs this sequence of actions strictly in this order.Note that after Polycarp finishes the actions, the string s will be empty and the string t will be equal to some value (that is undefined and depends on the order of removing).E.g. consider s=""abacaba"" so the actions may be performed as follows:  t=""abacaba"", the letter \'b\' is selected, then s=""aacaa"";  t=""abacabaaacaa"", the letter \'a\' is selected, then s=""c"";  t=""abacabaaacaac"", the letter \'c\' is selected, then s="""" (the empty string). You need to restore the initial value of the string s using only the final value of t and find the order of removing letters from s." 1800
1560D "Make a Power of Two" greedy,math,strings "You are given an integer n. In 1 move, you can do one of the following actions:  erase any digit of the number (it\'s acceptable that the number before the operation has exactly one digit and after the operation, it is ""empty"");  add one digit to the right. The actions may be performed in any order any number of times.Note that if, after deleting some digit from a number, it will contain leading zeroes, they will not be deleted. E.g. if you delete from the number 301 the digit 3, the result is the number 01 (not 1).You need to perform the minimum number of actions to make the number any power of 2 (i.e. there\'s an integer k (k\xe2\x89\xa50) such that the resulting number is equal to 2k). The resulting number must not have leading zeroes.E.g. consider n=1052. The answer is equal to 2. First, let\'s add to the right one digit 4 (the result will be 10524). Then let\'s erase the digit 5, so the result will be 1024 which is a power of 2.E.g. consider n=8888. The answer is equal to 3. Let\'s erase any of the digits 8 three times. The result will be 8 which is a power of 2." 1300
1560C "Infinity Table" implementation,math "Polycarp has found a table having an infinite number of rows and columns. The rows are numbered from 1, starting from the topmost one. The columns are numbered from 1, starting from the leftmost one.Initially, the table hasn\'t been filled and Polycarp wants to fix it. He writes integers from 1 and so on to the table as follows.  The figure shows the placement of the numbers from 1 to 10. The following actions are denoted by the arrows. The leftmost topmost cell of the table is filled with the number 1. Then he writes in the table all positive integers beginning from 2 sequentially using the following algorithm.First, Polycarp selects the leftmost non-filled cell in the first row and fills it. Then, while the left neighbor of the last filled cell is filled, he goes down and fills the next cell. So he goes down until the last filled cell has a non-filled neighbor to the left (look at the vertical arrow going down in the figure above).After that, he fills the cells from the right to the left until he stops at the first column (look at the horizontal row in the figure above). Then Polycarp selects the leftmost non-filled cell in the first row, goes down, and so on.A friend of Polycarp has a favorite number k. He wants to know which cell will contain the number. Help him to find the indices of the row and the column, such that the intersection of the row and the column is the cell containing the number k." 800
1560B "Who\'s Opposite?" math "Some number of people (this number is even) have stood in a circle. The people stand in the circle evenly. They are numbered clockwise starting from a person with the number 11. Each person is looking through the circle\'s center at the opposite person.  A sample of a circle of 66 persons. The orange arrows indicate who is looking at whom. You don\'t know the exact number of people standing in the circle (but this number is even, no doubt). It is known that the person with the number aa is looking at the person with the number bb (and vice versa, of course). What is the number associated with a person being looked at by the person with the number cc? If, for the specified aa, bb, and cc, no such circle exists, output -1." 800
1560A "Dislike of Threes" implementation "Polycarp doesn\'t like integers that are divisible by 3 or end with the digit 3 in their decimal representation. Integers that meet both conditions are disliked by Polycarp, too.Polycarp starts to write out the positive (greater than 0) integers which he likes: 1,2,4,5,7,8,10,11,14,16,\xe2\x80\xa6. Output the k-th element of this sequence (the elements are numbered from 1)." 800
1559E "Mocha and Stars" "combinatorics,dp,fft,math,number theory" "Mocha wants to be an astrologer. There are n stars which can be seen in Zhijiang, and the brightness of the i-th star is ai. Mocha considers that these n stars form a constellation, and she uses (a1,a2,\xe2\x80\xa6,an) to show its state. A state is called mathematical if all of the following three conditions are satisfied:  For all i (1\xe2\x89\xa4i\xe2\x89\xa4n), ai is an integer in the range [li,ri]. n\xe2\x88\x91i=1ai\xe2\x89\xa4m. gcd(a1,a2,\xe2\x80\xa6,an)=1. Here, gcd(a1,a2,\xe2\x80\xa6,an) denotes the greatest common divisor (GCD) of integers a1,a2,\xe2\x80\xa6,an.Mocha is wondering how many different mathematical states of this constellation exist. Because the answer may be large, you must find it modulo 998244353.Two states (a1,a2,\xe2\x80\xa6,an) and (b1,b2,\xe2\x80\xa6,bn) are considered different if there exists i (1\xe2\x89\xa4i\xe2\x89\xa4n) such that ai\xe2\x89\xa0bi." 2200
1559D2 "Mocha and Diana (Hard Version)" "brute force,constructive algorithms,dfs and similar,dsu,graphs,greedy,trees,two pointers" "This is the hard version of the problem. The only difference between the two versions is the constraint on n. You can make hacks only if all versions of the problem are solved.A forest is an undirected graph without cycles (not necessarily connected).Mocha and Diana are friends in Zhijiang, both of them have a forest with nodes numbered from 1 to n, and they would like to add edges to their forests such that:   After adding edges, both of their graphs are still forests.  They add the same edges. That is, if an edge (u,v) is added to Mocha\'s forest, then an edge (u,v) is added to Diana\'s forest, and vice versa. Mocha and Diana want to know the maximum number of edges they can add, and which edges to add." 2500
1559D1 "Mocha and Diana (Easy Version)" "brute force,constructive algorithms,dsu,graphs,greedy,trees" "This is the easy version of the problem. The only difference between the two versions is the constraint on n. You can make hacks only if all versions of the problem are solved.A forest is an undirected graph without cycles (not necessarily connected).Mocha and Diana are friends in Zhijiang, both of them have a forest with nodes numbered from 1 to n, and they would like to add edges to their forests such that:   After adding edges, both of their graphs are still forests.  They add the same edges. That is, if an edge (u,v) is added to Mocha\'s forest, then an edge (u,v) is added to Diana\'s forest, and vice versa. Mocha and Diana want to know the maximum number of edges they can add, and which edges to add." 1400
1559C "Mocha and Hiking" "constructive algorithms,graphs" "The city where Mocha lives in is called Zhijiang. There are n+1 villages and 2n\xe2\x88\x921 directed roads in this city. There are two kinds of roads:  n\xe2\x88\x921 roads are from village i to village i+1, for all 1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921.  n roads can be described by a sequence a1,\xe2\x80\xa6,an. If ai=0, the i-th of these roads goes from village i to village n+1, otherwise it goes from village n+1 to village i, for all 1\xe2\x89\xa4i\xe2\x89\xa4n. Mocha plans to go hiking with Taki this weekend. To avoid the trip being boring, they plan to go through every village exactly once. They can start and finish at any villages. Can you help them to draw up a plan?" 1200
1559B "Mocha and Red and Blue" dp,greedy "As their story unravels, a timeless tale is told once again...Shirahime, a friend of Mocha\'s, is keen on playing the music game Arcaea and sharing Mocha interesting puzzles to solve. This day, Shirahime comes up with a new simple puzzle and wants Mocha to solve them. However, these puzzles are too easy for Mocha to solve, so she wants you to solve them and tell her the answers. The puzzles are described as follow.There are n squares arranged in a row, and each of them can be painted either red or blue.Among these squares, some of them have been painted already, and the others are blank. You can decide which color to paint on each blank square.Some pairs of adjacent squares may have the same color, which is imperfect. We define the imperfectness as the number of pairs of adjacent squares that share the same color.For example, the imperfectness of ""BRRRBBR"" is 3, with ""BB"" occurred once and ""RR"" occurred twice.Your goal is to minimize the imperfectness and print out the colors of the squares after painting." 900
1559A "Mocha and Math" "bitmasks,constructive algorithms,math" "Mocha is a young girl from high school. She has learned so much interesting knowledge from her teachers, especially her math teacher. Recently, Mocha is learning about binary system and very interested in bitwise operation.This day, Mocha got a sequence a of length n. In each operation, she can select an arbitrary interval [l,r] and for all values i (0\xe2\x89\xa4i\xe2\x89\xa4r\xe2\x88\x92l), replace al+i with al+i&ar\xe2\x88\x92i at the same time, where & denotes the bitwise AND operation. This operation can be performed any number of times.For example, if n=5, the array is [a1,a2,a3,a4,a5], and Mocha selects the interval [2,5], then the new array is [a1,a2&a5,a3&a4,a4&a3,a5&a2].Now Mocha wants to minimize the maximum value in the sequence. As her best friend, can you help her to get the answer?" 900
1558F "Strange Sort" "data structures,sortings" "You have a permutation: an array a=[a1,a2,\xe2\x80\xa6,an] of distinct integers from 1 to n. The length of the permutation n is odd.Consider the following algorithm of sorting the permutation in increasing order.A helper procedure of the algorithm, f(i), takes a single argument i (1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921) and does the following. If ai>ai+1, the values of ai and ai+1 are exchanged. Otherwise, the permutation doesn\'t change.The algorithm consists of iterations, numbered with consecutive integers starting with 1. On the i-th iteration, the algorithm does the following:   if i is odd, call f(1),f(3),\xe2\x80\xa6,f(n\xe2\x88\x922);  if i is even, call f(2),f(4),\xe2\x80\xa6,f(n\xe2\x88\x921). It can be proven that after a finite number of iterations the permutation will be sorted in increasing order.After how many iterations will this happen for the first time?" 3300
1558E "Down Below" "binary search,dfs and similar,graphs,greedy,meet-in-the-middle,shortest paths" "In a certain video game, the player controls a hero characterized by a single integer value: power.On the current level, the hero got into a system of n caves numbered from 1 to n, and m tunnels between them. Each tunnel connects two distinct caves. Any two caves are connected with at most one tunnel. Any cave can be reached from any other cave by moving via tunnels.The hero starts the level in cave 1, and every other cave contains a monster.The hero can move between caves via tunnels. If the hero leaves a cave and enters a tunnel, he must finish his movement and arrive at the opposite end of the tunnel.The hero can use each tunnel to move in both directions. However, the hero can not use the same tunnel twice in a row. Formally, if the hero has just moved from cave i to cave j via a tunnel, he can not head back to cave i immediately after, but he can head to any other cave connected to cave j with a tunnel.It is known that at least two tunnels come out of every cave, thus, the hero will never find himself in a dead end even considering the above requirement.To pass the level, the hero must beat the monsters in all the caves. When the hero enters a cave for the first time, he will have to fight the monster in it. The hero can beat the monster in cave i if and only if the hero\'s power is strictly greater than ai. In case of beating the monster, the hero\'s power increases by bi. If the hero can\'t beat the monster he\'s fighting, the game ends and the player loses.After the hero beats the monster in cave i, all subsequent visits to cave i won\'t have any consequences: the cave won\'t have any monsters, and the hero\'s power won\'t change either.Find the smallest possible power the hero must start the level with to be able to beat all the monsters and pass the level." 3000
1558D "Top-Notch Insertions" "combinatorics,data structures" "Consider the insertion sort algorithm used to sort an integer sequence [a1,a2,\xe2\x80\xa6,an] of length n in non-decreasing order.For each i in order from 2 to n, do the following. If ai\xe2\x89\xa5ai\xe2\x88\x921, do nothing and move on to the next value of i. Otherwise, find the smallest j such that ai<aj, shift the elements on positions from j to i\xe2\x88\x921 by one position to the right, and write down the initial value of ai to position j. In this case we\'ll say that we performed an insertion of an element from position i to position j.It can be noticed that after processing any i, the prefix of the sequence [a1,a2,\xe2\x80\xa6,ai] is sorted in non-decreasing order, therefore, the algorithm indeed sorts any sequence.For example, sorting [4,5,3,1,3] proceeds as follows:   i=2: a2\xe2\x89\xa5a1, do nothing;  i=3: j=1, insert from position 3 to position 1: [3,4,5,1,3];  i=4: j=1, insert from position 4 to position 1: [1,3,4,5,3];  i=5: j=3, insert from position 5 to position 3: [1,3,3,4,5]. You are given an integer n and a list of m integer pairs (xi,yi). We are interested in sequences such that if you sort them using the above algorithm, exactly m insertions will be performed: first from position x1 to position y1, then from position x2 to position y2, ..., finally, from position xm to position ym.How many sequences of length n consisting of (not necessarily distinct) integers between 1 and n, inclusive, satisfy the above condition? Print this number modulo 998244353." 2600
1558C "Bottom-Tier Reversals" "constructive algorithms,greedy" "You have a permutation: an array a=[a1,a2,\xe2\x80\xa6,an] of distinct integers from 1 to n. The length of the permutation n is odd.You need to sort the permutation in increasing order.In one step, you can choose any prefix of the permutation with an odd length and reverse it. Formally, if a=[a1,a2,\xe2\x80\xa6,an], you can choose any odd integer p between 1 and n, inclusive, and set a to [ap,ap\xe2\x88\x921,\xe2\x80\xa6,a1,ap+1,ap+2,\xe2\x80\xa6,an].Find a way to sort a using no more than 5n2 reversals of the above kind, or determine that such a way doesn\'t exist. The number of reversals doesn\'t have to be minimized." 2000
1558B "Up the Strip" "brute force,dp,math,number theory,two pointers" "Note that the memory limit in this problem is lower than in others.You have a vertical strip with n cells, numbered consecutively from 1 to n from top to bottom.You also have a token that is initially placed in cell n. You will move the token up until it arrives at cell 1.Let the token be in cell x>1 at some moment. One shift of the token can have either of the following kinds:   Subtraction: you choose an integer y between 1 and x\xe2\x88\x921, inclusive, and move the token from cell x to cell x\xe2\x88\x92y.  Floored division: you choose an integer z between 2 and x, inclusive, and move the token from cell x to cell \xe2\x8c\x8axz\xe2\x8c\x8b (x divided by z rounded down). Find the number of ways to move the token from cell n to cell 1 using one or more shifts, and print it modulo m. Note that if there are several ways to move the token from one cell to another in one shift, all these ways are considered distinct (check example explanation for a better understanding)." 1900
1558A "Charmed by the Game" "brute force,math" "Alice and Borys are playing tennis.A tennis match consists of games. In each game, one of the players is serving and the other one is receiving.Players serve in turns: after a game where Alice is serving follows a game where Borys is serving, and vice versa.Each game ends with a victory of one of the players. If a game is won by the serving player, it\'s said that this player holds serve. If a game is won by the receiving player, it\'s said that this player breaks serve.It is known that Alice won a games and Borys won b games during the match. It is unknown who served first and who won which games.Find all values of k such that exactly k breaks could happen during the match between Alice and Borys in total." 1300
1557E "Assiut Chess" "brute force,constructive algorithms,interactive" "This is an interactive problem.ICPC Assiut Community decided to hold a unique chess contest, and you were chosen to control a queen and hunt down the hidden king, while a member of ICPC Assiut Community controls this king.You compete on an 8\xc3\x978 chessboard, the rows are numerated from top to bottom, and the columns are numerated left to right, and the cell in row x and column y is denoted as (x,y).In one turn you can move the queen to any of the squares on the same horizontal line, vertical line, or any of the diagonals. For example, if the queen was on square (4, 5), you can move to (q1, 5), (4, q1), (q1, 9\xe2\x88\x92q1), or (q2, q2+1) where (1\xe2\x89\xa4q1\xe2\x89\xa48, q1\xe2\x89\xa04, 1\xe2\x89\xa4q2\xe2\x89\xa47, q2\xe2\x89\xa04). Note that the queen cannot stay on its current cell.   In one turn, the king can move ""Right"", ""Left"", ""Up"", ""Down"", ""Down-Right"", ""Down-Left"", ""Up-Left"", or ""Up-Right"" such that he doesn\'t get out of the board. The king cannot move into a cell that is on the same row, column or diagonal with the queen (including the position of the queen itself). For example, if the king was on square (4, 5), he can move to (4+k1, 5+k2) where (\xe2\x88\x921\xe2\x89\xa4k1,k2\xe2\x89\xa41, (k1,k2)\xe2\x89\xa0(0,0)).   At the start of the game, you should place the queen at any location on the board, and this is done once per game. After that the king is secretly placed at any cell different from the queen\'s location. You do not know the position of the king. Then, the king and the queen take turns with the king moving first. The king moves to one of the possible directions (""Right"", ""Down"", ""Up-Left"", etc.), and you are only given the direction it moves to. After that, you should move your queen by declaring the square to which your queen will move. The game follows like this until you win the game or run out of moves.You win if the king has no valid moves. You lose if after 130 moves of the queen the king still has valid moves." 2800
1557D "Ezzat and Grid" "data structures,dp,greedy" "Moamen was drawing a grid of n rows and 109 columns containing only digits 0 and 1. Ezzat noticed what Moamen was drawing and became interested in the minimum number of rows one needs to remove to make the grid beautiful.A grid is beautiful if and only if for every two consecutive rows there is at least one column containing 1 in these two rows.Ezzat will give you the number of rows n, and m segments of the grid that contain digits 1. Every segment is represented with three integers i, l, and r, where i represents the row number, and l and r represent the first and the last column of the segment in that row.For example, if n=3, m=6, and the segments are (1,1,1), (1,7,8), (2,7,7), (2,15,15), (3,1,1), (3,15,15), then the grid is:  Your task is to tell Ezzat the minimum number of rows that should be removed to make the grid beautiful." 2200
1557C "Moamen and XOR" bitmasks,combinatorics,dp,math,matrices "Moamen and Ezzat are playing a game. They create an array a of n non-negative integers where every element is less than 2k.Moamen wins if a1&a2&a3&\xe2\x80\xa6&an\xe2\x89\xa5a1\xe2\x8a\x95a2\xe2\x8a\x95a3\xe2\x8a\x95\xe2\x80\xa6\xe2\x8a\x95an.Here & denotes the bitwise AND operation, and \xe2\x8a\x95 denotes the bitwise XOR operation.Please calculate the number of winning for Moamen arrays a.As the result may be very large, print the value modulo 1000000007 (109+7)." 1700
1557B "Moamen and k-subarrays" greedy,sortings "Moamen has an array of n distinct integers. He wants to sort that array in non-decreasing order by doing the following operations in order exactly once:  Split the array into exactly k non-empty subarrays such that each element belongs to exactly one subarray.  Reorder these subarrays arbitrary.  Merge the subarrays in their new order. A sequence a is a subarray of a sequence b if a can be obtained from b by deletion of several (possibly, zero or all) elements from the beginning and several (possibly, zero or all) elements from the end.Can you tell Moamen if there is a way to sort the array in non-decreasing order using the operations written above?" 1100
1557A "Ezzat and Two Subsequences" "brute force,math,sortings" "Ezzat has an array of n integers (maybe negative). He wants to split it into two non-empty subsequences a and b, such that every element from the array belongs to exactly one subsequence, and the value of f(a)+f(b) is the maximum possible value, where f(x) is the average of the subsequence x. A sequence x is a subsequence of a sequence y if x can be obtained from y by deletion of several (possibly, zero or all) elements.The average of a subsequence is the sum of the numbers of this subsequence divided by the size of the subsequence.For example, the average of [1,5,6] is (1+5+6)/3=12/3=4, so f([1,5,6])=4." 800
1556H "DIY Tree" graphs,greedy,math,probabilities "William really likes puzzle kits. For one of his birthdays, his friends gifted him a complete undirected edge-weighted graph consisting of n vertices.He wants to build a spanning tree of this graph, such that for the first k vertices the following condition is satisfied: the degree of a vertex with index i does not exceed di. Vertices from k+1 to n may have any degree.William wants you to find the minimum weight of a spanning tree that satisfies all the conditions.A spanning tree is a subset of edges of a graph that forms a tree on all n vertices of the graph. The weight of a spanning tree is defined as the sum of weights of all the edges included in a spanning tree." 3300
1556G "Gates to Another World" "bitmasks,data structures,dsu,two pointers" "As mentioned previously William really likes playing video games. In one of his favorite games, the player character is in a universe where every planet is designated by a binary number from 0 to 2n\xe2\x88\x921. On each planet, there are gates that allow the player to move from planet i to planet j if the binary representations of i and j differ in exactly one bit.William wants to test you and see how you can handle processing the following queries in this game universe:  Destroy planets with numbers from l to r inclusively. These planets cannot be moved to anymore. Figure out if it is possible to reach planet b from planet a using some number of planetary gates. It is guaranteed that the planets a and b are not destroyed." 3300
1556F "Sports Betting" bitmasks,combinatorics,dp,graphs,math,probabilities "William is not only interested in trading but also in betting on sports matches. n teams participate in each match. Each team is characterized by strength ai. Each two teams i<j play with each other exactly once. Team i wins with probability aiai+aj and team j wins with probability ajai+aj.The team is called a winner if it directly or indirectly defeated all other teams. Team a defeated (directly or indirectly) team b if there is a sequence of teams c1, c2, ... ck such that c1=a, ck=b and team ci defeated team ci+1 for all i from 1 to k\xe2\x88\x921. Note that it is possible that team a defeated team b and in the same time team b defeated team a.William wants you to find the expected value of the number of winners." 2500
1556E Equilibrium "data structures,dp,greedy" "William has two arrays aa and bb, each consisting of nn items.For some segments l..rl..r of these arrays William wants to know if it is possible to equalize the values of items in these segments using a balancing operation. Formally, the values are equalized if for each ii from ll to rr holds ai=biai=bi.To perform a balancing operation an even number of indices must be selected, such that l\xe2\x89\xa4pos1<pos2<\xe2\x8b\xaf<posk\xe2\x89\xa4rl\xe2\x89\xa4pos1<pos2<\xe2\x8b\xaf<posk\xe2\x89\xa4r. Next the items of array a at positions pos1,pos3,pos5,\xe2\x80\xa6pos1,pos3,pos5,\xe2\x80\xa6 get incremented by one and the items of array b at positions pos2,pos4,pos6,\xe2\x80\xa6pos2,pos4,pos6,\xe2\x80\xa6 get incremented by one.William wants to find out if it is possible to equalize the values of elements in two arrays for each segment using some number of balancing operations, and what is the minimal number of operations required for that. Note that for each segment the operations are performed independently." 2200
1556D "Take a Guess" "bitmasks,constructive algorithms,interactive,math" "This is an interactive taskWilliam has a certain sequence of integers a1,a2,\xe2\x80\xa6,an in his mind, but due to security concerns, he does not want to reveal it to you completely. William is ready to respond to no more than 2\xe2\x8b\x85n of the following questions:  What is the result of a bitwise AND of two items with indices i and j (i\xe2\x89\xa0j)  What is the result of a bitwise OR of two items with indices i and j (i\xe2\x89\xa0j) You can ask William these questions and you need to find the k-th smallest number of the sequence.Formally the k-th smallest number is equal to the number at the k-th place in a 1-indexed array sorted in non-decreasing order. For example in array [5,3,3,10,1] 4th smallest number is equal to 5, and 2nd and 3rd are 3." 1800
1556C "Compressed Bracket Sequence" "brute force,implementation" "William has a favorite bracket sequence. Since his favorite sequence is quite big he provided it to you as a sequence of positive integers c1,c2,\xe2\x80\xa6,cn where ci is the number of consecutive brackets ""("" if i is an odd number or the number of consecutive brackets "")"" if i is an even number.For example for a bracket sequence ""((())()))"" a corresponding sequence of numbers is [3,2,1,3].You need to find the total number of continuous subsequences (subsegments) [l,r] (l\xe2\x89\xa4r) of the original bracket sequence, which are regular bracket sequences.A bracket sequence is called regular if it is possible to obtain correct arithmetic expression by inserting characters ""+"" and ""1"" into this sequence. For example, sequences ""(())()"", ""()"" and ""(()(()))"" are regular, while "")("", ""(()"" and ""(()))("" are not." 1800
1556B "Take Your Places!" implementation "William has an array of n integers a1,a2,\xe2\x80\xa6,an. In one move he can swap two neighboring items. Two items ai and aj are considered neighboring if the condition |i\xe2\x88\x92j|=1 is satisfied.William wants you to calculate the minimal number of swaps he would need to perform to make it so that the array does not contain two neighboring items with the same parity." 1300
1556A "A Variety of Operations" math "William has two numbers a and b initially both equal to zero. William mastered performing three different operations with them quickly. Before performing each operation some positive integer k is picked, which is then used to perform one of the following operations: (note, that for each operation you can choose a new positive integer k)  add number k to both a and b, or  add number k to a and subtract k from b, or  add number k to b and subtract k from a. Note that after performing operations, numbers a and b may become negative as well.William wants to find out the minimal number of operations he would have to perform to make a equal to his favorite number c and b equal to his second favorite number d." 800
1555F "Good Graph" "data structures,dsu,graphs,trees" "You have an undirected graph consisting of n vertices with weighted edges.A simple cycle is a cycle of the graph without repeated vertices. Let the weight of the cycle be the XOR of weights of edges it consists of.Let\'s say the graph is good if all its simple cycles have weight 1. A graph is bad if it\'s not good.Initially, the graph is empty. Then q queries follow. Each query has the next type:   u v x \xe2\x80\x94 add edge between vertices u and v of weight x if it doesn\'t make the graph bad. For each query print, was the edge added or not." 2700
1555E "Boring Segments" "data structures,sortings,trees,two pointers" "You are given n segments on a number line, numbered from 1 to n. The i-th segments covers all integer points from li to ri and has a value wi.You are asked to select a subset of these segments (possibly, all of them). Once the subset is selected, it\'s possible to travel between two integer points if there exists a selected segment that covers both of them. A subset is good if it\'s possible to reach point m starting from point 1 in arbitrary number of moves.The cost of the subset is the difference between the maximum and the minimum values of segments in it. Find the minimum cost of a good subset.In every test there exists at least one good subset." 2100
1555D "Say No to Palindromes" "brute force,constructive algorithms,dp,strings" "Let\'s call the string beautiful if it does not contain a substring of length at least 2, which is a palindrome. Recall that a palindrome is a string that reads the same way from the first character to the last and from the last character to the first. For example, the strings a, bab, acca, bcabcbacb are palindromes, but the strings ab, abbbaa, cccb are not.Let\'s define cost of a string as the minimum number of operations so that the string becomes beautiful, if in one operation it is allowed to change any character of the string to one of the first 3 letters of the Latin alphabet (in lowercase).You are given a string s of length n, each character of the string is one of the first 3 letters of the Latin alphabet (in lowercase).You have to answer m queries \xe2\x80\x94 calculate the cost of the substring of the string s from li-th to ri-th position, inclusive." 1600
1555C "Coin Rows" "brute force,constructive algorithms,dp,implementation" "Alice and Bob are playing a game on a matrix, consisting of 2 rows and m columns. The cell in the i-th row in the j-th column contains ai,j coins in it.Initially, both Alice and Bob are standing in a cell (1,1). They are going to perform a sequence of moves to reach a cell (2,m).The possible moves are:   Move right \xe2\x80\x94 from some cell (x,y) to (x,y+1);  Move down \xe2\x80\x94 from some cell (x,y) to (x+1,y). First, Alice makes all her moves until she reaches (2,m). She collects the coins in all cells she visit (including the starting cell).When Alice finishes, Bob starts his journey. He also performs the moves to reach (2,m) and collects the coins in all cells that he visited, but Alice didn\'t.The score of the game is the total number of coins Bob collects.Alice wants to minimize the score. Bob wants to maximize the score. What will the score of the game be if both players play optimally?" 1300
1555B "Two Tables" "brute force" "You have an axis-aligned rectangle room with width W and height H, so the lower left corner is in point (0,0) and the upper right corner is in (W,H).There is a rectangular table standing in this room. The sides of the table are parallel to the walls, the lower left corner is in (x1,y1), and the upper right corner in (x2,y2).You want to place another rectangular table in this room with width w and height h with the width of the table parallel to the width of the room.The problem is that sometimes there is not enough space to place the second table without intersecting with the first one (there are no problems with tables touching, though).You can\'t rotate any of the tables, but you can move the first table inside the room.   Example of how you may move the first table. What is the minimum distance you should move the first table to free enough space for the second one?" 1300
1555A PizzaForces "brute force,math" "PizzaForces is Petya\'s favorite pizzeria. PizzaForces makes and sells pizzas of three sizes: small pizzas consist of 6 slices, medium ones consist of 8 slices, and large pizzas consist of 10 slices each. Baking them takes 15, 20 and 25 minutes, respectively.Petya\'s birthday is today, and n of his friends will come, so he decided to make an order from his favorite pizzeria. Petya wants to order so much pizza that each of his friends gets at least one slice of pizza. The cooking time of the order is the total baking time of all the pizzas in the order.Your task is to determine the minimum number of minutes that is needed to make pizzas containing at least n slices in total. For example:   if 12 friends come to Petya\'s birthday, he has to order pizzas containing at least 12 slices in total. He can order two small pizzas, containing exactly 12 slices, and the time to bake them is 30 minutes;  if 15 friends come to Petya\'s birthday, he has to order pizzas containing at least 15 slices in total. He can order a small pizza and a large pizza, containing 16 slices, and the time to bake them is 40 minutes;  if 300 friends come to Petya\'s birthday, he has to order pizzas containing at least 300 slices in total. He can order 15 small pizzas, 10 medium pizzas and 13 large pizzas, in total they contain 15\xe2\x8b\x856+10\xe2\x8b\x858+13\xe2\x8b\x8510=300 slices, and the total time to bake them is 15\xe2\x8b\x8515+10\xe2\x8b\x8520+13\xe2\x8b\x8525=750 minutes;  if only one friend comes to Petya\'s birthday, he can order a small pizza, and the time to bake it is 15 minutes." 900
1554E You "dfs and similar,dp,math,number theory" "You are given a tree with n nodes. As a reminder, a tree is a connected undirected graph without cycles.Let a1,a2,\xe2\x80\xa6,an be a sequence of integers. Perform the following operation exactly n times:   Select an unerased node u. Assign au:= number of unerased nodes adjacent to u. Then, erase the node u along with all edges that have it as an endpoint. For each integer k from 1 to n, find the number, modulo 998244353, of different sequences a1,a2,\xe2\x80\xa6,an that satisfy the following conditions:  it is possible to obtain a by performing the aforementioned operations exactly n times in some order.  gcd(a1,a2,\xe2\x80\xa6,an)=k. Here, gcd means the greatest common divisor of the elements in a." 2600
1554D Diane "constructive algorithms,greedy,strings" "You are given an integer n. Find any string s of length n consisting only of English lowercase letters such that each non-empty substring of s occurs in s an odd number of times. If there are multiple such strings, output any. It can be shown that such string always exists under the given constraints.A string a is a substring of a string b if a can be obtained from b by deletion of several (possibly, zero or all) characters from the beginning and several (possibly, zero or all) characters from the end." 1800
1554C Mikasa "binary search,bitmasks,greedy,implementation" "You are given two integers n and m. Find the MEX of the sequence n\xe2\x8a\x950,n\xe2\x8a\x951,\xe2\x80\xa6,n\xe2\x8a\x95m. Here, \xe2\x8a\x95 is the bitwise XOR operator.MEX of the sequence of non-negative integers is the smallest non-negative integer that doesn\'t appear in this sequence. For example, MEX(0,1,2,4)=3, and MEX(1,2021)=0." 1800
1554B Cobb "bitmasks,brute force,greedy,math" "You are given n integers a1,a2,\xe2\x80\xa6,an and an integer k. Find the maximum value of i\xe2\x8b\x85j\xe2\x88\x92k\xe2\x8b\x85(ai|aj) over all pairs (i,j) of integers with 1\xe2\x89\xa4i<j\xe2\x89\xa4n. Here, | is the bitwise OR operator." 1700
1554A Cherry greedy "You are given n integers a1,a2,\xe2\x80\xa6,an. Find the maximum value of max(al,al+1,\xe2\x80\xa6,ar)\xe2\x8b\x85min(al,al+1,\xe2\x80\xa6,ar) over all pairs (l,r) of integers for which 1\xe2\x89\xa4l<r\xe2\x89\xa4n." 800
1553I Stairs "combinatorics,divide and conquer,dp,fft,math" "For a permutation p of numbers 1 through n, we define a stair array a as follows: ai is length of the longest segment of permutation which contains position i and is made of consecutive values in sorted order: [x,x+1,\xe2\x80\xa6,y\xe2\x88\x921,y] or [y,y\xe2\x88\x921,\xe2\x80\xa6,x+1,x] for some x\xe2\x89\xa4y. For example, for permutation p=[4,1,2,3,7,6,5] we have a=[1,3,3,3,3,3,3]. You are given the stair array a. Your task is to calculate the number of permutations which have stair array equal to a. Since the number can be big, compute it modulo 998244353. Note that this number can be equal to zero." 3400
1553H "XOR and Distance" "bitmasks,divide and conquer,trees" "You are given an array a consisting of n distinct elements and an integer k. Each element in the array is a non-negative integer not exceeding 2k\xe2\x88\x921.Let\'s define the XOR distance for a number x as the value of f(x)=nmini=1nminj=i+1|(ai\xe2\x8a\x95x)\xe2\x88\x92(aj\xe2\x8a\x95x)|,where \xe2\x8a\x95 denotes the bitwise XOR operation.For every integer x from 0 to 2k\xe2\x88\x921, you have to calculate f(x)." 2900
1553G "Common Divisor Graph" "brute force,constructive algorithms,dsu,graphs,hashing,math,number theory" "Consider a sequence of distinct integers a1,\xe2\x80\xa6,an, each representing one node of a graph. There is an edge between two nodes if the two values are not coprime, i. e. they have a common divisor greater than 1.There are q queries, in each query, you want to get from one given node as to another at. In order to achieve that, you can choose an existing value ai and create new value an+1=ai\xe2\x8b\x85(1+ai), with edges to all values that are not coprime with an+1. Also, n gets increased by 1. You can repeat that operation multiple times, possibly making the sequence much longer and getting huge or repeated values. What\'s the minimum possible number of newly created nodes so that at is reachable from as?Queries are independent. In each query, you start with the initial sequence a given in the input." 2700
1553F "Pairwise Modulo" "data structures,math" "You have an array a consisting of n distinct positive integers, numbered from 1 to n. Define pk as pk=\xe2\x88\x911\xe2\x89\xa4i,j\xe2\x89\xa4kaimodaj, where xmody denotes the remainder when x is divided by y. You have to find and print p1,p2,\xe2\x80\xa6,pn." 2300
1553E "Permutation Shift" "brute force,combinatorics,constructive algorithms,dfs and similar,dsu,graphs,math" "An identity permutation of length n is an array [1,2,3,\xe2\x80\xa6,n].We performed the following operations to an identity permutation of length n:  firstly, we cyclically shifted it to the right by k positions, where k is unknown to you (the only thing you know is that 0\xe2\x89\xa4k\xe2\x89\xa4n\xe2\x88\x921). When an array is cyclically shifted to the right by k positions, the resulting array is formed by taking k last elements of the original array (without changing their relative order), and then appending n\xe2\x88\x92k first elements to the right of them (without changing relative order of the first n\xe2\x88\x92k elements as well). For example, if we cyclically shift the identity permutation of length 6 by 2 positions, we get the array [5,6,1,2,3,4];  secondly, we performed the following operation at most m times: pick any two elements of the array and swap them. You are given the values of n and m, and the resulting array. Your task is to find all possible values of k in the cyclic shift operation." 2100
1553D Backspace "dp,greedy,strings,two pointers" "You are given two strings s and t, both consisting of lowercase English letters. You are going to type the string s character by character, from the first character to the last one.When typing a character, instead of pressing the button corresponding to it, you can press the ""Backspace"" button. It deletes the last character you have typed among those that aren\'t deleted yet (or does nothing if there are no characters in the current string). For example, if s is ""abcbd"" and you press Backspace instead of typing the first and the fourth characters, you will get the string ""bd"" (the first press of Backspace deletes no character, and the second press deletes the character \'c\'). Another example, if s is ""abcaa"" and you press Backspace instead of the last two letters, then the resulting text is ""a"".Your task is to determine whether you can obtain the string t, if you type the string s and press ""Backspace"" instead of typing several (maybe zero) characters of s." 1500
1553C Penalty "bitmasks,brute force,dp,greedy" "Consider a simplified penalty phase at the end of a football match.A penalty phase consists of at most 10 kicks, the first team takes the first kick, the second team takes the second kick, then the first team takes the third kick, and so on. The team that scores more goals wins; if both teams score the same number of goals, the game results in a tie (note that it goes against the usual football rules). The penalty phase is stopped if one team has scored more goals than the other team could reach with all of its remaining kicks. For example, if after the 7-th kick the first team has scored 1 goal, and the second team has scored 3 goals, the penalty phase ends \xe2\x80\x94 the first team cannot reach 3 goals.You know which player will be taking each kick, so you have your predictions for each of the 10 kicks. These predictions are represented by a string s consisting of 10 characters. Each character can either be 1, 0, or ?. This string represents your predictions in the following way:  if si is 1, then the i-th kick will definitely score a goal;  if si is 0, then the i-th kick definitely won\'t score a goal;  if si is ?, then the i-th kick could go either way. Based on your predictions, you have to calculate the minimum possible number of kicks there can be in the penalty phase (that means, the earliest moment when the penalty phase is stopped, considering all possible ways it could go). Note that the referee doesn\'t take into account any predictions when deciding to stop the penalty phase \xe2\x80\x94 you may know that some kick will/won\'t be scored, but the referee doesn\'t." 1200
1553B "Reverse String" "brute force,dp,hashing,implementation,strings" "You have a string s and a chip, which you can place onto any character of this string. After placing the chip, you move it to the right several (maybe zero) times, i. e. you perform the following operation several times: if the current position of the chip is i, you move it to the position i+1. Of course, moving the chip to the right is impossible if it is already in the last position.After moving the chip to the right, you move it to the left several (maybe zero) times, i. e. you perform the following operation several times: if the current position of the chip is i, you move it to the position i\xe2\x88\x921. Of course, moving the chip to the left is impossible if it is already in the first position.When you place a chip or move it, you write down the character where the chip ends up after your action. For example, if s is abcdef, you place the chip onto the 3-rd character, move it to the right 2 times and then move it to the left 3 times, you write down the string cdedcb.You are given two strings s and t. Your task is to determine whether it\'s possible to perform the described operations with s so that you write down the string t as a result." 1300
1553A "Digits Sum" "math,number theory" "Let\'s define S(x) to be the sum of digits of number x written in decimal system. For example, S(5)=5, S(10)=1, S(322)=7.We will call an integer x interesting if S(x+1)<S(x). In each test you will be given one integer n. Your task is to calculate the number of integers x such that 1\xe2\x89\xa4x\xe2\x89\xa4n and x is interesting." 800
1552I "Organizing a Music Festival" "dfs and similar,math" "You are the organizer of the famous ""Zurich Music Festival"". There will be n singers who will perform at the festival, identified by the integers 1, 2, \xe2\x80\xa6, n. You must choose in which order they are going to perform on stage. You have m friends and each of them has a set of favourite singers. More precisely, for each 1\xe2\x89\xa4i\xe2\x89\xa4m, the i-th friend likes singers si,1,si,2,\xe2\x80\xa6,si,qi.A friend of yours is happy if the singers he likes perform consecutively (in an arbitrary order). An ordering of the singers is valid if it makes all your friends happy.Compute the number of valid orderings modulo 998244353." 3400
1552H "Guess the Perimeter" "binary search,interactive,number theory" "Let us call a point of the plane admissible if its coordinates are positive integers less than or equal to 200.There is an invisible rectangle such that:   its vertices are all admissible;  its sides are parallel to the coordinate axes;  its area is strictly positive.  Your task is to guess the perimeter of this rectangle.In order to guess it, you may ask at most 4 queries. In each query, you choose a nonempty subset of the admissible points and you are told how many of the chosen points are inside or on the boundary of the invisible rectangle." 3300
1552G "A Serious Referee" "bitmasks,brute force,dfs and similar,sortings" "Andrea has come up with what he believes to be a novel sorting algorithm for arrays of length n. The algorithm works as follows.Initially there is an array of n integers a1,a2,\xe2\x80\xa6,an. Then, k steps are executed.For each 1\xe2\x89\xa4i\xe2\x89\xa4k, during the i-th step the subsequence of the array a with indexes ji,1<ji,2<\xe2\x8b\xaf<ji,qi is sorted, without changing the values with the remaining indexes. So, the subsequence aji,1,aji,2,\xe2\x80\xa6,aji,qi is sorted and all other elements of a are left untouched.Andrea, being eager to share his discovery with the academic community, sent a short paper describing his algorithm to the journal ""Annals of Sorting Algorithms"" and you are the referee of the paper (that is, the person who must judge the correctness of the paper). You must decide whether Andrea\'s algorithm is correct, that is, if it sorts any array a of n integers." 3000
1552F Telepanting "binary search,data structures,dp,sortings" "An ant moves on the real line with constant speed of 1 unit per second. It starts at 0 and always moves to the right (so its position increases by 1 each second).There are n portals, the i-th of which is located at position xi and teleports to position yi<xi. Each portal can be either active or inactive. The initial state of the i-th portal is determined by si: if si=0 then the i-th portal is initially inactive, if si=1 then the i-th portal is initially active. When the ant travels through a portal (i.e., when its position coincides with the position of a portal):   if the portal is inactive, it becomes active (in this case the path of the ant is not affected);  if the portal is active, it becomes inactive and the ant is instantly teleported to the position yi, where it keeps on moving as normal. How long (from the instant it starts moving) does it take for the ant to reach the position xn+1? It can be shown that this happens in a finite amount of time. Since the answer may be very large, compute it modulo 998244353." 2200
1552E "Colors and Intervals" "constructive algorithms,data structures,greedy,sortings" "The numbers 1,2,\xe2\x80\xa6,n\xe2\x8b\x85k are colored with n colors. These colors are indexed by 1,2,\xe2\x80\xa6,n. For each 1\xe2\x89\xa4i\xe2\x89\xa4n, there are exactly k numbers colored with color i.Let [a,b] denote the interval of integers between a and b inclusive, that is, the set {a,a+1,\xe2\x80\xa6,b}. You must choose n intervals [a1,b1],[a2,b2],\xe2\x80\xa6,[an,bn] such that:   for each 1\xe2\x89\xa4i\xe2\x89\xa4n, it holds 1\xe2\x89\xa4ai<bi\xe2\x89\xa4n\xe2\x8b\x85k;  for each 1\xe2\x89\xa4i\xe2\x89\xa4n, the numbers ai and bi are colored with color i;  each number 1\xe2\x89\xa4x\xe2\x89\xa4n\xe2\x8b\x85k belongs to at most \xe2\x8c\x88nk\xe2\x88\x921\xe2\x8c\x89 intervals. One can show that such a family of intervals always exists under the given constraints." 2300
1552D "Array Differentiation" "bitmasks,brute force,constructive algorithms,dfs and similar,dp,graphs,math" "You are given a sequence of n integers a1,a2,\xe2\x80\xa6,an.Does there exist a sequence of n integers b1,b2,\xe2\x80\xa6,bn such that the following property holds?  For each 1\xe2\x89\xa4i\xe2\x89\xa4n, there exist two (not necessarily distinct) indices j and k (1\xe2\x89\xa4j,k\xe2\x89\xa4n) such that ai=bj\xe2\x88\x92bk." 1800
1552C "Maximize the Intersections" "combinatorics,constructive algorithms,geometry,greedy,sortings" "On a circle lie 2n distinct points, with the following property: however you choose 3 chords that connect 3 disjoint pairs of points, no point strictly inside the circle belongs to all 3 chords. The points are numbered 1,2,\xe2\x80\xa6,2n in clockwise order.Initially, k chords connect k pairs of points, in such a way that all the 2k endpoints of these chords are distinct.You want to draw n\xe2\x88\x92k additional chords that connect the remaining 2(n\xe2\x88\x92k) points (each point must be an endpoint of exactly one chord).In the end, let x be the total number of intersections among all n chords. Compute the maximum value that x can attain if you choose the n\xe2\x88\x92k chords optimally.Note that the exact position of the 2n points is not relevant, as long as the property stated in the first paragraph holds." 1800
1552B "Running for Gold" combinatorics,graphs,greedy,sortings "The Olympic Games have just started and Federico is eager to watch the marathon race.There will be n athletes, numbered from 1 to n, competing in the marathon, and all of them have taken part in 5 important marathons, numbered from 1 to 5, in the past. For each 1\xe2\x89\xa4i\xe2\x89\xa4n and 1\xe2\x89\xa4j\xe2\x89\xa45, Federico remembers that athlete i ranked ri,j-th in marathon j (e.g., r2,4=3 means that athlete 2 was third in marathon 4).Federico considers athlete x superior to athlete y if athlete x ranked better than athlete y in at least 3 past marathons, i.e., rx,j<ry,j for at least 3 distinct values of j.Federico believes that an athlete is likely to get the gold medal at the Olympics if he is superior to all other athletes.Find any athlete who is likely to get the gold medal (that is, an athlete who is superior to all other athletes), or determine that there is no such athlete." 1500
1552A "Subsequence Permutation" sortings,strings "A string s of length n, consisting of lowercase letters of the English alphabet, is given.You must choose some number k between 0 and n. Then, you select k characters of s and permute them however you want. In this process, the positions of the other n\xe2\x88\x92k characters remain unchanged. You have to perform this operation exactly once.For example, if s=""andrea"", you can choose the k=4 characters ""a_d_ea"" and permute them into ""d_e_aa"" so that after the operation the string becomes ""dneraa"".Determine the minimum k so that it is possible to sort s alphabetically (that is, after the operation its characters appear in alphabetical order)." 800
1551F "Equidistant Vertices" "brute force,combinatorics,dfs and similar,dp,trees" "A tree is an undirected connected graph without cycles.You are given a tree of n vertices. Find the number of ways to choose exactly k vertices in this tree (i.\xe2\x80\x89e. a k-element subset of vertices) so that all pairwise distances between the selected vertices are equal (in other words, there exists an integer c such that for all u,v (u\xe2\x89\xa0v, u,v are in selected vertices) du,v=c, where du,v is the distance from u to v).Since the answer may be very large, you need to output it modulo 109+7." 2200
1551E "Fixed Points" "binary search,brute force,dp" "Consider a sequence of integers a1,a2,\xe2\x80\xa6,an. In one move, you can select any element of the sequence and delete it. After an element is deleted, all elements to the right are shifted to the left by 1 position, so there are no empty spaces in the sequence. So after you make a move, the sequence\'s length decreases by 1. The indices of the elements after the move are recalculated.E.\xe2\x80\x89g. let the sequence be a=[3,2,2,1,5]. Let\'s select the element a3=2 in a move. Then after the move the sequence will be equal to a=[3,2,1,5], so the 3-rd element of the new sequence will be a3=1 and the 4-th element will be a4=5.You are given a sequence a1,a2,\xe2\x80\xa6,an and a number k. You need to find the minimum number of moves you have to make so that in the resulting sequence there will be at least k elements that are equal to their indices, i.\xe2\x80\x89e. the resulting sequence b1,b2,\xe2\x80\xa6,bm will contain at least k indices i such that bi=i." 2000
1551D2 "Domino (hard version)" "constructive algorithms,implementation,math" "The only difference between this problem and D1 is that you don\'t have to provide the way to construct the answer in D1, but you have to do it in this problem.There\'s a table of n\xc3\x97m cells (n rows and m columns). The value of n\xe2\x8b\x85m is even.A domino is a figure that consists of two cells having a common side. It may be horizontal (one of the cells is to the right of the other) or vertical (one of the cells is above the other).You need to place nm2 dominoes on the table so that exactly k of them are horizontal and all the other dominoes are vertical. The dominoes cannot overlap and must fill the whole table." 2100
1551D1 "Domino (easy version)" "constructive algorithms,math" "The only difference between this problem and D2 is that you don\'t have to provide the way to construct the answer in this problem, but you have to do it in D2.There\'s a table of n\xc3\x97m cells (n rows and m columns). The value of n\xe2\x8b\x85m is even.A domino is a figure that consists of two cells having a common side. It may be horizontal (one of the cells is to the right of the other) or vertical (one of the cells is above the other).You need to find out whether it is possible to place nm2 dominoes on the table so that exactly k of them are horizontal and all the other dominoes are vertical. The dominoes cannot overlap and must fill the whole table." 1700
1551C "Interesting Story" greedy,sortings,strings "Stephen Queen wants to write a story. He is a very unusual writer, he uses only letters \'a\', \'b\', \'c\', \'d\' and \'e\'!To compose a story, Stephen wrote out n words consisting of the first 5 lowercase letters of the Latin alphabet. He wants to select the maximum number of words to make an interesting story.Let a story be a sequence of words that are not necessarily different. A story is called interesting if there exists a letter which occurs among all words of the story more times than all other letters together.For example, the story consisting of three words ""bac"", ""aaada"", ""e"" is interesting (the letter \'a\' occurs 5 times, all other letters occur 4 times in total). But the story consisting of two words ""aba"", ""abcde"" is not (no such letter that it occurs more than all other letters in total).You are given a sequence of n words consisting of letters \'a\', \'b\', \'c\', \'d\' and \'e\'. Your task is to choose the maximum number of them to make an interesting story. If there\'s no way to make a non-empty story, output 0." 1500
1551B2 "Wonderful Coloring - 2" "binary search,constructive algorithms,data structures,greedy" "This problem is an extension of the problem ""Wonderful Coloring - 1"". It has quite many differences, so you should read this statement completely.Recently, Paul and Mary have found a new favorite sequence of integers a1,a2,\xe2\x80\xa6,an. They want to paint it using pieces of chalk of k colors. The coloring of a sequence is called wonderful if the following conditions are met:  each element of the sequence is either painted in one of k colors or isn\'t painted;  each two elements which are painted in the same color are different (i.\xe2\x80\x89e. there\'s no two equal values painted in the same color);  let\'s calculate for each of k colors the number of elements painted in the color \xe2\x80\x94 all calculated numbers must be equal;  the total number of painted elements of the sequence is the maximum among all colorings of the sequence which meet the first three conditions. E.\xe2\x80\x89g. consider a sequence a=[3,1,1,1,1,10,3,10,10,2] and k=3. One of the wonderful colorings of the sequence is shown in the figure.  The example of a wonderful coloring of the sequence a=[3,1,1,1,1,10,3,10,10,2] and k=3. Note that one of the elements isn\'t painted. Help Paul and Mary to find a wonderful coloring of a given sequence a." 1400
1551B1 "Wonderful Coloring - 1" greedy,strings "This is a simplified version of the problem B2. Perhaps you should read the problem B2 before you start solving B1.Paul and Mary have a favorite string s which consists of lowercase letters of the Latin alphabet. They want to paint it using pieces of chalk of two colors: red and green. Let\'s call a coloring of a string wonderful if the following conditions are met:  each letter of the string is either painted in exactly one color (red or green) or isn\'t painted;  each two letters which are painted in the same color are different;  the number of letters painted in red is equal to the number of letters painted in green;  the number of painted letters of this coloring is maximum among all colorings of the string which meet the first three conditions. E.\xe2\x80\x89g. consider a string s equal to ""kzaaa"". One of the wonderful colorings of the string is shown in the figure.  The example of a wonderful coloring of the string ""kzaaa"". Paul and Mary want to learn by themselves how to find a wonderful coloring of the string. But they are very young, so they need a hint. Help them find k \xe2\x80\x94 the number of red (or green, these numbers are equal) letters in a wonderful coloring." 800
1551A "Polycarp and Coins" greedy,math "Polycarp must pay exactly n burles at the checkout. He has coins of two nominal values: 1 burle and 2 burles. Polycarp likes both kinds of coins equally. So he doesn\'t want to pay with more coins of one type than with the other.Thus, Polycarp wants to minimize the difference between the count of coins of 1 burle and 2 burles being used. Help him by determining two non-negative integer values c1 and c2 which are the number of coins of 1 burle and 2 burles, respectively, so that the total value of that number of coins is exactly n (i.\xe2\x80\x89e. c1+2\xe2\x8b\x85c2=n), and the absolute value of the difference between c1 and c2 is as little as possible (i.\xe2\x80\x89e. you must minimize |c1\xe2\x88\x92c2|)." 800
1550F "Jumping Around" "binary search,data structures,divide and conquer,dp,dsu,graphs,shortest paths" "There is an infinite pond that can be represented with a number line. There are n rocks in the pond, numbered from 1 to n. The i-th rock is located at an integer coordinate ai. The coordinates of the rocks are pairwise distinct. The rocks are numbered in the increasing order of the coordinate, so a1<a2<\xe2\x8b\xaf<an.A robot frog sits on the rock number s. The frog is programmable. It has a base jumping distance parameter d. There also is a setting for the jumping distance range. If the jumping distance range is set to some integer k, then the frog can jump from some rock to any rock at a distance from d\xe2\x88\x92k to d+k inclusive in any direction. The distance between two rocks is an absolute difference between their coordinates.You are assigned a task to implement a feature for the frog. Given two integers i and k determine if the frog can reach a rock number i from a rock number s performing a sequence of jumps with the jumping distance range set to k. The sequence can be arbitrarily long or empty.You will be given q testcases for that feature, the j-th testcase consists of two integers i and k. Print ""Yes"" if the i-th rock is reachable and ""No"" otherwise.You can output ""YES"" and ""NO"" in any case (for example, strings ""yEs"", ""yes"", ""Yes"" and \'YES""\' will be recognized as a positive answer)." 2700
1550E Stringforces "binary search,bitmasks,brute force,dp,strings,two pointers" "You are given a string s of length n. Each character is either one of the first k lowercase Latin letters or a question mark.You are asked to replace every question mark with one of the first k lowercase Latin letters in such a way that the following value is maximized.Let fi be the maximum length substring of string s, which consists entirely of the i-th Latin letter. A substring of a string is a contiguous subsequence of that string. If the i-th letter doesn\'t appear in a string, then fi is equal to 0.The value of a string s is the minimum value among fi for all i from 1 to k.What is the maximum value the string can have?" 2500
1550D "Excellent Arrays" "binary search,combinatorics,constructive algorithms,implementation,math,sortings,two pointers" "Let\'s call an integer array a1,a2,\xe2\x80\xa6,an good if ai\xe2\x89\xa0i for each i.Let F(a) be the number of pairs (i,j) (1\xe2\x89\xa4i<j\xe2\x89\xa4n) such that ai+aj=i+j.Let\'s say that an array a1,a2,\xe2\x80\xa6,an is excellent if:   a is good;  l\xe2\x89\xa4ai\xe2\x89\xa4r for each i;  F(a) is the maximum possible among all good arrays of size n. Given n, l and r, calculate the number of excellent arrays modulo 109+7." 2300
1550C "Manhattan Subarrays" "brute force,geometry,greedy,implementation" "Suppose you have two points p=(xp,yp) and q=(xq,yq). Let\'s denote the Manhattan distance between them as d(p,q)=|xp\xe2\x88\x92xq|+|yp\xe2\x88\x92yq|.Let\'s say that three points p, q, r form a bad triple if d(p,r)=d(p,q)+d(q,r).Let\'s say that an array b1,b2,\xe2\x80\xa6,bm is good if it is impossible to choose three distinct indices i, j, k such that the points (bi,i), (bj,j) and (bk,k) form a bad triple.You are given an array a1,a2,\xe2\x80\xa6,an. Calculate the number of good subarrays of a. A subarray of the array a is the array al,al+1,\xe2\x80\xa6,ar for some 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n.Note that, according to the definition, subarrays of length 1 and 2 are good." 1700
1550B "Maximum Cost Deletion" greedy,math "You are given a string s of length n consisting only of the characters 0 and 1.You perform the following operation until the string becomes empty: choose some consecutive substring of equal characters, erase it from the string and glue the remaining two parts together (any of them can be empty) in the same order. For example, if you erase the substring 111 from the string 111110, you will get the string 110. When you delete a substring of length l, you get a\xe2\x8b\x85l+b points.Your task is to calculate the maximum number of points that you can score in total, if you have to make the given string empty." 1000
1550A "Find The Array" greedy,math "Let\'s call an array a consisting of n positive (greater than 0) integers beautiful if the following condition is held for every i from 1 to n: either ai=1, or at least one of the numbers ai\xe2\x88\x921 and ai\xe2\x88\x922 exists in the array as well.For example:   the array [5,3,1] is beautiful: for a1, the number a1\xe2\x88\x922=3 exists in the array; for a2, the number a2\xe2\x88\x922=1 exists in the array; for a3, the condition a3=1 holds;  the array [1,2,2,2,2] is beautiful: for a1, the condition a1=1 holds; for every other number ai, the number ai\xe2\x88\x921=1 exists in the array;  the array [1,4] is not beautiful: for a2, neither a2\xe2\x88\x922=2 nor a2\xe2\x88\x921=3 exists in the array, and a2\xe2\x89\xa01;  the array [2] is not beautiful: for a1, neither a1\xe2\x88\x921=1 nor a1\xe2\x88\x922=0 exists in the array, and a1\xe2\x89\xa01;  the array [2,1,3] is beautiful: for a1, the number a1\xe2\x88\x921=1 exists in the array; for a2, the condition a2=1 holds; for a3, the number a3\xe2\x88\x922=1 exists in the array. You are given a positive integer s. Find the minimum possible size of a beautiful array with the sum of elements equal to s." 800
1549B "Gregor and the Pawn Game" "dfs and similar,dp,flows,graph matchings,graphs,greedy,implementation" "There is a chessboard of size n by n. The square in the i-th row from top and j-th column from the left is labelled (i,j).Currently, Gregor has some pawns in the n-th row. There are also enemy pawns in the 1-st row. On one turn, Gregor moves one of his pawns. A pawn can move one square up (from (i,j) to (i\xe2\x88\x921,j)) if there is no pawn in the destination square. Additionally, a pawn can move one square diagonally up (from (i,j) to either (i\xe2\x88\x921,j\xe2\x88\x921) or (i\xe2\x88\x921,j+1)) if and only if there is an enemy pawn in that square. The enemy pawn is also removed.Gregor wants to know what is the maximum number of his pawns that can reach row 1?Note that only Gregor takes turns in this game, and the enemy pawns never move. Also, when Gregor\'s pawn reaches row 1, it is stuck and cannot make any further moves." 800
1549A "Gregor and Cryptography" "math,number theory" "Gregor is learning about RSA cryptography, and although he doesn\'t understand how RSA works, he is now fascinated with prime numbers and factoring them.Gregor\'s favorite prime number is P. Gregor wants to find two bases of P. Formally, Gregor is looking for two integers a and b which satisfy both of the following properties.  Pmoda=Pmodb, where xmody denotes the remainder when x is divided by y, and  2\xe2\x89\xa4a<b\xe2\x89\xa4P. Help Gregor find two bases of his favorite prime number!" 800
1548E "Gregor and the Two Painters" "data structures,divide and conquer,graphs,greedy,math" "Two painters, Amin and Benj, are repainting Gregor\'s living room ceiling! The ceiling can be modeled as an n\xc3\x97m grid.For each i between 1 and n, inclusive, painter Amin applies ai layers of paint to the entire i-th row. For each j between 1 and m, inclusive, painter Benj applies bj layers of paint to the entire j-th column. Therefore, the cell (i,j) ends up with ai+bj layers of paint.Gregor considers the cell (i,j) to be badly painted if ai+bj\xe2\x89\xa4x. Define a badly painted region to be a maximal connected component of badly painted cells, i. e. a connected component of badly painted cells such that all adjacent to the component cells are not badly painted. Two cells are considered adjacent if they share a side.Gregor is appalled by the state of the finished ceiling, and wants to know the number of badly painted regions." 3400
1548D2 "Gregor and the Odd Cows (Hard)" "brute force,geometry,math,number theory" "This is the hard version of the problem. The only difference from the easy version is that in this version the coordinates can be both odd and even.There are n fence-posts at distinct coordinates on a plane. It is guaranteed that no three fence posts lie on the same line.There are an infinite number of cows on the plane, one at every point with integer coordinates.Gregor is a member of the Illuminati, and wants to build a triangular fence, connecting 3 distinct existing fence posts. A cow strictly inside the fence is said to be enclosed. If there are an odd number of enclosed cows and the area of the fence is an integer, the fence is said to be interesting.Find the number of interesting fences." 3300
1548D1 "Gregor and the Odd Cows (Easy)" "bitmasks,geometry,math,number theory" "This is the easy version of the problem. The only difference from the hard version is that in this version all coordinates are even.There are n fence-posts at distinct coordinates on a plane. It is guaranteed that no three fence posts lie on the same line.There are an infinite number of cows on the plane, one at every point with integer coordinates.Gregor is a member of the Illuminati, and wants to build a triangular fence, connecting 3 distinct existing fence posts. A cow strictly inside the fence is said to be enclosed. If there are an odd number of enclosed cows and the area of the fence is an integer, the fence is said to be interesting.Find the number of interesting fences." 2300
1548C "The Three Little Pigs" combinatorics,dp,fft,math "Three little pigs from all over the world are meeting for a convention! Every minute, a triple of 3 new pigs arrives on the convention floor. After the n-th minute, the convention ends.The big bad wolf has learned about this convention, and he has an attack plan. At some minute in the convention, he will arrive and eat exactly x pigs. Then he will get away.The wolf wants Gregor to help him figure out the number of possible attack plans that involve eating exactly x pigs for various values of x (1\xe2\x89\xa4x\xe2\x89\xa43n). Two attack plans are considered different, if they occur at different times or if the sets of little pigs to eat are different.Note that all queries are independent, that is, the wolf does not eat the little pigs, he only makes plans!" 2500
1548B "Integers Have Friends" "binary search,data structures,divide and conquer,math,number theory,two pointers" "British mathematician John Littlewood once said about Indian mathematician Srinivasa Ramanujan that ""every positive integer was one of his personal friends.""It turns out that positive integers can also be friends with each other! You are given an array a of distinct positive integers. Define a subarray ai,ai+1,\xe2\x80\xa6,aj to be a friend group if and only if there exists an integer m\xe2\x89\xa52 such that aimodm=ai+1modm=\xe2\x80\xa6=ajmodm, where xmody denotes the remainder when x is divided by y.Your friend Gregor wants to know the size of the largest friend group in a." 1800
1548A "Web of Lies" "brute force,graphs,greedy" "When you play the game of thrones, you win, or you die. There is no middle ground.Cersei Lannister, A Game of Thrones by George R. R. MartinThere are n nobles, numbered from 1 to n. Noble i has a power of i. There are also m ""friendships"". A friendship between nobles a and b is always mutual.A noble is defined to be vulnerable if both of the following conditions are satisfied:   the noble has at least one friend, and  all of that noble\'s friends have a higher power. You will have to process the following three types of queries.   Add a friendship between nobles u and v.  Remove a friendship between nobles u and v.  Calculate the answer to the following process. The process: all vulnerable nobles are simultaneously killed, and all their friendships end. Then, it is possible that new nobles become vulnerable. The process repeats itself until no nobles are vulnerable. It can be proven that the process will end in finite time. After the process is complete, you need to calculate the number of remaining nobles.Note that the results of the process are not carried over between queries, that is, every process starts with all nobles being alive!" 1400
1547G "How Many Paths?" "dfs and similar,dp,graphs,trees" "You are given a directed graph G which can contain loops (edges from a vertex to itself). Multi-edges are absent in G which means that for all ordered pairs (u,v) exists at most one edge from u to v. Vertices are numbered from 1 to n.A path from u to v is a sequence of edges such that:  vertex u is the start of the first edge in the path;  vertex v is the end of the last edge in the path;  for all pairs of adjacent edges next edge starts at the vertex that the previous edge ends on. We will assume that the empty sequence of edges is a path from u to u.For each vertex v output one of four values:  0, if there are no paths from 1 to v;  1, if there is only one path from 1 to v;  2, if there is more than one path from 1 to v and the number of paths is finite;  \xe2\x88\x921, if the number of paths from 1 to v is infinite. Let\'s look at the example shown in the figure.  Then:  the answer for vertex 1 is 1: there is only one path from 1 to 1 (path with length 0);  the answer for vertex 2 is 0: there are no paths from 1 to 2;  the answer for vertex 3 is 1: there is only one path from 1 to 3 (it is the edge (1,3));  the answer for vertex 4 is 2: there are more than one paths from 1 to 4 and the number of paths are finite (two paths: [(1,3),(3,4)] and [(1,4)]);  the answer for vertex 5 is \xe2\x88\x921: the number of paths from 1 to 5 is infinite (the loop can be used in a path many times);  the answer for vertex 6 is \xe2\x88\x921: the number of paths from 1 to 6 is infinite (the loop can be used in a path many times)." 2100
1547F "Array Stabilization (GCD version)" "binary search,brute force,data structures,divide and conquer,number theory,two pointers" "You are given an array of positive integers a=[a0,a1,\xe2\x80\xa6,an\xe2\x88\x921] (n\xe2\x89\xa52).In one step, the array a is replaced with another array of length n, in which each element is the greatest common divisor (GCD) of two neighboring elements (the element itself and its right neighbor; consider that the right neighbor of the (n\xe2\x88\x921)-th element is the 0-th element).Formally speaking, a new array b=[b0,b1,\xe2\x80\xa6,bn\xe2\x88\x921] is being built from array a=[a0,a1,\xe2\x80\xa6,an\xe2\x88\x921] such that bi =gcd(ai,a(i+1)modn), where gcd(x,y) is the greatest common divisor of x and y, and xmody is the remainder of x dividing by y. In one step the array b is built and then the array a is replaced with b (that is, the assignment a := b is taking place).For example, if a=[16,24,10,5] then b=[gcd(16,24), gcd(24,10), gcd(10,5), gcd(5,16)] =[8,2,5,1]. Thus, after one step the array a=[16,24,10,5] will be equal to [8,2,5,1].For a given array a, find the minimum number of steps after which all values ai become equal (that is, a0=a1=\xe2\x8b\xaf=an\xe2\x88\x921). If the original array a consists of identical elements then consider the number of steps is equal to 0." 1900
1547E "Air Conditioners" "data structures,dp,implementation,shortest paths,sortings,two pointers" "On a strip of land of length n there are k air conditioners: the i-th air conditioner is placed in cell ai (1\xe2\x89\xa4ai\xe2\x89\xa4n). Two or more air conditioners cannot be placed in the same cell (i.e. all ai are distinct).Each air conditioner is characterized by one parameter: temperature. The i-th air conditioner is set to the temperature ti.  Example of strip of length n=6, where k=2, a=[2,5] and t=[14,16]. For each cell i (1\xe2\x89\xa4i\xe2\x89\xa4n) find it\'s temperature, that can be calculated by the formula min1\xe2\x89\xa4j\xe2\x89\xa4k(tj+|aj\xe2\x88\x92i|),where |aj\xe2\x88\x92i| denotes absolute value of the difference aj\xe2\x88\x92i.In other words, the temperature in cell i is equal to the minimum among the temperatures of air conditioners, increased by the distance from it to the cell i.Let\'s look at an example. Consider that n=6,k=2, the first air conditioner is placed in cell a1=2 and is set to the temperature t1=14 and the second air conditioner is placed in cell a2=5 and is set to the temperature t2=16. In that case temperatures in cells are:  temperature in cell 1 is: min(14+|2\xe2\x88\x921|,16+|5\xe2\x88\x921|)=min(14+1,16+4)=min(15,20)=15;  temperature in cell 2 is: min(14+|2\xe2\x88\x922|,16+|5\xe2\x88\x922|)=min(14+0,16+3)=min(14,19)=14;  temperature in cell 3 is: min(14+|2\xe2\x88\x923|,16+|5\xe2\x88\x923|)=min(14+1,16+2)=min(15,18)=15;  temperature in cell 4 is: min(14+|2\xe2\x88\x924|,16+|5\xe2\x88\x924|)=min(14+2,16+1)=min(16,17)=16;  temperature in cell 5 is: min(14+|2\xe2\x88\x925|,16+|5\xe2\x88\x925|)=min(14+3,16+0)=min(17,16)=16;  temperature in cell 6 is: min(14+|2\xe2\x88\x926|,16+|5\xe2\x88\x926|)=min(14+4,16+1)=min(18,17)=17. For each cell from 1 to n find the temperature in it." 1500
1547D "Co-growing Sequence" "bitmasks,constructive algorithms,greedy" "A sequence of non-negative integers a1,a2,\xe2\x80\xa6,an is called growing if for all i from 1 to n\xe2\x88\x921 all ones (of binary representation) in ai are in the places of ones (of binary representation) in ai+1 (in other words, ai&ai+1=ai, where & denotes bitwise AND). If n=1 then the sequence is considered growing as well.For example, the following four sequences are growing:   [2,3,15,175] \xe2\x80\x94 in binary it\'s [102,112,11112,101011112];  [5] \xe2\x80\x94 in binary it\'s [1012];  [1,3,7,15] \xe2\x80\x94 in binary it\'s [12,112,1112,11112];  [0,0,0] \xe2\x80\x94 in binary it\'s [02,02,02]. The following three sequences are non-growing:   [3,4,5] \xe2\x80\x94 in binary it\'s [112,1002,1012];  [5,4,3] \xe2\x80\x94 in binary it\'s [1012,1002,0112];  [1,2,4,8] \xe2\x80\x94 in binary it\'s [00012,00102,01002,10002]. Consider two sequences of non-negative integers x1,x2,\xe2\x80\xa6,xn and y1,y2,\xe2\x80\xa6,yn. Let\'s call this pair of sequences co-growing if the sequence x1\xe2\x8a\x95y1,x2\xe2\x8a\x95y2,\xe2\x80\xa6,xn\xe2\x8a\x95yn is growing where \xe2\x8a\x95 denotes bitwise XOR.You are given a sequence of integers x1,x2,\xe2\x80\xa6,xn. Find the lexicographically minimal sequence y1,y2,\xe2\x80\xa6,yn such that sequences xi and yi are co-growing.The sequence a1,a2,\xe2\x80\xa6,an is lexicographically smaller than the sequence b1,b2,\xe2\x80\xa6,bn if there exists 1\xe2\x89\xa4k\xe2\x89\xa4n such that ai=bi for any 1\xe2\x89\xa4i<k but ak<bk." 1300
1547C "Pair Programming" "greedy,two pointers" "Monocarp and Polycarp are learning new programming techniques. Now they decided to try pair programming.It\'s known that they have worked together on the same file for n+m minutes. Every minute exactly one of them made one change to the file. Before they started, there were already k lines written in the file.Every minute exactly one of them does one of two actions: adds a new line to the end of the file or changes one of its lines.Monocarp worked in total for n minutes and performed the sequence of actions [a1,a2,\xe2\x80\xa6,an]. If ai=0, then he adds a new line to the end of the file. If ai>0, then he changes the line with the number ai. Monocarp performed actions strictly in this order: a1, then a2, ..., an.Polycarp worked in total for m minutes and performed the sequence of actions [b1,b2,\xe2\x80\xa6,bm]. If bj=0, then he adds a new line to the end of the file. If bj>0, then he changes the line with the number bj. Polycarp performed actions strictly in this order: b1, then b2, ..., bm.Restore their common sequence of actions of length n+m such that all actions would be correct \xe2\x80\x94 there should be no changes to lines that do not yet exist. Keep in mind that in the common sequence Monocarp\'s actions should form the subsequence [a1,a2,\xe2\x80\xa6,an] and Polycarp\'s \xe2\x80\x94 subsequence [b1,b2,\xe2\x80\xa6,bm]. They can replace each other at the computer any number of times.Let\'s look at an example. Suppose k=3. Monocarp first changed the line with the number 2 and then added a new line (thus, n=2,a=[2,0]). Polycarp first added a new line and then changed the line with the number 5 (thus, m=2,b=[0,5]).Since the initial length of the file was 3, in order for Polycarp to change line number 5 two new lines must be added beforehand. Examples of correct sequences of changes, in this case, would be [0,2,0,5] and [2,0,0,5]. Changes [0,0,5,2] (wrong order of actions) and [0,5,2,0] (line 5 cannot be edited yet) are not correct." 1100
1547B "Alphabetical Strings" greedy,implementation,strings "A string s of length n (1\xe2\x89\xa4n\xe2\x89\xa426) is called alphabetical if it can be obtained using the following algorithm:  first, write an empty string to s (i.e. perform the assignment s := """");  then perform the next step n times;  at the i-th step take i-th lowercase letter of the Latin alphabet and write it either to the left of the string s or to the right of the string s (i.e. perform the assignment s := c+s or s := s+c, where c is the i-th letter of the Latin alphabet). In other words, iterate over the n first letters of the Latin alphabet starting from \'a\' and etc. Each time we prepend a letter to the left of the string s or append a letter to the right of the string s. Strings that can be obtained in that way are alphabetical.For example, the following strings are alphabetical: ""a"", ""ba"", ""ab"", ""bac"" and ""ihfcbadeg"". The following strings are not alphabetical: ""z"", ""aa"", ""ca"", ""acb"", ""xyz"" and ""ddcba"".From the given string, determine if it is alphabetical." 800
1547A "Shortest Path with Obstacle" implementation,math "There are three cells on an infinite 2-dimensional grid, labeled A, B, and F. Find the length of the shortest path from A to B if:   in one move you can go to any of the four adjacent cells sharing a side;  visiting the cell F is forbidden (it is an obstacle)." 800
1546B "AquaMoon and Stolen String" interactive,math "AquaMoon had n strings of length m each. n is an odd number.When AquaMoon was gone, Cirno tried to pair these n strings together. After making n\xe2\x88\x9212 pairs, she found out that there was exactly one string without the pair!In her rage, she disrupted each pair of strings. For each pair, she selected some positions (at least 1 and at most m) and swapped the letters in the two strings of this pair at the selected positions.For example, if m=6 and two strings ""abcdef"" and ""xyzklm"" are in one pair and Cirno selected positions 2, 3 and 6 she will swap \'b\' with \'y\', \'c\' with \'z\' and \'f\' with \'m\'. The resulting strings will be ""ayzdem"" and ""xbcklf"".Cirno then stole away the string without pair and shuffled all remaining strings in arbitrary order.AquaMoon found the remaining n\xe2\x88\x921 strings in complete disarray. Also, she remembers the initial n strings. She wants to know which string was stolen, but she is not good at programming. Can you help her?" 1200
1546A "AquaMoon and Two Arrays" "brute force,greedy" "AquaMoon and Cirno are playing an interesting game with arrays. Cirno has prepared two arrays a and b, both consist of n non-negative integers. AquaMoon can perform the following operation an arbitrary number of times (possibly zero):  She chooses two indices i and j (1\xe2\x89\xa4i,j\xe2\x89\xa4n), then decreases the i-th element of array a by 1, and increases the j-th element of array a by 1. The resulting values at i-th and j-th index of array a are ai\xe2\x88\x921 and aj+1, respectively. Each element of array a must be non-negative after each operation. If i=j this operation doesn\'t change the array a. AquaMoon wants to make some operations to make arrays a and b equal. Two arrays a and b are considered equal if and only if ai=bi for all 1\xe2\x89\xa4i\xe2\x89\xa4n.Help AquaMoon to find a sequence of operations that will solve her problem or find, that it is impossible to make arrays a and b equal.Please note, that you don\'t have to minimize the number of operations." 800
1545F "AquaMoon and Potatoes" "brute force,data structures,dp" "AquaMoon has three integer arrays a, b, c of length n, where 1\xe2\x89\xa4ai,bi,ci\xe2\x89\xa4n for all i.In order to accelerate her potato farming, she organizes her farm in a manner based on these three arrays. She is now going to complete m operations to count how many potatoes she can get. Each operation will have one of the two types:  AquaMoon reorganizes their farm and makes the k-th element of the array a equal to x. In other words, perform the assignment ak:=x.  Given a positive integer r, AquaMoon receives a potato for each triplet (i,j,k), such that 1\xe2\x89\xa4i<j<k\xe2\x89\xa4r, and bai=aj=cak. Count the number of such triplets. As AquaMoon is busy finding the library, help her complete all of their operations." 3500
1545E2 "AquaMoon and Time Stop (hard version)" "data structures,dp" "Note that the differences between easy and hard versions are the constraints on n and the time limit. You can make hacks only if both versions are solved.AquaMoon knew through foresight that some ghosts wanted to curse tourists on a pedestrian street. But unfortunately, this time, these ghosts were hiding in a barrier, and she couldn\'t enter this barrier in a short time and destroy them. Therefore, all that can be done is to save any unfortunate person on the street from the ghosts.The pedestrian street can be represented as a one-dimensional coordinate system. There is one person hanging out on the pedestrian street. At the time 0 he is at coordinate x, moving with a speed of 1 unit per second. In particular, at time i the person will be at coordinate x+i.The ghosts are going to cast n curses on the street. The i-th curse will last from time tli\xe2\x88\x921+10\xe2\x88\x9218 to time tri+1\xe2\x88\x9210\xe2\x88\x9218 (exclusively) and will kill people with coordinates from li\xe2\x88\x921+10\xe2\x88\x9218 to ri+1\xe2\x88\x9210\xe2\x88\x9218 (exclusively). Formally that means, that the person, whose coordinate is between (li\xe2\x88\x921+10\xe2\x88\x9218,ri+1\xe2\x88\x9210\xe2\x88\x9218) in the time range (tli\xe2\x88\x921+10\xe2\x88\x9218,tri+1\xe2\x88\x9210\xe2\x88\x9218) will die.To save the person on the street, AquaMoon can stop time at any moment t, and then move the person from his current coordinate x to any coordinate y (t, x and y are not necessarily integers). The movement costs AquaMoon |x\xe2\x88\x92y| energy. The movement is continuous, so if there exists some cursed area between points x and y at time t, the person will die too.AquaMoon wants to know what is the minimum amount of energy she needs to spend in order to save the person on the street from all n curses. But she is not good at programming. As her friend, can you help her?" 3500
1545E1 "AquaMoon and Time Stop (easy version)" "data structures,dp" "Note that the differences between easy and hard versions are the constraints on n and the time limit. You can make hacks only if both versions are solved.AquaMoon knew through foresight that some ghosts wanted to curse tourists on a pedestrian street. But unfortunately, this time, these ghosts were hiding in a barrier, and she couldn\'t enter this barrier in a short time and destroy them. Therefore, all that can be done is to save any unfortunate person on the street from the ghosts.The pedestrian street can be represented as a one-dimensional coordinate system. There is one person hanging out on the pedestrian street. At the time 0 he is at coordinate x, moving with a speed of 1 unit per second. In particular, at time i the person will be at coordinate x+i.The ghosts are going to cast n curses on the street. The i-th curse will last from time tli\xe2\x88\x921+10\xe2\x88\x9218 to time tri+1\xe2\x88\x9210\xe2\x88\x9218 (exclusively) and will kill people with coordinates from li\xe2\x88\x921+10\xe2\x88\x9218 to ri+1\xe2\x88\x9210\xe2\x88\x9218 (exclusively). Formally that means, that the person, whose coordinate is between (li\xe2\x88\x921+10\xe2\x88\x9218,ri+1\xe2\x88\x9210\xe2\x88\x9218) in the time range (tli\xe2\x88\x921+10\xe2\x88\x9218,tri+1\xe2\x88\x9210\xe2\x88\x9218) will die.To save the person on the street, AquaMoon can stop time at any moment t, and then move the person from his current coordinate x to any coordinate y (t, x and y are not necessarily integers). The movement costs AquaMoon |x\xe2\x88\x92y| energy. The movement is continuous, so if there exists some cursed area between points x and y at time t, the person will die too.AquaMoon wants to know what is the minimum amount of energy she needs to spend in order to save the person on the street from all n curses. But she is not good at programming. As her friend, can you help her?" 3500
1545D "AquaMoon and Wrong Coordinate" "constructive algorithms,interactive,math" "Cirno gives AquaMoon a problem. There are m people numbered from 0 to m\xe2\x88\x921. They are standing on a coordinate axis in points with positive integer coordinates. They are facing right (i.e. in the direction of the coordinate increase). At this moment everyone will start running with the constant speed in the direction of coordinate increasing. The initial coordinate of the i-th person on the line is xi, and the speed of the i-th person is vi. So the coordinate of the i-th person at the moment t will be xi+t\xe2\x8b\x85vi.Cirno captured the coordinates of m people in k consecutive integer moments from 0 to k\xe2\x88\x921. In every moment, the coordinates of m people were recorded in arbitrary order.To make the problem more funny, Cirno modified one coordinate at the moment y (0<y<k\xe2\x88\x921) to a different integer.AquaMoon wants to find the moment y and the original coordinate p before the modification. Actually, she is not a programmer at all. So she wasn\'t able to solve it. Can you help her?" 3000
1545C "AquaMoon and Permutations" "2-sat,brute force,combinatorics,constructive algorithms,graph matchings,graphs" "Cirno has prepared n arrays of length n each. Each array is a permutation of n integers from 1 to n. These arrays are special: for all 1\xe2\x89\xa4i\xe2\x89\xa4n, if we take the i-th element of each array and form another array of length n with these elements, the resultant array is also a permutation of n integers from 1 to n. In the other words, if you put these n arrays under each other to form a matrix with n rows and n columns, this matrix is a Latin square.Afterwards, Cirno added additional n arrays, each array is a permutation of n integers from 1 to n. For all 1\xe2\x89\xa4i\xe2\x89\xa4n, there exists at least one position 1\xe2\x89\xa4k\xe2\x89\xa4n, such that for the i-th array and the (n+i)-th array, the k-th element of both arrays is the same. Notice that the arrays indexed from n+1 to 2n don\'t have to form a Latin square. Also, Cirno made sure that for all 2n arrays, no two arrays are completely equal, i. e. for all pair of indices 1\xe2\x89\xa4i<j\xe2\x89\xa42n, there exists at least one position 1\xe2\x89\xa4k\xe2\x89\xa4n, such that the k-th elements of the i-th and j-th array are different.Finally, Cirno arbitrarily changed the order of 2n arrays.AquaMoon calls a subset of all 2n arrays of size n good if these arrays from a Latin square.AquaMoon wants to know how many good subsets exist. Because this number may be particularly large, find it modulo 998244353. Also, she wants to find any good subset. Can you help her?" 2800
1545B "AquaMoon and Chess" combinatorics,math "Cirno gave AquaMoon a chessboard of size 1\xc3\x97n. Its cells are numbered with integers from 1 to n from left to right. In the beginning, some of the cells are occupied with at most one pawn, and other cells are unoccupied.In each operation, AquaMoon can choose a cell i with a pawn, and do either of the following (if possible):   Move pawn from it to the (i+2)-th cell, if i+2\xe2\x89\xa4n and the (i+1)-th cell is occupied and the (i+2)-th cell is unoccupied.  Move pawn from it to the (i\xe2\x88\x922)-th cell, if i\xe2\x88\x922\xe2\x89\xa51 and the (i\xe2\x88\x921)-th cell is occupied and the (i\xe2\x88\x922)-th cell is unoccupied. You are given an initial state of the chessboard. AquaMoon wants to count the number of states reachable from the initial state with some sequence of operations. But she is not good at programming. Can you help her? As the answer can be large find it modulo 998244353." 1900
1545A "AquaMoon and Strange Sort" sortings "AquaMoon has n friends. They stand in a row from left to right, and the i-th friend from the left wears a T-shirt with a number ai written on it. Each friend has a direction (left or right). In the beginning, the direction of each friend is right.AquaMoon can make some operations on friends. On each operation, AquaMoon can choose two adjacent friends and swap their positions. After each operation, the direction of both chosen friends will also be flipped: left to right and vice versa.AquaMoon hopes that after some operations, the numbers written on the T-shirt of n friends in the row, read from left to right, become non-decreasing. Also she wants, that all friends will have a direction of right at the end. Please find if it is possible." 1500
1543E "The Final Pursuit" "bitmasks,constructive algorithms,divide and conquer,graphs,greedy,math" "Finally, you have defeated Razor and now, you are the Most Wanted street racer. Sergeant Cross has sent the full police force after you in a deadly pursuit. Fortunately, you have found a hiding spot but you fear that Cross and his force will eventually find you. To increase your chances of survival, you want to tune and repaint your BMW M3 GTR.The car can be imagined as a permuted n-dimensional hypercube. A simple n-dimensional hypercube is an undirected unweighted graph built recursively as follows:   Take two simple (n\xe2\x88\x921)-dimensional hypercubes one having vertices numbered from 0 to 2n\xe2\x88\x921\xe2\x88\x921 and the other having vertices numbered from 2n\xe2\x88\x921 to 2n\xe2\x88\x921. A simple 0-dimensional Hypercube is just a single vertex.  Add an edge between the vertices i and i+2n\xe2\x88\x921 for each 0\xe2\x89\xa4i<2n\xe2\x88\x921. A permuted n-dimensional hypercube is formed by permuting the vertex numbers of a simple n-dimensional hypercube in any arbitrary manner.Examples of a simple and permuted 3-dimensional hypercubes are given below:  Note that a permuted n-dimensional hypercube has the following properties:   There are exactly 2n vertices.  There are exactly n\xe2\x8b\x852n\xe2\x88\x921 edges.  Each vertex is connected to exactly n other vertices.  There are no self-loops or duplicate edges. Let\'s denote the permutation used to generate the permuted n-dimensional hypercube, representing your car, from a simple n-dimensional hypercube by P. Before messing up the functionalities of the car, you want to find this permutation so that you can restore the car if anything goes wrong. But the job isn\'t done yet.You have n different colours numbered from 0 to n\xe2\x88\x921. You want to colour the vertices of this permuted n-dimensional hypercube in such a way that for each and every vertex u satisfying 0\xe2\x89\xa4u<2n and for each and every colour c satisfying 0\xe2\x89\xa4c<n, there is at least one vertex v adjacent to u having a colour c. In other words, from each and every vertex, it must be possible to reach a vertex of any colour by just moving to an adjacent vertex. Given the permuted n-dimensional hypercube, find any valid permutation P and colouring." 2700
1543D2 "RPD and Rap Sheet (Hard Version)" "brute force,constructive algorithms,interactive,math" "This is the hard version of the problem. The only difference is that here 2\xe2\x89\xa4k\xe2\x89\xa4100. You can make hacks only if both the versions of the problem are solved.This is an interactive problem!Every decimal number has a base k equivalent. The individual digits of a base k number are called k-its. Let\'s define the k-itwise XOR of two k-its a and b as (a+b)modk.The k-itwise XOR of two base k numbers is equal to the new number formed by taking the k-itwise XOR of their corresponding k-its. The k-itwise XOR of two decimal numbers a and b is denoted by a\xe2\x8a\x95kb and is equal to the decimal representation of the k-itwise XOR of the base k representations of a and b. All further numbers used in the statement below are in decimal unless specified.You have hacked the criminal database of Rockport Police Department (RPD), also known as the Rap Sheet. But in order to access it, you require a password. You don\'t know it, but you are quite sure that it lies between 0 and n\xe2\x88\x921 inclusive. So, you have decided to guess it. Luckily, you can try at most n times without being blocked by the system. But the system is adaptive. Each time you make an incorrect guess, it changes the password. Specifically, if the password before the guess was x, and you guess a different number y, then the system changes the password to a number z such that x\xe2\x8a\x95kz=y. Guess the password and break into the system." 2200
1543D1 "RPD and Rap Sheet (Easy Version)" "bitmasks,constructive algorithms,interactive,math" "This is the easy version of the problem. The only difference is that here k=2. You can make hacks only if both the versions of the problem are solved.This is an interactive problem.Every decimal number has a base k equivalent. The individual digits of a base k number are called k-its. Let\'s define the k-itwise XOR of two k-its a and b as (a+b)modk.The k-itwise XOR of two base k numbers is equal to the new number formed by taking the k-itwise XOR of their corresponding k-its. The k-itwise XOR of two decimal numbers a and b is denoted by a\xe2\x8a\x95kb and is equal to the decimal representation of the k-itwise XOR of the base k representations of a and b. All further numbers used in the statement below are in decimal unless specified. When k=2 (it is always true in this version), the k-itwise XOR is the same as the bitwise XOR.You have hacked the criminal database of Rockport Police Department (RPD), also known as the Rap Sheet. But in order to access it, you require a password. You don\'t know it, but you are quite sure that it lies between 0 and n\xe2\x88\x921 inclusive. So, you have decided to guess it. Luckily, you can try at most n times without being blocked by the system. But the system is adaptive. Each time you make an incorrect guess, it changes the password. Specifically, if the password before the guess was x, and you guess a different number y, then the system changes the password to a number z such that x\xe2\x8a\x95kz=y. Guess the password and break into the system." 1700
1543C "Need for Pink Slips" "bitmasks,brute force,dfs and similar,implementation,math,probabilities" "After defeating a Blacklist Rival, you get a chance to draw 1 reward slip out of x hidden valid slips. Initially, x=3 and these hidden valid slips are Cash Slip, Impound Strike Release Marker and Pink Slip of Rival\'s Car. Initially, the probability of drawing these in a random guess are c, m, and p, respectively. There is also a volatility factor v. You can play any number of Rival Races as long as you don\'t draw a Pink Slip. Assume that you win each race and get a chance to draw a reward slip. In each draw, you draw one of the x valid items with their respective probabilities. Suppose you draw a particular item and its probability of drawing before the draw was a. Then,  If the item was a Pink Slip, the quest is over, and you will not play any more races.  Otherwise,   If a\xe2\x89\xa4v, the probability of the item drawn becomes 0 and the item is no longer a valid item for all the further draws, reducing x by 1. Moreover, the reduced probability a is distributed equally among the other remaining valid items.  If a>v, the probability of the item drawn reduces by v and the reduced probability is distributed equally among the other valid items.  For example,  If (c,m,p)=(0.2,0.1,0.7) and v=0.1, after drawing Cash, the new probabilities will be (0.1,0.15,0.75).  If (c,m,p)=(0.1,0.2,0.7) and v=0.2, after drawing Cash, the new probabilities will be (Invalid,0.25,0.75).  If (c,m,p)=(0.2,Invalid,0.8) and v=0.1, after drawing Cash, the new probabilities will be (0.1,Invalid,0.9).  If (c,m,p)=(0.1,Invalid,0.9) and v=0.2, after drawing Cash, the new probabilities will be (Invalid,Invalid,1.0). You need the cars of Rivals. So, you need to find the expected number of races that you must play in order to draw a pink slip." 1900
1543B "Customising the Track" combinatorics,greedy,math "Highway 201 is the most busy street in Rockport. Traffic cars cause a lot of hindrances to races, especially when there are a lot of them. The track which passes through this highway can be divided into n sub-tracks. You are given an array a where ai represents the number of traffic cars in the i-th sub-track. You define the inconvenience of the track as n\xe2\x88\x91i=1n\xe2\x88\x91j=i+1|ai\xe2\x88\x92aj|, where |x| is the absolute value of x. You can perform the following operation any (possibly zero) number of times: choose a traffic car and move it from its current sub-track to any other sub-track.Find the minimum inconvenience you can achieve." 900
1543A "Exciting Bets" "greedy,math,number theory" "Welcome to Rockport City!It is time for your first ever race in the game against Ronnie. To make the race interesting, you have bet a dollars and Ronnie has bet b dollars. But the fans seem to be disappointed. The excitement of the fans is given by gcd(a,b), where gcd(x,y) denotes the greatest common divisor (GCD) of integers x and y. To make the race more exciting, you can perform two types of operations:  Increase both a and b by 1.  Decrease both a and b by 1. This operation can only be performed if both a and b are greater than 0. In one move, you can perform any one of these operations. You can perform arbitrary (possibly zero) number of moves. Determine the maximum excitement the fans can get and the minimum number of moves required to achieve it.Note that gcd(x,0)=x for any x\xe2\x89\xa50." 900
1542E2 "Abnormal Permutation Pairs (hard version)" combinatorics,dp,fft,math "This is the hard version of the problem. The only difference between the easy version and the hard version is the constraints on n. You can only make hacks if both versions are solved.A permutation of 1,2,\xe2\x80\xa6,n is a sequence of n integers, where each integer from 1 to n appears exactly once. For example, [2,3,1,4] is a permutation of 1,2,3,4, but [1,4,2,2] isn\'t because 2 appears twice in it.Recall that the number of inversions in a permutation a1,a2,\xe2\x80\xa6,an is the number of pairs of indices (i,j) such that i<j and ai>aj.Let p and q be two permutations of 1,2,\xe2\x80\xa6,n. Find the number of permutation pairs (p,q) that satisfy the following conditions:  p is lexicographically smaller than q.  the number of inversions in p is greater than the number of inversions in q. Print the number of such pairs modulo mod. Note that mod may not be a prime." 2700
1542E1 "Abnormal Permutation Pairs (easy version)" combinatorics,dp,fft,math "This is the easy version of the problem. The only difference between the easy version and the hard version is the constraints on n. You can only make hacks if both versions are solved.A permutation of 1,2,\xe2\x80\xa6,n is a sequence of n integers, where each integer from 1 to n appears exactly once. For example, [2,3,1,4] is a permutation of 1,2,3,4, but [1,4,2,2] isn\'t because 2 appears twice in it.Recall that the number of inversions in a permutation a1,a2,\xe2\x80\xa6,an is the number of pairs of indices (i,j) such that i<j and ai>aj.Let p and q be two permutations of 1,2,\xe2\x80\xa6,n. Find the number of permutation pairs (p,q) that satisfy the following conditions:  p is lexicographically smaller than q.  the number of inversions in p is greater than the number of inversions in q. Print the number of such pairs modulo mod. Note that mod may not be a prime." 2400
1542D "Priority Queue" "combinatorics,dp,implementation,math,ternary search" "You are given a sequence A, where its elements are either in the form + x or -, where x is an integer.For such a sequence S where its elements are either in the form + x or -, define f(S) as follows:  iterate through S\'s elements from the first one to the last one, and maintain a multiset T as you iterate through it.  for each element, if it\'s in the form + x, add x to T; otherwise, erase the smallest element from T (if T is empty, do nothing).  after iterating through all S\'s elements, compute the sum of all elements in T. f(S) is defined as the sum. The sequence b is a subsequence of the sequence a if b can be derived from a by removing zero or more elements without changing the order of the remaining elements. For all A\'s subsequences B, compute the sum of f(B), modulo 998244353." 2200
1542C "Strange Function" "math,number theory" "Let f(i) denote the minimum positive integer x such that x is not a divisor of i.Compute \xe2\x88\x91ni=1f(i) modulo 109+7. In other words, compute f(1)+f(2)+\xe2\x8b\xaf+f(n) modulo 109+7." 1600
1542B "Plus and Multiply" "constructive algorithms,math,number theory" "There is an infinite set generated as follows:  1 is in this set.  If x is in this set, x\xe2\x8b\x85a and x+b both are in this set. For example, when a=3 and b=6, the five smallest elements of the set are:  1,  3 (1 is in this set, so 1\xe2\x8b\x85a=3 is in this set),  7 (1 is in this set, so 1+b=7 is in this set),  9 (3 is in this set, so 3\xe2\x8b\x85a=9 is in this set),  13 (7 is in this set, so 7+b=13 is in this set). Given positive integers a, b, n, determine if n is in this set." 1500
1542A "Odd Set" math "You are given a multiset (i. e. a set that can contain multiple equal integers) containing 2n integers. Determine if you can split it into exactly n pairs (i. e. each element should be in exactly one pair) so that the sum of the two elements in each pair is odd (i. e. when divided by 2, the remainder is 1)." 800
1541B "Pleasant Pairs" "brute force,implementation,math,number theory" "You are given an array a1,a2,\xe2\x80\xa6,an consisting of n distinct integers. Count the number of pairs of indices (i,j) such that i<j and ai\xe2\x8b\x85aj=i+j." 1200
1541A "Pretty Permutations" "constructive algorithms,greedy,implementation" "There are n cats in a line, labeled from 1 to n, with the i-th cat at position i. They are bored of gyrating in the same spot all day, so they want to reorder themselves such that no cat is in the same place as before. They are also lazy, so they want to minimize the total distance they move. Help them decide what cat should be at each location after the reordering.For example, if there are 3 cats, this is a valid reordering: [3,1,2]. No cat is in its original position. The total distance the cats move is 1+1+2=4 as cat 1 moves one place to the right, cat 2 moves one place to the right, and cat 3 moves two places to the left." 800
1540E "Tasty Dishes" math,matrices "Note that the memory limit is unusual.There are n chefs numbered 1,2,\xe2\x80\xa6,n that must prepare dishes for a king. Chef i has skill i and initially has a dish of tastiness ai where |ai|\xe2\x89\xa4i. Each chef has a list of other chefs that he is allowed to copy from. To stop chefs from learning bad habits, the king makes sure that chef i can only copy from chefs of larger skill.There are a sequence of days that pass during which the chefs can work on their dish. During each day, there are two stages during which a chef can change the tastiness of their dish.   At the beginning of each day, each chef can choose to work (or not work) on their own dish, thereby multiplying the tastiness of their dish of their skill (ai:=i\xe2\x8b\x85ai) (or doing nothing). After all chefs (who wanted) worked on their own dishes, each start observing the other chefs. In particular, for each chef j on chef i\'s list, chef i can choose to copy (or not copy) j\'s dish, thereby adding the tastiness of the j\'s dish to i\'s dish (ai:=ai+aj) (or doing nothing). It can be assumed that all copying occurs simultaneously. Namely, if chef i chooses to copy from chef j he will copy the tastiness of chef j\'s dish at the end of stage 1.All chefs work to maximize the tastiness of their own dish in order to please the king.Finally, you are given q queries. Each query is one of two types.  1 k l r \xe2\x80\x94 find the sum of tastiness al,al+1,\xe2\x80\xa6,ar after the k-th day. Because this value can be large, find it modulo 109+7.  2 i x \xe2\x80\x94 the king adds x tastiness to the i-th chef\'s dish before the 1-st day begins (ai:=ai+x). Note that, because the king wants to see tastier dishes, he only adds positive tastiness (x>0). Note that queries of type 1 are independent of each all other queries. Specifically, each query of type 1 is a scenario and does not change the initial tastiness ai of any dish for future queries. Note that queries of type 2 are cumulative and only change the initial tastiness ai of a dish. See notes for an example of queries." 3500
1540D "Inverse Inversions" "binary search,brute force,data structures" "You were playing with permutation p of length n, but you lost it in Blair, Alabama!Luckily, you remember some information about the permutation. More specifically, you remember an array b of length n, where bi is the number of indices j such that j<i and pj>pi.You have the array b, and you want to find the permutation p. However, your memory isn\'t perfect, and you constantly change the values of b as you learn more. For the next q seconds, one of the following things happen:  1 i x \xe2\x80\x94 you realize that bi is equal to x;  2 i \xe2\x80\x94 you need to find the value of pi. If there\'s more than one answer, print any. It can be proven that there\'s always at least one possible answer under the constraints of the problem. Answer the queries, so you can remember the array!" 3200
1540C2 "Converging Array (Hard Version)" dp,math "This is the hard version of the problem. The only difference is that in this version 1\xe2\x89\xa4q\xe2\x89\xa4105. You can make hacks only if both versions of the problem are solved.There is a process that takes place on arrays a and b of length n and length n\xe2\x88\x921 respectively. The process is an infinite sequence of operations. Each operation is as follows:   First, choose a random integer i (1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921).  Then, simultaneously set ai=min(ai,ai+ai+1\xe2\x88\x92bi2) and ai+1=max(ai+1,ai+ai+1+bi2) without any rounding (so values may become non-integer).  See notes for an example of an operation.It can be proven that array a converges, i. e. for each i there exists a limit ai converges to. Let function F(a,b) return the value a1 converges to after a process on a and b.You are given array b, but not array a. However, you are given a third array c. Array a is good if it contains only integers and satisfies 0\xe2\x89\xa4ai\xe2\x89\xa4ci for 1\xe2\x89\xa4i\xe2\x89\xa4n.Your task is to count the number of good arrays a where F(a,b)\xe2\x89\xa5x for q values of x. Since the number of arrays can be very large, print it modulo 109+7." 2900
1540C1 "Converging Array (Easy Version)" dp,math "This is the easy version of the problem. The only difference is that in this version q=1. You can make hacks only if both versions of the problem are solved.There is a process that takes place on arrays a and b of length n and length n\xe2\x88\x921 respectively. The process is an infinite sequence of operations. Each operation is as follows:   First, choose a random integer i (1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921).  Then, simultaneously set ai=min(ai,ai+ai+1\xe2\x88\x92bi2) and ai+1=max(ai+1,ai+ai+1+bi2) without any rounding (so values may become non-integer).  See notes for an example of an operation.It can be proven that array a converges, i. e. for each i there exists a limit ai converges to. Let function F(a,b) return the value a1 converges to after a process on a and b.You are given array b, but not array a. However, you are given a third array c. Array a is good if it contains only integers and satisfies 0\xe2\x89\xa4ai\xe2\x89\xa4ci for 1\xe2\x89\xa4i\xe2\x89\xa4n.Your task is to count the number of good arrays a where F(a,b)\xe2\x89\xa5x for q values of x. Since the number of arrays can be very large, print it modulo 109+7." 2700
1540B "Tree Array" "brute force,combinatorics,dp,graphs,math,probabilities,trees" "You are given a tree consisting of n nodes. You generate an array from the tree by marking nodes one by one.Initially, when no nodes are marked, a node is equiprobably chosen and marked from the entire tree. After that, until all nodes are marked, a node is equiprobably chosen and marked from the set of unmarked nodes with at least one edge to a marked node. It can be shown that the process marks all nodes in the tree. The final array a is the list of the nodes\' labels in order of the time each node was marked.Find the expected number of inversions in the array that is generated by the tree and the aforementioned process.The number of inversions in an array a is the number of pairs of indices (i,j) such that i<j and ai>aj. For example, the array [4,1,3,2] contains 4 inversions: (1,2), (1,3), (1,4), (3,4)." 2300
1540A "Great Graphs" "constructive algorithms,graphs,greedy,shortest paths,sortings" "Farmer John has a farm that consists of n pastures connected by one-directional roads. Each road has a weight, representing the time it takes to go from the start to the end of the road. The roads could have negative weight, where the cows go so fast that they go back in time! However, Farmer John guarantees that it is impossible for the cows to get stuck in a time loop, where they can infinitely go back in time by traveling across a sequence of roads. Also, each pair of pastures is connected by at most one road in each direction.Unfortunately, Farmer John lost the map of the farm. All he remembers is an array d, where di is the smallest amount of time it took the cows to reach the i-th pasture from pasture 1 using a sequence of roads. The cost of his farm is the sum of the weights of each of the roads, and Farmer John needs to know the minimal cost of a farm that is consistent with his memory." 1400
1539F "Strange Array" "data structures,greedy,sortings" "Vasya has an array of n integers a1,a2,\xe2\x80\xa6,an. Vasya thinks that all numbers in his array are strange for some reason. To calculate how strange the i-th number is, Vasya created the following algorithm.He chooses a subsegment al,al+1,\xe2\x80\xa6,ar, such that 1\xe2\x89\xa4l\xe2\x89\xa4i\xe2\x89\xa4r\xe2\x89\xa4n, sort its elements in increasing order in his head (he can arrange equal elements arbitrary). After that he finds the center of the segment. The center of a segment is the element at position (l+r)/2, if the length of the segment is odd, and at position (l+r+1)/2 otherwise. Now Vasya finds the element that was at position i before the sorting, and calculates the distance between its current position and the center of the subsegment (the distance between the elements with indices j and k is |j\xe2\x88\x92k|).The strangeness of the number at position i is the maximum distance among all suitable choices of l and r. Vasya wants to calculate the strangeness of each number in his array. Help him to do it." 2600
1539E "Game with Cards" "binary search,constructive algorithms,data structures,dp,greedy,implementation" "The Alice\'s computer is broken, so she can\'t play her favorite card game now. To help Alice, Bob wants to answer n her questions. Initially, Bob holds one card with number 0 in the left hand and one in the right hand. In the i-th question, Alice asks Bob to replace a card in the left or right hand with a card with number ki (Bob chooses which of two cards he changes, Bob must replace exactly one card).After this action, Alice wants the numbers on the left and right cards to belong to given segments (segments for left and right cards can be different). Formally, let the number on the left card be x, and on the right card be y. Then after the i-th swap the following conditions must be satisfied: al,i\xe2\x89\xa4x\xe2\x89\xa4bl,i, and ar,i\xe2\x89\xa4y\xe2\x89\xa4br,i.Please determine if Bob can answer all requests. If it is possible, find a way to do it." 2500
1539D PriceFixed "binary search,greedy,implementation,sortings,two pointers" "Lena is the most economical girl in Moscow. So, when her dad asks her to buy some food for a trip to the country, she goes to the best store  \xe2\x80\x94 ""PriceFixed"". Here are some rules of that store:  The store has an infinite number of items of every product.  All products have the same price: 2 rubles per item.  For every product i there is a discount for experienced buyers: if you buy bi items of products (of any type, not necessarily type i), then for all future purchases of the i-th product there is a 50% discount (so you can buy an item of the i-th product for 1 ruble!). Lena needs to buy n products: she must purchase at least ai items of the i-th product. Help Lena to calculate the minimum amount of money she needs to spend if she optimally chooses the order of purchasing. Note that if she wants, she can buy more items of some product than needed." 1600
1539C "Stable Groups" greedy,sortings "There are n students numerated from 1 to n. The level of the i-th student is ai. You need to split the students into stable groups. A group of students is called stable, if in the sorted array of their levels no two neighboring elements differ by more than x.For example, if x=4, then the group with levels [1,10,8,4,4] is stable (because 4\xe2\x88\x921\xe2\x89\xa4x, 4\xe2\x88\x924\xe2\x89\xa4x, 8\xe2\x88\x924\xe2\x89\xa4x, 10\xe2\x88\x928\xe2\x89\xa4x), while the group with levels [2,10,10,7] is not stable (7\xe2\x88\x922=5>x).Apart from the n given students, teachers can invite at most k additional students with arbitrary levels (at teachers\' choice). Find the minimum number of stable groups teachers can form from all students (including the newly invited).For example, if there are two students with levels 1 and 5; x=2; and k\xe2\x89\xa51, then you can invite a new student with level 3 and put all the students in one stable group." 1200
1539B "Love Song" dp,implementation,strings "Petya once wrote a sad love song and shared it to Vasya. The song is a string consisting of lowercase English letters. Vasya made up q questions about this song. Each question is about a subsegment of the song starting from the l-th letter to the r-th letter. Vasya considers a substring made up from characters on this segment and repeats each letter in the subsegment k times, where k is the index of the corresponding letter in the alphabet. For example, if the question is about the substring ""abbcb"", then Vasya repeats letter \'a\' once, each of the letters \'b\' twice, letter \'c"" three times, so that the resulting string is ""abbbbcccbb"", its length is 10. Vasya is interested about the length of the resulting string.Help Petya find the length of each string obtained by Vasya." 800
1539A "Contest Start" combinatorics,geometry,greedy,math "There are n people participating in some contest, they start participating in x minutes intervals. That means the first participant starts at time 0, the second participant starts at time x, the third \xe2\x80\x94 at time 2\xe2\x8b\x85x, and so on.Duration of contest is t minutes for each participant, so the first participant finishes the contest at time t, the second \xe2\x80\x94 at time t+x, and so on. When a participant finishes the contest, their dissatisfaction equals to the number of participants that started the contest (or starting it now), but haven\'t yet finished it.Determine the sum of dissatisfaction of all participants." 1000
1538G "Gift Set" "binary search,greedy,math,ternary search" "Polycarp has x of red and y of blue candies. Using them, he wants to make gift sets. Each gift set contains either a red candies and b blue candies, or a blue candies and b red candies. Any candy can belong to at most one gift set.Help Polycarp to find the largest number of gift sets he can create.For example, if x=10, y=12, a=5, and b=2, then Polycarp can make three gift sets:   In the first set there will be 5 red candies and 2 blue candies;  In the second set there will be 5 blue candies and 2 red candies;  In the third set will be 5 blue candies and 2 red candies. Note that in this example there is one red candy that Polycarp does not use in any gift set." 2100
1538F "Interesting Function" "binary search,dp,math,number theory" "You are given two integers l and r, where l<r. We will add 1 to l until the result is equal to r. Thus, there will be exactly r\xe2\x88\x92l additions performed. For each such addition, let\'s look at the number of digits that will be changed after it.For example:   if l=909, then adding one will result in 910 and 2 digits will be changed;  if you add one to l=9, the result will be 10 and 2 digits will also be changed;  if you add one to l=489999, the result will be 490000 and 5 digits will be changed. Changed digits always form a suffix of the result written in the decimal system.Output the total number of changed digits, if you want to get r from l, adding 1 each time." 1500
1538E "Funny Substrings" "data structures,hashing,implementation,matrices,strings" "Polycarp came up with a new programming language. There are only two types of statements in it:   ""x := s"": assign the variable named x the value s (where s is a string). For example, the statement var := hello assigns the variable named var the value hello. Note that s is the value of a string, not the name of a variable. Between the variable name, the := operator and the string contains exactly one space each. ""x = a + b"": assign the variable named x the concatenation of values of two variables a and b. For example, if the program consists of three statements a := hello, b := world, c = a + b, then the variable c will contain the string helloworld. It is guaranteed that the program is correct and the variables a and b were previously defined. There is exactly one space between the variable names and the = and + operators. All variable names and strings only consist of lowercase letters of the English alphabet and do not exceed 5 characters.The result of the program is the number of occurrences of string haha in the string that was written to the variable in the last statement.Polycarp was very tired while inventing that language. He asks you to implement it. Your task is \xe2\x80\x94 for given program statements calculate the number of occurrences of string haha in the last assigned variable." 2100
1538D "Another Problem About Dividing Numbers" "constructive algorithms,math,number theory" "You are given two integers a and b. In one turn, you can do one of the following operations:   Take an integer c (c>1 and a should be divisible by c) and replace a with ac;  Take an integer c (c>1 and b should be divisible by c) and replace b with bc. Your goal is to make a equal to b using exactly k turns.For example, the numbers a=36 and b=48 can be made equal in 4 moves:   c=6, divide b by c \xe2\x87\x92 a=36, b=8;  c=2, divide a by c \xe2\x87\x92 a=18, b=8;  c=9, divide a by c \xe2\x87\x92 a=2, b=8;  c=4, divide b by c \xe2\x87\x92 a=2, b=2. For the given numbers a and b, determine whether it is possible to make them equal using exactly k turns." 1700
1538C "Number of Pairs" "binary search,data structures,math,two pointers" "You are given an array a of n integers. Find the number of pairs (i,j) (1\xe2\x89\xa4i<j\xe2\x89\xa4n) where the sum of ai+aj is greater than or equal to l and less than or equal to r (that is, l\xe2\x89\xa4ai+aj\xe2\x89\xa4r).For example, if n=3, a=[5,1,2], l=4 and r=7, then two pairs are suitable:   i=1 and j=2 (4\xe2\x89\xa45+1\xe2\x89\xa47);  i=1 and j=3 (4\xe2\x89\xa45+2\xe2\x89\xa47)." 1300
1538B "Friends and Candies" greedy,math "Polycarp has n friends, the i-th of his friends has ai candies. Polycarp\'s friends do not like when they have different numbers of candies. In other words they want all ai to be the same. To solve this, Polycarp performs the following set of actions exactly once:   Polycarp chooses k (0\xe2\x89\xa4k\xe2\x89\xa4n) arbitrary friends (let\'s say he chooses friends with indices i1,i2,\xe2\x80\xa6,ik);  Polycarp distributes their ai1+ai2+\xe2\x80\xa6+aik candies among all n friends. During distribution for each of ai1+ai2+\xe2\x80\xa6+aik candies he chooses new owner. That can be any of n friends. Note, that any candy can be given to the person, who has owned that candy before the distribution process. Note that the number k is not fixed in advance and can be arbitrary. Your task is to find the minimum value of k.For example, if n=4 and a=[4,5,2,5], then Polycarp could make the following distribution of the candies:   Polycarp chooses k=2 friends with indices i=[2,4] and distributes a2+a4=10 candies to make a=[4,4,4,4] (two candies go to person 3). Note that in this example Polycarp cannot choose k=1 friend so that he can redistribute candies so that in the end all ai are equal.For the data n and a, determine the minimum value k. With this value k, Polycarp should be able to select k friends and redistribute their candies so that everyone will end up with the same number of candies." 800
1538A "Stone Game" "brute force,dp,greedy" "Polycarp is playing a new computer game. This game has n stones in a row. The stone on the position i has integer power ai. The powers of all stones are distinct.Each turn Polycarp can destroy either stone on the first position or stone on the last position (in other words, either the leftmost or the rightmost stone). When Polycarp destroys the stone it does not exist any more.Now, Polycarp wants two achievements. He gets them if he destroys the stone with the least power and the stone with the greatest power. Help Polycarp find out what is the minimum number of moves he should make in order to achieve his goal.For example, if n=5 and a=[1,5,4,3,2], then Polycarp could make the following moves:   Destroy the leftmost stone. After this move a=[5,4,3,2];  Destroy the rightmost stone. After this move a=[5,4,3];  Destroy the leftmost stone. After this move a=[4,3]. Polycarp destroyed the stones with the greatest and least power, so he can end the game. Please note that in the example above, you can complete the game in two steps. For example:   Destroy the leftmost stone. After this move a=[5,4,3,2];  Destroy the leftmost stone. After this move a=[4,3,2]. Polycarp destroyed the stones with the greatest and least power, so he can end the game." 800
1537F "Figure Fixing" "constructive algorithms,dfs and similar,dsu,graphs,greedy,math" "You have a connected undirected graph made of n nodes and m edges. The i-th node has a value vi and a target value ti.In an operation, you can choose an edge (i,j) and add k to both vi and vj, where k can be any integer. In particular, k can be negative.Your task to determine if it is possible that by doing some finite number of operations (possibly zero), you can achieve for every node i, vi=ti." 2200
1537E2 "Erase and Extend (Hard Version)" "binary search,data structures,greedy,hashing,string suffix structures,strings,two pointers" "This is the hard version of the problem. The only difference is the constraints on n and k. You can make hacks only if all versions of the problem are solved.You have a string s, and you can do two types of operations on it:   Delete the last character of the string.  Duplicate the string: s:=s+s, where + denotes concatenation. You can use each operation any number of times (possibly none).Your task is to find the lexicographically smallest string of length exactly k that can be obtained by doing these operations on string s.A string a is lexicographically smaller than a string b if and only if one of the following holds:  a is a prefix of b, but a\xe2\x89\xa0b;  In the first position where a and b differ, the string a has a letter that appears earlier in the alphabet than the corresponding letter in b." 2200
1537E1 "Erase and Extend (Easy Version)" "binary search,brute force,dp,greedy,hashing,implementation,string suffix structures,strings,two pointers" "This is the easy version of the problem. The only difference is the constraints on n and k. You can make hacks only if all versions of the problem are solved.You have a string s, and you can do two types of operations on it:   Delete the last character of the string.  Duplicate the string: s:=s+s, where + denotes concatenation. You can use each operation any number of times (possibly none).Your task is to find the lexicographically smallest string of length exactly k that can be obtained by doing these operations on string s.A string a is lexicographically smaller than a string b if and only if one of the following holds:  a is a prefix of b, but a\xe2\x89\xa0b;  In the first position where a and b differ, the string a has a letter that appears earlier in the alphabet than the corresponding letter in b." 1600
1537D "Deleting Divisors" "games,math,number theory" "Alice and Bob are playing a game. They start with a positive integer n and take alternating turns doing operations on it. Each turn a player can subtract from n one of its divisors that isn\'t 1 or n. The player who cannot make a move on his/her turn loses. Alice always moves first.Note that they subtract a divisor of the current number in each turn.You are asked to find out who will win the game if both players play optimally." 1700
1537C "Challenging Cliffs" "constructive algorithms,greedy,implementation,math" "You are a game designer and want to make an obstacle course. The player will walk from left to right. You have n heights of mountains already selected and want to arrange them so that the absolute difference of the heights of the first and last mountains is as small as possible. In addition, you want to make the game difficult, and since walking uphill or flat is harder than walking downhill, the difficulty of the level will be the number of mountains i (1\xe2\x89\xa4i<n) such that hi\xe2\x89\xa4hi+1 where hi is the height of the i-th mountain. You don\'t want to waste any of the mountains you modelled, so you have to use all of them. From all the arrangements that minimize |h1\xe2\x88\x92hn|, find one that is the most difficult. If there are multiple orders that satisfy these requirements, you may find any." 1200
1537B "Bad Boy" "constructive algorithms,greedy,math" "Riley is a very bad boy, but at the same time, he is a yo-yo master. So, he decided to use his yo-yo skills to annoy his friend Anton.Anton\'s room can be represented as a grid with n rows and m columns. Let (i,j) denote the cell in row i and column j. Anton is currently standing at position (i,j) in his room. To annoy Anton, Riley decided to throw exactly two yo-yos in cells of the room (they can be in the same cell).Because Anton doesn\'t like yo-yos thrown on the floor, he has to pick up both of them and return back to the initial position. The distance travelled by Anton is the shortest path that goes through the positions of both yo-yos and returns back to (i,j) by travelling only to adjacent by side cells. That is, if he is in cell (x,y) then he can travel to the cells (x+1,y), (x\xe2\x88\x921,y), (x,y+1) and (x,y\xe2\x88\x921) in one step (if a cell with those coordinates exists).Riley is wondering where he should throw these two yo-yos so that the distance travelled by Anton is maximized. But because he is very busy, he asked you to tell him." 900
1537A "Arithmetic Array" greedy,math "An array b of length k is called good if its arithmetic mean is equal to 1. More formally, if b1+\xe2\x8b\xaf+bkk=1.Note that the value b1+\xe2\x8b\xaf+bkk is not rounded up or down. For example, the array [1,1,1,2] has an arithmetic mean of 1.25, which is not equal to 1.You are given an integer array a of length n. In an operation, you can append a non-negative integer to the end of the array. What\'s the minimum number of operations required to make the array good?We have a proof that it is always possible with finitely many operations." 800
1536F "Omkar and Akmar" "chinese remainder theorem,combinatorics,constructive algorithms,fft,games,geometry,math,meet-in-the-middle,string suffix structures" "Omkar and Akmar are playing a game on a circular board with n (2\xe2\x89\xa4n\xe2\x89\xa4106) cells. The cells are numbered from 1 to n so that for each i (1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921) cell i is adjacent to cell i+1 and cell 1 is adjacent to cell n. Initially, each cell is empty.Omkar and Akmar take turns placing either an A or a B on the board, with Akmar going first. The letter must be placed on an empty cell. In addition, the letter cannot be placed adjacent to a cell containing the same letter. A player loses when it is their turn and there are no more valid moves.Output the number of possible distinct games where both players play optimally modulo 109+7. Note that we only consider games where some player has lost and there are no more valid moves.Two games are considered distinct if the number of turns is different or for some turn, the letter or cell number that the letter is placed on were different.A move is considered optimal if the move maximizes the player\'s chance of winning, assuming the other player plays optimally as well. More formally, if the player who has to move has a winning strategy, they have to make a move after which they will still have a winning strategy. If they do not, they can make any move." 2600
1536E "Omkar and Forest" "combinatorics,graphs,math,shortest paths" "Omkar\'s most recent follower, Ajit, has entered the Holy Forest. Ajit realizes that Omkar\'s forest is an n by m grid (1\xe2\x89\xa4n,m\xe2\x89\xa42000) of some non-negative integers. Since the forest is blessed by Omkar, it satisfies some special conditions:  For any two adjacent (sharing a side) cells, the absolute value of the difference of numbers in them is at most 1.  If the number in some cell is strictly larger than 0, it should be strictly greater than the number in at least one of the cells adjacent to it. Unfortunately, Ajit is not fully worthy of Omkar\'s powers yet. He sees each cell as a ""0"" or a ""#"". If a cell is labeled as ""0"", then the number in it must equal 0. Otherwise, the number in it can be any nonnegative integer.Determine how many different assignments of elements exist such that these special conditions are satisfied. Two assignments are considered different if there exists at least one cell such that the numbers written in it in these assignments are different. Since the answer may be enormous, find the answer modulo 109+7." 2300
1536D "Omkar and Medians" "data structures,greedy,implementation" "Uh oh! Ray lost his array yet again! However, Omkar might be able to help because he thinks he has found the OmkArray of Ray\'s array. The OmkArray of an array a with elements a1,a2,\xe2\x80\xa6,a2k\xe2\x88\x921, is the array b with elements b1,b2,\xe2\x80\xa6,bk such that bi is equal to the median of a1,a2,\xe2\x80\xa6,a2i\xe2\x88\x921 for all i. Omkar has found an array b of size n (1\xe2\x89\xa4n\xe2\x89\xa42\xe2\x8b\x85105, \xe2\x88\x92109\xe2\x89\xa4bi\xe2\x89\xa4109). Given this array b, Ray wants to test Omkar\'s claim and see if b actually is an OmkArray of some array a. Can you help Ray?The median of a set of numbers a1,a2,\xe2\x80\xa6,a2i\xe2\x88\x921 is the number ci where c1,c2,\xe2\x80\xa6,c2i\xe2\x88\x921 represents a1,a2,\xe2\x80\xa6,a2i\xe2\x88\x921 sorted in nondecreasing order." 2000
1536C "Diluc and Kaeya" "data structures,dp,hashing,number theory" "The tycoon of a winery empire in Mondstadt, unmatched in every possible way. A thinker in the Knights of Favonius with an exotic appearance.This time, the brothers are dealing with a strange piece of wood marked with their names. This plank of wood can be represented as a string of n characters. Each character is either a \'D\' or a \'K\'. You want to make some number of cuts (possibly 0) on this string, partitioning it into several contiguous pieces, each with length at least 1. Both brothers act with dignity, so they want to split the wood as evenly as possible. They want to know the maximum number of pieces you can split the wood into such that the ratios of the number of occurrences of \'D\' to the number of occurrences of \'K\' in each chunk are the same.Kaeya, the curious thinker, is interested in the solution for multiple scenarios. He wants to know the answer for every prefix of the given string. Help him to solve this problem!For a string we define a ratio as a:b where \'D\' appears in it a times, and \'K\' appears b times. Note that a or b can equal 0, but not both. Ratios a:b and c:d are considered equal if and only if a\xe2\x8b\x85d=b\xe2\x8b\x85c. For example, for the string \'DDD\' the ratio will be 3:0, for \'DKD\' \xe2\x80\x94 2:1, for \'DKK\' \xe2\x80\x94 1:2, and for \'KKKKDD\' \xe2\x80\x94 2:4. Note that the ratios of the latter two strings are equal to each other, but they are not equal to the ratios of the first two strings." 1500
1536B "Prinzessin der Verurteilung" "brute force,constructive algorithms,strings" "I, Fischl, Prinzessin der Verurteilung, descend upon this land by the call of fate an \xe2\x80\x94 Oh, you are also a traveler from another world? Very well, I grant you permission to travel with me.It is no surprise Fischl speaks with a strange choice of words. However, this time, not even Oz, her raven friend, can interpret her expressions! Maybe you can help us understand what this young princess is saying?You are given a string of n lowercase Latin letters, the word that Fischl just spoke. You think that the MEX of this string may help you find the meaning behind this message. The MEX of the string is defined as the shortest string that doesn\'t appear as a contiguous substring in the input. If multiple strings exist, the lexicographically smallest one is considered the MEX. Note that the empty substring does NOT count as a valid MEX.A string a is lexicographically smaller than a string b if and only if one of the following holds:   a is a prefix of b, but a\xe2\x89\xa0b;  in the first position where a and b differ, the string a has a letter that appears earlier in the alphabet than the corresponding letter in b. A string a is a substring of a string b if a can be obtained from b by deletion of several (possibly, zero or all) characters from the beginning and several (possibly, zero or all) characters from the end.Find out what the MEX of the string is!" 1200
1536A "Omkar and Bad Story" "brute force,constructive algorithms" "Omkar has received a message from Anton saying ""Your story for problem A is confusing. Just make a formal statement."" Because of this, Omkar gives you an array a=[a1,a2,\xe2\x80\xa6,an] of n distinct integers. An array b=[b1,b2,\xe2\x80\xa6,bk] is called nice if for any two distinct elements bi,bj of b, |bi\xe2\x88\x92bj| appears in b at least once. In addition, all elements in b must be distinct. Can you add several (maybe, 0) integers to a to create a nice array b of size at most 300? If a is already nice, you don\'t have to add any elements.For example, array [3,6,9] is nice, as |6\xe2\x88\x923|=|9\xe2\x88\x926|=3, which appears in the array, and |9\xe2\x88\x923|=6, which appears in the array, while array [4,2,0,6,9] is not nice, as |9\xe2\x88\x924|=5 is not present in the array.For integers x and y, |x\xe2\x88\x92y|=x\xe2\x88\x92y if x>y and |x\xe2\x88\x92y|=y\xe2\x88\x92x otherwise." 800
1535F "String Distance" "binary search,brute force,data structures,hashing,implementation,strings" "Suppose you are given two strings a and b. You can apply the following operation any number of times: choose any contiguous substring of a or b, and sort the characters in it in non-descending order. Let f(a,b) the minimum number of operations you have to apply in order to make them equal (or f(a,b)=1337 if it is impossible to make a and b equal using these operations).For example:   f(ab,ab)=0;  f(ba,ab)=1 (in one operation, we can sort the whole first string);  f(ebcda,ecdba)=1 (in one operation, we can sort the substring of the second string starting from the 2-nd character and ending with the 4-th character);  f(a,b)=1337. You are given n strings s1,s2,\xe2\x80\xa6,sk having equal length. Calculate n\xe2\x88\x91i=1n\xe2\x88\x91j=i+1f(si,sj)." 3000
1535E "Gold Transfer" "binary search,data structures,dp,greedy,interactive,trees" "You are given a rooted tree. Each vertex contains ai tons of gold, which costs ci per one ton. Initially, the tree consists only a root numbered 0 with a0 tons of gold and price c0 per ton.There are q queries. Each query has one of two types:   Add vertex i (where i is an index of query) as a son to some vertex pi; vertex i will have ai tons of gold with ci per ton. It\'s guaranteed that ci>cpi.  For a given vertex vi consider the simple path from vi to the root. We need to purchase wi tons of gold from vertices on this path, spending the minimum amount of money. If there isn\'t enough gold on the path, we buy all we can. If we buy x tons of gold in some vertex v the remaining amount of gold in it decreases by x (of course, we can\'t buy more gold that vertex has at the moment). For each query of the second type, calculate the resulting amount of gold we bought and the amount of money we should spend.Note that you should solve the problem in online mode. It means that you can\'t read the whole input at once. You can read each query only after writing the answer for the last query, so don\'t forget to flush output after printing answers. You can use functions like fflush(stdout) in C++ and BufferedWriter.flush in Java or similar after each writing in your program. In standard (if you don\'t tweak I/O), endl flushes cout in C++ and System.out.println in Java (or println in Kotlin) makes automatic flush as well." 2200
1535D "Playoff Tournament" "data structures,dfs and similar,dp,implementation,trees" "2k teams participate in a playoff tournament. The tournament consists of 2k\xe2\x88\x921 games. They are held as follows: first of all, the teams are split into pairs: team 1 plays against team 2, team 3 plays against team 4 (exactly in this order), and so on (so, 2k\xe2\x88\x921 games are played in that phase). When a team loses a game, it is eliminated, and each game results in elimination of one team (there are no ties). After that, only 2k\xe2\x88\x921 teams remain. If only one team remains, it is declared the champion; otherwise, 2k\xe2\x88\x922 games are played: in the first one of them, the winner of the game ""1 vs 2"" plays against the winner of the game ""3 vs 4"", then the winner of the game ""5 vs 6"" plays against the winner of the game ""7 vs 8"", and so on. This process repeats until only one team remains.For example, this picture describes the chronological order of games with k=3:  Let the string s consisting of 2k\xe2\x88\x921 characters describe the results of the games in chronological order as follows:  if si is 0, then the team with lower index wins the i-th game;  if si is 1, then the team with greater index wins the i-th game;  if si is ?, then the result of the i-th game is unknown (any team could win this game). Let f(s) be the number of possible winners of the tournament described by the string s. A team i is a possible winner of the tournament if it is possible to replace every ? with either 1 or 0 in such a way that team i is the champion.You are given the initial state of the string s. You have to process q queries of the following form:   p c \xe2\x80\x94 replace sp with character c, and print f(s) as the result of the query." 1800
1535C "Unstable String" "binary search,dp,greedy,implementation,strings,two pointers" "You are given a string s consisting of the characters 0, 1, and ?.Let\'s call a string unstable if it consists of the characters 0 and 1 and any two adjacent characters are different (i. e. it has the form 010101... or 101010...).Let\'s call a string beautiful if it consists of the characters 0, 1, and ?, and you can replace the characters ? to 0 or 1 (for each character, the choice is independent), so that the string becomes unstable.For example, the strings 0??10, 0, and ??? are beautiful, and the strings 00 and ?1??1 are not.Calculate the number of beautiful contiguous substrings of the string s." 1400
1535B "Array Reodering" "brute force,greedy,math,number theory,sortings" "You are given an array a consisting of n integers.Let\'s call a pair of indices i, j good if 1\xe2\x89\xa4i<j\xe2\x89\xa4n and gcd(ai,2aj)>1 (where gcd(x,y) is the greatest common divisor of x and y).Find the maximum number of good index pairs if you can reorder the array a in an arbitrary way." 900
1535A "Fair Playoff" "brute force,implementation" "Four players participate in the playoff tournament. The tournament is held according to the following scheme: the first player will play with the second, and the third player with the fourth, then the winners of the pairs will play in the finals of the tournament.It is known that in a match between two players, the one whose skill is greater will win. The skill of the i-th player is equal to si and all skill levels are pairwise different (i.\xe2\x80\x89e. there are no two identical values in the array s).The tournament is called fair if the two players with the highest skills meet in the finals.Determine whether the given tournament is fair." 800
1534H "Lost Nodes" "constructive algorithms,dp,graphs,interactive,sortings,trees" "This is an interactive problem.As he qualified for IOI this year, Little Ericyi was given a gift from all his friends: a tree of n nodes!On the flight to IOI Little Ericyi was very bored, so he decided to play a game with Little Yvonne with his new tree. First, Little Yvonne selects two (not necessarily different) nodes a and b on the tree (without telling Ericyi), and then gives him a hint f (which is some node on the path from a to b).Then, Little Ericyi is able to ask the following question repeatedly: If I rooted the tree at node r (Ericyi gets to choose r), what would be the Lowest Common Ancestor of a and b?Little Ericyi\'s goal is to find the nodes a and b, and report them to Little Yvonne.However, Little Yvonne thought this game was too easy, so before he gives the hint f to Little Ericyi, he also wants him to first find the maximum number of queries required to determine a and b over all possibilities of a, b, and f assuming Little Ericyi plays optimally. Little Ericyi defines an optimal strategy as one that makes the minimum number of queries. Of course, once Little Ericyi replies with the maximum number of queries, Little Yvonne will only let him use that many queries in the game.The tree, a, b, and f are all fixed before the start of the game and do not change as queries are made." 3500
1534G "A New Beginning" "data structures,dp,geometry,sortings" "Annie has gotten bored of winning every coding contest and farming unlimited rating. Today, she is going to farm potatoes instead.Annie\'s garden is an infinite 2D plane. She has nn potatoes to plant, and the ii-th potato must be planted at (xi,yi)(xi,yi). Starting at the point (0,0)(0,0), Annie begins walking, in one step she can travel one unit right or up (increasing her xx or yy coordinate by 11 respectively). At any point (X,Y)(X,Y) during her walk she can plant some potatoes at arbitrary points using her potato gun, consuming max(|X\xe2\x88\x92x|,|Y\xe2\x88\x92y|)max(|X\xe2\x88\x92x|,|Y\xe2\x88\x92y|) units of energy in order to plant a potato at (x,y)(x,y). Find the minimum total energy required to plant every potato.Note that Annie may plant any number of potatoes from any point." 3300
1534F2 "Falling Sand (Hard Version)" "dfs and similar,dp,graphs,greedy" "This is the hard version of the problem. The difference between the versions is the constraints on ai. You can make hacks only if all versions of the problem are solved.Little Dormi has recently received a puzzle from his friend and needs your help to solve it. The puzzle consists of an upright board with n rows and m columns of cells, some empty and some filled with blocks of sand, and m non-negative integers a1,a2,\xe2\x80\xa6,am (0\xe2\x89\xa4ai\xe2\x89\xa4n). In this version of the problem, ai will always be not greater than the number of blocks of sand in column i.When a cell filled with a block of sand is disturbed, the block of sand will fall from its cell to the sand counter at the bottom of the column (each column has a sand counter). While a block of sand is falling, other blocks of sand that are adjacent at any point to the falling block of sand will also be disturbed and start to fall. Specifically, a block of sand disturbed at a cell (i,j) will pass through all cells below and including the cell (i,j) within the column, disturbing all adjacent cells along the way. Here, the cells adjacent to a cell (i,j) are defined as (i\xe2\x88\x921,j), (i,j\xe2\x88\x921), (i+1,j), and (i,j+1) (if they are within the grid). Note that the newly falling blocks can disturb other blocks.In one operation you are able to disturb any piece of sand. The puzzle is solved when there are at least ai blocks of sand counted in the i-th sand counter for each column from 1 to m.You are now tasked with finding the minimum amount of operations in order to solve the puzzle. Note that Little Dormi will never give you a puzzle that is impossible to solve." 3000
1534F1 "Falling Sand (Easy Version)" "dfs and similar,graphs,greedy" "This is the easy version of the problem. The difference between the versions is the constraints on aiai. You can make hacks only if all versions of the problem are solved.Little Dormi has recently received a puzzle from his friend and needs your help to solve it. The puzzle consists of an upright board with nn rows and mm columns of cells, some empty and some filled with blocks of sand, and mm non-negative integers a1,a2,\xe2\x80\xa6,ama1,a2,\xe2\x80\xa6,am (0\xe2\x89\xa4ai\xe2\x89\xa4n0\xe2\x89\xa4ai\xe2\x89\xa4n). In this version of the problem, aiai will be equal to the number of blocks of sand in column ii.When a cell filled with a block of sand is disturbed, the block of sand will fall from its cell to the sand counter at the bottom of the column (each column has a sand counter). While a block of sand is falling, other blocks of sand that are adjacent at any point to the falling block of sand will also be disturbed and start to fall. Specifically, a block of sand disturbed at a cell (i,j)(i,j) will pass through all cells below and including the cell (i,j)(i,j) within the column, disturbing all adjacent cells along the way. Here, the cells adjacent to a cell (i,j)(i,j) are defined as (i\xe2\x88\x921,j)(i\xe2\x88\x921,j), (i,j\xe2\x88\x921)(i,j\xe2\x88\x921), (i+1,j)(i+1,j), and (i,j+1)(i,j+1) (if they are within the grid). Note that the newly falling blocks can disturb other blocks.In one operation you are able to disturb any piece of sand. The puzzle is solved when there are at least aiai blocks of sand counted in the ii-th sand counter for each column from 11 to mm.You are now tasked with finding the minimum amount of operations in order to solve the puzzle. Note that Little Dormi will never give you a puzzle that is impossible to solve." 2500
1534E "Lost Array" "graphs,greedy,interactive,shortest paths" "This is an interactive problem.Note: the XOR-sum of an array a1,a2,\xe2\x80\xa6,an (1\xe2\x89\xa4ai\xe2\x89\xa4109) is defined as a1\xe2\x8a\x95a2\xe2\x8a\x95\xe2\x80\xa6\xe2\x8a\x95an, where \xe2\x8a\x95 denotes the bitwise XOR operation.Little Dormi received an array of n integers a1,a2,\xe2\x80\xa6,an for Christmas. However, while playing with it over the winter break, he accidentally dropped it into his XOR machine, and the array got lost.The XOR machine is currently configured with a query size of k (which you cannot change), and allows you to perform the following type of query: by giving the machine k distinct indices x1,x2,\xe2\x80\xa6,xk, it will output ax1\xe2\x8a\x95ax2\xe2\x8a\x95\xe2\x80\xa6\xe2\x8a\x95axk.As Little Dormi\'s older brother, you would like to help him recover the XOR-sum of his array a1,a2,\xe2\x80\xa6,an by querying the XOR machine.Little Dormi isn\'t very patient, so to be as fast as possible, you must query the XOR machine the minimum number of times to find the XOR-sum of his array. Formally, let d be the minimum number of queries needed to find the XOR-sum of any array of length n with a query size of k. Your program will be accepted if you find the correct XOR-sum in at most d queries.Lastly, you also noticed that with certain configurations of the machine k and values of n, it may not be possible to recover the XOR-sum of Little Dormi\'s lost array. If that is the case, you should report it as well.The array a1,a2,\xe2\x80\xa6,an is fixed before you start querying the XOR machine and does not change with the queries." 2300
1534D "Lost Tree" "constructive algorithms,interactive,trees" "This is an interactive problem.Little Dormi was faced with an awkward problem at the carnival: he has to guess the edges of an unweighted tree of n nodes! The nodes of the tree are numbered from 1 to n.The game master only allows him to ask one type of question: Little Dormi picks a node r (1\xe2\x89\xa4r\xe2\x89\xa4n), and the game master will reply with an array d1,d2,\xe2\x80\xa6,dn, where di is the length of the shortest path from node r to i, for all 1\xe2\x89\xa4i\xe2\x89\xa4n.Additionally, to make the game unfair challenge Little Dormi the game master will allow at most \xe2\x8c\x88n2\xe2\x8c\x89 questions, where \xe2\x8c\x88x\xe2\x8c\x89 denotes the smallest integer greater than or equal to x.Faced with the stomach-churning possibility of not being able to guess the tree, Little Dormi needs your help to devise a winning strategy!Note that the game master creates the tree before the game starts, and does not change it during the game." 1800
1534C "Little Alawn\'s Puzzle" combinatorics,dp,dsu,graphs,math "When he\'s not training for IOI, Little Alawn enjoys playing with puzzles of various types to stimulate his brain. Today, he\'s playing with a puzzle that consists of a 2\xc3\x97n grid where each row is a permutation of the numbers 1,2,3,\xe2\x80\xa6,n.The goal of Little Alawn\'s puzzle is to make sure no numbers on the same column or row are the same (we\'ll call this state of the puzzle as solved), and to achieve this he is able to swap the numbers in any column. However, after solving the puzzle many times, Little Alawn got bored and began wondering about the number of possible solved configurations of the puzzle he could achieve from an initial solved configuration only by swapping numbers in a column.Unfortunately, Little Alawn got stuck while trying to solve this harder problem, so he was wondering if you could help him with it. Find the answer modulo 109+7." 1300
1534B "Histogram Ugliness" greedy,implementation,math "Little Dormi received a histogram with nn bars of height a1,a2,\xe2\x80\xa6,ana1,a2,\xe2\x80\xa6,an for Christmas. However, the more he played with his new histogram, the more he realized its imperfections, so today he wanted to modify it to his liking.To modify the histogram, Little Dormi is able to perform the following operation an arbitrary number of times: Select an index ii (1\xe2\x89\xa4i\xe2\x89\xa4n1\xe2\x89\xa4i\xe2\x89\xa4n) where ai>0ai>0, and assign ai:=ai\xe2\x88\x921ai:=ai\xe2\x88\x921.Little Dormi defines the ugliness score of his histogram (after performing some number of operations) as the sum of the vertical length of its outline and the number of operations he performed on it. And to make the histogram as perfect as possible, he would like to minimize the ugliness score after modifying it with some number of operations.However, as his histogram is very large, Little Dormi is having trouble minimizing the ugliness score, so as Little Dormi\'s older brother, help him find the minimal ugliness.Consider the following example where the histogram has 44 columns of heights 4,8,9,64,8,9,6:  The blue region represents the histogram, and the red lines represent the vertical portion of the outline. Currently, the vertical length of the outline is 4+4+1+3+6=184+4+1+3+6=18, so if Little Dormi does not modify the histogram at all, the ugliness would be 1818.However, Little Dormi can apply the operation once on column 22 and twice on column 33, resulting in a histogram with heights 4,7,7,64,7,7,6:  Now, as the total vertical length of the outline (red lines) is 4+3+1+6=144+3+1+6=14, the ugliness is 14+3=1714+3=17 dollars. It can be proven that this is optimal." 1100
1534A "Colour the Flag" "brute force,implementation" "Today we will be playing a red and white colouring game (no, this is not the Russian Civil War; these are just the colours of the Canadian flag).You are given an n\xc3\x97m grid of ""R"", ""W"", and ""."" characters. ""R"" is red, ""W"" is white and ""."" is blank. The neighbours of a cell are those that share an edge with it (those that only share a corner do not count).Your job is to colour the blank cells red or white so that every red cell only has white neighbours (and no red ones) and every white cell only has red neighbours (and no white ones). You are not allowed to recolour already coloured cells." 800
1533J Pawns "*special problem" "There is an infinite chessboard, divided into cells. The cell (x,y) is the cell on the intersection of the xi-th row and yi-th column. n black pawns are placed on the board, the i-th black pawn occupies the cell (xi,yi).You want to capture all black pawns. In order to do so, you may perform the following actions:  place a white pawn into any empty cell (any cell having integer coordinates can be chosen, as long as it doesn\'t contain any pawns);  make a move with one of the white pawns according to the chess rules. Recall that when you make a move with a white pawn in the cell (x,y), the chess rules allow you to choose exactly one of these actions:   if there is a black pawn in the cell (x+1,y\xe2\x88\x921), you can capture it \xe2\x80\x94 the black pawn is removed from the board, and the white pawn moves to (x+1,y\xe2\x88\x921);  if there is a black pawn in the cell (x+1,y+1), you can capture it \xe2\x80\x94 the black pawn is removed from the board, and the white pawn moves to (x+1,y+1);  if the cell (x+1,y) is empty, you can move the white pawn to that cell. You may perform any finite sequence of actions (placing white pawns and moving them). You want to capture all of the black pawns, and it can be shown that it is always possible; and you want to do it placing as few white pawns as possible.What is the minimum number of white pawns you have to place to capture all n black pawns?" -999
1533I Excursions "*special problem,constructive algorithms,dfs and similar,flows,graph matchings,graphs" "Irina works in an excursion company in Saratov. Today, she is going to organize excursions in the cities of Saratov and Engels.There are n1 sights in Saratov and n2 sights in Engels. The cities are separated by a river, but there are m bus routes that go along the bridges and allow tourists to go from Saratov to Engels and vice versa. The i-th bus route goes from the xi-th sight in Saratov to the yi-th sight in Engels, and in the opposite direction as well.Irina wants to plan excursions for the current day. The excursion trips start in Saratov in the morning, continue in Engels in the afternoon, and finish in Saratov in the evening.Each tourist starts their excursion day at some sight in Saratov, ki tourists start at the i-th sight. Then the tour guides lead them to Engels: at each sight in Saratov, a tour guide chooses a bus route leading from this sight to Engels, and all the tourists starting from this sight transfer to Engels along this bus route. After the excursions in Engels are finished, the same thing happens: at each sight in Engels, a tour guide chooses a bus route leading from this sight to Saratov, and all the tourists at this sight transfer to Saratov along this bus route.This process can lead to a situation such that some tourists return to the same sight in Saratov where they started in the morning. Obviously, tourists don\'t like it; so Irina wants to choose where the tour guides take the tourists (both on the way from Saratov to Engels and on the way from Engels to Saratov), so that the minimum possible number of tourists return to the same sight where they started. Help Irina to find an optimal plan!" -999
1533H Submatrices "*special problem,bitmasks,data structures,dp" "You are given matrix s that contains n rows and m columns. Each element of a matrix is one of the 5 first Latin letters (in upper case).For each k (1\xe2\x89\xa4k\xe2\x89\xa45) calculate the number of submatrices that contain exactly k different letters. Recall that a submatrix of matrix s is a matrix that can be obtained from s after removing several (possibly zero) first rows, several (possibly zero) last rows, several (possibly zero) first columns, and several (possibly zero) last columns. If some submatrix can be obtained from s in two or more ways, you have to count this submatrix the corresponding number of times." -999
1533G "Biome Map" "*special problem,constructive algorithms,dfs and similar,graphs" "Polycarp decided to generate a biome map for his game. A map is a matrix divided into cells 1\xc3\x971. Each cell of the map must contain one of the available biomes.Each biome is defined by two parameters: temperature (an integer from 1 to n) and humidity (an integer from 1 to m). But not for every temperature/humidity combination, a corresponding biome is available.The biome map should be generated according to the following rules:  each cell of the map belongs to exactly one biome;  each available biome has at least one cell on the map;  if two cells of the map are adjacent by the side and they belong to biomes with parameters (t1,h1) and (t2,h2), respectively, then the equality |t1\xe2\x88\x92t2|+|h1\xe2\x88\x92h2|=1 holds;  let the number of available biomes be equal to k, then the number of rows and columns of the map (separately) should not exceed k. Help Polycarp generate a biome map that meets all the conditions described above (or report that this is impossible)." -999
1533F "Binary String Partition" "*special problem,binary search,greedy" "Let\'s call a string t consisting of characters 0 and/or 1 beautiful, if either the number of occurrences of character 0 in this string does not exceed k, or the number of occurrences of characters 1 in this string does not exceed k (or both). For example, if k=3, the strings 101010, 111, 0, 00000, 1111111000 are beautiful, and the strings 1111110000, 01010101 are not beautiful.You are given a string s. You have to divide it into the minimum possible number of beautiful strings, i.\xe2\x80\x89e., find a sequence of strings t1,t2,\xe2\x80\xa6,tm such that every ti is beautiful, t1+t2+\xe2\x8b\xaf+tm=s (where + is the concatenation operator), and m is minimum possible.For every k from 1 to |s|, find the minimum possible number of strings such that s can be divided into them (i.\xe2\x80\x89e. the minimum possible m in the partition)." -999
1533E "Chess Team Forming" "*special problem,binary search,data structures,greedy" "Polycarp is coaching a team for an upcoming game at the chess tournament. A complete team for the tournament should consist of n+1 members.There are n members in his team, the i-th member\'s skill value is ai. Polycarp is yet to choose the final member for the team.The opposing team has n+1 members, the j-th member\'s skill value is bj.Polycarp has m options for the final player of the team. The k-th of them has a skill value ck.Before the game starts, Polycarp pairs up the members of his team with the members of the opposing team. Every member of both teams is in exactly one pair. The difficulty of a game for a certain player is the difference between his paired opponent\'s skill and his own skill. So if the i-th player of the Polycarp\'s team is paired up with the j-th member of the opposing team, then the difficulty is equal to bj\xe2\x88\x92ai. The difficulty of the game for a team is the maximum difficulty of all its players.So, before the game starts, Polycarp wants to pair up the players in such a way that the difficulty of the game for his team is minimized.For each of the m options for the final player print the smallest difficulty of the game for the team Polycarp can achieve." -999
1533D "String Searching" "*special problem,hashing" "You are given an array s consisting of n different strings. Each string consists of m lowercase Latin letters.You have to respond to q queries. Each query contains a string t of length m+1. Count the number of indices i, such that the string t can be obtained from the string si, if it is allowed to insert one letter in an arbitrary position." -999
1533C Sweets "*special problem,data structures,implementation" "Anya came to her friend\'s birthday party. There are n delicious sweets on a circle table (for convenience, we will number them from 1 to n in clockwise direction). For each of the sweets, it is known whether Anya likes it or not. Anya decided that she should eat all the sweets that are on the table, and she likes them.However, eating all the sweets in some random order is too boring. Therefore, Anya came up with a game that will make the process of eating sweets more interesting.The game is played according to the following rules:  if there are no sweets that Anya likes left on the table, then the game ends;  at the very beginning of the game, if there is at least one sweet on the table that Anya wants to eat, she eats the sweet number 1;  after Anya has eaten some sweet, she counts k sweets clockwise, starting from the next sweet in the circle, and eats the k-th sweet in the count (if there are less than k sweets in the circle, some sweets can participate in the count more than once, and the last sweet in the count is picked). Obviously, the sweets that have already been eaten do not participate in the count. For example, let 6 sweets be arranged in a circle, Anya likes sweets 4, 5 and 6, k=4. Then the game goes as follows:  initially there are sweets [1,2,3,4,5,6] on the table, Anya chooses the sweet number 1.  Anya eats the sweet number 1, after that, there are sweets [2,3,4,5,6] on the table. Anya counts 4 sweets, starting with the 2-nd sweet, and stops at the 5-th sweet.  Anya eats the 5-th sweet, after that, there are sweets [2,3,4,6] on the table. Anya counts 4 sweets, starting with the 6-th sweet, and stops at the 4-th sweet.  Anya eats the sweet number 4, after that, there are sweets [2,3,6] on the table. Anya counts 4 sweets, starting with the 6-th sweet, and stops at the 6-th sweet.  Anya eats the sweet number 6, after that, there are sweets [2,3] on the table. There are no sweets that Anya likes on the table, so the game ends. Your task is to calculate the number of sweets that Anya will eat." -999
1533B "Nearest Point Function" "*special problem,implementation" "Your friend has created a nearest point function. For a given array of integer points x (sorted in ascending order, without any duplicates) and a point y it can find the nearest point from x to the point y. In other words, it will find such a point xi that |y\xe2\x88\x92xi| is the minimum possible, where |a| is the absolute value of a.For example, if x=[1,2,5,7,9,11], the answer for y=3 will be 2, the answer for y=5 will be 5 and the answer for y=100 will be 11.This function is a bit buggy, though. If there are several nearest points to the given one, the function crashes. For example, if x=[1,2,5,7,9,11] (as above) and y=6, the function will crash, since points 5 and 7 are both the nearest points for 6.Your task is, for a given array of integer points x (sorted in ascending order, without any duplicates), determine if it is possible to cause the function to crash by choosing some integer point y.You have to answer t independent test cases." -999
1533A "Travel to Bertown" "*special problem,implementation,math" "Vika has decided to go on a trip to Bertown. She comes to Bertown on the k-th day. Vika does not want to spend money on hotels, fortunately she has n friends who live in Bertown and allow Vika to stay at their houses. The i-th friend told Vika that she could stay at their house from the li-th day till the ri-th day, inclusive.Vika decided that she would stay at no more than one friend\'s house. Help Vika determine the maximum number of days that she will be able to stay in Bertown." -999
1532F "Prefixes and Suffixes" "*special problem,strings" "Ivan wants to play a game with you. He picked some string s of length n consisting only of lowercase Latin letters. You don\'t know this string. Ivan has informed you about all its improper prefixes and suffixes (i.e. prefixes and suffixes of lengths from 1 to n\xe2\x88\x921), but he didn\'t tell you which strings are prefixes and which are suffixes.Ivan wants you to guess which of the given 2n\xe2\x88\x922 strings are prefixes of the given string and which are suffixes. It may be impossible to guess the string Ivan picked (since multiple strings may give the same set of suffixes and prefixes), but Ivan will accept your answer if there is at least one string that is consistent with it. Let the game begin!" -999
1532E "Good Array" "*special problem" "Let\'s call an array good if there is an element in the array that equals to the sum of all other elements. For example, the array a=[1,3,3,7] is good because there is the element a4=7 which equals to the sum 1+3+3.You are given an array a consisting of n integers. Your task is to print all indices j of this array such that after removing the j-th element from the array it will be good (let\'s call such indices nice).For example, if a=[8,3,5,2], the nice indices are 1 and 4:   if you remove a1, the array will look like [3,5,2] and it is good;  if you remove a4, the array will look like [8,3,5] and it is good. You have to consider all removals independently, i.\xe2\x80\x89e. remove the element, check if the resulting array is good, and return the element into the array." -999
1532D "Teams Forming" "*special problem,sortings" "There are n students in a university. The number of students is even. The i-th student has programming skill equal to ai. The coach wants to form n2 teams. Each team should consist of exactly two students, and each student should belong to exactly one team. Two students can form a team only if their skills are equal (otherwise they cannot understand each other and cannot form a team).Students can solve problems to increase their skill. One solved problem increases the skill by one.The coach wants to know the minimum total number of problems students should solve to form exactly n2 teams (i.e. each pair of students should form a team). Your task is to find this number." -999
1532C "Uniform String" "*special problem,implementation" "You are given two integers n and k.Your task is to construct such a string s of length n that for each i from 1 to k there is at least one i-th letter of the Latin alphabet in this string (the first letter is \'a\', the second is \'b\' and so on) and there are no other letters except these. You have to maximize the minimal frequency of some letter (the frequency of a letter is the number of occurrences of this letter in a string). If there are several possible answers, you can print any.You have to answer t independent queries." -999
1532B "Frog Jumping" "*special problem,math" "A frog is currently at the point 0 on a coordinate axis Ox. It jumps by the following algorithm: the first jump is a units to the right, the second jump is b units to the left, the third jump is a units to the right, the fourth jump is b units to the left, and so on.Formally:   if the frog has jumped an even number of times (before the current jump), it jumps from its current position x to position x+a;  otherwise it jumps from its current position x to position x\xe2\x88\x92b. Your task is to calculate the position of the frog after k jumps.But... One more thing. You are watching t different frogs so you have to answer t independent queries." -999
1532A "A+B (Trial Problem)" "*special problem" "You are given two integers a and b. Print a+b." -999
1531E3 "\xd0\xa1\xd0\xbe\xd1\x80\xd1\x82\xd0\xb8\xd1\x80\xd0\xbe\xd0\xb2\xd0\xba\xd0\xb0 \xd1\x81\xd0\xbb\xd0\xb8\xd1\x8f\xd0\xbd\xd0\xb8\xd0\xb5\xd0\xbc" "*special problem,binary search" "\xd0\xa0\xd0\xb0\xd1\x81\xd1\x81\xd0\xbc\xd0\xbe\xd1\x82\xd1\x80\xd0\xb8\xd0\xbc \xd1\x81\xd0\xbb\xd0\xb5\xd0\xb4\xd1\x83\xd1\x8e\xd1\x89\xd0\xb8\xd0\xb9 \xd0\xba\xd0\xbe\xd0\xb4 \xd1\x81\xd0\xbe\xd1\x80\xd1\x82\xd0\xb8\xd1\x80\xd0\xbe\xd0\xb2\xd0\xba\xd0\xb8 \xd1\x81\xd0\xbb\xd0\xb8\xd1\x8f\xd0\xbd\xd0\xb8\xd0\xb5\xd0\xbc \xd0\xbd\xd0\xb0 \xd1\x8f\xd0\xb7\xd1\x8b\xd0\xba\xd0\xb5 Python: def sort(a):  n = len(a)  b = [0 for i in range(n)]  log = []  def mergeSort(l, r):    if r - l <= 1:      return    m = (l + r) >> 1    mergeSort(l, m)    mergeSort(m, r)    i, j, k = l, m, l    while i < m and j < r:      if a[i] < a[j]:        log.append(\'0\')        b[k] = a[i]        i += 1      else:        log.append(\'1\')        b[k] = a[j]        j += 1      k += 1    while i < m:      b[k] = a[i]      i += 1      k += 1    while j < r:      b[k] = a[j]      j += 1      k += 1    for p in range(l, r):      a[p] = b[p]  mergeSort(0, n)  return """".join(log)\xd0\x9a\xd0\xb0\xd0\xba \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xbd\xd0\xbe \xd0\xb7\xd0\xb0\xd0\xbc\xd0\xb5\xd1\x82\xd0\xb8\xd1\x82\xd1\x8c, \xd1\x8d\xd1\x82\xd0\xbe\xd1\x82 \xd0\xba\xd0\xbe\xd0\xb4 \xd0\xb8\xd1\x81\xd0\xbf\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xb7\xd1\x83\xd0\xb5\xd1\x82 \xd0\xbb\xd0\xbe\xd0\xb3\xd0\xb8\xd1\x80\xd0\xbe\xd0\xb2\xd0\xb0\xd0\xbd\xd0\xb8\xd0\xb5 \xe2\x80\x94 \xd0\xb2\xd0\xb0\xd0\xb6\xd0\xbd\xd0\xb5\xd0\xb9\xd1\x88\xd0\xb8\xd0\xb9 \xd0\xb8\xd0\xbd\xd1\x81\xd1\x82\xd1\x80\xd1\x83\xd0\xbc\xd0\xb5\xd0\xbd\xd1\x82 \xd1\x80\xd0\xb0\xd0\xb7\xd1\x80\xd0\xb0\xd0\xb1\xd0\xbe\xd1\x82\xd0\xba\xd0\xb8.\xd0\xa1\xd1\x82\xd0\xb0\xd1\x80\xd1\x88\xd0\xb8\xd0\xb9 \xd1\x80\xd0\xb0\xd0\xb7\xd1\x80\xd0\xb0\xd0\xb1\xd0\xbe\xd1\x82\xd1\x87\xd0\xb8\xd0\xba \xd0\x92\xd0\x9a\xd0\xbe\xd0\xbd\xd1\x82\xd0\xb0\xd0\xba\xd1\x82\xd0\xb5 \xd0\x92\xd0\xb0\xd1\x81\xd1\x8f \xd1\x81\xd0\xb3\xd0\xb5\xd0\xbd\xd0\xb5\xd1\x80\xd0\xb8\xd1\x80\xd0\xbe\xd0\xb2\xd0\xb0\xd0\xbb \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb5\xd1\x81\xd1\x82\xd0\xb0\xd0\xbd\xd0\xbe\xd0\xb2\xd0\xba\xd1\x83 a (\xd0\xbc\xd0\xb0\xd1\x81\xd1\x81\xd0\xb8\xd0\xb2 \xd0\xb8\xd0\xb7 n \xd1\x80\xd0\xb0\xd0\xb7\xd0\xbb\xd0\xb8\xd1\x87\xd0\xbd\xd1\x8b\xd1\x85 \xd1\x86\xd0\xb5\xd0\xbb\xd1\x8b\xd1\x85 \xd1\x87\xd0\xb8\xd1\x81\xd0\xb5\xd0\xbb \xd0\xbe\xd1\x82 1 \xd0\xb4\xd0\xbe n), \xd0\xb4\xd0\xb0\xd0\xbb \xd0\xb5\xd1\x91 \xd0\xbd\xd0\xb0 \xd0\xb2\xd1\x85\xd0\xbe\xd0\xb4 \xd1\x84\xd1\x83\xd0\xbd\xd0\xba\xd1\x86\xd0\xb8\xd0\xb8 sort \xd0\xb8 \xd0\xbf\xd0\xbe\xd0\xbb\xd1\x83\xd1\x87\xd0\xb8\xd0\xbb \xd0\xbd\xd0\xb0 \xd0\xb2\xd1\x8b\xd1\x85\xd0\xbe\xd0\xb4\xd0\xb5 \xd1\x81\xd1\x82\xd1\x80\xd0\xbe\xd0\xba\xd1\x83 s. \xd0\x9d\xd0\xb0 \xd1\x81\xd0\xbb\xd0\xb5\xd0\xb4\xd1\x83\xd1\x8e\xd1\x89\xd0\xb8\xd0\xb9 \xd0\xb4\xd0\xb5\xd0\xbd\xd1\x8c \xd1\x81\xd1\x82\xd1\x80\xd0\xbe\xd0\xba\xd1\x83 s \xd0\x92\xd0\xb0\xd1\x81\xd1\x8f \xd0\xbd\xd0\xb0\xd1\x88\xd1\x91\xd0\xbb, \xd0\xb0 \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb5\xd1\x81\xd1\x82\xd0\xb0\xd0\xbd\xd0\xbe\xd0\xb2\xd0\xba\xd0\xb0 a \xd0\xbf\xd0\xbe\xd1\x82\xd0\xb5\xd1\x80\xd1\x8f\xd0\xbb\xd0\xb0\xd1\x81\xd1\x8c. \xd0\x92\xd0\xb0\xd1\x81\xd1\x8f \xd1\x85\xd0\xbe\xd1\x87\xd0\xb5\xd1\x82 \xd0\xb2\xd0\xbe\xd1\x81\xd1\x81\xd1\x82\xd0\xb0\xd0\xbd\xd0\xbe\xd0\xb2\xd0\xb8\xd1\x82\xd1\x8c \xd0\xbb\xd1\x8e\xd0\xb1\xd1\x83\xd1\x8e \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb5\xd1\x81\xd1\x82\xd0\xb0\xd0\xbd\xd0\xbe\xd0\xb2\xd0\xba\xd1\x83 a \xd1\x82\xd0\xb0\xd0\xba\xd1\x83\xd1\x8e, \xd1\x87\xd1\x82\xd0\xbe \xd0\xb2\xd1\x8b\xd0\xb7\xd0\xbe\xd0\xb2 \xd1\x84\xd1\x83\xd0\xbd\xd0\xba\xd1\x86\xd0\xb8\xd0\xb8 sort \xd0\xbe\xd1\x82 \xd0\xbd\xd0\xb5\xd1\x91 \xd0\xb4\xd0\xb0\xd1\x81\xd1\x82 \xd1\x82\xd1\x83 \xd0\xb6\xd0\xb5 \xd1\x81\xd1\x82\xd1\x80\xd0\xbe\xd0\xba\xd1\x83 s. \xd0\x9f\xd0\xbe\xd0\xbc\xd0\xbe\xd0\xb3\xd0\xb8\xd1\x82\xd0\xb5 \xd0\xb5\xd0\xbc\xd1\x83!" -999
1531E2 "\xd0\xa1\xd0\xbe\xd1\x80\xd1\x82\xd0\xb8\xd1\x80\xd0\xbe\xd0\xb2\xd0\xba\xd0\xb0 \xd1\x81\xd0\xbb\xd0\xb8\xd1\x8f\xd0\xbd\xd0\xb8\xd0\xb5\xd0\xbc" "*special problem,*special problem,brute force" "\xd0\xa0\xd0\xb0\xd1\x81\xd1\x81\xd0\xbc\xd0\xbe\xd1\x82\xd1\x80\xd0\xb8\xd0\xbc \xd1\x81\xd0\xbb\xd0\xb5\xd0\xb4\xd1\x83\xd1\x8e\xd1\x89\xd0\xb8\xd0\xb9 \xd0\xba\xd0\xbe\xd0\xb4 \xd1\x81\xd0\xbe\xd1\x80\xd1\x82\xd0\xb8\xd1\x80\xd0\xbe\xd0\xb2\xd0\xba\xd0\xb8 \xd1\x81\xd0\xbb\xd0\xb8\xd1\x8f\xd0\xbd\xd0\xb8\xd0\xb5\xd0\xbc \xd0\xbd\xd0\xb0 \xd1\x8f\xd0\xb7\xd1\x8b\xd0\xba\xd0\xb5 Python: def sort(a):  n = len(a)  b = [0 for i in range(n)]  log = []  def mergeSort(l, r):    if r - l <= 1:      return    m = (l + r) >> 1    mergeSort(l, m)    mergeSort(m, r)    i, j, k = l, m, l    while i < m and j < r:      if a[i] < a[j]:        log.append(\'0\')        b[k] = a[i]        i += 1      else:        log.append(\'1\')        b[k] = a[j]        j += 1      k += 1    while i < m:      b[k] = a[i]      i += 1      k += 1    while j < r:      b[k] = a[j]      j += 1      k += 1    for p in range(l, r):      a[p] = b[p]  mergeSort(0, n)  return """".join(log)\xd0\x9a\xd0\xb0\xd0\xba \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xbd\xd0\xbe \xd0\xb7\xd0\xb0\xd0\xbc\xd0\xb5\xd1\x82\xd0\xb8\xd1\x82\xd1\x8c, \xd1\x8d\xd1\x82\xd0\xbe\xd1\x82 \xd0\xba\xd0\xbe\xd0\xb4 \xd0\xb8\xd1\x81\xd0\xbf\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xb7\xd1\x83\xd0\xb5\xd1\x82 \xd0\xbb\xd0\xbe\xd0\xb3\xd0\xb8\xd1\x80\xd0\xbe\xd0\xb2\xd0\xb0\xd0\xbd\xd0\xb8\xd0\xb5 \xe2\x80\x94 \xd0\xb2\xd0\xb0\xd0\xb6\xd0\xbd\xd0\xb5\xd0\xb9\xd1\x88\xd0\xb8\xd0\xb9 \xd0\xb8\xd0\xbd\xd1\x81\xd1\x82\xd1\x80\xd1\x83\xd0\xbc\xd0\xb5\xd0\xbd\xd1\x82 \xd1\x80\xd0\xb0\xd0\xb7\xd1\x80\xd0\xb0\xd0\xb1\xd0\xbe\xd1\x82\xd0\xba\xd0\xb8.\xd0\xa1\xd1\x82\xd0\xb0\xd1\x80\xd1\x88\xd0\xb8\xd0\xb9 \xd1\x80\xd0\xb0\xd0\xb7\xd1\x80\xd0\xb0\xd0\xb1\xd0\xbe\xd1\x82\xd1\x87\xd0\xb8\xd0\xba \xd0\x92\xd0\x9a\xd0\xbe\xd0\xbd\xd1\x82\xd0\xb0\xd0\xba\xd1\x82\xd0\xb5 \xd0\x92\xd0\xb0\xd1\x81\xd1\x8f \xd1\x81\xd0\xb3\xd0\xb5\xd0\xbd\xd0\xb5\xd1\x80\xd0\xb8\xd1\x80\xd0\xbe\xd0\xb2\xd0\xb0\xd0\xbb \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb5\xd1\x81\xd1\x82\xd0\xb0\xd0\xbd\xd0\xbe\xd0\xb2\xd0\xba\xd1\x83 a (\xd0\xbc\xd0\xb0\xd1\x81\xd1\x81\xd0\xb8\xd0\xb2 \xd0\xb8\xd0\xb7 n \xd1\x80\xd0\xb0\xd0\xb7\xd0\xbb\xd0\xb8\xd1\x87\xd0\xbd\xd1\x8b\xd1\x85 \xd1\x86\xd0\xb5\xd0\xbb\xd1\x8b\xd1\x85 \xd1\x87\xd0\xb8\xd1\x81\xd0\xb5\xd0\xbb \xd0\xbe\xd1\x82 1 \xd0\xb4\xd0\xbe n), \xd0\xb4\xd0\xb0\xd0\xbb \xd0\xb5\xd1\x91 \xd0\xbd\xd0\xb0 \xd0\xb2\xd1\x85\xd0\xbe\xd0\xb4 \xd1\x84\xd1\x83\xd0\xbd\xd0\xba\xd1\x86\xd0\xb8\xd0\xb8 sort \xd0\xb8 \xd0\xbf\xd0\xbe\xd0\xbb\xd1\x83\xd1\x87\xd0\xb8\xd0\xbb \xd0\xbd\xd0\xb0 \xd0\xb2\xd1\x8b\xd1\x85\xd0\xbe\xd0\xb4\xd0\xb5 \xd1\x81\xd1\x82\xd1\x80\xd0\xbe\xd0\xba\xd1\x83 s. \xd0\x9d\xd0\xb0 \xd1\x81\xd0\xbb\xd0\xb5\xd0\xb4\xd1\x83\xd1\x8e\xd1\x89\xd0\xb8\xd0\xb9 \xd0\xb4\xd0\xb5\xd0\xbd\xd1\x8c \xd1\x81\xd1\x82\xd1\x80\xd0\xbe\xd0\xba\xd1\x83 s \xd0\x92\xd0\xb0\xd1\x81\xd1\x8f \xd0\xbd\xd0\xb0\xd1\x88\xd1\x91\xd0\xbb, \xd0\xb0 \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb5\xd1\x81\xd1\x82\xd0\xb0\xd0\xbd\xd0\xbe\xd0\xb2\xd0\xba\xd0\xb0 a \xd0\xbf\xd0\xbe\xd1\x82\xd0\xb5\xd1\x80\xd1\x8f\xd0\xbb\xd0\xb0\xd1\x81\xd1\x8c. \xd0\x92\xd0\xb0\xd1\x81\xd1\x8f \xd1\x85\xd0\xbe\xd1\x87\xd0\xb5\xd1\x82 \xd0\xb2\xd0\xbe\xd1\x81\xd1\x81\xd1\x82\xd0\xb0\xd0\xbd\xd0\xbe\xd0\xb2\xd0\xb8\xd1\x82\xd1\x8c \xd0\xbb\xd1\x8e\xd0\xb1\xd1\x83\xd1\x8e \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb5\xd1\x81\xd1\x82\xd0\xb0\xd0\xbd\xd0\xbe\xd0\xb2\xd0\xba\xd1\x83 a \xd1\x82\xd0\xb0\xd0\xba\xd1\x83\xd1\x8e, \xd1\x87\xd1\x82\xd0\xbe \xd0\xb2\xd1\x8b\xd0\xb7\xd0\xbe\xd0\xb2 \xd1\x84\xd1\x83\xd0\xbd\xd0\xba\xd1\x86\xd0\xb8\xd0\xb8 sort \xd0\xbe\xd1\x82 \xd0\xbd\xd0\xb5\xd1\x91 \xd0\xb4\xd0\xb0\xd1\x81\xd1\x82 \xd1\x82\xd1\x83 \xd0\xb6\xd0\xb5 \xd1\x81\xd1\x82\xd1\x80\xd0\xbe\xd0\xba\xd1\x83 s. \xd0\x9f\xd0\xbe\xd0\xbc\xd0\xbe\xd0\xb3\xd0\xb8\xd1\x82\xd0\xb5 \xd0\xb5\xd0\xbc\xd1\x83!" -999
1531E1 "\xd0\xa1\xd0\xbe\xd1\x80\xd1\x82\xd0\xb8\xd1\x80\xd0\xbe\xd0\xb2\xd0\xba\xd0\xb0 \xd1\x81\xd0\xbb\xd0\xb8\xd1\x8f\xd0\xbd\xd0\xb8\xd0\xb5\xd0\xbc" "*special problem" "\xd0\xa0\xd0\xb0\xd1\x81\xd1\x81\xd0\xbc\xd0\xbe\xd1\x82\xd1\x80\xd0\xb8\xd0\xbc \xd1\x81\xd0\xbb\xd0\xb5\xd0\xb4\xd1\x83\xd1\x8e\xd1\x89\xd0\xb8\xd0\xb9 \xd0\xba\xd0\xbe\xd0\xb4 \xd1\x81\xd0\xbe\xd1\x80\xd1\x82\xd0\xb8\xd1\x80\xd0\xbe\xd0\xb2\xd0\xba\xd0\xb8 \xd1\x81\xd0\xbb\xd0\xb8\xd1\x8f\xd0\xbd\xd0\xb8\xd0\xb5\xd0\xbc \xd0\xbd\xd0\xb0 \xd1\x8f\xd0\xb7\xd1\x8b\xd0\xba\xd0\xb5 Python: def sort(a):  n = len(a)  b = [0 for i in range(n)]  log = []  def mergeSort(l, r):    if r - l <= 1:      return    m = (l + r) >> 1    mergeSort(l, m)    mergeSort(m, r)    i, j, k = l, m, l    while i < m and j < r:      if a[i] < a[j]:        log.append(\'0\')        b[k] = a[i]        i += 1      else:        log.append(\'1\')        b[k] = a[j]        j += 1      k += 1    while i < m:      b[k] = a[i]      i += 1      k += 1    while j < r:      b[k] = a[j]      j += 1      k += 1    for p in range(l, r):      a[p] = b[p]  mergeSort(0, n)  return """".join(log)\xd0\x9a\xd0\xb0\xd0\xba \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xbd\xd0\xbe \xd0\xb7\xd0\xb0\xd0\xbc\xd0\xb5\xd1\x82\xd0\xb8\xd1\x82\xd1\x8c, \xd1\x8d\xd1\x82\xd0\xbe\xd1\x82 \xd0\xba\xd0\xbe\xd0\xb4 \xd0\xb8\xd1\x81\xd0\xbf\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xb7\xd1\x83\xd0\xb5\xd1\x82 \xd0\xbb\xd0\xbe\xd0\xb3\xd0\xb8\xd1\x80\xd0\xbe\xd0\xb2\xd0\xb0\xd0\xbd\xd0\xb8\xd0\xb5 \xe2\x80\x94 \xd0\xb2\xd0\xb0\xd0\xb6\xd0\xbd\xd0\xb5\xd0\xb9\xd1\x88\xd0\xb8\xd0\xb9 \xd0\xb8\xd0\xbd\xd1\x81\xd1\x82\xd1\x80\xd1\x83\xd0\xbc\xd0\xb5\xd0\xbd\xd1\x82 \xd1\x80\xd0\xb0\xd0\xb7\xd1\x80\xd0\xb0\xd0\xb1\xd0\xbe\xd1\x82\xd0\xba\xd0\xb8.\xd0\xa1\xd1\x82\xd0\xb0\xd1\x80\xd1\x88\xd0\xb8\xd0\xb9 \xd1\x80\xd0\xb0\xd0\xb7\xd1\x80\xd0\xb0\xd0\xb1\xd0\xbe\xd1\x82\xd1\x87\xd0\xb8\xd0\xba \xd0\x92\xd0\x9a\xd0\xbe\xd0\xbd\xd1\x82\xd0\xb0\xd0\xba\xd1\x82\xd0\xb5 \xd0\x92\xd0\xb0\xd1\x81\xd1\x8f \xd1\x81\xd0\xb3\xd0\xb5\xd0\xbd\xd0\xb5\xd1\x80\xd0\xb8\xd1\x80\xd0\xbe\xd0\xb2\xd0\xb0\xd0\xbb \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb5\xd1\x81\xd1\x82\xd0\xb0\xd0\xbd\xd0\xbe\xd0\xb2\xd0\xba\xd1\x83 a (\xd0\xbc\xd0\xb0\xd1\x81\xd1\x81\xd0\xb8\xd0\xb2 \xd0\xb8\xd0\xb7 n \xd1\x80\xd0\xb0\xd0\xb7\xd0\xbb\xd0\xb8\xd1\x87\xd0\xbd\xd1\x8b\xd1\x85 \xd1\x86\xd0\xb5\xd0\xbb\xd1\x8b\xd1\x85 \xd1\x87\xd0\xb8\xd1\x81\xd0\xb5\xd0\xbb \xd0\xbe\xd1\x82 1 \xd0\xb4\xd0\xbe n), \xd0\xb4\xd0\xb0\xd0\xbb \xd0\xb5\xd1\x91 \xd0\xbd\xd0\xb0 \xd0\xb2\xd1\x85\xd0\xbe\xd0\xb4 \xd1\x84\xd1\x83\xd0\xbd\xd0\xba\xd1\x86\xd0\xb8\xd0\xb8 sort \xd0\xb8 \xd0\xbf\xd0\xbe\xd0\xbb\xd1\x83\xd1\x87\xd0\xb8\xd0\xbb \xd0\xbd\xd0\xb0 \xd0\xb2\xd1\x8b\xd1\x85\xd0\xbe\xd0\xb4\xd0\xb5 \xd1\x81\xd1\x82\xd1\x80\xd0\xbe\xd0\xba\xd1\x83 s. \xd0\x9d\xd0\xb0 \xd1\x81\xd0\xbb\xd0\xb5\xd0\xb4\xd1\x83\xd1\x8e\xd1\x89\xd0\xb8\xd0\xb9 \xd0\xb4\xd0\xb5\xd0\xbd\xd1\x8c \xd1\x81\xd1\x82\xd1\x80\xd0\xbe\xd0\xba\xd1\x83 s \xd0\x92\xd0\xb0\xd1\x81\xd1\x8f \xd0\xbd\xd0\xb0\xd1\x88\xd1\x91\xd0\xbb, \xd0\xb0 \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb5\xd1\x81\xd1\x82\xd0\xb0\xd0\xbd\xd0\xbe\xd0\xb2\xd0\xba\xd0\xb0 a \xd0\xbf\xd0\xbe\xd1\x82\xd0\xb5\xd1\x80\xd1\x8f\xd0\xbb\xd0\xb0\xd1\x81\xd1\x8c. \xd0\x92\xd0\xb0\xd1\x81\xd1\x8f \xd1\x85\xd0\xbe\xd1\x87\xd0\xb5\xd1\x82 \xd0\xb2\xd0\xbe\xd1\x81\xd1\x81\xd1\x82\xd0\xb0\xd0\xbd\xd0\xbe\xd0\xb2\xd0\xb8\xd1\x82\xd1\x8c \xd0\xbb\xd1\x8e\xd0\xb1\xd1\x83\xd1\x8e \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb5\xd1\x81\xd1\x82\xd0\xb0\xd0\xbd\xd0\xbe\xd0\xb2\xd0\xba\xd1\x83 a \xd1\x82\xd0\xb0\xd0\xba\xd1\x83\xd1\x8e, \xd1\x87\xd1\x82\xd0\xbe \xd0\xb2\xd1\x8b\xd0\xb7\xd0\xbe\xd0\xb2 \xd1\x84\xd1\x83\xd0\xbd\xd0\xba\xd1\x86\xd0\xb8\xd0\xb8 sort \xd0\xbe\xd1\x82 \xd0\xbd\xd0\xb5\xd1\x91 \xd0\xb4\xd0\xb0\xd1\x81\xd1\x82 \xd1\x82\xd1\x83 \xd0\xb6\xd0\xb5 \xd1\x81\xd1\x82\xd1\x80\xd0\xbe\xd0\xba\xd1\x83 s. \xd0\x9f\xd0\xbe\xd0\xbc\xd0\xbe\xd0\xb3\xd0\xb8\xd1\x82\xd0\xb5 \xd0\xb5\xd0\xbc\xd1\x83!" -999
1531D "\xd0\xa0\xd0\xb5\xd0\xb4\xd0\xb0\xd0\xba\xd1\x82\xd0\xb8\xd1\x80\xd1\x83\xd0\xb5\xd0\xbc \xd0\x97\xd0\xb8\xd0\xbd\xd0\xb3\xd0\xb5\xd1\x80 | color" "*special problem,*special problem" "\xd0\x9d\xd0\xb5\xd0\xbc\xd0\xbd\xd0\xbe\xd0\xb3\xd0\xb8\xd0\xb5 \xd0\xb7\xd0\xbd\xd0\xb0\xd1\x8e\xd1\x82, \xd1\x87\xd1\x82\xd0\xbe \xd1\x81\xd0\xbe\xd1\x82\xd1\x80\xd1\x83\xd0\xb4\xd0\xbd\xd0\xb8\xd0\xba\xd0\xb8 \xd0\x92\xd0\x9a\xd0\xbe\xd0\xbd\xd1\x82\xd0\xb0\xd0\xba\xd1\x82\xd0\xb5 \xd0\xbc\xd0\xbe\xd0\xb3\xd1\x83\xd1\x82 \xd0\xbc\xd0\xb5\xd0\xbd\xd1\x8f\xd1\x82\xd1\x8c \xd1\x86\xd0\xb2\xd0\xb5\xd1\x82 \xd0\xbf\xd0\xbe\xd0\xb4\xd1\x81\xd0\xb2\xd0\xb5\xd1\x82\xd0\xba\xd0\xb8 \xd0\xb2 \xd0\xba\xd1\x83\xd0\xbf\xd0\xbe\xd0\xbb\xd0\xb5 \xd0\xb7\xd0\xbd\xd0\xb0\xd0\xbc\xd0\xb5\xd0\xbd\xd0\xb8\xd1\x82\xd0\xbe\xd0\xb3\xd0\xbe \xd0\x94\xd0\xbe\xd0\xbc\xd0\xb0 \xd0\x97\xd0\xb8\xd0\xbd\xd0\xb3\xd0\xb5\xd1\x80\xd0\xb0, \xd0\xb3\xd0\xb4\xd0\xb5 \xd1\x80\xd0\xb0\xd1\x81\xd0\xbf\xd0\xbe\xd0\xbb\xd0\xbe\xd0\xb6\xd0\xb5\xd0\xbd\xd0\xb0 \xd1\x88\xd1\x82\xd0\xb0\xd0\xb1-\xd0\xba\xd0\xb2\xd0\xb0\xd1\x80\xd1\x82\xd0\xb8\xd1\x80\xd0\xb0 \xd0\x92\xd0\x9a\xd0\xbe\xd0\xbd\xd1\x82\xd0\xb0\xd0\xba\xd1\x82\xd0\xb5. \xd0\x94\xd0\xbb\xd1\x8f \xd1\x8d\xd1\x82\xd0\xbe\xd0\xb3\xd0\xbe \xd0\xbd\xd1\x83\xd0\xb6\xd0\xbd\xd0\xbe \xd0\xb2\xd1\x81\xd0\xb5\xd0\xb3\xd0\xbe \xd0\xbb\xd0\xb8\xd1\x88\xd1\x8c \xd0\xbe\xd1\x82\xd0\xbf\xd1\x80\xd0\xb0\xd0\xb2\xd0\xb8\xd1\x82\xd1\x8c \xd1\x81\xd0\xbe\xd0\xbe\xd0\xb1\xd1\x89\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb5 \xd1\x81 \xd1\x86\xd0\xb2\xd0\xb5\xd1\x82\xd0\xbe\xd0\xbc \xd0\xb2 \xd1\x81\xd0\xbf\xd0\xb5\xd1\x86\xd0\xb8\xd0\xb0\xd0\xbb\xd1\x8c\xd0\xbd\xd1\x8b\xd0\xb9 \xd1\x87\xd0\xb0\xd1\x82 \xc2\xab\xd0\x97\xd0\xb8\xd0\xbd\xd0\xb3\xd0\xb5\xd1\x80 | color\xc2\xbb, \xd0\xb0 \xd0\xb1\xd0\xbe\xd1\x82 \xd0\xb5\xd0\xb3\xd0\xbe \xd1\x80\xd0\xb0\xd1\x81\xd0\xbf\xd0\xbe\xd0\xb7\xd0\xbd\xd0\xb0\xd0\xb5\xd1\x82 \xd0\xb8 \xd1\x81\xd0\xbc\xd0\xb5\xd0\xbd\xd0\xb8\xd1\x82 \xd0\xbf\xd0\xbe\xd0\xb4\xd1\x81\xd0\xb2\xd0\xb5\xd1\x82\xd0\xba\xd1\x83. \xd0\x9f\xd1\x80\xd0\xb8 \xd1\x8d\xd1\x82\xd0\xbe\xd0\xbc \xd0\xbd\xd0\xb0 \xd0\xb2\xd1\x80\xd0\xb5\xd0\xbc\xd1\x8f \xd0\xb3\xd0\xbe\xd1\x80\xd0\xbe\xd0\xb4\xd1\x81\xd0\xba\xd0\xb8\xd1\x85 \xd0\xbc\xd0\xb5\xd1\x80\xd0\xbe\xd0\xbf\xd1\x80\xd0\xb8\xd1\x8f\xd1\x82\xd0\xb8\xd0\xb9 \xd1\x81\xd0\xbc\xd0\xb5\xd0\xbd\xd0\xb0 \xd1\x86\xd0\xb2\xd0\xb5\xd1\x82\xd0\xb0 \xd0\xb1\xd0\xbb\xd0\xbe\xd0\xba\xd0\xb8\xd1\x80\xd1\x83\xd0\xb5\xd1\x82\xd1\x81\xd1\x8f.\xd0\xa4\xd0\xbe\xd1\x80\xd0\xbc\xd0\xb0\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe, \xd0\xb1\xd0\xbe\xd1\x82 \xd0\xbe\xd0\xb1\xd1\x80\xd0\xb0\xd0\xb1\xd0\xb0\xd1\x82\xd1\x8b\xd0\xb2\xd0\xb0\xd0\xb5\xd1\x82 \xd1\x82\xd1\x80\xd0\xb8 \xd1\x82\xd0\xb8\xd0\xbf\xd0\xb0 \xd1\x81\xd0\xbe\xd0\xbe\xd0\xb1\xd1\x89\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb9:   lock: \xd0\xb7\xd0\xb0\xd0\xb1\xd0\xbb\xd0\xbe\xd0\xba\xd0\xb8\xd1\x80\xd0\xbe\xd0\xb2\xd0\xb0\xd1\x82\xd1\x8c \xd0\xb8\xd0\xb7\xd0\xbc\xd0\xb5\xd0\xbd\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb5 \xd1\x86\xd0\xb2\xd0\xb5\xd1\x82\xd0\xb0. \xd0\x95\xd1\x81\xd0\xbb\xd0\xb8 \xd0\xbe\xd0\xbd\xd0\xbe \xd0\xb8 \xd1\x82\xd0\xb0\xd0\xba \xd0\xb7\xd0\xb0\xd0\xb1\xd0\xbb\xd0\xbe\xd0\xba\xd0\xb8\xd1\x80\xd0\xbe\xd0\xb2\xd0\xb0\xd0\xbd\xd0\xbe \xd0\xbd\xd0\xb0 \xd0\xb4\xd0\xb0\xd0\xbd\xd0\xbd\xd1\x8b\xd0\xb9 \xd0\xbc\xd0\xbe\xd0\xbc\xd0\xb5\xd0\xbd\xd1\x82, \xd1\x81\xd0\xbe\xd0\xbe\xd0\xb1\xd1\x89\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb5 \xd0\xb8\xd0\xb3\xd0\xbd\xd0\xbe\xd1\x80\xd0\xb8\xd1\x80\xd1\x83\xd0\xb5\xd1\x82\xd1\x81\xd1\x8f.  unlock: \xd1\x80\xd0\xb0\xd0\xb7\xd0\xb1\xd0\xbb\xd0\xbe\xd0\xba\xd0\xb8\xd1\x80\xd0\xbe\xd0\xb2\xd0\xb0\xd1\x82\xd1\x8c \xd0\xb8\xd0\xb7\xd0\xbc\xd0\xb5\xd0\xbd\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb5 \xd1\x86\xd0\xb2\xd0\xb5\xd1\x82\xd0\xb0. \xd0\x95\xd1\x81\xd0\xbb\xd0\xb8 \xd0\xbe\xd0\xbd\xd0\xbe \xd0\xb8 \xd1\x82\xd0\xb0\xd0\xba \xd1\x80\xd0\xb0\xd0\xb7\xd0\xb1\xd0\xbb\xd0\xbe\xd0\xba\xd0\xb8\xd1\x80\xd0\xbe\xd0\xb2\xd0\xb0\xd0\xbd\xd0\xbe \xd0\xbd\xd0\xb0 \xd0\xb4\xd0\xb0\xd0\xbd\xd0\xbd\xd1\x8b\xd0\xb9 \xd0\xbc\xd0\xbe\xd0\xbc\xd0\xb5\xd0\xbd\xd1\x82, \xd1\x81\xd0\xbe\xd0\xbe\xd0\xb1\xd1\x89\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb5 \xd0\xb8\xd0\xb3\xd0\xbd\xd0\xbe\xd1\x80\xd0\xb8\xd1\x80\xd1\x83\xd0\xb5\xd1\x82\xd1\x81\xd1\x8f.  red / orange / yellow / green / blue / indigo / violet: \xd0\xb8\xd0\xb7\xd0\xbc\xd0\xb5\xd0\xbd\xd0\xb8\xd1\x82\xd1\x8c \xd1\x86\xd0\xb2\xd0\xb5\xd1\x82 \xd0\xba\xd1\x83\xd0\xbf\xd0\xbe\xd0\xbb\xd0\xb0 \xd0\xbd\xd0\xb0 \xd0\xb7\xd0\xb0\xd0\xb4\xd0\xb0\xd0\xbd\xd0\xbd\xd1\x8b\xd0\xb9, \xd0\xb5\xd1\x81\xd0\xbb\xd0\xb8 \xd0\xb8\xd0\xb7\xd0\xbc\xd0\xb5\xd0\xbd\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb5 \xd1\x86\xd0\xb2\xd0\xb5\xd1\x82\xd0\xb0 \xd0\xbd\xd0\xb0 \xd0\xb4\xd0\xb0\xd0\xbd\xd0\xbd\xd1\x8b\xd0\xb9 \xd0\xbc\xd0\xbe\xd0\xbc\xd0\xb5\xd0\xbd\xd1\x82 \xd0\xbd\xd0\xb5 \xd0\xb7\xd0\xb0\xd0\xb1\xd0\xbb\xd0\xbe\xd0\xba\xd0\xb8\xd1\x80\xd0\xbe\xd0\xb2\xd0\xb0\xd0\xbd\xd0\xbe. \xd0\x92\xd0\xb0\xd0\xbc \xd0\xb4\xd0\xb0\xd0\xbd\xd0\xb0 \xd0\xb8\xd1\x81\xd1\x82\xd0\xbe\xd1\x80\xd0\xb8\xd1\x8f \xd1\x81\xd0\xbe\xd0\xbe\xd0\xb1\xd1\x89\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb9, \xd0\xbf\xd0\xbe\xd0\xbb\xd1\x83\xd1\x87\xd0\xb5\xd0\xbd\xd0\xbd\xd1\x8b\xd1\x85 \xd0\xb1\xd0\xbe\xd1\x82\xd0\xbe\xd0\xbc, \xd0\xb2 \xd1\x85\xd1\x80\xd0\xbe\xd0\xbd\xd0\xbe\xd0\xbb\xd0\xbe\xd0\xb3\xd0\xb8\xd1\x87\xd0\xb5\xd1\x81\xd0\xba\xd0\xbe\xd0\xbc \xd0\xbf\xd0\xbe\xd1\x80\xd1\x8f\xd0\xb4\xd0\xba\xd0\xb5. \xd0\xa1\xd1\x87\xd0\xb8\xd1\x82\xd0\xb0\xd0\xb9\xd1\x82\xd0\xb5, \xd1\x87\xd1\x82\xd0\xbe \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb5\xd0\xb4 \xd0\xbf\xd0\xbe\xd0\xbb\xd1\x83\xd1\x87\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb5\xd0\xbc \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb2\xd0\xbe\xd0\xb3\xd0\xbe \xd1\x81\xd0\xbe\xd0\xbe\xd0\xb1\xd1\x89\xd0\xb5\xd0\xbd\xd0\xb8\xd1\x8f \xd0\xba\xd1\x83\xd0\xbf\xd0\xbe\xd0\xbb \xd0\xbf\xd0\xbe\xd0\xb4\xd1\x81\xd0\xb2\xd0\xb5\xd1\x87\xd0\xb8\xd0\xb2\xd0\xb0\xd0\xb5\xd1\x82\xd1\x81\xd1\x8f \xd0\xb3\xd0\xbe\xd0\xbb\xd1\x83\xd0\xb1\xd1\x8b\xd0\xbc (blue), \xd0\xb0 \xd0\xb8\xd0\xb7\xd0\xbc\xd0\xb5\xd0\xbd\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb5 \xd1\x86\xd0\xb2\xd0\xb5\xd1\x82\xd0\xb0 \xd0\xbd\xd0\xb5 \xd0\xb7\xd0\xb0\xd0\xb1\xd0\xbb\xd0\xbe\xd0\xba\xd0\xb8\xd1\x80\xd0\xbe\xd0\xb2\xd0\xb0\xd0\xbd\xd0\xbe.\xd0\x92 \xd0\xba\xd0\xb0\xd1\x87\xd0\xb5\xd1\x81\xd1\x82\xd0\xb2\xd0\xb5 \xd1\x8d\xd0\xba\xd1\x81\xd0\xbf\xd0\xb5\xd1\x80\xd0\xb8\xd0\xbc\xd0\xb5\xd0\xbd\xd1\x82\xd0\xb0 \xd0\xb1\xd1\x8b\xd0\xbb\xd0\xbe \xd1\x80\xd0\xb5\xd1\x88\xd0\xb5\xd0\xbd\xd0\xbe \xd0\xbf\xd0\xbe\xd0\xb4\xd0\xb4\xd0\xb5\xd1\x80\xd0\xb6\xd0\xb0\xd1\x82\xd1\x8c \xd0\xb2 \xd0\xb1\xd0\xbe\xd1\x82\xd0\xb5 \xd1\x8d\xd1\x84\xd1\x84\xd0\xb5\xd0\xba\xd1\x82\xd0\xb8\xd0\xb2\xd0\xbd\xd1\x83\xd1\x8e \xd0\xbe\xd0\xb1\xd1\x80\xd0\xb0\xd0\xb1\xd0\xbe\xd1\x82\xd0\xba\xd1\x83 \xd1\x80\xd0\xb5\xd0\xb4\xd0\xb0\xd0\xba\xd1\x82\xd0\xb8\xd1\x80\xd0\xbe\xd0\xb2\xd0\xb0\xd0\xbd\xd0\xb8\xd1\x8f \xd1\x81\xd0\xbe\xd0\xbe\xd0\xb1\xd1\x89\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb9. \xd0\x92\xd0\xb0\xd0\xbc \xd0\xb4\xd0\xb0\xd0\xbd\xd0\xb0 \xd0\xbf\xd0\xbe\xd1\x81\xd0\xbb\xd0\xb5\xd0\xb4\xd0\xbe\xd0\xb2\xd0\xb0\xd1\x82\xd0\xb5\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe\xd1\x81\xd1\x82\xd1\x8c \xd0\xbf\xd0\xb0\xd1\x80 \xd0\xb2\xd0\xb8\xd0\xb4\xd0\xb0 (i,msg), \xd0\xbe\xd0\xb7\xd0\xbd\xd0\xb0\xd1\x87\xd0\xb0\xd1\x8e\xd1\x89\xd0\xb8\xd1\x85, \xd1\x87\xd1\x82\xd0\xbe i-\xd0\xb5 \xd0\xb2 \xd1\x85\xd1\x80\xd0\xbe\xd0\xbd\xd0\xbe\xd0\xbb\xd0\xbe\xd0\xb3\xd0\xb8\xd1\x87\xd0\xb5\xd1\x81\xd0\xba\xd0\xbe\xd0\xbc \xd0\xbf\xd0\xbe\xd1\x80\xd1\x8f\xd0\xb4\xd0\xba\xd0\xb5 \xd1\x81\xd0\xbe\xd0\xbe\xd0\xb1\xd1\x89\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb5 \xd0\xb1\xd1\x8b\xd0\xbb\xd0\xbe \xd0\xbe\xd1\x82\xd1\x80\xd0\xb5\xd0\xb4\xd0\xb0\xd0\xba\xd1\x82\xd0\xb8\xd1\x80\xd0\xbe\xd0\xb2\xd0\xb0\xd0\xbd\xd0\xbe \xd0\xb8 \xd1\x82\xd0\xb5\xd0\xbf\xd0\xb5\xd1\x80\xd1\x8c \xd0\xb8\xd0\xbc\xd0\xb5\xd0\xb5\xd1\x82 \xd0\xb2\xd0\xb8\xd0\xb4 msg. \xd0\x9e\xd0\xb1\xd1\x80\xd0\xb0\xd1\x82\xd0\xb8\xd1\x82\xd0\xb5 \xd0\xb2\xd0\xbd\xd0\xb8\xd0\xbc\xd0\xb0\xd0\xbd\xd0\xb8\xd0\xb5, \xd1\x87\xd1\x82\xd0\xbe \xd1\x80\xd0\xb5\xd0\xb4\xd0\xb0\xd0\xba\xd1\x82\xd0\xb8\xd1\x80\xd0\xbe\xd0\xb2\xd0\xb0\xd1\x82\xd1\x8c\xd1\x81\xd1\x8f \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xb5\xd1\x82 \xd0\xbb\xd1\x8e\xd0\xb1\xd0\xbe\xd0\xb5 \xd1\x81\xd0\xbe\xd0\xbe\xd0\xb1\xd1\x89\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb5, \xd0\xb8 \xd0\xbf\xd1\x80\xd0\xb8 \xd1\x80\xd0\xb5\xd0\xb4\xd0\xb0\xd0\xba\xd1\x82\xd0\xb8\xd1\x80\xd0\xbe\xd0\xb2\xd0\xb0\xd0\xbd\xd0\xb8\xd0\xb8 \xd1\x81\xd0\xbe\xd0\xbe\xd0\xb1\xd1\x89\xd0\xb5\xd0\xbd\xd0\xb8\xd1\x8f \xd0\xb1\xd0\xbe\xd1\x82 \xd0\xb4\xd0\xbe\xd0\xbb\xd0\xb6\xd0\xb5\xd0\xbd \xd0\xbe\xd0\xb1\xd1\x80\xd0\xb0\xd0\xb1\xd0\xbe\xd1\x82\xd0\xb0\xd1\x82\xd1\x8c \xd0\xb2\xd1\x81\xd1\x8e \xd0\xb8\xd1\x81\xd1\x82\xd0\xbe\xd1\x80\xd0\xb8\xd1\x8e \xd1\x81\xd0\xbe\xd0\xbe\xd0\xb1\xd1\x89\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb9 \xd0\xb7\xd0\xb0\xd0\xbd\xd0\xbe\xd0\xb2\xd0\xbe (\xd0\xb2 \xd1\x87\xd0\xb0\xd1\x81\xd1\x82\xd0\xbd\xd0\xbe\xd1\x81\xd1\x82\xd0\xb8, \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb5\xd0\xb4 \xd0\xbe\xd0\xb1\xd1\x80\xd0\xb0\xd0\xb1\xd0\xbe\xd1\x82\xd0\xba\xd0\xbe\xd0\xb9 \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb2\xd0\xbe\xd0\xb3\xd0\xbe \xd1\x81\xd0\xbe\xd0\xbe\xd0\xb1\xd1\x89\xd0\xb5\xd0\xbd\xd0\xb8\xd1\x8f \xd1\x86\xd0\xb2\xd0\xb5\xd1\x82 \xd0\xba\xd1\x83\xd0\xbf\xd0\xbe\xd0\xbb\xd0\xb0 \xd0\xb3\xd0\xbe\xd0\xbb\xd1\x83\xd0\xb1\xd0\xbe\xd0\xb9, \xd0\xb0 \xd0\xb8\xd0\xb7\xd0\xbc\xd0\xb5\xd0\xbd\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb5 \xd1\x86\xd0\xb2\xd0\xb5\xd1\x82\xd0\xb0 \xd0\xbd\xd0\xb5 \xd0\xb7\xd0\xb0\xd0\xb1\xd0\xbb\xd0\xbe\xd0\xba\xd0\xb8\xd1\x80\xd0\xbe\xd0\xb2\xd0\xb0\xd0\xbd\xd0\xbe).\xd0\x9e\xd0\xbf\xd1\x80\xd0\xb5\xd0\xb4\xd0\xb5\xd0\xbb\xd0\xb8\xd1\x82\xd0\xb5, \xd0\xba\xd0\xb0\xd0\xba\xd0\xbe\xd0\xb9 \xd1\x86\xd0\xb2\xd0\xb5\xd1\x82 \xd0\xb1\xd1\x83\xd0\xb4\xd0\xb5\xd1\x82 \xd1\x83 \xd0\xba\xd1\x83\xd0\xbf\xd0\xbe\xd0\xbb\xd0\xb0 \xd0\x94\xd0\xbe\xd0\xbc\xd0\xb0 \xd0\x97\xd0\xb8\xd0\xbd\xd0\xb3\xd0\xb5\xd1\x80\xd0\xb0 \xd0\xb4\xd0\xbe \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb2\xd0\xbe\xd0\xb9 \xd0\xbe\xd0\xbf\xd0\xb5\xd1\x80\xd0\xb0\xd1\x86\xd0\xb8\xd0\xb8 \xd1\x80\xd0\xb5\xd0\xb4\xd0\xb0\xd0\xba\xd1\x82\xd0\xb8\xd1\x80\xd0\xbe\xd0\xb2\xd0\xb0\xd0\xbd\xd0\xb8\xd1\x8f, \xd0\xb0 \xd1\x82\xd0\xb0\xd0\xba\xd0\xb6\xd0\xb5 \xd0\xbf\xd0\xbe\xd1\x81\xd0\xbb\xd0\xb5 \xd0\xba\xd0\xb0\xd0\xb6\xd0\xb4\xd0\xbe\xd0\xb9 \xd0\xbe\xd0\xbf\xd0\xb5\xd1\x80\xd0\xb0\xd1\x86\xd0\xb8\xd0\xb8 \xd1\x80\xd0\xb5\xd0\xb4\xd0\xb0\xd0\xba\xd1\x82\xd0\xb8\xd1\x80\xd0\xbe\xd0\xb2\xd0\xb0\xd0\xbd\xd0\xb8\xd1\x8f." -999
1531C "\xd0\xa1\xd0\xb8\xd0\xbc\xd0\xbc\xd0\xb5\xd1\x82\xd1\x80\xd0\xb8\xd1\x87\xd0\xbd\xd1\x8b\xd0\xb9 \xd0\xb0\xd0\xbc\xd1\x84\xd0\xb8\xd1\x82\xd0\xb5\xd0\xb0\xd1\x82\xd1\x80" "*special problem,constructive algorithms,dp" "\xd0\x92\xd1\x81\xd0\xb5 \xd0\xb3\xd0\xbe\xd1\x82\xd0\xbe\xd0\xb2\xd1\x8f\xd1\x82\xd1\x81\xd1\x8f \xd0\xba VK Fest 2021! \xd0\x94\xd0\xbb\xd1\x8f \xd1\x82\xd0\xbe\xd0\xb3\xd0\xbe, \xd1\x87\xd1\x82\xd0\xbe\xd0\xb1\xd1\x8b \xd0\xb7\xd1\x80\xd0\xb8\xd1\x82\xd0\xb5\xd0\xbb\xd1\x8f\xd0\xbc \xd0\xb1\xd1\x8b\xd0\xbb\xd0\xb0 \xd0\xbb\xd1\x83\xd1\x87\xd1\x88\xd0\xb5 \xd0\xb2\xd0\xb8\xd0\xb4\xd0\xbd\xd0\xb0 \xd0\xb3\xd0\xbb\xd0\xb0\xd0\xb2\xd0\xbd\xd0\xb0\xd1\x8f \xd1\x81\xd1\x86\xd0\xb5\xd0\xbd\xd0\xb0, \xd0\xbf\xd0\xbb\xd0\xb0\xd0\xbd\xd0\xb8\xd1\x80\xd1\x83\xd0\xb5\xd1\x82\xd1\x81\xd1\x8f \xd0\xbf\xd0\xbe\xd1\x81\xd1\x82\xd1\x80\xd0\xbe\xd0\xb8\xd1\x82\xd1\x8c \xd0\xb0\xd0\xbc\xd1\x84\xd0\xb8\xd1\x82\xd0\xb5\xd0\xb0\xd1\x82\xd1\x80. \xd0\x92 \xd1\x8d\xd1\x82\xd0\xbe\xd0\xb9 \xd0\xb7\xd0\xb0\xd0\xb4\xd0\xb0\xd1\x87\xd0\xb5 \xd0\xbc\xd1\x8b \xd0\xb1\xd1\x83\xd0\xb4\xd0\xb5\xd0\xbc \xd1\x80\xd0\xb0\xd1\x81\xd1\x81\xd0\xbc\xd0\xb0\xd1\x82\xd1\x80\xd0\xb8\xd0\xb2\xd0\xb0\xd1\x82\xd1\x8c \xd0\xb5\xd0\xb3\xd0\xbe \xd1\x81\xd0\xb1\xd0\xbe\xd0\xba\xd1\x83 \xe2\x80\x94 \xd1\x81\xd1\x85\xd0\xb5\xd0\xbc\xd0\xb0\xd1\x82\xd0\xb8\xd1\x87\xd0\xbd\xd0\xbe \xd0\xbe\xd0\xbd \xd0\xb1\xd1\x83\xd0\xb4\xd0\xb5\xd1\x82 \xd0\xb8\xd0\xbc\xd0\xb5\xd1\x82\xd1\x8c \xd1\x84\xd0\xbe\xd1\x80\xd0\xbc\xd1\x83 \xd0\xbb\xd0\xb5\xd1\x81\xd1\x82\xd0\xbd\xd0\xb8\xd1\x86\xd1\x8b \xd0\xb8\xd0\xb7 nn \xd0\xbe\xd0\xb4\xd0\xb8\xd0\xbd\xd0\xb0\xd0\xba\xd0\xbe\xd0\xb2\xd1\x8b\xd1\x85 \xd0\xba\xd0\xb2\xd0\xb0\xd0\xb4\xd1\x80\xd0\xb0\xd1\x82\xd0\xbe\xd0\xb2. \xd0\x9b\xd0\xb5\xd1\x81\xd1\x82\xd0\xbd\xd0\xb8\xd1\x86\xd0\xb0 \xe2\x80\x94 \xd1\x8d\xd1\x82\xd0\xbe \xd0\xbe\xd0\xb4\xd0\xbd\xd0\xb0 \xd0\xb8\xd0\xbb\xd0\xb8 \xd0\xb1\xd0\xbe\xd0\xbb\xd0\xb5\xd0\xb5 \xd0\xb1\xd0\xb0\xd1\x88\xd0\xb5\xd0\xbd \xd0\xba\xd0\xb2\xd0\xb0\xd0\xb4\xd1\x80\xd0\xb0\xd1\x82\xd0\xbe\xd0\xb2, \xd0\xb2\xd1\x8b\xd1\x81\xd1\x82\xd1\x80\xd0\xbe\xd0\xb5\xd0\xbd\xd0\xbd\xd1\x8b\xd1\x85 \xd0\xb2 \xd1\x80\xd1\x8f\xd0\xb4, \xd0\xb3\xd0\xb4\xd0\xb5 \xd0\xb2\xd1\x8b\xd1\x81\xd0\xbe\xd1\x82\xd1\x8b \xd0\xb1\xd0\xb0\xd1\x88\xd0\xb5\xd0\xbd \xd0\xbd\xd0\xb5\xd0\xb2\xd0\xbe\xd0\xb7\xd1\x80\xd0\xb0\xd1\x81\xd1\x82\xd0\xb0\xd1\x8e\xd1\x82 \xd1\x81\xd0\xbb\xd0\xb5\xd0\xb2\xd0\xb0 \xd0\xbd\xd0\xb0\xd0\xbf\xd1\x80\xd0\xb0\xd0\xb2\xd0\xbe.\xd0\x9d\xd0\xb0 \xd1\x81\xd0\xbb\xd0\xb5\xd0\xb4\xd1\x83\xd1\x8e\xd1\x89\xd0\xb5\xd0\xbc \xd1\x80\xd0\xb8\xd1\x81\xd1\x83\xd0\xbd\xd0\xba\xd0\xb5 \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xbd\xd0\xbe \xd0\xb2\xd0\xb8\xd0\xb4\xd0\xb5\xd1\x82\xd1\x8c \xd1\x82\xd1\x80\xd0\xb8 \xd1\x80\xd0\xb0\xd0\xb7\xd0\xbd\xd1\x8b\xd0\xb5 \xd1\x84\xd0\xb8\xd0\xb3\xd1\x83\xd1\x80\xd1\x8b \xd0\xb8\xd0\xb7 1212 \xd0\xba\xd0\xb2\xd0\xb0\xd0\xb4\xd1\x80\xd0\xb0\xd1\x82\xd0\xbe\xd0\xb2. \xd0\x9f\xd0\xb5\xd1\x80\xd0\xb2\xd1\x8b\xd0\xb5 \xd0\xb4\xd0\xb2\xd0\xb5 \xd1\x84\xd0\xb8\xd0\xb3\xd1\x83\xd1\x80\xd1\x8b \xe2\x80\x94 \xd0\xbb\xd0\xb5\xd1\x81\xd1\x82\xd0\xbd\xd0\xb8\xd1\x86\xd1\x8b, \xd0\xb0 \xd1\x82\xd1\x80\xd0\xb5\xd1\x82\xd1\x8c\xd1\x8f \xe2\x80\x94 \xd0\xbd\xd0\xb5\xd1\x82.  \xd0\x98\xd0\xb7 \xd1\x8d\xd1\x81\xd1\x82\xd0\xb5\xd1\x82\xd0\xb8\xd1\x87\xd0\xb5\xd1\x81\xd0\xba\xd0\xb8\xd1\x85 \xd1\x81\xd0\xbe\xd0\xbe\xd0\xb1\xd1\x80\xd0\xb0\xd0\xb6\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb9 \xd0\xb1\xd1\x8b\xd0\xbb\xd0\xbe \xd1\x80\xd0\xb5\xd1\x88\xd0\xb5\xd0\xbd\xd0\xbe, \xd1\x87\xd1\x82\xd0\xbe \xd0\xb0\xd0\xbc\xd1\x84\xd0\xb8\xd1\x82\xd0\xb5\xd0\xb0\xd1\x82\xd1\x80 \xd0\xb4\xd0\xbe\xd0\xbb\xd0\xb6\xd0\xb5\xd0\xbd \xd0\xb1\xd1\x8b\xd1\x82\xd1\x8c \xd1\x81\xd0\xb8\xd0\xbc\xd0\xbc\xd0\xb5\xd1\x82\xd1\x80\xd0\xb8\xd1\x87\xd0\xbd\xd1\x8b\xd0\xbc. \xd0\xa4\xd0\xbe\xd1\x80\xd0\xbc\xd0\xb0\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe, \xd0\xb0\xd0\xbc\xd1\x84\xd0\xb8\xd1\x82\xd0\xb5\xd0\xb0\xd1\x82\xd1\x80 \xd0\xbd\xd0\xb0\xd0\xb7\xd1\x8b\xd0\xb2\xd0\xb0\xd0\xb5\xd1\x82\xd1\x81\xd1\x8f \xd1\x81\xd0\xb8\xd0\xbc\xd0\xbc\xd0\xb5\xd1\x82\xd1\x80\xd0\xb8\xd1\x87\xd0\xbd\xd1\x8b\xd0\xbc, \xd0\xb5\xd1\x81\xd0\xbb\xd0\xb8 \xd0\xbf\xd1\x80\xd0\xb8 \xd0\xbe\xd1\x82\xd1\x80\xd0\xb0\xd0\xb6\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb8 \xd0\xb5\xd0\xb3\xd0\xbe \xd1\x81\xd1\x85\xd0\xb5\xd0\xbc\xd1\x8b \xd0\xbe\xd1\x82\xd0\xbd\xd0\xbe\xd1\x81\xd0\xb8\xd1\x82\xd0\xb5\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe \xd0\xbf\xd1\x80\xd1\x8f\xd0\xbc\xd0\xbe\xd0\xb9 x=yx=y \xd0\xbf\xd0\xbe\xd0\xbb\xd1\x83\xd1\x87\xd0\xb0\xd0\xb5\xd1\x82\xd1\x81\xd1\x8f \xd1\x82\xd0\xbe\xd1\x82 \xd0\xb6\xd0\xb5 \xd1\x81\xd0\xb0\xd0\xbc\xd1\x8b\xd0\xb9 \xd1\x80\xd0\xb8\xd1\x81\xd1\x83\xd0\xbd\xd0\xbe\xd0\xba (\xd0\xb3\xd0\xb4\xd0\xb5 \xd0\xbe\xd1\x81\xd1\x8c xx \xd0\xbd\xd0\xb0\xd0\xbf\xd1\x80\xd0\xb0\xd0\xb2\xd0\xbb\xd0\xb5\xd0\xbd\xd0\xb0 \xd1\x81\xd0\xbb\xd0\xb5\xd0\xb2\xd0\xb0 \xd0\xbd\xd0\xb0\xd0\xbf\xd1\x80\xd0\xb0\xd0\xb2\xd0\xbe, \xd0\xb0 \xd0\xbe\xd1\x81\xd1\x8c yy \xe2\x80\x94 \xd1\x81\xd0\xbd\xd0\xb8\xd0\xb7\xd1\x83 \xd0\xb2\xd0\xb2\xd0\xb5\xd1\x80\xd1\x85). \xd0\x9d\xd0\xb0\xd0\xbf\xd1\x80\xd0\xb8\xd0\xbc\xd0\xb5\xd1\x80, \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb2\xd0\xb0\xd1\x8f \xd0\xbb\xd0\xb5\xd1\x81\xd1\x82\xd0\xbd\xd0\xb8\xd1\x86\xd0\xb0 \xd0\xbd\xd0\xb0 \xd1\x80\xd0\xb8\xd1\x81\xd1\x83\xd0\xbd\xd0\xba\xd0\xb5 \xd0\xb2\xd1\x8b\xd1\x88\xd0\xb5 \xe2\x80\x94 \xd1\x81\xd0\xb8\xd0\xbc\xd0\xbc\xd0\xb5\xd1\x82\xd1\x80\xd0\xb8\xd1\x87\xd0\xbd\xd0\xb0\xd1\x8f, \xd0\xb0 \xd0\xb2\xd1\x82\xd0\xbe\xd1\x80\xd0\xb0\xd1\x8f \xe2\x80\x94 \xd0\xbd\xd0\xb5\xd1\x82.  \xd0\x9a\xd1\x80\xd0\xbe\xd0\xbc\xd0\xb5 \xd1\x82\xd0\xbe\xd0\xb3\xd0\xbe, \xd0\xb0\xd0\xbc\xd1\x84\xd0\xb8\xd1\x82\xd0\xb5\xd0\xb0\xd1\x82\xd1\x80 \xd0\xb4\xd0\xbe\xd0\xbb\xd0\xb6\xd0\xb5\xd0\xbd \xd0\xb1\xd1\x8b\xd1\x82\xd1\x8c \xd0\xbc\xd0\xb0\xd0\xba\xd1\x81\xd0\xb8\xd0\xbc\xd0\xb0\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe \xd0\xba\xd0\xbe\xd0\xbc\xd0\xbf\xd0\xb0\xd0\xba\xd1\x82\xd0\xbd\xd1\x8b\xd0\xbc \xe2\x80\x94 \xd0\xb0 \xd0\xb8\xd0\xbc\xd0\xb5\xd0\xbd\xd0\xbd\xd0\xbe, \xd1\x81\xd1\x82\xd0\xbe\xd1\x80\xd0\xbe\xd0\xbd\xd0\xb0 \xd0\xbc\xd0\xb8\xd0\xbd\xd0\xb8\xd0\xbc\xd0\xb0\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe\xd0\xb3\xd0\xbe \xd0\xba\xd0\xb2\xd0\xb0\xd0\xb4\xd1\x80\xd0\xb0\xd1\x82\xd0\xb0, \xd0\xb2\xd0\xbd\xd1\x83\xd1\x82\xd1\x80\xd1\x8c \xd0\xba\xd0\xbe\xd1\x82\xd0\xbe\xd1\x80\xd0\xbe\xd0\xb3\xd0\xbe \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xbd\xd0\xbe \xd0\xb5\xd0\xb3\xd0\xbe \xd0\xbf\xd0\xbe\xd0\xbc\xd0\xb5\xd1\x81\xd1\x82\xd0\xb8\xd1\x82\xd1\x8c, \xd0\xb4\xd0\xbe\xd0\xbb\xd0\xb6\xd0\xbd\xd0\xb0 \xd0\xb1\xd1\x8b\xd1\x82\xd1\x8c \xd0\xba\xd0\xb0\xd0\xba \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xbd\xd0\xbe \xd0\xbc\xd0\xb5\xd0\xbd\xd1\x8c\xd1\x88\xd0\xb5.\xd0\x9f\xd0\xbe \xd0\xb7\xd0\xb0\xd0\xb4\xd0\xb0\xd0\xbd\xd0\xbd\xd0\xbe\xd0\xbc\xd1\x83 \xd1\x87\xd0\xb8\xd1\x81\xd0\xbb\xd1\x83 nn \xd0\xbd\xd0\xb0\xd1\x80\xd0\xb8\xd1\x81\xd1\x83\xd0\xb9\xd1\x82\xd0\xb5 \xd1\x81\xd1\x85\xd0\xb5\xd0\xbc\xd1\x83 \xd0\xb0\xd0\xbc\xd1\x84\xd0\xb8\xd1\x82\xd0\xb5\xd0\xb0\xd1\x82\xd1\x80\xd0\xb0 \xd0\xb8\xd0\xb7 \xd1\x80\xd0\xbe\xd0\xb2\xd0\xbd\xd0\xbe nn \xd0\xba\xd0\xb2\xd0\xb0\xd0\xb4\xd1\x80\xd0\xb0\xd1\x82\xd0\xbe\xd0\xb2, \xd1\x83\xd0\xb4\xd0\xbe\xd0\xb2\xd0\xbb\xd0\xb5\xd1\x82\xd0\xb2\xd0\xbe\xd1\x80\xd1\x8f\xd1\x8e\xd1\x89\xd1\x83\xd1\x8e \xd0\xb2\xd1\x81\xd0\xb5\xd0\xbc \xd1\x83\xd1\x81\xd0\xbb\xd0\xbe\xd0\xb2\xd0\xb8\xd1\x8f\xd0\xbc." -999
1531B2 \xd0\x9c\xd0\xbe\xd0\xbd\xd0\xb8\xd1\x82\xd0\xbe\xd1\x80\xd0\xb8\xd0\xbd\xd0\xb3 "*special problem" "\xd0\x92\xd0\x9a\xd0\xbe\xd0\xbd\xd1\x82\xd0\xb0\xd0\xba\xd1\x82\xd0\xb5 \xd0\xbe\xd1\x82\xd0\xba\xd1\x80\xd1\x8b\xd0\xbb\xd0\xb0 \xd0\xb2\xd1\x82\xd0\xbe\xd1\x80\xd0\xbe\xd0\xb9 \xd1\x88\xd1\x82\xd0\xb0\xd0\xb1 \xd0\xb2 \xd0\xa1\xd0\xb0\xd0\xbd\xd0\xba\xd1\x82-\xd0\x9f\xd0\xb5\xd1\x82\xd0\xb5\xd1\x80\xd0\xb1\xd1\x83\xd1\x80\xd0\xb3\xd0\xb5! \xd0\x92\xd1\x8b \xd0\xbd\xd0\xb5 \xd0\xbf\xd1\x80\xd0\xb5\xd0\xbc\xd0\xb8\xd0\xbd\xd1\x83\xd0\xbb\xd0\xb8 \xd0\xb2\xd0\xbe\xd0\xb7\xd0\xbc\xd0\xbe\xd0\xb6\xd0\xbd\xd0\xbe\xd1\x81\xd1\x82\xd1\x8c\xd1\x8e \xd1\x81\xd0\xbc\xd0\xb5\xd0\xbd\xd0\xb8\xd1\x82\xd1\x8c \xd0\xbe\xd0\xb1\xd1\x81\xd1\x82\xd0\xb0\xd0\xbd\xd0\xbe\xd0\xb2\xd0\xba\xd1\x83 \xd0\xb8 \xd1\x80\xd0\xb5\xd1\x88\xd0\xb8\xd0\xbb\xd0\xb8 \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb5\xd0\xb5\xd1\x85\xd0\xb0\xd1\x82\xd1\x8c \xd0\xb8\xd0\xb7 \xd0\xbe\xd1\x84\xd0\xb8\xd1\x81\xd0\xb0 \xd0\xb2 \xd0\x94\xd0\xbe\xd0\xbc\xd0\xb5 \xd0\x97\xd0\xb8\xd0\xbd\xd0\xb3\xd0\xb5\xd1\x80\xd0\xb0 \xd0\xb2 \xd0\xbe\xd1\x84\xd0\xb8\xd1\x81 \xd0\xbd\xd0\xb0 \xd0\x9a\xd1\x80\xd0\xb0\xd1\x81\xd0\xbd\xd0\xbe\xd0\xbc \xd0\xbc\xd0\xbe\xd1\x81\xd1\x82\xd1\x83.\xd0\x94\xd0\xbb\xd1\x8f \xd0\xba\xd0\xbe\xd0\xbc\xd1\x84\xd0\xbe\xd1\x80\xd1\x82\xd0\xbd\xd0\xbe\xd0\xb9 \xd1\x80\xd0\xb0\xd0\xb1\xd0\xbe\xd1\x82\xd1\x8b \xd0\xb2\xd0\xb0\xd0\xbc \xd0\xbf\xd0\xbe\xd1\x82\xd1\x80\xd0\xb5\xd0\xb1\xd1\x83\xd1\x8e\xd1\x82\xd1\x81\xd1\x8f \xd0\xb4\xd0\xb2\xd0\xb0 \xd0\xbc\xd0\xbe\xd0\xbd\xd0\xb8\xd1\x82\xd0\xbe\xd1\x80\xd0\xb0 \xd1\x81 \xd0\xbe\xd0\xb4\xd0\xb8\xd0\xbd\xd0\xb0\xd0\xba\xd0\xbe\xd0\xb2\xd0\xbe\xd0\xb9 \xd0\xb2\xd1\x8b\xd1\x81\xd0\xbe\xd1\x82\xd0\xbe\xd0\xb9, \xd1\x87\xd1\x82\xd0\xbe\xd0\xb1\xd1\x8b \xd0\xb8\xd0\xb7\xd0\xbe\xd0\xb1\xd1\x80\xd0\xb0\xd0\xb6\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb5 \xd0\xbd\xd0\xb0 \xd0\xbd\xd0\xb8\xd1\x85 \xd0\xb2\xd1\x8b\xd0\xb3\xd0\xbb\xd1\x8f\xd0\xb4\xd0\xb5\xd0\xbb\xd0\xbe \xd0\xb5\xd0\xb4\xd0\xb8\xd0\xbd\xd1\x8b\xd0\xbc \xd1\x86\xd0\xb5\xd0\xbb\xd1\x8b\xd0\xbc. \xd0\x9d\xd0\xb0 \xd1\x81\xd0\xba\xd0\xbb\xd0\xb0\xd0\xb4\xd0\xb5 \xd0\xbe\xd1\x84\xd0\xb8\xd1\x81\xd0\xb0 \xd0\xbd\xd0\xb0 \xd0\x9a\xd1\x80\xd0\xb0\xd1\x81\xd0\xbd\xd0\xbe\xd0\xbc \xd0\xbc\xd0\xbe\xd1\x81\xd1\x82\xd1\x83 \xd0\xb5\xd1\x81\xd1\x82\xd1\x8c n \xd0\xbc\xd0\xbe\xd0\xbd\xd0\xb8\xd1\x82\xd0\xbe\xd1\x80\xd0\xbe\xd0\xb2, i-\xd0\xb9 \xd0\xb8\xd0\xb7 \xd0\xbd\xd0\xb8\xd1\x85 \xd0\xb8\xd0\xbc\xd0\xb5\xd0\xb5\xd1\x82 \xd1\x88\xd0\xb8\xd1\x80\xd0\xb8\xd0\xbd\xd1\x83 wi \xd0\xb8 \xd0\xb2\xd1\x8b\xd1\x81\xd0\xbe\xd1\x82\xd1\x83 hi. \xd0\x9b\xd1\x8e\xd0\xb1\xd0\xbe\xd0\xb9 \xd0\xbc\xd0\xbe\xd0\xbd\xd0\xb8\xd1\x82\xd0\xbe\xd1\x80 \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xbd\xd0\xbe \xd0\xbf\xd0\xbe\xd0\xb2\xd0\xb5\xd1\x80\xd0\xbd\xd1\x83\xd1\x82\xd1\x8c \xd0\xbd\xd0\xb0 90 \xd0\xb3\xd1\x80\xd0\xb0\xd0\xb4\xd1\x83\xd1\x81\xd0\xbe\xd0\xb2, \xd0\xb8 \xd1\x82\xd0\xbe\xd0\xb3\xd0\xb4\xd0\xb0 \xd0\xbe\xd0\xbd \xd0\xb1\xd1\x83\xd0\xb4\xd0\xb5\xd1\x82 \xd0\xb8\xd0\xbc\xd0\xb5\xd1\x82\xd1\x8c \xd1\x88\xd0\xb8\xd1\x80\xd0\xb8\xd0\xbd\xd1\x83 hi \xd0\xb8 \xd0\xb2\xd1\x8b\xd1\x81\xd0\xbe\xd1\x82\xd1\x83 wi.\xd0\x9d\xd0\xb0\xd0\xb7\xd0\xbe\xd0\xb2\xd1\x91\xd0\xbc \xd0\xbd\xd0\xb5\xd1\x83\xd0\xbf\xd0\xbe\xd1\x80\xd1\x8f\xd0\xb4\xd0\xbe\xd1\x87\xd0\xb5\xd0\xbd\xd0\xbd\xd1\x83\xd1\x8e \xd0\xbf\xd0\xb0\xd1\x80\xd1\x83 \xd0\xb8\xd0\xb7 \xd0\xb4\xd0\xb2\xd1\x83\xd1\x85 \xd1\x80\xd0\xb0\xd0\xb7\xd0\xbb\xd0\xb8\xd1\x87\xd0\xbd\xd1\x8b\xd1\x85 \xd0\xbc\xd0\xbe\xd0\xbd\xd0\xb8\xd1\x82\xd0\xbe\xd1\x80\xd0\xbe\xd0\xb2 \xd0\xbf\xd0\xbe\xd0\xb4\xd1\x85\xd0\xbe\xd0\xb4\xd1\x8f\xd1\x89\xd0\xb5\xd0\xb9, \xd0\xb5\xd1\x81\xd0\xbb\xd0\xb8 \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xbd\xd0\xbe \xd0\xb8\xd1\x85 \xd0\xbf\xd0\xbe\xd0\xb2\xd0\xb5\xd1\x80\xd0\xbd\xd1\x83\xd1\x82\xd1\x8c \xd1\x82\xd0\xb0\xd0\xba, \xd1\x87\xd1\x82\xd0\xbe\xd0\xb1\xd1\x8b \xd0\xbe\xd0\xbd\xd0\xb8 \xd0\xb8\xd0\xbc\xd0\xb5\xd0\xbb\xd0\xb8 \xd0\xbe\xd0\xb4\xd0\xb8\xd0\xbd\xd0\xb0\xd0\xba\xd0\xbe\xd0\xb2\xd1\x83\xd1\x8e \xd0\xb2\xd1\x8b\xd1\x81\xd0\xbe\xd1\x82\xd1\x83. \xd0\x9b\xd1\x8e\xd0\xb1\xd0\xbe\xd0\xb9 \xd0\xb8\xd0\xb7 \xd0\xbc\xd0\xbe\xd0\xbd\xd0\xb8\xd1\x82\xd0\xbe\xd1\x80\xd0\xbe\xd0\xb2 \xd0\xb2 \xd0\xbf\xd0\xb0\xd1\x80\xd0\xb5 \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xbd\xd0\xbe \xd0\xba\xd0\xb0\xd0\xba \xd0\xbf\xd0\xbe\xd0\xb2\xd0\xb5\xd1\x80\xd0\xbd\xd1\x83\xd1\x82\xd1\x8c \xd0\xbe\xd1\x82\xd0\xbd\xd0\xbe\xd1\x81\xd0\xb8\xd1\x82\xd0\xb5\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe \xd0\xb8\xd1\x81\xd1\x85\xd0\xbe\xd0\xb4\xd0\xbd\xd0\xbe\xd0\xb9 \xd0\xbe\xd1\x80\xd0\xb8\xd0\xb5\xd0\xbd\xd1\x82\xd0\xb0\xd1\x86\xd0\xb8\xd0\xb8, \xd1\x82\xd0\xb0\xd0\xba \xd0\xb8 \xd0\xbd\xd0\xb5 \xd0\xbf\xd0\xbe\xd0\xb2\xd0\xbe\xd1\x80\xd0\xb0\xd1\x87\xd0\xb8\xd0\xb2\xd0\xb0\xd1\x82\xd1\x8c.\xd0\x9f\xd0\xbe\xd0\xb4\xd1\x81\xd1\x87\xd0\xb8\xd1\x82\xd0\xb0\xd0\xb9\xd1\x82\xd0\xb5 \xd0\xbf\xd0\xbe\xd0\xb4\xd1\x85\xd0\xbe\xd0\xb4\xd1\x8f\xd1\x89\xd0\xb8\xd0\xb5 \xd0\xbf\xd0\xb0\xd1\x80\xd1\x8b \xd0\xbc\xd0\xbe\xd0\xbd\xd0\xb8\xd1\x82\xd0\xbe\xd1\x80\xd0\xbe\xd0\xb2." -999
1531B1 \xd0\x9c\xd0\xbe\xd0\xbd\xd0\xb8\xd1\x82\xd0\xbe\xd1\x80\xd0\xb8\xd0\xbd\xd0\xb3 "*special problem,*special problem" "\xd0\x92\xd0\x9a\xd0\xbe\xd0\xbd\xd1\x82\xd0\xb0\xd0\xba\xd1\x82\xd0\xb5 \xd0\xbe\xd1\x82\xd0\xba\xd1\x80\xd1\x8b\xd0\xbb\xd0\xb0 \xd0\xb2\xd1\x82\xd0\xbe\xd1\x80\xd0\xbe\xd0\xb9 \xd1\x88\xd1\x82\xd0\xb0\xd0\xb1 \xd0\xb2 \xd0\xa1\xd0\xb0\xd0\xbd\xd0\xba\xd1\x82-\xd0\x9f\xd0\xb5\xd1\x82\xd0\xb5\xd1\x80\xd0\xb1\xd1\x83\xd1\x80\xd0\xb3\xd0\xb5! \xd0\x92\xd1\x8b \xd0\xbd\xd0\xb5 \xd0\xbf\xd1\x80\xd0\xb5\xd0\xbc\xd0\xb8\xd0\xbd\xd1\x83\xd0\xbb\xd0\xb8 \xd0\xb2\xd0\xbe\xd0\xb7\xd0\xbc\xd0\xbe\xd0\xb6\xd0\xbd\xd0\xbe\xd1\x81\xd1\x82\xd1\x8c\xd1\x8e \xd1\x81\xd0\xbc\xd0\xb5\xd0\xbd\xd0\xb8\xd1\x82\xd1\x8c \xd0\xbe\xd0\xb1\xd1\x81\xd1\x82\xd0\xb0\xd0\xbd\xd0\xbe\xd0\xb2\xd0\xba\xd1\x83 \xd0\xb8 \xd1\x80\xd0\xb5\xd1\x88\xd0\xb8\xd0\xbb\xd0\xb8 \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb5\xd0\xb5\xd1\x85\xd0\xb0\xd1\x82\xd1\x8c \xd0\xb8\xd0\xb7 \xd0\xbe\xd1\x84\xd0\xb8\xd1\x81\xd0\xb0 \xd0\xb2 \xd0\x94\xd0\xbe\xd0\xbc\xd0\xb5 \xd0\x97\xd0\xb8\xd0\xbd\xd0\xb3\xd0\xb5\xd1\x80\xd0\xb0 \xd0\xb2 \xd0\xbe\xd1\x84\xd0\xb8\xd1\x81 \xd0\xbd\xd0\xb0 \xd0\x9a\xd1\x80\xd0\xb0\xd1\x81\xd0\xbd\xd0\xbe\xd0\xbc \xd0\xbc\xd0\xbe\xd1\x81\xd1\x82\xd1\x83.\xd0\x94\xd0\xbb\xd1\x8f \xd0\xba\xd0\xbe\xd0\xbc\xd1\x84\xd0\xbe\xd1\x80\xd1\x82\xd0\xbd\xd0\xbe\xd0\xb9 \xd1\x80\xd0\xb0\xd0\xb1\xd0\xbe\xd1\x82\xd1\x8b \xd0\xb2\xd0\xb0\xd0\xbc \xd0\xbf\xd0\xbe\xd1\x82\xd1\x80\xd0\xb5\xd0\xb1\xd1\x83\xd1\x8e\xd1\x82\xd1\x81\xd1\x8f \xd0\xb4\xd0\xb2\xd0\xb0 \xd0\xbc\xd0\xbe\xd0\xbd\xd0\xb8\xd1\x82\xd0\xbe\xd1\x80\xd0\xb0 \xd1\x81 \xd0\xbe\xd0\xb4\xd0\xb8\xd0\xbd\xd0\xb0\xd0\xba\xd0\xbe\xd0\xb2\xd0\xbe\xd0\xb9 \xd0\xb2\xd1\x8b\xd1\x81\xd0\xbe\xd1\x82\xd0\xbe\xd0\xb9, \xd1\x87\xd1\x82\xd0\xbe\xd0\xb1\xd1\x8b \xd0\xb8\xd0\xb7\xd0\xbe\xd0\xb1\xd1\x80\xd0\xb0\xd0\xb6\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb5 \xd0\xbd\xd0\xb0 \xd0\xbd\xd0\xb8\xd1\x85 \xd0\xb2\xd1\x8b\xd0\xb3\xd0\xbb\xd1\x8f\xd0\xb4\xd0\xb5\xd0\xbb\xd0\xbe \xd0\xb5\xd0\xb4\xd0\xb8\xd0\xbd\xd1\x8b\xd0\xbc \xd1\x86\xd0\xb5\xd0\xbb\xd1\x8b\xd0\xbc. \xd0\x9d\xd0\xb0 \xd1\x81\xd0\xba\xd0\xbb\xd0\xb0\xd0\xb4\xd0\xb5 \xd0\xbe\xd1\x84\xd0\xb8\xd1\x81\xd0\xb0 \xd0\xbd\xd0\xb0 \xd0\x9a\xd1\x80\xd0\xb0\xd1\x81\xd0\xbd\xd0\xbe\xd0\xbc \xd0\xbc\xd0\xbe\xd1\x81\xd1\x82\xd1\x83 \xd0\xb5\xd1\x81\xd1\x82\xd1\x8c n \xd0\xbc\xd0\xbe\xd0\xbd\xd0\xb8\xd1\x82\xd0\xbe\xd1\x80\xd0\xbe\xd0\xb2, i-\xd0\xb9 \xd0\xb8\xd0\xb7 \xd0\xbd\xd0\xb8\xd1\x85 \xd0\xb8\xd0\xbc\xd0\xb5\xd0\xb5\xd1\x82 \xd1\x88\xd0\xb8\xd1\x80\xd0\xb8\xd0\xbd\xd1\x83 wi \xd0\xb8 \xd0\xb2\xd1\x8b\xd1\x81\xd0\xbe\xd1\x82\xd1\x83 hi. \xd0\x9b\xd1\x8e\xd0\xb1\xd0\xbe\xd0\xb9 \xd0\xbc\xd0\xbe\xd0\xbd\xd0\xb8\xd1\x82\xd0\xbe\xd1\x80 \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xbd\xd0\xbe \xd0\xbf\xd0\xbe\xd0\xb2\xd0\xb5\xd1\x80\xd0\xbd\xd1\x83\xd1\x82\xd1\x8c \xd0\xbd\xd0\xb0 90 \xd0\xb3\xd1\x80\xd0\xb0\xd0\xb4\xd1\x83\xd1\x81\xd0\xbe\xd0\xb2, \xd0\xb8 \xd1\x82\xd0\xbe\xd0\xb3\xd0\xb4\xd0\xb0 \xd0\xbe\xd0\xbd \xd0\xb1\xd1\x83\xd0\xb4\xd0\xb5\xd1\x82 \xd0\xb8\xd0\xbc\xd0\xb5\xd1\x82\xd1\x8c \xd1\x88\xd0\xb8\xd1\x80\xd0\xb8\xd0\xbd\xd1\x83 hi \xd0\xb8 \xd0\xb2\xd1\x8b\xd1\x81\xd0\xbe\xd1\x82\xd1\x83 wi.\xd0\x9d\xd0\xb0\xd0\xb7\xd0\xbe\xd0\xb2\xd1\x91\xd0\xbc \xd0\xbd\xd0\xb5\xd1\x83\xd0\xbf\xd0\xbe\xd1\x80\xd1\x8f\xd0\xb4\xd0\xbe\xd1\x87\xd0\xb5\xd0\xbd\xd0\xbd\xd1\x83\xd1\x8e \xd0\xbf\xd0\xb0\xd1\x80\xd1\x83 \xd0\xb8\xd0\xb7 \xd0\xb4\xd0\xb2\xd1\x83\xd1\x85 \xd1\x80\xd0\xb0\xd0\xb7\xd0\xbb\xd0\xb8\xd1\x87\xd0\xbd\xd1\x8b\xd1\x85 \xd0\xbc\xd0\xbe\xd0\xbd\xd0\xb8\xd1\x82\xd0\xbe\xd1\x80\xd0\xbe\xd0\xb2 \xd0\xbf\xd0\xbe\xd0\xb4\xd1\x85\xd0\xbe\xd0\xb4\xd1\x8f\xd1\x89\xd0\xb5\xd0\xb9, \xd0\xb5\xd1\x81\xd0\xbb\xd0\xb8 \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xbd\xd0\xbe \xd0\xb8\xd1\x85 \xd0\xbf\xd0\xbe\xd0\xb2\xd0\xb5\xd1\x80\xd0\xbd\xd1\x83\xd1\x82\xd1\x8c \xd1\x82\xd0\xb0\xd0\xba, \xd1\x87\xd1\x82\xd0\xbe\xd0\xb1\xd1\x8b \xd0\xbe\xd0\xbd\xd0\xb8 \xd0\xb8\xd0\xbc\xd0\xb5\xd0\xbb\xd0\xb8 \xd0\xbe\xd0\xb4\xd0\xb8\xd0\xbd\xd0\xb0\xd0\xba\xd0\xbe\xd0\xb2\xd1\x83\xd1\x8e \xd0\xb2\xd1\x8b\xd1\x81\xd0\xbe\xd1\x82\xd1\x83. \xd0\x9b\xd1\x8e\xd0\xb1\xd0\xbe\xd0\xb9 \xd0\xb8\xd0\xb7 \xd0\xbc\xd0\xbe\xd0\xbd\xd0\xb8\xd1\x82\xd0\xbe\xd1\x80\xd0\xbe\xd0\xb2 \xd0\xb2 \xd0\xbf\xd0\xb0\xd1\x80\xd0\xb5 \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xbd\xd0\xbe \xd0\xba\xd0\xb0\xd0\xba \xd0\xbf\xd0\xbe\xd0\xb2\xd0\xb5\xd1\x80\xd0\xbd\xd1\x83\xd1\x82\xd1\x8c \xd0\xbe\xd1\x82\xd0\xbd\xd0\xbe\xd1\x81\xd0\xb8\xd1\x82\xd0\xb5\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe \xd0\xb8\xd1\x81\xd1\x85\xd0\xbe\xd0\xb4\xd0\xbd\xd0\xbe\xd0\xb9 \xd0\xbe\xd1\x80\xd0\xb8\xd0\xb5\xd0\xbd\xd1\x82\xd0\xb0\xd1\x86\xd0\xb8\xd0\xb8, \xd1\x82\xd0\xb0\xd0\xba \xd0\xb8 \xd0\xbd\xd0\xb5 \xd0\xbf\xd0\xbe\xd0\xb2\xd0\xbe\xd1\x80\xd0\xb0\xd1\x87\xd0\xb8\xd0\xb2\xd0\xb0\xd1\x82\xd1\x8c.\xd0\x9f\xd0\xbe\xd0\xb4\xd1\x81\xd1\x87\xd0\xb8\xd1\x82\xd0\xb0\xd0\xb9\xd1\x82\xd0\xb5 \xd0\xbf\xd0\xbe\xd0\xb4\xd1\x85\xd0\xbe\xd0\xb4\xd1\x8f\xd1\x89\xd0\xb8\xd0\xb5 \xd0\xbf\xd0\xb0\xd1\x80\xd1\x8b \xd0\xbc\xd0\xbe\xd0\xbd\xd0\xb8\xd1\x82\xd0\xbe\xd1\x80\xd0\xbe\xd0\xb2." -999
1531A "\xd0\x97\xd0\xb8\xd0\xbd\xd0\xb3\xd0\xb5\xd1\x80 | color" "*special problem,implementation" "\xd0\x9d\xd0\xb5\xd0\xbc\xd0\xbd\xd0\xbe\xd0\xb3\xd0\xb8\xd0\xb5 \xd0\xb7\xd0\xbd\xd0\xb0\xd1\x8e\xd1\x82, \xd1\x87\xd1\x82\xd0\xbe \xd1\x81\xd0\xbe\xd1\x82\xd1\x80\xd1\x83\xd0\xb4\xd0\xbd\xd0\xb8\xd0\xba\xd0\xb8 \xd0\x92\xd0\x9a\xd0\xbe\xd0\xbd\xd1\x82\xd0\xb0\xd0\xba\xd1\x82\xd0\xb5 \xd0\xbc\xd0\xbe\xd0\xb3\xd1\x83\xd1\x82 \xd0\xbc\xd0\xb5\xd0\xbd\xd1\x8f\xd1\x82\xd1\x8c \xd1\x86\xd0\xb2\xd0\xb5\xd1\x82 \xd0\xbf\xd0\xbe\xd0\xb4\xd1\x81\xd0\xb2\xd0\xb5\xd1\x82\xd0\xba\xd0\xb8 \xd0\xb2 \xd0\xba\xd1\x83\xd0\xbf\xd0\xbe\xd0\xbb\xd0\xb5 \xd0\xb7\xd0\xbd\xd0\xb0\xd0\xbc\xd0\xb5\xd0\xbd\xd0\xb8\xd1\x82\xd0\xbe\xd0\xb3\xd0\xbe \xd0\x94\xd0\xbe\xd0\xbc\xd0\xb0 \xd0\x97\xd0\xb8\xd0\xbd\xd0\xb3\xd0\xb5\xd1\x80\xd0\xb0, \xd0\xb3\xd0\xb4\xd0\xb5 \xd1\x80\xd0\xb0\xd1\x81\xd0\xbf\xd0\xbe\xd0\xbb\xd0\xbe\xd0\xb6\xd0\xb5\xd0\xbd\xd0\xb0 \xd1\x88\xd1\x82\xd0\xb0\xd0\xb1-\xd0\xba\xd0\xb2\xd0\xb0\xd1\x80\xd1\x82\xd0\xb8\xd1\x80\xd0\xb0 \xd0\x92\xd0\x9a\xd0\xbe\xd0\xbd\xd1\x82\xd0\xb0\xd0\xba\xd1\x82\xd0\xb5. \xd0\x94\xd0\xbb\xd1\x8f \xd1\x8d\xd1\x82\xd0\xbe\xd0\xb3\xd0\xbe \xd0\xbd\xd1\x83\xd0\xb6\xd0\xbd\xd0\xbe \xd0\xb2\xd1\x81\xd0\xb5\xd0\xb3\xd0\xbe \xd0\xbb\xd0\xb8\xd1\x88\xd1\x8c \xd0\xbe\xd1\x82\xd0\xbf\xd1\x80\xd0\xb0\xd0\xb2\xd0\xb8\xd1\x82\xd1\x8c \xd1\x81\xd0\xbe\xd0\xbe\xd0\xb1\xd1\x89\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb5 \xd1\x81 \xd1\x86\xd0\xb2\xd0\xb5\xd1\x82\xd0\xbe\xd0\xbc \xd0\xb2 \xd1\x81\xd0\xbf\xd0\xb5\xd1\x86\xd0\xb8\xd0\xb0\xd0\xbb\xd1\x8c\xd0\xbd\xd1\x8b\xd0\xb9 \xd1\x87\xd0\xb0\xd1\x82 \xc2\xab\xd0\x97\xd0\xb8\xd0\xbd\xd0\xb3\xd0\xb5\xd1\x80 | color\xc2\xbb, \xd0\xb0 \xd0\xb1\xd0\xbe\xd1\x82 \xd0\xb5\xd0\xb3\xd0\xbe \xd1\x80\xd0\xb0\xd1\x81\xd0\xbf\xd0\xbe\xd0\xb7\xd0\xbd\xd0\xb0\xd0\xb5\xd1\x82 \xd0\xb8 \xd1\x81\xd0\xbc\xd0\xb5\xd0\xbd\xd0\xb8\xd1\x82 \xd0\xbf\xd0\xbe\xd0\xb4\xd1\x81\xd0\xb2\xd0\xb5\xd1\x82\xd0\xba\xd1\x83. \xd0\x9f\xd1\x80\xd0\xb8 \xd1\x8d\xd1\x82\xd0\xbe\xd0\xbc \xd0\xbd\xd0\xb0 \xd0\xb2\xd1\x80\xd0\xb5\xd0\xbc\xd1\x8f \xd0\xb3\xd0\xbe\xd1\x80\xd0\xbe\xd0\xb4\xd1\x81\xd0\xba\xd0\xb8\xd1\x85 \xd0\xbc\xd0\xb5\xd1\x80\xd0\xbe\xd0\xbf\xd1\x80\xd0\xb8\xd1\x8f\xd1\x82\xd0\xb8\xd0\xb9 \xd1\x81\xd0\xbc\xd0\xb5\xd0\xbd\xd0\xb0 \xd1\x86\xd0\xb2\xd0\xb5\xd1\x82\xd0\xb0 \xd0\xb1\xd0\xbb\xd0\xbe\xd0\xba\xd0\xb8\xd1\x80\xd1\x83\xd0\xb5\xd1\x82\xd1\x81\xd1\x8f.\xd0\xa4\xd0\xbe\xd1\x80\xd0\xbc\xd0\xb0\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe, \xd0\xb1\xd0\xbe\xd1\x82 \xd0\xbe\xd0\xb1\xd1\x80\xd0\xb0\xd0\xb1\xd0\xb0\xd1\x82\xd1\x8b\xd0\xb2\xd0\xb0\xd0\xb5\xd1\x82 \xd1\x82\xd1\x80\xd0\xb8 \xd1\x82\xd0\xb8\xd0\xbf\xd0\xb0 \xd1\x81\xd0\xbe\xd0\xbe\xd0\xb1\xd1\x89\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb9:   lock: \xd0\xb7\xd0\xb0\xd0\xb1\xd0\xbb\xd0\xbe\xd0\xba\xd0\xb8\xd1\x80\xd0\xbe\xd0\xb2\xd0\xb0\xd1\x82\xd1\x8c \xd0\xb8\xd0\xb7\xd0\xbc\xd0\xb5\xd0\xbd\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb5 \xd1\x86\xd0\xb2\xd0\xb5\xd1\x82\xd0\xb0. \xd0\x95\xd1\x81\xd0\xbb\xd0\xb8 \xd0\xbe\xd0\xbd\xd0\xbe \xd0\xb8 \xd1\x82\xd0\xb0\xd0\xba \xd0\xb7\xd0\xb0\xd0\xb1\xd0\xbb\xd0\xbe\xd0\xba\xd0\xb8\xd1\x80\xd0\xbe\xd0\xb2\xd0\xb0\xd0\xbd\xd0\xbe \xd0\xbd\xd0\xb0 \xd0\xb4\xd0\xb0\xd0\xbd\xd0\xbd\xd1\x8b\xd0\xb9 \xd0\xbc\xd0\xbe\xd0\xbc\xd0\xb5\xd0\xbd\xd1\x82, \xd1\x81\xd0\xbe\xd0\xbe\xd0\xb1\xd1\x89\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb5 \xd0\xb8\xd0\xb3\xd0\xbd\xd0\xbe\xd1\x80\xd0\xb8\xd1\x80\xd1\x83\xd0\xb5\xd1\x82\xd1\x81\xd1\x8f.  unlock: \xd1\x80\xd0\xb0\xd0\xb7\xd0\xb1\xd0\xbb\xd0\xbe\xd0\xba\xd0\xb8\xd1\x80\xd0\xbe\xd0\xb2\xd0\xb0\xd1\x82\xd1\x8c \xd0\xb8\xd0\xb7\xd0\xbc\xd0\xb5\xd0\xbd\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb5 \xd1\x86\xd0\xb2\xd0\xb5\xd1\x82\xd0\xb0. \xd0\x95\xd1\x81\xd0\xbb\xd0\xb8 \xd0\xbe\xd0\xbd\xd0\xbe \xd0\xb8 \xd1\x82\xd0\xb0\xd0\xba \xd1\x80\xd0\xb0\xd0\xb7\xd0\xb1\xd0\xbb\xd0\xbe\xd0\xba\xd0\xb8\xd1\x80\xd0\xbe\xd0\xb2\xd0\xb0\xd0\xbd\xd0\xbe \xd0\xbd\xd0\xb0 \xd0\xb4\xd0\xb0\xd0\xbd\xd0\xbd\xd1\x8b\xd0\xb9 \xd0\xbc\xd0\xbe\xd0\xbc\xd0\xb5\xd0\xbd\xd1\x82, \xd1\x81\xd0\xbe\xd0\xbe\xd0\xb1\xd1\x89\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb5 \xd0\xb8\xd0\xb3\xd0\xbd\xd0\xbe\xd1\x80\xd0\xb8\xd1\x80\xd1\x83\xd0\xb5\xd1\x82\xd1\x81\xd1\x8f.  red / orange / yellow / green / blue / indigo / violet: \xd0\xb8\xd0\xb7\xd0\xbc\xd0\xb5\xd0\xbd\xd0\xb8\xd1\x82\xd1\x8c \xd1\x86\xd0\xb2\xd0\xb5\xd1\x82 \xd0\xba\xd1\x83\xd0\xbf\xd0\xbe\xd0\xbb\xd0\xb0 \xd0\xbd\xd0\xb0 \xd0\xb7\xd0\xb0\xd0\xb4\xd0\xb0\xd0\xbd\xd0\xbd\xd1\x8b\xd0\xb9, \xd0\xb5\xd1\x81\xd0\xbb\xd0\xb8 \xd0\xb8\xd0\xb7\xd0\xbc\xd0\xb5\xd0\xbd\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb5 \xd1\x86\xd0\xb2\xd0\xb5\xd1\x82\xd0\xb0 \xd0\xbd\xd0\xb0 \xd0\xb4\xd0\xb0\xd0\xbd\xd0\xbd\xd1\x8b\xd0\xb9 \xd0\xbc\xd0\xbe\xd0\xbc\xd0\xb5\xd0\xbd\xd1\x82 \xd0\xbd\xd0\xb5 \xd0\xb7\xd0\xb0\xd0\xb1\xd0\xbb\xd0\xbe\xd0\xba\xd0\xb8\xd1\x80\xd0\xbe\xd0\xb2\xd0\xb0\xd0\xbd\xd0\xbe. \xd0\x92\xd0\xb0\xd0\xbc \xd0\xb4\xd0\xb0\xd0\xbd\xd0\xb0 \xd0\xb8\xd1\x81\xd1\x82\xd0\xbe\xd1\x80\xd0\xb8\xd1\x8f \xd1\x81\xd0\xbe\xd0\xbe\xd0\xb1\xd1\x89\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb9, \xd0\xbf\xd0\xbe\xd0\xbb\xd1\x83\xd1\x87\xd0\xb5\xd0\xbd\xd0\xbd\xd1\x8b\xd1\x85 \xd0\xb1\xd0\xbe\xd1\x82\xd0\xbe\xd0\xbc, \xd0\xb2 \xd1\x85\xd1\x80\xd0\xbe\xd0\xbd\xd0\xbe\xd0\xbb\xd0\xbe\xd0\xb3\xd0\xb8\xd1\x87\xd0\xb5\xd1\x81\xd0\xba\xd0\xbe\xd0\xbc \xd0\xbf\xd0\xbe\xd1\x80\xd1\x8f\xd0\xb4\xd0\xba\xd0\xb5. \xd0\xa1\xd1\x87\xd0\xb8\xd1\x82\xd0\xb0\xd0\xb9\xd1\x82\xd0\xb5, \xd1\x87\xd1\x82\xd0\xbe \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb5\xd0\xb4 \xd0\xbf\xd0\xbe\xd0\xbb\xd1\x83\xd1\x87\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb5\xd0\xbc \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb2\xd0\xbe\xd0\xb3\xd0\xbe \xd1\x81\xd0\xbe\xd0\xbe\xd0\xb1\xd1\x89\xd0\xb5\xd0\xbd\xd0\xb8\xd1\x8f \xd0\xba\xd1\x83\xd0\xbf\xd0\xbe\xd0\xbb \xd0\xbf\xd0\xbe\xd0\xb4\xd1\x81\xd0\xb2\xd0\xb5\xd1\x87\xd0\xb8\xd0\xb2\xd0\xb0\xd0\xb5\xd1\x82\xd1\x81\xd1\x8f \xd0\xb3\xd0\xbe\xd0\xbb\xd1\x83\xd0\xb1\xd1\x8b\xd0\xbc (blue), \xd0\xb0 \xd0\xb8\xd0\xb7\xd0\xbc\xd0\xb5\xd0\xbd\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb5 \xd1\x86\xd0\xb2\xd0\xb5\xd1\x82\xd0\xb0 \xd0\xbd\xd0\xb5 \xd0\xb7\xd0\xb0\xd0\xb1\xd0\xbb\xd0\xbe\xd0\xba\xd0\xb8\xd1\x80\xd0\xbe\xd0\xb2\xd0\xb0\xd0\xbd\xd0\xbe.\xd0\x9e\xd0\xbf\xd1\x80\xd0\xb5\xd0\xb4\xd0\xb5\xd0\xbb\xd0\xb8\xd1\x82\xd0\xb5, \xd0\xba\xd0\xb0\xd0\xba\xd0\xbe\xd0\xb9 \xd1\x86\xd0\xb2\xd0\xb5\xd1\x82 \xd0\xb1\xd1\x83\xd0\xb4\xd0\xb5\xd1\x82 \xd1\x83 \xd0\xba\xd1\x83\xd0\xbf\xd0\xbe\xd0\xbb\xd0\xb0 \xd0\x94\xd0\xbe\xd0\xbc\xd0\xb0 \xd0\x97\xd0\xb8\xd0\xbd\xd0\xb3\xd0\xb5\xd1\x80\xd0\xb0 \xd0\xbf\xd0\xbe\xd1\x81\xd0\xbb\xd0\xb5 \xd0\xbe\xd0\xb1\xd1\x80\xd0\xb0\xd0\xb1\xd0\xbe\xd1\x82\xd0\xba\xd0\xb8 \xd1\x8d\xd1\x82\xd0\xb8\xd1\x85 \xd1\x81\xd0\xbe\xd0\xbe\xd0\xb1\xd1\x89\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb9." -999
1530H "Turing\'s Award" "data structures,dp" "Alan Turing is standing on a tape divided into cells that is infinite in both directions.Cells are numbered with consecutive integers from left to right. Alan is initially standing in cell 0. Every cell x has cell x\xe2\x88\x921 on the left and cell x+1 on the right.Each cell can either contain an integer or be empty. Initially all cells are empty.Alan is given a permutation a1,a2,\xe2\x80\xa6,an of integers from 1 to n that was chosen uniformly at random among all permutations of length n.At time 1, integer a1 is written down into cell 0 where Alan is located.At each time i from 2 to n inclusive, the following happens. First, Alan decides whether to stay in the same cell he\'s currently in, move to the neighboring cell on the left, or move to the neighboring cell on the right. After that, integer ai is written down into the cell where Alan is located. If that cell already contained some integer, the old integer is overwritten and irrelevant from that moment on.Once an is written down into some cell at time n, sequence b of all integers contained in the cells from left to right is formed. Empty cells are ignored.Turing\'s award is equal to the length of the longest increasing subsequence of sequence b.Help Alan and determine the largest possible value of his award if he acts optimally." 3400
1530G "What a Reversal" "constructive algorithms" "You have two strings a and b of equal length n consisting of characters 0 and 1, and an integer k.You need to make strings a and b equal.In one step, you can choose any substring of a containing exactly k characters 1 (and arbitrary number of characters 0) and reverse it. Formally, if a=a1a2\xe2\x80\xa6an, you can choose any integers l and r (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n) such that there are exactly k ones among characters al,al+1,\xe2\x80\xa6,ar, and set a to a1a2\xe2\x80\xa6al\xe2\x88\x921arar\xe2\x88\x921\xe2\x80\xa6alar+1ar+2\xe2\x80\xa6an.Find a way to make a equal to b using at most 4n reversals of the above kind, or determine that such a way doesn\'t exist. The number of reversals doesn\'t have to be minimized." 3300
1530F Bingo bitmasks,combinatorics,dp,math,probabilities "Getting ready for VK Fest 2021, you prepared a table with n rows and n columns, and filled each cell of this table with some event related with the festival that could either happen or not: for example, whether you will win a prize on the festival, or whether it will rain.Forecasting algorithms used in VK have already estimated the probability for each event to happen. Event in row i and column j will happen with probability ai,j\xe2\x8b\x8510\xe2\x88\x924. All of the events are mutually independent.Let\'s call the table winning if there exists a line such that all n events on it happen. The line could be any horizontal line (cells (i,1),(i,2),\xe2\x80\xa6,(i,n) for some i), any vertical line (cells (1,j),(2,j),\xe2\x80\xa6,(n,j) for some j), the main diagonal (cells (1,1),(2,2),\xe2\x80\xa6,(n,n)), or the antidiagonal (cells (1,n),(2,n\xe2\x88\x921),\xe2\x80\xa6,(n,1)).Find the probability of your table to be winning, and output it modulo 31607 (see Output section)." 2600
1530E Minimax "constructive algorithms,greedy,strings" "Prefix function of string t=t1t2\xe2\x80\xa6tn and position i in it is defined as the length k of the longest proper (not equal to the whole substring) prefix of substring t1t2\xe2\x80\xa6ti which is also a suffix of the same substring.For example, for string t= abacaba the values of the prefix function in positions 1,2,\xe2\x80\xa6,7 are equal to [0,0,1,0,1,2,3].Let f(t) be equal to the maximum value of the prefix function of string t over all its positions. For example, f(abacaba)=3.You are given a string s. Reorder its characters arbitrarily to get a string t (the number of occurrences of any character in strings s and t must be equal). The value of f(t) must be minimized. Out of all options to minimize f(t), choose the one where string t is the lexicographically smallest." 2100
1530D "Secret Santa" "constructive algorithms,flows,graphs,greedy,math" "Every December, VK traditionally holds an event for its employees named ""Secret Santa"". Here\'s how it happens.n employees numbered from 1 to n take part in the event. Each employee i is assigned a different employee bi, to which employee i has to make a new year gift. Each employee is assigned to exactly one other employee, and nobody is assigned to themselves (but two employees may be assigned to each other). Formally, all bi must be distinct integers between 1 and n, and for any i, bi\xe2\x89\xa0i must hold.The assignment is usually generated randomly. This year, as an experiment, all event participants have been asked who they wish to make a gift to. Each employee i has said that they wish to make a gift to employee ai.Find a valid assignment b that maximizes the number of fulfilled wishes of the employees." 1600
1530C Pursuit "binary search,brute force,greedy,sortings" "You and your friend Ilya are participating in an individual programming contest consisting of multiple stages. A contestant can get between 0 and 100 points, inclusive, for each stage, independently of other contestants.Points received by contestants in different stages are used for forming overall contest results. Suppose that k stages of the contest are completed. For each contestant, k\xe2\x88\x92\xe2\x8c\x8ak4\xe2\x8c\x8b stages with the highest scores are selected, and these scores are added up. This sum is the overall result of the contestant. (Here \xe2\x8c\x8at\xe2\x8c\x8b denotes rounding t down.)For example, suppose 9 stages are completed, and your scores are 50,30,50,50,100,10,30,100,50. First, 7 stages with the highest scores are chosen \xe2\x80\x94 for example, all stages except for the 2-nd and the 6-th can be chosen. Then your overall result is equal to 50+50+50+100+30+100+50=430.As of now, n stages are completed, and you know the points you and Ilya got for these stages. However, it is unknown how many more stages will be held. You wonder what the smallest number of additional stages is, after which your result might become greater than or equal to Ilya\'s result, at least in theory. Find this number!" 1200
1530B "Putting Plates" "constructive algorithms,implementation" "To celebrate your birthday you have prepared a festive table! Now you want to seat as many guests as possible.The table can be represented as a rectangle with height h and width w, divided into h\xc3\x97w cells. Let (i,j) denote the cell in the i-th row and the j-th column of the rectangle (1\xe2\x89\xa4i\xe2\x89\xa4h; 1\xe2\x89\xa4j\xe2\x89\xa4w).Into each cell of the table you can either put a plate or keep it empty.As each guest has to be seated next to their plate, you can only put plates on the edge of the table \xe2\x80\x94 into the first or the last row of the rectangle, or into the first or the last column. Formally, for each cell (i,j) you put a plate into, at least one of the following conditions must be satisfied: i=1, i=h, j=1, j=w.To make the guests comfortable, no two plates must be put into cells that have a common side or corner. In other words, if cell (i,j) contains a plate, you can\'t put plates into cells (i\xe2\x88\x921,j), (i,j\xe2\x88\x921), (i+1,j), (i,j+1), (i\xe2\x88\x921,j\xe2\x88\x921), (i\xe2\x88\x921,j+1), (i+1,j\xe2\x88\x921), (i+1,j+1).Put as many plates on the table as possible without violating the rules above." 800
1530A "Binary Decimal" greedy,math "Let\'s call a number a binary decimal if it\'s a positive integer and all digits in its decimal notation are either 0 or 1. For example, 1010111 is a binary decimal, while 10201 and 787788 are not.Given a number n, you are asked to represent n as a sum of some (not necessarily distinct) binary decimals. Compute the smallest number of binary decimals required for that." 800
1529B "Sifid and Strange Subsequences" greedy,math,sortings "A sequence (b1,b2,\xe2\x80\xa6,bk) is called strange, if the absolute difference between any pair of its elements is greater than or equal to the maximum element in the sequence. Formally speaking, it\'s strange if for every pair (i,j) with 1\xe2\x89\xa4i<j\xe2\x89\xa4k, we have |ai\xe2\x88\x92aj|\xe2\x89\xa5MAX, where MAX is the largest element of the sequence. In particular, any sequence of length at most 1 is strange.For example, the sequences (\xe2\x88\x922021,\xe2\x88\x921,\xe2\x88\x921,\xe2\x88\x921) and (\xe2\x88\x921,0,1) are strange, but (3,0,1) is not, because |0\xe2\x88\x921|<3.Sifid has an array a of n integers. Sifid likes everything big, so among all the strange subsequences of a, he wants to find the length of the longest one. Can you help him?A sequence c is a subsequence of an array d if c can be obtained from d by deletion of several (possibly, zero or all) elements." 1100
1529A "Eshag Loves Big Arrays" "constructive algorithms,greedy,math" "Eshag has an array a consisting of n integers.Eshag can perform the following operation any number of times: choose some subsequence of a and delete every element from it which is strictly larger than AVG, where AVG is the average of the numbers in the chosen subsequence.For example, if a=[1,4,3,2,4] and Eshag applies the operation to the subsequence containing a1, a2, a4 and a5, then he will delete those of these 4 elements which are larger than a1+a2+a4+a54=114, so after the operation, the array a will become a=[1,3,2].Your task is to find the maximum number of elements Eshag can delete from the array a by applying the operation described above some number (maybe, zero) times.A sequence b is a subsequence of an array c if b can be obtained from c by deletion of several (possibly, zero or all) elements." 800
1528F "AmShZ Farm" combinatorics,fft,math "To AmShZ, all arrays are equal, but some arrays are more-equal than others. Specifically, the arrays consisting of n elements from 1 to n that can be turned into permutations of numbers from 1 to n by adding a non-negative integer to each element.Mashtali who wants to appear in every problem statement thinks that an array b consisting of k elements is compatible with a more-equal array a consisting of n elements if for each 1\xe2\x89\xa4i\xe2\x89\xa4k we have 1\xe2\x89\xa4bi\xe2\x89\xa4n and also ab1=ab2=\xe2\x80\xa6=abk.Find the number of pairs of arrays a and b such that a is a more-equal array consisting of n elements and b is an array compatible with a consisting of k elements modulo 998244353.Note that the elements of b are not necessarily distinct, same holds for a." 3300
1528E "Mashtali and Hagh Trees" combinatorics,dp,trees "Today is Mashtali\'s birthday! He received a Hagh tree from Haj Davood as his birthday present!A directed tree is called a Hagh tree iff:   The length of the longest directed path in it is exactly n.  Every vertex has at most three edges attached to it independent of their orientation.  Let\'s call vertices u and v friends if one of them has a directed path to the other. For every pair of vertices u and v that are not friends, there should exist a vertex w that is friends with both u and v (a mutual friend). After opening his gift, Mashtali found out that the labels on the vertices were gone.Immediately, he asked himself: how many different unlabeled Hagh trees are there? That is, how many possible trees could he have received as his birthday present?At the first glance, the number of such trees seemed to be infinite since there was no limit on the number of vertices; but then he solved the problem and proved that there\'s a finite number of unlabeled Hagh trees!Amazed by this fact, he shared the task with you so that you could enjoy solving it as well. Since the answer can be rather large he asked you to find the number of different unlabeled Hagh trees modulo 998244353.Here two trees are considered different, if they are not isomorphic: if there is no way to map nodes of one tree to the second tree, so that edges are mapped to edges preserving the orientation.Some examples for n=2:   Directed trees D and E are Hagh. C is not Hagh because it has a vertex with 4 edges attached to it. A and B are not Hagh because their longest directed paths are not equal to n. Also in B the leftmost and rightmost vertices are not friends neither do they have a mutual friend." 2900
1528D "It\'s a bird! No, it\'s a plane! No, it\'s AaParsa!" "constructive algorithms,graphs,shortest paths" "There are n cities in Shaazzzland, numbered from 0 to n\xe2\x88\x921. Ghaazzzland, the immortal enemy of Shaazzzland, is ruled by AaParsa.As the head of the Ghaazzzland\'s intelligence agency, AaParsa is carrying out the most important spying mission in Ghaazzzland\'s history on Shaazzzland.AaParsa has planted m transport cannons in the cities of Shaazzzland. The i-th cannon is planted in the city ai and is initially pointing at city bi.It is guaranteed that each of the n cities has at least one transport cannon planted inside it, and that no two cannons from the same city are initially pointing at the same city (that is, all pairs (ai,bi) are distinct).AaParsa used very advanced technology to build the cannons, the cannons rotate every second. In other words, if the i-th cannon is pointing towards the city x at some second, it will target the city (x+1)modn at the next second.As their name suggests, transport cannons are for transportation, specifically for human transport. If you use the i-th cannon to launch yourself towards the city that it\'s currently pointing at, you\'ll be airborne for ci seconds before reaching your target destination.If you still don\'t get it, using the i-th cannon at the s-th second (using which is only possible if you are currently in the city ai) will shoot you to the city (bi+s)modn and you\'ll land in there after ci seconds (so you\'ll be there in the (s+ci)-th second). Also note the cannon that you initially launched from will rotate every second but you obviously won\'t change direction while you are airborne. AaParsa wants to use the cannons for travelling between Shaazzzland\'s cities in his grand plan, and he can start travelling at second 0. For him to fully utilize them, he needs to know the minimum number of seconds required to reach city u from city v using the cannons for every pair of cities (u,v).Note that AaParsa can stay in a city for as long as he wants." 2500
1528C "Trees of Tranquillity" "data structures,dfs and similar,greedy,trees" "Soroush and Keshi each have a labeled and rooted tree on n vertices. Both of their trees are rooted from vertex 1.Soroush and Keshi used to be at war. After endless decades of fighting, they finally became allies to prepare a Codeforces round. To celebrate this fortunate event, they decided to make a memorial graph on n vertices.They add an edge between vertices u and v in the memorial graph if both of the following conditions hold:   One of u or v is the ancestor of the other in Soroush\'s tree.  Neither of u or v is the ancestor of the other in Keshi\'s tree. Here vertex u is considered ancestor of vertex v, if u lies on the path from 1 (the root) to the v.Popping out of nowhere, Mashtali tried to find the maximum clique in the memorial graph for no reason. He failed because the graph was too big. Help Mashtali by finding the size of the maximum clique in the memorial graph.As a reminder, clique is a subset of vertices of the graph, each two of which are connected by an edge." 2300
1528B "Kavi on Pairing Duty" combinatorics,dp,math "Kavi has 2n points lying on the OX axis, i-th of which is located at x=i.Kavi considers all ways to split these 2n points into n pairs. Among those, he is interested in good pairings, which are defined as follows:Consider n segments with ends at the points in correspondent pairs. The pairing is called good, if for every 2 different segments A and B among those, at least one of the following holds:  One of the segments A and B lies completely inside the other.  A and B have the same length. Consider the following example:  A is a good pairing since the red segment lies completely inside the blue segment.B is a good pairing since the red and the blue segment have the same length.C is not a good pairing since none of the red or blue segments lies inside the other, neither do they have the same size.Kavi is interested in the number of good pairings, so he wants you to find it for him. As the result can be large, find this number modulo 998244353.Two pairings are called different, if some two points are in one pair in some pairing and in different pairs in another." 1700
1528A "Parsa\'s Humongous Tree" "dfs and similar,divide and conquer,dp,greedy,trees" "Parsa has a humongous tree on n vertices.On each vertex v he has written two integers lv and rv.To make Parsa\'s tree look even more majestic, Nima wants to assign a number av (lv\xe2\x89\xa4av\xe2\x89\xa4rv) to each vertex v such that the beauty of Parsa\'s tree is maximized.Nima\'s sense of the beauty is rather bizarre. He defines the beauty of the tree as the sum of |au\xe2\x88\x92av| over all edges (u,v) of the tree.Since Parsa\'s tree is too large, Nima can\'t maximize its beauty on his own. Your task is to find the maximum possible beauty for Parsa\'s tree." 1600
1527E "Partition Game" "binary search,data structures,divide and conquer,dp" "You are given an array a of n integers. Define the cost of some array t as follows:cost(t)=\xe2\x88\x91x\xe2\x88\x88set(t)last(x)\xe2\x88\x92first(x), where set(t) is the set of all values in t without repetitions, first(x), and last(x) are the indices of the first and last occurrence of x in t, respectively. In other words, we compute the distance between the first and last occurrences for each distinct element and sum them up.You need to split the array a into k consecutive segments such that each element of a belongs to exactly one segment and the sum of the cost of individual segments is minimum." 2500
1527D "MEX Tree" "combinatorics,dfs and similar,implementation,math,trees" "You are given a tree with n nodes, numerated from 0 to n\xe2\x88\x921. For each k between 0 and n, inclusive, you have to count the number of unordered pairs (u,v), u\xe2\x89\xa0v, such that the MEX of all the node labels in the shortest path from u to v (including end points) is k.The MEX of a sequence of integers is the smallest non-negative integer that does not belong to the sequence." 2400
1527C "Sequence Pair Weight" hashing,implementation,math "The weight of a sequence is defined as the number of unordered pairs of indexes (i,j) (here i<j) with same value (ai=aj). For example, the weight of sequence a=[1,1,2,2,1] is 4. The set of unordered pairs of indexes with same value are (1,2), (1,5), (2,5), and (3,4).You are given a sequence a of n integers. Print the sum of the weight of all subsegments of a. A sequence b is a subsegment of a sequence a if b can be obtained from a by deletion of several (possibly, zero or all) elements from the beginning and several (possibly, zero or all) elements from the end." 1600
1527B2 "Palindrome Game (hard version)" "constructive algorithms,games" "The only difference between the easy and hard versions is that the given string s in the easy version is initially a palindrome, this condition is not always true for the hard version.A palindrome is a string that reads the same left to right and right to left. For example, ""101101"" is a palindrome, while ""0101"" is not.Alice and Bob are playing a game on a string s of length n consisting of the characters \'0\' and \'1\'. Both players take alternate turns with Alice going first.In each turn, the player can perform one of the following operations:   Choose any i (1\xe2\x89\xa4i\xe2\x89\xa4n), where s[i]= \'0\' and change s[i] to \'1\'. Pay 1 dollar.  Reverse the whole string, pay 0 dollars. This operation is only allowed if the string is currently not a palindrome, and the last operation was not reverse. That is, if Alice reverses the string, then Bob can\'t reverse in the next move, and vice versa. Reversing a string means reordering its letters from the last to the first. For example, ""01001"" becomes ""10010"" after reversing.The game ends when every character of string becomes \'1\'. The player who spends minimum dollars till this point wins the game and it is a draw if both spend equal dollars. If both players play optimally, output whether Alice wins, Bob wins, or if it is a draw." 1900
1527B1 "Palindrome Game (easy version)" "constructive algorithms,games" "The only difference between the easy and hard versions is that the given string s in the easy version is initially a palindrome, this condition is not always true for the hard version.A palindrome is a string that reads the same left to right and right to left. For example, ""101101"" is a palindrome, while ""0101"" is not.Alice and Bob are playing a game on a string s (which is initially a palindrome in this version) of length n consisting of the characters \'0\' and \'1\'. Both players take alternate turns with Alice going first.In each turn, the player can perform one of the following operations:   Choose any i (1\xe2\x89\xa4i\xe2\x89\xa4n), where s[i]= \'0\' and change s[i] to \'1\'. Pay 1 dollar.  Reverse the whole string, pay 0 dollars. This operation is only allowed if the string is currently not a palindrome, and the last operation was not reverse. That is, if Alice reverses the string, then Bob can\'t reverse in the next move, and vice versa. Reversing a string means reordering its letters from the last to the first. For example, ""01001"" becomes ""10010"" after reversing.The game ends when every character of string becomes \'1\'. The player who spends minimum dollars till this point wins the game and it is a draw if both spend equal dollars. If both players play optimally, output whether Alice wins, Bob wins, or if it is a draw." 1200
1527A "And Then There Were K" bitmasks "Given an integer n, find the maximum value of integer k such that the following condition holds:  n & (n\xe2\x88\x921) & (n\xe2\x88\x922) & (n\xe2\x88\x923) & ... (k) = 0  where & denotes the bitwise AND operation." 800
1526F "Median Queries" "constructive algorithms,interactive,probabilities" "This is an interactive problem.There is a secret permutation p (1-indexed) of numbers from 1 to n. More formally, for 1\xe2\x89\xa4i\xe2\x89\xa4n, 1\xe2\x89\xa4p[i]\xe2\x89\xa4n and for 1\xe2\x89\xa4i<j\xe2\x89\xa4n, p[i]\xe2\x89\xa0p[j]. It is known that p[1]<p[2].In 1 query, you give 3 distinct integers a,b,c (1\xe2\x89\xa4a,b,c\xe2\x89\xa4n), and receive the median of {|p[a]\xe2\x88\x92p[b]|,|p[b]\xe2\x88\x92p[c]|,|p[a]\xe2\x88\x92p[c]|}.In this case, the median is the 2-nd element (1-indexed) of the sequence when sorted in non-decreasing order. The median of {4,6,2} is 4 and the median of {0,123,33} is 33.Can you find the secret permutation in not more than 2n+420 queries?Note: the grader is not adaptive: the permutation is fixed before any queries are made." 3000
1526E "Oolimry and Suffix Array" "combinatorics,constructive algorithms,math" "Once upon a time, Oolimry saw a suffix array. He wondered how many strings can produce this suffix array. More formally, given a suffix array of length n and having an alphabet size k, count the number of strings that produce such a suffix array. Let s be a string of length n. Then the i-th suffix of s is the substring s[i\xe2\x80\xa6n\xe2\x88\x921]. A suffix array is the array of integers that represent the starting indexes of all the suffixes of a given string, after the suffixes are sorted in the lexicographic order. For example, the suffix array of oolimry is [3,2,4,1,0,5,6] as the array of sorted suffixes is [imry,limry,mry,olimry,oolimry,ry,y]. A string x is lexicographically smaller than string y, if either x is a prefix of y (and x\xe2\x89\xa0y), or there exists such i that xi<yi, and for any 1\xe2\x89\xa4j<i , xj=yj." 2400
1526D "Kill Anton" "brute force,constructive algorithms,data structures,math,strings" "After rejecting 10100 data structure problems, Errorgorn is very angry at Anton and decided to kill him.Anton\'s DNA can be represented as a string a which only contains the characters ""ANTON"" (there are only 4 distinct characters). Errorgorn can change Anton\'s DNA into string b which must be a permutation of a. However, Anton\'s body can defend against this attack. In 1 second, his body can swap 2 adjacent characters of his DNA to transform it back to a. Anton\'s body is smart and will use the minimum number of moves.To maximize the chance of Anton dying, Errorgorn wants to change Anton\'s DNA the string that maximizes the time for Anton\'s body to revert his DNA. But since Errorgorn is busy making more data structure problems, he needs your help to find the best string B. Can you help him?" 2200
1526C2 "Potions (Hard Version)" "data structures,greedy" "This is the hard version of the problem. The only difference is that in this version n\xe2\x89\xa4200000. You can make hacks only if both versions of the problem are solved.There are n potions in a line, with potion 1 on the far left and potion n on the far right. Each potion will increase your health by ai when drunk. ai can be negative, meaning that potion will decrease will health.You start with 0 health and you will walk from left to right, from first potion to the last one. At each potion, you may choose to drink it or ignore it. You must ensure that your health is always non-negative.What is the largest number of potions you can drink?" 1600
1526C1 "Potions (Easy Version)" "brute force,data structures,dp,greedy" "This is the easy version of the problem. The only difference is that in this version n\xe2\x89\xa42000. You can make hacks only if both versions of the problem are solved.There are n potions in a line, with potion 1 on the far left and potion n on the far right. Each potion will increase your health by ai when drunk. ai can be negative, meaning that potion will decrease will health.You start with 0 health and you will walk from left to right, from first potion to the last one. At each potion, you may choose to drink it or ignore it. You must ensure that your health is always non-negative.What is the largest number of potions you can drink?" 1500
1526B "I Hate 1111" "dp,math,number theory" "You are given an integer x. Can you make x by summing up some number of 11,111,1111,11111,\xe2\x80\xa6? (You can use any number among them any number of times).For instance,   33=11+11+11  144=111+11+11+11" 1400
1526A "Mean Inequality" "constructive algorithms,sortings" "You are given an array a of 2n distinct integers. You want to arrange the elements of the array in a circle such that no element is equal to the the arithmetic mean of its 2 neighbours.More formally, find an array b, such that: b is a permutation of a.For every i from 1 to 2n, bi\xe2\x89\xa0bi\xe2\x88\x921+bi+12, where b0=b2n and b2n+1=b1. It can be proved that under the constraints of this problem, such array b always exists." 800
1525F "Goblins And Gnomes" "brute force,dp,flows,graph matchings" "Monocarp plays a computer game called ""Goblins and Gnomes"". In this game, he manages a large underground city of gnomes and defends it from hordes of goblins.The city consists of n halls and m one-directional tunnels connecting them. The structure of tunnels has the following property: if a goblin leaves any hall, he cannot return to that hall. The city will be attacked by k waves of goblins; during the i-th wave, i goblins attack the city. Monocarp\'s goal is to pass all k waves.The i-th wave goes as follows: firstly, i goblins appear in some halls of the city and pillage them; at most one goblin appears in each hall. Then, goblins start moving along the tunnels, pillaging all the halls in their path. Goblins are very greedy and cunning, so they choose their paths so that no two goblins pass through the same hall. Among all possible attack plans, they choose a plan which allows them to pillage the maximum number of halls. After goblins are done pillaging, they leave the city.If all halls are pillaged during the wave \xe2\x80\x94 Monocarp loses the game. Otherwise, the city is restored. If some hall is pillaged during a wave, goblins are still interested in pillaging it during the next waves.Before each wave, Monocarp can spend some time preparing to it. Monocarp doesn\'t have any strict time limits on his preparations (he decides when to call each wave by himself), but the longer he prepares for a wave, the fewer points he gets for passing it. If Monocarp prepares for the i-th wave for ti minutes, then he gets max(0,xi\xe2\x88\x92ti\xe2\x8b\x85yi) points for passing it (obviously, if he doesn\'t lose in the process).While preparing for a wave, Monocarp can block tunnels. He can spend one minute to either block all tunnels leading from some hall or block all tunnels leading to some hall. If Monocarp blocks a tunnel while preparing for a wave, it stays blocked during the next waves as well.Help Monocarp to defend against all k waves of goblins and get the maximum possible amount of points!" 2800
1525E "Assimilation IV" "combinatorics,dp,math,probabilities,two pointers" "Monocarp is playing a game ""Assimilation IV"". In this game he manages a great empire: builds cities and conquers new lands.Monocarp\'s empire has n cities. In order to conquer new lands he plans to build one Monument in each city. The game is turn-based and, since Monocarp is still amateur, he builds exactly one Monument per turn.Monocarp has m points on the map he\'d like to control using the constructed Monuments. For each point he knows the distance between it and each city. Monuments work in the following way: when built in some city, a Monument controls all points at distance at most 1 to this city. Next turn, the Monument controls all points at distance at most 2, the turn after \xe2\x80\x94 at distance at most 3, and so on. Monocarp will build n Monuments in n turns and his empire will conquer all points that are controlled by at least one Monument.Monocarp can\'t figure out any strategy, so during each turn he will choose a city for a Monument randomly among all remaining cities (cities without Monuments). Monocarp wants to know how many points (among m of them) he will conquer at the end of turn number n. Help him to calculate the expected number of conquered points!" 2100
