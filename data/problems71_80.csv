696C PLEASE combinatorics,dp,implementation,math,matrices "As we all know Barney\'s job is ""PLEASE"" and he has not much to do at work. That\'s why he started playing ""cups and key"". In this game there are three identical cups arranged in a line from left to right. Initially key to Barney\'s heart is under the middle cup.  Then at one turn Barney swaps the cup in the middle with any of other two cups randomly (he choses each with equal probability), so the chosen cup becomes the middle one. Game lasts n turns and Barney independently choses a cup to swap with the middle one within each turn, and the key always remains in the cup it was at the start.After n-th turn Barney asks a girl to guess which cup contains the key. The girl points to the middle one but Barney was distracted while making turns and doesn\'t know if the key is under the middle cup. That\'s why he asked you to tell him the probability that girl guessed right.Number n of game turns can be extremely large, that\'s why Barney did not give it to you. Instead he gave you an array a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89ak such that   in other words, n is multiplication of all elements of the given array.Because of precision difficulties, Barney asked you to tell him the answer as an irreducible fraction. In other words you need to find it as a fraction p\xe2\x80\x89/\xe2\x80\x89q such that , where  is the greatest common divisor. Since p and q can be extremely large, you only need to find the remainders of dividing each of them by 109\xe2\x80\x89+\xe2\x80\x897.Please note that we want  of p and q to be 1, not  of their remainders after dividing by 109\xe2\x80\x89+\xe2\x80\x897." 2000
696B Puzzles "dfs and similar,math,probabilities,trees" "Barney lives in country USC (United States of Charzeh). USC has n cities numbered from 1 through n and n\xe2\x80\x89-\xe2\x80\x891 roads between them. Cities and roads of USC form a rooted tree (Barney\'s not sure why it is rooted). Root of the tree is the city number 1. Thus if one will start his journey from city 1, he can visit any city he wants by following roads.  Some girl has stolen Barney\'s heart, and Barney wants to find her. He starts looking for in the root of the tree and (since he is Barney Stinson not a random guy), he uses a random DFS to search in the cities. A pseudo code of this algorithm is as follows:let starting_time be an array of length ncurrent_time = 0dfs(v):\tcurrent_time = current_time + 1\tstarting_time[v] = current_time\tshuffle children[v] randomly (each permutation with equal possibility)\t// children[v] is vector of children cities of city v\tfor u in children[v]:\t\tdfs(u)As told before, Barney will start his journey in the root of the tree (equivalent to call dfs(1)).Now Barney needs to pack a backpack and so he wants to know more about his upcoming journey: for every city i, Barney wants to know the expected value of starting_time[i]. He\'s a friend of Jon Snow and knows nothing, that\'s why he asked for your help." 1700
696A "Lorenzo Von Matterhorn" "brute force,data structures,implementation,trees" "Barney lives in NYC. NYC has infinite number of intersections numbered with positive integers starting from 1. There exists a bidirectional road between intersections i and 2i and another road between i and 2i\xe2\x80\x89+\xe2\x80\x891 for every positive integer i. You can clearly see that there exists a unique shortest path between any two intersections.  Initially anyone can pass any road for free. But since SlapsGiving is ahead of us, there will q consecutive events happen soon. There are two types of events:1. Government makes a new rule. A rule can be denoted by integers v, u and w. As the result of this action, the passing fee of all roads on the shortest path from u to v increases by w dollars. 2. Barney starts moving from some intersection v and goes to intersection u where there\'s a girl he wants to cuddle (using his fake name Lorenzo Von Matterhorn). He always uses the shortest path (visiting minimum number of intersections or roads) between two intersections.Government needs your calculations. For each time Barney goes to cuddle a girl, you need to tell the government how much money he should pay (sum of passing fee of all roads he passes)." 1500
691F "Couple Cover" "brute force,dp,number theory" "Couple Cover, a wildly popular luck-based game, is about to begin! Two players must work together to construct a rectangle. A bag with n balls, each with an integer written on it, is placed on the table. The first player reaches in and grabs a ball randomly (all balls have equal probability of being chosen) \xe2\x80\x94 the number written on this ball is the rectangle\'s width in meters. This ball is not returned to the bag, and the second player reaches into the bag and grabs another ball \xe2\x80\x94 the number written on this ball is the rectangle\'s height in meters. If the area of the rectangle is greater than or equal some threshold p square meters, the players win. Otherwise, they lose.The organizers of the game are trying to select an appropriate value for p so that the probability of a couple winning is not too high and not too low, but they are slow at counting, so they have hired you to answer some questions for them. You are given a list of the numbers written on the balls, the organizers would like to know how many winning pairs of balls exist for different values of p. Note that two pairs are different if either the first or the second ball is different between the two in pair, and two different balls with the same number are considered different." 2200
691E Xor-sequences matrices "You are given n integers a1,\xe2\x80\x89\xe2\x80\x89a2,\xe2\x80\x89\xe2\x80\x89...,\xe2\x80\x89\xe2\x80\x89an.A sequence of integers x1,\xe2\x80\x89\xe2\x80\x89x2,\xe2\x80\x89\xe2\x80\x89...,\xe2\x80\x89\xe2\x80\x89xk is called a ""xor-sequence"" if for every 1\xe2\x80\x89\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89\xe2\x80\x89i\xe2\x80\x89\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89\xe2\x80\x89k\xe2\x80\x89-\xe2\x80\x891 the number of ones in the binary representation of the number xi  xi\xe2\x80\x89\xe2\x80\x89+\xe2\x80\x89\xe2\x80\x891\'s is a multiple of 3 and  for all 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k. The symbol  is used for the binary exclusive or operation.How many ""xor-sequences"" of length k exist? Output the answer modulo 109\xe2\x80\x89+\xe2\x80\x897.Note if a\xe2\x80\x89=\xe2\x80\x89[1,\xe2\x80\x891] and k\xe2\x80\x89=\xe2\x80\x891 then the answer is 2, because you should consider the ones from a as different." 1900
691D "Swaps in Permutation" "dfs and similar,dsu,math" "You are given a permutation of the numbers 1,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89n and m pairs of positions (aj,\xe2\x80\x89bj).At each step you can choose a pair from the given positions and swap the numbers in that positions. What is the lexicographically maximal permutation one can get?Let p and q be two permutations of the numbers 1,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89n. p is lexicographically smaller than the q if a number 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n exists, so pk\xe2\x80\x89=\xe2\x80\x89qk for 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k\xe2\x80\x89<\xe2\x80\x89i and pi\xe2\x80\x89<\xe2\x80\x89qi." 1700
691C "Exponential notation" implementation,strings "You are given a positive decimal number x.Your task is to convert it to the ""simple exponential notation"".Let x\xe2\x80\x89=\xe2\x80\x89a\xc2\xb710b, where 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a\xe2\x80\x89<\xe2\x80\x8910, then in general case the ""simple exponential notation"" looks like ""aEb"". If b equals to zero, the part ""Eb"" should be skipped. If a is an integer, it should be written without decimal point. Also there should not be extra zeroes in a and b." 1800
691B s-palindrome implementation,strings "Let\'s call a string ""s-palindrome"" if it is symmetric about the middle of the string. For example, the string ""oHo"" is ""s-palindrome"", but the string ""aa"" is not. The string ""aa"" is not ""s-palindrome"", because the second half of it is not a mirror reflection of the first half.  English alphabet You are given a string s. Check if the string is ""s-palindrome""." 1600
691A "Fashion in Berland" implementation "According to rules of the Berland fashion, a jacket should be fastened by all the buttons except only one, but not necessarily it should be the last one. Also if the jacket has only one button, it should be fastened, so the jacket will not swinging open.You are given a jacket with n buttons. Determine if it is fastened in a right way." 1000
690F3 "Tree of Life (hard)" trees "To add insult to injury, the zombies have taken all but two drawings from Heidi! Please help her recover the Tree of Life from only these two drawings." 3200
690F2 "Tree of Life (medium)" "constructive algorithms,hashing,trees" "Heidi got tired of deciphering the prophecy hidden in the Tree of Life and decided to go back to her headquarters, rest a little and try there. Of course, she cannot uproot the Tree and take it with her, so she made a drawing of the Tree on a piece of paper. On second thought, she made more identical drawings so as to have n in total (where n is the number of vertices of the Tree of Life) \xe2\x80\x93 who knows what might happen?Indeed, on her way back Heidi was ambushed by a group of zombies. While she managed to fend them off, they have damaged her drawings in a peculiar way: from the i-th copy, the vertex numbered i was removed, along with all adjacent edges. In each picture, the zombies have also erased all the vertex numbers and relabeled the remaining n\xe2\x80\x89-\xe2\x80\x891 vertices arbitrarily using numbers 1 to n (fortunately, each vertex still has a distinct number). What\'s more, the drawings have been arbitrarily shuffled/reordered.Now Heidi wants to recover the Tree of Life from her descriptions of all the drawings (as lists of edges)." 2700
690F1 "Tree of Life (easy)" NA "Heidi has finally found the mythical Tree of Life \xe2\x80\x93 a legendary combinatorial structure which is said to contain a prophecy crucially needed to defeat the undead armies.On the surface, the Tree of Life is just a regular undirected tree well-known from computer science. This means that it is a collection of n points (called vertices), some of which are connected using n\xe2\x80\x89-\xe2\x80\x891 line segments (edges) so that each pair of vertices is connected by a path (a sequence of one or more edges).To decipher the prophecy, Heidi needs to perform a number of steps. The first is counting the number of lifelines in the tree \xe2\x80\x93 these are paths of length 2, i.e., consisting of two edges. Help her!" 1300
690E2 "Photographs (II)" NA "Zombies seem to have become much more intelligent lately \xe2\x80\x93 a few have somehow wandered into the base through the automatic gate. Heidi has had to beef up security, and a new gate has been installed. Unfortunately, now the questions being asked are more complicated, and even humans have trouble answering them. Can you still program the robot army to do this reliably?The new questions are of the following form: a grayscale photograph has been divided into several horizontal pieces, which have been arbitrarily rearranged. The task is to assemble the original image back from these pieces (somewhat like in a jigsaw puzzle). To further delay the zombies, significant Gaussian-distributed noise has been added to the image." 2600
690E1 "Photographs (I)" NA "The Human-Cow Confederation (HC2), led by Heidi, has built a base where people and cows can hide, guarded from zombie attacks. The entrance to the base is protected by an automated gate which performs a kind of a Turing test: it shows the entering creature a photograph and asks them whether the top and bottom halves of this photograph have been swapped or not. A person (or even a cow) will have no problem answering such questions; on the other hand, a zombie would just randomly smash one of the two buttons.The creature is asked a series of such questions. If at least 75% of them are answered correctly, the gate is unlocked; otherwise, a side door opens, beneath which a huge fan is spinning...Heidi is now building a robot army to fight the zombies, and she wants the robots to also be able to enter the base. You are tasked with programming them to distinguish the images. The first two images from the test set. The first picture has been rearranged, but not the second." 1800
690D3 "The Wall (hard)" dp "So many wall designs to choose from! Even modulo 106\xe2\x80\x89+\xe2\x80\x893, it\'s an enormous number. Given that recently Heidi acquired an unlimited supply of bricks, her choices are endless! She really needs to do something to narrow them down.Heidi is quick to come up with criteria for a useful wall:  In a useful wall, at least one segment is wider than W bricks. This should give the zombies something to hit their heads against. Or,  in a useful wall, at least one column is higher than H bricks. This provides a lookout from which zombies can be spotted at a distance. This should rule out a fair amount of possibilities, right? Help Heidi compute the number of useless walls that do not confirm to either of these criteria. In other words, a wall is useless if every segment has width at most W and height at most H.Parameter C, the total width of the wall, has the same meaning as in the easy version. However, note that the number of bricks is now unlimited.Output the number of useless walls modulo 106\xe2\x80\x89+\xe2\x80\x893." 2100
690D2 "The Wall (medium)" combinatorics "Heidi the Cow is aghast: cracks in the northern Wall? Zombies gathering outside, forming groups, preparing their assault? This must not happen! Quickly, she fetches her HC2 (Handbook of Crazy Constructions) and looks for the right chapter:How to build a wall:  Take a set of bricks.  Select one of the possible wall designs. Computing the number of possible designs is left as an exercise to the reader.  Place bricks on top of each other, according to the chosen design. This seems easy enough. But Heidi is a Coding Cow, not a Constructing Cow. Her mind keeps coming back to point 2b. Despite the imminent danger of a zombie onslaught, she wonders just how many possible walls she could build with up to n bricks.A wall is a set of wall segments as defined in the easy version. How many different walls can be constructed such that the wall consists of at least 1 and at most n bricks? Two walls are different if there exist a column c and a row r such that one wall has a brick in this spot, and the other does not.Along with n, you will be given C, the width of the wall (as defined in the easy version). Return the number of different walls modulo 106\xe2\x80\x89+\xe2\x80\x893." 1800
690D1 "The Wall (easy)" NA """The zombies are lurking outside. Waiting. Moaning. And when they come...""""When they come?""""I hope the Wall is high enough.""Zombie attacks have hit the Wall, our line of defense in the North. Its protection is failing, and cracks are showing. In places, gaps have appeared, splitting the wall into multiple segments. We call on you for help. Go forth and explore the wall! Report how many disconnected segments there are.The wall is a two-dimensional structure made of bricks. Each brick is one unit wide and one unit high. Bricks are stacked on top of each other to form columns that are up to R bricks high. Each brick is placed either on the ground or directly on top of another brick. Consecutive non-empty columns form a wall segment. The entire wall, all the segments and empty columns in-between, is C columns wide." 1200
690C3 "Brain Network (hard)" trees "Breaking news from zombie neurology! It turns out that \xe2\x80\x93 contrary to previous beliefs \xe2\x80\x93 every zombie is born with a single brain, and only later it evolves into a complicated brain structure. In fact, whenever a zombie consumes a brain, a new brain appears in its nervous system and gets immediately connected to one of the already existing brains using a single brain connector. Researchers are now interested in monitoring the brain latency of a zombie. Your task is to write a program which, given a history of evolution of a zombie\'s nervous system, computes its brain latency at every stage." 2200
690C2 "Brain Network (medium)" "dfs and similar,graphs,trees" "Further research on zombie thought processes yielded interesting results. As we know from the previous problem, the nervous system of a zombie consists of n brains and m brain connectors joining some pairs of brains together. It was observed that the intellectual abilities of a zombie depend mainly on the topology of its nervous system. More precisely, we define the distance between two brains u and v (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89u,\xe2\x80\x89v\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) as the minimum number of brain connectors used when transmitting a thought between these two brains. The brain latency of a zombie is defined to be the maximum distance between any two of its brains. Researchers conjecture that the brain latency is the crucial parameter which determines how smart a given zombie is. Help them test this conjecture by writing a program to compute brain latencies of nervous systems.In this problem you may assume that any nervous system given in the input is valid, i.e., it satisfies conditions (1) and (2) from the easy version." 1500
690C1 "Brain Network (easy)" NA "One particularly well-known fact about zombies is that they move and think terribly slowly. While we still don\'t know why their movements are so sluggish, the problem of laggy thinking has been recently resolved. It turns out that the reason is not (as previously suspected) any kind of brain defect \xe2\x80\x93 it\'s the opposite! Independent researchers confirmed that the nervous system of a zombie is highly complicated \xe2\x80\x93 it consists of n brains (much like a cow has several stomachs). They are interconnected by brain connectors, which are veins capable of transmitting thoughts between brains. There are two important properties such a brain network should have to function properly:   It should be possible to exchange thoughts between any two pairs of brains (perhaps indirectly, through other brains).  There should be no redundant brain connectors, that is, removing any brain connector would make property 1 false. If both properties are satisfied, we say that the nervous system is valid. Unfortunately (?), if the system is not valid, the zombie stops thinking and becomes (even more) dead. Your task is to analyze a given nervous system of a zombie and find out whether it is valid." 1300
690B3 "Recover Polygon (hard)" "data structures" "Zombies have found out about the Zombie Contamination level checker and managed to damage it! Now detecting the shape of their main compound will be a real challenge for Heidi. As before, a lair can be represented as a strictly convex polygon on a lattice. Each vertex of the polygon occupies a point on the lattice. However, the damaged Zombie Contamination level checker can only tell, for each cell, whether the level of Zombie Contamination for that cell is in the set {1,\xe2\x80\x892,\xe2\x80\x893}. In other words, Heidi knows all the cells of the lattice for which the Contamination level is not 0 and not 4.Given this information, Heidi still wants to know the exact shape of the lair to rain destruction on the zombies. Help her!" 2600
690B2 "Recover Polygon (medium)" geometry "Now that Heidi has made sure her Zombie Contamination level checker works, it\'s time to strike! This time, the zombie lair is a strictly convex polygon on the lattice. Each vertex of the polygon occupies a point on the lattice. For each cell of the lattice, Heidi knows the level of Zombie Contamination \xe2\x80\x93 the number of corners of the cell that are inside or on the border of the lair.Given this information, Heidi wants to know the exact shape of the lair to rain destruction on the zombies. Help her!" 2600
690B1 "Recover Polygon (easy)" NA "The zombies are gathering in their secret lair! Heidi will strike hard to destroy them once and for all. But there is a little problem... Before she can strike, she needs to know where the lair is. And the intel she has is not very good.Heidi knows that the lair can be represented as a rectangle on a lattice, with sides parallel to the axes. Each vertex of the polygon occupies an integer point on the lattice. For each cell of the lattice, Heidi can check the level of Zombie Contamination. This level is an integer between 0 and 4, equal to the number of corners of the cell that are inside or on the border of the rectangle.As a test, Heidi wants to check that her Zombie Contamination level checker works. Given the output of the checker, Heidi wants to know whether it could have been produced by a single non-zero area rectangular-shaped lair (with axis-parallel sides)." 1700
690A3 "Collective Mindsets (hard)" NA "Heidi got one brain, thumbs up! But the evening isn\'t over yet and one more challenge awaits our dauntless agent: after dinner, at precisely midnight, the N attendees love to play a very risky game...Every zombie gets a number ni (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ni\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89N) written on his forehead. Although no zombie can see his own number, he can see the numbers written on the foreheads of all N\xe2\x80\x89-\xe2\x80\x891 fellows. Note that not all numbers have to be unique (they can even all be the same). From this point on, no more communication between zombies is allowed. Observation is the only key to success. When the cuckoo clock strikes midnight, all attendees have to simultaneously guess the number on their own forehead. If at least one of them guesses his number correctly, all zombies survive and go home happily. On the other hand, if not a single attendee manages to guess his number correctly, all of them are doomed to die!Zombies aren\'t very bright creatures though, and Heidi has to act fast if she does not want to jeopardize her life. She has one single option: by performing some quick surgery on the brain she managed to get from the chest, she has the ability to remotely reprogram the decision-making strategy of all attendees for their upcoming midnight game! Can you suggest a sound strategy to Heidi which, given the rules of the game, ensures that at least one attendee will guess his own number correctly, for any possible sequence of numbers on the foreheads?Given a zombie\'s rank R and the N\xe2\x80\x89-\xe2\x80\x891 numbers ni on the other attendees\' foreheads, your program will have to return the number that the zombie of rank R shall guess. Those answers define your strategy, and we will check if it is flawless or not." 2400
690A2 "Collective Mindsets (medium)" NA "Way to go! Heidi now knows how many brains there must be for her to get one. But throwing herself in the midst of a clutch of hungry zombies is quite a risky endeavor. Hence Heidi wonders: what is the smallest number of brains that must be in the chest for her to get out at all (possibly empty-handed, but alive)?The brain dinner night will evolve just as in the previous subtask: the same crowd is present, the N\xe2\x80\x89-\xe2\x80\x891 zombies have the exact same mindset as before and Heidi is to make the first proposal, which must be accepted by at least half of the attendees for her to survive." 2300
690A1 "Collective Mindsets (easy)" NA "Tonight is brain dinner night and all zombies will gather together to scarf down some delicious brains. The artful Heidi plans to crash the party, incognito, disguised as one of them. Her objective is to get away with at least one brain, so she can analyze the zombies\' mindset back home and gain a strategic advantage.They will be N guests tonight: N\xe2\x80\x89-\xe2\x80\x891 real zombies and a fake one, our Heidi. The living-dead love hierarchies as much as they love brains: each one has a unique rank in the range 1 to N\xe2\x80\x89-\xe2\x80\x891, and Heidi, who still appears slightly different from the others, is attributed the highest rank, N. Tonight there will be a chest with brains on display and every attendee sees how many there are. These will then be split among the attendees according to the following procedure:The zombie of the highest rank makes a suggestion on who gets how many brains (every brain is an indivisible entity). A vote follows. If at least half of the attendees accept the offer, the brains are shared in the suggested way and the feast begins. But if majority is not reached, then the highest-ranked zombie is killed, and the next zombie in hierarchy has to make a suggestion. If he is killed too, then the third highest-ranked makes one, etc. (It\'s enough to have exactly half of the votes \xe2\x80\x93 in case of a tie, the vote of the highest-ranked alive zombie counts twice, and he will of course vote in favor of his own suggestion in order to stay alive.)You should know that zombies are very greedy and sly, and they know this too \xe2\x80\x93 basically all zombie brains are alike. Consequently, a zombie will never accept an offer which is suboptimal for him. That is, if an offer is not strictly better than a potential later offer, he will vote against it. And make no mistake: while zombies may normally seem rather dull, tonight their intellects are perfect. Each zombie\'s priorities for tonight are, in descending order:   survive the event (they experienced death already once and know it is no fun),  get as many brains as possible. Heidi goes first and must make an offer which at least half of the attendees will accept, and which allocates at least one brain for Heidi herself.What is the smallest number of brains that have to be in the chest for this to be possible?" 1100
689E "Mike and Geometry Problem" "combinatorics,data structures,dp,geometry,implementation" "Mike wants to prepare for IMO but he doesn\'t know geometry, so his teacher gave him an interesting geometry problem. Let\'s define f([l,\xe2\x80\x89r])\xe2\x80\x89=\xe2\x80\x89r\xe2\x80\x89-\xe2\x80\x89l\xe2\x80\x89+\xe2\x80\x891 to be the number of integer points in the segment [l,\xe2\x80\x89r] with l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r (say that ). You are given two integers n and k and n closed intervals [li,\xe2\x80\x89ri] on OX axis and you have to find:  In other words, you should find the sum of the number of integer points in the intersection of any k of the segments. As the answer may be very large, output it modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897).Mike can\'t solve this problem so he needs your help. You will help him, won\'t you?" 2000
689D "Friends and Subsequences" "binary search,data structures" "Mike and !Mike are old childhood rivals, they are opposite in everything they do, except programming. Today they have a problem they cannot solve on their own, but together (with you) \xe2\x80\x94 who knows? Every one of them has an integer sequences a and b of length n. Being given a query of the form of pair of integers (l,\xe2\x80\x89r), Mike can instantly tell the value of  while !Mike can instantly tell the value of .Now suppose a robot (you!) asks them all possible different queries of pairs of integers (l,\xe2\x80\x89r) (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) (so he will make exactly n(n\xe2\x80\x89+\xe2\x80\x891)\xe2\x80\x89/\xe2\x80\x892 queries) and counts how many times their answers coincide, thus for how many pairs  is satisfied.How many occasions will the robot count?" 2100
689C "Mike and Chocolate Thieves" "binary search,combinatorics,math" "Bad news came to Mike\'s village, some thieves stole a bunch of chocolates from the local factory! Horrible! Aside from loving sweet things, thieves from this area are known to be very greedy. So after a thief takes his number of chocolates for himself, the next thief will take exactly k times more than the previous one. The value of k (k\xe2\x80\x89>\xe2\x80\x891) is a secret integer known only to them. It is also known that each thief\'s bag can carry at most n chocolates (if they intend to take more, the deal is cancelled) and that there were exactly four thieves involved. Sadly, only the thieves know the value of n, but rumours say that the numbers of ways they could have taken the chocolates (for a fixed n, but not fixed k) is m. Two ways are considered different if one of the thieves (they should be numbered in the order they take chocolates) took different number of chocolates in them.Mike want to track the thieves down, so he wants to know what their bags are and value of n will help him in that. Please find the smallest possible value of n or tell him that the rumors are false and there is no such n." 1700
689B "Mike and Shortcuts" "dfs and similar,graphs,greedy,shortest paths" "Recently, Mike was very busy with studying for exams and contests. Now he is going to chill a bit by doing some sight seeing in the city.City consists of n intersections numbered from 1 to n. Mike starts walking from his house located at the intersection number 1 and goes along some sequence of intersections. Walking from intersection number i to intersection j requires |i\xe2\x80\x89-\xe2\x80\x89j| units of energy. The total energy spent by Mike to visit a sequence of intersections p1\xe2\x80\x89=\xe2\x80\x891,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pk is equal to  units of energy.Of course, walking would be boring if there were no shortcuts. A shortcut is a special path that allows Mike walking from one intersection to another requiring only 1 unit of energy. There are exactly n shortcuts in Mike\'s city, the ith of them allows walking from intersection i to intersection ai (i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ai\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x891) (but not in the opposite direction), thus there is exactly one shortcut starting at each intersection. Formally, if Mike chooses a sequence p1\xe2\x80\x89=\xe2\x80\x891,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pk then for each 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89k satisfying pi\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89=\xe2\x80\x89api and api\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89pi Mike will spend only 1 unit of energy instead of |pi\xe2\x80\x89-\xe2\x80\x89pi\xe2\x80\x89+\xe2\x80\x891| walking from the intersection pi to intersection pi\xe2\x80\x89+\xe2\x80\x891. For example, if Mike chooses a sequence p1\xe2\x80\x89=\xe2\x80\x891,\xe2\x80\x89p2\xe2\x80\x89=\xe2\x80\x89ap1,\xe2\x80\x89p3\xe2\x80\x89=\xe2\x80\x89ap2,\xe2\x80\x89...,\xe2\x80\x89pk\xe2\x80\x89=\xe2\x80\x89apk\xe2\x80\x89-\xe2\x80\x891, he spends exactly k\xe2\x80\x89-\xe2\x80\x891 units of total energy walking around them.Before going on his adventure, Mike asks you to find the minimum amount of energy required to reach each of the intersections from his home. Formally, for each 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n Mike is interested in finding minimum possible total energy of some sequence p1\xe2\x80\x89=\xe2\x80\x891,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pk\xe2\x80\x89=\xe2\x80\x89i." 1600
689A "Mike and Cellphone" "brute force,constructive algorithms,implementation" "While swimming at the beach, Mike has accidentally dropped his cellphone into the water. There was no worry as he bought a cheap replacement phone with an old-fashioned keyboard. The keyboard has only ten digital equal-sized keys, located in the following way:  Together with his old phone, he lost all his contacts and now he can only remember the way his fingers moved when he put some number in. One can formally consider finger movements as a sequence of vectors connecting centers of keys pressed consecutively to put in a number. For example, the finger movements for number ""586"" are the same as finger movements for number ""253"":    Mike has already put in a number by his ""finger memory"" and started calling it, so he is now worrying, can he be sure that he is calling the correct number? In other words, is there any other number, that has the same finger movements?" 1400
688B "Lovely Palindromes" "constructive algorithms,math" "Pari has a friend who loves palindrome numbers. A palindrome number is a number that reads the same forward or backward. For example 12321, 100001 and 1 are palindrome numbers, while 112 and 1021 are not.Pari is trying to love them too, but only very special and gifted people can understand the beauty behind palindrome numbers. Pari loves integers with even length (i.e. the numbers with even number of digits), so she tries to see a lot of big palindrome numbers with even length (like a 2-digit 11 or 6-digit 122221), so maybe she could see something in them.Now Pari asks you to write a program that gets a huge integer n from the input and tells what is the n-th even-length positive palindrome number?" 1000
688A Opponents implementation "Arya has n opponents in the school. Each day he will fight with all opponents who are present this day. His opponents have some fighting plan that guarantees they will win, but implementing this plan requires presence of them all. That means if one day at least one of Arya\'s opponents is absent at the school, then Arya will beat all present opponents. Otherwise, if all opponents are present, then they will beat Arya.For each opponent Arya knows his schedule \xe2\x80\x94 whether or not he is going to present on each particular day. Tell him the maximum number of consecutive days that he will beat all present opponents.Note, that if some day there are no opponents present, Arya still considers he beats all the present opponents." 800
687E TOF "dfs and similar,graphs" "Today Pari gave Arya a cool graph problem. Arya wrote a non-optimal solution for it, because he believes in his ability to optimize non-optimal solutions. In addition to being non-optimal, his code was buggy and he tried a lot to optimize it, so the code also became dirty! He keeps getting Time Limit Exceeds and he is disappointed. Suddenly a bright idea came to his mind!Here is how his dirty code looks like:dfs(v){     set count[v] = count[v] + 1     if(count[v] < 1000)     {          foreach u in neighbors[v]          {               if(visited[u] is equal to false)               {                    dfs(u)               }               break          }     }     set visited[v] = true}main(){     input the digraph()     TOF()     foreach 1<=i<=n     {          set count[i] = 0 , visited[i] = false     }     foreach 1 <= v <= n     {          if(visited[v] is equal to false)          {               dfs(v)          }     }     ... // And do something cool and magical but we can\'t tell you what!}He asks you to write the TOF function in order to optimize the running time of the code with minimizing the number of calls of the dfs function. The input is a directed graph and in the TOF function you have to rearrange the edges of the graph in the list neighbors for each vertex. The number of calls of dfs function depends on the arrangement of neighbors of each vertex." 2900
687D "Dividing Kingdom II" "brute force,data structures,dsu,graphs,sortings" "Long time ago, there was a great kingdom and it was being ruled by The Great Arya and Pari The Great. These two had some problems about the numbers they like, so they decided to divide the great kingdom between themselves.The great kingdom consisted of n cities numbered from 1 to n and m bidirectional roads between these cities, numbered from 1 to m. The i-th road had length equal to wi. The Great Arya and Pari The Great were discussing about destructing some prefix (all road with numbers less than some x) and suffix (all roads with numbers greater than some x) of the roads so there will remain only the roads with numbers l,\xe2\x80\x89l\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89r\xe2\x80\x89-\xe2\x80\x891 and r.After that they will divide the great kingdom into two pieces (with each city belonging to exactly one piece) such that the hardness of the division is minimized. The hardness of a division is the maximum length of a road such that its both endpoints are in the same piece of the kingdom. In case there is no such road, the hardness of the division is considered to be equal to \xe2\x80\x89-\xe2\x80\x891.Historians found the map of the great kingdom, and they have q guesses about the l and r chosen by those great rulers. Given these data, for each guess li and ri print the minimum possible hardness of the division of the kingdom." 2500
687C "The Values You Can Make" dp "Pari wants to buy an expensive chocolate from Arya. She has n coins, the value of the i-th coin is ci. The price of the chocolate is k, so Pari will take a subset of her coins with sum equal to k and give it to Arya.Looking at her coins, a question came to her mind: after giving the coins to Arya, what values does Arya can make with them? She is jealous and she doesn\'t want Arya to make a lot of values. So she wants to know all the values x, such that Arya will be able to make x using some subset of coins with the sum k.Formally, Pari wants to know the values x such that there exists a subset of coins with the sum k such that some subset of this subset has the sum x, i.e. there is exists some way to pay for the chocolate, such that Arya will be able to make the sum x using these coins." 1900
687B "Remainders Game" "chinese remainder theorem,math,number theory" "Today Pari and Arya are playing a game called Remainders.Pari chooses two positive integer x and k, and tells Arya k but not x. Arya have to find the value . There are n ancient numbers c1,\xe2\x80\x89c2,\xe2\x80\x89...,\xe2\x80\x89cn and Pari has to tell Arya  if Arya wants. Given k and the ancient values, tell us if Arya has a winning strategy independent of value of x or not. Formally, is it true that Arya can understand the value  for any positive integer x?Note, that  means the remainder of x after dividing it by y." 1800
687A "NP-Hard Problem" "dfs and similar,graphs" "Recently, Pari and Arya did some research about NP-Hard problems and they found the minimum vertex cover problem very interesting.Suppose the graph G is given. Subset A of its vertices is called a vertex cover of this graph, if for each edge uv there is at least one endpoint of it in this set, i.e.  or  (or both).Pari and Arya have won a great undirected graph as an award in a team contest. Now they have to split it in two parts, but both of them want their parts of the graph to be a vertex cover.They have agreed to give you their graph and you need to find two disjoint subsets of its vertices A and B, such that both A and B are vertex cover or claim it\'s impossible. Each vertex should be given to no more than one of the friends (or you can even keep it for yourself)." 1500
686B "Little Robber Girl\'s Zoo" "constructive algorithms,implementation,sortings" "Little Robber Girl likes to scare animals in her zoo for fun. She decided to arrange the animals in a row in the order of non-decreasing height. However, the animals were so scared that they couldn\'t stay in the right places.The robber girl was angry at first, but then she decided to arrange the animals herself. She repeatedly names numbers l and r such that r\xe2\x80\x89-\xe2\x80\x89l\xe2\x80\x89+\xe2\x80\x891 is even. After that animals that occupy positions between l and r inclusively are rearranged as follows: the animal at position l swaps places with the animal at position l\xe2\x80\x89+\xe2\x80\x891, the animal l\xe2\x80\x89+\xe2\x80\x892 swaps with the animal l\xe2\x80\x89+\xe2\x80\x893, ..., finally, the animal at position r\xe2\x80\x89-\xe2\x80\x891 swaps with the animal r.Help the robber girl to arrange the animals in the order of non-decreasing height. You should name at most 20\xe2\x80\x89000 segments, since otherwise the robber girl will become bored and will start scaring the animals again." 1100
686A "Free Ice Cream" "constructive algorithms,implementation" "After their adventure with the magic mirror Kay and Gerda have returned home and sometimes give free ice cream to kids in the summer.At the start of the day they have x ice cream packs. Since the ice cream is free, people start standing in the queue before Kay and Gerda\'s house even in the night. Each person in the queue wants either to take several ice cream packs for himself and his friends or to give several ice cream packs to Kay and Gerda (carriers that bring ice cream have to stand in the same queue).If a carrier with d ice cream packs comes to the house, then Kay and Gerda take all his packs. If a child who wants to take d ice cream packs comes to the house, then Kay and Gerda will give him d packs if they have enough ice cream, otherwise the child will get no ice cream at all and will leave in distress.Kay wants to find the amount of ice cream they will have after all people will leave from the queue, and Gerda wants to find the number of distressed kids." 800
685E "Travelling Through the Snow Queen\'s Kingdom" "bitmasks,brute force,divide and conquer,graphs" "Gerda is travelling to the palace of the Snow Queen.The road network consists of n intersections and m bidirectional roads. Roads are numbered from 1 to m. Snow Queen put a powerful spell on the roads to change the weather conditions there. Now, if Gerda steps on the road i at the moment of time less or equal to i, she will leave the road exactly at the moment i. In case she steps on the road i at the moment of time greater than i, she stays there forever.Gerda starts at the moment of time l at the intersection number s and goes to the palace of the Snow Queen, located at the intersection number t. Moreover, she has to be there at the moment r (or earlier), before the arrival of the Queen.Given the description of the road network, determine for q queries li, ri, si and ti if it\'s possible for Gerda to get to the palace on time." 2800
685D "Kay and Eternity" "brute force,implementation,sortings" "Snow Queen told Kay to form a word ""eternity"" using pieces of ice. Kay is eager to deal with the task, because he will then become free, and Snow Queen will give him all the world and a pair of skates.Behind the palace of the Snow Queen there is an infinite field consisting of cells. There are n pieces of ice spread over the field, each piece occupying exactly one cell and no two pieces occupying the same cell. To estimate the difficulty of the task Kay looks at some squares of size k\xe2\x80\x89\xc3\x97\xe2\x80\x89k cells, with corners located at the corners of the cells and sides parallel to coordinate axis and counts the number of pieces of the ice inside them.This method gives an estimation of the difficulty of some part of the field. However, Kay also wants to estimate the total difficulty, so he came up with the following criteria: for each x (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) he wants to count the number of squares of size k\xe2\x80\x89\xc3\x97\xe2\x80\x89k, such that there are exactly x pieces of the ice inside.Please, help Kay estimate the difficulty of the task given by the Snow Queen." 2600
685C "Optimal Point" "binary search,math" "When the river brought Gerda to the house of the Old Lady who Knew Magic, this lady decided to make Gerda her daughter. She wants Gerda to forget about Kay, so she puts all the roses from the garden underground.Mole, who lives in this garden, now can watch the roses without going up to the surface. Typical mole is blind, but this mole was granted as special vision by the Old Lady. He can watch any underground objects on any distance, even through the obstacles and other objects. However, the quality of the picture depends on the Manhattan distance to object being observed.Mole wants to find an optimal point to watch roses, that is such point with integer coordinates that the maximum Manhattan distance to the rose is minimum possible.As usual, he asks you to help.Manhattan distance between points (x1,\xe2\x80\x89 y1,\xe2\x80\x89 z1) and (x2,\xe2\x80\x89 y2,\xe2\x80\x89 z2) is defined as |x1\xe2\x80\x89-\xe2\x80\x89x2|\xe2\x80\x89+\xe2\x80\x89|y1\xe2\x80\x89-\xe2\x80\x89y2|\xe2\x80\x89+\xe2\x80\x89|z1\xe2\x80\x89-\xe2\x80\x89z2|." 2900
685B "Kay and Snowflake" "data structures,dfs and similar,dp,trees" "After the piece of a devilish mirror hit the Kay\'s eye, he is no longer interested in the beauty of the roses. Now he likes to watch snowflakes.Once upon a time, he found a huge snowflake that has a form of the tree (connected acyclic graph) consisting of n nodes. The root of tree has index 1. Kay is very interested in the structure of this tree.After doing some research he formed q queries he is interested in. The i-th query asks to find a centroid of the subtree of the node vi. Your goal is to answer all queries.Subtree of a node is a part of tree consisting of this node and all it\'s descendants (direct or not). In other words, subtree of node v is formed by nodes u, such that node v is present on the path from u to root.Centroid of a tree (or a subtree) is a node, such that if we erase it from the tree, the maximum size of the connected component will be at least two times smaller than the size of the initial tree (or a subtree)." 1900
685A "Robbers\' watch" "brute force,combinatorics,dp,math" "Robbers, who attacked the Gerda\'s cab, are very successful in covering from the kingdom police. To make the goal of catching them even harder, they use their own watches.First, as they know that kingdom police is bad at math, robbers use the positional numeral system with base 7. Second, they divide one day in n hours, and each hour in m minutes. Personal watches of each robber are divided in two parts: first of them has the smallest possible number of places that is necessary to display any integer from 0 to n\xe2\x80\x89-\xe2\x80\x891, while the second has the smallest possible number of places that is necessary to display any integer from 0 to m\xe2\x80\x89-\xe2\x80\x891. Finally, if some value of hours or minutes can be displayed using less number of places in base 7 than this watches have, the required number of zeroes is added at the beginning of notation.Note that to display number 0 section of the watches is required to have at least one place.Little robber wants to know the number of moments of time (particular values of hours and minutes), such that all digits displayed on the watches are distinct. Help her calculate this number." 1700
683J "The Hero with Bombs" "*special problem" "In a new computer game you need to help the hero to get out of the maze, which is a rectangular field of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m. The hero is located in one of the cells of this field. He knows where the exit of the maze is, and he wants to reach it.In one move, the hero can either move to the next cell (i.e. the cell which has a common side with the current cell) if it is free, or plant a bomb on the cell where he is, or skip the move and do nothing. A planted bomb explodes after three moves, that is, after the hero makes 3 more actions but does not have time to make the fourth (all three types of moves described above are considered as actions).The explosion destroys the obstacles in all the cells which have at least one common point with this cell (i.e. in all the cells sharing with the bomb cell a corner or a side). The explosion must not hurt the cell with the exit or the cell with the hero. The hero can not go beyond the boundaries of the maze.Your task is to determine the sequence of hero\'s actions to reach the exit. Note that you haven\'t to minimize the length of the sequence. The only restriction \xe2\x80\x94 the length of the resulting sequence should not exceed 100,000 symbols." 3000
683I Loader "*special problem,graphs" "A loader works in a warehouse, which is a rectangular field with size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m. Some cells of this field are free, others are occupied by pillars on which the roof of the warehouse rests. There is a load in one of the free cells, and the loader in another. At any moment, the loader and the load can not be in the cells with columns, outside the warehouse or in the same cell.The loader can move to the adjacent cell (two cells are considered adjacent if they have a common side), or move the load. To move the load, the loader should reach the cell adjacent to the load and push the load. In this case the load advances to the next cell in the direction in which the loader pushes it and the loader ends up in the cell in which the load was.Your task is to determine a sequence of pushes and loader\'s movements after which the load will reach the given cell (it is guaranteed that this cell is free). The load is rather heavy, so you need to minimize first the number of pushes and second the number of loader\'s movements." 2500
683H "Exchange of Books" "*special problem" "n pupils, who love to read books, study at school. It is known that each student has exactly one best friend, and each pupil is the best friend of exactly one other pupil. Each of the pupils has exactly one interesting book.The pupils decided to share books with each other. Every day, all pupils give their own books to their best friends. Thus, every day each of the pupils has exactly one book.Your task is to use the list of the best friends and determine the exchange of books among pupils after k days. For simplicity, all students are numbered from 1 to n in all tests." 1900
683G "The Fraction" "*special problem" "Periodic decimal fraction is usually written as: [entire_part.non-periodic_part (period)]. Any simple fraction can be represented as a periodic decimal fraction and vice versa. For example, the decimal fraction 0.2(45) corresponds to a fraction 27\xe2\x80\x89/\xe2\x80\x89110. Your task is to convert the periodic fraction to a simple periodic fraction." 1900
683F "Reformat the String" "*special problem" "In this problem you are given a string s consisting of uppercase and lowercase Latin letters, spaces, dots and commas. Your task is to correct the formatting of this string by removing and inserting spaces, as well as changing the case of the letters.After formatting, the resulting string must meet the following requirements:  the string must not start with a space;  there should be exactly one space between any two consecutive words;  there should be a Latin letter immediately before a dot or a comma, and there should be a space immediately after a dot or a comma in the case that there is a word after that dot or comma, otherwise that dot or comma must be the last character in the string;  all letters must be lowercase, except all first letters in the first words of the sentences, they must be capitalized. The first word of a sentence is a word that is either the first word of the string or a word after a dot. It is guaranteed that there is at least one letter in the given string between any two punctuation marks (commas and dots are punctuation marks). There is at least one letter before the leftmost punctuation mark." 1800
683E "Hammer throwing" "*special problem" "n athletes take part in the hammer throw. Each of them has his own unique identifier \xe2\x80\x94 the integer from 1 to n (all athletes have distinct identifiers). After the draw, the order in which the athletes will throw the hammer has been determined (they will do it one by one).Unfortunately, a not very attentive judge lost the list with the order of athletes, but each of the athletes has remembered how many competitors with identifiers larger than his own will throw the hammer before him.Your task is to help the organizers as quickly as possible to restore the order of the athletes." 1800
683D "Chocolate Bar" "*special problem,math" "A chocolate bar has a rectangular shape and consists of n\xe2\x80\x89\xc3\x97\xe2\x80\x89m slices. In other words, a bar consists of n rows with m slices of chocolate in each row.Each slice of chocolate is known to weigh 1 gram. Your task is to determine for each of the q chocolate bars whether it is possible to obtain a piece weighing p grams by breaking the bar several (possibly zero) times. The final piece of the chocolate bar should be whole, and breaks are made along the line of slices\' section for the whole length of the current piece." 1400
683C "Symmetric Difference" "*special problem" "You are given two sets of numbers. Your task is to print all numbers from the sets, that both sets don\'t contain simultaneously." 1600
683B "The Teacher of Physical Education" "*special problem" "n pupils came to Physical Education lesson. We know the name and the height of each pupil. Your task is to help the teacher of Physical Education to line up all pupils in non-decreasing order of their heights." 1600
683A "The Check of the Point" "*special problem,geometry" "On the coordinate plane there is a square with sides parallel to the coordinate axes. The length of the square side is equal to a. The lower left corner of the square coincides with the point (0,\xe2\x80\x890) (the point of the origin). The upper right corner of the square has positive coordinates.You are given a point with coordinates (x, y). Your task is to determine whether this point is located strictly inside the square, on its side, or strictly outside the square." 1200
682E "Alyona and Triangles" "geometry,two pointers" "You are given n points with integer coordinates on the plane. Points are given in a way such that there is no triangle, formed by any three of these n points, which area exceeds S.Alyona tried to construct a triangle with integer coordinates, which contains all n points and which area doesn\'t exceed 4S, but, by obvious reason, had no success in that. Please help Alyona construct such triangle. Please note that vertices of resulting triangle are not necessarily chosen from n given points." 2600
682D "Alyona and Strings" dp,strings "After returned from forest, Alyona started reading a book. She noticed strings s and t, lengths of which are n and m respectively. As usual, reading bored Alyona and she decided to pay her attention to strings s and t, which she considered very similar.Alyona has her favourite positive integer k and because she is too small, k does not exceed 10. The girl wants now to choose k disjoint non-empty substrings of string s such that these strings appear as disjoint substrings of string t and in the same order as they do in string s. She is also interested in that their length is maximum possible among all variants.Formally, Alyona wants to find a sequence of k non-empty strings p1,\xe2\x80\x89p2,\xe2\x80\x89p3,\xe2\x80\x89...,\xe2\x80\x89pk satisfying following conditions:  s can be represented as concatenation a1p1a2p2... akpkak\xe2\x80\x89+\xe2\x80\x891, where a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89ak\xe2\x80\x89+\xe2\x80\x891 is a sequence of arbitrary strings (some of them may be possibly empty);  t can be represented as concatenation b1p1b2p2... bkpkbk\xe2\x80\x89+\xe2\x80\x891, where b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bk\xe2\x80\x89+\xe2\x80\x891 is a sequence of arbitrary strings (some of them may be possibly empty);  sum of the lengths of strings in sequence is maximum possible. Please help Alyona solve this complicated problem and find at least the sum of the lengths of the strings in a desired sequence.A substring of a string is a subsequence of consecutive characters of the string." 1900
682C "Alyona and the Tree" "dfs and similar,dp,graphs,trees" "Alyona decided to go on a diet and went to the forest to get some apples. There she unexpectedly found a magic rooted tree with root in the vertex 1, every vertex and every edge of which has a number written on.The girl noticed that some of the tree\'s vertices are sad, so she decided to play with them. Let\'s call vertex v sad if there is a vertex u in subtree of vertex v such that dist(v,\xe2\x80\x89u)\xe2\x80\x89>\xe2\x80\x89au, where au is the number written on vertex u, dist(v,\xe2\x80\x89u) is the sum of the numbers written on the edges on the path from v to u.Leaves of a tree are vertices connected to a single vertex by a single edge, but the root of a tree is a leaf if and only if the tree consists of a single vertex \xe2\x80\x94 root.Thus Alyona decided to remove some of tree leaves until there will be no any sad vertex left in the tree. What is the minimum number of leaves Alyona needs to remove?" 1600
682B "Alyona and Mex" sortings "Someone gave Alyona an array containing n positive integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. In one operation, Alyona can choose any element of the array and decrease it, i.e. replace with any positive integer that is smaller than the current one. Alyona can repeat this operation as many times as she wants. In particular, she may not apply any operation to the array at all.Formally, after applying some operations Alyona will get an array of n positive integers b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bn such that 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89bi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ai for every 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n. Your task is to determine the maximum possible value of mex of this array.Mex of an array in this problem is the minimum positive integer that doesn\'t appear in this array. For example, mex of the array containing 1, 3 and 4 is equal to 2, while mex of the array containing 2, 3 and 2 is equal to 1." 1200
682A "Alyona and Numbers" "constructive algorithms,math,number theory" "After finishing eating her bun, Alyona came up with two integers n and m. She decided to write down two columns of integers \xe2\x80\x94 the first column containing integers from 1 to n and the second containing integers from 1 to m. Now the girl wants to count how many pairs of integers she can choose, one from the first column and the other from the second column, such that their sum is divisible by 5.Formally, Alyona wants to count the number of pairs of integers (x,\xe2\x80\x89y) such that 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n, 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m and  equals 0.As usual, Alyona has some troubles and asks you to help." 1100
681E "Runaway to a Shadow" geometry,sortings "Dima is living in a dormitory, as well as some cockroaches.At the moment 0 Dima saw a cockroach running on a table and decided to kill it. Dima needs exactly T seconds for aiming, and after that he will precisely strike the cockroach and finish it.To survive the cockroach has to run into a shadow, cast by round plates standing on the table, in T seconds. Shadow casted by any of the plates has the shape of a circle. Shadow circles may intersect, nest or overlap arbitrarily.The cockroach uses the following strategy: first he equiprobably picks a direction to run towards and then runs towards it with the constant speed v. If at some moment t\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89T it reaches any shadow circle, it immediately stops in the shadow and thus will stay alive. Otherwise the cockroach is killed by the Dima\'s precise strike. Consider that the Dima\'s precise strike is instant.Determine the probability of that the cockroach will stay alive." 2500
681D "Gifts by the List" "constructive algorithms,dfs and similar,graphs,trees" "Sasha lives in a big happy family. At the Man\'s Day all the men of the family gather to celebrate it following their own traditions. There are n men in Sasha\'s family, so let\'s number them with integers from 1 to n.Each man has at most one father but may have arbitrary number of sons.Man number A is considered to be the ancestor of the man number B if at least one of the following conditions is satisfied:   A\xe2\x80\x89=\xe2\x80\x89B;  the man number A is the father of the man number B;  there is a man number C, such that the man number A is his ancestor and the man number C is the father of the man number B. Of course, if the man number A is an ancestor of the man number B and A\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89B, then the man number B is not an ancestor of the man number A.The tradition of the Sasha\'s family is to give gifts at the Man\'s Day. Because giving gifts in a normal way is boring, each year the following happens.  A list of candidates is prepared, containing some (possibly all) of the n men in some order.  Each of the n men decides to give a gift.  In order to choose a person to give a gift to, man A looks through the list and picks the first man B in the list, such that B is an ancestor of A and gives him a gift. Note that according to definition it may happen that a person gives a gift to himself.  If there is no ancestor of a person in the list, he becomes sad and leaves the celebration without giving a gift to anyone. This year you have decided to help in organizing celebration and asked each of the n men, who do they want to give presents to (this person is chosen only among ancestors). Are you able to make a list of candidates, such that all the wishes will be satisfied if they give gifts according to the process described above?" 2000
681C "Heap Operations" "constructive algorithms,data structures,greedy" "Petya has recently learned data structure named ""Binary heap"".The heap he is now operating with allows the following operations:   put the given number into the heap;  get the value of the minimum element in the heap;  extract the minimum element from the heap; Thus, at any moment of time the heap contains several integers (possibly none), some of them might be equal.In order to better learn this data structure Petya took an empty heap and applied some operations above to it. Also, he carefully wrote down all the operations and their results to his event log, following the format:   insert x \xe2\x80\x94 put the element with value x in the heap;  getMin x \xe2\x80\x94 the value of the minimum element contained in the heap was equal to x;  removeMin \xe2\x80\x94 the minimum element was extracted from the heap (only one instance, if there were many). All the operations were correct, i.e. there was at least one element in the heap each time getMin or removeMin operations were applied.While Petya was away for a lunch, his little brother Vova came to the room, took away some of the pages from Petya\'s log and used them to make paper boats.Now Vova is worried, if he made Petya\'s sequence of operations inconsistent. For example, if one apply operations one-by-one in the order they are written in the event log, results of getMin operations might differ from the results recorded by Petya, and some of getMin or removeMin operations may be incorrect, as the heap is empty at the moment they are applied.Now Vova wants to add some new operation records to the event log in order to make the resulting sequence of operations correct. That is, the result of each getMin operation is equal to the result in the record, and the heap is non-empty when getMin ad removeMin are applied. Vova wants to complete this as fast as possible, as the Petya may get back at any moment. He asks you to add the least possible number of operation records to the current log. Note that arbitrary number of operations may be added at the beginning, between any two other operations, or at the end of the log." 1600
681B "Economy Game" "brute force" "Kolya is developing an economy simulator game. His most favourite part of the development process is in-game testing. Once he was entertained by the testing so much, that he found out his game-coin score become equal to 0.Kolya remembers that at the beginning of the game his game-coin score was equal to n and that he have bought only some houses (for 1\xe2\x80\x89234\xe2\x80\x89567 game-coins each), cars (for 123\xe2\x80\x89456 game-coins each) and computers (for 1\xe2\x80\x89234 game-coins each).Kolya is now interested, whether he could have spent all of his initial n game-coins buying only houses, cars and computers or there is a bug in the game. Formally, is there a triple of non-negative integers a, b and c such that a\xe2\x80\x89\xc3\x97\xe2\x80\x891\xe2\x80\x89234\xe2\x80\x89567\xe2\x80\x89+\xe2\x80\x89b\xe2\x80\x89\xc3\x97\xe2\x80\x89123\xe2\x80\x89456\xe2\x80\x89+\xe2\x80\x89c\xe2\x80\x89\xc3\x97\xe2\x80\x891\xe2\x80\x89234\xe2\x80\x89=\xe2\x80\x89n?Please help Kolya answer this question." 1300
681A "A Good Contest" implementation "Codeforces user\' handle color depends on his rating \xe2\x80\x94 it is red if his rating is greater or equal to 2400; it is orange if his rating is less than 2400 but greater or equal to 2200, etc. Each time participant takes part in a rated contest, his rating is changed depending on his performance.Anton wants the color of his handle to become red. He considers his performance in the rated contest to be good if he outscored some participant, whose handle was colored red before the contest and his rating has increased after it.Anton has written a program that analyses contest results and determines whether he performed good or not. Are you able to do the same?" 800
680B "Bear and Finding Criminals" "constructive algorithms,implementation" "There are n cities in Bearland, numbered 1 through n. Cities are arranged in one long row. The distance between cities i and j is equal to |i\xe2\x80\x89-\xe2\x80\x89j|.Limak is a police officer. He lives in a city a. His job is to catch criminals. It\'s hard because he doesn\'t know in which cities criminals are. Though, he knows that there is at most one criminal in each city.Limak is going to use a BCD (Bear Criminal Detector). The BCD will tell Limak how many criminals there are for every distance from a city a. After that, Limak can catch a criminal in each city for which he is sure that there must be a criminal.You know in which cities criminals are. Count the number of criminals Limak will catch, after he uses the BCD." 1000
680A "Bear and Five Cards" "constructive algorithms,implementation" "A little bear Limak plays a game. He has five cards. There is one number written on each card. Each number is a positive integer.Limak can discard (throw out) some cards. His goal is to minimize the sum of numbers written on remaining (not discarded) cards.He is allowed to at most once discard two or three cards with the same number. Of course, he won\'t discard cards if it\'s impossible to choose two or three cards with the same number.Given five numbers written on cards, cay you find the minimum sum of numbers on remaining cards?" 800
679E "Bear and Bad Powers of 42" "data structures" "Limak, a bear, isn\'t good at handling queries. So, he asks you to do it.We say that powers of 42 (numbers 1,\xe2\x80\x8942,\xe2\x80\x891764,\xe2\x80\x89...) are bad. Other numbers are good.You are given a sequence of n good integers t1,\xe2\x80\x89t2,\xe2\x80\x89...,\xe2\x80\x89tn. Your task is to handle q queries of three types:  1 i \xe2\x80\x94 print ti in a separate line.  2 a b x \xe2\x80\x94 for  set ti to x. It\'s guaranteed that x is a good number.  3 a b x \xe2\x80\x94 for  increase ti by x. After this repeat the process while at least one ti is bad. You can note that after each query all ti are good." 3100
679D "Bear and Chase" "brute force,dfs and similar,graphs,implementation,math,probabilities" "Bearland has n cities, numbered 1 through n. There are m bidirectional roads. The i-th road connects two distinct cities ai and bi. No two roads connect the same pair of cities. It\'s possible to get from any city to any other city (using one or more roads).The distance between cities a and b is defined as the minimum number of roads used to travel between a and b.Limak is a grizzly bear. He is a criminal and your task is to catch him, or at least to try to catch him. You have only two days (today and tomorrow) and after that Limak is going to hide forever.Your main weapon is BCD (Bear Criminal Detector). Where you are in some city, you can use BCD and it tells you the distance between you and a city where Limak currently is. Unfortunately, BCD can be used only once a day.You don\'t know much about Limak\'s current location. You assume that he is in one of n cities, chosen uniformly at random (each city with probability ). You decided for the following plan:  Choose one city and use BCD there.   After using BCD you can try to catch Limak (but maybe it isn\'t a good idea). In this case you choose one city and check it. You win if Limak is there. Otherwise, Limak becomes more careful and you will never catch him (you loose).   Wait 24 hours to use BCD again. You know that Limak will change his location during that time. In detail, he will choose uniformly at random one of roads from his initial city, and he will use the chosen road, going to some other city.  Tomorrow, you will again choose one city and use BCD there.  Finally, you will try to catch Limak. You will choose one city and check it. You will win if Limak is there, and loose otherwise. Each time when you choose one of cities, you can choose any of n cities. Let\'s say it isn\'t a problem for you to quickly get somewhere.What is the probability of finding Limak, if you behave optimally?" 2900
679C "Bear and Square Grid" "dfs and similar,dsu,implementation" "You have a grid with n rows and n columns. Each cell is either empty (denoted by \'.\') or blocked (denoted by \'X\').Two empty cells are directly connected if they share a side. Two cells (r1,\xe2\x80\x89c1) (located in the row r1 and column c1) and (r2,\xe2\x80\x89c2) are connected if there exists a sequence of empty cells that starts with (r1,\xe2\x80\x89c1), finishes with (r2,\xe2\x80\x89c2), and any two consecutive cells in this sequence are directly connected. A connected component is a set of empty cells such that any two cells in the component are connected, and there is no cell in this set that is connected to some cell not in this set.Your friend Limak is a big grizzly bear. He is able to destroy any obstacles in some range. More precisely, you can choose a square of size k\xe2\x80\x89\xc3\x97\xe2\x80\x89k in the grid and Limak will transform all blocked cells there to empty ones. However, you can ask Limak to help only once.The chosen square must be completely inside the grid. It\'s possible that Limak won\'t change anything because all cells are empty anyway.You like big connected components. After Limak helps you, what is the maximum possible size of the biggest connected component in the grid?" 2400
679B "Bear and Tower of Cubes" "binary search,dp,greedy" "Limak is a little polar bear. He plays by building towers from blocks. Every block is a cube with positive integer length of side. Limak has infinitely many blocks of each side length.A block with side a has volume a3. A tower consisting of blocks with sides a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89ak has the total volume a13\xe2\x80\x89+\xe2\x80\x89a23\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89ak3.Limak is going to build a tower. First, he asks you to tell him a positive integer X \xe2\x80\x94 the required total volume of the tower. Then, Limak adds new blocks greedily, one by one. Each time he adds the biggest block such that the total volume doesn\'t exceed X.Limak asks you to choose X not greater than m. Also, he wants to maximize the number of blocks in the tower at the end (however, he still behaves greedily). Secondarily, he wants to maximize X.Can you help Limak? Find the maximum number of blocks his tower can have and the maximum X\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m that results this number of blocks." 2200
679A "Bear and Prime 100" "constructive algorithms,interactive,math" "This is an interactive problem. In the output section below you will see the information about flushing the output.Bear Limak thinks of some hidden number \xe2\x80\x94 an integer from interval [2,\xe2\x80\x89100]. Your task is to say if the hidden number is prime or composite.Integer x\xe2\x80\x89>\xe2\x80\x891 is called prime if it has exactly two distinct divisors, 1 and x. If integer x\xe2\x80\x89>\xe2\x80\x891 is not prime, it\'s called composite.You can ask up to 20 queries about divisors of the hidden number. In each query you should print an integer from interval [2,\xe2\x80\x89100]. The system will answer ""yes"" if your integer is a divisor of the hidden number. Otherwise, the answer will be ""no"".For example, if the hidden number is 14 then the system will answer ""yes"" only if you print 2, 7 or 14.When you are done asking queries, print ""prime"" or ""composite"" and terminate your program.You will get the Wrong Answer verdict if you ask more than 20 queries, or if you print an integer not from the range [2,\xe2\x80\x89100]. Also, you will get the Wrong Answer verdict if the printed answer isn\'t correct.You will get the Idleness Limit Exceeded verdict if you don\'t print anything (but you should) or if you forget about flushing the output (more info below)." 1400
678F "Lena and Queries" "data structures,divide and conquer,geometry" "Lena is a programmer. She got a task to solve at work.There is an empty set of pairs of integers and n queries to process. Each query is one of three types:  Add a pair (a,\xe2\x80\x89b) to the set.  Remove a pair added in the query number i. All queries are numbered with integers from 1 to n.  For a given integer q find the maximal value x\xc2\xb7q\xe2\x80\x89+\xe2\x80\x89y over all pairs (x,\xe2\x80\x89y) from the set. Help Lena to process the queries." 2500
678E "Another Sith Tournament" bitmasks,dp,math,probabilities "The rules of Sith Tournament are well known to everyone. n Sith take part in the Tournament. The Tournament starts with the random choice of two Sith who will fight in the first battle. As one of them loses, his place is taken by the next randomly chosen Sith who didn\'t fight before. Does it need to be said that each battle in the Sith Tournament ends with a death of one of opponents? The Tournament ends when the only Sith remains alive.Jedi Ivan accidentally appeared in the list of the participants in the Sith Tournament. However, his skills in the Light Side of the Force are so strong so he can influence the choice of participants either who start the Tournament or who take the loser\'s place after each battle. Of course, he won\'t miss his chance to take advantage of it. Help him to calculate the probability of his victory." 2200
678D "Iterated Linear Function" "math,number theory" "Consider a linear function f(x)\xe2\x80\x89=\xe2\x80\x89Ax\xe2\x80\x89+\xe2\x80\x89B. Let\'s define g(0)(x)\xe2\x80\x89=\xe2\x80\x89x and g(n)(x)\xe2\x80\x89=\xe2\x80\x89f(g(n\xe2\x80\x89-\xe2\x80\x891)(x)) for n\xe2\x80\x89>\xe2\x80\x890. For the given integer values A, B, n and x find the value of g(n)(x) modulo 109\xe2\x80\x89+\xe2\x80\x897." 1700
678C "Joty and Chocolate" "implementation,math,number theory" "Little Joty has got a task to do. She has a line of n tiles indexed from 1 to n. She has to paint them in a strange pattern.An unpainted tile should be painted Red if it\'s index is divisible by a and an unpainted tile should be painted Blue if it\'s index is divisible by b. So the tile with the number divisible by a and b can be either painted Red or Blue.After her painting is done, she will get p chocolates for each tile that is painted Red and q chocolates for each tile that is painted Blue.Note that she can paint tiles in any order she wants.Given the required information, find the maximum number of chocolates Joty can get." 1600
678B "The Same Calendar" implementation "The girl Taylor has a beautiful calendar for the year y. In the calendar all days are given with their days of week: Monday, Tuesday, Wednesday, Thursday, Friday, Saturday and Sunday.The calendar is so beautiful that she wants to know what is the next year after y when the calendar will be exactly the same. Help Taylor to find that year.Note that leap years has 366 days. The year is leap if it is divisible by 400 or it is divisible by 4, but not by 100 (https://en.wikipedia.org/wiki/Leap_year)." 1600
678A "Johny Likes Numbers" implementation,math "Johny likes numbers n and k very much. Now Johny wants to find the smallest integer x greater than n, so it is divisible by the number k." 800
677E "Vanya and Balloons" "binary search,brute force,dp,implementation" "Vanya plays a game of balloons on the field of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89n, where each cell contains a balloon with one of the values 0, 1, 2 or 3. The goal is to destroy a cross, such that the product of all values of balloons in the cross is maximum possible. There are two types of crosses: normal and rotated. For example:**o****o**ooooo**o****o**oro***o*o*o***o***o*o*o***oFormally, the cross is given by three integers r, c and d, such that d\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r,\xe2\x80\x89c\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x89d\xe2\x80\x89+\xe2\x80\x891. The normal cross consists of balloons located in cells (x,\xe2\x80\x89y) (where x stay for the number of the row and y for the number of the column), such that |x\xe2\x80\x89-\xe2\x80\x89r|\xc2\xb7|y\xe2\x80\x89-\xe2\x80\x89c|\xe2\x80\x89=\xe2\x80\x890 and |x\xe2\x80\x89-\xe2\x80\x89r|\xe2\x80\x89+\xe2\x80\x89|y\xe2\x80\x89-\xe2\x80\x89c|\xe2\x80\x89<\xe2\x80\x89d. Rotated cross consists of balloons located in cells (x,\xe2\x80\x89y), such that |x\xe2\x80\x89-\xe2\x80\x89r|\xe2\x80\x89=\xe2\x80\x89|y\xe2\x80\x89-\xe2\x80\x89c| and |x\xe2\x80\x89-\xe2\x80\x89r|\xe2\x80\x89<\xe2\x80\x89d.Vanya wants to know the maximum possible product of the values of balls forming one cross. As this value can be large, output it modulo 109\xe2\x80\x89+\xe2\x80\x897." 2300
677D "Vanya and Treasure" "data structures,dp,graphs,shortest paths" "Vanya is in the palace that can be represented as a grid n\xe2\x80\x89\xc3\x97\xe2\x80\x89m. Each room contains a single chest, an the room located in the i-th row and j-th columns contains the chest of type aij. Each chest of type x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89p\xe2\x80\x89-\xe2\x80\x891 contains a key that can open any chest of type x\xe2\x80\x89+\xe2\x80\x891, and all chests of type 1 are not locked. There is exactly one chest of type p and it contains a treasure.Vanya starts in cell (1,\xe2\x80\x891) (top left corner). What is the minimum total distance Vanya has to walk in order to get the treasure? Consider the distance between cell (r1,\xe2\x80\x89c1) (the cell in the row r1 and column c1) and (r2,\xe2\x80\x89c2) is equal to |r1\xe2\x80\x89-\xe2\x80\x89r2|\xe2\x80\x89+\xe2\x80\x89|c1\xe2\x80\x89-\xe2\x80\x89c2|." 2300
677C "Vanya and Label" bitmasks,combinatorics,implementation,strings "While walking down the street Vanya saw a label ""Hide&Seek"". Because he is a programmer, he used & as a bitwise AND for these two words represented as a integers in base 64 and got new word. Now Vanya thinks of some string s and wants to know the number of pairs of words of length |s| (length of s), such that their bitwise AND is equal to s. As this number can be large, output it modulo 109\xe2\x80\x89+\xe2\x80\x897.To represent the string as a number in numeral system with base 64 Vanya uses the following rules:  digits from \'0\' to \'9\' correspond to integers from 0 to 9;  letters from \'A\' to \'Z\' correspond to integers from 10 to 35;  letters from \'a\' to \'z\' correspond to integers from 36 to 61;  letter \'-\' correspond to integer 62;  letter \'_\' correspond to integer 63." 1500
677B "Vanya and Food Processor" implementation,math "Vanya smashes potato in a vertical food processor. At each moment of time the height of the potato in the processor doesn\'t exceed h and the processor smashes k centimeters of potato each second. If there are less than k centimeters remaining, than during this second processor smashes all the remaining potato.Vanya has n pieces of potato, the height of the i-th piece is equal to ai. He puts them in the food processor one by one starting from the piece number 1 and finishing with piece number n. Formally, each second the following happens:  If there is at least one piece of potato remaining, Vanya puts them in the processor one by one, until there is not enough space for the next piece.  Processor smashes k centimeters of potato (or just everything that is inside). Provided the information about the parameter of the food processor and the size of each potato in a row, compute how long will it take for all the potato to become smashed." 1400
677A "Vanya and Fence" implementation "Vanya and his friends are walking along the fence of height h and they do not want the guard to notice them. In order to achieve this the height of each of the friends should not exceed h. If the height of some person is greater than h he can bend down and then he surely won\'t be noticed by the guard. The height of the i-th person is equal to ai.Consider the width of the person walking as usual to be equal to 1, while the width of the bent person is equal to 2. Friends want to talk to each other while walking, so they would like to walk in a single row. What is the minimum width of the road, such that friends can walk in a row and remain unattended by the guard?" 800
676E "The Last Fight Between Human and AI" math "100 years have passed since the last victory of the man versus computer in Go. Technologies made a huge step forward and robots conquered the Earth! It\'s time for the final fight between human and robot that will decide the faith of the planet.The following game was chosen for the fights: initially there is a polynomial P(x)\xe2\x80\x89=\xe2\x80\x89anxn\xe2\x80\x89+\xe2\x80\x89an\xe2\x80\x89-\xe2\x80\x891xn\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89a1x\xe2\x80\x89+\xe2\x80\x89a0,\xe2\x80\x89 with yet undefined coefficients and the integer k. Players alternate their turns. At each turn, a player pick some index j, such that coefficient aj that stay near xj is not determined yet and sets it to any value (integer or real, positive or negative, 0 is also allowed). Computer moves first. The human will be declared the winner if and only if the resulting polynomial will be divisible by Q(x)\xe2\x80\x89=\xe2\x80\x89x\xe2\x80\x89-\xe2\x80\x89k.Polynomial P(x) is said to be divisible by polynomial Q(x) if there exists a representation P(x)\xe2\x80\x89=\xe2\x80\x89B(x)Q(x), where B(x) is also some polynomial.Some moves have been made already and now you wonder, is it true that human can guarantee the victory if he plays optimally?" 2400
676D "Theseus and labyrinth" "graphs,implementation,shortest paths" "Theseus has just arrived to Crete to fight Minotaur. He found a labyrinth that has a form of a rectangular field of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m and consists of blocks of size 1\xe2\x80\x89\xc3\x97\xe2\x80\x891.Each block of the labyrinth has a button that rotates all blocks 90 degrees clockwise. Each block rotates around its center and doesn\'t change its position in the labyrinth. Also, each block has some number of doors (possibly none). In one minute, Theseus can either push the button in order to rotate all the blocks 90 degrees clockwise or pass to the neighbouring block. Theseus can go from block A to some neighbouring block B only if block A has a door that leads to block B and block B has a door that leads to block A.Theseus found an entrance to labyrinth and is now located in block (xT,\xe2\x80\x89yT) \xe2\x80\x94 the block in the row xT and column yT. Theseus know that the Minotaur is hiding in block (xM,\xe2\x80\x89yM) and wants to know the minimum number of minutes required to get there.Theseus is a hero, not a programmer, so he asks you to help him." 2000
676C "Vasya and String" "binary search,dp,strings,two pointers" "High school student Vasya got a string of length n as a birthday present. This string consists of letters \'a\' and \'b\' only. Vasya denotes beauty of the string as the maximum length of a substring (consecutive subsequence) consisting of equal letters.Vasya can change no more than k characters of the original string. What is the maximum beauty of the string he can achieve?" 1500
676B "Pyramid of Glasses" implementation,math,math "Mary has just graduated from one well-known University and is now attending celebration party. Students like to dream of a beautiful life, so they used champagne glasses to construct a small pyramid. The height of the pyramid is n. The top level consists of only 1 glass, that stands on 2 glasses on the second level (counting from the top), then 3 glasses on the third level and so on.The bottom level consists of n glasses.Vlad has seen in the movies many times how the champagne beautifully flows from top levels to bottom ones, filling all the glasses simultaneously. So he took a bottle and started to pour it in the glass located at the top of the pyramid.Each second, Vlad pours to the top glass the amount of champagne equal to the size of exactly one glass. If the glass is already full, but there is some champagne flowing in it, then it pours over the edge of the glass and is equally distributed over two glasses standing under. If the overflowed glass is at the bottom level, then the champagne pours on the table. For the purpose of this problem we consider that champagne is distributed among pyramid glasses immediately. Vlad is interested in the number of completely full glasses if he stops pouring champagne in t seconds.Pictures below illustrate the pyramid consisting of three levels." 1500
676A "Nicholas and Permutation" "constructive algorithms,implementation" "Nicholas has an array a that contains n distinct integers from 1 to n. In other words, Nicholas has a permutation of size n.Nicholas want the minimum element (integer 1) and the maximum element (integer n) to be as far as possible from each other. He wants to perform exactly one swap in order to maximize the distance between the minimum and the maximum elements. The distance between two elements is considered to be equal to the absolute difference between their positions." 800
675E "Trains and Statistic" "data structures,dp,greedy" "Vasya commutes by train every day. There are n train stations in the city, and at the i-th station it\'s possible to buy only tickets to stations from i\xe2\x80\x89+\xe2\x80\x891 to ai inclusive. No tickets are sold at the last station.Let \xcf\x81i,\xe2\x80\x89j be the minimum number of tickets one needs to buy in order to get from stations i to station j. As Vasya is fond of different useless statistic he asks you to compute the sum of all values \xcf\x81i,\xe2\x80\x89j among all pairs 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n." 2300
675D "Tree Construction" "data structures,trees" "During the programming classes Vasya was assigned a difficult problem. However, he doesn\'t know how to code and was unable to find the solution in the Internet, so he asks you to help.You are given a sequence a, consisting of n distinct integers, that is used to construct the binary search tree. Below is the formal description of the construction process.  First element a1 becomes the root of the tree.  Elements a2,a3,\xe2\x80\xa6,an are added one by one. To add element ai one needs to traverse the tree starting from the root and using the following rules:   The pointer to the current node is set to the root.  If ai is greater than the value in the current node, then its right child becomes the current node. Otherwise, the left child of the current node becomes the new current node.  If at some point there is no required child, the new node is created, it is assigned value ai and becomes the corresponding child of the current node." 1800
675C "Money Transfers" "constructive algorithms,data structures,greedy,sortings" "There are n banks in the city where Vasya lives, they are located in a circle, such that any two banks are neighbouring if their indices differ by no more than 1. Also, bank 1 and bank n are neighbours if n\xe2\x80\x89>\xe2\x80\x891. No bank is a neighbour of itself.Vasya has an account in each bank. Its balance may be negative, meaning Vasya owes some money to this bank.There is only one type of operations available: transfer some amount of money from any bank to account in any neighbouring bank. There are no restrictions on the size of the sum being transferred or balance requirements to perform this operation.Vasya doesn\'t like to deal with large numbers, so he asks you to determine the minimum number of operations required to change the balance of each bank account to zero. It\'s guaranteed, that this is possible to achieve, that is, the total balance of Vasya in all banks is equal to zero." 2100
675B "Restoring Painting" "brute force,constructive algorithms,math" "Vasya works as a watchman in the gallery. Unfortunately, one of the most expensive paintings was stolen while he was on duty. He doesn\'t want to be fired, so he has to quickly restore the painting. He remembers some facts about it.  The painting is a square 3\xe2\x80\x89\xc3\x97\xe2\x80\x893, each cell contains a single integer from 1 to n, and different cells may contain either different or equal integers.  The sum of integers in each of four squares 2\xe2\x80\x89\xc3\x97\xe2\x80\x892 is equal to the sum of integers in the top left square 2\xe2\x80\x89\xc3\x97\xe2\x80\x892.  Four elements a, b, c and d are known and are located as shown on the picture below. Help Vasya find out the number of distinct squares the satisfy all the conditions above. Note, that this number may be equal to 0, meaning Vasya remembers something wrong.Two squares are considered to be different, if there exists a cell that contains two different integers in different squares." 1400
675A "Infinite Sequence" math "Vasya likes everything infinite. Now he is studying the properties of a sequence s, such that its first element is equal to a (s1\xe2\x80\x89=\xe2\x80\x89a), and the difference between any two neighbouring elements is equal to c (si\xe2\x80\x89-\xe2\x80\x89si\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89=\xe2\x80\x89c). In particular, Vasya wonders if his favourite integer b appears in this sequence, that is, there exists a positive integer i, such that si\xe2\x80\x89=\xe2\x80\x89b. Of course, you are the person he asks for a help." 1100
673B "Problems for Round" greedy,implementation "There are n problems prepared for the next Codeforces round. They are arranged in ascending order by their difficulty, and no two problems have the same difficulty. Moreover, there are m pairs of similar problems. Authors want to split problems between two division according to the following rules:   Problemset of each division should be non-empty.  Each problem should be used in exactly one division (yes, it is unusual requirement).  Each problem used in division 1 should be harder than any problem used in division 2.  If two problems are similar, they should be used in different divisions. Your goal is count the number of ways to split problem between two divisions and satisfy all the rules. Two ways to split problems are considered to be different if there is at least one problem that belongs to division 1 in one of them and to division 2 in the other.Note, that the relation of similarity is not transitive. That is, if problem i is similar to problem j and problem j is similar to problem k, it doesn\'t follow that i is similar to k." 1300
673A "Bear and Game" implementation "Bear Limak likes watching sports on TV. He is going to watch a game today. The game lasts 90 minutes and there are no breaks.Each minute can be either interesting or boring. If 15 consecutive minutes are boring then Limak immediately turns TV off.You know that there will be n interesting minutes t1,\xe2\x80\x89t2,\xe2\x80\x89...,\xe2\x80\x89tn. Your task is to calculate for how many minutes Limak will watch the game." 800
672B "Different is Good" "constructive algorithms,implementation,strings" "A wise man told Kerem ""Different is good"" once, so Kerem wants all things in his life to be different. Kerem recently got a string s consisting of lowercase English letters. Since Kerem likes it when things are different, he wants all substrings of his string s to be distinct. Substring is a string formed by some number of consecutive characters of the string. For example, string ""aba"" has substrings """" (empty substring), ""a"", ""b"", ""a"", ""ab"", ""ba"", ""aba"".If string s has at least two equal substrings then Kerem will change characters at some positions to some other lowercase English letters. Changing characters is a very tiring job, so Kerem want to perform as few changes as possible.Your task is to find the minimum number of changes needed to make all the substrings of the given string distinct, or determine that it is impossible." 1000
672A "Summer Camp" implementation "Every year, hundreds of people come to summer camps, they learn new algorithms and solve hard problems.This is your first year at summer camp, and you are asked to solve the following problem. All integers starting with 1 are written in one line. The prefix of these line is ""123456789101112131415..."". Your task is to print the n-th digit of this string (digits are numbered starting with 1." 800
671E "Organizing a Race" "data structures,greedy" "Kekoland is a country with n beautiful cities numbered from left to right and connected by n\xe2\x80\x89-\xe2\x80\x891 roads. The i-th road connects cities i and i\xe2\x80\x89+\xe2\x80\x891 and length of this road is wi kilometers. When you drive in Kekoland, each time you arrive in city i by car you immediately receive gi liters of gas. There is no other way to get gas in Kekoland.You were hired by the Kekoland president Keko to organize the most beautiful race Kekoland has ever seen. Let race be between cities l and r (l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r). Race will consist of two stages. On the first stage cars will go from city l to city r. After completing first stage, next day second stage will be held, now racers will go from r to l with their cars. Of course, as it is a race, racers drive directly from start city to finish city. It means that at the first stage they will go only right, and at the second stage they go only left. Beauty of the race between l and r is equal to r\xe2\x80\x89-\xe2\x80\x89l\xe2\x80\x89+\xe2\x80\x891 since racers will see r\xe2\x80\x89-\xe2\x80\x89l\xe2\x80\x89+\xe2\x80\x891 beautiful cities of Kekoland. Cars have infinite tank so racers will take all the gas given to them.At the beginning of each stage racers start the race with empty tank (0 liters of gasoline). They will immediately take their gasoline in start cities (l for the first stage and r for the second stage) right after the race starts. It may not be possible to organize a race between l and r if cars will run out of gas before they reach finish.You have k presents. Each time you give a present to city i its value gi increases by 1. You may distribute presents among cities in any way (also give many presents to one city, each time increasing gi by 1). What is the most beautiful race you can organize?Each car consumes 1 liter of gas per one kilometer." 3300
671D "Roads in Yusland" "data structures,dp,greedy" "Mayor of Yusland just won the lottery and decided to spent money on something good for town. For example, repair all the roads in the town.Yusland consists of n intersections connected by n\xe2\x80\x89-\xe2\x80\x891 bidirectional roads. One can travel from any intersection to any other intersection using only these roads.There is only one road repairing company in town, named ""RC company"". Company\'s center is located at the intersection 1. RC company doesn\'t repair roads you tell them. Instead, they have workers at some intersections, who can repair only some specific paths. The i-th worker can be paid ci coins and then he repairs all roads on a path from ui to some vi that lies on the path from ui to intersection 1. Mayor asks you to choose the cheapest way to hire some subset of workers in order to repair all the roads in Yusland. It\'s allowed that some roads will be repaired more than once.If it\'s impossible to repair all roads print \xe2\x80\x89-\xe2\x80\x891." 2900
671C "Ultimate Weirdness of an Array" "data structures,number theory" "Yasin has an array a containing n integers. Yasin is a 5 year old, so he loves ultimate weird things.Yasin denotes weirdness of an array as maximum gcd(ai,\xe2\x80\x89\xe2\x80\x89aj) value among all 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n. For n\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x891 weirdness is equal to 0, gcd(x,\xe2\x80\x89\xe2\x80\x89y) is the greatest common divisor of integers x and y.He also defines the ultimate weirdness of an array. Ultimate weirdness is  where f(i,\xe2\x80\x89\xe2\x80\x89j) is weirdness of the new array a obtained by removing all elements between i and j inclusive, so new array is [a1... ai\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89aj\xe2\x80\x89+\xe2\x80\x891... an].Since 5 year old boys can\'t code, Yasin asks for your help to find the value of ultimate weirdness of the given array a!" 2800
671B "Robin Hood" "binary search,greedy" "We all know the impressive story of Robin Hood. Robin Hood uses his archery skills and his wits to steal the money from rich, and return it to the poor.There are n citizens in Kekoland, each person has ci coins. Each day, Robin Hood will take exactly 1 coin from the richest person in the city and he will give it to the poorest person (poorest person right after taking richest\'s 1 coin). In case the choice is not unique, he will select one among them at random. Sadly, Robin Hood is old and want to retire in k days. He decided to spend these last days with helping poor people. After taking his money are taken by Robin Hood richest person may become poorest person as well, and it might even happen that Robin Hood will give his money back. For example if all people have same number of coins, then next day they will have same number of coins too. Your task is to find the difference between richest and poorest persons wealth after k days. Note that the choosing at random among richest and poorest doesn\'t affect the answer." 2000
671A "Recycling Bottles" dp,geometry,greedy,implementation "It was recycling day in Kekoland. To celebrate it Adil and Bera went to Central Perk where they can take bottles from the ground and put them into a recycling bin.We can think Central Perk as coordinate plane. There are n bottles on the ground, the i-th bottle is located at position (xi,\xe2\x80\x89yi). Both Adil and Bera can carry only one bottle at once each. For both Adil and Bera the process looks as follows:   Choose to stop or to continue to collect bottles.  If the choice was to continue then choose some bottle and walk towards it.  Pick this bottle and walk to the recycling bin.  Go to step 1. Adil and Bera may move independently. They are allowed to pick bottles simultaneously, all bottles may be picked by any of the two, it\'s allowed that one of them stays still while the other one continues to pick bottles.They want to organize the process such that the total distance they walk (the sum of distance walked by Adil and distance walked by Bera) is minimum possible. Of course, at the end all bottles should lie in the recycling bin." 1800
670F "Restore a Number" "brute force,constructive algorithms,strings" "Vasya decided to pass a very large integer n to Kate. First, he wrote that number as a string, then he appended to the right integer k \xe2\x80\x94 the number of digits in n. Magically, all the numbers were shuffled in arbitrary order while this note was passed to Kate. The only thing that Vasya remembers, is a non-empty substring of n (a substring of n is a sequence of consecutive digits of the number n).Vasya knows that there may be more than one way to restore the number n. Your task is to find the smallest possible initial integer n. Note that decimal representation of number n contained no leading zeroes, except the case the integer n was equal to zero itself (in this case a single digit 0 was used)." 2300
670E "Correct Bracket Sequence Editor" "data structures,dsu,strings" "Recently Polycarp started to develop a text editor that works only with correct bracket sequences (abbreviated as CBS). Note that a bracket sequence is correct if it is possible to get a correct mathematical expression by adding ""+""-s and ""1""-s to it. For example, sequences ""(())()"", ""()"" and ""(()(()))"" are correct, while "")("", ""(()"" and ""(()))("" are not. Each bracket in CBS has a pair. For example, in ""(()(()))"":  1st bracket is paired with 8th,  2d bracket is paired with 3d,  3d bracket is paired with 2d,  4th bracket is paired with 7th,  5th bracket is paired with 6th,  6th bracket is paired with 5th,  7th bracket is paired with 4th,  8th bracket is paired with 1st. Polycarp\'s editor currently supports only three operations during the use of CBS. The cursor in the editor takes the whole position of one of the brackets (not the position between the brackets!). There are three operations being supported:  \xc2\xabL\xc2\xbb \xe2\x80\x94 move the cursor one position to the left,  \xc2\xabR\xc2\xbb \xe2\x80\x94 move the cursor one position to the right,  \xc2\xabD\xc2\xbb \xe2\x80\x94 delete the bracket in which the cursor is located, delete the bracket it\'s paired to and all brackets between them (that is, delete a substring between the bracket in which the cursor is located and the one it\'s paired to). After the operation ""D"" the cursor moves to the nearest bracket to the right (of course, among the non-deleted). If there is no such bracket (that is, the suffix of the CBS was deleted), then the cursor moves to the nearest bracket to the left (of course, among the non-deleted). There are pictures illustrated several usages of operation ""D"" below.  All incorrect operations (shift cursor over the end of CBS, delete the whole CBS, etc.) are not supported by Polycarp\'s editor.Polycarp is very proud of his development, can you implement the functionality of his editor?" 1700
670D2 "Magic Powder - 2" "binary search,implementation" "The term of this problem is the same as the previous one, the only exception \xe2\x80\x94 increased restrictions." 1500
670D1 "Magic Powder - 1" "binary search,brute force,implementation" "This problem is given in two versions that differ only by constraints. If you can solve this problem in large constraints, then you can just write a single solution to the both versions. If you find the problem too difficult in large constraints, you can write solution to the simplified version only.Waking up in the morning, Apollinaria decided to bake cookies. To bake one cookie, she needs n ingredients, and for each ingredient she knows the value ai \xe2\x80\x94 how many grams of this ingredient one needs to bake a cookie. To prepare one cookie Apollinaria needs to use all n ingredients.Apollinaria has bi gram of the i-th ingredient. Also she has k grams of a magic powder. Each gram of magic powder can be turned to exactly 1 gram of any of the n ingredients and can be used for baking cookies.Your task is to determine the maximum number of cookies, which Apollinaria is able to bake using the ingredients that she has and the magic powder." 1400
670C Cinema implementation,sortings "Moscow is hosting a major international conference, which is attended by n scientists from different countries. Each of the scientists knows exactly one language. For convenience, we enumerate all languages of the world with integers from 1 to 109.In the evening after the conference, all n scientists decided to go to the cinema. There are m movies in the cinema they came to. Each of the movies is characterized by two distinct numbers \xe2\x80\x94 the index of audio language and the index of subtitles language. The scientist, who came to the movie, will be very pleased if he knows the audio language of the movie, will be almost satisfied if he knows the language of subtitles and will be not satisfied if he does not know neither one nor the other (note that the audio language and the subtitles language for each movie are always different). Scientists decided to go together to the same movie. You have to help them choose the movie, such that the number of very pleased scientists is maximum possible. If there are several such movies, select among them one that will maximize the number of almost satisfied scientists." 1300
670B "Game of Robots" implementation "In late autumn evening n robots gathered in the cheerful company of friends. Each robot has a unique identifier \xe2\x80\x94 an integer from 1 to 109.At some moment, robots decided to play the game ""Snowball"". Below there are the rules of this game. First, all robots stand in a row. Then the first robot says his identifier. After that the second robot says the identifier of the first robot and then says his own identifier. Then the third robot says the identifier of the first robot, then says the identifier of the second robot and after that says his own. This process continues from left to right until the n-th robot says his identifier.Your task is to determine the k-th identifier to be pronounced." 1000
670A Holidays "brute force,constructive algorithms,greedy,math" "On the planet Mars a year lasts exactly n days (there are no leap years on Mars). But Martians have the same weeks as earthlings \xe2\x80\x94 5 work days and then 2 days off. Your task is to determine the minimum possible and the maximum possible number of days off per year on Mars." 900
669A "Little Artem and Presents" math "Little Artem got n stones on his birthday and now wants to give some of them to Masha. He knows that Masha cares more about the fact of receiving the present, rather than the value of that present, so he wants to give her stones as many times as possible. However, Masha remembers the last present she received, so Artem can\'t give her the same number of stones twice in a row. For example, he can give her 3 stones, then 1 stone, then again 3 stones, but he can\'t give her 3 stones and then again 3 stones right after that.How many times can Artem give presents to Masha?" 800
667B "Coat of Anticubism" "constructive algorithms,geometry" "As some of you know, cubism is a trend in art, where the problem of constructing volumetrical shape on a plane with a combination of three-dimensional geometric shapes comes to the fore. A famous sculptor Cicasso, whose self-portrait you can contemplate, hates cubism. He is more impressed by the idea to transmit two-dimensional objects through three-dimensional objects by using his magnificent sculptures. And his new project is connected with this. Cicasso wants to make a coat for the haters of anticubism. To do this, he wants to create a sculpture depicting a well-known geometric primitive \xe2\x80\x94 convex polygon.Cicasso prepared for this a few blanks, which are rods with integer lengths, and now he wants to bring them together. The i-th rod is a segment of length li.The sculptor plans to make a convex polygon with a nonzero area, using all rods he has as its sides. Each rod should be used as a side to its full length. It is forbidden to cut, break or bend rods. However, two sides may form a straight angle .Cicasso knows that it is impossible to make a convex polygon with a nonzero area out of the rods with the lengths which he had chosen. Cicasso does not want to leave the unused rods, so the sculptor decides to make another rod-blank with an integer length so that his problem is solvable. Of course, he wants to make it as short as possible, because the materials are expensive, and it is improper deed to spend money for nothing. Help sculptor!" 1100
667A "Pouring Rain" geometry,math "A lot of people in Berland hates rain, but you do not. Rain pacifies, puts your thoughts in order. By these years you have developed a good tradition \xe2\x80\x94 when it rains, you go on the street and stay silent for a moment, contemplate all around you, enjoy freshness, think about big deeds you have to do. Today everything had changed quietly. You went on the street with a cup contained water, your favorite drink. In a moment when you were drinking a water you noticed that the process became quite long: the cup still contained water because of rain. You decided to make a formal model of what was happening and to find if it was possible to drink all water in that situation. Thus, your cup is a cylinder with diameter equals d centimeters. Initial level of water in cup equals h centimeters from the bottom.   You drink a water with a speed equals v milliliters per second. But rain goes with such speed that if you do not drink a water from the cup, the level of water increases on e centimeters per second. The process of drinking water from the cup and the addition of rain to the cup goes evenly and continuously. Find the time needed to make the cup empty or find that it will never happen. It is guaranteed that if it is possible to drink all water, it will happen not later than after 104 seconds.Note one milliliter equals to one cubic centimeter." 1100
666E "Forensic Examination" "data structures,string suffix structures" "The country of Reberland is the archenemy of Berland. Recently the authorities of Berland arrested a Reberlandian spy who tried to bring the leaflets intended for agitational propaganda to Berland illegally . The most leaflets contain substrings of the Absolutely Inadmissible Swearword and maybe even the whole word.Berland legal system uses the difficult algorithm in order to determine the guilt of the spy. The main part of this algorithm is the following procedure.All the m leaflets that are brought by the spy are numbered from 1 to m. After that it\'s needed to get the answer to q queries of the following kind: ""In which leaflet in the segment of numbers [l,\xe2\x80\x89r] the substring of the Absolutely Inadmissible Swearword [pl,\xe2\x80\x89pr] occurs more often?"".The expert wants you to automate that procedure because this time texts of leaflets are too long. Help him!" 3100
666D "Chain Reaction" "brute force,geometry" "Group of Berland scientists, with whom you have a close business relationship, makes a research in the area of peaceful nuclear energy. In particular, they found that a group of four nanobots, placed on a surface of a plate, can run a powerful chain reaction under certain conditions. To be precise, researchers introduced a rectangular Cartesian coordinate system on a flat plate and selected four distinct points with integer coordinates where bots will be placed initially. Next each bot will be assigned with one of the four directions (up, down, left or right) parallel to the coordinate axes. After that, each bot is shifted by an integer distance (which may be different for different bots) along its direction. The chain reaction starts, if the bots are in the corners of a square with positive area with sides parallel to the coordinate axes. Each corner of the square must contain one nanobot. This reaction will be stronger, if bots spend less time to move. We can assume that bots move with unit speed. In other words, the lesser is the maximum length traveled by bot, the stronger is reaction.Scientists have prepared a set of plates and selected starting position for the bots for each plate. Now they ask you to assign the direction for each bot to move after landing such that the maximum length traveled by bot is as small as possible." 3000
666C Codeword combinatorics,strings "The famous sculptor Cicasso is a Reberlandian spy!These is breaking news in Berlandian papers today. And now the sculptor is hiding. This time you give the shelter to the maestro. You have a protected bunker and you provide it to your friend. You set the security system in such way that only you can open the bunker. To open it one should solve the problem which is hard for others but is simple for you.Every day the bunker generates a codeword s. Every time someone wants to enter the bunker, integer n appears on the screen. As the answer one should enter another integer \xe2\x80\x94 the residue modulo 109\xe2\x80\x89+\xe2\x80\x897 of the number of strings of length n that consist only of lowercase English letters and contain the string s as the subsequence.The subsequence of string a is a string b that can be derived from the string a by removing some symbols from it (maybe none or all of them). In particular any string is the subsequence of itself. For example, the string ""cfo"" is the subsequence of the string ""codeforces"".You haven\'t implemented the algorithm that calculates the correct answers yet and you should do that ASAP." 2500
666B "World Tour" "graphs,shortest paths" "A famous sculptor Cicasso goes to a world tour!Well, it is not actually a world-wide. But not everyone should have the opportunity to see works of sculptor, shouldn\'t he? Otherwise there will be no any exclusivity. So Cicasso will entirely hold the world tour in his native country \xe2\x80\x94 Berland.Cicasso is very devoted to his work and he wants to be distracted as little as possible. Therefore he will visit only four cities. These cities will be different, so no one could think that he has ""favourites"". Of course, to save money, he will chose the shortest paths between these cities. But as you have probably guessed, Cicasso is a weird person. Although he doesn\'t like to organize exhibitions, he likes to travel around the country and enjoy its scenery. So he wants the total distance which he will travel to be as large as possible. However, the sculptor is bad in planning, so he asks you for help. There are n cities and m one-way roads in Berland. You have to choose four different cities, which Cicasso will visit and also determine the order in which he will visit them. So that the total distance he will travel, if he visits cities in your order, starting from the first city in your list, and ending in the last, choosing each time the shortest route between a pair of cities \xe2\x80\x94 will be the largest. Note that intermediate routes may pass through the cities, which are assigned to the tour, as well as pass twice through the same city. For example, the tour can look like that: . Four cities in the order of visiting marked as overlines: [1,\xe2\x80\x895,\xe2\x80\x892,\xe2\x80\x894].Note that Berland is a high-tech country. So using nanotechnologies all roads were altered so that they have the same length. For the same reason moving using regular cars is not very popular in the country, and it can happen that there are such pairs of cities, one of which generally can not be reached by car from the other one. However, Cicasso is very conservative and cannot travel without the car. Choose cities so that the sculptor can make the tour using only the automobile. It is guaranteed that it is always possible to do." 2000
666A "Reberland Linguistics" dp,implementation,strings "First-rate specialists graduate from Berland State Institute of Peace and Friendship. You are one of the most talented students in this university. The education is not easy because you need to have fundamental knowledge in different areas, which sometimes are not related to each other. For example, you should know linguistics very well. You learn a structure of Reberland language as foreign language. In this language words are constructed according to the following rules. First you need to choose the ""root"" of the word \xe2\x80\x94 some string which has more than 4 letters. Then several strings with the length 2 or 3 symbols are appended to this word. The only restriction \xe2\x80\x94  it is not allowed to append the same string twice in a row. All these strings are considered to be suffixes of the word (this time we use word ""suffix"" to describe a morpheme but not the few last characters of the string as you may used to). Here is one exercise that you have found in your task list. You are given the word s. Find all distinct strings with the length 2 or 3, which can be suffixes of this word according to the word constructing rules in Reberland language. Two strings are considered distinct if they have different length or there is a position in which corresponding characters do not match. Let\'s look at the example: the word abacabaca is given. This word can be obtained in the following ways: , where the root of the word is overlined, and suffixes are marked by ""corners"". Thus, the set of possible suffixes for this word is {aca,\xe2\x80\x89ba,\xe2\x80\x89ca}." 1800
665F "Four Divisors" "data structures,dp,math,number theory,sortings,two pointers" "If an integer a is divisible by another integer b, then b is called the divisor of a.For example: 12 has positive 6 divisors. They are 1, 2, 3, 4, 6 and 12.Let\xe2\x80\x99s define a function D(n) \xe2\x80\x94 number of integers between 1 and n (inclusive) which has exactly four positive divisors.Between 1 and 10 only the integers 6, 8 and 10 has exactly four positive divisors. So, D(10)\xe2\x80\x89=\xe2\x80\x893.You are given an integer n. You have to calculate D(n)." 2400
665E "Beautiful Subarrays" "data structures,divide and conquer,strings,trees" "One day, ZS the Coder wrote down an array of integers a\xe2\x80\x89with elements a1,\xe2\x80\x89\xe2\x80\x89a2,\xe2\x80\x89\xe2\x80\x89...,\xe2\x80\x89\xe2\x80\x89an.A subarray of the array a is a sequence al,\xe2\x80\x89\xe2\x80\x89al\xe2\x80\x89\xe2\x80\x89+\xe2\x80\x89\xe2\x80\x891,\xe2\x80\x89\xe2\x80\x89...,\xe2\x80\x89\xe2\x80\x89ar for some integers (l,\xe2\x80\x89\xe2\x80\x89r) such that 1\xe2\x80\x89\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89\xe2\x80\x89l\xe2\x80\x89\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89\xe2\x80\x89r\xe2\x80\x89\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89\xe2\x80\x89n. ZS the Coder thinks that a subarray of a is beautiful if the bitwise xor of all the elements in the subarray is at least k.Help ZS the Coder find the number of beautiful subarrays of a!" 2100
665D "Simple Subset" "constructive algorithms,greedy,number theory" "A tuple of positive integers {x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xk} is called simple if for all pairs of positive integers (i,\xe2\x80\x89\xe2\x80\x89j) (1\xe2\x80\x89\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x80\x89<\xe2\x80\x89\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k), xi\xe2\x80\x89\xe2\x80\x89+\xe2\x80\x89\xe2\x80\x89xj is a prime.You are given an array a with n positive integers a1,\xe2\x80\x89\xe2\x80\x89a2,\xe2\x80\x89\xe2\x80\x89...,\xe2\x80\x89\xe2\x80\x89an (not necessary distinct). You want to find a simple subset of the array a with the maximum size.A prime number (or a prime) is a natural number greater than 1 that has no positive divisors other than 1 and itself.Let\'s define a subset of the array a as a tuple that can be obtained from a by removing some (possibly all) elements of it." 1800
665C "Simple Strings" dp,greedy,strings "zscoder loves simple strings! A string t is called simple if every pair of adjacent characters are distinct. For example ab, aba, zscoder are simple whereas aa, add are not simple.zscoder is given a string s. He wants to change a minimum number of characters so that the string s becomes simple. Help him with this task!" 1300
665B Shopping "brute force" "Ayush is a cashier at the shopping center. Recently his department has started a \'\'click and collect"" service which allows users to shop online. The store contains k items. n customers have already used the above service. Each user paid for m items. Let aij denote the j-th item in the i-th person\'s order.Due to the space limitations all the items are arranged in one single row. When Ayush receives the i-th order he will find one by one all the items aij (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m) in the row. Let pos(x) denote the position of the item x in the row at the moment of its collection. Then Ayush takes time equal to pos(ai1)\xe2\x80\x89+\xe2\x80\x89pos(ai2)\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89pos(aim) for the i-th customer.When Ayush accesses the x-th element he keeps a new stock in the front of the row and takes away the x-th element. Thus the values are updating.Your task is to calculate the total time it takes for Ayush to process all the orders.You can assume that the market has endless stock." 1400
665A "Buses Between Cities" implementation "Buses run between the cities A and B, the first one is at 05:00 AM and the last one departs not later than at 11:59 PM. A bus from the city A departs every a minutes and arrives to the city B in a ta minutes, and a bus from the city B departs every b minutes and arrives to the city A in a tb minutes.The driver Simion wants to make his job diverse, so he counts the buses going towards him. Simion doesn\'t count the buses he meet at the start and finish.You know the time when Simion departed from the city A to the city B. Calculate the number of buses Simion will meet to be sure in his counting." 1600
664A "Complicated GCD" "math,number theory" "Greatest common divisor GCD(a,\xe2\x80\x89b) of two positive integers a and b is equal to the biggest integer d such that both integers a and b are divisible by d. There are many efficient algorithms to find greatest common divisor GCD(a,\xe2\x80\x89b), for example, Euclid algorithm. Formally, find the biggest integer d, such that all integers a,\xe2\x80\x89a\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89a\xe2\x80\x89+\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89b are divisible by d. To make the problem even more complicated we allow a and b to be up to googol, 10100 \xe2\x80\x94 such number do not fit even in 64-bit integer type!" 800
663A Rebus "constructive algorithms,expression parsing,greedy,math" "You are given a rebus of form ? + ? - ? + ? = n, consisting of only question marks, separated by arithmetic operation \'+\' and \'-\', equality and positive integer n. The goal is to replace each question mark with some positive integer from 1 to n, such that equality holds." 1800
662E "To Hack or not to Hack" "brute force,dp,greedy" "Consider a regular Codeforces round consisting of three problems that uses dynamic scoring.You are given an almost final scoreboard. For each participant (including yourself), the time of the accepted submission for each of the problems is given. Also, for each solution you already know whether you are able to hack it or not. The only changes in the scoreboard that will happen before the end of the round are your challenges.What is the best place you may take at the end?More formally, n people are participating (including yourself). For any problem, if it was solved by exactly k people at the end of the round, the maximum score for this problem is defined as:   If n\xe2\x80\x89<\xe2\x80\x892k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x892n, then the maximum possible score is 500;  If n\xe2\x80\x89<\xe2\x80\x894k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x892n, then the maximum possible score is 1000;  If n\xe2\x80\x89<\xe2\x80\x898k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x892n, then the maximum possible score is 1500;  If n\xe2\x80\x89<\xe2\x80\x8916k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x892n, then the maximum possible score is 2000;  If n\xe2\x80\x89<\xe2\x80\x8932k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x892n, then the maximum possible score is 2500;  If 32k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n, then the maximum possible score is 3000. Let the maximum possible score for some problem be equal to s. Then a contestant who didn\'t manage to get it accepted (or his solution was hacked) earns 0 points for this problem. If he got the the solution accepted t minutes after the beginning of the round (and his solution wasn\'t hacked), he earns  points for this problem.The overall score of a participant is equal to the sum of points he earns for each problem plus 100 points for each successful hack (only you make hacks).The resulting place you get is equal to one plus the number of participants who\'s overall score is strictly greater than yours." 3100
662D "International Olympiad" "constructive algorithms,greedy,implementation,math" "International Abbreviation Olympiad takes place annually starting from 1989. Each year the competition receives an abbreviation of form IAO\'y, where y stands for some number of consequent last digits of the current year. Organizers always pick an abbreviation with non-empty string y that has never been used before. Among all such valid abbreviations they choose the shortest one and announce it to be the abbreviation of this year\'s competition.For example, the first three Olympiads (years 1989, 1990 and 1991, respectively) received the abbreviations IAO\'9, IAO\'0 and IAO\'1, while the competition in 2015 received an abbreviation IAO\'15, as IAO\'5 has been already used in 1995.You are given a list of abbreviations. For each of them determine the year it stands for." 2000
662C "Binary Table" "bitmasks,brute force,divide and conquer,dp,fft,math" "You are given a table consisting of n rows and m columns. Each cell of the table contains either 0 or 1. In one move, you are allowed to pick any row or any column and invert all values, that is, replace 0 by 1 and vice versa.What is the minimum number of cells with value 1 you can get after applying some number of operations?" 2600
662B "Graph Coloring" "dfs and similar,graphs" "You are given an undirected graph that consists of n vertices and m edges. Initially, each edge is colored either red or blue. Each turn a player picks a single vertex and switches the color of all edges incident to it. That is, all red edges with an endpoint in this vertex change the color to blue, while all blue edges with an endpoint in this vertex change the color to red.Find the minimum possible number of moves required to make the colors of all edges equal." 2200
662A "Gambling Nim" bitmasks,math,matrices,probabilities "As you know, the game of ""Nim"" is played with n piles of stones, where the i-th pile initially contains ai stones. Two players alternate the turns. During a turn a player picks any non-empty pile and removes any positive number of stones from it. The one who is not able to make a move loses the game.Petya and Vasya are tired of playing Nim, so they invented their own version of the game and named it the ""Gambling Nim"". They have n two-sided cards, one side of the i-th card has number ai written on it, while the other side has number bi. At the beginning of the game the players put all the cards on the table, each card only one of its sides up, and this side is chosen independently and uniformly. Thus they obtain a sequence c1,\xe2\x80\x89c2,\xe2\x80\x89...,\xe2\x80\x89cn, where ci is equal to ai or bi. Then they take n piles of stones, with i-th pile containing exactly ci stones and play Nim. Petya takes the first turn.Given that both players play optimally, find the probability of Petya\'s victory. Output the answer as an irreducible fraction." 2400
661H "Rotate Matrix" "*special problem" "You are given a square matrix of integer numbers. Rotate it 90 degrees clockwise (see examples for clarification of rotation)." 2400
661G "Hungarian Notation" "*special problem" "In Hungarian notation, a variable name is prefixed with a letter or a group of letters which are mnemonics for the type of that variable. For the purposes of this problem we will consider only two data types: integer and real.You are given the meaningful part of variable name in lowercase and a sample value that it will store. Integer values will be written as a sequence of digits. Real values will be written using fixed-point notation: the value is represented with a mandatory decimal point, one or more digits in the decimal part and without exponent part.Your task is to construct a name of this variable in Hungarian notation in the following way. Convert the first letter of meaningful part of the name to uppercase, and prepend a prefix: \'i\' for integer variables and \'f\' for real ones." 2200
661F "Primes in Interval" "*special problem" "You are given two integers a and b (a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b). How many prime numbers are there on the interval from a to b, inclusive?" 1900
661E "Divisibility Check" "*special problem" "You are given an array of integers. Check whether there exists a number in this array which is divisible by all other numbers in this array. Output 1, if such a number exists, and 0 otherwise." 2000
661D "Maximal Difference" "*special problem" "You are given an array of integers ai. Find the largest absolute value of difference between adjacent elements of the array max(abs(ai\xe2\x80\x89-\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x891))." 2100
661C "Array Sum" "*special problem" "You are given an array of integers. Calculate the sum of its elements." 2000
661B Seasons "*special problem" "You are given a name of a month. Output the season of the year to which it belongs (based on Northern hemisphere)." 1900
661A "Lazy Caterer Sequence" "*special problem" "Lazy caterer sequence is defined as the maximum number of pieces formed when slicing a convex pancake with n cuts (each cut is a straight line). The formula is Cn\xe2\x80\x89=\xe2\x80\x89n\xc2\xb7(n\xe2\x80\x89+\xe2\x80\x891)\xe2\x80\x89/\xe2\x80\x892\xe2\x80\x89+\xe2\x80\x891. You are given n; calculate n-th element of the sequence." 1300
660F "Bear and Bowling 4" "binary search,data structures,divide and conquer,geometry,ternary search" "Limak is an old brown bear. He often goes bowling with his friends. Today he feels really good and tries to beat his own record!For rolling a ball one gets a score \xe2\x80\x94 an integer (maybe negative) number of points. Score for the i-th roll is multiplied by i and scores are summed up. So, for k rolls with scores s1,\xe2\x80\x89s2,\xe2\x80\x89...,\xe2\x80\x89sk, the total score is . The total score is 0 if there were no rolls.Limak made n rolls and got score ai for the i-th of them. He wants to maximize his total score and he came up with an interesting idea. He can say that some first rolls were only a warm-up, and that he wasn\'t focused during the last rolls. More formally, he can cancel any prefix and any suffix of the sequence a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. It is allowed to cancel all rolls, or to cancel none of them.The total score is calculated as if there were only non-canceled rolls. So, the first non-canceled roll has score multiplied by 1, the second one has score multiplied by 2, and so on, till the last non-canceled roll.What maximum total score can Limak get?" 2500
660E "Different Subsets For All Tuples" combinatorics,math "For a sequence a of n integers between 1 and m, inclusive, denote f(a) as the number of distinct subsequences of a (including the empty subsequence).You are given two positive integers n and m. Let S be the set of all sequences of length n consisting of numbers from 1 to m. Compute the sum f(a) over all a in S modulo 109\xe2\x80\x89+\xe2\x80\x897." 2300
660D "Number of Parallelograms" geometry "You are given n points on a plane. All the points are distinct and no three of them lie on the same line. Find the number of parallelograms with the vertices at the given points." 1900
660C "Hard Process" "binary search,dp,two pointers" "You are given an array a with n elements. Each element of a is either 0 or 1.Let\'s denote the length of the longest subsegment of consecutive elements in a, consisting of only numbers one, as f(a). You can change no more than k zeroes to ones to maximize f(a)." 1600
660B "Seating On Bus" implementation "Consider 2n rows of the seats in a bus. n rows of the seats on the left and n rows of the seats on the right. Each row can be filled by two people. So the total capacity of the bus is 4n.Consider that m (m\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x894n) people occupy the seats in the bus. The passengers entering the bus are numbered from 1 to m (in the order of their entering the bus). The pattern of the seat occupation is as below:1-st row left window seat, 1-st row right window seat, 2-nd row left window seat, 2-nd row right window seat, ... , n-th row left window seat, n-th row right window seat.After occupying all the window seats (for m\xe2\x80\x89>\xe2\x80\x892n) the non-window seats are occupied:1-st row left non-window seat, 1-st row right non-window seat, ... , n-th row left non-window seat, n-th row right non-window seat.All the passengers go to a single final destination. In the final destination, the passengers get off in the given order.1-st row left non-window seat, 1-st row left window seat, 1-st row right non-window seat, 1-st row right window seat, ... , n-th row left non-window seat, n-th row left window seat, n-th row right non-window seat, n-th row right window seat.  The seating for n\xe2\x80\x89=\xe2\x80\x899 and m\xe2\x80\x89=\xe2\x80\x8936. You are given the values n and m. Output m numbers from 1 to m, the order in which the passengers will get off the bus." 1000
660A "Co-prime Array" "greedy,implementation,math,number theory" "You are given an array of n elements, you must make it a co-prime array in as few moves as possible.In each move you can insert any positive integral number you want not greater than 109 in any place in the array.An array is co-prime if any two adjacent numbers of it are co-prime.In the number theory, two integers a and b are said to be co-prime if the only positive integer that divides both of them is 1." 1200
659G "Fence Divercity" "combinatorics,dp,number theory" "Long ago, Vasily built a good fence at his country house. Vasily calls a fence good, if it is a series of n consecutively fastened vertical boards of centimeter width, the height of each in centimeters is a positive integer. The house owner remembers that the height of the i-th board to the left is hi.Today Vasily decided to change the design of the fence he had built, by cutting his top connected part so that the fence remained good. The cut part should consist of only the upper parts of the boards, while the adjacent parts must be interconnected (share a non-zero length before cutting out of the fence).You, as Vasily\'s curious neighbor, will count the number of possible ways to cut exactly one part as is described above. Two ways to cut a part are called distinct, if for the remaining fences there is such i, that the height of the i-th boards vary.As Vasily\'s fence can be very high and long, get the remainder after dividing the required number of ways by 1\xe2\x80\x89000\xe2\x80\x89000\xe2\x80\x89007 (109\xe2\x80\x89+\xe2\x80\x897)." 2300
659F "Polycarp and Hay" "dfs and similar,dsu,graphs,greedy,sortings" "The farmer Polycarp has a warehouse with hay, which can be represented as an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m rectangular table, where n is the number of rows, and m is the number of columns in the table. Each cell of the table contains a haystack. The height in meters of the hay located in the i-th row and the j-th column is equal to an integer ai,\xe2\x80\x89j and coincides with the number of cubic meters of hay in the haystack, because all cells have the size of the base 1\xe2\x80\x89\xc3\x97\xe2\x80\x891. Polycarp has decided to tidy up in the warehouse by removing an arbitrary integer amount of cubic meters of hay from the top of each stack. You can take different amounts of hay from different haystacks. Besides, it is allowed not to touch a stack at all, or, on the contrary, to remove it completely. If a stack is completely removed, the corresponding cell becomes empty and no longer contains the stack.Polycarp wants the following requirements to hold after the reorganization:  the total amount of hay remaining in the warehouse must be equal to k,  the heights of all stacks (i.e., cells containing a non-zero amount of hay) should be the same,  the height of at least one stack must remain the same as it was,  for the stability of the remaining structure all the stacks should form one connected region. The two stacks are considered adjacent if they share a side in the table. The area is called connected if from any of the stack in the area you can get to any other stack in this area, moving only to adjacent stacks. In this case two adjacent stacks necessarily belong to the same area.Help Polycarp complete this challenging task or inform that it is impossible." 2000
659E "New Reform" "data structures,dfs and similar,dsu,graphs,greedy" "Berland has n cities connected by m bidirectional roads. No road connects a city to itself, and each pair of cities is connected by no more than one road. It is not guaranteed that you can get from any city to any other one, using only the existing roads.The President of Berland decided to make changes to the road system and instructed the Ministry of Transport to make this reform. Now, each road should be unidirectional (only lead from one city to another).In order not to cause great resentment among residents, the reform needs to be conducted so that there can be as few separate cities as possible. A city is considered separate, if no road leads into it, while it is allowed to have roads leading from this city.Help the Ministry of Transport to find the minimum possible number of separate cities after the reform." 1600
659D "Bicycle Race" geometry,implementation,math "Maria participates in a bicycle race.The speedway takes place on the shores of Lake Lucerne, just repeating its contour. As you know, the lake shore consists only of straight sections, directed to the north, south, east or west.Let\'s introduce a system of coordinates, directing the Ox axis from west to east, and the Oy axis from south to north. As a starting position of the race the southernmost point of the track is selected (and if there are several such points, the most western among them). The participants start the race, moving to the north. At all straight sections of the track, the participants travel in one of the four directions (north, south, east or west) and change the direction of movement only in bends between the straight sections. The participants, of course, never turn back, that is, they do not change the direction of movement from north to south or from east to west (or vice versa).Maria is still young, so she does not feel confident at some turns. Namely, Maria feels insecure if at a failed or untimely turn, she gets into the water. In other words, Maria considers the turn dangerous if she immediately gets into the water if it is ignored.Help Maria get ready for the competition \xe2\x80\x94 determine the number of dangerous turns on the track." 1500
659C "Tanya and Toys" greedy,implementation "In Berland recently a new collection of toys went on sale. This collection consists of 109 types of toys, numbered with integers from 1 to 109. A toy from the new collection of the i-th type costs i bourles.Tania has managed to collect n different types of toys a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an from the new collection. Today is Tanya\'s birthday, and her mother decided to spend no more than m bourles on the gift to the daughter. Tanya will choose several different types of toys from the new collection as a gift. Of course, she does not want to get a type of toy which she already has.Tanya wants to have as many distinct types of toys in her collection as possible as the result. The new collection is too diverse, and Tanya is too little, so she asks you to help her in this." 1200
659B "Qualifying Contest" "constructive algorithms,sortings" "Very soon Berland will hold a School Team Programming Olympiad. From each of the m Berland regions a team of two people is invited to participate in the olympiad. The qualifying contest to form teams was held and it was attended by n Berland students. There were at least two schoolboys participating from each of the m regions of Berland. The result of each of the participants of the qualifying competition is an integer score from 0 to 800 inclusive.The team of each region is formed from two such members of the qualifying competition of the region, that none of them can be replaced by a schoolboy of the same region, not included in the team and who received a greater number of points. There may be a situation where a team of some region can not be formed uniquely, that is, there is more than one school team that meets the properties described above. In this case, the region needs to undertake an additional contest. The two teams in the region are considered to be different if there is at least one schoolboy who is included in one team and is not included in the other team. It is guaranteed that for each region at least two its representatives participated in the qualifying contest.Your task is, given the results of the qualifying competition, to identify the team from each region, or to announce that in this region its formation requires additional contests." 1300
659A "Round House" implementation,math "Vasya lives in a round building, whose entrances are numbered sequentially by integers from 1 to n. Entrance n and entrance 1 are adjacent.Today Vasya got bored and decided to take a walk in the yard. Vasya lives in entrance a and he decided that during his walk he will move around the house b entrances in the direction of increasing numbers (in this order entrance n should be followed by entrance 1). The negative value of b corresponds to moving |b| entrances in the order of decreasing numbers (in this order entrance 1 is followed by entrance n). If b\xe2\x80\x89=\xe2\x80\x890, then Vasya prefers to walk beside his entrance.  Illustration for n\xe2\x80\x89=\xe2\x80\x896, a\xe2\x80\x89=\xe2\x80\x892, b\xe2\x80\x89=\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x895. Help Vasya to determine the number of the entrance, near which he will be at the end of his walk." 1000
658A "Bear and Reverse Radewoosh" implementation "Limak and Radewoosh are going to compete against each other in the upcoming algorithmic contest. They are equally skilled but they won\'t solve problems in the same order.There will be n problems. The i-th problem has initial score pi and it takes exactly ti minutes to solve it. Problems are sorted by difficulty \xe2\x80\x94 it\'s guaranteed that pi\xe2\x80\x89<\xe2\x80\x89pi\xe2\x80\x89+\xe2\x80\x891 and ti\xe2\x80\x89<\xe2\x80\x89ti\xe2\x80\x89+\xe2\x80\x891.A constant c is given too, representing the speed of loosing points. Then, submitting the i-th problem at time x (x minutes after the start of the contest) gives max(0,\xe2\x80\x89 pi\xe2\x80\x89-\xe2\x80\x89c\xc2\xb7x) points.Limak is going to solve problems in order 1,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89n (sorted increasingly by pi). Radewoosh is going to solve them in order n,\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x891 (sorted decreasingly by pi). Your task is to predict the outcome \xe2\x80\x94 print the name of the winner (person who gets more points at the end) or a word ""Tie"" in case of a tie.You may assume that the duration of the competition is greater or equal than the sum of all ti. That means both Limak and Radewoosh will accept all n problems." 800
656G "You\'re a Professional" "*special problem" "A simple recommendation system would recommend a user things liked by a certain number of their friends. In this problem you will implement part of such a system.You are given user\'s friends\' opinions about a list of items. You are also given a threshold T \xe2\x80\x94 the minimal number of ""likes"" necessary for an item to be recommended to the user.Output the number of items in the list liked by at least T of user\'s friends." 1900
656F "Ace It!" "*special problem" "InputThe only line of the input is a string of 7 characters. The first character is letter A, followed by 6 digits. The input is guaranteed to be valid (for certain definition of ""valid"").OutputOutput a single integer.ExamplesInputCopyA221033OutputCopy21InputCopyA223635OutputCopy22InputCopyA232726OutputCopy23" 1900
656E "Out of Controls" "*special problem" "You are given a complete undirected graph. For each pair of vertices you are given the length of the edge that connects them. Find the shortest paths between each pair of vertices in the graph and return the length of the longest of them." 2000
656D "Rosetta Problem" "*special problem" "++++++++[>+>++>+++>++++>+++++>++++++>+++++++>++++++++>+++++++++>++++++++++>+++++++++++>++++++++++++>+++++++++++++>++++++++++++++>+++++++++++++++>++++++++++++++++<<<<<<<<<<<<<<<<-]>>>>>>>>>>.<<<<<<<<<<>>>>>>>>>>>>>>++.--<<<<<<<<<<<<<<>>>>>>>>>>>>>+.-<<<<<<<<<<<<<>>>>>>>>>>>>>>--.++<<<<<<<<<<<<<<>>>>>>>>>>>>>>>----.++++<<<<<<<<<<<<<<<>>>>.<<<<>>>>>>>>>>>>>>--.++<<<<<<<<<<<<<<>>>>>>>>>>>>>>>---.+++<<<<<<<<<<<<<<<>>>>>>>>>>>>>>---.+++<<<<<<<<<<<<<<>>>>>>>>>>>>++.--<<<<<<<<<<<<>>>>>>>>>>>>>---.+++<<<<<<<<<<<<<>>>>>>>>>>>>>>++.--<<<<<<<<<<<<<<.DCBA:^!~}|{zyxwvutsrqponmlkjihgfedcba`_^]\\[ZYXWVUTSRQPONMLKJIHdcbD`Y^]\\UZYRv9876543210/.-,+*)(\'&%$#""!~}|{zyxwvutsrqponm+*)(\'&%$#cya`=^]\\[ZYXWVUTSRQPONMLKJfe^cba`_X]VzTYRv98TSRQ3ONMLEi,+*)(\'&%$#""!~}|{zyxwvutsrqponmlkjihgfedcba`_^]\\[ZYXWVUTSonPlkjchg`ed]#DCBA@?>=<;:9876543OHGLKDIHGFE>b%$#""!~}|{zyxwvutsrqponmlkjihgfedcba`_^]\\[ZYXWVUTSRQPONMibafedcba`_X|?>Z<XWVUTSRKo\\ v34*8+6+,78+9*3+,93+9*5+,28+9*1+,55+9*4+,23*6*2*,91,@,+7*9*25,*48,+3*9+38,+<>62*9*2+,34*9*3+,66+9*8+,52*9*7+,75+9*8+,92+9*6+,48+9*3+,43*9*2+,84*,26*9*3^" 2100
656C "Without Text" "*special problem" "You can preview the image in better quality by the link: http://assets.codeforces.com/files/656/without-text.png" 2000
656B Scrambled "*special problem,implementation" "Btoh yuo adn yuor roomatme lhoate wianshg disehs, btu stlil sdmoeboy msut peorrfm tihs cohre dialy. Oen dya yuo decdie to idourtcne smoe syestm. Yuor rmmotaoe sstgegus teh fooniwllg dael. Yuo argee on tow arayrs of ientgres M adn R, nmebur upmicnog dyas (induiclng teh cunrret oen) wtih sicsescuve irnegets (teh ceurrnt dya is zreo), adn yuo wsah teh diehss on dya D if adn olny if terhe etsixs an iednx i scuh taht D mod M[i]\xe2\x80\x89=\xe2\x80\x89R[i], otwsehrie yuor rmootmae deos it. Yuo lkie teh cncepot, btu yuor rmotaome\'s cuinnng simle meaks yuo ssecupt sthnoemig, so yuo itennd to vefriy teh fnerisas of teh aemnrgeet.Yuo aer geivn ayarrs M adn R. Cuaclatle teh pceanregte of dyas on wchih yuo edn up dnoig teh wisahng. Amsuse taht yuo hvae iiiftlneny mnay dyas aehad of yuo." 1700
656A "Da Vinci Powers" "*special problem" "InputThe input contains a single integer a (0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x8935).OutputOutput a single integer.ExamplesInputCopy3OutputCopy8InputCopy10OutputCopy1024" 1900
653G "Move by Prime" "combinatorics,math,number theory" "Pussycat Sonya has an array consisting of n positive integers. There are 2n possible subsequences of the array. For each subsequence she counts the minimum number of operations to make all its elements equal. Each operation must be one of two:  Choose some element of the subsequence and multiply it by some prime number.  Choose some element of the subsequence and divide it by some prime number. The chosen element must be divisible by the chosen prime number. What is the sum of minimum number of operations for all 2n possible subsequences? Find and print this sum modulo 109\xe2\x80\x89+\xe2\x80\x897." 3100
653F "Paper task" "data structures,string suffix structures,strings" "Alex was programming while Valentina (his toddler daughter) got there and started asking many questions about the round brackets (or parenthesis) in the code. He explained her a bit and when she got it he gave her a task in order to finish his code on time.For the purpose of this problem we consider only strings consisting of opening and closing round brackets, that is characters \'(\' and \')\'.The sequence of brackets is called correct if:   it\'s empty;  it\'s a correct sequence of brackets, enclosed in a pair of opening and closing brackets;  it\'s a concatenation of two correct sequences of brackets. For example, the sequences ""()()"" and ""((()))(())"" are correct, while "")(()"", ""((((("" and ""())"" are not.Alex took a piece of paper, wrote a string s consisting of brackets and asked Valentina to count the number of distinct non-empty substrings of s that are correct sequences of brackets. In other words, her task is to count the number of non-empty correct sequences of brackets that occur in a string s as a substring (don\'t mix up with subsequences).When Valentina finished the task, Alex noticed he doesn\'t know the answer. Help him don\'t loose face in front of Valentina and solve the problem!" 2600
653E "Bear and Forgotten Tree 2" "dfs and similar,dsu,graphs,trees" "A tree is a connected undirected graph consisting of n vertices and n\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x89\xe2\x80\x891 edges. Vertices are numbered 1 through n.Limak is a little polar bear. He once had a tree with n vertices but he lost it. He still remembers something about the lost tree though.You are given m pairs of vertices (a1,\xe2\x80\x89b1),\xe2\x80\x89(a2,\xe2\x80\x89b2),\xe2\x80\x89...,\xe2\x80\x89(am,\xe2\x80\x89bm). Limak remembers that for each i there was no edge between ai and bi. He also remembers that vertex 1 was incident to exactly k edges (its degree was equal to k).Is it possible that Limak remembers everything correctly? Check whether there exists a tree satisfying the given conditions." 2400
653D "Delivery Bears" "binary search,flows,graphs" "Niwel is a little golden bear. As everyone knows, bears live in forests, but Niwel got tired of seeing all the trees so he decided to move to the city.In the city, Niwel took on a job managing bears to deliver goods. The city that he lives in can be represented as a directed graph with n nodes and m edges. Each edge has a weight capacity. A delivery consists of a bear carrying weights with their bear hands on a simple path from node 1 to node n. The total weight that travels across a particular edge must not exceed the weight capacity of that edge.Niwel has exactly x bears. In the interest of fairness, no bear can rest, and the weight that each bear carries must be exactly the same. However, each bear may take different paths if they like.Niwel would like to determine, what is the maximum amount of weight he can deliver (it\'s the sum of weights carried by bears). Find the maximum weight." 2200
653C "Bear and Up-Down" "brute force,implementation" "The life goes up and down, just like nice sequences. Sequence t1,\xe2\x80\x89t2,\xe2\x80\x89...,\xe2\x80\x89tn is called nice if the following two conditions are satisfied:   ti\xe2\x80\x89<\xe2\x80\x89ti\xe2\x80\x89+\xe2\x80\x891 for each odd i\xe2\x80\x89<\xe2\x80\x89n;  ti\xe2\x80\x89>\xe2\x80\x89ti\xe2\x80\x89+\xe2\x80\x891 for each even i\xe2\x80\x89<\xe2\x80\x89n. For example, sequences (2,\xe2\x80\x898), (1,\xe2\x80\x895,\xe2\x80\x891) and (2,\xe2\x80\x895,\xe2\x80\x891,\xe2\x80\x89100,\xe2\x80\x8999,\xe2\x80\x89120) are nice, while (1,\xe2\x80\x891), (1,\xe2\x80\x892,\xe2\x80\x893) and (2,\xe2\x80\x895,\xe2\x80\x893,\xe2\x80\x892) are not.Bear Limak has a sequence of positive integers t1,\xe2\x80\x89t2,\xe2\x80\x89...,\xe2\x80\x89tn. This sequence is not nice now and Limak wants to fix it by a single swap. He is going to choose two indices i\xe2\x80\x89<\xe2\x80\x89j and swap elements ti and tj in order to get a nice sequence. Count the number of ways to do so. Two ways are considered different if indices of elements chosen for a swap are different." 1900
653B "Bear and Compressing" "brute force,dfs and similar,dp,strings" "Limak is a little polar bear. Polar bears hate long strings and thus they like to compress them. You should also know that Limak is so young that he knows only first six letters of the English alphabet: \'a\', \'b\', \'c\', \'d\', \'e\' and \'f\'.You are given a set of q possible operations. Limak can perform them in any order, any operation may be applied any number of times. The i-th operation is described by a string ai of length two and a string bi of length one. No two of q possible operations have the same string ai.When Limak has a string s he can perform the i-th operation on s if the first two letters of s match a two-letter string ai. Performing the i-th operation removes first two letters of s and inserts there a string bi. See the notes section for further clarification.You may note that performing an operation decreases the length of a string s exactly by 1. Also, for some sets of operations there may be a string that cannot be compressed any further, because the first two letters don\'t match any ai.Limak wants to start with a string of length n and perform n\xe2\x80\x89-\xe2\x80\x891 operations to finally get a one-letter string ""a"". In how many ways can he choose the starting string to be able to get ""a""? Remember that Limak can use only letters he knows." 1300
653A "Bear and Three Balls" "brute force,implementation,sortings" "Limak is a little polar bear. He has n balls, the i-th ball has size ti.Limak wants to give one ball to each of his three friends. Giving gifts isn\'t easy \xe2\x80\x94 there are two rules Limak must obey to make friends happy:  No two friends can get balls of the same size.  No two friends can get balls of sizes that differ by more than 2. For example, Limak can choose balls with sizes 4, 5 and 3, or balls with sizes 90, 91 and 92. But he can\'t choose balls with sizes 5, 5 and 6 (two friends would get balls of the same size), and he can\'t choose balls with sizes 30, 31 and 33 (because sizes 30 and 33 differ by more than 2).Your task is to check whether Limak can choose three balls that satisfy conditions above." 900
652F "Ants on a Circle" "constructive algorithms,math" "n ants are on a circle of length m. An ant travels one unit of distance per one unit of time. Initially, the ant number i is located at the position si and is facing in the direction di (which is either L or R). Positions are numbered in counterclockwise order starting from some point. Positions of the all ants are distinct.All the ants move simultaneously, and whenever two ants touch, they will both switch their directions. Note that it is possible for an ant to move in some direction for a half of a unit of time and in opposite direction for another half of a unit of time.Print the positions of the ants after t time units." 2800
652E "Pursuit For Artifacts" "dfs and similar,dsu,graphs,trees" "Johnny is playing a well-known computer game. The game are in some country, where the player can freely travel, pass quests and gain an experience.In that country there are n islands and m bridges between them, so you can travel from any island to any other. In the middle of some bridges are lying ancient powerful artifacts. Johnny is not interested in artifacts, but he can get some money by selling some artifact.At the start Johnny is in the island a and the artifact-dealer is in the island b (possibly they are on the same island). Johnny wants to find some artifact, come to the dealer and sell it. The only difficulty is that bridges are too old and destroying right after passing over them. Johnnie\'s character can\'t swim, fly and teleport, so the problem became too difficult.Note that Johnny can\'t pass the half of the bridge, collect the artifact and return to the same island. Determine if Johnny can find some artifact and sell it." 2300
652D "Nested Segments" "data structures,sortings" "You are given n segments on a line. There are no ends of some segments that coincide. For each segment find the number of segments it contains." 1800
652C "Foe Pairs" "combinatorics,sortings,two pointers" "You are given a permutation p of length n. Also you are given m foe pairs (ai,\xe2\x80\x89bi) (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ai,\xe2\x80\x89bi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n,\xe2\x80\x89ai\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89bi). Your task is to count the number of different intervals (x,\xe2\x80\x89y) (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) that do not contain any foe pairs. So you shouldn\'t count intervals (x,\xe2\x80\x89y) that contain at least one foe pair in it (the positions and order of the values from the foe pair are not important).Consider some example: p\xe2\x80\x89=\xe2\x80\x89[1,\xe2\x80\x893,\xe2\x80\x892,\xe2\x80\x894] and foe pairs are {(3,\xe2\x80\x892),\xe2\x80\x89(4,\xe2\x80\x892)}. The interval (1,\xe2\x80\x893) is incorrect because it contains a foe pair (3,\xe2\x80\x892). The interval (1,\xe2\x80\x894) is also incorrect because it contains two foe pairs (3,\xe2\x80\x892) and (4,\xe2\x80\x892). But the interval (1,\xe2\x80\x892) is correct because it doesn\'t contain any foe pair." 1800
652B z-sort sortings "A student of z-school found a kind of sorting called z-sort. The array a with n elements are z-sorted if two conditions hold:  ai\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89ai\xe2\x80\x89-\xe2\x80\x891 for all even i,  ai\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ai\xe2\x80\x89-\xe2\x80\x891 for all odd i\xe2\x80\x89>\xe2\x80\x891. For example the arrays [1,2,1,2] and [1,1,1,1] are z-sorted while the array [1,2,3,4] isn\xe2\x80\x99t z-sorted.Can you make the array z-sorted?" 1000
652A "Gabriel and Caterpillar" implementation,math "The 9-th grade student Gabriel noticed a caterpillar on a tree when walking around in a forest after the classes. The caterpillar was on the height h1 cm from the ground. On the height h2 cm (h2\xe2\x80\x89>\xe2\x80\x89h1) on the same tree hung an apple and the caterpillar was crawling to the apple.Gabriel is interested when the caterpillar gets the apple. He noted that the caterpillar goes up by a cm per hour by day and slips down by b cm per hour by night.In how many days Gabriel should return to the forest to see the caterpillar get the apple. You can consider that the day starts at 10 am and finishes at 10 pm. Gabriel\'s classes finish at 2 pm. You can consider that Gabriel noticed the caterpillar just after the classes at 2 pm.Note that the forest is magic so the caterpillar can slip down under the ground and then lift to the apple." 1400
651B "Beautiful Paintings" greedy,sortings "There are n pictures delivered for the new exhibition. The i-th painting has beauty ai. We know that a visitor becomes happy every time he passes from a painting to a more beautiful one.We are allowed to arranged pictures in any order. What is the maximum possible number of times the visitor may become happy while passing all pictures from first to last? In other words, we are allowed to rearrange elements of a in any order. What is the maximum possible number of indices i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x891), such that ai\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89>\xe2\x80\x89ai." 1200
651A Joysticks dp,greedy,implementation,math "Friends are going to play console. They have two joysticks and only one charger for them. Initially first joystick is charged at a1 percent and second one is charged at a2 percent. You can connect charger to a joystick only at the beginning of each minute. In one minute joystick either discharges by 2 percent (if not connected to a charger) or charges by 1 percent (if connected to a charger).Game continues while both joysticks have a positive charge. Hence, if at the beginning of minute some joystick is charged by 1 percent, it has to be connected to a charger, otherwise the game stops. If some joystick completely discharges (its charge turns to 0), the game also stops.Determine the maximum number of minutes that game can last. It is prohibited to pause the game, i. e. at each moment both joysticks should be enabled. It is allowed for joystick to be charged by more than 100 percent." 1100
650E "Clockwork Bomb" "data structures,dfs and similar,dsu,greedy,trees" "My name is James diGriz, I\'m the most clever robber and treasure hunter in the whole galaxy. There are books written about my adventures and songs about my operations, though you were able to catch me up in a pretty awkward moment.I was able to hide from cameras, outsmart all the guards and pass numerous traps, but when I finally reached the treasure box and opened it, I have accidentally started the clockwork bomb! Luckily, I have met such kind of bombs before and I know that the clockwork mechanism can be stopped by connecting contacts with wires on the control panel of the bomb in a certain manner.I see n contacts connected by n\xe2\x80\x89-\xe2\x80\x891 wires. Contacts are numbered with integers from 1 to n. Bomb has a security mechanism that ensures the following condition: if there exist k\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x892 contacts c1,\xe2\x80\x89c2,\xe2\x80\x89...,\xe2\x80\x89ck forming a circuit, i. e. there exist k distinct wires between contacts c1 and c2, c2 and c3, ..., ck and c1, then the bomb immediately explodes and my story ends here. In particular, if two contacts are connected by more than one wire they form a circuit of length 2. It is also prohibited to connect a contact with itself.On the other hand, if I disconnect more than one wire (i. e. at some moment there will be no more than n\xe2\x80\x89-\xe2\x80\x892 wires in the scheme) then the other security check fails and the bomb also explodes. So, the only thing I can do is to unplug some wire and plug it into a new place ensuring the fact that no circuits appear.I know how I should put the wires in order to stop the clockwork. But my time is running out! Help me get out of this alive: find the sequence of operations each of which consists of unplugging some wire and putting it into another place so that the bomb is defused." 3200
650D Zip-line "binary search,data structures,dp,hashing" "Vasya has decided to build a zip-line on trees of a nearby forest. He wants the line to be as long as possible but he doesn\'t remember exactly the heights of all trees in the forest. He is sure that he remembers correct heights of all trees except, possibly, one of them.It is known that the forest consists of n trees staying in a row numbered from left to right with integers from 1 to n. According to Vasya, the height of the i-th tree is equal to hi. The zip-line of length k should hang over k (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) trees i1,\xe2\x80\x89i2,\xe2\x80\x89...,\xe2\x80\x89ik (i1\xe2\x80\x89<\xe2\x80\x89i2\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89ik) such that their heights form an increasing sequence, that is hi1\xe2\x80\x89<\xe2\x80\x89hi2\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89hik.Petya had been in this forest together with Vasya, and he now has q assumptions about the mistake in Vasya\'s sequence h. His i-th assumption consists of two integers ai and bi indicating that, according to Petya, the height of the tree numbered ai is actually equal to bi. Note that Petya\'s assumptions are independent from each other.Your task is to find the maximum length of a zip-line that can be built over the trees under each of the q assumptions.In this problem the length of a zip line is considered equal to the number of trees that form this zip-line." 2600
650C "Table Compression" "dfs and similar,dp,dsu,graphs,greedy" "Little Petya is now fond of data compression algorithms. He has already studied gz, bz, zip algorithms and many others. Inspired by the new knowledge, Petya is now developing the new compression algorithm which he wants to name dis.Petya decided to compress tables. He is given a table a consisting of n rows and m columns that is filled with positive integers. He wants to build the table a\' consisting of positive integers such that the relative order of the elements in each row and each column remains the same. That is, if in some row i of the initial table ai,\xe2\x80\x89j\xe2\x80\x89<\xe2\x80\x89ai,\xe2\x80\x89k, then in the resulting table a\'i,\xe2\x80\x89j\xe2\x80\x89<\xe2\x80\x89a\'i,\xe2\x80\x89k, and if ai,\xe2\x80\x89j\xe2\x80\x89=\xe2\x80\x89ai,\xe2\x80\x89k then a\'i,\xe2\x80\x89j\xe2\x80\x89=\xe2\x80\x89a\'i,\xe2\x80\x89k. Similarly, if in some column j of the initial table ai,\xe2\x80\x89j\xe2\x80\x89<\xe2\x80\x89ap,\xe2\x80\x89j then in compressed table a\'i,\xe2\x80\x89j\xe2\x80\x89<\xe2\x80\x89a\'p,\xe2\x80\x89j and if ai,\xe2\x80\x89j\xe2\x80\x89=\xe2\x80\x89ap,\xe2\x80\x89j then a\'i,\xe2\x80\x89j\xe2\x80\x89=\xe2\x80\x89a\'p,\xe2\x80\x89j. Because large values require more space to store them, the maximum value in a\' should be as small as possible.Petya is good in theory, however, he needs your help to implement the algorithm." 2200
650B "Image Preview" "binary search,brute force,dp,two pointers" "Vasya\'s telephone contains n photos. Photo number 1 is currently opened on the phone. It is allowed to move left and right to the adjacent photo by swiping finger over the screen. If you swipe left from the first photo, you reach photo n. Similarly, by swiping right from the last photo you reach photo 1. It takes a seconds to swipe from photo to adjacent.For each photo it is known which orientation is intended for it \xe2\x80\x94 horizontal or vertical. Phone is in the vertical orientation and can\'t be rotated. It takes b second to change orientation of the photo.Vasya has T seconds to watch photos. He want to watch as many photos as possible. If Vasya opens the photo for the first time, he spends 1 second to notice all details in it. If photo is in the wrong orientation, he spends b seconds on rotating it before watching it. If Vasya has already opened the photo, he just skips it (so he doesn\'t spend any time for watching it or for changing its orientation). It is not allowed to skip unseen photos.Help Vasya find the maximum number of photos he is able to watch during T seconds." 1900
650A Watchmen "data structures,geometry,math" "Watchmen are in a danger and Doctor Manhattan together with his friend Daniel Dreiberg should warn them as soon as possible. There are n watchmen on a plane, the i-th watchman is located at point (xi,\xe2\x80\x89yi).They need to arrange a plan, but there are some difficulties on their way. As you know, Doctor Manhattan considers the distance between watchmen i and j to be |xi\xe2\x80\x89-\xe2\x80\x89xj|\xe2\x80\x89+\xe2\x80\x89|yi\xe2\x80\x89-\xe2\x80\x89yj|. Daniel, as an ordinary person, calculates the distance using the formula .The success of the operation relies on the number of pairs (i,\xe2\x80\x89j) (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n), such that the distance between watchman i and watchmen j calculated by Doctor Manhattan is equal to the distance between them calculated by Daniel. You were asked to compute the number of such pairs." 1400
649E \xd0\x90\xd0\xb2\xd1\x82\xd0\xbe\xd0\xb1\xd1\x83\xd1\x81 "binary search,data structures,greedy,sortings" "\xd0\x92\xd0\xb4\xd0\xbe\xd0\xbb\xd1\x8c \xd0\xb4\xd0\xbe\xd1\x80\xd0\xbe\xd0\xb3\xd0\xb8 \xd1\x81\xd1\x82\xd0\xbe\xd1\x8f\xd1\x82 n \xd0\xbf\xd1\x83\xd1\x82\xd0\xb5\xd1\x88\xd0\xb5\xd1\x81\xd1\x82\xd0\xb2\xd0\xb5\xd0\xbd\xd0\xbd\xd0\xb8\xd0\xba\xd0\xbe\xd0\xb2. \xd0\x94\xd0\xbe\xd1\x80\xd0\xbe\xd0\xb3\xd0\xb0 \xd0\xbf\xd1\x80\xd0\xb5\xd0\xb4\xd1\x81\xd1\x82\xd0\xb0\xd0\xb2\xd0\xbb\xd1\x8f\xd0\xb5\xd1\x82 \xd1\x81\xd0\xbe\xd0\xb1\xd0\xbe\xd0\xb9 \xd0\xbf\xd1\x80\xd1\x8f\xd0\xbc\xd1\x83\xd1\x8e, \xd1\x80\xd0\xb0\xd0\xb7\xd0\xbc\xd0\xb5\xd1\x80\xd0\xb0\xd0\xbc\xd0\xb8 \xd0\xbf\xd1\x83\xd1\x82\xd0\xb5\xd1\x88\xd0\xb5\xd1\x81\xd1\x82\xd0\xb2\xd0\xb5\xd0\xbd\xd0\xbd\xd0\xb8\xd0\xba\xd0\xbe\xd0\xb2 \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xbd\xd0\xbe \xd0\xbf\xd1\x80\xd0\xb5\xd0\xbd\xd0\xb5\xd0\xb1\xd1\x80\xd0\xb5\xd1\x87\xd1\x8c, \xd1\x81\xd1\x87\xd0\xb8\xd1\x82\xd0\xb0\xd1\x8f \xd0\xb8\xd1\x85 \xd1\x82\xd0\xbe\xd1\x87\xd0\xba\xd0\xb0\xd0\xbc\xd0\xb8.\xd0\x92\xd0\xbe\xd0\xb4\xd0\xb8\xd1\x82\xd0\xb5\xd0\xbb\xd1\x8c \xd0\xb0\xd0\xb2\xd1\x82\xd0\xbe\xd0\xb1\xd1\x83\xd1\x81\xd0\xb0 \xd0\x92\xd0\xb0\xd1\x81\xd0\xb8\xd0\xbb\xd0\xb8\xd0\xb9, \xd0\xb1\xd0\xbb\xd0\xb0\xd0\xb3\xd0\xbe\xd0\xb4\xd0\xb0\xd1\x80\xd1\x8f \xd0\xbc\xd0\xbe\xd0\xb1\xd0\xb8\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe\xd0\xbc\xd1\x83 \xd0\xbf\xd1\x80\xd0\xb8\xd0\xbb\xd0\xbe\xd0\xb6\xd0\xb5\xd0\xbd\xd0\xb8\xd1\x8e, \xd0\xb7\xd0\xbd\xd0\xb0\xd0\xb5\xd1\x82 \xd0\xb4\xd0\xbb\xd1\x8f \xd0\xba\xd0\xb0\xd0\xb6\xd0\xb4\xd0\xbe\xd0\xb3\xd0\xbe \xd0\xbf\xd1\x83\xd1\x82\xd0\xb5\xd1\x88\xd0\xb5\xd1\x81\xd1\x82\xd0\xb2\xd0\xb5\xd0\xbd\xd0\xbd\xd0\xb8\xd0\xba\xd0\xb0 \xd1\x82\xd0\xbe\xd1\x87\xd0\xba\xd1\x83 xi, \xd0\xb2 \xd0\xba\xd0\xbe\xd1\x82\xd0\xbe\xd1\x80\xd0\xbe\xd0\xb9 \xd1\x82\xd0\xbe\xd1\x82 \xd1\x81\xd1\x82\xd0\xbe\xd0\xb8\xd1\x82. \xd0\x9a\xd1\x80\xd0\xbe\xd0\xbc\xd0\xb5 \xd1\x82\xd0\xbe\xd0\xb3\xd0\xbe, \xd0\xbe\xd0\xbd \xd0\xb7\xd0\xbd\xd0\xb0\xd0\xb5\xd1\x82 \xd1\x80\xd0\xb0\xd1\x81\xd1\x81\xd1\x82\xd0\xbe\xd1\x8f\xd0\xbd\xd0\xb8\xd0\xb5 di, \xd0\xba\xd0\xbe\xd1\x82\xd0\xbe\xd1\x80\xd0\xbe\xd0\xb5 i-\xd0\xb9 \xd0\xbf\xd1\x83\xd1\x82\xd0\xb5\xd1\x88\xd0\xb5\xd1\x81\xd1\x82\xd0\xb2\xd0\xb5\xd0\xbd\xd0\xbd\xd0\xb8\xd0\xba \xd1\x85\xd0\xbe\xd1\x87\xd0\xb5\xd1\x82 \xd0\xbf\xd1\x80\xd0\xbe\xd0\xb5\xd1\x85\xd0\xb0\xd1\x82\xd1\x8c \xd0\xbd\xd0\xb0 \xd0\xb0\xd0\xb2\xd1\x82\xd0\xbe\xd0\xb1\xd1\x83\xd1\x81\xd0\xb5. \xd0\xa2\xd0\xb0\xd0\xba\xd0\xb8\xd0\xbc \xd0\xbe\xd0\xb1\xd1\x80\xd0\xb0\xd0\xb7\xd0\xbe\xd0\xbc, i-\xd0\xb9 \xd0\xbf\xd1\x83\xd1\x82\xd0\xb5\xd1\x88\xd0\xb5\xd1\x81\xd1\x82\xd0\xb2\xd0\xb5\xd0\xbd\xd0\xbd\xd0\xb8\xd0\xba \xd0\xbf\xd0\xbb\xd0\xb0\xd0\xbd\xd0\xb8\xd1\x80\xd1\x83\xd0\xb5\xd1\x82 \xd0\xb2\xd1\x8b\xd0\xb9\xd1\x82\xd0\xb8 \xd0\xb8\xd0\xb7 \xd0\xb0\xd0\xb2\xd1\x82\xd0\xbe\xd0\xb1\xd1\x83\xd1\x81\xd0\xb0 \xd0\xb2 \xd1\x82\xd0\xbe\xd1\x87\xd0\xba\xd0\xb5 xi\xe2\x80\x89+\xe2\x80\x89di. \xd0\xa2\xd0\xb5\xd0\xbf\xd0\xb5\xd1\x80\xd1\x8c \xd0\x92\xd0\xb0\xd1\x81\xd0\xb8\xd0\xbb\xd0\xb8\xd0\xb9 \xd1\x85\xd0\xbe\xd1\x87\xd0\xb5\xd1\x82 \xd1\x80\xd0\xb5\xd1\x88\xd0\xb8\xd1\x82\xd1\x8c, \xd0\xba\xd0\xbe\xd0\xb3\xd0\xbe \xd0\xb8\xd0\xb7 \xd0\xbf\xd1\x83\xd1\x82\xd0\xb5\xd1\x88\xd0\xb5\xd1\x81\xd1\x82\xd0\xb2\xd0\xb5\xd0\xbd\xd0\xbd\xd0\xb8\xd0\xba\xd0\xbe\xd0\xb2 \xd0\xbe\xd0\xbd \xd0\xbf\xd0\xbe\xd0\xb4\xd0\xb2\xd0\xb5\xd0\xb7\xd1\x91\xd1\x82, \xd0\xb0 \xd0\xba\xd0\xbe\xd0\xb3\xd0\xbe \xd0\xbe\xd1\x81\xd1\x82\xd0\xb0\xd0\xb2\xd0\xb8\xd1\x82 \xd0\xbf\xd1\x8b\xd0\xbb\xd0\xb8\xd1\x82\xd1\x8c\xd1\x81\xd1\x8f \xd1\x83 \xd0\xb4\xd0\xbe\xd1\x80\xd0\xbe\xd0\xb3\xd0\xb8.\xd0\x92\xd0\xb0\xd1\x81\xd0\xb8\xd0\xbb\xd0\xb8\xd0\xb9 \xd1\x80\xd0\xb5\xd1\x88\xd0\xb8\xd0\xbb, \xd1\x87\xd1\x82\xd0\xbe \xd1\x81\xd0\xb5\xd0\xb3\xd0\xbe\xd0\xb4\xd0\xbd\xd1\x8f \xd0\xbe\xd0\xbd \xd0\xb4\xd0\xbe\xd0\xbb\xd0\xb6\xd0\xb5\xd0\xbd \xd1\x85\xd0\xbe\xd1\x80\xd0\xbe\xd1\x88\xd0\xbe \xd0\xb7\xd0\xb0\xd1\x80\xd0\xb0\xd0\xb1\xd0\xbe\xd1\x82\xd0\xb0\xd1\x82\xd1\x8c, \xd0\xbf\xd0\xbe\xd1\x8d\xd1\x82\xd0\xbe\xd0\xbc\xd1\x83 \xd1\x80\xd0\xb5\xd1\x88\xd0\xb8\xd0\xbb \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb5\xd0\xb2\xd0\xb5\xd0\xb7\xd1\x82\xd0\xb8 \xd0\xb2 \xd1\x82\xd0\xbe\xd1\x87\xd0\xbd\xd0\xbe\xd1\x81\xd1\x82\xd0\xb8 a \xd0\xbf\xd1\x83\xd1\x82\xd0\xb5\xd1\x88\xd0\xb5\xd1\x81\xd1\x82\xd0\xb2\xd0\xb5\xd0\xbd\xd0\xbd\xd0\xb8\xd0\xba\xd0\xbe\xd0\xb2. \xd0\x92 \xd0\xb0\xd0\xb2\xd1\x82\xd0\xbe\xd0\xbf\xd0\xb0\xd1\x80\xd0\xba\xd0\xb5 \xd0\xb5\xd1\x81\xd1\x82\xd1\x8c \xd0\xb0\xd0\xb2\xd1\x82\xd0\xbe\xd0\xb1\xd1\x83\xd1\x81\xd1\x8b \xd0\xbb\xd1\x8e\xd0\xb1\xd1\x8b\xd1\x85 \xd0\xb2\xd0\xb8\xd0\xb4\xd0\xbe\xd0\xb2. \xd0\xa7\xd0\xb5\xd0\xbc \xd0\xb1\xd0\xbe\xd0\xbb\xd1\x8c\xd1\x88\xd0\xb5 \xd0\xbc\xd0\xb5\xd1\x81\xd1\x82 \xd0\xb2 \xd0\xb0\xd0\xb2\xd1\x82\xd0\xbe\xd0\xb1\xd1\x83\xd1\x81\xd0\xb5, \xd1\x82\xd0\xb5\xd0\xbc \xd0\xb4\xd0\xbe\xd1\x80\xd0\xbe\xd0\xb6\xd0\xb5 \xd1\x81\xd1\x82\xd0\xbe\xd0\xb8\xd1\x82 \xd0\xb5\xd0\xb3\xd0\xbe \xd0\xb0\xd1\x80\xd0\xb5\xd0\xbd\xd0\xb4\xd0\xb0.\xd0\x9f\xd0\xbe\xd0\xbc\xd0\xbe\xd0\xb3\xd0\xb8\xd1\x82\xd0\xb5 \xd0\x92\xd0\xb0\xd1\x81\xd0\xb8\xd0\xbb\xd0\xb8\xd1\x8e \xd0\xbe\xd0\xbf\xd1\x80\xd0\xb5\xd0\xb4\xd0\xb5\xd0\xbb\xd0\xb8\xd1\x82\xd1\x8c \xd0\xbc\xd0\xb8\xd0\xbd\xd0\xb8\xd0\xbc\xd0\xb0\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe\xd0\xb5 \xd0\xba\xd0\xbe\xd0\xbb\xd0\xb8\xd1\x87\xd0\xb5\xd1\x81\xd1\x82\xd0\xb2\xd0\xbe \xd0\xbf\xd0\xb0\xd1\x81\xd1\x81\xd0\xb0\xd0\xb6\xd0\xb8\xd1\x80\xd1\x81\xd0\xba\xd0\xb8\xd1\x85 \xd0\xbc\xd0\xb5\xd1\x81\xd1\x82 \xd0\xb2 \xd0\xb0\xd0\xb2\xd1\x82\xd0\xbe\xd0\xb1\xd1\x83\xd1\x81\xd0\xb5, \xd0\xba\xd0\xbe\xd1\x82\xd0\xbe\xd1\x80\xd1\x8b\xd1\x85 \xd0\xb1\xd1\x83\xd0\xb4\xd0\xb5\xd1\x82 \xd0\xb4\xd0\xbe\xd1\x81\xd1\x82\xd0\xb0\xd1\x82\xd0\xbe\xd1\x87\xd0\xbd\xd0\xbe \xd0\xb4\xd0\xbb\xd1\x8f \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb5\xd0\xb2\xd0\xbe\xd0\xb7\xd0\xba\xd0\xb8 \xd1\x80\xd0\xbe\xd0\xb2\xd0\xbd\xd0\xbe a \xd0\xbf\xd1\x83\xd1\x82\xd0\xb5\xd1\x88\xd0\xb5\xd1\x81\xd1\x82\xd0\xb2\xd0\xb5\xd0\xbd\xd0\xbd\xd0\xb8\xd0\xba\xd0\xbe\xd0\xb2. \xd0\x9d\xd0\xb8 \xd0\xb2 \xd0\xba\xd0\xb0\xd0\xba\xd0\xbe\xd0\xb9 \xd0\xbc\xd0\xbe\xd0\xbc\xd0\xb5\xd0\xbd\xd1\x82 \xd0\xb2\xd1\x80\xd0\xb5\xd0\xbc\xd0\xb5\xd0\xbd\xd0\xb8 \xd0\xb2 \xd0\xb0\xd0\xb2\xd1\x82\xd0\xbe\xd0\xb1\xd1\x83\xd1\x81\xd0\xb5 \xd0\xbd\xd0\xb5 \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xb5\xd1\x82 \xd0\xb1\xd1\x8b\xd1\x82\xd1\x8c \xd0\xbf\xd1\x83\xd1\x82\xd0\xb5\xd1\x88\xd0\xb5\xd1\x81\xd1\x82\xd0\xb2\xd0\xb5\xd0\xbd\xd0\xbd\xd0\xb8\xd0\xba\xd0\xbe\xd0\xb2 \xd0\xb1\xd0\xbe\xd0\xbb\xd1\x8c\xd1\x88\xd0\xb5, \xd1\x87\xd0\xb5\xd0\xbc \xd0\xba\xd0\xbe\xd0\xbb\xd0\xb8\xd1\x87\xd0\xb5\xd1\x81\xd1\x82\xd0\xb2\xd0\xbe \xd0\xbf\xd0\xb0\xd1\x81\xd1\x81\xd0\xb0\xd0\xb6\xd0\xb8\xd1\x80\xd1\x81\xd0\xba\xd0\xb8\xd1\x85 \xd0\xbc\xd0\xb5\xd1\x81\xd1\x82 \xd0\xb2 \xd0\xb0\xd0\xb2\xd1\x82\xd0\xbe\xd0\xb1\xd1\x83\xd1\x81\xd0\xb5. \xd0\x92\xd0\xb0\xd1\x81\xd0\xb8\xd0\xbb\xd0\xb8\xd0\xb9 \xd1\x81\xd0\xb0\xd0\xbc \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xb5\xd1\x82 \xd1\x80\xd0\xb5\xd1\x88\xd0\xb8\xd1\x82\xd1\x8c \xd0\xba\xd0\xb0\xd0\xba\xd0\xbe\xd0\xb5 \xd0\xba\xd0\xbe\xd0\xbd\xd0\xba\xd1\x80\xd0\xb5\xd1\x82\xd0\xbd\xd0\xbe \xd0\xbf\xd0\xbe\xd0\xb4\xd0\xbc\xd0\xbd\xd0\xbe\xd0\xb6\xd0\xb5\xd1\x81\xd1\x82\xd0\xb2\xd0\xbe \xd0\xb8\xd0\xb7 a \xd0\xbf\xd1\x83\xd1\x82\xd0\xb5\xd1\x88\xd0\xb5\xd1\x81\xd1\x82\xd0\xb2\xd0\xb5\xd0\xbd\xd0\xbd\xd0\xb8\xd0\xba\xd0\xbe\xd0\xb2 \xd0\xbe\xd0\xbd \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb5\xd0\xb2\xd0\xb5\xd0\xb7\xd1\x91\xd1\x82 \xd0\xbd\xd0\xb0 \xd0\xb0\xd0\xb2\xd1\x82\xd0\xbe\xd0\xb1\xd1\x83\xd1\x81\xd0\xb5.\xd0\xa1\xd1\x87\xd0\xb8\xd1\x82\xd0\xb0\xd0\xb9\xd1\x82\xd0\xb5, \xd1\x87\xd1\x82\xd0\xbe \xd0\xb0\xd0\xb2\xd1\x82\xd0\xbe\xd0\xb1\xd1\x83\xd1\x81 \xd0\xb2\xd1\x81\xd0\xb5\xd0\xb3\xd0\xb4\xd0\xb0 \xd0\xb5\xd0\xb4\xd0\xb5\xd1\x82 \xd1\x81\xd0\xbb\xd0\xb5\xd0\xb2\xd0\xb0 \xd0\xbd\xd0\xb0\xd0\xbf\xd1\x80\xd0\xb0\xd0\xb2\xd0\xbe (\xd0\xbe\xd1\x82 \xd0\xbc\xd0\xb5\xd0\xbd\xd1\x8c\xd1\x88\xd0\xb8\xd1\x85 \xd0\xba\xd0\xbe\xd0\xbe\xd1\x80\xd0\xb4\xd0\xb8\xd0\xbd\xd0\xb0\xd1\x82 \xd0\xba \xd0\xb1\xd0\xbe\xd0\xbb\xd1\x8c\xd1\x88\xd0\xb8\xd0\xbc) \xd0\xb8 \xd0\xbd\xd0\xb0\xd1\x87\xd0\xb8\xd0\xbd\xd0\xb0\xd0\xb5\xd1\x82 \xd1\x81\xd0\xb2\xd0\xbe\xd0\xb9 \xd0\xbf\xd1\x83\xd1\x82\xd1\x8c \xd0\xbb\xd0\xb5\xd0\xb2\xd0\xb5\xd0\xb5 \xd1\x81\xd0\xb0\xd0\xbc\xd0\xbe\xd0\xb3\xd0\xbe \xd0\xbb\xd0\xb5\xd0\xb2\xd0\xbe\xd1\x81\xd1\x82\xd0\xbe\xd1\x8f\xd1\x89\xd0\xb5\xd0\xb3\xd0\xbe \xd0\xbf\xd1\x83\xd1\x82\xd0\xb5\xd1\x88\xd0\xb5\xd1\x81\xd1\x82\xd0\xb2\xd0\xb5\xd0\xbd\xd0\xbd\xd0\xb8\xd0\xba\xd0\xb0. \xd0\x95\xd1\x81\xd0\xbb\xd0\xb8 \xd0\xb2 \xd0\xbe\xd0\xb4\xd0\xbd\xd0\xbe\xd0\xb9 \xd1\x82\xd0\xbe\xd1\x87\xd0\xba\xd0\xb5 \xd0\xba\xd0\xb0\xd0\xba\xd0\xbe\xd0\xb9-\xd1\x82\xd0\xbe \xd0\xbf\xd1\x83\xd1\x82\xd0\xb5\xd1\x88\xd0\xb5\xd1\x81\xd1\x82\xd0\xb2\xd0\xb5\xd0\xbd\xd0\xbd\xd0\xb8\xd0\xba \xd0\xb4\xd0\xbe\xd0\xbb\xd0\xb6\xd0\xb5\xd0\xbd \xd0\xb2\xd1\x8b\xd0\xb9\xd1\x82\xd0\xb8 \xd0\xb8\xd0\xb7 \xd0\xb0\xd0\xb2\xd1\x82\xd0\xbe\xd0\xb1\xd1\x83\xd1\x81\xd0\xb0, \xd0\xb0 \xd0\xb4\xd1\x80\xd1\x83\xd0\xb3\xd0\xbe\xd0\xb9 \xd0\xb2\xd0\xbe\xd0\xb9\xd1\x82\xd0\xb8, \xd1\x81\xd1\x87\xd0\xb8\xd1\x82\xd0\xb0\xd0\xb9\xd1\x82\xd0\xb5, \xd1\x87\xd1\x82\xd0\xbe \xd1\x81\xd0\xbd\xd0\xb0\xd1\x87\xd0\xb0\xd0\xbb\xd0\xb0 \xd0\xbf\xd1\x80\xd0\xbe\xd0\xb8\xd0\xb7\xd0\xbe\xd0\xb9\xd0\xb4\xd0\xb5\xd1\x82 \xd0\xb2\xd1\x8b\xd1\x85\xd0\xbe\xd0\xb4 \xd0\xbe\xd0\xb4\xd0\xbd\xd0\xbe\xd0\xb3\xd0\xbe \xd0\xbf\xd1\x83\xd1\x82\xd0\xb5\xd1\x88\xd0\xb5\xd1\x81\xd1\x82\xd0\xb2\xd0\xb5\xd0\xbd\xd0\xbd\xd0\xb8\xd0\xba\xd0\xb0 \xd0\xb8\xd0\xb7 \xd0\xb0\xd0\xb2\xd1\x82\xd0\xbe\xd0\xb1\xd1\x83\xd1\x81\xd0\xb0, \xd0\xb0 \xd0\xb7\xd0\xb0\xd1\x82\xd0\xb5\xd0\xbc \xd0\xb4\xd1\x80\xd1\x83\xd0\xb3\xd0\xbe\xd0\xb9 \xd0\xbf\xd1\x83\xd1\x82\xd0\xb5\xd1\x88\xd0\xb5\xd1\x81\xd1\x82\xd0\xb2\xd0\xb5\xd0\xbd\xd0\xbd\xd0\xb8\xd0\xba \xd1\x81\xd0\xbc\xd0\xbe\xd0\xb6\xd0\xb5\xd1\x82 \xd0\xb7\xd0\xb0\xd0\xb9\xd1\x82\xd0\xb8 \xd0\xb2 \xd0\xb0\xd0\xb2\xd1\x82\xd0\xbe\xd0\xb1\xd1\x83\xd1\x81." 2100
649D "\xd0\x94\xd0\xb5\xd1\x84\xd1\x80\xd0\xb0\xd0\xb3\xd0\xbc\xd0\xb5\xd0\xbd\xd1\x82\xd0\xb0\xd1\x86\xd0\xb8\xd1\x8f \xd0\xbf\xd0\xb0\xd0\xbc\xd1\x8f\xd1\x82\xd0\xb8" "constructive algorithms,greedy,implementation" "\xd0\x9f\xd0\xb0\xd0\xbc\xd1\x8f\xd1\x82\xd1\x8c \xd0\xba\xd0\xbe\xd0\xbc\xd0\xbf\xd1\x8c\xd1\x8e\xd1\x82\xd0\xb5\xd1\x80\xd0\xb0 \xd1\x81\xd0\xbe\xd1\x81\xd1\x82\xd0\xbe\xd0\xb8\xd1\x82 \xd0\xb8\xd0\xb7 n \xd1\x8f\xd1\x87\xd0\xb5\xd0\xb5\xd0\xba, \xd0\xba\xd0\xbe\xd1\x82\xd0\xbe\xd1\x80\xd1\x8b\xd0\xb5 \xd0\xb2\xd1\x8b\xd1\x81\xd1\x82\xd1\x80\xd0\xbe\xd0\xb5\xd0\xbd\xd1\x8b \xd0\xb2 \xd1\x80\xd1\x8f\xd0\xb4. \xd0\x9f\xd1\x80\xd0\xbe\xd0\xbd\xd1\x83\xd0\xbc\xd0\xb5\xd1\x80\xd1\x83\xd0\xb5\xd0\xbc \xd1\x8f\xd1\x87\xd0\xb5\xd0\xb9\xd0\xba\xd0\xb8 \xd0\xbe\xd1\x82 1 \xd0\xb4\xd0\xbe n \xd1\x81\xd0\xbb\xd0\xb5\xd0\xb2\xd0\xb0 \xd0\xbd\xd0\xb0\xd0\xbf\xd1\x80\xd0\xb0\xd0\xb2\xd0\xbe. \xd0\x9f\xd1\x80\xd0\xbe \xd0\xba\xd0\xb0\xd0\xb6\xd0\xb4\xd1\x83\xd1\x8e \xd1\x8f\xd1\x87\xd0\xb5\xd0\xb9\xd0\xba\xd1\x83 \xd0\xb8\xd0\xb7\xd0\xb2\xd0\xb5\xd1\x81\xd1\x82\xd0\xbd\xd0\xbe, \xd1\x81\xd0\xb2\xd0\xbe\xd0\xb1\xd0\xbe\xd0\xb4\xd0\xbd\xd0\xb0 \xd0\xbe\xd0\xbd\xd0\xb0 \xd0\xb8\xd0\xbb\xd0\xb8 \xd0\xbf\xd1\x80\xd0\xb8\xd0\xbd\xd0\xb0\xd0\xb4\xd0\xbb\xd0\xb5\xd0\xb6\xd0\xb8\xd1\x82 \xd0\xba\xd0\xb0\xd0\xba\xd0\xbe\xd0\xbc\xd1\x83-\xd0\xbb\xd0\xb8\xd0\xb1\xd0\xbe \xd0\xbf\xd1\x80\xd0\xbe\xd1\x86\xd0\xb5\xd1\x81\xd1\x81\xd1\x83 (\xd0\xb2 \xd1\x82\xd0\xb0\xd0\xba\xd0\xbe\xd0\xbc \xd1\x81\xd0\xbb\xd1\x83\xd1\x87\xd0\xb0\xd0\xb5 \xd0\xb8\xd0\xb7\xd0\xb2\xd0\xb5\xd1\x81\xd1\x82\xd0\xb5\xd0\xbd \xd0\xbf\xd1\x80\xd0\xbe\xd1\x86\xd0\xb5\xd1\x81\xd1\x81, \xd0\xba\xd0\xbe\xd1\x82\xd0\xbe\xd1\x80\xd0\xbe\xd0\xbc\xd1\x83 \xd0\xbe\xd0\xbd\xd0\xb0 \xd0\xbf\xd1\x80\xd0\xb8\xd0\xbd\xd0\xb0\xd0\xb4\xd0\xbb\xd0\xb5\xd0\xb6\xd0\xb8\xd1\x82).\xd0\x94\xd0\xbb\xd1\x8f \xd0\xba\xd0\xb0\xd0\xb6\xd0\xb4\xd0\xbe\xd0\xb3\xd0\xbe \xd0\xbf\xd1\x80\xd0\xbe\xd1\x86\xd0\xb5\xd1\x81\xd1\x81\xd0\xb0 \xd0\xb8\xd0\xb7\xd0\xb2\xd0\xb5\xd1\x81\xd1\x82\xd0\xbd\xd0\xbe, \xd1\x87\xd1\x82\xd0\xbe \xd0\xbf\xd1\x80\xd0\xb8\xd0\xbd\xd0\xb0\xd0\xb4\xd0\xbb\xd0\xb5\xd0\xb6\xd0\xb0\xd1\x89\xd0\xb8\xd0\xb5 \xd0\xb5\xd0\xbc\xd1\x83 \xd1\x8f\xd1\x87\xd0\xb5\xd0\xb9\xd0\xba\xd0\xb8 \xd0\xb7\xd0\xb0\xd0\xbd\xd0\xb8\xd0\xbc\xd0\xb0\xd1\x8e\xd1\x82 \xd0\xb2 \xd0\xbf\xd0\xb0\xd0\xbc\xd1\x8f\xd1\x82\xd0\xb8 \xd0\xbd\xd0\xb5\xd0\xbf\xd1\x80\xd0\xb5\xd1\x80\xd1\x8b\xd0\xb2\xd0\xbd\xd1\x8b\xd0\xb9 \xd1\x83\xd1\x87\xd0\xb0\xd1\x81\xd1\x82\xd0\xbe\xd0\xba. \xd0\xa1 \xd0\xbf\xd0\xbe\xd0\xbc\xd0\xbe\xd1\x89\xd1\x8c\xd1\x8e \xd0\xbe\xd0\xbf\xd0\xb5\xd1\x80\xd0\xb0\xd1\x86\xd0\xb8\xd0\xb9 \xd0\xb2\xd0\xb8\xd0\xb4\xd0\xb0 \xc2\xab\xd0\xbf\xd0\xb5\xd1\x80\xd0\xb5\xd0\xbf\xd0\xb8\xd1\x81\xd0\xb0\xd1\x82\xd1\x8c \xd0\xb4\xd0\xb0\xd0\xbd\xd0\xbd\xd1\x8b\xd0\xb5 \xd0\xb8\xd0\xb7 \xd0\xb7\xd0\xb0\xd0\xbd\xd1\x8f\xd1\x82\xd0\xbe\xd0\xb9 \xd1\x8f\xd1\x87\xd0\xb5\xd0\xb9\xd0\xba\xd0\xb8 \xd0\xb2 \xd1\x81\xd0\xb2\xd0\xbe\xd0\xb1\xd0\xbe\xd0\xb4\xd0\xbd\xd1\x83\xd1\x8e, \xd0\xb0 \xd0\xb7\xd0\xb0\xd0\xbd\xd1\x8f\xd1\x82\xd1\x83\xd1\x8e \xd1\x82\xd0\xb5\xd0\xbf\xd0\xb5\xd1\x80\xd1\x8c \xd1\x81\xd1\x87\xd0\xb8\xd1\x82\xd0\xb0\xd1\x82\xd1\x8c \xd1\x81\xd0\xb2\xd0\xbe\xd0\xb1\xd0\xbe\xd0\xb4\xd0\xbd\xd0\xbe\xd0\xb9\xc2\xbb \xd1\x82\xd1\x80\xd0\xb5\xd0\xb1\xd1\x83\xd0\xb5\xd1\x82\xd1\x81\xd1\x8f \xd1\x80\xd0\xb0\xd1\x81\xd0\xbf\xd0\xbe\xd0\xbb\xd0\xbe\xd0\xb6\xd0\xb8\xd1\x82\xd1\x8c \xd0\xb2\xd1\x81\xd0\xb5 \xd0\xbf\xd1\x80\xd0\xb8\xd0\xbd\xd0\xb0\xd0\xb4\xd0\xbb\xd0\xb5\xd0\xb6\xd0\xb0\xd1\x89\xd0\xb8\xd0\xb5 \xd0\xbf\xd1\x80\xd0\xbe\xd1\x86\xd0\xb5\xd1\x81\xd1\x81\xd0\xb0\xd0\xbc \xd1\x8f\xd1\x87\xd0\xb5\xd0\xb9\xd0\xba\xd0\xb8 \xd0\xb2 \xd0\xbd\xd0\xb0\xd1\x87\xd0\xb0\xd0\xbb\xd0\xb5 \xd0\xbf\xd0\xb0\xd0\xbc\xd1\x8f\xd1\x82\xd0\xb8 \xd0\xba\xd0\xbe\xd0\xbc\xd0\xbf\xd1\x8c\xd1\x8e\xd1\x82\xd0\xb5\xd1\x80\xd0\xb0. \xd0\x94\xd1\x80\xd1\x83\xd0\xb3\xd0\xb8\xd0\xbc\xd0\xb8 \xd1\x81\xd0\xbb\xd0\xbe\xd0\xb2\xd0\xb0\xd0\xbc\xd0\xb8, \xd0\xbb\xd1\x8e\xd0\xb1\xd0\xb0\xd1\x8f \xd1\x81\xd0\xb2\xd0\xbe\xd0\xb1\xd0\xbe\xd0\xb4\xd0\xbd\xd0\xb0\xd1\x8f \xd1\x8f\xd1\x87\xd0\xb5\xd0\xb9\xd0\xba\xd0\xb0 \xd0\xb4\xd0\xbe\xd0\xbb\xd0\xb6\xd0\xbd\xd0\xb0 \xd1\x80\xd0\xb0\xd1\x81\xd0\xbf\xd0\xbe\xd0\xbb\xd0\xb0\xd0\xb3\xd0\xb0\xd1\x82\xd1\x8c\xd1\x81\xd1\x8f \xd0\xbf\xd1\x80\xd0\xb0\xd0\xb2\xd0\xb5\xd0\xb5 (\xd0\xb8\xd0\xbc\xd0\xb5\xd1\x82\xd1\x8c \xd0\xb1\xd0\xbe\xd0\xbb\xd1\x8c\xd1\x88\xd0\xb8\xd0\xb9 \xd0\xbd\xd0\xbe\xd0\xbc\xd0\xb5\xd1\x80) \xd0\xbb\xd1\x8e\xd0\xb1\xd0\xbe\xd0\xb9 \xd0\xb7\xd0\xb0\xd0\xbd\xd1\x8f\xd1\x82\xd0\xbe\xd0\xb9.\xd0\x92\xd0\xb0\xd0\xbc \xd0\xbd\xd0\xb5\xd0\xbe\xd0\xb1\xd1\x85\xd0\xbe\xd0\xb4\xd0\xb8\xd0\xbc\xd0\xbe \xd0\xbd\xd0\xb0\xd0\xb9\xd1\x82\xd0\xb8 \xd0\xbc\xd0\xb8\xd0\xbd\xd0\xb8\xd0\xbc\xd0\xb0\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe\xd0\xb5 \xd0\xba\xd0\xbe\xd0\xbb\xd0\xb8\xd1\x87\xd0\xb5\xd1\x81\xd1\x82\xd0\xb2\xd0\xbe \xd0\xbe\xd0\xbf\xd0\xb5\xd1\x80\xd0\xb0\xd1\x86\xd0\xb8\xd0\xb9 \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb5\xd0\xbf\xd0\xb8\xd1\x81\xd1\x8b\xd0\xb2\xd0\xb0\xd0\xbd\xd0\xb8\xd1\x8f \xd0\xb4\xd0\xb0\xd0\xbd\xd0\xbd\xd1\x8b\xd1\x85 \xd0\xb8\xd0\xb7 \xd0\xbe\xd0\xb4\xd0\xbd\xd0\xbe\xd0\xb9 \xd1\x8f\xd1\x87\xd0\xb5\xd0\xb9\xd0\xba\xd0\xb8 \xd0\xb2 \xd0\xb4\xd1\x80\xd1\x83\xd0\xb3\xd1\x83\xd1\x8e, \xd1\x81 \xd0\xbf\xd0\xbe\xd0\xbc\xd0\xbe\xd1\x89\xd1\x8c\xd1\x8e \xd0\xba\xd0\xbe\xd1\x82\xd0\xbe\xd1\x80\xd1\x8b\xd1\x85 \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xbd\xd0\xbe \xd0\xb4\xd0\xbe\xd1\x81\xd1\x82\xd0\xb8\xd1\x87\xd1\x8c \xd0\xbe\xd0\xbf\xd0\xb8\xd1\x81\xd0\xb0\xd0\xbd\xd0\xbd\xd1\x8b\xd1\x85 \xd1\x83\xd1\x81\xd0\xbb\xd0\xbe\xd0\xb2\xd0\xb8\xd0\xb9. \xd0\x94\xd0\xbe\xd0\xbf\xd1\x83\xd1\x81\xd1\x82\xd0\xb8\xd0\xbc\xd0\xbe, \xd1\x87\xd1\x82\xd0\xbe \xd0\xbe\xd1\x82\xd0\xbd\xd0\xbe\xd1\x81\xd0\xb8\xd1\x82\xd0\xb5\xd0\xbb\xd1\x8c\xd0\xbd\xd1\x8b\xd0\xb9 \xd0\xbf\xd0\xbe\xd1\x80\xd1\x8f\xd0\xb4\xd0\xbe\xd0\xba \xd1\x8f\xd1\x87\xd0\xb5\xd0\xb5\xd0\xba \xd0\xb2 \xd0\xbf\xd0\xb0\xd0\xbc\xd1\x8f\xd1\x82\xd0\xb8 \xd0\xb4\xd0\xbb\xd1\x8f \xd0\xba\xd0\xb0\xd0\xb6\xd0\xb4\xd0\xbe\xd0\xb3\xd0\xbe \xd0\xb8\xd0\xb7 \xd0\xbf\xd1\x80\xd0\xbe\xd1\x86\xd0\xb5\xd1\x81\xd1\x81\xd0\xbe\xd0\xb2 \xd0\xb8\xd0\xb7\xd0\xbc\xd0\xb5\xd0\xbd\xd0\xb8\xd1\x82\xd1\x81\xd1\x8f \xd0\xbf\xd0\xbe\xd1\x81\xd0\xbb\xd0\xb5 \xd0\xb4\xd0\xb5\xd1\x84\xd1\x80\xd0\xb0\xd0\xb3\xd0\xbc\xd0\xb5\xd0\xbd\xd1\x82\xd0\xb0\xd1\x86\xd0\xb8\xd0\xb8, \xd0\xbd\xd0\xbe \xd0\xbe\xd1\x82\xd0\xbd\xd0\xbe\xd1\x81\xd0\xb8\xd1\x82\xd0\xb5\xd0\xbb\xd1\x8c\xd0\xbd\xd1\x8b\xd0\xb9 \xd0\xbf\xd0\xbe\xd1\x80\xd1\x8f\xd0\xb4\xd0\xbe\xd0\xba \xd1\x81\xd0\xb0\xd0\xbc\xd0\xb8\xd1\x85 \xd0\xbf\xd1\x80\xd0\xbe\xd1\x86\xd0\xb5\xd1\x81\xd1\x81\xd0\xbe\xd0\xb2 \xd0\xb4\xd0\xbe\xd0\xbb\xd0\xb6\xd0\xb5\xd0\xbd \xd0\xbe\xd1\x81\xd1\x82\xd0\xb0\xd1\x82\xd1\x8c\xd1\x81\xd1\x8f \xd0\xb1\xd0\xb5\xd0\xb7 \xd0\xb8\xd0\xb7\xd0\xbc\xd0\xb5\xd0\xbd\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb9. \xd0\xad\xd1\x82\xd0\xbe \xd0\xb7\xd0\xbd\xd0\xb0\xd1\x87\xd0\xb8\xd1\x82, \xd1\x87\xd1\x82\xd0\xbe \xd0\xb5\xd1\x81\xd0\xbb\xd0\xb8 \xd0\xb2\xd1\x81\xd0\xb5 \xd1\x8f\xd1\x87\xd0\xb5\xd0\xb9\xd0\xba\xd0\xb8, \xd0\xbf\xd1\x80\xd0\xb8\xd0\xbd\xd0\xb0\xd0\xb4\xd0\xbb\xd0\xb5\xd0\xb6\xd0\xb0\xd1\x89\xd0\xb8\xd0\xb5 \xd0\xbf\xd1\x80\xd0\xbe\xd1\x86\xd0\xb5\xd1\x81\xd1\x81\xd1\x83 i, \xd0\xbd\xd0\xb0\xd1\x85\xd0\xbe\xd0\xb4\xd0\xb8\xd0\xbb\xd0\xb8\xd1\x81\xd1\x8c \xd0\xb2 \xd0\xbf\xd0\xb0\xd0\xbc\xd1\x8f\xd1\x82\xd0\xb8 \xd1\x80\xd0\xb0\xd0\xbd\xd1\x8c\xd1\x88\xd0\xb5 \xd0\xb2\xd1\x81\xd0\xb5\xd1\x85 \xd1\x8f\xd1\x87\xd0\xb5\xd0\xb5\xd0\xba \xd0\xbf\xd1\x80\xd0\xbe\xd1\x86\xd0\xb5\xd1\x81\xd1\x81\xd0\xb0 j, \xd1\x82\xd0\xbe \xd0\xb8 \xd0\xbf\xd0\xbe\xd1\x81\xd0\xbb\xd0\xb5 \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb5\xd0\xbc\xd0\xb5\xd1\x89\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb9 \xd1\x8d\xd1\x82\xd0\xbe \xd1\x83\xd1\x81\xd0\xbb\xd0\xbe\xd0\xb2\xd0\xb8\xd0\xb5 \xd0\xb4\xd0\xbe\xd0\xbb\xd0\xb6\xd0\xbd\xd0\xbe \xd0\xb2\xd1\x8b\xd0\xbf\xd0\xbe\xd0\xbb\xd0\xbd\xd1\x8f\xd1\x82\xd1\x8c\xd1\x81\xd1\x8f.\xd0\xa1\xd1\x87\xd0\xb8\xd1\x82\xd0\xb0\xd0\xb9\xd1\x82\xd0\xb5, \xd1\x87\xd1\x82\xd0\xbe \xd0\xbd\xd0\xbe\xd0\xbc\xd0\xb5\xd1\x80\xd0\xb0 \xd0\xb2\xd1\x81\xd0\xb5\xd1\x85 \xd0\xbf\xd1\x80\xd0\xbe\xd1\x86\xd0\xb5\xd1\x81\xd1\x81\xd0\xbe\xd0\xb2 \xd1\x83\xd0\xbd\xd0\xb8\xd0\xba\xd0\xb0\xd0\xbb\xd1\x8c\xd0\xbd\xd1\x8b, \xd1\x85\xd0\xbe\xd1\x82\xd1\x8f \xd0\xb1\xd1\x8b \xd0\xbe\xd0\xb4\xd0\xbd\xd0\xb0 \xd1\x8f\xd1\x87\xd0\xb5\xd0\xb9\xd0\xba\xd0\xb0 \xd0\xbf\xd0\xb0\xd0\xbc\xd1\x8f\xd1\x82\xd0\xb8 \xd0\xb7\xd0\xb0\xd0\xbd\xd1\x8f\xd1\x82\xd0\xb0 \xd0\xba\xd0\xb0\xd0\xba\xd0\xb8\xd0\xbc-\xd0\xbb\xd0\xb8\xd0\xb1\xd0\xbe \xd0\xbf\xd1\x80\xd0\xbe\xd1\x86\xd0\xb5\xd1\x81\xd1\x81\xd0\xbe\xd0\xbc." 1600
649C "\xd0\x9f\xd0\xb5\xd1\x87\xd0\xb0\xd1\x82\xd1\x8c \xd1\x83\xd1\x81\xd0\xbb\xd0\xbe\xd0\xb2\xd0\xb8\xd0\xb9" "constructive algorithms,greedy,sortings" "\xd0\x9d\xd0\xb0 \xd1\x82\xd1\x80\xd0\xb5\xd0\xbd\xd0\xb8\xd1\x80\xd0\xbe\xd0\xb2\xd0\xba\xd1\x83 \xd0\xbf\xd0\xbe \xd0\xbf\xd0\xbe\xd0\xb4\xd0\xb3\xd0\xbe\xd1\x82\xd0\xbe\xd0\xb2\xd0\xba\xd0\xb5 \xd0\xba \xd1\x81\xd0\xbe\xd1\x80\xd0\xb5\xd0\xb2\xd0\xbd\xd0\xbe\xd0\xb2\xd0\xb0\xd0\xbd\xd0\xb8\xd1\x8f\xd0\xbc \xd0\xbf\xd0\xbe \xd0\xbf\xd1\x80\xd0\xbe\xd0\xb3\xd1\x80\xd0\xb0\xd0\xbc\xd0\xbc\xd0\xb8\xd1\x80\xd0\xbe\xd0\xb2\xd0\xb0\xd0\xbd\xd0\xb8\xd1\x8e \xd0\xbf\xd1\x80\xd0\xb8\xd1\x88\xd0\xbb\xd0\xb8 n \xd0\xba\xd0\xbe\xd0\xbc\xd0\xb0\xd0\xbd\xd0\xb4. \xd0\xa2\xd1\x80\xd0\xb5\xd0\xbd\xd0\xb5\xd1\x80 \xd0\xb4\xd0\xbb\xd1\x8f \xd0\xba\xd0\xb0\xd0\xb6\xd0\xb4\xd0\xbe\xd0\xb9 \xd0\xba\xd0\xbe\xd0\xbc\xd0\xb0\xd0\xbd\xd0\xb4\xd1\x8b \xd0\xbf\xd0\xbe\xd0\xb4\xd0\xbe\xd0\xb1\xd1\x80\xd0\xb0\xd0\xbb \xd1\x82\xd1\x80\xd0\xb5\xd0\xbd\xd0\xb8\xd1\x80\xd0\xbe\xd0\xb2\xd0\xba\xd1\x83, \xd0\xba\xd0\xbe\xd0\xbc\xd0\xbf\xd0\xbb\xd0\xb5\xd0\xba\xd1\x82 \xd0\xb7\xd0\xb0\xd0\xb4\xd0\xb0\xd1\x87 \xd0\xb4\xd0\xbb\xd1\x8f i-\xd0\xb9 \xd0\xba\xd0\xbe\xd0\xbc\xd0\xb0\xd0\xbd\xd0\xb4\xd1\x8b \xd0\xb7\xd0\xb0\xd0\xbd\xd0\xb8\xd0\xbc\xd0\xb0\xd0\xb5\xd1\x82 ai \xd1\x81\xd1\x82\xd1\x80\xd0\xb0\xd0\xbd\xd0\xb8\xd1\x86. \xd0\x92 \xd1\x80\xd0\xb0\xd1\x81\xd0\xbf\xd0\xbe\xd1\x80\xd1\x8f\xd0\xb6\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb8 \xd1\x82\xd1\x80\xd0\xb5\xd0\xbd\xd0\xb5\xd1\x80\xd0\xb0 \xd0\xb5\xd1\x81\xd1\x82\xd1\x8c x \xd0\xbb\xd0\xb8\xd1\x81\xd1\x82\xd0\xbe\xd0\xb2 \xd0\xb1\xd1\x83\xd0\xbc\xd0\xb0\xd0\xb3\xd0\xb8, \xd1\x83 \xd0\xba\xd0\xbe\xd1\x82\xd0\xbe\xd1\x80\xd1\x8b\xd1\x85 \xd0\xbe\xd0\xb1\xd0\xb5 \xd1\x81\xd1\x82\xd0\xbe\xd1\x80\xd0\xbe\xd0\xbd\xd1\x8b \xd1\x87\xd0\xb8\xd1\x81\xd1\x82\xd1\x8b\xd0\xb5, \xd0\xb8 y \xd0\xbb\xd0\xb8\xd1\x81\xd1\x82\xd0\xbe\xd0\xb2, \xd1\x83 \xd0\xba\xd0\xbe\xd1\x82\xd0\xbe\xd1\x80\xd1\x8b\xd1\x85 \xd1\x82\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xba\xd0\xbe \xd0\xbe\xd0\xb4\xd0\xbd\xd0\xb0 \xd1\x81\xd1\x82\xd0\xbe\xd1\x80\xd0\xbe\xd0\xbd\xd0\xb0 \xd1\x87\xd0\xb8\xd1\x81\xd1\x82\xd0\xb0\xd1\x8f. \xd0\x9f\xd1\x80\xd0\xb8 \xd0\xbf\xd0\xb5\xd1\x87\xd0\xb0\xd1\x82\xd0\xb8 \xd1\x83\xd1\x81\xd0\xbb\xd0\xbe\xd0\xb2\xd0\xb8\xd1\x8f \xd0\xbd\xd0\xb0 \xd0\xbb\xd0\xb8\xd1\x81\xd1\x82\xd0\xb5 \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb2\xd0\xbe\xd0\xb3\xd0\xbe \xd1\x82\xd0\xb8\xd0\xbf\xd0\xb0 \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xbd\xd0\xbe \xd0\xbd\xd0\xb0\xd0\xbf\xd0\xb5\xd1\x87\xd0\xb0\xd1\x82\xd0\xb0\xd1\x82\xd1\x8c \xd0\xb4\xd0\xb2\xd0\xb5 \xd1\x81\xd1\x82\xd1\x80\xd0\xb0\xd0\xbd\xd0\xb8\xd1\x86\xd1\x8b \xd0\xb8\xd0\xb7 \xd1\x83\xd1\x81\xd0\xbb\xd0\xbe\xd0\xb2\xd0\xb8\xd0\xb9 \xd0\xb7\xd0\xb0\xd0\xb4\xd0\xb0\xd1\x87, \xd0\xb0 \xd0\xbf\xd1\x80\xd0\xb8 \xd0\xbf\xd0\xb5\xd1\x87\xd0\xb0\xd1\x82\xd0\xb8 \xd0\xbd\xd0\xb0 \xd0\xbb\xd0\xb8\xd1\x81\xd1\x82\xd0\xb5 \xd0\xb2\xd1\x82\xd0\xbe\xd1\x80\xd0\xbe\xd0\xb3\xd0\xbe \xd1\x82\xd0\xb8\xd0\xbf\xd0\xb0 \xe2\x80\x94 \xd1\x82\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xba\xd0\xbe \xd0\xbe\xd0\xb4\xd0\xbd\xd1\x83. \xd0\x9a\xd0\xbe\xd0\xbd\xd0\xb5\xd1\x87\xd0\xbd\xd0\xbe, \xd0\xbd\xd0\xb0 \xd0\xbb\xd0\xb8\xd1\x81\xd1\x82\xd0\xb5 \xd0\xbd\xd0\xb5\xd0\xbb\xd1\x8c\xd0\xb7\xd1\x8f \xd0\xbf\xd0\xb5\xd1\x87\xd0\xb0\xd1\x82\xd0\xb0\xd1\x82\xd1\x8c \xd1\x83\xd1\x81\xd0\xbb\xd0\xbe\xd0\xb2\xd0\xb8\xd1\x8f \xd0\xb8\xd0\xb7 \xd0\xb4\xd0\xb2\xd1\x83\xd1\x85 \xd1\x80\xd0\xb0\xd0\xb7\xd0\xbd\xd1\x8b\xd1\x85 \xd0\xba\xd0\xbe\xd0\xbc\xd0\xbf\xd0\xbb\xd0\xb5\xd0\xba\xd1\x82\xd0\xbe\xd0\xb2 \xd0\xb7\xd0\xb0\xd0\xb4\xd0\xb0\xd1\x87. \xd0\x9e\xd0\xb1\xd1\x80\xd0\xb0\xd1\x82\xd0\xb8\xd1\x82\xd0\xb5 \xd0\xb2\xd0\xbd\xd0\xb8\xd0\xbc\xd0\xb0\xd0\xbd\xd0\xb8\xd0\xb5, \xd1\x87\xd1\x82\xd0\xbe \xd0\xbf\xd1\x80\xd0\xb8 \xd0\xb8\xd1\x81\xd0\xbf\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xb7\xd0\xbe\xd0\xb2\xd0\xb0\xd0\xbd\xd0\xb8\xd0\xb8 \xd0\xbb\xd0\xb8\xd1\x81\xd1\x82\xd0\xbe\xd0\xb2, \xd1\x83 \xd0\xba\xd0\xbe\xd1\x82\xd0\xbe\xd1\x80\xd1\x8b\xd1\x85 \xd0\xbe\xd0\xb1\xd0\xb5 \xd1\x81\xd1\x82\xd0\xbe\xd1\x80\xd0\xbe\xd0\xbd\xd1\x8b \xd1\x87\xd0\xb8\xd1\x81\xd1\x82\xd1\x8b\xd0\xb5, \xd0\xbd\xd0\xb5 \xd0\xbe\xd0\xb1\xd1\x8f\xd0\xb7\xd0\xb0\xd1\x82\xd0\xb5\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe \xd0\xbf\xd0\xb5\xd1\x87\xd0\xb0\xd1\x82\xd0\xb0\xd1\x82\xd1\x8c \xd1\x83\xd1\x81\xd0\xbb\xd0\xbe\xd0\xb2\xd0\xb8\xd0\xb5 \xd0\xbd\xd0\xb0 \xd0\xbe\xd0\xb1\xd0\xb5\xd0\xb8\xd1\x85 \xd1\x81\xd1\x82\xd0\xbe\xd1\x80\xd0\xbe\xd0\xbd\xd0\xb0\xd1\x85, \xd0\xbe\xd0\xb4\xd0\xbd\xd0\xb0 \xd0\xb8\xd0\xb7 \xd0\xbd\xd0\xb8\xd1\x85 \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xb5\xd1\x82 \xd0\xbe\xd1\x81\xd1\x82\xd0\xb0\xd1\x82\xd1\x8c\xd1\x81\xd1\x8f \xd1\x87\xd0\xb8\xd1\x81\xd1\x82\xd0\xbe\xd0\xb9.\xd0\x92\xd0\xb0\xd0\xbc \xd0\xbf\xd1\x80\xd0\xb5\xd0\xb4\xd1\x81\xd1\x82\xd0\xbe\xd0\xb8\xd1\x82 \xd0\xbe\xd0\xbf\xd1\x80\xd0\xb5\xd0\xb4\xd0\xb5\xd0\xbb\xd0\xb8\xd1\x82\xd1\x8c \xd0\xbc\xd0\xb0\xd0\xba\xd1\x81\xd0\xb8\xd0\xbc\xd0\xb0\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe\xd0\xb5 \xd0\xba\xd0\xbe\xd0\xbb\xd0\xb8\xd1\x87\xd0\xb5\xd1\x81\xd1\x82\xd0\xb2\xd0\xbe \xd0\xba\xd0\xbe\xd0\xbc\xd0\xb0\xd0\xbd\xd0\xb4, \xd0\xba\xd0\xbe\xd1\x82\xd0\xbe\xd1\x80\xd1\x8b\xd0\xbc \xd1\x82\xd1\x80\xd0\xb5\xd0\xbd\xd0\xb5\xd1\x80 \xd1\x81\xd0\xbc\xd0\xbe\xd0\xb6\xd0\xb5\xd1\x82 \xd0\xbd\xd0\xb0\xd0\xbf\xd0\xb5\xd1\x87\xd0\xb0\xd1\x82\xd0\xb0\xd1\x82\xd1\x8c \xd0\xba\xd0\xbe\xd0\xbc\xd0\xbf\xd0\xbb\xd0\xb5\xd0\xba\xd1\x82\xd1\x8b \xd0\xb7\xd0\xb0\xd0\xb4\xd0\xb0\xd1\x87 \xd1\x86\xd0\xb5\xd0\xbb\xd0\xb8\xd0\xba\xd0\xbe\xd0\xbc." 1500
649B \xd0\xad\xd1\x82\xd0\xb0\xd0\xb6\xd0\xb8 "constructive algorithms" "\xd0\x95\xd1\x81\xd1\x82\xd1\x8c n-\xd0\xbf\xd0\xbe\xd0\xb4\xd1\x8a\xd0\xb5\xd0\xb7\xd0\xb4\xd0\xbd\xd1\x8b\xd0\xb9 \xd0\xb4\xd0\xbe\xd0\xbc, \xd0\xb2 \xd0\xba\xd0\xb0\xd0\xb6\xd0\xb4\xd0\xbe\xd0\xbc \xd0\xbf\xd0\xbe\xd0\xb4\xd1\x8a\xd0\xb5\xd0\xb7\xd0\xb4\xd0\xb5 \xd0\xbf\xd0\xbe m \xd1\x8d\xd1\x82\xd0\xb0\xd0\xb6\xd0\xb5\xd0\xb9, \xd0\xb8 \xd0\xbd\xd0\xb0 \xd0\xba\xd0\xb0\xd0\xb6\xd0\xb4\xd0\xbe\xd0\xbc \xd1\x8d\xd1\x82\xd0\xb0\xd0\xb6\xd0\xb5 \xd0\xba\xd0\xb0\xd0\xb6\xd0\xb4\xd0\xbe\xd0\xb3\xd0\xbe \xd0\xbf\xd0\xbe\xd0\xb4\xd1\x8a\xd0\xb5\xd0\xb7\xd0\xb4\xd0\xb0 \xd1\x80\xd0\xbe\xd0\xb2\xd0\xbd\xd0\xbe k \xd0\xba\xd0\xb2\xd0\xb0\xd1\x80\xd1\x82\xd0\xb8\xd1\x80. \xd0\xa2\xd0\xb0\xd0\xba\xd0\xb8\xd0\xbc \xd0\xbe\xd0\xb1\xd1\x80\xd0\xb0\xd0\xb7\xd0\xbe\xd0\xbc, \xd0\xb2 \xd0\xb4\xd0\xbe\xd0\xbc\xd0\xb5 \xd0\xb2\xd1\x81\xd0\xb5\xd0\xb3\xd0\xbe n\xc2\xb7m\xc2\xb7k \xd0\xba\xd0\xb2\xd0\xb0\xd1\x80\xd1\x82\xd0\xb8\xd1\x80. \xd0\x9e\xd0\xbd\xd0\xb8 \xd0\xbf\xd1\x80\xd0\xbe\xd0\xbd\xd1\x83\xd0\xbc\xd0\xb5\xd1\x80\xd0\xbe\xd0\xb2\xd0\xb0\xd0\xbd\xd1\x8b \xd0\xb5\xd1\x81\xd1\x82\xd0\xb5\xd1\x81\xd1\x82\xd0\xb2\xd0\xb5\xd0\xbd\xd0\xbd\xd1\x8b\xd0\xbc \xd0\xbe\xd0\xb1\xd1\x80\xd0\xb0\xd0\xb7\xd0\xbe\xd0\xbc \xd0\xbe\xd1\x82 1 \xd0\xb4\xd0\xbe n\xc2\xb7m\xc2\xb7k, \xd1\x82\xd0\xbe \xd0\xb5\xd1\x81\xd1\x82\xd1\x8c \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb2\xd0\xb0\xd1\x8f \xd0\xba\xd0\xb2\xd0\xb0\xd1\x80\xd1\x82\xd0\xb8\xd1\x80\xd0\xb0 \xd0\xbd\xd0\xb0 \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb2\xd0\xbe\xd0\xbc \xd1\x8d\xd1\x82\xd0\xb0\xd0\xb6\xd0\xb5 \xd0\xb2 \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb2\xd0\xbe\xd0\xbc \xd0\xbf\xd0\xbe\xd0\xb4\xd1\x8a\xd0\xb5\xd0\xb7\xd0\xb4\xd0\xb5 \xd0\xb8\xd0\xbc\xd0\xb5\xd0\xb5\xd1\x82 \xd0\xbd\xd0\xbe\xd0\xbc\xd0\xb5\xd1\x80 1, \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb2\xd0\xb0\xd1\x8f \xd0\xba\xd0\xb2\xd0\xb0\xd1\x80\xd1\x82\xd0\xb8\xd1\x80\xd0\xb0 \xd0\xbd\xd0\xb0 \xd0\xb2\xd1\x82\xd0\xbe\xd1\x80\xd0\xbe\xd0\xbc \xd1\x8d\xd1\x82\xd0\xb0\xd0\xb6\xd0\xb5 \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb2\xd0\xbe\xd0\xb3\xd0\xbe \xd0\xbf\xd0\xbe\xd0\xb4\xd1\x8a\xd0\xb5\xd0\xb7\xd0\xb4\xd0\xb0 \xd0\xb8\xd0\xbc\xd0\xb5\xd0\xb5\xd1\x82 \xd0\xbd\xd0\xbe\xd0\xbc\xd0\xb5\xd1\x80 k\xe2\x80\x89+\xe2\x80\x891 \xd0\xb8 \xd1\x82\xd0\xb0\xd0\xba \xd0\xb4\xd0\xb0\xd0\xbb\xd0\xb5\xd0\xb5. \xd0\x9e\xd1\x81\xd0\xbe\xd0\xb1\xd0\xb5\xd0\xbd\xd0\xbd\xd0\xbe\xd1\x81\xd1\x82\xd1\x8c \xd1\x8d\xd1\x82\xd0\xbe\xd0\xb3\xd0\xbe \xd0\xb4\xd0\xbe\xd0\xbc\xd0\xb0 \xd1\x81\xd0\xbe\xd1\x81\xd1\x82\xd0\xbe\xd0\xb8\xd1\x82 \xd0\xb2 \xd1\x82\xd0\xbe\xd0\xbc, \xd1\x87\xd1\x82\xd0\xbe \xd0\xbe\xd0\xbd \xd0\xba\xd1\x80\xd1\x83\xd0\xb3\xd0\xbb\xd1\x8b\xd0\xb9. \xd0\xa2\xd0\xbe \xd0\xb5\xd1\x81\xd1\x82\xd1\x8c \xd0\xb5\xd1\x81\xd0\xbb\xd0\xb8 \xd0\xbe\xd0\xb1\xd1\x85\xd0\xbe\xd0\xb4\xd0\xb8\xd1\x82\xd1\x8c \xd0\xb5\xd0\xb3\xd0\xbe \xd0\xbf\xd0\xbe \xd1\x87\xd0\xb0\xd1\x81\xd0\xbe\xd0\xb2\xd0\xbe\xd0\xb9 \xd1\x81\xd1\x82\xd1\x80\xd0\xb5\xd0\xbb\xd0\xba\xd0\xb5, \xd1\x82\xd0\xbe \xd0\xbf\xd0\xbe\xd1\x81\xd0\xbb\xd0\xb5 \xd0\xbf\xd0\xbe\xd0\xb4\xd1\x8a\xd0\xb5\xd0\xb7\xd0\xb4\xd0\xb0 \xd0\xbd\xd0\xbe\xd0\xbc\xd0\xb5\xd1\x80 1 \xd1\x81\xd0\xbb\xd0\xb5\xd0\xb4\xd1\x83\xd0\xb5\xd1\x82 \xd0\xbf\xd0\xbe\xd0\xb4\xd1\x8a\xd0\xb5\xd0\xb7\xd0\xb4 \xd0\xbd\xd0\xbe\xd0\xbc\xd0\xb5\xd1\x80 2, \xd0\xb7\xd0\xb0\xd1\x82\xd0\xb5\xd0\xbc \xd0\xbf\xd0\xbe\xd0\xb4\xd1\x8a\xd0\xb5\xd0\xb7\xd0\xb4 \xd0\xbd\xd0\xbe\xd0\xbc\xd0\xb5\xd1\x80 3 \xd0\xb8 \xd1\x82\xd0\xb0\xd0\xba \xd0\xb4\xd0\xb0\xd0\xbb\xd0\xb5\xd0\xb5 \xd0\xb4\xd0\xbe \xd0\xbf\xd0\xbe\xd0\xb4\xd1\x8a\xd0\xb5\xd0\xb7\xd0\xb4\xd0\xb0 \xd0\xbd\xd0\xbe\xd0\xbc\xd0\xb5\xd1\x80 n. \xd0\x9f\xd0\xbe\xd1\x81\xd0\xbb\xd0\xb5 \xd0\xbf\xd0\xbe\xd0\xb4\xd1\x8a\xd0\xb5\xd0\xb7\xd0\xb4\xd0\xb0 \xd0\xbd\xd0\xbe\xd0\xbc\xd0\xb5\xd1\x80 n \xd1\x81\xd0\xbd\xd0\xbe\xd0\xb2\xd0\xb0 \xd0\xb8\xd0\xb4\xd1\x91\xd1\x82 \xd0\xbf\xd0\xbe\xd0\xb4\xd1\x8a\xd0\xb5\xd0\xb7\xd0\xb4 \xd0\xbd\xd0\xbe\xd0\xbc\xd0\xb5\xd1\x80 1.\xd0\xad\xd0\xb4\xd0\xb2\xd0\xb0\xd1\x80\xd0\xb4 \xd0\xb6\xd0\xb8\xd0\xb2\xd1\x91\xd1\x82 \xd0\xb2 \xd0\xba\xd0\xb2\xd0\xb0\xd1\x80\xd1\x82\xd0\xb8\xd1\x80\xd0\xb5 \xd0\xbd\xd0\xbe\xd0\xbc\xd0\xb5\xd1\x80 a, \xd0\xb0 \xd0\x9d\xd0\xb0\xd1\x82\xd0\xb0\xd1\x88\xd0\xb0 \xe2\x80\x94 \xd0\xb2 \xd0\xba\xd0\xb2\xd0\xb0\xd1\x80\xd1\x82\xd0\xb8\xd1\x80\xd0\xb5 \xd0\xbd\xd0\xbe\xd0\xbc\xd0\xb5\xd1\x80 b. \xd0\x9f\xd0\xb5\xd1\x80\xd0\xb5\xd1\x85\xd0\xbe\xd0\xb4 \xd0\xbd\xd0\xb0 1 \xd1\x8d\xd1\x82\xd0\xb0\xd0\xb6 \xd0\xb2\xd0\xb2\xd0\xb5\xd1\x80\xd1\x85 \xd0\xb8\xd0\xbb\xd0\xb8 \xd0\xb2\xd0\xbd\xd0\xb8\xd0\xb7 \xd0\xbf\xd0\xbe \xd0\xbb\xd0\xb5\xd1\x81\xd1\x82\xd0\xbd\xd0\xb8\xd1\x86\xd0\xb5 \xd0\xb7\xd0\xb0\xd0\xbd\xd0\xb8\xd0\xbc\xd0\xb0\xd0\xb5\xd1\x82 5 \xd1\x81\xd0\xb5\xd0\xba\xd1\x83\xd0\xbd\xd0\xb4, \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb5\xd1\x85\xd0\xbe\xd0\xb4 \xd0\xbe\xd1\x82 \xd0\xb4\xd0\xb2\xd0\xb5\xd1\x80\xd0\xb8 \xd0\xbf\xd0\xbe\xd0\xb4\xd1\x8a\xd0\xb5\xd0\xb7\xd0\xb4\xd0\xb0 \xd0\xba \xd0\xb4\xd0\xb2\xd0\xb5\xd1\x80\xd0\xb8 \xd1\x81\xd0\xbe\xd1\x81\xd0\xb5\xd0\xb4\xd0\xbd\xd0\xb5\xd0\xb3\xd0\xbe \xd0\xbf\xd0\xbe\xd0\xb4\xd1\x8a\xd0\xb5\xd0\xb7\xd0\xb4\xd0\xb0 \xe2\x80\x94 15 \xd1\x81\xd0\xb5\xd0\xba\xd1\x83\xd0\xbd\xd0\xb4, \xd0\xb0 \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb5\xd1\x85\xd0\xbe\xd0\xb4 \xd0\xb2 \xd0\xbf\xd1\x80\xd0\xb5\xd0\xb4\xd0\xb5\xd0\xbb\xd0\xb0\xd1\x85 \xd0\xbe\xd0\xb4\xd0\xbd\xd0\xbe\xd0\xb3\xd0\xbe \xd1\x8d\xd1\x82\xd0\xb0\xd0\xb6\xd0\xb0 \xd0\xbe\xd0\xb4\xd0\xbd\xd0\xbe\xd0\xb3\xd0\xbe \xd0\xbf\xd0\xbe\xd0\xb4\xd1\x8a\xd0\xb5\xd0\xb7\xd0\xb4\xd0\xb0 \xd0\xbf\xd1\x80\xd0\xbe\xd0\xb8\xd1\x81\xd1\x85\xd0\xbe\xd0\xb4\xd0\xb8\xd1\x82 \xd0\xbc\xd0\xb3\xd0\xbd\xd0\xbe\xd0\xb2\xd0\xb5\xd0\xbd\xd0\xbd\xd0\xbe. \xd0\xa2\xd0\xb0\xd0\xba\xd0\xb6\xd0\xb5 \xd0\xb2 \xd0\xba\xd0\xb0\xd0\xb6\xd0\xb4\xd0\xbe\xd0\xbc \xd0\xbf\xd0\xbe\xd0\xb4\xd1\x8a\xd0\xb5\xd0\xb7\xd0\xb4\xd0\xb5 \xd0\xb4\xd0\xbe\xd0\xbc\xd0\xb0 \xd0\xb5\xd1\x81\xd1\x82\xd1\x8c \xd0\xbb\xd0\xb8\xd1\x84\xd1\x82. \xd0\x9e\xd0\xbd \xd1\x83\xd1\x81\xd1\x82\xd1\x80\xd0\xbe\xd0\xb5\xd0\xbd \xd1\x81\xd0\xbb\xd0\xb5\xd0\xb4\xd1\x83\xd1\x8e\xd1\x89\xd0\xb8\xd0\xbc \xd0\xbe\xd0\xb1\xd1\x80\xd0\xb0\xd0\xb7\xd0\xbe\xd0\xbc: \xd0\xbe\xd0\xbd \xd0\xb2\xd1\x81\xd0\xb5\xd0\xb3\xd0\xb4\xd0\xb0 \xd0\xbf\xd1\x80\xd0\xb8\xd0\xb5\xd0\xb7\xd0\xb6\xd0\xb0\xd0\xb5\xd1\x82 \xd1\x80\xd0\xbe\xd0\xb2\xd0\xbd\xd0\xbe \xd1\x87\xd0\xb5\xd1\x80\xd0\xb5\xd0\xb7 10 \xd1\x81\xd0\xb5\xd0\xba\xd1\x83\xd0\xbd\xd0\xb4 \xd0\xbf\xd0\xbe\xd1\x81\xd0\xbb\xd0\xb5 \xd0\xb2\xd1\x8b\xd0\xb7\xd0\xbe\xd0\xb2\xd0\xb0, \xd0\xb0 \xd1\x87\xd1\x82\xd0\xbe\xd0\xb1\xd1\x8b \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb5\xd0\xbc\xd0\xb5\xd1\x81\xd1\x82\xd0\xb8\xd1\x82\xd1\x8c \xd0\xbf\xd0\xb0\xd1\x81\xd1\x81\xd0\xb0\xd0\xb6\xd0\xb8\xd1\x80\xd0\xb0 \xd0\xbd\xd0\xb0 \xd0\xbe\xd0\xb4\xd0\xb8\xd0\xbd \xd1\x8d\xd1\x82\xd0\xb0\xd0\xb6 \xd0\xb2\xd0\xb2\xd0\xb5\xd1\x80\xd1\x85 \xd0\xb8\xd0\xbb\xd0\xb8 \xd0\xb2\xd0\xbd\xd0\xb8\xd0\xb7, \xd0\xbb\xd0\xb8\xd1\x84\xd1\x82 \xd1\x82\xd1\x80\xd0\xb0\xd1\x82\xd0\xb8\xd1\x82 \xd1\x80\xd0\xbe\xd0\xb2\xd0\xbd\xd0\xbe 1 \xd1\x81\xd0\xb5\xd0\xba\xd1\x83\xd0\xbd\xd0\xb4\xd1\x83. \xd0\x9f\xd0\xbe\xd1\x81\xd0\xb0\xd0\xb4\xd0\xba\xd0\xb0 \xd0\xb8 \xd0\xb2\xd1\x8b\xd1\x81\xd0\xb0\xd0\xb4\xd0\xba\xd0\xb0 \xd0\xbf\xd1\x80\xd0\xbe\xd0\xb8\xd1\x81\xd1\x85\xd0\xbe\xd0\xb4\xd1\x8f\xd1\x82 \xd0\xbc\xd0\xb3\xd0\xbd\xd0\xbe\xd0\xb2\xd0\xb5\xd0\xbd\xd0\xbd\xd0\xbe.\xd0\x9f\xd0\xbe\xd0\xbc\xd0\xbe\xd0\xb3\xd0\xb8\xd1\x82\xd0\xb5 \xd0\xad\xd0\xb4\xd0\xb2\xd0\xb0\xd1\x80\xd0\xb4\xd1\x83 \xd0\xbd\xd0\xb0\xd0\xb9\xd1\x82\xd0\xb8 \xd0\xbc\xd0\xb8\xd0\xbd\xd0\xb8\xd0\xbc\xd0\xb0\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe\xd0\xb5 \xd0\xb2\xd1\x80\xd0\xb5\xd0\xbc\xd1\x8f, \xd0\xb7\xd0\xb0 \xd0\xba\xd0\xbe\xd1\x82\xd0\xbe\xd1\x80\xd0\xbe\xd0\xb5 \xd0\xbe\xd0\xbd \xd1\x81\xd0\xbc\xd0\xbe\xd0\xb6\xd0\xb5\xd1\x82 \xd0\xb4\xd0\xbe\xd0\xb1\xd1\x80\xd0\xb0\xd1\x82\xd1\x8c\xd1\x81\xd1\x8f \xd0\xb4\xd0\xbe \xd0\xba\xd0\xb2\xd0\xb0\xd1\x80\xd1\x82\xd0\xb8\xd1\x80\xd1\x8b \xd0\x9d\xd0\xb0\xd1\x82\xd0\xb0\xd1\x88\xd0\xb8. \xd0\xa1\xd1\x87\xd0\xb8\xd1\x82\xd0\xb0\xd0\xb9\xd1\x82\xd0\xb5, \xd1\x87\xd1\x82\xd0\xbe \xd0\xad\xd0\xb4\xd0\xb2\xd0\xb0\xd1\x80\xd0\xb4 \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xb5\xd1\x82 \xd0\xb2\xd1\x8b\xd0\xb9\xd1\x82\xd0\xb8 \xd0\xb8\xd0\xb7 \xd0\xbf\xd0\xbe\xd0\xb4\xd1\x8a\xd0\xb5\xd0\xb7\xd0\xb4\xd0\xb0 \xd1\x82\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xba\xd0\xbe \xd1\x81 \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb2\xd0\xbe\xd0\xb3\xd0\xbe \xd1\x8d\xd1\x82\xd0\xb0\xd0\xb6\xd0\xb0 \xd1\x81\xd0\xbe\xd0\xbe\xd1\x82\xd0\xb2\xd0\xb5\xd1\x82\xd1\x81\xd1\x82\xd0\xb2\xd1\x83\xd1\x8e\xd1\x89\xd0\xb5\xd0\xb3\xd0\xbe \xd0\xbf\xd0\xbe\xd0\xb4\xd1\x8a\xd0\xb5\xd0\xb7\xd0\xb4\xd0\xb0 (\xd1\x8d\xd1\x82\xd0\xbe \xd0\xbf\xd1\x80\xd0\xbe\xd0\xb8\xd1\x81\xd1\x85\xd0\xbe\xd0\xb4\xd0\xb8\xd1\x82 \xd0\xbc\xd0\xb3\xd0\xbd\xd0\xbe\xd0\xb2\xd0\xb5\xd0\xbd\xd0\xbd\xd0\xbe). \xd0\x95\xd1\x81\xd0\xbb\xd0\xb8 \xd0\xad\xd0\xb4\xd0\xb2\xd0\xb0\xd1\x80\xd0\xb4 \xd1\x81\xd1\x82\xd0\xbe\xd0\xb8\xd1\x82 \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb5\xd0\xb4 \xd0\xb4\xd0\xb2\xd0\xb5\xd1\x80\xd1\x8c\xd1\x8e \xd0\xba\xd0\xb0\xd0\xba\xd0\xbe\xd0\xb3\xd0\xbe-\xd1\x82\xd0\xbe \xd0\xbf\xd0\xbe\xd0\xb4\xd1\x8a\xd0\xb5\xd0\xb7\xd0\xb4\xd0\xb0, \xd0\xbe\xd0\xbd \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xb5\xd1\x82 \xd0\xb7\xd0\xb0\xd0\xb9\xd1\x82\xd0\xb8 \xd0\xb2 \xd0\xbd\xd0\xb5\xd0\xb3\xd0\xbe \xd0\xb8 \xd1\x81\xd1\x80\xd0\xb0\xd0\xb7\xd1\x83 \xd0\xbe\xd0\xba\xd0\xb0\xd0\xb6\xd0\xb5\xd1\x82\xd1\x81\xd1\x8f \xd0\xbd\xd0\xb0 \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb2\xd0\xbe\xd0\xbc \xd1\x8d\xd1\x82\xd0\xb0\xd0\xb6\xd0\xb5 \xd1\x8d\xd1\x82\xd0\xbe\xd0\xb3\xd0\xbe \xd0\xbf\xd0\xbe\xd0\xb4\xd1\x8a\xd0\xb5\xd0\xb7\xd0\xb4\xd0\xb0 (\xd1\x8d\xd1\x82\xd0\xbe \xd1\x82\xd0\xb0\xd0\xba\xd0\xb6\xd0\xb5 \xd0\xbf\xd1\x80\xd0\xbe\xd0\xb8\xd1\x81\xd1\x85\xd0\xbe\xd0\xb4\xd0\xb8\xd1\x82 \xd0\xbc\xd0\xb3\xd0\xbd\xd0\xbe\xd0\xb2\xd0\xb5\xd0\xbd\xd0\xbd\xd0\xbe). \xd0\xad\xd0\xb4\xd0\xb2\xd0\xb0\xd1\x80\xd0\xb4 \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xb5\xd1\x82 \xd0\xb2\xd1\x8b\xd0\xb1\xd0\xb8\xd1\x80\xd0\xb0\xd1\x82\xd1\x8c, \xd0\xb2 \xd0\xba\xd0\xb0\xd0\xba\xd0\xbe\xd0\xbc \xd0\xbd\xd0\xb0\xd0\xbf\xd1\x80\xd0\xb0\xd0\xb2\xd0\xbb\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb8 \xd0\xb8\xd0\xb4\xd1\x82\xd0\xb8 \xd0\xb2\xd0\xbe\xd0\xba\xd1\x80\xd1\x83\xd0\xb3 \xd0\xb4\xd0\xbe\xd0\xbc\xd0\xb0." 1400
649A "\xd0\x9b\xd1\x8e\xd0\xb1\xd0\xb8\xd0\xbc\xd1\x8b\xd0\xb5 \xd1\x87\xd0\xb8\xd1\x81\xd0\xbb\xd0\xb0 \xd0\x9f\xd0\xbe\xd0\xbb\xd0\xb8\xd0\xba\xd0\xb0\xd1\x80\xd0\xbf\xd0\xb0" "constructive algorithms,implementation" "\xd0\x9f\xd0\xbe\xd0\xbb\xd0\xb8\xd0\xba\xd0\xb0\xd1\x80\xd0\xbf \xd0\xbc\xd0\xb5\xd1\x87\xd1\x82\xd0\xb0\xd0\xb5\xd1\x82 \xd1\x81\xd1\x82\xd0\xb0\xd1\x82\xd1\x8c \xd0\xbf\xd1\x80\xd0\xbe\xd0\xb3\xd1\x80\xd0\xb0\xd0\xbc\xd0\xbc\xd0\xb8\xd1\x81\xd1\x82\xd0\xbe\xd0\xbc \xd0\xb8 \xd1\x84\xd0\xb0\xd0\xbd\xd0\xb0\xd1\x82\xd0\xb5\xd0\xb5\xd1\x82 \xd0\xbe\xd1\x82 \xd1\x81\xd1\x82\xd0\xb5\xd0\xbf\xd0\xb5\xd0\xbd\xd0\xb5\xd0\xb9 \xd0\xb4\xd0\xb2\xd0\xbe\xd0\xb9\xd0\xba\xd0\xb8. \xd0\xa1\xd1\x80\xd0\xb5\xd0\xb4\xd0\xb8 \xd0\xb4\xd0\xb2\xd1\x83\xd1\x85 \xd1\x87\xd0\xb8\xd1\x81\xd0\xb5\xd0\xbb \xd0\xb5\xd0\xbc\xd1\x83 \xd0\xb1\xd0\xbe\xd0\xbb\xd1\x8c\xd1\x88\xd0\xb5 \xd0\xbd\xd1\x80\xd0\xb0\xd0\xb2\xd0\xb8\xd1\x82\xd1\x81\xd1\x8f \xd1\x82\xd0\xbe, \xd0\xba\xd0\xbe\xd1\x82\xd0\xbe\xd1\x80\xd0\xbe\xd0\xb5 \xd0\xb4\xd0\xb5\xd0\xbb\xd0\xb8\xd1\x82\xd1\x81\xd1\x8f \xd0\xbd\xd0\xb0 \xd0\xb1\xd0\xbe\xd0\xbb\xd1\x8c\xd1\x88\xd1\x83\xd1\x8e \xd1\x81\xd1\x82\xd0\xb5\xd0\xbf\xd0\xb5\xd0\xbd\xd1\x8c \xd1\x87\xd0\xb8\xd1\x81\xd0\xbb\xd0\xb0 2. \xd0\x9f\xd0\xbe \xd0\xb7\xd0\xb0\xd0\xb4\xd0\xb0\xd0\xbd\xd0\xbd\xd0\xbe\xd0\xb9 \xd0\xbf\xd0\xbe\xd1\x81\xd0\xbb\xd0\xb5\xd0\xb4\xd0\xbe\xd0\xb2\xd0\xb0\xd1\x82\xd0\xb5\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe\xd1\x81\xd1\x82\xd0\xb8 \xd1\x86\xd0\xb5\xd0\xbb\xd1\x8b\xd1\x85 \xd0\xbf\xd0\xbe\xd0\xbb\xd0\xbe\xd0\xb6\xd0\xb8\xd1\x82\xd0\xb5\xd0\xbb\xd1\x8c\xd0\xbd\xd1\x8b\xd1\x85 \xd1\x87\xd0\xb8\xd1\x81\xd0\xb5\xd0\xbb a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an \xd1\x82\xd1\x80\xd0\xb5\xd0\xb1\xd1\x83\xd0\xb5\xd1\x82\xd1\x81\xd1\x8f \xd0\xbd\xd0\xb0\xd0\xb9\xd1\x82\xd0\xb8 r \xe2\x80\x94 \xd0\xbc\xd0\xb0\xd0\xba\xd1\x81\xd0\xb8\xd0\xbc\xd0\xb0\xd0\xbb\xd1\x8c\xd0\xbd\xd1\x83\xd1\x8e \xd1\x81\xd1\x82\xd0\xb5\xd0\xbf\xd0\xb5\xd0\xbd\xd1\x8c \xd1\x87\xd0\xb8\xd1\x81\xd0\xbb\xd0\xb0 2, \xd0\xbd\xd0\xb0 \xd0\xba\xd0\xbe\xd1\x82\xd0\xbe\xd1\x80\xd1\x83\xd1\x8e \xd0\xb4\xd0\xb5\xd0\xbb\xd0\xb8\xd1\x82\xd1\x81\xd1\x8f \xd1\x85\xd0\xbe\xd1\x82\xd1\x8f \xd0\xb1\xd1\x8b \xd0\xbe\xd0\xb4\xd0\xbd\xd0\xbe \xd0\xb8\xd0\xb7 \xd1\x87\xd0\xb8\xd1\x81\xd0\xb5\xd0\xbb \xd0\xbf\xd0\xbe\xd1\x81\xd0\xbb\xd0\xb5\xd0\xb4\xd0\xbe\xd0\xb2\xd0\xb0\xd1\x82\xd0\xb5\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe\xd1\x81\xd1\x82\xd0\xb8. \xd0\x9a\xd1\x80\xd0\xbe\xd0\xbc\xd0\xb5 \xd1\x82\xd0\xbe\xd0\xb3\xd0\xbe, \xd1\x82\xd1\x80\xd0\xb5\xd0\xb1\xd1\x83\xd0\xb5\xd1\x82\xd1\x81\xd1\x8f \xd0\xb2\xd1\x8b\xd0\xb2\xd0\xb5\xd1\x81\xd1\x82\xd0\xb8 \xd0\xba\xd0\xbe\xd0\xbb\xd0\xb8\xd1\x87\xd0\xb5\xd1\x81\xd1\x82\xd0\xb2\xd0\xbe \xd1\x87\xd0\xb8\xd1\x81\xd0\xb5\xd0\xbb ai, \xd0\xba\xd0\xbe\xd1\x82\xd0\xbe\xd1\x80\xd1\x8b\xd0\xb5 \xd0\xb4\xd0\xb5\xd0\xbb\xd1\x8f\xd1\x82\xd1\x81\xd1\x8f \xd0\xbd\xd0\xb0 r." 1000
648E "\xd0\xa1\xd0\xbe\xd0\xb1\xd0\xb5\xd1\x80\xd0\xb8 \xd1\x87\xd0\xb8\xd1\x81\xd0\xbb\xd0\xbe" "graphs,shortest paths" "\xd0\x94\xd0\xb0\xd0\xbd\xd0\xbe \xd1\x86\xd0\xb5\xd0\xbb\xd0\xbe\xd0\xb5 \xd0\xbd\xd0\xb5\xd0\xbe\xd1\x82\xd1\x80\xd0\xb8\xd1\x86\xd0\xb0\xd1\x82\xd0\xb5\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe\xd0\xb5 \xd1\x87\xd0\xb8\xd1\x81\xd0\xbb\xd0\xbe k \xd0\xb8 n \xd0\xbd\xd0\xb5\xd0\xbe\xd1\x82\xd1\x80\xd0\xb8\xd1\x86\xd0\xb0\xd1\x82\xd0\xb5\xd0\xbb\xd1\x8c\xd0\xbd\xd1\x8b\xd1\x85 \xd1\x86\xd0\xb5\xd0\xbb\xd1\x8b\xd1\x85 \xd1\x87\xd0\xb8\xd1\x81\xd0\xb5\xd0\xbb a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. \xd0\x97\xd0\xb0\xd0\xbf\xd0\xb8\xd1\x81\xd1\x8b\xd0\xb2\xd0\xb0\xd1\x8f \xd0\xbd\xd0\xb5\xd0\xba\xd0\xbe\xd1\x82\xd0\xbe\xd1\x80\xd1\x8b\xd0\xb5 \xd0\xb8\xd0\xb7 \xd1\x8d\xd1\x82\xd0\xb8\xd1\x85 \xd1\x87\xd0\xb8\xd1\x81\xd0\xb5\xd0\xbb \xd0\xb4\xd1\x80\xd1\x83\xd0\xb3 \xd0\xb7\xd0\xb0 \xd0\xb4\xd1\x80\xd1\x83\xd0\xb3\xd0\xbe\xd0\xbc \xd0\xb2 \xd0\xbf\xd1\x80\xd0\xbe\xd0\xb8\xd0\xb7\xd0\xb2\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe\xd0\xbc \xd0\xbf\xd0\xbe\xd1\x80\xd1\x8f\xd0\xb4\xd0\xba\xd0\xb5 \xd0\xb8, \xd0\xb2\xd0\xbe\xd0\xb7\xd0\xbc\xd0\xbe\xd0\xb6\xd0\xbd\xd0\xbe, \xd0\xb8\xd1\x81\xd0\xbf\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xb7\xd1\x83\xd1\x8f \xd0\xba\xd0\xb0\xd0\xba\xd0\xb8\xd0\xb5-\xd1\x82\xd0\xbe \xd0\xb8\xd0\xb7 \xd0\xbd\xd0\xb8\xd1\x85 \xd0\xbd\xd0\xb5\xd1\x81\xd0\xba\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xba\xd0\xbe \xd1\x80\xd0\xb0\xd0\xb7 (\xd0\xb0 \xd0\xba\xd0\xb0\xd0\xba\xd0\xb8\xd0\xb5-\xd1\x82\xd0\xbe \xd0\xb2\xd0\xbe\xd0\xbe\xd0\xb1\xd1\x89\xd0\xb5 \xd0\xbd\xd0\xb5 \xd0\xb8\xd1\x81\xd0\xbf\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xb7\xd1\x83\xd1\x8f), \xd1\x82\xd1\x80\xd0\xb5\xd0\xb1\xd1\x83\xd0\xb5\xd1\x82\xd1\x81\xd1\x8f \xd1\x81\xd0\xbe\xd1\x81\xd1\x82\xd0\xb0\xd0\xb2\xd0\xb8\xd1\x82\xd1\x8c \xd0\xba\xd1\x80\xd0\xb0\xd1\x82\xd1\x87\xd0\xb0\xd0\xb9\xd1\x88\xd0\xb5\xd0\xb5 (\xd0\xbd\xd0\xb0\xd0\xb8\xd0\xbc\xd0\xb5\xd0\xbd\xd1\x8c\xd1\x88\xd0\xb5\xd0\xb5 \xd0\xbf\xd0\xbe \xd0\xba\xd0\xbe\xd0\xbb\xd0\xb8\xd1\x87\xd0\xb5\xd1\x81\xd1\x82\xd0\xb2\xd1\x83 \xd1\x86\xd0\xb8\xd1\x84\xd1\x80) \xd1\x87\xd0\xb8\xd1\x81\xd0\xbb\xd0\xbe, \xd0\xb4\xd0\xb5\xd0\xbb\xd1\x8f\xd1\x89\xd0\xb5\xd0\xb5\xd1\x81\xd1\x8f \xd0\xbd\xd0\xb0 k, \xd0\xb8\xd0\xbb\xd0\xb8 \xd0\xbe\xd0\xbf\xd1\x80\xd0\xb5\xd0\xb4\xd0\xb5\xd0\xbb\xd0\xb8\xd1\x82\xd1\x8c, \xd1\x87\xd1\x82\xd0\xbe \xd1\x8d\xd1\x82\xd0\xbe \xd0\xbd\xd0\xb5\xd0\xb2\xd0\xbe\xd0\xb7\xd0\xbc\xd0\xbe\xd0\xb6\xd0\xbd\xd0\xbe." 2300
648D "\xd0\xa1\xd0\xbe\xd0\xb1\xd0\xb0\xd1\x87\xd0\xba\xd0\xb8 \xd0\xb8 \xd0\xbc\xd0\xb8\xd1\x81\xd0\xba\xd0\xb8" "data structures,greedy,sortings" "\xd0\x9d\xd0\xb0 \xd0\xba\xd0\xbe\xd0\xbe\xd1\x80\xd0\xb4\xd0\xb8\xd0\xbd\xd0\xb0\xd1\x82\xd0\xbd\xd0\xbe\xd0\xb9 \xd0\xbf\xd1\x80\xd1\x8f\xd0\xbc\xd0\xbe\xd0\xb9 \xd1\x81\xd0\xb8\xd0\xb4\xd0\xb8\xd1\x82 n \xd1\x81\xd0\xbe\xd0\xb1\xd0\xb0\xd1\x87\xd0\xb5\xd0\xba, i-\xd1\x8f \xd1\x81\xd0\xbe\xd0\xb1\xd0\xb0\xd1\x87\xd0\xba\xd0\xb0 \xd0\xbd\xd0\xb0\xd1\x85\xd0\xbe\xd0\xb4\xd0\xb8\xd1\x82\xd1\x81\xd1\x8f \xd0\xb2 \xd1\x82\xd0\xbe\xd1\x87\xd0\xba\xd0\xb5 xi. \xd0\x9a\xd1\x80\xd0\xbe\xd0\xbc\xd0\xb5 \xd1\x82\xd0\xbe\xd0\xb3\xd0\xbe, \xd0\xbd\xd0\xb0 \xd0\xbf\xd1\x80\xd1\x8f\xd0\xbc\xd0\xbe\xd0\xb9 \xd0\xb5\xd1\x81\xd1\x82\xd1\x8c m \xd0\xbc\xd0\xb8\xd1\x81\xd0\xbe\xd0\xba \xd1\x81 \xd0\xb5\xd0\xb4\xd0\xbe\xd0\xb9, \xd0\xb4\xd0\xbb\xd1\x8f \xd0\xba\xd0\xb0\xd0\xb6\xd0\xb4\xd0\xbe\xd0\xb9 \xd0\xb8\xd0\xb7\xd0\xb2\xd0\xb5\xd1\x81\xd1\x82\xd0\xbd\xd0\xb0 \xd0\xb5\xd1\x91 \xd0\xba\xd0\xbe\xd0\xbe\xd1\x80\xd0\xb4\xd0\xb8\xd0\xbd\xd0\xb0\xd1\x82\xd0\xb0 \xd0\xbd\xd0\xb0 \xd0\xbf\xd1\x80\xd1\x8f\xd0\xbc\xd0\xbe\xd0\xb9 uj \xd0\xb8 \xd0\xb2\xd1\x80\xd0\xb5\xd0\xbc\xd1\x8f tj, \xd1\x87\xd0\xb5\xd1\x80\xd0\xb5\xd0\xb7 \xd0\xba\xd0\xbe\xd1\x82\xd0\xbe\xd1\x80\xd0\xbe\xd0\xb5 \xd0\xb5\xd0\xb4\xd0\xb0 \xd0\xb2 \xd0\xbc\xd0\xb8\xd1\x81\xd0\xba\xd0\xb5 \xd0\xbe\xd1\x81\xd1\x82\xd1\x8b\xd0\xbd\xd0\xb5\xd1\x82 \xd0\xb8 \xd1\x81\xd1\x82\xd0\xb0\xd0\xbd\xd0\xb5\xd1\x82 \xd0\xbd\xd0\xb5\xd0\xb2\xd0\xba\xd1\x83\xd1\x81\xd0\xbd\xd0\xbe\xd0\xb9. \xd0\xad\xd1\x82\xd0\xbe \xd0\xb7\xd0\xbd\xd0\xb0\xd1\x87\xd0\xb8\xd1\x82, \xd1\x87\xd1\x82\xd0\xbe \xd0\xb5\xd1\x81\xd0\xbb\xd0\xb8 \xd1\x81\xd0\xbe\xd0\xb1\xd0\xb0\xd1\x87\xd0\xba\xd0\xb0 \xd0\xbf\xd1\x80\xd0\xb8\xd0\xb1\xd0\xb5\xd0\xb6\xd0\xb8\xd1\x82 \xd0\xba \xd0\xbc\xd0\xb8\xd1\x81\xd0\xba\xd0\xb5 \xd0\xb2 \xd0\xbc\xd0\xbe\xd0\xbc\xd0\xb5\xd0\xbd\xd1\x82 \xd0\xb2\xd1\x80\xd0\xb5\xd0\xbc\xd0\xb5\xd0\xbd\xd0\xb8, \xd1\x81\xd1\x82\xd1\x80\xd0\xbe\xd0\xb3\xd0\xbe \xd0\xb1\xd0\xbe\xd0\xbb\xd1\x8c\xd1\x88\xd0\xb8\xd0\xb9 tj, \xd1\x82\xd0\xbe \xd0\xb5\xd0\xb4\xd0\xb0 \xd1\x83\xd0\xb6\xd0\xb5 \xd0\xbe\xd1\x81\xd1\x82\xd1\x8b\xd0\xbd\xd0\xb5\xd1\x82, \xd0\xb8 \xd1\x81\xd0\xbe\xd0\xb1\xd0\xb0\xd1\x87\xd0\xba\xd0\xb0 \xd0\xba\xd1\x83\xd1\x88\xd0\xb0\xd1\x82\xd1\x8c \xd0\xb5\xd1\x91 \xd0\xbd\xd0\xb5 \xd1\x81\xd1\x82\xd0\xb0\xd0\xbd\xd0\xb5\xd1\x82.\xd0\xa1\xd1\x87\xd0\xb8\xd1\x82\xd0\xb0\xd1\x8f, \xd1\x87\xd1\x82\xd0\xbe \xd0\xba\xd0\xb0\xd0\xb6\xd0\xb4\xd0\xb0\xd1\x8f \xd1\x81\xd0\xbe\xd0\xb1\xd0\xb0\xd1\x87\xd0\xba\xd0\xb0 \xd0\xb1\xd0\xb5\xd0\xb6\xd0\xb8\xd1\x82 \xd1\x81\xd0\xbe \xd1\x81\xd0\xba\xd0\xbe\xd1\x80\xd0\xbe\xd1\x81\xd1\x82\xd1\x8c\xd1\x8e 1, \xd0\xbd\xd0\xb0\xd0\xb9\xd0\xb4\xd0\xb8\xd1\x82\xd0\xb5 \xd0\xbc\xd0\xb0\xd0\xba\xd1\x81\xd0\xb8\xd0\xbc\xd0\xb0\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe\xd0\xb5 \xd0\xba\xd0\xbe\xd0\xbb\xd0\xb8\xd1\x87\xd0\xb5\xd1\x81\xd1\x82\xd0\xb2\xd0\xbe \xd1\x81\xd0\xbe\xd0\xb1\xd0\xb0\xd1\x87\xd0\xb5\xd0\xba, \xd0\xba\xd0\xbe\xd1\x82\xd0\xbe\xd1\x80\xd1\x8b\xd0\xb5 \xd1\x81\xd0\xbc\xd0\xbe\xd0\xb3\xd1\x83\xd1\x82 \xd0\xbf\xd0\xbe\xd0\xba\xd1\x83\xd1\x88\xd0\xb0\xd1\x82\xd1\x8c. \xd0\xa1\xd1\x87\xd0\xb8\xd1\x82\xd0\xb0\xd0\xb9\xd1\x82\xd0\xb5, \xd1\x87\xd1\x82\xd0\xbe \xd1\x81\xd0\xbe\xd0\xb1\xd0\xb0\xd1\x87\xd0\xba\xd0\xb8 \xd0\xbf\xd0\xbe\xd0\xb1\xd0\xb5\xd0\xb3\xd1\x83\xd1\x82 \xd0\xba \xd1\x82\xd0\xb5\xd0\xbc \xd0\xbc\xd0\xb8\xd1\x81\xd0\xba\xd0\xb0\xd0\xbc, \xd0\xbd\xd0\xb0 \xd0\xba\xd0\xbe\xd1\x82\xd0\xbe\xd1\x80\xd1\x8b\xd0\xb5 \xd0\xb2\xd1\x8b \xd0\xb8\xd0\xbc \xd1\x83\xd0\xba\xd0\xb0\xd0\xb6\xd0\xb5\xd1\x82\xd0\xb5. \xd0\x98\xd0\xb7 \xd0\xbe\xd0\xb4\xd0\xbd\xd0\xbe\xd0\xb9 \xd0\xbc\xd0\xb8\xd1\x81\xd0\xba\xd0\xb8 \xd0\xbd\xd0\xb5 \xd0\xbc\xd0\xbe\xd0\xb3\xd1\x83\xd1\x82 \xd0\xba\xd1\x83\xd1\x88\xd0\xb0\xd1\x82\xd1\x8c \xd0\xb4\xd0\xb2\xd0\xb5 \xd0\xb8\xd0\xbb\xd0\xb8 \xd0\xb1\xd0\xbe\xd0\xbb\xd0\xb5\xd0\xb5 \xd1\x81\xd0\xbe\xd0\xb1\xd0\xb0\xd1\x87\xd0\xba\xd0\xb8.\xd0\xa1\xd0\xbe\xd0\xb1\xd0\xb0\xd1\x87\xd0\xba\xd0\xb8 \xd0\xbc\xd0\xbe\xd0\xb3\xd1\x83\xd1\x82 \xd0\xbe\xd0\xb1\xd0\xb3\xd0\xbe\xd0\xbd\xd1\x8f\xd1\x82\xd1\x8c \xd0\xb4\xd1\x80\xd1\x83\xd0\xb3 \xd0\xb4\xd1\x80\xd1\x83\xd0\xb3\xd0\xb0, \xd1\x82\xd0\xbe \xd0\xb5\xd1\x81\xd1\x82\xd1\x8c, \xd0\xb5\xd1\x81\xd0\xbb\xd0\xb8 \xd0\xbe\xd0\xb4\xd0\xbd\xd0\xb0 \xd0\xb8\xd0\xb7 \xd0\xbd\xd0\xb8\xd1\x85 \xd0\xbe\xd1\x81\xd1\x82\xd0\xb0\xd0\xbd\xd0\xbe\xd0\xb2\xd0\xb8\xd1\x82\xd1\x81\xd1\x8f \xd0\xbf\xd0\xbe\xd0\xba\xd1\x83\xd1\x88\xd0\xb0\xd1\x82\xd1\x8c, \xd0\xb4\xd1\x80\xd1\x83\xd0\xb3\xd0\xb0\xd1\x8f \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xb5\xd1\x82 \xd0\xbf\xd1\x80\xd0\xbe\xd0\xb9\xd1\x82\xd0\xb8 \xd0\xbc\xd0\xb8\xd0\xbc\xd0\xbe \xd0\xbd\xd0\xb5\xd1\x91, \xd1\x87\xd1\x82\xd0\xbe\xd0\xb1\xd1\x8b \xd0\xbf\xd0\xbe\xd0\xbf\xd0\xb0\xd1\x81\xd1\x82\xd1\x8c \xd0\xba \xd0\xb4\xd1\x80\xd1\x83\xd0\xb3\xd0\xbe\xd0\xb9 \xd0\xbc\xd0\xb8\xd1\x81\xd0\xba\xd0\xb5." 1900
648C "\xd0\x9f\xd1\x83\xd1\x82\xd1\x8c \xd0\xa0\xd0\xbe\xd0\xb1\xd0\xbe\xd1\x82\xd0\xb0" "constructive algorithms,dfs and similar,graphs" "\xd0\x92\xd0\xb0\xd0\xbc \xd0\xb7\xd0\xb0\xd0\xb4\xd0\xb0\xd0\xbd\xd0\xbe \xd0\xbf\xd1\x80\xd1\x8f\xd0\xbc\xd0\xbe\xd1\x83\xd0\xb3\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe\xd0\xb5 \xd0\xba\xd0\xbb\xd0\xb5\xd1\x82\xd1\x87\xd0\xb0\xd1\x82\xd0\xbe\xd0\xb5 \xd0\xbf\xd0\xbe\xd0\xbb\xd0\xb5, \xd1\x81\xd0\xbe\xd1\x81\xd1\x82\xd0\xbe\xd1\x8f\xd1\x89\xd0\xb5\xd0\xb5 \xd0\xb8\xd0\xb7 n \xd1\x81\xd1\x82\xd1\x80\xd0\xbe\xd0\xba \xd0\xb8 m \xd1\x81\xd1\x82\xd0\xbe\xd0\xbb\xd0\xb1\xd1\x86\xd0\xbe\xd0\xb2. \xd0\x9f\xd0\xbe\xd0\xbb\xd0\xb5 \xd1\x81\xd0\xbe\xd0\xb4\xd0\xb5\xd1\x80\xd0\xb6\xd0\xb8\xd1\x82 \xd1\x86\xd0\xb8\xd0\xba\xd0\xbb \xd0\xb8\xd0\xb7 \xd1\x81\xd0\xb8\xd0\xbc\xd0\xb2\xd0\xbe\xd0\xbb\xd0\xbe\xd0\xb2 \xc2\xab*\xc2\xbb, \xd1\x82\xd0\xb0\xd0\xba\xd0\xbe\xd0\xb9 \xd1\x87\xd1\x82\xd0\xbe:  \xd1\x86\xd0\xb8\xd0\xba\xd0\xbb \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xbd\xd0\xbe \xd0\xbe\xd0\xb1\xd0\xbe\xd0\xb9\xd1\x82\xd0\xb8, \xd0\xbf\xd0\xbe\xd1\x81\xd0\xb5\xd1\x82\xd0\xb8\xd0\xb2 \xd0\xba\xd0\xb0\xd0\xb6\xd0\xb4\xd1\x83\xd1\x8e \xd0\xb5\xd0\xb3\xd0\xbe \xd0\xba\xd0\xbb\xd0\xb5\xd1\x82\xd0\xba\xd1\x83 \xd1\x80\xd0\xbe\xd0\xb2\xd0\xbd\xd0\xbe \xd0\xbe\xd0\xb4\xd0\xb8\xd0\xbd \xd1\x80\xd0\xb0\xd0\xb7, \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb5\xd0\xbc\xd0\xb5\xd1\x89\xd0\xb0\xd1\x8f\xd1\x81\xd1\x8c \xd0\xba\xd0\xb0\xd0\xb6\xd0\xb4\xd1\x8b\xd0\xb9 \xd1\x80\xd0\xb0\xd0\xb7 \xd0\xb2\xd0\xb2\xd0\xb5\xd1\x80\xd1\x85/\xd0\xb2\xd0\xbd\xd0\xb8\xd0\xb7/\xd0\xb2\xd0\xbf\xd1\x80\xd0\xb0\xd0\xb2\xd0\xbe/\xd0\xb2\xd0\xbb\xd0\xb5\xd0\xb2\xd0\xbe \xd0\xbd\xd0\xb0 \xd0\xbe\xd0\xb4\xd0\xbd\xd1\x83 \xd0\xba\xd0\xbb\xd0\xb5\xd1\x82\xd0\xba\xd1\x83;  \xd1\x86\xd0\xb8\xd0\xba\xd0\xbb \xd0\xbd\xd0\xb5 \xd1\x81\xd0\xbe\xd0\xb4\xd0\xb5\xd1\x80\xd0\xb6\xd0\xb8\xd1\x82 \xd1\x81\xd0\xb0\xd0\xbc\xd0\xbe\xd0\xbf\xd0\xb5\xd1\x80\xd0\xb5\xd1\x81\xd0\xb5\xd1\x87\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb9 \xd0\xb8 \xd1\x81\xd0\xb0\xd0\xbc\xd0\xbe\xd0\xba\xd0\xb0\xd1\x81\xd0\xb0\xd0\xbd\xd0\xb8\xd0\xb9, \xd1\x82\xd0\xbe \xd0\xb5\xd1\x81\xd1\x82\xd1\x8c \xd0\xb4\xd0\xb2\xd0\xb5 \xd0\xba\xd0\xbb\xd0\xb5\xd1\x82\xd0\xba\xd0\xb8 \xd1\x86\xd0\xb8\xd0\xba\xd0\xbb\xd0\xb0 \xd1\x81\xd0\xbe\xd1\x81\xd0\xb5\xd0\xb4\xd1\x81\xd1\x82\xd0\xb2\xd1\x83\xd1\x8e\xd1\x82 \xd0\xbf\xd0\xbe \xd1\x81\xd1\x82\xd0\xbe\xd1\x80\xd0\xbe\xd0\xbd\xd0\xb5 \xd1\x82\xd0\xbe\xd0\xb3\xd0\xb4\xd0\xb0 \xd0\xb8 \xd1\x82\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xba\xd0\xbe \xd1\x82\xd0\xbe\xd0\xb3\xd0\xb4\xd0\xb0, \xd0\xba\xd0\xbe\xd0\xb3\xd0\xb4\xd0\xb0 \xd0\xbe\xd0\xbd\xd0\xb8 \xd1\x81\xd0\xbe\xd1\x81\xd0\xb5\xd0\xb4\xd0\xbd\xd0\xb8\xd0\xb5 \xd0\xbf\xd1\x80\xd0\xb8 \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb5\xd0\xbc\xd0\xb5\xd1\x89\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb8 \xd0\xb2\xd0\xb4\xd0\xbe\xd0\xbb\xd1\x8c \xd1\x86\xd0\xb8\xd0\xba\xd0\xbb\xd0\xb0 (\xd1\x81\xd0\xb0\xd0\xbc\xd0\xbe\xd0\xba\xd0\xb0\xd1\x81\xd0\xb0\xd0\xbd\xd0\xb8\xd0\xb5 \xd0\xbf\xd0\xbe \xd1\x83\xd0\xb3\xd0\xbb\xd1\x83 \xd1\x82\xd0\xbe\xd0\xb6\xd0\xb5 \xd0\xb7\xd0\xb0\xd0\xbf\xd1\x80\xd0\xb5\xd1\x89\xd0\xb5\xd0\xbd\xd0\xbe). \xd0\x9d\xd0\xb8\xd0\xb6\xd0\xb5 \xd0\xb8\xd0\xb7\xd0\xbe\xd0\xb1\xd1\x80\xd0\xb0\xd0\xb6\xd0\xb5\xd0\xbd\xd1\x8b \xd0\xbd\xd0\xb5\xd1\x81\xd0\xba\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xba\xd0\xbe \xd0\xbf\xd1\x80\xd0\xb8\xd0\xbc\xd0\xb5\xd1\x80\xd0\xbe\xd0\xb2 \xd0\xb4\xd0\xbe\xd0\xbf\xd1\x83\xd1\x81\xd1\x82\xd0\xb8\xd0\xbc\xd1\x8b\xd1\x85 \xd1\x86\xd0\xb8\xd0\xba\xd0\xbb\xd0\xbe\xd0\xb2:  \xd0\x92\xd1\x81\xd0\xb5 \xd0\xba\xd0\xbb\xd0\xb5\xd1\x82\xd0\xba\xd0\xb8 \xd0\xbf\xd0\xbe\xd0\xbb\xd1\x8f, \xd0\xbe\xd1\x82\xd0\xbb\xd0\xb8\xd1\x87\xd0\xbd\xd1\x8b\xd0\xb5 \xd0\xbe\xd1\x82 \xd1\x86\xd0\xb8\xd0\xba\xd0\xbb\xd0\xb0, \xd1\x81\xd0\xbe\xd0\xb4\xd0\xb5\xd1\x80\xd0\xb6\xd0\xb0\xd1\x82 \xd1\x81\xd0\xb8\xd0\xbc\xd0\xb2\xd0\xbe\xd0\xbb \xc2\xab.\xc2\xbb. \xd0\xa6\xd0\xb8\xd0\xba\xd0\xbb \xd0\xbd\xd0\xb0 \xd0\xbf\xd0\xbe\xd0\xbb\xd0\xb5 \xd1\x80\xd0\xbe\xd0\xb2\xd0\xbd\xd0\xbe \xd0\xbe\xd0\xb4\xd0\xb8\xd0\xbd. \xd0\x9f\xd0\xbe\xd1\x81\xd0\xb5\xd1\x89\xd0\xb0\xd1\x82\xd1\x8c \xd0\xba\xd0\xbb\xd0\xb5\xd1\x82\xd0\xba\xd0\xb8, \xd0\xbe\xd1\x82\xd0\xbb\xd0\xb8\xd1\x87\xd0\xbd\xd1\x8b\xd0\xb5 \xd0\xbe\xd1\x82 \xd1\x86\xd0\xb8\xd0\xba\xd0\xbb\xd0\xb0, \xd0\xa0\xd0\xbe\xd0\xb1\xd0\xbe\xd1\x82\xd1\x83 \xd0\xbd\xd0\xb5\xd0\xbb\xd1\x8c\xd0\xb7\xd1\x8f.\xd0\x92 \xd0\xbe\xd0\xb4\xd0\xbd\xd0\xbe\xd0\xb9 \xd0\xb8\xd0\xb7 \xd0\xba\xd0\xbb\xd0\xb5\xd1\x82\xd0\xbe\xd0\xba \xd1\x86\xd0\xb8\xd0\xba\xd0\xbb\xd0\xb0 \xd0\xbd\xd0\xb0\xd1\x85\xd0\xbe\xd0\xb4\xd0\xb8\xd1\x82\xd1\x81\xd1\x8f \xd0\xa0\xd0\xbe\xd0\xb1\xd0\xbe\xd1\x82. \xd0\xad\xd1\x82\xd0\xb0 \xd0\xba\xd0\xbb\xd0\xb5\xd1\x82\xd0\xba\xd0\xb0 \xd0\xbf\xd0\xbe\xd0\xbc\xd0\xb5\xd1\x87\xd0\xb5\xd0\xbd\xd0\xb0 \xd1\x81\xd0\xb8\xd0\xbc\xd0\xb2\xd0\xbe\xd0\xbb\xd0\xbe\xd0\xbc \xc2\xabS\xc2\xbb. \xd0\x9d\xd0\xb0\xd0\xb9\xd0\xb4\xd0\xb8\xd1\x82\xd0\xb5 \xd0\xbf\xd0\xbe\xd1\x81\xd0\xbb\xd0\xb5\xd0\xb4\xd0\xbe\xd0\xb2\xd0\xb0\xd1\x82\xd0\xb5\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe\xd1\x81\xd1\x82\xd1\x8c \xd0\xba\xd0\xbe\xd0\xbc\xd0\xb0\xd0\xbd\xd0\xb4 \xd0\xb4\xd0\xbb\xd1\x8f \xd0\xa0\xd0\xbe\xd0\xb1\xd0\xbe\xd1\x82\xd0\xb0, \xd1\x87\xd1\x82\xd0\xbe\xd0\xb1\xd1\x8b \xd0\xbe\xd0\xb1\xd0\xbe\xd0\xb9\xd1\x82\xd0\xb8 \xd1\x86\xd0\xb8\xd0\xba\xd0\xbb. \xd0\x9a\xd0\xb0\xd0\xb6\xd0\xb4\xd0\xb0\xd1\x8f \xd0\xb8\xd0\xb7 \xd1\x87\xd0\xb5\xd1\x82\xd1\x8b\xd1\x80\xd1\x91\xd1\x85 \xd0\xb2\xd0\xbe\xd0\xb7\xd0\xbc\xd0\xbe\xd0\xb6\xd0\xbd\xd1\x8b\xd1\x85 \xd0\xba\xd0\xbe\xd0\xbc\xd0\xb0\xd0\xbd\xd0\xb4 \xd0\xba\xd0\xbe\xd0\xb4\xd0\xb8\xd1\x80\xd1\x83\xd0\xb5\xd1\x82\xd1\x81\xd1\x8f \xd0\xb1\xd1\x83\xd0\xba\xd0\xb2\xd0\xbe\xd0\xb9 \xd0\xb8 \xd0\xbe\xd0\xb1\xd0\xbe\xd0\xb7\xd0\xbd\xd0\xb0\xd1\x87\xd0\xb0\xd0\xb5\xd1\x82 \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb5\xd0\xbc\xd0\xb5\xd1\x89\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb5 \xd0\xa0\xd0\xbe\xd0\xb1\xd0\xbe\xd1\x82\xd0\xb0 \xd0\xbd\xd0\xb0 \xd0\xbe\xd0\xb4\xd0\xbd\xd1\x83 \xd0\xba\xd0\xbb\xd0\xb5\xd1\x82\xd0\xba\xd1\x83:  \xc2\xabU\xc2\xbb \xe2\x80\x94 \xd1\x81\xd0\xb4\xd0\xb2\xd0\xb8\xd0\xbd\xd1\x83\xd1\x82\xd1\x8c\xd1\x81\xd1\x8f \xd0\xbd\xd0\xb0 \xd0\xba\xd0\xbb\xd0\xb5\xd1\x82\xd0\xba\xd1\x83 \xd0\xb2\xd0\xb2\xd0\xb5\xd1\x80\xd1\x85,  \xc2\xabR\xc2\xbb \xe2\x80\x94 \xd1\x81\xd0\xb4\xd0\xb2\xd0\xb8\xd0\xbd\xd1\x83\xd1\x82\xd1\x8c\xd1\x81\xd1\x8f \xd0\xbd\xd0\xb0 \xd0\xba\xd0\xbb\xd0\xb5\xd1\x82\xd0\xba\xd1\x83 \xd0\xb2\xd0\xbf\xd1\x80\xd0\xb0\xd0\xb2\xd0\xbe,  \xc2\xabD\xc2\xbb \xe2\x80\x94 \xd1\x81\xd0\xb4\xd0\xb2\xd0\xb8\xd0\xbd\xd1\x83\xd1\x82\xd1\x8c\xd1\x81\xd1\x8f \xd0\xbd\xd0\xb0 \xd0\xba\xd0\xbb\xd0\xb5\xd1\x82\xd0\xba\xd1\x83 \xd0\xb2\xd0\xbd\xd0\xb8\xd0\xb7,  \xc2\xabL\xc2\xbb \xe2\x80\x94 \xd1\x81\xd0\xb4\xd0\xb2\xd0\xb8\xd0\xbd\xd1\x83\xd1\x82\xd1\x8c\xd1\x81\xd1\x8f \xd0\xbd\xd0\xb0 \xd0\xba\xd0\xbb\xd0\xb5\xd1\x82\xd0\xba\xd1\x83 \xd0\xb2\xd0\xbb\xd0\xb5\xd0\xb2\xd0\xbe. \xd0\xa0\xd0\xbe\xd0\xb1\xd0\xbe\xd1\x82 \xd0\xb4\xd0\xbe\xd0\xbb\xd0\xb6\xd0\xb5\xd0\xbd \xd0\xbe\xd0\xb1\xd0\xbe\xd0\xb9\xd1\x82\xd0\xb8 \xd1\x86\xd0\xb8\xd0\xba\xd0\xbb, \xd0\xbf\xd0\xbe\xd0\xb1\xd1\x8b\xd0\xb2\xd0\xb0\xd0\xb2 \xd0\xb2 \xd0\xba\xd0\xb0\xd0\xb6\xd0\xb4\xd0\xbe\xd0\xb9 \xd0\xb5\xd0\xb3\xd0\xbe \xd0\xba\xd0\xbb\xd0\xb5\xd1\x82\xd0\xba\xd0\xb5 \xd1\x80\xd0\xbe\xd0\xb2\xd0\xbd\xd0\xbe \xd0\xbe\xd0\xb4\xd0\xb8\xd0\xbd \xd1\x80\xd0\xb0\xd0\xb7 (\xd0\xba\xd1\x80\xd0\xbe\xd0\xbc\xd0\xb5 \xd1\x81\xd1\x82\xd0\xb0\xd1\x80\xd1\x82\xd0\xbe\xd0\xb2\xd0\xbe\xd0\xb9 \xd1\x82\xd0\xbe\xd1\x87\xd0\xba\xd0\xb8 \xe2\x80\x94 \xd0\xb2 \xd0\xbd\xd0\xb5\xd0\xb9 \xd0\xbe\xd0\xbd \xd0\xbd\xd0\xb0\xd1\x87\xd0\xb8\xd0\xbd\xd0\xb0\xd0\xb5\xd1\x82 \xd0\xb8 \xd0\xb7\xd0\xb0\xd0\xba\xd0\xb0\xd0\xbd\xd1\x87\xd0\xb8\xd0\xb2\xd0\xb0\xd0\xb5\xd1\x82 \xd1\x81\xd0\xb2\xd0\xbe\xd0\xb9 \xd0\xbf\xd1\x83\xd1\x82\xd1\x8c).\xd0\x9d\xd0\xb0\xd0\xb9\xd0\xb4\xd0\xb8\xd1\x82\xd0\xb5 \xd0\xb8\xd1\x81\xd0\xba\xd0\xbe\xd0\xbc\xd1\x83\xd1\x8e \xd0\xbf\xd0\xbe\xd1\x81\xd0\xbb\xd0\xb5\xd0\xb4\xd0\xbe\xd0\xb2\xd0\xb0\xd1\x82\xd0\xb5\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe\xd1\x81\xd1\x82\xd1\x8c \xd0\xba\xd0\xbe\xd0\xbc\xd0\xb0\xd0\xbd\xd0\xb4, \xd0\xb4\xd0\xbe\xd0\xbf\xd1\x83\xd1\x81\xd0\xba\xd0\xb0\xd0\xb5\xd1\x82\xd1\x81\xd1\x8f \xd0\xbb\xd1\x8e\xd0\xb1\xd0\xbe\xd0\xb5 \xd0\xbd\xd0\xb0\xd0\xbf\xd1\x80\xd0\xb0\xd0\xb2\xd0\xbb\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb5 \xd0\xbe\xd0\xb1\xd1\x85\xd0\xbe\xd0\xb4\xd0\xb0 \xd1\x86\xd0\xb8\xd0\xba\xd0\xbb\xd0\xb0." 1100
648B "\xd0\xa1\xd0\xbe\xd0\xb1\xd0\xb5\xd1\x80\xd0\xb8 \xd1\x81\xd1\x82\xd0\xbe\xd0\xbb" "constructive algorithms,sortings" "\xd0\x92\xd0\xb0\xd1\x81\xd1\x8f \xd0\xba\xd1\x83\xd0\xbf\xd0\xb8\xd0\xbb \xd1\x81\xd1\x82\xd0\xbe\xd0\xbb, \xd1\x83 \xd0\xba\xd0\xbe\xd1\x82\xd0\xbe\xd1\x80\xd0\xbe\xd0\xb3\xd0\xbe n \xd0\xbd\xd0\xbe\xd0\xb6\xd0\xb5\xd0\xba. \xd0\x9a\xd0\xb0\xd0\xb6\xd0\xb4\xd0\xb0\xd1\x8f \xd0\xbd\xd0\xbe\xd0\xb6\xd0\xba\xd0\xb0 \xd1\x81\xd0\xbe\xd1\x81\xd1\x82\xd0\xbe\xd0\xb8\xd1\x82 \xd0\xb8\xd0\xb7 \xd0\xb4\xd0\xb2\xd1\x83\xd1\x85 \xd1\x87\xd0\xb0\xd1\x81\xd1\x82\xd0\xb5\xd0\xb9, \xd0\xba\xd0\xbe\xd1\x82\xd0\xbe\xd1\x80\xd1\x8b\xd0\xb5 \xd1\x81\xd0\xbe\xd0\xb5\xd0\xb4\xd0\xb8\xd0\xbd\xd1\x8f\xd1\x8e\xd1\x82\xd1\x81\xd1\x8f \xd0\xb4\xd1\x80\xd1\x83\xd0\xb3 \xd1\x81 \xd0\xb4\xd1\x80\xd1\x83\xd0\xb3\xd0\xbe\xd0\xbc. \xd0\x9a\xd0\xb0\xd0\xb6\xd0\xb4\xd0\xb0\xd1\x8f \xd1\x87\xd0\xb0\xd1\x81\xd1\x82\xd1\x8c \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xb5\xd1\x82 \xd0\xb1\xd1\x8b\xd1\x82\xd1\x8c \xd0\xbf\xd1\x80\xd0\xbe\xd0\xb8\xd0\xb7\xd0\xb2\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe\xd0\xb9 \xd0\xbf\xd0\xbe\xd0\xbb\xd0\xbe\xd0\xb6\xd0\xb8\xd1\x82\xd0\xb5\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe\xd0\xb9 \xd0\xb4\xd0\xbb\xd0\xb8\xd0\xbd\xd1\x8b, \xd0\xbd\xd0\xbe \xd0\xb3\xd0\xb0\xd1\x80\xd0\xb0\xd0\xbd\xd1\x82\xd0\xb8\xd1\x80\xd1\x83\xd0\xb5\xd1\x82\xd1\x81\xd1\x8f, \xd1\x87\xd1\x82\xd0\xbe \xd0\xb8\xd0\xb7 \xd0\xb2\xd1\x81\xd0\xb5\xd1\x85 2n \xd1\x87\xd0\xb0\xd1\x81\xd1\x82\xd0\xb5\xd0\xb9 \xd0\xb2\xd0\xbe\xd0\xb7\xd0\xbc\xd0\xbe\xd0\xb6\xd0\xbd\xd0\xbe \xd1\x81\xd0\xbe\xd1\x81\xd1\x82\xd0\xb0\xd0\xb2\xd0\xb8\xd1\x82\xd1\x8c n \xd0\xbd\xd0\xbe\xd0\xb6\xd0\xb5\xd0\xba \xd0\xbe\xd0\xb4\xd0\xb8\xd0\xbd\xd0\xb0\xd0\xba\xd0\xbe\xd0\xb2\xd0\xbe\xd0\xb9 \xd0\xb4\xd0\xbb\xd0\xb8\xd0\xbd\xd1\x8b. \xd0\x9f\xd1\x80\xd0\xb8 \xd1\x81\xd0\xbe\xd1\x81\xd1\x82\xd0\xb0\xd0\xb2\xd0\xbb\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb8 \xd0\xbd\xd0\xbe\xd0\xb6\xd0\xba\xd0\xb8 \xd0\xbb\xd1\x8e\xd0\xb1\xd1\x8b\xd0\xb5 \xd0\xb4\xd0\xb2\xd0\xb5 \xd1\x87\xd0\xb0\xd1\x81\xd1\x82\xd0\xb8 \xd0\xbc\xd0\xbe\xd0\xb3\xd1\x83\xd1\x82 \xd0\xb1\xd1\x8b\xd1\x82\xd1\x8c \xd1\x81\xd0\xbe\xd0\xb5\xd0\xb4\xd0\xb8\xd0\xbd\xd0\xb5\xd0\xbd\xd1\x8b \xd0\xb4\xd1\x80\xd1\x83\xd0\xb3 \xd1\x81 \xd0\xb4\xd1\x80\xd1\x83\xd0\xb3\xd0\xbe\xd0\xbc. \xd0\x98\xd0\xb7\xd0\xbd\xd0\xb0\xd1\x87\xd0\xb0\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe \xd0\xb2\xd1\x81\xd0\xb5 \xd0\xbd\xd0\xbe\xd0\xb6\xd0\xba\xd0\xb8 \xd1\x81\xd1\x82\xd0\xbe\xd0\xbb\xd0\xb0 \xd1\x80\xd0\xb0\xd0\xb7\xd0\xbe\xd0\xb1\xd1\x80\xd0\xb0\xd0\xbd\xd1\x8b, \xd0\xb0 \xd0\xb2\xd0\xb0\xd0\xbc \xd0\xb7\xd0\xb0\xd0\xb4\xd0\xb0\xd0\xbd\xd1\x8b \xd0\xb4\xd0\xbb\xd0\xb8\xd0\xbd\xd1\x8b 2n \xd1\x87\xd0\xb0\xd1\x81\xd1\x82\xd0\xb5\xd0\xb9 \xd0\xb2 \xd0\xbf\xd1\x80\xd0\xbe\xd0\xb8\xd0\xb7\xd0\xb2\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe\xd0\xbc \xd0\xbf\xd0\xbe\xd1\x80\xd1\x8f\xd0\xb4\xd0\xba\xd0\xb5.\xd0\x9f\xd0\xbe\xd0\xbc\xd0\xbe\xd0\xb3\xd0\xb8\xd1\x82\xd0\xb5 \xd0\x92\xd0\xb0\xd1\x81\xd0\xb5 \xd1\x81\xd0\xbe\xd0\xb1\xd1\x80\xd0\xb0\xd1\x82\xd1\x8c \xd0\xb2\xd1\x81\xd0\xb5 \xd0\xbd\xd0\xbe\xd0\xb6\xd0\xba\xd0\xb8 \xd1\x81\xd1\x82\xd0\xbe\xd0\xbb\xd0\xb0 \xd1\x82\xd0\xb0\xd0\xba, \xd1\x87\xd1\x82\xd0\xbe\xd0\xb1\xd1\x8b \xd0\xb2\xd1\x81\xd0\xb5 \xd0\xbe\xd0\xbd\xd0\xb8 \xd0\xb1\xd1\x8b\xd0\xbb\xd0\xb8 \xd0\xbe\xd0\xb4\xd0\xb8\xd0\xbd\xd0\xb0\xd0\xba\xd0\xbe\xd0\xb2\xd0\xbe\xd0\xb9 \xd0\xb4\xd0\xbb\xd0\xb8\xd0\xbd\xd1\x8b, \xd1\x80\xd0\xb0\xd0\xb7\xd0\xb1\xd0\xb8\xd0\xb2 \xd0\xb7\xd0\xb0\xd0\xb4\xd0\xb0\xd0\xbd\xd0\xbd\xd1\x8b\xd0\xb5 2n \xd1\x87\xd0\xb0\xd1\x81\xd1\x82\xd0\xb8 \xd0\xbd\xd0\xb0 \xd0\xbf\xd0\xb0\xd1\x80\xd1\x8b \xd0\xbf\xd1\x80\xd0\xb0\xd0\xb2\xd0\xb8\xd0\xbb\xd1\x8c\xd0\xbd\xd1\x8b\xd0\xbc \xd0\xbe\xd0\xb1\xd1\x80\xd0\xb0\xd0\xb7\xd0\xbe\xd0\xbc. \xd0\x9a\xd0\xb0\xd0\xb6\xd0\xb4\xd0\xb0\xd1\x8f \xd0\xbd\xd0\xbe\xd0\xb6\xd0\xba\xd0\xb0 \xd0\xbe\xd0\xb1\xd1\x8f\xd0\xb7\xd0\xb0\xd1\x82\xd0\xb5\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe \xd0\xb4\xd0\xbe\xd0\xbb\xd0\xb6\xd0\xbd\xd0\xb0 \xd0\xb1\xd1\x8b\xd1\x82\xd1\x8c \xd1\x81\xd0\xbe\xd1\x81\xd1\x82\xd0\xb0\xd0\xb2\xd0\xbb\xd0\xb5\xd0\xbd\xd0\xb0 \xd1\x80\xd0\xbe\xd0\xb2\xd0\xbd\xd0\xbe \xd0\xb8\xd0\xb7 \xd0\xb4\xd0\xb2\xd1\x83\xd1\x85 \xd1\x87\xd0\xb0\xd1\x81\xd1\x82\xd0\xb5\xd0\xb9, \xd0\xbd\xd0\xb5 \xd1\x80\xd0\xb0\xd0\xb7\xd1\x80\xd0\xb5\xd1\x88\xd0\xb0\xd0\xb5\xd1\x82\xd1\x81\xd1\x8f \xd0\xb8\xd1\x81\xd0\xbf\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xb7\xd0\xbe\xd0\xb2\xd0\xb0\xd1\x82\xd1\x8c \xd0\xba\xd0\xb0\xd0\xba \xd0\xbd\xd0\xbe\xd0\xb6\xd0\xba\xd1\x83 \xd1\x82\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xba\xd0\xbe \xd0\xbe\xd0\xb4\xd0\xbd\xd1\x83 \xd1\x87\xd0\xb0\xd1\x81\xd1\x82\xd1\x8c." 800
648A "\xd0\x9d\xd0\xb0\xd0\xb8\xd0\xb1\xd0\xbe\xd0\xbb\xd1\x8c\xd1\x88\xd0\xb8\xd0\xb9 \xd0\xbf\xd0\xbe\xd0\xb4\xd1\x8a\xd0\xb5\xd0\xbc" "constructive algorithms,implementation" "\xd0\x9f\xd1\x80\xd0\xbe\xd1\x84\xd0\xb8\xd0\xbb\xd1\x8c \xd0\xb3\xd0\xbe\xd1\x80\xd0\xbd\xd0\xbe\xd0\xb3\xd0\xbe \xd1\x85\xd1\x80\xd0\xb5\xd0\xb1\xd1\x82\xd0\xb0 \xd1\x81\xd1\x85\xd0\xb5\xd0\xbc\xd0\xb0\xd1\x82\xd0\xb8\xd1\x87\xd0\xbd\xd0\xbe \xd0\xb7\xd0\xb0\xd0\xb4\xd0\xb0\xd0\xbd \xd0\xb2 \xd0\xb2\xd0\xb8\xd0\xb4\xd0\xb5 \xd0\xbf\xd1\x80\xd1\x8f\xd0\xbc\xd0\xbe\xd1\x83\xd0\xb3\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe\xd0\xb9 \xd1\x82\xd0\xb0\xd0\xb1\xd0\xbb\xd0\xb8\xd1\x86\xd1\x8b \xd0\xb8\xd0\xb7 \xd1\x81\xd0\xb8\xd0\xbc\xd0\xb2\xd0\xbe\xd0\xbb\xd0\xbe\xd0\xb2 \xc2\xab.\xc2\xbb (\xd0\xbf\xd1\x83\xd1\x81\xd1\x82\xd0\xbe\xd0\xb5 \xd0\xbf\xd1\x80\xd0\xbe\xd1\x81\xd1\x82\xd1\x80\xd0\xb0\xd0\xbd\xd1\x81\xd1\x82\xd0\xb2\xd0\xbe) \xd0\xb8 \xc2\xab*\xc2\xbb (\xd1\x87\xd0\xb0\xd1\x81\xd1\x82\xd1\x8c \xd0\xb3\xd0\xbe\xd1\x80\xd1\x8b). \xd0\x9a\xd0\xb0\xd0\xb6\xd0\xb4\xd1\x8b\xd0\xb9 \xd1\x81\xd1\x82\xd0\xbe\xd0\xbb\xd0\xb1\xd0\xb5\xd1\x86 \xd1\x82\xd0\xb0\xd0\xb1\xd0\xbb\xd0\xb8\xd1\x86\xd1\x8b \xd1\x81\xd0\xbe\xd0\xb4\xd0\xb5\xd1\x80\xd0\xb6\xd0\xb8\xd1\x82 \xd1\x85\xd0\xbe\xd1\x82\xd1\x8f \xd0\xb1\xd1\x8b \xd0\xbe\xd0\xb4\xd0\xbd\xd1\x83 \xc2\xab\xd0\xb7\xd0\xb2\xd1\x91\xd0\xb7\xd0\xb4\xd0\xbe\xd1\x87\xd0\xba\xd1\x83\xc2\xbb. \xd0\x93\xd0\xb0\xd1\x80\xd0\xb0\xd0\xbd\xd1\x82\xd0\xb8\xd1\x80\xd1\x83\xd0\xb5\xd1\x82\xd1\x81\xd1\x8f, \xd1\x87\xd1\x82\xd0\xbe \xd0\xbb\xd1\x8e\xd0\xb1\xd0\xbe\xd0\xb9 \xd0\xb8\xd0\xb7 \xd1\x81\xd0\xb8\xd0\xbc\xd0\xb2\xd0\xbe\xd0\xbb\xd0\xbe\xd0\xb2 \xc2\xab*\xc2\xbb \xd0\xbb\xd0\xb8\xd0\xb1\xd0\xbe \xd0\xbd\xd0\xb0\xd1\x85\xd0\xbe\xd0\xb4\xd0\xb8\xd1\x82\xd1\x81\xd1\x8f \xd0\xb2 \xd0\xbd\xd0\xb8\xd0\xb6\xd0\xbd\xd0\xb5\xd0\xb9 \xd1\x81\xd1\x82\xd1\x80\xd0\xbe\xd0\xba\xd0\xb5 \xd0\xbc\xd0\xb0\xd1\x82\xd1\x80\xd0\xb8\xd1\x86\xd1\x8b, \xd0\xbb\xd0\xb8\xd0\xb1\xd0\xbe \xd0\xbd\xd0\xb5\xd0\xbf\xd0\xbe\xd1\x81\xd1\x80\xd0\xb5\xd0\xb4\xd1\x81\xd1\x82\xd0\xb2\xd0\xb5\xd0\xbd\xd0\xbd\xd0\xbe \xd0\xbf\xd0\xbe\xd0\xb4 \xd0\xbd\xd0\xb8\xd0\xbc \xd0\xbd\xd0\xb0\xd1\x85\xd0\xbe\xd0\xb4\xd0\xb8\xd1\x82\xd1\x81\xd1\x8f \xd0\xb4\xd1\x80\xd1\x83\xd0\xb3\xd0\xbe\xd0\xb9 \xd1\x81\xd0\xb8\xd0\xbc\xd0\xb2\xd0\xbe\xd0\xbb \xc2\xab*\xc2\xbb.  ....................*..*.......*.**.......*.**..*...**.***********   \xd0\x9f\xd1\x80\xd0\xb8\xd0\xbc\xd0\xb5\xd1\x80 \xd0\xb8\xd0\xb7\xd0\xbe\xd0\xb1\xd1\x80\xd0\xb0\xd0\xb6\xd0\xb5\xd0\xbd\xd0\xb8\xd1\x8f \xd0\xb3\xd0\xbe\xd1\x80\xd0\xbd\xd0\xbe\xd0\xb3\xd0\xbe \xd1\x85\xd1\x80\xd0\xb5\xd0\xb1\xd1\x82\xd0\xb0.  \xd0\x9c\xd0\xb0\xd1\x80\xd1\x88\xd1\x80\xd1\x83\xd1\x82 \xd1\x82\xd1\x83\xd1\x80\xd0\xb8\xd1\x81\xd1\x82\xd0\xb0 \xd0\xbf\xd1\x80\xd0\xbe\xd1\x85\xd0\xbe\xd0\xb4\xd0\xb8\xd1\x82 \xd1\x87\xd0\xb5\xd1\x80\xd0\xb5\xd0\xb7 \xd0\xb2\xd0\xb5\xd1\x81\xd1\x8c \xd0\xb3\xd0\xbe\xd1\x80\xd0\xbd\xd1\x8b\xd0\xb9 \xd1\x85\xd1\x80\xd0\xb5\xd0\xb1\xd0\xb5\xd1\x82 \xd1\x81\xd0\xbb\xd0\xb5\xd0\xb2\xd0\xb0 \xd0\xbd\xd0\xb0\xd0\xbf\xd1\x80\xd0\xb0\xd0\xb2\xd0\xbe. \xd0\x9a\xd0\xb0\xd0\xb6\xd0\xb4\xd1\x8b\xd0\xb9 \xd0\xb4\xd0\xb5\xd0\xbd\xd1\x8c \xd1\x82\xd1\x83\xd1\x80\xd0\xb8\xd1\x81\xd1\x82 \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb5\xd0\xbc\xd0\xb5\xd1\x89\xd0\xb0\xd0\xb5\xd1\x82\xd1\x81\xd1\x8f \xd0\xb2\xd0\xbf\xd1\x80\xd0\xb0\xd0\xb2\xd0\xbe \xe2\x80\x94 \xd0\xb2 \xd1\x81\xd0\xbe\xd1\x81\xd0\xb5\xd0\xb4\xd0\xbd\xd0\xb8\xd0\xb9 \xd1\x81\xd1\x82\xd0\xbe\xd0\xbb\xd0\xb1\xd0\xb5\xd1\x86 \xd0\xb2 \xd1\x81\xd1\x85\xd0\xb5\xd0\xbc\xd0\xb0\xd1\x82\xd0\xb8\xd1\x87\xd0\xbd\xd0\xbe\xd0\xbc \xd0\xb8\xd0\xb7\xd0\xbe\xd0\xb1\xd1\x80\xd0\xb0\xd0\xb6\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb8. \xd0\x9a\xd0\xbe\xd0\xbd\xd0\xb5\xd1\x87\xd0\xbd\xd0\xbe, \xd0\xba\xd0\xb0\xd0\xb6\xd0\xb4\xd1\x8b\xd0\xb9 \xd1\x80\xd0\xb0\xd0\xb7 \xd0\xbe\xd0\xbd \xd0\xbf\xd0\xbe\xd0\xb4\xd0\xbd\xd0\xb8\xd0\xbc\xd0\xb0\xd0\xb5\xd1\x82\xd1\x81\xd1\x8f (\xd0\xb8\xd0\xbb\xd0\xb8 \xd0\xbe\xd0\xbf\xd1\x83\xd1\x81\xd0\xba\xd0\xb0\xd0\xb5\xd1\x82\xd1\x81\xd1\x8f) \xd0\xb2 \xd1\x81\xd0\xb0\xd0\xbc\xd1\x83\xd1\x8e \xd0\xb2\xd0\xb5\xd1\x80\xd1\x85\xd0\xbd\xd1\x8e\xd1\x8e \xd1\x82\xd0\xbe\xd1\x87\xd0\xba\xd1\x83 \xd0\xb3\xd0\xbe\xd1\x80\xd1\x8b, \xd0\xba\xd0\xbe\xd1\x82\xd0\xbe\xd1\x80\xd0\xb0\xd1\x8f \xd0\xbd\xd0\xb0\xd1\x85\xd0\xbe\xd0\xb4\xd0\xb8\xd1\x82\xd1\x81\xd1\x8f \xd0\xb2 \xd1\x81\xd0\xbe\xd0\xbe\xd1\x82\xd0\xb2\xd0\xb5\xd1\x82\xd1\x81\xd1\x82\xd0\xb2\xd1\x83\xd1\x8e\xd1\x89\xd0\xb5\xd0\xbc \xd1\x81\xd1\x82\xd0\xbe\xd0\xbb\xd0\xb1\xd1\x86\xd0\xb5.\xd0\xa1\xd1\x87\xd0\xb8\xd1\x82\xd0\xb0\xd1\x8f, \xd1\x87\xd1\x82\xd0\xbe \xd0\xb8\xd0\xb7\xd0\xbd\xd0\xb0\xd1\x87\xd0\xb0\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe \xd1\x82\xd1\x83\xd1\x80\xd0\xb8\xd1\x81\xd1\x82 \xd0\xbd\xd0\xb0\xd1\x85\xd0\xbe\xd0\xb4\xd0\xb8\xd1\x82\xd1\x81\xd1\x8f \xd0\xb2 \xd1\x81\xd0\xb0\xd0\xbc\xd0\xbe\xd0\xb9 \xd0\xb2\xd0\xb5\xd1\x80\xd1\x85\xd0\xbd\xd0\xb5\xd0\xb9 \xd1\x82\xd0\xbe\xd1\x87\xd0\xba\xd0\xb5 \xd0\xb2 \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb2\xd0\xbe\xd0\xbc \xd1\x81\xd1\x82\xd0\xbe\xd0\xbb\xd0\xb1\xd1\x86\xd0\xb5, \xd0\xb0 \xd0\xb7\xd0\xb0\xd0\xba\xd0\xbe\xd0\xbd\xd1\x87\xd0\xb8\xd1\x82 \xd1\x81\xd0\xb2\xd0\xbe\xd0\xb9 \xd0\xbc\xd0\xb0\xd1\x80\xd1\x88\xd1\x80\xd1\x83\xd1\x82 \xd0\xb2 \xd1\x81\xd0\xb0\xd0\xbc\xd0\xbe\xd0\xb9 \xd0\xb2\xd0\xb5\xd1\x80\xd1\x85\xd0\xbd\xd0\xb5\xd0\xb9 \xd1\x82\xd0\xbe\xd1\x87\xd0\xba\xd0\xb5 \xd0\xb2 \xd0\xbf\xd0\xbe\xd1\x81\xd0\xbb\xd0\xb5\xd0\xb4\xd0\xbd\xd0\xb5\xd0\xbc \xd1\x81\xd1\x82\xd0\xbe\xd0\xbb\xd0\xb1\xd1\x86\xd0\xb5, \xd0\xbd\xd0\xb0\xd0\xb9\xd0\xb4\xd0\xb8\xd1\x82\xd0\xb5 \xd0\xb4\xd0\xb2\xd0\xb5 \xd0\xb2\xd0\xb5\xd0\xbb\xd0\xb8\xd1\x87\xd0\xb8\xd0\xbd\xd1\x8b:  \xd0\xbd\xd0\xb0\xd0\xb8\xd0\xb1\xd0\xbe\xd0\xbb\xd1\x8c\xd1\x88\xd0\xb8\xd0\xb9 \xd0\xbf\xd0\xbe\xd0\xb4\xd1\x8a\xd1\x91\xd0\xbc \xd0\xb7\xd0\xb0 \xd0\xb4\xd0\xb5\xd0\xbd\xd1\x8c (\xd1\x80\xd0\xb0\xd0\xb2\xd0\xb5\xd0\xbd 0, \xd0\xb5\xd1\x81\xd0\xbb\xd0\xb8 \xd0\xb2 \xd0\xbf\xd1\x80\xd0\xbe\xd1\x84\xd0\xb8\xd0\xbb\xd0\xb5 \xd0\xb3\xd0\xbe\xd1\x80\xd0\xbd\xd0\xbe\xd0\xb3\xd0\xbe \xd1\x85\xd1\x80\xd0\xb5\xd0\xb1\xd1\x82\xd0\xb0 \xd0\xbd\xd0\xb5\xd1\x82 \xd0\xbd\xd0\xb8 \xd0\xbe\xd0\xb4\xd0\xbd\xd0\xbe\xd0\xb3\xd0\xbe \xd0\xbf\xd0\xbe\xd0\xb4\xd1\x8a\xd1\x91\xd0\xbc\xd0\xb0),  \xd0\xbd\xd0\xb0\xd0\xb8\xd0\xb1\xd0\xbe\xd0\xbb\xd1\x8c\xd1\x88\xd0\xb8\xd0\xb9 \xd1\x81\xd0\xbf\xd1\x83\xd1\x81\xd0\xba \xd0\xb7\xd0\xb0 \xd0\xb4\xd0\xb5\xd0\xbd\xd1\x8c (\xd1\x80\xd0\xb0\xd0\xb2\xd0\xb5\xd0\xbd 0, \xd0\xb5\xd1\x81\xd0\xbb\xd0\xb8 \xd0\xb2 \xd0\xbf\xd1\x80\xd0\xbe\xd1\x84\xd0\xb8\xd0\xbb\xd0\xb5 \xd0\xb3\xd0\xbe\xd1\x80\xd0\xbd\xd0\xbe\xd0\xb3\xd0\xbe \xd1\x85\xd1\x80\xd0\xb5\xd0\xb1\xd1\x82\xd0\xb0 \xd0\xbd\xd0\xb5\xd1\x82 \xd0\xbd\xd0\xb8 \xd0\xbe\xd0\xb4\xd0\xbd\xd0\xbe\xd0\xb3\xd0\xbe \xd1\x81\xd0\xbf\xd1\x83\xd1\x81\xd0\xba\xd0\xb0)." 900
645G "Armistice Area Apportionment" "binary search,geometry" "After a drawn-out mooclear arms race, Farmer John and the Mischievous Mess Makers have finally agreed to establish peace. They plan to divide the territory of Bovinia with a line passing through at least two of the n outposts scattered throughout the land. These outposts, remnants of the conflict, are located at the points (x1,\xe2\x80\x89y1),\xe2\x80\x89(x2,\xe2\x80\x89y2),\xe2\x80\x89...,\xe2\x80\x89(xn,\xe2\x80\x89yn).In order to find the optimal dividing line, Farmer John and Elsie have plotted a map of Bovinia on the coordinate plane. Farmer John\'s farm and the Mischievous Mess Makers\' base are located at the points P\xe2\x80\x89=\xe2\x80\x89(a,\xe2\x80\x890) and Q\xe2\x80\x89=\xe2\x80\x89(\xe2\x80\x89-\xe2\x80\x89a,\xe2\x80\x890), respectively. Because they seek a lasting peace, Farmer John and Elsie would like to minimize the maximum difference between the distances from any point on the line to P and Q.Formally, define the difference of a line  relative to two points P and Q as the smallest real number d so that for all points X on line , |PX\xe2\x80\x89-\xe2\x80\x89QX|\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89d. (It is guaranteed that d exists and is unique.) They wish to find the line  passing through two distinct outposts (xi,\xe2\x80\x89yi) and (xj,\xe2\x80\x89yj) such that the difference of  relative to P and Q is minimized." 3200
645F "Cowslip Collections" "combinatorics,math,number theory" "In an attempt to make peace with the Mischievious Mess Makers, Bessie and Farmer John are planning to plant some flower gardens to complement the lush, grassy fields of Bovinia. As any good horticulturist knows, each garden they plant must have the exact same arrangement of flowers. Initially, Farmer John has n different species of flowers he can plant, with ai flowers of the i-th species.On each of the next q days, Farmer John will receive a batch of flowers of a new species. On day j, he will receive cj flowers of the same species, but of a different species from those Farmer John already has. Farmer John, knowing the right balance between extravagance and minimalism, wants exactly k species of flowers to be used. Furthermore, to reduce waste, each flower of the k species Farmer John chooses must be planted in some garden. And each of the gardens must be identical; that is to say that each of the k chosen species should have an equal number of flowers in each garden. As Farmer John is a proponent of national equality, he would like to create the greatest number of gardens possible.After receiving flowers on each of these q days, Farmer John would like to know the sum, over all possible choices of k species, of the maximum number of gardens he could create. Since this could be a large number, you should output your result modulo 109\xe2\x80\x89+\xe2\x80\x897." 2500
645E "Intellectual Inquiry" dp,greedy,strings "After getting kicked out of her reporting job for not knowing the alphabet, Bessie has decided to attend school at the Fillet and Eggs Eater Academy. She has been making good progress with her studies and now knows the first k English letters.Each morning, Bessie travels to school along a sidewalk consisting of m\xe2\x80\x89+\xe2\x80\x89n tiles. In order to help Bessie review, Mr. Moozing has labeled each of the first m sidewalk tiles with one of the first k lowercase English letters, spelling out a string t. Mr. Moozing, impressed by Bessie\'s extensive knowledge of farm animals, plans to let her finish labeling the last n tiles of the sidewalk by herself.Consider the resulting string s (|s|\xe2\x80\x89=\xe2\x80\x89m\xe2\x80\x89+\xe2\x80\x89n) consisting of letters labeled on tiles in order from home to school. For any sequence of indices p1\xe2\x80\x89<\xe2\x80\x89p2\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89pq we can define subsequence of the string s as string sp1sp2... spq. Two subsequences are considered to be distinct if they differ as strings. Bessie wants to label the remaining part of the sidewalk such that the number of distinct subsequences of tiles is maximum possible. However, since Bessie hasn\'t even finished learning the alphabet, she needs your help!Note that empty subsequence also counts." 2200
645D "Robot Rapping Results Report" "binary search,dp,graphs" "While Farmer John rebuilds his farm in an unfamiliar portion of Bovinia, Bessie is out trying some alternative jobs. In her new gig as a reporter, Bessie needs to know about programming competition results as quickly as possible. When she covers the 2016 Robot Rap Battle Tournament, she notices that all of the robots operate under deterministic algorithms. In particular, robot i will beat robot j if and only if robot i has a higher skill level than robot j. And if robot i beats robot j and robot j beats robot k, then robot i will beat robot k. Since rapping is such a subtle art, two robots can never have the same skill level.Given the results of the rap battles in the order in which they were played, determine the minimum number of first rap battles that needed to take place before Bessie could order all of the robots by skill level." 1800
645C "Enduring Exodus" "binary search,two pointers" "In an attempt to escape the Mischievous Mess Makers\' antics, Farmer John has abandoned his farm and is traveling to the other side of Bovinia. During the journey, he and his k cows have decided to stay at the luxurious Grand Moo-dapest Hotel. The hotel consists of n rooms located in a row, some of which are occupied.Farmer John wants to book a set of k\xe2\x80\x89+\xe2\x80\x891 currently unoccupied rooms for him and his cows. He wants his cows to stay as safe as possible, so he wishes to minimize the maximum distance from his room to the room of his cow. The distance between rooms i and j is defined as |j\xe2\x80\x89-\xe2\x80\x89i|. Help Farmer John protect his cows by calculating this minimum possible distance." 1600
645B "Mischievous Mess Makers" greedy,math "It is a balmy spring afternoon, and Farmer John\'s n cows are ruminating about link-cut cacti in their stalls. The cows, labeled 1 through n, are arranged so that the i-th cow occupies the i-th stall from the left. However, Elsie, after realizing that she will forever live in the shadows beyond Bessie\'s limelight, has formed the Mischievous Mess Makers and is plotting to disrupt this beautiful pastoral rhythm. While Farmer John takes his k minute long nap, Elsie and the Mess Makers plan to repeatedly choose two distinct stalls and swap the cows occupying those stalls, making no more than one swap each minute.Being the meticulous pranksters that they are, the Mischievous Mess Makers would like to know the maximum messiness attainable in the k minutes that they have. We denote as pi the label of the cow in the i-th stall. The messiness of an arrangement of cows is defined as the number of pairs (i,\xe2\x80\x89j) such that i\xe2\x80\x89<\xe2\x80\x89j and pi\xe2\x80\x89>\xe2\x80\x89pj." 1200
645A "Amity Assessment" "brute force,constructive algorithms,implementation" "Bessie the cow and her best friend Elsie each received a sliding puzzle on Pi Day. Their puzzles consist of a 2\xe2\x80\x89\xc3\x97\xe2\x80\x892 grid and three tiles labeled \'A\', \'B\', and \'C\'. The three tiles sit on top of the grid, leaving one grid cell empty. To make a move, Bessie or Elsie can slide a tile adjacent to the empty cell into the empty cell as shown below:  In order to determine if they are truly Best Friends For Life (BFFLs), Bessie and Elsie would like to know if there exists a sequence of moves that takes their puzzles to the same configuration (moves can be performed in both puzzles). Two puzzles are considered to be in the same configuration if each tile is on top of the same grid cell in both puzzles. Since the tiles are labeled with letters, rotations and reflections are not allowed." 1200
644C "Hostname Aliases" "*special problem,binary search,data structures,implementation,sortings,strings" "There are some websites that are accessible through several different addresses. For example, for a long time Codeforces was accessible with two hostnames codeforces.com and codeforces.ru.You are given a list of page addresses being queried. For simplicity we consider all addresses to have the form http://<hostname>[/<path>], where:  <hostname> \xe2\x80\x94 server name (consists of words and maybe some dots separating them),  /<path> \xe2\x80\x94 optional part, where <path> consists of words separated by slashes. We consider two <hostname> to correspond to one website if for each query to the first <hostname> there will be exactly the same query to the second one and vice versa \xe2\x80\x94 for each query to the second <hostname> there will be the same query to the first one. Take a look at the samples for further clarifications.Your goal is to determine the groups of server names that correspond to one website. Ignore groups consisting of the only server name.Please note, that according to the above definition queries http://<hostname> and http://<hostname>/ are different." 2100
644B "Processing Queries" "*special problem,constructive algorithms,data structures,two pointers" "In this problem you have to simulate the workflow of one-thread server. There are n queries to process, the i-th will be received at moment ti and needs to be processed for di units of time. All ti are guaranteed to be distinct.When a query appears server may react in three possible ways:   If server is free and query queue is empty, then server immediately starts to process this query.  If server is busy and there are less than b queries in the queue, then new query is added to the end of the queue.  If server is busy and there are already b queries pending in the queue, then new query is just rejected and will never be processed. As soon as server finished to process some query, it picks new one from the queue (if it\'s not empty, of course). If a new query comes at some moment x, and the server finishes to process another query at exactly the same moment, we consider that first query is picked from the queue and only then new query appears.For each query find the moment when the server will finish to process it or print -1 if this query will be rejected." 1700
644A "Parliament of Berland" "*special problem,constructive algorithms" "There are n parliamentarians in Berland. They are numbered with integers from 1 to n. It happened that all parliamentarians with odd indices are Democrats and all parliamentarians with even indices are Republicans.New parliament assembly hall is a rectangle consisting of a\xe2\x80\x89\xc3\x97\xe2\x80\x89b chairs \xe2\x80\x94 a rows of b chairs each. Two chairs are considered neighbouring if they share as side. For example, chair number 5 in row number 2 is neighbouring to chairs number 4 and 6 in this row and chairs with number 5 in rows 1 and 3. Thus, chairs have four neighbours in general, except for the chairs on the border of the hallWe know that if two parliamentarians from one political party (that is two Democrats or two Republicans) seat nearby they spent all time discussing internal party issues.Write the program that given the number of parliamentarians and the sizes of the hall determine if there is a way to find a seat for any parliamentarian, such that no two members of the same party share neighbouring seats." 1000
643G "Choosing Ads" "data structures" "One social network developer recently suggested a new algorithm of choosing ads for users.There are n slots which advertisers can buy. It is possible to buy a segment of consecutive slots at once. The more slots you own, the bigger are the chances your ad will be shown to users.Every time it is needed to choose ads to show, some segment of slots is picked by a secret algorithm. Then some advertisers are chosen. The only restriction is that it should be guaranteed for advertisers which own at least p% of slots composing this segment that their ad will be shown.From the other side, users don\'t like ads. So it was decided to show no more than  ads at once. You are asked to develop a system to sell segments of slots and choose ads in accordance with the rules described above." 3200
643F "Bears and Juice" dp,math,meet-in-the-middle "There are n bears in the inn and p places to sleep. Bears will party together for some number of nights (and days).Bears love drinking juice. They don\'t like wine but they can\'t distinguish it from juice by taste or smell.A bear doesn\'t sleep unless he drinks wine. A bear must go to sleep a few hours after drinking a wine. He will wake up many days after the party is over.Radewoosh is the owner of the inn. He wants to put some number of barrels in front of bears. One barrel will contain wine and all other ones will contain juice. Radewoosh will challenge bears to find a barrel with wine.Each night, the following happens in this exact order:  Each bear must choose a (maybe empty) set of barrels. The same barrel may be chosen by many bears.  Each bear drinks a glass from each barrel he chose.  All bears who drink wine go to sleep (exactly those bears who chose a barrel with wine). They will wake up many days after the party is over. If there are not enough places to sleep then bears lose immediately. At the end, if it\'s sure where wine is and there is at least one awake bear then bears win (unless they have lost before because of the number of places to sleep).Radewoosh wants to allow bears to win. He considers q scenarios. In the i-th scenario the party will last for i nights. Then, let Ri denote the maximum number of barrels for which bears surely win if they behave optimally. Let\'s define . Your task is to find , where  denotes the exclusive or (also denoted as XOR).Note that the same barrel may be chosen by many bears and all of them will go to sleep at once." 2900
643E "Bear and Destroying Subtrees" dp,math,probabilities,trees "Limak is a little grizzly bear. He will once attack Deerland but now he can only destroy trees in role-playing games. Limak starts with a tree with one vertex. The only vertex has index 1 and is a root of the tree.Sometimes, a game chooses a subtree and allows Limak to attack it. When a subtree is attacked then each of its edges is destroyed with probability , independently of other edges. Then, Limak gets the penalty \xe2\x80\x94 an integer equal to the height of the subtree after the attack. The height is defined as the maximum number of edges on the path between the root of the subtree and any vertex in the subtree.You must handle queries of two types.  1 v denotes a query of the first type. A new vertex appears and its parent is v. A new vertex has the next available index (so, new vertices will be numbered 2,\xe2\x80\x893,\xe2\x80\x89...).  2 v denotes a query of the second type. For a moment let\'s assume that the game allows Limak to attack a subtree rooted in v. Then, what would be the expected value of the penalty Limak gets after the attack? In a query of the second type, Limak doesn\'t actually attack the subtree and thus the query doesn\'t affect next queries." 2700
643D "Bearish Fanpages" NA "There is a social website with n fanpages, numbered 1 through n. There are also n companies, and the i-th company owns the i-th fanpage.Recently, the website created a feature called following. Each fanpage must choose exactly one other fanpage to follow.The website doesn\xe2\x80\x99t allow a situation where i follows j and at the same time j follows i. Also, a fanpage can\'t follow itself.Let\xe2\x80\x99s say that fanpage i follows some other fanpage j0. Also, let\xe2\x80\x99s say that i is followed by k other fanpages j1,\xe2\x80\x89j2,\xe2\x80\x89...,\xe2\x80\x89jk. Then, when people visit fanpage i they see ads from k\xe2\x80\x89+\xe2\x80\x892 distinct companies: i,\xe2\x80\x89j0,\xe2\x80\x89j1,\xe2\x80\x89...,\xe2\x80\x89jk. Exactly ti people subscribe (like) the i-th fanpage, and each of them will click exactly one add. For each of k\xe2\x80\x89+\xe2\x80\x891 companies j0,\xe2\x80\x89j1,\xe2\x80\x89...,\xe2\x80\x89jk, exactly  people will click their ad. Remaining  people will click an ad from company i (the owner of the fanpage).The total income of the company is equal to the number of people who click ads from this copmany.Limak and Radewoosh ask you for help. Initially, fanpage i follows fanpage fi. Your task is to handle q queries of three types:  1 i j \xe2\x80\x94 fanpage i follows fanpage j from now. It\'s guaranteed that i didn\'t follow j just before the query. Note an extra constraint for the number of queries of this type (below, in the Input section).  2 i \xe2\x80\x94 print the total income of the i-th company.  3 \xe2\x80\x94 print two integers: the smallest income of one company and the biggest income of one company." 2900
643C "Levels and Regions" dp "Radewoosh is playing a computer game. There are n levels, numbered 1 through n. Levels are divided into k regions (groups). Each region contains some positive number of consecutive levels.The game repeats the the following process: If all regions are beaten then the game ends immediately. Otherwise, the system finds the first region with at least one non-beaten level. Let X denote this region. The system creates an empty bag for tokens. Each token will represent one level and there may be many tokens representing the same level.  For each already beaten level i in the region X, the system adds ti tokens to the bag (tokens representing the i-th level).  Let j denote the first non-beaten level in the region X. The system adds tj tokens to the bag.  Finally, the system takes a uniformly random token from the bag and a player starts the level represented by the token. A player spends one hour and beats the level, even if he has already beaten it in the past. Given n, k and values t1,\xe2\x80\x89t2,\xe2\x80\x89...,\xe2\x80\x89tn, your task is to split levels into regions. Each level must belong to exactly one region, and each region must contain non-empty consecutive set of levels. What is the minimum possible expected number of hours required to finish the game?" 2400
643B "Bear and Two Paths" "constructive algorithms,graphs" "Bearland has n cities, numbered 1 through n. Cities are connected via bidirectional roads. Each road connects two distinct cities. No two roads connect the same pair of cities.Bear Limak was once in a city a and he wanted to go to a city b. There was no direct connection so he decided to take a long walk, visiting each city exactly once. Formally:   There is no road between a and b.  There exists a sequence (path) of n distinct cities v1,\xe2\x80\x89v2,\xe2\x80\x89...,\xe2\x80\x89vn that v1\xe2\x80\x89=\xe2\x80\x89a, vn\xe2\x80\x89=\xe2\x80\x89b and there is a road between vi and vi\xe2\x80\x89+\xe2\x80\x891 for . On the other day, the similar thing happened. Limak wanted to travel between a city c and a city d. There is no road between them but there exists a sequence of n distinct cities u1,\xe2\x80\x89u2,\xe2\x80\x89...,\xe2\x80\x89un that u1\xe2\x80\x89=\xe2\x80\x89c, un\xe2\x80\x89=\xe2\x80\x89d and there is a road between ui and ui\xe2\x80\x89+\xe2\x80\x891 for .Also, Limak thinks that there are at most k roads in Bearland. He wonders whether he remembers everything correctly.Given n, k and four distinct cities a, b, c, d, can you find possible paths (v1,\xe2\x80\x89...,\xe2\x80\x89vn) and (u1,\xe2\x80\x89...,\xe2\x80\x89un) to satisfy all the given conditions? Find any solution or print -1 if it\'s impossible." 1600
643A "Bear and Colors" implementation "Bear Limak has n colored balls, arranged in one long row. Balls are numbered 1 through n, from left to right. There are n possible colors, also numbered 1 through n. The i-th ball has color ti.For a fixed interval (set of consecutive elements) of balls we can define a dominant color. It\'s a color occurring the biggest number of times in the interval. In case of a tie between some colors, the one with the smallest number (index) is chosen as dominant.There are  non-empty intervals in total. For each color, your task is to count the number of intervals in which this color is dominant." 1500
641G "Little Artem and Graph" NA "Little Artem is given a graph, constructed as follows: start with some k-clique, then add new vertices one by one, connecting them to k already existing vertices that form a k-clique.Artem wants to count the number of spanning trees in this graph modulo 109\xe2\x80\x89+\xe2\x80\x897." 2300
641F "Little Artem and 2-SAT" NA "Little Artem is a very smart programmer. He knows many different difficult algorithms. Recently he has mastered in 2-SAT one.In computer science, 2-satisfiability (abbreviated as 2-SAT) is the special case of the problem of determining whether a conjunction (logical AND) of disjunctions (logical OR) have a solution, in which all disjunctions consist of no more than two arguments (variables). For the purpose of this problem we consider only 2-SAT formulas where each disjunction consists of exactly two arguments.Consider the following 2-SAT problem as an example: . Note that there might be negations in 2-SAT formula (like for x1 and for x4).Artem now tries to solve as many problems with 2-SAT as possible. He found a very interesting one, which he can not solve yet. Of course, he asks you to help him. The problem is: given two 2-SAT formulas f and g, determine whether their sets of possible solutions are the same. Otherwise, find any variables assignment x such that f(x)\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89g(x)." 3000
641E "Little Artem and Time Machine" "data structures" "Little Artem has invented a time machine! He could go anywhere in time, but all his thoughts of course are with computer science. He wants to apply this time machine to a well-known data structure: multiset.Artem wants to create a basic multiset of integers. He wants these structure to support operations of three types:  Add integer to the multiset. Note that the difference between set and multiset is that multiset may store several instances of one integer.  Remove integer from the multiset. Only one instance of this integer is removed. Artem doesn\'t want to handle any exceptions, so he assumes that every time remove operation is called, that integer is presented in the multiset.  Count the number of instances of the given integer that are stored in the multiset. But what about time machine? Artem doesn\'t simply apply operations to the multiset one by one, he now travels to different moments of time and apply his operation there. Consider the following example.  First Artem adds integer 5 to the multiset at the 1-st moment of time.  Then Artem adds integer 3 to the multiset at the moment 5.  Then Artem asks how many 5 are there in the multiset at moment 6. The answer is 1.  Then Artem returns back in time and asks how many integers 3 are there in the set at moment 4. Since 3 was added only at moment 5, the number of integers 3 at moment 4 equals to 0.  Then Artem goes back in time again and removes 5 from the multiset at moment 3.  Finally Artyom asks at moment 7 how many integers 5 are there in the set. The result is 0, since we have removed 5 at the moment 3. Note that Artem dislikes exceptions so much that he assures that after each change he makes all delete operations are applied only to element that is present in the multiset. The answer to the query of the third type is computed at the moment Artem makes the corresponding query and are not affected in any way by future changes he makes.Help Artem implement time travellers multiset." 2000
641D "Little Artem and Random Variable" dp,implementation,math,probabilities "Little Artyom decided to study probability theory. He found a book with a lot of nice exercises and now wants you to help him with one of them.Consider two dices. When thrown each dice shows some integer from 1 to n inclusive. For each dice the probability of each outcome is given (of course, their sum is 1), and different dices may have different probability distributions.We throw both dices simultaneously and then calculate values max(a,\xe2\x80\x89b) and min(a,\xe2\x80\x89b), where a is equal to the outcome of the first dice, while b is equal to the outcome of the second dice. You don\'t know the probability distributions for particular values on each dice, but you know the probability distributions for max(a,\xe2\x80\x89b) and min(a,\xe2\x80\x89b). That is, for each x from 1 to n you know the probability that max(a,\xe2\x80\x89b) would be equal to x and the probability that min(a,\xe2\x80\x89b) would be equal to x. Find any valid probability distribution for values on the dices. It\'s guaranteed that the input data is consistent, that is, at least one solution exists." 2400
641C "Little Artem and Dance" "brute force,constructive algorithms,implementation" "Little Artem is fond of dancing. Most of all dances Artem likes rueda \xe2\x80\x94 Cuban dance that is danced by pairs of boys and girls forming a circle and dancing together.More detailed, there are n pairs of boys and girls standing in a circle. Initially, boy number 1 dances with a girl number 1, boy number 2 dances with a girl number 2 and so on. Girls are numbered in the clockwise order. During the dance different moves are announced and all pairs perform this moves. While performing moves boys move along the circle, while girls always stay at their initial position. For the purpose of this problem we consider two different types of moves:  Value x and some direction are announced, and all boys move x positions in the corresponding direction.  Boys dancing with even-indexed girls swap positions with boys who are dancing with odd-indexed girls. That is the one who was dancing with the girl 1 swaps with the one who was dancing with the girl number 2, while the one who was dancing with girl number 3 swaps with the one who was dancing with the girl number 4 and so one. It\'s guaranteed that n is even. Your task is to determine the final position of each boy." 1800
641B "Little Artem and Matrix" implementation "Little Artem likes electronics. He can spend lots of time making different schemas and looking for novelties in the nearest electronics store. The new control element was delivered to the store recently and Artem immediately bought it.That element can store information about the matrix of integers size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m. There are n\xe2\x80\x89+\xe2\x80\x89m inputs in that element, i.e. each row and each column can get the signal. When signal comes to the input corresponding to some row, this row cyclically shifts to the left, that is the first element of the row becomes last element, second element becomes first and so on. When signal comes to the input corresponding to some column, that column shifts cyclically to the top, that is first element of the column becomes last element, second element becomes first and so on. Rows are numbered with integers from 1 to n from top to bottom, while columns are numbered with integers from 1 to m from left to right.Artem wants to carefully study this element before using it. For that purpose he is going to set up an experiment consisting of q turns. On each turn he either sends the signal to some input or checks what number is stored at some position of the matrix.Artem has completed his experiment and has written down the results, but he has lost the chip! Help Artem find any initial matrix that will match the experiment results. It is guaranteed that experiment data is consistent, which means at least one valid matrix exists." 1400
641A "Little Artem and Grasshopper" implementation "Little Artem found a grasshopper. He brought it to his house and constructed a jumping area for him.The area looks like a strip of cells 1\xe2\x80\x89\xc3\x97\xe2\x80\x89n. Each cell contains the direction for the next jump and the length of that jump. Grasshopper starts in the first cell and follows the instructions written on the cells. Grasshopper stops immediately if it jumps out of the strip. Now Artem wants to find out if this will ever happen." 1000
639F "Bear and Chemistry" "data structures,dfs and similar,graphs,trees" "Limak is a smart brown bear who loves chemistry, reactions and transforming elements.In Bearland (Limak\'s home) there are n elements, numbered 1 through n. There are also special machines, that can transform elements. Each machine is described by two integers ai,\xe2\x80\x89bi representing two elements, not necessarily distinct. One can use a machine either to transform an element ai to bi or to transform bi to ai. Machines in Bearland aren\'t very resistant and each of them can be used at most once. It is possible that ai\xe2\x80\x89=\xe2\x80\x89bi and that many machines have the same pair ai,\xe2\x80\x89bi.Radewoosh is Limak\'s biggest enemy and rival. He wants to test Limak in the chemistry. They will meet tomorrow and both of them will bring all their machines. Limak has m machines but he doesn\'t know much about his enemy. They agreed Radewoosh will choose two distinct elements, let\'s denote them as x and y. Limak will be allowed to use both his and Radewoosh\'s machines. He may use zero or more (maybe even all) machines to achieve the goal, each machine at most once. Limak will start from an element x and his task will be to first get an element y and then to again get an element x \xe2\x80\x94 then we say that he succeeds. After that Radewoosh would agree that Limak knows the chemistry (and Radewoosh would go away).Radewoosh likes some particular non-empty set of favorite elements and he will choose x,\xe2\x80\x89y from that set. Limak doesn\'t know exactly which elements are in the set and also he doesn\'t know what machines Radewoosh has. Limak has heard q gossips (queries) though and each of them consists of Radewoosh\'s machines and favorite elements. For each gossip Limak wonders if he would be able to succeed tomorrow for every pair x,\xe2\x80\x89y chosen from the set of favorite elements. If yes then print ""YES"" (without the quotes). But if there exists a pair (x,\xe2\x80\x89y) from the given set that Limak wouldn\'t be able to succeed then you should print ""NO"" (without the quotes)." 3300
639E "Bear and Paradox" "binary search,greedy,math,sortings" "Limak is a big polar bear. He prepared n problems for an algorithmic contest. The i-th problem has initial score pi. Also, testers said that it takes ti minutes to solve the i-th problem. Problems aren\'t necessarily sorted by difficulty and maybe harder problems have smaller initial score but it\'s too late to change it \xe2\x80\x94 Limak has already announced initial scores for problems. Though it\'s still possible to adjust the speed of losing points, denoted by c in this statement.Let T denote the total number of minutes needed to solve all problems (so, T\xe2\x80\x89=\xe2\x80\x89t1\xe2\x80\x89+\xe2\x80\x89t2\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89tn). The contest will last exactly T minutes. So it\'s just enough to solve all problems.Points given for solving a problem decrease linearly. Solving the i-th problem after x minutes gives exactly  points, where  is some real constant that Limak must choose.Let\'s assume that c is fixed. During a contest a participant chooses some order in which he or she solves problems. There are n! possible orders and each of them gives some total number of points, not necessarily integer. We say that an order is optimal if it gives the maximum number of points. In other words, the total number of points given by this order is greater or equal than the number of points given by any other order. It\'s obvious that there is at least one optimal order. However, there may be more than one optimal order.Limak assumes that every participant will properly estimate ti at the very beginning and will choose some optimal order. He also assumes that testers correctly predicted time needed to solve each problem.For two distinct problems i and j such that pi\xe2\x80\x89<\xe2\x80\x89pj Limak wouldn\'t be happy to see a participant with strictly more points for problem i than for problem j. He calls such a situation a paradox.It\'s not hard to prove that there will be no paradox for c\xe2\x80\x89=\xe2\x80\x890. The situation may be worse for bigger c. What is the maximum real value c (remember that ) for which there is no paradox possible, that is, there will be no paradox for any optimal order of solving problems?It can be proved that the answer (the maximum c as described) always exists." 2800
639D "Bear and Contribution" "data structures,greedy,sortings,two pointers" "Codeforces is a wonderful platform and one its feature shows how much someone contributes to the community. Every registered user has contribution \xe2\x80\x94 an integer number, not necessarily positive. There are n registered users and the i-th of them has contribution ti.Limak is a little polar bear and he\'s new into competitive programming. He doesn\'t even have an account in Codeforces but he is able to upvote existing blogs and comments. We assume that every registered user has infinitely many blogs and comments.  Limak can spend b minutes to read one blog and upvote it. Author\'s contribution will be increased by 5.  Limak can spend c minutes to read one comment and upvote it. Author\'s contribution will be increased by 1. Note that it\'s possible that Limak reads blogs faster than comments.Limak likes ties. He thinks it would be awesome to see a tie between at least k registered users. To make it happen he is going to spend some time on reading and upvoting. After that, there should exist an integer value x that at least k registered users have contribution exactly x.How much time does Limak need to achieve his goal?" 2400
639C "Bear and Polynomials" hashing,implementation,math "Limak is a little polar bear. He doesn\'t have many toys and thus he often plays with polynomials.He considers a polynomial valid if its degree is n and its coefficients are integers not exceeding k by the absolute value. More formally:Let a0,\xe2\x80\x89a1,\xe2\x80\x89...,\xe2\x80\x89an denote the coefficients, so . Then, a polynomial P(x) is valid if all the following conditions are satisfied:  ai is integer for every i;  |ai|\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k for every i;  an\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x890. Limak has recently got a valid polynomial P with coefficients a0,\xe2\x80\x89a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. He noticed that P(2)\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x890 and he wants to change it. He is going to change one coefficient to get a valid polynomial Q of degree n that Q(2)\xe2\x80\x89=\xe2\x80\x890. Count the number of ways to do so. You should count two ways as a distinct if coefficients of target polynoms differ." 2200
639B "Bear and Forgotten Tree 3" "constructive algorithms,graphs,trees" "A tree is a connected undirected graph consisting of n vertices and n\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x89\xe2\x80\x891 edges. Vertices are numbered 1 through n.Limak is a little polar bear and Radewoosh is his evil enemy. Limak once had a tree but Radewoosh stolen it. Bear is very sad now because he doesn\'t remember much about the tree \xe2\x80\x94 he can tell you only three values n, d and h:  The tree had exactly n vertices.  The tree had diameter d. In other words, d was the biggest distance between two vertices.  Limak also remembers that he once rooted the tree in vertex 1 and after that its height was h. In other words, h was the biggest distance between vertex 1 and some other vertex. The distance between two vertices of the tree is the number of edges on the simple path between them.Help Limak to restore his tree. Check whether there exists a tree satisfying the given conditions. Find any such tree and print its edges in any order. It\'s also possible that Limak made a mistake and there is no suitable tree \xe2\x80\x93 in this case print ""-1""." 1600
639A "Bear and Displayed Friends" implementation "Limak is a little polar bear. He loves connecting with other bears via social networks. He has n friends and his relation with the i-th of them is described by a unique integer ti. The bigger this value is, the better the friendship is. No two friends have the same value ti.Spring is starting and the Winter sleep is over for bears. Limak has just woken up and logged in. All his friends still sleep and thus none of them is online. Some (maybe all) of them will appear online in the next hours, one at a time.The system displays friends who are online. On the screen there is space to display at most k friends. If there are more than k friends online then the system displays only k best of them \xe2\x80\x94 those with biggest ti.Your task is to handle queries of two types:  ""1 id"" \xe2\x80\x94 Friend id becomes online. It\'s guaranteed that he wasn\'t online before.  ""2 id"" \xe2\x80\x94 Check whether friend id is displayed by the system. Print ""YES"" or ""NO"" in a separate line. Are you able to help Limak and answer all queries of the second type?" 1200
638D "Three-dimensional Turtle Super Computer" "brute force,dfs and similar,graphs" "A super computer has been built in the Turtle Academy of Sciences. The computer consists of n\xc2\xb7m\xc2\xb7k CPUs. The architecture was the paralellepiped of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m\xe2\x80\x89\xc3\x97\xe2\x80\x89k, split into 1\xe2\x80\x89\xc3\x97\xe2\x80\x891\xe2\x80\x89\xc3\x97\xe2\x80\x891 cells, each cell contains exactly one CPU. Thus, each CPU can be simultaneously identified as a group of three numbers from the layer number from 1 to n, the line number from 1 to m and the column number from 1 to k.In the process of the Super Computer\'s work the CPUs can send each other messages by the famous turtle scheme: CPU (x,\xe2\x80\x89y,\xe2\x80\x89z) can send messages to CPUs (x\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89y,\xe2\x80\x89z), (x,\xe2\x80\x89y\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89z) and (x,\xe2\x80\x89y,\xe2\x80\x89z\xe2\x80\x89+\xe2\x80\x891) (of course, if they exist), there is no feedback, that is, CPUs (x\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89y,\xe2\x80\x89z), (x,\xe2\x80\x89y\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89z) and (x,\xe2\x80\x89y,\xe2\x80\x89z\xe2\x80\x89+\xe2\x80\x891) cannot send messages to CPU (x,\xe2\x80\x89y,\xe2\x80\x89z).Over time some CPUs broke down and stopped working. Such CPUs cannot send messages, receive messages or serve as intermediates in transmitting messages. We will say that CPU (a,\xe2\x80\x89b,\xe2\x80\x89c) controls CPU (d,\xe2\x80\x89e,\xe2\x80\x89f) , if there is a chain of CPUs (xi,\xe2\x80\x89yi,\xe2\x80\x89zi), such that (x1\xe2\x80\x89=\xe2\x80\x89a,\xe2\x80\x89y1\xe2\x80\x89=\xe2\x80\x89b,\xe2\x80\x89z1\xe2\x80\x89=\xe2\x80\x89c), (xp\xe2\x80\x89=\xe2\x80\x89d,\xe2\x80\x89yp\xe2\x80\x89=\xe2\x80\x89e,\xe2\x80\x89zp\xe2\x80\x89=\xe2\x80\x89f) (here and below p is the length of the chain) and the CPU in the chain with number i (i\xe2\x80\x89<\xe2\x80\x89p) can send messages to CPU i\xe2\x80\x89+\xe2\x80\x891.Turtles are quite concerned about the denial-proofness of the system of communication between the remaining CPUs. For that they want to know the number of critical CPUs. A CPU (x,\xe2\x80\x89y,\xe2\x80\x89z) is critical, if turning it off will disrupt some control, that is, if there are two distinctive from (x,\xe2\x80\x89y,\xe2\x80\x89z) CPUs: (a,\xe2\x80\x89b,\xe2\x80\x89c) and (d,\xe2\x80\x89e,\xe2\x80\x89f), such that (a,\xe2\x80\x89b,\xe2\x80\x89c) controls (d,\xe2\x80\x89e,\xe2\x80\x89f) before (x,\xe2\x80\x89y,\xe2\x80\x89z) is turned off and stopped controlling it after the turning off." 1800
638C "Road Improvement" "*special problem,dfs and similar,graphs,greedy,trees" "In Berland there are n cities and n\xe2\x80\x89-\xe2\x80\x891 bidirectional roads. Each road connects some pair of cities, from any city you can get to any other one using only the given roads.In each city there is exactly one repair brigade. To repair some road, you need two teams based in the cities connected by the road to work simultaneously for one day. Both brigades repair one road for the whole day and cannot take part in repairing other roads on that day. But the repair brigade can do nothing on that day.Determine the minimum number of days needed to repair all the roads. The brigades cannot change the cities where they initially are." 1800
638B "Making Genome in Berland" "*special problem,dfs and similar,strings" "Berland scientists face a very important task - given the parts of short DNA fragments, restore the dinosaur DNA! The genome of a berland dinosaur has noting in common with the genome that we\'ve used to: it can have 26 distinct nucleotide types, a nucleotide of each type can occur at most once. If we assign distinct English letters to all nucleotides, then the genome of a Berland dinosaur will represent a non-empty string consisting of small English letters, such that each letter occurs in it at most once.Scientists have n genome fragments that are represented as substrings (non-empty sequences of consecutive nucleotides) of the sought genome.You face the following problem: help scientists restore the dinosaur genome. It is guaranteed that the input is not contradictory and at least one suitable line always exists. When the scientists found out that you are a strong programmer, they asked you in addition to choose the one with the minimum length. If there are multiple such strings, choose any string." 1500
638A "Home Numbers" "*special problem,constructive algorithms,math" "The main street of Berland is a straight line with n houses built along it (n is an even number). The houses are located at both sides of the street. The houses with odd numbers are at one side of the street and are numbered from 1 to n\xe2\x80\x89-\xe2\x80\x891 in the order from the beginning of the street to the end (in the picture: from left to right). The houses with even numbers are at the other side of the street and are numbered from 2 to n in the order from the end of the street to its beginning (in the picture: from right to left). The corresponding houses with even and odd numbers are strictly opposite each other, that is, house 1 is opposite house n, house 3 is opposite house n\xe2\x80\x89-\xe2\x80\x892, house 5 is opposite house n\xe2\x80\x89-\xe2\x80\x894 and so on.  Vasya needs to get to house number a as quickly as possible. He starts driving from the beginning of the street and drives his car to house a. To get from the beginning of the street to houses number 1 and n, he spends exactly 1 second. He also spends exactly one second to drive the distance between two neighbouring houses. Vasya can park at any side of the road, so the distance between the beginning of the street at the houses that stand opposite one another should be considered the same.Your task is: find the minimum time Vasya needs to reach house a." 1100
637D "Running with Obstacles" "*special problem,data structures,dp,greedy" "A sportsman starts from point xstart\xe2\x80\x89=\xe2\x80\x890 and runs to point with coordinate xfinish\xe2\x80\x89=\xe2\x80\x89m (on a straight line). Also, the sportsman can jump \xe2\x80\x94 to jump, he should first take a run of length of not less than s meters (in this case for these s meters his path should have no obstacles), and after that he can jump over a length of not more than d meters. Running and jumping is permitted only in the direction from left to right. He can start andfinish a jump only at the points with integer coordinates in which there are no obstacles. To overcome some obstacle, it is necessary to land at a point which is strictly to the right of this obstacle.On the way of an athlete are n obstacles at coordinates x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xn. He cannot go over the obstacles, he can only jump over them. Your task is to determine whether the athlete will be able to get to the finish point." 1600
637C "Promocodes with Mistakes" "*special problem,brute force,constructive algorithms,implementation" "During a New Year special offer the ""Sudislavl Bars"" offered n promo codes. Each promo code consists of exactly six digits and gives right to one free cocktail at the bar ""Mosquito Shelter"". Of course, all the promocodes differ.As the ""Mosquito Shelter"" opens only at 9, and partying in Sudislavl usually begins at as early as 6, many problems may arise as to how to type a promotional code without errors. It is necessary to calculate such maximum k, that the promotional code could be uniquely identified if it was typed with no more than k errors. At that, k\xe2\x80\x89=\xe2\x80\x890 means that the promotional codes must be entered exactly.A mistake in this problem should be considered as entering the wrong numbers. For example, value ""123465"" contains two errors relative to promocode ""123456"". Regardless of the number of errors the entered value consists of exactly six digits." 1400
637B "Chat Order" "*special problem,binary search,constructive algorithms,data structures,sortings" "Polycarp is a big lover of killing time in social networks. A page with a chatlist in his favourite network is made so that when a message is sent to some friend, his friend\'s chat rises to the very top of the page. The relative order of the other chats doesn\'t change. If there was no chat with this friend before, then a new chat is simply inserted to the top of the list.Assuming that the chat list is initially empty, given the sequence of Polycaprus\' messages make a list of chats after all of his messages are processed. Assume that no friend wrote any message to Polycarpus." 1200
637A "Voting for Photos" "*special problem,constructive algorithms,implementation" "After celebrating the midcourse the students of one of the faculties of the Berland State University decided to conduct a vote for the best photo. They published the photos in the social network and agreed on the rules to choose a winner: the photo which gets most likes wins. If multiple photoes get most likes, the winner is the photo that gets this number first.Help guys determine the winner photo by the records of likes." 1000
635A Orchestra "brute force,implementation" "Paul is at the orchestra. The string section is arranged in an r\xe2\x80\x89\xc3\x97\xe2\x80\x89c rectangular grid and is filled with violinists with the exception of n violists. Paul really likes violas, so he would like to take a picture including at least k of them. Paul can take a picture of any axis-parallel rectangle in the orchestra. Count the number of possible pictures that Paul can take.Two pictures are considered to be different if the coordinates of corresponding rectangles are different." 1100
634A "Island Puzzle" "constructive algorithms,implementation" "A remote island chain contains n islands, labeled 1 through n. Bidirectional bridges connect the islands to form a simple cycle \xe2\x80\x94 a bridge connects islands 1 and 2, islands 2 and 3, and so on, and additionally a bridge connects islands n and 1. The center of each island contains an identical pedestal, and all but one of the islands has a fragile, uniquely colored statue currently held on the pedestal. The remaining island holds only an empty pedestal.The islanders want to rearrange the statues in a new order. To do this, they repeat the following process: First, they choose an island directly adjacent to the island containing an empty pedestal. Then, they painstakingly carry the statue on this island across the adjoining bridge and place it on the empty pedestal.Determine if it is possible for the islanders to arrange the statues in the desired order." 1300
633H "Fibonacci-ish II" "data structures,implementation" "Yash is finally tired of computing the length of the longest Fibonacci-ish sequence. He now plays around with more complex things such as Fibonacci-ish potentials. Fibonacci-ish potential of an array ai is computed as follows:   Remove all elements j if there exists i\xe2\x80\x89<\xe2\x80\x89j such that ai\xe2\x80\x89=\xe2\x80\x89aj.  Sort the remaining elements in ascending order, i.e. a1\xe2\x80\x89<\xe2\x80\x89a2\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89an.  Compute the potential as P(a)\xe2\x80\x89=\xe2\x80\x89a1\xc2\xb7F1\xe2\x80\x89+\xe2\x80\x89a2\xc2\xb7F2\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89an\xc2\xb7Fn, where Fi is the i-th Fibonacci number (see notes for clarification). You are given an array ai of length n and q ranges from lj to rj. For each range j you have to compute the Fibonacci-ish potential of the array bi, composed using all elements of ai from lj to rj inclusive. Find these potentials modulo m." 3100
633G "Yash And Trees" "bitmasks,data structures,dfs and similar,math,number theory" "Yash loves playing with trees and gets especially excited when they have something to do with prime numbers. On his 20th birthday he was granted with a rooted tree of n nodes to answer queries on. Hearing of prime numbers on trees, Yash gets too intoxicated with excitement and asks you to help out and answer queries on trees for him. Tree is rooted at node 1. Each node i has some value ai associated with it. Also, integer m is given.There are queries of two types:  for given node v and integer value x, increase all ai in the subtree of node v by value x  for given node v, find the number of prime numbers p less than m, for which there exists a node u in the subtree of v and a non-negative integer value k, such that au\xe2\x80\x89=\xe2\x80\x89p\xe2\x80\x89+\xe2\x80\x89m\xc2\xb7k." 2800
633F "The Chocolate Spree" "dfs and similar,dp,graphs,trees" "Alice and Bob have a tree (undirected acyclic connected graph). There are ai chocolates waiting to be picked up in the i-th vertex of the tree. First, they choose two different vertices as their starting positions (Alice chooses first) and take all the chocolates contained in them.Then, they alternate their moves, selecting one vertex at a time and collecting all chocolates from this node. To make things more interesting, they decided that one can select a vertex only if he/she selected a vertex adjacent to that one at his/her previous turn and this vertex has not been already chosen by any of them during other move.If at any moment one of them is not able to select the node that satisfy all the rules, he/she will skip his turns and let the other person pick chocolates as long as he/she can. This goes on until both of them cannot pick chocolates any further.Due to their greed for chocolates, they want to collect as many chocolates as possible. However, as they are friends they only care about the total number of chocolates they obtain together. What is the maximum total number of chocolates they may pick?" 2600
633E "Startup Funding" "binary search,constructive algorithms,data structures,probabilities,two pointers" "An e-commerce startup pitches to the investors to get funding. They have been functional for n weeks now and also have a website!For each week they know the number of unique visitors during this week vi and the revenue ci. To evaluate the potential of the startup at some range of weeks from l to r inclusive investors use the minimum among the maximum number of visitors multiplied by 100 and the minimum revenue during this period, that is: The truth is that investors have no idea how to efficiently evaluate the startup, so they are going to pick some k random distinct weeks li and give them to managers of the startup. For each li they should pick some ri\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89li and report maximum number of visitors and minimum revenue during this period.Then, investors will calculate the potential of the startup for each of these ranges and take minimum value of p(li,\xe2\x80\x89ri) as the total evaluation grade of the startup. Assuming that managers of the startup always report the optimal values of ri for some particular li, i.e., the value such that the resulting grade of the startup is maximized, what is the expected resulting grade of the startup?" 2400
633D Fibonacci-ish "brute force,dp,hashing,implementation,math" "Yash has recently learnt about the Fibonacci sequence and is very excited about it. He calls a sequence Fibonacci-ish if   the sequence consists of at least two elements  f0 and f1 are arbitrary  fn\xe2\x80\x89+\xe2\x80\x892\xe2\x80\x89=\xe2\x80\x89fn\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x89fn for all n\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x890. You are given some sequence of integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. Your task is rearrange elements of this sequence in such a way that its longest possible prefix is Fibonacci-ish sequence." 2000
633C "Spy Syndrome 2" "data structures,dp,hashing,implementation,sortings,string suffix structures,strings" "After observing the results of Spy Syndrome, Yash realised the errors of his ways. He now believes that a super spy such as Siddhant can\'t use a cipher as basic and ancient as Caesar cipher. After many weeks of observation of Siddhant\xe2\x80\x99s sentences, Yash determined a new cipher technique.For a given sentence, the cipher is processed as:   Convert all letters of the sentence to lowercase.  Reverse each of the words of the sentence individually.  Remove all the spaces in the sentence. For example, when this cipher is applied to the sentenceKira is childish and he hates losingthe resulting string isariksihsidlihcdnaehsetahgnisolNow Yash is given some ciphered string and a list of words. Help him to find out any original sentence composed using only words from the list. Note, that any of the given words could be used in the sentence multiple times." 1900
633B "A Trivial Problem" "brute force,constructive algorithms,math,number theory" "Mr. Santa asks all the great programmers of the world to solve a trivial problem. He gives them an integer m and asks for the number of positive integers n, such that the factorial of n ends with exactly m zeroes. Are you among those great programmers who can solve this problem?" 1300
633A "Ebony and Ivory" "brute force,math,number theory" "Dante is engaged in a fight with ""The Savior"". Before he can fight it with his sword, he needs to break its shields. He has two guns, Ebony and Ivory, each of them is able to perform any non-negative number of shots.For every bullet that hits the shield, Ebony deals a units of damage while Ivory deals b units of damage. In order to break the shield Dante has to deal exactly c units of damage. Find out if this is possible." 1100
632F "Magic Matrix" "brute force,divide and conquer,graphs,matrices,trees" "You\'re given a matrix A of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89n.Let\'s call the matrix with nonnegative elements magic if it is symmetric (so aij\xe2\x80\x89=\xe2\x80\x89aji), aii\xe2\x80\x89=\xe2\x80\x890 and aij\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89max(aik,\xe2\x80\x89ajk) for all triples i,\xe2\x80\x89j,\xe2\x80\x89k. Note that i,\xe2\x80\x89j,\xe2\x80\x89k do not need to be distinct.Determine if the matrix is magic.As the input/output can reach very huge size it is recommended to use fast input/output methods: for example, prefer to use scanf/printf instead of cin/cout in C++, prefer to use BufferedReader/PrintWriter instead of Scanner/System.out in Java." 2400
632E "Thief in a Shop" "divide and conquer,dp,fft,math" "A thief made his way to a shop.As usual he has his lucky knapsack with him. The knapsack can contain k objects. There are n kinds of products in the shop and an infinite number of products of each kind. The cost of one product of kind i is ai.The thief is greedy, so he will take exactly k products (it\'s possible for some kinds to take several products of that kind).Find all the possible total costs of products the thief can nick into his knapsack." 2400
632D "Longest Subsequence" "brute force,math,number theory" "You are given array a with n elements and the number m. Consider some subsequence of a and the value of least common multiple (LCM) of its elements. Denote LCM as l. Find any longest subsequence of a with the value l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m.A subsequence of a is an array we can get by erasing some elements of a. It is allowed to erase zero or all elements.The LCM of an empty array equals 1." 2100
632C "The Smallest String Concatenation" sortings,strings "You\'re given a list of n strings a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. You\'d like to concatenate them together in some order such that the resulting string would be lexicographically smallest.Given the list of strings, output the lexicographically smallest concatenation." 1700
632B "Alice, Bob, Two Teams" "brute force,constructive algorithms" "Alice and Bob are playing a game. The game involves splitting up game pieces into two teams. There are n pieces, and the i-th piece has a strength pi.The way to split up game pieces is split into several steps:  First, Alice will split the pieces into two different groups A and B. This can be seen as writing the assignment of teams of a piece in an n character string, where each character is A or B.  Bob will then choose an arbitrary prefix or suffix of the string, and flip each character in that suffix (i.e. change A to B and B to A). He can do this step at most once.  Alice will get all the pieces marked A and Bob will get all the pieces marked B. The strength of a player is then the sum of strengths of the pieces in the group.Given Alice\'s initial split into two teams, help Bob determine an optimal strategy. Return the maximum strength he can achieve." 1400
632A "Grandma Laura and Apples" NA "Grandma Laura came to the market to sell some apples. During the day she sold all the apples she had. But grandma is old, so she forgot how many apples she had brought to the market.She precisely remembers she had n buyers and each of them bought exactly half of the apples she had at the moment of the purchase and also she gave a half of an apple to some of them as a gift (if the number of apples at the moment of purchase was odd), until she sold all the apples she had.So each buyer took some integral positive number of apples, but maybe he didn\'t pay for a half of an apple (if the number of apples at the moment of the purchase was odd).For each buyer grandma remembers if she gave a half of an apple as a gift or not. The cost of an apple is p (the number p is even).Print the total money grandma should have at the end of the day to check if some buyers cheated her." 1200
631E "Product Sum" "data structures,dp,geometry" "Blake is the boss of Kris, however, this doesn\'t spoil their friendship. They often gather at the bar to talk about intriguing problems about maximising some values. This time the problem is really special.You are given an array a of length n. The characteristic of this array is the value  \xe2\x80\x94 the sum of the products of the values ai by i. One may perform the following operation exactly once: pick some element of the array and move to any position. In particular, it\'s allowed to move the element to the beginning or to the end of the array. Also, it\'s allowed to put it back to the initial position. The goal is to get the array with the maximum possible value of characteristic." 2600
631D Messenger "data structures,hashing,implementation,string suffix structures,strings" "Each employee of the ""Blake Techologies"" company uses a special messaging app ""Blake Messenger"". All the stuff likes this app and uses it constantly. However, some important futures are missing. For example, many users want to be able to search through the message history. It was already announced that the new feature will appear in the nearest update, when developers faced some troubles that only you may help them to solve.All the messages are represented as a strings consisting of only lowercase English letters. In order to reduce the network load strings are represented in the special compressed form. Compression algorithm works as follows: string is represented as a concatenation of n blocks, each block containing only equal characters. One block may be described as a pair (li,\xe2\x80\x89ci), where li is the length of the i-th block and ci is the corresponding letter. Thus, the string s may be written as the sequence of pairs .Your task is to write the program, that given two compressed string t and s finds all occurrences of s in t. Developers know that there may be many such occurrences, so they only ask you to find the number of them. Note that p is the starting position of some occurrence of s in t if and only if tptp\xe2\x80\x89+\xe2\x80\x891...tp\xe2\x80\x89+\xe2\x80\x89|s|\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89=\xe2\x80\x89s, where ti is the i-th character of string t.Note that the way to represent the string in compressed form may not be unique. For example string ""aaaa"" may be given as , , ..." 2100
631C Report "data structures,sortings" "Each month Blake gets the report containing main economic indicators of the company ""Blake Technologies"". There are n commodities produced by the company. For each of them there is exactly one integer in the final report, that denotes corresponding revenue. Before the report gets to Blake, it passes through the hands of m managers. Each of them may reorder the elements in some order. Namely, the i-th manager either sorts first ri numbers in non-descending or non-ascending order and then passes the report to the manager i\xe2\x80\x89+\xe2\x80\x891, or directly to Blake (if this manager has number i\xe2\x80\x89=\xe2\x80\x89m).Employees of the ""Blake Technologies"" are preparing the report right now. You know the initial sequence ai of length n and the description of each manager, that is value ri and his favourite order. You are asked to speed up the process and determine how the final report will look like." 1700
631B "Print Check" "constructive algorithms,implementation" "Kris works in a large company ""Blake Technologies"". As a best engineer of the company he was assigned a task to develop a printer that will be able to print horizontal and vertical strips. First prototype is already built and Kris wants to tests it. He wants you to implement the program that checks the result of the printing.Printer works with a rectangular sheet of paper of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m. Consider the list as a table consisting of n rows and m columns. Rows are numbered from top to bottom with integers from 1 to n, while columns are numbered from left to right with integers from 1 to m. Initially, all cells are painted in color 0.Your program has to support two operations:   Paint all cells in row ri in color ai;  Paint all cells in column ci in color ai. If during some operation i there is a cell that have already been painted, the color of this cell also changes to ai.Your program has to print the resulting table after k operation." 1200
631A Interview "brute force,implementation" "Blake is a CEO of a large company called ""Blake Technologies"". He loves his company very much and he thinks that his company should be the best. That is why every candidate needs to pass through the interview that consists of the following problem.We define function f(x,\xe2\x80\x89l,\xe2\x80\x89r) as a bitwise OR of integers xl,\xe2\x80\x89xl\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89xr, where xi is the i-th element of the array x. You are given two arrays a and b of length n. You need to determine the maximum value of sum f(a,\xe2\x80\x89l,\xe2\x80\x89r)\xe2\x80\x89+\xe2\x80\x89f(b,\xe2\x80\x89l,\xe2\x80\x89r) among all possible 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n." 900
630R Game games,math "There is a legend in the IT City college. A student that failed to answer all questions on the game theory exam is given one more chance by his professor. The student has to play a game with the professor.The game is played on a square field consisting of n\xe2\x80\x89\xc3\x97\xe2\x80\x89n cells. Initially all cells are empty. On each turn a player chooses and paint an empty cell that has no common sides with previously painted cells. Adjacent corner of painted cells is allowed. On the next turn another player does the same, then the first one and so on. The player with no cells to paint on his turn loses.The professor have chosen the field size n and allowed the student to choose to be the first or the second player in the game. What should the student choose to win the game? Both players play optimally." 1200
630Q Pyramids geometry,math "IT City administration has no rest because of the fame of the Pyramids in Egypt. There is a project of construction of pyramid complex near the city in the place called Emerald Walley. The distinction of the complex is that its pyramids will be not only quadrangular as in Egypt but also triangular and pentagonal. Of course the amount of the city budget funds for the construction depends on the pyramids\' volume. Your task is to calculate the volume of the pilot project consisting of three pyramids \xe2\x80\x94 one triangular, one quadrangular and one pentagonal.The first pyramid has equilateral triangle as its base, and all 6 edges of the pyramid have equal length. The second pyramid has a square as its base and all 8 edges of the pyramid have equal length. The third pyramid has a regular pentagon as its base and all 10 edges of the pyramid have equal length." 1700
630P "Area of a Star" geometry "It was decided in IT City to distinguish successes of local IT companies by awards in the form of stars covered with gold from one side. To order the stars it is necessary to estimate order cost that depends on the area of gold-plating. Write a program that can calculate the area of a star.A ""star"" figure having n\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x895 corners where n is a prime number is constructed the following way. On the circle of radius r n points are selected so that the distances between the adjacent ones are equal. Then every point is connected by a segment with two maximally distant points. All areas bounded by the segments parts are the figure parts." 2100
630O Arrow geometry "Petya has recently started working as a programmer in the IT city company that develops computer games.Besides game mechanics implementation to create a game it is necessary to create tool programs that can be used by game designers to create game levels. Petya\'s first assignment is to create a tool that allows to paint different arrows on the screen.A user of this tool will choose a point on the screen, specify a vector (the arrow direction) and vary several parameters to get the required graphical effect. In the first version of the program Petya decided to limit parameters of the arrow by the following: a point with coordinates (px,\xe2\x80\x89py), a nonzero vector with coordinates (vx,\xe2\x80\x89vy), positive scalars a,\xe2\x80\x89b,\xe2\x80\x89c,\xe2\x80\x89d,\xe2\x80\x89a\xe2\x80\x89>\xe2\x80\x89c.The produced arrow should have the following properties. The arrow consists of a triangle and a rectangle. The triangle is isosceles with base of length a and altitude of length b perpendicular to the base. The rectangle sides lengths are c and d. Point (px,\xe2\x80\x89py) is situated in the middle of the triangle base and in the middle of side of rectangle that has length c. Area of intersection of the triangle and the rectangle is zero. The direction from (px,\xe2\x80\x89py) point to the triangle vertex opposite to base containing the point coincides with direction of (vx,\xe2\x80\x89vy) vector.Enumerate the arrow points coordinates in counter-clockwise order starting from the tip." 2000
630N Forecast math "The Department of economic development of IT City created a model of city development till year 2100.To prepare report about growth perspectives it is required to get growth estimates from the model.To get the growth estimates it is required to solve a quadratic equation. Since the Department of economic development of IT City creates realistic models only, that quadratic equation has a solution, moreover there are exactly two different real roots.The greater of these roots corresponds to the optimistic scenario, the smaller one corresponds to the pessimistic one. Help to get these estimates, first the optimistic, then the pessimistic one." 1300
630M Turn geometry,math "Vasya started working in a machine vision company of IT City. Vasya\'s team creates software and hardware for identification of people by their face.One of the project\'s know-how is a camera rotating around its optical axis on shooting. People see an eye-catching gadget \xe2\x80\x94 a rotating camera \xe2\x80\x94 come up to it to see it better, look into it. And the camera takes their photo at that time. What could be better for high quality identification?But not everything is so simple. The pictures from camera appear rotated too (on clockwise camera rotation frame the content becomes rotated counter-clockwise). But the identification algorithm can work only with faces that are just slightly deviated from vertical.Vasya was entrusted to correct the situation \xe2\x80\x94 to rotate a captured image so that image would be minimally deviated from vertical. Requirements were severe. Firstly, the picture should be rotated only on angle divisible by 90 degrees to not lose a bit of information about the image. Secondly, the frames from the camera are so huge and FPS is so big that adequate rotation speed is provided by hardware FPGA solution only. And this solution can rotate only by 90 degrees clockwise. Of course, one can apply 90 degrees turn several times but for the sake of performance the number of turns should be minimized.Help Vasya implement the program that by the given rotation angle of the camera can determine the minimum number of 90 degrees clockwise turns necessary to get a picture in which up direction deviation from vertical is minimum.The next figure contains frames taken from an unrotated camera, then from rotated 90 degrees clockwise, then from rotated 90 degrees counter-clockwise. Arrows show direction to ""true up"".  The next figure shows 90 degrees clockwise turn by FPGA hardware." 1800
630L "Cracking the Code" implementation,math "The protection of a popular program developed by one of IT City companies is organized the following way. After installation it outputs a random five digit number which should be sent in SMS to a particular phone number. In response an SMS activation code arrives.A young hacker Vasya disassembled the program and found the algorithm that transforms the shown number into the activation code. Note: it is clear that Vasya is a law-abiding hacker, and made it for a noble purpose \xe2\x80\x94 to show the developer the imperfection of their protection.The found algorithm looks the following way. At first the digits of the number are shuffled in the following order <first digit><third digit><fifth digit><fourth digit><second digit>. For example the shuffle of 12345 should lead to 13542. On the second stage the number is raised to the fifth power. The result of the shuffle and exponentiation of the number 12345 is 455 422 043 125 550 171 232. The answer is the 5 last digits of this result. For the number 12345 the answer should be 71232.Vasya is going to write a keygen program implementing this algorithm. Can you do the same?" 1400
630K Indivisibility "math,number theory" "IT City company developing computer games decided to upgrade its way to reward its employees. Now it looks the following way. After a new game release users start buying it actively, and the company tracks the number of sales with precision to each transaction. Every time when the next number of sales is not divisible by any number from 2 to 10 every developer of this game gets a small bonus.A game designer Petya knows that the company is just about to release a new game that was partly developed by him. On the basis of his experience he predicts that n people will buy the game during the first month. Now Petya wants to determine how many times he will get the bonus. Help him to know it." 1500
630J Divisibility "math,number theory" "IT City company developing computer games invented a new way to reward its employees. After a new game release users start buying it actively, and the company tracks the number of sales with precision to each transaction. Every time when the next number of sales is divisible by all numbers from 2 to 10 every developer of this game gets a small bonus.A game designer Petya knows that the company is just about to release a new game that was partly developed by him. On the basis of his experience he predicts that n people will buy the game during the first month. Now Petya wants to determine how many times he will get the bonus. Help him to know it." 1100
630I "Parking Lot" combinatorics,math "To quickly hire highly skilled specialists one of the new IT City companies made an unprecedented move. Every employee was granted a car, and an employee can choose one of four different car makes.The parking lot before the office consists of one line of (2n\xe2\x80\x89-\xe2\x80\x892) parking spaces. Unfortunately the total number of cars is greater than the parking lot capacity. Furthermore even amount of cars of each make is greater than the amount of parking spaces! That\'s why there are no free spaces on the parking lot ever.Looking on the straight line of cars the company CEO thought that parking lot would be more beautiful if it contained exactly n successive cars of the same make. Help the CEO determine the number of ways to fill the parking lot this way." 1700
630H Benches combinatorics,math "The city park of IT City contains n east to west paths and n north to south paths. Each east to west path crosses each north to south path, so there are n2 intersections.The city funded purchase of five benches. To make it seems that there are many benches it was decided to place them on as many paths as possible. Obviously this requirement is satisfied by the following scheme: each bench is placed on a cross of paths and each path contains not more than one bench.Help the park administration count the number of ways to place the benches." 1400
630G "Challenge Pennants" combinatorics,math "Because of budget cuts one IT company established new non-financial reward system instead of bonuses.Two kinds of actions are rewarded: fixing critical bugs and suggesting new interesting features. A man who fixed a critical bug gets ""I fixed a critical bug"" pennant on his table. A man who suggested a new interesting feature gets ""I suggested a new feature"" pennant on his table.Because of the limited budget of the new reward system only 5 ""I fixed a critical bug"" pennants and 3 ""I suggested a new feature"" pennants were bought.In order to use these pennants for a long time they were made challenge ones. When a man fixes a new critical bug one of the earlier awarded ""I fixed a critical bug"" pennants is passed on to his table. When a man suggests a new interesting feature one of the earlier awarded ""I suggested a new feature"" pennants is passed on to his table.One man can have several pennants of one type and of course he can have pennants of both types on his table. There are n tables in the IT company. Find the number of ways to place the pennants on these tables given that each pennant is situated on one of the tables and each table is big enough to contain any number of pennants." 1600
630F "Selection of Personnel" combinatorics,math "One company of IT City decided to create a group of innovative developments consisting from 5 to 7 people and hire new employees for it. After placing an advertisment the company received n resumes. Now the HR department has to evaluate each possible group composition and select one of them. Your task is to count the number of variants of group composition to evaluate." 1300
630E "A rectangle" math "Developing tools for creation of locations maps for turn-based fights in a new game, Petya faced the following problem.A field map consists of hexagonal cells. Since locations sizes are going to be big, a game designer wants to have a tool for quick filling of a field part with identical enemy units. This action will look like following: a game designer will select a rectangular area on the map, and each cell whose center belongs to the selected rectangle will be filled with the enemy unit.More formally, if a game designer selected cells having coordinates (x1,\xe2\x80\x89y1) and (x2,\xe2\x80\x89y2), where x1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x2 and y1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y2, then all cells having center coordinates (x,\xe2\x80\x89y) such that x1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x2 and y1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y2 will be filled. Orthogonal coordinates system is set up so that one of cell sides is parallel to OX axis, all hexagon centers have integer coordinates and for each integer x there are cells having center with such x coordinate and for each integer y there are cells having center with such y coordinate. It is guaranteed that difference x2\xe2\x80\x89-\xe2\x80\x89x1 is divisible by 2.Working on the problem Petya decided that before painting selected units he wants to output number of units that will be painted on the map.Help him implement counting of these units before painting." 1900
630D Hexagons! math "After a probationary period in the game development company of IT City Petya was included in a group of the programmers that develops a new turn-based strategy game resembling the well known ""Heroes of Might & Magic"". A part of the game is turn-based fights of big squadrons of enemies on infinite fields where every cell is in form of a hexagon.Some of magic effects are able to affect several field cells at once, cells that are situated not farther than n cells away from the cell in which the effect was applied. The distance between cells is the minimum number of cell border crosses on a path from one cell to another.It is easy to see that the number of cells affected by a magic effect grows rapidly when n increases, so it can adversely affect the game performance. That\'s why Petya decided to write a program that can, given n, determine the number of cells that should be repainted after effect application, so that game designers can balance scale of the effects and the game performance. Help him to do it. Find the number of hexagons situated not farther than n cells away from a given cell." 1100
630C "Lucky Numbers" combinatorics,math "The numbers of all offices in the new building of the Tax Office of IT City will have lucky numbers.Lucky number is a number that consists of digits 7 and 8 only. Find the maximum number of offices in the new building of the Tax Office given that a door-plate can hold a number not longer than n digits." 1100
630B "Moore\'s Law" math "The city administration of IT City decided to fix up a symbol of scientific and technical progress in the city\'s main square, namely an indicator board that shows the effect of Moore\'s law in real time.Moore\'s law is the observation that the number of transistors in a dense integrated circuit doubles approximately every 24 months. The implication of Moore\'s law is that computer performance as function of time increases exponentially as well.You are to prepare information that will change every second to display on the indicator board. Let\'s assume that every second the number of transistors increases exactly 1.000000011 times." 1200
630A "Again Twenty Five!" "number theory" "The HR manager was disappointed again. The last applicant failed the interview the same way as 24 previous ones. ""Do I give such a hard task?"" \xe2\x80\x94 the HR manager thought. ""Just raise number 5 to the power of n and get last two digits of the number. Yes, of course, n can be rather big, and one cannot find the power using a calculator, but we need people who are able to think, not just follow the instructions.""Could you pass the interview in the machine vision company in IT City?" 800
629E "Famil Door and Roads" "combinatorics,data structures,dfs and similar,dp,probabilities,trees" "Famil Door\xe2\x80\x99s City map looks like a tree (undirected connected acyclic graph) so other people call it Treeland. There are n intersections in the city connected by n\xe2\x80\x89-\xe2\x80\x891 bidirectional roads.There are m friends of Famil Door living in the city. The i-th friend lives at the intersection ui and works at the intersection vi. Everyone in the city is unhappy because there is exactly one simple path between their home and work.Famil Door plans to construct exactly one new road and he will randomly choose one among n\xc2\xb7(n\xe2\x80\x89-\xe2\x80\x891)\xe2\x80\x89/\xe2\x80\x892 possibilities. Note, that he may even build a new road between two cities that are already connected by one.He knows, that each of his friends will become happy, if after Famil Door constructs a new road there is a path from this friend home to work and back that doesn\'t visit the same road twice. Formally, there is a simple cycle containing both ui and vi. Moreover, if the friend becomes happy, his pleasure is equal to the length of such path (it\'s easy to see that it\'s unique). For each of his friends Famil Door wants to know his expected pleasure, that is the expected length of the cycle containing both ui and vi if we consider only cases when such a cycle exists." 2300
629D "Babaei and Birthday Cake" "data structures,dp" "As you know, every birthday party has a cake! This time, Babaei is going to prepare the very special birthday party\'s cake.Simple cake is a cylinder of some radius and height. The volume of the simple cake is equal to the volume of corresponding cylinder. Babaei has n simple cakes and he is going to make a special cake placing some cylinders on each other.However, there are some additional culinary restrictions. The cakes are numbered in such a way that the cake number i can be placed only on the table or on some cake number j where j\xe2\x80\x89<\xe2\x80\x89i. Moreover, in order to impress friends Babaei will put the cake i on top of the cake j only if the volume of the cake i is strictly greater than the volume of the cake j.Babaei wants to prepare a birthday cake that has a maximum possible total volume. Help him find this value." 2000
629C "Famil Door and Brackets" dp,strings "As Famil Door\xe2\x80\x99s birthday is coming, some of his friends (like Gabi) decided to buy a present for him. His friends are going to buy a string consisted of round brackets since Famil Door loves string of brackets of length n more than any other strings!The sequence of round brackets is called valid if and only if:   the total number of opening brackets is equal to the total number of closing brackets;  for any prefix of the sequence, the number of opening brackets is greater or equal than the number of closing brackets. Gabi bought a string s of length m (m\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) and want to complete it to obtain a valid sequence of brackets of length n. He is going to pick some strings p and q consisting of round brackets and merge them in a string p\xe2\x80\x89+\xe2\x80\x89s\xe2\x80\x89+\xe2\x80\x89q, that is add the string p at the beginning of the string s and string q at the end of the string s.Now he wonders, how many pairs of strings p and q exists, such that the string p\xe2\x80\x89+\xe2\x80\x89s\xe2\x80\x89+\xe2\x80\x89q is a valid sequence of round brackets. As this number may be pretty large, he wants to calculate it modulo 109\xe2\x80\x89+\xe2\x80\x897." 2000
629B "Far Relative\xe2\x80\x99s Problem" "brute force" "Famil Door wants to celebrate his birthday with his friends from Far Far Away. He has n friends and each of them can come to the party in a specific range of days of the year from ai to bi. Of course, Famil Door wants to have as many friends celebrating together with him as possible.Far cars are as weird as Far Far Away citizens, so they can only carry two people of opposite gender, that is exactly one male and one female. However, Far is so far from here that no other transportation may be used to get to the party.Famil Door should select some day of the year and invite some of his friends, such that they all are available at this moment and the number of male friends invited is equal to the number of female friends invited. Find the maximum number of friends that may present at the party." 1100
629A "Far Relative\xe2\x80\x99s Birthday Cake" "brute force,combinatorics,constructive algorithms,implementation" "Door\'s family is going celebrate Famil Doors\'s birthday party. They love Famil Door so they are planning to make his birthday cake weird!The cake is a n\xe2\x80\x89\xc3\x97\xe2\x80\x89n square consisting of equal squares with side length 1. Each square is either empty or consists of a single chocolate. They bought the cake and randomly started to put the chocolates on the cake. The value of Famil Door\'s happiness will be equal to the number of pairs of cells with chocolates that are in the same row or in the same column of the cake. Famil Doors\'s family is wondering what is the amount of happiness of Famil going to be?Please, note that any pair can be counted no more than once, as two different cells can\'t share both the same row and the same column." 800
628F "Bear and Fair Set" flows,graphs "Limak is a grizzly bear. He is big and dreadful. You were chilling in the forest when you suddenly met him. It\'s very unfortunate for you. He will eat all your cookies unless you can demonstrate your mathematical skills. To test you, Limak is going to give you a puzzle to solve.It\'s a well-known fact that Limak, as every bear, owns a set of numbers. You know some information about the set:  The elements of the set are distinct positive integers.  The number of elements in the set is n. The number n is divisible by 5.  All elements are between 1 and b, inclusive: bears don\'t know numbers greater than b.  For each r in {0,\xe2\x80\x891,\xe2\x80\x892,\xe2\x80\x893,\xe2\x80\x894}, the set contains exactly  elements that give remainder r when divided by 5. (That is, there are  elements divisible by 5,  elements of the form 5k\xe2\x80\x89+\xe2\x80\x891,  elements of the form 5k\xe2\x80\x89+\xe2\x80\x892, and so on.) Limak smiles mysteriously and gives you q hints about his set. The i-th hint is the following sentence: ""If you only look at elements that are between 1 and upToi, inclusive, you will find exactly quantityi such elements in my set.""In a moment Limak will tell you the actual puzzle, but something doesn\'t seem right... That smile was very strange. You start to think about a possible reason. Maybe Limak cheated you? Or is he a fair grizzly bear?Given n, b, q and hints, check whether Limak can be fair, i.e. there exists at least one set satisfying the given conditions. If it\'s possible then print \'\'fair"". Otherwise, print \'\'unfair""." 2500
628E "Zbazi in Zeydabad" "data structures,implementation" "A tourist wants to visit country Zeydabad for Zbazi (a local game in Zeydabad).The country Zeydabad is a rectangular table consisting of n rows and m columns. Each cell on the country is either \'z\' or \'.\'.The tourist knows this country is named Zeydabad because there are lots of \'\'Z-pattern""s in the country. A \'\'Z-pattern"" is a square which anti-diagonal is completely filled with \'z\' and its upper and lower rows are also completely filled with \'z\'. All other cells of a square can be arbitrary.  Note that a \'\'Z-pattern"" can consist of only one cell (see the examples).So he wants to count the number of \'\'Z-pattern""s in the country (a necessary skill for Zbazi).Now your task is to help tourist with counting number of \'\'Z-pattern""s.As input/output can reach huge size it is recommended to use fast input/output methods: for example, prefer to use gets/scanf/printf instead of getline/cin/cout in C++, prefer to use BufferedReader/PrintWriter instead of Scanner/System.out in Java." 2300
628D "Magic Numbers" dp "Consider the decimal presentation of an integer. Let\'s call a number d-magic if digit d appears in decimal presentation of the number on even positions and nowhere else.For example, the numbers 1727374, 17, 1 are 7-magic but 77, 7, 123, 34, 71 are not 7-magic. On the other hand the number 7 is 0-magic, 123 is 2-magic, 34 is 4-magic and 71 is 1-magic.Find the number of d-magic numbers in the segment [a,\xe2\x80\x89b] that are multiple of m. Because the answer can be very huge you should only find its value modulo 109\xe2\x80\x89+\xe2\x80\x897 (so you should find the remainder after dividing by 109\xe2\x80\x89+\xe2\x80\x897)." 2200
628C "Bear and String Distance" greedy,strings "Limak is a little polar bear. He likes nice strings \xe2\x80\x94 strings of length n, consisting of lowercase English letters only.The distance between two letters is defined as the difference between their positions in the alphabet. For example, , and .Also, the distance between two nice strings is defined as the sum of distances of corresponding letters. For example, , and .Limak gives you a nice string s and an integer k. He challenges you to find any nice string s\' that . Find any s\' satisfying the given conditions, or print ""-1"" if it\'s impossible to do so.As input/output can reach huge size it is recommended to use fast input/output methods: for example, prefer to use gets/scanf/printf instead of getline/cin/cout in C++, prefer to use BufferedReader/PrintWriter instead of Scanner/System.out in Java." 1300
628B "New Skateboard" dp "Max wants to buy a new skateboard. He has calculated the amount of money that is needed to buy a new skateboard. He left a calculator on the floor and went to ask some money from his parents. Meanwhile his little brother Yusuf came and started to press the keys randomly. Unfortunately Max has forgotten the number which he had calculated. The only thing he knows is that the number is divisible by 4.You are given a string s consisting of digits (the number on the display of the calculator after Yusuf randomly pressed the keys). Your task is to find the number of substrings which are divisible by 4. A substring can start with a zero.A substring of a string is a nonempty sequence of consecutive characters.For example if string s is 124 then we have four substrings that are divisible by 4: 12, 4, 24 and 124. For the string 04 the answer is three: 0, 4, 04.As input/output can reach huge size it is recommended to use fast input/output methods: for example, prefer to use gets/scanf/printf instead of getline/cin/cout in C++, prefer to use BufferedReader/PrintWriter instead of Scanner/System.out in Java." 1300
628A "Tennis Tournament" implementation,math "A tennis tournament with n participants is running. The participants are playing by an olympic system, so the winners move on and the losers drop out.The tournament takes place in the following way (below, m is the number of the participants of the current round):  let k be the maximal power of the number 2 such that k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m,  k participants compete in the current round and a half of them passes to the next round, the other m\xe2\x80\x89-\xe2\x80\x89k participants pass to the next round directly,  when only one participant remains, the tournament finishes. Each match requires b bottles of water for each participant and one bottle for the judge. Besides p towels are given to each participant for the whole tournament.Find the number of bottles and towels needed for the tournament.Note that it\'s a tennis tournament so in each match two participants compete (one of them will win and the other will lose)." 1000
627F "Island Puzzle" "dfs and similar,dsu,graphs,trees" "A remote island chain contains n islands, with some bidirectional bridges between them. The current bridge network forms a tree. In other words, a total of n\xe2\x80\x89-\xe2\x80\x891 bridges connect pairs of islands in a way that it\'s possible to reach any island from any other island using the bridge network. The center of each island contains an identical pedestal, and all but one of the islands has a fragile, uniquely colored statue currently held on the pedestal. The remaining island holds only an empty pedestal.The islanders want to rearrange the statues in a new order. To do this, they repeat the following process: first, they choose an island directly adjacent to the island containing an empty pedestal. Then, they painstakingly carry the statue on this island across the adjoining bridge and place it on the empty pedestal.It is often impossible to rearrange statues in the desired order using only the operation described above. The islanders would like to build one additional bridge in order to make this achievable in the fewest number of movements possible. Find the bridge to construct and the minimum number of statue movements necessary to arrange the statues in the desired position." 3400
627E Orchestra "two pointers" "Paul is at the orchestra. The string section is arranged in an r\xe2\x80\x89\xc3\x97\xe2\x80\x89c rectangular grid and is filled with violinists with the exception of n violists. Paul really likes violas, so he would like to take a picture including at least k of them. Paul can take a picture of any axis-parallel rectangle in the orchestra. Count the number of possible pictures that Paul can take.Two pictures are considered to be different if the coordinates of corresponding rectangles are different." 3000
627D "Preorder Test" "binary search,dfs and similar,dp,graphs,greedy,trees" "For his computer science class, Jacob builds a model tree with sticks and balls containing n nodes in the shape of a tree. Jacob has spent ai minutes building the i-th ball in the tree.Jacob\'s teacher will evaluate his model and grade Jacob based on the effort he has put in. However, she does not have enough time to search his whole tree to determine this; Jacob knows that she will examine the first k nodes in a DFS-order traversal of the tree. She will then assign Jacob a grade equal to the minimum ai she finds among those k nodes.Though Jacob does not have enough time to rebuild his model, he can choose the root node that his teacher starts from. Furthermore, he can rearrange the list of neighbors of each node in any order he likes. Help Jacob find the best grade he can get on this assignment.A DFS-order traversal is an ordering of the nodes of a rooted tree, built by a recursive DFS-procedure initially called on the root of the tree. When called on a given node v, the procedure does the following:   Print v.  Traverse the list of neighbors of the node v in order and iteratively call DFS-procedure on each one. Do not call DFS-procedure on node u if you came to node v directly from u." 2600
627C "Package Delivery" "data structures,divide and conquer,greedy" "Johnny drives a truck and must deliver a package from his hometown to the district center. His hometown is located at point 0 on a number line, and the district center is located at the point d.Johnny\'s truck has a gas tank that holds exactly n liters, and his tank is initially full. As he drives, the truck consumes exactly one liter per unit distance traveled. Moreover, there are m gas stations located at various points along the way to the district center. The i-th station is located at the point xi on the number line and sells an unlimited amount of fuel at a price of pi dollars per liter. Find the minimum cost Johnny must pay for fuel to successfully complete the delivery." 2200
627B "Factory Repairs" "data structures" "A factory produces thimbles in bulk. Typically, it can produce up to a thimbles a day. However, some of the machinery is defective, so it can currently only produce b thimbles each day. The factory intends to choose a k-day period to do maintenance and construction; it cannot produce any thimbles during this time, but will be restored to its full production of a thimbles per day after the k days are complete.Initially, no orders are pending. The factory receives updates of the form di, ai, indicating that ai new orders have been placed for the di-th day. Each order requires a single thimble to be produced on precisely the specified day. The factory may opt to fill as many or as few of the orders in a single batch as it likes.As orders come in, the factory owner would like to know the maximum number of orders he will be able to fill if he starts repairs on a given day pi. Help the owner answer his questions." 1700
627A "XOR Equation" dp,math "Two positive integers a and b have a sum of s and a bitwise XOR of x. How many possible values are there for the ordered pair (a,\xe2\x80\x89b)?" 1700
626G Raffles "data structures,dp,greedy,math" "Johnny is at a carnival which has n raffles. Raffle i has a prize with value pi. Each participant can put tickets in whichever raffles they choose (they may have more than one ticket in a single raffle). At the end of the carnival, one ticket is selected at random from each raffle, and the owner of the ticket wins the associated prize. A single person can win multiple prizes from different raffles. However, county rules prevent any one participant from owning more than half the tickets in a single raffle, i.e. putting more tickets in the raffle than all the other participants combined. To help combat this (and possibly win some prizes), the organizers started by placing a single ticket in each raffle, which they will never remove.Johnny bought t tickets and is wondering where to place them. Currently, there are a total of li tickets in the i-th raffle. He watches as other participants place tickets and modify their decisions and, at every moment in time, wants to know how much he can possibly earn. Find the maximum possible expected value of Johnny\'s winnings at each moment if he distributes his tickets optimally. Johnny may redistribute all of his tickets arbitrarily between each update, but he may not place more than t tickets total or have more tickets in a single raffle than all other participants combined." 3100
626F "Group Projects" dp "There are n students in a class working on group projects. The students will divide into groups (some students may be in groups alone), work on their independent pieces, and then discuss the results together. It takes the i-th student ai minutes to finish his/her independent piece.If students work at different paces, it can be frustrating for the faster students and stressful for the slower ones. In particular, the imbalance of a group is defined as the maximum ai in the group minus the minimum ai in the group. Note that a group containing a single student has an imbalance of 0. How many ways are there for the students to divide into groups so that the total imbalance of all groups is at most k?Two divisions are considered distinct if there exists a pair of students who work in the same group in one division but different groups in the other." 2400
626E "Simple Skewness" "binary search,math,ternary search" "Define the simple skewness of a collection of numbers to be the collection\'s mean minus its median. You are given a list of n (not necessarily distinct) integers. Find the non-empty subset (with repetition) with the maximum simple skewness.The mean of a collection is the average of its elements. The median of a collection is its middle element when all of its elements are sorted, or the average of its two middle elements if it has even size." 2400
626D "Jerry\'s Protest" "brute force,combinatorics,dp,probabilities" "Andrew and Jerry are playing a game with Harry as the scorekeeper. The game consists of three rounds. In each round, Andrew and Jerry draw randomly without replacement from a jar containing n balls, each labeled with a distinct positive integer. Without looking, they hand their balls to Harry, who awards the point to the player with the larger number and returns the balls to the jar. The winner of the game is the one who wins at least two of the three rounds.Andrew wins rounds 1 and 2 while Jerry wins round 3, so Andrew wins the game. However, Jerry is unhappy with this system, claiming that he will often lose the match despite having the higher overall total. What is the probability that the sum of the three balls Jerry drew is strictly higher than the sum of the three balls Andrew drew?" 1800
626C "Block Towers" "brute force,greedy,math,number theory" "Students in a class are making towers of blocks. Each student makes a (non-zero) tower by stacking pieces lengthwise on top of each other. n of the students use pieces made of two blocks and m of the students use pieces made of three blocks.The students don\xe2\x80\x99t want to use too many blocks, but they also want to be unique, so no two students\xe2\x80\x99 towers may contain the same number of blocks. Find the minimum height necessary for the tallest of the students\' towers." 1600
626B Cards "constructive algorithms,dp,math" "Catherine has a deck of n cards, each of which is either red, green, or blue. As long as there are at least two cards left, she can do one of two actions:   take any two (not necessarily adjacent) cards with different colors and exchange them for a new card of the third color;  take any two (not necessarily adjacent) cards with the same color and exchange them for a new card with that color. She repeats this process until there is only one card left. What are the possible colors for the final card?" 1300
626A "Robot Sequence" "brute force,implementation" "Calvin the robot lies in an infinite rectangular grid. Calvin\'s source code contains a list of n commands, each either \'U\', \'R\', \'D\', or \'L\' \xe2\x80\x94 instructions to move a single square up, right, down, or left, respectively. How many ways can Calvin execute a non-empty contiguous substrings of commands and return to the same square he starts in? Two substrings are considered different if they have different starting or ending indices." 1000
625E "Frog Fights" "data structures,greedy" "Ostap Bender recently visited frog farm and was inspired to create his own frog game.Number of frogs are places on a cyclic gameboard, divided into m cells. Cells are numbered from 1 to m, but the board is cyclic, so cell number 1 goes right after the cell number m in the direction of movement. i-th frog during its turn can jump for ai cells.Frogs move in turns, game starts with a move by frog 1. On its turn i-th frog moves ai cells forward, knocking out all the frogs on its way. If there is a frog in the last cell of the path of the i-th frog, that frog is also knocked out. After this the value ai is decreased by the number of frogs that were knocked out during this turn. If ai is zero or goes negative, then i-th frog doesn\'t make moves anymore.After frog number 1 finishes its turn, frog number 2 starts to move, then frog number 3 and so on. After the frog number n makes its move, frog 1 starts to move again, then frog 2 and so on this process goes forever. If some frog was already knocked out from the board, we consider that it skips all its moves.Help Ostap to identify, what frogs will stay on the board at the end of a game?" 2800
625D "Finals in arithmetic" "constructive algorithms,implementation,math" "Vitya is studying in the third grade. During the last math lesson all the pupils wrote on arithmetic quiz. Vitya is a clever boy, so he managed to finish all the tasks pretty fast and Oksana Fillipovna gave him a new one, that is much harder.Let\'s denote a flip operation of an integer as follows: number is considered in decimal notation and then reverted. If there are any leading zeroes afterwards, they are thrown away. For example, if we flip 123 the result is the integer 321, but flipping 130 we obtain 31, and by flipping 31 we come to 13.Oksana Fillipovna picked some number a without leading zeroes, and flipped it to get number ar. Then she summed a and ar, and told Vitya the resulting value n. His goal is to find any valid a.As Oksana Fillipovna picked some small integers as a and ar, Vitya managed to find the answer pretty fast and became interested in finding some general algorithm to deal with this problem. Now, he wants you to write the program that for given n finds any a without leading zeroes, such that a\xe2\x80\x89+\xe2\x80\x89ar\xe2\x80\x89=\xe2\x80\x89n or determine that such a doesn\'t exist." 2400
625C "K-special Tables" "constructive algorithms,implementation" "People do many crazy things to stand out in a crowd. Some of them dance, some learn by heart rules of Russian language, some try to become an outstanding competitive programmers, while others collect funny math objects.Alis is among these collectors. Right now she wants to get one of k-special tables. In case you forget, the table n\xe2\x80\x89\xc3\x97\xe2\x80\x89n is called k-special if the following three conditions are satisfied:  every integer from 1 to n2 appears in the table exactly once;  in each row numbers are situated in increasing order;  the sum of numbers in the k-th column is maximum possible. Your goal is to help Alice and find at least one k-special table of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89n. Both rows and columns are numbered from 1 to n, with rows numbered from top to bottom and columns numbered from left to right." 1300
625B "War of the Corporations" "constructive algorithms,greedy,strings" "A long time ago, in a galaxy far far away two giant IT-corporations Pineapple and Gogol continue their fierce competition. Crucial moment is just around the corner: Gogol is ready to release it\'s new tablet Lastus 3000.This new device is equipped with specially designed artificial intelligence (AI). Employees of Pineapple did their best to postpone the release of Lastus 3000 as long as possible. Finally, they found out, that the name of the new artificial intelligence is similar to the name of the phone, that Pineapple released 200 years ago. As all rights on its name belong to Pineapple, they stand on changing the name of Gogol\'s artificial intelligence.Pineapple insists, that the name of their phone occurs in the name of AI as a substring. Because the name of technology was already printed on all devices, the Gogol\'s director decided to replace some characters in AI name with ""#"". As this operation is pretty expensive, you should find the minimum number of characters to replace with ""#"", such that the name of AI doesn\'t contain the name of the phone as a substring.Substring is a continuous subsequence of a string." 1200
625A "Guest From the Past" implementation,math "Kolya Gerasimov loves kefir very much. He lives in year 1984 and knows all the details of buying this delicious drink. One day, as you probably know, he found himself in year 2084, and buying kefir there is much more complicated.Kolya is hungry, so he went to the nearest milk shop. In 2084 you may buy kefir in a plastic liter bottle, that costs a rubles, or in glass liter bottle, that costs b rubles. Also, you may return empty glass bottle and get c (c\xe2\x80\x89<\xe2\x80\x89b) rubles back, but you cannot return plastic bottles.Kolya has n rubles and he is really hungry, so he wants to drink as much kefir as possible. There were no plastic bottles in his 1984, so Kolya doesn\'t know how to act optimally and asks for your help." 1700
624B "Making a String" greedy,sortings "You are given an alphabet consisting of n letters, your task is to make a string of the maximum possible length so that the following conditions are satisfied:   the i-th letter occurs in the string no more than ai times;  the number of occurrences of each letter in the string must be distinct for all the letters that occurred in the string at least once." 1100
624A "Save Luke" math "Luke Skywalker got locked up in a rubbish shredder between two presses. R2D2 is already working on his rescue, but Luke needs to stay alive as long as possible. For simplicity we will assume that everything happens on a straight line, the presses are initially at coordinates 0 and L, and they move towards each other with speed v1 and v2, respectively. Luke has width d and is able to choose any position between the presses. Luke dies as soon as the distance between the presses is less than his width. Your task is to determine for how long Luke can stay alive." 800
623E "Transforming Sequence" combinatorics,dp,fft,math "Let\'s define the transformation P of a sequence of integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an as b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bn, where bi\xe2\x80\x89=\xe2\x80\x89a1 | a2 | ... | ai for all i\xe2\x80\x89=\xe2\x80\x891,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89n, where | is the bitwise OR operation.Vasya consequently applies the transformation P to all sequences of length n consisting of integers from 1 to 2k\xe2\x80\x89-\xe2\x80\x891 inclusive. He wants to know how many of these sequences have such property that their transformation is a strictly increasing sequence. Help him to calculate this number modulo 109\xe2\x80\x89+\xe2\x80\x897." 3300
623D Birthday greedy,math,probabilities "A MIPT student named Misha has a birthday today, and he decided to celebrate it in his country house in suburban Moscow. n friends came by, and after a typical party they decided to play blind man\'s buff.The birthday boy gets blindfolded and the other players scatter around the house. The game is played in several rounds. In each round, Misha catches exactly one of his friends and has to guess who it is. The probability of catching the i-th friend does not change between rounds and is equal to pi percent (as we know, it is directly proportional to the amount of alcohol consumed by the i-th friend) and p1\xe2\x80\x89+\xe2\x80\x89p2\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89pn\xe2\x80\x89=\xe2\x80\x89100 holds. Misha has no information about who he caught. After Misha makes an attempt to guess the caught person, the round ends. Even then, Misha isn\'t told whether he guessed correctly, and a new round begins.The game ends when Misha guesses every friend at least once, that is, there exists such set of rounds k1,\xe2\x80\x89k2,\xe2\x80\x89...,\xe2\x80\x89kn, that during round number ki Misha caught the i-th friend and guessed him. Misha wants to minimize the expectation of the number of rounds of the game. Despite the fact that at any point in the game Misha has no information about who he has already guessed, his friends are honest, and if they see that the condition for the end of the game is fulfilled, the game ends immediately. Find the expectation of the number of rounds in the game if Misha plays optimally." 2700
623C "Electric Charges" "binary search,dp" "Programmer Sasha is a student at MIPT (Moscow Institute of Physics and Technology) and he needs to make a laboratory work to pass his finals.A laboratory unit is a plane with standard coordinate axes marked on it. Physicists from Moscow Institute of Physics and Technology charged the axes by large electric charges: axis X is positive and axis Y is negative.Experienced laboratory worker marked n points with integer coordinates (xi,\xe2\x80\x89yi) on the plane and stopped the time. Sasha should use ""atomic tweezers"" to place elementary particles in these points. He has an unlimited number of electrons (negatively charged elementary particles) and protons (positively charged elementary particles). He can put either an electron or a proton at each marked point. As soon as all marked points are filled with particles, laboratory worker will turn on the time again and the particles will come in motion and after some time they will stabilize in equilibrium. The objective of the laboratory work is to arrange the particles in such a way, that the diameter of the resulting state (the maximum distance between the pairs of points of the set) is as small as possible.Since Sasha is a programmer, he naively thinks that all the particles will simply ""fall"" into their projections on the corresponding axes: electrons will fall on axis X, while protons will fall on axis Y. As we are programmers too, we will consider the same model as Sasha. That is, a particle gets from point (x,\xe2\x80\x89y) to point (x,\xe2\x80\x890) if it is an electron and to point (0,\xe2\x80\x89y) if it is a proton.As the laboratory has high background radiation and Sasha takes care of his laptop, he did not take it with him, and now he can\'t write a program that computes the minimum possible diameter of the resulting set. Therefore, you will have to do it for him.Print a square of the minimum possible diameter of the set." 2900
623B "Array GCD" "dp,greedy,number theory" "You are given array ai of length n. You may consecutively apply two operations to this array:  remove some subsegment (continuous subsequence) of length m\xe2\x80\x89<\xe2\x80\x89n and pay for it m\xc2\xb7a coins;  change some elements of the array by at most 1, and pay b coins for each change. Please note that each of operations may be applied at most once (and may be not applied at all) so you can remove only one segment and each number may be changed (increased or decreased) by at most 1. Also note, that you are not allowed to delete the whole array.Your goal is to calculate the minimum number of coins that you need to spend in order to make the greatest common divisor of the elements of the resulting array be greater than 1." 2300
623A "Graph and String" "constructive algorithms,graphs" "One day student Vasya was sitting on a lecture and mentioned a string s1s2... sn, consisting of letters ""a"", ""b"" and ""c"" that was written on his desk. As the lecture was boring, Vasya decided to complete the picture by composing a graph G with the following properties:   G has exactly n vertices, numbered from 1 to n.  For all pairs of vertices i and j, where i\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89j, there is an edge connecting them if and only if characters si and sj are either equal or neighbouring in the alphabet. That is, letters in pairs ""a""-""b"" and ""b""-""c"" are neighbouring, while letters ""a""-""c"" are not. Vasya painted the resulting graph near the string and then erased the string. Next day Vasya\'s friend Petya came to a lecture and found some graph at his desk. He had heard of Vasya\'s adventure and now he wants to find out whether it could be the original graph G, painted by Vasya. In order to verify this, Petya needs to know whether there exists a string s, such that if Vasya used this s he would produce the given graph G." 1800
622F "The Sum of the k-th Powers" math "There are well-known formulas: , , . Also mathematicians found similar formulas for higher degrees.Find the value of the sum  modulo 109\xe2\x80\x89+\xe2\x80\x897 (so you should find the remainder after dividing the answer by the value 109\xe2\x80\x89+\xe2\x80\x897)." 2600
622E "Ants in Leaves" "dfs and similar,greedy,sortings,trees" "Tree is a connected graph without cycles. A leaf of a tree is any vertex connected with exactly one other vertex.You are given a tree with n vertices and a root in the vertex 1. There is an ant in each leaf of the tree. In one second some ants can simultaneously go to the parent vertex from the vertex they were in. No two ants can be in the same vertex simultaneously except for the root of the tree.Find the minimal time required for all ants to be in the root of the tree. Note that at start the ants are only in the leaves of the tree." 2200
622D "Optimal Number Permutation" "constructive algorithms" "You have array a that contains all integers from 1 to n twice. You can arbitrary permute any numbers in a.Let number i be in positions xi,\xe2\x80\x89yi (xi\xe2\x80\x89<\xe2\x80\x89yi) in the permuted array a. Let\'s define the value di\xe2\x80\x89=\xe2\x80\x89yi\xe2\x80\x89-\xe2\x80\x89xi \xe2\x80\x94 the distance between the positions of the number i. Permute the numbers in array a to minimize the value of the sum ." 1900
622C "Not Equal on a Segment" "data structures,implementation" "You are given array a with n integers and m queries. The i-th query is given with three integers li,\xe2\x80\x89ri,\xe2\x80\x89xi.For the i-th query find any position pi (li\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89pi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ri) so that api\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89xi." 1700
622B "The Time" implementation "You are given the current time in 24-hour format hh:mm. Find and print the time after a minutes.Note that you should find only the time after a minutes, see the examples to clarify the problem statement.You can read more about 24-hour format here https://en.wikipedia.org/wiki/24-hour_clock." 900
622A "Infinite Sequence" implementation,math "Consider the infinite sequence of integers: 1,\xe2\x80\x891,\xe2\x80\x892,\xe2\x80\x891,\xe2\x80\x892,\xe2\x80\x893,\xe2\x80\x891,\xe2\x80\x892,\xe2\x80\x893,\xe2\x80\x894,\xe2\x80\x891,\xe2\x80\x892,\xe2\x80\x893,\xe2\x80\x894,\xe2\x80\x895.... The sequence is built in the following way: at first the number 1 is written out, then the numbers from 1 to 2, then the numbers from 1 to 3, then the numbers from 1 to 4 and so on. Note that the sequence contains numbers, not digits. For example number 10 first appears in the sequence in position 55 (the elements are numerated from one).Find the number on the n-th position of the sequence." 1000
621E "Wet Shark and Blocks" dp,matrices "There are b blocks of digits. Each one consisting of the same n digits, which are given to you in the input. Wet Shark must choose exactly one digit from each block and concatenate all of those digits together to form one large integer. For example, if he chooses digit 1 from the first block and digit 2 from the second block, he gets the integer 12. Wet Shark then takes this number modulo x. Please, tell him how many ways he can choose one digit from each block so that he gets exactly k as the final result. As this number may be too large, print it modulo 109\xe2\x80\x89+\xe2\x80\x897.Note, that the number of ways to choose some digit in the block is equal to the number of it\'s occurrences. For example, there are 3 ways to choose digit 5 from block 3 5 6 7 8 9 5 1 1 1 1 5." 2000
621D "Rat Kwesh and Cheese" "brute force,constructive algorithms,math" "Wet Shark asked Rat Kwesh to generate three positive real numbers x, y and z, from 0.1 to 200.0, inclusive. Wet Krash wants to impress Wet Shark, so all generated numbers will have exactly one digit after the decimal point.Wet Shark knows Rat Kwesh will want a lot of cheese. So he will give the Rat an opportunity to earn a lot of cheese. He will hand the three numbers x, y and z to Rat Kwesh, and Rat Kwesh will pick one of the these twelve options:  a1\xe2\x80\x89=\xe2\x80\x89xyz;  a2\xe2\x80\x89=\xe2\x80\x89xzy;  a3\xe2\x80\x89=\xe2\x80\x89(xy)z;  a4\xe2\x80\x89=\xe2\x80\x89(xz)y;  a5\xe2\x80\x89=\xe2\x80\x89yxz;  a6\xe2\x80\x89=\xe2\x80\x89yzx;  a7\xe2\x80\x89=\xe2\x80\x89(yx)z;  a8\xe2\x80\x89=\xe2\x80\x89(yz)x;  a9\xe2\x80\x89=\xe2\x80\x89zxy;  a10\xe2\x80\x89=\xe2\x80\x89zyx;  a11\xe2\x80\x89=\xe2\x80\x89(zx)y;  a12\xe2\x80\x89=\xe2\x80\x89(zy)x. Let m be the maximum of all the ai, and c be the smallest index (from 1 to 12) such that ac\xe2\x80\x89=\xe2\x80\x89m. Rat\'s goal is to find that c, and he asks you to help him. Rat Kwesh wants to see how much cheese he gets, so he you will have to print the expression corresponding to that ac." 2400
621C "Wet Shark and Flowers" "combinatorics,math,number theory,probabilities" "There are n sharks who grow flowers for Wet Shark. They are all sitting around the table, such that sharks i and i\xe2\x80\x89+\xe2\x80\x891 are neighbours for all i from 1 to n\xe2\x80\x89-\xe2\x80\x891. Sharks n and 1 are neighbours too.Each shark will grow some number of flowers si. For i-th shark value si is random integer equiprobably chosen in range from li to ri. Wet Shark has it\'s favourite prime number p, and he really likes it! If for any pair of neighbouring sharks i and j the product si\xc2\xb7sj is divisible by p, then Wet Shark becomes happy and gives 1000 dollars to each of these sharks.At the end of the day sharks sum all the money Wet Shark granted to them. Find the expectation of this value." 1700
621B "Wet Shark and Bishops" combinatorics,implementation "Today, Wet Shark is given n bishops on a 1000 by 1000 grid. Both rows and columns of the grid are numbered from 1 to 1000. Rows are numbered from top to bottom, while columns are numbered from left to right.Wet Shark thinks that two bishops attack each other if they share the same diagonal. Note, that this is the only criteria, so two bishops may attack each other (according to Wet Shark) even if there is another bishop located between them. Now Wet Shark wants to count the number of pairs of bishops that attack each other." 1300
621A "Wet Shark and Odd and Even" implementation "Today, Wet Shark is given n integers. Using any of these integers no more than once, Wet Shark wants to get maximum possible even (divisible by 2) sum. Please, calculate this value for Wet Shark. Note, that if Wet Shark uses no integers from the n integers, the sum is an even integer 0." 900
620F "Xors on Segments" "data structures,strings,trees" "You are given an array with n integers ai and m queries. Each query is described by two integers (lj,\xe2\x80\x89rj).Let\'s define the function . The function is defined for only u\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89v.For each query print the maximal value of the function f(ax,\xe2\x80\x89ay) over all lj\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x,\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89rj,\xe2\x80\x89 ax\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ay." 2800
620E "New Year Tree" "bitmasks,data structures,trees" "The New Year holidays are over, but Resha doesn\'t want to throw away the New Year tree. He invited his best friends Kerim and Gural to help him to redecorate the New Year tree.The New Year tree is an undirected tree with n vertices and root in the vertex 1.You should process the queries of the two types:  Change the colours of all vertices in the subtree of the vertex v to the colour c.  Find the number of different colours in the subtree of the vertex v." 2100
620D "Professor GukiZ and Two Arrays" "binary search,two pointers" "Professor GukiZ has two arrays of integers, a and b. Professor wants to make the sum of the elements in the array a sa as close as possible to the sum of the elements in the array b sb. So he wants to minimize the value v\xe2\x80\x89=\xe2\x80\x89|sa\xe2\x80\x89-\xe2\x80\x89sb|.In one operation professor can swap some element from the array a and some element from the array b. For example if the array a is [5,\xe2\x80\x891,\xe2\x80\x893,\xe2\x80\x892,\xe2\x80\x894] and the array b is [3,\xe2\x80\x893,\xe2\x80\x892] professor can swap the element 5 from the array a and the element 2 from the array b and get the new array a [2,\xe2\x80\x891,\xe2\x80\x893,\xe2\x80\x892,\xe2\x80\x894] and the new array b [3,\xe2\x80\x893,\xe2\x80\x895].Professor doesn\'t want to make more than two swaps. Find the minimal value v and some sequence of no more than two swaps that will lead to the such value v. Professor makes swaps one by one, each new swap he makes with the new arrays a and b." 2200
620C "Pearls in a Row" greedy "There are n pearls in a row. Let\'s enumerate them with integers from 1 to n from the left to the right. The pearl number i has the type ai.Let\'s call a sequence of consecutive pearls a segment. Let\'s call a segment good if it contains two pearls of the same type.Split the row of the pearls to the maximal number of good segments. Note that each pearl should appear in exactly one segment of the partition.As input/output can reach huge size it is recommended to use fast input/output methods: for example, prefer to use scanf/printf instead of cin/cout in C++, prefer to use BufferedReader/PrintWriter instead of Scanner/System.out in Java." 1500
620B "Grandfather Dovlet\xe2\x80\x99s calculator" implementation "Once Max found an electronic calculator from his grandfather Dovlet\'s chest. He noticed that the numbers were written with seven-segment indicators (https://en.wikipedia.org/wiki/Seven-segment_display).  Max starts to type all the values from a to b. After typing each number Max resets the calculator. Find the total number of segments printed on the calculator.For example if a\xe2\x80\x89=\xe2\x80\x891 and b\xe2\x80\x89=\xe2\x80\x893 then at first the calculator will print 2 segments, then \xe2\x80\x94 5 segments and at last it will print 5 segments. So the total number of printed segments is 12." 1000
620A "Professor GukiZ\'s Robot" implementation,math "Professor GukiZ makes a new robot. The robot are in the point with coordinates (x1,\xe2\x80\x89y1) and should go to the point (x2,\xe2\x80\x89y2). In a single step the robot can change any of its coordinates (maybe both of them) by one (decrease or increase). So the robot can move in one of the 8 directions. Find the minimal number of steps the robot should make to get the finish position." 800
618G "Combining Slimes" dp,math,matrices,probabilities "Your friend recently gave you some slimes for your birthday. You have a very large amount of slimes with value 1 and 2, and you decide to invent a game using these slimes.You initialize a row with n empty spaces. You also choose a number p to be used in the game. Then, you will perform the following steps while the last space is empty.   With probability , you will choose a slime with value 1, and with probability , you will choose a slime with value 2. You place the chosen slime on the last space of the board.  You will push the slime to the left as far as possible. If it encounters another slime, and they have the same value v, you will merge the slimes together to create a single slime with value v\xe2\x80\x89+\xe2\x80\x891. This continues on until the slime reaches the end of the board, or encounters a slime with a different value than itself. You have played the game a few times, but have gotten bored of it. You are now wondering, what is the expected sum of all values of the slimes on the board after you finish the game." 3300
618F "Double Knapsack" "constructive algorithms,two pointers" "You are given two multisets A and B. Each multiset has exactly n integers each between 1 and n inclusive. Multisets may contain multiple copies of the same number.You would like to find a nonempty subset of A and a nonempty subset of B such that the sum of elements in these subsets are equal. Subsets are also multisets, i.e. they can contain elements with equal values.If no solution exists, print \xe2\x80\x89-\xe2\x80\x891. Otherwise, print the indices of elements in any such subsets of A and B that have the same sum." 3000
618E "Robot Arm" "data structures,geometry" "Roger is a robot. He has an arm that is a series of n segments connected to each other. The endpoints of the i-th segment are initially located at points (i\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x890) and (i,\xe2\x80\x890). The endpoint at (i\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x890) is colored red and the endpoint at (i,\xe2\x80\x890) is colored blue for all segments. Thus, the blue endpoint of the i-th segment is touching the red endpoint of the (i\xe2\x80\x89+\xe2\x80\x891)-th segment for all valid i.Roger can move his arm in two different ways:   He can choose some segment and some value. This is denoted as choosing the segment number i and picking some positive l. This change happens as follows: the red endpoint of segment number i and segments from 1 to i\xe2\x80\x89-\xe2\x80\x891 are all fixed in place. Imagine a ray from the red endpoint to the blue endpoint. The blue endpoint and segments i\xe2\x80\x89+\xe2\x80\x891 through n are translated l units in the direction of this ray.   In this picture, the red point labeled A and segments before A stay in place, while the blue point labeled B and segments after B gets translated. He can choose a segment and rotate it. This is denoted as choosing the segment number i, and an angle a. The red endpoint of the i-th segment will stay fixed in place. The blue endpoint of that segment and segments i\xe2\x80\x89+\xe2\x80\x891 to n will rotate clockwise by an angle of a degrees around the red endpoint.   In this picture, the red point labeled A and segments before A stay in place, while the blue point labeled B and segments after B get rotated around point A. Roger will move his arm m times. These transformations are a bit complicated, and Roger easily loses track of where the blue endpoint of the last segment is. Help him compute the coordinates of the blue endpoint of the last segment after applying each operation. Note that these operations are cumulative, and Roger\'s arm may intersect itself arbitrarily during the moves." 2500
618D "Hamiltonian Spanning Tree" "dfs and similar,dp,graph matchings,greedy,trees" "A group of n cities is connected by a network of roads. There is an undirected road between every pair of cities, so there are  roads in total. It takes exactly y seconds to traverse any single road.A spanning tree is a set of roads containing exactly n\xe2\x80\x89-\xe2\x80\x891 roads such that it\'s possible to travel between any two cities using only these roads.Some spanning tree of the initial network was chosen. For every road in this tree the time one needs to traverse this road was changed from y to x seconds. Note that it\'s not guaranteed that x is smaller than y.You would like to travel through all the cities using the shortest path possible. Given n, x, y and a description of the spanning tree that was chosen, find the cost of the shortest path that starts in any city, ends in any city and visits all cities exactly once." 2200
618C Constellation geometry,implementation "Cat Noku has obtained a map of the night sky. On this map, he found a constellation with n stars numbered from 1 to n. For each i, the i-th star is located at coordinates (xi,\xe2\x80\x89yi). No two stars are located at the same position.In the evening Noku is going to take a look at the night sky. He would like to find three distinct stars and form a triangle. The triangle must have positive area. In addition, all other stars must lie strictly outside of this triangle. He is having trouble finding the answer and would like your help. Your job is to find the indices of three stars that would form a triangle that satisfies all the conditions. It is guaranteed that there is no line such that all stars lie on that line. It can be proven that if the previous condition is satisfied, there exists a solution to this problem." 1600
618B "Guess the Permutation" "constructive algorithms" "Bob has a permutation of integers from 1 to n. Denote this permutation as p. The i-th element of p will be denoted as pi. For all pairs of distinct integers i,\xe2\x80\x89j between 1 and n, he wrote the number ai,\xe2\x80\x89j\xe2\x80\x89=\xe2\x80\x89min(pi,\xe2\x80\x89pj). He writes ai,\xe2\x80\x89i\xe2\x80\x89=\xe2\x80\x890 for all integer i from 1 to n.Bob gave you all the values of ai,\xe2\x80\x89j that he wrote down. Your job is to reconstruct any permutation that could have generated these values. The input will be formed so that it is guaranteed that there is at least one solution that is consistent with the information given." 1100
618A "Slime Combining" implementation "Your friend recently gave you some slimes for your birthday. You have n slimes all initially with value 1.You are going to play a game with these slimes. Initially, you put a single slime by itself in a row. Then, you will add the other n\xe2\x80\x89-\xe2\x80\x891 slimes one by one. When you add a slime, you place it at the right of all already placed slimes. Then, while the last two slimes in the row have the same value v, you combine them together to create a slime with value v\xe2\x80\x89+\xe2\x80\x891.You would like to see what the final state of the row is after you\'ve added all n slimes. Please print the values of the slimes in the row from left to right." 800
617E "XOR and Favorite Number" "data structures" "Bob has a favorite number k and ai of length n. Now he asks you to answer m queries. Each query is given by a pair li and ri and asks you to count the number of pairs of integers i and j, such that l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r and the xor of the numbers ai,\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89aj is equal to k." 2200
617D Polyline "constructive algorithms,implementation" "There are three points marked on the coordinate plane. The goal is to make a simple polyline, without self-intersections and self-touches, such that it passes through all these points. Also, the polyline must consist of only segments parallel to the coordinate axes. You are to find the minimum number of segments this polyline may consist of." 1700
617C "Watering Flowers" implementation "A flowerbed has many flowers and two fountains.You can adjust the water pressure and set any values r1(r1\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x890) and r2(r2\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x890), giving the distances at which the water is spread from the first and second fountain respectively. You have to set such r1 and r2 that all the flowers are watered, that is, for each flower, the distance between the flower and the first fountain doesn\'t exceed r1, or the distance to the second fountain doesn\'t exceed r2. It\'s OK if some flowers are watered by both fountains.You need to decrease the amount of water you need, that is set such r1 and r2 that all the flowers are watered and the r12\xe2\x80\x89+\xe2\x80\x89r22 is minimum possible. Find this minimum value." 1600
617B Chocolate combinatorics "Bob loves everything sweet. His favorite chocolate bar consists of pieces, each piece may contain a nut. Bob wants to break the bar of chocolate into multiple pieces so that each part would contain exactly one nut and any break line goes between two adjacent pieces.You are asked to calculate the number of ways he can do it. Two ways to break chocolate are considered distinct if one of them contains a break between some two adjacent pieces and the other one doesn\'t. Please note, that if Bob doesn\'t make any breaks, all the bar will form one piece and it still has to have exactly one nut." 1300
617A Elephant math "An elephant decided to visit his friend. It turned out that the elephant\'s house is located at point 0 and his friend\'s house is located at point x(x\xe2\x80\x89>\xe2\x80\x890) of the coordinate line. In one step the elephant can move 1, 2, 3, 4 or 5 positions forward. Determine, what is the minimum number of steps he need to make in order to get to his friend\'s house." 800
616F "Expensive Strings" "data structures,sortings,string suffix structures,strings" "You are given n strings ti. Each string has cost ci.Let\'s define the function of string , where ps,\xe2\x80\x89i is the number of occurrences of s in ti, |s| is the length of the string s. Find the maximal value of function f(s) over all strings.Note that the string s is not necessarily some string from t." 2700
616E "Sum of Remainders" "implementation,math,number theory" "Calculate the value of the sum: n mod 1 + n mod 2 + n mod 3 + ... + n mod m. As the result can be very large, you should print the value modulo 109\xe2\x80\x89+\xe2\x80\x897 (the remainder when divided by 109\xe2\x80\x89+\xe2\x80\x897).The modulo operator a mod b stands for the remainder after dividing a by b. For example 10 mod 3 = 1." 2200
616D "Longest k-Good Segment" "binary search,data structures,two pointers" "The array a with n integers is given. Let\'s call the sequence of one or more consecutive elements in a segment. Also let\'s call the segment k-good if it contains no more than k different values.Find any longest k-good segment.As the input/output can reach huge size it is recommended to use fast input/output methods: for example, prefer to use scanf/printf instead of cin/cout in C++, prefer to use BufferedReader/PrintWriter instead of Scanner/System.out in Java." 1600
616C "The Labyrinth" "dfs and similar" "You are given a rectangular field of n\xe2\x80\x89\xc3\x97\xe2\x80\x89m cells. Each cell is either empty or impassable (contains an obstacle). Empty cells are marked with \'.\', impassable cells are marked with \'*\'. Let\'s call two empty cells adjacent if they share a side.Let\'s call a connected component any non-extendible set of cells such that any two of them are connected by the path of adjacent cells. It is a typical well-known definition of a connected component.For each impassable cell (x,\xe2\x80\x89y) imagine that it is an empty cell (all other cells remain unchanged) and find the size (the number of cells) of the connected component which contains (x,\xe2\x80\x89y). You should do it for each impassable cell independently.The answer should be printed as a matrix with n rows and m columns. The j-th symbol of the i-th row should be ""."" if the cell is empty at the start. Otherwise the j-th symbol of the i-th row should contain the only digit \xe2\x80\x94- the answer modulo 10. The matrix should be printed without any spaces.To make your output faster it is recommended to build the output as an array of n strings having length m and print it as a sequence of lines. It will be much faster than writing character-by-character.As input/output can reach huge size it is recommended to use fast input/output methods: for example, prefer to use scanf/printf instead of cin/cout in C++, prefer to use BufferedReader/PrintWriter instead of Scanner/System.out in Java." 1600
616B "Dinner with Emma" games,greedy "Jack decides to invite Emma out for a dinner. Jack is a modest student, he doesn\'t want to go to an expensive restaurant. Emma is a girl with high taste, she prefers elite places.Munhattan consists of n streets and m avenues. There is exactly one restaurant on the intersection of each street and avenue. The streets are numbered with integers from 1 to n and the avenues are numbered with integers from 1 to m. The cost of dinner in the restaurant at the intersection of the i-th street and the j-th avenue is cij.Jack and Emma decide to choose the restaurant in the following way. Firstly Emma chooses the street to dinner and then Jack chooses the avenue. Emma and Jack makes their choice optimally: Emma wants to maximize the cost of the dinner, Jack wants to minimize it. Emma takes into account that Jack wants to minimize the cost of the dinner. Find the cost of the dinner for the couple in love." 1000
616A "Comparing Two Long Integers" implementation,strings "You are given two very long integers a,\xe2\x80\x89b (leading zeroes are allowed). You should check what number a or b is greater or determine that they are equal.The input size is very large so don\'t use the reading of symbols one by one. Instead of that use the reading of a whole line or token.As input/output can reach huge size it is recommended to use fast input/output methods: for example, prefer to use scanf/printf instead of cin/cout in C++, prefer to use BufferedReader/PrintWriter instead of Scanner/System.out in Java. Don\'t use the function input() in Python2 instead of it use the function raw_input()." 900
615E Hexagons "binary search,implementation,math" "Ayrat is looking for the perfect code. He decided to start his search from an infinite field tiled by hexagons. For convenience the coordinate system is introduced, take a look at the picture to see how the coordinates of hexagon are defined:   Ayrat is searching through the field. He started at point (0,\xe2\x80\x890) and is moving along the spiral (see second picture). Sometimes he forgets where he is now. Help Ayrat determine his location after n moves." 2100
615D Multipliers "math,number theory" "Ayrat has number n, represented as it\'s prime factorization pi of size m, i.e. n\xe2\x80\x89=\xe2\x80\x89p1\xc2\xb7p2\xc2\xb7...\xc2\xb7pm. Ayrat got secret information that that the product of all divisors of n taken modulo 109\xe2\x80\x89+\xe2\x80\x897 is the password to the secret data base. Now he wants to calculate this value." 2000
615C "Running Track" dp,greedy,strings,trees "A boy named Ayrat lives on planet AMI-1511. Each inhabitant of this planet has a talent. Specifically, Ayrat loves running, moreover, just running is not enough for him. He is dreaming of making running a real art.First, he wants to construct the running track with coating t. On planet AMI-1511 the coating of the track is the sequence of colored blocks, where each block is denoted as the small English letter. Therefore, every coating can be treated as a string.Unfortunately, blocks aren\'t freely sold to non-business customers, but Ayrat found an infinite number of coatings s. Also, he has scissors and glue. Ayrat is going to buy some coatings s, then cut out from each of them exactly one continuous piece (substring) and glue it to the end of his track coating. Moreover, he may choose to flip this block before glueing it. Ayrat want\'s to know the minimum number of coating s he needs to buy in order to get the coating t for his running track. Of course, he also want\'s to know some way to achieve the answer." 2000
615B "Longtail Hedgehog" dp,graphs "This Christmas Santa gave Masha a magic picture and a pencil. The picture consists of n points connected by m segments (they might cross in any way, that doesn\'t matter). No two segments connect the same pair of points, and no segment connects the point to itself. Masha wants to color some segments in order paint a hedgehog. In Mashas mind every hedgehog consists of a tail and some spines. She wants to paint the tail that satisfies the following conditions:   Only segments already presented on the picture can be painted;  The tail should be continuous, i.e. consists of some sequence of points, such that every two neighbouring points are connected by a colored segment;  The numbers of points from the beginning of the tail to the end should strictly increase. Masha defines the length of the tail as the number of points in it. Also, she wants to paint some spines. To do so, Masha will paint all the segments, such that one of their ends is the endpoint of the tail. Masha defines the beauty of a hedgehog as the length of the tail multiplied by the number of spines. Masha wants to color the most beautiful hedgehog. Help her calculate what result she may hope to get.Note that according to Masha\'s definition of a hedgehog, one segment may simultaneously serve as a spine and a part of the tail (she is a little girl after all). Take a look at the picture for further clarifications." 1600
615A Bulbs implementation "Vasya wants to turn on Christmas lights consisting of m bulbs. Initially, all bulbs are turned off. There are n buttons, each of them is connected to some set of bulbs. Vasya can press any of these buttons. When the button is pressed, it turns on all the bulbs it\'s connected to. Can Vasya light up all the bulbs?If Vasya presses the button such that some bulbs connected to it are already turned on, they do not change their state, i.e. remain turned on." 800
614B "Gena\'s Code" implementation,math "It\'s the year 4527 and the tanks game that we all know and love still exists. There also exists Great Gena\'s code, written in 2016. The problem this code solves is: given the number of tanks that go into the battle from each country, find their product. If it is turns to be too large, then the servers might have not enough time to assign tanks into teams and the whole game will collapse!There are exactly n distinct countries in the world and the i-th country added ai tanks to the game. As the developers of the game are perfectionists, the number of tanks from each country is beautiful. A beautiful number, according to the developers, is such number that its decimal representation consists only of digits \'1\' and \'0\', moreover it contains at most one digit \'1\'. However, due to complaints from players, some number of tanks of one country was removed from the game, hence the number of tanks of this country may not remain beautiful.Your task is to write the program that solves exactly the same problem in order to verify Gena\'s code correctness. Just in case." 1400
614A "Link/Cut Tree" "brute force,implementation" "Programmer Rostislav got seriously interested in the Link/Cut Tree data structure, which is based on Splay trees. Specifically, he is now studying the expose procedure.Unfortunately, Rostislav is unable to understand the definition of this procedure, so he decided to ask programmer Serezha to help him. Serezha agreed to help if Rostislav solves a simple task (and if he doesn\'t, then why would he need Splay trees anyway?)Given integers l, r and k, you need to print all powers of number k within range from l to r inclusive. However, Rostislav doesn\'t want to spent time doing this, as he got interested in playing a network game called Agar with Gleb. Help him!" 1500
613E "Puzzle Lover" dp,hashing,strings "Oleg Petrov loves crossword puzzles and every Thursday he buys his favorite magazine with crosswords and other word puzzles. In the last magazine Oleg found a curious puzzle, and the magazine promised a valuable prize for it\'s solution. We give a formal description of the problem below.The puzzle field consists of two rows, each row contains n cells. Each cell contains exactly one small English letter. You also are given a word w, which consists of k small English letters. A solution of the puzzle is a sequence of field cells c1, ..., ck, such that: For all i from 1 to k the letter written in the cell ci matches the letter wi; All the cells in the sequence are pairwise distinct; For all i from 1 to k\xe2\x80\x89-\xe2\x80\x891 cells ci and ci\xe2\x80\x89+\xe2\x80\x891 have a common side.Oleg Petrov quickly found a solution for the puzzle. Now he wonders, how many distinct solutions are there for this puzzle. Oleg Petrov doesn\'t like too large numbers, so calculate the answer modulo 109\xe2\x80\x89+\xe2\x80\x897.Two solutions ci and c\'i are considered distinct if the sequences of cells do not match in at least one position, that is there is such j in range from 1 to k, such that cj\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89c\'j." 3200
613D "Kingdom and its Cities" "dfs and similar,divide and conquer,dp,graphs,sortings,trees" "Meanwhile, the kingdom of K is getting ready for the marriage of the King\'s daughter. However, in order not to lose face in front of the relatives, the King should first finish reforms in his kingdom. As the King can not wait for his daughter\'s marriage, reforms must be finished as soon as possible.The kingdom currently consists of n cities. Cities are connected by n\xe2\x80\x89-\xe2\x80\x891 bidirectional road, such that one can get from any city to any other city. As the King had to save a lot, there is only one path between any two cities.What is the point of the reform? The key ministries of the state should be relocated to distinct cities (we call such cities important). However, due to the fact that there is a high risk of an attack by barbarians it must be done carefully. The King has made several plans, each of which is described by a set of important cities, and now wonders what is the best plan.Barbarians can capture some of the cities that are not important (the important ones will have enough protection for sure), after that the captured city becomes impassable. In particular, an interesting feature of the plan is the minimum number of cities that the barbarians need to capture in order to make all the important cities isolated, that is, from all important cities it would be impossible to reach any other important city.Help the King to calculate this characteristic for each of his plan." 2800
613C Necklace "constructive algorithms,math" "Ivan wants to make a necklace as a present to his beloved girl. A necklace is a cyclic sequence of beads of different colors. Ivan says that necklace is beautiful relative to the cut point between two adjacent beads, if the chain of beads remaining after this cut is a palindrome (reads the same forward and backward).  Ivan has beads of n colors. He wants to make a necklace, such that it\'s beautiful relative to as many cuts as possible. He certainly wants to use all the beads. Help him to make the most beautiful necklace." 2500
613B Skills "binary search,brute force,dp,greedy,sortings,two pointers" "Lesha plays the recently published new version of the legendary game hacknet. In this version character skill mechanism was introduced. Now, each player character has exactly n skills. Each skill is represented by a non-negative integer ai \xe2\x80\x94 the current skill level. All skills have the same maximum level A.Along with the skills, global ranking of all players was added. Players are ranked according to the so-called Force. The Force of a player is the sum of the following values:  The number of skills that a character has perfected (i.e., such that ai\xe2\x80\x89=\xe2\x80\x89A), multiplied by coefficient cf. The minimum skill level among all skills (min ai), multiplied by coefficient cm. Now Lesha has m hacknetian currency units, which he is willing to spend. Each currency unit can increase the current level of any skill by 1 (if it\'s not equal to A yet). Help him spend his money in order to achieve the maximum possible value of the Force." 1900
613A "Peter and Snow Blower" "binary search,geometry,ternary search" "Peter got a new snow blower as a New Year present. Of course, Peter decided to try it immediately. After reading the instructions he realized that it does not work like regular snow blowing machines. In order to make it work, you need to tie it to some point that it does not cover, and then switch it on. As a result it will go along a circle around this point and will remove all the snow from its path.Formally, we assume that Peter\'s machine is a polygon on a plane. Then, after the machine is switched on, it will make a circle around the point to which Peter tied it (this point lies strictly outside the polygon). That is, each of the points lying within or on the border of the polygon will move along the circular trajectory, with the center of the circle at the point to which Peter tied his machine.Peter decided to tie his car to point P and now he is wondering what is the area of \xe2\x80\x8b\xe2\x80\x8bthe region that will be cleared from snow. Help him." 1900
612F "Simba on the Circle" dp "You are given a circular array with n elements. The elements are numbered from some element with values from 1 to n in clockwise order. The i-th cell contains the value ai. The robot Simba is in cell s.Each moment of time the robot is in some of the n cells (at the begin he is in s). In one turn the robot can write out the number written in current cell or move to the adjacent cell in clockwise or counterclockwise direction. To write out the number from the cell Simba doesn\'t spend any time, but to move to adjacent cell Simba spends one unit of time.Simba wants to write the number from each cell one time, so the numbers will be written in a non decreasing order. Find the least number of time units to write out all numbers." 2600
612E "Square Root of Permutation" "combinatorics,constructive algorithms,dfs and similar,graphs,math" "A permutation of length n is an array containing each integer from 1 to n exactly once. For example, q\xe2\x80\x89=\xe2\x80\x89[4,\xe2\x80\x895,\xe2\x80\x891,\xe2\x80\x892,\xe2\x80\x893] is a permutation. For the permutation q the square of permutation is the permutation p that p[i]\xe2\x80\x89=\xe2\x80\x89q[q[i]] for each i\xe2\x80\x89=\xe2\x80\x891... n. For example, the square of q\xe2\x80\x89=\xe2\x80\x89[4,\xe2\x80\x895,\xe2\x80\x891,\xe2\x80\x892,\xe2\x80\x893] is p\xe2\x80\x89=\xe2\x80\x89q2\xe2\x80\x89=\xe2\x80\x89[2,\xe2\x80\x893,\xe2\x80\x894,\xe2\x80\x895,\xe2\x80\x891].This problem is about the inverse operation: given the permutation p you task is to find such permutation q that q2\xe2\x80\x89=\xe2\x80\x89p. If there are several such q find any of them." 2200
612D "The Union of k-Segments" greedy,sortings "You are given n segments on the coordinate axis Ox and the number k. The point is satisfied if it belongs to at least k segments. Find the smallest (by the number of segments) set of segments on the coordinate axis Ox which contains all satisfied points and no others." 1800
612C "Replace To Make Regular Bracket Sequence" "data structures,expression parsing,math" "You are given string s consists of opening and closing brackets of four kinds <>, {}, [], (). There are two types of brackets: opening and closing. You can replace any bracket by another of the same type. For example, you can replace < by the bracket {, but you can\'t replace it by ) or >.The following definition of a regular bracket sequence is well-known, so you can be familiar with it.Let\'s define a regular bracket sequence (RBS). Empty string is RBS. Let s1 and s2 be a RBS then the strings <s1>s2, {s1}s2, [s1]s2, (s1)s2 are also RBS.For example the string ""[[(){}]<>]"" is RBS, but the strings ""[)()"" and ""][()()"" are not.Determine the least number of replaces to make the string s RBS." 1400
612B "HDD is Outdated Technology" implementation,math "HDD hard drives group data by sectors. All files are split to fragments and each of them are written in some sector of hard drive. Note the fragments can be written in sectors in arbitrary order.One of the problems of HDD hard drives is the following: the magnetic head should move from one sector to another to read some file.Find the time need to read file split to n fragments. The i-th sector contains the fi-th fragment of the file (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89fi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n). Note different sectors contains the different fragments. At the start the magnetic head is in the position that contains the first fragment. The file are reading in the following manner: at first the first fragment is read, then the magnetic head moves to the sector that contains the second fragment, then the second fragment is read and so on until the n-th fragment is read. The fragments are read in the order from the first to the n-th.It takes |a\xe2\x80\x89-\xe2\x80\x89b| time units to move the magnetic head from the sector a to the sector b. Reading a fragment takes no time." 1200
612A "The Text Splitting" "brute force,implementation,strings" "You are given the string s of length n and the numbers p,\xe2\x80\x89q. Split the string s to pieces of length p and q.For example, the string ""Hello"" for p\xe2\x80\x89=\xe2\x80\x892, q\xe2\x80\x89=\xe2\x80\x893 can be split to the two strings ""Hel"" and ""lo"" or to the two strings ""He"" and ""llo"".Note it is allowed to split the string s to the strings only of length p or to the strings only of length q (see the second sample test)." 1300
611H "New Year  and Forgotten Tree" "constructive algorithms,flows,graphs" "A tree is a connected undirected graph with n\xe2\x80\x89-\xe2\x80\x891 edges, where n denotes the number of vertices. Vertices are numbered 1 through n.Limak is a little polar bear. His bear family prepares a New Year tree every year. One year ago their tree was more awesome than usually. Thus, they decided to prepare the same tree in the next year. Limak was responsible for remembering that tree.It would be hard to remember a whole tree. Limak decided to describe it in his notebook instead. He took a pen and wrote n\xe2\x80\x89-\xe2\x80\x891 lines, each with two integers \xe2\x80\x94 indices of two vertices connected by an edge.Now, the New Year is just around the corner and Limak is asked to reconstruct that tree. Of course, there is a problem. He was a very little bear a year ago, and he didn\'t know digits and the alphabet, so he just replaced each digit with a question mark \xe2\x80\x94 the only character he knew. That means, for any vertex index in his notes he knows only the number of digits in it. At least he knows there were no leading zeroes.Limak doesn\'t want to disappoint everyone. Please, take his notes and reconstruct a New Year tree. Find any tree matching Limak\'s records and print its edges in any order. It\'s also possible that Limak made a mistake and there is no suitable tree \xe2\x80\x93 in this case print ""-1"" (without the quotes)." 3200
611G "New Year and Cake" "geometry,two pointers" "Limak is a little polar bear. According to some old traditions, his bear family prepared a New Year cake. And Limak likes cakes.As you may know, a New Year cake is a strictly convex polygon with n vertices.Parents won\'t allow Limak to eat more than half of a cake because he would get sick. After some thinking they decided to cut a cake along one of n\xc2\xb7(n\xe2\x80\x89-\xe2\x80\x893)\xe2\x80\x89/\xe2\x80\x892 diagonals. Then Limak will get a non-greater piece.Limak understands rules but he won\'t be happy if the second piece happens to be much bigger. Limak\'s disappointment will be equal to the difference between pieces\' areas, multiplied by two. It can be proved that it will be integer for the given constraints.There are n\xc2\xb7(n\xe2\x80\x89-\xe2\x80\x893)\xe2\x80\x89/\xe2\x80\x892 possible scenarios. Consider them all and find the sum of values of Limak\'s disappointment, modulo 109\xe2\x80\x89+\xe2\x80\x897." 2900
611F "New Year and Cleaning" "binary search,implementation" "Limak is a little polar bear. His parents told him to clean a house before the New Year\'s Eve. Their house is a rectangular grid with h rows and w columns. Each cell is an empty square.He is a little bear and thus he can\'t clean a house by himself. Instead, he is going to use a cleaning robot.A cleaning robot has a built-in pattern of n moves, defined by a string of the length n. A single move (character) moves a robot to one of four adjacent cells. Each character is one of the following four: \'U\' (up), \'D\' (down), \'L\' (left), \'R\' (right). One move takes one minute.A cleaning robot must be placed and started in some cell. Then it repeats its pattern of moves till it hits a wall (one of four borders of a house). After hitting a wall it can be placed and used again.Limak isn\'t sure if placing a cleaning robot in one cell will be enough. Thus, he is going to start it w\xc2\xb7h times, one time in each cell. Maybe some cells will be cleaned more than once but who cares?Limak asks you one question. How much time will it take to clean a house? Find and print the number of minutes modulo 109\xe2\x80\x89+\xe2\x80\x897. It\'s also possible that a cleaning robot will never stop \xe2\x80\x94 then print ""-1"" (without the quotes) instead.Placing and starting a robot takes no time, however, you must count a move when robot hits a wall. Take a look into samples for further clarification." 2500
611E "New Year and Three Musketeers" "data structures,greedy,sortings" "Do you know the story about the three musketeers? Anyway, you must help them now.Richelimakieu is a cardinal in the city of Bearis. He found three brave warriors and called them the three musketeers. Athos has strength a, Borthos strength b, and Caramis has strength c.The year 2015 is almost over and there are still n criminals to be defeated. The i-th criminal has strength ti. It\'s hard to defeat strong criminals \xe2\x80\x94 maybe musketeers will have to fight together to achieve it.Richelimakieu will coordinate musketeers\' actions. In each hour each musketeer can either do nothing or be assigned to one criminal. Two or three musketeers can be assigned to the same criminal and then their strengths are summed up. A criminal can be defeated in exactly one hour (also if two or three musketeers fight him). Richelimakieu can\'t allow the situation where a criminal has strength bigger than the sum of strengths of musketeers fighting him \xe2\x80\x94 a criminal would win then!In other words, there are three ways to defeat a criminal.  A musketeer of the strength x in one hour can defeat a criminal of the strength not greater than x. So, for example Athos in one hour can defeat criminal i only if ti\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a.  Two musketeers can fight together and in one hour defeat a criminal of the strength not greater than the sum of strengths of these two musketeers. So, for example Athos and Caramis in one hour can defeat criminal i only if ti\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a\xe2\x80\x89+\xe2\x80\x89c. Note that the third remaining musketeer can either do nothing or fight some other criminal.  Similarly, all three musketeers can fight together and in one hour defeat a criminal of the strength not greater than the sum of musketeers\' strengths, i.e. ti\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a\xe2\x80\x89+\xe2\x80\x89b\xe2\x80\x89+\xe2\x80\x89c. Richelimakieu doesn\'t want musketeers to fight during the New Year\'s Eve. Thus, he must coordinate their actions in order to minimize the number of hours till all criminals will be defeated.Find the minimum number of hours to defeat all criminals. If musketeers can\'t defeat them all then print ""-1"" (without the quotes) instead." 2400
611D "New Year and Ancient Prophecy" dp,hashing,strings "Limak is a little polar bear. In the snow he found a scroll with the ancient prophecy. Limak doesn\'t know any ancient languages and thus is unable to understand the prophecy. But he knows digits!One fragment of the prophecy is a sequence of n digits. The first digit isn\'t zero. Limak thinks that it\'s a list of some special years. It\'s hard to see any commas or spaces, so maybe ancient people didn\'t use them. Now Limak wonders what years are listed there.Limak assumes three things:  Years are listed in the strictly increasing order;  Every year is a positive integer number;  There are no leading zeros. Limak is going to consider all possible ways to split a sequence into numbers (years), satisfying the conditions above. He will do it without any help. However, he asked you to tell him the number of ways to do so. Since this number may be very large, you are only asked to calculate it modulo 109\xe2\x80\x89+\xe2\x80\x897." 2000
611C "New Year and Domino" dp,implementation "They say ""years are like dominoes, tumbling one after the other"". But would a year fit into a grid? I don\'t think so.Limak is a little polar bear who loves to play. He has recently got a rectangular grid with h rows and w columns. Each cell is a square, either empty (denoted by \'.\') or forbidden (denoted by \'#\'). Rows are numbered 1 through h from top to bottom. Columns are numbered 1 through w from left to right.Also, Limak has a single domino. He wants to put it somewhere in a grid. A domino will occupy exactly two adjacent cells, located either in one row or in one column. Both adjacent cells must be empty and must be inside a grid.Limak needs more fun and thus he is going to consider some queries. In each query he chooses some rectangle and wonders, how many way are there to put a single domino inside of the chosen rectangle?" 1500
611B "New Year and Old Property" "bitmasks,brute force,implementation" "The year 2015 is almost over.Limak is a little polar bear. He has recently learnt about the binary system. He noticed that the passing year has exactly one zero in its representation in the binary system \xe2\x80\x94 201510\xe2\x80\x89=\xe2\x80\x89111110111112. Note that he doesn\'t care about the number of zeros in the decimal representation.Limak chose some interval of years. He is going to count all years from this interval that have exactly one zero in the binary representation. Can you do it faster?Assume that all positive integers are always written without leading zeros." 1300
611A "New Year and Days" implementation "Today is Wednesday, the third day of the week. What\'s more interesting is that tomorrow is the last day of the year 2015.Limak is a little polar bear. He enjoyed this year a lot. Now, he is so eager to the coming year 2016.Limak wants to prove how responsible a bear he is. He is going to regularly save candies for the entire year 2016! He considers various saving plans. He can save one candy either on some fixed day of the week or on some fixed day of the month.Limak chose one particular plan. He isn\'t sure how many candies he will save in the 2016 with his plan. Please, calculate it and tell him." 900
610E "Alphabet Permutations" "data structures,strings" "You are given a string s of length n, consisting of first k lowercase English letters.We define a c-repeat of some string q as a string, consisting of c copies of the string q. For example, string ""acbacbacbacb"" is a 4-repeat of the string ""acb"".Let\'s say that string a contains string b as a subsequence, if string b can be obtained from a by erasing some symbols.Let p be a string that represents some permutation of the first k lowercase English letters. We define function d(p) as the smallest integer such that a d(p)-repeat of the string p contains string s as a subsequence.There are m operations of one of two types that can be applied to string s:  Replace all characters at positions from li to ri by a character ci.  For the given p, that is a permutation of first k lowercase English letters, find the value of function d(p). All operations are performed sequentially, in the order they appear in the input. Your task is to determine the values of function d(p) for all operations of the second type." 2500
610D "Vika and Segments" "constructive algorithms,data structures,geometry,two pointers" "Vika has an infinite sheet of squared paper. Initially all squares are white. She introduced a two-dimensional coordinate system on this sheet and drew n black horizontal and vertical segments parallel to the coordinate axes. All segments have width equal to 1 square, that means every segment occupy some set of neighbouring squares situated in one row or one column.Your task is to calculate the number of painted cells. If a cell was painted more than once, it should be calculated exactly once." 2300
610C "Harmony Analysis" "constructive algorithms" "The semester is already ending, so Danil made an effort and decided to visit a lesson on harmony analysis to know how does the professor look like, at least. Danil was very bored on this lesson until the teacher gave the group a simple task: find 4 vectors in 4-dimensional space, such that every coordinate of every vector is 1 or \xe2\x80\x89-\xe2\x80\x891 and any two vectors are orthogonal. Just as a reminder, two vectors in n-dimensional space are considered to be orthogonal if and only if their scalar product is equal to zero, that is: .Danil quickly managed to come up with the solution for this problem and the teacher noticed that the problem can be solved in a more general case for 2k vectors in 2k-dimensinoal space. When Danil came home, he quickly came up with the solution for this problem. Can you cope with it?" 1800
610B "Vika and Squares" "constructive algorithms,implementation" "Vika has n jars with paints of distinct colors. All the jars are numbered from 1 to n and the i-th jar contains ai liters of paint of color i.Vika also has an infinitely long rectangular piece of paper of width 1, consisting of squares of size 1\xe2\x80\x89\xc3\x97\xe2\x80\x891. Squares are numbered 1, 2, 3 and so on. Vika decided that she will start painting squares one by one from left to right, starting from the square number 1 and some arbitrary color. If the square was painted in color x, then the next square will be painted in color x\xe2\x80\x89+\xe2\x80\x891. In case of x\xe2\x80\x89=\xe2\x80\x89n, next square is painted in color 1. If there is no more paint of the color Vika wants to use now, then she stops.Square is always painted in only one color, and it takes exactly 1 liter of paint. Your task is to calculate the maximum number of squares that might be painted, if Vika chooses right color to paint the first square." 1300
610A "Pasha and Stick" combinatorics,math "Pasha has a wooden stick of some positive integer length n. He wants to perform exactly three cuts to get four parts of the stick. Each part must have some positive integer length and the sum of these lengths will obviously be n. Pasha likes rectangles but hates squares, so he wonders, how many ways are there to split a stick into four parts so that it\'s possible to form a rectangle using these parts, but is impossible to form a square.Your task is to help Pasha and count the number of such ways. Two ways to cut the stick are considered distinct if there exists some integer x, such that the number of parts of length x in the first way differ from the number of parts of length x in the second way." 1000
609F "Frogs and mosquitoes" "data structures,greedy" "There are n frogs sitting on the coordinate axis Ox. For each frog two values xi,\xe2\x80\x89ti are known \xe2\x80\x94 the position and the initial length of the tongue of the i-th frog (it is guaranteed that all positions xi are different). m mosquitoes one by one are landing to the coordinate axis. For each mosquito two values are known pj \xe2\x80\x94 the coordinate of the position where the j-th mosquito lands and bj \xe2\x80\x94 the size of the j-th mosquito. Frogs and mosquitoes are represented as points on the coordinate axis.The frog can eat mosquito if mosquito is in the same position with the frog or to the right, and the distance between them is not greater than the length of the tongue of the frog.If at some moment several frogs can eat a mosquito the leftmost frog will eat it (with minimal xi). After eating a mosquito the length of the tongue of a frog increases with the value of the size of eaten mosquito. It\'s possible that after it the frog will be able to eat some other mosquitoes (the frog should eat them in this case).For each frog print two values \xe2\x80\x94 the number of eaten mosquitoes and the length of the tongue after landing all mosquitoes and after eating all possible mosquitoes by frogs.Each mosquito is landing to the coordinate axis only after frogs eat all possible mosquitoes landed before. Mosquitoes are given in order of their landing to the coordinate axis." 2500
609E "Minimum spanning tree for each edge" "data structures,dfs and similar,dsu,graphs,trees" "Connected undirected weighted graph without self-loops and multiple edges is given. Graph contains n vertices and m edges.For each edge (u,\xe2\x80\x89v) find the minimal possible weight of the spanning tree that contains the edge (u,\xe2\x80\x89v).The weight of the spanning tree is the sum of weights of all edges included in spanning tree." 2100
609D "Gadgets for dollars and pounds" "binary search,greedy,two pointers" "Nura wants to buy k gadgets. She has only s burles for that. She can buy each gadget for dollars or for pounds. So each gadget is selling only for some type of currency. The type of currency and the cost in that currency are not changing.Nura can buy gadgets for n days. For each day you know the exchange rates of dollar and pound, so you know the cost of conversion burles to dollars or to pounds.Each day (from 1 to n) Nura can buy some gadgets by current exchange rate. Each day she can buy any gadgets she wants, but each gadget can be bought no more than once during n days.Help Nura to find the minimum day index when she will have k gadgets. Nura always pays with burles, which are converted according to the exchange rate of the purchase day. Nura can\'t buy dollars or pounds, she always stores only burles. Gadgets are numbered with integers from 1 to m in order of their appearing in input." 2000
609C "Load Balancing" implementation,math "In the school computer room there are n servers which are responsible for processing several computing tasks. You know the number of scheduled tasks for each server: there are mi tasks assigned to the i-th server.In order to balance the load for each server, you want to reassign some tasks to make the difference between the most loaded server and the least loaded server as small as possible. In other words you want to minimize expression ma\xe2\x80\x89-\xe2\x80\x89mb, where a is the most loaded server and b is the least loaded one.In one second you can reassign a single task. Thus in one second you can choose any pair of servers and move a single task from one server to another.Write a program to find the minimum number of seconds needed to balance the load of servers." 1500
609B "The Best Gift" "constructive algorithms,implementation" "Emily\'s birthday is next week and Jack has decided to buy a present for her. He knows she loves books so he goes to the local bookshop, where there are n books on sale from one of m genres.In the bookshop, Jack decides to buy two books of different genres.Based on the genre of books on sale in the shop, find the number of options available to Jack for choosing two books of different genres for Emily. Options are considered different if they differ in at least one book.The books are given by indices of their genres. The genres are numbered from 1 to m." 1100
609A "USB Flash Drives" greedy,implementation,sortings "Sean is trying to save a large file to a USB flash drive. He has n USB flash drives with capacities equal to a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an megabytes. The file size is equal to m megabytes. Find the minimum number of USB flash drives needed to write Sean\'s file, if he can split the file between drives." 800
608B "Hamming Distance Sum" combinatorics,strings "Genos needs your help. He was asked to solve the following programming problem by Saitama:The length of some string s is denoted |s|. The Hamming distance between two strings s and t of equal length is defined as , where si is the i-th character of s and ti is the i-th character of t. For example, the Hamming distance between string ""0011"" and string ""0110"" is |0\xe2\x80\x89-\xe2\x80\x890|\xe2\x80\x89+\xe2\x80\x89|0\xe2\x80\x89-\xe2\x80\x891|\xe2\x80\x89+\xe2\x80\x89|1\xe2\x80\x89-\xe2\x80\x891|\xe2\x80\x89+\xe2\x80\x89|1\xe2\x80\x89-\xe2\x80\x890|\xe2\x80\x89=\xe2\x80\x890\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x890\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89=\xe2\x80\x892.Given two binary strings a and b, find the sum of the Hamming distances between a and all contiguous substrings of b of length |a|." 1500
608A "Saitama Destroys Hotel" implementation,math "Saitama accidentally destroyed a hotel again. To repay the hotel company, Genos has volunteered to operate an elevator in one of its other hotels. The elevator is special \xe2\x80\x94 it starts on the top floor, can only move down, and has infinite capacity. Floors are numbered from 0 to s and elevator initially starts on floor s at time 0.The elevator takes exactly 1 second to move down exactly 1 floor and negligible time to pick up passengers. Genos is given a list detailing when and on which floor passengers arrive. Please determine how long in seconds it will take Genos to bring all passengers to floor 0." 1000
607E "Cross Sum" "binary search,geometry" "Genos has been given n distinct lines on the Cartesian plane. Let  be a list of intersection points of these lines. A single point might appear multiple times in this list if it is the intersection of multiple pairs of lines. The order of the list does not matter.Given a query point (p,\xe2\x80\x89q), let  be the corresponding list of distances of all points in  to the query point. Distance here refers to euclidean distance. As a refresher, the euclidean distance between two points (x1,\xe2\x80\x89y1) and (x2,\xe2\x80\x89y2) is .Genos is given a point (p,\xe2\x80\x89q) and a positive integer m. He is asked to find the sum of the m smallest elements in . Duplicate elements in  are treated as separate elements. Genos is intimidated by Div1 E problems so he asked for your help." 3300
607D "Power Tree" "data structures,trees" "Genos and Saitama went shopping for Christmas trees. However, a different type of tree caught their attention, the exalted Power Tree. A Power Tree starts out as a single root vertex indexed 1. A Power Tree grows through a magical phenomenon known as an update. In an update, a single vertex is added to the tree as a child of some other vertex.Every vertex in the tree (the root and all the added vertices) has some value vi associated with it. The power of a vertex is defined as the strength of the multiset composed of the value associated with this vertex (vi) and the powers of its direct children. The strength of a multiset is defined as the sum of all elements in the multiset multiplied by the number of elements in it. Or in other words for some multiset S: Saitama knows the updates that will be performed on the tree, so he decided to test Genos by asking him queries about the tree during its growth cycle.An update is of the form 1 p v, and adds a new vertex with value v as a child of vertex p.A query is of the form 2 u, and asks for the power of vertex u.Please help Genos respond to these queries modulo 109\xe2\x80\x89+\xe2\x80\x897." 2600
607C Marbles hashing,strings "In the spirit of the holidays, Saitama has given Genos two grid paths of length n (a weird gift even by Saitama\'s standards). A grid path is an ordered sequence of neighbouring squares in an infinite grid. Two squares are neighbouring if they share a side.One example of a grid path is (0,\xe2\x80\x890)\xe2\x80\x89\xe2\x86\x92\xe2\x80\x89(0,\xe2\x80\x891)\xe2\x80\x89\xe2\x86\x92\xe2\x80\x89(0,\xe2\x80\x892)\xe2\x80\x89\xe2\x86\x92\xe2\x80\x89(1,\xe2\x80\x892)\xe2\x80\x89\xe2\x86\x92\xe2\x80\x89(1,\xe2\x80\x891)\xe2\x80\x89\xe2\x86\x92\xe2\x80\x89(0,\xe2\x80\x891)\xe2\x80\x89\xe2\x86\x92\xe2\x80\x89(\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x891). Note that squares in this sequence might be repeated, i.e. path has self intersections.Movement within a grid path is restricted to adjacent squares within the sequence. That is, from the i-th square, one can only move to the (i\xe2\x80\x89-\xe2\x80\x891)-th or (i\xe2\x80\x89+\xe2\x80\x891)-th squares of this path. Note that there is only a single valid move from the first and last squares of a grid path. Also note, that even if there is some j-th square of the path that coincides with the i-th square, only moves to (i\xe2\x80\x89-\xe2\x80\x891)-th and (i\xe2\x80\x89+\xe2\x80\x891)-th squares are available. For example, from the second square in the above sequence, one can only move to either the first or third squares.To ensure that movement is not ambiguous, the two grid paths will not have an alternating sequence of three squares. For example, a contiguous subsequence (0,\xe2\x80\x890)\xe2\x80\x89\xe2\x86\x92\xe2\x80\x89(0,\xe2\x80\x891)\xe2\x80\x89\xe2\x86\x92\xe2\x80\x89(0,\xe2\x80\x890) cannot occur in a valid grid path.One marble is placed on the first square of each grid path. Genos wants to get both marbles to the last square of each grid path. However, there is a catch. Whenever he moves one marble, the other marble will copy its movement if possible. For instance, if one marble moves east, then the other marble will try and move east as well. By try, we mean if moving east is a valid move, then the marble will move east.Moving north increases the second coordinate by 1, while moving south decreases it by 1. Similarly, moving east increases first coordinate by 1, while moving west decreases it.Given these two valid grid paths, Genos wants to know if it is possible to move both marbles to the ends of their respective paths. That is, if it is possible to move the marbles such that both marbles rest on the last square of their respective paths." 2500
607B Zuma dp "Genos recently installed the game Zuma on his phone. In Zuma there exists a line of n gemstones, the i-th of which has color ci. The goal of the game is to destroy all the gemstones in the line as quickly as possible.In one second, Genos is able to choose exactly one continuous substring of colored gemstones that is a palindrome and remove it from the line. After the substring is removed, the remaining gemstones shift to form a solid line again. What is the minimum number of seconds needed to destroy the entire line?Let us remind, that the string (or substring) is called palindrome, if it reads same backwards or forward. In our case this means the color of the first gemstone is equal to the color of the last one, the color of the second gemstone is equal to the color of the next to last and so on." 1900
607A "Chain Reaction" "binary search,dp" "There are n beacons located at distinct positions on a number line. The i-th beacon has position ai and power level bi. When the i-th beacon is activated, it destroys all beacons to its left (direction of decreasing coordinates) within distance bi inclusive. The beacon itself is not destroyed however. Saitama will activate the beacons one at a time from right to left. If a beacon is destroyed, it cannot be activated.Saitama wants Genos to add a beacon strictly to the right of all the existing beacons, with any position and any power level, such that the least possible number of beacons are destroyed. Note that Genos\'s placement of the beacon means it will be the first beacon activated. Help Genos by finding the minimum number of beacons that could be destroyed." 1600
606B "Testing Robots" implementation "The Cybernetics Failures (CF) organisation made a prototype of a bomb technician robot. To find the possible problems it was decided to carry out a series of tests. At the beginning of each test the robot prototype will be placed in cell (x0,\xe2\x80\x89y0) of a rectangular squared field of size x\xe2\x80\x89\xc3\x97\xe2\x80\x89y, after that a mine will be installed into one of the squares of the field. It is supposed to conduct exactly x\xc2\xb7y tests, each time a mine is installed into a square that has never been used before. The starting cell of the robot always remains the same.After placing the objects on the field the robot will have to run a sequence of commands given by string s, consisting only of characters \'L\', \'R\', \'U\', \'D\'. These commands tell the robot to move one square to the left, to the right, up or down, or stay idle if moving in the given direction is impossible. As soon as the robot fulfills all the sequence of commands, it will blow up due to a bug in the code. But if at some moment of time the robot is at the same square with the mine, it will also blow up, but not due to a bug in the code.Moving to the left decreases coordinate y, and moving to the right increases it. Similarly, moving up decreases the x coordinate, and moving down increases it.The tests can go on for very long, so your task is to predict their results. For each k from 0 to length(s) your task is to find in how many tests the robot will run exactly k commands before it blows up." 1600
606A "Magic Spheres" implementation "Carl is a beginner magician. He has a blue, b violet and c orange magic spheres. In one move he can transform two spheres of the same color into one sphere of any other color. To make a spell that has never been seen before, he needs at least x blue, y violet and z orange spheres. Can he get them (possible, in multiple actions)?" 1200
605E "Intergalaxy Trips" "probabilities,shortest paths" "The scientists have recently discovered wormholes \xe2\x80\x94 objects in space that allow to travel very long distances between galaxies and star systems. The scientists know that there are n galaxies within reach. You are in the galaxy number 1 and you need to get to the galaxy number n. To get from galaxy i to galaxy j, you need to fly onto a wormhole (i,\xe2\x80\x89j) and in exactly one galaxy day you will find yourself in galaxy j. Unfortunately, the required wormhole is not always available. Every galaxy day they disappear and appear at random. However, the state of wormholes does not change within one galaxy day. A wormhole from galaxy i to galaxy j exists during each galaxy day taken separately with probability pij. You can always find out what wormholes exist at the given moment. At each moment you can either travel to another galaxy through one of wormholes that exist at this moment or you can simply wait for one galaxy day to see which wormholes will lead from your current position at the next day.Your task is to find the expected value of time needed to travel from galaxy 1 to galaxy n, if you act in the optimal way. It is guaranteed that this expected value exists." 2700
605D "Board Game" "data structures,dfs and similar" "You are playing a board card game. In this game the player has two characteristics, x and y \xe2\x80\x94 the white magic skill and the black magic skill, respectively. There are n spell cards lying on the table, each of them has four characteristics, ai, bi, ci and di. In one move a player can pick one of the cards and cast the spell written on it, but only if first two of it\'s characteristics meet the requirement ai\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x and bi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y, i.e. if the player has enough magic skill to cast this spell. However, after casting the spell the characteristics of a player change and become equal to x\xe2\x80\x89=\xe2\x80\x89ci and y\xe2\x80\x89=\xe2\x80\x89di.At the beginning of the game both characteristics of a player are equal to zero. The goal of the game is to cast the n-th spell. Your task is to make it in as few moves as possible. You are allowed to use spell in any order and any number of times (for example, you may not use some spells at all)." 2500
605C "Freelancer\'s Dreams" geometry "Mikhail the Freelancer dreams of two things: to become a cool programmer and to buy a flat in Moscow. To become a cool programmer, he needs at least p experience points, and a desired flat in Moscow costs q dollars. Mikhail is determined to follow his dreams and registered at a freelance site.He has suggestions to work on n distinct projects. Mikhail has already evaluated that the participation in the i-th project will increase his experience by ai per day and bring bi dollars per day. As freelance work implies flexible working hours, Mikhail is free to stop working on one project at any time and start working on another project. Doing so, he receives the respective share of experience and money. Mikhail is only trying to become a cool programmer, so he is able to work only on one project at any moment of time.Find the real value, equal to the minimum number of days Mikhail needs to make his dream come true.For example, suppose Mikhail is suggested to work on three projects and a1\xe2\x80\x89=\xe2\x80\x896, b1\xe2\x80\x89=\xe2\x80\x892, a2\xe2\x80\x89=\xe2\x80\x891, b2\xe2\x80\x89=\xe2\x80\x893, a3\xe2\x80\x89=\xe2\x80\x892, b3\xe2\x80\x89=\xe2\x80\x896. Also, p\xe2\x80\x89=\xe2\x80\x8920 and q\xe2\x80\x89=\xe2\x80\x8920. In order to achieve his aims Mikhail has to work for 2.5 days on both first and third projects. Indeed, a1\xc2\xb72.5\xe2\x80\x89+\xe2\x80\x89a2\xc2\xb70\xe2\x80\x89+\xe2\x80\x89a3\xc2\xb72.5\xe2\x80\x89=\xe2\x80\x896\xc2\xb72.5\xe2\x80\x89+\xe2\x80\x891\xc2\xb70\xe2\x80\x89+\xe2\x80\x892\xc2\xb72.5\xe2\x80\x89=\xe2\x80\x8920 and b1\xc2\xb72.5\xe2\x80\x89+\xe2\x80\x89b2\xc2\xb70\xe2\x80\x89+\xe2\x80\x89b3\xc2\xb72.5\xe2\x80\x89=\xe2\x80\x892\xc2\xb72.5\xe2\x80\x89+\xe2\x80\x893\xc2\xb70\xe2\x80\x89+\xe2\x80\x896\xc2\xb72.5\xe2\x80\x89=\xe2\x80\x8920." 2400
605B "Lazy Student" "constructive algorithms,data structures,graphs" "Student Vladislav came to his programming exam completely unprepared as usual. He got a question about some strange algorithm on a graph \xe2\x80\x94 something that will definitely never be useful in real life. He asked a girl sitting next to him to lend him some cheat papers for this questions and found there the following definition:The minimum spanning tree T of graph G is such a tree that it contains all the vertices of the original graph G, and the sum of the weights of its edges is the minimum possible among all such trees.Vladislav drew a graph with n vertices and m edges containing no loops and multiple edges. He found one of its minimum spanning trees and then wrote for each edge its weight and whether it is included in the found tree or not. Unfortunately, the piece of paper where the graph was painted is gone and the teacher is getting very angry and demands to see the original graph. Help Vladislav come up with a graph so that the information about the minimum spanning tree remains correct." 1700
605A "Sorting Railway Cars" "constructive algorithms,greedy" "An infinitely long railway has a train consisting of n cars, numbered from 1 to n (the numbers of all the cars are distinct) and positioned in arbitrary order. David Blaine wants to sort the railway cars in the order of increasing numbers. In one move he can make one of the cars disappear from its place and teleport it either to the beginning of the train, or to the end of the train, at his desire. What is the minimum number of actions David Blaine needs to perform in order to sort the train?" 1600
604B "More Cowbell" "binary search,greedy" "Kevin Sun wants to move his precious collection of n cowbells from Naperthrill to Exeter, where there is actually grass instead of corn. Before moving, he must pack his cowbells into k boxes of a fixed size. In order to keep his collection safe during transportation, he won\'t place more than two cowbells into a single box. Since Kevin wishes to minimize expenses, he is curious about the smallest size box he can use to pack his entire collection. Kevin is a meticulous cowbell collector and knows that the size of his i-th (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) cowbell is an integer si. In fact, he keeps his cowbells sorted by size, so si\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89si for any i\xe2\x80\x89>\xe2\x80\x891. Also an expert packer, Kevin can fit one or two cowbells into a box of size s if and only if the sum of their sizes does not exceed s. Given this information, help Kevin determine the smallest s for which it is possible to put all of his cowbells into k boxes of size s." 1400
604A "Uncowed Forces" implementation "Kevin Sun has just finished competing in Codeforces Round #334! The round was 120 minutes long and featured five problems with maximum point values of 500, 1000, 1500, 2000, and 2500, respectively. Despite the challenging tasks, Kevin was uncowed and bulldozed through all of them, distinguishing himself from the herd as the best cowmputer scientist in all of Bovinia. Kevin knows his submission time for each problem, the number of wrong submissions that he made on each problem, and his total numbers of successful and unsuccessful hacks. Because Codeforces scoring is complicated, Kevin wants you to write a program to compute his final score.Codeforces scores are computed as follows: If the maximum point value of a problem is x, and Kevin submitted correctly at minute m but made w wrong submissions, then his score on that problem is . His total score is equal to the sum of his scores for each problem. In addition, Kevin\'s total score gets increased by 100 points for each successful hack, but gets decreased by 50 points for each unsuccessful hack.All arithmetic operations are performed with absolute precision and no rounding. It is guaranteed that Kevin\'s final score is an integer." 1000
603E "Pastoral Oddities" "data structures,divide and conquer,dsu,math,trees" "In the land of Bovinia there are n pastures, but no paths connecting the pastures. Of course, this is a terrible situation, so Kevin Sun is planning to rectify it by constructing m undirected paths connecting pairs of distinct pastures. To make transportation more efficient, he also plans to pave some of these new paths.Kevin is very particular about certain aspects of path-paving. Since he loves odd numbers, he wants each pasture to have an odd number of paved paths connected to it. Thus we call a paving sunny if each pasture is incident to an odd number of paved paths. He also enjoys short paths more than long paths, so he would like the longest paved path to be as short as possible. After adding each path, Kevin wants to know if a sunny paving exists for the paths of Bovinia, and if at least one does, the minimum possible length of the longest path in such a paving. Note that ""longest path"" here means maximum-weight edge." 3000
603D "Ruminations on Ruminants" geometry,math "Kevin Sun is ruminating on the origin of cows while standing at the origin of the Cartesian plane. He notices n lines  on the plane, each representable by an equation of the form ax\xe2\x80\x89+\xe2\x80\x89by\xe2\x80\x89=\xe2\x80\x89c. He also observes that no two lines are parallel and that no three lines pass through the same point.For each triple (i,\xe2\x80\x89j,\xe2\x80\x89k) such that 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89j\xe2\x80\x89<\xe2\x80\x89k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n, Kevin considers the triangle formed by the three lines  . He calls a triangle original if the circumcircle of that triangle passes through the origin. Since Kevin believes that the circles of bovine life are tied directly to such triangles, he wants to know the number of original triangles formed by unordered triples of distinct lines. Recall that the circumcircle of a triangle is the circle which passes through all the vertices of that triangle." 2900
603C "Lieges of Legendre" games,math "Kevin and Nicky Sun have invented a new game called Lieges of Legendre. In this game, two players take turns modifying the game state with Kevin moving first. Initially, the game is set up so that there are n piles of cows, with the i-th pile containing ai cows. During each player\'s turn, that player calls upon the power of Sunlight, and uses it to either:  Remove a single cow from a chosen non-empty pile.  Choose a pile of cows with even size 2\xc2\xb7x (x\xe2\x80\x89>\xe2\x80\x890), and replace it with k piles of x cows each. The player who removes the last cow wins. Given n, k, and a sequence a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an, help Kevin and Nicky find the winner, given that both sides play in optimal way." 2200
603B "Moodular Arithmetic" "combinatorics,dfs and similar,dsu,math,number theory" "As behooves any intelligent schoolboy, Kevin Sun is studying psycowlogy, cowculus, and cryptcowgraphy at the Bovinia State University (BGU) under Farmer Ivan. During his Mathematics of Olympiads (MoO) class, Kevin was confronted with a weird functional equation and needs your help. For two fixed integers k and p, where p is an odd prime number, the functional equation states that  for some function . (This equation should hold for any integer x in the range 0 to p\xe2\x80\x89-\xe2\x80\x891, inclusive.)It turns out that f can actually be many different functions. Instead of finding a solution, Kevin wants you to count the number of distinct functions f that satisfy this equation. Since the answer may be very large, you should print your result modulo 109\xe2\x80\x89+\xe2\x80\x897." 1800
603A "Alternative Thinking" dp,greedy,math "Kevin has just recevied his disappointing results on the USA Identification of Cows Olympiad (USAICO) in the form of a binary string of length n. Each character of Kevin\'s string represents Kevin\'s score on one of the n questions of the olympiad\xe2\x80\x94\'1\' for a correctly identified cow and \'0\' otherwise.However, all is not lost. Kevin is a big proponent of alternative thinking and believes that his score, instead of being the sum of his points, should be the length of the longest alternating subsequence of his string. Here, we define an alternating subsequence of a string as a not-necessarily contiguous subsequence where no two consecutive elements are equal. For example, {0,\xe2\x80\x891,\xe2\x80\x890,\xe2\x80\x891}, {1,\xe2\x80\x890,\xe2\x80\x891}, and {1,\xe2\x80\x890,\xe2\x80\x891,\xe2\x80\x890} are alternating sequences, while {1,\xe2\x80\x890,\xe2\x80\x890} and {0,\xe2\x80\x891,\xe2\x80\x890,\xe2\x80\x891,\xe2\x80\x891} are not.Kevin, being the sneaky little puffball that he is, is willing to hack into the USAICO databases to improve his score. In order to be subtle, he decides that he will flip exactly one substring\xe2\x80\x94that is, take a contiguous non-empty substring of his score and change all \'0\'s in that substring to \'1\'s and vice versa. After such an operation, Kevin wants to know the length of the longest possible alternating subsequence that his string could have." 1600
602B "Approximating a Constant Range" "dp,implementation,two pointers" "When Xellos was doing a practice course in university, he once had to measure the intensity of an effect that slowly approached equilibrium. A good way to determine the equilibrium intensity would be choosing a sufficiently large number of consecutive data points that seems as constant as possible and taking their average. Of course, with the usual sizes of data, it\'s nothing challenging \xe2\x80\x94 but why not make a similar programming contest problem while we\'re at it?You\'re given a sequence of n data points a1,\xe2\x80\x89...,\xe2\x80\x89an. There aren\'t any big jumps between consecutive data points \xe2\x80\x94 for each 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89n, it\'s guaranteed that |ai\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89-\xe2\x80\x89ai|\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x891.A range [l,\xe2\x80\x89r] of data points is said to be almost constant if the difference between the largest and the smallest value in that range is at most 1. Formally, let M be the maximum and m the minimum value of ai for l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r; the range [l,\xe2\x80\x89r] is almost constant if M\xe2\x80\x89-\xe2\x80\x89m\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x891.Find the length of the longest almost constant range." 1400
602A "Two Bases" "brute force,implementation" "After seeing the ""ALL YOUR BASE ARE BELONG TO US"" meme for the first time, numbers X and Y realised that they have different bases, which complicated their relations.You\'re given a number X represented in base bx and a number Y represented in base by. Compare those two numbers." 1100
601E "A Museum Robbery" "data structures,dp" "There\'s a famous museum in the city where Kleof\xc3\xa1\xc5\xa1 lives. In the museum, n exhibits (numbered 1 through n) had been displayed for a long time; the i-th of those exhibits has value vi and mass wi. Then, the museum was bought by a large financial group and started to vary the exhibits. At about the same time, Kleof\xc3\xa1\xc5\xa1... gained interest in the museum, so to say.You should process q events of three types: type 1 \xe2\x80\x94 the museum displays an exhibit with value v and mass w; the exhibit displayed in the i-th event of this type is numbered n\xe2\x80\x89+\xe2\x80\x89i (see sample explanation for more details) type 2 \xe2\x80\x94 the museum removes the exhibit with number x and stores it safely in its vault type 3 \xe2\x80\x94 Kleof\xc3\xa1\xc5\xa1 visits the museum and wonders (for no important reason at all, of course): if there was a robbery and exhibits with total mass at most m were stolen, what would their maximum possible total value be?For each event of type 3, let s(m) be the maximum possible total value of stolen exhibits with total mass \xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m.Formally, let D be the set of numbers of all exhibits that are currently displayed (so initially D = {1, ..., n}). Let P(D) be the set of all subsets of D and let Then, s(m) is defined as Compute s(m) for each . Note that the output follows a special format." 2800
601D "Acyclic Organic Compounds" "data structures,dfs and similar,dsu,hashing,strings,trees" "You are given a tree T with n vertices (numbered 1 through n) and a letter in each vertex. The tree is rooted at vertex 1.Let\'s look at the subtree Tv of some vertex v. It is possible to read a string along each simple path starting at v and ending at some vertex in Tv (possibly v itself). Let\'s denote the number of distinct strings which can be read this way as . Also, there\'s a number cv assigned to each vertex v. We are interested in vertices with the maximum value of .You should compute two statistics: the maximum value of  and the number of vertices v with the maximum ." 2400
601C "Kleof\xc3\xa1\xc5\xa1 and the n-thlon" dp,math,probabilities "Kleof\xc3\xa1\xc5\xa1 is participating in an n-thlon - a tournament consisting of n different competitions in n different disciplines (numbered 1 through n). There are m participants in the n-thlon and each of them participates in all competitions.In each of these n competitions, the participants are given ranks from 1 to m in such a way that no two participants are given the same rank - in other words, the ranks in each competition form a permutation of numbers from 1 to m. The score of a participant in a competition is equal to his/her rank in it.The overall score of each participant is computed as the sum of that participant\'s scores in all competitions.The overall rank of each participant is equal to 1\xe2\x80\x89+\xe2\x80\x89k, where k is the number of participants with strictly smaller overall score.The n-thlon is over now, but the results haven\'t been published yet. Kleof\xc3\xa1\xc5\xa1 still remembers his ranks in each particular competition; however, he doesn\'t remember anything about how well the other participants did. Therefore, Kleof\xc3\xa1\xc5\xa1 would like to know his expected overall rank.All competitors are equally good at each discipline, so all rankings (permutations of ranks of everyone except Kleof\xc3\xa1\xc5\xa1) in each competition are equiprobable." 2300
601B "Lipshitz Sequence" "data structures,math" "A function  is called Lipschitz continuous if there is a real constant K such that the inequality |f(x)\xe2\x80\x89-\xe2\x80\x89f(y)|\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89K\xc2\xb7|x\xe2\x80\x89-\xe2\x80\x89y| holds for all . We\'ll deal with a more... discrete version of this term.For an array , we define it\'s Lipschitz constant  as follows:  if n\xe2\x80\x89<\xe2\x80\x892,   if n\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x892,  over all 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n In other words,  is the smallest non-negative integer such that |h[i]\xe2\x80\x89-\xe2\x80\x89h[j]|\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89L\xc2\xb7|i\xe2\x80\x89-\xe2\x80\x89j| holds for all 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i,\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n.You are given an array  of size n and q queries of the form [l,\xe2\x80\x89r]. For each query, consider the subarray ; determine the sum of Lipschitz constants of all subarrays of ." 2100
601A "The Two Routes" "graphs,shortest paths" "In Absurdistan, there are n towns (numbered 1 through n) and m bidirectional railways. There is also an absurdly simple road network \xe2\x80\x94 for each pair of different towns x and y, there is a bidirectional road between towns x and y if and only if there is no railway between them. Travelling to a different town using one railway or one road always takes exactly one hour.A train and a bus leave town 1 at the same time. They both have the same destination, town n, and don\'t make any stops on the way (but they can wait in town n). The train can move only along railways and the bus can move only along roads.You\'ve been asked to plan out routes for the vehicles; each route can use any road/railway multiple times. One of the most important aspects to consider is safety \xe2\x80\x94 in order to avoid accidents at railway crossings, the train and the bus must not arrive at the same town (except town n) simultaneously.Under these constraints, what is the minimum number of hours needed for both vehicles to reach town n (the maximum of arrival times of the bus and the train)? Note, that bus and train are not required to arrive to the town n at the same moment of time, but are allowed to do so." 1600
600F "Edge coloring of bipartite graph" graphs "You are given an undirected bipartite graph without multiple edges. You should paint the edges of graph to minimal number of colours, so that no two adjacent edges have the same colour." 2800
600E "Lomsat gelral" "data structures,dfs and similar,dsu,trees" "You are given a rooted tree with root in vertex 1. Each vertex is coloured in some colour.Let\'s call colour c dominating in the subtree of vertex v if there are no other colours that appear in the subtree of vertex v more times than colour c. So it\'s possible that two or more colours will be dominating in the subtree of some vertex.The subtree of vertex v is the vertex v and all other vertices that contains vertex v in each path to the root.For each vertex v find the sum of all dominating colours in the subtree of vertex v." 2300
600D "Area of Two Circles\' Intersection" geometry "You are given two circles. Find the area of their intersection." 2000
600C "Make Palindrome" "constructive algorithms,greedy,strings" "A string is called palindrome if it reads the same from left to right and from right to left. For example ""kazak"", ""oo"", ""r"" and ""mikhailrubinchikkihcniburliahkim"" are palindroms, but strings ""abb"" and ""ij"" are not.You are given string s consisting of lowercase Latin letters. At once you can choose any position in the string and change letter in that position to any other lowercase letter. So after each changing the length of the string doesn\'t change. At first you can change some letters in s. Then you can permute the order of letters as you want. Permutation doesn\'t count as changes. You should obtain palindrome with the minimal number of changes. If there are several ways to do that you should get the lexicographically (alphabetically) smallest palindrome. So firstly you should minimize the number of changes and then minimize the palindrome lexicographically." 1800
600B "Queries about less or equal elements" "binary search,data structures,sortings,two pointers" "You are given two arrays of integers a and b. For each element of the second array bj you should find the number of elements in array a that are less than or equal to the value bj." 1300
600A "Extract Numbers" implementation,strings "You are given string s. Let\'s call word any largest sequence of consecutive symbols without symbols \',\' (comma) and \';\' (semicolon). For example, there are four words in string ""aba,123;1a;0"": ""aba"", ""123"", ""1a"", ""0"". A word can be empty: for example, the string s="";;"" contains three empty words separated by \';\'.You should find all words in the given string that are nonnegative INTEGER numbers without leading zeroes and build by them new string a. String a should contain all words that are numbers separating them by \',\' (the order of numbers should remain the same as in the string s). By all other words you should build string b in the same way (the order of numbers should remain the same as in the string s).Here strings ""101"", ""0"" are INTEGER numbers, but ""01"" and ""1.0"" are not.For example, for the string aba,123;1a;0 the string a would be equal to ""123,0"" and string b would be equal to ""aba,1a""." 1600
599E "Sandy and Nuts" bitmasks,dp,trees "Rooted tree is a connected graph without any simple cycles with one vertex selected as a root. In this problem the vertex number 1 will always serve as a root.Lowest common ancestor of two vertices u and v is the farthest from the root vertex that lies on both the path from u to the root and on path from v to the root. We will denote it as LCA(u,\xe2\x80\x89v).Sandy had a rooted tree consisting of n vertices that she used to store her nuts. Unfortunately, the underwater storm broke her tree and she doesn\'t remember all it\'s edges. She only managed to restore m edges of the initial tree and q triples ai, bi and ci, for which she supposes LCA(ai,\xe2\x80\x89bi)\xe2\x80\x89=\xe2\x80\x89ci.Help Sandy count the number of trees of size n with vertex 1 as a root, that match all the information she remembered. If she made a mess and there are no such trees then print 0. Two rooted trees are considered to be distinct if there exists an edge that occur in one of them and doesn\'t occur in the other one." 2600
599D "Spongebob and Squares" "brute force,math" "Spongebob is already tired trying to reason his weird actions and calculations, so he simply asked you to find all pairs of n and m, such that there are exactly x distinct squares in the table consisting of n rows and m columns. For example, in a 3\xe2\x80\x89\xc3\x97\xe2\x80\x895 table there are 15 squares with side one, 8 squares with side two and 3 squares with side three. The total number of distinct squares in a 3\xe2\x80\x89\xc3\x97\xe2\x80\x895 table is 15\xe2\x80\x89+\xe2\x80\x898\xe2\x80\x89+\xe2\x80\x893\xe2\x80\x89=\xe2\x80\x8926." 1900
599C "Day at the Beach" sortings "One day Squidward, Spongebob and Patrick decided to go to the beach. Unfortunately, the weather was bad, so the friends were unable to ride waves. However, they decided to spent their time building sand castles.At the end of the day there were n castles built by friends. Castles are numbered from 1 to n, and the height of the i-th castle is equal to hi. When friends were about to leave, Squidward noticed, that castles are not ordered by their height, and this looks ugly. Now friends are going to reorder the castles in a way to obtain that condition hi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89hi\xe2\x80\x89+\xe2\x80\x891 holds for all i from 1 to n\xe2\x80\x89-\xe2\x80\x891.Squidward suggested the following process of sorting castles:   Castles are split into blocks \xe2\x80\x94 groups of consecutive castles. Therefore the block from i to j will include castles i,\xe2\x80\x89i\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89j. A block may consist of a single castle.  The partitioning is chosen in such a way that every castle is a part of exactly one block.  Each block is sorted independently from other blocks, that is the sequence hi,\xe2\x80\x89hi\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89hj becomes sorted.  The partitioning should satisfy the condition that after each block is sorted, the sequence hi becomes sorted too. This may always be achieved by saying that the whole sequence is a single block. Even Patrick understands that increasing the number of blocks in partitioning will ease the sorting process. Now friends ask you to count the maximum possible number of blocks in a partitioning that satisfies all the above requirements." 1600
599B "Spongebob and Joke" implementation "While Patrick was gone shopping, Spongebob decided to play a little trick on his friend. The naughty Sponge browsed through Patrick\'s personal stuff and found a sequence a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89am of length m, consisting of integers from 1 to n, not necessarily distinct. Then he picked some sequence f1,\xe2\x80\x89f2,\xe2\x80\x89...,\xe2\x80\x89fn of length n and for each number ai got number bi\xe2\x80\x89=\xe2\x80\x89fai. To finish the prank he erased the initial sequence ai.It\'s hard to express how sad Patrick was when he returned home from shopping! We will just say that Spongebob immediately got really sorry about what he has done and he is now trying to restore the original sequence. Help him do this or determine that this is impossible." 1500
599A "Patrick and Shopping" implementation "Today Patrick waits for a visit from his friend Spongebob. To prepare for the visit, Patrick needs to buy some goodies in two stores located near his house. There is a d1 meter long road between his house and the first shop and a d2 meter long road between his house and the second shop. Also, there is a road of length d3 directly connecting these two shops to each other. Help Patrick calculate the minimum distance that he needs to walk in order to go to both shops and return to his house.  Patrick always starts at his house. He should visit both shops moving only along the three existing roads and return back to his house. He doesn\'t mind visiting the same shop or passing the same road multiple times. The only goal is to minimize the total distance traveled." 800
598F "Cut Length" geometry "Given simple (without self-intersections) n-gon. It is not necessary convex. Also you are given m lines. For each line find the length of common part of the line and the n-gon.The boundary of n-gon belongs to polygon. It is possible that n-gon contains 180-degree angles." 2900
598E "Chocolate Bar" "brute force,dp" "You have a rectangular chocolate bar consisting of n\xe2\x80\x89\xc3\x97\xe2\x80\x89m single squares. You want to eat exactly k squares, so you may need to break the chocolate bar. In one move you can break any single rectangular piece of chocolate in two rectangular pieces. You can break only by lines between squares: horizontally or vertically. The cost of breaking is equal to square of the break length.For example, if you have a chocolate bar consisting of 2\xe2\x80\x89\xc3\x97\xe2\x80\x893 unit squares then you can break it horizontally and get two 1\xe2\x80\x89\xc3\x97\xe2\x80\x893 pieces (the cost of such breaking is 32\xe2\x80\x89=\xe2\x80\x899), or you can break it vertically in two ways and get two pieces: 2\xe2\x80\x89\xc3\x97\xe2\x80\x891 and 2\xe2\x80\x89\xc3\x97\xe2\x80\x892 (the cost of such breaking is 22\xe2\x80\x89=\xe2\x80\x894).For several given values n, m and k find the minimum total cost of breaking. You can eat exactly k squares of chocolate if after all operations of breaking there is a set of rectangular pieces of chocolate with the total size equal to k squares. The remaining n\xc2\xb7m\xe2\x80\x89-\xe2\x80\x89k squares are not necessarily form a single rectangular piece." 2000
598D "Igor In the Museum" "dfs and similar,graphs,shortest paths" "Igor is in the museum and he wants to see as many pictures as possible.Museum can be represented as a rectangular field of n\xe2\x80\x89\xc3\x97\xe2\x80\x89m cells. Each cell is either empty or impassable. Empty cells are marked with \'.\', impassable cells are marked with \'*\'. Every two adjacent cells of different types (one empty and one impassable) are divided by a wall containing one picture.At the beginning Igor is in some empty cell. At every moment he can move to any empty cell that share a side with the current one.For several starting positions you should calculate the maximum number of pictures that Igor can see. Igor is able to see the picture only if he is in the cell adjacent to the wall with this picture. Igor have a lot of time, so he will examine every picture he can see." 1700
598C "Nearest vectors" geometry,sortings "You are given the set of vectors on the plane, each of them starting at the origin. Your task is to find a pair of vectors with the minimal non-oriented angle between them.Non-oriented angle is non-negative value, minimal between clockwise and counterclockwise direction angles. Non-oriented angle is always between 0 and \xcf\x80. For example, opposite directions vectors have angle equals to \xcf\x80." 2300
598B "Queries on a String" implementation,strings "You are given a string s and should process m queries. Each query is described by two 1-based indices li, ri and integer ki. It means that you should cyclically shift the substring s[li... ri] ki times. The queries should be processed one after another in the order they are given.One operation of a cyclic shift (rotation) is equivalent to moving the last character to the position of the first character and shifting all other characters one position to the right.For example, if the string s is abacaba and the query is l1\xe2\x80\x89=\xe2\x80\x893,\xe2\x80\x89r1\xe2\x80\x89=\xe2\x80\x896,\xe2\x80\x89k1\xe2\x80\x89=\xe2\x80\x891 then the answer is abbacaa. If after that we would process the query l2\xe2\x80\x89=\xe2\x80\x891,\xe2\x80\x89r2\xe2\x80\x89=\xe2\x80\x894,\xe2\x80\x89k2\xe2\x80\x89=\xe2\x80\x892 then we would get the string baabcaa." 1300
598A "Tricky Sum" math "In this problem you are to calculate the sum of all integers from 1 to n, but you should take all powers of two with minus in the sum.For example, for n\xe2\x80\x89=\xe2\x80\x894 the sum is equal to \xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89-\xe2\x80\x892\xe2\x80\x89+\xe2\x80\x893\xe2\x80\x89-\xe2\x80\x894\xe2\x80\x89=\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x894, because 1, 2 and 4 are 20, 21 and 22 respectively.Calculate the answer for t values of n." 900
597C Subsequences "data structures,dp" "For the given sequence with n different elements find the number of increasing subsequences with k\xe2\x80\x89+\xe2\x80\x891 elements. It is guaranteed that the answer is not greater than 8\xc2\xb71018." 1900
597B Restaurant dp,greedy,sortings "A restaurant received n orders for the rental. Each rental order reserve the restaurant for a continuous period of time, the i-th order is characterized by two time values \xe2\x80\x94 the start time li and the finish time ri (li\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ri).Restaurant management can accept and reject orders. What is the maximal number of orders the restaurant can accept?No two accepted orders can intersect, i.e. they can\'t share even a moment of time. If one order ends in the moment other starts, they can\'t be accepted both." 1600
597A Divisibility math "Find the number of k-divisible numbers on the segment [a,\xe2\x80\x89b]. In other words you need to find the number of such integer values x that a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b and x is divisible by k." 1600
596E "Wilbur and Strings" "dfs and similar,dp,graphs,strings" "Wilbur the pig now wants to play with strings. He has found an n by m table consisting only of the digits from 0 to 9 where the rows are numbered 1 to n and the columns are numbered 1 to m. Wilbur starts at some square and makes certain moves. If he is at square (x, y) and the digit d (0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89d\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x899) is written at position (x, y), then he must move to the square (x\xe2\x80\x89+\xe2\x80\x89ad, y\xe2\x80\x89+\xe2\x80\x89bd), if that square lies within the table, and he stays in the square (x, y) otherwise. Before Wilbur makes a move, he can choose whether or not to write the digit written in this square on the white board. All digits written on the whiteboard form some string. Every time a new digit is written, it goes to the end of the current string.Wilbur has q strings that he is worried about. For each string si, Wilbur wants to know whether there exists a starting position (x, y) so that by making finitely many moves, Wilbur can end up with the string si written on the white board." 2500
596D "Wilbur and Trees" dp,math,probabilities,sortings "Wilbur the pig really wants to be a beaver, so he decided today to pretend he is a beaver and bite at trees to cut them down.There are n trees located at various positions on a line. Tree i is located at position xi. All the given positions of the trees are distinct.The trees are equal, i.e. each tree has height h. Due to the wind, when a tree is cut down, it either falls left with probability p, or falls right with probability 1\xe2\x80\x89-\xe2\x80\x89p. If a tree hits another tree while falling, that tree will fall in the same direction as the tree that hit it. A tree can hit another tree only if the distance between them is strictly less than h. For example, imagine there are 4 trees located at positions 1, 3, 5 and 8, while h\xe2\x80\x89=\xe2\x80\x893 and the tree at position 1 falls right. It hits the tree at position 3 and it starts to fall too. In it\'s turn it hits the tree at position 5 and it also starts to fall. The distance between 8 and 5 is exactly 3, so the tree at position 8 will not fall.As long as there are still trees standing, Wilbur will select either the leftmost standing tree with probability 0.5 or the rightmost standing tree with probability 0.5. Selected tree is then cut down. If there is only one tree remaining, Wilbur always selects it. As the ground is covered with grass, Wilbur wants to know the expected total length of the ground covered with fallen trees after he cuts them all down because he is concerned about his grass-eating cow friends. Please help Wilbur." 2300
596C "Wilbur and Points" combinatorics,greedy,sortings "Wilbur is playing with a set of n points on the coordinate plane. All points have non-negative integer coordinates. Moreover, if some point (x, y) belongs to the set, then all points (x\', y\'), such that 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\'\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x and 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y\'\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y also belong to this set.Now Wilbur wants to number the points in the set he has, that is assign them distinct integer numbers from 1 to n. In order to make the numbering aesthetically pleasing, Wilbur imposes the condition that if some point (x, y) gets number i, then all (x\',y\') from the set, such that x\'\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89x and y\'\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89y must be assigned a number not less than i. For example, for a set of four points (0, 0), (0, 1), (1, 0) and (1, 1), there are two aesthetically pleasing numberings. One is 1, 2, 3, 4 and another one is 1, 3, 2, 4.Wilbur\'s friend comes along and challenges Wilbur. For any point he defines it\'s special value as s(x,\xe2\x80\x89y)\xe2\x80\x89=\xe2\x80\x89y\xe2\x80\x89-\xe2\x80\x89x. Now he gives Wilbur some w1, w2,..., wn, and asks him to find an aesthetically pleasing numbering of the points in the set, such that the point that gets number i has it\'s special value equal to wi, that is s(xi,\xe2\x80\x89yi)\xe2\x80\x89=\xe2\x80\x89yi\xe2\x80\x89-\xe2\x80\x89xi\xe2\x80\x89=\xe2\x80\x89wi.Now Wilbur asks you to help him with this challenge." 1700
596B "Wilbur and Array" greedy,implementation "Wilbur the pig is tinkering with arrays again. He has the array a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an initially consisting of n zeros. At one step, he can choose any index i and either add 1 to all elements ai,\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89... ,\xe2\x80\x89an or subtract 1 from all elements ai,\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89an. His goal is to end up with the array b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bn. Of course, Wilbur wants to achieve this goal in the minimum number of steps and asks you to compute this value." 1100
596A "Wilbur and Swimming Pool" geometry,implementation "After making bad dives into swimming pools, Wilbur wants to build a swimming pool in the shape of a rectangle in his backyard. He has set up coordinate axes, and he wants the sides of the rectangle to be parallel to them. Of course, the area of the rectangle must be positive. Wilbur had all four vertices of the planned pool written on a paper, until his friend came along and erased some of the vertices.Now Wilbur is wondering, if the remaining n vertices of the initial rectangle give enough information to restore the area of the planned swimming pool." 1100
595B "Pasha and Phone" "binary search,math" "Pasha has recently bought a new phone jPager and started adding his friends\' phone numbers there. Each phone number consists of exactly n digits.Also Pasha has a number k and two sequences of length n\xe2\x80\x89/\xe2\x80\x89k (n is divisible by k) a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an\xe2\x80\x89/\xe2\x80\x89k and b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bn\xe2\x80\x89/\xe2\x80\x89k. Let\'s split the phone number into blocks of length k. The first block will be formed by digits from the phone number that are on positions 1, 2,..., k, the second block will be formed by digits from the phone number that are on positions k\xe2\x80\x89+\xe2\x80\x891, k\xe2\x80\x89+\xe2\x80\x892, ..., 2\xc2\xb7k and so on. Pasha considers a phone number good, if the i-th block doesn\'t start from the digit bi and is divisible by ai if represented as an integer. To represent the block of length k as an integer, let\'s write it out as a sequence c1, c2,...,ck. Then the integer is calculated as the result of the expression c1\xc2\xb710k\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x89c2\xc2\xb710k\xe2\x80\x89-\xe2\x80\x892\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89ck.Pasha asks you to calculate the number of good phone numbers of length n, for the given k, ai and bi. As this number can be too big, print it modulo 109\xe2\x80\x89+\xe2\x80\x897." 1600
595A "Vitaly and Night" "constructive algorithms,implementation" "One day Vitaly was going home late at night and wondering: how many people aren\'t sleeping at that moment? To estimate, Vitaly decided to look which windows are lit in the house he was passing by at that moment.Vitaly sees a building of n floors and 2\xc2\xb7m windows on each floor. On each floor there are m flats numbered from 1 to m, and two consecutive windows correspond to each flat. If we number the windows from 1 to 2\xc2\xb7m from left to right, then the j-th flat of the i-th floor has windows 2\xc2\xb7j\xe2\x80\x89-\xe2\x80\x891 and 2\xc2\xb7j in the corresponding row of windows (as usual, floors are enumerated from the bottom). Vitaly thinks that people in the flat aren\'t sleeping at that moment if at least one of the windows corresponding to this flat has lights on.Given the information about the windows of the given house, your task is to calculate the number of flats where, according to Vitaly, people aren\'t sleeping." 800
594E "Cutting the Line" "string suffix structures,strings" "You are given a non-empty line s and an integer k. The following operation is performed with this line exactly once:  A line is split into at most k non-empty substrings, i.e. string s is represented as a concatenation of a set of strings s\xe2\x80\x89=\xe2\x80\x89t1\xe2\x80\x89+\xe2\x80\x89t2\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89tm, 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k.  Some of strings ti are replaced by strings tir, that is, their record from right to left.  The lines are concatenated back in the same order, we get string s\'\xe2\x80\x89=\xe2\x80\x89t\'1t\'2... t\'m, where t\'i equals ti or tir. Your task is to determine the lexicographically smallest string that could be the result of applying the given operation to the string s." 3100
594D REQ "data structures,number theory" "Today on a math lesson the teacher told Vovochka that the Euler function of a positive integer \xcf\x86(n) is an arithmetic function that counts the positive integers less than or equal to n that are relatively prime to n. The number 1 is coprime to all the positive integers and \xcf\x86(1)\xe2\x80\x89=\xe2\x80\x891.Now the teacher gave Vovochka an array of n positive integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an and a task to process q queries li ri \xe2\x80\x94 to calculate and print  modulo 109\xe2\x80\x89+\xe2\x80\x897. As it is too hard for a second grade school student, you\'ve decided to help Vovochka." 2500
594C "Edo and Magnets" "brute force,greedy,implementation,two pointers" "Edo has got a collection of n refrigerator magnets!He decided to buy a refrigerator and hang the magnets on the door. The shop can make the refrigerator with any size of the door that meets the following restrictions: the refrigerator door must be rectangle, and both the length and the width of the door must be positive integers.Edo figured out how he wants to place the magnets on the refrigerator. He introduced a system of coordinates on the plane, where each magnet is represented as a rectangle with sides parallel to the coordinate axes.Now he wants to remove no more than k magnets (he may choose to keep all of them) and attach all remaining magnets to the refrigerator door, and the area of \xe2\x80\x8b\xe2\x80\x8bthe door should be as small as possible. A magnet is considered to be attached to the refrigerator door if its center lies on the door or on its boundary. The relative positions of all the remaining magnets must correspond to the plan.Let us explain the last two sentences. Let\'s suppose we want to hang two magnets on the refrigerator. If the magnet in the plan has coordinates of the lower left corner (x1, y1) and the upper right corner (x2, y2), then its center is located at (, ) (may not be integers). By saying the relative position should correspond to the plan we mean that the only available operation is translation, i.e. the vector connecting the centers of two magnets in the original plan, must be equal to the vector connecting the centers of these two magnets on the refrigerator.The sides of the refrigerator door must also be parallel to coordinate axes." 2300
594B "Max and Bike" "binary search,geometry" "For months Maxim has been coming to work on his favorite bicycle. And quite recently he decided that he is ready to take part in a cyclists\' competitions.He knows that this year n competitions will take place. During the i-th competition the participant must as quickly as possible complete a ride along a straight line from point si to point fi (si\xe2\x80\x89<\xe2\x80\x89fi).Measuring time is a complex process related to usage of a special sensor and a time counter. Think of the front wheel of a bicycle as a circle of radius r. Let\'s neglect the thickness of a tire, the size of the sensor, and all physical effects. The sensor is placed on the rim of the wheel, that is, on some fixed point on a circle of radius r. After that the counter moves just like the chosen point of the circle, i.e. moves forward and rotates around the center of the circle.At the beginning each participant can choose any point bi, such that his bike is fully behind the starting line, that is, bi\xe2\x80\x89<\xe2\x80\x89si\xe2\x80\x89-\xe2\x80\x89r. After that, he starts the movement, instantly accelerates to his maximum speed and at time tsi, when the coordinate of the sensor is equal to the coordinate of the start, the time counter starts. The cyclist makes a complete ride, moving with his maximum speed and at the moment the sensor\'s coordinate is equal to the coordinate of the finish (moment of time tfi), the time counter deactivates and records the final time. Thus, the counter records that the participant made a complete ride in time tfi\xe2\x80\x89-\xe2\x80\x89tsi.  Maxim is good at math and he suspects that the total result doesn\'t only depend on his maximum speed v, but also on his choice of the initial point bi. Now Maxim is asking you to calculate for each of n competitions the minimum possible time that can be measured by the time counter. The radius of the wheel of his bike is equal to r." 2500
594A "Warrior and Archer" games "In the official contest this problem has a different statement, for which jury\'s solution was working incorrectly, and for this reason it was excluded from the contest. This mistake have been fixed and the current given problem statement and model solution corresponds to what jury wanted it to be during the contest.Vova and Lesha are friends. They often meet at Vova\'s place and compete against each other in a computer game named The Ancient Papyri: Swordsink. Vova always chooses a warrior as his fighter and Leshac chooses an archer. After that they should choose initial positions for their characters and start the fight. A warrior is good at melee combat, so Vova will try to make the distance between fighters as small as possible. An archer prefers to keep the enemy at a distance, so Lesha will try to make the initial distance as large as possible.There are n (n is always even) possible starting positions for characters marked along the Ox axis. The positions are given by their distinct coordinates x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xn, two characters cannot end up at the same position.Vova and Lesha take turns banning available positions, Vova moves first. During each turn one of the guys bans exactly one of the remaining positions. Banned positions cannot be used by both Vova and Lesha. They continue to make moves until there are only two possible positions remaining (thus, the total number of moves will be n\xe2\x80\x89-\xe2\x80\x892). After that Vova\'s character takes the position with the lesser coordinate and Lesha\'s character takes the position with the bigger coordinate and the guys start fighting.Vova and Lesha are already tired by the game of choosing positions, as they need to play it before every fight, so they asked you (the developer of the The Ancient Papyri: Swordsink) to write a module that would automatically determine the distance at which the warrior and the archer will start fighting if both Vova and Lesha play optimally." 2300
593E "Strange Calculation and Cats" dp,matrices "Gosha\'s universe is a table consisting of n rows and m columns. Both the rows and columns are numbered with consecutive integers starting with 1. We will use (r,\xe2\x80\x89c) to denote a cell located in the row r and column c.Gosha is often invited somewhere. Every time he gets an invitation, he first calculates the number of ways to get to this place, and only then he goes. Gosha\'s house is located in the cell (1,\xe2\x80\x891).At any moment of time, Gosha moves from the cell he is currently located in to a cell adjacent to it (two cells are adjacent if they share a common side). Of course, the movement is possible only if such a cell exists, i.e. Gosha will not go beyond the boundaries of the table. Thus, from the cell (r,\xe2\x80\x89c) he is able to make a move to one of the cells (r\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89c), (r,\xe2\x80\x89c\xe2\x80\x89-\xe2\x80\x891), (r\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89c), (r,\xe2\x80\x89c\xe2\x80\x89+\xe2\x80\x891). Also, Ghosha can skip a move and stay in the current cell (r,\xe2\x80\x89c).Besides the love of strange calculations, Gosha is allergic to cats, so he never goes to the cell that has a cat in it. Gosha knows exactly where and when he will be invited and the schedule of cats travelling along the table. Formally, he has q records, the i-th of them has one of the following forms:   1, xi, yi, ti \xe2\x80\x94 Gosha is invited to come to cell (xi,\xe2\x80\x89yi) at the moment of time ti. It is guaranteed that there is no cat inside cell (xi,\xe2\x80\x89yi) at this moment of time.  2, xi, yi, ti \xe2\x80\x94 at the moment ti a cat appears in cell (xi,\xe2\x80\x89yi). It is guaranteed that no other cat is located in this cell (xi,\xe2\x80\x89yi) at that moment of time.  3, xi, yi, ti \xe2\x80\x94 at the moment ti a cat leaves cell (xi,\xe2\x80\x89yi). It is guaranteed that there is cat located in the cell (xi,\xe2\x80\x89yi). Gosha plans to accept only one invitation, but he has not yet decided, which particular one. In order to make this decision, he asks you to calculate for each of the invitations i the number of ways to get to the cell (xi,\xe2\x80\x89yi) at the moment ti. For every invitation, assume that Gosha he starts moving from cell (1,\xe2\x80\x891) at the moment 1.Moving between two neighboring cells takes Gosha exactly one unit of tim. In particular, this means that Gosha can come into the cell only if a cat sitting in it leaves the moment when Gosha begins his movement from the neighboring cell, and if none of the cats comes to the cell at the time when Gosha is in it.Two ways to go from cell (1,\xe2\x80\x891) to cell (x,\xe2\x80\x89y) at time t are considered distinct if for at least one moment of time from 1 to t Gosha\'s positions are distinct for the two ways at this moment. Note, that during this travel Gosha is allowed to visit both (1,\xe2\x80\x891) and (x,\xe2\x80\x89y) multiple times. Since the number of ways can be quite large, print it modulo 109\xe2\x80\x89+\xe2\x80\x897." 2400
593D "Happy Tree Party" "data structures,dfs and similar,graphs,math,trees" "Bogdan has a birthday today and mom gave him a tree consisting of n vertecies. For every edge of the tree i, some number xi was written on it. In case you forget, a tree is a connected non-directed graph without cycles. After the present was granted, m guests consecutively come to Bogdan\'s party. When the i-th guest comes, he performs exactly one of the two possible operations:   Chooses some number yi, and two vertecies ai and bi. After that, he moves along the edges of the tree from vertex ai to vertex bi using the shortest path (of course, such a path is unique in the tree). Every time he moves along some edge j, he replaces his current number yi by , that is, by the result of integer division yi div xj.  Chooses some edge pi and replaces the value written in it xpi by some positive integer ci\xe2\x80\x89<\xe2\x80\x89xpi. As Bogdan cares about his guests, he decided to ease the process. Write a program that performs all the operations requested by guests and outputs the resulting value yi for each i of the first type." 2400
593C "Beautiful Function" "constructive algorithms,math" "Every day Ruslan tried to count sheep to fall asleep, but this didn\'t help. Now he has found a more interesting thing to do. First, he thinks of some set of circles on a plane, and then tries to choose a beautiful set of points, such that there is at least one point from the set inside or on the border of each of the imagined circles.Yesterday Ruslan tried to solve this problem for the case when the set of points is considered beautiful if it is given as (xt\xe2\x80\x89=\xe2\x80\x89f(t),\xe2\x80\x89yt\xe2\x80\x89=\xe2\x80\x89g(t)), where argument t takes all integer values from 0 to 50. Moreover, f(t) and g(t) should be correct functions.Assume that w(t) and h(t) are some correct functions, and c is an integer ranging from 0 to 50. The function s(t) is correct if it\'s obtained by one of the following rules:  s(t)\xe2\x80\x89=\xe2\x80\x89abs(w(t)), where abs(x) means taking the absolute value of a number x, i.e. |x|; s(t)\xe2\x80\x89=\xe2\x80\x89(w(t)\xe2\x80\x89+\xe2\x80\x89h(t)); s(t)\xe2\x80\x89=\xe2\x80\x89(w(t)\xe2\x80\x89-\xe2\x80\x89h(t)); s(t)\xe2\x80\x89=\xe2\x80\x89(w(t)\xe2\x80\x89*\xe2\x80\x89h(t)), where \xe2\x80\x89*\xe2\x80\x89 means multiplication, i.e. (w(t)\xc2\xb7h(t)); s(t)\xe2\x80\x89=\xe2\x80\x89c; s(t)\xe2\x80\x89=\xe2\x80\x89t;Yesterday Ruslan thought on and on, but he could not cope with the task. Now he asks you to write a program that computes the appropriate f(t) and g(t) for any set of at most 50 circles.In each of the functions f(t) and g(t) you are allowed to use no more than 50 multiplications. The length of any function should not exceed 100\xc2\xb7n characters. The function should not contain spaces.Ruslan can\'t keep big numbers in his memory, so you should choose f(t) and g(t), such that for all integer t from 0 to 50 value of f(t) and g(t) and all the intermediate calculations won\'t exceed 109 by their absolute value." 2200
593B "Anton and Lines" geometry,sortings "The teacher gave Anton a large geometry homework, but he didn\'t do it (as usual) as he participated in a regular round on Codeforces. In the task he was given a set of n lines defined by the equations y\xe2\x80\x89=\xe2\x80\x89ki\xc2\xb7x\xe2\x80\x89+\xe2\x80\x89bi. It was necessary to determine whether there is at least one point of intersection of two of these lines, that lays strictly inside the strip between x1\xe2\x80\x89<\xe2\x80\x89x2. In other words, is it true that there are 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n and x\',\xe2\x80\x89y\', such that:   y\'\xe2\x80\x89=\xe2\x80\x89ki\xe2\x80\x89*\xe2\x80\x89x\'\xe2\x80\x89+\xe2\x80\x89bi, that is, point (x\',\xe2\x80\x89y\') belongs to the line number i;  y\'\xe2\x80\x89=\xe2\x80\x89kj\xe2\x80\x89*\xe2\x80\x89x\'\xe2\x80\x89+\xe2\x80\x89bj, that is, point (x\',\xe2\x80\x89y\') belongs to the line number j;  x1\xe2\x80\x89<\xe2\x80\x89x\'\xe2\x80\x89<\xe2\x80\x89x2, that is, point (x\',\xe2\x80\x89y\') lies inside the strip bounded by x1\xe2\x80\x89<\xe2\x80\x89x2. You can\'t leave Anton in trouble, can you? Write a program that solves the given task." 1600
593A 2Char "brute force,implementation" "Andrew often reads articles in his favorite magazine 2Char. The main feature of these articles is that each of them uses at most two distinct letters. Andrew decided to send an article to the magazine, but as he hasn\'t written any article, he just decided to take a random one from magazine 26Char. However, before sending it to the magazine 2Char, he needs to adapt the text to the format of the journal. To do so, he removes some words from the chosen article, in such a way that the remaining text can be written using no more than two distinct letters.Since the payment depends from the number of non-space characters in the article, Andrew wants to keep the words with the maximum total length." 1200
592E BCPC "binary search,geometry,two pointers" "BCPC stands for Byteforces Collegiate Programming Contest, and is the most famous competition in Byteforces.BCPC is a team competition. Each team is composed by a coach and three contestants. Blenda is the coach of the Bit State University(BSU), and she is very strict selecting the members of her team.  In BSU there are n students numbered from 1 to n. Since all BSU students are infinitely smart, the only important parameters for Blenda are their reading and writing speed. After a careful measuring, Blenda have found that the i-th student have a reading speed equal to ri (words per minute), and a writing speed of wi (symbols per minute). Since BSU students are very smart, the measured speeds are sometimes very big and Blenda have decided to subtract some constant value c from all the values of reading speed and some value d from all the values of writing speed. Therefore she considers ri\'\xe2\x80\x89=\xe2\x80\x89ri\xe2\x80\x89-\xe2\x80\x89c and wi\'\xe2\x80\x89=\xe2\x80\x89wi\xe2\x80\x89-\xe2\x80\x89d. The student i is said to overwhelm the student j if and only if ri\'\xc2\xb7wj\'\xe2\x80\x89>\xe2\x80\x89rj\'\xc2\xb7wi\'. Blenda doesn\xe2\x80\x99t like fights in teams, so she thinks that a team consisting of three distinct students i,\xe2\x80\x89j and k is good if i overwhelms j, j overwhelms k, and k overwhelms i. Yes, the relation of overwhelming is not transitive as it often happens in real life.Since Blenda is busy preparing a training camp in Codeforces, you are given a task to calculate the number of different good teams in BSU. Two teams are considered to be different if there is at least one student that is present in one team but is not present in the other. In other words, two teams are different if the sets of students that form these teams are different." 2700
592D "Super M" "dfs and similar,dp,graphs,trees" "Ari the monster is not an ordinary monster. She is the hidden identity of Super M, the Byteforces\xe2\x80\x99 superhero. Byteforces is a country that consists of n cities, connected by n\xe2\x80\x89-\xe2\x80\x891 bidirectional roads. Every road connects exactly two distinct cities, and the whole road system is designed in a way that one is able to go from any city to any other city using only the given roads. There are m cities being attacked by humans. So Ari... we meant Super M have to immediately go to each of the cities being attacked to scare those bad humans. Super M can pass from one city to another only using the given roads. Moreover, passing through one road takes her exactly one kron - the time unit used in Byteforces.   However, Super M is not on Byteforces now - she is attending a training camp located in a nearby country Codeforces. Fortunately, there is a special device in Codeforces that allows her to instantly teleport from Codeforces to any city of Byteforces. The way back is too long, so for the purpose of this problem teleportation is used exactly once.You are to help Super M, by calculating the city in which she should teleport at the beginning in order to end her job in the minimum time (measured in krons). Also, provide her with this time so she can plan her way back to Codeforces." 2200
592C "The Big Race" math "Vector Willman and Array Bolt are the two most famous athletes of Byteforces. They are going to compete in a race with a distance of L meters today.  Willman and Bolt have exactly the same speed, so when they compete the result is always a tie. That is a problem for the organizers because they want a winner. While watching previous races the organizers have noticed that Willman can perform only steps of length equal to w meters, and Bolt can perform only steps of length equal to b meters. Organizers decided to slightly change the rules of the race. Now, at the end of the racetrack there will be an abyss, and the winner will be declared the athlete, who manages to run farther from the starting point of the the racetrack (which is not the subject to change by any of the athletes). Note that none of the athletes can run infinitely far, as they both will at some moment of time face the point, such that only one step further will cause them to fall in the abyss. In other words, the athlete will not fall into the abyss if the total length of all his steps will be less or equal to the chosen distance L.Since the organizers are very fair, the are going to set the length of the racetrack as an integer chosen randomly and uniformly in range from 1 to t (both are included). What is the probability that Willman and Bolt tie again today?" 1800
592B "The Monster and the Squirrel" math "Ari the monster always wakes up very early with the first ray of the sun and the first thing she does is feeding her squirrel.Ari draws a regular convex polygon on the floor and numbers it\'s vertices 1,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89n in clockwise order. Then starting from the vertex 1 she draws a ray in the direction of each other vertex. The ray stops when it reaches a vertex or intersects with another ray drawn before. Ari repeats this process for vertex 2,\xe2\x80\x893,\xe2\x80\x89...,\xe2\x80\x89n (in this particular order). And then she puts a walnut in each region inside the polygon.  Ada the squirrel wants to collect all the walnuts, but she is not allowed to step on the lines drawn by Ari. That means Ada have to perform a small jump if she wants to go from one region to another. Ada can jump from one region P to another region Q if and only if P and Q share a side or a corner.Assuming that Ada starts from outside of the picture, what is the minimum number of jumps she has to perform in order to collect all the walnuts?" 1100
592A PawnChess implementation "Galois is one of the strongest chess players of Byteforces. He has even invented a new variant of chess, which he named \xc2\xabPawnChess\xc2\xbb.This new game is played on a board consisting of 8 rows and 8 columns. At the beginning of every game some black and white pawns are placed on the board. The number of black pawns placed is not necessarily equal to the number of white pawns placed.   Lets enumerate rows and columns with integers from 1 to 8. Rows are numbered from top to bottom, while columns are numbered from left to right. Now we denote as (r,\xe2\x80\x89c) the cell located at the row r and at the column c.There are always two players A and B playing the game. Player A plays with white pawns, while player B plays with black ones. The goal of player A is to put any of his pawns to the row 1, while player B tries to put any of his pawns to the row 8. As soon as any of the players completes his goal the game finishes immediately and the succeeded player is declared a winner.Player A moves first and then they alternate turns. On his move player A must choose exactly one white pawn and move it one step upward and player B (at his turn) must choose exactly one black pawn and move it one step down. Any move is possible only if the targeted cell is empty. It\'s guaranteed that for any scenario of the game there will always be at least one move available for any of the players.Moving upward means that the pawn located in (r,\xe2\x80\x89c) will go to the cell (r\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89c), while moving down means the pawn located in (r,\xe2\x80\x89c) will go to the cell (r\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89c). Again, the corresponding cell must be empty, i.e. not occupied by any other pawn of any color.Given the initial disposition of the board, determine who wins the game if both players play optimally. Note that there will always be a winner due to the restriction that for any game scenario both players will have some moves available." 1200
591B Rebranding implementation,strings "The name of one small but proud corporation consists of n lowercase English letters. The Corporation has decided to try rebranding \xe2\x80\x94 an active marketing strategy, that includes a set of measures to change either the brand (both for the company and the goods it produces) or its components: the name, the logo, the slogan. They decided to start with the name.For this purpose the corporation has consecutively hired m designers. Once a company hires the i-th designer, he immediately contributes to the creation of a new corporation name as follows: he takes the newest version of the name and replaces all the letters xi by yi, and all the letters yi by xi. This results in the new version. It is possible that some of these letters do no occur in the string. It may also happen that xi coincides with yi. The version of the name received after the work of the last designer becomes the new name of the corporation.Manager Arkady has recently got a job in this company, but is already soaked in the spirit of teamwork and is very worried about the success of the rebranding. Naturally, he can\'t wait to find out what is the new name the Corporation will receive.Satisfy Arkady\'s curiosity and tell him the final version of the name." 1200
591A "Wizards\' Duel" implementation,math "Harry Potter and He-Who-Must-Not-Be-Named engaged in a fight to the death once again. This time they are located at opposite ends of the corridor of length l. Two opponents simultaneously charge a deadly spell in the enemy. We know that the impulse of Harry\'s magic spell flies at a speed of p meters per second, and the impulse of You-Know-Who\'s magic spell flies at a speed of q meters per second.The impulses are moving through the corridor toward each other, and at the time of the collision they turn round and fly back to those who cast them without changing their original speeds. Then, as soon as the impulse gets back to it\'s caster, the wizard reflects it and sends again towards the enemy, without changing the original speed of the impulse.Since Harry has perfectly mastered the basics of magic, he knows that after the second collision both impulses will disappear, and a powerful explosion will occur exactly in the place of their collision. However, the young wizard isn\'t good at math, so he asks you to calculate the distance from his position to the place of the second meeting of the spell impulses, provided that the opponents do not change positions during the whole fight." 900
590E Birthday "graph matchings,strings" "Today is birthday of a Little Dasha \xe2\x80\x94 she is now 8 years old! On this occasion, each of her n friends and relatives gave her a ribbon with a greeting written on it, and, as it turned out, all the greetings are different. Dasha gathered all the ribbons and decided to throw away some of them in order to make the remaining set stylish. The birthday girl considers a set of ribbons stylish if no greeting written on some ribbon is a substring of another greeting written on some other ribbon. Let us recall that the substring of the string s is a continuous segment of s.Help Dasha to keep as many ribbons as possible, so that she could brag about them to all of her friends. Dasha cannot rotate or flip ribbons, that is, each greeting can be read in a single way given in the input." 3200
590D "Top Secret Task" dp "A top-secret military base under the command of Colonel Zuev is expecting an inspection from the Ministry of Defence. According to the charter, each top-secret military base must include a top-secret troop that should... well, we cannot tell you exactly what it should do, it is a top secret troop at the end. The problem is that Zuev\'s base is missing this top-secret troop for some reasons.The colonel decided to deal with the problem immediately and ordered to line up in a single line all n soldiers of the base entrusted to him. Zuev knows that the loquacity of the i-th soldier from the left is equal to qi. Zuev wants to form the top-secret troop using k leftmost soldiers in the line, thus he wants their total loquacity to be as small as possible (as the troop should remain top-secret). To achieve this, he is going to choose a pair of consecutive soldiers and swap them. He intends to do so no more than s times. Note that any soldier can be a participant of such swaps for any number of times. The problem turned out to be unusual, and colonel Zuev asked you to help.Determine, what is the minimum total loquacity of the first k soldiers in the line, that can be achieved by performing no more than s swaps of two consecutive soldiers." 2300
590C "Three States" "dfs and similar,graphs,shortest paths" "The famous global economic crisis is approaching rapidly, so the states of Berman, Berance and Bertaly formed an alliance and allowed the residents of all member states to freely pass through the territory of any of them. In addition, it was decided that a road between the states should be built to guarantee so that one could any point of any country can be reached from any point of any other State.Since roads are always expensive, the governments of the states of the newly formed alliance asked you to help them assess the costs. To do this, you have been issued a map that can be represented as a rectangle table consisting of n rows and m columns. Any cell of the map either belongs to one of three states, or is an area where it is allowed to build a road, or is an area where the construction of the road is not allowed. A cell is called passable, if it belongs to one of the states, or the road was built in this cell. From any passable cells you can move up, down, right and left, if the cell that corresponds to the movement exists and is passable.Your task is to construct a road inside a minimum number of cells, so that it would be possible to get from any cell of any state to any cell of any other state using only passable cells.It is guaranteed that initially it is possible to reach any cell of any state from any cell of this state, moving only along its cells. It is also guaranteed that for any state there is at least one cell that belongs to it." 2200
590B "Chip \'n Dale Rescue Rangers" "binary search,geometry,math" "A team of furry rescue rangers was sitting idle in their hollow tree when suddenly they received a signal of distress. In a few moments they were ready, and the dirigible of the rescue chipmunks hit the road.We assume that the action takes place on a Cartesian plane. The headquarters of the rescuers is located at point (x1,\xe2\x80\x89y1), and the distress signal came from the point (x2,\xe2\x80\x89y2).Due to Gadget\'s engineering talent, the rescuers\' dirigible can instantly change its current velocity and direction of movement at any moment and as many times as needed. The only limitation is: the speed of the aircraft relative to the air can not exceed  meters per second.Of course, Gadget is a true rescuer and wants to reach the destination as soon as possible. The matter is complicated by the fact that the wind is blowing in the air and it affects the movement of the dirigible. According to the weather forecast, the wind will be defined by the vector (vx,\xe2\x80\x89vy) for the nearest t seconds, and then will change to (wx,\xe2\x80\x89wy). These vectors give both the direction and velocity of the wind. Formally, if a dirigible is located at the point (x,\xe2\x80\x89y), while its own velocity relative to the air is equal to zero and the wind (ux,\xe2\x80\x89uy) is blowing, then after  seconds the new position of the dirigible will be .Gadget is busy piloting the aircraft, so she asked Chip to calculate how long will it take them to reach the destination if they fly optimally. He coped with the task easily, but Dale is convinced that Chip has given the random value, aiming only not to lose the face in front of Gadget. Dale has asked you to find the right answer.It is guaranteed that the speed of the wind at any moment of time is strictly less than the maximum possible speed of the airship relative to the air." 2100
590A "Median Smoothing" implementation "A schoolboy named Vasya loves reading books on programming and mathematics. He has recently read an encyclopedia article that described the method of median smoothing (or median filter) and its many applications in science and engineering. Vasya liked the idea of the method very much, and he decided to try it in practice.Applying the simplest variant of median smoothing to the sequence of numbers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an will result a new sequence b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bn obtained by the following algorithm:  b1\xe2\x80\x89=\xe2\x80\x89a1, bn\xe2\x80\x89=\xe2\x80\x89an, that is, the first and the last number of the new sequence match the corresponding numbers of the original sequence.  For i\xe2\x80\x89=\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x891 value bi is equal to the median of three values ai\xe2\x80\x89-\xe2\x80\x891, ai and ai\xe2\x80\x89+\xe2\x80\x891. The median of a set of three numbers is the number that goes on the second place, when these three numbers are written in the non-decreasing order. For example, the median of the set 5, 1, 2 is number 2, and the median of set 1, 0, 1 is equal to 1.In order to make the task easier, Vasya decided to apply the method to sequences consisting of zeros and ones only.Having made the procedure once, Vasya looked at the resulting sequence and thought: what if I apply the algorithm to it once again, and then apply it to the next result, and so on? Vasya tried a couple of examples and found out that after some number of median smoothing algorithm applications the sequence can stop changing. We say that the sequence is stable, if it does not change when the median smoothing is applied to it.Now Vasya wonders, whether the sequence always eventually becomes stable. He asks you to write a program that, given a sequence of zeros and ones, will determine whether it ever becomes stable. Moreover, if it ever becomes stable, then you should determine what will it look like and how many times one needs to apply the median smoothing algorithm to initial sequence in order to obtain a stable one." 1700
588B "Duff in Love" math "Duff is in love with lovely numbers! A positive integer x is called lovely if and only if there is no such positive integer a\xe2\x80\x89>\xe2\x80\x891 such that a2 is a divisor of x.  Malek has a number store! In his store, he has only divisors of positive integer n (and he has all of them). As a birthday present, Malek wants to give her a lovely number from his store. He wants this number to be as big as possible.Malek always had issues in math, so he asked for your help. Please tell him what is the biggest lovely number in his store." 1300
588A "Duff and Meat" greedy "Duff is addicted to meat! Malek wants to keep her happy for n days. In order to be happy in i-th day, she needs to eat exactly ai kilograms of meat.  There is a big shop uptown and Malek wants to buy meat for her from there. In i-th day, they sell meat for pi dollars per kilogram. Malek knows all numbers a1,\xe2\x80\x89...,\xe2\x80\x89an and p1,\xe2\x80\x89...,\xe2\x80\x89pn. In each day, he can buy arbitrary amount of meat, also he can keep some meat he has for the future.Malek is a little tired from cooking meat, so he asked for your help. Help him to minimize the total money he spends to keep Duff happy for n days." 900
587F "Duff is Mad" "data structures,strings" "Duff is mad at her friends. That\'s why she sometimes makes Malek to take candy from one of her friends for no reason!  She has n friends. Her i-th friend\'s name is si (their names are not necessarily unique). q times, she asks Malek to take candy from her friends. She\'s angry, but also she acts with rules. When she wants to ask Malek to take candy from one of her friends, like k, she chooses two numbers l and r and tells Malek to take exactly  candies from him/her, where occur(t,\xe2\x80\x89s) is the number of occurrences of string t in s.Malek is not able to calculate how many candies to take in each request from Duff. That\'s why she asked for your help. Please tell him how many candies to take in each request." 3000
587E "Duff as a Queen" "data structures" "Duff is the queen of her country, Andarz Gu. She\'s a competitive programming fan. That\'s why, when he saw her minister, Malek, free, she gave her a sequence consisting of n non-negative integers, a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an and asked him to perform q queries for her on this sequence.  There are two types of queries:  given numbers l,\xe2\x80\x89r and k, Malek should perform  for each l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r (, bitwise exclusive OR of numbers a and b).  given numbers l and r Malek should tell her the score of sequence al,\xe2\x80\x89al\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89... ,\xe2\x80\x89ar. Score of a sequence b1,\xe2\x80\x89...,\xe2\x80\x89bk is the number of its different Kheshtaks. A non-negative integer w is a Kheshtak of this sequence if and only if there exists a subsequence of b, let\'s denote it as bi1,\xe2\x80\x89bi2,\xe2\x80\x89... ,\xe2\x80\x89bix (possibly empty) such that  (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i1\xe2\x80\x89<\xe2\x80\x89i2\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89ix\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k). If this subsequence is empty, then w\xe2\x80\x89=\xe2\x80\x890.Unlike Duff, Malek is not a programmer. That\'s why he asked for your help. Please help him perform these queries." 2900
587D "Duff in Mafia" "2-sat,binary search" "Duff is one if the heads of Mafia in her country, Andarz Gu. Andarz Gu has n cities (numbered from 1 to n) connected by m bidirectional roads (numbered by 1 to m).Each road has a destructing time, and a color. i-th road connects cities vi and ui and its color is ci and its destructing time is ti.Mafia wants to destruct a matching in Andarz Gu. A matching is a subset of roads such that no two roads in this subset has common endpoint. They can destruct these roads in parallel, i. e. the total destruction time is a maximum over destruction times of all selected roads.  They want two conditions to be satisfied:  The remaining roads form a proper coloring.  Destructing time of this matching is minimized. The remaining roads after destructing this matching form a proper coloring if and only if no two roads of the same color have same endpoint, or, in the other words, edges of each color should form a matching.There is no programmer in Mafia. That\'s why Duff asked for your help. Please help her and determine which matching to destruct in order to satisfied those conditions (or state that this is not possible)." 3100
587C "Duff in the Army" "data structures,trees" "Recently Duff has been a soldier in the army. Malek is her commander.Their country, Andarz Gu has n cities (numbered from 1 to n) and n\xe2\x80\x89-\xe2\x80\x891 bidirectional roads. Each road connects two different cities. There exist a unique path between any two cities.There are also m people living in Andarz Gu (numbered from 1 to m). Each person has and ID number. ID number of i\xe2\x80\x89-\xe2\x80\x89th person is i and he/she lives in city number ci. Note that there may be more than one person in a city, also there may be no people living in the city.  Malek loves to order. That\'s why he asks Duff to answer to q queries. In each query, he gives her numbers v,\xe2\x80\x89u and a.To answer a query:Assume there are x people living in the cities lying on the path from city v to city u. Assume these people\'s IDs are p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89px in increasing order. If k\xe2\x80\x89=\xe2\x80\x89min(x,\xe2\x80\x89a), then Duff should tell Malek numbers k,\xe2\x80\x89p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pk in this order. In the other words, Malek wants to know a minimums on that path (or less, if there are less than a people).Duff is very busy at the moment, so she asked you to help her and answer the queries." 2200
587B "Duff in Beach" dp "While Duff was resting in the beach, she accidentally found a strange array b0,\xe2\x80\x89b1,\xe2\x80\x89...,\xe2\x80\x89bl\xe2\x80\x89-\xe2\x80\x891 consisting of l positive integers. This array was strange because it was extremely long, but there was another (maybe shorter) array, a0,\xe2\x80\x89...,\xe2\x80\x89an\xe2\x80\x89-\xe2\x80\x891 that b can be build from a with formula: bi\xe2\x80\x89=\xe2\x80\x89ai mod n where a mod b denoted the remainder of dividing a by b.  Duff is so curious, she wants to know the number of subsequences of b like bi1,\xe2\x80\x89bi2,\xe2\x80\x89...,\xe2\x80\x89bix (0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i1\xe2\x80\x89<\xe2\x80\x89i2\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89ix\xe2\x80\x89<\xe2\x80\x89l), such that:   1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k  For each 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89-\xe2\x80\x891,   For each 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89-\xe2\x80\x891, bij\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89bij\xe2\x80\x89+\xe2\x80\x891. i.e this subsequence is non-decreasing. Since this number can be very large, she want to know it modulo 109\xe2\x80\x89+\xe2\x80\x897.Duff is not a programmer, and Malek is unavailable at the moment. So she asked for your help. Please tell her this number." 2100
587A "Duff and Weight Lifting" greedy "Recently, Duff has been practicing weight lifting. As a hard practice, Malek gave her a task. He gave her a sequence of weights. Weight of i-th of them is 2wi pounds. In each step, Duff can lift some of the remaining weights and throw them away. She does this until there\'s no more weight left. Malek asked her to minimize the number of steps.  Duff is a competitive programming fan. That\'s why in each step, she can only lift and throw away a sequence of weights 2a1,\xe2\x80\x89...,\xe2\x80\x892ak if and only if there exists a non-negative integer x such that 2a1\xe2\x80\x89+\xe2\x80\x892a2\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x892ak\xe2\x80\x89=\xe2\x80\x892x, i. e. the sum of those numbers is a power of two.Duff is a competitive programming fan, but not a programmer. That\'s why she asked for your help. Help her minimize the number of steps." 1500
586B "Laurenty and Shop" implementation "A little boy Laurenty has been playing his favourite game Nota for quite a while and is now very hungry. The boy wants to make sausage and cheese sandwiches, but first, he needs to buy a sausage and some cheese.The town where Laurenty lives in is not large. The houses in it are located in two rows, n houses in each row. Laurenty lives in the very last house of the second row. The only shop in town is placed in the first house of the first row.The first and second rows are separated with the main avenue of the city. The adjacent houses of one row are separated by streets.Each crosswalk of a street or an avenue has some traffic lights. In order to cross the street, you need to press a button on the traffic light, wait for a while for the green light and cross the street. Different traffic lights can have different waiting time.The traffic light on the crosswalk from the j-th house of the i-th row to the (j\xe2\x80\x89+\xe2\x80\x891)-th house of the same row has waiting time equal to aij (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x892,\xe2\x80\x891\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x891). For the traffic light on the crossing from the j-th house of one row to the j-th house of another row the waiting time equals bj (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n). The city doesn\'t have any other crossings.The boy wants to get to the store, buy the products and go back. The main avenue of the city is wide enough, so the boy wants to cross it exactly once on the way to the store and exactly once on the way back home. The boy would get bored if he had to walk the same way again, so he wants the way home to be different from the way to the store in at least one crossing.  Figure to the first sample. Help Laurenty determine the minimum total time he needs to wait at the crossroads." 1300
586A "Alena\'s Schedule" implementation "Alena has successfully passed the entrance exams to the university and is now looking forward to start studying.One two-hour lesson at the Russian university is traditionally called a pair, it lasts for two academic hours (an academic hour is equal to 45 minutes).The University works in such a way that every day it holds exactly n lessons. Depending on the schedule of a particular group of students, on a given day, some pairs may actually contain classes, but some may be empty (such pairs are called breaks).The official website of the university has already published the schedule for tomorrow for Alena\'s group. Thus, for each of the n pairs she knows if there will be a class at that time or not.Alena\'s House is far from the university, so if there are breaks, she doesn\'t always go home. Alena has time to go home only if the break consists of at least two free pairs in a row, otherwise she waits for the next pair at the university.Of course, Alena does not want to be sleepy during pairs, so she will sleep as long as possible, and will only come to the first pair that is presented in her schedule. Similarly, if there are no more pairs, then Alena immediately goes home.Alena appreciates the time spent at home, so she always goes home when it is possible, and returns to the university only at the beginning of the next pair. Help Alena determine for how many pairs she will stay at the university. Note that during some pairs Alena may be at the university waiting for the upcoming pair." 900
585F "Digits of Number Pi" dp,implementation,strings "Vasily has recently learned about the amazing properties of number \xcf\x80. In one of the articles it has been hypothesized that, whatever the sequence of numbers we have, in some position, this sequence is found among the digits of number \xcf\x80. Thus, if you take, for example, the epic novel ""War and Peace"" of famous Russian author Leo Tolstoy, and encode it with numbers, then we will find the novel among the characters of number \xcf\x80.Vasily was absolutely delighted with this, because it means that all the books, songs and programs have already been written and encoded in the digits of \xcf\x80. Vasily is, of course, a bit wary that this is only a hypothesis and it hasn\'t been proved, so he decided to check it out.To do this, Vasily downloaded from the Internet the archive with the sequence of digits of number \xcf\x80, starting with a certain position, and began to check the different strings of digits on the presence in the downloaded archive. Vasily quickly found short strings of digits, but each time he took a longer string, it turned out that it is not in the archive. Vasily came up with a definition that a string of length d is a half-occurrence if it contains a substring of length of at least , which occurs in the archive.To complete the investigation, Vasily took 2 large numbers x,\xe2\x80\x89y (x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y) with the same number of digits and now he wants to find the number of numbers in the interval from x to y, which are half-occurrences in the archive. Help Vasily calculate this value modulo 109\xe2\x80\x89+\xe2\x80\x897." 3200
585E "Present for Vitalik the Philatelist" "combinatorics,math,number theory" "Vitalik the philatelist has a birthday today!As he is a regular customer in a stamp store called \'Robin Bobin\', the store management decided to make him a gift.Vitalik wants to buy one stamp and the store will give him a non-empty set of the remaining stamps, such that the greatest common divisor (GCD) of the price of the stamps they give to him is more than one. If the GCD of prices of the purchased stamp and prices of present stamps set will be equal to 1, then Vitalik will leave the store completely happy.The store management asks you to count the number of different situations in which Vitalik will leave the store completely happy. Since the required number of situations can be very large, you need to find the remainder of this number modulo 109\xe2\x80\x89+\xe2\x80\x897. The situations are different if the stamps purchased by Vitalik are different, or if one of the present sets contains a stamp that the other present does not contain." 2900
585D "Lizard Era: Beginning" meet-in-the-middle "In the game Lizard Era: Beginning the protagonist will travel with three companions: Lynn, Meliana and Worrigan. Overall the game has n mandatory quests. To perform each of them, you need to take exactly two companions.The attitude of each of the companions to the hero is an integer. Initially, the attitude of each of them to the hero of neutral and equal to 0. As the hero completes quests, he makes actions that change the attitude of the companions, whom he took to perform this task, in positive or negative direction.Tell us what companions the hero needs to choose to make their attitude equal after completing all the quests. If this can be done in several ways, choose the one in which the value of resulting attitude is greatest possible." 2300
585C "Alice, Bob, Oranges and Apples" "number theory" "Alice and Bob decided to eat some fruit. In the kitchen they found a large bag of oranges and apples. Alice immediately took an orange for herself, Bob took an apple. To make the process of sharing the remaining fruit more fun, the friends decided to play a game. They put multiple cards and on each one they wrote a letter, either \'A\', or the letter \'B\'. Then they began to remove the cards one by one from left to right, every time they removed a card with the letter \'A\', Alice gave Bob all the fruits she had at that moment and took out of the bag as many apples and as many oranges as she had before. Thus the number of oranges and apples Alice had, did not change. If the card had written letter \'B\', then Bob did the same, that is, he gave Alice all the fruit that he had, and took from the bag the same set of fruit. After the last card way removed, all the fruit in the bag were over.You know how many oranges and apples was in the bag at first. Your task is to find any sequence of cards that Alice and Bob could have played with." 2400
585B "Phillip and Trains" "dfs and similar,graphs,shortest paths" "The mobile application store has a new game called ""Subway Roller"".The protagonist of the game Philip is located in one end of the tunnel and wants to get out of the other one. The tunnel is a rectangular field consisting of three rows and n columns. At the beginning of the game the hero is in some cell of the leftmost column. Some number of trains rides towards the hero. Each train consists of two or more neighbouring cells in some row of the field.All trains are moving from right to left at a speed of two cells per second, and the hero runs from left to right at the speed of one cell per second. For simplicity, the game is implemented so that the hero and the trains move in turns. First, the hero moves one cell to the right, then one square up or down, or stays idle. Then all the trains move twice simultaneously one cell to the left. Thus, in one move, Philip definitely makes a move to the right and can move up or down. If at any point, Philip is in the same cell with a train, he loses. If the train reaches the left column, it continues to move as before, leaving the tunnel.Your task is to answer the question whether there is a sequence of movements of Philip, such that he would be able to get to the rightmost column." 1700
585A "Gennady the Dentist" "brute force,implementation" "Gennady is one of the best child dentists in Berland. Today n children got an appointment with him, they lined up in front of his office.All children love to cry loudly at the reception at the dentist. We enumerate the children with integers from 1 to n in the order they go in the line. Every child is associated with the value of his cofidence pi. The children take turns one after another to come into the office; each time the child that is the first in the line goes to the doctor.While Gennady treats the teeth of the i-th child, the child is crying with the volume of vi. At that the confidence of the first child in the line is reduced by the amount of vi, the second one \xe2\x80\x94 by value vi\xe2\x80\x89-\xe2\x80\x891, and so on. The children in the queue after the vi-th child almost do not hear the crying, so their confidence remains unchanged.If at any point in time the confidence of the j-th child is less than zero, he begins to cry with the volume of dj and leaves the line, running towards the exit, without going to the doctor\'s office. At this the confidence of all the children after the j-th one in the line is reduced by the amount of dj.All these events occur immediately one after the other in some order. Some cries may lead to other cries, causing a chain reaction. Once in the hallway it is quiet, the child, who is first in the line, goes into the doctor\'s office.Help Gennady the Dentist to determine the numbers of kids, whose teeth he will cure. Print their numbers in the chronological order." 1800
584E "Anton and Ira" "constructive algorithms,greedy,math" "Anton loves transforming one permutation into another one by swapping elements for money, and Ira doesn\'t like paying for stupid games. Help them obtain the required permutation by paying as little money as possible.More formally, we have two permutations, p and s of numbers from 1 to n. We can swap pi and pj, by paying |i\xe2\x80\x89-\xe2\x80\x89j| coins for it. Find and print the smallest number of coins required to obtain permutation s from permutation p. Also print the sequence of swap operations at which we obtain a solution." 2300
584D "Dima and Lisa" "brute force,math,number theory" "Dima loves representing an odd number as the sum of multiple primes, and Lisa loves it when there are at most three primes. Help them to represent the given number as the sum of at most than three primes.More formally, you are given an odd numer n. Find a set of numbers pi (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k), such that 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x893 pi is a prime The numbers pi do not necessarily have to be distinct. It is guaranteed that at least one possible solution exists." 1800
584C "Marina and Vasya" "constructive algorithms,greedy,strings" "Marina loves strings of the same length and Vasya loves when there is a third string, different from them in exactly t characters. Help Vasya find at least one such string.More formally, you are given two strings s1, s2 of length n and number t. Let\'s denote as f(a,\xe2\x80\x89b) the number of characters in which strings a and b are different. Then your task will be to find any string s3 of length n, such that f(s1,\xe2\x80\x89s3)\xe2\x80\x89=\xe2\x80\x89f(s2,\xe2\x80\x89s3)\xe2\x80\x89=\xe2\x80\x89t. If there is no such string, print \xe2\x80\x89-\xe2\x80\x891." 1700
584B "Kolya and Tanya" combinatorics "Kolya loves putting gnomes at the circle table and giving them coins, and Tanya loves studying triplets of gnomes, sitting in the vertexes of an equilateral triangle.More formally, there are 3n gnomes sitting in a circle. Each gnome can have from 1 to 3 coins. Let\'s number the places in the order they occur in the circle by numbers from 0 to 3n\xe2\x80\x89-\xe2\x80\x891, let the gnome sitting on the i-th place have ai coins. If there is an integer i (0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89n) such that ai\xe2\x80\x89+\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x89n\xe2\x80\x89+\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x892n\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x896, then Tanya is satisfied. Count the number of ways to choose ai so that Tanya is satisfied. As there can be many ways of distributing coins, print the remainder of this number modulo 109\xe2\x80\x89+\xe2\x80\x897. Two ways, a and b, are considered distinct if there is index i (0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x893n), such that ai\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89bi (that is, some gnome got different number of coins in these two ways)." 1500
584A "Olesya and Rodion" math "Olesya loves numbers consisting of n digits, and Rodion only likes numbers that are divisible by t. Find some number that satisfies both of them.Your task is: given the n and t print an integer strictly larger than zero consisting of n digits that is divisible by t. If such number doesn\'t exist, print \xe2\x80\x89-\xe2\x80\x891." 1000
583B "Robot\'s Task" greedy,implementation "Robot Doc is located in the hall, with n computers stand in a line, numbered from left to right from 1 to n. Each computer contains exactly one piece of information, each of which Doc wants to get eventually. The computers are equipped with a security system, so to crack the i-th of them, the robot needs to collect at least ai any pieces of information from the other computers. Doc can hack the computer only if he is right next to it.The robot is assembled using modern technologies and can move along the line of computers in either of the two possible directions, but the change of direction requires a large amount of resources from Doc. Tell the minimum number of changes of direction, which the robot will have to make to collect all n parts of information if initially it is next to computer with number 1.It is guaranteed that there exists at least one sequence of the robot\'s actions, which leads to the collection of all information. Initially Doc doesn\'t have any pieces of information." 1200
583A "Asphalting Roads" implementation "City X consists of n vertical and n horizontal infinite roads, forming n\xe2\x80\x89\xc3\x97\xe2\x80\x89n intersections. Roads (both vertical and horizontal) are numbered from 1 to n, and the intersections are indicated by the numbers of the roads that form them.Sand roads have long been recognized out of date, so the decision was made to asphalt them. To do this, a team of workers was hired and a schedule of work was made, according to which the intersections should be asphalted.Road repairs are planned for n2 days. On the i-th day of the team arrives at the i-th intersection in the list and if none of the two roads that form the intersection were already asphalted they asphalt both roads. Otherwise, the team leaves the intersection, without doing anything with the roads.According to the schedule of road works tell in which days at least one road will be asphalted." 1000
582E "Boolean Function" "bitmasks,dp,expression parsing" "In this problem we consider Boolean functions of four variables A,\xe2\x80\x89B,\xe2\x80\x89C,\xe2\x80\x89D. Variables A,\xe2\x80\x89B,\xe2\x80\x89C and D are logical and can take values 0 or 1. We will define a function using the following grammar:<expression> ::= <variable> | (<expression>) <operator> (<expression>)<variable> ::= \'A\' | \'B\' | \'C\' | \'D\' | \'a\' | \'b\' | \'c\' | \'d\'<operator> ::= \'&\' | \'|\'Here large letters A,\xe2\x80\x89B,\xe2\x80\x89C,\xe2\x80\x89D represent variables, and small letters represent their negations. For example, if A\xe2\x80\x89=\xe2\x80\x891, then character \'A\' corresponds to value 1, and value character \'a\' corresponds to value 0. Here character \'&\' corresponds to the operation of logical AND, character \'|\' corresponds to the operation of logical OR.You are given expression s, defining function f, where some operations and variables are missing. Also you know the values of the function f(A,\xe2\x80\x89B,\xe2\x80\x89C,\xe2\x80\x89D) for some n distinct sets of variable values. Count the number of ways to restore the elements that are missing in the expression so that the resulting expression corresponded to the given information about function f in the given variable sets. As the value of the result can be rather large, print its remainder modulo 109\xe2\x80\x89+\xe2\x80\x897." 3000
582D "Number of Binominal Coefficients" "dp,math,number theory" "For a given prime integer p and integers \xce\xb1,\xe2\x80\x89A calculate the number of pairs of integers (n,\xe2\x80\x89k), such that 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89A and  is divisible by p\xce\xb1. As the answer can be rather large, print the remainder of the answer moduly 109\xe2\x80\x89+\xe2\x80\x897.Let us remind you that  is the number of ways k objects can be chosen from the set of n objects." 3300
582C "Superior Periodic Subarrays" "number theory" "You are given an infinite periodic array a0,\xe2\x80\x89a1,\xe2\x80\x89...,\xe2\x80\x89an\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89... with the period of length n. Formally, . A periodic subarray (l,\xe2\x80\x89s) (0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89<\xe2\x80\x89n, 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89s\xe2\x80\x89<\xe2\x80\x89n) of array a is an infinite periodic array with a period of length s that is a subsegment of array a, starting with position l.A periodic subarray (l,\xe2\x80\x89s) is superior, if when attaching it to the array a, starting from index l, any element of the subarray is larger than or equal to the corresponding element of array a. An example of attaching is given on the figure (top \xe2\x80\x94 infinite array a, bottom \xe2\x80\x94 its periodic subarray (l,\xe2\x80\x89s)):  Find the number of distinct pairs (l,\xe2\x80\x89s), corresponding to the superior periodic arrays." 2400
582B "Once Again..." "constructive algorithms,dp,matrices" "You are given an array of positive integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an\xe2\x80\x89\xc3\x97\xe2\x80\x89T of length n\xe2\x80\x89\xc3\x97\xe2\x80\x89T. We know that for any i\xe2\x80\x89>\xe2\x80\x89n it is true that ai\xe2\x80\x89=\xe2\x80\x89ai\xe2\x80\x89-\xe2\x80\x89n. Find the length of the longest non-decreasing sequence of the given array." 1900
582A "GCD Table" "constructive algorithms,greedy,number theory" "The GCD table G of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89n for an array of positive integers a of length n is defined by formula   Let us remind you that the greatest common divisor (GCD) of two positive integers x and y is the greatest integer that is divisor of both x and y, it is denoted as . For example, for array a\xe2\x80\x89=\xe2\x80\x89{4,\xe2\x80\x893,\xe2\x80\x896,\xe2\x80\x892} of length 4 the GCD table will look as follows:  Given all the numbers of the GCD table G, restore array a." 1700
581F "Zublicanes and Mumocrates" "dp,trees,two pointers" "It\'s election time in Berland. The favorites are of course parties of zublicanes and mumocrates. The election campaigns of both parties include numerous demonstrations on n main squares of the capital of Berland. Each of the n squares certainly can have demonstrations of only one party, otherwise it could lead to riots. On the other hand, both parties have applied to host a huge number of demonstrations, so that on all squares demonstrations must be held. Now the capital management will distribute the area between the two parties.Some pairs of squares are connected by (n\xe2\x80\x89-\xe2\x80\x891) bidirectional roads such that between any pair of squares there is a unique way to get from one square to another. Some squares are on the outskirts of the capital meaning that they are connected by a road with only one other square, such squares are called dead end squares.The mayor of the capital instructed to distribute all the squares between the parties so that the dead end squares had the same number of demonstrations of the first and the second party. It is guaranteed that the number of dead end squares of the city is even.To prevent possible conflicts between the zublicanes and the mumocrates it was decided to minimize the number of roads connecting the squares with the distinct parties. You, as a developer of the department of distributing squares, should determine this smallest number." 2400
581E "Kojiro and Furrari" dp,greedy "Motorist Kojiro spent 10 years saving up for his favorite car brand, Furrari. Finally Kojiro\'s dream came true! Kojiro now wants to get to his girlfriend Johanna to show off his car to her.Kojiro wants to get to his girlfriend, so he will go to her along a coordinate line. For simplicity, we can assume that Kojiro is at the point f of a coordinate line, and Johanna is at point e. Some points of the coordinate line have gas stations. Every gas station fills with only one type of fuel: Regular-92, Premium-95 or Super-98. Thus, each gas station is characterized by a pair of integers ti and xi \xe2\x80\x94 the number of the gas type and its position.One liter of fuel is enough to drive for exactly 1 km (this value does not depend on the type of fuel). Fuels of three types differ only in quality, according to the research, that affects the lifetime of the vehicle motor. A Furrari tank holds exactly s liters of fuel (regardless of the type of fuel). At the moment of departure from point f Kojiro\'s tank is completely filled with fuel Super-98. At each gas station Kojiro can fill the tank with any amount of fuel, but of course, at no point in time, the amount of fuel in the tank can be more than s liters. Note that the tank can simultaneously have different types of fuel. The car can moves both left and right.To extend the lifetime of the engine Kojiro seeks primarily to minimize the amount of fuel of type Regular-92. If there are several strategies to go from f to e, using the minimum amount of fuel of type Regular-92, it is necessary to travel so as to minimize the amount of used fuel of type Premium-95.Write a program that can for the m possible positions of the start fi minimize firstly, the amount of used fuel of type Regular-92 and secondly, the amount of used fuel of type Premium-95." 2800
581D "Three Logos" "bitmasks,brute force,constructive algorithms,geometry,implementation,math" "Three companies decided to order a billboard with pictures of their logos. A billboard is a big square board. A logo of each company is a rectangle of a non-zero area. Advertisers will put up the ad only if it is possible to place all three logos on the billboard so that they do not overlap and the billboard has no empty space left. When you put a logo on the billboard, you should rotate it so that the sides were parallel to the sides of the billboard.Your task is to determine if it is possible to put the logos of all the three companies on some square billboard without breaking any of the described rules." 1700
581C "Developing Skills" implementation,math,sortings "Petya loves computer games. Finally a game that he\'s been waiting for so long came out!The main character of this game has n different skills, each of which is characterized by an integer ai from 0 to 100. The higher the number ai is, the higher is the i-th skill of the character. The total rating of the character is calculated as the sum of the values \xe2\x80\x8b\xe2\x80\x8bof  for all i from 1 to n. The expression \xe2\x8c\x8a x\xe2\x8c\x8b denotes the result of rounding the number x down to the nearest integer.At the beginning of the game Petya got k improvement units as a bonus that he can use to increase the skills of his character and his total rating. One improvement unit can increase any skill of Petya\'s character by exactly one. For example, if a4\xe2\x80\x89=\xe2\x80\x8946, after using one imporvement unit to this skill, it becomes equal to 47. A hero\'s skill cannot rise higher more than 100. Thus, it is permissible that some of the units will remain unused.Your task is to determine the optimal way of using the improvement units so as to maximize the overall rating of the character. It is not necessary to use all the improvement units." 1400
581B "Luxurious Houses" implementation,math "The capital of Berland has n multifloor buildings. The architect who built up the capital was very creative, so all the houses were built in one row.Let\'s enumerate all the houses from left to right, starting with one. A house is considered to be luxurious if the number of floors in it is strictly greater than in all the houses with larger numbers. In other words, a house is luxurious if the number of floors in it is strictly greater than in all the houses, which are located to the right from it. In this task it is assumed that the heights of floors in the houses are the same.The new architect is interested in n questions, i-th of them is about the following: ""how many floors should be added to the i-th house to make it luxurious?"" (for all i from 1 to n, inclusive). You need to help him cope with this task.Note that all these questions are independent from each other \xe2\x80\x94 the answer to the question for house i does not affect other answers (i.e., the floors to the houses are not actually added)." 1100
581A "Vasya the Hipster" implementation,math "One day Vasya the Hipster decided to count how many socks he had. It turned out that he had a red socks and b blue socks.According to the latest fashion, hipsters should wear the socks of different colors: a red one on the left foot, a blue one on the right foot.Every day Vasya puts on new socks in the morning and throws them away before going to bed as he doesn\'t want to wash them.Vasya wonders, what is the maximum number of days when he can dress fashionable and wear different socks, and after that, for how many days he can then wear the same socks until he either runs out of socks or cannot make a single pair from the socks he\'s got.Can you help him?" 800
580E "Kefa and Watch" "data structures,hashing,strings" "One day Kefa the parrot was walking down the street as he was on the way home from the restaurant when he saw something glittering by the road. As he came nearer he understood that it was a watch. He decided to take it to the pawnbroker to earn some money. The pawnbroker said that each watch contains a serial number represented by a string of digits from 0 to 9, and the more quality checks this number passes, the higher is the value of the watch. The check is defined by three positive integers l, r and d. The watches pass a check if a substring of the serial number from l to r has period d. Sometimes the pawnbroker gets distracted and Kefa changes in some substring of the serial number all digits to c in order to increase profit from the watch. The seller has a lot of things to do to begin with and with Kefa messing about, he gave you a task: to write a program that determines the value of the watch.Let us remind you that number x is called a period of string s (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|s|), if si\xe2\x80\x89\xe2\x80\x89=\xe2\x80\x89\xe2\x80\x89si\xe2\x80\x89+\xe2\x80\x89x for all i from 1 to |s|\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x89\xe2\x80\x89x." 2500
580D "Kefa and Dishes" bitmasks,dp "When Kefa came to the restaurant and sat at a table, the waiter immediately brought him the menu. There were n dishes. Kefa knows that he needs exactly m dishes. But at that, he doesn\'t want to order the same dish twice to taste as many dishes as possible. Kefa knows that the i-th dish gives him ai units of satisfaction. But some dishes do not go well together and some dishes go very well together. Kefa set to himself k rules of eating food of the following type \xe2\x80\x94 if he eats dish x exactly before dish y (there should be no other dishes between x and y), then his satisfaction level raises by c. Of course, our parrot wants to get some maximal possible satisfaction from going to the restaurant. Help him in this hard task!" 1800
580C "Kefa and Park" "dfs and similar,graphs,trees" "Kefa decided to celebrate his first big salary by going to the restaurant. He lives by an unusual park. The park is a rooted tree consisting of n vertices with the root at vertex 1. Vertex 1 also contains Kefa\'s house. Unfortunaely for our hero, the park also contains cats. Kefa has already found out what are the vertices with cats in them.The leaf vertices of the park contain restaurants. Kefa wants to choose a restaurant where he will go, but unfortunately he is very afraid of cats, so there is no way he will go to the restaurant if the path from the restaurant to his house contains more than m consecutive vertices with cats. Your task is to help Kefa count the number of restaurants where he can go." 1500
580B "Kefa and Company" "binary search,sortings,two pointers" "Kefa wants to celebrate his first big salary by going to restaurant. However, he needs company. Kefa has n friends, each friend will agree to go to the restaurant if Kefa asks. Each friend is characterized by the amount of money he has and the friendship factor in respect to Kefa. The parrot doesn\'t want any friend to feel poor compared to somebody else in the company (Kefa doesn\'t count). A friend feels poor if in the company there is someone who has at least d units of money more than he does. Also, Kefa wants the total friendship factor of the members of the company to be maximum. Help him invite an optimal company!" 1500
580A "Kefa and First Steps" "brute force,dp,implementation" "Kefa decided to make some money doing business on the Internet for exactly n days. He knows that on the i-th day (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) he makes ai money. Kefa loves progress, that\'s why he wants to know the length of the maximum non-decreasing subsegment in sequence ai. Let us remind you that the subsegment of the sequence is its continuous fragment. A subsegment of numbers is called non-decreasing if all numbers in it follow in the non-decreasing order.Help Kefa cope with this task!" 900
579B "Finding Team Member" "brute force,implementation,sortings" "There is a programing contest named SnakeUp, 2n people want to compete for it. In order to attend this contest, people need to form teams of exactly two people. You are given the strength of each possible combination of two people. All the values of the strengths are distinct.Every contestant hopes that he can find a teammate so that their team\xe2\x80\x99s strength is as high as possible. That is, a contestant will form a team with highest strength possible by choosing a teammate from ones who are willing to be a teammate with him/her. More formally, two people A and B may form a team if each of them is the best possible teammate (among the contestants that remain unpaired) for the other one. Can you determine who will be each person\xe2\x80\x99s teammate?" 1300
579A "Raising Bacteria" bitmasks "You are a lover of bacteria. You want to raise some bacteria in a box. Initially, the box is empty. Each morning, you can put any number of bacteria into the box. And each night, every bacterium in the box will split into two bacteria. You hope to see exactly x bacteria in the box at some moment. What is the minimum number of bacteria you need to put into the box across those days?" 1000
578F "Mirror Box" matrices,trees "You are given a box full of mirrors. Box consists of grid of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m. Each cell of the grid contains a mirror put in the shape of \'\\\' or \'\xe2\x80\x89/\xe2\x80\x89\' (45 degree to the horizontal or vertical line). But mirrors in some cells have been destroyed. You want to put new mirrors into these grids so that the following two conditions are satisfied:  If you put a light ray horizontally/vertically into the middle of any unit segment that is side of some border cell, the light will go out from the neighboring unit segment to the segment you put the ray in. each unit segment of the grid of the mirror box can be penetrated by at least one light ray horizontally/vertically put into the box according to the rules of the previous paragraph   After you tried putting some mirrors, you find out that there are many ways of doing so. How many possible ways are there? The answer might be large, so please find the result modulo prime number MOD." 3200
578E Walking! "constructive algorithms,greedy" "There is a sand trail in front of Alice\'s home.In daytime, people walk over it and leave a footprint on the trail for their every single step. Alice cannot distinguish the order of the footprints, but she can tell whether each footprint is made by left foot or right foot. Also she\'s certain that all people are walking by alternating left foot and right foot.For example, suppose that one person walked through the trail and left some footprints. The footprints are RRLRL in order along the trail (\'R\' means right foot and \'L\' means left foot). You might think the outcome of the footprints is strange. But in fact, some steps are resulting from walking backwards!There are some possible order of steps that produce these footprints such as 1\xe2\x80\x89\xe2\x86\x92\xe2\x80\x893\xe2\x80\x89\xe2\x86\x92\xe2\x80\x892\xe2\x80\x89\xe2\x86\x92\xe2\x80\x895\xe2\x80\x89\xe2\x86\x92\xe2\x80\x894 or 2\xe2\x80\x89\xe2\x86\x92\xe2\x80\x893\xe2\x80\x89\xe2\x86\x92\xe2\x80\x894\xe2\x80\x89\xe2\x86\x92\xe2\x80\x895\xe2\x80\x89\xe2\x86\x92\xe2\x80\x891 (we suppose that the distance between two consecutive steps can be arbitrarily long). The number of backward steps from above two examples are 2 and 1 separately.Alice is interested in these footprints. Whenever there is a person walking trough the trail, she takes a picture of all these footprints along the trail and erase all of them so that next person will leave a new set of footprints. We know that people walk by alternating right foot and left foot, but we don\'t know if the first step is made by left foot or right foot.Alice wants to know the minimum possible number of backward steps made by a person. But it\'s a little hard. Please help Alice to calculate it. You also need to construct one possible history of these footprints." 2700
578D "LCS Again" dp,greedy "You are given a string S of length n with each character being one of the first m lowercase English letters. Calculate how many different strings T of length n composed from the first m lowercase English letters exist such that the length of LCS (longest common subsequence) between S and T is n\xe2\x80\x89-\xe2\x80\x891.Recall that LCS of two strings S and T is the longest string C such that C both in S and T as a subsequence." 2700
578C "Weakness and Poorness" "ternary search" "You are given a sequence of n integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. Determine a real number x such that the weakness of the sequence a1\xe2\x80\x89-\xe2\x80\x89x,\xe2\x80\x89a2\xe2\x80\x89-\xe2\x80\x89x,\xe2\x80\x89...,\xe2\x80\x89an\xe2\x80\x89-\xe2\x80\x89x is as small as possible.The weakness of a sequence is defined as the maximum value of the poorness over all segments (contiguous subsequences) of a sequence.The poorness of a segment is defined as the absolute value of sum of the elements of segment." 2000
578B """Or"" Game" "brute force,greedy" "You are given n numbers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. You can perform at most k operations. For each operation you can multiply one of the numbers by x. We want to make  as large as possible, where  denotes the bitwise OR. Find the maximum possible value of  after performing at most k operations optimally." 1700
578A "A Problem about Polyline" geometry,math "There is a polyline going through points (0,\xe2\x80\x890)\xe2\x80\x89\xe2\x80\x93\xe2\x80\x89(x,\xe2\x80\x89x)\xe2\x80\x89\xe2\x80\x93\xe2\x80\x89(2x,\xe2\x80\x890)\xe2\x80\x89\xe2\x80\x93\xe2\x80\x89(3x,\xe2\x80\x89x)\xe2\x80\x89\xe2\x80\x93\xe2\x80\x89(4x,\xe2\x80\x890)\xe2\x80\x89\xe2\x80\x93\xe2\x80\x89...\xe2\x80\x89-\xe2\x80\x89(2kx,\xe2\x80\x890)\xe2\x80\x89\xe2\x80\x93\xe2\x80\x89(2kx\xe2\x80\x89+\xe2\x80\x89x,\xe2\x80\x89x)\xe2\x80\x89\xe2\x80\x93\xe2\x80\x89.... We know that the polyline passes through the point (a,\xe2\x80\x89b). Find minimum positive value x such that it is true or determine that there is no such x." 1700
577B "Modulo Sum" "combinatorics,data structures,dp,two pointers" "You are given a sequence of numbers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an, and a number m.Check if it is possible to choose a non-empty subsequence aij such that the sum of numbers in this subsequence is divisible by m." 1900
577A "Multiplication Table" "implementation,number theory" "Let\'s consider a table consisting of n rows and n columns. The cell located at the intersection of i-th row and j-th column contains number i\xe2\x80\x89\xc3\x97\xe2\x80\x89j. The rows and columns are numbered starting from 1.You are given a positive integer x. Your task is to count the number of cells in a table that contain number x." 1000
576E "Painting Edges" "binary search,data structures" "Note the unusual memory limit for this problem.You are given an undirected graph consisting of n vertices and m edges. The vertices are numbered with integers from 1 to n, the edges are numbered with integers from 1 to m. Each edge can be unpainted or be painted in one of the k colors, which are numbered with integers from 1 to k. Initially, none of the edges is painted in any of the colors.You get queries of the form ""Repaint edge ei to color ci"". At any time the graph formed by the edges of the same color must be bipartite. If after the repaint this condition is violated, then the query is considered to be invalid and edge ei keeps its color. Otherwise, edge ei is repainted in color ci, and the query is considered to valid.Recall that the graph is called bipartite if the set of its vertices can be divided into two parts so that no edge connected vertices of the same parts.For example, suppose you are given a triangle graph, that is a graph with three vertices and edges (1,\xe2\x80\x892), (2,\xe2\x80\x893) and (3,\xe2\x80\x891). Suppose that the first two edges are painted color 1, and the third one is painted color 2. Then the query of ""repaint the third edge in color 1"" will be incorrect because after its execution the graph formed by the edges of color 1 will not be bipartite. On the other hand, it is possible to repaint the second edge in color 2.You receive q queries. For each query, you should either apply it, and report that the query is valid, or report that the query is invalid." 3300
576D "Flights for Regular Customers" dp,matrices "In the country there are exactly n cities numbered with positive integers from 1 to n. In each city there is an airport is located.Also, there is the only one airline, which makes m flights. Unfortunately, to use them, you need to be a regular customer of this company, namely, you have the opportunity to enjoy flight i from city ai to city bi only if you have already made at least di flights before that.Please note that flight i flies exactly from city ai to city bi. It can not be used to fly from city bi to city ai. An interesting fact is that there may possibly be recreational flights with a beautiful view of the sky, which begin and end in the same city.You need to get from city 1 to city n. Unfortunately, you\'ve never traveled by plane before. What minimum number of flights you have to perform in order to get to city n?Note that the same flight can be used multiple times." 2700
576C "Points on Plane" "constructive algorithms,divide and conquer,geometry,greedy,sortings" "On a plane are n points (xi, yi) with integer coordinates between 0 and 106. The distance between the two points with numbers a and b is said to be the following value:  (the distance calculated by such formula is called Manhattan distance).We call a hamiltonian path to be some permutation pi of numbers from 1 to n. We say that the length of this path is value .Find some hamiltonian path with a length of no more than 25\xe2\x80\x89\xc3\x97\xe2\x80\x89108. Note that you do not have to minimize the path length." 2100
576B "Invariance of Tree" "constructive algorithms,dfs and similar,greedy,trees" "A tree of size n is an undirected connected graph consisting of n vertices without cycles.Consider some tree with n vertices. We call a tree invariant relative to permutation p\xe2\x80\x89=\xe2\x80\x89p1p2... pn, if for any two vertices of the tree u and v the condition holds: ""vertices u and v are connected by an edge if and only if vertices pu and pv are connected by an edge"".You are given permutation p of size n. Find some tree size n, invariant relative to the given permutation." 2100
576A "Vasya and Petya\'s Game" "math,number theory" "Vasya and Petya are playing a simple game. Vasya thought of number x between 1 and n, and Petya tries to guess the number.Petya can ask questions like: ""Is the unknown number divisible by number y?"".The game is played by the following rules: first Petya asks all the questions that interest him (also, he can ask no questions), and then Vasya responds to each question with a \'yes\' or a \'no\'. After receiving all the answers Petya should determine the number that Vasya thought of.Unfortunately, Petya is not familiar with the number theory. Help him find the minimum number of questions he should ask to make a guaranteed guess of Vasya\'s number, and the numbers yi, he should ask the questions about." 1500
575I "Robots protection" "data structures" "Company ""Robots industries"" produces robots for territory protection. Robots protect triangle territories \xe2\x80\x94 right isosceles triangles with catheti parallel to North-South and East-West directions.Owner of some land buys and sets robots on his territory to protect it. From time to time, businessmen want to build offices on that land and want to know how many robots will guard it. You are to handle these queries." 2800
575H Bots "combinatorics,dp,math,number theory" "Sasha and Ira are two best friends. But they aren\xe2\x80\x99t just friends, they are software engineers and experts in artificial intelligence. They are developing an algorithm for two bots playing a two-player game. The game is cooperative and turn based. In each turn, one of the players makes a move (it doesn\xe2\x80\x99t matter which player, it\'s possible that players turns do not alternate). Algorithm for bots that Sasha and Ira are developing works by keeping track of the state the game is in. Each time either bot makes a move, the state changes. And, since the game is very dynamic, it will never go back to the state it was already in at any point in the past.Sasha and Ira are perfectionists and want their algorithm to have an optimal winning strategy. They have noticed that in the optimal winning strategy, both bots make exactly N moves each. But, in order to find the optimal strategy, their algorithm needs to analyze all possible states of the game (they haven\xe2\x80\x99t learned about alpha-beta pruning yet) and pick the best sequence of moves.They are worried about the efficiency of their algorithm and are wondering what is the total number of states of the game that need to be analyzed?" 1800
575G "Run for beer" "dfs and similar,shortest paths" "People in BubbleLand like to drink beer. Little do you know, beer here is so good and strong that every time you drink it your speed goes 10 times slower than before you drank it.Birko lives in city Beergrade, but wants to go to city Beerburg. You are given a road map of BubbleLand and you need to find the fastest way for him. When he starts his journey in Beergrade his speed is 1. When he comes to a new city he always tries a glass of local beer, which divides his speed by 10. The question here is what the minimal time for him to reach Beerburg is. If there are several paths with the same minimal time, pick the one that has least roads on it. If there is still more than one path, pick any.It is guaranteed that there will be at least one path from Beergrade to Beerburg." 2200
575F Bulbo dp,greedy "Bananistan is a beautiful banana republic. Beautiful women in beautiful dresses. Beautiful statues of beautiful warlords. Beautiful stars in beautiful nights.In Bananistan people play this crazy game \xe2\x80\x93 Bulbo. There\xe2\x80\x99s an array of bulbs and player at the position, which represents one of the bulbs. The distance between two neighboring bulbs is 1. Before each turn player can change his position with cost |posnew\xe2\x80\x89-\xe2\x80\x89posold|. After that, a contiguous set of bulbs lights-up and player pays the cost that\xe2\x80\x99s equal to the distance to the closest shining bulb. Then, all bulbs go dark again. The goal is to minimize your summed cost. I tell you, Bananistanians are spending their nights playing with bulbs.Banana day is approaching, and you are hired to play the most beautiful Bulbo game ever. A huge array of bulbs is installed, and you know your initial position and all the light-ups in advance. You need to play the ideal game and impress Bananistanians, and their families." 2100
575E "Spectator Riots" geometry "It\xe2\x80\x99s riot time on football stadium Ramacana! Raging fans have entered the field and the police find themselves in a difficult situation. The field can be represented as a square in the coordinate system defined by two diagonal vertices in (0,0) and (105, 105). The sides of that square are also considered to be inside the field, everything else is outside.In the beginning, there are N fans on the field. For each fan we are given his speed, an integer vi as well as his integer coordinates (xi, yi). A fan with those coordinates might move and after one second he might be at any point (xi\xe2\x80\x89+\xe2\x80\x89p, yi\xe2\x80\x89+\xe2\x80\x89q) where 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|p|\xe2\x80\x89+\xe2\x80\x89|q|\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89vi. p, q are both integers.Points that go outside of the square that represents the field are excluded and all others have equal probability of being the location of that specific fan after one second.Andrej, a young and promising police officer, has sent a flying drone to take a photo of the riot from above. The drone\xe2\x80\x99s camera works like this:  It selects three points with integer coordinates such that there is a chance of a fan appearing there after one second. They must not be collinear or the camera won\xe2\x80\x99t work. It is guaranteed that not all of the initial positions of fans will be on the same line.  Camera focuses those points and creates a circle that passes through those three points. A photo is taken after one second (one second after the initial state).  Everything that is on the circle or inside it at the moment of taking the photo (one second after focusing the points) will be on the photo. Your goal is to select those three points so that the expected number of fans seen on the photo is maximized. If there are more such selections, select those three points that give the circle with largest radius among them. If there are still more suitable selections, any one of them will be accepted. If your answer follows conditions above and radius of circle you return is smaller then the optimal one by 0.01, your output will be considered as correct.No test will have optimal radius bigger than 1010." 2800
575D Tablecity "constructive algorithms,implementation" "There was a big bank robbery in Tablecity. In order to catch the thief, the President called none other than Albert \xe2\x80\x93 Tablecity\xe2\x80\x99s Chief of Police. Albert does not know where the thief is located, but he does know how he moves.Tablecity can be represented as 1000\xe2\x80\x89\xc3\x97\xe2\x80\x892 grid, where every cell represents one district. Each district has its own unique name \xe2\x80\x9c(X,\xe2\x80\x89Y)\xe2\x80\x9d, where X and Y are the coordinates of the district in the grid. The thief\xe2\x80\x99s movement is as Every hour the thief will leave the district (X,\xe2\x80\x89Y) he is currently hiding in, and move to one of the districts: (X\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89Y), (X\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89Y), (X\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89Y\xe2\x80\x89-\xe2\x80\x891), (X\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89Y\xe2\x80\x89+\xe2\x80\x891), (X\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89Y\xe2\x80\x89-\xe2\x80\x891), (X\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89Y\xe2\x80\x89+\xe2\x80\x891) as long as it exists in Tablecity. Below is an example of thief\xe2\x80\x99s possible movements if he is located in district (7,1):Albert has enough people so that every hour he can pick any two districts in Tablecity and fully investigate them, making sure that if the thief is located in one of them, he will get caught. Albert promised the President that the thief will be caught in no more than 2015 hours and needs your help in order to achieve that." 1700
575C Party "bitmasks,brute force,graph matchings" "Note the unusual memory limit for the problem.People working in MDCS (Microsoft Development Center Serbia) like partying. They usually go to night clubs on Friday and Saturday.There are N people working in MDCS and there are N clubs in the city. Unfortunately, if there is more than one Microsoft employee in night club, level of coolness goes infinitely high and party is over, so club owners will never let more than one Microsoft employee enter their club in the same week (just to be sure).You are organizing night life for Microsoft employees and you have statistics about how much every employee likes Friday and Saturday parties for all clubs.You need to match people with clubs maximizing overall sum of their happiness (they are happy as much as they like the club), while half of people should go clubbing on Friday and the other half on Saturday." 2700
575B Bribes "dfs and similar,graphs,trees" "Ruritania is a country with a very badly maintained road network, which is not exactly good news for lorry drivers that constantly have to do deliveries. In fact, when roads are maintained, they become one-way. It turns out that it is sometimes impossible to get from one town to another in a legal way \xe2\x80\x93 however, we know that all towns are reachable, though illegally!Fortunately for us, the police tend to be very corrupt and they will allow a lorry driver to break the rules and drive in the wrong direction provided they receive \xe2\x80\x98a small gift\xe2\x80\x99. There is one patrol car for every road and they will request 1000 Ruritanian dinars when a driver drives in the wrong direction. However, being greedy, every time a patrol car notices the same driver breaking the rule, they will charge double the amount of money they requested the previous time on that particular road.Borna is a lorry driver that managed to figure out this bribing pattern. As part of his job, he has to make K stops in some towns all over Ruritania and he has to make these stops in a certain order. There are N towns (enumerated from 1 to N) in Ruritania and Borna\xe2\x80\x99s initial location is the capital city i.e. town 1. He happens to know which ones out of the N\xe2\x80\x89-\xe2\x80\x891 roads in Ruritania are currently unidirectional, but he is unable to compute the least amount of money he needs to prepare for bribing the police. Help Borna by providing him with an answer and you will be richly rewarded." 2200
575A Fibonotci "data structures,math,matrices" "Fibonotci sequence is an integer recursive sequence defined by the recurrence relation  Fn\xe2\x80\x89=\xe2\x80\x89sn\xe2\x80\x89-\xe2\x80\x891\xc2\xb7Fn\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x89sn\xe2\x80\x89-\xe2\x80\x892\xc2\xb7Fn\xe2\x80\x89-\xe2\x80\x892  with  F0\xe2\x80\x89=\xe2\x80\x890,\xe2\x80\x89F1\xe2\x80\x89=\xe2\x80\x891 Sequence s is an infinite and almost cyclic sequence with a cycle of length N. A sequence s is called almost cyclic with a cycle of length N if , for i\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89N, except for a finite number of values si, for which  (i\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89N).Following is an example of an almost cyclic sequence with a cycle of length 4:  s = (5,3,8,11,5,3,7,11,5,3,8,11,\xe2\x80\xa6) Notice that the only value of s for which the equality  does not hold is s6 (s6\xe2\x80\x89=\xe2\x80\x897 and s2\xe2\x80\x89=\xe2\x80\x898). You are given s0,\xe2\x80\x89s1,\xe2\x80\x89...sN\xe2\x80\x89-\xe2\x80\x891 and all the values of sequence s for which  (i\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89N).Find ." 2700
574B "Bear and Three Musketeers" "brute force,dfs and similar,graphs,hashing" "Do you know a story about the three musketeers? Anyway, you will learn about its origins now.Richelimakieu is a cardinal in the city of Bearis. He is tired of dealing with crime by himself. He needs three brave warriors to help him to fight against bad guys.There are n warriors. Richelimakieu wants to choose three of them to become musketeers but it\'s not that easy. The most important condition is that musketeers must know each other to cooperate efficiently. And they shouldn\'t be too well known because they could be betrayed by old friends. For each musketeer his recognition is the number of warriors he knows, excluding other two musketeers.Help Richelimakieu! Find if it is possible to choose three musketeers knowing each other, and what is minimum possible sum of their recognitions." 1500
574A "Bear and Elections" greedy,implementation "Limak is a grizzly bear who desires power and adoration. He wants to win in upcoming elections and rule over the Bearland.There are n candidates, including Limak. We know how many citizens are going to vote for each candidate. Now i-th candidate would get ai votes. Limak is candidate number 1. To win in elections, he must get strictly more votes than any other candidate.Victory is more important than everything else so Limak decided to cheat. He will steal votes from his opponents by bribing some citizens. To bribe a citizen, Limak must give him or her one candy - citizens are bears and bears like candies. Limak doesn\'t have many candies and wonders - how many citizens does he have to bribe?" 1200
573E "Bear and Bowling" "data structures,greedy" "Limak is an old brown bear. He often goes bowling with his friends. Today he feels really good and tries to beat his own record!For rolling a ball one gets a score \xe2\x80\x94 an integer (maybe negative) number of points. Score for i-th roll is multiplied by i and scores are summed up. So, for k rolls with scores s1,\xe2\x80\x89s2,\xe2\x80\x89...,\xe2\x80\x89sk, total score is . Total score is 0 if there were no rolls.Limak made n rolls and got score ai for i-th of them. He wants to maximize his total score and he came up with an interesting idea. He will cancel some rolls, saying that something distracted him or there was a strong wind.Limak is able to cancel any number of rolls, maybe even all or none of them. Total score is calculated as if there were only non-canceled rolls. Look at the sample tests for clarification. What maximum total score can Limak get?" 3200
573D "Bear and Cavalry" "data structures,divide and conquer,dp" "Would you want to fight against bears riding horses? Me neither.Limak is a grizzly bear. He is general of the dreadful army of Bearland. The most important part of an army is cavalry of course.Cavalry of Bearland consists of n warriors and n horses. i-th warrior has strength wi and i-th horse has strength hi. Warrior together with his horse is called a unit. Strength of a unit is equal to multiplied strengths of warrior and horse. Total strength of cavalry is equal to sum of strengths of all n units. Good assignment of warriors and horses makes cavalry truly powerful.Initially, i-th warrior has i-th horse. You are given q queries. In each query two warriors swap their horses with each other.General Limak must be ready for every possible situation. What if warriors weren\'t allowed to ride their own horses? After each query find the maximum possible strength of cavalry if we consider assignments of all warriors to all horses that no warrior is assigned to his own horse (it can be proven that for n\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x892 there is always at least one correct assignment).Note that we can\'t leave a warrior without a horse." 3000
573C "Bear and Drawing" "constructive algorithms,dfs and similar,trees" "Limak is a little bear who learns to draw. People usually start with houses, fences and flowers but why would bears do it? Limak lives in the forest and he decides to draw a tree.Recall that tree is a connected graph consisting of n vertices and n\xe2\x80\x89-\xe2\x80\x891 edges.Limak chose a tree with n vertices. He has infinite strip of paper with two parallel rows of dots. Little bear wants to assign vertices of a tree to some n distinct dots on a paper so that edges would intersect only at their endpoints \xe2\x80\x94 drawn tree must be planar. Below you can see one of correct drawings for the first sample test.  Is it possible for Limak to draw chosen tree?" 2300
573B "Bear and Blocks" "binary search,data structures,dp,math" "Limak is a little bear who loves to play. Today he is playing by destroying block towers. He built n towers in a row. The i-th tower is made of hi identical blocks. For clarification see picture for the first sample.Limak will repeat the following operation till everything is destroyed.Block is called internal if it has all four neighbors, i.e. it has each side (top, left, down and right) adjacent to other block or to the floor. Otherwise, block is boundary. In one operation Limak destroys all boundary blocks. His paws are very fast and he destroys all those blocks at the same time.Limak is ready to start. You task is to count how many operations will it take him to destroy all towers." 1600
573A "Bear and Poker" "implementation,math,number theory" "Limak is an old brown bear. He often plays poker with his friends. Today they went to a casino. There are n players (including Limak himself) and right now all of them have bids on the table. i-th of them has bid with size ai dollars.Each player can double his bid any number of times and triple his bid any number of times. The casino has a great jackpot for making all bids equal. Is it possible that Limak and his friends will win a jackpot?" 1300
572B "Order Book" "data structures,greedy,implementation,sortings" "In this task you need to process a set of stock exchange orders and use them to create order book.An order is an instruction of some participant to buy or sell stocks on stock exchange. The order number i has price pi, direction di \xe2\x80\x94 buy or sell, and integer qi. This means that the participant is ready to buy or sell qi stocks at price pi for one stock. A value qi is also known as a volume of an order.All orders with the same price p and direction d are merged into one aggregated order with price p and direction d. The volume of such order is a sum of volumes of the initial orders.An order book is a list of aggregated orders, the first part of which contains sell orders sorted by price in descending order, the second contains buy orders also sorted by price in descending order.An order book of depth s contains s best aggregated orders for each direction. A buy order is better if it has higher price and a sell order is better if it has lower price. If there are less than s aggregated orders for some direction then all of them will be in the final order book.You are given n stock exhange orders. Your task is to print order book of depth s for these orders." 1300
572A Arrays sortings "You are given two arrays A and B consisting of integers, sorted in non-decreasing order. Check whether it is possible to choose k numbers in array A and choose m numbers in array B so that any number chosen in the first array is strictly less than any number chosen in the second array." 900
571E "Geometric Progressions" math "Geometric progression with the first element a and common ratio b is a sequence of numbers a,\xe2\x80\x89ab,\xe2\x80\x89ab2,\xe2\x80\x89ab3,\xe2\x80\x89....You are given n integer geometric progressions. Your task is to find the smallest integer x, that is the element of all the given progressions, or else state that such integer does not exist." 3200
571D Campus "binary search,data structures,dsu,trees" "Oscolcovo city has a campus consisting of n student dormitories, n universities and n military offices. Initially, the i-th dormitory belongs to the i-th university and is assigned to the i-th military office.Life goes on and the campus is continuously going through some changes. The changes can be of four types:  University aj merges with university bj. After that all the dormitories that belonged to university bj are assigned to to university aj, and university bj disappears.  Military office cj merges with military office dj. After that all the dormitories that were assigned to military office dj, are assigned to military office cj, and military office dj disappears.  Students of university xj move in dormitories. Lets kxj is the number of dormitories that belong to this university at the time when the students move in. Then the number of students in each dormitory of university xj increases by kxj (note that the more dormitories belong to the university, the more students move in each dormitory of the university).  Military office number yj conducts raids on all the dormitories assigned to it and takes all students from there. Thus, at each moment of time each dormitory is assigned to exactly one university and one military office. Initially, all the dormitory are empty.Your task is to process the changes that take place in the campus and answer the queries, how many people currently live in dormitory qj." 3100
571C "CNF 2" "constructive algorithms,dfs and similar,graphs,greedy" "\'In Boolean logic, a formula is in conjunctive normal form (CNF) or clausal normal form if it is a conjunction of clauses, where a clause is a disjunction of literals\' (cited from https://en.wikipedia.org/wiki/Conjunctive_normal_form)In the other words, CNF is a formula of type , where & represents a logical ""AND"" (conjunction),  represents a logical ""OR"" (disjunction), and vij are some boolean variables or their negations. Each statement in brackets is called a clause, and vij are called literals.You are given a CNF containing variables x1,\xe2\x80\x89...,\xe2\x80\x89xm and their negations. We know that each variable occurs in at most two clauses (with negation and without negation in total). Your task is to determine whether this CNF is satisfiable, that is, whether there are such values of variables where the CNF value is true. If CNF is satisfiable, then you also need to determine the values of the variables at which the CNF is true. It is guaranteed that each variable occurs at most once in each clause." 2500
571B Minimization dp,greedy,sortings "You\'ve got array A, consisting of n integers and a positive integer k. Array A is indexed by integers from 1 to n.You need to permute the array elements so that value  became minimal possible. In particular, it is allowed not to change order of elements at all." 2000
571A "Lengthening Sticks" combinatorics,implementation,math "You are given three sticks with positive integer lengths of a,\xe2\x80\x89b, and c centimeters. You can increase length of some of them by some positive integer number of centimeters (different sticks can be increased by a different length), but in total by at most l centimeters. In particular, it is allowed not to increase the length of any stick.Determine the number of ways to increase the lengths of some sticks so that you can form from them a non-degenerate (that is, having a positive area) triangle. Two ways are considered different, if the length of some stick is increased by different number of centimeters in them." 2100
570E "Pig and Palindromes" combinatorics,dp "Peppa the Pig was walking and walked into the forest. What a strange coincidence! The forest has the shape of a rectangle, consisting of n rows and m columns. We enumerate the rows of the rectangle from top to bottom with numbers from 1 to n, and the columns \xe2\x80\x94 from left to right with numbers from 1 to m. Let\'s denote the cell at the intersection of the r-th row and the c-th column as (r,\xe2\x80\x89c).Initially the pig stands in cell (1,\xe2\x80\x891), and in the end she wants to be in cell (n,\xe2\x80\x89m). Since the pig is in a hurry to get home, she can go from cell (r,\xe2\x80\x89c), only to either cell (r\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89c) or (r,\xe2\x80\x89c\xe2\x80\x89+\xe2\x80\x891). She cannot leave the forest.The forest, where the pig is, is very unusual. Some cells of the forest similar to each other, and some look very different. Peppa enjoys taking pictures and at every step she takes a picture of the cell where she is now. The path through the forest is considered to be beautiful if photographs taken on her way, can be viewed in both forward and in reverse order, showing the same sequence of photos. More formally, the line formed by the cells in order of visiting should be a palindrome (you can read a formal definition of a palindrome in the previous problem).Count the number of beautiful paths from cell (1,\xe2\x80\x891) to cell (n,\xe2\x80\x89m). Since this number can be very large, determine the remainder after dividing it by 109\xe2\x80\x89+\xe2\x80\x897." 2300
570D "Tree Requests" "binary search,bitmasks,constructive algorithms,dfs and similar,graphs,trees" "Roman planted a tree consisting of n vertices. Each vertex contains a lowercase English letter. Vertex 1 is the root of the tree, each of the n\xe2\x80\x89-\xe2\x80\x891 remaining vertices has a parent in the tree. Vertex is connected with its parent by an edge. The parent of vertex i is vertex pi, the parent index is always less than the index of the vertex (i.e., pi\xe2\x80\x89<\xe2\x80\x89i).The depth of the vertex is the number of nodes on the path from the root to v along the edges. In particular, the depth of the root is equal to 1.We say that vertex u is in the subtree of vertex v, if we can get from u to v, moving from the vertex to the parent. In particular, vertex v is in its subtree.Roma gives you m queries, the i-th of which consists of two numbers vi, hi. Let\'s consider the vertices in the subtree vi located at depth hi. Determine whether you can use the letters written at these vertices to make a string that is a palindrome. The letters that are written in the vertexes, can be rearranged in any order to make a palindrome, but all letters should be used." 2200
570C Replacement "constructive algorithms,data structures,implementation" "Daniel has a string s, consisting of lowercase English letters and period signs (characters \'.\'). Let\'s define the operation of replacement as the following sequence of steps: find a substring "".."" (two consecutive periods) in string s, of all occurrences of the substring let\'s choose the first one, and replace this substring with string ""."". In other words, during the replacement operation, the first two consecutive periods are replaced by one. If string s contains no two consecutive periods, then nothing happens.Let\'s define f(s) as the minimum number of operations of replacement to perform, so that the string does not have any two consecutive periods left.You need to process m queries, the i-th results in that the character at position xi (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89xi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) of string s is assigned value ci. After each operation you have to calculate and output the value of f(s).Help Daniel to process all queries." 1600
570B "Simple Game" "constructive algorithms,games,greedy,implementation,math" "One day Misha and Andrew were playing a very simple game. First, each player chooses an integer in the range from 1 to n. Let\'s assume that Misha chose number m, and Andrew chose number a.Then, by using a random generator they choose a random integer c in the range between 1 and n (any integer from 1 to n is chosen with the same probability), after which the winner is the player, whose number was closer to c. The boys agreed that if m and a are located on the same distance from c, Misha wins.Andrew wants to win very much, so he asks you to help him. You know the number selected by Misha, and number n. You need to determine which value of a Andrew must choose, so that the probability of his victory is the highest possible.More formally, you need to find such integer a (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n), that the probability that  is maximal, where c is the equiprobably chosen integer from 1 to n (inclusive)." 1300
570A Elections implementation "The country of Byalechinsk is running elections involving n candidates. The country consists of m cities. We know how many people in each city voted for each candidate.The electoral system in the country is pretty unusual. At the first stage of elections the votes are counted for each city: it is assumed that in each city won the candidate who got the highest number of votes in this city, and if several candidates got the maximum number of votes, then the winner is the one with a smaller index.At the second stage of elections the winner is determined by the same principle over the cities: the winner of the elections is the candidate who won in the maximum number of cities, and among those who got the maximum number of cities the winner is the one with a smaller index.Determine who will win the elections." 1100
569B Inventory greedy,math "Companies always have a lot of equipment, furniture and other things. All of them should be tracked. To do this, there is an inventory number assigned with each item. It is much easier to create a database by using those numbers and keep the track of everything.During an audit, you were surprised to find out that the items are not numbered sequentially, and some items even share the same inventory number! There is an urgent need to fix it. You have chosen to make the numbers of the items sequential, starting with 1. Changing a number is quite a time-consuming process, and you would like to make maximum use of the current numbering.You have been given information on current inventory numbers for n items in the company. Renumber items so that their inventory numbers form a permutation of numbers from 1 to n by changing the number of as few items as possible. Let us remind you that a set of n numbers forms a permutation if all the numbers are in the range from 1 to n, and no two numbers are equal." 1200
569A Music implementation,math "Little Lesha loves listening to music via his smartphone. But the smartphone doesn\'t have much memory, so Lesha listens to his favorite songs in a well-known social network InTalk.Unfortunately, internet is not that fast in the city of Ekaterinozavodsk and the song takes a lot of time to download. But Lesha is quite impatient. The song\'s duration is T seconds. Lesha downloads the first S seconds of the song and plays it. When the playback reaches the point that has not yet been downloaded, Lesha immediately plays the song from the start (the loaded part of the song stays in his phone, and the download is continued from the same place), and it happens until the song is downloaded completely and Lesha listens to it to the end. For q seconds of real time the Internet allows you to download q\xe2\x80\x89-\xe2\x80\x891 seconds of the track.Tell Lesha, for how many times he will start the song, including the very first start." 1500
568E "Longest Increasing Subsequence" "data structures,dp" "Note that the memory limit in this problem is less than usual.Let\'s consider an array consisting of positive integers, some positions of which contain gaps.We have a collection of numbers that can be used to fill the gaps. Each number from the given collection can be used at most once.Your task is to determine such way of filling gaps that the longest increasing subsequence in the formed array has a maximum size." 3000
568D "Sign Posts" "brute force,geometry,math" "One Khanate had a lot of roads and very little wood. Riding along the roads was inconvenient, because the roads did not have road signs indicating the direction to important cities.The Han decided that it\'s time to fix the issue, and ordered to put signs on every road. The Minister of Transport has to do that, but he has only k signs. Help the minister to solve his problem, otherwise the poor guy can lose not only his position, but also his head.More formally, every road in the Khanate is a line on the Oxy plane, given by an equation of the form Ax\xe2\x80\x89+\xe2\x80\x89By\xe2\x80\x89+\xe2\x80\x89C\xe2\x80\x89=\xe2\x80\x890 (A and B are not equal to 0 at the same time). You are required to determine whether you can put signs in at most k points so that each road had at least one sign installed." 2800
568C "New Language" 2-sat,greedy "Living in Byteland was good enough to begin with, but the good king decided to please his subjects and to introduce a national language. He gathered the best of wise men, and sent an expedition to faraway countries, so that they would find out all about how a language should be designed.After some time, the wise men returned from the trip even wiser. They locked up for six months in the dining room, after which they said to the king: ""there are a lot of different languages, but almost all of them have letters that are divided into vowels and consonants; in a word, vowels and consonants must be combined correctly.""There are very many rules, all of them have exceptions, but our language will be deprived of such defects! We propose to introduce a set of formal rules of combining vowels and consonants, and include in the language all the words that satisfy them.The rules of composing words are: The letters are divided into vowels and consonants in some certain way; All words have a length of exactly n; There are m rules of the form (pos1,\xe2\x80\x89t1,\xe2\x80\x89pos2,\xe2\x80\x89t2). Each rule is: if the position pos1 has a letter of type t1, then the position pos2 has a letter of type t2.You are given some string s of length n, it is not necessarily a correct word of the new language. Among all the words of the language that lexicographically not smaller than the string s, find the minimal one in lexicographic order." 2600
568B "Symmetric and Transitive" combinatorics,dp,math "Little Johnny has recently learned about set theory. Now he is studying binary relations. You\'ve probably heard the term ""equivalence relation"". These relations are very important in many areas of mathematics. For example, the equality of the two numbers is an equivalence relation.A set \xcf\x81 of pairs (a,\xe2\x80\x89b) of elements of some set A is called a binary relation on set A. For two elements a and b of the set A we say that they are in relation \xcf\x81, if pair , in this case we use a notation .Binary relation is equivalence relation, if: It is reflexive (for any a it is true that ); It is symmetric (for any a, b it is true that if , then ); It is transitive (if  and , than ).Little Johnny is not completely a fool and he noticed that the first condition is not necessary! Here is his ""proof"":Take any two elements, a and b. If , then  (according to property (2)), which means  (according to property (3)).It\'s very simple, isn\'t it? However, you noticed that Johnny\'s ""proof"" is wrong, and decided to show him a lot of examples that prove him wrong.Here\'s your task: count the number of binary relations over a set of size n such that they are symmetric, transitive, but not an equivalence relations (i.e. they are not reflexive).Since their number may be very large (not 0, according to Little Johnny), print the remainder of integer division of this number by 109\xe2\x80\x89+\xe2\x80\x897." 1900
568A "Primes or Palindromes?" "brute force,implementation,math,number theory" "Rikhail Mubinchik believes that the current definition of prime numbers is obsolete as they are too complex and unpredictable. A palindromic number is another matter. It is aesthetically pleasing, and it has a number of remarkable properties. Help Rikhail to convince the scientific community in this!Let us remind you that a number is called prime if it is integer larger than one, and is not divisible by any positive integer other than itself and one.Rikhail calls a number a palindromic if it is integer, positive, and its decimal representation without leading zeros is a palindrome, i.e. reads the same from left to right and right to left.One problem with prime numbers is that there are too many of them. Let\'s introduce the following notation: \xcf\x80(n) \xe2\x80\x94 the number of primes no larger than n, rub(n) \xe2\x80\x94 the number of palindromic numbers no larger than n. Rikhail wants to prove that there are a lot more primes than palindromic ones.He asked you to solve the following problem: for a given value of the coefficient A find the maximum n, such that \xcf\x80(n)\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89A\xc2\xb7rub(n)." 1600
567F Mausoleum dp "King of Berland Berl IV has recently died. Hail Berl V! As a sign of the highest achievements of the deceased king the new king decided to build a mausoleum with Berl IV\'s body on the main square of the capital.The mausoleum will be constructed from 2n blocks, each of them has the shape of a cuboid. Each block has the bottom base of a 1\xe2\x80\x89\xc3\x97\xe2\x80\x891 meter square. Among the blocks, exactly two of them have the height of one meter, exactly two have the height of two meters, ..., exactly two have the height of n meters.The blocks are arranged in a row without spacing one after the other. Of course, not every arrangement of blocks has the form of a mausoleum. In order to make the given arrangement in the form of the mausoleum, it is necessary that when you pass along the mausoleum, from one end to the other, the heights of the blocks first were non-decreasing (i.e., increasing or remained the same), and then \xe2\x80\x94 non-increasing (decrease or remained unchanged). It is possible that any of these two areas will be omitted. For example, the following sequences of block height meet this requirement:  [1,\xe2\x80\x892,\xe2\x80\x892,\xe2\x80\x893,\xe2\x80\x894,\xe2\x80\x894,\xe2\x80\x893,\xe2\x80\x891];  [1,\xe2\x80\x891];  [2,\xe2\x80\x892,\xe2\x80\x891,\xe2\x80\x891];  [1,\xe2\x80\x892,\xe2\x80\x893,\xe2\x80\x893,\xe2\x80\x892,\xe2\x80\x891]. Suddenly, k more requirements appeared. Each of the requirements has the form: ""h[xi] signi h[yi]"", where h[t] is the height of the t-th block, and a signi is one of the five possible signs: \'=\' (equals), \'<\' (less than), \'>\' (more than), \'<=\' (less than or equals), \'>=\' (more than or equals). Thus, each of the k additional requirements is given by a pair of indexes xi, yi (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89xi,\xe2\x80\x89yi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x892n) and sign signi.Find the number of possible ways to rearrange the blocks so that both the requirement about the shape of the mausoleum (see paragraph 3) and the k additional requirements were met." 2400
567E "President and Roads" "dfs and similar,graphs,hashing,shortest paths" "Berland has n cities, the capital is located in city s, and the historic home town of the President is in city t (s\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89t). The cities are connected by one-way roads, the travel time for each of the road is a positive integer.Once a year the President visited his historic home town t, for which his motorcade passes along some path from s to t (he always returns on a personal plane). Since the president is a very busy man, he always chooses the path from s to t, along which he will travel the fastest.The ministry of Roads and Railways wants to learn for each of the road: whether the President will definitely pass through it during his travels, and if not, whether it is possible to repair it so that it would definitely be included in the shortest path from the capital to the historic home town of the President. Obviously, the road can not be repaired so that the travel time on it was less than one. The ministry of Berland, like any other, is interested in maintaining the budget, so it wants to know the minimum cost of repairing the road. Also, it is very fond of accuracy, so it repairs the roads so that the travel time on them is always a positive integer." 2200
567D "One-Dimensional Battle Ships" "binary search,data structures,greedy,sortings" "Alice and Bob love playing one-dimensional battle ships. They play on the field in the form of a line consisting of n square cells (that is, on a 1\xe2\x80\x89\xc3\x97\xe2\x80\x89n table).At the beginning of the game Alice puts k ships on the field without telling their positions to Bob. Each ship looks as a 1\xe2\x80\x89\xc3\x97\xe2\x80\x89a rectangle (that is, it occupies a sequence of a consecutive squares of the field). The ships cannot intersect and even touch each other.After that Bob makes a sequence of ""shots"". He names cells of the field and Alice either says that the cell is empty (""miss""), or that the cell belongs to some ship (""hit"").But here\'s the problem! Alice like to cheat. May be that is why she responds to each Bob\'s move with a ""miss"". Help Bob catch Alice cheating \xe2\x80\x94 find Bob\'s first move, such that after it you can be sure that Alice cheated." 1700
567C "Geometric Progression" "binary search,data structures,dp" "Polycarp loves geometric progressions very much. Since he was only three years old, he loves only the progressions of length three. He also has a favorite integer k and a sequence a, consisting of n integers.He wants to know how many subsequences of length three can be selected from a, so that they form a geometric progression with common ratio k.A subsequence of length three is a combination of three such indexes i1,\xe2\x80\x89i2,\xe2\x80\x89i3, that 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i1\xe2\x80\x89<\xe2\x80\x89i2\xe2\x80\x89<\xe2\x80\x89i3\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n. That is, a subsequence of length three are such groups of three elements that are not necessarily consecutive in the sequence, but their indexes are strictly increasing.A geometric progression with common ratio k is a sequence of numbers of the form b\xc2\xb7k0,\xe2\x80\x89b\xc2\xb7k1,\xe2\x80\x89...,\xe2\x80\x89b\xc2\xb7kr\xe2\x80\x89-\xe2\x80\x891.Polycarp is only three years old, so he can not calculate this number himself. Help him to do it." 1700
567B "Berland National Library" implementation "Berland National Library has recently been built in the capital of Berland. In addition, in the library you can take any of the collected works of Berland leaders, the library has a reading room.Today was the pilot launch of an automated reading room visitors\' accounting system! The scanner of the system is installed at the entrance to the reading room. It records the events of the form ""reader entered room"", ""reader left room"". Every reader is assigned a registration number during the registration procedure at the library \xe2\x80\x94 it\'s a unique integer from 1 to 106. Thus, the system logs events of two forms:  ""+ ri"" \xe2\x80\x94 the reader with registration number ri entered the room;  ""- ri"" \xe2\x80\x94 the reader with registration number ri left the room. The first launch of the system was a success, it functioned for some period of time, and, at the time of its launch and at the time of its shutdown, the reading room may already have visitors.Significant funds of the budget of Berland have been spent on the design and installation of the system. Therefore, some of the citizens of the capital now demand to explain the need for this system and the benefits that its implementation will bring. Now, the developers of the system need to urgently come up with reasons for its existence.Help the system developers to find the minimum possible capacity of the reading room (in visitors) using the log of the system available to you." 1300
567A "Lineland Mail" greedy,implementation "All cities of Lineland are located on the Ox coordinate axis. Thus, each city is associated with its position xi \xe2\x80\x94 a coordinate on the Ox axis. No two cities are located at a single point.Lineland residents love to send letters to each other. A person may send a letter only if the recipient lives in another city (because if they live in the same city, then it is easier to drop in).Strange but true, the cost of sending the letter is exactly equal to the distance between the sender\'s city and the recipient\'s city.For each city calculate two values \xe2\x80\x8b\xe2\x80\x8bmini and maxi, where mini is the minimum cost of sending a letter from the i-th city to some other city, and maxi is the the maximum cost of sending a letter from the i-th city to some other city" 900
566G "Max and Min" geometry "Two kittens, Max and Min, play with a pair of non-negative integers x and y. As you can guess from their names, kitten Max loves to maximize and kitten Min loves to minimize. As part of this game Min wants to make sure that both numbers, x and y became negative at the same time, and kitten Max tries to prevent him from doing so.Each kitten has a set of pairs of integers available to it. Kitten Max has n pairs of non-negative integers (ai,\xe2\x80\x89bi) (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n), and kitten Min has m pairs of non-negative integers (cj,\xe2\x80\x89dj) (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m). As kitten Max makes a move, it can take any available pair (ai,\xe2\x80\x89bi) and add ai to x and bi to y, and kitten Min can take any available pair (cj,\xe2\x80\x89dj) and subtract cj from x and dj from y. Each kitten can use each pair multiple times during distinct moves.Max moves first. Kitten Min is winning if at some moment both numbers a, b are negative simultaneously. Otherwise, the winner of the game is kitten Max. Determine which kitten wins if both of them play optimally." 2500
566F "Clique in the Divisibility Graph" "dp,math,number theory" "As you must know, the maximum clique problem in an arbitrary graph is NP-hard. Nevertheless, for some graphs of specific kinds it can be solved effectively.Just in case, let us remind you that a clique in a non-directed graph is a subset of the vertices of a graph, such that any two vertices of this subset are connected by an edge. In particular, an empty set of vertexes and a set consisting of a single vertex, are cliques.Let\'s define a divisibility graph for a set of positive integers A\xe2\x80\x89=\xe2\x80\x89{a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an} as follows. The vertices of the given graph are numbers from set A, and two numbers ai and aj (i\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89j) are connected by an edge if and only if either ai is divisible by aj, or aj is divisible by ai.You are given a set of non-negative integers A. Determine the size of a maximum clique in a divisibility graph for set A." 1500
566E "Restoring Map" "bitmasks,constructive algorithms,trees" "Archaeologists found some information about an ancient land of Treeland. We know for sure that the Treeland consisted of n cities connected by the n\xe2\x80\x89-\xe2\x80\x891 road, such that you can get from each city to any other one along the roads. However, the information about the specific design of roads in Treeland has been lost. The only thing that the archaeologists can use is the preserved information about near cities.Two cities of Treeland were called near, if it were possible to move from one city to the other one by moving through at most two roads. Also, a city is considered near to itself. During the recent excavations archaeologists found a set of n notes, each of them represents a list of cities, near to some of the n cities of the country. However, unfortunately, none of the found records lets you understand in what order the cities go in the list and for which city in the list the near to it cities were listed. Help the archaeologists and restore any variant of the map of Treeland that meets the found information." 3200
566D "Restructuring Company" "data structures,dsu" "Even the most successful company can go through a crisis period when you have to make a hard decision \xe2\x80\x94 to restructure, discard and merge departments, fire employees and do other unpleasant stuff. Let\'s consider the following model of a company.There are n people working for the Large Software Company. Each person belongs to some department. Initially, each person works on his own project in his own department (thus, each company initially consists of n departments, one person in each).However, harsh times have come to the company and the management had to hire a crisis manager who would rebuild the working process in order to boost efficiency. Let\'s use team(person) to represent a team where person person works. A crisis manager can make decisions of two types:  Merge departments team(x) and team(y) into one large department containing all the employees of team(x) and team(y), where x and y (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x,\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) \xe2\x80\x94 are numbers of two of some company employees. If team(x) matches team(y), then nothing happens.  Merge departments team(x),\xe2\x80\x89team(x\xe2\x80\x89+\xe2\x80\x891),\xe2\x80\x89...,\xe2\x80\x89team(y), where x and y (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) \xe2\x80\x94 the numbers of some two employees of the company. At that the crisis manager can sometimes wonder whether employees x and y (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x,\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) work at the same department.Help the crisis manager and answer all of his queries." 1900
566C "Logistical Questions" "dfs and similar,divide and conquer,trees" "Some country consists of n cities, connected by a railroad network. The transport communication of the country is so advanced that the network consists of a minimum required number of (n\xe2\x80\x89-\xe2\x80\x891) bidirectional roads (in the other words, the graph of roads is a tree). The i-th road that directly connects cities ai and bi, has the length of li kilometers.The transport network is served by a state transporting company FRR (Fabulous Rail Roads). In order to simplify the price policy, it offers a single ride fare on the train. In order to follow the route of length t kilometers, you need to pay  burles. Note that it is forbidden to split a long route into short segments and pay them separately (a special railroad police, or RRP, controls that the law doesn\'t get violated).A Large Software Company decided to organize a programming tournament. Having conducted several online rounds, the company employees determined a list of finalists and sent it to the logistical department to find a place where to conduct finals. The Large Software Company can easily organize the tournament finals in any of the n cities of the country, so the the main factor in choosing the city for the last stage of the tournament is the total cost of buying tickets for all the finalists. We know that the i-th city of the country has wi cup finalists living there.Help the company employees find the city such that the total cost of travel of all the participants to it is minimum." 3000
566B "Replicating Processes" "constructive algorithms,greedy" "A Large Software Company develops its own social network. Analysts have found that during the holidays, major sporting events and other significant events users begin to enter the network more frequently, resulting in great load increase on the infrastructure.As part of this task, we assume that the social network is 4n processes running on the n servers. All servers are absolutely identical machines, each of which has a volume of RAM of 1 GB = 1024 MB (1). Each process takes 100 MB of RAM on the server. At the same time, the needs of maintaining the viability of the server takes about 100 more megabytes of RAM. Thus, each server may have up to 9 different processes of social network.Now each of the n servers is running exactly 4 processes. However, at the moment of peak load it is sometimes necessary to replicate the existing 4n processes by creating 8n new processes instead of the old ones. More formally, there is a set of replication rules, the i-th (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x894n) of which has the form of ai\xe2\x80\x89\xe2\x86\x92\xe2\x80\x89(bi,\xe2\x80\x89ci), where ai, bi and ci (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ai,\xe2\x80\x89bi,\xe2\x80\x89ci\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) are the numbers of servers. This means that instead of an old process running on server ai, there should appear two new copies of the process running on servers bi and ci. The two new replicated processes can be on the same server (i.e., bi may be equal to ci) or even on the same server where the original process was (i.e. ai may be equal to bi or ci). During the implementation of the rule ai\xe2\x80\x89\xe2\x86\x92\xe2\x80\x89(bi,\xe2\x80\x89ci) first the process from the server ai is destroyed, then appears a process on the server bi, then appears a process on the server ci.There is a set of 4n rules, destroying all the original 4n processes from n servers, and creating after their application 8n replicated processes, besides, on each of the n servers will be exactly 8 processes. However, the rules can only be applied consecutively, and therefore the amount of RAM of the servers imposes limitations on the procedure for the application of the rules.According to this set of rules determine the order in which you want to apply all the 4n rules so that at any given time the memory of each of the servers contained at most 9 processes (old and new together), or tell that it is impossible." 2600
566A "Matching Names" "dfs and similar,strings,trees" "Teachers of one programming summer school decided to make a surprise for the students by giving them names in the style of the ""Hobbit"" movie. Each student must get a pseudonym maximally similar to his own name. The pseudonym must be a name of some character of the popular saga and now the teachers are busy matching pseudonyms to student names.There are n students in a summer school. Teachers chose exactly n pseudonyms for them. Each student must get exactly one pseudonym corresponding to him. Let us determine the relevance of a pseudonym b to a student with name a as the length of the largest common prefix a and b. We will represent such value as . Then we can determine the quality of matching of the pseudonyms to students as a sum of relevances of all pseudonyms to the corresponding students.Find the matching between students and pseudonyms with the maximum quality." 2300
560B "Gerald is into Art" "constructive algorithms,implementation" "Gerald bought two very rare paintings at the Sotheby\'s auction and he now wants to hang them on the wall. For that he bought a special board to attach it to the wall and place the paintings on the board. The board has shape of an a1\xe2\x80\x89\xc3\x97\xe2\x80\x89b1 rectangle, the paintings have shape of a a2\xe2\x80\x89\xc3\x97\xe2\x80\x89b2 and a3\xe2\x80\x89\xc3\x97\xe2\x80\x89b3 rectangles.Since the paintings are painted in the style of abstract art, it does not matter exactly how they will be rotated, but still, one side of both the board, and each of the paintings must be parallel to the floor. The paintings can touch each other and the edges of the board, but can not overlap or go beyond the edge of the board. Gerald asks whether it is possible to place the paintings on the board, or is the board he bought not large enough?" 1200
560A "Currency System in Geraldion" implementation,sortings "A magic island Geraldion, where Gerald lives, has its own currency system. It uses banknotes of several values. But the problem is, the system is not perfect and sometimes it happens that Geraldionians cannot express a certain sum of money with any set of banknotes. Of course, they can use any number of banknotes of each value. Such sum is called unfortunate. Gerald wondered: what is the minimum unfortunate sum?" 1000
559E "Gerald and Path" dp,sortings "The main walking trail in Geraldion is absolutely straight, and it passes strictly from the north to the south, it is so long that no one has ever reached its ends in either of the two directions. The Geraldionians love to walk on this path at any time, so the mayor of the city asked the Herald to illuminate this path with a few spotlights. The spotlights have already been delivered to certain places and Gerald will not be able to move them. Each spotlight illuminates a specific segment of the path of the given length, one end of the segment is the location of the spotlight, and it can be directed so that it covers the segment to the south or to the north of spotlight.The trail contains a monument to the mayor of the island, and although you can walk in either directions from the monument, no spotlight is south of the monument.You are given the positions of the spotlights and their power. Help Gerald direct all the spotlights so that the total length of the illuminated part of the path is as much as possible." 3000
559D Randomizer combinatorics,geometry,probabilities "Gerald got tired of playing board games with the usual six-sided die, and he bought a toy called Randomizer. It functions as follows.A Randomizer has its own coordinate plane on which a strictly convex polygon is painted, the polygon is called a basic polygon. If you shake a Randomizer, it draws some nondegenerate (i.e. having a non-zero area) convex polygon with vertices at some vertices of the basic polygon. The result of the roll (more precisely, the result of the shaking) is considered to be the number of points with integer coordinates, which were strictly inside (the points on the border are not considered) the selected polygon. Now Gerald is wondering: what is the expected result of shaking the Randomizer?During the shaking the Randomizer considers all the possible non-degenerate convex polygons with vertices at the vertices of the basic polygon. Let\'s assume that there are k versions of the polygons. Then the Randomizer chooses each of them with probability ." 2800
559C "Gerald and Giant Chess" "combinatorics,dp,math,number theory" "Giant chess is quite common in Geraldion. We will not delve into the rules of the game, we\'ll just say that the game takes place on an h\xe2\x80\x89\xc3\x97\xe2\x80\x89w field, and it is painted in two colors, but not like in chess. Almost all cells of the field are white and only some of them are black. Currently Gerald is finishing a game of giant chess against his friend Pollard. Gerald has almost won, and the only thing he needs to win is to bring the pawn from the upper left corner of the board, where it is now standing, to the lower right corner. Gerald is so confident of victory that he became interested, in how many ways can he win?The pawn, which Gerald has got left can go in two ways: one cell down or one cell to the right. In addition, it can not go to the black cells, otherwise the Gerald still loses. There are no other pawns or pieces left on the field, so that, according to the rules of giant chess Gerald moves his pawn until the game is over, and Pollard is just watching this process." 2200
559B "Equivalent Strings" "divide and conquer,hashing,sortings,strings" "Today on a lecture about strings Gerald learned a new definition of string equivalency. Two strings a and b of equal length are called equivalent in one of the two cases:   They are equal.  If we split string a into two halves of the same size a1 and a2, and string b into two halves of the same size b1 and b2, then one of the following is correct:   a1 is equivalent to b1, and a2 is equivalent to b2  a1 is equivalent to b2, and a2 is equivalent to b1  As a home task, the teacher gave two strings to his students and asked to determine if they are equivalent.Gerald has already completed this home task. Now it\'s your turn!" 1700
559A "Gerald\'s Hexagon" "brute force,geometry,math" "Gerald got a very curious hexagon for his birthday. The boy found out that all the angles of the hexagon are equal to . Then he measured the length of its sides, and found that each of them is equal to an integer number of centimeters. There the properties of the hexagon ended and Gerald decided to draw on it.He painted a few lines, parallel to the sides of the hexagon. The lines split the hexagon into regular triangles with sides of 1 centimeter. Now Gerald wonders how many triangles he has got. But there were so many of them that Gerald lost the track of his counting. Help the boy count the triangles." 1600
558E "A Simple Task" "data structures,sortings,strings" "This task is very simple. Given a string S of length n and q queries each query is on the format i j k which means sort the substring consisting of the characters from i to j in non-decreasing order if k\xe2\x80\x89=\xe2\x80\x891 or in non-increasing order if k\xe2\x80\x89=\xe2\x80\x890.Output the final string after applying the queries." 2300
558D "Guess Your Way Out! II" "data structures,implementation,sortings" "Amr bought a new video game ""Guess Your Way Out! II"". The goal of the game is to find an exit from the maze that looks like a perfect binary tree of height h. The player is initially standing at the root of the tree and the exit from the tree is located at some leaf node.Let\'s index all the nodes of the tree such that   The root is number 1  Each internal node i (i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x892h\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89-\xe2\x80\x891) will have a left child with index = 2i and a right child with index = 2i\xe2\x80\x89+\xe2\x80\x891 The level of a node is defined as 1 for a root, or 1 + level of parent of the node otherwise. The vertices of the level h are called leaves. The exit to the maze is located at some leaf node n, the player doesn\'t know where the exit is so he has to guess his way out! In the new version of the game the player is allowed to ask questions on the format ""Does the ancestor(exit,\xe2\x80\x89i) node number belong to the range [L,\xe2\x80\x89R]?"". Here ancestor(v,\xe2\x80\x89i) is the ancestor of a node v that located in the level i. The game will answer with ""Yes"" or ""No"" only. The game is designed such that it doesn\'t always answer correctly, and sometimes it cheats to confuse the player!.Amr asked a lot of questions and got confused by all these answers, so he asked you to help him. Given the questions and its answers, can you identify whether the game is telling contradictory information or not? If the information is not contradictory and the exit node can be determined uniquely, output its number. If the information is not contradictory, but the exit node isn\'t defined uniquely, output that the number of questions is not sufficient. Otherwise output that the information is contradictory." 2300
558C "Amr and Chemistry" "brute force,graphs,greedy,math,shortest paths" "Amr loves Chemistry, and specially doing experiments. He is preparing for a new interesting experiment.Amr has n different types of chemicals. Each chemical i has an initial volume of ai liters. For this experiment, Amr has to mix all the chemicals together, but all the chemicals volumes must be equal first. So his task is to make all the chemicals volumes equal.To do this, Amr can do two different kind of operations.   Choose some chemical i and double its current volume so the new volume will be 2ai  Choose some chemical i and divide its volume by two (integer division) so the new volume will be  Suppose that each chemical is contained in a vessel of infinite volume. Now Amr wonders what is the minimum number of operations required to make all the chemicals volumes equal?" 1900
558B "Amr and The Large Array" implementation "Amr has got a large array of size n. Amr doesn\'t like large arrays so he intends to make it smaller.Amr doesn\'t care about anything in the array except the beauty of it. The beauty of the array is defined to be the maximum number of times that some number occurs in this array. He wants to choose the smallest subsegment of this array such that the beauty of it will be the same as the original array.Help Amr by choosing the smallest subsegment possible." 1300
558A "Lala Land and Apple Trees" "brute force,implementation,sortings" "Amr lives in Lala Land. Lala Land is a very beautiful country that is located on a coordinate line. Lala Land is famous with its apple trees growing everywhere.Lala Land has exactly n apple trees. Tree number i is located in a position xi and has ai apples growing on it. Amr wants to collect apples from the apple trees. Amr currently stands in x\xe2\x80\x89=\xe2\x80\x890 position. At the beginning, he can choose whether to go right or left. He\'ll continue in his direction until he meets an apple tree he didn\'t visit before. He\'ll take all of its apples and then reverse his direction, continue walking in this direction until he meets another apple tree he didn\'t visit before and so on. In the other words, Amr reverses his direction when visiting each new apple tree. Amr will stop collecting apples when there are no more trees he didn\'t visit in the direction he is facing.What is the maximum number of apples he can collect?" 1100
557E "Ann and Half-Palindrome" "data structures,dp,graphs,string suffix structures,strings,trees" "Tomorrow Ann takes the hardest exam of programming where she should get an excellent mark. On the last theoretical class the teacher introduced the notion of a half-palindrome. String t is a half-palindrome, if for all the odd positions i () the following condition is held: ti\xe2\x80\x89=\xe2\x80\x89t|t|\xe2\x80\x89-\xe2\x80\x89i\xe2\x80\x89+\xe2\x80\x891, where |t| is the length of string t if positions are indexed from 1. For example, strings ""abaa"", ""a"", ""bb"", ""abbbaa"" are half-palindromes and strings ""ab"", ""bba"" and ""aaabaa"" are not.Ann knows that on the exam she will get string s, consisting only of letters a and b, and number k. To get an excellent mark she has to find the k-th in the lexicographical order string among all substrings of s that are half-palyndromes. Note that each substring in this order is considered as many times as many times it occurs in s.The teachers guarantees that the given number k doesn\'t exceed the number of substrings of the given string that are half-palindromes.Can you cope with this problem?" 2300
557D "Vitaly and Cycle" "combinatorics,dfs and similar,graphs,math" "After Vitaly was expelled from the university, he became interested in the graph theory.Vitaly especially liked the cycles of an odd length in which each vertex occurs at most once.Vitaly was wondering how to solve the following problem. You are given an undirected graph consisting of n vertices and m edges, not necessarily connected, without parallel edges and loops. You need to find t \xe2\x80\x94 the minimum number of edges that must be added to the given graph in order to form a simple cycle of an odd length, consisting of more than one vertex. Moreover, he must find w \xe2\x80\x94 the number of ways to add t edges in order to form a cycle of an odd length (consisting of more than one vertex). It is prohibited to add loops or parallel edges.Two ways to add edges to the graph are considered equal if they have the same sets of added edges.Since Vitaly does not study at the university, he asked you to help him with this task." 2000
557C "Arthur and Table" "brute force,data structures,dp,greedy,math,sortings" "Arthur has bought a beautiful big table into his new flat. When he came home, Arthur noticed that the new table is unstable.In total the table Arthur bought has n legs, the length of the i-th leg is li.Arthur decided to make the table stable and remove some legs. For each of them Arthur determined number di \xe2\x80\x94 the amount of energy that he spends to remove the i-th leg.A table with k legs is assumed to be stable if there are more than half legs of the maximum length. For example, to make a table with 5 legs stable, you need to make sure it has at least three (out of these five) legs of the maximum length. Also, a table with one leg is always stable and a table with two legs is stable if and only if they have the same lengths.Your task is to help Arthur and count the minimum number of energy units Arthur should spend on making the table stable." 1900
557B "Pasha and Tea" "constructive algorithms,implementation,math,sortings" "Pasha decided to invite his friends to a tea party. For that occasion, he has a large teapot with the capacity of w milliliters and 2n tea cups, each cup is for one of Pasha\'s friends. The i-th cup can hold at most ai milliliters of water.It turned out that among Pasha\'s friends there are exactly n boys and exactly n girls and all of them are going to come to the tea party. To please everyone, Pasha decided to pour the water for the tea as follows:  Pasha can boil the teapot exactly once by pouring there at most w milliliters of water;  Pasha pours the same amount of water to each girl;  Pasha pours the same amount of water to each boy;  if each girl gets x milliliters of water, then each boy gets 2x milliliters of water. In the other words, each boy should get two times more water than each girl does.Pasha is very kind and polite, so he wants to maximize the total amount of the water that he pours to his friends. Your task is to help him and determine the optimum distribution of cups between Pasha\'s friends." 1500
557A "Ilya and Diplomas" greedy,implementation,math "Soon a school Olympiad in Informatics will be held in Berland, n schoolchildren will participate there.At a meeting of the jury of the Olympiad it was decided that each of the n participants, depending on the results, will get a diploma of the first, second or third degree. Thus, each student will receive exactly one diploma.They also decided that there must be given at least min1 and at most max1 diplomas of the first degree, at least min2 and at most max2 diplomas of the second degree, and at least min3 and at most max3 diplomas of the third degree.After some discussion it was decided to choose from all the options of distributing diplomas satisfying these limitations the one that maximizes the number of participants who receive diplomas of the first degree. Of all these options they select the one which maximizes the number of the participants who receive diplomas of the second degree. If there are multiple of these options, they select the option that maximizes the number of diplomas of the third degree.Choosing the best option of distributing certificates was entrusted to Ilya, one of the best programmers of Berland. However, he found more important things to do, so it is your task now to choose the best option of distributing of diplomas, based on the described limitations.It is guaranteed that the described limitations are such that there is a way to choose such an option of distributing diplomas that all n participants of the Olympiad will receive a diploma of some degree." 1100
556B "Case of Fake Numbers" "brute force,implementation" "Andrewid the Android is a galaxy-famous detective. He is now investigating a case of frauds who make fake copies of the famous Stolp\'s gears, puzzles that are as famous as the Rubik\'s cube once was.Its most important components are a button and a line of n similar gears. Each gear has n teeth containing all numbers from 0 to n\xe2\x80\x89-\xe2\x80\x891 in the counter-clockwise order. When you push a button, the first gear rotates clockwise, then the second gear rotates counter-clockwise, the the third gear rotates clockwise an so on.Besides, each gear has exactly one active tooth. When a gear turns, a new active tooth is the one following after the current active tooth according to the direction of the rotation. For example, if n\xe2\x80\x89=\xe2\x80\x895, and the active tooth is the one containing number 0, then clockwise rotation makes the tooth with number 1 active, or the counter-clockwise rotating makes the tooth number 4 active.Andrewid remembers that the real puzzle has the following property: you can push the button multiple times in such a way that in the end the numbers on the active teeth of the gears from first to last form sequence 0,\xe2\x80\x891,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x891. Write a program that determines whether the given puzzle is real or fake." 1100
556A "Case of the Zeros and Ones" greedy "Andrewid the Android is a galaxy-famous detective. In his free time he likes to think about strings containing zeros and ones.Once he thought about a string of length n consisting of zeroes and ones. Consider the following operation: we choose any two adjacent positions in the string, and if one them contains 0, and the other contains 1, then we are allowed to remove these two digits from the string, obtaining a string of length n\xe2\x80\x89-\xe2\x80\x892 as a result.Now Andreid thinks about what is the minimum length of the string that can remain after applying the described operation several times (possibly, zero)? Help him to calculate this number." 900
555E "Case of Computer Network" "dfs and similar,graphs,trees" "Andrewid the Android is a galaxy-known detective. Now he is preparing a defense against a possible attack by hackers on a major computer network.In this network are n vertices, some pairs of vertices are connected by m undirected channels. It is planned to transfer q important messages via this network, the i-th of which must be sent from vertex si to vertex di via one or more channels, perhaps through some intermediate vertices.To protect against attacks a special algorithm was developed. Unfortunately it can be applied only to the network containing directed channels. Therefore, as new channels can\'t be created, it was decided for each of the existing undirected channels to enable them to transmit data only in one of the two directions.Your task is to determine whether it is possible so to choose the direction for each channel so that each of the q messages could be successfully transmitted." 2800
555D "Case of a Top Secret" "binary search,implementation,math" "Andrewid the Android is a galaxy-famous detective. Now he is busy with a top secret case, the details of which are not subject to disclosure.However, he needs help conducting one of the investigative experiment. There are n pegs put on a plane, they are numbered from 1 to n, the coordinates of the i-th of them are (xi,\xe2\x80\x890). Then, we tie to the bottom of one of the pegs a weight on a tight rope of length l (thus, its coordinates will be equal to (xi,\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x89l), where i is the number of the used peg). Then the weight is pushed to the right, so that it starts to rotate counterclockwise. At the same time, if the weight during rotation touches some of the other pegs, it then begins to rotate around that peg. Suppose that each peg itself is very thin and does not affect the rope length while weight is rotating around it.  More formally, if at some moment the segment of the rope contains one or more pegs in addition to the peg around which the weight is rotating, the weight will then rotate around the farthermost one of them on a shorter segment of a rope. In particular, if the segment of the rope touches some peg by its endpoint, it is considered that the weight starts to rotate around that peg on a segment of the rope of length 0.At some moment the weight will begin to rotate around some peg, without affecting the rest of the pegs. Andrewid interested in determining the number of this peg.Andrewid prepared m queries containing initial conditions for pushing the weight, help him to determine for each of them, around what peg the weight will eventually rotate." 2500
555C "Case of Chocolate" "data structures" "Andrewid the Android is a galaxy-known detective. Now he does not investigate any case and is eating chocolate out of boredom.A bar of chocolate can be presented as an n\xe2\x80\x89\xc3\x97\xe2\x80\x89n table, where each cell represents one piece of chocolate. The columns of the table are numbered from 1 to n from left to right and the rows are numbered from top to bottom. Let\'s call the anti-diagonal to be a diagonal that goes the lower left corner to the upper right corner of the table. First Andrewid eats all the pieces lying below the anti-diagonal. Then he performs the following q actions with the remaining triangular part: first, he chooses a piece on the anti-diagonal and either direction \'up\' or \'left\', and then he begins to eat all the pieces starting from the selected cell, moving in the selected direction until he reaches the already eaten piece or chocolate bar edge.After each action, he wants to know how many pieces he ate as a result of this action." 2200
555B "Case of Fugitive" "data structures,greedy,sortings" "Andrewid the Android is a galaxy-famous detective. He is now chasing a criminal hiding on the planet Oxa-5, the planet almost fully covered with water.The only dry land there is an archipelago of n narrow islands located in a row. For more comfort let\'s represent them as non-intersecting segments on a straight line: island i has coordinates [li,\xe2\x80\x89ri], besides, ri\xe2\x80\x89<\xe2\x80\x89li\xe2\x80\x89+\xe2\x80\x891 for 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x891.To reach the goal, Andrewid needs to place a bridge between each pair of adjacent islands. A bridge of length a can be placed between the i-th and the (i\xe2\x80\x89+\xe2\x80\x891)-th islads, if there are such coordinates of x and y, that li\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ri, li\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ri\xe2\x80\x89+\xe2\x80\x891 and y\xe2\x80\x89-\xe2\x80\x89x\xe2\x80\x89=\xe2\x80\x89a. The detective was supplied with m bridges, each bridge can be used at most once. Help him determine whether the bridges he got are enough to connect each pair of adjacent islands." 2000
555A "Case of Matryoshkas" implementation "Andrewid the Android is a galaxy-famous detective. He is now investigating the case of vandalism at the exhibition of contemporary art.The main exhibit is a construction of n matryoshka dolls that can be nested one into another. The matryoshka dolls are numbered from 1 to n. A matryoshka with a smaller number can be nested in a matryoshka with a higher number, two matryoshkas can not be directly nested in the same doll, but there may be chain nestings, for example, 1\xe2\x80\x89\xe2\x86\x92\xe2\x80\x892\xe2\x80\x89\xe2\x86\x92\xe2\x80\x894\xe2\x80\x89\xe2\x86\x92\xe2\x80\x895. In one second, you can perform one of the two following operations:  Having a matryoshka a that isn\'t nested in any other matryoshka and a matryoshka b, such that b doesn\'t contain any other matryoshka and is not nested in any other matryoshka, you may put a in b;  Having a matryoshka a directly contained in matryoshka b, such that b is not nested in any other matryoshka, you may get a out of b. According to the modern aesthetic norms the matryoshka dolls on display were assembled in a specific configuration, i.e. as several separate chains of nested matryoshkas, but the criminal, following the mysterious plan, took out all the dolls and assembled them into a single large chain (1\xe2\x80\x89\xe2\x86\x92\xe2\x80\x892\xe2\x80\x89\xe2\x86\x92\xe2\x80\x89...\xe2\x80\x89\xe2\x86\x92\xe2\x80\x89n). In order to continue the investigation Andrewid needs to know in what minimum time it is possible to perform this action." 1500
554B "Ohana Cleans Up" "brute force,greedy,strings" "Ohana Matsumae is trying to clean a room, which is divided up into an n by n grid of squares. Each square is initially either clean or dirty. Ohana can sweep her broom over columns of the grid. Her broom is very strange: if she sweeps over a clean square, it will become dirty, and if she sweeps over a dirty square, it will become clean. She wants to sweep some columns of the room to maximize the number of rows that are completely clean. It is not allowed to sweep over the part of the column, Ohana can only sweep the whole column.Return the maximum number of rows that she can make completely clean." 1200
554A "Kyoya and Photobooks" "brute force,math,strings" "Kyoya Ootori is selling photobooks of the Ouran High School Host Club. He has 26 photos, labeled ""a"" to ""z"", and he has compiled them into a photo booklet with some photos in some order (possibly with some photos being duplicated). A photo booklet can be described as a string of lowercase letters, consisting of the photos in the booklet in order. He now wants to sell some ""special edition"" photobooks, each with one extra photo inserted anywhere in the book. He wants to make as many distinct photobooks as possible, so he can make more money. He asks Haruhi, how many distinct photobooks can he make by inserting one extra photo into the photobook he already has?Please help Haruhi solve this problem." 900
553E "Kyoya and Train" dp,fft,graphs,math,probabilities "Kyoya Ootori wants to take the train to get to school. There are n train stations and m one-way train lines going between various stations. Kyoya is currently at train station 1, and the school is at station n. To take a train, he must pay for a ticket, and the train also takes a certain amount of time. However, the trains are not perfect and take random amounts of time to arrive at their destination. If Kyoya arrives at school strictly after t time units, he will have to pay a fine of x.Each train line is described by a ticket price, and a probability distribution on the time the train takes. More formally, train line i has ticket cost ci, and a probability distribution pi,\xe2\x80\x89k which denotes the probability that this train will take k time units for all 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89t. Amounts of time that each of the trains used by Kyouya takes are mutually independent random values (moreover, if Kyoya travels along the same train more than once, it is possible for the train to take different amounts of time and those amounts are also independent one from another). Kyoya wants to get to school by spending the least amount of money in expectation (for the ticket price plus possible fine for being late). Of course, Kyoya has an optimal plan for how to get to school, and every time he arrives at a train station, he may recalculate his plan based on how much time he has remaining. What is the expected cost that Kyoya will pay to get to school if he moves optimally?" 3200
553D "Nudist Beach" "binary search,graphs,greedy" "Nudist Beach is planning a military operation to attack the Life Fibers. In this operation, they will attack and capture several cities which are currently under the control of the Life Fibers.There are n cities, labeled from 1 to n, and m bidirectional roads between them. Currently, there are Life Fibers in every city. In addition, there are k cities that are fortresses of the Life Fibers that cannot be captured under any circumstances. So, the Nudist Beach can capture an arbitrary non-empty subset of cities with no fortresses.After the operation, Nudist Beach will have to defend the captured cities from counterattack. If they capture a city and it is connected to many Life Fiber controlled cities, it will be easily defeated. So, Nudist Beach would like to capture a set of cities such that for each captured city the ratio of Nudist Beach controlled neighbors among all neighbors of that city is as high as possible. More formally, they would like to capture a non-empty set of cities S with no fortresses of Life Fibers. The strength of a city  is defined as (number of neighbors of x in S) / (total number of neighbors of x). Here, two cities are called neighbors if they are connnected with a road. The goal is to maximize the strength of the weakest city in S.Given a description of the graph, and the cities with fortresses, find a non-empty subset that maximizes the strength of the weakest city." 2300
553C "Love Triangles" "dfs and similar,dsu,graphs" "There are many anime that are about ""love triangles"": Alice loves Bob, and Charlie loves Bob as well, but Alice hates Charlie. You are thinking about an anime which has n characters. The characters are labeled from 1 to n. Every pair of two characters can either mutually love each other or mutually hate each other (there is no neutral state).You hate love triangles (A-B are in love and B-C are in love, but A-C hate each other), and you also hate it when nobody is in love. So, considering any three characters, you will be happy if exactly one pair is in love (A and B love each other, and C hates both A and B), or if all three pairs are in love (A loves B, B loves C, C loves A).You are given a list of m known relationships in the anime. You know for sure that certain pairs love each other, and certain pairs hate each other. You\'re wondering how many ways you can fill in the remaining relationships so you are happy with every triangle. Two ways are considered different if two characters are in love in one way but hate each other in the other. Print this count modulo 1\xe2\x80\x89000\xe2\x80\x89000\xe2\x80\x89007." 2200
553B "Kyoya and Permutation" "binary search,combinatorics,constructive algorithms,greedy,implementation,math" "Let\'s define the permutation of length n as an array p\xe2\x80\x89=\xe2\x80\x89[p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pn] consisting of n distinct integers from range from 1 to n. We say that this permutation maps value 1 into the value p1, value 2 into the value p2 and so on.Kyota Ootori has just learned about cyclic representation of a permutation. A cycle is a sequence of numbers such that each element of this sequence is being mapped into the next element of this sequence (and the last element of the cycle is being mapped into the first element of the cycle). The cyclic representation is a representation of p as a collection of cycles forming p. For example, permutation p\xe2\x80\x89=\xe2\x80\x89[4,\xe2\x80\x891,\xe2\x80\x896,\xe2\x80\x892,\xe2\x80\x895,\xe2\x80\x893] has a cyclic representation that looks like (142)(36)(5) because 1 is replaced by 4, 4 is replaced by 2, 2 is replaced by 1, 3 and 6 are swapped, and 5 remains in place. Permutation may have several cyclic representations, so Kyoya defines the standard cyclic representation of a permutation as follows. First, reorder the elements within each cycle so the largest element is first. Then, reorder all of the cycles so they are sorted by their first element. For our example above, the standard cyclic representation of [4,\xe2\x80\x891,\xe2\x80\x896,\xe2\x80\x892,\xe2\x80\x895,\xe2\x80\x893] is (421)(5)(63).Now, Kyoya notices that if we drop the parenthesis in the standard cyclic representation, we get another permutation! For instance, [4,\xe2\x80\x891,\xe2\x80\x896,\xe2\x80\x892,\xe2\x80\x895,\xe2\x80\x893] will become [4,\xe2\x80\x892,\xe2\x80\x891,\xe2\x80\x895,\xe2\x80\x896,\xe2\x80\x893].Kyoya notices that some permutations don\'t change after applying operation described above at all. He wrote all permutations of length n that do not change in a list in lexicographic order. Unfortunately, his friend Tamaki Suoh lost this list. Kyoya wishes to reproduce the list and he needs your help. Given the integers n and k, print the permutation that was k-th on Kyoya\'s list." 1900
553A "Kyoya and Colored Balls" combinatorics,dp,math "Kyoya Ootori has a bag with n colored balls that are colored with k different colors. The colors are labeled from 1 to k. Balls of the same color are indistinguishable. He draws balls from the bag one by one until the bag is empty. He noticed that he drew the last ball of color i before drawing the last ball of color i\xe2\x80\x89+\xe2\x80\x891 for all i from 1 to k\xe2\x80\x89-\xe2\x80\x891. Now he wonders how many different ways this can happen." 1500
552E "Vanya and Brackets" "brute force,dp,expression parsing,greedy,implementation,strings" "Vanya is doing his maths homework. He has an expression of form , where x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xn are digits from 1 to 9, and sign  represents either a plus \'+\' or the multiplication sign \'*\'. Vanya needs to add one pair of brackets in this expression so that to maximize the value of the resulting expression." 2100
552D "Vanya and Triangles" "brute force,combinatorics,data structures,geometry,math,sortings" "Vanya got bored and he painted n distinct points on the plane. After that he connected all the points pairwise and saw that as a result many triangles were formed with vertices in the painted points. He asks you to count the number of the formed triangles with the non-zero area." 1900
552C "Vanya and Scales" "brute force,dp,greedy,math,meet-in-the-middle,number theory" "Vanya has a scales for weighing loads and weights of masses w0,\xe2\x80\x89w1,\xe2\x80\x89w2,\xe2\x80\x89...,\xe2\x80\x89w100 grams where w is some integer not less than 2 (exactly one weight of each nominal value). Vanya wonders whether he can weight an item with mass m using the given weights, if the weights can be put on both pans of the scales. Formally speaking, your task is to determine whether it is possible to place an item of mass m and some weights on the left pan of the scales, and some weights on the right pan of the scales so that the pans of the scales were in balance." 1900
552B "Vanya and Books" implementation,math "Vanya got an important task \xe2\x80\x94 he should enumerate books in the library and label each book with its number. Each of the n books should be assigned with a number from 1 to n. Naturally, distinct books should be assigned distinct numbers.Vanya wants to know how many digits he will have to write down as he labels the books." 1200
552A "Vanya and Table" implementation,math "Vanya has a table consisting of 100 rows, each row contains 100 cells. The rows are numbered by integers from 1 to 100 from bottom to top, the columns are numbered from 1 to 100 from left to right. In this table, Vanya chose n rectangles with sides that go along borders of squares (some rectangles probably occur multiple times). After that for each cell of the table he counted the number of rectangles it belongs to and wrote this number into it. Now he wants to find the sum of values in all cells of the table and as the table is too large, he asks you to help him find the result." 1000
551E "GukiZ and GukiZiana" "binary search,data structures,implementation" "Professor GukiZ was playing with arrays again and accidentally discovered new function, which he called GukiZiana. For given array a, indexed with integers from 1 to n, and number y, GukiZiana(a,\xe2\x80\x89y) represents maximum value of j\xe2\x80\x89-\xe2\x80\x89i, such that aj\xe2\x80\x89=\xe2\x80\x89ai\xe2\x80\x89=\xe2\x80\x89y. If there is no y as an element in a, then GukiZiana(a,\xe2\x80\x89y) is equal to \xe2\x80\x89-\xe2\x80\x891. GukiZ also prepared a problem for you. This time, you have two types of queries:   First type has form 1 l r x and asks you to increase values of all ai such that l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r by the non-negative integer x.  Second type has form 2 y and asks you to find value of GukiZiana(a,\xe2\x80\x89y). For each query of type 2, print the answer and make GukiZ happy!" 2500
551D "GukiZ and Binary Operations" "combinatorics,implementation,math,matrices,number theory" "We all know that GukiZ often plays with arrays. Now he is thinking about this problem: how many arrays a, of length n, with non-negative elements strictly less then 2l meet the following condition: ? Here operation  means bitwise AND (in Pascal it is equivalent to and, in C/C++/Java/Python it is equivalent to &), operation  means bitwise OR (in Pascal it is equivalent to , in C/C++/Java/Python it is equivalent to |). Because the answer can be quite large, calculate it modulo m. This time GukiZ hasn\'t come up with solution, and needs you to help him!" 2100
551C "GukiZ hates Boxes" "binary search,greedy" "Professor GukiZ is concerned about making his way to school, because massive piles of boxes are blocking his way. In total there are n piles of boxes, arranged in a line, from left to right, i-th pile (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) containing ai boxes. Luckily, m students are willing to help GukiZ by removing all the boxes from his way. Students are working simultaneously. At time 0, all students are located left of the first pile. It takes one second for every student to move from this position to the first pile, and after that, every student must start performing sequence of two possible operations, each taking one second to complete. Possible operations are: If i\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89n, move from pile i to pile i\xe2\x80\x89+\xe2\x80\x891; If pile located at the position of student is not empty, remove one box from it.GukiZ\'s students aren\'t smart at all, so they need you to tell them how to remove boxes before professor comes (he is very impatient man, and doesn\'t want to wait). They ask you to calculate minumum time t in seconds for which they can remove all the boxes from GukiZ\'s way. Note that students can be positioned in any manner after t seconds, but all the boxes must be removed." 2200
551B ZgukistringZ "brute force,constructive algorithms,implementation,strings" "Professor GukiZ doesn\'t accept string as they are. He likes to swap some letters in string to obtain a new one.GukiZ has strings a, b, and c. He wants to obtain string k by swapping some letters in a, so that k should contain as many non-overlapping substrings equal either to b or c as possible. Substring of string x is a string formed by consecutive segment of characters from x. Two substrings of string x overlap if there is position i in string x occupied by both of them.GukiZ was disappointed because none of his students managed to solve the problem. Can you help them and find one of possible strings k?" 1800
551A "GukiZ and Contest" "brute force,implementation,sortings" "Professor GukiZ likes programming contests. He especially likes to rate his students on the contests he prepares. Now, he has decided to prepare a new contest. In total, n students will attend, and before the start, every one of them has some positive integer rating. Students are indexed from 1 to n. Let\'s denote the rating of i-th student as ai. After the contest ends, every student will end up with some positive integer position. GukiZ expects that his students will take places according to their ratings. He thinks that each student will take place equal to . In particular, if student A has rating strictly lower then student B, A will get the strictly better position than B, and if two students have equal ratings, they will share the same position. GukiZ would like you to reconstruct the results by following his expectations. Help him and determine the position after the end of the contest for each of his students if everything goes as expected." 800
550E "Brackets in Implications" "constructive algorithms,greedy,implementation,math" "Implication is a function of two logical arguments, its value is false if and only if the value of the first argument is true and the value of the second argument is false. Implication is written by using character \'\', and the arguments and the result of the implication are written as \'0\' (false) and \'1\' (true). According to the definition of the implication:   When a logical expression contains multiple implications, then when there are no brackets, it will be calculated from left to fight. For example,. When there are brackets, we first calculate the expression in brackets. For example,.For the given logical expression  determine if it is possible to place there brackets so that the value of a logical expression is false. If it is possible, your task is to find such an arrangement of brackets." 2200
550D "Regular Bridge" "constructive algorithms,graphs,implementation" "An undirected graph is called k-regular, if the degrees of all its vertices are equal k. An edge of a connected graph is called a bridge, if after removing it the graph is being split into two connected components.Build a connected undirected k-regular graph containing at least one bridge, or else state that such graph doesn\'t exist." 1900
550C "Divisibility by Eight" "brute force,dp,math" "You are given a non-negative integer n, its decimal representation consists of at most 100 digits and doesn\'t contain leading zeroes.Your task is to determine if it is possible in this case to remove some of the digits (possibly not remove any digit at all) so that the result contains at least one digit, forms a non-negative integer, doesn\'t have leading zeroes and is divisible by 8. After the removing, it is forbidden to rearrange the digits.If a solution exists, you should print it." 1500
550B "Preparing Olympiad" "bitmasks,brute force" "You have n problems. You have estimated the difficulty of the i-th one as integer ci. Now you want to prepare a problemset for a contest, using some of the problems you\'ve made.A problemset for the contest must consist of at least two problems. You think that the total difficulty of the problems of the contest must be at least l and at most r. Also, you think that the difference between difficulties of the easiest and the hardest of the chosen problems must be at least x.Find the number of ways to choose a problemset for the contest." 1400
550A "Two Substrings" "brute force,dp,greedy,implementation,strings" "You are given string s. Your task is to determine if the given string s contains two non-overlapping substrings ""AB"" and ""BA"" (the substrings can go in any order)." 1500
549H "Degenerate Matrix" "binary search,math" "The determinant of a matrix 2\xe2\x80\x89\xc3\x97\xe2\x80\x892 is defined as follows:A matrix is called degenerate if its determinant is equal to zero. The norm ||A|| of a matrix A is defined as a maximum of absolute values of its elements.You are given a matrix . Consider any degenerate matrix B such that norm ||A\xe2\x80\x89-\xe2\x80\x89B|| is minimum possible. Determine ||A\xe2\x80\x89-\xe2\x80\x89B||." 2100
549G "Happy Line" "constructive algorithms,greedy,sortings" "Do you like summer? Residents of Berland do. They especially love eating ice cream in the hot summer. So this summer day a large queue of n Berland residents lined up in front of the ice cream stall. We know that each of them has a certain amount of berland dollars with them. The residents of Berland are nice people, so each person agrees to swap places with the person right behind him for just 1 dollar. More formally, if person a stands just behind person b, then person a can pay person b 1 dollar, then a and b get swapped. Of course, if person a has zero dollars, he can not swap places with person b.Residents of Berland are strange people. In particular, they get upset when there is someone with a strictly smaller sum of money in the line in front of them.Can you help the residents of Berland form such order in the line so that they were all happy? A happy resident is the one who stands first in the line or the one in front of who another resident stands with not less number of dollars. Note that the people of Berland are people of honor and they agree to swap places only in the manner described above." 2200
549F "Yura and Developers" "data structures,divide and conquer" "Yura has a team of k developers and a list of n tasks numbered from 1 to n. Yura is going to choose some tasks to be done this week. Due to strange Looksery habits the numbers of chosen tasks should be a segment of consecutive integers containing no less than 2 numbers, i. e. a sequence of form l,\xe2\x80\x89l\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89r for some 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89<\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n. Every task i has an integer number ai associated with it denoting how many man-hours are required to complete the i-th task. Developers are not self-confident at all, and they are actually afraid of difficult tasks. Knowing that, Yura decided to pick up a hardest task (the one that takes the biggest number of man-hours to be completed, among several hardest tasks with same difficulty level he chooses arbitrary one) and complete it on his own. So, if tasks with numbers [l,\xe2\x80\x89r] are chosen then the developers are left with r\xe2\x80\x89-\xe2\x80\x89l tasks to be done by themselves. Every developer can spend any integer amount of hours over any task, but when they are done with the whole assignment there should be exactly ai man-hours spent over the i-th task. The last, but not the least problem with developers is that one gets angry if he works more than another developer. A set of tasks [l,\xe2\x80\x89r] is considered good if it is possible to find such a distribution of work that allows to complete all the tasks and to have every developer working for the same amount of time (amount of work performed by Yura doesn\'t matter for other workers as well as for him).For example, let\'s suppose that Yura have chosen tasks with following difficulties: a\xe2\x80\x89=\xe2\x80\x89[1,\xe2\x80\x892,\xe2\x80\x893,\xe2\x80\x894], and he has three developers in his disposal. He takes the hardest fourth task to finish by himself, and the developers are left with tasks with difficulties [1,\xe2\x80\x892,\xe2\x80\x893]. If the first one spends an hour on the first task and an hour on the third one, the second developer spends two hours on the second task and the third developer spends two hours on the third task, then they are done, since every developer worked exactly for two hours and every task has been worked over for the required amount of time. As another example, if the first task required two hours instead of one to be completed then it would be impossible to assign the tasks in a way described above. Besides work, Yura is fond of problem solving. He wonders how many pairs (l,\xe2\x80\x89r) (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89<\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) exists such that a segment [l,\xe2\x80\x89r] is good? Yura has already solved this problem, but he has no time to write the code. Please, help Yura and implement the solution for this problem." 2800
549E "Sasha Circle" geometry,math "Berlanders like to eat cones after a hard day. Misha Square and Sasha Circle are local authorities of Berland. Each of them controls its points of cone trade. Misha has n points, Sasha \xe2\x80\x94 m. Since their subordinates constantly had conflicts with each other, they decided to build a fence in the form of a circle, so that the points of trade of one businessman are strictly inside a circle, and points of the other one are strictly outside. It doesn\'t matter which of the two gentlemen will have his trade points inside the circle.Determine whether they can build a fence or not." 2700
549D "Haar Features" greedy,implementation "The first algorithm for detecting a face on the image working in realtime was developed by Paul Viola and Michael Jones in 2001. A part of the algorithm is a procedure that computes Haar features. As part of this task, we consider a simplified model of this concept.Let\'s consider a rectangular image that is represented with a table of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m. The table elements are integers that specify the brightness of each pixel in the image.A feature also is a rectangular table of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m. Each cell of a feature is painted black or white.To calculate the value of the given feature at the given image, you must perform the following steps. First the table of the feature is put over the table of the image (without rotations or reflections), thus each pixel is entirely covered with either black or white cell. The value of a feature in the image is the value of W\xe2\x80\x89-\xe2\x80\x89B, where W is the total brightness of the pixels in the image, covered with white feature cells, and B is the total brightness of the pixels covered with black feature cells.Some examples of the most popular Haar features are given below.   Your task is to determine the number of operations that are required to calculate the feature by using the so-called prefix rectangles.A prefix rectangle is any rectangle on the image, the upper left corner of which coincides with the upper left corner of the image.You have a variable value, whose value is initially zero. In one operation you can count the sum of pixel values \xe2\x80\x8b\xe2\x80\x8bat any prefix rectangle, multiply it by any integer and add to variable value.You are given a feature. It is necessary to calculate the minimum number of operations required to calculate the values of this attribute at an arbitrary image. For a better understanding of the statement, read the explanation of the first sample." 1900
549C "The Game Of Parity" games "There are n cities in Westeros. The i-th city is inhabited by ai people. Daenerys and Stannis play the following game: in one single move, a player chooses a certain town and burns it to the ground. Thus all its residents, sadly, die. Stannis starts the game. The game ends when Westeros has exactly k cities left.The prophecy says that if the total number of surviving residents is even, then Daenerys wins: Stannis gets beheaded, and Daenerys rises on the Iron Throne. If the total number of surviving residents is odd, Stannis wins and everything goes in the completely opposite way.Lord Petyr Baelish wants to know which candidates to the throne he should support, and therefore he wonders, which one of them has a winning strategy. Answer to this question of Lord Baelish and maybe you will become the next Lord of Harrenholl." 2200
549B "Looksery Party" "constructive algorithms,dfs and similar,graphs,greedy" "The Looksery company, consisting of n staff members, is planning another big party. Every employee has his phone number and the phone numbers of his friends in the phone book. Everyone who comes to the party, sends messages to his contacts about how cool it is. At the same time everyone is trying to spend as much time on the fun as possible, so they send messages to everyone without special thinking, moreover, each person even sends a message to himself or herself.Igor and Max, Looksery developers, started a dispute on how many messages each person gets. Igor indicates n numbers, the i-th of which indicates how many messages, in his view, the i-th employee is going to take. If Igor guesses correctly at least one of these numbers, he wins, otherwise Max wins.You support Max in this debate, so you need, given the contact lists of the employees, to determine whether there is a situation where Igor loses. Specifically, you need to determine which employees should come to the party, and which should not, so after all the visitors send messages to their contacts, each employee received a number of messages that is different from what Igor stated." 2300
549A "Face Detection" implementation,strings "The developers of Looksery have to write an efficient algorithm that detects faces on a picture. Unfortunately, they are currently busy preparing a contest for you, so you will have to do it for them. In this problem an image is a rectangular table that consists of lowercase Latin letters. A face on the image is a 2\xe2\x80\x89\xc3\x97\xe2\x80\x892 square, such that from the four letters of this square you can make word ""face"". You need to write a program that determines the number of faces on the image. The squares that correspond to the faces can overlap." 900
548B "Mike and Fun" "brute force,dp,greedy,implementation" "Mike and some bears are playing a game just for fun. Mike is the judge. All bears except Mike are standing in an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m grid, there\'s exactly one bear in each cell. We denote the bear standing in column number j of row number i by (i,\xe2\x80\x89j). Mike\'s hands are on his ears (since he\'s the judge) and each bear standing in the grid has hands either on his mouth or his eyes.  They play for q rounds. In each round, Mike chooses a bear (i,\xe2\x80\x89j) and tells him to change his state i. e. if his hands are on his mouth, then he\'ll put his hands on his eyes or he\'ll put his hands on his mouth otherwise. After that, Mike wants to know the score of the bears.Score of the bears is the maximum over all rows of number of consecutive bears with hands on their eyes in that row.Since bears are lazy, Mike asked you for help. For each round, tell him the score of these bears after changing the state of a bear selected in that round." 1400
548A "Mike and Fax" "brute force,implementation,strings" "While Mike was walking in the subway, all the stuff in his back-bag dropped on the ground. There were several fax messages among them. He concatenated these strings in some order and now he has string s.  He is not sure if this is his own back-bag or someone else\'s. He remembered that there were exactly k messages in his own bag, each was a palindrome string and all those strings had the same length.He asked you to help him and tell him if he has worn his own back-bag. Check if the given string s is a concatenation of k palindromes of the same length." 1100
547E "Mike and Friends" "data structures,string suffix structures,strings,trees" "What-The-Fatherland is a strange country! All phone numbers there are strings consisting of lowercase English letters. What is double strange that a phone number can be associated with several bears!In that country there is a rock band called CF consisting of n bears (including Mike) numbered from 1 to n.   Phone number of i-th member of CF is si. May 17th is a holiday named Phone Calls day. In the last Phone Calls day, everyone called all the numbers that are substrings of his/her number (one may call some number several times). In particular, everyone called himself (that was really strange country).Denote as call(i,\xe2\x80\x89j) the number of times that i-th member of CF called the j-th member of CF. The geek Mike has q questions that he wants to ask you. In each question he gives you numbers l,\xe2\x80\x89r and k and you should tell him the number" 2800
547D "Mike and Fish" "constructive algorithms,dfs and similar,graphs" "As everyone knows, bears love fish. But Mike is a strange bear; He hates fish! The even more strange thing about him is he has an infinite number of blue and red fish.   He has marked n distinct points in the plane. i-th point is point (xi,\xe2\x80\x89yi). He wants to put exactly one fish in each of these points such that the difference between the number of red fish and the blue fish on each horizontal or vertical line is at most 1.He can\'t find a way to perform that! Please help him." 2600
547C "Mike and Foam" "bitmasks,combinatorics,dp,math,number theory" "Mike is a bartender at Rico\'s bar. At Rico\'s, they put beer glasses in a special shelf. There are n kinds of beer at Rico\'s numbered from 1 to n. i-th kind of beer has ai milliliters of foam on it.  Maxim is Mike\'s boss. Today he told Mike to perform q queries. Initially the shelf is empty. In each request, Maxim gives him a number x. If beer number x is already in the shelf, then Mike should remove it from the shelf, otherwise he should put it in the shelf.After each query, Mike should tell him the score of the shelf. Bears are geeks. So they think that the score of a shelf is the number of pairs (i,\xe2\x80\x89j) of glasses in the shelf such that i\xe2\x80\x89<\xe2\x80\x89j and  where  is the greatest common divisor of numbers a and b.Mike is tired. So he asked you to help him in performing these requests." 2300
547B "Mike and Feet" "binary search,data structures,dp,dsu" "Mike is the president of country What-The-Fatherland. There are n bears living in this country besides Mike. All of them are standing in a line and they are numbered from 1 to n from left to right. i-th bear is exactly ai feet high.   A group of bears is a non-empty contiguous segment of the line. The size of a group is the number of bears in that group. The strength of a group is the minimum height of the bear in that group.Mike is a curious to know for each x such that 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n the maximum strength among all groups of size x." 1900
547A "Mike and Frog" "brute force,greedy,implementation,math" "Mike has a frog and a flower. His frog is named Xaniar and his flower is named Abol. Initially(at time 0), height of Xaniar is h1 and height of Abol is h2. Each second, Mike waters Abol and Xaniar.  So, if height of Xaniar is h1 and height of Abol is h2, after one second height of Xaniar will become  and height of Abol will become  where x1,\xe2\x80\x89y1,\xe2\x80\x89x2 and y2 are some integer numbers and  denotes the remainder of a modulo b.Mike is a competitive programmer fan. He wants to know the minimum time it takes until height of Xania is a1 and height of Abol is a2.Mike has asked you for your help. Calculate the minimum time or say it will never happen." 2200
546E "Soldier and Traveling" flows,graphs,math "In the country there are n cities and m bidirectional roads between them. Each city has an army. Army of the i-th city consists of ai soldiers. Now soldiers roam. After roaming each soldier has to either stay in his city or to go to the one of neighboring cities by at moving along at most one road.Check if is it possible that after roaming there will be exactly bi soldiers in the i-th city." 2100
546D "Soldier and Number Game" "constructive algorithms,dp,math,number theory" "Two soldiers are playing a game. At the beginning first of them chooses a positive integer n and gives it to the second soldier. Then the second one tries to make maximum possible number of rounds. Each round consists of choosing a positive integer x\xe2\x80\x89>\xe2\x80\x891, such that n is divisible by x and replacing n with n\xe2\x80\x89/\xe2\x80\x89x. When n becomes equal to 1 and there is no more possible valid moves the game is over and the score of the second soldier is equal to the number of rounds he performed.To make the game more interesting, first soldier chooses n of form a!\xe2\x80\x89/\xe2\x80\x89b! for some positive integer a and b (a\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89b). Here by k! we denote the factorial of k that is defined as a product of all positive integers not large than k.What is the maximum possible score of the second soldier?" 1700
546C "Soldier and Cards" "brute force,dfs and similar,games" "Two bored soldiers are playing card war. Their card deck consists of exactly n cards, numbered from 1 to n, all values are different. They divide cards between them in some manner, it\'s possible that they have different number of cards. Then they play a ""war""-like card game. The rules are following. On each turn a fight happens. Each of them picks card from the top of his stack and puts on the table. The one whose card value is bigger wins this fight and takes both cards from the table to the bottom of his stack. More precisely, he first takes his opponent\'s card and puts to the bottom of his stack, and then he puts his card to the bottom of his stack. If after some turn one of the player\'s stack becomes empty, he loses and the other one wins. You have to calculate how many fights will happen and who will win the game, or state that game won\'t end." 1400
546B "Soldier and Badges" "brute force,greedy,implementation,sortings" "Colonel has n badges. He wants to give one badge to every of his n soldiers. Each badge has a coolness factor, which shows how much it\'s owner reached. Coolness factor can be increased by one for the cost of one coin. For every pair of soldiers one of them should get a badge with strictly higher factor than the second one. Exact values of their factors aren\'t important, they just need to have distinct factors. Colonel knows, which soldier is supposed to get which badge initially, but there is a problem. Some of badges may have the same factor of coolness. Help him and calculate how much money has to be paid for making all badges have different factors of coolness." 1200
546A "Soldier and Bananas" "brute force,implementation,math" "A soldier wants to buy w bananas in the shop. He has to pay k dollars for the first banana, 2k dollars for the second one and so on (in other words, he has to pay i\xc2\xb7k dollars for the i-th banana). He has n dollars. How many dollars does he have to borrow from his friend soldier to buy w bananas?" 800
545E "Paths and Trees" "graphs,greedy,shortest paths" "Little girl Susie accidentally found her elder brother\'s notebook. She has many things to do, more important than solving problems, but she found this problem too interesting, so she wanted to know its solution and decided to ask you about it. So, the problem statement is as follows.Let\'s assume that we are given a connected weighted undirected graph G\xe2\x80\x89=\xe2\x80\x89(V,\xe2\x80\x89E) (here V is the set of vertices, E is the set of edges). The shortest-path tree from vertex u is such graph G1\xe2\x80\x89=\xe2\x80\x89(V,\xe2\x80\x89E1) that is a tree with the set of edges E1 that is the subset of the set of edges of the initial graph E, and the lengths of the shortest paths from u to any vertex to G and to G1 are the same. You are given a connected weighted undirected graph G and vertex u. Your task is to find the shortest-path tree of the given graph from vertex u, the total weight of whose edges is minimum possible." 2000
545D Queue greedy,implementation,sortings "Little girl Susie went shopping with her mom and she wondered how to improve service quality. There are n people in the queue. For each person we know time ti needed to serve him. A person will be disappointed if the time he waits is more than the time needed to serve him. The time a person waits is the total time when all the people who stand in the queue in front of him are served. Susie thought that if we swap some people in the queue, then we can decrease the number of people who are disappointed. Help Susie find out what is the maximum number of not disappointed people can be achieved by swapping people in the queue." 1300
545C Woodcutters dp,greedy "Little Susie listens to fairy tales before bed every day. Today\'s fairy tale was about wood cutters and the little girl immediately started imagining the choppers cutting wood. She imagined the situation that is described below.There are n trees located along the road at points with coordinates x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xn. Each tree has its height hi. Woodcutters can cut down a tree and fell it to the left or to the right. After that it occupies one of the segments [xi\xe2\x80\x89-\xe2\x80\x89hi,\xe2\x80\x89xi] or [xi;xi\xe2\x80\x89+\xe2\x80\x89hi]. The tree that is not cut down occupies a single point with coordinate xi. Woodcutters can fell a tree if the segment to be occupied by the fallen tree doesn\'t contain any occupied point. The woodcutters want to process as many trees as possible, so Susie wonders, what is the maximum number of trees to fell." 1500
545B "Equidistant String" greedy "Little Susie loves strings. Today she calculates distances between them. As Susie is a small girl after all, her strings contain only digits zero and one. She uses the definition of Hamming distance:We will define the distance between two strings s and t of the same length consisting of digits zero and one as the number of positions i, such that si isn\'t equal to ti. As besides everything else Susie loves symmetry, she wants to find for two strings s and t of length n such string p of length n, that the distance from p to s was equal to the distance from p to t.It\'s time for Susie to go to bed, help her find such string p or state that it is impossible." 1100
545A "Toy Cars" implementation "Little Susie, thanks to her older brother, likes to play with cars. Today she decided to set up a tournament between them. The process of a tournament is described in the next paragraph.There are n toy cars. Each pair collides. The result of a collision can be one of the following: no car turned over, one car turned over, both cars turned over. A car is good if it turned over in no collision. The results of the collisions are determined by an n\xe2\x80\x89\xc3\x97\xe2\x80\x89n matrix \xd0\x90: there is a number on the intersection of the \xd1\x96-th row and j-th column that describes the result of the collision of the \xd1\x96-th and the j-th car:   \xe2\x80\x89-\xe2\x80\x891: if this pair of cars never collided. \xe2\x80\x89-\xe2\x80\x891 occurs only on the main diagonal of the matrix.  0: if no car turned over during the collision.  1: if only the i-th car turned over during the collision.  2: if only the j-th car turned over during the collision.  3: if both cars turned over during the collision. Susie wants to find all the good cars. She quickly determined which cars are good. Can you cope with the task?" 900
544B "Sea and Islands" "constructive algorithms,implementation" "A map of some object is a rectangular field consisting of n rows and n columns. Each cell is initially occupied by the sea but you can cover some some cells of the map with sand so that exactly k islands appear on the map. We will call a set of sand cells to be island if it is possible to get from each of them to each of them by moving only through sand cells and by moving from a cell only to a side-adjacent cell. The cells are called to be side-adjacent if they share a vertical or horizontal side. It is easy to see that islands do not share cells (otherwise they together form a bigger island).Find a way to cover some cells with sand so that exactly k islands appear on the n\xe2\x80\x89\xc3\x97\xe2\x80\x89n map, or determine that no such way exists." 1400
544A "Set of Strings" implementation,strings "You are given a string q. A sequence of k strings s1,\xe2\x80\x89s2,\xe2\x80\x89...,\xe2\x80\x89sk is called beautiful, if the concatenation of these strings is string q (formally, s1\xe2\x80\x89+\xe2\x80\x89s2\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89sk\xe2\x80\x89=\xe2\x80\x89q) and the first characters of these strings are distinct.Find any beautiful sequence of strings or determine that the beautiful sequence doesn\'t exist." 1100
543E "Listening to Music" "constructive algorithms,data structures" "Please note that the memory limit differs from the standard.You really love to listen to music. During the each of next s days you will listen to exactly m songs from the playlist that consists of exactly n songs. Let\'s number the songs from the playlist with numbers from 1 to n, inclusive. The quality of song number i is ai.On the i-th day you choose some integer v (li\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89v\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ri) and listen to songs number v,\xe2\x80\x89v\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89v\xe2\x80\x89+\xe2\x80\x89m\xe2\x80\x89-\xe2\x80\x891. On the i-th day listening to one song with quality less than qi increases your displeasure by exactly one.Determine what minimum displeasure you can get on each of the s next days." 3200
543D "Road Improvement" dp,trees "The country has n cities and n\xe2\x80\x89-\xe2\x80\x891 bidirectional roads, it is possible to get from every city to any other one if you move only along the roads. The cities are numbered with integers from 1 to n inclusive.All the roads are initially bad, but the government wants to improve the state of some roads. We will assume that the citizens are happy about road improvement if the path from the capital located in city x to any other city contains at most one bad road.Your task is \xe2\x80\x94 for every possible x determine the number of ways of improving the quality of some roads in order to meet the citizens\' condition. As those values can be rather large, you need to print each value modulo 1\xe2\x80\x89000\xe2\x80\x89000\xe2\x80\x89007 (109\xe2\x80\x89+\xe2\x80\x897)." 2300
543C "Remembering Strings" bitmasks,dp "You have multiset of n strings of the same length, consisting of lowercase English letters. We will say that those strings are easy to remember if for each string there is some position i and some letter c of the English alphabet, such that this string is the only string in the multiset that has letter c in position i.For example, a multiset of strings {""abc"", ""aba"", ""adc"", ""ada""} are not easy to remember. And multiset {""abc"", ""ada"", ""ssa""} is easy to remember because:   the first string is the only string that has character c in position 3;  the second string is the only string that has character d in position 2;  the third string is the only string that has character s in position 2. You want to change your multiset a little so that it is easy to remember. For aij coins, you can change character in the j-th position of the i-th string into any other lowercase letter of the English alphabet. Find what is the minimum sum you should pay in order to make the multiset of strings easy to remember." 2500
543B "Destroying Roads" "constructive algorithms,graphs,shortest paths" "In some country there are exactly n cities and m bidirectional roads connecting the cities. Cities are numbered with integers from 1 to n. If cities a and b are connected by a road, then in an hour you can go along this road either from city a to city b, or from city b to city a. The road network is such that from any city you can get to any other one by moving along the roads.You want to destroy the largest possible number of roads in the country so that the remaining roads would allow you to get from city s1 to city t1 in at most l1 hours and get from city s2 to city t2 in at most l2 hours.Determine what maximum number of roads you need to destroy in order to meet the condition of your plan. If it is impossible to reach the desired result, print -1." 2100
543A "Writing Code" dp "Programmers working on a large project have just received a task to write exactly m lines of code. There are n programmers working on a project, the i-th of them makes exactly ai bugs in every line of code that he writes. Let\'s call a sequence of non-negative integers v1,\xe2\x80\x89v2,\xe2\x80\x89...,\xe2\x80\x89vn a plan, if v1\xe2\x80\x89+\xe2\x80\x89v2\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89vn\xe2\x80\x89=\xe2\x80\x89m. The programmers follow the plan like that: in the beginning the first programmer writes the first v1 lines of the given task, then the second programmer writes v2 more lines of the given task, and so on. In the end, the last programmer writes the remaining lines of the code. Let\'s call a plan good, if all the written lines of the task contain at most b bugs in total.Your task is to determine how many distinct good plans are there. As the number of plans can be large, print the remainder of this number modulo given positive integer mod." 1800
542F Quest dp,greedy "Polycarp is making a quest for his friends. He has already made n tasks, for each task the boy evaluated how interesting it is as an integer qi, and the time ti in minutes needed to complete the task. An interesting feature of his quest is: each participant should get the task that is best suited for him, depending on his preferences. The task is chosen based on an interactive quiz that consists of some questions. The player should answer these questions with ""yes"" or ""no"". Depending on the answer to the question, the participant either moves to another question or goes to one of the tasks that are in the quest. In other words, the quest is a binary tree, its nodes contain questions and its leaves contain tasks. We know that answering any of the questions that are asked before getting a task takes exactly one minute from the quest player. Polycarp knows that his friends are busy people and they can\'t participate in the quest for more than T minutes. Polycarp wants to choose some of the n tasks he made, invent the corresponding set of questions for them and use them to form an interactive quiz as a binary tree so that no matter how the player answers quiz questions, he spends at most T minutes on completing the whole quest (that is, answering all the questions and completing the task). Specifically, the quest can contain zero questions and go straight to the task. Each task can only be used once (i.e., the people who give different answers to questions should get different tasks).Polycarp wants the total ""interest"" value of the tasks involved in the quest to be as large as possible. Help him determine the maximum possible total interest value of the task considering that the quest should be completed in T minutes at any variant of answering questions." 2100
542E "Playing on Graph" "graphs,shortest paths" "Vova and Marina love offering puzzles to each other. Today Marina offered Vova to cope with the following task.Vova has a non-directed graph consisting of n vertices and m edges without loops and multiple edges. Let\'s define the operation of contraction two vertices a and b that are not connected by an edge. As a result of this operation vertices a and b are deleted and instead of them a new vertex x is added into the graph, and also edges are drawn from it to all vertices that were connected with a or with b (specifically, if the vertex was connected with both a and b, then also exactly one edge is added from x to it). Thus, as a result of contraction again a non-directed graph is formed, it contains no loops nor multiple edges, and it contains (n\xe2\x80\x89-\xe2\x80\x891) vertices.Vova must perform the contraction an arbitrary number of times to transform the given graph into a chain of the maximum length. A chain of length k (k\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x890) is a connected graph whose vertices can be numbered with integers from 1 to k\xe2\x80\x89+\xe2\x80\x891 so that the edges of the graph connect all pairs of vertices (i,\xe2\x80\x89i\xe2\x80\x89+\xe2\x80\x891) (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k) and only them. Specifically, the graph that consists of one vertex is a chain of length 0. The vertices that are formed as a result of the contraction are allowed to be used in the following operations of contraction.  The picture illustrates the contraction of two vertices marked by red. Help Vova cope with his girlfriend\'s task. Find the maximum length of the chain that can be obtained from the resulting graph or else determine that it is impossible to obtain the chain." 2600
542D "Superhero\'s Job" "dfs and similar,dp,hashing,math,number theory" "It\'s tough to be a superhero. And it\'s twice as tough to resist the supervillain who is cool at math. Suppose that you\'re an ordinary Batman in an ordinary city of Gotham. Your enemy Joker mined the building of the city administration and you only have several minutes to neutralize the charge. To do that you should enter the cancel code on the bomb control panel.However, that mad man decided to give you a hint. This morning the mayor found a playing card under his pillow. There was a line written on the card:The bomb has a note saying ""J(x)\xe2\x80\x89=\xe2\x80\x89A"", where A is some positive integer. You suspect that the cancel code is some integer x that meets the equation J(x)\xe2\x80\x89=\xe2\x80\x89A. Now in order to decide whether you should neutralize the bomb or run for your life, you\'ve got to count how many distinct positive integers x meet this equation." 2600
542C "Idempotent functions" "constructive algorithms,graphs,math" "Some time ago Leonid have known about idempotent functions. Idempotent function defined on a set {1,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89n} is such function , that for any  the formula g(g(x))\xe2\x80\x89=\xe2\x80\x89g(x) holds.Let\'s denote as f(k)(x) the function f applied k times to the value x. More formally, f(1)(x)\xe2\x80\x89=\xe2\x80\x89f(x), f(k)(x)\xe2\x80\x89=\xe2\x80\x89f(f(k\xe2\x80\x89-\xe2\x80\x891)(x)) for each k\xe2\x80\x89>\xe2\x80\x891.You are given some function . Your task is to find minimum positive integer k such that function f(k)(x) is idempotent." 2000
542B "Duck Hunt" "data structures" "A duck hunter is doing his favorite thing, hunting. He lives in a two dimensional world and is located at point (0,\xe2\x80\x890). As he doesn\'t like walking for his prey, he prefers to shoot only vertically up (because in this case, the ducks fall straight into his hands). The hunter doesn\'t reload the gun immediately \xe2\x80\x94 r or more seconds must pass between the shots. When the hunter shoots up, the bullet immediately hits all the ducks who are directly above the hunter.In a two dimensional world each duck is a horizontal segment that moves horizontally in the negative direction of the Ox axis at the speed 1 length unit per second. For each duck we know the values hi and ti \xe2\x80\x94 the x-coordinates of its head (the left end of the segment) and its tail (the right end of the segment) at time 0. The height where the duck is flying isn\'t important as the gun shoots vertically up to the infinite height and hits all the ducks on its way.   The figure to the first sample. What maximum number of ducks can the hunter shoot? The duck is considered shot by the hunter if at the moment of the shot at least one of its point intersects the Oy axis. After the hunter shoots the duck, it falls and it can\'t be shot anymore. The hunter cannot make shots before the moment of time 0." 3100
542A "Place Your Ad Here" "data structures,sortings" "Ivan Anatolyevich\'s agency is starting to become famous in the town. They have already ordered and made n TV commercial videos. Each video is made in a special way: the colors and the soundtrack are adjusted to the time of the day and the viewers\' mood. That\'s why the i-th video can only be shown within the time range of [li,\xe2\x80\x89ri] (it is not necessary to use the whole segment but the broadcast time should be within this segment).Now it\'s time to choose a TV channel to broadcast the commercial. Overall, there are m TV channels broadcasting in the city, the j-th one has cj viewers, and is ready to sell time [aj,\xe2\x80\x89bj] to broadcast the commercial.Ivan Anatolyevich is facing a hard choice: he has to choose exactly one video i and exactly one TV channel j to broadcast this video and also a time range to broadcast [x,\xe2\x80\x89y]. At that the time range should be chosen so that it is both within range [li,\xe2\x80\x89ri] and within range [aj,\xe2\x80\x89bj].Let\'s define the efficiency of the broadcast as value (y\xe2\x80\x89-\xe2\x80\x89x)\xc2\xb7cj \xe2\x80\x94 the total sum of time that all the viewers of the TV channel are going to spend watching the commercial. Help Ivan Anatolyevich choose the broadcast with the maximum efficiency!" 2400
540E "Infinite Inversions" "binary search,data structures,implementation,sortings,trees" "There is an infinite sequence consisting of all positive integers in the increasing order: p\xe2\x80\x89=\xe2\x80\x89{1,\xe2\x80\x892,\xe2\x80\x893,\xe2\x80\x89...}. We performed n swap operations with this sequence. A swap(a,\xe2\x80\x89b) is an operation of swapping the elements of the sequence on positions a and b. Your task is to find the number of inversions in the resulting sequence, i.e. the number of such index pairs (i,\xe2\x80\x89j), that i\xe2\x80\x89<\xe2\x80\x89j and pi\xe2\x80\x89>\xe2\x80\x89pj." 2100
540D "Bad Luck Island" dp,probabilities "The Bad Luck Island is inhabited by three kinds of species: r rocks, s scissors and p papers. At some moments of time two random individuals meet (all pairs of individuals can meet equiprobably), and if they belong to different species, then one individual kills the other one: a rock kills scissors, scissors kill paper, and paper kills a rock. Your task is to determine for each species what is the probability that this species will be the only one to inhabit this island after a long enough period of time." 1900
540C "Ice Cave" "dfs and similar" "You play a computer game. Your character stands on some level of a multilevel ice cave. In order to move on forward, you need to descend one level lower and the only way to do this is to fall through the ice.The level of the cave where you are is a rectangular square grid of n rows and m columns. Each cell consists either from intact or from cracked ice. From each cell you can move to cells that are side-adjacent with yours (due to some limitations of the game engine you cannot make jumps on the same place, i.e. jump from a cell to itself). If you move to the cell with cracked ice, then your character falls down through it and if you move to the cell with intact ice, then the ice on this cell becomes cracked.Let\'s number the rows with integers from 1 to n from top to bottom and the columns with integers from 1 to m from left to right. Let\'s denote a cell on the intersection of the r-th row and the c-th column as (r,\xe2\x80\x89c). You are staying in the cell (r1,\xe2\x80\x89c1) and this cell is cracked because you\'ve just fallen here from a higher level. You need to fall down through the cell (r2,\xe2\x80\x89c2) since the exit to the next level is there. Can you do this?" 2000
540B "School Marks" greedy,implementation "Little Vova studies programming in an elite school. Vova and his classmates are supposed to write n progress tests, for each test they will get a mark from 1 to p. Vova is very smart and he can write every test for any mark, but he doesn\'t want to stand out from the crowd too much. If the sum of his marks for all tests exceeds value x, then his classmates notice how smart he is and start distracting him asking to let them copy his homework. And if the median of his marks will be lower than y points (the definition of a median is given in the notes), then his mom will decide that he gets too many bad marks and forbid him to play computer games.Vova has already wrote k tests and got marks a1,\xe2\x80\x89...,\xe2\x80\x89ak. He doesn\'t want to get into the first or the second situation described above and now he needs to determine which marks he needs to get for the remaining tests. Help him do that." 1700
540A "Combination Lock" implementation "Scrooge McDuck keeps his most treasured savings in a home safe with a combination lock. Each time he wants to put there the treasures that he\'s earned fair and square, he has to open the lock.  The combination lock is represented by n rotating disks with digits from 0 to 9 written on them. Scrooge McDuck has to turn some disks so that the combination of digits on the disks forms a secret combination. In one move, he can rotate one disk one digit forwards or backwards. In particular, in one move he can go from digit 0 to digit 9 and vice versa. What minimum number of actions does he need for that?" 800
538H "Summer Dichotomy" "2-sat,data structures,dfs and similar,greedy" "T students applied into the ZPP class of Summer Irrelevant School. The organizing committee of the school may enroll any number of them, but at least t students must be enrolled. The enrolled students should be divided into two groups in any manner (it is possible that one of the groups will be empty!)During a shift the students from the ZPP grade are tutored by n teachers. Due to the nature of the educational process, each of the teachers should be assigned to exactly one of two groups (it is possible that no teacher will be assigned to some of the groups!). The i-th teacher is willing to work in a group as long as the group will have at least li and at most ri students (otherwise it would be either too boring or too hard). Besides, some pairs of the teachers don\'t like each other other and therefore can not work in the same group; in total there are m pairs of conflicting teachers.You, as the head teacher of Summer Irrelevant School, have got a difficult task: to determine how many students to enroll in each of the groups and in which group each teacher will teach." 3200
538G "Berserk Robot" "constructive algorithms,math,sortings" "Help! A robot escaped our lab and we need help finding it. The lab is at the point (0,\xe2\x80\x890) of the coordinate plane, at time 0 the robot was there. The robot\'s movements are defined by a program \xe2\x80\x94 a string of length l, consisting of characters U, L, D, R. Each second the robot executes the next command in his program: if the current coordinates of the robot are (x,\xe2\x80\x89y), then commands U, L, D, R move it to cells (x,\xe2\x80\x89y\xe2\x80\x89+\xe2\x80\x891), (x\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89y), (x,\xe2\x80\x89y\xe2\x80\x89-\xe2\x80\x891), (x\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89y) respectively. The execution of the program started at time 0. The program is looped, i.e. each l seconds of executing the program start again from the first character. Unfortunately, we don\'t know what program was loaded into the robot when he left the lab.Our radars managed to find out the position of the robot at n moments of time: we know that at the moment of time ti the robot is at the point (xi,\xe2\x80\x89yi). Given this data, either help to determine what program could be loaded into the robot, or determine that no possible program meets the data and the robot must have broken down." 3100
538F "A Heap of Heaps" "brute force,data structures,math,sortings" "Andrew skipped lessons on the subject \'Algorithms and Data Structures\' for the entire term. When he came to the final test, the teacher decided to give him a difficult task as a punishment.The teacher gave Andrew an array of n numbers a1, ..., an. After that he asked Andrew for each k from 1 to n\xe2\x80\x89-\xe2\x80\x891 to build a k-ary heap on the array and count the number of elements for which the property of the minimum-rooted heap is violated, i.e. the value of an element is less than the value of its parent.Andrew looked up on the Wikipedia that a k-ary heap is a rooted tree with vertices in elements of the array. If the elements of the array are indexed from 1 to n, then the children of element v are elements with indices k(v\xe2\x80\x89-\xe2\x80\x891)\xe2\x80\x89+\xe2\x80\x892, ..., kv\xe2\x80\x89+\xe2\x80\x891 (if some of these elements lie outside the borders of the array, the corresponding children are absent). In any k-ary heap every element except for the first one has exactly one parent; for the element 1 the parent is absent (this element is the root of the heap). Denote p(v) as the number of the parent of the element with the number v. Let\'s say that for a non-root element v the property of the heap is violated if av\xe2\x80\x89<\xe2\x80\x89ap(v).Help Andrew cope with the task!" 2200
538E "Demiurges Play Again" "dfs and similar,dp,math,trees" "Demiurges Shambambukli and Mazukta love to watch the games of ordinary people. Today, they noticed two men who play the following game.There is a rooted tree on n nodes, m of which are leaves (a leaf is a nodes that does not have any children), edges of the tree are directed from parent to children. In the leaves of the tree integers from 1 to m are placed in such a way that each number appears exactly in one leaf.Initially, the root of the tree contains a piece. Two players move this piece in turns, during a move a player moves the piece from its current nodes to one of its children; if the player can not make a move, the game ends immediately. The result of the game is the number placed in the leaf where a piece has completed its movement. The player who makes the first move tries to maximize the result of the game and the second player, on the contrary, tries to minimize the result. We can assume that both players move optimally well.Demiurges are omnipotent, so before the game they can arbitrarily rearrange the numbers placed in the leaves. Shambambukli wants to rearrange numbers so that the result of the game when both players play optimally well is as large as possible, and Mazukta wants the result to be as small as possible. What will be the outcome of the game, if the numbers are rearranged by Shambambukli, and what will it be if the numbers are rearranged by Mazukta? Of course, the Demiurges choose the best possible option of arranging numbers." 2200
538D "Weird Chess" "brute force,constructive algorithms,implementation" "Igor has been into chess for a long time and now he is sick of the game by the ordinary rules. He is going to think of new rules of the game and become world famous.Igor\'s chessboard is a square of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89n cells. Igor decided that simple rules guarantee success, that\'s why his game will have only one type of pieces. Besides, all pieces in his game are of the same color. The possible moves of a piece are described by a set of shift vectors. The next passage contains a formal description of available moves.Let the rows of the board be numbered from top to bottom and the columns be numbered from left to right from 1 to n. Let\'s assign to each square a pair of integers (x,\xe2\x80\x89y) \xe2\x80\x94 the number of the corresponding column and row. Each of the possible moves of the piece is defined by a pair of integers (dx,\xe2\x80\x89dy); using this move, the piece moves from the field (x,\xe2\x80\x89y) to the field (x\xe2\x80\x89+\xe2\x80\x89dx,\xe2\x80\x89y\xe2\x80\x89+\xe2\x80\x89dy). You can perform the move if the cell (x\xe2\x80\x89+\xe2\x80\x89dx,\xe2\x80\x89y\xe2\x80\x89+\xe2\x80\x89dy) is within the boundaries of the board and doesn\'t contain another piece. Pieces that stand on the cells other than (x,\xe2\x80\x89y) and (x\xe2\x80\x89+\xe2\x80\x89dx,\xe2\x80\x89y\xe2\x80\x89+\xe2\x80\x89dy) are not important when considering the possibility of making the given move (for example, like when a knight moves in usual chess).Igor offers you to find out what moves his chess piece can make. He placed several pieces on the board and for each unoccupied square he told you whether it is attacked by any present piece (i.e. whether some of the pieces on the field can move to that cell). Restore a possible set of shift vectors of the piece, or else determine that Igor has made a mistake and such situation is impossible for any set of shift vectors." 1800
538C "Tourist\'s Notes" "binary search,brute force,greedy,implementation,math" "A tourist hiked along the mountain range. The hike lasted for n days, during each day the tourist noted height above the sea level. On the i-th day height was equal to some integer hi. The tourist pick smooth enough route for his hike, meaning that the between any two consecutive days height changes by at most 1, i.e. for all i\'s from 1 to n\xe2\x80\x89-\xe2\x80\x891 the inequality |hi\xe2\x80\x89-\xe2\x80\x89hi\xe2\x80\x89+\xe2\x80\x891|\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x891 holds.At the end of the route the tourist rafted down a mountain river and some notes in the journal were washed away. Moreover, the numbers in the notes could have been distorted. Now the tourist wonders what could be the maximum height during his hike. Help him restore the maximum possible value of the maximum height throughout the hike or determine that the notes were so much distorted that they do not represent any possible height values that meet limits |hi\xe2\x80\x89-\xe2\x80\x89hi\xe2\x80\x89+\xe2\x80\x891|\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x891." 1600
538B "Quasi Binary" "constructive algorithms,dp,greedy,implementation" "A number is called quasibinary if its decimal representation contains only digits 0 or 1. For example, numbers 0, 1, 101, 110011 \xe2\x80\x94 are quasibinary and numbers 2, 12, 900 are not.You are given a positive integer n. Represent it as a sum of minimum number of quasibinary numbers." 1400
538A "Cutting Banner" "brute force,implementation" "A large banner with word CODEFORCES was ordered for the 1000-th onsite round of Codeforces\xcf\x89 that takes place on the Miami beach. Unfortunately, the company that made the banner mixed up two orders and delivered somebody else\'s banner that contains someone else\'s word. The word on the banner consists only of upper-case English letters.There is very little time to correct the mistake. All that we can manage to do is to cut out some substring from the banner, i.e. several consecutive letters. After that all the resulting parts of the banner will be glued into a single piece (if the beginning or the end of the original banner was cut out, only one part remains); it is not allowed change the relative order of parts of the banner (i.e. after a substring is cut, several first and last letters are left, it is allowed only to glue the last letters to the right of the first letters). Thus, for example, for example, you can cut a substring out from string \'TEMPLATE\' and get string \'TEMPLE\' (if you cut out string AT), \'PLATE\' (if you cut out TEM), \'T\' (if you cut out EMPLATE), etc.Help the organizers of the round determine whether it is possible to cut out of the banner some substring in such a way that the remaining parts formed word CODEFORCES." 1400
536E "Tavas on the Path" "data structures,divide and conquer,trees" "Tavas lives in Tavaspolis. Tavaspolis has n cities numbered from 1 to n connected by n\xe2\x80\x89-\xe2\x80\x891 bidirectional roads. There exists a path between any two cities. Also each road has a length.  Tavas\' favorite strings are binary strings (they contain only 0 and 1). For any binary string like s\xe2\x80\x89=\xe2\x80\x89s1s2... sk, T(s) is its Goodness. T(s) can be calculated as follows:Consider there are exactly m blocks of 1s in this string (a block of 1s in s is a maximal consecutive substring of s that only contains 1) with lengths x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xm.Define  where f is a given sequence (if m\xe2\x80\x89=\xe2\x80\x890, then T(s)\xe2\x80\x89=\xe2\x80\x890).Tavas loves queries. He asks you to answer q queries. In each query he gives you numbers v,\xe2\x80\x89u,\xe2\x80\x89l and you should print following number:Consider the roads on the path from city v to city u: e1,\xe2\x80\x89e2,\xe2\x80\x89...,\xe2\x80\x89ex.Build the binary string b of length x such that: bi\xe2\x80\x89=\xe2\x80\x891 if and only if l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89w(ei) where w(e) is the length of road e.You should print T(b) for this query." 3100
536D "Tavas in Kansas" dp,games "Tavas lives in Kansas. Kansas has n cities numbered from 1 to n connected with m bidirectional roads. We can travel from any city to any other city via these roads. Kansas is as strange as Tavas. So there may be a road between a city and itself or more than one road between two cities.Tavas invented a game and called it ""Dashti"". He wants to play Dashti with his girlfriends, Nafas.In this game, they assign an arbitrary integer value to each city of Kansas. The value of i-th city equals to pi.During the game, Tavas is in city s and Nafas is in city t. They play in turn and Tavas goes first. A player in his/her turn, must choose a non-negative integer x and his/her score increases by the sum of values of all cities with (shortest) distance no more than x from his/her city. Each city may be used once, or in the other words, after first time a player gets score from a city, city score becomes zero.There is an additional rule: the player must choose x such that he/she gets the point of at least one city that was not used before. Note that city may initially have value 0, such city isn\'t considered as been used at the beginning of the game, i. e. each player may use it to fullfill this rule.The game ends when nobody can make a move.A player\'s score is the sum of the points he/she earned during the game. The winner is the player with greater score, or there is a draw if players score the same value. Both players start game with zero points.  If Tavas wins, he\'ll break his girlfriend\'s heart, and if Nafas wins, Tavas will cry. But if their scores are equal, they\'ll be happy and Tavas will give Nafas flowers.They\'re not too emotional after all, so they\'ll play optimally. Your task is to tell Tavas what\'s going to happen after the game ends." 2900
535E "Tavas and Pashmaks" geometry,math "Tavas is a cheerleader in the new sports competition named ""Pashmaks"".  This competition consists of two part: swimming and then running. People will immediately start running R meters after they finished swimming exactly S meters. A winner is a such person that nobody else finishes running before him/her (there may be more than one winner).Before the match starts, Tavas knows that there are n competitors registered for the match. Also, he knows that i-th person\'s swimming speed is si meters per second and his/her running speed is ri meters per second. Unfortunately, he doesn\'t know the values of R and S, but he knows that they are real numbers greater than 0.As a cheerleader, Tavas wants to know who to cheer up. So, he wants to know all people that might win. We consider a competitor might win if and only if there are some values of R and S such that with these values, (s)he will be a winner.Tavas isn\'t really familiar with programming, so he asked you to help him." 2600
535D "Tavas and Malekas" "greedy,hashing,string suffix structures,strings" "Tavas is a strange creature. Usually ""zzz"" comes out of people\'s mouth while sleeping, but string s of length n comes out from Tavas\' mouth instead.  Today Tavas fell asleep in Malekas\' place. While he was sleeping, Malekas did a little process on s. Malekas has a favorite string p. He determined all positions x1\xe2\x80\x89<\xe2\x80\x89x2\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89xk where p matches s. More formally, for each xi (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k) he condition sxisxi\xe2\x80\x89+\xe2\x80\x891... sxi\xe2\x80\x89+\xe2\x80\x89|p|\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89=\xe2\x80\x89p is fullfilled.Then Malekas wrote down one of subsequences of x1,\xe2\x80\x89x2,\xe2\x80\x89... xk (possibly, he didn\'t write anything) on a piece of paper. Here a sequence b is a subsequence of sequence a if and only if we can turn a into b by removing some of its elements (maybe no one of them or all).After Tavas woke up, Malekas told him everything. He couldn\'t remember string s, but he knew that both p and s only contains lowercase English letters and also he had the subsequence he had written on that piece of paper.Tavas wonders, what is the number of possible values of s? He asked SaDDas, but he wasn\'t smart enough to solve this. So, Tavas asked you to calculate this number for him.Answer can be very large, so Tavas wants you to print the answer modulo 109\xe2\x80\x89+\xe2\x80\x897." 1900
535C "Tavas and Karafs" "binary search,greedy,math" "Karafs is some kind of vegetable in shape of an 1\xe2\x80\x89\xc3\x97\xe2\x80\x89h rectangle. Tavaspolis people love Karafs and they use Karafs in almost any kind of food. Tavas, himself, is crazy about Karafs.  Each Karafs has a positive integer height. Tavas has an infinite 1-based sequence of Karafses. The height of the i-th Karafs is si\xe2\x80\x89=\xe2\x80\x89A\xe2\x80\x89+\xe2\x80\x89(i\xe2\x80\x89-\xe2\x80\x891)\xe2\x80\x89\xc3\x97\xe2\x80\x89B.For a given m, let\'s define an m-bite operation as decreasing the height of at most m distinct not eaten Karafses by 1. Karafs is considered as eaten when its height becomes zero.Now SaDDas asks you n queries. In each query he gives you numbers l, t and m and you should find the largest number r such that l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r and sequence sl,\xe2\x80\x89sl\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89sr can be eaten by performing m-bite no more than t times or print -1 if there is no such number r." 1900
535B "Tavas and SaDDas" "bitmasks,brute force,combinatorics,implementation" "Once again Tavas started eating coffee mix without water! Keione told him that it smells awful, but he didn\'t stop doing that. That\'s why Keione told his smart friend, SaDDas to punish him! SaDDas took Tavas\' headphones and told him: ""If you solve the following problem, I\'ll return it to you.""  The problem is: You are given a lucky number n. Lucky numbers are the positive integers whose decimal representations contain only the lucky digits 4 and 7. For example, numbers 47, 744, 4 are lucky and 5, 17, 467 are not.If we sort all lucky numbers in increasing order, what\'s the 1-based index of n? Tavas is not as smart as SaDDas, so he asked you to do him a favor and solve this problem so he can have his headphones back." 1100
535A "Tavas and Nafas" "brute force,implementation" "Today Tavas got his test result as an integer score and he wants to share it with his girlfriend, Nafas.His phone operating system is Tavdroid, and its keyboard doesn\'t have any digits! He wants to share his score with Nafas via text, so he has no choice but to send this number using words.  He ate coffee mix without water again, so right now he\'s really messed up and can\'t think.Your task is to help him by telling him what to type." 1000
534F "Simplified Nonogram" bitmasks,dp,hashing,meet-in-the-middle "In this task you have to write a program dealing with nonograms on fields no larger than 5\xe2\x80\x89\xc3\x97\xe2\x80\x8920.Simplified nonogram is a task where you have to build such field (each cell is either white or black) that satisfies the given information about rows and columns. For each row and each column the number of contiguous black segments is specified. For example if size of the field is n\xe2\x80\x89=\xe2\x80\x893,\xe2\x80\x89m\xe2\x80\x89=\xe2\x80\x895, \xd0\xb0nd numbers of contiguous black segments in rows are: [2,\xe2\x80\x893,\xe2\x80\x892] and in columns are: [1,\xe2\x80\x890,\xe2\x80\x891,\xe2\x80\x892,\xe2\x80\x891] then the solution may look like:  It is guaranteed that on each test in the testset there exists at least one solution." 2400
534E "Berland Local Positioning System" "constructive algorithms,greedy,hashing,implementation" "In Berland a bus travels along the main street of the capital. The street begins from the main square and looks like a very long segment. There are n bus stops located along the street, the i-th of them is located at the distance ai from the central square, all distances are distinct, the stops are numbered in the order of increasing distance from the square, that is, ai\xe2\x80\x89<\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x891 for all i from 1 to n\xe2\x80\x89-\xe2\x80\x891. The bus starts its journey from the first stop, it passes stops 2, 3 and so on. It reaches the stop number n, turns around and goes in the opposite direction to stop 1, passing all the intermediate stops in the reverse order. After that, it again starts to move towards stop n. During the day, the bus runs non-stop on this route.The bus is equipped with the Berland local positioning system. When the bus passes a stop, the system notes down its number.One of the key features of the system is that it can respond to the queries about the distance covered by the bus for the parts of its path between some pair of stops. A special module of the system takes the input with the information about a set of stops on a segment of the path, a stop number occurs in the set as many times as the bus drove past it. This module returns the length of the traveled segment of the path (or -1 if it is impossible to determine the length uniquely). The operation of the module is complicated by the fact that stop numbers occur in the request not in the order they were visited but in the non-decreasing order.For example, if the number of stops is 6, and the part of the bus path starts at the bus stop number 5, ends at the stop number 3 and passes the stops as follows: , then the request about this segment of the path will have form: 3,\xe2\x80\x894,\xe2\x80\x895,\xe2\x80\x895,\xe2\x80\x896. If the bus on the segment of the path from stop 5 to stop 3 has time to drive past the 1-th stop (i.e., if we consider a segment that ends with the second visit to stop 3 on the way from 5), then the request will have form: 1,\xe2\x80\x892,\xe2\x80\x892,\xe2\x80\x893,\xe2\x80\x893,\xe2\x80\x894,\xe2\x80\x895,\xe2\x80\x895,\xe2\x80\x896.You will have to repeat the Berland programmers achievement and implement this function." 2400
534D Handshakes "binary search,constructive algorithms,data structures,greedy" "On February, 30th n students came in the Center for Training Olympiad Programmers (CTOP) of the Berland State University. They came one by one, one after another. Each of them went in, and before sitting down at his desk, greeted with those who were present in the room by shaking hands. Each of the students who came in stayed in CTOP until the end of the day and never left.At any time any three students could join together and start participating in a team contest, which lasted until the end of the day. The team did not distract from the contest for a minute, so when another student came in and greeted those who were present, he did not shake hands with the members of the contest writing team. Each team consisted of exactly three students, and each student could not become a member of more than one team. Different teams could start writing contest at different times.Given how many present people shook the hands of each student, get a possible order in which the students could have come to CTOP. If such an order does not exist, then print that this is impossible.Please note that some students could work independently until the end of the day, without participating in a team contest." 1900
534C "Polycarpus\' Dice" math "Polycarp has n dice d1,\xe2\x80\x89d2,\xe2\x80\x89...,\xe2\x80\x89dn. The i-th dice shows numbers from 1 to di. Polycarp rolled all the dice and the sum of numbers they showed is A. Agrippina didn\'t see which dice showed what number, she knows only the sum A and the values d1,\xe2\x80\x89d2,\xe2\x80\x89...,\xe2\x80\x89dn. However, she finds it enough to make a series of statements of the following type: dice i couldn\'t show number r. For example, if Polycarp had two six-faced dice and the total sum is A\xe2\x80\x89=\xe2\x80\x8911, then Agrippina can state that each of the two dice couldn\'t show a value less than five (otherwise, the remaining dice must have a value of at least seven, which is impossible).For each dice find the number of values for which it can be guaranteed that the dice couldn\'t show these values if the sum of the shown values is A." 1600
534B "Covered Path" dp,greedy,math "The on-board computer on Polycarp\'s car measured that the car speed at the beginning of some section of the path equals v1 meters per second, and in the end it is v2 meters per second. We know that this section of the route took exactly t seconds to pass.Assuming that at each of the seconds the speed is constant, and between seconds the speed can change at most by d meters per second in absolute value (i.e., the difference in the speed of any two adjacent seconds does not exceed d in absolute value), find the maximum possible length of the path section in meters." 1400
534A Exam "constructive algorithms,implementation,math" "An exam for n students will take place in a long and narrow room, so the students will sit in a line in some order. The teacher suspects that students with adjacent numbers (i and i\xe2\x80\x89+\xe2\x80\x891) always studied side by side and became friends and if they take an exam sitting next to each other, they will help each other for sure.Your task is to choose the maximum number of students and make such an arrangement of students in the room that no two students with adjacent numbers sit side by side." 1100
533F Encoding "hashing,string suffix structures,strings" "Polycarp invented a new way to encode strings. Let\'s assume that we have string T, consisting of lowercase English letters. Let\'s choose several pairs of letters of the English alphabet in such a way that each letter occurs in at most one pair. Then let\'s replace each letter in T with its pair letter if there is a pair letter for it. For example, if you chose pairs (l, r), (p, q) and (a, o), then word ""parallelogram"" according to the given encoding principle transforms to word ""qolorreraglom"".Polycarpus already has two strings, S and T. He suspects that string T was obtained after applying the given encoding method from some substring of string S. Find all positions mi in S (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89mi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|S|\xe2\x80\x89-\xe2\x80\x89|T|\xe2\x80\x89+\xe2\x80\x891), such that T can be obtained fro substring SmiSmi\xe2\x80\x89+\xe2\x80\x891... Smi\xe2\x80\x89+\xe2\x80\x89|T|\xe2\x80\x89-\xe2\x80\x891 by applying the described encoding operation by using some set of pairs of English alphabet letters" 2400
533E "Correcting Mistakes" "constructive algorithms,dp,greedy,hashing,strings,two pointers" "Analyzing the mistakes people make while typing search queries is a complex and an interesting work. As there is no guaranteed way to determine what the user originally meant by typing some query, we have to use different sorts of heuristics.Polycarp needed to write a code that could, given two words, check whether they could have been obtained from the same word as a result of typos. Polycarpus suggested that the most common typo is skipping exactly one letter as you type a word.Implement a program that can, given two distinct words S and T of the same length n determine how many words W of length n\xe2\x80\x89+\xe2\x80\x891 are there with such property that you can transform W into both S, and T by deleting exactly one character. Words S and T consist of lowercase English letters. Word W also should consist of lowercase English letters." 1800
533D Landmarks "data structures,dp" "We have an old building with n\xe2\x80\x89+\xe2\x80\x892 columns in a row. These columns support the ceiling. These columns are located in points with coordinates 0\xe2\x80\x89=\xe2\x80\x89x0\xe2\x80\x89<\xe2\x80\x89x1\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89xn\xe2\x80\x89<\xe2\x80\x89xn\xe2\x80\x89+\xe2\x80\x891. The leftmost and the rightmost columns are special, we will call them bearing, the other columns are ordinary. For each column we know its durability di. Let\'s consider an ordinary column with coordinate x. Let\'s assume that the coordinate of the closest to it column to the left (bearing or ordinary) is a and the coordinate of the closest to it column to the right (also, bearing or ordinary) is b. In this task let\'s assume that this column supports the segment of the ceiling from point  to point  (here both fractions are considered as real division). If the length of the segment of the ceiling supported by the column exceeds di, then the column cannot support it and it crashes after a while, and after that the load is being redistributeed between the neighbouring columns according to the same principle.  Thus, ordinary columns will be crashing for some time until the process stops at some state. One can prove that the set of the remaining columns doesn\'t depend on the order in which columns crash. If there are only two bearing columns left in the end, then we assume that the whole construction crashes under the weight of the roof. But if at least one ordinary column stays in addition to the bearing ones, then the building doesn\'t crash.To make the building stronger, we can add one extra ordinary column of arbitrary durability d\' at any (not necessarily integer) point 0\xe2\x80\x89<\xe2\x80\x89x\'\xe2\x80\x89<\xe2\x80\x89xn\xe2\x80\x89+\xe2\x80\x891. If point x\' is already occupied by an ordinary column, it is replaced by a new one.Your task is to find out: what minimal durability can the added column have so that the building doesn\'t crash?" 3000
533C "Board Game" games,greedy,implementation,math "Polycarp and Vasiliy love simple logical games. Today they play a game with infinite chessboard and one pawn for each player. Polycarp and Vasiliy move in turns, Polycarp starts. In each turn Polycarp can move his pawn from cell (x,\xe2\x80\x89y) to (x\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89y) or (x,\xe2\x80\x89y\xe2\x80\x89-\xe2\x80\x891). Vasiliy can move his pawn from (x,\xe2\x80\x89y) to one of cells: (x\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89y),\xe2\x80\x89(x\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89y\xe2\x80\x89-\xe2\x80\x891) and (x,\xe2\x80\x89y\xe2\x80\x89-\xe2\x80\x891). Both players are also allowed to skip move. There are some additional restrictions \xe2\x80\x94 a player is forbidden to move his pawn to a cell with negative x-coordinate or y-coordinate or to the cell containing opponent\'s pawn The winner is the first person to reach cell (0,\xe2\x80\x890). You are given the starting coordinates of both pawns. Determine who will win if both of them play optimally well." 1700
533B "Work Group" "dfs and similar,dp,graphs,strings,trees" "One Big Software Company has n employees numbered from 1 to n. The director is assigned number 1. Every employee of the company except the director has exactly one immediate superior. The director, of course, doesn\'t have a superior.We will call person a a subordinates of another person b, if either b is an immediate supervisor of a, or the immediate supervisor of a is a subordinate to person b. In particular, subordinates of the head are all other employees of the company.To solve achieve an Important Goal we need to form a workgroup. Every person has some efficiency, expressed by a positive integer ai, where i is the person\'s number. The efficiency of the workgroup is defined as the total efficiency of all the people included in it.The employees of the big software company are obsessed with modern ways of work process organization. Today pair programming is at the peak of popularity, so the workgroup should be formed with the following condition. Each person entering the workgroup should be able to sort all of his subordinates who are also in the workgroup into pairs. In other words, for each of the members of the workgroup the number of his subordinates within the workgroup should be even.Your task is to determine the maximum possible efficiency of the workgroup formed at observing the given condition. Any person including the director of company can enter the workgroup." 2000
533A "Berland Miners" "binary search,data structures,dfs and similar,greedy,trees" "The biggest gold mine in Berland consists of n caves, connected by n\xe2\x80\x89-\xe2\x80\x891 transitions. The entrance to the mine leads to the cave number 1, it is possible to go from it to any remaining cave of the mine by moving along the transitions. The mine is being developed by the InMine Inc., k miners work for it. Each day the corporation sorts miners into caves so that each cave has at most one miner working there. For each cave we know the height of its ceiling hi in meters, and for each miner we know his height sj, also in meters. If a miner\'s height doesn\'t exceed the height of the cave ceiling where he is, then he can stand there comfortably, otherwise, he has to stoop and that makes him unhappy.Unfortunately, miners typically go on strike in Berland, so InMine makes all the possible effort to make miners happy about their work conditions. To ensure that no miner goes on strike, you need make sure that no miner has to stoop at any moment on his way from the entrance to the mine to his cave (in particular, he must be able to stand comfortably in the cave where he works). To reach this goal, you can choose exactly one cave and increase the height of its ceiling by several meters. However enlarging a cave is an expensive and complex procedure. That\'s why InMine Inc. asks you either to determine the minimum number of meters you should raise the ceiling of some cave so that it is be possible to sort the miners into the caves and keep all miners happy with their working conditions or to determine that it is impossible to achieve by raising ceiling in exactly one cave." 3000
530I "Different variables" "*special problem" "N variables X1,\xe2\x80\x89...,\xe2\x80\x89XN can have positive integer values. You are given K constraints for these value that look like ""the values of variables Xi1,\xe2\x80\x89Xi2,\xe2\x80\x89...,\xe2\x80\x89XiM are different"". Among all possible lists of values of these variables that satisfy these constraints select the ones which have minimum possible max(Xi). Output lexicographically least of these lists." 2500
530H "Points in triangle" "*special problem,geometry" "You are given a set of points on a plane with positive integer coordinates. Find a triangle of minimum area with vertices in points (0,\xe2\x80\x890), (A,\xe2\x80\x890) and (0,\xe2\x80\x89B) (A and B are unknown positive integers) that contains all the given points inside it (points on the edges count towards being inside)." 2100
530G "Levenshtein distance" "*special problem" "Levenshtein distance between two strings of letters is calculated as the minimal total cost of a sequence of edit actions that converts one of the strings into the other one. The allowed edit actions are: substitution: the cost of substituting one letter with another is equal to the difference of index numbers of these letters in English alphabet. insertion/deletion: the cost of inserting a letter into a string or deleting a letter from a string is equal to the index number of this letter in English alphabet (see examples).You are given two strings. Find the Levenshtein distance between them." 2100
530F "Jumping frogs" "*special problem" "A rectangular swamp is inhabited by 10 species of frogs. Frogs of species i can jump from hillocks to hillock exactly i units along X-axis or Y-axis. Initially frogs of all types sit at the hillock at coordinates (0, 0). You are given coordinates of all other hillocks in the swamp. Find the largest Manhattan distance from (0, 0) to any hillock to which one of the frogs can travel by jumping between hillocks.Manhattan distance between (x1,\xe2\x80\x89y1) and (x2,\xe2\x80\x89y2) is |x1\xe2\x80\x89-\xe2\x80\x89x2|\xe2\x80\x89+\xe2\x80\x89|y1\xe2\x80\x89-\xe2\x80\x89y2|." 2100
530E "Sum and product" "*special problem" "You are given integers N and D. Find N positive integers x1...xN such that the difference of their product and their sum equals D." 1700
530D "Set subtraction" "*special problem" "You are given a starting set consisting of all integers from 1 to 1000, inclusive. You are also given several sets which need to be subtracted from the starting set (i.e., each number which is in at least one of these sets needs to be removed from the starting set). Each subtracted set is represented as an interval of integers from A to B, inclusive. Output the result after all subtractions." 1600
530C "Diophantine equation" "*special problem" "You are given an equation A\xe2\x80\x89*\xe2\x80\x89X\xe2\x80\x89+\xe2\x80\x89B\xe2\x80\x89*\xe2\x80\x89Y\xe2\x80\x89=\xe2\x80\x89C, A,\xe2\x80\x89B,\xe2\x80\x89C are positive integer coefficients, X and Y are variables which can have positive integer values only. Output the number of solutions of this equation and the solutions themselves." 1500
530B "String inside out" "*special problem" "You are given a string S of even length s1..s2n . Perform the following manipulations: divide it into two halves s1..sn and sn\xe2\x80\x89+\xe2\x80\x891..s2n reverse each of them sn..s1 and s2n..sn\xe2\x80\x89+\xe2\x80\x891 concatenate the resulting strings into sn..s1s2n..sn\xe2\x80\x89+\xe2\x80\x891Output the result of these manipulations." 1600
530A "Quadratic equation" "*special problem" "You are given a quadratic equation with integer coefficients A\xe2\x80\x89*\xe2\x80\x89X2\xe2\x80\x89+\xe2\x80\x89B\xe2\x80\x89*\xe2\x80\x89X\xe2\x80\x89+\xe2\x80\x89C\xe2\x80\x89=\xe2\x80\x890. It is guaranteed that A\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x890 and that the equation has at least one real root. Output the roots of the equation." 1500
529B "Group Photo 2 (online mirror version)" "brute force,greedy,sortings" "Many years have passed, and n friends met at a party again. Technologies have leaped forward since the last meeting, cameras with timer appeared and now it is not obligatory for one of the friends to stand with a camera, and, thus, being absent on the photo.Simply speaking, the process of photographing can be described as follows. Each friend occupies a rectangle of pixels on the photo: the i-th of them in a standing state occupies a wi pixels wide and a hi pixels high rectangle. But also, each person can lie down for the photo, and then he will occupy a hi pixels wide and a wi pixels high rectangle.The total photo will have size W\xe2\x80\x89\xc3\x97\xe2\x80\x89H, where W is the total width of all the people rectangles, and H is the maximum of the heights. The friends want to determine what minimum area the group photo can they obtain if no more than n\xe2\x80\x89/\xe2\x80\x892 of them can lie on the ground (it would be strange if more than n\xe2\x80\x89/\xe2\x80\x892 gentlemen lie on the ground together, isn\'t it?..)Help them to achieve this goal." 1900
528D "Fuzzy Search" "bitmasks,brute force,fft" "Leonid works for a small and promising start-up that works on decoding the human genome. His duties include solving complex problems of finding certain patterns in long strings consisting of letters \'A\', \'T\', \'G\' and \'C\'.Let\'s consider the following scenario. There is a fragment of a human DNA chain, recorded as a string S. To analyze the fragment, you need to find all occurrences of string T in a string S. However, the matter is complicated by the fact that the original chain fragment could contain minor mutations, which, however, complicate the task of finding a fragment. Leonid proposed the following approach to solve this problem.Let\'s write down integer k\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x890 \xe2\x80\x94 the error threshold. We will say that string T occurs in string S on position i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|S|\xe2\x80\x89-\xe2\x80\x89|T|\xe2\x80\x89+\xe2\x80\x891), if after putting string T along with this position, each character of string T corresponds to the some character of the same value in string S at the distance of at most k. More formally, for any j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|T|) there must exist such p (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89p\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|S|), that |(i\xe2\x80\x89+\xe2\x80\x89j\xe2\x80\x89-\xe2\x80\x891)\xe2\x80\x89-\xe2\x80\x89p|\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k and S[p]\xe2\x80\x89=\xe2\x80\x89T[j].For example, corresponding to the given definition, string ""ACAT"" occurs in string ""AGCAATTCAT"" in positions 2, 3 and 6.  Note that at k\xe2\x80\x89=\xe2\x80\x890 the given definition transforms to a simple definition of the occurrence of a string in a string.Help Leonid by calculating in how many positions the given string T occurs in the given string S with the given error threshold." 2500
527E "Data Center Drama" "dfs and similar,graphs" "The project of a data center of a Big Software Company consists of n computers connected by m cables. Simply speaking, each computer can be considered as a box with multiple cables going out of the box. Very Important Information is transmitted along each cable in one of the two directions. As the data center plan is not yet approved, it wasn\'t determined yet in which direction information will go along each cable. The cables are put so that each computer is connected with each one, perhaps through some other computers.The person in charge of the cleaning the data center will be Claudia Ivanova, the janitor. She loves to tie cables into bundles using cable ties. For some reasons, she groups the cables sticking out of a computer into groups of two, and if it isn\'t possible, then she gets furious and attacks the computer with the water from the bucket.It should also be noted that due to the specific physical characteristics of the Very Important Information, it is strictly forbidden to connect in one bundle two cables where information flows in different directions.The management of the data center wants to determine how to send information along each cable so that Claudia Ivanova is able to group all the cables coming out of each computer into groups of two, observing the condition above. Since it may not be possible with the existing connections plan, you are allowed to add the minimum possible number of cables to the scheme, and then you need to determine the direction of the information flow for each cable (yes, sometimes data centers are designed based on the janitors\' convenience...)" 2600
527D "Clique Problem" "data structures,dp,greedy,implementation,sortings" "The clique problem is one of the most well-known NP-complete problems. Under some simplification it can be formulated as follows. Consider an undirected graph G. It is required to find a subset of vertices C of the maximum size such that any two of them are connected by an edge in graph G. Sounds simple, doesn\'t it? Nobody yet knows an algorithm that finds a solution to this problem in polynomial time of the size of the graph. However, as with many other NP-complete problems, the clique problem is easier if you consider a specific type of a graph.Consider n distinct points on a line. Let the i-th point have the coordinate xi and weight wi. Let\'s form graph G, whose vertices are these points and edges connect exactly the pairs of points (i,\xe2\x80\x89j), such that the distance between them is not less than the sum of their weights, or more formally: |xi\xe2\x80\x89-\xe2\x80\x89xj|\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89wi\xe2\x80\x89+\xe2\x80\x89wj.Find the size of the maximum clique in such graph." 1800
527C "Glass Carving" "binary search,data structures,implementation" "Leonid wants to become a glass carver (the person who creates beautiful artworks by cutting the glass). He already has a rectangular w mm \xe2\x80\x89\xc3\x97\xe2\x80\x89 h mm sheet of glass, a diamond glass cutter and lots of enthusiasm. What he lacks is understanding of what to carve and how.In order not to waste time, he decided to practice the technique of carving. To do this, he makes vertical and horizontal cuts through the entire sheet. This process results in making smaller rectangular fragments of glass. Leonid does not move the newly made glass fragments. In particular, a cut divides each fragment of glass that it goes through into smaller fragments.After each cut Leonid tries to determine what area the largest of the currently available glass fragments has. Since there appear more and more fragments, this question takes him more and more time and distracts him from the fascinating process.Leonid offers to divide the labor \xe2\x80\x94 he will cut glass, and you will calculate the area of the maximum fragment after each cut. Do you agree?" 1500
527B "Error Correct System" greedy "Ford Prefect got a job as a web developer for a small company that makes towels. His current work task is to create a search engine for the website of the company. During the development process, he needs to write a subroutine for comparing strings S and T of equal length to be ""similar"". After a brief search on the Internet, he learned about the Hamming distance between two strings S and T of the same length, which is defined as the number of positions in which S and T have different characters. For example, the Hamming distance between words ""permanent"" and ""pergament"" is two, as these words differ in the fourth and sixth letters.Moreover, as he was searching for information, he also noticed that modern search engines have powerful mechanisms to correct errors in the request to improve the quality of search. Ford doesn\'t know much about human beings, so he assumed that the most common mistake in a request is swapping two arbitrary letters of the string (not necessarily adjacent). Now he wants to write a function that determines which two letters should be swapped in string S, so that the Hamming distance between a new string S and string T would be as small as possible, or otherwise, determine that such a replacement cannot reduce the distance between the strings.Help him do this!" 1500
527A "Playing with Paper" implementation,math "One day Vasya was sitting on a not so interesting Maths lesson and making an origami from a rectangular a mm \xe2\x80\x89\xc3\x97\xe2\x80\x89 b mm sheet of paper (a\xe2\x80\x89>\xe2\x80\x89b). Usually the first step in making an origami is making a square piece of paper from the rectangular sheet by folding the sheet along the bisector of the right angle, and cutting the excess part.  After making a paper ship from the square piece, Vasya looked on the remaining (a\xe2\x80\x89-\xe2\x80\x89b) mm \xe2\x80\x89\xc3\x97\xe2\x80\x89 b mm strip of paper. He got the idea to use this strip of paper in the same way to make an origami, and then use the remainder (if it exists) and so on. At the moment when he is left with a square piece of paper, he will make the last ship from it and stop.Can you determine how many ships Vasya will make during the lesson?" 1100
526G "Spiders Evil Plan" greedy,trees "Spiders are Om Nom\'s old enemies. They love eating candies as much as he does and that\'s why they keep trying to keep the monster away from his favorite candies. They came up with an evil plan to trap Om Nom.  Let\'s consider a rope structure consisting of n nodes and n\xe2\x80\x89-\xe2\x80\x891 ropes connecting the nodes. The structure is connected, thus, the ropes and the nodes form a tree. Each rope of the formed structure is associated with its length. A candy is tied to node x of the structure. Om Nom really wants to eat this candy.The y spiders are trying to stop him from doing it. They decided to entangle the candy and some part of the structure into a web, thus attaching the candy to as large as possible part of the rope structure. Each spider can use his web to cover all ropes on the path between two arbitrary nodes a and b. Thus, y spiders can cover the set of ropes which is a union of y paths in the given tree. These y paths can arbitrarily intersect each other. The spiders want the following conditions to be hold:  the node containing the candy is adjacent to at least one rope covered with a web  the ropes covered with the web form a connected structure (what\'s the idea of covering with a web the ropes that are not connected with the candy?)  the total length of the ropes covered with web is as large as possible The spiders haven\'t yet decided to what node of the structure they will tie the candy and how many spiders will cover the structure with web, so they asked you to help them. Help them calculate the optimal plan for multiple values of x and y." 3300
526F "Pudding Monsters" "data structures,divide and conquer" "In this problem you will meet the simplified model of game Pudding Monsters.An important process in developing any game is creating levels. A game field in Pudding Monsters is an n\xe2\x80\x89\xc3\x97\xe2\x80\x89n rectangular grid, n of its cells contain monsters and some other cells contain game objects. The gameplay is about moving the monsters around the field. When two monsters are touching each other, they glue together into a single big one (as they are from pudding, remember?).  Statistics showed that the most interesting maps appear if initially each row and each column contains exactly one monster and the rest of map specifics is set up by the correct positioning of the other game objects. A technique that\'s widely used to make the development process more efficient is reusing the available resources. For example, if there is a large n\xe2\x80\x89\xc3\x97\xe2\x80\x89n map, you can choose in it a smaller k\xe2\x80\x89\xc3\x97\xe2\x80\x89k square part, containing exactly k monsters and suggest it as a simplified version of the original map.You wonder how many ways there are to choose in the initial map a k\xe2\x80\x89\xc3\x97\xe2\x80\x89k (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) square fragment, containing exactly k pudding monsters. Calculate this number." 3000
526E "Transmitting Levels" dp,implementation "Optimizing the amount of data transmitted via a network is an important and interesting part of developing any network application.  In one secret game developed deep in the ZeptoLab company, the game universe consists of n levels, located in a circle. You can get from level i to levels i\xe2\x80\x89-\xe2\x80\x891 and i\xe2\x80\x89+\xe2\x80\x891, also you can get from level 1 to level n and vice versa. The map of the i-th level description size is ai bytes.In order to reduce the transmitted traffic, the game gets levels as follows. All the levels on the server are divided into m groups and each time a player finds himself on one of the levels of a certain group for the first time, the server sends all levels of the group to the game client as a single packet. Thus, when a player travels inside the levels of a single group, the application doesn\'t need any new information. Due to the technical limitations the packet can contain an arbitrary number of levels but their total size mustn\'t exceed b bytes, where b is some positive integer constant.Usual situation is that players finish levels one by one, that\'s why a decision was made to split n levels into m groups so that each group was a continuous segment containing multiple neighboring levels (also, the group can have two adjacent levels, n and 1). Specifically, if the descriptions of all levels have the total weight of at most b bytes, then they can all be united into one group to be sent in a single packet.Determine, what minimum number of groups do you need to make in order to organize the levels of the game observing the conditions above?As developing a game is a long process and technology never stagnates, it is yet impossible to predict exactly what value will take constant value b limiting the packet size when the game is out. That\'s why the developers ask you to find the answer for multiple values of b." 2400
526D "Om Nom and Necklace" "hashing,string suffix structures,strings" "One day Om Nom found a thread with n beads of different colors. He decided to cut the first several beads from this thread to make a bead necklace and present it to his girlfriend Om Nelly.  Om Nom knows that his girlfriend loves beautiful patterns. That\'s why he wants the beads on the necklace to form a regular pattern. A sequence of beads S is regular if it can be represented as S\xe2\x80\x89=\xe2\x80\x89A\xe2\x80\x89+\xe2\x80\x89B\xe2\x80\x89+\xe2\x80\x89A\xe2\x80\x89+\xe2\x80\x89B\xe2\x80\x89+\xe2\x80\x89A\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89A\xe2\x80\x89+\xe2\x80\x89B\xe2\x80\x89+\xe2\x80\x89A, where A and B are some bead sequences, ""\xe2\x80\x89+\xe2\x80\x89"" is the concatenation of sequences, there are exactly 2k\xe2\x80\x89+\xe2\x80\x891 summands in this sum, among which there are k\xe2\x80\x89+\xe2\x80\x891 ""A"" summands and k ""B"" summands that follow in alternating order. Om Nelly knows that her friend is an eager mathematician, so she doesn\'t mind if A or B is an empty sequence.Help Om Nom determine in which ways he can cut off the first several beads from the found thread (at least one; probably, all) so that they form a regular pattern. When Om Nom cuts off the beads, he doesn\'t change their order." 2200
526C "Om Nom and Candies" "brute force,greedy,math" "A sweet little monster Om Nom loves candies very much. One day he found himself in a rather tricky situation that required him to think a bit in order to enjoy candies the most. Would you succeed with the same task if you were on his place?  One day, when he came to his friend Evan, Om Nom didn\'t find him at home but he found two bags with candies. The first was full of blue candies and the second bag was full of red candies. Om Nom knows that each red candy weighs Wr grams and each blue candy weighs Wb grams. Eating a single red candy gives Om Nom Hr joy units and eating a single blue candy gives Om Nom Hb joy units.Candies are the most important thing in the world, but on the other hand overeating is not good. Om Nom knows if he eats more than C grams of candies, he will get sick. Om Nom thinks that it isn\'t proper to leave candy leftovers, so he can only eat a whole candy. Om Nom is a great mathematician and he quickly determined how many candies of what type he should eat in order to get the maximum number of joy units. Can you repeat his achievement? You can assume that each bag contains more candies that Om Nom can eat." 2000
526B "Om Nom and Dark Park" "dfs and similar,greedy,implementation" "Om Nom is the main character of a game ""Cut the Rope"". He is a bright little monster who likes visiting friends living at the other side of the park. However the dark old parks can scare even somebody as fearless as Om Nom, so he asks you to help him.  The park consists of 2n\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89-\xe2\x80\x891 squares connected by roads so that the scheme of the park is a full binary tree of depth n. More formally, the entrance to the park is located at the square 1. The exits out of the park are located at squares 2n,\xe2\x80\x892n\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x892n\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89-\xe2\x80\x891 and these exits lead straight to the Om Nom friends\' houses. From each square i (2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x892n\xe2\x80\x89+\xe2\x80\x891) there is a road to the square . Thus, it is possible to go from the park entrance to each of the exits by walking along exactly n roads.    To light the path roads in the evening, the park keeper installed street lights along each road. The road that leads from square i to square  has ai lights.Om Nom loves counting lights on the way to his friend. Om Nom is afraid of spiders who live in the park, so he doesn\'t like to walk along roads that are not enough lit. What he wants is that the way to any of his friends should have in total the same number of lights. That will make him feel safe. He asked you to help him install additional lights. Determine what minimum number of lights it is needed to additionally place on the park roads so that a path from the entrance to any exit of the park contains the same number of street lights. You may add an arbitrary number of street lights to each of the roads." 1400
526A "King of Thieves" "brute force,implementation" "In this problem you will meet the simplified model of game King of Thieves.In a new ZeptoLab game called ""King of Thieves"" your aim is to reach a chest with gold by controlling your character, avoiding traps and obstacles on your way.  An interesting feature of the game is that you can design your own levels that will be available to other players. Let\'s consider the following simple design of a level.A dungeon consists of n segments located at a same vertical level, each segment is either a platform that character can stand on, or a pit with a trap that makes player lose if he falls into it. All segments have the same length, platforms on the scheme of the level are represented as \'*\' and pits are represented as \'.\'. One of things that affects speedrun characteristics of the level is a possibility to perform a series of consecutive jumps of the same length. More formally, when the character is on the platform number i1, he can make a sequence of jumps through the platforms i1\xe2\x80\x89<\xe2\x80\x89i2\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89ik, if i2\xe2\x80\x89-\xe2\x80\x89i1\xe2\x80\x89=\xe2\x80\x89i3\xe2\x80\x89-\xe2\x80\x89i2\xe2\x80\x89=\xe2\x80\x89...\xe2\x80\x89=\xe2\x80\x89ik\xe2\x80\x89-\xe2\x80\x89ik\xe2\x80\x89-\xe2\x80\x891. Of course, all segments i1,\xe2\x80\x89i2,\xe2\x80\x89... ik should be exactly the platforms, not pits. Let\'s call a level to be good if you can perform a sequence of four jumps of the same length or in the other words there must be a sequence i1,\xe2\x80\x89i2,\xe2\x80\x89...,\xe2\x80\x89i5, consisting of five platforms so that the intervals between consecutive platforms are of the same length. Given the scheme of the level, check if it is good." 1300
525E "Anya and Cubes" "binary search,bitmasks,brute force,dp,math,meet-in-the-middle" "Anya loves to fold and stick. Today she decided to do just that.Anya has n cubes lying in a line and numbered from 1 to n from left to right, with natural numbers written on them. She also has k stickers with exclamation marks. We know that the number of stickers does not exceed the number of cubes.Anya can stick an exclamation mark on the cube and get the factorial of the number written on the cube. For example, if a cube reads 5, then after the sticking it reads 5!, which equals 120.You need to help Anya count how many ways there are to choose some of the cubes and stick on some of the chosen cubes at most k exclamation marks so that the sum of the numbers written on the chosen cubes after the sticking becomes equal to S. Anya can stick at most one exclamation mark on each cube. Can you do it?Two ways are considered the same if they have the same set of chosen cubes and the same set of cubes with exclamation marks." 2100
525D "Arthur and Walls" "constructive algorithms,data structures,graphs,greedy,shortest paths" "Finally it is a day when Arthur has enough money for buying an apartment. He found a great option close to the center of the city with a nice price.Plan of the apartment found by Arthur looks like a rectangle n\xe2\x80\x89\xc3\x97\xe2\x80\x89m consisting of squares of size 1\xe2\x80\x89\xc3\x97\xe2\x80\x891. Each of those squares contains either a wall (such square is denoted by a symbol ""*"" on the plan) or a free space (such square is denoted on the plan by a symbol ""."").Room in an apartment is a maximal connected area consisting of free squares. Squares are considered adjacent if they share a common side.The old Arthur dream is to live in an apartment where all rooms are rectangles. He asks you to calculate minimum number of walls you need to remove in order to achieve this goal. After removing a wall from a square it becomes a free square. While removing the walls it is possible that some rooms unite into a single one." 2400
525C "Ilya and Sticks" greedy,math,sortings "In the evening, after the contest Ilya was bored, and he really felt like maximizing. He remembered that he had a set of n sticks and an instrument. Each stick is characterized by its length li.Ilya decided to make a rectangle from the sticks. And due to his whim, he decided to make rectangles in such a way that maximizes their total area. Each stick is used in making at most one rectangle, it is possible that some of sticks remain unused. Bending sticks is not allowed.Sticks with lengths a1, a2, a3 and a4 can make a rectangle if the following properties are observed:  a1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a3\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a4  a1\xe2\x80\x89=\xe2\x80\x89a2  a3\xe2\x80\x89=\xe2\x80\x89a4 A rectangle can be made of sticks with lengths of, for example, 3 3 3 3 or 2 2 4 4. A rectangle cannot be made of, for example, sticks 5 5 5 7.Ilya also has an instrument which can reduce the length of the sticks. The sticks are made of a special material, so the length of each stick can be reduced by at most one. For example, a stick with length 5 can either stay at this length or be transformed into a stick of length 4.You have to answer the question \xe2\x80\x94 what maximum total area of the rectangles can Ilya get with a file if makes rectangles from the available sticks?" 1600
525B "Pasha and String" "constructive algorithms,greedy,math,strings" "Pasha got a very beautiful string s for his birthday, the string consists of lowercase Latin letters. The letters in the string are numbered from 1 to |s| from left to right, where |s| is the length of the given string.Pasha didn\'t like his present very much so he decided to change it. After his birthday Pasha spent m days performing the following transformations on his string \xe2\x80\x94 each day he chose integer ai and reversed a piece of string (a segment) from position ai to position |s|\xe2\x80\x89-\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x891. It is guaranteed that 2\xc2\xb7ai\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|s|.You face the following task: determine what Pasha\'s string will look like after m days." 1400
525A "Vitaliy and Pie" greedy,hashing,strings "After a hard day Vitaly got very hungry and he wants to eat his favorite potato pie. But it\'s not that simple. Vitaly is in the first room of the house with n room located in a line and numbered starting from one from left to right. You can go from the first room to the second room, from the second room to the third room and so on \xe2\x80\x94 you can go from the (n\xe2\x80\x89-\xe2\x80\x891)-th room to the n-th room. Thus, you can go to room x only from room x\xe2\x80\x89-\xe2\x80\x891.The potato pie is located in the n-th room and Vitaly needs to go there. Each pair of consecutive rooms has a door between them. In order to go to room x from room x\xe2\x80\x89-\xe2\x80\x891, you need to open the door between the rooms with the corresponding key. In total the house has several types of doors (represented by uppercase Latin letters) and several types of keys (represented by lowercase Latin letters). The key of type t can open the door of type T if and only if t and T are the same letter, written in different cases. For example, key f can open door F.Each of the first n\xe2\x80\x89-\xe2\x80\x891 rooms contains exactly one key of some type that Vitaly can use to get to next rooms. Once the door is open with some key, Vitaly won\'t get the key from the keyhole but he will immediately run into the next room. In other words, each key can open no more than one door.Vitaly realizes that he may end up in some room without the key that opens the door to the next room. Before the start his run for the potato pie Vitaly can buy any number of keys of any type that is guaranteed to get to room n.Given the plan of the house, Vitaly wants to know what is the minimum number of keys he needs to buy to surely get to the room n, which has a delicious potato pie. Write a program that will help Vitaly find out this number." 1100
524F "And Yet Another Bracket Sequence" "data structures,greedy,hashing,string suffix structures,strings" "Polycarpus has a finite sequence of opening and closing brackets. In order not to fall asleep in a lecture, Polycarpus is having fun with his sequence. He is able to perform two operations:  adding any bracket in any position (in the beginning, the end, or between any two existing brackets);  cyclic shift \xe2\x80\x94 moving the last bracket from the end of the sequence to the beginning. Polycarpus can apply any number of operations to his sequence and adding a cyclic shift in any order. As a result, he wants to get the correct bracket sequence of the minimum possible length. If there are several such sequences, Polycarpus is interested in the lexicographically smallest one. Help him find such a sequence.Acorrect bracket sequence is a sequence of opening and closing brackets, from which you can get a correct arithmetic expression by adding characters ""1"" and ""+"" . Each opening bracket must correspond to a closed one. For example, the sequences ""(())()"", ""()"", ""(()(()))"" are correct and "")("", ""(()"" and ""(()))("" are not.The sequence a1 a2... an is lexicographically smaller than sequence b1 b2... bn, if there is such number i from 1 to n, thatak\xe2\x80\x89=\xe2\x80\x89bk for 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k\xe2\x80\x89<\xe2\x80\x89i and ai\xe2\x80\x89<\xe2\x80\x89bi. Consider that ""("" \xe2\x80\x89<\xe2\x80\x89 "")""." 2700
524E "Rooks and Rectangles" "data structures,sortings" "Polycarpus has a chessboard of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m, where k rooks are placed. Polycarpus hasn\'t yet invented the rules of the game he will play. However, he has already allocated q rectangular areas of special strategic importance on the board, they must be protected well. According to Polycarpus, a rectangular area of \xe2\x80\x8b\xe2\x80\x8bthe board is well protected if all its vacant squares can be beaten by the rooks that stand on this area. The rooks on the rest of the board do not affect the area\'s defense. The position of the rooks is fixed and cannot be changed. We remind you that the the rook beats the squares located on the same vertical or horizontal line with it, if there are no other pieces between the square and the rook. Help Polycarpus determine whether all strategically important areas are protected." 2400
524D "Social Network" "greedy,two pointers" "Polycarpus got an internship in one well-known social network. His test task is to count the number of unique users who have visited a social network during the day. Polycarpus was provided with information on all user requests for this time period. For each query, we know its time... and nothing else, because Polycarpus has already accidentally removed the user IDs corresponding to the requests from the database. Thus, it is now impossible to determine whether any two requests are made by the same person or by different people.But wait, something is still known, because that day a record was achieved \xe2\x80\x94 M simultaneous users online! In addition, Polycarpus believes that if a user made a request at second s, then he was online for T seconds after that, that is, at seconds s, s\xe2\x80\x89+\xe2\x80\x891, s\xe2\x80\x89+\xe2\x80\x892, ..., s\xe2\x80\x89+\xe2\x80\x89T\xe2\x80\x89-\xe2\x80\x891. So, the user\'s time online can be calculated as the union of time intervals of the form [s,\xe2\x80\x89s\xe2\x80\x89+\xe2\x80\x89T\xe2\x80\x89-\xe2\x80\x891] over all times s of requests from him.Guided by these thoughts, Polycarpus wants to assign a user ID to each request so that:  the number of different users online did not exceed M at any moment,  at some second the number of distinct users online reached value M,  the total number of users (the number of distinct identifiers) was as much as possible. Help Polycarpus cope with the test." 2100
524C "The Art of Dealing with ATM" "binary search,sortings" "ATMs of a well-known bank of a small country are arranged so that they can not give any amount of money requested by the user. Due to the limited size of the bill dispenser (the device that is directly giving money from an ATM) and some peculiarities of the ATM structure, you can get at most k bills from it, and the bills may be of at most two distinct denominations.For example, if a country uses bills with denominations 10, 50, 100, 500, 1000 and 5000 burles, then at k\xe2\x80\x89=\xe2\x80\x8920 such ATM can give sums 100\xe2\x80\x89000 burles and 96\xe2\x80\x89000 burles, but it cannot give sums 99\xe2\x80\x89000 and 101\xe2\x80\x89000 burles.Let\'s suppose that the country uses bills of n distinct denominations, and the ATM that you are using has an unlimited number of bills of each type. You know that during the day you will need to withdraw a certain amount of cash q times. You know that when the ATM has multiple ways to give money, it chooses the one which requires the minimum number of bills, or displays an error message if it cannot be done. Determine the result of each of the q of requests for cash withdrawal." 1900
524B "\xd0\xa4\xd0\xbe\xd1\x82\xd0\xbe \xd0\xbd\xd0\xb0 \xd0\xbf\xd0\xb0\xd0\xbc\xd1\x8f\xd1\x82\xd1\x8c - 2 (round version)" dp,greedy "\xd0\x9f\xd1\x80\xd0\xbe\xd1\x88\xd0\xbb\xd0\xbe \xd0\xbc\xd0\xbd\xd0\xbe\xd0\xb3\xd0\xbe \xd0\xbb\xd0\xb5\xd1\x82, \xd0\xb8 \xd0\xbd\xd0\xb0 \xd0\xb2\xd0\xb5\xd1\x87\xd0\xb5\xd1\x80\xd0\xb8\xd0\xbd\xd0\xba\xd0\xb5 \xd1\x81\xd0\xbd\xd0\xbe\xd0\xb2\xd0\xb0 \xd0\xb2\xd1\x81\xd1\x82\xd1\x80\xd0\xb5\xd1\x82\xd0\xb8\xd0\xbb\xd0\xb8\xd1\x81\xd1\x8c n \xd0\xb4\xd1\x80\xd1\x83\xd0\xb7\xd0\xb5\xd0\xb9. \xd0\xa1 \xd0\xbc\xd0\xbe\xd0\xbc\xd0\xb5\xd0\xbd\xd1\x82\xd0\xb0 \xd0\xbf\xd0\xbe\xd1\x81\xd0\xbb\xd0\xb5\xd0\xb4\xd0\xbd\xd0\xb5\xd0\xb9 \xd0\xb2\xd1\x81\xd1\x82\xd1\x80\xd0\xb5\xd1\x87\xd0\xb8 \xd1\x82\xd0\xb5\xd1\x85\xd0\xbd\xd0\xb8\xd0\xba\xd0\xb0 \xd1\x88\xd0\xb0\xd0\xb3\xd0\xbd\xd1\x83\xd0\xbb\xd0\xb0 \xd0\xb4\xd0\xb0\xd0\xbb\xd0\xb5\xd0\xba\xd0\xbe \xd0\xb2\xd0\xbf\xd0\xb5\xd1\x80\xd1\x91\xd0\xb4, \xd0\xbf\xd0\xbe\xd1\x8f\xd0\xb2\xd0\xb8\xd0\xbb\xd0\xb8\xd1\x81\xd1\x8c \xd1\x84\xd0\xbe\xd1\x82\xd0\xbe\xd0\xb0\xd0\xbf\xd0\xbf\xd0\xb0\xd1\x80\xd0\xb0\xd1\x82\xd1\x8b \xd1\x81 \xd0\xb0\xd0\xb2\xd1\x82\xd0\xbe\xd1\x81\xd0\xbf\xd1\x83\xd1\x81\xd0\xba\xd0\xbe\xd0\xbc, \xd0\xb8 \xd1\x82\xd0\xb5\xd0\xbf\xd0\xb5\xd1\x80\xd1\x8c \xd0\xbd\xd0\xb5 \xd1\x82\xd1\x80\xd0\xb5\xd0\xb1\xd1\x83\xd0\xb5\xd1\x82\xd1\x81\xd1\x8f, \xd1\x87\xd1\x82\xd0\xbe\xd0\xb1\xd1\x8b \xd0\xbe\xd0\xb4\xd0\xb8\xd0\xbd \xd0\xb8\xd0\xb7 \xd0\xb4\xd1\x80\xd1\x83\xd0\xb7\xd0\xb5\xd0\xb9 \xd1\x81\xd1\x82\xd0\xbe\xd1\x8f\xd0\xbb \xd1\x81 \xd1\x84\xd0\xbe\xd1\x82\xd0\xbe\xd0\xb0\xd0\xbf\xd0\xbf\xd0\xb0\xd1\x80\xd0\xb0\xd1\x82\xd0\xbe\xd0\xbc, \xd0\xb8, \xd1\x82\xd0\xb5\xd0\xbc \xd1\x81\xd0\xb0\xd0\xbc\xd1\x8b\xd0\xbc, \xd0\xbe\xd0\xba\xd0\xb0\xd0\xb7\xd1\x8b\xd0\xb2\xd0\xb0\xd0\xbb\xd1\x81\xd1\x8f \xd0\xbd\xd0\xb5 \xd0\xb7\xd0\xb0\xd0\xbf\xd0\xb5\xd1\x87\xd0\xb0\xd1\x82\xd0\xbb\xd1\x91\xd0\xbd\xd0\xbd\xd1\x8b\xd0\xbc \xd0\xbd\xd0\xb0 \xd1\x81\xd0\xbd\xd0\xb8\xd0\xbc\xd0\xba\xd0\xb5.\xd0\xa3\xd0\xbf\xd1\x80\xd0\xbe\xd1\x89\xd0\xb5\xd0\xbd\xd0\xbd\xd0\xbe \xd0\xbf\xd1\x80\xd0\xbe\xd1\x86\xd0\xb5\xd1\x81\xd1\x81 \xd1\x84\xd0\xbe\xd1\x82\xd0\xbe\xd0\xb3\xd1\x80\xd0\xb0\xd1\x84\xd0\xb8\xd1\x80\xd0\xbe\xd0\xb2\xd0\xb0\xd0\xbd\xd0\xb8\xd1\x8f \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xbd\xd0\xbe \xd0\xbe\xd0\xbf\xd0\xb8\xd1\x81\xd0\xb0\xd1\x82\xd1\x8c \xd1\x81\xd0\xbb\xd0\xb5\xd0\xb4\xd1\x83\xd1\x8e\xd1\x89\xd0\xb8\xd0\xbc \xd0\xbe\xd0\xb1\xd1\x80\xd0\xb0\xd0\xb7\xd0\xbe\xd0\xbc. \xd0\x9d\xd0\xb0 \xd1\x84\xd0\xbe\xd1\x82\xd0\xbe\xd0\xb3\xd1\x80\xd0\xb0\xd1\x84\xd0\xb8\xd0\xb8 \xd0\xba\xd0\xb0\xd0\xb6\xd0\xb4\xd1\x8b\xd0\xb9 \xd0\xb8\xd0\xb7 \xd0\xb4\xd1\x80\xd1\x83\xd0\xb7\xd0\xb5\xd0\xb9 \xd0\xb7\xd0\xb0\xd0\xbd\xd0\xb8\xd0\xbc\xd0\xb0\xd0\xb5\xd1\x82 \xd0\xbf\xd1\x80\xd1\x8f\xd0\xbc\xd0\xbe\xd1\x83\xd0\xb3\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xb8\xd0\xba \xd0\xb8\xd0\xb7 \xd0\xbf\xd0\xb8\xd0\xba\xd1\x81\xd0\xb5\xd0\xbb\xd0\xb5\xd0\xb9: \xd0\xb2 \xd1\x81\xd1\x82\xd0\xbe\xd1\x8f\xd1\x87\xd0\xb5\xd0\xbc \xd0\xbf\xd0\xbe\xd0\xbb\xd0\xbe\xd0\xb6\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb8 i-\xd0\xb9 \xd0\xb8\xd0\xb7 \xd0\xbd\xd0\xb8\xd1\x85 \xd0\xb7\xd0\xb0\xd0\xbd\xd0\xb8\xd0\xbc\xd0\xb0\xd0\xb5\xd1\x82 \xd0\xbf\xd1\x80\xd1\x8f\xd0\xbc\xd0\xbe\xd1\x83\xd0\xb3\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xb8\xd0\xba \xd1\x88\xd0\xb8\xd1\x80\xd0\xb8\xd0\xbd\xd1\x8b wi \xd0\xbf\xd0\xb8\xd0\xba\xd1\x81\xd0\xb5\xd0\xbb\xd0\xb5\xd0\xb9 \xd0\xb8 \xd0\xb2\xd1\x8b\xd1\x81\xd0\xbe\xd1\x82\xd1\x8b hi \xd0\xbf\xd0\xb8\xd0\xba\xd1\x81\xd0\xb5\xd0\xbb\xd0\xb5\xd0\xb9. \xd0\x9d\xd0\xbe \xd1\x82\xd0\xb0\xd0\xba\xd0\xb6\xd0\xb5, \xd0\xbf\xd1\x80\xd0\xb8 \xd1\x84\xd0\xbe\xd1\x82\xd0\xbe\xd0\xb3\xd1\x80\xd0\xb0\xd1\x84\xd0\xb8\xd1\x80\xd0\xbe\xd0\xb2\xd0\xb0\xd0\xbd\xd0\xb8\xd0\xb8 \xd0\xba\xd0\xb0\xd0\xb6\xd0\xb4\xd1\x8b\xd0\xb9 \xd1\x87\xd0\xb5\xd0\xbb\xd0\xbe\xd0\xb2\xd0\xb5\xd0\xba \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xb5\xd1\x82 \xd0\xbb\xd0\xb5\xd1\x87\xd1\x8c, \xd0\xb8 \xd1\x82\xd0\xbe\xd0\xb3\xd0\xb4\xd0\xb0 \xd0\xbe\xd0\xbd \xd0\xb1\xd1\x83\xd0\xb4\xd0\xb5\xd1\x82 \xd0\xb7\xd0\xb0\xd0\xbd\xd0\xb8\xd0\xbc\xd0\xb0\xd1\x82\xd1\x8c \xd0\xbf\xd1\x80\xd1\x8f\xd0\xbc\xd0\xbe\xd1\x83\xd0\xb3\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xb8\xd0\xba \xd1\x88\xd0\xb8\xd1\x80\xd0\xb8\xd0\xbd\xd1\x8b hi \xd0\xbf\xd0\xb8\xd0\xba\xd1\x81\xd0\xb5\xd0\xbb\xd0\xb5\xd0\xb9 \xd0\xb8 \xd0\xb2\xd1\x8b\xd1\x81\xd0\xbe\xd1\x82\xd1\x8b wi \xd0\xbf\xd0\xb8\xd0\xba\xd1\x81\xd0\xb5\xd0\xbb\xd0\xb5\xd0\xb9.\xd0\x9e\xd0\xb1\xd1\x89\xd0\xb0\xd1\x8f \xd1\x84\xd0\xbe\xd1\x82\xd0\xbe\xd0\xb3\xd1\x80\xd0\xb0\xd1\x84\xd0\xb8\xd1\x8f \xd0\xb1\xd1\x83\xd0\xb4\xd0\xb5\xd1\x82 \xd0\xb8\xd0\xbc\xd0\xb5\xd1\x82\xd1\x8c \xd1\x80\xd0\xb0\xd0\xb7\xd0\xbc\xd0\xb5\xd1\x80\xd1\x8b W\xe2\x80\x89\xc3\x97\xe2\x80\x89H, \xd0\xb3\xd0\xb4\xd0\xb5 W \xe2\x80\x94 \xd1\x81\xd1\x83\xd0\xbc\xd0\xbc\xd0\xb0\xd1\x80\xd0\xbd\xd0\xb0\xd1\x8f \xd1\x88\xd0\xb8\xd1\x80\xd0\xb8\xd0\xbd\xd0\xb0 \xd0\xb2\xd1\x81\xd0\xb5\xd1\x85 \xd0\xbf\xd1\x80\xd1\x8f\xd0\xbc\xd0\xbe\xd1\x83\xd0\xb3\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xb8\xd0\xba\xd0\xbe\xd0\xb2-\xd0\xbb\xd1\x8e\xd0\xb4\xd0\xb5\xd0\xb9, \xd0\xb0 H \xe2\x80\x94 \xd0\xbc\xd0\xb0\xd0\xba\xd1\x81\xd0\xb8\xd0\xbc\xd0\xb0\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xb0\xd1\x8f \xd0\xb8\xd0\xb7 \xd0\xb2\xd1\x8b\xd1\x81\xd0\xbe\xd1\x82. \xd0\x94\xd1\x80\xd1\x83\xd0\xb7\xd1\x8c\xd1\x8f \xd1\x85\xd0\xbe\xd1\x82\xd1\x8f\xd1\x82 \xd0\xbe\xd0\xbf\xd1\x80\xd0\xb5\xd0\xb4\xd0\xb5\xd0\xbb\xd0\xb8\xd1\x82\xd1\x8c, \xd0\xba\xd0\xb0\xd0\xba\xd1\x83\xd1\x8e \xd0\xbc\xd0\xb8\xd0\xbd\xd0\xb8\xd0\xbc\xd0\xb0\xd0\xbb\xd1\x8c\xd0\xbd\xd1\x83\xd1\x8e \xd0\xbf\xd0\xbb\xd0\xbe\xd1\x89\xd0\xb0\xd0\xb4\xd1\x8c \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xb5\xd1\x82 \xd0\xb8\xd0\xbc\xd0\xb5\xd1\x82\xd1\x8c \xd0\xbe\xd0\xb1\xd1\x89\xd0\xb0\xd1\x8f \xd1\x84\xd0\xbe\xd1\x82\xd0\xbe\xd0\xb3\xd1\x80\xd0\xb0\xd1\x84\xd0\xb8\xd1\x8f. \xd0\x9f\xd0\xbe\xd0\xbc\xd0\xbe\xd0\xb3\xd0\xb8\xd1\x82\xd0\xb5 \xd0\xb8\xd0\xbc \xd0\xb2 \xd1\x8d\xd1\x82\xd0\xbe\xd0\xbc." 1700
524A "\xd0\x92\xd0\xbe\xd0\xb7\xd0\xbc\xd0\xbe\xd0\xb6\xd0\xbd\xd0\xbe, \xd0\xb2\xd1\x8b \xd0\xb7\xd0\xbd\xd0\xb0\xd0\xb5\xd1\x82\xd0\xb5 \xd1\x8d\xd1\x82\xd0\xb8\xd1\x85 \xd0\xbb\xd1\x8e\xd0\xb4\xd0\xb5\xd0\xb9?" implementation "\xd0\x9e\xd1\x81\xd0\xbd\xd0\xbe\xd0\xb2\xd0\xbe\xd0\xb9 \xd0\xbb\xd1\x8e\xd0\xb1\xd0\xbe\xd0\xb9 \xd1\x81\xd0\xbe\xd1\x86\xd0\xb8\xd0\xb0\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe\xd0\xb9 \xd1\x81\xd0\xb5\xd1\x82\xd0\xb8 \xd1\x8f\xd0\xb2\xd0\xbb\xd1\x8f\xd0\xb5\xd1\x82\xd1\x81\xd1\x8f \xd0\xbe\xd1\x82\xd0\xbd\xd0\xbe\xd1\x88\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb5 \xd0\xb4\xd1\x80\xd1\x83\xd0\xb6\xd0\xb1\xd1\x8b \xd0\xbc\xd0\xb5\xd0\xb6\xd0\xb4\xd1\x83 \xd0\xb4\xd0\xb2\xd1\x83\xd0\xbc\xd1\x8f \xd0\xbf\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xb7\xd0\xbe\xd0\xb2\xd0\xb0\xd1\x82\xd0\xb5\xd0\xbb\xd1\x8f\xd0\xbc\xd0\xb8 \xd0\xb2 \xd1\x82\xd0\xbe\xd0\xbc \xd0\xb8\xd0\xbb\xd0\xb8 \xd0\xb8\xd0\xbd\xd0\xbe\xd0\xbc \xd1\x81\xd0\xbc\xd1\x8b\xd1\x81\xd0\xbb\xd0\xb5. \xd0\x92 \xd0\xbe\xd0\xb4\xd0\xbd\xd0\xbe\xd0\xb9 \xd0\xb8\xd0\xb7\xd0\xb2\xd0\xb5\xd1\x81\xd1\x82\xd0\xbd\xd0\xbe\xd0\xb9 \xd1\x81\xd0\xbe\xd1\x86\xd0\xb8\xd0\xb0\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe\xd0\xb9 \xd1\x81\xd0\xb5\xd1\x82\xd0\xb8 \xd0\xb4\xd1\x80\xd1\x83\xd0\xb6\xd0\xb1\xd0\xb0 \xd1\x81\xd0\xb8\xd0\xbc\xd0\xbc\xd0\xb5\xd1\x82\xd1\x80\xd0\xb8\xd1\x87\xd0\xbd\xd0\xb0, \xd1\x82\xd0\xbe \xd0\xb5\xd1\x81\xd1\x82\xd1\x8c \xd0\xb5\xd1\x81\xd0\xbb\xd0\xb8 a \xd1\x8f\xd0\xb2\xd0\xbb\xd1\x8f\xd0\xb5\xd1\x82\xd1\x81\xd1\x8f \xd0\xb4\xd1\x80\xd1\x83\xd0\xb3\xd0\xbe\xd0\xbc b, \xd1\x82\xd0\xbe b \xd1\x82\xd0\xb0\xd0\xba\xd0\xb6\xd0\xb5 \xd1\x8f\xd0\xb2\xd0\xbb\xd1\x8f\xd0\xb5\xd1\x82\xd1\x81\xd1\x8f \xd0\xb4\xd1\x80\xd1\x83\xd0\xb3\xd0\xbe\xd0\xbc a. \xd0\x92 \xd1\x8d\xd1\x82\xd0\xbe\xd0\xb9 \xd0\xb6\xd0\xb5 \xd1\x81\xd0\xb5\xd1\x82\xd0\xb8 \xd0\xb5\xd1\x81\xd1\x82\xd1\x8c \xd1\x84\xd1\x83\xd0\xbd\xd0\xba\xd1\x86\xd0\xb8\xd1\x8f, \xd0\xba\xd0\xbe\xd1\x82\xd0\xbe\xd1\x80\xd0\xb0\xd1\x8f \xd0\xb4\xd0\xb5\xd0\xbc\xd0\xbe\xd0\xbd\xd1\x81\xd1\x82\xd1\x80\xd0\xb8\xd1\x80\xd1\x83\xd0\xb5\xd1\x82 \xd0\xbc\xd0\xbd\xd0\xbe\xd0\xb6\xd0\xb5\xd1\x81\xd1\x82\xd0\xb2\xd0\xbe \xd0\xbb\xd1\x8e\xd0\xb4\xd0\xb5\xd0\xb9, \xd0\xb8\xd0\xbc\xd0\xb5\xd1\x8e\xd1\x89\xd0\xb8\xd1\x85 \xd0\xb2\xd1\x8b\xd1\x81\xd0\xbe\xd0\xba\xd1\x83\xd1\x8e \xd0\xb2\xd0\xb5\xd1\x80\xd0\xbe\xd1\x8f\xd1\x82\xd0\xbd\xd0\xbe\xd1\x81\xd1\x82\xd1\x8c \xd0\xb1\xd1\x8b\xd1\x82\xd1\x8c \xd0\xb7\xd0\xbd\xd0\xb0\xd0\xba\xd0\xbe\xd0\xbc\xd1\x8b\xd0\xbc\xd0\xb8 \xd0\xb4\xd0\xbb\xd1\x8f \xd0\xbf\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xb7\xd0\xbe\xd0\xb2\xd0\xb0\xd1\x82\xd0\xb5\xd0\xbb\xd1\x8f. \xd0\xad\xd1\x82\xd0\xb0 \xd1\x84\xd1\x83\xd0\xbd\xd0\xba\xd1\x86\xd0\xb8\xd1\x8f \xd1\x80\xd0\xb0\xd0\xb1\xd0\xbe\xd1\x82\xd0\xb0\xd0\xb5\xd1\x82 \xd1\x81\xd0\xbb\xd0\xb5\xd0\xb4\xd1\x83\xd1\x8e\xd1\x89\xd0\xb8\xd0\xbc \xd0\xbe\xd0\xb1\xd1\x80\xd0\xb0\xd0\xb7\xd0\xbe\xd0\xbc. \xd0\x97\xd0\xb0\xd1\x84\xd0\xb8\xd0\xba\xd1\x81\xd0\xb8\xd1\x80\xd1\x83\xd0\xb5\xd0\xbc \xd0\xbf\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xb7\xd0\xbe\xd0\xb2\xd0\xb0\xd1\x82\xd0\xb5\xd0\xbb\xd1\x8f x. \xd0\x9f\xd1\x83\xd1\x81\xd1\x82\xd1\x8c \xd0\xbd\xd0\xb5\xd0\xba\xd0\xbe\xd1\x82\xd0\xbe\xd1\x80\xd1\x8b\xd0\xb9 \xd0\xb4\xd1\x80\xd1\x83\xd0\xb3\xd0\xbe\xd0\xb9 \xd1\x87\xd0\xb5\xd0\xbb\xd0\xbe\xd0\xb2\xd0\xb5\xd0\xba y, \xd0\xbd\xd0\xb5 \xd1\x8f\xd0\xb2\xd0\xbb\xd1\x8f\xd1\x8e\xd1\x89\xd0\xb8\xd0\xb9\xd1\x81\xd1\x8f \xd0\xb4\xd1\x80\xd1\x83\xd0\xb3\xd0\xbe\xd0\xbc x \xd0\xbd\xd0\xb0 \xd1\x82\xd0\xb5\xd0\xba\xd1\x83\xd1\x89\xd0\xb8\xd0\xb9 \xd0\xbc\xd0\xbe\xd0\xbc\xd0\xb5\xd0\xbd\xd1\x82, \xd1\x8f\xd0\xb2\xd0\xbb\xd1\x8f\xd0\xb5\xd1\x82\xd1\x81\xd1\x8f \xd0\xb4\xd1\x80\xd1\x83\xd0\xb3\xd0\xbe\xd0\xbc \xd0\xbd\xd0\xb5 \xd0\xbc\xd0\xb5\xd0\xbd\xd0\xb5\xd0\xb5, \xd1\x87\xd0\xb5\xd0\xbc \xd0\xb4\xd0\xbb\xd1\x8f k% \xd0\xb4\xd1\x80\xd1\x83\xd0\xb7\xd0\xb5\xd0\xb9 x. \xd0\xa2\xd0\xbe\xd0\xb3\xd0\xb4\xd0\xb0 \xd0\xbe\xd0\xbd \xd1\x8f\xd0\xb2\xd0\xbb\xd1\x8f\xd0\xb5\xd1\x82\xd1\x81\xd1\x8f \xd0\xbf\xd1\x80\xd0\xb5\xd0\xb4\xd0\xbf\xd0\xbe\xd0\xbb\xd0\xb0\xd0\xb3\xd0\xb0\xd0\xb5\xd0\xbc\xd1\x8b\xd0\xbc \xd0\xb4\xd1\x80\xd1\x83\xd0\xb3\xd0\xbe\xd0\xbc \xd0\xb4\xd0\xbb\xd1\x8f x.\xd0\xa3 \xd0\xba\xd0\xb0\xd0\xb6\xd0\xb4\xd0\xbe\xd0\xb3\xd0\xbe \xd1\x87\xd0\xb5\xd0\xbb\xd0\xbe\xd0\xb2\xd0\xb5\xd0\xba\xd0\xb0 \xd0\xb2 \xd1\x81\xd0\xbe\xd1\x86\xd0\xb8\xd0\xb0\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe\xd0\xb9 \xd1\x81\xd0\xb5\xd1\x82\xd0\xb8 \xd0\xb5\xd1\x81\xd1\x82\xd1\x8c \xd1\x81\xd0\xb2\xd0\xbe\xd0\xb9 \xd1\x83\xd0\xbd\xd0\xb8\xd0\xba\xd0\xb0\xd0\xbb\xd1\x8c\xd0\xbd\xd1\x8b\xd0\xb9 \xd0\xb8\xd0\xb4\xd0\xb5\xd0\xbd\xd1\x82\xd0\xb8\xd1\x84\xd0\xb8\xd0\xba\xd0\xb0\xd1\x82\xd0\xbe\xd1\x80 \xe2\x80\x94 \xd1\x8d\xd1\x82\xd0\xbe \xd1\x86\xd0\xb5\xd0\xbb\xd0\xbe\xd0\xb5 \xd1\x87\xd0\xb8\xd1\x81\xd0\xbb\xd0\xbe \xd0\xbe\xd1\x82 1 \xd0\xb4\xd0\xbe 109. \xd0\x92\xd0\xb0\xd0\xbc \xd0\xb4\xd0\xb0\xd0\xbd \xd1\x81\xd0\xbf\xd0\xb8\xd1\x81\xd0\xbe\xd0\xba \xd0\xbf\xd0\xb0\xd1\x80 \xd0\xbf\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xb7\xd0\xbe\xd0\xb2\xd0\xb0\xd1\x82\xd0\xb5\xd0\xbb\xd0\xb5\xd0\xb9, \xd1\x8f\xd0\xb2\xd0\xbb\xd1\x8f\xd1\x8e\xd1\x89\xd0\xb8\xd1\x85\xd1\x81\xd1\x8f \xd0\xb4\xd1\x80\xd1\x83\xd0\xb7\xd1\x8c\xd1\x8f\xd0\xbc\xd0\xb8. \xd0\x9e\xd0\xbf\xd1\x80\xd0\xb5\xd0\xb4\xd0\xb5\xd0\xbb\xd0\xb8\xd1\x82\xd0\xb5 \xd0\xb4\xd0\xbb\xd1\x8f \xd0\xba\xd0\xb0\xd0\xb6\xd0\xb4\xd0\xbe\xd0\xb3\xd0\xbe \xd1\x83\xd0\xbf\xd0\xbe\xd0\xbc\xd1\x8f\xd0\xbd\xd1\x83\xd1\x82\xd0\xbe\xd0\xb3\xd0\xbe \xd0\xbf\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xb7\xd0\xbe\xd0\xb2\xd0\xb0\xd1\x82\xd0\xb5\xd0\xbb\xd1\x8f \xd0\xbc\xd0\xbd\xd0\xbe\xd0\xb6\xd0\xb5\xd1\x81\xd1\x82\xd0\xb2\xd0\xbe \xd0\xb5\xd0\xb3\xd0\xbe \xd0\xbf\xd1\x80\xd0\xb5\xd0\xb4\xd0\xbf\xd0\xbe\xd0\xbb\xd0\xb0\xd0\xb3\xd0\xb0\xd0\xb5\xd0\xbc\xd1\x8b\xd1\x85 \xd0\xb4\xd1\x80\xd1\x83\xd0\xb7\xd0\xb5\xd0\xb9." 1600
523D "Statistics of Recompressing Videos" "*special problem,data structures,implementation" "A social network for dogs called DH (DogHouse) has k special servers to recompress uploaded videos of cute cats. After each video is uploaded, it should be recompressed on one (any) of the servers, and only after that it can be saved in the social network.We know that each server takes one second to recompress a one minute fragment. Thus, any server takes m seconds to recompress a m minute video.We know the time when each of the n videos were uploaded to the network (in seconds starting from the moment all servers started working). All videos appear at different moments of time and they are recompressed in the order they appear. If some video appeared at time s, then its recompressing can start at that very moment, immediately. Some videos can await recompressing when all the servers are busy. In this case, as soon as a server is available, it immediately starts recompressing another video. The videos that await recompressing go in a queue. If by the moment the videos started being recompressed some servers are available, then any of them starts recompressing the video.For each video find the moment it stops being recompressed." 1600
523C "Name Quest" "*special problem,greedy" "A Martian boy is named s \xe2\x80\x94 he has got this name quite recently from his parents for his coming of age birthday. Now he enjoys looking for his name everywhere. If he sees that he can obtain his name from some string by removing zero or more letters (at that, the remaining letters remain in the same order), he gets happy. For example, if s=\xc2\xababa\xc2\xbb, then strings \xc2\xabbaobab\xc2\xbb, \xc2\xabaabbaa\xc2\xbb, \xc2\xabhelloabahello\xc2\xbb make him very happy and strings \xc2\xabaab\xc2\xbb, \xc2\xabbaaa\xc2\xbb and \xc2\xabhelloabhello\xc2\xbb do not.However rather than being happy once, he loves twice as much being happy twice! So, when he got string t as a present, he wanted to cut it in two parts (the left part and the right part) so that each part made him happy.Help s determine the number of distinct ways to cut the given string t into two parts in the required manner." 1400
523B "Mean Requests" "*special problem,implementation" "In this problem you will have to deal with a real algorithm that is used in the VK social network.As in any other company that creates high-loaded websites, the VK developers have to deal with request statistics regularly. An important indicator reflecting the load of the site is the mean number of requests for a certain period of time of T seconds (for example, T\xe2\x80\x89=\xe2\x80\x8960 seconds\xe2\x80\x89=\xe2\x80\x891 min and T\xe2\x80\x89=\xe2\x80\x8986400 seconds\xe2\x80\x89=\xe2\x80\x891 day). For example, if this value drops dramatically, that shows that the site has access problem. If this value grows, that may be a reason to analyze the cause for the growth and add more servers to the website if it is really needed.However, even such a natural problem as counting the mean number of queries for some period of time can be a challenge when you process the amount of data of a huge social network. That\'s why the developers have to use original techniques to solve problems approximately, but more effectively at the same time.Let\'s consider the following formal model. We have a service that works for n seconds. We know the number of queries to this resource at at each moment of time t (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89t\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n). Let\'s formulate the following algorithm of calculating the mean with exponential decay. Let c be some real number, strictly larger than one.// setting this constant value correctly can adjust   // the time range for which statistics will be calculateddouble c = some constant value; // as the result of the algorithm\'s performance this variable will contain // the mean number of queries for the last // T seconds by the current moment of timedouble mean = 0.0; for t = 1..n: // at each second, we do the following:    // at is the number of queries that came at the last second;    mean = (mean + at / T) / c;Thus, the mean variable is recalculated each second using the number of queries that came at that second. We can make some mathematical calculations and prove that choosing the value of constant c correctly will make the value of mean not very different from the real mean value ax at t\xe2\x80\x89-\xe2\x80\x89T\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89t. The advantage of such approach is that it only uses the number of requests at the current moment of time and doesn\'t require storing the history of requests for a large time range. Also, it considers the recent values with the weight larger than the weight of the old ones, which helps to react to dramatic change in values quicker.However before using the new theoretical approach in industrial programming, there is an obligatory step to make, that is, to test its credibility practically on given test data sets. Your task is to compare the data obtained as a result of the work of an approximate algorithm to the real data. You are given n values at, integer T and real number c. Also, you are given m moments pj (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m), where we are interested in the mean value of the number of queries for the last T seconds. Implement two algorithms. The first one should calculate the required value by definition, i.e. by the formula . The second algorithm should calculate the mean value as is described above. Print both values and calculate the relative error of the second algorithm by the formula , where approx is the approximate value, obtained by the second algorithm, and real is the exact value obtained by the first algorithm." 1500
523A "Rotate, Flip and Zoom" "*special problem,implementation" "Polycarp is writing the prototype of a graphic editor. He has already made up his mind that the basic image transformations in his editor will be: rotate the image 90 degrees clockwise, flip the image horizontally (symmetry relative to the vertical line, that is, the right part of the image moves to the left, and vice versa) and zooming on the image. He is sure that that there is a large number of transformations that can be expressed through these three.He has recently stopped implementing all three transformations for monochrome images. To test this feature, he asked you to write a code that will consecutively perform three actions with a monochrome image: first it will rotate the image 90 degrees clockwise, then it will flip the image horizontally and finally, it will zoom in twice on the image (that is, it will double all the linear sizes).Implement this feature to help Polycarp test his editor." 1200
522D "Closest Equals" "*special problem,data structures" "You are given sequence a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an and m queries lj,\xe2\x80\x89rj (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89lj\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89rj\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n). For each query you need to print the minimum distance between such pair of elements ax and ay (x\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89y), that:  both indexes of the elements lie within range [lj,\xe2\x80\x89rj], that is, lj\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x,\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89rj;  the values of the elements are equal, that is ax\xe2\x80\x89=\xe2\x80\x89ay. The text above understands distance as |x\xe2\x80\x89-\xe2\x80\x89y|." 2000
522C "Chicken or Fish?" greedy "Polycarp is flying in the airplane. Finally, it is his favorite time \xe2\x80\x94 the lunchtime. The BerAvia company stewardess is giving food consecutively to all the passengers from the 1-th one to the last one. Polycarp is sitting on seat m, that means, he will be the m-th person to get food.The flight menu has k dishes in total and when Polycarp boarded the flight, he had time to count the number of portions of each dish on board. Thus, he knows values a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89ak, where ai is the number of portions of the i-th dish.The stewardess has already given food to m\xe2\x80\x89-\xe2\x80\x891 passengers, gave Polycarp a polite smile and asked him what he would prefer. That\'s when Polycarp realized that they might have run out of some dishes by that moment. For some of the m\xe2\x80\x89-\xe2\x80\x891 passengers ahead of him, he noticed what dishes they were given. Besides, he\'s heard some strange mumbling from some of the m\xe2\x80\x89-\xe2\x80\x891 passengers ahead of him, similar to phrase \'I\'m disappointed\'. That happened when a passenger asked for some dish but the stewardess gave him a polite smile and said that they had run out of that dish. In that case the passenger needed to choose some other dish that was available. If Polycarp heard no more sounds from a passenger, that meant that the passenger chose his dish at the first try.Help Polycarp to find out for each dish: whether they could have run out of the dish by the moment Polyarp was served or that dish was definitely available." 2100
522B "Photo to Remember" "*special problem,data structures,dp,implementation" "One day n friends met at a party, they hadn\'t seen each other for a long time and so they decided to make a group photo together. Simply speaking, the process of taking photos can be described as follows. On the photo, each photographed friend occupies a rectangle of pixels: the i-th of them occupies the rectangle of width wi pixels and height hi pixels. On the group photo everybody stands in a line, thus the minimum pixel size of the photo including all the photographed friends, is W\xe2\x80\x89\xc3\x97\xe2\x80\x89H, where W is the total sum of all widths and H is the maximum height of all the photographed friends.As is usually the case, the friends made n photos \xe2\x80\x94 the j-th (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) photo had everybody except for the j-th friend as he was the photographer.Print the minimum size of each made photo in pixels." 1100
522A Reposts "*special problem,dfs and similar,dp,graphs,trees" "One day Polycarp published a funny picture in a social network making a poll about the color of his handle. Many of his friends started reposting Polycarp\'s joke to their news feed. Some of them reposted the reposts and so on.These events are given as a sequence of strings ""name1 reposted name2"", where name1 is the name of the person who reposted the joke, and name2 is the name of the person from whose news feed the joke was reposted. It is guaranteed that for each string ""name1 reposted name2"" user ""name1"" didn\'t have the joke in his feed yet, and ""name2"" already had it in his feed by the moment of repost. Polycarp was registered as ""Polycarp"" and initially the joke was only in his feed.Polycarp measures the popularity of the joke as the length of the largest repost chain. Print the popularity of Polycarp\'s joke." 1200
521E "Cycling City" "dfs and similar,graphs" "You are organizing a cycling race on the streets of the city. The city contains n junctions, some pairs of them are connected by roads; on each road you can move in any direction. No two roads connect the same pair of intersections, and no road connects the intersection with itself.You want the race to be open to both professional athletes and beginner cyclists, and that\'s why you will organize the race in three nominations: easy, moderate and difficult; each participant will choose the more suitable nomination. For each nomination you must choose the route \xe2\x80\x94 the chain of junctions, consecutively connected by roads. Routes must meet the following conditions: all three routes should start at the same intersection, and finish at the same intersection (place of start and finish can\'t be the same); to avoid collisions, no two routes can have common junctions (except for the common start and finish), and can not go along the same road (irrespective of the driving direction on the road for those two routes); no route must pass twice through the same intersection or visit the same road twice (irrespective of the driving direction on the road for the first and second time of visit).Preparing for the competition is about to begin, and you need to determine the routes of the race as quickly as possible. The length of the routes is not important, it is only important that all the given requirements were met." 3100
521D Shop greedy "Vasya plays one very well-known and extremely popular MMORPG game. His game character has k skill; currently the i-th of them equals to ai. Also this game has a common rating table in which the participants are ranked according to the product of all the skills of a hero in the descending order.Vasya decided to \'upgrade\' his character via the game store. This store offers n possible ways to improve the hero\'s skills; Each of these ways belongs to one of three types:  assign the i-th skill to b;  add b to the i-th skill;  multiply the i-th skill by b. Unfortunately, a) every improvement can only be used once; b) the money on Vasya\'s card is enough only to purchase not more than m of the n improvements. Help Vasya to reach the highest ranking in the game. To do this tell Vasya which of improvements he has to purchase and in what order he should use them to make his rating become as high as possible. If there are several ways to achieve it, print any of them." 2800
520E "Pluses everywhere" "combinatorics,dp,math,number theory" "Vasya is sitting on an extremely boring math class. To have fun, he took a piece of paper and wrote out n numbers on a single line. After that, Vasya began to write out different ways to put pluses (""+"") in the line between certain digits in the line so that the result was a correct arithmetic expression; formally, no two pluses in such a partition can stand together (between any two adjacent pluses there must be at least one digit), and no plus can stand at the beginning or the end of a line. For example, in the string 100500, ways 100500 (add no pluses), 1+00+500 or 10050+0 are correct, and ways 100++500, +1+0+0+5+0+0 or 100500+ are incorrect.The lesson was long, and Vasya has written all the correct ways to place exactly k pluses in a string of digits. At this point, he got caught having fun by a teacher and he was given the task to calculate the sum of all the resulting arithmetic expressions by the end of the lesson (when calculating the value of an expression the leading zeros should be ignored). As the answer can be large, Vasya is allowed to get only its remainder modulo 109\xe2\x80\x89+\xe2\x80\x897. Help him!" 2200
520D Cubes games,greedy,implementation "Once Vasya and Petya assembled a figure of m cubes, each of them is associated with a number between 0 and m\xe2\x80\x89-\xe2\x80\x891 (inclusive, each number appeared exactly once). Let\'s consider a coordinate system such that the OX is the ground, and the OY is directed upwards. Each cube is associated with the coordinates of its lower left corner, these coordinates are integers for each cube.The figure turned out to be stable. This means that for any cube that is not on the ground, there is at least one cube under it such that those two cubes touch by a side or a corner. More formally, this means that for the cube with coordinates (x,\xe2\x80\x89y) either y\xe2\x80\x89=\xe2\x80\x890, or there is a cube with coordinates (x\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89y\xe2\x80\x89-\xe2\x80\x891), (x,\xe2\x80\x89y\xe2\x80\x89-\xe2\x80\x891) or (x\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89y\xe2\x80\x89-\xe2\x80\x891).Now the boys want to disassemble the figure and put all the cubes in a row. In one step the cube is removed from the figure and being put to the right of the blocks that have already been laid. The guys remove the cubes in such order that the figure remains stable. To make the process more interesting, the guys decided to play the following game. The guys take out the cubes from the figure in turns. It is easy to see that after the figure is disassembled, the integers written on the cubes form a number, written in the m-ary positional numerical system (possibly, with a leading zero). Vasya wants the resulting number to be maximum possible, and Petya, on the contrary, tries to make it as small as possible. Vasya starts the game.Your task is to determine what number is formed after the figure is disassembled, if the boys play optimally. Determine the remainder of the answer modulo 109\xe2\x80\x89+\xe2\x80\x899." 2100
520C "DNA Alignment" math,strings "Vasya became interested in bioinformatics. He\'s going to write an article about similar cyclic DNA sequences, so he invented a new method for determining the similarity of cyclic sequences.Let\'s assume that strings s and t have the same length n, then the function h(s,\xe2\x80\x89t) is defined as the number of positions in which the respective symbols of s and t are the same. Function h(s,\xe2\x80\x89t) can be used to define the function of Vasya distance \xcf\x81(s,\xe2\x80\x89t):  where  is obtained from string s, by applying left circular shift i times. For example, \xcf\x81(""AGC"",\xe2\x80\x89""CGT"")\xe2\x80\x89=\xe2\x80\x89 h(""AGC"",\xe2\x80\x89""CGT"")\xe2\x80\x89+\xe2\x80\x89h(""AGC"",\xe2\x80\x89""GTC"")\xe2\x80\x89+\xe2\x80\x89h(""AGC"",\xe2\x80\x89""TCG"")\xe2\x80\x89+\xe2\x80\x89 h(""GCA"",\xe2\x80\x89""CGT"")\xe2\x80\x89+\xe2\x80\x89h(""GCA"",\xe2\x80\x89""GTC"")\xe2\x80\x89+\xe2\x80\x89h(""GCA"",\xe2\x80\x89""TCG"")\xe2\x80\x89+\xe2\x80\x89 h(""CAG"",\xe2\x80\x89""CGT"")\xe2\x80\x89+\xe2\x80\x89h(""CAG"",\xe2\x80\x89""GTC"")\xe2\x80\x89+\xe2\x80\x89h(""CAG"",\xe2\x80\x89""TCG"")\xe2\x80\x89=\xe2\x80\x89 1\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x890\xe2\x80\x89+\xe2\x80\x890\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x890\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89=\xe2\x80\x896Vasya found a string s of length n on the Internet. Now he wants to count how many strings t there are such that the Vasya distance from the string s attains maximum possible value. Formally speaking, t must satisfy the equation: .Vasya could not try all possible strings to find an answer, so he needs your help. As the answer may be very large, count the number of such strings modulo 109\xe2\x80\x89+\xe2\x80\x897." 1500
520B "Two Buttons" "dfs and similar,graphs,greedy,implementation,math,shortest paths" "Vasya has found a strange device. On the front panel of a device there are: a red button, a blue button and a display showing some positive integer. After clicking the red button, device multiplies the displayed number by two. After clicking the blue button, device subtracts one from the number on the display. If at some point the number stops being positive, the device breaks down. The display can show arbitrarily large numbers. Initially, the display shows number n.Bob wants to get number m on the display. What minimum number of clicks he has to make in order to achieve this result?" 1400
520A Pangram implementation,strings "A word or a sentence in some language is called a pangram if all the characters of the alphabet of this language appear in it at least once. Pangrams are often used to demonstrate fonts in printing or test the output devices.You are given a string consisting of lowercase and uppercase Latin letters. Check whether this string is a pangram. We say that the string contains a letter of the Latin alphabet if this letter occurs in the string in uppercase or lowercase." 800
519E "A and B and Lecture Rooms" "binary search,data structures,dfs and similar,dp,trees" "A and B are preparing themselves for programming contests.The University where A and B study is a set of rooms connected by corridors. Overall, the University has n rooms connected by n\xe2\x80\x89-\xe2\x80\x891 corridors so that you can get from any room to any other one by moving along the corridors. The rooms are numbered from 1 to n.Every day \xd0\x90 and B write contests in some rooms of their university, and after each contest they gather together in the same room and discuss problems. A and B want the distance from the rooms where problems are discussed to the rooms where contests are written to be equal. The distance between two rooms is the number of edges on the shortest path between them.As they write contests in new rooms every day, they asked you to help them find the number of possible rooms to discuss problems for each of the following m days." 2100
519D "A and B and Interesting Substrings" "data structures,dp,two pointers" "A and B are preparing themselves for programming contests.After several years of doing sports programming and solving many problems that require calculating all sorts of abstract objects, A and B also developed rather peculiar tastes.A likes lowercase letters of the Latin alphabet. He has assigned to each letter a number that shows how much he likes that letter (he has assigned negative numbers to the letters he dislikes). B likes substrings. He especially likes the ones that start and end with the same letter (their length must exceed one).Also, A and B have a string s. Now they are trying to find out how many substrings t of a string s are interesting to B (that is, t starts and ends with the same letter and its length is larger than one), and also the sum of values of all letters (assigned by A), except for the first and the last one is equal to zero.Naturally, A and B have quickly found the number of substrings t that are interesting to them. Can you do it?" 1800
519C "A and B and Team Training" "greedy,implementation,math,number theory" "A and B are preparing themselves for programming contests.An important part of preparing for a competition is sharing programming knowledge from the experienced members to those who are just beginning to deal with the contests. Therefore, during the next team training A decided to make teams so that newbies are solving problems together with experienced participants.A believes that the optimal team of three people should consist of one experienced participant and two newbies. Thus, each experienced participant can share the experience with a large number of people.However, B believes that the optimal team should have two experienced members plus one newbie. Thus, each newbie can gain more knowledge and experience.As a result, A and B have decided that all the teams during the training session should belong to one of the two types described above. Furthermore, they agree that the total number of teams should be as much as possible.There are n experienced members and m newbies on the training session. Can you calculate what maximum number of teams can be formed?" 1300
519B "A and B and Compilation Errors" "data structures,implementation,sortings" "A and B are preparing themselves for programming contests.B loves to debug his code. But before he runs the solution and starts debugging, he has to first compile the code.Initially, the compiler displayed n compilation errors, each of them is represented as a positive integer. After some effort, B managed to fix some mistake and then another one mistake.However, despite the fact that B is sure that he corrected the two errors, he can not understand exactly what compilation errors disappeared \xe2\x80\x94 the compiler of the language which B uses shows errors in the new order every time! B is sure that unlike many other programming languages, compilation errors for his programming language do not depend on each other, that is, if you correct one error, the set of other error does not change.Can you help B find out exactly what two errors he corrected?" 1100
519A "A and B and Chess" implementation "A and B are preparing themselves for programming contests.To train their logical thinking and solve problems better, A and B decided to play chess. During the game A wondered whose position is now stronger.For each chess piece we know its weight:   the queen\'s weight is 9,  the rook\'s weight is 5,  the bishop\'s weight is 3,  the knight\'s weight is 3,  the pawn\'s weight is 1,  the king\'s weight isn\'t considered in evaluating position. The player\'s weight equals to the sum of weights of all his pieces on the board.As A doesn\'t like counting, he asked you to help him determine which player has the larger position weight." 900
518F "Pasha and Pipe" "binary search,brute force,combinatorics,dp,implementation" "On a certain meeting of a ruling party ""A"" minister Pavel suggested to improve the sewer system and to create a new pipe in the city.The city is an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m rectangular squared field. Each square of the field is either empty (then the pipe can go in it), or occupied (the pipe cannot go in such square). Empty squares are denoted by character \'.\', occupied squares are denoted by character \'#\'.The pipe must meet the following criteria:  the pipe is a polyline of width 1,  the pipe goes in empty squares,  the pipe starts from the edge of the field, but not from a corner square,  the pipe ends at the edge of the field but not in a corner square,  the pipe has at most 2 turns (90 degrees),  the border squares of the field must share exactly two squares with the pipe,  if the pipe looks like a single segment, then the end points of the pipe must lie on distinct edges of the field,  for each non-border square of the pipe there are exacly two side-adjacent squares that also belong to the pipe,  for each border square of the pipe there is exactly one side-adjacent cell that also belongs to the pipe. Here are some samples of allowed piping routes:            ....#            ....#            .*..#           *****            ****.            .***.           ..#..            ..#*.            ..#*.           #...#            #..*#            #..*#           .....            ...*.            ...*.Here are some samples of forbidden piping routes:            .**.#            *...#            .*.*#           .....            ****.            .*.*.           ..#..            ..#*.            .*#*.           #...#            #..*#            #*.*#           .....            ...*.            .***.In these samples the pipes are represented by characters \'\xe2\x80\x89*\xe2\x80\x89\'.You were asked to write a program that calculates the number of distinct ways to make exactly one pipe in the city. The two ways to make a pipe are considered distinct if they are distinct in at least one square." 2300
518E "Arthur and Questions" "greedy,implementation,math,ternary search" "After bracket sequences Arthur took up number theory. He has got a new favorite sequence of length n (a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an), consisting of integers and integer k, not exceeding n.This sequence had the following property: if you write out the sums of all its segments consisting of k consecutive elements (a1 \xe2\x80\x89+\xe2\x80\x89 a2 ... \xe2\x80\x89+\xe2\x80\x89 ak,\xe2\x80\x89 a2 \xe2\x80\x89+\xe2\x80\x89 a3 \xe2\x80\x89+\xe2\x80\x89 ... \xe2\x80\x89+\xe2\x80\x89 ak\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89 ...,\xe2\x80\x89 an\xe2\x80\x89-\xe2\x80\x89k\xe2\x80\x89+\xe2\x80\x891 \xe2\x80\x89+\xe2\x80\x89 an\xe2\x80\x89-\xe2\x80\x89k\xe2\x80\x89+\xe2\x80\x892 \xe2\x80\x89+\xe2\x80\x89 ... \xe2\x80\x89+\xe2\x80\x89 an), then those numbers will form strictly increasing sequence.For example, for the following sample: n\xe2\x80\x89=\xe2\x80\x895,\xe2\x80\x89 k\xe2\x80\x89=\xe2\x80\x893,\xe2\x80\x89 a\xe2\x80\x89=\xe2\x80\x89(1,\xe2\x80\x89 2,\xe2\x80\x89 4,\xe2\x80\x89 5,\xe2\x80\x89 6) the sequence of numbers will look as follows: (1 \xe2\x80\x89+\xe2\x80\x89 2 \xe2\x80\x89+\xe2\x80\x89 4,\xe2\x80\x89 2 \xe2\x80\x89+\xe2\x80\x89 4 \xe2\x80\x89+\xe2\x80\x89 5,\xe2\x80\x89 4 \xe2\x80\x89+\xe2\x80\x89 5 \xe2\x80\x89+\xe2\x80\x89 6) = (7,\xe2\x80\x89 11,\xe2\x80\x89 15), that means that sequence a meets the described property. Obviously the sequence of sums will have n\xe2\x80\x89-\xe2\x80\x89k\xe2\x80\x89+\xe2\x80\x891 elements.Somebody (we won\'t say who) replaced some numbers in Arthur\'s sequence by question marks (if this number is replaced, it is replaced by exactly one question mark). We need to restore the sequence so that it meets the required property and also minimize the sum |ai|, where |ai| is the absolute value of ai." 2200
518D "Ilya and Escalator" combinatorics,dp,math,probabilities "Ilya got tired of sports programming, left university and got a job in the subway. He was given the task to determine the escalator load factor. Let\'s assume that n people stand in the queue for the escalator. At each second one of the two following possibilities takes place: either the first person in the queue enters the escalator with probability p, or the first person in the queue doesn\'t move with probability (1\xe2\x80\x89-\xe2\x80\x89p), paralyzed by his fear of escalators and making the whole queue wait behind him.Formally speaking, the i-th person in the queue cannot enter the escalator until people with indices from 1 to i\xe2\x80\x89-\xe2\x80\x891 inclusive enter it. In one second only one person can enter the escalator. The escalator is infinite, so if a person enters it, he never leaves it, that is he will be standing on the escalator at any following second. Ilya needs to count the expected value of the number of people standing on the escalator after t seconds. Your task is to help him solve this complicated task." 1700
518C "Anya and Smartphone" "constructive algorithms,data structures,implementation" "Anya has bought a new smartphone that uses Berdroid operating system. The smartphone menu has exactly n applications, each application has its own icon. The icons are located on different screens, one screen contains k icons. The icons from the first to the k-th one are located on the first screen, from the (k\xe2\x80\x89+\xe2\x80\x891)-th to the 2k-th ones are on the second screen and so on (the last screen may be partially empty).Initially the smartphone menu is showing the screen number 1. To launch the application with the icon located on the screen t, Anya needs to make the following gestures: first she scrolls to the required screen number t, by making t\xe2\x80\x89-\xe2\x80\x891 gestures (if the icon is on the screen t), and then make another gesture \xe2\x80\x94 press the icon of the required application exactly once to launch it.After the application is launched, the menu returns to the first screen. That is, to launch the next application you need to scroll through the menu again starting from the screen number 1.All applications are numbered from 1 to n. We know a certain order in which the icons of the applications are located in the menu at the beginning, but it changes as long as you use the operating system. Berdroid is intelligent system, so it changes the order of the icons by moving the more frequently used icons to the beginning of the list. Formally, right after an application is launched, Berdroid swaps the application icon and the icon of a preceding application (that is, the icon of an application on the position that is smaller by one in the order of menu). The preceding icon may possibly be located on the adjacent screen. The only exception is when the icon of the launched application already occupies the first place, in this case the icon arrangement doesn\'t change.Anya has planned the order in which she will launch applications. How many gestures should Anya make to launch the applications in the planned order? Note that one application may be launched multiple times." 1600
518B "Tanya and Postcard" greedy,implementation,strings "Little Tanya decided to present her dad a postcard on his Birthday. She has already created a message \xe2\x80\x94 string s of length n, consisting of uppercase and lowercase English letters. Tanya can\'t write yet, so she found a newspaper and decided to cut out the letters and glue them into the postcard to achieve string s. The newspaper contains string t, consisting of uppercase and lowercase English letters. We know that the length of string t greater or equal to the length of the string s.The newspaper may possibly have too few of some letters needed to make the text and too many of some other letters. That\'s why Tanya wants to cut some n letters out of the newspaper and make a message of length exactly n, so that it looked as much as possible like s. If the letter in some position has correct value and correct letter case (in the string s and in the string that Tanya will make), then she shouts joyfully ""YAY!"", and if the letter in the given position has only the correct value but it is in the wrong case, then the girl says ""WHOOPS"".Tanya wants to make such message that lets her shout ""YAY!"" as much as possible. If there are multiple ways to do this, then her second priority is to maximize the number of times she says ""WHOOPS"". Your task is to help Tanya make the message." 1400
518A "Vitaly and Strings" "constructive algorithms,strings" "Vitaly is a diligent student who never missed a lesson in his five years of studying in the university. He always does his homework on time and passes his exams in time. During the last lesson the teacher has provided two strings s and t to Vitaly. The strings have the same length, they consist of lowercase English letters, string s is lexicographically smaller than string t. Vitaly wondered if there is such string that is lexicographically larger than string s and at the same is lexicographically smaller than string t. This string should also consist of lowercase English letters and have the length equal to the lengths of strings s and t. Let\'s help Vitaly solve this easy problem!" 1600
516E "Drazil and His Happy Friends" "math,number theory" "Drazil has many friends. Some of them are happy and some of them are unhappy. Drazil wants to make all his friends become happy. So he invented the following plan.There are n boys and m girls among his friends. Let\'s number them from 0 to n\xe2\x80\x89-\xe2\x80\x891 and 0 to m\xe2\x80\x89-\xe2\x80\x891 separately. In i-th day, Drazil invites -th boy and -th girl to have dinner together (as Drazil is programmer, i starts from 0). If one of those two people is happy, the other one will also become happy. Otherwise, those two people remain in their states. Once a person becomes happy (or if it is happy originally), he stays happy forever.Drazil wants to know on which day all his friends become happy or to determine if they won\'t become all happy at all." 3100
516D "Drazil and Morning Exercise" "dfs and similar,dp,dsu,trees,two pointers" "Drazil and Varda are the earthworm couple. They want to find a good place to bring up their children. They found a good ground containing nature hole. The hole contains many rooms, some pairs of rooms are connected by small tunnels such that earthworm can move between them.Let\'s consider rooms and small tunnels as the vertices and edges in a graph. This graph is a tree. In the other words, any pair of vertices has an unique path between them.Each room that is leaf in the graph is connected with a ground by a vertical tunnel. Here, leaf is a vertex that has only one outgoing edge in the graph.Each room is large enough only to fit one earthworm living in it. Earthworm can\'t live in a tunnel.Drazil and Varda have a plan to educate their children. They want all their children to do morning exercises immediately after getting up!When the morning is coming, all earthworm children get up in the same time, then each of them chooses the farthest path to the ground for gathering with others (these children are lazy, so they all want to do exercises as late as possible).Drazil and Varda want the difference between the time first earthworm child arrives outside and the time the last earthworm child arrives outside to be not larger than l (otherwise children will spread around the ground and it will be hard to keep them exercising together).Also, The rooms that are occupied by their children should form a connected set. In the other words, for any two rooms that are occupied with earthworm children, all rooms that lie on the path between them should be occupied with earthworm children too.How many children Drazil and Varda may have at most in order to satisfy all conditions above? Drazil and Varda want to know the answer for many different choices of l.(Drazil and Varda don\'t live in the hole with their children)" 2800
515E "Drazil and Park" "data structures" "Drazil is a monkey. He lives in a circular park. There are n trees around the park. The distance between the i-th tree and (i\xe2\x80\x89+\xe2\x80\x891)-st trees is di, the distance between the n-th tree and the first tree is dn. The height of the i-th tree is hi.Drazil starts each day with the morning run. The morning run consists of the following steps:  Drazil chooses two different trees  He starts with climbing up the first tree  Then he climbs down the first tree, runs around the park (in one of two possible directions) to the second tree, and climbs on it  Then he finally climbs down the second tree. But there are always children playing around some consecutive trees. Drazil can\'t stand children, so he can\'t choose the trees close to children. He even can\'t stay close to those trees.If the two trees Drazil chooses are x-th and y-th, we can estimate the energy the morning run takes to him as 2(hx\xe2\x80\x89+\xe2\x80\x89hy)\xe2\x80\x89+\xe2\x80\x89dist(x,\xe2\x80\x89y). Since there are children on exactly one of two arcs connecting x and y, the distance dist(x,\xe2\x80\x89y) between trees x and y is uniquely defined.Now, you know that on the i-th day children play between ai-th tree and bi-th tree. More formally, if ai\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89bi, children play around the trees with indices from range [ai,\xe2\x80\x89bi], otherwise they play around the trees with indices from .Please help Drazil to determine which two trees he should choose in order to consume the most energy (since he wants to become fit and cool-looking monkey) and report the resulting amount of energy for each day." 2300
515D "Drazil and Tiles" "constructive algorithms,greedy" "Drazil created a following problem about putting 1\xe2\x80\x89\xc3\x97\xe2\x80\x892 tiles into an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m grid:""There is a grid with some cells that are empty and some cells that are occupied. You should use 1\xe2\x80\x89\xc3\x97\xe2\x80\x892 tiles to cover all empty cells and no two tiles should cover each other. And you should print a solution about how to do it.""But Drazil doesn\'t like to write special checking program for this task. His friend, Varda advised him: ""how about asking contestant only to print the solution when it exists and it is unique? Otherwise contestant may print \'Not unique\' "".Drazil found that the constraints for this task may be much larger than for the original task!Can you solve this new problem?Note that you should print \'Not unique\' either when there exists no solution or when there exists several different solutions for the original task." 2000
515C "Drazil and Factorial" greedy,math,sortings "Drazil is playing a math game with Varda.Let\'s define  for positive integer x as a product of factorials of its digits. For example, .First, they choose a decimal number a consisting of n digits that contains at least one digit larger than 1. This number may possibly start with leading zeroes. Then they should find maximum positive number x satisfying following two conditions:1. x doesn\'t contain neither digit 0 nor digit 1.2.  = .Help friends find such number." 1400
515B "Drazil and His Happy Friends" "brute force,dsu,meet-in-the-middle,number theory" "Drazil has many friends. Some of them are happy and some of them are unhappy. Drazil wants to make all his friends become happy. So he invented the following plan.There are n boys and m girls among his friends. Let\'s number them from 0 to n\xe2\x80\x89-\xe2\x80\x891 and 0 to m\xe2\x80\x89-\xe2\x80\x891 separately. In i-th day, Drazil invites -th boy and -th girl to have dinner together (as Drazil is programmer, i starts from 0). If one of those two people is happy, the other one will also become happy. Otherwise, those two people remain in their states. Once a person becomes happy (or if he/she was happy originally), he stays happy forever.Drazil wants to know whether he can use this plan to make all his friends become happy at some moment." 1300
515A "Drazil and Date" math "Someday, Drazil wanted to go on date with Varda. Drazil and Varda live on Cartesian plane. Drazil\'s home is located in point (0,\xe2\x80\x890) and Varda\'s home is located in point (a,\xe2\x80\x89b). In each step, he can move in a unit distance in horizontal or vertical direction. In other words, from position (x,\xe2\x80\x89y) he can go to positions (x\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89y), (x\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89y), (x,\xe2\x80\x89y\xe2\x80\x89+\xe2\x80\x891) or (x,\xe2\x80\x89y\xe2\x80\x89-\xe2\x80\x891). Unfortunately, Drazil doesn\'t have sense of direction. So he randomly chooses the direction he will go to in each step. He may accidentally return back to his house during his travel. Drazil may even not notice that he has arrived to (a,\xe2\x80\x89b) and continue travelling. Luckily, Drazil arrived to the position (a,\xe2\x80\x89b) successfully. Drazil said to Varda: ""It took me exactly s steps to travel from my house to yours"". But Varda is confused about his words, she is not sure that it is possible to get from (0,\xe2\x80\x890) to (a,\xe2\x80\x89b) in exactly s steps. Can you find out if it is possible for Varda?" 1000
514E "Darth Vader and Tree" dp,matrices "When Darth Vader gets bored, he sits down on the sofa, closes his eyes and thinks of an infinite rooted tree where each node has exactly n sons, at that for each node, the distance between it an its i-th left child equals to di. The Sith Lord loves counting the number of nodes in the tree that are at a distance at most x from the root. The distance is the sum of the lengths of edges on the path between nodes.But he has got used to this activity and even grew bored of it. \'Why does he do that, then?\' \xe2\x80\x94 you may ask. It\'s just that he feels superior knowing that only he can solve this problem. Do you want to challenge Darth Vader himself? Count the required number of nodes. As the answer can be rather large, find it modulo 109\xe2\x80\x89+\xe2\x80\x897." 2200
514D "R2D2 and Droid Army" "binary search,data structures,two pointers" "An army of n droids is lined up in one row. Each droid is described by m integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89am, where ai is the number of details of the i-th type in this droid\'s mechanism. R2-D2 wants to destroy the sequence of consecutive droids of maximum length. He has m weapons, the i-th weapon can affect all the droids in the army by destroying one detail of the i-th type (if the droid doesn\'t have details of this type, nothing happens to it). A droid is considered to be destroyed when all of its details are destroyed. R2-D2 can make at most k shots. How many shots from the weapon of what type should R2-D2 make to destroy the sequence of consecutive droids of maximum length?" 2000
514C "Watto and Mechanism" "binary search,data structures,hashing,string suffix structures,strings" "Watto, the owner of a spare parts store, has recently got an order for the mechanism that can process strings in a certain way. Initially the memory of the mechanism is filled with n strings. Then the mechanism should be able to process queries of the following type: ""Given string s, determine if the memory of the mechanism contains string t that consists of the same number of characters as s and differs from s in exactly one position"".Watto has already compiled the mechanism, all that\'s left is to write a program for it and check it on the data consisting of n initial lines and m queries. He decided to entrust this job to you." 2000
514B "Han Solo and Lazer Gun" "brute force,data structures,geometry,implementation,math" "There are n Imperial stormtroopers on the field. The battle field is a plane with Cartesian coordinate system. Each stormtrooper is associated with his coordinates (x,\xe2\x80\x89y) on this plane. Han Solo has the newest duplex lazer gun to fight these stormtroopers. It is situated at the point (x0,\xe2\x80\x89y0). In one shot it can can destroy all the stormtroopers, situated on some line that crosses point (x0,\xe2\x80\x89y0).Your task is to determine what minimum number of shots Han Solo needs to defeat all the stormtroopers.The gun is the newest invention, it shoots very quickly and even after a very large number of shots the stormtroopers don\'t have enough time to realize what\'s happening and change their location." 1400
514A "Chewba\xd1\x81ca and Number" greedy,implementation "Luke Skywalker gave Chewbacca an integer number x. Chewbacca isn\'t good at numbers but he loves inverting digits in them. Inverting digit t means replacing it with digit 9\xe2\x80\x89-\xe2\x80\x89t. Help Chewbacca to transform the initial number x to the minimum possible positive number by inverting some (possibly, zero) digits. The decimal representation of the final number shouldn\'t start with a zero." 1200
513G3 "Inversions problem" dp "You are given a permutation of n numbers p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pn. We perform k operations of the following type: choose uniformly at random two indices l and r (l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r) and reverse the order of the elements pl,\xe2\x80\x89pl\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89pr. Your task is to find the expected value of the number of inversions in the resulting permutation." 3100
513G2 "Inversions problem" dp,probabilities "You are given a permutation of n numbers p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pn. We perform k operations of the following type: choose uniformly at random two indices l and r (l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r) and reverse the order of the elements pl,\xe2\x80\x89pl\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89pr. Your task is to find the expected value of the number of inversions in the resulting permutation." 2400
513G1 "Inversions problem" "brute force,dfs and similar,dp,meet-in-the-middle" "You are given a permutation of n numbers p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pn. We perform k operations of the following type: choose uniformly at random two indices l and r (l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r) and reverse the order of the elements pl,\xe2\x80\x89pl\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89pr. Your task is to find the expected value of the number of inversions in the resulting permutation." 1800
513F2 Scaygerboss flows "Cthulhu decided to catch Scaygerboss. Scaygerboss found it out and is trying to hide in a pack of his scaygers. Each scayger except Scaygerboss is either a male or a female. Scaygerboss\'s gender is ""other"".Scaygers are scattered on a two-dimensional map divided into cells. A scayger looks nerdy and loveable if it is staying in the same cell with exactly one scayger of a gender that is different from its own gender. Cthulhu will not be able to catch Scaygerboss if all the scaygers on the map look nerdy and loveable.The scaygers can move around at different speeds. For each scayger, we are given the time it takes this scayger to move from a cell to an adjacent cell. Cells are adjacent if they share a common side. At any point of time, each cell that does not contain an obstacle can be occupied by an arbitrary number of scaygers. Scaygers cannot move to cells with obstacles.Calculate minimal time in order to make all scaygers look nerdy and loveable if they move optimally toward this goal." 2800
513F1 Scaygerboss flows "Cthulhu decided to catch Scaygerboss. Scaygerboss found it out and is trying to hide in a pack of his scaygers. Each scayger except Scaygerboss is either a male or a female. Scaygerboss\'s gender is ""other"".Scaygers are scattered on a two-dimensional map divided into cells. A scayger looks nerdy and loveable if it is staying in the same cell with exactly one scayger of a gender that is different from its own gender. Cthulhu will not be able to catch Scaygerboss if all the scaygers on the map look nerdy and loveable.The scaygers can move around at different speeds. For each scayger, we are given the time it takes this scayger to move from a cell to an adjacent cell. Cells are adjacent if they share a common side. At any point of time, each cell that does not contain an obstacle can be occupied by an arbitrary number of scaygers. Scaygers cannot move to cells with obstacles.Calculate minimal time in order to make all scaygers look nerdy and loveable if they move optimally toward this goal." 2700
513E2 "Subarray Cuts" dp "You are given an array of length n and a number k. Let\'s pick k non-overlapping non-empty subarrays of the initial array. Let si be the sum of the i-th subarray in order from left to right. Compute the maximum value of the following expression: |s1\xe2\x80\x89-\xe2\x80\x89s2|\xe2\x80\x89+\xe2\x80\x89|s2\xe2\x80\x89-\xe2\x80\x89s3|\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89|sk\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89-\xe2\x80\x89sk|Here subarray is a contiguous part of an array." 2700
513E1 "Subarray Cuts" dp "You are given an array of length n and a number k. Let\'s pick k non-overlapping non-empty subarrays of the initial array. Let si be the sum of the i-th subarray in order from left to right. Compute the maximum value of the following expression: |s1\xe2\x80\x89-\xe2\x80\x89s2|\xe2\x80\x89+\xe2\x80\x89|s2\xe2\x80\x89-\xe2\x80\x89s3|\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89|sk\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89-\xe2\x80\x89sk|Here subarray is a contiguous part of an array." 2600
513D2 "Constrained Tree" "constructive algorithms,data structures" "You need to find a binary tree of size n that satisfies a given set of c constraints. Suppose that the nodes of the unknown binary tree are labeled using a pre-order traversal starting with 1. For the i-th constraint you are given two labels, ai and bi and a direction, left or right. In case of left direction, bi is an element of the subtree rooted at ai\'s left child. Similarly in the case of right direction bi is an element of the subtree rooted at ai\'s right child." 2600
513D1 "Constrained Tree" "dfs and similar" "You need to find a binary tree of size n that satisfies a given set of c constraints. Suppose that the nodes of the unknown binary tree are labeled using a pre-order traversal starting with 1. For the i-th constraint you are given two labels, ai and bi and a direction, left or right. In case of left direction, bi is an element of the subtree rooted at ai\'s left child. Similarly in the case of right direction bi is an element of the subtree rooted at ai\'s right child." 2400
513C "Second price auction" bitmasks,probabilities "Nowadays, most of the internet advertisements are not statically linked to a web page. Instead, what will be shown to the person opening a web page is determined within 100 milliseconds after the web page is opened. Usually, multiple companies compete for each ad slot on the web page in an auction. Each of them receives a request with details about the user, web page and ad slot and they have to respond within those 100 milliseconds with a bid they would pay for putting an advertisement on that ad slot. The company that suggests the highest bid wins the auction and gets to place its advertisement. If there are several companies tied for the highest bid, the winner gets picked at random.However, the company that won the auction does not have to pay the exact amount of its bid. In most of the cases, a second-price auction is used. This means that the amount paid by the company is equal to the maximum of all the other bids placed for this ad slot.Let\'s consider one such bidding. There are n companies competing for placing an ad. The i-th of these companies will bid an integer number of microdollars equiprobably randomly chosen from the range between Li and Ri, inclusive. In the other words, the value of the i-th company bid can be any integer from the range [Li,\xe2\x80\x89Ri] with the same probability. Determine the expected value that the winner will have to pay in a second-price auction." 2000
513B2 Permutations "bitmasks,divide and conquer,math" "You are given a permutation p of numbers 1,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89n. Let\'s define f(p) as the following sum:Find the lexicographically m-th permutation of length n in the set of permutations having the maximum possible value of f(p)." 1800
513B1 Permutations "brute force" "You are given a permutation p of numbers 1,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89n. Let\'s define f(p) as the following sum:Find the lexicographically m-th permutation of length n in the set of permutations having the maximum possible value of f(p)." 1400
513A Game "constructive algorithms,math" "Two players play a simple game. Each player is provided with a box with balls. First player\'s box contains exactly n1 balls and second player\'s box contains exactly n2 balls. In one move first player can take from 1 to k1 balls from his box and throw them away. Similarly, the second player can take from 1 to k2 balls from his box in his move. Players alternate turns and the first player starts the game. The one who can\'t make a move loses. Your task is to determine who wins if both players play optimally." 800
512E "Fox And Polygon" "constructive algorithms,divide and conquer" "Fox Ciel just designed a puzzle game called ""Polygon""! It is played using triangulations of a regular n-edge polygon. The goal is to transform one triangulation to another by some tricky rules.Triangulation of an n-edge poylgon is a set of n\xe2\x80\x89-\xe2\x80\x893 diagonals satisfying the condition that no two diagonals share a common internal point.For example, the initial state of the game may look like (a) in above figure. And your goal may look like (c). In each step you can choose a diagonal inside the polygon (but not the one of edges of the polygon) and flip this diagonal. Suppose you are going to flip a diagonal a\xe2\x80\x89\xe2\x80\x93\xe2\x80\x89b. There always exist two triangles sharing a\xe2\x80\x89\xe2\x80\x93\xe2\x80\x89b as a side, let\'s denote them as a\xe2\x80\x89\xe2\x80\x93\xe2\x80\x89b\xe2\x80\x89\xe2\x80\x93\xe2\x80\x89c and a\xe2\x80\x89\xe2\x80\x93\xe2\x80\x89b\xe2\x80\x89\xe2\x80\x93\xe2\x80\x89d. As a result of this operation, the diagonal a\xe2\x80\x89\xe2\x80\x93\xe2\x80\x89b is replaced by a diagonal c\xe2\x80\x89\xe2\x80\x93\xe2\x80\x89d. It can be easily proven that after flip operation resulting set of diagonals is still a triangulation of the polygon.So in order to solve above case, you may first flip diagonal 6\xe2\x80\x89\xe2\x80\x93\xe2\x80\x893, it will be replaced by diagonal 2\xe2\x80\x89\xe2\x80\x93\xe2\x80\x894. Then you flip diagonal 6\xe2\x80\x89\xe2\x80\x93\xe2\x80\x894 and get figure (c) as result.Ciel just proved that for any starting and destination triangulations this game has a solution. She wants you to solve it in no more than 20\xe2\x80\x89000 steps for any puzzle satisfying n\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x891000." 2900
512D "Fox And Travelling" dp,trees "Fox Ciel is going to travel to New Foxland during this summer.New Foxland has n attractions that are linked by m undirected roads. Two attractions are called adjacent if they are linked by a road. Fox Ciel has k days to visit this city and each day she will visit exactly one attraction.There is one important rule in New Foxland: you can\'t visit an attraction if it has more than one adjacent attraction that you haven\'t visited yet.At the beginning Fox Ciel haven\'t visited any attraction. During her travelling she may move aribtrarly between attraction. After visiting attraction a, she may travel to any attraction b satisfying conditions above that hasn\'t been visited yet, even if it is not reachable from a by using the roads (Ciel uses boat for travelling between attractions, so it is possible). She wants to know how many different travelling plans she can make. Calculate this number modulo 109\xe2\x80\x89+\xe2\x80\x899 for every k from 0 to n since she hasn\'t decided for how many days she is visiting New Foxland." 2900
510E "Fox And Dinner" flows "Fox Ciel is participating in a party in Prime Kingdom. There are n foxes there (include Fox Ciel). The i-th fox is ai years old.They will have dinner around some round tables. You want to distribute foxes such that:  Each fox is sitting at some table.  Each table has at least 3 foxes sitting around it.  The sum of ages of any two adjacent foxes around each table should be a prime number. If k foxes f1, f2, ..., fk are sitting around table in clockwise order, then for 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k\xe2\x80\x89-\xe2\x80\x891: fi and fi\xe2\x80\x89+\xe2\x80\x891 are adjacent, and f1 and fk are also adjacent.If it is possible to distribute the foxes in the desired manner, find out a way to do that." 2300
510D "Fox And Jumping" "bitmasks,brute force,dp,math" "Fox Ciel is playing a game. In this game there is an infinite long tape with cells indexed by integers (positive, negative and zero). At the beginning she is standing at the cell 0.There are also n cards, each card has 2 attributes: length li and cost ci. If she pays ci dollars then she can apply i-th card. After applying i-th card she becomes able to make jumps of length li, i. e. from cell x to cell (x\xe2\x80\x89-\xe2\x80\x89li) or cell (x\xe2\x80\x89+\xe2\x80\x89li).She wants to be able to jump to any cell on the tape (possibly, visiting some intermediate cells). For achieving this goal, she wants to buy some cards, paying as little money as possible. If this is possible, calculate the minimal cost." 1900
510C "Fox And Names" "dfs and similar,graphs,sortings" "Fox Ciel is going to publish a paper on FOCS (Foxes Operated Computer Systems, pronounce: ""Fox""). She heard a rumor: the authors list on the paper is always sorted in the lexicographical order. After checking some examples, she found out that sometimes it wasn\'t true. On some papers authors\' names weren\'t sorted in lexicographical order in normal sense. But it was always true that after some modification of the order of letters in alphabet, the order of authors becomes lexicographical!She wants to know, if there exists an order of letters in Latin alphabet such that the names on the paper she is submitting are following in the lexicographical order. If so, you should find out any such order.Lexicographical order is defined in following way. When we compare s and t, first we find the leftmost position with differing characters: si\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89ti. If there is no such position (i. e. s is a prefix of t or vice versa) the shortest string is less. Otherwise, we compare characters si and ti according to their order in alphabet." 1600
510B "Fox And Two Dots" "dfs and similar" "Fox Ciel is playing a mobile puzzle game called ""Two Dots"". The basic levels are played on a board of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m cells, like this:Each cell contains a dot that has some color. We will use different uppercase Latin characters to express different colors.The key of this game is to find a cycle that contain dots of same color. Consider 4 blue dots on the picture forming a circle as an example. Formally, we call a sequence of dots d1,\xe2\x80\x89d2,\xe2\x80\x89...,\xe2\x80\x89dk a cycle if and only if it meets the following condition:  These k dots are different: if i\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89j then di is different from dj.  k is at least 4.  All dots belong to the same color.  For all 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k\xe2\x80\x89-\xe2\x80\x891: di and di\xe2\x80\x89+\xe2\x80\x891 are adjacent. Also, dk and d1 should also be adjacent. Cells x and y are called adjacent if they share an edge. Determine if there exists a cycle on the field." 1500
510A "Fox And Snake" implementation "Fox Ciel starts to learn programming. The first task is drawing a fox! However, that turns out to be too hard for a beginner, so she decides to draw a snake instead.A snake is a pattern on a n by m table. Denote c-th cell of r-th row as (r,\xe2\x80\x89c). The tail of the snake is located at (1,\xe2\x80\x891), then it\'s body extends to (1,\xe2\x80\x89m), then goes down 2 rows to (3,\xe2\x80\x89m), then goes left to (3,\xe2\x80\x891) and so on.Your task is to draw this snake for Fox Ciel: the empty cells should be represented as dot characters (\'.\') and the snake cells should be filled with number signs (\'#\').Consider sample tests in order to understand the snake pattern." 800
509F "Progress Monitoring" dp,trees "Programming teacher Dmitry Olegovich is going to propose the following task for one of his tests for students:You are given a tree T with n vertices, specified by its adjacency matrix a[1... n,\xe2\x80\x891... n]. What is the output of the following pseudocode?used[1 ... n] = {0, ..., 0};procedure dfs(v):    print v;    used[v] = 1;    for i = 1, 2, ..., n:        if (a[v][i] == 1 and used[i] == 0):            dfs(i);dfs(1);In order to simplify the test results checking procedure, Dmitry Olegovich decided to create a tree T such that the result is his favorite sequence b. On the other hand, Dmitry Olegovich doesn\'t want to provide students with same trees as input, otherwise they might cheat. That\'s why Dmitry Olegovich is trying to find out the number of different trees T such that the result of running the above pseudocode with T as input is exactly the sequence b. Can you help him?Two trees with n vertices are called different if their adjacency matrices a1 and a2 are different, i. e. there exists a pair (i,\xe2\x80\x89j), such that 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i,\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n and a1[i][j]\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89a2[i][j]." 2300
509E "Pretty Song" math,strings "When Sasha was studying in the seventh grade, he started listening to music a lot. In order to evaluate which songs he likes more, he introduced the notion of the song\'s prettiness. The title of the song is a word consisting of uppercase Latin letters. The prettiness of the song is the prettiness of its title.Let\'s define the simple prettiness of a word as the ratio of the number of vowels in the word to the number of all letters in the word.Let\'s define the prettiness of a word as the sum of simple prettiness of all the substrings of the word.More formally, let\'s define the function vowel(c) which is equal to 1, if c is a vowel, and to 0 otherwise. Let si be the i-th character of string s, and si..j be the substring of word s, staring at the i-th character and ending at the j-th character (sisi\xe2\x80\x89+\xe2\x80\x891... sj, i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j).Then the simple prettiness of s is defined by the formula:The prettiness of s equals Find the prettiness of the given song title.We assume that the vowels are I,\xe2\x80\x89E,\xe2\x80\x89A,\xe2\x80\x89O,\xe2\x80\x89U,\xe2\x80\x89Y." 2000
509D "Restoring Numbers" "constructive algorithms,math" "Vasya had two arrays consisting of non-negative integers: a of size n and b of size m. Vasya chose a positive integer k and created an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m matrix v using the following formula:Vasya wrote down matrix v on a piece of paper and put it in the table.A year later Vasya was cleaning his table when he found a piece of paper containing an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m matrix w. He remembered making a matrix one day by the rules given above but he was not sure if he had found the paper with the matrix v from those days. Your task is to find out if the matrix w that you\'ve found could have been obtained by following these rules and if it could, then for what numbers k,\xe2\x80\x89a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an,\xe2\x80\x89b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bm it is possible." 2200
509C "Sums of Digits" dp,greedy,implementation "Vasya had a strictly increasing sequence of positive integers a1, ..., an. Vasya used it to build a new sequence b1, ..., bn, where bi is the sum of digits of ai\'s decimal representation. Then sequence ai got lost and all that remained is sequence bi.Vasya wonders what the numbers ai could be like. Of all the possible options he likes the one sequence with the minimum possible last number an. Help Vasya restore the initial sequence.It is guaranteed that such a sequence always exists." 2000
509B "Painting Pebbles" "constructive algorithms,greedy,implementation" "There are n piles of pebbles on the table, the i-th pile contains ai pebbles. Your task is to paint each pebble using one of the k given colors so that for each color c and any two piles i and j the difference between the number of pebbles of color c in pile i and number of pebbles of color c in pile j is at most one.In other words, let\'s say that bi,\xe2\x80\x89c is the number of pebbles of color c in the i-th pile. Then for any 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89c\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k, 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i,\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n the following condition must be satisfied |bi,\xe2\x80\x89c\xe2\x80\x89-\xe2\x80\x89bj,\xe2\x80\x89c|\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x891. It isn\'t necessary to use all k colors: if color c hasn\'t been used in pile i, then bi,\xe2\x80\x89c is considered to be zero." 1300
509A "Maximum in Table" "brute force,implementation" "An n\xe2\x80\x89\xc3\x97\xe2\x80\x89n table a is defined as follows:  The first row and the first column contain ones, that is: ai,\xe2\x80\x891\xe2\x80\x89=\xe2\x80\x89a1,\xe2\x80\x89i\xe2\x80\x89=\xe2\x80\x891 for all i\xe2\x80\x89=\xe2\x80\x891,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89n.  Each of the remaining numbers in the table is equal to the sum of the number above it and the number to the left of it. In other words, the remaining elements are defined by the formula ai,\xe2\x80\x89j\xe2\x80\x89=\xe2\x80\x89ai\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89j\xe2\x80\x89+\xe2\x80\x89ai,\xe2\x80\x89j\xe2\x80\x89-\xe2\x80\x891. These conditions define all the values in the table.You are given a number n. You need to determine the maximum value in the n\xe2\x80\x89\xc3\x97\xe2\x80\x89n table defined by the rules above." 800
508E "Arthur and Brackets" dp,greedy "Notice that the memory limit is non-standard.Recently Arthur and Sasha have studied correct bracket sequences. Arthur understood this topic perfectly and become so amazed about correct bracket sequences, so he even got himself a favorite correct bracket sequence of length 2n. Unlike Arthur, Sasha understood the topic very badly, and broke Arthur\'s favorite correct bracket sequence just to spite him.All Arthur remembers about his favorite sequence is for each opening parenthesis (\'(\') the approximate distance to the corresponding closing one (\')\'). For the i-th opening bracket he remembers the segment [li,\xe2\x80\x89ri], containing the distance to the corresponding closing bracket.Formally speaking, for the i-th opening bracket (in order from left to right) we know that the difference of its position and the position of the corresponding closing bracket belongs to the segment [li,\xe2\x80\x89ri].Help Arthur restore his favorite correct bracket sequence!" 2200
508D "Tanya and Password" "dfs and similar,graphs" "While dad was at work, a little girl Tanya decided to play with dad\'s password to his secret database. Dad\'s password is a string consisting of n\xe2\x80\x89+\xe2\x80\x892 characters. She has written all the possible n three-letter continuous substrings of the password on pieces of paper, one for each piece of paper, and threw the password out. Each three-letter substring was written the number of times it occurred in the password. Thus, Tanya ended up with n pieces of paper.Then Tanya realized that dad will be upset to learn about her game and decided to restore the password or at least any string corresponding to the final set of three-letter strings. You have to help her in this difficult task. We know that dad\'s password consisted of lowercase and uppercase letters of the Latin alphabet and digits. Uppercase and lowercase letters of the Latin alphabet are considered distinct." 2500
508C "Anya and Ghosts" "constructive algorithms,greedy" "Anya loves to watch horror movies. In the best traditions of horror, she will be visited by m ghosts tonight. Anya has lots of candles prepared for the visits, each candle can produce light for exactly t seconds. It takes the girl one second to light one candle. More formally, Anya can spend one second to light one candle, then this candle burns for exactly t seconds and then goes out and can no longer be used.For each of the m ghosts Anya knows the time at which it comes: the i-th visit will happen wi seconds after midnight, all wi\'s are distinct. Each visit lasts exactly one second.What is the minimum number of candles Anya should use so that during each visit, at least r candles are burning? Anya can start to light a candle at any time that is integer number of seconds from midnight, possibly, at the time before midnight. That means, she can start to light a candle integer number of seconds before midnight or integer number of seconds after a midnight, or in other words in any integer moment of time." 1600
508B "Anton and currency you all know" greedy,math,strings "Berland, 2016. The exchange rate of currency you all know against the burle has increased so much that to simplify the calculations, its fractional part was neglected and the exchange rate is now assumed to be an integer.Reliable sources have informed the financier Anton of some information about the exchange rate of currency you all know against the burle for tomorrow. Now Anton knows that tomorrow the exchange rate will be an even number, which can be obtained from the present rate by swapping exactly two distinct digits in it. Of all the possible values that meet these conditions, the exchange rate for tomorrow will be the maximum possible. It is guaranteed that today the exchange rate is an odd positive integer n. Help Anton to determine the exchange rate of currency you all know for tomorrow!" 1300
508A "Pasha and Pixels" "brute force" "Pasha loves his phone and also putting his hair up... But the hair is now irrelevant.Pasha has installed a new game to his phone. The goal of the game is following. There is a rectangular field consisting of n row with m pixels in each row. Initially, all the pixels are colored white. In one move, Pasha can choose any pixel and color it black. In particular, he can choose the pixel that is already black, then after the boy\'s move the pixel does not change, that is, it remains black. Pasha loses the game when a 2\xe2\x80\x89\xc3\x97\xe2\x80\x892 square consisting of black pixels is formed. Pasha has made a plan of k moves, according to which he will paint pixels. Each turn in his plan is represented as a pair of numbers i and j, denoting respectively the row and the column of the pixel to be colored on the current move.Determine whether Pasha loses if he acts in accordance with his plan, and if he does, on what move the 2\xe2\x80\x89\xc3\x97\xe2\x80\x892 square consisting of black pixels is formed." 1100
507E "Breaking Good" "dfs and similar,dp,graphs,shortest paths" "Breaking Good is a new video game which a lot of gamers want to have. There is a certain level in the game that is really difficult even for experienced gamers.Walter William, the main character of the game, wants to join a gang called Los Hermanos (The Brothers). The gang controls the whole country which consists of n cities with m bidirectional roads connecting them. There is no road is connecting a city to itself and for any two cities there is at most one road between them. The country is connected, in the other words, it is possible to reach any city from any other city using the given roads. The roads aren\'t all working. There are some roads which need some more work to be performed to be completely functioning.The gang is going to rob a bank! The bank is located in city 1. As usual, the hardest part is to escape to their headquarters where the police can\'t get them. The gang\'s headquarters is in city n. To gain the gang\'s trust, Walter is in charge of this operation, so he came up with a smart plan.First of all the path which they are going to use on their way back from city 1 to their headquarters n must be as short as possible, since it is important to finish operation as fast as possible.Then, gang has to blow up all other roads in country that don\'t lay on this path, in order to prevent any police reinforcements. In case of non-working road, they don\'t have to blow up it as it is already malfunctional. If the chosen path has some roads that doesn\'t work they\'ll have to repair those roads before the operation.Walter discovered that there was a lot of paths that satisfied the condition of being shortest possible so he decided to choose among them a path that minimizes the total number of affected roads (both roads that have to be blown up and roads to be repaired).Can you help Walter complete his task and gain the gang\'s trust?" 2100
507D "The Maths Lecture" dp,implementation "Amr doesn\'t like Maths as he finds it really boring, so he usually sleeps in Maths lectures. But one day the teacher suspected that Amr is sleeping and asked him a question to make sure he wasn\'t.First he gave Amr two positive integers n and k. Then he asked Amr, how many integer numbers x\xe2\x80\x89>\xe2\x80\x890 exist such that:  Decimal representation of x (without leading zeroes) consists of exactly n digits;  There exists some integer y\xe2\x80\x89>\xe2\x80\x890 such that:   ;  decimal representation of y is a suffix of decimal representation of x.  As the answer to this question may be pretty huge the teacher asked Amr to output only its remainder modulo a number m.Can you help Amr escape this embarrassing situation?" 2200
507C "Guess Your Way Out!" implementation,math,trees "Amr bought a new video game ""Guess Your Way Out!"". The goal of the game is to find an exit from the maze that looks like a perfect binary tree of height h. The player is initially standing at the root of the tree and the exit from the tree is located at some leaf node. Let\'s index all the leaf nodes from the left to the right from 1 to 2h. The exit is located at some node n where 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x892h, the player doesn\'t know where the exit is so he has to guess his way out!Amr follows simple algorithm to choose the path. Let\'s consider infinite command string ""LRLRLRLRL..."" (consisting of alternating characters \'L\' and \'R\'). Amr sequentially executes the characters of the string using following rules:  Character \'L\' means ""go to the left child of the current node"";  Character \'R\' means ""go to the right child of the current node"";  If the destination node is already visited, Amr skips current command, otherwise he moves to the destination node;  If Amr skipped two consecutive commands, he goes back to the parent of the current node before executing next command;  If he reached a leaf node that is not the exit, he returns to the parent of the current node;  If he reaches an exit, the game is finished. Now Amr wonders, if he follows this algorithm, how many nodes he is going to visit before reaching the exit?" 1700
507B "Amr and Pins" geometry,math "Amr loves Geometry. One day he came up with a very interesting problem.Amr has a circle of radius r and center in point (x,\xe2\x80\x89y). He wants the circle center to be in new position (x\',\xe2\x80\x89y\').In one step Amr can put a pin to the border of the circle in a certain point, then rotate the circle around that pin by any angle and finally remove the pin.Help Amr to achieve his goal in minimum number of steps." 1400
507A "Amr and Music" greedy,implementation,sortings "Amr is a young coder who likes music a lot. He always wanted to learn how to play music but he was busy coding so he got an idea.Amr has n instruments, it takes ai days to learn i-th instrument. Being busy, Amr dedicated k days to learn how to play the maximum possible number of instruments.Amr asked for your help to distribute his free days between instruments so that he can achieve his goal." 1000
506E "Mr. Kitayuta\'s Gift" combinatorics,dp,matrices,strings "Mr. Kitayuta has kindly given you a string s consisting of lowercase English letters. You are asked to insert exactly n lowercase English letters into s to make it a palindrome. (A palindrome is a string that reads the same forward and backward. For example, ""noon"", ""testset"" and ""a"" are all palindromes, while ""test"" and ""kitayuta"" are not.) You can choose any n lowercase English letters, and insert each of them to any position of s, possibly to the beginning or the end of s. You have to insert exactly n letters even if it is possible to turn s into a palindrome by inserting less than n letters.Find the number of the palindromes that can be obtained in this way, modulo 10007." 3000
506D "Mr. Kitayuta\'s Colorful Graph" "brute force,dfs and similar,dsu,graphs" "Mr. Kitayuta has just bought an undirected graph with n vertices and m edges. The vertices of the graph are numbered from 1 to n. Each edge, namely edge i, has a color ci, connecting vertex ai and bi.Mr. Kitayuta wants you to process the following q queries.In the i-th query, he gives you two integers - ui and vi.Find the number of the colors that satisfy the following condition: the edges of that color connect vertex ui and vertex vi directly or indirectly." 2400
505E "Mr. Kitayuta vs. Bamboos" "binary search,greedy" "Mr. Kitayuta\'s garden is planted with n bamboos. (Bamboos are tall, fast-growing tropical plants with hollow stems.) At the moment, the height of the i-th bamboo is hi meters, and it grows ai meters at the end of each day. Actually, Mr. Kitayuta hates these bamboos. He once attempted to cut them down, but failed because their stems are too hard. Mr. Kitayuta have not given up, however. He has crafted Magical Hammer with his intelligence to drive them into the ground.He can use Magical Hammer at most k times during each day, due to his limited Magic Power. Each time he beat a bamboo with Magical Hammer, its height decreases by p meters. If the height would become negative by this change, it will become 0 meters instead (it does not disappear). In other words, if a bamboo whose height is h meters is beaten with Magical Hammer, its new height will be max(0,\xe2\x80\x89h\xe2\x80\x89-\xe2\x80\x89p) meters. It is possible to beat the same bamboo more than once in a day.Mr. Kitayuta will fight the bamboos for m days, starting today. His purpose is to minimize the height of the tallest bamboo after m days (that is, m iterations of ""Mr. Kitayuta beats the bamboos and then they grow""). Find the lowest possible height of the tallest bamboo after m days." 2900
505D "Mr. Kitayuta\'s Technology" "dfs and similar" "Shuseki Kingdom is the world\'s leading nation for innovation and technology. There are n cities in the kingdom, numbered from 1 to n.Thanks to Mr. Kitayuta\'s research, it has finally become possible to construct teleportation pipes between two cities. A teleportation pipe will connect two cities unidirectionally, that is, a teleportation pipe from city x to city y cannot be used to travel from city y to city x. The transportation within each city is extremely developed, therefore if a pipe from city x to city y and a pipe from city y to city z are both constructed, people will be able to travel from city x to city z instantly.Mr. Kitayuta is also involved in national politics. He considers that the transportation between the m pairs of city (ai,\xe2\x80\x89bi) (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m) is important. He is planning to construct teleportation pipes so that for each important pair (ai,\xe2\x80\x89bi), it will be possible to travel from city ai to city bi by using one or more teleportation pipes (but not necessarily from city bi to city ai). Find the minimum number of teleportation pipes that need to be constructed. So far, no teleportation pipe has been constructed, and there is no other effective transportation between cities." 2200
505C "Mr. Kitayuta, the Treasure Hunter" "dfs and similar,dp,two pointers" "The Shuseki Islands are an archipelago of 30001 small islands in the Yutampo Sea. The islands are evenly spaced along a line, numbered from 0 to 30000 from the west to the east. These islands are known to contain many treasures. There are n gems in the Shuseki Islands in total, and the i-th gem is located on island pi.Mr. Kitayuta has just arrived at island 0. With his great jumping ability, he will repeatedly perform jumps between islands to the east according to the following process:   First, he will jump from island 0 to island d.  After that, he will continue jumping according to the following rule. Let l be the length of the previous jump, that is, if his previous jump was from island prev to island cur, let l\xe2\x80\x89=\xe2\x80\x89cur\xe2\x80\x89-\xe2\x80\x89prev. He will perform a jump of length l\xe2\x80\x89-\xe2\x80\x891, l or l\xe2\x80\x89+\xe2\x80\x891 to the east. That is, he will jump to island (cur\xe2\x80\x89+\xe2\x80\x89l\xe2\x80\x89-\xe2\x80\x891), (cur\xe2\x80\x89+\xe2\x80\x89l) or (cur\xe2\x80\x89+\xe2\x80\x89l\xe2\x80\x89+\xe2\x80\x891) (if they exist). The length of a jump must be positive, that is, he cannot perform a jump of length 0 when l\xe2\x80\x89=\xe2\x80\x891. If there is no valid destination, he will stop jumping. Mr. Kitayuta will collect the gems on the islands visited during the process. Find the maximum number of gems that he can collect." 1900
505B "Mr. Kitayuta\'s Colorful Graph" "dfs and similar,dp,dsu,graphs" "Mr. Kitayuta has just bought an undirected graph consisting of n vertices and m edges. The vertices of the graph are numbered from 1 to n. Each edge, namely edge i, has a color ci, connecting vertex ai and bi.Mr. Kitayuta wants you to process the following q queries.In the i-th query, he gives you two integers \xe2\x80\x94 ui and vi.Find the number of the colors that satisfy the following condition: the edges of that color connect vertex ui and vertex vi directly or indirectly." 1400
505A "Mr. Kitayuta\'s Gift" "brute force,implementation,strings" "Mr. Kitayuta has kindly given you a string s consisting of lowercase English letters. You are asked to insert exactly one lowercase English letter into s to make it a palindrome. A palindrome is a string that reads the same forward and backward. For example, ""noon"", ""testset"" and ""a"" are all palindromes, while ""test"" and ""kitayuta"" are not.You can choose any lowercase English letter, and insert it to any position of s, possibly to the beginning or the end of s. You have to insert a letter even if the given string is already a palindrome.If it is possible to insert one lowercase English letter into s so that the resulting string will be a palindrome, print the string after the insertion. Otherwise, print ""NA"" (without quotes, case-sensitive). In case there is more than one palindrome that can be obtained, you are allowed to print any of them." 1100
504E "Misha and LCP on Tree" "binary search,dfs and similar,hashing,string suffix structures,trees" "Misha has a tree with characters written on the vertices. He can choose two vertices s and t of this tree and write down characters of vertices lying on a path from s to t. We\'ll say that such string corresponds to pair (s,\xe2\x80\x89t).Misha has m queries of type: you are given 4 vertices a, b, c, d; you need to find the largest common prefix of the strings that correspond to pairs (a,\xe2\x80\x89b) and (c,\xe2\x80\x89d). Your task is to help him." 3000
504D "Misha and XOR" bitmasks "After Misha\'s birthday he had many large numbers left, scattered across the room. Now it\'s time to clean up and Misha needs to put them in a basket. He ordered this task to his pet robot that agreed to complete the task at certain conditions. Before the robot puts a number x to the basket, Misha should answer the question: is it possible to choose one or multiple numbers that already are in the basket, such that their XOR sum equals x? If the answer is positive, you also need to give the indexes of these numbers. If there are multiple options of choosing numbers, you are allowed to choose any correct option. After Misha\'s answer the robot puts the number to the basket.Initially the basket is empty. Each integer you put in the basket takes some number. The first integer you put into the basket take number 0, the second integer takes number 1 and so on.Misha needs to clean up the place as soon as possible but unfortunately, he isn\'t that good at mathematics. He asks you to help him." 2700
501E "Misha and Palindrome Degree" "binary search,combinatorics,implementation" "Misha has an array of n integers indexed by integers from 1 to n. Let\'s define palindrome degree of array a as the number of such index pairs (l,\xe2\x80\x89r)(1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n), that the elements from the l-th to the r-th one inclusive can be rearranged in such a way that the whole array will be a palindrome. In other words, pair (l,\xe2\x80\x89r) should meet the condition that after some rearranging of numbers on positions from l to r, inclusive (it is allowed not to rearrange the numbers at all), for any 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n following condition holds: a[i]\xe2\x80\x89=\xe2\x80\x89a[n\xe2\x80\x89-\xe2\x80\x89i\xe2\x80\x89+\xe2\x80\x891]. Your task is to find the palindrome degree of Misha\'s array." 2500
501D "Misha and Permutations Summation" "data structures" "Let\'s define the sum of two permutations p and q of numbers 0,\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89(n\xe2\x80\x89-\xe2\x80\x891) as permutation , where Perm(x) is the x-th lexicographically permutation of numbers 0,\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89(n\xe2\x80\x89-\xe2\x80\x891) (counting from zero), and Ord(p) is the number of permutation p in the lexicographical order.For example, Perm(0)\xe2\x80\x89=\xe2\x80\x89(0,\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x892,\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x891), Perm(n!\xe2\x80\x89-\xe2\x80\x891)\xe2\x80\x89=\xe2\x80\x89(n\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x891,\xe2\x80\x890)Misha has two permutations, p and q. Your task is to find their sum.Permutation a\xe2\x80\x89=\xe2\x80\x89(a0,\xe2\x80\x89a1,\xe2\x80\x89...,\xe2\x80\x89an\xe2\x80\x89-\xe2\x80\x891) is called to be lexicographically smaller than permutation b\xe2\x80\x89=\xe2\x80\x89(b0,\xe2\x80\x89b1,\xe2\x80\x89...,\xe2\x80\x89bn\xe2\x80\x89-\xe2\x80\x891), if for some k following conditions hold: a0\xe2\x80\x89=\xe2\x80\x89b0,\xe2\x80\x89a1\xe2\x80\x89=\xe2\x80\x89b1,\xe2\x80\x89...,\xe2\x80\x89ak\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89=\xe2\x80\x89bk\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89ak\xe2\x80\x89<\xe2\x80\x89bk." 2000
501C "Misha and Forest" "constructive algorithms,data structures,greedy,sortings,trees" "Let\'s define a forest as a non-directed acyclic graph (also without loops and parallel edges). One day Misha played with the forest consisting of n vertices. For each vertex v from 0 to n\xe2\x80\x89-\xe2\x80\x891 he wrote down two integers, degreev and sv, were the first integer is the number of vertices adjacent to vertex v, and the second integer is the XOR sum of the numbers of vertices adjacent to v (if there were no adjacent vertices, he wrote down 0). Next day Misha couldn\'t remember what graph he initially had. Misha has values degreev and sv left, though. Help him find the number of edges and the edges of the initial graph. It is guaranteed that there exists a forest that corresponds to the numbers written by Misha." 1500
501B "Misha and Changing Handles" "data structures,dsu,strings" "Misha hacked the Codeforces site. Then he decided to let all the users change their handles. A user can now change his handle any number of times. But each new handle must not be equal to any handle that is already used or that was used at some point.Misha has a list of handle change requests. After completing the requests he wants to understand the relation between the original and the new handles of the users. Help him to do that." 1100
501A Contest implementation "Misha and Vasya participated in a Codeforces contest. Unfortunately, each of them solved only one problem, though successfully submitted it at the first attempt. Misha solved the problem that costs a points and Vasya solved the problem that costs b points. Besides, Misha submitted the problem c minutes after the contest started and Vasya submitted the problem d minutes after the contest started. As you know, on Codeforces the cost of a problem reduces as a round continues. That is, if you submit a problem that costs p points t minutes after the contest started, you get  points. Misha and Vasya are having an argument trying to find out who got more points. Help them to find out the truth." 900
500G "New Year Running" "number theory,trees" "New Year is coming in Tree Island! In this island, as the name implies, there are n cities connected by n\xe2\x80\x89-\xe2\x80\x891 roads, and for any two distinct cities there always exists exactly one path between them. For every person in Tree Island, it takes exactly one minute to pass by exactly one road.There is a weird New Year tradition for runnners in Tree Island, which is called ""extreme run"". This tradition can be done as follows.A runner chooses two distinct cities a and b. For simplicity, let\'s denote the shortest path from city a to city b as p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pl (here, p1\xe2\x80\x89=\xe2\x80\x89a and pl\xe2\x80\x89=\xe2\x80\x89b holds). Then following happens:  The runner starts at city a.  The runner runs from city a to b, following the shortest path from city a to city b.  When the runner arrives at city b, he turns his direction immediately (it takes no time), and runs towards city a, following the shortest path from city b to city a.  When the runner arrives at city a, he turns his direction immediately (it takes no time), and runs towards city b, following the shortest path from city a to city b.  Repeat step 3 and step 4 forever. In short, the course of the runner can be denoted as:  Two runners JH and JY decided to run ""extremely"" in order to celebrate the New Year. JH has chosen two cities u and v, and JY has chosen two cities x and y. They decided to start running at the same moment, and run until they meet at the same city for the first time. Meeting on a road doesn\'t matter for them. Before running, they want to know the amount of time they will run.It is too hard for JH and JY to calculate this, so they ask you for help." 3200
500F "New Year Shopping" "divide and conquer,dp" "Dohyun is running a grocery store. He sells n items numbered by integers from 1 to n. The i-th (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) of them costs ci dollars, and if I buy it, my happiness increases by hi. Each item can be displayed only for p units of time because of freshness. As Dohyun displays the i-th item at time ti, the customers can buy the i-th item only from time ti to time ti\xe2\x80\x89+\xe2\x80\x89(p\xe2\x80\x89-\xe2\x80\x891) inclusively. Also, each customer cannot buy the same item more than once.I\'d like to visit Dohyun\'s grocery store and buy some items for the New Year Party, and maximize my happiness. Because I am a really busy person, I can visit the store only once, and for very short period of time. In other words, if I visit the store at time t, I can only buy the items available at time t. But I can buy as many items as possible, if the budget holds. I can\'t buy same item several times due to store rules. It is not necessary to use the whole budget.I made a list of q pairs of integers (aj,\xe2\x80\x89bj), which means I may visit the store at time aj, and spend at most bj dollars at the store. For each pair, I\'d like to know the maximum happiness I can obtain. But there are so many pairs that I can\'t handle them. Can you help me?" 2700
500E "New Year Domino" "data structures,dp,dsu" "Celebrating the new year, many people post videos of falling dominoes; Here\'s a list of them: https://www.youtube.com/results?search_query=New+Years+Dominos User ainta, who lives in a 2D world, is going to post a video as well.There are n dominoes on a 2D Cartesian plane. i-th domino (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) can be represented as a line segment which is parallel to the y-axis and whose length is li. The lower point of the domino is on the x-axis. Let\'s denote the x-coordinate of the i-th domino as pi. Dominoes are placed one after another, so p1\xe2\x80\x89<\xe2\x80\x89p2\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89pn\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89<\xe2\x80\x89pn holds.User ainta wants to take a video of falling dominoes. To make dominoes fall, he can push a single domino to the right. Then, the domino will fall down drawing a circle-shaped orbit until the line segment totally overlaps with the x-axis.   Also, if the s-th domino touches the t-th domino while falling down, the t-th domino will also fall down towards the right, following the same procedure above. Domino s touches domino t if and only if the segment representing s and t intersects.   See the picture above. If he pushes the leftmost domino to the right, it falls down, touching dominoes (A), (B) and (C). As a result, dominoes (A), (B), (C) will also fall towards the right. However, domino (D) won\'t be affected by pushing the leftmost domino, but eventually it will fall because it is touched by domino (C) for the first time.  The picture above is an example of falling dominoes. Each red circle denotes a touch of two dominoes.User ainta has q plans of posting the video. j-th of them starts with pushing the xj-th domino, and lasts until the yj-th domino falls. But sometimes, it could be impossible to achieve such plan, so he has to lengthen some dominoes. It costs one dollar to increase the length of a single domino by 1. User ainta wants to know, for each plan, the minimum cost needed to achieve it. Plans are processed independently, i. e. if domino\'s length is increased in some plan, it doesn\'t affect its length in other plans. Set of dominos that will fall except xj-th domino and yj-th domino doesn\'t matter, but the initial push should be on domino xj." 2300
500D "New Year Santa Network" "combinatorics,dfs and similar,graphs,trees" "New Year is coming in Tree World! In this world, as the name implies, there are n cities connected by n\xe2\x80\x89-\xe2\x80\x891 roads, and for any two distinct cities there always exists a path between them. The cities are numbered by integers from 1 to n, and the roads are numbered by integers from 1 to n\xe2\x80\x89-\xe2\x80\x891. Let\'s define d(u,\xe2\x80\x89v) as total length of roads on the path between city u and city v.As an annual event, people in Tree World repairs exactly one road per year. As a result, the length of one road decreases. It is already known that in the i-th year, the length of the ri-th road is going to become wi, which is shorter than its length before. Assume that the current year is year 1.Three Santas are planning to give presents annually to all the children in Tree World. In order to do that, they need some preparation, so they are going to choose three distinct cities c1, c2, c3 and make exactly one warehouse in each city. The k-th (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x893) Santa will take charge of the warehouse in city ck.It is really boring for the three Santas to keep a warehouse alone. So, they decided to build an only-for-Santa network! The cost needed to build this network equals to d(c1,\xe2\x80\x89c2)\xe2\x80\x89+\xe2\x80\x89d(c2,\xe2\x80\x89c3)\xe2\x80\x89+\xe2\x80\x89d(c3,\xe2\x80\x89c1) dollars. Santas are too busy to find the best place, so they decided to choose c1,\xe2\x80\x89c2,\xe2\x80\x89c3 randomly uniformly over all triples of distinct numbers from 1 to n. Santas would like to know the expected value of the cost needed to build the network.However, as mentioned, each year, the length of exactly one road decreases. So, the Santas want to calculate the expected after each length change. Help them to calculate the value." 1900
500C "New Year Book Reading" "constructive algorithms,greedy,implementation,math" "New Year is coming, and Jaehyun decided to read many books during 2015, unlike this year. He has n books numbered by integers from 1 to n. The weight of the i-th (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) book is wi.As Jaehyun\'s house is not large enough to have a bookshelf, he keeps the n books by stacking them vertically. When he wants to read a certain book x, he follows the steps described below.  He lifts all the books above book x.  He pushes book x out of the stack.  He puts down the lifted books without changing their order.  After reading book x, he puts book x on the top of the stack.  He decided to read books for m days. In the j-th (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m) day, he will read the book that is numbered with integer bj (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89bj\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n). To read the book, he has to use the process described in the paragraph above. It is possible that he decides to re-read the same book several times.After making this plan, he realized that the total weight of books he should lift during m days would be too heavy. So, he decided to change the order of the stacked books before the New Year comes, and minimize the total weight. You may assume that books can be stacked in any possible order. Note that book that he is going to read on certain step isn\'t considered as lifted on that step. Can you help him?" 1600
500B "New Year Permutation" "dfs and similar,dsu,graphs,greedy,math,sortings" "User ainta has a permutation p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pn. As the New Year is coming, he wants to make his permutation as pretty as possible.Permutation a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an is prettier than permutation b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bn, if and only if there exists an integer k (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) where a1\xe2\x80\x89=\xe2\x80\x89b1,\xe2\x80\x89a2\xe2\x80\x89=\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89ak\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89=\xe2\x80\x89bk\xe2\x80\x89-\xe2\x80\x891 and ak\xe2\x80\x89<\xe2\x80\x89bk all holds.As known, permutation p is so sensitive that it could be only modified by swapping two distinct elements. But swapping two elements is harder than you think. Given an n\xe2\x80\x89\xc3\x97\xe2\x80\x89n binary matrix A, user ainta can swap the values of pi and pj (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i,\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n, i\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89j) if and only if Ai,\xe2\x80\x89j\xe2\x80\x89=\xe2\x80\x891.Given the permutation p and the matrix A, user ainta wants to know the prettiest permutation that he can obtain." 1600
500A "New Year Transportation" "dfs and similar,graphs,implementation" "New Year is coming in Line World! In this world, there are n cells numbered by integers from 1 to n, as a 1\xe2\x80\x89\xc3\x97\xe2\x80\x89n board. People live in cells. However, it was hard to move between distinct cells, because of the difficulty of escaping the cell. People wanted to meet people who live in other cells.So, user tncks0121 has made a transportation system to move between these cells, to celebrate the New Year. First, he thought of n\xe2\x80\x89-\xe2\x80\x891 positive integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an\xe2\x80\x89-\xe2\x80\x891. For every integer i where 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x891 the condition 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ai\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x89i holds. Next, he made n\xe2\x80\x89-\xe2\x80\x891 portals, numbered by integers from 1 to n\xe2\x80\x89-\xe2\x80\x891. The i-th (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x891) portal connects cell i and cell (i\xe2\x80\x89+\xe2\x80\x89ai), and one can travel from cell i to cell (i\xe2\x80\x89+\xe2\x80\x89ai) using the i-th portal. Unfortunately, one cannot use the portal backwards, which means one cannot move from cell (i\xe2\x80\x89+\xe2\x80\x89ai) to cell i using the i-th portal. It is easy to see that because of condition 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ai\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x89i one can\'t leave the Line World using portals.Currently, I am standing at cell 1, and I want to go to cell t. However, I don\'t know whether it is possible to go there. Please determine whether I can go to cell t by only using the construted transportation system." 1000
499B Lecture implementation,strings "You have a new professor of graph theory and he speaks very quickly. You come up with the following plan to keep up with his lecture and make notes.You know two languages, and the professor is giving the lecture in the first one. The words in both languages consist of lowercase English characters, each language consists of several words. For each language, all words are distinct, i.e. they are spelled differently. Moreover, the words of these languages have a one-to-one correspondence, that is, for each word in each language, there exists exactly one word in the other language having has the same meaning.You can write down every word the professor says in either the first language or the second language. Of course, during the lecture you write down each word in the language in which the word is shorter. In case of equal lengths of the corresponding words you prefer the word of the first language.You are given the text of the lecture the professor is going to read. Find out how the lecture will be recorded in your notes." 1000
499A "Watching a movie" greedy,implementation "You have decided to watch the best moments of some movie. There are two buttons on your player:   Watch the current minute of the movie. By pressing this button, you watch the current minute of the movie and the player automatically proceeds to the next minute of the movie.  Skip exactly x minutes of the movie (x is some fixed positive integer). If the player is now at the t-th minute of the movie, then as a result of pressing this button, it proceeds to the minute (t\xe2\x80\x89+\xe2\x80\x89x). Initially the movie is turned on in the player on the first minute, and you want to watch exactly n best moments of the movie, the i-th best moment starts at the li-th minute and ends at the ri-th minute (more formally, the i-th best moment consists of minutes: li,\xe2\x80\x89li\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89ri). Determine, what is the minimum number of minutes of the movie you have to watch if you want to watch all the best moments?" 1000
498E "Stairs and Lines" dp,matrices "You are given a figure on a grid representing stairs consisting of 7 steps. The width of the stair on height i is wi squares. Formally, the figure is created by consecutively joining rectangles of size wi\xe2\x80\x89\xc3\x97\xe2\x80\x89i so that the wi sides lie on one straight line. Thus, for example, if all wi\xe2\x80\x89=\xe2\x80\x891, the figure will look like that (different colors represent different rectangles):  And if w\xe2\x80\x89=\xe2\x80\x89{5,\xe2\x80\x891,\xe2\x80\x890,\xe2\x80\x893,\xe2\x80\x890,\xe2\x80\x890,\xe2\x80\x891}, then it looks like that:  Find the number of ways to color some borders of the figure\'s inner squares so that no square had all four borders colored. The borders of the squares lying on the border of the figure should be considered painted. The ways that differ with the figure\'s rotation should be considered distinct." 2700
498D "Traffic Jams in the Land" "data structures,dp,number theory" "Some country consists of (n\xe2\x80\x89+\xe2\x80\x891) cities, located along a straight highway. Let\'s number the cities with consecutive integers from 1 to n\xe2\x80\x89+\xe2\x80\x891 in the order they occur along the highway. Thus, the cities are connected by n segments of the highway, the i-th segment connects cities number i and i\xe2\x80\x89+\xe2\x80\x891. Every segment of the highway is associated with a positive integer ai\xe2\x80\x89>\xe2\x80\x891 \xe2\x80\x94 the period of traffic jams appearance on it. In order to get from city x to city y (x\xe2\x80\x89<\xe2\x80\x89y), some drivers use the following tactics. Initially the driver is in city x and the current time t equals zero. Until the driver arrives in city y, he perfors the following actions:  if the current time t is a multiple of ax, then the segment of the highway number x is now having traffic problems and the driver stays in the current city for one unit of time (formally speaking, we assign t\xe2\x80\x89=\xe2\x80\x89t\xe2\x80\x89+\xe2\x80\x891);  if the current time t is not a multiple of ax, then the segment of the highway number x is now clear and that\'s why the driver uses one unit of time to move to city x\xe2\x80\x89+\xe2\x80\x891 (formally, we assign t\xe2\x80\x89=\xe2\x80\x89t\xe2\x80\x89+\xe2\x80\x891 and x\xe2\x80\x89=\xe2\x80\x89x\xe2\x80\x89+\xe2\x80\x891). You are developing a new traffic control system. You want to consecutively process q queries of two types:  determine the final value of time t after the ride from city x to city y (x\xe2\x80\x89<\xe2\x80\x89y) assuming that we apply the tactics that is described above. Note that for each query t is being reset to 0.  replace the period of traffic jams appearing on the segment number x by value y (formally, assign ax\xe2\x80\x89=\xe2\x80\x89y). Write a code that will effectively process the queries given above." 2400
498C "Array and Operations" "flows,graph matchings,number theory" "You have written on a piece of paper an array of n positive integers a[1],\xe2\x80\x89a[2],\xe2\x80\x89...,\xe2\x80\x89a[n] and m good pairs of integers (i1,\xe2\x80\x89j1),\xe2\x80\x89(i2,\xe2\x80\x89j2),\xe2\x80\x89...,\xe2\x80\x89(im,\xe2\x80\x89jm). Each good pair (ik,\xe2\x80\x89jk) meets the following conditions: ik\xe2\x80\x89+\xe2\x80\x89jk is an odd number and 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ik\xe2\x80\x89<\xe2\x80\x89jk\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n.In one operation you can perform a sequence of actions:   take one of the good pairs (ik,\xe2\x80\x89jk) and some integer v (v\xe2\x80\x89>\xe2\x80\x891), which divides both numbers a[ik] and a[jk];  divide both numbers by v, i. e. perform the assignments:  and . Determine the maximum number of operations you can sequentially perform on the given array. Note that one pair may be used several times in the described operations." 2100
498B "Name That Tune" "dp,probabilities,two pointers" "It turns out that you are a great fan of rock band AC/PE. Peter learned that and started the following game: he plays the first song of the list of n songs of the group, and you have to find out the name of the song. After you tell the song name, Peter immediately plays the following song in order, and so on.The i-th song of AC/PE has its recognizability pi. This means that if the song has not yet been recognized by you, you listen to it for exactly one more second and with probability of pi percent you recognize it and tell it\'s name. Otherwise you continue listening it. Note that you can only try to guess it only when it is integer number of seconds after the moment the song starts playing.In all AC/PE songs the first words of chorus are the same as the title, so when you\'ve heard the first ti seconds of i-th song and its chorus starts, you immediately guess its name for sure.For example, in the song Highway To Red the chorus sounds pretty late, but the song has high recognizability. In the song Back In Blue, on the other hand, the words from the title sound close to the beginning of the song, but it\'s hard to name it before hearing those words. You can name both of these songs during a few more first seconds.Determine the expected number songs of you will recognize if the game lasts for exactly T seconds (i. e. you can make the last guess on the second T, after that the game stops).If all songs are recognized faster than in T seconds, the game stops after the last song is recognized." 2400
498A "Crazy Town" geometry "Crazy Town is a plane on which there are n infinite line roads. Each road is defined by the equation aix\xe2\x80\x89+\xe2\x80\x89biy\xe2\x80\x89+\xe2\x80\x89ci\xe2\x80\x89=\xe2\x80\x890, where ai and bi are not both equal to the zero. The roads divide the plane into connected regions, possibly of infinite space. Let\'s call each such region a block. We define an intersection as the point where at least two different roads intersect.Your home is located in one of the blocks. Today you need to get to the University, also located in some block. In one step you can move from one block to another, if the length of their common border is nonzero (in particular, this means that if the blocks are adjacent to one intersection, but have no shared nonzero boundary segment, then it are not allowed to move from one to another one in one step).Determine what is the minimum number of steps you have to perform to get to the block containing the university. It is guaranteed that neither your home nor the university is located on the road." 1700
497E "Subsequences Return" dp,matrices "Assume that sk(n) equals the sum of digits of number n in the k-based notation. For example, s2(5)\xe2\x80\x89=\xe2\x80\x89s2(1012)\xe2\x80\x89=\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x890\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89=\xe2\x80\x892, s3(14)\xe2\x80\x89=\xe2\x80\x89s3(1123)\xe2\x80\x89=\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x892\xe2\x80\x89=\xe2\x80\x894.The sequence of integers a0,\xe2\x80\x89...,\xe2\x80\x89an\xe2\x80\x89-\xe2\x80\x891 is defined as . Your task is to calculate the number of distinct subsequences of sequence a0,\xe2\x80\x89...,\xe2\x80\x89an\xe2\x80\x89-\xe2\x80\x891. Calculate the answer modulo 109\xe2\x80\x89+\xe2\x80\x897.Sequence a1,\xe2\x80\x89...,\xe2\x80\x89ak is called to be a subsequence of sequence b1,\xe2\x80\x89...,\xe2\x80\x89bl, if there is a sequence of indices 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i1\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89ik\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l, such that a1\xe2\x80\x89=\xe2\x80\x89bi1, ..., ak\xe2\x80\x89=\xe2\x80\x89bik. In particular, an empty sequence (i.e. the sequence consisting of zero elements) is a subsequence of any sequence." 2900
496E "Distributing Parts" greedy,sortings "You are an assistant director in a new musical play. The play consists of n musical parts, each part must be performed by exactly one actor. After the casting the director chose m actors who can take part in the play. Your task is to assign the parts to actors. However, there are several limitations.First, each actor has a certain voice range and there are some parts that he cannot sing. Formally, there are two integers for each actor, ci and di (ci\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89di) \xe2\x80\x94 the pitch of the lowest and the highest note that the actor can sing. There also are two integers for each part \xe2\x80\x94 aj and bj (aj\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89bj) \xe2\x80\x94 the pitch of the lowest and the highest notes that are present in the part. The i-th actor can perform the j-th part if and only if ci\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89aj\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89bj\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89di, i.e. each note of the part is in the actor\'s voice range.According to the contract, the i-th actor can perform at most ki parts. Besides, you are allowed not to give any part to some actors (then they take part in crowd scenes).The rehearsal starts in two hours and you need to do the assignment quickly!" 2100
496D "Tennis Game" "binary search" "Petya and Gena love playing table tennis. A single match is played according to the following rules: a match consists of multiple sets, each set consists of multiple serves. Each serve is won by one of the players, this player scores one point. As soon as one of the players scores t points, he wins the set; then the next set starts and scores of both players are being set to 0. As soon as one of the players wins the total of s sets, he wins the match and the match is over. Here s and t are some positive integer numbers.To spice it up, Petya and Gena choose new numbers s and t before every match. Besides, for the sake of history they keep a record of each match: that is, for each serve they write down the winner. Serve winners are recorded in the chronological order. In a record the set is over as soon as one of the players scores t points and the match is over as soon as one of the players wins s sets.Petya and Gena have found a record of an old match. Unfortunately, the sequence of serves in the record isn\'t divided into sets and numbers s and t for the given match are also lost. The players now wonder what values of s and t might be. Can you determine all the possible options?" 1900
496C "Removing Columns" "brute force,constructive algorithms,implementation" "You are given an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m rectangular table consisting of lower case English letters. In one operation you can completely remove one column from the table. The remaining parts are combined forming a new table. For example, after removing the second column from the tableabcdedfghijk we obtain the table:acdefghjk A table is called good if its rows are ordered from top to bottom lexicographically, i.e. each row is lexicographically no larger than the following one. Determine the minimum number of operations of removing a column needed to make a given table good." 1500
496B "Secret Combination" "brute force,constructive algorithms,implementation" "You got a box with a combination lock. The lock has a display showing n digits. There are two buttons on the box, each button changes digits on the display. You have quickly discovered that the first button adds 1 to all the digits (all digits 9 become digits 0), and the second button shifts all the digits on the display one position to the right (the last digit becomes the first one). For example, if the display is currently showing number 579, then if we push the first button, the display will show 680, and if after that we push the second button, the display will show 068.You know that the lock will open if the display is showing the smallest possible number that can be obtained by pushing the buttons in some order. The leading zeros are ignored while comparing numbers. Now your task is to find the desired number." 1500
496A "Minimum Difficulty" "brute force,implementation,math" "Mike is trying rock climbing but he is awful at it. There are n holds on the wall, i-th hold is at height ai off the ground. Besides, let the sequence ai increase, that is, ai\xe2\x80\x89<\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x891 for all i from 1 to n\xe2\x80\x89-\xe2\x80\x891; we will call such sequence a track. Mike thinks that the track a1, ..., an has difficulty . In other words, difficulty equals the maximum distance between two holds that are adjacent in height.Today Mike decided to cover the track with holds hanging on heights a1, ..., an. To make the problem harder, Mike decided to remove one hold, that is, remove one element of the sequence (for example, if we take the sequence (1,\xe2\x80\x892,\xe2\x80\x893,\xe2\x80\x894,\xe2\x80\x895) and remove the third element from it, we obtain the sequence (1,\xe2\x80\x892,\xe2\x80\x894,\xe2\x80\x895)). However, as Mike is awful at climbing, he wants the final difficulty (i.e. the maximum difference of heights between adjacent holds after removing the hold) to be as small as possible among all possible options of removing a hold. The first and last holds must stay at their positions.Help Mike determine the minimum difficulty of the track after removing one hold." 900
495B "Modular Equations" "math,number theory" "Last week, Hamed learned about a new type of equations in his math class called Modular Equations. Lets define i modulo j as the remainder of division of i by j and denote it by . A Modular Equation, as Hamed\'s teacher described, is an equation of the form  in which a and b are two non-negative integers and x is a variable. We call a positive integer x for which  a solution of our equation.Hamed didn\'t pay much attention to the class since he was watching a movie. He only managed to understand the definitions of these equations.Now he wants to write his math exercises but since he has no idea how to do that, he asked you for help. He has told you all he knows about Modular Equations and asked you to write a program which given two numbers a and b determines how many answers the Modular Equation  has." 1600
495A "Digital Counter" implementation "Malek lives in an apartment block with 100 floors numbered from 0 to 99. The apartment has an elevator with a digital counter showing the floor that the elevator is currently on. The elevator shows each digit of a number with 7 light sticks by turning them on or off. The picture below shows how the elevator shows each digit.One day when Malek wanted to go from floor 88 to floor 0 using the elevator he noticed that the counter shows number 89 instead of 88. Then when the elevator started moving the number on the counter changed to 87. After a little thinking Malek came to the conclusion that there is only one explanation for this: One of the sticks of the counter was broken. Later that day Malek was thinking about the broken stick and suddenly he came up with the following problem.Suppose the digital counter is showing number n. Malek calls an integer x (0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x8999) good if it\'s possible that the digital counter was supposed to show x but because of some(possibly none) broken sticks it\'s showing n instead. Malek wants to know number of good integers for a specific n. So you must write a program that calculates this number. Please note that the counter always shows two digits." 1100
494E Sharti "data structures,games" "During the last 24 hours Hamed and Malek spent all their time playing ""Sharti"". Now they are too exhausted to finish the last round. So they asked you for help to determine the winner of this round. ""Sharti"" is played on a n\xe2\x80\x89\xc3\x97\xe2\x80\x89n board with some of cells colored white and others colored black. The rows of the board are numbered from top to bottom using number 1 to n. Also the columns of the board are numbered from left to right using numbers 1 to n. The cell located at the intersection of i-th row and j-th column is denoted by (i,\xe2\x80\x89j).The players alternatively take turns. In each turn the player must choose a square with side-length at most k with its lower-right cell painted white. Then the colors of all the cells in this square are inversed (white cells become black and vice-versa). The player who cannot perform a move in his turn loses. You know Hamed and Malek are very clever and they would have played their best moves at each turn. Knowing this and the fact that Hamed takes the first turn, given the initial board as described in the input, you must determine which one of them will be the winner." 3200
494D Birthday "data structures,dfs and similar,dp,trees" "Ali is Hamed\'s little brother and tomorrow is his birthday. Hamed wants his brother to earn his gift so he gave him a hard programming problem and told him if he can successfully solve it, he\'ll get him a brand new laptop. Ali is not yet a very talented programmer like Hamed and although he usually doesn\'t cheat but this time is an exception. It\'s about a brand new laptop. So he decided to secretly seek help from you. Please solve this problem for Ali. An n-vertex weighted rooted tree is given. Vertex number 1 is a root of the tree. We define d(u,\xe2\x80\x89v) as the sum of edges weights on the shortest path between vertices u and v. Specifically we define d(u,\xe2\x80\x89u)\xe2\x80\x89=\xe2\x80\x890. Also let\'s define S(v) for each vertex v as a set containing all vertices u such that d(1,\xe2\x80\x89u)\xe2\x80\x89=\xe2\x80\x89d(1,\xe2\x80\x89v)\xe2\x80\x89+\xe2\x80\x89d(v,\xe2\x80\x89u). Function f(u,\xe2\x80\x89v) is then defined using the following formula:The goal is to calculate f(u,\xe2\x80\x89v) for each of the q given pair of vertices. As the answer can be rather large it\'s enough to print it modulo 109\xe2\x80\x89+\xe2\x80\x897." 2700
494C "Helping People" dp,probabilities "Malek is a rich man. He also is very generous. That\'s why he decided to split his money between poor people. A charity institute knows n poor people numbered from 1 to n. The institute gave Malek q recommendations. A recommendation is a segment of people like [l,\xe2\x80\x89r] which means the institute recommended that Malek gives one dollar to every person whose number is in this segment.However this charity has very odd rules about the recommendations. Because of those rules the recommendations are given in such a way that for every two recommendation [a,\xe2\x80\x89b] and [c,\xe2\x80\x89d] one of the following conditions holds:   The two segments are completely disjoint. More formally either a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b\xe2\x80\x89<\xe2\x80\x89c\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89d or c\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89d\xe2\x80\x89<\xe2\x80\x89a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b  One of the two segments are inside another. More formally either a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89c\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89d\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b or c\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89d. The goodness of a charity is the value of maximum money a person has after Malek finishes giving his money. The institute knows for each recommendation what is the probability that Malek will accept it. They want to know the expected value of goodness of this charity. So they asked you for help.You have been given the list of recommendations and for each recommendation the probability of it being accepted by Malek. You have also been given how much money each person initially has. You must find the expected value of goodness." 2600
494B "Obsessive String" dp,strings "Hamed has recently found a string t and suddenly became quite fond of it. He spent several days trying to find all occurrences of t in other strings he had. Finally he became tired and started thinking about the following problem. Given a string s how many ways are there to extract k\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x891 non-overlapping substrings from it such that each of them contains string t as a substring? More formally, you need to calculate the number of ways to choose two sequences a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89ak and b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bk satisfying the following requirements:  k\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x891          t is a substring of string saisai\xe2\x80\x89+\xe2\x80\x891... sbi (string s is considered as 1-indexed). As the number of ways can be rather large print it modulo 109\xe2\x80\x89+\xe2\x80\x897." 2000
494A Treasure greedy "Malek has recently found a treasure map. While he was looking for a treasure he found a locked door. There was a string s written on the door consisting of characters \'(\', \')\' and \'#\'. Below there was a manual on how to open the door. After spending a long time Malek managed to decode the manual and found out that the goal is to replace each \'#\' with one or more \')\' characters so that the final string becomes beautiful. Below there was also written that a string is called beautiful if for each i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|s|) there are no more \')\' characters than \'(\' characters among the first i characters of s and also the total number of \'(\' characters is equal to the total number of \')\' characters. Help Malek open the door by telling him for each \'#\' character how many \')\' characters he must replace it with." 1500
493E "Vasya and Polynomial" math "Vasya is studying in the last class of school and soon he will take exams. He decided to study polynomials. Polynomial is a function P(x)\xe2\x80\x89=\xe2\x80\x89a0\xe2\x80\x89+\xe2\x80\x89a1x1\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89anxn. Numbers ai are called coefficients of a polynomial, non-negative integer n is called a degree of a polynomial.Vasya has made a bet with his friends that he can solve any problem with polynomials. They suggested him the problem: ""Determine how many polynomials P(x) exist with integer non-negative coefficients so that , and , where  and b are given positive integers""? Vasya does not like losing bets, but he has no idea how to solve this task, so please help him to solve the problem." 2800
493D "Vasya and Chess" "constructive algorithms,games,math" "Vasya decided to learn to play chess. Classic chess doesn\'t seem interesting to him, so he plays his own sort of chess.The queen is the piece that captures all squares on its vertical, horizontal and diagonal lines. If the cell is located on the same vertical, horizontal or diagonal line with queen, and the cell contains a piece of the enemy color, the queen is able to move to this square. After that the enemy\'s piece is removed from the board. The queen cannot move to a cell containing an enemy piece if there is some other piece between it and the queen. There is an n\xe2\x80\x89\xc3\x97\xe2\x80\x89n chessboard. We\'ll denote a cell on the intersection of the r-th row and c-th column as (r,\xe2\x80\x89c). The square (1,\xe2\x80\x891) contains the white queen and the square (1,\xe2\x80\x89n) contains the black queen. All other squares contain green pawns that don\'t belong to anyone.The players move in turns. The player that moves first plays for the white queen, his opponent plays for the black queen.On each move the player has to capture some piece with his queen (that is, move to a square that contains either a green pawn or the enemy queen). The player loses if either he cannot capture any piece during his move or the opponent took his queen during the previous move. Help Vasya determine who wins if both players play with an optimal strategy on the board n\xe2\x80\x89\xc3\x97\xe2\x80\x89n." 1700
493C "Vasya and Basketball" "binary search,brute force,data structures,implementation,sortings,two pointers" "Vasya follows a basketball game and marks the distances from which each team makes a throw. He knows that each successful throw has value of either 2 or 3 points. A throw is worth 2 points if the distance it was made from doesn\'t exceed some value of d meters, and a throw is worth 3 points if the distance is larger than d meters, where d is some non-negative integer.Vasya would like the advantage of the points scored by the first team (the points of the first team minus the points of the second team) to be maximum. For that he can mentally choose the value of d. Help him to do that." 1600
493B "Vasya and Wrestling" implementation "Vasya has become interested in wrestling. In wrestling wrestlers use techniques for which they are awarded points by judges. The wrestler who gets the most points wins.When the numbers of points of both wrestlers are equal, the wrestler whose sequence of points is lexicographically greater, wins.If the sequences of the awarded points coincide, the wrestler who performed the last technique wins. Your task is to determine which wrestler won." 1400
493A "Vasya and Football" implementation "Vasya has started watching football games. He has learned that for some fouls the players receive yellow cards, and for some fouls they receive red cards. A player who receives the second yellow card automatically receives a red card.Vasya is watching a recorded football match now and makes notes of all the fouls that he would give a card for. Help Vasya determine all the moments in time when players would be given red cards if Vasya were the judge. For each player, Vasya wants to know only the first moment of time when he would receive a red card from Vasya." 1300
492E "Vanya and Field" math "Vanya decided to walk in the field of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89n cells. The field contains m apple trees, the i-th apple tree is at the cell with coordinates (xi,\xe2\x80\x89yi). Vanya moves towards vector (dx,\xe2\x80\x89dy). That means that if Vanya is now at the cell (x,\xe2\x80\x89y), then in a second he will be at cell . The following condition is satisfied for the vector: , where  is the largest integer that divides both a and b. Vanya ends his path when he reaches the square he has already visited. Vanya wonders, from what square of the field he should start his path to see as many apple trees as possible." 2000
492D "Vanya and Computer Game" "binary search,implementation,math,sortings" "Vanya and his friend Vova play a computer game where they need to destroy n monsters to pass a level. Vanya\'s character performs attack with frequency x hits per second and Vova\'s character performs attack with frequency y hits per second. Each character spends fixed time to raise a weapon and then he hits (the time to raise the weapon is 1\xe2\x80\x89/\xe2\x80\x89x seconds for the first character and 1\xe2\x80\x89/\xe2\x80\x89y seconds for the second one). The i-th monster dies after he receives ai hits. Vanya and Vova wonder who makes the last hit on each monster. If Vanya and Vova make the last hit at the same time, we assume that both of them have made the last hit." 1800
492C "Vanya and Exams" greedy,sortings "Vanya wants to pass n exams and get the academic scholarship. He will get the scholarship if the average grade mark for all the exams is at least avg. The exam grade cannot exceed r. Vanya has passed the exams and got grade ai for the i-th exam. To increase the grade for the i-th exam by 1 point, Vanya must write bi essays. He can raise the exam grade multiple times.What is the minimum number of essays that Vanya needs to write to get scholarship?" 1400
492B "Vanya and Lanterns" "binary search,implementation,math,sortings" "Vanya walks late at night along a straight street of length l, lit by n lanterns. Consider the coordinate system with the beginning of the street corresponding to the point 0, and its end corresponding to the point l. Then the i-th lantern is at the point ai. The lantern lights all points of the street that are at the distance of at most d from it, where d is some positive number, common for all lanterns. Vanya wonders: what is the minimum light radius d should the lanterns have to light the whole street?" 1200
492A "Vanya and Cubes" implementation "Vanya got n cubes. He decided to build a pyramid from them. Vanya wants to build the pyramid as follows: the top level of the pyramid must consist of 1 cube, the second level must consist of 1\xe2\x80\x89+\xe2\x80\x892\xe2\x80\x89=\xe2\x80\x893 cubes, the third level must have 1\xe2\x80\x89+\xe2\x80\x892\xe2\x80\x89+\xe2\x80\x893\xe2\x80\x89=\xe2\x80\x896 cubes, and so on. Thus, the i-th level of the pyramid must have 1\xe2\x80\x89+\xe2\x80\x892\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89(i\xe2\x80\x89-\xe2\x80\x891)\xe2\x80\x89+\xe2\x80\x89i cubes.Vanya wants to know what is the maximum height of the pyramid that he can make using the given cubes." 800
491C Deciphering "flows,graph matchings" "One day Maria Ivanovna found a Sasha\'s piece of paper with a message dedicated to Olya. Maria Ivanovna wants to know what is there in a message, but unfortunately the message is ciphered. Maria Ivanovna knows that her students usually cipher their messages by replacing each letter of an original message by some another letter. Replacement works in such way that same letters are always replaced with some fixed letter, and different letters are always replaced by different letters. Maria Ivanovna supposed that the message contains answers to the final exam (since its length is equal to the number of final exam questions). On the other hand she knows that Sasha\'s answer are not necessary correct. There are K possible answers for each questions. Of course, Maria Ivanovna knows correct answers.Maria Ivanovna decided to decipher message in such way that the number of Sasha\'s correct answers is maximum possible. She is very busy now, so your task is to help her." 2300
491B "New York Hotel" greedy,math "Think of New York as a rectangular grid consisting of N vertical avenues numerated from 1 to N and M horizontal streets numerated 1 to M. C friends are staying at C hotels located at some street-avenue crossings. They are going to celebrate birthday of one of them in the one of H restaurants also located at some street-avenue crossings. They also want that the maximum distance covered by one of them while traveling to the restaurant to be minimum possible. Help friends choose optimal restaurant for a celebration.Suppose that the distance between neighboring crossings are all the same equal to one kilometer." 2100
491A "Up the hill" "constructive algorithms,implementation" "Hiking club ""Up the hill"" just returned from a walk. Now they are trying to remember which hills they\'ve just walked through.It is known that there were N stops, all on different integer heights between 1 and N kilometers (inclusive) above the sea level. On the first day they\'ve traveled from the first stop to the second stop, on the second day they\'ve traveled from the second to the third and so on, and on the last day they\'ve traveled from the stop N\xe2\x80\x89-\xe2\x80\x891 to the stop N and successfully finished their expedition.They are trying to find out which heights were their stops located at. They have an entry in a travel journal specifying how many days did they travel up the hill, and how many days did they walk down the hill.Help them by suggesting some possible stop heights satisfying numbers from the travel journal." 1000
490F "Treeland Tour" "data structures,dfs and similar,dp,trees" "The ""Road Accident"" band is planning an unprecedented tour around Treeland. The RA fans are looking forward to the event and making bets on how many concerts their favorite group will have.Treeland consists of n cities, some pairs of cities are connected by bidirectional roads. Overall the country has n\xe2\x80\x89-\xe2\x80\x891 roads. We know that it is possible to get to any city from any other one. The cities are numbered by integers from 1 to n. For every city we know its value ri \xe2\x80\x94 the number of people in it.We know that the band will travel along some path, having concerts in some cities along the path. The band\'s path will not pass one city twice, each time they move to the city that hasn\'t been previously visited. Thus, the musicians will travel along some path (without visiting any city twice) and in some (not necessarily all) cities along the way they will have concerts.The band plans to gather all the big stadiums and concert halls during the tour, so every time they will perform in a city which population is larger than the population of the previously visited with concert city. In other words, the sequence of population in the cities where the concerts will be held is strictly increasing.In a recent interview with the leader of the ""road accident"" band promised to the fans that the band will give concert in the largest possible number of cities! Thus the band will travel along some chain of cities of Treeland and have concerts in some of these cities, so that the population number will increase, and the number of concerts will be the largest possible.The fans of Treeland are frantically trying to figure out how many concerts the group will have in Treeland. Looks like they can\'t manage without some help from a real programmer! Help the fans find the sought number of concerts." 2200
490E "Restoring Increasing Sequence" "binary search,brute force,greedy,implementation" "Peter wrote on the board a strictly increasing sequence of positive integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. Then Vasil replaced some digits in the numbers of this sequence by question marks. Thus, each question mark corresponds to exactly one lost digit.Restore the the original sequence knowing digits remaining on the board." 2000
490D Chocolate "brute force,dfs and similar,math,meet-in-the-middle,number theory" "Polycarpus likes giving presents to Paraskevi. He has bought two chocolate bars, each of them has the shape of a segmented rectangle. The first bar is a1\xe2\x80\x89\xc3\x97\xe2\x80\x89b1 segments large and the second one is a2\xe2\x80\x89\xc3\x97\xe2\x80\x89b2 segments large.Polycarpus wants to give Paraskevi one of the bars at the lunch break and eat the other one himself. Besides, he wants to show that Polycarpus\'s mind and Paraskevi\'s beauty are equally matched, so the two bars must have the same number of squares.To make the bars have the same number of squares, Polycarpus eats a little piece of chocolate each minute. Each minute he does the following:  he either breaks one bar exactly in half (vertically or horizontally) and eats exactly a half of the bar,  or he chips of exactly one third of a bar (vertically or horizontally) and eats exactly a third of the bar. In the first case he is left with a half, of the bar and in the second case he is left with two thirds of the bar.Both variants aren\'t always possible, and sometimes Polycarpus cannot chip off a half nor a third. For example, if the bar is 16\xe2\x80\x89\xc3\x97\xe2\x80\x8923, then Polycarpus can chip off a half, but not a third. If the bar is 20\xe2\x80\x89\xc3\x97\xe2\x80\x8918, then Polycarpus can chip off both a half and a third. If the bar is 5\xe2\x80\x89\xc3\x97\xe2\x80\x897, then Polycarpus cannot chip off a half nor a third.What is the minimum number of minutes Polycarpus needs to make two bars consist of the same number of squares? Find not only the required minimum number of minutes, but also the possible sizes of the bars after the process." 1900
490C "Hacking Cypher" "brute force,math,number theory,strings" "Polycarpus participates in a competition for hacking into a new secure messenger. He\'s almost won.Having carefully studied the interaction protocol, Polycarpus came to the conclusion that the secret key can be obtained if he properly cuts the public key of the application into two parts. The public key is a long integer which may consist of even a million digits!Polycarpus needs to find such a way to cut the public key into two nonempty parts, that the first (left) part is divisible by a as a separate number, and the second (right) part is divisible by b as a separate number. Both parts should be positive integers that have no leading zeros. Polycarpus knows values a and b.Help Polycarpus and find any suitable method to cut the public key." 1700
490B Queue dsu,implementation "During the lunch break all n Berland State University students lined up in the food court. However, it turned out that the food court, too, has a lunch break and it temporarily stopped working.Standing in a queue that isn\'t being served is so boring! So, each of the students wrote down the number of the student ID of the student that stands in line directly in front of him, and the student that stands in line directly behind him. If no one stands before or after a student (that is, he is the first one or the last one), then he writes down number 0 instead (in Berland State University student IDs are numerated from 1).After that, all the students went about their business. When they returned, they found out that restoring the queue is not such an easy task.Help the students to restore the state of the queue by the numbers of the student ID\'s of their neighbors in the queue." 1500
490A "Team Olympiad" greedy,implementation,sortings "The School \xe2\x84\x960 of the capital of Berland has n children studying in it. All the children in this school are gifted: some of them are good at programming, some are good at maths, others are good at PE (Physical Education). Hence, for each child we know value ti:  ti\xe2\x80\x89=\xe2\x80\x891, if the i-th child is good at programming,  ti\xe2\x80\x89=\xe2\x80\x892, if the i-th child is good at maths,  ti\xe2\x80\x89=\xe2\x80\x893, if the i-th child is good at PE Each child happens to be good at exactly one of these three subjects.The Team Scientific Decathlon Olympias requires teams of three students. The school teachers decided that the teams will be composed of three children that are good at different subjects. That is, each team must have one mathematician, one programmer and one sportsman. Of course, each child can be a member of no more than one team.What is the maximum number of teams that the school will be able to present at the Olympiad? How should the teams be formed for that?" 800
489F "Special Matrices" combinatorics,dp "An n\xe2\x80\x89\xc3\x97\xe2\x80\x89n square matrix is special, if:  it is binary, that is, each cell contains either a 0, or a 1;  the number of ones in each row and column equals 2. You are given n and the first m rows of the matrix. Print the number of special n\xe2\x80\x89\xc3\x97\xe2\x80\x89n matrices, such that the first m rows coincide with the given ones.As the required value can be rather large, print the remainder after dividing the value by the given number mod." 2100
489E Hiking "binary search,dp" "A traveler is planning a water hike along the river. He noted the suitable rest points for the night and wrote out their distances from the starting point. Each of these locations is further characterized by its picturesqueness, so for the i-th rest point the distance from the start equals xi, and its picturesqueness equals bi. The traveler will move down the river in one direction, we can assume that he will start from point 0 on the coordinate axis and rest points are points with coordinates xi.Every day the traveler wants to cover the distance l. In practice, it turns out that this is not always possible, because he needs to end each day at one of the resting points. In addition, the traveler is choosing between two desires: cover distance l every day and visit the most picturesque places.Let\'s assume that if the traveler covers distance rj in a day, then he feels frustration , and his total frustration over the hike is calculated as the total frustration on all days.Help him plan the route so as to minimize the relative total frustration: the total frustration divided by the total picturesqueness of all the rest points he used.The traveler\'s path must end in the farthest rest point." 2300
489D "Unbearable Controversy of Being" "brute force,combinatorics,dfs and similar,graphs" "Tomash keeps wandering off and getting lost while he is walking along the streets of Berland. It\'s no surprise! In his home town, for any pair of intersections there is exactly one way to walk from one intersection to the other one. The capital of Berland is very different!Tomash has noticed that even simple cases of ambiguity confuse him. So, when he sees a group of four distinct intersections a, b, c and d, such that there are two paths from a to c \xe2\x80\x94 one through b and the other one through d, he calls the group a ""damn rhombus"". Note that pairs (a,\xe2\x80\x89b), (b,\xe2\x80\x89c), (a,\xe2\x80\x89d), (d,\xe2\x80\x89c) should be directly connected by the roads. Schematically, a damn rhombus is shown on the figure below:  Other roads between any of the intersections don\'t make the rhombus any more appealing to Tomash, so the four intersections remain a ""damn rhombus"" for him.Given that the capital of Berland has n intersections and m roads and all roads are unidirectional and are known in advance, find the number of ""damn rhombi"" in the city.When rhombi are compared, the order of intersections b and d doesn\'t matter." 1700
489C "Given Length and Sum of Digits..." dp,greedy,implementation "You have a positive integer m and a non-negative integer s. Your task is to find the smallest and the largest of the numbers that have length m and sum of digits s. The required numbers should be non-negative integers written in the decimal base without leading zeroes." 1400
489B "BerSU Ball" "dfs and similar,dp,graph matchings,greedy,sortings,two pointers" "The Berland State University is hosting a ballroom dance in celebration of its 100500-th anniversary! n boys and m girls are already busy rehearsing waltz, minuet, polonaise and quadrille moves.We know that several boy&girl pairs are going to be invited to the ball. However, the partners\' dancing skill in each pair must differ by at most one.For each boy, we know his dancing skills. Similarly, for each girl we know her dancing skills. Write a code that can determine the largest possible number of pairs that can be formed from n boys and m girls." 1200
489A SwapSort greedy,implementation,sortings "In this problem your goal is to sort an array consisting of n integers in at most n swaps. For the given array find the sequence of swaps that makes the array sorted in the non-descending order. Swaps are performed consecutively, one after another.Note that in this problem you do not have to minimize the number of swaps \xe2\x80\x94 your task is to find any sequence that is no longer than n." 1200
488B "Candy Boxes" "brute force,constructive algorithms,math" "There is an old tradition of keeping 4 boxes of candies in the house in Cyberland. The numbers of candies are special if their arithmetic mean, their median and their range are all equal. By definition, for a set {x1,\xe2\x80\x89x2,\xe2\x80\x89x3,\xe2\x80\x89x4} (x1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x3\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x4) arithmetic mean is , median is  and range is x4\xe2\x80\x89-\xe2\x80\x89x1. The arithmetic mean and median are not necessary integer. It is well-known that if those three numbers are same, boxes will create a ""debugging field"" and codes in the field will have no bugs.For example, 1,\xe2\x80\x891,\xe2\x80\x893,\xe2\x80\x893 is the example of 4 numbers meeting the condition because their mean, median and range are all equal to 2.Jeff has 4 special boxes of candies. However, something bad has happened! Some of the boxes could have been lost and now there are only n (0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x894) boxes remaining. The i-th remaining box contains ai candies.Now Jeff wants to know: is there a possible way to find the number of candies of the 4\xe2\x80\x89-\xe2\x80\x89n missing boxes, meeting the condition above (the mean, median and range are equal)?" 1900
488A "Giga Tower" "brute force" "Giga Tower is the tallest and deepest building in Cyberland. There are 17\xe2\x80\x89777\xe2\x80\x89777\xe2\x80\x89777 floors, numbered from \xe2\x80\x89-\xe2\x80\x898\xe2\x80\x89888\xe2\x80\x89888\xe2\x80\x89888 to 8\xe2\x80\x89888\xe2\x80\x89888\xe2\x80\x89888. In particular, there is floor 0 between floor \xe2\x80\x89-\xe2\x80\x891 and floor 1. Every day, thousands of tourists come to this place to enjoy the wonderful view. In Cyberland, it is believed that the number ""8"" is a lucky number (that\'s why Giga Tower has 8\xe2\x80\x89888\xe2\x80\x89888\xe2\x80\x89888 floors above the ground), and, an integer is lucky, if and only if its decimal notation contains at least one digit ""8"". For example, 8,\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x89180,\xe2\x80\x89808 are all lucky while 42,\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x8910 are not. In the Giga Tower, if you write code at a floor with lucky floor number, good luck will always be with you (Well, this round is #278, also lucky, huh?).Tourist Henry goes to the tower to seek good luck. Now he is at the floor numbered a. He wants to find the minimum positive integer b, such that, if he walks b floors higher, he will arrive at a floor with a lucky number." 1100
487E Tourists "data structures,dfs and similar,graphs,trees" "There are n cities in Cyberland, numbered from 1 to n, connected by m bidirectional roads. The j-th road connects city aj and bj.For tourists, souvenirs are sold in every city of Cyberland. In particular, city i sell it at a price of wi.Now there are q queries for you to handle. There are two types of queries: ""C a w"": The price in city a is changed to w. ""A a b"": Now a tourist will travel from city a to b. He will choose a route, he also doesn\'t want to visit a city twice. He will buy souvenirs at the city where the souvenirs are the cheapest (possibly exactly at city a or b). You should output the minimum possible price that he can buy the souvenirs during his travel.More formally, we can define routes as follow: A route is a sequence of cities [x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xk], where k is a certain positive integer. For any 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k,\xe2\x80\x89xi\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89xj. For any 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89k, there is a road connecting xi and xi\xe2\x80\x89+\xe2\x80\x891. The minimum price of the route is min(wx1,\xe2\x80\x89wx2,\xe2\x80\x89...,\xe2\x80\x89wxk). The required answer is the minimum value of the minimum prices of all valid routes from a to b." 3200
487D "Conveyor Belts" "data structures" "Automatic Bakery of Cyberland (ABC) recently bought an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m rectangle table. To serve the diners, ABC placed seats around the table. The size of each seat is equal to a unit square, so there are 2(n\xe2\x80\x89+\xe2\x80\x89m) seats in total.ABC placed conveyor belts on each unit square on the table. There are three types of conveyor belts: ""^"", ""<"" and "">"". A ""^"" belt can bring things upwards. ""<"" can bring leftwards and "">"" can bring rightwards.Let\'s number the rows with 1 to n from top to bottom, the columns with 1 to m from left to right. We consider the seats above and below the top of the table are rows 0 and n\xe2\x80\x89+\xe2\x80\x891 respectively. Also we define seats to the left of the table and to the right of the table to be column 0 and m\xe2\x80\x89+\xe2\x80\x891. Due to the conveyor belts direction restriction there are currently no way for a diner sitting in the row n\xe2\x80\x89+\xe2\x80\x891 to be served.Given the initial table, there will be q events in order. There are two types of events:  ""A x y"" means, a piece of bread will appear at row x and column y (we will denote such position as (x,\xe2\x80\x89y)). The bread will follow the conveyor belt, until arriving at a seat of a diner. It is possible that the bread gets stuck in an infinite loop. Your task is to simulate the process, and output the final position of the bread, or determine that there will be an infinite loop.  ""C x y c"" means that the type of the conveyor belt at (x,\xe2\x80\x89y) is changed to c. Queries are performed separately meaning that even if the bread got stuck in an infinite loop, it won\'t affect further queries." 2700
487C "Prefix Product Sequence" "constructive algorithms,math,number theory" "Consider a sequence [a1,\xe2\x80\x89a2,\xe2\x80\x89... ,\xe2\x80\x89an]. Define its prefix product sequence .Now given n, find a permutation of [1,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89n], such that its prefix product sequence is a permutation of [0,\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x891]." 2300
487B Strip "binary search,data structures,dp,two pointers" "Alexandra has a paper strip with n numbers on it. Let\'s call them ai from left to right.Now Alexandra wants to split it into some pieces (possibly 1). For each piece of strip, it must satisfy: Each piece should contain at least l numbers. The difference between the maximal and the minimal number on the piece should be at most s.Please help Alexandra to find the minimal number of pieces meeting the condition above." 2000
487A "Fight the Monster" "binary search,brute force,implementation" "A monster is attacking the Cyberland!Master Yang, a braver, is going to beat the monster. Yang and the monster each have 3 attributes: hitpoints (HP), offensive power (ATK) and defensive power (DEF).During the battle, every second the monster\'s HP decrease by max(0,\xe2\x80\x89ATKY\xe2\x80\x89-\xe2\x80\x89DEFM), while Yang\'s HP decreases by max(0,\xe2\x80\x89ATKM\xe2\x80\x89-\xe2\x80\x89DEFY), where index Y denotes Master Yang and index M denotes monster. Both decreases happen simultaneously Once monster\'s HP\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x890 and the same time Master Yang\'s HP\xe2\x80\x89>\xe2\x80\x890, Master Yang wins.Master Yang can buy attributes from the magic shop of Cyberland: h bitcoins per HP, a bitcoins per ATK, and d bitcoins per DEF.Now Master Yang wants to know the minimum number of bitcoins he can spend in order to win." 1800
486E "LIS of Sequence" "data structures,dp,greedy,hashing,math" "The next ""Data Structures and Algorithms"" lesson will be about Longest Increasing Subsequence (LIS for short) of a sequence. For better understanding, Nam decided to learn it a few days before the lesson.Nam created a sequence a consisting of n (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89105) elements a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ai\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89105). A subsequence ai1,\xe2\x80\x89ai2,\xe2\x80\x89...,\xe2\x80\x89aik where 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i1\xe2\x80\x89<\xe2\x80\x89i2\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89ik\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n is called increasing if ai1\xe2\x80\x89<\xe2\x80\x89ai2\xe2\x80\x89<\xe2\x80\x89ai3\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89aik. An increasing subsequence is called longest if it has maximum length among all increasing subsequences. Nam realizes that a sequence may have several longest increasing subsequences. Hence, he divides all indexes i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n), into three groups: group of all i such that ai belongs to no longest increasing subsequences. group of all i such that ai belongs to at least one but not every longest increasing subsequence. group of all i such that ai belongs to every longest increasing subsequence. Since the number of longest increasing subsequences of a may be very large, categorizing process is very difficult. Your task is to help him finish this job." 2200
486D "Valid Sets" "dfs and similar,dp,math,trees" "As you know, an undirected connected graph with n nodes and n\xe2\x80\x89-\xe2\x80\x891 edges is called a tree. You are given an integer d and a tree consisting of n nodes. Each node i has a value ai associated with it.We call a set S of tree nodes valid if following conditions are satisfied: S is non-empty. S is connected. In other words, if nodes u and v are in S, then all nodes lying on the simple path between u and v should also be presented in S. .Your task is to count the number of valid sets. Since the result can be very large, you must print its remainder modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." 2100
486C "Palindrome Transformation" "brute force,greedy,implementation" "Nam is playing with a string on his computer. The string consists of n lowercase English letters. It is meaningless, so Nam decided to make the string more beautiful, that is to make it be a palindrome by using 4 arrow keys: left, right, up, down.There is a cursor pointing at some symbol of the string. Suppose that cursor is at position i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n, the string uses 1-based indexing) now. Left and right arrow keys are used to move cursor around the string. The string is cyclic, that means that when Nam presses left arrow key, the cursor will move to position i\xe2\x80\x89-\xe2\x80\x891 if i\xe2\x80\x89>\xe2\x80\x891 or to the end of the string (i. e. position n) otherwise. The same holds when he presses the right arrow key (if i\xe2\x80\x89=\xe2\x80\x89n, the cursor appears at the beginning of the string).When Nam presses up arrow key, the letter which the text cursor is pointing to will change to the next letter in English alphabet (assuming that alphabet is also cyclic, i. e. after \'z\' follows \'a\'). The same holds when he presses the down arrow key.Initially, the text cursor is at position p. Because Nam has a lot homework to do, he wants to complete this as fast as possible. Can you help him by calculating the minimum number of arrow keys presses to make the string to be a palindrome?" 1700
486B "OR in Matrix" greedy,hashing,implementation "Let\'s define logical OR as an operation on two logical values (i. e. values that belong to the set {0,\xe2\x80\x891}) that is equal to 1 if either or both of the logical values is set to 1, otherwise it is 0. We can define logical OR of three or more logical values in the same manner: where  is equal to 1 if some ai\xe2\x80\x89=\xe2\x80\x891, otherwise it is equal to 0.Nam has a matrix A consisting of m rows and n columns. The rows are numbered from 1 to m, columns are numbered from 1 to n. Element at row i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m) and column j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) is denoted as Aij. All elements of A are either 0 or 1. From matrix A, Nam creates another matrix B of the same size using formula:.(Bij is OR of all elements in row i and column j of matrix A)Nam gives you matrix B and challenges you to guess matrix A. Although Nam is smart, he could probably make a mistake while calculating matrix B, since size of A can be large." 1300
486A "Calculating Function" implementation,math "For a positive integer n let\'s define a function f:f(n)\xe2\x80\x89=\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x892\xe2\x80\x89-\xe2\x80\x893\xe2\x80\x89+\xe2\x80\x89..\xe2\x80\x89+\xe2\x80\x89(\xe2\x80\x89-\xe2\x80\x891)nn Your task is to calculate f(n) for a given integer n." 800
485B "Valuable Resources" "brute force,greedy" "Many computer strategy games require building cities, recruiting army, conquering tribes, collecting resources. Sometimes it leads to interesting problems. Let\'s suppose that your task is to build a square city. The world map uses the Cartesian coordinates. The sides of the city should be parallel to coordinate axes. The map contains mines with valuable resources, located at some points with integer coordinates. The sizes of mines are relatively small, i.e. they can be treated as points. The city should be built in such a way that all the mines are inside or on the border of the city square. Building a city takes large amount of money depending on the size of the city, so you have to build the city with the minimum area. Given the positions of the mines find the minimum possible area of the city." 1300
485A Factory implementation,math,matrices "One industrial factory is reforming working plan. The director suggested to set a mythical detail production norm. If at the beginning of the day there were x details in the factory storage, then by the end of the day the factory has to produce  (remainder after dividing x by m) more details. Unfortunately, no customer has ever bought any mythical detail, so all the details produced stay on the factory. The board of directors are worried that the production by the given plan may eventually stop (that means that there will be \xd0\xb0 moment when the current number of details on the factory is divisible by m). Given the number of details a on the first day and number m check if the production stops at some moment." 1400
484E "Sign on Fence" "binary search,constructive algorithms,data structures" "Bizon the Champion has recently finished painting his wood fence. The fence consists of a sequence of n panels of 1 meter width and of arbitrary height. The i-th panel\'s height is hi meters. The adjacent planks follow without a gap between them.After Bizon painted the fence he decided to put a ""for sale"" sign on it. The sign will be drawn on a rectangular piece of paper and placed on the fence so that the sides of the sign are parallel to the fence panels and are also aligned with the edges of some panels. Bizon the Champion introduced the following constraints for the sign position:  The width of the sign should be exactly w meters.  The sign must fit into the segment of the fence from the l-th to the r-th panels, inclusive (also, it can\'t exceed the fence\'s bound in vertical direction). The sign will be really pretty, So Bizon the Champion wants the sign\'s height to be as large as possible.You are given the description of the fence and several queries for placing sign. For each query print the maximum possible height of the sign that can be placed on the corresponding segment of the fence with the given fixed width of the sign." 2500
484D Kindergarten "data structures,dp,greedy" "In a kindergarten, the children are being divided into groups. The teacher put the children in a line and associated each child with his or her integer charisma value. Each child should go to exactly one group. Each group should be a nonempty segment of consecutive children of a line. A group\'s sociability is the maximum difference of charisma of two children in the group (in particular, if the group consists of one child, its sociability equals a zero). The teacher wants to divide the children into some number of groups in such way that the total sociability of the groups is maximum. Help him find this value." 2400
484C "Strange Sorting" implementation,math "How many specific orders do you know? Ascending order, descending order, order of ascending length, order of ascending polar angle... Let\'s have a look at another specific order: d-sorting. This sorting is applied to the strings of length at least d, where d is some positive integer. The characters of the string are sorted in following manner: first come all the 0-th characters of the initial string, then the 1-st ones, then the 2-nd ones and so on, in the end go all the (d\xe2\x80\x89-\xe2\x80\x891)-th characters of the initial string. By the i-th characters we mean all the character whose positions are exactly i modulo d. If two characters stand on the positions with the same remainder of integer division by d, their relative order after the sorting shouldn\'t be changed. The string is zero-indexed. For example, for string \'qwerty\':Its 1-sorting is the string \'qwerty\' (all characters stand on 0 positions),Its 2-sorting is the string \'qetwry\' (characters \'q\', \'e\' and \'t\' stand on 0 positions and characters \'w\', \'r\' and \'y\' are on 1 positions),Its 3-sorting is the string \'qrwtey\' (characters \'q\' and \'r\' stand on 0 positions, characters \'w\' and \'t\' stand on 1 positions and characters \'e\' and \'y\' stand on 2 positions),Its 4-sorting is the string \'qtwyer\',Its 5-sorting is the string \'qywert\'.You are given string S of length n and m shuffling operations of this string. Each shuffling operation accepts two integer arguments k and d and transforms string S as follows. For each i from 0 to n\xe2\x80\x89-\xe2\x80\x89k in the increasing order we apply the operation of d-sorting to the substring S[i..i\xe2\x80\x89+\xe2\x80\x89k\xe2\x80\x89-\xe2\x80\x891]. Here S[a..b] represents a substring that consists of characters on positions from a to b inclusive.After each shuffling operation you need to print string S." 2600
484B "Maximum Value" "binary search,math,sortings,two pointers" "You are given a sequence a consisting of n integers. Find the maximum possible value of  (integer remainder of ai divided by aj), where 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i,\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n and ai\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89aj." 2100
484A Bits "bitmasks,constructive algorithms" "Let\'s denote as  the number of bits set (\'1\' bits) in the binary representation of the non-negative integer x.You are given multiple queries consisting of pairs of integers l and r. For each query, find the x, such that l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r, and  is maximum possible. If there are multiple such numbers find the smallest of them." 1700
483B "Friends and Presents" "binary search,math" "You have two friends. You want to present each of them several positive integers. You want to present cnt1 numbers to the first friend and cnt2 numbers to the second friend. Moreover, you want all presented numbers to be distinct, that also means that no number should be presented to both friends.In addition, the first friend does not like the numbers that are divisible without remainder by prime number x. The second one does not like the numbers that are divisible without remainder by prime number y. Of course, you\'re not going to present your friends numbers they don\'t like.Your task is to find such minimum number v, that you can form presents using numbers from a set 1,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89v. Of course you may choose not to present some numbers at all.A positive integer number greater than 1 is called prime if it has no positive divisors other than 1 and itself." 1800
483A Counterexample "brute force,implementation,math,number theory" "Your friend has recently learned about coprime numbers. A pair of numbers {a,\xe2\x80\x89b} is called coprime if the maximum number that divides both a and b is equal to one. Your friend often comes up with different statements. He has recently supposed that if the pair (a,\xe2\x80\x89b) is coprime and the pair (b,\xe2\x80\x89c) is coprime, then the pair (a,\xe2\x80\x89c) is coprime. You want to find a counterexample for your friend\'s statement. Therefore, your task is to find three distinct numbers (a,\xe2\x80\x89b,\xe2\x80\x89c), for which the statement is false, and the numbers meet the condition l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a\xe2\x80\x89<\xe2\x80\x89b\xe2\x80\x89<\xe2\x80\x89c\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r. More specifically, you need to find three numbers (a,\xe2\x80\x89b,\xe2\x80\x89c), such that l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a\xe2\x80\x89<\xe2\x80\x89b\xe2\x80\x89<\xe2\x80\x89c\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r, pairs (a,\xe2\x80\x89b) and (b,\xe2\x80\x89c) are coprime, and pair (a,\xe2\x80\x89c) is not coprime." 1100
482E ELCA "data structures,trees" "You have a root tree containing n vertexes. Let\'s number the tree vertexes with integers from 1 to n. The tree root is in the vertex 1.Each vertex (except fot the tree root) v has a direct ancestor pv. Also each vertex v has its integer value sv. Your task is to perform following queries:  P v u (u\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89v). If u isn\'t in subtree of v, you must perform the assignment pv\xe2\x80\x89=\xe2\x80\x89u. Otherwise you must perform assignment pu\xe2\x80\x89=\xe2\x80\x89v. Note that after this query the graph continues to be a tree consisting of n vertexes. V v t. Perform assignment sv\xe2\x80\x89=\xe2\x80\x89t. Your task is following. Before starting performing queries and after each query you have to calculate expected value written on the lowest common ancestor of two equiprobably selected vertices i and j. Here lowest common ancestor of i and j is the deepest vertex that lies on the both of the path from the root to vertex i and the path from the root to vertex j. Please note that the vertices i and j can be the same (in this case their lowest common ancestor coincides with them)." 3200
482D "Random Function and Tree" combinatorics,dp,trees "You have a rooted tree consisting of n vertices. Let\'s number them with integers from 1 to n inclusive. The root of the tree is the vertex 1. For each i\xe2\x80\x89>\xe2\x80\x891 direct parent of the vertex i is pi. We say that vertex i is child for its direct parent pi.You have initially painted all the vertices with red color. You like to repaint some vertices of the tree. To perform painting you use the function paint that you call with the root of the tree as an argument. Here is the pseudocode of this function:count = 0 // global integer variable rnd() { // this function is used in paint code    return 0 or 1 equiprobably}paint(s) {    if (count is even) then paint s with white color    else paint s with black color    count = count + 1        if rnd() = 1 then children = [array of vertex s children in ascending order of their numbers]    else children = [array of vertex s children in descending order of their numbers]    for child in children { // iterating over children array        if rnd() = 1 then paint(child) // calling paint recursively    }}As a result of this function, some vertices may change their colors to white or black and some of them may remain red.Your task is to determine the number of distinct possible colorings of the vertices of the tree. We will assume that the coloring is possible if there is a nonzero probability to get this coloring with a single call of paint(1). We assume that the colorings are different if there is a pair of vertices that are painted with different colors in these colorings. Since the required number may be very large, find its remainder of division by 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." 2700
482C "Game with Strings" bitmasks,dp,probabilities "You play the game with your friend. The description of this game is listed below. Your friend creates n distinct strings of the same length m and tells you all the strings. Then he randomly chooses one of them. He chooses strings equiprobably, i.e. the probability of choosing each of the n strings equals . You want to guess which string was chosen by your friend. In order to guess what string your friend has chosen, you are allowed to ask him questions. Each question has the following form: \xc2\xabWhat character stands on position pos in the string you have chosen?\xc2\xbb A string is considered guessed when the answers to the given questions uniquely identify the string. After the string is guessed, you stop asking questions. You do not have a particular strategy, so as each question you equiprobably ask about a position that hasn\'t been yet mentioned. Your task is to determine the expected number of questions needed to guess the string chosen by your friend." 2600
482B "Interesting Array" "constructive algorithms,data structures,trees" "We\'ll call an array of n non-negative integers a[1],\xe2\x80\x89a[2],\xe2\x80\x89...,\xe2\x80\x89a[n] interesting, if it meets m constraints. The i-th of the m constraints consists of three integers li, ri, qi (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89li\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ri\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) meaning that value  should be equal to qi. Your task is to find any interesting array of n elements or state that such array doesn\'t exist.Expression x&y means the bitwise AND of numbers x and y. In programming languages C++, Java and Python this operation is represented as ""&"", in Pascal \xe2\x80\x94 as ""and""." 1800
482A "Diverse Permutation" "constructive algorithms,greedy" "Permutation p is an ordered set of integers p1,\xe2\x80\x89\xe2\x80\x89\xe2\x80\x89p2,\xe2\x80\x89\xe2\x80\x89\xe2\x80\x89...,\xe2\x80\x89\xe2\x80\x89\xe2\x80\x89pn, consisting of n distinct positive integers not larger than n. We\'ll denote as n the length of permutation p1,\xe2\x80\x89\xe2\x80\x89\xe2\x80\x89p2,\xe2\x80\x89\xe2\x80\x89\xe2\x80\x89...,\xe2\x80\x89\xe2\x80\x89\xe2\x80\x89pn.Your task is to find such permutation p of length n, that the group of numbers |p1\xe2\x80\x89-\xe2\x80\x89p2|,\xe2\x80\x89|p2\xe2\x80\x89-\xe2\x80\x89p3|,\xe2\x80\x89...,\xe2\x80\x89|pn\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89-\xe2\x80\x89pn| has exactly k distinct elements." 1200
480E "Parking Lot" "data structures,divide and conquer" "Petya\'s been bored at work and he is killing the time by watching the parking lot at the office. The parking lot looks from above like an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m table (a cell of the table corresponds to a single parking spot). Some spots in the parking lot are taken, others are empty.Petya watches cars riding into the parking lot one by one. After a car settles down at the parking spot, Petya amuzes himself by counting what maximum square of empty spots (i.e. a square subtable) can be seen on the parking lot if we look at it from above. Also, he takes notes of the square\'s size (side length) in his notebook. You task is: given the state of the parking lot at the initial moment of time and the information about where the arriving cars park, restore what Petya wrote in his notebook. It is midday, so nobody leaves the lot." 2800
480D Parcels dp,graphs "Jaroslav owns a small courier service. He has recently got and introduced a new system of processing parcels. Each parcel is a box, the box has its weight and strength. The system works as follows. It originally has an empty platform where you can put boxes by the following rules:   If the platform is empty, then the box is put directly on the platform, otherwise it is put on the topmost box on the platform.  The total weight of all boxes on the platform cannot exceed the strength of platform S at any time.  The strength of any box of the platform at any time must be no less than the total weight of the boxes that stand above. You can take only the topmost box from the platform.The system receives n parcels, the i-th parcel arrives exactly at time ini, its weight and strength are equal to wi and si, respectively. Each parcel has a value of vi bourles. However, to obtain this value, the system needs to give the parcel exactly at time outi, otherwise Jaroslav will get 0 bourles for it. Thus, Jaroslav can skip any parcel and not put on the platform, formally deliver it at time ini and not get anything for it. Any operation in the problem is performed instantly. This means that it is possible to make several operations of receiving and delivering parcels at the same time and in any order. Please note that the parcel that is delivered at time outi, immediately gets outside of the system, and the following activities taking place at the same time are made \xe2\x80\x8b\xe2\x80\x8bwithout taking it into consideration. Since the system is very complex, and there are a lot of received parcels, Jaroslav asks you to say what maximum amount of money he can get using his system." 2600
479E "Riding in a Lift" combinatorics,dp "Imagine that you are in a building that has exactly n floors. You can move between the floors in a lift. Let\'s number the floors from bottom to top with integers from 1 to n. Now you\'re on the floor number a. You are very bored, so you want to take the lift. Floor number b has a secret lab, the entry is forbidden. However, you already are in the mood and decide to make k consecutive trips in the lift.Let us suppose that at the moment you are on the floor number x (initially, you were on floor a). For another trip between floors you choose some floor with number y (y\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89x) and the lift travels to this floor. As you cannot visit floor b with the secret lab, you decided that the distance from the current floor x to the chosen y must be strictly less than the distance from the current floor x to floor b with the secret lab. Formally, it means that the following inequation must fulfill: |x\xe2\x80\x89-\xe2\x80\x89y|\xe2\x80\x89<\xe2\x80\x89|x\xe2\x80\x89-\xe2\x80\x89b|. After the lift successfully transports you to floor y, you write down number y in your notepad.Your task is to find the number of distinct number sequences that you could have written in the notebook as the result of k trips in the lift. As the sought number of trips can be rather large, find the remainder after dividing the number by 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." 1900
479D "Long Jumps" "binary search,greedy,implementation" "Valery is a PE teacher at a school in Berland. Soon the students are going to take a test in long jumps, and Valery has lost his favorite ruler! However, there is no reason for disappointment, as Valery has found another ruler, its length is l centimeters. The ruler already has n marks, with which he can make measurements. We assume that the marks are numbered from 1 to n in the order they appear from the beginning of the ruler to its end. The first point coincides with the beginning of the ruler and represents the origin. The last mark coincides with the end of the ruler, at distance l from the origin. This ruler can be repesented by an increasing sequence a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an, where ai denotes the distance of the i-th mark from the origin (a1\xe2\x80\x89=\xe2\x80\x890, an\xe2\x80\x89=\xe2\x80\x89l).Valery believes that with a ruler he can measure the distance of d centimeters, if there is a pair of integers i and j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n), such that the distance between the i-th and the j-th mark is exactly equal to d (in other words, aj\xe2\x80\x89-\xe2\x80\x89ai\xe2\x80\x89=\xe2\x80\x89d). Under the rules, the girls should be able to jump at least x centimeters, and the boys should be able to jump at least y (x\xe2\x80\x89<\xe2\x80\x89y) centimeters. To test the children\'s abilities, Valery needs a ruler to measure each of the distances x and y. Your task is to determine what is the minimum number of additional marks you need to add on the ruler so that they can be used to measure the distances x and y. Valery can add the marks at any integer non-negative distance from the origin not exceeding the length of the ruler." 1700
479C Exams greedy,sortings "Student Valera is an undergraduate student at the University. His end of term exams are approaching and he is to pass exactly n exams. Valera is a smart guy, so he will be able to pass any exam he takes on his first try. Besides, he can take several exams on one day, and in any order.According to the schedule, a student can take the exam for the i-th subject on the day number ai. However, Valera has made an arrangement with each teacher and the teacher of the i-th subject allowed him to take an exam before the schedule time on day bi (bi\xe2\x80\x89<\xe2\x80\x89ai). Thus, Valera can take an exam for the i-th subject either on day ai, or on day bi. All the teachers put the record of the exam in the student\'s record book on the day of the actual exam and write down the date of the mark as number ai.Valera believes that it would be rather strange if the entries in the record book did not go in the order of non-decreasing date. Therefore Valera asks you to help him. Find the minimum possible value of the day when Valera can take the final exam if he takes exams so that all the records in his record book go in the order of non-decreasing date." 1400
479B Towers "brute force,constructive algorithms,greedy,implementation,sortings" "As you know, all the kids in Berland love playing with cubes. Little Petya has n towers consisting of cubes of the same size. Tower with number i consists of ai cubes stacked one on top of the other. Petya defines the instability of a set of towers as a value equal to the difference between the heights of the highest and the lowest of the towers. For example, if Petya built five cube towers with heights (8, 3, 2, 6, 3), the instability of this set is equal to 6 (the highest tower has height 8, the lowest one has height 2). The boy wants the instability of his set of towers to be as low as possible. All he can do is to perform the following operation several times: take the top cube from some tower and put it on top of some other tower of his set. Please note that Petya would never put the cube on the same tower from which it was removed because he thinks it\'s a waste of time. Before going to school, the boy will have time to perform no more than k such operations. Petya does not want to be late for class, so you have to help him accomplish this task." 1400
479A Expression "brute force,math" "Petya studies in a school and he adores Maths. His class has been studying arithmetic expressions. On the last class the teacher wrote three positive integers a, b, c on the blackboard. The task was to insert signs of operations \'+\' and \'*\', and probably brackets between the numbers so that the value of the resulting expression is as large as possible. Let\'s consider an example: assume that the teacher wrote numbers 1, 2 and 3 on the blackboard. Here are some ways of placing signs and brackets:  1+2*3=7  1*(2+3)=5  1*2*3=6  (1+2)*3=9 Note that you can insert operation signs only between a and b, and between b and c, that is, you cannot swap integers. For instance, in the given sample you cannot get expression (1+3)*2.It\'s easy to see that the maximum value that you can obtain is 9.Your task is: given a, b and c print the maximum value that you can get." 1000
478E "Wavy numbers" "brute force,dfs and similar,meet-in-the-middle,sortings" "A wavy number is such positive integer that for any digit of its decimal representation except for the first one and the last one following condition holds: the digit is either strictly larger than both its adjacent digits or strictly less than both its adjacent digits. For example, numbers 35270, 102, 747, 20 and 3 are wavy and numbers 123, 1000 and 2212 are not.The task is to find the k-th smallest wavy number r that is divisible by n for the given integer values n and k.You are to write a program that will find the value of r if it doesn\'t exceed 1014." 2900
478D "Red-Green Towers" dp "There are r red and g green blocks for construction of the red-green tower. Red-green tower can be built following next rules:  Red-green tower is consisting of some number of levels;  Let the red-green tower consist of n levels, then the first level of this tower should consist of n blocks, second level \xe2\x80\x94 of n\xe2\x80\x89-\xe2\x80\x891 blocks, the third one \xe2\x80\x94 of n\xe2\x80\x89-\xe2\x80\x892 blocks, and so on \xe2\x80\x94 the last level of such tower should consist of the one block. In other words, each successive level should contain one block less than the previous one;  Each level of the red-green tower should contain blocks of the same color.  Let h be the maximum possible number of levels of red-green tower, that can be built out of r red and g green blocks meeting the rules above. The task is to determine how many different red-green towers having h levels can be built out of the available blocks.Two red-green towers are considered different if there exists some level, that consists of red blocks in the one tower and consists of green blocks in the other tower.You are to write a program that will find the number of different red-green towers of height h modulo 109\xe2\x80\x89+\xe2\x80\x897." 2000
478C "Table Decorations" greedy "You have r red, g green and b blue balloons. To decorate a single table for the banquet you need exactly three balloons. Three balloons attached to some table shouldn\'t have the same color. What maximum number t of tables can be decorated if we know number of balloons of each color?Your task is to write a program that for given values r, g and b will find the maximum number t of tables, that can be decorated in the required manner." 1800
478B "Random Teams" "combinatorics,constructive algorithms,greedy,math" "n participants of the competition were split into m teams in some manner so that each team has at least one participant. After the competition each pair of participants from the same team became friends.Your task is to write a program that will find the minimum and the maximum number of pairs of friends that could have formed by the end of the competition." 1300
478A "Initial Bet" implementation "There are five people playing a game called ""Generosity"". Each person gives some non-zero number of coins b as an initial bet. After all players make their bets of b coins, the following operation is repeated for several times: a coin is passed from one player to some other player.Your task is to write a program that can, given the number of coins each player has at the end of the game, determine the size b of the initial bet or find out that such outcome of the game cannot be obtained for any positive number of coins b in the initial bet." 1100
477E "Dreamoon and Notepad" "data structures" "Dreamoon has just created a document of hard problems using notepad.exe. The document consists of n lines of text, ai denotes the length of the i-th line. He now wants to know what is the fastest way to move the cursor around because the document is really long.Let (r,\xe2\x80\x89c) be a current cursor position, where r is row number and c is position of cursor in the row. We have 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n and 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89c\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ar.We can use following six operations in notepad.exe to move our cursor assuming the current cursor position is at (r,\xe2\x80\x89c):  up key: the new cursor position (nr,\xe2\x80\x89nc)\xe2\x80\x89=\xe2\x80\x89(max(r\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x891),\xe2\x80\x89min(anr,\xe2\x80\x89c))  down key: the new cursor position (nr,\xe2\x80\x89nc)\xe2\x80\x89=\xe2\x80\x89(min(r\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89n),\xe2\x80\x89min(anr,\xe2\x80\x89c))  left key: the new cursor position (nr,\xe2\x80\x89nc)\xe2\x80\x89=\xe2\x80\x89(r,\xe2\x80\x89max(0,\xe2\x80\x89c\xe2\x80\x89-\xe2\x80\x891))  right key: the new cursor position (nr,\xe2\x80\x89nc)\xe2\x80\x89=\xe2\x80\x89(r,\xe2\x80\x89min(anr,\xe2\x80\x89c\xe2\x80\x89+\xe2\x80\x891))  HOME key: the new cursor position (nr,\xe2\x80\x89nc)\xe2\x80\x89=\xe2\x80\x89(r,\xe2\x80\x890)  END key: the new cursor position (nr,\xe2\x80\x89nc)\xe2\x80\x89=\xe2\x80\x89(r,\xe2\x80\x89ar) You\'re given the document description (n and sequence ai) and q queries from Dreamoon. Each query asks what minimal number of key presses is needed to move the cursor from (r1,\xe2\x80\x89c1) to (r2,\xe2\x80\x89c2)." 3100
477D "Dreamoon and Binary" dp,strings "Dreamoon saw a large integer x written on the ground and wants to print its binary form out. Dreamoon has accomplished the part of turning x into its binary format. Now he is going to print it in the following manner.He has an integer n\xe2\x80\x89=\xe2\x80\x890 and can only perform the following two operations in any order for unlimited times each:  Print n in binary form without leading zeros, each print will append to the right of previous prints.  Increase n by 1. Let\'s define an ideal sequence as a sequence of operations that can successfully print binary representation of x without leading zeros and ends with a print operation (i.e. operation 1). Dreamoon wants to know how many different ideal sequences are there and the length (in operations) of the shortest ideal sequence.The answers might be large so please print them modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897).Let\'s define the string representation of an ideal sequence as a string of \'1\' and \'2\' where the i-th character in the string matches the i-th operation performed. Two ideal sequences are called different if their string representations are different." 2700
476E "Dreamoon and Strings" dp,strings "Dreamoon has a string s and a pattern string p. He first removes exactly x characters from s obtaining string s\' as a result. Then he calculates  that is defined as the maximal number of non-overlapping substrings equal to p that can be found in s\'. He wants to make this number as big as possible.More formally, let\'s define  as maximum value of  over all s\' that can be obtained by removing exactly x characters from s. Dreamoon wants to know  for all x from 0 to |s| where |s| denotes the length of string s." 2200
476D "Dreamoon and Sets" "constructive algorithms,greedy,math" "Dreamoon likes to play with sets, integers and .  is defined as the largest positive integer that divides both a and b.Let S be a set of exactly four distinct integers greater than 0. Define S to be of rank k if and only if for all pairs of distinct elements si, sj from S, .Given k and n, Dreamoon wants to make up n sets of rank k using integers from 1 to m such that no integer is used in two different sets (of course you can leave some integers without use). Calculate the minimum m that makes it possible and print one possible solution." 1900
476C "Dreamoon and Sums" math "Dreamoon loves summing up something for no reason. One day he obtains two integers a and b occasionally. He wants to calculate the sum of all nice integers. Positive integer x is called nice if  and , where k is some integer number in range [1,\xe2\x80\x89a].By  we denote the quotient of integer division of x and y. By  we denote the remainder of integer division of x and y. You can read more about these operations here: http://goo.gl/AcsXhT.The answer may be large, so please print its remainder modulo 1\xe2\x80\x89000\xe2\x80\x89000\xe2\x80\x89007 (109\xe2\x80\x89+\xe2\x80\x897). Can you compute it faster than Dreamoon?" 1600
476B "Dreamoon and WiFi" "bitmasks,brute force,combinatorics,dp,math,probabilities" "Dreamoon is standing at the position 0 on a number line. Drazil is sending a list of commands through Wi-Fi to Dreamoon\'s smartphone and Dreamoon follows them.Each command is one of the following two types:   Go 1 unit towards the positive direction, denoted as \'+\'  Go 1 unit towards the negative direction, denoted as \'-\' But the Wi-Fi condition is so poor that Dreamoon\'s smartphone reports some of the commands can\'t be recognized and Dreamoon knows that some of them might even be wrong though successfully recognized. Dreamoon decides to follow every recognized command and toss a fair coin to decide those unrecognized ones (that means, he moves to the 1 unit to the negative or positive direction with the same probability 0.5). You are given an original list of commands sent by Drazil and list received by Dreamoon. What is the probability that Dreamoon ends in the position originally supposed to be final by Drazil\'s commands?" 1300
476A "Dreamoon and Stairs" implementation,math "Dreamoon wants to climb up a stair of n steps. He can climb 1 or 2 steps at each move. Dreamoon wants the number of moves to be a multiple of an integer m. What is the minimal number of moves making him climb to the top of the stairs that satisfies his condition?" 1000
475F Meta-universe "data structures" "Consider infinite grid of unit cells. Some of those cells are planets. Meta-universe M\xe2\x80\x89=\xe2\x80\x89{p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pk} is a set of planets. Suppose there is an infinite row or column with following two properties: 1) it doesn\'t contain any planet pi of meta-universe M on it; 2) there are planets of M located on both sides from this row or column. In this case we can turn the meta-universe M into two non-empty meta-universes M1 and M2 containing planets that are located on respective sides of this row or column. A meta-universe which can\'t be split using operation above is called a universe. We perform such operations until all meta-universes turn to universes.Given positions of the planets in the original meta-universe, find the number of universes that are result of described process. It can be proved that each universe is uniquely identified not depending from order of splitting." 2900
475E "Strongly Connected City 2" "dfs and similar" "Imagine a city with n junctions and m streets. Junctions are numbered from 1 to n.In order to increase the traffic flow, mayor of the city has decided to make each street one-way. This means in the street between junctions u and v, the traffic moves only from u to v or only from v to u. The problem is to direct the traffic flow of streets in a way that maximizes the number of pairs (u,\xe2\x80\x89v) where 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89u,\xe2\x80\x89v\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n and it is possible to reach junction v from u by passing the streets in their specified direction. Your task is to find out maximal possible number of such pairs." 2700
475D CGCDSSQ "brute force,data structures,math" "Given a sequence of integers a1,\xe2\x80\x89...,\xe2\x80\x89an and q queries x1,\xe2\x80\x89...,\xe2\x80\x89xq on it. For each query xi you have to count the number of pairs (l,\xe2\x80\x89r) such that 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n and gcd(al,\xe2\x80\x89al\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89ar)\xe2\x80\x89=\xe2\x80\x89xi. is a greatest common divisor of v1,\xe2\x80\x89v2,\xe2\x80\x89...,\xe2\x80\x89vn, that is equal to a largest positive integer that divides all vi." 2000
475C "Kamal-ol-molk\'s Painting" "brute force,constructive algorithms,greedy" "Rumors say that one of Kamal-ol-molk\'s paintings has been altered. A rectangular brush has been moved right and down on the painting.Consider the painting as a n\xe2\x80\x89\xc3\x97\xe2\x80\x89m rectangular grid. At the beginning an x\xe2\x80\x89\xc3\x97\xe2\x80\x89y rectangular brush is placed somewhere in the frame, with edges parallel to the frame, (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n,\xe2\x80\x891\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m). Then the brush is moved several times. Each time the brush is moved one unit right or down. The brush has been strictly inside the frame during the painting. The brush alters every cell it has covered at some moment.You have found one of the old Kamal-ol-molk\'s paintings. You want to know if it\'s possible that it has been altered in described manner. If yes, you also want to know minimum possible area of the brush." 2100
475B "Strongly Connected City" "brute force,dfs and similar,graphs,implementation" "Imagine a city with n horizontal streets crossing m vertical streets, forming an (n\xe2\x80\x89-\xe2\x80\x891)\xe2\x80\x89\xc3\x97\xe2\x80\x89(m\xe2\x80\x89-\xe2\x80\x891) grid. In order to increase the traffic flow, mayor of the city has decided to make each street one way. This means in each horizontal street, the traffic moves only from west to east or only from east to west. Also, traffic moves only from north to south or only from south to north in each vertical street. It is possible to enter a horizontal street from a vertical street, or vice versa, at their intersection.  The mayor has received some street direction patterns. Your task is to check whether it is possible to reach any junction from any other junction in the proposed street direction pattern." 1400
475A "Bayan Bus" implementation "The final round of Bayan Programming Contest will be held in Tehran, and the participants will be carried around with a yellow bus. The bus has 34 passenger seats: 4 seats in the last row and 3 seats in remaining rows.   The event coordinator has a list of k participants who should be picked up at the airport. When a participant gets on the bus, he will sit in the last row with an empty seat. If there is more than one empty seat in that row, he will take the leftmost one. In order to keep track of the people who are on the bus, the event coordinator needs a figure showing which seats are going to be taken by k participants. Your task is to draw the figure representing occupied seats." 1100
474F "Ant colony" "data structures,math,number theory" "Mole is hungry again. He found one ant colony, consisting of n ants, ordered in a row. Each ant i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) has a strength si.In order to make his dinner more interesting, Mole organizes a version of \xc2\xabHunger Games\xc2\xbb for the ants. He chooses two numbers l and r (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) and each pair of ants with indices between l and r (inclusively) will fight. When two ants i and j fight, ant i gets one battle point only if si divides sj (also, ant j gets one battle point only if sj divides si). After all fights have been finished, Mole makes the ranking. An ant i, with vi battle points obtained, is going to be freed only if vi\xe2\x80\x89=\xe2\x80\x89r\xe2\x80\x89-\xe2\x80\x89l, or in other words only if it took a point in every fight it participated. After that, Mole eats the rest of the ants. Note that there can be many ants freed or even none.In order to choose the best sequence, Mole gives you t segments [li,\xe2\x80\x89ri] and asks for each of them how many ants is he going to eat if those ants fight." 2100
474E Pillars "binary search,data structures,dp,sortings,trees" "Marmot found a row with n pillars. The i-th pillar has the height of hi meters. Starting from one pillar i1, Marmot wants to jump on the pillars i2, ..., ik. (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i1\xe2\x80\x89<\xe2\x80\x89i2\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89ik\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n). From a pillar i Marmot can jump on a pillar j only if i\xe2\x80\x89<\xe2\x80\x89j and |hi\xe2\x80\x89-\xe2\x80\x89hj|\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89d, where |x| is the absolute value of the number x.Now Marmot is asking you find out a jump sequence with maximal length and print it." 2000
474D Flowers dp "We saw the little game Marmot made for Mole\'s lunch. Now it\'s Marmot\'s dinner time and, as we all know, Marmot eats flowers. At every dinner he eats some red and white flowers. Therefore a dinner can be represented as a sequence of several flowers, some of them white and some of them red.But, for a dinner to be tasty, there is a rule: Marmot wants to eat white flowers only in groups of size k.Now Marmot wonders in how many ways he can eat between a and b flowers. As the number of ways could be very large, print it modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." 1700
474C "Captain Marmot" "brute force,geometry" "Captain Marmot wants to prepare a huge and important battle against his enemy, Captain Snake. For this battle he has n regiments, each consisting of 4 moles.Initially, each mole i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x894n) is placed at some position (xi,\xe2\x80\x89yi) in the Cartesian plane. Captain Marmot wants to move some moles to make the regiments compact, if it\'s possible.Each mole i has a home placed at the position (ai,\xe2\x80\x89bi). Moving this mole one time means rotating his position point (xi,\xe2\x80\x89yi) 90 degrees counter-clockwise around it\'s home point (ai,\xe2\x80\x89bi).A regiment is compact only if the position points of the 4 moles form a square with non-zero area.Help Captain Marmot to find out for each regiment the minimal number of moves required to make that regiment compact, if it\'s possible." 2000
474B Worms "binary search,implementation" "It is lunch time for Mole. His friend, Marmot, prepared him a nice game for lunch.Marmot brought Mole n ordered piles of worms such that i-th pile contains ai worms. He labeled all these worms with consecutive integers: worms in first pile are labeled with numbers 1 to a1, worms in second pile are labeled with numbers a1\xe2\x80\x89+\xe2\x80\x891 to a1\xe2\x80\x89+\xe2\x80\x89a2 and so on. See the example for a better understanding.Mole can\'t eat all the worms (Marmot brought a lot) and, as we all know, Mole is blind, so Marmot tells him the labels of the best juicy worms. Marmot will only give Mole a worm if Mole says correctly in which pile this worm is contained.Poor Mole asks for your help. For all juicy worms said by Marmot, tell Mole the correct answers." 1200
474A Keyboard implementation "Our good friend Mole is trying to code a big message. He is typing on an unusual keyboard with characters arranged in following way:qwertyuiopasdfghjkl;zxcvbnm,./Unfortunately Mole is blind, so sometimes it is problem for him to put his hands accurately. He accidentally moved both his hands with one position to the left or to the right. That means that now he presses not a button he wants, but one neighboring button (left or right, as specified in input).We have a sequence of characters he has typed and we want to find the original message." 900
472G "Design Tutorial: Increase the Constraints" "bitmasks,data structures,fft" "There is a simple way to create hard tasks: take one simple problem as the query, and try to find an algorithm that can solve it faster than bruteforce. This kind of tasks usually appears in OI contest, and usually involves data structures.Let\'s try to create a task, for example, we take the ""Hamming distance problem"": for two binary strings s and t with the same length, the Hamming distance between them is the number of positions at which the corresponding symbols are different. For example, the Hamming distance between ""00111"" and ""10101"" is 2 (the different symbols are marked with bold).We use the Hamming distance problem as a query in the following way: you are given two strings a and b and several queries. Each query will be: what is the Hamming distance between two strings ap1ap1\xe2\x80\x89+\xe2\x80\x891...ap1\xe2\x80\x89+\xe2\x80\x89len\xe2\x80\x89-\xe2\x80\x891 and bp2bp2\xe2\x80\x89+\xe2\x80\x891...bp2\xe2\x80\x89+\xe2\x80\x89len\xe2\x80\x89-\xe2\x80\x891?Note, that in this problem the strings are zero-based, that is s\xe2\x80\x89=\xe2\x80\x89s0s1... s|s|\xe2\x80\x89-\xe2\x80\x891." 2800
472F "Design Tutorial: Change the Goal" "constructive algorithms,math,matrices" "There are some tasks which have the following structure: you are given a model, and you can do some operations, you should use these operations to achive the goal. One way to create a new task is to use the same model and same operations, but change the goal.Let\'s have a try. I have created the following task for Topcoder SRM 557 Div1-Hard: you are given n integers x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xn. You are allowed to perform the assignments (as many as you want) of the following form xi ^= xj (in the original task i and j must be different, but in this task we allow i to equal j). The goal is to maximize the sum of all xi.Now we just change the goal. You are also given n integers y1,\xe2\x80\x89y2,\xe2\x80\x89...,\xe2\x80\x89yn. You should make x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xn exactly equal to y1,\xe2\x80\x89y2,\xe2\x80\x89...,\xe2\x80\x89yn. In other words, for each i number xi should be equal to yi." 2700
472E "Design Tutorial: Learn from a Game" "constructive algorithms,implementation" "One way to create task is to learn from game. You should pick a game and focus on part of the mechanic of that game, then it might be a good task.Let\'s have a try. Puzzle and Dragon was a popular game in Japan, we focus on the puzzle part of that game, it is a tile-matching puzzle.(Picture from Wikipedia page: http://en.wikipedia.org/wiki/Puzzle_&_Dragons)There is an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m board which consists of orbs. During the game you can do the following move. In the beginning of move you touch a cell of the board, then you can move your finger to one of the adjacent cells (a cell not on the boundary has 8 adjacent cells), then you can move your finger from the current cell to one of the adjacent cells one more time, and so on. Each time you move your finger from a cell to another cell, the orbs in these cells swap with each other. In other words whatever move you make, the orb in the cell you are touching never changes.The goal is to achieve such kind of pattern that the orbs will be cancelled and your monster will attack the enemy, but we don\'t care about these details. Instead, we will give you the initial board as an input and the target board as an output. Your goal is to determine whether there is a way to reach the target in a single move." 2800
472D "Design Tutorial: Inverse the Problem" "dfs and similar,dsu,shortest paths,trees" "There is an easy way to obtain a new task from an old one called ""Inverse the problem"": we give an output of the original task, and ask to generate an input, such that solution to the original problem will produce the output we provided. The hard task of Topcoder Open 2014 Round 2C, InverseRMQ, is a good example.Now let\'s create a task this way. We will use the task: you are given a tree, please calculate the distance between any pair of its nodes. Yes, it is very easy, but the inverse version is a bit harder: you are given an n\xe2\x80\x89\xc3\x97\xe2\x80\x89n distance matrix. Determine if it is the distance matrix of a weighted tree (all weights must be positive integers)." 1900
472C "Design Tutorial: Make It Nondeterministic" greedy "A way to make a new task is to make it nondeterministic or probabilistic. For example, the hard task of Topcoder SRM 595, Constellation, is the probabilistic version of a convex hull.Let\'s try to make a new task. Firstly we will use the following task. There are n people, sort them by their name. It is just an ordinary sorting problem, but we can make it more interesting by adding nondeterministic element. There are n people, each person will use either his/her first name or last name as a handle. Can the lexicographical order of the handles be exactly equal to the given permutation p?More formally, if we denote the handle of the i-th person as hi, then the following condition must hold: ." 1400
472B "Design Tutorial: Learn from Life" NA "One way to create a task is to learn from life. You can choose some experience in real life, formalize it and then you will get a new task.Let\'s think about a scene in real life: there are lots of people waiting in front of the elevator, each person wants to go to a certain floor. We can formalize it in the following way. We have n people standing on the first floor, the i-th person wants to go to the fi-th floor. Unfortunately, there is only one elevator and its capacity equal to k (that is at most k people can use it simultaneously). Initially the elevator is located on the first floor. The elevator needs |a\xe2\x80\x89-\xe2\x80\x89b| seconds to move from the a-th floor to the b-th floor (we don\'t count the time the people need to get on and off the elevator).What is the minimal number of seconds that is needed to transport all the people to the corresponding floors and then return the elevator to the first floor?" 1300
472A "Design Tutorial: Learn from Math" "math,number theory" "One way to create a task is to learn from math. You can generate some random math statement or modify some theorems to get something new and build a new task from that.For example, there is a statement called the ""Goldbach\'s conjecture"". It says: ""each even number no less than four can be expressed as the sum of two primes"". Let\'s modify it. How about a statement like that: ""each integer no less than 12 can be expressed as the sum of two composite numbers."" Not like the Goldbach\'s conjecture, I can prove this theorem.You are given an integer n no less than 12, express it as a sum of two composite numbers." 800
471E "MUH and Lots and Lots of Segments" "data structures,dsu" "Polar bears Menshykov and Uslada from the zoo of St. Petersburg and elephant Horace from the zoo of Kiev decided to do some painting. As they were trying to create their first masterpiece, they made a draft on a piece of paper. The draft consists of n segments. Each segment was either horizontal or vertical. Now the friends want to simplify the draft by deleting some segments or parts of segments so that the final masterpiece meets three conditions:  Horace wants to be able to paint the whole picture in one stroke: by putting the brush on the paper and never taking it off until the picture is ready. The brush can paint the same place multiple times. That\'s why all the remaining segments must form a single connected shape.  Menshykov wants the resulting shape to be simple. He defines a simple shape as a shape that doesn\'t contain any cycles.  Initially all the segment on the draft have integer startpoint and endpoint coordinates. Uslada doesn\'t like real coordinates and she wants this condition to be fulfilled after all the changes. As in other parts the draft is already beautiful, the friends decided to delete such parts of the draft that the sum of lengths of the remaining segments is as large as possible. Your task is to count this maximum sum of the lengths that remain after all the extra segments are removed." 2700
471D "MUH and Cube Walls" "string suffix structures,strings" "Polar bears Menshykov and Uslada from the zoo of St. Petersburg and elephant Horace from the zoo of Kiev got hold of lots of wooden cubes somewhere. They started making cube towers by placing the cubes one on top of the other. They defined multiple towers standing in a line as a wall. A wall can consist of towers of different heights.Horace was the first to finish making his wall. He called his wall an elephant. The wall consists of w towers. The bears also finished making their wall but they didn\'t give it a name. Their wall consists of n towers. Horace looked at the bears\' tower and wondered: in how many parts of the wall can he ""see an elephant""? He can ""see an elephant"" on a segment of w contiguous towers if the heights of the towers on the segment match as a sequence the heights of the towers in Horace\'s wall. In order to see as many elephants as possible, Horace can raise and lower his wall. He even can lower the wall below the ground level (see the pictures to the samples for clarification).Your task is to count the number of segments where Horace can ""see an elephant""." 1800
471C "MUH and House of Cards" "binary search,brute force,greedy,math" "Polar bears Menshykov and Uslada from the zoo of St. Petersburg and elephant Horace from the zoo of Kiev decided to build a house of cards. For that they\'ve already found a hefty deck of n playing cards. Let\'s describe the house they want to make:   The house consists of some non-zero number of floors.  Each floor consists of a non-zero number of rooms and the ceiling. A room is two cards that are leaned towards each other. The rooms are made in a row, each two adjoining rooms share a ceiling made by another card.  Each floor besides for the lowest one should contain less rooms than the floor below. Please note that the house may end by the floor with more than one room, and in this case they also must be covered by the ceiling. Also, the number of rooms on the adjoining floors doesn\'t have to differ by one, the difference may be more. While bears are practicing to put cards, Horace tries to figure out how many floors their house should consist of. The height of the house is the number of floors in it. It is possible that you can make a lot of different houses of different heights out of n cards. It seems that the elephant cannot solve this problem and he asks you to count the number of the distinct heights of the houses that they can make using exactly n cards." 1700
471B "MUH and Important Things" implementation,sortings "It\'s time polar bears Menshykov and Uslada from the zoo of St. Petersburg and elephant Horace from the zoo of Kiev got down to business. In total, there are n tasks for the day and each animal should do each of these tasks. For each task, they have evaluated its difficulty. Also animals decided to do the tasks in order of their difficulty. Unfortunately, some tasks can have the same difficulty, so the order in which one can perform the tasks may vary.Menshykov, Uslada and Horace ask you to deal with this nuisance and come up with individual plans for each of them. The plan is a sequence describing the order in which an animal should do all the n tasks. Besides, each of them wants to have its own unique plan. Therefore three plans must form three different sequences. You are to find the required plans, or otherwise deliver the sad news to them by stating that it is impossible to come up with three distinct plans for the given tasks." 1300
471A "MUH and Sticks" implementation "Two polar bears Menshykov and Uslada from the St.Petersburg zoo and elephant Horace from the Kiev zoo got six sticks to play with and assess the animals\' creativity. Menshykov, Uslada and Horace decided to make either an elephant or a bear from those sticks. They can make an animal from sticks in the following way:   Four sticks represent the animal\'s legs, these sticks should have the same length.  Two remaining sticks represent the animal\'s head and body. The bear\'s head stick must be shorter than the body stick. The elephant, however, has a long trunk, so his head stick must be as long as the body stick. Note that there are no limits on the relations between the leg sticks and the head and body sticks. Your task is to find out which animal can be made from the given stick set. The zoo keeper wants the sticks back after the game, so they must never be broken, even bears understand it." 1100
470H "Array Sorting" "*special problem" "Sorting arrays is traditionally associated with high-level languages. How hard can it be in FALSE? Sort the given array in non-descending order." 2300
470G "Hamming Distance" "*special problem" "Hamming distance between two strings of equal length is the number of positions at which the corresponding symbols are different. You are given two strings; calculate the distance between them." 2300
470F "Pairwise Sums" "*special problem" "You are given an array of n integers. For each element output the sum of itself and the previous element. For the first element, output the sum of the first and the last elements of the array." 2300
470E Chessboard "*special problem" "Chessboard is a board of n\xe2\x80\x89\xc3\x97\xe2\x80\x89n squares arranged in two alternating colors (black and white). Top left square is white. You are given board size n. Output an image of a chessboard, with black and white squares marked with \'#\' and \'.\' characters, respectively." 1900
470D "Caesar Cipher" "*special problem" "Caesar cipher is one of the simplest encryption techniques. To transform the original message into encrypted one using key k, one has to replace each letter with a letter which is k positions later in the alphabet (if this takes the position beyond Z, the rest of it is counted from the start of the alphabet). In a more formal way, if letters of the alphabet are enumerated starting with 0, the result of encryption for character x will be  (26 is the number of letters in the Latin alphabet).You are given the original message and the encryption key k. Output the result of encryption." 1900
470C Eval "*special problem" "You are given a simple arithmetic expression of the form a?b, where a and b are integer constants, and ? can be one of the following operations: \'+\' (addition), \'-\' (subtraction), \'*\' (multiplication), \'/\' (integer division) or \'%\' (modulo operation).Output the result of evaluation of this expression." 1900
470B Hexakosioihexekontahexaphobia "*special problem" "This (unpronounceable) word means simply fear of number 666. You are given a string of digits. Check whether it is scary for a person suffering from this phobia, i.e., whether it contains number 666 as a substring." 1800
470A "Crystal Ball Sequence" "*special problem,implementation" "Crystal ball sequence on hexagonal lattice is defined as follows: n-th element is the number of lattice points inside a hexagon with (n\xe2\x80\x89+\xe2\x80\x891) points on each side. The formula is Hn\xe2\x80\x89=\xe2\x80\x893\xc2\xb7n\xc2\xb7(n\xe2\x80\x89+\xe2\x80\x891)\xe2\x80\x89+\xe2\x80\x891. You are given n; calculate n-th element of the sequence." 1400
469B "Chat Online" implementation "Little X and Little Z are good friends. They always chat online. But both of them have schedules.Little Z has fixed schedule. He always online at any moment of time between a1 and b1, between a2 and b2, ..., between ap and bp (all borders inclusive). But the schedule of Little X is quite strange, it depends on the time when he gets up. If he gets up at time 0, he will be online at any moment of time between c1 and d1, between c2 and d2, ..., between cq and dq (all borders inclusive). But if he gets up at time t, these segments will be shifted by t. They become [ci\xe2\x80\x89+\xe2\x80\x89t,\xe2\x80\x89di\xe2\x80\x89+\xe2\x80\x89t] (for all i).If at a moment of time, both Little X and Little Z are online simultaneosly, they can chat online happily. You know that Little X can get up at an integer moment of time between l and r (both borders inclusive). Also you know that Little X wants to get up at the moment of time, that is suitable for chatting with Little Z (they must have at least one common moment of time in schedules). How many integer moments of time from the segment [l,\xe2\x80\x89r] suit for that?" 1300
469A "I Wanna Be the Guy" greedy,implementation "There is a game called ""I Wanna Be the Guy"", consisting of n levels. Little X and his friend Little Y are addicted to the game. Each of them wants to pass the whole game.Little X can pass only p levels of the game. And Little Y can pass only q levels of the game. You are given the indices of levels Little X can pass and the indices of levels Little Y can pass. Will Little X and Little Y pass the whole game, if they cooperate each other?" 800
468E Permanent "dp,graph matchings,math,meet-in-the-middle" "Little X has solved the #P-complete problem in polynomial time recently. So he gives this task to you. There is a special n\xe2\x80\x89\xc3\x97\xe2\x80\x89n matrix A, you should calculate its permanent modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897). The special property of matrix A is almost all its elements equal to 1. Only k elements have specified value.You can find the definition of permanent at the link: https://en.wikipedia.org/wiki/Permanent" 3100
468D Tree "graph matchings" "Little X has a tree consisting of n nodes (they are numbered from 1 to n). Each edge of the tree has a positive length. Let\'s define the distance between two nodes v and u (we\'ll denote it d(v,\xe2\x80\x89u)) as the sum of the lengths of edges in the shortest path between v and u. A permutation p is a sequence of n distinct integers p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pn (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89pi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n). Little X wants to find a permutation p such that sum  is maximal possible. If there are multiple optimal permutations, he wants to find the lexicographically smallest one. Help him with the task!" 3100
468C "Hack it!" "binary search,constructive algorithms,math" "Little X has met the following problem recently. Let\'s define f(x) as the sum of digits in decimal representation of number x (for example, f(1234)\xe2\x80\x89=\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x892\xe2\x80\x89+\xe2\x80\x893\xe2\x80\x89+\xe2\x80\x894). You are to calculate Of course Little X has solved this problem quickly, has locked it, and then has tried to hack others. He has seen the following C++ code:     ans = solve(l, r) % a;    if (ans <= 0)      ans += a; This code will fail only on the test with . You are given number a, help Little X to find a proper test for hack." 2500
468B "Two Sets" "2-sat,dfs and similar,dsu,graph matchings,greedy" "Little X has n distinct integers: p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pn. He wants to divide all of them into two sets A and B. The following two conditions must be satisfied:  If number x belongs to set A, then number a\xe2\x80\x89-\xe2\x80\x89x must also belong to set A.  If number x belongs to set B, then number b\xe2\x80\x89-\xe2\x80\x89x must also belong to set B. Help Little X divide the numbers into two sets or determine that it\'s impossible." 2000
468A "24 Game" "constructive algorithms,greedy,math" "Little X used to play a card game called ""24 Game"", but recently he has found it too easy. So he invented a new game.Initially you have a sequence of n integers: 1,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89n. In a single step, you can pick two of them, let\'s denote them a and b, erase them from the sequence, and append to the sequence either a\xe2\x80\x89+\xe2\x80\x89b, or a\xe2\x80\x89-\xe2\x80\x89b, or a\xe2\x80\x89\xc3\x97\xe2\x80\x89b.After n\xe2\x80\x89-\xe2\x80\x891 steps there is only one number left. Can you make this number equal to 24?" 1500
467E "Alex and Complicated Task" "data structures,dp,greedy" "After you have read all the problems, probably, you think Alex is genius person. That\'s true! One day he came up with the following task.Given a sequence of integer numbers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. You are to find a longest sequence b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89b4m, that satisfies the following conditions:  b4k\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89=\xe2\x80\x89b4k\xe2\x80\x89+\xe2\x80\x893 for all valid integer k;  b4k\xe2\x80\x89+\xe2\x80\x892\xe2\x80\x89=\xe2\x80\x89b4k\xe2\x80\x89+\xe2\x80\x894 for all valid integer k;  sequence b is subsequence of a (not necessarily contiguous subsequence). And finally... Alex had given this complicated task to George, and George gave it to you. Help George to cope with the task." 2300
467D "Fedor and Essay" "dfs and similar,dp,graphs,hashing,strings" "After you had helped Fedor to find friends in the \xc2\xabCall of Soldiers 3\xc2\xbb game, he stopped studying completely. Today, the English teacher told him to prepare an essay. Fedor didn\'t want to prepare the essay, so he asked Alex for help. Alex came to help and wrote the essay for Fedor. But Fedor didn\'t like the essay at all. Now Fedor is going to change the essay using the synonym dictionary of the English language.Fedor does not want to change the meaning of the essay. So the only change he would do: change a word from essay to one of its synonyms, basing on a replacement rule from the dictionary. Fedor may perform this operation any number of times.As a result, Fedor wants to get an essay which contains as little letters \xc2\xabR\xc2\xbb (the case doesn\'t matter) as possible. If there are multiple essays with minimum number of \xc2\xabR\xc2\xbbs he wants to get the one with minimum length (length of essay is the sum of the lengths of all the words in it). Help Fedor get the required essay.Please note that in this problem the case of letters doesn\'t matter. For example, if the synonym dictionary says that word cat can be replaced with word DOG, then it is allowed to replace the word Cat with the word doG." 2400
467C "George and Job" dp,implementation "The new ITone 6 has been released recently and George got really keen to buy it. Unfortunately, he didn\'t have enough money, so George was going to work as a programmer. Now he faced the following problem at the work.Given a sequence of n integers p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pn. You are to choose k pairs of integers: [l1,\xe2\x80\x89r1],\xe2\x80\x89[l2,\xe2\x80\x89r2],\xe2\x80\x89...,\xe2\x80\x89[lk,\xe2\x80\x89rk] (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r1\xe2\x80\x89<\xe2\x80\x89l2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r2\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89lk\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89rk\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n; ri\xe2\x80\x89-\xe2\x80\x89li\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89=\xe2\x80\x89m),\xe2\x80\x89in such a way that the value of sum  is maximal possible. Help George to cope with the task." 1700
467B "Fedor and New Game" "bitmasks,brute force,constructive algorithms,implementation" "After you had helped George and Alex to move in the dorm, they went to help their friend Fedor play a new computer game \xc2\xabCall of Soldiers 3\xc2\xbb.The game has (m\xe2\x80\x89+\xe2\x80\x891) players and n types of soldiers in total. Players \xc2\xabCall of Soldiers 3\xc2\xbb are numbered form 1 to (m\xe2\x80\x89+\xe2\x80\x891). Types of soldiers are numbered from 0 to n\xe2\x80\x89-\xe2\x80\x891. Each player has an army. Army of the i-th player can be described by non-negative integer xi. Consider binary representation of xi: if the j-th bit of number xi equal to one, then the army of the i-th player has soldiers of the j-th type. Fedor is the (m\xe2\x80\x89+\xe2\x80\x891)-th player of the game. He assume that two players can become friends if their armies differ in at most k types of soldiers (in other words, binary representations of the corresponding numbers differ in at most k bits). Help Fedor and count how many players can become his friends." 1100
467A "George and Accommodation" implementation "George has recently entered the BSUCP (Berland State University for Cool Programmers). George has a friend Alex who has also entered the university. Now they are moving into a dormitory. George and Alex want to live in the same room. The dormitory has n rooms in total. At the moment the i-th room has pi people living in it and the room can accommodate qi people in total (pi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89qi). Your task is to count how many rooms has free place for both George and Alex." 800
466E "Information Graph" "dfs and similar,dsu,graphs,trees" "There are n employees working in company ""X"" (let\'s number them from 1 to n for convenience). Initially the employees didn\'t have any relationships among each other. On each of m next days one of the following events took place:  either employee y became the boss of employee x (at that, employee x didn\'t have a boss before);  or employee x gets a packet of documents and signs them; then he gives the packet to his boss. The boss signs the documents and gives them to his boss and so on (the last person to sign the documents sends them to the archive);  or comes a request of type ""determine whether employee x signs certain documents"". Your task is to write a program that will, given the events, answer the queries of the described type. At that, it is guaranteed that throughout the whole working time the company didn\'t have cyclic dependencies." 2100
466D "Increase Sequence" combinatorics,dp "Peter has a sequence of integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. Peter wants all numbers in the sequence to equal h. He can perform the operation of ""adding one on the segment [l,\xe2\x80\x89r]"": add one to all elements of the sequence with indices from l to r (inclusive). At that, Peter never chooses any element as the beginning of the segment twice. Similarly, Peter never chooses any element as the end of the segment twice. In other words, for any two segments [l1,\xe2\x80\x89r1] and [l2,\xe2\x80\x89r2], where Peter added one, the following inequalities hold: l1\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89l2 and r1\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89r2.How many distinct ways are there to make all numbers in the sequence equal h? Print this number of ways modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897). Two ways are considered distinct if one of them has a segment that isn\'t in the other way." 2100
466C "Number of Ways" "binary search,brute force,data structures,dp,two pointers" "You\'ve got array a[1],\xe2\x80\x89a[2],\xe2\x80\x89...,\xe2\x80\x89a[n], consisting of n integers. Count the number of ways to split all the elements of the array into three contiguous parts so that the sum of elements in each part is the same. More formally, you need to find the number of such pairs of indices i,\xe2\x80\x89j (2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x891), that ." 1700
466B "Wonder Room" "brute force,math" "The start of the new academic year brought about the problem of accommodation students into dormitories. One of such dormitories has a a\xe2\x80\x89\xc3\x97\xe2\x80\x89b square meter wonder room. The caretaker wants to accommodate exactly n students there. But the law says that there must be at least 6 square meters per student in a room (that is, the room for n students must have the area of at least 6n square meters). The caretaker can enlarge any (possibly both) side of the room by an arbitrary positive integer of meters. Help him change the room so as all n students could live in it and the total area of the room was as small as possible." 2000
466A "Cheap Travel" implementation "Ann has recently started commuting by subway. We know that a one ride subway ticket costs a rubles. Besides, Ann found out that she can buy a special ticket for m rides (she can buy it several times). It costs b rubles. Ann did the math; she will need to use subway n times. Help Ann, tell her what is the minimum sum of money she will have to spend to make n rides?" 1200
465B "Inbox (100500)" implementation "Over time, Alexey\'s mail box got littered with too many letters. Some of them are read, while others are unread.Alexey\'s mail program can either show a list of all letters or show the content of a single letter. As soon as the program shows the content of an unread letter, it becomes read letter (if the program shows the content of a read letter nothing happens). In one click he can do any of the following operations: Move from the list of letters to the content of any single letter. Return to the list of letters from single letter viewing mode. In single letter viewing mode, move to the next or to the previous letter in the list. You cannot move from the first letter to the previous one or from the last letter to the next one.The program cannot delete the letters from the list or rearrange them.Alexey wants to read all the unread letters and go watch football. Now he is viewing the list of all letters and for each letter he can see if it is read or unread. What minimum number of operations does Alexey need to perform to read all unread letters?" 1000
465A "inc ARG" implementation "Sergey is testing a next-generation processor. Instead of bytes the processor works with memory cells consisting of n bits. These bits are numbered from 1 to n. An integer is stored in the cell in the following way: the least significant bit is stored in the first bit of the cell, the next significant bit is stored in the second bit, and so on; the most significant bit is stored in the n-th bit.Now Sergey wants to test the following instruction: ""add 1 to the value of the cell"". As a result of the instruction, the integer that is written in the cell must be increased by one; if some of the most significant bits of the resulting number do not fit into the cell, they must be discarded.Sergey wrote certain values \xe2\x80\x8b\xe2\x80\x8bof the bits in the cell and is going to add one to its value. How many bits of the cell will change after the operation?" 900
464E "The Classic Problem" "data structures,graphs,shortest paths" "You are given a weighted undirected graph on n vertices and m edges. Find the shortest path from vertex s to vertex t or else state that such path doesn\'t exist." 3000
464D "World of Darkraft - 2" dp,probabilities "Roma found a new character in the game ""World of Darkraft - 2"". In this game the character fights monsters, finds the more and more advanced stuff that lets him fight stronger monsters.The character can equip himself with k distinct types of items. Power of each item depends on its level (positive integer number). Initially the character has one 1-level item of each of the k types.After the victory over the monster the character finds exactly one new randomly generated item. The generation process looks as follows. Firstly the type of the item is defined; each of the k types has the same probability. Then the level of the new item is defined. Let\'s assume that the level of player\'s item of the chosen type is equal to t at the moment. Level of the new item will be chosen uniformly among integers from segment [1; t\xe2\x80\x89+\xe2\x80\x891].From the new item and the current player\'s item of the same type Roma chooses the best one (i.e. the one with greater level) and equips it (if both of them has the same level Roma choses any). The remaining item is sold for coins. Roma sells an item of level x of any type for x coins.Help Roma determine the expected number of earned coins after the victory over n monsters." 2700
464C "Substitutes in Number" dp "Andrew and Eugene are playing a game. Initially, Andrew has string s, consisting of digits. Eugene sends Andrew multiple queries of type ""di\xe2\x80\x89\xe2\x86\x92\xe2\x80\x89ti"", that means ""replace all digits di in string s with substrings equal to ti"". For example, if s\xe2\x80\x89=\xe2\x80\x89123123, then query ""2\xe2\x80\x89\xe2\x86\x92\xe2\x80\x8900"" transforms s to 10031003, and query ""3\xe2\x80\x89\xe2\x86\x92\xe2\x80\x89"" (""replace 3 by an empty string"") transforms it to s\xe2\x80\x89=\xe2\x80\x891212. After all the queries Eugene asks Andrew to find the remainder after division of number with decimal representation equal to s by 1000000007 (109\xe2\x80\x89+\xe2\x80\x897). When you represent s as a decimal number, please ignore the leading zeroes; also if s is an empty string, then it\'s assumed that the number equals to zero.Andrew got tired of processing Eugene\'s requests manually and he asked you to write a program for that. Help him!" 2100
464B "Restore Cube" "brute force,geometry" "Peter had a cube with non-zero length of a side. He put the cube into three-dimensional space in such a way that its vertices lay at integer points (it is possible that the cube\'s sides are not parallel to the coordinate axes). Then he took a piece of paper and wrote down eight lines, each containing three integers \xe2\x80\x94 coordinates of cube\'s vertex (a single line contains coordinates of a single vertex, each vertex is written exactly once), put the paper on the table and left. While Peter was away, his little brother Nick decided to play with the numbers on the paper. In one operation Nick could swap some numbers inside a single line (Nick didn\'t swap numbers from distinct lines). Nick could have performed any number of such operations.When Peter returned and found out about Nick\'s mischief, he started recollecting the original coordinates. Help Peter restore the original position of the points or else state that this is impossible and the numbers were initially recorded incorrectly." 2000
464A "No to Palindromes!" greedy,strings "Paul hates palindromes. He assumes that string s is tolerable if each its character is one of the first p letters of the English alphabet and s doesn\'t contain any palindrome contiguous substring of length 2 or more.Paul has found a tolerable string s of length n. Help him find the lexicographically next tolerable string of the same length or else state that such string does not exist." 1700
463E "Caisa and Tree" "brute force,dfs and similar,math,number theory,trees" "Caisa is now at home and his son has a simple task for him.Given a rooted tree with n vertices, numbered from 1 to n (vertex 1 is the root). Each vertex of the tree has a value. You should answer q queries. Each query is one of the following:  Format of the query is ""1 v"". Let\'s write out the sequence of vertices along the path from the root to vertex v: u1,\xe2\x80\x89u2,\xe2\x80\x89...,\xe2\x80\x89uk (u1\xe2\x80\x89=\xe2\x80\x891; uk\xe2\x80\x89=\xe2\x80\x89v). You need to output such a vertex ui that gcd(value of ui,\xe2\x80\x89value of v)\xe2\x80\x89>\xe2\x80\x891 and i\xe2\x80\x89<\xe2\x80\x89k. If there are several possible vertices ui pick the one with maximum value of i. If there is no such vertex output -1.  Format of the query is ""2 v w"". You must change the value of vertex v to w. You are given all the queries, help Caisa to solve the problem." 2100
463D "Gargari and Permutations" "dfs and similar,dp,graphs,implementation" "Gargari got bored to play with the bishops and now, after solving the problem about them, he is trying to do math homework. In a math book he have found k permutations. Each of them consists of numbers 1,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89n in some order. Now he should find the length of the longest common subsequence of these permutations. Can you help Gargari?You can read about longest common subsequence there: https://en.wikipedia.org/wiki/Longest_common_subsequence_problem" 1900
463C "Gargari and Bishops" greedy,hashing,implementation "Gargari is jealous that his friend Caisa won the game from the previous problem. He wants to prove that he is a genius.He has a n\xe2\x80\x89\xc3\x97\xe2\x80\x89n chessboard. Each cell of the chessboard has a number written on it. Gargari wants to place two bishops on the chessboard in such a way that there is no cell that is attacked by both of them. Consider a cell with number x written on it, if this cell is attacked by one of the bishops Gargari will get x dollars for it. Tell Gargari, how to place bishops on the chessboard to get maximum amount of money.We assume a cell is attacked by a bishop, if the cell is located on the same diagonal with the bishop (the cell, where the bishop is, also considered attacked by it)." 1900
463B "Caisa and Pylons" "brute force,implementation,math" "Caisa solved the problem with the sugar and now he is on the way back to home. Caisa is playing a mobile game during his path. There are (n\xe2\x80\x89+\xe2\x80\x891) pylons numbered from 0 to n in this game. The pylon with number 0 has zero height, the pylon with number i (i\xe2\x80\x89>\xe2\x80\x890) has height hi. The goal of the game is to reach n-th pylon, and the only move the player can do is to jump from the current pylon (let\'s denote its number as k) to the next one (its number will be k\xe2\x80\x89+\xe2\x80\x891). When the player have made such a move, its energy increases by hk\xe2\x80\x89-\xe2\x80\x89hk\xe2\x80\x89+\xe2\x80\x891 (if this value is negative the player loses energy). The player must have non-negative amount of energy at any moment of the time. Initially Caisa stand at 0 pylon and has 0 energy. The game provides a special opportunity: one can pay a single dollar and increase the height of anyone pylon by one. Caisa may use that opportunity several times, but he doesn\'t want to spend too much money. What is the minimal amount of money he must paid to reach the goal of the game?" 1100
463A "Caisa and Sugar" "brute force,implementation" "Caisa is going to have a party and he needs to buy the ingredients for a big chocolate cake. For that he is going to the biggest supermarket in town.Unfortunately, he has just s dollars for sugar. But that\'s not a reason to be sad, because there are n types of sugar in the supermarket, maybe he able to buy one. But that\'s not all. The supermarket has very unusual exchange politics: instead of cents the sellers give sweets to a buyer as a change. Of course, the number of given sweets always doesn\'t exceed 99, because each seller maximizes the number of dollars in the change (100 cents can be replaced with a dollar).Caisa wants to buy only one type of sugar, also he wants to maximize the number of sweets in the change. What is the maximum number of sweets he can get? Note, that Caisa doesn\'t want to minimize the cost of the sugar, he only wants to get maximum number of sweets as change." 1200
462B "Appleman and Card Game" greedy "Appleman has n cards. Each card has an uppercase letter written on it. Toastman must choose k cards from Appleman\'s cards. Then Appleman should give Toastman some coins depending on the chosen cards. Formally, for each Toastman\'s card i you should calculate how much Toastman\'s cards have the letter equal to letter on ith, then sum up all these quantities, such a number of coins Appleman should give to Toastman.Given the description of Appleman\'s cards. What is the maximum number of coins Toastman can get?" 1300
462A "Appleman and Easy Task" "brute force,implementation" "Toastman came up with a very easy task. He gives it to Appleman, but Appleman doesn\'t know how to solve it. Can you help him?Given a n\xe2\x80\x89\xc3\x97\xe2\x80\x89n checkerboard. Each cell of the board has either character \'x\', or character \'o\'. Is it true that each cell of the board has even number of adjacent cells with \'o\'? Two cells of the board are adjacent if they share a side." 1000
461E "Appleman and a Game" "binary search,shortest paths,strings" "Appleman and Toastman like games. Today they play a game with strings with the following rules. Firstly Toastman tells Appleman two strings s and t both consisting only of letters \'A\', \'B\', \'C\', \'D\'. Then Appleman must build string s as quickly as possible. Initially he has empty string, and in one second he can append to end of the current string any contiguous substring of t.Now, Toastman and Appleman are beginning to play the game. Toastman has already told string t to Appleman, but he hasn\'t come up with string s yet. Toastman only thinks, that he should choose string s consisting of n characters. Of course, he wants to find the worst string for Appleman (such string, that Appleman will spend as much time as possible during the game). Tell Toastman, how much time will Appleman spend during the game if Toastman finds the worst string for him. You can assume that Appleman plays optimally, therefore he builds any string s in minimal possible time." 3000
461D "Appleman and Complicated Task" dsu,math "Toastman came up with a very complicated task. He gives it to Appleman, but Appleman doesn\'t know how to solve it. Can you help him?Given a n\xe2\x80\x89\xc3\x97\xe2\x80\x89n checkerboard. Each cell of the board has either character \'x\', or character \'o\', or nothing. How many ways to fill all the empty cells with \'x\' or \'o\' (each cell must contain only one character in the end) are there, such that for each cell the number of adjacent cells with \'o\' will be even? Find the number of ways modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897). Two cells of the board are adjacent if they share a side." 2800
461C "Appleman and a Sheet of Paper" "data structures,implementation" "Appleman has a very big sheet of paper. This sheet has a form of rectangle with dimensions 1\xe2\x80\x89\xc3\x97\xe2\x80\x89n. Your task is help Appleman with folding of such a sheet. Actually, you need to perform q queries. Each query will have one of the following types:  Fold the sheet of paper at position pi. After this query the leftmost part of the paper with dimensions 1\xe2\x80\x89\xc3\x97\xe2\x80\x89pi must be above the rightmost part of the paper with dimensions 1\xe2\x80\x89\xc3\x97\xe2\x80\x89([current width of sheet]\xe2\x80\x89-\xe2\x80\x89pi).  Count what is the total width of the paper pieces, if we will make two described later cuts and consider only the pieces between the cuts. We will make one cut at distance li from the left border of the current sheet of paper and the other at distance ri from the left border of the current sheet of paper. Please look at the explanation of the first test example for better understanding of the problem." 2200
461B "Appleman and Tree" "dfs and similar,dp,trees" "Appleman has a tree with n vertices. Some of the vertices (at least one) are colored black and other vertices are colored white.Consider a set consisting of k (0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k\xe2\x80\x89<\xe2\x80\x89n) edges of Appleman\'s tree. If Appleman deletes these edges from the tree, then it will split into (k\xe2\x80\x89+\xe2\x80\x891) parts. Note, that each part will be a tree with colored vertices.Now Appleman wonders, what is the number of sets splitting the tree in such a way that each resulting part will have exactly one black vertex? Find this number modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." 2000
461A "Appleman and Toastman" greedy,sortings "Appleman and Toastman play a game. Initially Appleman gives one group of n numbers to the Toastman, then they start to complete the following tasks:  Each time Toastman gets a group of numbers, he sums up all the numbers and adds this sum to the score. Then he gives the group to the Appleman.  Each time Appleman gets a group consisting of a single number, he throws this group out. Each time Appleman gets a group consisting of more than one number, he splits the group into two non-empty groups (he can do it in any way) and gives each of them to Toastman. After guys complete all the tasks they look at the score value. What is the maximum possible value of score they can get?" 1200
460E "Roland and Rose" "brute force,geometry,math,sortings" "Roland loves growing flowers. He has recently grown a beautiful rose at point (0,\xe2\x80\x890) of the Cartesian coordinate system. The rose is so beautiful that Roland is afraid that the evil forces can try and steal it. To protect the rose, Roland wants to build n watch towers. Let\'s assume that a tower is a point on the plane at the distance of at most r from the rose. Besides, Roland assumes that the towers should be built at points with integer coordinates and the sum of squares of distances between all pairs of towers must be as large as possible. Note, that Roland may build several towers at the same point, also he may build some of them at point (0,\xe2\x80\x890).Help Roland build the towers at the integer points so that the sum of squares of distances between all towers is maximum possible. Note that the distance in this problem is defined as the Euclidian distance between points." 2700
460D "Little Victor and Set" "brute force,constructive algorithms,math" "Little Victor adores the sets theory. Let us remind you that a set is a group of numbers where all numbers are pairwise distinct. Today Victor wants to find a set of integers S that has the following properties:  for all x  the following inequality holds l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r;  1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|S|\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k;  lets denote the i-th element of the set S as si; value  must be as small as possible. Help Victor find the described set." 2300
460C Present "binary search,data structures,greedy" "Little beaver is a beginner programmer, so informatics is his favorite subject. Soon his informatics teacher is going to have a birthday and the beaver has decided to prepare a present for her. He planted n flowers in a row on his windowsill and started waiting for them to grow. However, after some time the beaver noticed that the flowers stopped growing. The beaver thinks it is bad manners to present little flowers. So he decided to come up with some solutions. There are m days left to the birthday. The height of the i-th flower (assume that the flowers in the row are numbered from 1 to n from left to right) is equal to ai at the moment. At each of the remaining m days the beaver can take a special watering and water w contiguous flowers (he can do that only once at a day). At that each watered flower grows by one height unit on that day. The beaver wants the height of the smallest flower be as large as possible in the end. What maximum height of the smallest flower can he get?" 1700
460B "Little Dima and Equation" "brute force,implementation,math,number theory" "Little Dima misbehaved during a math lesson a lot and the nasty teacher Mr. Pickles gave him the following problem as a punishment. Find all integer solutions x (0\xe2\x80\x89<\xe2\x80\x89x\xe2\x80\x89<\xe2\x80\x89109) of the equation:x\xe2\x80\x89=\xe2\x80\x89b\xc2\xb7s(x)a\xe2\x80\x89+\xe2\x80\x89c,\xe2\x80\x89 where a, b, c are some predetermined constant values and function s(x) determines the sum of all digits in the decimal representation of number x.The teacher gives this problem to Dima for each lesson. He changes only the parameters of the equation: a, b, c. Dima got sick of getting bad marks and he asks you to help him solve this challenging problem." 1500
460A "Vasya and Socks" "brute force,implementation,math" "Vasya has n pairs of socks. In the morning of each day Vasya has to put on a pair of socks before he goes to school. When he comes home in the evening, Vasya takes off the used socks and throws them away. Every m-th day (at days with numbers m,\xe2\x80\x892m,\xe2\x80\x893m,\xe2\x80\x89...) mom buys a pair of socks to Vasya. She does it late in the evening, so that Vasya cannot put on a new pair of socks before the next day. How many consecutive days pass until Vasya runs out of socks?" 900
459E "Pashmak and Graph" dp,sortings "Pashmak\'s homework is a problem about graphs. Although he always tries to do his homework completely, he can\'t solve this problem. As you know, he\'s really weak at graph theory; so try to help him in solving the problem.You are given a weighted directed graph with n vertices and m edges. You need to find a path (perhaps, non-simple) with maximum number of edges, such that the weights of the edges increase along the path. In other words, each edge of the path must have strictly greater weight than the previous edge in the path.Help Pashmak, print the number of edges in the required path." 1900
459D "Pashmak and Parmida\'s problem" "data structures,divide and conquer,sortings" "Parmida is a clever girl and she wants to participate in Olympiads this year. Of course she wants her partner to be clever too (although he\'s not)! Parmida has prepared the following test problem for Pashmak.There is a sequence a that consists of n integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. Let\'s denote f(l,\xe2\x80\x89r,\xe2\x80\x89x) the number of indices k such that: l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r and ak\xe2\x80\x89=\xe2\x80\x89x. His task is to calculate the number of pairs of indicies i,\xe2\x80\x89j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) such that f(1,\xe2\x80\x89i,\xe2\x80\x89ai)\xe2\x80\x89>\xe2\x80\x89f(j,\xe2\x80\x89n,\xe2\x80\x89aj).Help Pashmak with the test." 1800
459C "Pashmak and Buses" "combinatorics,constructive algorithms,math" "Recently Pashmak has been employed in a transportation company. The company has k buses and has a contract with a school which has n students. The school planned to take the students to d different places for d days (each day in one place). Each day the company provides all the buses for the trip. Pashmak has to arrange the students in the buses. He wants to arrange the students in a way that no two students become close friends. In his ridiculous idea, two students will become close friends if and only if they are in the same buses for all d days.Please help Pashmak with his weird idea. Assume that each bus has an unlimited capacity." 1900
459B "Pashmak and Flowers" combinatorics,implementation,sortings "Pashmak decided to give Parmida a pair of flowers from the garden. There are n flowers in the garden and the i-th of them has a beauty number bi. Parmida is a very strange girl so she doesn\'t want to have the two most beautiful flowers necessarily. She wants to have those pairs of flowers that their beauty difference is maximal possible!Your task is to write a program which calculates two things:  The maximum beauty difference of flowers that Pashmak can give to Parmida.  The number of ways that Pashmak can pick the flowers. Two ways are considered different if and only if there is at least one flower that is chosen in the first way and not chosen in the second way." 1300
459A "Pashmak and Garden" implementation "Pashmak has fallen in love with an attractive girl called Parmida since one year ago...Today, Pashmak set up a meeting with his partner in a romantic garden. Unfortunately, Pashmak has forgotten where the garden is. But he remembers that the garden looks like a square with sides parallel to the coordinate axes. He also remembers that there is exactly one tree on each vertex of the square. Now, Pashmak knows the position of only two of the trees. Help him to find the position of two remaining ones." 1200
457F "An easy problem about trees" dp,games,greedy,trees "Pieguy and Piegirl are playing a game. They have a rooted binary tree, that has a property that each node is either a leaf or has exactly two children. Each leaf has a number associated with it.On his/her turn a player can choose any two leafs that share their immediate parent, remove them, and associate either of their values with their parent, that now became a leaf (the player decides which of the two values to associate). The game ends when only one node (the one that was the root of the tree) is left.Pieguy goes first, and his goal is to maximize the value that will be associated with the root when the game ends. Piegirl wants to minimize that value. Assuming that both players are playing optimally, what number will be associated with the root when the game ends?" 3200
457E "Flow Optimality" "constructive algorithms,flows,math" "There is a computer network consisting of n nodes numbered 1 through n. There are links in the network that connect pairs of nodes. A pair of nodes may have multiple links between them, but no node has a link to itself.Each link supports unlimited bandwidth (in either direction), however a link may only transmit in a single direction at any given time. The cost of sending data across a link is proportional to the square of the bandwidth. Specifically, each link has a positive weight, and the cost of sending data across the link is the weight times the square of the bandwidth.The network is connected (there is a series of links from any node to any other node), and furthermore designed to remain connected in the event of any single node failure.You needed to send data from node 1 to node n at a bandwidth of some positive number k. That is, you wish to assign a bandwidth to each link so that the bandwidth into a node minus the bandwidth out of a node is \xe2\x80\x89-\xe2\x80\x89k for node 1, k for node n, and 0 for all other nodes. The individual bandwidths do not need to be integers.Wishing to minimize the total cost, you drew a diagram of the network, then gave the task to an intern to solve. The intern claimed to have solved the task and written the optimal bandwidths on your diagram, but then spilled coffee on it, rendering much of it unreadable (including parts of the original diagram, and the value of k).From the information available, determine if the intern\'s solution may have been optimal. That is, determine if there exists a valid network, total bandwidth, and optimal solution which is a superset of the given information. Furthermore, determine the efficiency of the intern\'s solution (if possible), where efficiency is defined as total cost divided by total bandwidth." 3000
457D Bingo! combinatorics,math,probabilities "The game of bingo is played on a 5\xe2\x80\x89\xc3\x97\xe2\x80\x895 square grid filled with distinct numbers between 1 and 75. In this problem you will consider a generalized version played on an n\xe2\x80\x89\xc3\x97\xe2\x80\x89n grid with distinct numbers between 1 and m (m\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89n2). A player begins by selecting a randomly generated bingo grid (generated uniformly among all available grids). Then k distinct numbers between 1 and m will be called at random (called uniformly among all available sets of k numbers). For each called number that appears on the grid, the player marks that cell. The score at the end is 2 raised to the power of (number of completely marked rows plus number of completely marked columns).Determine the expected value of the score. The expected score may be very large. If the expected score is larger than 1099, print 1099 instead (for example as ""1e99"" without the quotes)." 2700
457C Elections "brute force" "You are running for a governor in a small city in Russia. You ran some polls and did some research, and for every person in the city you know whom he will vote for, and how much it will cost to bribe that person to vote for you instead of whomever he wants to vote for right now. You are curious, what is the smallest amount of money you need to spend on bribing to win the elections. To win elections you need to have strictly more votes than any other candidate." 2100
457B "Distributed Join" greedy "Piegirl was asked to implement two table join operation for distributed database system, minimizing the network traffic.Suppose she wants to join two tables, A and B. Each of them has certain number of rows which are distributed on different number of partitions. Table A is distributed on the first cluster consisting of m partitions. Partition with index i has ai rows from A. Similarly, second cluster containing table B has n partitions, i-th one having bi rows from B. In one network operation she can copy one row from any partition to any other partition. At the end, for each row from A and each row from B there should be a partition that has both rows. Determine the minimal number of network operations to achieve this." 1900
457A "Golden System" math,meet-in-the-middle "Piegirl got bored with binary, decimal and other integer based counting systems. Recently she discovered some interesting properties about number , in particular that q2\xe2\x80\x89=\xe2\x80\x89q\xe2\x80\x89+\xe2\x80\x891, and she thinks it would make a good base for her new unique system. She called it ""golden system"". In golden system the number is a non-empty string containing 0\'s and 1\'s as digits. The decimal value of expression a0a1...an equals to .Soon Piegirl found out that this system doesn\'t have same properties that integer base systems do and some operations can not be performed on it. She wasn\'t able to come up with a fast way of comparing two numbers. She is asking for your help.Given two numbers written in golden system notation, determine which of them has larger decimal value." 1700
456B "Fedya and Maths" "math,number theory" "Fedya studies in a gymnasium. Fedya\'s maths hometask is to calculate the following expression:(1n\xe2\x80\x89+\xe2\x80\x892n\xe2\x80\x89+\xe2\x80\x893n\xe2\x80\x89+\xe2\x80\x894n) mod 5for given value of n. Fedya managed to complete the task. Can you? Note that given number n can be extremely large (e.g. it can exceed any integer type of your programming language)." 1200
456A Laptops sortings "One day Dima and Alex had an argument about the price and quality of laptops. Dima thinks that the more expensive a laptop is, the better it is. Alex disagrees. Alex thinks that there are two laptops, such that the price of the first laptop is less (strictly smaller) than the price of the second laptop but the quality of the first laptop is higher (strictly greater) than the quality of the second laptop.Please, check the guess of Alex. You are given descriptions of n laptops. Determine whether two described above laptops exist." 1100
455E Function "data structures" "Serega and Fedor play with functions. One day they came across a very interesting function. It looks like that:  f(1,\xe2\x80\x89j)\xe2\x80\x89=\xe2\x80\x89a[j], 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n.  f(i,\xe2\x80\x89j)\xe2\x80\x89=\xe2\x80\x89min(f(i\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89j),\xe2\x80\x89f(i\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89j\xe2\x80\x89-\xe2\x80\x891))\xe2\x80\x89+\xe2\x80\x89a[j], 2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n, i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n. Here a is an integer array of length n.Serega and Fedya want to know what values this function takes at some points. But they don\'t want to calculate the values manually. So they ask you to help them." 2900
455D "Serega and Fun" "data structures" "Serega loves fun. However, everyone has fun in the unique manner. Serega has fun by solving query problems. One day Fedor came up with such a problem.You are given an array a consisting of n positive integers and queries to it. The queries can be of two types:  Make a unit cyclic shift to the right on the segment from l to r (both borders inclusive). That is rearrange elements of the array in the following manner:a[l],\xe2\x80\x89a[l\xe2\x80\x89+\xe2\x80\x891],\xe2\x80\x89...,\xe2\x80\x89a[r\xe2\x80\x89-\xe2\x80\x891],\xe2\x80\x89a[r]\xe2\x80\x89\xe2\x86\x92\xe2\x80\x89a[r],\xe2\x80\x89a[l],\xe2\x80\x89a[l\xe2\x80\x89+\xe2\x80\x891],\xe2\x80\x89...,\xe2\x80\x89a[r\xe2\x80\x89-\xe2\x80\x891]. Count how many numbers equal to k are on the segment from l to r (both borders inclusive). Fedor hurried to see Serega enjoy the problem and Serega solved it really quickly. Let\'s see, can you solve it?" 2700
455C Civilization "dfs and similar,dp,dsu,ternary search,trees" "Andrew plays a game called ""Civilization"". Dima helps him.The game has n cities and m bidirectional roads. The cities are numbered from 1 to n. Between any pair of cities there either is a single (unique) path, or there is no path at all. A path is such a sequence of distinct cities v1,\xe2\x80\x89v2,\xe2\x80\x89...,\xe2\x80\x89vk, that there is a road between any contiguous cities vi and vi\xe2\x80\x89+\xe2\x80\x891 (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89k). The length of the described path equals to (k\xe2\x80\x89-\xe2\x80\x891). We assume that two cities lie in the same region if and only if, there is a path connecting these two cities.During the game events of two types take place:  Andrew asks Dima about the length of the longest path in the region where city x lies.  Andrew asks Dima to merge the region where city x lies with the region where city y lies. If the cities lie in the same region, then no merging is needed. Otherwise, you need to merge the regions as follows: choose a city from the first region, a city from the second region and connect them by a road so as to minimize the length of the longest path in the resulting region. If there are multiple ways to do so, you are allowed to choose any of them. Dima finds it hard to execute Andrew\'s queries, so he asks you to help him. Help Dima." 2100
455B "A Lot of Games" "dfs and similar,dp,games,implementation,strings,trees" "Andrew, Fedor and Alex are inventive guys. Now they invent the game with strings for two players.Given a group of n non-empty strings. During the game two players build the word together, initially the word is empty. The players move in turns. On his step player must add a single letter in the end of the word, the resulting word must be prefix of at least one string from the group. A player loses if he cannot move.Andrew and Alex decided to play this game k times. The player who is the loser of the i-th game makes the first move in the (i\xe2\x80\x89+\xe2\x80\x891)-th game. Guys decided that the winner of all games is the player who wins the last (k-th) game. Andrew and Alex already started the game. Fedor wants to know who wins the game if both players will play optimally. Help him." 1900
455A Boredom dp "Alex doesn\'t like boredom. That\'s why whenever he gets bored, he comes up with games. One long winter evening he came up with a game and decided to play it.Given a sequence a consisting of n integers. The player can make several steps. In a single step he can choose an element of the sequence (let\'s denote it ak) and delete it, at that all elements equal to ak\xe2\x80\x89+\xe2\x80\x891 and ak\xe2\x80\x89-\xe2\x80\x891 also must be deleted from the sequence. That step brings ak points to the player. Alex is a perfectionist, so he decided to get as many points as possible. Help him." 1500
454B "Little Pony and Sort by Shift" implementation "One day, Twilight Sparkle is interested in how to sort a sequence of integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an in non-decreasing order. Being a young unicorn, the only operation she can perform is a unit shift. That is, she can move the last element of the sequence to its beginning:a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an\xe2\x80\x89\xe2\x86\x92\xe2\x80\x89an,\xe2\x80\x89a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an\xe2\x80\x89-\xe2\x80\x891. Help Twilight Sparkle to calculate: what is the minimum number of operations that she needs to sort the sequence?" 1200
454A "Little Pony and Crystal Mine" implementation "Twilight Sparkle once got a crystal from the Crystal Mine. A crystal of size n (n is odd; n\xe2\x80\x89>\xe2\x80\x891) is an n\xe2\x80\x89\xc3\x97\xe2\x80\x89n matrix with a diamond inscribed into it.You are given an odd integer n. You need to draw a crystal of size n. The diamond cells of the matrix should be represented by character ""D"". All other cells of the matrix should be represented by character ""*"". Look at the examples to understand what you need to draw." 800
453E "Little Pony and Lord Tirek" "data structures" "Lord Tirek is a centaur and the main antagonist in the season four finale episodes in the series ""My Little Pony: Friendship Is Magic"". In ""Twilight\'s Kingdom"" (Part 1), Tirek escapes from Tartarus and drains magic from ponies to grow stronger.  The core skill of Tirek is called Absorb Mana. It takes all mana from a magic creature and gives them to the caster.Now to simplify the problem, assume you have n ponies (numbered from 1 to n). Each pony has three attributes:  si : amount of mana that the pony has at time 0;  mi : maximum mana that the pony can have;  ri : mana regeneration per unit time. Lord Tirek will do m instructions, each of them can be described with three integers: ti,\xe2\x80\x89li,\xe2\x80\x89ri. The instruction means that at time ti, Tirek will use Absorb Mana on ponies with numbers from li to ri (both borders inclusive). We\'ll give you all the m instructions in order, count how much mana Tirek absorbs for each instruction." 3100
453D "Little Pony and Elements of Harmony" dp,matrices "The Elements of Harmony are six supernatural artifacts representing subjective aspects of harmony. They are arguably the most powerful force in Equestria. The inside of Elements of Harmony can be seen as a complete graph with n vertices labeled from 0 to n\xe2\x80\x89-\xe2\x80\x891, where n is a power of two, equal to 2m.  The energy in Elements of Harmony is in constant movement. According to the ancient book, the energy of vertex u in time i (ei[u]) equals to: Here b[] is the transformation coefficient \xe2\x80\x94 an array of m\xe2\x80\x89+\xe2\x80\x891 integers and f(u,\xe2\x80\x89v) is the number of ones in the binary representation of number (u xor v).Given the transformation coefficient and the energy distribution at time 0 (e0[]). Help Twilight Sparkle predict the energy distribution at time t (et[]). The answer can be quite large, so output it modulo p." 3000
453C "Little Pony and Summer Sun Celebration" "constructive algorithms,dfs and similar,graphs" "Twilight Sparkle learnt that the evil Nightmare Moon would return during the upcoming Summer Sun Celebration after one thousand years of imprisonment on the moon. She tried to warn her mentor Princess Celestia, but the princess ignored her and sent her to Ponyville to check on the preparations for the celebration.  Twilight Sparkle wanted to track the path of Nightmare Moon. Unfortunately, she didn\'t know the exact path. What she knew is the parity of the number of times that each place Nightmare Moon visited. Can you help Twilight Sparkle to restore any path that is consistent with this information?Ponyville can be represented as an undirected graph (vertices are places, edges are roads between places) without self-loops and multi-edges. The path can start and end at any place (also it can be empty). Each place can be visited multiple times. The path must not visit more than 4n places." 2200
453B "Little Pony and Harmony Chest" "bitmasks,brute force,dp" "Princess Twilight went to Celestia and Luna\'s old castle to research the chest from the Elements of Harmony.  A sequence of positive integers bi is harmony if and only if for every two elements of the sequence their greatest common divisor equals 1. According to an ancient book, the key of the chest is a harmony sequence bi which minimizes the following expression:You are given sequence ai, help Princess Twilight to find the key." 2000
453A "Little Pony and Expected Maximum" probabilities "Twilight Sparkle was playing Ludo with her friends Rainbow Dash, Apple Jack and Flutter Shy. But she kept losing. Having returned to the castle, Twilight Sparkle became interested in the dice that were used in the game.The dice has m faces: the first face of the dice contains a dot, the second one contains two dots, and so on, the m-th face contains m dots. Twilight Sparkle is sure that when the dice is tossed, each face appears with probability . Also she knows that each toss is independent from others. Help her to calculate the expected maximum number of dots she could get after tossing the dice n times." 1600
452F Permutation "data structures,divide and conquer,hashing" "You are given a permutation of numbers from 1 to n. Determine whether there\'s a pair of integers a,\xe2\x80\x89b (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a,\xe2\x80\x89b\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n; a\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89b) such that the element  (note, that it is usual division, not integer one) is between a and b in this permutation." 2700
452E "Three strings" "data structures,dsu,string suffix structures,strings" "You are given three strings (s1,\xe2\x80\x89s2,\xe2\x80\x89s3). For each integer l (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89min(|s1|,\xe2\x80\x89|s2|,\xe2\x80\x89|s3|) you need to find how many triples (i1,\xe2\x80\x89i2,\xe2\x80\x89i3) exist such that three strings sk[ik... ik\xe2\x80\x89+\xe2\x80\x89l\xe2\x80\x89-\xe2\x80\x891] (k\xe2\x80\x89=\xe2\x80\x891,\xe2\x80\x892,\xe2\x80\x893) are pairwise equal. Print all found numbers modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897).See notes if you are not sure about some of the denotions used in the statement." 2400
452D "Washer, Dryer, Folder" greedy,implementation "You have k pieces of laundry, each of which you want to wash, dry and fold. You are at a laundromat that has n1 washing machines, n2 drying machines and n3 folding machines. Each machine can process only one piece of laundry at a time. You can\'t dry a piece of laundry before it is washed, and you can\'t fold it before it is dried. Moreover, after a piece of laundry is washed, it needs to be immediately moved into a drying machine, and after it is dried, it needs to be immediately moved into a folding machine.It takes t1 minutes to wash one piece of laundry in a washing machine, t2 minutes to dry it in a drying machine, and t3 minutes to fold it in a folding machine. Find the smallest number of minutes that is enough to wash, dry and fold all the laundry you have." 1900
452C "Magic Trick" combinatorics,math,probabilities "Alex enjoys performing magic tricks. He has a trick that requires a deck of n cards. He has m identical decks of n different cards each, which have been mixed together. When Alex wishes to perform the trick, he grabs n cards at random and performs the trick with those. The resulting deck looks like a normal deck, but may have duplicates of some cards.The trick itself is performed as follows: first Alex allows you to choose a random card from the deck. You memorize the card and put it back in the deck. Then Alex shuffles the deck, and pulls out a card. If the card matches the one you memorized, the trick is successful.You don\'t think Alex is a very good magician, and that he just pulls a card randomly from the deck. Determine the probability of the trick being successful if this is the case." 2100
452B "4-point polyline" "brute force,constructive algorithms,geometry,trees" "You are given a rectangular grid of lattice points from (0,\xe2\x80\x890) to (n,\xe2\x80\x89m) inclusive. You have to choose exactly 4 different points to build a polyline possibly with self-intersections and self-touching. This polyline should be as long as possible.A polyline defined by points p1,\xe2\x80\x89p2,\xe2\x80\x89p3,\xe2\x80\x89p4 consists of the line segments p1\xe2\x80\x89p2,\xe2\x80\x89p2\xe2\x80\x89p3,\xe2\x80\x89p3\xe2\x80\x89p4, and its length is the sum of the lengths of the individual line segments." 1800
452A Eevee "brute force,implementation,strings" "You are solving the crossword problem K from IPSC 2014. You solved all the clues except for one: who does Eevee evolve into? You are not very into pokemons, but quick googling helped you find out, that Eevee can evolve into eight different pokemons: Vaporeon, Jolteon, Flareon, Espeon, Umbreon, Leafeon, Glaceon, and Sylveon.You know the length of the word in the crossword, and you already know some letters. Designers of the crossword made sure that the answer is unambiguous, so you can assume that exactly one pokemon out of the 8 that Eevee evolves into fits the length and the letters given. Your task is to find it." 1000
451E "Devu and Flowers" "bitmasks,combinatorics,number theory" "Devu wants to decorate his garden with flowers. He has purchased n boxes, where the i-th box contains fi flowers. All flowers in a single box are of the same color (hence they are indistinguishable). Also, no two boxes have flowers of the same color.Now Devu wants to select exactly s flowers from the boxes to decorate his garden. Devu would like to know, in how many different ways can he select the flowers from each box? Since this number may be very large, he asks you to find the number modulo (109\xe2\x80\x89+\xe2\x80\x897). Devu considers two ways different if there is at least one box from which different number of flowers are selected in these two ways." 2300
451D "Count Good Substrings" math "We call a string good, if after merging all the consecutive equal characters, the resulting string is palindrome. For example, ""aabba"" is good, because after the merging step it will become ""aba"".Given a string, you have to find two values:  the number of good substrings of even length;  the number of good substrings of odd length." 2000
451C "Predict Outcome of the Game" "brute force,implementation,math" "There are n games in a football tournament. Three teams are participating in it. Currently k games had already been played. You are an avid football fan, but recently you missed the whole k games. Fortunately, you remember a guess of your friend for these k games. Your friend did not tell exact number of wins of each team, instead he thought that absolute difference between number of wins of first and second team will be d1 and that of between second and third team will be d2.You don\'t want any of team win the tournament, that is each team should have the same number of wins after n games. That\'s why you want to know: does there exist a valid tournament satisfying the friend\'s guess such that no team will win this tournament?Note that outcome of a match can not be a draw, it has to be either win or loss." 1700
451B "Sort the Array" implementation,sortings "Being a programmer, you like arrays a lot. For your birthday, your friends have given you an array a consisting of n distinct integers.Unfortunately, the size of a is too small. You want a bigger array! Your friends agree to give you a bigger array, but only if you are able to answer the following question correctly: is it possible to sort the array a (in increasing order) by reversing exactly one segment of a? See definitions of segment and reversing in the notes." 1300
451A "Game With Sticks" implementation "After winning gold and silver in IOI 2014, Akshat and Malvika want to have some fun. Now they are playing a game on a grid made of n horizontal and m vertical sticks.An intersection point is any point on the grid which is formed by the intersection of one horizontal stick and one vertical stick.In the grid shown below, n\xe2\x80\x89=\xe2\x80\x893 and m\xe2\x80\x89=\xe2\x80\x893. There are n\xe2\x80\x89+\xe2\x80\x89m\xe2\x80\x89=\xe2\x80\x896 sticks in total (horizontal sticks are shown in red and vertical sticks are shown in green). There are n\xc2\xb7m\xe2\x80\x89=\xe2\x80\x899 intersection points, numbered from 1 to 9.  The rules of the game are very simple. The players move in turns. Akshat won gold, so he makes the first move. During his/her move, a player must choose any remaining intersection point and remove from the grid all sticks which pass through this point. A player will lose the game if he/she cannot make a move (i.e. there are no intersection points remaining on the grid at his/her move).Assume that both players play optimally. Who will win the game?" 900
450B "Jzzhu and Sequences" implementation,math "Jzzhu has invented a kind of sequences, they meet the following property:You are given x and y, please calculate fn modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." 1300
