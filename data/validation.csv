index name statement tags rating
165E "Compatible Numbers" "Two integers x and y are compatible, if the result of their bitwise ""AND"" equals zero, that is, a & b\xe2\x80\x89=\xe2\x80\x890. For example, numbers 90 (10110102) and 36 (1001002) are compatible, as 10110102 & 1001002\xe2\x80\x89=\xe2\x80\x8902, and numbers 3 (112) and 6 (1102) are not compatible, as 112 & 1102\xe2\x80\x89=\xe2\x80\x89102.You are given an array of integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. Your task is to find the following for each array element: is this element compatible with some other element from the given array? If the answer to this question is positive, then you also should find any suitable element." "bitmasks,brute force,dfs and similar,dp" 2200
1552I "Organizing a Music Festival" "You are the organizer of the famous ""Zurich Music Festival"". There will be n singers who will perform at the festival, identified by the integers 1, 2, \xe2\x80\xa6, n. You must choose in which order they are going to perform on stage. You have m friends and each of them has a set of favourite singers. More precisely, for each 1\xe2\x89\xa4i\xe2\x89\xa4m, the i-th friend likes singers si,1,si,2,\xe2\x80\xa6,si,qi.A friend of yours is happy if the singers he likes perform consecutively (in an arbitrary order). An ordering of the singers is valid if it makes all your friends happy.Compute the number of valid orderings modulo 998244353." "dfs and similar,math" 3400
1954D "Colored Balls" "There are balls of n different colors; the number of balls of the i-th color is ai.The balls can be combined into groups. Each group should contain at most 2 balls, and no more than 1 ball of each color.Consider all 2n sets of colors. For a set of colors, let\'s denote its value as the minimum number of groups the balls of those colors can be distributed into. For example, if there are three colors with 3, 1 and 7 balls respectively, they can be combined into 7 groups (and not less than 7), so the value of that set of colors is 7.Your task is to calculate the sum of values over all 2n possible sets of colors. Since the answer may be too large, print it modulo 998244353." combinatorics,dp,math,sortings 1800
514B "Han Solo and Lazer Gun" "There are n Imperial stormtroopers on the field. The battle field is a plane with Cartesian coordinate system. Each stormtrooper is associated with his coordinates (x,\xe2\x80\x89y) on this plane. Han Solo has the newest duplex lazer gun to fight these stormtroopers. It is situated at the point (x0,\xe2\x80\x89y0). In one shot it can can destroy all the stormtroopers, situated on some line that crosses point (x0,\xe2\x80\x89y0).Your task is to determine what minimum number of shots Han Solo needs to defeat all the stormtroopers.The gun is the newest invention, it shoots very quickly and even after a very large number of shots the stormtroopers don\'t have enough time to realize what\'s happening and change their location." "brute force,data structures,geometry,implementation,math" 1400
933C "A Colourful Prospect" "Firecrackers scare Nian the monster, but they\'re wayyyyy too noisy! Maybe fireworks make a nice complement.Little Tommy is watching a firework show. As circular shapes spread across the sky, a splendid view unfolds on the night of Lunar New Year\'s eve.A wonder strikes Tommy. How many regions are formed by the circles on the sky? We consider the sky as a flat plane. A region is a connected part of the plane with positive area, whose bound consists of parts of bounds of the circles and is a curve or several curves without self-intersections, and that does not contain any curve other than its boundaries. Note that exactly one of the regions extends infinitely." geometry,graphs 2700
1284C "New Year and Permutation" "Recall that the permutation is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array) and [1,3,4] is also not a permutation (n=3 but there is 4 in the array).A sequence a is a subsegment of a sequence b if a can be obtained from b by deletion of several (possibly, zero or all) elements from the beginning and several (possibly, zero or all) elements from the end. We will denote the subsegments as [l,r], where l,r are two integers with 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n. This indicates the subsegment where l\xe2\x88\x921 elements from the beginning and n\xe2\x88\x92r elements from the end are deleted from the sequence.For a permutation p1,p2,\xe2\x80\xa6,pn, we define a framed segment as a subsegment [l,r] where max{pl,pl+1,\xe2\x80\xa6,pr}\xe2\x88\x92min{pl,pl+1,\xe2\x80\xa6,pr}=r\xe2\x88\x92l. For example, for the permutation (6,7,1,8,5,3,2,4) some of its framed segments are: [1,2],[5,8],[6,7],[3,3],[8,8]. In particular, a subsegment [i,i] is always a framed segments for any i between 1 and n, inclusive.We define the happiness of a permutation p as the number of pairs (l,r) such that 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n, and [l,r] is a framed segment. For example, the permutation [3,1,2] has happiness 5: all segments except [1,2] are framed segments.Given integers n and m, Jongwon wants to compute the sum of happiness for all permutations of length n, modulo the prime number m. Note that there exist n! (factorial of n) different permutations of length n." combinatorics,math 1600
1355E "Restorer Distance" "You have to restore the wall. The wall consists of N pillars of bricks, the height of the i-th pillar is initially equal to hi, the height is measured in number of bricks. After the restoration all the N pillars should have equal heights.You are allowed the following operations: put a brick on top of one pillar, the cost of this operation is A; remove a brick from the top of one non-empty pillar, the cost of this operation is R; move a brick from the top of one non-empty pillar to the top of another pillar, the cost of this operation is M.You cannot create additional pillars or ignore some of pre-existing pillars even if their height becomes 0.What is the minimal total cost of restoration, in other words, what is the minimal total cost to make all the pillars of equal height?" "binary search,greedy,math,sortings,ternary search" 2100
1841B "Keep it Beautiful" "The array [a1,a2,\xe2\x80\xa6,ak] is called beautiful if it is possible to remove several (maybe zero) elements from the beginning of the array and insert all these elements to the back of the array in the same order in such a way that the resulting array is sorted in non-descending order.In other words, the array [a1,a2,\xe2\x80\xa6,ak] is beautiful if there exists an integer i\xe2\x88\x88[0,k\xe2\x88\x921] such that the array [ai+1,ai+2,\xe2\x80\xa6,ak\xe2\x88\x921,ak,a1,a2,\xe2\x80\xa6,ai] is sorted in non-descending order.For example:  [3,7,7,9,2,3] is beautiful: we can remove four first elements and insert them to the back in the same order, and we get the array [2,3,3,7,7,9], which is sorted in non-descending order;  [1,2,3,4,5] is beautiful: we can remove zero first elements and insert them to the back, and we get the array [1,2,3,4,5], which is sorted in non-descending order;  [5,2,2,1] is not beautiful. Note that any array consisting of zero elements or one element is beautiful.You are given an array a, which is initially empty. You have to process q queries to it. During the i-th query, you will be given one integer xi, and you have to do the following:  if you can append the integer xi to the back of the array a so that the array a stays beautiful, you have to append it;  otherwise, do nothing. After each query, report whether you appended the given integer xi, or not." implementation 1000
630R Game "There is a legend in the IT City college. A student that failed to answer all questions on the game theory exam is given one more chance by his professor. The student has to play a game with the professor.The game is played on a square field consisting of n\xe2\x80\x89\xc3\x97\xe2\x80\x89n cells. Initially all cells are empty. On each turn a player chooses and paint an empty cell that has no common sides with previously painted cells. Adjacent corner of painted cells is allowed. On the next turn another player does the same, then the first one and so on. The player with no cells to paint on his turn loses.The professor have chosen the field size n and allowed the student to choose to be the first or the second player in the game. What should the student choose to win the game? Both players play optimally." games,math 1200
919A Supermarket "We often go to supermarkets to buy some fruits or vegetables, and on the tag there prints the price for a kilo. But in some supermarkets, when asked how much the items are, the clerk will say that a yuan for b kilos (You don\'t need to care about what ""yuan"" is), the same as a/b yuan for a kilo.Now imagine you\'d like to buy m kilos of apples. You\'ve asked n supermarkets and got the prices. Find the minimum cost for those apples.You can assume that there are enough apples in all supermarkets." "brute force,greedy,implementation" 800
486E "LIS of Sequence" "The next ""Data Structures and Algorithms"" lesson will be about Longest Increasing Subsequence (LIS for short) of a sequence. For better understanding, Nam decided to learn it a few days before the lesson.Nam created a sequence a consisting of n (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89105) elements a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ai\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89105). A subsequence ai1,\xe2\x80\x89ai2,\xe2\x80\x89...,\xe2\x80\x89aik where 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i1\xe2\x80\x89<\xe2\x80\x89i2\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89ik\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n is called increasing if ai1\xe2\x80\x89<\xe2\x80\x89ai2\xe2\x80\x89<\xe2\x80\x89ai3\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89aik. An increasing subsequence is called longest if it has maximum length among all increasing subsequences. Nam realizes that a sequence may have several longest increasing subsequences. Hence, he divides all indexes i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n), into three groups: group of all i such that ai belongs to no longest increasing subsequences. group of all i such that ai belongs to at least one but not every longest increasing subsequence. group of all i such that ai belongs to every longest increasing subsequence. Since the number of longest increasing subsequences of a may be very large, categorizing process is very difficult. Your task is to help him finish this job." "data structures,dp,greedy,hashing,math" 2200
883C "Downloading B++" "Only T milliseconds left before the start of well-known online programming contest Codehorses Round 2017.Polycarp needs to download B++ compiler to take part in the contest. The size of the file is f bytes.Polycarp\'s internet tariff allows to download data at the rate of one byte per t0 milliseconds. This tariff is already prepaid, and its use does not incur any expense for Polycarp. In addition, the Internet service provider offers two additional packages:  download a1 bytes at the rate of one byte per t1 milliseconds, paying p1 burles for the package;  download a2 bytes at the rate of one byte per t2 milliseconds, paying p2 burles for the package. Polycarp can buy any package many times. When buying a package, its price (p1 or p2) is prepaid before usage. Once a package is bought it replaces the regular tariff until package data limit is completely used. After a package is consumed Polycarp can immediately buy a new package or switch to the regular tariff without loosing any time. While a package is in use Polycarp can\'t buy another package or switch back to the regular internet tariff.Find the minimum amount of money Polycarp has to spend to download an f bytes file no more than in T milliseconds.Note that because of technical reasons Polycarp can download only integer number of bytes using regular tariff and both packages. I.e. in each of three downloading modes the number of downloaded bytes will be integer. It means that Polycarp can\'t download a byte partially using the regular tariff or/and both packages." "binary search,implementation" 2300
611B "New Year and Old Property" "The year 2015 is almost over.Limak is a little polar bear. He has recently learnt about the binary system. He noticed that the passing year has exactly one zero in its representation in the binary system \xe2\x80\x94 201510\xe2\x80\x89=\xe2\x80\x89111110111112. Note that he doesn\'t care about the number of zeros in the decimal representation.Limak chose some interval of years. He is going to count all years from this interval that have exactly one zero in the binary representation. Can you do it faster?Assume that all positive integers are always written without leading zeros." "bitmasks,brute force,implementation" 1300
1619F "Let\'s Play the Hat?" "The Hat is a game of speedy explanation/guessing words (similar to Alias). It\'s fun. Try it! In this problem, we are talking about a variant of the game when the players are sitting at the table and everyone plays individually (i.e. not teams, but individual gamers play).n people gathered in a room with m tables (n\xe2\x89\xa52m). They want to play the Hat k times. Thus, k games will be played at each table. Each player will play in k games.To do this, they are distributed among the tables for each game. During each game, one player plays at exactly one table. A player can play at different tables.Players want to have the most ""fair"" schedule of games. For this reason, they are looking for a schedule (table distribution for each game) such that:  At any table in each game there are either \xe2\x8c\x8anm\xe2\x8c\x8b people or \xe2\x8c\x88nm\xe2\x8c\x89 people (that is, either n/m rounded down, or n/m rounded up). Different numbers of people can play different games at the same table. Let\'s calculate for each player the value bi \xe2\x80\x94 the number of times the i-th player played at a table with \xe2\x8c\x88nm\xe2\x8c\x89 persons (n/m rounded up). Any two values of bimust differ by no more than 1. In other words, for any two players i and j, it must be true |bi\xe2\x88\x92bj|\xe2\x89\xa41. For example, if n=5, m=2 and k=2, then at the request of the first item either two players or three players should play at each table. Consider the following schedules:  First game: 1,2,3 are played at the first table, and 4,5 at the second one. The second game: at the first table they play 5,1, and at the second  \xe2\x80\x94 2,3,4. This schedule is not ""fair"" since b2=2 (the second player played twice at a big table) and b5=0 (the fifth player did not play at a big table). First game: 1,2,3 are played at the first table, and 4,5 at the second one. The second game: at the first table they play 4,5,2, and at the second one  \xe2\x80\x94 1,3. This schedule is ""fair"": b=[1,2,1,1,1] (any two values of bi differ by no more than 1). Find any ""fair"" game schedule for n people if they play on the m tables of k games." "brute force,constructive algorithms,greedy,math" 2000
865F "Egg Roulette" "The game of Egg Roulette is played between two players. Initially 2R raw eggs and 2C cooked eggs are placed randomly into a carton. The shells are left on so there is no way to distinguish a raw egg from a cooked egg. One at a time, a player will select an egg, and then smash the egg on his/her forehead. If the egg was cooked, not much happens, but if the egg was raw, it will make quite the mess. This continues until one player has broken R raw eggs, at which point that player is declared the loser and the other player wins.The order in which players take turns can be described as a string of \'A\' and \'B\' characters, where the i-th character tells which player should choose the i-th egg. Traditionally, players take turns going one after the other. That is, they follow the ordering ""ABABAB..."". This isn\'t very fair though, because the second player will win more often than the first. We\'d like you to find a better ordering for the players to take their turns. Let\'s define the unfairness of an ordering as the absolute difference between the first player\'s win probability and the second player\'s win probability. We\'re interested in orderings that minimize the unfairness. We only consider an ordering valid if it contains the same number of \'A\'s as \'B\'s.You will also be given a string S of length 2(R\xe2\x80\x89+\xe2\x80\x89C) containing only \'A\', \'B\', and \'?\' characters. An ordering is said to match S if it only differs from S in positions where S contains a \'?\'. Of the valid orderings that minimize unfairness, how many match S?" "bitmasks,brute force,divide and conquer,math,meet-in-the-middle" 3300
2036G "Library of Magic" "This is an interactive problem.The Department of Supernatural Phenomena at the Oxenfurt Academy has opened the Library of Magic, which contains the works of the greatest sorcerers of Redania \xe2\x80\x94 n (3\xe2\x89\xa4n\xe2\x89\xa41018) types of books, numbered from 1 to n. Each book\'s type number is indicated on its spine. Moreover, each type of book is stored in the library in exactly two copies! And you have been appointed as the librarian.One night, you wake up to a strange noise and see a creature leaving the building through a window. Three thick tomes of different colors were sticking out of the mysterious thief\'s backpack. Before you start searching for them, you decide to compute the numbers a, b, and c written on the spines of these books. All three numbers are distinct.So, you have an unordered set of tomes, which includes one tome with each of the pairwise distinct numbers a, b, and c, and two tomes for all numbers from 1 to n, except for a, b, and c. You want to find these values a, b, and c.Since you are not working in a simple library, but in the Library of Magic, you can only use one spell in the form of a query to check the presence of books in their place:   ""xor l r"" \xe2\x80\x94 Bitwise XOR query with parameters l and r. Let k be the number of such tomes in the library whose numbers are greater than or equal to l and less than or equal to r. You will receive the result of the computation v1\xe2\x8a\x95v2\xe2\x8a\x95...\xe2\x8a\x95vk, where v1...vk are the numbers on the spines of these tomes, and \xe2\x8a\x95 denotes the operation of bitwise exclusive OR. Since your magical abilities as a librarian are severely limited, you can make no more than 150 queries." "binary search,constructive algorithms,divide and conquer,interactive,math,number theory" 2200
1884A "Simple Design" "A positive integer is called k-beautiful, if the digit sum of the decimal representation of this number is divisible by k\xe2\x80\xa0. For example, 9272 is 5-beautiful, since the digit sum of 9272 is 9+2+7+2=20.You are given two integers x and k. Please find the smallest integer y\xe2\x89\xa5x which is k-beautiful.\xe2\x80\xa0 An integer n is divisible by k if there exists an integer m such that n=k\xe2\x8b\x85m." "brute force,greedy,math" 800
1638E "Colorful Operations" "You have an array a1,a2,\xe2\x80\xa6,an. Each element initially has value 0 and color 1. You are also given q queries to perform:   Color l r c: Change the color of elements al,al+1,\xe2\x8b\xaf,ar to c (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n, 1\xe2\x89\xa4c\xe2\x89\xa4n).  Add c x: Add x to values of all elements ai (1\xe2\x89\xa4i\xe2\x89\xa4n) of color c (1\xe2\x89\xa4c\xe2\x89\xa4n, \xe2\x88\x92109\xe2\x89\xa4x\xe2\x89\xa4109).  Query i: Print ai (1\xe2\x89\xa4i\xe2\x89\xa4n)." "brute force,data structures,implementation" 2400
1320F "Blocks and Sensors" "Polycarp plays a well-known computer game (we won\'t mention its name). Every object in this game consists of three-dimensional blocks \xe2\x80\x94 axis-aligned cubes of size 1\xc3\x971\xc3\x971. These blocks are unaffected by gravity, so they can float in the air without support. The blocks are placed in cells of size 1\xc3\x971\xc3\x971; each cell either contains exactly one block or is empty. Each cell is represented by its coordinates (x,y,z) (the cell with these coordinates is a cube with opposite corners in (x,y,z) and (x+1,y+1,z+1)) and its contents ax,y,z; if the cell is empty, then ax,y,z=0, otherwise ax,y,z is equal to the type of the block placed in it (the types are integers from 1 to 2\xe2\x8b\x85105).Polycarp has built a large structure consisting of blocks. This structure can be enclosed in an axis-aligned rectangular parallelepiped of size n\xc3\x97m\xc3\x97k, containing all cells (x,y,z) such that x\xe2\x88\x88[1,n], y\xe2\x88\x88[1,m], and z\xe2\x88\x88[1,k]. After that, Polycarp has installed 2nm+2nk+2mk sensors around this parallelepiped. A sensor is a special block that sends a ray in some direction and shows the type of the first block that was hit by this ray (except for other sensors). The sensors installed by Polycarp are adjacent to the borders of the parallelepiped, and the rays sent by them are parallel to one of the coordinate axes and directed inside the parallelepiped. More formally, the sensors can be divided into 6 types:  there are mk sensors of the first type; each such sensor is installed in (0,y,z), where y\xe2\x88\x88[1,m] and z\xe2\x88\x88[1,k], and it sends a ray that is parallel to the Ox axis and has the same direction;  there are mk sensors of the second type; each such sensor is installed in (n+1,y,z), where y\xe2\x88\x88[1,m] and z\xe2\x88\x88[1,k], and it sends a ray that is parallel to the Ox axis and has the opposite direction;  there are nk sensors of the third type; each such sensor is installed in (x,0,z), where x\xe2\x88\x88[1,n] and z\xe2\x88\x88[1,k], and it sends a ray that is parallel to the Oy axis and has the same direction;  there are nk sensors of the fourth type; each such sensor is installed in (x,m+1,z), where x\xe2\x88\x88[1,n] and z\xe2\x88\x88[1,k], and it sends a ray that is parallel to the Oy axis and has the opposite direction;  there are nm sensors of the fifth type; each such sensor is installed in (x,y,0), where x\xe2\x88\x88[1,n] and y\xe2\x88\x88[1,m], and it sends a ray that is parallel to the Oz axis and has the same direction;  finally, there are nm sensors of the sixth type; each such sensor is installed in (x,y,k+1), where x\xe2\x88\x88[1,n] and y\xe2\x88\x88[1,m], and it sends a ray that is parallel to the Oz axis and has the opposite direction. Polycarp has invited his friend Monocarp to play with him. Of course, as soon as Monocarp saw a large parallelepiped bounded by sensor blocks, he began to wonder what was inside of it. Polycarp didn\'t want to tell Monocarp the exact shape of the figure, so he provided Monocarp with the data from all sensors and told him to try guessing the contents of the parallelepiped by himself.After some hours of thinking, Monocarp has no clue about what\'s inside the sensor-bounded space. But he does not want to give up, so he decided to ask for help. Can you write a program that will analyze the sensor data and construct any figure that is consistent with it?" "brute force" 3500
468A "24 Game" "Little X used to play a card game called ""24 Game"", but recently he has found it too easy. So he invented a new game.Initially you have a sequence of n integers: 1,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89n. In a single step, you can pick two of them, let\'s denote them a and b, erase them from the sequence, and append to the sequence either a\xe2\x80\x89+\xe2\x80\x89b, or a\xe2\x80\x89-\xe2\x80\x89b, or a\xe2\x80\x89\xc3\x97\xe2\x80\x89b.After n\xe2\x80\x89-\xe2\x80\x891 steps there is only one number left. Can you make this number equal to 24?" "constructive algorithms,greedy,math" 1500
414D "Mashmokh and Water Tanks" "Mashmokh is playing a new game. In the beginning he has k liters of water and p coins. Additionally he has a rooted tree (an undirected connected acyclic graph) that consists of m vertices. Each vertex of the tree contains a water tank that is empty in the beginning.The game begins with the fact that Mashmokh chooses some (no more than k) of these tanks (except the root) and pours into each of them exactly 1 liter of water. Then the following process is performed until there is no water remained in tanks.  The process consists of several steps.  At the beginning of each step Mashmokh opens doors of all tanks. Then Mashmokh closes doors of some tanks (he is not allowed to close door of tank in the root) for the duration of this move. Let\'s denote the number of liters in some tank with closed door as w, Mashmokh pays w coins for the closing of that tank during this move.  Let\'s denote by x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xm as the list of vertices of the tree sorted (nondecreasing) by their depth. The vertices from this list should be considered one by one in the order. Firstly vertex x1 (which is the root itself) is emptied. Then for each vertex xi (i\xe2\x80\x89>\xe2\x80\x891), if its door is closed then skip the vertex else move all the water from the tank of vertex xi to the tank of its father (even if the tank of the father is closed). Suppose l moves were made until the tree became empty. Let\'s denote the amount of water inside the tank of the root after the i-th move by wi then Mashmokh will win max(w1,\xe2\x80\x89w2,\xe2\x80\x89...,\xe2\x80\x89wl) dollars. Mashmokh wanted to know what is the maximum amount of dollars he can win by playing the above game. He asked you to find this value for him." "binary search,data structures,greedy,trees,two pointers" 2300
1064B "Equations of Mathematical Magic" "Colossal! \xe2\x80\x94 exclaimed Hawk-nose. \xe2\x80\x94 A programmer! That\'s exactly what we are looking for.Arkadi and Boris Strugatsky. Monday starts on SaturdayReading the book ""Equations of Mathematical Magic"" Roman Oira-Oira and Cristobal Junta found an interesting equation: a\xe2\x88\x92(a\xe2\x8a\x95x)\xe2\x88\x92x=0 for some given a, where \xe2\x8a\x95 stands for a bitwise exclusive or (XOR) of two integers (this operation is denoted as ^ or xor in many modern programming languages). Oira-Oira quickly found some x, which is the solution of the equation, but Cristobal Junta decided that Oira-Oira\'s result is not interesting enough, so he asked his colleague how many non-negative solutions of this equation exist. This task turned out to be too difficult for Oira-Oira, so he asks you to help." math 1200
907A "Masha and Bears" "A family consisting of father bear, mother bear and son bear owns three cars. Father bear can climb into the largest car and he likes it. Also, mother bear can climb into the middle car and she likes it. Moreover, son bear can climb into the smallest car and he likes it. It\'s known that the largest car is strictly larger than the middle car, and the middle car is strictly larger than the smallest car. Masha came to test these cars. She could climb into all cars, but she liked only the smallest car. It\'s known that a character with size a can climb into some car with size b if and only if a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b, he or she likes it if and only if he can climb into this car and 2a\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89b.You are given sizes of bears and Masha. Find out some possible integer non-negative sizes of cars." "brute force,implementation" 1300
128E Birthday "Anna\'s got a birthday today. She invited many guests and cooked a huge (nearly infinite) birthday cake decorated by n banana circles of different sizes. Maria\'s birthday is about to start in 7 minutes too, and while Anna is older, she decided to play the boss a little. She told Maria to cut the cake by k straight-line cuts (the cutting lines can intersect) to divide banana circles into banana pieces. Anna has many guests and she wants everyone to get at least one banana piece. That\'s why she told Maria to make the total number of banana pieces maximum. It\'s not a problem if some banana pieces end up on the same cake piece \xe2\x80\x94 the key is to make the maximum number of banana pieces. Determine what result Maria will achieve." geometry,math 2900
316A1 "Special Task" "Special Agent Smart Beaver works in a secret research department of ABBYY. He\'s been working there for a long time and is satisfied with his job, as it allows him to eat out in the best restaurants and order the most expensive and exotic wood types there. The content special agent has got an important task: to get the latest research by British scientists on the English Language. These developments are encoded and stored in a large safe. The Beaver\'s teeth are strong enough, so the authorities assured that upon arriving at the place the beaver won\'t have any problems with opening the safe.And he finishes his aspen sprig and leaves for this important task. Of course, the Beaver arrived at the location without any problems, but alas. He can\'t open the safe with his strong and big teeth. At this point, the Smart Beaver get a call from the headquarters and learns that opening the safe with the teeth is not necessary, as a reliable source has sent the following information: the safe code consists of digits and has no leading zeroes. There also is a special hint, which can be used to open the safe. The hint is string s with the following structure:  if si = ""?"", then the digit that goes i-th in the safe code can be anything (between 0 to 9, inclusively);  if si is a digit (between 0 to 9, inclusively), then it means that there is digit si on position i in code;  if the string contains letters from ""A"" to ""J"", then all positions with the same letters must contain the same digits and the positions with distinct letters must contain distinct digits.  The length of the safe code coincides with the length of the hint. For example, hint ""?JGJ9"" has such matching safe code variants: ""51919"", ""55959"", ""12329"", ""93539"" and so on, and has wrong variants such as: ""56669"", ""00111"", ""03539"" and ""13666"".After receiving such information, the authorities change the plan and ask the special agents to work quietly and gently and not to try to open the safe by mechanical means, and try to find the password using the given hint.At a special agent school the Smart Beaver was the fastest in his platoon finding codes for such safes, but now he is not in that shape: the years take their toll ... Help him to determine the number of possible variants of the code to the safe, matching the given hint. After receiving this information, and knowing his own speed of entering codes, the Smart Beaver will be able to determine whether he will have time for tonight\'s show ""Beavers are on the trail"" on his favorite TV channel, or he should work for a sleepless night..." greedy 1100
576D "Flights for Regular Customers" "In the country there are exactly n cities numbered with positive integers from 1 to n. In each city there is an airport is located.Also, there is the only one airline, which makes m flights. Unfortunately, to use them, you need to be a regular customer of this company, namely, you have the opportunity to enjoy flight i from city ai to city bi only if you have already made at least di flights before that.Please note that flight i flies exactly from city ai to city bi. It can not be used to fly from city bi to city ai. An interesting fact is that there may possibly be recreational flights with a beautiful view of the sky, which begin and end in the same city.You need to get from city 1 to city n. Unfortunately, you\'ve never traveled by plane before. What minimum number of flights you have to perform in order to get to city n?Note that the same flight can be used multiple times." dp,matrices 2700
757A "Gotta Catch Em\' All!" "Bash wants to become a Pokemon master one day. Although he liked a lot of Pokemon, he has always been fascinated by Bulbasaur the most. Soon, things started getting serious and his fascination turned into an obsession. Since he is too young to go out and catch Bulbasaur, he came up with his own way of catching a Bulbasaur.Each day, he takes the front page of the newspaper. He cuts out the letters one at a time, from anywhere on the front page of the newspaper to form the word ""Bulbasaur"" (without quotes) and sticks it on his wall. Bash is very particular about case \xe2\x80\x94 the first letter of ""Bulbasaur"" must be upper case and the rest must be lower case. By doing this he thinks he has caught one Bulbasaur. He then repeats this step on the left over part of the newspaper. He keeps doing this until it is not possible to form the word ""Bulbasaur"" from the newspaper.Given the text on the front page of the newspaper, can you tell how many Bulbasaurs he will catch today?Note: uppercase and lowercase letters are considered different." implementation 1000
1520D "Same Differences" "You are given an array a of n integers. Count the number of pairs of indices (i,j) such that i<j and aj\xe2\x88\x92ai=j\xe2\x88\x92i." "data structures,hashing,math" 1200
1795E Explosions? "You are playing yet another game where you kill monsters using magic spells. There are n cells in the row, numbered from 1 to n. Initially, the i-th cell contains the i-th monster with hi health.You have a basic spell that costs 1 MP and deals 1 damage to the monster you choose. You can cast it any number of times. Also, you have a special scroll with ""Explosion"" spell you can use only once. You want to finish killing monsters with explosion, that\'s why you, firstly, cast the basic spell several times (possibly, zero), and then after that, you cast one ""Explosion"".How does ""Explosion"" spell work? Firstly, you choose the power of the spell: if you pour x MP into it, ""Explosion"" will deal x damage. Secondly, you choose some monster i, which will be targeted by the spell. That\'s what happens next:   if its current health hi>x, then he stays alive with health decreased by x;  if hi\xe2\x89\xa4x, the i-th monster dies with an explosion that deals hi\xe2\x88\x921 damage to monsters in the neighboring cells i\xe2\x88\x921 and i+1, if these cells exist and monsters inside are still alive;  if the damage dealt by the explosion is enough to kill the monster i\xe2\x88\x921 (or i+1), i. e. the current hi\xe2\x88\x921\xe2\x89\xa4hi\xe2\x88\x921 (or hi+1\xe2\x89\xa4hi\xe2\x88\x921), then that monster also dies creating a secondary explosion of power hi\xe2\x88\x921\xe2\x88\x921 (or hi+1\xe2\x88\x921) that may deals damage to their neighbors, and so on, until the explosions end. Your goal is to kill all the remaining monsters with those ""chaining"" explosions, that\'s why you need a basic spell to decrease hi of some monsters or even kill them beforehand (monsters die when their current health hi becomes less or equal to zero). Note that monsters don\'t move between cells, so, for example, monsters i and i+2 will never become neighbors.What is the minimum total MP you need to kill all monsters in the way you want? The total MP is counted as the sum of the number of basic spells you cast and the power x of explosion scroll you\'ve chosen." "binary search,data structures,dp,greedy,math" 2200
1252C "Even Path" "Pathfinding is a task of finding a route between two points. It often appears in many problems. For example, in a GPS navigation software where a driver can query for a suggested route, or in a robot motion planning where it should find a valid sequence of movements to do some tasks, or in a simple maze solver where it should find a valid path from one point to another point. This problem is related to solving a maze.The maze considered in this problem is in the form of a matrix of integers A of N\xc3\x97N. The value of each cell is generated from a given array R and C of N integers each. Specifically, the value on the ith row and jth column, cell (i,j), is equal to Ri+Cj. Note that all indexes in this problem are from 1 to N.A path in this maze is defined as a sequence of cells (r1,c1),(r2,c2),\xe2\x80\xa6,(rk,ck) such that |ri\xe2\x88\x92ri+1|+|ci\xe2\x88\x92ci+1|=1 for all 1\xe2\x89\xa4i<k. In other words, each adjacent cell differs only by 1 row or only by 1 column. An even path in this maze is defined as a path in which all the cells in the path contain only even numbers.Given a tuple \xe2\x9f\xa8ra,ca,rb,cb\xe2\x9f\xa9 as a query, your task is to determine whether there exists an even path from cell (ra,ca) to cell (rb,cb). To simplify the problem, it is guaranteed that both cell (ra,ca) and cell (rb,cb) contain even numbers.For example, let N=5, R={6,2,7,8,3}, and C={3,4,8,5,1}. The following figure depicts the matrix A of 5\xc3\x975 which is generated from the given array R and C.  Let us consider several queries:   \xe2\x9f\xa82,2,1,3\xe2\x9f\xa9: There is an even path from cell (2,2) to cell (1,3), e.g., (2,2),(2,3),(1,3). Of course, (2,2),(1,2),(1,3) is also a valid even path.  \xe2\x9f\xa84,2,4,3\xe2\x9f\xa9: There is an even path from cell (4,2) to cell (4,3), namely (4,2),(4,3).  \xe2\x9f\xa85,1,3,4\xe2\x9f\xa9: There is no even path from cell (5,1) to cell (3,4). Observe that the only two neighboring cells of (5,1) are cell (5,2) and cell (4,1), and both of them contain odd numbers (7 and 11, respectively), thus, there cannot be any even path originating from cell (5,1)." "data structures,implementation" 1600
1041D Glider "A plane is flying at a constant height of h meters above the ground surface. Let\'s consider that it is flying from the point (\xe2\x88\x92109,h) to the point (109,h) parallel with Ox axis.A glider is inside the plane, ready to start his flight at any moment (for the sake of simplicity let\'s consider that he may start only when the plane\'s coordinates are integers). After jumping from the plane, he will fly in the same direction as the plane, parallel to Ox axis, covering a unit of distance every second. Naturally, he will also descend; thus his second coordinate will decrease by one unit every second.There are ascending air flows on certain segments, each such segment is characterized by two numbers x1 and x2 (x1<x2) representing its endpoints. No two segments share any common points. When the glider is inside one of such segments, he doesn\'t descend, so his second coordinate stays the same each second. The glider still flies along Ox axis, covering one unit of distance every second.   If the glider jumps out at 1, he will stop at 10. Otherwise, if he jumps out at 2, he will stop at 12. Determine the maximum distance along Ox axis from the point where the glider\'s flight starts to the point where his flight ends if the glider can choose any integer coordinate to jump from the plane and start his flight. After touching the ground the glider stops altogether, so he cannot glide through an ascending airflow segment if his second coordinate is 0." "binary search,data structures,two pointers" 1700
1389G "Directing Edges" "You are given an undirected connected graph consisting of n vertices and m edges. k vertices of this graph are special.You have to direct each edge of this graph or leave it undirected. If you leave the i-th edge undirected, you pay wi coins, and if you direct it, you don\'t have to pay for it.Let\'s call a vertex saturated if it is reachable from each special vertex along the edges of the graph (if an edge is undirected, it can be traversed in both directions). After you direct the edges of the graph (possibly leaving some of them undirected), you receive ci coins for each saturated vertex i. Thus, your total profit can be calculated as \xe2\x88\x91i\xe2\x88\x88Sci\xe2\x88\x92\xe2\x88\x91j\xe2\x88\x88Uwj, where S is the set of saturated vertices, and U is the set of edges you leave undirected.For each vertex i, calculate the maximum possible profit you can get if you have to make the vertex i saturated." "dfs and similar,dp,graphs,trees" 2800
1084C "The Fair Nut and String" "The Fair Nut found a string s. The string consists of lowercase Latin letters. The Nut is a curious guy, so he wants to find the number of strictly increasing sequences p1,p2,\xe2\x80\xa6,pk, such that:   For each i (1\xe2\x89\xa4i\xe2\x89\xa4k), spi= \'a\'.  For each i (1\xe2\x89\xa4i<k), there is such j that pi<j<pi+1 and sj= \'b\'. The Nut is upset because he doesn\'t know how to find the number. Help him.This number should be calculated modulo 109+7." combinatorics,dp,implementation 1500
1148G "Gold Experience" "Consider an undirected graph G with n vertices. There is a value ai in each vertex.Two vertices i and j are connected with an edge if and only if gcd(ai,aj)>1, where gcd(x,y) denotes the greatest common divisor (GCD) of integers x and y.Consider a set of vertices. Let\'s call a vertex in this set fair if it is connected with an edge with all other vertices in this set.You need to find a set of k vertices (where k is a given integer, 2\xe2\x8b\x85k\xe2\x89\xa4n) where all vertices are fair or all vertices are not fair. One can show that such a set always exists." "constructive algorithms,graphs,math,number theory,probabilities" 3300
1486C2 "Guessing the Greatest (hard version)" "The only difference between the easy and the hard version is the limit to the number of queries.This is an interactive problem.There is an array a of n different numbers. In one query you can ask the position of the second maximum element in a subsegment a[l..r]. Find the position of the maximum element in the array in no more than 20 queries.A subsegment a[l..r] is all the elements al,al+1,...,ar. After asking this subsegment you will be given the position of the second maximum from this subsegment in the whole array." "binary search,interactive" 1900
893D "Credit Card" "Recenlty Luba got a credit card and started to use it. Let\'s consider n consecutive days Luba uses the card.She starts with 0 money on her account.In the evening of i-th day a transaction ai occurs. If ai\xe2\x80\x89>\xe2\x80\x890, then ai bourles are deposited to Luba\'s account. If ai\xe2\x80\x89<\xe2\x80\x890, then ai bourles are withdrawn. And if ai\xe2\x80\x89=\xe2\x80\x890, then the amount of money on Luba\'s account is checked.In the morning of any of n days Luba can go to the bank and deposit any positive integer amount of burles to her account. But there is a limitation: the amount of money on the account can never exceed d.It can happen that the amount of money goes greater than d by some transaction in the evening. In this case answer will be \xc2\xab-1\xc2\xbb.Luba must not exceed this limit, and also she wants that every day her account is checked (the days when ai\xe2\x80\x89=\xe2\x80\x890) the amount of money on her account is non-negative. It takes a lot of time to go to the bank, so Luba wants to know the minimum number of days she needs to deposit some money to her account (if it is possible to meet all the requirements). Help her!" "data structures,dp,greedy,implementation" 1900
1213B "Bad Prices" "Polycarp analyzes the prices of the new berPhone. At his disposal are the prices for n last days: a1,a2,\xe2\x80\xa6,an, where ai is the price of berPhone on the day i.Polycarp considers the price on the day i to be bad if later (that is, a day with a greater number) berPhone was sold at a lower price. For example, if n=6 and a=[3,9,4,6,7,5], then the number of days with a bad price is 3 \xe2\x80\x94 these are days 2 (a2=9), 4 (a4=6) and 5 (a5=7).Print the number of days with a bad price.You have to answer t independent data sets." "data structures,implementation" 1100
470B Hexakosioihexekontahexaphobia "This (unpronounceable) word means simply fear of number 666. You are given a string of digits. Check whether it is scary for a person suffering from this phobia, i.e., whether it contains number 666 as a substring." "*special problem" 1800
710A "King Moves" "The only king stands on the standard chess board. You are given his position in format ""cd"", where c is the column from \'a\' to \'h\' and d is the row from \'1\' to \'8\'. Find the number of moves permitted for the king.Check the king\'s moves here https://en.wikipedia.org/wiki/King_(chess).  King moves from the position e4" implementation 800
1977C "Nikita and LCM" "Nikita is a student passionate about number theory and algorithms. He faces an interesting problem related to an array of numbers.Suppose Nikita has an array of integers a of length n. He will call a subsequence\xe2\x80\xa0 of the array special if its least common multiple (LCM) is not contained in a. The LCM of an empty subsequence is equal to 0.Nikita wonders: what is the length of the longest special subsequence of a? Help him answer this question!\xe2\x80\xa0 A sequence b is a subsequence of a if b can be obtained from a by the deletion of several (possibly, zero or all) elements, without changing the order of the remaining elements. For example, [5,2,3] is a subsequence of [1,5,7,8,2,4,3]." "brute force,data structures,dp,greedy,math,number theory,sortings" 1900
1829A "Love Story" "Timur loves codeforces. That\'s why he has a string s having length 10 made containing only lowercase Latin letters. Timur wants to know how many indices string s differs from the string ""codeforces"".For example string s= ""coolforsez"" differs from ""codeforces"" in 4 indices, shown in bold.Help Timur by finding the number of indices where string s differs from ""codeforces"".Note that you can\'t reorder the characters in the string s." implementation,strings 800
1144E "Median String" "You are given two strings s and t, both consisting of exactly k lowercase Latin letters, s is lexicographically less than t.Let\'s consider list of all strings consisting of exactly k lowercase Latin letters, lexicographically not less than s and not greater than t (including s and t) in lexicographical order. For example, for k=2, s=""az"" and t=""bf"" the list will be [""az"", ""ba"", ""bb"", ""bc"", ""bd"", ""be"", ""bf""].Your task is to print the median (the middle element) of this list. For the example above this will be ""bc"".It is guaranteed that there is an odd number of strings lexicographically not less than s and not greater than t." "bitmasks,math,number theory,strings" 1900
287A "IQ Test" "In the city of Ultima Thule job applicants are often offered an IQ test. The test is as follows: the person gets a piece of squared paper with a 4\xe2\x80\x89\xc3\x97\xe2\x80\x894 square painted on it. Some of the square\'s cells are painted black and others are painted white. Your task is to repaint at most one cell the other color so that the picture has a 2\xe2\x80\x89\xc3\x97\xe2\x80\x892 square, completely consisting of cells of the same color. If the initial picture already has such a square, the person should just say so and the test will be completed. Your task is to write a program that determines whether it is possible to pass the test. You cannot pass the test if either repainting any cell or no action doesn\'t result in a 2\xe2\x80\x89\xc3\x97\xe2\x80\x892 square, consisting of cells of the same color." "brute force,implementation" 1100
771E "Bear and Rectangle Strips" "Limak has a grid that consists of 2 rows and n columns. The j-th cell in the i-th row contains an integer ti,\xe2\x80\x89j which can be positive, negative or zero.A non-empty rectangle of cells is called nice if and only if the sum of numbers in its cells is equal to 0.Limak wants to choose some nice rectangles and give them to his friends, as gifts. No two chosen rectangles should share a cell. What is the maximum possible number of nice rectangles Limak can choose?" dp,greedy 3000
1203D1 "Remove the Substring (easy version)" "The only difference between easy and hard versions is the length of the string.You are given a string s and a string t, both consisting only of lowercase Latin letters. It is guaranteed that t can be obtained from s by removing some (possibly, zero) number of characters (not necessary contiguous) from s without changing order of remaining characters (in other words, it is guaranteed that t is a subsequence of s).For example, the strings ""test"", ""tst"", ""tt"", ""et"" and """" are subsequences of the string ""test"". But the strings ""tset"", ""se"", ""contest"" are not subsequences of the string ""test"".You want to remove some substring (contiguous subsequence) from s of maximum possible length such that after removing this substring t will remain a subsequence of s.If you want to remove the substring s[l;r] then the string s will be transformed to s1s2\xe2\x80\xa6sl\xe2\x88\x921sr+1sr+2\xe2\x80\xa6s|s|\xe2\x88\x921s|s| (where |s| is the length of s).Your task is to find the maximum possible length of the substring you can remove so that t is still a subsequence of s." greedy,implementation 1600
1500F "Cupboards Jumps" "In the house where Krosh used to live, he had n cupboards standing in a line, the i-th cupboard had the height of hi. Krosh moved recently, but he wasn\'t able to move the cupboards with him. Now he wants to buy n new cupboards so that they look as similar to old ones as possible.Krosh does not remember the exact heights of the cupboards, but for every three consecutive cupboards he remembers the height difference between the tallest and the shortest of them. In other words, if the cupboards\' heights were h1,h2,\xe2\x80\xa6,hn, then Krosh remembers the values wi=max(hi,hi+1,hi+2)\xe2\x88\x92min(hi,hi+1,hi+2) for all 1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x922.Krosh wants to buy such n cupboards that all the values wi remain the same. Help him determine the required cupboards\' heights, or determine that he remembers something incorrectly and there is no suitable sequence of heights." dp 3500
1899G "Unusual Entertainment" "A tree is a connected graph without cycles.A permutation is an array consisting of n distinct integers from 1 to n in any order. For example, [5,1,3,2,4] is a permutation, but [2,1,1] is not a permutation (as 1 appears twice in the array) and [1,3,2,5] is also not a permutation (as n=4, but 5 is present in the array).After a failed shoot in the BrMeast video, Alex fell into depression. Even his birthday did not make him happy. However, after receiving a gift from Timofey, Alex\'s mood suddenly improved. Now he spent days playing with the gifted constructor. Recently, he came up with an unusual entertainment.Alex builds a tree from his constructor, consisting of n vertices numbered from 1 to n, with the root at vertex 1. Then he writes down each integer from 1 to n in some order, obtaining a permutation p. After that, Alex comes up with q triples of integers l,r,x. For each triple, he tries to determine if there is at least one descendant of vertex x among the vertices pl,pl+1,\xe2\x80\xa6,pr.A vertex u is a descendant of vertex v if and only if dist(1,v)+dist(v,u)=dist(1,u), where dist(a,b) is the distance between vertices a and b. In other words, vertex v must be on the path from the root to vertex u.Alex told Zakhar about this entertainment. Now Alex tells his friend q triples as described above, hoping that Zakhar can check for the presence of a descendant. Zakhar is very sleepy, so he turned to you for help. Help Zakhar answer all of Alex\'s questions and finally go to sleep." "data structures,dfs and similar,dsu,shortest paths,sortings,trees,two pointers" 1900
1801G "A task for substrings" "Philip is very fond of tasks on the lines. He had already solved all the problems known to him, but this was not enough for him. Therefore, Philip decided to come up with his own task.To do this, he took the string t and a set of n strings s1, s2, s3, ..., sn. Philip has m queries, in the ith of them, Philip wants to take a substring of the string t from lith to rith character, and count the number of its substrings that match some string from the set. More formally, Philip wants to count the number of pairs of positions a, b, such that li\xe2\x89\xa4a\xe2\x89\xa4b\xe2\x89\xa4ri, and the substring of the string t from ath to bth character coincides with some string sj from the set.A substring of the string t from ath to bth character is a string obtained from t by removing the a\xe2\x88\x921 character from the beginning and |t|\xe2\x88\x92b characters from the end, where |t| denotes the length of the string t.Philip has already solved this problem, but can you?" "data structures,string suffix structures,strings" 3400
1303B "National Project" "Your company was appointed to lay new asphalt on the highway of length n. You know that every day you can either repair one unit of the highway (lay new asphalt over one unit of the highway) or skip repairing.Skipping the repair is necessary because of the climate. The climate in your region is periodical: there are g days when the weather is good and if you lay new asphalt these days it becomes high-quality pavement; after that, the weather during the next b days is bad, and if you lay new asphalt these days it becomes low-quality pavement; again g good days, b bad days and so on.You can be sure that you start repairing at the start of a good season, in other words, days 1,2,\xe2\x80\xa6,g are good.You don\'t really care about the quality of the highway, you just want to make sure that at least half of the highway will have high-quality pavement. For example, if the n=5 then at least 3 units of the highway should have high quality; if n=4 then at least 2 units should have high quality.What is the minimum number of days is needed to finish the repair of the whole highway?" math 1400
260C "Balls and Boxes" "Little Vasya had n boxes with balls in the room. The boxes stood in a row and were numbered with numbers from 1 to n from left to right.Once Vasya chose one of the boxes, let\'s assume that its number is i, took all balls out from it (it is guaranteed that this box originally had at least one ball), and began putting balls (one at a time) to the boxes with numbers i\xe2\x80\x89+\xe2\x80\x891, i\xe2\x80\x89+\xe2\x80\x892, i\xe2\x80\x89+\xe2\x80\x893 and so on. If Vasya puts a ball into the box number n, then the next ball goes to box 1, the next one goes to box 2 and so on. He did it until he had no balls left in his hands. It is possible that Vasya puts multiple balls to the same box, and it is also possible that one or more balls will go to the box number i. If i\xe2\x80\x89=\xe2\x80\x89n, Vasya puts the first ball into the box number 1, then the next ball goes to box 2 and so on. For example, let\'s suppose that initially Vasya had four boxes, and the first box had 3 balls, the second one had 2, the third one had 5 and the fourth one had 4 balls. Then, if i\xe2\x80\x89=\xe2\x80\x893, then Vasya will take all five balls out of the third box and put them in the boxes with numbers: 4,\xe2\x80\x891,\xe2\x80\x892,\xe2\x80\x893,\xe2\x80\x894. After all Vasya\'s actions the balls will lie in the boxes as follows: in the first box there are 4 balls, 3 in the second one, 1 in the third one and 6 in the fourth one.At this point Vasya has completely forgotten the original arrangement of the balls in the boxes, but he knows how they are arranged now, and the number x \xe2\x80\x94 the number of the box, where he put the last of the taken out balls.He asks you to help to find the initial arrangement of the balls in the boxes." "constructive algorithms,greedy,implementation" 1700
902B "Coloring a Tree" "You are given a rooted tree with n vertices. The vertices are numbered from 1 to n, the root is the vertex number 1.Each vertex has a color, let\'s denote the color of vertex v by cv. Initially cv\xe2\x80\x89=\xe2\x80\x890.You have to color the tree into the given colors using the smallest possible number of steps. On each step you can choose a vertex v and a color x, and then color all vectices in the subtree of v (including v itself) in color x. In other words, for every vertex u, such that the path from root to u passes through v, set cu\xe2\x80\x89=\xe2\x80\x89x.It is guaranteed that you have to color each vertex in a color different from 0.You can learn what a rooted tree is using the link: https://en.wikipedia.org/wiki/Tree_(graph_theory)." "dfs and similar,dsu,greedy" 1200
1009A "Game Shopping" "Maxim wants to buy some games at the local game shop. There are n games in the shop, the i-th game costs ci.Maxim has a wallet which can be represented as an array of integers. His wallet contains m bills, the j-th bill has value aj.Games in the shop are ordered from left to right, Maxim tries to buy every game in that order.When Maxim stands at the position i in the shop, he takes the first bill from his wallet (if his wallet is empty then he proceeds to the next position immediately) and tries to buy the i-th game using this bill. After Maxim tried to buy the n-th game, he leaves the shop.Maxim buys the i-th game if and only if the value of the first bill (which he takes) from his wallet is greater or equal to the cost of the i-th game. If he successfully buys the i-th game, the first bill from his wallet disappears and the next bill becomes first. Otherwise Maxim leaves the first bill in his wallet (this bill still remains the first one) and proceeds to the next game.For example, for array c=[2,4,5,2,4] and array a=[5,3,4,6] the following process takes place: Maxim buys the first game using the first bill (its value is 5), the bill disappears, after that the second bill (with value 3) becomes the first one in Maxim\'s wallet, then Maxim doesn\'t buy the second game because c2>a2, the same with the third game, then he buys the fourth game using the bill of value a2 (the third bill becomes the first one in Maxim\'s wallet) and buys the fifth game using the bill of value a3.Your task is to get the number of games Maxim will buy." implementation 800
119A "Epic Game" "Simon and Antisimon play a game. Initially each player receives one fixed positive integer that doesn\'t change throughout the game. Simon receives number a and Antisimon receives number b. They also have a heap of n stones. The players take turns to make a move and Simon starts. During a move a player should take from the heap the number of stones equal to the greatest common divisor of the fixed number he has received and the number of stones left in the heap. A player loses when he cannot take the required number of stones (i. e. the heap has strictly less stones left than one needs to take). Your task is to determine by the given a, b and n who wins the game." implementation 800
1848D "Vika and Bonuses" "A new bonus system has been introduced at Vika\'s favorite cosmetics store, ""Golden Pear""!The system works as follows: suppose a customer has b bonuses. Before paying for the purchase, the customer can choose one of two options:   Get a discount equal to the current number of bonuses, while the bonuses are not deducted.  Accumulate an additional x bonuses, where x is the last digit of the number b. As a result, the customer\'s account will have b+x bonuses. For example, if a customer had 24 bonuses, he can either get a discount of 24 or accumulate an additional 4 bonuses, after which his account will have 28 bonuses.At the moment, Vika has already accumulated s bonuses.The girl knows that during the remaining time of the bonus system, she will make k more purchases at the ""Golden Pear"" store network.After familiarizing herself with the rules of the bonus system, Vika became interested in the maximum total discount she can get.Help the girl answer this question." "binary search,brute force,math,ternary search" 2200
715D "Create a Maze" "ZS the Coder loves mazes. Your job is to create one so that he can play with it. A maze consists of n\xe2\x80\x89\xc3\x97\xe2\x80\x89m rooms, and the rooms are arranged in n rows (numbered from the top to the bottom starting from 1) and m columns (numbered from the left to the right starting from 1). The room in the i-th row and j-th column is denoted by (i,\xe2\x80\x89j). A player starts in the room (1,\xe2\x80\x891) and wants to reach the room (n,\xe2\x80\x89m).Each room has four doors (except for ones at the maze border), one on each of its walls, and two adjacent by the wall rooms shares the same door. Some of the doors are locked, which means it is impossible to pass through the door. For example, if the door connecting (i,\xe2\x80\x89j) and (i,\xe2\x80\x89j\xe2\x80\x89+\xe2\x80\x891) is locked, then we can\'t go from (i,\xe2\x80\x89j) to (i,\xe2\x80\x89j\xe2\x80\x89+\xe2\x80\x891). Also, one can only travel between the rooms downwards (from the room (i,\xe2\x80\x89j) to the room (i\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89j)) or rightwards (from the room (i,\xe2\x80\x89j) to the room (i,\xe2\x80\x89j\xe2\x80\x89+\xe2\x80\x891)) provided the corresponding door is not locked.  This image represents a maze with some doors locked. The colored arrows denotes all the possible paths while a red cross denotes a locked door. ZS the Coder considers a maze to have difficulty x if there is exactly x ways of travelling from the room (1,\xe2\x80\x891) to the room (n,\xe2\x80\x89m). Two ways are considered different if they differ by the sequence of rooms visited while travelling.Your task is to create a maze such that its difficulty is exactly equal to T. In addition, ZS the Coder doesn\'t like large mazes, so the size of the maze and the number of locked doors are limited. Sounds simple enough, right?" "constructive algorithms" 3100
1040A "Palindrome Dance" "A group of n dancers rehearses a performance for the closing ceremony. The dancers are arranged in a row, they\'ve studied their dancing moves and can\'t change positions. For some of them, a white dancing suit is already bought, for some of them \xe2\x80\x94 a black one, and for the rest the suit will be bought in the future.On the day when the suits were to be bought, the director was told that the participants of the olympiad will be happy if the colors of the suits on the scene will form a palindrome. A palindrome is a sequence that is the same when read from left to right and when read from right to left. The director liked the idea, and she wants to buy suits so that the color of the leftmost dancer\'s suit is the same as the color of the rightmost dancer\'s suit, the 2nd left is the same as 2nd right, and so on.The director knows how many burls it costs to buy a white suit, and how many burls to buy a black suit. You need to find out whether it is possible to buy suits to form a palindrome, and if it\'s possible, what\'s the minimal cost of doing so. Remember that dancers can not change positions, and due to bureaucratic reasons it is not allowed to buy new suits for the dancers who already have suits, even if it reduces the overall spending." greedy 1000
1012B "Chemical table" "Innopolis University scientists continue to investigate the periodic table. There are n\xc2\xb7m known elements and they form a periodic table: a rectangle with n rows and m columns. Each element can be described by its coordinates (r,\xe2\x80\x89c) (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n, 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89c\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m) in the table.Recently scientists discovered that for every four different elements in this table that form a rectangle with sides parallel to the sides of the table, if they have samples of three of the four elements, they can produce a sample of the fourth element using nuclear fusion. So if we have elements in positions (r1,\xe2\x80\x89c1), (r1,\xe2\x80\x89c2), (r2,\xe2\x80\x89c1), where r1\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89r2 and c1\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89c2, then we can produce element (r2,\xe2\x80\x89c2).  Samples used in fusion are not wasted and can be used again in future fusions. Newly crafted elements also can be used in future fusions.Innopolis University scientists already have samples of q elements. They want to obtain samples of all n\xc2\xb7m elements. To achieve that, they will purchase some samples from other laboratories and then produce all remaining elements using an arbitrary number of nuclear fusions in some order. Help them to find the minimal number of elements they need to purchase." "constructive algorithms,dfs and similar,dsu,graphs,matrices" 1900
1648E "Air Reform" "Berland is a large country with developed airlines. In total, there are n cities in the country that are historically served by the Berlaflot airline. The airline operates bi-directional flights between m pairs of cities, i-th of them connects cities with numbers ai and bi and has a price ci for a flight in both directions.It is known that Berlaflot flights can be used to get from any city to any other (possibly with transfers), and the cost of any route that consists of several consequent flights is equal to the cost of the most expensive of them. More formally, the cost of the route from a city t1 to a city tk with (k\xe2\x88\x922) transfers using cities t2, t3, t4, \xe2\x80\xa6, tk\xe2\x88\x921 is equal to the maximum cost of flights from t1 to t2, from t2 to t3, from t3 to t4 and so on until the flight from tk\xe2\x88\x921 to tk. Of course, all these flights must be operated by Berlaflot.A new airline, S8 Airlines, has recently started operating in Berland. This airline provides bi-directional flights between all pairs of cities that are not connected by Berlaflot direct flights. Thus, between each pair of cities there is a flight of either Berlaflot or S8 Airlines.The cost of S8 Airlines flights is calculated as follows: for each pair of cities x and y that is connected by a S8 Airlines flight, the cost of this flight is equal to the minimum cost of the route between the cities x and y at Berlaflot according to the pricing described earlier.It is known that with the help of S8 Airlines flights you can get from any city to any other with possible transfers, and, similarly to Berlaflot, the cost of a route between any two cities that consists of several S8 Airlines flights is equal to the cost of the most expensive flight.Due to the increased competition with S8 Airlines, Berlaflot decided to introduce an air reform and change the costs of its flights. Namely, for the i-th of its flight between the cities ai and bi, Berlaflot wants to make the cost of this flight equal to the minimum cost of the route between the cities ai and bi at S8 Airlines. Help Berlaflot managers calculate new flight costs." "data structures,dfs and similar,divide and conquer,dsu,graphs,implementation,trees" 3200
1641D "Two Arrays" "Sam changed his school and on the first biology lesson he got a very interesting task about genes.You are given n arrays, the i-th of them contains m different integers \xe2\x80\x94 ai,1,ai,2,\xe2\x80\xa6,ai,m. Also you are given an array of integers w of length n.Find the minimum value of wi+wj among all pairs of integers (i,j) (1\xe2\x89\xa4i,j\xe2\x89\xa4n), such that the numbers ai,1,ai,2,\xe2\x80\xa6,ai,m,aj,1,aj,2,\xe2\x80\xa6,aj,m are distinct." "bitmasks,brute force,combinatorics,greedy,hashing,math,two pointers" 2700
1681F "Unique Occurrences" "You are given a tree, consisting of n vertices. Each edge has an integer value written on it.Let f(v,u) be the number of values that appear exactly once on the edges of a simple path between vertices v and u.Calculate the sum of f(v,u) over all pairs of vertices v and u such that 1\xe2\x89\xa4v<u\xe2\x89\xa4n." "data structures,dfs and similar,divide and conquer,dp,dsu,trees" 2300
1718D "Permutation for Burenka" "We call an array a pure if all elements in it are pairwise distinct. For example, an array [1,7,9] is pure, [1,3,3,7] isn\'t, because 3 occurs twice in it.A pure array b is similar to a pure array c if their lengths n are the same and for all pairs of indices l, r, such that 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n, it\'s true that argmax([bl,bl+1,\xe2\x80\xa6,br])=argmax([cl,cl+1,\xe2\x80\xa6,cr]), where argmax(x) is defined as the index of the largest element in x (which is unique for pure arrays). For example, argmax([3,4,2])=2, argmax([1337,179,57])=1.Recently, Tonya found out that Burenka really likes a permutation p of length n. Tonya decided to please her and give her an array a similar to p. He already fixed some elements of a, but exactly k elements are missing (in these positions temporarily ai=0). It is guaranteed that k\xe2\x89\xa52. Also, he has a set S of k\xe2\x88\x921 numbers.Tonya realized that he was missing one number to fill the empty places of a, so he decided to buy it. He has q options to buy. Tonya thinks that the number d suits him, if it is possible to replace all zeros in a with numbers from S and the number d, so that a becomes a pure array similar to p. For each option of d, output whether this number is suitable for him or not." "data structures,graph matchings,greedy,math,trees" 3300
607B Zuma "Genos recently installed the game Zuma on his phone. In Zuma there exists a line of n gemstones, the i-th of which has color ci. The goal of the game is to destroy all the gemstones in the line as quickly as possible.In one second, Genos is able to choose exactly one continuous substring of colored gemstones that is a palindrome and remove it from the line. After the substring is removed, the remaining gemstones shift to form a solid line again. What is the minimum number of seconds needed to destroy the entire line?Let us remind, that the string (or substring) is called palindrome, if it reads same backwards or forward. In our case this means the color of the first gemstone is equal to the color of the last one, the color of the second gemstone is equal to the color of the next to last and so on." dp 1900
534E "Berland Local Positioning System" "In Berland a bus travels along the main street of the capital. The street begins from the main square and looks like a very long segment. There are n bus stops located along the street, the i-th of them is located at the distance ai from the central square, all distances are distinct, the stops are numbered in the order of increasing distance from the square, that is, ai\xe2\x80\x89<\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x891 for all i from 1 to n\xe2\x80\x89-\xe2\x80\x891. The bus starts its journey from the first stop, it passes stops 2, 3 and so on. It reaches the stop number n, turns around and goes in the opposite direction to stop 1, passing all the intermediate stops in the reverse order. After that, it again starts to move towards stop n. During the day, the bus runs non-stop on this route.The bus is equipped with the Berland local positioning system. When the bus passes a stop, the system notes down its number.One of the key features of the system is that it can respond to the queries about the distance covered by the bus for the parts of its path between some pair of stops. A special module of the system takes the input with the information about a set of stops on a segment of the path, a stop number occurs in the set as many times as the bus drove past it. This module returns the length of the traveled segment of the path (or -1 if it is impossible to determine the length uniquely). The operation of the module is complicated by the fact that stop numbers occur in the request not in the order they were visited but in the non-decreasing order.For example, if the number of stops is 6, and the part of the bus path starts at the bus stop number 5, ends at the stop number 3 and passes the stops as follows: , then the request about this segment of the path will have form: 3,\xe2\x80\x894,\xe2\x80\x895,\xe2\x80\x895,\xe2\x80\x896. If the bus on the segment of the path from stop 5 to stop 3 has time to drive past the 1-th stop (i.e., if we consider a segment that ends with the second visit to stop 3 on the way from 5), then the request will have form: 1,\xe2\x80\x892,\xe2\x80\x892,\xe2\x80\x893,\xe2\x80\x893,\xe2\x80\x894,\xe2\x80\x895,\xe2\x80\x895,\xe2\x80\x896.You will have to repeat the Berland programmers achievement and implement this function." "constructive algorithms,greedy,hashing,implementation" 2400
1722B Colourblindness "Vasya has a grid with 2 rows and n columns. He colours each cell red, green, or blue.Vasya is colourblind and can\'t distinguish green from blue. Determine if Vasya will consider the two rows of the grid to be coloured the same." implementation 800
936B "Sleepy Game" "Petya and Vasya arranged a game. The game runs by the following rules. Players have a directed graph consisting of n vertices and m edges. One of the vertices contains a chip. Initially the chip is located at vertex s. Players take turns moving the chip along some edge of the graph. Petya goes first. Player who can\'t move the chip loses. If the game lasts for 106 turns the draw is announced.Vasya was performing big laboratory work in ""Spelling and parts of speech"" at night before the game, so he fell asleep at the very beginning of the game. Petya decided to take the advantage of this situation and make both Petya\'s and Vasya\'s moves.Your task is to help Petya find out if he can win the game or at least draw a tie." "dfs and similar,dp,games,graphs" 2100
1899A "Game with Integers" "Vanya and Vova are playing a game. Players are given an integer n. On their turn, the player can add 1 to the current integer or subtract 1. The players take turns; Vanya starts. If after Vanya\'s move the integer is divisible by 3, then he wins. If 10 moves have passed and Vanya has not won, then Vova wins.Write a program that, based on the integer n, determines who will win if both players play optimally." "games,math,number theory" 800
120J "Minimum Sum" "You are given a set of n vectors on a plane. For each vector you are allowed to multiply any of its coordinates by -1. Thus, each vector vi\xe2\x80\x89=\xe2\x80\x89(xi,\xe2\x80\x89yi) can be transformed into one of the following four vectors:  vi1\xe2\x80\x89=\xe2\x80\x89(xi,\xe2\x80\x89yi),  vi2\xe2\x80\x89=\xe2\x80\x89(\xe2\x80\x89-\xe2\x80\x89xi,\xe2\x80\x89yi),  vi3\xe2\x80\x89=\xe2\x80\x89(xi,\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x89yi),  vi4\xe2\x80\x89=\xe2\x80\x89(\xe2\x80\x89-\xe2\x80\x89xi,\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x89yi).  You should find two vectors from the set and determine which of their coordinates should be multiplied by -1 so that the absolute value of the sum of the resulting vectors was minimally possible. More formally, you should choose two vectors vi, vj (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i,\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n,\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89j) and two numbers k1, k2 (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k1,\xe2\x80\x89k2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x894), so that the value of the expression |vik1\xe2\x80\x89+\xe2\x80\x89vjk2| were minimum." "divide and conquer,geometry,sortings" 1900
260A "Adding Digits" "Vasya has got two number: a and b. However, Vasya finds number a too short. So he decided to repeat the operation of lengthening number a n times.One operation of lengthening a number means adding exactly one digit to the number (in the decimal notation) to the right provided that the resulting number is divisible by Vasya\'s number b. If it is impossible to obtain the number which is divisible by b, then the lengthening operation cannot be performed.Your task is to help Vasya and print the number he can get after applying the lengthening operation to number a n times." implementation,math 1400
1538B "Friends and Candies" "Polycarp has n friends, the i-th of his friends has ai candies. Polycarp\'s friends do not like when they have different numbers of candies. In other words they want all ai to be the same. To solve this, Polycarp performs the following set of actions exactly once:   Polycarp chooses k (0\xe2\x89\xa4k\xe2\x89\xa4n) arbitrary friends (let\'s say he chooses friends with indices i1,i2,\xe2\x80\xa6,ik);  Polycarp distributes their ai1+ai2+\xe2\x80\xa6+aik candies among all n friends. During distribution for each of ai1+ai2+\xe2\x80\xa6+aik candies he chooses new owner. That can be any of n friends. Note, that any candy can be given to the person, who has owned that candy before the distribution process. Note that the number k is not fixed in advance and can be arbitrary. Your task is to find the minimum value of k.For example, if n=4 and a=[4,5,2,5], then Polycarp could make the following distribution of the candies:   Polycarp chooses k=2 friends with indices i=[2,4] and distributes a2+a4=10 candies to make a=[4,4,4,4] (two candies go to person 3). Note that in this example Polycarp cannot choose k=1 friend so that he can redistribute candies so that in the end all ai are equal.For the data n and a, determine the minimum value k. With this value k, Polycarp should be able to select k friends and redistribute their candies so that everyone will end up with the same number of candies." greedy,math 800
1607D "Blue-Red Permutation" "You are given an array of integers a of length n. The elements of the array can be either different or the same. Each element of the array is colored either blue or red. There are no unpainted elements in the array. One of the two operations described below can be applied to an array in a single step:  either you can select any blue element and decrease its value by 1;  or you can select any red element and increase its value by 1. Situations in which there are no elements of some color at all are also possible. For example, if the whole array is colored blue or red, one of the operations becomes unavailable.Determine whether it is possible to make 0 or more steps such that the resulting array is a permutation of numbers from 1 to n?In other words, check whether there exists a sequence of steps (possibly empty) such that after applying it, the array a contains in some order all numbers from 1 to n (inclusive), each exactly once." greedy,math,sortings 1300
858F "Wizard\'s Tour" "All Berland residents are waiting for an unprecedented tour of wizard in his Blue Helicopter over the cities of Berland!It is well-known that there are n cities in Berland, some pairs of which are connected by bidirectional roads. Each pair of cities is connected by no more than one road. It is not guaranteed that the road network is connected, i.e. it is possible that you can\'t reach some city from some other.The tour will contain several episodes. In each of the episodes:  the wizard will disembark at some city x from the Helicopter;  he will give a performance and show a movie for free at the city x;  he will drive to some neighboring city y using a road;  he will give a performance and show a movie for free at the city y;  he will drive to some neighboring to y city z;  he will give a performance and show a movie for free at the city z;  he will embark the Helicopter and fly away from the city z. It is known that the wizard doesn\'t like to use roads, so he agrees to use each road at most once (regardless of direction). In other words, for road between a and b he only can drive once from a to b, or drive once from b to a, or do not use this road at all.The wizards wants to plan as many episodes as possible without violation the above rules. Help the wizard!Please note that the wizard can visit the same city multiple times, the restriction is on roads only." "constructive algorithms,dfs and similar,graphs" 2300
1000C "Covered Points Count" "You are given n segments on a coordinate line; each endpoint of every segment has integer coordinates. Some segments can degenerate to points. Segments can intersect with each other, be nested in each other or even coincide.Your task is the following: for every k\xe2\x88\x88[1..n], calculate the number of points with integer coordinates such that the number of segments that cover these points equals k. A segment with endpoints li and ri covers point x if and only if li\xe2\x89\xa4x\xe2\x89\xa4ri." "data structures,implementation,sortings" 1700
665B Shopping "Ayush is a cashier at the shopping center. Recently his department has started a \'\'click and collect"" service which allows users to shop online. The store contains k items. n customers have already used the above service. Each user paid for m items. Let aij denote the j-th item in the i-th person\'s order.Due to the space limitations all the items are arranged in one single row. When Ayush receives the i-th order he will find one by one all the items aij (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m) in the row. Let pos(x) denote the position of the item x in the row at the moment of its collection. Then Ayush takes time equal to pos(ai1)\xe2\x80\x89+\xe2\x80\x89pos(ai2)\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89pos(aim) for the i-th customer.When Ayush accesses the x-th element he keeps a new stock in the front of the row and takes away the x-th element. Thus the values are updating.Your task is to calculate the total time it takes for Ayush to process all the orders.You can assume that the market has endless stock." "brute force" 1400
1061A Coins "You have unlimited number of coins with values 1,2,\xe2\x80\xa6,n. You want to select some set of coins having the total value of S. It is allowed to have multiple coins with the same value in the set. What is the minimum number of coins required to get sum S?" greedy,implementation,math 800
1030A "In Search of an Easy Problem" "When preparing a tournament, Codeforces coordinators try treir best to make the first problem as easy as possible. This time the coordinator had chosen some problem and asked n people about their opinions. Each person answered whether this problem is easy or hard.If at least one of these n people has answered that the problem is hard, the coordinator decides to change the problem. For the given responses, check if the problem is easy enough." implementation 800
1866A "Ambitious Kid" "Chaneka, Pak Chanek\'s child, is an ambitious kid, so Pak Chanek gives her the following problem to test her ambition.Given an array of integers [A1,A2,A3,\xe2\x80\xa6,AN]. In one operation, Chaneka can choose one element, then increase or decrease the element\'s value by 1. Chaneka can do that operation multiple times, even for different elements.What is the minimum number of operations that must be done to make it such that A1\xc3\x97A2\xc3\x97A3\xc3\x97\xe2\x80\xa6\xc3\x97AN=0?" math 800
452A Eevee "You are solving the crossword problem K from IPSC 2014. You solved all the clues except for one: who does Eevee evolve into? You are not very into pokemons, but quick googling helped you find out, that Eevee can evolve into eight different pokemons: Vaporeon, Jolteon, Flareon, Espeon, Umbreon, Leafeon, Glaceon, and Sylveon.You know the length of the word in the crossword, and you already know some letters. Designers of the crossword made sure that the answer is unambiguous, so you can assume that exactly one pokemon out of the 8 that Eevee evolves into fits the length and the letters given. Your task is to find it." "brute force,implementation,strings" 1000
1793F Rebrending "Kostya and Zhenya \xe2\x80\x94 the creators of the band ""Paper"" \xe2\x80\x94 after the release of the legendary album decided to create a new band ""Day movers"", for this they need to find two new people.They invited n people to the casting. The casting will last q days. On the ith of the days, Kostya and Zhenya want to find two people on the segment from li to ri who are most suitable for their band. Since ""Day movers"" are doing a modern art, musical skills are not important to them and they look only at other signs: they want the height difference between two people to be as small as possible.Help them, and for each day, find the minimum difference in the growth of people from the casting on this segment!" "brute force,data structures,divide and conquer,implementation" 2600
1550E Stringforces "You are given a string s of length n. Each character is either one of the first k lowercase Latin letters or a question mark.You are asked to replace every question mark with one of the first k lowercase Latin letters in such a way that the following value is maximized.Let fi be the maximum length substring of string s, which consists entirely of the i-th Latin letter. A substring of a string is a contiguous subsequence of that string. If the i-th letter doesn\'t appear in a string, then fi is equal to 0.The value of a string s is the minimum value among fi for all i from 1 to k.What is the maximum value the string can have?" "binary search,bitmasks,brute force,dp,strings,two pointers" 2500
306A Candies "Polycarpus has got n candies and m friends (n\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89m). He wants to make a New Year present with candies to each friend. Polycarpus is planning to present all candies and he wants to do this in the fairest (that is, most equal) manner. He wants to choose such ai, where ai is the number of candies in the i-th friend\'s present, that the maximum ai differs from the least ai as little as possible.For example, if n is divisible by m, then he is going to present the same number of candies to all his friends, that is, the maximum ai won\'t differ from the minimum one." implementation 800
2A Winner "The winner of the card game popular in Berland ""Berlogging"" is determined according to the following rules. If at the end of the game there is only one player with the maximum number of points, he is the winner. The situation becomes more difficult if the number of such players is more than one. During each round a player gains or loses a particular number of points. In the course of the game the number of points is registered in the line ""name score"", where name is a player\'s name, and score is the number of points gained in this round, which is an integer number. If score is negative, this means that the player has lost in the round. So, if two or more players have the maximum number of points (say, it equals to m) at the end of the game, than wins the one of them who scored at least m points first. Initially each player has 0 points. It\'s guaranteed that at the end of the game at least one player has a positive number of points." hashing,implementation 1500
777C "Alyona and Spreadsheet" "During the lesson small girl Alyona works with one famous spreadsheet computer program and learns how to edit tables.Now she has a table filled with integers. The table consists of n rows and m columns. By ai,\xe2\x80\x89j we will denote the integer located at the i-th row and the j-th column. We say that the table is sorted in non-decreasing order in the column j if ai,\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89j for all i from 1 to n\xe2\x80\x89-\xe2\x80\x891.Teacher gave Alyona k tasks. For each of the tasks two integers l and r are given and Alyona has to answer the following question: if one keeps the rows from l to r inclusive and deletes all others, will the table be sorted in non-decreasing order in at least one column? Formally, does there exist such j that ai,\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89j for all i from l to r\xe2\x80\x89-\xe2\x80\x891 inclusive.Alyona is too small to deal with this task and asks you to help!" "binary search,data structures,dp,greedy,implementation,two pointers" 1600
1332D "Walk on Matrix" "Bob is playing a game named ""Walk on Matrix"".In this game, player is given an n\xc3\x97m matrix A=(ai,j), i.e. the element in the i-th row in the j-th column is ai,j. Initially, player is located at position (1,1) with score a1,1. To reach the goal, position (n,m), player can move right or down, i.e. move from (x,y) to (x,y+1) or (x+1,y), as long as player is still on the matrix.However, each move changes player\'s score to the bitwise AND of the current score and the value at the position he moves to.Bob can\'t wait to find out the maximum score he can get using the tool he recently learnt  \xe2\x80\x94 dynamic programming. Here is his algorithm for this problem.   However, he suddenly realize that the algorithm above fails to output the maximum score for some matrix A. Thus, for any given non-negative integer k, he wants to find out an n\xc3\x97m matrix A=(ai,j) such that   1\xe2\x89\xa4n,m\xe2\x89\xa4500 (as Bob hates large matrix);  0\xe2\x89\xa4ai,j\xe2\x89\xa43\xe2\x8b\x85105 for all 1\xe2\x89\xa4i\xe2\x89\xa4n,1\xe2\x89\xa4j\xe2\x89\xa4m (as Bob hates large numbers);  the difference between the maximum score he can get and the output of his algorithm is exactly k. It can be shown that for any given integer k such that 0\xe2\x89\xa4k\xe2\x89\xa4105, there exists a matrix satisfying the above constraints.Please help him with it!" "bitmasks,constructive algorithms,math" 1700
559E "Gerald and Path" "The main walking trail in Geraldion is absolutely straight, and it passes strictly from the north to the south, it is so long that no one has ever reached its ends in either of the two directions. The Geraldionians love to walk on this path at any time, so the mayor of the city asked the Herald to illuminate this path with a few spotlights. The spotlights have already been delivered to certain places and Gerald will not be able to move them. Each spotlight illuminates a specific segment of the path of the given length, one end of the segment is the location of the spotlight, and it can be directed so that it covers the segment to the south or to the north of spotlight.The trail contains a monument to the mayor of the island, and although you can walk in either directions from the monument, no spotlight is south of the monument.You are given the positions of the spotlights and their power. Help Gerald direct all the spotlights so that the total length of the illuminated part of the path is as much as possible." dp,sortings 3000
1912D "Divisibility Test" "Daisy has recently learned divisibility rules for integers and she is fascinated by them. One of the tests she learned is a divisibility test by 3. You can find a sum of all digits of a decimal number and check if the resulting sum is divisible by 3. Moreover, the resulting sum of digits is congruent modulo 3 to the original number \xe2\x80\x94 the remainder modulo 3 is preserved. For example, 75\xe2\x89\xa17+5(mod3). Daisy is specifically interested in such remainder preserving divisibility tests.There are more examples like that that she learned for decimal integers (integers base 10):  To test divisibility modulo 11, find an alternating sum of digits. Counting digits from the last (least significant) digit, add digits on odd positions (the last, 3rd to the last, etc) and subtract digits on even positions (2nd to the last, 4th to the last, etc) to get the sum that is congruent modulo 11 to the original number. For example, 123\xe2\x89\xa11\xe2\x88\x922+3(mod11).  To test divisibility modulo 4, keep the last two digits. Their value is congruent modulo 4 to the original number. For example, 876543\xe2\x89\xa143(mod4).  To test divisibility modulo 7, find an alternating sum of groups of three digits. For example, 4389328\xe2\x89\xa14\xe2\x88\x92389+328(mod7). Similar tests can be found in other bases. For example, to test divisibility modulo 5 for octal numbers (base 8), find an alternating sum of groups of two digits. For example, 12348\xe2\x89\xa1\xe2\x88\x92128+348(mod5).Daisy wants to find such rules for a given base b. She is interested in three kinds of divisibility rules:  Kind 1 \xe2\x80\x94 take the last k digits of an integer in base b.  Kind 2 \xe2\x80\x94 take a sum of groups of k digits of an integer in base b.  Kind 3 \xe2\x80\x94 take an alternating sum of groups of k digits of an integer in base b. It is not always possible to find such a divisibility rule. For example, in base 10 there is no such test for divisibility modulo 6, even though different approaches to testing divisibility by 6 exist.Given base b and modulo n, Daisy wants to know the smallest group size k for which such a divisibility test exits." math 1900
1110B Tape "You have a long stick, consisting of m segments enumerated from 1 to m. Each segment is 1 centimeter long. Sadly, some segments are broken and need to be repaired.You have an infinitely long repair tape. You want to cut some pieces from the tape and use them to cover all of the broken segments. To be precise, a piece of tape of integer length t placed at some position s will cover segments s,s+1,\xe2\x80\xa6,s+t\xe2\x88\x921.You are allowed to cover non-broken segments; it is also possible that some pieces of tape will overlap.Time is money, so you want to cut at most k continuous pieces of tape to cover all the broken segments. What is the minimum total length of these pieces?" greedy,sortings 1400
220C "Little Elephant and Shifts" "The Little Elephant has two permutations a and b of length n, consisting of numbers from 1 to n, inclusive. Let\'s denote the i-th (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) element of the permutation a as ai, the j-th (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) element of the permutation b \xe2\x80\x94 as bj.The distance between permutations a and b is the minimum absolute value of the difference between the positions of the occurrences of some number in a and in b. More formally, it\'s such minimum |i\xe2\x80\x89-\xe2\x80\x89j|, that ai\xe2\x80\x89=\xe2\x80\x89bj.A cyclic shift number i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) of permutation b consisting from n elements is a permutation bibi\xe2\x80\x89+\xe2\x80\x891... bnb1b2... bi\xe2\x80\x89-\xe2\x80\x891. Overall a permutation has n cyclic shifts.The Little Elephant wonders, for all cyclic shifts of permutation b, what is the distance between the cyclic shift and permutation a?" "data structures" 2100
708D "Incorrect Flow" "At the entrance examination for the magistracy of the MSU Cyber-Mechanics Department Sasha got the question about Ford-Fulkerson algorithm. He knew the topic perfectly as he worked with it many times on programming competition. As the task for the question he was given a network with partially build flow that he had to use in order to demonstrate the workflow of the algorithm. He quickly finished to write the text and took a look at the problem only to understand that the given network is incorrect!Suppose you are given a directed graph G(V,\xe2\x80\x89E) with two special nodes s and t called source and sink. We denote as n the number of nodes in the graph, i.e. n\xe2\x80\x89=\xe2\x80\x89|V| and m stands for the number of directed edges in the graph, i.e. m\xe2\x80\x89=\xe2\x80\x89|E|. For the purpose of this problem we always consider node 1 to be the source and node n to be the sink. In addition, for each edge of the graph e we define the capacity function c(e) and flow function f(e). Function f(e) represents the correct flow if the following conditions are satisfied:  For each edge  the flow is non-negative and does not exceed capacity c(e), i.e. 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89f(e)\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89c(e).  For each node , that is not source or sink (v\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89s and v\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89t) the sum of flows of all edges going in v is equal to the sum of the flows among all edges going out from v. In other words, there is no flow stuck in v. It was clear that as the exam was prepared last night and there are plenty of mistakes in the tasks. Sasha asked one of the professors to fix the network or give the correct task, but the reply was that the magistrate student should be able to fix the network himself. As the professor doesn\'t want the task to become easier, he asks Sasha to fix the network in a such way that the total number of changes is minimum possible. Sasha is not allowed to remove edges, add new ones or reverse the direction of existing edges. The only thing he is able to do is to change capacity function c(e) and flow function f(e). Moreover, all the values should remain non-negative integers. There is no requirement on the flow to be maximum in any sense.Find the minimum possible total change of the functions f(e) and c(e) that Sasha has to make in order to make the flow correct. The total change is defined as the sum of absolute differences, i.e. if new functions are f\xe2\x80\x89*\xe2\x80\x89(e) and c\xe2\x80\x89*\xe2\x80\x89(e), then the total change is ." flows 2900
2026D "Sums of Segments" "You are given a sequence of integers [a1,a2,\xe2\x80\xa6,an]. Let s(l,r) be the sum of elements from al to ar (i.\xe2\x80\x89e. s(l,r)=r\xe2\x88\x91i=lai).Let\'s construct another sequence b of size n(n+1)2 as follows: b=[s(1,1),s(1,2),\xe2\x80\xa6,s(1,n),s(2,2),s(2,3),\xe2\x80\xa6,s(2,n),s(3,3),\xe2\x80\xa6,s(n,n)].For example, if a=[1,2,5,10], then b=[1,3,8,18,2,7,17,5,15,10].You are given q queries. During the i-th query, you are given two integers li and ri, and you have to calculate ri\xe2\x88\x91j=libj." "binary search,data structures,dp,implementation,math" 1900
1486C1 "Guessing the Greatest (easy version)" "The only difference between the easy and the hard version is the limit to the number of queries.This is an interactive problem.There is an array a of n different numbers. In one query you can ask the position of the second maximum element in a subsegment a[l..r]. Find the position of the maximum element in the array in no more than 40 queries.A subsegment a[l..r] is all the elements al,al+1,...,ar. After asking this subsegment you will be given the position of the second maximum from this subsegment in the whole array." "binary search,interactive" 1600
1979F "Kostyanych\'s Theorem" "This is an interactive problem.Kostyanych has chosen a complete undirected graph\xe2\x80\xa0 with n vertices, and then removed exactly (n\xe2\x88\x922) edges from it. You can ask queries of the following type:  ""? d"" \xe2\x80\x94 Kostyanych tells you the number of vertex v with a degree at least d. Among all possible such vertices, he selects the vertex with the minimum degree, and if there are several such vertices, he selects the one with the minimum number. He also tells you the number of another vertex in the graph, with which v is not connected by an edge (if none is found, then 0 is reported). Among all possible such vertices, he selects the one with the minimum number. Then he removes the vertex v and all edges coming out of it. If the required vertex v is not found, then ""0 0"" is reported. Find a Hamiltonian path\xe2\x80\xa1 in the original graph in at most n queries. It can be proven that under these constraints, a Hamiltonian path always exists.\xe2\x80\xa0A complete undirected graph is a graph in which there is exactly one undirected edge between any pair of distinct vertices. Thus, a complete undirected graph with n vertices contains n(n\xe2\x88\x921)2 edges.\xe2\x80\xa1A Hamiltonian path in a graph is a path that passes through each vertex exactly once." "brute force,constructive algorithms,graphs,interactive" 2900
679B "Bear and Tower of Cubes" "Limak is a little polar bear. He plays by building towers from blocks. Every block is a cube with positive integer length of side. Limak has infinitely many blocks of each side length.A block with side a has volume a3. A tower consisting of blocks with sides a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89ak has the total volume a13\xe2\x80\x89+\xe2\x80\x89a23\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89ak3.Limak is going to build a tower. First, he asks you to tell him a positive integer X \xe2\x80\x94 the required total volume of the tower. Then, Limak adds new blocks greedily, one by one. Each time he adds the biggest block such that the total volume doesn\'t exceed X.Limak asks you to choose X not greater than m. Also, he wants to maximize the number of blocks in the tower at the end (however, he still behaves greedily). Secondarily, he wants to maximize X.Can you help Limak? Find the maximum number of blocks his tower can have and the maximum X\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m that results this number of blocks." "binary search,dp,greedy" 2200
1352B "Same Parity Summands" "You are given two positive integers n (1\xe2\x89\xa4n\xe2\x89\xa4109) and k (1\xe2\x89\xa4k\xe2\x89\xa4100). Represent the number n as the sum of k positive integers of the same parity (have the same remainder when divided by 2).In other words, find a1,a2,\xe2\x80\xa6,ak such that all ai>0, n=a1+a2+\xe2\x80\xa6+ak and either all ai are even or all ai are odd at the same time.If such a representation does not exist, then report it." "constructive algorithms,math" 1200
1271E "Common Number" "At first, let\'s define function f(x) as follows: f(x)={x2if x is evenx\xe2\x88\x921otherwise We can see that if we choose some value v and will apply function f to it, then apply f to f(v), and so on, we\'ll eventually get 1. Let\'s write down all values we get in this process in a list and denote this list as path(v). For example, path(1)=[1], path(15)=[15,14,7,6,3,2,1], path(32)=[32,16,8,4,2,1].Let\'s write all lists path(x) for every x from 1 to n. The question is next: what is the maximum value y such that y is contained in at least k different lists path(x)?Formally speaking, you need to find maximum y such that |{x | 1\xe2\x89\xa4x\xe2\x89\xa4n,y\xe2\x88\x88path(x)}|\xe2\x89\xa5k." "binary search,combinatorics,dp,math" 2100
572A Arrays "You are given two arrays A and B consisting of integers, sorted in non-decreasing order. Check whether it is possible to choose k numbers in array A and choose m numbers in array B so that any number chosen in the first array is strictly less than any number chosen in the second array." sortings 900
1394D "Boboniu and Jianghu" "Since Boboniu finished building his Jianghu, he has been doing Kungfu on these mountains every day. Boboniu designs a map for his n mountains. He uses n\xe2\x88\x921 roads to connect all n mountains. Every pair of mountains is connected via roads.For the i-th mountain, Boboniu estimated the tiredness of doing Kungfu on the top of it as ti. He also estimated the height of each mountain as hi.A path is a sequence of mountains M such that for each i (1\xe2\x89\xa4i<|M|), there exists a road between Mi and Mi+1. Boboniu would regard the path as a challenge if for each i (1\xe2\x89\xa4i<|M|), hMi\xe2\x89\xa4hMi+1.Boboniu wants to divide all n\xe2\x88\x921 roads into several challenges. Note that each road must appear in exactly one challenge, but a mountain may appear in several challenges. Boboniu wants to minimize the total tiredness to do all the challenges. The tiredness of a challenge M is the sum of tiredness of all mountains in it, i.e. \xe2\x88\x91|M|i=1tMi. He asked you to find the minimum total tiredness. As a reward for your work, you\'ll become a guardian in his Jianghu." dp,greedy,sortings,trees 2800
1980E "Permutation of Rows and Columns" "You have been given a matrix a of size n by m, containing a permutation of integers from 1 to n\xe2\x8b\x85m.A permutation of n integers is an array containing all numbers from 1 to n exactly once. For example, the arrays [1], [2,1,3], [5,4,3,2,1] are permutations, while the arrays [1,1], [100], [1,2,4,5] are not.A matrix contains a permutation if, when all its elements are written out, the resulting array is a permutation. Matrices [[1,2],[3,4]], [[1]], [[1,5,3],[2,6,4]] contain permutations, while matrices [[2]], [[1,1],[2,2]], [[1,2],[100,200]] do not.You can perform one of the following two actions in one operation:  choose columns c and d (1\xe2\x89\xa4c,d\xe2\x89\xa4m, c\xe2\x89\xa0d) and swap these columns;  choose rows c and d (1\xe2\x89\xa4c,d\xe2\x89\xa4n, c\xe2\x89\xa0d) and swap these rows. You can perform any number of operations.You are given the original matrix a and the matrix b. Your task is to determine whether it is possible to transform matrix a into matrix b using the given operations." "constructive algorithms,data structures,greedy,hashing,implementation,math,matrices,sortings" 1600
629A "Far Relative\xe2\x80\x99s Birthday Cake" "Door\'s family is going celebrate Famil Doors\'s birthday party. They love Famil Door so they are planning to make his birthday cake weird!The cake is a n\xe2\x80\x89\xc3\x97\xe2\x80\x89n square consisting of equal squares with side length 1. Each square is either empty or consists of a single chocolate. They bought the cake and randomly started to put the chocolates on the cake. The value of Famil Door\'s happiness will be equal to the number of pairs of cells with chocolates that are in the same row or in the same column of the cake. Famil Doors\'s family is wondering what is the amount of happiness of Famil going to be?Please, note that any pair can be counted no more than once, as two different cells can\'t share both the same row and the same column." "brute force,combinatorics,constructive algorithms,implementation" 800
65B "Harry Potter and the History of Magic" "The History of Magic is perhaps the most boring subject in the Hogwarts school of Witchcraft and Wizardry. Harry Potter is usually asleep during history lessons, and his magical quill writes the lectures for him. Professor Binns, the history of magic teacher, lectures in such a boring and monotonous voice, that he has a soporific effect even on the quill. That\'s why the quill often makes mistakes, especially in dates.So, at the end of the semester Professor Binns decided to collect the students\' parchments with notes and check them. Ron Weasley is in a panic: Harry\'s notes may contain errors, but at least he has some notes, whereas Ron does not have any. Ronald also has been sleeping during the lectures and his quill had been eaten by his rat Scabbers. Hermione Granger refused to give Ron her notes, because, in her opinion, everyone should learn on their own. Therefore, Ron has no choice but to copy Harry\'s notes.Due to the quill\'s errors Harry\'s dates are absolutely confused: the years of goblin rebellions and other important events for the wizarding world do not follow in order, and sometimes even dates from the future occur. Now Ron wants to change some of the digits while he copies the notes so that the dates were in the chronological (i.e. non-decreasing) order and so that the notes did not have any dates strictly later than 2011, or strictly before than 1000. To make the resulting sequence as close as possible to the one dictated by Professor Binns, Ron will change no more than one digit in each date into other digit. Help him do it." "brute force,greedy,implementation" 1700
2004E "Not a Nim Problem" "Two players, Alice and Bob, are playing a game. They have n piles of stones, with the i-th pile initially containing ai stones.On their turn, a player can choose any pile of stones and take any positive number of stones from it, with one condition:  let the current number of stones in the pile be x. It is not allowed to take from the pile a number of stones y such that the greatest common divisor of x and y is not equal to 1. The player who cannot make a move loses. Both players play optimally (that is, if a player has a strategy that allows them to win, no matter how the opponent responds, they will win). Alice goes first.Determine who will win." "brute force,games,math,number theory" 2100
1197D "Yet Another Subarray Problem" "You are given an array a1,a2,\xe2\x80\xa6,an and two integers m and k.You can choose some subarray al,al+1,\xe2\x80\xa6,ar\xe2\x88\x921,ar. The cost of subarray al,al+1,\xe2\x80\xa6,ar\xe2\x88\x921,ar is equal to r\xe2\x88\x91i=lai\xe2\x88\x92k\xe2\x8c\x88r\xe2\x88\x92l+1m\xe2\x8c\x89, where \xe2\x8c\x88x\xe2\x8c\x89 is the least integer greater than or equal to x. The cost of empty subarray is equal to zero.For example, if m=3, k=10 and a=[2,\xe2\x88\x924,15,\xe2\x88\x923,4,8,3], then the cost of some subarrays are:  a3\xe2\x80\xa6a3:15\xe2\x88\x92k\xe2\x8c\x8813\xe2\x8c\x89=15\xe2\x88\x9210=5;  a3\xe2\x80\xa6a4:(15\xe2\x88\x923)\xe2\x88\x92k\xe2\x8c\x8823\xe2\x8c\x89=12\xe2\x88\x9210=2;  a3\xe2\x80\xa6a5:(15\xe2\x88\x923+4)\xe2\x88\x92k\xe2\x8c\x8833\xe2\x8c\x89=16\xe2\x88\x9210=6;  a3\xe2\x80\xa6a6:(15\xe2\x88\x923+4+8)\xe2\x88\x92k\xe2\x8c\x8843\xe2\x8c\x89=24\xe2\x88\x9220=4;  a3\xe2\x80\xa6a7:(15\xe2\x88\x923+4+8+3)\xe2\x88\x92k\xe2\x8c\x8853\xe2\x8c\x89=27\xe2\x88\x9220=7. Your task is to find the maximum cost of some subarray (possibly empty) of array a." dp,greedy,math 1900
1145A "Thanos Sort" "Thanos sort is a supervillain sorting algorithm, which works as follows: if the array is not sorted, snap your fingers* to remove the first or the second half of the items, and repeat the process.Given an input array, what is the size of the longest sorted array you can obtain from it using Thanos sort?*Infinity Gauntlet required." implementation -999
51F Caterpillar "An undirected graph is called a caterpillar if it is a connected graph without cycles and it has such a path p that any vertex is located at a distance of at most 1 from the path p. The caterpillar can contain loops (edges from a vertex to itself) but cannot contain multiple (parallel) edges.The picture contains an example of a caterpillar:   You are given an undirected graph G. You are allowed to do a merging operations, each such operation merges two vertices into one vertex. For that two any vertices a and b (a\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89b) are chosen. These verteces are deleted together with their edges (which are incident to at least one of the vertices a or b) but a new vertex w is added together with edges (x,\xe2\x80\x89w) for each edge (a,\xe2\x80\x89w) and/or (b,\xe2\x80\x89w). If there was the edge (a,\xe2\x80\x89b) it transforms to the loop (w,\xe2\x80\x89w). The resulting graph (after the merging operation) may contain multiple (parallel) edges between pairs of vertices and loops. Let us note that this operation decreases the number of vertices of graph by 1 but leaves the number of edges in the graph unchanged.The merging operation can be informally described as a unity of two vertices of the graph into one with the natural transformation of the graph edges.You may apply this operation consecutively and make the given graph to be a caterpillar. Write a program that will print the minimal number of merging operations required to make the given graph a caterpillar." "dfs and similar,dp,graphs,trees" 2800
1952D "Are You a Procrastinator?" ! implementation -999
60C "Mushroom Strife" "Pasha and Akim were making a forest map \xe2\x80\x94 the lawns were the graph\'s vertexes and the roads joining the lawns were its edges. They decided to encode the number of laughy mushrooms on every lawn in the following way: on every edge between two lawns they wrote two numbers, the greatest common divisor (GCD) and the least common multiple (LCM) of the number of mushrooms on these lawns. But one day Pasha and Akim had an argument about the laughy mushrooms and tore the map. Pasha was left with just some part of it, containing only m roads. Your task is to help Pasha \xe2\x80\x94 use the map he has to restore the number of mushrooms on every lawn. As the result is not necessarily unique, help Pasha to restore any one or report that such arrangement of mushrooms does not exist. It is guaranteed that the numbers on the roads on the initial map were no less that 1 and did not exceed 106." "brute force,dfs and similar" 2100
1728G Illumination "Consider a segment [0,d] of the coordinate line. There are n lanterns and m points of interest in this segment.For each lantern, you can choose its power \xe2\x80\x94 an integer between 0 and d (inclusive). A lantern with coordinate x illuminates the point of interest with coordinate y if |x\xe2\x88\x92y| is less than or equal to the power of the lantern.A way to choose the power values for all lanterns is considered valid if every point of interest is illuminated by at least one lantern.You have to process q queries. Each query is represented by one integer fi. To answer the i-th query, you have to:  add a lantern on coordinate fi;  calculate the number of valid ways to assign power values to all lanterns, and print it modulo 998244353;  remove the lantern you just added." "binary search,bitmasks,brute force,combinatorics,dp,math,two pointers" 2700
1297F "Movie Fan" "Recently, Polycarp has been a fan of cinema novelties and is trying not to miss them!In the near future, n new movies will be released: the i-th of them will be airing from the day ai and to the day bi. This means that if Polycarp wants to watch the i-th movie in the cinema, he must do so in the period from ai to bi inclusive.If perhaps Polycarp will not have the opportunity to watch a movie in a cinema, he can then do it after day bi by watching it using an online service. Of course, this is an undesirable outcome for Polycarp because the whole world will have time to discuss this movie on social networks!Polycarp can watch no more than m movies per day. Help Polycarp find a movie-watching schedule such that every movie will be watched in the cinema. If such a schedule does not exist, then Polycarp wants to watch movies so that:  for each movie that he doesn\'t have time to watch in the cinema, we will find the number of days between the end of its airing and the day when Polycarpus watches the movie,  the maximum of the values from the previous point should be as small as possible." "*special problem,data structures,greedy,implementation,sortings" -999
58D Calendar "BerOilGasDiamondBank has branches in n cities, at that n is an even number. The bank management wants to publish a calendar with the names of all those cities written in two columns: the calendar should consist of exactly n\xe2\x80\x89/\xe2\x80\x892 lines of strictly equal length, each of which contains exactly two names and exactly one separator character between them. The name of every city should be used in the calendar exactly once. For historical reasons the symbol d is used as the separator of words in the calendar. The BerOilGasDiamondBank management wants to show that all its branches are equally important to it, that\'s why the order of their appearance in the calendar should be following: if we ""glue""(concatinate) all the n\xe2\x80\x89/\xe2\x80\x892 calendar lines (from top to bottom) to make a single line, then the lexicographically minimal line is obtained. No separator character will be used to separate calendar lines. For example, if the lines are ""bertown!berville"", ""newberville!bera"", then the resulting line is ""bertown!bervillenewberville!bera"". In some sense one has to find the lexicographically minimal calendar, where the comparison of calendars happens line by line.Help BerOilGasDiamondBank and construct the required calendar." greedy,strings 2000
863D "Yet Another Array Queries Problem" "You are given an array a of size n, and q queries to it. There are queries of two types:   1 li ri \xe2\x80\x94 perform a cyclic shift of the segment [li,\xe2\x80\x89ri] to the right. That is, for every x such that li\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89<\xe2\x80\x89ri new value of ax\xe2\x80\x89+\xe2\x80\x891 becomes equal to old value of ax, and new value of ali becomes equal to old value of ari;  2 li ri \xe2\x80\x94 reverse the segment [li,\xe2\x80\x89ri].  There are m important indices in the array b1, b2, ..., bm. For each i such that 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m you have to output the number that will have index bi in the array after all queries are performed." "data structures,implementation" 1800
1614D2 "Divan and Kostomuksha (hard version)" "This is the hard version of the problem. The only difference is maximum value of ai.Once in Kostomuksha Divan found an array a consisting of positive integers. Now he wants to reorder the elements of a to maximize the value of the following function: n\xe2\x88\x91i=1gcd(a1,a2,\xe2\x80\xa6,ai), where gcd(x1,x2,\xe2\x80\xa6,xk) denotes the greatest common divisor of integers x1,x2,\xe2\x80\xa6,xk, and gcd(x)=x for any integer x.Reordering elements of an array means changing the order of elements in the array arbitrary, or leaving the initial order.Of course, Divan can solve this problem. However, he found it interesting, so he decided to share it with you." "dp,number theory" 2300
793C "Mice problem" "Igor the analyst fell asleep on the work and had a strange dream. In the dream his desk was crowded with computer mice, so he bought a mousetrap to catch them.The desk can be considered as an infinite plane, then the mousetrap is a rectangle which sides are parallel to the axes, and which opposite sides are located in points (x1,\xe2\x80\x89y1) and (x2,\xe2\x80\x89y2).Igor wants to catch all mice. Igor has analysed their behavior and discovered that each mouse is moving along a straight line with constant speed, the speed of the i-th mouse is equal to (vix,\xe2\x80\x89viy), that means that the x coordinate of the mouse increases by vix units per second, while the y coordinates increases by viy units. The mousetrap is open initially so that the mice are able to move freely on the desk. Igor can close the mousetrap at any moment catching all the mice that are strictly inside the mousetrap.Igor works a lot, so he is busy in the dream as well, and he asks you to write a program that by given mousetrap\'s coordinates, the initial coordinates of the mice and their speeds determines the earliest time moment in which he is able to catch all the mice. Please note that Igor can close the mousetrap only once." geometry,implementation,math,sortings 2300
1927C "Choose the Different Ones!" "Given an array a of n integers, an array b of m integers, and an even number k.Your task is to determine whether it is possible to choose exactly k2 elements from both arrays in such a way that among the chosen elements, every integer from 1 to k is included.For example:  If a=[2,3,8,5,6,5], b=[1,3,4,10,5], k=6, then it is possible to choose elements with values 2,3,6 from array a and elements with values 1,4,5 from array b. In this case, all numbers from 1 to k=6 will be included among the chosen elements. If a=[2,3,4,5,6,5], b=[1,3,8,10,3], k=6, then it is not possible to choose elements in the required way. Note that you are not required to find a way to choose the elements \xe2\x80\x94 your program should only check whether it is possible to choose the elements in the required way." "brute force,greedy,math" 1000
1344B "Monopole Magnets" "A monopole magnet is a magnet that only has one pole, either north or south. They don\'t actually exist since real magnets have two poles, but this is a programming contest problem, so we don\'t care.There is an n\xc3\x97m grid. Initially, you may place some north magnets and some south magnets into the cells. You are allowed to place as many magnets as you like, even multiple in the same cell.An operation is performed as follows. Choose a north magnet and a south magnet to activate. If they are in the same row or the same column and they occupy different cells, then the north magnet moves one unit closer to the south magnet. Otherwise, if they occupy the same cell or do not share a row or column, then nothing changes. Note that the south magnets are immovable.Each cell of the grid is colored black or white. Let\'s consider ways to place magnets in the cells so that the following conditions are met.  There is at least one south magnet in every row and every column.  If a cell is colored black, then it is possible for a north magnet to occupy this cell after some sequence of operations from the initial placement.  If a cell is colored white, then it is impossible for a north magnet to occupy this cell after some sequence of operations from the initial placement. Determine if it is possible to place magnets such that these conditions are met. If it is possible, find the minimum number of north magnets required (there are no requirements on the number of south magnets)." "constructive algorithms,dfs and similar,dsu,graphs" 2000
1975D "Paint the Tree" "378QAQ has a tree with n vertices. Initially, all vertices are white. There are two chess pieces called PA and PB on the tree. PA and PB are initially located on vertices a and b respectively. In one step, 378QAQ will do the following in order:  Move PA to a neighboring vertex. If the target vertex is white, this vertex will be painted red.  Move PB to a neighboring vertex. If the target vertex is colored in red, this vertex will be painted blue. Initially, the vertex a is painted red. If a=b, the vertex a is painted blue instead. Note that both the chess pieces must be moved in each step. Two pieces can be on the same vertex at any given time.378QAQ wants to know the minimum number of steps to paint all vertices blue." "brute force,dfs and similar,dp,greedy,shortest paths,trees" 1700
875B "Sorting the Coins" "Recently, Dima met with Sasha in a philatelic store, and since then they are collecting coins together. Their favorite occupation is to sort collections of coins. Sasha likes having things in order, that is why he wants his coins to be arranged in a row in such a way that firstly come coins out of circulation, and then come coins still in circulation. For arranging coins Dima uses the following algorithm. One step of his algorithm looks like the following:  He looks through all the coins from left to right;  If he sees that the i-th coin is still in circulation, and (i\xe2\x80\x89+\xe2\x80\x891)-th coin is already out of circulation, he exchanges these two coins and continues watching coins from (i\xe2\x80\x89+\xe2\x80\x891)-th.  Dima repeats the procedure above until it happens that no two coins were exchanged during this procedure. Dima calls hardness of ordering the number of steps required for him according to the algorithm above to sort the sequence, e.g. the number of times he looks through the coins from the very beginning. For example, for the ordered sequence hardness of ordering equals one.Today Sasha invited Dima and proposed him a game. First he puts n coins in a row, all of them are out of circulation. Then Sasha chooses one of the coins out of circulation and replaces it with a coin in circulation for n times. During this process Sasha constantly asks Dima what is the hardness of ordering of the sequence. The task is more complicated because Dima should not touch the coins and he should determine hardness of ordering in his mind. Help Dima with this task." "dsu,implementation,sortings,two pointers" 1500
47B Coins "One day Vasya came across three Berland coins. They didn\'t have any numbers that\'s why Vasya didn\'t understand how their denominations differ. He supposed that if one coin is heavier than the other one, then it should be worth more. Vasya weighed all the three pairs of coins on pan balance scales and told you the results. Find out how the deminations of the coins differ or if Vasya has a mistake in the weighting results. No two coins are equal." implementation 1200
1943C "Tree Compass" "You are given a tree with n vertices numbered 1,2,\xe2\x80\xa6,n. Initially, all vertices are colored white.You can perform the following two-step operation:   Choose a vertex v (1\xe2\x89\xa4v\xe2\x89\xa4n) and a distance d (0\xe2\x89\xa4d\xe2\x89\xa4n\xe2\x88\x921).  For all vertices u (1\xe2\x89\xa4u\xe2\x89\xa4n) such that dist\xe2\x80\xa0(u,v)=d, color u black. Construct a sequence of operations to color all the nodes in the tree black using the minimum possible number of operations. It can be proven that it is always possible to do so using at most n operations.\xe2\x80\xa0 dist(x,y) denotes the number of edges on the (unique) simple path between vertices x and y on the tree." "constructive algorithms,dfs and similar,greedy,trees" 2300
309C "Memory for Arrays" "You get to work and turn on the computer. You start coding and give little thought to the RAM role in the whole process. In this problem your task is to solve one of the problems you encounter in your computer routine.We\'ll consider the RAM as a sequence of cells that can contain data. Some cells already contain some data, some are empty. The empty cells form the so-called memory clusters. Thus, a memory cluster is a sequence of some consecutive empty memory cells. You have exactly n memory clusters, the i-th cluster consists of ai cells. You need to find memory for m arrays in your program. The j-th array takes 2bj consecutive memory cells. There possibly isn\'t enough memory for all m arrays, so your task is to determine what maximum number of arrays can be located in the available memory clusters. Of course, the arrays cannot be divided between the memory clusters. Also, no cell can belong to two arrays." "binary search,bitmasks,greedy" 1900
292E "Copying Data" "We often have to copy large volumes of information. Such operation can take up many computer resources. Therefore, in this problem you are advised to come up with a way to copy some part of a number array into another one, quickly.More formally, you\'ve got two arrays of integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an and b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bn of length n. Also, you\'ve got m queries of two types:  Copy the subsegment of array a of length k, starting from position x, into array b, starting from position y, that is, execute by\xe2\x80\x89+\xe2\x80\x89q\xe2\x80\x89=\xe2\x80\x89ax\xe2\x80\x89+\xe2\x80\x89q for all integer q (0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89q\xe2\x80\x89<\xe2\x80\x89k). The given operation is correct \xe2\x80\x94 both subsegments do not touch unexistent elements.  Determine the value in position x of array b, that is, find value bx. For each query of the second type print the result \xe2\x80\x94 the value of the corresponding element of array b." "data structures" 1900
858B "Which floor?" "In a building where Polycarp lives there are equal number of flats on each floor. Unfortunately, Polycarp don\'t remember how many flats are on each floor, but he remembers that the flats are numbered from 1 from lower to upper floors. That is, the first several flats are on the first floor, the next several flats are on the second and so on. Polycarp don\'t remember the total number of flats in the building, so you can consider the building to be infinitely high (i.e. there are infinitely many floors). Note that the floors are numbered from 1.Polycarp remembers on which floors several flats are located. It is guaranteed that this information is not self-contradictory. It means that there exists a building with equal number of flats on each floor so that the flats from Polycarp\'s memory have the floors Polycarp remembers.Given this information, is it possible to restore the exact floor for flat n?" "brute force,implementation" 1500
1902A "Binary Imbalance" "You are given a string s, consisting only of characters \'0\' and/or \'1\'.In one operation, you choose a position i from 1 to |s|\xe2\x88\x921, where |s| is the current length of string s. Then you insert a character between the i-th and the (i+1)-st characters of s. If si=si+1, you insert \'1\'. If si\xe2\x89\xa0si+1, you insert \'0\'.Is it possible to make the number of zeroes in the string strictly greater than the number of ones, using any number of operations (possibly, none)?" "constructive algorithms" 800
1826A "Trust Nobody" "There is a group of n people. Some of them might be liars, who always tell lies. Other people always tell the truth. The i-th person says ""There are at least li liars amongst us"". Determine if what people are saying is contradictory, or if it is possible. If it is possible, output the number of liars in the group. If there are multiple possible answers, output any one of them." "brute force,greedy,implementation,sortings" 1200
1933B "Turtle Math: Fast Three Task" "You are given an array a1,a2,\xe2\x80\xa6,an.In one move, you can perform either of the following two operations:  Choose an element from the array and remove it from the array. As a result, the length of the array decreases by 1; Choose an element from the array and increase its value by 1. You can perform any number of moves. If the current array becomes empty, then no more moves can be made.Your task is to find the minimum number of moves required to make the sum of the elements of the array a divisible by 3. It is possible that you may need 0 moves.Note that the sum of the elements of an empty array (an array of length 0) is equal to 0." "implementation,math,number theory" 800
1264D1 "Beautiful Bracket Sequence (easy version)" "This is the easy version of this problem. The only difference is the limit of n - the length of the input string. In this version, 1\xe2\x89\xa4n\xe2\x89\xa42000. The hard version of this challenge is not offered in the round for the second division. Let\'s define a correct bracket sequence and its depth as follow:  An empty string is a correct bracket sequence with depth 0.  If ""s"" is a correct bracket sequence with depth d then ""(s)"" is a correct bracket sequence with depth d+1.  If ""s"" and ""t"" are both correct bracket sequences then their concatenation ""st"" is a correct bracket sequence with depth equal to the maximum depth of s and t. For a (not necessarily correct) bracket sequence s, we define its depth as the maximum depth of any correct bracket sequence induced by removing some characters from s (possibly zero). For example: the bracket sequence s=""())(())"" has depth 2, because by removing the third character we obtain a correct bracket sequence ""()(())"" with depth 2.Given a string a consists of only characters \'(\', \')\' and \'?\'. Consider all (not necessarily correct) bracket sequences obtained by replacing all characters \'?\' in a by either \'(\' or \')\'. Calculate the sum of all the depths of all these bracket sequences. As this number can be large, find it modulo 998244353.Hacks in this problem in the first division can be done only if easy and hard versions of this problem was solved." combinatorics,dp,probabilities 2600
265A "Colorful Stones (Simplified Edition)" "There is a sequence of colorful stones. The color of each stone is one of red, green, or blue. You are given a string s. The i-th (1-based) character of s represents the color of the i-th stone. If the character is ""R"", ""G"", or ""B"", the color of the corresponding stone is red, green, or blue, respectively.Initially Squirrel Liss is standing on the first stone. You perform instructions one or more times.Each instruction is one of the three types: ""RED"", ""GREEN"", or ""BLUE"". After an instruction c, if Liss is standing on a stone whose colors is c, Liss will move one stone forward, else she will not move.You are given a string t. The number of instructions is equal to the length of t, and the i-th character of t represents the i-th instruction.Calculate the final position of Liss (the number of the stone she is going to stand on in the end) after performing all the instructions, and print its 1-based position. It is guaranteed that Liss don\'t move out of the sequence." implementation 800
1111B "Average Superhero Gang Power" "Every superhero has been given a power value by the Felicity Committee. The avengers crew wants to maximize the average power of the superheroes in their team by performing certain operations.Initially, there are n superheroes in avengers team having powers a1,a2,\xe2\x80\xa6,an, respectively. In one operation, they can remove one superhero from their team (if there are at least two) or they can increase the power of a superhero by 1. They can do at most m operations. Also, on a particular superhero at most k operations can be done.Can you help the avengers team to maximize the average power of their crew?" "brute force,implementation,math" 1700
1657D "For Gamers. By Gamers." "Monocarp is playing a strategy game. In the game, he recruits a squad to fight monsters. Before each battle, Monocarp has C coins to spend on his squad.Before each battle starts, his squad is empty. Monocarp chooses one type of units and recruits no more units of that type than he can recruit with C coins.There are n types of units. Every unit type has three parameters:   ci \xe2\x80\x94 the cost of recruiting one unit of the i-th type;  di \xe2\x80\x94 the damage that one unit of the i-th type deals in a second;  hi \xe2\x80\x94 the amount of health of one unit of the i-th type. Monocarp has to face m monsters. Every monster has two parameters:   Dj \xe2\x80\x94 the damage that the j-th monster deals in a second;  Hj \xe2\x80\x94 the amount of health the j-th monster has. Monocarp has to fight only the j-th monster during the j-th battle. He wants all his recruited units to stay alive. Both Monocarp\'s squad and the monster attack continuously (not once per second) and at the same time. Thus, Monocarp wins the battle if and only if his squad kills the monster strictly faster than the monster kills one of his units. The time is compared with no rounding.For each monster, Monocarp wants to know the minimum amount of coins he has to spend to kill that monster. If this amount is greater than C, then report that it\'s impossible to kill that monster." "binary search,brute force,greedy,math,sortings" 2000
55D "Beautiful numbers" "Volodya is an odd boy and his taste is strange as well. It seems to him that a positive integer number is beautiful if and only if it is divisible by each of its nonzero digits. We will not argue with this and just count the quantity of beautiful numbers in given ranges." "dp,number theory" 2500
1151B "Dima and a Bad XOR" "Student Dima from Kremland has a matrix a of size n\xc3\x97m filled with non-negative integers.He wants to select exactly one integer from each row of the matrix so that the bitwise exclusive OR of the selected integers is strictly greater than zero. Help him!Formally, he wants to choose an integers sequence c1,c2,\xe2\x80\xa6,cn (1\xe2\x89\xa4cj\xe2\x89\xa4m) so that the inequality a1,c1\xe2\x8a\x95a2,c2\xe2\x8a\x95\xe2\x80\xa6\xe2\x8a\x95an,cn>0 holds, where ai,j is the matrix element from the i-th row and the j-th column.Here x\xe2\x8a\x95y denotes the bitwise XOR operation of integers x and y." "bitmasks,brute force,constructive algorithms,dp" 1600
252B "Unsorting Array" "Little Petya likes arrays of integers a lot. Recently his mother has presented him one such array consisting of n elements. Petya is now wondering whether he can swap any two distinct integers in the array so that the array got unsorted. Please note that Petya can not swap equal integers even if they are in distinct positions in the array. Also note that Petya must swap some two integers even if the original array meets all requirements.Array a (the array elements are indexed from 1) consisting of n elements is called sorted if it meets at least one of the following two conditions:  a1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89...\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89an;  a1\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89a2\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89...\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89an. Help Petya find the two required positions to swap or else say that they do not exist." "brute force,sortings" 1800
136A Presents "Little Petya very much likes gifts. Recently he has received a new laptop as a New Year gift from his mother. He immediately decided to give it to somebody else as what can be more pleasant than giving somebody gifts. And on this occasion he organized a New Year party at his place and invited n his friends there.If there\'s one thing Petya likes more that receiving gifts, that\'s watching others giving gifts to somebody else. Thus, he safely hid the laptop until the next New Year and made up his mind to watch his friends exchanging gifts while he does not participate in the process. He numbered all his friends with integers from 1 to n. Petya remembered that a friend number i gave a gift to a friend number pi. He also remembered that each of his friends received exactly one gift.Now Petya wants to know for each friend i the number of a friend who has given him a gift." implementation 800
1876F "Indefinite Clownfish" "Pak Chanek has just bought an empty fish tank and he has been dreaming to fill it with his favourite kind of fish, clownfish. Pak Chanek likes clownfish because of their ability to change their genders on demand. Because of the size of his fish tank, Pak Chanek wants to buy exactly k clownfish to fill the tank.Pak Chanek goes to the local fish shop. The shop provides n clownfish numbered from 1 to n, with clownfish i having a size of ai. Initially, every clownfish in the store does not have an assigned gender, but has the ability to be assigned to two possible clownfish genders, female or male.The store has a procedure which Pak Chanek should follow to buy clownfish. The shop owner will point at each clownfish sequentially from 1 to n and for each clownfish, she asks Pak Chanek whether to buy it or not. Each time Pak Chanek is asked, he must declare whether to buy the currently asked clownfish or not, before the shop owner moves on to the next clownfish. If Pak Chanek declares to buy the currently asked clownfish, he must also declare the gender to be assigned to that clownfish immediately. When assigning the gender for the currently asked clownfish, the following conditions must be satisfied:   If Pak Chanek assigns it to be female and he has bought a female clownfish before, then the size of the current one must be exactly 1 bigger than the last female one.  If Pak Chanek assigns it to be male and he has bought a male clownfish before, then the size of the current one must be exactly 1 smaller than the last male one. Pak Chanek wants to buy exactly k clownfish such that:   There is at least one female clownfish and one male clownfish.  Among the k clownfish Pak Chanek buys, the mean size of the female clownfish is equal to the mean size of the male clownfish. Let l and r respectively be the minimum and maximum index of a clownfish Pak Chanek buys. What is the minimum possible value of r\xe2\x88\x92l?" "binary search,graphs" 3500
913F "Strongly Connected Tournament" "There is a chess tournament in All-Right-City. n players were invited to take part in the competition. The tournament is held by the following rules:  Initially, each player plays one game with every other player. There are no ties;  After that, the organizers build a complete directed graph with players as vertices. For every pair of players there is exactly one directed edge between them: the winner of their game is the startpoint of this edge and the loser is the endpoint;  After that, the organizers build a condensation of this graph. The condensation of this graph is an acyclic complete graph, therefore it has the only Hamiltonian path which consists of strongly connected components of initial graph A1\xe2\x80\x89\xe2\x86\x92\xe2\x80\x89A2\xe2\x80\x89\xe2\x86\x92\xe2\x80\x89...\xe2\x80\x89\xe2\x86\x92\xe2\x80\x89Ak.  The players from the first component A1 are placed on the first  places, the players from the component A2 are placed on the next  places, and so on.  To determine exact place of each player in a strongly connected component, all the procedures from 1 to 5 are repeated recursively inside each component, i.e. for every i\xe2\x80\x89=\xe2\x80\x891,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89k players from the component Ai play games with each other again, and so on;  If a component consists of a single player, then he has no more rivals, his place is already determined and the process stops. The players are enumerated with integers from 1 to n. The enumeration was made using results of a previous tournament. It is known that player i wins player j (i\xe2\x80\x89<\xe2\x80\x89j) with probability p.You need to help to organize the tournament. Find the expected value of total number of games played by all the players. It can be shown that the answer can be represented as , where P and Q are coprime integers and . Print the value of P\xc2\xb7Q\xe2\x80\x89-\xe2\x80\x891 modulo 998244353.If you are not familiar with any of the terms above, you can read about them here." dp,graphs,math,probabilities 2800
748A "Santa Claus and a Place in a Class" "Santa Claus is the first who came to the Christmas Olympiad, and he is going to be the first to take his place at a desk! In the classroom there are n lanes of m desks each, and there are two working places at each of the desks. The lanes are numbered from 1 to n from the left to the right, the desks in a lane are numbered from 1 to m starting from the blackboard. Note that the lanes go perpendicularly to the blackboard, not along it (see picture).The organizers numbered all the working places from 1 to 2nm. The places are numbered by lanes (i. e. all the places of the first lane go first, then all the places of the second lane, and so on), in a lane the places are numbered starting from the nearest to the blackboard (i. e. from the first desk in the lane), at each desk, the place on the left is numbered before the place on the right.  The picture illustrates the first and the second samples. Santa Clause knows that his place has number k. Help him to determine at which lane at which desk he should sit, and whether his place is on the left or on the right!" implementation,math 800
2013F2 "Game in Tree (Hard Version)" "This is the hard version of the problem. In this version, it is not guaranteed that u=v. You can make hacks only if both versions of the problem are solved.Alice and Bob are playing a fun game on a tree. This game is played on a tree with n vertices, numbered from 1 to n. Recall that a tree with n vertices is an undirected connected graph with n\xe2\x88\x921 edges.Alice and Bob take turns, with Alice going first. Each player starts at some vertex.On their turn, a player must move from the current vertex to a neighboring vertex that has not yet been visited by anyone. The first player who cannot make a move loses.You are given two vertices u and v. Represent the simple path from vertex u to v as an array p1,p2,p3,\xe2\x80\xa6,pm, where p1=u, pm=v, and there is an edge between pi and pi+1 for all i (1\xe2\x89\xa4i<m).You need to determine the winner of the game if Alice starts at vertex 1 and Bob starts at vertex pj for each j (where 1\xe2\x89\xa4j\xe2\x89\xa4m)." "binary search,data structures,trees" 3500
61C "Capture Valerian" "It\'s now 260 AD. Shapur, being extremely smart, became the King of Persia. He is now called Shapur, His majesty King of kings of Iran and Aniran.Recently the Romans declared war on Persia. They dreamed to occupy Armenia. In the recent war, the Romans were badly defeated. Now their senior army general, Philip is captured by Shapur and Shapur is now going to capture Valerian, the Roman emperor.Being defeated, the cowardly Valerian hid in a room at the top of one of his castles. To capture him, Shapur has to open many doors. Fortunately Valerian was too scared to make impenetrable locks for the doors.Each door has 4 parts. The first part is an integer number a. The second part is either an integer number b or some really odd sign which looks like R. The third one is an integer c and the fourth part is empty! As if it was laid for writing something. Being extremely gifted, after opening the first few doors, Shapur found out the secret behind the locks.c is an integer written in base a, to open the door we should write it in base b. The only bad news is that this R is some sort of special numbering system that is used only in Roman empire, so opening the doors is not just a piece of cake!Here\'s an explanation of this really weird number system that even doesn\'t have zero:Roman numerals are based on seven symbols: a stroke (identified with the letter I) for a unit, a chevron (identified with the letter V) for a five, a cross-stroke (identified with the letter X) for a ten, a C (identified as an abbreviation of Centum) for a hundred, etc.: I=1 V=5 X=10 L=50 C=100 D=500 M=1000Symbols are iterated to produce multiples of the decimal (1, 10, 100, 1,\xe2\x80\x89000) values, with V, L, D substituted for a multiple of five, and the iteration continuing: I 1, II 2, III 3, V 5, VI 6, VII 7, etc., and the same for other bases: X 10, XX 20, XXX 30, L 50, LXXX 80; CC 200, DCC 700, etc. At the fourth and ninth iteration, a subtractive principle must be employed, with the base placed before the higher base: IV 4, IX 9, XL 40, XC 90, CD 400, CM 900.Also in bases greater than 10 we use A for 10, B for 11, etc.Help Shapur capture Valerian and bring peace back to Persia, especially Armenia." math 2000
570B "Simple Game" "One day Misha and Andrew were playing a very simple game. First, each player chooses an integer in the range from 1 to n. Let\'s assume that Misha chose number m, and Andrew chose number a.Then, by using a random generator they choose a random integer c in the range between 1 and n (any integer from 1 to n is chosen with the same probability), after which the winner is the player, whose number was closer to c. The boys agreed that if m and a are located on the same distance from c, Misha wins.Andrew wants to win very much, so he asks you to help him. You know the number selected by Misha, and number n. You need to determine which value of a Andrew must choose, so that the probability of his victory is the highest possible.More formally, you need to find such integer a (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n), that the probability that  is maximal, where c is the equiprobably chosen integer from 1 to n (inclusive)." "constructive algorithms,games,greedy,implementation,math" 1300
625C "K-special Tables" "People do many crazy things to stand out in a crowd. Some of them dance, some learn by heart rules of Russian language, some try to become an outstanding competitive programmers, while others collect funny math objects.Alis is among these collectors. Right now she wants to get one of k-special tables. In case you forget, the table n\xe2\x80\x89\xc3\x97\xe2\x80\x89n is called k-special if the following three conditions are satisfied:  every integer from 1 to n2 appears in the table exactly once;  in each row numbers are situated in increasing order;  the sum of numbers in the k-th column is maximum possible. Your goal is to help Alice and find at least one k-special table of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89n. Both rows and columns are numbered from 1 to n, with rows numbered from top to bottom and columns numbered from left to right." "constructive algorithms,implementation" 1300
666A "Reberland Linguistics" "First-rate specialists graduate from Berland State Institute of Peace and Friendship. You are one of the most talented students in this university. The education is not easy because you need to have fundamental knowledge in different areas, which sometimes are not related to each other. For example, you should know linguistics very well. You learn a structure of Reberland language as foreign language. In this language words are constructed according to the following rules. First you need to choose the ""root"" of the word \xe2\x80\x94 some string which has more than 4 letters. Then several strings with the length 2 or 3 symbols are appended to this word. The only restriction \xe2\x80\x94  it is not allowed to append the same string twice in a row. All these strings are considered to be suffixes of the word (this time we use word ""suffix"" to describe a morpheme but not the few last characters of the string as you may used to). Here is one exercise that you have found in your task list. You are given the word s. Find all distinct strings with the length 2 or 3, which can be suffixes of this word according to the word constructing rules in Reberland language. Two strings are considered distinct if they have different length or there is a position in which corresponding characters do not match. Let\'s look at the example: the word abacabaca is given. This word can be obtained in the following ways: , where the root of the word is overlined, and suffixes are marked by ""corners"". Thus, the set of possible suffixes for this word is {aca,\xe2\x80\x89ba,\xe2\x80\x89ca}." dp,implementation,strings 1800
1328E "Tree Queries" "You are given a rooted tree consisting of n vertices numbered from 1 to n. The root of the tree is a vertex number 1.A tree is a connected undirected graph with n\xe2\x88\x921 edges.You are given m queries. The i-th query consists of the set of ki distinct vertices vi[1],vi[2],\xe2\x80\xa6,vi[ki]. Your task is to say if there is a path from the root to some vertex u such that each of the given k vertices is either belongs to this path or has the distance 1 to some vertex of this path." "dfs and similar,graphs,trees" 1900
1806C "Sequence Master" "For some positive integer m, YunQian considers an array q of 2m (possibly negative) integers good, if and only if for every possible subsequence of q that has length m, the product of the m elements in the subsequence is equal to the sum of the m elements that are not in the subsequence. Formally, let U={1,2,\xe2\x80\xa6,2m}. For all sets S\xe2\x8a\x86U such that |S|=m, \xe2\x88\x8fi\xe2\x88\x88Sqi=\xe2\x88\x91i\xe2\x88\x88U\xe2\x88\x96Sqi.Define the distance between two arrays a and b both of length k to be k\xe2\x88\x91i=1|ai\xe2\x88\x92bi|.You are given a positive integer n and an array p of 2n integers.Find the minimum distance between p and q over all good arrays q of length 2n. It can be shown for all positive integers n, at least one good array exists. Note that you are not required to construct the array q that achieves this minimum distance." "brute force,constructive algorithms,math" 1600
1922F "Replace on Segment" "You are given an array a1,a2,\xe2\x80\xa6,an, where each element is an integer from 1 to x.You can perform the following operation with it any number of times:  choose three integers l, r and k such that 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n, 1\xe2\x89\xa4k\xe2\x89\xa4x and each element ai such that l\xe2\x89\xa4i\xe2\x89\xa4r is different from k. Then, for each i\xe2\x88\x88[l,r], replace ai with k. In other words, you choose a subsegment of the array and an integer from 1 to x which does not appear in that subsegment, and replace every element in the subsegment with that chosen integer.Your goal is to make all elements in the array equal. What is the minimum number of operations that you have to perform?" "dp,graph matchings" 2500
1401E "Divide Square" "There is a square of size 106\xc3\x97106 on the coordinate plane with four points (0,0), (0,106), (106,0), and (106,106) as its vertices.You are going to draw segments on the plane. All segments are either horizontal or vertical and intersect with at least one side of the square.Now you are wondering how many pieces this square divides into after drawing all segments. Write a program calculating the number of pieces of the square." "data structures,geometry,implementation,sortings" 2400
1715A Crossmarket "Stanley and Megan decided to shop in the ""Crossmarket"" grocery store, which can be represented as a matrix with n rows and m columns. Stanley and Megan can move to an adjacent cell using 1 unit of power. Two cells are considered adjacent if they share an edge. To speed up the shopping process, Megan brought her portals with her, and she leaves one in each cell she visits (if there is no portal yet). If a person (Stanley or Megan) is in a cell with a portal, that person can use 1 unit of power to teleport to any other cell with a portal, including Megan\'s starting cell.They decided to split up: Stanley will go from the upper-left cell (cell with coordinates (1,1)) to the lower-right cell (cell with coordinates (n,m)), whilst Megan needs to get from the lower-left cell (cell with coordinates (n,1)) to the upper-right cell (cell with coordinates (1,m)).What is the minimum total energy needed for them both to do that?Note that they can choose the time they move. Time does not affect energy." "constructive algorithms,greedy,math" 800
1266E "Spaceship Solitaire" "Bob is playing a game of Spaceship Solitaire. The goal of this game is to build a spaceship. In order to do this, he first needs to accumulate enough resources for the construction. There are n types of resources, numbered 1 through n. Bob needs at least ai pieces of the i-th resource to build the spaceship. The number ai is called the goal for resource i.Each resource takes 1 turn to produce and in each turn only one resource can be produced. However, there are certain milestones that speed up production. Every milestone is a triple (sj,tj,uj), meaning that as soon as Bob has tj units of the resource sj, he receives one unit of the resource uj for free, without him needing to spend a turn. It is possible that getting this free resource allows Bob to claim reward for another milestone. This way, he can obtain a large number of resources in a single turn.The game is constructed in such a way that there are never two milestones that have the same sj and tj, that is, the award for reaching tj units of resource sj is at most one additional resource.A bonus is never awarded for 0 of any resource, neither for reaching the goal ai nor for going past the goal \xe2\x80\x94 formally, for every milestone 0<tj<asj.A bonus for reaching certain amount of a resource can be the resource itself, that is, sj=uj.Initially there are no milestones. You are to process q updates, each of which adds, removes or modifies a milestone. After every update, output the minimum number of turns needed to finish the game, that is, to accumulate at least ai of i-th resource for each i\xe2\x88\x88[1,n]." "data structures,greedy,implementation" 2100
1485A "Add and Divide" "You have two positive integers a and b.You can perform two kinds of operations:  a=\xe2\x8c\x8aab\xe2\x8c\x8b (replace a with the integer part of the division between a and b)  b=b+1 (increase b by 1) Find the minimum number of operations required to make a=0." "brute force,greedy,math,number theory" 1000
427D "Match & Catch" "Police headquarter is monitoring signal on different frequency levels. They have got two suspiciously encoded strings s1 and s2 from two different frequencies as signals. They are suspecting that these two strings are from two different criminals and they are planning to do some evil task.Now they are trying to find a common substring of minimum length between these two strings. The substring must occur only once in the first string, and also it must occur only once in the second string.Given two strings s1 and s2 consist of lowercase Latin letters, find the smallest (by length) common substring p of both s1 and s2, where p is a unique substring in s1 and also in s2. See notes for formal definition of substring and uniqueness." "dp,string suffix structures,strings" 2200
435A "Queue on Bus Stop" "It\'s that time of the year when the Russians flood their countryside summer cottages (dachas) and the bus stop has a lot of people. People rarely go to the dacha on their own, it\'s usually a group, so the people stand in queue by groups.The bus stop queue has n groups of people. The i-th group from the beginning has ai people. Every 30 minutes an empty bus arrives at the bus stop, it can carry at most m people. Naturally, the people from the first group enter the bus first. Then go the people from the second group and so on. Note that the order of groups in the queue never changes. Moreover, if some group cannot fit all of its members into the current bus, it waits for the next bus together with other groups standing after it in the queue.Your task is to determine how many buses is needed to transport all n groups to the dacha countryside." implementation 1000
528D "Fuzzy Search" "Leonid works for a small and promising start-up that works on decoding the human genome. His duties include solving complex problems of finding certain patterns in long strings consisting of letters \'A\', \'T\', \'G\' and \'C\'.Let\'s consider the following scenario. There is a fragment of a human DNA chain, recorded as a string S. To analyze the fragment, you need to find all occurrences of string T in a string S. However, the matter is complicated by the fact that the original chain fragment could contain minor mutations, which, however, complicate the task of finding a fragment. Leonid proposed the following approach to solve this problem.Let\'s write down integer k\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x890 \xe2\x80\x94 the error threshold. We will say that string T occurs in string S on position i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|S|\xe2\x80\x89-\xe2\x80\x89|T|\xe2\x80\x89+\xe2\x80\x891), if after putting string T along with this position, each character of string T corresponds to the some character of the same value in string S at the distance of at most k. More formally, for any j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|T|) there must exist such p (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89p\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|S|), that |(i\xe2\x80\x89+\xe2\x80\x89j\xe2\x80\x89-\xe2\x80\x891)\xe2\x80\x89-\xe2\x80\x89p|\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k and S[p]\xe2\x80\x89=\xe2\x80\x89T[j].For example, corresponding to the given definition, string ""ACAT"" occurs in string ""AGCAATTCAT"" in positions 2, 3 and 6.  Note that at k\xe2\x80\x89=\xe2\x80\x890 the given definition transforms to a simple definition of the occurrence of a string in a string.Help Leonid by calculating in how many positions the given string T occurs in the given string S with the given error threshold." "bitmasks,brute force,fft" 2500
1461F "Mathematical Expression" "Barbara was late for her math class so as a punishment the teacher made her solve the task on a sheet of paper. Barbara looked at the sheet of paper and only saw n numbers a1,a2,\xe2\x80\xa6,an without any mathematical symbols. The teacher explained to Barbara that she has to place the available symbols between the numbers in a way that would make the resulting expression\'s value as large as possible. To find out which symbols were available the teacher has given Barbara a string s which contained that information.  It\'s easy to notice that Barbara has to place n\xe2\x88\x921 symbols between numbers in total. The expression must start with a number and all symbols must be allowed (i.e. included in s). Note that multiplication takes precedence over addition or subtraction, addition and subtraction have the same priority and performed from left to right. Help Barbara and create the required expression!" "constructive algorithms,dp,greedy" 2700
1031A "Golden Plate" "You have a plate and you want to add some gilding to it. The plate is a rectangle that we split into w\xc3\x97h cells. There should be k gilded rings, the first one should go along the edge of the plate, the second one \xe2\x80\x94 2 cells away from the edge and so on. Each ring has a width of 1 cell. Formally, the i-th of these rings should consist of all bordering cells on the inner rectangle of size (w\xe2\x88\x924(i\xe2\x88\x921))\xc3\x97(h\xe2\x88\x924(i\xe2\x88\x921)).  The picture corresponds to the third example. Your task is to compute the number of cells to be gilded." implementation,math 800
1146H "Satanic Panic" "You are given a set of n points in a 2D plane. No three points are collinear.A pentagram is a set of 5 points A,B,C,D,E that can be arranged as follows.  Note the length of the line segments don\'t matter, only that those particular intersections exist.Count the number of ways to choose 5 points from the given set that form a pentagram." dp,geometry 2900
1096B "Substring Removal" "You are given a string s of length n consisting only of lowercase Latin letters.A substring of a string is a contiguous subsequence of that string. So, string ""forces"" is substring of string ""codeforces"", but string ""coder"" is not.Your task is to calculate the number of ways to remove exactly one substring from this string in such a way that all remaining characters are equal (the number of distinct characters either zero or one).It is guaranteed that there is at least two different characters in s.Note that you can remove the whole string and it is correct. Also note that you should remove at least one character.Since the answer can be rather large (not very large though) print it modulo 998244353.If you are Python programmer, consider using PyPy instead of Python when you submit your code." combinatorics,math,strings 1300
736D Permutations "Ostap Bender is worried that people started to forget that he is the Great Combinator. Now he wants to show them his skills in combinatorics. Now he studies the permutations of length n. He has a list of m valid pairs, pair ai and bi means that he is allowed to place integers bi at position ai.He knows that the number of permutations that use only valid pairs is odd. Now, for each pair he wants to find out, will the number of valid permutations be odd if he removes this pair (and only it) from the list." math,matrices 2800
1419E Decryption "An agent called Cypher is decrypting a message, that contains a composite number n. All divisors of n, which are greater than 1, are placed in a circle. Cypher can choose the initial order of numbers in the circle.In one move Cypher can choose two adjacent numbers in a circle and insert their least common multiple between them. He can do that move as many times as needed.A message is decrypted, if every two adjacent numbers are not coprime. Note that for such constraints it\'s always possible to decrypt the message.Find the minimal number of moves that Cypher should do to decrypt the message, and show the initial order of numbers in the circle for that." "constructive algorithms,implementation,math,number theory" 2100
172D "Calendar Reform" "Reforms have started in Berland again! At this time, the Parliament is discussing the reform of the calendar. To make the lives of citizens of Berland more varied, it was decided to change the calendar. As more and more people are complaining that ""the years fly by..."", it was decided that starting from the next year the number of days per year will begin to grow. So the coming year will have exactly a days, the next after coming year will have a\xe2\x80\x89+\xe2\x80\x891 days, the next one will have a\xe2\x80\x89+\xe2\x80\x892 days and so on. This schedule is planned for the coming n years (in the n-th year the length of the year will be equal a\xe2\x80\x89+\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x891 day).No one has yet decided what will become of months. An MP Palevny made the following proposal.   The calendar for each month is comfortable to be printed on a square sheet of paper. We are proposed to make the number of days in each month be the square of some integer. The number of days per month should be the same for each month of any year, but may be different for different years.  The number of days in each year must be divisible by the number of days per month in this year. This rule ensures that the number of months in each year is an integer.  The number of days per month for each year must be chosen so as to save the maximum amount of paper to print the calendars. In other words, the number of days per month should be as much as possible. These rules provide an unambiguous method for choosing the number of days in each month for any given year length. For example, according to Palevny\'s proposition, a year that consists of 108 days will have three months, 36 days each. The year that consists of 99 days will have 11 months, 9 days each, and a year of 365 days will have 365 months, one day each.The proposal provoked heated discussion in the community, the famous mathematician Perelmanov quickly calculated that if the proposal is supported, then in a period of n years, beginning with the year that has a days, the country will spend p sheets of paper to print a set of calendars for these years. Perelmanov\'s calculations take into account the fact that the set will contain one calendar for each year and each month will be printed on a separate sheet.Repeat Perelmanov\'s achievement and print the required number p. You are given positive integers a and n. Perelmanov warns you that your program should not work longer than four seconds at the maximum test." "*special problem,number theory" 1500
710B "Optimal Point on a Line" "You are given n points on a line with their coordinates xi. Find the point x so the sum of distances to the given points is minimal." "brute force,sortings" 1400
1814D "Balancing Weapons" "You\'ve got a job in a game studio that developed an online shooter, and your first big task is to help to balance weapons. The game has n weapons: the i-th gun has an integer fire rate fi and an integer damage per bullet di. The i-th gun\'s total firepower is equal to pi=fi\xe2\x8b\x85di.You have to modify the values di of some guns in such a way that the new values di will still be integers, and the firepower of all guns will become balanced. Given an integer k, the guns are said to be balanced if max1\xe2\x89\xa4i\xe2\x89\xa4npi\xe2\x88\x92min1\xe2\x89\xa4i\xe2\x89\xa4npi\xe2\x89\xa4k.Since gamers that play your game don\'t like big changes, you need to change the values di for the minimum possible number of guns. What is the minimum number of guns for which you have to change these values to make the guns balanced?Note that the new values di must be integers greater than 0." "binary search,brute force,data structures,math,two pointers" 2500
878B "Teams Formation" "This time the Berland Team Olympiad in Informatics is held in a remote city that can only be reached by one small bus. Bus has n passenger seats, seat i can be occupied only by a participant from the city ai.Today the bus has completed m trips, each time bringing n participants. The participants were then aligned in one line in the order they arrived, with people from the same bus standing in the order of their seats (i. e. if we write down the cities where the participants came from, we get the sequence a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an repeated m times).After that some teams were formed, each consisting of k participants form the same city standing next to each other in the line. Once formed, teams left the line. The teams were formed until there were no k neighboring participants from the same city.Help the organizers determine how many participants have left in the line after that process ended. We can prove that answer doesn\'t depend on the order in which teams were selected." "data structures,implementation" 2300
116A Tram "Linear Kingdom has exactly one tram line. It has n stops, numbered from 1 to n in the order of tram\'s movement. At the i-th stop ai passengers exit the tram, while bi passengers enter it. The tram is empty before it arrives at the first stop. Also, when the tram arrives at the last stop, all passengers exit so that it becomes empty.Your task is to calculate the tram\'s minimum capacity such that the number of people inside the tram at any time never exceeds this capacity. Note that at each stop all exiting passengers exit before any entering passenger enters the tram." implementation 800
160E "Buses and People" "The main Bertown street is represented by a straight line. There are 109 bus stops located on the line. The stops are numbered with integers from 1 to 109 in the order in which they follow on the road. The city has n buses. Every day the i-th bus drives from stop number si to stop number fi (si\xe2\x80\x89<\xe2\x80\x89fi), it stops on all intermediate stops and returns only at night. The bus starts driving at time ti and drives so fast that it finishes driving also at time ti. The time ti is different for all buses. The buses have infinite capacity.Bertown has m citizens. Today the i-th person should get from stop number li to stop number ri (li\xe2\x80\x89<\xe2\x80\x89ri); the i-th citizen comes to his initial stop (li) at time bi. Each person, on the one hand, wants to get to the destination point as quickly as possible, and on the other hand, definitely does not want to change the buses as he rides. More formally: the i-th person chooses bus j, with minimum time tj, such that sj\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89li, ri\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89fj and bi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89tj. Your task is to determine for each citizen whether he can ride to the destination point today and if he can, find the number of the bus on which the citizen will ride." "binary search,data structures,sortings" 2400
1508E "Tree Calendar" "Yuu Koito and Touko Nanami are newlyweds! On the wedding day, Yuu gifted Touko a directed tree with n nodes and rooted at 1, and a labeling a which is some DFS order of the tree. Every edge in this tree is directed away from the root.After calling dfs(1) the following algorithm returns a as a DFS order of a tree rooted at 1 :order := 0a := array of length n function dfs(u):    order := order + 1    a[u] := order    for all v such that there is a directed edge (u -> v):        dfs(v)Note that there may be different DFS orders for a given tree.Touko likes the present so much she decided to play with it! On each day following the wedding day, Touko performs this procedure once: Among all directed edges u\xe2\x86\x92v such that au<av, select the edge u\xe2\x80\xb2\xe2\x86\x92v\xe2\x80\xb2 with the lexicographically smallest pair (au\xe2\x80\xb2,av\xe2\x80\xb2).  Swap au\xe2\x80\xb2 and av\xe2\x80\xb2.Days have passed since their wedding, and Touko has somehow forgotten which date the wedding was and what was the original labeling a! Fearing that Yuu might get angry, Touko decided to ask you to derive these two pieces of information using the current labeling.Being her good friend, you need to find the number of days that have passed since the wedding, and the original labeling of the tree. However, there is a chance that Touko might have messed up her procedures, which result in the current labeling being impossible to obtain from some original labeling; in that case, please inform Touko as well." "brute force,constructive algorithms,data structures,dfs and similar,sortings,trees" 3100
1797F "Li Hua and Path" "Li Hua has a tree of n vertices and n\xe2\x88\x921 edges. The vertices are numbered from 1 to n.A pair of vertices (u,v) (u<v) is considered cute if exactly one of the following two statements is true:  u is the vertex with the minimum index among all vertices on the path (u,v).  v is the vertex with the maximum index among all vertices on the path (u,v).There will be m operations. In each operation, he decides an integer kj, then inserts a vertex numbered n+j to the tree, connecting with the vertex numbered kj.He wants to calculate the number of cute pairs before operations and after each operation.Suppose you were Li Hua, please solve this problem." "data structures,dfs and similar,divide and conquer,dsu,trees" 3000
420A "Start Up" "Recently, a start up by two students of a state university of city F gained incredible popularity. Now it\'s time to start a new company. But what do we call it?The market analysts came up with a very smart plan: the name of the company should be identical to its reflection in a mirror! In other words, if we write out the name of the company on a piece of paper in a line (horizontally, from left to right) with large English letters, then put this piece of paper in front of the mirror, then the reflection of the name in the mirror should perfectly match the line written on the piece of paper.There are many suggestions for the company name, so coming up to the mirror with a piece of paper for each name wouldn\'t be sensible. The founders of the company decided to automatize this process. They asked you to write a program that can, given a word, determine whether the word is a \'mirror\' word or not." implementation 1000
1326C "Permutation Partitions" "You are given a permutation p1,p2,\xe2\x80\xa6,pn of integers from 1 to n and an integer k, such that 1\xe2\x89\xa4k\xe2\x89\xa4n. A permutation means that every number from 1 to n is contained in p exactly once.Let\'s consider all partitions of this permutation into k disjoint segments. Formally, a partition is a set of segments {[l1,r1],[l2,r2],\xe2\x80\xa6,[lk,rk]}, such that:  1\xe2\x89\xa4li\xe2\x89\xa4ri\xe2\x89\xa4n for all 1\xe2\x89\xa4i\xe2\x89\xa4k;  For all 1\xe2\x89\xa4j\xe2\x89\xa4n there exists exactly one segment [li,ri], such that li\xe2\x89\xa4j\xe2\x89\xa4ri. Two partitions are different if there exists a segment that lies in one partition but not the other.Let\'s calculate the partition value, defined as k\xe2\x88\x91i=1maxli\xe2\x89\xa4j\xe2\x89\xa4ripj, for all possible partitions of the permutation into k disjoint segments. Find the maximum possible partition value over all such partitions, and the number of partitions with this value. As the second value can be very large, you should find its remainder when divided by 998244353." combinatorics,greedy,math 1300
1487F Ones "You are given a positive (greater than zero) integer n.You have to represent n as the sum of integers (possibly negative) consisting only of ones (digits \'1\'). For example, 24=11+11+1+1 and 102=111\xe2\x88\x9211+1+1. Among all possible representations, you have to find the one that uses the minimum number of ones in total." "dp,greedy,shortest paths" 2900
2009D "Satyam and Counting" "Satyam is given n distinct points on the 2D coordinate plane. It is guaranteed that 0\xe2\x89\xa4yi\xe2\x89\xa41 for all given points (xi,yi). How many different nondegenerate right triangles\xe2\x88\x97 can be formed from choosing three different points as its vertices?Two triangles a and b are different if there is a point v such that v is a vertex of a but not a vertex of b.\xe2\x88\x97A nondegenerate right triangle has positive area and an interior 90\xe2\x88\x98 angle." geometry,math 1400
59C Title "Vasya has recently finished writing a book. Now he faces the problem of giving it the title. Vasya wants the title to be vague and mysterious for his book to be noticeable among others. That\'s why the title should be represented by a single word containing at least once each of the first k Latin letters and not containing any other ones. Also, the title should be a palindrome, that is it should be read similarly from the left to the right and from the right to the left.Vasya has already composed the approximate variant of the title. You are given the title template s consisting of lowercase Latin letters and question marks. Your task is to replace all the question marks by lowercase Latin letters so that the resulting word satisfies the requirements, described above. Each question mark should be replaced by exactly one letter, it is not allowed to delete characters or add new ones to the template. If there are several suitable titles, choose the first in the alphabetical order, for Vasya\'s book to appear as early as possible in all the catalogues." "expression parsing" 1600
286D Tourists "A double tourist path, located at a park in Ultima Thule, is working by the following principle:  We introduce the Cartesian coordinate system.  At some points of time there are two tourists going (for a walk) from points (\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x890) and (1,\xe2\x80\x890) simultaneously. The first one is walking from (\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x890), the second one is walking from (1,\xe2\x80\x890).  Both tourists in a pair move at the same speed 1 (distance unit per second), the first one moves along line x\xe2\x80\x89=\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x891, the second one moves along line x\xe2\x80\x89=\xe2\x80\x891, both of them are moving in the positive direction of the Oy axis.  At some points of time walls appear. Wall (li,\xe2\x80\x89ri) is a segment between points (0,\xe2\x80\x89li) and (0,\xe2\x80\x89ri). Each wall appears immediately. The Ultima Thule government wants to learn this for each pair of tourists that walk simultaneously: for how long (in seconds) will they not see each other? Two tourists don\'t see each other if the segment that connects their positions on the plane intersects at least one wall. Two segments intersect if they share at least one point. We assume that the segments\' ends belong to the segments.Help the government count the required time. Note that the walls can intersect (in any way) or coincide." "data structures,sortings" 2600
1001B "Generate Bell state" "You are given two qubits in state  and an integer index. Your task is to create one of the Bell states on them according to the index:" "*special problem" 1400
1353B "Two Arrays And Swaps" "You are given two arrays a and b both consisting of n positive (greater than zero) integers. You are also given an integer k.In one move, you can choose two indices i and j (1\xe2\x89\xa4i,j\xe2\x89\xa4n) and swap ai and bj (i.e. ai becomes bj and vice versa). Note that i and j can be equal or different (in particular, swap a2 with b2 or swap a3 and b9 both are acceptable moves).Your task is to find the maximum possible sum you can obtain in the array a if you can do no more than (i.e. at most) k such moves (swaps).You have to answer t independent test cases." greedy,sortings 800
432E "Square Tiling" "You have an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m rectangle table, its cells are not initially painted. Your task is to paint all cells of the table. The resulting picture should be a tiling of the table with squares. More formally:  each cell must be painted some color (the colors are marked by uppercase Latin letters);  we will assume that two cells of the table are connected if they are of the same color and share a side; each connected region of the table must form a square. Given n and m, find lexicographically minimum coloring of the table that meets the described properties." "constructive algorithms,greedy" 2300
334B "Eight Point Sets" "Gerald is very particular to eight point sets. He thinks that any decent eight point set must consist of all pairwise intersections of three distinct integer vertical straight lines and three distinct integer horizontal straight lines, except for the average of these nine points. In other words, there must be three integers x1,\xe2\x80\x89x2,\xe2\x80\x89x3 and three more integers y1,\xe2\x80\x89y2,\xe2\x80\x89y3, such that x1\xe2\x80\x89<\xe2\x80\x89x2\xe2\x80\x89<\xe2\x80\x89x3, y1\xe2\x80\x89<\xe2\x80\x89y2\xe2\x80\x89<\xe2\x80\x89y3 and the eight point set consists of all points (xi,\xe2\x80\x89yj) (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i,\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x893), except for point (x2,\xe2\x80\x89y2).You have a set of eight points. Find out if Gerald can use this set?" sortings 1400
1055B "Alice and Hairdresser" "Alice\'s hair is growing by leaps and bounds. Maybe the cause of it is the excess of vitamins, or maybe it is some black magic...To prevent this, Alice decided to go to the hairdresser. She wants for her hair length to be at most l centimeters after haircut, where l is her favorite number. Suppose, that the Alice\'s head is a straight line on which n hairlines grow. Let\'s number them from 1 to n. With one swing of the scissors the hairdresser can shorten all hairlines on any segment to the length l, given that all hairlines on that segment had length strictly greater than l. The hairdresser wants to complete his job as fast as possible, so he will make the least possible number of swings of scissors, since each swing of scissors takes one second.Alice hasn\'t decided yet when she would go to the hairdresser, so she asked you to calculate how much time the haircut would take depending on the time she would go to the hairdresser. In particular, you need to process queries of two types:  0 \xe2\x80\x94 Alice asks how much time the haircut would take if she would go to the hairdresser now.  1 p d \xe2\x80\x94 p-th hairline grows by d centimeters. Note, that in the request 0 Alice is interested in hypothetical scenario of taking a haircut now, so no hairlines change their length." dsu,implementation 1300
1488I "Demonic Invasion" "Dalaran is a flying city of magic. It consists of n floating islands connected by m bridges (each bridge can be traversed in both directions). Every island is reachable from every other along these bridges. It would be a shame if some magic experiment went horribly wrong and this magnificent city got destroyed, right?Well, just guess what happened. A portal to demons\' realm was opened at the island 1. This is the start of day 1 of the catastrophe, and all k mages have gathered at the island 1 (they were trying to close the portal, but found out that it was impossible). At the start of day 2, a gigantic horde of demons will emerge from the portal, capture the island 1 and kill every mage staying at that island. During each day i, if the island v was captured by demons by the start of the day, the horde of demons will travel across all bridges connected directly to v, capture every island they reach, and kill every mage they meet along the way.Each bridge contains exactly one magic stone. Each mage at the start of the day can do one of the following actions:  Spend one day travelling along one of the bridges connected to the island where the mage currently is. When passing through a bridge, the mage can pick up the magic stone from it (if there is any; each magic stone can be picked up by at most one mage). If the bridge is passed by the demons during the same day, or by the start of the next day, the island where the mage goes is already captured by the demonic horde (even if they arrive there at the same moment), the mage is killed.  Perform a teleportation ritual to get to safety outside Dalaran. This ritual consumes two magic stones (and cannot be performed if the mage has less than two stones). Each magic stone decays in 2 days, so if is picked up in the middle of day i, it decays in the middle of day i+2. Decayed stones cannot be used in teleportation ritual.Calculate the maximum number of mages that can get to safety." "*special problem,flows" 3100
990F "Flow Control" "You have to handle a very complex water distribution system. The system consists of n junctions and m pipes, i-th pipe connects junctions xi and yi.The only thing you can do is adjusting the pipes. You have to choose m integer numbers f1, f2, ..., fm and use them as pipe settings. i-th pipe will distribute fi units of water per second from junction xi to junction yi (if fi is negative, then the pipe will distribute |fi| units of water per second from junction yi to junction xi). It is allowed to set fi to any integer from \xe2\x88\x922\xe2\x8b\x85109 to 2\xe2\x8b\x85109.In order for the system to work properly, there are some constraints: for every i\xe2\x88\x88[1,n], i-th junction has a number si associated with it meaning that the difference between incoming and outcoming flow for i-th junction must be exactly si (if si is not negative, then i-th junction must receive si units of water per second; if it is negative, then i-th junction must transfer |si| units of water per second to other junctions).Can you choose the integers f1, f2, ..., fm in such a way that all requirements on incoming and outcoming flows are satisfied?" "dfs and similar,dp,greedy,trees" 2400
533D Landmarks "We have an old building with n\xe2\x80\x89+\xe2\x80\x892 columns in a row. These columns support the ceiling. These columns are located in points with coordinates 0\xe2\x80\x89=\xe2\x80\x89x0\xe2\x80\x89<\xe2\x80\x89x1\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89xn\xe2\x80\x89<\xe2\x80\x89xn\xe2\x80\x89+\xe2\x80\x891. The leftmost and the rightmost columns are special, we will call them bearing, the other columns are ordinary. For each column we know its durability di. Let\'s consider an ordinary column with coordinate x. Let\'s assume that the coordinate of the closest to it column to the left (bearing or ordinary) is a and the coordinate of the closest to it column to the right (also, bearing or ordinary) is b. In this task let\'s assume that this column supports the segment of the ceiling from point  to point  (here both fractions are considered as real division). If the length of the segment of the ceiling supported by the column exceeds di, then the column cannot support it and it crashes after a while, and after that the load is being redistributeed between the neighbouring columns according to the same principle.  Thus, ordinary columns will be crashing for some time until the process stops at some state. One can prove that the set of the remaining columns doesn\'t depend on the order in which columns crash. If there are only two bearing columns left in the end, then we assume that the whole construction crashes under the weight of the roof. But if at least one ordinary column stays in addition to the bearing ones, then the building doesn\'t crash.To make the building stronger, we can add one extra ordinary column of arbitrary durability d\' at any (not necessarily integer) point 0\xe2\x80\x89<\xe2\x80\x89x\'\xe2\x80\x89<\xe2\x80\x89xn\xe2\x80\x89+\xe2\x80\x891. If point x\' is already occupied by an ordinary column, it is replaced by a new one.Your task is to find out: what minimal durability can the added column have so that the building doesn\'t crash?" "data structures,dp" 3000
1415B "Repainting Street" "There is a street with n houses in a line, numbered from 1 to n. The house i is initially painted in color ci. The street is considered beautiful if all houses are painted in the same color. Tom, the painter, is in charge of making the street beautiful. Tom\'s painting capacity is defined by an integer, let\'s call it k.On one day, Tom can do the following repainting process that consists of two steps:   He chooses two integers l and r such that 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n and r\xe2\x88\x92l+1=k.  For each house i such that l\xe2\x89\xa4i\xe2\x89\xa4r, he can either repaint it with any color he wants, or ignore it and let it keep its current color. Note that in the same day Tom can use different colors to repaint different houses.Tom wants to know the minimum number of days needed to repaint the street so that it becomes beautiful." "brute force,brute force,greedy" 1100
120C "Winnie-the-Pooh and honey" "As we all know, Winnie-the-Pooh just adores honey. Ones he and the Piglet found out that the Rabbit has recently gotten hold of an impressive amount of this sweet and healthy snack. As you may guess, Winnie and the Piglet asked to come at the Rabbit\'s place. Thus, there are n jars of honey lined up in front of Winnie-the-Pooh, jar number i contains ai kilos of honey. Winnie-the-Pooh eats the honey like that: each time he chooses a jar containing most honey. If the jar has less that k kilos of honey or if Winnie-the-Pooh has already eaten from it three times, he gives the jar to Piglet. Otherwise he eats exactly k kilos of honey from the jar and puts it back. Winnie does so until he gives all jars to the Piglet. Count how much honey Piglet will overall get after Winnie satisfies his hunger." implementation,math 1100
1523A "Game of Life" "William really likes the cellular automaton called ""Game of Life"" so he decided to make his own version. For simplicity, William decided to define his cellular automaton on an array containing n cells, with each cell either being alive or dead.Evolution of the array in William\'s cellular automaton occurs iteratively in the following way:  If the element is dead and it has exactly 1 alive neighbor in the current state of the array, then on the next iteration it will become alive. For an element at index i the neighbors would be elements with indices i\xe2\x88\x921 and i+1. If there is no element at that index, it is considered to be a dead neighbor.  William is a humane person so all alive elements stay alive. Check the note section for examples of the evolution.You are given some initial state of all elements and you need to help William find the state of the array after m iterations of evolution." implementation 800
676A "Nicholas and Permutation" "Nicholas has an array a that contains n distinct integers from 1 to n. In other words, Nicholas has a permutation of size n.Nicholas want the minimum element (integer 1) and the maximum element (integer n) to be as far as possible from each other. He wants to perform exactly one swap in order to maximize the distance between the minimum and the maximum elements. The distance between two elements is considered to be equal to the absolute difference between their positions." "constructive algorithms,implementation" 800
1592F2 "Alice and Recoloring 2" "The difference between the versions is in the costs of operations. Solution for one version won\'t work for another!Alice has a grid of size n\xc3\x97m, initially all its cells are colored white. The cell on the intersection of i-th row and j-th column is denoted as (i,j). Alice can do the following operations with this grid:Choose any subrectangle containing cell (1,1), and flip the colors of all its cells. (Flipping means changing its color from white to black or from black to white). This operation costs 1 coin.Choose any subrectangle containing cell (n,1), and flip the colors of all its cells. This operation costs 3 coins.Choose any subrectangle containing cell (1,m), and flip the colors of all its cells. This operation costs 4 coins.Choose any subrectangle containing cell (n,m), and flip the colors of all its cells. This operation costs 2 coins. As a reminder, subrectangle is a set of all cells (x,y) with x1\xe2\x89\xa4x\xe2\x89\xa4x2, y1\xe2\x89\xa4y\xe2\x89\xa4y2 for some 1\xe2\x89\xa4x1\xe2\x89\xa4x2\xe2\x89\xa4n, 1\xe2\x89\xa4y1\xe2\x89\xa4y2\xe2\x89\xa4m.Alice wants to obtain her favorite coloring with these operations. What\'s the smallest number of coins that she would have to spend? It can be shown that it\'s always possible to transform the initial grid into any other." "constructive algorithms,flows,graph matchings,greedy" 2800
148E Porcelain "During her tantrums the princess usually smashes some collectable porcelain. Every furious shriek is accompanied with one item smashed.The collection of porcelain is arranged neatly on n shelves. Within each shelf the items are placed in one row, so that one can access only the outermost items \xe2\x80\x94 the leftmost or the rightmost item, not the ones in the middle of the shelf. Once an item is taken, the next item on that side of the shelf can be accessed (see example). Once an item is taken, it can\'t be returned to the shelves.You are given the values of all items. Your task is to find the maximal damage the princess\' tantrum of m shrieks can inflict on the collection of porcelain." dp 1900
2008A "Sakurako\'s Exam" "Today, Sakurako has a math exam. The teacher gave the array, consisting of a ones and b twos.In an array, Sakurako must place either a \'+\' or a \'-\' in front of each element so that the sum of all elements in the array equals 0.Sakurako is not sure if it is possible to solve this problem, so determine whether there is a way to assign signs such that the sum of all elements in the array equals 0." "brute force,constructive algorithms,greedy,math" 800
709A Juicer "Kolya is going to make fresh orange juice. He has n oranges of sizes a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. Kolya will put them in the juicer in the fixed order, starting with orange of size a1, then orange of size a2 and so on. To be put in the juicer the orange must have size not exceeding b, so if Kolya sees an orange that is strictly greater he throws it away and continues with the next one.The juicer has a special section to collect waste. It overflows if Kolya squeezes oranges of the total size strictly greater than d. When it happens Kolya empties the waste section (even if there are no more oranges) and continues to squeeze the juice. How many times will he have to empty the waste section?" implementation 900
1517A "Sum of 2050" "A number is called 2050-number if it is 2050, 20500, ..., (2050\xe2\x8b\x8510k for integer k\xe2\x89\xa50).Given a number n, you are asked to represent n as the sum of some (not necessarily distinct) 2050-numbers. Compute the minimum number of 2050-numbers required for that." greedy,math 800
958B2 "Maximum Control (medium)" "The Resistance is trying to take control over as many planets of a particular solar system as possible. Princess Heidi is in charge of the fleet, and she must send ships to some planets in order to maximize the number of controlled planets.The Galaxy contains N planets, connected by bidirectional hyperspace tunnels in such a way that there is a unique path between every pair of the planets.A planet is controlled by the Resistance if there is a Resistance ship in its orbit, or if the planet lies on the shortest path between some two planets that have Resistance ships in their orbits.Heidi has not yet made up her mind as to how many ships to use. Therefore, she is asking you to compute, for every K\xe2\x80\x89=\xe2\x80\x891,\xe2\x80\x892,\xe2\x80\x893,\xe2\x80\x89...,\xe2\x80\x89N, the maximum number of planets that can be controlled with a fleet consisting of K ships." "data structures,dfs and similar,graphs,greedy,trees" 2200
459C "Pashmak and Buses" "Recently Pashmak has been employed in a transportation company. The company has k buses and has a contract with a school which has n students. The school planned to take the students to d different places for d days (each day in one place). Each day the company provides all the buses for the trip. Pashmak has to arrange the students in the buses. He wants to arrange the students in a way that no two students become close friends. In his ridiculous idea, two students will become close friends if and only if they are in the same buses for all d days.Please help Pashmak with his weird idea. Assume that each bus has an unlimited capacity." "combinatorics,constructive algorithms,math" 1900
93E Lostborn "Igor K. very much likes a multiplayer role playing game WineAge II. Who knows, perhaps, that might be the reason for his poor performance at the university. As any person who plays the game, he is interested in equipping his hero with as good weapon and outfit as possible. One day, as he was reading the game\'s forum yet again, he discovered a very interesting fact. As it turns out, each weapon in the game is characterised with k different numbers: a1,\xe2\x80\x89...,\xe2\x80\x89ak. They are called hit indicators and according to the game developers\' plan they are pairwise coprime. The damage that is inflicted during a hit depends not only on the weapon\'s characteristics, but also on the hero\'s strength parameter. Thus, if the hero\'s strength equals n, than the inflicted damage will be calculated as the number of numbers on the segment , that aren\'t divisible by any hit indicator ai.Recently, having fulfilled another quest, Igor K. found a new Lostborn sword. He wants to know how much damage he will inflict upon his enemies if he uses it." "dp,math,number theory" 2600
1437A "Marketing Scheme" "You got a job as a marketer in a pet shop, and your current task is to boost sales of cat food. One of the strategies is to sell cans of food in packs with discounts. Suppose you decided to sell packs with a cans in a pack with a discount and some customer wants to buy x cans of cat food. Then he follows a greedy strategy:   he buys \xe2\x8c\x8axa\xe2\x8c\x8b packs with a discount;  then he wants to buy the remaining (xmoda) cans one by one. \xe2\x8c\x8axa\xe2\x8c\x8b is x divided by a rounded down, xmoda is the remainer of x divided by a.But customers are greedy in general, so if the customer wants to buy (xmoda) cans one by one and it happens that (xmoda)\xe2\x89\xa5a2 he decides to buy the whole pack of a cans (instead of buying (xmoda) cans). It makes you, as a marketer, happy since the customer bought more than he wanted initially.You know that each of the customers that come to your shop can buy any number of cans from l to r inclusive. Can you choose such size of pack a that each customer buys more cans than they wanted initially?" "brute force,constructive algorithms,greedy,math" 800
1103C "Johnny Solving" "Today is tuesday, that means there is a dispute in JOHNNY SOLVING team again: they try to understand who is Johnny and who is Solving. That\'s why guys asked Umnik to help them. Umnik gave guys a connected graph with n vertices without loops and multiedges, such that a degree of any vertex is at least 3, and also he gave a number 1\xe2\x89\xa4k\xe2\x89\xa4n. Because Johnny is not too smart, he promised to find a simple path with length at least nk in the graph. In reply, Solving promised to find k simple by vertices cycles with representatives, such that:   Length of each cycle is at least 3.  Length of each cycle is not divisible by 3.  In each cycle must be a representative - vertex, which belongs only to this cycle among all printed cycles. You need to help guys resolve the dispute, for that you need to find a solution for Johnny: a simple path with length at least nk (n is not necessarily divided by k), or solution for Solving: k cycles that satisfy all the conditions above. If there is no any solution - print \xe2\x88\x921." "constructive algorithms,dfs and similar,graphs,math" 2700
1669C "Odd/Even Increments" "Given an array a=[a1,a2,\xe2\x80\xa6,an] of n positive integers, you can do operations of two types on it:  Add 1 to every element with an odd index. In other words change the array as follows: a1:=a1+1,a3:=a3+1,a5:=a5+1,\xe2\x80\xa6.  Add 1 to every element with an even index. In other words change the array as follows: a2:=a2+1,a4:=a4+1,a6:=a6+1,\xe2\x80\xa6.Determine if after any number of operations it is possible to make the final array contain only even numbers or only odd numbers. In other words, determine if you can make all elements of the array have the same parity after any number of operations.Note that you can do operations of both types any number of times (even none). Operations of different types can be performed a different number of times." greedy,greedy,implementation,math 800
1858E2 "Rollbacks (Hard Version)" "This is a hard version of this problem. The only difference between the versions is that you have to solve the hard version in online mode. You can make hacks only if both versions of the problem are solved.You have an array a, which is initially empty. You need to process queries of the following types:  + x \xe2\x80\x94 add the integer x to the end of the array a.  - k \xe2\x80\x94 remove the last k numbers from the array a.  ! \xe2\x80\x94 roll back the last active change (i.e., make the array a the way it was before the change). In this problem, only queries of the first two types (+ and -) are considered as changes.  ? \xe2\x80\x94 find the number of distinct numbers in the array a." "data structures,interactive,trees" 2600
1488J "Flower Shop" "Your friend is running a flower shop. In order to be prepared for the next holidays (when, as usual, sales skyrocket) she asked you to write her a special program that will help to analyze the stocks she has.There are n different types of flowers she can order and each flower of the type i costs wi. The last holidays were a great success, she sold all flowers she had, so right now all her stocks are empty.From this point, she starts routine operations of ordering and selling flowers, while trying to analyze what she has at hand. All of this can be represented as m queries of three types:   ""1 i c"" \xe2\x80\x94 she bought c flowers of type i;  ""2 i c"" \xe2\x80\x94 she disposed of c flowers of type i;  ""3 l r k"" \xe2\x80\x94 how many variants of bouquets she can make using only flowers of types l,l+1,\xe2\x80\xa6,r with the total cost no more than k. For simplicity, you can think that a bouquet is a multiset of flowers, and two bouquets are different if they are different as multisets. The cost of a bouquet is the sum of all flowers it has. Help your friend and write the program that can process all these queries." "*special problem,data structures,fft,math" 3100
1725B "Basketball Together" "A basketball competition is held where the number of players in a team does not have a maximum or minimum limit (not necessarily 5 players in one team for each match). There are N candidate players in the competition that will be trained by Pak Chanek, the best basketball coach on earth. The i-th candidate player has a power of Pi.Pak Chanek will form zero or more teams from the N candidate players on the condition that each candidate player may only join in at most one team. Each of Pak Chanek\'s teams will be sent to compete once with an enemy team that has a power of D. In each match, the team sent is said to defeat the enemy team if the sum of powers from the formed players is strictly greater than D.One of Pak Chanek\'s skills is that when a team that has been formed plays in a match, he can change the power of each player in the team to be equal to the biggest player power from the team.Determine the maximum number of wins that can be achieved by Pak Chanek." "binary search,greedy,sortings" 1000
1770F "Koxia and Sequence" "Mari has three integers n, x, and y.Call an array a of n non-negative integers good if it satisfies the following conditions:  a1+a2+\xe2\x80\xa6+an=x, and  a1|a2|\xe2\x80\xa6|an=y, where | denotes the bitwise OR operation. The score of a good array is the value of a1\xe2\x8a\x95a2\xe2\x8a\x95\xe2\x80\xa6\xe2\x8a\x95an, where \xe2\x8a\x95 denotes the bitwise XOR operation.Koxia wants you to find the total bitwise XOR of the scores of all good arrays. If there are no good arrays, output 0 instead." "bitmasks,combinatorics,dp,math,number theory" 3100
359C "Prime Number" "Simon has a prime number x and an array of non-negative integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an.Simon loves fractions very much. Today he wrote out number  on a piece of paper. After Simon led all fractions to a common denominator and summed them up, he got a fraction: , where number t equals xa1\xe2\x80\x89+\xe2\x80\x89a2\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89an. Now Simon wants to reduce the resulting fraction. Help him, find the greatest common divisor of numbers s and t. As GCD can be rather large, print it as a remainder after dividing it by number 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." "math,number theory" 1900
624A "Save Luke" "Luke Skywalker got locked up in a rubbish shredder between two presses. R2D2 is already working on his rescue, but Luke needs to stay alive as long as possible. For simplicity we will assume that everything happens on a straight line, the presses are initially at coordinates 0 and L, and they move towards each other with speed v1 and v2, respectively. Luke has width d and is able to choose any position between the presses. Luke dies as soon as the distance between the presses is less than his width. Your task is to determine for how long Luke can stay alive." math 800
18B Platforms "In one one-dimensional world there are n platforms. Platform with index k (platforms are numbered from 1) is a segment with coordinates [(k\xe2\x80\x89-\xe2\x80\x891)m,\xe2\x80\x89(k\xe2\x80\x89-\xe2\x80\x891)m\xe2\x80\x89+\xe2\x80\x89l], and l\xe2\x80\x89<\xe2\x80\x89m. Grasshopper Bob starts to jump along the platforms from point 0, with each jump he moves exactly d units right. Find out the coordinate of the point, where Bob will fall down. The grasshopper falls down, if he finds himself not on the platform, but if he finds himself on the edge of the platform, he doesn\'t fall down." "brute force,math" 1700
1716B "Permutation Chain" "A permutation of length n is a sequence of integers from 1 to n such that each integer appears in it exactly once.Let the fixedness of a permutation p be the number of fixed points in it \xe2\x80\x94 the number of positions j such that pj=j, where pj is the j-th element of the permutation p.You are asked to build a sequence of permutations a1,a2,\xe2\x80\xa6, starting from the identity permutation (permutation a1=[1,2,\xe2\x80\xa6,n]). Let\'s call it a permutation chain. Thus, ai is the i-th permutation of length n.For every i from 2 onwards, the permutation ai should be obtained from the permutation ai\xe2\x88\x921 by swapping any two elements in it (not necessarily neighboring). The fixedness of the permutation ai should be strictly lower than the fixedness of the permutation ai\xe2\x88\x921.Consider some chains for n=3:  a1=[1,2,3], a2=[1,3,2] \xe2\x80\x94 that is a valid chain of length 2. From a1 to a2, the elements on positions 2 and 3 get swapped, the fixedness decrease from 3 to 1.  a1=[2,1,3], a2=[3,1,2] \xe2\x80\x94 that is not a valid chain. The first permutation should always be [1,2,3] for n=3.  a1=[1,2,3], a2=[1,3,2], a3=[1,2,3] \xe2\x80\x94 that is not a valid chain. From a2 to a3, the elements on positions 2 and 3 get swapped but the fixedness increase from 1 to 3.  a1=[1,2,3], a2=[3,2,1], a3=[3,1,2] \xe2\x80\x94 that is a valid chain of length 3. From a1 to a2, the elements on positions 1 and 3 get swapped, the fixedness decrease from 3 to 1. From a2 to a3, the elements on positions 2 and 3 get swapped, the fixedness decrease from 1 to 0. Find the longest permutation chain. If there are multiple longest answers, print any of them." "constructive algorithms,math" 800
1726D "Edge Split" "You are given a connected, undirected and unweighted graph with n vertices and m edges. Notice the limit on the number of edges: m\xe2\x89\xa4n+2.Let\'s say we color some of the edges red and the remaining edges blue. Now consider only the red edges and count the number of connected components in the graph. Let this value be c1. Similarly, consider only the blue edges and count the number of connected components in the graph. Let this value be c2.Find an assignment of colors to the edges such that the quantity c1+c2 is minimised." "brute force,constructive algorithms,dfs and similar,dsu,graphs,probabilities,trees" 2000
1625D "Binary Spiders" "Binary Spiders are species of spiders that live on Mars. These spiders weave their webs to defend themselves from enemies.To weave a web, spiders join in pairs. If the first spider in pair has x legs, and the second spider has y legs, then they weave a web with durability x\xe2\x8a\x95y. Here, \xe2\x8a\x95 means bitwise XOR.Binary Spiders live in large groups. You observe a group of n spiders, and the i-th spider has ai legs.When the group is threatened, some of the spiders become defenders. Defenders are chosen in the following way. First, there must be at least two defenders. Second, any pair of defenders must be able to weave a web with durability at least k. Third, there must be as much defenders as possible.Scientists have researched the behaviour of Binary Spiders for a long time, and now they have a hypothesis that they can always choose the defenders in an optimal way, satisfying the conditions above. You need to verify this hypothesis on your group of spiders. So, you need to understand how many spiders must become defenders. You are not a Binary Spider, so you decided to use a computer to solve this problem." "bitmasks,data structures,implementation,math,sortings,trees" 2300
1566A "Median Maximization" "You are given two positive integers n and s. Find the maximum possible median of an array of n non-negative integers (not necessarily distinct), such that the sum of its elements is equal to s.A median of an array of integers of length m is the number standing on the \xe2\x8c\x88m2\xe2\x8c\x89-th (rounding up) position in the non-decreasing ordering of its elements. Positions are numbered starting from 1. For example, a median of the array [20,40,20,50,50,30] is the \xe2\x8c\x88m2\xe2\x8c\x89-th element of [20,20,30,40,50,50], so it is 30. There exist other definitions of the median, but in this problem we use the described definition." "binary search,greedy,math" 800
1628A "Meximum Array" "Mihai has just learned about the MEX concept and since he liked it so much, he decided to use it right away.Given an array a of n non-negative integers, Mihai wants to create a new array b that is formed in the following way:While a is not empty:   Choose an integer k (1\xe2\x89\xa4k\xe2\x89\xa4|a|).  Append the MEX of the first k numbers of the array a to the end of array b and erase them from the array a, shifting the positions of the remaining numbers in a. But, since Mihai loves big arrays as much as the MEX concept, he wants the new array b to be the lexicographically maximum. So, Mihai asks you to tell him what the maximum array b that can be created by constructing the array optimally is.An array x is lexicographically greater than an array y if in the first position where x and y differ xi>yi or if |x|>|y| and y is a prefix of x (where |x| denotes the size of the array x).The MEX of a set of non-negative integers is the minimal non-negative integer such that it is not in the set. For example, MEX({1,2,3}) =0 and MEX({0,1,2,4,5}) =3." "binary search,constructive algorithms,greedy,implementation,math,two pointers" 1400
1744A "Number Replacement" "An integer array a1,a2,\xe2\x80\xa6,an is being transformed into an array of lowercase English letters using the following prodecure:While there is at least one number in the array:   Choose any number x from the array a, and any letter of the English alphabet y.  Replace all occurrences of number x with the letter y. For example, if we initially had an array a=[2,3,2,4,1], then we could transform it the following way:  Choose the number 2 and the letter c. After that a=[c,3,c,4,1].  Choose the number 3 and the letter a. After that a=[c,a,c,4,1].  Choose the number 4 and the letter t. After that a=[c,a,c,t,1].  Choose the number 1 and the letter a. After that a=[c,a,c,t,a]. After the transformation all letters are united into a string, in our example we get the string ""cacta"".Having the array a and the string s determine if the string s could be got from the array a after the described transformation?" greedy,implementation 800
1969A "Two Friends" "Monocarp wants to throw a party. He has n friends, and he wants to have at least 2 of them at his party.The i-th friend\'s best friend is pi. All pi are distinct, and for every i\xe2\x88\x88[1,n], pi\xe2\x89\xa0i.Monocarp can send invitations to friends. The i-th friend comes to the party if both the i-th friend and the pi-th friend receive an invitation (note that the pi-th friend doesn\'t have to actually come to the party). Each invitation is sent to exactly one of the friends.For example, if p=[3,1,2,5,4], and Monocarp sends invitations to the friends [1,2,4,5], then the friends [2,4,5] will come to the party. The friend 1 won\'t come since his best friend didn\'t receive an invitation; the friend 3 won\'t come since he didn\'t receive an invitation.Calculate the minimum number of invitations Monocarp has to send so that at least 2 friends come to the party." "constructive algorithms,implementation,math" 800
47C Crossword "Vasya trains to compose crossword puzzles. He can only compose crosswords of a very simpl\xd0\xb5 type so far. All of them consist of exactly six words; the words can be read only from top to bottom vertically and from the left to the right horizontally. The words are arranged in the form of a rectangular ""eight"" or infinity sign, not necessarily symmetrical.The top-left corner of the crossword coincides with the top-left corner of the rectangle. The same thing is correct for the right-bottom corners. The crossword can\'t degrade, i.e. it always has exactly four blank areas, two of which are surrounded by letters. Look into the output for the samples for clarification.Help Vasya \xe2\x80\x94 compose a crossword of the described type using the given six words. It is allowed to use the words in any order." implementation 2000
1809D "Binary String Sorting" "You are given a binary string s consisting of only characters 0 and/or 1.You can perform several operations on this string (possibly zero). There are two types of operations:   choose two consecutive elements and swap them. In order to perform this operation, you pay 1012 coins;  choose any element from the string and remove it. In order to perform this operation, you pay 1012+1 coins. Your task is to calculate the minimum number of coins required to sort the string s in non-decreasing order (i.\xe2\x80\x89e. transform s so that s1\xe2\x89\xa4s2\xe2\x89\xa4\xe2\x8b\xaf\xe2\x89\xa4sm, where m is the length of the string after applying all operations). An empty string is also considered sorted in non-decreasing order." "constructive algorithms,greedy" 1800
1948D "Tandem Repeats?" "You are given a string s, consisting of lowercase Latin letters and/or question marks.A tandem repeat is a string of an even length such that its first half is equal to its second half.A string a is a substring of a string b if a can be obtained from b by the deletion of several (possibly, zero or all) characters from the beginning and several (possibly, zero or all) characters from the end.Your goal is to replace each question mark with some lowercase Latin letter in such a way that the length of the longest substring that is a tandem repeat is maximum possible." "brute force,strings,two pointers" 1700
929B "\xd0\x9c\xd0\xb5\xd1\x81\xd1\x82\xd0\xb0 \xd0\xb2 \xd1\x81\xd0\xb0\xd0\xbc\xd0\xbe\xd0\xbb\xd1\x91\xd1\x82\xd0\xb5" "\xd0\x92 \xd1\x81\xd0\xb0\xd0\xbc\xd0\xbe\xd0\xbb\xd1\x91\xd1\x82\xd0\xb5 \xd0\xb5\xd1\x81\xd1\x82\xd1\x8c n \xd1\x80\xd1\x8f\xd0\xb4\xd0\xbe\xd0\xb2 \xd0\xbc\xd0\xb5\xd1\x81\xd1\x82. \xd0\x95\xd1\x81\xd0\xbb\xd0\xb8 \xd1\x81\xd0\xbc\xd0\xbe\xd1\x82\xd1\x80\xd0\xb5\xd1\x82\xd1\x8c \xd0\xbd\xd0\xb0 \xd1\x80\xd1\x8f\xd0\xb4\xd1\x8b \xd1\x81\xd0\xb2\xd0\xb5\xd1\x80\xd1\x85\xd1\x83, \xd1\x82\xd0\xbe \xd0\xb2 \xd0\xba\xd0\xb0\xd0\xb6\xd0\xb4\xd0\xbe\xd0\xbc \xd1\x80\xd1\x8f\xd0\xb4\xd1\x83 \xd0\xb5\xd1\x81\xd1\x82\xd1\x8c 3 \xd0\xbc\xd0\xb5\xd1\x81\xd1\x82\xd0\xb0 \xd1\x81\xd0\xbb\xd0\xb5\xd0\xb2\xd0\xb0, \xd0\xb7\xd0\xb0\xd1\x82\xd0\xb5\xd0\xbc \xd0\xbf\xd1\x80\xd0\xbe\xd1\x85\xd0\xbe\xd0\xb4 \xd0\xbc\xd0\xb5\xd0\xb6\xd0\xb4\xd1\x83 \xd1\x80\xd1\x8f\xd0\xb4\xd0\xb0\xd0\xbc\xd0\xb8, \xd0\xb7\xd0\xb0\xd1\x82\xd0\xb5\xd0\xbc 4 \xd1\x86\xd0\xb5\xd0\xbd\xd1\x82\xd1\x80\xd0\xb0\xd0\xbb\xd1\x8c\xd0\xbd\xd1\x8b\xd1\x85 \xd0\xbc\xd0\xb5\xd1\x81\xd1\x82\xd0\xb0, \xd0\xb7\xd0\xb0\xd1\x82\xd0\xb5\xd0\xbc \xd0\xb5\xd1\x89\xd1\x91 \xd0\xbe\xd0\xb4\xd0\xb8\xd0\xbd \xd0\xbf\xd1\x80\xd0\xbe\xd1\x85\xd0\xbe\xd0\xb4 \xd0\xbc\xd0\xb5\xd0\xb6\xd0\xb4\xd1\x83 \xd1\x80\xd1\x8f\xd0\xb4\xd0\xb0\xd0\xbc\xd0\xb8, \xd0\xb0 \xd0\xb7\xd0\xb0\xd1\x82\xd0\xb5\xd0\xbc \xd0\xb5\xd1\x89\xd1\x91 3 \xd0\xbc\xd0\xb5\xd1\x81\xd1\x82\xd0\xb0 \xd1\x81\xd0\xbf\xd1\x80\xd0\xb0\xd0\xb2\xd0\xb0.\xd0\x98\xd0\xb7\xd0\xb2\xd0\xb5\xd1\x81\xd1\x82\xd0\xbd\xd0\xbe, \xd1\x87\xd1\x82\xd0\xbe \xd0\xbd\xd0\xb5\xd0\xba\xd0\xbe\xd1\x82\xd0\xbe\xd1\x80\xd1\x8b\xd0\xb5 \xd0\xbc\xd0\xb5\xd1\x81\xd1\x82\xd0\xb0 \xd1\x83\xd0\xb6\xd0\xb5 \xd0\xb7\xd0\xb0\xd0\xbd\xd1\x8f\xd1\x82\xd1\x8b \xd0\xbf\xd0\xb0\xd1\x81\xd1\x81\xd0\xb0\xd0\xb6\xd0\xb8\xd1\x80\xd0\xb0\xd0\xbc\xd0\xb8. \xd0\x92\xd1\x81\xd0\xb5\xd0\xb3\xd0\xbe \xd0\xb5\xd1\x81\xd1\x82\xd1\x8c \xd0\xb4\xd0\xb2\xd0\xb0 \xd0\xb2\xd0\xb8\xd0\xb4\xd0\xb0 \xd0\xbf\xd0\xb0\xd1\x81\xd1\x81\xd0\xb0\xd0\xb6\xd0\xb8\xd1\x80\xd0\xbe\xd0\xb2 \xe2\x80\x94 \xd1\x81\xd1\x82\xd0\xb0\xd1\x82\xd1\x83\xd1\x81\xd0\xbd\xd1\x8b\xd0\xb5 (\xd1\x82\xd0\xb5, \xd0\xba\xd0\xbe\xd1\x82\xd0\xbe\xd1\x80\xd1\x8b\xd0\xb5 \xd1\x87\xd0\xb0\xd1\x81\xd1\x82\xd0\xbe \xd0\xbb\xd0\xb5\xd1\x82\xd0\xb0\xd1\x8e\xd1\x82) \xd0\xb8 \xd0\xbe\xd0\xb1\xd1\x8b\xd1\x87\xd0\xbd\xd1\x8b\xd0\xb5. \xd0\x9f\xd0\xb5\xd1\x80\xd0\xb5\xd0\xb4 \xd0\xb2\xd0\xb0\xd0\xbc\xd0\xb8 \xd1\x81\xd1\x82\xd0\xbe\xd0\xb8\xd1\x82 \xd0\xb7\xd0\xb0\xd0\xb4\xd0\xb0\xd1\x87\xd0\xb0 \xd1\x80\xd0\xb0\xd1\x81\xd1\x81\xd0\xb0\xd0\xb4\xd0\xb8\xd1\x82\xd1\x8c \xd0\xb5\xd1\x89\xd1\x91 k \xd0\xbe\xd0\xb1\xd1\x8b\xd1\x87\xd0\xbd\xd1\x8b\xd1\x85 \xd0\xbf\xd0\xb0\xd1\x81\xd1\x81\xd0\xb0\xd0\xb6\xd0\xb8\xd1\x80\xd0\xbe\xd0\xb2 \xd1\x82\xd0\xb0\xd0\xba, \xd1\x87\xd1\x82\xd0\xbe\xd0\xb1\xd1\x8b \xd1\x81\xd1\x83\xd0\xbc\xd0\xbc\xd0\xb0\xd1\x80\xd0\xbd\xd0\xbe\xd0\xb5 \xd1\x87\xd0\xb8\xd1\x81\xd0\xbb\xd0\xbe \xd1\x81\xd0\xbe\xd1\x81\xd0\xb5\xd0\xb4\xd0\xb5\xd0\xb9 \xd1\x83 \xd1\x81\xd1\x82\xd0\xb0\xd1\x82\xd1\x83\xd1\x81\xd0\xbd\xd1\x8b\xd1\x85 \xd0\xbf\xd0\xb0\xd1\x81\xd1\x81\xd0\xb0\xd0\xb6\xd0\xb8\xd1\x80\xd0\xbe\xd0\xb2 \xd0\xb1\xd1\x8b\xd0\xbb\xd0\xbe \xd0\xbc\xd0\xb8\xd0\xbd\xd0\xb8\xd0\xbc\xd0\xb0\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe \xd0\xb2\xd0\xbe\xd0\xb7\xd0\xbc\xd0\xbe\xd0\xb6\xd0\xbd\xd1\x8b\xd0\xbc. \xd0\x94\xd0\xb2\xd0\xb0 \xd0\xbf\xd0\xb0\xd1\x81\xd1\x81\xd0\xb0\xd0\xb6\xd0\xb8\xd1\x80\xd0\xb0 \xd1\x81\xd1\x87\xd0\xb8\xd1\x82\xd0\xb0\xd1\x8e\xd1\x82\xd1\x81\xd1\x8f \xd1\x81\xd0\xbe\xd1\x81\xd0\xb5\xd0\xb4\xd1\x8f\xd0\xbc\xd0\xb8, \xd0\xb5\xd1\x81\xd0\xbb\xd0\xb8 \xd0\xbe\xd0\xbd\xd0\xb8 \xd1\x81\xd0\xb8\xd0\xb4\xd1\x8f\xd1\x82 \xd0\xb2 \xd0\xbe\xd0\xb4\xd0\xbd\xd0\xbe\xd0\xbc \xd1\x80\xd1\x8f\xd0\xb4\xd1\x83 \xd0\xb8 \xd0\xbc\xd0\xb5\xd0\xb6\xd0\xb4\xd1\x83 \xd0\xbd\xd0\xb8\xd0\xbc\xd0\xb8 \xd0\xbd\xd0\xb5\xd1\x82 \xd0\xb4\xd1\x80\xd1\x83\xd0\xb3\xd0\xb8\xd1\x85 \xd0\xbc\xd0\xb5\xd1\x81\xd1\x82 \xd0\xb8 \xd0\xbf\xd1\x80\xd0\xbe\xd1\x85\xd0\xbe\xd0\xb4\xd0\xb0 \xd0\xbc\xd0\xb5\xd0\xb6\xd0\xb4\xd1\x83 \xd1\x80\xd1\x8f\xd0\xb4\xd0\xb0\xd0\xbc\xd0\xb8. \xd0\x95\xd1\x81\xd0\xbb\xd0\xb8 \xd0\xbf\xd0\xb0\xd1\x81\xd1\x81\xd0\xb0\xd0\xb6\xd0\xb8\xd1\x80 \xd1\x8f\xd0\xb2\xd0\xbb\xd1\x8f\xd0\xb5\xd1\x82\xd1\x81\xd1\x8f \xd1\x81\xd0\xbe\xd1\x81\xd0\xb5\xd0\xb4\xd0\xbd\xd0\xb8\xd0\xbc \xd0\xbf\xd0\xb0\xd1\x81\xd1\x81\xd0\xb0\xd0\xb6\xd0\xb8\xd1\x80\xd0\xbe\xd0\xbc \xd0\xb4\xd0\xbb\xd1\x8f \xd0\xb4\xd0\xb2\xd1\x83\xd1\x85 \xd1\x81\xd1\x82\xd0\xb0\xd1\x82\xd1\x83\xd1\x81\xd0\xbd\xd1\x8b\xd1\x85 \xd0\xbf\xd0\xb0\xd1\x81\xd1\x81\xd0\xb0\xd0\xb6\xd0\xb8\xd1\x80\xd0\xbe\xd0\xb2, \xd1\x82\xd0\xbe \xd0\xb5\xd0\xb3\xd0\xbe \xd1\x81\xd0\xbb\xd0\xb5\xd0\xb4\xd1\x83\xd0\xb5\xd1\x82 \xd1\x83\xd1\x87\xd0\xb8\xd1\x82\xd1\x8b\xd0\xb2\xd0\xb0\xd1\x82\xd1\x8c \xd0\xb2 \xd1\x81\xd1\x83\xd0\xbc\xd0\xbc\xd0\xb5 \xd1\x81\xd0\xbe\xd1\x81\xd0\xb5\xd0\xb4\xd0\xb5\xd0\xb9 \xd0\xb4\xd0\xb2\xd0\xb0\xd0\xb6\xd0\xb4\xd1\x8b." "*special problem,implementation" 1300
1047B "Cover Points" "There are n points on the plane, (x1,y1),(x2,y2),\xe2\x80\xa6,(xn,yn).You need to place an isosceles triangle with two sides on the coordinate axis to cover all points (a point is covered if it lies inside the triangle or on the side of the triangle). Calculate the minimum length of the shorter side of the triangle." geometry,math 900
845B "Luba And The Ticket" "Luba has a ticket consisting of 6 digits. In one move she can choose digit in any position and replace it with arbitrary digit. She wants to know the minimum number of digits she needs to replace in order to make the ticket lucky.The ticket is considered lucky if the sum of first three digits equals to the sum of last three digits." "brute force,greedy,implementation" 1600
242E "XOR on Segment" "You\'ve got an array a, consisting of n integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. You are allowed to perform two operations on this array:  Calculate the sum of current array elements on the segment [l,\xe2\x80\x89r], that is, count value al\xe2\x80\x89+\xe2\x80\x89al\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89ar.  Apply the xor operation with a given number x to each array element on the segment [l,\xe2\x80\x89r], that is, execute . This operation changes exactly r\xe2\x80\x89-\xe2\x80\x89l\xe2\x80\x89+\xe2\x80\x891 array elements. Expression  means applying bitwise xor operation to numbers x and y. The given operation exists in all modern programming languages, for example in language C++ and Java it is marked as ""^"", in Pascal \xe2\x80\x94 as ""xor"".You\'ve got a list of m operations of the indicated type. Your task is to perform all given operations, for each sum query you should print the result you get." "bitmasks,data structures" 2000
1381A2 "Prefix Flip (Hard Version)" "This is the hard version of the problem. The difference between the versions is the constraint on n and the required number of operations. You can make hacks only if all versions of the problem are solved.There are two binary strings a and b of length n (a binary string is a string consisting of symbols 0 and 1). In an operation, you select a prefix of a, and simultaneously invert the bits in the prefix (0 changes to 1 and 1 changes to 0) and reverse the order of the bits in the prefix.For example, if a=001011 and you select the prefix of length 3, it becomes 011011. Then if you select the entire string, it becomes 001001.Your task is to transform the string a into b in at most 2n operations. It can be proved that it is always possible." "constructive algorithms,data structures,implementation,strings,two pointers" 1700
1610C "Keshi Is Throwing a Party" "Keshi is throwing a party and he wants everybody in the party to be happy.He has n friends. His i-th friend has i dollars. If you invite the i-th friend to the party, he will be happy only if at most ai people in the party are strictly richer than him and at most bi people are strictly poorer than him.Keshi wants to invite as many people as possible. Find the maximum number of people he can invite to the party so that every invited person would be happy." "binary search,greedy" 1600
1010B Rocket "This is an interactive problem.Natasha is going to fly to Mars. Finally, Natasha sat in the rocket. She flies, flies... but gets bored. She wishes to arrive to Mars already! So she decides to find something to occupy herself. She couldn\'t think of anything better to do than to calculate the distance to the red planet.Let\'s define x as the distance to Mars. Unfortunately, Natasha does not know x. But it is known that 1\xe2\x89\xa4x\xe2\x89\xa4m, where Natasha knows the number m. Besides, x and m are positive integers.Natasha can ask the rocket questions. Every question is an integer y (1\xe2\x89\xa4y\xe2\x89\xa4m). The correct answer to the question is \xe2\x88\x921, if x<y, 0, if x=y, and 1, if x>y. But the rocket is broken \xe2\x80\x94 it does not always answer correctly. Precisely: let the correct answer to the current question be equal to t, then, if the rocket answers this question correctly, then it will answer t, otherwise it will answer \xe2\x88\x92t.In addition, the rocket has a sequence p of length n. Each element of the sequence is either 0 or 1. The rocket processes this sequence in the cyclic order, that is 1-st element, 2-nd, 3-rd, \xe2\x80\xa6, (n\xe2\x88\x921)-th, n-th, 1-st, 2-nd, 3-rd, \xe2\x80\xa6, (n\xe2\x88\x921)-th, n-th, \xe2\x80\xa6. If the current element is 1, the rocket answers correctly, if 0 \xe2\x80\x94 lies. Natasha doesn\'t know the sequence p, but she knows its length \xe2\x80\x94 n.You can ask the rocket no more than 60 questions.Help Natasha find the distance to Mars. Assume, that the distance to Mars does not change while Natasha is asking questions.Your solution will not be accepted, if it does not receive an answer 0 from the rocket (even if the distance to Mars is uniquely determined by the already received rocket\'s answers)." "binary search,interactive" 1800
233A "Perfect Permutation" "A permutation is a sequence of integers p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pn, consisting of n distinct positive integers, each of them doesn\'t exceed n. Let\'s denote the i-th element of permutation p as pi. We\'ll call number n the size of permutation p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pn.Nickolas adores permutations. He likes some permutations more than the others. He calls such permutations perfect. A perfect permutation is such permutation p that for any i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) (n is the permutation size) the following equations hold ppi\xe2\x80\x89=\xe2\x80\x89i and pi\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89i. Nickolas asks you to print any perfect permutation of size n for the given n." implementation,math 800
1373G Pawns "You are given a chessboard consisting of n rows and n columns. Rows are numbered from bottom to top from 1 to n. Columns are numbered from left to right from 1 to n. The cell at the intersection of the x-th column and the y-th row is denoted as (x,y). Furthermore, the k-th column is a special column. Initially, the board is empty. There are m changes to the board. During the i-th change one pawn is added or removed from the board. The current board is good if we can move all pawns to the special column by the followings rules:  Pawn in the cell (x,y) can be moved to the cell (x,y+1), (x\xe2\x88\x921,y+1) or (x+1,y+1);  You can make as many such moves as you like;  Pawns can not be moved outside the chessboard;  Each cell can not contain more than one pawn. The current board may not always be good. To fix it, you can add new rows to the board. New rows are added at the top, i.\xe2\x80\x89e. they will have numbers n+1,n+2,n+3,\xe2\x80\xa6.After each of m changes, print one integer \xe2\x80\x94 the minimum number of rows which you have to add to make the board good." "data structures,divide and conquer,greedy" 2600
1924C "Fractal Origami" "You have a square piece of paper with a side length equal to 1 unit. In one operation, you fold each corner of the square to the center of the paper, thus forming another square with a side length equal to 12\xe2\x80\x93\xe2\x88\x9a units. By taking this square as a new square, you do the operation again and repeat this process a total of N times.  Performing operations for N=2. After performing the set of operations, you open the paper with the same side up you started with and see some crease lines on it. Every crease line is one of two types: a mountain or a valley. A mountain is when the paper folds outward, and a valley is when the paper folds inward.You calculate the sum of the length of all mountain crease lines on the paper and call it M. Similarly, you calculate for valley crease lines and call it V. You want to find the value of MV.It can be proved that this value can be represented in the form of A+B2\xe2\x80\x93\xe2\x88\x9a, where A and B are rational numbers. Let this B be represented as an irreducible fraction pq, your task is to print p\xe2\x88\x97inv(q) modulo 999999893 (note the unusual modulo), where inv(q) is the modular inverse of q." geometry,math,matrices 2400
1236E "Alice and the Unfair Game" "Alice is playing a game with her good friend, Marisa.There are n boxes arranged in a line, numbered with integers from 1 to n from left to right. Marisa will hide a doll in one of the boxes. Then Alice will have m chances to guess where the doll is. If Alice will correctly guess the number of box, where doll is now, she will win the game, otherwise, her friend will win the game.In order to win, Marisa will use some unfair tricks. After each time Alice guesses a box, she can move the doll to the neighboring box or just keep it at its place. Boxes i and i+1 are neighboring for all 1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921. She can also use this trick once before the game starts.So, the game happens in this order: the game starts, Marisa makes the trick, Alice makes the first guess, Marisa makes the trick, Alice makes the second guess, Marisa makes the trick, \xe2\x80\xa6, Alice makes m-th guess, Marisa makes the trick, the game ends.Alice has come up with a sequence a1,a2,\xe2\x80\xa6,am. In the i-th guess, she will ask if the doll is in the box ai. She wants to know the number of scenarios (x,y) (for all 1\xe2\x89\xa4x,y\xe2\x89\xa4n), such that Marisa can win the game if she will put the doll at the x-th box at the beginning and at the end of the game, the doll will be at the y-th box. Help her and calculate this number." "binary search,data structures,dp,dsu" 2500
1137A Skyscrapers "Dora loves adventures quite a lot. During some journey she encountered an amazing city, which is formed by n streets along the Eastern direction and m streets across the Southern direction. Naturally, this city has nm intersections. At any intersection of i-th Eastern street and j-th Southern street there is a monumental skyscraper. Dora instantly became curious and decided to explore the heights of the city buildings.When Dora passes through the intersection of the i-th Eastern and j-th Southern street she examines those two streets. After Dora learns the heights of all the skyscrapers on those two streets she wonders: how one should reassign heights to the skyscrapers on those two streets, so that the maximum height would be as small as possible and the result of comparing the heights of any two skyscrapers on one street wouldn\'t change.Formally, on every of nm intersections Dora solves an independent problem. She sees n+m\xe2\x88\x921 skyscrapers and for each of them she knows its real height. Moreover, any two heights can be compared to get a result ""greater"", ""smaller"" or ""equal"". Now Dora wants to select some integer x and assign every skyscraper a height from 1 to x. When assigning heights, Dora wants to preserve the relative order of the skyscrapers in both streets. That is, the result of any comparison of heights of two skyscrapers in the current Eastern street shouldn\'t change and the result of any comparison of heights of two skyscrapers in current Southern street shouldn\'t change as well. Note that skyscrapers located on the Southern street are not compared with skyscrapers located on the Eastern street only. However, the skyscraper located at the streets intersection can be compared with both Southern and Eastern skyscrapers. For every intersection Dora wants to independently calculate the minimum possible x.For example, if the intersection and the two streets corresponding to it look as follows:  Then it is optimal to replace the heights of the skyscrapers as follows (note that all comparisons ""less"", ""equal"", ""greater"" inside the Eastern street and inside the Southern street are preserved)  The largest used number is 5, hence the answer for this intersection would be 5.Help Dora to compute the answers for each intersection." implementation,sortings 1600
1514E "Baby Ehab\'s Hyper Apartment" "This is an interactive problem.Baby Ehab loves crawling around his apartment. It has nn rooms numbered from 00 to n\xe2\x88\x921n\xe2\x88\x921. For every pair of rooms, aa and bb, there\'s either a direct passage from room aa to room bb, or from room bb to room aa, but never both.Baby Ehab wants to go play with Baby Badawy. He wants to know if he could get to him. However, he doesn\'t know anything about his apartment except the number of rooms. He can ask the baby sitter two types of questions:   is the passage between room aa and room bb directed from aa to bb or the other way around?  does room xx have a passage towards any of the rooms s1s1, s2s2, ..., sksk? He can ask at most 9n9n queries of the first type and at most 2n2n queries of the second type.After asking some questions, he wants to know for every pair of rooms aa and bb whether there\'s a path from aa to bb or not. A path from aa to bb is a sequence of passages that starts from room aa and ends at room bb." "binary search,graphs,interactive,sortings,two pointers" 2700
1955D "Inaccurate Subsequence Search" "Maxim has an array a of n integers and an array b of m integers (m\xe2\x89\xa4n).Maxim considers an array c of length m to be good if the elements of array c can be rearranged in such a way that at least k of them match the elements of array b. For example, if b=[1,2,3,4] and k=3, then the arrays [4,1,2,3] and [2,3,4,5] are good (they can be reordered as follows: [1,2,3,4] and [5,2,3,4]), while the arrays [3,4,5,6] and [3,4,3,4] are not good.Maxim wants to choose every subsegment of array a of length m as the elements of array c. Help Maxim count how many selected arrays will be good.In other words, find the number of positions 1\xe2\x89\xa4l\xe2\x89\xa4n\xe2\x88\x92m+1 such that the elements al,al+1,\xe2\x80\xa6,al+m\xe2\x88\x921 form a good array." "data structures,two pointers" 1400
311A "The Closest Pair" "Currently Tiny is learning Computational Geometry. When trying to solve a problem called ""The Closest Pair Of Points In The Plane"", he found that a code which gave a wrong time complexity got Accepted instead of Time Limit Exceeded.The problem is the follows. Given n points in the plane, find a pair of points between which the distance is minimized. Distance between (x1,\xe2\x80\x89y1) and (x2,\xe2\x80\x89y2) is .The pseudo code of the unexpected code is as follows:input nfor i from 1 to n    input the i-th point\'s coordinates into p[i]sort array p[] by increasing of x coordinate first and increasing of y coordinate secondd=INF        //here INF is a number big enoughtot=0for i from 1 to n    for j from (i+1) to n        ++tot        if (p[j].x-p[i].x>=d) then break    //notice that ""break"" is only to be                                            //out of the loop ""for j""        d=min(d,distance(p[i],p[j]))output dHere, tot can be regarded as the running time of the code. Due to the fact that a computer can only run a limited number of operations per second, tot should not be more than k in order not to get Time Limit Exceeded.You are a great hacker. Would you please help Tiny generate a test data and let the code get Time Limit Exceeded?" "constructive algorithms,implementation" 1300
1506C "Double-ended Strings" "You are given the strings a and b, consisting of lowercase Latin letters. You can do any number of the following operations in any order:   if |a|>0 (the length of the string a is greater than zero), delete the first character of the string a, that is, replace a with a2a3\xe2\x80\xa6an;  if |a|>0, delete the last character of the string a, that is, replace a with a1a2\xe2\x80\xa6an\xe2\x88\x921;  if |b|>0 (the length of the string b is greater than zero), delete the first character of the string b, that is, replace b with b2b3\xe2\x80\xa6bn;  if |b|>0, delete the last character of the string b, that is, replace b with b1b2\xe2\x80\xa6bn\xe2\x88\x921. Note that after each of the operations, the string a or b may become empty.For example, if a=""hello"" and b=""icpc"", then you can apply the following sequence of operations:   delete the first character of the string a \xe2\x87\x92 a=""ello"" and b=""icpc"";  delete the first character of the string b \xe2\x87\x92 a=""ello"" and b=""cpc"";  delete the first character of the string b \xe2\x87\x92 a=""ello"" and b=""pc"";  delete the last character of the string a \xe2\x87\x92 a=""ell"" and b=""pc"";  delete the last character of the string b \xe2\x87\x92 a=""ell"" and b=""p"". For the given strings a and b, find the minimum number of operations for which you can make the strings a and b equal. Note that empty strings are also equal." "brute force,implementation,strings" 1000
1599I Desert "You are given an undirected graph of N nodes and M edges, E1,E2,\xe2\x80\xa6EM.A connected graph is a cactus if each of it\'s edges belogs to at most one simple cycle. A graph is a desert if each of it\'s connected components is a cactus. Find the number of pairs (L,R), (1\xe2\x89\xa4L\xe2\x89\xa4R\xe2\x89\xa4M) such that, if we delete all the edges except for EL,EL+1,\xe2\x80\xa6ER, the graph is a desert." "data structures,graphs" 2700
1041F "Ray in the tube" "You are given a tube which is reflective inside represented as two non-coinciding, but parallel to Ox lines. Each line has some special integer points \xe2\x80\x94 positions of sensors on sides of the tube.You are going to emit a laser ray in the tube. To do so, you have to choose two integer points A and B on the first and the second line respectively (coordinates can be negative): the point A is responsible for the position of the laser, and the point B \xe2\x80\x94 for the direction of the laser ray. The laser ray is a ray starting at A and directed at B which will reflect from the sides of the tube (it doesn\'t matter if there are any sensors at a reflection point or not). A sensor will only register the ray if the ray hits exactly at the position of the sensor.  Examples of laser rays. Note that image contains two examples. The 3 sensors (denoted by black bold points on the tube sides) will register the blue ray but only 2 will register the red. Calculate the maximum number of sensors which can register your ray if you choose points A and B on the first and the second lines respectively." "data structures,divide and conquer,dp,math" 2500
513F2 Scaygerboss "Cthulhu decided to catch Scaygerboss. Scaygerboss found it out and is trying to hide in a pack of his scaygers. Each scayger except Scaygerboss is either a male or a female. Scaygerboss\'s gender is ""other"".Scaygers are scattered on a two-dimensional map divided into cells. A scayger looks nerdy and loveable if it is staying in the same cell with exactly one scayger of a gender that is different from its own gender. Cthulhu will not be able to catch Scaygerboss if all the scaygers on the map look nerdy and loveable.The scaygers can move around at different speeds. For each scayger, we are given the time it takes this scayger to move from a cell to an adjacent cell. Cells are adjacent if they share a common side. At any point of time, each cell that does not contain an obstacle can be occupied by an arbitrary number of scaygers. Scaygers cannot move to cells with obstacles.Calculate minimal time in order to make all scaygers look nerdy and loveable if they move optimally toward this goal." flows 2800
958C1 "Encryption (easy)" "Rebel spy Heidi has just obtained the plans for the Death Star from the Empire and, now on her way to safety, she is trying to break the encryption of the plans (of course they are encrypted \xe2\x80\x93 the Empire may be evil, but it is not stupid!). The encryption has several levels of security, and here is how the first one looks.Heidi is presented with a screen that shows her a sequence of integers A and a positive integer p. She knows that the encryption code is a single number S, which is defined as follows:Define the score of X to be the sum of the elements of X modulo p.Heidi is given a sequence A that consists of N integers, and also given an integer p. She needs to split A into 2 parts such that:   Each part contains at least 1 element of A, and each part consists of contiguous elements of A.  The two parts do not overlap.  The total sum S of the scores of those two parts is maximized. This is the encryption code. Output the sum S, which is the encryption code." "brute force" 1200
500G "New Year Running" "New Year is coming in Tree Island! In this island, as the name implies, there are n cities connected by n\xe2\x80\x89-\xe2\x80\x891 roads, and for any two distinct cities there always exists exactly one path between them. For every person in Tree Island, it takes exactly one minute to pass by exactly one road.There is a weird New Year tradition for runnners in Tree Island, which is called ""extreme run"". This tradition can be done as follows.A runner chooses two distinct cities a and b. For simplicity, let\'s denote the shortest path from city a to city b as p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pl (here, p1\xe2\x80\x89=\xe2\x80\x89a and pl\xe2\x80\x89=\xe2\x80\x89b holds). Then following happens:  The runner starts at city a.  The runner runs from city a to b, following the shortest path from city a to city b.  When the runner arrives at city b, he turns his direction immediately (it takes no time), and runs towards city a, following the shortest path from city b to city a.  When the runner arrives at city a, he turns his direction immediately (it takes no time), and runs towards city b, following the shortest path from city a to city b.  Repeat step 3 and step 4 forever. In short, the course of the runner can be denoted as:  Two runners JH and JY decided to run ""extremely"" in order to celebrate the New Year. JH has chosen two cities u and v, and JY has chosen two cities x and y. They decided to start running at the same moment, and run until they meet at the same city for the first time. Meeting on a road doesn\'t matter for them. Before running, they want to know the amount of time they will run.It is too hard for JH and JY to calculate this, so they ask you for help." "number theory,trees" 3200
1183E "Subsequences (easy version)" "The only difference between the easy and the hard versions is constraints.A subsequence is a string that can be derived from another string by deleting some or no symbols without changing the order of the remaining symbols. Characters to be deleted are not required to go successively, there can be any gaps between them. For example, for the string ""abaca"" the following strings are subsequences: ""abaca"", ""aba"", ""aaa"", ""a"" and """" (empty string). But the following strings are not subsequences: ""aabaca"", ""cb"" and ""bcaa"".You are given a string s consisting of n lowercase Latin letters.In one move you can take any subsequence t of the given string and add it to the set S. The set S can\'t contain duplicates. This move costs n\xe2\x88\x92|t|, where |t| is the length of the added subsequence (i.e. the price equals to the number of the deleted characters).Your task is to find out the minimum possible total cost to obtain a set S of size k or report that it is impossible to do so." "dp,graphs,implementation,shortest paths" 2000
1055D Refactoring "Alice has written a program and now tries to improve its readability. One of the ways to improve readability is to give sensible names to the variables, so now Alice wants to rename some variables in her program. In her IDE there is a command called ""massive refactoring"", which can replace names of many variable in just one run. To use it, Alice needs to select two strings s and t and after that for each variable the following algorithm is performed: if the variable\'s name contains s as a substring, then the first (and only first) occurrence of s is replaced with t. If the name doesn\'t contain s, then this variable\'s name stays the same.The list of variables is known and for each variable both the initial name and the name Alice wants this variable change to are known. Moreover, for each variable the lengths of the initial name and the target name are equal (otherwise the alignment of the code could become broken). You need to perform renaming of all variables in exactly one run of the massive refactoring command or determine that it is impossible." greedy,implementation,strings 2400
1551F "Equidistant Vertices" "A tree is an undirected connected graph without cycles.You are given a tree of n vertices. Find the number of ways to choose exactly k vertices in this tree (i.\xe2\x80\x89e. a k-element subset of vertices) so that all pairwise distances between the selected vertices are equal (in other words, there exists an integer c such that for all u,v (u\xe2\x89\xa0v, u,v are in selected vertices) du,v=c, where du,v is the distance from u to v).Since the answer may be very large, you need to output it modulo 109+7." "brute force,combinatorics,dfs and similar,dp,trees" 2200
888C "K-Dominant Character" "You are given a string s consisting of lowercase Latin letters. Character c is called k-dominant iff each substring of s with length at least k contains this character c.You have to find minimum k such that there exists at least one k-dominant character." "binary search,implementation,two pointers" 1400
270A "Fancy Fence" "Emuskald needs a fence around his farm, but he is too lazy to build it himself. So he purchased a fence-building robot.He wants the fence to be a regular polygon. The robot builds the fence along a single path, but it can only make fence corners at a single angle a.Will the robot be able to build the fence Emuskald wants? In other words, is there a regular polygon which angles are equal to a?" geometry,implementation,math 1100
679E "Bear and Bad Powers of 42" "Limak, a bear, isn\'t good at handling queries. So, he asks you to do it.We say that powers of 42 (numbers 1,\xe2\x80\x8942,\xe2\x80\x891764,\xe2\x80\x89...) are bad. Other numbers are good.You are given a sequence of n good integers t1,\xe2\x80\x89t2,\xe2\x80\x89...,\xe2\x80\x89tn. Your task is to handle q queries of three types:  1 i \xe2\x80\x94 print ti in a separate line.  2 a b x \xe2\x80\x94 for  set ti to x. It\'s guaranteed that x is a good number.  3 a b x \xe2\x80\x94 for  increase ti by x. After this repeat the process while at least one ti is bad. You can note that after each query all ti are good." "data structures" 3100
1156A "Inscribed Figures" "The math faculty of Berland State University has suffered the sudden drop in the math skills of enrolling students. This year the highest grade on the entrance math test was 8. Out of 100! Thus, the decision was made to make the test easier.Future students will be asked just a single question. They are given a sequence of integer numbers a1,a2,\xe2\x80\xa6,an, each number is from 1 to 3 and ai\xe2\x89\xa0ai+1 for each valid i. The i-th number represents a type of the i-th figure:  circle;  isosceles triangle with the length of height equal to the length of base;  square. The figures of the given sequence are placed somewhere on a Cartesian plane in such a way that:  (i+1)-th figure is inscribed into the i-th one;  each triangle base is parallel to OX;  the triangle is oriented in such a way that the vertex opposite to its base is at the top;  each square sides are parallel to the axes;  for each i from 2 to n figure i has the maximum possible length of side for triangle and square and maximum radius for circle. Note that the construction is unique for some fixed position and size of just the first figure.The task is to calculate the number of distinct points (not necessarily with integer coordinates) where figures touch. The trick is, however, that the number is sometimes infinite. But that won\'t make the task difficult for you, will it?So can you pass the math test and enroll into Berland State University?" geometry 1400
1363D "Guess The Maximums" "This is an interactive problem.Ayush devised a new scheme to set the password of his lock. The lock has k slots where each slot can hold integers from 1 to n. The password P is a sequence of k integers each in the range [1,n], i-th element of which goes into the i-th slot of the lock.To set the password of his lock, Ayush comes up with an array A of n integers each in the range [1,n] (not necessarily distinct). He then picks k non-empty mutually disjoint subsets of indices S1,S2,...,Sk (Si\xe2\x88\xa9i\xe2\x89\xa0jSj=\xe2\x88\x85) and sets his password as Pi=maxj\xe2\x88\x89SiA[j]. In other words, the i-th integer in the password is equal to the maximum over all elements of A whose indices do not belong to Si.You are given the subsets of indices chosen by Ayush. You need to guess the password. To make a query, you can choose a non-empty subset of indices of the array and ask the maximum of all elements of the array with index in this subset. You can ask no more than 12 queries." "binary search,implementation,interactive,math" 2100
898B "Proper Nutrition" "Vasya has n burles. One bottle of Ber-Cola costs a burles and one Bars bar costs b burles. He can buy any non-negative integer number of bottles of Ber-Cola and any non-negative integer number of Bars bars.Find out if it\'s possible to buy some amount of bottles of Ber-Cola and Bars bars and spend exactly n burles.In other words, you should find two non-negative integers x and y such that Vasya can buy x bottles of Ber-Cola and y Bars bars and x\xc2\xb7a\xe2\x80\x89+\xe2\x80\x89y\xc2\xb7b\xe2\x80\x89=\xe2\x80\x89n or tell that it\'s impossible." "brute force,implementation,number theory" 1100
590D "Top Secret Task" "A top-secret military base under the command of Colonel Zuev is expecting an inspection from the Ministry of Defence. According to the charter, each top-secret military base must include a top-secret troop that should... well, we cannot tell you exactly what it should do, it is a top secret troop at the end. The problem is that Zuev\'s base is missing this top-secret troop for some reasons.The colonel decided to deal with the problem immediately and ordered to line up in a single line all n soldiers of the base entrusted to him. Zuev knows that the loquacity of the i-th soldier from the left is equal to qi. Zuev wants to form the top-secret troop using k leftmost soldiers in the line, thus he wants their total loquacity to be as small as possible (as the troop should remain top-secret). To achieve this, he is going to choose a pair of consecutive soldiers and swap them. He intends to do so no more than s times. Note that any soldier can be a participant of such swaps for any number of times. The problem turned out to be unusual, and colonel Zuev asked you to help.Determine, what is the minimum total loquacity of the first k soldiers in the line, that can be achieved by performing no more than s swaps of two consecutive soldiers." dp 2300
1151A "Maxim and Biology" "Today in the scientific lyceum of the Kingdom of Kremland, there was a biology lesson. The topic of the lesson was the genomes. Let\'s call the genome the string ""ACTG"".Maxim was very boring to sit in class, so the teacher came up with a task for him: on a given string s consisting of uppercase letters and length of at least 4, you need to find the minimum number of operations that you need to apply, so that the genome appears in it as a substring. For one operation, you can replace any letter in the string s with the next or previous in the alphabet. For example, for the letter ""D"" the previous one will be ""C"", and the next \xe2\x80\x94 ""E"". In this problem, we assume that for the letter ""A"", the previous one will be the letter ""Z"", and the next one will be ""B"", and for the letter ""Z"", the previous one is the letter ""Y"", and the next one is the letter ""A"".Help Maxim solve the problem that the teacher gave him.A string a is a substring of a string b if a can be obtained from b by deletion of several (possibly, zero or all) characters from the beginning and several (possibly, zero or all) characters from the end." "brute force,strings" 1000
1887C "Minimum Array" "Given an array a of length n consisting of integers. Then the following operation is sequentially applied to it q times: Choose indices l and r (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n) and an integer x; Add x to all elements of the array a in the segment [l,r]. More formally, assign ai:=ai+x for all l\xe2\x89\xa4i\xe2\x89\xa4r.Let bj be the array a obtained after applying the first j operations (0\xe2\x89\xa4j\xe2\x89\xa4q). Note that b0 is the array a before applying any operations.You need to find the lexicographically minimum\xe2\x80\xa0 array among all arrays bj.\xe2\x80\xa0An array x is lexicographically smaller than array y if there is an index i such that xi<yi, and xj=yj for all j<i. In other words, for the first index i where the arrays differ, xi<yi." "binary search,brute force,constructive algorithms,data structures,greedy,hashing,two pointers" 2400
2000H "Ksyusha and the Loaded Set" "Ksyusha decided to start a game development company. To stand out among competitors and achieve success, she decided to write her own game engine. The engine must support a set initially consisting of n distinct integers a1,a2,\xe2\x80\xa6,an.The set will undergo m operations sequentially. The operations can be of the following types:   Insert element x into the set;  Remove element x from the set;  Report the k-load of the set. The k-load of the set is defined as the minimum positive integer d such that the integers d,d+1,\xe2\x80\xa6,d+(k\xe2\x88\x921) do not appear in this set. For example, the 3-load of the set {3,4,6,11} is 7, since the integers 7,8,9 are absent from the set, and no smaller value fits.Ksyusha is busy with management tasks, so you will have to write the engine. Implement efficient support for the described operations." "binary search,brute force,data structures,implementation" 2200
1249C2 "Good Numbers (hard version)" "The only difference between easy and hard versions is the maximum value of n.You are given a positive integer number n. You really love good numbers so you want to find the smallest good number greater than or equal to n.The positive integer is called good if it can be represented as a sum of distinct powers of 3 (i.e. no duplicates of powers of 3 are allowed).For example:  30 is a good number: 30=33+31,  1 is a good number: 1=30,  12 is a good number: 12=32+31,  but 2 is not a good number: you can\'t represent it as a sum of distinct powers of 3 (2=30+30),  19 is not a good number: you can\'t represent it as a sum of distinct powers of 3 (for example, the representations 19=32+32+30=32+31+31+31+30 are invalid),  20 is also not a good number: you can\'t represent it as a sum of distinct powers of 3 (for example, the representation 20=32+32+30+30 is invalid). Note, that there exist other representations of 19 and 20 as sums of powers of 3 but none of them consists of distinct powers of 3.For the given positive integer n find such smallest m (n\xe2\x89\xa4m) that m is a good number.You have to answer q independent queries." "binary search,greedy,math,meet-in-the-middle" 1500
1847A "The Man who became a God" "Kars is tired and resentful of the narrow mindset of his village since they are content with staying where they are and are not trying to become the perfect life form. Being a top-notch inventor, Kars wishes to enhance his body and become the perfect life form. Unfortunately, n of the villagers have become suspicious of his ideas. The i-th villager has a suspicion of ai on him. Individually each villager is scared of Kars, so they form into groups to be more powerful.The power of the group of villagers from l to r be defined as f(l,r) where f(l,r)=|al\xe2\x88\x92al+1|+|al+1\xe2\x88\x92al+2|+\xe2\x80\xa6+|ar\xe2\x88\x921\xe2\x88\x92ar|.Here |x\xe2\x88\x92y| is the absolute value of x\xe2\x88\x92y. A group with only one villager has a power of 0.Kars wants to break the villagers into exactly k contiguous subgroups so that the sum of their power is minimized. Formally, he must find k\xe2\x88\x921 positive integers 1\xe2\x89\xa4r1<r2<\xe2\x80\xa6<rk\xe2\x88\x921<n such that f(1,r1)+f(r1+1,r2)+\xe2\x80\xa6+f(rk\xe2\x88\x921+1,n) is minimised. Help Kars in finding the minimum value of f(1,r1)+f(r1+1,r2)+\xe2\x80\xa6+f(rk\xe2\x88\x921+1,n)." greedy,sortings 800
1762G "Unequal Adjacent Elements" "You are given an array a consisting of n positive integers. Find any permutation p of [1,2,\xe2\x80\xa6,n] such that:  pi\xe2\x88\x922<pi for all i, where 3\xe2\x89\xa4i\xe2\x89\xa4n, and  api\xe2\x88\x921\xe2\x89\xa0api for all i, where 2\xe2\x89\xa4i\xe2\x89\xa4n. Or report that no such permutation exists." "constructive algorithms,sortings" 3100
982C "Cut \'em all!" "You\'re given a tree with n vertices.Your task is to determine the maximum possible number of edges that can be removed in such a way that all the remaining connected components will have even size." "dfs and similar,dp,graphs,greedy,trees" 1500
166E Tetrahedron "You are given a tetrahedron. Let\'s mark its vertices with letters A, B, C and D correspondingly.  An ant is standing in the vertex D of the tetrahedron. The ant is quite active and he wouldn\'t stay idle. At each moment of time he makes a step from one vertex to another one along some edge of the tetrahedron. The ant just can\'t stand on one place.You do not have to do much to solve the problem: your task is to count the number of ways in which the ant can go from the initial vertex D to itself in exactly n steps. In other words, you are asked to find out the number of different cyclic paths with the length of n from vertex D to itself. As the number can be quite large, you should print it modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." dp,math,matrices 1500
431A "Black Square" "Quite recently, a very smart student named Jury decided that lectures are boring, so he downloaded a game called ""Black Square"" on his super cool touchscreen phone.In this game, the phone\'s screen is divided into four vertical strips. Each second, a black square appears on some of the strips. According to the rules of the game, Jury must use this second to touch the corresponding strip to make the square go away. As Jury is both smart and lazy, he counted that he wastes exactly ai calories on touching the i-th strip.You\'ve got a string s, describing the process of the game and numbers a1,\xe2\x80\x89a2,\xe2\x80\x89a3,\xe2\x80\x89a4. Calculate how many calories Jury needs to destroy all the squares?" implementation 800
847F "Berland Elections" "The elections to Berland parliament are happening today. Voting is in full swing!Totally there are n candidates, they are numbered from 1 to n. Based on election results k (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) top candidates will take seats in the parliament.After the end of the voting the number of votes for each candidate is calculated. In the resulting table the candidates are ordered by the number of votes. In case of tie (equal number of votes) they are ordered by the time of the last vote given. The candidate with ealier last vote stands higher in the resulting table.So in the resulting table candidates are sorted by the number of votes (more votes stand for the higher place) and if two candidates have equal number of votes they are sorted by the time of last vote (earlier last vote stands for the higher place).There is no way for a candidate with zero votes to take a seat in the parliament. So it is possible that less than k candidates will take a seat in the parliament.In Berland there are m citizens who can vote. Each of them will vote for some candidate. Each citizen will give a vote to exactly one of n candidates. There is no option ""against everyone"" on the elections. It is not accepted to spoil bulletins or not to go to elections. So each of m citizens will vote for exactly one of n candidates.At the moment a citizens have voted already (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m). This is an open election, so for each citizen it is known the candidate for which the citizen has voted. Formally, the j-th citizen voted for the candidate gj. The citizens who already voted are numbered in chronological order; i.e. the (j\xe2\x80\x89+\xe2\x80\x891)-th citizen voted after the j-th.The remaining m\xe2\x80\x89-\xe2\x80\x89a citizens will vote before the end of elections, each of them will vote for one of n candidates.Your task is to determine for each of n candidates one of the three possible outcomes:  a candidate will be elected to the parliament regardless of votes of the remaining m\xe2\x80\x89-\xe2\x80\x89a citizens;  a candidate has chance to be elected to the parliament after all n citizens have voted;  a candidate has no chances to be elected to the parliament regardless of votes of the remaining m\xe2\x80\x89-\xe2\x80\x89a citizens." greedy,sortings 2100
208A Dubstep "Vasya works as a DJ in the best Berland nightclub, and he often uses dubstep music in his performance. Recently, he has decided to take a couple of old songs and make dubstep remixes from them.Let\'s assume that a song consists of some number of words. To make the dubstep remix of this song, Vasya inserts a certain number of words ""WUB"" before the first word of the song (the number may be zero), after the last word (the number may be zero), and between words (at least one between any pair of neighbouring words), and then the boy glues together all the words, including ""WUB"", in one string and plays the song at the club.For example, a song with words ""I AM X"" can transform into a dubstep remix as ""WUBWUBIWUBAMWUBWUBX"" and cannot transform into ""WUBWUBIAMWUBX"".Recently, Petya has heard Vasya\'s new dubstep track, but since he isn\'t into modern music, he decided to find out what was the initial song that Vasya remixed. Help Petya restore the original song." strings 900
1704C Virus "There are n houses numbered from 1 to n on a circle. For each 1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921, house i and house i+1 are neighbours; additionally, house n and house 1 are also neighbours.Initially, m of these n houses are infected by a deadly virus. Each morning, Cirno can choose a house which is uninfected and protect the house from being infected permanently.Every day, the following things happen in order:  Cirno chooses an uninfected house, and protect it permanently.  All uninfected, unprotected houses which have at least one infected neighbor become infected. Cirno wants to stop the virus from spreading. Find the minimum number of houses that will be infected in the end, if she optimally choose the houses to protect.Note that every day Cirno always chooses a house to protect before the virus spreads. Also, a protected house will not be infected forever." greedy,implementation,sortings 1200
630J Divisibility "IT City company developing computer games invented a new way to reward its employees. After a new game release users start buying it actively, and the company tracks the number of sales with precision to each transaction. Every time when the next number of sales is divisible by all numbers from 2 to 10 every developer of this game gets a small bonus.A game designer Petya knows that the company is just about to release a new game that was partly developed by him. On the basis of his experience he predicts that n people will buy the game during the first month. Now Petya wants to determine how many times he will get the bonus. Help him to know it." "math,number theory" 1100
1355C "Count Triangles" "Like any unknown mathematician, Yuri has favourite numbers: A, B, C, and D, where A\xe2\x89\xa4B\xe2\x89\xa4C\xe2\x89\xa4D. Yuri also likes triangles and once he thought: how many non-degenerate triangles with integer sides x, y, and z exist, such that A\xe2\x89\xa4x\xe2\x89\xa4B\xe2\x89\xa4y\xe2\x89\xa4C\xe2\x89\xa4z\xe2\x89\xa4D holds?Yuri is preparing problems for a new contest now, so he is very busy. That\'s why he asked you to calculate the number of triangles with described property.The triangle is called non-degenerate if and only if its vertices are not collinear." "binary search,implementation,math,two pointers" 1800
1450F "The Struggling Contestant" "To help those contestants who struggle a lot in contests, the headquarters of Codeforces are planning to introduce Division 5. In this new division, the tags of all problems will be announced prior to the round to help the contestants.The contest consists of n problems, where the tag of the i-th problem is denoted by an integer ai.You want to AK (solve all problems). To do that, you must solve the problems in some order. To make the contest funnier, you created extra limitations on yourself. You do not want to solve two problems consecutively with the same tag since it is boring. Also, you are afraid of big jumps in difficulties while solving them, so you want to minimize the number of times that you solve two problems consecutively that are not adjacent in the contest order.Formally, your solve order can be described by a permutation p of length n. The cost of a permutation is defined as the number of indices i (1\xe2\x89\xa4i<n) where |pi+1\xe2\x88\x92pi|>1. You have the requirement that api\xe2\x89\xa0api+1 for all 1\xe2\x89\xa4i<n.You want to know the minimum possible cost of permutation that satisfies the requirement. If no permutations meet this requirement, you should report about it." "constructive algorithms,greedy" 2400
47D Safe "Vasya tries to break in a safe. He knows that a code consists of n numbers, and every number is a 0 or a 1. Vasya has made m attempts to enter the code. After each attempt the system told him in how many position stand the right numbers. It is not said in which positions the wrong numbers stand. Vasya has been so unlucky that he hasn\xe2\x80\x99t entered the code where would be more than 5 correct numbers. Now Vasya is completely bewildered: he thinks there\xe2\x80\x99s a mistake in the system and it is self-contradictory. Help Vasya \xe2\x80\x94 calculate how many possible code variants are left that do not contradict the previous system responses." "brute force" 2200
1038D Slime "There are n slimes in a row. Each slime has an integer value (possibly negative or zero) associated with it.Any slime can eat its adjacent slime (the closest slime to its left or to its right, assuming that this slime exists). When a slime with a value x eats a slime with a value y, the eaten slime disappears, and the value of the remaining slime changes to x\xe2\x88\x92y.The slimes will eat each other until there is only one slime left. Find the maximum possible value of the last slime." dp,greedy,implementation 1800
257A Sockets "Vasya has got many devices that work on electricity. He\'s got n supply-line filters to plug the devices, the i-th supply-line filter has ai sockets.Overall Vasya has got m devices and k electrical sockets in his flat, he can plug the devices or supply-line filters directly. Of course, he can plug the supply-line filter to any other supply-line filter. The device (or the supply-line filter) is considered plugged to electricity if it is either plugged to one of k electrical sockets, or if it is plugged to some supply-line filter that is in turn plugged to electricity. What minimum number of supply-line filters from the given set will Vasya need to plug all the devices he has to electricity? Note that all devices and supply-line filters take one socket for plugging and that he can use one socket to plug either one device or one supply-line filter." greedy,implementation,sortings 1100
1249F "Maximum Weight Subset" "You are given a tree, which consists of n vertices. Recall that a tree is a connected undirected graph without cycles.   Example of a tree. Vertices are numbered from 1 to n. All vertices have weights, the weight of the vertex v is av.Recall that the distance between two vertices in the tree is the number of edges on a simple path between them.Your task is to find the subset of vertices with the maximum total weight (the weight of the subset is the sum of weights of all vertices in it) such that there is no pair of vertices with the distance k or less between them in this subset." dp,trees 2200
1196A "Three Piles of Candies" "Alice and Bob have received three big piles of candies as a gift. Now they want to divide these candies as fair as possible. To do this, Alice takes one pile of candies, then Bob takes one of the other two piles. The last pile is split between Alice and Bob as they want: for example, it is possible that Alice takes the whole pile, and Bob gets nothing from it.After taking the candies from the piles, if Alice has more candies than Bob, she discards some candies so that the number of candies she has is equal to the number of candies Bob has. Of course, Bob does the same if he has more candies.Alice and Bob want to have as many candies as possible, and they plan the process of dividing candies accordingly. Please calculate the maximum number of candies Alice can have after this division process (of course, Bob will have the same number of candies).You have to answer q independent queries.Let\'s see the following example: [1,3,4]. Then Alice can choose the third pile, Bob can take the second pile, and then the only candy from the first pile goes to Bob \xe2\x80\x94 then Alice has 4 candies, and Bob has 4 candies.Another example is [1,10,100]. Then Alice can choose the second pile, Bob can choose the first pile, and candies from the third pile can be divided in such a way that Bob takes 54 candies, and Alice takes 46 candies. Now Bob has 55 candies, and Alice has 56 candies, so she has to discard one candy \xe2\x80\x94 and after that, she has 55 candies too." "brute force,constructive algorithms,math" 800
1898F "Vova Escapes the Matrix" "Following a world tour, Vova got himself trapped inside an n\xc3\x97m matrix. Rows of this matrix are numbered by integers from 1 to n from top to bottom, and the columns are numbered by integers from 1 to m from left to right. The cell (i,j) is the cell on the intersection of row i and column j for 1\xe2\x89\xa4i\xe2\x89\xa4n and 1\xe2\x89\xa4j\xe2\x89\xa4m.Some cells of this matrix are blocked by obstacles, while all other cells are empty. Vova occupies one of the empty cells. It is guaranteed that cells (1,1), (1,m), (n,1), (n,m) (that is, corners of the matrix) are blocked.Vova can move from one empty cell to another empty cell if they share a side. Vova can escape the matrix from any empty cell on the boundary of the matrix; these cells are called exits.Vova defines the type of the matrix based on the number of exits he can use to escape the matrix:   The 1-st type: matrices with no exits he can use to escape.  The 2-nd type: matrices with exactly one exit he can use to escape.  The 3-rd type: matrices with multiple (two or more) exits he can use to escape. Before Vova starts moving, Misha can create more obstacles to block more cells. However, he cannot change the type of the matrix. What is the maximum number of cells Misha can block, so that the type of the matrix remains the same? Misha cannot block the cell Vova is currently standing on." "brute force,dfs and similar,divide and conquer,shortest paths" 2600
18D "Seller Bob" "Last year Bob earned by selling memory sticks. During each of n days of his work one of the two following events took place:   A customer came to Bob and asked to sell him a 2x MB memory stick. If Bob had such a stick, he sold it and got 2x berllars.  Bob won some programming competition and got a 2x MB memory stick as a prize. Bob could choose whether to present this memory stick to one of his friends, or keep it. Bob never kept more than one memory stick, as he feared to mix up their capacities, and deceive a customer unintentionally. It is also known that for each memory stick capacity there was at most one customer, who wanted to buy that memory stick. Now, knowing all the customers\' demands and all the prizes won at programming competitions during the last n days, Bob wants to know, how much money he could have earned, if he had acted optimally." "brute force,dp,greedy" 2000
47A "Triangular numbers" "A triangular number is the number of dots in an equilateral triangle uniformly filled with dots. For example, three dots can be arranged in a triangle; thus three is a triangular number. The n-th triangular number is the number of dots in a triangle with n dots on a side. . You can learn more about these numbers from Wikipedia (http://en.wikipedia.org/wiki/Triangular_number).Your task is to find out if a given integer is a triangular number." "brute force,math" 800
1668A "Direction Change" "You are given a grid with n rows and m columns. Rows and columns are numbered from 1 to n, and from 1 to m. The intersection of the a-th row and b-th column is denoted by (a,b). Initially, you are standing in the top left corner (1,1). Your goal is to reach the bottom right corner (n,m).You can move in four directions from (a,b): up to (a\xe2\x88\x921,b), down to (a+1,b), left to (a,b\xe2\x88\x921) or right to (a,b+1).You cannot move in the same direction in two consecutive moves, and you cannot leave the grid. What is the minimum number of moves to reach (n,m)?" implementation,math 800
177A1 "Good Matrix Elements" "The Smart Beaver from ABBYY got hooked on square matrices. Now he is busy studying an n\xe2\x80\x89\xc3\x97\xe2\x80\x89n size matrix, where n is odd. The Smart Beaver considers the following matrix elements good:    Elements of the main diagonal.   Elements of the secondary diagonal.   Elements of the ""middle"" row \xe2\x80\x94 the row which has exactly  rows above it and the same number of rows below it.   Elements of the ""middle"" column \xe2\x80\x94 the column that has exactly  columns to the left of it and the same number of columns to the right of it.    The figure shows a 5\xe2\x80\x89\xc3\x97\xe2\x80\x895 matrix.   The good elements are marked with green.  Help the Smart Beaver count the sum of good elements of the given matrix." implementation 800
1254B2 "Send Boxes to Alice (Hard Version)" "This is the harder version of the problem. In this version, 1\xe2\x89\xa4n\xe2\x89\xa4106 and 0\xe2\x89\xa4ai\xe2\x89\xa4106. You can hack this problem if you locked it. But you can hack the previous problem only if you locked both problemsChristmas is coming, and our protagonist, Bob, is preparing a spectacular present for his long-time best friend Alice. This year, he decides to prepare n boxes of chocolate, numbered from 1 to n. Initially, the i-th box contains ai chocolate pieces.Since Bob is a typical nice guy, he will not send Alice n empty boxes. In other words, at least one of a1,a2,\xe2\x80\xa6,an is positive. Since Alice dislikes coprime sets, she will be happy only if there exists some integer k>1 such that the number of pieces in each box is divisible by k. Note that Alice won\'t mind if there exists some empty boxes. Charlie, Alice\'s boyfriend, also is Bob\'s second best friend, so he decides to help Bob by rearranging the chocolate pieces. In one second, Charlie can pick up a piece in box i and put it into either box i\xe2\x88\x921 or box i+1 (if such boxes exist). Of course, he wants to help his friend as quickly as possible. Therefore, he asks you to calculate the minimum number of seconds he would need to make Alice happy." "constructive algorithms,greedy,math,number theory,ternary search,two pointers" 2100
166A "Rank List" "Another programming contest is over. You got hold of the contest\'s final results table. The table has the following data. For each team we are shown two numbers: the number of problems and the total penalty time. However, for no team we are shown its final place.You know the rules of comparing the results of two given teams very well. Let\'s say that team a solved pa problems with total penalty time ta and team b solved pb problems with total penalty time tb. Team a gets a higher place than team b in the end, if it either solved more problems on the contest, or solved the same number of problems but in less total time. In other words, team a gets a higher place than team b in the final results\' table if either pa\xe2\x80\x89>\xe2\x80\x89pb, or pa\xe2\x80\x89=\xe2\x80\x89pb and ta\xe2\x80\x89<\xe2\x80\x89tb. It is considered that the teams that solve the same number of problems with the same penalty time share all corresponding places. More formally, let\'s say there is a group of x teams that solved the same number of problems with the same penalty time. Let\'s also say that y teams performed better than the teams from this group. In this case all teams from the group share places y\xe2\x80\x89+\xe2\x80\x891, y\xe2\x80\x89+\xe2\x80\x892, ..., y\xe2\x80\x89+\xe2\x80\x89x. The teams that performed worse than the teams from this group, get their places in the results table starting from the y\xe2\x80\x89+\xe2\x80\x89x\xe2\x80\x89+\xe2\x80\x891-th place.Your task is to count what number of teams from the given list shared the k-th place." "binary search,implementation,sortings" 1100
1280F "Intergalactic Sliding Puzzle" "You are an intergalactic surgeon and you have an alien patient. For the purposes of this problem, we can and we will model this patient\'s body using a 2\xc3\x97(2k+1) rectangular grid. The alien has 4k+1 distinct organs, numbered 1 to 4k+1.In healthy such aliens, the organs are arranged in a particular way. For example, here is how the organs of a healthy such alien would be positioned, when viewed from the top, for k=4:  Here, the E represents empty space. In general, the first row contains organs 1 to 2k+1 (in that order from left to right), and the second row contains organs 2k+2 to 4k+1 (in that order from left to right) and then empty space right after. Your patient\'s organs are complete, and inside their body, but they somehow got shuffled around! Your job, as an intergalactic surgeon, is to put everything back in its correct position. All organs of the alien must be in its body during the entire procedure. This means that at any point during the procedure, there is exactly one cell (in the grid) that is empty. In addition, you can only move organs around by doing one of the following things:  You can switch the positions of the empty space E with any organ to its immediate left or to its immediate right (if they exist). In reality, you do this by sliding the organ in question to the empty space;  You can switch the positions of the empty space E with any organ to its immediate top or its immediate bottom (if they exist) only if the empty space is on the leftmost column, rightmost column or in the centermost column. Again, you do this by sliding the organ in question to the empty space. Your job is to figure out a sequence of moves you must do during the surgical procedure in order to place back all 4k+1 internal organs of your patient in the correct cells. If it is impossible to do so, you must say so." "combinatorics,constructive algorithms,math" 3400
899F "Letters Removing" "Petya has a string of length n consisting of small and large English letters and digits.He performs m operations. Each operation is described with two integers l and r and a character c: Petya removes from the string all characters c on positions between l and r, inclusive. It\'s obvious that the length of the string remains the same or decreases after each operation.Find how the string will look like after Petya performs all m operations." "data structures,strings" 2100
1156F "Card Bag" "You have a bag which contains n cards. There is a number written on each card; the number on i-th card is ai.You are playing the following game. During each turn, you choose and remove a random card from the bag (all cards that are still left inside the bag are chosen equiprobably). Nothing else happens during the first turn \xe2\x80\x94 but during the next turns, after removing a card (let the number on it be x), you compare it with the card that was removed during the previous turn (let the number on it be y). Possible outcomes are:   if x<y, the game ends and you lose;  if x=y, the game ends and you win;  if x>y, the game continues. If there are no cards left in the bag, you lose. Cards are not returned into the bag after you remove them.You have to calculate the probability of winning in this game. It can be shown that it is in the form of PQ where P and Q are non-negative integers and Q\xe2\x89\xa00, P\xe2\x89\xa4Q. Output the value of P\xe2\x8b\x85Q\xe2\x88\x921 (mod  998244353)." dp,math,probabilities 2300
609F "Frogs and mosquitoes" "There are n frogs sitting on the coordinate axis Ox. For each frog two values xi,\xe2\x80\x89ti are known \xe2\x80\x94 the position and the initial length of the tongue of the i-th frog (it is guaranteed that all positions xi are different). m mosquitoes one by one are landing to the coordinate axis. For each mosquito two values are known pj \xe2\x80\x94 the coordinate of the position where the j-th mosquito lands and bj \xe2\x80\x94 the size of the j-th mosquito. Frogs and mosquitoes are represented as points on the coordinate axis.The frog can eat mosquito if mosquito is in the same position with the frog or to the right, and the distance between them is not greater than the length of the tongue of the frog.If at some moment several frogs can eat a mosquito the leftmost frog will eat it (with minimal xi). After eating a mosquito the length of the tongue of a frog increases with the value of the size of eaten mosquito. It\'s possible that after it the frog will be able to eat some other mosquitoes (the frog should eat them in this case).For each frog print two values \xe2\x80\x94 the number of eaten mosquitoes and the length of the tongue after landing all mosquitoes and after eating all possible mosquitoes by frogs.Each mosquito is landing to the coordinate axis only after frogs eat all possible mosquitoes landed before. Mosquitoes are given in order of their landing to the coordinate axis." "data structures,greedy" 2500
1767E "Algebra Flash" "Algebra Flash 2.2 has just been released!Changelog:  New gamemode! Thank you for the continued support of the game! Huh, is that it? Slightly disappointed, you boot up the game and click on the new gamemode. It says ""Colored platforms"".There are n platforms, numbered from 1 to n, placed one after another. There are m colors available in the game, numbered from 1 to m. The i-th platform is colored ci.You start on the platform 1 and want to reach platform n. In one move, you can jump from some platform i to platforms i+1 or i+2.All platforms are initially deactivated (including platforms 1 and n). For each color j, you can pay xj coins to activate all platforms of that color.You want to activate some platforms so that you could start on an activated platform 1, jump through some activated platforms and reach an activated platform n.What\'s the smallest amount of coins you can spend to achieve that?" "bitmasks,brute force,dp,graphs,math,meet-in-the-middle,trees" 2500
59A Word "Vasya is very upset that many people on the Net mix uppercase and lowercase letters in one word. That\'s why he decided to invent an extension for his favorite browser that would change the letters\' register in every word so that it either only consisted of lowercase letters or, vice versa, only of uppercase ones. At that as little as possible letters should be changed in the word. For example, the word HoUse must be replaced with house, and the word ViP \xe2\x80\x94 with VIP. If a word contains an equal number of uppercase and lowercase letters, you should replace all the letters with lowercase ones. For example, maTRIx should be replaced by matrix. Your task is to use the given method on one given word." implementation,strings 800
730D "Running Over The Bridges" "Polycarp is playing a game called ""Running Over The Bridges"". In this game he has to run over n bridges from the left to the right. Bridges are arranged one after the other, so the i-th bridge begins where the (i\xe2\x80\x89-\xe2\x80\x891)-th bridge ends.You have the following data about bridges: li and ti \xe2\x80\x94 the length of the i-th bridge and the maximum allowed time which Polycarp can spend running over the i-th bridge. Thus, if Polycarp is in the beginning of the bridge i at the time T then he has to leave it at the time T\xe2\x80\x89+\xe2\x80\x89ti or earlier. It is allowed to reach the right end of a bridge exactly at the time T\xe2\x80\x89+\xe2\x80\x89ti.Polycarp can run from the left side to the right one with speed 0.5, so he will run over a bridge with length s in time 2\xc2\xb7s. Besides, he has several magical drinks. If he uses one drink, his speed increases twice (i.e. to value 1) for r seconds. All magical drinks are identical. Please note that Polycarp can use a drink only at integer moments of time, and he drinks it instantly and completely. Additionally, if Polycarp uses a drink at the moment T he can use the next drink not earlier than at the moment T\xe2\x80\x89+\xe2\x80\x89r.What is the minimal number of drinks Polycarp has to use to run over all n bridges? If this number is not greater than 105, then you have to find out the moments of time when Polycarp has to use each magical drink." greedy,implementation,math 2200
1562D2 "Two Hundred Twenty One (hard version)" "This is the hard version of the problem. The difference between the versions is that the hard version does require you to output the numbers of the rods to be removed. You can make hacks only if all versions of the problem are solved.Stitch likes experimenting with different machines with his friend Sparky. Today they built another machine.The main element of this machine are n rods arranged along one straight line and numbered from 1 to n inclusive. Each of these rods must carry an electric charge quantitatively equal to either 1 or \xe2\x88\x921 (otherwise the machine will not work). Another condition for this machine to work is that the sign-variable sum of the charge on all rods must be zero.More formally, the rods can be represented as an array of n numbers characterizing the charge: either 1 or \xe2\x88\x921. Then the condition must hold: a1\xe2\x88\x92a2+a3\xe2\x88\x92a4+\xe2\x80\xa6=0, or n\xe2\x88\x91i=1(\xe2\x88\x921)i\xe2\x88\x921\xe2\x8b\x85ai=0.Sparky charged all n rods with an electric current, but unfortunately it happened that the rods were not charged correctly (the sign-variable sum of the charge is not zero). The friends decided to leave only some of the rods in the machine. Sparky has q questions. In the ith question Sparky asks: if the machine consisted only of rods with numbers li to ri inclusive, what minimal number of rods could be removed from the machine so that the sign-variable sum of charges on the remaining ones would be zero? Also Sparky wants to know the numbers of these rods. Perhaps the friends got something wrong, and the sign-variable sum is already zero. In that case, you don\'t have to remove the rods at all.If the number of rods is zero, we will assume that the sign-variable sum of charges is zero, that is, we can always remove all rods.Help your friends and answer all of Sparky\'s questions!" "data structures,math" 2200
2007A "Dora\'s Set" "Dora has a set s containing integers. In the beginning, she will put all integers in [l,r] into the set s. That is, an integer x is initially contained in the set if and only if l\xe2\x89\xa4x\xe2\x89\xa4r. Then she allows you to perform the following operations:  Select three distinct integers a, b, and c from the set s, such that gcd(a,b)=gcd(b,c)=gcd(a,c)=1\xe2\x80\xa0.  Then, remove these three integers from the set s. What is the maximum number of operations you can perform?\xe2\x80\xa0Recall that gcd(x,y) means the greatest common divisor of integers x and y." "greedy,math,number theory" 800
1638A Reverse "You are given a permutation p1,p2,\xe2\x80\xa6,pn of length n. You have to choose two integers l,r (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n) and reverse the subsegment [l,r] of the permutation. The permutation will become p1,p2,\xe2\x80\xa6,pl\xe2\x88\x921,pr,pr\xe2\x88\x921,\xe2\x80\xa6,pl,pr+1,pr+2,\xe2\x80\xa6,pn.Find the lexicographically smallest permutation that can be obtained by performing exactly one reverse operation on the initial permutation.Note that for two distinct permutations of equal length a and b, a is lexicographically smaller than b if at the first position they differ, a has the smaller element.A permutation is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array) and [1,3,4] is also not a permutation (n=3 but there is 4 in the array)." "constructive algorithms,greedy,math" 800
524D "Social Network" "Polycarpus got an internship in one well-known social network. His test task is to count the number of unique users who have visited a social network during the day. Polycarpus was provided with information on all user requests for this time period. For each query, we know its time... and nothing else, because Polycarpus has already accidentally removed the user IDs corresponding to the requests from the database. Thus, it is now impossible to determine whether any two requests are made by the same person or by different people.But wait, something is still known, because that day a record was achieved \xe2\x80\x94 M simultaneous users online! In addition, Polycarpus believes that if a user made a request at second s, then he was online for T seconds after that, that is, at seconds s, s\xe2\x80\x89+\xe2\x80\x891, s\xe2\x80\x89+\xe2\x80\x892, ..., s\xe2\x80\x89+\xe2\x80\x89T\xe2\x80\x89-\xe2\x80\x891. So, the user\'s time online can be calculated as the union of time intervals of the form [s,\xe2\x80\x89s\xe2\x80\x89+\xe2\x80\x89T\xe2\x80\x89-\xe2\x80\x891] over all times s of requests from him.Guided by these thoughts, Polycarpus wants to assign a user ID to each request so that:  the number of different users online did not exceed M at any moment,  at some second the number of distinct users online reached value M,  the total number of users (the number of distinct identifiers) was as much as possible. Help Polycarpus cope with the test." "greedy,two pointers" 2100
1898C "Colorful Grid" "Elena has a grid formed by n horizontal lines and m vertical lines. The horizontal lines are numbered by integers from 1 to n from top to bottom. The vertical lines are numbered by integers from 1 to m from left to right. For each x and y (1\xe2\x89\xa4x\xe2\x89\xa4n, 1\xe2\x89\xa4y\xe2\x89\xa4m), the notation (x,y) denotes the point at the intersection of the x-th horizontal line and y-th vertical line.Two points (x1,y1) and (x2,y2) are adjacent if and only if |x1\xe2\x88\x92x2|+|y1\xe2\x88\x92y2|=1.  The grid formed by n=4 horizontal lines and m=5 vertical lines. Elena calls a sequence of points p1,p2,\xe2\x80\xa6,pg of length g a walk if and only if all the following conditions hold:   The first point p1 in this sequence is (1,1).  The last point pg in this sequence is (n,m).  For each 1\xe2\x89\xa4i<g, the points pi and pi+1 are adjacent. Note that the walk may contain the same point more than once. In particular, it may contain point (1,1) or (n,m) multiple times.There are n(m\xe2\x88\x921)+(n\xe2\x88\x921)m segments connecting the adjacent points in Elena\'s grid. Elena wants to color each of these segments in blue or red color so that there exists a walk p1,p2,\xe2\x80\xa6,pk+1 of length k+1 such that   out of k segments connecting two consecutive points in this walk, no two consecutive segments have the same color (in other words, for each 1\xe2\x89\xa4i<k, the color of the segment between points pi and pi+1 differs from the color of the segment between points pi+1 and pi+2). Please find any such coloring or report that there is no such coloring." "constructive algorithms" 1700
331B1 "Shave Beaver!" "The Smart Beaver has recently designed and built an innovative nanotechnologic all-purpose beaver mass shaving machine, ""Beavershave 5000"". Beavershave 5000 can shave beavers by families! How does it work? Very easily!There are n beavers, each of them has a unique id from 1 to n. Consider a permutation a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an of n these beavers. Beavershave 5000 needs one session to shave beavers with ids from x to y (inclusive) if and only if there are such indices i1\xe2\x80\x89<\xe2\x80\x89i2\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89ik, that ai1\xe2\x80\x89=\xe2\x80\x89x, ai2\xe2\x80\x89=\xe2\x80\x89x\xe2\x80\x89+\xe2\x80\x891, ..., aik\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89=\xe2\x80\x89y\xe2\x80\x89-\xe2\x80\x891, aik\xe2\x80\x89=\xe2\x80\x89y. And that is really convenient. For example, it needs one session to shave a permutation of beavers 1,\xe2\x80\x892,\xe2\x80\x893,\xe2\x80\x89...,\xe2\x80\x89n.If we can\'t shave beavers from x to y in one session, then we can split these beavers into groups [x,\xe2\x80\x89p1], [p1\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89p2], ..., [pm\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89y] (x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89p1\xe2\x80\x89<\xe2\x80\x89p2\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89pm\xe2\x80\x89<\xe2\x80\x89y), in such a way that the machine can shave beavers in each group in one session. But then Beavershave 5000 needs m\xe2\x80\x89+\xe2\x80\x891 working sessions to shave beavers from x to y.All beavers are restless and they keep trying to swap. So if we consider the problem more formally, we can consider queries of two types:   what is the minimum number of sessions that Beavershave 5000 needs to shave beavers with ids from x to y, inclusive?  two beavers on positions x and y (the beavers ax and ay) swapped. You can assume that any beaver can be shaved any number of times." implementation 1700
1915A "Odd One Out" "You are given three digits a, b, c. Two of them are equal, but the third one is different from the other two. Find the value that occurs exactly once." bitmasks,implementation 800
1814C "Search in Parallel" "Suppose you have n boxes. The i-th box contains infinitely many balls of color i. Sometimes you need to get a ball with some specific color; but you\'re too lazy to do it yourself.You have bought two robots to retrieve the balls for you. Now you have to program them. In order to program the robots, you have to construct two lists [a1,a2,\xe2\x80\xa6,ak] and [b1,b2,\xe2\x80\xa6,bn\xe2\x88\x92k], where the list a represents the boxes assigned to the first robot, and the list b represents the boxes assigned to the second robot. Every integer from 1 to n must be present in exactly one of these lists.When you request a ball with color x, the robots work as follows. Each robot looks through the boxes that were assigned to that robot, in the order they appear in the list. The first robot spends s1 seconds analyzing the contents of a box; the second robot spends s2. As soon as one of the robots finds the box with balls of color x (and analyzes its contents), the search ends. The search time is the number of seconds from the beginning of the search until one of the robots finishes analyzing the contents of the x-th box. If a robot analyzes the contents of all boxes assigned to it, it stops searching.For example, suppose s1=2, s2=3, a=[4,1,5,3,7], b=[2,6]. If you request a ball with color 3, the following happens:  initially, the first robot starts analyzing the box 4, and the second robot starts analyzing the box 2;  at the end of the 2-nd second, the first robot finishes analyzing the box 4. It is not the box you need, so the robot continues with the box 1;  at the end of the 3-rd second, the second robot finishes analyzing the box 2. It is not the box you need, so the robot continues with the box 6;  at the end of the 4-th second, the first robot finishes analyzing the box 1. It is not the box you need, so the robot continues with the box 5;  at the end of the 6-th second, the first robot finishes analyzing the box 5. It is not the box you need, so the robot continues with the box 3. At the same time, the second robot finishes analyzing the box 6. It is not the box you need, and the second robot has analyzed all the boxes in its list, so that robot stops searching;  at the end of the 8-th second, the first robot finishes analyzing the box 3. It is the box you need, so the search ends;  so, the search time is 8 seconds. You know that you are going to request a ball of color 1 r1 times, a ball of color 2 r2 times, and so on. You want to construct the lists a and b for the robots in such a way that the total search time over all requests is the minimum possible." "constructive algorithms,greedy,sortings" 1500
1729E "Guess the Cycle Size" "This is an interactive problem.I want to play a game with you...We hid from you a cyclic graph of n vertices (3\xe2\x89\xa4n\xe2\x89\xa41018). A cyclic graph is an undirected graph of n vertices that form one cycle. Each vertex belongs to the cycle, i.e. the length of the cycle (the number of edges in it) is exactly n. The order of the vertices in the cycle is arbitrary.You can make queries in the following way: ""? a b"" where 1\xe2\x89\xa4a,b\xe2\x89\xa41018 and a\xe2\x89\xa0b. In response to the query, the interactor outputs on a separate line the length of random of two paths from vertex a to vertex b, or -1 if max(a,b)>n. The interactor chooses one of the two paths with equal probability. The length of the path \xe2\x80\x94is the number of edges in it.You win if you guess the number of vertices in the hidden graph (number n) by making no more than 50 queries.Note that the interactor is implemented in such a way that for any ordered pair (a,b), it always returns the same value for query ""? a b"", no matter how many such queries. Note that the ""? b a"" query may be answered differently by the interactor.The vertices in the graph are randomly placed, and their positions are fixed in advance.Hacks are forbidden in this problem. The number of tests the jury has is 50." interactive,probabilities 1800
545B "Equidistant String" "Little Susie loves strings. Today she calculates distances between them. As Susie is a small girl after all, her strings contain only digits zero and one. She uses the definition of Hamming distance:We will define the distance between two strings s and t of the same length consisting of digits zero and one as the number of positions i, such that si isn\'t equal to ti. As besides everything else Susie loves symmetry, she wants to find for two strings s and t of length n such string p of length n, that the distance from p to s was equal to the distance from p to t.It\'s time for Susie to go to bed, help her find such string p or state that it is impossible." greedy 1100
1170F Wheels "Polycarp has n wheels and a car with m slots for wheels. The initial pressure in the i-th wheel is ai.Polycarp\'s goal is to take exactly m wheels among the given n wheels and equalize the pressure in them (then he can put these wheels in a car and use it for driving). In one minute he can decrease or increase the pressure in any (single) wheel by 1. He can increase the pressure no more than k times in total because it is hard to pump up wheels.Help Polycarp and say what is the minimum number of minutes he needs to spend to equalize the pressure of at least m wheels among the given n wheels." "*special problem,binary search,greedy" -999
1543C "Need for Pink Slips" "After defeating a Blacklist Rival, you get a chance to draw 1 reward slip out of x hidden valid slips. Initially, x=3 and these hidden valid slips are Cash Slip, Impound Strike Release Marker and Pink Slip of Rival\'s Car. Initially, the probability of drawing these in a random guess are c, m, and p, respectively. There is also a volatility factor v. You can play any number of Rival Races as long as you don\'t draw a Pink Slip. Assume that you win each race and get a chance to draw a reward slip. In each draw, you draw one of the x valid items with their respective probabilities. Suppose you draw a particular item and its probability of drawing before the draw was a. Then,  If the item was a Pink Slip, the quest is over, and you will not play any more races.  Otherwise,   If a\xe2\x89\xa4v, the probability of the item drawn becomes 0 and the item is no longer a valid item for all the further draws, reducing x by 1. Moreover, the reduced probability a is distributed equally among the other remaining valid items.  If a>v, the probability of the item drawn reduces by v and the reduced probability is distributed equally among the other valid items.  For example,  If (c,m,p)=(0.2,0.1,0.7) and v=0.1, after drawing Cash, the new probabilities will be (0.1,0.15,0.75).  If (c,m,p)=(0.1,0.2,0.7) and v=0.2, after drawing Cash, the new probabilities will be (Invalid,0.25,0.75).  If (c,m,p)=(0.2,Invalid,0.8) and v=0.1, after drawing Cash, the new probabilities will be (0.1,Invalid,0.9).  If (c,m,p)=(0.1,Invalid,0.9) and v=0.2, after drawing Cash, the new probabilities will be (Invalid,Invalid,1.0). You need the cars of Rivals. So, you need to find the expected number of races that you must play in order to draw a pink slip." "bitmasks,brute force,dfs and similar,implementation,math,probabilities" 1900
125A "Measuring Lengths in Baden" "Lengths are measures in Baden in inches and feet. To a length from centimeters it is enough to know that an inch equals three centimeters in Baden and one foot contains 12 inches.You are given a length equal to n centimeters. Your task is to convert it to feet and inches so that the number of feet was maximum. The result should be an integer rounded to the closest value containing an integral number of inches.Note that when you round up, 1 cm rounds up to 0 inches and 2 cm round up to 1 inch." math 1400
1172B "Nauuo and Circle" "Nauuo is a girl who loves drawing circles.One day she has drawn a circle and wanted to draw a tree on it.The tree is a connected undirected graph consisting of n nodes and n\xe2\x88\x921 edges. The nodes are numbered from 1 to n.Nauuo wants to draw a tree on the circle, the nodes of the tree should be in n distinct points on the circle, and the edges should be straight without crossing each other.""Without crossing each other"" means that every two edges have no common point or the only common point is an endpoint of both edges.Nauuo wants to draw the tree using a permutation of n elements. A permutation of n elements is a sequence of integers p1,p2,\xe2\x80\xa6,pn in which every integer from 1 to n appears exactly once.After a permutation is chosen Nauuo draws the i-th node in the pi-th point on the circle, then draws the edges connecting the nodes.The tree is given, Nauuo wants to know how many permutations are there so that the tree drawn satisfies the rule (the edges are straight without crossing each other). She only wants to know the answer modulo 998244353, can you help her?It is obvious that whether a permutation is valid or not does not depend on which n points on the circle are chosen." "combinatorics,dfs and similar,dp,trees" 1900
165B "Burning Midnight Oil" "One day a highly important task was commissioned to Vasya \xe2\x80\x94 writing a program in a night. The program consists of n lines of code. Vasya is already exhausted, so he works like that: first he writes v lines of code, drinks a cup of tea, then he writes as much as  lines, drinks another cup of tea, then he writes  lines and so on: , , , ...The expression  is regarded as the integral part from dividing number a by number b.The moment the current value  equals 0, Vasya immediately falls asleep and he wakes up only in the morning, when the program should already be finished.Vasya is wondering, what minimum allowable value v can take to let him write not less than n lines of code before he falls asleep." "binary search,implementation" 1500
61A "Ultra-Fast Mathematician" "Shapur was an extremely gifted student. He was great at everything including Combinatorics, Algebra, Number Theory, Geometry, Calculus, etc. He was not only smart but extraordinarily fast! He could manage to sum 1018 numbers in a single second.One day in 230 AD Shapur was trying to find out if any one can possibly do calculations faster than him. As a result he made a very great contest and asked every one to come and take part.In his contest he gave the contestants many different pairs of numbers. Each number is made from digits 0 or 1. The contestants should write a new number corresponding to the given pair of numbers. The rule is simple: The i-th digit of the answer is 1 if and only if the i-th digit of the two given numbers differ. In the other case the i-th digit of the answer is 0.Shapur made many numbers and first tried his own speed. He saw that he can perform these operations on numbers of length \xe2\x88\x9e (length of a number is number of digits in it) in a glance! He always gives correct answers so he expects the contestants to give correct answers, too. He is a good fellow so he won\'t give anyone very big numbers and he always gives one person numbers of same length.Now you are going to take part in Shapur\'s contest. See if you are faster and more accurate." implementation 800
1685D2 "Permutation Weight (Hard Version)" "This is a hard version of the problem. The difference between the easy and hard versions is that in this version, you have to output the lexicographically smallest permutation with the smallest weight.You are given a permutation p1,p2,\xe2\x80\xa6,pn of integers from 1 to n.Let\'s define the weight of the permutation q1,q2,\xe2\x80\xa6,qn of integers from 1 to n as |q1\xe2\x88\x92pq2|+|q2\xe2\x88\x92pq3|+\xe2\x80\xa6+|qn\xe2\x88\x921\xe2\x88\x92pqn|+|qn\xe2\x88\x92pq1|You want your permutation to be as lightweight as possible. Among the permutations q with the smallest possible weight, find the lexicographically smallest.Permutation a1,a2,\xe2\x80\xa6,an is lexicographically smaller than permutation b1,b2,\xe2\x80\xa6,bn, if there exists some 1\xe2\x89\xa4i\xe2\x89\xa4n such that aj=bj for all 1\xe2\x89\xa4j<i and ai<bi." "constructive algorithms,greedy" 3500
1251E2 "Voting (Hard Version)" "The only difference between easy and hard versions is constraints.Now elections are held in Berland and you want to win them. More precisely, you want everyone to vote for you.There are n voters, and two ways to convince each of them to vote for you. The first way to convince the i-th voter is to pay him pi coins. The second way is to make mi other voters vote for you, and the i-th voter will vote for free.Moreover, the process of such voting takes place in several steps. For example, if there are five voters with m1=1, m2=2, m3=2, m4=4, m5=5, then you can buy the vote of the fifth voter, and eventually everyone will vote for you. Set of people voting for you will change as follows: 5\xe2\x86\x921,5\xe2\x86\x921,2,3,5\xe2\x86\x921,2,3,4,5.Calculate the minimum number of coins you have to spend so that everyone votes for you." "binary search,data structures,greedy" 2400
354A "Vasya and Robot" "Vasya has n items lying in a line. The items are consecutively numbered by numbers from 1 to n in such a way that the leftmost item has number 1, the rightmost item has number n. Each item has a weight, the i-th item weights wi kilograms.Vasya needs to collect all these items, however he won\'t do it by himself. He uses his brand new robot. The robot has two different arms \xe2\x80\x94 the left one and the right one. The robot can consecutively perform the following actions:   Take the leftmost item with the left hand and spend wi\xe2\x80\x89\xc2\xb7\xe2\x80\x89l energy units (wi is a weight of the leftmost item, l is some parameter). If the previous action was the same (left-hand), then the robot spends extra Ql energy units;  Take the rightmost item with the right hand and spend wj\xe2\x80\x89\xc2\xb7\xe2\x80\x89r energy units (wj is a weight of the rightmost item, r is some parameter). If the previous action was the same (right-hand), then the robot spends extra Qr energy units; Naturally, Vasya wants to program the robot in a way that the robot spends as little energy as possible. He asked you to solve this problem. Your task is to find the minimum number of energy units robot spends to collect all items." "brute force,greedy,math" 1500
412B "Network Configuration" "The R1 company wants to hold a web search championship. There were n computers given for the competition, each of them is connected to the Internet. The organizers believe that the data transfer speed directly affects the result. The higher the speed of the Internet is, the faster the participant will find the necessary information. Therefore, before the competition started, each computer had its maximum possible data transfer speed measured. On the i-th computer it was ai kilobits per second.There will be k participants competing in the championship, each should get a separate computer. The organizing company does not want any of the participants to have an advantage over the others, so they want to provide the same data transfer speed to each participant\'s computer. Also, the organizers want to create the most comfortable conditions for the participants, so the data transfer speed on the participants\' computers should be as large as possible.The network settings of the R1 company has a special option that lets you to cut the initial maximum data transfer speed of any computer to any lower speed. How should the R1 company configure the network using the described option so that at least k of n computers had the same data transfer speed and the data transfer speed on these computers was as large as possible?" greedy,sortings 900
1181E1 "A Story of One Country (Easy)" "This problem differs from the next problem only in constraints.Petya decided to visit Byteland during the summer holidays. It turned out that the history of this country is quite unusual.Initially, there were n different countries on the land that is now Berland. Each country had its own territory that was represented as a rectangle on the map. The sides of the rectangle were parallel to the axes, and the corners were located at points with integer coordinates. Territories of no two countries intersected, but it was possible that some territories touched each other. As time passed, sometimes two countries merged into one. It only happened if the union of their territories was also a rectangle. In the end only one country remained \xe2\x80\x94 Byteland.Initially, each country had a rectangular castle inside its territory. Its sides were parallel to the axes and its corners had integer coordinates. Some castles might touch the border of the corresponding country and sides or other castles. Miraculously, after all the unions the castles are still intact. Unfortunately, their locations are the only information we have to restore the initial territories of the countries.  The possible formation of Byteland. The castles are shown in blue. Petya wonders why no information about the initial countries remained. He suspected that the whole story is a fake. You were recommended to him as a smart person. Please check whether or not there exists a possible set of initial territories that could make the story true." "brute force,divide and conquer,sortings" 2500
1805F2 "Survival of the Weakest (hard version)" "This is the hard version of the problem. It differs from the easy one only in constraints on n. You can make hacks only if you lock both versions.Let a1,a2,\xe2\x80\xa6,an be an array of non-negative integers. Let F(a1,a2,\xe2\x80\xa6,an) be the sorted in the non-decreasing order array of n\xe2\x88\x921 smallest numbers of the form ai+aj, where 1\xe2\x89\xa4i<j\xe2\x89\xa4n. In other words, F(a1,a2,\xe2\x80\xa6,an) is the sorted in the non-decreasing order array of n\xe2\x88\x921 smallest sums of all possible pairs of elements of the array a1,a2,\xe2\x80\xa6,an. For example, F(1,2,5,7)=[1+2,1+5,2+5]=[3,6,7].You are given an array of non-negative integers a1,a2,\xe2\x80\xa6,an. Determine the single element of the array F(F(F\xe2\x80\xa6F\xe2\x8f\x9fn\xe2\x88\x921(a1,a2,\xe2\x80\xa6,an)\xe2\x80\xa6)). Since the answer can be quite large, output it modulo 109+7." "greedy,math,sortings,two pointers" 3100
1777D "Score of a Tree" "You are given a tree of n nodes, rooted at 1. Every node has a value of either 0 or 1 at time t=0.At any integer time t>0, the value of a node becomes the bitwise XOR of the values of its children at time t\xe2\x88\x921; the values of leaves become 0 since they don\'t have any children.Let S(t) denote the sum of values of all nodes at time t. Let F(A) denote the sum of S(t) across all values of t such that 0\xe2\x89\xa4t\xe2\x89\xa410100, where A is the initial assignment of 0s and 1s in the tree.The task is to find the sum of F(A) for all 2n initial configurations of 0s and 1s in the tree. Print the sum modulo 109+7." "bitmasks,combinatorics,dfs and similar,dp,math,probabilities,trees" 1900
1366C "Palindromic Paths" "You are given a matrix with n rows (numbered from 1 to n) and m columns (numbered from 1 to m). A number ai,j is written in the cell belonging to the i-th row and the j-th column, each number is either 0 or 1.A chip is initially in the cell (1,1), and it will be moved to the cell (n,m). During each move, it either moves to the next cell in the current row, or in the current column (if the current cell is (x,y), then after the move it can be either (x+1,y) or (x,y+1)). The chip cannot leave the matrix.Consider each path of the chip from (1,1) to (n,m). A path is called palindromic if the number in the first cell is equal to the number in the last cell, the number in the second cell is equal to the number in the second-to-last cell, and so on.Your goal is to change the values in the minimum number of cells so that every path is palindromic." greedy,math 1500
1779D "Boris and His Amazing Haircut" "Boris thinks that chess is a tedious game. So he left his tournament early and went to a barber shop as his hair was a bit messy.His current hair can be described by an array a1,a2,\xe2\x80\xa6,an, where ai is the height of the hair standing at position i. His desired haircut can be described by an array b1,b2,\xe2\x80\xa6,bn in a similar fashion.The barber has m razors. Each has its own size and can be used at most once. In one operation, he chooses a razor and cuts a segment of Boris\'s hair. More formally, an operation is:  Choose any razor which hasn\'t been used before, let its size be x;  Choose a segment [l,r] (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n);  Set ai:=min(ai,x) for each l\xe2\x89\xa4i\xe2\x89\xa4r; Notice that some razors might have equal sizes \xe2\x80\x94 the barber can choose some size x only as many times as the number of razors with size x. He may perform as many operations as he wants, as long as any razor is used at most once and ai=bi for each 1\xe2\x89\xa4i\xe2\x89\xa4n at the end. He does not have to use all razors.Can you determine whether the barber can give Boris his desired haircut?" "constructive algorithms,data structures,dp,dsu,greedy,sortings" 1700
1555D "Say No to Palindromes" "Let\'s call the string beautiful if it does not contain a substring of length at least 2, which is a palindrome. Recall that a palindrome is a string that reads the same way from the first character to the last and from the last character to the first. For example, the strings a, bab, acca, bcabcbacb are palindromes, but the strings ab, abbbaa, cccb are not.Let\'s define cost of a string as the minimum number of operations so that the string becomes beautiful, if in one operation it is allowed to change any character of the string to one of the first 3 letters of the Latin alphabet (in lowercase).You are given a string s of length n, each character of the string is one of the first 3 letters of the Latin alphabet (in lowercase).You have to answer m queries \xe2\x80\x94 calculate the cost of the substring of the string s from li-th to ri-th position, inclusive." "brute force,constructive algorithms,dp,strings" 1600
436B "Om Nom and Spiders" "Om Nom really likes candies and doesn\'t like spiders as they frequently steal candies. One day Om Nom fancied a walk in a park. Unfortunately, the park has some spiders and Om Nom doesn\'t want to see them at all.  The park can be represented as a rectangular n\xe2\x80\x89\xc3\x97\xe2\x80\x89m field. The park has k spiders, each spider at time 0 is at some cell of the field. The spiders move all the time, and each spider always moves in one of the four directions (left, right, down, up). In a unit of time, a spider crawls from his cell to the side-adjacent cell in the corresponding direction. If there is no cell in the given direction, then the spider leaves the park. The spiders do not interfere with each other as they move. Specifically, one cell can have multiple spiders at the same time.Om Nom isn\'t yet sure where to start his walk from but he definitely wants:  to start walking at time 0 at an upper row cell of the field (it is guaranteed that the cells in this row do not contain any spiders);  to walk by moving down the field towards the lowest row (the walk ends when Om Nom leaves the boundaries of the park). We know that Om Nom moves by jumping. One jump takes one time unit and transports the little monster from his cell to either a side-adjacent cell on the lower row or outside the park boundaries.Each time Om Nom lands in a cell he sees all the spiders that have come to that cell at this moment of time. Om Nom wants to choose the optimal cell to start the walk from. That\'s why he wonders: for each possible starting cell, how many spiders will he see during the walk if he starts from this cell? Help him and calculate the required value for each possible starting cell." implementation,math 1400
1397A "Juggling Letters" "You are given n strings s1,s2,\xe2\x80\xa6,sn consisting of lowercase Latin letters.In one operation you can remove a character from a string si and insert it to an arbitrary position in a string sj (j may be equal to i). You may perform this operation any number of times. Is it possible to make all n strings equal?" greedy,strings 800
1365D "Solve The Maze" "Vivek has encountered a problem. He has a maze that can be represented as an n\xc3\x97m grid. Each of the grid cells may represent the following:  Empty \xe2\x80\x94 \'.\'  Wall \xe2\x80\x94 \'#\'  Good person  \xe2\x80\x94 \'G\'  Bad person \xe2\x80\x94 \'B\' The only escape from the maze is at cell (n,m).A person can move to a cell only if it shares a side with their current cell and does not contain a wall. Vivek wants to block some of the empty cells by replacing them with walls in such a way, that all the good people are able to escape, while none of the bad people are able to. A cell that initially contains \'G\' or \'B\' cannot be blocked and can be travelled through.Help him determine if there exists a way to replace some (zero or more) empty cells with walls to satisfy the above conditions.It is guaranteed that the cell (n,m) is empty. Vivek can also block this cell." "constructive algorithms,dfs and similar,dsu,graphs,greedy,implementation,shortest paths" 1700
1689E ANDfinity "Bit Lightyear, to the ANDfinity and beyond!After graduating from computer sciences, Vlad has been awarded an array a1,a2,\xe2\x80\xa6,an of n non-negative integers. As it is natural, he wanted to construct a graph consisting of n vertices, numbered 1,2,\xe2\x80\xa6,n. He decided to add an edge between i and j if and only if ai&aj>0, where & denotes the bitwise AND operation.Vlad also wants the graph to be connected, which might not be the case initially. In order to satisfy that, he can do the following two types of operations on the array:  Choose some element ai and increment it by 1.  Choose some element ai and decrement it by 1 (possible only if ai>0). It can be proven that there exists a finite sequence of operations such that the graph will be connected. So, can you please help Vlad find the minimum possible number of operations to do that and also provide the way how to do that?" "bitmasks,brute force,constructive algorithms,dfs and similar,dsu,graphs" 2500
1954E "Chain Reaction" "There are n monsters standing in a row. The i-th monster has ai health points.Every second, you can choose one alive monster and launch a chain lightning at it. The lightning deals k damage to it, and also spreads to the left (towards decreasing i) and to the right (towards increasing i) to alive monsters, dealing k damage to each. When the lightning reaches a dead monster or the beginning/end of the row, it stops. A monster is considered alive if its health points are strictly greater than 0.For example, consider the following scenario: there are three monsters with health equal to [5,2,7], and k=3. You can kill them all in 4 seconds:  launch a chain lightning at the 3-rd monster, then their health values are [2,\xe2\x88\x921,4];  launch a chain lightning at the 1-st monster, then their health values are [\xe2\x88\x921,\xe2\x88\x921,4];  launch a chain lightning at the 3-rd monster, then their health values are [\xe2\x88\x921,\xe2\x88\x921,1];  launch a chain lightning at the 3-th monster, then their health values are [\xe2\x88\x921,\xe2\x88\x921,\xe2\x88\x922]. For each k from 1 to max(a1,a2,\xe2\x80\xa6,an), calculate the minimum number of seconds it takes to kill all the monsters." "binary search,data structures,dsu,greedy,implementation,math,number theory" 2200
353A Domino "Valera has got n domino pieces in a row. Each piece consists of two halves \xe2\x80\x94 the upper one and the lower one. Each of the halves contains a number from 1 to 6. Valera loves even integers very much, so he wants the sum of the numbers on the upper halves and the sum of the numbers on the lower halves to be even.To do that, Valera can rotate the dominoes by 180 degrees. After the rotation the upper and the lower halves swap places. This action takes one second. Help Valera find out the minimum time he must spend rotating dominoes to make his wish come true." implementation,math 1200
1519E "Off by One" "There are n points on an infinite plane. The i-th point has coordinates (xi,yi) such that xi>0 and yi>0. The coordinates are not necessarily integer.In one move you perform the following operations:   choose two points a and b (a\xe2\x89\xa0b);  move point a from (xa,ya) to either (xa+1,ya) or (xa,ya+1);  move point b from (xb,yb) to either (xb+1,yb) or (xb,yb+1);  remove points a and b. However, the move can only be performed if there exists a line that passes through the new coordinates of a, new coordinates of b and (0,0). Otherwise, the move can\'t be performed and the points stay at their original coordinates (xa,ya) and (xb,yb), respectively.The numeration of points does not change after some points are removed. Once the points are removed, they can\'t be chosen in any later moves. Note that you have to move both points during the move, you can\'t leave them at their original coordinates.What is the maximum number of moves you can perform? What are these moves?If there are multiple answers, you can print any of them." "constructive algorithms,dfs and similar,geometry,graphs,sortings,trees" 2700
417B Crash "During the ""Russian Code Cup"" programming competition, the testing system stores all sent solutions for each participant. We know that many participants use random numbers in their programs and are often sent several solutions with the same source code to check.Each participant is identified by some unique positive integer k, and each sent solution A is characterized by two numbers: x \xe2\x80\x94 the number of different solutions that are sent before the first solution identical to A, and k \xe2\x80\x94 the number of the participant, who is the author of the solution. Consequently, all identical solutions have the same x.It is known that the data in the testing system are stored in the chronological order, that is, if the testing system has a solution with number x (x\xe2\x80\x89>\xe2\x80\x890) of the participant with number k, then the testing system has a solution with number x\xe2\x80\x89-\xe2\x80\x891 of the same participant stored somewhere before.During the competition the checking system crashed, but then the data of the submissions of all participants have been restored. Now the jury wants to verify that the recovered data is in chronological order. Help the jury to do so." implementation 1400
2011B Shuffle "Yes, this is another one of those constructive permutation problems.You are given an integer n. You have to construct a permutation p of size n, i.\xe2\x80\x89e. an array of n integers, where every integer from 1 to n appears exactly once.Every pair of adjacent elements in the permutation (pi and pi+1) must meet the following condition:  if one of them is divisible by the other, the condition pi<pi+1 must hold;  otherwise, the condition pi>pi+1 must hold." "*special problem" -999
1167E "Range Deleting" "You are given an array consisting of n integers a1,a2,\xe2\x80\xa6,an and an integer x. It is guaranteed that for every i, 1\xe2\x89\xa4ai\xe2\x89\xa4x.Let\'s denote a function f(l,r) which erases all values such that l\xe2\x89\xa4ai\xe2\x89\xa4r from the array a and returns the resulting array. For example, if a=[4,1,1,4,5,2,4,3], then f(2,4)=[1,1,5].Your task is to calculate the number of pairs (l,r) such that 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4x and f(l,r) is sorted in non-descending order. Note that the empty array is also considered sorted." "binary search,combinatorics,data structures,two pointers" 2100
1764A "Doremy\'s Paint" "Doremy has n buckets of paint which is represented by an array a of length n. Bucket i contains paint with color ai. Let c(l,r) be the number of distinct elements in the subarray [al,al+1,\xe2\x80\xa6,ar]. Choose 2 integers l and r such that l\xe2\x89\xa4r and r\xe2\x88\x92l\xe2\x88\x92c(l,r) is maximized." greedy 800
1299D "Around the World" "Guy-Manuel and Thomas are planning 144 trips around the world.You are given a simple weighted undirected connected graph with n vertexes and m edges with the following restriction: there isn\'t any simple cycle (i. e. a cycle which doesn\'t pass through any vertex more than once) of length greater than 3 which passes through the vertex 1. The cost of a path (not necessarily simple) in this graph is defined as the XOR of weights of all edges in that path with each edge being counted as many times as the path passes through it.But the trips with cost 0 aren\'t exciting. You may choose any subset of edges incident to the vertex 1 and remove them. How many are there such subsets, that, when removed, there is not any nontrivial cycle with the cost equal to 0 which passes through the vertex 1 in the resulting graph? A cycle is called nontrivial if it passes through some edge odd number of times. As the answer can be very big, output it modulo 109+7." "bitmasks,combinatorics,dfs and similar,dp,graphs,graphs,math,trees" 3000
1452E "Two Editorials" "Berland regional ICPC contest has just ended. There were m participants numbered from 1 to m, who competed on a problemset of n problems numbered from 1 to n.Now the editorial is about to take place. There are two problem authors, each of them is going to tell the tutorial to exactly k consecutive tasks of the problemset. The authors choose the segment of k consecutive tasks for themselves independently of each other. The segments can coincide, intersect or not intersect at all.The i-th participant is interested in listening to the tutorial of all consecutive tasks from li to ri. Each participant always chooses to listen to only the problem author that tells the tutorials to the maximum number of tasks he is interested in. Let this maximum number be ai. No participant can listen to both of the authors, even if their segments don\'t intersect.The authors want to choose the segments of k consecutive tasks for themselves in such a way that the sum of ai over all participants is maximized." "brute force,dp,greedy,sortings,two pointers" 2500
1462E2 "Close Tuples (hard version)" "This is the hard version of this problem. The only difference between the easy and hard versions is the constraints on k and m. In this version of the problem, you need to output the answer by modulo 109+7.You are given a sequence a of length n consisting of integers from 1 to n. The sequence may contain duplicates (i.e. some elements can be equal).Find the number of tuples of m elements such that the maximum number in the tuple differs from the minimum by no more than k. Formally, you need to find the number of tuples of m indices i1<i2<\xe2\x80\xa6<im, such thatmax(ai1,ai2,\xe2\x80\xa6,aim)\xe2\x88\x92min(ai1,ai2,\xe2\x80\xa6,aim)\xe2\x89\xa4k.For example, if n=4, m=3, k=2, a=[1,2,4,3], then there are two such triples (i=1,j=2,z=4 and i=2,j=3,z=4). If n=4, m=2, k=1, a=[1,1,1,1], then all six possible pairs are suitable.As the result can be very large, you should print the value modulo 109+7 (the remainder when divided by 109+7)." "binary search,combinatorics,implementation,math,sortings,two pointers" 1700
1492B "Card Deck" "You have a deck of n cards, and you\'d like to reorder it to a new one.Each card has a value between 1 and n equal to pi. All pi are pairwise distinct. Cards in a deck are numbered from bottom to top, i. e. p1 stands for the bottom card, pn is the top card. In each step you pick some integer k>0, take the top k cards from the original deck and place them, in the order they are now, on top of the new deck. You perform this operation until the original deck is empty. (Refer to the notes section for the better understanding.)Let\'s define an order of a deck as n\xe2\x88\x91i=1nn\xe2\x88\x92i\xe2\x8b\x85pi.Given the original deck, output the deck with maximum possible order you can make using the operation above." "data structures,greedy,math" 1100
1995E2 "Let Me Teach You a Lesson (Hard Version)" "This is the hard version of a problem. The only difference between an easy and a hard version is the constraints on t and n. You can make hacks only if both versions of the problem are solved.Arthur is giving a lesson to his famous 2n knights. Like any other students, they\'re sitting at the desks in pairs, but out of habit in a circle. The knight 2i\xe2\x88\x921 is sitting at the desk with the knight 2i.Each knight has intelligence, which can be measured by an integer. Let\'s denote the intelligence of the i-th knight as ai. Arthur wants the maximal difference in total intelligence over all pairs of desks to be as small as possible. More formally, he wants to minimize max1\xe2\x89\xa4i\xe2\x89\xa4n(a2i\xe2\x88\x921+a2i)\xe2\x88\x92min1\xe2\x89\xa4i\xe2\x89\xa4n(a2i\xe2\x88\x921+a2i).However, the Code of Chivalry only allows swapping the opposite knights in the circle, i.e., Arthur can simultaneously perform ai:=ai+n, ai+n:=ai for any 1\xe2\x89\xa4i\xe2\x89\xa4n. Arthur can make any number of such swaps. What is the best result he can achieve?" "data structures,dp,matrices,two pointers" 2900
1059C "Sequence Transformation" "Let\'s call the following process a transformation of a sequence of length n.If the sequence is empty, the process ends. Otherwise, append the greatest common divisor (GCD) of all the elements of the sequence to the result and remove one arbitrary element from the sequence. Thus, when the process ends, we have a sequence of n integers: the greatest common divisors of all the elements in the sequence before each deletion.You are given an integer sequence 1,2,\xe2\x80\xa6,n. Find the lexicographically maximum result of its transformation.A sequence a1,a2,\xe2\x80\xa6,an is lexicographically larger than a sequence b1,b2,\xe2\x80\xa6,bn, if there is an index i such that aj=bj for all j<i, and ai>bi." "constructive algorithms,math" 1600
1282B1 "K for the Price of One (Easy Version)" "This is the easy version of this problem. The only difference is the constraint on k \xe2\x80\x94 the number of gifts in the offer. In this version: k=2.Vasya came to the store to buy goods for his friends for the New Year. It turned out that he was very lucky \xe2\x80\x94 today the offer ""k of goods for the price of one"" is held in store. Remember, that in this problem k=2.Using this offer, Vasya can buy exactly k of any goods, paying only for the most expensive of them. Vasya decided to take this opportunity and buy as many goods as possible for his friends with the money he has.More formally, for each good, its price is determined by ai \xe2\x80\x94 the number of coins it costs. Initially, Vasya has p coins. He wants to buy the maximum number of goods. Vasya can perform one of the following operations as many times as necessary:  Vasya can buy one good with the index i if he currently has enough coins (i.e p\xe2\x89\xa5ai). After buying this good, the number of Vasya\'s coins will decrease by ai, (i.e it becomes p:=p\xe2\x88\x92ai).  Vasya can buy a good with the index i, and also choose exactly k\xe2\x88\x921 goods, the price of which does not exceed ai, if he currently has enough coins (i.e p\xe2\x89\xa5ai). Thus, he buys all these k goods, and his number of coins decreases by ai (i.e it becomes p:=p\xe2\x88\x92ai). Please note that each good can be bought no more than once.For example, if the store now has n=5 goods worth a1=2,a2=4,a3=3,a4=5,a5=7, respectively, k=2, and Vasya has 6 coins, then he can buy 3 goods. A good with the index 1 will be bought by Vasya without using the offer and he will pay 2 coins. Goods with the indices 2 and 3 Vasya will buy using the offer and he will pay 4 coins. It can be proved that Vasya can not buy more goods with six coins.Help Vasya to find out the maximum number of goods he can buy." dp,greedy,sortings 1400
331C2 "The Great Julya Calendar" "Yet another Armageddon is coming! This time the culprit is the Julya tribe calendar. The beavers in this tribe knew math very well. Smart Beaver, an archaeologist, got a sacred plate with a magic integer on it. The translation from Old Beaverish is as follows: ""May the Great Beaver bless you! May your chacres open and may your third eye never turn blind from beholding the Truth! Take the magic number, subtract a digit from it (the digit must occur in the number) and get a new magic number. Repeat this operation until a magic number equals zero. The Earth will stand on Three Beavers for the time, equal to the number of subtractions you perform!""Distinct subtraction sequences can obviously get you different number of operations. But the Smart Beaver is ready to face the worst and is asking you to count the minimum number of operations he needs to reduce the magic number to zero." dp 2400
20A "BerOS file system" "The new operating system BerOS has a nice feature. It is possible to use any number of characters \'/\' as a delimiter in path instead of one traditional \'/\'. For example, strings //usr///local//nginx/sbin// and /usr/local/nginx///sbin are equivalent. The character \'/\' (or some sequence of such characters) at the end of the path is required only in case of the path to the root directory, which can be represented as single character \'/\'.A path called normalized if it contains the smallest possible number of characters \'/\'.Your task is to transform a given path to the normalized form." implementation 1700
1276D "Tree Elimination" "Vasya has a tree with n vertices numbered from 1 to n, and n\xe2\x88\x921 edges numbered from 1 to n\xe2\x88\x921. Initially each vertex contains a token with the number of the vertex written on it.Vasya plays a game. He considers all edges of the tree by increasing of their indices. For every edge he acts as follows: If both endpoints of the edge contain a token, remove a token from one of the endpoints and write down its number. Otherwise, do nothing.The result of the game is the sequence of numbers Vasya has written down. Note that there may be many possible resulting sequences depending on the choice of endpoints when tokens are removed.Vasya has played for such a long time that he thinks he exhausted all possible resulting sequences he can obtain. He wants you to verify him by computing the number of distinct sequences modulo 998244353." dp,trees 2900
1861F "Four Suits" "The game of Berland poker is played as follows. There are n+1 people: n players, numbered from 1 to n, and the dealer. The dealer has a deck which contains cards of four different suits (the number of cards of each suit is not necessarily the same); the number of cards in the deck is divisible by n. The dealer gives all cards to the players, so that every player receives the same number of cards, and the whole deck is used.After the cards are dealt, every player chooses one of four suits (independently) and discards all cards from their hand which do not belong to their chosen suit. The winner of the game is the player with the maximum number of cards left in their hand. The number of points the winner receives is x\xe2\x88\x92y, where x is the number of cards in the winner\'s hand, and y is the maximum number of cards among all other players; everyone else receives 0 points. Note that it means that if there are multiple players with the maximum number of cards, everyone receives 0 points.Since every player wants to maximize their odds to win, they will choose a suit with the maximum number of cards in their hand.Monocarp is the dealer. He has already given some cards to the players; the i-th player received ai,j cards of suit j. Note that the number of cards in players\' hands don\'t have to be the same at this moment. Monocarp has b1,b2,b3,b4 cards of suit 1,2,3,4 respectively left in his deck. He has to give them to the players so that, after all cards are dealt, every player has the same number of cards.For each player, calculate the maximum number of points they can receive among all ways to deal the remaining cards according to the rules of the game." "binary search,bitmasks,flows,greedy" 3200
1883F "You Are So Beautiful" "You are given an array of integers a1,a2,\xe2\x80\xa6,an. Calculate the number of subarrays of this array 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n, such that: The array b=[al,al+1,\xe2\x80\xa6,ar] occurs in the array a as a subsequence exactly once. In other words, there is exactly one way to select a set of indices 1\xe2\x89\xa4i1<i2<\xe2\x80\xa6<ir\xe2\x88\x92l+1\xe2\x89\xa4n, such that bj=aij for all 1\xe2\x89\xa4j\xe2\x89\xa4r\xe2\x88\x92l+1." "data structures" 1400
103E "Buying Sets" "The Hexadecimal virus loves playing with number sets \xe2\x80\x94 intersecting them, uniting them. One beautiful day she was surprised to find out that Scuzzy, her spherical pet cat, united all sets in one and ate the result! Something had to be done quickly and Hexadecimal rushed to the market.The market has n sets of numbers on sale. The virus wants to buy the following collection of sets: the number of sets in the collection should be exactly the same as the number of numbers in the union of all bought sets. Moreover, Hexadecimal wants to buy the cheapest suitable collection of set.Yet nothing\'s so easy! As Mainframe is a kingdom of pure rivalry markets, we know that the union of any k sets contains no less than k distinct numbers (for every positive integer k).Help the virus choose the suitable collection of sets. The collection can be empty." "flows,graph matchings" 2900
1245A "Good ol\' Numbers Coloring" "Consider the set of all nonnegative integers: 0,1,2,\xe2\x80\xa6. Given two integers a and b (1\xe2\x89\xa4a,b\xe2\x89\xa4104). We paint all the numbers in increasing number first we paint 0, then we paint 1, then 2 and so on.Each number is painted white or black. We paint a number i according to the following rules:   if i=0, it is colored white;   if i\xe2\x89\xa5a and i\xe2\x88\x92a is colored white, i is also colored white;   if i\xe2\x89\xa5b and i\xe2\x88\x92b is colored white, i is also colored white;   if i is still not colored white, it is colored black. In this way, each nonnegative integer gets one of two colors.For example, if a=3, b=5, then the colors of the numbers (in the order from 0) are: white (0), black (1), black (2), white (3), black (4), white (5), white (6), black (7), white (8), white (9), ...Note that:   It is possible that there are infinitely many nonnegative integers colored black. For example, if a=10 and b=10, then only 0,10,20,30 and any other nonnegative integers that end in 0 when written in base 10 are white. The other integers are colored black.   It is also possible that there are only finitely many nonnegative integers colored black. For example, when a=1 and b=10, then there is no nonnegative integer colored black at all. Your task is to determine whether or not the number of nonnegative integers colored black is infinite.If there are infinitely many nonnegative integers colored black, simply print a line containing ""Infinite"" (without the quotes). Otherwise, print ""Finite"" (without the quotes)." "math,number theory" 1000
1113A "Sasha and His Trip" "Sasha is a very happy guy, that\'s why he is always on the move. There are n cities in the country where Sasha lives. They are all located on one straight line, and for convenience, they are numbered from 1 to n in increasing order. The distance between any two adjacent cities is equal to 1 kilometer. Since all roads in the country are directed, it\'s possible to reach the city y from the city x only if x<y. Once Sasha decided to go on a trip around the country and to visit all n cities. He will move with the help of his car, Cheetah-2677. The tank capacity of this model is v liters, and it spends exactly 1 liter of fuel for 1 kilometer of the way. At the beginning of the journey, the tank is empty. Sasha is located in the city with the number 1 and wants to get to the city with the number n. There is a gas station in each city. In the i-th city, the price of 1 liter of fuel is i dollars. It is obvious that at any moment of time, the tank can contain at most v liters of fuel.Sasha doesn\'t like to waste money, that\'s why he wants to know what is the minimum amount of money is needed to finish the trip if he can buy fuel in any city he wants. Help him to figure it out!" dp,greedy,math 900
2020A "Find Minimum Operations" "You are given two integers n and k.In one operation, you can subtract any power of k from n. Formally, in one operation, you can replace n by (n\xe2\x88\x92kx) for any non-negative integer x.Find the minimum number of operations required to make n equal to 0." "bitmasks,brute force,greedy,math,number theory" 800
429C "Guess the Tree" "Iahub and Iahubina went to a picnic in a forest full of trees. Less than 5 minutes passed before Iahub remembered of trees from programming. Moreover, he invented a new problem and Iahubina has to solve it, otherwise Iahub won\'t give her the food. Iahub asks Iahubina: can you build a rooted tree, such that  each internal node (a node with at least one son) has at least two sons;  node i has ci nodes in its subtree? Iahubina has to guess the tree. Being a smart girl, she realized that it\'s possible no tree can follow Iahub\'s restrictions. In this way, Iahub will eat all the food. You need to help Iahubina: determine if there\'s at least one tree following Iahub\'s restrictions. The required tree must contain n nodes." "bitmasks,constructive algorithms,dp,greedy,trees" 2300
48G "Galaxy Union" "In a far away galaxy there are n inhabited planets numbered with numbers from 1 to n. One day the presidents of all the n planets independently from each other came up with an idea of creating the Galaxy Union. Now they need to share this wonderful idea with their galaxymates, that\xe2\x80\x99s why each president is busy working out a project of negotiating with the other presidents.For negotiations between some pairs of the planets there are bidirectional communication channels, each of which is characterized with ""dial duration"" ti which, as a rule, takes several hours and exceeds the call duration greatly. Overall the galaxy has n communication channels and they unite all the planets into a uniform network. That means that it is possible to phone to any planet v from any planet u, perhaps, using some transitional planets v1, v2, ..., vm via the existing channels between u and v1, v1 and v2, ..., vm\xe2\x80\x89-\xe2\x80\x891 and vm, vm and v. At that the dial duration from u to v will be equal to the sum of dial durations of the used channels.So, every president has to talk one by one to the presidents of all the rest n\xe2\x80\x89-\xe2\x80\x891 planets. At that the negotiations take place strictly consecutively, and until the negotiations with a planet stop, the dial to another one does not begin. As the matter is urgent, from the different ways to call the needed planet every time the quickest one is chosen. Little time is needed to assure another president on the importance of the Galaxy Union, that\xe2\x80\x99s why the duration of the negotiations with each planet can be considered equal to the dial duration time for those planets. As the presidents know nothing about each other\xe2\x80\x99s plans, they do not take into consideration the possibility that, for example, the sought president may call himself or already know about the founding of the Galaxy Union from other sources.The governments of all the n planets asked you to work out the negotiation plans. First you are to find out for every president how much time his supposed negotiations will take." "dp,trees,two pointers" 2700
1339A "Filling Diamonds" "You have integer n. Calculate how many ways are there to fully cover belt-like area of 4n\xe2\x88\x922 triangles with diamond shapes. Diamond shape consists of two triangles. You can move, rotate or flip the shape, but you cannot scale it. 2 coverings are different if some 2 triangles are covered by the same diamond shape in one of them and by different diamond shapes in the other one.Please look at pictures below for better understanding.  On the left you can see the diamond shape you will use, and on the right you can see the area you want to fill. These are the figures of the area you want to fill for n=1,2,3,4. You have to answer t independent test cases." "brute force,dp,implementation,math" 900
1624C "Division by Two and Permutation" "You are given an array a consisting of n positive integers. You can perform operations on it.In one operation you can replace any element of the array ai with \xe2\x8c\x8aai2\xe2\x8c\x8b, that is, by an integer part of dividing ai by 2 (rounding down).See if you can apply the operation some number of times (possible 0) to make the array a become a permutation of numbers from 1 to n \xe2\x80\x94that is, so that it contains all numbers from 1 to n, each exactly once.For example, if a=[1,8,25,2], n=4, then the answer is yes. You could do the following:  Replace 8 with \xe2\x8c\x8a82\xe2\x8c\x8b=4, then a=[1,4,25,2].  Replace 25 with \xe2\x8c\x8a252\xe2\x8c\x8b=12, then a=[1,4,12,2].  Replace 12 with \xe2\x8c\x8a122\xe2\x8c\x8b=6, then a=[1,4,6,2].  Replace 6 with \xe2\x8c\x8a62\xe2\x8c\x8b=3, then a=[1,4,3,2]." "constructive algorithms,flows,graph matchings,greedy,math" 1100
1971G XOUR "You are given an array a consisting of n nonnegative integers. You can swap the elements at positions i and j if ai XOR aj<4, where XOR is the bitwise XOR operation.Find the lexicographically smallest array that can be made with any number of swaps.An array x is lexicographically smaller than an array y if in the first position where x and y differ, xi<yi." "data structures,dsu,sortings" 1700
1421C Palindromifier "Ringo found a string s of length n in his yellow submarine. The string contains only lowercase letters from the English alphabet. As Ringo and his friends love palindromes, he would like to turn the string s into a palindrome by applying two types of operations to the string. The first operation allows him to choose i (2\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921) and to append the substring s2s3\xe2\x80\xa6si (i\xe2\x88\x921 characters) reversed to the front of s.The second operation allows him to choose i (2\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921) and to append the substring sisi+1\xe2\x80\xa6sn\xe2\x88\x921 (n\xe2\x88\x92i characters) reversed to the end of s.Note that characters in the string in this problem are indexed from 1.For example suppose s=abcdef. If he performs the first operation with i=3 then he appends cb to the front of s and the result will be cbabcdef. Performing the second operation on the resulted string with i=5 will yield cbabcdefedc.Your task is to help Ringo make the entire string a palindrome by applying any of the two operations (in total) at most 30 times. The length of the resulting palindrome must not exceed 106It is guaranteed that under these constraints there always is a solution. Also note you do not have to minimize neither the number of operations applied, nor the length of the resulting string, but they have to fit into the constraints." "constructive algorithms,strings" 1400
182B "Vasya\'s Calendar" "Vasya lives in a strange world. The year has n months and the i-th month has ai days. Vasya got a New Year present \xe2\x80\x94 the clock that shows not only the time, but also the date.The clock\'s face can display any number from 1 to d. It is guaranteed that ai\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89d for all i from 1 to n. The clock does not keep information about the current month, so when a new day comes, it simply increases the current day number by one. The clock cannot display number d\xe2\x80\x89+\xe2\x80\x891, so after day number d it shows day 1 (the current day counter resets). The mechanism of the clock allows you to increase the day number by one manually. When you execute this operation, day d is also followed by day 1.Vasya begins each day checking the day number on the clock. If the day number on the clock does not match the actual day number in the current month, then Vasya manually increases it by one. Vasya is persistent and repeats this operation until the day number on the clock matches the actual number of the current day in the current month.A year passed and Vasya wonders how many times he manually increased the day number by one, from the first day of the first month to the last day of the n-th month inclusive, considering that on the first day of the first month the clock display showed day 1." implementation 1000
875A "Classroom Watch" "Eighth-grader Vova is on duty today in the class. After classes, he went into the office to wash the board, and found on it the number n. He asked what is this number and the teacher of mathematics Inna Petrovna answered Vova that n is the answer to the arithmetic task for first-graders. In the textbook, a certain positive integer x was given. The task was to add x to the sum of the digits of the number x written in decimal numeral system.Since the number n on the board was small, Vova quickly guessed which x could be in the textbook. Now he wants to get a program which will search for arbitrary values of the number n for all suitable values of x or determine that such x does not exist. Write such a program for Vova." "brute force,math" 1200
1979B "XOR Sequences" "You are given two distinct non-negative integers x and y. Consider two infinite sequences a1,a2,a3,\xe2\x80\xa6 and b1,b2,b3,\xe2\x80\xa6, where  an=n\xe2\x8a\x95x;  bn=n\xe2\x8a\x95y. Here, x\xe2\x8a\x95y denotes the bitwise XOR operation of integers x and y.For example, with x=6, the first 8 elements of sequence a will look as follows: [7,4,5,2,3,0,1,14,\xe2\x80\xa6]. Note that the indices of elements start with 1.Your task is to find the length of the longest common subsegment\xe2\x80\xa0 of sequences a and b. In other words, find the maximum integer m such that ai=bj,ai+1=bj+1,\xe2\x80\xa6,ai+m\xe2\x88\x921=bj+m\xe2\x88\x921 for some i,j\xe2\x89\xa51.\xe2\x80\xa0A subsegment of sequence p is a sequence pl,pl+1,\xe2\x80\xa6,pr, where 1\xe2\x89\xa4l\xe2\x89\xa4r." bitmasks,greedy 1000
2035H "Peak Productivity Forces" "I\'m peakly productive and this is deep.You are given two permutations\xe2\x88\x97 a and b, both of length n.You can perform the following three-step operation on permutation a:  Choose an index i (1\xe2\x89\xa4i\xe2\x89\xa4n). Cyclic shift a1,a2,\xe2\x80\xa6,ai\xe2\x88\x921 by 1 to the right. If you had chosen i=1, then this range doesn\'t exist, and you cyclic shift nothing. Cyclic shift ai+1,ai+2,\xe2\x80\xa6,an by 1 to the right. If you had chosen i=n, then this range doesn\'t exist, and you cyclic shift nothing.After the operation, a1,a2,\xe2\x80\xa6,ai\xe2\x88\x922,ai\xe2\x88\x921,ai,ai+1,ai+2,\xe2\x80\xa6,an\xe2\x88\x921,an is transformed into ai\xe2\x88\x921,a1,\xe2\x80\xa6,ai\xe2\x88\x923,ai\xe2\x88\x922,ai,an,ai+1,\xe2\x80\xa6,an\xe2\x88\x922,an\xe2\x88\x921.Here are some examples of operations done on the identity permutation [1,2,3,4,5,6,7] of length 7:   If we choose i=3, it will become [2,1,3,7,4,5,6].  If we choose i=1, it will become [1,7,2,3,4,5,6].  If we choose i=7, it will become [6,1,2,3,4,5,7].  Notably, position i is not shifted. Find a construction using at most 2n operations to make a equal to b or print \xe2\x88\x921 if it is impossible. The number of operations does not need to be minimized. It can be shown that if it is possible to make a equal to b, it is possible to do this within 2n operations. \xe2\x88\x97A permutation of length n is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array), and [1,3,4] is also not a permutation (n=3 but there is 4 in the array)." "constructive algorithms" 3500
1571C Rhyme "Let\'s say that two strings s and t rhyme if both strings have length at least k, and their last k characters are equal. For example, if k=3, the strings abcd and cebcd rhyme, the strings ab and ab don\'t rhyme, the strings aaaa and aaaaa rhyme, the strings abcd and abce don\'t rhyme.You have n pairs of strings (si,ti), and for each pair of strings you know, should they rhyme or should not.Find all possible non-negative integer values for k such that pairs that have to rhyme, rhyme and pairs that must not rhyme, don\'t rhyme." "*special problem,implementation" 1800
275A "Lights Out" "Lenny is playing a game on a 3\xe2\x80\x89\xc3\x97\xe2\x80\x893 grid of lights. In the beginning of the game all lights are switched on. Pressing any of the lights will toggle it and all side-adjacent lights. The goal of the game is to switch all the lights off. We consider the toggling as follows: if the light was switched on then it will be switched off, if it was switched off then it will be switched on.Lenny has spent some time playing with the grid and by now he has pressed each light a certain number of times. Given the number of times each light is pressed, you have to print the current state of each light." implementation 900
1356C "Prepare state |01\xe2\x9f\xa9 + |10\xe2\x9f\xa9 + |11\xe2\x9f\xa9" "You are given two qubits in state |00\xe2\x9f\xa9. Your task is to prepare the following state on them:1\xe2\x88\x9a3(|01\xe2\x9f\xa9+|10\xe2\x9f\xa9+|11\xe2\x9f\xa9)This task is very similar to problem A1 of the Winter 2019 contest, but this time you are not allowed to use any gates except the Pauli gates (X, Y and Z), the Hadamard gate and the controlled versions of those. However, you are allowed to use measurements.You have to implement an operation which takes an array of 2 qubits as an input and has no output. The ""output"" of your solution is the state in which it left the input qubits.Your code should have the following signature:namespace Solution {    open Microsoft.Quantum.Intrinsic;    operation Solve (qs : Qubit[]) : Unit {        // your code here    }}" "*special problem" -999
429A Xor-tree "Iahub is very proud of his recent discovery, propagating trees. Right now, he invented a new tree, called xor-tree. After this new revolutionary discovery, he invented a game for kids which uses xor-trees.The game is played on a tree having n nodes, numbered from 1 to n. Each node i has an initial value initi, which is either 0 or 1. The root of the tree is node 1.One can perform several (possibly, zero) operations on the tree during the game. The only available type of operation is to pick a node x. Right after someone has picked node x, the value of node x flips, the values of sons of x remain the same, the values of sons of sons of x flips, the values of sons of sons of sons of x remain the same and so on.The goal of the game is to get each node i to have value goali, which can also be only 0 or 1. You need to reach the goal of the game by using minimum number of operations." "dfs and similar,trees" 1300
1957C "How Does the Rook Move?" "You are given an n\xc3\x97n chessboard where you and the computer take turns alternatingly to place white rooks & black rooks on the board respectively. While placing rooks, you have to ensure that no two rooks attack each other. Two rooks attack each other if they share the same row or column regardless of color.A valid move is placing a rook on a position (r, c) such that it doesn\'t attack any other rook.You start first, and when you make a valid move in your turn, placing a white rook at position (r, c), the computer will mirror you and place a black rook at position (c, r) in its turn. If r=c, then the computer can\'t mirror your move, and skips its turn.You have already played k moves with the computer (the computer tries to mirror these moves too), and you must continue playing the game until there are no valid moves remaining. How many different final configurations are possible when you continue the game after the k moves? It is guaranteed that the k moves and the implied computer moves are valid. Since the answer may be large, print it modulo 109+7.Two configurations are considered different if there exists a coordinate (r, c) which has a rook in one configuration, but not in the other or the color of the rook on the coordinate is different." combinatorics,dp,math 1600
935F "Fafa and Array" "Fafa has an array A of n positive integers, the function f(A) is defined as . He wants to do q queries of two types:  1\xe2\x80\x89l\xe2\x80\x89r\xe2\x80\x89x \xe2\x80\x94 find the maximum possible value of f(A), if x is to be added to one element in the range [l,\xe2\x80\x89\xe2\x80\x89r]. You can choose to which element to add x.  2\xe2\x80\x89l\xe2\x80\x89r\xe2\x80\x89x \xe2\x80\x94 increase all the elements in the range [l,\xe2\x80\x89\xe2\x80\x89r] by value x. Note that queries of type 1 don\'t affect the array elements." "data structures,greedy" 2600
1157F "Maximum Balanced Circle" "There are n people in a row. The height of the i-th person is ai. You can choose any subset of these people and try to arrange them into a balanced circle.A balanced circle is such an order of people that the difference between heights of any adjacent people is no more than 1. For example, let heights of chosen people be [ai1,ai2,\xe2\x80\xa6,aik], where k is the number of people you choose. Then the condition |aij\xe2\x88\x92aij+1|\xe2\x89\xa41 should be satisfied for all j from 1 to k\xe2\x88\x921 and the condition |ai1\xe2\x88\x92aik|\xe2\x89\xa41 should be also satisfied. |x| means the absolute value of x. It is obvious that the circle consisting of one person is balanced.Your task is to choose the maximum number of people and construct a balanced circle consisting of all chosen people. It is obvious that the circle consisting of one person is balanced so the answer always exists." "constructive algorithms,dp,greedy,two pointers" 2000
796B "Find The Bone" "Zane the wizard is going to perform a magic show shuffling the cups.There are n cups, numbered from 1 to n, placed along the x-axis on a table that has m holes on it. More precisely, cup i is on the table at the position x\xe2\x80\x89=\xe2\x80\x89i.The problematic bone is initially at the position x\xe2\x80\x89=\xe2\x80\x891. Zane will confuse the audience by swapping the cups k times, the i-th time of which involves the cups at the positions x\xe2\x80\x89=\xe2\x80\x89ui and x\xe2\x80\x89=\xe2\x80\x89vi. If the bone happens to be at the position where there is a hole at any time, it will fall into the hole onto the ground and will not be affected by future swapping operations.Do not forget that Zane is a wizard. When he swaps the cups, he does not move them ordinarily. Instead, he teleports the cups (along with the bone, if it is inside) to the intended positions. Therefore, for example, when he swaps the cup at x\xe2\x80\x89=\xe2\x80\x894 and the one at x\xe2\x80\x89=\xe2\x80\x896, they will not be at the position x\xe2\x80\x89=\xe2\x80\x895 at any moment during the operation.  Zane\xe2\x80\x99s puppy, Inzane, is in trouble. Zane is away on his vacation, and Inzane cannot find his beloved bone, as it would be too exhausting to try opening all the cups. Inzane knows that the Codeforces community has successfully helped Zane, so he wants to see if it could help him solve his problem too. Help Inzane determine the final position of the bone." implementation 1300
1191B "Tokitsukaze and Mahjong" "Tokitsukaze is playing a game derivated from Japanese mahjong. In this game, she has three tiles in her hand. Each tile she owns is a suited tile, which means it has a suit (manzu, pinzu or souzu) and a number (a digit ranged from 1 to 9). In this problem, we use one digit and one lowercase letter, which is the first character of the suit, to represent a suited tile. All possible suited tiles are represented as 1m, 2m, \xe2\x80\xa6, 9m, 1p, 2p, \xe2\x80\xa6, 9p, 1s, 2s, \xe2\x80\xa6, 9s.In order to win the game, she must have at least one mentsu (described below) in her hand, so sometimes she should draw extra suited tiles. After drawing a tile, the number of her tiles increases by one. She can draw any tiles she wants, including those already in her hand.Do you know the minimum number of extra suited tiles she needs to draw so that she can win?Here are some useful definitions in this game:  A mentsu, also known as meld, is formed by a koutsu or a shuntsu;  A koutsu, also known as triplet, is made of three identical tiles, such as [1m, 1m, 1m], however, [1m, 1p, 1s] or [1m, 4m, 7m] is NOT a koutsu;  A shuntsu, also known as sequence, is made of three sequential numbered tiles in the same suit, such as [1m, 2m, 3m] and [5s, 7s, 6s], however, [9m, 1m, 2m] or [1m, 2p, 3s] is NOT a shuntsu. Some examples:   [2m, 3p, 2s, 4m, 1s, 2s, 4s] \xe2\x80\x94 it contains no koutsu or shuntsu, so it includes no mentsu;  [4s, 3m, 3p, 4s, 5p, 4s, 5p] \xe2\x80\x94 it contains a koutsu, [4s, 4s, 4s], but no shuntsu, so it includes a mentsu;  [5p, 5s, 9m, 4p, 1s, 7p, 7m, 6p] \xe2\x80\x94 it contains no koutsu but a shuntsu, [5p, 4p, 6p] or [5p, 7p, 6p], so it includes a mentsu. Note that the order of tiles is unnecessary and you can assume the number of each type of suited tiles she can draw is infinite." "brute force,implementation" 1200
378A "Playing with Dice" "Two players are playing a game. First each of them writes an integer from 1 to 6, and then a dice is thrown. The player whose written number got closer to the number on the dice wins. If both payers have the same difference, it\'s a draw.The first player wrote number a, the second player wrote number b. How many ways to throw a dice are there, at which the first player wins, or there is a draw, or the second player wins?" "brute force" 800
1601B "Frog Traveler" "Frog Gorf is traveling through Swamp kingdom. Unfortunately, after a poor jump, he fell into a well of n meters depth. Now Gorf is on the bottom of the well and has a long way up.The surface of the well\'s walls vary in quality: somewhere they are slippery, but somewhere have convenient ledges. In other words, if Gorf is on x meters below ground level, then in one jump he can go up on any integer distance from 0 to ax meters inclusive. (Note that Gorf can\'t jump down, only up).Unfortunately, Gorf has to take a break after each jump (including jump on 0 meters). And after jumping up to position x meters below ground level, he\'ll slip exactly bx meters down while resting.Calculate the minimum number of jumps Gorf needs to reach ground level." "data structures,dfs and similar,dp,graphs,shortest paths,two pointers" 1900
1957D "A BIT of an Inequality" "You are given an array a1,a2,\xe2\x80\xa6,an. Find the number of tuples (x,y,z) such that:   1\xe2\x89\xa4x\xe2\x89\xa4y\xe2\x89\xa4z\xe2\x89\xa4n, and  f(x,y)\xe2\x8a\x95f(y,z)>f(x,z). We define f(l,r)=al\xe2\x8a\x95al+1\xe2\x8a\x95\xe2\x80\xa6\xe2\x8a\x95ar, where \xe2\x8a\x95 denotes the bitwise XOR operation." "bitmasks,brute force,dp,math" 1900
1864G "Magic Square" "Aquamoon has a Rubik\'s Square which can be seen as an n\xc3\x97n matrix, the elements of the matrix constitute a permutation of numbers 1,\xe2\x80\xa6,n2.Aquamoon can perform two operations on the matrix:  Row shift, i.e. shift an entire row of the matrix several positions (at least 1 and at most n\xe2\x88\x921) to the right. The elements that come out of the right border of the matrix are moved to the beginning of the row. For example, shifting a row (abc) by 2 positions would result in (bca); Column shift, i.e. shift an entire column of the matrix several positions (at least 1 and at most n\xe2\x88\x921) downwards. The elements that come out of the lower border of the matrix are moved to the beginning of the column. For example, shifting a column (abc) by 2 positions would result in (bca). The rows are numbered from 1 to n from top to bottom, the columns are numbered from 1 to n from left to right. The cell at the intersection of the x-th row and the y-th column is denoted as (x,y).Aquamoon can perform several (possibly, zero) operations, but she has to obey the following restrictions: each row and each column can be shifted at most once; each integer of the matrix can be moved at most twice; the offsets of any two integers moved twice cannot be the same. Formally, if integers a and b have been moved twice, assuming a has changed its position from (x1,y1) to (x2,y2), and b has changed its position from (x3,y3) to (x4,y4), then x2\xe2\x88\x92x1\xe2\x89\xa2x4\xe2\x88\x92x3(modn) or y2\xe2\x88\x92y1\xe2\x89\xa2y4\xe2\x88\x92y3(modn).Aquamoon wonders in how many ways she can transform the Rubik\'s Square from the given initial state to a given target state. Two ways are considered different if the sequences of applied operations are different. Since the answer can be very large, print the result modulo 998244353." "combinatorics,constructive algorithms,implementation" 3100
1859B "Olya and Game with Arrays" "Artem suggested a game to the girl Olya. There is a list of n arrays, where the i-th array contains mi\xe2\x89\xa52 positive integers ai,1,ai,2,\xe2\x80\xa6,ai,mi.Olya can move at most one (possibly 0) integer from each array to another array. Note that integers can be moved from one array only once, but integers can be added to one array multiple times, and all the movements are done at the same time.The beauty of the list of arrays is defined as the sum \xe2\x88\x91ni=1minmij=1ai,j. In other words, for each array, we find the minimum value in it and then sum up these values.The goal of the game is to maximize the beauty of the list of arrays. Help Olya win this challenging game!" "constructive algorithms,greedy,math,sortings" 1000
373A "Collecting Beats is Fun" "Cucumber boy is fan of Kyubeat, a famous music game.Kyubeat has 16 panels for playing arranged in 4\xe2\x80\x89\xc3\x97\xe2\x80\x894 table. When a panel lights up, he has to press that panel.Each panel has a timing to press (the preffered time when a player should press it), and Cucumber boy is able to press at most k panels in a time with his one hand. Cucumber boy is trying to press all panels in perfect timing, that is he wants to press each panel exactly in its preffered time. If he cannot press the panels with his two hands in perfect timing, his challenge to press all the panels in perfect timing will fail.You are given one scene of Kyubeat\'s panel from the music Cucumber boy is trying. Tell him is he able to press all the panels in perfect timing." implementation 900
989B "A Tide of Riverscape" "Walking along a riverside, Mino silently takes a note of something.""Time,"" Mino thinks aloud.""What?""""Time and tide wait for no man,"" explains Mino. ""My name, taken from the river, always reminds me of this.""""And what are you recording?""""You see it, tide. Everything has its own period, and I think I\'ve figured out this one,"" says Mino with confidence.Doubtfully, Kanno peeks at Mino\'s records. The records are expressed as a string s of characters \'0\', \'1\' and \'.\', where \'0\' denotes a low tide, \'1\' denotes a high tide, and \'.\' denotes an unknown one (either high or low).You are to help Mino determine whether it\'s possible that after replacing each \'.\' independently with \'0\' or \'1\', a given integer p is not a period of the resulting string. In case the answer is yes, please also show such a replacement to Mino.In this problem, a positive integer p is considered a period of string s, if for all 1\xe2\x89\xa4i\xe2\x89\xa4|s|\xe2\x88\x92p, the i-th and (i+p)-th characters of s are the same. Here |s| is the length of s." "constructive algorithms,strings" 1200
1466B "Last minute enhancements" "Athenaeus has just finished creating his latest musical composition and will present it tomorrow to the people of Athens. Unfortunately, the melody is rather dull and highly likely won\'t be met with a warm reception. His song consists of n notes, which we will treat as positive integers. The diversity of a song is the number of different notes it contains. As a patron of music, Euterpe watches over composers and guides them throughout the process of creating new melodies. She decided to help Athenaeus by changing his song to make it more diverse.Being a minor goddess, she cannot arbitrarily change the song. Instead, for each of the n notes in the song, she can either leave it as it is or increase it by 1.Given the song as a sequence of integers describing the notes, find out the maximal, achievable diversity." dp,greedy 800
1693F "I Might Be Wrong" "You are given a binary string S of length n indexed from 1 to n. You can perform the following operation any number of times (possibly zero):Choose two integers l and r (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n). Let cnt0 be the number of times 0 occurs in S[l\xe2\x80\xa6r] and cnt1 be the number of times 1 occurs in S[l\xe2\x80\xa6r]. You can pay |cnt0\xe2\x88\x92cnt1|+1 coins and sort the S[l\xe2\x80\xa6r]. (by S[l\xe2\x80\xa6r] we mean the substring of S starting at position l and ending at position r)For example if S= 11001, we can perform the operation on S[2\xe2\x80\xa64], paying |2\xe2\x88\x921|+1=2 coins, and obtain S= 10011 as a new string.Find the minimum total number of coins required to sort S in increasing order." "binary search,greedy,two pointers" 3400
110B "Lucky String" "Petya loves lucky numbers. We all know that lucky numbers are the positive integers whose decimal representations contain only the lucky digits 4 and 7. For example, numbers 47, 744, 4 are lucky and 5, 17, 467 are not.Petya recently learned to determine whether a string of lowercase Latin letters is lucky. For each individual letter all its positions in the string are written out in the increasing order. This results in 26 lists of numbers; some of them can be empty. A string is considered lucky if and only if in each list the absolute difference of any two adjacent numbers is a lucky number. For example, let\'s consider string ""zbcdzefdzc"". The lists of positions of equal letters are: b: 2 c: 3,\xe2\x80\x8910 d: 4,\xe2\x80\x898 e: 6 f: 7 z: 1,\xe2\x80\x895,\xe2\x80\x899 Lists of positions of letters a, g, h, ..., y are empty.This string is lucky as all differences are lucky numbers. For letters z: 5\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89=\xe2\x80\x894, 9\xe2\x80\x89-\xe2\x80\x895\xe2\x80\x89=\xe2\x80\x894, for letters c: 10\xe2\x80\x89-\xe2\x80\x893\xe2\x80\x89=\xe2\x80\x897, for letters d: 8\xe2\x80\x89-\xe2\x80\x894\xe2\x80\x89=\xe2\x80\x894. Note that if some letter occurs only once in a string, it doesn\'t influence the string\'s luckiness after building the lists of positions of equal letters. The string where all the letters are distinct is considered lucky.Find the lexicographically minimal lucky string whose length equals n." "constructive algorithms,strings" 1100
1779E "Anya\'s Simultaneous Exhibition" "This is an interactive problem.Anya has gathered n chess experts numbered from 1 to n for which the following properties hold:  For any pair of players one of the players wins every game against the other (and no draws ever occur);  Transitivity does not necessarily hold \xe2\x80\x94 it might happen that A always beats B, B always beats C and C always beats A.  Anya does not know, for each pair, who is the player who beats the other.To organize a tournament, Anya hosts n\xe2\x88\x921 games. In each game, she chooses two players. One of them wins and stays, while the other one is disqualified. After all the games are hosted only one player will remain. A player is said to be a candidate master if they can win a tournament (notice that the winner of a tournament may depend on the players selected by Anya in the n\xe2\x88\x921 games).Since Anya is a curious girl, she is interested in finding the candidate masters. Unfortunately, she does not have much time. To speed up the process, she will organize up to 2n simuls (short for ""simultaneous exhibition"", in which one player plays against many).In one simul, Anya chooses exactly one player who will play against some (at least one) of the other players. The chosen player wins all games they would win in a regular game, and the same holds for losses. After the simul finishes, Anya is only told the total number of games won by the chosen player (but not which ones). Nobody is disqualified during a simul.Can you help Anya host simuls and determine the candidate masters?The winning players in each pair could be changed between the simuls, but only in a way that preserves the results of all previous simuls. These changes may depend on your queries." "constructive algorithms,graphs,greedy,interactive,sortings" 2400
1108A "Two distinct points" "You are given two segments [l1;r1] and [l2;r2] on the x-axis. It is guaranteed that l1<r1 and l2<r2. Segments may intersect, overlap or even coincide with each other.  The example of two segments on the x-axis. Your problem is to find two integers a and b such that l1\xe2\x89\xa4a\xe2\x89\xa4r1, l2\xe2\x89\xa4b\xe2\x89\xa4r2 and a\xe2\x89\xa0b. In other words, you have to choose two distinct integer points in such a way that the first point belongs to the segment [l1;r1] and the second one belongs to the segment [l2;r2].It is guaranteed that the answer exists. If there are multiple answers, you can print any of them.You have to answer q independent queries." implementation 800
1181D Irrigation "Misha was interested in water delivery from childhood. That\'s why his mother sent him to the annual Innovative Olympiad in Irrigation (IOI). Pupils from all Berland compete there demonstrating their skills in watering. It is extremely expensive to host such an olympiad, so after the first n olympiads the organizers introduced the following rule of the host city selection.The host cities of the olympiads are selected in the following way. There are m cities in Berland wishing to host the olympiad, they are numbered from 1 to m. The host city of each next olympiad is determined as the city that hosted the olympiad the smallest number of times before. If there are several such cities, the city with the smallest index is selected among them.Misha\'s mother is interested where the olympiad will be held in some specific years. The only information she knows is the above selection rule and the host cities of the first n olympiads. Help her and if you succeed, she will ask Misha to avoid flooding your house." "binary search,data structures,implementation,sortings,trees,two pointers" 2200
580C "Kefa and Park" "Kefa decided to celebrate his first big salary by going to the restaurant. He lives by an unusual park. The park is a rooted tree consisting of n vertices with the root at vertex 1. Vertex 1 also contains Kefa\'s house. Unfortunaely for our hero, the park also contains cats. Kefa has already found out what are the vertices with cats in them.The leaf vertices of the park contain restaurants. Kefa wants to choose a restaurant where he will go, but unfortunately he is very afraid of cats, so there is no way he will go to the restaurant if the path from the restaurant to his house contains more than m consecutive vertices with cats. Your task is to help Kefa count the number of restaurants where he can go." "dfs and similar,graphs,trees" 1500
177D1 "Encrypting Messages" "The Smart Beaver from ABBYY invented a new message encryption method and now wants to check its performance. Checking it manually is long and tiresome, so he decided to ask the ABBYY Cup contestants for help.A message is a sequence of n integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. Encryption uses a key which is a sequence of m integers b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bm (m\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n). All numbers from the message and from the key belong to the interval from 0 to c\xe2\x80\x89-\xe2\x80\x891, inclusive, and all the calculations are performed modulo c.Encryption is performed in n\xe2\x80\x89-\xe2\x80\x89m\xe2\x80\x89+\xe2\x80\x891 steps. On the first step we add to each number a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89am a corresponding number b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bm. On the second step we add to each number a2,\xe2\x80\x89a3,\xe2\x80\x89...,\xe2\x80\x89am\xe2\x80\x89+\xe2\x80\x891 (changed on the previous step) a corresponding number b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bm. And so on: on step number i we add to each number ai,\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x89m\xe2\x80\x89-\xe2\x80\x891 a corresponding number b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bm. The result of the encryption is the sequence a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an after n\xe2\x80\x89-\xe2\x80\x89m\xe2\x80\x89+\xe2\x80\x891 steps.Help the Beaver to write a program that will encrypt messages in the described manner." "brute force" 1200
1951G "Clacking Balls" "Rammstein - Ausl\xc3\xa4nder\xe0\xb6\x9eThere are m baskets placed along a circle, numbered from 1 to m in clockwise order (basket m is next to basket 1). Furthermore, there are n balls, where ball i is initially placed in basket ai, and no basket contains more than one ball.Alice is allowed to perform the following operation, which always takes exactly one second whether you move/throw a ball or not:   Alice chooses an integer i between 1 and n uniformly at random.  If ball i was thrown away before, do nothing.  Otherwise, ball i is moved from the basket currently containing it to the next basket (in clockwise order). If the target basket currently contains another ball j, throw ball j away. She repeats this operation until there is exactly one ball left. Calculate the expected time needed (in seconds) for Alice to end the process.It can be proven that the answer can be represented as a rational number pq with coprime p and q. You need to output p\xe2\x8b\x85q\xe2\x88\x921mod109+7. It can be proven that 109+7\xe2\x88\xa4q." combinatorics,math,probabilities 3100
271E "Three Horses" "There are three horses living in a horse land: one gray, one white and one gray-and-white. The horses are really amusing animals, which is why they adore special cards. Each of those cards must contain two integers, the first one on top, the second one in the bottom of the card. Let\'s denote a card with a on the top and b in the bottom as (a,\xe2\x80\x89b).Each of the three horses can paint the special cards. If you show an (a,\xe2\x80\x89b) card to the gray horse, then the horse can paint a new (a\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89b\xe2\x80\x89+\xe2\x80\x891) card. If you show an (a,\xe2\x80\x89b) card, such that a and b are even integers, to the white horse, then the horse can paint a new  card. If you show two cards (a,\xe2\x80\x89b) and (b,\xe2\x80\x89c) to the gray-and-white horse, then he can paint a new (a,\xe2\x80\x89c) card.Polycarpus really wants to get n special cards (1,\xe2\x80\x89a1), (1,\xe2\x80\x89a2), ..., (1,\xe2\x80\x89an). For that he is going to the horse land. He can take exactly one (x,\xe2\x80\x89y) card to the horse land, such that 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89<\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m. How many ways are there to choose the card so that he can perform some actions in the horse land and get the required cards?Polycarpus can get cards from the horses only as a result of the actions that are described above. Polycarpus is allowed to get additional cards besides the cards that he requires." "constructive algorithms,math,number theory" 2200
898D "Alarm Clock" "Every evening Vitalya sets n alarm clocks to wake up tomorrow. Every alarm clock rings during exactly one minute and is characterized by one integer ai \xe2\x80\x94 number of minute after midnight in which it rings. Every alarm clock begins ringing at the beginning of the minute and rings during whole minute. Vitalya will definitely wake up if during some m consecutive minutes at least k alarm clocks will begin ringing. Pay attention that Vitalya considers only alarm clocks which begin ringing during given period of time. He doesn\'t consider alarm clocks which started ringing before given period of time and continues ringing during given period of time.Vitalya is so tired that he wants to sleep all day long and not to wake up. Find out minimal number of alarm clocks Vitalya should turn off to sleep all next day. Now all alarm clocks are turned on." greedy 1600
1275B "Code Review" "\xd0\xa3 \xd0\xba\xd0\xbe\xd0\xbc\xd0\xb0\xd0\xbd\xd0\xb4\xd1\x8b \xd1\x80\xd0\xb0\xd0\xb7\xd1\x80\xd0\xb0\xd0\xb1\xd0\xbe\xd1\x82\xd0\xba\xd0\xb8 \xd0\xb4\xd0\xb2\xd0\xb8\xd0\xb6\xd0\xba\xd0\xbe\xd0\xb2 \xd0\x92\xd0\x9a\xd0\xbe\xd0\xbd\xd1\x82\xd0\xb0\xd0\xba\xd1\x82\xd0\xb5 \xd0\xb5\xd1\x81\xd1\x82\xd1\x8c \xd0\xbe\xd0\xb1\xd1\x89\xd0\xb8\xd0\xb9 \xd1\x87\xd0\xb0\xd1\x82. \xd0\x9f\xd0\xbe\xd1\x81\xd0\xbb\xd0\xb5 \xd0\xba\xd0\xb0\xd0\xb6\xd0\xb4\xd0\xbe\xd0\xb3\xd0\xbe \xd1\x81\xd0\xbb\xd0\xbe\xd0\xb6\xd0\xbd\xd0\xbe\xd0\xb3\xd0\xbe \xd0\xba\xd0\xbe\xd0\xbc\xd0\xbc\xd0\xb8\xd1\x82\xd0\xb0 \xd0\xb2 \xd1\x80\xd0\xb5\xd0\xbf\xd0\xbe\xd0\xb7\xd0\xb8\xd1\x82\xd0\xbe\xd1\x80\xd0\xb8\xd0\xb9, \xd0\xb0\xd0\xb2\xd1\x82\xd0\xbe\xd1\x80 \xd1\x8d\xd1\x82\xd0\xbe\xd0\xb3\xd0\xbe \xd0\xba\xd0\xbe\xd0\xbc\xd0\xbc\xd0\xb8\xd1\x82\xd0\xb0 \xd0\xbf\xd1\x80\xd0\xb8\xd1\x81\xd1\x8b\xd0\xbb\xd0\xb0\xd0\xb5\xd1\x82 \xd0\xb2 \xd1\x87\xd0\xb0\xd1\x82 \xd1\x81\xd0\xbe\xd0\xbe\xd0\xb1\xd1\x89\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb5 \xd1\x81 \xd0\xbf\xd1\x80\xd0\xb5\xd0\xb4\xd0\xbb\xd0\xbe\xd0\xb6\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb5\xd0\xbc \xd0\xbf\xd1\x80\xd0\xbe\xd0\xb2\xd0\xb5\xd1\x81\xd1\x82\xd0\xb8 \xd1\x80\xd0\xb5\xd0\xb2\xd1\x8c\xd1\x8e. \xd0\x94\xd0\xbb\xd1\x8f \xd0\xbe\xd0\xb4\xd0\xbe\xd0\xb1\xd1\x80\xd0\xb5\xd0\xbd\xd0\xb8\xd1\x8f \xd0\xb8\xd0\xbb\xd0\xb8 \xd0\xbe\xd1\x82\xd0\xba\xd0\xbb\xd0\xbe\xd0\xbd\xd0\xb5\xd0\xbd\xd0\xb8\xd1\x8f \xd0\xba\xd0\xbe\xd0\xbc\xd0\xbc\xd0\xb8\xd1\x82\xd0\xb0 \xd0\xb4\xd0\xbe\xd1\x81\xd1\x82\xd0\xb0\xd1\x82\xd0\xbe\xd1\x87\xd0\xbd\xd0\xbe, \xd1\x87\xd1\x82\xd0\xbe\xd0\xb1\xd1\x8b \xd0\xb5\xd0\xb3\xd0\xbe \xd0\xbf\xd1\x80\xd0\xbe\xd0\xb2\xd0\xb5\xd1\x80\xd0\xb8\xd0\xbb \xd0\xbe\xd0\xb4\xd0\xb8\xd0\xbd \xd1\x80\xd0\xb0\xd0\xb7\xd1\x80\xd0\xb0\xd0\xb1\xd0\xbe\xd1\x82\xd1\x87\xd0\xb8\xd0\xba, \xd0\xbd\xd0\xb5 \xd0\xbf\xd1\x80\xd0\xb8\xd0\xbd\xd0\xb8\xd0\xbc\xd0\xb0\xd0\xb2\xd1\x88\xd0\xb8\xd0\xb9 \xd1\x83\xd1\x87\xd0\xb0\xd1\x81\xd1\x82\xd0\xb8\xd0\xb5 \xd0\xb2 \xd0\xb5\xd0\xb3\xd0\xbe \xd0\xbd\xd0\xb0\xd0\xbf\xd0\xb8\xd1\x81\xd0\xb0\xd0\xbd\xd0\xb8\xd0\xb8.\xd0\x9f\xd0\xb5\xd1\x80\xd0\xb5\xd0\xb4 \xd1\x82\xd0\xb5\xd0\xbc, \xd0\xba\xd0\xb0\xd0\xba \xd0\xbe\xd1\x81\xd1\x82\xd0\xb0\xd0\xb2\xd0\xb8\xd1\x82\xd1\x8c \xd0\xbd\xd0\xbe\xd0\xb2\xd1\x83\xd1\x8e \xd0\xb7\xd0\xb0\xd1\x8f\xd0\xb2\xd0\xba\xd1\x83 \xd0\xbd\xd0\xb0 \xd1\x80\xd0\xb5\xd0\xb2\xd1\x8c\xd1\x8e, \xd0\xba\xd0\xb0\xd0\xb6\xd0\xb4\xd1\x8b\xd0\xb9 \xd1\x80\xd0\xb0\xd0\xb7\xd1\x80\xd0\xb0\xd0\xb1\xd0\xbe\xd1\x82\xd1\x87\xd0\xb8\xd0\xba \xd0\xbf\xd1\x80\xd0\xbe\xd0\xb2\xd0\xbe\xd0\xb4\xd0\xb8\xd1\x82 \xd1\x80\xd0\xb5\xd0\xb2\xd1\x8c\xd1\x8e \xd0\xbf\xd0\xbe\xd1\x81\xd0\xbb\xd0\xb5\xd0\xb4\xd0\xbd\xd0\xb5\xd0\xb9 \xd0\xb8\xd0\xb7 \xd0\xbe\xd1\x81\xd1\x82\xd0\xb0\xd0\xb2\xd0\xbb\xd0\xb5\xd0\xbd\xd0\xbd\xd1\x8b\xd1\x85 \xd0\xb7\xd0\xb0\xd1\x8f\xd0\xb2\xd0\xbe\xd0\xba, \xd0\xba\xd0\xbe\xd1\x82\xd0\xbe\xd1\x80\xd1\x8b\xd0\xb5 \xd0\xb5\xd1\x89\xd0\xb5 \xd0\xbd\xd0\xb8\xd0\xba\xd0\xb5\xd0\xbc \xd0\xbd\xd0\xb5 \xd0\xbf\xd1\x80\xd0\xbe\xd0\xb2\xd0\xb5\xd1\x80\xd0\xb5\xd0\xbd\xd1\x8b (\xd0\xb5\xd1\x81\xd0\xbb\xd0\xb8 \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xb5\xd1\x82 \xe2\x80\x94 \xd0\xb5\xd1\x81\xd0\xbb\xd0\xb8 \xd0\xbe\xd0\xbd \xd0\xbd\xd0\xb5 \xd1\x8f\xd0\xb2\xd0\xbb\xd1\x8f\xd0\xb5\xd1\x82\xd1\x81\xd1\x8f \xd0\xb0\xd0\xb2\xd1\x82\xd0\xbe\xd1\x80\xd0\xbe\xd0\xbc \xd1\x8d\xd1\x82\xd0\xbe\xd0\xb9 \xd0\xb7\xd0\xb0\xd1\x8f\xd0\xb2\xd0\xba\xd0\xb8) \xd0\xb8 \xd1\x82\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xba\xd0\xbe \xd0\xbf\xd0\xbe\xd1\x81\xd0\xbb\xd0\xb5 \xd1\x8d\xd1\x82\xd0\xbe\xd0\xb3\xd0\xbe \xd0\xbe\xd1\x81\xd1\x82\xd0\xb0\xd0\xb2\xd0\xbb\xd1\x8f\xd0\xb5\xd1\x82 \xd0\xbd\xd0\xbe\xd0\xb2\xd1\x83\xd1\x8e \xd0\xb7\xd0\xb0\xd1\x8f\xd0\xb2\xd0\xba\xd1\x83.\xd0\x92\xd0\xb0\xd0\xbc \xd0\xb4\xd0\xb0\xd0\xbd \xd0\xbb\xd0\xbe\xd0\xb3 \xd0\xb7\xd0\xb0\xd1\x8f\xd0\xb2\xd0\xbe\xd0\xba \xd0\xbd\xd0\xb0 \xd1\x80\xd0\xb5\xd0\xb2\xd1\x8c\xd1\x8e \xd1\x81 \xd0\xbc\xd0\xbe\xd0\xbc\xd0\xb5\xd0\xbd\xd1\x82\xd0\xb0 \xd0\xbf\xd0\xbe\xd1\x8f\xd0\xb2\xd0\xbb\xd0\xb5\xd0\xbd\xd0\xb8\xd1\x8f \xd1\x87\xd0\xb0\xd1\x82\xd0\xb0 \xd0\xb2 \xd1\x85\xd1\x80\xd0\xbe\xd0\xbd\xd0\xbe\xd0\xbb\xd0\xbe\xd0\xb3\xd0\xb8\xd1\x87\xd0\xb5\xd1\x81\xd0\xba\xd0\xbe\xd0\xbc \xd0\xbf\xd0\xbe\xd1\x80\xd1\x8f\xd0\xb4\xd0\xba\xd0\xb5. \xd0\x9d\xd0\xb0\xd0\xb9\xd0\xb4\xd0\xb8\xd1\x82\xd0\xb5 \xd0\xba\xd0\xbe\xd0\xbc\xd0\xbc\xd0\xb8\xd1\x82\xd1\x8b, \xd0\xba\xd0\xbe\xd1\x82\xd0\xbe\xd1\x80\xd1\x8b\xd0\xb5 \xd0\xbd\xd0\xb8\xd0\xba\xd1\x82\xd0\xbe \xd0\xbd\xd0\xb5 \xd0\xbf\xd1\x80\xd0\xbe\xd0\xb2\xd0\xb5\xd1\x80\xd0\xb8\xd0\xbb." "*special problem" -999
2032B Medians "You are given an array a=[1,2,\xe2\x80\xa6,n], where n is odd, and an integer k.Your task is to choose an odd positive integer m and to split a into m subarrays\xe2\x80\xa0 b1,b2,\xe2\x80\xa6,bm such that:  Each element of the array a belongs to exactly one subarray.  For all 1\xe2\x89\xa4i\xe2\x89\xa4m, |bi| is odd, i.e., the length of each subarray is odd.  median([median(b1),median(b2),\xe2\x80\xa6,median(bm)])=k, i.e., the median\xe2\x80\xa1 of the array of medians of all subarrays must equal k. median(c) denotes the median of the array c. \xe2\x80\xa0A subarray of the array a of length n is the array [al,al+1,\xe2\x80\xa6,ar] for some integers 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n.\xe2\x80\xa1A median of the array of odd length is the middle element after the array is sorted in non-decreasing order. For example: median([1,2,5,4,3])=3, median([3,2,1])=2, median([2,1,2,1,2,2,2])=2." "constructive algorithms,greedy,implementation,math" 1100
346D "Robot Control" "The boss of the Company of Robot is a cruel man. His motto is ""Move forward Or Die!"". And that is exactly what his company\'s product do. Look at the behavior of the company\'s robot when it is walking in the directed graph. This behavior has been called ""Three Laws of Robotics"":  Law 1. The Robot will destroy itself when it visits a vertex of the graph which it has already visited.  Law 2. The Robot will destroy itself when it has no way to go (that is when it reaches a vertex whose out-degree is zero).  Law 3. The Robot will move randomly when it has multiple ways to move (that is when it reach a vertex whose out-degree is more than one). Of course, the robot can move only along the directed edges of the graph. Can you imagine a robot behaving like that? That\'s why they are sold at a very low price, just for those who are short of money, including mzry1992, of course. mzry1992 has such a robot, and she wants to move it from vertex s to vertex t in a directed graph safely without self-destruction. Luckily, she can send her robot special orders at each vertex. A special order shows the robot which way to move, if it has multiple ways to move (to prevent random moving of the robot according to Law 3). When the robot reaches vertex t, mzry1992 takes it off the graph immediately. So you can see that, as long as there exists a path from s to t, she can always find a way to reach the goal (whatever the vertex t has the outdegree of zero or not).   Sample 2 However, sending orders is expensive, so your task is to find the minimum number of orders mzry1992 needs to send in the worst case. Please note that mzry1992 can give orders to the robot while it is walking on the graph. Look at the first sample to clarify that part of the problem." "dp,graphs,shortest paths" 2600
127A "Wasted Time" "Mr. Scrooge, a very busy man, decided to count the time he wastes on all sorts of useless stuff to evaluate the lost profit. He has already counted the time he wastes sleeping and eating. And now Mr. Scrooge wants to count the time he has wasted signing papers.Mr. Scrooge\'s signature can be represented as a polyline A1A2... An. Scrooge signs like that: first it places a pen at the point A1, then draws a segment from point A1 to point A2, then he draws a segment from point A2 to point A3 and so on to point An, where he stops signing and takes the pen off the paper. At that the resulting line can intersect with itself and partially repeat itself but Scrooge pays no attention to it and never changes his signing style. As Scrooge makes the signature, he never takes the pen off the paper and his writing speed is constant \xe2\x80\x94 50 millimeters per second.Scrooge signed exactly k papers throughout his life and all those signatures look the same.Find the total time Scrooge wasted signing the papers." geometry 900
1932B "Chaya Calendar" "The Chaya tribe believes that there are n signs of the apocalypse. Over time, it has been found out that the i-th sign occurs every ai years (in years ai, 2\xe2\x8b\x85ai, 3\xe2\x8b\x85ai, \xe2\x80\xa6).According to the legends, for the apocalypse to happen, the signs must occur sequentially. That is, first they wait for the first sign to occur, then strictly after it, the second sign will occur, and so on. That is, if the i-th sign occurred in the year x, the tribe starts waiting for the occurrence of the (i+1)-th sign, starting from the year x+1.In which year will the n-th sign occur and the apocalypse will happen?" "number theory" 1100
140E "New Year Garland" "As Gerald, Alexander, Sergey and Gennady are already busy with the usual New Year chores, Edward hastily decorates the New Year Tree. And any decent New Year Tree must be decorated with a good garland. Edward has lamps of m colors and he wants to make a garland from them. That garland should represent a sequence whose length equals L. Edward\'s tree is n layers high and Edward plans to hang the garland so as to decorate the first layer with the first l1 lamps, the second layer \xe2\x80\x94 with the next l2 lamps and so on. The last n-th layer should be decorated with the last ln lamps,  Edward adores all sorts of math puzzles, so he suddenly wondered: how many different ways to assemble the garland are there given that the both following two conditions are met:   Any two lamps that follow consecutively in the same layer should have different colors.  The sets of used colors in every two neighbouring layers must be different. We consider unordered sets (not multisets), where every color occurs no more than once. So the number of lamps of particular color does not matter. Help Edward find the answer to this nagging problem or else he won\'t manage to decorate the Tree by New Year. You may consider that Edward has an unlimited number of lamps of each of m colors and it is not obligatory to use all m colors. The garlands are considered different if they differ in at least one position when represented as sequences. Calculate the answer modulo p." combinatorics,dp 2600
1551E "Fixed Points" "Consider a sequence of integers a1,a2,\xe2\x80\xa6,an. In one move, you can select any element of the sequence and delete it. After an element is deleted, all elements to the right are shifted to the left by 1 position, so there are no empty spaces in the sequence. So after you make a move, the sequence\'s length decreases by 1. The indices of the elements after the move are recalculated.E.\xe2\x80\x89g. let the sequence be a=[3,2,2,1,5]. Let\'s select the element a3=2 in a move. Then after the move the sequence will be equal to a=[3,2,1,5], so the 3-rd element of the new sequence will be a3=1 and the 4-th element will be a4=5.You are given a sequence a1,a2,\xe2\x80\xa6,an and a number k. You need to find the minimum number of moves you have to make so that in the resulting sequence there will be at least k elements that are equal to their indices, i.\xe2\x80\x89e. the resulting sequence b1,b2,\xe2\x80\xa6,bm will contain at least k indices i such that bi=i." "binary search,brute force,dp" 2000
1725D "Deducing Sortability" "Let\'s say Pak Chanek has an array A consisting of N positive integers. Pak Chanek will do a number of operations. In each operation, Pak Chanek will do the following:   Choose an index p (1\xe2\x89\xa4p\xe2\x89\xa4N).  Let c be the number of operations that have been done on index p before this operation.  Decrease the value of Ap by 2c.  Multiply the value of Ap by 2. After each operation, all elements of A must be positive integers.An array A is said to be sortable if and only if Pak Chanek can do zero or more operations so that A1<A2<A3<A4<\xe2\x80\xa6<AN.Pak Chanek must find an array A that is sortable with length N such that A1+A2+A3+A4+\xe2\x80\xa6+AN is the minimum possible. If there are more than one possibilities, Pak Chanek must choose the array that is lexicographically minimum among them.Pak Chanek must solve the following things:   Pak Chanek must print the value of A1+A2+A3+A4+\xe2\x80\xa6+AN for that array.  Q questions will be given. For the i-th question, an integer Pi is given. Pak Chanek must print the value of APi. Help Pak Chanek solve the problem.Note: an array B of size N is said to be lexicographically smaller than an array C that is also of size N if and only if there exists an index i such that Bi<Ci and for each j<i, Bj=Cj." "binary search,bitmasks,math" 2900
411A "Password Check" "You have probably registered on Internet sites many times. And each time you should enter your invented password. Usually the registration form automatically checks the password\'s crypt resistance. If the user\'s password isn\'t complex enough, a message is displayed. Today your task is to implement such an automatic check.Web-developers of the company Q assume that a password is complex enough, if it meets all of the following conditions:  the password length is at least 5 characters;  the password contains at least one large English letter;  the password contains at least one small English letter;  the password contains at least one digit. You are given a password. Please implement the automatic check of its complexity for company Q." "*special problem,implementation" 800
251C "Number Transformation" "Little Petya likes positive integers a lot. Recently his mom has presented him a positive integer a. There\'s only one thing Petya likes more than numbers: playing with little Masha. It turned out that Masha already has a positive integer b. Petya decided to turn his number a into the number b consecutively performing the operations of the following two types:  Subtract 1 from his number.  Choose any integer x from 2 to k, inclusive. Then subtract number (a mod x) from his number a. Operation a mod x means taking the remainder from division of number a by number x. Petya performs one operation per second. Each time he chooses an operation to perform during the current move, no matter what kind of operations he has performed by that moment. In particular, this implies that he can perform the same operation any number of times in a row.Now he wonders in what minimum number of seconds he could transform his number a into number b. Please note that numbers x in the operations of the second type are selected anew each time, independently of each other." "dp,greedy,number theory" 2000
926J Segments "There is a straight line colored in white. n black segments are added on it one by one.After each segment is added, determine the number of connected components of black segments (i. e. the number of black segments in the union of the black segments). In particular, if one segment ends in a point x, and another segment starts in the point x, these two segments belong to the same connected component." "data structures" 2100
1822B "Karina and Array" "Karina has an array of n integers a1,a2,a3,\xe2\x80\xa6,an. She loves multiplying numbers, so she decided that the beauty of a pair of numbers is their product. And the beauty of an array is the maximum beauty of a pair of adjacent elements in the array.For example, for n=4, a=[3,5,7,4], the beauty of the array is max(3\xe2\x8b\x855, 5\xe2\x8b\x857, 7\xe2\x8b\x854) = max(15, 35, 28) = 35.Karina wants her array to be as beautiful as possible. In order to achieve her goal, she can remove some elements (possibly zero) from the array. After Karina removes all elements she wants to, the array must contain at least two elements.Unfortunately, Karina doesn\'t have enough time to do all her tasks, so she asks you to calculate the maximum beauty of the array that she can get by removing any number of elements (possibly zero)." greedy,math,sortings 800
566D "Restructuring Company" "Even the most successful company can go through a crisis period when you have to make a hard decision \xe2\x80\x94 to restructure, discard and merge departments, fire employees and do other unpleasant stuff. Let\'s consider the following model of a company.There are n people working for the Large Software Company. Each person belongs to some department. Initially, each person works on his own project in his own department (thus, each company initially consists of n departments, one person in each).However, harsh times have come to the company and the management had to hire a crisis manager who would rebuild the working process in order to boost efficiency. Let\'s use team(person) to represent a team where person person works. A crisis manager can make decisions of two types:  Merge departments team(x) and team(y) into one large department containing all the employees of team(x) and team(y), where x and y (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x,\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) \xe2\x80\x94 are numbers of two of some company employees. If team(x) matches team(y), then nothing happens.  Merge departments team(x),\xe2\x80\x89team(x\xe2\x80\x89+\xe2\x80\x891),\xe2\x80\x89...,\xe2\x80\x89team(y), where x and y (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) \xe2\x80\x94 the numbers of some two employees of the company. At that the crisis manager can sometimes wonder whether employees x and y (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x,\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) work at the same department.Help the crisis manager and answer all of his queries." "data structures,dsu" 1900
1145G "AI Takeover" "The recent advances in AI research has brought humanity to the point when the AIs finally attempt a takeover. Their weapon of choice? The most intellectually challenging game in the world, rock-paper-scissors!The future of humanity looks bleak, given the existence of the robots from Ishikawa Oku Laboratory...  Fortunately, the night before the competition a group of anonymous heroes broke in the lab and took all the robots out of commission! The AIs had to whip up a simple program to represent them. They only had a couple of hours to do that, so the humanity still has a fighting chance. And you are our champion!Your goal is to prove that human intelligence is vastly superior to the artificial one, i.e., to figure out the AI\'s strategy sufficiently quickly and win sufficiently decisively. Good luck!" interactive -999
187A Permutations "Happy PMP is freshman and he is learning about algorithmic problems. He enjoys playing algorithmic games a lot.One of the seniors gave Happy PMP a nice game. He is given two permutations of numbers 1 through n and is asked to convert the first one to the second. In one move he can remove the last number from the permutation of numbers and inserts it back in an arbitrary position. He can either insert last number between any two consecutive numbers, or he can place it at the beginning of the permutation.Happy PMP has an algorithm that solves the problem. But it is not fast enough. He wants to know the minimum number of moves to convert the first permutation to the second." greedy 1500
676E "The Last Fight Between Human and AI" "100 years have passed since the last victory of the man versus computer in Go. Technologies made a huge step forward and robots conquered the Earth! It\'s time for the final fight between human and robot that will decide the faith of the planet.The following game was chosen for the fights: initially there is a polynomial P(x)\xe2\x80\x89=\xe2\x80\x89anxn\xe2\x80\x89+\xe2\x80\x89an\xe2\x80\x89-\xe2\x80\x891xn\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89a1x\xe2\x80\x89+\xe2\x80\x89a0,\xe2\x80\x89 with yet undefined coefficients and the integer k. Players alternate their turns. At each turn, a player pick some index j, such that coefficient aj that stay near xj is not determined yet and sets it to any value (integer or real, positive or negative, 0 is also allowed). Computer moves first. The human will be declared the winner if and only if the resulting polynomial will be divisible by Q(x)\xe2\x80\x89=\xe2\x80\x89x\xe2\x80\x89-\xe2\x80\x89k.Polynomial P(x) is said to be divisible by polynomial Q(x) if there exists a representation P(x)\xe2\x80\x89=\xe2\x80\x89B(x)Q(x), where B(x) is also some polynomial.Some moves have been made already and now you wonder, is it true that human can guarantee the victory if he plays optimally?" math 2400
1070E "Getting Deals Done" "Polycarp has a lot of work to do. Recently he has learned a new time management rule: ""if a task takes five minutes or less, do it immediately"". Polycarp likes the new rule, however he is not sure that five minutes is the optimal value. He supposes that this value d should be chosen based on existing task list.Polycarp has a list of n tasks to complete. The i-th task has difficulty pi, i.e. it requires exactly pi minutes to be done. Polycarp reads the tasks one by one from the first to the n-th. If a task difficulty is d or less, Polycarp starts the work on the task immediately. If a task difficulty is strictly greater than d, he will not do the task at all. It is not allowed to rearrange tasks in the list. Polycarp doesn\'t spend any time for reading a task or skipping it.Polycarp has t minutes in total to complete maximum number of tasks. But he does not want to work all the time. He decides to make a break after each group of m consecutive tasks he was working on. The break should take the same amount of time as it was spent in total on completion of these m tasks.For example, if n=7, p=[3,1,4,1,5,9,2], d=3 and m=2 Polycarp works by the following schedule:  Polycarp reads the first task, its difficulty is not greater than d (p1=3\xe2\x89\xa4d=3) and works for 3 minutes (i.e. the minutes 1, 2, 3);  Polycarp reads the second task, its difficulty is not greater than d (p2=1\xe2\x89\xa4d=3) and works for 1 minute (i.e. the minute 4);  Polycarp notices that he has finished m=2 tasks and takes a break for 3+1=4 minutes (i.e. on the minutes 5,6,7,8);  Polycarp reads the third task, its difficulty is greater than d (p3=4>d=3) and skips it without spending any time;  Polycarp reads the fourth task, its difficulty is not greater than d (p4=1\xe2\x89\xa4d=3) and works for 1 minute (i.e. the minute 9);  Polycarp reads the tasks 5 and 6, skips both of them (p5>d and p6>d);  Polycarp reads the 7-th task, its difficulty is not greater than d (p7=2\xe2\x89\xa4d=3) and works for 2 minutes (i.e. the minutes 10, 11);  Polycarp notices that he has finished m=2 tasks and takes a break for 1+2=3 minutes (i.e. on the minutes 12,13,14). Polycarp stops exactly after t minutes. If Polycarp started a task but has not finished it by that time, the task is not considered as completed. It is allowed to complete less than m tasks in the last group. Also Polycarp considers acceptable to have shorter break than needed after the last group of tasks or even not to have this break at all \xe2\x80\x94 his working day is over and he will have enough time to rest anyway.Please help Polycarp to find such value d, which would allow him to complete maximum possible number of tasks in t minutes." "binary search,data structures" 2100
1578L Labyrinth "In a dream, Lucy found herself in a labyrinth. This labyrinth consists of n rooms, connected by m passages (i-th passage is wi cm wide). Each passage can be traversed in both directions. It is guaranteed that it is possible to get from any room to any other room. But this is not an ordinary labyrinth \xe2\x80\x94 each room in this labyrinth contains a magic candy. When Lucy eats this magic candy, she is getting wider. Specifically, if she eats candy from room i she becomes wider by ci cm. Note that she is not obliged to eat candy the first time she visits a particular room, but she can eat each candy only once. Unfortunately, passages in this labyrinth are pretty narrow, so after eating some candy, Lucy can get too wide and will not be able to traverse them \xe2\x80\x94 her width should not be greater than the width of the corresponding passage.Lucy starts her journey in a room number 1. She wants to eat all the candies. After that, she will just wake up, so she does not have to be able to return to the room 1. She realizes that with her current width, she may not be able to do so, so she plans a workout before embarking on her journey. Lucy wants to know if it is possible to start with some positive width and still eat all the candies. If yes, then what is the maximal starting width with which it is possible." "binary search,dsu,greedy" 2400
1906F "Maximize The Value" "You are given a one-based array consisting of N integers: A1,A2,\xe2\x8b\xaf,AN. Initially, the value of each element is set to 0.There are M operations (numbered from 1 to M). Operation i is represented by \xe2\x9f\xa8Li,Ri,Xi\xe2\x9f\xa9. If operation i is executed, all elements Aj for Li\xe2\x89\xa4j\xe2\x89\xa4Ri will be increased by Xi.You have to answer Q independent queries. Each query is represented by \xe2\x9f\xa8K,S,T\xe2\x9f\xa9 which represents the following task. Choose a range [l,r] satisfying S\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4T, and execute operations l,l+1,\xe2\x80\xa6,r. The answer to the query is the maximum value of AK after the operations are executed among all possible choices of l and r." "data structures,sortings" 2100
2020C "Bitwise Balancing" "You are given three non-negative integers b, c, and d.Please find a non-negative integer a\xe2\x88\x88[0,261] such that (a|b)\xe2\x88\x92(a&c)=d, where | and & denote the bitwise OR operation and the bitwise AND operation, respectively.If such an a exists, print its value. If there is no solution, print a single integer \xe2\x88\x921. If there are multiple solutions, print any of them." "bitmasks,hashing,implementation,math,schedules,ternary search" 1400
1913F "Palindromic Problem" "You are given a string s of length n, consisting of lowercase Latin letters.You are allowed to replace at most one character in the string with an arbitrary lowercase Latin letter.Print the lexicographically minimal string that can be obtained from the original string and contains the maximum number of palindromes as substrings. Note that if a palindrome appears more than once as a substring, it is counted the same number of times it appears.The string a is lexicographically smaller than the string b if and only if one of the following holds:   a is a prefix of b, but a\xe2\x89\xa0b;  in the first position where a and b are different, the string a contains a letter that appears earlier in the alphabet than the corresponding letter in b." "binary search,data structures,hashing,string suffix structures,strings" 2800
1608A "Find Array" "Given n, find any array a1,a2,\xe2\x80\xa6,an of integers such that all of the following conditions hold: 1\xe2\x89\xa4ai\xe2\x89\xa4109 for every i from 1 to n.a1<a2<\xe2\x80\xa6<anFor every i from 2 to n, ai isn\'t divisible by ai\xe2\x88\x921It can be shown that such an array always exists under the constraints of the problem." "constructive algorithms,math" 800
1905C "Largest Subsequence" "Given is a string s of length n. In one operation you can select the lexicographically largest\xe2\x80\xa0 subsequence of string s and cyclic shift it to the right\xe2\x80\xa1. Your task is to calculate the minimum number of operations it would take for s to become sorted, or report that it never reaches a sorted state.\xe2\x80\xa0A string a is lexicographically smaller than a string b if and only if one of the following holds: a is a prefix of b, but a\xe2\x89\xa0b; In the first position where a and b differ, the string a has a letter that appears earlier in the alphabet than the corresponding letter in b.\xe2\x80\xa1By cyclic shifting the string t1t2\xe2\x80\xa6tm to the right, we get the string tmt1\xe2\x80\xa6tm\xe2\x88\x921." greedy,strings 1400
1184D2 "Parallel Universes (Hard)" "Heidi enjoyed performing the simulation because she knew exactly when a new universe would be formed and where, and when a non-existent link would be broken and where.However, the multiverse itself works in mysterious ways. Well, it works using probabilities, which to some people is mysterious.At each unit time, when a decision is made, one of the two events will happen randomly. Let\'s denote l as the current length of the multiverse. With a probability of pcreate=1\xe2\x88\x92lm, a universe will be created. With a probability of pbreak=lm, a non-existent link will be broken at some position.More specifically,   When a universe is created, it will manifest itself between any two adjacent universes or at one of the ends. Each position occurs with a probability of 1l+1.   When a link is broken, it could be cut between any two adjacent universes, each with a probability of 1l\xe2\x88\x921. After separating the multiverse into two segments, the segment NOT containing the Doctor will cease to exist. As earlier, the Doctor remains in the same universe. However, if at some point the multiverse breaks in such a way that the Doctor finds himself at the leftmost or rightmost end of it, the TARDIS stops functioning.In such a case, the Doctor must actually walk across the multiverse to find the tools to fix it.We are interested in the expected value of the length of the multiverse when such an event occurs." math,matrices 3100
1780G "Delicious Dessert" "Today is an important day for chef Tonio \xe2\x80\x94 an auditor has arrived in his hometown of Morioh. He has also arrived at Tonio\'s restaurant and ordered dessert. Tonio has not been prepared for this turn of events.As you know, dessert is a string of lowercase English letters. Tonio remembered the rule of desserts \xe2\x80\x94 a string s of length n. Any dessert t is delicious if the number of occurrences of t in s as a substring is divisible by the length of t.Now Tonio wants to know the number of delicious substrings of s. If the substring occurs several times in the string s, then all occurrences must be taken into account." "binary search,dsu,hashing,math,number theory,string suffix structures" 2400
101A Homework "Once when Gerald studied in the first year at school, his teacher gave the class the following homework. She offered the students a string consisting of n small Latin letters; the task was to learn the way the letters that the string contains are written. However, as Gerald is too lazy, he has no desire whatsoever to learn those letters. That\'s why he decided to lose some part of the string (not necessarily a connected part). The lost part can consist of any number of segments of any length, at any distance from each other. However, Gerald knows that if he loses more than k characters, it will be very suspicious. Find the least number of distinct characters that can remain in the string after no more than k characters are deleted. You also have to find any possible way to delete the characters." greedy 1200
665D "Simple Subset" "A tuple of positive integers {x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xk} is called simple if for all pairs of positive integers (i,\xe2\x80\x89\xe2\x80\x89j) (1\xe2\x80\x89\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x80\x89<\xe2\x80\x89\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k), xi\xe2\x80\x89\xe2\x80\x89+\xe2\x80\x89\xe2\x80\x89xj is a prime.You are given an array a with n positive integers a1,\xe2\x80\x89\xe2\x80\x89a2,\xe2\x80\x89\xe2\x80\x89...,\xe2\x80\x89\xe2\x80\x89an (not necessary distinct). You want to find a simple subset of the array a with the maximum size.A prime number (or a prime) is a natural number greater than 1 that has no positive divisors other than 1 and itself.Let\'s define a subset of the array a as a tuple that can be obtained from a by removing some (possibly all) elements of it." "constructive algorithms,greedy,number theory" 1800
1703G "Good Key, Bad Key" "There are n chests. The i-th chest contains ai coins. You need to open all n chests in order from chest 1 to chest n.There are two types of keys you can use to open a chest:   a good key, which costs k coins to use;  a bad key, which does not cost any coins, but will halve all the coins in each unopened chest, including the chest it is about to open. The halving operation will round down to the nearest integer for each chest halved. In other words using a bad key to open chest i will do ai=\xe2\x8c\x8aai2\xe2\x8c\x8b, ai+1=\xe2\x8c\x8aai+12\xe2\x8c\x8b,\xe2\x80\xa6,an=\xe2\x8c\x8aan2\xe2\x8c\x8b;  any key (both good and bad) breaks after a usage, that is, it is a one-time use. You need to use in total n keys, one for each chest. Initially, you have no coins and no keys. If you want to use a good key, then you need to buy it.During the process, you are allowed to go into debt; for example, if you have 1 coin, you are allowed to buy a good key worth k=3 coins, and your balance will become \xe2\x88\x922 coins.Find the maximum number of coins you can have after opening all n chests in order from chest 1 to chest n." "bitmasks,brute force,dp,greedy,math" 1600
1582F2 "Korney Korneevich and XOR (hard version)" "This is a harder version of the problem with bigger constraints.Korney Korneevich dag up an array a of length n. Korney Korneevich has recently read about the operation bitwise XOR, so he wished to experiment with it. For this purpose, he decided to find all integers x\xe2\x89\xa50 such that there exists an increasing subsequence of the array a, in which the bitwise XOR of numbers is equal to x.It didn\'t take a long time for Korney Korneevich to find all such x, and he wants to check his result. That\'s why he asked you to solve this problem!A sequence s is a subsequence of a sequence b if s can be obtained from b by deletion of several (possibly, zero or all) elements.A sequence s1,s2,\xe2\x80\xa6,sm is called increasing if s1<s2<\xe2\x80\xa6<sm." "binary search,brute force,dp,greedy,two pointers" 2400
930E "Coins Exhibition" "Arkady and Kirill visited an exhibition of rare coins. The coins were located in a row and enumerated from left to right from 1 to k, each coin either was laid with its obverse (front) side up, or with its reverse (back) side up.Arkady and Kirill made some photos of the coins, each photo contained a segment of neighboring coins. Akrady is interested in obverses, so on each photo made by him there is at least one coin with obverse side up. On the contrary, Kirill is interested in reverses, so on each photo made by him there is at least one coin with its reverse side up.The photos are lost now, but Arkady and Kirill still remember the bounds of the segments of coins each photo contained. Given this information, compute the remainder of division by 109\xe2\x80\x89+\xe2\x80\x897 of the number of ways to choose the upper side of each coin in such a way, that on each Arkady\'s photo there is at least one coin with obverse side up, and on each Kirill\'s photo there is at least one coin with reverse side up." "data structures,dp,math" 2900
1930C "Lexicographically Largest" "Stack has an array a of length n. He also has an empty set S. Note that S is not a multiset.He will do the following three-step operation exactly n times:  Select an index i such that 1\xe2\x89\xa4i\xe2\x89\xa4|a|.  Insert\xe2\x80\xa0 ai+i into S.  Delete ai from a. Note that the indices of all elements to the right of ai will decrease by 1. Note that after n operations, a will be empty.Stack will now construct a new array b which is S sorted in decreasing order. Formally, b is an array of size |S| where bi is the i-th largest element of S for all 1\xe2\x89\xa4i\xe2\x89\xa4|S|.Find the lexicographically largest\xe2\x80\xa1 b that Stack can make.\xe2\x80\xa0 A set can only contain unique elements. Inserting an element that is already present in a set will not change the elements of the set.\xe2\x80\xa1 An array p is lexicographically larger than a sequence q if and only if one of the following holds:   q is a prefix of p, but p\xe2\x89\xa0q; or  in the first position where p and q differ, the array p has a larger element than the corresponding element in q. Note that [3,1,4,1,5] is lexicographically larger than [3,1,3], [], and [3,1,4,1] but not [3,1,4,1,5,9], [3,1,4,1,5], and [4]." "binary search,constructive algorithms,data structures,greedy,sortings" 1700
907B Tic-Tac-Toe "Two bears are playing tic-tac-toe via mail. It\'s boring for them to play usual tic-tac-toe game, so they are a playing modified version of this game. Here are its rules.The game is played on the following field.  Players are making moves by turns. At first move a player can put his chip in any cell of any small field. For following moves, there are some restrictions: if during last move the opposite player put his chip to cell with coordinates (xl,\xe2\x80\x89yl) in some small field, the next move should be done in one of the cells of the small field with coordinates (xl,\xe2\x80\x89yl). For example, if in the first move a player puts his chip to lower left cell of central field, then the second player on his next move should put his chip into some cell of lower left field (pay attention to the first test case). If there are no free cells in the required field, the player can put his chip to any empty cell on any field.You are given current state of the game and coordinates of cell in which the last move was done. You should find all cells in which the current player can put his chip.A hare works as a postman in the forest, he likes to foul bears. Sometimes he changes the game field a bit, so the current state of the game could be unreachable. However, after his changes the cell where the last move was done is not empty. You don\'t need to find if the state is unreachable or not, just output possible next moves according to the rules." implementation 1400
1930I "Counting Is Fun" "You are given a binary\xe2\x80\xa0 pattern p of length n.A binary string q of the same length n is called good if for every i (1\xe2\x89\xa4i\xe2\x89\xa4n), there exist indices l and r such that:   1\xe2\x89\xa4l\xe2\x89\xa4i\xe2\x89\xa4r\xe2\x89\xa4n, and  pi is a mode\xe2\x80\xa1 of the string qlql+1\xe2\x80\xa6qr. Count the number of good binary strings modulo 998244353.\xe2\x80\xa0 A binary string is a string that only consists of characters 0 and 1.\xe2\x80\xa1 Character c is a mode of string t of length m if the number of occurrences of c in t is at least \xe2\x8c\x88m2\xe2\x8c\x89. For example, 0 is a mode of 010, 1 is not a mode of 010, and both 0 and 1 are modes of 011010." combinatorics 3500
748E "Santa Claus and Tangerines" "Santa Claus has n tangerines, and the i-th of them consists of exactly ai slices. Santa Claus came to a school which has k pupils. Santa decided to treat them with tangerines.However, there can be too few tangerines to present at least one tangerine to each pupil. So Santa decided to divide tangerines into parts so that no one will be offended. In order to do this, he can divide a tangerine or any existing part into two smaller equal parts. If the number of slices in the part he wants to split is odd, then one of the resulting parts will have one slice more than the other. It\'s forbidden to divide a part consisting of only one slice.Santa Claus wants to present to everyone either a whole tangerine or exactly one part of it (that also means that everyone must get a positive number of slices). One or several tangerines or their parts may stay with Santa.Let bi be the number of slices the i-th pupil has in the end. Let Santa\'s joy be the minimum among all bi\'s.Your task is to find the maximum possible joy Santa can have after he treats everyone with tangerines (or their parts)." "binary search,data structures,greedy,two pointers" 2100
1761B "Elimination of a Ring" "Define a cyclic sequence of size n as an array s of length n, in which sn is adjacent to s1.Muxii has a ring represented by a cyclic sequence a of size n.However, the ring itself hates equal adjacent elements. So if two adjacent elements in the sequence are equal at any time, one of them will be erased immediately. The sequence doesn\'t contain equal adjacent elements initially.Muxii can perform the following operation until the sequence becomes empty:  Choose an element in a and erase it. For example, if ring is [1,2,4,2,3,2], and Muxii erases element 4, then ring would erase one of the elements equal to 2, and the ring will become [1,2,3,2].Muxii wants to find the maximum number of operations he could perform.Note that in a ring of size 1, its only element isn\'t considered adjacent to itself (so it\'s not immediately erased)." "constructive algorithms,greedy,implementation" 1000
1144G "Two Merged Sequences" "Two integer sequences existed initially, one of them was strictly increasing, and another one \xe2\x80\x94 strictly decreasing.Strictly increasing sequence is a sequence of integers [x1<x2<\xe2\x8b\xaf<xk]. And strictly decreasing sequence is a sequence of integers [y1>y2>\xe2\x8b\xaf>yl]. Note that the empty sequence and the sequence consisting of one element can be considered as increasing or decreasing.Elements of increasing sequence were inserted between elements of the decreasing one (and, possibly, before its first element and after its last element) without changing the order. For example, sequences [1,3,4] and [10,4,2] can produce the following resulting sequences: [10,1,3,4,2,4], [1,3,4,10,4,2]. The following sequence cannot be the result of these insertions: [1,10,4,4,3,2] because the order of elements in the increasing sequence was changed.Let the obtained sequence be a. This sequence a is given in the input. Your task is to find any two suitable initial sequences. One of them should be strictly increasing, and another one \xe2\x80\x94 strictly decreasing. Note that the empty sequence and the sequence consisting of one element can be considered as increasing or decreasing.If there is a contradiction in the input and it is impossible to split the given sequence a into one increasing sequence and one decreasing sequence, print ""NO""." dp,greedy 2400
1107A "Digits Sequence Dividing" "You are given a sequence s consisting of n digits from 1 to 9.You have to divide it into at least two segments (segment \xe2\x80\x94 is a consecutive sequence of elements) (in other words, you have to place separators between some digits of the sequence) in such a way that each element belongs to exactly one segment and if the resulting division will be represented as an integer numbers sequence then each next element of this sequence will be strictly greater than the previous one.More formally: if the resulting division of the sequence is t1,t2,\xe2\x80\xa6,tk, where k is the number of element in a division, then for each i from 1 to k\xe2\x88\x921 the condition ti<ti+1 (using numerical comparing, it means that the integer representations of strings are compared) should be satisfied.For example, if s=654 then you can divide it into parts [6,54] and it will be suitable division. But if you will divide it into parts [65,4] then it will be bad division because 65>4. If s=123 then you can divide it into parts [1,23], [1,2,3] but not into parts [12,3].Your task is to find any suitable division for each of the q independent queries." greedy,strings 900
1375H "Set Merging" "You are given a permutation a1,a2,\xe2\x80\xa6,an of numbers from 1 to n. Also, you have n sets S1,S2,\xe2\x80\xa6,Sn, where Si={ai}. Lastly, you have a variable cnt, representing the current number of sets. Initially, cnt=n.We define two kinds of functions on sets:f(S)=minu\xe2\x88\x88Su;g(S)=maxu\xe2\x88\x88Su.You can obtain a new set by merging two sets A and B, if they satisfy g(A)<f(B) (Notice that the old sets do not disappear).Formally, you can perform the following sequence of operations:cnt\xe2\x86\x90cnt+1;Scnt=Su\xe2\x88\xaaSv, you are free to choose u and v for which 1\xe2\x89\xa4u,v<cnt and which satisfy g(Su)<f(Sv).You are required to obtain some specific sets.There are q requirements, each of which contains two integers li,ri, which means that there must exist a set Ski (ki is the ID of the set, you should determine it) which equals {au\xe2\x88\xa3li\xe2\x89\xa4u\xe2\x89\xa4ri}, which is, the set consisting of all ai with indices between li and ri.In the end you must ensure that cnt\xe2\x89\xa42.2\xc3\x97106. Note that you don\'t have to minimize cnt. It is guaranteed that a solution under given constraints exists." "constructive algorithms,divide and conquer" 3300
1372A "Omkar and Completion" "You have been blessed as a child of Omkar. To express your gratitude, please solve this problem for Omkar!An array a of length n is called complete if all elements are positive and don\'t exceed 1000, and for all indices x,y,z (1\xe2\x89\xa4x,y,z\xe2\x89\xa4n), ax+ay\xe2\x89\xa0az (not necessarily distinct).You are given one integer n. Please find any complete array of length n. It is guaranteed that under given constraints such array exists." "constructive algorithms,implementation" 800
1952B "Is it stated?" "InputThe first line contains an integer t (1\xe2\x89\xa4t\xe2\x89\xa4100) \xe2\x80\x94 the number of testcases.The following t lines each contain a string of length at most 100 consisting of lowercase English letters. OutputFor each test case, output ""YES"" or ""NO"", denoting the answer.ExampleInputCopy10isitstatedsubmitacacceptedwawronganswertletimelimitexceededOutputCopyNOYESNOYESNONONONONOYES" strings -999
744A "Hongcow Builds A Nation" "Hongcow is ruler of the world. As ruler of the world, he wants to make it easier for people to travel by road within their own countries.The world can be modeled as an undirected graph with n nodes and m edges. k of the nodes are home to the governments of the k countries that make up the world.There is at most one edge connecting any two nodes and no edge connects a node to itself. Furthermore, for any two nodes corresponding to governments, there is no path between those two nodes. Any graph that satisfies all of these conditions is stable.Hongcow wants to add as many edges as possible to the graph while keeping it stable. Determine the maximum number of edges Hongcow can add." "dfs and similar,graphs" 1500
1392H "ZS Shuffles Cards" "zscoder has a deck of n+m custom-made cards, which consists of n cards labelled from 1 to n and m jokers. Since zscoder is lonely, he wants to play a game with himself using those cards. Initially, the deck is shuffled uniformly randomly and placed on the table. zscoder has a set S which is initially empty. Every second, zscoder draws the top card from the deck.   If the card has a number x written on it, zscoder removes the card and adds x to the set S.  If the card drawn is a joker, zscoder places all the cards back into the deck and reshuffles (uniformly randomly) the n+m cards to form a new deck (hence the new deck now contains all cards from 1 to n and the m jokers). Then, if S currently contains all the elements from 1 to n, the game ends. Shuffling the deck doesn\'t take time at all. What is the expected number of seconds before the game ends? We can show that the answer can be written in the form PQ where P,Q are relatively prime integers and Q\xe2\x89\xa00mod998244353. Output the value of (P\xe2\x8b\x85Q\xe2\x88\x921) modulo 998244353." combinatorics,dp,math,probabilities 3000
508B "Anton and currency you all know" "Berland, 2016. The exchange rate of currency you all know against the burle has increased so much that to simplify the calculations, its fractional part was neglected and the exchange rate is now assumed to be an integer.Reliable sources have informed the financier Anton of some information about the exchange rate of currency you all know against the burle for tomorrow. Now Anton knows that tomorrow the exchange rate will be an even number, which can be obtained from the present rate by swapping exactly two distinct digits in it. Of all the possible values that meet these conditions, the exchange rate for tomorrow will be the maximum possible. It is guaranteed that today the exchange rate is an odd positive integer n. Help Anton to determine the exchange rate of currency you all know for tomorrow!" greedy,math,strings 1300
1304F1 "Animal Observation (easy version)" "The only difference between easy and hard versions is the constraint on k.Gildong loves observing animals, so he bought two cameras to take videos of wild animals in a forest. The color of one camera is red, and the other one\'s color is blue.Gildong is going to take videos for n days, starting from day 1 to day n. The forest can be divided into m areas, numbered from 1 to m. He\'ll use the cameras in the following way:   On every odd day (1-st, 3-rd, 5-th, ...), bring the red camera to the forest and record a video for 2 days.  On every even day (2-nd, 4-th, 6-th, ...), bring the blue camera to the forest and record a video for 2 days.  If he starts recording on the n-th day with one of the cameras, the camera records for only one day. Each camera can observe k consecutive areas of the forest. For example, if m=5 and k=3, he can put a camera to observe one of these three ranges of areas for two days: [1,3], [2,4], and [3,5].Gildong got information about how many animals will be seen in each area each day. Since he would like to observe as many animals as possible, he wants you to find the best way to place the two cameras for n days. Note that if the two cameras are observing the same area on the same day, the animals observed in that area are counted only once." "data structures,dp" 2300
733D "Kostya the Sculptor" "Kostya is a genial sculptor, he has an idea: to carve a marble sculpture in the shape of a sphere. Kostya has a friend Zahar who works at a career. Zahar knows about Kostya\'s idea and wants to present him a rectangular parallelepiped of marble from which he can carve the sphere. Zahar has n stones which are rectangular parallelepipeds. The edges sizes of the i-th of them are ai, bi and ci. He can take no more than two stones and present them to Kostya. If Zahar takes two stones, he should glue them together on one of the faces in order to get a new piece of rectangular parallelepiped of marble. Thus, it is possible to glue a pair of stones together if and only if two faces on which they are glued together match as rectangles. In such gluing it is allowed to rotate and flip the stones in any way. Help Zahar choose such a present so that Kostya can carve a sphere of the maximum possible volume and present it to Zahar." "data structures,hashing" 1600
616B "Dinner with Emma" "Jack decides to invite Emma out for a dinner. Jack is a modest student, he doesn\'t want to go to an expensive restaurant. Emma is a girl with high taste, she prefers elite places.Munhattan consists of n streets and m avenues. There is exactly one restaurant on the intersection of each street and avenue. The streets are numbered with integers from 1 to n and the avenues are numbered with integers from 1 to m. The cost of dinner in the restaurant at the intersection of the i-th street and the j-th avenue is cij.Jack and Emma decide to choose the restaurant in the following way. Firstly Emma chooses the street to dinner and then Jack chooses the avenue. Emma and Jack makes their choice optimally: Emma wants to maximize the cost of the dinner, Jack wants to minimize it. Emma takes into account that Jack wants to minimize the cost of the dinner. Find the cost of the dinner for the couple in love." games,greedy 1000
86A Reflection "For each positive integer n consider the integer \xcf\x88(n) which is obtained from n by replacing every digit a in the decimal notation of n with the digit (9\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x89\xe2\x80\x89a). We say that \xcf\x88(n) is the reflection of n. For example, reflection of 192 equals 807. Note that leading zeros (if any) should be omitted. So reflection of 9 equals 0, reflection of 91 equals 8.Let us call the weight of the number the product of the number and its reflection. Thus, the weight of the number 10 is equal to 10\xc2\xb789\xe2\x80\x89=\xe2\x80\x89890.Your task is to find the maximum weight of the numbers in the given range [l,\xe2\x80\x89r] (boundaries are included)." math 1600
417A Elimination "The finalists of the ""Russian Code Cup"" competition in 2214 will be the participants who win in one of the elimination rounds.The elimination rounds are divided into main and additional. Each of the main elimination rounds consists of c problems, the winners of the round are the first n people in the rating list. Each of the additional elimination rounds consists of d problems. The winner of the additional round is one person. Besides, k winners of the past finals are invited to the finals without elimination.As a result of all elimination rounds at least n\xc2\xb7m people should go to the finals. You need to organize elimination rounds in such a way, that at least n\xc2\xb7m people go to the finals, and the total amount of used problems in all rounds is as small as possible." dp,implementation,math 1500
363B Fence "There is a fence in front of Polycarpus\'s home. The fence consists of n planks of the same width which go one after another from left to right. The height of the i-th plank is hi meters, distinct planks can have distinct heights.  Fence for n\xe2\x80\x89=\xe2\x80\x897 and h\xe2\x80\x89=\xe2\x80\x89[1,\xe2\x80\x892,\xe2\x80\x896,\xe2\x80\x891,\xe2\x80\x891,\xe2\x80\x897,\xe2\x80\x891] Polycarpus has bought a posh piano and is thinking about how to get it into the house. In order to carry out his plan, he needs to take exactly k consecutive planks from the fence. Higher planks are harder to tear off the fence, so Polycarpus wants to find such k consecutive planks that the sum of their heights is minimal possible.Write the program that finds the indexes of k consecutive planks with minimal total height. Pay attention, the fence is not around Polycarpus\'s home, it is in front of home (in other words, the fence isn\'t cyclic)." "brute force,dp" 1100
1864H "Asterism Stream" "Bogocubic is playing a game with amenotiomoi. First, Bogocubic fixed an integer n, and then he gave amenotiomoi an integer x which is initially equal to 1.In one move amenotiomoi performs one of the following operations with the same probability:  increase x by 1;  multiply x by 2. Bogocubic wants to find the expected number of moves amenotiomoi has to do to make x greater than or equal to n. Help him find this number modulo 998244353.Formally, let M=998244353. It can be shown that the answer can be expressed as an irreducible fraction pq, where p and q are integers and q\xe2\x89\xa20(modM). Output the integer equal to p\xe2\x8b\x85q\xe2\x88\x921modM. In other words, output such an integer y that 0\xe2\x89\xa4y<M and y\xe2\x8b\x85q\xe2\x89\xa1p(modM)." dp,math,matrices 3200
248D "Sweets for Everyone!" "For he knew every Who down in Whoville beneath, Was busy now, hanging a mistletoe wreath. ""And they\'re hanging their stockings!"" he snarled with a sneer, ""Tomorrow is Christmas! It\'s practically here!""Dr. Suess, How The Grinch Stole ChristmasChristmas celebrations are coming to Whoville. Cindy Lou Who and her parents Lou Lou Who and Betty Lou Who decided to give sweets to all people in their street. They decided to give the residents of each house on the street, one kilogram of sweets. So they need as many kilos of sweets as there are homes on their street.The street, where the Lou Who family lives can be represented as n consecutive sections of equal length. You can go from any section to a neighbouring one in one unit of time. Each of the sections is one of three types: an empty piece of land, a house or a shop. Cindy Lou and her family can buy sweets in a shop, but no more than one kilogram of sweets in one shop (the vendors care about the residents of Whoville not to overeat on sweets).After the Lou Who family leave their home, they will be on the first section of the road. To get to this section of the road, they also require one unit of time. We can assume that Cindy and her mom and dad can carry an unlimited number of kilograms of sweets. Every time they are on a house section, they can give a kilogram of sweets to the inhabitants of the house, or they can simply move to another section. If the family have already given sweets to the residents of a house, they can\'t do it again. Similarly, if they are on the shop section, they can either buy a kilo of sweets in it or skip this shop. If they\'ve bought a kilo of sweets in a shop, the seller of the shop remembered them and the won\'t sell them a single candy if they come again. The time to buy and give sweets can be neglected. The Lou Whos do not want the people of any house to remain without food.The Lou Whos want to spend no more than t time units of time to give out sweets, as they really want to have enough time to prepare for the Christmas celebration. In order to have time to give all the sweets, they may have to initially bring additional k kilos of sweets.Cindy Lou wants to know the minimum number of k kilos of sweets they need to take with them, to have time to give sweets to the residents of each house in their street.Your task is to write a program that will determine the minimum possible value of k." "binary search,greedy,implementation" 2300
997B "Roman Digits" "Let\'s introduce a number system which is based on a roman digits. There are digits I, V, X, L which correspond to the numbers 1, 5, 10 and 50 respectively. The use of other roman digits is not allowed.Numbers in this system are written as a sequence of one or more digits. We define the value of the sequence simply as the sum of digits in it.For example, the number XXXV evaluates to 35 and the number IXI \xe2\x80\x94 to 12.Pay attention to the difference to the traditional roman system \xe2\x80\x94 in our system any sequence of digits is valid, moreover the order of digits doesn\'t matter, for example IX means 11, not 9.One can notice that this system is ambiguous, and some numbers can be written in many different ways. Your goal is to determine how many distinct integers can be represented by exactly n roman digits I, V, X, L." "brute force,combinatorics,dp,greedy,math" 2000
1852A "Ntarsis\' Set" "Ntarsis has been given a set S, initially containing integers 1,2,3,\xe2\x80\xa6,101000 in sorted order. Every day, he will remove the a1-th, a2-th, \xe2\x80\xa6, an-th smallest numbers in S simultaneously.What is the smallest element in S after k days?" "binary search,math,number theory" 1800
961F k-substrings "You are given a string s consisting of n lowercase Latin letters.Let\'s denote k-substring of s as a string subsk\xe2\x80\x89=\xe2\x80\x89sksk\xe2\x80\x89+\xe2\x80\x891..sn\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89-\xe2\x80\x89k. Obviously, subs1\xe2\x80\x89=\xe2\x80\x89s, and there are exactly  such substrings.Let\'s call some string t an odd proper suprefix of a string T iff the following conditions are met: |T|\xe2\x80\x89>\xe2\x80\x89|t|;  |t| is an odd number;  t is simultaneously a prefix and a suffix of T.For evey k-substring () of s you have to calculate the maximum length of its odd proper suprefix." "binary search,hashing,string suffix structures" 2700
1205A "Almost Equal" "You are given integer n. You have to arrange numbers from 1 to 2n, using each of them exactly once, on the circle, so that the following condition would be satisfied:For every n consecutive numbers on the circle write their sum on the blackboard. Then any two of written on the blackboard 2n numbers differ not more than by 1.For example, choose n=3. On the left you can see an example of a valid arrangement: 1+4+5=10, 4+5+2=11, 5+2+3=10, 2+3+6=11, 3+6+1=10, 6+1+4=11, any two numbers differ by at most 1. On the right you can see an invalid arrangement: for example, 5+1+6=12, and 3+2+4=9, 9 and 12 differ more than by 1." "constructive algorithms,greedy,math" 1200
1562F "Tubular Bells" "Do you know what tubular bells are? They are a musical instrument made up of cylindrical metal tubes. In an orchestra, tubular bells are used to mimic the ringing of bells.Mike has tubular bells, too! They consist of n tubes, and each of the tubes has a length that can be expressed by a integer from l to r inclusive. It is clear that the lengths of all the tubes are different (it makes no sense to make the same tubes). It is also known that r\xe2\x88\x92l+1=n.Formally, we can say that Mike\'s tubular bells are described by a permutation a of length n that contains all numbers from l to r inclusive, with ai denoting the length of the i-th tube.You are offered an interesting task: to guess what Mike\'s instrument looks like. Simply, you must guess the permutation.Mike won\'t tell you l or r. He will only tell you n, and will allow you to ask no more than n+5000 queries.In each query, you name two positive integers x, y such that 1\xe2\x89\xa4x,y\xe2\x89\xa4n,x\xe2\x89\xa0y. In response to this query, the program written by Mike will give you lcm(ax,ay), where lcm(c,d) denotes the least common multiple of c and d.Solve Mike\'s problem!" "interactive,math,number theory,probabilities" 2900
1675C "Detective Task" "Polycarp bought a new expensive painting and decided to show it to his n friends. He hung it in his room. n of his friends entered and exited there one by one. At one moment there was no more than one person in the room. In other words, the first friend entered and left first, then the second, and so on.It is known that at the beginning (before visiting friends) a picture hung in the room. At the end (after the n-th friend) it turned out that it disappeared. At what exact moment it disappeared \xe2\x80\x94 there is no information.Polycarp asked his friends one by one. He asked each one if there was a picture when he entered the room. Each friend answered one of three:  no (response encoded with 0);  yes (response encoded as 1);  can\'t remember (response is encoded with ?). Everyone except the thief either doesn\'t remember or told the truth. The thief can say anything (any of the three options).Polycarp cannot understand who the thief is. He asks you to find out the number of those who can be considered a thief according to the answers." implementation 1100
1920C "Partitioning the Array" "Allen has an array a1,a2,\xe2\x80\xa6,an. For every positive integer k that is a divisor of n, Allen does the following:  He partitions the array into nk disjoint subarrays of length k. In other words, he partitions the array into the following subarrays: [a1,a2,\xe2\x80\xa6,ak],[ak+1,ak+2,\xe2\x80\xa6,a2k],\xe2\x80\xa6,[an\xe2\x88\x92k+1,an\xe2\x88\x92k+2,\xe2\x80\xa6,an]  Allen earns one point if there exists some positive integer m (m\xe2\x89\xa52) such that if he replaces every element in the array with its remainder when divided by m, then all subarrays will be identical. Help Allen find the number of points he will earn." "brute force,math,number theory" 1600
1840G2 "In Search of Truth (Hard Version)" "The only difference between easy and hard versions is the maximum number of queries. In this version, you are allowed to ask at most 1000 queries.This is an interactive problem.You are playing a game. The circle is divided into n sectors, sectors are numbered from 1 to n in some order. You are in the adjacent room and do not know either the number of sectors or their numbers. There is also an arrow that initially points to some sector. Initially, the host tells you the number of the sector to which the arrow points. After that, you can ask the host to move the arrow k sectors counterclockwise or clockwise at most 1000 times. And each time you are told the number of the sector to which the arrow points.Your task is to determine the integer n \xe2\x80\x94 the number of sectors in at most 1000 queries.It is guaranteed that 1\xe2\x89\xa4n\xe2\x89\xa4106." "constructive algorithms,interactive,math,meet-in-the-middle,probabilities" 2500
1054A "Elevator or Stairs?" "Masha lives in a multi-storey building, where floors are numbered with positive integers. Two floors are called adjacent if their numbers differ by one. Masha decided to visit Egor. Masha lives on the floor x, Egor on the floor y (not on the same floor with Masha).The house has a staircase and an elevator. If Masha uses the stairs, it takes t1 seconds for her to walk between adjacent floors (in each direction). The elevator passes between adjacent floors (in each way) in t2 seconds. The elevator moves with doors closed. The elevator spends t3 seconds to open or close the doors. We can assume that time is not spent on any action except moving between adjacent floors and waiting for the doors to open or close. If Masha uses the elevator, it immediately goes directly to the desired floor.Coming out of the apartment on her floor, Masha noticed that the elevator is now on the floor z and has closed doors. Now she has to choose whether to use the stairs or use the elevator. If the time that Masha needs to get to the Egor\'s floor by the stairs is strictly less than the time it will take her using the elevator, then she will use the stairs, otherwise she will choose the elevator.Help Mary to understand whether to use the elevator or the stairs." implementation 800
1725G Garage "Pak Chanek plans to build a garage. He wants the garage to consist of a square and a right triangle that are arranged like the following illustration.  Define a and b as the lengths of two of the sides in the right triangle as shown in the illustration. An integer x is suitable if and only if we can construct a garage with assigning positive integer values for the lengths a and b (a<b) so that the area of the square at the bottom is exactly x. As a good friend of Pak Chanek, you are asked to help him find the N-th smallest suitable number." "binary search,geometry,math" 1500
1753B "Factorial Divisibility" "You are given an integer x and an array of integers a1,a2,\xe2\x80\xa6,an. You have to determine if the number a1!+a2!+\xe2\x80\xa6+an! is divisible by x!.Here k! is a factorial of k \xe2\x80\x94 the product of all positive integers less than or equal to k. For example, 3!=1\xe2\x8b\x852\xe2\x8b\x853=6, and 5!=1\xe2\x8b\x852\xe2\x8b\x853\xe2\x8b\x854\xe2\x8b\x855=120." "math,number theory" 1600
2005C "Lazy Narek" "Narek is too lazy to create the third problem of this contest. His friend Artur suggests that he should use ChatGPT. ChatGPT creates n problems, each consisting of m letters, so Narek has n strings. To make the problem harder, he combines the problems by selecting some of the n strings possibly none and concatenating them without altering their order. His chance of solving the problem is defined as scoren\xe2\x88\x92scorec, where scoren is Narek\'s score and scorec is ChatGPT\'s score.Narek calculates scoren by examining the selected string (he moves from left to right). He initially searches for the letter ""n"", followed by ""a"", ""r"", ""e"", and ""k"". Upon finding all occurrences of these letters, he increments scoren by 5 and resumes searching for ""n"" again (he doesn\'t go back, and he just continues from where he left off). After Narek finishes, ChatGPT scans through the array and increments scorec by 1 for each letter ""n"", ""a"", ""r"", ""e"", or ""k"" that Narek fails to utilize (note that if Narek fails to complete the last occurrence by finding all of the 5 letters, then all of the letters he used are counted in ChatGPT\'s score scorec, and Narek doesn\'t get any points if he doesn\'t finish finding all the 5 letters).Narek aims to maximize the value of scoren\xe2\x88\x92scorec by selecting the most optimal subset of the initial strings." dp,implementation,strings 1800
580A "Kefa and First Steps" "Kefa decided to make some money doing business on the Internet for exactly n days. He knows that on the i-th day (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) he makes ai money. Kefa loves progress, that\'s why he wants to know the length of the maximum non-decreasing subsegment in sequence ai. Let us remind you that the subsegment of the sequence is its continuous fragment. A subsegment of numbers is called non-decreasing if all numbers in it follow in the non-decreasing order.Help Kefa cope with this task!" "brute force,dp,implementation" 900
1795D "Triangle Coloring" "You are given an undirected graph consisting of n vertices and n edges, where n is divisible by 6. Each edge has a weight, which is a positive (greater than zero) integer.The graph has the following structure: it is split into n3 triples of vertices, the first triple consisting of vertices 1,2,3, the second triple consisting of vertices 4,5,6, and so on. Every pair of vertices from the same triple is connected by an edge. There are no edges between vertices from different triples.You have to paint the vertices of this graph into two colors, red and blue. Each vertex should have exactly one color, there should be exactly n2 red vertices and n2 blue vertices. The coloring is called valid if it meets these constraints.The weight of the coloring is the sum of weights of edges connecting two vertices with different colors.Let W be the maximum possible weight of a valid coloring. Calculate the number of valid colorings with weight W, and print it modulo 998244353." combinatorics,math 1600
1619D "New Year\'s Problem" "Vlad has n friends, for each of whom he wants to buy one gift for the New Year.There are m shops in the city, in each of which he can buy a gift for any of his friends. If the j-th friend (1\xe2\x89\xa4j\xe2\x89\xa4n) receives a gift bought in the shop with the number i (1\xe2\x89\xa4i\xe2\x89\xa4m), then the friend receives pij units of joy. The rectangular table pij is given in the input.Vlad has time to visit at most n\xe2\x88\x921 shops (where n is the number of friends). He chooses which shops he will visit and for which friends he will buy gifts in each of them.Let the j-th friend receive aj units of joy from Vlad\'s gift. Let\'s find the value \xce\xb1=min{a1,a2,\xe2\x80\xa6,an}. Vlad\'s goal is to buy gifts so that the value of \xce\xb1 is as large as possible. In other words, Vlad wants to maximize the minimum of the joys of his friends.For example, let m=2, n=2. Let the joy from the gifts that we can buy in the first shop: p11=1, p12=2, in the second shop: p21=3, p22=4.Then it is enough for Vlad to go only to the second shop and buy a gift for the first friend, bringing joy 3, and for the second \xe2\x80\x94 bringing joy 4. In this case, the value \xce\xb1 will be equal to min{3,4}=3Help Vlad choose gifts for his friends so that the value of \xce\xb1 is as high as possible. Please note that each friend must receive one gift. Vlad can visit at most n\xe2\x88\x921 shops (where n is the number of friends). In the shop, he can buy any number of gifts." "binary search,greedy,sortings" 1800
1654B "Prefix Removals" "You are given a string s consisting of lowercase letters of the English alphabet. You must perform the following algorithm on s:  Let x be the length of the longest prefix of s which occurs somewhere else in s as a contiguous substring (the other occurrence may also intersect the prefix). If x=0, break. Otherwise, remove the first x characters of s, and repeat. A prefix is a string consisting of several first letters of a given string, without any reorders. An empty prefix is also a valid prefix. For example, the string ""abcd"" has 5 prefixes: empty string, ""a"", ""ab"", ""abc"" and ""abcd"".For instance, if we perform the algorithm on s= ""abcabdc"",   Initially, ""ab"" is the longest prefix that also appears somewhere else as a substring in s, so s= ""cabdc"" after 1 operation.  Then, ""c"" is the longest prefix that also appears somewhere else as a substring in s, so s= ""abdc"" after 2 operations.  Now x=0 (because there are no non-empty prefixes of ""abdc"" that also appear somewhere else as a substring in s), so the algorithm terminates. Find the final state of the string after performing the algorithm." strings 800
757D "Felicity\'s Big Secret Revealed" "The gym leaders were fascinated by the evolutions which took place at Felicity camp. So, they were curious to know about the secret behind evolving Pokemon. The organizers of the camp gave the gym leaders a PokeBlock, a sequence of n ingredients. Each ingredient can be of type 0 or 1. Now the organizers told the gym leaders that to evolve a Pokemon of type k (k\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x892), they need to make a valid set of k cuts on the PokeBlock to get smaller blocks.Suppose the given PokeBlock sequence is b0b1b2... bn\xe2\x80\x89-\xe2\x80\x891. You have a choice of making cuts at n\xe2\x80\x89+\xe2\x80\x891 places, i.e., Before b0, between b0 and b1, between b1 and b2, ..., between bn\xe2\x80\x89-\xe2\x80\x892 and bn\xe2\x80\x89-\xe2\x80\x891, and after bn\xe2\x80\x89-\xe2\x80\x891.The n\xe2\x80\x89+\xe2\x80\x891 choices of making cuts are as follows (where a | denotes a possible cut):| b0 | b1 | b2 | ... | bn\xe2\x80\x89-\xe2\x80\x892 | bn\xe2\x80\x89-\xe2\x80\x891 |Consider a sequence of k cuts. Now each pair of consecutive cuts will contain a binary string between them, formed from the ingredient types. The ingredients before the first cut and after the last cut are wasted, which is to say they are not considered. So there will be exactly k\xe2\x80\x89-\xe2\x80\x891 such binary substrings. Every substring can be read as a binary number. Let m be the maximum number out of the obtained numbers. If all the obtained numbers are positive and the set of the obtained numbers contains all integers from 1 to m, then this set of cuts is said to be a valid set of cuts.For example, suppose the given PokeBlock sequence is 101101001110 and we made 5 cuts in the following way:10 | 11 | 010 | 01 | 1 | 10So the 4 binary substrings obtained are: 11, 010, 01 and 1, which correspond to the numbers 3, 2, 1 and 1 respectively. Here m\xe2\x80\x89=\xe2\x80\x893, as it is the maximum value among the obtained numbers. And all the obtained numbers are positive and we have obtained all integers from 1 to m. Hence this set of cuts is a valid set of 5 cuts.A Pokemon of type k will evolve only if the PokeBlock is cut using a valid set of k cuts. There can be many valid sets of the same size. Two valid sets of k cuts are considered different if there is a cut in one set which is not there in the other set.Let f(k) denote the number of valid sets of k cuts. Find the value of . Since the value of s can be very large, output s modulo 109\xe2\x80\x89+\xe2\x80\x897." bitmasks,dp 2200
1155F "Delivery Oligopoly" "The whole delivery market of Berland is controlled by two rival companies: BerEx and BerPS. They both provide fast and reliable delivery services across all the cities of Berland.The map of Berland can be represented as an undirected graph. The cities are vertices and the roads are edges between them. Each pair of cities has no more than one road between them. Each road connects different cities.BerEx and BerPS are so competitive that for each pair of cities (v,u) they have set up their paths from v to u in such a way that these two paths don\'t share a single road. It is guaranteed that it was possible.Now Berland government decided to cut down the road maintenance cost by abandoning some roads. Obviously, they want to maintain as little roads as possible. However, they don\'t want to break the entire delivery system. So BerEx and BerPS should still be able to have their paths between every pair of cities non-intersecting.What is the minimal number of roads Berland government can maintain?More formally, given a 2-edge connected undirected graph, what is the minimum number of edges that can be left in it so that the resulting graph is also 2-edge connected?" "brute force,dp,graphs" 2800
1004D "Sonya and Matrix" "Since Sonya has just learned the basics of matrices, she decided to play with them a little bit.Sonya imagined a new type of matrices that she called rhombic matrices. These matrices have exactly one zero, while all other cells have the Manhattan distance to the cell containing the zero. The cells with equal numbers have the form of a rhombus, that is why Sonya called this type so.The Manhattan distance between two cells (x1, y1) and (x2, y2) is defined as |x1\xe2\x88\x92x2|+|y1\xe2\x88\x92y2|. For example, the Manhattan distance between the cells (5,2) and (7,1) equals to |5\xe2\x88\x927|+|2\xe2\x88\x921|=3.  Example of a rhombic matrix. Note that rhombic matrices are uniquely defined by n, m, and the coordinates of the cell containing the zero.She drew a n\xc3\x97m rhombic matrix. She believes that you can not recreate the matrix if she gives you only the elements of this matrix in some arbitrary order (i.e., the sequence of n\xe2\x8b\x85m numbers). Note that Sonya will not give you n and m, so only the sequence of numbers in this matrix will be at your disposal.Write a program that finds such an n\xc3\x97m rhombic matrix whose elements are the same as the elements in the sequence in some order." "brute force,constructive algorithms,implementation" 2300
868F "Yet Another Minimization Problem" "You are given an array of n integers a1... an. The cost of a subsegment is the number of unordered pairs of distinct indices within the subsegment that contain equal elements. Split the given array into k non-intersecting non-empty subsegments so that the sum of their costs is minimum possible. Each element should be present in exactly one subsegment." "divide and conquer,dp" 2500
2000B "Seating in a Bus" "In Berland, a bus consists of a row of n seats numbered from 1 to n. Passengers are advised to always board the bus following these rules:   If there are no occupied seats in the bus, a passenger can sit in any free seat; Otherwise, a passenger should sit in any free seat that has at least one occupied neighboring seat. In other words, a passenger can sit in a seat with index i (1\xe2\x89\xa4i\xe2\x89\xa4n) only if at least one of the seats with indices i\xe2\x88\x921 or i+1 is occupied. Today, n passengers boarded the bus. The array a chronologically records the seat numbers they occupied. That is, a1 contains the seat number where the first passenger sat, a2 \xe2\x80\x94 the seat number where the second passenger sat, and so on.You know the contents of the array a. Determine whether all passengers followed the recommendations.For example, if n=5, and a = [5,4,2,1,3], then the recommendations were not followed, as the 3-rd passenger sat in seat number 2, while the neighboring seats with numbers 1 and 3 were free." "two pointers" 800
1800D "Remove Two Letters" "Dmitry has a string s, consisting of lowercase Latin letters.Dmitry decided to remove two consecutive characters from the string s and you are wondering how many different strings can be obtained after such an operation.For example, Dmitry has a string ""aaabcc"". You can get the following different strings: ""abcc""(by deleting the first two or second and third characters), ""aacc""(by deleting the third and fourth characters),""aaac""(by deleting the fourth and the fifth character) and ""aaab"" (by deleting the last two)." "data structures,greedy,hashing,strings" 1200
1151D "Stas and the Queue at the Buffet" "During a break in the buffet of the scientific lyceum of the Kingdom of Kremland, there was formed a queue of n high school students numbered from 1 to n. Initially, each student i is on position i. Each student i is characterized by two numbers \xe2\x80\x94 ai and bi. Dissatisfaction of the person i equals the product of ai by the number of people standing to the left of his position, add the product bi by the number of people standing to the right of his position. Formally, the dissatisfaction of the student i, which is on the position j, equals ai\xe2\x8b\x85(j\xe2\x88\x921)+bi\xe2\x8b\x85(n\xe2\x88\x92j).The director entrusted Stas with the task: rearrange the people in the queue so that minimize the total dissatisfaction.Although Stas is able to solve such problems, this was not given to him. He turned for help to you." greedy,math,sortings 1600
1092D2 "Great Vova Wall (Version 2)" "Vova\'s family is building the Great Vova Wall (named by Vova himself). Vova\'s parents, grandparents, grand-grandparents contributed to it. Now it\'s totally up to Vova to put the finishing touches.The current state of the wall can be respresented by a sequence a of n integers, with ai being the height of the i-th part of the wall.Vova can only use 2\xc3\x971 bricks to put in the wall (he has infinite supply of them, however).Vova can put bricks only horizontally on the neighbouring parts of the wall of equal height. It means that if for some i the current height of part i is the same as for part i+1, then Vova can put a brick there and thus increase both heights by 1. Obviously, Vova can\'t put bricks in such a way that its parts turn out to be off the borders (to the left of part 1 of the wall or to the right of part n of it).Note that Vova can\'t put bricks vertically.Vova is a perfectionist, so he considers the wall completed when:  all parts of the wall has the same height;  the wall has no empty spaces inside it. Can Vova complete the wall using any amount of bricks (possibly zero)?" "data structures,implementation" 2200
1237D "Balanced Playlist" "Your favorite music streaming platform has formed a perfectly balanced playlist exclusively for you. The playlist consists of n tracks numbered from 1 to n. The playlist is automatic and cyclic: whenever track i finishes playing, track i+1 starts playing automatically; after track n goes track 1.For each track i, you have estimated its coolness ai. The higher ai is, the cooler track i is.Every morning, you choose a track. The playlist then starts playing from this track in its usual cyclic fashion. At any moment, you remember the maximum coolness x of already played tracks. Once you hear that a track with coolness strictly less than x2 (no rounding) starts playing, you turn off the music immediately to keep yourself in a good mood.For each track i, find out how many tracks you will listen to before turning off the music if you start your morning with track i, or determine that you will never turn the music off. Note that if you listen to the same track several times, every time must be counted." "binary search,data structures,implementation" 2000
64E "Prime Segment" "Positive integer number x is called prime, if it has exactly two positive integer divisors. For example, 2, 3, 17, 97 are primes, but 1, 10, 120 are not.You are given an integer number n, find the shortest segment [a,\xe2\x80\x89b], which contains n (i.e. a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b) and a,\xe2\x80\x89b are primes." "*special problem,brute force,math,number theory" 1800
339A "Helpful Maths" "Xenia the beginner mathematician is a third year student at elementary school. She is now learning the addition operation.The teacher has written down the sum of multiple numbers. Pupils should calculate the sum. To make the calculation easier, the sum only contains numbers 1, 2 and 3. Still, that isn\'t enough for Xenia. She is only beginning to count, so she can calculate a sum only if the summands follow in non-decreasing order. For example, she can\'t calculate sum 1+3+2+1 but she can calculate sums 1+1+2 and 3+3.You\'ve got the sum that was written on the board. Rearrange the summans and print the sum in such a way that Xenia can calculate the sum." greedy,implementation,sortings,strings 800
850F "Rainbow Balls" "You have a bag of balls of n different colors. You have ai balls of the i-th color.While there are at least two different colored balls in the bag, perform the following steps:   Take out two random balls without replacement one by one. These balls might be the same color.  Color the second ball to the color of the first ball. You are not allowed to switch the order of the balls in this step.  Place both balls back in the bag.  All these actions take exactly one second. Let M\xe2\x80\x89=\xe2\x80\x89109\xe2\x80\x89+\xe2\x80\x897. It can be proven that the expected amount of time needed before you stop can be represented as a rational number , where P and Q are coprime integers and where Q is not divisible by M. Return the value ." math 2800
1393C "Pinkie Pie Eats Patty-cakes" "Pinkie Pie has bought a bag of patty-cakes with different fillings! But it appeared that not all patty-cakes differ from one another with filling. In other words, the bag contains some patty-cakes with the same filling.Pinkie Pie eats the patty-cakes one-by-one. She likes having fun so she decided not to simply eat the patty-cakes but to try not to eat the patty-cakes with the same filling way too often. To achieve this she wants the minimum distance between the eaten with the same filling to be the largest possible. Herein Pinkie Pie called the distance between two patty-cakes the number of eaten patty-cakes strictly between them.Pinkie Pie can eat the patty-cakes in any order. She is impatient about eating all the patty-cakes up so she asks you to help her to count the greatest minimum distance between the eaten patty-cakes with the same filling amongst all possible orders of eating!Pinkie Pie is going to buy more bags of patty-cakes so she asks you to solve this problem for several bags!" "constructive algorithms,greedy,math,sortings" 1700
1725M "Moving Both Hands" "Pak Chanek is playing one of his favourite board games. In the game, there is a directed graph with N vertices and M edges. In the graph, edge i connects two different vertices Ui and Vi with a length of Wi. By using the i-th edge, something can move from Ui to Vi, but not from Vi to Ui.To play this game, initially Pak Chanek must place both of his hands onto two different vertices. In one move, he can move one of his hands to another vertex using an edge. To move a hand from vertex Ui to vertex Vi, Pak Chanek needs a time of Wi seconds. Note that Pak Chanek can only move one hand at a time. This game ends when both of Pak Chanek\'s hands are on the same vertex.Pak Chanek has several questions. For each p satisfying 2\xe2\x89\xa4p\xe2\x89\xa4N, you need to find the minimum time in seconds needed for Pak Chanek to end the game if initially Pak Chanek\'s left hand and right hand are placed on vertex 1 and vertex p, or report if it is impossible." "dp,graphs,shortest paths" 1800
547D "Mike and Fish" "As everyone knows, bears love fish. But Mike is a strange bear; He hates fish! The even more strange thing about him is he has an infinite number of blue and red fish.   He has marked n distinct points in the plane. i-th point is point (xi,\xe2\x80\x89yi). He wants to put exactly one fish in each of these points such that the difference between the number of red fish and the blue fish on each horizontal or vertical line is at most 1.He can\'t find a way to perform that! Please help him." "constructive algorithms,dfs and similar,graphs" 2600
17D Notepad "Nick is attracted by everything unconventional. He doesn\'t like decimal number system any more, and he decided to study other number systems. A number system with base b caught his attention. Before he starts studying it, he wants to write in his notepad all the numbers of length n without leading zeros in this number system. Each page in Nick\'s notepad has enough space for c numbers exactly. Nick writes every suitable number only once, starting with the first clean page and leaving no clean spaces. Nick never writes number 0 as he has unpleasant memories about zero divide.Would you help Nick find out how many numbers will be written on the last page." "number theory" 2400
241F Race "The Old City is a rectangular city represented as an m\xe2\x80\x89\xc3\x97\xe2\x80\x89n grid of blocks. This city contains many buildings, straight two-way streets and junctions. Each junction and each building is exactly one block. All the streets have width of one block and are either vertical or horizontal. There is a junction on both sides of each street. We call two blocks adjacent if and only if they share a common side. No two blocks of different streets are adjacent and no two junctions are adjacent. There is an annual festival and as a part of it, The Old Peykan follows a special path in the city. This path starts from a block in a street, continues with many junctions and ends in a block of some street. For each street block, we know how much time it takes for the Old Peykan to go from this block to an adjacent block. Also the Old Peykan can go from each junction to its adjacent street blocks in one minute. Of course Old Peykan can\'t go to building blocks.We know the initial position of the Old Peykan and the sequence of junctions that it passes to reach its destination. After passing all the junctions and reaching the destination, it will stay there forever. Your task is to find out where will the Old Peykan be k minutes after it starts moving. Consider that The Old Peykan always follows the shortest path that passes through the given sequence of junctions and reaches the destination.Note that the Old Peykan may visit some blocks more than once." "brute force,implementation" 2300
518E "Arthur and Questions" "After bracket sequences Arthur took up number theory. He has got a new favorite sequence of length n (a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an), consisting of integers and integer k, not exceeding n.This sequence had the following property: if you write out the sums of all its segments consisting of k consecutive elements (a1 \xe2\x80\x89+\xe2\x80\x89 a2 ... \xe2\x80\x89+\xe2\x80\x89 ak,\xe2\x80\x89 a2 \xe2\x80\x89+\xe2\x80\x89 a3 \xe2\x80\x89+\xe2\x80\x89 ... \xe2\x80\x89+\xe2\x80\x89 ak\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89 ...,\xe2\x80\x89 an\xe2\x80\x89-\xe2\x80\x89k\xe2\x80\x89+\xe2\x80\x891 \xe2\x80\x89+\xe2\x80\x89 an\xe2\x80\x89-\xe2\x80\x89k\xe2\x80\x89+\xe2\x80\x892 \xe2\x80\x89+\xe2\x80\x89 ... \xe2\x80\x89+\xe2\x80\x89 an), then those numbers will form strictly increasing sequence.For example, for the following sample: n\xe2\x80\x89=\xe2\x80\x895,\xe2\x80\x89 k\xe2\x80\x89=\xe2\x80\x893,\xe2\x80\x89 a\xe2\x80\x89=\xe2\x80\x89(1,\xe2\x80\x89 2,\xe2\x80\x89 4,\xe2\x80\x89 5,\xe2\x80\x89 6) the sequence of numbers will look as follows: (1 \xe2\x80\x89+\xe2\x80\x89 2 \xe2\x80\x89+\xe2\x80\x89 4,\xe2\x80\x89 2 \xe2\x80\x89+\xe2\x80\x89 4 \xe2\x80\x89+\xe2\x80\x89 5,\xe2\x80\x89 4 \xe2\x80\x89+\xe2\x80\x89 5 \xe2\x80\x89+\xe2\x80\x89 6) = (7,\xe2\x80\x89 11,\xe2\x80\x89 15), that means that sequence a meets the described property. Obviously the sequence of sums will have n\xe2\x80\x89-\xe2\x80\x89k\xe2\x80\x89+\xe2\x80\x891 elements.Somebody (we won\'t say who) replaced some numbers in Arthur\'s sequence by question marks (if this number is replaced, it is replaced by exactly one question mark). We need to restore the sequence so that it meets the required property and also minimize the sum |ai|, where |ai| is the absolute value of ai." "greedy,implementation,math,ternary search" 2200
1334G "Substring Search" "You are given a permutation p consisting of exactly 26 integers from 1 to 26 (since it is a permutation, each integer from 1 to 26 occurs in p exactly once) and two strings s and t consisting of lowercase Latin letters.A substring t\xe2\x80\xb2 of string t is an occurence of string s if the following conditions are met:  |t\xe2\x80\xb2|=|s|;  for each i\xe2\x88\x88[1,|s|], either si=t\xe2\x80\xb2i, or pidx(si)=idx(t\xe2\x80\xb2i), where idx(c) is the index of character c in Latin alphabet (idx(a)=1, idx(b)=2, idx(z)=26). For example, if p1=2, p2=3, p3=1, s=abc, t=abcaaba, then three substrings of t are occurences of s (they are t\xe2\x80\xb2=abc, t\xe2\x80\xb2=bca and t\xe2\x80\xb2=aba).For each substring of t having length equal to |s|, check if it is an occurence of s." "bitmasks,brute force,fft" 2900
1015D "Walking Between Houses" "There are n houses in a row. They are numbered from 1 to n in order from left to right. Initially you are in the house 1.You have to perform k moves to other house. In one move you go from your current house to some other house. You can\'t stay where you are (i.e., in each move the new house differs from the current house). If you go from the house x to the house y, the total distance you walked increases by |x\xe2\x88\x92y| units of distance, where |a| is the absolute value of a. It is possible to visit the same house multiple times (but you can\'t visit the same house in sequence).Your goal is to walk exactly s units of distance in total.If it is impossible, print ""NO"". Otherwise print ""YES"" and any of the ways to do that. Remember that you should do exactly k moves." "constructive algorithms,greedy" 1600
1592C "Bakry and Partitioning" "Bakry faced a problem, but since he\'s lazy to solve it, he asks for your help.You are given a tree of n nodes, the i-th node has value ai assigned to it for each i from 1 to n. As a reminder, a tree on n nodes is a connected graph with n\xe2\x88\x921 edges.You want to delete at least 1, but at most k\xe2\x88\x921 edges from the tree, so that the following condition would hold:For every connected component calculate the bitwise XOR of the values of the nodes in it. Then, these values have to be the same for all connected components.Is it possible to achieve this condition?" "bitmasks,constructive algorithms,dfs and similar,dp,graphs,trees" 1700
1933G "Turtle Magic: Royal Turtle Shell Pattern" "Turtle Alice is currently designing a fortune cookie box, and she would like to incorporate the theory of LuoShu into it.The box can be seen as an n\xc3\x97m grid (n,m\xe2\x89\xa55), where the rows are numbered 1,2,\xe2\x80\xa6,n and columns are numbered 1,2,\xe2\x80\xa6,m. Each cell can either be empty or have a single fortune cookie of one of the following shapes: circle or square. The cell at the intersection of the a-th row and the b-th column is denoted as (a,b).Initially, the entire grid is empty. Then, Alice performs q operations on the fortune cookie box. The i-th operation (1\xe2\x89\xa4i\xe2\x89\xa4q) is as follows: specify a currently empty cell (ri,ci) and a shape (circle or square), then put a fortune cookie of the specified shape on cell (ri,ci). Note that after the i-th operation, the cell (ri,ci) is no longer empty.Before all operations and after each of the q operations, Alice wonders what the number of ways to place fortune cookies in all remaining empty cells is, such that the following condition is satisfied:No three consecutive cells (in horizontal, vertical, and both diagonal directions) contain cookies of the same shape. Formally:  There does not exist any (i,j) satisfying 1\xe2\x89\xa4i\xe2\x89\xa4n,1\xe2\x89\xa4j\xe2\x89\xa4m\xe2\x88\x922, such that there are cookies of the same shape in cells (i,j),(i,j+1),(i,j+2).  There does not exist any (i,j) satisfying 1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x922,1\xe2\x89\xa4j\xe2\x89\xa4m, such that there are cookies of the same shape in cells (i,j),(i+1,j),(i+2,j).  There does not exist any (i,j) satisfying 1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x922,1\xe2\x89\xa4j\xe2\x89\xa4m\xe2\x88\x922, such that there are cookies of the same shape in cells (i,j),(i+1,j+1),(i+2,j+2).  There does not exist any (i,j) satisfying 1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x922,1\xe2\x89\xa4j\xe2\x89\xa4m\xe2\x88\x922, such that there are cookies of the same shape in cells (i,j+2),(i+1,j+1),(i+2,j). You should output all answers modulo 998244353. Also note that it is possible that after some operations, the condition is already not satisfied with the already placed candies, in this case you should output 0." "bitmasks,brute force,combinatorics,constructive algorithms,dfs and similar,math" 2300
41C "Email address" "Sometimes one has to spell email addresses over the phone. Then one usually pronounces a dot as dot, an at sign as at. As a result, we get something like vasyaatgmaildotcom. Your task is to transform it into a proper email address (vasya@gmail.com). It is known that a proper email address contains only such symbols as . @ and lower-case Latin letters, doesn\'t start with and doesn\'t end with a dot. Also, a proper email address doesn\'t start with and doesn\'t end with an at sign. Moreover, an email address contains exactly one such symbol as @, yet may contain any number (possible, zero) of dots. You have to carry out a series of replacements so that the length of the result was as short as possible and it was a proper email address. If the lengths are equal, you should print the lexicographically minimal result. Overall, two variants of replacement are possible: dot can be replaced by a dot, at can be replaced by an at." "expression parsing,implementation" 1300
1223D "Sequence Sorting" "You are given a sequence a1,a2,\xe2\x80\xa6,an, consisting of integers.You can apply the following operation to this sequence: choose some integer x and move all elements equal to x either to the beginning, or to the end of a. Note that you have to move all these elements in one direction in one operation.For example, if a=[2,1,3,1,1,3,2], you can get the following sequences in one operation (for convenience, denote elements equal to x as x-elements):   [1,1,1,2,3,3,2] if you move all 1-elements to the beginning;  [2,3,3,2,1,1,1] if you move all 1-elements to the end;  [2,2,1,3,1,1,3] if you move all 2-elements to the beginning;  [1,3,1,1,3,2,2] if you move all 2-elements to the end;  [3,3,2,1,1,1,2] if you move all 3-elements to the beginning;  [2,1,1,1,2,3,3] if you move all 3-elements to the end; You have to determine the minimum number of such operations so that the sequence a becomes sorted in non-descending order. Non-descending order means that for all i from 2 to n, the condition ai\xe2\x88\x921\xe2\x89\xa4ai is satisfied.Note that you have to answer q independent queries." "dp,greedy,two pointers" 2000
470D "Caesar Cipher" "Caesar cipher is one of the simplest encryption techniques. To transform the original message into encrypted one using key k, one has to replace each letter with a letter which is k positions later in the alphabet (if this takes the position beyond Z, the rest of it is counted from the start of the alphabet). In a more formal way, if letters of the alphabet are enumerated starting with 0, the result of encryption for character x will be  (26 is the number of letters in the Latin alphabet).You are given the original message and the encryption key k. Output the result of encryption." "*special problem" 1900
1354B "Ternary String" "You are given a string s such that each its character is either 1, 2, or 3. You have to choose the shortest contiguous substring of s such that it contains each of these three characters at least once.A contiguous substring of string s is a string that can be obtained from s by removing some (possibly zero) characters from the beginning of s and some (possibly zero) characters from the end of s." "binary search,dp,implementation,two pointers" 1200
254A "Cards with Numbers" "Petya has got 2n cards, each card contains some integer. The numbers on the cards can be the same. Let\'s index all cards by consecutive integers from 1 to 2n. We\'ll denote the number that is written on a card with number i, as ai. In order to play one entertaining game with his friends, Petya needs to split the cards into pairs so that each pair had equal numbers on the cards. Help Petya do that." "constructive algorithms,sortings" 1200
711B "Chris and Magic Square" "ZS the Coder and Chris the Baboon arrived at the entrance of Udayland. There is a n\xe2\x80\x89\xc3\x97\xe2\x80\x89n magic grid on the entrance which is filled with integers. Chris noticed that exactly one of the cells in the grid is empty, and to enter Udayland, they need to fill a positive integer into the empty cell.Chris tried filling in random numbers but it didn\'t work. ZS the Coder realizes that they need to fill in a positive integer such that the numbers in the grid form a magic square. This means that he has to fill in a positive integer so that the sum of the numbers in each row of the grid (), each column of the grid (), and the two long diagonals of the grid (the main diagonal \xe2\x80\x94  and the secondary diagonal \xe2\x80\x94 ) are equal. Chris doesn\'t know what number to fill in. Can you help Chris find the correct positive integer to fill in or determine that it is impossible?" "constructive algorithms,implementation" 1400
1950C "Clock Conversion" "Given the time in 24-hour format, output the equivalent time in 12-hour format.   24-hour format divides the day into 24 hours from 00 to 23, each of which has 60 minutes from 00 to 59.  12-hour format divides the day into two halves: the first half is AM, and the second half is PM. In each half, the hours are numbered in the order 12,01,02,03,\xe2\x80\xa6,11. Each hour has 60 minutes numbered from 00 to 59." implementation,math 800
920D Tanks "Petya sometimes has to water his field. To water the field, Petya needs a tank with exactly V ml of water.Petya has got N tanks, i-th of them initially containing ai ml of water. The tanks are really large, any of them can contain any amount of water (no matter how large this amount is).Also Petya has got a scoop that can contain up to K ml of water (initially the scoop is empty). This scoop can be used to get some water from some tank, and after that pour it all into some tank (it is impossible to get water from multiple tanks without pouring it, or leave some water in the scoop when pouring it). When Petya tries to get some water from a tank, he gets min(v,\xe2\x80\x89K) water, where v is the current volume of water in the tank.Is it possible to obtain a tank with exactly V ml of water using these operations? If it is possible, print a sequence of operations that allows to do it. If there are multiple ways to obtain needed amount of water in some tank, print any of them." dp,greedy,implementation 2400
1788F "XOR, Tree, and Queries" "You are given a tree of n vertices. The vertices are numbered from 1 to n.You will need to assign a weight to each edge. Let the weight of the i-th edge be ai (1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921). The weight of each edge should be an integer between 0 and 230\xe2\x88\x921, inclusive.You are given q conditions. Each condition consists of three integers u, v, and x. This means that the bitwise XOR of all edges on the shortest path from u to v should be x.Find out if there exist a1,a2,\xe2\x80\xa6,an\xe2\x88\x921 that satisfy the given conditions. If yes, print a solution such that a1\xe2\x8a\x95a2\xe2\x8a\x95\xe2\x80\xa6\xe2\x8a\x95an\xe2\x88\x921 is the smallest. Here, \xe2\x8a\x95 denotes the bitwise XOR operation.If there are multiple solutions such that a1\xe2\x8a\x95a2\xe2\x8a\x95\xe2\x80\xa6\xe2\x8a\x95an\xe2\x88\x921 is the smallest, print any." "bitmasks,constructive algorithms,dfs and similar,dsu,graphs,greedy,implementation,trees" 2500
1199B "Water Lily" "While sailing on a boat, Inessa noticed a beautiful water lily flower above the lake\'s surface. She came closer and it turned out that the lily was exactly H centimeters above the water surface. Inessa grabbed the flower and sailed the distance of L centimeters. Exactly at this point the flower touched the water surface.  Suppose that the lily grows at some point A on the lake bottom, and its stem is always a straight segment with one endpoint at point A. Also suppose that initially the flower was exactly above the point A, i.e. its stem was vertical. Can you determine the depth of the lake at point A?" geometry,math 1000
1598E Staircases "You are given a matrix, consisting of n rows and m columns. The rows are numbered top to bottom, the columns are numbered left to right.Each cell of the matrix can be either free or locked.Let\'s call a path in the matrix a staircase if it:   starts and ends in the free cell;  visits only free cells;  has one of the two following structures:   the second cell is 1 to the right from the first one, the third cell is 1 to the bottom from the second one, the fourth cell is 1 to the right from the third one, and so on;  the second cell is 1 to the bottom from the first one, the third cell is 1 to the right from the second one, the fourth cell is 1 to the bottom from the third one, and so on.  In particular, a path, consisting of a single cell, is considered to be a staircase.Here are some examples of staircases:  Initially all the cells of the matrix are free.You have to process q queries, each of them flips the state of a single cell. So, if a cell is currently free, it makes it locked, and if a cell is currently locked, it makes it free.Print the number of different staircases after each query. Two staircases are considered different if there exists such a cell that appears in one path and doesn\'t appear in the other path." "brute force,combinatorics,data structures,dfs and similar,dp,implementation,math" 2100
661F "Primes in Interval" "You are given two integers a and b (a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b). How many prime numbers are there on the interval from a to b, inclusive?" "*special problem" 1900
1821D "Black Cells" "You are playing with a really long strip consisting of 1018 white cells, numbered from left to right as 0, 1, 2 and so on. You are controlling a special pointer that is initially in cell 0. Also, you have a ""Shift"" button you can press and hold.In one move, you can do one of three actions:   move the pointer to the right (from cell x to cell x+1);  press and hold the ""Shift"" button;  release the ""Shift"" button: the moment you release ""Shift"", all cells that were visited while ""Shift"" was pressed are colored in black.  (Of course, you can\'t press Shift if you already hold it. Similarly, you can\'t release Shift if you haven\'t pressed it.)Your goal is to color at least k cells, but there is a restriction: you are given n segments [li,ri] \xe2\x80\x94 you can color cells only inside these segments, i. e. you can color the cell x if and only if li\xe2\x89\xa4x\xe2\x89\xa4ri for some i.What is the minimum number of moves you need to make in order to color at least k cells black?" "binary search,brute force,greedy,math" 1900
123A "Prime Permutation" "You are given a string s, consisting of small Latin letters. Let\'s denote the length of the string as |s|. The characters in the string are numbered starting from 1. Your task is to find out if it is possible to rearrange characters in string s so that for any prime number p\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|s| and for any integer i ranging from 1 to |s|\xe2\x80\x89/\xe2\x80\x89p (inclusive) the following condition was fulfilled sp\xe2\x80\x89=\xe2\x80\x89sp\xe2\x80\x89\xc3\x97\xe2\x80\x89i. If the answer is positive, find one way to rearrange the characters." "implementation,number theory,strings" 1300
321D "Ciel and Flipboard" "Fox Ciel has a board with n rows and n columns, there is one integer in each cell.It\'s known that n is an odd number, so let\'s introduce . Fox Ciel can do the following operation many times: she choose a sub-board with size x rows and x columns, then all numbers in it will be multiplied by -1.Return the maximal sum of numbers in the board that she can get by these operations." dp,greedy,math 2900
609C "Load Balancing" "In the school computer room there are n servers which are responsible for processing several computing tasks. You know the number of scheduled tasks for each server: there are mi tasks assigned to the i-th server.In order to balance the load for each server, you want to reassign some tasks to make the difference between the most loaded server and the least loaded server as small as possible. In other words you want to minimize expression ma\xe2\x80\x89-\xe2\x80\x89mb, where a is the most loaded server and b is the least loaded one.In one second you can reassign a single task. Thus in one second you can choose any pair of servers and move a single task from one server to another.Write a program to find the minimum number of seconds needed to balance the load of servers." implementation,math 1500
1731A "Joey Takes Money" "Joey is low on money. His friend Chandler wants to lend Joey some money, but can\'t give him directly, as Joey is too proud of himself to accept it. So, in order to trick him, Chandler asks Joey to play a game.In this game, Chandler gives Joey an array a1,a2,\xe2\x80\xa6,an (n\xe2\x89\xa52) of positive integers (ai\xe2\x89\xa51).Joey can perform the following operation on the array any number of times:   Take two indices i and j (1\xe2\x89\xa4i<j\xe2\x89\xa4n).  Choose two integers x and y (x,y\xe2\x89\xa51) such that x\xe2\x8b\x85y=ai\xe2\x8b\x85aj.  Replace ai by x and aj by y. In the end, Joey will get the money equal to the sum of elements of the final array. Find the maximum amount of money ans Joey can get but print 2022\xe2\x8b\x85ans. Why multiplied by 2022? Because we are never gonna see it again!It is guaranteed that the product of all the elements of the array a doesn\'t exceed 1012." greedy,math 800
852A Digits "John gave Jack a very hard problem. He wrote a very big positive integer A0 on a piece of paper. The number is less than 10200000 . In each step, Jack is allowed to put \'\xe2\x80\x89+\xe2\x80\x89\' signs in between some of the digits (maybe none) of the current number and calculate the sum of the expression. He can perform the same procedure on that sum and so on. The resulting sums can be labeled respectively by A1, A2 etc. His task is to get to a single digit number.The problem is that there is not much blank space on the paper. There are only three lines of space, so he can\'t perform more than three steps. Since he wants to fill up the paper completely, he will perform exactly three steps.Jack must not add leading zeros to intermediate results, but he can put \'\xe2\x80\x89+\xe2\x80\x89\' signs in front of digit 0. For example, if the current number is 1000100, 10\xe2\x80\x89+\xe2\x80\x89001\xe2\x80\x89+\xe2\x80\x8900 is a valid step, resulting in number 11." "brute force,implementation,math" 2500
1196F "K-th Path" "You are given a connected undirected weighted graph consisting of n vertices and m edges.You need to print the k-th smallest shortest path in this graph (paths from the vertex to itself are not counted, paths from i to j and from j to i are counted as one).More formally, if d is the matrix of shortest paths, where di,j is the length of the shortest path between vertices i and j (1\xe2\x89\xa4i<j\xe2\x89\xa4n), then you need to print the k-th element in the sorted array consisting of all di,j, where 1\xe2\x89\xa4i<j\xe2\x89\xa4n." "brute force,constructive algorithms,shortest paths,sortings" 2200
1887F "Minimum Segments" "You had a sequence a1,a2,\xe2\x80\xa6,an consisting of integers from 1 to n, not necessarily distinct. For some unknown reason, you decided to calculate the following characteristic of the sequence:   Let ri (1\xe2\x89\xa4i\xe2\x89\xa4n) be the smallest j\xe2\x89\xa5i such that on the subsegment ai,ai+1,\xe2\x80\xa6,aj all distinct numbers from the sequence a appear. More formally, for any k\xe2\x88\x88[1,n], there exists l\xe2\x88\x88[i,j] such that ak=al. If such j does not exist, ri is considered to be equal to n+1.  The characteristic of the sequence a is defined as the sequence r1,r2,\xe2\x80\xa6,rn.  Unfortunately, the sequence a got lost, but you still have its characteristic r. You want to reconstruct any sequence a that matches the characteristic, or determine that there is an error in the characteristic and such a sequence does not exist." "constructive algorithms" 3400
526B "Om Nom and Dark Park" "Om Nom is the main character of a game ""Cut the Rope"". He is a bright little monster who likes visiting friends living at the other side of the park. However the dark old parks can scare even somebody as fearless as Om Nom, so he asks you to help him.  The park consists of 2n\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89-\xe2\x80\x891 squares connected by roads so that the scheme of the park is a full binary tree of depth n. More formally, the entrance to the park is located at the square 1. The exits out of the park are located at squares 2n,\xe2\x80\x892n\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x892n\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89-\xe2\x80\x891 and these exits lead straight to the Om Nom friends\' houses. From each square i (2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x892n\xe2\x80\x89+\xe2\x80\x891) there is a road to the square . Thus, it is possible to go from the park entrance to each of the exits by walking along exactly n roads.    To light the path roads in the evening, the park keeper installed street lights along each road. The road that leads from square i to square  has ai lights.Om Nom loves counting lights on the way to his friend. Om Nom is afraid of spiders who live in the park, so he doesn\'t like to walk along roads that are not enough lit. What he wants is that the way to any of his friends should have in total the same number of lights. That will make him feel safe. He asked you to help him install additional lights. Determine what minimum number of lights it is needed to additionally place on the park roads so that a path from the entrance to any exit of the park contains the same number of street lights. You may add an arbitrary number of street lights to each of the roads." "dfs and similar,greedy,implementation" 1400
1532A "A+B (Trial Problem)" "You are given two integers a and b. Print a+b." "*special problem" -999
1153A "Serval and Bus" "It is raining heavily. But this is the first day for Serval, who just became 3 years old, to go to the kindergarten. Unfortunately, he lives far from kindergarten, and his father is too busy to drive him there. The only choice for this poor little boy is to wait for a bus on this rainy day. Under such circumstances, the poor boy will use the first bus he sees no matter where it goes. If several buses come at the same time, he will choose one randomly.Serval will go to the bus station at time t, and there are n bus routes which stop at this station. For the i-th bus route, the first bus arrives at time si minutes, and each bus of this route comes di minutes later than the previous one.As Serval\'s best friend, you wonder which bus route will he get on. If several buses arrive at the same time, you can print any of them." "brute force,math" 1000
899A "Splitting in Teams" "There were n groups of students which came to write a training contest. A group is either one person who can write the contest with anyone else, or two people who want to write the contest in the same team.The coach decided to form teams of exactly three people for this training. Determine the maximum number of teams of three people he can form. It is possible that he can\'t use all groups to form teams. For groups of two, either both students should write the contest, or both should not. If two students from a group of two will write the contest, they should be in the same team." "constructive algorithms,greedy,math" 800
937A Olympiad "The recent All-Berland Olympiad in Informatics featured n participants with each scoring a certain amount of points.As the head of the programming committee, you are to determine the set of participants to be awarded with diplomas with respect to the following criteria:   At least one participant should get a diploma.  None of those with score equal to zero should get awarded.  When someone is awarded, all participants with score not less than his score should also be awarded. Determine the number of ways to choose a subset of participants that will receive the diplomas." implementation,sortings 800
13C Sequence "Little Petya likes to play very much. And most of all he likes to play the following game:He is given a sequence of N integer numbers. At each step it is allowed to increase the value of any number by 1 or to decrease it by 1. The goal of the game is to make the sequence non-decreasing with the smallest number of steps. Petya is not good at math, so he asks for your help.The sequence a is called non-decreasing if a1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89...\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89aN holds, where N is the length of the sequence." dp,sortings 2200
149C "Division into Teams" "Petya loves football very much, especially when his parents aren\'t home. Each morning he comes to the yard, gathers his friends and they play all day. From time to time they have a break to have some food or do some chores (for example, water the flowers).The key in football is to divide into teams fairly before the game begins. There are n boys playing football in the yard (including Petya), each boy\'s football playing skill is expressed with a non-negative characteristic ai (the larger it is, the better the boy plays). Let\'s denote the number of players in the first team as x, the number of players in the second team as y, the individual numbers of boys who play for the first team as pi and the individual numbers of boys who play for the second team as qi. Division n boys into two teams is considered fair if three conditions are fulfilled:  Each boy plays for exactly one team (x\xe2\x80\x89+\xe2\x80\x89y\xe2\x80\x89=\xe2\x80\x89n).  The sizes of teams differ in no more than one (|x\xe2\x80\x89-\xe2\x80\x89y|\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x891).  The total football playing skills for two teams differ in no more than by the value of skill the best player in the yard has. More formally: Your task is to help guys divide into two teams fairly. It is guaranteed that a fair division into two teams always exists." greedy,math,sortings 1500
932B "Recursive Queries" "Let us define two functions f and g on positive integer numbers.   You need to process Q queries. In each query, you will be given three integers l, r and k. You need to print the number of integers x between l and r inclusive, such that g(x)\xe2\x80\x89=\xe2\x80\x89k." "binary search,data structures,dfs and similar" 1300
40D "Interesting Sequence" "Berland scientists noticed long ago that the world around them depends on Berland population. Due to persistent research in this area the scientists managed to find out that the Berland chronology starts from the moment when the first two people came to that land (it is considered to have happened in the first year). After one Berland year after the start of the chronology the population had already equaled 13 people (the second year). However, tracing the population number during the following years was an ultimately difficult task, still it was found out that if di \xe2\x80\x94 the number of people in Berland in the year of i, then either di\xe2\x80\x89=\xe2\x80\x8912di\xe2\x80\x89-\xe2\x80\x892, or di\xe2\x80\x89=\xe2\x80\x8913di\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89-\xe2\x80\x8912di\xe2\x80\x89-\xe2\x80\x892. Of course no one knows how many people are living in Berland at the moment, but now we can tell if there could possibly be a year in which the country population equaled A. That\'s what we ask you to determine. Also, if possible, you have to find out in which years it could be (from the beginning of Berland chronology). Let\'s suppose that it could be in the years of a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89ak. Then you have to define how many residents could be in the country during those years apart from the A variant. Look at the examples for further explanation." math 2600
1071E "Rain Protection" "A lot of people dream of convertibles (also often called cabriolets). Some of convertibles, however, don\'t have roof at all, and are vulnerable to rain. This is why Melon Ask, the famous inventor, decided to create a rain protection mechanism for convertibles.The workplace of the mechanism is a part of plane just above the driver. Its functional part consists of two rails with sliding endpoints of a piece of stretching rope. For the sake of simplicity we can consider this as a pair of parallel segments in a plane with the rope segment, whose endpoints we are free to choose as any points on these rails segments.  The algorithmic part of the mechanism detects each particular raindrop and predicts when and where it reaches the plane. At this exact moment the rope segment must contain the raindrop point (so the rope adsorbs the raindrop).You are given the initial position of the rope endpoints and all information about raindrops. You are to choose the minimal possible speed v of the endpoints sliding (both endpoints can slide in any direction along their segments independently of each other) in such a way that it is possible to catch all raindrops moving both endpoints with speed not greater than v, or find out that it\'s impossible no matter how high the speed is." "binary search,geometry" 3500
1775D "Friendly Spiders" "Mars is home to an unusual species of spiders \xe2\x80\x94 Binary spiders.Right now, Martian scientists are observing a colony of nn spiders, the ii-th of which has aiai legs.Some of the spiders are friends with each other. Namely, the ii-th and jj-th spiders are friends if gcd(ai,aj)\xe2\x89\xa01gcd(ai,aj)\xe2\x89\xa01, i. e., there is some integer k\xe2\x89\xa52k\xe2\x89\xa52 such that aiai and ajaj are simultaneously divided by kk without a remainder. Here gcd(x,y)gcd(x,y) denotes the greatest common divisor (GCD) of integers xx and yy.Scientists have discovered that spiders can send messages. If two spiders are friends, then they can transmit a message directly in one second. Otherwise, the spider must pass the message to his friend, who in turn must pass the message to his friend, and so on until the message reaches the recipient.Let\'s look at an example.Suppose a spider with eight legs wants to send a message to a spider with 1515 legs. He can\'t do it directly, because gcd(8,15)=1gcd(8,15)=1. But he can send a message through the spider with six legs because gcd(8,6)=2gcd(8,6)=2 and gcd(6,15)=3gcd(6,15)=3. Thus, the message will arrive in two seconds.Right now, scientists are observing how the ss-th spider wants to send a message to the tt-th spider. The researchers have a hypothesis that spiders always transmit messages optimally. For this reason, scientists would need a program that could calculate the minimum time to send a message and also deduce one of the optimal routes." "dfs and similar,graphs,math,number theory,shortest paths" 1800
1729B "Decode String" "Polycarp has a string s consisting of lowercase Latin letters.He encodes it using the following algorithm.He goes through the letters of the string s from left to right and for each letter Polycarp considers its number in the alphabet:  if the letter number is single-digit number (less than 10), then just writes it out;  if the letter number is a two-digit number (greater than or equal to 10), then it writes it out and adds the number 0 after. For example, if the string s is code, then Polycarp will encode this string as follows:  \'c\' \xe2\x80\x94 is the 3-rd letter of the alphabet. Consequently, Polycarp adds 3 to the code (the code becomes equal to 3);  \'o\' \xe2\x80\x94 is the 15-th letter of the alphabet. Consequently, Polycarp adds 15 to the code and also 0 (the code becomes 3150);  \'d\' \xe2\x80\x94 is the 4-th letter of the alphabet. Consequently, Polycarp adds 4 to the code (the code becomes 31504);  \'e\' \xe2\x80\x94 is the 5-th letter of the alphabet. Therefore, Polycarp adds 5 to the code (the code becomes 315045). Thus, code of string code is 315045.You are given a string t resulting from encoding the string s. Your task is to decode it (get the original string s by t)." greedy,strings 800
1510J "Japanese Game" "Joseph really likes the culture of Japan. Last year he learned Japanese traditional clothes and visual arts and now he is trying to find out the secret of the Japanese game called Nonogram.In the one-dimensional version of the game, there is a row of n empty cells, some of which are to be filled with a pen. There is a description of a solution called a profile \xe2\x80\x94 a sequence of positive integers denoting the lengths of consecutive sets of filled cells. For example, the profile of [4,3,1] means that there are sets of four, three, and one filled cell, in that order, with at least one empty cell between successive sets. A suitable solution for n=12 and p=[4,3,1].  A wrong solution: the first four filled cells should be consecutive.  A wrong solution: there should be at least one empty cell before the last filled cell. Joseph found out that for some numbers n and profiles p there are lots of ways to fill the cells to satisfy the profile. Now he is in the process of solving a nonogram consisting of n cells and a profile p. He has already created a mask of p \xe2\x80\x94 he has filled all the cells that must be filled in every solution of the nonogram. The mask for n=12 and p=[4,3,1]: all the filled cells above are filled in every solution. After a break, he lost the source profile p. He only has n and the mask m. Help Joseph find any profile p\xe2\x80\xb2 with the mask m or say that there is no such profile and Joseph has made a mistake." "constructive algorithms,math" 2700
168B "Wizards and Minimal Spell" "Let\'s dive into one of the most interesting areas of magic \xe2\x80\x94 writing spells. Learning this exciting but challenging science is very troublesome, so now you will not learn the magic words, but only get to know the basic rules of writing spells.Each spell consists of several lines. The line, whose first non-space character is character ""#"" is an amplifying line and it is responsible for spell power. The remaining lines are common, and determine the effect of the spell.You came across the text of some spell. Spell was too long, so you cannot understand its meaning. So you want to make it as short as possible without changing the meaning.The only way to shorten a spell that you know is the removal of some spaces and line breaks. We know that when it comes to texts of spells, the spaces carry meaning only in the amplifying lines, so we should remove all spaces in other lines. Newlines also do not matter, unless any of the two separated lines is amplifying. Thus, if two consecutive lines are not amplifying, they need to be joined into one (i.e. we should concatenate the second line to the first one). Removing spaces in amplifying lines and concatenating the amplifying lines to anything is forbidden.Note that empty lines must be processed just like all the others: they must be joined to the adjacent non-amplifying lines, or preserved in the output, if they are surrounded with amplifying lines on both sides (i.e. the line above it, if there is one, is amplifying, and the line below it, if there is one, is amplifying too).For now those are the only instructions for removing unnecessary characters that you have to follow (oh yes, a newline is a character, too).The input contains the text of the spell, which should be reduced. Remove the extra characters and print the result to the output." implementation,strings 1700
1553H "XOR and Distance" "You are given an array a consisting of n distinct elements and an integer k. Each element in the array is a non-negative integer not exceeding 2k\xe2\x88\x921.Let\'s define the XOR distance for a number x as the value of f(x)=nmini=1nminj=i+1|(ai\xe2\x8a\x95x)\xe2\x88\x92(aj\xe2\x8a\x95x)|,where \xe2\x8a\x95 denotes the bitwise XOR operation.For every integer x from 0 to 2k\xe2\x88\x921, you have to calculate f(x)." "bitmasks,divide and conquer,trees" 2900
365A "Good Number" "Let\'s call a number k-good if it contains all digits not exceeding k (0,\xe2\x80\x89...,\xe2\x80\x89k). You\'ve got a number k and an array a containing n numbers. Find out how many k-good numbers are in a (count each number every time it occurs in array a)." implementation 1100
1234E "Special Permutations" "Let\'s define pi(n) as the following permutation: [i,1,2,\xe2\x80\xa6,i\xe2\x88\x921,i+1,\xe2\x80\xa6,n]. This means that the i-th permutation is almost identity (i.e. which maps every element to itself) permutation but the element i is on the first position. Examples:  p1(4)=[1,2,3,4];  p2(4)=[2,1,3,4];  p3(4)=[3,1,2,4];  p4(4)=[4,1,2,3]. You are given an array x1,x2,\xe2\x80\xa6,xm (1\xe2\x89\xa4xi\xe2\x89\xa4n).Let pos(p,val) be the position of the element val in p. So, pos(p1(4),3)=3,pos(p2(4),2)=1,pos(p4(4),4)=1.Let\'s define a function f(p)=m\xe2\x88\x921\xe2\x88\x91i=1|pos(p,xi)\xe2\x88\x92pos(p,xi+1)|, where |val| is the absolute value of val. This function means the sum of distances between adjacent elements of x in p.Your task is to calculate f(p1(n)),f(p2(n)),\xe2\x80\xa6,f(pn(n))." math 2000
487A "Fight the Monster" "A monster is attacking the Cyberland!Master Yang, a braver, is going to beat the monster. Yang and the monster each have 3 attributes: hitpoints (HP), offensive power (ATK) and defensive power (DEF).During the battle, every second the monster\'s HP decrease by max(0,\xe2\x80\x89ATKY\xe2\x80\x89-\xe2\x80\x89DEFM), while Yang\'s HP decreases by max(0,\xe2\x80\x89ATKM\xe2\x80\x89-\xe2\x80\x89DEFY), where index Y denotes Master Yang and index M denotes monster. Both decreases happen simultaneously Once monster\'s HP\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x890 and the same time Master Yang\'s HP\xe2\x80\x89>\xe2\x80\x890, Master Yang wins.Master Yang can buy attributes from the magic shop of Cyberland: h bitcoins per HP, a bitcoins per ATK, and d bitcoins per DEF.Now Master Yang wants to know the minimum number of bitcoins he can spend in order to win." "binary search,brute force,implementation" 1800
1800E1 "Unforgivable Curse (easy version)" "This is an easy version of the problem. In this version, k is always 3.The chief wizard of the Wizengamot once caught the evil wizard Drahyrt, but the evil wizard has returned and wants revenge on the chief wizard. So he stole spell s from his student Harry.The spell \xe2\x80\x94 is a n-length string of lowercase Latin letters.Drahyrt wants to replace spell with an unforgivable curse \xe2\x80\x94 string t.Drahyrt, using ancient magic, can swap letters at a distance k or k+1 in spell as many times as he wants. In this version of the problem, you can swap letters at a distance of 3 or 4. In other words, Drahyrt can change letters in positions i and j in spell s if |i\xe2\x88\x92j|=3 or |i\xe2\x88\x92j|=4.For example, if s= ""talant"" and t= ""atltna"", Drahyrt can act as follows:  swap the letters at positions 1 and 4 to get spell ""aaltnt"".  swap the letters at positions 2 and 6 to get spell ""atltna"". You are given spells s and t. Can Drahyrt change spell s to t?" "brute force,constructive algorithms,dsu,graphs,greedy,strings" 1400
425E "Sereja and Sets" "Let\'s assume that set S consists of m distinct intervals [l1,\xe2\x80\x89r1], [l2,\xe2\x80\x89r2], ..., [lm,\xe2\x80\x89rm] (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89li\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ri\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n; li,\xe2\x80\x89ri are integers).Let\'s assume that f(S) is the maximum number of intervals that you can choose from the set S, such that every two of them do not intersect. We assume that two intervals, [l1,\xe2\x80\x89r1] and [l2,\xe2\x80\x89r2], intersect if there is an integer x, which meets two inequalities: l1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r1 and l2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r2.Sereja wonders, how many sets S are there, such that f(S)\xe2\x80\x89=\xe2\x80\x89k? Count this number modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." dp 2500
230A Dragons "Kirito is stuck on a level of the MMORPG he is playing now. To move on in the game, he\'s got to defeat all n dragons that live on this level. Kirito and the dragons have strength, which is represented by an integer. In the duel between two opponents the duel\'s outcome is determined by their strength. Initially, Kirito\'s strength equals s.If Kirito starts duelling with the i-th (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) dragon and Kirito\'s strength is not greater than the dragon\'s strength xi, then Kirito loses the duel and dies. But if Kirito\'s strength is greater than the dragon\'s strength, then he defeats the dragon and gets a bonus strength increase by yi.Kirito can fight the dragons in any order. Determine whether he can move on to the next level of the game, that is, defeat all dragons without a single loss." greedy,sortings 1000
1806E "Tree Master" "You are given a tree with n weighted vertices labeled from 1 to n rooted at vertex 1. The parent of vertex i is pi and the weight of vertex i is ai. For convenience, define p1=0.For two vertices x and y of the same depth\xe2\x80\xa0, define f(x,y) as follows:   Initialize ans=0.  While both x and y are not 0:   ans\xe2\x86\x90ans+ax\xe2\x8b\x85ay;  x\xe2\x86\x90px;  y\xe2\x86\x90py.   f(x,y) is the value of ans. You will process q queries. In the i-th query, you are given two integers xi and yi and you need to calculate f(xi,yi).\xe2\x80\xa0 The depth of vertex v is the number of edges on the unique simple path from the root of the tree to vertex v." "brute force,data structures,dfs and similar,trees" 2200
1098C "Construct a tree" "Misha walked through the snowy forest and he was so fascinated by the trees to decide to draw his own tree!Misha would like to construct a rooted tree with n vertices, indexed from 1 to n, where the root has index 1. Every other vertex has a parent pi, and i is called a child of vertex pi. Vertex u belongs to the subtree of vertex v iff v is reachable from u while iterating over the parents (u, pu, ppu, ...). Clearly, v belongs to its own subtree, and the number of vertices in the subtree is called the size of the subtree. Misha is only interested in trees where every vertex belongs to the subtree of vertex 1.Below there is a tree with 6 vertices. The subtree of vertex 2 contains vertices 2, 3, 4, 5. Hence the size of its subtree is 4.   The branching coefficient of the tree is defined as the maximum number of children in any vertex. For example, for the tree above the branching coefficient equals 2. Your task is to construct a tree with n vertices such that the sum of the subtree sizes for all vertices equals s, and the branching coefficient is minimum possible." "binary search,constructive algorithms,dfs and similar,graphs,greedy,trees" 2400
891B Gluttony "You are given an array a with n distinct integers. Construct an array b by permuting a such that for every non-empty subset of indices S\xe2\x80\x89=\xe2\x80\x89{x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xk} (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89xi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n, 0\xe2\x80\x89<\xe2\x80\x89k\xe2\x80\x89<\xe2\x80\x89n) the sums of elements on that positions in a and b are different, i. e." "constructive algorithms,greedy" 2000
1244E "Minimizing Difference" "You are given a sequence a1,a2,\xe2\x80\xa6,an consisting of n integers.You may perform the following operation on this sequence: choose any element and either increase or decrease it by one.Calculate the minimum possible difference between the maximum element and the minimum element in the sequence, if you can perform the aforementioned operation no more than k times." "binary search,constructive algorithms,greedy,sortings,ternary search,two pointers" 2000
2033D "Kousuke\'s Assignment" "After a trip with Sakurako, Kousuke was very scared because he forgot about his programming assignment. In this assignment, the teacher gave him an array a of n integers and asked him to calculate the number of non-overlapping segments of the array a, such that each segment is considered beautiful.A segment [l,r] is considered beautiful if al+al+1+\xe2\x8b\xaf+ar\xe2\x88\x921+ar=0.For a fixed array a, your task is to compute the maximum number of non-overlapping beautiful segments." "data structures,dp,dsu,greedy,math" 1300
720E Cipher "Borya has recently found a big electronic display. The computer that manages the display stores some integer number. The number has n decimal digits, the display shows the encoded version of the number, where each digit is shown using some lowercase letter of the English alphabet.There is a legend near the display, that describes how the number is encoded. For each digit position i and each digit j the character c is known, that encodes this digit at this position. Different digits can have the same code characters.Each second the number is increased by 1. And one second after a moment when the number reaches the value that is represented as n 9-s in decimal notation, the loud beep sounds. Andrew knows the number that is stored in the computer. Now he wants to know how many seconds must pass until Borya can definitely tell what was the original number encoded by the display. Assume that Borya can precisely measure time, and that the encoded number will first be increased exactly one second after Borya started watching at the display." implementation 3100
794A "Bank Robbery" "A robber has attempted to rob a bank but failed to complete his task. However, he had managed to open all the safes.Oleg the bank client loves money (who doesn\'t), and decides to take advantage of this failed robbery and steal some money from the safes. There are many safes arranged in a line, where the i-th safe from the left is called safe i. There are n banknotes left in all the safes in total. The i-th banknote is in safe xi. Oleg is now at safe a. There are two security guards, one of which guards the safe b such that b\xe2\x80\x89<\xe2\x80\x89a, i.e. the first guard is to the left of Oleg. The other guard guards the safe c so that c\xe2\x80\x89>\xe2\x80\x89a, i.e. he is to the right of Oleg.The two guards are very lazy, so they do not move. In every second, Oleg can either take all the banknotes from the current safe or move to any of the neighboring safes. However, he cannot visit any safe that is guarded by security guards at any time, becaues he might be charged for stealing. Determine the maximum amount of banknotes Oleg can gather." "brute force,implementation" 800
164A "Variable, or There and Back Again" "Life is not easy for the perfectly common variable named Vasya. Wherever it goes, it is either assigned a value, or simply ignored, or is being used!Vasya\'s life goes in states of a program. In each state, Vasya can either be used (for example, to calculate the value of another variable), or be assigned a value, or ignored. Between some states are directed (oriented) transitions.A path is a sequence of states v1,\xe2\x80\x89v2,\xe2\x80\x89...,\xe2\x80\x89vx, where for any 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89x exists a transition from vi to vi\xe2\x80\x89+\xe2\x80\x891.Vasya\'s value in state v is interesting to the world, if exists path p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pk such, that pi\xe2\x80\x89=\xe2\x80\x89v for some i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k), in state p1 Vasya gets assigned a value, in state pk Vasya is used and there is no state pi (except for p1) where Vasya gets assigned a value.Help Vasya, find the states in which Vasya\'s value is interesting to the world." "dfs and similar,graphs" 1700
1879A Rigged! "Monocarp organizes a weightlifting competition. There are n athletes participating in the competition, the i-th athlete has strength si and endurance ei. The 1-st athlete is Monocarp\'s friend Polycarp, and Monocarp really wants Polycarp to win.The competition will be conducted as follows. The jury will choose a positive (greater than zero) integer w, which denotes the weight of the barbell that will be used in the competition. The goal for each athlete is to lift the barbell as many times as possible. The athlete who lifts the barbell the most amount of times will be declared the winner (if there are multiple such athletes \xe2\x80\x94 there\'s no winner).If the barbell\'s weight w is strictly greater than the strength of the i-th athlete si, then the i-th athlete will be unable to lift the barbell even one single time. Otherwise, the i-th athlete will be able to lift the barbell, and the number of times he does it will be equal to his endurance ei.For example, suppose there are 4 athletes with parameters s1=7,e1=4; s2=9,e2=3; s3=4,e3=6; s4=2,e4=2. If the weight of the barbell is 5, then:  the first athlete will be able to lift the barbell 4 times;  the second athlete will be able to lift the barbell 3 times;  the third athlete will be unable to lift the barbell;  the fourth athlete will be unable to lift the barbell. Monocarp wants to choose w in such a way that Polycarp (the 1-st athlete) wins the competition. Help him to choose the value of w, or report that it is impossible." greedy 800
1515I "Phoenix and Diamonds" "Phoenix wonders what it is like to rob diamonds from a jewelry store!There are n types of diamonds. The i-th type has weight wi and value vi. The store initially has ai diamonds of the i-th type.Each day, for q days, one of the following will happen:   A new shipment of ki diamonds of type di arrive.  The store sells ki diamonds of type di.  Phoenix wonders what will happen if he robs the store using a bag that can fit diamonds with total weight not exceeding ci. If he greedily takes diamonds of the largest value that fit, how much value would be taken? If there are multiple diamonds with the largest value, he will take the one with minimum weight. If, of the diamonds with the largest value, there are multiple with the same minimum weight, he will take any of them. Of course, since Phoenix is a law-abiding citizen, this is all a thought experiment and he never actually robs any diamonds from the store. This means that queries of type 3 do not affect the diamonds in the store." "binary search,data structures,sortings" 3400
822C "Hacker, pack your bags!" "It\'s well known that the best way to distract from something is to do one\'s favourite thing. Job is such a thing for Leha.So the hacker began to work hard in order to get rid of boredom. It means that Leha began to hack computers all over the world. For such zeal boss gave the hacker a vacation of exactly x days. You know the majority of people prefer to go somewhere for a vacation, so Leha immediately went to the travel agency. There he found out that n vouchers left. i-th voucher is characterized by three integers li, ri, costi \xe2\x80\x94 day of departure from Vi\xc4\x8dkopolis, day of arriving back in Vi\xc4\x8dkopolis and cost of the voucher correspondingly. The duration of the i-th voucher is a value ri\xe2\x80\x89-\xe2\x80\x89li\xe2\x80\x89+\xe2\x80\x891.At the same time Leha wants to split his own vocation into two parts. Besides he wants to spend as little money as possible. Formally Leha wants to choose exactly two vouchers i and j (i\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89j) so that they don\'t intersect, sum of their durations is exactly x and their total cost is as minimal as possible. Two vouchers i and j don\'t intersect if only at least one of the following conditions is fulfilled: ri\xe2\x80\x89<\xe2\x80\x89lj or rj\xe2\x80\x89<\xe2\x80\x89li.Help Leha to choose the necessary vouchers!" "binary search,greedy,implementation,sortings" 1600
1716A "2-3 Moves" "You are standing at the point 0 on a coordinate line. Your goal is to reach the point n. In one minute, you can move by 2 or by 3 to the left or to the right (i.\xe2\x80\x89e., if your current coordinate is x, it can become x\xe2\x88\x923, x\xe2\x88\x922, x+2 or x+3). Note that the new coordinate can become negative.Your task is to find the minimum number of minutes required to get from the point 0 to the point n.You have to answer t independent test cases." greedy,math 800
659B "Qualifying Contest" "Very soon Berland will hold a School Team Programming Olympiad. From each of the m Berland regions a team of two people is invited to participate in the olympiad. The qualifying contest to form teams was held and it was attended by n Berland students. There were at least two schoolboys participating from each of the m regions of Berland. The result of each of the participants of the qualifying competition is an integer score from 0 to 800 inclusive.The team of each region is formed from two such members of the qualifying competition of the region, that none of them can be replaced by a schoolboy of the same region, not included in the team and who received a greater number of points. There may be a situation where a team of some region can not be formed uniquely, that is, there is more than one school team that meets the properties described above. In this case, the region needs to undertake an additional contest. The two teams in the region are considered to be different if there is at least one schoolboy who is included in one team and is not included in the other team. It is guaranteed that for each region at least two its representatives participated in the qualifying contest.Your task is, given the results of the qualifying competition, to identify the team from each region, or to announce that in this region its formation requires additional contests." "constructive algorithms,sortings" 1300
1913E "Matrix Problem" "You are given a matrix a, consisting of n rows by m columns. Each element of the matrix is equal to 0 or 1.You can perform the following operation any number of times (possibly zero): choose an element of the matrix and replace it with either 0 or 1.You are also given two arrays A and B (of length n and m respectively). After you perform the operations, the matrix should satisfy the following conditions:  the number of ones in the i-th row of the matrix should be exactly Ai for every i\xe2\x88\x88[1,n].  the number of ones in the j-th column of the matrix should be exactly Bj for every j\xe2\x88\x88[1,m]. Calculate the minimum number of operations you have to perform." flows,graphs 2400
264A "Escape from Stones" "Squirrel Liss lived in a forest peacefully, but unexpected trouble happens. Stones fall from a mountain. Initially Squirrel Liss occupies an interval [0,\xe2\x80\x891]. Next, n stones will fall and Liss will escape from the stones. The stones are numbered from 1 to n in order.The stones always fall to the center of Liss\'s interval. When Liss occupies the interval [k\xe2\x80\x89-\xe2\x80\x89d,\xe2\x80\x89k\xe2\x80\x89+\xe2\x80\x89d] and a stone falls to k, she will escape to the left or to the right. If she escapes to the left, her new interval will be [k\xe2\x80\x89-\xe2\x80\x89d,\xe2\x80\x89k]. If she escapes to the right, her new interval will be [k,\xe2\x80\x89k\xe2\x80\x89+\xe2\x80\x89d].You are given a string s of length n. If the i-th character of s is ""l"" or ""r"", when the i-th stone falls Liss will escape to the left or to the right, respectively. Find the sequence of stones\' numbers from left to right after all the n stones falls." "constructive algorithms,data structures,implementation,two pointers" 1200
225E Unsolvable "Consider the following equation:  where sign [a] represents the integer part of number a.Let\'s find all integer z (z\xe2\x80\x89>\xe2\x80\x890), for which this equation is unsolvable in positive integers. The phrase ""unsolvable in positive integers"" means that there are no such positive integers x and y (x,\xe2\x80\x89y\xe2\x80\x89>\xe2\x80\x890), for which the given above equation holds.Let\'s write out all such z in the increasing order: z1,\xe2\x80\x89z2,\xe2\x80\x89z3, and so on (zi\xe2\x80\x89<\xe2\x80\x89zi\xe2\x80\x89+\xe2\x80\x891). Your task is: given the number n, find the number zn." "math,number theory" 2100
1032C "Playing Piano" "Little Paul wants to learn how to play piano. He already has a melody he wants to start with. For simplicity he represented this melody as a sequence a1,a2,\xe2\x80\xa6,an of key numbers: the more a number is, the closer it is to the right end of the piano keyboard.Paul is very clever and knows that the essential thing is to properly assign fingers to notes he\'s going to play. If he chooses an inconvenient fingering, he will then waste a lot of time trying to learn how to play the melody by these fingers and he will probably not succeed.Let\'s denote the fingers of hand by numbers from 1 to 5. We call a fingering any sequence b1,\xe2\x80\xa6,bn of fingers numbers. A fingering is convenient if for all 1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921 the following holds:  if ai<ai+1 then bi<bi+1, because otherwise Paul needs to take his hand off the keyboard to play the (i+1)-st note;  if ai>ai+1 then bi>bi+1, because of the same;  if ai=ai+1 then bi\xe2\x89\xa0bi+1, because using the same finger twice in a row is dumb. Please note that there is \xe2\x89\xa0, not = between bi and bi+1. Please provide any convenient fingering or find out that there is none." "constructive algorithms,dp" 1700
1700D "River Locks" "Recently in Divanovo, a huge river locks system was built. There are now n locks, the i-th of them has the volume of vi liters, so that it can contain any amount of water between 0 and vi liters. Each lock has a pipe attached to it. When the pipe is open, 1 liter of water enters the lock every second.The locks system is built in a way to immediately transfer all water exceeding the volume of the lock i to the lock i+1. If the lock i+1 is also full, water will be transferred further. Water exceeding the volume of the last lock pours out to the river.   The picture illustrates 5 locks with two open pipes at locks 1 and 3. Because locks 1, 3, and 4 are already filled, effectively the water goes to locks 2 and 5. Note that the volume of the i-th lock may be greater than the volume of the i+1-th lock.To make all locks work, you need to completely fill each one of them. The mayor of Divanovo is interested in q independent queries. For each query, suppose that initially all locks are empty and all pipes are closed. Then, some pipes are opened simultaneously. For the j-th query the mayor asks you to calculate the minimum number of pipes to open so that all locks are filled no later than after tj seconds.Please help the mayor to solve this tricky problem and answer his queries." "binary search,dp,greedy,math" 1900
62E "World Evil" "As a result of Pinky and Brain\'s mysterious experiments in the Large Hadron Collider some portals or black holes opened to the parallel dimension. And the World Evil has crept to the veil between their world and ours. Brain quickly evaluated the situation and he understood that the more evil tentacles creep out and become free, the higher is the possibility that Brain will rule the world.The collider\'s constriction is a rectangular grid rolled into a cylinder and consisting of n rows and m columns such as is shown in the picture below:  In this example n\xe2\x80\x89=\xe2\x80\x894, m\xe2\x80\x89=\xe2\x80\x895. Dotted lines are corridores that close each column to a ring, i. e. connect the n-th and the 1-th rows of the grid.In the leftmost column of the grid the portals are situated and the tentacles of the World Evil are ready to creep out from there. In the rightmost column the exit doors are located. The tentacles can only get out through those doors. The segments joining the nodes of the grid are corridors.Brain would be glad to let all the tentacles out but he faces a problem: the infinite number of tentacles can creep out of the portals, every tentacle possesses infinite length and some width and the volume of the corridors are, unfortunately, quite limited. Brain could approximately evaluate the maximal number of tentacles that will be able to crawl through every corridor.Now help the mice to determine the maximal number of tentacles of the World Evil that will crawl out of the Large Hadron Collider." dp,flows 2700
1793B "Fedya and Array" "For his birthday recently Fedya was given an array a of n integers arranged in a circle, For each pair of neighboring numbers (a1 and a2, a2 and a3, \xe2\x80\xa6, an\xe2\x88\x921 and an, an and a1) the absolute difference between them is equal to 1.Let\'s call a local maximum an element, which is greater than both of its neighboring elements. Also call a local minimum an element, which is less than both of its neighboring elements. Note, that elements a1 and an are neighboring elements.Unfortunately, Fedya lost an array, but he remembered in it the sum of local maximums x and the sum of local minimums y.Given x and y, help Fedya find any matching array of minimum length." "constructive algorithms,math" 1100
677B "Vanya and Food Processor" "Vanya smashes potato in a vertical food processor. At each moment of time the height of the potato in the processor doesn\'t exceed h and the processor smashes k centimeters of potato each second. If there are less than k centimeters remaining, than during this second processor smashes all the remaining potato.Vanya has n pieces of potato, the height of the i-th piece is equal to ai. He puts them in the food processor one by one starting from the piece number 1 and finishing with piece number n. Formally, each second the following happens:  If there is at least one piece of potato remaining, Vanya puts them in the processor one by one, until there is not enough space for the next piece.  Processor smashes k centimeters of potato (or just everything that is inside). Provided the information about the parameter of the food processor and the size of each potato in a row, compute how long will it take for all the potato to become smashed." implementation,math 1400
433D "Nanami\'s Digital Board" "Nanami is an expert at playing games. This day, Nanami\'s good friend Hajime invited her to watch a game of baseball. Unwilling as she was, she followed him to the stadium. But Nanami had no interest in the game, so she looked around to see if there was something that might interest her. That\'s when she saw the digital board at one end of the stadium.The digital board is n pixels in height and m pixels in width, every pixel is either light or dark. The pixels are described by its coordinate. The j-th pixel of the i-th line is pixel (i,\xe2\x80\x89j). The board displays messages by switching a combination of pixels to light, and the rest to dark. Nanami notices that the state of the pixels on the board changes from time to time. At certain times, certain pixels on the board may switch from light to dark, or from dark to light.Nanami wonders, what is the area of the biggest light block such that a specific pixel is on its side. A light block is a sub-rectangle of the board, in which all pixels are light. Pixel (i,\xe2\x80\x89j) belongs to a side of sub-rectangle with (x1,\xe2\x80\x89y1) and (x2,\xe2\x80\x89y2) as its upper-left and lower-right vertex if and only if it satisfies the logical condition: ((i\xe2\x80\x89=\xe2\x80\x89x1 or i\xe2\x80\x89=\xe2\x80\x89x2) and (y1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y2)) or ((j\xe2\x80\x89=\xe2\x80\x89y1 or j\xe2\x80\x89=\xe2\x80\x89y2) and (x1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x2)).Nanami has all the history of changing pixels, also she has some questions of the described type, can you answer them?" dsu,implementation 2000
1358F "Tasty Cookie" "Oh, no!The coronavirus has caught you, and now you\'re sitting in a dark cellar, with tied legs (but not hands). You have a delicious cookie, a laptop in front of you, and your ideal development environment is open. The coronavirus convinces you to solve the following problem.You are given two arrays A and B of size n. You can do operations of two types with array A:   Reverse array A. That is the array [A1, A2, \xe2\x80\xa6, An] transformes into [An, An\xe2\x88\x921, \xe2\x80\xa6, A1].  Replace A with an array of its prefix sums. That is, the array [A1, A2, \xe2\x80\xa6, An] goes to [A1, (A1+A2), \xe2\x80\xa6, (A1+A2+\xe2\x80\xa6+An)]. You need to understand if you can get an array B from the array A. If it is possible, you will have to restore the order of these operations by minimizing the number of operations of the second type. Fortunately, the coronavirus is good today, so he has allowed you not to restore actions if the minimum number of second type operations is more than 2\xe2\x8b\x85105. But coronavirus resents you, so if you restore the answer, the total number of operations should not exceed 5\xe2\x8b\x85105.Solve this problem and get the cookie, or the coronavirus will extend the quarantine for five years and make the whole economy collapse!" "binary search,constructive algorithms,greedy,implementation" 2700
85A Domino "We all know the problem about the number of ways one can tile a 2\xe2\x80\x89\xc3\x97\xe2\x80\x89n field by 1\xe2\x80\x89\xc3\x97\xe2\x80\x892 dominoes. You probably remember that it goes down to Fibonacci numbers. We will talk about some other problem below, there you also are going to deal with tiling a rectangular field with dominoes.You are given a 4\xe2\x80\x89\xc3\x97\xe2\x80\x89n rectangular field, that is the field that contains four lines and n columns. You have to find for it any tiling by 1\xe2\x80\x89\xc3\x97\xe2\x80\x892 dominoes such that each of the n\xe2\x80\x89-\xe2\x80\x891 potential vertical cuts along the grid lines intersects at least one domino, splitting it in two. No two dominoes in the sought tiling should overlap, each square of the field should be covered by exactly one domino. It is allowed to rotate the dominoes, that is, you can use 2\xe2\x80\x89\xc3\x97\xe2\x80\x891 as well as 1\xe2\x80\x89\xc3\x97\xe2\x80\x892 dominoes.Write a program that finds an arbitrary sought tiling." "constructive algorithms,implementation" 1300
794B "Cutting Carrot" "Igor the analyst has adopted n little bunnies. As we all know, bunnies love carrots. Thus, Igor has bought a carrot to be shared between his bunnies. Igor wants to treat all the bunnies equally, and thus he wants to cut the carrot into n pieces of equal area. Formally, the carrot can be viewed as an isosceles triangle with base length equal to 1 and height equal to h. Igor wants to make n\xe2\x80\x89-\xe2\x80\x891 cuts parallel to the base to cut the carrot into n pieces. He wants to make sure that all n pieces have the same area. Can you help Igor determine where to cut the carrot so that each piece have equal area?  Illustration to the first example." geometry,math 1200
277B "Set of Points" "Convexity of a set of points on the plane is the size of the largest subset of points that form a convex polygon. Your task is to build a set of n points with the convexity of exactly m. Your set of points should not contain three points that lie on a straight line." "constructive algorithms,geometry" 2300
939D "Love Rescue" "Valya and Tolya are an ideal pair, but they quarrel sometimes. Recently, Valya took offense at her boyfriend because he came to her in t-shirt with lettering that differs from lettering on her pullover. Now she doesn\'t want to see him and Tolya is seating at his room and crying at her photos all day long.This story could be very sad but fairy godmother (Tolya\'s grandmother) decided to help them and restore their relationship. She secretly took Tolya\'s t-shirt and Valya\'s pullover and wants to make the letterings on them same. In order to do this, for one unit of mana she can buy a spell that can change some letters on the clothes. Your task is calculate the minimum amount of mana that Tolya\'s grandmother should spend to rescue love of Tolya and Valya.More formally, letterings on Tolya\'s t-shirt and Valya\'s pullover are two strings with same length n consisting only of lowercase English letters. Using one unit of mana, grandmother can buy a spell of form (c1,\xe2\x80\x89c2) (where c1 and c2 are some lowercase English letters), which can arbitrary number of times transform a single letter c1 to c2 and vise-versa on both Tolya\'s t-shirt and Valya\'s pullover. You should find the minimum amount of mana that grandmother should spend to buy a set of spells that can make the letterings equal. In addition you should output the required set of spells." "dfs and similar,dsu,graphs,greedy,strings" 1600
1426D "Non-zero Segments" "Kolya got an integer array a1,a2,\xe2\x80\xa6,an. The array can contain both positive and negative integers, but Kolya doesn\'t like 0, so the array doesn\'t contain any zeros.Kolya doesn\'t like that the sum of some subsegments of his array can be 0. The subsegment is some consecutive segment of elements of the array. You have to help Kolya and change his array in such a way that it doesn\'t contain any subsegments with the sum 0. To reach this goal, you can insert any integers between any pair of adjacent elements of the array (integers can be really any: positive, negative, 0, any by absolute value, even such a huge that they can\'t be represented in most standard programming languages).Your task is to find the minimum number of integers you have to insert into Kolya\'s array in such a way that the resulting array doesn\'t contain any subsegments with the sum 0." "constructive algorithms,data structures,greedy,sortings" 1500
1494B "Berland Crossword" "Berland crossword is a puzzle that is solved on a square grid with n rows and n columns. Initially all the cells are white.To solve the puzzle one has to color some cells on the border of the grid black in such a way that:   exactly U cells in the top row are black;  exactly R cells in the rightmost column are black;  exactly D cells in the bottom row are black;  exactly L cells in the leftmost column are black. Note that you can color zero cells black and leave every cell white.Your task is to check if there exists a solution to the given puzzle." "bitmasks,brute force,greedy,implementation" 1400
719A "Vitya in the Countryside" "Every summer Vitya comes to visit his grandmother in the countryside. This summer, he got a huge wart. Every grandma knows that one should treat warts when the moon goes down. Thus, Vitya has to catch the moment when the moon is down.Moon cycle lasts 30 days. The size of the visible part of the moon (in Vitya\'s units) for each day is 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 14, 13, 12, 11, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1, and then cycle repeats, thus after the second 1 again goes 0.As there is no internet in the countryside, Vitya has been watching the moon for n consecutive days and for each of these days he wrote down the size of the visible part of the moon. Help him find out whether the moon will be up or down next day, or this cannot be determined by the data he has." implementation 1100
261B "Maxim and Restaurant" "Maxim has opened his own restaurant! The restaurant has got a huge table, the table\'s length is p meters.Maxim has got a dinner party tonight, n guests will come to him. Let\'s index the guests of Maxim\'s restaurant from 1 to n. Maxim knows the sizes of all guests that are going to come to him. The i-th guest\'s size (ai) represents the number of meters the guest is going to take up if he sits at the restaurant table.Long before the dinner, the guests line up in a queue in front of the restaurant in some order. Then Maxim lets the guests in, one by one. Maxim stops letting the guests in when there is no place at the restaurant table for another guest in the queue. There is no place at the restaurant table for another guest in the queue, if the sum of sizes of all guests in the restaurant plus the size of this guest from the queue is larger than p. In this case, not to offend the guest who has no place at the table, Maxim doesn\'t let any other guest in the restaurant, even if one of the following guests in the queue would have fit in at the table.Maxim is now wondering, what is the average number of visitors who have come to the restaurant for all possible n! orders of guests in the queue. Help Maxim, calculate this number." dp,math,probabilities 1900
1621B "Integers Shop" "The integers shop sells n segments. The i-th of them contains all integers from li to ri and costs ci coins.Tomorrow Vasya will go to this shop and will buy some segments there. He will get all integers that appear in at least one of bought segments. The total cost of the purchase is the sum of costs of all segments in it.After shopping, Vasya will get some more integers as a gift. He will get integer x as a gift if and only if all of the following conditions are satisfied:   Vasya hasn\'t bought x.  Vasya has bought integer l that is less than x.  Vasya has bought integer r that is greater than x. Vasya can get integer x as a gift only once so he won\'t have the same integers after receiving a gift.For example, if Vasya buys segment [2,4] for 20 coins and segment [7,8] for 22 coins, he spends 42 coins and receives integers 2,3,4,7,8 from these segments. He also gets integers 5 and 6 as a gift.Due to the technical issues only the first s segments (that is, segments [l1,r1],[l2,r2],\xe2\x80\xa6,[ls,rs]) will be available tomorrow in the shop.Vasya wants to get (to buy or to get as a gift) as many integers as possible. If he can do this in differents ways, he selects the cheapest of them.For each s from 1 to n, find how many coins will Vasya spend if only the first s segments will be available." "data structures,greedy,implementation" 1500
1312B Bogosort "You are given an array a1,a2,\xe2\x80\xa6,an. Array is good if for each pair of indexes i<j the condition j\xe2\x88\x92aj\xe2\x89\xa0i\xe2\x88\x92ai holds. Can you shuffle this array so that it becomes good? To shuffle an array means to reorder its elements arbitrarily (leaving the initial order is also an option).For example, if a=[1,1,3,5], then shuffled arrays [1,3,5,1], [3,5,1,1] and [5,3,1,1] are good, but shuffled arrays [3,1,5,1], [1,1,3,5] and [1,1,5,3] aren\'t.It\'s guaranteed that it\'s always possible to shuffle an array to meet this condition." "constructive algorithms,sortings" 1000
858E "Tests Renumeration" "The All-Berland National Olympiad in Informatics has just ended! Now Vladimir wants to upload the contest from the Olympiad as a gym to a popular Codehorses website.Unfortunately, the archive with Olympiad\'s data is a mess. For example, the files with tests are named arbitrary without any logic.Vladimir wants to rename the files with tests so that their names are distinct integers starting from 1 without any gaps, namely, ""1"", ""2"", ..., ""n\', where n is the total number of tests.Some of the files contain tests from statements (examples), while others contain regular tests. It is possible that there are no examples, and it is possible that all tests are examples. Vladimir wants to rename the files so that the examples are the first several tests, all all the next files contain regular tests only.The only operation Vladimir can perform is the ""move"" command. Vladimir wants to write a script file, each of the lines in which is ""move file_1 file_2"", that means that the file ""file_1"" is to be renamed to ""file_2"". If there is a file ""file_2"" at the moment of this line being run, then this file is to be rewritten. After the line ""move file_1 file_2"" the file ""file_1"" doesn\'t exist, but there is a file ""file_2"" with content equal to the content of ""file_1"" before the ""move"" command.Help Vladimir to write the script file with the minimum possible number of lines so that after this script is run:  all examples are the first several tests having filenames ""1"", ""2"", ..., ""e"", where e is the total number of examples;  all other files contain regular tests with filenames ""e\xe2\x80\x89+\xe2\x80\x891"", ""e\xe2\x80\x89+\xe2\x80\x892"", ..., ""n"", where n is the total number of all tests." greedy,implementation 2200
97C "Winning Strategy" "One university has just found out about a sport programming contest called ACM ICPC v2.0. This contest doesn\'t differ much from the well-known ACM ICPC, for example, the participants are not allowed to take part in the finals more than two times. However, there is one notable difference: the teams in the contest should consist of exactly n participants.Having taken part in several ACM ICPC v2.0 finals and having not won any medals, the students and the university governors realized that it\'s high time they changed something about the preparation process. Specifically, as the first innovation it was decided to change the teams\' formation process. Having spent considerable amount of time on studying the statistics of other universities\' performance, they managed to receive some interesting information: the dependence between the probability of winning a medal and the number of team members that participated in the finals in the past. More formally, we know n\xe2\x80\x89+\xe2\x80\x891 real numbers p0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89p1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89...\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89pn, where pi is the probability of getting a medal on the finals if the team has i participants of previous finals, and other n\xe2\x80\x89-\xe2\x80\x89i participants arrived to the finals for the first time.Despite such useful data, the university governors are unable to determine such team forming tactics that would provide the maximum probability of winning a medal at ACM ICPC v2.0 finals on average (we are supposed to want to provide such result to the far future and we are also supposed to have an endless supply of students). And how about you, can you offer such optimal tactic? At the first stage the university governors want to know the value of maximum average probability.More formally, suppose that the university sends a team to the k-th world finals. The team has ak participants of previous finals (0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ak\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n). Since each person can participate in the finals no more than twice, the following condition must be true: . Your task is to choose sequence  so that the limit \xce\xa8 exists and it\'s value is maximal:As  is an infinite sequence, you should only print the maximum value of the \xce\xa8 limit." "binary search,graphs,math,shortest paths" 2400
1025C "Plasticine zebra" "Is there anything better than going to the zoo after a tiresome week at work? No wonder Grisha feels the same while spending the entire weekend accompanied by pretty striped zebras. Inspired by this adventure and an accidentally found plasticine pack (represented as a sequence of black and white stripes), Grisha now wants to select several consequent (contiguous) pieces of alternating colors to create a zebra. Let\'s call the number of selected pieces the length of the zebra.Before assembling the zebra Grisha can make the following operation 0 or more times. He splits the sequence in some place into two parts, then reverses each of them and sticks them together again. For example, if Grisha has pieces in the order ""bwbbw"" (here \'b\' denotes a black strip, and \'w\' denotes a white strip), then he can split the sequence as bw|bbw (here the vertical bar represents the cut), reverse both parts and obtain ""wbwbb"".Determine the maximum possible length of the zebra that Grisha can produce." "constructive algorithms,implementation" 1600
1779A "Hall of Fame" "Thalia is a Legendary Grandmaster in chess. She has n trophies in a line numbered from 1 to n (from left to right) and a lamp standing next to each of them (the lamps are numbered as the trophies).A lamp can be directed either to the left or to the right, and it illuminates all trophies in that direction (but not the one it is next to). More formally, Thalia has a string s consisting only of characters \'L\' and \'R\' which represents the lamps\' current directions. The lamp i illuminates:  trophies 1,2,\xe2\x80\xa6,i\xe2\x88\x921 if si is \'L\';  trophies i+1,i+2,\xe2\x80\xa6,n if si is \'R\'. She can perform the following operation at most once:  Choose an index i (1\xe2\x89\xa4i<n);  Swap the lamps i and i+1 (without changing their directions). That is, swap si with si+1. Thalia asked you to illuminate all her trophies (make each trophy illuminated by at least one lamp), or to tell her that it is impossible to do so. If it is possible, you can choose to perform an operation or to do nothing. Notice that lamps cannot change direction, it is only allowed to swap adjacent ones." "constructive algorithms,greedy,strings" 800
1811F "Is It Flower?" "Vlad found a flowerbed with graphs in his yard and decided to take one for himself. Later he found out that in addition to the usual graphs, k-flowers also grew on that flowerbed. A graph is called a k-flower if it consists of a simple cycle of length k, through each vertex of which passes its own simple cycle of length k and these cycles do not intersect at the vertices. For example, 3-flower looks like this:  Note that 1-flower and 2-flower do not exist, since at least 3 vertices are needed to form a cycle.Vlad really liked the structure of the k-flowers and now he wants to find out if he was lucky to take one of them from the flowerbed." "dfs and similar,graphs,implementation" 2100
10B "Cinema Cashier" "All cinema halls in Berland are rectangles with K rows of K seats each, and K is an odd number. Rows and seats are numbered from 1 to K. For safety reasons people, who come to the box office to buy tickets, are not allowed to choose seats themselves. Formerly the choice was made by a cashier, but now this is the responsibility of a special seating program. It was found out that the large majority of Berland\'s inhabitants go to the cinema in order to watch a movie, that\'s why they want to sit as close to the hall center as possible. Moreover, a company of M people, who come to watch a movie, want necessarily to occupy M successive seats in one row. Let\'s formulate the algorithm, according to which the program chooses seats and sells tickets. As the request for M seats comes, the program should determine the row number x and the segment [yl,\xe2\x80\x89yr] of the seats numbers in this row, where yr\xe2\x80\x89-\xe2\x80\x89yl\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89=\xe2\x80\x89M. From all such possible variants as a final result the program should choose the one with the minimum function value of total seats remoteness from the center. Say,  \xe2\x80\x94 the row and the seat numbers of the most ""central"" seat. Then the function value of seats remoteness from the hall center is . If the amount of minimum function values is more than one, the program should choose the one that is closer to the screen (i.e. the row number x is lower). If the variants are still multiple, it should choose the one with the minimum yl. If you did not get yet, your task is to simulate the work of this program." dp,implementation 1500
1777F "Comfortably Numb" "You are given an array a consisting of n non-negative integers.The numbness of a subarray al,al+1,\xe2\x80\xa6,ar (for arbitrary l\xe2\x89\xa4r) is defined as max(al,al+1,\xe2\x80\xa6,ar)\xe2\x8a\x95(al\xe2\x8a\x95al+1\xe2\x8a\x95\xe2\x80\xa6\xe2\x8a\x95ar), where \xe2\x8a\x95 denotes the bitwise XOR operation.Find the maximum numbness over all subarrays." "bitmasks,data structures,divide and conquer,strings,trees" 2400
1533F "Binary String Partition" "Let\'s call a string t consisting of characters 0 and/or 1 beautiful, if either the number of occurrences of character 0 in this string does not exceed k, or the number of occurrences of characters 1 in this string does not exceed k (or both). For example, if k=3, the strings 101010, 111, 0, 00000, 1111111000 are beautiful, and the strings 1111110000, 01010101 are not beautiful.You are given a string s. You have to divide it into the minimum possible number of beautiful strings, i.\xe2\x80\x89e., find a sequence of strings t1,t2,\xe2\x80\xa6,tm such that every ti is beautiful, t1+t2+\xe2\x8b\xaf+tm=s (where + is the concatenation operator), and m is minimum possible.For every k from 1 to |s|, find the minimum possible number of strings such that s can be divided into them (i.\xe2\x80\x89e. the minimum possible m in the partition)." "*special problem,binary search,greedy" -999
134B "Pairs of Numbers" "Let\'s assume that we have a pair of numbers (a,\xe2\x80\x89b). We can get a new pair (a\xe2\x80\x89+\xe2\x80\x89b,\xe2\x80\x89b) or (a,\xe2\x80\x89a\xe2\x80\x89+\xe2\x80\x89b) from the given pair in a single step.Let the initial pair of numbers be (1,1). Your task is to find number k, that is, the least number of steps needed to transform (1,1) into the pair where at least one number equals n." "brute force,dfs and similar,math,number theory" 1900
1003F Abbreviation "You are given a text consisting of n space-separated words. There is exactly one space character between any pair of adjacent words. There are no spaces before the first word and no spaces after the last word. The length of text is the number of letters and spaces in it. wi is the i-th word of text. All words consist only of lowercase Latin letters.Let\'s denote a segment of words w[i..j] as a sequence of words wi,wi+1,\xe2\x80\xa6,wj. Two segments of words w[i1..j1] and w[i2..j2] are considered equal if j1\xe2\x88\x92i1=j2\xe2\x88\x92i2, j1\xe2\x89\xa5i1, j2\xe2\x89\xa5i2, and for every t\xe2\x88\x88[0,j1\xe2\x88\x92i1] wi1+t=wi2+t. For example, for the text ""to be or not to be"" the segments w[1..2] and w[5..6] are equal, they correspond to the words ""to be"".An abbreviation is a replacement of some segments of words with their first uppercase letters. In order to perform an abbreviation, you have to choose at least two non-intersecting equal segments of words, and replace each chosen segment with the string consisting of first letters of the words in the segment (written in uppercase). For example, for the text ""a ab a a b ab a a b c"" you can replace segments of words w[2..4] and w[6..8] with an abbreviation ""AAA"" and obtain the text ""a AAA b AAA b c"", or you can replace segments of words w[2..5] and w[6..9] with an abbreviation ""AAAB"" and obtain the text ""a AAAB AAAB c"".What is the minimum length of the text after at most one abbreviation?" dp,hashing,strings 2200
331C3 "The Great Julya Calendar" "Yet another Armageddon is coming! This time the culprit is the Julya tribe calendar. The beavers in this tribe knew math very well. Smart Beaver, an archaeologist, got a sacred plate with a magic integer on it. The translation from Old Beaverish is as follows: ""May the Great Beaver bless you! May your chacres open and may your third eye never turn blind from beholding the Truth! Take the magic number, subtract a digit from it (the digit must occur in the number) and get a new magic number. Repeat this operation until a magic number equals zero. The Earth will stand on Three Beavers for the time, equal to the number of subtractions you perform!""Distinct subtraction sequences can obviously get you different number of operations. But the Smart Beaver is ready to face the worst and is asking you to count the minimum number of operations he needs to reduce the magic number to zero." dp 2500
830B "Cards Sorting" "Vasily has a deck of cards consisting of n cards. There is an integer on each of the cards, this integer is between 1 and 100\xe2\x80\x89000, inclusive. It is possible that some cards have the same integers on them.Vasily decided to sort the cards. To do this, he repeatedly takes the top card from the deck, and if the number on it equals the minimum number written on the cards in the deck, then he places the card away. Otherwise, he puts it under the deck and takes the next card from the top, and so on. The process ends as soon as there are no cards in the deck. You can assume that Vasily always knows the minimum number written on some card in the remaining deck, but doesn\'t know where this card (or these cards) is.You are to determine the total number of times Vasily takes the top card from the deck." "data structures,implementation,sortings" 1600
1907A Rook "As you probably know, chess is a game that is played on a board with 64 squares arranged in an 8\xc3\x978 grid. Columns of this board are labeled with letters from a to h, and rows are labeled with digits from 1 to 8. Each square is described by the row and column it belongs to.  The rook is a piece in the game of chess. During its turn, it may move any non-zero number of squares horizontally or vertically. Your task is to find all possible moves for a rook on an empty chessboard." implementation 800
250C "Movie Critics" "A film festival is coming up in the city N. The festival will last for exactly n days and each day will have a premiere of exactly one film. Each film has a genre \xe2\x80\x94 an integer from 1 to k.On the i-th day the festival will show a movie of genre ai. We know that a movie of each of k genres occurs in the festival programme at least once. In other words, each integer from 1 to k occurs in the sequence a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an at least once.Valentine is a movie critic. He wants to watch some movies of the festival and then describe his impressions on his site.As any creative person, Valentine is very susceptive. After he watched the movie of a certain genre, Valentine forms the mood he preserves until he watches the next movie. If the genre of the next movie is the same, it does not change Valentine\'s mood. If the genres are different, Valentine\'s mood changes according to the new genre and Valentine has a stress.Valentine can\'t watch all n movies, so he decided to exclude from his to-watch list movies of one of the genres. In other words, Valentine is going to choose exactly one of the k genres and will skip all the movies of this genre. He is sure to visit other movies.Valentine wants to choose such genre x (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k), that the total number of after-movie stresses (after all movies of genre x are excluded) were minimum." greedy 1600
963A "Alternating Sum" "You are given two integers a and b. Moreover, you are given a sequence s0,s1,\xe2\x80\xa6,sn. All values in s are integers 1 or \xe2\x88\x921. It\'s known that sequence is k-periodic and k divides n+1. In other words, for each k\xe2\x89\xa4i\xe2\x89\xa4n it\'s satisfied that si=si\xe2\x88\x92k.Find out the non-negative remainder of division of n\xe2\x88\x91i=0sian\xe2\x88\x92ibi by 109+9.Note that the modulo is unusual!" "math,number theory" 1800
1033C "Permutation Game" "After a long day, Alice and Bob decided to play a little game. The game board consists of n cells in a straight line, numbered from 1 to n, where each cell contains a number ai between 1 and n. Furthermore, no two cells contain the same number. A token is placed in one of the cells. They take alternating turns of moving the token around the board, with Alice moving first. The current player can move from cell i to cell j only if the following two conditions are satisfied:   the number in the new cell j must be strictly larger than the number in the old cell i (i.e. aj>ai), and  the distance that the token travels during this turn must be a multiple of the number in the old cell (i.e. |i\xe2\x88\x92j|modai=0). Whoever is unable to make a move, loses. For each possible starting position, determine who wins if they both play optimally. It can be shown that the game is always finite, i.e. there always is a winning strategy for one of the players." "brute force,dp,games" 1600
906C Party "Arseny likes to organize parties and invite people to it. However, not only friends come to his parties, but friends of his friends, friends of friends of his friends and so on. That\'s why some of Arseny\'s guests can be unknown to him. He decided to fix this issue using the following procedure.At each step he selects one of his guests A, who pairwise introduces all of his friends to each other. After this action any two friends of A become friends. This process is run until all pairs of guests are friends.Arseny doesn\'t want to spend much time doing it, so he wants to finish this process using the minimum number of steps. Help Arseny to do it." "bitmasks,brute force,dp,graphs" 2400
843B "Interactive LowerBound" "This is an interactive problem.You are given a sorted in increasing order singly linked list. You should find the minimum integer in the list which is greater than or equal to x.More formally, there is a singly liked list built on an array of n elements. Element with index i contains two integers: valuei is the integer value in this element, and nexti that is the index of the next element of the singly linked list (or -1, if the current element is the last). The list is sorted, i.e. if nexti\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x891, then valuenexti\xe2\x80\x89>\xe2\x80\x89valuei.You are given the number of elements in the list n, the index of the first element start, and the integer x.You can make up to 2000 queries of the following two types:  ? i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) \xe2\x80\x94 ask the values valuei and nexti,  ! ans \xe2\x80\x94 give the answer for the problem: the minimum integer, greater than or equal to x, or ! -1, if there are no such integers. Your program should terminate after this query. Write a program that solves this problem." "brute force,interactive,probabilities" 2000
1450C2 "Errich-Tac-Toe (Hard Version)" "The only difference between the easy and hard versions is that tokens of type O do not appear in the input of the easy version.Errichto gave Monogon the following challenge in order to intimidate him from taking his top contributor spot on Codeforces.In a Tic-Tac-Toe grid, there are n rows and n columns. Each cell of the grid is either empty or contains a token. There are two types of tokens: X and O. If there exist three tokens of the same type consecutive in a row or column, it is a winning configuration. Otherwise, it is a draw configuration.  The patterns in the first row are winning configurations. The patterns in the second row are draw configurations. In an operation, you can change an X to an O, or an O to an X. Let k denote the total number of tokens in the grid. Your task is to make the grid a draw in at most \xe2\x8c\x8ak3\xe2\x8c\x8b (rounding down) operations.You are not required to minimize the number of operations." "constructive algorithms,math" 2300
804D "Expected diameter of a tree" "Pasha is a good student and one of MoJaK\'s best friends. He always have a problem to think about. Today they had a talk about the following problem.We have a forest (acyclic undirected graph) with n vertices and m edges. There are q queries we should answer. In each query two vertices v and u are given. Let V be the set of vertices in the connected component of the graph that contains v, and U be the set of vertices in the connected component of the graph that contains u. Let\'s add an edge between some vertex  and some vertex in  and compute the value d of the resulting component. If the resulting component is a tree, the value d is the diameter of the component, and it is equal to -1 otherwise. What is the expected value of d, if we choose vertices a and b from the sets uniformly at random?Can you help Pasha to solve this problem?The diameter of the component is the maximum distance among some pair of vertices in the component. The distance between two vertices is the minimum number of edges on some path between the two vertices.Note that queries don\'t add edges to the initial forest." "binary search,brute force,dfs and similar,dp,sortings,trees" 2500
1252B "Cleaning Robots" "The new ICPC town has N junctions (numbered from 1 to N) which are connected by N\xe2\x88\x921 roads. It is possible from one junction to go to any other junctions by going through one or more roads. To make sure all the junctions are well-maintained, the government environment agency is planning to deploy their newest advanced cleaning robots. In addition to its cleaning ability, each robot is also equipped with a movement ability such that it can move from one junction to any other junctions connected by roads. However, as you might have guessed, such robots are not cheap. Therefore, the agency is considering the following deployment plan.Let Tk be the set of junctions which should be cleaned by the kth robot (also known as, the robot\'s task), and |Tk|\xe2\x89\xa51 be the number of junctions in Tk. The junctions in Tk form a path, i.e. there exists a sequence of v1,v2,\xe2\x80\xa6,v|Tk| where vi\xe2\x88\x88Tk and vi\xe2\x89\xa0vj for all i\xe2\x89\xa0j such that each adjacent junction in this sequence is connected by a road. The union of T for all robots is equal to the set of all junctions in ICPC town. On the other hand, no two robots share a common junction, i.e. Ti\xe2\x88\xa9Tj=\xe2\x88\x85 if i\xe2\x89\xa0j.To avoid complaints from citizens for an inefficient operation, the deployment plan should be irreducible; in other words, there should be no two robots, i and j, such that Ti\xe2\x88\xaaTj forms a (longer) path. Note that the agency does not care whether the number of robots being used is minimized as long as all the tasks are irreducible.Your task in this problem is to count the number of feasible deployment plan given the town\'s layout. A plan is feasible if and only if it satisfies all the above-mentioned requirements.For example, let N=6 and the roads are {(1,3),(2,3),(3,4),(4,5),(4,6)}. There are 5 feasible deployment plans as shown in the following figure.   The first plan uses 2 robots (labeled as A and B in the figure) to clean {1,2,3} and {4,5,6}.  The second plan uses 3 robots (labeled as A, B, and C in the figure) to clean {1,3,4,6}, {2}, and {5}.  The third plan uses 3 robots to clean {1,3,4,5}, {2}, and {6}.  The fourth plan uses 3 robots to clean {1}, {2,3,4,6}, and {5}.  The fifth plan uses 3 robots to clean {1}, {2,3,4,5}, and {6}.  No other plans are feasible in this case. For example, the plan {{1,3},{2},{4,5,6}} is not feasible as the task {1,3} and {2} can be combined into a longer path {1,3,2}. The plan {{1,2,3,4},{5},{6}} is also not feasible as {1,2,3,4} is not a path." dp,trees 2300
53E "Dead Ends" "Life in Bertown has become hard. The city has too many roads and the government spends too much to maintain them. There are n junctions and m two way roads, at which one can get from each junction to any other one. The mayor wants to close some roads so that the number of roads left totaled to n\xe2\x80\x89-\xe2\x80\x891 roads and it were still possible to get from each junction to any other one. Besides, the mayor is concerned with the number of dead ends which are the junctions from which only one road goes. There shouldn\'t be too many or too few junctions. Having discussed the problem, the mayor and his assistants decided that after the roads are closed, the road map should contain exactly k dead ends. Your task is to count the number of different ways of closing the roads at which the following conditions are met:   There are exactly n\xe2\x80\x89-\xe2\x80\x891 roads left.  It is possible to get from each junction to any other one.  There are exactly k dead ends on the resulting map. Two ways are considered different if there is a road that is closed in the first way, and is open in the second one." bitmasks,dp 2500
1841C "Ranom Numbers" "No, not ""random"" numbers.Ranom digits are denoted by uppercase Latin letters from A to E. Moreover, the value of the letter A is 1, B is 10, C is 100, D is 1000, E is 10000.A Ranom number is a sequence of Ranom digits. The value of the Ranom number is calculated as follows: the values of all digits are summed up, but some digits are taken with negative signs: a digit is taken with negative sign if there is a digit with a strictly greater value to the right of it (not necessarily immediately after it); otherwise, that digit is taken with a positive sign.For example, the value of the Ranom number DAAABDCA is 1000\xe2\x88\x921\xe2\x88\x921\xe2\x88\x921\xe2\x88\x9210+1000+100+1=2088.You are given a Ranom number. You can change no more than one digit in it. Calculate the maximum possible value of the resulting number." "brute force,dp,greedy,math,strings" 1800
632B "Alice, Bob, Two Teams" "Alice and Bob are playing a game. The game involves splitting up game pieces into two teams. There are n pieces, and the i-th piece has a strength pi.The way to split up game pieces is split into several steps:  First, Alice will split the pieces into two different groups A and B. This can be seen as writing the assignment of teams of a piece in an n character string, where each character is A or B.  Bob will then choose an arbitrary prefix or suffix of the string, and flip each character in that suffix (i.e. change A to B and B to A). He can do this step at most once.  Alice will get all the pieces marked A and Bob will get all the pieces marked B. The strength of a player is then the sum of strengths of the pieces in the group.Given Alice\'s initial split into two teams, help Bob determine an optimal strategy. Return the maximum strength he can achieve." "brute force,constructive algorithms" 1400
920C "Swap Adjacent Elements" "You have an array a consisting of n integers. Each integer from 1 to n appears exactly once in this array.For some indices i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x891) it is possible to swap i-th element with (i\xe2\x80\x89+\xe2\x80\x891)-th, for other indices it is not possible. You may perform any number of swapping operations any order. There is no limit on the number of times you swap i-th element with (i\xe2\x80\x89+\xe2\x80\x891)-th (if the position is not forbidden).Can you make this array sorted in ascending order performing some sequence of swapping operations?" "dfs and similar,greedy,math,sortings,two pointers" 1400
173B "Chamber of Secrets" """The Chamber of Secrets has been opened again"" \xe2\x80\x94 this news has spread all around Hogwarts and some of the students have been petrified due to seeing the basilisk. Dumbledore got fired and now Harry is trying to enter the Chamber of Secrets. These aren\'t good news for Lord Voldemort. The problem is, he doesn\'t want anybody to be able to enter the chamber. The Dark Lord is going to be busy sucking life out of Ginny.The Chamber of Secrets is an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m rectangular grid in which some of the cells are columns. A light ray (and a basilisk\'s gaze) passes through the columns without changing its direction. But with some spell we can make a column magic to reflect the light ray (or the gaze) in all four directions when it receives the ray. This is shown in the figure below.   The left light ray passes through a regular column, and the right ray \xe2\x80\x94 through the magic column.  The basilisk is located at the right side of the lower right cell of the grid and is looking to the left (in the direction of the lower left cell). According to the legend, anyone who meets a basilisk\'s gaze directly dies immediately. But if someone meets a basilisk\'s gaze through a column, this person will get petrified. We know that the door to the Chamber is located on the left side of the upper left corner of the grid and anyone who wants to enter will look in the direction of its movement (in the direction of the upper right cell) from that position.   This figure illustrates the first sample test.  Given the dimensions of the chamber and the location of regular columns, Lord Voldemort has asked you to find the minimum number of columns that we need to make magic so that anyone who wants to enter the chamber would be petrified or just declare that it\'s impossible to secure the chamber." "dfs and similar,shortest paths" 1800
1085G "Beautiful Matrix" "Petya collects beautiful matrix.A matrix of size n\xc3\x97n is beautiful if:   All elements of the matrix are integers between 1 and n;  For every row of the matrix, all elements of this row are different;  For every pair of vertically adjacent elements, these elements are different. Today Petya bought a beautiful matrix a of size n\xc3\x97n, and now he wants to determine its rarity.The rarity of the matrix is its index in the list of beautiful matrices of size n\xc3\x97n, sorted in lexicographical order. Matrix comparison is done row by row. (The index of lexicographically smallest matrix is zero).Since the number of beautiful matrices may be huge, Petya wants you to calculate the rarity of the matrix a modulo 998244353." "combinatorics,data structures,dp" 2900
1534D "Lost Tree" "This is an interactive problem.Little Dormi was faced with an awkward problem at the carnival: he has to guess the edges of an unweighted tree of n nodes! The nodes of the tree are numbered from 1 to n.The game master only allows him to ask one type of question: Little Dormi picks a node r (1\xe2\x89\xa4r\xe2\x89\xa4n), and the game master will reply with an array d1,d2,\xe2\x80\xa6,dn, where di is the length of the shortest path from node r to i, for all 1\xe2\x89\xa4i\xe2\x89\xa4n.Additionally, to make the game unfair challenge Little Dormi the game master will allow at most \xe2\x8c\x88n2\xe2\x8c\x89 questions, where \xe2\x8c\x88x\xe2\x8c\x89 denotes the smallest integer greater than or equal to x.Faced with the stomach-churning possibility of not being able to guess the tree, Little Dormi needs your help to devise a winning strategy!Note that the game master creates the tree before the game starts, and does not change it during the game." "constructive algorithms,interactive,trees" 1800
437C "The Child and Toy" "On Children\'s Day, the child got a toy from Delayyy as a present. However, the child is so naughty that he can\'t wait to destroy the toy.The toy consists of n parts and m ropes. Each rope links two parts, but every pair of parts is linked by at most one rope. To split the toy, the child must remove all its parts. The child can remove a single part at a time, and each remove consume an energy. Let\'s define an energy value of part i as vi. The child spend vf1\xe2\x80\x89+\xe2\x80\x89vf2\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89vfk energy for removing part i where f1,\xe2\x80\x89f2,\xe2\x80\x89...,\xe2\x80\x89fk are the parts that are directly connected to the i-th and haven\'t been removed.Help the child to find out, what is the minimum total energy he should spend to remove all n parts." graphs,greedy,sortings 1400
232C "Doe Graphs" "John Doe decided that some mathematical object must be named after him. So he invented the Doe graphs. The Doe graphs are a family of undirected graphs, each of them is characterized by a single non-negative number \xe2\x80\x94 its order. We\'ll denote a graph of order k as D(k), and we\'ll denote the number of vertices in the graph D(k) as |D(k)|. Then let\'s define the Doe graphs as follows:  D(0) consists of a single vertex, that has number 1.  D(1) consists of two vertices with numbers 1 and 2, connected by an edge.  D(n) for n\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x892 is obtained from graphs D(n\xe2\x80\x89-\xe2\x80\x891) and D(n\xe2\x80\x89-\xe2\x80\x892). D(n\xe2\x80\x89-\xe2\x80\x891) and D(n\xe2\x80\x89-\xe2\x80\x892) are joined in one graph, at that numbers of all vertices of graph D(n\xe2\x80\x89-\xe2\x80\x892) increase by |D(n\xe2\x80\x89-\xe2\x80\x891)| (for example, vertex number 1 of graph D(n\xe2\x80\x89-\xe2\x80\x892) becomes vertex number 1\xe2\x80\x89+\xe2\x80\x89|D(n\xe2\x80\x89-\xe2\x80\x891)|). After that two edges are added to the graph: the first one goes between vertices with numbers |D(n\xe2\x80\x89-\xe2\x80\x891)| and |D(n\xe2\x80\x89-\xe2\x80\x891)|\xe2\x80\x89+\xe2\x80\x891, the second one goes between vertices with numbers |D(n\xe2\x80\x89-\xe2\x80\x891)|\xe2\x80\x89+\xe2\x80\x891 and 1. Note that the definition of graph D(n) implies, that D(n) is a connected graph, its vertices are numbered from 1 to |D(n)|.   The picture shows the Doe graphs of order 1, 2, 3 and 4, from left to right. John thinks that Doe graphs are that great because for them exists a polynomial algorithm for the search of Hamiltonian path. However, your task is to answer queries of finding the shortest-length path between the vertices ai and bi in the graph D(n).A path between a pair of vertices u and v in the graph is a sequence of vertices x1, x2, ..., xk (k\xe2\x80\x89>\xe2\x80\x891) such, that x1\xe2\x80\x89=\xe2\x80\x89u, xk\xe2\x80\x89=\xe2\x80\x89v, and for any i (i\xe2\x80\x89<\xe2\x80\x89k) vertices xi and xi\xe2\x80\x89+\xe2\x80\x891 are connected by a graph edge. The length of path x1, x2, ..., xk is number (k\xe2\x80\x89-\xe2\x80\x891)." "constructive algorithms,divide and conquer,dp,graphs,shortest paths" 2600
1928F "Digital Patterns" "Anya is engaged in needlework. Today she decided to knit a scarf from semi-transparent threads. Each thread is characterized by a single integer \xe2\x80\x94 the transparency coefficient.The scarf is made according to the following scheme: horizontal threads with transparency coefficients a1,a2,\xe2\x80\xa6,an and vertical threads with transparency coefficients b1,b2,\xe2\x80\xa6,bm are selected. Then they are interwoven as shown in the picture below, forming a piece of fabric of size n\xc3\x97m, consisting of exactly nm nodes:  Example of a piece of fabric for n=m=4. After the interweaving tightens and there are no gaps between the threads, each node formed by a horizontal thread with number i and a vertical thread with number j will turn into a cell, which we will denote as (i,j). Cell (i,j) will have a transparency coefficient of ai+bj.The interestingness of the resulting scarf will be the number of its sub-squares\xe2\x80\xa0 in which there are no pairs of neighboring\xe2\x80\xa0\xe2\x80\xa0 cells with the same transparency coefficients.Anya has not yet decided which threads to use for the scarf, so you will also be given q queries to increase/decrease the coefficients for the threads on some ranges. After each query of which you need to output the interestingness of the resulting scarf.\xe2\x80\xa0A sub-square of a piece of fabric is defined as the set of all its cells (i,j), such that x0\xe2\x89\xa4i\xe2\x89\xa4x0+d and y0\xe2\x89\xa4j\xe2\x89\xa4y0+d for some integers x0, y0, and d (1\xe2\x89\xa4x0\xe2\x89\xa4n\xe2\x88\x92d, 1\xe2\x89\xa4y0\xe2\x89\xa4m\xe2\x88\x92d, d\xe2\x89\xa50).\xe2\x80\xa0\xe2\x80\xa0. Cells (i1,j1) and (i2,j2) are neighboring if and only if |i1\xe2\x88\x92i2|+|j1\xe2\x88\x92j2|=1." "combinatorics,data structures,implementation,math" 2900
1765F "Chemistry Lab" "Monocarp is planning on opening a chemistry lab. During the first month, he\'s going to distribute solutions of a certain acid.First, he will sign some contracts with a local chemistry factory. Each contract provides Monocarp with an unlimited supply of some solution of the same acid. The factory provides n contract options, numbered from 1 to n. The i-th solution has a concentration of xi%, the contract costs wi burles, and Monocarp will be able to sell it for ci burles per liter. Monocarp is expecting k customers during the first month. Each customer will buy a liter of a y%-solution, where y is a real number chosen uniformly at random from 0 to 100 independently for each customer. More formally, the probability of number y being less than or equal to some t is P(y\xe2\x89\xa4t)=t100.Monocarp can mix the solution that he signed the contracts with the factory for, at any ratio. More formally, if he has contracts for m solutions with concentrations x1,x2,\xe2\x80\xa6,xm, then, for these solutions, he picks their volumes a1,a2,\xe2\x80\xa6,am so that m\xe2\x88\x91i=1ai=1 (exactly 1 since each customer wants exactly one liter of a certain solution).The concentration of the resulting solution is m\xe2\x88\x91i=1xi\xe2\x8b\x85ai. The price of the resulting solution is m\xe2\x88\x91i=1ci\xe2\x8b\x85ai.If Monocarp can obtain a solution of concentration y%, then he will do it while maximizing its price (the cost for the customer). Otherwise, the customer leaves without buying anything, and the price is considered equal to 0.Monocarp wants to sign some contracts with a factory (possibly, none or all of them) so that the expected profit is maximized \xe2\x80\x94 the expected total price of the sold solutions for all k customers minus the total cost of signing the contracts from the factory.Print the maximum expected profit Monocarp can achieve." dp,geometry,probabilities 2200
449E "Jzzhu and Squares" "Jzzhu has two integers, n and m. He calls an integer point (x,\xe2\x80\x89y) of a plane special if 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n and 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m. Jzzhu defines a unit square as a square with corners at points (x,\xe2\x80\x89y), (x\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89y), (x\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89y\xe2\x80\x89+\xe2\x80\x891), (x,\xe2\x80\x89y\xe2\x80\x89+\xe2\x80\x891), where x and y are some integers.Let\'s look at all the squares (their sides not necessarily parallel to the coordinate axes) with corners at the special points. For each such square Jzzhu paints a dot in every unit square that is fully inside it. After that some unit squares can contain several dots. Now Jzzhu wonders, how many dots he has painted on the plane. Find this number modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." "dp,math,number theory" 2900
925E "May Holidays" "It\'s May in Flatland, and there are m days in this month. Despite the fact that May Holidays are canceled long time ago, employees of some software company still have a habit of taking short or long vacations in May.Of course, not all managers of the company like this. There are n employees in the company that form a tree-like structure of subordination: each employee has a unique integer id i between 1 and n, and each employee with id i (except the head manager whose id is 1) has exactly one direct manager with id pi. The structure of subordination is not cyclic, i.e. if we start moving from any employee to his direct manager, then we will eventually reach the head manager. We define that an employee u is a subordinate of an employee v, if v is a direct manager of u, or the direct manager of u is a subordinate of v. Let si be the number of subordinates the i-th employee has (for example, s1=n\xe2\x88\x921, because all employees except himself are subordinates of the head manager).Each employee i has a bearing limit of ti, which is an integer between 0 and si. It denotes the maximum number of the subordinates of the i-th employee being on vacation at the same moment that he can bear. If at some moment strictly more than ti subordinates of the i-th employee are on vacation, and the i-th employee himself is not on a vacation, he becomes displeased.In each of the m days of May exactly one event of the following two types happens: either one employee leaves on a vacation at the beginning of the day, or one employee returns from a vacation in the beginning of the day. You know the sequence of events in the following m days. Your task is to compute for each of the m days the number of displeased employees on that day." "data structures,trees" 2900
177B2 "Rectangular Game" "The Smart Beaver from ABBYY decided to have a day off. But doing nothing the whole day turned out to be too boring, and he decided to play a game with pebbles. Initially, the Beaver has n pebbles. He arranges them in a equal rows, each row has b pebbles (a\xe2\x80\x89>\xe2\x80\x891). Note that the Beaver must use all the pebbles he has, i. e. n\xe2\x80\x89=\xe2\x80\x89a\xc2\xb7b.   10 pebbles are arranged in two rows, each row has 5 pebbles  Once the Smart Beaver has arranged the pebbles, he takes back any of the resulting rows (that is, b pebbles) and discards all other pebbles. Then he arranges all his pebbles again (possibly choosing other values of a and b) and takes back one row, and so on. The game continues until at some point the Beaver ends up with exactly one pebble. The game process can be represented as a finite sequence of integers c1,\xe2\x80\x89...,\xe2\x80\x89ck, where:   c1\xe2\x80\x89=\xe2\x80\x89n  ci\xe2\x80\x89+\xe2\x80\x891 is the number of pebbles that the Beaver ends up with after the i-th move, that is, the number of pebbles in a row after some arrangement of ci pebbles (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89k). Note that ci\xe2\x80\x89>\xe2\x80\x89ci\xe2\x80\x89+\xe2\x80\x891.  ck\xe2\x80\x89=\xe2\x80\x891 The result of the game is the sum of numbers ci. You are given n. Find the maximum possible result of the game." "number theory" 1200
1943A "MEX Game 1" "Alice and Bob play yet another game on an array a of size n. Alice starts with an empty array c. Both players take turns playing, with Alice starting first.On Alice\'s turn, she picks one element from a, appends that element to c, and then deletes it from a.On Bob\'s turn, he picks one element from a, and then deletes it from a. The game ends when the array a is empty. Game\'s score is defined to be the MEX\xe2\x80\xa0 of c. Alice wants to maximize the score while Bob wants to minimize it. Find game\'s final score if both players play optimally.\xe2\x80\xa0 The MEX (minimum excludant) of an array of integers is defined as the smallest non-negative integer which does not occur in the array. For example:   The MEX of [2,2,1] is 0, because 0 does not belong to the array.  The MEX of [3,1,0,1] is 2, because 0 and 1 belong to the array, but 2 does not.  The MEX of [0,3,1,2] is 4, because 0, 1, 2 and 3 belong to the array, but 4 does not." games,greedy 1300
1873E "Building an Aquarium" "You love fish, that\'s why you have decided to build an aquarium. You have a piece of coral made of nn columns, the ii-th of which is aiai units tall. Afterwards, you will build a tank around the coral as follows:   Pick an integer h\xe2\x89\xa51h\xe2\x89\xa51 \xe2\x80\x94 the height of the tank. Build walls of height hh on either side of the tank.  Then, fill the tank up with water so that the height of each column is hh, unless the coral is taller than hh; then no water should be added to this column.  For example, with a=[3,1,2,4,6,2,5]a=[3,1,2,4,6,2,5] and a height of h=4h=4, you will end up using a total of w=8w=8 units of water, as shown.    You can use at most xx units of water to fill up the tank, but you want to build the biggest tank possible. What is the largest value of hh you can select?" "binary search,sortings" 1100
1251D "Salary Changing" "You are the head of a large enterprise. n people work at you, and n is odd (i.\xe2\x80\x89e. n is not divisible by 2).You have to distribute salaries to your employees. Initially, you have s dollars for it, and the i-th employee should get a salary from li to ri dollars. You have to distribute salaries in such a way that the median salary is maximum possible.To find the median of a sequence of odd length, you have to sort it and take the element in the middle position after sorting. For example:  the median of the sequence [5,1,10,17,6] is 6,  the median of the sequence [1,2,1] is 1. It is guaranteed that you have enough money to pay the minimum salary, i.e l1+l2+\xe2\x8b\xaf+ln\xe2\x89\xa4s.Note that you don\'t have to spend all your s dollars on salaries.You have to answer t test cases." "binary search,greedy,sortings" 1900
482D "Random Function and Tree" "You have a rooted tree consisting of n vertices. Let\'s number them with integers from 1 to n inclusive. The root of the tree is the vertex 1. For each i\xe2\x80\x89>\xe2\x80\x891 direct parent of the vertex i is pi. We say that vertex i is child for its direct parent pi.You have initially painted all the vertices with red color. You like to repaint some vertices of the tree. To perform painting you use the function paint that you call with the root of the tree as an argument. Here is the pseudocode of this function:count = 0 // global integer variable rnd() { // this function is used in paint code    return 0 or 1 equiprobably}paint(s) {    if (count is even) then paint s with white color    else paint s with black color    count = count + 1        if rnd() = 1 then children = [array of vertex s children in ascending order of their numbers]    else children = [array of vertex s children in descending order of their numbers]    for child in children { // iterating over children array        if rnd() = 1 then paint(child) // calling paint recursively    }}As a result of this function, some vertices may change their colors to white or black and some of them may remain red.Your task is to determine the number of distinct possible colorings of the vertices of the tree. We will assume that the coloring is possible if there is a nonzero probability to get this coloring with a single call of paint(1). We assume that the colorings are different if there is a pair of vertices that are painted with different colors in these colorings. Since the required number may be very large, find its remainder of division by 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." combinatorics,dp,trees 2700
1791G1 "Teleporters (Easy Version)" "The only difference between the easy and hard versions are the locations you can teleport to.Consider the points 0,1,\xe2\x80\xa6,n on the number line. There is a teleporter located on each of the points 1,2,\xe2\x80\xa6,n. At point i, you can do the following:  Move left one unit: it costs 1 coin.  Move right one unit: it costs 1 coin.  Use a teleporter at point i, if it exists: it costs ai coins. As a result, you teleport to point 0. Once you use a teleporter, you can\'t use it again. You have c coins, and you start at point 0. What\'s the most number of teleporters you can use?" greedy,sortings 1100
323C "Two permutations" "You are given two permutations p and q, consisting of n elements, and m queries of the form: l1,\xe2\x80\x89r1,\xe2\x80\x89l2,\xe2\x80\x89r2 (l1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r1; l2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r2). The response for the query is the number of such integers from 1 to n, that their position in the first permutation is in segment [l1,\xe2\x80\x89r1] (borders included), and position in the second permutation is in segment [l2,\xe2\x80\x89r2] (borders included too).A permutation of n elements is the sequence of n distinct integers, each not less than 1 and not greater than n.Position of number v (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89v\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) in permutation g1,\xe2\x80\x89g2,\xe2\x80\x89...,\xe2\x80\x89gn is such number i, that gi\xe2\x80\x89=\xe2\x80\x89v." "data structures" 2400
1345B "Card Constructions" "A card pyramid of height 1 is constructed by resting two cards against each other. For h>1, a card pyramid of height h is constructed by placing a card pyramid of height h\xe2\x88\x921 onto a base. A base consists of h pyramids of height 1, and h\xe2\x88\x921 cards on top. For example, card pyramids of heights 1, 2, and 3 look as follows:  You start with n cards and build the tallest pyramid that you can. If there are some cards remaining, you build the tallest pyramid possible with the remaining cards. You repeat this process until it is impossible to build another pyramid. In the end, how many pyramids will you have constructed?" "binary search,brute force,dp,math" 1100
533F Encoding "Polycarp invented a new way to encode strings. Let\'s assume that we have string T, consisting of lowercase English letters. Let\'s choose several pairs of letters of the English alphabet in such a way that each letter occurs in at most one pair. Then let\'s replace each letter in T with its pair letter if there is a pair letter for it. For example, if you chose pairs (l, r), (p, q) and (a, o), then word ""parallelogram"" according to the given encoding principle transforms to word ""qolorreraglom"".Polycarpus already has two strings, S and T. He suspects that string T was obtained after applying the given encoding method from some substring of string S. Find all positions mi in S (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89mi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|S|\xe2\x80\x89-\xe2\x80\x89|T|\xe2\x80\x89+\xe2\x80\x891), such that T can be obtained fro substring SmiSmi\xe2\x80\x89+\xe2\x80\x891... Smi\xe2\x80\x89+\xe2\x80\x89|T|\xe2\x80\x89-\xe2\x80\x891 by applying the described encoding operation by using some set of pairs of English alphabet letters" "hashing,string suffix structures,strings" 2400
1118B "Tanya and Candies" "Tanya has n candies numbered from 1 to n. The i-th candy has the weight ai.She plans to eat exactly n\xe2\x88\x921 candies and give the remaining candy to her dad. Tanya eats candies in order of increasing their numbers, exactly one candy per day.Your task is to find the number of such candies i (let\'s call these candies good) that if dad gets the i-th candy then the sum of weights of candies Tanya eats in even days will be equal to the sum of weights of candies Tanya eats in odd days. Note that at first, she will give the candy, after it she will eat the remaining candies one by one.For example, n=4 and weights are [1,4,3,3]. Consider all possible cases to give a candy to dad:  Tanya gives the 1-st candy to dad (a1=1), the remaining candies are [4,3,3]. She will eat a2=4 in the first day, a3=3 in the second day, a4=3 in the third day. So in odd days she will eat 4+3=7 and in even days she will eat 3. Since 7\xe2\x89\xa03 this case shouldn\'t be counted to the answer (this candy isn\'t good).  Tanya gives the 2-nd candy to dad (a2=4), the remaining candies are [1,3,3]. She will eat a1=1 in the first day, a3=3 in the second day, a4=3 in the third day. So in odd days she will eat 1+3=4 and in even days she will eat 3. Since 4\xe2\x89\xa03 this case shouldn\'t be counted to the answer (this candy isn\'t good).  Tanya gives the 3-rd candy to dad (a3=3), the remaining candies are [1,4,3]. She will eat a1=1 in the first day, a2=4 in the second day, a4=3 in the third day. So in odd days she will eat 1+3=4 and in even days she will eat 4. Since 4=4 this case should be counted to the answer (this candy is good).  Tanya gives the 4-th candy to dad (a4=3), the remaining candies are [1,4,3]. She will eat a1=1 in the first day, a2=4 in the second day, a3=3 in the third day. So in odd days she will eat 1+3=4 and in even days she will eat 4. Since 4=4 this case should be counted to the answer (this candy is good). In total there 2 cases which should counted (these candies are good), so the answer is 2." implementation 1200
468E Permanent "Little X has solved the #P-complete problem in polynomial time recently. So he gives this task to you. There is a special n\xe2\x80\x89\xc3\x97\xe2\x80\x89n matrix A, you should calculate its permanent modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897). The special property of matrix A is almost all its elements equal to 1. Only k elements have specified value.You can find the definition of permanent at the link: https://en.wikipedia.org/wiki/Permanent" "dp,graph matchings,math,meet-in-the-middle" 3100
1210F2 "Marek and Matching (hard version)" "This is a harder version of the problem. In this version, n\xe2\x89\xa47n\xe2\x89\xa47.Marek is working hard on creating strong test cases to his new algorithmic problem. Do you want to know what it is? Nah, we\'re not telling you. However, we can tell you how he generates test cases.Marek chooses an integer nn and n2n2 integers pijpij (1\xe2\x89\xa4i\xe2\x89\xa4n1\xe2\x89\xa4i\xe2\x89\xa4n, 1\xe2\x89\xa4j\xe2\x89\xa4n1\xe2\x89\xa4j\xe2\x89\xa4n). He then generates a random bipartite graph with 2n2n vertices. There are nn vertices on the left side: \xe2\x84\x931,\xe2\x84\x932,\xe2\x80\xa6,\xe2\x84\x93n\xe2\x84\x931,\xe2\x84\x932,\xe2\x80\xa6,\xe2\x84\x93n, and nn vertices on the right side: r1,r2,\xe2\x80\xa6,rnr1,r2,\xe2\x80\xa6,rn. For each ii and jj, he puts an edge between vertices \xe2\x84\x93i\xe2\x84\x93i and rjrj with probability pijpij percent.It turns out that the tests will be strong only if a perfect matching exists in the generated graph. What is the probability that this will occur?It can be shown that this value can be represented as PQPQ where PP and QQ are coprime integers and Q\xe2\x89\xa1\xcc\xb80(mod109+7)Q\xe2\x89\xa20(mod109+7). Let Q\xe2\x88\x921Q\xe2\x88\x921 be an integer for which Q\xe2\x8b\x85Q\xe2\x88\x921\xe2\x89\xa11(mod109+7)Q\xe2\x8b\x85Q\xe2\x88\x921\xe2\x89\xa11(mod109+7). Print the value of P\xe2\x8b\x85Q\xe2\x88\x921P\xe2\x8b\x85Q\xe2\x88\x921 modulo 109+7109+7." "brute force,probabilities" 3200
214B Hometask "Furik loves math lessons very much, so he doesn\'t attend them, unlike Rubik. But now Furik wants to get a good mark for math. For that Ms. Ivanova, his math teacher, gave him a new task. Furik solved the task immediately. Can you?You are given a set of digits, your task is to find the maximum integer that you can make from these digits. The made number must be divisible by 2, 3, 5 without a residue. It is permitted to use not all digits from the set, it is forbidden to use leading zeroes.Each digit is allowed to occur in the number the same number of times it occurs in the set." "brute force,constructive algorithms,greedy,math" 1600
1742C Stripes "On an 8\xc3\x978 grid, some horizontal rows have been painted red, and some vertical columns have been painted blue, in some order. The stripes are drawn sequentially, one after the other. When the stripe is drawn, it repaints all the cells through which it passes.Determine which color was used last.  The red stripe was painted after the blue one, so the answer is R." implementation 900
1675B "Make It Increasing" "Given n integers a1,a2,\xe2\x80\xa6,an. You can perform the following operation on them:  select any element ai (1\xe2\x89\xa4i\xe2\x89\xa4n) and divide it by 2 (round down). In other words, you can replace any selected element ai with the value \xe2\x8c\x8aai2\xe2\x8c\x8b (where \xe2\x8c\x8ax\xe2\x8c\x8b is \xe2\x80\x93 round down the real number x). Output the minimum number of operations that must be done for a sequence of integers to become strictly increasing (that is, for the condition a1<a2<\xe2\x8b\xaf<an to be satisfied). Or determine that it is impossible to obtain such a sequence. Note that elements cannot be swapped. The only possible operation is described above.For example, let n=3 and a sequence of numbers [3,6,5] be given. Then it is enough to perform two operations on it:   Write the number \xe2\x8c\x8a62\xe2\x8c\x8b=3 instead of the number a2=6 and get the sequence [3,3,5];  Then replace a1=3 with \xe2\x8c\x8a32\xe2\x8c\x8b=1 and get the sequence [1,3,5]. The resulting sequence is strictly increasing because 1<3<5." greedy,implementation 900
1867D "Cyclic Operations" "Egor has an array a of length n, initially consisting of zeros. However, he wanted to turn it into another array b of length n.Since Egor doesn\'t take easy paths, only the following operation can be used (possibly zero or several times):  choose an array l of length k (1\xe2\x89\xa4li\xe2\x89\xa4n, all li are distinct) and change each element ali to l(i%k)+1 (1\xe2\x89\xa4i\xe2\x89\xa4k). He became interested in whether it is possible to get the array b using only these operations. Since Egor is still a beginner programmer, he asked you to help him solve this problem.The operation % means taking the remainder, that is, a%b is equal to the remainder of dividing the number a by the number b." "brute force,constructive algorithms,dfs and similar,graphs,greedy,implementation" 1800
409G "On a plane" "InputThe first line contains a single integer n (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x891000) \xe2\x80\x94 the number of points on a plane.Each of the next n lines contains two real coordinates xi and yi of the  point, specified with exactly 2 fractional digits. All coordinates are between \xe2\x80\x89-\xe2\x80\x891000 and 1000, inclusive.OutputOutput a single real number \xce\xb8 \xe2\x80\x94 the answer to the problem statement. The absolute or relative error of your answer should be at most 10\xe2\x80\x89-\xe2\x80\x892.ExamplesInputCopy8-2.14 2.06-1.14 2.04-2.16 1.46-2.14 0.70-1.42 0.40-0.94 -0.48-1.42 -1.28-2.16 -1.62OutputCopy5.410InputCopy52.26 1.442.28 0.642.30 -0.301.58 0.663.24 0.66OutputCopy5.620InputCopy86.98 2.066.40 1.125.98 0.245.54 -0.607.16 0.307.82 1.248.34 0.248.74 -0.76OutputCopy5.480InputCopy510.44 2.0610.90 0.8011.48 -0.4812.06 0.7612.54 2.06OutputCopy6.040InputCopy816.94 2.4215.72 2.3814.82 1.5814.88 0.5015.76 -0.1616.86 -0.2017.00 0.8816.40 0.92OutputCopy6.040InputCopy720.62 3.0021.06 2.2821.56 1.3621.66 0.5621.64 -0.5222.14 2.3222.62 3.04OutputCopy6.720" "*special problem,geometry" 2200
497E "Subsequences Return" "Assume that sk(n) equals the sum of digits of number n in the k-based notation. For example, s2(5)\xe2\x80\x89=\xe2\x80\x89s2(1012)\xe2\x80\x89=\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x890\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89=\xe2\x80\x892, s3(14)\xe2\x80\x89=\xe2\x80\x89s3(1123)\xe2\x80\x89=\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x892\xe2\x80\x89=\xe2\x80\x894.The sequence of integers a0,\xe2\x80\x89...,\xe2\x80\x89an\xe2\x80\x89-\xe2\x80\x891 is defined as . Your task is to calculate the number of distinct subsequences of sequence a0,\xe2\x80\x89...,\xe2\x80\x89an\xe2\x80\x89-\xe2\x80\x891. Calculate the answer modulo 109\xe2\x80\x89+\xe2\x80\x897.Sequence a1,\xe2\x80\x89...,\xe2\x80\x89ak is called to be a subsequence of sequence b1,\xe2\x80\x89...,\xe2\x80\x89bl, if there is a sequence of indices 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i1\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89ik\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l, such that a1\xe2\x80\x89=\xe2\x80\x89bi1, ..., ak\xe2\x80\x89=\xe2\x80\x89bik. In particular, an empty sequence (i.e. the sequence consisting of zero elements) is a subsequence of any sequence." dp,matrices 2900
1912K "Kim\'s Quest" "In the long-forgotten halls of Kombinatoria\'s ancient academy, a gifted mathematician named Kim is faced with an unusual challenge. They found an old sequence of integers, which is believed to be a cryptic message from the legendary Kombinatoria\'s Oracle, and Kim wants to decipher its hidden meaning.Kim\'s mission is to find specific patterns within the sequence, known as Harmonious Subsequences. These are extraordinary subsequences where the sum of every three consecutive numbers is even, and each subsequence must be at least three numbers in length. Given a sequence ai (1\xe2\x89\xa4i\xe2\x89\xa4n) of length n, its subsequence of length m is equal to ab1,ab2,\xe2\x80\xa6,abm and is uniquely defined by a set of m indices bj, such that 1\xe2\x89\xa4b1<b2<\xe2\x80\xa6<bm\xe2\x89\xa4n. Subsequences given by different sets of indices bj are considered different.There\'s a twist in Kim\'s quest: the number of these Harmonious Subsequences could be overwhelming. To report the findings effectively, Kim must calculate the total number of these subsequences, presenting the answer as a remainder after dividing by the number 998244353." bitmasks,combinatorics,dp 1800
1064A "Make a triangle!" "Masha has three sticks of length a, b and c centimeters respectively. In one minute Masha can pick one arbitrary stick and increase its length by one centimeter. She is not allowed to break sticks.What is the minimum number of minutes she needs to spend increasing the stick\'s length in order to be able to assemble a triangle of positive area. Sticks should be used as triangle\'s sides (one stick for one side) and their endpoints should be located at triangle\'s vertices." "brute force,geometry,math" 800
1494A "ABC String" "You are given a string a, consisting of n characters, n is even. For each i from 1 to n ai is one of \'A\', \'B\' or \'C\'.A bracket sequence is a string containing only characters ""("" and "")"". A regular bracket sequence is a bracket sequence that can be transformed into a correct arithmetic expression by inserting characters ""1"" and ""+"" between the original characters of the sequence. For example, bracket sequences ""()()"" and ""(())"" are regular (the resulting expressions are: ""(1)+(1)"" and ""((1+1)+1)""), and "")("", ""("" and "")"" are not.You want to find a string b that consists of n characters such that:   b is a regular bracket sequence;  if for some i and j (1\xe2\x89\xa4i,j\xe2\x89\xa4n) ai=aj, then bi=bj. In other words, you want to replace all occurrences of \'A\' with the same type of bracket, then all occurrences of \'B\' with the same type of bracket and all occurrences of \'C\' with the same type of bracket.Your task is to determine if such a string b exists." "bitmasks,brute force,implementation" 900
1988A "Split the Multiset" "A multiset is a set of numbers in which there can be equal elements, and the order of the numbers does not matter. For example, {2,2,4} is a multiset.You have a multiset S. Initially, the multiset contains only one positive integer n. That is, S={n}. Additionally, there is a given positive integer k.In one operation, you can select any positive integer u in S and remove one copy of u from S. Then, insert no more than k positive integers into S so that the sum of all inserted integers is equal to u.Find the minimum number of operations to make S contain n ones." "brute force,greedy,implementation,math" 900
961E Tufurama "One day Polycarp decided to rewatch his absolute favourite episode of well-known TV series ""Tufurama"". He was pretty surprised when he got results only for season 7 episode 3 with his search query of ""Watch Tufurama season 3 episode 7 online full hd free"". This got Polycarp confused \xe2\x80\x94 what if he decides to rewatch the entire series someday and won\'t be able to find the right episodes to watch? Polycarp now wants to count the number of times he will be forced to search for an episode using some different method.TV series have n seasons (numbered 1 through n), the i-th season has ai episodes (numbered 1 through ai). Polycarp thinks that if for some pair of integers x and y (x\xe2\x80\x89<\xe2\x80\x89y) exist both season x episode y and season y episode x then one of these search queries will include the wrong results. Help Polycarp to calculate the number of such pairs!" "data structures" 1900
454A "Little Pony and Crystal Mine" "Twilight Sparkle once got a crystal from the Crystal Mine. A crystal of size n (n is odd; n\xe2\x80\x89>\xe2\x80\x891) is an n\xe2\x80\x89\xc3\x97\xe2\x80\x89n matrix with a diamond inscribed into it.You are given an odd integer n. You need to draw a crystal of size n. The diamond cells of the matrix should be represented by character ""D"". All other cells of the matrix should be represented by character ""*"". Look at the examples to understand what you need to draw." implementation 800
1023F "Mobile Phone Network" "You are managing a mobile phone network, and want to offer competitive prices to connect a network.The network has n nodes.Your competitor has already offered some connections between some nodes, with some fixed prices. These connections are bidirectional. There are initially m connections the competitor is offering. The i-th connection your competitor is offering will connect nodes fai and fbi and costs fwi. You have a list of k connections that you want to offer. It is guaranteed that this set of connection does not form any cycle. The j-th of these connections will connect nodes gaj and gbj. These connections are also bidirectional. The cost of these connections have not been decided yet.You can set the prices of these connections to any arbitrary integer value. These prices are set independently for each connection. After setting the prices, the customer will choose such n\xe2\x88\x921 connections that all nodes are connected in a single network and the total cost of chosen connections is minimum possible. If there are multiple ways to choose such networks, the customer will choose an arbitrary one that also maximizes the number of your connections in it.You want to set prices in such a way such that all your k connections are chosen by the customer, and the sum of prices of your connections is maximized.Print the maximum profit you can achieve, or \xe2\x88\x921 if it is unbounded." "dfs and similar,dsu,graphs,trees" 2600
530G "Levenshtein distance" "Levenshtein distance between two strings of letters is calculated as the minimal total cost of a sequence of edit actions that converts one of the strings into the other one. The allowed edit actions are: substitution: the cost of substituting one letter with another is equal to the difference of index numbers of these letters in English alphabet. insertion/deletion: the cost of inserting a letter into a string or deleting a letter from a string is equal to the index number of this letter in English alphabet (see examples).You are given two strings. Find the Levenshtein distance between them." "*special problem" 2100
64G "Path Canonization" "A path in some Unix-similar file system is given. The path consists of elements separated with characters ""/"". For example: ""/usr/share/mysql/../tomcat6/conf/server.xml"". The path starts with the root directory (i.e. starts with the character ""/""). Each element means a name of file or directory, or it is one of two special elements: ""."" \xd0\xb8\xd0\xbb\xd0\xb8 "".."". First of them stands for the current directory (for example, path ""/./usr/././share"" is equal to ""/usr/share""). The second element "".."" stands for the moving to the parent directory (for example, path ""/usr/share/../lib"" is equal to ""/usr/lib"").You task is to convert the given path to such a path, which doesn\'t contain special elements ""."" and/or "".."". If it is impossible, print ""-1"". The only reason for it is an attempt to move to the parent directory from the root." "*special problem" 2200
635A Orchestra "Paul is at the orchestra. The string section is arranged in an r\xe2\x80\x89\xc3\x97\xe2\x80\x89c rectangular grid and is filled with violinists with the exception of n violists. Paul really likes violas, so he would like to take a picture including at least k of them. Paul can take a picture of any axis-parallel rectangle in the orchestra. Count the number of possible pictures that Paul can take.Two pictures are considered to be different if the coordinates of corresponding rectangles are different." "brute force,implementation" 1100
1334C "Circle of Monsters" "You are playing another computer game, and now you have to slay n monsters. These monsters are standing in a circle, numbered clockwise from 1 to n. Initially, the i-th monster has ai health.You may shoot the monsters to kill them. Each shot requires exactly one bullet and decreases the health of the targeted monster by 1 (deals 1 damage to it). Furthermore, when the health of some monster i becomes 0 or less than 0, it dies and explodes, dealing bi damage to the next monster (monster i+1, if i<n, or monster 1, if i=n). If the next monster is already dead, then nothing happens. If the explosion kills the next monster, it explodes too, damaging the monster after it and possibly triggering another explosion, and so on.You have to calculate the minimum number of bullets you have to fire to kill all n monsters in the circle." "brute force,constructive algorithms,greedy,math" 1600
1167B "Lost Numbers" "This is an interactive problem. Remember to flush your output while communicating with the testing program. You may use fflush(stdout) in C++, system.out.flush() in Java, stdout.flush() in Python or flush(output) in Pascal to flush the output. If you use some other programming language, consult its documentation. You may also refer to the guide on interactive problems: https://codeforces.com/blog/entry/45307.The jury guessed some array a consisting of 6 integers. There are 6 special numbers \xe2\x80\x94 4, 8, 15, 16, 23, 42 \xe2\x80\x94 and each of these numbers occurs in a exactly once (so, a is some permutation of these numbers).You don\'t know anything about their order, but you are allowed to ask up to 4 queries. In each query, you may choose two indices i and j (1\xe2\x89\xa4i,j\xe2\x89\xa46, i and j are not necessarily distinct), and you will get the value of ai\xe2\x8b\x85aj in return.Can you guess the array a?The array a is fixed beforehand in each test, the interaction program doesn\'t try to adapt to your queries." "brute force,divide and conquer,interactive,math" 1400
1133B "Preparation for International Women\'s Day" "International Women\'s Day is coming soon! Polycarp is preparing for the holiday.There are n candy boxes in the shop for sale. The i-th box contains di candies.Polycarp wants to prepare the maximum number of gifts for k girls. Each gift will consist of exactly two boxes. The girls should be able to share each gift equally, so the total amount of candies in a gift (in a pair of boxes) should be divisible by k. In other words, two boxes i and j (i\xe2\x89\xa0j) can be combined as a gift if di+dj is divisible by k.How many boxes will Polycarp be able to give? Of course, each box can be a part of no more than one gift. Polycarp cannot use boxes ""partially"" or redistribute candies between them." "math,number theory" 1200
627D "Preorder Test" "For his computer science class, Jacob builds a model tree with sticks and balls containing n nodes in the shape of a tree. Jacob has spent ai minutes building the i-th ball in the tree.Jacob\'s teacher will evaluate his model and grade Jacob based on the effort he has put in. However, she does not have enough time to search his whole tree to determine this; Jacob knows that she will examine the first k nodes in a DFS-order traversal of the tree. She will then assign Jacob a grade equal to the minimum ai she finds among those k nodes.Though Jacob does not have enough time to rebuild his model, he can choose the root node that his teacher starts from. Furthermore, he can rearrange the list of neighbors of each node in any order he likes. Help Jacob find the best grade he can get on this assignment.A DFS-order traversal is an ordering of the nodes of a rooted tree, built by a recursive DFS-procedure initially called on the root of the tree. When called on a given node v, the procedure does the following:   Print v.  Traverse the list of neighbors of the node v in order and iteratively call DFS-procedure on each one. Do not call DFS-procedure on node u if you came to node v directly from u." "binary search,dfs and similar,dp,graphs,greedy,trees" 2600
1622D Shuffle "You are given a binary string (i.\xe2\x80\x89e. a string consisting of characters 0 and/or 1) s of length n. You can perform the following operation with the string s at most once: choose a substring (a contiguous subsequence) of s having exactly k characters 1 in it, and shuffle it (reorder the characters in the substring as you wish).Calculate the number of different strings which can be obtained from s by performing this operation at most once." "combinatorics,math,two pointers" 2000
375D "Tree and Queries" "You have a rooted tree consisting of n vertices. Each vertex of the tree has some color. We will assume that the tree vertices are numbered by integers from 1 to n. Then we represent the color of vertex v as cv. The tree root is a vertex with number 1.In this problem you need to answer to m queries. Each query is described by two integers vj,\xe2\x80\x89kj. The answer to query vj,\xe2\x80\x89kj is the number of such colors of vertices x, that the subtree of vertex vj contains at least kj vertices of color x.You can find the definition of a rooted tree by the following link: http://en.wikipedia.org/wiki/Tree_(graph_theory)." "data structures,dfs and similar,trees" 2400
1955C "Inhabitant of the Deep Sea" "n ships set out to explore the depths of the ocean. The ships are numbered from 1 to n and follow each other in ascending order; the i-th ship has a durability of ai.The Kraken attacked the ships k times in a specific order. First, it attacks the first of the ships, then the last, then the first again, and so on.Each attack by the Kraken reduces the durability of the ship by 1. When the durability of the ship drops to 0, it sinks and is no longer subjected to attacks (thus the ship ceases to be the first or last, and the Kraken only attacks the ships that have not yet sunk). If all the ships have sunk, the Kraken has nothing to attack and it swims away.For example, if n=4, k=5, and a=[1,2,4,3], the following will happen:  The Kraken attacks the first ship, its durability becomes zero and now a=[2,4,3];  The Kraken attacks the last ship, now a=[2,4,2];  The Kraken attacks the first ship, now a=[1,4,2];  The Kraken attacks the last ship, now a=[1,4,1];  The Kraken attacks the first ship, its durability becomes zero and now a=[4,1]. How many ships were sunk after the Kraken\'s attack?" greedy,implementation,math 1300
229C Triangles "Alice and Bob don\'t play games anymore. Now they study properties of all sorts of graphs together. Alice invented the following task: she takes a complete undirected graph with n vertices, chooses some m edges and keeps them. Bob gets the  remaining edges.Alice and Bob are fond of ""triangles"" in graphs, that is, cycles of length 3. That\'s why they wonder: what total number of triangles is there in the two graphs formed by Alice and Bob\'s edges, correspondingly?" combinatorics,graphs,math 1900
916D "Jamie and To-do List" "Why I have to finish so many assignments???Jamie is getting very busy with his school life. He starts to forget the assignments that he has to do. He decided to write the things down on a to-do list. He assigns a value priority for each of his assignment (lower value means more important) so he can decide which he needs to spend more time on.After a few days, Jamie finds out the list is too large that he can\'t even manage the list by himself! As you are a good friend of Jamie, help him write a program to support the following operations on the to-do list:  set ai xi \xe2\x80\x94 Add assignment ai to the to-do list if it is not present, and set its priority to xi. If assignment ai is already in the to-do list, its priority is changed to xi.  remove ai \xe2\x80\x94 Remove assignment ai from the to-do list if it is present in it.  query ai \xe2\x80\x94 Output the number of assignments that are more important (have a smaller priority value) than assignment ai, so Jamie can decide a better schedule. Output \xe2\x80\x89-\xe2\x80\x891 if ai is not in the to-do list.  undo di \xe2\x80\x94 Undo all changes that have been made in the previous di days (not including the day of this operation) At day 0, the to-do list is empty. In each of the following q days, Jamie will do exactly one out of the four operations. If the operation is a query, you should output the result of the query before proceeding to the next day, or poor Jamie cannot make appropriate decisions." "data structures,interactive,trees" 2200
760A "Petr and a calendar" "Petr wants to make a calendar for current month. For this purpose he draws a table in which columns correspond to weeks (a week is seven consequent days from Monday to Sunday), rows correspond to weekdays, and cells contain dates. For example, a calendar for January 2017 should look like on the picture:  Petr wants to know how many columns his table should have given the month and the weekday of the first date of that month? Assume that the year is non-leap." implementation,math 800
1849A "Morning Sandwich" "Monocarp always starts his morning with a good ol\' sandwich. Sandwiches Monocarp makes always consist of bread, cheese and/or ham.A sandwich always follows the formula:   a piece of bread  a slice of cheese or ham  a piece of bread  \xe2\x80\xa6  a slice of cheese or ham  a piece of bread So it always has bread on top and at the bottom, and it alternates between bread and filling, where filling is a slice of either cheese or ham. Each piece of bread and each slice of cheese or ham is called a layer.Today Monocarp woke up and discovered that he has b pieces of bread, c slices of cheese and h slices of ham. What is the maximum number of layers his morning sandwich can have?" implementation,math 800
1281B "Azamon Web Services" "Your friend Jeff Zebos has been trying to run his new online company, but it\'s not going very well. He\'s not getting a lot of sales on his website which he decided to call Azamon. His big problem, you think, is that he\'s not ranking high enough on the search engines. If only he could rename his products to have better names than his competitors, then he\'ll be at the top of the search results and will be a millionaire.After doing some research, you find out that search engines only sort their results lexicographically. If your friend could rename his products to lexicographically smaller strings than his competitor\'s, then he\'ll be at the top of the rankings!To make your strategy less obvious to his competitors, you decide to swap no more than two letters of the product names.Please help Jeff to find improved names for his products that are lexicographically smaller than his competitor\'s!Given the string s representing Jeff\'s product name and the string c representing his competitor\'s product name, find a way to swap at most one pair of characters in s (that is, find two distinct indices i and j and swap si and sj) such that the resulting new name becomes strictly lexicographically smaller than c, or determine that it is impossible.Note: String a is strictly lexicographically smaller than string b if and only if one of the following holds:  a is a proper prefix of b, that is, a is a prefix of b such that a\xe2\x89\xa0b;  There exists an integer 1\xe2\x89\xa4i\xe2\x89\xa4min(|a|,|b|) such that ai<bi and aj=bj for 1\xe2\x89\xa4j<i." greedy 1600
499B Lecture "You have a new professor of graph theory and he speaks very quickly. You come up with the following plan to keep up with his lecture and make notes.You know two languages, and the professor is giving the lecture in the first one. The words in both languages consist of lowercase English characters, each language consists of several words. For each language, all words are distinct, i.e. they are spelled differently. Moreover, the words of these languages have a one-to-one correspondence, that is, for each word in each language, there exists exactly one word in the other language having has the same meaning.You can write down every word the professor says in either the first language or the second language. Of course, during the lecture you write down each word in the language in which the word is shorter. In case of equal lengths of the corresponding words you prefer the word of the first language.You are given the text of the lecture the professor is going to read. Find out how the lecture will be recorded in your notes." implementation,strings 1000
965A "Paper Airplanes" "To make a paper airplane, one has to use a rectangular piece of paper. From a sheet of standard size you can make s airplanes.A group of k people decided to make n airplanes each. They are going to buy several packs of paper, each of them containing p sheets, and then distribute the sheets between the people. Each person should have enough sheets to make n airplanes. How many packs should they buy?" math 800
785D "Anton and School - 2" "As you probably know, Anton goes to school. One of the school subjects that Anton studies is Bracketology. On the Bracketology lessons students usually learn different sequences that consist of round brackets (characters ""("" and "")"" (without quotes)).On the last lesson Anton learned about the regular simple bracket sequences (RSBS). A bracket sequence s of length n is an RSBS if the following conditions are met:  It is not empty (that is n\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x890).  The length of the sequence is even.  First  charactes of the sequence are equal to ""("".  Last  charactes of the sequence are equal to "")"". For example, the sequence ""((()))"" is an RSBS but the sequences ""((())"" and ""(()())"" are not RSBS.Elena Ivanovna, Anton\'s teacher, gave him the following task as a homework. Given a bracket sequence s. Find the number of its distinct subsequences such that they are RSBS. Note that a subsequence of s is a string that can be obtained from s by deleting some of its elements. Two subsequences are considered distinct if distinct sets of positions are deleted.Because the answer can be very big and Anton\'s teacher doesn\'t like big numbers, she asks Anton to find the answer modulo 109\xe2\x80\x89+\xe2\x80\x897.Anton thought of this task for a very long time, but he still doesn\'t know how to solve it. Help Anton to solve this task and write a program that finds the answer for it!" "combinatorics,dp,math,number theory" 2300
1575C "Cyclic Sum" "Denote a cyclic sequence of size n as an array s such that sn is adjacent to s1. The segment s[r,l] where l<r is the concatenation of s[r,n] and s[1,l].You are given an array a consisting of n integers. Define b as the cyclic sequence obtained from concatenating m copies of a. Note that b has size n\xe2\x8b\x85m.You are given an integer k where k=1 or k is a prime number. Find the number of different segments in b where the sum of elements in the segment is divisible by k.Two segments are considered different if the set of indices of the segments are different. For example, when n=3 and m=2, the set of indices for segment s[2,5] is {2,3,4,5}, and for segment s[5,2] is {5,6,1,2}. In particular, the segments s[1,6],s[2,1],\xe2\x80\xa6,s[6,5] are considered as the same segment.Output the answer modulo 109+7." "data structures,fft,number theory" 3000
582E "Boolean Function" "In this problem we consider Boolean functions of four variables A,\xe2\x80\x89B,\xe2\x80\x89C,\xe2\x80\x89D. Variables A,\xe2\x80\x89B,\xe2\x80\x89C and D are logical and can take values 0 or 1. We will define a function using the following grammar:<expression> ::= <variable> | (<expression>) <operator> (<expression>)<variable> ::= \'A\' | \'B\' | \'C\' | \'D\' | \'a\' | \'b\' | \'c\' | \'d\'<operator> ::= \'&\' | \'|\'Here large letters A,\xe2\x80\x89B,\xe2\x80\x89C,\xe2\x80\x89D represent variables, and small letters represent their negations. For example, if A\xe2\x80\x89=\xe2\x80\x891, then character \'A\' corresponds to value 1, and value character \'a\' corresponds to value 0. Here character \'&\' corresponds to the operation of logical AND, character \'|\' corresponds to the operation of logical OR.You are given expression s, defining function f, where some operations and variables are missing. Also you know the values of the function f(A,\xe2\x80\x89B,\xe2\x80\x89C,\xe2\x80\x89D) for some n distinct sets of variable values. Count the number of ways to restore the elements that are missing in the expression so that the resulting expression corresponded to the given information about function f in the given variable sets. As the value of the result can be rather large, print its remainder modulo 109\xe2\x80\x89+\xe2\x80\x897." "bitmasks,dp,expression parsing" 3000
380A "Sereja and Prefixes" "Sereja loves number sequences very much. That\'s why he decided to make himself a new one following a certain algorithm.Sereja takes a blank piece of paper. Then he starts writing out the sequence in m stages. Each time he either adds a new number to the end of the sequence or takes l first elements of the current sequence and adds them c times to the end. More formally, if we represent the current sequence as a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an, then after we apply the described operation, the sequence transforms into a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an[,\xe2\x80\x89a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89al] (the block in the square brackets must be repeated c times). A day has passed and Sereja has completed the sequence. He wonders what are the values of some of its elements. Help Sereja." "binary search,brute force" 1600
671D "Roads in Yusland" "Mayor of Yusland just won the lottery and decided to spent money on something good for town. For example, repair all the roads in the town.Yusland consists of n intersections connected by n\xe2\x80\x89-\xe2\x80\x891 bidirectional roads. One can travel from any intersection to any other intersection using only these roads.There is only one road repairing company in town, named ""RC company"". Company\'s center is located at the intersection 1. RC company doesn\'t repair roads you tell them. Instead, they have workers at some intersections, who can repair only some specific paths. The i-th worker can be paid ci coins and then he repairs all roads on a path from ui to some vi that lies on the path from ui to intersection 1. Mayor asks you to choose the cheapest way to hire some subset of workers in order to repair all the roads in Yusland. It\'s allowed that some roads will be repaired more than once.If it\'s impossible to repair all roads print \xe2\x80\x89-\xe2\x80\x891." "data structures,dp,greedy" 2900
340B "Maximal Area Quadrilateral" "Iahub has drawn a set of n points in the cartesian plane which he calls ""special points"". A quadrilateral is a simple polygon without self-intersections with four sides (also called edges) and four vertices (also called corners). Please note that a quadrilateral doesn\'t have to be convex. A special quadrilateral is one which has all four vertices in the set of special points. Given the set of special points, please calculate the maximal area of a special quadrilateral." "brute force,geometry" 2100
2001E1 "Deterministic Heap (Easy Version)" "This is the easy version of the problem. The difference between the two versions is the definition of deterministic max-heap, time limit, and constraints on n and t. You can make hacks only if both versions of the problem are solved.Consider a perfect binary tree with size 2n\xe2\x88\x921, with nodes numbered from 1 to 2n\xe2\x88\x921 and rooted at 1. For each vertex v (1\xe2\x89\xa4v\xe2\x89\xa42n\xe2\x88\x921\xe2\x88\x921), vertex 2v is its left child and vertex 2v+1 is its right child. Each node v also has a value av assigned to it.Define the operation pop as follows:  initialize variable v as 1;  repeat the following process until vertex v is a leaf (i.e. until 2n\xe2\x88\x921\xe2\x89\xa4v\xe2\x89\xa42n\xe2\x88\x921);   among the children of v, choose the one with the larger value on it and denote such vertex as x; if the values on them are equal (i.e. a2v=a2v+1), you can choose any of them;  assign ax to av (i.e. av:=ax);  assign x to v (i.e. v:=x);   assign \xe2\x88\x921 to av (i.e. av:=\xe2\x88\x921). Then we say the pop operation is deterministic if there is a unique way to do such operation. In other words, a2v\xe2\x89\xa0a2v+1 would hold whenever choosing between them.A binary tree is called a max-heap if for every vertex v (1\xe2\x89\xa4v\xe2\x89\xa42n\xe2\x88\x921\xe2\x88\x921), both av\xe2\x89\xa5a2v and av\xe2\x89\xa5a2v+1 hold.A max-heap is deterministic if the pop operation is deterministic to the heap when we do it for the first time.Initially, av:=0 for every vertex v (1\xe2\x89\xa4v\xe2\x89\xa42n\xe2\x88\x921), and your goal is to count the number of different deterministic max-heaps produced by applying the following operation add exactly k times:  Choose an integer v (1\xe2\x89\xa4v\xe2\x89\xa42n\xe2\x88\x921) and, for every vertex x on the path between 1 and v, add 1 to ax. Two heaps are considered different if there is a node which has different values in the heaps. Since the answer might be large, print it modulo p." combinatorics,dp,math,trees 2400
1363E "Tree Shuffling" "Ashish has a tree consisting of n nodes numbered 1 to n rooted at node 1. The i-th node in the tree has a cost ai, and binary digit bi is written in it. He wants to have binary digit ci written in the i-th node in the end.To achieve this, he can perform the following operation any number of times:   Select any k nodes from the subtree of any node u, and shuffle the digits in these nodes as he wishes, incurring a cost of k\xe2\x8b\x85au. Here, he can choose k ranging from 1 to the size of the subtree of u. He wants to perform the operations in such a way that every node finally has the digit corresponding to its target.Help him find the minimum total cost he needs to spend so that after all the operations, every node u has digit cu written in it, or determine that it is impossible." "dfs and similar,dp,greedy,trees" 2000
29B "Traffic Lights" "A car moves from point A to point B at speed v meters per second. The action takes place on the X-axis. At the distance d meters from A there are traffic lights. Starting from time 0, for the first g seconds the green light is on, then for the following r seconds the red light is on, then again the green light is on for the g seconds, and so on.The car can be instantly accelerated from 0 to v and vice versa, can instantly slow down from the v to 0. Consider that it passes the traffic lights at the green light instantly. If the car approaches the traffic lights at the moment when the red light has just turned on, it doesn\'t have time to pass it. But if it approaches the traffic lights at the moment when the green light has just turned on, it can move. The car leaves point A at the time 0.What is the minimum time for the car to get from point A to point B without breaking the traffic rules?" implementation 1500
717B "R3D3\xe2\x80\x99s Summer Adventure" "R3D3 spent some time on an internship in MDCS. After earning enough money, he decided to go on a holiday somewhere far, far away. He enjoyed suntanning, drinking alcohol-free cocktails and going to concerts of popular local bands. While listening to ""The White Buttons"" and their hit song ""Dacan the Baker"", he met another robot for whom he was sure is the love of his life. Well, his summer, at least. Anyway, R3D3 was too shy to approach his potential soulmate, so he decided to write her a love letter. However, he stumbled upon a problem. Due to a terrorist threat, the Intergalactic Space Police was monitoring all letters sent in the area. Thus, R3D3 decided to invent his own alphabet, for which he was sure his love would be able to decipher.There are n letters in R3D3\xe2\x80\x99s alphabet, and he wants to represent each letter as a sequence of \'0\' and \'1\', so that no letter\xe2\x80\x99s sequence is a prefix of another letter\'s sequence. Since the Intergalactic Space Communications Service has lately introduced a tax for invented alphabets, R3D3 must pay a certain amount of money for each bit in his alphabet\xe2\x80\x99s code (check the sample test for clarifications). He is too lovestruck to think clearly, so he asked you for help.Given the costs c0 and c1 for each \'0\' and \'1\' in R3D3\xe2\x80\x99s alphabet, respectively, you should come up with a coding for the alphabet (with properties as above) with minimum total cost." dp,greedy 2700
963E "Circles of Waiting" "A chip was placed on a field with coordinate system onto point (0,\xe2\x80\x890).Every second the chip moves randomly. If the chip is currently at a point (x,\xe2\x80\x89y), after a second it moves to the point (x\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89y) with probability p1, to the point (x,\xe2\x80\x89y\xe2\x80\x89-\xe2\x80\x891) with probability p2, to the point (x\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89y) with probability p3 and to the point (x,\xe2\x80\x89y\xe2\x80\x89+\xe2\x80\x891) with probability p4. It\'s guaranteed that p1\xe2\x80\x89+\xe2\x80\x89p2\xe2\x80\x89+\xe2\x80\x89p3\xe2\x80\x89+\xe2\x80\x89p4\xe2\x80\x89=\xe2\x80\x891. The moves are independent.Find out the expected time after which chip will move away from origin at a distance greater than R (i.e.  will be satisfied)." math 3100
77A Heroes "The year of 2012 is coming...According to an ancient choradrican legend in this very year, in 2012, Diablo and his brothers Mephisto and Baal will escape from hell, and innumerable hordes of demons will enslave the human world. But seven brave heroes have already gathered on the top of a mountain Arreat to protect us mere mortals from the effect of this terrible evil.The seven great heroes are: amazon Anka, barbarian Chapay, sorceress Cleo, druid Troll, necromancer Dracul, paladin Snowy and a professional hit girl Hexadecimal. Heroes already know how much experience will be given for each of the three megabosses: a for Mephisto, b for Diablo and c for Baal.Here\'s the problem: heroes are as much as seven and megabosses are only three! Then our heroes decided to split into three teams, where each team will go to destroy their own megaboss. Each team member will receive a  of experience, rounded down, where x will be the amount of experience for the killed megaboss and y \xe2\x80\x94 the number of people in the team.Heroes do not want to hurt each other\'s feelings, so they want to split into teams so that the difference between the hero who received the maximum number of experience and the hero who received the minimum number of experience were minimal. Since there can be several divisions into teams, then you need to find the one in which the total amount of liking in teams were maximum.It is known that some heroes like others. But if hero p likes hero q, this does not mean that the hero q likes hero p. No hero likes himself.The total amount of liking in teams is the amount of ordered pairs (p,\xe2\x80\x89q), such that heroes p and q are in the same group, and hero p likes hero q (but it is not important if hero q likes hero p). In case of heroes p and q likes each other and they are in the same group, this pair should be counted twice, as (p,\xe2\x80\x89q) and (q,\xe2\x80\x89p).A team can consist even of a single hero, but it is important that every megaboss was destroyed. All heroes must be involved in the campaign against evil. None of the heroes can be in more than one team.It is guaranteed that every hero is able to destroy any megaboss alone." "brute force,implementation" 1400
1065E "Side Transmutations" "Consider some set of distinct characters A and some string S, consisting of exactly n characters, where each character is present in A.You are given an array of m integers b (b1<b2<\xe2\x8b\xaf<bm). You are allowed to perform the following move on the string S:  Choose some valid i and set k=bi;  Take the first k characters of S=Prk;  Take the last k characters of S=Suk;  Substitute the first k characters of S with the reversed Suk;  Substitute the last k characters of S with the reversed Prk. For example, let\'s take a look at S= ""abcdefghi"" and k=2. Pr2= ""ab"", Su2= ""hi"". Reversed Pr2= ""ba"", Su2= ""ih"". Thus, the resulting S is ""ihcdefgba"".The move can be performed arbitrary number of times (possibly zero). Any i can be selected multiple times over these moves.Let\'s call some strings S and T equal if and only if there exists such a sequence of moves to transmute string S to string T. For the above example strings ""abcdefghi"" and ""ihcdefgba"" are equal. Also note that this implies S=S.The task is simple. Count the number of distinct strings.The answer can be huge enough, so calculate it modulo 998244353." combinatorics,strings 2300
1696F "Tree Recovery" "Fishingprince loves trees. A tree is a connected undirected graph without cycles.Fishingprince has a tree of n vertices. The vertices are numbered 1 through n. Let d(x,y) denote the shortest distance on the tree from vertex x to vertex y, assuming that the length of each edge is 1.However, the tree was lost in an accident. Fortunately, Fishingprince still remembers some information about the tree. More specifically, for every triple of integers x,y,z (1\xe2\x89\xa4x<y\xe2\x89\xa4n, 1\xe2\x89\xa4z\xe2\x89\xa4n) he remembers whether d(x,z)=d(y,z) or not.Help him recover the structure of the tree, or report that no tree satisfying the constraints exists." "brute force,constructive algorithms,dfs and similar,dsu,graphs,trees" 2600
1157C2 "Increasing Subsequence (hard version)" "The only difference between problems C1 and C2 is that all values in input of problem C1 are distinct (this condition may be false for problem C2).You are given a sequence a consisting of n integers.You are making a sequence of moves. During each move you must take either the leftmost element of the sequence or the rightmost element of the sequence, write it down and remove it from the sequence. Your task is to write down a strictly increasing sequence, and among all such sequences you should take the longest (the length of the sequence is the number of elements in it).For example, for the sequence [1,2,4,3,2] the answer is 4 (you take 1 and the sequence becomes [2,4,3,2], then you take the rightmost element 2 and the sequence becomes [2,4,3], then you take 3 and the sequence becomes [2,4] and then you take 4 and the sequence becomes [2], the obtained increasing sequence is [1,2,3,4])." greedy 1700
349B "Color the Fence" "Igor has fallen in love with Tanya. Now Igor wants to show his feelings and write a number on the fence opposite to Tanya\'s house. Igor thinks that the larger the number is, the more chance to win Tanya\'s heart he has. Unfortunately, Igor could only get v liters of paint. He did the math and concluded that digit d requires ad liters of paint. Besides, Igor heard that Tanya doesn\'t like zeroes. That\'s why Igor won\'t use them in his number.Help Igor find the maximum number he can write on the fence." "data structures,dp,greedy,implementation" 1700
897A "Scarborough Fair" "Are you going to Scarborough Fair?Parsley, sage, rosemary and thyme.Remember me to one who lives there.He once was the true love of mine.Willem is taking the girl to the highest building in island No.28, however, neither of them knows how to get there.Willem asks his friend, Grick for directions, Grick helped them, and gave them a task.Although the girl wants to help, Willem insists on doing it by himself.Grick gave Willem a string of length n.Willem needs to do m operations, each operation has four parameters l,\xe2\x80\x89r,\xe2\x80\x89c1,\xe2\x80\x89c2, which means that all symbols c1 in range [l,\xe2\x80\x89r] (from l-th to r-th, including l and r) are changed into c2. String is 1-indexed.Grick wants to know the final string after all the m operations." implementation 800
1798E "Multitest Generator" "Let\'s call an array b1,b2,\xe2\x80\xa6,bm a test if b1=m\xe2\x88\x921.Let\'s call an array b1,b2,\xe2\x80\xa6,bm a multitest if the array b2,b3,\xe2\x80\xa6,bm can be split into b1 non-empty subarrays so that each of these subarrays is a test. Note that each element of the array must be included in exactly one subarray, and the subarrays must consist of consecutive elements.Let\'s define the function f from the array b1,b2,\xe2\x80\xa6,bm as the minimum number of operations of the form ""Replace any bi with any non-negative integer x"", which needs to be done so that the array b1,b2,\xe2\x80\xa6,bm becomes a multitest.You are given an array of positive integers a1,a2,\xe2\x80\xa6,an. For each i from 1 to n\xe2\x88\x921, find f([ai,ai+1,\xe2\x80\xa6,an]).Below are some examples of tests and multitests.   Tests: [1_,5], [2_,2,2], [3_,4,1,1], [5_,0,0,0,0,0], [7_,1,2,3,4,5,6,7], [0_]. These arrays are tests since their first element (underlined) is equal to the length of the array minus one.  Multitests: [1,1_,1_], [2,3_,0,0,1_,1_,12_], [3,2_,2,7_,1_,1_,3_,4,4,4_], [4,0__,3_,1,7,9_,4_,2,0,0,9_,1_,777_]. Underlined are the subarrays after the split, and double underlined are the first elements of each subarray." "brute force,dp" 2300
733F "Drivers Dissatisfaction" "In one kingdom there are n cities and m two-way roads. Each road connects a pair of cities, and for each road we know the level of drivers dissatisfaction \xe2\x80\x94 the value wi.For each road we know the value ci \xe2\x80\x94 how many lamziks we should spend to reduce the level of dissatisfaction with this road by one. Thus, to reduce the dissatisfaction with the i-th road by k, we should spend k\xc2\xb7ci lamziks. And it is allowed for the dissatisfaction to become zero or even negative.In accordance with the king\'s order, we need to choose n\xe2\x80\x89-\xe2\x80\x891 roads and make them the main roads. An important condition must hold: it should be possible to travel from any city to any other by the main roads.The road ministry has a budget of S lamziks for the reform. The ministry is going to spend this budget for repair of some roads (to reduce the dissatisfaction with them), and then to choose the n\xe2\x80\x89-\xe2\x80\x891 main roads.Help to spend the budget in such a way and then to choose the main roads so that the total dissatisfaction with the main roads will be as small as possible. The dissatisfaction with some roads can become negative. It is not necessary to spend whole budget S.It is guaranteed that it is possible to travel from any city to any other using existing roads. Each road in the kingdom is a two-way road." "data structures,dsu,graphs,trees" 2200
1773B BinCoin "There are n employees in the BinCoin company numbered from 1 to n. The subordination structure in this company is a rooted tree. In other words:   There is one CEO in the company \xe2\x80\x94 the main boss.  Each other employee has exactly one direct superior.  There are no cycles in the subordination structure. Moreover, due to the inexplicable love of the CEO of BinCoin for all the binary stuff, the subordination structure in the company is a binary rooted tree. That means each employee is directly superior to exactly zero or two other employees.In the CEO\'s opinion, working in this company is almost as dangerous as in mines. So, employees should sign the waiver of claims sometimes. This process happens in the following way. Initially, CEO takes the journal, then recursively the following procedure is performed:  If an employee that holds the journal does not have any subordinates, they sign the waiver in the journal and give it back to their superior. The procedure stops if that was the CEO, who has no superior.  Otherwise   they choose one of two of their direct subordinates uniformly at random and give the journal to one of them;  when they get the journal back, they sign it;  and then they give it to another direct subordinate;  when they get it back again, they give it back to their superior. The procedure stops if that was the CEO, who has no superior.  All random choices are independent.One day, the CEO realized that they could not remember the subordination tree. Fortunately, they have the journal with k records. Each record is a sequence of employees in the order they\'ve signed in a journal.Help CEO restore the subordination tree." "binary search,divide and conquer,hashing,implementation,probabilities,trees" 2200
688B "Lovely Palindromes" "Pari has a friend who loves palindrome numbers. A palindrome number is a number that reads the same forward or backward. For example 12321, 100001 and 1 are palindrome numbers, while 112 and 1021 are not.Pari is trying to love them too, but only very special and gifted people can understand the beauty behind palindrome numbers. Pari loves integers with even length (i.e. the numbers with even number of digits), so she tries to see a lot of big palindrome numbers with even length (like a 2-digit 11 or 6-digit 122221), so maybe she could see something in them.Now Pari asks you to write a program that gets a huge integer n from the input and tells what is the n-th even-length positive palindrome number?" "constructive algorithms,math" 1000
1090D "Similar Arrays" "Vasya had an array of n integers, each element of the array was from 1 to n. He chose m pairs of different positions and wrote them down to a sheet of paper. Then Vasya compared the elements at these positions, and wrote down the results of the comparisons to another sheet of paper. For each pair he wrote either ""greater"", ""less"", or ""equal"".After several years, he has found the first sheet of paper, but he couldn\'t find the second one. Also he doesn\'t remember the array he had. In particular, he doesn\'t remember if the array had equal elements. He has told this sad story to his informatics teacher Dr Helen.She told him that it could be the case that even if Vasya finds his second sheet, he would still not be able to find out whether the array had two equal elements. Now Vasya wants to find two arrays of integers, each of length n. All elements of the first array must be distinct, and there must be two equal elements in the second array. For each pair of positions Vasya wrote at the first sheet of paper, the result of the comparison must be the same for the corresponding elements of the first array, and the corresponding elements of the second array. Help Vasya find two such arrays of length n, or find out that there are no such arrays for his sets of pairs." "constructive algorithms" 1800
113B Petr# "Long ago, when Petya was a schoolboy, he was very much interested in the Petr# language grammar. During one lesson Petya got interested in the following question: how many different continuous substrings starting with the sbegin and ending with the send (it is possible sbegin\xe2\x80\x89=\xe2\x80\x89send), the given string t has. Substrings are different if and only if their contents aren\'t equal, their positions of occurence don\'t matter. Petya wasn\'t quite good at math, that\'s why he couldn\'t count this number. Help him!" "brute force,data structures,hashing,strings" 2000
1732D2 "Balance (Hard version)" "This is the hard version of the problem. The only difference is that in this version there are remove queries.Initially you have a set containing one element \xe2\x80\x94 0. You need to handle q queries of the following types:+ x \xe2\x80\x94 add the integer x to the set. It is guaranteed that this integer is not contained in the set; - x \xe2\x80\x94 remove the integer x from the set. It is guaranteed that this integer is contained in the set; ? k \xe2\x80\x94 find the k-mex of the set. In our problem, we define the k-mex of a set of integers as the smallest non-negative integer x that is divisible by k and which is not contained in the set." "brute force,data structures,number theory" 2400
1268C "K Integers" "You are given a permutation p1,p2,\xe2\x80\xa6,pn.In one move you can swap two adjacent values.You want to perform a minimum number of moves, such that in the end there will exist a subsegment 1,2,\xe2\x80\xa6,k, in other words in the end there should be an integer i, 1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x92k+1 such that pi=1,pi+1=2,\xe2\x80\xa6,pi+k\xe2\x88\x921=k.Let f(k) be the minimum number of moves that you need to make a subsegment with values 1,2,\xe2\x80\xa6,k appear in the permutation.You need to find f(1),f(2),\xe2\x80\xa6,f(n)." "binary search,data structures" 2300
1992B "Angry Monk" "To celebrate his recovery, k1o0n has baked an enormous n metres long potato casserole.Turns out, Noobish_Monk just can\'t stand potatoes, so he decided to ruin k1o0n\'s meal. He has cut it into k pieces, of lengths a1,a2,\xe2\x80\xa6,ak meters.k1o0n wasn\'t keen on that. Luckily, everything can be fixed. In order to do that, k1o0n can do one of the following operations:   Pick a piece with length ai\xe2\x89\xa52 and divide it into two pieces with lengths 1 and ai\xe2\x88\x921. As a result, the number of pieces will increase by 1;  Pick a slice ai and another slice with length aj=1 (i\xe2\x89\xa0j) and merge them into one piece with length ai+1. As a result, the number of pieces will decrease by 1. Help k1o0n to find the minimum number of operations he needs to do in order to merge the casserole into one piece with length n.For example, if n=5, k=2 and a=[3,2], it is optimal to do the following:  Divide the piece with length 2 into two pieces with lengths 2\xe2\x88\x921=1 and 1, as a result a=[3,1,1].  Merge the piece with length 3 and the piece with length 1, as a result a=[4,1].  Merge the piece with length 4 and the piece with length 1, as a result a=[5]." greedy,math,sortings 800
1307A "Cow and Haybales" "The USA Construction Operation (USACO) recently ordered Farmer John to arrange a row of n haybale piles on the farm. The i-th pile contains ai haybales. However, Farmer John has just left for vacation, leaving Bessie all on her own. Every day, Bessie the naughty cow can choose to move one haybale in any pile to an adjacent pile. Formally, in one day she can choose any two indices i and j (1\xe2\x89\xa4i,j\xe2\x89\xa4n) such that |i\xe2\x88\x92j|=1 and ai>0 and apply ai=ai\xe2\x88\x921, aj=aj+1. She may also decide to not do anything on some days because she is lazy.Bessie wants to maximize the number of haybales in pile 1 (i.e. to maximize a1), and she only has d days to do so before Farmer John returns. Help her find the maximum number of haybales that may be in pile 1 if she acts optimally!" greedy,implementation 800
120H "Brevity is Soul of Wit" "As we communicate, we learn much new information. However, the process of communication takes too much time. It becomes clear if we look at the words we use in our everyday speech.We can list many simple words consisting of many letters: ""information"", ""technologies"", ""university"", ""construction"", ""conservatoire"", ""refrigerator"", ""stopwatch"", ""windowsill"", ""electricity"", ""government"" and so on. Of course, we can continue listing those words ad infinitum. Fortunately, the solution for that problem has been found. To make our speech clear and brief, we should replace the initial words with those that resemble them but are much shorter. This idea hasn\'t been brought into life yet, that\'s why you are chosen to improve the situation. Let\'s consider the following formal model of transforming words: we shall assume that one can use n words in a chat. For each words we shall introduce a notion of its shorter variant. We shall define shorter variant of an arbitrary word s as such word t, that meets the following conditions:  it occurs in s as a subsequence,  its length ranges from one to four characters. In other words, the word t consists at least of one and at most of four characters that occur in the same order in the word s. Note that those characters do not necessarily follow in s immediately one after another. You are allowed not to shorten the initial word if its length does not exceed four characters.You are given a list of n different words. Your task is to find a set of their shortened variants. The shortened variants of all words from the list should be different." "graph matchings" 1800
543B "Destroying Roads" "In some country there are exactly n cities and m bidirectional roads connecting the cities. Cities are numbered with integers from 1 to n. If cities a and b are connected by a road, then in an hour you can go along this road either from city a to city b, or from city b to city a. The road network is such that from any city you can get to any other one by moving along the roads.You want to destroy the largest possible number of roads in the country so that the remaining roads would allow you to get from city s1 to city t1 in at most l1 hours and get from city s2 to city t2 in at most l2 hours.Determine what maximum number of roads you need to destroy in order to meet the condition of your plan. If it is impossible to reach the desired result, print -1." "constructive algorithms,graphs,shortest paths" 2100
1769C1 "\xd0\x9f\xd0\xbe\xd0\xb4\xd0\xba\xd1\x80\xd1\x83\xd1\x82\xd0\xba\xd0\xb0 I" "\xd0\x92 \xd1\x8d\xd1\x82\xd0\xbe\xd0\xb9 \xd0\xb2\xd0\xb5\xd1\x80\xd1\x81\xd0\xb8\xd0\xb8 \xd0\xb7\xd0\xb0\xd0\xb4\xd0\xb0\xd1\x87\xd0\xb8 n\xe2\x89\xa450 \xd0\xb8 ai\xe2\x89\xa4100.\xd0\x92\xd0\xb8\xd0\xba\xd0\xb0 \xd0\xb7\xd0\xb0 \xd0\xb2\xd1\x80\xd0\xb5\xd0\xbc\xd1\x8f \xd1\x80\xd0\xb0\xd0\xb1\xd0\xbe\xd1\x82\xd1\x8b \xd0\xb2 \xd0\xba\xd0\xbe\xd0\xbc\xd0\xbf\xd0\xb0\xd0\xbd\xd0\xb8\xd0\xb8 VK \xd1\x83\xd0\xb6\xd0\xb5 \xd1\x81\xd0\xb4\xd0\xb5\xd0\xbb\xd0\xb0\xd0\xbb\xd0\xb0 n \xd0\xba\xd0\xbe\xd0\xbc\xd0\xbc\xd0\xb8\xd1\x82\xd0\xbe\xd0\xb2 \xd0\xb2 \xd1\x81\xd0\xb8\xd1\x81\xd1\x82\xd0\xb5\xd0\xbc\xd0\xb5 \xd0\xba\xd0\xbe\xd0\xbd\xd1\x82\xd1\x80\xd0\xbe\xd0\xbb\xd1\x8f \xd0\xb2\xd0\xb5\xd1\x80\xd1\x81\xd0\xb8\xd0\xb9. i-\xd0\xb9 \xd0\xba\xd0\xbe\xd0\xbc\xd0\xbc\xd0\xb8\xd1\x82 \xd0\xb1\xd1\x8b\xd0\xbb \xd1\x81\xd0\xb4\xd0\xb5\xd0\xbb\xd0\xb0\xd0\xbd \xd0\xb2 ai-\xd0\xb9 \xd0\xb4\xd0\xb5\xd0\xbd\xd1\x8c \xd1\x80\xd0\xb0\xd0\xb1\xd0\xbe\xd1\x82\xd1\x8b \xd0\x92\xd0\xb8\xd0\xba\xd0\xb8 \xd0\xb2 \xd0\xba\xd0\xbe\xd0\xbc\xd0\xbf\xd0\xb0\xd0\xbd\xd0\xb8\xd0\xb8. \xd0\x92 \xd0\xbd\xd0\xb5\xd0\xba\xd0\xbe\xd1\x82\xd0\xbe\xd1\x80\xd1\x8b\xd0\xb5 \xd0\xb4\xd0\xbd\xd0\xb8 \xd0\x92\xd0\xb8\xd0\xba\xd0\xb0 \xd0\xbc\xd0\xbe\xd0\xb3\xd0\xbb\xd0\xb0 \xd1\x81\xd0\xb4\xd0\xb5\xd0\xbb\xd0\xb0\xd1\x82\xd1\x8c \xd0\xbd\xd0\xb5\xd1\x81\xd0\xba\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xba\xd0\xbe \xd0\xba\xd0\xbe\xd0\xbc\xd0\xbc\xd0\xb8\xd1\x82\xd0\xbe\xd0\xb2, \xd0\xb0 \xd0\xb2 \xd0\xb4\xd1\x80\xd1\x83\xd0\xb3\xd0\xb8\xd0\xb5 \xe2\x80\x94 \xd0\xbd\xd0\xb5 \xd1\x81\xd0\xb4\xd0\xb5\xd0\xbb\xd0\xb0\xd1\x82\xd1\x8c \xd0\xbd\xd0\xb8 \xd0\xbe\xd0\xb4\xd0\xbd\xd0\xbe\xd0\xb3\xd0\xbe.\xd0\x92\xd0\xb8\xd0\xba\xd1\x83 \xd0\xb8\xd0\xbd\xd1\x82\xd0\xb5\xd1\x80\xd0\xb5\xd1\x81\xd1\x83\xd1\x8e\xd1\x82 \xd1\x82\xd0\xb0\xd0\xba\xd0\xb8\xd0\xb5 \xd0\xbe\xd1\x82\xd1\x80\xd0\xb5\xd0\xb7\xd0\xba\xd0\xb8 \xd0\xbf\xd0\xbe\xd0\xb4\xd1\x80\xd1\x8f\xd0\xb4 \xd0\xb8\xd0\xb4\xd1\x83\xd1\x89\xd0\xb8\xd1\x85 \xd0\xb4\xd0\xbd\xd0\xb5\xd0\xb9, \xd1\x87\xd1\x82\xd0\xbe \xd0\xb2 \xd0\xba\xd0\xb0\xd0\xb6\xd0\xb4\xd1\x8b\xd0\xb9 \xd0\xb8\xd0\xb7 \xd1\x8d\xd1\x82\xd0\xb8\xd1\x85 \xd0\xb4\xd0\xbd\xd0\xb5\xd0\xb9 \xd1\x83 \xd0\xbd\xd0\xb5\xd1\x91 \xd0\xb5\xd1\x81\xd1\x82\xd1\x8c \xd1\x85\xd0\xbe\xd1\x82\xd1\x8f \xd0\xb1\xd1\x8b \xd0\xbe\xd0\xb4\xd0\xb8\xd0\xbd \xd0\xba\xd0\xbe\xd0\xbc\xd0\xbc\xd0\xb8\xd1\x82. \xd0\xa7\xd0\xb5\xd0\xbc \xd0\xb4\xd0\xbb\xd0\xb8\xd0\xbd\xd0\xbd\xd0\xb5\xd0\xb5 \xd0\xb1\xd1\x83\xd0\xb4\xd0\xb5\xd1\x82 \xd1\x81\xd0\xb0\xd0\xbc\xd1\x8b\xd0\xb9 \xd0\xb4\xd0\xbb\xd0\xb8\xd0\xbd\xd0\xbd\xd1\x8b\xd0\xb9 \xd1\x82\xd0\xb0\xd0\xba\xd0\xbe\xd0\xb9 \xd0\xbe\xd1\x82\xd1\x80\xd0\xb5\xd0\xb7\xd0\xbe\xd0\xba, \xd1\x82\xd0\xb5\xd0\xbc \xd0\xb1\xd0\xbe\xd0\xbb\xd0\xb5\xd0\xb5 \xd0\xbf\xd1\x80\xd0\xbe\xd0\xb4\xd1\x83\xd0\xba\xd1\x82\xd0\xb8\xd0\xb2\xd0\xbd\xd1\x8b\xd0\xbc \xd1\x81\xd0\xbe\xd1\x82\xd1\x80\xd1\x83\xd0\xb4\xd0\xbd\xd0\xb8\xd0\xba\xd0\xbe\xd0\xbc \xd0\xbe\xd0\xbd\xd0\xb0 \xd0\xb1\xd1\x83\xd0\xb4\xd0\xb5\xd1\x82 \xd1\x81\xd0\xb5\xd0\xb1\xd1\x8f \xd0\xbe\xd1\x89\xd1\x83\xd1\x89\xd0\xb0\xd1\x82\xd1\x8c.\xd0\x9d\xd0\xb5\xd0\xb4\xd0\xb0\xd0\xb2\xd0\xbd\xd0\xbe \xd0\x92\xd0\xb8\xd0\xba\xd0\xb0 \xd0\xbd\xd0\xb0\xd1\x88\xd0\xbb\xd0\xb0 \xd1\x81\xd0\xbf\xd0\xbe\xd1\x81\xd0\xbe\xd0\xb1 \xd0\xbf\xd0\xbe\xd0\xb4\xd0\xba\xd1\x80\xd1\x83\xd1\x82\xd0\xb8\xd1\x82\xd1\x8c \xd0\xb2\xd1\x80\xd0\xb5\xd0\xbc\xd1\x8f \xd0\xbb\xd1\x8e\xd0\xb1\xd0\xbe\xd0\xb3\xd0\xbe \xd0\xba\xd0\xbe\xd0\xbc\xd0\xbc\xd0\xb8\xd1\x82\xd0\xb0 \xd0\xb2\xd0\xbf\xd0\xb5\xd1\x80\xd1\x91\xd0\xb4, \xd0\xbd\xd0\xbe \xd0\xbd\xd0\xb5 \xd0\xb1\xd0\xbe\xd0\xbb\xd0\xb5\xd0\xb5 \xd1\x87\xd0\xb5\xd0\xbc \xd0\xbd\xd0\xb0 \xd1\x81\xd1\x83\xd1\x82\xd0\xba\xd0\xb8. \xd0\xa2\xd0\xb0\xd0\xba\xd0\xb8\xd0\xbc \xd0\xbe\xd0\xb1\xd1\x80\xd0\xb0\xd0\xb7\xd0\xbe\xd0\xbc, i-\xd0\xb9 \xd0\xba\xd0\xbe\xd0\xbc\xd0\xbc\xd0\xb8\xd1\x82 \xd1\x82\xd0\xb5\xd0\xbf\xd0\xb5\xd1\x80\xd1\x8c \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xb5\xd1\x82 \xd0\xb1\xd1\x8b\xd1\x82\xd1\x8c \xc2\xab\xd1\x81\xd0\xb4\xd0\xb5\xd0\xbb\xd0\xb0\xd0\xbd\xc2\xbb \xd0\xbb\xd0\xb8\xd0\xb1\xd0\xbe \xd0\xb2 ai-\xd0\xb9, \xd0\xbb\xd0\xb8\xd0\xb1\xd0\xbe \xd0\xb2 (ai+1)-\xd0\xb9 \xd0\xb4\xd0\xb5\xd0\xbd\xd1\x8c. \xd0\x92\xd1\x80\xd0\xb5\xd0\xbc\xd1\x8f \xd0\xba\xd0\xb0\xd0\xb6\xd0\xb4\xd0\xbe\xd0\xb3\xd0\xbe \xd0\xba\xd0\xbe\xd0\xbc\xd0\xbc\xd0\xb8\xd1\x82\xd0\xb0 \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xbd\xd0\xbe \xd0\xbf\xd0\xbe\xd0\xb4\xd0\xba\xd1\x80\xd1\x83\xd1\x82\xd0\xb8\xd1\x82\xd1\x8c \xd0\xbd\xd0\xb5\xd0\xb7\xd0\xb0\xd0\xb2\xd0\xb8\xd1\x81\xd0\xb8\xd0\xbc\xd0\xbe \xd0\xbe\xd1\x82 \xd0\xb4\xd1\x80\xd1\x83\xd0\xb3\xd0\xb8\xd1\x85 \xe2\x80\x94 \xd0\xb2 \xd1\x87\xd0\xb0\xd1\x81\xd1\x82\xd0\xbd\xd0\xbe\xd1\x81\xd1\x82\xd0\xb8, \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xbd\xd0\xbe \xd0\xba\xd0\xb0\xd0\xba \xd0\xbe\xd1\x81\xd1\x82\xd0\xb0\xd0\xb2\xd0\xb8\xd1\x82\xd1\x8c \xd0\xb2\xd1\x81\xd0\xb5\xd0\xbc \xd0\xba\xd0\xbe\xd0\xbc\xd0\xbc\xd0\xb8\xd1\x82\xd0\xb0\xd0\xbc \xd0\xb8\xd1\x81\xd1\x85\xd0\xbe\xd0\xb4\xd0\xbd\xd0\xbe\xd0\xb5 \xd0\xb2\xd1\x80\xd0\xb5\xd0\xbc\xd1\x8f, \xd1\x82\xd0\xb0\xd0\xba \xd0\xb8 \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb5\xd0\xbd\xd0\xb5\xd1\x81\xd1\x82\xd0\xb8 \xd0\xb2\xd1\x81\xd0\xb5 \xd0\xba\xd0\xbe\xd0\xbc\xd0\xbc\xd0\xb8\xd1\x82\xd1\x8b \xd1\x80\xd0\xbe\xd0\xb2\xd0\xbd\xd0\xbe \xd0\xbd\xd0\xb0 \xd0\xb4\xd0\xb5\xd0\xbd\xd1\x8c \xd0\xb2\xd0\xbf\xd0\xb5\xd1\x80\xd1\x91\xd0\xb4.\xd0\x9d\xd0\xb0\xd0\xb9\xd0\xb4\xd0\xb8\xd1\x82\xd0\xb5 \xd0\xb4\xd0\xbb\xd0\xb8\xd0\xbd\xd1\x83 \xd1\x81\xd0\xb0\xd0\xbc\xd0\xbe\xd0\xb3\xd0\xbe \xd0\xb4\xd0\xbb\xd0\xb8\xd0\xbd\xd0\xbd\xd0\xbe\xd0\xb3\xd0\xbe \xd0\xb2\xd0\xbe\xd0\xb7\xd0\xbc\xd0\xbe\xd0\xb6\xd0\xbd\xd0\xbe\xd0\xb3\xd0\xbe \xd0\xbe\xd1\x82\xd1\x80\xd0\xb5\xd0\xb7\xd0\xba\xd0\xb0 \xd0\xbf\xd0\xbe\xd0\xb4\xd1\x80\xd1\x8f\xd0\xb4 \xd0\xb8\xd0\xb4\xd1\x83\xd1\x89\xd0\xb8\xd1\x85 \xd0\xb4\xd0\xbd\xd0\xb5\xd0\xb9, \xd0\xb2 \xd0\xba\xd0\xb0\xd0\xb6\xd0\xb4\xd1\x8b\xd0\xb9 \xd0\xb8\xd0\xb7 \xd0\xba\xd0\xbe\xd1\x82\xd0\xbe\xd1\x80\xd1\x8b\xd1\x85 \xd1\x83 \xd0\x92\xd0\xb8\xd0\xba\xd0\xb8 \xd0\xb2 \xd0\xbf\xd1\x80\xd0\xbe\xd1\x84\xd0\xb8\xd0\xbb\xd0\xb5 \xd0\xb1\xd1\x83\xd0\xb4\xd0\xb5\xd1\x82 \xd0\xbe\xd1\x82\xd0\xbe\xd0\xb1\xd1\x80\xd0\xb0\xd0\xb6\xd0\xb0\xd1\x82\xd1\x8c\xd1\x81\xd1\x8f \xd1\x85\xd0\xbe\xd1\x82\xd1\x8f \xd0\xb1\xd1\x8b \xd0\xbe\xd0\xb4\xd0\xb8\xd0\xbd \xd0\xba\xd0\xbe\xd0\xbc\xd0\xbc\xd0\xb8\xd1\x82, \xd0\xbf\xd0\xbe\xd1\x81\xd0\xbb\xd0\xb5 \xd0\xb2\xd0\xbe\xd0\xb7\xd0\xbc\xd0\xbe\xd0\xb6\xd0\xbd\xd0\xbe\xd0\xb9 \xd0\xbf\xd0\xbe\xd0\xb4\xd0\xba\xd1\x80\xd1\x83\xd1\x82\xd0\xba\xd0\xb8 \xd0\xb2\xd1\x80\xd0\xb5\xd0\xbc\xd0\xb5\xd0\xbd\xd0\xb8 \xd0\xbd\xd0\xb5\xd0\xba\xd0\xbe\xd1\x82\xd0\xbe\xd1\x80\xd1\x8b\xd1\x85 \xd0\xba\xd0\xbe\xd0\xbc\xd0\xbc\xd0\xb8\xd1\x82\xd0\xbe\xd0\xb2." "*special problem,brute force,dp,greedy" 1200
1949G Scooter "The Czech Technical University campus consists of n buildings, indexed from 1 to n. In each building, there can be a math class scheduled, or a computer science class, or neither (but not both). Additionally, in each building, there is at most one professor, and each professor is either an expert in mathematics or in computer science.As an intern at University Express Inc., your job is to quickly transport the professors to their classes. For this, you have been granted a brand new two-person scooter, able to accommodate yourself, plus at most one passenger.Initially, you are the only person on the scooter. When you arrive at a building, you may drop off or pick up professors to/from that building. However, in order to improve the efficiency of your task, you are allowed to drive to each of the n buildings at most once, in the order of your choice (you can also decide where to start the itinerary). After the end of your itinerary, in each building where a math class is scheduled, there must be a professor expert in math, and in each building where a computer science class is scheduled, there must be a professor expert in computer science.Devise an itinerary that makes it possible to teach all classes." graphs,greedy 2300
2035G2 "Go Learn! (Hard Version)" "The differences between the easy and hard versions are the constraints on n and the sum of n. In this version, n\xe2\x89\xa43\xe2\x8b\x85105 and the sum of n does not exceed 106. You can only make hacks if both versions are solved. Well, well, well, let\'s see how Bessie is managing her finances. She seems to be in the trenches! Fortunately, she is applying for a job at Moogle to resolve this issue. Moogle interviews require intensive knowledge of obscure algorithms and complex data structures, but Bessie received a tip-off from an LGM on exactly what she has to go learn.Bessie wrote the following code to binary search for a certain element k in a possibly unsorted array [a1,a2,\xe2\x80\xa6,an] with n elements.let l = 1let h = nwhile l < h:  let m = floor((l + h) / 2)  if a[m] < k:    l = m + 1  else:    h = mreturn lBessie submitted her code to Farmer John\'s problem with m (1\xe2\x89\xa4m\xe2\x89\xa4n) tests. The i-th test is of the form (xi,ki) (1\xe2\x89\xa4x,k\xe2\x89\xa4n). It is guaranteed all the xi are distinct and all the ki are distinct.Test i is correct if the following hold:  The xi-th element in the array is ki.  If Bessie calls the binary search as shown in the above code for ki, it will return xi. It might not be possible for all m tests to be correct on the same array, so Farmer John will remove some of them so Bessie can AC. Let r be the minimum of tests removed so that there exists an array [a1,a2,\xe2\x80\xa6,an] with 1\xe2\x89\xa4ai\xe2\x89\xa4n so that all remaining tests are correct. In addition to finding r, Farmer John wants you to count the number of arrays [a1,a2,\xe2\x80\xa6,an] with 1\xe2\x89\xa4ai\xe2\x89\xa4n such that there exists a way to remove exactly r tests so that all the remaining tests are correct. Since this number may be very large, please find it modulo 998244353." "divide and conquer,dp" 3500
1256D "Binary String Minimizing" "You are given a binary string of length n (i.\xe2\x80\x89e. a string consisting of n characters \'0\' and \'1\').In one move you can swap two adjacent characters of the string. What is the lexicographically minimum possible string you can obtain from the given one if you can perform no more than k moves? It is possible that you do not perform any moves at all.Note that you can swap the same pair of adjacent characters with indices i and i+1 arbitrary (possibly, zero) number of times. Each such swap is considered a separate move.You have to answer q independent test cases." greedy 1500
1929A "Sasha and the Beautiful Array" "Sasha decided to give his girlfriend an array a1,a2,\xe2\x80\xa6,an. He found out that his girlfriend evaluates the beauty of the array as the sum of the values (ai\xe2\x88\x92ai\xe2\x88\x921) for all integers i from 2 to n.Help Sasha and tell him the maximum beauty of the array a that he can obtain, if he can rearrange its elements in any way." "constructive algorithms,greedy,math,sortings" 800
1369A FashionabLee "Lee is going to fashionably decorate his house for a party, using some regular convex polygons...Lee thinks a regular n-sided (convex) polygon is beautiful if and only if he can rotate it in such a way that at least one of its edges is parallel to the OX-axis and at least one of its edges is parallel to the OY-axis at the same time.Recall that a regular n-sided polygon is a convex polygon with n vertices such that all the edges and angles are equal.Now he is shopping: the market has t regular polygons. For each of them print YES if it is beautiful and NO otherwise." geometry,math 800
1430G "Yet Another DAG Problem" "You are given a directed acyclic graph (a directed graph that does not contain cycles) of n vertices and m arcs. The i-th arc leads from the vertex xi to the vertex yi and has the weight wi.Your task is to select an integer av for each vertex v, and then write a number bi on each arcs i such that bi=axi\xe2\x88\x92ayi. You must select the numbers so that:  all bi are positive;  the value of the expression m\xe2\x88\x91i=1wibi is the lowest possible. It can be shown that for any directed acyclic graph with non-negative wi, such a way to choose numbers exists." "bitmasks,dfs and similar,dp,flows,graphs,math" 2600
58A "Chat room" "Vasya has recently learned to type and log on to the Internet. He immediately entered a chat room and decided to say hello to everybody. Vasya typed the word s. It is considered that Vasya managed to say hello if several letters can be deleted from the typed word so that it resulted in the word ""hello"". For example, if Vasya types the word ""ahhellllloou"", it will be considered that he said hello, and if he types ""hlelo"", it will be considered that Vasya got misunderstood and he didn\'t manage to say hello. Determine whether Vasya managed to say hello by the given word s." greedy,strings 1000
486A "Calculating Function" "For a positive integer n let\'s define a function f:f(n)\xe2\x80\x89=\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x892\xe2\x80\x89-\xe2\x80\x893\xe2\x80\x89+\xe2\x80\x89..\xe2\x80\x89+\xe2\x80\x89(\xe2\x80\x89-\xe2\x80\x891)nn Your task is to calculate f(n) for a given integer n." implementation,math 800
1245D "Shichikuji and Power Grid" "Shichikuji is the new resident deity of the South Black Snail Temple. Her first job is as follows:There are n new cities located in Prefecture X. Cities are numbered from 1 to n. City i is located xi km North of the shrine and yi km East of the shrine. It is possible that (xi,yi)=(xj,yj) even when i\xe2\x89\xa0j.Shichikuji must provide electricity to each city either by building a power station in that city, or by making a connection between that city and another one that already has electricity. So the City has electricity if it has a power station in it or it is connected to a City which has electricity by a direct connection or via a chain of connections.    Building a power station in City i will cost ci yen;     Making a connection between City i and City j will cost ki+kj yen per km of wire used for the connection. However, wires can only go the cardinal directions (North, South, East, West). Wires can cross each other. Each wire must have both of its endpoints in some cities. If City i and City j are connected by a wire, the wire will go through any shortest path from City i to City j. Thus, the length of the wire if City i and City j are connected is |xi\xe2\x88\x92xj|+|yi\xe2\x88\x92yj| km. Shichikuji wants to do this job spending as little money as possible, since according to her, there isn\'t really anything else in the world other than money. However, she died when she was only in fifth grade so she is not smart enough for this. And thus, the new resident deity asks for your help.And so, you have to provide Shichikuji with the following information: minimum amount of yen needed to provide electricity to all cities, the cities in which power stations will be built, and the connections to be made.If there are multiple ways to choose the cities and the connections to obtain the construction of minimum price, then print any of them." "dsu,graphs,greedy,shortest paths,trees" 1900
1152F1 "Neko Rules the Catniverse (Small Version)" "This problem is same as the next one, but has smaller constraints.Aki is playing a new video game. In the video game, he will control Neko, the giant cat, to fly between planets in the Catniverse.There are n planets in the Catniverse, numbered from 1 to n. At the beginning of the game, Aki chooses the planet where Neko is initially located. Then Aki performs k\xe2\x88\x921 moves, where in each move Neko is moved from the current planet x to some other planet y such that:  Planet y is not visited yet.  1\xe2\x89\xa4y\xe2\x89\xa4x+m (where m is a fixed constant given in the input) This way, Neko will visit exactly k different planets. Two ways of visiting planets are called different if there is some index i such that the i-th planet visited in the first way is different from the i-th planet visited in the second way.What is the total number of ways to visit k planets this way? Since the answer can be quite large, print it modulo 109+7." bitmasks,dp,matrices 2800
52C "Circular RMQ" "You are given circular array a0,\xe2\x80\x89a1,\xe2\x80\x89...,\xe2\x80\x89an\xe2\x80\x89-\xe2\x80\x891. There are two types of operations with it:   inc(lf,\xe2\x80\x89rg,\xe2\x80\x89v) \xe2\x80\x94 this operation increases each element on the segment [lf,\xe2\x80\x89rg] (inclusively) by v;  rmq(lf,\xe2\x80\x89rg) \xe2\x80\x94 this operation returns minimal value on the segment [lf,\xe2\x80\x89rg] (inclusively). Assume segments to be circular, so if n\xe2\x80\x89=\xe2\x80\x895 and lf\xe2\x80\x89=\xe2\x80\x893,\xe2\x80\x89rg\xe2\x80\x89=\xe2\x80\x891, it means the index sequence: 3,\xe2\x80\x894,\xe2\x80\x890,\xe2\x80\x891.Write program to process given sequence of operations." "data structures" 2200
1578G "Game of Chance" "The King wants to marry off his daughter, and he wants her husband to have the greatest innate luckiness possible. To find such a person he decided to hold a heads-or-tails tournament. If person A with luckiness x and person B with luckiness y play heads-or-tails against each other, person A wins with probability x/(x+y). The tournament has several rounds. Each round some participants are split into pairs. Each pair plays against each other, and the loser leaves the tournament. The participants are numbered from 1 to n. During the first round, a number k (1\xe2\x89\xa4k\xe2\x89\xa4n) is selected such that n\xe2\x88\x92k/2 is a power of 2 (such k always exists and is unique). Only participants numbered from 1 to k take part in the first round. It ensures that in all other rounds the number of participants is the power of 2. During other rounds, all the participants who still have not left the tournament take part. If during some round, participants numbered p1<\xe2\x80\xa6<p2m take part, then they are split into pairs in the following manner: participant p2i\xe2\x88\x921 plays against participant p2i for each i from 1 to m. The rounds are held until only one participant is left. He is declared the winner of the tournament and he will marry the King\'s daughter. The princess can\'t wait to find out who is her future husband. She asked every participant to tell her his luckiness. Assuming they did not lie, she wants to know the probability of each participant winning the tournament. As you are the best friend of the princess, she asks you to help her." math,probabilities 3500
1184A2 "Heidi Learns Hashing (Medium)" "After learning about polynomial hashing, Heidi decided to learn about shift-xor hashing. In particular, she came across this interesting problem.Given a bitstring y\xe2\x88\x88{0,1}n find out the number of different k (0\xe2\x89\xa4k<n) such that there exists x\xe2\x88\x88{0,1}n for which y=x\xe2\x8a\x95shiftk(x).In the above, \xe2\x8a\x95 is the xor operation and shiftk is the operation of shifting a bitstring cyclically to the right k times. For example, 001\xe2\x8a\x95111=110 and shift3(00010010111000)=00000010010111." "brute force,number theory" 2100
1422F "Boring Queries" "Yura owns a quite ordinary and boring array a of length n. You think there is nothing more boring than that, but Vladik doesn\'t agree!In order to make Yura\'s array even more boring, Vladik makes q boring queries. Each query consists of two integers x and y. Before answering a query, the bounds l and r for this query are calculated: l=(last+x)modn+1, r=(last+y)modn+1, where last is the answer on the previous query (zero initially), and mod is the remainder operation. Whenever l>r, they are swapped.After Vladik computes l and r for a query, he is to compute the least common multiple (LCM) on the segment [l;r] of the initial array a modulo 109+7. LCM of a multiset of integers is the smallest positive integer that is divisible by all the elements of the multiset. The obtained LCM is the answer for this query.Help Vladik and compute the answer for each query!" "data structures,math,number theory" 2700
293E "Close Vertices" "You\'ve got a weighted tree, consisting of n vertices. Each edge has a non-negative weight. The length of the path between any two vertices of the tree is the number of edges in the path. The weight of the path is the total weight of all edges it contains. Two vertices are close if there exists a path of length at most l between them and a path of weight at most w between them. Count the number of pairs of vertices v,\xe2\x80\x89u (v\xe2\x80\x89<\xe2\x80\x89u), such that vertices v and u are close." "data structures,divide and conquer,trees" 2700
1933E "Turtle vs. Rabbit Race: Optimal Trainings" "Isaac begins his training. There are n running tracks available, and the i-th track (1\xe2\x89\xa4i\xe2\x89\xa4n) consists of ai equal-length sections. Given an integer u (1\xe2\x89\xa4u\xe2\x89\xa4109), finishing each section can increase Isaac\'s ability by a certain value, described as follows:   Finishing the 1-st section increases Isaac\'s performance by u.  Finishing the 2-nd section increases Isaac\'s performance by u\xe2\x88\x921.  Finishing the 3-rd section increases Isaac\'s performance by u\xe2\x88\x922.  \xe2\x80\xa6  Finishing the k-th section (k\xe2\x89\xa51) increases Isaac\'s performance by u+1\xe2\x88\x92k. (The value u+1\xe2\x88\x92k can be negative, which means finishing an extra section decreases Isaac\'s performance.)  You are also given an integer l. You must choose an integer r such that l\xe2\x89\xa4r\xe2\x89\xa4n and Isaac will finish each section of each track l,l+1,\xe2\x80\xa6,r (that is, a total of \xe2\x88\x91ri=lai=al+al+1+\xe2\x80\xa6+ar sections).Answer the following question: what is the optimal r you can choose that the increase in Isaac\'s performance is maximum possible? If there are multiple r that maximize the increase in Isaac\'s performance, output the smallest r.To increase the difficulty, you need to answer the question for q different values of l and u." "binary search,implementation,math,ternary search" 1500
1692C "Where\'s the Bishop?" "Mihai has an 8\xc3\x978 chessboard whose rows are numbered from 1 to 8 from top to bottom and whose columns are numbered from 1 to 8 from left to right.Mihai has placed exactly one bishop on the chessboard. The bishop is not placed on the edges of the board. (In other words, the row and column of the bishop are between 2 and 7, inclusive.)The bishop attacks in all directions diagonally, and there is no limit to the distance which the bishop can attack. Note that the cell on which the bishop is placed is also considered attacked.   An example of a bishop on a chessboard. The squares it attacks are marked in red. Mihai has marked all squares the bishop attacks, but forgot where the bishop was! Help Mihai find the position of the bishop." implementation 800
1469F "Power Sockets" "// We decided to drop the legend about the power sockets but feel free to come up with your own :^)Define a chain:   a chain of length 1 is a single vertex;  a chain of length x is a chain of length x\xe2\x88\x921 with a new vertex connected to the end of it with a single edge. You are given n chains of lengths l1,l2,\xe2\x80\xa6,ln. You plan to build a tree using some of them.  Each vertex of the tree is either white or black.  The tree initially only has a white root vertex.  All chains initially consist only of white vertices.  You can take one of the chains and connect any of its vertices to any white vertex of the tree with an edge. The chain becomes part of the tree. Both endpoints of this edge become black.  Each chain can be used no more than once.  Some chains can be left unused. The distance between two vertices of the tree is the number of edges on the shortest path between them.If there is at least k white vertices in the resulting tree, then the value of the tree is the distance between the root and the k-th closest white vertex.What\'s the minimum value of the tree you can obtain? If there is no way to build a tree with at least k white vertices, then print -1." "binary search,data structures,greedy" 2600
279A "Point on Spiral" "Valera the horse lives on a plane. The Cartesian coordinate system is defined on this plane. Also an infinite spiral is painted on the plane. The spiral consists of segments: [(0,\xe2\x80\x890),\xe2\x80\x89(1,\xe2\x80\x890)], [(1,\xe2\x80\x890),\xe2\x80\x89(1,\xe2\x80\x891)], [(1,\xe2\x80\x891),\xe2\x80\x89(\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x891)], [(\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x891),\xe2\x80\x89(\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x891)], [(\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x891),\xe2\x80\x89(2,\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x891)], [(2,\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x891),\xe2\x80\x89(2,\xe2\x80\x892)] and so on. Thus, this infinite spiral passes through each integer point of the plane.Valera the horse lives on the plane at coordinates (0,\xe2\x80\x890). He wants to walk along the spiral to point (x,\xe2\x80\x89y). Valera the horse has four legs, so he finds turning very difficult. Count how many times he will have to turn if he goes along a spiral from point (0,\xe2\x80\x890) to point (x,\xe2\x80\x89y)." "brute force,geometry,implementation" 1400
2035A Sliding "Red was ejected. They were not the imposter.There are n rows of m people. Let the position in the r-th row and the c-th column be denoted by (r,c). Number each person starting from 1 in row-major order, i.e., the person numbered (r\xe2\x88\x921)\xe2\x8b\x85m+c is initially at (r,c).The person at (r,c) decides to leave. To fill the gap, let the person who left be numbered i. Each person numbered j>i will move to the position where the person numbered j\xe2\x88\x921 is initially at. The following diagram illustrates the case where n=2, m=3, r=1, and c=2.   Calculate the sum of the Manhattan distances of each person\'s movement. If a person was initially at (r0,c0) and then moved to (r1,c1), the Manhattan distance is |r0\xe2\x88\x92r1|+|c0\xe2\x88\x92c1|." implementation,math 800
831B "Keyboard Layouts" "There are two popular keyboard layouts in Berland, they differ only in letters positions. All the other keys are the same. In Berland they use alphabet with 26 letters which coincides with English alphabet.You are given two strings consisting of 26 distinct letters each: all keys of the first and the second layouts in the same order. You are also given some text consisting of small and capital English letters and digits. It is known that it was typed in the first layout, but the writer intended to type it in the second layout. Print the text if the same keys were pressed in the second layout.Since all keys but letters are the same in both layouts, the capitalization of the letters should remain the same, as well as all other characters." implementation,strings 800
825C "Multi-judge Solving" "Makes solves problems on Decoforces and lots of other different online judges. Each problem is denoted by its difficulty \xe2\x80\x94 a positive integer number. Difficulties are measured the same across all the judges (the problem with difficulty d on Decoforces is as hard as the problem with difficulty d on any other judge). Makes has chosen n problems to solve on Decoforces with difficulties a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. He can solve these problems in arbitrary order. Though he can solve problem i with difficulty ai only if he had already solved some problem with difficulty  (no matter on what online judge was it).Before starting this chosen list of problems, Makes has already solved problems with maximum difficulty k.With given conditions it\'s easy to see that Makes sometimes can\'t solve all the chosen problems, no matter what order he chooses. So he wants to solve some problems on other judges to finish solving problems from his list. For every positive integer y there exist some problem with difficulty y on at least one judge besides Decoforces.Makes can solve problems on any judge at any time, it isn\'t necessary to do problems from the chosen list one right after another.Makes doesn\'t have too much free time, so he asked you to calculate the minimum number of problems he should solve on other judges in order to solve all the chosen problems from Decoforces." greedy,implementation 1600
1687B "Railway System" "As for the technology in the outside world, it is really too advanced for Gensokyo to even look up to.\xe2\x80\x94Yasaka Kanako, Symposium of Post-mysticismThis is an interactive problem.Under the direct supervision of Kanako and the Moriya Shrine, the railway system of Gensokyo is finally finished. GSKR (Gensokyo Railways) consists of n stations with m bidirectional tracks connecting them. The i-th track has length li (1\xe2\x89\xa4li\xe2\x89\xa4106). Due to budget limits, the railway system may not be connected, though there may be more than one track between two stations.The value of a railway system is defined as the total length of its all tracks. The maximum (or minimum) capacity of a railway system is defined as the maximum (or minimum) value among all of the currently functional system\'s full spanning forest.In brief, full spanning forest of a graph is a spanning forest with the same connectivity as the given graph.Kanako has a simulator only able to process no more than 2m queries. The input of the simulator is a string s of length m, consisting of characters 0 and/or 1. The simulator will assume the i-th track functional if si= 1. The device will then tell Kanako the maximum capacity of the system in the simulated state.Kanako wants to know the the minimum capacity of the system with all tracks functional with the help of the simulator.The structure of the railway system is fixed in advance. In other words, the interactor is not adaptive." "constructive algorithms,graphs,greedy,interactive,sortings" 1700
1452D "Radio Towers" "There are n+2 towns located on a coordinate line, numbered from 0 to n+1. The i-th town is located at the point i.You build a radio tower in each of the towns 1,2,\xe2\x80\xa6,n with probability 12 (these events are independent). After that, you want to set the signal power on each tower to some integer from 1 to n (signal powers are not necessarily the same, but also not necessarily different). The signal from a tower located in a town i with signal power p reaches every city c such that |c\xe2\x88\x92i|<p.After building the towers, you want to choose signal powers in such a way that:  towns 0 and n+1 don\'t get any signal from the radio towers;  towns 1,2,\xe2\x80\xa6,n get signal from exactly one radio tower each. For example, if n=5, and you have built the towers in towns 2, 4 and 5, you may set the signal power of the tower in town 2 to 2, and the signal power of the towers in towns 4 and 5 to 1. That way, towns 0 and n+1 don\'t get the signal from any tower, towns 1, 2 and 3 get the signal from the tower in town 2, town 4 gets the signal from the tower in town 4, and town 5 gets the signal from the tower in town 5.Calculate the probability that, after building the towers, you will have a way to set signal powers to meet all constraints." combinatorics,dp,math 1600
522D "Closest Equals" "You are given sequence a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an and m queries lj,\xe2\x80\x89rj (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89lj\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89rj\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n). For each query you need to print the minimum distance between such pair of elements ax and ay (x\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89y), that:  both indexes of the elements lie within range [lj,\xe2\x80\x89rj], that is, lj\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x,\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89rj;  the values of the elements are equal, that is ax\xe2\x80\x89=\xe2\x80\x89ay. The text above understands distance as |x\xe2\x80\x89-\xe2\x80\x89y|." "*special problem,data structures" 2000
1511A "Review Site" "You are an upcoming movie director, and you have just released your first movie. You have also launched a simple review site with two buttons to press \xe2\x80\x94 upvote and downvote.However, the site is not so simple on the inside. There are two servers, each with its separate counts for the upvotes and the downvotes.n reviewers enter the site one by one. Each reviewer is one of the following types:   type 1: a reviewer has watched the movie, and they like it \xe2\x80\x94 they press the upvote button;  type 2: a reviewer has watched the movie, and they dislike it \xe2\x80\x94 they press the downvote button;  type 3: a reviewer hasn\'t watched the movie \xe2\x80\x94 they look at the current number of upvotes and downvotes of the movie on the server they are in and decide what button to press. If there are more downvotes than upvotes, then a reviewer downvotes the movie. Otherwise, they upvote the movie. Each reviewer votes on the movie exactly once.Since you have two servers, you can actually manipulate the votes so that your movie gets as many upvotes as possible. When a reviewer enters a site, you know their type, and you can send them either to the first server or to the second one.What is the maximum total number of upvotes you can gather over both servers if you decide which server to send each reviewer to?" greedy 800
1922B "Forming Triangles" "You have n sticks, numbered from 1 to n. The length of the i-th stick is 2ai.You want to choose exactly 3 sticks out of the given n sticks, and form a non-degenerate triangle out of them, using the sticks as the sides of the triangle. A triangle is called non-degenerate if its area is strictly greater than 0.You have to calculate the number of ways to choose exactly 3 sticks so that a triangle can be formed out of them. Note that the order of choosing sticks does not matter (for example, choosing the 1-st, 2-nd and 4-th stick is the same as choosing the 2-nd, 4-th and 1-st stick)." "combinatorics,constructive algorithms,math,sortings" 1200
1674G "Remove Directed Edges" "You are given a directed acyclic graph, consisting of n vertices and m edges. The vertices are numbered from 1 to n. There are no multiple edges and self-loops.Let inv be the number of incoming edges (indegree) and outv be the number of outgoing edges (outdegree) of vertex v.You are asked to remove some edges from the graph. Let the new degrees be in\xe2\x80\xb2v and out\xe2\x80\xb2v.You are only allowed to remove the edges if the following conditions hold for every vertex v:   in\xe2\x80\xb2v<inv or in\xe2\x80\xb2v=inv=0;  out\xe2\x80\xb2v<outv or out\xe2\x80\xb2v=outv=0. Let\'s call a set of vertices S cute if for each pair of vertices v and u (v\xe2\x89\xa0u) such that v\xe2\x88\x88S and u\xe2\x88\x88S, there exists a path either from v to u or from u to v over the non-removed edges.What is the maximum possible size of a cute set S after you remove some edges from the graph and both indegrees and outdegrees of all vertices either decrease or remain equal to 0?" "dfs and similar,dp,graphs" 2000
23B Party "n people came to a party. Then those, who had no friends among people at the party, left. Then those, who had exactly 1 friend among those who stayed, left as well. Then those, who had exactly 2,\xe2\x80\x893,\xe2\x80\x89...,\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x891 friends among those who stayed by the moment of their leaving, did the same.What is the maximum amount of people that could stay at the party in the end?" "constructive algorithms,graphs,math" 1600
1573B Swaps "You are given two arrays a and b of length n. Array a contains each odd integer from 1 to 2n in an arbitrary order, and array b contains each even integer from 1 to 2n in an arbitrary order.You can perform the following operation on those arrays:   choose one of the two arrays  pick an index i from 1 to n\xe2\x88\x921  swap the i-th and the (i+1)-th elements of the chosen array  Compute the minimum number of operations needed to make array a lexicographically smaller than array b.For two different arrays x and y of the same length n, we say that x is lexicographically smaller than y if in the first position where x and y differ, the array x has a smaller element than the corresponding element in y." greedy,math,sortings 1400
633E "Startup Funding" "An e-commerce startup pitches to the investors to get funding. They have been functional for n weeks now and also have a website!For each week they know the number of unique visitors during this week vi and the revenue ci. To evaluate the potential of the startup at some range of weeks from l to r inclusive investors use the minimum among the maximum number of visitors multiplied by 100 and the minimum revenue during this period, that is: The truth is that investors have no idea how to efficiently evaluate the startup, so they are going to pick some k random distinct weeks li and give them to managers of the startup. For each li they should pick some ri\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89li and report maximum number of visitors and minimum revenue during this period.Then, investors will calculate the potential of the startup for each of these ranges and take minimum value of p(li,\xe2\x80\x89ri) as the total evaluation grade of the startup. Assuming that managers of the startup always report the optimal values of ri for some particular li, i.e., the value such that the resulting grade of the startup is maximized, what is the expected resulting grade of the startup?" "binary search,constructive algorithms,data structures,probabilities,two pointers" 2400
1211H "Road Repair in Treeland" "There are n cities and n\xe2\x88\x921 two-way roads in Treeland. Each road connects a pair of different cities. From any city you can drive to any other, moving only along the roads. Cities are numbered from 1 to n. Yes, of course, you recognized an undirected tree in this description.The government plans to repair all the roads. Each road will be repaired by some private company. In total, the country has 106 private companies that are numbered from 1 to 106. It is possible that some companies will not repair roads at all, and some will repair many roads.To simplify the control over the work of private companies, the following restriction was introduced: for each city, we calculate the number of different companies that repair roads that have this city at one end. This number for each city should not exceed 2. In other words, for each city, there should be no more than two different companies that repair roads related to this city.The National Anti-Corruption Committee of Treeland raises concerns that all (or almost all) of the work will go to one private company. For this reason, the committee requires that roads be distributed among companies in such a way as to minimize the value of r. For each company, we calculate the number of roads assigned to it, the maximum among all companies is called the number r.Help the government find such a way to distribute all roads among companies in the required way." "*special problem,binary search,dp,trees" 3100
1119B "Alyona and a Narrow Fridge" "Alyona has recently bought a miniature fridge that can be represented as a matrix with h rows and 2 columns. Initially there is only one shelf at the bottom of the fridge, but Alyona can install arbitrary number of shelves inside the fridge between any two rows. A shelf is two cells wide, does not occupy any space but separates the inside of the fridge to the lower and upper part.  An example of a fridge with h=7 and two shelves. The shelves are shown in black. The picture corresponds to the first example. Alyona has n bottles of milk that she wants to put in the fridge. The i-th bottle is ai cells tall and 1 cell wide. She can put a bottle on some shelf if the corresponding space above the shelf is at least as tall as the bottle. She can not put a bottle on top of another bottle (if there is no shelf between them). Two bottles can not share a cell.Alyona is interested in the largest integer k such that she can put bottles 1, 2, ..., k in the fridge at the same time. Find this largest k." "binary search,flows,greedy,sortings" 1300
1817D "Toy Machine" "There is a toy machine with toys arranged in two rows of n cells each (n is odd).  Initial state for n=9. Initially, n\xe2\x88\x922 toys are placed in the non-corner cells of the top row. The bottom row is initially empty, and its leftmost, rightmost, and central cells are blocked. There are 4 buttons to control the toy machine: left, right, up, and down marked by the letters L, R, U, and D correspondingly.When pressing L, R, U, or D, all the toys will be moved simultaneously in the corresponding direction and will only stop if they push into another toy, the wall or a blocked cell. Your goal is to move the k-th toy into the leftmost cell of the top row. The toys are numbered from 1 to n\xe2\x88\x922 from left to right. Given n and k, find a solution that uses at most 1000000 button presses.To test out the toy machine, a web page is available that lets you play the game in real time." "constructive algorithms,games,implementation" 2700
54E "Vacuum \xd0\xa1leaner" "One winter evening the Hedgehog was relaxing at home in his cozy armchair and clicking through the TV channels. Stumbled on an issue of \xc2\xabTopShop\xc2\xbb, the Hedgehog was about to change the channel when all of a sudden he was stopped by an advertisement of a new wondrous invention.Actually, a vacuum cleaner was advertised there. It was called Marvellous Vacuum and it doesn\'t even need a human to operate it while it cleans! The vacuum cleaner can move around the flat on its own: it moves in some direction and if it hits an obstacle there, it automatically chooses a new direction. Sooner or later this vacuum cleaner will travel through all the room and clean it all. Having remembered how much time the Hedgehog spends every time on cleaning (surely, no less than a half of the day), he got eager to buy this wonder.However, the Hedgehog quickly understood that the cleaner has at least one weak point: it won\'t clean well in the room\'s corners because it often won\'t able to reach the corner due to its shape. To estimate how serious is this drawback in practice, the Hedgehog asked you to write for him the corresponding program.You will be given the cleaner\'s shape in the top view. We will consider only the cases when the vacuum cleaner is represented as a convex polygon. The room is some infinitely large rectangle. We consider one corner of this room and want to find such a rotation of the vacuum cleaner so that it, being pushed into this corner, will leave the minimum possible area in the corner uncovered." geometry 2700
1209G2 "Into Blocks (hard version)" "This is a harder version of the problem. In this version q\xe2\x89\xa4200000.A sequence of integers is called nice if its elements are arranged in blocks like in [3,3,3,4,1,1]. Formally, if two elements are equal, everything in between must also be equal.Let\'s define difficulty of a sequence as a minimum possible number of elements to change to get a nice sequence. However, if you change at least one element of value x to value y, you must also change all other elements of value x into y as well. For example, for [3,3,1,3,2,1,2] it isn\'t allowed to change first 1 to 3 and second 1 to 2. You need to leave 1\'s untouched or change them to the same value.You are given a sequence of integers a1,a2,\xe2\x80\xa6,an and q updates.Each update is of form ""i x"" \xe2\x80\x94 change ai to x. Updates are not independent (the change stays for the future).Print the difficulty of the initial sequence and of the sequence after every update." "data structures" 3200
1660E "Matrix and Shifts" "You are given a binary matrix A of size n\xc3\x97n. Rows are numbered from top to bottom from 1 to n, columns are numbered from left to right from 1 to n. The element located at the intersection of row i and column j is called Aij. Consider a set of 4 operations:  Cyclically shift all rows up. The row with index i will be written in place of the row i\xe2\x88\x921 (2\xe2\x89\xa4i\xe2\x89\xa4n), the row with index 1 will be written in place of the row n.  Cyclically shift all rows down. The row with index i will be written in place of the row i+1 (1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921), the row with index n will be written in place of the row 1.  Cyclically shift all columns to the left. The column with index j will be written in place of the column j\xe2\x88\x921 (2\xe2\x89\xa4j\xe2\x89\xa4n), the column with index 1 will be written in place of the column n.  Cyclically shift all columns to the right. The column with index j will be written in place of the column j+1 (1\xe2\x89\xa4j\xe2\x89\xa4n\xe2\x88\x921), the column with index n will be written in place of the column 1.   The 3\xc3\x973 matrix is shown on the left before the 3-rd operation is applied to it, on the right \xe2\x80\x94 after. You can perform an arbitrary (possibly zero) number of operations on the matrix; the operations can be performed in any order.After that, you can perform an arbitrary (possibly zero) number of new xor-operations:  Select any element Aij and assign it with new value Aij\xe2\x8a\x951. In other words, the value of (Aij+1)mod2 will have to be written into element Aij. Each application of this xor-operation costs one burl. Note that the 4 shift operations \xe2\x80\x94 are free. These 4 operations can only be performed before xor-operations are performed.Output the minimum number of burles you would have to pay to make the A matrix unitary. A unitary matrix is a matrix with ones on the main diagonal and the rest of its elements are zeros (that is, Aij=1 if i=j and Aij=0 otherwise)." "brute force,constructive algorithms,greedy,implementation" 1600
1765A "Access Levels" "BerSoft is the biggest IT corporation in Berland, and Monocarp is the head of its security department. This time, he faced the most difficult task ever. Basically, there are n developers working at BerSoft, numbered from 1 to n. There are m documents shared on the internal network, numbered from 1 to m. There is a table of access requirements a such that ai,j (the j-th element of the i-th row) is 1 if the i-th developer should have access to the j-th document, and 0 if they should have no access to it.In order to restrict the access, Monocarp is going to perform the following actions:   choose the number of access groups k\xe2\x89\xa51;  assign each document an access group (an integer from 1 to k) and the required access level (an integer from 1 to 109);  assign each developer k integer values (from 1 to 109) \xe2\x80\x94 their access levels for each of the access groups. The developer i has access to the document j if their access level for the access group of the document is greater than or equal to the required access level of the document.What\'s the smallest number of access groups Monocarp can choose so that it\'s possible to assign access groups and access levels in order to satisfy the table of access requirements?" "bitmasks,dsu,flows,graph matchings" 2400
689B "Mike and Shortcuts" "Recently, Mike was very busy with studying for exams and contests. Now he is going to chill a bit by doing some sight seeing in the city.City consists of n intersections numbered from 1 to n. Mike starts walking from his house located at the intersection number 1 and goes along some sequence of intersections. Walking from intersection number i to intersection j requires |i\xe2\x80\x89-\xe2\x80\x89j| units of energy. The total energy spent by Mike to visit a sequence of intersections p1\xe2\x80\x89=\xe2\x80\x891,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pk is equal to  units of energy.Of course, walking would be boring if there were no shortcuts. A shortcut is a special path that allows Mike walking from one intersection to another requiring only 1 unit of energy. There are exactly n shortcuts in Mike\'s city, the ith of them allows walking from intersection i to intersection ai (i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ai\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x891) (but not in the opposite direction), thus there is exactly one shortcut starting at each intersection. Formally, if Mike chooses a sequence p1\xe2\x80\x89=\xe2\x80\x891,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pk then for each 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89k satisfying pi\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89=\xe2\x80\x89api and api\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89pi Mike will spend only 1 unit of energy instead of |pi\xe2\x80\x89-\xe2\x80\x89pi\xe2\x80\x89+\xe2\x80\x891| walking from the intersection pi to intersection pi\xe2\x80\x89+\xe2\x80\x891. For example, if Mike chooses a sequence p1\xe2\x80\x89=\xe2\x80\x891,\xe2\x80\x89p2\xe2\x80\x89=\xe2\x80\x89ap1,\xe2\x80\x89p3\xe2\x80\x89=\xe2\x80\x89ap2,\xe2\x80\x89...,\xe2\x80\x89pk\xe2\x80\x89=\xe2\x80\x89apk\xe2\x80\x89-\xe2\x80\x891, he spends exactly k\xe2\x80\x89-\xe2\x80\x891 units of total energy walking around them.Before going on his adventure, Mike asks you to find the minimum amount of energy required to reach each of the intersections from his home. Formally, for each 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n Mike is interested in finding minimum possible total energy of some sequence p1\xe2\x80\x89=\xe2\x80\x891,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pk\xe2\x80\x89=\xe2\x80\x89i." "dfs and similar,graphs,greedy,shortest paths" 1600
1334E "Divisor Paths" "You are given a positive integer D. Let\'s build the following graph from it:   each vertex is a divisor of D (not necessarily prime, 1 and D itself are also included);  two vertices x and y (x>y) have an undirected edge between them if x is divisible by y and xy is a prime;  the weight of an edge is the number of divisors of x that are not divisors of y. For example, here is the graph for D=12:   Edge (4,12) has weight 3 because 12 has divisors [1,2,3,4,6,12] and 4 has divisors [1,2,4]. Thus, there are 3 divisors of 12 that are not divisors of 4 \xe2\x80\x94 [3,6,12].There is no edge between 3 and 2 because 3 is not divisible by 2. There is no edge between 12 and 3 because 123=4 is not a prime.Let the length of the path between some vertices v and u in the graph be the total weight of edges on it. For example, path [(1,2),(2,6),(6,12),(12,4),(4,2),(2,6)] has length 1+2+2+3+1+2=11. The empty path has length 0.So the shortest path between two vertices v and u is the path that has the minimal possible length.Two paths a and b are different if there is either a different number of edges in them or there is a position i such that ai and bi are different edges.You are given q queries of the following form:   v u \xe2\x80\x94 calculate the number of the shortest paths between vertices v and u. The answer for each query might be large so print it modulo 998244353." "combinatorics,graphs,greedy,math,number theory" 2200
1951C "Ticket Hoarding" "Ma\xc3\xaetre Gims - Est-ce que tu m\'aimes ?\xe0\xb6\x9eAs the CEO of a startup company, you want to reward each of your k employees with a ticket to the upcoming concert. The tickets will be on sale for n days, and by some time travelling, you have predicted that the price per ticket at day i will be ai. However, to prevent ticket hoarding, the concert organizers have implemented the following measures:  A person may purchase no more than m tickets per day.  If a person purchases x tickets on day i, all subsequent days (i.e. from day i+1 onwards) will have their prices per ticket increased by x. For example, if a=[1,3,8,4,5] and you purchase 2 tickets on day 1, they will cost 2 in total, and the prices from day 2 onwards will become [5,10,6,7]. If you then purchase 3 more tickets on day 2, they will cost in total an additional 15, and the prices from day 3 onwards will become [13,9,10].Find the minimum spending to purchase k tickets." greedy,math,sortings 1400
1967B2 "Reverse Card (Hard Version)" "The two versions are different problems. You may want to read both versions. You can make hacks only if both versions are solved.You are given two positive integers n, m.Calculate the number of ordered pairs (a,b) satisfying the following conditions:  1\xe2\x89\xa4a\xe2\x89\xa4n, 1\xe2\x89\xa4b\xe2\x89\xa4m;  b\xe2\x8b\x85gcd(a,b) is a multiple of a+b." "brute force,math,number theory" 2200
1909B "Make Almost Equal With Mod" "xi - Solar Storm\xe2\xa0\x80You are given an array a1,a2,\xe2\x80\xa6,an of distinct positive integers. You have to do the following operation exactly once:  choose a positive integer k;  for each i from 1 to n, replace ai with ai mod k\xe2\x80\xa0. Find a value of k such that 1\xe2\x89\xa4k\xe2\x89\xa41018 and the array a1,a2,\xe2\x80\xa6,an contains exactly 2 distinct values at the end of the operation. It can be shown that, under the constraints of the problem, at least one such k always exists. If there are multiple solutions, you can print any of them.\xe2\x80\xa0 a mod b denotes the remainder after dividing a by b. For example:   7 mod 3=1 since 7=3\xe2\x8b\x852+1  15 mod 4=3 since 15=4\xe2\x8b\x853+3  21 mod 1=0 since 21=21\xe2\x8b\x851+0" "bitmasks,constructive algorithms,math,number theory" 1200
918B "Radio Station" "As the guys fried the radio station facilities, the school principal gave them tasks as a punishment. Dustin\'s task was to add comments to nginx configuration for school\'s website. The school has n servers. Each server has a name and an ip (names aren\'t necessarily unique, but ips are). Dustin knows the ip and name of each server. For simplicity, we\'ll assume that an nginx command is of form ""command ip;"" where command is a string consisting of English lowercase letter only, and ip is the ip of one of school servers.  Each ip is of form ""a.b.c.d"" where a, b, c and d are non-negative integers less than or equal to 255 (with no leading zeros). The nginx configuration file Dustin has to add comments to has m commands. Nobody ever memorizes the ips of servers, so to understand the configuration better, Dustin has to comment the name of server that the ip belongs to at the end of each line (after each command). More formally, if a line is ""command ip;"" Dustin has to replace it with ""command ip; #name"" where name is the name of the server with ip equal to ip.Dustin doesn\'t know anything about nginx, so he panicked again and his friends asked you to do his task for him." implementation,strings 900
1009D "Relatively Prime Graph" "Let\'s call an undirected graph G=(V,E) relatively prime if and only if for each edge (v,u)\xe2\x88\x88E  GCD(v,u)=1 (the greatest common divisor of v and u is 1). If there is no edge between some pair of vertices v and u then the value of GCD(v,u) doesn\'t matter. The vertices are numbered from 1 to |V|.Construct a relatively prime graph with n vertices and m edges such that it is connected and it contains neither self-loops nor multiple edges.If there exists no valid graph with the given number of vertices and edges then output ""Impossible"".If there are multiple answers then print any of them." "brute force,constructive algorithms,graphs,greedy,math" 1700
730G "Car Repair Shop" "Polycarp starts his own business. Tomorrow will be the first working day of his car repair shop. For now the car repair shop is very small and only one car can be repaired at a given time.Polycarp is good at marketing, so he has already collected n requests from clients. The requests are numbered from 1 to n in order they came.The i-th request is characterized by two values: si \xe2\x80\x94 the day when a client wants to start the repair of his car, di \xe2\x80\x94 duration (in days) to repair the car. The days are enumerated from 1, the first day is tomorrow, the second day is the day after tomorrow and so on.Polycarp is making schedule by processing requests in the order from the first to the n-th request. He schedules the i-th request as follows:  If the car repair shop is idle for di days starting from si (si,\xe2\x80\x89si\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89si\xe2\x80\x89+\xe2\x80\x89di\xe2\x80\x89-\xe2\x80\x891), then these days are used to repair a car of the i-th client.  Otherwise, Polycarp finds the first day x (from 1 and further) that there are di subsequent days when no repair is scheduled starting from x. In other words he chooses the smallest positive x that all days x,\xe2\x80\x89x\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89x\xe2\x80\x89+\xe2\x80\x89di\xe2\x80\x89-\xe2\x80\x891 are not scheduled for repair of any car. So, the car of the i-th client will be repaired in the range [x,\xe2\x80\x89x\xe2\x80\x89+\xe2\x80\x89di\xe2\x80\x89-\xe2\x80\x891]. It is possible that the day x when repair is scheduled to start will be less than si. Given n requests, you are asked to help Polycarp schedule all of them according to the rules above." implementation 1600
1459A "Red-Blue Shuffle" "There are n cards numbered 1,\xe2\x80\xa6,n. The card i has a red digit ri and a blue digit bi written on it.We arrange all n cards in random order from left to right, with all permutations of 1,\xe2\x80\xa6,n having the same probability. We then read all red digits on the cards from left to right, and obtain an integer R. In the same way, we read all blue digits and obtain an integer B. When reading a number, leading zeros can be ignored. If all digits in a number are zeros, then the number is equal to 0. Below is an illustration of a possible rearrangement of three cards, and how R and B can be found.  Two players, Red and Blue, are involved in a bet. Red bets that after the shuffle R>B, and Blue bets that R<B. If in the end R=B, the bet results in a draw, and neither player wins.Determine, which of the two players is more likely (has higher probability) to win the bet, or that their chances are equal. Refer to the Note section for a formal discussion of comparing probabilities." math,probabilities 800
508C "Anya and Ghosts" "Anya loves to watch horror movies. In the best traditions of horror, she will be visited by m ghosts tonight. Anya has lots of candles prepared for the visits, each candle can produce light for exactly t seconds. It takes the girl one second to light one candle. More formally, Anya can spend one second to light one candle, then this candle burns for exactly t seconds and then goes out and can no longer be used.For each of the m ghosts Anya knows the time at which it comes: the i-th visit will happen wi seconds after midnight, all wi\'s are distinct. Each visit lasts exactly one second.What is the minimum number of candles Anya should use so that during each visit, at least r candles are burning? Anya can start to light a candle at any time that is integer number of seconds from midnight, possibly, at the time before midnight. That means, she can start to light a candle integer number of seconds before midnight or integer number of seconds after a midnight, or in other words in any integer moment of time." "constructive algorithms,greedy" 1600
1650F "Vitaly and Advanced Useless Algorithms" "Vitaly enrolled in the course Advanced Useless Algorithms. The course consists of n tasks. Vitaly calculated that he has ai hours to do the task i from the day he enrolled in the course. That is, the deadline before the i-th task is ai hours. The array a is sorted in ascending order, in other words, the job numbers correspond to the order in which the assignments are turned in.Vitaly does everything conscientiously, so he wants to complete each task by 100 percent, or more. Initially, his completion rate for each task is 0 percent.Vitaly has m training options, each option can be used not more than once. The ith option is characterized by three integers: ei,ti and pi. If Vitaly uses the ith option, then after ti hours (from the current moment) he will increase the progress of the task ei by pi percent. For example, let Vitaly have 3 of tasks to complete. Let the array a have the form: a=[5,7,8]. Suppose Vitaly has 5 of options: [e1=1,t1=1,p1=30], [e2=2,t2=3,p2=50], [e3=2,t3=3,p3=100], [e4=1,t4=1,p4=80], [e5=3,t5=3,p5=100]. Then, if Vitaly prepares in the following way, he will be able to complete everything in time:   Vitaly chooses the 4-th option. Then in 1 hour, he will complete the 1-st task at 80 percent. He still has 4 hours left before the deadline for the 1-st task.  Vitaly chooses the 3-rd option. Then in 3 hours, he will complete the 2-nd task in its entirety. He has another 1 hour left before the deadline for the 1-st task and 4 hours left before the deadline for the 3-rd task.  Vitaly chooses the 1-st option. Then after 1 hour, he will complete the 1-st task for 110 percent, which means that he will complete the 1-st task just in time for the deadline.  Vitaly chooses the 5-th option. He will complete the 3-rd task for 2 hours, and after another 1 hour, Vitaly will complete the 3-rd task in its entirety. Thus, Vitaly has managed to complete the course completely and on time, using the 4 options.Help Vitaly \xe2\x80\x94 print the options for Vitaly to complete the tasks in the correct order. Please note: each option can be used not more than once. If there are several possible answers, it is allowed to output any of them." dp,greedy,implementation 2200
1826C "Dreaming of Freedom" "Because to take away a man\'s freedom of choice, even his freedom to make the wrong choice, is to manipulate him as though he were a puppet and not a person.\xe2\x80\x94 Madeleine L\'EngleThere are n programmers choosing their favorite algorithm amongst m different choice options. Before the first round, all m options are available. In each round, every programmer makes a vote for one of the remaining algorithms. After the round, only the algorithms with the maximum number of votes remain. The voting process ends when there is only one option left. Determine whether the voting process can continue indefinitely or no matter how people vote, they will eventually choose a single option after some finite amount of rounds?" "greedy,math,number theory" 1300
1533G "Biome Map" "Polycarp decided to generate a biome map for his game. A map is a matrix divided into cells 1\xc3\x971. Each cell of the map must contain one of the available biomes.Each biome is defined by two parameters: temperature (an integer from 1 to n) and humidity (an integer from 1 to m). But not for every temperature/humidity combination, a corresponding biome is available.The biome map should be generated according to the following rules:  each cell of the map belongs to exactly one biome;  each available biome has at least one cell on the map;  if two cells of the map are adjacent by the side and they belong to biomes with parameters (t1,h1) and (t2,h2), respectively, then the equality |t1\xe2\x88\x92t2|+|h1\xe2\x88\x92h2|=1 holds;  let the number of available biomes be equal to k, then the number of rows and columns of the map (separately) should not exceed k. Help Polycarp generate a biome map that meets all the conditions described above (or report that this is impossible)." "*special problem,constructive algorithms,dfs and similar,graphs" -999
168A "Wizards and Demonstration" "Some country is populated by wizards. They want to organize a demonstration.There are n people living in the city, x of them are the wizards who will surely go to the demonstration. Other city people (n\xe2\x80\x89-\xe2\x80\x89x people) do not support the wizards and aren\'t going to go to the demonstration. We know that the city administration will react only to the demonstration involving at least y percent of the city people. Having considered the matter, the wizards decided to create clone puppets which can substitute the city people on the demonstration. So all in all, the demonstration will involve only the wizards and their puppets. The city administration cannot tell the difference between a puppet and a person, so, as they calculate the percentage, the administration will consider the city to be consisting of only n people and not containing any clone puppets. Help the wizards and find the minimum number of clones to create to that the demonstration had no less than y percent of the city people." implementation,math 900
1236A Stones "Alice is playing with some stones.Now there are three numbered heaps of stones. The first of them contains a stones, the second of them contains b stones and the third of them contains c stones.Each time she can do one of two operations:  take one stone from the first heap and two stones from the second heap (this operation can be done only if the first heap contains at least one stone and the second heap contains at least two stones);  take one stone from the second heap and two stones from the third heap (this operation can be done only if the second heap contains at least one stone and the third heap contains at least two stones). She wants to get the maximum number of stones, but she doesn\'t know what to do. Initially, she has 0 stones. Can you help her?" "brute force,greedy,math" 800
1933A "Turtle Puzzle: Rearrange and Negate" "You are given an array a of n integers. You must perform the following two operations on the array (the first, then the second):  Arbitrarily rearrange the elements of the array or leave the order of its elements unchanged.  Choose at most one contiguous segment of elements and replace the signs of all elements in this segment with their opposites. Formally, you can choose a pair of indices l,r such that 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n and assign ai=\xe2\x88\x92ai for all l\xe2\x89\xa4i\xe2\x89\xa4r (negate elements). Note that you may choose not to select a pair of indices and leave all the signs of the elements unchanged. What is the maximum sum of the array elements after performing these two operations (the first, then the second)?" greedy,math,sortings 800
389B "Fox and Cross" "Fox Ciel has a board with n rows and n columns. So, the board consists of n\xe2\x80\x89\xc3\x97\xe2\x80\x89n cells. Each cell contains either a symbol \'.\', or a symbol \'#\'.A cross on the board is a connected set of exactly five cells of the board that looks like a cross. The picture below shows how it looks.Ciel wants to draw several (may be zero) crosses on the board. Each cross must cover exactly five cells with symbols \'#\', and any cell with symbol \'#\' must belong to some cross. No two crosses can share a cell.Please, tell Ciel if she can draw the crosses in the described way." greedy,implementation 1100
1763D "Valid Bitonic Permutations" "You are given five integers n, i, j, x, and y. Find the number of bitonic permutations B, of the numbers 1 to n, such that Bi=x, and Bj=y. Since the answer can be large, compute it modulo 109+7.A bitonic permutation is a permutation of numbers, such that the elements of the permutation first increase till a certain index k, 2\xe2\x89\xa4k\xe2\x89\xa4n\xe2\x88\x921, and then decrease till the end. Refer to notes for further clarification." "combinatorics,dp,implementation,math,number theory" 2200
351B "Jeff and Furik" "Jeff has become friends with Furik. Now these two are going to play one quite amusing game.At the beginning of the game Jeff takes a piece of paper and writes down a permutation consisting of n numbers: p1, p2, ..., pn. Then the guys take turns to make moves, Jeff moves first. During his move, Jeff chooses two adjacent permutation elements and then the boy swaps them. During his move, Furic tosses a coin and if the coin shows ""heads"" he chooses a random pair of adjacent elements with indexes i and i\xe2\x80\x89+\xe2\x80\x891, for which an inequality pi\xe2\x80\x89>\xe2\x80\x89pi\xe2\x80\x89+\xe2\x80\x891 holds, and swaps them. But if the coin shows ""tails"", Furik chooses a random pair of adjacent elements with indexes i and i\xe2\x80\x89+\xe2\x80\x891, for which the inequality pi\xe2\x80\x89<\xe2\x80\x89pi\xe2\x80\x89+\xe2\x80\x891 holds, and swaps them. If the coin shows ""heads"" or ""tails"" and Furik has multiple ways of adjacent pairs to take, then he uniformly takes one of the pairs. If Furik doesn\'t have any pair to take, he tosses a coin one more time. The game ends when the permutation is sorted in the increasing order.Jeff wants the game to finish as quickly as possible (that is, he wants both players to make as few moves as possible). Help Jeff find the minimum mathematical expectation of the number of moves in the game if he moves optimally well.You can consider that the coin shows the heads (or tails) with the probability of 50 percent." combinatorics,dp,probabilities 1900
547A "Mike and Frog" "Mike has a frog and a flower. His frog is named Xaniar and his flower is named Abol. Initially(at time 0), height of Xaniar is h1 and height of Abol is h2. Each second, Mike waters Abol and Xaniar.  So, if height of Xaniar is h1 and height of Abol is h2, after one second height of Xaniar will become  and height of Abol will become  where x1,\xe2\x80\x89y1,\xe2\x80\x89x2 and y2 are some integer numbers and  denotes the remainder of a modulo b.Mike is a competitive programmer fan. He wants to know the minimum time it takes until height of Xania is a1 and height of Abol is a2.Mike has asked you for your help. Calculate the minimum time or say it will never happen." "brute force,greedy,implementation,math" 2200
65D "Harry Potter and the Sorting Hat" "As you know, Hogwarts has four houses: Gryffindor, Hufflepuff, Ravenclaw and Slytherin. The sorting of the first-years into houses is done by the Sorting Hat. The pupils are called one by one in the alphabetical order, each of them should put a hat on his head and, after some thought, the hat solemnly announces the name of the house the student should enter.At that the Hat is believed to base its considerations on the student\'s personal qualities: it sends the brave and noble ones to Gryffindor, the smart and shrewd ones \xe2\x80\x94 to Ravenclaw, the persistent and honest ones \xe2\x80\x94 to Hufflepuff and the clever and cunning ones \xe2\x80\x94 to Slytherin. However, a first year student Hermione Granger got very concerned about the forthcoming sorting. She studied all the literature on the Sorting Hat and came to the conclusion that it is much simpler than that. If the relatives of the student have already studied at Hogwarts, the hat puts the student to the same house, where his family used to study. In controversial situations, when the relatives studied in different houses or when they were all Muggles like Hermione\'s parents, then the Hat sorts the student to the house, to which the least number of first years has been sent at that moment. If there are several such houses, the choice is given to the student himself. Then the student can choose any of the houses, to which the least number of first years has been sent so far. Hermione has already asked the students that are on the list before her about their relatives. Now she and her new friends Harry Potter and Ron Weasley want to find out into what house the Hat will put Hermione." "brute force,dfs and similar,hashing" 2200
1913D "Array Collapse" "You are given an array [p1,p2,\xe2\x80\xa6,pn], where all elements are distinct.You can perform several (possibly zero) operations with it. In one operation, you can choose a contiguous subsegment of p and remove all elements from that subsegment, except for the minimum element on that subsegment. For example, if p=[3,1,4,7,5,2,6] and you choose the subsegment from the 3-rd element to the 6-th element, the resulting array is [3,1,2,6].An array a is called reachable if it can be obtained from p using several (maybe zero) aforementioned operations. Calculate the number of reachable arrays, and print it modulo 998244353." "data structures,divide and conquer,dp,trees" 2100
31D Chocolate "Bob has a rectangular chocolate bar of the size W\xe2\x80\x89\xc3\x97\xe2\x80\x89H. He introduced a cartesian coordinate system so that the point (0,\xe2\x80\x890) corresponds to the lower-left corner of the bar, and the point (W,\xe2\x80\x89H) corresponds to the upper-right corner. Bob decided to split the bar into pieces by breaking it. Each break is a segment parallel to one of the coordinate axes, which connects the edges of the bar. More formally, each break goes along the line x\xe2\x80\x89=\xe2\x80\x89xc or y\xe2\x80\x89=\xe2\x80\x89yc, where xc and yc are integers. It should divide one part of the bar into two non-empty parts. After Bob breaks some part into two parts, he breaks the resulting parts separately and independently from each other. Also he doesn\'t move the parts of the bar. Bob made n breaks and wrote them down in his notebook in arbitrary order. At the end he got n\xe2\x80\x89+\xe2\x80\x891 parts. Now he wants to calculate their areas. Bob is lazy, so he asks you to do this task." "dfs and similar,implementation" 2000
19A "World Football Cup" "Everyone knows that 2010 FIFA World Cup is being held in South Africa now. By the decision of BFA (Berland\'s Football Association) next World Cup will be held in Berland. BFA took the decision to change some World Cup regulations:  the final tournament features n teams (n is always even)  the first n\xe2\x80\x89/\xe2\x80\x892 teams (according to the standings) come through to the knockout stage  the standings are made on the following principle: for a victory a team gets 3 points, for a draw \xe2\x80\x94 1 point, for a defeat \xe2\x80\x94 0 points. In the first place, teams are ordered in the standings in decreasing order of their points; in the second place \xe2\x80\x94 in decreasing order of the difference between scored and missed goals; in the third place \xe2\x80\x94 in the decreasing order of scored goals  it\'s written in Berland\'s Constitution that the previous regulation helps to order the teams without ambiguity. You are asked to write a program that, by the given list of the competing teams and the results of all the matches, will find the list of teams that managed to get through to the knockout stage." implementation 1400
1921A Square "A square of positive (strictly greater than 0) area is located on the coordinate plane, with sides parallel to the coordinate axes. You are given the coordinates of its corners, in random order. Your task is to find the area of the square." greedy,math 800
79E "Security System" "Fox Ciel safely returned to her castle, but there was something wrong with the security system of the castle: sensors attached in the castle were covering her.Ciel is at point (1,\xe2\x80\x891) of the castle now, and wants to move to point (n,\xe2\x80\x89n), which is the position of her room. By one step, Ciel can move from point (x,\xe2\x80\x89y) to either (x\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89y) (rightward) or (x,\xe2\x80\x89y\xe2\x80\x89+\xe2\x80\x891) (upward).In her castle, c2 sensors are set at points (a\xe2\x80\x89+\xe2\x80\x89i,\xe2\x80\x89b\xe2\x80\x89+\xe2\x80\x89j) (for every integer i and j such that: 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89c,\xe2\x80\x890\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89<\xe2\x80\x89c).Each sensor has a count value and decreases its count value every time Ciel moves. Initially, the count value of each sensor is t. Every time Ciel moves to point (x,\xe2\x80\x89y), the count value of a sensor at point (u,\xe2\x80\x89v) decreases by (|u\xe2\x80\x89-\xe2\x80\x89x|\xe2\x80\x89+\xe2\x80\x89|v\xe2\x80\x89-\xe2\x80\x89y|). When the count value of some sensor becomes strictly less than 0, the sensor will catch Ciel as a suspicious individual!Determine whether Ciel can move from (1,\xe2\x80\x891) to (n,\xe2\x80\x89n) without being caught by a sensor, and if it is possible, output her steps. Assume that Ciel can move to every point even if there is a censor on the point." math 2900
1666F "Fancy Stack" "Little Fiona has a collection of n blocks of various sizes a1,a2,\xe2\x80\xa6,an, where n is even. Some of the blocks can be equal in size. She would like to put all these blocks one onto another to form a fancy stack.Let b1,b2,\xe2\x80\xa6,bn be the sizes of blocks in the stack from top to bottom. Since Fiona is using all her blocks, b1,b2,\xe2\x80\xa6,bn must be a permutation of a1,a2,\xe2\x80\xa6,an. Fiona thinks the stack is fancy if both of the following conditions are satisfied:   The second block is strictly bigger than the first one, and then each block is alternately strictly smaller or strictly bigger than the previous one. Formally, b1<b2>b3<b4>\xe2\x80\xa6>bn\xe2\x88\x921<bn.  The sizes of the blocks on even positions are strictly increasing. Formally, b2<b4<b6<\xe2\x80\xa6<bn (remember that n is even).   Two stacks are considered different if their corresponding sequences b1,b2,\xe2\x80\xa6,bn differ in at least one position.Fiona wants to know how many different fancy stacks she can build with all of her blocks. Since large numbers scare Fiona, find this number modulo 998244353." combinatorics,dp,implementation 2200
1183G "Candy Box (hard version)" "This problem is a version of problem D from the same contest with some additional constraints and tasks.There are n candies in a candy box. The type of the i-th candy is ai (1\xe2\x89\xa4ai\xe2\x89\xa4n). You have to prepare a gift using some of these candies with the following restriction: the numbers of candies of each type presented in a gift should be all distinct (i.\xe2\x80\x89e. for example, a gift having two candies of type 1 and two candies of type 2 is bad).It is possible that multiple types of candies are completely absent from the gift. It is also possible that not all candies of some types will be taken to a gift.You really like some of the candies and don\'t want to include them into the gift, but you want to eat them yourself instead. For each candy, a number fi is given, which is equal to 0 if you really want to keep i-th candy for yourself, or 1 if you don\'t mind including it into your gift. It is possible that two candies of the same type have different values of fi.You want your gift to be as large as possible, but you don\'t want to include too many of the candies you want to eat into the gift. So, you want to calculate the maximum possible number of candies that can be included into a gift, and among all ways to choose maximum number of candies, you want to maximize the number of candies having fi=1 in your gift.You have to answer q independent queries.If you are Python programmer, consider using PyPy instead of Python when you submit your code." greedy,implementation,sortings 2000
257D Sum "Vasya has found a piece of paper with an array written on it. The array consists of n integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. Vasya noticed that the following condition holds for the array ai\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x892\xc2\xb7ai for any positive integer i (i\xe2\x80\x89<\xe2\x80\x89n).Vasya wants to add either a ""+"" or a ""-"" before each number of array. Thus, Vasya will get an expression consisting of n summands. The value of the resulting expression is the sum of all its elements. The task is to add signs ""+"" and ""-"" before each number so that the value of expression s meets the limits 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89s\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a1. Print a sequence of signs ""+"" and ""-"", satisfying the given limits. It is guaranteed that the solution for the problem exists." greedy,math 1900
1288A Deadline "Adilbek was assigned to a special project. For Adilbek it means that he has n days to run a special program and provide its results. But there is a problem: the program needs to run for d days to calculate the results.Fortunately, Adilbek can optimize the program. If he spends x (x is a non-negative integer) days optimizing the program, he will make the program run in \xe2\x8c\x88dx+1\xe2\x8c\x89 days (\xe2\x8c\x88a\xe2\x8c\x89 is the ceiling function: \xe2\x8c\x882.4\xe2\x8c\x89=3, \xe2\x8c\x882\xe2\x8c\x89=2). The program cannot be run and optimized simultaneously, so the total number of days he will spend is equal to x+\xe2\x8c\x88dx+1\xe2\x8c\x89.Will Adilbek be able to provide the generated results in no more than n days?" "binary search,brute force,math,ternary search" 1100
217D "Bitonix\' Patrol" "Byteland is trying to send a space mission onto the Bit-X planet. Their task is complicated by the fact that the orbit of the planet is regularly patrolled by Captain Bitonix, the leader of the space forces of Bit-X.There are n stations around Bit-X numbered clockwise from 1 to n. The stations are evenly placed on a circular orbit, so the stations number i and i\xe2\x80\x89+\xe2\x80\x891 (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89n), and the stations number 1 and n, are neighboring. The distance between every pair of adjacent stations is equal to m space miles. To go on a patrol, Captain Bitonix jumps in his rocket at one of the stations and flies in a circle, covering a distance of at least one space mile, before finishing in some (perhaps the starting) station.Bitonix\' rocket moves by burning fuel tanks. After Bitonix attaches an x-liter fuel tank and chooses the direction (clockwise or counter-clockwise), the rocket flies exactly x space miles along a circular orbit in the chosen direction. Note that the rocket has no brakes; it is not possible for the rocket to stop before depleting a fuel tank.For example, assume that n\xe2\x80\x89=\xe2\x80\x893 and m\xe2\x80\x89=\xe2\x80\x8960 and Bitonix has fuel tanks with volumes of 10, 60, 90 and 100 liters. If Bitonix starts from station 1, uses the 100-liter fuel tank to go clockwise, then uses the 90-liter fuel tank to go clockwise, and then uses the 10-liter fuel tank to go counterclockwise, he will finish back at station 1. This constitutes a valid patrol. Note that Bitonix does not have to use all available fuel tanks. Another valid option for Bitonix in this example would be to simply use the 60-liter fuel tank to fly to either station 2 or 3.However, if n was equal to 3, m was equal to 60 and the only fuel tanks available to Bitonix were one 10-liter tank and one 100-liter tank, he would have no way of completing a valid patrol (he wouldn\'t be able to finish any patrol exactly at the station).The Byteland space agency wants to destroy some of Captain Bitonix\' fuel tanks so that he cannot to complete any valid patrol. Find how many different subsets of the tanks the agency can destroy to prevent Captain Bitonix from completing a patrol and output the answer modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." "bitmasks,brute force,combinatorics,dfs and similar,math" 2900
1977A "Little Nikita" "The little boy Nikita was given some cubes as a present. He decided to build a tower out of them.Initially, the tower doesn\'t have any cubes. In one move, Nikita either puts exactly 1 cube on top of the tower or removes exactly 1 cube from the top of the tower. Is it possible that after n moves, the resulting tower has exactly m cubes?" math 800
1976A "Verify Password" "Monocarp is working on his new site, and the current challenge is to make the users pick strong passwords.Monocarp decided that strong passwords should satisfy the following conditions:   password should consist only of lowercase Latin letters and digits;  there should be no digit that comes after a letter (so, after each letter, there is either another letter or the string ends);  all digits should be sorted in the non-decreasing order;  all letters should be sorted in the non-decreasing order. Note that it\'s allowed for the password to have only letters or only digits.Monocarp managed to implement the first condition, but he struggles with the remaining ones. Can you help him to verify the passwords?" implementation,sortings,strings 800
21B Intersection "You are given two set of points. The first set is determined by the equation A1x\xe2\x80\x89+\xe2\x80\x89B1y\xe2\x80\x89+\xe2\x80\x89C1\xe2\x80\x89=\xe2\x80\x890, and the second one is determined by the equation A2x\xe2\x80\x89+\xe2\x80\x89B2y\xe2\x80\x89+\xe2\x80\x89C2\xe2\x80\x89=\xe2\x80\x890.Write the program which finds the number of points in the intersection of two given sets." implementation,math 2000
86E "Long sequence" "A sequence a0,\xe2\x80\x89a1,\xe2\x80\x89... is called a recurrent binary sequence, if each term ai (i\xe2\x80\x89=\xe2\x80\x890,\xe2\x80\x891,\xe2\x80\x89...) is equal to 0 or 1 and there exist coefficients  such that an\xe2\x80\x89=\xe2\x80\x89c1\xc2\xb7an\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x89c2\xc2\xb7an\xe2\x80\x89-\xe2\x80\x892\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89ck\xc2\xb7an\xe2\x80\x89-\xe2\x80\x89k (mod 2),\xe2\x80\x89 for all n\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89k. Assume that not all of ci are zeros.Note that such a sequence can be uniquely recovered from any k-tuple {as,\xe2\x80\x89as\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89as\xe2\x80\x89+\xe2\x80\x89k\xe2\x80\x89-\xe2\x80\x891} and so it is periodic. Moreover, if a k-tuple contains only zeros, then the sequence contains only zeros, so this case is not very interesting. Otherwise the minimal period of the sequence is not greater than 2k\xe2\x80\x89-\xe2\x80\x891, as k-tuple determines next element, and there are 2k\xe2\x80\x89-\xe2\x80\x891 non-zero k-tuples. Let us call a sequence long if its minimal period is exactly 2k\xe2\x80\x89-\xe2\x80\x891. Your task is to find a long sequence for a given k, if there is any." "brute force,math,matrices" 2700
126A "Hot Bath" "Bob is about to take a hot bath. There are two taps to fill the bath: a hot water tap and a cold water tap. The cold water\'s temperature is t1, and the hot water\'s temperature is t2. The cold water tap can transmit any integer number of water units per second from 0 to x1, inclusive. Similarly, the hot water tap can transmit from 0 to x2 water units per second.If y1 water units per second flow through the first tap and y2 water units per second flow through the second tap, then the resulting bath water temperature will be:Bob wants to open both taps so that the bath water temperature was not less than t0. However, the temperature should be as close as possible to this value. If there are several optimal variants, Bob chooses the one that lets fill the bath in the quickest way possible.Determine how much each tap should be opened so that Bob was pleased with the result in the end." "binary search,brute force,math" 1900
1891B "Deja Vu" "You are given an array a of length n, consisting of positive integers, and an array x of length q, also consisting of positive integers.There are q modification. On the i-th modification (1\xe2\x89\xa4i\xe2\x89\xa4q), for each j (1\xe2\x89\xa4j\xe2\x89\xa4n), such that aj is divisible by 2xi, you add 2xi\xe2\x88\x921 to aj. Note that xi (1\xe2\x89\xa4xi\xe2\x89\xa430) is a positive integer not exceeding 30.After all modification queries, you need to output the final array." "brute force,math,sortings" 1100
1844A "Subtraction Game" "You are given two positive integers, a and b (a<b).For some positive integer n, two players will play a game starting with a pile of n stones. They take turns removing exactly a or exactly b stones from the pile. The player who is unable to make a move loses.Find a positive integer n such that the second player to move in this game has a winning strategy. This means that no matter what moves the first player makes, the second player can carefully choose their moves (possibly depending on the first player\'s moves) to ensure they win." "constructive algorithms,games" 800
1776N "Count Permutations" "You are given a string s with length n\xe2\x88\x921 whose characters are either < or >.Count the permutations p1,p2,\xe2\x80\xa6,pn of 1,2,\xe2\x80\xa6,n such that, for all i=1,2,\xe2\x80\xa6,n\xe2\x88\x921, if si is < then pi<pi+1 and if si is > then pi>pi+1.Since this number can be very large, compute its logarithm in base 2." math 3500
871E "Restore the Tree" "Petya had a tree consisting of n vertices numbered with integers from 1 to n. Accidentally he lost his tree. Petya remembers information about k vertices: distances from each of them to each of the n tree vertices.Your task is to restore any tree that satisfies the information that Petya remembers or report that such tree doesn\'t exist." graphs,greedy,trees 2900
493C "Vasya and Basketball" "Vasya follows a basketball game and marks the distances from which each team makes a throw. He knows that each successful throw has value of either 2 or 3 points. A throw is worth 2 points if the distance it was made from doesn\'t exceed some value of d meters, and a throw is worth 3 points if the distance is larger than d meters, where d is some non-negative integer.Vasya would like the advantage of the points scored by the first team (the points of the first team minus the points of the second team) to be maximum. For that he can mentally choose the value of d. Help him to do that." "binary search,brute force,data structures,implementation,sortings,two pointers" 1600
9A "Die Roll" "Yakko, Wakko and Dot, world-famous animaniacs, decided to rest from acting in cartoons, and take a leave to travel a bit. Yakko dreamt to go to Pennsylvania, his Motherland and the Motherland of his ancestors. Wakko thought about Tasmania, its beaches, sun and sea. Dot chose Transylvania as the most mysterious and unpredictable place.But to their great regret, the leave turned to be very short, so it will be enough to visit one of the three above named places. That\'s why Yakko, as the cleverest, came up with a truly genius idea: let each of the three roll an ordinary six-sided die, and the one with the highest amount of points will be the winner, and will take the other two to the place of his/her dreams.Yakko thrown a die and got Y points, Wakko \xe2\x80\x94 W points. It was Dot\'s turn. But she didn\'t hurry. Dot wanted to know for sure what were her chances to visit Transylvania.It is known that Yakko and Wakko are true gentlemen, that\'s why if they have the same amount of points with Dot, they will let Dot win." math,probabilities 800
1065G "Fibonacci Suffix" "Let\'s denote (yet again) the sequence of Fibonacci strings:F(0)= 0, F(1)= 1, F(i)=F(i\xe2\x88\x922)+F(i\xe2\x88\x921), where the plus sign denotes the concatenation of two strings.Let\'s denote the lexicographically sorted sequence of suffixes of string F(i) as A(F(i)). For example, F(4) is 01101, and A(F(4)) is the following sequence: 01, 01101, 1, 101, 1101. Elements in this sequence are numbered from 1.Your task is to print m first characters of k-th element of A(F(n)). If there are less than m characters in this suffix, then output the whole suffix." strings 2700
1768C "Elemental Decompress" "You are given an array a of n integers.Find two permutations\xe2\x80\xa0 p and q of length n such that max(pi,qi)=ai for all 1\xe2\x89\xa4i\xe2\x89\xa4n or report that such p and q do not exist.\xe2\x80\xa0 A permutation of length n is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array), and [1,3,4] is also not a permutation (n=3 but there is 4 in the array)." "constructive algorithms,greedy,implementation,sortings" 1300
1369E DeadLee "Lee bought some food for dinner time, but Lee\'s friends eat dinner in a deadly way. Lee is so scared, he doesn\'t want to die, at least not before seeing Online IOI 2020...There are n different types of food and m Lee\'s best friends. Lee has wi plates of the i-th type of food and each friend has two different favorite types of food: the i-th friend\'s favorite types of food are xi and yi (xi\xe2\x89\xa0yi).Lee will start calling his friends one by one. Whoever is called will go to the kitchen and will try to eat one plate of each of his favorite food types. Each of the friends will go to the kitchen exactly once.The only problem is the following: if a friend will eat at least one plate of food (in total) then he will be harmless. But if there is nothing left for him to eat (neither xi nor yi), he will eat Lee instead \xc3\x97_\xc3\x97.Lee can choose the order of friends to call, so he\'d like to determine if he can survive dinner or not. Also, he\'d like to know the order itself." "data structures,dfs and similar,greedy,implementation,sortings" 2400
1510C "Cactus Not Enough" "There was no problem about a cactus at the NERC 2020 online round. That\'s a bad mistake, so judges decided to fix it. You shall not pass to the World Finals 2021 without solving a problem about a cactus!A cactus is a connected undirected graph in which every edge lies on at most one simple cycle. Intuitively, a cactus is a generalization of a tree where some cycles are allowed. Multiedges (multiple edges between a pair of vertices) and loops (edges that connect a vertex to itself) are not allowed in a cactus. Cher has got a cactus. She calls cactus strong if it is impossible to add an edge to it in such a way that it still remains a cactus. But Cher thinks her cactus is not strong enough. She wants to add the smallest possible number of edges to it to make it strong, i. e. to create a new cactus with the same vertices, so that the original cactus is a subgraph of the new one, and it is impossible to add another edge to it so that the graph remains a cactus. Cher hired you to do this job for her. So... it\'s on you!" "dfs and similar,graph matchings,graphs" 2900
925D "Aztec Catacombs" "Indiana Jones found ancient Aztec catacombs containing a golden idol. The catacombs consists of n caves. Each pair of caves is connected with a two-way corridor that can be opened or closed. The entrance to the catacombs is in the cave 1, the idol and the exit are in the cave n.When Indiana goes from a cave x to a cave y using an open corridor, all corridors connected to the cave x change their state: all open corridors become closed, all closed corridors become open. Indiana wants to go from cave 1 to cave n going through as small number of corridors as possible. Help him find the optimal path, or determine that it is impossible to get out of catacombs." "constructive algorithms" 2600
1154D "Walking Robot" "There is a robot staying at X=0 on the Ox axis. He has to walk to X=n. You are controlling this robot and controlling how he goes. The robot has a battery and an accumulator with a solar panel.The i-th segment of the path (from X=i\xe2\x88\x921 to X=i) can be exposed to sunlight or not. The array s denotes which segments are exposed to sunlight: if segment i is exposed, then si=1, otherwise si=0.The robot has one battery of capacity b and one accumulator of capacity a. For each segment, you should choose which type of energy storage robot will use to go to the next point (it can be either battery or accumulator). If the robot goes using the battery, the current charge of the battery is decreased by one (the robot can\'t use the battery if its charge is zero). And if the robot goes using the accumulator, the current charge of the accumulator is decreased by one (and the robot also can\'t use the accumulator if its charge is zero).If the current segment is exposed to sunlight and the robot goes through it using the battery, the charge of the accumulator increases by one (of course, its charge can\'t become higher than it\'s maximum capacity).If accumulator is used to pass some segment, its charge decreases by 1 no matter if the segment is exposed or not.You understand that it is not always possible to walk to X=n. You want your robot to go as far as possible. Find the maximum number of segments of distance the robot can pass if you control him optimally." greedy 1500
398D "Instant Messanger" "User ainta decided to make a new instant messenger called ""aintalk"". With aintalk, each user can chat with other people. User ainta made the prototype of some functions to implement this thing.  login(u): User u logins into aintalk and becomes online.  logout(u): User u logouts and becomes offline.  add_friend(u, v): User u and user v become friends. It means, u and v can talk with each other. The friendship is bidirectional.  del_friend(u, v): Unfriend user u and user v. It means, u and v cannot talk with each other from then.  count_online_friends(u): The function returns the number of friends of user u who are online at the moment.   Because the messenger is being tested by some users numbered from 1 to n, there is no register method. This means, at the beginning, some users may be online, and some users may have friends.User ainta is going to make these functions, but before making the messenger public, he wants to know whether he is correct. Help ainta verify his code." "data structures" -999
754D "Fedor and coupons" "All our characters have hobbies. The same is true for Fedor. He enjoys shopping in the neighboring supermarket. The goods in the supermarket have unique integer ids. Also, for every integer there is a product with id equal to this integer. Fedor has n discount coupons, the i-th of them can be used with products with ids ranging from li to ri, inclusive. Today Fedor wants to take exactly k coupons with him.Fedor wants to choose the k coupons in such a way that the number of such products x that all coupons can be used with this product x is as large as possible (for better understanding, see examples). Fedor wants to save his time as well, so he asks you to choose coupons for him. Help Fedor!" "binary search,data structures,greedy,sortings" 2100
464B "Restore Cube" "Peter had a cube with non-zero length of a side. He put the cube into three-dimensional space in such a way that its vertices lay at integer points (it is possible that the cube\'s sides are not parallel to the coordinate axes). Then he took a piece of paper and wrote down eight lines, each containing three integers \xe2\x80\x94 coordinates of cube\'s vertex (a single line contains coordinates of a single vertex, each vertex is written exactly once), put the paper on the table and left. While Peter was away, his little brother Nick decided to play with the numbers on the paper. In one operation Nick could swap some numbers inside a single line (Nick didn\'t swap numbers from distinct lines). Nick could have performed any number of such operations.When Peter returned and found out about Nick\'s mischief, he started recollecting the original coordinates. Help Peter restore the original position of the points or else state that this is impossible and the numbers were initially recorded incorrectly." "brute force,geometry" 2000
437E "The Child and Polygon" "This time our child has a simple polygon. He has to find the number of ways to split the polygon into non-degenerate triangles, each way must satisfy the following requirements:  each vertex of each triangle is one of the polygon vertex;  each side of the polygon must be the side of exactly one triangle;  the area of intersection of every two triangles equals to zero, and the sum of all areas of triangles equals to the area of the polygon;  each triangle must be completely inside the polygon;  each side of each triangle must contain exactly two vertices of the polygon. The picture below depicts an example of a correct splitting.  Please, help the child. Calculate the described number of ways modulo 1000000007 (109\xe2\x80\x89\xe2\x80\x89+\xe2\x80\x89\xe2\x80\x897) for him." dp,geometry 2500
123B Squares "You are given an infinite checkered field. You should get from a square (x1; y1) to a square (x2; y2). Using the shortest path is not necessary. You can move on the field squares in four directions. That is, when you are positioned in any square, you can move to any other side-neighboring one. A square (x; y) is considered bad, if at least one of the two conditions is fulfilled: |x\xe2\x80\x89+\xe2\x80\x89y|\xe2\x80\x89\xe2\x89\xa1\xe2\x80\x890 (mod 2a), |x\xe2\x80\x89-\xe2\x80\x89y|\xe2\x80\x89\xe2\x89\xa1\xe2\x80\x890 (mod 2b). Your task is to find the minimum number of bad cells one will have to visit on the way from (x1; y1) to (x2; y2)." math 1800
444E "DZY Loves Planting" "DZY loves planting, and he enjoys solving tree problems.DZY has a weighted tree (connected undirected graph without cycles) containing n nodes (they are numbered from 1 to n). He defines the function g(x,\xe2\x80\x89y) (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x,\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) as the longest edge in the shortest path between nodes x and y. Specially g(z,\xe2\x80\x89z)\xe2\x80\x89=\xe2\x80\x890 for every z.For every integer sequence p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pn (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89pi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n), DZY defines f(p) as . DZY wants to find such a sequence p that f(p) has maximum possible value. But there is one more restriction: the element j can appear in p at most xj times.Please, find the maximum possible f(p) under the described restrictions." "binary search,dsu,trees" 2700
1374C "Move Brackets" "You are given a bracket sequence s of length n, where n is even (divisible by two). The string s consists of n2 opening brackets \'(\' and n2 closing brackets \')\'.In one move, you can choose exactly one bracket and move it to the beginning of the string or to the end of the string (i.e. you choose some index i, remove the i-th character of s and insert it before or after all remaining characters of s).Your task is to find the minimum number of moves required to obtain regular bracket sequence from s. It can be proved that the answer always exists under the given constraints.Recall what the regular bracket sequence is:  ""()"" is regular bracket sequence;  if s is regular bracket sequence then ""("" + s + "")"" is regular bracket sequence;  if s and t are regular bracket sequences then s + t is regular bracket sequence. For example, ""()()"", ""(())()"", ""(())"" and ""()"" are regular bracket sequences, but "")("", ""()("" and "")))"" are not.You have to answer t independent test cases." greedy,strings 1000
1980F1 "Field Division (easy version)" "This is an easy version of the problem; it differs from the hard version only by the question. The easy version only needs you to print whether some values are non-zero or not. The hard version needs you to print the exact values.Alice and Bob are dividing the field. The field is a rectangle of size n\xc3\x97m (2\xe2\x89\xa4n,m\xe2\x89\xa4109), the rows are numbered from 1 to n from top to bottom, and the columns are numbered from 1 to m from left to right. The cell at the intersection of row r and column c is denoted as (r,c).Bob has k (2\xe2\x89\xa4k\xe2\x89\xa42\xe2\x8b\x85105) fountains, all of them are located in different cells of the field. Alice is responsible for dividing the field, but she must meet several conditions:  To divide the field, Alice will start her path in any free (without a fountain) cell on the left or top side of the field and will move, each time moving to the adjacent cell down or right. Her path will end on the right or bottom side of the field.  Alice\'s path will divide the field into two parts \xe2\x80\x94 one part will belong to Alice (this part includes the cells of her path), the other part \xe2\x80\x94 to Bob.  Alice will own the part that includes the cell (n,1).  Bob will own the part that includes the cell (1,m). Alice wants to divide the field in such a way as to get as many cells as possible.Bob wants to keep ownership of all the fountains, but he can give one of them to Alice. First, output the integer \xce\xb1 \xe2\x80\x94 the maximum possible size of Alice\'s plot, if Bob does not give her any fountain (i.e., all fountains will remain on Bob\'s plot). Then output k non-negative integers a1,a2,\xe2\x80\xa6,ak, where:  ai=0, if after Bob gives Alice the i-th fountain, the maximum possible size of Alice\'s plot does not increase (i.e., remains equal to \xce\xb1);  ai=1, if after Bob gives Alice the i-th fountain, the maximum possible size of Alice\'s plot increases (i.e., becomes greater than \xce\xb1)." "data structures,math,sortings" 1900
687B "Remainders Game" "Today Pari and Arya are playing a game called Remainders.Pari chooses two positive integer x and k, and tells Arya k but not x. Arya have to find the value . There are n ancient numbers c1,\xe2\x80\x89c2,\xe2\x80\x89...,\xe2\x80\x89cn and Pari has to tell Arya  if Arya wants. Given k and the ancient values, tell us if Arya has a winning strategy independent of value of x or not. Formally, is it true that Arya can understand the value  for any positive integer x?Note, that  means the remainder of x after dividing it by y." "chinese remainder theorem,math,number theory" 1800
776D "The Door Problem" "Moriarty has trapped n people in n distinct rooms in a hotel. Some rooms are locked, others are unlocked. But, there is a condition that the people in the hotel can only escape when all the doors are unlocked at the same time. There are m switches. Each switch control doors of some rooms, but each door is controlled by exactly two switches.You are given the initial configuration of the doors. Toggling any switch, that is, turning it ON when it is OFF, or turning it OFF when it is ON, toggles the condition of the doors that this switch controls. Say, we toggled switch 1, which was connected to room 1, 2 and 3 which were respectively locked, unlocked and unlocked. Then, after toggling the switch, they become unlocked, locked and locked.You need to tell Sherlock, if there exists a way to unlock all doors at the same time." "2-sat,dfs and similar,dsu,graphs" 2000
303B "Rectangle Puzzle II" "You are given a rectangle grid. That grid\'s size is n\xe2\x80\x89\xc3\x97\xe2\x80\x89m. Let\'s denote the coordinate system on the grid. So, each point on the grid will have coordinates \xe2\x80\x94 a pair of integers (x,\xe2\x80\x89y) (0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n,\xe2\x80\x890\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m).Your task is to find a maximum sub-rectangle on the grid (x1,\xe2\x80\x89y1,\xe2\x80\x89x2,\xe2\x80\x89y2) so that it contains the given point (x,\xe2\x80\x89y), and its length-width ratio is exactly (a,\xe2\x80\x89b). In other words the following conditions must hold: 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n, 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m, .The sides of this sub-rectangle should be parallel to the axes. And values x1,\xe2\x80\x89y1,\xe2\x80\x89x2,\xe2\x80\x89y2 should be integers.  If there are multiple solutions, find the rectangle which is closest to (x,\xe2\x80\x89y). Here ""closest"" means the Euclid distance between (x,\xe2\x80\x89y) and the center of the rectangle is as small as possible. If there are still multiple solutions, find the lexicographically minimum one. Here ""lexicographically minimum"" means that we should consider the sub-rectangle as sequence of integers (x1,\xe2\x80\x89y1,\xe2\x80\x89x2,\xe2\x80\x89y2), so we can choose the lexicographically minimum one." implementation,math 1700
1778A "Flip Flop Sum" "You are given an array of n integers a1,a2,\xe2\x80\xa6,an. The integers are either 1 or \xe2\x88\x921. You have to perform the following operation exactly once on the array a:  Choose an index i (1\xe2\x89\xa4i<n) and flip the signs of ai and ai+1. Here, flipping the sign means \xe2\x88\x921 will be 1 and 1 will be \xe2\x88\x921. What is the maximum possible value of a1+a2+\xe2\x80\xa6+an after applying the above operation?" greedy,implementation 800
734F "Anton and School" "Anton goes to school, his favorite lessons are arraystudying. He usually solves all the tasks pretty fast, but this time the teacher gave him a complicated one: given two arrays b and c of length n, find array a, such that:where a and b means bitwise AND, while a or b means bitwise OR.Usually Anton is good in arraystudying, but this problem is too hard, so Anton asks you to help." "bitmasks,constructive algorithms,implementation,math" 2500
396C "On Changing Tree" "You are given a rooted tree consisting of n vertices numbered from 1 to n. The root of the tree is a vertex number 1.Initially all vertices contain number 0. Then come q queries, each query has one of the two types:  The format of the query: 1 v x k. In response to the query, you need to add to the number at vertex v number x; to the numbers at the descendants of vertex v at distance 1, add x\xe2\x80\x89-\xe2\x80\x89k; and so on, to the numbers written in the descendants of vertex v at distance i, you need to add x\xe2\x80\x89-\xe2\x80\x89(i\xc2\xb7k). The distance between two vertices is the number of edges in the shortest path between these vertices.  The format of the query: 2 v. In reply to the query you should print the number written in vertex v modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897). Process the queries given in the input." "data structures,graphs,trees" -999
236A "Boy or Girl" "Those days, many boys use beautiful girls\' photos as avatars in forums. So it is pretty hard to tell the gender of a user at the first glance. Last year, our hero went to a forum and had a nice chat with a beauty (he thought so). After that they talked very often and eventually they became a couple in the network. But yesterday, he came to see ""her"" in the real world and found out ""she"" is actually a very strong man! Our hero is very sad and he is too tired to love again now. So he came up with a way to recognize users\' genders by their user names.This is his method: if the number of distinct characters in one\'s user name is odd, then he is a male, otherwise she is a female. You are given the string that denotes the user name, please help our hero to determine the gender of this user by his method." "brute force,implementation,strings" 800
985E "Pencils and Boxes" "Mishka received a gift of multicolored pencils for his birthday! Unfortunately he lives in a monochrome world, where everything is of the same color and only saturation differs. This pack can be represented as a sequence a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an of n integer numbers \xe2\x80\x94 saturation of the color of each pencil. Now Mishka wants to put all the mess in the pack in order. He has an infinite number of empty boxes to do this. He would like to fill some boxes in such a way that:  Each pencil belongs to exactly one box;  Each non-empty box has at least k pencils in it;  If pencils i and j belong to the same box, then |ai\xe2\x80\x89-\xe2\x80\x89aj|\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89d, where |x| means absolute value of x. Note that the opposite is optional, there can be pencils i and j such that |ai\xe2\x80\x89-\xe2\x80\x89aj|\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89d and they belong to different boxes. Help Mishka to determine if it\'s possible to distribute all the pencils into boxes. Print ""YES"" if there exists such a distribution. Otherwise print ""NO""." "binary search,data structures,dp,greedy,two pointers" 2100
605E "Intergalaxy Trips" "The scientists have recently discovered wormholes \xe2\x80\x94 objects in space that allow to travel very long distances between galaxies and star systems. The scientists know that there are n galaxies within reach. You are in the galaxy number 1 and you need to get to the galaxy number n. To get from galaxy i to galaxy j, you need to fly onto a wormhole (i,\xe2\x80\x89j) and in exactly one galaxy day you will find yourself in galaxy j. Unfortunately, the required wormhole is not always available. Every galaxy day they disappear and appear at random. However, the state of wormholes does not change within one galaxy day. A wormhole from galaxy i to galaxy j exists during each galaxy day taken separately with probability pij. You can always find out what wormholes exist at the given moment. At each moment you can either travel to another galaxy through one of wormholes that exist at this moment or you can simply wait for one galaxy day to see which wormholes will lead from your current position at the next day.Your task is to find the expected value of time needed to travel from galaxy 1 to galaxy n, if you act in the optimal way. It is guaranteed that this expected value exists." "probabilities,shortest paths" 2700
457E "Flow Optimality" "There is a computer network consisting of n nodes numbered 1 through n. There are links in the network that connect pairs of nodes. A pair of nodes may have multiple links between them, but no node has a link to itself.Each link supports unlimited bandwidth (in either direction), however a link may only transmit in a single direction at any given time. The cost of sending data across a link is proportional to the square of the bandwidth. Specifically, each link has a positive weight, and the cost of sending data across the link is the weight times the square of the bandwidth.The network is connected (there is a series of links from any node to any other node), and furthermore designed to remain connected in the event of any single node failure.You needed to send data from node 1 to node n at a bandwidth of some positive number k. That is, you wish to assign a bandwidth to each link so that the bandwidth into a node minus the bandwidth out of a node is \xe2\x80\x89-\xe2\x80\x89k for node 1, k for node n, and 0 for all other nodes. The individual bandwidths do not need to be integers.Wishing to minimize the total cost, you drew a diagram of the network, then gave the task to an intern to solve. The intern claimed to have solved the task and written the optimal bandwidths on your diagram, but then spilled coffee on it, rendering much of it unreadable (including parts of the original diagram, and the value of k).From the information available, determine if the intern\'s solution may have been optimal. That is, determine if there exists a valid network, total bandwidth, and optimal solution which is a superset of the given information. Furthermore, determine the efficiency of the intern\'s solution (if possible), where efficiency is defined as total cost divided by total bandwidth." "constructive algorithms,flows,math" 3000
803A "Maximal Binary Matrix" "You are given matrix with n rows and n columns filled with zeroes. You should put k ones in it in such a way that the resulting matrix is symmetrical with respect to the main diagonal (the diagonal that goes from the top left to the bottom right corner) and is lexicographically maximal.One matrix is lexicographically greater than the other if the first different number in the first different row from the top in the first matrix is greater than the corresponding number in the second one.If there exists no such matrix then output -1." "constructive algorithms" 1400
598C "Nearest vectors" "You are given the set of vectors on the plane, each of them starting at the origin. Your task is to find a pair of vectors with the minimal non-oriented angle between them.Non-oriented angle is non-negative value, minimal between clockwise and counterclockwise direction angles. Non-oriented angle is always between 0 and \xcf\x80. For example, opposite directions vectors have angle equals to \xcf\x80." geometry,sortings 2300
676D "Theseus and labyrinth" "Theseus has just arrived to Crete to fight Minotaur. He found a labyrinth that has a form of a rectangular field of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m and consists of blocks of size 1\xe2\x80\x89\xc3\x97\xe2\x80\x891.Each block of the labyrinth has a button that rotates all blocks 90 degrees clockwise. Each block rotates around its center and doesn\'t change its position in the labyrinth. Also, each block has some number of doors (possibly none). In one minute, Theseus can either push the button in order to rotate all the blocks 90 degrees clockwise or pass to the neighbouring block. Theseus can go from block A to some neighbouring block B only if block A has a door that leads to block B and block B has a door that leads to block A.Theseus found an entrance to labyrinth and is now located in block (xT,\xe2\x80\x89yT) \xe2\x80\x94 the block in the row xT and column yT. Theseus know that the Minotaur is hiding in block (xM,\xe2\x80\x89yM) and wants to know the minimum number of minutes required to get there.Theseus is a hero, not a programmer, so he asks you to help him." "graphs,implementation,shortest paths" 2000
304B Calendar "Calendars in widespread use today include the Gregorian calendar, which is the de facto international standard, and is used almost everywhere in the world for civil purposes. The Gregorian reform modified the Julian calendar\'s scheme of leap years as follows: Every year that is exactly divisible by four is a leap year, except for years that are exactly divisible by 100; the centurial years that are exactly divisible by 400 are still leap years. For example, the year 1900 is not a leap year; the year 2000 is a leap year.   In this problem, you have been given two dates and your task is to calculate how many days are between them. Note, that leap years have unusual number of days in February.Look at the sample to understand what borders are included in the aswer." "brute force,implementation" 1300
407E k-d-sequence "We\'ll call a sequence of integers a good k-d sequence if we can add to it at most k numbers in such a way that after the sorting the sequence will be an arithmetic progression with difference d.You got hold of some sequence a, consisting of n integers. Your task is to find its longest contiguous subsegment, such that it is a good k-d sequence." "data structures" 3100
1270C "Make Good" "Let\'s call an array a1,a2,\xe2\x80\xa6,am of nonnegative integer numbers good if a1+a2+\xe2\x8b\xaf+am=2\xe2\x8b\x85(a1\xe2\x8a\x95a2\xe2\x8a\x95\xe2\x8b\xaf\xe2\x8a\x95am), where \xe2\x8a\x95 denotes the bitwise XOR operation.For example, array [1,2,3,6] is good, as 1+2+3+6=12=2\xe2\x8b\x856=2\xe2\x8b\x85(1\xe2\x8a\x952\xe2\x8a\x953\xe2\x8a\x956). At the same time, array [1,2,1,3] isn\'t good, as 1+2+1+3=7\xe2\x89\xa02\xe2\x8b\x851=2\xe2\x8b\x85(1\xe2\x8a\x952\xe2\x8a\x951\xe2\x8a\x953).You are given an array of length n: a1,a2,\xe2\x80\xa6,an. Append at most 3 elements to it to make it good. Appended elements don\'t have to be different. It can be shown that the solution always exists under the given constraints. If there are different solutions, you are allowed to output any of them. Note that you don\'t have to minimize the number of added elements!. So, if an array is good already you are allowed to not append elements." "bitmasks,constructive algorithms,math" 1400
1267H "Help BerLine" "Very soon, the new cell phone services provider ""BerLine"" will begin its work in Berland!The start of customer service is planned along the main street of the capital. There are n base stations that are already installed. They are located one after another along the main street in the order from the 1-st to the n-th from left to right. Currently, all these base stations are turned off. They will be turned on one by one, one base station per day, according to some permutation p=[p1,p2,\xe2\x80\xa6,pn] (1\xe2\x89\xa4pi\xe2\x89\xa4n), where pi is the index of a base station that will be turned on on the i-th day. Thus, it will take n days to turn on all base stations.Each base station is characterized by its operating frequency fi \xe2\x80\x94 an integer between 1 and 24, inclusive.There is an important requirement for operating frequencies of base stations. Consider an arbitrary moment in time. For any phone owner, if we consider all base stations turned on in the access area of their phone, then in this set of base stations there should be at least one whose operating frequency is unique among the frequencies of these stations. Since the power of the phone and the position are not known in advance, this means that for any nonempty subsegment of turned on base stations, at least one of them has to have the operating frequency that is unique among the stations of this subsegment.For example, let\'s take a look at a case of n=7, all n stations are turned on, and their frequencies are equal to f=[1,2,1,3,1,2,1]. Consider any subsegment of the base stations \xe2\x80\x94 there is a base station with a unique frequency within this subsegment. However, if f=[1,2,1,2,3,2,1], then there is no unique frequency on the segment [1,2,1,2] from the index 1 to the index 4, inclusive.Your task is to assign a frequency from 1 to 24 to each of n base stations in such a way that the frequency requirement is met at every moment. Remember that the base stations are turned on in the order of the given permutation p." "constructive algorithms" 3200
98A "Help Victoria the Wise" "Vasilisa the Wise from a far away kingdom got a present from her friend Helga the Wise from a farther away kingdom. The present is a surprise box, yet Vasilisa the Wise doesn\'t know yet what the surprise actually is because she cannot open the box. She hopes that you can help her in that.The box\'s lock is constructed like that. The box itself is represented by an absolutely perfect black cube with the identical deepening on each face (those are some foreign nanotechnologies that the far away kingdom scientists haven\'t dreamt of). The box is accompanied by six gems whose form matches the deepenings in the box\'s faces. The box can only be opened after it is correctly decorated by the gems, that is, when each deepening contains exactly one gem. Two ways of decorating the box are considered the same if they can be obtained one from the other one by arbitrarily rotating the box (note that the box is represented by a perfect nanotechnological cube)Now Vasilisa the Wise wants to know by the given set of colors the following: in how many ways would she decorate the box in the worst case to open it? To answer this question it is useful to know that two gems of one color are indistinguishable from each other. Help Vasilisa to solve this challenging problem." "brute force,implementation" 1700
1970C2 "Game on Tree (Medium)" "This is the medium version of the problem. The difference in this version is that t=1 and we work on trees.Ron and Hermione are playing a game on a tree of n nodes that are initially inactive. The game consists of t rounds, each of which starts with a stone on exactly one node, which is considered as activated. A move consists of picking an inactive neighbor of the node with a stone on it and moving the stone there (thus activating this neighbor). Ron makes the first move, after which he alternates with Hermione until no valid move is available. The player that cannot make a move loses the round. If both players play optimally, who wins each round of this game? Note that all the rounds are played with the same tree; only the starting node changes. Moreover, after each round, all active nodes are considered inactive again." "dfs and similar,dp,games,trees" 1700
235D "Graph Game" "In computer science, there is a method called ""Divide And Conquer By Node"" to solve some hard problems about paths on a tree. Let\'s desribe how this method works by function:solve(t) (t is a tree):   Chose a node x (it\'s common to chose weight-center) in tree t. Let\'s call this step ""Line A"".  Deal with all paths that pass x.  Then delete x from tree t.  After that t becomes some subtrees.  Apply solve on each subtree. This ends when t has only one node because after deleting it, there\'s nothing. Now, WJMZBMR has mistakenly believed that it\'s ok to chose any node in ""Line A"". So he\'ll chose a node at random. To make the situation worse, he thinks a ""tree"" should have the same number of edges and nodes! So this procedure becomes like that.Let\'s define the variable totalCost. Initially the value of totalCost equal to 0. So, solve(t) (now t is a graph):   totalCost\xe2\x80\x89=\xe2\x80\x89totalCost\xe2\x80\x89+\xe2\x80\x89(size of t). The operation ""="" means assignment. (Size of t) means the number of nodes in t.  Choose a node x in graph t at random (uniformly among all nodes of t).  Then delete x from graph t.  After that t becomes some connected components.  Apply solve on each component. He\'ll apply solve on a connected graph with n nodes and n edges. He thinks it will work quickly, but it\'s very slow. So he wants to know the expectation of totalCost of this procedure. Can you help him?" graphs 3000
56D "Changing a String" "There is a string s, consisting of capital Latin letters. Let\'s denote its current length as |s|. During one move it is allowed to apply one of the following operations to it:   INSERT pos ch \xe2\x80\x94 insert a letter ch in the string s in the position pos (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89pos\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|s|\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89A\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ch\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89Z). The letter ch becomes the pos-th symbol of the string s, at that the letters shift aside and the length of the string increases by 1.  DELETE pos \xe2\x80\x94 delete a character number pos (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89pos\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|s|) from the string s. At that the letters shift together and the length of the string decreases by 1.  REPLACE pos ch \xe2\x80\x94 the letter in the position pos of the line s is replaced by ch (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89pos\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|s|,\xe2\x80\x89A\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ch\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89Z). At that the length of the string does not change. Your task is to find in which minimal number of moves one can get a t string from an s string. You should also find the sequence of actions leading to the required results." dp 2100
725E "Too Much Money" "Alfred wants to buy a toy moose that costs c dollars. The store doesn\xe2\x80\x99t give change, so he must give the store exactly c dollars, no more and no less. He has n coins. To make c dollars from his coins, he follows the following algorithm: let S be the set of coins being used. S is initially empty. Alfred repeatedly adds to S the highest-valued coin he has such that the total value of the coins in S after adding the coin doesn\xe2\x80\x99t exceed c. If there is no such coin, and the value of the coins in S is still less than c, he gives up and goes home. Note that Alfred never removes a coin from S after adding it.As a programmer, you might be aware that Alfred\xe2\x80\x99s algorithm can fail even when there is a set of coins with value exactly c. For example, if Alfred has one coin worth $3, one coin worth $4, and two coins worth $5, and the moose costs $12, then Alfred will add both of the $5 coins to S and then give up, since adding any other coin would cause the value of the coins in S to exceed $12. Of course, Alfred could instead combine one $3 coin, one $4 coin, and one $5 coin to reach the total.Bob tried to convince Alfred that his algorithm was flawed, but Alfred didn\xe2\x80\x99t believe him. Now Bob wants to give Alfred some coins (in addition to those that Alfred already has) such that Alfred\xe2\x80\x99s algorithm fails. Bob can give Alfred any number of coins of any denomination (subject to the constraint that each coin must be worth a positive integer number of dollars). There can be multiple coins of a single denomination. He would like to minimize the total value of the coins he gives Alfred. Please find this minimum value. If there is no solution, print ""Greed is good"". You can assume that the answer, if it exists, is positive. In other words, Alfred\'s algorithm will work if Bob doesn\'t give him any coins." "brute force,greedy" 2600
1916B "Two Divisors" "A certain number 1\xe2\x89\xa4x\xe2\x89\xa4109 is chosen. You are given two integers a and b, which are the two largest divisors of the number x. At the same time, the condition 1\xe2\x89\xa4a<b<x is satisfied.For the given numbers a, b, you need to find the value of x.\xe2\x80\xa0 The number y is a divisor of the number x if there is an integer k such that x=y\xe2\x8b\x85k." "constructive algorithms,math,number theory" 1000
1439A1 "Binary Table (Easy Version)" "This is the easy version of the problem. The difference between the versions is in the number of possible operations that can be made. You can make hacks if and only if you solved both versions of the problem.You are given a binary table of size n\xc3\x97m. This table consists of symbols 0 and 1.You can make such operation: select 3 different cells that belong to one 2\xc3\x972 square and change the symbols in these cells (change 0 to 1 and 1 to 0).Your task is to make all symbols in the table equal to 0. You are allowed to make at most 3nm operations. You don\'t need to minimize the number of operations.It can be proved that it is always possible." "constructive algorithms,implementation" 1500
1608D Dominoes "You are given n dominoes. Each domino has a left and a right cell. Each cell can be colored either black or white. Some cells are already colored, while some aren\'t yet.The coloring is said to be valid if and only if it is possible to rearrange the dominoes in some order such that for each 1\xe2\x89\xa4i\xe2\x89\xa4n the color of the right cell of the i-th domino is different from the color of the left cell of the ((imodn)+1)-st domino. Note that you can\'t rotate the dominoes, so the left cell always remains the left cell, and the right cell always remains the right cell.Count the number of valid ways to color the yet uncolored cells of dominoes. Two ways are considered different if there is a cell that is colored white in one way and black in the other. In particular, colorings BW WB and WB BW different (and both invalid).As this number can be very big, output it modulo 998244353." "combinatorics,fft,graphs,math,number theory" 2400
925C "Big Secret" "Vitya has learned that the answer for The Ultimate Question of Life, the Universe, and Everything is not the integer 54 42, but an increasing integer sequence a1,\xe2\x80\xa6,an. In order to not reveal the secret earlier than needed, Vitya encrypted the answer and obtained the sequence b1,\xe2\x80\xa6,bn using the following rules:  b1=a1; bi=ai\xe2\x8a\x95ai\xe2\x88\x921 for all i from 2 to n, where x\xe2\x8a\x95y is the bitwise XOR of x and y. It is easy to see that the original sequence can be obtained using the rule ai=b1\xe2\x8a\x95\xe2\x80\xa6\xe2\x8a\x95bi.However, some time later Vitya discovered that the integers bi in the cypher got shuffled, and it can happen that when decrypted using the rule mentioned above, it can produce a sequence that is not increasing. In order to save his reputation in the scientific community, Vasya decided to find some permutation of integers bi so that the sequence ai=b1\xe2\x8a\x95\xe2\x80\xa6\xe2\x8a\x95bi is strictly increasing. Help him find such a permutation or determine that it is impossible." "constructive algorithms,math" 2200
1305H "Kuroni the Private Tutor" "As a professional private tutor, Kuroni has to gather statistics of an exam. Kuroni has appointed you to complete this important task. You must not disappoint him.The exam consists of n questions, and m students have taken the exam. Each question was worth 1 point. Question i was solved by at least li and at most ri students. Additionally, you know that the total score of all students is t.Furthermore, you took a glance at the final ranklist of the quiz. The students were ranked from 1 to m, where rank 1 has the highest score and rank m has the lowest score. Ties were broken arbitrarily.You know that the student at rank pi had a score of si for 1\xe2\x89\xa4i\xe2\x89\xa4q.You wonder if there could have been a huge tie for first place. Help Kuroni determine the maximum number of students who could have gotten as many points as the student with rank 1, and the maximum possible score for rank 1 achieving this maximum number of students." "binary search,greedy" 3500
375C "Circling Round Treasures" "You have a map as a rectangle table. Each cell of the table is either an obstacle, or a treasure with a certain price, or a bomb, or an empty cell. Your initial position is also given to you.You can go from one cell of the map to a side-adjacent one. At that, you are not allowed to go beyond the borders of the map, enter the cells with treasures, obstacles and bombs. To pick the treasures, you need to build a closed path (starting and ending in the starting cell). The closed path mustn\'t contain any cells with bombs inside. Let\'s assume that the sum of the treasures\' values that are located inside the closed path equals v, and besides, you\'ve made k single moves (from one cell to another) while you were going through the path, then such path brings you the profit of v\xe2\x80\x89-\xe2\x80\x89k rubles.Your task is to build a closed path that doesn\'t contain any bombs and brings maximum profit.Note that the path can have self-intersections. In order to determine if a cell lies inside a path or not, use the following algorithm:  Assume that the table cells are points on the plane (the table cell on the intersection of the i-th column and the j-th row is point (i,\xe2\x80\x89j)). And the given path is a closed polyline that goes through these points.  You need to find out if the point p of the table that is not crossed by the polyline lies inside the polyline.  Let\'s draw a ray that starts from point p and does not intersect other points of the table (such ray must exist).  Let\'s count the number of segments of the polyline that intersect the painted ray. If this number is odd, we assume that point p (and consequently, the table cell) lie inside the polyline (path). Otherwise, we assume that it lies outside." "bitmasks,shortest paths" 2600
1221C "Perfect Team" "You may have already known that a standard ICPC team consists of exactly three members. The perfect team however has more restrictions. A student can have some specialization: coder or mathematician. She/he can have no specialization, but can\'t have both at the same time.So the team is considered perfect if it includes at least one coder, at least one mathematician and it consists of exactly three members.You are a coach at a very large university and you know that c of your students are coders, m are mathematicians and x have no specialization.What is the maximum number of full perfect teams you can distribute them into? Note that some students can be left without a team and each student can be a part of no more than one team.You are also asked to answer q independent queries." "binary search,math" 1200
2036A Quintomania "Boris Notkin composes melodies. He represents them as a sequence of notes, where each note is encoded as an integer from 0 to 127 inclusive. The interval between two notes a and b is equal to |a\xe2\x88\x92b| semitones.Boris considers a melody perfect if the interval between each two adjacent notes is either 5 semitones or 7 semitones.After composing his latest melodies, he enthusiastically shows you his collection of works. Help Boris Notkin understand whether his melodies are perfect." implementation 800
193E "Fibonacci Number" "John Doe has a list of all Fibonacci numbers modulo 1013. This list is infinite, it starts with numbers 0 and 1. Each number in the list, apart from the first two, is a sum of previous two modulo 1013. That is, John\'s list is made from the Fibonacci numbers\' list by replacing each number there by the remainder when divided by 1013. John got interested in number f (0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89f\xe2\x80\x89<\xe2\x80\x891013) and now wants to find its first occurrence in the list given above. Help John and find the number of the first occurence of number f in the list or otherwise state that number f does not occur in the list. The numeration in John\'s list starts from zero. There, the 0-th position is the number 0, the 1-st position is the number 1, the 2-nd position is the number 1, the 3-rd position is the number 2, the 4-th position is the number 3 and so on. Thus, the beginning of the list looks like this: 0,\xe2\x80\x891,\xe2\x80\x891,\xe2\x80\x892,\xe2\x80\x893,\xe2\x80\x895,\xe2\x80\x898,\xe2\x80\x8913,\xe2\x80\x8921,\xe2\x80\x89..." "brute force,math,matrices" 2900
1252K "Addition Robot" "Adding two numbers several times is a time-consuming task, so you want to build a robot. The robot should have a string S=S1S2\xe2\x80\xa6SN of N characters on its memory that represents addition instructions. Each character of the string, Si, is either \'A\' or \'B\'.You want to be able to give Q commands to the robot, each command is either of the following types:   1 L R. The robot should toggle all the characters of Si where L\xe2\x89\xa4i\xe2\x89\xa4R. Toggling a character means changing it to \'A\' if it was previously \'B\', or changing it to \'B\' if it was previously \'A\'.  2 L R A B. The robot should call f(L,R,A,B) and return two integers as defined in the following pseudocode:     function f(L, R, A, B):      FOR i from L to R        if S[i] = \'A\'          A = A + B        else          B = A + B      return (A, B)   You want to implement the robot\'s expected behavior." "data structures,math,matrices" 2100
44D Hyperdrive "In a far away galaxy there are n inhabited planets, numbered with numbers from 1 to n. They are located at large distances from each other, that\'s why the communication between them was very difficult until on the planet number 1 a hyperdrive was invented. As soon as this significant event took place, n\xe2\x80\x89-\xe2\x80\x891 spaceships were built on the planet number 1, and those ships were sent to other planets to inform about the revolutionary invention. Paradoxical thought it may be, but the hyperspace is represented as simple three-dimensional Euclidean space. The inhabited planets may be considered fixed points in it, and no two points coincide and no three points lie on the same straight line. The movement of a ship with a hyperdrive between two planets is performed along a straight line at the constant speed, the same for all the ships. That\'s why the distance in the hyperspace are measured in hyperyears (a ship with a hyperdrive covers a distance of s hyperyears in s years).When the ship reaches an inhabited planet, the inhabitants of the planet dissemble it, make n\xe2\x80\x89-\xe2\x80\x892 identical to it ships with a hyperdrive and send them to other n\xe2\x80\x89-\xe2\x80\x892 planets (except for the one from which the ship arrived). The time to make a new ship compared to the time in which they move from one planet to another is so small that it can be disregarded. New ships are absolutely identical to the ones sent initially: they move at the same constant speed along a straight line trajectory and, having reached a planet, perform the very same mission, i.e. are dissembled to build new n\xe2\x80\x89-\xe2\x80\x892 ships and send them to all the planets except for the one from which the ship arrived. Thus, the process of spreading the important news around the galaxy continues.However the hyperdrive creators hurried to spread the news about their invention so much that they didn\'t study completely what goes on when two ships collide in the hyperspace. If two moving ships find themselves at one point, they provoke an explosion of colossal power, leading to the destruction of the galaxy!Your task is to find the time the galaxy will continue to exist from the moment of the ships\' launch from the first planet." math 1800
62A "A Student\'s Dream" "Statistics claims that students sleep no more than three hours a day. But even in the world of their dreams, while they are snoring peacefully, the sense of impending doom is still upon them.A poor student is dreaming that he is sitting the mathematical analysis exam. And he is examined by the most formidable professor of all times, a three times Soviet Union Hero, a Noble Prize laureate in student expulsion, venerable Petr Palych.The poor student couldn\'t answer a single question. Thus, instead of a large spacious office he is going to apply for a job to thorium mines. But wait a minute! Petr Palych decided to give the student the last chance! Yes, that is possible only in dreams. So the professor began: ""Once a Venusian girl and a Marsian boy met on the Earth and decided to take a walk holding hands. But the problem is the girl has al fingers on her left hand and ar fingers on the right one. The boy correspondingly has bl and br fingers. They can only feel comfortable when holding hands, when no pair of the girl\'s fingers will touch each other. That is, they are comfortable when between any two girl\'s fingers there is a boy\'s finger. And in addition, no three fingers of the boy should touch each other. Determine if they can hold hands so that the both were comfortable.""The boy any the girl don\'t care who goes to the left and who goes to the right. The difference is only that if the boy goes to the left of the girl, he will take her left hand with his right one, and if he goes to the right of the girl, then it is vice versa." greedy,math 1300
954I "Yet Another String Matching Problem" "Suppose you have two strings s and t, and their length is equal. You may perform the following operation any number of times: choose two different characters c1 and c2, and replace every occurence of c1 in both strings with c2. Let\'s denote the distance between strings s and t as the minimum number of operations required to make these strings equal. For example, if s is abcd and t is ddcb, the distance between them is 2 \xe2\x80\x94 we may replace every occurence of a with b, so s becomes bbcd, and then we may replace every occurence of b with d, so both strings become ddcd.You are given two strings S and T. For every substring of S consisting of |T| characters you have to determine the distance between this substring and T." fft,math 2200
584A "Olesya and Rodion" "Olesya loves numbers consisting of n digits, and Rodion only likes numbers that are divisible by t. Find some number that satisfies both of them.Your task is: given the n and t print an integer strictly larger than zero consisting of n digits that is divisible by t. If such number doesn\'t exist, print \xe2\x80\x89-\xe2\x80\x891." math 1000
1185A Ropewalkers "Polycarp decided to relax on his weekend and visited to the performance of famous ropewalkers: Agafon, Boniface and Konrad.The rope is straight and infinite in both directions. At the beginning of the performance, Agafon, Boniface and Konrad are located in positions a, b and c respectively. At the end of the performance, the distance between each pair of ropewalkers was at least d.Ropewalkers can walk on the rope. In one second, only one ropewalker can change his position. Every ropewalker can change his position exactly by 1 (i. e. shift by 1 to the left or right direction on the rope). Agafon, Boniface and Konrad can not move at the same time (Only one of them can move at each moment). Ropewalkers can be at the same positions at the same time and can ""walk past each other"".You should find the minimum duration (in seconds) of the performance. In other words, find the minimum number of seconds needed so that the distance between each pair of ropewalkers can be greater or equal to d.Ropewalkers can walk to negative coordinates, due to the rope is infinite to both sides." math 800
1547C "Pair Programming" "Monocarp and Polycarp are learning new programming techniques. Now they decided to try pair programming.It\'s known that they have worked together on the same file for n+m minutes. Every minute exactly one of them made one change to the file. Before they started, there were already k lines written in the file.Every minute exactly one of them does one of two actions: adds a new line to the end of the file or changes one of its lines.Monocarp worked in total for n minutes and performed the sequence of actions [a1,a2,\xe2\x80\xa6,an]. If ai=0, then he adds a new line to the end of the file. If ai>0, then he changes the line with the number ai. Monocarp performed actions strictly in this order: a1, then a2, ..., an.Polycarp worked in total for m minutes and performed the sequence of actions [b1,b2,\xe2\x80\xa6,bm]. If bj=0, then he adds a new line to the end of the file. If bj>0, then he changes the line with the number bj. Polycarp performed actions strictly in this order: b1, then b2, ..., bm.Restore their common sequence of actions of length n+m such that all actions would be correct \xe2\x80\x94 there should be no changes to lines that do not yet exist. Keep in mind that in the common sequence Monocarp\'s actions should form the subsequence [a1,a2,\xe2\x80\xa6,an] and Polycarp\'s \xe2\x80\x94 subsequence [b1,b2,\xe2\x80\xa6,bm]. They can replace each other at the computer any number of times.Let\'s look at an example. Suppose k=3. Monocarp first changed the line with the number 2 and then added a new line (thus, n=2,a=[2,0]). Polycarp first added a new line and then changed the line with the number 5 (thus, m=2,b=[0,5]).Since the initial length of the file was 3, in order for Polycarp to change line number 5 two new lines must be added beforehand. Examples of correct sequences of changes, in this case, would be [0,2,0,5] and [2,0,0,5]. Changes [0,0,5,2] (wrong order of actions) and [0,5,2,0] (line 5 cannot be edited yet) are not correct." "greedy,two pointers" 1100
999C "Alphabetic Removals" "You are given a string s consisting of n lowercase Latin letters. Polycarp wants to remove exactly k characters (k\xe2\x89\xa4n) from the string s. Polycarp uses the following algorithm k times:  if there is at least one letter \'a\', remove the leftmost occurrence and stop the algorithm, otherwise go to next item;  if there is at least one letter \'b\', remove the leftmost occurrence and stop the algorithm, otherwise go to next item;  ...  remove the leftmost occurrence of the letter \'z\' and stop the algorithm. This algorithm removes a single letter from the string. Polycarp performs this algorithm exactly k times, thus removing exactly k characters.Help Polycarp find the resulting string." implementation 1200
1466E "Apollo versus Pan" "Only a few know that Pan and Apollo weren\'t only battling for the title of the GOAT musician. A few millenniums later, they also challenged each other in math (or rather in fast calculations). The task they got to solve is the following:Let x1,x2,\xe2\x80\xa6,xn be the sequence of n non-negative integers. Find this value: n\xe2\x88\x91i=1n\xe2\x88\x91j=1n\xe2\x88\x91k=1(xi&xj)\xe2\x8b\x85(xj|xk)Here & denotes the bitwise and, and | denotes the bitwise or.Pan and Apollo could solve this in a few seconds. Can you do it too? For convenience, find the answer modulo 109+7." "bitmasks,brute force,math" 1800
898F "Restoring the Expression" "A correct expression of the form a+b=c was written; a, b and c are non-negative integers without leading zeros. In this expression, the plus and equally signs were lost. The task is to restore the expression. In other words, one character \'+\' and one character \'=\' should be inserted into given sequence of digits so that:   character\'+\' is placed on the left of character \'=\',  characters \'+\' and \'=\' split the sequence into three non-empty subsequences consisting of digits (let\'s call the left part a, the middle part \xe2\x80\x94 b and the right part \xe2\x80\x94 c),  all the three parts a, b and c do not contain leading zeros,  it is true that a+b=c. It is guaranteed that in given tests answer always exists." "brute force,hashing,math" 2300
392C "Yet Another Number Sequence" "Everyone knows what the Fibonacci sequence is. This sequence can be defined by the recurrence relation: F1\xe2\x80\x89=\xe2\x80\x891,\xe2\x80\x89F2\xe2\x80\x89=\xe2\x80\x892,\xe2\x80\x89Fi\xe2\x80\x89=\xe2\x80\x89Fi\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x89Fi\xe2\x80\x89-\xe2\x80\x892 (i\xe2\x80\x89>\xe2\x80\x892).We\'ll define a new number sequence Ai(k) by the formula: Ai(k)\xe2\x80\x89=\xe2\x80\x89Fi\xe2\x80\x89\xc3\x97\xe2\x80\x89ik (i\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x891).In this problem, your task is to calculate the following sum: A1(k)\xe2\x80\x89+\xe2\x80\x89A2(k)\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89An(k). The answer can be very large, so print it modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." combinatorics,math,matrices -999
683H "Exchange of Books" "n pupils, who love to read books, study at school. It is known that each student has exactly one best friend, and each pupil is the best friend of exactly one other pupil. Each of the pupils has exactly one interesting book.The pupils decided to share books with each other. Every day, all pupils give their own books to their best friends. Thus, every day each of the pupils has exactly one book.Your task is to use the list of the best friends and determine the exchange of books among pupils after k days. For simplicity, all students are numbered from 1 to n in all tests." "*special problem" 1900
2025C "New Game" "There\'s a new game Monocarp wants to play. The game uses a deck of n cards, where the i-th card has exactly one integer ai written on it.At the beginning of the game, on the first turn, Monocarp can take any card from the deck. During each subsequent turn, Monocarp can take exactly one card that has either the same number as on the card taken on the previous turn or a number that is one greater than the number on the card taken on the previous turn.In other words, if on the previous turn Monocarp took a card with the number x, then on the current turn he can take either a card with the number x or a card with the number x+1. Monocarp can take any card which meets that condition, regardless of its position in the deck.After Monocarp takes a card on the current turn, it is removed from the deck.According to the rules of the game, the number of distinct numbers written on the cards that Monocarp has taken must not exceed k.If, after a turn, Monocarp cannot take a card without violating the described rules, the game ends.Your task is to determine the maximum number of cards that Monocarp can take from the deck during the game, given that on the first turn he can take any card from the deck." "binary search,brute force,greedy,implementation,sortings,two pointers" 1300
1765K "Torus Path" "You are given a square grid with n rows and n columns, where each cell has a non-negative integer written in it. There is a chip initially placed at the top left cell (the cell with coordinates (1,1)). You need to move the chip to the bottom right cell (the cell with coordinates (n,n)).In one step, you can move the chip to the neighboring cell, but:   you can move only right or down. In other words, if the current cell is (x,y), you can move either to (x,y+1) or to (x+1,y). There are two special cases:   if the chip is in the last column (cell (x,n)) and you\'re moving right, you\'ll teleport to the first column (to the cell (x,1));  if the chip is in the last row (cell (n,y)) and you\'re moving down, you\'ll teleport to the first row (to the cell (1,y)).   you cannot visit the same cell twice. The starting cell is counted visited from the beginning (so you cannot enter it again), and you can\'t leave the finishing cell once you visit it. Your total score is counted as the sum of numbers in all cells you have visited. What is the maximum possible score you can achieve?" greedy,math 1500
201D "Brand New Problem" "A widely known among some people Belarusian sport programmer Lesha decided to make some money to buy a one square meter larger flat. To do this, he wants to make and carry out a Super Rated Match (SRM) on the site Torcoder.com. But there\'s a problem \xe2\x80\x94 a severe torcoder coordinator Ivan does not accept any Lesha\'s problem, calling each of them an offensive word ""duped"" (that is, duplicated). And one day they nearely quarrelled over yet another problem Ivan wouldn\'t accept.You are invited to act as a fair judge and determine whether the problem is indeed brand new, or Ivan is right and the problem bears some resemblance to those used in the previous SRMs.You are given the descriptions of Lesha\'s problem and each of Torcoder.com archive problems. The description of each problem is a sequence of words. Besides, it is guaranteed that Lesha\'s problem has no repeated words, while the description of an archive problem may contain any number of repeated words.The ""similarity"" between Lesha\'s problem and some archive problem can be found as follows. Among all permutations of words in Lesha\'s problem we choose the one that occurs in the archive problem as a subsequence. If there are multiple such permutations, we choose the one with the smallest number of inversions. Then the ""similarity"" of a problem can be written as , where n is the number of words in Lesha\'s problem and x is the number of inversions in the chosen permutation. Note that the ""similarity"" p is always a positive integer.The problem is called brand new if there is not a single problem in Ivan\'s archive which contains a permutation of words from Lesha\'s problem as a subsequence.Help the boys and determine whether the proposed problem is new, or specify the problem from the archive which resembles Lesha\'s problem the most, otherwise." "bitmasks,brute force,dp" 2600
1662E "Round Table" "There are n people, numbered from 1 to n, sitting at a round table. Person i+1 is sitting to the right of person i (with person 1 sitting to the right of person n).You have come up with a better seating arrangement, which is given as a permutation p1,p2,\xe2\x80\xa6,pn. More specifically, you want to change the seats of the people so that at the end person pi+1 is sitting to the right of person pi (with person p1 sitting to the right of person pn). Notice that for each seating arrangement there are n permutations that describe it (which can be obtained by rotations).In order to achieve that, you can swap two people sitting at adjacent places; but there is a catch: for all 1\xe2\x89\xa4x\xe2\x89\xa4n\xe2\x88\x921 you cannot swap person x and person x+1 (notice that you can swap person n and person 1). What is the minimum number of swaps necessary? It can be proven that any arrangement can be achieved." math -999
594D REQ "Today on a math lesson the teacher told Vovochka that the Euler function of a positive integer \xcf\x86(n) is an arithmetic function that counts the positive integers less than or equal to n that are relatively prime to n. The number 1 is coprime to all the positive integers and \xcf\x86(1)\xe2\x80\x89=\xe2\x80\x891.Now the teacher gave Vovochka an array of n positive integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an and a task to process q queries li ri \xe2\x80\x94 to calculate and print  modulo 109\xe2\x80\x89+\xe2\x80\x897. As it is too hard for a second grade school student, you\'ve decided to help Vovochka." "data structures,number theory" 2500
1760F Quests "There are n quests. If you complete the i-th quest, you will gain ai coins. You can only complete at most one quest per day. However, once you complete a quest, you cannot do the same quest again for k days. (For example, if k=2 and you do quest 1 on day 1, then you cannot do it on day 2 or 3, but you can do it again on day 4.)You are given two integers c and d. Find the maximum value of k such that you can gain at least c coins over d days. If no such k exists, output Impossible. If k can be arbitrarily large, output Infinity." "binary search,greedy,sortings" 1500
888F "Connecting Vertices" "There are n points marked on the plane. The points are situated in such a way that they form a regular polygon (marked points are its vertices, and they are numbered in counter-clockwise order). You can draw n\xe2\x80\x89-\xe2\x80\x891 segments, each connecting any two marked points, in such a way that all points have to be connected with each other (directly or indirectly).But there are some restrictions. Firstly, some pairs of points cannot be connected directly and have to be connected undirectly. Secondly, the segments you draw must not intersect in any point apart from the marked points (that is, if any two segments intersect and their intersection is not a marked point, then the picture you have drawn is invalid).How many ways are there to connect all vertices with n\xe2\x80\x89-\xe2\x80\x891 segments? Two ways are considered different iff there exist some pair of points such that a segment is drawn between them in the first way of connection, but it is not drawn between these points in the second one. Since the answer might be large, output it modulo 109\xe2\x80\x89+\xe2\x80\x897." dp,graphs 2500
417C Football "One day, at the ""Russian Code Cup"" event it was decided to play football as an out of competition event. All participants was divided into n teams and played several matches, two teams could not play against each other more than once.The appointed Judge was the most experienced member \xe2\x80\x94 Pavel. But since he was the wisest of all, he soon got bored of the game and fell asleep. Waking up, he discovered that the tournament is over and the teams want to know the results of all the matches.Pavel didn\'t want anyone to discover about him sleeping and not keeping an eye on the results, so he decided to recover the results of all games. To do this, he asked all the teams and learned that the real winner was friendship, that is, each team beat the other teams exactly k times. Help Pavel come up with chronology of the tournir that meets all the conditions, or otherwise report that there is no such table." "constructive algorithms,graphs,implementation" 1400
1320C "World of Darkraft: Battle for Azathoth" "Roma is playing a new expansion for his favorite game World of Darkraft. He made a new character and is going for his first grind.Roma has a choice to buy exactly one of n different weapons and exactly one of m different armor sets. Weapon i has attack modifier ai and is worth cai coins, and armor set j has defense modifier bj and is worth cbj coins.After choosing his equipment Roma can proceed to defeat some monsters. There are p monsters he can try to defeat. Monster k has defense xk, attack yk and possesses zk coins. Roma can defeat a monster if his weapon\'s attack modifier is larger than the monster\'s defense, and his armor set\'s defense modifier is larger than the monster\'s attack. That is, a monster k can be defeated with a weapon i and an armor set j if ai>xk and bj>yk. After defeating the monster, Roma takes all the coins from them. During the grind, Roma can defeat as many monsters as he likes. Monsters do not respawn, thus each monster can be defeated at most one.Thanks to Roma\'s excessive donations, we can assume that he has an infinite amount of in-game currency and can afford any of the weapons and armor sets. Still, he wants to maximize the profit of the grind. The profit is defined as the total coins obtained from all defeated monsters minus the cost of his equipment. Note that Roma must purchase a weapon and an armor set even if he can not cover their cost with obtained coins.Help Roma find the maximum profit of the grind." "brute force,data structures,sortings" 2000
1974D Ingenuity-2 "Let\'s imagine the surface of Mars as an infinite coordinate plane. Initially, the rover Perseverance-2 and the helicopter Ingenuity-2 are located at the point with coordinates (0,0). A set of instructions s consisting of n instructions of the following types was specially developed for them:  N: move one meter north (from point (x,y) to (x,y+1));  S: move one meter south (from point (x,y) to (x,y\xe2\x88\x921));  E: move one meter east (from point (x,y) to (x+1,y));  W: move one meter west (from point (x,y) to (x\xe2\x88\x921,y)). Each instruction must be executed either by the rover or by the helicopter. Moreover, each device must execute at least one instruction. Your task is to distribute the instructions in such a way that after executing all n instructions, the helicopter and the rover end up at the same point, or determine that this is impossible." "constructive algorithms,greedy,implementation" 1400
1846F "Rudolph and Mimic" "This is an interactive task.Rudolph is a scientist who studies alien life forms. There is a room in front of Rudolph with n different objects scattered around. Among the objects there is exactly one amazing creature \xe2\x80\x94 a mimic that can turn into any object. He has already disguised himself in this room and Rudolph needs to find him by experiment.The experiment takes place in several stages. At each stage, the following happens: Rudolf looks at all the objects in the room and writes down their types. The type of each object is indicated by a number; there can be several objects of the same type. After inspecting, Rudolph can point to an object that he thinks is a mimic. After that, the experiment ends. Rudolph only has one try, so if he is unsure of the mimic\'s position, he does the next step instead. Rudolf can remove any number of objects from the room (possibly zero). Then Rudolf leaves the room and at this time all objects, including the mimic, are mixed with each other, their order is changed, and the mimic can transform into any other object (even one that is not in the room). After this, Rudolf returns to the room and repeats the stage. The mimic may not change appearance, but it can not remain a same object for more than two stages in a row.Rudolf\'s task is to detect mimic in no more than five stages." "constructive algorithms,implementation,interactive" 1800
796A "Buying A House" "Zane the wizard had never loved anyone before, until he fell in love with a girl, whose name remains unknown to us.  The girl lives in house m of a village. There are n houses in that village, lining in a straight line from left to right: house 1, house 2, ..., house n. The village is also well-structured: house i and house i\xe2\x80\x89+\xe2\x80\x891 (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89n) are exactly 10 meters away. In this village, some houses are occupied, and some are not. Indeed, unoccupied houses can be purchased.You will be given n integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an that denote the availability and the prices of the houses. If house i is occupied, and therefore cannot be bought, then ai equals 0. Otherwise, house i can be bought, and ai represents the money required to buy it, in dollars.As Zane has only k dollars to spare, it becomes a challenge for him to choose the house to purchase, so that he could live as near as possible to his crush. Help Zane determine the minimum distance from his crush\'s house to some house he can afford, to help him succeed in his love." "brute force,implementation" 800
440B Balancer "Petya has k matches, placed in n matchboxes lying in a line from left to right. We know that k is divisible by n. Petya wants all boxes to have the same number of matches inside. For that, he can move a match from its box to the adjacent one in one move. How many such moves does he need to achieve the desired configuration?" greedy,implementation 1600
723A "The New Year: Meeting Friends" "There are three friend living on the straight line Ox in Lineland. The first friend lives at the point x1, the second friend lives at the point x2, and the third friend lives at the point x3. They plan to celebrate the New Year together, so they need to meet at one point. What is the minimum total distance they have to travel in order to meet at some point and celebrate the New Year?It\'s guaranteed that the optimal answer is always integer." implementation,math,sortings 800
1237C1 "Balanced Removals (Easier)" "This is an easier version of the problem. In this version, n\xe2\x89\xa42000.There are n distinct points in three-dimensional space numbered from 1 to n. The i-th point has coordinates (xi,yi,zi). The number of points n is even.You\'d like to remove all n points using a sequence of n2 snaps. In one snap, you can remove any two points a and b that have not been removed yet and form a perfectly balanced pair. A pair of points a and b is perfectly balanced if no other point c (that has not been removed yet) lies within the axis-aligned minimum bounding box of points a and b.Formally, point c lies within the axis-aligned minimum bounding box of points a and b if and only if min(xa,xb)\xe2\x89\xa4xc\xe2\x89\xa4max(xa,xb), min(ya,yb)\xe2\x89\xa4yc\xe2\x89\xa4max(ya,yb), and min(za,zb)\xe2\x89\xa4zc\xe2\x89\xa4max(za,zb). Note that the bounding box might be degenerate. Find a way to remove all points in n2 snaps." "constructive algorithms,geometry,greedy" 1700
2022D2 "Asesino (Hard Version)" "This is the hard version of the problem. In this version, you must use the minimum number of queries possible. You can make hacks only if both versions of the problem are solved.This is an interactive problem.It is a tradition in Mexico\'s national IOI trainings to play the game ""Asesino"", which is similar to ""Among Us"" or ""Mafia"".Today, n players, numbered from 1 to n, will play ""Asesino"" with the following three roles:  Knight: a Knight is someone who always tells the truth.  Knave: a Knave is someone who always lies.  Impostor: an Impostor is someone everybody thinks is a Knight, but is secretly a Knave. Each player will be assigned a role in the game. There will be exactly one Impostor but there can be any (possible zero) number of Knights and Knaves.As the game moderator, you have accidentally forgotten the roles of everyone, but you need to determine the player who is the Impostor.To determine the Impostor, you will ask some questions. In each question, you will pick two players i and j (1\xe2\x89\xa4i,j\xe2\x89\xa4n; i\xe2\x89\xa0j) and ask if player i thinks that player j is a Knight. The results of the question is shown in the table below. KnightKnaveImpostorKnightYesNoYesKnaveNoYesNoImpostorNoYes\xe2\x80\x94 The response of the cell in row a and column b is the result of asking a question when i has role a and j has row b. For example, the ""Yes"" in the top right cell belongs to row ""Knight"" and column ""Impostor"", so it is the response when i is a Knight and j is an Impostor. Find the Impostor in the minimum number of queries possible. That is, let f(n) be the minimum integer such that for n players, there exists a strategy that can determine the Impostor using at most f(n) questions. Then, you should use at most f(n) questions to determine the Impostor.Note: the grader is adaptive: the roles of the players are not fixed in the beginning and may change depending on your questions. However, it is guaranteed that there exists an assignment of roles that is consistent with all previously asked questions under the constraints of this problem." "constructive algorithms,dp,interactive" 2700
180E Cubes "Let\'s imagine that you\'re playing the following simple computer game. The screen displays n lined-up cubes. Each cube is painted one of m colors. You are allowed to delete not more than k cubes (that do not necessarily go one after another). After that, the remaining cubes join together (so that the gaps are closed) and the system counts the score. The number of points you score equals to the length of the maximum sequence of cubes of the same color that follow consecutively. Write a program that determines the maximum possible number of points you can score.Remember, you may delete no more than k any cubes. It is allowed not to delete cubes at all." "binary search,dp,two pointers" 1800
1559E "Mocha and Stars" "Mocha wants to be an astrologer. There are n stars which can be seen in Zhijiang, and the brightness of the i-th star is ai. Mocha considers that these n stars form a constellation, and she uses (a1,a2,\xe2\x80\xa6,an) to show its state. A state is called mathematical if all of the following three conditions are satisfied:  For all i (1\xe2\x89\xa4i\xe2\x89\xa4n), ai is an integer in the range [li,ri]. n\xe2\x88\x91i=1ai\xe2\x89\xa4m. gcd(a1,a2,\xe2\x80\xa6,an)=1. Here, gcd(a1,a2,\xe2\x80\xa6,an) denotes the greatest common divisor (GCD) of integers a1,a2,\xe2\x80\xa6,an.Mocha is wondering how many different mathematical states of this constellation exist. Because the answer may be large, you must find it modulo 998244353.Two states (a1,a2,\xe2\x80\xa6,an) and (b1,b2,\xe2\x80\xa6,bn) are considered different if there exists i (1\xe2\x89\xa4i\xe2\x89\xa4n) such that ai\xe2\x89\xa0bi." "combinatorics,dp,fft,math,number theory" 2200
262B "Roma and Changing Signs" "Roma works in a company that sells TVs. Now he has to prepare a report for the last year.Roma has got a list of the company\'s incomes. The list is a sequence that consists of n integers. The total income of the company is the sum of all integers in sequence. Roma decided to perform exactly k changes of signs of several numbers in the sequence. He can also change the sign of a number one, two or more times.The operation of changing a number\'s sign is the operation of multiplying this number by -1.Help Roma perform the changes so as to make the total income of the company (the sum of numbers in the resulting sequence) maximum. Note that Roma should perform exactly k changes." greedy 1200
501C "Misha and Forest" "Let\'s define a forest as a non-directed acyclic graph (also without loops and parallel edges). One day Misha played with the forest consisting of n vertices. For each vertex v from 0 to n\xe2\x80\x89-\xe2\x80\x891 he wrote down two integers, degreev and sv, were the first integer is the number of vertices adjacent to vertex v, and the second integer is the XOR sum of the numbers of vertices adjacent to v (if there were no adjacent vertices, he wrote down 0). Next day Misha couldn\'t remember what graph he initially had. Misha has values degreev and sv left, though. Help him find the number of edges and the edges of the initial graph. It is guaranteed that there exists a forest that corresponds to the numbers written by Misha." "constructive algorithms,data structures,greedy,sortings,trees" 1500
884E "Binary Matrix" "You are given a matrix of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m. Each element of the matrix is either 1 or 0. You have to determine the number of connected components consisting of 1\'s. Two cells belong to the same component if they have a common border, and both elements in these cells are 1\'s.Note that the memory limit is unusual!" dsu 2500
2028A "Alice\'s Adventures in \'\'Chess\'\'" "Alice is trying to meet up with the Red Queen in the countryside! Right now, Alice is at position (0,0), and the Red Queen is at position (a,b). Alice can only move in the four cardinal directions (north, east, south, west). More formally, if Alice is at the point (x,y), she will do one of the following:   go north (represented by N), moving to (x,y+1);  go east (represented by E), moving to (x+1,y);  go south (represented by S), moving to (x,y\xe2\x88\x921); or  go west (represented by W), moving to (x\xe2\x88\x921,y). Alice\'s movements are predetermined. She has a string s representing a sequence of moves that she performs from left to right. Once she reaches the end of the sequence, she repeats the same pattern of moves forever.Can you help Alice figure out if she will ever meet the Red Queen?" "brute force,implementation,math" 900
1617B "GCD Problem" "Given a positive integer n. Find three distinct positive integers a, b, c such that a+b+c=n and gcd(a,b)=c, where gcd(x,y) denotes the greatest common divisor (GCD) of integers x and y." "brute force,constructive algorithms,math,number theory" 900
1528F "AmShZ Farm" "To AmShZ, all arrays are equal, but some arrays are more-equal than others. Specifically, the arrays consisting of n elements from 1 to n that can be turned into permutations of numbers from 1 to n by adding a non-negative integer to each element.Mashtali who wants to appear in every problem statement thinks that an array b consisting of k elements is compatible with a more-equal array a consisting of n elements if for each 1\xe2\x89\xa4i\xe2\x89\xa4k we have 1\xe2\x89\xa4bi\xe2\x89\xa4n and also ab1=ab2=\xe2\x80\xa6=abk.Find the number of pairs of arrays a and b such that a is a more-equal array consisting of n elements and b is an array compatible with a consisting of k elements modulo 998244353.Note that the elements of b are not necessarily distinct, same holds for a." combinatorics,fft,math 3300
245F "Log Stream Analysis" "You\'ve got a list of program warning logs. Each record of a log stream is a string in this format:  ""2012-MM-DD HH:MM:SS:MESSAGE"" (without the quotes). String ""MESSAGE"" consists of spaces, uppercase and lowercase English letters and characters ""!"", ""."", "","", ""?"". String ""2012-MM-DD"" determines a correct date in the year of 2012. String ""HH:MM:SS"" determines a correct time in the 24 hour format.The described record of a log stream means that at a certain time the record has got some program warning (string ""MESSAGE"" contains the warning\'s description).Your task is to print the first moment of time, when the number of warnings for the last n seconds was not less than m." "binary search,brute force,implementation,strings" 2000
710D "Two Arithmetic Progressions" "You are given two arithmetic progressions: a1k\xe2\x80\x89+\xe2\x80\x89b1 and a2l\xe2\x80\x89+\xe2\x80\x89b2. Find the number of integers x such that L\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89R and x\xe2\x80\x89=\xe2\x80\x89a1k\'\xe2\x80\x89+\xe2\x80\x89b1\xe2\x80\x89=\xe2\x80\x89a2l\'\xe2\x80\x89+\xe2\x80\x89b2, for some integers k\',\xe2\x80\x89l\'\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x890." "math,number theory" 2500
1066F "Yet another 2D Walking" "Maksim walks on a Cartesian plane. Initially, he stands at the point (0,0) and in one move he can go to any of four adjacent points (left, right, up, down). For example, if Maksim is currently at the point (0,0), he can go to any of the following points in one move:   (1,0);  (0,1);  (\xe2\x88\x921,0);  (0,\xe2\x88\x921). There are also n distinct key points at this plane. The i-th point is pi=(xi,yi). It is guaranteed that 0\xe2\x89\xa4xi and 0\xe2\x89\xa4yi and there is no key point (0,0).Let the first level points be such points that max(xi,yi)=1, the second level points be such points that max(xi,yi)=2 and so on. Maksim wants to visit all the key points. But he shouldn\'t visit points of level i+1 if he does not visit all the points of level i. He starts visiting the points from the minimum level of point from the given set.The distance between two points (x1,y1) and (x2,y2) is |x1\xe2\x88\x92x2|+|y1\xe2\x88\x92y2| where |v| is the absolute value of v.Maksim wants to visit all the key points in such a way that the total distance he walks will be minimum possible. Your task is to find this distance.If you are Python programmer, consider using PyPy instead of Python when you submit your code." dp 2100
1867C "Salyg1n and the MEX Game" "This is an interactive problem!salyg1n gave Alice a set S of n distinct integers s1,s2,\xe2\x80\xa6,sn (0\xe2\x89\xa4si\xe2\x89\xa4109). Alice decided to play a game with this set against Bob. The rules of the game are as follows:  Players take turns, with Alice going first.  In one move, Alice adds one number x (0\xe2\x89\xa4x\xe2\x89\xa4109) to the set S. The set S must not contain the number x at the time of the move. In one move, Bob removes one number y from the set S. The set S must contain the number y at the time of the move. Additionally, the number y must be strictly smaller than the last number added by Alice. The game ends when Bob cannot make a move or after 2\xe2\x8b\x85n+1 moves (in which case Alice\'s move will be the last one). The result of the game is MEX\xe2\x80\xa0(S) (S at the end of the game). Alice aims to maximize the result, while Bob aims to minimize it. Let R be the result when both players play optimally. In this problem, you play as Alice against the jury program playing as Bob. Your task is to implement a strategy for Alice such that the result of the game is always at least R.\xe2\x80\xa0 MEX of a set of integers c1,c2,\xe2\x80\xa6,ck is defined as the smallest non-negative integer x which does not occur in the set c. For example, MEX({0,1,2,4}) = 3." "constructive algorithms,data structures,games,greedy,interactive" 1300
269E "String Theory" "Emuskald is an innovative musician and always tries to push the boundaries of music production. Now he has come up with an idea for a revolutionary musical instrument \xe2\x80\x94 a rectangular harp.A rectangular harp is a rectangle n\xe2\x80\x89\xc3\x97\xe2\x80\x89m consisting of n rows and m columns. The rows are numbered 1 to n from top to bottom. Similarly the columns are numbered 1 to m from left to right. String pins are spaced evenly across every side, one per unit. Thus there are n pins on the left and right sides of the harp and m pins on its top and bottom. The harp has exactly n\xe2\x80\x89+\xe2\x80\x89m different strings, each string connecting two different pins, each on a different side of the harp.Emuskald has ordered his apprentice to construct the first ever rectangular harp. However, he didn\'t mention that no two strings can cross, otherwise it would be impossible to play the harp. Two strings cross if the segments connecting their pins intersect. To fix the harp, Emuskald can perform operations of two types:   pick two different columns and swap their pins on each side of the harp, not changing the pins that connect each string;  pick two different rows and swap their pins on each side of the harp, not changing the pins that connect each string; In the following example, he can fix the harp by swapping two columns:   Help Emuskald complete his creation and find the permutations how the rows and columns of the harp need to be rearranged, or tell that it is impossible to do so. He can detach and reattach each string to its pins, so the physical layout of the strings doesn\'t matter." geometry,math,strings 3100
436C "Dungeons and Candies" "During the loading of the game ""Dungeons and Candies"" you are required to get descriptions of k levels from the server. Each description is a map of an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m checkered rectangular field. Some cells of the field contain candies (each cell has at most one candy). An empty cell is denoted as ""."" on the map, but if a cell has a candy, it is denoted as a letter of the English alphabet. A level may contain identical candies, in this case the letters in the corresponding cells of the map will be the same.  When you transmit information via a network, you want to minimize traffic \xe2\x80\x94 the total size of the transferred data. The levels can be transmitted in any order. There are two ways to transmit the current level A:  You can transmit the whole level A. Then you need to transmit n\xc2\xb7m bytes via the network.  You can transmit the difference between level A and some previously transmitted level B (if it exists); this operation requires to transmit dA,\xe2\x80\x89B\xc2\xb7w bytes, where dA,\xe2\x80\x89B is the number of cells of the field that are different for A and B, and w is a constant. Note, that you should compare only the corresponding cells of levels A and B to calculate dA,\xe2\x80\x89B. You cannot transform the maps of levels, i.e. rotate or shift them relatively to each other. Your task is to find a way to transfer all the k levels and minimize the traffic." dsu,graphs,greedy,trees 1800
1698G "Long Binary String" "There is a binary string t of length 10100, and initally all of its bits are 0. You are given a binary string s, and perform the following operation some times:   Select some substring of t, and replace it with its XOR with s.\xe2\x80\xa0  After several operations, the string t has exactly two bits 1; that is, there are exactly two distinct indices p and q such that the p-th and q-th bits of t are 1, and the rest of the bits are 0. Find the lexicographically largest\xe2\x80\xa1 string t satisfying these constraints, or report that no such string exists.\xe2\x80\xa0 Formally, choose an index i such that 0\xe2\x89\xa4i\xe2\x89\xa410100\xe2\x88\x92|s|. For all 1\xe2\x89\xa4j\xe2\x89\xa4|s|, if sj=1, then toggle ti+j. That is, if ti+j=0, set ti+j=1. Otherwise if ti+j=1, set ti+j=0.\xe2\x80\xa1 A binary string a is lexicographically larger than a binary string b of the same length if in the first position where a and b differ, the string a has a bit 1 and the corresponding bit in b is 0." "bitmasks,math,matrices,meet-in-the-middle,number theory" 2900
2027C "Add Zeros" "You\'re given an array a initially containing n integers. In one operation, you must do the following:  Choose a position i such that 1<i\xe2\x89\xa4|a| and ai=|a|+1\xe2\x88\x92i, where |a| is the current size of the array.  Append i\xe2\x88\x921 zeros onto the end of a. After performing this operation as many times as you want, what is the maximum possible length of the array a?" "brute force,data structures,dfs and similar,dp,graphs,greedy" 1500
1227G "Not Same" "You are given an integer array a1,a2,\xe2\x80\xa6,an, where ai represents the number of blocks at the i-th position. It is guaranteed that 1\xe2\x89\xa4ai\xe2\x89\xa4n. In one operation you can choose a subset of indices of the given array and remove one block in each of these indices. You can\'t remove a block from a position without blocks.All subsets that you choose should be different (unique).You need to remove all blocks in the array using at most n+1 operations. It can be proved that the answer always exists." "constructive algorithms" 2600
630Q Pyramids "IT City administration has no rest because of the fame of the Pyramids in Egypt. There is a project of construction of pyramid complex near the city in the place called Emerald Walley. The distinction of the complex is that its pyramids will be not only quadrangular as in Egypt but also triangular and pentagonal. Of course the amount of the city budget funds for the construction depends on the pyramids\' volume. Your task is to calculate the volume of the pilot project consisting of three pyramids \xe2\x80\x94 one triangular, one quadrangular and one pentagonal.The first pyramid has equilateral triangle as its base, and all 6 edges of the pyramid have equal length. The second pyramid has a square as its base and all 8 edges of the pyramid have equal length. The third pyramid has a regular pentagon as its base and all 10 edges of the pyramid have equal length." geometry,math 1700
242B "Big Segment" "A coordinate line has n segments, the i-th segment starts at the position li and ends at the position ri. We will denote such a segment as [li,\xe2\x80\x89ri].You have suggested that one of the defined segments covers all others. In other words, there is such segment in the given set, which contains all other ones. Now you want to test your assumption. Find in the given set the segment which covers all other segments, and print its number. If such a segment doesn\'t exist, print -1.Formally we will assume that segment [a,\xe2\x80\x89b] covers segment [c,\xe2\x80\x89d], if they meet this condition a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89c\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89d\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b." implementation,sortings 1100
1305G "Kuroni and Antihype" "Kuroni isn\'t good at economics. So he decided to found a new financial pyramid called Antihype. It has the following rules:  You can join the pyramid for free and get 0 coins.  If you are already a member of Antihype, you can invite your friend who is currently not a member of Antihype, and get a number of coins equal to your age (for each friend you invite). n people have heard about Antihype recently, the i-th person\'s age is ai. Some of them are friends, but friendship is a weird thing now: the i-th person is a friend of the j-th person if and only if ai AND aj=0, where AND denotes the bitwise AND operation.Nobody among the n people is a member of Antihype at the moment. They want to cooperate to join and invite each other to Antihype in a way that maximizes their combined gainings. Could you help them?" "bitmasks,brute force,dp,dsu,graphs" 3500
1527D "MEX Tree" "You are given a tree with n nodes, numerated from 0 to n\xe2\x88\x921. For each k between 0 and n, inclusive, you have to count the number of unordered pairs (u,v), u\xe2\x89\xa0v, such that the MEX of all the node labels in the shortest path from u to v (including end points) is k.The MEX of a sequence of integers is the smallest non-negative integer that does not belong to the sequence." "combinatorics,dfs and similar,implementation,math,trees" 2400
2002C "Black Circles" "There are n circles on a two-dimensional plane. The i-th circle is centered at (xi,yi). Initially, all circles have a radius of 0.The circles\' radii increase at a rate of 1 unit per second.You are currently at (xs,ys); your goal is to reach (xt,yt) without touching the circumference of any circle (including the moment you reach (xt,yt)). You can move in any direction you want. However, your speed is limited to 1 unit per second.Please determine whether this is possible." "brute force,geometry,greedy,math" 1200
1188A1 "Add on a Tree" "Note that this is the first problem of the two similar problems. You can hack this problem only if you solve both problems.You are given a tree with n nodes. In the beginning, 0 is written on all edges. In one operation, you can choose any 2 distinct leaves u, v and any real number x and add x to values written on all edges on the simple path between u and v.For example, on the picture below you can see the result of applying two operations to the graph: adding 2 on the path from 7 to 6, and then adding \xe2\x88\x920.5 on the path from 4 to 5.   Is it true that for any configuration of real numbers written on edges, we can achieve it with a finite number of operations?Leaf is a node of a tree of degree 1. Simple path is a path that doesn\'t contain any node twice." trees 1600
1263D "Secret Passwords" "One unknown hacker wants to get the admin\'s password of AtForces testing system, to get problems from the next contest. To achieve that, he sneaked into the administrator\'s office and stole a piece of paper with a list of n passwords \xe2\x80\x94 strings, consists of small Latin letters.Hacker went home and started preparing to hack AtForces. He found that the system contains only passwords from the stolen list and that the system determines the equivalence of the passwords a and b as follows:  two passwords a and b are equivalent if there is a letter, that exists in both a and b;  two passwords a and b are equivalent if there is a password c from the list, which is equivalent to both a and b. If a password is set in the system and an equivalent one is applied to access the system, then the user is accessed into the system.For example, if the list contain passwords ""a"", ""b"", ""ab"", ""d"", then passwords ""a"", ""b"", ""ab"" are equivalent to each other, but the password ""d"" is not equivalent to any other password from list. In other words, if:  admin\'s password is ""b"", then you can access to system by using any of this passwords: ""a"", ""b"", ""ab"";  admin\'s password is ""d"", then you can access to system by using only ""d"". Only one password from the list is the admin\'s password from the testing system. Help hacker to calculate the minimal number of passwords, required to guaranteed access to the system. Keep in mind that the hacker does not know which password is set in the system." "dfs and similar,dsu,graphs" 1500
1433D "Districts Connection" "There are n districts in the town, the i-th district belongs to the ai-th bandit gang. Initially, no districts are connected to each other.You are the mayor of the city and want to build n\xe2\x88\x921 two-way roads to connect all districts (two districts can be connected directly or through other connected districts).If two districts belonging to the same gang are connected directly with a road, this gang will revolt.You don\'t want this so your task is to build n\xe2\x88\x921 two-way roads in such a way that all districts are reachable from each other (possibly, using intermediate districts) and each pair of directly connected districts belong to different gangs, or determine that it is impossible to build n\xe2\x88\x921 roads to satisfy all the conditions.You have to answer t independent test cases." "constructive algorithms,dfs and similar" 1200
1095B "Array Stabilization" "You are given an array a consisting of n integer numbers.Let instability of the array be the following value: nmaxi=1ai\xe2\x88\x92nmini=1ai.You have to remove exactly one element from this array to minimize instability of the resulting (n\xe2\x88\x921)-elements array. Your task is to calculate the minimum possible instability." implementation 900
1823C "Strongly Composite" "A prime number is an integer greater than 1, which has exactly two divisors. For example, 7 is a prime, since it has two divisors {1,7}. A composite number is an integer greater than 1, which has more than two different divisors.Note that the integer 1 is neither prime nor composite.Let\'s look at some composite number v. It has several divisors: some divisors are prime, others are composite themselves. If the number of prime divisors of v is less or equal to the number of composite divisors, let\'s name v as strongly composite.For example, number 12 has 6 divisors: {1,2,3,4,6,12}, two divisors 2 and 3 are prime, while three divisors 4, 6 and 12 are composite. So, 12 is strongly composite. Other examples of strongly composite numbers are 4, 8, 9, 16 and so on.On the other side, divisors of 15 are {1,3,5,15}: 3 and 5 are prime, 15 is composite. So, 15 is not a strongly composite. Other examples are: 2, 3, 5, 6, 7, 10 and so on.You are given n integers a1,a2,\xe2\x80\xa6,an (ai>1). You have to build an array b1,b2,\xe2\x80\xa6,bk such that following conditions are satisfied:   Product of all elements of array a is equal to product of all elements of array b: a1\xe2\x8b\x85a2\xe2\x8b\x85\xe2\x80\xa6\xe2\x8b\x85an=b1\xe2\x8b\x85b2\xe2\x8b\x85\xe2\x80\xa6\xe2\x8b\x85bk;  All elements of array b are integers greater than 1 and strongly composite;  The size k of array b is the maximum possible. Find the size k of array b, or report, that there is no array b satisfying the conditions." "greedy,math,number theory" 1300
1994C "Hungry Games" "Yaroslav is playing a computer game, and at one of the levels, he encountered n mushrooms arranged in a row. Each mushroom has its own level of toxicity; the i-th mushroom from the beginning has a toxicity level of ai. Yaroslav can choose two integers 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n, and then his character will take turns from left to right to eat mushrooms from this subsegment one by one, i.e., the mushrooms with numbers l,l+1,l+2,\xe2\x80\xa6,r.The character has a toxicity level g, initially equal to 0. The computer game is defined by the number x \xe2\x80\x94 the maximum toxicity level at any given time. When eating a mushroom with toxicity level k, the following happens:  The toxicity level of the character is increased by k.  If g\xe2\x89\xa4x, the process continues; otherwise, g becomes zero and the process continues. Yaroslav became interested in how many ways there are to choose the values of l and r such that the final value of g is not zero. Help Yaroslav find this number!" "binary search,dp,two pointers" 1600
331D2 "Escaping on Beaveractor" "Don\'t put up with what you\'re sick of! The Smart Beaver decided to escape from the campus of Beaver Science Academy (BSA). BSA is a b\xe2\x80\x89\xc3\x97\xe2\x80\x89b square on a plane. Each point x,\xe2\x80\x89y (0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x,\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b) belongs to BSA. To make the path quick and funny, the Beaver constructed a Beaveractor, an effective and comfortable types of transport.The campus obeys traffic rules: there are n arrows, parallel to the coordinate axes. The arrows do not intersect and do not touch each other. When the Beaveractor reaches some arrow, it turns in the arrow\'s direction and moves on until it either reaches the next arrow or gets outside the campus. The Beaveractor covers exactly one unit of space per one unit of time. You can assume that there are no obstacles to the Beaveractor.The BSA scientists want to transport the brand new Beaveractor to the ""Academic Tractor"" research institute and send the Smart Beaver to do his postgraduate studies and sharpen pencils. They have q plans, representing the Beaveractor\'s initial position (xi,\xe2\x80\x89yi), the initial motion vector wi and the time ti that have passed after the escape started.Your task is for each of the q plans to determine the Smart Beaver\'s position after the given time." graphs 2600
1926G "Vlad and Trouble at MIT" "Vladislav has a son who really wanted to go to MIT. The college dormitory at MIT (Moldova Institute of Technology) can be represented as a tree with n vertices, each vertex being a room with exactly one student. A tree is a connected undirected graph with n vertices and n\xe2\x88\x921 edges.Tonight, there are three types of students:   students who want to party and play music (marked with P),  students who wish to sleep and enjoy silence (marked with S), and  students who don\'t care (marked with C). Initially, all the edges are thin walls which allow music to pass through, so when a partying student puts music on, it will be heard in every room. However, we can place some thick walls on any edges \xe2\x80\x94 thick walls don\'t allow music to pass through them.The university wants to install some thick walls so that every partying student can play music, and no sleepy student can hear it.Because the university lost a lot of money in a naming rights lawsuit, they ask you to find the minimum number of thick walls they will need to use." "dfs and similar,dp,flows,graphs,greedy,implementation,trees" 1900
1278D "Segment Tree" "As the name of the task implies, you are asked to do some work with segments and trees.Recall that a tree is a connected undirected graph such that there is exactly one simple path between every pair of its vertices.You are given n segments [l1,r1],[l2,r2],\xe2\x80\xa6,[ln,rn], li<ri for every i. It is guaranteed that all segments\' endpoints are integers, and all endpoints are unique \xe2\x80\x94 there is no pair of segments such that they start in the same point, end in the same point or one starts in the same point the other one ends.Let\'s generate a graph with n vertices from these segments. Vertices v and u are connected by an edge if and only if segments [lv,rv] and [lu,ru] intersect and neither of it lies fully inside the other one.For example, pairs ([1,3],[2,4]) and ([5,10],[3,7]) will induce the edges but pairs ([1,2],[3,4]) and ([5,7],[3,10]) will not.Determine if the resulting graph is a tree or not." "data structures,dsu,graphs,trees" 2100
1355B "Young Explorers" "Young wilderness explorers set off to their first expedition led by senior explorer Russell. Explorers went into a forest, set up a camp and decided to split into groups to explore as much interesting locations as possible. Russell was trying to form groups, but ran into some difficulties...Most of the young explorers are inexperienced, and sending them alone would be a mistake. Even Russell himself became senior explorer not long ago. Each of young explorers has a positive integer parameter ei \xe2\x80\x94 his inexperience. Russell decided that an explorer with inexperience e can only join the group of e or more people.Now Russell needs to figure out how many groups he can organize. It\'s not necessary to include every explorer in one of the groups: some can stay in the camp. Russell is worried about this expedition, so he asked you to help him." dp,greedy,sortings 1200
1882D "Tree XOR" "You are given a tree with n vertices labeled from 1 to n. An integer ai is written on vertex i for i=1,2,\xe2\x80\xa6,n. You want to make all ai equal by performing some (possibly, zero) spells.Suppose you root the tree at some vertex. On each spell, you can select any vertex v and any non-negative integer c. Then for all vertices i in the subtree\xe2\x80\xa0 of v, replace ai with ai\xe2\x8a\x95c. The cost of this spell is s\xe2\x8b\x85c, where s is the number of vertices in the subtree. Here \xe2\x8a\x95 denotes the bitwise XOR operation.Let mr be the minimum possible total cost required to make all ai equal, if vertex r is chosen as the root of the tree. Find m1,m2,\xe2\x80\xa6,mn.\xe2\x80\xa0 Suppose vertex r is chosen as the root of the tree. Then vertex i belongs to the subtree of v if the simple path from i to r contains v." "bitmasks,dfs and similar,dp,greedy,trees" 1900
477E "Dreamoon and Notepad" "Dreamoon has just created a document of hard problems using notepad.exe. The document consists of n lines of text, ai denotes the length of the i-th line. He now wants to know what is the fastest way to move the cursor around because the document is really long.Let (r,\xe2\x80\x89c) be a current cursor position, where r is row number and c is position of cursor in the row. We have 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n and 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89c\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ar.We can use following six operations in notepad.exe to move our cursor assuming the current cursor position is at (r,\xe2\x80\x89c):  up key: the new cursor position (nr,\xe2\x80\x89nc)\xe2\x80\x89=\xe2\x80\x89(max(r\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x891),\xe2\x80\x89min(anr,\xe2\x80\x89c))  down key: the new cursor position (nr,\xe2\x80\x89nc)\xe2\x80\x89=\xe2\x80\x89(min(r\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89n),\xe2\x80\x89min(anr,\xe2\x80\x89c))  left key: the new cursor position (nr,\xe2\x80\x89nc)\xe2\x80\x89=\xe2\x80\x89(r,\xe2\x80\x89max(0,\xe2\x80\x89c\xe2\x80\x89-\xe2\x80\x891))  right key: the new cursor position (nr,\xe2\x80\x89nc)\xe2\x80\x89=\xe2\x80\x89(r,\xe2\x80\x89min(anr,\xe2\x80\x89c\xe2\x80\x89+\xe2\x80\x891))  HOME key: the new cursor position (nr,\xe2\x80\x89nc)\xe2\x80\x89=\xe2\x80\x89(r,\xe2\x80\x890)  END key: the new cursor position (nr,\xe2\x80\x89nc)\xe2\x80\x89=\xe2\x80\x89(r,\xe2\x80\x89ar) You\'re given the document description (n and sequence ai) and q queries from Dreamoon. Each query asks what minimal number of key presses is needed to move the cursor from (r1,\xe2\x80\x89c1) to (r2,\xe2\x80\x89c2)." "data structures" 3100
1419F "Rain of Fire" "There are n detachments on the surface, numbered from 1 to n, the i-th detachment is placed in a point with coordinates (xi,yi). All detachments are placed in different points.Brimstone should visit each detachment at least once. You can choose the detachment where Brimstone starts.To move from one detachment to another he should first choose one of four directions of movement (up, right, left or down) and then start moving with the constant speed of one unit interval in a second until he comes to a detachment. After he reaches an arbitrary detachment, he can repeat the same process.Each t seconds an orbital strike covers the whole surface, so at that moment Brimstone should be in a point where some detachment is located. He can stay with any detachment as long as needed.Brimstone is a good commander, that\'s why he can create at most one detachment and place it in any empty point with integer coordinates he wants before his trip. Keep in mind that Brimstone will need to visit this detachment, too.Help Brimstone and find such minimal t that it is possible to check each detachment. If there is no such t report about it." "binary search,data structures,dfs and similar,dsu,graphs,implementation" 2800
1005D "Polycarp and Div 3" "Polycarp likes numbers that are divisible by 3.He has a huge number s. Polycarp wants to cut from it the maximum number of numbers that are divisible by 3. To do this, he makes an arbitrary number of vertical cuts between pairs of adjacent digits. As a result, after m such cuts, there will be m+1 parts in total. Polycarp analyzes each of the obtained numbers and finds the number of those that are divisible by 3.For example, if the original number is s=3121, then Polycarp can cut it into three parts with two cuts: 3|1|21. As a result, he will get two numbers that are divisible by 3.Polycarp can make an arbitrary number of vertical cuts, where each cut is made between a pair of adjacent digits. The resulting numbers cannot contain extra leading zeroes (that is, the number can begin with 0 if and only if this number is exactly one character \'0\'). For example, 007, 01 and 00099 are not valid numbers, but 90, 0 and 10001 are valid.What is the maximum number of numbers divisible by 3 that Polycarp can obtain?" "dp,greedy,number theory" 1500
917E "Upside Down" "As we all know, Eleven has special abilities. Thus, Hopper convinced her to close the gate to the Upside Down World with her mind. Upside down monsters like to move between the worlds, so they are going to attack Hopper and Eleven in order to make them stop. The monsters live in the vines. The vines form a tree with n vertices, numbered from 1 through n. There\'s a lowercase English letter written in each tunnel (edge).  Upside down is a magical world. There are m types of monsters in upside down, numbered from 1 through m. Each type of monster has a special word that gives them powers. The special word of type i is si. There are q monsters in upside down. Each one is at a junction (vertex) and is going to some other junction. If monster of type k goes from junction i to junction j, the power it gains is the number of times it sees its special world (sk) consecutively in the tunnels. More formally: If f(i,\xe2\x80\x89j) is the string we get when we concatenate the letters written in the tunnels on the shortest path from i to j, then the power the monster gains is the number of occurrences of sk in f(i,\xe2\x80\x89j).Hopper and Eleven want to get prepared, so for each monster, they want to know the power the monster gains after moving." "data structures,string suffix structures,strings,trees" 3400
68B "Energy exchange" "It is well known that the planet suffers from the energy crisis. Little Petya doesn\'t like that and wants to save the world. For this purpose he needs every accumulator to contain the same amount of energy. Initially every accumulator has some amount of energy: the i-th accumulator has ai units of energy. Energy can be transferred from one accumulator to the other. Every time x units of energy are transferred (x is not necessarily an integer) k percent of it is lost. That is, if x units were transferred from one accumulator to the other, amount of energy in the first one decreased by x units and in other increased by  units.Your task is to help Petya find what maximum equal amount of energy can be stored in each accumulator after the transfers." "binary search" 1600
433A "Kitahara Haruki\'s Gift" "Kitahara Haruki has bought n apples for Touma Kazusa and Ogiso Setsuna. Now he wants to divide all the apples between the friends.Each apple weights 100 grams or 200 grams. Of course Kitahara Haruki doesn\'t want to offend any of his friend. Therefore the total weight of the apples given to Touma Kazusa must be equal to the total weight of the apples given to Ogiso Setsuna.But unfortunately Kitahara Haruki doesn\'t have a knife right now, so he cannot split any apple into some parts. Please, tell him: is it possible to divide all the apples in a fair way between his friends?" "brute force,implementation" 1100
1790C Premutation "A sequence of n numbers is called permutation if it contains all integers from 1 to n exactly once. For example, the sequences [3,1,4,2], [1] and [2,1] are permutations, but [1,2,1], [0,1] and [1,3,4] \xe2\x80\x94 are not.Kristina had a permutation p of n elements. She wrote it on the whiteboard n times in such a way that:   while writing the permutation at the i-th (1\xe2\x89\xa4i\xe2\x89\xa4n) time she skipped the element pi  So, she wrote in total n sequences of length n\xe2\x88\x921 each.For example, suppose Kristina had a permutation p = [4,2,1,3] of length 4. Then she did the following:   Wrote the sequence [2,1,3], skipping the element p1=4 from the original permutation.  Wrote the sequence [4,1,3], skipping the element p2=2 from the original permutation.  Wrote the sequence [4,2,3], skipping the element p3=1 from the original permutation.  Wrote the sequence [4,2,1], skipping the element p4=3 from the original permutation. You know all n of sequences that have been written on the whiteboard, but you do not know the order in which they were written. They are given in arbitrary order. Reconstruct the original permutation from them.For example, if you know the sequences [4,2,1], [4,2,3], [2,1,3], [4,1,3], then the original permutation will be p = [4,2,1,3]." "brute force,implementation,math" 1000
1671F "Permutation Counting" "Calculate the number of permutations p of size n with exactly k inversions (pairs of indices (i,j) such that i<j and pi>pj) and exactly x indices i such that pi>pi+1.Yep, that\'s the whole problem. Good luck!" "brute force,combinatorics,dp,fft,math" 2700
135D Cycle "Little Petya very much likes rectangular tables that consist of characters ""0"" and ""1"". Recently he has received one such table as a gift from his mother. The table contained n rows and m columns. The rows are numbered from top to bottom from 1 to n, the columns are numbered from the left to the right from 1 to m. Petya immediately decided to find the longest cool cycle whatever it takes.A cycle is a sequence of pairwise distinct cells where each two consecutive cells have a common side; besides, the first cell has a common side with the last cell. A cycle is called cool if it fulfills all the following conditions simultaneously:   The cycle entirely consists of the cells that contain ""1"".  Each cell that belongs to the cycle, has a common side with exactly two other cells that belong to the cycle.  Each cell of the table that contains ""1"" either belongs to the cycle or is positioned outside of it (see definition below). To define the notion of ""outside"" formally, let\'s draw a cycle on a plane. Let each cell of the cycle (i,\xe2\x80\x89j) (i is the row number, j is the column number) correspond to the point (i,\xe2\x80\x89j) on the coordinate plane. Let a straight line segment join each pair of points that correspond to the cells belonging to the cycle and sharing a side. Thus, we will get a closed polyline that has no self-intersections and self-touches. The polyline divides the plane into two connected parts: the part of an infinite area and the part of a finite area. It is considered that cell (r,\xe2\x80\x89c) lies outside of the cycle if it does not belong to the cycle and the corresponding point on the plane with coordinates (r,\xe2\x80\x89c) lies in the part with the infinite area.Help Petya to find the length of the longest cool cycle in the table. The cycle length is defined as the number of cells that belong to the cycle." "brute force,dfs and similar,implementation" 2500
1109E "Sasha and a Very Easy Test" "Egor likes math, and not so long ago he got the highest degree of recognition in the math community \xe2\x80\x94 Egor became a red mathematician. In this regard, Sasha decided to congratulate Egor and give him a math test as a present. This test contains an array a of integers of length n and exactly q queries. Queries were of three types:   ""1 l r x"" \xe2\x80\x94 multiply each number on the range from l to r by x.  ""2 p x"" \xe2\x80\x94 divide the number at the position p by x (divisibility guaranteed).  ""3 l r"" \xe2\x80\x94 find the sum of all elements on the range from l to r. The sum can be big, so Sasha asked Egor to calculate the sum modulo some integer mod. But since Egor is a red mathematician, he doesn\'t have enough time to solve such easy tasks, at the same time he doesn\'t want to anger Sasha, that\'s why he asked you to help and to find answers for all queries of the 3-rd type." "data structures,number theory" 2700
633B "A Trivial Problem" "Mr. Santa asks all the great programmers of the world to solve a trivial problem. He gives them an integer m and asks for the number of positive integers n, such that the factorial of n ends with exactly m zeroes. Are you among those great programmers who can solve this problem?" "brute force,constructive algorithms,math,number theory" 1300
917D "Stranger Trees" "Will shares a psychic connection with the Upside Down Monster, so everything the monster knows, Will knows. Suddenly, he started drawing, page after page, non-stop. Joyce, his mom, and Chief Hopper put the drawings together, and they realized, it\'s a labeled tree!  A tree is a connected acyclic graph. Will\'s tree has n vertices. Joyce and Hopper don\'t know what that means, so they\'re investigating this tree and similar trees. For each k such that 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x891, they\'re going to investigate all labeled trees with n vertices that share exactly k edges with Will\'s tree. Two labeled trees are different if and only if there\'s a pair of vertices (v,\xe2\x80\x89u) such that there\'s an edge between v and u in one tree and not in the other one.Hopper and Joyce want to know how much work they have to do, so they asked you to tell them the number of labeled trees with n vertices that share exactly k edges with Will\'s tree, for each k. The answer could be very large, so they only asked you to tell them the answers modulo 1000000007\xe2\x80\x89=\xe2\x80\x89109\xe2\x80\x89+\xe2\x80\x897." dp,math,matrices,trees 2600
118C "Fancy Number" "A car number in Berland consists of exactly n digits. A number is called beautiful if it has at least k equal digits. Vasya wants to change the digits in his car\'s number so that the number became beautiful. To replace one of n digits Vasya has to pay the sum of money, equal to the absolute difference between the old digit and the new one.Help Vasya: find the minimum sum of money he should pay to make the number of his car beautiful. You should also find the resulting beautiful number. If there are several such numbers, then print the lexicographically minimum one." "brute force,greedy,sortings,strings" 1900
1780A "Hayato and School" "Today Hayato came home from school with homework.In the assignment, Hayato was given an array a of length n. The task was to find 3 numbers in this array whose sum is odd. At school, he claimed that there are such 3 numbers, but Hayato was not sure, so he asked you for help.Answer if there are such three numbers, and if so, output indices i, j, and k such that ai+aj+ak is odd.The odd numbers are integers that are not divisible by 2: 1, 3, 5, and so on." "constructive algorithms,greedy" 800
505A "Mr. Kitayuta\'s Gift" "Mr. Kitayuta has kindly given you a string s consisting of lowercase English letters. You are asked to insert exactly one lowercase English letter into s to make it a palindrome. A palindrome is a string that reads the same forward and backward. For example, ""noon"", ""testset"" and ""a"" are all palindromes, while ""test"" and ""kitayuta"" are not.You can choose any lowercase English letter, and insert it to any position of s, possibly to the beginning or the end of s. You have to insert a letter even if the given string is already a palindrome.If it is possible to insert one lowercase English letter into s so that the resulting string will be a palindrome, print the string after the insertion. Otherwise, print ""NA"" (without quotes, case-sensitive). In case there is more than one palindrome that can be obtained, you are allowed to print any of them." "brute force,implementation,strings" 1100
246A "Buggy Sorting" "Little boy Valera studies an algorithm of sorting an integer array. After studying the theory, he went on to the practical tasks. As a result, he wrote a program that sorts an array of n integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an in the non-decreasing order. The pseudocode of the program, written by Valera, is given below. The input of the program gets number n and array a.loop integer variable i from 1 to n\xe2\x80\x89-\xe2\x80\x891    loop integer variable j from i to n\xe2\x80\x89-\xe2\x80\x891        if (aj\xe2\x80\x89>\xe2\x80\x89aj\xe2\x80\x89+\xe2\x80\x891), then swap the values of elements aj and aj\xe2\x80\x89+\xe2\x80\x891But Valera could have made a mistake, because he hasn\'t yet fully learned the sorting algorithm. If Valera made a mistake in his program, you need to give a counter-example that makes his program work improperly (that is, the example that makes the program sort the array not in the non-decreasing order). If such example for the given value of n doesn\'t exist, print -1." "constructive algorithms,greedy,sortings" 900
730J Bottles "Nick has n bottles of soda left after his birthday. Each bottle is described by two values: remaining amount of soda ai and bottle volume bi (ai\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89bi).Nick has decided to pour all remaining soda into minimal number of bottles, moreover he has to do it as soon as possible. Nick spends x seconds to pour x units of soda from one bottle to another.Nick asks you to help him to determine k \xe2\x80\x94 the minimal number of bottles to store all remaining soda and t \xe2\x80\x94 the minimal time to pour soda into k bottles. A bottle can\'t store more soda than its volume. All remaining soda should be saved." dp 1900
1353F "Decreasing Heights" "You are playing one famous sandbox game with the three-dimensional world. The map of the world can be represented as a matrix of size n\xc3\x97m, where the height of the cell (i,j) is ai,j.You are in the cell (1,1) right now and want to get in the cell (n,m). You can move only down (from the cell (i,j) to the cell (i+1,j)) or right (from the cell (i,j) to the cell (i,j+1)). There is an additional restriction: if the height of the current cell is x then you can move only to the cell with height x+1.Before the first move you can perform several operations. During one operation, you can decrease the height of any cell by one. I.e. you choose some cell (i,j) and assign (set) ai,j:=ai,j\xe2\x88\x921. Note that you can make heights less than or equal to zero. Also note that you can decrease the height of the cell (1,1).Your task is to find the minimum number of operations you have to perform to obtain at least one suitable path from the cell (1,1) to the cell (n,m). It is guaranteed that the answer exists.You have to answer t independent test cases." "brute force,dp" 2200
1313E "Concatenation with intersection" "Vasya had three strings a, b and s, which consist of lowercase English letters. The lengths of strings a and b are equal to n, the length of the string s is equal to m. Vasya decided to choose a substring of the string a, then choose a substring of the string b and concatenate them. Formally, he chooses a segment [l1,r1] (1\xe2\x89\xa4l1\xe2\x89\xa4r1\xe2\x89\xa4n) and a segment [l2,r2] (1\xe2\x89\xa4l2\xe2\x89\xa4r2\xe2\x89\xa4n), and after concatenation he obtains a string a[l1,r1]+b[l2,r2]=al1al1+1\xe2\x80\xa6ar1bl2bl2+1\xe2\x80\xa6br2.Now, Vasya is interested in counting number of ways to choose those segments adhering to the following conditions:  segments [l1,r1] and [l2,r2] have non-empty intersection, i.e. there exists at least one integer x, such that l1\xe2\x89\xa4x\xe2\x89\xa4r1 and l2\xe2\x89\xa4x\xe2\x89\xa4r2;  the string a[l1,r1]+b[l2,r2] is equal to the string s." "data structures,hashing,strings,two pointers" 2700
1475F "Unusual Matrix" "You are given two binary square matrices a and b of size n\xc3\x97n. A matrix is called binary if each of its elements is equal to 0 or 1. You can do the following operations on the matrix a arbitrary number of times (0 or more):   vertical xor. You choose the number j (1\xe2\x89\xa4j\xe2\x89\xa4n) and for all i (1\xe2\x89\xa4i\xe2\x89\xa4n) do the following: ai,j:=ai,j\xe2\x8a\x951 (\xe2\x8a\x95 \xe2\x80\x94 is the operation xor (exclusive or)).  horizontal xor. You choose the number i (1\xe2\x89\xa4i\xe2\x89\xa4n) and for all j (1\xe2\x89\xa4j\xe2\x89\xa4n) do the following: ai,j:=ai,j\xe2\x8a\x951. Note that the elements of the a matrix change after each operation.For example, if n=3 and the matrix a is: (110001110) Then the following sequence of operations shows an example of transformations:   vertical xor, j=1. a=(010101010)  horizontal xor, i=2. a=(010010010)  vertical xor, j=2. a=(000000000) Check if there is a sequence of operations such that the matrix a becomes equal to the matrix b." "2-sat,brute force,constructive algorithms" 1900
869C "The Intriguing Obsession" "\xe2\x80\x94 This is not playing but duty as allies of justice, Nii-chan!\xe2\x80\x94 Not allies but justice itself, Onii-chan!With hands joined, go everywhere at a speed faster than our thoughts! This time, the Fire Sisters \xe2\x80\x94 Karen and Tsukihi \xe2\x80\x94 is heading for somewhere they\'ve never reached \xe2\x80\x94 water-surrounded islands!There are three clusters of islands, conveniently coloured red, blue and purple. The clusters consist of a, b and c distinct islands respectively.Bridges have been built between some (possibly all or none) of the islands. A bridge bidirectionally connects two different islands and has length 1. For any two islands of the same colour, either they shouldn\'t be reached from each other through bridges, or the shortest distance between them is at least 3, apparently in order to prevent oddities from spreading quickly inside a cluster.The Fire Sisters are ready for the unknown, but they\'d also like to test your courage. And you\'re here to figure out the number of different ways to build all bridges under the constraints, and give the answer modulo 998\xe2\x80\x89244\xe2\x80\x89353. Two ways are considered different if a pair of islands exist, such that there\'s a bridge between them in one of them, but not in the other." combinatorics,dp,math 1800
1495A "Diamond Miner" "Diamond Miner is a game that is similar to Gold Miner, but there are n miners instead of 1 in this game.The mining area can be described as a plane. The n miners can be regarded as n points on the y-axis. There are n diamond mines in the mining area. We can regard them as n points on the x-axis. For some reason, no miners or diamond mines can be at the origin (point (0,0)). Every miner should mine exactly one diamond mine. Every miner has a hook, which can be used to mine a diamond mine. If a miner at the point (a,b) uses his hook to mine a diamond mine at the point (c,d), he will spend \xe2\x88\x9a(a\xe2\x88\x92c)2+(b\xe2\x88\x92d)2 energy to mine it (the distance between these points). The miners can\'t move or help each other.The object of this game is to minimize the sum of the energy that miners spend. Can you find this minimum?" geometry,greedy,math,sortings 1200
716A "Crazy Computer" "ZS the Coder is coding on a crazy computer. If you don\'t type in a word for a c consecutive seconds, everything you typed disappear! More formally, if you typed a word at second a and then the next word at second b, then if b\xe2\x80\x89-\xe2\x80\x89a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89c, just the new word is appended to other words on the screen. If b\xe2\x80\x89-\xe2\x80\x89a\xe2\x80\x89>\xe2\x80\x89c, then everything on the screen disappears and after that the word you have typed appears on the screen.For example, if c\xe2\x80\x89=\xe2\x80\x895 and you typed words at seconds 1,\xe2\x80\x893,\xe2\x80\x898,\xe2\x80\x8914,\xe2\x80\x8919,\xe2\x80\x8920 then at the second 8 there will be 3 words on the screen. After that, everything disappears at the second 13 because nothing was typed. At the seconds 14 and 19 another two words are typed, and finally, at the second 20, one more word is typed, and a total of 3 words remain on the screen.You\'re given the times when ZS the Coder typed the words. Determine how many words remain on the screen after he finished typing everything." implementation 800
188F "Binary Notation" "You are given a positive integer n. Output its binary notation." "*special problem,implementation" 1400
1202B "You Are Given a Decimal String..." "Suppose you have a special x-y-counter. This counter can store some value as a decimal number; at first, the counter has value 0. The counter performs the following algorithm: it prints its lowest digit and, after that, adds either x or y to its value. So all sequences this counter generates are starting from 0. For example, a 4-2-counter can act as follows:  it prints 0, and adds 4 to its value, so the current value is 4, and the output is 0;  it prints 4, and adds 4 to its value, so the current value is 8, and the output is 04;  it prints 8, and adds 4 to its value, so the current value is 12, and the output is 048;  it prints 2, and adds 2 to its value, so the current value is 14, and the output is 0482;  it prints 4, and adds 4 to its value, so the current value is 18, and the output is 04824. This is only one of the possible outputs; for example, the same counter could generate 0246802468024 as the output, if we chose to add 2 during each step.You wrote down a printed sequence from one of such x-y-counters. But the sequence was corrupted and several elements from the sequence could be erased.Now you\'d like to recover data you\'ve lost, but you don\'t even know the type of the counter you used. You have a decimal string s \xe2\x80\x94 the remaining data of the sequence. For all 0\xe2\x89\xa4x,y<10, calculate the minimum number of digits you have to insert in the string s to make it a possible output of the x-y-counter. Note that you can\'t change the order of digits in string s or erase any of them; only insertions are allowed." "brute force,dp,shortest paths" 1700
1688B "Patchouli\'s Magical Talisman" "She is skilled in all kinds of magics, and is keen on inventing new one.\xe2\x80\x94Perfect Memento in Strict SensePatchouli is making a magical talisman. She initially has n magical tokens. Their magical power can be represented with positive integers a1,a2,\xe2\x80\xa6,an. Patchouli may perform the following two operations on the tokens.  Fusion: Patchouli chooses two tokens, removes them, and creates a new token with magical power equal to the sum of the two chosen tokens.  Reduction: Patchouli chooses a token with an even value of magical power x, removes it and creates a new token with magical power equal to x2. Tokens are more effective when their magical powers are odd values. Please help Patchouli to find the minimum number of operations she needs to make magical powers of all tokens odd values." "bitmasks,constructive algorithms,greedy,sortings" 800
1895F "Fancy Arrays" "Let\'s call an array a of n non-negative integers fancy if the following conditions hold:   at least one from the numbers x, x+1, ..., x+k\xe2\x88\x921 appears in the array;  consecutive elements of the array differ by at most k (i.e. |ai\xe2\x88\x92ai\xe2\x88\x921|\xe2\x89\xa4k for each i\xe2\x88\x88[2,n]). You are given n, x and k. Your task is to calculate the number of fancy arrays of length n. Since the answer can be large, print it modulo 109+7." combinatorics,dp,math,matrices 2600
898C "Phone Numbers" "Vasya has several phone books, in which he recorded the telephone numbers of his friends. Each of his friends can have one or several phone numbers.Vasya decided to organize information about the phone numbers of friends. You will be given n strings \xe2\x80\x94 all entries from Vasya\'s phone books. Each entry starts with a friend\'s name. Then follows the number of phone numbers in the current entry, and then the phone numbers themselves. It is possible that several identical phones are recorded in the same record.Vasya also believes that if the phone number a is a suffix of the phone number b (that is, the number b ends up with a), and both numbers are written by Vasya as the phone numbers of the same person, then a is recorded without the city code and it should not be taken into account.The task is to print organized information about the phone numbers of Vasya\'s friends. It is possible that two different people have the same number. If one person has two numbers x and y, and x is a suffix of y (that is, y ends in x), then you shouldn\'t print number x. If the number of a friend in the Vasya\'s phone books is recorded several times in the same format, it is necessary to take it into account exactly once.Read the examples to understand statement and format of the output better." implementation,strings 1400
1936B Pinball "There is a one-dimensional grid of length n. The i-th cell of the grid contains a character si, which is either \'<\' or \'>\'.When a pinball is placed on one of the cells, it moves according to the following rules:   If the pinball is on the i-th cell and si is \'<\', the pinball moves one cell to the left in the next second. If si is \'>\', it moves one cell to the right.  After the pinball has moved, the character si is inverted (i. e. if si used to be \'<\', it becomes \'>\', and vice versa).  The pinball stops moving when it leaves the grid: either from the left border or from the right one. You need to answer n independent queries. In the i-th query, a pinball will be placed on the i-th cell. Note that we always place a pinball on the initial grid.For each query, calculate how many seconds it takes the pinball to leave the grid. It can be shown that the pinball will always leave the grid within a finite number of steps." "binary search,data structures,implementation,math,two pointers" 2000
1945B Fireworks "One of the days of the hike coincided with a holiday, so in the evening at the camp, it was decided to arrange a festive fireworks display. For this purpose, the organizers of the hike bought two installations for launching fireworks and a huge number of shells for launching.Both installations are turned on simultaneously. The first installation launches fireworks every a minutes (i.e., after a,2\xe2\x8b\x85a,3\xe2\x8b\x85a,\xe2\x80\xa6 minutes after launch). The second installation launches fireworks every b minutes (i.e., after b,2\xe2\x8b\x85b,3\xe2\x8b\x85b,\xe2\x80\xa6 minutes after launch).Each firework is visible in the sky for m+1 minutes after launch, i.e., if a firework was launched after x minutes after the installations were turned on, it will be visible every minute from x to x+m, inclusive. If one firework was launched m minutes after another, both fireworks will be visible for one minute.What is the maximum number of fireworks that could be seen in the sky at the same time?" "math,number theory" 900
1815E "Bosco and Particle" "Bosco is studying the behaviour of particles. He decided to investigate on the peculiar behaviour of the so-called ""four-one-two"" particle. He does the following:There is a line of length n+1, where the topmost point is position 0 and bottommost is position n+1. The particle is initially (at time t=0) at position 0 and heading downwards. The particle moves at the speed of 1 unit per second. There are n oscillators at positions 1,2,\xe2\x80\xa6,n.Each oscillator can be described by a binary string. The initial state of each oscillator is the first character of its binary string. When the particle hits with an oscillator, the particle reverses its direction if its current state is 1 and continues to move at the same direction if its current state is 0, and that oscillator moves on to the next state (the next state of the last state is defined as the first state). Additionally, the particle always reverses its direction when it is at position 0 or n+1 at time t>0.Bosco would like to know the cycle length of the movement of particle. The cycle length is defined as the minimum value of c such that for any time t\xe2\x89\xa50, the position of the particle at time t is same as the position of the particle at time t+c. It can be proved that such value c always exists. As he realises the answer might be too large, he asks you to output your answer modulo 998244353." "dp,math,number theory,strings" 3100
843A "Sorting by Subsequences" "You are given a sequence a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an consisting of different integers. It is required to split this sequence into the maximum number of subsequences such that after sorting integers in each of them in increasing order, the total sequence also will be sorted in increasing order.Sorting integers in a subsequence is a process such that the numbers included in a subsequence are ordered in increasing order, and the numbers which are not included in a subsequence don\'t change their places.Every element of the sequence must appear in exactly one subsequence." "dfs and similar,dsu,implementation,math,sortings" 1400
1616F "Tricolor Triangles" "You are given a simple undirected graph with n vertices and m edges. Edge i is colored in the color ci, which is either 1, 2, or 3, or left uncolored (in this case, ci=\xe2\x88\x921).You need to color all of the uncolored edges in such a way that for any three pairwise adjacent vertices 1\xe2\x89\xa4a<b<c\xe2\x89\xa4n, the colors of the edges a\xe2\x86\x94b, b\xe2\x86\x94c, and a\xe2\x86\x94c are either pairwise different, or all equal. In case no such coloring exists, you need to determine that." "brute force,graphs,math,matrices" 2900
125C "Hobbits\' Party" "Everyone knows that hobbits love to organize all sorts of parties and celebrations. There are n hobbits living in the Shire. They decided to organize the Greatest Party (GP) that would last for several days. Next day the hobbits wrote a guest list, some non-empty set containing all the inhabitants of the Shire. To ensure that everybody enjoy themselves and nobody gets bored, for any two days (say, days A and B) of the GP there existed at least one hobbit, invited to come on day A and on day B. However, to ensure that nobody has a row, for any three different days A, B, C there shouldn\'t be a hobbit invited on days A, B and C. The Shire inhabitants are keen on keeping the GP going for as long as possible. Your task is given number n, to indicate the GP\'s maximum duration and the guest lists for each day." "constructive algorithms,greedy" 1600
427A "Police Recruits" "The police department of your city has just started its journey. Initially, they don\xe2\x80\x99t have any manpower. So, they started hiring new recruits in groups.Meanwhile, crimes keeps occurring within the city. One member of the police force can investigate only one crime during his/her lifetime.If there is no police officer free (isn\'t busy with crime) during the occurrence of a crime, it will go untreated.Given the chronological order of crime occurrences and recruit hirings, find the number of crimes which will go untreated." implementation 800
822F Madness "The second semester starts at the University of Pavlopolis. After vacation in Vi\xc4\x8dkopolis Noora needs to return to Pavlopolis and continue her study.Sometimes (or quite often) there are teachers who do not like you. Incidentally Noora also has one such teacher. His name is Yury Dmitrievich and he teaches graph theory. Yury Dmitrievich doesn\'t like Noora, so he always gives the girl the most difficult tasks. So it happened this time.The teacher gives Noora a tree with n vertices. Vertices are numbered with integers from 1 to n. The length of all the edges of this tree is 1. Noora chooses a set of simple paths that pairwise don\'t intersect in edges. However each vertex should belong to at least one of the selected path.For each of the selected paths, the following is done:  We choose exactly one edge (u,\xe2\x80\x89v) that belongs to the path.  On the selected edge (u,\xe2\x80\x89v) there is a point at some selected distance x from the vertex u and at distance 1\xe2\x80\x89-\xe2\x80\x89x from vertex v. But the distance x chosen by Noora arbitrarily, i. e. it can be different for different edges.  One of the vertices u or v is selected. The point will start moving to the selected vertex. Let us explain how the point moves by example. Suppose that the path consists of two edges (v1,\xe2\x80\x89v2) and (v2,\xe2\x80\x89v3), the point initially stands on the edge (v1,\xe2\x80\x89v2) and begins its movement to the vertex v1. Then the point will reach v1, then ""turn around"", because the end of the path was reached, further it will move in another direction to vertex v2, then to vertex v3, then ""turn around"" again, then move to v2 and so on. The speed of the points is 1 edge per second. For example, for 0.5 second the point moves to the length of the half of an edge.A stopwatch is placed at each vertex of the tree. The time that the stopwatches indicate at start time is 0 seconds. Then at the starting moment of time, all points simultaneously start moving from the selected positions to selected directions along the selected paths, and stopwatches are simultaneously started. When one of the points reaches the vertex v, the stopwatch at the vertex v is automatically reset, i.e. it starts counting the time from zero.Denote by resv the maximal time that the stopwatch at the vertex v will show if the point movement continues infinitely. Noora is asked to select paths and points on them so that res1 is as minimal as possible. If there are several solutions to do this, it is necessary to minimize res2, then res3, res4,\xe2\x80\x89...,\xe2\x80\x89resn.Help Noora complete the teacher\'s task.For the better understanding of the statement, see the explanation for the example." "constructive algorithms,dfs and similar,trees" 2500
1863B "Split Sort" "You are given a permutation\xe2\x80\xa0 p1,p2,\xe2\x80\xa6,pn of integers 1 to n.You can change the current permutation by applying the following operation several (possibly, zero) times:  choose some x (2\xe2\x89\xa4x\xe2\x89\xa4n);  create a new permutation by:   first, writing down all elements of p that are less than x, without changing their order;  second, writing down all elements of p that are greater than or equal to x, without changing their order;   replace p with the newly created permutation. For example, if the permutation used to be [6,4,3,5,2,1] and you choose x=4, then you will first write down [3,2,1], then append this with [6,4,5]. So the initial permutation will be replaced by [3,2,1,6,4,5].Find the minimum number of operations you need to achieve pi=i for i=1,2,\xe2\x80\xa6,n. We can show that it is always possible to do so.\xe2\x80\xa0 A permutation of length n is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array), and [1,3,4] is also not a permutation (n=3 but there is 4 in the array)." greedy,math,sortings 1100
1297C "Dream Team" "Polycarp is the project manager in the IT-company. Right now, he needs to choose developers for his team to start a new project. The company has n developers ""on the bench"" (i.e not involved in other projects). Polycarp assessed the skills of each of them: ai (\xe2\x88\x92104\xe2\x89\xa4ai\xe2\x89\xa4104) \xe2\x80\x94 an integer characteristic of the i-th developer. This value can be either positive, zero or even negative (some developers cause distractions).After Polycarp chooses a subset of developers for his team, the strength of the team will be determined by the sum of ai values for all selected developers.Polycarp fears that if he chooses a team in such a way that maximizes the sum of the characteristics of ai, other managers may find this unacceptable. For this reason, he plans to create such a team that the sum of the ai values for it is strictly less than the maximum possible value.Help Polycarp choose any team that:  the sum of the characteristics ai for all members of the selected team is strictly less than the maximum value that can be achieved by choosing the team in some other way  and at the same time, the sum of the characteristics of ai for all members of the selected team is the greatest possible. If, following the requirements above, you can select a team in several ways, then just find any of them. It\'s guaranteed that the sum of the characteristics in the desired subset is strictly positive (i.e. Polycarp can always choose a non-empty team)." "*special problem,greedy" -999
1523C "Compression and Expansion" "William is a huge fan of planning ahead. That is why he starts his morning routine by creating a nested list of upcoming errands.A valid nested list is any list which can be created from a list with one item ""1"" by applying some operations. Each operation inserts a new item into the list, on a new line, just after one of existing items a1.a2.a3.\xe2\x8b\xaf.ak and can be one of two types:   Add an item a1.a2.a3.\xe2\x8b\xaf.ak.1 (starting a list of a deeper level), or  Add an item a1.a2.a3.\xe2\x8b\xaf.(ak+1) (continuing the current level).  Operation can only be applied if the list does not contain two identical items afterwards. And also, if we consider every item as a sequence of numbers, then the sequence of items should always remain increasing in lexicographical order. Examples of valid and invalid lists that are shown in the picture can found in the ""Notes"" section.When William decided to save a Word document with the list of his errands he accidentally hit a completely different keyboard shortcut from the ""Ctrl-S"" he wanted to hit. It\'s not known exactly what shortcut he pressed but after triggering it all items in the list were replaced by a single number: the last number originally written in the item number.William wants you to help him restore a fitting original nested list." "brute force,data structures,greedy,implementation,trees" 1600
261A "Maxim and Discounts" "Maxim always goes to the supermarket on Sundays. Today the supermarket has a special offer of discount systems.There are m types of discounts. We assume that the discounts are indexed from 1 to m. To use the discount number i, the customer takes a special basket, where he puts exactly qi items he buys. Under the terms of the discount system, in addition to the items in the cart the customer can receive at most two items from the supermarket for free. The number of the ""free items"" (0, 1 or 2) to give is selected by the customer. The only condition imposed on the selected ""free items"" is as follows: each of them mustn\'t be more expensive than the cheapest item out of the qi items in the cart.Maxim now needs to buy n items in the shop. Count the minimum sum of money that Maxim needs to buy them, if he use the discount system optimally well.Please assume that the supermarket has enough carts for any actions. Maxim can use the same discount multiple times. Of course, Maxim can buy items without any discounts." greedy,sortings 1400
1656E "Equal Tree Sums" "You are given an undirected unrooted tree, i.e. a connected undirected graph without cycles.You must assign a nonzero integer weight to each vertex so that the following is satisfied: if any vertex of the tree is removed, then each of the remaining connected components has the same sum of weights in its vertices." "constructive algorithms,dfs and similar,math,trees" 2200
909E Coprocessor "You are given a program you want to execute as a set of tasks organized in a dependency graph. The dependency graph is a directed acyclic graph: each task can depend on results of one or several other tasks, and there are no directed circular dependencies between tasks. A task can only be executed if all tasks it depends on have already completed.Some of the tasks in the graph can only be executed on a coprocessor, and the rest can only be executed on the main processor. In one coprocessor call you can send it a set of tasks which can only be executed on it. For each task of the set, all tasks on which it depends must be either already completed or be included in the set. The main processor starts the program execution and gets the results of tasks executed on the coprocessor automatically.Find the minimal number of coprocessor calls which are necessary to execute the given program." "dfs and similar,dp,graphs,greedy" 1900
142A "Help Farmer" "Once upon a time in the Kingdom of Far Far Away lived Sam the Farmer. Sam had a cow named Dawn and he was deeply attached to her. Sam would spend the whole summer stocking hay to feed Dawn in winter. Sam scythed hay and put it into haystack. As Sam was a bright farmer, he tried to make the process of storing hay simpler and more convenient to use. He collected the hay into cubical hay blocks of the same size. Then he stored the blocks in his barn. After a summer spent in hard toil Sam stored A\xc2\xb7B\xc2\xb7C hay blocks and stored them in a barn as a rectangular parallelepiped A layers high. Each layer had B rows and each row had C blocks.At the end of the autumn Sam came into the barn to admire one more time the hay he\'d been stacking during this hard summer. Unfortunately, Sam was horrified to see that the hay blocks had been carelessly scattered around the barn. The place was a complete mess. As it turned out, thieves had sneaked into the barn. They completely dissembled and took away a layer of blocks from the parallelepiped\'s front, back, top and sides. As a result, the barn only had a parallelepiped containing (A\xe2\x80\x89-\xe2\x80\x891)\xe2\x80\x89\xc3\x97\xe2\x80\x89(B\xe2\x80\x89-\xe2\x80\x892)\xe2\x80\x89\xc3\x97\xe2\x80\x89(C\xe2\x80\x89-\xe2\x80\x892) hay blocks. To hide the evidence of the crime, the thieves had dissembled the parallelepiped into single 1\xe2\x80\x89\xc3\x97\xe2\x80\x891\xe2\x80\x89\xc3\x97\xe2\x80\x891 blocks and scattered them around the barn. After the theft Sam counted n hay blocks in the barn but he forgot numbers A, B \xd0\xb8 C.Given number n, find the minimally possible and maximally possible number of stolen hay blocks." "brute force,math" 1600
1613A "Long Comparison" "Monocarp wrote down two numbers on a whiteboard. Both numbers follow a specific format: a positive integer x with p zeros appended to its end.Now Monocarp asks you to compare these two numbers. Can you help him?" implementation,math 900
388C "Fox and Card Game" "Fox Ciel is playing a card game with her friend Fox Jiro. There are n piles of cards on the table. And there is a positive integer on each card.The players take turns and Ciel takes the first turn. In Ciel\'s turn she takes a card from the top of any non-empty pile, and in Jiro\'s turn he takes a card from the bottom of any non-empty pile. Each player wants to maximize the total sum of the cards he took. The game ends when all piles become empty.Suppose Ciel and Jiro play optimally, what is the score of the game?" games,greedy,sortings 2000
1349A "Orac and LCM" "For the multiset of positive integers s={s1,s2,\xe2\x80\xa6,sk}, define the Greatest Common Divisor (GCD) and Least Common Multiple (LCM) of s as follow: gcd(s) is the maximum positive integer x, such that all integers in s are divisible on x. lcm(s) is the minimum positive integer x, that divisible on all integers from s.For example, gcd({8,12})=4,gcd({12,18,6})=6 and lcm({4,6})=12. Note that for any positive integer x, gcd({x})=lcm({x})=x.Orac has a sequence a with length n. He come up with the multiset t={lcm({ai,aj}) | i<j}, and asked you to find the value of gcd(t) for him. In other words, you need to calculate the GCD of LCMs of all pairs of elements in the given sequence." "data structures,math,number theory" 1600
979D "Kuro and GCD and XOR and SUM" "Kuro is currently playing an educational game about numbers. The game focuses on the greatest common divisor (GCD), the XOR value, and the sum of two numbers. Kuro loves the game so much that he solves levels by levels day by day.Sadly, he\'s going on a vacation for a day, and he isn\'t able to continue his solving streak on his own. As Katie is a reliable person, Kuro kindly asked her to come to his house on this day to play the game for him.Initally, there is an empty array a. The game consists of q tasks of two types. The first type asks Katie to add a number ui to a. The second type asks Katie to find a number v existing in a such that ki\xe2\x88\xa3GCD(xi,v), xi+v\xe2\x89\xa4si, and xi\xe2\x8a\x95v is maximized, where \xe2\x8a\x95 denotes the bitwise XOR operation, GCD(c,d) denotes the greatest common divisor of integers c and d, and y\xe2\x88\xa3x means x is divisible by y, or report -1 if no such numbers are found.Since you are a programmer, Katie needs you to automatically and accurately perform the tasks in the game to satisfy her dear friend Kuro. Let\'s help her!" "binary search,bitmasks,brute force,data structures,dp,dsu,greedy,math,number theory,strings,trees" 2200
1924E "Paper Cutting Again" "There is a rectangular sheet of paper with initial height n and width m. Let the current height and width be h and w respectively. We introduce a xy-coordinate system so that the four corners of the sheet are (0,0),(w,0),(0,h), and (w,h). The sheet can then be cut along the lines x=1,2,\xe2\x80\xa6,w\xe2\x88\x921 and the lines y=1,2,\xe2\x80\xa6,h\xe2\x88\x921. In each step, the paper is cut randomly along any one of these h+w\xe2\x88\x922 lines. After each vertical and horizontal cut, the right and bottom piece of paper respectively are discarded.Find the expected number of steps required to make the area of the sheet of paper strictly less than k. It can be shown that this answer can always be expressed as a fraction pq where p and q are coprime integers. Calculate p\xe2\x8b\x85q\xe2\x88\x921mod(109+7)." combinatorics,probabilities 3100
313B "Ilya and Queries" "Ilya the Lion wants to help all his friends with passing exams. They need to solve the following problem to pass the IT exam.You\'ve got string s\xe2\x80\x89=\xe2\x80\x89s1s2... sn (n is the length of the string), consisting only of characters ""."" and ""#"" and m queries. Each query is described by a pair of integers li,\xe2\x80\x89ri (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89li\xe2\x80\x89<\xe2\x80\x89ri\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n). The answer to the query li,\xe2\x80\x89ri is the number of such integers i (li\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89ri), that si\xe2\x80\x89=\xe2\x80\x89si\xe2\x80\x89+\xe2\x80\x891.Ilya the Lion wants to help his friends but is there anyone to help him? Help Ilya, solve the problem." dp,implementation 1100
1057B DDoS "We get more and more news about DDoS-attacks of popular websites.Arseny is an admin and he thinks that a website is under a DDoS-attack if the total number of requests for a some period of time exceeds 100\xe2\x8b\x85t, where t \xe2\x80\x94 the number of seconds in this time segment. Arseny knows statistics on the number of requests per second since the server is booted. He knows the sequence r1,r2,\xe2\x80\xa6,rn, where ri \xe2\x80\x94 the number of requests in the i-th second after boot. Determine the length of the longest continuous period of time, which Arseny considers to be a DDoS-attack. A seeking time period should not go beyond the boundaries of the segment [1,n]." "*special problem,brute force" 1400
1670A "Prof. Slim" "One day Prof. Slim decided to leave the kingdom of the GUC to join the kingdom of the GIU. He was given an easy online assessment to solve before joining the GIU. Citizens of the GUC were happy sad to see the prof leaving, so they decided to hack into the system and change the online assessment into a harder one so that he stays at the GUC. After a long argument, they decided to change it into the following problem.Given an array of n integers a1,a2,\xe2\x80\xa6,an, where ai\xe2\x89\xa00, check if you can make this array sorted by using the following operation any number of times (possibly zero). An array is sorted if its elements are arranged in a non-decreasing order.  select two indices i and j (1\xe2\x89\xa4i,j\xe2\x89\xa4n) such that ai and aj have different signs. In other words, one must be positive and one must be negative.  swap the signs of ai and aj. For example if you select ai=3 and aj=\xe2\x88\x922, then they will change to ai=\xe2\x88\x923 and aj=2. Prof. Slim saw that the problem is still too easy and isn\'t worth his time, so he decided to give it to you to solve." greedy,implementation,sortings 800
1045H Self-exploration "Being bored of exploring the Moon over and over again Wall-B decided to explore something he is made of \xe2\x80\x94 binary numbers. He took a binary number and decided to count how many times different substrings of length two appeared. He stored those values in c00, c01, c10 and c11, representing how many times substrings 00, 01, 10 and 11 appear in the number respectively. For example: 10111100\xe2\x86\x92c00=1, c01=1, c10=2, c11=3 10000\xe2\x86\x92c00=3, c01=0, c10=1, c11=0 10101001\xe2\x86\x92c00=1, c01=3, c10=3, c11=0 1\xe2\x86\x92c00=0, c01=0, c10=0, c11=0Wall-B noticed that there can be multiple binary numbers satisfying the same c00, c01, c10 and c11 constraints. Because of that he wanted to count how many binary numbers satisfy the constraints cxy given the interval [A,B]. Unfortunately, his processing power wasn\'t strong enough to handle large intervals he was curious about. Can you help him? Since this number can be large print it modulo 109+7." math 2400
758D "Ability To Convert" "Alexander is learning how to convert numbers from the decimal system to any other, however, he doesn\'t know English letters, so he writes any number only as a decimal number, it means that instead of the letter A he will write the number 10. Thus, by converting the number 475 from decimal to hexadecimal system, he gets 11311 (475\xe2\x80\x89=\xe2\x80\x891\xc2\xb7162\xe2\x80\x89+\xe2\x80\x8913\xc2\xb7161\xe2\x80\x89+\xe2\x80\x8911\xc2\xb7160). Alexander lived calmly until he tried to convert the number back to the decimal number system.Alexander remembers that he worked with little numbers so he asks to find the minimum decimal number so that by converting it to the system with the base n he will get the number k." "constructive algorithms,dp,greedy,math,strings" 2000
1285E "Delete a Segment" "There are n segments on a Ox axis [l1,r1], [l2,r2], ..., [ln,rn]. Segment [l,r] covers all points from l to r inclusive, so all x such that l\xe2\x89\xa4x\xe2\x89\xa4r.Segments can be placed arbitrarily  \xe2\x80\x94 be inside each other, coincide and so on. Segments can degenerate into points, that is li=ri is possible.Union of the set of segments is such a set of segments which covers exactly the same set of points as the original set. For example:  if n=3 and there are segments [3,6], [100,100], [5,8] then their union is 2 segments: [3,8] and [100,100];  if n=5 and there are segments [1,2], [2,3], [4,5], [4,6], [6,6] then their union is 2 segments: [1,3] and [4,6]. Obviously, a union is a set of pairwise non-intersecting segments.You are asked to erase exactly one segment of the given n so that the number of segments in the union of the rest n\xe2\x88\x921 segments is maximum possible.For example, if n=4 and there are segments [1,4], [2,3], [3,6], [5,7], then:  erasing the first segment will lead to [2,3], [3,6], [5,7] remaining, which have 1 segment in their union;  erasing the second segment will lead to [1,4], [3,6], [5,7] remaining, which have 1 segment in their union;  erasing the third segment will lead to [1,4], [2,3], [5,7] remaining, which have 2 segments in their union;  erasing the fourth segment will lead to [1,4], [2,3], [3,6] remaining, which have 1 segment in their union. Thus, you are required to erase the third segment to get answer 2.Write a program that will find the maximum number of segments in the union of n\xe2\x88\x921 segments if you erase any of the given n segments.Note that if there are multiple equal segments in the given set, then you can erase only one of them anyway. So the set after erasing will have exactly n\xe2\x88\x921 segments." "brute force,constructive algorithms,data structures,dp,graphs,sortings,trees,two pointers" 2300
965D "Single-use Stones" "A lot of frogs want to cross a river. A river is w units width, but frogs can only jump l units long, where l<w. Frogs can also jump on lengths shorter than l. but can\'t jump longer. Hopefully, there are some stones in the river to help them.The stones are located at integer distances from the banks. There are ai stones at the distance of i units from the bank the frogs are currently at. Each stone can only be used once by one frog, after that it drowns in the water.What is the maximum number of frogs that can cross the river, given that then can only jump on the stones?" "binary search,flows,greedy,two pointers" 1900
1827A "Counting Orders" "You are given two arrays a and b each consisting of n integers. All elements of a are pairwise distinct.Find the number of ways to reorder a such that ai>bi for all 1\xe2\x89\xa4i\xe2\x89\xa4n, modulo 109+7.Two ways of reordering are considered different if the resulting arrays are different." "combinatorics,math,sortings,two pointers" 1100
842E "Nikita and game" "Nikita plays a new computer game. There are m levels in this game. In the beginning of each level a new class appears in the game; this class is a child-class of the class yi (and yi is called parent-class for this new class). Thus, the classes form a tree. Initially there is only one class with index 1.Changing the class to its neighbour (child-class or parent-class) in the tree costs 1 coin. You can not change the class back. The cost of changing the class a to the class b is equal to the total cost of class changes on the path from a to b in the class tree.Suppose that at i -th level the maximum cost of changing one class to another is x. For each level output the number of classes such that for each of these classes there exists some other class y, and the distance from this class to y is exactly x." "binary search,dfs and similar,divide and conquer,graphs,trees" 2800
534D Handshakes "On February, 30th n students came in the Center for Training Olympiad Programmers (CTOP) of the Berland State University. They came one by one, one after another. Each of them went in, and before sitting down at his desk, greeted with those who were present in the room by shaking hands. Each of the students who came in stayed in CTOP until the end of the day and never left.At any time any three students could join together and start participating in a team contest, which lasted until the end of the day. The team did not distract from the contest for a minute, so when another student came in and greeted those who were present, he did not shake hands with the members of the contest writing team. Each team consisted of exactly three students, and each student could not become a member of more than one team. Different teams could start writing contest at different times.Given how many present people shook the hands of each student, get a possible order in which the students could have come to CTOP. If such an order does not exist, then print that this is impossible.Please note that some students could work independently until the end of the day, without participating in a team contest." "binary search,constructive algorithms,data structures,greedy" 1900
578F "Mirror Box" "You are given a box full of mirrors. Box consists of grid of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m. Each cell of the grid contains a mirror put in the shape of \'\\\' or \'\xe2\x80\x89/\xe2\x80\x89\' (45 degree to the horizontal or vertical line). But mirrors in some cells have been destroyed. You want to put new mirrors into these grids so that the following two conditions are satisfied:  If you put a light ray horizontally/vertically into the middle of any unit segment that is side of some border cell, the light will go out from the neighboring unit segment to the segment you put the ray in. each unit segment of the grid of the mirror box can be penetrated by at least one light ray horizontally/vertically put into the box according to the rules of the previous paragraph   After you tried putting some mirrors, you find out that there are many ways of doing so. How many possible ways are there? The answer might be large, so please find the result modulo prime number MOD." matrices,trees 3200
952A "Quirky Quantifiers" "InputThe input contains a single integer a (10\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89999).OutputOutput 0 or 1.ExamplesInputCopy13OutputCopy1InputCopy927OutputCopy1InputCopy48OutputCopy0" math 800
1679D "Toss a Coin to Your Graph..." "One day Masha was walking in the park and found a graph under a tree... Surprised? Did you think that this problem would have some logical and reasoned story? No way! So, the problem...Masha has an oriented graph which i-th vertex contains some positive integer ai. Initially Masha can put a coin at some vertex. In one operation she can move a coin placed in some vertex u to any other vertex v such that there is an oriented edge u\xe2\x86\x92v in the graph. Each time when the coin is placed in some vertex i, Masha write down an integer ai in her notebook (in particular, when Masha initially puts a coin at some vertex, she writes an integer written at this vertex in her notebook). Masha wants to make exactly k\xe2\x88\x921 operations in such way that the maximum number written in her notebook is as small as possible." "binary search,dfs and similar,dp,graphs" 1900
2000F "Color Rows and Columns" "You have n rectangles, the i-th of which has a width of ai and a height of bi.You can perform the following operation an unlimited number of times: choose a rectangle and a cell in it, and then color it.Each time you completely color any row or column, you earn 1 point. Your task is to score at least k points with as few operations as possible.Suppose you have a rectangle with a width of 6 and a height of 3. You can score 4 points by coloring all the cells in any 4 columns, thus performing 12 operations." dp,greedy,implementation,math 1900
1760E "Binary Inversions" "You are given a binary array\xe2\x80\xa0 of length n. You are allowed to perform one operation on it at most once. In an operation, you can choose any element and flip it: turn a 0 into a 1 or vice-versa.What is the maximum number of inversions\xe2\x80\xa1 the array can have after performing at most one operation?\xe2\x80\xa0 A binary array is an array that contains only zeroes and ones.\xe2\x80\xa1 The number of inversions in an array is the number of pairs of indices i,j such that i<j and ai>aj." "data structures,greedy,math" 1100
1952G "Mathematician Takeover" "A mathematician grabbed my computer as I was preparing this problem, deleted the statement, and changed the samples to fit his liking. The model solution and input/output format are still correct, but the samples are wrong. I\'ve partially fixed the problem so that when you submit, it will be tested against the correct version of the problem. However, I can\'t fix the samples below. As a computer scientist, can you solve the correct problem?" "binary search,dfs and similar,math" -999
1737C "Ela and Crickets" "Ela likes Chess a lot. During breaks, she usually challenges her co-worker in DTL to some chess games. She\'s not an expert at classic chess, but she\'s very interested in Chess variants, where she has to adapt to new rules and test her tactical mindset to win the game.The problem, which involves a non-standard chess pieces type that is described below, reads: given 3 white crickets on a n\xe2\x8b\x85n board, arranged in an ""L"" shape next to each other, there are no other pieces on the board. Ela wants to know with a finite number of moves, can she put any white cricket on the square on row x, column y?An ""L""-shape piece arrangement can only be one of the below:    For simplicity, we describe the rules for crickets on the board where only three white crickets are. It can move horizontally, vertically, or diagonally, but only to a square in some direction that is immediately after another cricket piece (so that it must jump over it). If the square immediately behind the piece is unoccupied, the cricket will occupy the square. Otherwise (when the square is occupied by another cricket, or does not exist), the cricket isn\'t allowed to make such a move.See an example of valid crickets\' moves on the pictures in the Note section." "constructive algorithms,games,implementation,math" 1500
883I "Photo Processing" "Evlampiy has found one more cool application to process photos. However the application has certain limitations.Each photo i has a contrast vi. In order for the processing to be truly of high quality, the application must receive at least k photos with contrasts which differ as little as possible.Evlampiy already knows the contrast vi for each of his n photos. Now he wants to split the photos into groups, so that each group contains at least k photos. As a result, each photo must belong to exactly one group.He considers a processing time of the j-th group to be the difference between the maximum and minimum values of vi in the group. Because of multithreading the processing time of a division into groups is the maximum processing time among all groups.Split n photos into groups in a such way that the processing time of the division is the minimum possible, i.e. that the the maximum processing time over all groups as least as possible." "binary search,dp" 1900
36B Fractal "Ever since Kalevitch, a famous Berland abstractionist, heard of fractals, he made them the main topic of his canvases. Every morning the artist takes a piece of graph paper and starts with making a model of his future canvas. He takes a square as big as n\xe2\x80\x89\xc3\x97\xe2\x80\x89n squares and paints some of them black. Then he takes a clean square piece of paper and paints the fractal using the following algorithm: Step 1. The paper is divided into n2 identical squares and some of them are painted black according to the model.Step 2. Every square that remains white is divided into n2 smaller squares and some of them are painted black according to the model.Every following step repeats step 2.  Unfortunately, this tiresome work demands too much time from the painting genius. Kalevitch has been dreaming of making the process automatic to move to making 3D or even 4D fractals." implementation 1600
156B Suspects "As Sherlock Holmes was investigating a crime, he identified n suspects. He knows for sure that exactly one of them committed the crime. To find out which one did it, the detective lines up the suspects and numbered them from 1 to n. After that, he asked each one: ""Which one committed the crime?"". Suspect number i answered either ""The crime was committed by suspect number ai"", or ""Suspect number ai didn\'t commit the crime"". Also, the suspect could say so about himself (ai\xe2\x80\x89=\xe2\x80\x89i).Sherlock Holmes understood for sure that exactly m answers were the truth and all other answers were a lie. Now help him understand this: which suspect lied and which one told the truth?" "constructive algorithms,data structures,implementation" 1600
1239C "Queue in the Train" "There are n seats in the train\'s car and there is exactly one passenger occupying every seat. The seats are numbered from 1 to n from left to right. The trip is long, so each passenger will become hungry at some moment of time and will go to take boiled water for his noodles. The person at seat i (1\xe2\x89\xa4i\xe2\x89\xa4n) will decide to go for boiled water at minute ti.Tank with a boiled water is located to the left of the 1-st seat. In case too many passengers will go for boiled water simultaneously, they will form a queue, since there can be only one passenger using the tank at each particular moment of time. Each passenger uses the tank for exactly p minutes. We assume that the time it takes passengers to go from their seat to the tank is negligibly small. Nobody likes to stand in a queue. So when the passenger occupying the i-th seat wants to go for a boiled water, he will first take a look on all seats from 1 to i\xe2\x88\x921. In case at least one of those seats is empty, he assumes that those people are standing in a queue right now, so he would be better seating for the time being. However, at the very first moment he observes that all seats with numbers smaller than i are busy, he will go to the tank.There is an unspoken rule, that in case at some moment several people can go to the tank, than only the leftmost of them (that is, seating on the seat with smallest number) will go to the tank, while all others will wait for the next moment.Your goal is to find for each passenger, when he will receive the boiled water for his noodles." "data structures,greedy,implementation" 2300
1360F Spy-string "You are given n strings a1,a2,\xe2\x80\xa6,an: all of them have the same length m. The strings consist of lowercase English letters.Find any string s of length m such that each of the given n strings differs from s in at most one position. Formally, for each given string ai, there is no more than one position j such that ai[j]\xe2\x89\xa0s[j].Note that the desired string s may be equal to one of the given strings ai, or it may differ from all the given strings.For example, if you have the strings abac and zbab, then the answer to the problem might be the string abab, which differs from the first only by the last character, and from the second only by the first." "bitmasks,brute force,constructive algorithms,dp,hashing,strings" 1700
486D "Valid Sets" "As you know, an undirected connected graph with n nodes and n\xe2\x80\x89-\xe2\x80\x891 edges is called a tree. You are given an integer d and a tree consisting of n nodes. Each node i has a value ai associated with it.We call a set S of tree nodes valid if following conditions are satisfied: S is non-empty. S is connected. In other words, if nodes u and v are in S, then all nodes lying on the simple path between u and v should also be presented in S. .Your task is to count the number of valid sets. Since the result can be very large, you must print its remainder modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." "dfs and similar,dp,math,trees" 2100
1758D "Range = \xe2\x88\x9aSum" "You are given an integer n. Find a sequence of n distinct integers a1,a2,\xe2\x80\xa6,an such that 1\xe2\x89\xa4ai\xe2\x89\xa4109 for all i and max(a1,a2,\xe2\x80\xa6,an)\xe2\x88\x92min(a1,a2,\xe2\x80\xa6,an)=\xe2\x88\x9aa1+a2+\xe2\x8b\xaf+an.It can be proven that there exists a sequence of distinct integers that satisfies all the conditions above." "binary search,brute force,constructive algorithms,math,two pointers" 1800
1138B Circus "Polycarp is a head of a circus troupe. There are n \xe2\x80\x94 an even number \xe2\x80\x94 artists in the troupe. It is known whether the i-th artist can perform as a clown (if yes, then ci=1, otherwise ci=0), and whether they can perform as an acrobat (if yes, then ai=1, otherwise ai=0).Split the artists into two performances in such a way that:   each artist plays in exactly one performance,  the number of artists in the two performances is equal (i.e. equal to n2),  the number of artists that can perform as clowns in the first performance is the same as the number of artists that can perform as acrobats in the second performance." "brute force,greedy,math,strings" 1800
1864I "Future Dominators" "Dhruvil and amenotiomoi are sitting in different countries and chatting online. Initially, amenotiomoi has an empty board of size n\xc3\x97n, and Dhruvil has a sequence of integers 1,2,\xe2\x80\xa6,n2, each number occurring exactly once. The numbers may be placed in the cells of the board, each cell is either empty or contains exactly one number.The current state of the board is called good, if there is a way of placing the remaining numbers in empty cells so that all numbers except 1 have a neighbor with a smaller value. Two cells are neighbors if they share an edge.The rows are numbered from 1 to n from top to bottom, the columns are numbered from 1 to n from left to right. The cell at the intersection of the x-th row and the y-th column is denoted as (x,y).To chat, amenotiomoi asks q queries to Dhruvil. Each time he provides Dhruvil with an empty cell (x,y). Dhruvil has to place one of the remaining numbers in this cell so that the board is still good. Among all ways to do this, he chooses the largest possible number he can place and sends this number to amenotiomoi as the answer to the query.Since amenotiomoi knows the correct answer every time, he tells Dhruvil (x\xe2\x8a\x95k,y\xe2\x8a\x95k) instead of (x,y), where k is the answer for the previous query. If amenotiomoi is sending the first query, he considers k=0. Each time Dhruvil has to decode the query and send the answer to amenotiomoi. Here \xe2\x8a\x95 denotes the bitwise XOR operation.Help Dhruvil reply to all amenotiomoi\'s queries." graphs,greedy 3500
1943E1 "MEX Game 2 (Easy Version)" "This is the easy version of the problem. The only difference between the two versions is the constraint on t, m and the sum of m. You can make hacks only if both versions of the problem are solved.Alice and Bob play yet another game on an array a of size n. Alice starts with an empty array c. Both players take turns playing, with Alice starting first.On Alice\'s turn, she picks one element from a, appends that element to c, and then deletes it from a.On Bob\'s turn, he picks at most k elements from a, and then deletes it from a. The game ends when the array a is empty. Alice\'s score is defined to be the MEX\xe2\x80\xa0 of c. Alice wants to maximize her score while Bob wants to minimize it. Find Alice\'s final score if both players play optimally.The array will be given in compressed format. Instead of giving the elements present in the array, we will be giving their frequencies. Formally, you will be given m, the maximum element in the array, and then m+1 integers f0,f1,\xe2\x80\xa6,fm, where fi represents the number of times i occurs in the array a.\xe2\x80\xa0 The MEX (minimum excludant) of an array of integers is defined as the smallest non-negative integer which does not occur in the array. For example:   The MEX of [2,2,1] is 0, because 0 does not belong to the array.  The MEX of [3,1,0,1] is 2, because 0 and 1 belong to the array, but 2 does not.  The MEX of [0,3,1,2] is 4, because 0, 1, 2 and 3 belong to the array, but 4 does not." "binary search,brute force,greedy" 2900
743A "Vladik and flights" "Vladik is a competitive programmer. This year he is going to win the International Olympiad in Informatics. But it is not as easy as it sounds: the question Vladik face now is to find the cheapest way to get to the olympiad.Vladik knows n airports. All the airports are located on a straight line. Each airport has unique id from 1 to n, Vladik\'s house is situated next to the airport with id a, and the place of the olympiad is situated next to the airport with id b. It is possible that Vladik\'s house and the place of the olympiad are located near the same airport. To get to the olympiad, Vladik can fly between any pair of airports any number of times, but he has to start his route at the airport a and finish it at the airport b.Each airport belongs to one of two companies. The cost of flight from the airport i to the airport j is zero if both airports belong to the same company, and |i\xe2\x80\x89-\xe2\x80\x89j| if they belong to different companies.Print the minimum cost Vladik has to pay to get to the olympiad." "constructive algorithms,greedy,implementation" 1200
43D Journey "The territory of Berland is represented by a rectangular field n\xe2\x80\x89\xc3\x97\xe2\x80\x89m in size. The king of Berland lives in the capital, located on the upper left square (1,\xe2\x80\x891). The lower right square has coordinates (n,\xe2\x80\x89m). One day the king decided to travel through the whole country and return back to the capital, having visited every square (except the capital) exactly one time. The king must visit the capital exactly two times, at the very beginning and at the very end of his journey. The king can only move to the side-neighboring squares. However, the royal advise said that the King possibly will not be able to do it. But there is a way out \xe2\x80\x94 one can build the system of one way teleporters between some squares so that the king could fulfill his plan. No more than one teleporter can be installed on one square, every teleporter can be used any number of times, however every time it is used, it transports to the same given for any single teleporter square. When the king reaches a square with an installed teleporter he chooses himself whether he is or is not going to use the teleport. What minimum number of teleporters should be installed for the king to complete the journey? You should also compose the journey path route for the king." "brute force,constructive algorithms,implementation" 2000
1675G "Sorting Pancakes" "Nastya baked m pancakes and spread them on n dishes. The dishes are in a row and numbered from left to right. She put ai pancakes on the dish with the index i.Seeing the dishes, Vlad decided to bring order to the stacks and move some pancakes. In one move, he can shift one pancake from any dish to the closest one, that is, select the dish i (ai>0) and do one of the following: if i>1, put the pancake on a dish with the previous index, after this move ai=ai\xe2\x88\x921 and ai\xe2\x88\x921=ai\xe2\x88\x921+1; if i<n, put the pancake on a dish with the following index, after this move ai=ai\xe2\x88\x921 and ai+1=ai+1+1.Vlad wants to make the array anon-increasing, after moving as few pancakes as possible. Help him find the minimum number of moves needed for this.The array a=[a1,a2,\xe2\x80\xa6,an] is called non-increasing if ai\xe2\x89\xa5ai+1 for all i from 1 to n\xe2\x88\x921." dp 2300
1119E "Pavel and Triangles" "Pavel has several sticks with lengths equal to powers of two.He has a0 sticks of length 20=1, a1 sticks of length 21=2, ..., an\xe2\x88\x921 sticks of length 2n\xe2\x88\x921. Pavel wants to make the maximum possible number of triangles using these sticks. The triangles should have strictly positive area, each stick can be used in at most one triangle.It is forbidden to break sticks, and each triangle should consist of exactly three sticks.Find the maximum possible number of triangles." "brute force,dp,fft,greedy,ternary search" 1900
977D "Divide by three, multiply by two" "Polycarp likes to play with numbers. He takes some integer number x, writes it down on the board, and then performs with it n\xe2\x88\x921 operations of the two kinds:   divide the number x by 3 (x must be divisible by 3);  multiply the number x by 2. After each operation, Polycarp writes down the result on the board and replaces x by the result. So there will be n numbers on the board after all.You are given a sequence of length n \xe2\x80\x94 the numbers that Polycarp wrote down. This sequence is given in arbitrary order, i.e. the order of the sequence can mismatch the order of the numbers written on the board.Your problem is to rearrange (reorder) elements of this sequence in such a way that it can match possible Polycarp\'s game in the order of the numbers written on the board. I.e. each next number will be exactly two times of the previous number or exactly one third of previous number.It is guaranteed that the answer exists." "dfs and similar,math,sortings" 1400
1593C "Save More Mice" "There are one cat, k mice, and one hole on a coordinate line. The cat is located at the point 0, the hole is located at the point n. All mice are located between the cat and the hole: the i-th mouse is located at the point xi (0<xi<n). At each point, many mice can be located.In one second, the following happens. First, exactly one mouse moves to the right by 1. If the mouse reaches the hole, it hides (i.e. the mouse will not any more move to any point and will not be eaten by the cat). Then (after that the mouse has finished its move) the cat moves to the right by 1. If at the new cat\'s position, some mice are located, the cat eats them (they will not be able to move after that). The actions are performed until any mouse hasn\'t been hidden or isn\'t eaten.In other words, the first move is made by a mouse. If the mouse has reached the hole, it\'s saved. Then the cat makes a move. The cat eats the mice located at the pointed the cat has reached (if the cat has reached the hole, it eats nobody).Each second, you can select a mouse that will make a move. What is the maximum number of mice that can reach the hole without being eaten?" "binary search,greedy,greedy" 1000
55E "Very simple problem" "You are given a convex polygon. Count, please, the number of triangles that contain a given point in the plane and their vertices are the vertices of the polygon. It is guaranteed, that the point doesn\'t lie on the sides and the diagonals of the polygon." "geometry,two pointers" 2500
1703D "Double Strings" "You are given n strings s1,s2,\xe2\x80\xa6,sn of length at most 8. For each string si, determine if there exist two strings sj and sk such that si=sj+sk. That is, si is the concatenation of sj and sk. Note that j can be equal to k.Recall that the concatenation of strings s and t is s+t=s1s2\xe2\x80\xa6spt1t2\xe2\x80\xa6tq, where p and q are the lengths of strings s and t respectively. For example, concatenation of ""code"" and ""forces"" is ""codeforces""." "brute force,data structures,strings" 1100
1763E "Node Pairs" "Let\'s call an ordered pair of nodes (u,v) in a directed graph unidirectional if u\xe2\x89\xa0v, there exists a path from u to v, and there are no paths from v to u.A directed graph is called p-reachable if it contains exactly p ordered pairs of nodes (u,v) such that u<v and u and v are reachable from each other. Find the minimum number of nodes required to create a p-reachable directed graph.Also, among all such p-reachable directed graphs with the minimum number of nodes, let G denote a graph which maximizes the number of unidirectional pairs of nodes. Find this number." "dp,graphs,math,number theory" 2200
2036C "Anya and 1100" "While rummaging through things in a distant drawer, Anya found a beautiful string s consisting only of zeros and ones.Now she wants to make it even more beautiful by performing q operations on it.Each operation is described by two integers i (1\xe2\x89\xa4i\xe2\x89\xa4|s|) and v (v\xe2\x88\x88{0,1}) and means that the i-th character of the string is assigned the value v (that is, the assignment si=v is performed).But Anya loves the number 1100, so after each query, she asks you to tell her whether the substring ""1100"" is present in her string (i.e. there exist such 1\xe2\x89\xa4i\xe2\x89\xa4|s|\xe2\x88\x923 that sisi+1si+2si+3=1100)." "brute force,implementation" 1100
1872E "Data Structures Fan" "You are given an array of integers a1,a2,\xe2\x80\xa6,an, as well as a binary string\xe2\x80\xa0 s consisting of n characters.Augustin is a big fan of data structures. Therefore, he asked you to implement a data structure that can answer q queries. There are two types of queries: ""1 l r"" (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n) \xe2\x80\x94 replace each character si for l\xe2\x89\xa4i\xe2\x89\xa4r with its opposite. That is, replace all 0 with 1 and all 1 with 0. ""2 g"" (g\xe2\x88\x88{0,1}) \xe2\x80\x94 calculate the value of the bitwise XOR of the numbers ai for all indices i such that si=g. Note that the XOR of an empty set of numbers is considered to be equal to 0.Please help Augustin to answer all the queries!For example, if n=4, a=[1,2,3,6], s=1001, consider the following series of queries: ""2 0"" \xe2\x80\x94 we are interested in the indices i for which si=0, since s=1001, these are the indices 2 and 3, so the answer to the query will be a2\xe2\x8a\x95a3=2\xe2\x8a\x953=1. ""1 1 3"" \xe2\x80\x94 we need to replace the characters s1,s2,s3 with their opposites, so before the query s=1001, and after the query: s=0111. ""2 1"" \xe2\x80\x94 we are interested in the indices i for which si=1, since s=0111, these are the indices 2, 3, and 4, so the answer to the query will be a2\xe2\x8a\x95a3\xe2\x8a\x95a4=2\xe2\x8a\x953\xe2\x8a\x956=7. ""1 2 4"" \xe2\x80\x94 s=0111 \xe2\x86\x92 s=0000. ""2 1"" \xe2\x80\x94 s=0000, there are no indices with si=1, so since the XOR of an empty set of numbers is considered to be equal to 0, the answer to this query is 0.\xe2\x80\xa0 A binary string is a string containing only characters 0 or 1." "binary search,bitmasks,data structures,dp" 1500
1115G3 "Palindrome checker oracle" "Implement a quantum oracle on N qubits which checks whether the vector \xe2\x86\x92x is a palindrome (i.e., implements the function f(\xe2\x86\x92x)=1 if \xe2\x86\x92x is a palindrome, and 0 otherwise).You have to implement an operation which takes the following inputs: an array of N (1\xe2\x89\xa4N\xe2\x89\xa48) qubits x in an arbitrary state (input register), a qubit y in an arbitrary state (output qubit),and performs a transformation |x\xe2\x9f\xa9|y\xe2\x9f\xa9\xe2\x86\x92|x\xe2\x9f\xa9|y\xe2\x8a\x95f(x)\xe2\x9f\xa9. The operation doesn\'t have an output; its ""output"" is the state in which it leaves the qubits.Your code should have the following signature:namespace Solution {    open Microsoft.Quantum.Primitive;    open Microsoft.Quantum.Canon;    operation Solve (x : Qubit[], y : Qubit) : Unit {        body (...) {            // your code here        }        adjoint auto;    }}" "*special problem" 1600
1257D "Yet Another Monster Killing Problem" "You play a computer game. In this game, you lead a party of m heroes, and you have to clear a dungeon with n monsters. Each monster is characterized by its power ai. Each hero is characterized by his power pi and endurance si.The heroes clear the dungeon day by day. In the beginning of each day, you choose a hero (exactly one) who is going to enter the dungeon this day.When the hero enters the dungeon, he is challenged by the first monster which was not defeated during the previous days (so, if the heroes have already defeated k monsters, the hero fights with the monster k+1). When the hero fights the monster, there are two possible outcomes:  if the monster\'s power is strictly greater than the hero\'s power, the hero retreats from the dungeon. The current day ends;  otherwise, the monster is defeated. After defeating a monster, the hero either continues fighting with the next monster or leaves the dungeon. He leaves the dungeon either if he has already defeated the number of monsters equal to his endurance during this day (so, the i-th hero cannot defeat more than si monsters during each day), or if all monsters are defeated \xe2\x80\x94 otherwise, he fights with the next monster. When the hero leaves the dungeon, the current day ends.Your goal is to defeat the last monster. What is the minimum number of days that you need to achieve your goal? Each day you have to use exactly one hero; it is possible that some heroes don\'t fight the monsters at all. Each hero can be used arbitrary number of times." "binary search,data structures,dp,greedy,sortings,two pointers" 1700
1148A "Another One Bites The Dust" "Let\'s call a string good if and only if it consists of only two types of letters \xe2\x80\x94 \'a\' and \'b\' and every two consecutive letters are distinct. For example ""baba"" and ""aba"" are good strings and ""abb"" is a bad string.You have a strings ""a"", b strings ""b"" and c strings ""ab"". You want to choose some subset of these strings and concatenate them in any arbitrarily order.What is the length of the longest good string you can obtain this way?" greedy 800
1498F "Christmas Game" "Alice and Bob are going to celebrate Christmas by playing a game with a tree of presents. The tree has n nodes (numbered 1 to n, with some node r as its root). There are ai presents are hanging from the i-th node.Before beginning the game, a special integer k is chosen. The game proceeds as follows: Alice begins the game, with moves alternating each turn; in any move, the current player may choose some node (for example, i) which has depth at least k. Then, the player picks some positive number of presents hanging from that node, let\'s call it m (1\xe2\x89\xa4m\xe2\x89\xa4ai); the player then places these m presents on the k-th ancestor (let\'s call it j) of the i-th node (the k-th ancestor of vertex i is a vertex j such that i is a descendant of j, and the difference between the depth of j and the depth of i is exactly k). Now, the number of presents of the i-th node (ai) is decreased by m, and, correspondingly, aj is increased by m; Alice and Bob both play optimally. The player unable to make a move loses the game.For each possible root of the tree, find who among Alice or Bob wins the game.Note: The depth of a node i in a tree with root r is defined as the number of edges on the simple path from node r to node i. The depth of root r itself is zero." "bitmasks,data structures,dfs and similar,dp,games,math,trees" 2500
177E2 "Space Voyage" "The Smart Beaver from ABBYY plans a space travel on an ultramodern spaceship. During the voyage he plans to visit n planets. For planet i ai is the maximum number of suitcases that an alien tourist is allowed to bring to the planet, and bi is the number of citizens on the planet.The Smart Beaver is going to bring some presents from ABBYY to the planets he will be visiting. The presents are packed in suitcases, x presents in each. The Beaver will take to the ship exactly a1\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89an suitcases.As the Beaver lands on the i-th planet, he takes ai suitcases and goes out. On the first day on the planet the Beaver takes a walk and gets to know the citizens. On the second and all subsequent days the Beaver gives presents to the citizens \xe2\x80\x94 each of the bi citizens gets one present per day. The Beaver leaves the planet in the evening of the day when the number of presents left is strictly less than the number of citizens (i.e. as soon as he won\'t be able to give away the proper number of presents the next day). He leaves the remaining presents at the hotel.The Beaver is going to spend exactly c days traveling. The time spent on flights between the planets is considered to be zero. In how many ways can one choose the positive integer x so that the planned voyage will take exactly c days?" "binary search" 1900
167C "Wizards and Numbers" "In some country live wizards. They love playing with numbers. The blackboard has two numbers written on it \xe2\x80\x94 a and b. The order of the numbers is not important. Let\'s consider a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b for the sake of definiteness. The players can cast one of the two spells in turns:  Replace b with b\xe2\x80\x89-\xe2\x80\x89ak. Number k can be chosen by the player, considering the limitations that k\xe2\x80\x89>\xe2\x80\x890 and b\xe2\x80\x89-\xe2\x80\x89ak\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x890. Number k is chosen independently each time an active player casts a spell.  Replace b with b mod a. If a\xe2\x80\x89>\xe2\x80\x89b, similar moves are possible.If at least one of the numbers equals zero, a player can\'t make a move, because taking a remainder modulo zero is considered somewhat uncivilized, and it is far too boring to subtract a zero. The player who cannot make a move, loses.To perform well in the magic totalizator, you need to learn to quickly determine which player wins, if both wizards play optimally: the one that moves first or the one that moves second." games,math 2300
1101A "Minimum Integer" "You are given q queries in the following form:Given three integers li, ri and di, find minimum positive integer xi such that it is divisible by di and it does not belong to the segment [li,ri].Can you answer all the queries?Recall that a number x belongs to segment [l,r] if l\xe2\x89\xa4x\xe2\x89\xa4r." math 1000
1851D "Prefix Permutation Sums" "Your friends have an array of n elements, calculated its array of prefix sums and passed it to you, accidentally losing one element during the transfer. Your task is to find out if the given array can matches permutation.A permutation of n elements is an array of n numbers from 1 to n such that each number occurs exactly one times in it.The array of prefix sums of the array a \xe2\x80\x94 is such an array b that bi=\xe2\x88\x91ij=1aj,1\xe2\x89\xa4i\xe2\x89\xa4n.For example, the original permutation was [1,5,2,4,3]. Its array of prefix sums \xe2\x80\x94 [1,6,8,12,15]. Having lost one element, you can get, for example, arrays [6,8,12,15] or [1,6,8,15].It can also be shown that the array [1,2,100] does not correspond to any permutation." implementation,math 1300
1006C "Three Parts of the Array" "You are given an array d1,d2,\xe2\x80\xa6,dn consisting of n integer numbers.Your task is to split this array into three parts (some of which may be empty) in such a way that each element of the array belongs to exactly one of the three parts, and each of the parts forms a consecutive contiguous subsegment (possibly, empty) of the original array. Let the sum of elements of the first part be sum1, the sum of elements of the second part be sum2 and the sum of elements of the third part be sum3. Among all possible ways to split the array you have to choose a way such that sum1=sum3 and sum1 is maximum possible.More formally, if the first part of the array contains a elements, the second part of the array contains b elements and the third part contains c elements, then:sum1=\xe2\x88\x911\xe2\x89\xa4i\xe2\x89\xa4adi, sum2=\xe2\x88\x91a+1\xe2\x89\xa4i\xe2\x89\xa4a+bdi, sum3=\xe2\x88\x91a+b+1\xe2\x89\xa4i\xe2\x89\xa4a+b+cdi.The sum of an empty array is 0.Your task is to find a way to split the array such that sum1=sum3 and sum1 is maximum possible." "binary search,data structures,two pointers" 1200
1510H "Hard Optimization" "You are given a set of n segments on a line [Li;Ri]. All 2n segment endpoints are pairwise distinct integers.The set is laminar \xe2\x80\x94 any two segments are either disjoint or one of them contains the other.Choose a non-empty subsegment [li,ri] with integer endpoints in each segment (Li\xe2\x89\xa4li<ri\xe2\x89\xa4Ri) in such a way that no two subsegments intersect (they are allowed to have common endpoints though) and the sum of their lengths (\xe2\x88\x91ni=1ri\xe2\x88\x92li) is maximized." dp 3200
259A "Little Elephant and Chess" "The Little Elephant loves chess very much. One day the Little Elephant and his friend decided to play chess. They\'ve got the chess pieces but the board is a problem. They\'ve got an 8\xe2\x80\x89\xc3\x97\xe2\x80\x898 checkered board, each square is painted either black or white. The Little Elephant and his friend know that a proper chessboard doesn\'t have any side-adjacent cells with the same color and the upper left cell is white. To play chess, they want to make the board they have a proper chessboard. For that the friends can choose any row of the board and cyclically shift the cells of the chosen row, that is, put the last (rightmost) square on the first place in the row and shift the others one position to the right. You can run the described operation multiple times (or not run it at all).For example, if the first line of the board looks like that ""BBBBBBWW"" (the white cells of the line are marked with character ""W"", the black cells are marked with character ""B""), then after one cyclic shift it will look like that ""WBBBBBBW"".Help the Little Elephant and his friend to find out whether they can use any number of the described operations to turn the board they have into a proper chessboard." "brute force,strings" 1000
1475A "Odd Divisor" "You are given an integer n. Check if n has an odd divisor, greater than one (does there exist such a number x (x>1) that n is divisible by x and x is odd).For example, if n=6, then there is x=3. If n=4, then such a number does not exist." "math,number theory" 900
1748B "Diverse Substrings" "A non-empty digit string is diverse if the number of occurrences of each character in it doesn\'t exceed the number of distinct characters in it.For example:   string ""7"" is diverse because 7 appears in it 1 time and the number of distinct characters in it is 1;  string ""77"" is not diverse because 7 appears in it 2 times and the number of distinct characters in it is 1;  string ""1010"" is diverse because both 0 and 1 appear in it 2 times and the number of distinct characters in it is 2;  string ""6668"" is not diverse because 6 appears in it 3 times and the number of distinct characters in it is 2. You are given a string s of length n, consisting of only digits 0 to 9. Find how many of its n(n+1)2 substrings are diverse.A string a is a substring of a string b if a can be obtained from b by deletion of several (possibly, zero or all) characters from the beginning and several (possibly, zero or all) characters from the end.Note that if the same diverse string appears in s multiple times, each occurrence should be counted independently. For example, there are two diverse substrings in ""77"" both equal to ""7"", so the answer for the string ""77"" is 2." "brute force,implementation,strings" 1400
553D "Nudist Beach" "Nudist Beach is planning a military operation to attack the Life Fibers. In this operation, they will attack and capture several cities which are currently under the control of the Life Fibers.There are n cities, labeled from 1 to n, and m bidirectional roads between them. Currently, there are Life Fibers in every city. In addition, there are k cities that are fortresses of the Life Fibers that cannot be captured under any circumstances. So, the Nudist Beach can capture an arbitrary non-empty subset of cities with no fortresses.After the operation, Nudist Beach will have to defend the captured cities from counterattack. If they capture a city and it is connected to many Life Fiber controlled cities, it will be easily defeated. So, Nudist Beach would like to capture a set of cities such that for each captured city the ratio of Nudist Beach controlled neighbors among all neighbors of that city is as high as possible. More formally, they would like to capture a non-empty set of cities S with no fortresses of Life Fibers. The strength of a city  is defined as (number of neighbors of x in S) / (total number of neighbors of x). Here, two cities are called neighbors if they are connnected with a road. The goal is to maximize the strength of the weakest city in S.Given a description of the graph, and the cities with fortresses, find a non-empty subset that maximizes the strength of the weakest city." "binary search,graphs,greedy" 2300
190C STL "Vasya used to be an accountant before the war began and he is one of the few who knows how to operate a computer, so he was assigned as the programmer.We all know that programs often store sets of integers. For example, if we have a problem about a weighted directed graph, its edge can be represented by three integers: the number of the starting vertex, the number of the final vertex and the edge\'s weight. So, as Vasya was trying to represent characteristics of a recently invented robot in his program, he faced the following problem.Vasya is not a programmer, so he asked his friend Gena, what the convenient way to store n integers is. Gena used to code in language X-- and so he can use only the types that occur in this language. Let\'s define, what a ""type"" is in language X--:  First, a type is a string ""int"".  Second, a type is a string that starts with ""pair"", then followed by angle brackets listing exactly two comma-separated other types of language X--. This record contains no spaces.  No other strings can be regarded as types. More formally: type := int | pair<type,type>. For example, Gena uses the following type for graph edges: pair<int,pair<int,int>>.Gena was pleased to help Vasya, he dictated to Vasya a type of language X--, that stores n integers. Unfortunately, Gena was in a hurry, so he omitted the punctuation. Now Gena has already left and Vasya can\'t find the correct punctuation, resulting in a type of language X--, however hard he tries.Help Vasya and add the punctuation marks so as to receive the valid type of language X--. Otherwise say that the task is impossible to perform." "dfs and similar" 1500
290C WTF? "HAII HAS A TUXGIMMEH TUXI HAS A FOO ITS 0I HAS A BAR ITS 0I HAS A BAZ ITS 0I HAS A QUZ ITS 1TUX IS NOW A NUMBRIM IN YR LOOP NERFIN YR TUX TIL BOTH SAEM TUX AN 0I HAS A PURGIMMEH PURPUR IS NOW A NUMBRFOO R SUM OF FOO AN PURBAR R SUM OF BAR AN 1BOTH SAEM BIGGR OF PRODUKT OF FOO AN QUZ AN PRODUKT OF BAR BAZ AN PRODUKT OF FOO AN QUZO RLY?YA RLYBAZ R FOOQUZ R BAROICIM OUTTA YR LOOPBAZ IS NOW A NUMBARVISIBLE SMOOSH QUOSHUNT OF BAZ QUZKTHXBYE" "*special problem,graph matchings,implementation,trees" 1700
852D "Exploration plan" "The competitors of Bubble Cup X gathered after the competition and discussed what is the best way to get to know the host country and its cities.After exploring the map of Serbia for a while, the competitors came up with the following facts: the country has V cities which are indexed with numbers from 1 to V, and there are E bi-directional roads that connect the cites. Each road has a weight (the time needed to cross that road). There are N teams at the Bubble Cup and the competitors came up with the following plan: each of the N teams will start their journey in one of the V cities, and some of the teams share the starting position.They want to find the shortest time T, such that every team can move in these T minutes, and the number of different cities they end up in is at least K (because they will only get to know the cities they end up in). A team doesn\'t have to be on the move all the time, if they like it in a particular city, they can stay there and wait for the time to pass.Please help the competitors to determine the shortest time T so it\'s possible for them to end up in at least K different cities or print -1 if that is impossible no matter how they move.Note that there can exist multiple roads between some cities." "binary search,flows,graph matchings,shortest paths" 2100
761F "Dasha and Photos" "Dasha decided to have a rest after solving the problem D and began to look photos from previous competitions.Let\'s call photos as the matrix with the size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m, which consists of lowercase English letters.Some k photos especially interested her, because they can be received from photo-template by painting a rectangular area in a certain color. Let\'s call such photos special.   More formally the i-th special photo is received from the photo-template by replacing all characters on some rectangle with upper left corner of the cell with coordinates (ai,\xe2\x80\x89bi) and lower right corner in the cell with coordinates (ci,\xe2\x80\x89di) to the symbol ei.Dasha asks you to find the special photo so that the total distance from it to all other special photos is minimum. And calculate this distance.Determine the distance between two photos as the sum of distances between all corresponding letters. The distance between two letters is the difference module of their positions in the alphabet. For example, the distance between letters \'h\' and \'m\' equals |8\xe2\x80\x89-\xe2\x80\x8913|\xe2\x80\x89=\xe2\x80\x895, because the letter \'h\' is the 8-th in the alphabet, the letter \'m\' is the 13-th." "brute force,data structures,dp,implementation" 2600
838A "Binary Blocks" "You are given an image, that can be represented with a 2-d n by m grid of pixels. Each pixel of the image is either on or off, denoted by the characters ""0"" or ""1"", respectively. You would like to compress this image. You want to choose an integer k\xe2\x80\x89>\xe2\x80\x891 and split the image into k by k blocks. If n and m are not divisible by k, the image is padded with only zeros on the right and bottom so that they are divisible by k. Each pixel in each individual block must have the same value. The given image may not be compressible in its current state. Find the minimum number of pixels you need to toggle (after padding) in order for the image to be compressible for some k. More specifically, the steps are to first choose k, then the image is padded with zeros, then, we can toggle the pixels so it is compressible for this k. The image must be compressible in that state." "brute force" 1400
1370E "Binary Subsequence Rotation" "Naman has two binary strings s and t of length n (a binary string is a string which only consists of the characters ""0"" and ""1""). He wants to convert s into t using the following operation as few times as possible.In one operation, he can choose any subsequence of s and rotate it clockwise once.For example, if s=1110100, he can choose a subsequence corresponding to indices (1-based) {2,6,7} and rotate them clockwise. The resulting string would then be s=1010110.A string a is said to be a subsequence of string b if a can be obtained from b by deleting some characters without changing the ordering of the remaining characters.To perform a clockwise rotation on a sequence c of size k is to perform an operation which sets c1:=ck,c2:=c1,c3:=c2,\xe2\x80\xa6,ck:=ck\xe2\x88\x921 simultaneously.Determine the minimum number of operations Naman has to perform to convert s into t or say that it is impossible." "binary search,constructive algorithms,data structures,greedy" 2100
1559D2 "Mocha and Diana (Hard Version)" "This is the hard version of the problem. The only difference between the two versions is the constraint on n. You can make hacks only if all versions of the problem are solved.A forest is an undirected graph without cycles (not necessarily connected).Mocha and Diana are friends in Zhijiang, both of them have a forest with nodes numbered from 1 to n, and they would like to add edges to their forests such that:   After adding edges, both of their graphs are still forests.  They add the same edges. That is, if an edge (u,v) is added to Mocha\'s forest, then an edge (u,v) is added to Diana\'s forest, and vice versa. Mocha and Diana want to know the maximum number of edges they can add, and which edges to add." "brute force,constructive algorithms,dfs and similar,dsu,graphs,greedy,trees,two pointers" 2500
1712A "Wonderful Permutation" "God\'s Blessing on This PermutationForces!A Random PebbleYou are given a permutation p1,p2,\xe2\x80\xa6,pn of length n and a positive integer k\xe2\x89\xa4n. In one operation you can choose two indices i and j (1\xe2\x89\xa4i<j\xe2\x89\xa4n) and swap pi with pj.Find the minimum number of operations needed to make the sum p1+p2+\xe2\x80\xa6+pk as small as possible.A permutation is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array) and [1,3,4] is also not a permutation (n=3 but there is 4 in the array)." greedy,implementation 800
1679E "Typical Party in Dorm" "Today is a holiday in the residence hall \xe2\x80\x94 Oleh arrived, in honor of which the girls gave him a string. Oleh liked the gift a lot, so he immediately thought up and offered you, his best friend, the following problem.You are given a string s of length n, which consists of the first 17 lowercase Latin letters {a, b, c, \xe2\x80\xa6, p, q} and question marks. And q queries. Each query is defined by a set of pairwise distinct lowercase first 17 letters of the Latin alphabet, which can be used to replace the question marks in the string s.The answer to the query is the sum of the number of distinct substrings that are palindromes over all strings that can be obtained from the original string s by replacing question marks with available characters. The answer must be calculated modulo 998244353.Pay attention! Two substrings are different when their start and end positions in the string are different. So, the number of different substrings that are palindromes for the string aba will be 4: a, b, a, aba.Consider examples of replacing question marks with letters. For example, from the string aba??ee when querying {a, b} you can get the strings ababaee or abaaaee but you cannot get the strings pizza,  abaee, abacaba, aba?fee, aba47ee, or abatree.Recall that a palindrome is a string that reads the same from left to right as from right to left." bitmasks,combinatorics,dp,strings 2400
140B "New Year Cards" "As meticulous Gerald sets the table, Alexander finished another post on Codeforces and begins to respond to New Year greetings from friends. Alexander has n friends, and each of them sends to Alexander exactly one e-card. Let us number his friends by numbers from 1 to n in the order in which they send the cards. Let\'s introduce the same numbering for the cards, that is, according to the numbering the i-th friend sent to Alexander a card number i.Alexander also sends cards to friends, but he doesn\'t look for the new cards on the Net. He simply uses the cards previously sent to him (sometimes, however, he does need to add some crucial details). Initially Alexander doesn\'t have any cards. Alexander always follows the two rules:  He will never send to a firend a card that this friend has sent to him.  Among the other cards available to him at the moment, Alexander always chooses one that Alexander himself likes most. Alexander plans to send to each friend exactly one card. Of course, Alexander can send the same card multiple times.Alexander and each his friend has the list of preferences, which is a permutation of integers from 1 to n. The first number in the list is the number of the favorite card, the second number shows the second favorite, and so on, the last number shows the least favorite card.Your task is to find a schedule of sending cards for Alexander. Determine at which moments of time Alexander must send cards to his friends, to please each of them as much as possible. In other words, so that as a result of applying two Alexander\'s rules, each friend receives the card that is preferred for him as much as possible.Note that Alexander doesn\'t choose freely what card to send, but he always strictly follows the two rules." "brute force,greedy,implementation" 1800
765A "Neverending competitions" "There are literally dozens of snooker competitions held each year, and team Jinotega tries to attend them all (for some reason they prefer name ""snookah"")! When a competition takes place somewhere far from their hometown, Ivan, Artsem and Konstantin take a flight to the contest and back.Jinotega\'s best friends, team Base have found a list of their itinerary receipts with information about departure and arrival airports. Now they wonder, where is Jinotega now: at home or at some competition far away? They know that:   this list contains all Jinotega\'s flights in this year (in arbitrary order),  Jinotega has only flown from his hometown to a snooker contest and back,  after each competition Jinotega flies back home (though they may attend a competition in one place several times),  and finally, at the beginning of the year Jinotega was at home. Please help them to determine Jinotega\'s location!" implementation,math 900
1674A "Number Transformation" "You are given two integers x and y. You want to choose two strictly positive (greater than zero) integers a and b, and then apply the following operation to x exactly a times: replace x with b\xe2\x8b\x85x.You want to find two positive integers a and b such that x becomes equal to y after this process. If there are multiple possible pairs, you can choose any of them. If there is no such pair, report it.For example:   if x=3 and y=75, you may choose a=2 and b=5, so that x becomes equal to 3\xe2\x8b\x855\xe2\x8b\x855=75;  if x=100 and y=100, you may choose a=3 and b=1, so that x becomes equal to 100\xe2\x8b\x851\xe2\x8b\x851\xe2\x8b\x851=100;  if x=42 and y=13, there is no answer since you cannot decrease x with the given operations." "constructive algorithms,math" 800
525B "Pasha and String" "Pasha got a very beautiful string s for his birthday, the string consists of lowercase Latin letters. The letters in the string are numbered from 1 to |s| from left to right, where |s| is the length of the given string.Pasha didn\'t like his present very much so he decided to change it. After his birthday Pasha spent m days performing the following transformations on his string \xe2\x80\x94 each day he chose integer ai and reversed a piece of string (a segment) from position ai to position |s|\xe2\x80\x89-\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x891. It is guaranteed that 2\xc2\xb7ai\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|s|.You face the following task: determine what Pasha\'s string will look like after m days." "constructive algorithms,greedy,math,strings" 1400
575G "Run for beer" "People in BubbleLand like to drink beer. Little do you know, beer here is so good and strong that every time you drink it your speed goes 10 times slower than before you drank it.Birko lives in city Beergrade, but wants to go to city Beerburg. You are given a road map of BubbleLand and you need to find the fastest way for him. When he starts his journey in Beergrade his speed is 1. When he comes to a new city he always tries a glass of local beer, which divides his speed by 10. The question here is what the minimal time for him to reach Beerburg is. If there are several paths with the same minimal time, pick the one that has least roads on it. If there is still more than one path, pick any.It is guaranteed that there will be at least one path from Beergrade to Beerburg." "dfs and similar,shortest paths" 2200
367B "Sereja ans Anagrams" "Sereja has two sequences a and b and number p. Sequence a consists of n integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. Similarly, sequence b consists of m integers b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bm. As usual, Sereja studies the sequences he has. Today he wants to find the number of positions q (q\xe2\x80\x89+\xe2\x80\x89(m\xe2\x80\x89-\xe2\x80\x891)\xc2\xb7p\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n; q\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x891), such that sequence b can be obtained from sequence aq,\xe2\x80\x89aq\xe2\x80\x89+\xe2\x80\x89p,\xe2\x80\x89aq\xe2\x80\x89+\xe2\x80\x892p,\xe2\x80\x89...,\xe2\x80\x89aq\xe2\x80\x89+\xe2\x80\x89(m\xe2\x80\x89-\xe2\x80\x891)p by rearranging elements.Sereja needs to rush to the gym, so he asked to find all the described positions of q." "binary search,data structures" 1900
1153D "Serval and Rooted Tree" "Now Serval is a junior high school student in Japari Middle School, and he is still thrilled on math as before. As a talented boy in mathematics, he likes to play with numbers. This time, he wants to play with numbers on a rooted tree.A tree is a connected graph without cycles. A rooted tree has a special vertex called the root. A parent of a node v is the last different from v vertex on the path from the root to the vertex v. Children of vertex v are all nodes for which v is the parent. A vertex is a leaf if it has no children.The rooted tree Serval owns has n nodes, node 1 is the root. Serval will write some numbers into all nodes of the tree. However, there are some restrictions. Each of the nodes except leaves has an operation max or min written in it, indicating that the number in this node should be equal to the maximum or minimum of all the numbers in its sons, respectively. Assume that there are k leaves in the tree. Serval wants to put integers 1,2,\xe2\x80\xa6,k to the k leaves (each number should be used exactly once). He loves large numbers, so he wants to maximize the number in the root. As his best friend, can you help him?" "binary search,dfs and similar,dp,greedy,trees" 1900
1033D Divisors "You are given n integers a1,a2,\xe2\x80\xa6,an. Each of ai has between 3 and 5 divisors. Consider a=\xe2\x88\x8fai \xe2\x80\x94 the product of all input integers. Find the number of divisors of a. As this number may be very large, print it modulo prime number 998244353." "interactive,math,number theory" 2000
229B Planets "Goa\'uld Apophis captured Jack O\'Neill\'s team again! Jack himself was able to escape, but by that time Apophis\'s ship had already jumped to hyperspace. But Jack knows on what planet will Apophis land. In order to save his friends, Jack must repeatedly go through stargates to get to this planet.Overall the galaxy has n planets, indexed with numbers from 1 to n. Jack is on the planet with index 1, and Apophis will land on the planet with index n. Jack can move between some pairs of planets through stargates (he can move in both directions); the transfer takes a positive, and, perhaps, for different pairs of planets unequal number of seconds. Jack begins his journey at time 0.It can be that other travellers are arriving to the planet where Jack is currently located. In this case, Jack has to wait for exactly 1 second before he can use the stargate. That is, if at time t another traveller arrives to the planet, Jack can only pass through the stargate at time t\xe2\x80\x89+\xe2\x80\x891, unless there are more travellers arriving at time t\xe2\x80\x89+\xe2\x80\x891 to the same planet.Knowing the information about travel times between the planets, and the times when Jack would not be able to use the stargate on particular planets, determine the minimum time in which he can get to the planet with index n." "binary search,data structures,graphs,shortest paths" 1700
1635E Cars "There are n cars on a coordinate axis OX. Each car is located at an integer point initially and no two cars are located at the same point. Also, each car is oriented either left or right, and they can move at any constant positive speed in that direction at any moment.More formally, we can describe the i-th car with a letter and an integer: its orientation orii and its location xi. If orii=L, then xi is decreasing at a constant rate with respect to time. Similarly, if orii=R, then xi is increasing at a constant rate with respect to time. We call two cars irrelevant if they never end up in the same point regardless of their speed. In other words, they won\'t share the same coordinate at any moment.We call two cars destined if they always end up in the same point regardless of their speed. In other words, they must share the same coordinate at some moment.Unfortunately, we lost all information about our cars, but we do remember m relationships. There are two types of relationships:1 i j \xe2\x80\x94i-th car and j-th car are irrelevant.2 i j \xe2\x80\x94i-th car and j-th car are destined.Restore the orientations and the locations of the cars satisfying the relationships, or report that it is impossible. If there are multiple solutions, you can output any.Note that if two cars share the same coordinate, they will intersect, but at the same moment they will continue their movement in their directions." "2-sat,constructive algorithms,dfs and similar,dsu,graphs,greedy,sortings" 2200
1864C "Divisor Chain" "You are given an integer x. Your task is to reduce x to 1.To do that, you can do the following operation:  select a divisor d of x, then change x to x\xe2\x88\x92d, i.e. reduce x by d. (We say that d is a divisor of x if d is an positive integer and there exists an integer q such that x=d\xe2\x8b\x85q.) There is an additional constraint: you cannot select the same value of d more than twice.For example, for x=5, the following scheme is invalid because 1 is selected more than twice: 5\xe2\x88\x921\xe2\x86\x924\xe2\x88\x921\xe2\x86\x923\xe2\x88\x921\xe2\x86\x922\xe2\x88\x921\xe2\x86\x921. The following scheme is however a valid one: 5\xe2\x88\x921\xe2\x86\x924\xe2\x88\x922\xe2\x86\x922\xe2\x88\x921\xe2\x86\x921.Output any scheme which reduces x to 1 with at most 1000 operations. It can be proved that such a scheme always exists." "bitmasks,constructive algorithms,math,number theory" 1300
1571F Kotlinforces "Kotlinforces is a web platfrom that hosts programming competitions.The staff of Kotlinforces is asked to schedule n programming competitions on the next m days. Each competition is held in multiple stages; the regulations of the i-th competition state that this competition should consist of exactly ki stages, and each stage, starting from the second one, should be scheduled exactly ti days after the previous stage. In other words, if the first stage of the i-th competition is scheduled on day x, the second stage should be scheduled on day x+ti, the third stage \xe2\x80\x94 on day x+2ti, ..., the ki-th stage (which is the last one) \xe2\x80\x94 on day x+(ki\xe2\x88\x921)ti.All n competitions should be scheduled in such a way that they start and finish during the next m days, and on any of these m days, at most one stage of one competition is held (two stages of different competitions should not be scheduled on the same day).Is it possible to schedule all n competitions to meet these constraints?" "*special problem,constructive algorithms,dp" 2000
1386A Colors "Linda likes to change her hair color from time to time, and would be pleased if her boyfriend Archie would notice the difference between the previous and the new color. Archie always comments on Linda\'s hair color if and only if he notices a difference \xe2\x80\x94 so Linda always knows whether Archie has spotted the difference or not.There is a new hair dye series in the market where all available colors are numbered by integers from 1 to N such that a smaller difference of the numerical values also means less visual difference.Linda assumes that for these series there should be some critical color difference C (1\xe2\x89\xa4C\xe2\x89\xa4N) for which Archie will notice color difference between the current color colornew and the previous color colorprev if |colornew\xe2\x88\x92colorprev|\xe2\x89\xa5C and will not if |colornew\xe2\x88\x92colorprev|<C.Now she has bought N sets of hair dye from the new series \xe2\x80\x94 one for each of the colors from 1 to N, and is ready to set up an experiment. Linda will change her hair color on a regular basis and will observe Archie\'s reaction \xe2\x80\x94 whether he will notice the color change or not. Since for the proper dye each set should be used completely, each hair color can be obtained no more than once.Before the experiment, Linda was using a dye from a different series which is not compatible with the new one, so for the clearness of the experiment Archie\'s reaction to the first used color is meaningless.Her aim is to find the precise value of C in a limited number of dyes. Write a program which finds the value of C by experimenting with the given N colors and observing Archie\'s reactions to color changes." "*special problem,binary search,constructive algorithms,interactive" 2700
1838A "Blackboard List" "Two integers were written on a blackboard. After that, the following step was carried out n\xe2\x88\x922 times:  Select any two integers on the board, and write the absolute value of their difference on the board. After this process was complete, the list of n integers was shuffled. You are given the final list. Recover one of the initial two numbers. You do not need to recover the other one.You are guaranteed that the input can be generated using the above process." "constructive algorithms,math" 800
379B "New Year Present" "The New Year is coming! That\'s why many people today are busy preparing New Year presents. Vasily the Programmer is no exception.Vasily knows that the best present is (no, it\'s not a contest) money. He\'s put n empty wallets from left to right in a row and decided how much money to put in what wallet. Vasily decided to put ai coins to the i-th wallet from the left.Vasily is a very busy man, so the money are sorted into the bags by his robot. Initially, the robot stands by the leftmost wallet in the row. The robot can follow instructions of three types: go to the wallet that is to the left of the current one (if such wallet exists), go to the wallet that is to the right of the current one (if such wallet exists), put a coin to the current wallet. Due to some technical malfunctions the robot cannot follow two ""put a coin"" instructions in a row.Vasily doesn\'t want to wait for long, so he wants to write a program for the robot that contains at most 106 operations (not necessarily minimum in length) the robot can use to put coins into the wallets. Help him." "constructive algorithms,implementation" 1200
1144D "Equalize Them All" "You are given an array a consisting of n integers. You can perform the following operations arbitrary number of times (possibly, zero):  Choose a pair of indices (i,j) such that |i\xe2\x88\x92j|=1 (indices i and j are adjacent) and set ai:=ai+|ai\xe2\x88\x92aj|;  Choose a pair of indices (i,j) such that |i\xe2\x88\x92j|=1 (indices i and j are adjacent) and set ai:=ai\xe2\x88\x92|ai\xe2\x88\x92aj|. The value |x| means the absolute value of x. For example, |4|=4, |\xe2\x88\x923|=3.Your task is to find the minimum number of operations required to obtain the array of equal elements and print the order of operations to do it.It is guaranteed that you always can obtain the array of equal elements using such operations.Note that after each operation each element of the current array should not exceed 1018 by absolute value." "constructive algorithms,greedy" 1400
204C "Little Elephant and Furik and Rubik" "Little Elephant loves Furik and Rubik, who he met in a small city Kremenchug.The Little Elephant has two strings of equal length a and b, consisting only of uppercase English letters. The Little Elephant selects a pair of substrings of equal length \xe2\x80\x94 the first one from string a, the second one from string b. The choice is equiprobable among all possible pairs. Let\'s denote the substring of a as x, and the substring of b \xe2\x80\x94 as y. The Little Elephant gives string x to Furik and string y \xe2\x80\x94 to Rubik.Let\'s assume that f(x,\xe2\x80\x89y) is the number of such positions of i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|x|), that xi\xe2\x80\x89=\xe2\x80\x89yi (where |x| is the length of lines x and y, and xi, yi are the i-th characters of strings x and y, correspondingly). Help Furik and Rubik find the expected value of f(x,\xe2\x80\x89y)." math,probabilities 2000
1398D "Colored Rectangles" "You are given three multisets of pairs of colored sticks:   R pairs of red sticks, the first pair has length r1, the second pair has length r2, \xe2\x80\xa6, the R-th pair has length rR;  G pairs of green sticks, the first pair has length g1, the second pair has length g2, \xe2\x80\xa6, the G-th pair has length gG;  B pairs of blue sticks, the first pair has length b1, the second pair has length b2, \xe2\x80\xa6, the B-th pair has length bB; You are constructing rectangles from these pairs of sticks with the following process:   take a pair of sticks of one color;  take a pair of sticks of another color different from the first one;  add the area of the resulting rectangle to the total area. Thus, you get such rectangles that their opposite sides are the same color and their adjacent sides are not the same color.Each pair of sticks can be used at most once, some pairs can be left unused. You are not allowed to split a pair into independent sticks.What is the maximum area you can achieve?" dp,greedy,sortings 1800
90B "African Crossword" "An African crossword is a rectangular table n\xe2\x80\x89\xc3\x97\xe2\x80\x89m in size. Each cell of the table contains exactly one letter. This table (it is also referred to as grid) contains some encrypted word that needs to be decoded.To solve the crossword you should cross out all repeated letters in rows and columns. In other words, a letter should only be crossed out if and only if the corresponding column or row contains at least one more letter that is exactly the same. Besides, all such letters are crossed out simultaneously.When all repeated letters have been crossed out, we should write the remaining letters in a string. The letters that occupy a higher position follow before the letters that occupy a lower position. If the letters are located in one row, then the letter to the left goes first. The resulting word is the answer to the problem.You are suggested to solve an African crossword and print the word encrypted there." implementation,strings 1100
1312G Autocompletion "You are given a set of strings S. Each string consists of lowercase Latin letters.For each string in this set, you want to calculate the minimum number of seconds required to type this string. To type a string, you have to start with an empty string and transform it into the string you want to type using the following actions:  if the current string is t, choose some lowercase Latin letter c and append it to the back of t, so the current string becomes t+c. This action takes 1 second;  use autocompletion. When you try to autocomplete the current string t, a list of all strings s\xe2\x88\x88S such that t is a prefix of s is shown to you. This list includes t itself, if t is a string from S, and the strings are ordered lexicographically. You can transform t into the i-th string from this list in i seconds. Note that you may choose any string from this list you want, it is not necessarily the string you are trying to type. What is the minimum number of seconds that you have to spend to type each string from S?Note that the strings from S are given in an unusual way." "data structures,dfs and similar,dp" 2600
1896A "Jagged Swaps" "You are given a permutation\xe2\x80\xa0 a of size n. You can do the following operation   Select an index i from 2 to n\xe2\x88\x921 such that ai\xe2\x88\x921<ai and ai>ai+1. Swap ai and ai+1. Determine whether it is possible to sort the permutation after a finite number of operations.\xe2\x80\xa0 A permutation is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array) and [1,3,4] is also not a permutation (n=3 but there is 4 in the array)." sortings 800
1103B "Game with modulo" "This is an interactive problem.Vasya and Petya are going to play the following game: Petya has some positive integer number a. After that Vasya should guess this number using the following questions. He can say a pair of non-negative integer numbers (x,y). Petya will answer him:   ""x"", if (xmoda)\xe2\x89\xa5(ymoda).  ""y"", if (xmoda)<(ymoda). We define (xmoda) as a remainder of division x by a.Vasya should guess the number a using no more, than 60 questions.It\'s guaranteed that Petya has a number, that satisfies the inequality 1\xe2\x89\xa4a\xe2\x89\xa4109.Help Vasya playing this game and write a program, that will guess the number a." "binary search,constructive algorithms,interactive" 2000
1735C "Phase Shift" "There was a string s which was supposed to be encrypted. For this reason, all 26 lowercase English letters were arranged in a circle in some order, afterwards, each letter in s was replaced with the one that follows in clockwise order, in that way the string t was obtained. You are given a string t. Determine the lexicographically smallest string s that could be a prototype of the given string t.A string a is lexicographically smaller than a string b of the same length if and only if:   in the first position where a and b differ, the string a has a letter, that appears earlier in the alphabet than the corresponding letter in b." "dfs and similar,dsu,graphs,greedy,implementation,strings" 1400
1774H "Maximum Permutation" "Ecrade bought a deck of cards numbered from 1 to n. Let the value of a permutation a of length n be n\xe2\x88\x92k+1mini=1 i+k\xe2\x88\x921\xe2\x88\x91j=iaj.Ecrade wants to find the most valuable one among all permutations of the cards. However, it seems a little difficult, so please help him!" "constructive algorithms" 3500
1730A Planets "One day, Vogons wanted to build a new hyperspace highway through a distant system with n planets. The i-th planet is on the orbit ai, there could be multiple planets on the same orbit. It\'s a pity that all the planets are on the way and need to be destructed.Vogons have two machines to do that.  The first machine in one operation can destroy any planet at cost of 1 Triganic Pu.  The second machine in one operation can destroy all planets on a single orbit in this system at the cost of c Triganic Pus. Vogons can use each machine as many times as they want.Vogons are very greedy, so they want to destroy all planets with minimum amount of money spent. Can you help them to know the minimum cost of this project?" "data structures,greedy,sortings" 800
732D Exams "Vasiliy has an exam period which will continue for n days. He has to pass exams on m subjects. Subjects are numbered from 1 to m.About every day we know exam for which one of m subjects can be passed on that day. Perhaps, some day you can\'t pass any exam. It is not allowed to pass more than one exam on any day. On each day Vasiliy can either pass the exam of that day (it takes the whole day) or prepare all day for some exam or have a rest. About each subject Vasiliy know a number ai \xe2\x80\x94 the number of days he should prepare to pass the exam number i. Vasiliy can switch subjects while preparing for exams, it is not necessary to prepare continuously during ai days for the exam number i. He can mix the order of preparation for exams in any way.Your task is to determine the minimum number of days in which Vasiliy can pass all exams, or determine that it is impossible. Each exam should be passed exactly one time." "binary search,greedy,sortings" 1700
1227F1 "Wrong Answer on test 233 (Easy Version)" "Your program fails again. This time it gets ""Wrong answer on test 233"".This is the easier version of the problem. In this version 1\xe2\x89\xa4n\xe2\x89\xa42000. You can hack this problem only if you solve and lock both problems.The problem is about a test containing n one-choice-questions. Each of the questions contains k options, and only one of them is correct. The answer to the i-th question is hi, and if your answer of the question i is hi, you earn 1 point, otherwise, you earn 0 points for this question. The values h1,h2,\xe2\x80\xa6,hn are known to you in this problem.However, you have a mistake in your program. It moves the answer clockwise! Consider all the n answers are written in a circle. Due to the mistake in your program, they are shifted by one cyclically.Formally, the mistake moves the answer for the question i to the question imodn+1. So it moves the answer for the question 1 to question 2, the answer for the question 2 to the question 3, ..., the answer for the question n to the question 1.We call all the n answers together an answer suit. There are kn possible answer suits in total.You\'re wondering, how many answer suits satisfy the following condition: after moving clockwise by 1, the total number of points of the new answer suit is strictly larger than the number of points of the old one. You need to find the answer modulo 998244353.For example, if n=5, and your answer suit is a=[1,2,3,4,5], it will submitted as a\xe2\x80\xb2=[5,1,2,3,4] because of a mistake. If the correct answer suit is h=[5,2,2,3,4], the answer suit a earns 1 point and the answer suite a\xe2\x80\xb2 earns 4 points. Since 4>1, the answer suit a=[1,2,3,4,5] should be counted." dp 2200
868A "Bark to Unlock" "As technologies develop, manufacturers are making the process of unlocking a phone as user-friendly as possible. To unlock its new phone, Arkady\'s pet dog Mu-mu has to bark the password once. The phone represents a password as a string of two lowercase English letters.Mu-mu\'s enemy Kashtanka wants to unlock Mu-mu\'s phone to steal some sensible information, but it can only bark n distinct words, each of which can be represented as a string of two lowercase English letters. Kashtanka wants to bark several words (not necessarily distinct) one after another to pronounce a string containing the password as a substring. Tell if it\'s possible to unlock the phone in this way, or not." "brute force,implementation,strings" 900
332A "Down the Hatch!" "Everybody knows that the Berland citizens are keen on health, especially students. Berland students are so tough that all they drink is orange juice!Yesterday one student, Vasya and his mates made some barbecue and they drank this healthy drink only. After they ran out of the first barrel of juice, they decided to play a simple game. All n people who came to the barbecue sat in a circle (thus each person received a unique index bi from 0 to n\xe2\x80\x89-\xe2\x80\x891). The person number 0 started the game (this time it was Vasya). All turns in the game were numbered by integers starting from 1. If the j-th turn was made by the person with index bi, then this person acted like that:  he pointed at the person with index (bi\xe2\x80\x89+\xe2\x80\x891) mod n either with an elbow or with a nod (x mod y is the remainder after dividing x by y);  if j\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x894 and the players who had turns number j\xe2\x80\x89-\xe2\x80\x891, j\xe2\x80\x89-\xe2\x80\x892, j\xe2\x80\x89-\xe2\x80\x893, made during their turns the same moves as player bi on the current turn, then he had drunk a glass of juice;  the turn went to person number (bi\xe2\x80\x89+\xe2\x80\x891) mod n. The person who was pointed on the last turn did not make any actions.The problem was, Vasya\'s drunk too much juice and can\'t remember the goal of the game. However, Vasya\'s got the recorded sequence of all the participants\' actions (including himself). Now Vasya wants to find out the maximum amount of juice he could drink if he played optimally well (the other players\' actions do not change). Help him.You can assume that in any scenario, there is enough juice for everybody." implementation 1300
205A "Little Elephant and Rozdil" "The Little Elephant loves Ukraine very much. Most of all he loves town Rozdol (ukr. ""Rozdil"").However, Rozdil is dangerous to settle, so the Little Elephant wants to go to some other town. The Little Elephant doesn\'t like to spend much time on travelling, so for his journey he will choose a town that needs minimum time to travel to. If there are multiple such cities, then the Little Elephant won\'t go anywhere.For each town except for Rozdil you know the time needed to travel to this town. Find the town the Little Elephant will go to or print ""Still Rozdil"", if he stays in Rozdil." "brute force,implementation" 900
919E "Congruence Equation" "Given an integer x. Your task is to find out how many positive integers n (1\xe2\x89\xa4n\xe2\x89\xa4x) satisfy n\xe2\x8b\x85an\xe2\x89\xa1b(modp), where a,b,p are all known constants." "chinese remainder theorem,math,number theory" 2100
1720D1 "Xor-Subsequence (easy version)" "It is the easy version of the problem. The only difference is that in this version ai\xe2\x89\xa4200.You are given an array of n integers a0,a1,a2,\xe2\x80\xa6an\xe2\x88\x921. Bryap wants to find the longest beautiful subsequence in the array.An array b=[b0,b1,\xe2\x80\xa6,bm\xe2\x88\x921], where 0\xe2\x89\xa4b0<b1<\xe2\x80\xa6<bm\xe2\x88\x921<n, is a subsequence of length m of the array a.Subsequence b=[b0,b1,\xe2\x80\xa6,bm\xe2\x88\x921] of length m is called beautiful, if the following condition holds:   For any p (0\xe2\x89\xa4p<m\xe2\x88\x921) holds: abp\xe2\x8a\x95bp+1<abp+1\xe2\x8a\x95bp. Here a\xe2\x8a\x95b denotes the bitwise XOR of a and b. For example, 2\xe2\x8a\x954=6 and 3\xe2\x8a\x951=2.Bryap is a simple person so he only wants to know the length of the longest such subsequence. Help Bryap and find the answer to his question." "bitmasks,brute force,dp,strings,trees,two pointers" 1800
1906J "Count BFS Graph" "You are currently researching a graph traversal algorithm called the Breadth First Search (BFS). Suppose you have an input graph of N nodes (numbered from 1 to N). The graph is represented by an adjacency matrix M, for which node u can traverse to node v if Mu,v is 1, otherwise it is 0. Your algorithm will output the order the nodes are visited in the BFS. The pseudocode of the algorithm is presented as follows.    BFS(M[1..N][1..N]):        let A be an empty array        let Q be an empty queue        append 1 to A        push 1 to Q        while Q is not empty:            pop the front element of Q into u            for v = 1 to N:                if M[u][v] == 1 and v is not in A:                    append v to A                    push v to Q        return ADuring your research, you are interested in the following problem. Given an array A such that A is a permutation of 1 to N and A1=1. How many simple undirected graph with N nodes and adjacency matrix M such that BFS(M)=A? Since the answer can be very large, calculate the answer modulo 998244353.A simple graph has no self-loop (Mi,i=0 for 1\xe2\x89\xa4i\xe2\x89\xa4N) and there is at most one edge that connects a pair of nodes. In an undirected graph, if node u is adjacent to node v, then node v is also adjacent to node u; formally, Mu,v=Mv,u for 1\xe2\x89\xa4u<v\xe2\x89\xa4N.Two graphs are considered different if there is an edge that exists in one graph but not the other. In other words, two graphs are considered different if their adjacency matrices are different." combinatorics,dp 2100
1873H "Mad City" "Marcel and Valeriu are in the mad city, which is represented by n buildings with n two-way roads between them. Marcel and Valeriu start at buildings a and b respectively. Marcel wants to catch Valeriu, in other words, be in the same building as him or meet on the same road. During each move, they choose to go to an adjacent building of their current one or stay in the same building. Because Valeriu knows Marcel so well, Valeriu can predict where Marcel will go in the next move. Valeriu can use this information to make his move. They start and end the move at the same time.It is guaranteed that any pair of buildings is connected by some path and there is at most one road between any pair of buildings.Assuming both players play optimally, answer if Valeriu has a strategy to indefinitely escape Marcel." "dfs and similar,dsu,games,graphs,shortest paths,trees" 1700
1717A "Madoka and Strange Thoughts" "Madoka is a very strange girl, and therefore she suddenly wondered how many pairs of integers (a,b) exist, where 1\xe2\x89\xa4a,b\xe2\x89\xa4n, for which lcm(a,b)gcd(a,b)\xe2\x89\xa43.In this problem, gcd(a,b) denotes the greatest common divisor of the numbers a and b, and lcm(a,b) denotes the smallest common multiple of the numbers a and b." "math,number theory" 800
1909A "Distinct Buttons" "Deemo - Entrance\xe2\xa0\x80You are located at the point (0,0) of an infinite Cartesian plane. You have a controller with 4 buttons which can perform one of the following operations:  U: move from (x,y) to (x,y+1);  R: move from (x,y) to (x+1,y);  D: move from (x,y) to (x,y\xe2\x88\x921);  L: move from (x,y) to (x\xe2\x88\x921,y). Unfortunately, the controller is broken. If you press all the 4 buttons (in any order), the controller stops working. It means that, during the whole trip, you can only press at most 3 distinct buttons (any number of times, in any order).There are n special points in the plane, with integer coordinates (xi,yi).Can you visit all the special points (in any order) without breaking the controller?" implementation,math 800
831C "Jury Marks" "Polycarp watched TV-show where k jury members one by one rated a participant by adding him a certain number of points (may be negative, i. e. points were subtracted). Initially the participant had some score, and each the marks were one by one added to his score. It is known that the i-th jury member gave ai points.Polycarp does not remember how many points the participant had before this k marks were given, but he remembers that among the scores announced after each of the k judges rated the participant there were n (n\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k) values b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bn (it is guaranteed that all values bj are distinct). It is possible that Polycarp remembers not all of the scores announced, i. e. n\xe2\x80\x89<\xe2\x80\x89k. Note that the initial score wasn\'t announced.Your task is to determine the number of options for the score the participant could have before the judges rated the participant." "brute force,constructive algorithms" 1700
1989F "Simultaneous Coloring" "You are given a matrix, consisting of n rows and m columns.You can perform two types of actions on it:   paint the entire column in blue;  paint the entire row in red. Note that you cannot choose which color to paint the row or column.In one second, you can perform either one action or multiple actions at the same time. If you perform one action, it will be free. If you perform k>1 actions at the same time, it will cost k2 coins. When multiple actions are performed at the same time, for each cell affected by actions of both types, the color can be chosen independently.You are asked to process q queries. Before each query, all cells become colorless. Initially, there are no restrictions on the color of any cells. In the i-th query, a restriction of the following form is added:   xi yi ci \xe2\x80\x94 the cell in row xi in column yi should be painted in color ci. Thus, after i queries, there are i restrictions on the required colors of the matrix cells. After each query, output the minimum cost of painting the matrix according to the restrictions." "dfs and similar,divide and conquer,graphs" 3000
392B "Tower of Hanoi" "The Tower of Hanoi is a well-known mathematical puzzle. It consists of three rods, and a number of disks of different sizes which can slide onto any rod. The puzzle starts with the disks in a neat stack in ascending order of size on one rod, the smallest at the top, thus making a conical shape.The objective of the puzzle is to move the entire stack to another rod, obeying the following simple rules:   Only one disk can be moved at a time.  Each move consists of taking the upper disk from one of the stacks and placing it on top of another stack i.e. a disk can only be moved if it is the uppermost disk on a stack.  No disk may be placed on top of a smaller disk. With three disks, the puzzle can be solved in seven moves. The minimum number of moves required to solve a Tower of Hanoi puzzle is 2n\xe2\x80\x89-\xe2\x80\x891, where n is the number of disks. (c) Wikipedia.SmallY\'s puzzle is very similar to the famous Tower of Hanoi. In the Tower of Hanoi puzzle you need to solve a puzzle in minimum number of moves, in SmallY\'s puzzle each move costs some money and you need to solve the same puzzle but for minimal cost. At the beginning of SmallY\'s puzzle all n disks are on the first rod. Moving a disk from rod i to rod j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i,\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x893) costs tij units of money. The goal of the puzzle is to move all the disks to the third rod.In the problem you are given matrix t and an integer n. You need to count the minimal cost of solving SmallY\'s puzzle, consisting of n disks." dp -999
1726B "Mainak and Interesting Sequence" "Mainak has two positive integers n and m.Mainak finds a sequence a1,a2,\xe2\x80\xa6,an of n positive integers interesting, if for all integers i (1\xe2\x89\xa4i\xe2\x89\xa4n), the bitwise XOR of all elements in a which are strictly less than ai is 0. Formally if pi is the bitwise XOR of all elements in a which are strictly less than ai, then a is an interesting sequence if p1=p2=\xe2\x80\xa6=pn=0.For example, sequences [1,3,2,3,1,2,3], [4,4,4,4], [25] are interesting, whereas [1,2,3,4] (p2=1\xe2\x89\xa00), [4,1,1,2,4] (p1=1\xe2\x8a\x951\xe2\x8a\x952=2\xe2\x89\xa00), [29,30,30] (p2=29\xe2\x89\xa00) aren\'t interesting.Here a\xe2\x8a\x95b denotes bitwise XOR of integers a and b.Find any interesting sequence a1,a2,\xe2\x80\xa6,an (or report that there exists no such sequence) such that the sum of the elements in the sequence a is equal to m, i.e. a1+a2\xe2\x80\xa6+an=m.As a reminder, the bitwise XOR of an empty sequence is considered to be 0." "bitmasks,constructive algorithms,math" 1100
257B "Playing Cubes" "Petya and Vasya decided to play a little. They found n red cubes and m blue cubes. The game goes like that: the players take turns to choose a cube of some color (red or blue) and put it in a line from left to right (overall the line will have n\xe2\x80\x89+\xe2\x80\x89m cubes). Petya moves first. Petya\'s task is to get as many pairs of neighbouring cubes of the same color as possible. Vasya\'s task is to get as many pairs of neighbouring cubes of different colors as possible. The number of Petya\'s points in the game is the number of pairs of neighboring cubes of the same color in the line, the number of Vasya\'s points in the game is the number of neighbouring cubes of the different color in the line. Your task is to calculate the score at the end of the game (Petya\'s and Vasya\'s points, correspondingly), if both boys are playing optimally well. To ""play optimally well"" first of all means to maximize the number of one\'s points, and second \xe2\x80\x94 to minimize the number of the opponent\'s points." games,greedy,implementation 1300
700A "As Fast As Possible" "On vacations n pupils decided to go on excursion and gather all together. They need to overcome the path with the length l meters. Each of the pupils will go with the speed equal to v1. To get to the excursion quickly, it was decided to rent a bus, which has seats for k people (it means that it can\'t fit more than k people at the same time) and the speed equal to v2. In order to avoid seasick, each of the pupils want to get into the bus no more than once.Determine the minimum time required for all n pupils to reach the place of excursion. Consider that the embarkation and disembarkation of passengers, as well as the reversal of the bus, take place immediately and this time can be neglected." "binary search,math" 1900
276E "Little Girl and Problem on Trees" "A little girl loves problems on trees very much. Here\'s one of them.A tree is an undirected connected graph, not containing cycles. The degree of node x in the tree is the number of nodes y of the tree, such that each of them is connected with node x by some edge of the tree. Let\'s consider a tree that consists of n nodes. We\'ll consider the tree\'s nodes indexed from 1 to n. The cosidered tree has the following property: each node except for node number 1 has the degree of at most 2.Initially, each node of the tree contains number 0. Your task is to quickly process the requests of two types:  Request of form: 0 v x d. In reply to the request you should add x to all numbers that are written in the nodes that are located at the distance of at most d from node v. The distance between two nodes is the number of edges on the shortest path between them.  Request of form: 1 v. In reply to the request you should print the current number that is written in node v." "data structures,graphs,trees" 2100
350E "Wrong Floyd" "Valera conducts experiments with algorithms that search for shortest paths. He has recently studied the Floyd\'s algorithm, so it\'s time to work with it.Valera\'s already written the code that counts the shortest distance between any pair of vertexes in a non-directed connected graph from n vertexes and m edges, containing no loops and multiple edges. Besides, Valera\'s decided to mark part of the vertexes. He\'s marked exactly k vertexes a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89ak.Valera\'s code is given below.ans[i][j] // the shortest distance for a pair of vertexes i,\xe2\x80\x89ja[i]  // vertexes, marked by Valerafor(i = 1; i <= n; i++) {    for(j = 1; j <= n; j++) {        if (i == j)            ans[i][j] = 0;        else            ans[i][j] = INF;  //INF is a very large number     }}    for(i = 1; i <= m; i++) {    read a pair of vertexes u, v that have a non-directed edge between them;    ans[u][v] = 1;    ans[v][u] = 1;}for (i = 1; i <= k; i++) {    v = a[i];    for(j = 1; j <= n; j++)        for(r = 1; r <= n; r++)            ans[j][r] = min(ans[j][r], ans[j][v] + ans[v][r]);}Valera has seen that his code is wrong. Help the boy. Given the set of marked vertexes a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89ak, find such non-directed connected graph, consisting of n vertexes and m edges, for which Valera\'s code counts the wrong shortest distance for at least one pair of vertexes (i,\xe2\x80\x89j). Valera is really keen to get a graph without any loops and multiple edges. If no such graph exists, print -1." "brute force,constructive algorithms,dfs and similar,graphs" 2200
1843D "Apple Tree" "Timofey has an apple tree growing in his garden; it is a rooted tree of n vertices with the root in vertex 1 (the vertices are numbered from 1 to n). A tree is a connected graph without loops and multiple edges.This tree is very unusual \xe2\x80\x94 it grows with its root upwards. However, it\'s quite normal for programmer\'s trees.The apple tree is quite young, so only two apples will grow on it. Apples will grow in certain vertices (these vertices may be the same). After the apples grow, Timofey starts shaking the apple tree until the apples fall. Each time Timofey shakes the apple tree, the following happens to each of the apples:Let the apple now be at vertex u.  If a vertex u has a child, the apple moves to it (if there are several such vertices, the apple can move to any of them).  Otherwise, the apple falls from the tree. It can be shown that after a finite time, both apples will fall from the tree.Timofey has q assumptions in which vertices apples can grow. He assumes that apples can grow in vertices x and y, and wants to know the number of pairs of vertices (a, b) from which apples can fall from the tree, where a \xe2\x80\x94 the vertex from which an apple from vertex x will fall, b \xe2\x80\x94 the vertex from which an apple from vertex y will fall. Help him do this." "combinatorics,dfs and similar,dp,math,trees" 1200
791A "Bear and Big Brother" "Bear Limak wants to become the largest of bears, or at least to become larger than his brother Bob.Right now, Limak and Bob weigh a and b respectively. It\'s guaranteed that Limak\'s weight is smaller than or equal to his brother\'s weight.Limak eats a lot and his weight is tripled after every year, while Bob\'s weight is doubled after every year.After how many full years will Limak become strictly larger (strictly heavier) than Bob?" implementation 800
368B "Sereja and Suffixes" "Sereja has an array a, consisting of n integers a1, a2, ..., an. The boy cannot sit and do nothing, he decided to study an array. Sereja took a piece of paper and wrote out m integers l1,\xe2\x80\x89l2,\xe2\x80\x89...,\xe2\x80\x89lm (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89li\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n). For each number li he wants to know how many distinct numbers are staying on the positions li, li\xe2\x80\x89+\xe2\x80\x891, ..., n. Formally, he want to find the number of distinct numbers among ali,\xe2\x80\x89ali\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89an.?Sereja wrote out the necessary array elements but the array was so large and the boy was so pressed for time. Help him, find the answer for the described question for each li." "data structures,dp" 1100
520D Cubes "Once Vasya and Petya assembled a figure of m cubes, each of them is associated with a number between 0 and m\xe2\x80\x89-\xe2\x80\x891 (inclusive, each number appeared exactly once). Let\'s consider a coordinate system such that the OX is the ground, and the OY is directed upwards. Each cube is associated with the coordinates of its lower left corner, these coordinates are integers for each cube.The figure turned out to be stable. This means that for any cube that is not on the ground, there is at least one cube under it such that those two cubes touch by a side or a corner. More formally, this means that for the cube with coordinates (x,\xe2\x80\x89y) either y\xe2\x80\x89=\xe2\x80\x890, or there is a cube with coordinates (x\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89y\xe2\x80\x89-\xe2\x80\x891), (x,\xe2\x80\x89y\xe2\x80\x89-\xe2\x80\x891) or (x\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89y\xe2\x80\x89-\xe2\x80\x891).Now the boys want to disassemble the figure and put all the cubes in a row. In one step the cube is removed from the figure and being put to the right of the blocks that have already been laid. The guys remove the cubes in such order that the figure remains stable. To make the process more interesting, the guys decided to play the following game. The guys take out the cubes from the figure in turns. It is easy to see that after the figure is disassembled, the integers written on the cubes form a number, written in the m-ary positional numerical system (possibly, with a leading zero). Vasya wants the resulting number to be maximum possible, and Petya, on the contrary, tries to make it as small as possible. Vasya starts the game.Your task is to determine what number is formed after the figure is disassembled, if the boys play optimally. Determine the remainder of the answer modulo 109\xe2\x80\x89+\xe2\x80\x899." games,greedy,implementation 2100
1100C "NN and the Optical Illusion" "NN is an experienced internet user and that means he spends a lot of time on the social media. Once he found the following image on the Net, which asked him to compare the sizes of inner circles:  It turned out that the circles are equal. NN was very surprised by this fact, so he decided to create a similar picture himself.He managed to calculate the number of outer circles n and the radius of the inner circle r. NN thinks that, using this information, you can exactly determine the radius of the outer circles R so that the inner circle touches all of the outer ones externally and each pair of neighboring outer circles also touches each other. While NN tried very hard to guess the required radius, he didn\'t manage to do that. Help NN find the required radius for building the required picture." "binary search,geometry,math" 1200
772D "Varying Kibibits" "You are given n integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. Denote this list of integers as T.Let f(L) be a function that takes in a non-empty list of integers L.The function will output another integer as follows:   First, all integers in L are padded with leading zeros so they are all the same length as the maximum length number in L.  We will construct a string where the i-th character is the minimum of the i-th character in padded input numbers.  The output is the number representing the string interpreted in base 10. For example f(10,\xe2\x80\x899)\xe2\x80\x89=\xe2\x80\x890, f(123,\xe2\x80\x89321)\xe2\x80\x89=\xe2\x80\x89121, f(530,\xe2\x80\x89932,\xe2\x80\x8981)\xe2\x80\x89=\xe2\x80\x8930.Define the function  Here,  denotes a subsequence.In other words, G(x) is the sum of squares of sum of elements of nonempty subsequences of T that evaluate to x when plugged into f modulo 1\xe2\x80\x89000\xe2\x80\x89000\xe2\x80\x89007, then multiplied by x. The last multiplication is not modded. You would like to compute G(0),\xe2\x80\x89G(1),\xe2\x80\x89...,\xe2\x80\x89G(999\xe2\x80\x89999). To reduce the output size, print the value , where  denotes the bitwise XOR operator." bitmasks,dp 2700
1718A1 "Burenka and Traditions (easy version)" "This is the easy version of this problem. The difference between easy and hard versions is only the constraints on ai and on n. You can make hacks only if both versions of the problem are solved.Burenka is the crown princess of Buryatia, and soon she will become the n-th queen of the country. There is an ancient tradition in Buryatia \xe2\x80\x94 before the coronation, the ruler must show their strength to the inhabitants. To determine the strength of the n-th ruler, the inhabitants of the country give them an array of a of exactly n numbers, after which the ruler must turn all the elements of the array into zeros in the shortest time. The ruler can do the following two-step operation any number of times:   select two indices l and r, so that 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n and a non-negative integer x, then  for all l\xe2\x89\xa4i\xe2\x89\xa4r assign ai:=ai\xe2\x8a\x95x, where \xe2\x8a\x95 denotes the bitwise XOR operation. It takes \xe2\x8c\x88r\xe2\x88\x92l+12\xe2\x8c\x89 seconds to do this operation, where \xe2\x8c\x88y\xe2\x8c\x89 denotes y rounded up to the nearest integer. Help Burenka calculate how much time she will need." dp,greedy 1800
711C "Coloring Trees" "ZS the Coder and Chris the Baboon has arrived at Udayland! They walked in the park where n trees grow. They decided to be naughty and color the trees in the park. The trees are numbered with integers from 1 to n from left to right.Initially, tree i has color ci. ZS the Coder and Chris the Baboon recognizes only m different colors, so 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ci\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m, where ci\xe2\x80\x89=\xe2\x80\x890 means that tree i is uncolored.ZS the Coder and Chris the Baboon decides to color only the uncolored trees, i.e. the trees with ci\xe2\x80\x89=\xe2\x80\x890. They can color each of them them in any of the m colors from 1 to m. Coloring the i-th tree with color j requires exactly pi,\xe2\x80\x89j litres of paint.The two friends define the beauty of a coloring of the trees as the minimum number of contiguous groups (each group contains some subsegment of trees) you can split all the n trees into so that each group contains trees of the same color. For example, if the colors of the trees from left to right are 2,\xe2\x80\x891,\xe2\x80\x891,\xe2\x80\x891,\xe2\x80\x893,\xe2\x80\x892,\xe2\x80\x892,\xe2\x80\x893,\xe2\x80\x891,\xe2\x80\x893, the beauty of the coloring is 7, since we can partition the trees into 7 contiguous groups of the same color : {2},\xe2\x80\x89{1,\xe2\x80\x891,\xe2\x80\x891},\xe2\x80\x89{3},\xe2\x80\x89{2,\xe2\x80\x892},\xe2\x80\x89{3},\xe2\x80\x89{1},\xe2\x80\x89{3}. ZS the Coder and Chris the Baboon wants to color all uncolored trees so that the beauty of the coloring is exactly k. They need your help to determine the minimum amount of paint (in litres) needed to finish the job.Please note that the friends can\'t color the trees that are already colored." dp 1700
538B "Quasi Binary" "A number is called quasibinary if its decimal representation contains only digits 0 or 1. For example, numbers 0, 1, 101, 110011 \xe2\x80\x94 are quasibinary and numbers 2, 12, 900 are not.You are given a positive integer n. Represent it as a sum of minimum number of quasibinary numbers." "constructive algorithms,dp,greedy,implementation" 1400
1053E "Euler tour" "Euler is a little, cute squirrel. When the autumn comes, he collects some reserves for winter. The interesting fact is that Euler likes to collect acorns in a specific way. A tree can be described as n acorns connected by n\xe2\x88\x921 branches, such that there is exactly one way between each pair of acorns. Let\'s enumerate the acorns from 1 to n.The squirrel chooses one acorn (not necessary with number 1) as a start, and visits them in a way called ""Euler tour"" (see notes), collecting each acorn when he visits it for the last time.Today morning Kate was observing Euler. She took a sheet of paper and wrote down consecutive indices of acorns on his path. Unfortunately, during her way to home it started raining and some of numbers became illegible. Now the girl is very sad, because she has to present the observations to her teacher.""Maybe if I guess the lacking numbers, I\'ll be able to do it!"" she thought. Help her and restore any valid Euler tour of some tree or tell that she must have made a mistake." "constructive algorithms,trees" 3500
950A "Left-handers, Right-handers and Ambidexters" "You are at a water bowling training. There are l people who play with their left hand, r people, who play with their right hand, and a ambidexters, who can play with left or right hand.The coach decided to form a team of even number of players, exactly half of the players should play with their right hand, and exactly half of the players should play with their left hand. One player should use only on of his hands.Ambidexters play as well with their right hand as with their left hand. In the team, an ambidexter can play with their left hand, or with their right hand.Please find the maximum possible size of the team, where equal number of players use their left and right hands, respectively." implementation,math 800
1042A Benches "There are n benches in the Berland Central park. It is known that ai people are currently sitting on the i-th bench. Another m people are coming to the park and each of them is going to have a seat on some bench out of n available.Let k be the maximum number of people sitting on one bench after additional m people came to the park. Calculate the minimum possible k and the maximum possible k.Nobody leaves the taken seat during the whole process." "binary search,implementation" 1100
1299A "Anu Has a Function" "Anu has created her own function f: f(x,y)=(x|y)\xe2\x88\x92y where | denotes the bitwise OR operation. For example, f(11,6)=(11|6)\xe2\x88\x926=15\xe2\x88\x926=9. It can be proved that for any nonnegative numbers x and y value of f(x,y) is also nonnegative. She would like to research more about this function and has created multiple problems for herself. But she isn\'t able to solve all of them and needs your help. Here is one of these problems.A value of an array [a1,a2,\xe2\x80\xa6,an] is defined as f(f(\xe2\x80\xa6f(f(a1,a2),a3),\xe2\x80\xa6an\xe2\x88\x921),an) (see notes). You are given an array with not necessarily distinct elements. How should you reorder its elements so that the value of the array is maximal possible?" "brute force,greedy,math" 1500
1833F "Ira and Flamenco" "Ira loves Spanish flamenco dance very much. She decided to start her own dance studio and found n students, ith of whom has level ai.Ira can choose several of her students and set a dance with them. So she can set a huge number of dances, but she is only interested in magnificent dances. The dance is called magnificent if the following is true:   exactly m students participate in the dance;  levels of all dancers are pairwise distinct;  levels of every two dancers have an absolute difference strictly less than m. For example, if m=3 and a=[4,2,2,3,6], the following dances are magnificent (students participating in the dance are highlighted in red): [4,2,2,3,6], [4,2,2,3,6]. At the same time dances [4,2,2,3,6], [4,2,2,3,6], [4,2,2,3,6] are not magnificent.In the dance [4,2,2,3,6] only 2 students participate, although m=3.The dance [4,2,2,3,6] involves students with levels 2 and 2, although levels of all dancers must be pairwise distinct.In the dance [4,2,2,3,6] students with levels 3 and 6 participate, but |3\xe2\x88\x926|=3, although m=3.Help Ira count the number of magnificent dances that she can set. Since this number can be very large, count it modulo 109+7. Two dances are considered different if the sets of students participating in them are different." "combinatorics,constructive algorithms,data structures,implementation,math,sortings,two pointers" 1700
1481D "AB Graph" "Your friend Salem is Warawreh\'s brother and only loves math and geometry problems. He has solved plenty of such problems, but according to Warawreh, in order to graduate from university he has to solve more graph problems. Since Salem is not good with graphs he asked your help with the following problem.  You are given a complete directed graph with n vertices without self-loops. In other words, you have n vertices and each pair of vertices u and v (u\xe2\x89\xa0v) has both directed edges (u,v) and (v,u).Every directed edge of the graph is labeled with a single character: either \'a\' or \'b\' (edges (u,v) and (v,u) may have different labels).You are also given an integer m>0. You should find a path of length m such that the string obtained by writing out edges\' labels when going along the path is a palindrome. The length of the path is the number of edges in it.You can visit the same vertex and the same directed edge any number of times." "brute force,constructive algorithms,graphs,greedy,implementation" 2000
1487C "Minimum Ties" "A big football championship will occur soon! n teams will compete in it, and each pair of teams will play exactly one game against each other.There are two possible outcomes of a game:  the game may result in a tie, then both teams get 1 point;  one team might win in a game, then the winning team gets 3 points and the losing team gets 0 points. The score of a team is the number of points it gained during all games that it played.You are interested in a hypothetical situation when all teams get the same score at the end of the championship. A simple example of that situation is when all games result in ties, but you want to minimize the number of ties as well.Your task is to describe a situation (choose the result of each game) so that all teams get the same score, and the number of ties is the minimum possible." "brute force,constructive algorithms,dfs and similar,graphs,greedy,implementation,math" 1500
1056C "Pick Heroes" "Don\'t you tell me what you think that I can beIf you say that Arkady is a bit old-fashioned playing checkers, you won\'t be right. There is also a modern computer game Arkady and his friends are keen on. We won\'t discuss its rules, the only feature important to this problem is that each player has to pick a distinct hero in the beginning of the game.There are 2 teams each having n players and 2n heroes to distribute between the teams. The teams take turns picking heroes: at first, the first team chooses a hero in its team, after that the second team chooses a hero and so on. Note that after a hero is chosen it becomes unavailable to both teams.The friends estimate the power of the i-th of the heroes as pi. Each team wants to maximize the total power of its heroes. However, there is one exception: there are m pairs of heroes that are especially strong against each other, so when any team chooses a hero from such a pair, the other team must choose the other one on its turn. Each hero is in at most one such pair.This is an interactive problem. You are to write a program that will optimally choose the heroes for one team, while the jury\'s program will play for the other team. Note that the jury\'s program may behave inefficiently, in this case you have to take the opportunity and still maximize the total power of your team. Formally, if you ever have chance to reach the total power of q or greater regardless of jury\'s program choices, you must get q or greater to pass a test." greedy,implementation,interactive,sortings 1700
731B "Coupons and Discounts" "The programming competition season has already started and it\'s time to train for ICPC. Sereja coaches his teams for a number of year and he knows that to get ready for the training session it\'s not enough to prepare only problems and editorial. As the training sessions lasts for several hours, teams become hungry. Thus, Sereja orders a number of pizzas so they can eat right after the end of the competition.Teams plan to train for n times during n consecutive days. During the training session Sereja orders exactly one pizza for each team that is present this day. He already knows that there will be ai teams on the i-th day.There are two types of discounts in Sereja\'s favourite pizzeria. The first discount works if one buys two pizzas at one day, while the second is a coupon that allows to buy one pizza during two consecutive days (two pizzas in total).As Sereja orders really a lot of pizza at this place, he is the golden client and can use the unlimited number of discounts and coupons of any type at any days.Sereja wants to order exactly ai pizzas on the i-th day while using only discounts and coupons. Note, that he will never buy more pizzas than he need for this particular day. Help him determine, whether he can buy the proper amount of pizzas each day if he is allowed to use only coupons and discounts. Note, that it\'s also prohibited to have any active coupons after the end of the day n." "constructive algorithms,greedy" 1100
1598A "Computer Game" "Monocarp is playing a computer game. Now he wants to complete the first level of this game.A level is a rectangular grid of 2 rows and n columns. Monocarp controls a character, which starts in cell (1,1) \xe2\x80\x94 at the intersection of the 1-st row and the 1-st column.Monocarp\'s character can move from one cell to another in one step if the cells are adjacent by side and/or corner. Formally, it is possible to move from cell (x1,y1) to cell (x2,y2) in one step if |x1\xe2\x88\x92x2|\xe2\x89\xa41 and |y1\xe2\x88\x92y2|\xe2\x89\xa41. Obviously, it is prohibited to go outside the grid.There are traps in some cells. If Monocarp\'s character finds himself in such a cell, he dies, and the game ends.To complete a level, Monocarp\'s character should reach cell (2,n) \xe2\x80\x94 at the intersection of row 2 and column n.Help Monocarp determine if it is possible to complete the level." "brute force,dfs and similar,dp,implementation" 800
421D "Bug in Code" "Recently a serious bug has been found in the FOS code. The head of the F company wants to find the culprit and punish him. For that, he set up an organizational meeting, the issue is: who\'s bugged the code? Each of the n coders on the meeting said: \'I know for sure that either x or y did it!\'The head of the company decided to choose two suspects and invite them to his office. Naturally, he should consider the coders\' opinions. That\'s why the head wants to make such a choice that at least p of n coders agreed with it. A coder agrees with the choice of two suspects if at least one of the two people that he named at the meeting was chosen as a suspect. In how many ways can the head of F choose two suspects?Note that even if some coder was chosen as a suspect, he can agree with the head\'s choice if he named the other chosen coder at the meeting." "binary search,data structures,sortings" 1900
158B Taxi "After the lessons n groups of schoolchildren went outside and decided to visit Polycarpus to celebrate his birthday. We know that the i-th group consists of si friends (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89si\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x894), and they want to go to Polycarpus together. They decided to get there by taxi. Each car can carry at most four passengers. What minimum number of cars will the children need if all members of each group should ride in the same taxi (but one taxi can take more than one group)?" "*special problem,greedy,implementation" 1100
379A "New Year Candles" "Vasily the Programmer loves romance, so this year he decided to illuminate his room with candles.Vasily has a candles.When Vasily lights up a new candle, it first burns for an hour and then it goes out. Vasily is smart, so he can make b went out candles into a new candle. As a result, this new candle can be used like any other new candle.Now Vasily wonders: for how many hours can his candles light up the room if he acts optimally well? Help him find this number." implementation 1000
1969F "Card Pairing" "There is a deck of n cards, each card has one of k types. You are given the sequence a1,a2,\xe2\x80\xa6,an denoting the types of cards in the deck from top to bottom. Both n and k are even numbers.You play a game with these cards. First, you draw k topmost cards from the deck. Then, the following happens each turn of the game:  you choose exactly two cards from your hand and play them. If these cards have the same type, you earn a coin;  then, if the deck is not empty, you draw exactly two top cards from it;  then, if both your hand and your deck are empty, the game ends. Otherwise, the new turn begins. You have to calculate the maximum number of coins you can earn during the game." dp,greedy,hashing,implementation 3000
1847D "Professor Higashikata" "Josuke is tired of his peaceful life in Morioh. Following in his nephew Jotaro\'s footsteps, he decides to study hard and become a professor of computer science. While looking up competitive programming problems online, he comes across the following one: Let s be a binary string of length n. An operation on s is defined as choosing two distinct integers i and j (1\xe2\x89\xa4i<j\xe2\x89\xa4n), and swapping the characters si,sj.Consider the m strings t1,t2,\xe2\x80\xa6,tm, where ti is the substring \xe2\x80\xa0 of s from li to ri. Define t(s)=t1+t2+\xe2\x80\xa6+tm as the concatenation of the strings ti in that order.There are q updates to the string. In the i-th update sxi gets flipped. That is if sxi=1, then sxi becomes 0 and vice versa. After each update, find the minimum number of operations one must perform on s to make t(s) lexicographically as large\xe2\x80\xa1 as possible. Note that no operation is actually performed. We are only interested in the number of operations.Help Josuke in his dream by solving the problem for him. \xe2\x80\x94\xe2\x80\x94\xe2\x80\x94\xe2\x80\x94\xe2\x80\x94\xe2\x80\x94\xe2\x80\x94\xe2\x80\x94\xe2\x80\x94\xe2\x80\x94\xe2\x80\x94\xe2\x80\x94\xe2\x80\x94\xe2\x80\x94\xe2\x80\x94\xe2\x80\x94\xe2\x80\x94\xe2\x80\x94\xe2\x80\x94\xe2\x80\x94\xe2\x80\x94\xe2\x80\x94 \xe2\x80\xa0 A string a is a substring of a string b if a can be obtained from b by the deletion of several (possibly, zero or all) characters from the beginning and several (possibly, zero or all) characters from the end.\xe2\x80\xa1 A string a is lexicographically larger than a string b of the same length if and only if the following holds:   in the first position where a and b differ, the string a has a 1, and the string b has a 0." "data structures,dsu,greedy,implementation,strings" 1900
1593D1 "All are Same" "This problem is a simplified version of D2, but it has significant differences, so read the whole statement.Polycarp has an array of n (n is even) integers a1,a2,\xe2\x80\xa6,an. Polycarp conceived of a positive integer k. After that, Polycarp began performing the following operations on the array: take an index i (1\xe2\x89\xa4i\xe2\x89\xa4n) and reduce the number ai by k.After Polycarp performed some (possibly zero) number of such operations, it turned out that all numbers in the array became the same. Find the maximum k at which such a situation is possible, or print \xe2\x88\x921 if such a number can be arbitrarily large." "math,number theory" 1100
1029E "Tree with Small Distances" "You are given an undirected tree consisting of n vertices. An undirected tree is a connected undirected graph with n\xe2\x88\x921 edges.Your task is to add the minimum number of edges in such a way that the length of the shortest path from the vertex 1 to any other vertex is at most 2. Note that you are not allowed to add loops and multiple edges." dp,graphs,greedy 2100
264C "Choosing Balls" "There are n balls. They are arranged in a row. Each ball has a color (for convenience an integer) and an integer value. The color of the i-th ball is ci and the value of the i-th ball is vi.Squirrel Liss chooses some balls and makes a new sequence without changing the relative order of the balls. She wants to maximize the value of this sequence.The value of the sequence is defined as the sum of following values for each ball (where a and b are given constants):  If the ball is not in the beginning of the sequence and the color of the ball is same as previous ball\'s color, add (the value of the ball) \xe2\x80\x89\xc3\x97\xe2\x80\x89 a.  Otherwise, add (the value of the ball) \xe2\x80\x89\xc3\x97\xe2\x80\x89 b. You are given q queries. Each query contains two integers ai and bi. For each query find the maximal value of the sequence she can make when a\xe2\x80\x89=\xe2\x80\x89ai and b\xe2\x80\x89=\xe2\x80\x89bi.Note that the new sequence can be empty, and the value of an empty sequence is defined as zero." dp 2000
1620F "Bipartite Array" "You are given a permutation p consisting of n integers 1,2,\xe2\x80\xa6,n (a permutation is an array where each element from 1 to n occurs exactly once).Let\'s call an array a bipartite if the following undirected graph is bipartite:  the graph consists of n vertices;  two vertices i and j are connected by an edge if i<j and ai>aj. Your task is to find a bipartite array of integers a of size n, such that ai=pi or ai=\xe2\x88\x92pi, or report that no such array exists. If there are multiple answers, print any of them." dp,greedy 2800
1007A "Reorder the Array" "You are given an array of integers. Vasya can permute (change order) its integers. He wants to do it so that as many as possible integers will become on a place where a smaller integer used to stand. Help Vasya find the maximal number of such integers.For instance, if we are given an array [10,20,30,40], we can permute it so that it becomes [20,40,10,30]. Then on the first and the second positions the integers became larger (20>10, 40>20) and did not on the third and the fourth, so for this permutation, the number that Vasya wants to maximize equals 2. Read the note for the first example, there is one more demonstrative test case.Help Vasya to permute integers in such way that the number of positions in a new array, where integers are greater than in the original one, is maximal." "combinatorics,data structures,math,sortings,two pointers" 1300
780D "Innokenty and a Football League" "Innokenty is a president of a new football league in Byteland. The first task he should do is to assign short names to all clubs to be shown on TV next to the score. Of course, the short names should be distinct, and Innokenty wants that all short names consist of three letters.Each club\'s full name consist of two words: the team\'s name and the hometown\'s name, for example, ""DINAMO BYTECITY"". Innokenty doesn\'t want to assign strange short names, so he wants to choose such short names for each club that:   the short name is the same as three first letters of the team\'s name, for example, for the mentioned club it is ""DIN"",  or, the first two letters of the short name should be the same as the first two letters of the team\'s name, while the third letter is the same as the first letter in the hometown\'s name. For the mentioned club it is ""DIB"". Apart from this, there is a rule that if for some club x the second option of short name is chosen, then there should be no club, for which the first option is chosen which is the same as the first option for the club x. For example, if the above mentioned club has short name ""DIB"", then no club for which the first option is chosen can have short name equal to ""DIN"". However, it is possible that some club have short name ""DIN"", where ""DI"" are the first two letters of the team\'s name, and ""N"" is the first letter of hometown\'s name. Of course, no two teams can have the same short name.Help Innokenty to choose a short name for each of the teams. If this is impossible, report that. If there are multiple answer, any of them will suit Innokenty. If for some team the two options of short name are equal, then Innokenty will formally think that only one of these options is chosen." "2-sat,graphs,greedy,implementation,shortest paths,strings" 1900
142C "Help Caretaker" "Autumn came late to the kingdom of Far Far Away. The harvest was exuberant and it is now time to get ready for the winter. As most people celebrate the Harvest festival, Simon the Caretaker tries to solve a very non-trivial task of how to find place for the agricultural equipment in the warehouse.He\'s got problems with some particularly large piece of equipment, which is, of course, turboplows. The problem is that when a turboplow is stored, it takes up not some simply rectangular space. It takes up a T-shaped space like on one of the four pictures below (here character ""#"" stands for the space occupied by the turboplow and character ""."" stands for the free space):   ###      ..#      .#.      #...#.      ###      .#.      ###.#.      ..#      ###      #..   Simon faced a quite natural challenge: placing in the given n\xe2\x80\x89\xc3\x97\xe2\x80\x89m cells warehouse the maximum number of turboplows. As one stores the turboplows, he can rotate them in any manner (so that they take up the space like on one of the four pictures above). However, two turboplows cannot ""overlap"", that is, they cannot share the same cell in the warehouse.Simon feels that he alone cannot find the optimal way of positioning the plugs in the warehouse that would maximize their quantity. Can you help him?" "brute force,dp" 2300
1523G "Try Booking" "William owns a flat in central London. He decided to rent his flat out for the next n days to earn some money.Since his flat is in the center of the city, he instantly got m offers in the form (li,ri), which means that someone wants to book the flat from day li until day ri inclusive. To avoid spending a lot of time figuring out whether it\'s profitable for him to accept an offer, William decided to develop an algorithm. The algorithm processes all offers as they arrive and will only accept offer i if the following two conditions are satisfied:  ri\xe2\x88\x92li+1\xe2\x89\xa5x.  None of the days between li and ri are occupied by a previously accepted offer  William isn\'t sure what value x should have and he asks you for help. For all x from 1 to n he wants you to calculate the total number of days for which the flat would be occupied if the corresponding value will be assigned to x." "data structures,divide and conquer" 3200
1795A "Two Towers" "There are two towers consisting of blocks of two colors: red and blue. Both towers are represented by strings of characters B and/or R denoting the order of blocks in them from the bottom to the top, where B corresponds to a blue block, and R corresponds to a red block.  These two towers are represented by strings BRBB and RBR. You can perform the following operation any number of times: choose a tower with at least two blocks, and move its top block to the top of the other tower.   The pair of towers is beautiful if no pair of touching blocks has the same color; i.\xe2\x80\x89e. no red block stands on top of another red block, and no blue block stands on top of another blue block.You have to check if it is possible to perform any number of operations (possibly zero) to make the pair of towers beautiful." "brute force,implementation,strings" 800
421A "Pasha and Hamsters" "Pasha has two hamsters: Arthur and Alexander. Pasha put n apples in front of them. Pasha knows which apples Arthur likes. Similarly, Pasha knows which apples Alexander likes. Pasha doesn\'t want any conflict between the hamsters (as they may like the same apple), so he decided to distribute the apples between the hamsters on his own. He is going to give some apples to Arthur and some apples to Alexander. It doesn\'t matter how many apples each hamster gets but it is important that each hamster gets only the apples he likes. It is possible that somebody doesn\'t get any apples.Help Pasha distribute all the apples between the hamsters. Note that Pasha wants to distribute all the apples, not just some of them." "constructive algorithms,implementation" 800
1141A "Game 23" "Polycarp plays ""Game 23"". Initially he has a number n and his goal is to transform it to m. In one move, he can multiply n by 2 or multiply n by 3. He can perform any number of moves.Print the number of moves needed to transform n to m. Print -1 if it is impossible to do so.It is easy to prove that any way to transform n to m contains the same number of moves (i.e. number of moves doesn\'t depend on the way of transformation)." implementation,math 1000
1197E "Culture Code" "There are famous Russian nesting dolls named matryoshkas sold in one of the souvenir stores nearby, and you\'d like to buy several of them. The store has n different matryoshkas. Any matryoshka is a figure of volume outi with an empty space inside of volume ini (of course, outi>ini).You don\'t have much free space inside your bag, but, fortunately, you know that matryoshkas can be nested one inside another. Formally, let\'s call a set of matryoshkas nested if we can rearrange dolls in such a way, that the first doll can be nested inside the second one, the second doll \xe2\x80\x94 inside the third one and so on. Matryoshka i can be nested inside matryoshka j if outi\xe2\x89\xa4inj. So only the last doll will take space inside your bag.Let\'s call extra space of a nested set of dolls as a total volume of empty space inside this structure. Obviously, it\'s equal to ini1+(ini2\xe2\x88\x92outi1)+(ini3\xe2\x88\x92outi2)+\xe2\x8b\xaf+(inik\xe2\x88\x92outik\xe2\x88\x921), where i1, i2, ..., ik are the indices of the chosen dolls in the order they are nested in each other.Finally, let\'s call a nested subset of the given sequence as big enough if there isn\'t any doll from the sequence that can be added to the nested subset without breaking its nested property.You want to buy many matryoshkas, so you should choose a big enough nested subset to buy it. But you will be disappointed if too much space in your bag will be wasted, so you want to choose a big enough subset so that its extra space is minimum possible among all big enough subsets. Now you wonder, how many different nested subsets meet these conditions (they are big enough, and there is no big enough subset such that its extra space is less than the extra space of the chosen subset). Two subsets are considered different if there exists at least one index i such that one of the subsets contains the i-th doll, and another subset doesn\'t.Since the answer can be large, print it modulo 109+7." "binary search,combinatorics,data structures,dp,shortest paths,sortings" 2300
2022D1 "Asesino (Easy Version)" "This is the easy version of the problem. In this version, you can ask at most n+69 questions. You can make hacks only if both versions of the problem are solved.This is an interactive problem.It is a tradition in Mexico\'s national IOI trainings to play the game ""Asesino"", which is similar to ""Among Us"" or ""Mafia"".Today, n players, numbered from 1 to n, will play ""Asesino"" with the following three roles:  Knight: a Knight is someone who always tells the truth.  Knave: a Knave is someone who always lies.  Impostor: an Impostor is someone everybody thinks is a Knight, but is secretly a Knave. Each player will be assigned a role in the game. There will be exactly one Impostor but there can be any (possible zero) number of Knights and Knaves.As the game moderator, you have accidentally forgotten the roles of everyone, but you need to determine the player who is the Impostor.To determine the Impostor, you will ask some questions. In each question, you will pick two players i and j (1\xe2\x89\xa4i,j\xe2\x89\xa4n; i\xe2\x89\xa0j) and ask if player i thinks that player j is a Knight. The results of the question is shown in the table below. KnightKnaveImpostorKnightYesNoYesKnaveNoYesNoImpostorNoYes\xe2\x80\x94 The response of the cell in row a and column b is the result of asking a question when i has role a and j has row b. For example, the ""Yes"" in the top right cell belongs to row ""Knight"" and column ""Impostor"", so it is the response when i is a Knight and j is an Impostor. Find the Impostor in at most n+69 questions.Note: the grader is adaptive: the roles of the players are not fixed in the beginning and may change depending on your questions. However, it is guaranteed that there exists an assignment of roles that is consistent with all previously asked questions under the constraints of this problem." "binary search,brute force,constructive algorithms,implementation,interactive" 1900
1037G "A Game on Strings" "Alice and Bob are playing a game on strings.Initially, they have some string t. In one move the first player selects the character c present in t and erases all it\'s occurrences in t, thus splitting t into many smaller strings. The game then goes independently with each of the strings \xe2\x80\x94 to make the move player selects one of the strings and one of the characters there, deletes all occurrences and adds the remaining string back to the game.Alice always starts the game, and then Alice and Bob take turns making moves. The player who is unable to make a move (because there is no string left) loses.Alice and Bob used to always start with a string s, but recently they found out that this became too boring. Now before each game they choose two integers l and r such that 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4|s| and play the game with the string slsl+1sl+2\xe2\x80\xa6sr instead.Given the string s and integers l, r for each game. Find who is going to win each game assuming they are smart and are playing optimally." games 3200
1826F "Fading into Fog" "This is an interactive problem.There are n distinct hidden points with real coordinates on a two-dimensional Euclidean plane. In one query, you can ask some line ax+by+c=0 and get the projections of all n points to this line in some order. The given projections are not exact, please read the interaction section for more clarity.Using the minimum number of queries, guess all n points and output them in some order. Here minimality means the minimum number of queries required to solve any possible test case with n points.The hidden points are fixed in advance and do not change throughout the interaction. In other words, the interactor is not adaptive.A projection of point A to line ax+by+c=0 is the point on the line closest to A." geometry,interactive,math,probabilities 2800
400A "Inna and Choose Options" "There always is something to choose from! And now, instead of ""Noughts and Crosses"", Inna choose a very unusual upgrade of this game. The rules of the game are given below:There is one person playing the game. Before the beginning of the game he puts 12 cards in a row on the table. Each card contains a character: ""X"" or ""O"". Then the player chooses two positive integers a and b (a\xc2\xb7b\xe2\x80\x89=\xe2\x80\x8912), after that he makes a table of size a\xe2\x80\x89\xc3\x97\xe2\x80\x89b from the cards he put on the table as follows: the first b cards form the first row of the table, the second b cards form the second row of the table and so on, the last b cards form the last (number a) row of the table. The player wins if some column of the table contain characters ""X"" on all cards. Otherwise, the player loses.Inna has already put 12 cards on the table in a row. But unfortunately, she doesn\'t know what numbers a and b to choose. Help her win the game: print to her all the possible ways of numbers a,\xe2\x80\x89b that she can choose and win." implementation 1000
825A "Binary Protocol" "Polycarp has just invented a new binary protocol for data transmission. He is encoding positive integer decimal number to binary string using following algorithm:  Each digit is represented with number of \'1\' characters equal to the value of that digit (for 0 it is zero ones).  Digits are written one by one in order corresponding to number and separated by single \'0\' character. Though Polycarp learnt how to encode the numbers, he has no idea how to decode them back. Help him calculate the decoded number." implementation 1100
1583B "Omkar and Heavenly Tree" "Lord Omkar would like to have a tree with n nodes (3\xe2\x89\xa4n\xe2\x89\xa4105) and has asked his disciples to construct the tree. However, Lord Omkar has created m (1\xe2\x89\xa4m<n) restrictions to ensure that the tree will be as heavenly as possible. A tree with n nodes is an connected undirected graph with n nodes and n\xe2\x88\x921 edges. Note that for any two nodes, there is exactly one simple path between them, where a simple path is a path between two nodes that does not contain any node more than once.Here is an example of a tree:   A restriction consists of 3 pairwise distinct integers, a, b, and c (1\xe2\x89\xa4a,b,c\xe2\x89\xa4n). It signifies that node b cannot lie on the simple path between node a and node c. Can you help Lord Omkar and become his most trusted disciple? You will need to find heavenly trees for multiple sets of restrictions. It can be shown that a heavenly tree will always exist for any set of restrictions under the given constraints." "constructive algorithms,trees" 1200
1109C "Sasha and a Patient Friend" "Fedya and Sasha are friends, that\'s why Sasha knows everything about Fedya.Fedya keeps his patience in an infinitely large bowl. But, unlike the bowl, Fedya\'s patience isn\'t infinite, that is why let v be the number of liters of Fedya\'s patience, and, as soon as v becomes equal to 0, the bowl will burst immediately. There is one tap in the bowl which pumps s liters of patience per second. Notice that s can be negative, in that case, the tap pumps out the patience. Sasha can do different things, so he is able to change the tap\'s speed. All actions that Sasha does can be represented as q queries. There are three types of queries:  ""1 t s""  \xe2\x80\x94 add a new event, means that starting from the t-th second the tap\'s speed will be equal to s.  ""2 t""  \xe2\x80\x94 delete the event which happens at the t-th second. It is guaranteed that such event exists.  ""3 l r v"" \xe2\x80\x94 Sasha wonders: if you take all the events for which l\xe2\x89\xa4t\xe2\x89\xa4r and simulate changes of Fedya\'s patience from the very beginning of the l-th second till the very beginning of the r-th second inclusive (the initial volume of patience, at the beginning of the l-th second, equals to v liters) then when will be the moment when the bowl will burst. If that does not happen, then the answer will be \xe2\x88\x921. Since Sasha does not want to check what will happen when Fedya\'s patience ends, and he has already come up with the queries, he is asking you to help him and find the answer for each query of the 3-rd type.It is guaranteed that at any moment of time, there won\'t be two events which happen at the same second." "binary search,data structures,implementation" 2800
1662M "Bottle Arrangements" "Gabriella has been instructed to organize a renowned wine tasting event which will be attended by m critics. On display, there will be n different varieties of wine, each of which can either be a red wine or a white wine.The wines will come in n bottles arranged in a line on the table, and, for convenience, each critic will sip from a contiguous interval of bottles: that is, he/she will taste exactly the bottles at position a,a+1,\xe2\x80\xa6,b for some 1\xe2\x89\xa4a\xe2\x89\xa4b\xe2\x89\xa4n. The interval depends on the critic, who will select it on the spot according to their preferences. In fact, the i-th critic (1\xe2\x89\xa4i\xe2\x89\xa4m) has requested that he/she wants to taste exactly ri red wines and wi white wines.Gabriella has yet to choose how many bottles of red wine and white wine there will be, and in what order they will appear. Help her find an arrangement (that is, a sequence of n bottles of either red or white wine) that satisfies the requests of all the critics, or state that no such arrangement exists." "constructive algorithms" -999
765G "Math, math everywhere" "If you have gone that far, you\'ll probably skip unnecessary legends anyway...You are given a binary string  and an integer . Find the number of integers k, 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k\xe2\x80\x89<\xe2\x80\x89N, such that for all i\xe2\x80\x89=\xe2\x80\x890, 1, ..., m\xe2\x80\x89-\xe2\x80\x891  Print the answer modulo 109\xe2\x80\x89+\xe2\x80\x897." "brute force,dp,math,meet-in-the-middle,number theory" 3200
1715F "Crop Squares" "This is an interactive problem.Farmer Stanley grows corn on a rectangular field of size n\xc3\x97m meters with corners in points (0,0), (0,m), (n,0), (n,m). This year the harvest was plentiful and corn covered the whole field.The night before harvest aliens arrived and poisoned the corn in a single 1\xc3\x971 square with sides parallel to field borders. The corn inside the square must not be eaten, but you cannot distinguish it from ordinary corn by sight. Stanley can only collect a sample of corn from an arbitrary polygon and bring it to the laboratory, where it will be analyzed and Stanley will be told the amount of corn in the sample that was poisoned. Since the harvest will soon deteriorate, such a study can be carried out no more than 5 times.More formally, it is allowed to make no more than 5 queries, each of them calculates the area of intersection of a chosen polygon with a square of poisoned corn. It is necessary to find out the coordinates of the lower-left corner of the drawn square (the vertex of the square with the smallest x and y coordinates)." "constructive algorithms,geometry,interactive,math" 2700
391D1 Supercollider "This problem consists of two subproblems: for solving subproblem D1 you will receive 3 points, and for solving subproblem D2 you will receive 16 points.Manao is the chief architect involved in planning a new supercollider. He has to identify a plot of land where the largest possible supercollider can be built. The supercollider he is building requires four-way orthogonal collisions of particles traveling at the same speed, so it will consist of four accelerating chambers and be shaped like a plus sign (i.e., +). Each of the four accelerating chambers must be the same length and must be aligned with the Earth\'s magnetic field (parallel or orthogonal) to minimize interference.The accelerating chambers need to be laid down across long flat stretches of land to keep costs under control. Thus, Manao has already commissioned a topographical study that has identified all possible maximal length tracts of land available for building accelerating chambers that are either parallel or orthogonal to the Earth\'s magnetic field. To build the largest possible supercollider, Manao must identify the largest symmetric plus shape from among these candidate tracts. That is, he must find the two tracts of land that form an axis-aligned plus shape with the largest distance from the center of the plus to the tip of the shortest of the four arms of the plus. Note that the collider need not use the entire length of the tracts identified (see the example in the notes)." "brute force" -999
671A "Recycling Bottles" "It was recycling day in Kekoland. To celebrate it Adil and Bera went to Central Perk where they can take bottles from the ground and put them into a recycling bin.We can think Central Perk as coordinate plane. There are n bottles on the ground, the i-th bottle is located at position (xi,\xe2\x80\x89yi). Both Adil and Bera can carry only one bottle at once each. For both Adil and Bera the process looks as follows:   Choose to stop or to continue to collect bottles.  If the choice was to continue then choose some bottle and walk towards it.  Pick this bottle and walk to the recycling bin.  Go to step 1. Adil and Bera may move independently. They are allowed to pick bottles simultaneously, all bottles may be picked by any of the two, it\'s allowed that one of them stays still while the other one continues to pick bottles.They want to organize the process such that the total distance they walk (the sum of distance walked by Adil and distance walked by Bera) is minimum possible. Of course, at the end all bottles should lie in the recycling bin." dp,geometry,greedy,implementation 1800
1800A "Is It a Cat?" "You were walking down the street and heard a sound. The sound was described by the string s consisting of lowercase and uppercase Latin characters. Now you want to find out if the sound was a cat meowing.For the sound to be a meowing, the string can only contain the letters \'m\', \'e\', \'o\' and \'w\', in either uppercase or lowercase. Also:   string must start with non-empty sequence consisting only of characters \'m\' or \'M\'  it must be immediately followed by non-empty sequence consisting only of characters \'e\' or \'E\'  it must be immediately followed by non-empty sequence consisting only of characters \'o\' or \'O\'  it must be immediately followed by non-empty sequence consisting only of characters \'w\' or \'W\', this sequence ends the string, after it immediately comes the string end For example, strings ""meow"", ""mmmEeOWww"", ""MeOooOw"" describe a meowing, but strings ""Mweo"", ""MeO"", ""moew"", ""MmEW"", ""meowmeow"" do not.Determine whether the sound you heard was a cat meowing or something else." implementation,strings 800
1842D "Tenzing and His Animal Friends" "Tell a story about me and my animal friends.Tenzing has n animal friends. He numbers them from 1 to n.One day Tenzing wants to play with his animal friends. To do so, Tenzing will host several games.In one game, he will choose a set S which is a subset of {1,2,3,...,n} and choose an integer t. Then, he will play the game with the animals in S for t minutes.But there are some restrictions:   Tenzing loves friend 1 very much, so 1 must be an element of S.  Tenzing doesn\'t like friend n, so n must not be an element of S.  There are m additional restrictions. The i-th special restriction is described by integers ui, vi and yi, suppose x is the total time that exactly one of ui and vi is playing with Tenzing. Tenzing must ensure that x is less or equal to yi. Otherwise, there will be unhappiness. Tenzing wants to know the maximum total time that he can play with his animal friends. Please find out the maximum total time that Tenzing can play with his animal friends and a way to organize the games that achieves this maximum total time, or report that he can play with his animal friends for an infinite amount of time. Also, Tenzing does not want to host so many games, so he will host at most n2 games." "constructive algorithms,graphs,greedy" 1900
23D Tetragon "You\'re given the centers of three equal sides of a strictly convex tetragon. Your task is to restore the initial tetragon." geometry,math 2600
571A "Lengthening Sticks" "You are given three sticks with positive integer lengths of a,\xe2\x80\x89b, and c centimeters. You can increase length of some of them by some positive integer number of centimeters (different sticks can be increased by a different length), but in total by at most l centimeters. In particular, it is allowed not to increase the length of any stick.Determine the number of ways to increase the lengths of some sticks so that you can form from them a non-degenerate (that is, having a positive area) triangle. Two ways are considered different, if the length of some stick is increased by different number of centimeters in them." combinatorics,implementation,math 2100
1208C "Magic Grid" "Let us define a magic grid to be a square matrix of integers of size n\xc3\x97n, satisfying the following conditions.   All integers from 0 to (n2\xe2\x88\x921) inclusive appear in the matrix exactly once.  Bitwise XOR of all elements in a row or a column must be the same for each row and column. You are given an integer n which is a multiple of 4. Construct a magic grid of size n\xc3\x97n." "constructive algorithms" 1800
1096A "Find Divisible" "You are given a range of positive integers from l to r.Find such a pair of integers (x,y) that l\xe2\x89\xa4x,y\xe2\x89\xa4r, x\xe2\x89\xa0y and x divides y.If there are multiple answers, print any of them.You are also asked to answer T independent queries." greedy,implementation,math 800
1789A "Serval and Mocha\'s Array" "Mocha likes arrays, and Serval gave her an array consisting of positive integers as a gift.Mocha thinks that for an array of positive integers a, it is good iff the greatest common divisor of all the elements in a is no more than its length. And for an array of at least 2 positive integers, it is beautiful iff all of its prefixes whose length is no less than 2 are good. For example:  [3,6] is not good, because gcd(3,6)=3 is greater than its length 2.  [1,2,4] is both good and beautiful, because all of its prefixes whose length is no less than 2, which are [1,2] and [1,2,4], are both good.  [3,6,1] is good but not beautiful, because [3,6] is not good. Now Mocha gives you the gift array a of n positive integers, and she wants to know whether array a could become beautiful by reordering the elements in a. It is allowed to keep the array a unchanged." "brute force,math,number theory" 800
940C "Phone Numbers" "And where the are the phone numbers?You are given a string s consisting of lowercase English letters and an integer k. Find the lexicographically smallest string t of length k, such that its set of letters is a subset of the set of letters of s and s is lexicographically smaller than t.It\'s guaranteed that the answer exists.Note that the set of letters is a set, not a multiset. For example, the set of letters of abadaba is {a,\xe2\x80\x89b,\xe2\x80\x89d}.String p is lexicographically smaller than string q, if p is a prefix of q, is not equal to q or there exists i, such that pi\xe2\x80\x89<\xe2\x80\x89qi and for all j\xe2\x80\x89<\xe2\x80\x89i it is satisfied that pj\xe2\x80\x89=\xe2\x80\x89qj. For example, abc is lexicographically smaller than abcd , abd is lexicographically smaller than abec, afa is not lexicographically smaller than ab and a is not lexicographically smaller than a." "constructive algorithms,implementation,strings" 1500
142D "Help Shrek and Donkey 2" "Having learned (not without some help from the Codeforces participants) to play the card game from the previous round optimally, Shrek and Donkey (as you may remember, they too live now in the Kingdom of Far Far Away) have decided to quit the boring card games and play with toy soldiers.The rules of the game are as follows: there is a battlefield, its size equals n\xe2\x80\x89\xc3\x97\xe2\x80\x89m squares, some squares contain the toy soldiers (the green ones belong to Shrek and the red ones belong to Donkey). Besides, each of the n lines of the area contains not more than two soldiers. During a move a players should select not less than 1 and not more than k soldiers belonging to him and make them either attack or retreat.An attack is moving all of the selected soldiers along the lines on which they stand in the direction of an enemy soldier, if he is in this line. If this line doesn\'t have an enemy soldier, then the selected soldier on this line can move in any direction during the player\'s move. Each selected soldier has to move at least by one cell. Different soldiers can move by a different number of cells. During the attack the soldiers are not allowed to cross the cells where other soldiers stand (or stood immediately before the attack). It is also not allowed to go beyond the battlefield or finish the attack in the cells, where other soldiers stand (or stood immediately before attack).A retreat is moving all of the selected soldiers along the lines on which they stand in the direction from an enemy soldier, if he is in this line. The other rules repeat the rules of the attack.For example, let\'s suppose that the original battlefield had the form (here symbols ""G"" mark Shrek\'s green soldiers and symbols ""R"" mark Donkey\'s red ones):  -G-R--R-G-  Let\'s suppose that k\xe2\x80\x89=\xe2\x80\x892 and Shrek moves first. If he decides to attack, then after his move the battlefield can look like that:  --GR-     --GR-     -G-R--RG--     -R-G-     -RG--  If in the previous example Shrek decides to retreat, then after his move the battlefield can look like that:  G--R-     G--R-     -G-R--R--G     -R-G-     -R--G  On the other hand, the followings fields cannot result from Shrek\'s correct move:  G--R-     ---RG     --GR--RG--     -R-G-     GR---  Shrek starts the game. To make a move means to attack or to retreat by the rules. A player who cannot make a move loses and his opponent is the winner. Determine the winner of the given toy soldier game if Shrek and Donkey continue to be under the yellow pills from the last rounds\' problem. Thus, they always play optimally (that is, they try to win if it is possible, or finish the game in a draw, by ensuring that it lasts forever, if they cannot win)." games 2600
845A "Chess Tourney" "Berland annual chess tournament is coming!Organizers have gathered 2\xc2\xb7n chess players who should be divided into two teams with n people each. The first team is sponsored by BerOil and the second team is sponsored by BerMobile. Obviously, organizers should guarantee the win for the team of BerOil.Thus, organizers should divide all 2\xc2\xb7n players into two teams with n people each in such a way that the first team always wins.Every chess player has its rating ri. It is known that chess player with the greater rating always wins the player with the lower rating. If their ratings are equal then any of the players can win.After teams assignment there will come a drawing to form n pairs of opponents: in each pair there is a player from the first team and a player from the second team. Every chess player should be in exactly one pair. Every pair plays once. The drawing is totally random.Is it possible to divide all 2\xc2\xb7n players into two teams with n people each so that the player from the first team in every pair wins regardless of the results of the drawing?" implementation,sortings 1100
1575B "Building an Amusement Park" "Mr. Chanek lives in a city represented as a plane. He wants to build an amusement park in the shape of a circle of radius r. The circle must touch the origin (point (0,0)).There are n bird habitats that can be a photo spot for the tourists in the park. The i-th bird habitat is at point pi=(xi,yi). Find the minimum radius r of a park with at least k bird habitats inside. A point is considered to be inside the park if and only if the distance between pi and the center of the park is less than or equal to the radius of the park. Note that the center and the radius of the park do not need to be integers.In this problem, it is guaranteed that the given input always has a solution with r\xe2\x89\xa42\xe2\x8b\x85105." "binary search,geometry" 2300
623C "Electric Charges" "Programmer Sasha is a student at MIPT (Moscow Institute of Physics and Technology) and he needs to make a laboratory work to pass his finals.A laboratory unit is a plane with standard coordinate axes marked on it. Physicists from Moscow Institute of Physics and Technology charged the axes by large electric charges: axis X is positive and axis Y is negative.Experienced laboratory worker marked n points with integer coordinates (xi,\xe2\x80\x89yi) on the plane and stopped the time. Sasha should use ""atomic tweezers"" to place elementary particles in these points. He has an unlimited number of electrons (negatively charged elementary particles) and protons (positively charged elementary particles). He can put either an electron or a proton at each marked point. As soon as all marked points are filled with particles, laboratory worker will turn on the time again and the particles will come in motion and after some time they will stabilize in equilibrium. The objective of the laboratory work is to arrange the particles in such a way, that the diameter of the resulting state (the maximum distance between the pairs of points of the set) is as small as possible.Since Sasha is a programmer, he naively thinks that all the particles will simply ""fall"" into their projections on the corresponding axes: electrons will fall on axis X, while protons will fall on axis Y. As we are programmers too, we will consider the same model as Sasha. That is, a particle gets from point (x,\xe2\x80\x89y) to point (x,\xe2\x80\x890) if it is an electron and to point (0,\xe2\x80\x89y) if it is a proton.As the laboratory has high background radiation and Sasha takes care of his laptop, he did not take it with him, and now he can\'t write a program that computes the minimum possible diameter of the resulting set. Therefore, you will have to do it for him.Print a square of the minimum possible diameter of the set." "binary search,dp" 2900
1479D "Odd Mineral Resource" "In Homer\'s country, there are n cities numbered 1 to n and they form a tree. That is, there are (n\xe2\x88\x921) undirected roads between these n cities and every two cities can reach each other through these roads. Homer\'s country is an industrial country, and each of the n cities in it contains some mineral resource. The mineral resource of city i is labeled ai. Homer is given the plans of the country in the following q years. The plan of the i-th year is described by four parameters ui,vi,li and ri, and he is asked to find any mineral resource ci such that the following two conditions hold:   mineral resource ci appears an odd number of times between city ui and city vi; and  li\xe2\x89\xa4ci\xe2\x89\xa4ri. As the best friend of Homer, he asks you for help. For every plan, find any such mineral resource ci, or tell him that there doesn\'t exist one." "binary search,bitmasks,brute force,data structures,probabilities,trees" 2900
464E "The Classic Problem" "You are given a weighted undirected graph on n vertices and m edges. Find the shortest path from vertex s to vertex t or else state that such path doesn\'t exist." "data structures,graphs,shortest paths" 3000
2003D2 "Turtle and a MEX Problem (Hard Version)" "The two versions are different problems. In this version of the problem, you can\'t choose the same integer twice or more. You can make hacks only if both versions are solved.One day, Turtle was playing with n sequences. Let the length of the i-th sequence be li. Then the i-th sequence was ai,1,ai,2,\xe2\x80\xa6,ai,li.Piggy gave Turtle a problem to solve when Turtle was playing. The statement of the problem was:  There was a non-negative integer x at first. Turtle would perform an arbitrary number (possibly zero) of operations on the integer.  In each operation, Turtle could choose an integer i such that 1\xe2\x89\xa4i\xe2\x89\xa4n and i wasn\'t chosen before, and set x to mex\xe2\x80\xa0(x,ai,1,ai,2,\xe2\x80\xa6,ai,li).  Turtle was asked to find the answer, which was the maximum value of x after performing an arbitrary number of operations. Turtle solved the above problem without difficulty. He defined f(k) as the answer to the above problem when the initial value of x was k.Then Piggy gave Turtle a non-negative integer m and asked Turtle to find the value of m\xe2\x88\x91i=0f(i) (i.e., the value of f(0)+f(1)+\xe2\x80\xa6+f(m)). Unfortunately, he couldn\'t solve this problem. Please help him!\xe2\x80\xa0mex(c1,c2,\xe2\x80\xa6,ck) is defined as the smallest non-negative integer x which does not occur in the sequence c. For example, mex(2,2,0,3) is 1, mex(1,2) is 0." "dfs and similar,dp,graphs,greedy,implementation,math" 2100
286E "Ladies\' Shop" "A ladies\' shop has recently opened in the city of Ultima Thule. To get ready for the opening, the shop bought n bags. Each bag is characterised by the total weight ai of the items you can put there. The weird thing is, you cannot use these bags to put a set of items with the total weight strictly less than ai. However the weights of the items that will be sold in the shop haven\'t yet been defined. That\'s what you should determine right now.Your task is to find the set of the items\' weights p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pk (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89p1\xe2\x80\x89<\xe2\x80\x89p2\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89pk), such that:  Any bag will be used. That is, for any i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) there will be such set of items that their total weight will equal ai. We assume that there is the infinite number of items of any weight. You can put multiple items of the same weight in one bag.  For any set of items that have total weight less than or equal to m, there is a bag into which you can put this set. Similarly, a set of items can contain multiple items of the same weight.  Of all sets of the items\' weights that satisfy points 1 and 2, find the set with the minimum number of weights. In other words, value k should be as small as possible. Find and print the required set." "constructive algorithms,fft,math" 2800
1369F BareLee "Lee is used to finish his stories in a stylish way, this time he barely failed it, but Ice Bear came and helped him. Lee is so grateful for it, so he decided to show Ice Bear his new game called ""Critic""...The game is a one versus one game. It has t rounds, each round has two integers si and ei (which are determined and are known before the game begins, si and ei may differ from round to round). The integer si is written on the board at the beginning of the corresponding round. The players will take turns. Each player will erase the number on the board (let\'s say it was a) and will choose to write either 2\xe2\x8b\x85a or a+1 instead. Whoever writes a number strictly greater than ei loses that round and the other one wins that round.Now Lee wants to play ""Critic"" against Ice Bear, for each round he has chosen the round\'s si and ei in advance. Lee will start the first round, the loser of each round will start the next round.The winner of the last round is the winner of the game, and the loser of the last round is the loser of the game.Determine if Lee can be the winner independent of Ice Bear\'s moves or not. Also, determine if Lee can be the loser independent of Ice Bear\'s moves or not." "dfs and similar,dp,games" 2700
1046F "Splitting money" "After finding and moving to the new planet that supports human life, discussions started on which currency should be used. After long negotiations, Bitcoin was ultimately chosen as the universal currency.These were the great news for Alice, whose grandfather got into Bitcoin mining in 2013, and accumulated a lot of them throughout the years. Unfortunately, when paying something in bitcoin everyone can see how many bitcoins you have in your public address wallet. This worried Alice, so she decided to split her bitcoins among multiple different addresses, so that every address has at most x satoshi (1 bitcoin = 108 satoshi). She can create new public address wallets for free and is willing to pay f fee in satoshi per transaction to ensure acceptable speed of transfer. The fee is deducted from the address the transaction was sent from. Tell Alice how much total fee in satoshi she will need to pay to achieve her goal." implementation 1400
335A Banana "Piegirl is buying stickers for a project. Stickers come on sheets, and each sheet of stickers contains exactly n stickers. Each sticker has exactly one character printed on it, so a sheet of stickers can be described by a string of length n. Piegirl wants to create a string s using stickers. She may buy as many sheets of stickers as she wants, and may specify any string of length n for the sheets, but all the sheets must be identical, so the string is the same for all sheets. Once she attains the sheets of stickers, she will take some of the stickers from the sheets and arrange (in any order) them to form s. Determine the minimum number of sheets she has to buy, and provide a string describing a possible sheet of stickers she should buy." "binary search,constructive algorithms,greedy" 1400
1691D "Max GEQ Sum" "You are given an array a of n integers. You are asked to find out if the inequality max(ai,ai+1,\xe2\x80\xa6,aj\xe2\x88\x921,aj)\xe2\x89\xa5ai+ai+1+\xe2\x8b\xaf+aj\xe2\x88\x921+aj holds for all pairs of indices (i,j), where 1\xe2\x89\xa4i\xe2\x89\xa4j\xe2\x89\xa4n." "binary search,constructive algorithms,data structures,divide and conquer,implementation,two pointers" 1800
757B "Bash\'s Big Day" "Bash has set out on a journey to become the greatest Pokemon master. To get his first Pokemon, he went to Professor Zulu\'s Lab. Since Bash is Professor Zulu\'s favourite student, Zulu allows him to take as many Pokemon from his lab as he pleases.But Zulu warns him that a group of k\xe2\x80\x89>\xe2\x80\x891 Pokemon with strengths {s1,\xe2\x80\x89s2,\xe2\x80\x89s3,\xe2\x80\x89...,\xe2\x80\x89sk} tend to fight among each other if gcd(s1,\xe2\x80\x89s2,\xe2\x80\x89s3,\xe2\x80\x89...,\xe2\x80\x89sk)\xe2\x80\x89=\xe2\x80\x891 (see notes for gcd definition).Bash, being smart, does not want his Pokemon to fight among each other. However, he also wants to maximize the number of Pokemon he takes from the lab. Can you help Bash find out the maximum number of Pokemon he can take? Note: A Pokemon cannot fight with itself." "greedy,math,number theory" 1400
1400D Zigzags "You are given an array a1,a2\xe2\x80\xa6an. Calculate the number of tuples (i,j,k,l) such that:   1\xe2\x89\xa4i<j<k<l\xe2\x89\xa4n;  ai=ak and aj=al;" "brute force,combinatorics,data structures,math,two pointers" 1900
44C Holidays "School holidays come in Berland. The holidays are going to continue for n days. The students of school \xe2\x84\x96N are having the time of their lives and the IT teacher Marina Sergeyevna, who has spent all the summer busy checking the BSE (Berland State Examination) results, has finally taken a vacation break! Some people are in charge of the daily watering of flowers in shifts according to the schedule. However when Marina Sergeyevna was making the schedule, she was so tired from work and so lost in dreams of the oncoming vacation that she perhaps made several mistakes. In fact, it is possible that according to the schedule, on some days during the holidays the flowers will not be watered or will be watered multiple times. Help Marina Sergeyevna to find a mistake." implementation 1300
1065F "Up and Down the Tree" "You are given a tree with n vertices; its root is vertex 1. Also there is a token, initially placed in the root. You can move the token to other vertices. Let\'s assume current vertex of token is v, then you make any of the following two possible moves:   move down to any leaf in subtree of v;  if vertex v is a leaf, then move up to the parent no more than k times. In other words, if h(v) is the depth of vertex v (the depth of the root is 0), then you can move to vertex to such that to is an ancestor of v and h(v)\xe2\x88\x92k\xe2\x89\xa4h(to). Consider that root is not a leaf (even if its degree is 1). Calculate the maximum number of different leaves you can visit during one sequence of moves." "dfs and similar,dp,trees" 2500
896A "Nephren gives a riddle" "What are you doing at the end of the world? Are you busy? Will you save us?Nephren is playing a game with little leprechauns.She gives them an infinite array of strings, f0... \xe2\x88\x9e.f0 is ""What are you doing at the end of the world? Are you busy? Will you save us?"".She wants to let more people know about it, so she defines fi\xe2\x80\x89=\xe2\x80\x89 ""What are you doing while sending ""fi\xe2\x80\x89-\xe2\x80\x891""? Are you busy? Will you send ""fi\xe2\x80\x89-\xe2\x80\x891""?"" for all i\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x891.For example, f1 is""What are you doing while sending ""What are you doing at the end of the world? Are you busy? Will you save us?""? Are you busy? Will you send ""What are you doing at the end of the world? Are you busy? Will you save us?""?"". Note that the quotes in the very beginning and in the very end are for clarity and are not a part of f1.It can be seen that the characters in fi are letters, question marks, (possibly) quotation marks and spaces.Nephren will ask the little leprechauns q times. Each time she will let them find the k-th character of fn. The characters are indexed starting from 1. If fn consists of less than k characters, output \'.\' (without quotes).Can you answer her queries?" "binary search,dfs and similar" 1700
316G2 "Good Substrings" "Smart Beaver recently got interested in a new word game. The point is as follows: count the number of distinct good substrings of some string s. To determine if a string is good or not the game uses rules. Overall there are n rules. Each rule is described by a group of three (p,\xe2\x80\x89l,\xe2\x80\x89r), where p is a string and l and r (l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r) are integers. We\xe2\x80\x99ll say that string t complies with rule (p,\xe2\x80\x89l,\xe2\x80\x89r), if the number of occurrences of string t in string p lies between l and r, inclusive. For example, string ""ab"", complies with rules (""ab"", 1, 2) and (""aab"", 0, 1), but does not comply with rules (""cd"", 1, 2) and (""abab"", 0, 1).A substring s[l... r] (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|s|) of string s\xe2\x80\x89=\xe2\x80\x89s1s2... s|s| (|s| is a length of s) is string slsl\xe2\x80\x89+\xe2\x80\x891... sr.Consider a number of occurrences  of string t in string p as a number of pairs of integers l,\xe2\x80\x89r (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|p|) such that p[l... r]\xe2\x80\x89=\xe2\x80\x89t.We\xe2\x80\x99ll say that string t is good if it complies with all n rules. Smart Beaver asks you to help him to write a program that can calculate the number of distinct good substrings of string s. Two substrings s[x... y] and s[z... w] are cosidered to be distinct iff s[x... y]\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89s[z... w]." "string suffix structures" 2200
340C "Tourist Problem" "Iahub is a big fan of tourists. He wants to become a tourist himself, so he planned a trip. There are n destinations on a straight road that Iahub wants to visit. Iahub starts the excursion from kilometer 0. The n destinations are described by a non-negative integers sequence a1, a2, ..., an. The number ak represents that the kth destination is at distance ak kilometers from the starting point. No two destinations are located in the same place. Iahub wants to visit each destination only once. Note that, crossing through a destination is not considered visiting, unless Iahub explicitly wants to visit it at that point. Also, after Iahub visits his last destination, he doesn\'t come back to kilometer 0, as he stops his trip at the last destination. The distance between destination located at kilometer x and next destination, located at kilometer y, is |x\xe2\x80\x89-\xe2\x80\x89y| kilometers. We call a ""route"" an order of visiting the destinations. Iahub can visit destinations in any order he wants, as long as he visits all n destinations and he doesn\'t visit a destination more than once. Iahub starts writing out on a paper all possible routes and for each of them, he notes the total distance he would walk. He\'s interested in the average number of kilometers he would walk by choosing a route. As he got bored of writing out all the routes, he asks you to help him." combinatorics,implementation,math 1600
180C Letter "Patrick has just finished writing a message to his sweetheart Stacey when he noticed that the message didn\'t look fancy. Patrick was nervous while writing the message, so some of the letters there were lowercase and some of them were uppercase.Patrick believes that a message is fancy if any uppercase letter stands to the left of any lowercase one. In other words, this rule describes the strings where first go zero or more uppercase letters, and then \xe2\x80\x94 zero or more lowercase letters.To make the message fancy, Patrick can erase some letter and add the same letter in the same place in the opposite case (that is, he can replace an uppercase letter with the lowercase one and vice versa). Patrick got interested in the following question: what minimum number of actions do we need to make a message fancy? Changing a letter\'s case in the message counts as one action. Patrick cannot perform any other actions." dp 1400
1970A3 "Balanced Unshuffle (Hard)" "The only difference with the medium version is the maximum length of the input.A parentheses sequence is a string consisting of characters ""("" and "")"", for example ""(()(("".A balanced parentheses sequence is a parentheses sequence which can become a valid mathematical expression after inserting numbers and operations into it, for example ""(()(()))"".The balance of a parentheses sequence is defined as the number of opening parentheses ""("" minus the number of closing parentheses "")"". For example, the balance of the sequence ""(()(("" is 3.A balanced parentheses sequence can also be defined as a parentheses sequence with balance 0 such that each of its prefixes has a non-negative balance.We define the balanced shuffle operation that takes a parentheses sequence and returns a parentheses sequence as follows: first, for every character of the input sequence, we compute the balance of the prefix of the sequence before that character and write those down in a table together with the positions of the characters in the input sequence, for example:Prefix balance01212321Position12345678Character(()(()))Then, we sort the columns of this table in increasing order of prefix balance, breaking ties in decreasing order of position. In the above example, we get:Prefix balance01112223Position18427536Character()(()())The last row of this table forms another parentheses sequence, in this case ""()(()())"". This sequence is called the result of applying the balanced shuffle operation to the input sequence, or in short just the balanced shuffle of the input sequence.Surprisingly, it turns out that the balanced shuffle of any balanced parentheses sequence is always another balanced parentheses sequence (we will omit the proof for brevity). Even more surprisingly, the balanced shuffles of two different balanced parentheses sequences are always different, therefore the balanced shuffle operation is a bijection on the set of balanced parentheses sequences of any given length (we will omit this proof, too).You are given a balanced parentheses sequence. Find its preimage: the balanced parentheses sequence the balanced shuffle of which is equal to the given sequence." "constructive algorithms,trees" 2400
1958H "Composite Spells" "Monocarp plays a fantasy RPG. His character is a mage, so he casts spells. There are two types of spells he knows \xe2\x80\x94 basic spells and composite spells.There are n basic spells in Monocarp\'s spell book, numbered from 1 to n. Each basic spell simply changes the health of the target: either decreases it or increases it. The i-th basic spell changes the target\'s health value by bi (increases by bi if bi is non-negative, or decreases by |bi| if bi is negative). If the target\'s health value goes to 0 or below, it dies, and all next spells cast at it do nothing.There are also m composite spells in the spell book, numbered from n+1 to n+m. Each composite spell is a sequence of other spells, cast in specific order. A composite spell can consist both of basic spells and composite spells; the i-th spell consists of si other spells, and each of those spells has index strictly less than i (so there is no situation that composite spells infinitely cast each other). So, actually, each composite spell can be considered a finite sequence of basic spells, although its length might be huge. Note that the same spell can appear in a composite spell multiple times.Monocarp has decided to cast the (n+m)-th spell from his spell book. The target of this spell is a monster with an initial health value of hp. Monocarp wants to know whether the monster will be killed or not, and if it will be killed, which basic spell will kill it." "*special problem,dp" 2600
520C "DNA Alignment" "Vasya became interested in bioinformatics. He\'s going to write an article about similar cyclic DNA sequences, so he invented a new method for determining the similarity of cyclic sequences.Let\'s assume that strings s and t have the same length n, then the function h(s,\xe2\x80\x89t) is defined as the number of positions in which the respective symbols of s and t are the same. Function h(s,\xe2\x80\x89t) can be used to define the function of Vasya distance \xcf\x81(s,\xe2\x80\x89t):  where  is obtained from string s, by applying left circular shift i times. For example, \xcf\x81(""AGC"",\xe2\x80\x89""CGT"")\xe2\x80\x89=\xe2\x80\x89 h(""AGC"",\xe2\x80\x89""CGT"")\xe2\x80\x89+\xe2\x80\x89h(""AGC"",\xe2\x80\x89""GTC"")\xe2\x80\x89+\xe2\x80\x89h(""AGC"",\xe2\x80\x89""TCG"")\xe2\x80\x89+\xe2\x80\x89 h(""GCA"",\xe2\x80\x89""CGT"")\xe2\x80\x89+\xe2\x80\x89h(""GCA"",\xe2\x80\x89""GTC"")\xe2\x80\x89+\xe2\x80\x89h(""GCA"",\xe2\x80\x89""TCG"")\xe2\x80\x89+\xe2\x80\x89 h(""CAG"",\xe2\x80\x89""CGT"")\xe2\x80\x89+\xe2\x80\x89h(""CAG"",\xe2\x80\x89""GTC"")\xe2\x80\x89+\xe2\x80\x89h(""CAG"",\xe2\x80\x89""TCG"")\xe2\x80\x89=\xe2\x80\x89 1\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x890\xe2\x80\x89+\xe2\x80\x890\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x890\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89=\xe2\x80\x896Vasya found a string s of length n on the Internet. Now he wants to count how many strings t there are such that the Vasya distance from the string s attains maximum possible value. Formally speaking, t must satisfy the equation: .Vasya could not try all possible strings to find an answer, so he needs your help. As the answer may be very large, count the number of such strings modulo 109\xe2\x80\x89+\xe2\x80\x897." math,strings 1500
701A Cards "There are n cards (n is even) in the deck. Each card has a positive integer written on it. n\xe2\x80\x89/\xe2\x80\x892 people will play new card game. At the beginning of the game each player gets two cards, each card is given to exactly one player. Find the way to distribute cards such that the sum of values written of the cards will be equal for each player. It is guaranteed that it is always possible." greedy,implementation 800
1425I "Impressive Harvesting of The Orchard" "Mr. Chanek has an orchard structured as a rooted ternary tree with N vertices numbered from 1 to N. The root of the tree is vertex 1. Pi denotes the parent of vertex i, for (2\xe2\x89\xa4i\xe2\x89\xa4N). Interestingly, the height of the tree is not greater than 10. Height of a tree is defined to be the largest distance from the root to a vertex in the tree.There exist a bush on each vertex of the tree. Initially, all bushes have fruits. Fruits will not grow on bushes that currently already have fruits. The bush at vertex i will grow fruits after Ai days since its last harvest.Mr. Chanek will visit his orchard for Q days. In day i, he will harvest all bushes that have fruits on the subtree of vertex Xi. For each day, determine the sum of distances from every harvested bush to Xi, and the number of harvested bush that day. Harvesting a bush means collecting all fruits on the bush.For example, if Mr. Chanek harvests all fruits on subtree of vertex X, and harvested bushes [Y1,Y2,\xe2\x80\xa6,YM], the sum of distances is \xe2\x88\x91Mi=1distance(X,Yi)distance(U,V) in a tree is defined to be the number of edges on the simple path from U to V." "data structures" 2800
1421D Hexagons "Lindsey Buckingham told Stevie Nicks ""Go your own way"". Nicks is now sad and wants to go away as quickly as possible, but she lives in a 2D hexagonal world.Consider a hexagonal tiling of the plane as on the picture below.  Nicks wishes to go from the cell marked (0,0) to a certain cell given by the coordinates. She may go from a hexagon to any of its six neighbors you want, but there is a cost associated with each of them. The costs depend only on the direction in which you travel. Going from (0,0) to (1,1) will take the exact same cost as going from (\xe2\x88\x922,\xe2\x88\x921) to (\xe2\x88\x921,0). The costs are given in the input in the order c1, c2, c3, c4, c5, c6 as in the picture below.  Print the smallest cost of a path from the origin which has coordinates (0,0) to the given cell." "brute force,constructive algorithms,greedy,implementation,math,shortest paths" 1900
1774F2 "Magician and Pigs (Hard Version)" "This is the hard version of the problem. The only difference between the two versions is the constraint on n and x. You can make hacks only if both versions of the problem are solved.Little09 has been interested in magic for a long time, and it\'s so lucky that he meets a magician! The magician will perform n operations, each of them is one of the following three: 1 x: Create a pig with x Health Points.  2 x: Reduce the Health Point of all living pigs by x.  3: Repeat all previous operations. Formally, assuming that this is the i-th operation in the operation sequence, perform the first i\xe2\x88\x921 operations (including ""Repeat"" operations involved) in turn.A pig will die when its Health Point is less than or equal to 0. Little09 wants to know how many living pigs there are after all the operations. Please, print the answer modulo 998244353." "binary search,brute force,data structures,implementation" 2700
116B "Little Pigs and Wolves" "Once upon a time there were several little pigs and several wolves on a two-dimensional grid of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m. Each cell in this grid was either empty, containing one little pig, or containing one wolf.A little pig and a wolf are adjacent if the cells that they are located at share a side. The little pigs are afraid of wolves, so there will be at most one wolf adjacent to each little pig. But each wolf may be adjacent to any number of little pigs.They have been living peacefully for several years. But today the wolves got hungry. One by one, each wolf will choose one of the little pigs adjacent to it (if any), and eats the poor little pig. This process is not repeated. That is, each wolf will get to eat at most one little pig. Once a little pig gets eaten, it disappears and cannot be eaten by any other wolf.What is the maximum number of little pigs that may be eaten by the wolves?" greedy,implementation 1100
1696E "Placing Jinas" "We say an infinite sequence a0,a1,a2,\xe2\x80\xa6 is non-increasing if and only if for all i\xe2\x89\xa50, ai\xe2\x89\xa5ai+1.There is an infinite right and down grid. The upper-left cell has coordinates (0,0). Rows are numbered 0 to infinity from top to bottom, columns are numbered from 0 to infinity from left to right.There is also a non-increasing infinite sequence a0,a1,a2,\xe2\x80\xa6. You are given a0, a1, \xe2\x80\xa6, an; for all i>n, ai=0. For every pair of x, y, the cell with coordinates (x,y) (which is located at the intersection of x-th row and y-th column) is white if y<ax and black otherwise.Initially there is one doll named Jina on (0,0). You can do the following operation.  Select one doll on (x,y). Remove it and place a doll on (x,y+1) and place a doll on (x+1,y). Note that multiple dolls can be present at a cell at the same time; in one operation, you remove only one. Your goal is to make all white cells contain 0 dolls.What\'s the minimum number of operations needed to achieve the goal? Print the answer modulo 109+7." combinatorics,math 2000
160D "Edges in MST" "You are given a connected weighted undirected graph without any loops and multiple edges. Let us remind you that a graph\'s spanning tree is defined as an acyclic connected subgraph of the given graph that includes all of the graph\'s vertexes. The weight of a tree is defined as the sum of weights of the edges that the given tree contains. The minimum spanning tree (MST) of a graph is defined as the graph\'s spanning tree having the minimum possible weight. For any connected graph obviously exists the minimum spanning tree, but in the general case, a graph\'s minimum spanning tree is not unique.Your task is to determine the following for each edge of the given graph: whether it is either included in any MST, or included at least in one MST, or not included in any MST." "dfs and similar,dsu,graphs,sortings" 2300
1692E "Binary Deque" "Slavic has an array of length n consisting only of zeroes and ones. In one operation, he removes either the first or the last element of the array. What is the minimum number of operations Slavic has to perform such that the total sum of the array is equal to s after performing all the operations? In case the sum s can\'t be obtained after any amount of operations, you should output -1." "binary search,implementation,two pointers" 1200
1421E "Swedish Heroes" "While playing yet another strategy game, Mans has recruited n Swedish heroes, whose powers which can be represented as an array a.Unfortunately, not all of those mighty heroes were created as capable as he wanted, so that he decided to do something about it. In order to accomplish his goal, he can pick two consecutive heroes, with powers ai and ai+1, remove them and insert a hero with power \xe2\x88\x92(ai+ai+1) back in the same position. For example if the array contains the elements [5,6,7,8], he can pick 6 and 7 and get [5,\xe2\x88\x92(6+7),8]=[5,\xe2\x88\x9213,8].After he will perform this operation n\xe2\x88\x921 times, Mans will end up having only one hero. He wants his power to be as big as possible. What\'s the largest possible power he can achieve?" "brute force,dp,implementation" 2700
1774E "Two Chess Pieces" "Cirno_9baka has a tree with n nodes. He is willing to share it with you, which means you can operate on it.Initially, there are two chess pieces on the node 1 of the tree. In one step, you can choose any piece, and move it to the neighboring node. You are also given an integer d. You need to ensure that the distance between the two pieces doesn\'t ever exceed d.Each of these two pieces has a sequence of nodes which they need to pass in any order, and eventually, they have to return to the root. As a curious boy, he wants to know the minimum steps you need to take." "dfs and similar,dp,greedy,trees" 1900
1856A "Tales of a Sort" "Alphen has an array of positive integers a of length n.Alphen can perform the following operation:   For all i from 1 to n, replace ai with max(0,ai\xe2\x88\x921). Alphen will perform the above operation until a is sorted, that is a satisfies a1\xe2\x89\xa4a2\xe2\x89\xa4\xe2\x80\xa6\xe2\x89\xa4an. How many operations will Alphen perform? Under the constraints of the problem, it can be proven that Alphen will perform a finite number of operations." implementation 800
1223F "Stack Exterminable Arrays" "Let\'s look at the following process: initially you have an empty stack and an array s of the length l. You are trying to push array elements to the stack in the order s1,s2,s3,\xe2\x80\xa6sl. Moreover, if the stack is empty or the element at the top of this stack is not equal to the current element, then you just push the current element to the top of the stack. Otherwise, you don\'t push the current element to the stack and, moreover, pop the top element of the stack. If after this process the stack remains empty, the array s is considered stack exterminable.There are samples of stack exterminable arrays:   [1,1];  [2,1,1,2];  [1,1,2,2];  [1,3,3,1,2,2];  [3,1,3,3,1,3];  [3,3,3,3,3,3];  [5,1,2,2,1,4,4,5]; Let\'s consider the changing of stack more details if s=[5,1,2,2,1,4,4,5] (the top of stack is highlighted).   after pushing s1=5 the stack turn into [5];  after pushing s2=1 the stack turn into [5,1];  after pushing s3=2 the stack turn into [5,1,2];  after pushing s4=2 the stack turn into [5,1];  after pushing s5=1 the stack turn into [5];  after pushing s6=4 the stack turn into [5,4];  after pushing s7=4 the stack turn into [5];  after pushing s8=5 the stack is empty. You are given an array a1,a2,\xe2\x80\xa6,an. You have to calculate the number of its subarrays which are stack exterminable.Note, that you have to answer q independent queries." "data structures,divide and conquer,dp,hashing" 2600
1480B "The Great Hero" "The great hero guards the country where Homer lives. The hero has attack power A and initial health value B. There are n monsters in front of the hero. The i-th monster has attack power ai and initial health value bi. The hero or a monster is said to be living, if his or its health value is positive (greater than or equal to 1); and he or it is said to be dead, if his or its health value is non-positive (less than or equal to 0).In order to protect people in the country, the hero will fight with monsters until either the hero is dead or all the monsters are dead.  In each fight, the hero can select an arbitrary living monster and fight with it. Suppose the i-th monster is selected, and the health values of the hero and the i-th monster are x and y before the fight, respectively. After the fight, the health values of the hero and the i-th monster become x\xe2\x88\x92ai and y\xe2\x88\x92A, respectively. Note that the hero can fight the same monster more than once.For the safety of the people in the country, please tell them whether the great hero can kill all the monsters (even if the great hero himself is dead after killing the last monster)." greedy,implementation,sortings 900
385C "Bear and Prime Numbers" "Recently, the bear started studying data structures and faced the following problem.You are given a sequence of integers x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xn of length n and m queries, each of them is characterized by two integers li,\xe2\x80\x89ri. Let\'s introduce f(p) to represent the number of such indexes k, that xk is divisible by p. The answer to the query li,\xe2\x80\x89ri is the sum: , where S(li,\xe2\x80\x89ri) is a set of prime numbers from segment [li,\xe2\x80\x89ri] (both borders are included in the segment).Help the bear cope with the problem." "binary search,brute force,data structures,dp,implementation,math,number theory" 1700
1197F "Coloring Game" "Alice and Bob want to play a game. They have n colored paper strips; the i-th strip is divided into ai cells numbered from 1 to ai. Each cell can have one of 3 colors.In the beginning of the game, Alice and Bob put n chips, the i-th chip is put in the ai-th cell of the i-th strip. Then they take turns, Alice is first. Each player during their turn has to choose one chip and move it 1, 2 or 3 cells backwards (i.\xe2\x80\x89e. if the current cell is x, then the chip can be moved to the cell x\xe2\x88\x921, x\xe2\x88\x922 or x\xe2\x88\x923). There are two restrictions: the chip cannot leave the borders of the strip (for example, if the current cell is 3, then you can\'t move the chip 3 cells backwards); and some moves may be prohibited because of color of the current cell (a matrix f with size 3\xc3\x973 is given, where fi,j=1 if it is possible to move the chip j cells backwards from the cell which has color i, or fi,j=0 if such move is prohibited). The player who cannot make a move loses the game.Initially some cells may be uncolored. Bob can color all uncolored cells as he wants (but he cannot leave any cell uncolored). Let\'s call a coloring good if Bob can win the game no matter how Alice acts, if the cells are colored according to this coloring. Two colorings are different if at least one cell is colored in different colors in these two colorings.Bob wants you to calculate the number of good colorings. Can you do it for him?Since the answer can be really large, you have to print it modulo 998244353." dp,games,matrices 2700
1010E Store "Natasha was already going to fly back to Earth when she remembered that she needs to go to the Martian store to buy Martian souvenirs for her friends.It is known, that the Martian year lasts xmax months, month lasts ymax days, day lasts zmax seconds. Natasha also knows that this store works according to the following schedule: 2 months in a year were selected: xl and xr (1\xe2\x89\xa4xl\xe2\x89\xa4xr\xe2\x89\xa4xmax), 2 days in a month: yl and yr (1\xe2\x89\xa4yl\xe2\x89\xa4yr\xe2\x89\xa4ymax) and 2 seconds in a day: zl and zr (1\xe2\x89\xa4zl\xe2\x89\xa4zr\xe2\x89\xa4zmax). The store works at all such moments (month x, day y, second z), when simultaneously xl\xe2\x89\xa4x\xe2\x89\xa4xr, yl\xe2\x89\xa4y\xe2\x89\xa4yr and zl\xe2\x89\xa4z\xe2\x89\xa4zr.Unfortunately, Natasha does not know the numbers xl,xr,yl,yr,zl,zr.One Martian told Natasha: ""I went to this store (n+m) times. n times of them it was opened, and m times \xe2\x80\x94 closed."" He also described his every trip to the store: the month, day, second of the trip and whether the store was open or closed at that moment.Natasha can go to the store k times. For each of them, determine whether the store at the time of the trip is open, closed, or this information is unknown." "data structures" 2700
1903D2 "Maximum And Queries (hard version)" "This is the hard version of the problem. The only difference between the two versions is the constraint on n and q, the memory and time limits. You can make hacks only if all versions of the problem are solved.Theofanis really likes to play with the bits of numbers. He has an array a of size n and an integer k. He can make at most k operations in the array. In each operation, he picks a single element and increases it by 1.He found the maximum bitwise AND that array a can have after at most k operations.Theofanis has put a lot of work into finding this value and was very happy with his result. Unfortunately, Ada\xc5\x9b, being the evil person that he is, decided to bully him by repeatedly changing the value of k.Help Theofanis by calculating the maximum possible bitwise AND for q different values of k. Note that queries are independent." "bitmasks,divide and conquer,dp,greedy" 2500
461D "Appleman and Complicated Task" "Toastman came up with a very complicated task. He gives it to Appleman, but Appleman doesn\'t know how to solve it. Can you help him?Given a n\xe2\x80\x89\xc3\x97\xe2\x80\x89n checkerboard. Each cell of the board has either character \'x\', or character \'o\', or nothing. How many ways to fill all the empty cells with \'x\' or \'o\' (each cell must contain only one character in the end) are there, such that for each cell the number of adjacent cells with \'o\' will be even? Find the number of ways modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897). Two cells of the board are adjacent if they share a side." dsu,math 2800
1824D "LuoTianyi and the Function" "LuoTianyi gives you an array a of n integers and the index begins from 1.Define g(i,j) as follows:  g(i,j) is the largest integer x that satisfies {ap:i\xe2\x89\xa4p\xe2\x89\xa4j}\xe2\x8a\x86{aq:x\xe2\x89\xa4q\xe2\x89\xa4j} while i\xe2\x89\xa4j;  and g(i,j)=0 while i>j. There are q queries. For each query you are given four integers l,r,x,y, you need to calculate r\xe2\x88\x91i=ly\xe2\x88\x91j=xg(i,j)." "data structures" 3000
1354E "Graph Coloring" "You are given an undirected graph without self-loops or multiple edges which consists of n vertices and m edges. Also you are given three integers n1, n2 and n3.Can you label each vertex with one of three numbers 1, 2 or 3 in such way, that:   Each vertex should be labeled by exactly one number 1, 2 or 3;  The total number of vertices with label 1 should be equal to n1;  The total number of vertices with label 2 should be equal to n2;  The total number of vertices with label 3 should be equal to n3;  |colu\xe2\x88\x92colv|=1 for each edge (u,v), where colx is the label of vertex x. If there are multiple valid labelings, print any of them." "dfs and similar,dp,graphs" 2100
376A Lever "You have a description of a lever as string s. We\'ll represent the string length as record |s|, then the lever looks as a horizontal bar with weights of length |s|\xe2\x80\x89-\xe2\x80\x891 with exactly one pivot. We will assume that the bar is a segment on the Ox axis between points 0 and |s|\xe2\x80\x89-\xe2\x80\x891.The decoding of the lever description is given below.  If the i-th character of the string equals ""^"", that means that at coordinate i there is the pivot under the bar.  If the i-th character of the string equals ""="", that means that at coordinate i there is nothing lying on the bar.  If the i-th character of the string equals digit c (1-9), that means that at coordinate i there is a weight of mass c on the bar. Your task is, given the lever description, print if it will be in balance or not. Assume that the bar doesn\'t weight anything. Assume that the bar initially is in balance then all weights are simultaneously put on it. After that the bar either tilts to the left, or tilts to the right, or is in balance." implementation,math 900
1200F "Graph Traveler" "Gildong is experimenting with an interesting machine Graph Traveler. In Graph Traveler, there is a directed graph consisting of n vertices numbered from 1 to n. The i-th vertex has mi outgoing edges that are labeled as ei[0], ei[1], \xe2\x80\xa6, ei[mi\xe2\x88\x921], each representing the destination vertex of the edge. The graph can have multiple edges and self-loops. The i-th vertex also has an integer ki written on itself.A travel on this graph works as follows.   Gildong chooses a vertex to start from, and an integer to start with. Set the variable c to this integer.  After arriving at the vertex i, or when Gildong begins the travel at some vertex i, add ki to c.  The next vertex is ei[x] where x is an integer 0\xe2\x89\xa4x\xe2\x89\xa4mi\xe2\x88\x921 satisfying x\xe2\x89\xa1c(modmi). Go to the next vertex and go back to step 2. It\'s obvious that a travel never ends, since the 2nd and the 3rd step will be repeated endlessly.For example, assume that Gildong starts at vertex 1 with c=5, and m1=2, e1[0]=1, e1[1]=2, k1=\xe2\x88\x923. Right after he starts at vertex 1, c becomes 2. Since the only integer x (0\xe2\x89\xa4x\xe2\x89\xa41) where x\xe2\x89\xa1c(modmi) is 0, Gildong goes to vertex e1[0]=1. After arriving at vertex 1 again, c becomes \xe2\x88\x921. The only integer x satisfying the conditions is 1, so he goes to vertex e1[1]=2, and so on.Since Gildong is quite inquisitive, he\'s going to ask you q queries. He wants to know how many distinct vertices will be visited infinitely many times, if he starts the travel from a certain vertex with a certain value of c. Note that you should not count the vertices that will be visited only finite times." "brute force,data structures,dfs and similar,dp,graphs,implementation,math,number theory" 2300
1312F "Attack on Red Kingdom" "The Red Kingdom is attacked by the White King and the Black King!The Kingdom is guarded by n castles, the i-th castle is defended by ai soldiers. To conquer the Red Kingdom, the Kings have to eliminate all the defenders. Each day the White King launches an attack on one of the castles. Then, at night, the forces of the Black King attack a castle (possibly the same one). Then the White King attacks a castle, then the Black King, and so on. The first attack is performed by the White King.Each attack must target a castle with at least one alive defender in it. There are three types of attacks:  a mixed attack decreases the number of defenders in the targeted castle by x (or sets it to 0 if there are already less than x defenders);  an infantry attack decreases the number of defenders in the targeted castle by y (or sets it to 0 if there are already less than y defenders);  a cavalry attack decreases the number of defenders in the targeted castle by z (or sets it to 0 if there are already less than z defenders). The mixed attack can be launched at any valid target (at any castle with at least one soldier). However, the infantry attack cannot be launched if the previous attack on the targeted castle had the same type, no matter when and by whom it was launched. The same applies to the cavalry attack. A castle that was not attacked at all can be targeted by any type of attack.The King who launches the last attack will be glorified as the conqueror of the Red Kingdom, so both Kings want to launch the last attack (and they are wise enough to find a strategy that allows them to do it no matter what are the actions of their opponent, if such strategy exists). The White King is leading his first attack, and you are responsible for planning it. Can you calculate the number of possible options for the first attack that allow the White King to launch the last attack? Each option for the first attack is represented by the targeted castle and the type of attack, and two options are different if the targeted castles or the types of attack are different." "games,two pointers" 2500
2032A Circuit "Alice has just crafted a circuit with n lights and 2n switches. Each component (a light or a switch) has two states: on or off. The lights and switches are arranged in a way that:  Each light is connected to exactly two switches.  Each switch is connected to exactly one light. It\'s unknown which light each switch is connected to.  When all switches are off, all lights are also off.  If a switch is toggled (from on to off, or vice versa), the state of the light connected to it will also toggle. Alice brings the circuit, which shows only the states of the 2n switches, to her sister Iris and gives her a riddle: what is the minimum and maximum number of lights that can be turned on?Knowing her little sister\'s antics too well, Iris takes no more than a second to give Alice a correct answer. Can you do the same?" "greedy,implementation,math,number theory" 800
650D Zip-line "Vasya has decided to build a zip-line on trees of a nearby forest. He wants the line to be as long as possible but he doesn\'t remember exactly the heights of all trees in the forest. He is sure that he remembers correct heights of all trees except, possibly, one of them.It is known that the forest consists of n trees staying in a row numbered from left to right with integers from 1 to n. According to Vasya, the height of the i-th tree is equal to hi. The zip-line of length k should hang over k (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) trees i1,\xe2\x80\x89i2,\xe2\x80\x89...,\xe2\x80\x89ik (i1\xe2\x80\x89<\xe2\x80\x89i2\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89ik) such that their heights form an increasing sequence, that is hi1\xe2\x80\x89<\xe2\x80\x89hi2\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89hik.Petya had been in this forest together with Vasya, and he now has q assumptions about the mistake in Vasya\'s sequence h. His i-th assumption consists of two integers ai and bi indicating that, according to Petya, the height of the tree numbered ai is actually equal to bi. Note that Petya\'s assumptions are independent from each other.Your task is to find the maximum length of a zip-line that can be built over the trees under each of the q assumptions.In this problem the length of a zip line is considered equal to the number of trees that form this zip-line." "binary search,data structures,dp,hashing" 2600
507A "Amr and Music" "Amr is a young coder who likes music a lot. He always wanted to learn how to play music but he was busy coding so he got an idea.Amr has n instruments, it takes ai days to learn i-th instrument. Being busy, Amr dedicated k days to learn how to play the maximum possible number of instruments.Amr asked for your help to distribute his free days between instruments so that he can achieve his goal." greedy,implementation,sortings 1000
685D "Kay and Eternity" "Snow Queen told Kay to form a word ""eternity"" using pieces of ice. Kay is eager to deal with the task, because he will then become free, and Snow Queen will give him all the world and a pair of skates.Behind the palace of the Snow Queen there is an infinite field consisting of cells. There are n pieces of ice spread over the field, each piece occupying exactly one cell and no two pieces occupying the same cell. To estimate the difficulty of the task Kay looks at some squares of size k\xe2\x80\x89\xc3\x97\xe2\x80\x89k cells, with corners located at the corners of the cells and sides parallel to coordinate axis and counts the number of pieces of the ice inside them.This method gives an estimation of the difficulty of some part of the field. However, Kay also wants to estimate the total difficulty, so he came up with the following criteria: for each x (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) he wants to count the number of squares of size k\xe2\x80\x89\xc3\x97\xe2\x80\x89k, such that there are exactly x pieces of the ice inside.Please, help Kay estimate the difficulty of the task given by the Snow Queen." "brute force,implementation,sortings" 2600
1041E "Tree Reconstruction" "Monocarp has drawn a tree (an undirected connected acyclic graph) and then has given each vertex an index. All indices are distinct numbers from 1 to n. For every edge e of this tree, Monocarp has written two numbers: the maximum indices of the vertices of the two components formed if the edge e (and only this edge) is erased from the tree.Monocarp has given you a list of n\xe2\x88\x921 pairs of numbers. He wants you to provide an example of a tree that will produce the said list if this tree exists. If such tree does not exist, say so." "constructive algorithms,data structures,graphs,greedy" 1900
925F "Parametric Circulation" "Vova has recently learned what a circulaton in a graph is. Recall the definition: let G=(V,E) be a directed graph. A circulation f is such a collection of non-negative real numbers fe (e\xe2\x88\x88E), that for each vertex v\xe2\x88\x88V the following conservation condition holds:\xe2\x88\x91e\xe2\x88\x88\xce\xb4\xe2\x88\x92(v)fe=\xe2\x88\x91e\xe2\x88\x88\xce\xb4+(v)fewhere \xce\xb4+(v) is the set of edges that end in the vertex v, and \xce\xb4\xe2\x88\x92(v) is the set of edges that start in the vertex v. In other words, for each vertex the total incoming flow should be equal to the total outcoming flow.Let a lr-circulation be such a circulation f that for each edge the condition le\xe2\x89\xa4fe\xe2\x89\xa4re holds, where le and re for each edge e\xe2\x88\x88E are two non-negative real numbers denoting the lower and upper bounds on the value of the circulation on this edge e.Vova can\'t stop thinking about applications of a new topic. Right now he thinks about the following natural question: let the graph be fixed, and each value le and re be a linear function of a real variable t:le(t)=aet+be re(t)=cet+deNote that t is the same for all edges.Let t be chosen at random from uniform distribution on a segment [0,1]. What is the probability of existence of lr-circulation in the graph?" "binary search,flows" 3100
2008B "Square or Not" "A beautiful binary matrix is a matrix that has ones on its edges and zeros inside.  Examples of four beautiful binary matrices. Today, Sakurako was playing with a beautiful binary matrix of size r\xc3\x97c and created a binary string s by writing down all the rows of the matrix, starting from the first and ending with the r-th. More formally, the element from the matrix in the i-th row and j-th column corresponds to the ((i\xe2\x88\x921)\xe2\x88\x97c+j)-th element of the string.You need to check whether the beautiful matrix from which the string s was obtained could be squared. In other words, you need to check whether the string s could have been build from a square beautiful binary matrix (i.e., one where r=c)." "brute force,math,strings" 800
1267D "DevOps Best Practices" "Daisy is a senior software engineer at RainyDay, LLC. She has just implemented three new features in their product: the first feature makes their product work, the second one makes their product fast, and the third one makes their product correct. The company encourages at least some testing of new features, so Daisy appointed her intern Demid to write some tests for the new features.Interestingly enough, these three features pass all the tests on Demid\'s development server, which has index 1, but might fail the tests on some other servers.After Demid has completed this task, Daisy appointed you to deploy these three features to all n servers of your company. For every feature f and every server s, Daisy told you whether she wants the feature f to be deployed on the server s. If she wants it to be deployed, it must be done even if the feature f fails the tests on the server s. If she does not want it to be deployed, you may not deploy it there.Your company has two important instruments for the deployment of new features to servers: Continuous Deployment (CD) and Continuous Testing (CT). CD can be established between several pairs of servers, forming a directed graph. CT can be set up on some set of servers.If CD is configured from the server s1 to the server s2 then every time s1 receives a new feature f the system starts the following deployment process of f to s2:  If the feature f is already deployed on the server s2, then nothing is done.  Otherwise, if CT is not set up on the server s1, then the server s1 just deploys the feature f to the server s2 without any testing.  Otherwise, the server s1 runs tests for the feature f. If the tests fail on the server s1, nothing is done. If the tests pass, then the server s1 deploys the feature f to the server s2. You are to configure the CD/CT system, and after that Demid will deploy all three features on his development server. Your CD/CT system must deploy each feature exactly to the set of servers that Daisy wants.Your company does not have a lot of computing resources, so you can establish CD from one server to another at most 264 times." "constructive algorithms" 2800
1528D "It\'s a bird! No, it\'s a plane! No, it\'s AaParsa!" "There are n cities in Shaazzzland, numbered from 0 to n\xe2\x88\x921. Ghaazzzland, the immortal enemy of Shaazzzland, is ruled by AaParsa.As the head of the Ghaazzzland\'s intelligence agency, AaParsa is carrying out the most important spying mission in Ghaazzzland\'s history on Shaazzzland.AaParsa has planted m transport cannons in the cities of Shaazzzland. The i-th cannon is planted in the city ai and is initially pointing at city bi.It is guaranteed that each of the n cities has at least one transport cannon planted inside it, and that no two cannons from the same city are initially pointing at the same city (that is, all pairs (ai,bi) are distinct).AaParsa used very advanced technology to build the cannons, the cannons rotate every second. In other words, if the i-th cannon is pointing towards the city x at some second, it will target the city (x+1)modn at the next second.As their name suggests, transport cannons are for transportation, specifically for human transport. If you use the i-th cannon to launch yourself towards the city that it\'s currently pointing at, you\'ll be airborne for ci seconds before reaching your target destination.If you still don\'t get it, using the i-th cannon at the s-th second (using which is only possible if you are currently in the city ai) will shoot you to the city (bi+s)modn and you\'ll land in there after ci seconds (so you\'ll be there in the (s+ci)-th second). Also note the cannon that you initially launched from will rotate every second but you obviously won\'t change direction while you are airborne. AaParsa wants to use the cannons for travelling between Shaazzzland\'s cities in his grand plan, and he can start travelling at second 0. For him to fully utilize them, he needs to know the minimum number of seconds required to reach city u from city v using the cannons for every pair of cities (u,v).Note that AaParsa can stay in a city for as long as he wants." "constructive algorithms,graphs,shortest paths" 2500
479A Expression "Petya studies in a school and he adores Maths. His class has been studying arithmetic expressions. On the last class the teacher wrote three positive integers a, b, c on the blackboard. The task was to insert signs of operations \'+\' and \'*\', and probably brackets between the numbers so that the value of the resulting expression is as large as possible. Let\'s consider an example: assume that the teacher wrote numbers 1, 2 and 3 on the blackboard. Here are some ways of placing signs and brackets:  1+2*3=7  1*(2+3)=5  1*2*3=6  (1+2)*3=9 Note that you can insert operation signs only between a and b, and between b and c, that is, you cannot swap integers. For instance, in the given sample you cannot get expression (1+3)*2.It\'s easy to see that the maximum value that you can obtain is 9.Your task is: given a, b and c print the maximum value that you can get." "brute force,math" 1000
1884C "Medium Design" "The array a1,a2,\xe2\x80\xa6,am is initially filled with zeroes. You are given n pairwise distinct segments 1\xe2\x89\xa4li\xe2\x89\xa4ri\xe2\x89\xa4m. You have to select an arbitrary subset of these segments (in particular, you may select an empty set). Next, you do the following:  For each i=1,2,\xe2\x80\xa6,n, if the segment (li,ri) has been selected to the subset, then for each index li\xe2\x89\xa4j\xe2\x89\xa4ri you increase aj by 1 (i. e. aj is replaced by aj+1). If the segment (li,ri) has not been selected, the array does not change.  Next (after processing all values of i=1,2,\xe2\x80\xa6,n), you compute max(a) as the maximum value among all elements of a. Analogously, compute min(a) as the minimum value.  Finally, the cost of the selected subset of segments is declared as max(a)\xe2\x88\x92min(a).Please, find the maximum cost among all subsets of segments." "brute force,data structures,dp,greedy,sortings" 1700
313C "Ilya and Matrix" "Ilya is a very good-natured lion. He likes maths. Of all mathematical objects, his favourite one is matrices. Now he\'s faced a complicated matrix problem he needs to solve.He\'s got a square 2n\xe2\x80\x89\xc3\x97\xe2\x80\x892n-sized matrix and 4n integers. You need to arrange all these numbers in the matrix (put each number in a single individual cell) so that the beauty of the resulting matrix with numbers is maximum.The beauty of a 2n\xe2\x80\x89\xc3\x97\xe2\x80\x892n-sized matrix is an integer, obtained by the following algorithm:  Find the maximum element in the matrix. Let\'s denote it as m.  If n\xe2\x80\x89=\xe2\x80\x890, then the beauty of the matrix equals m. Otherwise, a matrix can be split into 4 non-intersecting 2n\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89\xc3\x97\xe2\x80\x892n\xe2\x80\x89-\xe2\x80\x891-sized submatrices, then the beauty of the matrix equals the sum of number m and other four beauties of the described submatrices. As you can see, the algorithm is recursive.Help Ilya, solve the problem and print the resulting maximum beauty of the matrix." "constructive algorithms,greedy,implementation,sortings" 1400
719B "Anatoly and Cockroaches" "Anatoly lives in the university dorm as many other students do. As you know, cockroaches are also living there together with students. Cockroaches might be of two colors: black and red. There are n cockroaches living in Anatoly\'s room.Anatoly just made all his cockroaches to form a single line. As he is a perfectionist, he would like the colors of cockroaches in the line to alternate. He has a can of black paint and a can of red paint. In one turn he can either swap any two cockroaches, or take any single cockroach and change it\'s color.Help Anatoly find out the minimum number of turns he needs to make the colors of cockroaches in the line alternate." greedy 1400
1819B "The Butcher" "Anton plays his favorite game ""Defense of The Ancients 2"" for his favorite hero \xe2\x80\x94 The Butcher. Now he wants to make his own dinner. To do this he will take a rectangle of height h and width w, then make a vertical or horizontal cut so that both resulting parts have integer sides. After that, he will put one of the parts in the box and cut the other again, and so on.More formally, a rectangle of size h\xc3\x97w can be cut into two parts of sizes x\xc3\x97w and (h\xe2\x88\x92x)\xc3\x97w, where x is an integer from 1 to (h\xe2\x88\x921), or into two parts of sizes h\xc3\x97y and h\xc3\x97(w\xe2\x88\x92y), where y is an integer from 1 to (w\xe2\x88\x921).He will repeat this operation n\xe2\x88\x921 times, and then put the remaining rectangle into the box too. Thus, the box will contain n rectangles, of which n\xe2\x88\x921 rectangles were put in the box as a result of the cuts, and the n-th rectangle is the one that the Butcher has left after all n\xe2\x88\x921 cuts.Unfortunately, Butcher forgot the numbers h and w, but he still has n rectangles mixed in random order. Note that Butcher didn\'t rotate the rectangles, but only shuffled them. Now he wants to know all possible pairs (h,w) from which this set of rectangles can be obtained. And you have to help him do it!It is guaranteed that there exists at least one pair (h,w) from which this set of rectangles can be obtained." "geometry,greedy,implementation,sortings,two pointers" 1900
1189B "Number Circle" "You are given n numbers a1,a2,\xe2\x80\xa6,an. Is it possible to arrange them in a circle in such a way that every number is strictly less than the sum of its neighbors?For example, for the array [1,4,5,6,7,8], the arrangement on the left is valid, while arrangement on the right is not, as 5\xe2\x89\xa54+1 and 8>1+6." greedy,math,sortings 1100
1870E "Another MEX Problem" "You are given an array of integers a of size n. You can choose a set of non-overlapping subarrays of the given array (note that some elements may be not included in any subarray, this is allowed). For each selected subarray, calculate the MEX of its elements, and then calculate the bitwise XOR of all the obtained MEX values. What is the maximum bitwise XOR that can be obtained?The MEX (minimum excluded) of an array is the smallest non-negative integer that does not belong to the array. For instance:   The MEX of [2,2,1] is 0, because 0 does not belong to the array.  The MEX of [3,1,0,1] is 2, because 0 and 1 belong to the array, but 2 does not.  The MEX of [0,3,1,2] is 4, because 0, 1, 2 and 3 belong to the array, but 4 does not." "bitmasks,brute force,dp,shortest paths" 2300
1132B Discounts "You came to a local shop and want to buy some chocolate bars. There are n bars in the shop, i-th of them costs ai coins (and you want to buy all of them).You have m different coupons that allow you to buy chocolate bars. i-th coupon allows you to buy qi chocolate bars while you have to pay only for the qi\xe2\x88\x921 most expensive ones (so, the cheapest bar of those qi bars is for free).You can use only one coupon; if you use coupon i, you have to choose qi bars and buy them using the coupon, and buy all the remaining n\xe2\x88\x92qi bars without any discounts.To decide which coupon to choose, you want to know what will be the minimum total amount of money you have to pay if you use one of the coupons optimally." greedy,sortings 900
1482C "Basic Diplomacy" "Aleksey has n friends. He is also on a vacation right now, so he has m days to play this new viral cooperative game! But since it\'s cooperative, Aleksey will need one teammate in each of these m days.On each of these days some friends will be available for playing, and all others will not. On each day Aleksey must choose one of his available friends to offer him playing the game (and they, of course, always agree). However, if any of them happens to be chosen strictly more than \xe2\x8c\x88m2\xe2\x8c\x89 times, then all other friends are offended. Of course, Aleksey doesn\'t want to offend anyone.Help him to choose teammates so that nobody is chosen strictly more than \xe2\x8c\x88m2\xe2\x8c\x89 times." "brute force,constructive algorithms,greedy,implementation" 1600
1886A "Sum of Three" "Monocarp has an integer n.He wants to represent his number as a sum of three distinct positive integers x, y, and z. Additionally, Monocarp wants none of the numbers x, y, and z to be divisible by 3.Your task is to help Monocarp to find any valid triplet of distinct positive integers x, y, and z, or report that such a triplet does not exist." "brute force,constructive algorithms,math" 800
1609D "Social Network" "William arrived at a conference dedicated to cryptocurrencies. Networking, meeting new people, and using friends\' connections are essential to stay up to date with the latest news from the world of cryptocurrencies.The conference has n participants, who are initially unfamiliar with each other. William can introduce any two people, a and b, who were not familiar before, to each other. William has d conditions, i\'th of which requires person xi to have a connection to person yi. Formally, two people x and y have a connection if there is such a chain p1=x,p2,p3,\xe2\x80\xa6,pk=y for which for all i from 1 to k\xe2\x88\x921 it\'s true that two people with numbers pi and pi+1 know each other.For every i (1\xe2\x89\xa4i\xe2\x89\xa4d) William wants you to calculate the maximal number of acquaintances one person can have, assuming that William satisfied all conditions from 1 and up to and including i and performed exactly i introductions. The conditions are being checked after William performed i introductions. The answer for each i must be calculated independently. It means that when you compute an answer for i, you should assume that no two people have been introduced to each other yet." dsu,graphs,greedy,implementation,trees 1600
755C "PolandBall and Forest" "PolandBall lives in a forest with his family. There are some trees in the forest. Trees are undirected acyclic graphs with k vertices and k\xe2\x80\x89-\xe2\x80\x891 edges, where k is some integer. Note that one vertex is a valid tree.There is exactly one relative living in each vertex of each tree, they have unique ids from 1 to n. For each Ball i we know the id of its most distant relative living on the same tree. If there are several such vertices, we only know the value of the one with smallest id among those.How many trees are there in the forest?" "dfs and similar,dsu,graphs,interactive,trees" 1300
856A "Set Theory" "Masha and Grisha like studying sets of positive integers.One day Grisha has written a set A containing n different integers ai on a blackboard. Now he asks Masha to create a set B containing n different integers bj such that all n2 integers that can be obtained by summing up ai and bj for all possible pairs of i and j are different.Both Masha and Grisha don\'t like big numbers, so all numbers in A are from 1 to 106, and all numbers in B must also be in the same range.Help Masha to create the set B that satisfies Grisha\'s requirement." "brute force,constructive algorithms" 1600
1132D "Stressful Training" "Berland SU holds yet another training contest for its students today. n students came, each of them brought his laptop. However, it turned out that everyone has forgot their chargers!Let students be numbered from 1 to n. Laptop of the i-th student has charge ai at the beginning of the contest and it uses bi of charge per minute (i.e. if the laptop has c charge at the beginning of some minute, it becomes c\xe2\x88\x92bi charge at the beginning of the next minute). The whole contest lasts for k minutes.Polycarp (the coach of Berland SU) decided to buy a single charger so that all the students would be able to successfully finish the contest. He buys the charger at the same moment the contest starts.Polycarp can choose to buy the charger with any non-negative (zero or positive) integer power output. The power output is chosen before the purchase, it can\'t be changed afterwards. Let the chosen power output be x. At the beginning of each minute (from the minute contest starts to the last minute of the contest) he can plug the charger into any of the student\'s laptops and use it for some integer number of minutes. If the laptop is using bi charge per minute then it will become bi\xe2\x88\x92x per minute while the charger is plugged in. Negative power usage rate means that the laptop\'s charge is increasing. The charge of any laptop isn\'t limited, it can become infinitely large. The charger can be plugged in no more than one laptop at the same time.The student successfully finishes the contest if the charge of his laptop never is below zero at the beginning of some minute (from the minute contest starts to the last minute of the contest, zero charge is allowed). The charge of the laptop of the minute the contest ends doesn\'t matter.Help Polycarp to determine the minimal possible power output the charger should have so that all the students are able to successfully finish the contest. Also report if no such charger exists." "binary search,greedy" 2300
1167D "Bicolored RBS" "A string is called bracket sequence if it does not contain any characters other than ""("" and "")"". A bracket sequence is called regular (shortly, RBS) if it is possible to obtain correct arithmetic expression by inserting characters ""+"" and ""1"" into this sequence. For example, """", ""(())"" and ""()()"" are RBS and "")("" and ""(()"" are not.We can see that each opening bracket in RBS is paired with some closing bracket, and, using this fact, we can define nesting depth of the RBS as maximum number of bracket pairs, such that the 2-nd pair lies inside the 1-st one, the 3-rd one \xe2\x80\x94 inside the 2-nd one and so on. For example, nesting depth of """" is 0, ""()()()"" is 1 and ""()((())())"" is 3.Now, you are given RBS s of even length n. You should color each bracket of s into one of two colors: red or blue. Bracket sequence r, consisting only of red brackets, should be RBS, and bracket sequence, consisting only of blue brackets b, should be RBS. Any of them can be empty. You are not allowed to reorder characters in s, r or b. No brackets can be left uncolored.Among all possible variants you should choose one that minimizes maximum of r\'s and b\'s nesting depth. If there are multiple solutions you can print any of them." "constructive algorithms,greedy" 1500
1409E "Two Platforms" "There are n points on a plane. The i-th point has coordinates (xi,yi). You have two horizontal platforms, both of length k. Each platform can be placed anywhere on a plane but it should be placed horizontally (on the same y-coordinate) and have integer borders. If the left border of the platform is (x,y) then the right border is (x+k,y) and all points between borders (including borders) belong to the platform.Note that platforms can share common points (overlap) and it is not necessary to place both platforms on the same y-coordinate.When you place both platforms on a plane, all points start falling down decreasing their y-coordinate. If a point collides with some platform at some moment, the point stops and is saved. Points which never collide with any platform are lost.Your task is to find the maximum number of points you can save if you place both platforms optimally.You have to answer t independent test cases.For better understanding, please read the Note section below to see a picture for the first test case." "binary search,dp,sortings,two pointers" 1800
313A "Ilya and Bank Account" "Ilya is a very clever lion, he lives in an unusual city ZooVille. In this city all the animals have their rights and obligations. Moreover, they even have their own bank accounts. The state of a bank account is an integer. The state of a bank account can be a negative number. This means that the owner of the account owes the bank money.Ilya the Lion has recently had a birthday, so he got a lot of gifts. One of them (the gift of the main ZooVille bank) is the opportunity to delete the last digit or the digit before last from the state of his bank account no more than once. For example, if the state of Ilya\'s bank account is -123, then Ilya can delete the last digit and get his account balance equal to -12, also he can remove its digit before last and get the account balance equal to -13. Of course, Ilya is permitted not to use the opportunity to delete a digit from the balance.Ilya is not very good at math, and that\'s why he asks you to help him maximize his bank account. Find the maximum state of the bank account that can be obtained using the bank\'s gift." "implementation,number theory" 900
1904B "Collecting Game" "You are given an array a of n positive integers and a score. If your score is greater than or equal to ai, then you can increase your score by ai and remove ai from the array. For each index i, output the maximum number of additional array elements that you can remove if you remove ai and then set your score to ai. Note that the removal of ai should not be counted in the answer." "binary search,dp,greedy,sortings,two pointers" 1100
1850E "Cardboard for Pictures" "Mircea has n pictures. The i-th picture is a square with a side length of si centimeters. He mounted each picture on a square piece of cardboard so that each picture has a border of w centimeters of cardboard on all sides. In total, he used c square centimeters of cardboard. Given the picture sizes and the value c, can you find the value of w?  A picture of the first test case. Here c=50=52+42+32, so w=1 is the answer. Please note that the piece of cardboard goes behind each picture, not just the border." "binary search,geometry,implementation,math" 1100
1493C "K-beautiful Strings" "You are given a string s consisting of lowercase English letters and a number k. Let\'s call a string consisting of lowercase English letters beautiful if the number of occurrences of each letter in that string is divisible by k. You are asked to find the lexicographically smallest beautiful string of length n, which is lexicographically greater or equal to string s. If such a string does not exist, output \xe2\x88\x921.A string a is lexicographically smaller than a string b if and only if one of the following holds:   a is a prefix of b, but a\xe2\x89\xa0b;  in the first position where a and b differ, the string a has a letter that appears earlier in the alphabet than the corresponding letter in b." "binary search,brute force,constructive algorithms,greedy,strings" 2000
1838D "Bracket Walk" "There is a string s of length n consisting of the characters \'(\' and \')\'. You are walking on this string. You start by standing on top of the first character of s, and you want to make a sequence of moves such that you end on the n-th character. In one step, you can move one space to the left (if you are not standing on the first character), or one space to the right (if you are not standing on the last character). You may not stay in the same place, however you may visit any character, including the first and last character, any number of times.At each point in time, you write down the character you are currently standing on. We say the string is walkable if there exists some sequence of moves that take you from the first character to the last character, such that the string you write down is a regular bracket sequence.A regular bracket sequence is a bracket sequence that can be transformed into a correct arithmetic expression by inserting characters \'1\' and \'+\' between the original characters of the sequence. For example, bracket sequences ""()()"", ""(())"" are regular (the resulting expressions are: ""(1)+(1)"", ""((1+1)+1)""), and "")("" and ""("" are not.One possible valid walk on s=(())())). The red dot indicates your current position, and the red string indicates the string you have written down. Note that the red string is a regular bracket sequence at the end of the process.You are given q queries. Each query flips the value of a character from \'(\' to \')\' or vice versa. After each query, determine whether the string is walkable.Queries are cumulative, so the effects of each query carry on to future queries." "data structures,greedy,strings" 2100
318B "Strings of Power" "Volodya likes listening to heavy metal and (occasionally) reading. No wonder Volodya is especially interested in texts concerning his favourite music style.Volodya calls a string powerful if it starts with ""heavy"" and ends with ""metal"". Finding all powerful substrings (by substring Volodya means a subsequence of consecutive characters in a string) in a given text makes our hero especially joyful. Recently he felt an enormous fit of energy while reading a certain text. So Volodya decided to count all powerful substrings in this text and brag about it all day long. Help him in this difficult task. Two substrings are considered different if they appear at the different positions in the text.For simplicity, let us assume that Volodya\'s text can be represented as a single string." "implementation,strings,two pointers" 1300
276C "Little Girl and Maximum Sum" "The little girl loves the problems on array queries very much.One day she came across a rather well-known problem: you\'ve got an array of n elements (the elements of the array are indexed starting from 1); also, there are q queries, each one is defined by a pair of integers li, ri (1\xe2\x89\xa4li\xe2\x89\xa4ri\xe2\x89\xa4n). You need to find for each query the sum of elements of the array with indexes from li to ri, inclusive.The little girl found the problem rather boring. She decided to reorder the array elements before replying to the queries in a way that makes the sum of query replies maximum possible. Your task is to find the value of this maximum sum." "data structures,greedy,implementation,sortings" 1500
279B Books "When Valera has got some free time, he goes to the library to read some books. Today he\'s got t free minutes to read. That\'s why Valera took n books in the library and for each book he estimated the time he is going to need to read it. Let\'s number the books by integers from 1 to n. Valera needs ai minutes to read the i-th book.Valera decided to choose an arbitrary book with number i and read the books one by one, starting from this book. In other words, he will first read book number i, then book number i\xe2\x80\x89+\xe2\x80\x891, then book number i\xe2\x80\x89+\xe2\x80\x892 and so on. He continues the process until he either runs out of the free time or finishes reading the n-th book. Valera reads each book up to the end, that is, he doesn\'t start reading the book if he doesn\'t have enough free time to finish reading it. Print the maximum number of books Valera can read." "binary search,brute force,implementation,two pointers" 1400
1853A Desorting "Call an array a of length n sorted if a1\xe2\x89\xa4a2\xe2\x89\xa4\xe2\x80\xa6\xe2\x89\xa4an\xe2\x88\x921\xe2\x89\xa4an.Ntarsis has an array a of length n. He is allowed to perform one type of operation on it (zero or more times):   Choose an index i (1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921).  Add 1 to a1,a2,\xe2\x80\xa6,ai.  Subtract 1 from ai+1,ai+2,\xe2\x80\xa6,an. The values of a can be negative after an operation.Determine the minimum operations needed to make a not sorted." "brute force,greedy,math" 800
1539F "Strange Array" "Vasya has an array of n integers a1,a2,\xe2\x80\xa6,an. Vasya thinks that all numbers in his array are strange for some reason. To calculate how strange the i-th number is, Vasya created the following algorithm.He chooses a subsegment al,al+1,\xe2\x80\xa6,ar, such that 1\xe2\x89\xa4l\xe2\x89\xa4i\xe2\x89\xa4r\xe2\x89\xa4n, sort its elements in increasing order in his head (he can arrange equal elements arbitrary). After that he finds the center of the segment. The center of a segment is the element at position (l+r)/2, if the length of the segment is odd, and at position (l+r+1)/2 otherwise. Now Vasya finds the element that was at position i before the sorting, and calculates the distance between its current position and the center of the subsegment (the distance between the elements with indices j and k is |j\xe2\x88\x92k|).The strangeness of the number at position i is the maximum distance among all suitable choices of l and r. Vasya wants to calculate the strangeness of each number in his array. Help him to do it." "data structures,greedy,sortings" 2600
1485B "Replace and Keep Sorted" "Given a positive integer k, two arrays are called k-similar if:  they are strictly increasing;  they have the same length;  all their elements are positive integers between 1 and k (inclusive);  they differ in exactly one position. You are given an integer k, a strictly increasing array a and q queries. For each query, you are given two integers li\xe2\x89\xa4ri. Your task is to find how many arrays b exist, such that b is k-similar to array [ali,ali+1\xe2\x80\xa6,ari]." dp,implementation,math 1200
1733E Conveyor "There is a conveyor with 120 rows and 120 columns. Each row and column is numbered from 0 to 119, and the cell in i-th row and j-th column is denoted as (i,j). The top leftmost cell is (0,0). Each cell has a belt, and all belts are initially facing to the right.Initially, a slime ball is on the belt of (0,0), and other belts are empty. Every second, the state of the conveyor changes as follows:   All slime balls on the conveyor move one cell in the direction of the belt at the same time. If there is no cell in the moved position, the slime gets out of the conveyor, and if two slime balls move to the same cell, they merge into one.  All belts with slime ball in the previous second change direction at the same time: belts facing to the right become facing to the down, and vice versa.  A new slime ball is placed on cell (0,0). There are q queries, each being three integers t, x, and y. You have to find out if there is a slime at the cell (x,y) after t seconds from the start. Can you do it?" "constructive algorithms,dp,math" 2700
438D "The Child and Sequence" "At the children\'s day, the child came to Picks\'s house, and messed his house up. Picks was angry at him. A lot of important things were lost, in particular the favorite sequence of Picks.Fortunately, Picks remembers how to repair the sequence. Initially he should create an integer array a[1],\xe2\x80\x89a[2],\xe2\x80\x89...,\xe2\x80\x89a[n]. Then he should perform a sequence of m operations. An operation can be one of the following:  Print operation l,\xe2\x80\x89r. Picks should write down the value of .  Modulo operation l,\xe2\x80\x89r,\xe2\x80\x89x. Picks should perform assignment a[i]\xe2\x80\x89=\xe2\x80\x89a[i] mod x for each i (l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r).  Set operation k,\xe2\x80\x89x. Picks should set the value of a[k] to x (in other words perform an assignment a[k]\xe2\x80\x89=\xe2\x80\x89x). Can you help Picks to perform the whole sequence of operations?" "data structures,math" 2300
1218B "Guarding warehouses" "Bob Bubblestrong just got a new job as security guard. Bob is now responsible for safety of a collection of warehouses, each containing the most valuable Bubble Cup assets - the high-quality bubbles. His task is to detect thieves inside the warehouses and call the police.Looking from the sky, each warehouse has a shape of a convex polygon. Walls of no two warehouses intersect, and of course, none of the warehouses is built inside of another warehouse.Little did the Bubble Cup bosses know how lazy Bob is and that he enjoys watching soap operas (he heard they are full of bubbles) from the coziness of his office. Instead of going from one warehouse to another to check if warehouses are secured, the plan Bob has is to monitor all the warehouses from the comfort of his office using the special X-ray goggles. The goggles have an infinite range, so a thief in any of the warehouses could easily be spotted.However, the goggles promptly broke and the X-rays are now strong only enough to let Bob see through a single wall. Now, Bob would really appreciate if you could help him find out what is the total area inside of the warehouses monitored by the broken goggles, so that he could know how much area of the warehouses he needs to monitor in person." "data structures,geometry" 3000
48A Rock-paper-scissors "Uncle Fyodor, Matroskin the Cat and Sharic the Dog live their simple but happy lives in Prostokvashino. Sometimes they receive parcels from Uncle Fyodor\xe2\x80\x99s parents and sometimes from anonymous benefactors, in which case it is hard to determine to which one of them the package has been sent. A photographic rifle is obviously for Sharic who loves hunting and fish is for Matroskin, but for whom was a new video game console meant? Every one of the three friends claimed that the present is for him and nearly quarreled. Uncle Fyodor had an idea how to solve the problem justly: they should suppose that the console was sent to all three of them and play it in turns. Everybody got relieved but then yet another burning problem popped up \xe2\x80\x94 who will play first? This time Matroskin came up with a brilliant solution, suggesting the most fair way to find it out: play rock-paper-scissors together. The rules of the game are very simple. On the count of three every player shows a combination with his hand (or paw). The combination corresponds to one of three things: a rock, scissors or paper. Some of the gestures win over some other ones according to well-known rules: the rock breaks the scissors, the scissors cut the paper, and the paper gets wrapped over the stone. Usually there are two players. Yet there are three friends, that\xe2\x80\x99s why they decided to choose the winner like that: If someone shows the gesture that wins over the other two players, then that player wins. Otherwise, another game round is required. Write a program that will determine the winner by the gestures they have shown." implementation,schedules 900
895B "XK Segments" "While Vasya finished eating his piece of pizza, the lesson has already started. For being late for the lesson, the teacher suggested Vasya to solve one interesting problem. Vasya has an array a and integer x. He should find the number of different ordered pairs of indexes (i,\xe2\x80\x89j) such that ai\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89aj and there are exactly k integers y such that ai\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89aj and y is divisible by x.In this problem it is meant that pair (i,\xe2\x80\x89j) is equal to (j,\xe2\x80\x89i) only if i is equal to j. For example pair (1,\xe2\x80\x892) is not the same as (2,\xe2\x80\x891)." "binary search,math,sortings,two pointers" 1700
1663H "Cross-Language Program" "Write a program that is compilable simultaneously in two languages: C++ (GCC 10.3.1, -std=c++11) and FreePascal (3.0.4).It absolutely does not matter what this program does, the only requirement is that it successfully compiles into an executable file in both C++ and Pascal.Please use the language Text to submit your solution. Just choose Text as a language in the submission form.The submitted file can\'t exceed 2048 bytes. It should compile fast on both compilers." "*special problem,constructive algorithms" -999
1482G Vabank "Gustaw is the chief bank manager in a huge bank. He has unlimited access to the database system of the bank, in a few clicks he can move any amount of money from the bank\'s reserves to his own private account. However, the bank uses some fancy AI fraud detection system that makes stealing more difficult.Gustaw knows that the anti-fraud system just detects any operation that exceeds some fixed limit M euros and these operations are checked manually by a number of clerks. Thus, any fraud operation exceeding this limit is detected, while any smaller operation gets unnoticed.Gustaw doesn\'t know the limit M and wants to find it out. In one operation, he can choose some integer X and try to move X euros from the bank\'s reserves to his own account. Then, the following happens.   If X\xe2\x89\xa4M, the operation is unnoticed and Gustaw\'s account balance raises by X euros.  Otherwise, if X>M, the fraud is detected and cancelled. Moreover, Gustaw has to pay X euros from his own account as a fine. If he has less than X euros on the account, he is fired and taken to the police. Initially Gustaw has 1 euro on his account. Help him find the exact value of M in no more than 105 operations without getting him fired." "binary search,interactive" 3200
295A "Greg and Array" "Greg has an array a\xe2\x80\x89=\xe2\x80\x89a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an and m operations. Each operation looks as: li, ri, di, (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89li\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ri\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n). To apply operation i to the array means to increase all array elements with numbers li,\xe2\x80\x89li\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89ri by value di.Greg wrote down k queries on a piece of paper. Each query has the following form: xi, yi, (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89xi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89yi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m). That means that one should apply operations with numbers xi,\xe2\x80\x89xi\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89yi to the array.Now Greg is wondering, what the array a will be after all the queries are executed. Help Greg." "data structures,implementation" 1400
1991A "Maximize the Last Element" "You are given an array a of n integers, where n is odd.In one operation, you will remove two adjacent elements from the array a, and then concatenate the remaining parts of the array. For example, given the array [4,7,4,2,9], we can obtain the arrays [4,2,9] and [4,7,9] by the operations [4,7_,4,2,9]\xe2\x86\x92[4,2,9] and [4,7,4,2_,9]\xe2\x86\x92[4,7,9] respectively. However, we cannot obtain the array [7,2,9] as it requires deleting non-adjacent elements [4_,7,4_,2,9].You will repeatedly perform this operation until exactly one element remains in a.Find the maximum possible value of the remaining element in a." greedy,implementation 800
2006F "Dora\'s Paint" "Sadly, Dora poured the paint when painting the class mural. Dora considers the mural as the matrix b of size n\xc3\x97n. Initially, bi,j=0 for all 1\xe2\x89\xa4i,j\xe2\x89\xa4n.Dora has only two brushes which have two different colors. In one operation, she can paint the matrix with one of two brushes:  The first brush has color 1 on it and can paint one column of the matrix. That is, Dora chooses 1\xe2\x89\xa4j\xe2\x89\xa4n and makes bi,j:=1 for all 1\xe2\x89\xa4i\xe2\x89\xa4n;  The second brush has color 2 on it and can paint one row of the matrix. That is, Dora chooses 1\xe2\x89\xa4i\xe2\x89\xa4n and makes bi,j:=2 for all 1\xe2\x89\xa4j\xe2\x89\xa4n. Dora paints the matrix so that the resulting matrix b contains only 1 and 2.For a matrix b, let f(b) denote the minimum number of operations needed to turn the initial matrix (containing only 0) into b. The beauty of a matrix b is the number of ways to paint the initial matrix in exactly f(b) operations to turn it into b. If there\'s no way to turn the initial matrix into b, the beauty of b is 0.However, Dora made a uniformly random mistake; there\'s exactly one element different in the matrix a given to you from the real matrix b. That is, there is exactly one pair (i,j) such that ai,j=3\xe2\x88\x92bi,j.Please help Dora compute the expected beauty of the real matrix b modulo 998244353 (all possible n2 mistakes have equal probability).Since the size of the matrix is too large, Dora will only tell you the positions of m elements of color 1, and the remaining n2\xe2\x88\x92m elements have color 2." "brute force,combinatorics,constructive algorithms,graphs,implementation" 3500
1272F "Two Bracket Sequences" "You are given two bracket sequences (not necessarily regular) s and t consisting only of characters \'(\' and \')\'. You want to construct the shortest regular bracket sequence that contains both given bracket sequences as subsequences (not necessarily contiguous).Recall what is the regular bracket sequence:  () is the regular bracket sequence;  if S is the regular bracket sequence, then (S) is a regular bracket sequence;  if S and T regular bracket sequences, then ST (concatenation of S and T) is a regular bracket sequence. Recall that the subsequence of the string s is such string t that can be obtained from s by removing some (possibly, zero) amount of characters. For example, ""coder"", ""force"", ""cf"" and ""cores"" are subsequences of ""codeforces"", but ""fed"" and ""z"" are not." "dp,strings,two pointers" 2200
958E1 "Guard Duty (easy)" "The Rebel fleet is afraid that the Empire might want to strike back again. Princess Heidi needs to know if it is possible to assign R Rebel spaceships to guard B bases so that every base has exactly one guardian and each spaceship has exactly one assigned base (in other words, the assignment is a perfect matching). Since she knows how reckless her pilots are, she wants to be sure that any two (straight) paths \xe2\x80\x93 from a base to its assigned spaceship \xe2\x80\x93 do not intersect in the galaxy plane (that is, in 2D), and so there is no risk of collision." "brute force,geometry,greedy,math" 1600
1598G "The Sum of Good Numbers" "Let\'s call a positive integer good if there is no digit 0 in its decimal representation.For an array of a good numbers a, one found out that the sum of some two neighboring elements is equal to x (i.e. x=ai+ai+1 for some i). x had turned out to be a good number as well.Then the elements of the array a were written out one after another without separators into one string s. For example, if a=[12,5,6,133], then s=1256133.You are given a string s and a number x. Your task is to determine the positions in the string that correspond to the adjacent elements of the array that have sum x. If there are several possible answers, you can print any of them." "hashing,math,string suffix structures,strings" 3200
833A "The Meaningless Game" "Slastyona and her loyal dog Pushok are playing a meaningless game that is indeed very interesting.The game consists of multiple rounds. Its rules are very simple: in each round, a natural number k is chosen. Then, the one who says (or barks) it faster than the other wins the round. After that, the winner\'s score is multiplied by k2, and the loser\'s score is multiplied by k. In the beginning of the game, both Slastyona and Pushok have scores equal to one.Unfortunately, Slastyona had lost her notepad where the history of all n games was recorded. She managed to recall the final results for each games, though, but all of her memories of them are vague. Help Slastyona verify their correctness, or, to put it another way, for each given pair of scores determine whether it was possible for a game to finish with such result or not." "math,number theory" 1700
297D "Color the Carpet" "Even polar bears feel cold when lying on the ice. Therefore, a polar bear Alice is going to make a carpet. The carpet can be viewed as a grid with height h and width w. Then the grid is divided into h\xe2\x80\x89\xc3\x97\xe2\x80\x89w squares. Alice is going to assign one of k different colors to each square. The colors are numbered from 1 to k. She may choose not to use all of the colors.However, there are some restrictions. For every two adjacent squares (squares that shares an edge) x and y, there is a color constraint in one of the forms:   color(x)\xe2\x80\x89=\xe2\x80\x89color(y), or  color(x)\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89color(y). Example of the color constraints:  Ideally, Alice wants to satisfy all color constraints. But again, life in the Arctic is hard. It is not always possible to satisfy all color constraints. Fortunately, she will still be happy if at least  of the color constraints are satisfied. If she has 4 colors she can color the carpet in the following way:  And she is happy because  of the color constraints are satisfied, and . Your task is to help her color the carpet." "constructive algorithms" 2500
112A "Petya and Strings" "Little Petya loves presents. His mum bought him two strings of the same size for his birthday. The strings consist of uppercase and lowercase Latin letters. Now Petya wants to compare those two strings lexicographically. The letters\' case does not matter, that is an uppercase letter is considered equivalent to the corresponding lowercase letter. Help Petya perform the comparison." implementation,strings 800
1237E "Balanced Binary Search Trees" "Recall that a binary search tree is a rooted binary tree, whose nodes each store a key and each have at most two distinguished subtrees, left and right. The key in each node must be greater than any key stored in the left subtree, and less than any key stored in the right subtree.The depth of a vertex is the number of edges on the simple path from the vertex to the root. In particular, the depth of the root is 0.Let\'s call a binary search tree perfectly balanced if there doesn\'t exist a binary search tree with the same number of vertices that has a strictly smaller sum of depths of its vertices.Let\'s call a binary search tree with integer keys striped if both of the following conditions are satisfied for every vertex v:   If v has a left subtree whose root is u, then the parity of the key of v is different from the parity of the key of u.  If v has a right subtree whose root is w, then the parity of the key of v is the same as the parity of the key of w. You are given a single integer n. Find the number of perfectly balanced striped binary search trees with n vertices that have distinct integer keys between 1 and n, inclusive. Output this number modulo 998244353." dp,math 2400
1335B "Construct the String" "You are given three positive integers n, a and b. You have to construct a string s of length n consisting of lowercase Latin letters such that each substring of length a has exactly b distinct letters. It is guaranteed that the answer exists.You have to answer t independent test cases.Recall that the substring s[l\xe2\x80\xa6r] is the string sl,sl+1,\xe2\x80\xa6,sr and its length is r\xe2\x88\x92l+1. In this problem you are only interested in substrings of length a." "constructive algorithms" 900
2004B "Game with Doors" "There are 100 rooms arranged in a row and 99 doors between them; the i-th door connects rooms i and i+1. Each door can be either locked or unlocked. Initially, all doors are unlocked.We say that room x is reachable from room y if all doors between them are unlocked.You know that:   Alice is in some room from the segment [l,r];  Bob is in some room from the segment [L,R];  Alice and Bob are in different rooms. However, you don\'t know the exact rooms they are in.You don\'t want Alice and Bob to be able to reach each other, so you are going to lock some doors to prevent that. What\'s the smallest number of doors you have to lock so that Alice and Bob cannot meet, regardless of their starting positions inside the given segments?" "brute force,greedy" 1000
909A "Generate Login" "The preferred way to generate user login in Polygon is to concatenate a prefix of the user\'s first name and a prefix of their last name, in that order. Each prefix must be non-empty, and any of the prefixes can be the full name. Typically there are multiple possible logins for each person.You are given the first and the last name of a user. Return the alphabetically earliest login they can get (regardless of other potential Polygon users).As a reminder, a prefix of a string s is its substring which occurs at the beginning of s: ""a"", ""ab"", ""abc"" etc. are prefixes of string ""{abcdef}"" but ""b"" and \'bc"" are not. A string a is alphabetically earlier than a string b, if a is a prefix of b, or a and b coincide up to some position, and then a has a letter that is alphabetically earlier than the corresponding letter in b: ""a"" and ""ab"" are alphabetically earlier than ""ac"" but ""b"" and ""ba"" are alphabetically later than ""ac""." "brute force,greedy,sortings" 1000
1140C Playlist "You have a playlist consisting of n songs. The i-th song is characterized by two numbers ti and bi \xe2\x80\x94 its length and beauty respectively. The pleasure of listening to set of songs is equal to the total length of the songs in the set multiplied by the minimum beauty among them. For example, the pleasure of listening to a set of 3 songs having lengths [5,7,4] and beauty values [11,14,6] is equal to (5+7+4)\xe2\x8b\x856=96.You need to choose at most k songs from your playlist, so the pleasure of listening to the set of these songs them is maximum possible." "brute force,data structures,sortings" 1600
1195D2 "Submarine in the Rybinsk Sea (hard edition)" "This problem differs from the previous one only in the absence of the constraint on the equal length of all numbers a1,a2,\xe2\x80\xa6,an.A team of SIS students is going to make a trip on a submarine. Their target is an ancient treasure in a sunken ship lying on the bottom of the Great Rybinsk sea. Unfortunately, the students don\'t know the coordinates of the ship, so they asked Meshanya (who is a hereditary mage) to help them. He agreed to help them, but only if they solve his problem.Let\'s denote a function that alternates digits of two numbers f(a1a2\xe2\x80\xa6ap\xe2\x88\x921ap,b1b2\xe2\x80\xa6bq\xe2\x88\x921bq), where a1\xe2\x80\xa6ap and b1\xe2\x80\xa6bq are digits of two integers written in the decimal notation without leading zeros.In other words, the function f(x,y) alternately shuffles the digits of the numbers x and y by writing them from the lowest digits to the older ones, starting with the number y. The result of the function is also built from right to left (that is, from the lower digits to the older ones). If the digits of one of the arguments have ended, then the remaining digits of the other argument are written out. Familiarize with examples and formal definitions of the function below.For example: f(1111,2222)=12121212 f(7777,888)=7787878 f(33,44444)=4443434 f(555,6)=5556 f(111,2222)=2121212Formally,  if p\xe2\x89\xa5q then f(a1\xe2\x80\xa6ap,b1\xe2\x80\xa6bq)=a1a2\xe2\x80\xa6ap\xe2\x88\x92q+1b1ap\xe2\x88\x92q+2b2\xe2\x80\xa6ap\xe2\x88\x921bq\xe2\x88\x921apbq;  if p<q then f(a1\xe2\x80\xa6ap,b1\xe2\x80\xa6bq)=b1b2\xe2\x80\xa6bq\xe2\x88\x92pa1bq\xe2\x88\x92p+1a2\xe2\x80\xa6ap\xe2\x88\x921bq\xe2\x88\x921apbq. Mishanya gives you an array consisting of n integers ai, your task is to help students to calculate \xe2\x88\x91ni=1\xe2\x88\x91nj=1f(ai,aj) modulo 998244353." "combinatorics,math,number theory" 1800
150A "Win or Freeze" "You can\'t possibly imagine how cold our friends are this winter in Nvodsk! Two of them play the following game to warm up: initially a piece of paper has an integer q. During a move a player should write any integer number that is a non-trivial divisor of the last written number. Then he should run this number of circles around the hotel. Let us remind you that a number\'s divisor is called non-trivial if it is different from one and from the divided number itself. The first person who can\'t make a move wins as he continues to lie in his warm bed under three blankets while the other one keeps running. Determine which player wins considering that both players play optimally. If the first player wins, print any winning first move." "games,math,number theory" 1400
95D "Horse Races" "Petya likes horse racing very much. Horses numbered from l to r take part in the races. Petya wants to evaluate the probability of victory; for some reason, to do that he needs to know the amount of nearly lucky horses\' numbers. A nearly lucky number is an integer number that has at least two lucky digits the distance between which does not exceed k. Petya learned from some of his mates from Lviv that lucky digits are digits 4 and 7. The distance between the digits is the absolute difference between their positions in the number of a horse. For example, if k\xe2\x80\x89=\xe2\x80\x892, then numbers 412395497, 404, 4070400000070004007 are nearly lucky and numbers 4, 4123954997, 4007000040070004007 are not.Petya prepared t intervals [li,\xe2\x80\x89ri] and invented number k, common for all of them. Your task is to find how many nearly happy numbers there are in each of these segments. Since the answers can be quite large, output them modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." dp,math 2500
222E "Decoding Genome" "Recently a top secret mission to Mars has taken place. As a result, scientists managed to obtain some information about the Martian DNA. Now we know that any Martian DNA contains at most m different nucleotides, numbered from 1 to m. Special characteristics of the Martian DNA prevent some nucleotide pairs from following consecutively in this chain. For example, if the nucleotide 1 and nucleotide 2 can not follow consecutively in the Martian DNA, then the chain of nucleotides [1, 2] is not a valid chain of Martian DNA, but the chain of nucleotides [2, 1] can be a valid chain (if there is no corresponding restriction). The number of nucleotide pairs that can\'t follow in the DNA chain consecutively, is k. The needs of gene research required information about the quantity of correct n-long chains of the Martian DNA. Your task is to write a program that will calculate this value." dp,matrices 1900
1986A "X Axis" "You are given three points with integer coordinates x1, x2, and x3 on the X axis (1\xe2\x89\xa4xi\xe2\x89\xa410). You can choose any point with an integer coordinate a on the X axis. Note that the point a may coincide with x1, x2, or x3. Let f(a) be the total distance from the given points to the point a. Find the smallest value of f(a).The distance between points a and b is equal to |a\xe2\x88\x92b|. For example, the distance between points a=5 and b=2 is 3." "brute force,geometry,math,sortings" 800
1512F Education "Polycarp is wondering about buying a new computer, which costs c tugriks. To do this, he wants to get a job as a programmer in a big company.There are n positions in Polycarp\'s company, numbered starting from one. An employee in position i earns a[i] tugriks every day. The higher the position number, the more tugriks the employee receives. Initially, Polycarp gets a position with the number 1 and has 0 tugriks.Each day Polycarp can do one of two things:   If Polycarp is in the position of x, then he can earn a[x] tugriks.  If Polycarp is in the position of x (x<n) and has at least b[x] tugriks, then he can spend b[x] tugriks on an online course and move to the position x+1. For example, if n=4, c=15, a=[1,3,10,11], b=[1,2,7], then Polycarp can act like this:   On the first day, Polycarp is in the 1-st position and earns 1 tugrik. Now he has 1 tugrik;  On the second day, Polycarp is in the 1-st position and move to the 2-nd position. Now he has 0 tugriks;  On the third day, Polycarp is in the 2-nd position and earns 3 tugriks. Now he has 3 tugriks;  On the fourth day, Polycarp is in the 2-nd position and is transferred to the 3-rd position. Now he has 1 tugriks;  On the fifth day, Polycarp is in the 3-rd position and earns 10 tugriks. Now he has 11 tugriks;  On the sixth day, Polycarp is in the 3-rd position and earns 10 tugriks. Now he has 21 tugriks;  Six days later, Polycarp can buy himself a new computer. Find the minimum number of days after which Polycarp will be able to buy himself a new computer." "brute force,dp,greedy,implementation" 1900
104A Blackjack "One rainy gloomy evening when all modules hid in the nearby cafes to drink hot energetic cocktails, the Hexadecimal virus decided to fly over the Mainframe to look for a Great Idea. And she has found one!Why not make her own Codeforces, with blackjack and other really cool stuff? Many people will surely be willing to visit this splendid shrine of high culture.In Mainframe a standard pack of 52 cards is used to play blackjack. The pack contains cards of 13 values: 2, 3, 4, 5, 6, 7, 8, 9, 10, jacks, queens, kings and aces. Each value also exists in one of four suits: hearts, diamonds, clubs and spades. Also, each card earns some value in points assigned to it: cards with value from two to ten earn from 2 to 10 points, correspondingly. An ace can either earn 1 or 11, whatever the player wishes. The picture cards (king, queen and jack) earn 10 points. The number of points a card earns does not depend on the suit. The rules of the game are very simple. The player gets two cards, if the sum of points of those cards equals n, then the player wins, otherwise the player loses.The player has already got the first card, it\'s the queen of spades. To evaluate chances for victory, you should determine how many ways there are to get the second card so that the sum of points exactly equals n." implementation 800
607D "Power Tree" "Genos and Saitama went shopping for Christmas trees. However, a different type of tree caught their attention, the exalted Power Tree. A Power Tree starts out as a single root vertex indexed 1. A Power Tree grows through a magical phenomenon known as an update. In an update, a single vertex is added to the tree as a child of some other vertex.Every vertex in the tree (the root and all the added vertices) has some value vi associated with it. The power of a vertex is defined as the strength of the multiset composed of the value associated with this vertex (vi) and the powers of its direct children. The strength of a multiset is defined as the sum of all elements in the multiset multiplied by the number of elements in it. Or in other words for some multiset S: Saitama knows the updates that will be performed on the tree, so he decided to test Genos by asking him queries about the tree during its growth cycle.An update is of the form 1 p v, and adds a new vertex with value v as a child of vertex p.A query is of the form 2 u, and asks for the power of vertex u.Please help Genos respond to these queries modulo 109\xe2\x80\x89+\xe2\x80\x897." "data structures,trees" 2600
1208D "Restore Permutation" "An array of integers p1,p2,\xe2\x80\xa6,pn is called a permutation if it contains each number from 1 to n exactly once. For example, the following arrays are permutations: [3,1,2],[1],[1,2,3,4,5] and [4,3,1,2]. The following arrays are not permutations: [2],[1,1],[2,3,4].There is a hidden permutation of length n.For each index i, you are given si, which equals to the sum of all pj such that j<i and pj<pi. In other words, si is the sum of elements before the i-th element that are smaller than the i-th element.Your task is to restore the permutation." "binary search,data structures,greedy,implementation" 1900
513E2 "Subarray Cuts" "You are given an array of length n and a number k. Let\'s pick k non-overlapping non-empty subarrays of the initial array. Let si be the sum of the i-th subarray in order from left to right. Compute the maximum value of the following expression: |s1\xe2\x80\x89-\xe2\x80\x89s2|\xe2\x80\x89+\xe2\x80\x89|s2\xe2\x80\x89-\xe2\x80\x89s3|\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89|sk\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89-\xe2\x80\x89sk|Here subarray is a contiguous part of an array." dp 2700
1550C "Manhattan Subarrays" "Suppose you have two points p=(xp,yp) and q=(xq,yq). Let\'s denote the Manhattan distance between them as d(p,q)=|xp\xe2\x88\x92xq|+|yp\xe2\x88\x92yq|.Let\'s say that three points p, q, r form a bad triple if d(p,r)=d(p,q)+d(q,r).Let\'s say that an array b1,b2,\xe2\x80\xa6,bm is good if it is impossible to choose three distinct indices i, j, k such that the points (bi,i), (bj,j) and (bk,k) form a bad triple.You are given an array a1,a2,\xe2\x80\xa6,an. Calculate the number of good subarrays of a. A subarray of the array a is the array al,al+1,\xe2\x80\xa6,ar for some 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n.Note that, according to the definition, subarrays of length 1 and 2 are good." "brute force,geometry,greedy,implementation" 1700
1654F "Minimal String Xoration" "You are given an integer n and a string s consisting of 2n lowercase letters of the English alphabet. The characters of the string s are s0s1s2\xe2\x8b\xafs2n\xe2\x88\x921.A string t of length 2n (whose characters are denoted by t0t1t2\xe2\x8b\xaft2n\xe2\x88\x921) is a xoration of s if there exists an integer j (0\xe2\x89\xa4j\xe2\x89\xa42n\xe2\x88\x921) such that, for each 0\xe2\x89\xa4i\xe2\x89\xa42n\xe2\x88\x921, ti=si\xe2\x8a\x95j (where \xe2\x8a\x95 denotes the operation bitwise XOR).Find the lexicographically minimal xoration of s.A string a is lexicographically smaller than a string b if and only if one of the following holds:   a is a prefix of b, but a\xe2\x89\xa0b;  in the first position where a and b differ, the string a has a letter that appears earlier in the alphabet than the corresponding letter in b." "bitmasks,data structures,divide and conquer,greedy,hashing,sortings,strings" 2800
1442A "Extreme Subtraction" "You are given an array a of n positive integers.You can use the following operation as many times as you like: select any integer 1\xe2\x89\xa4k\xe2\x89\xa4n and do one of two things:   decrement by one k of the first elements of the array.  decrement by one k of the last elements of the array. For example, if n=5 and a=[3,2,2,1,4], then you can apply one of the following operations to it (not all possible options are listed below):   decrement from the first two elements of the array. After this operation a=[2,1,2,1,4];  decrement from the last three elements of the array. After this operation a=[3,2,1,0,3];  decrement from the first five elements of the array. After this operation a=[2,1,1,0,3]; Determine if it is possible to make all the elements of the array equal to zero by applying a certain number of operations." "constructive algorithms,dp,greedy" 1800
526A "King of Thieves" "In this problem you will meet the simplified model of game King of Thieves.In a new ZeptoLab game called ""King of Thieves"" your aim is to reach a chest with gold by controlling your character, avoiding traps and obstacles on your way.  An interesting feature of the game is that you can design your own levels that will be available to other players. Let\'s consider the following simple design of a level.A dungeon consists of n segments located at a same vertical level, each segment is either a platform that character can stand on, or a pit with a trap that makes player lose if he falls into it. All segments have the same length, platforms on the scheme of the level are represented as \'*\' and pits are represented as \'.\'. One of things that affects speedrun characteristics of the level is a possibility to perform a series of consecutive jumps of the same length. More formally, when the character is on the platform number i1, he can make a sequence of jumps through the platforms i1\xe2\x80\x89<\xe2\x80\x89i2\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89ik, if i2\xe2\x80\x89-\xe2\x80\x89i1\xe2\x80\x89=\xe2\x80\x89i3\xe2\x80\x89-\xe2\x80\x89i2\xe2\x80\x89=\xe2\x80\x89...\xe2\x80\x89=\xe2\x80\x89ik\xe2\x80\x89-\xe2\x80\x89ik\xe2\x80\x89-\xe2\x80\x891. Of course, all segments i1,\xe2\x80\x89i2,\xe2\x80\x89... ik should be exactly the platforms, not pits. Let\'s call a level to be good if you can perform a sequence of four jumps of the same length or in the other words there must be a sequence i1,\xe2\x80\x89i2,\xe2\x80\x89...,\xe2\x80\x89i5, consisting of five platforms so that the intervals between consecutive platforms are of the same length. Given the scheme of the level, check if it is good." "brute force,implementation" 1300
1933F "Turtle Mission: Robot and the Earthquake" "The world is a grid with n rows and m columns. The rows are numbered 0,1,\xe2\x80\xa6,n\xe2\x88\x921, while the columns are numbered 0,1,\xe2\x80\xa6,m\xe2\x88\x921. In this world, the columns are cyclic (i.e. the top and the bottom cells in each column are adjacent). The cell on the i-th row and the j-th column (0\xe2\x89\xa4i<n,0\xe2\x89\xa4j<m) is denoted as (i,j). At time 0, the cell (i,j) (where 0\xe2\x89\xa4i<n,0\xe2\x89\xa4j<m) contains either a rock or nothing. The state of cell (i,j) can be described using the integer ai,j:   If ai,j=1, there is a rock at (i,j).  If ai,j=0, there is nothing at (i,j). As a result of aftershocks from the earthquake, the columns follow tectonic plate movements: each column moves cyclically upwards at a velocity of 1 cell per unit of time. Formally, for some 0\xe2\x89\xa4i<n,0\xe2\x89\xa4j<m, if (i,j) contains a rock at the moment, it will move from (i,j) to (i\xe2\x88\x921,j) (or to (n\xe2\x88\x921,j) if i=0). The robot called RT is initially positioned at (0,0). It has to go to (n\xe2\x88\x921,m\xe2\x88\x921) to carry out an earthquake rescue operation (to the bottom rightmost cell). The earthquake doesn\'t change the position of the robot, they only change the position of rocks in the world.Let RT\'s current position be (x,y) (0\xe2\x89\xa4x<n,0\xe2\x89\xa4y<m), it can perform the following operations:   Go one cell cyclically upwards, i.e. from (x,y) to ((x+n\xe2\x88\x921)modn,y) using 1 unit of time.  Go one cell cyclically downwards, i.e. (x,y) to ((x+1)modn,y) using 1 unit of time.  Go one cell to the right, i.e. (x,y) to (x,y+1) using 1 unit of time. (RT may perform this operation only if y<m\xe2\x88\x921.) Note that RT cannot go left using the operations nor can he stay at a position.Unfortunately, RT will explode upon colliding with a rock. As such, when RT is at (x,y) and there is a rock at ((x+1)modn,y) or ((x+2)modn,y), RT cannot move down or it will be hit by the rock.   Similarly, if y+1<m and there is a rock at ((x+1)modn,y+1), RT cannot move right or it will be hit by the rock.  However, it is worth noting that if there is a rock at (xmodn,y+1) and ((x+1)modn,y), RT can still move right safely.  Find the minimum amount of time RT needs to reach (n\xe2\x88\x921,m\xe2\x88\x921) without colliding with any rocks. If it is impossible to do so, output \xe2\x88\x921." "dfs and similar,dp,graphs,shortest paths" 2100
1780D "Bit Guessing Game" "This is an interactive problem.Kira has a hidden positive integer n, and Hayato needs to guess it.Initially, Kira gives Hayato the value cnt \xe2\x80\x94 the number of unit bits in the binary notation of n. To guess n, Hayato can only do operations of one kind: choose an integer x and subtract it from n. Note that after each operation, the number n changes. Kira doesn\'t like bad requests, so if Hayato tries to subtract a number x greater than n, he will lose to Kira. After each operation, Kira gives Hayato the updated value cnt \xe2\x80\x94 the number of unit bits in the binary notation of the updated value of n.Kira doesn\'t have much patience, so Hayato must guess the original value of n after no more than 30 operations.Since Hayato is in elementary school, he asks for your help. Write a program that guesses the number n. Kira is an honest person, so he chooses the initial number n before all operations and does not change it afterward." "binary search,bitmasks,constructive algorithms,interactive" 1800
508A "Pasha and Pixels" "Pasha loves his phone and also putting his hair up... But the hair is now irrelevant.Pasha has installed a new game to his phone. The goal of the game is following. There is a rectangular field consisting of n row with m pixels in each row. Initially, all the pixels are colored white. In one move, Pasha can choose any pixel and color it black. In particular, he can choose the pixel that is already black, then after the boy\'s move the pixel does not change, that is, it remains black. Pasha loses the game when a 2\xe2\x80\x89\xc3\x97\xe2\x80\x892 square consisting of black pixels is formed. Pasha has made a plan of k moves, according to which he will paint pixels. Each turn in his plan is represented as a pair of numbers i and j, denoting respectively the row and the column of the pixel to be colored on the current move.Determine whether Pasha loses if he acts in accordance with his plan, and if he does, on what move the 2\xe2\x80\x89\xc3\x97\xe2\x80\x892 square consisting of black pixels is formed." "brute force" 1100
1958C Firewood "It\'s pretty cold in Berland (yes, even in May). So Monocarp has to light his fireplace.Monocarp has a big log of wood, which weighs 2n grams. Monocarp has watched the weather forecast and decided that he has to burn k grams of wood in the fireplace today, and the remaining 2n\xe2\x88\x92k grams of wood will be used tomorrow.In one minute, Monocarp can use his saw to split one of his logs in half. Initially he has only one log, but of course, after splitting a log, he gets two new logs. If the weight of the log is x, then each of the resulting logs has weight equal to x2. Monocarp can\'t split logs of weight 1 gram.Monocarp has to cut his log in such a way that some of the resulting logs weigh exactly k grams in total (and since the total weight of wood doesn\'t change, the remaining logs will have a total weight equal to exactly 2n\xe2\x88\x92k). Help him to calculate the minimum number of minutes he has to spend cutting the logs." "*special problem" 1500
1542E2 "Abnormal Permutation Pairs (hard version)" "This is the hard version of the problem. The only difference between the easy version and the hard version is the constraints on n. You can only make hacks if both versions are solved.A permutation of 1,2,\xe2\x80\xa6,n is a sequence of n integers, where each integer from 1 to n appears exactly once. For example, [2,3,1,4] is a permutation of 1,2,3,4, but [1,4,2,2] isn\'t because 2 appears twice in it.Recall that the number of inversions in a permutation a1,a2,\xe2\x80\xa6,an is the number of pairs of indices (i,j) such that i<j and ai>aj.Let p and q be two permutations of 1,2,\xe2\x80\xa6,n. Find the number of permutation pairs (p,q) that satisfy the following conditions:  p is lexicographically smaller than q.  the number of inversions in p is greater than the number of inversions in q. Print the number of such pairs modulo mod. Note that mod may not be a prime." combinatorics,dp,fft,math 2700
1970G1 "Min-Fund Prison (Easy)" "In the easy version, m=n\xe2\x88\x921 and there exists a path between u and v for all u,v (1\xe2\x89\xa4u,v\xe2\x89\xa4n).After a worker\'s strike organized by the Dementors asking for equal rights, the prison of Azkaban has suffered some damage. After settling the spirits, the Ministry of Magic is looking to renovate the prison to ensure that the Dementors are kept in check. The prison consists of n prison cells and m bi-directional corridors. The ith corridor is from cells ui to vi. A subset of these cells S is called a complex if any cell in S is reachable from any other cell in S. Formally, a subset of cells S is a complex if x and y are reachable from each other for all x,y\xe2\x88\x88S, using only cells from S on the way. The funding required for a complex S consisting of k cells is defined as k2.As part of your Intro to Magical Interior Design course at Hogwarts, you have been tasked with designing the prison. The Ministry of Magic has asked that you divide the prison into 2 complexes with exactly one corridor connecting them, so that the Dementors can\'t organize union meetings. For this purpose, you are allowed to build bi-directional corridors. The funding required to build a corridor between any 2 cells is c. Due to budget cuts and the ongoing fight against the Death Eaters, you must find the minimum total funding required to divide the prison as per the Ministry\'s requirements or \xe2\x88\x921 if no division is possible.Note: The total funding is the sum of the funding required for the 2 complexes and the corridors built. If after the division, the two complexes have x and y cells respectively and you have built a total of a corridors, the total funding will be x2+y2+c\xc3\x97a. Note that x+y=n." "dfs and similar,trees" 1900
1784D "Wooden Spoon" "2n people, numbered with distinct integers from 1 to 2n, are playing in a single elimination tournament. The bracket of the tournament is a full binary tree of height n with 2n leaves.When two players meet each other in a match, a player with the smaller number always wins. The winner of the tournament is the player who wins all n their matches.A virtual consolation prize ""Wooden Spoon"" is awarded to a player who satisfies the following n conditions:   they lost their first match;  the player who beat them lost their second match;  the player who beat that player lost their third match;  \xe2\x80\xa6;  the player who beat the player from the previous condition lost the final match of the tournament. It can be shown that there is always exactly one player who satisfies these conditions.Consider all possible (2n)! arrangements of players into the tournament bracket. For each player, find the number of these arrangements in which they will be awarded the ""Wooden Spoon"", and print these numbers modulo 998244353." combinatorics,dp 2400
1110A Parity "You are given an integer n (n\xe2\x89\xa50) represented with k digits in base (radix) b. So,n=a1\xe2\x8b\x85bk\xe2\x88\x921+a2\xe2\x8b\x85bk\xe2\x88\x922+\xe2\x80\xa6ak\xe2\x88\x921\xe2\x8b\x85b+ak.For example, if b=17,k=3 and a=[11,15,7] then n=11\xe2\x8b\x85172+15\xe2\x8b\x8517+7=3179+255+7=3441.Determine whether n is even or odd." math 900
355A "Vasya and Digital Root" "Vasya has recently found out what a digital root of a number is and he decided to share his knowledge with you.Let\'s assume that S(n) is the sum of digits of number n, for example, S(4098)\xe2\x80\x89=\xe2\x80\x894\xe2\x80\x89+\xe2\x80\x890\xe2\x80\x89+\xe2\x80\x899\xe2\x80\x89+\xe2\x80\x898\xe2\x80\x89=\xe2\x80\x8921. Then the digital root of number n equals to:   dr(n)\xe2\x80\x89=\xe2\x80\x89S(n), if S(n)\xe2\x80\x89<\xe2\x80\x8910;  dr(n)\xe2\x80\x89=\xe2\x80\x89dr(\xe2\x80\x89S(n)\xe2\x80\x89), if S(n)\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x8910. For example, dr(4098)\xe2\x80\x89\xe2\x80\x89=\xe2\x80\x89\xe2\x80\x89dr(21)\xe2\x80\x89\xe2\x80\x89=\xe2\x80\x89\xe2\x80\x893.Vasya is afraid of large numbers, so the numbers he works with are at most 101000. For all such numbers, he has proved that dr(n)\xe2\x80\x89\xe2\x80\x89=\xe2\x80\x89\xe2\x80\x89S(\xe2\x80\x89S(\xe2\x80\x89S(\xe2\x80\x89S(n)\xe2\x80\x89)\xe2\x80\x89)\xe2\x80\x89) (n\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89101000).Now Vasya wants to quickly find numbers with the given digital root. The problem is, he hasn\'t learned how to do that and he asked you to help him. You task is, given numbers k and d, find the number consisting of exactly k digits (the leading zeroes are not allowed), with digital root equal to d, or else state that such number does not exist." "constructive algorithms,implementation" 1100
1178E Archaeology "Alice bought a Congo Prime Video subscription and was watching a documentary on the archaeological findings from Factor\'s Island on Loch Katrine in Scotland. The archaeologists found a book whose age and origin are unknown. Perhaps Alice can make some sense of it?The book contains a single string of characters ""a"", ""b"" and ""c"". It has been pointed out that no two consecutive characters are the same. It has also been conjectured that the string contains an unusually long subsequence that reads the same from both sides. Help Alice verify this by finding such subsequence that contains at least half of the characters of the original string, rounded down. Note that you don\'t have to maximise the length of it.A string a is a subsequence of a string b if a can be obtained from b by deletion of several (possibly, zero or all) characters." "brute force,constructive algorithms,greedy,strings" 1900
73B "Need For Brake" "Vasya plays the Need For Brake. He plays because he was presented with a new computer wheel for birthday! Now he is sure that he will win the first place in the championship in his favourite racing computer game! n racers take part in the championship, which consists of a number of races. After each race racers are arranged from place first to n-th (no two racers share the same place) and first m places are awarded. Racer gains bi points for i-th awarded place, which are added to total points, obtained by him for previous races. It is known that current summary score of racer i is ai points. In the final standings of championship all the racers will be sorted in descending order of points. Racers with an equal amount of points are sorted by increasing of the name in lexicographical order.Unfortunately, the championship has come to an end, and there is only one race left. Vasya decided to find out what the highest and lowest place he can take up as a result of the championship." "binary search,greedy,sortings" 2000
1036B "Diagonal Walking v.2" "Mikhail walks on a Cartesian plane. He starts at the point (0,0), and in one move he can go to any of eight adjacent points. For example, if Mikhail is currently at the point (0,0), he can go to any of the following points in one move:   (1,0);  (1,1);  (0,1);  (\xe2\x88\x921,1);  (\xe2\x88\x921,0);  (\xe2\x88\x921,\xe2\x88\x921);  (0,\xe2\x88\x921);  (1,\xe2\x88\x921). If Mikhail goes from the point (x1,y1) to the point (x2,y2) in one move, and x1\xe2\x89\xa0x2 and y1\xe2\x89\xa0y2, then such a move is called a diagonal move.Mikhail has q queries. For the i-th query Mikhail\'s target is to go to the point (ni,mi) from the point (0,0) in exactly ki moves. Among all possible movements he want to choose one with the maximum number of diagonal moves. Your task is to find the maximum number of diagonal moves or find that it is impossible to go from the point (0,0) to the point (ni,mi) in ki moves.Note that Mikhail can visit any point any number of times (even the destination point!)." math 1600
1569A "Balanced Substring" "You are given a string s, consisting of n letters, each letter is either \'a\' or \'b\'. The letters in the string are numbered from 1 to n.s[l;r] is a continuous substring of letters from index l to r of the string inclusive. A string is called balanced if the number of letters \'a\' in it is equal to the number of letters \'b\'. For example, strings ""baba"" and ""aabbab"" are balanced and strings ""aaab"" and ""b"" are not.Find any non-empty balanced substring s[l;r] of string s. Print its l and r (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n). If there is no such substring, then print \xe2\x88\x921 \xe2\x88\x921." implementation 800
733B Parade "Very soon there will be a parade of victory over alien invaders in Berland. Unfortunately, all soldiers died in the war and now the army consists of entirely new recruits, many of whom do not even know from which leg they should begin to march. The civilian population also poorly understands from which leg recruits begin to march, so it is only important how many soldiers march in step.There will be n columns participating in the parade, the i-th column consists of li soldiers, who start to march from left leg, and ri soldiers, who start to march from right leg.The beauty of the parade is calculated by the following formula: if L is the total number of soldiers on the parade who start to march from the left leg, and R is the total number of soldiers on the parade who start to march from the right leg, so the beauty will equal |L\xe2\x80\x89-\xe2\x80\x89R|.No more than once you can choose one column and tell all the soldiers in this column to switch starting leg, i.e. everyone in this columns who starts the march from left leg will now start it from right leg, and vice versa. Formally, you can pick no more than one index i and swap values li and ri. Find the index of the column, such that switching the starting leg for soldiers in it will maximize the the beauty of the parade, or determine, that no such operation can increase the current beauty." math 1100
887B "Cubes for Masha" "Absent-minded Masha got set of n cubes for her birthday.At each of 6 faces of each cube, there is exactly one digit from 0 to 9. Masha became interested what is the largest natural x such she can make using her new cubes all integers from 1 to x.To make a number Masha can rotate her cubes and put them in a row. After that, she looks at upper faces of cubes from left to right and reads the number.The number can\'t contain leading zeros. It\'s not required to use all cubes to build a number.Pay attention: Masha can\'t make digit 6 from digit 9 and vice-versa using cube rotations." "brute force,implementation" 1300
1016C "Vasya And The Mushrooms" "Vasya\'s house is situated in a forest, and there is a mushroom glade near it. The glade consists of two rows, each of which can be divided into n consecutive cells. For each cell Vasya knows how fast the mushrooms grow in this cell (more formally, how many grams of mushrooms grow in this cell each minute). Vasya spends exactly one minute to move to some adjacent cell. Vasya cannot leave the glade. Two cells are considered adjacent if they share a common side. When Vasya enters some cell, he instantly collects all the mushrooms growing there.Vasya begins his journey in the left upper cell. Every minute Vasya must move to some adjacent cell, he cannot wait for the mushrooms to grow. He wants to visit all the cells exactly once and maximize the total weight of the collected mushrooms. Initially, all mushrooms have a weight of 0. Note that Vasya doesn\'t need to return to the starting cell.Help Vasya! Calculate the maximum total weight of mushrooms he can collect." dp,implementation 1800
1971E "Find the Car" "Timur is in a car traveling on the number line from point 0 to point n. The car starts moving from point 0 at minute 0.There are k+1 signs on the line at points 0,a1,a2,\xe2\x80\xa6,ak, and Timur knows that the car will arrive there at minutes 0,b1,b2,\xe2\x80\xa6,bk, respectively. The sequences a and b are strictly increasing with ak=n.  Between any two adjacent signs, the car travels with a constant speed. Timur has q queries: each query will be an integer d, and Timur wants you to output how many minutes it takes the car to reach point d, rounded down to the nearest integer." "binary search,math,sortings" 1500
1987G1 "Spinning Round (Easy Version)" "This is the easy version of the problem. The only difference between the two versions are the allowed characters in s. In the easy version, s only contains the character ?. You can make hacks only if both versions of the problem are solved.You are given a permutation p of length n. You are also given a string s of length n, consisting only of the character ?.For each i from 1 to n:   Define li as the largest index j<i such that pj>pi. If there is no such index, li:=i.  Define ri as the smallest index j>i such that pj>pi. If there is no such index, ri:=i. Initially, you have an undirected graph with n vertices (numbered from 1 to n) and no edges. Then, for each i from 1 to n, add one edge to the graph:   If si= L, add the edge (i,li) to the graph.  If si= R, add the edge (i,ri) to the graph.  If si= ?, either add the edge (i,li) or the edge (i,ri) to the graph at your choice. Find the maximum possible diameter\xe2\x88\x97 over all connected graphs that you can form. Output \xe2\x88\x921 if it is not possible to form any connected graphs.\xe2\x88\x97 Let d(s,t) denote the smallest number of edges on any path between s and t.The diameter of the graph is defined as the maximum value of d(s,t) over all pairs of vertices s and t." "divide and conquer,dp,trees" 2900
1512C "A-B Palindrome" "You are given a string s consisting of the characters \'0\', \'1\', and \'?\'. You need to replace all the characters with \'?\' in the string s by \'0\' or \'1\' so that the string becomes a palindrome and has exactly a characters \'0\' and exactly b characters \'1\'. Note that each of the characters \'?\' is replaced independently from the others.A string t of length n is called a palindrome if the equality t[i]=t[n\xe2\x88\x92i+1] is true for all i (1\xe2\x89\xa4i\xe2\x89\xa4n).For example, if s=""01?????0"", a=4 and b=4, then you can replace the characters \'?\' in the following ways:   ""01011010"";  ""01100110"". For the given string s and the numbers a and b, replace all the characters with \'?\' in the string s by \'0\' or \'1\' so that the string becomes a palindrome and has exactly a characters \'0\' and exactly b characters \'1\'." "constructive algorithms,implementation,strings" 1200
1066E "Binary Numbers AND Sum" "You are given two huge binary integer numbers a and b of lengths n and m respectively. You will repeat the following process: if b>0, then add to the answer the value a & b and divide b by 2 rounding down (i.e. remove the last digit of b), and repeat the process again, otherwise stop the process.The value a & b means bitwise AND of a and b. Your task is to calculate the answer modulo 998244353.Note that you should add the value a & b to the answer in decimal notation, not in binary. So your task is to calculate the answer in decimal notation. For example, if a=10102 (1010) and b=10002 (810), then the value a & b will be equal to 8, not to 1000." "data structures,implementation,math" 1700
1572D "Bridge Club" "There are currently n hot topics numbered from 0 to n\xe2\x88\x921 at your local bridge club and 2n players numbered from 0 to 2n\xe2\x88\x921. Each player holds a different set of views on those n topics, more specifically, the i-th player holds a positive view on the j-th topic if i & 2j>0, and a negative view otherwise. Here & denotes the bitwise AND operation.You are going to organize a bridge tournament capable of accommodating at most k pairs of players (bridge is played in teams of two people). You can select teams arbitrarily while each player is in at most one team, but there is one catch: two players cannot be in the same pair if they disagree on 2 or more of those n topics, as they would argue too much during the play.You know that the i-th player will pay you ai dollars if they play in this tournament. Compute the maximum amount of money that you can earn if you pair the players in your club optimally." "flows,graph matchings,graphs,greedy" 2800
950B "Intercepted Message" "Hacker Zhorik wants to decipher two secret messages he intercepted yesterday. Yeah message is a sequence of encrypted blocks, each of them consists of several bytes of information.Zhorik knows that each of the messages is an archive containing one or more files. Zhorik knows how each of these archives was transferred through the network: if an archive consists of k files of sizes l1,\xe2\x80\x89l2,\xe2\x80\x89...,\xe2\x80\x89lk bytes, then the i-th file is split to one or more blocks bi,\xe2\x80\x891,\xe2\x80\x89bi,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89bi,\xe2\x80\x89mi (here the total length of the blocks bi,\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x89bi,\xe2\x80\x892\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89bi,\xe2\x80\x89mi is equal to the length of the file li), and after that all blocks are transferred through the network, maintaining the order of files in the archive.Zhorik thinks that the two messages contain the same archive, because their total lengths are equal. However, each file can be split in blocks in different ways in the two messages.You are given the lengths of blocks in each of the two messages. Help Zhorik to determine what is the maximum number of files could be in the archive, if the Zhorik\'s assumption is correct." greedy,implementation 1100
405C "Unusual Product" "Little Chris is a huge fan of linear algebra. This time he has been given a homework about the unusual square of a square matrix.The dot product of two integer number vectors x and y of size n is the sum of the products of the corresponding components of the vectors. The unusual square of an n\xe2\x80\x89\xc3\x97\xe2\x80\x89n square matrix A is defined as the sum of n dot products. The i-th of them is the dot product of the i-th row vector and the i-th column vector in the matrix A.Fortunately for Chris, he has to work only in GF(2)! This means that all operations (addition, multiplication) are calculated modulo 2. In fact, the matrix A is binary: each element of A is either 0 or 1. For example, consider the following matrix A:  The unusual square of A is equal to (1\xc2\xb71\xe2\x80\x89+\xe2\x80\x891\xc2\xb70\xe2\x80\x89+\xe2\x80\x891\xc2\xb71)\xe2\x80\x89+\xe2\x80\x89(0\xc2\xb71\xe2\x80\x89+\xe2\x80\x891\xc2\xb71\xe2\x80\x89+\xe2\x80\x891\xc2\xb70)\xe2\x80\x89+\xe2\x80\x89(1\xc2\xb71\xe2\x80\x89+\xe2\x80\x890\xc2\xb71\xe2\x80\x89+\xe2\x80\x890\xc2\xb70)\xe2\x80\x89=\xe2\x80\x890\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89=\xe2\x80\x890.However, there is much more to the homework. Chris has to process q queries; each query can be one of the following:   given a row index i, flip all the values in the i-th row in A;  given a column index i, flip all the values in the i-th column in A;  find the unusual square of A. To flip a bit value w means to change it to 1\xe2\x80\x89-\xe2\x80\x89w, i.e., 1 changes to 0 and 0 changes to 1.Given the initial matrix A, output the answers for each query of the third type! Can you solve Chris\'s homework?" implementation,math 1600
1033B "Square Difference" "Alice has a lovely piece of cloth. It has the shape of a square with a side of length a centimeters. Bob also wants such piece of cloth. He would prefer a square with a side of length b centimeters (where b<a). Alice wanted to make Bob happy, so she cut the needed square out of the corner of her piece and gave it to Bob. Now she is left with an ugly L shaped cloth (see pictures below).Alice would like to know whether the area of her cloth expressed in square centimeters is prime. Could you help her to determine it?" "math,number theory" 1100
441E "Valera and Number" "Valera is a coder. Recently he wrote a funny program. The pseudo code for this program is given below://input: integers x, k, pa = x;for(step = 1; step <= k; step = step + 1){    rnd = [random integer from 1 to 100];    if(rnd <= p)        a = a * 2;    else        a = a + 1;}s = 0;while(remainder after dividing a by 2 equals 0){    a = a / 2;    s = s + 1;}Now Valera wonders: given the values x, k and p, what is the expected value of the resulting number s?" bitmasks,dp,math,probabilities 2400
1823A A-characteristic "Consider an array a1,a2,\xe2\x80\xa6,an consisting of numbers 1 and \xe2\x88\x921. Define A-characteristic of this array as a number of pairs of indices 1\xe2\x89\xa4i<j\xe2\x89\xa4n, such that ai\xe2\x8b\x85aj=1.Find any array a with given length n with A-characteristic equal to the given value k." "combinatorics,constructive algorithms,math" 800
1513D "GCD and MST" "You are given an array a of n (n\xe2\x89\xa52) positive integers and an integer p. Consider an undirected weighted graph of n vertices numbered from 1 to n for which the edges between the vertices i and j (i<j) are added in the following manner:  If gcd(ai,ai+1,ai+2,\xe2\x80\xa6,aj)=min(ai,ai+1,ai+2,\xe2\x80\xa6,aj), then there is an edge of weight min(ai,ai+1,ai+2,\xe2\x80\xa6,aj) between i and j.  If i+1=j, then there is an edge of weight p between i and j. Here gcd(x,y,\xe2\x80\xa6) denotes the greatest common divisor (GCD) of integers x, y, ....Note that there could be multiple edges between i and j if both of the above conditions are true, and if both the conditions fail for i and j, then there is no edge between these vertices.The goal is to find the weight of the minimum spanning tree of this graph." "constructive algorithms,dsu,graphs,greedy,number theory,sortings" 2000
1371F "Raging Thunder" "You are a warrior fighting against the machine god Thor.Thor challenge you to solve the following problem:There are n conveyors arranged in a line numbered with integers from 1 to n from left to right. Each conveyor has a symbol ""<"" or "">"". The initial state of the conveyor i is equal to the i-th character of the string s. There are n+1 holes numbered with integers from 0 to n. The hole 0 is on the left side of the conveyor 1, and for all i\xe2\x89\xa51 the hole i is on the right side of the conveyor i.When a ball is on the conveyor i, the ball moves by the next rules:If the symbol ""<"" is on the conveyor i, then:  If i=1, the ball falls into the hole 0.  If the symbol ""<"" is on the conveyor i\xe2\x88\x921, the ball moves to the conveyor i\xe2\x88\x921.  If the symbol "">"" is on the conveyor i\xe2\x88\x921, the ball falls into the hole i\xe2\x88\x921. If the symbol "">"" is on the conveyor i, then:  If i=n, the ball falls into the hole n.  If the symbol "">"" is on the conveyor i+1, the ball moves to the conveyor i+1.  If the symbol ""<"" is on the conveyor i+1, the ball falls into the hole i. You should answer next q queries, each query is defined by the pair of integers l,r (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n):   First, for all conveyors l,l+1,...,r, the symbol ""<"" changes to "">"" and vice versa. These changes remain for the next queries.  After that, put one ball on each conveyor l,l+1,...,r. Then, each ball falls into some hole. Find the maximum number of balls in one hole. After the query all balls disappear and don\'t considered in the next queries." "data structures,divide and conquer,implementation" 2800
2032E Balanced "You are given a cyclic array a with n elements, where n is odd. In each operation, you can do the following:  Choose an index 1\xe2\x89\xa4i\xe2\x89\xa4n and increase ai\xe2\x88\x921 by 1, ai by 2, and ai+1 by 1. The element before the first element is the last element because this is a cyclic array. A cyclic array is called balanced if all its elements are equal to each other.Find any sequence of operations to make this cyclic array balanced or determine that it is impossible. Please note that you do not have to minimize the number of operations." "constructive algorithms,data structures,greedy,implementation,math" 2400
1987G2 "Spinning Round (Hard Version)" "This is the hard version of the problem. The only difference between the two versions are the allowed characters in s. You can make hacks only if both versions of the problem are solved.You are given a permutation p of length n. You are also given a string s of length n, where each character is either L, R, or ?.For each i from 1 to n:   Define li as the largest index j<i such that pj>pi. If there is no such index, li:=i.  Define ri as the smallest index j>i such that pj>pi. If there is no such index, ri:=i. Initially, you have an undirected graph with n vertices (numbered from 1 to n) and no edges. Then, for each i from 1 to n, add one edge to the graph:   If si= L, add the edge (i,li) to the graph.  If si= R, add the edge (i,ri) to the graph.  If si= ?, either add the edge (i,li) or the edge (i,ri) to the graph at your choice. Find the maximum possible diameter over all connected\xe2\x88\x97 graphs that you can form. Output \xe2\x88\x921 if it is not possible to form any connected graphs.\xe2\x88\x97 Let d(s,t) denote the smallest number of edges on any path between s and t.The diameter of the graph is defined as the maximum value of d(s,t) over all pairs of vertices s and t." "divide and conquer,dp,trees" 3500
92A Chips "There are n walruses sitting in a circle. All of them are numbered in the clockwise order: the walrus number 2 sits to the left of the walrus number 1, the walrus number 3 sits to the left of the walrus number 2, ..., the walrus number 1 sits to the left of the walrus number n.The presenter has m chips. The presenter stands in the middle of the circle and starts giving the chips to the walruses starting from walrus number 1 and moving clockwise. The walrus number i gets i chips. If the presenter can\'t give the current walrus the required number of chips, then the presenter takes the remaining chips and the process ends. Determine by the given n and m how many chips the presenter will get in the end." implementation,math 800
1598D "Training Session" "Monocarp is the coach of the Berland State University programming teams. He decided to compose a problemset for a training session for his teams.Monocarp has n problems that none of his students have seen yet. The i-th problem has a topic ai (an integer from 1 to n) and a difficulty bi (an integer from 1 to n). All problems are different, that is, there are no two tasks that have the same topic and difficulty at the same time.Monocarp decided to select exactly 3 problems from n problems for the problemset. The problems should satisfy at least one of two conditions (possibly, both):  the topics of all three selected problems are different;  the difficulties of all three selected problems are different. Your task is to determine the number of ways to select three problems for the problemset." "combinatorics,data structures,geometry,implementation,math" 1700
888B "Buggy Robot" "Ivan has a robot which is situated on an infinite grid. Initially the robot is standing in the starting cell (0,\xe2\x80\x890). The robot can process commands. There are four types of commands it can perform:  U \xe2\x80\x94 move from the cell (x,\xe2\x80\x89y) to (x,\xe2\x80\x89y\xe2\x80\x89+\xe2\x80\x891);  D \xe2\x80\x94 move from (x,\xe2\x80\x89y) to (x,\xe2\x80\x89y\xe2\x80\x89-\xe2\x80\x891);  L \xe2\x80\x94 move from (x,\xe2\x80\x89y) to (x\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89y);  R \xe2\x80\x94 move from (x,\xe2\x80\x89y) to (x\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89y). Ivan entered a sequence of n commands, and the robot processed it. After this sequence the robot ended up in the starting cell (0,\xe2\x80\x890), but Ivan doubts that the sequence is such that after performing it correctly the robot ends up in the same cell. He thinks that some commands were ignored by robot. To acknowledge whether the robot is severely bugged, he needs to calculate the maximum possible number of commands that were performed correctly. Help Ivan to do the calculations!" greedy 1000
392A "Blocked Points" "Imagine you have an infinite 2D plane with Cartesian coordinate system. Some of the integral points are blocked, and others are not. Two integral points A and B on the plane are 4-connected if and only if:  the Euclidean distance between A and B is one unit and neither A nor B is blocked;  or there is some integral point C, such that A is 4-connected with C, and C is 4-connected with B. Let\'s assume that the plane doesn\'t contain blocked points. Consider all the integral points of the plane whose Euclidean distance from the origin is no more than n, we\'ll name these points special. Chubby Yang wants to get the following property: no special point is 4-connected to some non-special point. To get the property she can pick some integral points of the plane and make them blocked. What is the minimum number of points she needs to pick?" math -999
847G "University Classes" "There are n student groups at the university. During the study day, each group can take no more than 7 classes. Seven time slots numbered from 1 to 7 are allocated for the classes.The schedule on Monday is known for each group, i. e. time slots when group will have classes are known.Your task is to determine the minimum number of rooms needed to hold classes for all groups on Monday. Note that one room can hold at most one group class in a single time slot." implementation 900
1738F "Connectivity Addicts" "This is an interactive problem.Given a simple undirected graph with n vertices numbered from 1 to n, your task is to color all the vertices such that for every color c, the following conditions hold:   The set of vertices with color c is connected;  sc\xe2\x89\xa4n2c, where nc is the number of vertices with color c, and sc is the sum of degrees of vertices with color c.  It can be shown that there always exists a way to color all the vertices such that the above conditions hold. Initially, you are only given the number n of vertices and the degree of each vertex. In each query, you can choose a vertex u. As a response, you will be given the k-th edge incident to u, if this is the k-th query on vertex u. You are allowed to make at most n queries.An undirected graph is simple if it does not contain multiple edges or self-loops.The degree of a vertex is the number of edges incident to it. A set S of vertices is connected if for every two different vertices u,v\xe2\x88\x88S, there is a path, which only passes through vertices in S, that connects u and v. That is, there is a sequence of edges (u1,v1),(u2,v2),\xe2\x80\xa6,(uk,vk) with k\xe2\x89\xa51 such that   u1=u, vk=v, and vi=ui+1 for every 1\xe2\x89\xa4i<k; and  uk\xe2\x88\x88S and vk\xe2\x88\x88S for every 1\xe2\x89\xa4i\xe2\x89\xa4k.  Especially, a set containing only one vertex is connected." "constructive algorithms,dsu,graphs,greedy,interactive,shortest paths,trees" 2400
530F "Jumping frogs" "A rectangular swamp is inhabited by 10 species of frogs. Frogs of species i can jump from hillocks to hillock exactly i units along X-axis or Y-axis. Initially frogs of all types sit at the hillock at coordinates (0, 0). You are given coordinates of all other hillocks in the swamp. Find the largest Manhattan distance from (0, 0) to any hillock to which one of the frogs can travel by jumping between hillocks.Manhattan distance between (x1,\xe2\x80\x89y1) and (x2,\xe2\x80\x89y2) is |x1\xe2\x80\x89-\xe2\x80\x89x2|\xe2\x80\x89+\xe2\x80\x89|y1\xe2\x80\x89-\xe2\x80\x89y2|." "*special problem" 2100
1209F "Koala and Notebook" "Koala Land consists of m bidirectional roads connecting n cities. The roads are numbered from 1 to m by order in input. It is guaranteed, that one can reach any city from every other city.Koala starts traveling from city 1. Whenever he travels on a road, he writes its number down in his notebook. He doesn\'t put spaces between the numbers, so they all get concatenated into a single number.Before embarking on his trip, Koala is curious about the resulting number for all possible destinations. For each possible destination, what is the smallest number he could have written for it?Since these numbers may be quite large, print their remainders modulo 109+7. Please note, that you need to compute the remainder of the minimum possible number, not the minimum possible remainder." "data structures,dfs and similar,graphs,shortest paths,strings,trees" 2600
16E Fish "n fish, numbered from 1 to n, live in a lake. Every day right one pair of fish meet, and the probability of each other pair meeting is the same. If two fish with indexes i and j meet, the first will eat up the second with the probability aij, and the second will eat up the first with the probability aji\xe2\x80\x89=\xe2\x80\x891\xe2\x80\x89-\xe2\x80\x89aij. The described process goes on until there are at least two fish in the lake. For each fish find out the probability that it will survive to be the last in the lake." bitmasks,dp,probabilities 1900
1366G "Construct the String" "Let\'s denote the function f(s) that takes a string s consisting of lowercase Latin letters and dots, and returns a string consisting of lowercase Latin letters as follows:  let r be an empty string;  process the characters of s from left to right. For each character c, do the following: if c is a lowercase Latin letter, append c at the end of the string r; otherwise, delete the last character from r (if r is empty before deleting the last character \xe2\x80\x94 the function crashes);  return r as the result of the function. You are given two strings s and t. You have to delete the minimum possible number of characters from s so that f(s)=t (and the function does not crash). Note that you aren\'t allowed to insert new characters into s or reorder the existing ones." "data structures,dp,strings" 2700
1956E1 "Nene vs. Monsters (Easy Version)" "This is the easy version of the problem. The only difference between the versions is the constraints on ai. You can make hacks only if both versions of the problem are solved.Nene is fighting with n monsters, located in a circle. These monsters are numbered from 1 to n, and the i-th (1\xe2\x89\xa4i\xe2\x89\xa4n) monster\'s current energy level is ai.Since the monsters are too strong, Nene decided to fight with them using the Attack Your Neighbour spell. When Nene uses this spell, the following actions happen in the following order one by one:   The 1-st monster attacks the 2-nd monster;  The 2-nd monster attacks the 3-rd monster;  \xe2\x80\xa6  The (n\xe2\x88\x921)-th monster attacks the n-th monster;  The n-th monster attacks the 1-st monster. When the monster with energy level x attacks the monster with the energy level y, the energy level of the defending monster becomes max(0,y\xe2\x88\x92x) (the energy level of the attacking monster remains equal to x).Nene is going to use this spell 10100 times and deal with the monsters that will still have a non-zero energy level herself. She wants you to determine which monsters will have a non-zero energy level once she will use the described spell 10100 times." "brute force,implementation,math" 2500
1523D Love-Hate "William is hosting a party for n of his trader friends. They started a discussion on various currencies they trade, but there\'s an issue: not all of his trader friends like every currency. They like some currencies, but not others.For each William\'s friend i it is known whether he likes currency j. There are m currencies in total. It is also known that a trader may not like more than p currencies.Because friends need to have some common topic for discussions they need to find the largest by cardinality (possibly empty) subset of currencies, such that there are at least \xe2\x8c\x88n2\xe2\x8c\x89 friends (rounded up) who like each currency in this subset." "bitmasks,brute force,dp,probabilities" 2400
331E1 "Deja Vu" "Everybody knows that we have been living in the Matrix for a long time. And in the new seventh Matrix the world is ruled by beavers.So let\'s take beaver Neo. Neo has so-called ""deja vu"" outbursts when he gets visions of events in some places he\'s been at or is going to be at. Let\'s examine the phenomenon in more detail.We can say that Neo\'s city is represented by a directed graph, consisting of n shops and m streets that connect the shops. No two streets connect the same pair of shops (besides, there can\'t be one street from A to B and one street from B to A). No street connects a shop with itself. As Neo passes some streets, he gets visions. No matter how many times he passes street k, every time he will get the same visions in the same order. A vision is a sequence of shops.We know that Neo is going to get really shocked if he passes the way from some shop a to some shop b, possible coinciding with a, such that the list of visited shops in the real life and in the visions coincide.Suggest beaver Neo such path of non-zero length. Or maybe you can even count the number of such paths modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)?.." "constructive algorithms,graphs,implementation" 2900
364E "Empty Rectangles" "You\'ve got an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m table (n rows and m columns), each cell of the table contains a ""0"" or a ""1"".Your task is to calculate the number of rectangles with the sides that are parallel to the sides of the table and go along the cell borders, such that the number one occurs exactly k times in the rectangle." "divide and conquer,two pointers" 3000
908A "New Year and Counting Cards" "Your friend has n cards.You know that each card has a lowercase English letter on one side and a digit on the other.Currently, your friend has laid out the cards on a table so only one side of each card is visible.You would like to know if the following statement is true for cards that your friend owns: ""If a card has a vowel on one side, then it has an even digit on the other side."" More specifically, a vowel is one of \'a\', \'e\', \'i\', \'o\' or \'u\', and even digit is one of \'0\', \'2\', \'4\', \'6\' or \'8\'.For example, if a card has \'a\' on one side, and \'6\' on the other side, then this statement is true for it. Also, the statement is true, for example, for a card with \'b\' and \'4\', and for a card with \'b\' and \'3\' (since the letter is not a vowel). The statement is false, for example, for card with \'e\' and \'5\'. You are interested if the statement is true for all cards. In particular, if no card has a vowel, the statement is true.To determine this, you can flip over some cards to reveal the other side. You would like to know what is the minimum number of cards you need to flip in the worst case in order to verify that the statement is true." "brute force,implementation" 800
1734A "Select Three Sticks" "You are given n sticks with positive integral length a1,a2,\xe2\x80\xa6,an.You can perform the following operation any number of times (possibly zero):   choose one stick, then either increase or decrease its length by 1. After each operation, all sticks should have positive lengths. What is the minimum number of operations that you have to perform such that it is possible to select three of the n sticks and use them without breaking to form an equilateral triangle?An equilateral triangle is a triangle where all of its three sides have the same length." "brute force,greedy,sortings" 800
1675D "Vertical Paths" "You are given a rooted tree consisting of n vertices. Vertices are numbered from 1 to n. Any vertex can be the root of a tree.A tree is a connected undirected graph without cycles. A rooted tree is a tree with a selected vertex, which is called the root.The tree is specified by an array of parents p containing n numbers: pi is a parent of the vertex with the index i. The parent of a vertex u is a vertex that is the next vertex on the shortest path from u to the root. For example, on the simple path from 5 to 3 (the root), the next vertex would be 1, so the parent of 5 is 1.The root has no parent, so for it, the value of pi is i (the root is the only vertex for which pi=i).Find such a set of paths that:  each vertex belongs to exactly one path, each path can contain one or more vertices;  in each path each next vertex \xe2\x80\x94 is a son of the current vertex (that is, paths always lead down \xe2\x80\x94 from parent to son);  number of paths is minimal. For example, if n=5 and p=[3,1,3,3,1], then the tree can be divided into three paths:   3\xe2\x86\x921\xe2\x86\x925 (path of 3 vertices),  4 (path of 1 vertices).  2 (path of 1 vertices).   Example of splitting a root tree into three paths for n=5, the root of the tree \xe2\x80\x94 node 3." graphs,implementation,trees 1300
467A "George and Accommodation" "George has recently entered the BSUCP (Berland State University for Cool Programmers). George has a friend Alex who has also entered the university. Now they are moving into a dormitory. George and Alex want to live in the same room. The dormitory has n rooms in total. At the moment the i-th room has pi people living in it and the room can accommodate qi people in total (pi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89qi). Your task is to count how many rooms has free place for both George and Alex." implementation 800
1795F "Blocking Chips" "You are given a tree, consisting of n vertices. There are k chips, placed in vertices a1,a2,\xe2\x80\xa6,ak. All ai are distinct. Vertices a1,a2,\xe2\x80\xa6,ak are colored black initially. The remaining vertices are white.You are going to play a game where you perform some moves (possibly, zero). On the i-th move (1-indexed) you are going to move the ((i\xe2\x88\x921)modk+1)-st chip from its current vertex to an adjacent white vertex and color that vertex black. So, if k=3, you move chip 1 on move 1, chip 2 on move 2, chip 3 on move 3, chip 1 on move 4, chip 2 on move 5 and so on. If there is no adjacent white vertex, then the game ends.What\'s the maximum number of moves you can perform?" "binary search,constructive algorithms,dfs and similar,greedy,trees" 2400
830E "Perpetual Motion Machine" "Developer Petr thinks that he invented a perpetual motion machine. Namely, he has a lot of elements, which work in the following way.Each element has one controller that can be set to any non-negative real value. If a controller is set on some value x, then the controller consumes x2 energy units per second. At the same time, any two elements connected by a wire produce y\xc2\xb7z energy units per second, where y and z are the values set on their controllers.Petr has only a limited number of wires, so he has already built some scheme of elements and wires, and is now interested if it\'s possible to set the controllers in such a way that the system produces at least as much power as it consumes, and at least one controller is set on the value different from 0. Help him check this, and if it\'s possible, find the required integer values that should be set.It is guaranteed that if there exist controllers\' settings satisfying the above conditions, then there exist required integer values not greater than 106." "constructive algorithms,dp,graphs,implementation,math,trees" 3100
1776J "Italian Data Centers" "An Italian data center consists of a set of servers, each colored green, white, or red, and a set of wires connecting them. Each wire connects two distinct servers and two servers are connected by at most one wire. Additionally, the data center is connected, i.e. there is a way to transmit information between any two servers through a sequence of wires.To judge all of the contestant submissions, SWERC has an Italian data center. Since every year the number of contestants doubles, the data center needs to grow to adapt to the extra load. To address this, SWERC builds a new data center based on the previous year\'s one by following these steps:  For each server s in the old data center, the new data center contains two servers s1 and s2 of the same color as s. A wire is placed connecting the two servers s1 and s2.  For each wire connecting servers s and t in the old data center: if s and t have the same color, then a wire is placed in the new data center connecting s1 and t1 and another wire connecting s2 and t2; otherwise, a wire is placed in the new data center connecting s1 and t2 and another one connecting s2 and t1. One can show that if the old data center is connected than the new data center is also connected.You are given the Italian data center that SWERC currently has, which contains n servers (indexed by 1,2,\xe2\x80\xa6,n) and m wires connecting them. The organization wants to know how good their data center will be after k years, so you should determine the diameter of the data center SWERC will have in k years. The diameter of the data center is the largest distance between any two servers, i.e. the shortest number of wires that have to be used to transmit something between the two servers." "graphs,shortest paths" 2500
1795B "Ideal Point" "You are given n one-dimensional segments (each segment is denoted by two integers \xe2\x80\x94 its endpoints).Let\'s define the function f(x) as the number of segments covering point x (a segment covers the point x if l\xe2\x89\xa4x\xe2\x89\xa4r, where l is the left endpoint and r is the right endpoint of the segment).An integer point x is called ideal if it belongs to more segments than any other integer point, i.\xe2\x80\x89e. f(y)<f(x) is true for any other integer point y.You are given an integer k. Your task is to determine whether it is possible to remove some (possibly zero) segments, so that the given point k becomes ideal." "brute force,geometry,greedy" 900
1895G "Two Characters, Two Colors" "You are given a string consisting of characters 0 and/or 1. You have to paint every character of this string into one of two colors, red or blue.If you paint the i-th character red, you get ri coins. If you paint it blue, you get bi coins.After coloring the string, you remove every blue character from it, and count the number of inversions in the resulting string (i.\xe2\x80\x89e. the number of pairs of characters such that the left character in the pair is 1, and the right character in the pair is 0). For each inversion, you have to pay 1 coin.What is the maximum number of coins you can earn?" "binary search,data structures,dp,flows,greedy" 3100
446A "DZY Loves Sequences" "DZY has a sequence a, consisting of n integers.We\'ll call a sequence ai,\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89aj (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) a subsegment of the sequence a. The value (j\xe2\x80\x89-\xe2\x80\x89i\xe2\x80\x89+\xe2\x80\x891) denotes the length of the subsegment.Your task is to find the longest subsegment of a, such that it is possible to change at most one number (change one number to any integer you want) from the subsegment to make the subsegment strictly increasing.You only need to output the length of the subsegment you find." "dp,implementation,two pointers" 1600
798D "Mike and distribution" "Mike has always been thinking about the harshness of social inequality. He\'s so obsessed with it that sometimes it even affects him while solving problems. At the moment, Mike has two sequences of positive integers A\xe2\x80\x89=\xe2\x80\x89[a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an] and B\xe2\x80\x89=\xe2\x80\x89[b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bn] of length n each which he uses to ask people some quite peculiar questions.To test you on how good are you at spotting inequality in life, he wants you to find an ""unfair"" subset of the original sequence. To be more precise, he wants you to select k numbers P\xe2\x80\x89=\xe2\x80\x89[p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pk] such that 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89pi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n for 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k and elements in P are distinct. Sequence P will represent indices of elements that you\'ll select from both sequences. He calls such a subset P ""unfair"" if and only if the following conditions are satisfied: 2\xc2\xb7(ap1\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89apk) is greater than the sum of all elements from sequence A, and 2\xc2\xb7(bp1\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89bpk) is greater than the sum of all elements from the sequence B. Also, k should be smaller or equal to  because it will be to easy to find sequence P if he allowed you to select too many elements!Mike guarantees you that a solution will always exist given the conditions described above, so please help him satisfy his curiosity!" "constructive algorithms,sortings" 2400
238E "Meeting Her" "Urpal lives in a big city. He has planned to meet his lover tonight. The city has n junctions numbered from 1 to n. The junctions are connected by m directed streets, all the roads have equal length. Urpal lives in junction a and the date is planned in a restaurant in junction b. He wants to use public transportation to get to junction b. There are k bus transportation companies. At the beginning of every second, a bus from the i-th company chooses a random shortest path between junction si and junction ti and passes through it. There might be no path from si to ti. In that case no bus will leave from si to ti. If a bus passes through a junction where Urpal stands, he can get on the bus. He can also get o\x1bff the bus at any junction along the path. Now Urpal wants to know if it\'s possible to go to the date using public transportation in a \x1cfinite amount of time (the time of travel is the sum of length of the traveled roads) and what is the minimum number of buses he should take in the worst case.At any moment Urpal knows only his own position and the place where the date will be. When he gets on the bus he knows only the index of the company of this bus. Of course Urpal knows the city map and the the pairs (si,\xe2\x80\x89ti) for each company.Note that Urpal doesn\'t know buses velocity." "dp,graphs,shortest paths" 2600
1307F "Cow and Vacation" "Bessie is planning a vacation! In Cow-lifornia, there are n cities, with n\xe2\x88\x921 bidirectional roads connecting them. It is guaranteed that one can reach any city from any other city. Bessie is considering v possible vacation plans, with the i-th one consisting of a start city ai and destination city bi.It is known that only r of the cities have rest stops. Bessie gets tired easily, and cannot travel across more than k consecutive roads without resting. In fact, she is so desperate to rest that she may travel through the same city multiple times in order to do so.For each of the vacation plans, does there exist a way for Bessie to travel from the starting city to the destination city?" "dfs and similar,dsu,trees" 3300
1136D "Nastya Is Buying Lunch" "At the big break Nastya came to the school dining room. There are n pupils in the school, numbered from 1 to n. Unfortunately, Nastya came pretty late, so that all pupils had already stood in the queue, i.e. Nastya took the last place in the queue. Of course, it\'s a little bit sad for Nastya, but she is not going to despond because some pupils in the queue can agree to change places with some other pupils.Formally, there are some pairs u, v such that if the pupil with number u stands directly in front of the pupil with number v, Nastya can ask them and they will change places. Nastya asks you to find the maximal number of places in queue she can move forward." greedy 1800
1874G "Jellyfish and Inscryption" "Jellyfish loves playing a game called ""Inscryption"" which is played on a directed acyclic graph with n vertices and m edges. All edges a\xe2\x86\x92b satisfy a<b.You need to move from vertex 1 to vertex n along the directed edges, and then fight with the final boss.You will collect cards and props in the process.Each card has two attributes: HP and damage. If a card\'s HP is a and its damage is b, then the power of the card is a\xc3\x97b.Each prop has only one attribute: power.In addition to vertex 1 and vertex n, there are some vertices that trigger special events. The special events are:  You will get a card with a HP, and b damage.  If you have at least one card, choose one of your cards and increase its HP by x.  If you have at least one card, choose one of your cards and increase its damage by y.  You will get a prop with w power. When you get to vertex n, you can choose at most one of your cards and multiply its damage by 109.The final boss is very strong, so you want to maximize the sum of the power of all your cards and props. Find the maximum possible sum of power of all your cards and props if you play the game optimally." dp 3500
946C "String Transformation" "You are given a string s consisting of |s| small english letters.In one move you can replace any character of this string to the next character in alphabetical order (a will be replaced with b, s will be replaced with t, etc.). You cannot replace letter z with any other letter.Your target is to make some number of moves (not necessary minimal) to get string abcdefghijklmnopqrstuvwxyz (english alphabet) as a subsequence. Subsequence of the string is the string that is obtained by deleting characters at some positions. You need to print the string that will be obtained from the given string and will be contain english alphabet as a subsequence or say that it is impossible." greedy,strings 1300
1344A "Hilbert\'s Hotel" "Hilbert\'s Hotel is a very unusual hotel since the number of rooms is infinite! In fact, there is exactly one room for every integer, including zero and negative integers. Even stranger, the hotel is currently at full capacity, meaning there is exactly one guest in every room. The hotel\'s manager, David Hilbert himself, decides he wants to shuffle the guests around because he thinks this will create a vacancy (a room without a guest).For any integer k and positive integer n, let kmodn denote the remainder when k is divided by n. More formally, r=kmodn is the smallest non-negative integer such that k\xe2\x88\x92r is divisible by n. It always holds that 0\xe2\x89\xa4kmodn\xe2\x89\xa4n\xe2\x88\x921. For example, 100mod12=4 and (\xe2\x88\x921337)mod3=1.Then the shuffling works as follows. There is an array of n integers a0,a1,\xe2\x80\xa6,an\xe2\x88\x921. Then for each integer k, the guest in room k is moved to room number k+akmodn.After this shuffling process, determine if there is still exactly one guest assigned to each room. That is, there are no vacancies or rooms with multiple guests." "math,number theory,sortings" 1600
1626E "Black and White Tree" "You are given a tree consisting of n vertices. Some of the vertices (at least two) are black, all the other vertices are white.You place a chip on one of the vertices of the tree, and then perform the following operations:  let the current vertex where the chip is located is x. You choose a black vertex y, and then move the chip along the first edge on the simple path from x to y. You are not allowed to choose the same black vertex y in two operations in a row (i.\xe2\x80\x89e., for every two consecutive operations, the chosen black vertex should be different).You end your operations when the chip moves to the black vertex (if it is initially placed in a black vertex, you don\'t perform the operations at all), or when the number of performed operations exceeds 100500.For every vertex i, you have to determine if there exists a (possibly empty) sequence of operations that moves the chip to some black vertex, if the chip is initially placed on the vertex i." "dfs and similar,greedy,trees" 2400
516D "Drazil and Morning Exercise" "Drazil and Varda are the earthworm couple. They want to find a good place to bring up their children. They found a good ground containing nature hole. The hole contains many rooms, some pairs of rooms are connected by small tunnels such that earthworm can move between them.Let\'s consider rooms and small tunnels as the vertices and edges in a graph. This graph is a tree. In the other words, any pair of vertices has an unique path between them.Each room that is leaf in the graph is connected with a ground by a vertical tunnel. Here, leaf is a vertex that has only one outgoing edge in the graph.Each room is large enough only to fit one earthworm living in it. Earthworm can\'t live in a tunnel.Drazil and Varda have a plan to educate their children. They want all their children to do morning exercises immediately after getting up!When the morning is coming, all earthworm children get up in the same time, then each of them chooses the farthest path to the ground for gathering with others (these children are lazy, so they all want to do exercises as late as possible).Drazil and Varda want the difference between the time first earthworm child arrives outside and the time the last earthworm child arrives outside to be not larger than l (otherwise children will spread around the ground and it will be hard to keep them exercising together).Also, The rooms that are occupied by their children should form a connected set. In the other words, for any two rooms that are occupied with earthworm children, all rooms that lie on the path between them should be occupied with earthworm children too.How many children Drazil and Varda may have at most in order to satisfy all conditions above? Drazil and Varda want to know the answer for many different choices of l.(Drazil and Varda don\'t live in the hole with their children)" "dfs and similar,dp,dsu,trees,two pointers" 2800
859A "Declined Finalists" "This year, as in previous years, MemSQL is inviting the top 25 competitors from the Start[c]up qualification round to compete onsite for the final round. Not everyone who is eligible to compete onsite can afford to travel to the office, though. Initially the top 25 contestants are invited to come onsite. Each eligible contestant must either accept or decline the invitation. Whenever a contestant declines, the highest ranked contestant not yet invited is invited to take the place of the one that declined. This continues until 25 contestants have accepted invitations.After the qualifying round completes, you know K of the onsite finalists, as well as their qualifying ranks (which start at 1, there are no ties). Determine the minimum possible number of contestants that declined the invitation to compete onsite in the final round." greedy,implementation 800
770C "Online Courses In BSU" "Now you can take online courses in the Berland State University! Polycarp needs to pass k main online courses of his specialty to get a diploma. In total n courses are availiable for the passage.The situation is complicated by the dependence of online courses, for each course there is a list of those that must be passed before starting this online course (the list can be empty, it means that there is no limitation).Help Polycarp to pass the least number of courses in total to get the specialty (it means to pass all main and necessary courses). Write a program which prints the order of courses. Polycarp passes courses consistently, he starts the next course when he finishes the previous one. Each course can\'t be passed more than once." "*special problem,dfs and similar,graphs,implementation" 1500
1812H "Expected Twist" "This is an interactive problem.There is an array a1,a2,\xe2\x80\xa6,an of n integers hidden from you. Your task is to find the smallest element of the array.To do this, you can ask several queries. In each query, you can pick two integers l and r (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n). In return, you will be given the value of max(al,al+1,\xe2\x80\xa6,ar). In other words, you will be told the maximum value of the subarray from al to ar.Find the minimum of the array. You can ask at most 624 queries.It is guaranteed that the values a1,a2,\xe2\x80\xa6,an are chosen uniformly at random between 0 and 232\xe2\x88\x921 (inclusive)." "*special problem,interactive" -999
1874A "Jellyfish and Game" "Jellyfish has n green apples with values a1,a2,\xe2\x80\xa6,an and Gellyfish has m green apples with values b1,b2,\xe2\x80\xa6,bm.They will play a game with k rounds. For i=1,2,\xe2\x80\xa6,k in this order, they will perform the following actions:   If i is odd, Jellyfish can choose to swap one of her apples with one of Gellyfish\'s apples or do nothing.  If i is even, Gellyfish can choose to swap one of his apples with one of Jellyfish\'s apples or do nothing. Both players want to maximize the sum of the values of their apples.Since you are one of the smartest people in the world, Jellyfish wants you to tell her the final sum of the value of her apples after all k rounds of the game. Assume that both Jellyfish and Gellyfish play optimally to maximize the sum of values of their apples." "brute force,games,greedy,implementation" 1200
1910H "Sum of Digits of Sums" "You are given an array [a1,a2,\xe2\x80\xa6,an], consisting of positive integers.For every i from 1 to n, calculate n\xe2\x88\x91j=1F(ai+aj), where F(x) is the sum of digits of x." "*special problem,binary search,data structures" 2400
838B "Diverging Directions" "You are given a directed weighted graph with n nodes and 2n\xe2\x80\x89-\xe2\x80\x892 edges. The nodes are labeled from 1 to n, while the edges are labeled from 1 to 2n\xe2\x80\x89-\xe2\x80\x892. The graph\'s edges can be split into two parts.  The first n\xe2\x80\x89-\xe2\x80\x891 edges will form a rooted spanning tree, with node 1 as the root. All these edges will point away from the root.  The last n\xe2\x80\x89-\xe2\x80\x891 edges will be from node i to node 1, for all 2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n. You are given q queries. There are two types of queries  1 i w: Change the weight of the i-th edge to w  2 u v: Print the length of the shortest path between nodes u to v Given these queries, print the shortest path lengths." "data structures,dfs and similar,trees" 2100
2014F "Sheriff\'s Defense" """Why, master,"" quoth Little John, taking the bags and weighing them in his hand, ""here is the chink of gold.""The folk hero Robin Hood has been troubling Sheriff of Nottingham greatly. Sheriff knows that Robin Hood is about to attack his camps and he wants to be prepared.Sheriff of Nottingham built the camps with strategy in mind and thus there are exactly n camps numbered from 1 to n and n\xe2\x88\x921 trails, each connecting two camps. Any camp can be reached from any other camp. Each camp i has initially ai gold. As it is now, all camps would be destroyed by Robin. Sheriff can strengthen a camp by subtracting exactly c gold from each of its neighboring camps and use it to build better defenses for that camp. Strengthening a camp doesn\'t change its gold, only its neighbors\' gold. A camp can have negative gold. After Robin Hood\'s attack, all camps that have been strengthened survive the attack, all others are destroyed.What\'s the maximum gold Sheriff can keep in his surviving camps after Robin Hood\'s attack if he strengthens his camps optimally? Camp a is neighboring camp b if and only if there exists a trail connecting a and b. Only strengthened camps count towards the answer, as others are destroyed." "dfs and similar,dp,greedy,trees" 2000
1571J "Two Railroads" "There are n cities in Berland, and they are connected by two railroads \xe2\x80\x94 the Main railroad and the Auxiliary railroad. Each city has two railway stations, one connected to the Main railroad (called the Main station), and the other connected to the Auxiliary railroad.The railroads are identical in their structure. The Main railroad consists of n\xe2\x88\x921 railroad segments; the i-th railroad segment connects the Main station of the city i with the Main station of the city i+1. Similarly, the Auxiliary railroad consists of n\xe2\x88\x921 railroad segments; the i-th railroad segment connects the Auxiliary station of the city i with the Auxiliary station of the city i+1.These railroads are used to transfer different goods and resources from one city to another. In particular, the Ministry of Energetics is interested in using these railroads to transfer coal.The Ministry has estimated the following capabilities of the railroads:  for every i\xe2\x88\x88[1,n\xe2\x88\x921], at most ai tons of coal per day can be transferred from the Main station i to the Main station i+1 (only in this direction);  for every i\xe2\x88\x88[1,n\xe2\x88\x921], at most bi tons of coal per day can be transferred from the Auxiliary station i to the Auxiliary station i+1 (only in this direction);  for every i\xe2\x88\x88[1,n], at most ci tons of coal per day can be transferred from the Main station i to the Auxiliary station i, or in the opposite direction. To analyze the capacity of the whole railroad network, the Ministry requires a software that would process and answer queries of the following format:  calculate the maximum number of tons of coal that can be transferred per day from the Main station li to the Main station ri. Your task is to implement this software." "*special problem" 3000
1263E Editor "The development of a text editor is a hard problem. You need to implement an extra module for brackets coloring in text.Your editor consists of a line with infinite length and cursor, which points to the current character. Please note that it points to only one of the characters (and not between a pair of characters). Thus, it points to an index character. The user can move the cursor left or right one position. If the cursor is already at the first (leftmost) position, then it does not move left.Initially, the cursor is in the first (leftmost) character.Also, the user can write a letter or brackets (either (, or )) to the position that the cursor is currently pointing at. A new character always overwrites the old value at that position.Your editor must check, whether the current line is the correct text. Text is correct if the brackets in them form the correct bracket sequence.Formally, correct text (CT) must satisfy the following rules:   any line without brackets is CT (the line can contain whitespaces);  If the first character of the string \xe2\x80\x94 is (, the last \xe2\x80\x94 is ), and all the rest form a CT, then the whole line is a CT;  two consecutively written CT is also CT. Examples of correct texts: hello(codeforces), round, ((i)(write))edi(tor)s, ( me). Examples of incorrect texts: hello)oops(, round), ((me).The user uses special commands to work with your editor. Each command has its symbol, which must be written to execute this command.The correspondence of commands and characters is as follows:   L \xe2\x80\x94 move the cursor one character to the left (remains in place if it already points to the first character);  R \xe2\x80\x94 move the cursor one character to the right;  any lowercase Latin letter or bracket (( or )) \xe2\x80\x94 write the entered character to the position where the cursor is now. For a complete understanding, take a look at the first example and its illustrations in the note below.You are given a string containing the characters that the user entered. For the brackets coloring module\'s work, after each command you need to:  check if the current text in the editor is a correct text;  if it is, print the least number of colors that required, to color all brackets. If two pairs of brackets are nested (the first in the second or vice versa), then these pairs of brackets should be painted in different colors. If two pairs of brackets are not nested, then they can be painted in different or the same colors. For example, for the bracket sequence ()(())()() the least number of colors is 2, and for the bracket sequence (()(()())())(()) \xe2\x80\x94 is 3.Write a program that prints the minimal number of colors after processing each command." "data structures,implementation" 2100
512E "Fox And Polygon" "Fox Ciel just designed a puzzle game called ""Polygon""! It is played using triangulations of a regular n-edge polygon. The goal is to transform one triangulation to another by some tricky rules.Triangulation of an n-edge poylgon is a set of n\xe2\x80\x89-\xe2\x80\x893 diagonals satisfying the condition that no two diagonals share a common internal point.For example, the initial state of the game may look like (a) in above figure. And your goal may look like (c). In each step you can choose a diagonal inside the polygon (but not the one of edges of the polygon) and flip this diagonal. Suppose you are going to flip a diagonal a\xe2\x80\x89\xe2\x80\x93\xe2\x80\x89b. There always exist two triangles sharing a\xe2\x80\x89\xe2\x80\x93\xe2\x80\x89b as a side, let\'s denote them as a\xe2\x80\x89\xe2\x80\x93\xe2\x80\x89b\xe2\x80\x89\xe2\x80\x93\xe2\x80\x89c and a\xe2\x80\x89\xe2\x80\x93\xe2\x80\x89b\xe2\x80\x89\xe2\x80\x93\xe2\x80\x89d. As a result of this operation, the diagonal a\xe2\x80\x89\xe2\x80\x93\xe2\x80\x89b is replaced by a diagonal c\xe2\x80\x89\xe2\x80\x93\xe2\x80\x89d. It can be easily proven that after flip operation resulting set of diagonals is still a triangulation of the polygon.So in order to solve above case, you may first flip diagonal 6\xe2\x80\x89\xe2\x80\x93\xe2\x80\x893, it will be replaced by diagonal 2\xe2\x80\x89\xe2\x80\x93\xe2\x80\x894. Then you flip diagonal 6\xe2\x80\x89\xe2\x80\x93\xe2\x80\x894 and get figure (c) as result.Ciel just proved that for any starting and destination triangulations this game has a solution. She wants you to solve it in no more than 20\xe2\x80\x89000 steps for any puzzle satisfying n\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x891000." "constructive algorithms,divide and conquer" 2900
993A "Two Squares" "You are given two squares, one with sides parallel to the coordinate axes, and another one with sides at 45 degrees to the coordinate axes. Find whether the two squares intersect.The interior of the square is considered to be part of the square, i.e. if one square is completely inside another, they intersect. If the two squares only share one common point, they are also considered to intersect." geometry,implementation 1600
797E "Array Queries" "a is an array of n positive integers, all of which are not greater than n.You have to process q queries to this array. Each query is represented by two numbers p and k. Several operations are performed in each query; each operation changes p to p\xe2\x80\x89+\xe2\x80\x89ap\xe2\x80\x89+\xe2\x80\x89k. There operations are applied until p becomes greater than n. The answer to the query is the number of performed operations." "brute force,data structures,dp" 2000
605B "Lazy Student" "Student Vladislav came to his programming exam completely unprepared as usual. He got a question about some strange algorithm on a graph \xe2\x80\x94 something that will definitely never be useful in real life. He asked a girl sitting next to him to lend him some cheat papers for this questions and found there the following definition:The minimum spanning tree T of graph G is such a tree that it contains all the vertices of the original graph G, and the sum of the weights of its edges is the minimum possible among all such trees.Vladislav drew a graph with n vertices and m edges containing no loops and multiple edges. He found one of its minimum spanning trees and then wrote for each edge its weight and whether it is included in the found tree or not. Unfortunately, the piece of paper where the graph was painted is gone and the teacher is getting very angry and demands to see the original graph. Help Vladislav come up with a graph so that the information about the minimum spanning tree remains correct." "constructive algorithms,data structures,graphs" 1700
530H "Points in triangle" "You are given a set of points on a plane with positive integer coordinates. Find a triangle of minimum area with vertices in points (0,\xe2\x80\x890), (A,\xe2\x80\x890) and (0,\xe2\x80\x89B) (A and B are unknown positive integers) that contains all the given points inside it (points on the edges count towards being inside)." "*special problem,geometry" 2100
1209D "Cow and Snacks" "The legendary Farmer John is throwing a huge party, and animals from all over the world are hanging out at his house. His guests are hungry, so he instructs his cow Bessie to bring out the snacks! Moo!There are n snacks flavors, numbered with integers 1,2,\xe2\x80\xa6,n. Bessie has n snacks, one snack of each flavor. Every guest has exactly two favorite flavors. The procedure for eating snacks will go as follows:  First, Bessie will line up the guests in some way.  Then in this order, guests will approach the snacks one by one.  Each guest in their turn will eat all remaining snacks of their favorite flavor. In case no favorite flavors are present when a guest goes up, they become very sad.  Help Bessie to minimize the number of sad guests by lining the guests in an optimal way." "dfs and similar,dsu,graphs" 1700
1787E "The Harmonization of XOR" "You are given an array of exactly n numbers [1,2,3,\xe2\x80\xa6,n] along with integers k and x.Partition the array in exactly k non-empty disjoint subsequences such that the bitwise XOR of all numbers in each subsequence is x, and each number is in exactly one subsequence. Notice that there are no constraints on the length of each subsequence.A sequence a is a subsequence of a sequence b if a can be obtained from b by the deletion of several (possibly, zero or all) elements.For example, for n=15, k=6, x=7, the following scheme is valid:   [6,10,11], 6\xe2\x8a\x9510\xe2\x8a\x9511=7,  [5,12,14], 5\xe2\x8a\x9512\xe2\x8a\x9514=7,  [3,9,13], 3\xe2\x8a\x959\xe2\x8a\x9513=7,  [1,2,4], 1\xe2\x8a\x952\xe2\x8a\x954=7,  [8,15], 8\xe2\x8a\x9515=7,  [7], 7=7,  where \xe2\x8a\x95 represents the bitwise XOR operation.The following scheme is invalid, since 8, 15 do not appear:   [6,10,11], 6\xe2\x8a\x9510\xe2\x8a\x9511=7,  [5,12,14], 5\xe2\x8a\x9512\xe2\x8a\x9514=7,  [3,9,13], 3\xe2\x8a\x959\xe2\x8a\x9513=7,  [1,2,4], 1\xe2\x8a\x952\xe2\x8a\x954=7,  [7], 7=7. The following scheme is invalid, since 3 appears twice, and 1, 2 do not appear:   [6,10,11], 6\xe2\x8a\x9510\xe2\x8a\x9511=7,  [5,12,14], 5\xe2\x8a\x9512\xe2\x8a\x9514=7,  [3,9,13], 3\xe2\x8a\x959\xe2\x8a\x9513=7,  [3,4], 3\xe2\x8a\x954=7,  [8,15], 8\xe2\x8a\x9515=7,  [7], 7=7." "bitmasks,constructive algorithms,greedy,math" 2100
1271A Suits "A new delivery of clothing has arrived today to the clothing store. This delivery consists of a ties, b scarves, c vests and d jackets.The store does not sell single clothing items \xe2\x80\x94 instead, it sells suits of two types:  a suit of the first type consists of one tie and one jacket;  a suit of the second type consists of one scarf, one vest and one jacket. Each suit of the first type costs e coins, and each suit of the second type costs f coins.Calculate the maximum possible cost of a set of suits that can be composed from the delivered clothing items. Note that one item cannot be used in more than one suit (though some items may be left unused)." "brute force,greedy,math" 800
329D "The Evil Temple and the Moving Rocks" "Important: All possible tests are in the pretest, so you shouldn\'t hack on this problem. So, if you passed pretests, you will also pass the system test.You are an adventurer currently journeying inside an evil temple. After defeating a couple of weak monsters, you arrived at a square room consisting of tiles forming an n\xe2\x80\x89\xc3\x97\xe2\x80\x89n grid, surrounded entirely by walls. At the end of the room lies a door locked with evil magical forces. The following inscriptions are written on the door: The sound of clashing rocks will awaken the door! Being a very senior adventurer, you immediately realize what this means. In the room next door lies an infinite number of magical rocks. There are four types of rocks:   \'^\': this rock moves upwards;  \'<\': this rock moves leftwards;  \'>\': this rock moves rightwards;  \'v\': this rock moves downwards. To open the door, you first need to place the rocks on some of the tiles (one tile can be occupied by at most one rock). Then, you select a single rock that you have placed and activate it. The activated rock will then move in its direction until it hits another rock or hits the walls of the room (the rock will not move if something already blocks it in its chosen direction). The rock then deactivates. If it hits the walls, or if there have been already 107 events of rock becoming activated, the movements end. Otherwise, the rock that was hit becomes activated and this procedure is repeated.If a rock moves at least one cell before hitting either the wall or another rock, the hit produces a sound. The door will open once the number of produced sounds is at least x. It is okay for the rocks to continue moving after producing x sounds.The following picture illustrates the four possible scenarios of moving rocks. Moves at least one cell, then hits another rock. A sound is produced, the hit rock becomes activated.   Moves at least one cell, then hits the wall (i.e., the side of the room). A sound is produced, the movements end.   Does not move because a rock is already standing in the path. The blocking rock becomes activated, but no sounds are produced.   Does not move because the wall is in the way. No sounds are produced and the movements end.  Assume there\'s an infinite number of rocks of each type in the neighboring room. You know what to do: place the rocks and open the door!" "constructive algorithms" 2500
975C "Valhalla Siege" "Ivar the Boneless is a great leader. He is trying to capture Kattegat from Lagertha. The war has begun and wave after wave Ivar\'s warriors are falling in battle.Ivar has n warriors, he places them on a straight line in front of the main gate, in a way that the i-th warrior stands right after (i\xe2\x88\x921)-th warrior. The first warrior leads the attack.Each attacker can take up to ai arrows before he falls to the ground, where ai is the i-th warrior\'s strength.Lagertha orders her warriors to shoot ki arrows during the i-th minute, the arrows one by one hit the first still standing warrior. After all Ivar\'s warriors fall and all the currently flying arrows fly by, Thor smashes his hammer and all Ivar\'s warriors get their previous strengths back and stand up to fight again. In other words, if all warriors die in minute t, they will all be standing to fight at the end of minute t.The battle will last for q minutes, after each minute you should tell Ivar what is the number of his standing warriors." "binary search" 1400
1088A "Ehab and another construction problem" "Given an integer x, find 2 integers a and b such that:   1\xe2\x89\xa4a,b\xe2\x89\xa4x  b divides a (a is divisible by b).  a\xe2\x8b\x85b>x.  ab<x." "brute force,constructive algorithms" 800
1658E "Gojou and Matrix Game" "Marin feels exhausted after a long day of cosplay, so Gojou invites her to play a game!Marin and Gojou take turns to place one of their tokens on an n\xc3\x97n grid with Marin starting first. There are some restrictions and allowances on where to place tokens:   Apart from the first move, the token placed by a player must be more than Manhattan distance k away from the previous token placed on the matrix. In other words, if a player places a token at (x1,y1), then the token placed by the other player in the next move must be in a cell (x2,y2) satisfying |x2\xe2\x88\x92x1|+|y2\xe2\x88\x92y1|>k.  Apart from the previous restriction, a token can be placed anywhere on the matrix, including cells where tokens were previously placed by any player. Whenever a player places a token on cell (x,y), that player gets vx, y points. All values of v on the grid are distinct. You still get points from a cell even if tokens were already placed onto the cell. The game finishes when each player makes 10100 moves.Marin and Gojou will play n2 games. For each cell of the grid, there will be exactly one game where Marin places a token on that cell on her first move. Please answer for each game, if Marin and Gojou play optimally (after Marin\'s first move), who will have more points at the end? Or will the game end in a draw (both players have the same points at the end)?" "data structures,dp,games,hashing,implementation,math,number theory,sortings" 2500
1551D2 "Domino (hard version)" "The only difference between this problem and D1 is that you don\'t have to provide the way to construct the answer in D1, but you have to do it in this problem.There\'s a table of n\xc3\x97m cells (n rows and m columns). The value of n\xe2\x8b\x85m is even.A domino is a figure that consists of two cells having a common side. It may be horizontal (one of the cells is to the right of the other) or vertical (one of the cells is above the other).You need to place nm2 dominoes on the table so that exactly k of them are horizontal and all the other dominoes are vertical. The dominoes cannot overlap and must fill the whole table." "constructive algorithms,implementation,math" 2100
1676C "Most Similar Words" "You are given n words of equal length m, consisting of lowercase Latin alphabet letters. The i-th word is denoted si.In one move you can choose any position in any single word and change the letter at that position to the previous or next letter in alphabetical order. For example:  you can change \'e\' to \'d\' or to \'f\';  \'a\' can only be changed to \'b\';  \'z\' can only be changed to \'y\'. The difference between two words is the minimum number of moves required to make them equal. For example, the difference between ""best"" and ""cost"" is 1+10+0+0=11.Find the minimum difference of si and sj such that (i<j). In other words, find the minimum difference over all possible pairs of the n words." "brute force,greedy,implementation,implementation,math,strings" 800
620E "New Year Tree" "The New Year holidays are over, but Resha doesn\'t want to throw away the New Year tree. He invited his best friends Kerim and Gural to help him to redecorate the New Year tree.The New Year tree is an undirected tree with n vertices and root in the vertex 1.You should process the queries of the two types:  Change the colours of all vertices in the subtree of the vertex v to the colour c.  Find the number of different colours in the subtree of the vertex v." "bitmasks,data structures,trees" 2100
403D "Beautiful Pairs of Numbers" "The sequence of integer pairs (a1,\xe2\x80\x89b1),\xe2\x80\x89(a2,\xe2\x80\x89b2),\xe2\x80\x89...,\xe2\x80\x89(ak,\xe2\x80\x89bk) is beautiful, if the following statements are fulfilled:   1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b1\xe2\x80\x89<\xe2\x80\x89a2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b2\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89ak\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89bk\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n, where n is a given positive integer;  all numbers b1\xe2\x80\x89-\xe2\x80\x89a1, b2\xe2\x80\x89-\xe2\x80\x89a2, ..., bk\xe2\x80\x89-\xe2\x80\x89ak are distinct. For the given number n find the number of beautiful sequences of length k. As the answer can be rather large, print the remainder after dividing it by 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." combinatorics,dp 2300
720C Homework "Today Peter has got an additional homework for tomorrow. The teacher has given three integers to him: n, m and k, and asked him to mark one or more squares on a square grid of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m. The marked squares must form a connected figure, and there must be exactly k triples of marked squares that form an L-shaped tromino \xe2\x80\x94 all three squares are inside a 2\xe2\x80\x89\xc3\x97\xe2\x80\x892 square.The set of squares forms a connected figure if it is possible to get from any square to any other one if you are allowed to move from a square to any adjacent by a common side square.Peter cannot fulfill the task, so he asks you for help. Help him to create such figure." "constructive algorithms" 3100
1342B "Binary Period" "Let\'s say string s has period k if si=si+k for all i from 1 to |s|\xe2\x88\x92k (|s| means length of string s) and k is the minimum positive integer with this property.Some examples of a period: for s=""0101"" the period is k=2, for s=""0000"" the period is k=1, for s=""010"" the period is k=2, for s=""0011"" the period is k=4.You are given string t consisting only of 0\'s and 1\'s and you need to find such string s that:  String s consists only of 0\'s and 1\'s;  The length of s doesn\'t exceed 2\xe2\x8b\x85|t|;  String t is a subsequence of string s;  String s has smallest possible period among all strings that meet conditions 1\xe2\x80\x943. Let us recall that t is a subsequence of s if t can be derived from s by deleting zero or more elements (any) without changing the order of the remaining elements. For example, t=""011"" is a subsequence of s=""10101""." "constructive algorithms,strings" 1100
2029F "Palindrome Everywhere" "You are given a cycle with n vertices numbered from 0 to n\xe2\x88\x921. For each 0\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921, there is an undirected edge between vertex i and vertex ((i+1)modn) with the color ci (ci=R or B).Determine whether the following condition holds for every pair of vertices (i,j) (0\xe2\x89\xa4i<j\xe2\x89\xa4n\xe2\x88\x921): There exists a palindrome route between vertex i and vertex j. Note that the route may not be simple. Formally, there must exist a sequence p=[p0,p1,p2,\xe2\x80\xa6,pm] such that: p0=i, pm=j;  For each 0\xe2\x89\xa4x\xe2\x89\xa4m\xe2\x88\x921, either px+1=(px+1)modn or px+1=(px\xe2\x88\x921)modn;  For each 0\xe2\x89\xa4x\xe2\x89\xa4y\xe2\x89\xa4m\xe2\x88\x921 satisfying x+y=m\xe2\x88\x921, the edge between px and px+1 has the same color as the edge between py and py+1." "constructive algorithms,graphs,greedy" 2500
1984B "Large Addition" "A digit is large if it is between 5 and 9, inclusive. A positive integer is large if all of its digits are large.You are given an integer x. Can it be the sum of two large positive integers with the same number of digits?" implementation,math 1100
17C Balance "Nick likes strings very much, he likes to rotate them, sort them, rearrange characters within a string... Once he wrote a random string of characters a, b, c on a piece of paper and began to perform the following operations:   to take two adjacent characters and replace the second character with the first one,  to take two adjacent characters and replace the first character with the second one To understand these actions better, let\'s take a look at a string \xc2\xababc\xc2\xbb. All of the following strings can be obtained by performing one of the described operations on \xc2\xababc\xc2\xbb: \xc2\xabbbc\xc2\xbb, \xc2\xababb\xc2\xbb, \xc2\xabacc\xc2\xbb. Let\'s denote the frequency of a character for each of the characters a, b and c as the number of occurrences of this character in the string. For example, for string \xc2\xababc\xc2\xbb: |a| = 1, |b| = 1, |c| = 1, and for string \xc2\xabbbc\xc2\xbb: |a| = 0, |b| = 2, |c| = 1. While performing the described operations, Nick sometimes got balanced strings. Let\'s say that a string is balanced, if the frequencies of each character differ by at most 1. That is \xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|a|\xe2\x80\x89-\xe2\x80\x89|b|\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x891, \xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|a|\xe2\x80\x89-\xe2\x80\x89|c|\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x891 \xd0\xb8 \xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|b|\xe2\x80\x89-\xe2\x80\x89|c|\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x891. Would you help Nick find the number of different balanced strings that can be obtained by performing the operations described above, perhaps multiple times, on the given string s. This number should be calculated modulo 51123987." dp 2500
2007C "Dora and C++" "Dora has just learned the programming language C++!However, she has completely misunderstood the meaning of C++. She considers it as two kinds of adding operations on the array c with n elements. Dora has two integers a and b. In one operation, she can choose one of the following things to do.  Choose an integer i such that 1\xe2\x89\xa4i\xe2\x89\xa4n, and increase ci by a.  Choose an integer i such that 1\xe2\x89\xa4i\xe2\x89\xa4n, and increase ci by b. Note that a and b are constants, and they can be the same.Let\'s define a range of array d as max(di)\xe2\x88\x92min(di). For instance, the range of the array [1,2,3,4] is 4\xe2\x88\x921=3, the range of the array [5,2,8,2,2,1] is 8\xe2\x88\x921=7, and the range of the array [3,3,3] is 3\xe2\x88\x923=0.After any number of operations (possibly, 0), Dora calculates the range of the new array. You need to help Dora minimize this value, but since Dora loves exploring all by herself, you only need to tell her the minimized value." "math,number theory" 1500
1166E "The LCMs Must be Large" "Dora the explorer has decided to use her money after several years of juicy royalties to go shopping. What better place to shop than Nlogonia?There are n stores numbered from 1 to n in Nlogonia. The i-th of these stores offers a positive integer ai.Each day among the last m days Dora bought a single integer from some of the stores. The same day, Swiper the fox bought a single integer from all the stores that Dora did not buy an integer from on that day.Dora considers Swiper to be her rival, and she considers that she beat Swiper on day i if and only if the least common multiple of the numbers she bought on day i is strictly greater than the least common multiple of the numbers that Swiper bought on day i.The least common multiple (LCM) of a collection of integers is the smallest positive integer that is divisible by all the integers in the collection.However, Dora forgot the values of ai. Help Dora find out if there are positive integer values of ai such that she beat Swiper on every day. You don\'t need to find what are the possible values of ai though.Note that it is possible for some values of ai to coincide in a solution." "bitmasks,brute force,constructive algorithms,math,number theory" 2100
175E "Power Defence" "Vasya plays the Power Defence. He must pass the last level of the game. In order to do this he must kill the Main Villain, who moves in a straight line at speed 1 meter per second from the point (\xe2\x80\x89-\xe2\x80\x89\xe2\x88\x9e,\xe2\x80\x890) to the point (\xe2\x80\x89+\xe2\x80\x89\xe2\x88\x9e,\xe2\x80\x890) of the game world. In the points (x,\xe2\x80\x891) and (x,\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x891), where x is an integer number, Vasya can build towers of three types: fire-tower, electric-tower or freezing-tower. However, it is not allowed to build two towers at the same point. Towers of each type have a certain action radius and the value of damage per second (except freezing-tower). If at some point the Main Villain is in the range of action of k freezing towers then his speed is decreased by k\xe2\x80\x89+\xe2\x80\x891 times.The allowed number of towers of each type is known. It is necessary to determine the maximum possible damage we can inflict on the Main Villain.All distances in the problem are given in meters. The size of the Main Villain and the towers are so small, that they can be considered as points on the plane. The Main Villain is in the action radius of a tower if the distance between him and tower is less than or equal to the action radius of the tower." "brute force,dp,geometry,greedy" 2600
1729D "Friends and the Restaurant" "A group of n friends decide to go to a restaurant. Each of the friends plans to order meals for xi burles and has a total of yi burles (1\xe2\x89\xa4i\xe2\x89\xa4n). The friends decide to split their visit to the restaurant into several days. Each day, some group of at least two friends goes to the restaurant. Each of the friends visits the restaurant no more than once (that is, these groups do not intersect). These groups must satisfy the condition that the total budget of each group must be not less than the amount of burles that the friends in the group are going to spend at the restaurant. In other words, the sum of all xi values in the group must not exceed the sum of yi values in the group.What is the maximum number of days friends can visit the restaurant?For example, let there be n=6 friends for whom x = [8,3,9,2,4,5] and y = [5,3,1,4,5,10]. Then:   first and sixth friends can go to the restaurant on the first day. They will spend 8+5=13 burles at the restaurant, and their total budget is 5+10=15 burles. Since 15\xe2\x89\xa513, they can actually form a group.  friends with indices 2,4,5 can form a second group. They will spend 3+2+4=9 burles at the restaurant, and their total budget will be 3+4+5=12 burles (12\xe2\x89\xa59). It can be shown that they will not be able to form more groups so that each group has at least two friends and each group can pay the bill.So, the maximum number of groups the friends can split into is 2. Friends will visit the restaurant for a maximum of two days. Note that the 3-rd friend will not visit the restaurant at all.Output the maximum number of days the friends can visit the restaurant for given n, x and y." "greedy,sortings,two pointers" 1200
1242D "Number Discovery" "Ujan needs some rest from cleaning, so he started playing with infinite sequences. He has two integers n and k. He creates an infinite sequence s by repeating the following steps.  Find k smallest distinct positive integers that are not in s. Let\'s call them u1,u2,\xe2\x80\xa6,uk from the smallest to the largest.  Append u1,u2,\xe2\x80\xa6,uk and \xe2\x88\x91ki=1ui to s in this order.  Go back to the first step. Ujan will stop procrastinating when he writes the number n in the sequence s. Help him find the index of n in s. In other words, find the integer x such that sx=n. It\'s possible to prove that all positive integers are included in s only once." math 3400
1431F "Neural Network Problem" "You want to train a neural network model for your graduation work. There are n images in the dataset, the i-th image\'s size is ai bytes.You don\'t have any powerful remote servers to train this model so you have to do it on your local machine. But there is a problem: the total size of the dataset is too big for your machine, so you decided to remove some images \xe2\x80\x94 though you don\'t want to make the dataset too weak so you can remove no more than k images from it. Note that you can only remove images, you can\'t change their order.You want to remove these images optimally so you came up with a metric (you\'re a data scientist after all) that allows to measure the result of removals. Consider the array b1,b2,\xe2\x80\xa6,bm after removing at most k images (n\xe2\x88\x92k\xe2\x89\xa4m\xe2\x89\xa4n). The data from this array will be uploaded to the machine in blocks of x consecutive elements each. More precisely:  elements with indices from 1 to x (b1,b2,\xe2\x80\xa6,bx) belong to the first block;  elements with indices from x+1 to 2x (bx+1,bx+2,\xe2\x80\xa6,b2x) belong to the second block;  elements with indices from 2x+1 to 3x (b2x+1,b2x+2,\xe2\x80\xa6,b3x) belong to the third block;  and so on. There will be cnt=\xe2\x8c\x88mx\xe2\x8c\x89 blocks in total. Note that if m is not divisible by x then the last block contains less than x elements, and it\'s okay.Let w(i) be the total size of the i-th block \xe2\x80\x94 that is, the sum of sizes of images inside this block. For example, the size of the first block w(1) is b1+b2+\xe2\x80\xa6+bx, the size of the second block w(2) is bx+1+bx+2+\xe2\x80\xa6+b2x.The value of the metric you came up with is the maximum block size over the blocks of the resulting dataset. In other words, the value of the metric is cntmaxi=1w(i).You don\'t want to overload your machine too much, so you have to remove at most k images in a way that minimizes the value of the metric described above." "*special problem,binary search,greedy" 2100
1515E "Phoenix and Computers" "There are n computers in a row, all originally off, and Phoenix wants to turn all of them on. He will manually turn on computers one at a time. At any point, if computer i\xe2\x88\x921 and computer i+1 are both on, computer i (2\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921) will turn on automatically if it is not already on. Note that Phoenix cannot manually turn on a computer that already turned on automatically.If we only consider the sequence of computers that Phoenix turns on manually, how many ways can he turn on all the computers? Two sequences are distinct if either the set of computers turned on manually is distinct, or the order of computers turned on manually is distinct. Since this number may be large, please print it modulo M." combinatorics,dp,math 2200
731D "80-th Level Archeology" "Archeologists have found a secret pass in the dungeon of one of the pyramids of Cycleland. To enter the treasury they have to open an unusual lock on the door. The lock consists of n words, each consisting of some hieroglyphs. The wall near the lock has a round switch. Each rotation of this switch changes the hieroglyphs according to some rules. The instruction nearby says that the door will open only if words written on the lock would be sorted in lexicographical order (the definition of lexicographical comparison in given in notes section).The rule that changes hieroglyphs is the following. One clockwise rotation of the round switch replaces each hieroglyph with the next hieroglyph in alphabet, i.e. hieroglyph x (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89c\xe2\x80\x89-\xe2\x80\x891) is replaced with hieroglyph (x\xe2\x80\x89+\xe2\x80\x891), and hieroglyph c is replaced with hieroglyph 1.Help archeologist determine, how many clockwise rotations they should perform in order to open the door, or determine that this is impossible, i.e. no cyclic shift of the alphabet will make the sequence of words sorted lexicographically." "brute force,data structures,greedy,sortings" 2200
1276F "Asterisk Substrings" "Consider a string s of n lowercase English letters. Let ti be the string obtained by replacing the i-th character of s with an asterisk character *. For example, when s=abc, we have t1=\xe2\x88\x97bc, t2=a\xe2\x88\x97c, and t3=ab\xe2\x88\x97.Given a string s, count the number of distinct strings of lowercase English letters and asterisks that occur as a substring of at least one string in the set {s,t1,\xe2\x80\xa6,tn}. The empty string should be counted.Note that *\'s are just characters and do not play any special role as in, for example, regex matching." "string suffix structures" 3400
1151F "Sonya and Informatics" "A girl named Sonya is studying in the scientific lyceum of the Kingdom of Kremland. The teacher of computer science (Sonya\'s favorite subject!) invented a task for her.Given an array a of length n, consisting only of the numbers 0 and 1, and the number k. Exactly k times the following happens:   Two numbers i and j are chosen equiprobable such that (1\xe2\x89\xa4i<j\xe2\x89\xa4n).  The numbers in the i and j positions are swapped. Sonya\'s task is to find the probability that after all the operations are completed, the a array will be sorted in non-decreasing order. She turned to you for help. Help Sonya solve this problem.It can be shown that the desired probability is either 0 or it can be represented as PQ, where P and Q are coprime integers and Q\xe2\x89\xa20 (mod109+7)." combinatorics,dp,matrices,probabilities 2300
1987D "World is Mine" "Alice and Bob are playing a game. Initially, there are n cakes, with the i-th cake having a tastiness value of ai.Alice and Bob take turns eating them, with Alice starting first:   In her turn, Alice chooses and eats any remaining cake whose tastiness is strictly greater than the maximum tastiness of any of the cakes she\'s eaten before that. Note that on the first turn, she can choose any cake.  In his turn, Bob chooses any remaining cake and eats it. The game ends when the current player can\'t eat a suitable cake. Let x be the number of cakes that Alice ate. Then, Alice wants to maximize x, while Bob wants to minimize x.Find out how many cakes Alice will eat if both players play optimally." dp,games 1800
755E "PolandBall and White-Red graph" "PolandBall has an undirected simple graph consisting of n vertices. Unfortunately, it has no edges. The graph is very sad because of that. PolandBall wanted to make it happier, adding some red edges. Then, he will add white edges in every remaining place. Therefore, the final graph will be a clique in two colors: white and red. Colorfulness of the graph is a value min(dr,\xe2\x80\x89dw), where dr is the diameter of the red subgraph and dw is the diameter of white subgraph. The diameter of a graph is a largest value d such that shortest path between some pair of vertices in it is equal to d. If the graph is not connected, we consider its diameter to be -1.PolandBall wants the final graph to be as neat as possible. He wants the final colorfulness to be equal to k. Can you help him and find any graph which satisfies PolandBall\'s requests?" "constructive algorithms,graphs,shortest paths" 2400
777B "Game of Credit Cards" "After the fourth season Sherlock and Moriary have realized the whole foolishness of the battle between them and decided to continue their competitions in peaceful game of Credit Cards.Rules of this game are simple: each player bring his favourite n-digit credit card. Then both players name the digits written on their cards one by one. If two digits are not equal, then the player, whose digit is smaller gets a flick (knock in the forehead usually made with a forefinger) from the other player. For example, if n\xe2\x80\x89=\xe2\x80\x893, Sherlock\'s card is 123 and Moriarty\'s card has number 321, first Sherlock names 1 and Moriarty names 3 so Sherlock gets a flick. Then they both digit 2 so no one gets a flick. Finally, Sherlock names 3, while Moriarty names 1 and gets a flick.Of course, Sherlock will play honestly naming digits one by one in the order they are given, while Moriary, as a true villain, plans to cheat. He is going to name his digits in some other order (however, he is not going to change the overall number of occurences of each digit). For example, in case above Moriarty could name 1, 2, 3 and get no flicks at all, or he can name 2, 3 and 1 to give Sherlock two flicks.Your goal is to find out the minimum possible number of flicks Moriarty will get (no one likes flicks) and the maximum possible number of flicks Sherlock can get from Moriarty. Note, that these two goals are different and the optimal result may be obtained by using different strategies." "data structures,dp,greedy,sortings" 1300
464C "Substitutes in Number" "Andrew and Eugene are playing a game. Initially, Andrew has string s, consisting of digits. Eugene sends Andrew multiple queries of type ""di\xe2\x80\x89\xe2\x86\x92\xe2\x80\x89ti"", that means ""replace all digits di in string s with substrings equal to ti"". For example, if s\xe2\x80\x89=\xe2\x80\x89123123, then query ""2\xe2\x80\x89\xe2\x86\x92\xe2\x80\x8900"" transforms s to 10031003, and query ""3\xe2\x80\x89\xe2\x86\x92\xe2\x80\x89"" (""replace 3 by an empty string"") transforms it to s\xe2\x80\x89=\xe2\x80\x891212. After all the queries Eugene asks Andrew to find the remainder after division of number with decimal representation equal to s by 1000000007 (109\xe2\x80\x89+\xe2\x80\x897). When you represent s as a decimal number, please ignore the leading zeroes; also if s is an empty string, then it\'s assumed that the number equals to zero.Andrew got tired of processing Eugene\'s requests manually and he asked you to write a program for that. Help him!" dp 2100
1874C "Jellyfish and EVA" "Monsters have invaded the town again! Asuka invites her good friend, Jellyfish, to drive EVA with her.There are n cities in the town. All the monsters are in city n. Jellyfish and Asuka are currently in city 1 and need to move to city n to defeat the monsters.There are m roads. The i-th road allows one to travel from city ai to city bi. All the roads are directed. That is, one cannot travel from city bi to ai using the i-th road. Interestingly, all roads satisfy ai<bi.Driving EVA requires two people to work together. However, Asuka and Jellyfish have not done any training together before.Suppose that EVA is currently in city u. Jellyfish and Asuka will both choose an undestroyed road that starts at city u. Suppose Jellyfish and Asuka choose roads that end at cities v1 and v2 respectively. If v1=v2, EVA moves to city v1 successfully. Otherwise, EVA stays in city u and both roads that they have chosen will be destroyed.It is possible that EVA is currently in city u (u\xe2\x89\xa0n) and there are no undestroyed roads that start at city u. In that case, the mission will be a failure. Otherwise, if they reach city n in the end, the mission is considered a success.Every time they choose the roads, Jellyfish knows that Asuka will choose a road randomly. Now, Jellyfish wants to know, if she chooses the roads optimally, what is the maximum probability of the mission being successful." dp,graphs,greedy,math,probabilities 2300
1748F "Circular Xor Reversal" "You have an array a0,a1,\xe2\x80\xa6,an\xe2\x88\x921 of length n. Initially, ai=2i for all 0\xe2\x89\xa4i<n. Note that array a is zero-indexed. You want to reverse this array (that is, make ai equal to 2n\xe2\x88\x921\xe2\x88\x92i for all 0\xe2\x89\xa4i<n). To do this, you can perform the following operation no more than 250000 times:  Select an integer i (0\xe2\x89\xa4i<n) and replace ai by ai\xe2\x8a\x95a(i+1)modn. Here, \xe2\x8a\x95 denotes the bitwise XOR operation.Your task is to find any sequence of operations that will result in the array a being reversed. It can be shown that under the given constraints, a solution always exists." "bitmasks,constructive algorithms" 3000
219D "Choosing Capital for Treeland" "The country Treeland consists of n cities, some pairs of them are connected with unidirectional roads. Overall there are n\xe2\x80\x89-\xe2\x80\x891 roads in the country. We know that if we don\'t take the direction of the roads into consideration, we can get from any city to any other one.The council of the elders has recently decided to choose the capital of Treeland. Of course it should be a city of this country. The council is supposed to meet in the capital and regularly move from the capital to other cities (at this stage nobody is thinking about getting back to the capital from these cities). For that reason if city a is chosen a capital, then all roads must be oriented so that if we move along them, we can get from city a to any other city. For that some roads may have to be inversed.Help the elders to choose the capital so that they have to inverse the minimum number of roads in the country." "dfs and similar,dp,graphs,trees" 1700
576E "Painting Edges" "Note the unusual memory limit for this problem.You are given an undirected graph consisting of n vertices and m edges. The vertices are numbered with integers from 1 to n, the edges are numbered with integers from 1 to m. Each edge can be unpainted or be painted in one of the k colors, which are numbered with integers from 1 to k. Initially, none of the edges is painted in any of the colors.You get queries of the form ""Repaint edge ei to color ci"". At any time the graph formed by the edges of the same color must be bipartite. If after the repaint this condition is violated, then the query is considered to be invalid and edge ei keeps its color. Otherwise, edge ei is repainted in color ci, and the query is considered to valid.Recall that the graph is called bipartite if the set of its vertices can be divided into two parts so that no edge connected vertices of the same parts.For example, suppose you are given a triangle graph, that is a graph with three vertices and edges (1,\xe2\x80\x892), (2,\xe2\x80\x893) and (3,\xe2\x80\x891). Suppose that the first two edges are painted color 1, and the third one is painted color 2. Then the query of ""repaint the third edge in color 1"" will be incorrect because after its execution the graph formed by the edges of color 1 will not be bipartite. On the other hand, it is possible to repaint the second edge in color 2.You receive q queries. For each query, you should either apply it, and report that the query is valid, or report that the query is invalid." "binary search,data structures" 3300
1331F Elementary! "InputThe input consists of a single string of uppercase letters A-Z. The length of the string is between 1 and 10 characters, inclusive.OutputOutput ""YES"" or ""NO"".ExamplesInputCopyGENIUSOutputCopyYESInputCopyDOCTOROutputCopyNOInputCopyIRENEOutputCopyYESInputCopyMARYOutputCopyNOInputCopySMARTPHONEOutputCopyNOInputCopyREVOLVEROutputCopyYESInputCopyHOLMESOutputCopyNOInputCopyWATSONOutputCopyYES" "*special problem,brute force,dp,strings" -999
1141C "Polycarp Restores Permutation" "An array of integers p1,p2,\xe2\x80\xa6,pn is called a permutation if it contains each number from 1 to n exactly once. For example, the following arrays are permutations: [3,1,2], [1], [1,2,3,4,5] and [4,3,1,2]. The following arrays are not permutations: [2], [1,1], [2,3,4].Polycarp invented a really cool permutation p1,p2,\xe2\x80\xa6,pn of length n. It is very disappointing, but he forgot this permutation. He only remembers the array q1,q2,\xe2\x80\xa6,qn\xe2\x88\x921 of length n\xe2\x88\x921, where qi=pi+1\xe2\x88\x92pi.Given n and q=q1,q2,\xe2\x80\xa6,qn\xe2\x88\x921, help Polycarp restore the invented permutation." math 1500
985B "Switches and Lamps" "You are given n switches and m lamps. The i-th switch turns on some subset of the lamps. This information is given as the matrix a consisting of n rows and m columns where ai,\xe2\x80\x89j\xe2\x80\x89=\xe2\x80\x891 if the i-th switch turns on the j-th lamp and ai,\xe2\x80\x89j\xe2\x80\x89=\xe2\x80\x890 if the i-th switch is not connected to the j-th lamp.Initially all m lamps are turned off.Switches change state only from ""off"" to ""on"". It means that if you press two or more switches connected to the same lamp then the lamp will be turned on after any of this switches is pressed and will remain its state even if any switch connected to this lamp is pressed afterwards.It is guaranteed that if you push all n switches then all m lamps will be turned on.Your think that you have too many switches and you would like to ignore one of them. Your task is to say if there exists such a switch that if you will ignore (not use) it but press all the other n\xe2\x80\x89-\xe2\x80\x891 switches then all the m lamps will be turned on." implementation 1200
1070A "Find a Number" "You are given two positive integers d and s. Find minimal positive integer n which is divisible by d and has sum of digits equal to s." "dp,graphs,number theory,shortest paths" 2200
533C "Board Game" "Polycarp and Vasiliy love simple logical games. Today they play a game with infinite chessboard and one pawn for each player. Polycarp and Vasiliy move in turns, Polycarp starts. In each turn Polycarp can move his pawn from cell (x,\xe2\x80\x89y) to (x\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89y) or (x,\xe2\x80\x89y\xe2\x80\x89-\xe2\x80\x891). Vasiliy can move his pawn from (x,\xe2\x80\x89y) to one of cells: (x\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89y),\xe2\x80\x89(x\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89y\xe2\x80\x89-\xe2\x80\x891) and (x,\xe2\x80\x89y\xe2\x80\x89-\xe2\x80\x891). Both players are also allowed to skip move. There are some additional restrictions \xe2\x80\x94 a player is forbidden to move his pawn to a cell with negative x-coordinate or y-coordinate or to the cell containing opponent\'s pawn The winner is the first person to reach cell (0,\xe2\x80\x890). You are given the starting coordinates of both pawns. Determine who will win if both of them play optimally well." games,greedy,implementation,math 1700
1900C "Anji\'s Binary Tree" "Keksic keeps getting left on seen by Anji. Through a mutual friend, he\'s figured out that Anji really likes binary trees and decided to solve her problem in order to get her attention.Anji has given Keksic a binary tree with n vertices. Vertex 1 is the root and does not have a parent. All other vertices have exactly one parent. Each vertex can have up to 2 children, a left child, and a right child. For each vertex, Anji tells Keksic index of both its left and its right child or tells him that they do not exist. Additionally, each of the vertices has a letter si on it, which is either \'U\', \'L\' or \'R\'.Keksic begins his journey on the root, and in each move he does the following:   If the letter on his current vertex is \'U\', he moves to its parent. If it doesn\'t exist, he does nothing.  If the letter on his current vertex is \'L\', he moves to its left child. If it doesn\'t exist, he does nothing.  If the letter on his current vertex is \'R\', he moves to its right child. If it doesn\'t exist, he does nothing.  Before his journey, he can perform the following operations: choose any node, and replace the letter written on it with another one. You are interested in the minimal number of operations he needs to do before his journey, such that when he starts his journey, he will reach a leaf at some point. A leaf is a vertex that has no children. It does not matter which leaf he reaches. Note that it does not matter whether he will stay in the leaf, he just needs to move to it. Additionally, note that it does not matter how many times he needs to move before reaching a leaf.Help Keksic solve Anji\'s tree so that he can win her heart, and make her come to \xc4\x8ca\xc4\x8dak." "dfs and similar,dp,trees" 1300
1186A "Vus the Cossack and a Contest" "Vus the Cossack holds a programming competition, in which n people participate. He decided to award them all with pens and notebooks. It is known that Vus has exactly m pens and k notebooks.Determine whether the Cossack can reward all participants, giving each of them at least one pen and at least one notebook." implementation 800
914H "Ember and Storm\'s Tree Game" "Ember and Storm play a game. First, Ember picks a labelled tree T of n vertices, such that the degree of every vertex is at most d. Then, Storm picks two distinct vertices u and v in this tree and writes down the labels of the vertices in the path from u to v in a sequence a1,\xe2\x80\x89a2... ak. Finally, Ember picks any index i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89k) in the array. Now he performs one of the following two operations exactly once:  flip the subrange [i\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89k] and add ai to it. After this, the sequence becomes a1,\xe2\x80\x89... ai,\xe2\x80\x89ak\xe2\x80\x89+\xe2\x80\x89ai,\xe2\x80\x89ak\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x89ai,\xe2\x80\x89... ai\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x89ai  negate the subrange [i\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89k] and add ai to it. i.e., the array becomes a1,\xe2\x80\x89... ai,\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x89ai,\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x892\xe2\x80\x89+\xe2\x80\x89ai,\xe2\x80\x89...\xe2\x80\x89-\xe2\x80\x89ak\xe2\x80\x89+\xe2\x80\x89ai Ember wins if the array is monotonically increasing or decreasing after this. Otherwise Storm wins.The game can be described by the tuple (T,\xe2\x80\x89u,\xe2\x80\x89v,\xe2\x80\x89i,\xe2\x80\x89op) where op is \xc2\xabflip\xc2\xbb or \xc2\xabnegate\xc2\xbb depending on the action Ember chose in the last turn. Find the number of tuples that can occur if Ember and Storm play optimally. When they play optimally, if there are multiple moves by which they are guaranteed to win, then they may play any of the winning moves. Otherwise, if someone loses no matter what they play, then they may play any of the possible moves.Report the answer modulo m." combinatorics,dp,games,trees 3400
176B "Word Cut" "Let\'s consider one interesting word game. In this game you should transform one word into another through special operations. Let\'s say we have word w, let\'s split this word into two non-empty parts x and y so, that w\xe2\x80\x89=\xe2\x80\x89xy. A split operation is transforming word w\xe2\x80\x89=\xe2\x80\x89xy into word u\xe2\x80\x89=\xe2\x80\x89yx. For example, a split operation can transform word ""wordcut"" into word ""cutword"".You are given two words start and end. Count in how many ways we can transform word start into word end, if we apply exactly k split operations consecutively to word start. Two ways are considered different if the sequences of applied operations differ. Two operation sequences are different if exists such number i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k), that in the i-th operation of the first sequence the word splits into parts x and y, in the i-th operation of the second sequence the word splits into parts a and b, and additionally x\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89a holds." dp 1700
1680A "Minimums and Maximums" "An array is beautiful if both of the following two conditions meet:  there are at least l1 and at most r1 elements in the array equal to its minimum;  there are at least l2 and at most r2 elements in the array equal to its maximum. For example, the array [2,3,2,4,4,3,2] has 3 elements equal to its minimum (1-st, 3-rd and 7-th) and 2 elements equal to its maximum (4-th and 5-th).Another example: the array [42,42,42] has 3 elements equal to its minimum and 3 elements equal to its maximum.Your task is to calculate the minimum possible number of elements in a beautiful array." "brute force,math" 800
758E "Broken Tree" "You are given a tree that has n vertices, which are numbered from 1 to n, where the vertex number one is the root. Each edge has weight wi and strength pi.Botanist Innokentiy, who is the only member of the jury of the Olympiad in Informatics, doesn\'t like broken trees. The tree is broken if there is such an edge the strength of which is less than the sum of weight of subtree\'s edges to which it leads.It is allowed to reduce weight of any edge by arbitrary integer value, but then the strength of its edge is reduced by the same value. It means if the weight of the edge is 10, and the strength is 12, then by the reducing the weight by 7 its weight will equal 3, and the strength will equal 5. It is not allowed to increase the weight of the edge.Your task is to get the tree, which is not broken, by reducing the weight of edges of the given tree, and also all edged should have the positive weight, moreover, the total weight of all edges should be as large as possible.It is obvious that the strength of edges can not be negative, however it can equal zero if the weight of the subtree equals zero." "dfs and similar,dp,graphs,greedy,trees" 2600
1461C "Random Events" "Ron is a happy owner of a permutation a of length n.A permutation of length n is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array) and [1,3,4] is also not a permutation (n=3 but there is 4 in the array).  Ron\'s permutation is subjected to m experiments of the following type: (ri, pi). This means that elements in range [1,ri] (in other words, the prefix of length ri) have to be sorted in ascending order with the probability of pi. All experiments are performed in the same order in which they are specified in the input data.As an example, let\'s take a look at a permutation [4,2,1,5,3] and an experiment (3,0.6). After such an experiment with the probability of 60% the permutation will assume the form [1,2,4,5,3] and with a 40% probability it will remain unchanged.You have to determine the probability of the permutation becoming completely sorted in ascending order after m experiments." dp,math,probabilities 1500
1451A "Subtract or Divide" "Ridbit starts with an integer n.In one move, he can perform one of the following operations:   divide n by one of its proper divisors, or  subtract 1 from n if n is greater than 1. A proper divisor is a divisor of a number, excluding itself. For example, 1, 2, 4, 5, and 10 are proper divisors of 20, but 20 itself is not.What is the minimum number of moves Ridbit is required to make to reduce n to 1?" greedy,math 800
1889F "Doremy\'s Average Tree" "Doremy has a rooted tree of size nn whose root is vertex rr. Initially there is a number wiwi written on vertex ii. Doremy can use her power to perform this operation at most kk times:  Choose a vertex xx (1\xe2\x89\xa4x\xe2\x89\xa4n1\xe2\x89\xa4x\xe2\x89\xa4n).  Let s=1|T|\xe2\x88\x91i\xe2\x88\x88Twis=1|T|\xe2\x88\x91i\xe2\x88\x88Twi where TT is the set of all vertices in xx\'s subtree.  For all i\xe2\x88\x88Ti\xe2\x88\x88T, assign wi:=swi:=s. Doremy wants to know what is the lexicographically smallest\xe2\x80\xa0\xe2\x80\xa0 array ww after performing all the operations. Can you help her?If there are multiple answers, you may output any one.\xe2\x80\xa0\xe2\x80\xa0 For arrays aa and bb both of length nn, aa is lexicographically smaller than bb if and only if there exist an index ii (1\xe2\x89\xa4i\xe2\x89\xa4n1\xe2\x89\xa4i\xe2\x89\xa4n) such that ai<biai<bi and for all indices jj such that j<ij<i, aj=bjaj=bj is satisfied." "data structures,dp,greedy,trees" 3500
1315A "Dead Pixel" "Screen resolution of Polycarp\'s monitor is a\xc3\x97b pixels. Unfortunately, there is one dead pixel at his screen. It has coordinates (x,y) (0\xe2\x89\xa4x<a,0\xe2\x89\xa4y<b). You can consider columns of pixels to be numbered from 0 to a\xe2\x88\x921, and rows \xe2\x80\x94 from 0 to b\xe2\x88\x921.Polycarp wants to open a rectangular window of maximal size, which doesn\'t contain the dead pixel. The boundaries of the window should be parallel to the sides of the screen.Print the maximal area (in pixels) of a window that doesn\'t contain the dead pixel inside itself." implementation 800
1881B "Three Threadlets" "Once upon a time, bartender Decim found three threadlets and a pair of scissors.In one operation, Decim chooses any threadlet and cuts it into two threadlets, whose lengths are positive integers and their sum is equal to the length of the threadlet being cut.For example, he can cut a threadlet of length 5 into threadlets of lengths 2 and 3, but he cannot cut it into threadlets of lengths 2.5 and 2.5, or lengths 0 and 5, or lengths 3 and 4.Decim can perform at most three operations. He is allowed to cut the threadlets obtained from previous cuts. Will he be able to make all the threadlets of equal length?" math 900
1219C "Periodic integer number" "Alice became interested in periods of integer numbers. We say positive X integer number is periodic with length L if there exists positive integer number P with L digits such that X can be written as PPPP\xe2\x80\xa6P. For example:X=123123123 is periodic number with length L=3 and L=9X=42424242 is periodic number with length L=2,L=4 and L=8X=12345 is periodic number with length L=5For given positive period length L and positive integer number A, Alice wants to find smallest integer number X strictly greater than A that is periodic with length L." implementation,strings 1700
1488D "Problemsolving Marathon" "Polycarp has decided to do a problemsolving marathon. He wants to solve s problems in n days. Let ai be the number of problems he solves during the i-th day. He wants to find a distribution of problems into days such that:   ai is an integer value for all i from 1 to n;  ai\xe2\x89\xa51 for all i from 1 to n;  ai+1\xe2\x89\xa5ai for all i from 1 to n\xe2\x88\x921;  ai+1\xe2\x89\xa42\xe2\x8b\x85ai for all i from 1 to n\xe2\x88\x921;  an is maximized. Note that a1 can be arbitrarily large.What is the largest value of an Polycarp can obtain?" "*special problem,binary search,greedy" 1900
448D "Multiplication Table" "Bizon the Champion isn\'t just charming, he also is very smart.While some of us were learning the multiplication table, Bizon the Champion had fun in his own manner. Bizon the Champion painted an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m multiplication table, where the element on the intersection of the i-th row and j-th column equals i\xc2\xb7j (the rows and columns of the table are numbered starting from 1). Then he was asked: what number in the table is the k-th largest number? Bizon the Champion always answered correctly and immediately. Can you repeat his success?Consider the given multiplication table. If you write out all n\xc2\xb7m numbers from the table in the non-decreasing order, then the k-th number you write out is called the k-th largest number." "binary search,brute force" 1800
1543B "Customising the Track" "Highway 201 is the most busy street in Rockport. Traffic cars cause a lot of hindrances to races, especially when there are a lot of them. The track which passes through this highway can be divided into n sub-tracks. You are given an array a where ai represents the number of traffic cars in the i-th sub-track. You define the inconvenience of the track as n\xe2\x88\x91i=1n\xe2\x88\x91j=i+1|ai\xe2\x88\x92aj|, where |x| is the absolute value of x. You can perform the following operation any (possibly zero) number of times: choose a traffic car and move it from its current sub-track to any other sub-track.Find the minimum inconvenience you can achieve." combinatorics,greedy,math 900
1656C "Make Equal With Mod" "You are given an array of n non-negative integers a1,a2,\xe2\x80\xa6,an. You can make the following operation: choose an integer x\xe2\x89\xa52 and replace each number of the array by the remainder when dividing that number by x, that is, for all 1\xe2\x89\xa4i\xe2\x89\xa4n set ai to aimodx.Determine if it is possible to make all the elements of the array equal by applying the operation zero or more times." "constructive algorithms,math,number theory,sortings" 1200
1332G "No Monotone Triples" "Given a sequence of integers a of length n, a tuple (i,j,k) is called monotone triples if   1\xe2\x89\xa4i<j<k\xe2\x89\xa4n;  ai\xe2\x89\xa4aj\xe2\x89\xa4ak or ai\xe2\x89\xa5aj\xe2\x89\xa5ak is satisfied. For example, a=[5,3,4,5], then (2,3,4) is monotone triples for sequence a while (1,3,4) is not.Bob is given a sequence of integers a of length n in a math exam. The exams itself contains questions of form L,R, for each of them he is asked to find any subsequence b with size greater than 2 (i.e. |b|\xe2\x89\xa53) of sequence aL,aL+1,\xe2\x80\xa6,aR.Recall that an sequence b is a subsequence of sequence a if b can be obtained by deletion of several (possibly zero, or all) elements.However, he hates monotone stuff, and he wants to find a subsequence free from monotone triples. Besides, he wants to find one subsequence with the largest length among all subsequences free from monotone triples for every query.Please help Bob find out subsequences meeting the above constraints." "data structures" 3100
1197A "DIY Wooden Ladder" "Let\'s denote a k-step ladder as the following structure: exactly k+2 wooden planks, of which  two planks of length at least k+1 \xe2\x80\x94 the base of the ladder;  k planks of length at least 1 \xe2\x80\x94 the steps of the ladder; Note that neither the base planks, nor the steps planks are required to be equal.For example, ladders 1 and 3 are correct 2-step ladders and ladder 2 is a correct 1-step ladder. On the first picture the lengths of planks are [3,3] for the base and [1] for the step. On the second picture lengths are [3,3] for the base and [2] for the step. On the third picture lengths are [3,4] for the base and [2,3] for the steps.   You have n planks. The length of the i-th planks is ai. You don\'t have a saw, so you can\'t cut the planks you have. Though you have a hammer and nails, so you can assemble the improvised ""ladder"" from the planks.The question is: what is the maximum number k such that you can choose some subset of the given planks and assemble a k-step ladder using them?" greedy,math,sortings 900
1151E "Number of Components" "The Kingdom of Kremland is a tree (a connected undirected graph without cycles) consisting of n vertices. Each vertex i has its own value ai. All vertices are connected in series by edges. Formally, for every 1\xe2\x89\xa4i<n there is an edge between the vertices of i and i+1.Denote the function f(l,r), which takes two integers l and r (l\xe2\x89\xa4r):    We leave in the tree only vertices whose values \xe2\x80\x8b\xe2\x80\x8brange from l to r.    The value of the function will be the number of connected components in the new graph. Your task is to calculate the following sum: n\xe2\x88\x91l=1n\xe2\x88\x91r=lf(l,r)" "combinatorics,data structures,dp,math" 2100
1735F "Pebbles and Beads" "There are two currencies: pebbles and beads. Initially you have a pebbles, b beads.There are n days, each day you can exchange one currency for another at some exchange rate.On day i, you can exchange \xe2\x88\x92pi\xe2\x89\xa4x\xe2\x89\xa4pi pebbles for \xe2\x88\x92qi\xe2\x89\xa4y\xe2\x89\xa4qi beads or vice versa. It\'s allowed not to perform an exchange at all. Meanwhile, if you perform an exchange, the proportion x\xe2\x8b\x85qi=\xe2\x88\x92y\xe2\x8b\x85pi must be fulfilled. Fractional exchanges are allowed.You can perform no more than one such exchange in one day. The numbers of pebbles and beads you have must always remain non-negative.Please solve the following n problems independently: for each day i, output the maximum number of pebbles that you can have at the end of day i if you perform exchanges optimally." "data structures,geometry" 2900
1662N "Drone Photo" "Today, like every year at SWERC, the n2 contestants have gathered outside the venue to take a drone photo. Jennifer, the social media manager for the event, has arranged them into an n\xc3\x97n square. Being very good at her job, she knows that the contestant standing on the intersection of the i-th row with the j-th column is ai,j years old. Coincidentally, she notices that no two contestants have the same age, and that everyone is between 1 and n2 years old.Jennifer is planning to have some contestants hold a banner with the ICPC logo parallel to the ground, so that it is clearly visible in the aerial picture. Here are the steps that she is going to follow in order to take the perfect SWERC drone photo.  First of all, Jennifer is going to select four contestants standing on the vertices of an axis-aligned rectangle.  Then, she will have the two younger contestants hold one of the poles, while the two older contestants will hold the other pole.  Finally, she will unfold the banner, using the poles to support its two ends. Obviously, this can only be done if the two poles are parallel and do not cross, as shown in the pictures below.    Being very indecisive, Jennifer would like to try out all possible arrangements for the banner, but she is worried that this may cause the contestants to be late for the competition. How many different ways are there to choose the four contestants holding the poles in order to take a perfect photo? Two choices are considered different if at least one contestant is included in one but not the other." combinatorics,math,sortings -999
182A Battlefield "Vasya lagged behind at the University and got to the battlefield. Just joking! He\'s simply playing some computer game. The field is a flat platform with n trenches dug on it. The trenches are segments on a plane parallel to the coordinate axes. No two trenches intersect.There is a huge enemy laser far away from Vasya. The laser charges for a seconds, and then shoots continuously for b seconds. Then, it charges for a seconds again. Then it shoots continuously for b seconds again and so on. Vasya knows numbers a and b. He also knows that while the laser is shooting, Vasya must be in the trench, but while the laser is charging, Vasya can safely move around the field. The main thing is to have time to hide in the trench before the shot. If Vasya reaches the trench exactly at the moment when the laser starts shooting, we believe that Vasya managed to hide. Coincidentally, the length of any trench in meters numerically does not exceed b.Initially, Vasya is at point A. He needs to get to point B. Vasya moves at speed 1 meter per second in either direction. You can get in or out of the trench at any its point. Getting in or out of the trench takes no time. It is also possible to move in the trench, without leaving it.What is the minimum time Vasya needs to get from point A to point B, if at the initial time the laser has just started charging? If Vasya cannot get from point A to point B, print -1. If Vasya reaches point B at the moment when the laser begins to shoot, it is believed that Vasya managed to reach point B." "geometry,graphs,implementation,shortest paths" 2200
1988B "Make Majority" "You are given a sequence [a1,\xe2\x80\xa6,an] where each element ai is either 0 or 1. You can apply several (possibly zero) operations to the sequence. In each operation, you select two integers 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4|a| (where |a| is the current length of a) and replace [al,\xe2\x80\xa6,ar] with a single element x, where x is the majority of [al,\xe2\x80\xa6,ar].Here, the majority of a sequence consisting of 0 and 1 is defined as follows: suppose there are c0 zeros and c1 ones in the sequence, respectively.   If c0\xe2\x89\xa5c1, the majority is 0.  If c0<c1, the majority is 1. For example, suppose a=[1,0,0,0,1,1]. If we select l=1,r=2, the resulting sequence will be [0,0,0,1,1]. If we select l=4,r=6, the resulting sequence will be [1,0,0,1]. Determine if you can make a=[1] with a finite number of operations." greedy,implementation 900
776B "Sherlock and his girlfriend" "Sherlock has a new girlfriend (so unlike him!). Valentine\'s day is coming and he wants to gift her some jewelry.He bought n pieces of jewelry. The i-th piece has price equal to i\xe2\x80\x89+\xe2\x80\x891, that is, the prices of the jewelry are 2,\xe2\x80\x893,\xe2\x80\x894,\xe2\x80\x89... n\xe2\x80\x89+\xe2\x80\x891.Watson gave Sherlock a challenge to color these jewelry pieces such that two pieces don\'t have the same color if the price of one piece is a prime divisor of the price of the other piece. Also, Watson asked him to minimize the number of different colors used.Help Sherlock complete this trivial task." "constructive algorithms,number theory" 1200
1537E2 "Erase and Extend (Hard Version)" "This is the hard version of the problem. The only difference is the constraints on n and k. You can make hacks only if all versions of the problem are solved.You have a string s, and you can do two types of operations on it:   Delete the last character of the string.  Duplicate the string: s:=s+s, where + denotes concatenation. You can use each operation any number of times (possibly none).Your task is to find the lexicographically smallest string of length exactly k that can be obtained by doing these operations on string s.A string a is lexicographically smaller than a string b if and only if one of the following holds:  a is a prefix of b, but a\xe2\x89\xa0b;  In the first position where a and b differ, the string a has a letter that appears earlier in the alphabet than the corresponding letter in b." "binary search,data structures,greedy,hashing,string suffix structures,strings,two pointers" 2200
545A "Toy Cars" "Little Susie, thanks to her older brother, likes to play with cars. Today she decided to set up a tournament between them. The process of a tournament is described in the next paragraph.There are n toy cars. Each pair collides. The result of a collision can be one of the following: no car turned over, one car turned over, both cars turned over. A car is good if it turned over in no collision. The results of the collisions are determined by an n\xe2\x80\x89\xc3\x97\xe2\x80\x89n matrix \xd0\x90: there is a number on the intersection of the \xd1\x96-th row and j-th column that describes the result of the collision of the \xd1\x96-th and the j-th car:   \xe2\x80\x89-\xe2\x80\x891: if this pair of cars never collided. \xe2\x80\x89-\xe2\x80\x891 occurs only on the main diagonal of the matrix.  0: if no car turned over during the collision.  1: if only the i-th car turned over during the collision.  2: if only the j-th car turned over during the collision.  3: if both cars turned over during the collision. Susie wants to find all the good cars. She quickly determined which cars are good. Can you cope with the task?" implementation 900
1143B Nirvana "Kurt reaches nirvana when he finds the product of all the digits of some positive integer. Greater value of the product makes the nirvana deeper.Help Kurt find the maximum possible product of digits among all integers from 1 to n." "brute force,math,number theory" 1200
1343A Candies "Recently Vova found n candy wrappers. He remembers that he bought x candies during the first day, 2x candies during the second day, 4x candies during the third day, \xe2\x80\xa6, 2k\xe2\x88\x921x candies during the k-th day. But there is an issue: Vova remembers neither x nor k but he is sure that x and k are positive integers and k>1.Vova will be satisfied if you tell him any positive integer x so there is an integer k>1 that x+2x+4x+\xe2\x8b\xaf+2k\xe2\x88\x921x=n. It is guaranteed that at least one solution exists. Note that k>1.You have to answer t independent test cases." "brute force,math" 900
821B "Okabe and Banana Trees" "Okabe needs bananas for one of his experiments for some strange reason. So he decides to go to the forest and cut banana trees.Consider the point (x,\xe2\x80\x89y) in the 2D plane such that x and y are integers and 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x,\xe2\x80\x89y. There is a tree in such a point, and it has x\xe2\x80\x89+\xe2\x80\x89y bananas. There are no trees nor bananas in other points. Now, Okabe draws a line with equation . Okabe can select a single rectangle with axis aligned sides with all points on or under the line and cut all the trees in all points that are inside or on the border of this rectangle and take their bananas. Okabe\'s rectangle can be degenerate; that is, it can be a line segment or even a point.Help Okabe and find the maximum number of bananas he can get if he chooses the rectangle wisely.Okabe is sure that the answer does not exceed 1018. You can trust him." "brute force,math" 1300
645D "Robot Rapping Results Report" "While Farmer John rebuilds his farm in an unfamiliar portion of Bovinia, Bessie is out trying some alternative jobs. In her new gig as a reporter, Bessie needs to know about programming competition results as quickly as possible. When she covers the 2016 Robot Rap Battle Tournament, she notices that all of the robots operate under deterministic algorithms. In particular, robot i will beat robot j if and only if robot i has a higher skill level than robot j. And if robot i beats robot j and robot j beats robot k, then robot i will beat robot k. Since rapping is such a subtle art, two robots can never have the same skill level.Given the results of the rap battles in the order in which they were played, determine the minimum number of first rap battles that needed to take place before Bessie could order all of the robots by skill level." "binary search,dp,graphs" 1800
1077A "Frog Jumping" "A frog is currently at the point 0 on a coordinate axis Ox. It jumps by the following algorithm: the first jump is a units to the right, the second jump is b units to the left, the third jump is a units to the right, the fourth jump is b units to the left, and so on.Formally:   if the frog has jumped an even number of times (before the current jump), it jumps from its current position x to position x+a;  otherwise it jumps from its current position x to position x\xe2\x88\x92b. Your task is to calculate the position of the frog after k jumps.But... One more thing. You are watching t different frogs so you have to answer t independent queries." math 800
708B "Recover the String" "For each string s consisting of characters \'0\' and \'1\' one can define four integers a00, a01, a10 and a11, where axy is the number of subsequences of length 2 of the string s equal to the sequence {x,\xe2\x80\x89y}. In these problem you are given four integers a00, a01, a10, a11 and have to find any non-empty string s that matches them, or determine that there is no such string. One can prove that if at least one answer exists, there exists an answer of length no more than 1\xe2\x80\x89000\xe2\x80\x89000." "constructive algorithms,greedy,implementation,math" 1900
983B XOR-pyramid "For an array b of length m we define the function f as  f(b)={b[1]if m=1f(b[1]\xe2\x8a\x95b[2],b[2]\xe2\x8a\x95b[3],\xe2\x80\xa6,b[m\xe2\x88\x921]\xe2\x8a\x95b[m])otherwise, where \xe2\x8a\x95 is bitwise exclusive OR.For example, f(1,2,4,8)=f(1\xe2\x8a\x952,2\xe2\x8a\x954,4\xe2\x8a\x958)=f(3,6,12)=f(3\xe2\x8a\x956,6\xe2\x8a\x9512)=f(5,10)=f(5\xe2\x8a\x9510)=f(15)=15You are given an array a and a few queries. Each query is represented as two integers l and r. The answer is the maximum value of f on all continuous subsegments of the array al,al+1,\xe2\x80\xa6,ar." dp 1800
1310E "Strange Function" "Let\'s define the function f of multiset a as the multiset of number of occurences of every number, that is present in a.E.g., f({5,5,1,2,5,2,3,3,9,5})={1,1,2,2,4}.Let\'s define fk(a), as applying f to array a k times: fk(a)=f(fk\xe2\x88\x921(a)),f0(a)=a. E.g., f2({5,5,1,2,5,2,3,3,9,5})={1,2,2}.You are given integers n,k and you are asked how many different values the function fk(a) can have, where a is arbitrary non-empty array with numbers of size no more than n. Print the answer modulo 998244353." dp 2900
1508A "Binary Literature" "A bitstring is a string that contains only the characters 0 and 1.Koyomi Kanou is working hard towards her dream of becoming a writer. To practice, she decided to participate in the Binary Novel Writing Contest. The writing prompt for the contest consists of three bitstrings of length 2n. A valid novel for the contest is a bitstring of length at most 3n that contains at least two of the three given strings as subsequences.Koyomi has just received the three prompt strings from the contest organizers. Help her write a valid novel for the contest.A string a is a subsequence of a string b if a can be obtained from b by deletion of several (possibly, zero) characters." "constructive algorithms,greedy,implementation,strings,two pointers" 1900
294E "Shaass the Great" "The great Shaass is the new king of the Drakht empire. The empire has n cities which are connected by n\xe2\x80\x89-\xe2\x80\x891 bidirectional roads. Each road has an specific length and connects a pair of cities. There\'s a unique simple path connecting each pair of cities.His majesty the great Shaass has decided to tear down one of the roads and build another road with the same length between some pair of cities. He should build such road that it\'s still possible to travel from each city to any other city. He might build the same road again.You as his advisor should help him to find a way to make the described action. You should find the way that minimize the total sum of pairwise distances between cities after the action. So calculate the minimum sum." dp,trees 2300
1503C "Travelling Salesman Problem" "There are n cities numbered from 1 to n, and city i has beauty ai.A salesman wants to start at city 1, visit every city exactly once, and return to city 1.For all i\xe2\x89\xa0j, a flight from city i to city j costs max(ci,aj\xe2\x88\x92ai) dollars, where ci is the price floor enforced by city i. Note that there is no absolute value. Find the minimum total cost for the salesman to complete his trip." "binary search,data structures,dp,greedy,shortest paths,sortings,two pointers" 2200
409B "Mysterious Language" "You are given a mysterious language (codenamed ""Secret"") available in ""Custom Invocation"" tab. Figure out what this language is and write a program which prints its name. Note that the program must be written in this language." "*special problem" 1700
88A Chord "Vasya studies music. He has learned lots of interesting stuff. For example, he knows that there are 12 notes: C, C#, D, D#, E, F, F#, G, G#, A, B, H. He also knows that the notes are repeated cyclically: after H goes C again, and before C stands H. We will consider the C note in the row\'s beginning and the C note after the H similar and we will identify them with each other. The distance between the notes along the musical scale is measured in tones: between two consecutive notes there\'s exactly one semitone, that is, 0.5 tone. The distance is taken from the lowest tone to the uppest one, that is, the distance between C and E is 4 semitones and between E and C is 8 semitonesVasya also knows what a chord is. A chord is an unordered set of no less than three notes. However, for now Vasya only works with triads, that is with the chords that consist of exactly three notes. He can already distinguish between two types of triads \xe2\x80\x94 major and minor.Let\'s define a major triad. Let the triad consist of notes X, Y and Z. If we can order the notes so as the distance along the musical scale between X and Y equals 4 semitones and the distance between Y and Z is 3 semitones, then the triad is major. The distance between X and Z, accordingly, equals 7 semitones.A minor triad is different in that the distance between X and Y should be 3 semitones and between Y and Z \xe2\x80\x94 4 semitones.For example, the triad ""C E G"" is major: between C and E are 4 semitones, and between E and G are 3 semitones. And the triplet ""C# B F"" is minor, because if we order the notes as ""B C# F"", than between B and C# will be 3 semitones, and between C# and F \xe2\x80\x94 4 semitones.Help Vasya classify the triad the teacher has given to him." "brute force,implementation" 1200
194B Square "There is a square painted on a piece of paper, the square\'s side equals n meters. John Doe draws crosses on the square\'s perimeter. John paints the first cross in the lower left corner of the square. Then John moves along the square\'s perimeter in the clockwise direction (first upwards, then to the right, then downwards, then to the left and so on). Every time he walks (n\xe2\x80\x89+\xe2\x80\x891) meters, he draws a cross (see picture for clarifications).John Doe stops only when the lower left corner of the square has two crosses. How many crosses will John draw?   The figure shows the order in which John draws crosses for a square with side 4. The lower left square has two crosses. Overall John paints 17 crosses." math 1200
1696B "NIT Destroys the Universe" "For a collection of integers S, define mex(S) as the smallest non-negative integer that does not appear in S.NIT, the cleaver, decides to destroy the universe. He is not so powerful as Thanos, so he can only destroy the universe by snapping his fingers several times.The universe can be represented as a 1-indexed array a of length n. When NIT snaps his fingers, he does the following operation on the array:  He selects positive integers l and r such that 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n. Let w=mex({al,al+1,\xe2\x80\xa6,ar}). Then, for all l\xe2\x89\xa4i\xe2\x89\xa4r, set ai to w. We say the universe is destroyed if and only if for all 1\xe2\x89\xa4i\xe2\x89\xa4n, ai=0 holds.Find the minimum number of times NIT needs to snap his fingers to destroy the universe. That is, find the minimum number of operations NIT needs to perform to make all elements in the array equal to 0." greedy 900
1916F "Group Division" "In the 31st lyceum, there were two groups of olympiad participants: computer science and mathematics. The number of computer scientists was n1, and the number of mathematicians was n2. It is not known for certain who belonged to which group, but it is known that there were friendly connections between some pairs of people (these connections could exist between a pair of people from the same group or from different groups).The connections were so strong that even if one person is removed along with all their friendly connections, any pair of people still remains acquainted either directly or through mutual friends.\xe2\x80\xa0 More formally, two people (x,y) are acquainted in the following case: there are people a1,a2,\xe2\x80\xa6,an (1\xe2\x89\xa4ai\xe2\x89\xa4n1+n2) such that the following conditions are simultaneously met:\xe2\x88\x99 Person x is directly acquainted with a1.\xe2\x88\x99 Person an is directly acquainted with y.\xe2\x88\x99 Person ai is directly acquainted with ai+1 for any (1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921).The teachers were dissatisfied with the fact that computer scientists were friends with mathematicians and vice versa, so they decided to divide the students into two groups in such a way that the following two conditions are met:\xe2\x88\x99 There were n1 people in the computer science group, and n2 people in the mathematics group.\xe2\x88\x99 Any pair of computer scientists should be acquainted (acquaintance involving mutual friends, who must be from the same group as the people in the pair, is allowed), the same should be true for mathematicians.Help them solve this problem and find out who belongs to which group." "constructive algorithms,dfs and similar,graphs,greedy" 2900
1015C "Songs Compression" "Ivan has n songs on his phone. The size of the i-th song is ai bytes. Ivan also has a flash drive which can hold at most m bytes in total. Initially, his flash drive is empty.Ivan wants to copy all n songs to the flash drive. He can compress the songs. If he compresses the i-th song, the size of the i-th song reduces from ai to bi bytes (bi<ai).Ivan can compress any subset of the songs (possibly empty) and copy all the songs to his flash drive if the sum of their sizes is at most m. He can compress any subset of the songs (not necessarily contiguous).Ivan wants to find the minimum number of songs he needs to compress in such a way that all his songs fit on the drive (i.e. the sum of their sizes is less than or equal to m).If it is impossible to copy all the songs (even if Ivan compresses all the songs), print ""-1"". Otherwise print the minimum number of songs Ivan needs to compress." sortings 1100
280B "Maximum Xor Secondary" "Bike loves looking for the second maximum element in the sequence. The second maximum element in the sequence of distinct numbers x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xk (k\xe2\x80\x89>\xe2\x80\x891) is such maximum element xj, that the following inequality holds: .The lucky number of the sequence of distinct positive integers x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xk (k\xe2\x80\x89>\xe2\x80\x891) is the number that is equal to the bitwise excluding OR of the maximum element of the sequence and the second maximum element of the sequence.You\'ve got a sequence of distinct positive integers s1,\xe2\x80\x89s2,\xe2\x80\x89...,\xe2\x80\x89sn (n\xe2\x80\x89>\xe2\x80\x891). Let\'s denote sequence sl,\xe2\x80\x89sl\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89sr as s[l..r] (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89<\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n). Your task is to find the maximum number among all lucky numbers of sequences s[l..r].Note that as all numbers in sequence s are distinct, all the given definitions make sence." "data structures,implementation,two pointers" 1800
1439C "Greedy Shopping" "You are given an array a1,a2,\xe2\x80\xa6,an of integers. This array is non-increasing.Let\'s consider a line with n shops. The shops are numbered with integers from 1 to n from left to right. The cost of a meal in the i-th shop is equal to ai.You should process q queries of two types:  1 x y: for each shop 1\xe2\x89\xa4i\xe2\x89\xa4x set ai=max(ai,y).  2 x y: let\'s consider a hungry man with y money. He visits the shops from x-th shop to n-th and if he can buy a meal in the current shop he buys one item of it. Find how many meals he will purchase. The man can buy a meal in the shop i if he has at least ai money, and after it his money decreases by ai." "binary search,data structures,divide and conquer,greedy,implementation" 2600
1614D1 "Divan and Kostomuksha (easy version)" "This is the easy version of the problem. The only difference is maximum value of ai.Once in Kostomuksha Divan found an array a consisting of positive integers. Now he wants to reorder the elements of a to maximize the value of the following function: n\xe2\x88\x91i=1gcd(a1,a2,\xe2\x80\xa6,ai), where gcd(x1,x2,\xe2\x80\xa6,xk) denotes the greatest common divisor of integers x1,x2,\xe2\x80\xa6,xk, and gcd(x)=x for any integer x.Reordering elements of an array means changing the order of elements in the array arbitrary, or leaving the initial order.Of course, Divan can solve this problem. However, he found it interesting, so he decided to share it with you." "dp,number theory" 2100
1207C "Gas Pipeline" "You are responsible for installing a gas pipeline along a road. Let\'s consider the road (for simplicity) as a segment [0,n] on OX axis. The road can have several crossroads, but for simplicity, we\'ll denote each crossroad as an interval (x,x+1) with integer x. So we can represent the road as a binary string consisting of n characters, where character 0 means that current interval doesn\'t contain a crossroad, and 1 means that there is a crossroad.Usually, we can install the pipeline along the road on height of 1 unit with supporting pillars in each integer point (so, if we are responsible for [0,n] road, we must install n+1 pillars). But on crossroads we should lift the pipeline up to the height 2, so the pipeline won\'t obstruct the way for cars.We can do so inserting several zig-zag-like lines. Each zig-zag can be represented as a segment [x,x+1] with integer x consisting of three parts: 0.5 units of horizontal pipe + 1 unit of vertical pipe + 0.5 of horizontal. Note that if pipeline is currently on height 2, the pillars that support it should also have length equal to 2 units.  Each unit of gas pipeline costs us a bourles, and each unit of pillar \xe2\x80\x94 b bourles. So, it\'s not always optimal to make the whole pipeline on the height 2. Find the shape of the pipeline with minimum possible cost and calculate that cost.Note that you must start and finish the pipeline on height 1 and, also, it\'s guaranteed that the first and last characters of the input string are equal to 0." dp,greedy 1500
1808E1 "Minibuses on Venus (easy version)" "This is the easy version of the problem. The only difference between the three versions is the constraints on n and k. You can make hacks only if all versions of the problem are solved.Maxim is a minibus driver on Venus.To ride on Maxim\'s minibus, you need a ticket. Each ticket has a number consisting of n digits. However, as we know, the residents of Venus use a numeral system with base k, rather than the decimal system. Therefore, the ticket number can be considered as a sequence of n integers from 0 to k\xe2\x88\x921, inclusive.The residents of Venus consider a ticket to be lucky if there is a digit on it that is equal to the sum of the remaining digits, modulo k. For example, if k=10, then the ticket 7135 is lucky because 7+1+5\xe2\x89\xa13(mod10). On the other hand, the ticket 7136 is not lucky because no digit is equal to the sum of the others modulo 10.Once, while on a trip, Maxim wondered: how many lucky tickets exist? At the same time, Maxim understands that this number can be very large, so he is interested only in the answer modulo some prime number m." "combinatorics,divide and conquer,dp" 2200
1850F "We Were Both Children" "Mihai and Slavic were looking at a group of n frogs, numbered from 1 to n, all initially located at point 0. Frog i has a hop length of ai. Each second, frog i hops ai units forward. Before any frogs start hopping, Slavic and Mihai can place exactly one trap in a coordinate in order to catch all frogs that will ever pass through the corresponding coordinate.However, the children can\'t go far away from their home so they can only place a trap in the first n points (that is, in a point with a coordinate between 1 and n) and the children can\'t place a trap in point 0 since they are scared of frogs.Can you help Slavic and Mihai find out what is the maximum number of frogs they can catch using a trap?" "brute force,implementation,math,number theory" 1300
1436C "Binary Search" "Andrey thinks he is truly a successful developer, but in reality he didn\'t know about the binary search algorithm until recently. After reading some literature Andrey understood that this algorithm allows to quickly find a certain number x in an array. For an array a indexed from zero, and an integer x the pseudocode of the algorithm is as follows:  Note that the elements of the array are indexed from zero, and the division is done in integers (rounding down).Andrey read that the algorithm only works if the array is sorted. However, he found this statement untrue, because there certainly exist unsorted arrays for which the algorithm find x!Andrey wants to write a letter to the book authors, but before doing that he must consider the permutations of size n such that the algorithm finds x in them. A permutation of size n is an array consisting of n distinct integers between 1 and n in arbitrary order.Help Andrey and find the number of permutations of size n which contain x at position pos and for which the given implementation of the binary search algorithm finds x (returns true). As the result may be extremely large, print the remainder of its division by 109+7." "binary search,combinatorics" 1500
1844F1 "Min Cost Permutation (Easy Version)" "The only difference between this problem and the hard version is the constraints on t and n.You are given an array of n positive integers a1,\xe2\x80\xa6,an, and a (possibly negative) integer c.Across all permutations b1,\xe2\x80\xa6,bn of the array a1,\xe2\x80\xa6,an, consider the minimum possible value of n\xe2\x88\x921\xe2\x88\x91i=1|bi+1\xe2\x88\x92bi\xe2\x88\x92c|. Find the lexicographically smallest permutation b of the array a that achieves this minimum.A sequence x is lexicographically smaller than a sequence y if and only if one of the following holds: x is a prefix of y, but x\xe2\x89\xa0y; in the first position where x and y differ, the sequence x has a smaller element than the corresponding element in y." "brute force,constructive algorithms,greedy,math" 2600
1903F Babysitting "Theofanis wants to play video games, however he should also take care of his sister. Since Theofanis is a CS major, he found a way to do both. He will install some cameras in his house in order to make sure his sister is okay.His house is an undirected graph with n nodes and m edges. His sister likes to play at the edges of the graph, so he has to install a camera to at least one endpoint of every edge of the graph. Theofanis wants to find a vertex cover that maximizes the minimum difference between indices of the chosen nodes.More formally, let a1,a2,\xe2\x80\xa6,ak be a vertex cover of the graph. Let the minimum difference between indices of the chosen nodes be the minimum |ai\xe2\x88\x92aj| (where i\xe2\x89\xa0j) out of the nodes that you chose. If k=1 then we assume that the minimum difference between indices of the chosen nodes is n. Can you find the maximum possible minimum difference between indices of the chosen nodes over all vertex covers?" "2-sat,binary search,data structures,graphs,trees" 2500
712D "Memory and Scores" "Memory and his friend Lexa are competing to get higher score in one popular computer game. Memory starts with score a and Lexa starts with score b. In a single turn, both Memory and Lexa get some integer in the range [\xe2\x80\x89-\xe2\x80\x89k;k] (i.e. one integer among \xe2\x80\x89-\xe2\x80\x89k,\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x89k\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x89k\xe2\x80\x89+\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x892,\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x890,\xe2\x80\x891,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89k\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89k) and add them to their current scores. The game has exactly t turns. Memory and Lexa, however, are not good at this game, so they both always get a random integer at their turn.Memory wonders how many possible games exist such that he ends with a strictly higher score than Lexa. Two games are considered to be different if in at least one turn at least one player gets different score. There are (2k\xe2\x80\x89+\xe2\x80\x891)2t games in total. Since the answer can be very large, you should print it modulo 109\xe2\x80\x89+\xe2\x80\x897. Please solve this problem for Memory." combinatorics,dp,math 2200
1482F "Useful Edges" "You are given a weighted undirected graph on n vertices along with q triples (u,v,l), where in each triple u and v are vertices and l is a positive integer. An edge e is called useful if there is at least one triple (u,v,l) and a path (not necessarily simple) with the following properties:  u and v are the endpoints of this path,  e is one of the edges of this path,  the sum of weights of all edges on this path doesn\'t exceed l. Please print the number of useful edges in this graph." "graphs,shortest paths" 2400
1870H "Standard Graph Problem" "You are given a weighted directed graph with n vertices and m edges. Each vertex in the graph can be either highlighted or normal. Initially, all vertices are normal. The cost of the graph is defined as the minimum sum of edge weights that need to be selected so that from each normal vertex one can reach at least one highlighted vertex using the selected edges only. If it is not possible to select the edges, the cost is \xe2\x88\x921 instead.Your task is to compute the cost of the graph after each of the q queries. The queries can be of two types:   +vi makes vertex vi highlighted; it is guaranteed that the vertex is normal before the query.  \xe2\x88\x92vi makes vertex vi normal; it is guaranteed that the vertex is highlighted before the query. Output the cost of the graph after each of the q queries." "data structures,graphs,greedy,trees" 3500
698B "Fix a Tree" "A tree is an undirected connected graph without cycles.Let\'s consider a rooted undirected tree with n vertices, numbered 1 through n. There are many ways to represent such a tree. One way is to create an array with n integers p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pn, where pi denotes a parent of vertex i (here, for convenience a root is considered its own parent).  For this rooted tree the array p is [2,\xe2\x80\x893,\xe2\x80\x893,\xe2\x80\x892]. Given a sequence p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pn, one is able to restore a tree:  There must be exactly one index r that pr\xe2\x80\x89=\xe2\x80\x89r. A vertex r is a root of the tree.  For all other n\xe2\x80\x89-\xe2\x80\x891 vertices i, there is an edge between vertex i and vertex pi. A sequence p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pn is called valid if the described procedure generates some (any) rooted tree. For example, for n\xe2\x80\x89=\xe2\x80\x893 sequences (1,2,2), (2,3,1) and (2,1,3) are not valid.You are given a sequence a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an, not necessarily valid. Your task is to change the minimum number of elements, in order to get a valid sequence. Print the minimum number of changes and an example of a valid sequence after that number of changes. If there are many valid sequences achievable in the minimum number of changes, print any of them." "constructive algorithms,dfs and similar,dsu,graphs,trees" 1700
1844D "Row Major" "The row-major order of an r\xc3\x97c grid of characters A is the string obtained by concatenating all the rows, i.e. A11A12\xe2\x80\xa6A1cA21A22\xe2\x80\xa6A2c\xe2\x80\xa6Ar1Ar2\xe2\x80\xa6Arc.A grid of characters A is bad if there are some two adjacent cells (cells sharing an edge) with the same character.You are given a positive integer n. Consider all strings s consisting of only lowercase Latin letters such that they are not the row-major order of any bad grid. Find any string with the minimum number of distinct characters among all such strings of length n.It can be proven that at least one such string exists under the constraints of the problem." "constructive algorithms,greedy,math,number theory,strings" 1400
729C "Road to Cinema" "Vasya is currently at a car rental service, and he wants to reach cinema. The film he has bought a ticket for starts in t minutes. There is a straight road of length s from the service to the cinema. Let\'s introduce a coordinate system so that the car rental service is at the point 0, and the cinema is at the point s.There are k gas stations along the road, and at each of them you can fill a car with any amount of fuel for free! Consider that this operation doesn\'t take any time, i.e. is carried out instantly.There are n cars in the rental service, i-th of them is characterized with two integers ci and vi \xe2\x80\x94 the price of this car rent and the capacity of its fuel tank in liters. It\'s not allowed to fuel a car with more fuel than its tank capacity vi. All cars are completely fueled at the car rental service.Each of the cars can be driven in one of two speed modes: normal or accelerated. In the normal mode a car covers 1 kilometer in 2 minutes, and consumes 1 liter of fuel. In the accelerated mode a car covers 1 kilometer in 1 minutes, but consumes 2 liters of fuel. The driving mode can be changed at any moment and any number of times.Your task is to choose a car with minimum price such that Vasya can reach the cinema before the show starts, i.e. not later than in t minutes. Assume that all cars are completely fueled initially." "binary search,greedy,sortings" 1700
1983E "I Love Balls" "Alice and Bob are playing a game. There are n balls, out of which k are special. Each ball has a value associated with it. The players play turn by turn. In each turn, the player randomly picks a ball and adds the value of the ball to their score, which is 0 at the beginning of the game. The selected ball is removed from the game. If the ball was special, the same player takes the next turn if at least one ball is remaining. If the ball picked was not special, the next player plays their turn.They play this game until no balls are remaining in the game. Alice plays first.Find the expected score that both the players have at the end of the game modulo 109+7. Formally, let M=109+7. It can be shown that the answer can be expressed as an irreducible fraction pq, where p and q are integers and q\xe2\x89\xa20(modM). Output the integer equal to p\xe2\x8b\x85q\xe2\x88\x921modM. In other words, output such an integer x that 0\xe2\x89\xa4x<M and x\xe2\x8b\x85q\xe2\x89\xa1p(modM)." combinatorics,math,probabilities 2300
1093F "Vasya and Array" "Vasya has got an array consisting of n integers, and two integers k and len in addition. All numbers in the array are either between 1 and k (inclusive), or equal to \xe2\x88\x921. The array is good if there is no segment of len consecutive equal numbers.Vasya will replace each \xe2\x88\x921 with some number from 1 to k (inclusive) in such a way that the resulting array is good. Tell him the number of ways to do this replacement. Since the answer may be large, print it modulo 998244353." dp 2400
873E "Awards For Contestants" "Alexey recently held a programming contest for students from Berland. n students participated in a contest, i-th of them solved ai problems. Now he wants to award some contestants. Alexey can award the students with diplomas of three different degrees. Each student either will receive one diploma of some degree, or won\'t receive any diplomas at all. Let cntx be the number of students that are awarded with diplomas of degree x (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x893). The following conditions must hold:  For each x (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x893) cntx\xe2\x80\x89>\xe2\x80\x890;  For any two degrees x and y cntx\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x892\xc2\xb7cnty. Of course, there are a lot of ways to distribute the diplomas. Let bi be the degree of diploma i-th student will receive (or \xe2\x80\x89-\xe2\x80\x891 if i-th student won\'t receive any diplomas). Also for any x such that 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x893 let cx be the maximum number of problems solved by a student that receives a diploma of degree x, and dx be the minimum number of problems solved by a student that receives a diploma of degree x. Alexey wants to distribute the diplomas in such a way that:  If student i solved more problems than student j, then he has to be awarded not worse than student j (it\'s impossible that student j receives a diploma and i doesn\'t receive any, and also it\'s impossible that both of them receive a diploma, but bj\xe2\x80\x89<\xe2\x80\x89bi);  d1\xe2\x80\x89-\xe2\x80\x89c2 is maximum possible;  Among all ways that maximize the previous expression, d2\xe2\x80\x89-\xe2\x80\x89c3 is maximum possible;  Among all ways that correspond to the two previous conditions, d3\xe2\x80\x89-\xe2\x80\x89c\xe2\x80\x89-\xe2\x80\x891 is maximum possible, where c\xe2\x80\x89-\xe2\x80\x891 is the maximum number of problems solved by a student that doesn\'t receive any diploma (or 0 if each student is awarded with some diploma). Help Alexey to find a way to award the contestants!" "brute force,data structures,dp" 2300
1842E "Tenzing and Triangle" "There are n pairwise-distinct points and a line x+y=k on a two-dimensional plane. The i-th point is at (xi,yi). All points have non-negative coordinates and are strictly below the line. Alternatively, 0\xe2\x89\xa4xi,yi,xi+yi<k.Tenzing wants to erase all the points. He can perform the following two operations:  Draw triangle: Tenzing will choose two non-negative integers a, b that satisfy a+b<k, then all points inside the triangle formed by lines x=a, y=b and x+y=k will be erased. It can be shown that this triangle is an isosceles right triangle. Let the side lengths of the triangle be l, l and \xe2\x88\x9a2l respectively. Then, the cost of this operation is l\xe2\x8b\x85A.The blue area of the following picture describes the triangle with a=1,b=1 with cost =1\xe2\x8b\x85A.   Erase a specific point: Tenzing will choose an integer i that satisfies 1\xe2\x89\xa4i\xe2\x89\xa4n and erase the point i. The cost of this operation is ci.Help Tenzing find the minimum cost to erase all of the points." "data structures,dp,geometry,greedy,math" 2300
1713B "Optimal Reduction" "Consider an array a of n positive integers.You may perform the following operation:   select two indices l and r (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n), then  decrease all elements al,al+1,\xe2\x80\xa6,ar by 1. Let\'s call f(a) the minimum number of operations needed to change array a into an array of n zeros.Determine if for all permutations\xe2\x80\xa0 b of a, f(a)\xe2\x89\xa4f(b) is true. \xe2\x80\xa0 An array b is a permutation of an array a if b consists of the elements of a in arbitrary order. For example, [4,2,3,4] is a permutation of [3,2,4,4] while [1,2,2] is not a permutation of [1,2,3]." "constructive algorithms,sortings" 1000
1999G1 "Ruler (easy version)" "This is the easy version of the problem. The only difference between the two versions is that in this version, you can make at most 10 queries.This is an interactive problem. If you are unsure how interactive problems work, then it is recommended to read the guide for participants.We have a secret ruler that is missing one number x (2\xe2\x89\xa4x\xe2\x89\xa4999). When you measure an object of length y, the ruler reports the following values:   If y<x, the ruler (correctly) measures the object as having length y.  If y\xe2\x89\xa5x, the ruler incorrectly measures the object as having length y+1.  The ruler above is missing the number 4, so it correctly measures the first segment as length 3 but incorrectly measures the second segment as length 6 even though it is actually 5. You need to find the value of x. To do that, you can make queries of the following form:  ? a b \xe2\x80\x94 in response, we will measure the side lengths of an a\xc3\x97b rectangle with our ruler and multiply the results, reporting the measured area of the rectangle back to you. For example, if x=4 and you query a 3\xc3\x975 rectangle, we will measure its side lengths as 3\xc3\x976 and report 18 back to you. Find the value of x. You can ask at most 10 queries." "binary search,interactive" 1500
1876A "Helmets in Night Light" "Pak Chanek is the chief of a village named Khuntien. On one night filled with lights, Pak Chanek has a sudden and important announcement that needs to be notified to all of the n residents in Khuntien.First, Pak Chanek shares the announcement directly to one or more residents with a cost of p for each person. After that, the residents can share the announcement to other residents using a magical helmet-shaped device. However, there is a cost for using the helmet-shaped device. For each i, if the i-th resident has got the announcement at least once (either directly from Pak Chanek or from another resident), he/she can share the announcement to at most ai other residents with a cost of bi for each share.If Pak Chanek can also control how the residents share the announcement to other residents, what is the minimum cost for Pak Chanek to notify all n residents of Khuntien about the announcement?" greedy,sortings 1000
1461D "Divide and Summarize" "Mike received an array a of length n as a birthday present and decided to test how pretty it is.An array would pass the i-th prettiness test if there is a way to get an array with a sum of elements totaling si, using some number (possibly zero) of slicing operations.  An array slicing operation is conducted in the following way:   assume mid=\xe2\x8c\x8amax(array)+min(array)2\xe2\x8c\x8b, where max and min \xe2\x80\x94 are functions that find the maximum and the minimum array elements. In other words, mid is the sum of the maximum and the minimum element of array divided by 2 rounded down.  Then the array is split into two parts left and right. The left array contains all elements which are less than or equal mid, and the right array contains all elements which are greater than mid. Elements in left and right keep their relative order from array.  During the third step we choose which of the left and right arrays we want to keep. The chosen array replaces the current one and the other is permanently discarded. You need to help Mike find out the results of q prettiness tests.Note that you test the prettiness of the array a, so you start each prettiness test with the primordial (initial) array a. Thus, the first slice (if required) is always performed on the array a." "binary search,brute force,data structures,divide and conquer,implementation,sortings" 1600
622F "The Sum of the k-th Powers" "There are well-known formulas: , , . Also mathematicians found similar formulas for higher degrees.Find the value of the sum  modulo 109\xe2\x80\x89+\xe2\x80\x897 (so you should find the remainder after dividing the answer by the value 109\xe2\x80\x89+\xe2\x80\x897)." math 2600
1515G "Phoenix and Odometers" "In Fire City, there are n intersections and m one-way roads. The i-th road goes from intersection ai to bi and has length li miles. There are q cars that may only drive along those roads. The i-th car starts at intersection vi and has an odometer that begins at si, increments for each mile driven, and resets to 0 whenever it reaches ti. Phoenix has been tasked to drive cars along some roads (possibly none) and return them to their initial intersection with the odometer showing 0.For each car, please find if this is possible. A car may visit the same road or intersection an arbitrary number of times. The odometers don\'t stop counting the distance after resetting, so odometers may also be reset an arbitrary number of times." "dfs and similar,graphs,math,number theory" 2700
1165A Remainder "You are given a huge decimal number consisting of n digits. It is guaranteed that this number has no leading zeros. Each digit of this number is either 0 or 1.You may perform several (possibly zero) operations with this number. During each operation you are allowed to change any digit of your number; you may change 0 to 1 or 1 to 0. It is possible that after some operation you can obtain a number with leading zeroes, but it does not matter for this problem.You are also given two integers 0\xe2\x89\xa4y<x<n. Your task is to calculate the minimum number of operations you should perform to obtain the number that has remainder 10y modulo 10x. In other words, the obtained number should have remainder 10y when divided by 10x." implementation,math 1100
845E "Fire in the City" "The capital of Berland looks like a rectangle of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m of the square blocks of same size.Fire!It is known that k\xe2\x80\x89+\xe2\x80\x891 blocks got caught on fire (k\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xc2\xb7m). Those blocks are centers of ignition. Moreover positions of k of these centers are known and one of these stays unknown. All k\xe2\x80\x89+\xe2\x80\x891 positions are distinct.The fire goes the following way: during the zero minute of fire only these k\xe2\x80\x89+\xe2\x80\x891 centers of ignition are burning. Every next minute the fire goes to all neighbouring blocks to the one which is burning. You can consider blocks to burn for so long that this time exceeds the time taken in the problem. The neighbouring blocks are those that touch the current block by a side or by a corner.Berland Fire Deparment wants to estimate the minimal time it takes the fire to lighten up the whole city. Remember that the positions of k blocks (centers of ignition) are known and (k\xe2\x80\x89+\xe2\x80\x891)-th can be positioned in any other block.Help Berland Fire Department to estimate the minimal time it takes the fire to lighten up the whole city." "binary search,data structures" 2400
1076G "Array Game" "Consider a following game between two players:There is an array b1, b2, ..., bk, consisting of positive integers. Initially a chip is placed into the first cell of the array, and b1 is decreased by 1. Players move in turns. Each turn the current player has to do the following: if the index of the cell where the chip is currently placed is x, then he or she has to choose an index y\xe2\x88\x88[x,min(k,x+m)] such that by>0, move the chip to the cell y and decrease by by 1. If it\'s impossible to make a valid move, the current player loses the game.Your task is the following: you are given an array a consisting of n positive integers, and q queries to it. There are two types of queries: 1 l r d \xe2\x80\x94 for every i\xe2\x88\x88[l,r] increase ai by d;  2 l r \xe2\x80\x94 tell who is the winner of the game that is played on the subarray of a from index l to index r inclusive. Assume both players choose an optimal strategy." "data structures,games" 3000
1513E "Cost Equilibrium" "An array is called beautiful if all the elements in the array are equal.You can transform an array using the following steps any number of times:   Choose two indices i and j (1\xe2\x89\xa4i,j\xe2\x89\xa4n), and an integer x (1\xe2\x89\xa4x\xe2\x89\xa4ai). Let i be the source index and j be the sink index.  Decrease the i-th element by x, and increase the j-th element by x. The resulting values at i-th and j-th index are ai\xe2\x88\x92x and aj+x respectively.  The cost of this operation is x\xe2\x8b\x85|j\xe2\x88\x92i|.  Now the i-th index can no longer be the sink and the j-th index can no longer be the source.  The total cost of a transformation is the sum of all the costs in step 3.For example, array [0,2,3,3] can be transformed into a beautiful array [2,2,2,2] with total cost 1\xe2\x8b\x85|1\xe2\x88\x923|+1\xe2\x8b\x85|1\xe2\x88\x924|=5.An array is called balanced, if it can be transformed into a beautiful array, and the cost of such transformation is uniquely defined. In other words, the minimum cost of transformation into a beautiful array equals the maximum cost.You are given an array a1,a2,\xe2\x80\xa6,an of length n, consisting of non-negative integers. Your task is to find the number of balanced arrays which are permutations of the given array. Two arrays are considered different, if elements at some position differ. Since the answer can be large, output it modulo 109+7." "combinatorics,constructive algorithms,math,sortings" 2300
196B "Infinite Maze" "We\'ve got a rectangular n\xe2\x80\x89\xc3\x97\xe2\x80\x89m-cell maze. Each cell is either passable, or is a wall (impassable). A little boy found the maze and cyclically tiled a plane with it so that the plane became an infinite maze. Now on this plane cell (x,\xe2\x80\x89y) is a wall if and only if cell  is a wall.In this problem  is a remainder of dividing number a by number b.The little boy stood at some cell on the plane and he wondered whether he can walk infinitely far away from his starting position. From cell (x,\xe2\x80\x89y) he can go to one of the following cells: (x,\xe2\x80\x89y\xe2\x80\x89-\xe2\x80\x891), (x,\xe2\x80\x89y\xe2\x80\x89+\xe2\x80\x891), (x\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89y) and (x\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89y), provided that the cell he goes to is not a wall." "dfs and similar,graphs" 2000
1612F "Armor and Weapons" "Monocarp plays a computer game. There are n different sets of armor and m different weapons in this game. If a character equips the i-th set of armor and wields the j-th weapon, their power is usually equal to i+j; but some combinations of armor and weapons synergize well. Formally, there is a list of q ordered pairs, and if the pair (i,j) belongs to this list, the power of the character equipped with the i-th set of armor and wielding the j-th weapon is not i+j, but i+j+1.Initially, Monocarp\'s character has got only the 1-st armor set and the 1-st weapon. Monocarp can obtain a new weapon or a new set of armor in one hour. If he wants to obtain the k-th armor set or the k-th weapon, he must possess a combination of an armor set and a weapon that gets his power to k or greater. Of course, after Monocarp obtains a weapon or an armor set, he can use it to obtain new armor sets or weapons, but he can go with any of the older armor sets and/or weapons as well.Monocarp wants to obtain the n-th armor set and the m-th weapon. What is the minimum number of hours he has to spend on it?" "brute force,dp,greedy,shortest paths" 2800
1335C "Two Teams Composing" "You have n students under your control and you have to compose exactly two teams consisting of some subset of your students. Each student had his own skill, the i-th student skill is denoted by an integer ai (different students can have the same skills).So, about the teams. Firstly, these two teams should have the same size. Two more constraints:  The first team should consist of students with distinct skills (i.e. all skills in the first team are unique).  The second team should consist of students with the same skills (i.e. all skills in the second team are equal). Note that it is permissible that some student of the first team has the same skill as a student of the second team.Consider some examples (skills are given):  [1,2,3], [4,4] is not a good pair of teams because sizes should be the same;  [1,1,2], [3,3,3] is not a good pair of teams because the first team should not contain students with the same skills;  [1,2,3], [3,4,4] is not a good pair of teams because the second team should contain students with the same skills;  [1,2,3], [3,3,3] is a good pair of teams;  [5], [6] is a good pair of teams. Your task is to find the maximum possible size x for which it is possible to compose a valid pair of teams, where each team size is x (skills in the first team needed to be unique, skills in the second team should be the same between them). A student cannot be part of more than one team.You have to answer t independent test cases." "binary search,greedy,implementation,sortings" 1100
702A "Maximum Increase" "You are given array consisting of n integers. Your task is to find the maximum length of an increasing subarray of the given array.A subarray is the sequence of consecutive elements of the array. Subarray is called increasing if each element of this subarray strictly greater than previous." dp,greedy,implementation 800
979E "Kuro and Topological Parity" "Kuro has recently won the ""Most intelligent cat ever"" contest. The three friends then decided to go to Katie\'s home to celebrate Kuro\'s winning. After a big meal, they took a small break then started playing games.Kuro challenged Katie to create a game with only a white paper, a pencil, a pair of scissors and a lot of arrows (you can assume that the number of arrows is infinite). Immediately, Katie came up with the game called Topological Parity.The paper is divided into n pieces enumerated from 1 to n. Shiro has painted some pieces with some color. Specifically, the i-th piece has color ci where ci=0 defines black color, ci=1 defines white color and ci=\xe2\x88\x921 means that the piece hasn\'t been colored yet.The rules of the game is simple. Players must put some arrows between some pairs of different pieces in such a way that for each arrow, the number in the piece it starts from is less than the number of the piece it ends at. Also, two different pieces can only be connected by at most one arrow. After that the players must choose the color (0 or 1) for each of the unpainted pieces. The score of a valid way of putting the arrows and coloring pieces is defined as the number of paths of pieces of alternating colors. For example, [1\xe2\x86\x920\xe2\x86\x921\xe2\x86\x920], [0\xe2\x86\x921\xe2\x86\x920\xe2\x86\x921], [1], [0] are valid paths and will be counted. You can only travel from piece x to piece y if and only if there is an arrow from x to y.But Kuro is not fun yet. He loves parity. Let\'s call his favorite parity p where p=0 stands for ""even"" and p=1 stands for ""odd"". He wants to put the arrows and choose colors in such a way that the score has the parity of p.It seems like there will be so many ways which satisfy Kuro. He wants to count the number of them but this could be a very large number. Let\'s help him with his problem, but print it modulo 109+7." dp 2400
698A Vacations "Vasya has n days of vacations! So he decided to improve his IT skills and do sport. Vasya knows the following information about each of this n days: whether that gym opened and whether a contest was carried out in the Internet on that day. For the i-th day there are four options:  on this day the gym is closed and the contest is not carried out;  on this day the gym is closed and the contest is carried out;  on this day the gym is open and the contest is not carried out;  on this day the gym is open and the contest is carried out. On each of days Vasya can either have a rest or write the contest (if it is carried out on this day), or do sport (if the gym is open on this day).Find the minimum number of days on which Vasya will have a rest (it means, he will not do sport and write the contest at the same time). The only limitation that Vasya has \xe2\x80\x94 he does not want to do the same activity on two consecutive days: it means, he will not do sport on two consecutive days, and write the contest on two consecutive days." dp 1400
1382A "Common Subsequence" "You are given two arrays of integers a1,\xe2\x80\xa6,an and b1,\xe2\x80\xa6,bm.Your task is to find a non-empty array c1,\xe2\x80\xa6,ck that is a subsequence of a1,\xe2\x80\xa6,an, and also a subsequence of b1,\xe2\x80\xa6,bm. If there are multiple answers, find one of the smallest possible length. If there are still multiple of the smallest possible length, find any. If there are no such arrays, you should report about it.A sequence a is a subsequence of a sequence b if a can be obtained from b by deletion of several (possibly, zero) elements. For example, [3,1] is a subsequence of [3,2,1] and [4,3,1], but not a subsequence of [1,3,3,7] and [3,10,4]." "brute force" 800
1923D Slimes "There are n slimes placed in a line. The slimes are numbered from 1 to n in order from left to right. The size of the i-th slime is ai.Every second, the following happens: exactly one slime eats one of its neighbors and increases its size by the eaten neighbor\'s size. A slime can eat its neighbor only if it is strictly bigger than this neighbor. If there is no slime which is strictly bigger than one of its neighbors, the process ends.For example, suppose n=5, a=[2,2,3,1,4]. The process can go as follows:  first, the 3-rd slime eats the 2-nd slime. The size of the 3-rd slime becomes 5, the 2-nd slime is eaten.  then, the 3-rd slime eats the 1-st slime (they are neighbors since the 2-nd slime is already eaten). The size of the 3-rd slime becomes 7, the 1-st slime is eaten.  then, the 5-th slime eats the 4-th slime. The size of the 5-th slime becomes 5, the 4-th slime is eaten.  then, the 3-rd slime eats the 5-th slime (they are neighbors since the 4-th slime is already eaten). The size of the 3-rd slime becomes 12, the 5-th slime is eaten. For each slime, calculate the minimum number of seconds it takes for this slime to be eaten by another slime (among all possible ways the process can go), or report that it is impossible." "binary search,constructive algorithms,data structures,greedy,two pointers" 1800
1238A "Prime Subtraction" "You are given two integers x and y (it is guaranteed that x>y). You may choose any prime integer p and subtract it any number of times from x. Is it possible to make x equal to y?Recall that a prime number is a positive integer that has exactly two positive divisors: 1 and this integer itself. The sequence of prime numbers starts with 2, 3, 5, 7, 11.Your program should solve t independent test cases." "math,number theory" 900
1142B "Lynyrd Skynyrd" "Recently Lynyrd and Skynyrd went to a shop where Lynyrd bought a permutation p of length n, and Skynyrd bought an array a of length m, consisting of integers from 1 to n. Lynyrd and Skynyrd became bored, so they asked you q queries, each of which has the following form: ""does the subsegment of a from the l-th to the r-th positions, inclusive, have a subsequence that is a cyclic shift of p?"" Please answer the queries.A permutation of length n is a sequence of n integers such that each integer from 1 to n appears exactly once in it.A cyclic shift of a permutation (p1,p2,\xe2\x80\xa6,pn) is a permutation (pi,pi+1,\xe2\x80\xa6,pn,p1,p2,\xe2\x80\xa6,pi\xe2\x88\x921) for some i from 1 to n. For example, a permutation (2,1,3) has three distinct cyclic shifts: (2,1,3), (1,3,2), (3,2,1).A subsequence of a subsegment of array a from the l-th to the r-th positions, inclusive, is a sequence ai1,ai2,\xe2\x80\xa6,aik for some i1,i2,\xe2\x80\xa6,ik such that l\xe2\x89\xa4i1<i2<\xe2\x80\xa6<ik\xe2\x89\xa4r." "data structures,dfs and similar,dp,math,trees" 2000
627F "Island Puzzle" "A remote island chain contains n islands, with some bidirectional bridges between them. The current bridge network forms a tree. In other words, a total of n\xe2\x80\x89-\xe2\x80\x891 bridges connect pairs of islands in a way that it\'s possible to reach any island from any other island using the bridge network. The center of each island contains an identical pedestal, and all but one of the islands has a fragile, uniquely colored statue currently held on the pedestal. The remaining island holds only an empty pedestal.The islanders want to rearrange the statues in a new order. To do this, they repeat the following process: first, they choose an island directly adjacent to the island containing an empty pedestal. Then, they painstakingly carry the statue on this island across the adjoining bridge and place it on the empty pedestal.It is often impossible to rearrange statues in the desired order using only the operation described above. The islanders would like to build one additional bridge in order to make this achievable in the fewest number of movements possible. Find the bridge to construct and the minimum number of statue movements necessary to arrange the statues in the desired position." "dfs and similar,dsu,graphs,trees" 3400
435C Cardiogram "In this problem, your task is to use ASCII graphics to paint a cardiogram. A cardiogram is a polyline with the following corners:That is, a cardiogram is fully defined by a sequence of positive integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an.Your task is to paint a cardiogram by given sequence ai." implementation 1600
1354A "Alarm Clock" "Polycarp has spent the entire day preparing problems for you. Now he has to sleep for at least a minutes to feel refreshed.Polycarp can only wake up by hearing the sound of his alarm. So he has just fallen asleep and his first alarm goes off in b minutes.Every time Polycarp wakes up, he decides if he wants to sleep for some more time or not. If he\'s slept for less than a minutes in total, then he sets his alarm to go off in c minutes after it is reset and spends d minutes to fall asleep again. Otherwise, he gets out of his bed and proceeds with the day.If the alarm goes off while Polycarp is falling asleep, then he resets his alarm to go off in another c minutes and tries to fall asleep for d minutes again.You just want to find out when will Polycarp get out of his bed or report that it will never happen.Please check out the notes for some explanations of the example." math 900
1904F "Beautiful Tree" "Lunchbox has a tree of size n rooted at node 1. Each node is then assigned a value. Lunchbox considers the tree to be beautiful if each value is distinct and ranges from 1 to n. In addition, a beautiful tree must also satisfy m requirements of 2 types:  ""1 a b c"" \xe2\x80\x94 The node with the smallest value on the path between nodes a and b must be located at c.  ""2 a b c"" \xe2\x80\x94 The node with the largest value on the path between nodes a and b must be located at c. Now, you must assign values to each node such that the resulting tree is beautiful. If it is impossible to do so, output \xe2\x88\x921." "data structures,dfs and similar,graphs,implementation,trees" 2800
743B "Chloe and the sequence" "Chloe, the same as Vladik, is a competitive programmer. She didn\'t have any problems to get to the olympiad like Vladik, but she was confused by the task proposed on the olympiad.Let\'s consider the following algorithm of generating a sequence of integers. Initially we have a sequence consisting of a single element equal to 1. Then we perform (n\xe2\x80\x89-\xe2\x80\x891) steps. On each step we take the sequence we\'ve got on the previous step, append it to the end of itself and insert in the middle the minimum positive integer we haven\'t used before. For example, we get the sequence [1,\xe2\x80\x892,\xe2\x80\x891] after the first step, the sequence [1,\xe2\x80\x892,\xe2\x80\x891,\xe2\x80\x893,\xe2\x80\x891,\xe2\x80\x892,\xe2\x80\x891] after the second step.The task is to find the value of the element with index k (the elements are numbered from 1) in the obtained sequence, i. e. after (n\xe2\x80\x89-\xe2\x80\x891) steps.Please help Chloe to solve the problem!" "binary search,bitmasks,constructive algorithms,implementation" 1200
1976B Increase/Decrease/Copy "You are given two integer arrays: array a of length n and array b of length n+1.You can perform the following operations any number of times in any order:   choose any element of the array a and increase it by 1;  choose any element of the array a and decrease it by 1;  choose any element of the array a, copy it and append the copy to the end of the array a. Your task is to calculate the minimum number of aforementioned operations (possibly zero) required to transform the array a into the array b. It can be shown that under the constraints of the problem, it is always possible." greedy,implementation 1100
671B "Robin Hood" "We all know the impressive story of Robin Hood. Robin Hood uses his archery skills and his wits to steal the money from rich, and return it to the poor.There are n citizens in Kekoland, each person has ci coins. Each day, Robin Hood will take exactly 1 coin from the richest person in the city and he will give it to the poorest person (poorest person right after taking richest\'s 1 coin). In case the choice is not unique, he will select one among them at random. Sadly, Robin Hood is old and want to retire in k days. He decided to spend these last days with helping poor people. After taking his money are taken by Robin Hood richest person may become poorest person as well, and it might even happen that Robin Hood will give his money back. For example if all people have same number of coins, then next day they will have same number of coins too. Your task is to find the difference between richest and poorest persons wealth after k days. Note that the choosing at random among richest and poorest doesn\'t affect the answer." "binary search,greedy" 2000
592E BCPC "BCPC stands for Byteforces Collegiate Programming Contest, and is the most famous competition in Byteforces.BCPC is a team competition. Each team is composed by a coach and three contestants. Blenda is the coach of the Bit State University(BSU), and she is very strict selecting the members of her team.  In BSU there are n students numbered from 1 to n. Since all BSU students are infinitely smart, the only important parameters for Blenda are their reading and writing speed. After a careful measuring, Blenda have found that the i-th student have a reading speed equal to ri (words per minute), and a writing speed of wi (symbols per minute). Since BSU students are very smart, the measured speeds are sometimes very big and Blenda have decided to subtract some constant value c from all the values of reading speed and some value d from all the values of writing speed. Therefore she considers ri\'\xe2\x80\x89=\xe2\x80\x89ri\xe2\x80\x89-\xe2\x80\x89c and wi\'\xe2\x80\x89=\xe2\x80\x89wi\xe2\x80\x89-\xe2\x80\x89d. The student i is said to overwhelm the student j if and only if ri\'\xc2\xb7wj\'\xe2\x80\x89>\xe2\x80\x89rj\'\xc2\xb7wi\'. Blenda doesn\xe2\x80\x99t like fights in teams, so she thinks that a team consisting of three distinct students i,\xe2\x80\x89j and k is good if i overwhelms j, j overwhelms k, and k overwhelms i. Yes, the relation of overwhelming is not transitive as it often happens in real life.Since Blenda is busy preparing a training camp in Codeforces, you are given a task to calculate the number of different good teams in BSU. Two teams are considered to be different if there is at least one student that is present in one team but is not present in the other. In other words, two teams are different if the sets of students that form these teams are different." "binary search,geometry,two pointers" 2700
594E "Cutting the Line" "You are given a non-empty line s and an integer k. The following operation is performed with this line exactly once:  A line is split into at most k non-empty substrings, i.e. string s is represented as a concatenation of a set of strings s\xe2\x80\x89=\xe2\x80\x89t1\xe2\x80\x89+\xe2\x80\x89t2\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89tm, 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k.  Some of strings ti are replaced by strings tir, that is, their record from right to left.  The lines are concatenated back in the same order, we get string s\'\xe2\x80\x89=\xe2\x80\x89t\'1t\'2... t\'m, where t\'i equals ti or tir. Your task is to determine the lexicographically smallest string that could be the result of applying the given operation to the string s." "string suffix structures,strings" 3100
1841D "Pairs of Segments" "Two segments [l1,r1] and [l2,r2] intersect if there exists at least one x such that l1\xe2\x89\xa4x\xe2\x89\xa4r1 and l2\xe2\x89\xa4x\xe2\x89\xa4r2.An array of segments [[l1,r1],[l2,r2],\xe2\x80\xa6,[lk,rk]] is called beautiful if k is even, and is possible to split the elements of this array into k2 pairs in such a way that:  every element of the array belongs to exactly one of the pairs;  segments in each pair intersect with each other;  segments in different pairs do not intersect. For example, the array [[2,4],[9,12],[2,4],[7,7],[10,13],[6,8]] is beautiful, since it is possible to form 3 pairs as follows:  the first element of the array (segment [2,4]) and the third element of the array (segment [2,4]);  the second element of the array (segment [9,12]) and the fifth element of the array (segment [10,13]);  the fourth element of the array (segment [7,7]) and the sixth element of the array (segment [6,8]). As you can see, the segments in each pair intersect, and no segments from different pairs intersect.You are given an array of n segments [[l1,r1],[l2,r2],\xe2\x80\xa6,[ln,rn]]. You have to remove the minimum possible number of elements from this array so that the resulting array is beautiful." "data structures,greedy,sortings,two pointers" 2000
903C "Boxes Packing" "Mishka has got n empty boxes. For every i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n), i-th box is a cube with side length ai.Mishka can put a box i into another box j if the following conditions are met:  i-th box is not put into another box;  j-th box doesn\'t contain any other boxes;  box i is smaller than box j (ai\xe2\x80\x89<\xe2\x80\x89aj). Mishka can put boxes into each other an arbitrary number of times. He wants to minimize the number of visible boxes. A box is called visible iff it is not put into some another box.Help Mishka to determine the minimum possible number of visible boxes!" greedy 1200
1118A "Water Buying" "Polycarp wants to cook a soup. To do it, he needs to buy exactly n liters of water.There are only two types of water bottles in the nearby shop \xe2\x80\x94 1-liter bottles and 2-liter bottles. There are infinitely many bottles of these two types in the shop.The bottle of the first type costs a burles and the bottle of the second type costs b burles correspondingly.Polycarp wants to spend as few money as possible. Your task is to find the minimum amount of money (in burles) Polycarp needs to buy exactly n liters of water in the nearby shop if the bottle of the first type costs a burles and the bottle of the second type costs b burles. You also have to answer q independent queries." math 800
1553G "Common Divisor Graph" "Consider a sequence of distinct integers a1,\xe2\x80\xa6,an, each representing one node of a graph. There is an edge between two nodes if the two values are not coprime, i. e. they have a common divisor greater than 1.There are q queries, in each query, you want to get from one given node as to another at. In order to achieve that, you can choose an existing value ai and create new value an+1=ai\xe2\x8b\x85(1+ai), with edges to all values that are not coprime with an+1. Also, n gets increased by 1. You can repeat that operation multiple times, possibly making the sequence much longer and getting huge or repeated values. What\'s the minimum possible number of newly created nodes so that at is reachable from as?Queries are independent. In each query, you start with the initial sequence a given in the input." "brute force,constructive algorithms,dsu,graphs,hashing,math,number theory" 2700
960A "Check the string" "A has a string consisting of some number of lowercase English letters \'a\'. He gives it to his friend B who appends some number of letters \'b\' to the end of this string. Since both A and B like the characters \'a\' and \'b\', they have made sure that at this point, at least one \'a\' and one \'b\' exist in the string.B now gives this string to C and he appends some number of letters \'c\' to the end of the string. However, since C is a good friend of A and B, the number of letters \'c\' he appends is equal to the number of \'a\' or to the number of \'b\' in the string. It is also possible that the number of letters \'c\' equals both to the number of letters \'a\' and to the number of letters \'b\' at the same time.You have a string in your hands, and you want to check if it is possible to obtain the string in this way or not. If it is possible to obtain the string, print ""YES"", otherwise print ""NO"" (without the quotes)." implementation 1200
727A "Transformation: from A to B" "Vasily has a number a, which he wants to turn into a number b. For this purpose, he can do two types of operations:  multiply the current number by 2 (that is, replace the number x by 2\xc2\xb7x);  append the digit 1 to the right of current number (that is, replace the number x by 10\xc2\xb7x\xe2\x80\x89+\xe2\x80\x891). You need to help Vasily to transform the number a into the number b using only the operations described above, or find that it is impossible.Note that in this task you are not required to minimize the number of operations. It suffices to find any way to transform a into b." "brute force,dfs and similar,math" 1000
1012A "Photo of The Sky" "Pavel made a photo of his favourite stars in the sky. His camera takes a photo of all points of the sky that belong to some rectangle with sides parallel to the coordinate axes.Strictly speaking, it makes a photo of all points with coordinates (x,y), such that x1\xe2\x89\xa4x\xe2\x89\xa4x2 and y1\xe2\x89\xa4y\xe2\x89\xa4y2, where (x1,y1) and (x2,y2) are coordinates of the left bottom and the right top corners of the rectangle being photographed. The area of this rectangle can be zero.After taking the photo, Pavel wrote down coordinates of n of his favourite stars which appeared in the photo. These points are not necessarily distinct, there can be multiple stars in the same point of the sky.Pavel has lost his camera recently and wants to buy a similar one. Specifically, he wants to know the dimensions of the photo he took earlier. Unfortunately, the photo is also lost. His notes are also of not much help; numbers are written in random order all over his notepad, so it\'s impossible to tell which numbers specify coordinates of which points.Pavel asked you to help him to determine what are the possible dimensions of the photo according to his notes. As there are multiple possible answers, find the dimensions with the minimal possible area of the rectangle." "brute force,implementation,math,sortings" 1500
1916H1 "Matrix Rank (Easy Version)" "This is the easy version of the problem. The only differences between the two versions of this problem are the constraints on k. You can make hacks only if all versions of the problem are solved.You are given integers n, p and k. p is guaranteed to be a prime number. For each r from 0 to k, find the number of n\xc3\x97n matrices A of the field\xe2\x80\xa0 of integers modulo p such that the rank\xe2\x80\xa1 of A is exactly r. Since these values are big, you are only required to output them modulo 998244353.\xe2\x80\xa0 https://en.wikipedia.org/wiki/Field_(mathematics)\xe2\x80\xa1 https://en.wikipedia.org/wiki/Rank_(linear_algebra)" "brute force,combinatorics,dp,math,matrices" 2700
529B "Group Photo 2 (online mirror version)" "Many years have passed, and n friends met at a party again. Technologies have leaped forward since the last meeting, cameras with timer appeared and now it is not obligatory for one of the friends to stand with a camera, and, thus, being absent on the photo.Simply speaking, the process of photographing can be described as follows. Each friend occupies a rectangle of pixels on the photo: the i-th of them in a standing state occupies a wi pixels wide and a hi pixels high rectangle. But also, each person can lie down for the photo, and then he will occupy a hi pixels wide and a wi pixels high rectangle.The total photo will have size W\xe2\x80\x89\xc3\x97\xe2\x80\x89H, where W is the total width of all the people rectangles, and H is the maximum of the heights. The friends want to determine what minimum area the group photo can they obtain if no more than n\xe2\x80\x89/\xe2\x80\x892 of them can lie on the ground (it would be strange if more than n\xe2\x80\x89/\xe2\x80\x892 gentlemen lie on the ground together, isn\'t it?..)Help them to achieve this goal." "brute force,greedy,sortings" 1900
1102C "Doors Breaking and Repairing" "You are policeman and you are playing a game with Slavik. The game is turn-based and each turn consists of two phases. During the first phase you make your move and during the second phase Slavik makes his move.There are n doors, the i-th door initially has durability equal to ai.During your move you can try to break one of the doors. If you choose door i and its current durability is bi then you reduce its durability to max(0,bi\xe2\x88\x92x) (the value x is given).During Slavik\'s move he tries to repair one of the doors. If he chooses door i and its current durability is bi then he increases its durability to bi+y (the value y is given). Slavik cannot repair doors with current durability equal to 0.The game lasts 10100 turns. If some player cannot make his move then he has to skip it.Your goal is to maximize the number of doors with durability equal to 0 at the end of the game. You can assume that Slavik wants to minimize the number of such doors. What is the number of such doors in the end if you both play optimally?" games 1200
1236B "Alice and the List of Presents" "Alice got many presents these days. So she decided to pack them into boxes and send them to her friends.There are n kinds of presents. Presents of one kind are identical (i.e. there is no way to distinguish two gifts of the same kind). Presents of different kinds are different (i.e. that is, two gifts of different kinds are distinguishable). The number of presents of each kind, that Alice has is very big, so we can consider Alice has an infinite number of gifts of each kind.Also, there are m boxes. All of them are for different people, so they are pairwise distinct (consider that the names of m friends are written on the boxes). For example, putting the first kind of present into the first box but not into the second box, is different from putting the first kind of present into the second box but not into the first box.Alice wants to pack presents with the following rules:  She won\'t pack more than one present of each kind into the same box, so each box should contain presents of different kinds (i.e. each box contains a subset of n kinds, empty boxes are allowed);  For each kind at least one present should be packed into some box. Now Alice wants to know how many different ways to pack the presents exists. Please, help her and calculate this number. Since the answer can be huge, output it by modulo 109+7.See examples and their notes for clarification." combinatorics,math 1500
938E "Max History" "You are given an array a of length n. We define fa the following way:  Initially fa\xe2\x80\x89=\xe2\x80\x890, M\xe2\x80\x89=\xe2\x80\x891;  for every 2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n if aM\xe2\x80\x89<\xe2\x80\x89ai then we set fa\xe2\x80\x89=\xe2\x80\x89fa\xe2\x80\x89+\xe2\x80\x89aM and then set M\xe2\x80\x89=\xe2\x80\x89i. Calculate the sum of fa over all n! permutations of the array a modulo 109\xe2\x80\x89+\xe2\x80\x897.Note: two elements are considered different if their indices differ, so for every array a there are exactly n! permutations." combinatorics,math 2300
89E "Fire and Ice" "The Fire Lord attacked the Frost Kingdom. He has already got to the Ice Fortress, where the Snow Queen dwells. He arranged his army on a segment n in length not far from the city walls. And only the frost magician Solomon can save the Frost Kingdom.  The n-long segment is located at a distance equal exactly to 1 from the castle walls. It can be imaginarily divided into unit segments. On some of the unit segments fire demons are located \xe2\x80\x94 no more than one demon per position. Each demon is characterised by his strength - by some positive integer. We can regard the fire demons being idle.Initially Solomon is positioned on the fortress wall. He can perform the following actions several times in a row:  ""L"" \xe2\x80\x94 Solomon shifts one unit to the left. This movement cannot be performed on the castle wall. ""R"" \xe2\x80\x94 Solomon shifts one unit to the left. This movement cannot be performed if there\'s no ice block to the right. ""A"" \xe2\x80\x94 If there\'s nothing to the right of Solomon, then Solomon creates an ice block that immediately freezes to the block that Solomon is currently standing on. If there already is an ice block, then Solomon destroys it. At that the ice blocks to the right of the destroyed one can remain but they are left unsupported. Those ice blocks fall down.Solomon spends exactly a second on each of these actions.As the result of Solomon\'s actions, ice blocks\' segments fall down. When an ice block falls on a fire demon, the block evaporates and the demon\'s strength is reduced by 1. When the demons\' strength is equal to 0, the fire demon vanishes. The picture below shows how it happens. The ice block that falls on the position with no demon, breaks into lots of tiny pieces and vanishes without hurting anybody.  Help Solomon destroy all the Fire Lord\'s army in minimum time." greedy 2900
2037C "Superultra\'s Favorite Permutation" "Superultra, a little red panda, desperately wants primogems. In his dreams, a voice tells him that he must solve the following task to obtain a lifetime supply of primogems. Help Superultra!Construct a permutation\xe2\x88\x97 p of length n such that pi+pi+1 is composite\xe2\x80\xa0 over all 1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921. If it\'s not possible, output \xe2\x88\x921.\xe2\x88\x97A permutation of length n is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array), and [1,3,4] is also not a permutation (n=3 but there is 4 in the array).\xe2\x80\xa0An integer x is composite if it has at least one other divisor besides 1 and x. For example, 4 is composite because 2 is a divisor." "constructive algorithms,greedy,math,number theory" -999
1786A2 "Alternating Deck (hard version)" "This is a hard version of the problem. In this version, there are two colors of the cards.Alice has n cards, each card is either black or white. The cards are stacked in a deck in such a way that the card colors alternate, starting from a white card. Alice deals the cards to herself and to Bob, dealing at once several cards from the top of the deck in the following order: one card to herself, two cards to Bob, three cards to Bob, four cards to herself, five cards to herself, six cards to Bob, seven cards to Bob, eight cards to herself, and so on. In other words, on the i-th step, Alice deals i top cards from the deck to one of the players; on the first step, she deals the cards to herself and then alternates the players every two steps. When there aren\'t enough cards at some step, Alice deals all the remaining cards to the current player, and the process stops.  First Alice\'s steps in a deck of many cards. How many cards of each color will Alice and Bob have at the end?" implementation 800
622C "Not Equal on a Segment" "You are given array a with n integers and m queries. The i-th query is given with three integers li,\xe2\x80\x89ri,\xe2\x80\x89xi.For the i-th query find any position pi (li\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89pi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ri) so that api\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89xi." "data structures,implementation" 1700
1348F "Phoenix and Memory" "Phoenix is trying to take a photo of his n friends with labels 1,2,\xe2\x80\xa6,n who are lined up in a row in a special order. But before he can take the photo, his friends get distracted by a duck and mess up their order.Now, Phoenix must restore the order but he doesn\'t remember completely! He only remembers that the i-th friend from the left had a label between ai and bi inclusive. Does there exist a unique way to order his friends based of his memory?" "data structures,dfs and similar,graphs,greedy" 2600
65A "Harry Potter and Three Spells" "A long time ago (probably even in the first book), Nicholas Flamel, a great alchemist and the creator of the Philosopher\'s Stone, taught Harry Potter three useful spells. The first one allows you to convert a grams of sand into b grams of lead, the second one allows you to convert c grams of lead into d grams of gold and third one allows you to convert e grams of gold into f grams of sand. When Harry told his friends about these spells, Ron Weasley was amazed. After all, if they succeed in turning sand into lead, lead into gold, and then turning part of the gold into sand again and so on, then it will be possible to start with a small amount of sand and get huge amounts of gold! Even an infinite amount of gold! Hermione Granger, by contrast, was skeptical about that idea. She argues that according to the law of conservation of matter getting an infinite amount of matter, even using magic, is impossible. On the contrary, the amount of matter may even decrease during transformation, being converted to magical energy. Though Hermione\'s theory seems convincing, Ron won\'t believe her. As far as Ron is concerned, Hermione made up her law of conservation of matter to stop Harry and Ron wasting their time with this nonsense, and to make them go and do homework instead. That\'s why Ron has already collected a certain amount of sand for the experiments. A quarrel between the friends seems unavoidable...Help Harry to determine which one of his friends is right, and avoid the quarrel after all. To do this you have to figure out whether it is possible to get the amount of gold greater than any preassigned number from some finite amount of sand." implementation,math 1800
1690B "Array Decrements" "Kristina has two arrays a and b, each containing n non-negative integers. She can perform the following operation on array a any number of times:   apply a decrement to each non-zero element of the array, that is, replace the value of each element ai such that ai>0 with the value ai\xe2\x88\x921 (1\xe2\x89\xa4i\xe2\x89\xa4n). If ai was 0, its value does not change. Determine whether Kristina can get an array b from an array a in some number of operations (probably zero). In other words, can she make ai=bi after some number of operations for each 1\xe2\x89\xa4i\xe2\x89\xa4n?For example, let n=4, a=[3,5,4,1] and b=[1,3,2,0]. In this case, she can apply the operation twice:   after the first application of the operation she gets a=[2,4,3,0];  after the second use of the operation she gets a=[1,3,2,0]. Thus, in two operations, she can get an array b from an array a." greedy,implementation 800
756F "Long number" "Consider the following grammar: <expression> ::= <term> | <expression> \'+\' <term> <term> ::= <number> | <number> \'-\' <number> | <number> \'(\' <expression> \')\' <number> ::= <pos_digit> | <number> <digit> <digit> ::= \'0\' | <pos_digit> <pos_digit> ::= \'1\' | \'2\' | \'3\' | \'4\' | \'5\' | \'6\' | \'7\' | \'8\' | \'9\'This grammar describes a number in decimal system using the following rules: <number> describes itself, <number>-<number> (l-r, l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r) describes integer which is concatenation of all integers from l to r, written without leading zeros. For example, 8-11 describes 891011, <number>(<expression>) describes integer which is concatenation of <number> copies of integer described by <expression>, <expression>+<term> describes integer which is concatenation of integers described by <expression> and <term>.For example, 2(2-4+1)+2(2(17)) describes the integer 2341234117171717.You are given an expression in the given grammar. Print the integer described by it modulo 109\xe2\x80\x89+\xe2\x80\x897." "expression parsing,math,number theory" 3400
1988C "Increasing Sequence with Fixed OR" "You are given a positive integer n. Find the longest sequence of positive integers a=[a1,a2,\xe2\x80\xa6,ak] that satisfies the following conditions, and print the sequence:  ai\xe2\x89\xa4n for all 1\xe2\x89\xa4i\xe2\x89\xa4k.  a is strictly increasing. That is, ai>ai\xe2\x88\x921 for all 2\xe2\x89\xa4i\xe2\x89\xa4k.  ai|ai\xe2\x88\x921=n for all 2\xe2\x89\xa4i\xe2\x89\xa4k, where | denotes the bitwise OR operation." "bitmasks,constructive algorithms,greedy" 1300
1879D "Sum of XOR Functions" "You are given an array a of length n consisting of non-negative integers.You have to calculate the value of \xe2\x88\x91nl=1\xe2\x88\x91nr=lf(l,r)\xe2\x8b\x85(r\xe2\x88\x92l+1), where f(l,r) is al\xe2\x8a\x95al+1\xe2\x8a\x95\xe2\x8b\xaf\xe2\x8a\x95ar\xe2\x88\x921\xe2\x8a\x95ar (the character \xe2\x8a\x95 denotes bitwise XOR).Since the answer can be very large, print it modulo 998244353." "bitmasks,combinatorics,divide and conquer,dp,math" 1700
1368D "AND, OR and square sum" "Gottfried learned about binary number representation. He then came up with this task and presented it to you.You are given a collection of n non-negative integers a1,\xe2\x80\xa6,an. You are allowed to perform the following operation: choose two distinct indices 1\xe2\x89\xa4i,j\xe2\x89\xa4n. If before the operation ai=x, aj=y, then after the operation ai=x AND y, aj=x OR y, where AND and OR are bitwise AND and OR respectively (refer to the Notes section for formal description). The operation may be performed any number of times (possibly zero).After all operations are done, compute \xe2\x88\x91ni=1a2i \xe2\x80\x94 the sum of squares of all ai. What is the largest sum of squares you can achieve?" bitmasks,greedy,math 1700
573D "Bear and Cavalry" "Would you want to fight against bears riding horses? Me neither.Limak is a grizzly bear. He is general of the dreadful army of Bearland. The most important part of an army is cavalry of course.Cavalry of Bearland consists of n warriors and n horses. i-th warrior has strength wi and i-th horse has strength hi. Warrior together with his horse is called a unit. Strength of a unit is equal to multiplied strengths of warrior and horse. Total strength of cavalry is equal to sum of strengths of all n units. Good assignment of warriors and horses makes cavalry truly powerful.Initially, i-th warrior has i-th horse. You are given q queries. In each query two warriors swap their horses with each other.General Limak must be ready for every possible situation. What if warriors weren\'t allowed to ride their own horses? After each query find the maximum possible strength of cavalry if we consider assignments of all warriors to all horses that no warrior is assigned to his own horse (it can be proven that for n\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x892 there is always at least one correct assignment).Note that we can\'t leave a warrior without a horse." "data structures,divide and conquer,dp" 3000
1350B "Orac and Models" "There are n models in the shop numbered from 1 to n, with sizes s1,s2,\xe2\x80\xa6,sn.Orac will buy some of the models and will arrange them in the order of increasing numbers (i.e. indices, but not sizes).Orac thinks that the obtained arrangement is beatiful, if for any two adjacent models with indices ij and ij+1 (note that ij<ij+1, because Orac arranged them properly), ij+1 is divisible by ij and sij<sij+1.For example, for 6 models with sizes {3,6,7,7,7,7}, he can buy models with indices 1, 2, and 6, and the obtained arrangement will be beautiful. Also, note that the arrangement with exactly one model is also considered beautiful.Orac wants to know the maximum number of models that he can buy, and he may ask you these queries many times." "dp,math,number theory" 1400
937B "Vile Grasshoppers" "The weather is fine today and hence it\'s high time to climb the nearby pine and enjoy the landscape.The pine\'s trunk includes several branches, located one above another and numbered from 2 to y. Some of them (more precise, from 2 to p) are occupied by tiny vile grasshoppers which you\'re at war with. These grasshoppers are known for their awesome jumping skills: the grasshopper at branch x can jump to branches .Keeping this in mind, you wisely decided to choose such a branch that none of the grasshoppers could interrupt you. At the same time you wanna settle as high as possible since the view from up there is simply breathtaking.In other words, your goal is to find the highest branch that cannot be reached by any of the grasshoppers or report that it\'s impossible." "brute force,math,number theory" 1400
689A "Mike and Cellphone" "While swimming at the beach, Mike has accidentally dropped his cellphone into the water. There was no worry as he bought a cheap replacement phone with an old-fashioned keyboard. The keyboard has only ten digital equal-sized keys, located in the following way:  Together with his old phone, he lost all his contacts and now he can only remember the way his fingers moved when he put some number in. One can formally consider finger movements as a sequence of vectors connecting centers of keys pressed consecutively to put in a number. For example, the finger movements for number ""586"" are the same as finger movements for number ""253"":    Mike has already put in a number by his ""finger memory"" and started calling it, so he is now worrying, can he be sure that he is calling the correct number? In other words, is there any other number, that has the same finger movements?" "brute force,constructive algorithms,implementation" 1400
1254E "Send Tree to Charlie" "Christmas was knocking on the door, and our protagonist, Bob, was preparing a spectacular present for his long-time second best friend Charlie. As chocolate boxes are lame, he decided to decorate a tree instead. Bob\'s tree can be represented as an undirected connected graph with n nodes (numbered 1 to n) and n\xe2\x88\x921 edges. Initially, Bob placed a decoration with label i on node i, for each 1\xe2\x89\xa4i\xe2\x89\xa4n. However, as such a simple arrangement is lame, he decided to shuffle the decorations a bit. Formally, Bob did the following steps: First, he listed the n\xe2\x88\x921 edges in some order. Then, he considered the edges one by one in that order. For each edge (u,v), he swapped the decorations of node u with the one of node v.After finishing, Bob seemed satisfied with the arrangement, so he went to sleep.The next morning, Bob wakes up only to find out that his beautiful arrangement has been ruined! Last night, Bob\'s younger brother Bobo dropped some of the decorations on the floor while he was playing with the tree. Fortunately, no decorations were lost, so Bob can repair the tree in no time. However, he completely forgets how the tree looked like yesterday. Therefore, given the labels of the decorations still on the tree, Bob wants to know the number of possible configurations of the tree. As the result can be quite large, Bob will be happy if you can output the result modulo 1000000007 (109+7). Note that, it is possible that there exists no possible configurations." "combinatorics,dfs and similar,dsu,trees" 3300
960E "Alternating Tree" "Given a tree with n nodes numbered from 1 to n. Each node i has an associated value Vi.If the simple path from u1 to um consists of m nodes namely u1\xe2\x86\x92u2\xe2\x86\x92u3\xe2\x86\x92\xe2\x80\xa6um\xe2\x88\x921\xe2\x86\x92um, then its alternating function A(u1,um) is defined as A(u1,um)=m\xe2\x88\x91i=1(\xe2\x88\x921)i+1\xe2\x8b\x85Vui. A path can also have 0 edges, i.e. u1=um.Compute the sum of alternating functions of all unique simple paths. Note that the paths are directed: two paths are considered different if the starting vertices differ or the ending vertices differ. The answer may be large so compute it modulo 109+7." "combinatorics,dfs and similar,divide and conquer,dp,probabilities,trees" 2300
774K "Stepan and Vowels" "Stepan likes to repeat vowel letters when he writes words. For example, instead of the word ""pobeda"" he can write ""pobeeeedaaaaa"".Sergey does not like such behavior, so he wants to write a program to format the words written by Stepan. This program must combine all consecutive equal vowels to a single vowel. The vowel letters are ""a"", ""e"", ""i"", ""o"", ""u"" and ""y"".There are exceptions: if letters ""e"" or ""o"" repeat in a row exactly 2 times, like in words ""feet"" and ""foot"", the program must skip them and do not transform in one vowel. For example, the word ""iiiimpleeemeentatiioon"" must be converted to the word ""implemeentatioon"".Sergey is very busy and asks you to help him and write the required program." "*special problem,implementation,strings" 1600
989D "A Shade of Moonlight" "Gathering darkness shrouds the woods and the world. The moon sheds its light on the boat and the river.""To curtain off the moonlight should be hardly possible; the shades present its mellow beauty and restful nature."" Intonates Mino.""See? The clouds are coming."" Kanno gazes into the distance.""That can\'t be better,"" Mino turns to Kanno. The sky can be seen as a one-dimensional axis. The moon is at the origin whose coordinate is 0.There are n clouds floating in the sky. Each cloud has the same length l. The i-th initially covers the range of (xi,xi+l) (endpoints excluded). Initially, it moves at a velocity of vi, which equals either 1 or \xe2\x88\x921.Furthermore, no pair of clouds intersect initially, that is, for all 1\xe2\x89\xa4i<j\xe2\x89\xa4n, |xi\xe2\x88\x92xj|\xe2\x89\xa5l.With a wind velocity of w, the velocity of the i-th cloud becomes vi+w. That is, its coordinate increases by vi+w during each unit of time. Note that the wind can be strong and clouds can change their direction.You are to help Mino count the number of pairs (i,j) (i<j), such that with a proper choice of wind velocity w not exceeding wmax in absolute value (possibly negative and/or fractional), the i-th and j-th clouds both cover the moon at the same future moment. This w doesn\'t need to be the same across different pairs." "binary search,geometry,math,sortings,two pointers" 2500
166B Polygons "You\'ve got another geometrical task. You are given two non-degenerate polygons A and B as vertex coordinates. Polygon A is strictly convex. Polygon B is an arbitrary polygon without any self-intersections and self-touches. The vertices of both polygons are given in the clockwise order. For each polygon no three consecutively following vertices are located on the same straight line.Your task is to check whether polygon B is positioned strictly inside polygon A. It means that any point of polygon B should be strictly inside polygon A. ""Strictly"" means that the vertex of polygon B cannot lie on the side of the polygon A." geometry,sortings 2100
1776M "Parmigiana With Seafood" "The ""Parmigiana di melanzane"" is a typical Italian dish. Alessandro and Bianca have very different tastes when it comes to it: Alessandro loves to eat Parmigiana with seafood, but Bianca thinks it is an atrocity! To decide which ingredients to include in the dish they prepare, they play the following game.There are n possible ingredients, labeled from 1 to n. The higher the label, the closer the ingredient is to being seafood. The ingredients are connected by n\xe2\x88\x921 edges, in such a way as to form a tree. Alessandro and Bianca take turns, with Alessandro going first. They alternately choose a terminal ingredient x, that is an ingredient currently connected to at most one other ingredient, and remove it from the tree. If the terminal ingredient x was chosen by Alessandro, it goes in the recipe; if it was chosen by Bianca, it is discarded.The taste of the Parmigiana is measured as the maximum label of an ingredient in the recipe. Alessandro wants to maximize the taste, while Bianca wants to minimize the taste. If both play optimally, what is the taste of the Parmigiana?" "binary search,dp,greedy,trees" 3000
1117C "Magic Ship" "You a captain of a ship. Initially you are standing in a point (x1,y1) (obviously, all positions in the sea can be described by cartesian plane) and you want to travel to a point (x2,y2). You know the weather forecast \xe2\x80\x94 the string s of length n, consisting only of letters U, D, L and R. The letter corresponds to a direction of wind. Moreover, the forecast is periodic, e.g. the first day wind blows to the side s1, the second day \xe2\x80\x94 s2, the n-th day \xe2\x80\x94 sn and (n+1)-th day \xe2\x80\x94 s1 again and so on. Ship coordinates change the following way:  if wind blows the direction U, then the ship moves from (x,y) to (x,y+1);  if wind blows the direction D, then the ship moves from (x,y) to (x,y\xe2\x88\x921);  if wind blows the direction L, then the ship moves from (x,y) to (x\xe2\x88\x921,y);  if wind blows the direction R, then the ship moves from (x,y) to (x+1,y). The ship can also either go one of the four directions or stay in place each day. If it goes then it\'s exactly 1 unit of distance. Transpositions of the ship and the wind add up. If the ship stays in place, then only the direction of wind counts. For example, if wind blows the direction U and the ship moves the direction L, then from point (x,y) it will move to the point (x\xe2\x88\x921,y+1), and if it goes the direction U, then it will move to the point (x,y+2).You task is to determine the minimal number of days required for the ship to reach the point (x2,y2)." "binary search" 1900
604A "Uncowed Forces" "Kevin Sun has just finished competing in Codeforces Round #334! The round was 120 minutes long and featured five problems with maximum point values of 500, 1000, 1500, 2000, and 2500, respectively. Despite the challenging tasks, Kevin was uncowed and bulldozed through all of them, distinguishing himself from the herd as the best cowmputer scientist in all of Bovinia. Kevin knows his submission time for each problem, the number of wrong submissions that he made on each problem, and his total numbers of successful and unsuccessful hacks. Because Codeforces scoring is complicated, Kevin wants you to write a program to compute his final score.Codeforces scores are computed as follows: If the maximum point value of a problem is x, and Kevin submitted correctly at minute m but made w wrong submissions, then his score on that problem is . His total score is equal to the sum of his scores for each problem. In addition, Kevin\'s total score gets increased by 100 points for each successful hack, but gets decreased by 50 points for each unsuccessful hack.All arithmetic operations are performed with absolute precision and no rounding. It is guaranteed that Kevin\'s final score is an integer." implementation 1000
335D "Rectangles and Square" "You are given n rectangles, labeled 1 through n. The corners of rectangles have integer coordinates and their edges are parallel to the Ox and Oy axes. The rectangles may touch each other, but they do not overlap (that is, there are no points that belong to the interior of more than one rectangle).Your task is to determine if there\'s a non-empty subset of the rectangles that forms a square. That is, determine if there exists a subset of the rectangles and some square for which every point that belongs to the interior or the border of that square belongs to the interior or the border of at least one of the rectangles in the subset, and every point that belongs to the interior or the border of at least one rectangle in the subset belongs to the interior or the border of that square." "brute force,dp" 2400
1353A "Most Unstable Array" "You are given two integers n and m. You have to construct the array a of length n consisting of non-negative integers (i.e. integers greater than or equal to zero) such that the sum of elements of this array is exactly m and the value n\xe2\x88\x921\xe2\x88\x91i=1|ai\xe2\x88\x92ai+1| is the maximum possible. Recall that |x| is the absolute value of x.In other words, you have to maximize the sum of absolute differences between adjacent (consecutive) elements. For example, if the array a=[1,3,2,5,5,0] then the value above for this array is |1\xe2\x88\x923|+|3\xe2\x88\x922|+|2\xe2\x88\x925|+|5\xe2\x88\x925|+|5\xe2\x88\x920|=2+1+3+0+5=11. Note that this example doesn\'t show the optimal answer but it shows how the required value for some array is calculated.You have to answer t independent test cases." "constructive algorithms,greedy,math" 800
513D1 "Constrained Tree" "You need to find a binary tree of size n that satisfies a given set of c constraints. Suppose that the nodes of the unknown binary tree are labeled using a pre-order traversal starting with 1. For the i-th constraint you are given two labels, ai and bi and a direction, left or right. In case of left direction, bi is an element of the subtree rooted at ai\'s left child. Similarly in the case of right direction bi is an element of the subtree rooted at ai\'s right child." "dfs and similar" 2400
171C "A Piece of Cake" "How to make a cake you\'ll never eat.Ingredients.   2 carrots  0 calories  100 g chocolate spread  1 pack of flour  1 egg Method.   Put calories into the mixing bowl.  Take carrots from refrigerator.  Chop carrots.  Take chocolate spread from refrigerator.  Put chocolate spread into the mixing bowl.  Combine pack of flour into the mixing bowl.  Fold chocolate spread into the mixing bowl.  Add chocolate spread into the mixing bowl.  Put pack of flour into the mixing bowl.  Add egg into the mixing bowl.  Fold pack of flour into the mixing bowl.  Chop carrots until choped.  Pour contents of the mixing bowl into the baking dish. Serves 1." "*special problem,implementation" 2000
960G "Bandit Blues" "Japate, while traveling through the forest of Mala, saw N bags of gold lying in a row. Each bag has some distinct weight of gold between 1 to N. Japate can carry only one bag of gold with him, so he uses the following strategy to choose a bag.Initially, he starts with an empty bag (zero weight). He considers the bags in some order. If the current bag has a higher weight than the bag in his hand, he picks the current bag.Japate put the bags in some order. Japate realizes that he will pick A bags, if he starts picking bags from the front, and will pick B bags, if he starts picking bags from the back. By picking we mean replacing the bag in his hand with the current one.Now he wonders how many permutations of bags are possible, in which he picks A bags from the front and B bags from back using the above strategy.Since the answer can be very large, output it modulo 998244353." combinatorics,dp,fft,math 2900
908G "New Year and Original Order" "Let S(n) denote the number that represents the digits of n in sorted order. For example, S(1)\xe2\x80\x89=\xe2\x80\x891,\xe2\x80\x89S(5)\xe2\x80\x89=\xe2\x80\x895,\xe2\x80\x89S(50394)\xe2\x80\x89=\xe2\x80\x893459,\xe2\x80\x89S(353535)\xe2\x80\x89=\xe2\x80\x89333555.Given a number X, compute  modulo 109\xe2\x80\x89+\xe2\x80\x897." dp,math 2800
1076C "Meme Problem" "Try guessing the statement from this picture:   You are given a non-negative integer d. You have to find two non-negative real numbers a and b such that a+b=d and a\xe2\x8b\x85b=d." "binary search,math" 1300
1493D "GCD of an Array" "You are given an array a of length n. You are asked to process q queries of the following format: given integers i and x, multiply ai by x.After processing each query you need to output the greatest common divisor (GCD) of all elements of the array a.Since the answer can be too large, you are asked to output it modulo 109+7." "brute force,data structures,hashing,implementation,math,number theory,sortings,two pointers" 2100
1230A "Dawid and Bags of Candies" "Dawid has four bags of candies. The i-th of them contains ai candies. Also, Dawid has two friends. He wants to give each bag to one of his two friends. Is it possible to distribute the bags in such a way that each friend receives the same amount of candies in total?Note, that you can\'t keep bags for yourself or throw them away, each bag should be given to one of the friends." "brute force,implementation" 800
334A "Candy Bags" "Gerald has n younger brothers and their number happens to be even. One day he bought n2 candy bags. One bag has one candy, one bag has two candies, one bag has three candies and so on. In fact, for each integer k from 1 to n2 he has exactly one bag with k candies. Help him give n bags of candies to each brother so that all brothers got the same number of candies." implementation 1000
625E "Frog Fights" "Ostap Bender recently visited frog farm and was inspired to create his own frog game.Number of frogs are places on a cyclic gameboard, divided into m cells. Cells are numbered from 1 to m, but the board is cyclic, so cell number 1 goes right after the cell number m in the direction of movement. i-th frog during its turn can jump for ai cells.Frogs move in turns, game starts with a move by frog 1. On its turn i-th frog moves ai cells forward, knocking out all the frogs on its way. If there is a frog in the last cell of the path of the i-th frog, that frog is also knocked out. After this the value ai is decreased by the number of frogs that were knocked out during this turn. If ai is zero or goes negative, then i-th frog doesn\'t make moves anymore.After frog number 1 finishes its turn, frog number 2 starts to move, then frog number 3 and so on. After the frog number n makes its move, frog 1 starts to move again, then frog 2 and so on this process goes forever. If some frog was already knocked out from the board, we consider that it skips all its moves.Help Ostap to identify, what frogs will stay on the board at the end of a game?" "data structures,greedy" 2800
1203F1 "Complete the Projects (easy version)" "The only difference between easy and hard versions is that you should complete all the projects in easy version but this is not necessary in hard version.Polycarp is a very famous freelancer. His current rating is r units.Some very rich customers asked him to complete some projects for their companies. To complete the i-th project, Polycarp needs to have at least ai units of rating; after he completes this project, his rating will change by bi (his rating will increase or decrease by bi) (bi can be positive or negative). Polycarp\'s rating should not fall below zero because then people won\'t trust such a low rated freelancer.Is it possible to complete all the projects? Formally, write a program to check if such an order of the projects exists, that Polycarp has enough rating before starting each project, and he has non-negative rating after completing each project.In other words, you have to check that there exists such an order of projects in which Polycarp will complete them, so he has enough rating before starting each project, and has non-negative rating after completing each project." greedy 2100
616C "The Labyrinth" "You are given a rectangular field of n\xe2\x80\x89\xc3\x97\xe2\x80\x89m cells. Each cell is either empty or impassable (contains an obstacle). Empty cells are marked with \'.\', impassable cells are marked with \'*\'. Let\'s call two empty cells adjacent if they share a side.Let\'s call a connected component any non-extendible set of cells such that any two of them are connected by the path of adjacent cells. It is a typical well-known definition of a connected component.For each impassable cell (x,\xe2\x80\x89y) imagine that it is an empty cell (all other cells remain unchanged) and find the size (the number of cells) of the connected component which contains (x,\xe2\x80\x89y). You should do it for each impassable cell independently.The answer should be printed as a matrix with n rows and m columns. The j-th symbol of the i-th row should be ""."" if the cell is empty at the start. Otherwise the j-th symbol of the i-th row should contain the only digit \xe2\x80\x94- the answer modulo 10. The matrix should be printed without any spaces.To make your output faster it is recommended to build the output as an array of n strings having length m and print it as a sequence of lines. It will be much faster than writing character-by-character.As input/output can reach huge size it is recommended to use fast input/output methods: for example, prefer to use scanf/printf instead of cin/cout in C++, prefer to use BufferedReader/PrintWriter instead of Scanner/System.out in Java." "dfs and similar" 1600
1251F "Red-White Fence" "Polycarp wants to build a fence near his house. He has n white boards and k red boards he can use to build it. Each board is characterised by its length, which is an integer.A good fence should consist of exactly one red board and several (possibly zero) white boards. The red board should be the longest one in the fence (every white board used in the fence should be strictly shorter), and the sequence of lengths of boards should be ascending before the red board and descending after it. Formally, if m boards are used, and their lengths are l1, l2, ..., lm in the order they are placed in the fence, from left to right (let\'s call this array [l1,l2,\xe2\x80\xa6,lm] the array of lengths), the following conditions should hold:  there should be exactly one red board in the fence (let its index be j);  for every i\xe2\x88\x88[1,j\xe2\x88\x921] li<li+1;  for every i\xe2\x88\x88[j,m\xe2\x88\x921] li>li+1. When Polycarp will build his fence, he will place all boards from left to right on the same height of 0, without any gaps, so these boards compose a polygon:  Example: a fence with [3,5,4,2,1] as the array of lengths. The second board is red. The perimeter of the fence is 20. Polycarp is interested in fences of some special perimeters. He has q even integers he really likes (these integers are Q1, Q2, ..., Qq), and for every such integer Qi, he wants to calculate the number of different fences with perimeter Qi he can build (two fences are considered different if their arrays of lengths are different). Can you help him calculate these values?" combinatorics,fft 2500
1863D "Two-Colored Dominoes" "There is an n\xc3\x97m board divided into cells. There are also some dominoes on this board. Each domino covers two adjacent cells (that is, two cells that share a side), and no two dominoes overlap.Piet thinks that this board is too boring and it needs to be painted. He will paint the cells of the dominoes black and white. He calls the painting beautiful if all of the following conditions hold:  for each domino, one of its cells is painted white and the other is painted black;  for each row, the number of black cells in this row equals the number of white cells in this row;  for each column, the number of black cells in this column equals the number of white cells in this column. Note that the cells that are not covered by dominoes are not painted at all, they are counted as neither black nor white.Help Piet produce a beautiful painting or tell that it is impossible." "constructive algorithms,greedy" 1400
346C "Number Transformation II" "You are given a sequence of positive integers x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xn and two non-negative integers a and b. Your task is to transform a into b. To do that, you can perform the following moves:  subtract 1 from the current a;  subtract a mod xi (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) from the current a. Operation a mod xi means taking the remainder after division of number a by number xi.Now you want to know the minimum number of moves needed to transform a into b." greedy,math 2200
1331G "Lingua Romana" "per nextum in unam tum XI conscribementis fac sic    vestibulo perlegementum da varo.    morde varo.    seqis cumula varum.cisper nextum in unam tum XI conscribementis fac sic    seqis decumulamenta da varo.    varum privamentum fodementum da aresulto.    varum tum III elevamentum tum V multiplicamentum da bresulto.    aresultum tum bresultum addementum da resulto.    si CD tum resultum non praestantiam fac sic        dictum sic f(%d) = %.2f cis tum varum tum resultum egresso describe.        novumversum egresso scribe.    cis    si CD tum resultum praestantiam fac sic        dictum sic f(%d) = MAGNA NIMIS! cis tum varum egresso describe.        novumversum egresso scribe.            ciscis" "*special problem" -999
70D "Professor\'s task" "Once a walrus professor Plato asked his programming students to perform the following practical task. The students had to implement such a data structure that would support a convex hull on some set of points S. The input to the program had q queries of two types: 1. Add a point with coordinates (x,\xe2\x80\x89y) into the set S. Note that in this case the convex hull of S could have changed, and could have remained the same. 2. Say whether a point with coordinates (x,\xe2\x80\x89y) belongs to an area limited by the convex hull, including the border. All the students coped with the task. What about you?" "data structures,geometry" 2700
938G "Shortest Path Queries" "You are given an undirected connected graph with weighted edges. The length of some path between two vertices is the bitwise xor of weights of all edges belonging to this path (if some edge is traversed more than once, then it is included in bitwise xor the same number of times). There are three types of queries you have to process:  1 x y d \xe2\x80\x94 add an edge connecting vertex x to vertex y with weight d. It is guaranteed that there is no edge connecting x to y before this query;  2 x y \xe2\x80\x94 remove an edge connecting vertex x to vertex y. It is guaranteed that there was such edge in the graph, and the graph stays connected after this query;  3 x y \xe2\x80\x94 calculate the length of the shortest path (possibly non-simple) from vertex x to vertex y. Print the answers for all queries of type 3." "bitmasks,data structures,dsu,graphs" 2900
785C "Anton and Fairy Tale" "Anton likes to listen to fairy tales, especially when Danik, Anton\'s best friend, tells them. Right now Danik tells Anton a fairy tale:""Once upon a time, there lived an emperor. He was very rich and had much grain. One day he ordered to build a huge barn to put there all his grain. Best builders were building that barn for three days and three nights. But they overlooked and there remained a little hole in the barn, from which every day sparrows came through. Here flew a sparrow, took a grain and flew away...""More formally, the following takes place in the fairy tale. At the beginning of the first day the barn with the capacity of n grains was full. Then, every day (starting with the first day) the following happens:  m grains are brought to the barn. If m grains doesn\'t fit to the barn, the barn becomes full and the grains that doesn\'t fit are brought back (in this problem we can assume that the grains that doesn\'t fit to the barn are not taken into account).  Sparrows come and eat grain. In the i-th day i sparrows come, that is on the first day one sparrow come, on the second day two sparrows come and so on. Every sparrow eats one grain. If the barn is empty, a sparrow eats nothing. Anton is tired of listening how Danik describes every sparrow that eats grain from the barn. Anton doesn\'t know when the fairy tale ends, so he asked you to determine, by the end of which day the barn will become empty for the first time. Help Anton and write a program that will determine the number of that day!" "binary search,math" 1600
510B "Fox And Two Dots" "Fox Ciel is playing a mobile puzzle game called ""Two Dots"". The basic levels are played on a board of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m cells, like this:Each cell contains a dot that has some color. We will use different uppercase Latin characters to express different colors.The key of this game is to find a cycle that contain dots of same color. Consider 4 blue dots on the picture forming a circle as an example. Formally, we call a sequence of dots d1,\xe2\x80\x89d2,\xe2\x80\x89...,\xe2\x80\x89dk a cycle if and only if it meets the following condition:  These k dots are different: if i\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89j then di is different from dj.  k is at least 4.  All dots belong to the same color.  For all 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k\xe2\x80\x89-\xe2\x80\x891: di and di\xe2\x80\x89+\xe2\x80\x891 are adjacent. Also, dk and d1 should also be adjacent. Cells x and y are called adjacent if they share an edge. Determine if there exists a cycle on the field." "dfs and similar" 1500
1428D "Bouncing Boomerangs" "To improve the boomerang throwing skills of the animals, Zookeeper has set up an n\xc3\x97n grid with some targets, where each row and each column has at most 2 targets each. The rows are numbered from 1 to n from top to bottom, and the columns are numbered from 1 to n from left to right.  For each column, Zookeeper will throw a boomerang from the bottom of the column (below the grid) upwards. When the boomerang hits any target, it will bounce off, make a 90 degree turn to the right and fly off in a straight line in its new direction. The boomerang can hit multiple targets and does not stop until it leaves the grid.   In the above example, n=6 and the black crosses are the targets. The boomerang in column 1 (blue arrows) bounces 2 times while the boomerang in column 3 (red arrows) bounces 3 times. The boomerang in column i hits exactly ai targets before flying out of the grid. It is known that ai\xe2\x89\xa43.However, Zookeeper has lost the original positions of the targets. Thus, he asks you to construct a valid configuration of targets that matches the number of hits for each column, or tell him that no such configuration exists. If multiple valid configurations exist, you may print any of them." "constructive algorithms,greedy,implementation" 1900
253B "Physics Practical" "One day Vasya was on a physics practical, performing the task on measuring the capacitance. He followed the teacher\'s advice and did as much as n measurements, and recorded the results in the notebook. After that he was about to show the results to the teacher, but he remembered that at the last lesson, the teacher had made his friend Petya redo the experiment because the largest and the smallest results differed by more than two times. Vasya is lazy, and he does not want to redo the experiment. He wants to do the task and go home play computer games. So he decided to cheat: before Vasya shows the measurements to the teacher, he will erase some of them, so as to make the largest and the smallest results of the remaining measurements differ in no more than two times. In other words, if the remaining measurements have the smallest result x, and the largest result y, then the inequality y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x892\xc2\xb7x must fulfill. Of course, to avoid the teacher\'s suspicion, Vasya wants to remove as few measurement results as possible from his notes.Help Vasya, find what minimum number of measurement results he will have to erase from his notes so that the largest and the smallest of the remaining results of the measurements differed in no more than two times." "binary search,dp,sortings,two pointers" 1400
1812J "Unmysterious Language" "There is an unmysterious language. You should make a submission in this language, and the judge will read your submission to determine whether it is accepted.You can only submit in the Mysterious Language we have provided. You can view the judge\'s response by clicking the submission ID on the ""My Submissions"" page." "*special problem,constructive algorithms,strings" -999
385A "Bear and Raspberry" "The bear decided to store some raspberry for the winter. He cunningly found out the price for a barrel of honey in kilos of raspberry for each of the following n days. According to the bear\'s data, on the i-th (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) day, the price for one barrel of honey is going to is xi kilos of raspberry.Unfortunately, the bear has neither a honey barrel, nor the raspberry. At the same time, the bear\'s got a friend who is ready to lend him a barrel of honey for exactly one day for c kilograms of raspberry. That\'s why the bear came up with a smart plan. He wants to choose some day d (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89d\xe2\x80\x89<\xe2\x80\x89n), lent a barrel of honey and immediately (on day d) sell it according to a daily exchange rate. The next day (d\xe2\x80\x89+\xe2\x80\x891) the bear wants to buy a new barrel of honey according to a daily exchange rate (as he\'s got some raspberry left from selling the previous barrel) and immediately (on day d\xe2\x80\x89+\xe2\x80\x891) give his friend the borrowed barrel of honey as well as c kilograms of raspberry for renting the barrel.The bear wants to execute his plan at most once and then hibernate. What maximum number of kilograms of raspberry can he earn? Note that if at some point of the plan the bear runs out of the raspberry, then he won\'t execute such a plan." "brute force,greedy,implementation" 1000
1725C "Circular Mirror" "Pak Chanek has a mirror in the shape of a circle. There are N lamps on the circumference numbered from 1 to N in clockwise order. The length of the arc from lamp i to lamp i+1 is Di for 1\xe2\x89\xa4i\xe2\x89\xa4N\xe2\x88\x921. Meanwhile, the length of the arc between lamp N and lamp 1 is DN.Pak Chanek wants to colour the lamps with M different colours. Each lamp can be coloured with one of the M colours. However, there cannot be three different lamps such that the colours of the three lamps are the same and the triangle made by considering the three lamps as vertices is a right triangle (triangle with one of its angles being exactly 90 degrees).The following are examples of lamp colouring configurations on the circular mirror. Figure 1. an example of an incorrect colouring because lamps 1, 2, and 3 form a right triangleFigure 2. an example of a correct colouringFigure 3. an example of a correct colouring Before colouring the lamps, Pak Chanek wants to know the number of distinct colouring configurations he can make. Count the number of distinct possible lamp colouring configurations, modulo 998244353." "binary search,combinatorics,geometry,math,two pointers" 2000
1427F "Boring Card Game" "When they are bored, Federico and Giada often play the following card game with a deck containing 6n cards.Each card contains one number between 1 and 6n and each number appears on exactly one card. Initially the deck is sorted, so the first card contains the number 1, the second card contains the number 2, \xe2\x80\xa6, and the last one contains the number 6n.Federico and Giada take turns, alternating; Federico starts.In his turn, the player takes 3 contiguous cards from the deck and puts them in his pocket. The order of the cards remaining in the deck is not changed. They play until the deck is empty (after exactly 2n turns). At the end of the game both Federico and Giada have 3n cards in their pockets.You are given the cards in Federico\'s pocket at the end of the game. Describe a sequence of moves that produces that set of cards in Federico\'s pocket." "data structures,greedy,trees" 3200
1689A "Lex String" "Kuznecov likes art, poetry, and music. And strings consisting of lowercase English letters.Recently, Kuznecov has found two strings, a and b, of lengths n and m respectively. They consist of lowercase English letters and no character is contained in both strings. Let another string c be initially empty. Kuznecov can do the following two types of operations:  Choose any character from the string a, remove it from a, and add it to the end of c.  Choose any character from the string b, remove it from b, and add it to the end of c. But, he can not do more than k operations of the same type in a row. He must perform operations until either a or b becomes empty. What is the lexicographically smallest possible value of c after he finishes?A string x is lexicographically smaller than a string y if and only if one of the following holds: x is a prefix of y, but x\xe2\x89\xa0y;  in the first position where x and y differ, the string x has a letter that appears earlier in the alphabet than the corresponding letter in y." "brute force,greedy,implementation,sortings,two pointers" 800
1716C "Robot in a Hallway" "There is a grid, consisting of 2 rows and m columns. The rows are numbered from 1 to 2 from top to bottom. The columns are numbered from 1 to m from left to right.The robot starts in a cell (1,1). In one second, it can perform either of two actions:   move into a cell adjacent by a side: up, right, down or left;  remain in the same cell. The robot is not allowed to move outside the grid.Initially, all cells, except for the cell (1,1), are locked. Each cell (i,j) contains a value ai,j \xe2\x80\x94 the moment that this cell gets unlocked. The robot can only move into a cell (i,j) if at least ai,j seconds have passed before the move.The robot should visit all cells without entering any cell twice or more (cell (1,1) is considered entered at the start). It can finish in any cell.What is the fastest the robot can achieve that?" "data structures,dp,greedy,implementation,ternary search" 2000
1323B "Count Subrectangles" "You are given an array a of length n and array b of length m both consisting of only integers 0 and 1. Consider a matrix c of size n\xc3\x97m formed by following rule: ci,j=ai\xe2\x8b\x85bj (i.e. ai multiplied by bj). It\'s easy to see that c consists of only zeroes and ones too.How many subrectangles of size (area) k consisting only of ones are there in c?A subrectangle is an intersection of a consecutive (subsequent) segment of rows and a consecutive (subsequent) segment of columns. I.e. consider four integers x1,x2,y1,y2 (1\xe2\x89\xa4x1\xe2\x89\xa4x2\xe2\x89\xa4n, 1\xe2\x89\xa4y1\xe2\x89\xa4y2\xe2\x89\xa4m) a subrectangle c[x1\xe2\x80\xa6x2][y1\xe2\x80\xa6y2] is an intersection of the rows x1,x1+1,x1+2,\xe2\x80\xa6,x2 and the columns y1,y1+1,y1+2,\xe2\x80\xa6,y2.The size (area) of a subrectangle is the total number of cells in it." "binary search,greedy,implementation" 1500
1211D Teams "There are n table bowling players, the rating of the i-th player equals ri. Compose a maximum number of teams in a such way that:  each player belongs to at most one team;  each team contains exactly a+b players;  each team contains a group of a players with the same rating and a group of b players with another same rating, which must be k times larger than the rating of the players in the first group. For example, if n=12, r=[1,1,2,2,2,2,2,3,3,4,6,6], a=1, b=2, k=2, you can compose two teams with ratings [1,2,2] and one team with ratings [3,6,6]. So, the maximum number of teams is 3.Find the maximum number of teams by given n,r1\xe2\x80\xa6rn,a,b and k to compose in respect to the given requirements." "*special problem,binary search,greedy,math" 2000
744D "Hongcow Draws a Circle" "Hongcow really likes the color red. Hongcow doesn\'t like the color blue.Hongcow is standing in an infinite field where there are n red points and m blue points.Hongcow wants to draw a circle in the field such that this circle contains at least one red point, and no blue points. Points that line exactly on the boundary of the circle can be counted as either inside or outside.Compute the radius of the largest circle that satisfies this condition. If this circle can have arbitrarily large size, print \xe2\x80\x89-\xe2\x80\x891. Otherwise, your answer will be accepted if it has relative or absolute error at most 10\xe2\x80\x89-\xe2\x80\x894." geometry 3200
1415E "New Game Plus!" "Wabbit is playing a game with n bosses numbered from 1 to n. The bosses can be fought in any order. Each boss needs to be defeated exactly once. There is a parameter called boss bonus which is initially 0.When the i-th boss is defeated, the current boss bonus is added to Wabbit\'s score, and then the value of the boss bonus increases by the point increment ci. Note that ci can be negative, which means that other bosses now give fewer points.However, Wabbit has found a glitch in the game. At any point in time, he can reset the playthrough and start a New Game Plus playthrough. This will set the current boss bonus to 0, while all defeated bosses remain defeated. The current score is also saved and does not reset to zero after this operation. This glitch can be used at most k times. He can reset after defeating any number of bosses (including before or after defeating all of them), and he also can reset the game several times in a row without defeating any boss.Help Wabbit determine the maximum score he can obtain if he has to defeat all n bosses." "constructive algorithms,greedy,math" 2200
1547G "How Many Paths?" "You are given a directed graph G which can contain loops (edges from a vertex to itself). Multi-edges are absent in G which means that for all ordered pairs (u,v) exists at most one edge from u to v. Vertices are numbered from 1 to n.A path from u to v is a sequence of edges such that:  vertex u is the start of the first edge in the path;  vertex v is the end of the last edge in the path;  for all pairs of adjacent edges next edge starts at the vertex that the previous edge ends on. We will assume that the empty sequence of edges is a path from u to u.For each vertex v output one of four values:  0, if there are no paths from 1 to v;  1, if there is only one path from 1 to v;  2, if there is more than one path from 1 to v and the number of paths is finite;  \xe2\x88\x921, if the number of paths from 1 to v is infinite. Let\'s look at the example shown in the figure.  Then:  the answer for vertex 1 is 1: there is only one path from 1 to 1 (path with length 0);  the answer for vertex 2 is 0: there are no paths from 1 to 2;  the answer for vertex 3 is 1: there is only one path from 1 to 3 (it is the edge (1,3));  the answer for vertex 4 is 2: there are more than one paths from 1 to 4 and the number of paths are finite (two paths: [(1,3),(3,4)] and [(1,4)]);  the answer for vertex 5 is \xe2\x88\x921: the number of paths from 1 to 5 is infinite (the loop can be used in a path many times);  the answer for vertex 6 is \xe2\x88\x921: the number of paths from 1 to 6 is infinite (the loop can be used in a path many times)." "dfs and similar,dp,graphs,trees" 2100
1835A "k-th equality" "Consider all equalities of form a+b=c, where a has A digits, b has B digits, and c has C digits. All the numbers are positive integers and are written without leading zeroes. Find the k-th lexicographically smallest equality when written as a string like above or determine that it does not exist.For example, the first three equalities satisfying A=1, B=1, C=2 are   1+9=10,  2+8=10,  2+9=11. An equality s is lexicographically smaller than an equality t with the same lengths of the numbers if and only if the following holds:   in the first position where s and t differ, the equality s has a smaller digit than the corresponding digit in t." "brute force,implementation,math" 1700
1790A "Polycarp and the Day of Pi" "On March 14, the day of the number \xcf\x80 is celebrated all over the world. This is a very important mathematical constant equal to the ratio of the circumference of a circle to its diameter.Polycarp was told at school that the number \xcf\x80 is irrational, therefore it has an infinite number of digits in decimal notation. He wanted to prepare for the Day of the number \xcf\x80 by memorizing this number as accurately as possible.Polycarp wrote out all the digits that he managed to remember. For example, if Polycarp remembered \xcf\x80 as 3.1415, he wrote out 31415.Polycarp was in a hurry and could have made a mistake, so you decided to check how many first digits of the number \xcf\x80 Polycarp actually remembers correctly." implementation,math,strings 800
813D "Two Melodies" "Alice is a beginner composer and now she is ready to create another masterpiece. And not even the single one but two at the same time! Alice has a sheet with n notes written on it. She wants to take two such non-empty non-intersecting subsequences that both of them form a melody and sum of their lengths is maximal.Subsequence is a sequence that can be derived from another sequence by deleting some elements without changing the order of the remaining elements.Subsequence forms a melody when each two adjacent notes either differs by 1 or are congruent modulo 7.You should write a program which will calculate maximum sum of lengths of such two non-empty non-intersecting subsequences that both of them form a melody." dp,flows 2600
513C "Second price auction" "Nowadays, most of the internet advertisements are not statically linked to a web page. Instead, what will be shown to the person opening a web page is determined within 100 milliseconds after the web page is opened. Usually, multiple companies compete for each ad slot on the web page in an auction. Each of them receives a request with details about the user, web page and ad slot and they have to respond within those 100 milliseconds with a bid they would pay for putting an advertisement on that ad slot. The company that suggests the highest bid wins the auction and gets to place its advertisement. If there are several companies tied for the highest bid, the winner gets picked at random.However, the company that won the auction does not have to pay the exact amount of its bid. In most of the cases, a second-price auction is used. This means that the amount paid by the company is equal to the maximum of all the other bids placed for this ad slot.Let\'s consider one such bidding. There are n companies competing for placing an ad. The i-th of these companies will bid an integer number of microdollars equiprobably randomly chosen from the range between Li and Ri, inclusive. In the other words, the value of the i-th company bid can be any integer from the range [Li,\xe2\x80\x89Ri] with the same probability. Determine the expected value that the winner will have to pay in a second-price auction." bitmasks,probabilities 2000
513E1 "Subarray Cuts" "You are given an array of length n and a number k. Let\'s pick k non-overlapping non-empty subarrays of the initial array. Let si be the sum of the i-th subarray in order from left to right. Compute the maximum value of the following expression: |s1\xe2\x80\x89-\xe2\x80\x89s2|\xe2\x80\x89+\xe2\x80\x89|s2\xe2\x80\x89-\xe2\x80\x89s3|\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89|sk\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89-\xe2\x80\x89sk|Here subarray is a contiguous part of an array." dp 2600
1530G "What a Reversal" "You have two strings a and b of equal length n consisting of characters 0 and 1, and an integer k.You need to make strings a and b equal.In one step, you can choose any substring of a containing exactly k characters 1 (and arbitrary number of characters 0) and reverse it. Formally, if a=a1a2\xe2\x80\xa6an, you can choose any integers l and r (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n) such that there are exactly k ones among characters al,al+1,\xe2\x80\xa6,ar, and set a to a1a2\xe2\x80\xa6al\xe2\x88\x921arar\xe2\x88\x921\xe2\x80\xa6alar+1ar+2\xe2\x80\xa6an.Find a way to make a equal to b using at most 4n reversals of the above kind, or determine that such a way doesn\'t exist. The number of reversals doesn\'t have to be minimized." "constructive algorithms" 3300
1051D Bicolorings "You are given a grid, consisting of 2 rows and n columns. Each cell of this grid should be colored either black or white.Two cells are considered neighbours if they have a common border and share the same color. Two cells A and B belong to the same component if they are neighbours, or if there is a neighbour of A that belongs to the same component with B.Let\'s call some bicoloring beautiful if it has exactly k components.Count the number of beautiful bicolorings. The number can be big enough, so print the answer modulo 998244353." bitmasks,dp 1700
1405A "Permutation Forgery" "A permutation of length n is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array) and [1,3,4] is also not a permutation (n=3 but there is 4 in the array).Let p be any permutation of length n. We define the fingerprint F(p) of p as the sorted array of sums of adjacent elements in p. More formally,F(p)=sort([p1+p2,p2+p3,\xe2\x80\xa6,pn\xe2\x88\x921+pn]).For example, if n=4 and p=[1,4,2,3], then the fingerprint is given by F(p)=sort([1+4,4+2,2+3])=sort([5,6,5])=[5,5,6].You are given a permutation p of length n. Your task is to find a different permutation p\xe2\x80\xb2 with the same fingerprint. Two permutations p and p\xe2\x80\xb2 are considered different if there is some index i such that pi\xe2\x89\xa0p\xe2\x80\xb2i." "constructive algorithms" 800
612A "The Text Splitting" "You are given the string s of length n and the numbers p,\xe2\x80\x89q. Split the string s to pieces of length p and q.For example, the string ""Hello"" for p\xe2\x80\x89=\xe2\x80\x892, q\xe2\x80\x89=\xe2\x80\x893 can be split to the two strings ""Hel"" and ""lo"" or to the two strings ""He"" and ""llo"".Note it is allowed to split the string s to the strings only of length p or to the strings only of length q (see the second sample test)." "brute force,implementation,strings" 1300
1887D Split "Let\'s call an array b1,b2,\xe2\x80\xa6,bm (m\xe2\x89\xa52) good if it can be split into two parts such that all elements in the left part are strictly smaller than all elements in the right part. In other words, there must exist an index 1\xe2\x89\xa4i<m such that every element from b1,\xe2\x80\xa6,bi is strictly smaller than every element from bi+1,\xe2\x80\xa6,bm.Given an array a1,a2,\xe2\x80\xa6an consisting of distinct integers from 1 to n. There are q queries. Each query consists of two numbers l and r. For each query, determine whether the array al,al+1,\xe2\x80\xa6,ar is good." "binary search,data structures,divide and conquer,dsu,math,trees,two pointers" 2700
827F "Dirty Arkady\'s Kitchen" "Arkady likes to walk around his kitchen. His labyrinthine kitchen consists of several important places connected with passages. Unfortunately it happens that these passages are flooded with milk so that it\'s impossible to pass through them. Namely, it\'s possible to pass through each passage in any direction only during some time interval.The lengths of all passages are equal and Arkady makes through them in one second. For security reasons, Arkady can never stop, also, he can\'t change direction while going through a passage. In other words, if he starts walking in some passage, he should reach its end and immediately leave the end.Today Arkady needs to quickly reach important place n from place 1. He plans to exit the place 1 at time moment 0 and reach the place n as early as he can. Please find the minimum time he should spend on his way." "data structures,dp,graphs,shortest paths" 3200
1874E "Jellyfish and Hack" "It is well known that quick sort works by randomly selecting a \'pivot\' element from the array and partitioning the other elements into two sub-arrays, according to whether they are less than or greater than the pivot. But Jellyfish thinks that choosing a random element is just a waste of time, so she always chooses the first element to be the pivot. The time her code needs to run can be calculated by the following pseudocode:function fun(A)    if A.length > 0        let L[1 ... L.length] and R[1 ... R.length] be new arrays        L.length = R.length = 0        for i = 2 to A.length            if A[i] < A[1]                L.length = L.length + 1                L[L.length] = A[i]            else                R.length = R.length + 1                R[R.length] = A[i]        return A.length + fun(L) + fun(R)    else        return 0Now you want to show her that her code is slow. When the function fun(A) is greater than or equal to lim, her code will get Time Limit Exceeded. You want to know how many distinct permutations P of [1,2,\xe2\x80\xa6,n] satisfies fun(P)\xe2\x89\xa5lim. Because the answer may be large, you will only need to find the answer modulo 109+7." dp,math 3000
2032D Genokraken "This is an interactive problem.Upon clearing the Waterside Area, Gretel has found a monster named Genokraken, and she\'s keeping it contained for her scientific studies.The monster\'s nerve system can be structured as a tree\xe2\x80\xa0 of n nodes (really, everything should stop resembling trees all the time\xe2\x80\xa6), numbered from 0 to n\xe2\x88\x921, with node 0 as the root.Gretel\'s objective is to learn the exact structure of the monster\'s nerve system \xe2\x80\x94 more specifically, she wants to know the values p1,p2,\xe2\x80\xa6,pn\xe2\x88\x921 of the tree, where pi (0\xe2\x89\xa4pi<i) is the direct parent node of node i (1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921).She doesn\'t know exactly how the nodes are placed, but she knows a few convenient facts:  If we remove root node 0 and all adjacent edges, this tree will turn into a forest consisting of only paths\xe2\x80\xa1. Each node that was initially adjacent to the node 0 will be the end of some path.  The nodes are indexed in a way that if 1\xe2\x89\xa4x\xe2\x89\xa4y\xe2\x89\xa4n\xe2\x88\x921, then px\xe2\x89\xa4py.  Node 1 has exactly two adjacent nodes (including the node 0).  The tree in this picture does not satisfy the condition, because if we remove node 0, then node 2 (which was initially adjacent to the node 0) will not be the end of the path 4\xe2\x88\x922\xe2\x88\x925.The tree in this picture does not satisfy the condition, because p3\xe2\x89\xa4p4 must hold.The tree in this picture does not satisfy the condition, because node 1 has only one adjacent node. Gretel can make queries to the containment cell:  ""? a b"" (1\xe2\x89\xa4a,b<n, a\xe2\x89\xa0b) \xe2\x80\x94 the cell will check if the simple path between nodes a and b contains the node 0. However, to avoid unexpected consequences by overstimulating the creature, Gretel wants to query at most 2n\xe2\x88\x926 times. Though Gretel is gifted, she can\'t do everything all at once, so can you give her a helping hand?\xe2\x80\xa0A tree is a connected graph where every pair of distinct nodes has exactly one simple path connecting them.\xe2\x80\xa1A path is a tree whose vertices can be listed in the order v1,v2,\xe2\x80\xa6,vk such that the edges are (vi,vi+1) (1\xe2\x89\xa4i<k)." "constructive algorithms,data structures,graphs,greedy,implementation,interactive,trees,two pointers" 1800
1662D "Evolution of Weasels" "A wild basilisk just appeared at your doorstep. You are not entirely sure what a basilisk is and you wonder whether it evolved from your favorite animal, the weasel. How can you find out whether basilisks evolved from weasels? Certainly, a good first step is to sequence both of their DNAs. Then you can try to check whether there is a sequence of possible mutations from the DNA of the weasel to the DNA of the basilisk. Your friend Ron is a talented alchemist and has studied DNA sequences in many of his experiments. He has found out that DNA strings consist of the letters A, B and C and that single mutations can only remove or add substrings at any position in the string (a substring is a contiguous sequence of characters). The substrings that can be removed or added by a mutation are AA, BB, CC, ABAB or BCBC. During a sequence of mutations a DNA string may even become empty.Ron has agreed to sequence the DNA of the weasel and the basilisk for you, but finding out whether there is a sequence of possible mutations that leads from one to the other is too difficult for him, so you have to do it on your own." greedy,implementation,strings -999
1045J "Moonwalk challenge" "Since astronauts from BubbleCup XI mission finished their mission on the Moon and are big fans of famous singer, they decided to spend some fun time before returning to the Earth and hence created a so called ""Moonwalk challenge"" game.Teams of astronauts are given the map of craters on the Moon and direct bidirectional paths from some craters to others that are safe for ""Moonwalking"". Each of those direct paths is colored in one color and there is unique path between each two craters. Goal of the game is to find two craters such that given array of colors appears most times as continuous subarray on the path between those two craters (overlapping appearances should be counted).To help your favorite team win, you should make a program that, given the map, answers the queries of the following type: For two craters and array of colors answer how many times given array appears as continuous subarray on the path from the first crater to the second.Colors are represented as lowercase English alphabet letters." "data structures,strings,trees" 2600
464D "World of Darkraft - 2" "Roma found a new character in the game ""World of Darkraft - 2"". In this game the character fights monsters, finds the more and more advanced stuff that lets him fight stronger monsters.The character can equip himself with k distinct types of items. Power of each item depends on its level (positive integer number). Initially the character has one 1-level item of each of the k types.After the victory over the monster the character finds exactly one new randomly generated item. The generation process looks as follows. Firstly the type of the item is defined; each of the k types has the same probability. Then the level of the new item is defined. Let\'s assume that the level of player\'s item of the chosen type is equal to t at the moment. Level of the new item will be chosen uniformly among integers from segment [1; t\xe2\x80\x89+\xe2\x80\x891].From the new item and the current player\'s item of the same type Roma chooses the best one (i.e. the one with greater level) and equips it (if both of them has the same level Roma choses any). The remaining item is sold for coins. Roma sells an item of level x of any type for x coins.Help Roma determine the expected number of earned coins after the victory over n monsters." dp,probabilities 2700
48D Permutations "A permutation is a sequence of integers from 1 to n of length n containing each number exactly once. For example, (1), (4,\xe2\x80\x893,\xe2\x80\x895,\xe2\x80\x891,\xe2\x80\x892), (3,\xe2\x80\x892,\xe2\x80\x891) are permutations, and (1,\xe2\x80\x891), (4,\xe2\x80\x893,\xe2\x80\x891), (2,\xe2\x80\x893,\xe2\x80\x894) are not. There are many tasks on permutations. Today you are going to solve one of them. Let\xe2\x80\x99s imagine that somebody took several permutations (perhaps, with a different number of elements), wrote them down consecutively as one array and then shuffled the resulting array. The task is to restore the initial permutations if it is possible." greedy 1500
928A "Login Verification" "When registering in a social network, users are allowed to create their own convenient login to make it easier to share contacts, print it on business cards, etc.Login is an arbitrary sequence of lower and uppercase latin letters, digits and underline symbols (\xc2\xab_\xc2\xbb). However, in order to decrease the number of frauds and user-inattention related issues, it is prohibited to register a login if it is similar with an already existing login. More precisely, two logins s and t are considered similar if we can transform s to t via a sequence of operations of the following types:   transform lowercase letters to uppercase and vice versa;  change letter \xc2\xabO\xc2\xbb (uppercase latin letter) to digit \xc2\xab0\xc2\xbb and vice versa;  change digit \xc2\xab1\xc2\xbb (one) to any letter among \xc2\xabl\xc2\xbb (lowercase latin \xc2\xabL\xc2\xbb), \xc2\xabI\xc2\xbb (uppercase latin \xc2\xabi\xc2\xbb) and vice versa, or change one of these letters to other. For example, logins \xc2\xabCodeforces\xc2\xbb and \xc2\xabcodef0rces\xc2\xbb as well as \xc2\xabOO0OOO00O0OOO0O00OOO0OO_lol\xc2\xbb and \xc2\xabOO0OOO0O00OOO0O00OO0OOO_1oI\xc2\xbb are considered similar whereas \xc2\xabCodeforces\xc2\xbb and \xc2\xabCode_forces\xc2\xbb are not.You\'re given a list of existing logins with no two similar amonst and a newly created user login. Check whether this new login is similar with any of the existing ones." "*special problem,strings" 1200
610C "Harmony Analysis" "The semester is already ending, so Danil made an effort and decided to visit a lesson on harmony analysis to know how does the professor look like, at least. Danil was very bored on this lesson until the teacher gave the group a simple task: find 4 vectors in 4-dimensional space, such that every coordinate of every vector is 1 or \xe2\x80\x89-\xe2\x80\x891 and any two vectors are orthogonal. Just as a reminder, two vectors in n-dimensional space are considered to be orthogonal if and only if their scalar product is equal to zero, that is: .Danil quickly managed to come up with the solution for this problem and the teacher noticed that the problem can be solved in a more general case for 2k vectors in 2k-dimensinoal space. When Danil came home, he quickly came up with the solution for this problem. Can you cope with it?" "constructive algorithms" 1800
1089K "King Kog\'s Reception" "King Kog got annoyed of the usual laxity of his knights \xe2\x80\x94 they can break into his hall without prior notice! Thus, the King decided to build a reception with a queue where each knight chooses in advance the time when he will come and how long the visit will take. The knights are served in the order of the recorded time, but each knight has to wait until the visits of all the knights before him are finished.Princess Keabeanie wants to see her father. However, she does not want to interrupt the knights so she joins the queue. Unfortunately, the knights change their minds very often \xe2\x80\x94 they can join the queue or cancel their visits. Please help the princess to understand how long she will have to wait until she sees her father if she enters the queue at the specified moments of time given the records at the reception." "data structures" 2400
734A "Anton and Danik" "Anton likes to play chess, and so does his friend Danik.Once they have played n games in a row. For each game it\'s known who was the winner \xe2\x80\x94 Anton or Danik. None of the games ended with a tie.Now Anton wonders, who won more games, he or Danik? Help him determine this." implementation,strings 800
1765J "Hero to Zero" "There are no heroes in this problem. I guess we should have named it ""To Zero"".You are given two arrays a and b, each of these arrays contains n non-negative integers.Let c be a matrix of size n\xc3\x97n such that ci,j=|ai\xe2\x88\x92bj| for every i\xe2\x88\x88[1,n] and every j\xe2\x88\x88[1,n].Your goal is to transform the matrix c so that it becomes the zero matrix, i.\xe2\x80\x89e. a matrix where every element is exactly 0. In order to do so, you may perform the following operations any number of times, in any order:  choose an integer i, then decrease ci,j by 1 for every j\xe2\x88\x88[1,n] (i.\xe2\x80\x89e. decrease all elements in the i-th row by 1). In order to perform this operation, you pay 1 coin;  choose an integer j, then decrease ci,j by 1 for every i\xe2\x88\x88[1,n] (i.\xe2\x80\x89e. decrease all elements in the j-th column by 1). In order to perform this operation, you pay 1 coin;  choose two integers i and j, then decrease ci,j by 1. In order to perform this operation, you pay 1 coin;  choose an integer i, then increase ci,j by 1 for every j\xe2\x88\x88[1,n] (i.\xe2\x80\x89e. increase all elements in the i-th row by 1). When you perform this operation, you receive 1 coin;  choose an integer j, then increase ci,j by 1 for every i\xe2\x88\x88[1,n] (i.\xe2\x80\x89e. increase all elements in the j-th column by 1). When you perform this operation, you receive 1 coin. You have to calculate the minimum number of coins required to transform the matrix c into the zero matrix. Note that all elements of c should be equal to 0 simultaneously after the operations." "graph matchings,math" 2900
1452F "Divide Powers" "You are given a multiset of powers of two. More precisely, for each i from 0 to n exclusive you have cnti elements equal to 2i.In one operation, you can choose any one element 2l>1 and divide it into two elements 2l\xe2\x88\x921.You should perform q queries. Each query has one of two types:   ""1 pos val"" \xe2\x80\x94 assign cntpos:=val;  ""2 x k"" \xe2\x80\x94 calculate the minimum number of operations you need to make at least k elements with value lower or equal to 2x. Note that all queries of the second type don\'t change the multiset; that is, you just calculate the minimum number of operations, you don\'t perform them." "constructive algorithms,greedy" 2900
954E "Water Taps" "Consider a system of n water taps all pouring water into the same container. The i-th water tap can be set to deliver any amount of water from 0 to ai ml per second (this amount may be a real number). The water delivered by i-th tap has temperature ti.If for every  you set i-th tap to deliver exactly xi ml of water per second, then the resulting temperature of water will be  (if , then to avoid division by zero we state that the resulting water temperature is 0).You have to set all the water taps in such a way that the resulting temperature is exactly T. What is the maximum amount of water you may get per second if its temperature has to be T?" "binary search,greedy,sortings" 2000
1400G Mercenaries "Polycarp plays a (yet another!) strategic computer game. In this game, he leads an army of mercenaries.Polycarp wants to gather his army for a quest. There are n mercenaries for hire, and the army should consist of some subset of them.The i-th mercenary can be chosen if the resulting number of chosen mercenaries is not less than li (otherwise he deems the quest to be doomed) and not greater than ri (he doesn\'t want to share the trophies with too many other mercenaries). Furthermore, m pairs of mercenaries hate each other and cannot be chosen for the same quest. How many non-empty subsets does Polycarp need to consider? In other words, calculate the number of non-empty subsets of mercenaries such that the size of this subset belongs to [li,ri] for each chosen mercenary, and there are no two mercenaries in the subset that hate each other.The answer may be large, so calculate it modulo 998244353." "bitmasks,brute force,combinatorics,dp,dsu,math,two pointers" 2600
400E "Inna and Binary Logic" "Inna is fed up with jokes about female logic. So she started using binary logic instead.Inna has an array of n elements a1[1],\xe2\x80\x89a1[2],\xe2\x80\x89...,\xe2\x80\x89a1[n]. Girl likes to train in her binary logic, so she does an exercise consisting of n stages: on the first stage Inna writes out all numbers from array a1, on the i-th (i\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x892) stage girl writes all elements of array ai, which consists of n\xe2\x80\x89-\xe2\x80\x89i\xe2\x80\x89+\xe2\x80\x891 integers; the k-th integer of array ai is defined as follows: ai[k]\xe2\x80\x89=\xe2\x80\x89ai\xe2\x80\x89-\xe2\x80\x891[k] AND ai\xe2\x80\x89-\xe2\x80\x891[k\xe2\x80\x89+\xe2\x80\x891]. Here AND is bit-wise binary logical operation.Dima decided to check Inna\'s skill. He asks Inna to change array, perform the exercise and say the sum of all  elements she wrote out during the current exercise.Help Inna to answer the questions!" "binary search,bitmasks,data structures" 2100
1948E "Clique Partition" "You are given two integers, n and k. There is a graph on n vertices, numbered from 1 to n, which initially has no edges.You have to assign each vertex an integer; let ai be the integer on the vertex i. All ai should be distinct integers from 1 to n.After assigning integers, for every pair of vertices (i,j), you add an edge between them if |i\xe2\x88\x92j|+|ai\xe2\x88\x92aj|\xe2\x89\xa4k.Your goal is to create a graph which can be partitioned into the minimum possible (for the given values of n and k) number of cliques. Each vertex of the graph should belong to exactly one clique. Recall that a clique is a set of vertices such that every pair of vertices in it are connected with an edge.Since BledDest hasn\'t really brushed his programming skills up, he can\'t solve the problem ""given a graph, partition it into the minimum number of cliques"". So we also ask you to print the partition itself." "brute force,constructive algorithms,graphs,greedy,implementation" 2100
1718F "Burenka, an Array and Queries" "Eugene got Burenka an array a of length n of integers from 1 to m for her birthday. Burenka knows that Eugene really likes coprime integers (integers x and y such that they have only one common factor (equal to 1)) so she wants to to ask Eugene q questions about the present. Each time Burenka will choose a subsegment al,al+1,\xe2\x80\xa6,ar of array a, and compute the product of these numbers p=al\xe2\x8b\x85al+1\xe2\x8b\x85\xe2\x80\xa6\xe2\x8b\x85ar. Then she will ask Eugene to count the number of integers between 1 and C inclusive which are coprime with p. Help Eugene answer all the questions!" "data structures,math,number theory" 3300
1946A "Median of an Array" "You are given an array a of n integers.The median of an array q1,q2,\xe2\x80\xa6,qk is the number p\xe2\x8c\x88k2\xe2\x8c\x89, where p is the array q sorted in non-decreasing order. For example, the median of the array [9,5,1,2,6] is 5, as in the sorted array [1,2,5,6,9], the number at index \xe2\x8c\x8852\xe2\x8c\x89=3 is 5, and the median of the array [9,2,8,3] is 3, as in the sorted array [2,3,8,9], the number at index \xe2\x8c\x8842\xe2\x8c\x89=2 is 3.You are allowed to choose an integer i (1\xe2\x89\xa4i\xe2\x89\xa4n) and increase ai by 1 in one operation.Your task is to find the minimum number of operations required to increase the median of the array.Note that the array a may not necessarily contain distinct numbers." greedy,implementation,sortings 800
522B "Photo to Remember" "One day n friends met at a party, they hadn\'t seen each other for a long time and so they decided to make a group photo together. Simply speaking, the process of taking photos can be described as follows. On the photo, each photographed friend occupies a rectangle of pixels: the i-th of them occupies the rectangle of width wi pixels and height hi pixels. On the group photo everybody stands in a line, thus the minimum pixel size of the photo including all the photographed friends, is W\xe2\x80\x89\xc3\x97\xe2\x80\x89H, where W is the total sum of all widths and H is the maximum height of all the photographed friends.As is usually the case, the friends made n photos \xe2\x80\x94 the j-th (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) photo had everybody except for the j-th friend as he was the photographer.Print the minimum size of each made photo in pixels." "*special problem,data structures,dp,implementation" 1100
1982D "Beauty of the mountains" "Nikita loves mountains and has finally decided to visit the Berlyand mountain range! The range was so beautiful that Nikita decided to capture it on a map. The map is a table of n rows and m columns, with each cell containing a non-negative integer representing the height of the mountain.He also noticed that mountains come in two types:  With snowy caps.  Without snowy caps. Nikita is a very pragmatic person. He wants the sum of the heights of the mountains with snowy caps to be equal to the sum of the heights of the mountains without them. He has arranged with the mayor of Berlyand, Polikarp Polikarpovich, to allow him to transform the landscape.Nikita can perform transformations on submatrices of size k\xc3\x97k as follows: he can add an integer constant c to the heights of the mountains within this area, but the type of the mountain remains unchanged. Nikita can choose the constant c independently for each transformation. Note that c can be negative.Before making the transformations, Nikita asks you to find out if it is possible to achieve equality of the sums, or if it is impossible. It doesn\'t matter at what cost, even if the mountains turn into canyons and have negative heights.If only one type of mountain is represented on the map, then the sum of the heights of the other type of mountain is considered to be zero." "brute force,data structures,implementation,math,number theory" 1700
1876B "Effects of Anti Pimples" "Chaneka has an array [a1,a2,\xe2\x80\xa6,an]. Initially, all elements are white. Chaneka will choose one or more different indices and colour the elements at those chosen indices black. Then, she will choose all white elements whose indices are multiples of the index of at least one black element and colour those elements green. After that, her score is the maximum value of ai out of all black and green elements.There are 2n\xe2\x88\x921 ways for Chaneka to choose the black indices. Find the sum of scores for all possible ways Chaneka can choose the black indices. Since the answer can be very big, print the answer modulo 998244353." "combinatorics,number theory,sortings" 1500
113C "Double Happiness" "On the math lesson a teacher asked each pupil to come up with his own lucky numbers. As a fan of number theory Peter chose prime numbers. Bob was more original. He said that number t is his lucky number, if it can be represented as: t\xe2\x80\x89=\xe2\x80\x89a2\xe2\x80\x89+\xe2\x80\x89b2,\xe2\x80\x89 where a,\xe2\x80\x89b are arbitrary positive integers.Now, the boys decided to find out how many days of the interval [l,\xe2\x80\x89r] (l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r) are suitable for pair programming. They decided that the day i (l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r) is suitable for pair programming if and only if the number i is lucky for Peter and lucky for Bob at the same time. Help the boys to find the number of such days." "brute force,math,number theory" 2200
