index name statement tags rating
1187G "Gang Up" "The leader of some very secretive organization has decided to invite all other members to a meeting. All members of the organization live in the same town which can be represented as n crossroads connected by m two-directional streets. The meeting will be held in the leader\'s house near the crossroad 1. There are k members of the organization invited to the meeting; i-th of them lives near the crossroad ai. All members of the organization receive the message about the meeting at the same moment and start moving to the location where the meeting is held. In the beginning of each minute each person is located at some crossroad. He or she can either wait a minute at this crossroad, or spend a minute to walk from the current crossroad along some street to another crossroad (obviously, it is possible to start walking along the street only if it begins or ends at the current crossroad). In the beginning of the first minute each person is at the crossroad where he or she lives. As soon as a person reaches the crossroad number 1, he or she immediately comes to the leader\'s house and attends the meeting.Obviously, the leader wants all other members of the organization to come up as early as possible. But, since the organization is very secretive, the leader does not want to attract much attention. Let\'s denote the discontent of the leader as follows  initially the discontent is 0;  whenever a person reaches the crossroad number 1, the discontent of the leader increases by c\xe2\x8b\x85x, where c is some fixed constant, and x is the number of minutes it took the person to reach the crossroad number 1;  whenever x members of the organization walk along the same street at the same moment in the same direction, dx2 is added to the discontent, where d is some fixed constant. This is not cumulative: for example, if two persons are walking along the same street in the same direction at the same moment, then 4d is added to the discontent, not 5d. Before sending a message about the meeting, the leader can tell each member of the organization which path they should choose and where they should wait. Help the leader to establish a plan for every member of the organization so they all reach the crossroad 1, and the discontent is minimized." flows,graphs 2500
643G "Choosing Ads" "One social network developer recently suggested a new algorithm of choosing ads for users.There are n slots which advertisers can buy. It is possible to buy a segment of consecutive slots at once. The more slots you own, the bigger are the chances your ad will be shown to users.Every time it is needed to choose ads to show, some segment of slots is picked by a secret algorithm. Then some advertisers are chosen. The only restriction is that it should be guaranteed for advertisers which own at least p% of slots composing this segment that their ad will be shown.From the other side, users don\'t like ads. So it was decided to show no more than  ads at once. You are asked to develop a system to sell segments of slots and choose ads in accordance with the rules described above." "data structures" 3200
303D "Rotatable Number" "Bike is a smart boy who loves math very much. He invented a number called ""Rotatable Number"" inspired by 142857. As you can see, 142857 is a magic number because any of its rotatings can be got by multiplying that number by 1,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x896 (numbers from one to number\'s length). Rotating a number means putting its last several digit into first. For example, by rotating number 12345 you can obtain any numbers: 12345,\xe2\x80\x8951234,\xe2\x80\x8945123,\xe2\x80\x8934512,\xe2\x80\x8923451. It\'s worth mentioning that leading-zeroes are allowed. So both 4500123 and 0123450 can be obtained by rotating 0012345. You can see why 142857 satisfies the condition. All of the 6 equations are under base 10.  142857\xc2\xb71\xe2\x80\x89=\xe2\x80\x89142857;  142857\xc2\xb72\xe2\x80\x89=\xe2\x80\x89285714;  142857\xc2\xb73\xe2\x80\x89=\xe2\x80\x89428571;  142857\xc2\xb74\xe2\x80\x89=\xe2\x80\x89571428;  142857\xc2\xb75\xe2\x80\x89=\xe2\x80\x89714285;  142857\xc2\xb76\xe2\x80\x89=\xe2\x80\x89857142. Now, Bike has a problem. He extends ""Rotatable Number"" under any base b. As is mentioned above, 142857 is a ""Rotatable Number"" under base 10. Another example is 0011 under base 2. All of the 4 equations are under base 2.  0011\xc2\xb71\xe2\x80\x89=\xe2\x80\x890011;  0011\xc2\xb710\xe2\x80\x89=\xe2\x80\x890110;  0011\xc2\xb711\xe2\x80\x89=\xe2\x80\x891001;  0011\xc2\xb7100\xe2\x80\x89=\xe2\x80\x891100. So, he wants to find the largest b (1\xe2\x80\x89<\xe2\x80\x89b\xe2\x80\x89<\xe2\x80\x89x) so that there is a positive ""Rotatable Number"" (leading-zeroes allowed) of length n under base b.Note that any time you multiply a rotatable number by numbers from 1 to its length you should get a rotating of that number." "math,number theory" 2600
1468H "K and Medians" "Let\'s denote the median of a sequence s with odd length as the value in the middle of s if we sort s in non-decreasing order. For example, let s=[1,2,5,7,2,3,12]. After sorting, we get sequence [1,2,2,3_,5,7,12], and the median is equal to 3.You have a sequence of n integers [1,2,\xe2\x80\xa6,n] and an odd integer k.In one step, you choose any k elements from the sequence and erase all chosen elements except their median. These elements do not have to go continuously (gaps are allowed between them).For example, if you have a sequence [1,2,3,4,5,6,7] (i.e. n=7) and k=3, then the following options for the first step are possible:  choose [1,2_,3]; 2 is their median, so it is not erased, and the resulting sequence is [2,4,5,6,7];  choose [2,4_,6]; 4 is their median, so it is not erased, and the resulting sequence is [1,3,4,5,7];  choose [1,6_,7]; 6 is their median, so it is not erased, and the resulting sequence is [2,3,4,5,6];  and several others. You can do zero or more steps. Can you get a sequence b1, b2, ..., bm after several steps?You\'ll be given t test cases. Solve each test case independently." "constructive algorithms,greedy,math" 2200
1778E "The Tree Has Fallen!" "Recently, a tree has fallen on Bob\'s head from the sky. The tree has n nodes. Each node u of the tree has an integer number au written on it. But the tree has no fixed root, as it has fallen from the sky.Bob is currently studying the tree. To add some twist, Alice proposes a game. First, Bob chooses some node r to be the root of the tree. After that, Alice chooses a node v and tells him. Bob then can pick one or more nodes from the subtree of v. His score will be the bitwise XOR of all the values written on the nodes picked by him. Bob has to find the maximum score he can achieve for the given r and v.As Bob is not a good problem-solver, he asks you to help him find the answer. Can you help him? You need to find the answers for several combinations of r and v for the same tree.Recall that a tree is a connected undirected graph without cycles. The subtree of a node u is the set of all nodes y such that the simple path from y to the root passes through u. Note that u is in the subtree of u." "bitmasks,dfs and similar,math,trees" 2500
1251A "Broken Keyboard" "Recently Polycarp noticed that some of the buttons of his keyboard are malfunctioning. For simplicity, we assume that Polycarp\'s keyboard contains 26 buttons (one for each letter of the Latin alphabet). Each button is either working fine or malfunctioning. To check which buttons need replacement, Polycarp pressed some buttons in sequence, and a string s appeared on the screen. When Polycarp presses a button with character c, one of the following events happened:  if the button was working correctly, a character c appeared at the end of the string Polycarp was typing;  if the button was malfunctioning, two characters c appeared at the end of the string. For example, suppose the buttons corresponding to characters a and c are working correctly, and the button corresponding to b is malfunctioning. If Polycarp presses the buttons in the order a, b, a, c, a, b, a, then the string he is typing changes as follows: a \xe2\x86\x92 abb \xe2\x86\x92 abba \xe2\x86\x92 abbac \xe2\x86\x92 abbaca \xe2\x86\x92 abbacabb \xe2\x86\x92 abbacabba.You are given a string s which appeared on the screen after Polycarp pressed some buttons. Help Polycarp to determine which buttons are working correctly for sure (that is, this string could not appear on the screen if any of these buttons was malfunctioning).You may assume that the buttons don\'t start malfunctioning when Polycarp types the string: each button either works correctly throughout the whole process, or malfunctions throughout the whole process." "brute force,strings,two pointers" 1000
269D "Maximum Waterfall" "Emuskald was hired to design an artificial waterfall according to the latest trends in landscape architecture. A modern artificial waterfall consists of multiple horizontal panels affixed to a wide flat wall. The water flows down the top of the wall from panel to panel until it reaches the bottom of the wall.The wall has height t and has n panels on the wall. Each panel is a horizontal segment at height hi which begins at li and ends at ri. The i-th panel connects the points (li,\xe2\x80\x89hi) and (ri,\xe2\x80\x89hi) of the plane. The top of the wall can be considered a panel connecting the points (\xe2\x80\x89-\xe2\x80\x89109,\xe2\x80\x89t) and (109,\xe2\x80\x89t). Similarly, the bottom of the wall can be considered a panel connecting the points (\xe2\x80\x89-\xe2\x80\x89109,\xe2\x80\x890) and (109,\xe2\x80\x890). No two panels share a common point.Emuskald knows that for the waterfall to be aesthetically pleasing, it can flow from panel i to panel j () only if the following conditions hold:   max(li,\xe2\x80\x89lj)\xe2\x80\x89<\xe2\x80\x89min(ri,\xe2\x80\x89rj) (horizontal projections of the panels overlap);  hj\xe2\x80\x89<\xe2\x80\x89hi (panel j is below panel i);  there is no such panel k (hj\xe2\x80\x89<\xe2\x80\x89hk\xe2\x80\x89<\xe2\x80\x89hi) that the first two conditions hold for the pairs (i,\xe2\x80\x89k) and (k,\xe2\x80\x89j). Then the flow for  is equal to min(ri,\xe2\x80\x89rj)\xe2\x80\x89-\xe2\x80\x89max(li,\xe2\x80\x89lj), the length of their horizontal projection overlap.Emuskald has decided that in his waterfall the water will flow in a single path from top to bottom. If water flows to a panel (except the bottom of the wall), the water will fall further to exactly one lower panel. The total amount of water flow in the waterfall is then defined as the minimum horizontal projection overlap between two consecutive panels in the path of the waterfall. Formally:   the waterfall consists of a single path of panels ;  the flow of the waterfall is the minimum flow in the path .  To make a truly great waterfall Emuskald must maximize this water flow, but there are too many panels and he is having a hard time planning his creation. Below is an example of a waterfall Emuskald wants:  Help Emuskald maintain his reputation and find the value of the maximum possible water flow." "data structures,dp,graphs,sortings" 2600
1083E "The Fair Nut and Rectangles" "The Fair Nut got stacked in planar world. He should solve this task to get out.You are given n rectangles with vertexes in (0,0), (xi,0), (xi,yi), (0,yi). For each rectangle, you are also given a number ai. Choose some of them that the area of union minus sum of ai of the chosen ones is maximum.It is guaranteed that there are no nested rectangles.Nut has no idea how to find the answer, so he asked for your help." "data structures,dp,geometry" 2400
1550A "Find The Array" "Let\'s call an array a consisting of n positive (greater than 0) integers beautiful if the following condition is held for every i from 1 to n: either ai=1, or at least one of the numbers ai\xe2\x88\x921 and ai\xe2\x88\x922 exists in the array as well.For example:   the array [5,3,1] is beautiful: for a1, the number a1\xe2\x88\x922=3 exists in the array; for a2, the number a2\xe2\x88\x922=1 exists in the array; for a3, the condition a3=1 holds;  the array [1,2,2,2,2] is beautiful: for a1, the condition a1=1 holds; for every other number ai, the number ai\xe2\x88\x921=1 exists in the array;  the array [1,4] is not beautiful: for a2, neither a2\xe2\x88\x922=2 nor a2\xe2\x88\x921=3 exists in the array, and a2\xe2\x89\xa01;  the array [2] is not beautiful: for a1, neither a1\xe2\x88\x921=1 nor a1\xe2\x88\x922=0 exists in the array, and a1\xe2\x89\xa01;  the array [2,1,3] is beautiful: for a1, the number a1\xe2\x88\x921=1 exists in the array; for a2, the condition a2=1 holds; for a3, the number a3\xe2\x88\x922=1 exists in the array. You are given a positive integer s. Find the minimum possible size of a beautiful array with the sum of elements equal to s." greedy,math 800
1B Spreadsheet "In the popular spreadsheets systems (for example, in Excel) the following numeration of columns is used. The first column has number A, the second \xe2\x80\x94 number B, etc. till column 26 that is marked by Z. Then there are two-letter numbers: column 27 has number AA, 28 \xe2\x80\x94 AB, column 52 is marked by AZ. After ZZ there follow three-letter numbers, etc.The rows are marked by integer numbers starting with 1. The cell name is the concatenation of the column and the row numbers. For example, BC23 is the name for the cell that is in column 55, row 23. Sometimes another numeration system is used: RXCY, where X and Y are integer numbers, showing the column and the row numbers respectfully. For instance, R23C55 is the cell from the previous example.Your task is to write a program that reads the given sequence of cell coordinates and produce each item written according to the rules of another numeration system." implementation,math 1600
1004F "Sonya and Bitwise OR" "Sonya has an array a1,a2,\xe2\x80\xa6,an consisting of n integers and also one non-negative integer x. She has to perform m queries of two types:  1 i y: replace i-th element by value y, i.e. to perform an operation ai := y;  2 l r: find the number of pairs (L, R) that l\xe2\x89\xa4L\xe2\x89\xa4R\xe2\x89\xa4r and bitwise OR of all integers in the range [L,R] is at least x (note that x is a constant for all queries). Can you help Sonya perform all her queries?Bitwise OR is a binary operation on a pair of non-negative integers. To calculate the bitwise OR of two numbers, you need to write both numbers in binary notation. The result is a number, in binary, which contains a one in each digit if there is a one in the binary notation of at least one of the two numbers. For example, 10 OR 19 = 10102 OR 100112 = 110112 = 27." "bitmasks,data structures,divide and conquer" 2600
1625C "Road Optimization" "The Government of Mars is not only interested in optimizing space flights, but also wants to improve the road system of the planet.One of the most important highways of Mars connects Olymp City and Kstolop, the capital of Cydonia. In this problem, we only consider the way from Kstolop to Olymp City, but not the reverse path (i. e. the path from Olymp City to Kstolop).The road from Kstolop to Olymp City is \xe2\x84\x93 kilometers long. Each point of the road has a coordinate x (0\xe2\x89\xa4x\xe2\x89\xa4\xe2\x84\x93), which is equal to the distance from Kstolop in kilometers. So, Kstolop is located in the point with coordinate 0, and Olymp City is located in the point with coordinate \xe2\x84\x93.There are n signs along the road, i-th of which sets a speed limit ai. This limit means that the next kilometer must be passed in ai minutes and is active until you encounter the next along the road. There is a road sign at the start of the road (i. e. in the point with coordinate 0), which sets the initial speed limit.If you know the location of all the signs, it\'s not hard to calculate how much time it takes to drive from Kstolop to Olymp City. Consider an example:  Here, you need to drive the first three kilometers in five minutes each, then one kilometer in eight minutes, then four kilometers in three minutes each, and finally the last two kilometers must be passed in six minutes each. Total time is 3\xe2\x8b\x855+1\xe2\x8b\x858+4\xe2\x8b\x853+2\xe2\x8b\x856=47 minutes.To optimize the road traffic, the Government of Mars decided to remove no more than k road signs. It cannot remove the sign at the start of the road, otherwise, there will be no limit at the start. By removing these signs, the Government also wants to make the time needed to drive from Kstolop to Olymp City as small as possible.The largest industrial enterprises are located in Cydonia, so it\'s the priority task to optimize the road traffic from Olymp City. So, the Government of Mars wants you to remove the signs in the way described above." dp 1700
1346C "Spring Cleaning" "Tanya wants to organize her bookcase. There are n bookshelves in the bookcase, the i-th bookshelf contains ai books on it. Tanya will be satisfied if each bookshelf contains no more than k books.Tanya can do one of the two following operations to achieve her goal:   Choose exactly one bookshelf and put all the books from it in the storage room (i.\xe2\x80\x89e. choose some i and assign ai:=0). During this operation she spends x seconds.  Take all books from all n bookshelves and distribute them between all n bookshelves evenly (the definition of the term is given below). During this operation she spends y seconds. Consider the sequence a of n integers. Then its even distribution is such a sequence b of n integers that the sum of b equals the sum of a and the value max(b)\xe2\x88\x92min(b) is the minimum possible.For example, if the array a=[5,4,3] then its even distribution is b=[4,4,4]. If a=[1,2,3,4] then its even distribution is b=[2,3,3,2] (or any permutation of this array).Your task is to find the minimum number of seconds Tanya has to spend to obtain the bookcase with no more than k books on each bookshelf." "*special problem,greedy,sortings" 1600
1497E1 "Square-Free Division (easy version)" "This is the easy version of the problem. The only difference is that in this version k=0.There is an array a1,a2,\xe2\x80\xa6,an of n positive integers. You should divide it into a minimal number of continuous segments, such that in each segment there are no two numbers (on different positions), whose product is a perfect square.Moreover, it is allowed to do at most k such operations before the division: choose a number in the array and change its value to any positive integer. But in this version k=0, so it is not important.What is the minimum number of continuous segments you should use if you will make changes optimally?" "data structures,dp,greedy,math,number theory,two pointers" 1700
1089A "Alice the Fan" "Alice is a big fan of volleyball and especially of the very strong ""Team A"".Volleyball match consists of up to five sets. During each set teams score one point for winning a ball. The first four sets are played until one of the teams scores at least 25 points and the fifth set is played until one of the teams scores at least 15 points. Moreover, if one of the teams scores 25 (or 15 in the fifth set) points while the other team scores 24 (or 14 in the fifth set), the set is played until the absolute difference between teams\' points becomes two. The match ends when one of the teams wins three sets. The match score is the number of sets won by each team.Alice found a book containing all the results of all matches played by ""Team A"". The book is old, and some parts of the book became unreadable. Alice can not read the information on how many sets each of the teams won, she can not read the information on how many points each of the teams scored in each set, she even does not know the number of sets played in a match. The only information she has is the total number of points scored by each of the teams in all the sets during a single match.Alice wonders what is the best match score ""Team A"" could achieve in each of the matches. The bigger is the difference between the number of sets won by ""Team A"" and their opponent, the better is the match score. Find the best match score or conclude that no match could end like that. If there is a solution, then find any possible score for each set that results in the best match score." dp 2200
1008A Romaji "Vitya has just started learning Berlanese language. It is known that Berlanese uses the Latin alphabet. Vowel letters are ""a"", ""o"", ""u"", ""i"", and ""e"". Other letters are consonant.In Berlanese, there has to be a vowel after every consonant, but there can be any letter after any vowel. The only exception is a consonant ""n""; after this letter, there can be any letter (not only a vowel) or there can be no letter at all. For example, the words ""harakiri"", ""yupie"", ""man"", and ""nbo"" are Berlanese while the words ""horse"", ""king"", ""my"", and ""nz"" are not.Help Vitya find out if a word s is Berlanese." implementation,strings 900
961A Tetris "You are given a following process. There is a platform with n columns. 1\xc3\x971 squares are appearing one after another in some columns on this platform. If there are no squares in the column, a square will occupy the bottom row. Otherwise a square will appear at the top of the highest square of this column. When all of the n columns have at least one square in them, the bottom row is being removed. You will receive 1 point for this, and all the squares left will fall down one row. You task is to calculate the amount of points you will receive." implementation 900
1651B "Prove Him Wrong" "Recently, your friend discovered one special operation on an integer array a:   Choose two indices i and j (i\xe2\x89\xa0j);  Set ai=aj=|ai\xe2\x88\x92aj|. After playing with this operation for a while, he came to the next conclusion:   For every array a of n integers, where 1\xe2\x89\xa4ai\xe2\x89\xa4109, you can find a pair of indices (i,j) such that the total sum of a will decrease after performing the operation. This statement sounds fishy to you, so you want to find a counterexample for a given integer n. Can you find such counterexample and prove him wrong?In other words, find an array a consisting of n integers a1,a2,\xe2\x80\xa6,an (1\xe2\x89\xa4ai\xe2\x89\xa4109) such that for all pairs of indices (i,j) performing the operation won\'t decrease the total sum (it will increase or not change the sum)." "constructive algorithms,greedy" 800
1239F "Swiper, no swiping!" "I\'m the Map, I\'m the Map! I\'m the MAP!!!MapIn anticipation of new adventures Boots wanted to do a good deed. After discussion with the Map and Backpack, they decided to gift Dora a connected graph. After a long search, Boots chose t graph\'s variants, which Dora might like. However fox Swiper wants to spoil his plan.The Swiper knows, that Dora now is only able to count up to 3, so he has came up with a following idea. He wants to steal some non-empty set of vertices, so that the Dora won\'t notice the loss. He has decided to steal some non-empty set of vertices, so that after deletion of the stolen vertices and edges adjacent to them, every remaining vertex wouldn\'t change it\'s degree modulo 3. The degree of a vertex is the number of edges it is adjacent to. It would\'ve been suspicious to steal all the vertices, so Swiper needs another plan.Boots are sure, that the crime can not be allowed. However they are afraid, that they won\'t be able to handle this alone. So Boots decided to ask for your help. Please determine for every graph\'s variant whether the Swiper can perform the theft or not." graphs,implementation 3400
697B Barnicle "Barney is standing in a bar and starring at a pretty girl. He wants to shoot her with his heart arrow but he needs to know the distance between him and the girl to make his shot accurate.  Barney asked the bar tender Carl about this distance value, but Carl was so busy talking to the customers so he wrote the distance value (it\'s a real number) on a napkin. The problem is that he wrote it in scientific notation. The scientific notation of some real number x is the notation of form AeB, where A is a real number and B is an integer and x\xe2\x80\x89=\xe2\x80\x89A\xe2\x80\x89\xc3\x97\xe2\x80\x8910B is true. In our case A is between 0 and 9 and B is non-negative.Barney doesn\'t know anything about scientific notation (as well as anything scientific at all). So he asked you to tell him the distance value in usual decimal representation with minimal number of digits after the decimal point (and no decimal point if it is an integer). See the output format for better understanding." "brute force,implementation,math,strings" 1400
469A "I Wanna Be the Guy" "There is a game called ""I Wanna Be the Guy"", consisting of n levels. Little X and his friend Little Y are addicted to the game. Each of them wants to pass the whole game.Little X can pass only p levels of the game. And Little Y can pass only q levels of the game. You are given the indices of levels Little X can pass and the indices of levels Little Y can pass. Will Little X and Little Y pass the whole game, if they cooperate each other?" greedy,implementation 800
679A "Bear and Prime 100" "This is an interactive problem. In the output section below you will see the information about flushing the output.Bear Limak thinks of some hidden number \xe2\x80\x94 an integer from interval [2,\xe2\x80\x89100]. Your task is to say if the hidden number is prime or composite.Integer x\xe2\x80\x89>\xe2\x80\x891 is called prime if it has exactly two distinct divisors, 1 and x. If integer x\xe2\x80\x89>\xe2\x80\x891 is not prime, it\'s called composite.You can ask up to 20 queries about divisors of the hidden number. In each query you should print an integer from interval [2,\xe2\x80\x89100]. The system will answer ""yes"" if your integer is a divisor of the hidden number. Otherwise, the answer will be ""no"".For example, if the hidden number is 14 then the system will answer ""yes"" only if you print 2, 7 or 14.When you are done asking queries, print ""prime"" or ""composite"" and terminate your program.You will get the Wrong Answer verdict if you ask more than 20 queries, or if you print an integer not from the range [2,\xe2\x80\x89100]. Also, you will get the Wrong Answer verdict if the printed answer isn\'t correct.You will get the Idleness Limit Exceeded verdict if you don\'t print anything (but you should) or if you forget about flushing the output (more info below)." "constructive algorithms,interactive,math" 1400
1192A "Building Skyscrapers" "We are going to build a new city: the Metropolis. The city is going to be built on an infinite square grid. The finished city will consist of n skyscrapers, each occupying a different cell of the grid. At any moment during the construction, the cells that currently do not contain a skyscraper are called empty.You are given the planned coordinates of the n skyscrapers. Your task is to find an order in which they can be built while satisfying the rules listed below.  The building crew has only one crane, so the Metropolis has to be constructed one skyscraper at a time.  The first skyscraper can be built anywhere on the grid.  Each subsequent skyscraper has to share a side or a corner with at least one of the previously built skyscrapers (so that it\'s easier to align the new skyscraper to the grid properly).  When building a skyscraper, there has to be a way to deliver material to the construction site from the outside of Metropolis by only moving it through empty cells that share a side. In other words, there should be a path of side-adjacent empty cells that connects the cell that will contain the skyscraper to some cell (r,c) with |r|>109 and/or |c|>109. If a solution exists, let\'s denote the numbers of skyscrapers in the order in which they should be built by s1,\xe2\x80\xa6,sn. There are two types of subtasks:Type 1: You may produce any valid order.Type 2: You must find the order that maximizes sn. Among those, you must find the one that maximizes sn\xe2\x88\x921. And so on. In other words, you must find the valid order of building for which the sequence (sn,sn\xe2\x88\x921,\xe2\x80\xa6,s1) is lexicographically largest." "*special problem" -999
928B Chat "There are times you recall a good old friend and everything you\'ve come through together. Luckily there are social networks \xe2\x80\x94 they store all your message history making it easy to know what you argued over 10 years ago.More formal, your message history is a sequence of messages ordered by time sent numbered from 1 to n where n is the total number of messages in the chat.Each message might contain a link to an earlier message which it is a reply to. When opening a message x or getting a link to it, the dialogue is shown in such a way that k previous messages, message x and k next messages are visible (with respect to message x). In case there are less than k messages somewhere, they are yet all shown.Digging deep into your message history, you always read all visible messages and then go by the link in the current message x (if there is one) and continue reading in the same manner.Determine the number of messages you\'ll read if your start from message number t for all t from 1 to n. Calculate these numbers independently. If you start with message x, the initial configuration is x itself, k previous and k next messages. Messages read multiple times are considered as one." "*special problem,dp" 1400
547E "Mike and Friends" "What-The-Fatherland is a strange country! All phone numbers there are strings consisting of lowercase English letters. What is double strange that a phone number can be associated with several bears!In that country there is a rock band called CF consisting of n bears (including Mike) numbered from 1 to n.   Phone number of i-th member of CF is si. May 17th is a holiday named Phone Calls day. In the last Phone Calls day, everyone called all the numbers that are substrings of his/her number (one may call some number several times). In particular, everyone called himself (that was really strange country).Denote as call(i,\xe2\x80\x89j) the number of times that i-th member of CF called the j-th member of CF. The geek Mike has q questions that he wants to ask you. In each question he gives you numbers l,\xe2\x80\x89r and k and you should tell him the number" "data structures,string suffix structures,strings,trees" 2800
191C "Fools and Roads" "They say that Berland has exactly two problems, fools and roads. Besides, Berland has n cities, populated by the fools and connected by the roads. All Berland roads are bidirectional. As there are many fools in Berland, between each pair of cities there is a path (or else the fools would get upset). Also, between each pair of cities there is no more than one simple path (or else the fools would get lost). But that is not the end of Berland\'s special features. In this country fools sometimes visit each other and thus spoil the roads. The fools aren\'t very smart, so they always use only the simple paths.A simple path is the path which goes through every Berland city not more than once.The Berland government knows the paths which the fools use. Help the government count for each road, how many distinct fools can go on it.Note how the fools\' paths are given in the input." "data structures,dfs and similar,trees" 1900
837E "Vasya\'s Function" "Vasya is studying number theory. He has denoted a function f(a,\xe2\x80\x89b) such that:  f(a,\xe2\x80\x890)\xe2\x80\x89=\xe2\x80\x890;  f(a,\xe2\x80\x89b)\xe2\x80\x89=\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x89f(a,\xe2\x80\x89b\xe2\x80\x89-\xe2\x80\x89gcd(a,\xe2\x80\x89b)), where gcd(a,\xe2\x80\x89b) is the greatest common divisor of a and b. Vasya has two numbers x and y, and he wants to calculate f(x,\xe2\x80\x89y). He tried to do it by himself, but found out that calculating this function the way he wants to do that might take very long time. So he decided to ask you to implement a program that will calculate this function swiftly." "binary search,implementation,math" 2100
855A "Tom Riddle\'s Diary" "Harry Potter is on a mission to destroy You-Know-Who\'s Horcruxes. The first Horcrux that he encountered in the Chamber of Secrets is Tom Riddle\'s diary. The diary was with Ginny and it forced her to open the Chamber of Secrets. Harry wants to know the different people who had ever possessed the diary to make sure they are not under its influence.He has names of n people who possessed the diary in order. You need to tell, for each person, if he/she possessed the diary at some point before or not.Formally, for a name si in the i-th line, output ""YES"" (without quotes) if there exists an index j such that si\xe2\x80\x89=\xe2\x80\x89sj and j\xe2\x80\x89<\xe2\x80\x89i, otherwise, output ""NO"" (without quotes)." "brute force,implementation,strings" 800
1886C "Decreasing String" "Recall that string a is lexicographically smaller than string b if a is a prefix of b (and a\xe2\x89\xa0b), or there exists an index i (1\xe2\x89\xa4i\xe2\x89\xa4min(|a|,|b|)) such that ai<bi, and for any index j (1\xe2\x89\xa4j<i) aj=bj.Consider a sequence of strings s1,s2,\xe2\x80\xa6,sn, each consisting of lowercase Latin letters. String s1 is given explicitly, and all other strings are generated according to the following rule: to obtain the string si, a character is removed from string si\xe2\x88\x921 in such a way that string si is lexicographically minimal.For example, if s1=dacb, then string s2=acb, string s3=ab, string s4=a.After that, we obtain the string S=s1+s2+\xe2\x8b\xaf+sn (S is the concatenation of all strings s1,s2,\xe2\x80\xa6,sn).You need to output the character in position pos of the string S (i.\xe2\x80\x89e. the character Spos)." implementation,strings 1600
1497A Meximization "You are given an integer n and an array a1,a2,\xe2\x80\xa6,an. You should reorder the elements of the array a in such way that the sum of MEX on prefixes (i-th prefix is a1,a2,\xe2\x80\xa6,ai) is maximized.Formally, you should find an array b1,b2,\xe2\x80\xa6,bn, such that the sets of elements of arrays a and b are equal (it is equivalent to array b can be found as an array a with some reordering of its elements) and n\xe2\x88\x91i=1MEX(b1,b2,\xe2\x80\xa6,bi) is maximized.MEX of a set of nonnegative integers is the minimal nonnegative integer such that it is not in the set.For example, MEX({1,2,3})=0, MEX({0,1,2,4,5})=3." "brute force,data structures,greedy,sortings" 800
1285C "Fadi and LCM" "Today, Osama gave Fadi an integer X, and Fadi was wondering about the minimum possible value of max(a,b) such that LCM(a,b) equals X. Both a and b should be positive integers.LCM(a,b) is the smallest positive integer that is divisible by both a and b. For example, LCM(6,8)=24, LCM(4,12)=12, LCM(2,3)=6.Of course, Fadi immediately knew the answer. Can you be just like Fadi and find any such pair?" "brute force,math,number theory" 1400
1186E "Vus the Cossack and a Field" "Vus the Cossack has a field with dimensions n\xc3\x97m, which consists of ""0"" and ""1"". He is building an infinite field from this field. He is doing this in this way: He takes the current field and finds a new inverted field. In other words, the new field will contain ""1"" only there, where ""0"" was in the current field, and ""0"" there, where ""1"" was. To the current field, he adds the inverted field to the right.  To the current field, he adds the inverted field to the bottom.  To the current field, he adds the current field to the bottom right.  He repeats it.For example, if the initial field was: 1011 After the first iteration, the field will be like this: 1001110001100011 After the second iteration, the field will be like this: 1001011011000011011010010011110001101001001111001001011011000011 And so on...Let\'s numerate lines from top to bottom from 1 to infinity, and columns from left to right from 1 to infinity. We call the submatrix (x1,y1,x2,y2) all numbers that have coordinates (x,y) such that x1\xe2\x89\xa4x\xe2\x89\xa4x2 and y1\xe2\x89\xa4y\xe2\x89\xa4y2.The Cossack needs sometimes to find the sum of all the numbers in submatrices. Since he is pretty busy right now, he is asking you to find the answers!" "divide and conquer,implementation,math" 2500
1791B "Following Directions" "Alperen is standing at the point (0,0). He is given a string s of length n and performs n moves. The i-th move is as follows:   if si=L, then move one unit left;  if si=R, then move one unit right;  if si=U, then move one unit up;  if si=D, then move one unit down.    If Alperen starts at the center point, he can make the four moves shown.  There is a candy at (1,1) (that is, one unit above and one unit to the right of Alperen\'s starting point). You need to determine if Alperen ever passes the candy.   Alperen\'s path in the first test case." geometry,implementation 800
1781E "Rectangle Shrinking" "You have a rectangular grid of height 2 and width 109 consisting of unit cells. There are n rectangles placed on this grid, and the borders of these rectangles pass along cell borders. The i-th rectangle covers all cells in rows from ui to di inclusive and columns from li to ri inclusive (1\xe2\x89\xa4ui\xe2\x89\xa4di\xe2\x89\xa42; 1\xe2\x89\xa4li\xe2\x89\xa4ri\xe2\x89\xa4109). The initial rectangles can intersect, be nested, and coincide arbitrarily.You should either remove each rectangle, or replace it with any of its non-empty subrectangles. In the latter case, the new subrectangle must lie inside the initial rectangle, and its borders must still pass along cell borders. In particular, it is allowed for the subrectangle to be equal to the initial rectangle.After that replacement, no two (non-removed) rectangles are allowed to have common cells, and the total area covered with the new rectangles must be as large as possible.  Illustration for the first test case. The initial rectangles are given at the top, the new rectangles are given at the bottom. Rectangle number 4 is removed." "binary search,brute force,data structures,greedy,implementation,two pointers" 2300
392D "Three Arrays" "There are three arrays a, b and c. Each of them consists of n integers. SmallY wants to find three integers u, v, w (0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89u,\xe2\x80\x89v,\xe2\x80\x89w\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) such that the following condition holds: each number that appears in the union of a, b and c, appears either in the first u elements of a, or in the first v elements of b, or in the first w elements of c. Of course, SmallY doesn\'t want to have huge numbers u, v and w, so she wants sum u\xe2\x80\x89+\xe2\x80\x89v\xe2\x80\x89+\xe2\x80\x89w to be as small as possible.Please, help her to find the minimal possible sum of u\xe2\x80\x89+\xe2\x80\x89v\xe2\x80\x89+\xe2\x80\x89w." "data structures" -999
1804F "Approximate Diameter" "Jack has a graph of n vertices and m edges. All edges are bidirectional and of unit length. The graph is connected, i. e. there exists a path between any two of its vertices. There can be more than one edge connecting the same pair of vertices. The graph can contain self-loops, i. e. edges connecting a node to itself.The distance between vertices u and v is denoted as \xcf\x81(u,v) and equals the minimum possible number of edges on a path between u and v. The diameter of graph G is defined as the maximum possible distance between some pair of its vertices. We denote it as d(G). In other words, d(G)=max1\xe2\x89\xa4u,v\xe2\x89\xa4n\xcf\x81(u,v).Jack plans to consecutively apply q updates to his graph. Each update adds exactly one edge to the graph. Denote as Gi the graph after exactly i updates are made. Jack wants to calculate q+1 values d(G0),d(G1),d(G2),\xe2\x80\xa6,d(Gq).However, Jack suspects that finding the exact diameters of q+1 graphs might be a difficult task, so he is fine with approximate answers that differ from the correct answers no more than twice. Formally, Jack wants to find a sequence of positive integers a0,a1,a2,\xe2\x80\xa6,aq such that \xe2\x8c\x88d(Gi)2\xe2\x8c\x89\xe2\x89\xa4ai\xe2\x89\xa42\xe2\x8b\x85d(Gi) for each i.HacksYou cannot make hacks in this problem." "binary search,divide and conquer,graphs,shortest paths" 2700
899B "Months and Years" "Everybody in Russia uses Gregorian calendar. In this calendar there are 31 days in January, 28 or 29 days in February (depending on whether the year is leap or not), 31 days in March, 30 days in April, 31 days in May, 30 in June, 31 in July, 31 in August, 30 in September, 31 in October, 30 in November, 31 in December.A year is leap in one of two cases: either its number is divisible by 4, but not divisible by 100, or is divisible by 400. For example, the following years are leap: 2000, 2004, but years 1900 and 2018 are not leap.In this problem you are given n (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x8924) integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an, and you have to check if these integers could be durations in days of n consecutive months, according to Gregorian calendar. Note that these months could belong to several consecutive years. In other words, check if there is a month in some year, such that its duration is a1 days, duration of the next month is a2 days, and so on." implementation 1200
1628D2 "Game on Sum (Hard Version)" "This is the hard version of the problem. The difference is the constraints on n, m and t. You can make hacks only if all versions of the problem are solved.Alice and Bob are given the numbers n, m and k, and play a game as follows:The game has a score that Alice tries to maximize, and Bob tries to minimize. The score is initially 0. The game consists of n turns. Each turn, Alice picks a real number from 0 to k (inclusive) which Bob either adds to or subtracts from the score of the game. But throughout the game, Bob has to choose to add at least m out of the n turns.Bob gets to know which number Alice picked before deciding whether to add or subtract the number from the score, and Alice gets to know whether Bob added or subtracted the number for the previous turn before picking the number for the current turn (except on the first turn since there was no previous turn).If Alice and Bob play optimally, what will the final score of the game be?" combinatorics,dp,games,math 2400
1772C "Different Differences" "An array a consisting of k integers is strictly increasing if a1<a2<\xe2\x8b\xaf<ak. For example, the arrays [1,3,5], [1,2,3,4], [3,5,6] are strictly increasing; the arrays [2,2], [3,7,5], [7,4,3], [1,2,2,3] are not.For a strictly increasing array a of k elements, let\'s denote the characteristic as the number of different elements in the array [a2\xe2\x88\x92a1,a3\xe2\x88\x92a2,\xe2\x80\xa6,ak\xe2\x88\x92ak\xe2\x88\x921]. For example, the characteristic of the array [1,3,4,7,8] is 3 since the array [2,1,3,1] contains 3 different elements: 2, 1 and 3.You are given two integers k and n (k\xe2\x89\xa4n). Construct an increasing array of k integers from 1 to n with maximum possible characteristic." "constructive algorithms,greedy,math" 1000
572B "Order Book" "In this task you need to process a set of stock exchange orders and use them to create order book.An order is an instruction of some participant to buy or sell stocks on stock exchange. The order number i has price pi, direction di \xe2\x80\x94 buy or sell, and integer qi. This means that the participant is ready to buy or sell qi stocks at price pi for one stock. A value qi is also known as a volume of an order.All orders with the same price p and direction d are merged into one aggregated order with price p and direction d. The volume of such order is a sum of volumes of the initial orders.An order book is a list of aggregated orders, the first part of which contains sell orders sorted by price in descending order, the second contains buy orders also sorted by price in descending order.An order book of depth s contains s best aggregated orders for each direction. A buy order is better if it has higher price and a sell order is better if it has lower price. If there are less than s aggregated orders for some direction then all of them will be in the final order book.You are given n stock exhange orders. Your task is to print order book of depth s for these orders." "data structures,greedy,implementation,sortings" 1300
595B "Pasha and Phone" "Pasha has recently bought a new phone jPager and started adding his friends\' phone numbers there. Each phone number consists of exactly n digits.Also Pasha has a number k and two sequences of length n\xe2\x80\x89/\xe2\x80\x89k (n is divisible by k) a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an\xe2\x80\x89/\xe2\x80\x89k and b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bn\xe2\x80\x89/\xe2\x80\x89k. Let\'s split the phone number into blocks of length k. The first block will be formed by digits from the phone number that are on positions 1, 2,..., k, the second block will be formed by digits from the phone number that are on positions k\xe2\x80\x89+\xe2\x80\x891, k\xe2\x80\x89+\xe2\x80\x892, ..., 2\xc2\xb7k and so on. Pasha considers a phone number good, if the i-th block doesn\'t start from the digit bi and is divisible by ai if represented as an integer. To represent the block of length k as an integer, let\'s write it out as a sequence c1, c2,...,ck. Then the integer is calculated as the result of the expression c1\xc2\xb710k\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x89c2\xc2\xb710k\xe2\x80\x89-\xe2\x80\x892\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89ck.Pasha asks you to calculate the number of good phone numbers of length n, for the given k, ai and bi. As this number can be too big, print it modulo 109\xe2\x80\x89+\xe2\x80\x897." "binary search,math" 1600
297B "Fish Weight" "It is known that there are k fish species in the polar ocean, numbered from 1 to k. They are sorted by non-decreasing order of their weight, which is a positive number. Let the weight of the i-th type of fish be wi, then 0\xe2\x80\x89<\xe2\x80\x89w1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89w2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89...\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89wk holds.Polar bears Alice and Bob each have caught some fish, and they are guessing who has the larger sum of weight of the fish he/she\'s caught. Given the type of the fish they\'ve caught, determine whether it is possible that the fish caught by Alice has a strictly larger total weight than Bob\'s. In other words, does there exist a sequence of weights wi (not necessary integers), such that the fish caught by Alice has a strictly larger total weight?" "constructive algorithms,greedy" 1600
545D Queue "Little girl Susie went shopping with her mom and she wondered how to improve service quality. There are n people in the queue. For each person we know time ti needed to serve him. A person will be disappointed if the time he waits is more than the time needed to serve him. The time a person waits is the total time when all the people who stand in the queue in front of him are served. Susie thought that if we swap some people in the queue, then we can decrease the number of people who are disappointed. Help Susie find out what is the maximum number of not disappointed people can be achieved by swapping people in the queue." greedy,implementation,sortings 1300
1638F "Two Posters" "You want to advertise your new business, so you are going to place two posters on a billboard in the city center. The billboard consists of n vertical panels of width 1 and varying integer heights, held together by a horizontal bar. The i-th of the n panels has height hi.  Initially, all panels hang down from the bar (their top edges lie on it), but before placing the two posters, you are allowed to move each panel up by any integer length, as long as it is still connected to the bar (its bottom edge lies below or on it).After the moves are done, you will place two posters: one below the bar and one above it. They are not allowed to go over the bar and they must be positioned completely inside of the panels.What is the maximum total area the two posters can cover together if you make the optimal moves? Note that you can also place a poster of 0 area. This case is equivalent to placing a single poster." "brute force,data structures,greedy,two pointers" 3200
877E "Danil and a Part-time Job" "Danil decided to earn some money, so he had found a part-time job. The interview have went well, so now he is a light switcher.Danil works in a rooted tree (undirected connected acyclic graph) with n vertices, vertex 1 is the root of the tree. There is a room in each vertex, light can be switched on or off in each room. Danil\'s duties include switching light in all rooms of the subtree of the vertex. It means that if light is switched on in some room of the subtree, he should switch it off. Otherwise, he should switch it on.Unfortunately (or fortunately), Danil is very lazy. He knows that his boss is not going to personally check the work. Instead, he will send Danil tasks using Workforces personal messages.There are two types of tasks:  pow v describes a task to switch lights in the subtree of vertex v. get v describes a task to count the number of rooms in the subtree of v, in which the light is turned on. Danil should send the answer to his boss using Workforces messages.A subtree of vertex v is a set of vertices for which the shortest path from them to the root passes through v. In particular, the vertex v is in the subtree of v.Danil is not going to perform his duties. He asks you to write a program, which answers the boss instead of him." "bitmasks,data structures,trees" 2000
1055F "Tree and XOR" "You are given a connected undirected graph without cycles (that is, a tree) of n vertices, moreover, there is a non-negative integer written on every edge.Consider all pairs of vertices (v,u) (that is, there are exactly n2 such pairs) and for each pair calculate the bitwise exclusive or (xor) of all integers on edges of the simple path between v and u. If the path consists of one vertex only, then xor of all integers on edges of this path is equal to 0.Suppose we sorted the resulting n2 values in non-decreasing order. You need to find the k-th of them.The definition of xor is as follows.Given two integers x and y, consider their binary representations (possibly with leading zeros): xk\xe2\x80\xa6x2x1x0 and yk\xe2\x80\xa6y2y1y0 (where k is any number so that all bits of x and y can be represented). Here, xi is the i-th bit of the number x and yi is the i-th bit of the number y. Let r=x\xe2\x8a\x95y be the result of the xor operation of x and y. Then r is defined as rk\xe2\x80\xa6r2r1r0 where:ri={1, if xi\xe2\x89\xa0yi0, if xi=yi" strings,trees 2900
1091A "New Year and the Christmas Ornament" "Alice and Bob are decorating a Christmas Tree. Alice wants only 3 types of ornaments to be used on the Christmas Tree: yellow, blue and red. They have y yellow ornaments, b blue ornaments and r red ornaments.In Bob\'s opinion, a Christmas Tree will be beautiful if:  the number of blue ornaments used is greater by exactly 1 than the number of yellow ornaments, and  the number of red ornaments used is greater by exactly 1 than the number of blue ornaments. That is, if they have 8 yellow ornaments, 13 blue ornaments and 9 red ornaments, we can choose 4 yellow, 5 blue and 6 red ornaments (5=4+1 and 6=5+1).Alice wants to choose as many ornaments as possible, but she also wants the Christmas Tree to be beautiful according to Bob\'s opinion.In the example two paragraphs above, we would choose 7 yellow, 8 blue and 9 red ornaments. If we do it, we will use 7+8+9=24 ornaments. That is the maximum number.Since Alice and Bob are busy with preparing food to the New Year\'s Eve, they are asking you to find out the maximum number of ornaments that can be used in their beautiful Christmas Tree! It is guaranteed that it is possible to choose at least 6 (1+2+3=6) ornaments." "brute force,implementation,math" 800
1906E "Merge Not Sort" "You are currently researching the Merge Sort algorithm. Merge Sort is a sorting algorithm that is based on the principle of Divide and Conquer. It works by dividing an array into two subarrays of equal length, sorting each subarrays, then merging the sorted subarrays back together to form the final sorted array.You are particularly interested in the merging routine. Common merge implementation will combine two subarrays by iteratively comparing their first elements, and move the smaller one to a new merged array. More precisely, the merge algorithm can be presented by the following pseudocode.    Merge(A[1..N], B[1..N]):        C = []        i = 1        j = 1        while i <= N AND j <= N:            if A[i] < B[j]:                append A[i] to C                i = i + 1            else:                append B[j] to C                j = j + 1         while i <= N:            append A[i] to C            i = i + 1         while j <= N:            append B[j] to C            j = j + 1         return CDuring your research, you are keen to understand the behaviour of the merge algorithm when arrays A and B are not necessarily sorted. For example, if A=[3,1,6] and B=[4,5,2], then Merge(A,B)=[3,1,4,5,2,6].To further increase the understanding of the merge algorithm, you decided to work on the following problem. You are given an array C of length 2\xe2\x8b\x85N such that it is a permutation of 1 to 2\xe2\x8b\x85N. Construct any two arrays A and B of the same length N, such that Merge(A,B)=C, or determine if it is impossible to do so." "constructive algorithms,dp" 1900
1253A "Single Push" "You\'re given two arrays a[1\xe2\x80\xa6n] and b[1\xe2\x80\xa6n], both of the same length n.In order to perform a push operation, you have to choose three integers l,r,k satisfying 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n and k>0. Then, you will add k to elements al,al+1,\xe2\x80\xa6,ar.For example, if a=[3,7,1,4,1,2] and you choose (l=3,r=5,k=2), the array a will become [3,7,3,6,3_,2].You can do this operation at most once. Can you make array a equal to array b?(We consider that a=b if and only if, for every 1\xe2\x89\xa4i\xe2\x89\xa4n, ai=bi)" implementation 1000
379G "New Year Cactus" "Jack and Jill are tired of the New Year tree, now they\'ve got a New Year cactus at home! A cactus is a connected undirected graph where any two simple cycles have at most one common vertex. In other words, this graph doesn\'t have any edges that lie on more than one simple cycle.On the 31st of December they are going to decorate the cactus by hanging toys to its vertices. At most one toy is going to hang on each vertex \xe2\x80\x94 it\'s either the toy Jack hung or the toy Jill hung. It\'s possible for a vertex to have no toys.Jack and Jill has been arguing, so they don\'t want any edge to connect two vertices where one vertex has Jack\'s toy and the other vertex has Jill\'s toy.Jack has decided to hang a toys. What maximum number of toys b can Jill hang if they both cooperate to maximize this value? Your task is to write a program that finds the sought b for all a from 0 to the number of vertices on the New Year Cactus." dp 3100
1401D "Maximum Distributed Tree" "You are given a tree that consists of n nodes. You should label each of its n\xe2\x88\x921 edges with an integer in such way that satisfies the following conditions:   each integer must be greater than 0;  the product of all n\xe2\x88\x921 numbers should be equal to k;  the number of 1-s among all n\xe2\x88\x921 integers must be minimum possible. Let\'s define f(u,v) as the sum of the numbers on the simple path from node u to node v. Also, let n\xe2\x88\x921\xe2\x88\x91i=1n\xe2\x88\x91j=i+1f(i,j) be a distribution index of the tree.Find the maximum possible distribution index you can get. Since answer can be too large, print it modulo 109+7.In this problem, since the number k can be large, the result of the prime factorization of k is given instead." "dfs and similar,dp,greedy,implementation,math,number theory,sortings,trees" 1800
1634F "Fibonacci Additions" "One of my most productive days was throwing away 1,000 lines of code.\xe2\x80\x94 Ken ThompsonFibonacci addition is an operation on an array X of integers, parametrized by indices l and r. Fibonacci addition increases Xl by F1, increases Xl+1 by F2, and so on up to Xr which is increased by Fr\xe2\x88\x92l+1.Fi denotes the i-th Fibonacci number (F1=1, F2=1, Fi=Fi\xe2\x88\x921+Fi\xe2\x88\x922 for i>2), and all operations are performed modulo MOD.You are given two arrays A and B of the same length. We will ask you to perform several Fibonacci additions on these arrays with different parameters, and after each operation you have to report whether arrays A and B are equal modulo MOD." "brute force,data structures,hashing,implementation,math" 2700
638D "Three-dimensional Turtle Super Computer" "A super computer has been built in the Turtle Academy of Sciences. The computer consists of n\xc2\xb7m\xc2\xb7k CPUs. The architecture was the paralellepiped of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m\xe2\x80\x89\xc3\x97\xe2\x80\x89k, split into 1\xe2\x80\x89\xc3\x97\xe2\x80\x891\xe2\x80\x89\xc3\x97\xe2\x80\x891 cells, each cell contains exactly one CPU. Thus, each CPU can be simultaneously identified as a group of three numbers from the layer number from 1 to n, the line number from 1 to m and the column number from 1 to k.In the process of the Super Computer\'s work the CPUs can send each other messages by the famous turtle scheme: CPU (x,\xe2\x80\x89y,\xe2\x80\x89z) can send messages to CPUs (x\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89y,\xe2\x80\x89z), (x,\xe2\x80\x89y\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89z) and (x,\xe2\x80\x89y,\xe2\x80\x89z\xe2\x80\x89+\xe2\x80\x891) (of course, if they exist), there is no feedback, that is, CPUs (x\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89y,\xe2\x80\x89z), (x,\xe2\x80\x89y\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89z) and (x,\xe2\x80\x89y,\xe2\x80\x89z\xe2\x80\x89+\xe2\x80\x891) cannot send messages to CPU (x,\xe2\x80\x89y,\xe2\x80\x89z).Over time some CPUs broke down and stopped working. Such CPUs cannot send messages, receive messages or serve as intermediates in transmitting messages. We will say that CPU (a,\xe2\x80\x89b,\xe2\x80\x89c) controls CPU (d,\xe2\x80\x89e,\xe2\x80\x89f) , if there is a chain of CPUs (xi,\xe2\x80\x89yi,\xe2\x80\x89zi), such that (x1\xe2\x80\x89=\xe2\x80\x89a,\xe2\x80\x89y1\xe2\x80\x89=\xe2\x80\x89b,\xe2\x80\x89z1\xe2\x80\x89=\xe2\x80\x89c), (xp\xe2\x80\x89=\xe2\x80\x89d,\xe2\x80\x89yp\xe2\x80\x89=\xe2\x80\x89e,\xe2\x80\x89zp\xe2\x80\x89=\xe2\x80\x89f) (here and below p is the length of the chain) and the CPU in the chain with number i (i\xe2\x80\x89<\xe2\x80\x89p) can send messages to CPU i\xe2\x80\x89+\xe2\x80\x891.Turtles are quite concerned about the denial-proofness of the system of communication between the remaining CPUs. For that they want to know the number of critical CPUs. A CPU (x,\xe2\x80\x89y,\xe2\x80\x89z) is critical, if turning it off will disrupt some control, that is, if there are two distinctive from (x,\xe2\x80\x89y,\xe2\x80\x89z) CPUs: (a,\xe2\x80\x89b,\xe2\x80\x89c) and (d,\xe2\x80\x89e,\xe2\x80\x89f), such that (a,\xe2\x80\x89b,\xe2\x80\x89c) controls (d,\xe2\x80\x89e,\xe2\x80\x89f) before (x,\xe2\x80\x89y,\xe2\x80\x89z) is turned off and stopped controlling it after the turning off." "brute force,dfs and similar,graphs" 1800
1045D "Interstellar battle" "In the intergalactic empire Bubbledom there are N planets, of which some pairs are directly connected by two-way wormholes. There are N\xe2\x88\x921 wormholes. The wormholes are of extreme religious importance in Bubbledom, a set of planets in Bubbledom consider themselves one intergalactic kingdom if and only if any two planets in the set can reach each other by traversing the wormholes. You are given that Bubbledom is one kingdom. In other words, the network of planets and wormholes is a tree.However, Bubbledom is facing a powerful enemy also possessing teleportation technology. The enemy attacks every night, and the government of Bubbledom retakes all the planets during the day. In a single attack, the enemy attacks every planet of Bubbledom at once, but some planets are more resilient than others. Planets are number 0,1,\xe2\x80\xa6,N\xe2\x88\x921 and the planet i will fall with probability pi. Before every night (including the very first one), the government reinforces or weakens the defenses of a single planet.The government of Bubbledom is interested in the following question: what is the expected number of intergalactic kingdoms Bubbledom will be split into, after a single enemy attack (before they get a chance to rebuild)? In other words, you need to print the expected number of connected components after every attack." math,probabilities,trees 2200
1284E "New Year and Castle Construction" "Kiwon\'s favorite video game is now holding a new year event to motivate the users! The game is about building and defending a castle, which led Kiwon to think about the following puzzle.In a 2-dimension plane, you have a set s={(x1,y1),(x2,y2),\xe2\x80\xa6,(xn,yn)} consisting of n distinct points. In the set s, no three distinct points lie on a single line. For a point p\xe2\x88\x88s, we can protect this point by building a castle. A castle is a simple quadrilateral (polygon with 4 vertices) that strictly encloses the point p (i.e. the point p is strictly inside a quadrilateral). Kiwon is interested in the number of 4-point subsets of s that can be used to build a castle protecting p. Note that, if a single subset can be connected in more than one way to enclose a point, it is counted only once. Let f(p) be the number of 4-point subsets that can enclose the point p. Please compute the sum of f(p) for all points p\xe2\x88\x88s." combinatorics,geometry,math,sortings 2500
524A "\xd0\x92\xd0\xbe\xd0\xb7\xd0\xbc\xd0\xbe\xd0\xb6\xd0\xbd\xd0\xbe, \xd0\xb2\xd1\x8b \xd0\xb7\xd0\xbd\xd0\xb0\xd0\xb5\xd1\x82\xd0\xb5 \xd1\x8d\xd1\x82\xd0\xb8\xd1\x85 \xd0\xbb\xd1\x8e\xd0\xb4\xd0\xb5\xd0\xb9?" "\xd0\x9e\xd1\x81\xd0\xbd\xd0\xbe\xd0\xb2\xd0\xbe\xd0\xb9 \xd0\xbb\xd1\x8e\xd0\xb1\xd0\xbe\xd0\xb9 \xd1\x81\xd0\xbe\xd1\x86\xd0\xb8\xd0\xb0\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe\xd0\xb9 \xd1\x81\xd0\xb5\xd1\x82\xd0\xb8 \xd1\x8f\xd0\xb2\xd0\xbb\xd1\x8f\xd0\xb5\xd1\x82\xd1\x81\xd1\x8f \xd0\xbe\xd1\x82\xd0\xbd\xd0\xbe\xd1\x88\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb5 \xd0\xb4\xd1\x80\xd1\x83\xd0\xb6\xd0\xb1\xd1\x8b \xd0\xbc\xd0\xb5\xd0\xb6\xd0\xb4\xd1\x83 \xd0\xb4\xd0\xb2\xd1\x83\xd0\xbc\xd1\x8f \xd0\xbf\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xb7\xd0\xbe\xd0\xb2\xd0\xb0\xd1\x82\xd0\xb5\xd0\xbb\xd1\x8f\xd0\xbc\xd0\xb8 \xd0\xb2 \xd1\x82\xd0\xbe\xd0\xbc \xd0\xb8\xd0\xbb\xd0\xb8 \xd0\xb8\xd0\xbd\xd0\xbe\xd0\xbc \xd1\x81\xd0\xbc\xd1\x8b\xd1\x81\xd0\xbb\xd0\xb5. \xd0\x92 \xd0\xbe\xd0\xb4\xd0\xbd\xd0\xbe\xd0\xb9 \xd0\xb8\xd0\xb7\xd0\xb2\xd0\xb5\xd1\x81\xd1\x82\xd0\xbd\xd0\xbe\xd0\xb9 \xd1\x81\xd0\xbe\xd1\x86\xd0\xb8\xd0\xb0\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe\xd0\xb9 \xd1\x81\xd0\xb5\xd1\x82\xd0\xb8 \xd0\xb4\xd1\x80\xd1\x83\xd0\xb6\xd0\xb1\xd0\xb0 \xd1\x81\xd0\xb8\xd0\xbc\xd0\xbc\xd0\xb5\xd1\x82\xd1\x80\xd0\xb8\xd1\x87\xd0\xbd\xd0\xb0, \xd1\x82\xd0\xbe \xd0\xb5\xd1\x81\xd1\x82\xd1\x8c \xd0\xb5\xd1\x81\xd0\xbb\xd0\xb8 a \xd1\x8f\xd0\xb2\xd0\xbb\xd1\x8f\xd0\xb5\xd1\x82\xd1\x81\xd1\x8f \xd0\xb4\xd1\x80\xd1\x83\xd0\xb3\xd0\xbe\xd0\xbc b, \xd1\x82\xd0\xbe b \xd1\x82\xd0\xb0\xd0\xba\xd0\xb6\xd0\xb5 \xd1\x8f\xd0\xb2\xd0\xbb\xd1\x8f\xd0\xb5\xd1\x82\xd1\x81\xd1\x8f \xd0\xb4\xd1\x80\xd1\x83\xd0\xb3\xd0\xbe\xd0\xbc a. \xd0\x92 \xd1\x8d\xd1\x82\xd0\xbe\xd0\xb9 \xd0\xb6\xd0\xb5 \xd1\x81\xd0\xb5\xd1\x82\xd0\xb8 \xd0\xb5\xd1\x81\xd1\x82\xd1\x8c \xd1\x84\xd1\x83\xd0\xbd\xd0\xba\xd1\x86\xd0\xb8\xd1\x8f, \xd0\xba\xd0\xbe\xd1\x82\xd0\xbe\xd1\x80\xd0\xb0\xd1\x8f \xd0\xb4\xd0\xb5\xd0\xbc\xd0\xbe\xd0\xbd\xd1\x81\xd1\x82\xd1\x80\xd0\xb8\xd1\x80\xd1\x83\xd0\xb5\xd1\x82 \xd0\xbc\xd0\xbd\xd0\xbe\xd0\xb6\xd0\xb5\xd1\x81\xd1\x82\xd0\xb2\xd0\xbe \xd0\xbb\xd1\x8e\xd0\xb4\xd0\xb5\xd0\xb9, \xd0\xb8\xd0\xbc\xd0\xb5\xd1\x8e\xd1\x89\xd0\xb8\xd1\x85 \xd0\xb2\xd1\x8b\xd1\x81\xd0\xbe\xd0\xba\xd1\x83\xd1\x8e \xd0\xb2\xd0\xb5\xd1\x80\xd0\xbe\xd1\x8f\xd1\x82\xd0\xbd\xd0\xbe\xd1\x81\xd1\x82\xd1\x8c \xd0\xb1\xd1\x8b\xd1\x82\xd1\x8c \xd0\xb7\xd0\xbd\xd0\xb0\xd0\xba\xd0\xbe\xd0\xbc\xd1\x8b\xd0\xbc\xd0\xb8 \xd0\xb4\xd0\xbb\xd1\x8f \xd0\xbf\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xb7\xd0\xbe\xd0\xb2\xd0\xb0\xd1\x82\xd0\xb5\xd0\xbb\xd1\x8f. \xd0\xad\xd1\x82\xd0\xb0 \xd1\x84\xd1\x83\xd0\xbd\xd0\xba\xd1\x86\xd0\xb8\xd1\x8f \xd1\x80\xd0\xb0\xd0\xb1\xd0\xbe\xd1\x82\xd0\xb0\xd0\xb5\xd1\x82 \xd1\x81\xd0\xbb\xd0\xb5\xd0\xb4\xd1\x83\xd1\x8e\xd1\x89\xd0\xb8\xd0\xbc \xd0\xbe\xd0\xb1\xd1\x80\xd0\xb0\xd0\xb7\xd0\xbe\xd0\xbc. \xd0\x97\xd0\xb0\xd1\x84\xd0\xb8\xd0\xba\xd1\x81\xd0\xb8\xd1\x80\xd1\x83\xd0\xb5\xd0\xbc \xd0\xbf\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xb7\xd0\xbe\xd0\xb2\xd0\xb0\xd1\x82\xd0\xb5\xd0\xbb\xd1\x8f x. \xd0\x9f\xd1\x83\xd1\x81\xd1\x82\xd1\x8c \xd0\xbd\xd0\xb5\xd0\xba\xd0\xbe\xd1\x82\xd0\xbe\xd1\x80\xd1\x8b\xd0\xb9 \xd0\xb4\xd1\x80\xd1\x83\xd0\xb3\xd0\xbe\xd0\xb9 \xd1\x87\xd0\xb5\xd0\xbb\xd0\xbe\xd0\xb2\xd0\xb5\xd0\xba y, \xd0\xbd\xd0\xb5 \xd1\x8f\xd0\xb2\xd0\xbb\xd1\x8f\xd1\x8e\xd1\x89\xd0\xb8\xd0\xb9\xd1\x81\xd1\x8f \xd0\xb4\xd1\x80\xd1\x83\xd0\xb3\xd0\xbe\xd0\xbc x \xd0\xbd\xd0\xb0 \xd1\x82\xd0\xb5\xd0\xba\xd1\x83\xd1\x89\xd0\xb8\xd0\xb9 \xd0\xbc\xd0\xbe\xd0\xbc\xd0\xb5\xd0\xbd\xd1\x82, \xd1\x8f\xd0\xb2\xd0\xbb\xd1\x8f\xd0\xb5\xd1\x82\xd1\x81\xd1\x8f \xd0\xb4\xd1\x80\xd1\x83\xd0\xb3\xd0\xbe\xd0\xbc \xd0\xbd\xd0\xb5 \xd0\xbc\xd0\xb5\xd0\xbd\xd0\xb5\xd0\xb5, \xd1\x87\xd0\xb5\xd0\xbc \xd0\xb4\xd0\xbb\xd1\x8f k% \xd0\xb4\xd1\x80\xd1\x83\xd0\xb7\xd0\xb5\xd0\xb9 x. \xd0\xa2\xd0\xbe\xd0\xb3\xd0\xb4\xd0\xb0 \xd0\xbe\xd0\xbd \xd1\x8f\xd0\xb2\xd0\xbb\xd1\x8f\xd0\xb5\xd1\x82\xd1\x81\xd1\x8f \xd0\xbf\xd1\x80\xd0\xb5\xd0\xb4\xd0\xbf\xd0\xbe\xd0\xbb\xd0\xb0\xd0\xb3\xd0\xb0\xd0\xb5\xd0\xbc\xd1\x8b\xd0\xbc \xd0\xb4\xd1\x80\xd1\x83\xd0\xb3\xd0\xbe\xd0\xbc \xd0\xb4\xd0\xbb\xd1\x8f x.\xd0\xa3 \xd0\xba\xd0\xb0\xd0\xb6\xd0\xb4\xd0\xbe\xd0\xb3\xd0\xbe \xd1\x87\xd0\xb5\xd0\xbb\xd0\xbe\xd0\xb2\xd0\xb5\xd0\xba\xd0\xb0 \xd0\xb2 \xd1\x81\xd0\xbe\xd1\x86\xd0\xb8\xd0\xb0\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe\xd0\xb9 \xd1\x81\xd0\xb5\xd1\x82\xd0\xb8 \xd0\xb5\xd1\x81\xd1\x82\xd1\x8c \xd1\x81\xd0\xb2\xd0\xbe\xd0\xb9 \xd1\x83\xd0\xbd\xd0\xb8\xd0\xba\xd0\xb0\xd0\xbb\xd1\x8c\xd0\xbd\xd1\x8b\xd0\xb9 \xd0\xb8\xd0\xb4\xd0\xb5\xd0\xbd\xd1\x82\xd0\xb8\xd1\x84\xd0\xb8\xd0\xba\xd0\xb0\xd1\x82\xd0\xbe\xd1\x80 \xe2\x80\x94 \xd1\x8d\xd1\x82\xd0\xbe \xd1\x86\xd0\xb5\xd0\xbb\xd0\xbe\xd0\xb5 \xd1\x87\xd0\xb8\xd1\x81\xd0\xbb\xd0\xbe \xd0\xbe\xd1\x82 1 \xd0\xb4\xd0\xbe 109. \xd0\x92\xd0\xb0\xd0\xbc \xd0\xb4\xd0\xb0\xd0\xbd \xd1\x81\xd0\xbf\xd0\xb8\xd1\x81\xd0\xbe\xd0\xba \xd0\xbf\xd0\xb0\xd1\x80 \xd0\xbf\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xb7\xd0\xbe\xd0\xb2\xd0\xb0\xd1\x82\xd0\xb5\xd0\xbb\xd0\xb5\xd0\xb9, \xd1\x8f\xd0\xb2\xd0\xbb\xd1\x8f\xd1\x8e\xd1\x89\xd0\xb8\xd1\x85\xd1\x81\xd1\x8f \xd0\xb4\xd1\x80\xd1\x83\xd0\xb7\xd1\x8c\xd1\x8f\xd0\xbc\xd0\xb8. \xd0\x9e\xd0\xbf\xd1\x80\xd0\xb5\xd0\xb4\xd0\xb5\xd0\xbb\xd0\xb8\xd1\x82\xd0\xb5 \xd0\xb4\xd0\xbb\xd1\x8f \xd0\xba\xd0\xb0\xd0\xb6\xd0\xb4\xd0\xbe\xd0\xb3\xd0\xbe \xd1\x83\xd0\xbf\xd0\xbe\xd0\xbc\xd1\x8f\xd0\xbd\xd1\x83\xd1\x82\xd0\xbe\xd0\xb3\xd0\xbe \xd0\xbf\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xb7\xd0\xbe\xd0\xb2\xd0\xb0\xd1\x82\xd0\xb5\xd0\xbb\xd1\x8f \xd0\xbc\xd0\xbd\xd0\xbe\xd0\xb6\xd0\xb5\xd1\x81\xd1\x82\xd0\xb2\xd0\xbe \xd0\xb5\xd0\xb3\xd0\xbe \xd0\xbf\xd1\x80\xd0\xb5\xd0\xb4\xd0\xbf\xd0\xbe\xd0\xbb\xd0\xb0\xd0\xb3\xd0\xb0\xd0\xb5\xd0\xbc\xd1\x8b\xd1\x85 \xd0\xb4\xd1\x80\xd1\x83\xd0\xb7\xd0\xb5\xd0\xb9." implementation 1600
583A "Asphalting Roads" "City X consists of n vertical and n horizontal infinite roads, forming n\xe2\x80\x89\xc3\x97\xe2\x80\x89n intersections. Roads (both vertical and horizontal) are numbered from 1 to n, and the intersections are indicated by the numbers of the roads that form them.Sand roads have long been recognized out of date, so the decision was made to asphalt them. To do this, a team of workers was hired and a schedule of work was made, according to which the intersections should be asphalted.Road repairs are planned for n2 days. On the i-th day of the team arrives at the i-th intersection in the list and if none of the two roads that form the intersection were already asphalted they asphalt both roads. Otherwise, the team leaves the intersection, without doing anything with the roads.According to the schedule of road works tell in which days at least one road will be asphalted." implementation 1000
992E "Nastya and King-Shamans" "Nastya likes reading and even spends whole days in a library sometimes. Today she found a chronicle of Byteland in the library, and it stated that there lived shamans long time ago. It is known that at every moment there was exactly one shaman in Byteland, and there were n shamans in total enumerated with integers from 1 to n in the order they lived. Also, each shaman had a magic power which can now be expressed as an integer.The chronicle includes a list of powers of the n shamans. Also, some shamans can be king-shamans, if they gathered all the power of their predecessors, i.e. their power is exactly the sum of powers of all previous shamans. Nastya is interested in whether there was at least one king-shaman in Byteland.Unfortunately many of the powers are unreadable in the list, so Nastya is doing the following:  Initially she supposes some power for each shaman.  After that she changes the power of some shaman q times (the shamans can differ) and after that wants to check if there is at least one king-shaman in the list. If yes, she wants to know the index of any king-shaman. Unfortunately the list is too large and Nastya wants you to help her." "binary search,data structures" 2500
1115G1 "AND oracle" "Implement a quantum oracle on N qubits which implements the following function: f(\xe2\x86\x92x)=x0\xe2\x88\xa7x1\xe2\x88\xa7\xe2\x8b\xaf\xe2\x88\xa7xN\xe2\x88\x921You have to implement an operation which takes the following inputs: an array of N (1\xe2\x89\xa4N\xe2\x89\xa48) qubits x in an arbitrary state (input register), a qubit y in an arbitrary state (output qubit),and performs a transformation |x\xe2\x9f\xa9|y\xe2\x9f\xa9\xe2\x86\x92|x\xe2\x9f\xa9|y\xe2\x8a\x95f(x)\xe2\x9f\xa9. The operation doesn\'t have an output; its ""output"" is the state in which it leaves the qubits.Your code should have the following signature:namespace Solution {    open Microsoft.Quantum.Primitive;    open Microsoft.Quantum.Canon;    operation Solve (x : Qubit[], y : Qubit) : Unit {        body (...) {            // your code here        }        adjoint auto;    }}" "*special problem" 1100
1923F Shrink-Reverse "You are given a binary string s of length n (a string consisting of n characters, and each character is either 0 or 1).Let\'s look at s as at a binary representation of some integer, and name that integer as the value of string s. For example, the value of 000 is 0, the value of 01101 is 13, ""100000"" is 32 and so on.You can perform at most k operations on s. Each operation should have one of the two following types:   SWAP: choose two indices i<j in s and swap si with sj;  SHRINK-REVERSE: delete all leading zeroes from s and reverse s.  For example, after you perform SHRINK-REVERSE on 000101100, you\'ll get 001101.What is the minimum value of s you can achieve by performing at most k operations on s?" "binary search,brute force,greedy,hashing,implementation,string suffix structures,strings" 2800
162D "Remove digits" "You are given a string. Remove all digits from it. When a character is removed from a string, all characters to the right of it are shifted one position to the left." "*special problem" 1900
802M "April Fools\' Problem (easy)" "The marmots have prepared a very easy problem for this year\'s HC2 \xe2\x80\x93 this one. It involves numbers n, k and a sequence of n positive integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. They also came up with a beautiful and riveting story for the problem statement. It explains what the input means, what the program should output, and it also reads like a good criminal.However I, Heidi, will have none of that. As my joke for today, I am removing the story from the statement and replacing it with these two unhelpful paragraphs. Now solve the problem, fools!" greedy,sortings 1200
1613E "Crazy Robot" "There is a grid, consisting of n rows and m columns. Each cell of the grid is either free or blocked. One of the free cells contains a lab. All the cells beyond the borders of the grid are also blocked.A crazy robot has escaped from this lab. It is currently in some free cell of the grid. You can send one of the following commands to the robot: ""move right"", ""move down"", ""move left"" or ""move up"". Each command means moving to a neighbouring cell in the corresponding direction.However, as the robot is crazy, it will do anything except following the command. Upon receiving a command, it will choose a direction such that it differs from the one in command and the cell in that direction is not blocked. If there is such a direction, then it will move to a neighbouring cell in that direction. Otherwise, it will do nothing.We want to get the robot to the lab to get it fixed. For each free cell, determine if the robot can be forced to reach the lab starting in this cell. That is, after each step of the robot a command can be sent to a robot such that no matter what different directions the robot chooses, it will end up in a lab." "dfs and similar,graphs" 2000
1482B "Restore Modulo" "For the first place at the competition, Alex won many arrays of integers and was assured that these arrays are very expensive. After the award ceremony Alex decided to sell them. There is a rule in arrays pawnshop: you can sell array only if it can be compressed to a generator.This generator takes four non-negative numbers n, m, c, s. n and m must be positive, s non-negative and for c it must be true that 0\xe2\x89\xa4c<m. The array a of length n is created according to the following rules:   a1=smodm, here xmody denotes remainder of the division of x by y;  ai=(ai\xe2\x88\x921+c)modm for all i such that 1<i\xe2\x89\xa4n. For example, if n=5, m=7, c=4, and s=10, then a=[3,0,4,1,5].Price of such an array is the value of m in this generator.Alex has a question: how much money he can get for each of the arrays. Please, help him to understand for every array whether there exist four numbers n, m, c, s that generate this array. If yes, then maximize m." implementation,math 1500
1740G "Dangerous Laser Power" "Pak Chanek has an n\xc3\x97m grid of portals. The portal on the i-th row and j-th column is denoted as portal (i,j). The portals (1,1) and (n,m) are on the north-west and south-east corner of the grid respectively.The portal (i,j) has two settings:  Type ti,j, which is either 0 or 1.  Strength si,j, which is an integer between 1 and 109 inclusive.  Each portal has 4 faces labelled with integers 0,1,2,3, which correspond to the north, east, south, and west direction respectively.  When a laser enters face k of portal (i,j) with speed xin, it leaves the portal going out of face (k+2+ti,j)mod4 with speed xout=max(xin,si,j). The portal also has to consume xout\xe2\x88\x92xin units of energy. Pak Chanek is very bored today. He will shoot 4nm lasers with an initial speed of 1, one into each face of each portal. Each laser will travel throughout this grid of portals until it moves outside the grid or it has passed through 10100 portals.At the end, Pak Chanek thinks that a portal is good if and only if the total energy consumed by that portal modulo 2 is equal to its type. Given the strength settings of all portals, find a way to assign the type settings of each portal such that the number of good portals is maximised." "constructive algorithms,dsu,sortings" 3100
900A "Find Extra One" "You have n distinct points on a plane, none of them lie on OY axis. Check that there is a point after removal of which the remaining points are located on one side of the OY axis." geometry,implementation 800
712C "Memory and De-Evolution" "Memory is now interested in the de-evolution of objects, specifically triangles. He starts with an equilateral triangle of side length x, and he wishes to perform operations to obtain an equilateral triangle of side length y.In a single second, he can modify the length of a single side of the current triangle such that it remains a non-degenerate triangle (triangle of positive area). At any moment of time, the length of each side should be integer.What is the minimum number of seconds required for Memory to obtain the equilateral triangle of side length y?" greedy,math 1600
416E "President\'s Path" "Good old Berland has n cities and m roads. Each road connects a pair of distinct cities and is bidirectional. Between any pair of cities, there is at most one road. For each road, we know its length.We also know that the President will soon ride along the Berland roads from city s to city t. Naturally, he will choose one of the shortest paths from s to t, but nobody can say for sure which path he will choose.The Minister for Transport is really afraid that the President might get upset by the state of the roads in the country. That is the reason he is planning to repair the roads in the possible President\'s path.Making the budget for such an event is not an easy task. For all possible distinct pairs s,\xe2\x80\x89t (s\xe2\x80\x89<\xe2\x80\x89t) find the number of roads that lie on at least one shortest path from s to t." "dp,graphs,shortest paths" 2500
1833C "Vlad Building Beautiful Array" "Vlad was given an array a of n positive integers. Now he wants to build a beautiful array b of length n from it.Vlad considers an array beautiful if all the numbers in it are positive and have the same parity. That is, all numbers in the beautiful array are greater than zero and are either all even or all odd.To build the array b, Vlad can assign each bi either the value ai or ai\xe2\x88\x92aj, where any j from 1 to n can be chosen.To avoid trying to do the impossible, Vlad asks you to determine whether it is possible to build a beautiful array b of length n using his array a." greedy,math 800
285A "Slightly Decreasing Permutations" "Permutation p is an ordered set of integers p1,\xe2\x80\x89\xe2\x80\x89p2,\xe2\x80\x89\xe2\x80\x89...,\xe2\x80\x89\xe2\x80\x89pn, consisting of n distinct positive integers, each of them doesn\'t exceed n. We\'ll denote the i-th element of permutation p as pi. We\'ll call number n the size or the length of permutation p1,\xe2\x80\x89\xe2\x80\x89p2,\xe2\x80\x89\xe2\x80\x89...,\xe2\x80\x89\xe2\x80\x89pn.The decreasing coefficient of permutation p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pn is the number of such i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89n), that pi\xe2\x80\x89>\xe2\x80\x89pi\xe2\x80\x89+\xe2\x80\x891.You have numbers n and k. Your task is to print the permutation of length n with decreasing coefficient k." greedy,implementation 1100
639D "Bear and Contribution" "Codeforces is a wonderful platform and one its feature shows how much someone contributes to the community. Every registered user has contribution \xe2\x80\x94 an integer number, not necessarily positive. There are n registered users and the i-th of them has contribution ti.Limak is a little polar bear and he\'s new into competitive programming. He doesn\'t even have an account in Codeforces but he is able to upvote existing blogs and comments. We assume that every registered user has infinitely many blogs and comments.  Limak can spend b minutes to read one blog and upvote it. Author\'s contribution will be increased by 5.  Limak can spend c minutes to read one comment and upvote it. Author\'s contribution will be increased by 1. Note that it\'s possible that Limak reads blogs faster than comments.Limak likes ties. He thinks it would be awesome to see a tie between at least k registered users. To make it happen he is going to spend some time on reading and upvoting. After that, there should exist an integer value x that at least k registered users have contribution exactly x.How much time does Limak need to achieve his goal?" "data structures,greedy,sortings,two pointers" 2400
482E ELCA "You have a root tree containing n vertexes. Let\'s number the tree vertexes with integers from 1 to n. The tree root is in the vertex 1.Each vertex (except fot the tree root) v has a direct ancestor pv. Also each vertex v has its integer value sv. Your task is to perform following queries:  P v u (u\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89v). If u isn\'t in subtree of v, you must perform the assignment pv\xe2\x80\x89=\xe2\x80\x89u. Otherwise you must perform assignment pu\xe2\x80\x89=\xe2\x80\x89v. Note that after this query the graph continues to be a tree consisting of n vertexes. V v t. Perform assignment sv\xe2\x80\x89=\xe2\x80\x89t. Your task is following. Before starting performing queries and after each query you have to calculate expected value written on the lowest common ancestor of two equiprobably selected vertices i and j. Here lowest common ancestor of i and j is the deepest vertex that lies on the both of the path from the root to vertex i and the path from the root to vertex j. Please note that the vertices i and j can be the same (in this case their lowest common ancestor coincides with them)." "data structures,trees" 3200
1036F "Relatively Prime Powers" "Consider some positive integer x. Its prime factorization will be of form x=2k1\xe2\x8b\x853k2\xe2\x8b\x855k3\xe2\x8b\x85\xe2\x80\xa6Let\'s call x elegant if the greatest common divisor of the sequence k1,k2,\xe2\x80\xa6 is equal to 1. For example, numbers 5=51, 12=22\xe2\x8b\x853, 72=23\xe2\x8b\x8532 are elegant and numbers 8=23 (GCD=3), 2500=22\xe2\x8b\x8554 (GCD=2) are not.Count the number of elegant integers from 2 to n.Each testcase contains several values of n, for each of them you are required to solve the problem separately." "combinatorics,math,number theory" 2400
883J Renovation "The mayor of the Berland city S sees the beauty differently than other city-dwellers. In particular, he does not understand at all, how antique houses can be nice-looking. So the mayor wants to demolish all ancient buildings in the city.The city S is going to host the football championship very soon. In order to make the city beautiful, every month the Berland government provides mayor a money tranche. The money has to be spent on ancient buildings renovation.There are n months before the championship and the i-th month tranche equals to ai burles. The city S has m antique buildings and the renovation cost of the j-th building is bj burles.The mayor has his own plans for spending the money. As he doesn\'t like antique buildings he wants to demolish as much of them as possible. For the j-th building he calculated its demolishing cost pj.The mayor decided to act according to the following plan.Each month he chooses several (possibly zero) of m buildings to demolish in such a way that renovation cost of each of them separately is not greater than the money tranche ai of this month (bj\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ai) \xe2\x80\x94 it will allow to deceive city-dwellers that exactly this building will be renovated.Then the mayor has to demolish all selected buildings during the current month as otherwise the dwellers will realize the deception and the plan will fail. Definitely the total demolishing cost can not exceed amount of money the mayor currently has. The mayor is not obliged to spend all the money on demolishing. If some money is left, the mayor puts it to the bank account and can use it in any subsequent month. Moreover, at any month he may choose not to demolish any buildings at all (in this case all the tranche will remain untouched and will be saved in the bank).Your task is to calculate the maximal number of buildings the mayor can demolish." "constructive algorithms,greedy,sortings" 2400
1870D "Prefix Purchase" "You have an array a of size n, initially filled with zeros (a1=a2=\xe2\x80\xa6=an=0). You also have an array of integers c of size n.Initially, you have k coins. By paying ci coins, you can add 1 to all elements of the array a from the first to the i-th element (aj+=1 for all 1\xe2\x89\xa4j\xe2\x89\xa4i). You can buy any ci any number of times. A purchase is only possible if k\xe2\x89\xa5ci, meaning that at any moment k\xe2\x89\xa50 must hold true.Find the lexicographically largest array a that can be obtained.An array a is lexicographically smaller than an array b of the same length if and only if in the first position where a and b differ, the element in array a is smaller than the corresponding element in b." greedy,implementation,sortings 1800
1971D "Binary Cut" "You are given a binary string\xe2\x80\xa0. Please find the minimum number of pieces you need to cut it into, so that the resulting pieces can be rearranged into a sorted binary string.  Note that:   each character must lie in exactly one of the pieces;  the pieces must be contiguous substrings of the original string;  you must use all the pieces in the rearrangement. \xe2\x80\xa0 A binary string is a string consisting of characters 0 and 1. A sorted binary string is a binary string such that all characters 0 come before all characters 1." dp,greedy,implementation,sortings,strings 1100
689D "Friends and Subsequences" "Mike and !Mike are old childhood rivals, they are opposite in everything they do, except programming. Today they have a problem they cannot solve on their own, but together (with you) \xe2\x80\x94 who knows? Every one of them has an integer sequences a and b of length n. Being given a query of the form of pair of integers (l,\xe2\x80\x89r), Mike can instantly tell the value of  while !Mike can instantly tell the value of .Now suppose a robot (you!) asks them all possible different queries of pairs of integers (l,\xe2\x80\x89r) (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) (so he will make exactly n(n\xe2\x80\x89+\xe2\x80\x891)\xe2\x80\x89/\xe2\x80\x892 queries) and counts how many times their answers coincide, thus for how many pairs  is satisfied.How many occasions will the robot count?" "binary search,data structures" 2100
1951F "Inversion Composition" "My Chemical Romance - Disenchanted\xe0\xb6\x9eYou are given a permutation p of size n, as well as a non-negative integer k. You need to construct a permutation q of size n such that inv(q)+inv(q\xe2\x8b\x85p)=k\xe2\x80\xa0\xe2\x80\xa1, or determine if it is impossible to do so.\xe2\x80\xa0 For two permutations p and q of the same size n, the permutation w=q\xe2\x8b\x85p is such that wi=qpi for all 1\xe2\x89\xa4i\xe2\x89\xa4n.\xe2\x80\xa1 For a permutation p of size n, the function inv(p) returns the number of inversions of p, i.e. the number of pairs of indices 1\xe2\x89\xa4i<j\xe2\x89\xa4n such that pi>pj." "constructive algorithms,data structures,greedy" 2500
1685D1 "Permutation Weight (Easy Version)" "This is an easy version of the problem. The difference between the easy and hard versions is that in this version, you can output any permutation with the smallest weight.You are given a permutation p1,p2,\xe2\x80\xa6,pn of integers from 1 to n.Let\'s define the weight of the permutation q1,q2,\xe2\x80\xa6,qn of integers from 1 to n as |q1\xe2\x88\x92pq2|+|q2\xe2\x88\x92pq3|+\xe2\x80\xa6+|qn\xe2\x88\x921\xe2\x88\x92pqn|+|qn\xe2\x88\x92pq1|You want your permutation to be as lightweight as possible. Find any permutation q with the smallest possible weight." "constructive algorithms,dfs and similar,dsu" 2800
568A "Primes or Palindromes?" "Rikhail Mubinchik believes that the current definition of prime numbers is obsolete as they are too complex and unpredictable. A palindromic number is another matter. It is aesthetically pleasing, and it has a number of remarkable properties. Help Rikhail to convince the scientific community in this!Let us remind you that a number is called prime if it is integer larger than one, and is not divisible by any positive integer other than itself and one.Rikhail calls a number a palindromic if it is integer, positive, and its decimal representation without leading zeros is a palindrome, i.e. reads the same from left to right and right to left.One problem with prime numbers is that there are too many of them. Let\'s introduce the following notation: \xcf\x80(n) \xe2\x80\x94 the number of primes no larger than n, rub(n) \xe2\x80\x94 the number of palindromic numbers no larger than n. Rikhail wants to prove that there are a lot more primes than palindromic ones.He asked you to solve the following problem: for a given value of the coefficient A find the maximum n, such that \xcf\x80(n)\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89A\xc2\xb7rub(n)." "brute force,implementation,math,number theory" 1600
1985G D-Function "Let D(n) represent the sum of digits of n. For how many integers n where 10l\xe2\x89\xa4n<10r satisfy D(k\xe2\x8b\x85n)=k\xe2\x8b\x85D(n)? Output the answer modulo 109+7." "combinatorics,math,number theory" 1600
1594F "Ideal Farm" "Theofanis decided to visit his uncle\'s farm. There are s animals and n animal pens on the farm. For utility purpose, animal pens are constructed in one row.Uncle told Theofanis that a farm is lucky if you can distribute all animals in all pens in such a way that there are no empty pens and there is at least one continuous segment of pens that has exactly k animals in total.Moreover, a farm is ideal if it\'s lucky for any distribution without empty pens.Neither Theofanis nor his uncle knows if their farm is ideal or not. Can you help them to figure it out?" "constructive algorithms,math" 2400
1384B2 "Koa and the Beach (Hard Version)" "The only difference between easy and hard versions is on constraints. In this version constraints are higher. You can make hacks only if all versions of the problem are solved.Koa the Koala is at the beach!The beach consists (from left to right) of a shore, n+1 meters of sea and an island at n+1 meters from the shore.She measured the depth of the sea at 1,2,\xe2\x80\xa6,n meters from the shore and saved them in array d. di denotes the depth of the sea at i meters from the shore for 1\xe2\x89\xa4i\xe2\x89\xa4n.Like any beach this one has tide, the intensity of the tide is measured by parameter k and affects all depths from the beginning at time t=0 in the following way:  For a total of k seconds, each second, tide increases all depths by 1.  Then, for a total of k seconds, each second, tide decreases all depths by 1.  This process repeats again and again (ie. depths increase for k seconds then decrease for k seconds and so on ...).Formally, let\'s define 0-indexed array p=[0,1,2,\xe2\x80\xa6,k\xe2\x88\x922,k\xe2\x88\x921,k,k\xe2\x88\x921,k\xe2\x88\x922,\xe2\x80\xa6,2,1] of length 2k. At time t (0\xe2\x89\xa4t) depth at i meters from the shore equals di+p[tmod2k] (tmod2k denotes the remainder of the division of t by 2k). Note that the changes occur instantaneously after each second, see the notes for better understanding. At time t=0 Koa is standing at the shore and wants to get to the island. Suppose that at some time t (0\xe2\x89\xa4t) she is at x (0\xe2\x89\xa4x\xe2\x89\xa4n) meters from the shore:  In one second Koa can swim 1 meter further from the shore (x changes to x+1) or not swim at all (x stays the same), in both cases t changes to t+1.  As Koa is a bad swimmer, the depth of the sea at the point where she is can\'t exceed l at integer points of time (or she will drown). More formally, if Koa is at x (1\xe2\x89\xa4x\xe2\x89\xa4n) meters from the shore at the moment t (for some integer t\xe2\x89\xa50), the depth of the sea at this point  \xe2\x80\x94 dx+p[tmod2k]  \xe2\x80\x94 can\'t exceed l. In other words, dx+p[tmod2k]\xe2\x89\xa4l must hold always.  Once Koa reaches the island at n+1 meters from the shore, she stops and can rest.Note that while Koa swims tide doesn\'t have effect on her (ie. she can\'t drown while swimming). Note that Koa can choose to stay on the shore for as long as she needs and neither the shore or the island are affected by the tide (they are solid ground and she won\'t drown there). Koa wants to know whether she can go from the shore to the island. Help her!" "constructive algorithms,dp,greedy,implementation" 2200
78D "Archer\'s Shot" "A breakthrough among computer games, ""Civilization XIII"", is striking in its scale and elaborate details. Let\'s take a closer look at one of them.The playing area in the game is split into congruent cells that are regular hexagons. The side of each cell is equal to 1. Each unit occupies exactly one cell of the playing field. The field can be considered infinite. Let\'s take a look at the battle unit called an ""Archer"". Each archer has a parameter ""shot range"". It\'s a positive integer that determines the radius of the circle in which the archer can hit a target. The center of the circle coincides with the center of the cell in which the archer stays. A cell is considered to be under the archer\xe2\x80\x99s fire if and only if all points of this cell, including border points are located inside the circle or on its border.The picture below shows the borders for shot ranges equal to 3, 4 and 5. The archer is depicted as A.   Find the number of cells that are under fire for some archer." "binary search,geometry,math,two pointers" 2300
1242E "Planar Perimeter" "Ujan has finally cleaned up his house and now wants to decorate the interior. He decided to place a beautiful carpet that would really tie the guest room together.He is interested in carpets that are made up of polygonal patches such that each side of a patch is either a side of another (different) patch, or is an exterior side of the whole carpet. In other words, the carpet can be represented as a planar graph, where each patch corresponds to a face of the graph, each face is a simple polygon. The perimeter of the carpet is the number of the exterior sides. Ujan considers a carpet beautiful if it consists of f patches, where the i-th patch has exactly ai sides, and the perimeter is the smallest possible. Find an example of such a carpet, so that Ujan can order it!" "constructive algorithms,graphs" 3200
1629B "GCD Arrays" "Consider the array a composed of all the integers in the range [l,r]. For example, if l=3 and r=7, then a=[3,4,5,6,7].Given l, r, and k, is it possible for gcd(a) to be greater than 1 after doing the following operation at most k times?   Choose 2 numbers from a.  Permanently remove one occurrence of each of them from the array.  Insert their product back into a. gcd(b) denotes the greatest common divisor (GCD) of the integers in b." "greedy,math,number theory" 800
705A Hulk "Dr. Bruce Banner hates his enemies (like others don\'t). As we all know, he can barely talk when he turns into the incredible Hulk. That\'s why he asked you to help him to express his feelings.Hulk likes the Inception so much, and like that his feelings are complicated. They have n layers. The first layer is hate, second one is love, third one is hate and so on...For example if n\xe2\x80\x89=\xe2\x80\x891, then his feeling is ""I hate it"" or if n\xe2\x80\x89=\xe2\x80\x892 it\'s ""I hate that I love it"", and if n\xe2\x80\x89=\xe2\x80\x893 it\'s ""I hate that I love that I hate it"" and so on.Please help Dr. Banner." implementation 800
894E "Ralph and Mushrooms" "Ralph is going to collect mushrooms in the Mushroom Forest. There are m directed paths connecting n trees in the Mushroom Forest. On each path grow some mushrooms. When Ralph passes a path, he collects all the mushrooms on the path. The Mushroom Forest has a magical fertile ground where mushrooms grow at a fantastic speed. New mushrooms regrow as soon as Ralph finishes mushroom collection on a path. More specifically, after Ralph passes a path the i-th time, there regrow i mushrooms less than there was before this pass. That is, if there is initially x mushrooms on a path, then Ralph will collect x mushrooms for the first time, x\xe2\x80\x89-\xe2\x80\x891 mushrooms the second time, x\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89-\xe2\x80\x892 mushrooms the third time, and so on. However, the number of mushrooms can never be less than 0.For example, let there be 9 mushrooms on a path initially. The number of mushrooms that can be collected from the path is 9, 8, 6 and 3 when Ralph passes by from first to fourth time. From the fifth time and later Ralph can\'t collect any mushrooms from the path (but still can pass it).Ralph decided to start from the tree s. How many mushrooms can he collect using only described paths?" dp,graphs 2100
1433B "Yet Another Bookshelf" "There is a bookshelf which can fit n books. The i-th position of bookshelf is ai=1 if there is a book on this position and ai=0 otherwise. It is guaranteed that there is at least one book on the bookshelf.In one move, you can choose some contiguous segment [l;r] consisting of books (i.e. for each i from l to r the condition ai=1 holds) and:  Shift it to the right by 1: move the book at index i to i+1 for all l\xe2\x89\xa4i\xe2\x89\xa4r. This move can be done only if r+1\xe2\x89\xa4n and there is no book at the position r+1.  Shift it to the left by 1: move the book at index i to i\xe2\x88\x921 for all l\xe2\x89\xa4i\xe2\x89\xa4r. This move can be done only if l\xe2\x88\x921\xe2\x89\xa51 and there is no book at the position l\xe2\x88\x921. Your task is to find the minimum number of moves required to collect all the books on the shelf as a contiguous (consecutive) segment (i.e. the segment without any gaps).For example, for a=[0,0,1,0,1] there is a gap between books (a4=0 when a3=1 and a5=1), for a=[1,1,0] there are no gaps between books and for a=[0,0,0] there are also no gaps between books.You have to answer t independent test cases." greedy,implementation 800
1477A "Nezzar and Board" "n distinct integers x1,x2,\xe2\x80\xa6,xn are written on the board. Nezzar can perform the following operation multiple times.  Select two integers x,y (not necessarily distinct) on the board, and write down 2x\xe2\x88\x92y. Note that you don\'t remove selected numbers. Now, Nezzar wonders if it is possible to have his favorite number k on the board after applying above operation multiple times." "constructive algorithms,math,number theory" 1800
699A "Launch of Collider" "There will be a launch of a new, powerful and unusual collider very soon, which located along a straight line. n particles will be launched inside it. All of them are located in a straight line and there can not be two or more particles located in the same point. The coordinates of the particles coincide with the distance in meters from the center of the collider, xi is the coordinate of the i-th particle and its position in the collider at the same time. All coordinates of particle positions are even integers.You know the direction of each particle movement \xe2\x80\x94 it will move to the right or to the left after the collider\'s launch start. All particles begin to move simultaneously at the time of the collider\'s launch start. Each particle will move straight to the left or straight to the right with the constant speed of 1 meter per microsecond. The collider is big enough so particles can not leave it in the foreseeable time.Write the program which finds the moment of the first collision of any two particles of the collider. In other words, find the number of microseconds before the first moment when any two particles are at the same point." implementation 1000
269C "Flawed Flow" "Emuskald considers himself a master of flow algorithms. Now he has completed his most ingenious program yet \xe2\x80\x94 it calculates the maximum flow in an undirected graph. The graph consists of n vertices and m edges. Vertices are numbered from 1 to n. Vertices 1 and n being the source and the sink respectively.However, his max-flow algorithm seems to have a little flaw \xe2\x80\x94 it only finds the flow volume for each edge, but not its direction. Help him find for each edge the direction of the flow through this edges. Note, that the resulting flow should be correct maximum flow.More formally. You are given an undirected graph. For each it\'s undirected edge (ai, bi) you are given the flow volume ci. You should direct all edges in such way that the following conditions hold:  for each vertex v (1\xe2\x80\x89<\xe2\x80\x89v\xe2\x80\x89<\xe2\x80\x89n), sum of ci of incoming edges is equal to the sum of ci of outcoming edges;  vertex with number 1 has no incoming edges;  the obtained directed graph does not have cycles." "constructive algorithms,flows,graphs,greedy" 2100
746E "Numbers Exchange" "Eugeny has n cards, each of them has exactly one integer written on it. Eugeny wants to exchange some cards with Nikolay so that the number of even integers on his cards would equal the number of odd integers, and that all these numbers would be distinct. Nikolay has m cards, distinct numbers from 1 to m are written on them, one per card. It means that Nikolay has exactly one card with number 1, exactly one card with number 2 and so on. A single exchange is a process in which Eugeny gives one card to Nikolay and takes another one from those Nikolay has. Your task is to find the minimum number of card exchanges and determine which cards Eugeny should exchange." greedy,implementation,math 1900
1230B "Ania and Minimizing" "Ania has a large integer S. Its decimal representation has length n and doesn\'t contain any leading zeroes. Ania is allowed to change at most k digits of S. She wants to do it in such a way that S still won\'t contain any leading zeroes and it\'ll be minimal possible. What integer will Ania finish with?" greedy,implementation 1000
1209E2 "Rotate Columns (hard version)" "This is a harder version of the problem. The difference is only in constraints.You are given a rectangular n\xc3\x97m matrix a. In one move you can choose any column and cyclically shift elements in this column. You can perform this operation as many times as you want (possibly zero). You can perform this operation to a column multiple times.After you are done with cyclical shifts, you compute for every row the maximal value in it. Suppose that for i-th row it is equal ri. What is the maximal possible value of r1+r2+\xe2\x80\xa6+rn?" bitmasks,dp,greedy,sortings 2500
36D "New Game with a Chess Piece" "Petya and Vasya are inventing a new game that requires a rectangular board and one chess piece. At the beginning of the game the piece stands in the upper-left corner of the board. Two players move the piece in turns. Each turn the chess piece can be moved either one square to the right or one square down or jump k squares diagonally down and to the right. The player who can\xe2\x80\x99t move the piece loses.   The guys haven\xe2\x80\x99t yet thought what to call the game or the best size of the board for it. Your task is to write a program that can determine the outcome of the game depending on the board size." games 2300
442A "Borya and Hanabi" "Have you ever played Hanabi? If not, then you\'ve got to try it out! This problem deals with a simplified version of the game.Overall, the game has 25 types of cards (5 distinct colors and 5 distinct values). Borya is holding n cards. The game is somewhat complicated by the fact that everybody sees Borya\'s cards except for Borya himself. Borya knows which cards he has but he knows nothing about the order they lie in. Note that Borya can have multiple identical cards (and for each of the 25 types of cards he knows exactly how many cards of this type he has).The aim of the other players is to achieve the state when Borya knows the color and number value of each of his cards. For that, other players can give him hints. The hints can be of two types: color hints and value hints. A color hint goes like that: a player names some color and points at all the cards of this color. Similarly goes the value hint. A player names some value and points at all the cards that contain the value.Determine what minimum number of hints the other players should make for Borya to be certain about each card\'s color and value." "bitmasks,brute force,implementation" 1700
268B Buttons "Manao is trying to open a rather challenging lock. The lock has n buttons on it and to open it, you should press the buttons in a certain order to open the lock. When you push some button, it either stays pressed into the lock (that means that you\'ve guessed correctly and pushed the button that goes next in the sequence), or all pressed buttons return to the initial position. When all buttons are pressed into the lock at once, the lock opens.Consider an example with three buttons. Let\'s say that the opening sequence is: {2, 3, 1}. If you first press buttons 1 or 3, the buttons unpress immediately. If you first press button 2, it stays pressed. If you press 1 after 2, all buttons unpress. If you press 3 after 2, buttons 3 and 2 stay pressed. As soon as you\'ve got two pressed buttons, you only need to press button 1 to open the lock.Manao doesn\'t know the opening sequence. But he is really smart and he is going to act in the optimal way. Calculate the number of times he\'s got to push a button in order to open the lock in the worst-case scenario." implementation,math 1000
650C "Table Compression" "Little Petya is now fond of data compression algorithms. He has already studied gz, bz, zip algorithms and many others. Inspired by the new knowledge, Petya is now developing the new compression algorithm which he wants to name dis.Petya decided to compress tables. He is given a table a consisting of n rows and m columns that is filled with positive integers. He wants to build the table a\' consisting of positive integers such that the relative order of the elements in each row and each column remains the same. That is, if in some row i of the initial table ai,\xe2\x80\x89j\xe2\x80\x89<\xe2\x80\x89ai,\xe2\x80\x89k, then in the resulting table a\'i,\xe2\x80\x89j\xe2\x80\x89<\xe2\x80\x89a\'i,\xe2\x80\x89k, and if ai,\xe2\x80\x89j\xe2\x80\x89=\xe2\x80\x89ai,\xe2\x80\x89k then a\'i,\xe2\x80\x89j\xe2\x80\x89=\xe2\x80\x89a\'i,\xe2\x80\x89k. Similarly, if in some column j of the initial table ai,\xe2\x80\x89j\xe2\x80\x89<\xe2\x80\x89ap,\xe2\x80\x89j then in compressed table a\'i,\xe2\x80\x89j\xe2\x80\x89<\xe2\x80\x89a\'p,\xe2\x80\x89j and if ai,\xe2\x80\x89j\xe2\x80\x89=\xe2\x80\x89ap,\xe2\x80\x89j then a\'i,\xe2\x80\x89j\xe2\x80\x89=\xe2\x80\x89a\'p,\xe2\x80\x89j. Because large values require more space to store them, the maximum value in a\' should be as small as possible.Petya is good in theory, however, he needs your help to implement the algorithm." "dfs and similar,dp,dsu,graphs,greedy" 2200
1175E "Minimal Segment Cover" "You are given n intervals in form [l;r] on a number line.You are also given m queries in form [x;y]. What is the minimal number of intervals you have to take so that every point (not necessarily integer) from x to y is covered by at least one of them? If you can\'t choose intervals so that every point from x to y is covered, then print -1 for that query." "data structures,dfs and similar,divide and conquer,dp,greedy,implementation,trees" 2200
1644B "Anti-Fibonacci Permutation" "Let\'s call a permutation p of length n anti-Fibonacci if the condition pi\xe2\x88\x922+pi\xe2\x88\x921\xe2\x89\xa0pi holds for all i (3\xe2\x89\xa4i\xe2\x89\xa4n). Recall that the permutation is the array of length n which contains each integer from 1 to n exactly once.Your task is for a given number n print n distinct anti-Fibonacci permutations of length n." "brute force,constructive algorithms,implementation" 800
807A "Is it rated?" "Is it rated?Here it is. The Ultimate Question of Competitive Programming, Codeforces, and Everything. And you are here to answer it.Another Codeforces round has been conducted. No two participants have the same number of points. For each participant, from the top to the bottom of the standings, their rating before and after the round is known.It\'s known that if at least one participant\'s rating has changed, then the round was rated for sure.It\'s also known that if the round was rated and a participant with lower rating took a better place in the standings than a participant with higher rating, then at least one round participant\'s rating has changed.In this problem, you should not make any other assumptions about the rating system.Determine if the current round is rated, unrated, or it\'s impossible to determine whether it is rated of not." implementation,sortings 900
52A 123-sequence "There is a given sequence of integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an, where every number is from 1 to 3 inclusively. You have to replace the minimum number of numbers in it so that all the numbers in the sequence are equal to each other." implementation 900
1698F "Equal Reversal" "There is an array a of length n. You may perform the following operation on it:  Choose two indices l and r where 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n and al=ar. Then, reverse the subsegment from the l-th to the r-th element, i. e. set [al,al+1,\xe2\x80\xa6,ar\xe2\x88\x921,ar] to [ar,ar\xe2\x88\x921,\xe2\x80\xa6,al+1,al]. You are also given another array b of length n which is a permutation of a. Find a sequence of at most n2 operations that transforms array a into b, or report that no such sequence exists." "constructive algorithms,graphs,implementation,math" 2800
1469B "Red and Blue" "Monocarp had a sequence a consisting of n+m integers a1,a2,\xe2\x80\xa6,an+m. He painted the elements into two colors, red and blue; n elements were painted red, all other m elements were painted blue.After painting the elements, he has written two sequences r1,r2,\xe2\x80\xa6,rn and b1,b2,\xe2\x80\xa6,bm. The sequence r consisted of all red elements of a in the order they appeared in a; similarly, the sequence b consisted of all blue elements of a in the order they appeared in a as well.Unfortunately, the original sequence was lost, and Monocarp only has the sequences r and b. He wants to restore the original sequence. In case there are multiple ways to restore it, he wants to choose a way to restore that maximizes the value of f(a)=max(0,a1,(a1+a2),(a1+a2+a3),\xe2\x80\xa6,(a1+a2+a3+\xe2\x8b\xaf+an+m))Help Monocarp to calculate the maximum possible value of f(a)." dp,greedy 1000
1101D "GCD Counting" "You are given a tree consisting of n vertices. A number is written on each vertex; the number on vertex i is equal to ai.Let\'s denote the function g(x,y) as the greatest common divisor of the numbers written on the vertices belonging to the simple path from vertex x to vertex y (including these two vertices). Also let\'s denote dist(x,y) as the number of vertices on the simple path between vertices x and y, including the endpoints. dist(x,x)=1 for every vertex x.Your task is calculate the maximum value of dist(x,y) among such pairs of vertices that g(x,y)>1." "data structures,dfs and similar,dp,number theory,trees" 2000
1689B "Mystic Permutation" "Monocarp is a little boy who lives in Byteland and he loves programming.Recently, he found a permutation of length n. He has to come up with a mystic permutation. It has to be a new permutation such that it differs from the old one in each position.More formally, if the old permutation is p1,p2,\xe2\x80\xa6,pn and the new one is q1,q2,\xe2\x80\xa6,qn it must hold that p1\xe2\x89\xa0q1,p2\xe2\x89\xa0q2,\xe2\x80\xa6,pn\xe2\x89\xa0qn.Monocarp is afraid of lexicographically large permutations. Can you please help him to find the lexicographically minimal mystic permutation?" "data structures,greedy" 900
1686A "Everything Everywhere All But One" "You are given an array of n integers a1,a2,\xe2\x80\xa6,an. After you watched the amazing film ""Everything Everywhere All At Once"", you came up with the following operation.In one operation, you choose n\xe2\x88\x921 elements of the array and replace each of them with their arithmetic mean (which doesn\'t have to be an integer). For example, from the array [1,2,3,1] we can get the array [2,2,2,1], if we choose the first three elements, or we can get the array [43,43,3,43], if we choose all elements except the third.Is it possible to make all elements of the array equal by performing a finite number of such operations?" greedy 800
1836B Astrophysicists "In many, many years, far, far away, there will be a launch of the first flight to Mars. To celebrate the success, n astrophysicists working on the project will be given bonuses of a total value of k gold coins.You have to distribute the money among the astrophysicists, and to make it easier, you have to assign bonuses in silver coins. Each gold coin is worth g silver coins, so you have to distribute all k\xe2\x8b\x85g silver coins among n people.Unfortunately, the company has some financial troubles right now. Therefore, instead of paying the number of silver coins written on the bonus, they decided to round this amount to the nearest integer number of gold coins.The rounding procedure is as follows. If an astrophysicist has bonus equal to x silver coins, and we denote r=xmodg, then:   If r\xe2\x89\xa5\xe2\x8c\x88g2\xe2\x8c\x89, the astrophysicist receives x+(g\xe2\x88\x92r) silver coins;  Otherwise, an astrophysicists receives x\xe2\x88\x92r silver coins.  Note that due to rounding, the total sum of actually paid money is not, in general, equal to k\xe2\x8b\x85g silver coins. The operation amodb denotes the remainder of the division of a by b. Sum of values before rounding has to be equal to k\xe2\x8b\x85g silver coins, but some workers can be assigned 0 silver coins.You aim to distribute the bonuses so that the company saves as many silver coins due to rounding as possible. Please note that there is always a distribution in which the company spends no more than k\xe2\x8b\x85g silver coins." greedy,math 1100
1276C "Beautiful Rectangle" "You are given n integers. You need to choose a subset and put the chosen numbers in a beautiful rectangle (rectangular matrix). Each chosen number should occupy one of its rectangle cells, each cell must be filled with exactly one chosen number. Some of the n numbers may not be chosen.A rectangle (rectangular matrix) is called beautiful if in each row and in each column all values are different.What is the largest (by the total number of cells) beautiful rectangle you can construct? Print the rectangle itself." "brute force,combinatorics,constructive algorithms,data structures,greedy,math" 2300
417D "Cunning Gena" "A boy named Gena really wants to get to the ""Russian Code Cup"" finals, or at least get a t-shirt. But the offered problems are too complex, so he made an arrangement with his n friends that they will solve the problems for him.The participants are offered m problems on the contest. For each friend, Gena knows what problems he can solve. But Gena\'s friends won\'t agree to help Gena for nothing: the i-th friend asks Gena xi rubles for his help in solving all the problems he can. Also, the friend agreed to write a code for Gena only if Gena\'s computer is connected to at least ki monitors, each monitor costs b rubles.Gena is careful with money, so he wants to spend as little money as possible to solve all the problems. Help Gena, tell him how to spend the smallest possible amount of money. Initially, there\'s no monitors connected to Gena\'s computer." bitmasks,dp,greedy,sortings 1900
1983G "Your Loss" "You are given a tree with n nodes numbered from 1 to n, along with an array of size n. The value of i-th node is ai. There are q queries. In each query, you are given 2 nodes numbered as x and y. Consider the path from the node numbered as x to the node numbered as y. Let the path be represented by x=p0,p1,p2,\xe2\x80\xa6,pr=y, where pi are the intermediate nodes. Compute the sum of api\xe2\x8a\x95i for each i such that 0\xe2\x89\xa4i\xe2\x89\xa4r where \xe2\x8a\x95 is the XOR operator. More formally, compute r\xe2\x88\x91i=0api\xe2\x8a\x95i." "bitmasks,brute force,dp,trees" 3000
456A Laptops "One day Dima and Alex had an argument about the price and quality of laptops. Dima thinks that the more expensive a laptop is, the better it is. Alex disagrees. Alex thinks that there are two laptops, such that the price of the first laptop is less (strictly smaller) than the price of the second laptop but the quality of the first laptop is higher (strictly greater) than the quality of the second laptop.Please, check the guess of Alex. You are given descriptions of n laptops. Determine whether two described above laptops exist." sortings 1100
329C "Graph Reconstruction" "I have an undirected graph consisting of n nodes, numbered 1 through n. Each node has at most two incident edges. For each pair of nodes, there is at most an edge connecting them. No edge connects a node to itself.I would like to create a new graph in such a way that:   The new graph consists of the same number of nodes and edges as the old graph.  The properties in the first paragraph still hold.  For each two nodes u and v, if there is an edge connecting them in the old graph, there is no edge connecting them in the new graph. Help me construct the new graph, or tell me if it is impossible." "constructive algorithms" 2400
1712B "Woeful Permutation" "I wonder, does the falling rain Forever yearn for it\'s disdain?Effluvium of the MindYou are given a positive integer n.Find any permutation p of length n such that the sum lcm(1,p1)+lcm(2,p2)+\xe2\x80\xa6+lcm(n,pn) is as large as possible. Here lcm(x,y) denotes the least common multiple (LCM) of integers x and y.A permutation is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array) and [1,3,4] is also not a permutation (n=3 but there is 4 in the array)." "constructive algorithms,greedy,number theory" 800
1540E "Tasty Dishes" "Note that the memory limit is unusual.There are n chefs numbered 1,2,\xe2\x80\xa6,n that must prepare dishes for a king. Chef i has skill i and initially has a dish of tastiness ai where |ai|\xe2\x89\xa4i. Each chef has a list of other chefs that he is allowed to copy from. To stop chefs from learning bad habits, the king makes sure that chef i can only copy from chefs of larger skill.There are a sequence of days that pass during which the chefs can work on their dish. During each day, there are two stages during which a chef can change the tastiness of their dish.   At the beginning of each day, each chef can choose to work (or not work) on their own dish, thereby multiplying the tastiness of their dish of their skill (ai:=i\xe2\x8b\x85ai) (or doing nothing). After all chefs (who wanted) worked on their own dishes, each start observing the other chefs. In particular, for each chef j on chef i\'s list, chef i can choose to copy (or not copy) j\'s dish, thereby adding the tastiness of the j\'s dish to i\'s dish (ai:=ai+aj) (or doing nothing). It can be assumed that all copying occurs simultaneously. Namely, if chef i chooses to copy from chef j he will copy the tastiness of chef j\'s dish at the end of stage 1.All chefs work to maximize the tastiness of their own dish in order to please the king.Finally, you are given q queries. Each query is one of two types.  1 k l r \xe2\x80\x94 find the sum of tastiness al,al+1,\xe2\x80\xa6,ar after the k-th day. Because this value can be large, find it modulo 109+7.  2 i x \xe2\x80\x94 the king adds x tastiness to the i-th chef\'s dish before the 1-st day begins (ai:=ai+x). Note that, because the king wants to see tastier dishes, he only adds positive tastiness (x>0). Note that queries of type 1 are independent of each all other queries. Specifically, each query of type 1 is a scenario and does not change the initial tastiness ai of any dish for future queries. Note that queries of type 2 are cumulative and only change the initial tastiness ai of a dish. See notes for an example of queries." math,matrices 3500
1005B "Delete from the Left" "You are given two strings s and t. In a single move, you can choose any of two strings and delete the first (that is, the leftmost) character. After a move, the length of the string decreases by 1. You can\'t choose a string if it is empty.For example:  by applying a move to the string ""where"", the result is the string ""here"",  by applying a move to the string ""a"", the result is an empty string """". You are required to make two given strings equal using the fewest number of moves. It is possible that, in the end, both strings will be equal to the empty string, and so, are equal to each other. In this case, the answer is obviously the sum of the lengths of the initial strings.Write a program that finds the minimum number of moves to make two given strings s and t equal." "brute force,implementation,strings" 900
821C "Okabe and Boxes" "Okabe and Super Hacker Daru are stacking and removing boxes. There are n boxes numbered from 1 to n. Initially there are no boxes on the stack.Okabe, being a control freak, gives Daru 2n commands: n of which are to add a box to the top of the stack, and n of which are to remove a box from the top of the stack and throw it in the trash. Okabe wants Daru to throw away the boxes in the order from 1 to n. Of course, this means that it might be impossible for Daru to perform some of Okabe\'s remove commands, because the required box is not on the top of the stack.That\'s why Daru can decide to wait until Okabe looks away and then reorder the boxes in the stack in any way he wants. He can do it at any point of time between Okabe\'s commands, but he can\'t add or remove boxes while he does it.Tell Daru the minimum number of times he needs to reorder the boxes so that he can successfully complete all of Okabe\'s commands. It is guaranteed that every box is added before it is required to be removed." "data structures,greedy,trees" 1500
21D "Traveling Graph" "You are given undirected weighted graph. Find the length of the shortest cycle which starts from the vertex 1 and passes throught all the edges at least once. Graph may contain multiply edges between a pair of vertices and loops (edges from the vertex to itself)." "bitmasks,graph matchings,graphs" 2400
965B Battleship "Arkady is playing Battleship. The rules of this game aren\'t really important.There is a field of n\xc3\x97n cells. There should be exactly one k-decker on the field, i. e. a ship that is k cells long oriented either horizontally or vertically. However, Arkady doesn\'t know where it is located. For each cell Arkady knows if it is definitely empty or can contain a part of the ship.Consider all possible locations of the ship. Find such a cell that belongs to the maximum possible number of different locations of the ship." implementation 1300
676C "Vasya and String" "High school student Vasya got a string of length n as a birthday present. This string consists of letters \'a\' and \'b\' only. Vasya denotes beauty of the string as the maximum length of a substring (consecutive subsequence) consisting of equal letters.Vasya can change no more than k characters of the original string. What is the maximum beauty of the string he can achieve?" "binary search,dp,strings,two pointers" 1500
611C "New Year and Domino" "They say ""years are like dominoes, tumbling one after the other"". But would a year fit into a grid? I don\'t think so.Limak is a little polar bear who loves to play. He has recently got a rectangular grid with h rows and w columns. Each cell is a square, either empty (denoted by \'.\') or forbidden (denoted by \'#\'). Rows are numbered 1 through h from top to bottom. Columns are numbered 1 through w from left to right.Also, Limak has a single domino. He wants to put it somewhere in a grid. A domino will occupy exactly two adjacent cells, located either in one row or in one column. Both adjacent cells must be empty and must be inside a grid.Limak needs more fun and thus he is going to consider some queries. In each query he chooses some rectangle and wonders, how many way are there to put a single domino inside of the chosen rectangle?" dp,implementation 1500
1781D "Many Perfect Squares" "You are given a set a1,a2,\xe2\x80\xa6,an of distinct positive integers.We define the squareness of an integer x as the number of perfect squares among the numbers a1+x,a2+x,\xe2\x80\xa6,an+x.Find the maximum squareness among all integers x between 0 and 1018, inclusive.Perfect squares are integers of the form t2, where t is a non-negative integer. The smallest perfect squares are 0,1,4,9,16,\xe2\x80\xa6." "brute force,math,number theory" 1800
1036E "Covered Points" "You are given n segments on a Cartesian plane. Each segment\'s endpoints have integer coordinates. Segments can intersect with each other. No two segments lie on the same line.Count the number of distinct points with integer coordinates, which are covered by at least one segment." "fft,geometry,number theory" 2400
1711B Party "A club plans to hold a party and will invite some of its n members. The n members are identified by the numbers 1,2,\xe2\x80\xa6,n. If member i is not invited, the party will gain an unhappiness value of ai.There are m pairs of friends among the n members. As per tradition, if both people from a friend pair are invited, they will share a cake at the party. The total number of cakes eaten will be equal to the number of pairs of friends such that both members have been invited.However, the club\'s oven can only cook two cakes at a time. So, the club demands that the total number of cakes eaten is an even number.What is the minimum possible total unhappiness value of the party, respecting the constraint that the total number of cakes eaten is even?" "brute force,graphs" 1300
509D "Restoring Numbers" "Vasya had two arrays consisting of non-negative integers: a of size n and b of size m. Vasya chose a positive integer k and created an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m matrix v using the following formula:Vasya wrote down matrix v on a piece of paper and put it in the table.A year later Vasya was cleaning his table when he found a piece of paper containing an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m matrix w. He remembered making a matrix one day by the rules given above but he was not sure if he had found the paper with the matrix v from those days. Your task is to find out if the matrix w that you\'ve found could have been obtained by following these rules and if it could, then for what numbers k,\xe2\x80\x89a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an,\xe2\x80\x89b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bm it is possible." "constructive algorithms,math" 2200
1630E "Expected Components" "Given a cyclic array a of size n, where ai is the value of a in the i-th position, there may be repeated values. Let us define that a permutation of a is equal to another permutation of a if and only if their values are the same for each position i or we can transform them to each other by performing some cyclic rotation. Let us define for a cyclic array b its number of components as the number of connected components in a graph, where the vertices are the positions of b and we add an edge between each pair of adjacent positions of b with equal values (note that in a cyclic array the first and last position are also adjacents).Find the expected value of components of a permutation of a if we select it equiprobably over the set of all the different permutations of a." "combinatorics,math,number theory,probabilities" 2900
1402B Roads "The government of Treeland wants to build a new road network. There are 2N cities in Treeland. The unfinished plan of the road network already contains N road segments, each of which connects two cities with a straight line. No two road segments have a common point (including their endpoints).  Your task is to determine N\xe2\x88\x921 additional road segments satisfying the following conditions:   Every new road segment must connect two cities with a straight line.  If two segments (new or old) have a common point, then this point must be an endpoint of both segments.  The road network connects all cities: for each pair of cities there is a path consisting of segments that connects the two cities." "*special problem,geometry,sortings" 2900
1630B "Range and Partition" "Given an array a of n integers, find a range of values [x,y] (x\xe2\x89\xa4y), and split a into exactly k (1\xe2\x89\xa4k\xe2\x89\xa4n) subarrays in such a way that:  Each subarray is formed by several continuous elements of a, that is, it is equal to al,al+1,\xe2\x80\xa6,ar for some l and r (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n).  Each element from a belongs to exactly one subarray.  In each subarray the number of elements inside the range [x,y] (inclusive) is strictly greater than the number of elements outside the range. An element with index i is inside the range [x,y] if and only if x\xe2\x89\xa4ai\xe2\x89\xa4y.  Print any solution that minimizes y\xe2\x88\x92x." "binary search,constructive algorithms,data structures,greedy,two pointers" 1800
958D1 "Hyperspace Jump (easy)" "The Rebel fleet is on the run. It consists of m ships currently gathered around a single planet. Just a few seconds ago, the vastly more powerful Empire fleet has appeared in the same solar system, and the Rebels will need to escape into hyperspace. In order to spread the fleet, the captain of each ship has independently come up with the coordinate to which that ship will jump. In the obsolete navigation system used by the Rebels, this coordinate is given as the value of an arithmetic expression of the form .To plan the future of the resistance movement, Princess Heidi needs to know, for each ship, how many ships are going to end up at the same coordinate after the jump. You are her only hope!" "expression parsing,math" 1400
416A "Guess a number!" "A TV show called ""Guess a number!"" is gathering popularity. The whole Berland, the old and the young, are watching the show.The rules are simple. The host thinks of an integer y and the participants guess it by asking questions to the host. There are four types of acceptable questions:  Is it true that y is strictly larger than number x?  Is it true that y is strictly smaller than number x?  Is it true that y is larger than or equal to number x?  Is it true that y is smaller than or equal to number x? On each question the host answers truthfully, ""yes"" or ""no"".Given the sequence of questions and answers, find any integer value of y that meets the criteria of all answers. If there isn\'t such value, print ""Impossible""." "greedy,implementation,two pointers" 1400
1585E "Frequency Queries" "Petya has a rooted tree with an integer written on each vertex. The vertex 1 is the root. You are to answer some questions about the tree.A tree is a connected graph without cycles. A rooted tree has a special vertex called the root. The parent of a node v is the next vertex on the shortest path from v to the root.Each question is defined by three integers v, l, and k. To get the answer to the question, you need to perform the following steps:   First, write down the sequence of all integers written on the shortest path from the vertex v to the root (including those written in the v and the root).  Count the number of times each integer occurs. Remove all integers with less than l occurrences.  Replace the sequence, removing all duplicates and ordering the elements by the number of occurrences in the original list in increasing order. In case of a tie, you can choose the order of these elements arbitrary.  The answer to the question is the k-th number in the remaining sequence. Note that the answer is not always uniquely determined, because there could be several orderings. Also, it is possible that the length of the sequence on this step is less than k, in this case the answer is \xe2\x88\x921. For example, if the sequence of integers on the path from v to the root is [2,2,1,7,1,1,4,4,4,4], l=2 and k=2, then the answer is 1.Please answer all questions about the tree." "data structures,dfs and similar,trees" 2400
772B "Volatile Kite" "You are given a convex polygon P with n distinct vertices p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pn. Vertex pi has coordinates (xi,\xe2\x80\x89yi) in the 2D plane. These vertices are listed in clockwise order.You can choose a real number D and move each vertex of the polygon a distance of at most D from their original positions.Find the maximum value of D such that no matter how you move the vertices, the polygon does not intersect itself and stays convex." geometry 1800
660C "Hard Process" "You are given an array a with n elements. Each element of a is either 0 or 1.Let\'s denote the length of the longest subsegment of consecutive elements in a, consisting of only numbers one, as f(a). You can change no more than k zeroes to ones to maximize f(a)." "binary search,dp,two pointers" 1600
1181C Flag "Innokenty works at a flea market and sells some random stuff rare items. Recently he found an old rectangular blanket. It turned out that the blanket is split in n\xe2\x8b\x85m colored pieces that form a rectangle with n rows and m columns. The colored pieces attracted Innokenty\'s attention so he immediately came up with the following business plan. If he cuts out a subrectangle consisting of three colored stripes, he can sell it as a flag of some country. Innokenty decided that a subrectangle is similar enough to a flag of some country if it consists of three stripes of equal heights placed one above another, where each stripe consists of cells of equal color. Of course, the color of the top stripe must be different from the color of the middle stripe; and the color of the middle stripe must be different from the color of the bottom stripe.Innokenty has not yet decided what part he will cut out, but he is sure that the flag\'s boundaries should go along grid lines. Also, Innokenty won\'t rotate the blanket. Please help Innokenty and count the number of different subrectangles Innokenty can cut out and sell as a flag. Two subrectangles located in different places but forming the same flag are still considered different.   These subrectangles are flags.       These subrectangles are not flags." "brute force,combinatorics,dp,implementation" 1900
1639E "Treasure Hunt" "All problems in this contest share the same statement, the only difference is the test your solution runs on. For further information on scoring please refer to ""Scoring"" section of the statement.This is an interactive problem.Imagine you are a treasure hunter, a very skillful one. One day you came across an ancient map which could help you to become rich. The map shows multiple forestry roads, and at each junction there is a treasure. So, you start your journey hoping to retrieve all the hidden treasures, but you don\'t know yet that there is a wicked wizard standing against you and craving to tangle up these roads and impede your achievements.The treasure map is represented as an undirected graph in which vertices correspond to junctions and edges correspond to roads. Your path begins at a certain fixed vertex with a label known to you. Every time you come to a vertex that you have not been to before, you dig up a treasure chest and put a flag in this vertex. At the initial vertex you\'ll find a treasure chest immediately and, consequently, you\'ll put a flag there immediately as well.When you are standing at the junction you can see for each of the adjacent vertices its degree and if there is a flag there. There are no other things you can see from there. Besides, the power of the wicked wizard is so great that he is able to change the location of the roads and junctions on the map without changing the graph structure. Therefore, the sequence of the roads coming from the junction v might be different each time you come in the junction v. However, keep in mind that the set of adjacent crossroads does not change, and you are well aware of previously dug treasures at each adjacent to v vertex.Your goal is to collect treasures from all vertices of the graph as fast as you can. Good luck in hunting!" graphs,interactive -999
1647D "Madoka and the Best School in Russia" "Madoka is going to enroll in ""TSUNS PTU"". But she stumbled upon a difficult task during the entrance computer science exam:  A number is called good if it is a multiple of d.  A number is called beatiful if it is good and it cannot be represented as a product of two good numbers. Notice that a beautiful number must be good.Given a good number x, determine whether it can be represented in at least two different ways as a product of several (possibly, one) beautiful numbers. Two ways are different if the sets of numbers used are different.Solve this problem for Madoka and help her to enroll in the best school in Russia!" "constructive algorithms,dp,math,number theory" 1900
1105D "Kilani and the Game" "Kilani is playing a game with his friends. This game can be represented as a grid of size n\xc3\x97m, where each cell is either empty or blocked, and every player has one or more castles in some cells (there are no two castles in one cell).The game is played in rounds. In each round players expand turn by turn: firstly, the first player expands, then the second player expands and so on. The expansion happens as follows: for each castle the player owns now, he tries to expand into the empty cells nearby. The player i can expand from a cell with his castle to the empty cell if it\'s possible to reach it in at most si (where si is player\'s expansion speed) moves to the left, up, right or down without going through blocked cells or cells occupied by some other player\'s castle. The player examines the set of cells he can expand to and builds a castle in each of them at once. The turned is passed to the next player after that. The game ends when no player can make a move. You are given the game field and speed of the expansion for each player. Kilani wants to know for each player how many cells he will control (have a castle their) after the game ends." "dfs and similar,graphs,implementation,shortest paths" 1900
1787F "Inverse Transformation" "A permutation scientist is studying a self-transforming permutation a consisting of n elements a1,a2,\xe2\x80\xa6,an.A permutation is a sequence of integers from 1 to n of length n containing each number exactly once. For example, [1], [4,3,5,1,2] are permutations, while [1,1], [4,3,1] are not.The permutation transforms day by day. On each day, each element x becomes ax, that is, ax becomes aax. Specifically:   on the first day, the permutation becomes b, where bx=aax;  on the second day, the permutation becomes c, where cx=bbx;  \xe2\x80\xa6  For example, consider permutation a=[2,3,1]. On the first day, it becomes [3,1,2]. On the second day, it becomes [2,3,1].You\'re given the permutation a\xe2\x80\xb2 on the k-th day.Define \xcf\x83(x)=ax, and define f(x) as the minimal positive integer m such that \xcf\x83m(x)=x, where \xcf\x83m(x) denotes \xcf\x83(\xcf\x83(\xe2\x80\xa6\xcf\x83\xe2\x8f\x9fm times(x)\xe2\x80\xa6)).For example, if a=[2,3,1], then \xcf\x83(1)=2, \xcf\x832(1)=\xcf\x83(\xcf\x83(1))=\xcf\x83(2)=3, \xcf\x833(1)=\xcf\x83(\xcf\x83(\xcf\x83(1)))=\xcf\x83(3)=1, so f(1)=3. And if a=[4,2,1,3], \xcf\x83(2)=2 so f(2)=1; \xcf\x83(3)=1, \xcf\x832(3)=4, \xcf\x833(3)=3 so f(3)=3.Find the initial permutation a such that n\xe2\x88\x91i=11f(i) is minimum possible." "constructive algorithms,implementation,math" 2500
200D "Programming Language" "Recently, Valery have come across an entirely new programming language. Most of all the language attracted him with template functions and procedures. Let us remind you that templates are tools of a language, designed to encode generic algorithms, without reference to some parameters (e.g., data types, buffer sizes, default values).Valery decided to examine template procedures in this language in more detail. The description of a template procedure consists of the procedure name and the list of its parameter types. The generic type T parameters can be used as parameters of template procedures.A procedure call consists of a procedure name and a list of variable parameters. Let\'s call a procedure suitable for this call if the following conditions are fulfilled:   its name equals to the name of the called procedure;  the number of its parameters equals to the number of parameters of the procedure call;  the types of variables in the procedure call match the corresponding types of its parameters. The variable type matches the type of a parameter if the parameter has a generic type T or the type of the variable and the parameter are the same. You are given a description of some set of template procedures. You are also given a list of variables used in the program, as well as direct procedure calls that use the described variables. For each call you need to count the number of procedures that are suitable for this call." "binary search,brute force,expression parsing,implementation" 1800
125E "MST Company" "The MST (Meaningless State Team) company won another tender for an important state reform in Berland.There are n cities in Berland, some pairs of the cities are connected by roads. Each road has its price. One can move along any road in any direction. The MST team should carry out the repair works on some set of roads such that one can get from any city to any other one moving only along the repaired roads. Moreover, this set should contain exactly k capital roads (that is, the roads that start or finish in the capital). The number of the capital is 1.As the budget has already been approved, the MST Company will profit by finding the set with minimum lengths of roads." "binary search,graphs" 2400
1220E Tourism "Alex decided to go on a touristic trip over the country.For simplicity let\'s assume that the country has n cities and m bidirectional roads connecting them. Alex lives in city s and initially located in it. To compare different cities Alex assigned each city a score wi which is as high as interesting city seems to Alex.Alex believes that his trip will be interesting only if he will not use any road twice in a row. That is if Alex came to city v from city u, he may choose as the next city in the trip any city connected with v by the road, except for the city u.Your task is to help Alex plan his city in a way that maximizes total score over all cities he visited. Note that for each city its score is counted at most once, even if Alex been there several times during his trip." "dfs and similar,dp,dsu,graphs,greedy,trees" 2200
1948C "Arrow Path" "There is a grid, consisting of 2 rows and n columns. The rows are numbered from 1 to 2 from top to bottom. The columns are numbered from 1 to n from left to right. Each cell of the grid contains an arrow pointing either to the left or to the right. No arrow points outside the grid.There is a robot that starts in a cell (1,1). Every second, the following two actions happen one after another:   Firstly, the robot moves left, right, down or up (it can\'t try to go outside the grid, and can\'t skip a move);  then it moves along the arrow that is placed in the current cell (the cell it ends up after its move). Your task is to determine whether the robot can reach the cell (2,n)." "brute force,constructive algorithms,dfs and similar,dp,graphs,shortest paths" 1300
723D "Lakes in Berland" "The map of Berland is a rectangle of the size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m, which consists of cells of size 1\xe2\x80\x89\xc3\x97\xe2\x80\x891. Each cell is either land or water. The map is surrounded by the ocean. Lakes are the maximal regions of water cells, connected by sides, which are not connected with the ocean. Formally, lake is a set of water cells, such that it\'s possible to get from any cell of the set to any other without leaving the set and moving only to cells adjacent by the side, none of them is located on the border of the rectangle, and it\'s impossible to add one more water cell to the set such that it will be connected with any other cell.You task is to fill up with the earth the minimum number of water cells so that there will be exactly k lakes in Berland. Note that the initial number of lakes on the map is not less than k." "dfs and similar,dsu,graphs,greedy,implementation" 1600
600E "Lomsat gelral" "You are given a rooted tree with root in vertex 1. Each vertex is coloured in some colour.Let\'s call colour c dominating in the subtree of vertex v if there are no other colours that appear in the subtree of vertex v more times than colour c. So it\'s possible that two or more colours will be dominating in the subtree of some vertex.The subtree of vertex v is the vertex v and all other vertices that contains vertex v in each path to the root.For each vertex v find the sum of all dominating colours in the subtree of vertex v." "data structures,dfs and similar,dsu,trees" 2300
981A Antipalindrome "A string is a palindrome if it reads the same from the left to the right and from the right to the left. For example, the strings ""kek"", ""abacaba"", ""r"" and ""papicipap"" are palindromes, while the strings ""abb"" and ""iq"" are not.A substring s[l\xe2\x80\xa6r] (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|s|) of a string s\xe2\x80\x89=\xe2\x80\x89s1s2\xe2\x80\xa6s|s| is the string slsl\xe2\x80\x89+\xe2\x80\x891\xe2\x80\xa6sr.Anna does not like palindromes, so she makes her friends call her Ann. She also changes all the words she reads in a similar way. Namely, each word s is changed into its longest substring that is not a palindrome. If all the substrings of s are palindromes, she skips the word at all.Some time ago Ann read the word s. What is the word she changed it into?" "brute force,implementation,strings" 900
399A Pages "User ainta is making a web site. This time he is going to make a navigation of the pages. In his site, there are n pages numbered by integers from 1 to n. Assume that somebody is on the p-th page now. The navigation will look like this: << p\xe2\x80\x89-\xe2\x80\x89k p\xe2\x80\x89-\xe2\x80\x89k\xe2\x80\x89+\xe2\x80\x891 ... p\xe2\x80\x89-\xe2\x80\x891 (p) p\xe2\x80\x89+\xe2\x80\x891 ... p\xe2\x80\x89+\xe2\x80\x89k\xe2\x80\x89-\xe2\x80\x891 p\xe2\x80\x89+\xe2\x80\x89k >> When someone clicks the button ""<<"" he is redirected to page 1, and when someone clicks the button "">>"" he is redirected to page n. Of course if someone clicks on a number, he is redirected to the corresponding page.There are some conditions in the navigation:  If page 1 is in the navigation, the button ""<<"" must not be printed.  If page n is in the navigation, the button "">>"" must not be printed.  If the page number is smaller than 1 or greater than n, it must not be printed.   You can see some examples of the navigations. Make a program that prints the navigation." implementation -999
1216E2 "Numerical Sequence (hard version)" "The only difference between the easy and the hard versions is the maximum value of k.You are given an infinite sequence of form ""112123123412345\xe2\x80\xa6"" which consist of blocks of all consecutive positive integers written one after another. The first block consists of all numbers from 1 to 1, the second one \xe2\x80\x94 from 1 to 2, the third one \xe2\x80\x94 from 1 to 3, \xe2\x80\xa6, the i-th block consists of all numbers from 1 to i. So the first 56 elements of the sequence are ""11212312341234512345612345671234567812345678912345678910"". Elements of the sequence are numbered from one. For example, the 1-st element of the sequence is 1, the 3-rd element of the sequence is 2, the 20-th element of the sequence is 5, the 38-th element is 2, the 56-th element of the sequence is 0.Your task is to answer q independent queries. In the i-th query you are given one integer ki. Calculate the digit at the position ki of the sequence." "binary search,math" 2200
1315C "Restoring Permutation" "You are given a sequence b1,b2,\xe2\x80\xa6,bn. Find the lexicographically minimal permutation a1,a2,\xe2\x80\xa6,a2n such that bi=min(a2i\xe2\x88\x921,a2i), or determine that it is impossible." greedy 1200
220E "Little Elephant and Inversions" "The Little Elephant has array a, consisting of n positive integers, indexed from 1 to n. Let\'s denote the number with index i as ai.The Little Elephant wants to count, how many pairs of integers l and r are there, such that 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89<\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n and sequence b\xe2\x80\x89=\xe2\x80\x89a1a2... alarar\xe2\x80\x89+\xe2\x80\x891... an has no more than k inversions. An inversion in sequence b is a pair of elements of the sequence b, that change their relative order after a stable sorting of the sequence. In other words, an inversion is a pair of integers i and j, such that 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|b| and bi\xe2\x80\x89>\xe2\x80\x89bj, where |b| is the length of sequence b, and bj is its j-th element.Help the Little Elephant and count the number of the described pairs." "data structures,two pointers" 2400
1045C "Hyperspace Highways" "In an unspecified solar system, there are N planets. A space government company has recently hired space contractors to build M bidirectional Hyperspace\xe2\x84\xa2 highways, each connecting two different planets. The primary objective, which was to make sure that every planet can be reached from any other planet taking only Hyperspace\xe2\x84\xa2 highways, has been completely fulfilled. Unfortunately, lots of space contractors had friends and cousins in the Space Board of Directors of the company, so the company decided to do much more than just connecting all planets. In order to make spending enormous amounts of space money for Hyperspace\xe2\x84\xa2 highways look neccessary, they decided to enforce a strict rule on the Hyperspace\xe2\x84\xa2 highway network: whenever there is a way to travel through some planets and return to the starting point without travelling through any planet twice, every pair of planets on the itinerary should be directly connected by a Hyperspace\xe2\x84\xa2 highway. In other words, the set of planets in every simple cycle induces a complete subgraph.You are designing a Hyperspace\xe2\x84\xa2 navigational app, and the key technical problem you are facing is finding the minimal number of Hyperspace\xe2\x84\xa2 highways one needs to use to travel from planet A to planet B. As this problem is too easy for Bubble Cup, here is a harder task: your program needs to do it for Q pairs of planets." "dfs and similar,graphs,trees" 2300
1167F "Scalar Queries" "You are given an array a1,a2,\xe2\x80\xa6,an. All ai are pairwise distinct.Let\'s define function f(l,r) as follows:   let\'s define array b1,b2,\xe2\x80\xa6,br\xe2\x88\x92l+1, where bi=al\xe2\x88\x921+i;  sort array b in increasing order;  result of the function f(l,r) is r\xe2\x88\x92l+1\xe2\x88\x91i=1bi\xe2\x8b\x85i. Calculate (\xe2\x88\x911\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4nf(l,r))mod(109+7), i.e. total sum of f for all subsegments of a modulo 109+7." "combinatorics,data structures,math,sortings" 2300
1987B K-Sort "You are given an array of integers a of length n. You can apply the following operation any number of times (maybe, zero):   First, choose an integer k such that 1\xe2\x89\xa4k\xe2\x89\xa4n and pay k+1 coins.  Then, choose exactly k indices such that 1\xe2\x89\xa4i1<i2<\xe2\x80\xa6<ik\xe2\x89\xa4n.  Then, for each x from 1 to k, increase aix by 1. Find the minimum number of coins needed to make a non-decreasing. That is, a1\xe2\x89\xa4a2\xe2\x89\xa4\xe2\x80\xa6\xe2\x89\xa4an." greedy 1000
1882E2 "Two Permutations (Hard Version)" "This is the hard version of the problem. The difference between the two versions is that you have to minimize the number of operations in this version. You can make hacks only if both versions of the problem are solved.You have two permutations\xe2\x80\xa0 p1,p2,\xe2\x80\xa6,pn (of integers 1 to n) and q1,q2,\xe2\x80\xa6,qm (of integers 1 to m). Initially pi=ai for i=1,2,\xe2\x80\xa6,n, and qj=bj for j=1,2,\xe2\x80\xa6,m. You can apply the following operation on the permutations several (possibly, zero) times.In one operation, p and q will change according to the following three steps:  You choose integers i, j which satisfy 1\xe2\x89\xa4i\xe2\x89\xa4n and 1\xe2\x89\xa4j\xe2\x89\xa4m.  Permutation p is partitioned into three parts using pi as a pivot: the left part is formed by elements p1,p2,\xe2\x80\xa6,pi\xe2\x88\x921 (this part may be empty), the middle part is the single element pi, and the right part is pi+1,pi+2,\xe2\x80\xa6,pn (this part may be empty). To proceed, swap the left and the right parts of this partition. Formally, after this step, p will become pi+1,pi+2,\xe2\x80\xa6,pn,pi,p1,p2,\xe2\x80\xa6,pi\xe2\x88\x921. The elements of the newly formed p will be reindexed starting from 1.  Perform the same transformation on q with index j. Formally, after this step, q will become qj+1,qj+2,\xe2\x80\xa6,qm,qj,q1,q2,\xe2\x80\xa6,qj\xe2\x88\x921. The elements of the newly formed q will be reindexed starting from 1. Your goal is to simultaneously make pi=i for i=1,2,\xe2\x80\xa6,n, and qj=j for j=1,2,\xe2\x80\xa6,m.Find any way to achieve the goal using the minimum number of operations possible, or say that none exists. Please note that you have to minimize the number of operations.\xe2\x80\xa0 A permutation of length k is an array consisting of k distinct integers from 1 to k in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array), and [1,3,4] is also not a permutation (k=3 but there is 4 in the array)." "constructive algorithms" 3100
297A "Parity Game" "You are fishing with polar bears Alice and Bob. While waiting for the fish to bite, the polar bears get bored. They come up with a game. First Alice and Bob each writes a 01-string (strings that only contain character ""0"" and ""1"") a and b. Then you try to turn a into b using two types of operations:  Write parity(a) to the end of a. For example, .  Remove the first character of a. For example, . You cannot perform this operation if a is empty. You can use as many operations as you want. The problem is, is it possible to turn a into b?The parity of a 01-string is 1 if there is an odd number of ""1""s in the string, and 0 otherwise." "constructive algorithms" 1700
1526E "Oolimry and Suffix Array" "Once upon a time, Oolimry saw a suffix array. He wondered how many strings can produce this suffix array. More formally, given a suffix array of length n and having an alphabet size k, count the number of strings that produce such a suffix array. Let s be a string of length n. Then the i-th suffix of s is the substring s[i\xe2\x80\xa6n\xe2\x88\x921]. A suffix array is the array of integers that represent the starting indexes of all the suffixes of a given string, after the suffixes are sorted in the lexicographic order. For example, the suffix array of oolimry is [3,2,4,1,0,5,6] as the array of sorted suffixes is [imry,limry,mry,olimry,oolimry,ry,y]. A string x is lexicographically smaller than string y, if either x is a prefix of y (and x\xe2\x89\xa0y), or there exists such i that xi<yi, and for any 1\xe2\x89\xa4j<i , xj=yj." "combinatorics,constructive algorithms,math" 2400
1147B "Chladni Figure" "Inaka has a disc, the circumference of which is n units. The circumference is equally divided by n points numbered clockwise from 1 to n, such that points i and i+1 (1\xe2\x89\xa4i<n) are adjacent, and so are points n and 1.There are m straight segments on the disc, the endpoints of which are all among the aforementioned n points.Inaka wants to know if her image is rotationally symmetrical, i.e. if there is an integer k (1\xe2\x89\xa4k<n), such that if all segments are rotated clockwise around the center of the circle by k units, the new image will be the same as the original one." "brute force,strings" 1900
523A "Rotate, Flip and Zoom" "Polycarp is writing the prototype of a graphic editor. He has already made up his mind that the basic image transformations in his editor will be: rotate the image 90 degrees clockwise, flip the image horizontally (symmetry relative to the vertical line, that is, the right part of the image moves to the left, and vice versa) and zooming on the image. He is sure that that there is a large number of transformations that can be expressed through these three.He has recently stopped implementing all three transformations for monochrome images. To test this feature, he asked you to write a code that will consecutively perform three actions with a monochrome image: first it will rotate the image 90 degrees clockwise, then it will flip the image horizontally and finally, it will zoom in twice on the image (that is, it will double all the linear sizes).Implement this feature to help Polycarp test his editor." "*special problem,implementation" 1200
1130A "Be Positive" "You are given an array of n integers: a1,a2,\xe2\x80\xa6,an. Your task is to find some non-zero integer d (\xe2\x88\x92103\xe2\x89\xa4d\xe2\x89\xa4103) such that, after each number in the array is divided by d, the number of positive numbers that are presented in the array is greater than or equal to half of the array size (i.e., at least \xe2\x8c\x88n2\xe2\x8c\x89). Note that those positive numbers do not need to be an integer (e.g., a 2.5 counts as a positive number). If there are multiple values of d that satisfy the condition, you may print any of them. In case that there is no such d, print a single integer 0.Recall that \xe2\x8c\x88x\xe2\x8c\x89 represents the smallest integer that is not less than x and that zero (0) is neither positive nor negative." implementation 800
1923E "Count Paths" "You are given a tree, consisting of n vertices, numbered from 1 to n. Every vertex is colored in some color, denoted by an integer from 1 to n.A simple path of the tree is called beautiful if:   it consists of at least 2 vertices;  the first and the last vertices of the path have the same color;  no other vertex on the path has the same color as the first vertex. Count the number of the beautiful simple paths of the tree. Note that paths are considered undirected (i. e. the path from x to y is the same as the path from y to x)." "data structures,dfs and similar,dp,dsu,graphs,trees" 2000
546B "Soldier and Badges" "Colonel has n badges. He wants to give one badge to every of his n soldiers. Each badge has a coolness factor, which shows how much it\'s owner reached. Coolness factor can be increased by one for the cost of one coin. For every pair of soldiers one of them should get a badge with strictly higher factor than the second one. Exact values of their factors aren\'t important, they just need to have distinct factors. Colonel knows, which soldier is supposed to get which badge initially, but there is a problem. Some of badges may have the same factor of coolness. Help him and calculate how much money has to be paid for making all badges have different factors of coolness." "brute force,greedy,implementation,sortings" 1200
2037G "Natlan Exploring" "You are exploring the stunning region of Natlan! This region consists of n cities, and each city is rated with an attractiveness ai. A directed edge exists from City i to City j if and only if i<j and gcd(ai,aj)\xe2\x89\xa01, where gcd(x,y) denotes the greatest common divisor (GCD) of integers x and y.Starting from City 1, your task is to determine the total number of distinct paths you can take to reach City n, modulo 998244353. Two paths are different if and only if the set of cities visited is different." "combinatorics,dp,math,number theory" -999
1056D "Decorate Apple Tree" "There is one apple tree in Arkady\'s garden. It can be represented as a set of junctions connected with branches so that there is only one way to reach any junctions from any other one using branches. The junctions are enumerated from 1 to n, the junction 1 is called the root.A subtree of a junction v is a set of junctions u such that the path from u to the root must pass through v. Note that v itself is included in a subtree of v.A leaf is such a junction that its subtree contains exactly one junction.The New Year is coming, so Arkady wants to decorate the tree. He will put a light bulb of some color on each leaf junction and then count the number happy junctions. A happy junction is such a junction t that all light bulbs in the subtree of t have different colors.Arkady is interested in the following question: for each k from 1 to n, what is the minimum number of different colors needed to make the number of happy junctions be greater than or equal to k?" "constructive algorithms,dfs and similar,dp,graphs,greedy,sortings,trees" 1600
1863E Speedrun "You are playing a video game. The game has n quests that need to be completed. However, the j-th quest can only be completed at the beginning of hour hj of a game day. The game day is k hours long. The hours of each game day are numbered 0,1,\xe2\x80\xa6,k\xe2\x88\x921. After the first day ends, a new one starts, and so on.Also, there are dependencies between the quests, that is, for some pairs (ai,bi) the bi-th quest can only be completed after the ai-th quest. It is guaranteed that there are no circular dependencies, as otherwise the game would be unbeatable and nobody would play it.You are skilled enough to complete any number of quests in a negligible amount of time (i. e. you can complete any number of quests at the beginning of the same hour, even if there are dependencies between them). You want to complete all quests as fast as possible. To do this, you can complete the quests in any valid order. The completion time is equal to the difference between the time of completing the last quest and the time of completing the first quest in this order.Find the least amount of time you need to complete the game." "brute force,dfs and similar,dp,graphs,greedy,math,sortings,two pointers" 2100
750A "New Year and Hurry" "Limak is going to participate in a contest on the last day of the 2016. The contest will start at 20:00 and will last four hours, exactly until midnight. There will be n problems, sorted by difficulty, i.e. problem 1 is the easiest and problem n is the hardest. Limak knows it will take him 5\xc2\xb7i minutes to solve the i-th problem.Limak\'s friends organize a New Year\'s Eve party and Limak wants to be there at midnight or earlier. He needs k minutes to get there from his house, where he will participate in the contest first.How many problems can Limak solve if he wants to make it to the party?" "binary search,brute force,implementation,math" 800
1526C2 "Potions (Hard Version)" "This is the hard version of the problem. The only difference is that in this version n\xe2\x89\xa4200000. You can make hacks only if both versions of the problem are solved.There are n potions in a line, with potion 1 on the far left and potion n on the far right. Each potion will increase your health by ai when drunk. ai can be negative, meaning that potion will decrease will health.You start with 0 health and you will walk from left to right, from first potion to the last one. At each potion, you may choose to drink it or ignore it. You must ensure that your health is always non-negative.What is the largest number of potions you can drink?" "data structures,greedy" 1600
356D "Bags and Coins" "When you were a child you must have been told a puzzle of bags and coins. Anyway, here\'s one of its versions: A horse has three bags. The first bag has one coin, the second bag has one coin and the third bag has three coins. In total, the horse has three coins in the bags. How is that possible? The answer is quite simple. The third bag contains a coin and two other bags. This problem is a generalization of the childhood puzzle. You have n bags. You know that the first bag contains a1 coins, the second bag contains a2 coins, ..., the n-th bag contains an coins. In total, there are s coins. Find the way to arrange the bags and coins so that they match the described scenario or else state that it is impossible to do." "bitmasks,constructive algorithms,dp,greedy" 2700
2025B "Binomial Coefficients, Kind Of" "Recently, akshiM met a task that needed binomial coefficients to solve. He wrote a code he usually does that looked like this:    for (int n = 0; n < N; n++) { // loop over n from 0 to N-1 (inclusive)        C[n][0] = 1;        C[n][n] = 1;        for (int k = 1; k < n; k++) // loop over k from 1 to n-1 (inclusive)            C[n][k] = C[n][k - 1] + C[n - 1][k - 1];    }Unfortunately, he made an error, since the right formula is the following:            C[n][k] = C[n - 1][k] + C[n - 1][k - 1]But his team member keblidA is interested in values that were produced using the wrong formula. Please help him to calculate these coefficients for t various pairs (ni,ki). Note that they should be calculated according to the first (wrong) formula.Since values C[ni][ki] may be too large, print them modulo 109+7." combinatorics,dp,math 1100
1172F "Nauuo and Bug" "Nauuo is a girl who loves coding.One day she was solving a problem which requires to calculate a sum of some numbers modulo p.She wrote the following code and got the verdict ""Wrong answer"".She soon discovered the bug \xe2\x80\x94 the ModAdd function only worked for numbers in the range [0,p), but the numbers in the problem may be out of the range. She was curious about the wrong function, so she wanted to know the result of it.However, the original code worked too slow, so she asked you to help her.You are given an array a1,a2,\xe2\x80\xa6,an and a number p. Nauuo will make m queries, in each query, you are given l and r, and you have to calculate the results of Sum(a,l,r,p). You can see the definition of the Sum function in the pseudocode above.Note that the integers won\'t overflow in the code above." "data structures" 3300
899D "Shovel Sale" "There are n shovels in Polycarp\'s shop. The i-th shovel costs i burles, that is, the first shovel costs 1 burle, the second shovel costs 2 burles, the third shovel costs 3 burles, and so on. Polycarps wants to sell shovels in pairs.Visitors are more likely to buy a pair of shovels if their total cost ends with several 9s. Because of this, Polycarp wants to choose a pair of shovels to sell in such a way that the sum of their costs ends with maximum possible number of nines. For example, if he chooses shovels with costs 12345 and 37454, their total cost is 49799, it ends with two nines.You are to compute the number of pairs of shovels such that their total cost ends with maximum possible number of nines. Two pairs are considered different if there is a shovel presented in one pair, but not in the other." "constructive algorithms,math" 1800
698F "Coprime Permutation" "Two positive integers are coprime if and only if they don\'t have a common divisor greater than 1.Some bear doesn\'t want to tell Radewoosh how to solve some algorithmic problem. So, Radewoosh is going to break into that bear\'s safe with solutions. To pass through the door, he must enter a permutation of numbers 1 through n. The door opens if and only if an entered permutation p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pn satisfies:In other words, two different elements are coprime if and only if their indices are coprime. Some elements of a permutation may be already fixed. In how many ways can Radewoosh fill the remaining gaps so that the door will open? Print the answer modulo 109\xe2\x80\x89+\xe2\x80\x897." "combinatorics,number theory" 3000
1023C "Bracket Subsequence" "A bracket sequence is a string containing only characters ""("" and "")"". A regular bracket sequence is a bracket sequence that can be transformed into a correct arithmetic expression by inserting characters ""1"" and ""+"" between the original characters of the sequence. For example, bracket sequences ""()()"" and ""(())"" are regular (the resulting expressions are: ""(1)+(1)"" and ""((1+1)+1)""), and "")("", ""("" and "")"" are not.Subsequence is a sequence that can be derived from another sequence by deleting some elements without changing the order of the remaining elements.You are given a regular bracket sequence s and an integer number k. Your task is to find a regular bracket sequence of length exactly k such that it is also a subsequence of s.It is guaranteed that such sequence always exists." greedy 1200
1463B "Find The Array" "You are given an array [a1,a2,\xe2\x80\xa6,an] such that 1\xe2\x89\xa4ai\xe2\x89\xa4109. Let S be the sum of all elements of the array a.Let\'s call an array b of n integers beautiful if:  1\xe2\x89\xa4bi\xe2\x89\xa4109 for each i from 1 to n;  for every pair of adjacent integers from the array (bi,bi+1), either bi divides bi+1, or bi+1 divides bi (or both);  2n\xe2\x88\x91i=1|ai\xe2\x88\x92bi|\xe2\x89\xa4S. Your task is to find any beautiful array. It can be shown that at least one beautiful array always exists." "bitmasks,constructive algorithms,greedy" 1400
633H "Fibonacci-ish II" "Yash is finally tired of computing the length of the longest Fibonacci-ish sequence. He now plays around with more complex things such as Fibonacci-ish potentials. Fibonacci-ish potential of an array ai is computed as follows:   Remove all elements j if there exists i\xe2\x80\x89<\xe2\x80\x89j such that ai\xe2\x80\x89=\xe2\x80\x89aj.  Sort the remaining elements in ascending order, i.e. a1\xe2\x80\x89<\xe2\x80\x89a2\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89an.  Compute the potential as P(a)\xe2\x80\x89=\xe2\x80\x89a1\xc2\xb7F1\xe2\x80\x89+\xe2\x80\x89a2\xc2\xb7F2\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89an\xc2\xb7Fn, where Fi is the i-th Fibonacci number (see notes for clarification). You are given an array ai of length n and q ranges from lj to rj. For each range j you have to compute the Fibonacci-ish potential of the array bi, composed using all elements of ai from lj to rj inclusive. Find these potentials modulo m." "data structures,implementation" 3100
799F "Beautiful fountains rows" "Butler Ostin wants to show Arkady that rows of odd number of fountains are beautiful, while rows of even number of fountains are not.The butler wants to show Arkady n gardens. Each garden is a row of m cells, the i-th garden has one fountain in each of the cells between li and ri inclusive, and there are no more fountains in that garden. The issue is that some of the gardens contain even number of fountains, it is wrong to show them to Arkady.Ostin wants to choose two integers a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b and show only part of each of the gardens that starts at cell a and ends at cell b. Of course, only such segments suit Ostin that each garden has either zero or odd number of fountains on this segment. Also, it is necessary that at least one garden has at least one fountain on the segment from a to b.Help Ostin to find the total length of all such segments, i.e. sum up the value (b\xe2\x80\x89-\xe2\x80\x89a\xe2\x80\x89+\xe2\x80\x891) for each suitable pair (a,\xe2\x80\x89b)." "data structures" 3500
397B "On Corruption and Numbers" "Alexey, a merry Berland entrant, got sick of the gray reality and he zealously wants to go to university. There are a lot of universities nowadays, so Alexey is getting lost in the diversity \xe2\x80\x94 he has not yet decided what profession he wants to get. At school, he had bad grades in all subjects, and it\'s only thanks to wealthy parents that he was able to obtain the graduation certificate.The situation is complicated by the fact that each high education institution has the determined amount of voluntary donations, paid by the new students for admission \xe2\x80\x94 ni berubleys. He cannot pay more than ni, because then the difference between the paid amount and ni can be regarded as a bribe!Each rector is wearing the distinctive uniform of his university. Therefore, the uniform\'s pockets cannot contain coins of denomination more than ri. The rector also does not carry coins of denomination less than li in his pocket \xe2\x80\x94 because if everyone pays him with so small coins, they gather a lot of weight and the pocket tears. Therefore, a donation can be paid only by coins of denomination x berubleys, where li\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ri (Berland uses coins of any positive integer denomination). Alexey can use the coins of different denominations and he can use the coins of the same denomination any number of times. When Alexey was first confronted with such orders, he was puzzled because it turned out that not all universities can accept him! Alexey is very afraid of going into the army (even though he had long wanted to get the green uniform, but his dad says that the army bullies will beat his son and he cannot pay to ensure the boy\'s safety). So, Alexey wants to know for sure which universities he can enter so that he could quickly choose his alma mater.Thanks to the parents, Alexey is not limited in money and we can assume that he has an unlimited number of coins of each type.In other words, you are given t requests, each of them contains numbers ni,\xe2\x80\x89li,\xe2\x80\x89ri. For each query you need to answer, whether it is possible to gather the sum of exactly ni berubleys using only coins with an integer denomination from li to ri berubleys. You can use coins of different denominations. Coins of each denomination can be used any number of times." "constructive algorithms,implementation,math" -999
1685A "Circular Local MiniMax" "You are given n integers a1,a2,\xe2\x80\xa6,an. Is it possible to arrange them on a circle so that each number is strictly greater than both its neighbors or strictly smaller than both its neighbors?In other words, check if there exists a rearrangement b1,b2,\xe2\x80\xa6,bn of the integers a1,a2,\xe2\x80\xa6,an such that for each i from 1 to n at least one of the following conditions holds: bi\xe2\x88\x921<bi>bi+1 bi\xe2\x88\x921>bi<bi+1To make sense of the previous formulas for i=1 and i=n, one shall define b0=bn and bn+1=b1." "constructive algorithms,greedy,sortings" 1100
106D "Treasure Island" "Our brave travelers reached an island where pirates had buried treasure. However as the ship was about to moor, the captain found out that some rat ate a piece of the treasure map.The treasure map can be represented as a rectangle n\xe2\x80\x89\xc3\x97\xe2\x80\x89m in size. Each cell stands for an islands\' square (the square\'s side length equals to a mile). Some cells stand for the sea and they are impenetrable. All other cells are penetrable (i.e. available) and some of them contain local sights. For example, the large tree on the hills or the cave in the rocks.Besides, the map also has a set of k instructions. Each instruction is in the following form:""Walk n miles in the y direction""The possible directions are: north, south, east, and west. If you follow these instructions carefully (you should fulfill all of them, one by one) then you should reach exactly the place where treasures are buried. Unfortunately the captain doesn\'t know the place where to start fulfilling the instructions \xe2\x80\x94 as that very piece of the map was lost. But the captain very well remembers that the place contained some local sight. Besides, the captain knows that the whole way goes through the island\'s penetrable squares.The captain wants to know which sights are worth checking. He asks you to help him with that." "brute force,implementation" 1700
1372D "Omkar and Circle" "Danny, the local Math Maniac, is fascinated by circles, Omkar\'s most recent creation. Help him solve this circle problem!You are given n nonnegative integers a1,a2,\xe2\x80\xa6,an arranged in a circle, where n must be odd (ie. n\xe2\x88\x921 is divisible by 2). Formally, for all i such that 2\xe2\x89\xa4i\xe2\x89\xa4n, the elements ai\xe2\x88\x921 and ai are considered to be adjacent, and an and a1 are also considered to be adjacent. In one operation, you pick a number on the circle, replace it with the sum of the two elements adjacent to it, and then delete the two adjacent elements from the circle. This is repeated until only one number remains in the circle, which we call the circular value.Help Danny find the maximum possible circular value after some sequences of operations." "brute force,dp,games,greedy" 2100
1930E "2..3...4.... Wonderful! Wonderful!" "Stack has an array a of length n such that ai=i for all i (1\xe2\x89\xa4i\xe2\x89\xa4n). He will select a positive integer k (1\xe2\x89\xa4k\xe2\x89\xa4\xe2\x8c\x8an\xe2\x88\x9212\xe2\x8c\x8b) and do the following operation on a any number (possibly 0) of times.  Select a subsequence\xe2\x80\xa0 s of length 2\xe2\x8b\x85k+1 from a. Now, he will delete the first k elements of s from a. To keep things perfectly balanced (as all things should be), he will also delete the last k elements of s from a. Stack wonders how many arrays a can he end up with for each k (1\xe2\x89\xa4k\xe2\x89\xa4\xe2\x8c\x8an\xe2\x88\x9212\xe2\x8c\x8b). As Stack is weak at counting problems, he needs your help. Since the number of arrays might be too large, please print it modulo 998244353.\xe2\x80\xa0 A sequence x is a subsequence of a sequence y if x can be obtained from y by deleting several (possibly, zero or all) elements. For example, [1,3], [1,2,3] and [2,3] are subsequences of [1,2,3]. On the other hand, [3,1] and [2,1,3] are not subsequences of [1,2,3]." combinatorics,dp,math 2400
1943D1 "Counting Is Fun (Easy Version)" "This is the easy version of the problem. The only difference between the two versions is the constraint on n. You can make hacks only if both versions of the problem are solved.An array b of m non-negative integers is said to be good if all the elements of b can be made equal to 0 using the following operation some (possibly, zero) times:   Select two distinct indices l and r (1\xe2\x89\xa4l<r\xe2\x89\xa4m) and subtract 1 from all bi such that l\xe2\x89\xa4i\xe2\x89\xa4r. You are given two positive integers n, k and a prime number p.Over all (k+1)n arrays of length n such that 0\xe2\x89\xa4ai\xe2\x89\xa4k for all 1\xe2\x89\xa4i\xe2\x89\xa4n, count the number of good arrays.Since the number might be too large, you are only required to find it modulo p." "brute force,combinatorics,dp,math" 2400
1965F Conference "You have been asked to organize a very important art conference. The first step is to choose the dates.The conference must last for a certain number of consecutive days. Each day, one lecturer must perform, and the same lecturer cannot perform more than once.You asked n potential lecturers if they could participate in the conference. Lecturer i indicated that they could perform on any day from li to ri inclusive.A certain segment of days can be chosen as the conference dates if there is a way to assign an available lecturer to each day of the segment, assigning each lecturer to no more than one day.For each k from 1 to n, find how many ways there are to choose a segment of k consecutive days as the conference dates." "data structures,flows" 3300
825G "Tree Queries" "You are given a tree consisting of n vertices (numbered from 1 to n). Initially all vertices are white. You have to process q queries of two different types:  1 x \xe2\x80\x94 change the color of vertex x to black. It is guaranteed that the first query will be of this type.  2 x \xe2\x80\x94 for the vertex x, find the minimum index y such that the vertex with index y belongs to the simple path from x to some black vertex (a simple path never visits any vertex more than once). For each query of type 2 print the answer to it.Note that the queries are given in modified way." "dfs and similar,graphs,trees" 2500
1767C "Count Binary Strings" "You are given an integer n. You have to calculate the number of binary (consisting of characters 0 and/or 1) strings s meeting the following constraints.For every pair of integers (i,j) such that 1\xe2\x89\xa4i\xe2\x89\xa4j\xe2\x89\xa4n, an integer ai,j is given. It imposes the following constraint on the string sisi+1si+2\xe2\x80\xa6sj:  if ai,j=1, all characters in sisi+1si+2\xe2\x80\xa6sj should be the same;  if ai,j=2, there should be at least two different characters in sisi+1si+2\xe2\x80\xa6sj;  if ai,j=0, there are no additional constraints on the string sisi+1si+2\xe2\x80\xa6sj. Count the number of binary strings s of length n meeting the aforementioned constraints. Since the answer can be large, print it modulo 998244353." "data structures,dp" 2100
1842B "Tenzing and Books" "Tenzing received 3n books from his fans. The books are arranged in 3 stacks with n books in each stack. Each book has a non-negative integer difficulty rating.Tenzing wants to read some (possibly zero) books. At first, his knowledge is 0.To read the books, Tenzing will choose a non-empty stack, read the book on the top of the stack, and then discard the book. If Tenzing\'s knowledge is currently u, then his knowledge will become u|v after reading a book with difficulty rating v. Here | denotes the bitwise OR operation. Note that Tenzing can stop reading books whenever he wants.Tenzing\'s favourite number is x. Can you help Tenzing check if it is possible for his knowledge to become x?" bitmasks,greedy,math 1100
1985H1 "Maximize the Largest Component (Easy Version)" "Easy and hard versions are actually different problems, so read statements of both problems completely and carefully. The only difference between the two versions is the operation.Alex has a grid with n rows and m columns consisting of \'.\' and \'#\' characters. A set of \'#\' cells forms a connected component if from any cell in this set, it is possible to reach any other cell in this set by only moving to another cell in the set that shares a common side. The size of a connected component is the number of cells in the set.In one operation, Alex selects any row r (1\xe2\x89\xa4r\xe2\x89\xa4n) or any column c (1\xe2\x89\xa4c\xe2\x89\xa4m), then sets every cell in row r or column c to be \'#\'. Help Alex find the maximum possible size of the largest connected component of \'#\' cells that he can achieve after performing the operation at most once." "brute force,data structures,dfs and similar,dsu,graphs,implementation" 1700
2001B "Generate Permutation" "There is an integer sequence a of length n, where each element is initially \xe2\x88\x921.Misuki has two typewriters where the first one writes letters from left to right, with a pointer initially pointing to 1, and another writes letters from right to left with a pointer initially pointing to n.Misuki would choose one of the typewriters and use it to perform the following operations until a becomes a permutation of [1,2,\xe2\x80\xa6,n]  write number: write the minimum positive integer that isn\'t present in the array a to the element ai, i is the position where the pointer points at. Such operation can be performed only when ai=\xe2\x88\x921.  carriage return: return the pointer to its initial position (i.e. 1 for the first typewriter, n for the second)  move pointer: move the pointer to the next position, let i be the position the pointer points at before this operation, if Misuki is using the first typewriter, i:=i+1 would happen, and i:=i\xe2\x88\x921 otherwise. Such operation can be performed only if after the operation, 1\xe2\x89\xa4i\xe2\x89\xa4n holds. Your task is to construct any permutation p of length n, such that the minimum number of carriage return operations needed to make a=p is the same no matter which typewriter Misuki is using." "constructive algorithms" 800
1543E "The Final Pursuit" "Finally, you have defeated Razor and now, you are the Most Wanted street racer. Sergeant Cross has sent the full police force after you in a deadly pursuit. Fortunately, you have found a hiding spot but you fear that Cross and his force will eventually find you. To increase your chances of survival, you want to tune and repaint your BMW M3 GTR.The car can be imagined as a permuted n-dimensional hypercube. A simple n-dimensional hypercube is an undirected unweighted graph built recursively as follows:   Take two simple (n\xe2\x88\x921)-dimensional hypercubes one having vertices numbered from 0 to 2n\xe2\x88\x921\xe2\x88\x921 and the other having vertices numbered from 2n\xe2\x88\x921 to 2n\xe2\x88\x921. A simple 0-dimensional Hypercube is just a single vertex.  Add an edge between the vertices i and i+2n\xe2\x88\x921 for each 0\xe2\x89\xa4i<2n\xe2\x88\x921. A permuted n-dimensional hypercube is formed by permuting the vertex numbers of a simple n-dimensional hypercube in any arbitrary manner.Examples of a simple and permuted 3-dimensional hypercubes are given below:  Note that a permuted n-dimensional hypercube has the following properties:   There are exactly 2n vertices.  There are exactly n\xe2\x8b\x852n\xe2\x88\x921 edges.  Each vertex is connected to exactly n other vertices.  There are no self-loops or duplicate edges. Let\'s denote the permutation used to generate the permuted n-dimensional hypercube, representing your car, from a simple n-dimensional hypercube by P. Before messing up the functionalities of the car, you want to find this permutation so that you can restore the car if anything goes wrong. But the job isn\'t done yet.You have n different colours numbered from 0 to n\xe2\x88\x921. You want to colour the vertices of this permuted n-dimensional hypercube in such a way that for each and every vertex u satisfying 0\xe2\x89\xa4u<2n and for each and every colour c satisfying 0\xe2\x89\xa4c<n, there is at least one vertex v adjacent to u having a colour c. In other words, from each and every vertex, it must be possible to reach a vertex of any colour by just moving to an adjacent vertex. Given the permuted n-dimensional hypercube, find any valid permutation P and colouring." "bitmasks,constructive algorithms,divide and conquer,graphs,greedy,math" 2700
1542C "Strange Function" "Let f(i) denote the minimum positive integer x such that x is not a divisor of i.Compute \xe2\x88\x91ni=1f(i) modulo 109+7. In other words, compute f(1)+f(2)+\xe2\x8b\xaf+f(n) modulo 109+7." "math,number theory" 1600
213D Stars "Furik loves painting stars. A star is a shape that results if we take a regular pentagon and paint all diagonals in it.   Recently he decided to teach Rubik to paint stars. After many years of training Rubik could paint stars easily. But now Furik decided to test Rubik and complicated the task. Rubik must paint n stars, observing the following rules:  all stars must be painted in a single move (i.e. it is forbidden to take the pen away from the paper);  it is forbidden to paint the same segment of non-zero length more than once;  the stars can intersect only in their vertexes;  the length of a side of the regular pentagon, in which Rubik paints each star, must equal 10. Help Rubik to cope with this hard task." "constructive algorithms,geometry" 2300
207A2 "Beaver\'s Calculator 1.0" "The Smart Beaver from ABBYY has once again surprised us! He has developed a new calculating device, which he called the ""Beaver\'s Calculator 1.0"". It is very peculiar and it is planned to be used in a variety of scientific problems.To test it, the Smart Beaver invited n scientists, numbered from 1 to n. The i-th scientist brought ki calculating problems for the device developed by the Smart Beaver from ABBYY. The problems of the i-th scientist are numbered from 1 to ki, and they must be calculated sequentially in the described order, since calculating each problem heavily depends on the results of calculating of the previous ones.Each problem of each of the n scientists is described by one integer ai,\xe2\x80\x89j, where i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) is the number of the scientist, j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ki) is the number of the problem, and ai,\xe2\x80\x89j is the number of resource units the calculating device needs to solve this problem.The calculating device that is developed by the Smart Beaver is pretty unusual. It solves problems sequentially, one after another. After some problem is solved and before the next one is considered, the calculating device allocates or frees resources.The most expensive operation for the calculating device is freeing resources, which works much slower than allocating them. It is therefore desirable that each next problem for the calculating device requires no less resources than the previous one.You are given the information about the problems the scientists offered for the testing. You need to arrange these problems in such an order that the number of adjacent ""bad"" pairs of problems in this list is minimum possible. We will call two consecutive problems in this list a ""bad pair"" if the problem that is performed first requires more resources than the one that goes after it. Do not forget that the problems of the same scientist must be solved in a fixed order." greedy 1800
1790B "Taisia and Dice" "Taisia has n six-sided dice. Each face of the die is marked with a number from 1 to 6, each number from 1 to 6 is used once.Taisia rolls all n dice at the same time and gets a sequence of values a1,a2,\xe2\x80\xa6,an (1\xe2\x89\xa4ai\xe2\x89\xa46), where ai is the value on the upper face of the i-th dice. The sum of this sequence is equal to s.Suddenly, Taisia\'s pet cat steals exactly one dice with maximum value ai and calculates the sum of the values on the remaining n\xe2\x88\x921 dice, which is equal to r.You only know the number of dice n and the values of s, r. Restore a possible sequence a that fulfills the constraints." greedy,greedy,math 800
722E "Research Rover" "Unfortunately, the formal description of the task turned out to be too long, so here is the legend.Research rover finally reached the surface of Mars and is ready to complete its mission. Unfortunately, due to the mistake in the navigation system design, the rover is located in the wrong place.The rover will operate on the grid consisting of n rows and m columns. We will define as (r,\xe2\x80\x89c) the cell located in the row r and column c. From each cell the rover is able to move to any cell that share a side with the current one.The rover is currently located at cell (1,\xe2\x80\x891) and has to move to the cell (n,\xe2\x80\x89m). It will randomly follow some shortest path between these two cells. Each possible way is chosen equiprobably.The cargo section of the rover contains the battery required to conduct the research. Initially, the battery charge is equal to s units of energy.Some of the cells contain anomaly. Each time the rover gets to the cell with anomaly, the battery looses half of its charge rounded down. Formally, if the charge was equal to x before the rover gets to the cell with anomaly, the charge will change to .While the rover picks a random shortest path to proceed, compute the expected value of the battery charge after it reaches cell (n,\xe2\x80\x89m). If the cells (1,\xe2\x80\x891) and (n,\xe2\x80\x89m) contain anomaly, they also affect the charge of the battery." combinatorics,dp 2900
558A "Lala Land and Apple Trees" "Amr lives in Lala Land. Lala Land is a very beautiful country that is located on a coordinate line. Lala Land is famous with its apple trees growing everywhere.Lala Land has exactly n apple trees. Tree number i is located in a position xi and has ai apples growing on it. Amr wants to collect apples from the apple trees. Amr currently stands in x\xe2\x80\x89=\xe2\x80\x890 position. At the beginning, he can choose whether to go right or left. He\'ll continue in his direction until he meets an apple tree he didn\'t visit before. He\'ll take all of its apples and then reverse his direction, continue walking in this direction until he meets another apple tree he didn\'t visit before and so on. In the other words, Amr reverses his direction when visiting each new apple tree. Amr will stop collecting apples when there are no more trees he didn\'t visit in the direction he is facing.What is the maximum number of apples he can collect?" "brute force,implementation,sortings" 1100
1945F "Kirill and Mushrooms" "As soon as everyone in the camp fell asleep, Kirill sneaked out of the tent and went to the Wise Oak to gather mushrooms.It is known that there are n mushrooms growing under the Oak, each of which has magic power vi. Kirill really wants to make a magical elixir of maximum strength from the mushrooms.The strength of the elixir is equal to the product of the number of mushrooms in it and the minimum magic power among these mushrooms. To prepare the elixir, Kirill will sequentially pick one mushroom growing under the Oak. Kirill can gather mushrooms in any order.However, it\'s not that simple. The Wise Oak informed Kirill of a permutation of numbers p from 1 to n. If Kirill picks only k mushrooms, then the magic power of all mushrooms with indices p1,p2,\xe2\x80\xa6,pk\xe2\x88\x921 will become 0. Kirill will not use mushrooms with zero magic power to prepare the elixir.Your task is to help Kirill gather mushrooms in such a way that he can brew the elixir of maximum possible strength. However, Kirill is a little scared to stay near the oak for too long, so out of all the suitable options for gathering mushrooms, he asks you to find the one with the minimum number of mushrooms.A permutation of length n is an array consisting of n different integers from 1 to n in any order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears in the array twice) and [1,3,4] is also not a permutation (n=3, but 4 appears in the array)." "data structures,sortings" 1900
1945E "Binary Search" "Anton got bored during the hike and wanted to solve something. He asked Kirill if he had any new problems, and of course, Kirill had one.You are given a permutation p of size n, and a number x that needs to be found. A permutation of length n is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array), and [1,3,4] is also not a permutation (n=3 but there is 4 in the array).You decided that you are a cool programmer, so you will use an advanced algorithm for the search \xe2\x80\x94 binary search. However, you forgot that for binary search, the array must be sorted.You did not give up and decided to apply this algorithm anyway, and in order to get the correct answer, you can perform the following operation no more than 2 times before running the algorithm: choose the indices i, j (1\xe2\x89\xa4i,j\xe2\x89\xa4n) and swap the elements at positions i and j.After that, the binary search is performed. At the beginning of the algorithm, two variables l=1 and r=n+1 are declared. Then the following loop is executed:  If r\xe2\x88\x92l=1, end the loop  m=\xe2\x8c\x8ar+l2\xe2\x8c\x8b  If pm\xe2\x89\xa4x, assign l=m, otherwise r=m. The goal is to rearrange the numbers in the permutation before the algorithm so that after the algorithm is executed, pl is equal to x. It can be shown that 2 operations are always sufficient." "binary search,constructive algorithms,greedy" 1700
509C "Sums of Digits" "Vasya had a strictly increasing sequence of positive integers a1, ..., an. Vasya used it to build a new sequence b1, ..., bn, where bi is the sum of digits of ai\'s decimal representation. Then sequence ai got lost and all that remained is sequence bi.Vasya wonders what the numbers ai could be like. Of all the possible options he likes the one sequence with the minimum possible last number an. Help Vasya restore the initial sequence.It is guaranteed that such a sequence always exists." dp,greedy,implementation 2000
986E "Prince\'s Problem" "Let the main characters of this problem be personages from some recent movie. New Avengers seem to make a lot of buzz. I didn\'t watch any part of the franchise and don\'t know its heroes well, but it won\'t stop me from using them in this problem statement. So, Thanos and Dr. Strange are doing their superhero and supervillain stuff, but then suddenly they stumble across a regular competitive programming problem.You are given a tree with n vertices.In each vertex v there is positive integer av.You have to answer q queries.Each query has a from u v x.You have to calculate \xe2\x88\x8fw\xe2\x88\x88Pgcd(x,aw)mod(109+7), where P is a set of vertices on path from u to v. In other words, you are to calculate the product of gcd(x,aw) for all vertices w on the path from u to v. As it might be large, compute it modulo 109+7. Here gcd(s,t) denotes the greatest common divisor of s and t.Note that the numbers in vertices do not change after queries.I suppose that you are more interested in superhero business of Thanos and Dr. Strange than in them solving the problem. So you are invited to solve this problem instead of them." "brute force,data structures,math,number theory,trees" 2800
1073C "Vasya and Robot" "Vasya has got a robot which is situated on an infinite Cartesian plane, initially in the cell (0,0). Robot can perform the following four kinds of operations:   U \xe2\x80\x94 move from (x,y) to (x,y+1);  D \xe2\x80\x94 move from (x,y) to (x,y\xe2\x88\x921);  L \xe2\x80\x94 move from (x,y) to (x\xe2\x88\x921,y);  R \xe2\x80\x94 move from (x,y) to (x+1,y). Vasya also has got a sequence of n operations. Vasya wants to modify this sequence so after performing it the robot will end up in (x,y).Vasya wants to change the sequence so the length of changed subsegment is minimum possible. This length can be calculated as follows: maxID\xe2\x88\x92minID+1, where maxID is the maximum index of a changed operation, and minID is the minimum index of a changed operation. For example, if Vasya changes RRRRRRR to RLRRLRL, then the operations with indices 2, 5 and 7 are changed, so the length of changed subsegment is 7\xe2\x88\x922+1=6. Another example: if Vasya changes DDDD to DDRD, then the length of changed subsegment is 1. If there are no changes, then the length of changed subsegment is 0. Changing an operation means replacing it with some operation (possibly the same); Vasya can\'t insert new operations into the sequence or remove them.Help Vasya! Tell him the minimum length of subsegment that he needs to change so that the robot will go from (0,0) to (x,y), or tell him that it\'s impossible." "binary search,two pointers" 1800
840A "Leha and Function" "Leha like all kinds of strange things. Recently he liked the function F(n,\xe2\x80\x89k). Consider all possible k-element subsets of the set [1,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89n]. For subset find minimal element in it. F(n,\xe2\x80\x89k) \xe2\x80\x94 mathematical expectation of the minimal element among all k-element subsets.But only function does not interest him. He wants to do interesting things with it. Mom brought him two arrays A and B, each consists of m integers. For all i,\xe2\x80\x89j such that 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i,\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m the condition Ai\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89Bj holds. Help Leha rearrange the numbers in the array A so that the sum  is maximally possible, where A\' is already rearranged array." "combinatorics,greedy,math,number theory,sortings" 1300
1367E "Necklace Assembly" "The store sells n beads. The color of each bead is described by a lowercase letter of the English alphabet (""a""\xe2\x80\x93""z""). You want to buy some beads to assemble a necklace from them.A necklace is a set of beads connected in a circle.For example, if the store sells beads ""a"", ""b"", ""c"", ""a"", ""c"", ""c"", then you can assemble the following necklaces (these are not all possible options):  And the following necklaces cannot be assembled from beads sold in the store:  The first necklace cannot be assembled because it has three beads ""a"" (of the two available). The second necklace cannot be assembled because it contains a bead ""d"", which is not sold in the store. We call a necklace k-beautiful if, when it is turned clockwise by k beads, the necklace remains unchanged. For example, here is a sequence of three turns of a necklace.    As you can see, this necklace is, for example, 3-beautiful, 6-beautiful, 9-beautiful, and so on, but it is not 1-beautiful or 2-beautiful.In particular, a necklace of length 1 is k-beautiful for any integer k. A necklace that consists of beads of the same color is also beautiful for any k.You are given the integers n and k, and also the string s containing n lowercase letters of the English alphabet \xe2\x80\x94 each letter defines a bead in the store. You can buy any subset of beads and connect them in any order. Find the maximum length of a k-beautiful necklace you can assemble." "brute force,dfs and similar,dp,graphs,greedy,number theory" 1900
1918F "Caterpillar on a Tree" "The caterpillar decided to visit every node of the tree. Initially, it is sitting at the root.The tree is represented as a rooted tree with the root at the node 1. Each crawl to a neighboring node takes 1 minute for the caterpillar. And there is a trampoline under the tree. If the caterpillar detaches from the tree and falls onto the trampoline, it will end up at the root of the tree in 0 seconds. But the trampoline is old and can withstand no more than k caterpillar\'s falls.What is the minimum time the caterpillar can take to visit all the nodes of the tree?More formally, we need to find the minimum time required to visit all the nodes of the tree, if the caterpillar starts at the root (node 1) and moves using two methods.   Crawl along an edge to one of the neighboring nodes: takes 1 minute.   Teleport to the root: takes no time,  no new nodes become visited. The second method (teleportation) can be used at most k times. The caterpillar can finish the journey at any node." "dfs and similar,graphs,greedy,implementation,sortings,trees" 2500
1637F Towers "You are given a tree with n vertices numbered from 1 to n. The height of the i-th vertex is hi. You can place any number of towers into vertices, for each tower you can choose which vertex to put it in, as well as choose its efficiency. Setting up a tower with efficiency e costs e coins, where e>0.It is considered that a vertex x gets a signal if for some pair of towers at the vertices u and v (u\xe2\x89\xa0v, but it is allowed that x=u or x=v) with efficiencies eu and ev, respectively, it is satisfied that min(eu,ev)\xe2\x89\xa5hx and x lies on the path between u and v.Find the minimum number of coins required to set up towers so that you can get a signal at all vertices." "constructive algorithms,dfs and similar,dp,greedy,trees" 2500
1130B "Two Cakes" "Sasha and Dima want to buy two n-tier cakes. Each cake should consist of n different tiers: from the size of 1 to the size of n. Tiers should go in order from the smallest to the biggest (from top to bottom).They live on the same street, there are 2\xe2\x8b\x85n houses in a row from left to right. Each house has a pastry shop where you can buy a cake tier. Unfortunately, in each pastry shop you can buy only one tier of only one specific size: in the i-th house you can buy a tier of the size ai (1\xe2\x89\xa4ai\xe2\x89\xa4n).Since the guys carry already purchased tiers, and it is impossible to insert a new tier in the middle of the cake, they agreed to buy tiers from the smallest to the biggest. That is, each of them buys tiers in order: 1, then 2, then 3 and so on up to n.Initially, Sasha and Dima are located near the first (leftmost) house. Output the minimum distance that they will have to walk in total to buy both cakes. The distance between any two neighboring houses is exactly 1." greedy 1200
610E "Alphabet Permutations" "You are given a string s of length n, consisting of first k lowercase English letters.We define a c-repeat of some string q as a string, consisting of c copies of the string q. For example, string ""acbacbacbacb"" is a 4-repeat of the string ""acb"".Let\'s say that string a contains string b as a subsequence, if string b can be obtained from a by erasing some symbols.Let p be a string that represents some permutation of the first k lowercase English letters. We define function d(p) as the smallest integer such that a d(p)-repeat of the string p contains string s as a subsequence.There are m operations of one of two types that can be applied to string s:  Replace all characters at positions from li to ri by a character ci.  For the given p, that is a permutation of first k lowercase English letters, find the value of function d(p). All operations are performed sequentially, in the order they appear in the input. Your task is to determine the values of function d(p) for all operations of the second type." "data structures,strings" 2500
1789C "Serval and Toxel\'s Arrays" "Toxel likes arrays. Before traveling to the Paldea region, Serval gave him an array a as a gift. This array has n pairwise distinct elements.In order to get more arrays, Toxel performed m operations with the initial array. In the i-th operation, he modified the pi-th element of the (i\xe2\x88\x921)-th array to vi, resulting in the i-th array (the initial array a is numbered as 0). During modifications, Toxel guaranteed that the elements of each array are still pairwise distinct after each operation.Finally, Toxel got m+1 arrays and denoted them as A0=a,A1,\xe2\x80\xa6,Am. For each pair (i,j) (0\xe2\x89\xa4i<j\xe2\x89\xa4m), Toxel defines its value as the number of distinct elements of the concatenation of Ai and Aj. Now Toxel wonders, what is the sum of the values of all pairs? Please help him to calculate the answer." combinatorics,dp,implementation,math 1500
553A "Kyoya and Colored Balls" "Kyoya Ootori has a bag with n colored balls that are colored with k different colors. The colors are labeled from 1 to k. Balls of the same color are indistinguishable. He draws balls from the bag one by one until the bag is empty. He noticed that he drew the last ball of color i before drawing the last ball of color i\xe2\x80\x89+\xe2\x80\x891 for all i from 1 to k\xe2\x80\x89-\xe2\x80\x891. Now he wonders how many different ways this can happen." combinatorics,dp,math 1500
1534C "Little Alawn\'s Puzzle" "When he\'s not training for IOI, Little Alawn enjoys playing with puzzles of various types to stimulate his brain. Today, he\'s playing with a puzzle that consists of a 2\xc3\x97n grid where each row is a permutation of the numbers 1,2,3,\xe2\x80\xa6,n.The goal of Little Alawn\'s puzzle is to make sure no numbers on the same column or row are the same (we\'ll call this state of the puzzle as solved), and to achieve this he is able to swap the numbers in any column. However, after solving the puzzle many times, Little Alawn got bored and began wondering about the number of possible solved configurations of the puzzle he could achieve from an initial solved configuration only by swapping numbers in a column.Unfortunately, Little Alawn got stuck while trying to solve this harder problem, so he was wondering if you could help him with it. Find the answer modulo 109+7." combinatorics,dp,dsu,graphs,math 1300
1488F Dogecoin "Recently, cryptocurrencies have become increasingly popular. Ann decided that it was about time she started mining the Dogecoin cryptocurrency. Ann\'s computer is not very powerful, so Ann mines exactly 1 Dogecoin per day. On the Internet, there are forecasts of the cost of 1 dogecoin for the next n days. Every day, Ann can sell any amount of dogecoin that she currently has. Note that if Ann mined Dogecoin on the i-th day, then she can sell it on the same day.Ann has not yet decided when to start mining. She has prepared q possible plans and for each of them wants to know the maximum profit that she can get. Each of the plans is described by two numbers l and r \xe2\x80\x94 the first and last days of mining. Note that Ann should not have any Dogecoin left after the r-th day." "*special problem,*special problem,binary search,data structures" 2300
1187B "Letters Shop" "The letters shop showcase is a string s, consisting of n lowercase Latin letters. As the name tells, letters are sold in the shop.Letters are sold one by one from the leftmost to the rightmost. Any customer can only buy some prefix of letters from the string s.There are m friends, the i-th of them is named ti. Each of them is planning to estimate the following value: how many letters (the length of the shortest prefix) would s/he need to buy if s/he wanted to construct her/his name of bought letters. The name can be constructed if each letter is presented in the equal or greater amount.  For example, for s=""arrayhead"" and ti=""arya"" 5 letters have to be bought (""arrayhead"").  For example, for s=""arrayhead"" and ti=""harry"" 6 letters have to be bought (""arrayhead"").  For example, for s=""arrayhead"" and ti=""ray"" 5 letters have to be bought (""arrayhead"").  For example, for s=""arrayhead"" and ti=""r"" 2 letters have to be bought (""arrayhead"").  For example, for s=""arrayhead"" and ti=""areahydra"" all 9 letters have to be bought (""arrayhead""). It is guaranteed that every friend can construct her/his name using the letters from the string s.Note that the values for friends are independent, friends are only estimating them but not actually buying the letters." "binary search,implementation,strings" 1300
1945A "Setting up Camp" "The organizing committee plans to take the participants of the Olympiad on a hike after the tour. Currently, the number of tents needed to be taken is being calculated. It is known that each tent can accommodate up to 3 people.Among the participants, there are a introverts, b extroverts, and c universals:  Each introvert wants to live in a tent alone. Thus, a tent with an introvert must contain exactly one person \xe2\x80\x94 only the introvert himself.  Each extrovert wants to live in a tent with two others. Thus, the tent with an extrovert must contain exactly three people.  Each universal is fine with any option (living alone, with one other person, or with two others). The organizing committee respects the wishes of each participant very much, so they want to fulfill all of them.Tell us the minimum number of tents needed to be taken so that all participants can be accommodated according to their preferences. If it is impossible to accommodate the participants in a way that fulfills all the wishes, output \xe2\x88\x921." greedy,math 800
396E "On Iteration of One Well-Known Function" "Of course, many of you can calculate \xcf\x86(n) \xe2\x80\x94 the number of positive integers that are less than or equal to n, that are coprime with n. But what if we need to calculate \xcf\x86(\xcf\x86(...\xcf\x86(n))), where function \xcf\x86 is taken k times and n is given in the canonical decomposition into prime factors? You are given n and k, calculate the value of \xcf\x86(\xcf\x86(...\xcf\x86(n))). Print the result in the canonical decomposition into prime factors." math -999
1194C "From S To T" "You are given three strings s, t and p consisting of lowercase Latin letters. You may perform any number (possibly, zero) operations on these strings.During each operation you choose any character from p, erase it from p and insert it into string s (you may insert this character anywhere you want: in the beginning of s, in the end or between any two consecutive characters). For example, if p is aba, and s is de, then the following outcomes are possible (the character we erase from p and insert into s is highlighted):  aba \xe2\x86\x92 ba, de \xe2\x86\x92 ade;  aba \xe2\x86\x92 ba, de \xe2\x86\x92 dae;  aba \xe2\x86\x92 ba, de \xe2\x86\x92 dea;  aba \xe2\x86\x92 aa, de \xe2\x86\x92 bde;  aba \xe2\x86\x92 aa, de \xe2\x86\x92 dbe;  aba \xe2\x86\x92 aa, de \xe2\x86\x92 deb;  aba \xe2\x86\x92 ab, de \xe2\x86\x92 ade;  aba \xe2\x86\x92 ab, de \xe2\x86\x92 dae;  aba \xe2\x86\x92 ab, de \xe2\x86\x92 dea; Your goal is to perform several (maybe zero) operations so that s becomes equal to t. Please determine whether it is possible.Note that you have to answer q independent queries." implementation,strings 1300
1030C "Vasya and Golden Ticket" "Recently Vasya found a golden ticket \xe2\x80\x94 a sequence which consists of n digits a1a2\xe2\x80\xa6an. Vasya considers a ticket to be lucky if it can be divided into two or more non-intersecting segments with equal sums. For example, ticket 350178 is lucky since it can be divided into three segments 350, 17 and 8: 3+5+0=1+7=8. Note that each digit of sequence should belong to exactly one segment.Help Vasya! Tell him if the golden ticket he found is lucky or not." implementation 1300
1500A "Going Home" "It was the third month of remote learning, Nastya got sick of staying at dormitory, so she decided to return to her hometown. In order to make her trip more entertaining, one of Nastya\'s friend presented her an integer array a. Several hours after starting her journey home Nastya remembered about the present. To entertain herself she decided to check, are there four different indices x,y,z,w such that ax+ay=az+aw.Her train has already arrived the destination, but she still hasn\'t found the answer. Can you help her unravel the mystery?" "brute force,hashing,implementation,math" 1800
161C Abracadabra "Polycarpus analyzes a string called abracadabra. This string is constructed using the following algorithm:   On the first step the string consists of a single character ""a"".  On the k-th step Polycarpus concatenates two copies of the string obtained on the (k\xe2\x80\x89-\xe2\x80\x891)-th step, while inserting the k-th character of the alphabet between them. Polycarpus uses the alphabet that consists of lowercase Latin letters and digits (a total of 36 characters). The alphabet characters are numbered like this: the 1-st character is ""a"", the 2-nd \xe2\x80\x94 ""b"", ..., the 26-th \xe2\x80\x94 ""z"", the 27-th \xe2\x80\x94 ""0"", the 28-th \xe2\x80\x94 ""1"", ..., the 36-th \xe2\x80\x94 ""9"". Let\'s have a closer look at the algorithm. On the second step Polycarpus will concatenate two strings ""a"" and insert the character ""b"" between them, resulting in ""aba"" string. The third step will transform it into ""abacaba"", and the fourth one - into ""abacabadabacaba"". Thus, the string constructed on the k-th step will consist of 2k\xe2\x80\x89-\xe2\x80\x891 characters. Polycarpus wrote down the string he got after 30 steps of the given algorithm and chose two non-empty substrings of it. Your task is to find the length of the longest common substring of the two substrings selected by Polycarpus.A substring s[i... j] (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|s|) of string s = s1s2... s|s| is a string sisi\xe2\x80\x89+\xe2\x80\x891... sj. For example, substring s[2...4] of string s = ""abacaba"" equals ""bac"". The string is its own substring.The longest common substring of two strings s and t is the longest string that is a substring of both s and t. For example, the longest common substring of ""contest"" and ""systemtesting"" is string ""test"". There can be several common substrings of maximum length." "divide and conquer" 2400
649E \xd0\x90\xd0\xb2\xd1\x82\xd0\xbe\xd0\xb1\xd1\x83\xd1\x81 "\xd0\x92\xd0\xb4\xd0\xbe\xd0\xbb\xd1\x8c \xd0\xb4\xd0\xbe\xd1\x80\xd0\xbe\xd0\xb3\xd0\xb8 \xd1\x81\xd1\x82\xd0\xbe\xd1\x8f\xd1\x82 n \xd0\xbf\xd1\x83\xd1\x82\xd0\xb5\xd1\x88\xd0\xb5\xd1\x81\xd1\x82\xd0\xb2\xd0\xb5\xd0\xbd\xd0\xbd\xd0\xb8\xd0\xba\xd0\xbe\xd0\xb2. \xd0\x94\xd0\xbe\xd1\x80\xd0\xbe\xd0\xb3\xd0\xb0 \xd0\xbf\xd1\x80\xd0\xb5\xd0\xb4\xd1\x81\xd1\x82\xd0\xb0\xd0\xb2\xd0\xbb\xd1\x8f\xd0\xb5\xd1\x82 \xd1\x81\xd0\xbe\xd0\xb1\xd0\xbe\xd0\xb9 \xd0\xbf\xd1\x80\xd1\x8f\xd0\xbc\xd1\x83\xd1\x8e, \xd1\x80\xd0\xb0\xd0\xb7\xd0\xbc\xd0\xb5\xd1\x80\xd0\xb0\xd0\xbc\xd0\xb8 \xd0\xbf\xd1\x83\xd1\x82\xd0\xb5\xd1\x88\xd0\xb5\xd1\x81\xd1\x82\xd0\xb2\xd0\xb5\xd0\xbd\xd0\xbd\xd0\xb8\xd0\xba\xd0\xbe\xd0\xb2 \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xbd\xd0\xbe \xd0\xbf\xd1\x80\xd0\xb5\xd0\xbd\xd0\xb5\xd0\xb1\xd1\x80\xd0\xb5\xd1\x87\xd1\x8c, \xd1\x81\xd1\x87\xd0\xb8\xd1\x82\xd0\xb0\xd1\x8f \xd0\xb8\xd1\x85 \xd1\x82\xd0\xbe\xd1\x87\xd0\xba\xd0\xb0\xd0\xbc\xd0\xb8.\xd0\x92\xd0\xbe\xd0\xb4\xd0\xb8\xd1\x82\xd0\xb5\xd0\xbb\xd1\x8c \xd0\xb0\xd0\xb2\xd1\x82\xd0\xbe\xd0\xb1\xd1\x83\xd1\x81\xd0\xb0 \xd0\x92\xd0\xb0\xd1\x81\xd0\xb8\xd0\xbb\xd0\xb8\xd0\xb9, \xd0\xb1\xd0\xbb\xd0\xb0\xd0\xb3\xd0\xbe\xd0\xb4\xd0\xb0\xd1\x80\xd1\x8f \xd0\xbc\xd0\xbe\xd0\xb1\xd0\xb8\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe\xd0\xbc\xd1\x83 \xd0\xbf\xd1\x80\xd0\xb8\xd0\xbb\xd0\xbe\xd0\xb6\xd0\xb5\xd0\xbd\xd0\xb8\xd1\x8e, \xd0\xb7\xd0\xbd\xd0\xb0\xd0\xb5\xd1\x82 \xd0\xb4\xd0\xbb\xd1\x8f \xd0\xba\xd0\xb0\xd0\xb6\xd0\xb4\xd0\xbe\xd0\xb3\xd0\xbe \xd0\xbf\xd1\x83\xd1\x82\xd0\xb5\xd1\x88\xd0\xb5\xd1\x81\xd1\x82\xd0\xb2\xd0\xb5\xd0\xbd\xd0\xbd\xd0\xb8\xd0\xba\xd0\xb0 \xd1\x82\xd0\xbe\xd1\x87\xd0\xba\xd1\x83 xi, \xd0\xb2 \xd0\xba\xd0\xbe\xd1\x82\xd0\xbe\xd1\x80\xd0\xbe\xd0\xb9 \xd1\x82\xd0\xbe\xd1\x82 \xd1\x81\xd1\x82\xd0\xbe\xd0\xb8\xd1\x82. \xd0\x9a\xd1\x80\xd0\xbe\xd0\xbc\xd0\xb5 \xd1\x82\xd0\xbe\xd0\xb3\xd0\xbe, \xd0\xbe\xd0\xbd \xd0\xb7\xd0\xbd\xd0\xb0\xd0\xb5\xd1\x82 \xd1\x80\xd0\xb0\xd1\x81\xd1\x81\xd1\x82\xd0\xbe\xd1\x8f\xd0\xbd\xd0\xb8\xd0\xb5 di, \xd0\xba\xd0\xbe\xd1\x82\xd0\xbe\xd1\x80\xd0\xbe\xd0\xb5 i-\xd0\xb9 \xd0\xbf\xd1\x83\xd1\x82\xd0\xb5\xd1\x88\xd0\xb5\xd1\x81\xd1\x82\xd0\xb2\xd0\xb5\xd0\xbd\xd0\xbd\xd0\xb8\xd0\xba \xd1\x85\xd0\xbe\xd1\x87\xd0\xb5\xd1\x82 \xd0\xbf\xd1\x80\xd0\xbe\xd0\xb5\xd1\x85\xd0\xb0\xd1\x82\xd1\x8c \xd0\xbd\xd0\xb0 \xd0\xb0\xd0\xb2\xd1\x82\xd0\xbe\xd0\xb1\xd1\x83\xd1\x81\xd0\xb5. \xd0\xa2\xd0\xb0\xd0\xba\xd0\xb8\xd0\xbc \xd0\xbe\xd0\xb1\xd1\x80\xd0\xb0\xd0\xb7\xd0\xbe\xd0\xbc, i-\xd0\xb9 \xd0\xbf\xd1\x83\xd1\x82\xd0\xb5\xd1\x88\xd0\xb5\xd1\x81\xd1\x82\xd0\xb2\xd0\xb5\xd0\xbd\xd0\xbd\xd0\xb8\xd0\xba \xd0\xbf\xd0\xbb\xd0\xb0\xd0\xbd\xd0\xb8\xd1\x80\xd1\x83\xd0\xb5\xd1\x82 \xd0\xb2\xd1\x8b\xd0\xb9\xd1\x82\xd0\xb8 \xd0\xb8\xd0\xb7 \xd0\xb0\xd0\xb2\xd1\x82\xd0\xbe\xd0\xb1\xd1\x83\xd1\x81\xd0\xb0 \xd0\xb2 \xd1\x82\xd0\xbe\xd1\x87\xd0\xba\xd0\xb5 xi\xe2\x80\x89+\xe2\x80\x89di. \xd0\xa2\xd0\xb5\xd0\xbf\xd0\xb5\xd1\x80\xd1\x8c \xd0\x92\xd0\xb0\xd1\x81\xd0\xb8\xd0\xbb\xd0\xb8\xd0\xb9 \xd1\x85\xd0\xbe\xd1\x87\xd0\xb5\xd1\x82 \xd1\x80\xd0\xb5\xd1\x88\xd0\xb8\xd1\x82\xd1\x8c, \xd0\xba\xd0\xbe\xd0\xb3\xd0\xbe \xd0\xb8\xd0\xb7 \xd0\xbf\xd1\x83\xd1\x82\xd0\xb5\xd1\x88\xd0\xb5\xd1\x81\xd1\x82\xd0\xb2\xd0\xb5\xd0\xbd\xd0\xbd\xd0\xb8\xd0\xba\xd0\xbe\xd0\xb2 \xd0\xbe\xd0\xbd \xd0\xbf\xd0\xbe\xd0\xb4\xd0\xb2\xd0\xb5\xd0\xb7\xd1\x91\xd1\x82, \xd0\xb0 \xd0\xba\xd0\xbe\xd0\xb3\xd0\xbe \xd0\xbe\xd1\x81\xd1\x82\xd0\xb0\xd0\xb2\xd0\xb8\xd1\x82 \xd0\xbf\xd1\x8b\xd0\xbb\xd0\xb8\xd1\x82\xd1\x8c\xd1\x81\xd1\x8f \xd1\x83 \xd0\xb4\xd0\xbe\xd1\x80\xd0\xbe\xd0\xb3\xd0\xb8.\xd0\x92\xd0\xb0\xd1\x81\xd0\xb8\xd0\xbb\xd0\xb8\xd0\xb9 \xd1\x80\xd0\xb5\xd1\x88\xd0\xb8\xd0\xbb, \xd1\x87\xd1\x82\xd0\xbe \xd1\x81\xd0\xb5\xd0\xb3\xd0\xbe\xd0\xb4\xd0\xbd\xd1\x8f \xd0\xbe\xd0\xbd \xd0\xb4\xd0\xbe\xd0\xbb\xd0\xb6\xd0\xb5\xd0\xbd \xd1\x85\xd0\xbe\xd1\x80\xd0\xbe\xd1\x88\xd0\xbe \xd0\xb7\xd0\xb0\xd1\x80\xd0\xb0\xd0\xb1\xd0\xbe\xd1\x82\xd0\xb0\xd1\x82\xd1\x8c, \xd0\xbf\xd0\xbe\xd1\x8d\xd1\x82\xd0\xbe\xd0\xbc\xd1\x83 \xd1\x80\xd0\xb5\xd1\x88\xd0\xb8\xd0\xbb \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb5\xd0\xb2\xd0\xb5\xd0\xb7\xd1\x82\xd0\xb8 \xd0\xb2 \xd1\x82\xd0\xbe\xd1\x87\xd0\xbd\xd0\xbe\xd1\x81\xd1\x82\xd0\xb8 a \xd0\xbf\xd1\x83\xd1\x82\xd0\xb5\xd1\x88\xd0\xb5\xd1\x81\xd1\x82\xd0\xb2\xd0\xb5\xd0\xbd\xd0\xbd\xd0\xb8\xd0\xba\xd0\xbe\xd0\xb2. \xd0\x92 \xd0\xb0\xd0\xb2\xd1\x82\xd0\xbe\xd0\xbf\xd0\xb0\xd1\x80\xd0\xba\xd0\xb5 \xd0\xb5\xd1\x81\xd1\x82\xd1\x8c \xd0\xb0\xd0\xb2\xd1\x82\xd0\xbe\xd0\xb1\xd1\x83\xd1\x81\xd1\x8b \xd0\xbb\xd1\x8e\xd0\xb1\xd1\x8b\xd1\x85 \xd0\xb2\xd0\xb8\xd0\xb4\xd0\xbe\xd0\xb2. \xd0\xa7\xd0\xb5\xd0\xbc \xd0\xb1\xd0\xbe\xd0\xbb\xd1\x8c\xd1\x88\xd0\xb5 \xd0\xbc\xd0\xb5\xd1\x81\xd1\x82 \xd0\xb2 \xd0\xb0\xd0\xb2\xd1\x82\xd0\xbe\xd0\xb1\xd1\x83\xd1\x81\xd0\xb5, \xd1\x82\xd0\xb5\xd0\xbc \xd0\xb4\xd0\xbe\xd1\x80\xd0\xbe\xd0\xb6\xd0\xb5 \xd1\x81\xd1\x82\xd0\xbe\xd0\xb8\xd1\x82 \xd0\xb5\xd0\xb3\xd0\xbe \xd0\xb0\xd1\x80\xd0\xb5\xd0\xbd\xd0\xb4\xd0\xb0.\xd0\x9f\xd0\xbe\xd0\xbc\xd0\xbe\xd0\xb3\xd0\xb8\xd1\x82\xd0\xb5 \xd0\x92\xd0\xb0\xd1\x81\xd0\xb8\xd0\xbb\xd0\xb8\xd1\x8e \xd0\xbe\xd0\xbf\xd1\x80\xd0\xb5\xd0\xb4\xd0\xb5\xd0\xbb\xd0\xb8\xd1\x82\xd1\x8c \xd0\xbc\xd0\xb8\xd0\xbd\xd0\xb8\xd0\xbc\xd0\xb0\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe\xd0\xb5 \xd0\xba\xd0\xbe\xd0\xbb\xd0\xb8\xd1\x87\xd0\xb5\xd1\x81\xd1\x82\xd0\xb2\xd0\xbe \xd0\xbf\xd0\xb0\xd1\x81\xd1\x81\xd0\xb0\xd0\xb6\xd0\xb8\xd1\x80\xd1\x81\xd0\xba\xd0\xb8\xd1\x85 \xd0\xbc\xd0\xb5\xd1\x81\xd1\x82 \xd0\xb2 \xd0\xb0\xd0\xb2\xd1\x82\xd0\xbe\xd0\xb1\xd1\x83\xd1\x81\xd0\xb5, \xd0\xba\xd0\xbe\xd1\x82\xd0\xbe\xd1\x80\xd1\x8b\xd1\x85 \xd0\xb1\xd1\x83\xd0\xb4\xd0\xb5\xd1\x82 \xd0\xb4\xd0\xbe\xd1\x81\xd1\x82\xd0\xb0\xd1\x82\xd0\xbe\xd1\x87\xd0\xbd\xd0\xbe \xd0\xb4\xd0\xbb\xd1\x8f \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb5\xd0\xb2\xd0\xbe\xd0\xb7\xd0\xba\xd0\xb8 \xd1\x80\xd0\xbe\xd0\xb2\xd0\xbd\xd0\xbe a \xd0\xbf\xd1\x83\xd1\x82\xd0\xb5\xd1\x88\xd0\xb5\xd1\x81\xd1\x82\xd0\xb2\xd0\xb5\xd0\xbd\xd0\xbd\xd0\xb8\xd0\xba\xd0\xbe\xd0\xb2. \xd0\x9d\xd0\xb8 \xd0\xb2 \xd0\xba\xd0\xb0\xd0\xba\xd0\xbe\xd0\xb9 \xd0\xbc\xd0\xbe\xd0\xbc\xd0\xb5\xd0\xbd\xd1\x82 \xd0\xb2\xd1\x80\xd0\xb5\xd0\xbc\xd0\xb5\xd0\xbd\xd0\xb8 \xd0\xb2 \xd0\xb0\xd0\xb2\xd1\x82\xd0\xbe\xd0\xb1\xd1\x83\xd1\x81\xd0\xb5 \xd0\xbd\xd0\xb5 \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xb5\xd1\x82 \xd0\xb1\xd1\x8b\xd1\x82\xd1\x8c \xd0\xbf\xd1\x83\xd1\x82\xd0\xb5\xd1\x88\xd0\xb5\xd1\x81\xd1\x82\xd0\xb2\xd0\xb5\xd0\xbd\xd0\xbd\xd0\xb8\xd0\xba\xd0\xbe\xd0\xb2 \xd0\xb1\xd0\xbe\xd0\xbb\xd1\x8c\xd1\x88\xd0\xb5, \xd1\x87\xd0\xb5\xd0\xbc \xd0\xba\xd0\xbe\xd0\xbb\xd0\xb8\xd1\x87\xd0\xb5\xd1\x81\xd1\x82\xd0\xb2\xd0\xbe \xd0\xbf\xd0\xb0\xd1\x81\xd1\x81\xd0\xb0\xd0\xb6\xd0\xb8\xd1\x80\xd1\x81\xd0\xba\xd0\xb8\xd1\x85 \xd0\xbc\xd0\xb5\xd1\x81\xd1\x82 \xd0\xb2 \xd0\xb0\xd0\xb2\xd1\x82\xd0\xbe\xd0\xb1\xd1\x83\xd1\x81\xd0\xb5. \xd0\x92\xd0\xb0\xd1\x81\xd0\xb8\xd0\xbb\xd0\xb8\xd0\xb9 \xd1\x81\xd0\xb0\xd0\xbc \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xb5\xd1\x82 \xd1\x80\xd0\xb5\xd1\x88\xd0\xb8\xd1\x82\xd1\x8c \xd0\xba\xd0\xb0\xd0\xba\xd0\xbe\xd0\xb5 \xd0\xba\xd0\xbe\xd0\xbd\xd0\xba\xd1\x80\xd0\xb5\xd1\x82\xd0\xbd\xd0\xbe \xd0\xbf\xd0\xbe\xd0\xb4\xd0\xbc\xd0\xbd\xd0\xbe\xd0\xb6\xd0\xb5\xd1\x81\xd1\x82\xd0\xb2\xd0\xbe \xd0\xb8\xd0\xb7 a \xd0\xbf\xd1\x83\xd1\x82\xd0\xb5\xd1\x88\xd0\xb5\xd1\x81\xd1\x82\xd0\xb2\xd0\xb5\xd0\xbd\xd0\xbd\xd0\xb8\xd0\xba\xd0\xbe\xd0\xb2 \xd0\xbe\xd0\xbd \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb5\xd0\xb2\xd0\xb5\xd0\xb7\xd1\x91\xd1\x82 \xd0\xbd\xd0\xb0 \xd0\xb0\xd0\xb2\xd1\x82\xd0\xbe\xd0\xb1\xd1\x83\xd1\x81\xd0\xb5.\xd0\xa1\xd1\x87\xd0\xb8\xd1\x82\xd0\xb0\xd0\xb9\xd1\x82\xd0\xb5, \xd1\x87\xd1\x82\xd0\xbe \xd0\xb0\xd0\xb2\xd1\x82\xd0\xbe\xd0\xb1\xd1\x83\xd1\x81 \xd0\xb2\xd1\x81\xd0\xb5\xd0\xb3\xd0\xb4\xd0\xb0 \xd0\xb5\xd0\xb4\xd0\xb5\xd1\x82 \xd1\x81\xd0\xbb\xd0\xb5\xd0\xb2\xd0\xb0 \xd0\xbd\xd0\xb0\xd0\xbf\xd1\x80\xd0\xb0\xd0\xb2\xd0\xbe (\xd0\xbe\xd1\x82 \xd0\xbc\xd0\xb5\xd0\xbd\xd1\x8c\xd1\x88\xd0\xb8\xd1\x85 \xd0\xba\xd0\xbe\xd0\xbe\xd1\x80\xd0\xb4\xd0\xb8\xd0\xbd\xd0\xb0\xd1\x82 \xd0\xba \xd0\xb1\xd0\xbe\xd0\xbb\xd1\x8c\xd1\x88\xd0\xb8\xd0\xbc) \xd0\xb8 \xd0\xbd\xd0\xb0\xd1\x87\xd0\xb8\xd0\xbd\xd0\xb0\xd0\xb5\xd1\x82 \xd1\x81\xd0\xb2\xd0\xbe\xd0\xb9 \xd0\xbf\xd1\x83\xd1\x82\xd1\x8c \xd0\xbb\xd0\xb5\xd0\xb2\xd0\xb5\xd0\xb5 \xd1\x81\xd0\xb0\xd0\xbc\xd0\xbe\xd0\xb3\xd0\xbe \xd0\xbb\xd0\xb5\xd0\xb2\xd0\xbe\xd1\x81\xd1\x82\xd0\xbe\xd1\x8f\xd1\x89\xd0\xb5\xd0\xb3\xd0\xbe \xd0\xbf\xd1\x83\xd1\x82\xd0\xb5\xd1\x88\xd0\xb5\xd1\x81\xd1\x82\xd0\xb2\xd0\xb5\xd0\xbd\xd0\xbd\xd0\xb8\xd0\xba\xd0\xb0. \xd0\x95\xd1\x81\xd0\xbb\xd0\xb8 \xd0\xb2 \xd0\xbe\xd0\xb4\xd0\xbd\xd0\xbe\xd0\xb9 \xd1\x82\xd0\xbe\xd1\x87\xd0\xba\xd0\xb5 \xd0\xba\xd0\xb0\xd0\xba\xd0\xbe\xd0\xb9-\xd1\x82\xd0\xbe \xd0\xbf\xd1\x83\xd1\x82\xd0\xb5\xd1\x88\xd0\xb5\xd1\x81\xd1\x82\xd0\xb2\xd0\xb5\xd0\xbd\xd0\xbd\xd0\xb8\xd0\xba \xd0\xb4\xd0\xbe\xd0\xbb\xd0\xb6\xd0\xb5\xd0\xbd \xd0\xb2\xd1\x8b\xd0\xb9\xd1\x82\xd0\xb8 \xd0\xb8\xd0\xb7 \xd0\xb0\xd0\xb2\xd1\x82\xd0\xbe\xd0\xb1\xd1\x83\xd1\x81\xd0\xb0, \xd0\xb0 \xd0\xb4\xd1\x80\xd1\x83\xd0\xb3\xd0\xbe\xd0\xb9 \xd0\xb2\xd0\xbe\xd0\xb9\xd1\x82\xd0\xb8, \xd1\x81\xd1\x87\xd0\xb8\xd1\x82\xd0\xb0\xd0\xb9\xd1\x82\xd0\xb5, \xd1\x87\xd1\x82\xd0\xbe \xd1\x81\xd0\xbd\xd0\xb0\xd1\x87\xd0\xb0\xd0\xbb\xd0\xb0 \xd0\xbf\xd1\x80\xd0\xbe\xd0\xb8\xd0\xb7\xd0\xbe\xd0\xb9\xd0\xb4\xd0\xb5\xd1\x82 \xd0\xb2\xd1\x8b\xd1\x85\xd0\xbe\xd0\xb4 \xd0\xbe\xd0\xb4\xd0\xbd\xd0\xbe\xd0\xb3\xd0\xbe \xd0\xbf\xd1\x83\xd1\x82\xd0\xb5\xd1\x88\xd0\xb5\xd1\x81\xd1\x82\xd0\xb2\xd0\xb5\xd0\xbd\xd0\xbd\xd0\xb8\xd0\xba\xd0\xb0 \xd0\xb8\xd0\xb7 \xd0\xb0\xd0\xb2\xd1\x82\xd0\xbe\xd0\xb1\xd1\x83\xd1\x81\xd0\xb0, \xd0\xb0 \xd0\xb7\xd0\xb0\xd1\x82\xd0\xb5\xd0\xbc \xd0\xb4\xd1\x80\xd1\x83\xd0\xb3\xd0\xbe\xd0\xb9 \xd0\xbf\xd1\x83\xd1\x82\xd0\xb5\xd1\x88\xd0\xb5\xd1\x81\xd1\x82\xd0\xb2\xd0\xb5\xd0\xbd\xd0\xbd\xd0\xb8\xd0\xba \xd1\x81\xd0\xbc\xd0\xbe\xd0\xb6\xd0\xb5\xd1\x82 \xd0\xb7\xd0\xb0\xd0\xb9\xd1\x82\xd0\xb8 \xd0\xb2 \xd0\xb0\xd0\xb2\xd1\x82\xd0\xbe\xd0\xb1\xd1\x83\xd1\x81." "binary search,data structures,greedy,sortings" 2100
1660F2 "Promising String (hard version)" "This is the hard version of Problem F. The only difference between the easy version and the hard version is the constraints.We will call a non-empty string balanced if it contains the same number of plus and minus signs. For example: strings ""+--+"" and ""++-+--"" are balanced, and strings ""+--"", ""--"" and """" are not balanced.We will call a string promising if the string can be made balanced by several (possibly zero) uses of the following operation:  replace two adjacent minus signs with one plus sign. In particular, every balanced string is promising. However, the converse is not true: not every promising string is balanced.For example, the string ""-+---"" is promising, because you can replace two adjacent minuses with plus and get a balanced string ""-++-"", or get another balanced string ""-+-+"".How many non-empty substrings of the given string s are promising? Each non-empty promising substring must be counted in the answer as many times as it occurs in string s.Recall that a substring is a sequence of consecutive characters of the string. For example, for string ""+-+"" its substring are: ""+-"", ""-+"", ""+"", ""+-+"" (the string is a substring of itself) and some others. But the following strings are not its substring: ""--"", ""++"", ""-++""." "data structures,implementation,math,strings" 2100
672B "Different is Good" "A wise man told Kerem ""Different is good"" once, so Kerem wants all things in his life to be different. Kerem recently got a string s consisting of lowercase English letters. Since Kerem likes it when things are different, he wants all substrings of his string s to be distinct. Substring is a string formed by some number of consecutive characters of the string. For example, string ""aba"" has substrings """" (empty substring), ""a"", ""b"", ""a"", ""ab"", ""ba"", ""aba"".If string s has at least two equal substrings then Kerem will change characters at some positions to some other lowercase English letters. Changing characters is a very tiring job, so Kerem want to perform as few changes as possible.Your task is to find the minimum number of changes needed to make all the substrings of the given string distinct, or determine that it is impossible." "constructive algorithms,implementation,strings" 1000
774J "Stepan\'s Series" "Well, the series which Stepan watched for a very long time, ended. In total, the series had n episodes. For each of them, Stepan remembers either that he definitely has watched it, or that he definitely hasn\'t watched it, or he is unsure, has he watched this episode or not. Stepan\'s dissatisfaction is the maximum number of consecutive series that Stepan did not watch.Your task is to determine according to Stepan\'s memories if his dissatisfaction could be exactly equal to k." "*special problem,dp" 2000
713A "Sonya and Queries" "Today Sonya learned about long integers and invited all her friends to share the fun. Sonya has an initially empty multiset with integers. Friends give her t queries, each of one of the following type:  \xe2\x80\x89+\xe2\x80\x89 ai \xe2\x80\x94 add non-negative integer ai to the multiset. Note, that she has a multiset, thus there may be many occurrences of the same integer.  \xe2\x80\x89-\xe2\x80\x89 ai \xe2\x80\x94 delete a single occurrence of non-negative integer ai from the multiset. It\'s guaranteed, that there is at least one ai in the multiset.  ? s \xe2\x80\x94 count the number of integers in the multiset (with repetitions) that match some pattern s consisting of 0 and 1. In the pattern, 0 stands for the even digits, while 1 stands for the odd. Integer x matches the pattern s, if the parity of the i-th from the right digit in decimal notation matches the i-th from the right digit of the pattern. If the pattern is shorter than this integer, it\'s supplemented with 0-s from the left. Similarly, if the integer is shorter than the pattern its decimal notation is supplemented with the 0-s from the left. For example, if the pattern is s\xe2\x80\x89=\xe2\x80\x89010, than integers 92, 2212, 50 and 414 match the pattern, while integers 3, 110, 25 and 1030 do not." "data structures,implementation" 1400
250B "Restoring IPv6" "An IPv6-address is a 128-bit number. For convenience, this number is recorded in blocks of 16 bits in hexadecimal record, the blocks are separated by colons \xe2\x80\x94 8 blocks in total, each block has four hexadecimal digits. Here is an example of the correct record of a IPv6 address: ""0124:5678:90ab:cdef:0124:5678:90ab:cdef"". We\'ll call such format of recording an IPv6-address full.Besides the full record of an IPv6 address there is a short record format. The record of an IPv6 address can be shortened by removing one or more leading zeroes at the beginning of each block. However, each block should contain at least one digit in the short format. For example, the leading zeroes can be removed like that: ""a56f:00d3:0000:0124:0001:f19a:1000:0000"" \xe2\x80\x89\xe2\x86\x92\xe2\x80\x89 ""a56f:d3:0:0124:01:f19a:1000:00"". There are more ways to shorten zeroes in this IPv6 address.Some IPv6 addresses contain long sequences of zeroes. Continuous sequences of 16-bit zero blocks can be shortened to ""::"". A sequence can consist of one or several consecutive blocks, with all 16 bits equal to 0. You can see examples of zero block shortenings below:  ""a56f:00d3:0000:0124:0001:0000:0000:0000"" \xe2\x80\x89\xe2\x86\x92\xe2\x80\x89 ""a56f:00d3:0000:0124:0001::"";  ""a56f:0000:0000:0124:0001:0000:1234:0ff0"" \xe2\x80\x89\xe2\x86\x92\xe2\x80\x89 ""a56f::0124:0001:0000:1234:0ff0"";  ""a56f:0000:0000:0000:0001:0000:1234:0ff0"" \xe2\x80\x89\xe2\x86\x92\xe2\x80\x89 ""a56f:0000::0000:0001:0000:1234:0ff0"";  ""a56f:00d3:0000:0124:0001:0000:0000:0000"" \xe2\x80\x89\xe2\x86\x92\xe2\x80\x89 ""a56f:00d3:0000:0124:0001::0000"";  ""0000:0000:0000:0000:0000:0000:0000:0000"" \xe2\x80\x89\xe2\x86\x92\xe2\x80\x89 ""::"". It is not allowed to shorten zero blocks in the address more than once. This means that the short record can\'t contain the sequence of characters ""::"" more than once. Otherwise, it will sometimes be impossible to determine the number of zero blocks, each represented by a double colon.The format of the record of the IPv6 address after removing the leading zeroes and shortening the zero blocks is called short.You\'ve got several short records of IPv6 addresses. Restore their full record." implementation,strings 1500
39D "Cubical Planet" "You can find anything whatsoever in our Galaxy! A cubical planet goes round an icosahedral star. Let us introduce a system of axes so that the edges of the cubical planet are parallel to the coordinate axes and two opposite vertices lay in the points (0,\xe2\x80\x890,\xe2\x80\x890) and (1,\xe2\x80\x891,\xe2\x80\x891). Two flies live on the planet. At the moment they are sitting on two different vertices of the cubical planet. Your task is to determine whether they see each other or not. The flies see each other when the vertices they occupy lie on the same face of the cube." math 1100
818C "Sofa Thief" "Yet another round on DecoForces is coming! Grandpa Maks wanted to participate in it but someone has stolen his precious sofa! And how can one perform well with such a major loss?Fortunately, the thief had left a note for Grandpa Maks. This note got Maks to the sofa storehouse. Still he had no idea which sofa belongs to him as they all looked the same!The storehouse is represented as matrix n\xe2\x80\x89\xc3\x97\xe2\x80\x89m. Every sofa takes two neighbouring by some side cells. No cell is covered by more than one sofa. There can be empty cells.Sofa A is standing to the left of sofa B if there exist two such cells a and b that xa\xe2\x80\x89<\xe2\x80\x89xb, a is covered by A and b is covered by B. Sofa A is standing to the top of sofa B if there exist two such cells a and b that ya\xe2\x80\x89<\xe2\x80\x89yb, a is covered by A and b is covered by B. Right and bottom conditions are declared the same way. Note that in all conditions A\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89B. Also some sofa A can be both to the top of another sofa B and to the bottom of it. The same is for left and right conditions.The note also stated that there are cntl sofas to the left of Grandpa Maks\'s sofa, cntr \xe2\x80\x94 to the right, cntt \xe2\x80\x94 to the top and cntb \xe2\x80\x94 to the bottom.Grandpa Maks asks you to help him to identify his sofa. It is guaranteed that there is no more than one sofa of given conditions.Output the number of Grandpa Maks\'s sofa. If there is no such sofa that all the conditions are met for it then output -1." "brute force,implementation" 2000
815A "Karen and Game" "On the way to school, Karen became fixated on the puzzle game on her phone!  The game is played as follows. In each level, you have a grid with n rows and m columns. Each cell originally contains the number 0.One move consists of choosing one row or column, and adding 1 to all of the cells in that row or column.To win the level, after all the moves, the number in the cell at the i-th row and j-th column should be equal to gi,\xe2\x80\x89j.Karen is stuck on one level, and wants to know a way to beat this level using the minimum number of moves. Please, help her with this task!" "brute force,greedy,implementation" 1700
1089F Fractions "You are given a positive integer n.Find a sequence of fractions aibi, i=1\xe2\x80\xa6k (where ai and bi are positive integers) for some k such that:{bi divides n, 1<bi<n for i=1\xe2\x80\xa6k1\xe2\x89\xa4ai<bi for i=1\xe2\x80\xa6kk\xe2\x88\x91i=1aibi=1\xe2\x88\x921n" math 1900
535E "Tavas and Pashmaks" "Tavas is a cheerleader in the new sports competition named ""Pashmaks"".  This competition consists of two part: swimming and then running. People will immediately start running R meters after they finished swimming exactly S meters. A winner is a such person that nobody else finishes running before him/her (there may be more than one winner).Before the match starts, Tavas knows that there are n competitors registered for the match. Also, he knows that i-th person\'s swimming speed is si meters per second and his/her running speed is ri meters per second. Unfortunately, he doesn\'t know the values of R and S, but he knows that they are real numbers greater than 0.As a cheerleader, Tavas wants to know who to cheer up. So, he wants to know all people that might win. We consider a competitor might win if and only if there are some values of R and S such that with these values, (s)he will be a winner.Tavas isn\'t really familiar with programming, so he asked you to help him." geometry,math 2600
1472A "Cards for Friends" "For the New Year, Polycarp decided to send postcards to all his n friends. He wants to make postcards with his own hands. For this purpose, he has a sheet of paper of size w\xc3\x97h, which can be cut into pieces.Polycarp can cut any sheet of paper w\xc3\x97h that he has in only two cases:   If w is even, then he can cut the sheet in half and get two sheets of size w2\xc3\x97h;  If h is even, then he can cut the sheet in half and get two sheets of size w\xc3\x97h2; If w and h are even at the same time, then Polycarp can cut the sheet according to any of the rules above.After cutting a sheet of paper, the total number of sheets of paper is increased by 1.Help Polycarp to find out if he can cut his sheet of size w\xc3\x97h at into n or more pieces, using only the rules described above." greedy,math 800
1641F "Covering Circle" "Sam started playing with round buckets in the sandbox, while also scattering pebbles. His mom decided to buy him a new bucket, so she needs to solve the following task.You are given n distinct points with integer coordinates A1,A2,\xe2\x80\xa6,An. All points were generated from the square [\xe2\x88\x92108,108]\xc3\x97[\xe2\x88\x92108,108] uniformly and independently.You are given positive integers k, l, such that k\xe2\x89\xa4l\xe2\x89\xa4n. You want to select a subsegment Ai,Ai+1,\xe2\x80\xa6,Ai+l\xe2\x88\x921 of the points array (for some 1\xe2\x89\xa4i\xe2\x89\xa4n+1\xe2\x88\x92l), and some circle on the plane, containing \xe2\x89\xa5k points of the selected subsegment (inside or on the border).What is the smallest possible radius of that circle?" geometry 3500
1295E "Permutation Separation" "You are given a permutation p1,p2,\xe2\x80\xa6,pn (an array where each integer from 1 to n appears exactly once). The weight of the i-th element of this permutation is ai.At first, you separate your permutation into two non-empty sets \xe2\x80\x94 prefix and suffix. More formally, the first set contains elements p1,p2,\xe2\x80\xa6,pk, the second \xe2\x80\x94 pk+1,pk+2,\xe2\x80\xa6,pn, where 1\xe2\x89\xa4k<n.After that, you may move elements between sets. The operation you are allowed to do is to choose some element of the first set and move it to the second set, or vice versa (move from the second set to the first). You have to pay ai dollars to move the element pi.Your goal is to make it so that each element of the first set is less than each element of the second set. Note that if one of the sets is empty, this condition is met.For example, if p=[3,1,2] and a=[7,1,4], then the optimal strategy is: separate p into two parts [3,1] and [2] and then move the 2-element into first set (it costs 4). And if p=[3,5,1,6,2,4], a=[9,1,9,9,1,9], then the optimal strategy is: separate p into two parts [3,5,1] and [6,2,4], and then move the 2-element into first set (it costs 1), and 5-element into second set (it also costs 1).Calculate the minimum number of dollars you have to spend." "data structures,divide and conquer" 2200
309D "Tennis Rackets" "Professional sport is more than hard work. It also is the equipment, designed by top engineers. As an example, let\'s take tennis. Not only should you be in great shape, you also need an excellent racket! In this problem your task is to contribute to the development of tennis and to help to design a revolutionary new concept of a racket!The concept is a triangular racket. Ant it should be not just any triangle, but a regular one. As soon as you\'ve chosen the shape, you need to stretch the net. By the time you came the rocket had n holes drilled on each of its sides. The holes divide each side into equal n\xe2\x80\x89+\xe2\x80\x891 parts. At that, the m closest to each apex holes on each side are made for better ventilation only and you cannot stretch the net through them. The next revolutionary idea as to stretch the net as obtuse triangles through the holes, so that for each triangle all apexes lay on different sides. Moreover, you need the net to be stretched along every possible obtuse triangle. That\'s where we need your help \xe2\x80\x94 help us to count the number of triangles the net is going to consist of.Two triangles are considered to be different if their pictures on the fixed at some position racket are different." "brute force,geometry" 2700
1388E "Uncle Bogdan and Projections" "After returning to shore, uncle Bogdan usually visits the computer club ""The Rock"", to solve tasks in a pleasant company. One day, uncle Bogdan met his good old friend who told him one unusual task...There are nn non-intersecting horizontal segments with ends in integers points on the plane with the standard cartesian coordinate system. All segments are strictly above the OXOX axis. You can choose an arbitrary vector (aa, bb), where b<0b<0 and coordinates are real numbers, and project all segments to OXOX axis along this vector. The projections shouldn\'t intersect but may touch each other.Find the minimum possible difference between xx coordinate of the right end of the rightmost projection and xx coordinate of the left end of the leftmost projection." "data structures,geometry,sortings" 2700
1387B1 "Village (Minimum)" "This problem is split into two tasks. In this task, you are required to find the minimum possible answer. In the task Village (Maximum) you are required to find the maximum possible answer. Each task is worth 50 points.There are N houses in a certain village. A single villager lives in each of the houses. The houses are connected by roads. Each road connects two houses and is exactly 1 kilometer long. From each house it is possible to reach any other using one or several consecutive roads. In total there are N\xe2\x88\x921 roads in the village.One day all villagers decided to move to different houses \xe2\x80\x94 that is, after moving each house should again have a single villager living in it, but no villager should be living in the same house as before. We would like to know the smallest possible total length in kilometers of the shortest paths between the old and the new houses for all villagers. Example village with seven houses For example, if there are seven houses connected by roads as shown on the figure, the smallest total length is 8 km (this can be achieved by moving 1\xe2\x86\x926, 2\xe2\x86\x924, 3\xe2\x86\x921, 4\xe2\x86\x922, 5\xe2\x86\x927, 6\xe2\x86\x923, 7\xe2\x86\x925).Write a program that finds the smallest total length of the shortest paths in kilometers and an example assignment of the new houses to the villagers." "*special problem,dp,greedy,trees" 2100
1844F2 "Min Cost Permutation (Hard Version)" "The only difference between this problem and the easy version is the constraints on t and n.You are given an array of n positive integers a1,\xe2\x80\xa6,an, and a (possibly negative) integer c.Across all permutations b1,\xe2\x80\xa6,bn of the array a1,\xe2\x80\xa6,an, consider the minimum possible value of n\xe2\x88\x921\xe2\x88\x91i=1|bi+1\xe2\x88\x92bi\xe2\x88\x92c|. Find the lexicographically smallest permutation b of the array a that achieves this minimum.A sequence x is lexicographically smaller than a sequence y if and only if one of the following holds: x is a prefix of y, but x\xe2\x89\xa0y; in the first position where x and y differ, the sequence x has a smaller element than the corresponding element in y." "binary search,constructive algorithms,data structures,greedy,math,sortings" 2800
862B "Mahmoud and Ehab and the bipartiteness" "Mahmoud and Ehab continue their adventures! As everybody in the evil land knows, Dr. Evil likes bipartite graphs, especially trees.A tree is a connected acyclic graph. A bipartite graph is a graph, whose vertices can be partitioned into 2 sets in such a way, that for each edge (u,\xe2\x80\x89v) that belongs to the graph, u and v belong to different sets. You can find more formal definitions of a tree and a bipartite graph in the notes section below.Dr. Evil gave Mahmoud and Ehab a tree consisting of n nodes and asked them to add edges to it in such a way, that the graph is still bipartite. Besides, after adding these edges the graph should be simple (doesn\'t contain loops or multiple edges). What is the maximum number of edges they can add?A loop is an edge, which connects a node with itself. Graph doesn\'t contain multiple edges when for each pair of nodes there is no more than one edge between them. A cycle and a loop aren\'t the same ." "dfs and similar,graphs,trees" 1300
1117G "Recursive Queries" "You are given a permutation p1,p2,\xe2\x80\xa6,pn. You should answer q queries. Each query is a pair (li,ri), and you should calculate f(li,ri).Let\'s denote ml,r as the position of the maximum in subsegment pl,pl+1,\xe2\x80\xa6,pr.Then f(l,r)=(r\xe2\x88\x92l+1)+f(l,ml,r\xe2\x88\x921)+f(ml,r+1,r) if l\xe2\x89\xa4r or 0 otherwise." "data structures" 2500
1485C "Floor and Mod" "A pair of positive integers (a,b) is called special if \xe2\x8c\x8aab\xe2\x8c\x8b=amodb. Here, \xe2\x8c\x8aab\xe2\x8c\x8b is the result of the integer division between a and b, while amodb is its remainder.You are given two integers x and y. Find the number of special pairs (a,b) such that 1\xe2\x89\xa4a\xe2\x89\xa4x and 1\xe2\x89\xa4b\xe2\x89\xa4y." "binary search,brute force,math,number theory" 1700
812B "Sagheer, the Hausmeister" "Some people leave the lights at their workplaces on when they leave that is a waste of resources. As a hausmeister of DHBW, Sagheer waits till all students and professors leave the university building, then goes and turns all the lights off.The building consists of n floors with stairs at the left and the right sides. Each floor has m rooms on the same line with a corridor that connects the left and right stairs passing by all the rooms. In other words, the building can be represented as a rectangle with n rows and m\xe2\x80\x89+\xe2\x80\x892 columns, where the first and the last columns represent the stairs, and the m columns in the middle represent rooms.Sagheer is standing at the ground floor at the left stairs. He wants to turn all the lights off in such a way that he will not go upstairs until all lights in the floor he is standing at are off. Of course, Sagheer must visit a room to turn the light there off. It takes one minute for Sagheer to go to the next floor using stairs or to move from the current room/stairs to a neighboring room/stairs on the same floor. It takes no time for him to switch the light off in the room he is currently standing in. Help Sagheer find the minimum total time to turn off all the lights.Note that Sagheer does not have to go back to his starting position, and he does not have to visit rooms where the light is already switched off." "bitmasks,brute force,dp" 1600
1033E "Hidden Bipartite Graph" "Bob has a simple undirected connected graph (without self-loops and multiple edges). He wants to learn whether his graph is bipartite (that is, you can paint all vertices of the graph into two colors so that there is no edge connecting two vertices of the same color) or not. As he is not very good at programming, he asked Alice for help. He does not want to disclose his graph to Alice, but he agreed that Alice can ask him some questions about the graph.The only question that Alice can ask is the following: she sends s \xe2\x80\x94 a subset of vertices of the original graph. Bob answers with the number of edges that have both endpoints in s. Since he doesn\'t want Alice to learn too much about the graph, he allows her to ask no more than 20000 questions. Furthermore, he suspects that Alice might introduce false messages to their communication channel, so when Alice finally tells him whether the graph is bipartite or not, she also needs to provide a proof \xe2\x80\x94 either the partitions themselves or a cycle of odd length.Your task is to help Alice to construct the queries, find whether the graph is bipartite." "binary search,constructive algorithms,dfs and similar,graphs,interactive" 2800
1562C Rings "Frodo was caught by Saruman. He tore a pouch from Frodo\'s neck, shook out its contents \xe2\x80\x94there was a pile of different rings: gold and silver...""How am I to tell which is the One?!"" the mage howled.""Throw them one by one into the Cracks of Doom and watch when Mordor falls!"" Somewhere in a parallel Middle-earth, when Saruman caught Frodo, he only found n rings. And the i-th ring was either gold or silver. For convenience Saruman wrote down a binary string s of n characters, where the i-th character was 0 if the i-th ring was gold, and 1 if it was silver.Saruman has a magic function f, which takes a binary string and returns a number obtained by converting the string into a binary number and then converting the binary number into a decimal number. For example, f(001010)=10,f(111)=7,f(11011101)=221.Saruman, however, thinks that the order of the rings plays some important role. He wants to find 2 pairs of integers (l1,r1),(l2,r2), such that: 1\xe2\x89\xa4l1\xe2\x89\xa4n, 1\xe2\x89\xa4r1\xe2\x89\xa4n, r1\xe2\x88\x92l1+1\xe2\x89\xa5\xe2\x8c\x8an2\xe2\x8c\x8b  1\xe2\x89\xa4l2\xe2\x89\xa4n, 1\xe2\x89\xa4r2\xe2\x89\xa4n, r2\xe2\x88\x92l2+1\xe2\x89\xa5\xe2\x8c\x8an2\xe2\x8c\x8b  Pairs (l1,r1) and (l2,r2) are distinct. That is, at least one of l1\xe2\x89\xa0l2 and r1\xe2\x89\xa0r2 must hold. Let t be the substring s[l1:r1] of s, and w be the substring s[l2:r2] of s. Then there exists non-negative integer k, such that f(t)=f(w)\xe2\x8b\x85k.Here substring s[l:r] denotes slsl+1\xe2\x80\xa6sr\xe2\x88\x921sr, and \xe2\x8c\x8ax\xe2\x8c\x8b denotes rounding the number down to the nearest integer.Help Saruman solve this problem! It is guaranteed that under the constraints of the problem at least one solution exists." "constructive algorithms,math" 1500
837F "Prefix Sums" "Consider the function p(x), where x is an array of m integers, which returns an array y consisting of m\xe2\x80\x89+\xe2\x80\x891 integers such that yi is equal to the sum of first i elements of array x (0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m).You have an infinite sequence of arrays A0,\xe2\x80\x89A1,\xe2\x80\x89A2..., where A0 is given in the input, and for each i\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x891 Ai\xe2\x80\x89=\xe2\x80\x89p(Ai\xe2\x80\x89-\xe2\x80\x891). Also you have a positive integer k. You have to find minimum possible i such that Ai contains a number which is larger or equal than k." "binary search,brute force,combinatorics,math,matrices" 2400
1238B "Kill `Em All" "Ivan plays an old action game called Heretic. He\'s stuck on one of the final levels of this game, so he needs some help with killing the monsters.The main part of the level is a large corridor (so large and narrow that it can be represented as an infinite coordinate line). The corridor is divided into two parts; let\'s assume that the point x=0 is where these parts meet.The right part of the corridor is filled with n monsters \xe2\x80\x94 for each monster, its initial coordinate xi is given (and since all monsters are in the right part, every xi is positive).The left part of the corridor is filled with crusher traps. If some monster enters the left part of the corridor or the origin (so, its current coordinate becomes less than or equal to 0), it gets instantly killed by a trap.The main weapon Ivan uses to kill the monsters is the Phoenix Rod. It can launch a missile that explodes upon impact, obliterating every monster caught in the explosion and throwing all other monsters away from the epicenter. Formally, suppose that Ivan launches a missile so that it explodes in the point c. Then every monster is either killed by explosion or pushed away. Let some monster\'s current coordinate be y, then:  if c=y, then the monster is killed;  if y<c, then the monster is pushed r units to the left, so its current coordinate becomes y\xe2\x88\x92r;  if y>c, then the monster is pushed r units to the right, so its current coordinate becomes y+r. Ivan is going to kill the monsters as follows: choose some integer point d and launch a missile into that point, then wait until it explodes and all the monsters which are pushed to the left part of the corridor are killed by crusher traps, then, if at least one monster is still alive, choose another integer point (probably the one that was already used) and launch a missile there, and so on.What is the minimum number of missiles Ivan has to launch in order to kill all of the monsters? You may assume that every time Ivan fires the Phoenix Rod, he chooses the impact point optimally.You have to answer q independent queries." greedy,sortings 1300
79D Password "Finally Fox Ciel arrived in front of her castle!She have to type a password to enter her castle. An input device attached to her castle is a bit unusual.The input device is a 1\xe2\x80\x89\xc3\x97\xe2\x80\x89n rectangle divided into n square panels. They are numbered 1 to n from left to right. Each panel has a state either ON or OFF. Initially all panels are in the OFF state. She can enter her castle if and only if x1-th, x2-th, ..., xk-th panels are in the ON state and other panels are in the OFF state.She is given an array a1, ..., al. In each move, she can perform the following operation: choose an index i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l), choose consecutive ai panels, and flip the states of those panels (i.e. ON\xe2\x80\x89\xe2\x86\x92\xe2\x80\x89OFF, OFF\xe2\x80\x89\xe2\x86\x92\xe2\x80\x89ON).Unfortunately she forgets how to type the password with only above operations. Determine the minimal number of operations required to enter her castle." "bitmasks,dp,shortest paths" 2800
1278E "Tests for problem D" "We had a really tough time generating tests for problem D. In order to prepare strong tests, we had to solve the following problem.Given an undirected labeled tree consisting of n vertices, find a set of segments such that:  both endpoints of each segment are integers from 1 to 2n, and each integer from 1 to 2n should appear as an endpoint of exactly one segment;  all segments are non-degenerate;  for each pair (i,j) such that i\xe2\x89\xa0j, i\xe2\x88\x88[1,n] and j\xe2\x88\x88[1,n], the vertices i and j are connected with an edge if and only if the segments i and j intersect, but neither segment i is fully contained in segment j, nor segment j is fully contained in segment i. Can you solve this problem too?" "constructive algorithms,dfs and similar,divide and conquer,trees" 2200
100C A+B "Bijan is new to programming. He learned recently that programmers do not code every bit of their apps from scratch.For example they never write a code to sum two integers, because their languages have the ability to do the sum. But can they use it? Can an experienced coder who has attended more than 100 contests, sum two integers?Bijan is not sure about this. What\'s your opinion?" "*special problem,implementation" 1400
555C "Case of Chocolate" "Andrewid the Android is a galaxy-known detective. Now he does not investigate any case and is eating chocolate out of boredom.A bar of chocolate can be presented as an n\xe2\x80\x89\xc3\x97\xe2\x80\x89n table, where each cell represents one piece of chocolate. The columns of the table are numbered from 1 to n from left to right and the rows are numbered from top to bottom. Let\'s call the anti-diagonal to be a diagonal that goes the lower left corner to the upper right corner of the table. First Andrewid eats all the pieces lying below the anti-diagonal. Then he performs the following q actions with the remaining triangular part: first, he chooses a piece on the anti-diagonal and either direction \'up\' or \'left\', and then he begins to eat all the pieces starting from the selected cell, moving in the selected direction until he reaches the already eaten piece or chocolate bar edge.After each action, he wants to know how many pieces he ate as a result of this action." "data structures" 2200
1594E1 "Rubik\'s Cube Coloring (easy version)" "It is the easy version of the problem. The difference is that in this version, there are no nodes with already chosen colors.Theofanis is starving, and he wants to eat his favorite food, sheftalia. However, he should first finish his homework. Can you help him with this problem?You have a perfect binary tree of 2k\xe2\x88\x921 nodes \xe2\x80\x94 a binary tree where all vertices i from 1 to 2k\xe2\x88\x921\xe2\x88\x921 have exactly two children: vertices 2i and 2i+1. Vertices from 2k\xe2\x88\x921 to 2k\xe2\x88\x921 don\'t have any children. You want to color its vertices with the 6 Rubik\'s cube colors (White, Green, Red, Blue, Orange and Yellow).Let\'s call a coloring good when all edges connect nodes with colors that are neighboring sides in the Rubik\'s cube.  A picture of Rubik\'s cube and its 2D map. More formally:   a white node can not be neighboring with white and yellow nodes;  a yellow node can not be neighboring with white and yellow nodes;  a green node can not be neighboring with green and blue nodes;  a blue node can not be neighboring with green and blue nodes;  a red node can not be neighboring with red and orange nodes;  an orange node can not be neighboring with red and orange nodes; You want to calculate the number of the good colorings of the binary tree. Two colorings are considered different if at least one node is colored with a different color.The answer may be too large, so output the answer modulo 109+7." combinatorics,math 1300
467E "Alex and Complicated Task" "After you have read all the problems, probably, you think Alex is genius person. That\'s true! One day he came up with the following task.Given a sequence of integer numbers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. You are to find a longest sequence b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89b4m, that satisfies the following conditions:  b4k\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89=\xe2\x80\x89b4k\xe2\x80\x89+\xe2\x80\x893 for all valid integer k;  b4k\xe2\x80\x89+\xe2\x80\x892\xe2\x80\x89=\xe2\x80\x89b4k\xe2\x80\x89+\xe2\x80\x894 for all valid integer k;  sequence b is subsequence of a (not necessarily contiguous subsequence). And finally... Alex had given this complicated task to George, and George gave it to you. Help George to cope with the task." "data structures,dp,greedy" 2300
590A "Median Smoothing" "A schoolboy named Vasya loves reading books on programming and mathematics. He has recently read an encyclopedia article that described the method of median smoothing (or median filter) and its many applications in science and engineering. Vasya liked the idea of the method very much, and he decided to try it in practice.Applying the simplest variant of median smoothing to the sequence of numbers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an will result a new sequence b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bn obtained by the following algorithm:  b1\xe2\x80\x89=\xe2\x80\x89a1, bn\xe2\x80\x89=\xe2\x80\x89an, that is, the first and the last number of the new sequence match the corresponding numbers of the original sequence.  For i\xe2\x80\x89=\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x891 value bi is equal to the median of three values ai\xe2\x80\x89-\xe2\x80\x891, ai and ai\xe2\x80\x89+\xe2\x80\x891. The median of a set of three numbers is the number that goes on the second place, when these three numbers are written in the non-decreasing order. For example, the median of the set 5, 1, 2 is number 2, and the median of set 1, 0, 1 is equal to 1.In order to make the task easier, Vasya decided to apply the method to sequences consisting of zeros and ones only.Having made the procedure once, Vasya looked at the resulting sequence and thought: what if I apply the algorithm to it once again, and then apply it to the next result, and so on? Vasya tried a couple of examples and found out that after some number of median smoothing algorithm applications the sequence can stop changing. We say that the sequence is stable, if it does not change when the median smoothing is applied to it.Now Vasya wonders, whether the sequence always eventually becomes stable. He asks you to write a program that, given a sequence of zeros and ones, will determine whether it ever becomes stable. Moreover, if it ever becomes stable, then you should determine what will it look like and how many times one needs to apply the median smoothing algorithm to initial sequence in order to obtain a stable one." implementation 1700
1498C "Planar Reflections" "Gaurang has grown up in a mystical universe. He is faced by n consecutive 2D planes. He shoots a particle of decay age k at the planes.A particle can pass through a plane directly, however, every plane produces an identical copy of the particle going in the opposite direction with a decay age k\xe2\x88\x921. If a particle has decay age equal to 1, it will NOT produce a copy.For example, if there are two planes and a particle is shot with decay age 3 (towards the right), the process is as follows: (here, D(x) refers to a single particle with decay age x)  the first plane produces a D(2) to the left and lets D(3) continue on to the right;  the second plane produces a D(2) to the left and lets D(3) continue on to the right;  the first plane lets D(2) continue on to the left and produces a D(1) to the right;  the second plane lets D(1) continue on to the right (D(1) cannot produce any copies). In total, the final multiset S of particles is {D(3),D(2),D(2),D(1)}. (See notes for visual explanation of this test case.)Gaurang is unable to cope up with the complexity of this situation when the number of planes is too large. Help Gaurang find the size of the multiset S, given n and k.Since the size of the multiset can be very large, you have to output it modulo 109+7.Note: Particles can go back and forth between the planes without colliding with each other." "brute force,data structures,dp" 1600
1861A "Prime Deletion" "A prime number is a positive integer that has exactly two different positive divisors: 1 and the integer itself. For example, 2, 3, 13 and 101 are prime numbers; 1, 4, 6 and 42 are not.You are given a sequence of digits from 1 to 9, in which every digit from 1 to 9 appears exactly once.You are allowed to do the following operation several (maybe zero) times: choose any digit from the sequence and delete it. However, you cannot perform this operation if the sequence consists of only two digits.Your goal is to obtain a sequence which represents a prime number. Note that you cannot reorder the digits in the sequence.Print the resulting sequence, or report that it is impossible to perform the operations so that the resulting sequence is a prime number." "constructive algorithms,math" 800
1579F "Array Stabilization (AND version)" "You are given an array a[0\xe2\x80\xa6n\xe2\x88\x921]=[a0,a1,\xe2\x80\xa6,an\xe2\x88\x921] of zeroes and ones only. Note that in this problem, unlike the others, the array indexes are numbered from zero, not from one.In one step, the array a is replaced by another array of length n according to the following rules:   First, a new array a\xe2\x86\x92d is defined as a cyclic shift of the array a to the right by d cells. The elements of this array can be defined as a\xe2\x86\x92di=a(i+n\xe2\x88\x92d)modn, where (i+n\xe2\x88\x92d)modn is the remainder of integer division of i+n\xe2\x88\x92d by n.  It means that the whole array a\xe2\x86\x92d can be represented as a sequence a\xe2\x86\x92d=[an\xe2\x88\x92d,an\xe2\x88\x92d+1,\xe2\x80\xa6,an\xe2\x88\x921,a0,a1,\xe2\x80\xa6,an\xe2\x88\x92d\xe2\x88\x921]  Then each element of the array ai is replaced by ai&a\xe2\x86\x92di, where & is a logical ""AND"" operator. For example, if a=[0,0,1,1] and d=1, then a\xe2\x86\x92d=[1,0,0,1] and the value of a after the first step will be [0&1,0&0,1&0,1&1], that is [0,0,0,1].The process ends when the array stops changing. For a given array a, determine whether it will consist of only zeros at the end of the process. If yes, also find the number of steps the process will take before it finishes." "brute force,graphs,math,number theory,shortest paths" 1700
1114A "Got Any Grapes?" "The Duck songFor simplicity, we\'ll assume that there are only three types of grapes: green grapes, purple grapes and black grapes.Andrew, Dmitry and Michal are all grapes\' lovers, however their preferences of grapes are different. To make all of them happy, the following should happen: Andrew, Dmitry and Michal should eat at least x, y and z grapes, respectively. Andrew has an extreme affinity for green grapes, thus he will eat green grapes and green grapes only. On the other hand, Dmitry is not a fan of black grapes \xe2\x80\x94 any types of grapes except black would do for him. In other words, Dmitry can eat green and purple grapes. Michal has a common taste \xe2\x80\x94 he enjoys grapes in general and will be pleased with any types of grapes, as long as the quantity is sufficient.Knowing that his friends are so fond of grapes, Aki decided to host a grape party with them. He has prepared a box with a green grapes, b purple grapes and c black grapes.However, Aki isn\'t sure if the box he prepared contains enough grapes to make everyone happy. Can you please find out whether it\'s possible to distribute grapes so that everyone is happy or Aki has to buy some more grapes?It is not required to distribute all the grapes, so it\'s possible that some of them will remain unused." "brute force,greedy,implementation" 800
1719B "Mathematical Circus" "A new entertainment has appeared in Buryatia \xe2\x80\x94 a mathematical circus! The magician shows two numbers to the audience \xe2\x80\x94 n and k, where n is even. Next, he takes all the integers from 1 to n, and splits them all into pairs (a,b) (each integer must be in exactly one pair) so that for each pair the integer (a+k)\xe2\x8b\x85b is divisible by 4 (note that the order of the numbers in the pair matters), or reports that, unfortunately for viewers, such a split is impossible.Burenka really likes such performances, so she asked her friend Tonya to be a magician, and also gave him the numbers n and k.Tonya is a wolf, and as you know, wolves do not perform in the circus, even in a mathematical one. Therefore, he asks you to help him. Let him know if a suitable splitting into pairs is possible, and if possible, then tell it." "constructive algorithms,math" 800
2029H "Message Spread" "Given is an undirected graph with n vertices and m edges. Each edge connects two vertices (u,v) and has a probability of pq of appearing each day.Initially, vertex 1 has a message. At the end of the day, a vertex has a message if and only if itself or at least one of the vertices adjacent to it had the message the day before. Note that each day, each edge chooses its appearance independently.Calculate the expected number of days before all the vertices have the message, modulo 998244353." "bitmasks,brute force,combinatorics,dp" 3500
1740H "MEX Tree Manipulation" "Given a rooted tree, define the value of vertex u in the tree recursively as the MEX\xe2\x80\xa0 of the values of its children. Note that it is only the children, not all of its descendants. In particular, the value of a leaf is 0.Pak Chanek has a rooted tree that initially only contains a single vertex with index 1, which is the root. Pak Chanek is going to do q queries. In the i-th query, Pak Chanek is given an integer xi. Pak Chanek needs to add a new vertex with index i+1 as the child of vertex xi. After adding the new vertex, Pak Chanek needs to recalculate the values of all vertices and report the sum of the values of all vertices in the current tree.\xe2\x80\xa0 The MEX (minimum excluded) of an array is the smallest non-negative integer that does not belong to the array. For example, the MEX of [0,1,1,2,6,7] is 3 and the MEX of [6,9] is 0." "data structures,trees" 3300
66E "Petya and Post" "Little Vasya\'s uncle is a postman. The post offices are located on one circular road. Besides, each post office has its own gas station located next to it. Petya\'s uncle works as follows: in the morning he should leave the house and go to some post office. In the office he receives a portion of letters and a car. Then he must drive in the given car exactly one round along the circular road and return to the starting post office (the uncle can drive along the circle in any direction, counterclockwise or clockwise). Besides, since the car belongs to the city post, it should also be fuelled with gasoline only at the Post Office stations. The total number of stations equals to n. One can fuel the car at the i-th station with no more than ai liters of gasoline. Besides, one can fuel the car no more than once at each station. Also, the distance between the 1-st and the 2-nd station is b1 kilometers, the distance between the 2-nd and the 3-rd one is b2 kilometers, ..., between the (n\xe2\x80\x89-\xe2\x80\x891)-th and the n-th ones the distance is bn\xe2\x80\x89-\xe2\x80\x891 kilometers and between the n-th and the 1-st one the distance is bn kilometers. Petya\'s uncle\'s high-tech car uses only one liter of gasoline per kilometer. It is known that the stations are located so that the sum of all ai is equal to the sum of all bi. The i-th gas station and i-th post office are very close, so the distance between them is 0 kilometers.Thus, it becomes clear that if we start from some post offices, then it is not always possible to drive one round along a circular road. The uncle faces the following problem: to what stations can he go in the morning to be able to ride exactly one circle along the circular road and visit all the post offices that are on it?Petya, who used to attend programming classes, has volunteered to help his uncle, but his knowledge turned out to be not enough, so he asks you to help him write the program that will solve the posed problem." "data structures,dp" 2000
2022E2 "Billetes MX (Hard Version)" "This is the hard version of the problem. In this version, it is guaranteed that q\xe2\x89\xa4105. You can make hacks only if both versions of the problem are solved.An integer grid A with p rows and q columns is called beautiful if:   All elements of the grid are integers between 0 and 230\xe2\x88\x921, and  For any subgrid, the XOR of the values at the corners is equal to 0. Formally, for any four integers i1, i2, j1, j2 (1\xe2\x89\xa4i1<i2\xe2\x89\xa4p; 1\xe2\x89\xa4j1<j2\xe2\x89\xa4q), Ai1,j1\xe2\x8a\x95Ai1,j2\xe2\x8a\x95Ai2,j1\xe2\x8a\x95Ai2,j2=0, where \xe2\x8a\x95 denotes the bitwise XOR operation. There is a partially filled integer grid G with n rows and m columns where only k cells are filled. Polycarp wants to know how many ways he can assign integers to the unfilled cells so that the grid is beautiful.However, Monocarp thinks that this problem is too easy. Therefore, he will perform q updates on the grid. In each update, he will choose an unfilled cell and assign an integer to it. Note that these updates are persistent. That is, changes made to the grid will apply when processing future updates.For each of the q+1 states of the grid, the initial state and after each of the q queries, determine the number of ways Polycarp can assign integers to the unfilled cells so that the grid is beautiful. Since this number can be very large, you are only required to output their values modulo 109+7." "binary search,combinatorics,data structures,dsu,graphs" 2600
1185C1 "Exam in BerSU (easy version)" "The only difference between easy and hard versions is constraints.A session has begun at Beland State University. Many students are taking exams.Polygraph Poligrafovich is going to examine a group of n students. Students will take the exam one-by-one in order from 1-th to n-th. Rules of the exam are following:  The i-th student randomly chooses a ticket.  if this ticket is too hard to the student, he doesn\'t answer and goes home immediately (this process is so fast that it\'s considered no time elapses). This student fails the exam.  if the student finds the ticket easy, he spends exactly ti minutes to pass the exam. After it, he immediately gets a mark and goes home. Students take the exam in the fixed order, one-by-one, without any interruption. At any moment of time, Polygraph Poligrafovich takes the answer from one student.The duration of the whole exam for all students is M minutes (maxti\xe2\x89\xa4M), so students at the end of the list have a greater possibility to run out of time to pass the exam.For each student i, you should count the minimum possible number of students who need to fail the exam so the i-th student has enough time to pass the exam.For each student i, find the answer independently. That is, if when finding the answer for the student i1 some student j should leave, then while finding the answer for i2 (i2>i1) the student j student does not have to go home." greedy,sortings 1200
402D "Upgrading Array" "You have an array of positive integers a[1],\xe2\x80\x89a[2],\xe2\x80\x89...,\xe2\x80\x89a[n] and a set of bad prime numbers b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bm. The prime numbers that do not occur in the set b are considered good. The beauty of array a is the sum , where function f(s) is determined as follows:  f(1)\xe2\x80\x89=\xe2\x80\x890;  Let\'s assume that p is the minimum prime divisor of s. If p is a good prime, then , otherwise . You are allowed to perform an arbitrary (probably zero) number of operations to improve array a. The operation of improvement is the following sequence of actions:  Choose some number r (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) and calculate the value g = GCD(a[1],\xe2\x80\x89a[2],\xe2\x80\x89...,\xe2\x80\x89a[r]).  Apply the assignments: , , ..., . What is the maximum beauty of the array you can get?" "dp,greedy,math,number theory" 1800
849B "Tell Your World" "Connect the countless points with lines, till we reach the faraway yonder.There are n points on a coordinate plane, the i-th of which being (i,\xe2\x80\x89yi).Determine whether it\'s possible to draw two parallel and non-overlapping lines, such that every point in the set lies on exactly one of them, and each of them passes through at least one point in the set." "brute force,geometry" 1600
747F "Igor and Interesting Numbers" "Igor likes hexadecimal notation and considers positive integer in the hexadecimal notation interesting if each digit and each letter in it appears no more than t times. For example, if t\xe2\x80\x89=\xe2\x80\x893, then integers 13a13322, aaa, abcdef0123456789 are interesting, but numbers aaaa, abababab and 1000000 are not interesting.Your task is to find the k-th smallest interesting for Igor integer in the hexadecimal notation. The integer should not contain leading zeros." "brute force,combinatorics,dp,math" 2500
283A "Cows and Sequence" "Bessie and the cows are playing with sequences and need your help. They start with a sequence, initially containing just the number 0, and perform n operations. Each operation is one of the following:  Add the integer xi to the first ai elements of the sequence.  Append an integer ki to the end of the sequence. (And hence the size of the sequence increases by 1)  Remove the last element of the sequence. So, the size of the sequence decreases by one. Note, that this operation can only be done if there are at least two elements in the sequence. After each operation, the cows would like to know the average of all the numbers in the sequence. Help them!" "constructive algorithms,data structures,implementation" 1600
1553D Backspace "You are given two strings s and t, both consisting of lowercase English letters. You are going to type the string s character by character, from the first character to the last one.When typing a character, instead of pressing the button corresponding to it, you can press the ""Backspace"" button. It deletes the last character you have typed among those that aren\'t deleted yet (or does nothing if there are no characters in the current string). For example, if s is ""abcbd"" and you press Backspace instead of typing the first and the fourth characters, you will get the string ""bd"" (the first press of Backspace deletes no character, and the second press deletes the character \'c\'). Another example, if s is ""abcaa"" and you press Backspace instead of the last two letters, then the resulting text is ""a"".Your task is to determine whether you can obtain the string t, if you type the string s and press ""Backspace"" instead of typing several (maybe zero) characters of s." "dp,greedy,strings,two pointers" 1500
1366F "Jog Around The Graph" "You are given a simple weighted connected undirected graph, consisting of n vertices and m edges.A path in the graph of length k is a sequence of k+1 vertices v1,v2,\xe2\x80\xa6,vk+1 such that for each i (1\xe2\x89\xa4i\xe2\x89\xa4k) the edge (vi,vi+1) is present in the graph. A path from some vertex v also has vertex v1=v. Note that edges and vertices are allowed to be included in the path multiple times.The weight of the path is the total weight of edges in it.For each i from 1 to q consider a path from vertex 1 of length i of the maximum weight. What is the sum of weights of these q paths?Answer can be quite large, so print it modulo 109+7." "binary search,dp,geometry,graphs" 2700
777A "Shell Game" "Bomboslav likes to look out of the window in his room and watch lads outside playing famous shell game. The game is played by two persons: operator and player. Operator takes three similar opaque shells and places a ball beneath one of them. Then he shuffles the shells by swapping some pairs and the player has to guess the current position of the ball.Bomboslav noticed that guys are not very inventive, so the operator always swaps the left shell with the middle one during odd moves (first, third, fifth, etc.) and always swaps the middle shell with the right one during even moves (second, fourth, etc.).Let\'s number shells from 0 to 2 from left to right. Thus the left shell is assigned number 0, the middle shell is 1 and the right shell is 2. Bomboslav has missed the moment when the ball was placed beneath the shell, but he knows that exactly n movements were made by the operator and the ball was under shell x at the end. Now he wonders, what was the initial position of the ball?" "constructive algorithms,implementation,math" 1000
1676E "Eating Queries" "Timur has n candies. The i-th candy has a quantity of sugar equal to ai. So, by eating the i-th candy, Timur consumes a quantity of sugar equal to ai.Timur will ask you q queries regarding his candies. For the j-th query you have to answer what is the minimum number of candies he needs to eat in order to reach a quantity of sugar greater than or equal to xj or print -1 if it\'s not possible to obtain such a quantity. In other words, you should print the minimum possible k such that after eating k candies, Timur consumes a quantity of sugar of at least xj or say that no possible k exists.Note that he can\'t eat the same candy twice and queries are independent of each other (Timur can use the same candy in different queries)." "binary search,greedy,sortings" 1100
1422B "Nice Matrix" "A matrix of size n\xc3\x97m is called nice, if all rows and columns of the matrix are palindromes. A sequence of integers (a1,a2,\xe2\x80\xa6,ak) is a palindrome, if for any integer i (1\xe2\x89\xa4i\xe2\x89\xa4k) the equality ai=ak\xe2\x88\x92i+1 holds.Sasha owns a matrix a of size n\xc3\x97m. In one operation he can increase or decrease any number in the matrix by one. Sasha wants to make the matrix nice. He is interested what is the minimum number of operations he needs.Help him!" greedy,implementation,math 1300
62D Wormhouse "Arnie the Worm has finished eating an apple house yet again and decided to move. He made up his mind on the plan, the way the rooms are located and how they are joined by corridors. He numbered all the rooms from 1 to n. All the corridors are bidirectional.Arnie wants the new house to look just like the previous one. That is, it should have exactly n rooms and, if a corridor from room i to room j existed in the old house, it should be built in the new one. We know that during the house constructing process Arnie starts to eat an apple starting from some room and only stops when he eats his way through all the corridors and returns to the starting room. It is also known that Arnie eats without stopping. That is, until Arnie finishes constructing the house, he is busy every moment of his time gnawing a new corridor. Arnie doesn\'t move along the already built corridors.However, gnawing out corridors in one and the same order any time you change a house is a very difficult activity. That\'s why Arnie, knowing the order in which the corridors were located in the previous house, wants to gnaw corridors in another order. It is represented as a list of rooms in the order in which they should be visited. The new list should be lexicographically smallest, but it also should be strictly lexicographically greater than the previous one. Help the worm." "dfs and similar,graphs" 2300
887A "Div. 64" "Top-model Izabella participates in the competition. She wants to impress judges and show her mathematical skills.Her problem is following: for given string, consisting of only 0 and 1, tell if it\'s possible to remove some digits in such a way, that remaining number is a representation of some positive integer, divisible by 64, in the binary numerical system." implementation 1000
1214C "Bad Sequence" "Petya\'s friends made him a birthday present \xe2\x80\x94 a bracket sequence. Petya was quite disappointed with his gift, because he dreamed of correct bracket sequence, yet he told his friends nothing about his dreams and decided to fix present himself. To make everything right, Petya is going to move at most one bracket from its original place in the sequence to any other position. Reversing the bracket (e.g. turning ""("" into "")"" or vice versa) isn\'t allowed. We remind that bracket sequence s is called correct if:   s is empty;  s is equal to ""(t)"", where t is correct bracket sequence;  s is equal to t1t2, i.e. concatenation of t1 and t2, where t1 and t2 are correct bracket sequences. For example, ""(()())"", ""()"" are correct, while "")("" and ""())"" are not. Help Petya to fix his birthday present and understand whether he can move one bracket so that the sequence becomes correct." "data structures,greedy" 1200
1877C Joyboard "Chaneka, a gamer kid, invented a new gaming controller called joyboard. Interestingly, the joyboard she invented can only be used to play one game.The joyboard has a screen containing n+1 slots numbered from 1 to n+1 from left to right. The n+1 slots are going to be filled with an array of non-negative integers [a1,a2,a3,\xe2\x80\xa6,an+1]. Chaneka, as the player, must assign an+1 with an integer between 0 and m inclusive. Then, for each i from n to 1, the value of ai will be equal to the remainder of dividing ai+1 (the adjacent value to the right) by i. In other words, ai=ai+1modi.Chaneka wants it such that after every slot is assigned with an integer, there are exactly k distinct values in the entire screen (among all n+1 slots). How many valid ways are there for assigning a non-negative integer into slot n+1?" "math,number theory" 1200
706D "Vasiliy\'s Multiset" "Author has gone out of the stories about Vasiliy, so here is just a formal task description.You are given q queries and a multiset A, initially containing only integer 0. There are three types of queries:  ""+ x"" \xe2\x80\x94 add integer x to multiset A. ""- x"" \xe2\x80\x94 erase one occurrence of integer x from multiset A. It\'s guaranteed that at least one x is present in the multiset A before this query. ""? x"" \xe2\x80\x94 you are given integer x and need to compute the value , i.e. the maximum value of bitwise exclusive OR (also know as XOR) of integer x and some integer y from the multiset A.Multiset is a set, where equal elements are allowed." "binary search,bitmasks,data structures,trees" 1800
357B "Flag Day" "In Berland, there is the national holiday coming \xe2\x80\x94 the Flag Day. In the honor of this event the president of the country decided to make a big dance party and asked your agency to organize it. He has several conditions:  overall, there must be m dances; exactly three people must take part in each dance; each dance must have one dancer in white clothes, one dancer in red clothes and one dancer in blue clothes (these are the colors of the national flag of Berland). The agency has n dancers, and their number can be less than 3m. That is, some dancers will probably have to dance in more than one dance. All of your dancers must dance on the party. However, if some dance has two or more dancers from a previous dance, then the current dance stops being spectacular. Your agency cannot allow that to happen, so each dance has at most one dancer who has danced in some previous dance. You considered all the criteria and made the plan for the m dances: each dance had three dancers participating in it. Your task is to determine the clothes color for each of the n dancers so that the President\'s third condition fulfilled: each dance must have a dancer in white, a dancer in red and a dancer in blue. The dancers cannot change clothes between the dances." "constructive algorithms,implementation" 1400
687E TOF "Today Pari gave Arya a cool graph problem. Arya wrote a non-optimal solution for it, because he believes in his ability to optimize non-optimal solutions. In addition to being non-optimal, his code was buggy and he tried a lot to optimize it, so the code also became dirty! He keeps getting Time Limit Exceeds and he is disappointed. Suddenly a bright idea came to his mind!Here is how his dirty code looks like:dfs(v){     set count[v] = count[v] + 1     if(count[v] < 1000)     {          foreach u in neighbors[v]          {               if(visited[u] is equal to false)               {                    dfs(u)               }               break          }     }     set visited[v] = true}main(){     input the digraph()     TOF()     foreach 1<=i<=n     {          set count[i] = 0 , visited[i] = false     }     foreach 1 <= v <= n     {          if(visited[v] is equal to false)          {               dfs(v)          }     }     ... // And do something cool and magical but we can\'t tell you what!}He asks you to write the TOF function in order to optimize the running time of the code with minimizing the number of calls of the dfs function. The input is a directed graph and in the TOF function you have to rearrange the edges of the graph in the list neighbors for each vertex. The number of calls of dfs function depends on the arrangement of neighbors of each vertex." "dfs and similar,graphs" 2900
1472D "Even-Odd Game" "During their New Year holidays, Alice and Bob play the following game using an array a of n integers:   Players take turns, Alice moves first.  Each turn a player chooses any element and removes it from the array.  If Alice chooses even value, then she adds it to her score. If the chosen value is odd, Alice\'s score does not change.  Similarly, if Bob chooses odd value, then he adds it to his score. If the chosen value is even, then Bob\'s score does not change. If there are no numbers left in the array, then the game ends. The player with the highest score wins. If the scores of the players are equal, then a draw is declared.For example, if n=4 and a=[5,2,7,3], then the game could go as follows (there are other options):   On the first move, Alice chooses 2 and get two points. Her score is now 2. The array a is now [5,7,3].  On the second move, Bob chooses 5 and get five points. His score is now 5. The array a is now [7,3].  On the third move, Alice chooses 7 and get no points. Her score is now 2. The array a is now [3].  On the last move, Bob chooses 3 and get three points. His score is now 8. The array a is empty now.  Since Bob has more points at the end of the game, he is the winner. You want to find out who will win if both players play optimally. Note that there may be duplicate numbers in the array." dp,games,greedy,sortings 1200
696C PLEASE "As we all know Barney\'s job is ""PLEASE"" and he has not much to do at work. That\'s why he started playing ""cups and key"". In this game there are three identical cups arranged in a line from left to right. Initially key to Barney\'s heart is under the middle cup.  Then at one turn Barney swaps the cup in the middle with any of other two cups randomly (he choses each with equal probability), so the chosen cup becomes the middle one. Game lasts n turns and Barney independently choses a cup to swap with the middle one within each turn, and the key always remains in the cup it was at the start.After n-th turn Barney asks a girl to guess which cup contains the key. The girl points to the middle one but Barney was distracted while making turns and doesn\'t know if the key is under the middle cup. That\'s why he asked you to tell him the probability that girl guessed right.Number n of game turns can be extremely large, that\'s why Barney did not give it to you. Instead he gave you an array a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89ak such that   in other words, n is multiplication of all elements of the given array.Because of precision difficulties, Barney asked you to tell him the answer as an irreducible fraction. In other words you need to find it as a fraction p\xe2\x80\x89/\xe2\x80\x89q such that , where  is the greatest common divisor. Since p and q can be extremely large, you only need to find the remainders of dividing each of them by 109\xe2\x80\x89+\xe2\x80\x897.Please note that we want  of p and q to be 1, not  of their remainders after dividing by 109\xe2\x80\x89+\xe2\x80\x897." combinatorics,dp,implementation,math,matrices 2000
1106F "Lunar New Year and a Recursive Sequence" "Lunar New Year is approaching, and Bob received a gift from his friend recently \xe2\x80\x94 a recursive sequence! He loves this sequence very much and wants to play with it.Let f1,f2,\xe2\x80\xa6,fi,\xe2\x80\xa6 be an infinite sequence of positive integers. Bob knows that for i>k, fi can be obtained by the following recursive equation:fi=(fb1i\xe2\x88\x921\xe2\x8b\x85fb2i\xe2\x88\x922\xe2\x8b\x85\xe2\x8b\xaf\xe2\x8b\x85fbki\xe2\x88\x92k)modp,which in short isfi=(k\xe2\x88\x8fj=1fbji\xe2\x88\x92j)modp,where p=998244353 (a widely-used prime), b1,b2,\xe2\x80\xa6,bk are known integer constants, and xmody denotes the remainder of x divided by y.Bob lost the values of f1,f2,\xe2\x80\xa6,fk, which is extremely troublesome \xe2\x80\x93 these are the basis of the sequence! Luckily, Bob remembers the first k\xe2\x88\x921 elements of the sequence: f1=f2=\xe2\x80\xa6=fk\xe2\x88\x921=1 and the n-th element: fn=m. Please find any possible value of fk. If no solution exists, just tell Bob that it is impossible to recover his favorite sequence, regardless of Bob\'s sadness." "math,matrices,number theory" 2400
1404E Bricks "A brick is defined as a rectangle with integer side lengths with either width 1 or height 1 (or both).There is an n\xc3\x97m grid, and each cell is colored either black or white. A tiling is a way to place bricks onto the grid such that each black cell is covered by exactly one brick, and each white cell is not covered by any brick. In other words, bricks are placed on black cells only, cover all black cells, and no two bricks overlap.  An example tiling of the first test case using 5 bricks. It is possible to do better, using only 4 bricks. What is the minimum number of bricks required to make a valid tiling?" "flows,graph matchings,graphs" 2800
1010A Fly "Natasha is going to fly on a rocket to Mars and return to Earth. Also, on the way to Mars, she will land on n\xe2\x88\x922 intermediate planets. Formally: we number all the planets from 1 to n. 1 is Earth, n is Mars. Natasha will make exactly n flights: 1\xe2\x86\x922\xe2\x86\x92\xe2\x80\xa6n\xe2\x86\x921.Flight from x to y consists of two phases: take-off from planet x and landing to planet y. This way, the overall itinerary of the trip will be: the 1-st planet \xe2\x86\x92 take-off from the 1-st planet \xe2\x86\x92 landing to the 2-nd planet \xe2\x86\x92 2-nd planet \xe2\x86\x92 take-off from the 2-nd planet \xe2\x86\x92 \xe2\x80\xa6 \xe2\x86\x92 landing to the n-th planet \xe2\x86\x92 the n-th planet \xe2\x86\x92 take-off from the n-th planet \xe2\x86\x92 landing to the 1-st planet \xe2\x86\x92 the 1-st planet.The mass of the rocket together with all the useful cargo (but without fuel) is m tons. However, Natasha does not know how much fuel to load into the rocket. Unfortunately, fuel can only be loaded on Earth, so if the rocket runs out of fuel on some other planet, Natasha will not be able to return home. Fuel is needed to take-off from each planet and to land to each planet. It is known that 1 ton of fuel can lift off ai tons of rocket from the i-th planet or to land bi tons of rocket onto the i-th planet. For example, if the weight of rocket is 9 tons, weight of fuel is 3 tons and take-off coefficient is 8 (ai=8), then 1.5 tons of fuel will be burnt (since 1.5\xe2\x8b\x858=9+3). The new weight of fuel after take-off will be 1.5 tons. Please note, that it is allowed to burn non-integral amount of fuel during take-off or landing, and the amount of initial fuel can be non-integral as well.Help Natasha to calculate the minimum mass of fuel to load into the rocket. Note, that the rocket must spend fuel to carry both useful cargo and the fuel itself. However, it doesn\'t need to carry the fuel which has already been burnt. Assume, that the rocket takes off and lands instantly." "binary search,math" 1500
185E "Soap Time! - 2" "Imagine the Cartesian coordinate system. There are k different points containing subway stations. One can get from any subway station to any one instantly. That is, the duration of the transfer between any two subway stations can be considered equal to zero. You are allowed to travel only between subway stations, that is, you are not allowed to leave the subway somewhere in the middle of your path, in-between the stations. There are n dwarves, they are represented by their coordinates on the plane. The dwarves want to come together and watch a soap opera at some integer point on the plane. For that, they choose the gathering point and start moving towards it simultaneously. In one second a dwarf can move from point (x,\xe2\x80\x89y) to one of the following points: (x\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89y), (x\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89y), (x,\xe2\x80\x89y\xe2\x80\x89-\xe2\x80\x891), (x,\xe2\x80\x89y\xe2\x80\x89+\xe2\x80\x891). Besides, the dwarves can use the subway as many times as they want (the subway transfers the dwarves instantly). The dwarves do not interfere with each other as they move (that is, the dwarves move simultaneously and independently from each other). Help the dwarves and find the minimum time they need to gather at one point." "binary search,data structures" 3000
518A "Vitaly and Strings" "Vitaly is a diligent student who never missed a lesson in his five years of studying in the university. He always does his homework on time and passes his exams in time. During the last lesson the teacher has provided two strings s and t to Vitaly. The strings have the same length, they consist of lowercase English letters, string s is lexicographically smaller than string t. Vitaly wondered if there is such string that is lexicographically larger than string s and at the same is lexicographically smaller than string t. This string should also consist of lowercase English letters and have the length equal to the lengths of strings s and t. Let\'s help Vitaly solve this easy problem!" "constructive algorithms,strings" 1600
750G "New Year and Binary Tree Paths" "The New Year tree is an infinite perfect binary tree rooted in the node 1. Each node v has two children: nodes indexed (2\xc2\xb7v) and (2\xc2\xb7v\xe2\x80\x89+\xe2\x80\x891).  Polar bears love decorating the New Year tree and Limak is no exception. As he is only a little bear, he was told to decorate only one simple path between some pair of nodes. Though he was given an opportunity to pick the pair himself! Now he wants to know the number of unordered pairs of indices (u,\xe2\x80\x89v) (u\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89v), such that the sum of indices of all nodes along the simple path between u and v (including endpoints) is equal to s. Can you help him and count this value?" "bitmasks,brute force,combinatorics,dp" 3200
1227F2 "Wrong Answer on test 233 (Hard Version)" "Your program fails again. This time it gets ""Wrong answer on test 233"".This is the harder version of the problem. In this version, 1\xe2\x89\xa4n\xe2\x89\xa42\xe2\x8b\x85105. You can hack this problem if you locked it. But you can hack the previous problem only if you locked both problems.The problem is to finish n one-choice-questions. Each of the questions contains k options, and only one of them is correct. The answer to the i-th question is hi, and if your answer of the question i is hi, you earn 1 point, otherwise, you earn 0 points for this question. The values h1,h2,\xe2\x80\xa6,hn are known to you in this problem.However, you have a mistake in your program. It moves the answer clockwise! Consider all the n answers are written in a circle. Due to the mistake in your program, they are shifted by one cyclically.Formally, the mistake moves the answer for the question i to the question imodn+1. So it moves the answer for the question 1 to question 2, the answer for the question 2 to the question 3, ..., the answer for the question n to the question 1.We call all the n answers together an answer suit. There are kn possible answer suits in total.You\'re wondering, how many answer suits satisfy the following condition: after moving clockwise by 1, the total number of points of the new answer suit is strictly larger than the number of points of the old one. You need to find the answer modulo 998244353.For example, if n=5, and your answer suit is a=[1,2,3,4,5], it will submitted as a\xe2\x80\xb2=[5,1,2,3,4] because of a mistake. If the correct answer suit is h=[5,2,2,3,4], the answer suit a earns 1 point and the answer suite a\xe2\x80\xb2 earns 4 points. Since 4>1, the answer suit a=[1,2,3,4,5] should be counted." combinatorics,math 2400
1531D "\xd0\xa0\xd0\xb5\xd0\xb4\xd0\xb0\xd0\xba\xd1\x82\xd0\xb8\xd1\x80\xd1\x83\xd0\xb5\xd0\xbc \xd0\x97\xd0\xb8\xd0\xbd\xd0\xb3\xd0\xb5\xd1\x80 | color" "\xd0\x9d\xd0\xb5\xd0\xbc\xd0\xbd\xd0\xbe\xd0\xb3\xd0\xb8\xd0\xb5 \xd0\xb7\xd0\xbd\xd0\xb0\xd1\x8e\xd1\x82, \xd1\x87\xd1\x82\xd0\xbe \xd1\x81\xd0\xbe\xd1\x82\xd1\x80\xd1\x83\xd0\xb4\xd0\xbd\xd0\xb8\xd0\xba\xd0\xb8 \xd0\x92\xd0\x9a\xd0\xbe\xd0\xbd\xd1\x82\xd0\xb0\xd0\xba\xd1\x82\xd0\xb5 \xd0\xbc\xd0\xbe\xd0\xb3\xd1\x83\xd1\x82 \xd0\xbc\xd0\xb5\xd0\xbd\xd1\x8f\xd1\x82\xd1\x8c \xd1\x86\xd0\xb2\xd0\xb5\xd1\x82 \xd0\xbf\xd0\xbe\xd0\xb4\xd1\x81\xd0\xb2\xd0\xb5\xd1\x82\xd0\xba\xd0\xb8 \xd0\xb2 \xd0\xba\xd1\x83\xd0\xbf\xd0\xbe\xd0\xbb\xd0\xb5 \xd0\xb7\xd0\xbd\xd0\xb0\xd0\xbc\xd0\xb5\xd0\xbd\xd0\xb8\xd1\x82\xd0\xbe\xd0\xb3\xd0\xbe \xd0\x94\xd0\xbe\xd0\xbc\xd0\xb0 \xd0\x97\xd0\xb8\xd0\xbd\xd0\xb3\xd0\xb5\xd1\x80\xd0\xb0, \xd0\xb3\xd0\xb4\xd0\xb5 \xd1\x80\xd0\xb0\xd1\x81\xd0\xbf\xd0\xbe\xd0\xbb\xd0\xbe\xd0\xb6\xd0\xb5\xd0\xbd\xd0\xb0 \xd1\x88\xd1\x82\xd0\xb0\xd0\xb1-\xd0\xba\xd0\xb2\xd0\xb0\xd1\x80\xd1\x82\xd0\xb8\xd1\x80\xd0\xb0 \xd0\x92\xd0\x9a\xd0\xbe\xd0\xbd\xd1\x82\xd0\xb0\xd0\xba\xd1\x82\xd0\xb5. \xd0\x94\xd0\xbb\xd1\x8f \xd1\x8d\xd1\x82\xd0\xbe\xd0\xb3\xd0\xbe \xd0\xbd\xd1\x83\xd0\xb6\xd0\xbd\xd0\xbe \xd0\xb2\xd1\x81\xd0\xb5\xd0\xb3\xd0\xbe \xd0\xbb\xd0\xb8\xd1\x88\xd1\x8c \xd0\xbe\xd1\x82\xd0\xbf\xd1\x80\xd0\xb0\xd0\xb2\xd0\xb8\xd1\x82\xd1\x8c \xd1\x81\xd0\xbe\xd0\xbe\xd0\xb1\xd1\x89\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb5 \xd1\x81 \xd1\x86\xd0\xb2\xd0\xb5\xd1\x82\xd0\xbe\xd0\xbc \xd0\xb2 \xd1\x81\xd0\xbf\xd0\xb5\xd1\x86\xd0\xb8\xd0\xb0\xd0\xbb\xd1\x8c\xd0\xbd\xd1\x8b\xd0\xb9 \xd1\x87\xd0\xb0\xd1\x82 \xc2\xab\xd0\x97\xd0\xb8\xd0\xbd\xd0\xb3\xd0\xb5\xd1\x80 | color\xc2\xbb, \xd0\xb0 \xd0\xb1\xd0\xbe\xd1\x82 \xd0\xb5\xd0\xb3\xd0\xbe \xd1\x80\xd0\xb0\xd1\x81\xd0\xbf\xd0\xbe\xd0\xb7\xd0\xbd\xd0\xb0\xd0\xb5\xd1\x82 \xd0\xb8 \xd1\x81\xd0\xbc\xd0\xb5\xd0\xbd\xd0\xb8\xd1\x82 \xd0\xbf\xd0\xbe\xd0\xb4\xd1\x81\xd0\xb2\xd0\xb5\xd1\x82\xd0\xba\xd1\x83. \xd0\x9f\xd1\x80\xd0\xb8 \xd1\x8d\xd1\x82\xd0\xbe\xd0\xbc \xd0\xbd\xd0\xb0 \xd0\xb2\xd1\x80\xd0\xb5\xd0\xbc\xd1\x8f \xd0\xb3\xd0\xbe\xd1\x80\xd0\xbe\xd0\xb4\xd1\x81\xd0\xba\xd0\xb8\xd1\x85 \xd0\xbc\xd0\xb5\xd1\x80\xd0\xbe\xd0\xbf\xd1\x80\xd0\xb8\xd1\x8f\xd1\x82\xd0\xb8\xd0\xb9 \xd1\x81\xd0\xbc\xd0\xb5\xd0\xbd\xd0\xb0 \xd1\x86\xd0\xb2\xd0\xb5\xd1\x82\xd0\xb0 \xd0\xb1\xd0\xbb\xd0\xbe\xd0\xba\xd0\xb8\xd1\x80\xd1\x83\xd0\xb5\xd1\x82\xd1\x81\xd1\x8f.\xd0\xa4\xd0\xbe\xd1\x80\xd0\xbc\xd0\xb0\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe, \xd0\xb1\xd0\xbe\xd1\x82 \xd0\xbe\xd0\xb1\xd1\x80\xd0\xb0\xd0\xb1\xd0\xb0\xd1\x82\xd1\x8b\xd0\xb2\xd0\xb0\xd0\xb5\xd1\x82 \xd1\x82\xd1\x80\xd0\xb8 \xd1\x82\xd0\xb8\xd0\xbf\xd0\xb0 \xd1\x81\xd0\xbe\xd0\xbe\xd0\xb1\xd1\x89\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb9:   lock: \xd0\xb7\xd0\xb0\xd0\xb1\xd0\xbb\xd0\xbe\xd0\xba\xd0\xb8\xd1\x80\xd0\xbe\xd0\xb2\xd0\xb0\xd1\x82\xd1\x8c \xd0\xb8\xd0\xb7\xd0\xbc\xd0\xb5\xd0\xbd\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb5 \xd1\x86\xd0\xb2\xd0\xb5\xd1\x82\xd0\xb0. \xd0\x95\xd1\x81\xd0\xbb\xd0\xb8 \xd0\xbe\xd0\xbd\xd0\xbe \xd0\xb8 \xd1\x82\xd0\xb0\xd0\xba \xd0\xb7\xd0\xb0\xd0\xb1\xd0\xbb\xd0\xbe\xd0\xba\xd0\xb8\xd1\x80\xd0\xbe\xd0\xb2\xd0\xb0\xd0\xbd\xd0\xbe \xd0\xbd\xd0\xb0 \xd0\xb4\xd0\xb0\xd0\xbd\xd0\xbd\xd1\x8b\xd0\xb9 \xd0\xbc\xd0\xbe\xd0\xbc\xd0\xb5\xd0\xbd\xd1\x82, \xd1\x81\xd0\xbe\xd0\xbe\xd0\xb1\xd1\x89\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb5 \xd0\xb8\xd0\xb3\xd0\xbd\xd0\xbe\xd1\x80\xd0\xb8\xd1\x80\xd1\x83\xd0\xb5\xd1\x82\xd1\x81\xd1\x8f.  unlock: \xd1\x80\xd0\xb0\xd0\xb7\xd0\xb1\xd0\xbb\xd0\xbe\xd0\xba\xd0\xb8\xd1\x80\xd0\xbe\xd0\xb2\xd0\xb0\xd1\x82\xd1\x8c \xd0\xb8\xd0\xb7\xd0\xbc\xd0\xb5\xd0\xbd\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb5 \xd1\x86\xd0\xb2\xd0\xb5\xd1\x82\xd0\xb0. \xd0\x95\xd1\x81\xd0\xbb\xd0\xb8 \xd0\xbe\xd0\xbd\xd0\xbe \xd0\xb8 \xd1\x82\xd0\xb0\xd0\xba \xd1\x80\xd0\xb0\xd0\xb7\xd0\xb1\xd0\xbb\xd0\xbe\xd0\xba\xd0\xb8\xd1\x80\xd0\xbe\xd0\xb2\xd0\xb0\xd0\xbd\xd0\xbe \xd0\xbd\xd0\xb0 \xd0\xb4\xd0\xb0\xd0\xbd\xd0\xbd\xd1\x8b\xd0\xb9 \xd0\xbc\xd0\xbe\xd0\xbc\xd0\xb5\xd0\xbd\xd1\x82, \xd1\x81\xd0\xbe\xd0\xbe\xd0\xb1\xd1\x89\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb5 \xd0\xb8\xd0\xb3\xd0\xbd\xd0\xbe\xd1\x80\xd0\xb8\xd1\x80\xd1\x83\xd0\xb5\xd1\x82\xd1\x81\xd1\x8f.  red / orange / yellow / green / blue / indigo / violet: \xd0\xb8\xd0\xb7\xd0\xbc\xd0\xb5\xd0\xbd\xd0\xb8\xd1\x82\xd1\x8c \xd1\x86\xd0\xb2\xd0\xb5\xd1\x82 \xd0\xba\xd1\x83\xd0\xbf\xd0\xbe\xd0\xbb\xd0\xb0 \xd0\xbd\xd0\xb0 \xd0\xb7\xd0\xb0\xd0\xb4\xd0\xb0\xd0\xbd\xd0\xbd\xd1\x8b\xd0\xb9, \xd0\xb5\xd1\x81\xd0\xbb\xd0\xb8 \xd0\xb8\xd0\xb7\xd0\xbc\xd0\xb5\xd0\xbd\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb5 \xd1\x86\xd0\xb2\xd0\xb5\xd1\x82\xd0\xb0 \xd0\xbd\xd0\xb0 \xd0\xb4\xd0\xb0\xd0\xbd\xd0\xbd\xd1\x8b\xd0\xb9 \xd0\xbc\xd0\xbe\xd0\xbc\xd0\xb5\xd0\xbd\xd1\x82 \xd0\xbd\xd0\xb5 \xd0\xb7\xd0\xb0\xd0\xb1\xd0\xbb\xd0\xbe\xd0\xba\xd0\xb8\xd1\x80\xd0\xbe\xd0\xb2\xd0\xb0\xd0\xbd\xd0\xbe. \xd0\x92\xd0\xb0\xd0\xbc \xd0\xb4\xd0\xb0\xd0\xbd\xd0\xb0 \xd0\xb8\xd1\x81\xd1\x82\xd0\xbe\xd1\x80\xd0\xb8\xd1\x8f \xd1\x81\xd0\xbe\xd0\xbe\xd0\xb1\xd1\x89\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb9, \xd0\xbf\xd0\xbe\xd0\xbb\xd1\x83\xd1\x87\xd0\xb5\xd0\xbd\xd0\xbd\xd1\x8b\xd1\x85 \xd0\xb1\xd0\xbe\xd1\x82\xd0\xbe\xd0\xbc, \xd0\xb2 \xd1\x85\xd1\x80\xd0\xbe\xd0\xbd\xd0\xbe\xd0\xbb\xd0\xbe\xd0\xb3\xd0\xb8\xd1\x87\xd0\xb5\xd1\x81\xd0\xba\xd0\xbe\xd0\xbc \xd0\xbf\xd0\xbe\xd1\x80\xd1\x8f\xd0\xb4\xd0\xba\xd0\xb5. \xd0\xa1\xd1\x87\xd0\xb8\xd1\x82\xd0\xb0\xd0\xb9\xd1\x82\xd0\xb5, \xd1\x87\xd1\x82\xd0\xbe \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb5\xd0\xb4 \xd0\xbf\xd0\xbe\xd0\xbb\xd1\x83\xd1\x87\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb5\xd0\xbc \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb2\xd0\xbe\xd0\xb3\xd0\xbe \xd1\x81\xd0\xbe\xd0\xbe\xd0\xb1\xd1\x89\xd0\xb5\xd0\xbd\xd0\xb8\xd1\x8f \xd0\xba\xd1\x83\xd0\xbf\xd0\xbe\xd0\xbb \xd0\xbf\xd0\xbe\xd0\xb4\xd1\x81\xd0\xb2\xd0\xb5\xd1\x87\xd0\xb8\xd0\xb2\xd0\xb0\xd0\xb5\xd1\x82\xd1\x81\xd1\x8f \xd0\xb3\xd0\xbe\xd0\xbb\xd1\x83\xd0\xb1\xd1\x8b\xd0\xbc (blue), \xd0\xb0 \xd0\xb8\xd0\xb7\xd0\xbc\xd0\xb5\xd0\xbd\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb5 \xd1\x86\xd0\xb2\xd0\xb5\xd1\x82\xd0\xb0 \xd0\xbd\xd0\xb5 \xd0\xb7\xd0\xb0\xd0\xb1\xd0\xbb\xd0\xbe\xd0\xba\xd0\xb8\xd1\x80\xd0\xbe\xd0\xb2\xd0\xb0\xd0\xbd\xd0\xbe.\xd0\x92 \xd0\xba\xd0\xb0\xd1\x87\xd0\xb5\xd1\x81\xd1\x82\xd0\xb2\xd0\xb5 \xd1\x8d\xd0\xba\xd1\x81\xd0\xbf\xd0\xb5\xd1\x80\xd0\xb8\xd0\xbc\xd0\xb5\xd0\xbd\xd1\x82\xd0\xb0 \xd0\xb1\xd1\x8b\xd0\xbb\xd0\xbe \xd1\x80\xd0\xb5\xd1\x88\xd0\xb5\xd0\xbd\xd0\xbe \xd0\xbf\xd0\xbe\xd0\xb4\xd0\xb4\xd0\xb5\xd1\x80\xd0\xb6\xd0\xb0\xd1\x82\xd1\x8c \xd0\xb2 \xd0\xb1\xd0\xbe\xd1\x82\xd0\xb5 \xd1\x8d\xd1\x84\xd1\x84\xd0\xb5\xd0\xba\xd1\x82\xd0\xb8\xd0\xb2\xd0\xbd\xd1\x83\xd1\x8e \xd0\xbe\xd0\xb1\xd1\x80\xd0\xb0\xd0\xb1\xd0\xbe\xd1\x82\xd0\xba\xd1\x83 \xd1\x80\xd0\xb5\xd0\xb4\xd0\xb0\xd0\xba\xd1\x82\xd0\xb8\xd1\x80\xd0\xbe\xd0\xb2\xd0\xb0\xd0\xbd\xd0\xb8\xd1\x8f \xd1\x81\xd0\xbe\xd0\xbe\xd0\xb1\xd1\x89\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb9. \xd0\x92\xd0\xb0\xd0\xbc \xd0\xb4\xd0\xb0\xd0\xbd\xd0\xb0 \xd0\xbf\xd0\xbe\xd1\x81\xd0\xbb\xd0\xb5\xd0\xb4\xd0\xbe\xd0\xb2\xd0\xb0\xd1\x82\xd0\xb5\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe\xd1\x81\xd1\x82\xd1\x8c \xd0\xbf\xd0\xb0\xd1\x80 \xd0\xb2\xd0\xb8\xd0\xb4\xd0\xb0 (i,msg), \xd0\xbe\xd0\xb7\xd0\xbd\xd0\xb0\xd1\x87\xd0\xb0\xd1\x8e\xd1\x89\xd0\xb8\xd1\x85, \xd1\x87\xd1\x82\xd0\xbe i-\xd0\xb5 \xd0\xb2 \xd1\x85\xd1\x80\xd0\xbe\xd0\xbd\xd0\xbe\xd0\xbb\xd0\xbe\xd0\xb3\xd0\xb8\xd1\x87\xd0\xb5\xd1\x81\xd0\xba\xd0\xbe\xd0\xbc \xd0\xbf\xd0\xbe\xd1\x80\xd1\x8f\xd0\xb4\xd0\xba\xd0\xb5 \xd1\x81\xd0\xbe\xd0\xbe\xd0\xb1\xd1\x89\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb5 \xd0\xb1\xd1\x8b\xd0\xbb\xd0\xbe \xd0\xbe\xd1\x82\xd1\x80\xd0\xb5\xd0\xb4\xd0\xb0\xd0\xba\xd1\x82\xd0\xb8\xd1\x80\xd0\xbe\xd0\xb2\xd0\xb0\xd0\xbd\xd0\xbe \xd0\xb8 \xd1\x82\xd0\xb5\xd0\xbf\xd0\xb5\xd1\x80\xd1\x8c \xd0\xb8\xd0\xbc\xd0\xb5\xd0\xb5\xd1\x82 \xd0\xb2\xd0\xb8\xd0\xb4 msg. \xd0\x9e\xd0\xb1\xd1\x80\xd0\xb0\xd1\x82\xd0\xb8\xd1\x82\xd0\xb5 \xd0\xb2\xd0\xbd\xd0\xb8\xd0\xbc\xd0\xb0\xd0\xbd\xd0\xb8\xd0\xb5, \xd1\x87\xd1\x82\xd0\xbe \xd1\x80\xd0\xb5\xd0\xb4\xd0\xb0\xd0\xba\xd1\x82\xd0\xb8\xd1\x80\xd0\xbe\xd0\xb2\xd0\xb0\xd1\x82\xd1\x8c\xd1\x81\xd1\x8f \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xb5\xd1\x82 \xd0\xbb\xd1\x8e\xd0\xb1\xd0\xbe\xd0\xb5 \xd1\x81\xd0\xbe\xd0\xbe\xd0\xb1\xd1\x89\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb5, \xd0\xb8 \xd0\xbf\xd1\x80\xd0\xb8 \xd1\x80\xd0\xb5\xd0\xb4\xd0\xb0\xd0\xba\xd1\x82\xd0\xb8\xd1\x80\xd0\xbe\xd0\xb2\xd0\xb0\xd0\xbd\xd0\xb8\xd0\xb8 \xd1\x81\xd0\xbe\xd0\xbe\xd0\xb1\xd1\x89\xd0\xb5\xd0\xbd\xd0\xb8\xd1\x8f \xd0\xb1\xd0\xbe\xd1\x82 \xd0\xb4\xd0\xbe\xd0\xbb\xd0\xb6\xd0\xb5\xd0\xbd \xd0\xbe\xd0\xb1\xd1\x80\xd0\xb0\xd0\xb1\xd0\xbe\xd1\x82\xd0\xb0\xd1\x82\xd1\x8c \xd0\xb2\xd1\x81\xd1\x8e \xd0\xb8\xd1\x81\xd1\x82\xd0\xbe\xd1\x80\xd0\xb8\xd1\x8e \xd1\x81\xd0\xbe\xd0\xbe\xd0\xb1\xd1\x89\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb9 \xd0\xb7\xd0\xb0\xd0\xbd\xd0\xbe\xd0\xb2\xd0\xbe (\xd0\xb2 \xd1\x87\xd0\xb0\xd1\x81\xd1\x82\xd0\xbd\xd0\xbe\xd1\x81\xd1\x82\xd0\xb8, \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb5\xd0\xb4 \xd0\xbe\xd0\xb1\xd1\x80\xd0\xb0\xd0\xb1\xd0\xbe\xd1\x82\xd0\xba\xd0\xbe\xd0\xb9 \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb2\xd0\xbe\xd0\xb3\xd0\xbe \xd1\x81\xd0\xbe\xd0\xbe\xd0\xb1\xd1\x89\xd0\xb5\xd0\xbd\xd0\xb8\xd1\x8f \xd1\x86\xd0\xb2\xd0\xb5\xd1\x82 \xd0\xba\xd1\x83\xd0\xbf\xd0\xbe\xd0\xbb\xd0\xb0 \xd0\xb3\xd0\xbe\xd0\xbb\xd1\x83\xd0\xb1\xd0\xbe\xd0\xb9, \xd0\xb0 \xd0\xb8\xd0\xb7\xd0\xbc\xd0\xb5\xd0\xbd\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb5 \xd1\x86\xd0\xb2\xd0\xb5\xd1\x82\xd0\xb0 \xd0\xbd\xd0\xb5 \xd0\xb7\xd0\xb0\xd0\xb1\xd0\xbb\xd0\xbe\xd0\xba\xd0\xb8\xd1\x80\xd0\xbe\xd0\xb2\xd0\xb0\xd0\xbd\xd0\xbe).\xd0\x9e\xd0\xbf\xd1\x80\xd0\xb5\xd0\xb4\xd0\xb5\xd0\xbb\xd0\xb8\xd1\x82\xd0\xb5, \xd0\xba\xd0\xb0\xd0\xba\xd0\xbe\xd0\xb9 \xd1\x86\xd0\xb2\xd0\xb5\xd1\x82 \xd0\xb1\xd1\x83\xd0\xb4\xd0\xb5\xd1\x82 \xd1\x83 \xd0\xba\xd1\x83\xd0\xbf\xd0\xbe\xd0\xbb\xd0\xb0 \xd0\x94\xd0\xbe\xd0\xbc\xd0\xb0 \xd0\x97\xd0\xb8\xd0\xbd\xd0\xb3\xd0\xb5\xd1\x80\xd0\xb0 \xd0\xb4\xd0\xbe \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb2\xd0\xbe\xd0\xb9 \xd0\xbe\xd0\xbf\xd0\xb5\xd1\x80\xd0\xb0\xd1\x86\xd0\xb8\xd0\xb8 \xd1\x80\xd0\xb5\xd0\xb4\xd0\xb0\xd0\xba\xd1\x82\xd0\xb8\xd1\x80\xd0\xbe\xd0\xb2\xd0\xb0\xd0\xbd\xd0\xb8\xd1\x8f, \xd0\xb0 \xd1\x82\xd0\xb0\xd0\xba\xd0\xb6\xd0\xb5 \xd0\xbf\xd0\xbe\xd1\x81\xd0\xbb\xd0\xb5 \xd0\xba\xd0\xb0\xd0\xb6\xd0\xb4\xd0\xbe\xd0\xb9 \xd0\xbe\xd0\xbf\xd0\xb5\xd1\x80\xd0\xb0\xd1\x86\xd0\xb8\xd0\xb8 \xd1\x80\xd0\xb5\xd0\xb4\xd0\xb0\xd0\xba\xd1\x82\xd0\xb8\xd1\x80\xd0\xbe\xd0\xb2\xd0\xb0\xd0\xbd\xd0\xb8\xd1\x8f." "*special problem,*special problem" -999
716B "Complete the Word" "ZS the Coder loves to read the dictionary. He thinks that a word is nice if there exists a substring (contiguous segment of letters) of it of length 26 where each letter of English alphabet appears exactly once. In particular, if the string has length strictly less than 26, no such substring exists and thus it is not nice.Now, ZS the Coder tells you a word, where some of its letters are missing as he forgot them. He wants to determine if it is possible to fill in the missing letters so that the resulting word is nice. If it is possible, he needs you to find an example of such a word as well. Can you help him?" "greedy,two pointers" 1300
314E "Sereja and Squares" "Sereja painted n points on the plane, point number i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) has coordinates (i,\xe2\x80\x890). Then Sereja marked each point with a small or large English letter. Sereja don\'t like letter ""x"", so he didn\'t use it to mark points. Sereja thinks that the points are marked beautifully if the following conditions holds:  all points can be divided into pairs so that each point will belong to exactly one pair;  in each pair the point with the lesser abscissa will be marked with a small English letter and the point with the larger abscissa will be marked with the same large English letter;  if we built a square on each pair, the pair\'s points will be the square\'s opposite points and the segment between them will be the square\'s diagonal, then among the resulting squares there won\'t be any intersecting or touching ones. Little Petya erased some small and all large letters marking the points. Now Sereja wonders how many ways are there to return the removed letters so that the points were marked beautifully." dp 2900
391F2 "Stock Trading" "This problem consists of three subproblems: for solving subproblem F1 you will receive 8 points, for solving subproblem F2 you will receive 15 points, and for solving subproblem F3 you will receive 10 points.Manao has developed a model to predict the stock price of a company over the next n days and wants to design a profit-maximizing trading algorithm to make use of these predictions. Unfortunately, Manao\'s trading account has the following restrictions:   It only allows owning either zero or one shares of stock at a time;  It only allows buying or selling a share of this stock once per day;  It allows a maximum of k buy orders over the next n days; For the purposes of this problem, we define a trade to a be the act of buying one share of stock on day i, then holding the stock until some day j\xe2\x80\x89>\xe2\x80\x89i at which point the share is sold. To restate the above constraints, Manao is permitted to make at most k non-overlapping trades during the course of an n-day trading period for which Manao\'s model has predictions about the stock price.Even though these restrictions limit the amount of profit Manao can make compared to what would be achievable with an unlimited number of trades or the ability to hold more than one share at a time, Manao still has the potential to make a lot of money because Manao\'s model perfectly predicts the daily price of the stock. For example, using this model, Manao could wait until the price is low, then buy one share and hold until the price reaches a high value, then sell for a profit, and repeat this process up to k times until n days have passed.Nevertheless, Manao is not satisfied by having a merely good trading algorithm, and wants to develop an optimal strategy for trading subject to these constraints. Help Manao achieve this goal by writing a program that will determine when to buy and sell stock to achieve the greatest possible profit during the n-day trading period subject to the above constraints." greedy -999
1475E "Advertising Agency" "Masha works in an advertising agency. In order to promote the new brand, she wants to conclude contracts with some bloggers. In total, Masha has connections of n different bloggers. Blogger numbered i has ai followers.Since Masha has a limited budget, she can only sign a contract with k different bloggers. Of course, Masha wants her ad to be seen by as many people as possible. Therefore, she must hire bloggers with the maximum total number of followers.Help her, find the number of ways to select k bloggers so that the total number of their followers is maximum possible. Two ways are considered different if there is at least one blogger in the first way, which is not in the second way. Masha believes that all bloggers have different followers (that is, there is no follower who would follow two different bloggers).For example, if n=4, k=3, a=[1,3,1,2], then Masha has two ways to select 3 bloggers with the maximum total number of followers:   conclude contracts with bloggers with numbers 1, 2 and 4. In this case, the number of followers will be equal to a1+a2+a4=6.  conclude contracts with bloggers with numbers 2, 3 and 4. In this case, the number of followers will be equal to a2+a3+a4=6. Since the answer can be quite large, output it modulo 109+7." combinatorics,math,sortings 1600
1184A1 "Heidi Learns Hashing (Easy)" "Melody Pond was stolen from her parents as a newborn baby by Madame Kovarian, to become a weapon of the Silence in their crusade against the Doctor. Madame Kovarian changed Melody\'s name to River Song, giving her a new identity that allowed her to kill the Eleventh Doctor.Heidi figured out that Madame Kovarian uses a very complicated hashing function in order to change the names of the babies she steals. In order to prevent this from happening to future Doctors, Heidi decided to prepare herself by learning some basic hashing techniques.The first hashing function she designed is as follows.Given two positive integers (x,y) she defines H(x,y):=x2+2xy+x+1.Now, Heidi wonders if the function is reversible. That is, given a positive integer r, can you find a pair (x,y) (of positive integers) such that H(x,y)=r?If multiple such pairs exist, output the one with smallest possible x. If there is no such pair, output ""NO""." "brute force,math,number theory" 1200
862C "Mahmoud and Ehab and the xor" "Mahmoud and Ehab are on the third stage of their adventures now. As you know, Dr. Evil likes sets. This time he won\'t show them any set from his large collection, but will ask them to create a new set to replenish his beautiful collection of sets.Dr. Evil has his favorite evil integer x. He asks Mahmoud and Ehab to find a set of n distinct non-negative integers such the bitwise-xor sum of the integers in it is exactly x. Dr. Evil doesn\'t like big numbers, so any number in the set shouldn\'t be greater than 106." "constructive algorithms" 1900
487C "Prefix Product Sequence" "Consider a sequence [a1,\xe2\x80\x89a2,\xe2\x80\x89... ,\xe2\x80\x89an]. Define its prefix product sequence .Now given n, find a permutation of [1,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89n], such that its prefix product sequence is a permutation of [0,\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x891]." "constructive algorithms,math,number theory" 2300
1599E "Two Arrays" "You are given two integer arrays of length N, A1 and A2. You are also given Q queries of 4 types: 1 k l r x: set Aki:=min(Aki,x) for each l\xe2\x89\xa4i\xe2\x89\xa4r.2 k l r x: set Aki:=max(Aki,x) for each l\xe2\x89\xa4i\xe2\x89\xa4r.3 k l r x: set Aki:=Aki+x for each l\xe2\x89\xa4i\xe2\x89\xa4r.4 l r: find the (\xe2\x88\x91ri=lF(A1i+A2i))%(109+7) where F(k) is the k-th Fibonacci number (F(0)=0,F(1)=1,F(k)=F(k\xe2\x88\x921)+F(k\xe2\x88\x922)), and x%y denotes the remainder of the division of x by y.You should process these queries and answer each query of the fourth type." "data structures,matrices" 3200
730A "Toda 2" "A group of n friends enjoys playing popular video game Toda 2. There is a rating system describing skill level of each player, initially the rating of the i-th friend is ri.The friends decided to take part in the championship as a team. But they should have equal ratings to be allowed to compose a single team consisting of all n friends. So the friends are faced with the problem: how to make all their ratings equal.One way to change ratings is to willingly lose in some matches. Friends can form a party consisting of two to five (but not more than n) friends and play a match in the game. When the party loses, the rating of each of its members decreases by 1. A rating can\'t become negative, so ri\xe2\x80\x89=\xe2\x80\x890 doesn\'t change after losing.The friends can take part in multiple matches, each time making a party from any subset of friends (but remember about constraints on party size: from 2 to 5 members).The friends want to make their ratings equal but as high as possible.Help the friends develop a strategy of losing the matches so that all their ratings become equal and the resulting rating is maximum possible." greedy,implementation 1800
1989E "Distance to Different" "Consider an array a of n integers, where every element is from 1 to k, and every integer from 1 to k appears at least once.Let the array b be constructed as follows: for the i-th element of a, bi is the distance to the closest element in a which is not equal to ai. In other words, bi=minj\xe2\x88\x88[1,n],aj\xe2\x89\xa0ai|i\xe2\x88\x92j|.For example, if a=[1,1,2,3,3,3,3,1], then b=[2,1,1,1,2,2,1,1].Calculate the number of different arrays b you can obtain if you consider all possible arrays a, and print it modulo 998244353." combinatorics,dp,math 2300
39A "C*++ Calculations" "C*++ language is quite similar to C++. The similarity manifests itself in the fact that the programs written in C*++ sometimes behave unpredictably and lead to absolutely unexpected effects. For example, let\'s imagine an arithmetic expression in C*++ that looks like this (expression is the main term):  expression ::= summand | expression\xe2\x80\x89+\xe2\x80\x89summand | expression\xe2\x80\x89-\xe2\x80\x89summand  summand ::= increment | coefficient*increment  increment ::= a++ | ++a  coefficient ::= 0|1|2|...|1000 For example, ""5*a++-3*++a+a++"" is a valid expression in C*++.Thus, we have a sum consisting of several summands divided by signs ""+"" or ""-"". Every summand is an expression ""a++"" or ""++a"" multiplied by some integer coefficient. If the coefficient is omitted, it is suggested being equal to 1.The calculation of such sum in C*++ goes the following way. First all the summands are calculated one after another, then they are summed by the usual arithmetic rules. If the summand contains ""a++"", then during the calculation first the value of the ""a"" variable is multiplied by the coefficient, then value of ""a"" is increased by 1. If the summand contains ""++a"", then the actions on it are performed in the reverse order: first ""a"" is increased by 1, then \xe2\x80\x94 multiplied by the coefficient.The summands may be calculated in any order, that\'s why sometimes the result of the calculation is completely unpredictable! Your task is to find its largest possible value." "expression parsing,greedy" 2000
1337A "Ichihime and Triangle" "Ichihime is the current priestess of the Mahjong Soul Temple. She claims to be human, despite her cat ears.These days the temple is holding a math contest. Usually, Ichihime lacks interest in these things, but this time the prize for the winner is her favorite \xe2\x80\x94 cookies. Ichihime decides to attend the contest. Now she is solving the following problem. You are given four positive integers a, b, c, d, such that a\xe2\x89\xa4b\xe2\x89\xa4c\xe2\x89\xa4d. Your task is to find three integers x, y, z, satisfying the following conditions: a\xe2\x89\xa4x\xe2\x89\xa4b. b\xe2\x89\xa4y\xe2\x89\xa4c. c\xe2\x89\xa4z\xe2\x89\xa4d. There exists a triangle with a positive non-zero area and the lengths of its three sides are x, y, and z.Ichihime desires to get the cookie, but the problem seems too hard for her. Can you help her?" "constructive algorithms,math" 800
354B "Game with Strings" "Given an n\xe2\x80\x89\xc3\x97\xe2\x80\x89n table T consisting of lowercase English letters. We\'ll consider some string s good if the table contains a correct path corresponding to the given string. In other words, good strings are all strings we can obtain by moving from the left upper cell of the table only to the right and down. Here\'s the formal definition of correct paths:Consider rows of the table are numbered from 1 to n from top to bottom, and columns of the table are numbered from 1 to n from left to the right. Cell (r,\xe2\x80\x89c) is a cell of table T on the r-th row and in the c-th column. This cell corresponds to letter Tr,\xe2\x80\x89c.A path of length k is a sequence of table cells [(r1,\xe2\x80\x89c1),\xe2\x80\x89(r2,\xe2\x80\x89c2),\xe2\x80\x89...,\xe2\x80\x89(rk,\xe2\x80\x89ck)]. The following paths are correct:   There is only one correct path of length 1, that is, consisting of a single cell: [(1,\xe2\x80\x891)];  Let\'s assume that [(r1,\xe2\x80\x89c1),\xe2\x80\x89...,\xe2\x80\x89(rm,\xe2\x80\x89cm)] is a correct path of length m, then paths [(r1,\xe2\x80\x89c1),\xe2\x80\x89...,\xe2\x80\x89(rm,\xe2\x80\x89cm),\xe2\x80\x89(rm\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89cm)] and [(r1,\xe2\x80\x89c1),\xe2\x80\x89...,\xe2\x80\x89(rm,\xe2\x80\x89cm),\xe2\x80\x89(rm,\xe2\x80\x89cm\xe2\x80\x89+\xe2\x80\x891)] are correct paths of length m\xe2\x80\x89+\xe2\x80\x891. We should assume that a path [(r1,\xe2\x80\x89c1),\xe2\x80\x89(r2,\xe2\x80\x89c2),\xe2\x80\x89...,\xe2\x80\x89(rk,\xe2\x80\x89ck)] corresponds to a string of length k: Tr1,\xe2\x80\x89c1\xe2\x80\x89+\xe2\x80\x89Tr2,\xe2\x80\x89c2\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89Trk,\xe2\x80\x89ck.Two players play the following game: initially they have an empty string. Then the players take turns to add a letter to the end of the string. After each move (adding a new letter) the resulting string must be good. The game ends after 2n\xe2\x80\x89-\xe2\x80\x891 turns. A player wins by the following scenario:   If the resulting string has strictly more letters ""a"" than letters ""b"", then the first player wins;  If the resulting string has strictly more letters ""b"" than letters ""a"", then the second player wins;  If the resulting string has the same number of letters ""a"" and ""b"", then the players end the game with a draw. Your task is to determine the result of the game provided that both players played optimally well." bitmasks,dp,games 2400
1553A "Digits Sum" "Let\'s define S(x) to be the sum of digits of number x written in decimal system. For example, S(5)=5, S(10)=1, S(322)=7.We will call an integer x interesting if S(x+1)<S(x). In each test you will be given one integer n. Your task is to calculate the number of integers x such that 1\xe2\x89\xa4x\xe2\x89\xa4n and x is interesting." "math,number theory" 800
1176A "Divide it!" "You are given an integer n.You can perform any of the following operations with this number an arbitrary (possibly, zero) number of times:   Replace n with n2 if n is divisible by 2;  Replace n with 2n3 if n is divisible by 3;  Replace n with 4n5 if n is divisible by 5. For example, you can replace 30 with 15 using the first operation, with 20 using the second operation or with 24 using the third operation.Your task is to find the minimum number of moves required to obtain 1 from n or say that it is impossible to do it.You have to answer q independent queries." "brute force,greedy,implementation" 800
784F "Crunching Numbers Just for You" "You are developing a new feature for the website which sells airline tickets: being able to sort tickets by price! You have already extracted the tickets\' prices, so there\'s just the last step to be done...You are given an array of integers. Sort it in non-descending order." "*special problem,implementation" 1900
1549A "Gregor and Cryptography" "Gregor is learning about RSA cryptography, and although he doesn\'t understand how RSA works, he is now fascinated with prime numbers and factoring them.Gregor\'s favorite prime number is P. Gregor wants to find two bases of P. Formally, Gregor is looking for two integers a and b which satisfy both of the following properties.  Pmoda=Pmodb, where xmody denotes the remainder when x is divided by y, and  2\xe2\x89\xa4a<b\xe2\x89\xa4P. Help Gregor find two bases of his favorite prime number!" "math,number theory" 800
1795C "Tea Tasting" "A tea manufacturer decided to conduct a massive tea tasting. n sorts of tea will be tasted by n tasters. Both the sorts of tea and the tasters are numbered from 1 to n. The manufacturer prepared ai milliliters of the i-th sort of tea. The j-th taster can drink bj milliliters of tea at once.The tasting will be conducted in steps. During the first step, the i-th taster tastes the i-th sort of tea. The i-th taster drinks min(ai,bi) tea (how much is available of the i-th sort and how much the i-th taster can drink). ai also decreases by this amount.Then all tasters move to the previous sort of tea. Thus, during the second step, the i-th taster tastes the (i\xe2\x88\x921)-st sort of tea. The i-th taster drinks min(ai\xe2\x88\x921,bi) tea. The 1-st person ends the tasting.During the third step, the i-th taster tastes the (i\xe2\x88\x922)-nd sort of tea. The 2-nd taster ends the tasting. This goes on until everyone ends the tasting.Take a look at the tasting process for n=3, a=[10,20,15], b=[9,8,6]. In the left row, there are the current amounts of each sort of tea. In the right column, there are current amounts of tea each taster has drunk in total. The arrow tells which taster each tea goes to on the current step. The number on the arrow is the amount \xe2\x80\x94 minimum of how much is available of the sort of tea and how much the taster can drink.  For each taster, print how many milliliters of tea he/she will drink in total." "binary search,data structures,implementation" 1500
4B "Before an Exam" "Tomorrow Peter has a Biology exam. He does not like this subject much, but d days ago he learnt that he would have to take this exam. Peter\'s strict parents made him prepare for the exam immediately, for this purpose he has to study not less than minTimei and not more than maxTimei hours per each i-th day. Moreover, they warned Peter that a day before the exam they would check how he has followed their instructions.So, today is the day when Peter\'s parents ask him to show the timetable of his preparatory studies. But the boy has counted only the sum of hours sumTime spent him on preparation, and now he wants to know if he can show his parents a timetable s\xd1\x81hedule with d numbers, where each number s\xd1\x81hedulei stands for the time in hours spent by Peter each i-th day on biology studies, and satisfying the limitations imposed by his parents, and at the same time the sum total of all schedulei should equal to sumTime." "constructive algorithms,greedy" 1200
437A "The Child and Homework" "Once upon a time a child got a test consisting of multiple-choice questions as homework. A multiple-choice question consists of four choices: A, B, C and D. Each choice has a description, and the child should find out the only one that is correct.Fortunately the child knows how to solve such complicated test. The child will follow the algorithm:  If there is some choice whose description at least twice shorter than all other descriptions, or at least twice longer than all other descriptions, then the child thinks the choice is great.  If there is exactly one great choice then the child chooses it. Otherwise the child chooses C (the child think it is the luckiest choice). You are given a multiple-choice questions, can you predict child\'s choose?" implementation 1300
1296D "Fight with Monsters" "There are n monsters standing in a row numbered from 1 to n. The i-th monster has hi health points (hp). You have your attack power equal to a hp and your opponent has his attack power equal to b hp.You and your opponent are fighting these monsters. Firstly, you and your opponent go to the first monster and fight it till his death, then you and your opponent go the second monster and fight it till his death, and so on. A monster is considered dead if its hp is less than or equal to 0.The fight with a monster happens in turns.   You hit the monster by a hp. If it is dead after your hit, you gain one point and you both proceed to the next monster.  Your opponent hits the monster by b hp. If it is dead after his hit, nobody gains a point and you both proceed to the next monster. You have some secret technique to force your opponent to skip his turn. You can use this technique at most k times in total (for example, if there are two monsters and k=4, then you can use the technique 2 times on the first monster and 1 time on the second monster, but not 2 times on the first monster and 3 times on the second monster).Your task is to determine the maximum number of points you can gain if you use the secret technique optimally." greedy,sortings 1500
1531A "\xd0\x97\xd0\xb8\xd0\xbd\xd0\xb3\xd0\xb5\xd1\x80 | color" "\xd0\x9d\xd0\xb5\xd0\xbc\xd0\xbd\xd0\xbe\xd0\xb3\xd0\xb8\xd0\xb5 \xd0\xb7\xd0\xbd\xd0\xb0\xd1\x8e\xd1\x82, \xd1\x87\xd1\x82\xd0\xbe \xd1\x81\xd0\xbe\xd1\x82\xd1\x80\xd1\x83\xd0\xb4\xd0\xbd\xd0\xb8\xd0\xba\xd0\xb8 \xd0\x92\xd0\x9a\xd0\xbe\xd0\xbd\xd1\x82\xd0\xb0\xd0\xba\xd1\x82\xd0\xb5 \xd0\xbc\xd0\xbe\xd0\xb3\xd1\x83\xd1\x82 \xd0\xbc\xd0\xb5\xd0\xbd\xd1\x8f\xd1\x82\xd1\x8c \xd1\x86\xd0\xb2\xd0\xb5\xd1\x82 \xd0\xbf\xd0\xbe\xd0\xb4\xd1\x81\xd0\xb2\xd0\xb5\xd1\x82\xd0\xba\xd0\xb8 \xd0\xb2 \xd0\xba\xd1\x83\xd0\xbf\xd0\xbe\xd0\xbb\xd0\xb5 \xd0\xb7\xd0\xbd\xd0\xb0\xd0\xbc\xd0\xb5\xd0\xbd\xd0\xb8\xd1\x82\xd0\xbe\xd0\xb3\xd0\xbe \xd0\x94\xd0\xbe\xd0\xbc\xd0\xb0 \xd0\x97\xd0\xb8\xd0\xbd\xd0\xb3\xd0\xb5\xd1\x80\xd0\xb0, \xd0\xb3\xd0\xb4\xd0\xb5 \xd1\x80\xd0\xb0\xd1\x81\xd0\xbf\xd0\xbe\xd0\xbb\xd0\xbe\xd0\xb6\xd0\xb5\xd0\xbd\xd0\xb0 \xd1\x88\xd1\x82\xd0\xb0\xd0\xb1-\xd0\xba\xd0\xb2\xd0\xb0\xd1\x80\xd1\x82\xd0\xb8\xd1\x80\xd0\xb0 \xd0\x92\xd0\x9a\xd0\xbe\xd0\xbd\xd1\x82\xd0\xb0\xd0\xba\xd1\x82\xd0\xb5. \xd0\x94\xd0\xbb\xd1\x8f \xd1\x8d\xd1\x82\xd0\xbe\xd0\xb3\xd0\xbe \xd0\xbd\xd1\x83\xd0\xb6\xd0\xbd\xd0\xbe \xd0\xb2\xd1\x81\xd0\xb5\xd0\xb3\xd0\xbe \xd0\xbb\xd0\xb8\xd1\x88\xd1\x8c \xd0\xbe\xd1\x82\xd0\xbf\xd1\x80\xd0\xb0\xd0\xb2\xd0\xb8\xd1\x82\xd1\x8c \xd1\x81\xd0\xbe\xd0\xbe\xd0\xb1\xd1\x89\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb5 \xd1\x81 \xd1\x86\xd0\xb2\xd0\xb5\xd1\x82\xd0\xbe\xd0\xbc \xd0\xb2 \xd1\x81\xd0\xbf\xd0\xb5\xd1\x86\xd0\xb8\xd0\xb0\xd0\xbb\xd1\x8c\xd0\xbd\xd1\x8b\xd0\xb9 \xd1\x87\xd0\xb0\xd1\x82 \xc2\xab\xd0\x97\xd0\xb8\xd0\xbd\xd0\xb3\xd0\xb5\xd1\x80 | color\xc2\xbb, \xd0\xb0 \xd0\xb1\xd0\xbe\xd1\x82 \xd0\xb5\xd0\xb3\xd0\xbe \xd1\x80\xd0\xb0\xd1\x81\xd0\xbf\xd0\xbe\xd0\xb7\xd0\xbd\xd0\xb0\xd0\xb5\xd1\x82 \xd0\xb8 \xd1\x81\xd0\xbc\xd0\xb5\xd0\xbd\xd0\xb8\xd1\x82 \xd0\xbf\xd0\xbe\xd0\xb4\xd1\x81\xd0\xb2\xd0\xb5\xd1\x82\xd0\xba\xd1\x83. \xd0\x9f\xd1\x80\xd0\xb8 \xd1\x8d\xd1\x82\xd0\xbe\xd0\xbc \xd0\xbd\xd0\xb0 \xd0\xb2\xd1\x80\xd0\xb5\xd0\xbc\xd1\x8f \xd0\xb3\xd0\xbe\xd1\x80\xd0\xbe\xd0\xb4\xd1\x81\xd0\xba\xd0\xb8\xd1\x85 \xd0\xbc\xd0\xb5\xd1\x80\xd0\xbe\xd0\xbf\xd1\x80\xd0\xb8\xd1\x8f\xd1\x82\xd0\xb8\xd0\xb9 \xd1\x81\xd0\xbc\xd0\xb5\xd0\xbd\xd0\xb0 \xd1\x86\xd0\xb2\xd0\xb5\xd1\x82\xd0\xb0 \xd0\xb1\xd0\xbb\xd0\xbe\xd0\xba\xd0\xb8\xd1\x80\xd1\x83\xd0\xb5\xd1\x82\xd1\x81\xd1\x8f.\xd0\xa4\xd0\xbe\xd1\x80\xd0\xbc\xd0\xb0\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe, \xd0\xb1\xd0\xbe\xd1\x82 \xd0\xbe\xd0\xb1\xd1\x80\xd0\xb0\xd0\xb1\xd0\xb0\xd1\x82\xd1\x8b\xd0\xb2\xd0\xb0\xd0\xb5\xd1\x82 \xd1\x82\xd1\x80\xd0\xb8 \xd1\x82\xd0\xb8\xd0\xbf\xd0\xb0 \xd1\x81\xd0\xbe\xd0\xbe\xd0\xb1\xd1\x89\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb9:   lock: \xd0\xb7\xd0\xb0\xd0\xb1\xd0\xbb\xd0\xbe\xd0\xba\xd0\xb8\xd1\x80\xd0\xbe\xd0\xb2\xd0\xb0\xd1\x82\xd1\x8c \xd0\xb8\xd0\xb7\xd0\xbc\xd0\xb5\xd0\xbd\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb5 \xd1\x86\xd0\xb2\xd0\xb5\xd1\x82\xd0\xb0. \xd0\x95\xd1\x81\xd0\xbb\xd0\xb8 \xd0\xbe\xd0\xbd\xd0\xbe \xd0\xb8 \xd1\x82\xd0\xb0\xd0\xba \xd0\xb7\xd0\xb0\xd0\xb1\xd0\xbb\xd0\xbe\xd0\xba\xd0\xb8\xd1\x80\xd0\xbe\xd0\xb2\xd0\xb0\xd0\xbd\xd0\xbe \xd0\xbd\xd0\xb0 \xd0\xb4\xd0\xb0\xd0\xbd\xd0\xbd\xd1\x8b\xd0\xb9 \xd0\xbc\xd0\xbe\xd0\xbc\xd0\xb5\xd0\xbd\xd1\x82, \xd1\x81\xd0\xbe\xd0\xbe\xd0\xb1\xd1\x89\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb5 \xd0\xb8\xd0\xb3\xd0\xbd\xd0\xbe\xd1\x80\xd0\xb8\xd1\x80\xd1\x83\xd0\xb5\xd1\x82\xd1\x81\xd1\x8f.  unlock: \xd1\x80\xd0\xb0\xd0\xb7\xd0\xb1\xd0\xbb\xd0\xbe\xd0\xba\xd0\xb8\xd1\x80\xd0\xbe\xd0\xb2\xd0\xb0\xd1\x82\xd1\x8c \xd0\xb8\xd0\xb7\xd0\xbc\xd0\xb5\xd0\xbd\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb5 \xd1\x86\xd0\xb2\xd0\xb5\xd1\x82\xd0\xb0. \xd0\x95\xd1\x81\xd0\xbb\xd0\xb8 \xd0\xbe\xd0\xbd\xd0\xbe \xd0\xb8 \xd1\x82\xd0\xb0\xd0\xba \xd1\x80\xd0\xb0\xd0\xb7\xd0\xb1\xd0\xbb\xd0\xbe\xd0\xba\xd0\xb8\xd1\x80\xd0\xbe\xd0\xb2\xd0\xb0\xd0\xbd\xd0\xbe \xd0\xbd\xd0\xb0 \xd0\xb4\xd0\xb0\xd0\xbd\xd0\xbd\xd1\x8b\xd0\xb9 \xd0\xbc\xd0\xbe\xd0\xbc\xd0\xb5\xd0\xbd\xd1\x82, \xd1\x81\xd0\xbe\xd0\xbe\xd0\xb1\xd1\x89\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb5 \xd0\xb8\xd0\xb3\xd0\xbd\xd0\xbe\xd1\x80\xd0\xb8\xd1\x80\xd1\x83\xd0\xb5\xd1\x82\xd1\x81\xd1\x8f.  red / orange / yellow / green / blue / indigo / violet: \xd0\xb8\xd0\xb7\xd0\xbc\xd0\xb5\xd0\xbd\xd0\xb8\xd1\x82\xd1\x8c \xd1\x86\xd0\xb2\xd0\xb5\xd1\x82 \xd0\xba\xd1\x83\xd0\xbf\xd0\xbe\xd0\xbb\xd0\xb0 \xd0\xbd\xd0\xb0 \xd0\xb7\xd0\xb0\xd0\xb4\xd0\xb0\xd0\xbd\xd0\xbd\xd1\x8b\xd0\xb9, \xd0\xb5\xd1\x81\xd0\xbb\xd0\xb8 \xd0\xb8\xd0\xb7\xd0\xbc\xd0\xb5\xd0\xbd\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb5 \xd1\x86\xd0\xb2\xd0\xb5\xd1\x82\xd0\xb0 \xd0\xbd\xd0\xb0 \xd0\xb4\xd0\xb0\xd0\xbd\xd0\xbd\xd1\x8b\xd0\xb9 \xd0\xbc\xd0\xbe\xd0\xbc\xd0\xb5\xd0\xbd\xd1\x82 \xd0\xbd\xd0\xb5 \xd0\xb7\xd0\xb0\xd0\xb1\xd0\xbb\xd0\xbe\xd0\xba\xd0\xb8\xd1\x80\xd0\xbe\xd0\xb2\xd0\xb0\xd0\xbd\xd0\xbe. \xd0\x92\xd0\xb0\xd0\xbc \xd0\xb4\xd0\xb0\xd0\xbd\xd0\xb0 \xd0\xb8\xd1\x81\xd1\x82\xd0\xbe\xd1\x80\xd0\xb8\xd1\x8f \xd1\x81\xd0\xbe\xd0\xbe\xd0\xb1\xd1\x89\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb9, \xd0\xbf\xd0\xbe\xd0\xbb\xd1\x83\xd1\x87\xd0\xb5\xd0\xbd\xd0\xbd\xd1\x8b\xd1\x85 \xd0\xb1\xd0\xbe\xd1\x82\xd0\xbe\xd0\xbc, \xd0\xb2 \xd1\x85\xd1\x80\xd0\xbe\xd0\xbd\xd0\xbe\xd0\xbb\xd0\xbe\xd0\xb3\xd0\xb8\xd1\x87\xd0\xb5\xd1\x81\xd0\xba\xd0\xbe\xd0\xbc \xd0\xbf\xd0\xbe\xd1\x80\xd1\x8f\xd0\xb4\xd0\xba\xd0\xb5. \xd0\xa1\xd1\x87\xd0\xb8\xd1\x82\xd0\xb0\xd0\xb9\xd1\x82\xd0\xb5, \xd1\x87\xd1\x82\xd0\xbe \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb5\xd0\xb4 \xd0\xbf\xd0\xbe\xd0\xbb\xd1\x83\xd1\x87\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb5\xd0\xbc \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb2\xd0\xbe\xd0\xb3\xd0\xbe \xd1\x81\xd0\xbe\xd0\xbe\xd0\xb1\xd1\x89\xd0\xb5\xd0\xbd\xd0\xb8\xd1\x8f \xd0\xba\xd1\x83\xd0\xbf\xd0\xbe\xd0\xbb \xd0\xbf\xd0\xbe\xd0\xb4\xd1\x81\xd0\xb2\xd0\xb5\xd1\x87\xd0\xb8\xd0\xb2\xd0\xb0\xd0\xb5\xd1\x82\xd1\x81\xd1\x8f \xd0\xb3\xd0\xbe\xd0\xbb\xd1\x83\xd0\xb1\xd1\x8b\xd0\xbc (blue), \xd0\xb0 \xd0\xb8\xd0\xb7\xd0\xbc\xd0\xb5\xd0\xbd\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb5 \xd1\x86\xd0\xb2\xd0\xb5\xd1\x82\xd0\xb0 \xd0\xbd\xd0\xb5 \xd0\xb7\xd0\xb0\xd0\xb1\xd0\xbb\xd0\xbe\xd0\xba\xd0\xb8\xd1\x80\xd0\xbe\xd0\xb2\xd0\xb0\xd0\xbd\xd0\xbe.\xd0\x9e\xd0\xbf\xd1\x80\xd0\xb5\xd0\xb4\xd0\xb5\xd0\xbb\xd0\xb8\xd1\x82\xd0\xb5, \xd0\xba\xd0\xb0\xd0\xba\xd0\xbe\xd0\xb9 \xd1\x86\xd0\xb2\xd0\xb5\xd1\x82 \xd0\xb1\xd1\x83\xd0\xb4\xd0\xb5\xd1\x82 \xd1\x83 \xd0\xba\xd1\x83\xd0\xbf\xd0\xbe\xd0\xbb\xd0\xb0 \xd0\x94\xd0\xbe\xd0\xbc\xd0\xb0 \xd0\x97\xd0\xb8\xd0\xbd\xd0\xb3\xd0\xb5\xd1\x80\xd0\xb0 \xd0\xbf\xd0\xbe\xd1\x81\xd0\xbb\xd0\xb5 \xd0\xbe\xd0\xb1\xd1\x80\xd0\xb0\xd0\xb1\xd0\xbe\xd1\x82\xd0\xba\xd0\xb8 \xd1\x8d\xd1\x82\xd0\xb8\xd1\x85 \xd1\x81\xd0\xbe\xd0\xbe\xd0\xb1\xd1\x89\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb9." "*special problem,implementation" -999
1777E "Edge Reverse" "You will be given a weighted directed graph of n nodes and m directed edges, where the i-th edge has a weight of wi (1\xe2\x89\xa4i\xe2\x89\xa4m).You need to reverse some edges of this graph so that there is at least one node in the graph from which every other node is reachable. The cost of these reversals is equal to the maximum weight of all reversed edges. If no edge reversal is required, assume the cost to be 0.It is guaranteed that no self-loop or duplicate edge exists.Find the minimum cost required for completing the task. If there is no solution, print a single integer \xe2\x88\x921." "binary search,dfs and similar,graphs,trees" 2200
671C "Ultimate Weirdness of an Array" "Yasin has an array a containing n integers. Yasin is a 5 year old, so he loves ultimate weird things.Yasin denotes weirdness of an array as maximum gcd(ai,\xe2\x80\x89\xe2\x80\x89aj) value among all 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n. For n\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x891 weirdness is equal to 0, gcd(x,\xe2\x80\x89\xe2\x80\x89y) is the greatest common divisor of integers x and y.He also defines the ultimate weirdness of an array. Ultimate weirdness is  where f(i,\xe2\x80\x89\xe2\x80\x89j) is weirdness of the new array a obtained by removing all elements between i and j inclusive, so new array is [a1... ai\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89aj\xe2\x80\x89+\xe2\x80\x891... an].Since 5 year old boys can\'t code, Yasin asks for your help to find the value of ultimate weirdness of the given array a!" "data structures,number theory" 2800
803C "Maximal GCD" "You are given positive integer number n. You should create such strictly increasing sequence of k positive numbers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89ak, that their sum is equal to n and greatest common divisor is maximal.Greatest common divisor of sequence is maximum of such numbers that every element of sequence is divisible by them.If there is no possible sequence then output -1." "constructive algorithms,greedy,math" 1900
193A "Cutting Figure" "You\'ve gotten an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m sheet of squared paper. Some of its squares are painted. Let\'s mark the set of all painted squares as A. Set A is connected. Your task is to find the minimum number of squares that we can delete from set A to make it not connected.A set of painted squares is called connected, if for every two squares a and b from this set there is a sequence of squares from the set, beginning in a and ending in b, such that in this sequence any square, except for the last one, shares a common side with the square that follows next in the sequence. An empty set and a set consisting of exactly one square are connected by definition." "constructive algorithms,graphs,trees" 1700
174C "Range Increments" "Polycarpus is an amateur programmer. Now he is analyzing a friend\'s program. He has already found there the function rangeIncrement(l, r), that adds 1 to each element of some array a for all indexes in the segment [l,\xe2\x80\x89r]. In other words, this function does the following: function rangeIncrement(l, r)    for i := l .. r do        a[i] = a[i] + 1Polycarpus knows the state of the array a after a series of function calls. He wants to determine the minimum number of function calls that lead to such state. In addition, he wants to find what function calls are needed in this case. It is guaranteed that the required number of calls does not exceed 105.Before calls of function rangeIncrement(l, r) all array elements equal zero." "data structures,greedy" 1800
993D "Compute Power" "You need to execute several tasks, each associated with number of processors it needs, and the compute power it will consume.You have sufficient number of analog computers, each with enough processors for any task. Each computer can execute up to one task at a time, and no more than two tasks total. The first task can be any, the second task on each computer must use strictly less power than the first. You will assign between 1 and 2 tasks to each computer. You will then first execute the first task on each computer, wait for all of them to complete, and then execute the second task on each computer that has two tasks assigned.If the average compute power per utilized processor (the sum of all consumed powers for all tasks presently running divided by the number of utilized processors) across all computers exceeds some unknown threshold during the execution of the first tasks, the entire system will blow up. There is no restriction on the second tasks execution. Find the lowest threshold for which it is possible.Due to the specifics of the task, you need to print the answer multiplied by 1000 and rounded up." "binary search,dp,greedy" 2500
650B "Image Preview" "Vasya\'s telephone contains n photos. Photo number 1 is currently opened on the phone. It is allowed to move left and right to the adjacent photo by swiping finger over the screen. If you swipe left from the first photo, you reach photo n. Similarly, by swiping right from the last photo you reach photo 1. It takes a seconds to swipe from photo to adjacent.For each photo it is known which orientation is intended for it \xe2\x80\x94 horizontal or vertical. Phone is in the vertical orientation and can\'t be rotated. It takes b second to change orientation of the photo.Vasya has T seconds to watch photos. He want to watch as many photos as possible. If Vasya opens the photo for the first time, he spends 1 second to notice all details in it. If photo is in the wrong orientation, he spends b seconds on rotating it before watching it. If Vasya has already opened the photo, he just skips it (so he doesn\'t spend any time for watching it or for changing its orientation). It is not allowed to skip unseen photos.Help Vasya find the maximum number of photos he is able to watch during T seconds." "binary search,brute force,dp,two pointers" 1900
1973C "Cat, Fox and Double Maximum" "Fox loves permutations! She came up with the following problem and asked Cat to solve it:You are given an even positive integer n and a permutation\xe2\x80\xa0 p of length n. The score of another permutation q of length n is the number of local maximums in the array a of length n, where ai=pi+qi for all i (1\xe2\x89\xa4i\xe2\x89\xa4n). In other words, the score of q is the number of i such that 1<i<n (note the strict inequalities), ai\xe2\x88\x921<ai, and ai>ai+1 (once again, note the strict inequalities). Find the permutation q that achieves the maximum score for given n and p. If there exist multiple such permutations, you can pick any of them.\xe2\x80\xa0 A permutation of length n is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array), and [1,3,4] is also not a permutation (n=3 but there is 4 in the array)." "constructive algorithms,greedy,implementation,math,sortings" 1700
780H "Intranet of Buses" "A new bus route is opened in the city . The route is a closed polygon line in the place, with all segments parallel to one of the axes. m buses will operate on the route. All buses move in a loop along the route in the same direction with equal constant velocities (stopping times are negligible in this problem).Buses start their movement in the first vertex of the route with equal interval. Suppose that T is the total time for a single bus to travel the whole loop of the route. Then, the bus 1 starts moving at time 0, the bus 2 starts at time T\xe2\x80\x89/\xe2\x80\x89m, the bus 3 starts at time 2T\xe2\x80\x89/\xe2\x80\x89m, and so on; finally, the bus m starts moving at time (m\xe2\x80\x89-\xe2\x80\x891)T\xe2\x80\x89/\xe2\x80\x89m. Thus, all intervals between pairs of consecutive buses (including the interval between the last and the first bus) are equal.Buses can communicate with each other via wireless transmitters of equal power. If the transmitters have power D, then only buses within distance D of each other can communicate.The buses are also equipped with a distributed system of schedule tracking. For all buses to stick to the schedule, the system has to synchronize the necessary data between all buses from time to time. At the moment of synchronization, the bus 1 communicates with the bus 2, the bus 2 \xe2\x80\x94 with bus 3, and so on; also, the bus m communicates with the bus 1.As a research employee, you are tasked with finding the smallest value of D such that it is possible to find a time moment to perform synchronization once all buses have started moving." "binary search,geometry,implementation,two pointers" 3100
1173A "Nauuo and Votes" "Nauuo is a girl who loves writing comments.One day, she posted a comment on Codeforces, wondering whether she would get upvotes or downvotes.It\'s known that there were x persons who would upvote, y persons who would downvote, and there were also another z persons who would vote, but you don\'t know whether they would upvote or downvote. Note that each of the x+y+z people would vote exactly one time.There are three different results: if there are more people upvote than downvote, the result will be ""+""; if there are more people downvote than upvote, the result will be ""-""; otherwise the result will be ""0"".Because of the z unknown persons, the result may be uncertain (i.e. there are more than one possible results). More formally, the result is uncertain if and only if there exist two different situations of how the z persons vote, that the results are different in the two situations.Tell Nauuo the result or report that the result is uncertain." greedy 800
643F "Bears and Juice" "There are n bears in the inn and p places to sleep. Bears will party together for some number of nights (and days).Bears love drinking juice. They don\'t like wine but they can\'t distinguish it from juice by taste or smell.A bear doesn\'t sleep unless he drinks wine. A bear must go to sleep a few hours after drinking a wine. He will wake up many days after the party is over.Radewoosh is the owner of the inn. He wants to put some number of barrels in front of bears. One barrel will contain wine and all other ones will contain juice. Radewoosh will challenge bears to find a barrel with wine.Each night, the following happens in this exact order:  Each bear must choose a (maybe empty) set of barrels. The same barrel may be chosen by many bears.  Each bear drinks a glass from each barrel he chose.  All bears who drink wine go to sleep (exactly those bears who chose a barrel with wine). They will wake up many days after the party is over. If there are not enough places to sleep then bears lose immediately. At the end, if it\'s sure where wine is and there is at least one awake bear then bears win (unless they have lost before because of the number of places to sleep).Radewoosh wants to allow bears to win. He considers q scenarios. In the i-th scenario the party will last for i nights. Then, let Ri denote the maximum number of barrels for which bears surely win if they behave optimally. Let\'s define . Your task is to find , where  denotes the exclusive or (also denoted as XOR).Note that the same barrel may be chosen by many bears and all of them will go to sleep at once." dp,math,meet-in-the-middle 2900
1969B "Shifts and Sorting" "Let\'s define a cyclic shift of some string s as a transformation from s1s2\xe2\x80\xa6sn\xe2\x88\x921sn into sns1s2\xe2\x80\xa6sn\xe2\x88\x921. In other words, you take one last character sn and place it before the first character while moving all other characters to the right.You are given a binary string s (a string consisting of only 0-s and/or 1-s).In one operation, you can choose any substring slsl+1\xe2\x80\xa6sr (1\xe2\x89\xa4l<r\xe2\x89\xa4|s|) and cyclically shift it. The cost of such operation is equal to r\xe2\x88\x92l+1 (or the length of the chosen substring).You can perform the given operation any number of times. What is the minimum total cost to make s sorted in non-descending order?" "constructive algorithms,greedy" 1000
1800G Symmetree "Kid was gifted a tree of n vertices with the root in the vertex 1. Since he really like symmetrical objects, Kid wants to find out if this tree is symmetrical.  For example, the trees in the picture above are symmetrical.   And the trees in this picture are not symmetrical. Formally, a tree is symmetrical if there exists an order of children such that:  The subtree of the leftmost child of the root is a mirror image of the subtree of the rightmost child;  the subtree of the second-left child of the root is a mirror image of the subtree of the second-right child of the root;  ...  if the number of children of the root is odd, then the subtree of the middle child should be symmetrical." "dfs and similar,hashing,implementation,trees" 2200
585A "Gennady the Dentist" "Gennady is one of the best child dentists in Berland. Today n children got an appointment with him, they lined up in front of his office.All children love to cry loudly at the reception at the dentist. We enumerate the children with integers from 1 to n in the order they go in the line. Every child is associated with the value of his cofidence pi. The children take turns one after another to come into the office; each time the child that is the first in the line goes to the doctor.While Gennady treats the teeth of the i-th child, the child is crying with the volume of vi. At that the confidence of the first child in the line is reduced by the amount of vi, the second one \xe2\x80\x94 by value vi\xe2\x80\x89-\xe2\x80\x891, and so on. The children in the queue after the vi-th child almost do not hear the crying, so their confidence remains unchanged.If at any point in time the confidence of the j-th child is less than zero, he begins to cry with the volume of dj and leaves the line, running towards the exit, without going to the doctor\'s office. At this the confidence of all the children after the j-th one in the line is reduced by the amount of dj.All these events occur immediately one after the other in some order. Some cries may lead to other cries, causing a chain reaction. Once in the hallway it is quiet, the child, who is first in the line, goes into the doctor\'s office.Help Gennady the Dentist to determine the numbers of kids, whose teeth he will cure. Print their numbers in the chronological order." "brute force,implementation" 1800
1267J "Just Arrange the Icons" "BerPhone X is almost ready for release with n applications being preinstalled on the phone. A category of an application characterizes a genre or a theme of this application (like ""game"", ""business"", or ""education""). The categories are given as integers between 1 and n, inclusive; the i-th application has category ci. You can choose m \xe2\x80\x94 the number of screens and s \xe2\x80\x94 the size of each screen. You need to fit all n icons of the applications (one icon representing one application) meeting the following requirements:  On each screen, all the icons must belong to applications of the same category (but different screens can contain icons of applications of the same category);  Each screen must be either completely filled with icons (the number of icons on the screen is equal to s) or almost filled with icons (the number of icons is equal to s\xe2\x88\x921). Your task is to find the minimal possible number of screens m." greedy,implementation,math 1800
2022C Gerrymandering "We all steal a little bit. But I have only one hand, while my adversaries have two.\xc3\x81lvaro Obreg\xc3\xb3n\xc3\x81lvaro and Jos\xc3\xa9 are the only candidates running for the presidency of Tepito, a rectangular grid of 2 rows and n columns, where each cell represents a house. It is guaranteed that n is a multiple of 3.Under the voting system of Tepito, the grid will be split into districts, which consist of any 3 houses that are connected\xe2\x88\x97. Each house will belong to exactly one district.Each district will cast a single vote. The district will vote for \xc3\x81lvaro or Jos\xc3\xa9 respectively if at least 2 houses in that district select them. Therefore, a total of 2n3 votes will be cast.As \xc3\x81lvaro is the current president, he knows exactly which candidate each house will select. If \xc3\x81lvaro divides the houses into districts optimally, determine the maximum number of votes he can get.\xe2\x88\x97A set of cells is connected if there is a path between any 2 cells that requires moving only up, down, left and right through cells in the set." dp,implementation 1800
1256E "Yet Another Division Into Teams" "There are n students at your university. The programming skill of the i-th student is ai. As a coach, you want to divide them into teams to prepare them for the upcoming ICPC finals. Just imagine how good this university is if it has 2\xe2\x8b\x85105 students ready for the finals!Each team should consist of at least three students. Each student should belong to exactly one team. The diversity of a team is the difference between the maximum programming skill of some student that belongs to this team and the minimum programming skill of some student that belongs to this team (in other words, if the team consists of k students with programming skills a[i1],a[i2],\xe2\x80\xa6,a[ik], then the diversity of this team is kmaxj=1a[ij]\xe2\x88\x92kminj=1a[ij]).The total diversity is the sum of diversities of all teams formed.Your task is to minimize the total diversity of the division of students and find the optimal way to divide the students." dp,greedy,sortings 2000
1001A "Generate plus state or minus state" "You are given a qubit in state  and an integer sign. Your task is to convert the given qubit to state  if sign\xe2\x80\x89=\xe2\x80\x891 or  if sign\xe2\x80\x89=\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x891." "*special problem" 1100
754C "Vladik and chat" "Recently Vladik discovered a new entertainment \xe2\x80\x94 coding bots for social networks. He would like to use machine learning in his bots so now he want to prepare some learning data for them.At first, he need to download t chats. Vladik coded a script which should have downloaded the chats, however, something went wrong. In particular, some of the messages have no information of their sender. It is known that if a person sends several messages in a row, they all are merged into a single message. It means that there could not be two or more messages in a row with the same sender. Moreover, a sender never mention himself in his messages.Vladik wants to recover senders of all the messages so that each two neighboring messages will have different senders and no sender will mention himself in his messages.He has no idea of how to do this, and asks you for help. Help Vladik to recover senders in each of the chats!" "brute force,constructive algorithms,dp,implementation,strings" 2200
444D "DZY Loves Strings" "DZY loves strings, and he enjoys collecting them.In China, many people like to use strings containing their names\' initials, for example: xyz, jcvb, dzy, dyh.Once DZY found a lucky string s. A lot of pairs of good friends came to DZY when they heard about the news. The first member of the i-th pair has name ai, the second one has name bi. Each pair wondered if there is a substring of the lucky string containing both of their names. If so, they want to find the one with minimum length, which can give them good luck and make their friendship last forever.Please help DZY for each pair find the minimum length of the substring of s that contains both ai and bi, or point out that such substring doesn\'t exist.A substring of s is a string slsl\xe2\x80\x89+\xe2\x80\x891... sr for some integers l,\xe2\x80\x89r (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|s|). The length of such the substring is (r\xe2\x80\x89-\xe2\x80\x89l\xe2\x80\x89+\xe2\x80\x891).A string p contains some another string q if there is a substring of p equal to q." "binary search,hashing,strings,two pointers" 2500
623E "Transforming Sequence" "Let\'s define the transformation P of a sequence of integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an as b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bn, where bi\xe2\x80\x89=\xe2\x80\x89a1 | a2 | ... | ai for all i\xe2\x80\x89=\xe2\x80\x891,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89n, where | is the bitwise OR operation.Vasya consequently applies the transformation P to all sequences of length n consisting of integers from 1 to 2k\xe2\x80\x89-\xe2\x80\x891 inclusive. He wants to know how many of these sequences have such property that their transformation is a strictly increasing sequence. Help him to calculate this number modulo 109\xe2\x80\x89+\xe2\x80\x897." combinatorics,dp,fft,math 3300
118D "Caesar\'s Legions" "Gaius Julius Caesar, a famous general, loved to line up his soldiers. Overall the army had n1 footmen and n2 horsemen. Caesar thought that an arrangement is not beautiful if somewhere in the line there are strictly more that k1 footmen standing successively one after another, or there are strictly more than k2 horsemen standing successively one after another. Find the number of beautiful arrangements of the soldiers. Note that all n1\xe2\x80\x89+\xe2\x80\x89n2 warriors should be present at each arrangement. All footmen are considered indistinguishable among themselves. Similarly, all horsemen are considered indistinguishable among themselves." dp 1700
476B "Dreamoon and WiFi" "Dreamoon is standing at the position 0 on a number line. Drazil is sending a list of commands through Wi-Fi to Dreamoon\'s smartphone and Dreamoon follows them.Each command is one of the following two types:   Go 1 unit towards the positive direction, denoted as \'+\'  Go 1 unit towards the negative direction, denoted as \'-\' But the Wi-Fi condition is so poor that Dreamoon\'s smartphone reports some of the commands can\'t be recognized and Dreamoon knows that some of them might even be wrong though successfully recognized. Dreamoon decides to follow every recognized command and toss a fair coin to decide those unrecognized ones (that means, he moves to the 1 unit to the negative or positive direction with the same probability 0.5). You are given an original list of commands sent by Drazil and list received by Dreamoon. What is the probability that Dreamoon ends in the position originally supposed to be final by Drazil\'s commands?" "bitmasks,brute force,combinatorics,dp,math,probabilities" 1300
1883G1 "Dances (Easy version)" "This is the easy version of the problem. The only difference is that in this version m=1.You are given two arrays of integers a1,a2,\xe2\x80\xa6,an and b1,b2,\xe2\x80\xa6,bn. Before applying any operations, you can reorder the elements of each array as you wish. Then, in one operation, you will perform both of the following actions, if the arrays are not empty: Choose any element from array a and remove it (all remaining elements are shifted to a new array a), Choose any element from array b and remove it (all remaining elements are shifted to a new array b).Let k be the final size of both arrays. You need to find the minimum number of operations required to satisfy ai<bi for all 1\xe2\x89\xa4i\xe2\x89\xa4k.This problem was too easy, so the problem author decided to make it more challenging. You are also given a positive integer m. Now, you need to find the sum of answers to the problem for m pairs of arrays (c[i],b), where 1\xe2\x89\xa4i\xe2\x89\xa4m. Array c[i] is obtained from a as follows: c[i]1=i, c[i]j=aj, for 2\xe2\x89\xa4j\xe2\x89\xa4n." "binary search,greedy,two pointers" 1400
402E "Strictly Positive Matrix" "You have matrix a of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89n. Let\'s number the rows of the matrix from 1 to n from top to bottom, let\'s number the columns from 1 to n from left to right. Let\'s use aij to represent the element on the intersection of the i-th row and the j-th column. Matrix a meets the following two conditions:   for any numbers i,\xe2\x80\x89j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i,\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) the following inequality holds: aij\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x890;  . Matrix b is strictly positive, if for any numbers i,\xe2\x80\x89j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i,\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) the inequality bij\xe2\x80\x89>\xe2\x80\x890 holds. You task is to determine if there is such integer k\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x891, that matrix ak is strictly positive." graphs,math 2200
1910F "Build Railway Stations" "Monocarp is playing a computer game where he\'s controlling an empire. An empire consists of n cities, connected by n\xe2\x88\x921 roads. The cities are numbered from 1 to n. It\'s possible to reach every city from every other one using the roads.Traversing every road takes 2 hours. However, that can be improved. Monocarp can build railway stations in no more than k cities. After they are built, all existing roads that connect two cities with railway stations get converted to railroads and become 1 hour to traverse.Let f(x,y) be the total time it takes to traverse the roads on the shortest path between cities x and y.Monocarp wants to build at most k railway stations in such a way that the following value is minimized: n\xe2\x88\x91v=1v\xe2\x88\x921\xe2\x88\x91u=1f(v,u) (the total time it takes to travel from every city to every other one). What the smallest value he can achieve?" "*special problem,greedy,trees" 2000
1622A "Construct a Rectangle" "There are three sticks with integer lengths l1,l2 and l3.You are asked to break exactly one of them into two pieces in such a way that:   both pieces have positive (strictly greater than 0) integer length;  the total length of the pieces is equal to the original length of the stick;  it\'s possible to construct a rectangle from the resulting four sticks such that each stick is used as exactly one of its sides. A square is also considered a rectangle.Determine if it\'s possible to do that." geometry,math 800
549H "Degenerate Matrix" "The determinant of a matrix 2\xe2\x80\x89\xc3\x97\xe2\x80\x892 is defined as follows:A matrix is called degenerate if its determinant is equal to zero. The norm ||A|| of a matrix A is defined as a maximum of absolute values of its elements.You are given a matrix . Consider any degenerate matrix B such that norm ||A\xe2\x80\x89-\xe2\x80\x89B|| is minimum possible. Determine ||A\xe2\x80\x89-\xe2\x80\x89B||." "binary search,math" 2100
1957B "A BIT of a Construction" "Given integers n and k, construct a sequence of n non-negative (i.e. \xe2\x89\xa50) integers a1,a2,\xe2\x80\xa6,an such that   n\xe2\x88\x91i=1ai=k  The number of 1s in the binary representation of a1|a2|\xe2\x80\xa6|an is maximized, where | denotes the bitwise OR operation." "bitmasks,constructive algorithms,greedy,implementation" 1100
86C "Genetic engineering" """Multidimensional spaces are completely out of style these days, unlike genetics problems"" \xe2\x80\x94 thought physicist Woll and changed his subject of study to bioinformatics. Analysing results of sequencing he faced the following problem concerning DNA sequences. We will further think of a DNA sequence as an arbitrary string of uppercase letters ""A"", ""C"", ""G"" and ""T"" (of course, this is a simplified interpretation).Let w be a long DNA sequence and s1,\xe2\x80\x89s2,\xe2\x80\x89...,\xe2\x80\x89sm \xe2\x80\x94 collection of short DNA sequences. Let us say that the collection filters w iff w can be covered with the sequences from the collection. Certainly, substrings corresponding to the different positions of the string may intersect or even cover each other. More formally: denote by |w| the length of w, let symbols of w be numbered from 1 to |w|. Then for each position i in w there exist pair of indices l,\xe2\x80\x89r (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|w|) such that the substring w[l ... r] equals one of the elements s1,\xe2\x80\x89s2,\xe2\x80\x89...,\xe2\x80\x89sm of the collection.Woll wants to calculate the number of DNA sequences of a given length filtered by a given collection, but he doesn\'t know how to deal with it. Help him! Your task is to find the number of different DNA sequences of length n filtered by the collection {si}.Answer may appear very large, so output it modulo 1000000009." "dp,string suffix structures,trees" 2500
542A "Place Your Ad Here" "Ivan Anatolyevich\'s agency is starting to become famous in the town. They have already ordered and made n TV commercial videos. Each video is made in a special way: the colors and the soundtrack are adjusted to the time of the day and the viewers\' mood. That\'s why the i-th video can only be shown within the time range of [li,\xe2\x80\x89ri] (it is not necessary to use the whole segment but the broadcast time should be within this segment).Now it\'s time to choose a TV channel to broadcast the commercial. Overall, there are m TV channels broadcasting in the city, the j-th one has cj viewers, and is ready to sell time [aj,\xe2\x80\x89bj] to broadcast the commercial.Ivan Anatolyevich is facing a hard choice: he has to choose exactly one video i and exactly one TV channel j to broadcast this video and also a time range to broadcast [x,\xe2\x80\x89y]. At that the time range should be chosen so that it is both within range [li,\xe2\x80\x89ri] and within range [aj,\xe2\x80\x89bj].Let\'s define the efficiency of the broadcast as value (y\xe2\x80\x89-\xe2\x80\x89x)\xc2\xb7cj \xe2\x80\x94 the total sum of time that all the viewers of the TV channel are going to spend watching the commercial. Help Ivan Anatolyevich choose the broadcast with the maximum efficiency!" "data structures,sortings" 2400
850A "Five Dimensional Points" "You are given set of n points in 5-dimensional space. The points are labeled from 1 to n. No two points coincide.We will call point a bad if there are different points b and c, not equal to a, from the given set such that angle between vectors  and  is acute (i.e. strictly less than ). Otherwise, the point is called good.The angle between vectors  and  in 5-dimensional space is defined as , where  is the scalar product and  is length of .Given the list of points, print the indices of the good points in ascending order." "brute force,geometry,math" 1700
76E Points "You are given N points on a plane. Write a program which will find the sum of squares of distances between all pairs of points." implementation,math 1700
802L "Send the Fool Further! (hard)" "Heidi is terrified by your estimate and she found it unrealistic that her friends would collaborate to drive her into debt. She expects that, actually, each person will just pick a random friend to send Heidi to. (This randomness assumption implies, however, that she can now visit the same friend an arbitrary number of times...) Moreover, if a person only has one friend in common with Heidi (i.e., if that person is in a leaf of the tree), then that person will not send Heidi back (so that Heidi\'s travel will end at some point).Heidi also found unrealistic the assumption that she can make all the travels in one day. Therefore now she assumes that every time she travels a route between two friends, she needs to buy a new ticket. She wants to know: how much should she expect to spend on the trips?For what it\'s worth, Heidi knows that Jenny has at least two friends." "dfs and similar,dp,math,trees" 2400
1512E "Permutation by Sum" "A permutation is a sequence of n integers from 1 to n, in which all the numbers occur exactly once. For example, [1], [3,5,2,1,4], [1,3,2] are permutations, and [2,3,2], [4,3,1], [0] are not.Polycarp was given four integers n, l, r (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n) and s (1\xe2\x89\xa4s\xe2\x89\xa4n(n+1)2) and asked to find a permutation p of numbers from 1 to n that satisfies the following condition:   s=pl+pl+1+\xe2\x80\xa6+pr. For example, for n=5, l=3, r=5, and s=8, the following permutations are suitable (not all options are listed):   p=[3,4,5,2,1];  p=[5,2,4,3,1];  p=[5,2,1,3,4].  But, for example, there is no permutation suitable for the condition above for n=4, l=1, r=1, and s=5.Help Polycarp, for the given n, l, r, and s, find a permutation of numbers from 1 to n that fits the condition above. If there are several suitable permutations, print any of them." "brute force,greedy,math" 1600
808B "Average Sleep Time" "It\'s been almost a week since Polycarp couldn\'t get rid of insomnia. And as you may already know, one week in Berland lasts k days!When Polycarp went to a doctor with his problem, the doctor asked him about his sleeping schedule (more specifically, the average amount of hours of sleep per week). Luckily, Polycarp kept records of sleep times for the last n days. So now he has a sequence a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an, where ai is the sleep time on the i-th day.The number of records is so large that Polycarp is unable to calculate the average value by himself. Thus he is asking you to help him with the calculations. To get the average Polycarp is going to consider k consecutive days as a week. So there will be n\xe2\x80\x89-\xe2\x80\x89k\xe2\x80\x89+\xe2\x80\x891 weeks to take into consideration. For example, if k\xe2\x80\x89=\xe2\x80\x892, n\xe2\x80\x89=\xe2\x80\x893 and a\xe2\x80\x89=\xe2\x80\x89[3,\xe2\x80\x894,\xe2\x80\x897], then the result is .You should write a program which will calculate average sleep times of Polycarp over all weeks." "data structures,implementation,math" 1300
1869B "2D Traveling" "Piggy lives on an infinite plane with the Cartesian coordinate system on it.There are n cities on the plane, numbered from 1 to n, and the first k cities are defined as major cities. The coordinates of the i-th city are (xi,yi).Piggy, as a well-experienced traveller, wants to have a relaxing trip after Zhongkao examination. Currently, he is in city a, and he wants to travel to city b by air. You can fly between any two cities, and you can visit several cities in any order while travelling, but the final destination must be city b.Because of active trade between major cities, it\'s possible to travel by plane between them for free. Formally, the price of an air ticket f(i,j) between two cities i and j is defined as follows:f(i,j)={0,if cities i and j are both major cities|xi\xe2\x88\x92xj|+|yi\xe2\x88\x92yj|,otherwisePiggy doesn\'t want to save time, but he wants to save money. So you need to tell him the minimum value of the total cost of all air tickets if he can take any number of flights." "geometry,math,shortest paths,sortings" 1100
1333F "Kate and imperfection" "Kate has a set S of n integers {1,\xe2\x80\xa6,n}. She thinks that imperfection of a subset M\xe2\x8a\x86S is equal to the maximum of gcd(a,b) over all pairs (a,b) such that both a and b are in M and a\xe2\x89\xa0b. Kate is a very neat girl and for each k\xe2\x88\x88{2,\xe2\x80\xa6,n} she wants to find a subset that has the smallest imperfection among all subsets in S of size k. There can be more than one subset with the smallest imperfection and the same size, but you don\'t need to worry about it. Kate wants to find all the subsets herself, but she needs your help to find the smallest possible imperfection for each size k, will name it Ik. Please, help Kate to find I2, I3, ..., In." "greedy,implementation,math,number theory,sortings,two pointers" 2200
244B "Undoubtedly Lucky Numbers" "Polycarpus loves lucky numbers. Everybody knows that lucky numbers are positive integers, whose decimal representation (without leading zeroes) contain only the lucky digits x and y. For example, if x\xe2\x80\x89=\xe2\x80\x894, and y\xe2\x80\x89=\xe2\x80\x897, then numbers 47, 744, 4 are lucky.Let\'s call a positive integer a undoubtedly lucky, if there are such digits x and y (0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x,\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x899), that the decimal representation of number a (without leading zeroes) contains only digits x and y.Polycarpus has integer n. He wants to know how many positive integers that do not exceed n, are undoubtedly lucky. Help him, count this number." "bitmasks,brute force,dfs and similar" 1600
1978B "New Bakery" "Bob decided to open a bakery. On the opening day, he baked n buns that he can sell. The usual price of a bun is a coins, but to attract customers, Bob organized the following promotion: Bob chooses some integer k (0\xe2\x89\xa4k\xe2\x89\xa4min(n,b)). Bob sells the first k buns at a modified price. In this case, the price of the i-th (1\xe2\x89\xa4i\xe2\x89\xa4k) sold bun is (b\xe2\x88\x92i+1) coins. The remaining (n\xe2\x88\x92k) buns are sold at a coins each.Note that k can be equal to 0. In this case, Bob will sell all the buns at a coins each.Help Bob determine the maximum profit he can obtain by selling all n buns." "binary search,greedy,math,ternary search" 800
443B "Kolya and Tandem Repeat" "Kolya got string s for his birthday, the string consists of small English letters. He immediately added k more characters to the right of the string.Then Borya came and said that the new string contained a tandem repeat of length l as a substring. How large could l be?See notes for definition of a tandem repeat." "brute force,implementation,strings" 1500
1391D 505 "A binary matrix is called good if every even length square sub-matrix has an odd number of ones. Given a binary matrix a consisting of n rows and m columns, determine the minimum number of cells you need to change to make it good, or report that there is no way to make it good at all. All the terms above have their usual meanings \xe2\x80\x94 refer to the Notes section for their formal definitions." "bitmasks,brute force,constructive algorithms,dp,greedy,implementation" 2000
41D Pawn "On some square in the lowest row of a chessboard a stands a pawn. It has only two variants of moving: upwards and leftwards or upwards and rightwards. The pawn can choose from which square of the lowest row it can start its journey. On each square lay from 0 to 9 peas. The pawn wants to reach the uppermost row having collected as many peas as possible. As there it will have to divide the peas between itself and its k brothers, the number of peas must be divisible by k\xe2\x80\x89+\xe2\x80\x891. Find the maximal number of peas it will be able to collect and which moves it should make to do it.The pawn cannot throw peas away or leave the board. When a pawn appears in some square of the board (including the first and last square of the way), it necessarily takes all the peas." dp 1900
1183A "Nearest Interesting Number" "Polycarp knows that if the sum of the digits of a number is divisible by 3, then the number itself is divisible by 3. He assumes that the numbers, the sum of the digits of which is divisible by 4, are also somewhat interesting. Thus, he considers a positive integer n interesting if its sum of digits is divisible by 4.Help Polycarp find the nearest larger or equal interesting number for the given number a. That is, find the interesting number n such that n\xe2\x89\xa5a and n is minimal." implementation 800
130G "CAPS LOCK ON" "You are given a string which consists of letters and other characters. Convert it to uppercase, i.e., replace all lowercase letters with corresponding uppercase ones. Keep the rest of characters unchanged." "*special problem" 1700
1916H2 "Matrix Rank (Hard Version)" "This is the hard version of the problem. The only differences between the two versions of this problem are the constraints on k. You can make hacks only if all versions of the problem are solved.You are given integers n, p and k. p is guaranteed to be a prime number. For each r from 0 to k, find the number of n\xc3\x97n matrices A of the field\xe2\x80\xa0 of integers modulo p such that the rank\xe2\x80\xa1 of A is exactly r. Since these values are big, you are only required to output them modulo 998244353.\xe2\x80\xa0 https://en.wikipedia.org/wiki/Field_(mathematics)\xe2\x80\xa1 https://en.wikipedia.org/wiki/Rank_(linear_algebra)" "combinatorics,dp,math,matrices,string suffix structures" 2700
853A Planning "Helen works in Metropolis airport. She is responsible for creating a departure schedule. There are n flights that must depart today, the i-th of them is planned to depart at the i-th minute of the day.Metropolis airport is the main transport hub of Metropolia, so it is difficult to keep the schedule intact. This is exactly the case today: because of technical issues, no flights were able to depart during the first k minutes of the day, so now the new departure schedule must be created.All n scheduled flights must now depart at different minutes between (k\xe2\x80\x89+\xe2\x80\x891)-th and (k\xe2\x80\x89+\xe2\x80\x89n)-th, inclusive. However, it\'s not mandatory for the flights to depart in the same order they were initially scheduled to do so \xe2\x80\x94 their order in the new schedule can be different. There is only one restriction: no flight is allowed to depart earlier than it was supposed to depart in the initial schedule.Helen knows that each minute of delay of the i-th flight costs airport ci burles. Help her find the order for flights to depart in the new schedule that minimizes the total cost for the airport." greedy 1500
1326B Maximums "Alicia has an array, a1,a2,\xe2\x80\xa6,an, of non-negative integers. For each 1\xe2\x89\xa4i\xe2\x89\xa4n, she has found a non-negative integer xi=max(0,a1,\xe2\x80\xa6,ai\xe2\x88\x921). Note that for i=1, xi=0.For example, if Alicia had the array a={0,1,2,0,3}, then x={0,0,1,2,2}.Then, she calculated an array, b1,b2,\xe2\x80\xa6,bn: bi=ai\xe2\x88\x92xi.For example, if Alicia had the array a={0,1,2,0,3}, b={0\xe2\x88\x920,1\xe2\x88\x920,2\xe2\x88\x921,0\xe2\x88\x922,3\xe2\x88\x922}={0,1,1,\xe2\x88\x922,1}.Alicia gives you the values b1,b2,\xe2\x80\xa6,bn and asks you to restore the values a1,a2,\xe2\x80\xa6,an. Can you help her solve the problem?" implementation,math 900
1910J "Two Colors" "You are given a tree consisting of n vertices. Some vertices of the tree are red, all other vertices are blue.Each edge of the tree has a positive weight. Let\'s define d(x,y) as the distance between the vertices x and y, i.\xe2\x80\x89e. the sum of weights of edges belonging to the simple path between x and y.For each vertex, you have to choose an integer vi. These integers should meet the following constraint: for every blue vertex b and every red vertex r, d(b,r)\xe2\x89\xa5vb+vr. You have to maximize the value of n\xe2\x88\x91i=1vi.Note that the values of vi are not necessarily positive." "*special problem" 2900
1868D "Flower-like Pseudotree" "A pseudotree is a connected graph which has exactly one cycle and no self-loops. Note that a pseudotree may contain multiple-edges. It can be shown that a pseudotree with n vertices always contains n edges.After deleting all edges on the cycle in the pseudotree, a forest\xe2\x80\xa0 will be formed. It can be shown that each tree in the forest will contain exactly one vertex which is on cycle before removing the edges. If all trees in the forest have the same depth\xe2\x80\xa1 when picking the vertex on cycle as root, we call the original pseudotree flower-like.Our friend sszcdjr, had a flower-like pseudotree with n vertices and n edges. However, he forgot all the edges in the pseudotree. Fortunately, he still remembers the degrees of vertices. Specifically, the degree of the i-th vertex is di.You have to help sszcdjr construct a possible flower-like pseudotree with n vertices, where the degree of the i-th vertex is exactly di, or tell him that it is impossible.\xe2\x80\xa0 A forest is a graph in which all connectivity components are trees. A connected graph without cycles and self-loops is called a tree.\xe2\x80\xa1 The depth of a tree with a root is the maximum distance from the root to the vertex of this tree." "constructive algorithms,graphs,greedy,implementation,trees" 3000
1917F "Construct Tree" "You are given an array of integers l1,l2,\xe2\x80\xa6,ln and an integer d. Is it possible to construct a tree satisfying the following three conditions?  The tree contains n+1 nodes.  The length of the i-th edge is equal to li.  The (weighted) diameter of the tree is equal to d." "bitmasks,constructive algorithms,dp,trees" 2500
500D "New Year Santa Network" "New Year is coming in Tree World! In this world, as the name implies, there are n cities connected by n\xe2\x80\x89-\xe2\x80\x891 roads, and for any two distinct cities there always exists a path between them. The cities are numbered by integers from 1 to n, and the roads are numbered by integers from 1 to n\xe2\x80\x89-\xe2\x80\x891. Let\'s define d(u,\xe2\x80\x89v) as total length of roads on the path between city u and city v.As an annual event, people in Tree World repairs exactly one road per year. As a result, the length of one road decreases. It is already known that in the i-th year, the length of the ri-th road is going to become wi, which is shorter than its length before. Assume that the current year is year 1.Three Santas are planning to give presents annually to all the children in Tree World. In order to do that, they need some preparation, so they are going to choose three distinct cities c1, c2, c3 and make exactly one warehouse in each city. The k-th (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x893) Santa will take charge of the warehouse in city ck.It is really boring for the three Santas to keep a warehouse alone. So, they decided to build an only-for-Santa network! The cost needed to build this network equals to d(c1,\xe2\x80\x89c2)\xe2\x80\x89+\xe2\x80\x89d(c2,\xe2\x80\x89c3)\xe2\x80\x89+\xe2\x80\x89d(c3,\xe2\x80\x89c1) dollars. Santas are too busy to find the best place, so they decided to choose c1,\xe2\x80\x89c2,\xe2\x80\x89c3 randomly uniformly over all triples of distinct numbers from 1 to n. Santas would like to know the expected value of the cost needed to build the network.However, as mentioned, each year, the length of exactly one road decreases. So, the Santas want to calculate the expected after each length change. Help them to calculate the value." "combinatorics,dfs and similar,graphs,trees" 1900
799G "Cut the pie" "Arkady reached the n-th level in Township game, so Masha decided to bake a pie for him! Of course, the pie has a shape of convex n-gon, i.e. a polygon with n vertices.Arkady decided to cut the pie in two equal in area parts by cutting it by a straight line, so that he can eat one of them and give the other to Masha. There is a difficulty because Arkady has already put a knife at some point of the pie, so he now has to cut the pie by a straight line passing trough this point.Help Arkady: find a line that passes through the point Arkady has put a knife into and cuts the pie into two parts of equal area, or determine that it\'s impossible. Your program has to quickly answer many queries with the same pie, but different points in which Arkady puts a knife." "binary search,data structures,geometry" 3500
1742F Smaller "Alperen has two strings, s and t which are both initially equal to ""a"". He will perform q operations of two types on the given strings:  1kx \xe2\x80\x94 Append the string x exactly k times at the end of string s. In other words, s:=s+x+\xe2\x8b\xaf+x\xe2\x8f\x9fk times.  2kx \xe2\x80\x94 Append the string x exactly k times at the end of string t. In other words, t:=t+x+\xe2\x8b\xaf+x\xe2\x8f\x9fk times. After each operation, determine if it is possible to rearrange the characters of s and t such that s is lexicographically smaller\xe2\x80\xa0 than t.Note that the strings change after performing each operation and don\'t go back to their initial states.\xe2\x80\xa0 Simply speaking, the lexicographical order is the order in which words are listed in a dictionary. A formal definition is as follows: string p is lexicographically smaller than string q if there exists a position i such that pi<qi, and for all j<i, pj=qj. If no such i exists, then p is lexicographically smaller than q if the length of p is less than the length of q. For example, abdc<abe and abc<abcd, where we write p<q if p is lexicographically smaller than q." "constructive algorithms,greedy,strings" 1500
299B "Ksusha the Squirrel" "Ksusha the Squirrel is standing at the beginning of a straight road, divided into n sectors. The sectors are numbered 1 to n, from left to right. Initially, Ksusha stands in sector 1. Ksusha wants to walk to the end of the road, that is, get to sector n. Unfortunately, there are some rocks on the road. We know that Ksusha hates rocks, so she doesn\'t want to stand in sectors that have rocks.Ksusha the squirrel keeps fit. She can jump from sector i to any of the sectors i\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89i\xe2\x80\x89+\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89i\xe2\x80\x89+\xe2\x80\x89k. Help Ksusha! Given the road description, say if she can reach the end of the road (note, she cannot stand on a rock)?" "brute force,implementation" 900
915C "Permute Digits" "You are given two positive integer numbers a and b. Permute (change order) of the digits of a to construct maximal number not exceeding b. No number in input and/or output can start with the digit 0.It is allowed to leave a as it is." dp,greedy 1700
949A Zebras "Oleg writes down the history of the days he lived. For each day he decides if it was good or bad. Oleg calls a non-empty sequence of days a zebra, if it starts with a bad day, ends with a bad day, and good and bad days are alternating in it. Let us denote bad days as 0 and good days as 1. Then, for example, sequences of days 0, 010, 01010 are zebras, while sequences 1, 0110, 0101 are not.Oleg tells you the story of days he lived in chronological order in form of string consisting of 0 and 1. Now you are interested if it is possible to divide Oleg\'s life history into several subsequences, each of which is a zebra, and the way it can be done. Each day must belong to exactly one of the subsequences. For each of the subsequences, days forming it must be ordered chronologically. Note that subsequence does not have to be a group of consecutive days." greedy 1600
169B "Replacing Digits" "You are given an integer a that consists of n digits. You are also given a sequence of digits s of length m. The digit in position j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m) of sequence s means that you can choose an arbitrary position i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) in a and replace the digit in the chosen position i with sj. Each element in the sequence s can participate in no more than one replacing operation.Your task is to perform such sequence of replacements, that the given number a gets maximum value. You are allowed to use not all elements from s." greedy 1100
1045G "AI robots" "In the last mission, MDCS has successfully shipped N AI robots to Mars. Before they start exploring, system initialization is required so they are arranged in a line. Every robot can be described with three numbers: position (xi), radius of sight (ri) and IQ (qi).Since they are intelligent robots, some of them will talk if they see each other. Radius of sight is inclusive, so robot can see other all robots in range [xi\xe2\x88\x92ri,xi+ri]. But they don\'t walk to talk with anybody, but only with robots who have similar IQ. By similar IQ we mean that their absolute difference isn\'t more than K.  Help us and calculate how many pairs of robots are going to talk with each other, so we can timely update their software and avoid any potential quarrel." "data structures" 2200
876A "Trip For Meal" "Winnie-the-Pooh likes honey very much! That is why he decided to visit his friends. Winnie has got three best friends: Rabbit, Owl and Eeyore, each of them lives in his own house. There are winding paths between each pair of houses. The length of a path between Rabbit\'s and Owl\'s houses is a meters, between Rabbit\'s and Eeyore\'s house is b meters, between Owl\'s and Eeyore\'s house is c meters.For enjoying his life and singing merry songs Winnie-the-Pooh should have a meal n times a day. Now he is in the Rabbit\'s house and has a meal for the first time. Each time when in the friend\'s house where Winnie is now the supply of honey is about to end, Winnie leaves that house. If Winnie has not had a meal the required amount of times, he comes out from the house and goes to someone else of his two friends. For this he chooses one of two adjacent paths, arrives to the house on the other end and visits his friend. You may assume that when Winnie is eating in one of his friend\'s house, the supply of honey in other friend\'s houses recover (most probably, they go to the supply store).Winnie-the-Pooh does not like physical activity. He wants to have a meal n times, traveling minimum possible distance. Help him to find this distance." math 900
1946D "Birthday Gift" "Yarik\'s birthday is coming soon, and Mark decided to give him an array a of length n.Mark knows that Yarik loves bitwise operations very much, and he also has a favorite number x, so Mark wants to find the maximum number k such that it is possible to select pairs of numbers [l1,r1], [l2,r2], \xe2\x80\xa6 [lk,rk], such that:   l1=1.  rk=n.  li\xe2\x89\xa4ri for all i from 1 to k.  ri+1=li+1 for all i from 1 to k\xe2\x88\x921.  (al1\xe2\x8a\x95al1+1\xe2\x8a\x95\xe2\x80\xa6\xe2\x8a\x95ar1)|(al2\xe2\x8a\x95al2+1\xe2\x8a\x95\xe2\x80\xa6\xe2\x8a\x95ar2)|\xe2\x80\xa6|(alk\xe2\x8a\x95alk+1\xe2\x8a\x95\xe2\x80\xa6\xe2\x8a\x95ark)\xe2\x89\xa4x, where \xe2\x8a\x95 denotes the operation of bitwise XOR, and | denotes the operation of bitwise OR. If such k does not exist, then output \xe2\x88\x921." "bitmasks,brute force,constructive algorithms,greedy,implementation" 1900
105C "Item World" "Each item in the game has a level. The higher the level is, the higher basic parameters the item has. We shall consider only the following basic parameters: attack (atk), defense (def) and resistance to different types of impact (res).Each item belongs to one class. In this problem we will only consider three of such classes: weapon, armor, orb.Besides, there\'s a whole new world hidden inside each item. We can increase an item\'s level travelling to its world. We can also capture the so-called residents in the Item WorldResidents are the creatures that live inside items. Each resident gives some bonus to the item in which it is currently located. We will only consider residents of types: gladiator (who improves the item\'s atk), sentry (who improves def) and physician (who improves res).Each item has the size parameter. The parameter limits the maximum number of residents that can live inside an item. We can move residents between items. Within one moment of time we can take some resident from an item and move it to some other item if it has a free place for a new resident. We cannot remove a resident from the items and leave outside \xe2\x80\x94 any of them should be inside of some item at any moment of time.Laharl has a certain number of items. He wants to move the residents between items so as to equip himself with weapon, armor and a defensive orb. The weapon\'s atk should be largest possible in the end. Among all equipping patterns containing weapon\'s maximum atk parameter we should choose the ones where the armor\xe2\x80\x99s def parameter is the largest possible. Among all such equipment patterns we should choose the one where the defensive orb would have the largest possible res parameter. Values of the parameters def and res of weapon, atk and res of armor and atk and def of orb are indifferent for Laharl.Find the optimal equipment pattern Laharl can get." "brute force,implementation,sortings" 2200
1137C "Museums Tour" "In the country N, there are n cities connected by m one-way roads. Although this country seems unremarkable, there are two interesting facts about it. At first, a week lasts d days here. At second, there is exactly one museum in each city of the country N.Travel agency ""Open museums"" is developing a new program for tourists interested in museums. Agency\'s employees know which days each of the museums is open. The tour should start in the capital \xe2\x80\x94 the city number 1, and the first day of the tour must be on the first day of a week. Each day a tourist will be in some city, watching the exposition in its museum (in case museum is open today), and by the end of the day, the tour either ends or the tourist goes into another city connected by a road with the current one. The road system of N is designed in such a way that traveling by a road always takes one night and also all the roads are one-way. It\'s allowed to visit a city multiple times during the trip.You should develop such route for the trip that the number of distinct museums, possible to visit during it, is maximum." dp,graphs,implementation 2500
138A "Literature Lesson" "Vera adores poems. All the poems Vera knows are divided into quatrains (groups of four lines) and in each quatrain some lines contain rhymes.Let\'s consider that all lines in the poems consist of lowercase Latin letters (without spaces). Letters ""a"", ""e"", ""i"", ""o"", ""u"" are considered vowels.Two lines rhyme if their suffixes that start from the k-th vowels (counting from the end) match. If a line has less than k vowels, then such line can\'t rhyme with any other line. For example, if k\xe2\x80\x89=\xe2\x80\x891, lines commit and hermit rhyme (the corresponding suffixes equal it), and if k\xe2\x80\x89=\xe2\x80\x892, they do not rhyme (ommit\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89ermit).Today on a literature lesson Vera learned that quatrains can contain four different schemes of rhymes, namely the following ones (the same letters stand for rhyming lines):   Clerihew (aabb);  Alternating (abab);  Enclosed (abba). If all lines of a quatrain pairwise rhyme, then the quatrain can belong to any rhyme scheme (this situation is represented by aaaa).If all quatrains of a poem belong to the same rhyme scheme, then we can assume that the whole poem belongs to this rhyme scheme. If in each quatrain all lines pairwise rhyme, then the rhyme scheme of the poem is aaaa. Let us note that it doesn\'t matter whether lines from different quatrains rhyme with each other or not. In other words, it is possible that different quatrains aren\'t connected by a rhyme.Vera got a long poem as a home task. The girl has to analyse it and find the poem rhyme scheme. Help Vera cope with the task." implementation 1600
1761C "Set Construction" "You are given a binary matrix b (all elements of the matrix are 0 or 1) of n rows and n columns.You need to construct a n sets A1,A2,\xe2\x80\xa6,An, for which the following conditions are satisfied:  Each set is nonempty and consists of distinct integers between 1 and n inclusive.  All sets are distinct.  For all pairs (i,j) satisfying 1\xe2\x89\xa4i,j\xe2\x89\xa4n, bi,j=1 if and only if Ai\xe2\x8a\x8aAj. In other words, bi,j is 1 if Ai is a proper subset of Aj and 0 otherwise. Set X is a proper subset of set Y, if X is a nonempty subset of Y, and X\xe2\x89\xa0Y.It\'s guaranteed that for all test cases in this problem, such n sets exist. Note that it doesn\'t mean that such n sets exist for all possible inputs.If there are multiple solutions, you can output any of them." "constructive algorithms,dfs and similar,graphs,greedy" 1400
1910A Username "On the official website of Berland, each account has two parameters: username and ID.Username is a string consisting of lowercase Latin letters and/or digits, which contains at least one letter. For example, user0, 1fox1, zzzz are correct usernames, but 1337 and User22 are not. The ID of the account for a given username is generated as follows: a positive integer without leading zeroes is appended to the end of the username. For example, the ID user0125 can be generated by the following usernames: user012, user01, user0; but neither by user nor us.You are given a string s \xe2\x80\x94 a valid ID. Your task is to determine any valid username that can generate the given ID. If there are several correct usernames, you can print any of them." "*special problem,implementation" 1100
1102A "Integer Sequence Dividing" "You are given an integer sequence 1,2,\xe2\x80\xa6,n. You have to divide it into two sets A and B in such a way that each element belongs to exactly one set and |sum(A)\xe2\x88\x92sum(B)| is minimum possible.The value |x| is the absolute value of x and sum(S) is the sum of elements of the set S." math 800
1249B2 "Books Exchange (hard version)" "The only difference between easy and hard versions is constraints.There are n kids, each of them is reading a unique book. At the end of any day, the i-th kid will give his book to the pi-th kid (in case of i=pi the kid will give his book to himself). It is guaranteed that all values of pi are distinct integers from 1 to n (i.e. p is a permutation). The sequence p doesn\'t change from day to day, it is fixed.For example, if n=6 and p=[4,6,1,3,5,2] then at the end of the first day the book of the 1-st kid will belong to the 4-th kid, the 2-nd kid will belong to the 6-th kid and so on. At the end of the second day the book of the 1-st kid will belong to the 3-th kid, the 2-nd kid will belong to the 2-th kid and so on.Your task is to determine the number of the day the book of the i-th child is returned back to him for the first time for every i from 1 to n.Consider the following example: p=[5,1,2,4,3]. The book of the 1-st kid will be passed to the following kids:  after the 1-st day it will belong to the 5-th kid,  after the 2-nd day it will belong to the 3-rd kid,  after the 3-rd day it will belong to the 2-nd kid,  after the 4-th day it will belong to the 1-st kid. So after the fourth day, the book of the first kid will return to its owner. The book of the fourth kid will return to him for the first time after exactly one day.You have to answer q independent queries." "dfs and similar,dsu,math" 1300
1343C "Alternating Subsequence" "Recall that the sequence b is a a subsequence of the sequence a if b can be derived from a by removing zero or more elements without changing the order of the remaining elements. For example, if a=[1,2,1,3,1,2,1], then possible subsequences are: [1,1,1,1], [3] and [1,2,1,3,1,2,1], but not [3,2,3] and [1,1,1,1,2].You are given a sequence a consisting of n positive and negative elements (there is no zeros in the sequence).Your task is to choose maximum by size (length) alternating subsequence of the given sequence (i.e. the sign of each next element is the opposite from the sign of the current element, like positive-negative-positive and so on or negative-positive-negative and so on). Among all such subsequences, you have to choose one which has the maximum sum of elements.In other words, if the maximum length of alternating subsequence is k then your task is to find the maximum sum of elements of some alternating subsequence of length k.You have to answer t independent test cases." "dp,greedy,two pointers" 1200
1671B "Consecutive Points Segment" "You are given n points with integer coordinates on a coordinate axis OX. The coordinate of the i-th point is xi. All points\' coordinates are distinct and given in strictly increasing order.For each point i, you can do the following operation no more than once: take this point and move it by 1 to the left or to the right (i..e., you can change its coordinate xi to xi\xe2\x88\x921 or to xi+1). In other words, for each point, you choose (separately) its new coordinate. For the i-th point, it can be either xi\xe2\x88\x921, xi or xi+1.Your task is to determine if you can move some points as described above in such a way that the new set of points forms a consecutive segment of integers, i.\xe2\x80\x89e. for some integer l the coordinates of points should be equal to l,l+1,\xe2\x80\xa6,l+n\xe2\x88\x921.Note that the resulting points should have distinct coordinates.You have to answer t independent test cases." "brute force,math,sortings" 1000
1325C "Ehab and Path-etic MEXs" "You are given a tree consisting of n nodes. You want to write some labels on the tree\'s edges such that the following conditions hold:  Every label is an integer between 0 and n\xe2\x88\x922 inclusive.  All the written labels are distinct.  The largest value among MEX(u,v) over all pairs of nodes (u,v) is as small as possible. Here, MEX(u,v) denotes the smallest non-negative integer that isn\'t written on any edge on the unique simple path from node u to node v." "constructive algorithms,dfs and similar,greedy,trees" 1500
1066D "Boxes Packing" "Maksim has n objects and m boxes, each box has size exactly k. Objects are numbered from 1 to n in order from left to right, the size of the i-th object is ai.Maksim wants to pack his objects into the boxes and he will pack objects by the following algorithm: he takes one of the empty boxes he has, goes from left to right through the objects, and if the i-th object fits in the current box (the remaining size of the box is greater than or equal to ai), he puts it in the box, and the remaining size of the box decreases by ai. Otherwise he takes the new empty box and continues the process above. If he has no empty boxes and there is at least one object not in some box then Maksim cannot pack the chosen set of objects.Maksim wants to know the maximum number of objects he can pack by the algorithm above. To reach this target, he will throw out the leftmost object from the set until the remaining set of objects can be packed in boxes he has. Your task is to say the maximum number of objects Maksim can pack in boxes he has.Each time when Maksim tries to pack the objects into the boxes, he will make empty all the boxes he has before do it (and the relative order of the remaining set of objects will not change)." "binary search,implementation" 1800
1930D2 "Sum over all Substrings (Hard Version)" "This is the hard version of the problem. The only difference between the two versions is the constraint on t and n. You can make hacks only if both versions of the problem are solved.For a binary\xe2\x80\xa0 pattern p and a binary string q, both of length m, q is called p-good if for every i (1\xe2\x89\xa4i\xe2\x89\xa4m), there exist indices l and r such that:   1\xe2\x89\xa4l\xe2\x89\xa4i\xe2\x89\xa4r\xe2\x89\xa4m, and  pi is a mode\xe2\x80\xa1 of the string qlql+1\xe2\x80\xa6qr. For a pattern p, let f(p) be the minimum possible number of 1s in a p-good binary string (of the same length as the pattern).You are given a binary string s of size n. Find n\xe2\x88\x91i=1n\xe2\x88\x91j=if(sisi+1\xe2\x80\xa6sj). In other words, you need to sum the values of f over all n(n+1)2 substrings of s.\xe2\x80\xa0 A binary pattern is a string that only consists of characters 0 and 1.\xe2\x80\xa1 Character c is a mode of string t of length m if the number of occurrences of c in t is at least \xe2\x8c\x88m2\xe2\x8c\x89. For example, 0 is a mode of 010, 1 is not a mode of 010, and both 0 and 1 are modes of 011010." "bitmasks,divide and conquer,dp,dsu,greedy,implementation,strings" 2100
187B AlgoRace "PMP is getting a warrior. He is practicing a lot, but the results are not acceptable yet. This time instead of programming contests, he decided to compete in a car racing to increase the spirit of victory. He decides to choose a competition that also exhibits algorithmic features.AlgoRace is a special league of car racing where different teams compete in a country of n cities. Cities are numbered 1 through n. Every two distinct cities in the country are connected with one bidirectional road. Each competing team should introduce one driver and a set of cars.The competition is held in r rounds. In i-th round, drivers will start at city si and finish at city ti. Drivers are allowed to change their cars at most ki times. Changing cars can take place in any city in no time. One car can be used multiple times in one round, but total number of changes should not exceed ki. Drivers can freely choose their path to destination.PMP has prepared m type of purpose-built cars. Beside for PMP\xe2\x80\x99s driving skills, depending on properties of the car and the road, a car traverses each road in each direction in different times. PMP Warriors wants to devise best strategies of choosing car and roads in each round to maximize the chance of winning the cup. For each round they want to find the minimum time required to finish it." "dp,shortest paths" 1800
762D "Maximum path" "You are given a rectangular table 3\xe2\x80\x89\xc3\x97\xe2\x80\x89n. Each cell contains an integer. You can move from one cell to another if they share a side.Find such path from the upper left cell to the bottom right cell of the table that doesn\'t visit any of the cells twice, and the sum of numbers written in the cells of this path is maximum possible." dp,greedy,implementation 2300
1077F2 "Pictures with Kittens (hard version)" "The only difference between easy and hard versions is the constraints.Vova likes pictures with kittens. The news feed in the social network he uses can be represented as an array of n consecutive pictures (with kittens, of course). Vova likes all these pictures, but some are more beautiful than the others: the i-th picture has beauty ai.Vova wants to repost exactly x pictures in such a way that:   each segment of the news feed of at least k consecutive pictures has at least one picture reposted by Vova;  the sum of beauty values of reposted pictures is maximum possible. For example, if k=1 then Vova has to repost all the pictures in the news feed. If k=2 then Vova can skip some pictures, but between every pair of consecutive pictures Vova has to repost at least one of them.Your task is to calculate the maximum possible sum of values of reposted pictures if Vova follows conditions described above, or say that there is no way to satisfy all conditions." "data structures,dp" 2100
1037E Trips "There are n persons who initially don\'t know each other. On each morning, two of them, who were not friends before, become friends.We want to plan a trip for every evening of m days. On each trip, you have to select a group of people that will go on the trip. For every person, one of the following should hold:   Either this person does not go on the trip,  Or at least k of his friends also go on the trip. Note that the friendship is not transitive. That is, if a and b are friends and b and c are friends, it does not necessarily imply that a and c are friends.For each day, find the maximum number of people that can go on the trip on that day." graphs 2200
986D "Perfect Encoding" "You are working as an analyst in a company working on a new system for big data storage. This system will store n different objects. Each object should have a unique ID.To create the system, you choose the parameters of the system \xe2\x80\x94 integers m\xe2\x89\xa51 and b1,b2,\xe2\x80\xa6,bm. With these parameters an ID of some object in the system is an array of integers [a1,a2,\xe2\x80\xa6,am] where 1\xe2\x89\xa4ai\xe2\x89\xa4bi holds for every 1\xe2\x89\xa4i\xe2\x89\xa4m.Developers say that production costs are proportional to \xe2\x88\x91mi=1bi. You are asked to choose parameters m and bi so that the system will be able to assign unique IDs to n different objects and production costs are minimized. Note that you don\'t have to use all available IDs." fft,math 3100
1970F3 "Playing Quidditch (Hard)" "This afternoon, you decided to enjoy the first days of Spring by taking a walk outside. As you come near the Quidditch field, you hear screams. Once again, there is a conflict about the score: the two teams are convinced that they won the game! To prevent this problem from happening one more time, you decide to get involved in the refereeing of the matches.Now, you will stay in the stadium to watch the game and count the score. At the end of the game, you will decide the winner.Today, two teams are competing: the red Gryffindor (R) and the blue Ravenclaw (B) team. Each team is composed of P players (1\xe2\x89\xa4P\xe2\x89\xa410).The field is a rectangle of N lines and M columns (3\xe2\x89\xa4N,M\xe2\x89\xa499, N and M are odd). All the positions are integers, and several entities are allowed to be at the same position in the field. At the beginning of the game, the field contains goals for the two teams (each team can own between one and five goals), the players, and exactly one Quaffle. In this version of the problem, one Bludger and a Golden Snitch can be present.A game is composed of T steps (0\xe2\x89\xa4T\xe2\x89\xa410000). At each step, one entity on the field (a player or a ball) performs one action. All entities can move. A player can also catch a ball or throw the Quaffle that it is carrying. To catch a ball, a player must be located on the same cell as it. The Quaffle does not perform any action while it is being carried; it only follows the movements of the player. If a player carrying the Quaffle decides to throw it, the Quaffle is simply put at the current position of the player. If a player is on the same cell as a Bludger (either after a movement from the player or the Bludger), the player is eliminated. If the player is eliminated while it is carrying the Quaffle, the Quaffle remains on the cell containing both the player and the Bludger after the move. It is guaranteed that this never occurs while the player is in a cell containing a goal.To win a point, a player must leave the Quaffle at a goal of the other team. When it does, the team of the player wins one point, and the Quaffle instantly moves to the middle of the field (the cell at the (M+1)/2-th column of the (N+1)/2-th line of the field, starting from 1). There is no goal in the middle of the field. If a player puts the ball in its own goal, the other team wins the point. If a player catches the Golden Snitch, their team wins 10 points and the game is over." implementation 2300
76A Gift "The kingdom of Olympia consists of N cities and M bidirectional roads. Each road connects exactly two cities and two cities can be connected with more than one road. Also it possible that some roads connect city with itself making a loop.All roads are constantly plundered with bandits. After a while bandits became bored of wasting time in road robberies, so they suggested the king of Olympia to pay off. According to the offer, bandits want to get a gift consisted of gold and silver coins. Offer also contains a list of restrictions: for each road it is known gi \xe2\x80\x94 the smallest amount of gold and si \xe2\x80\x94 the smallest amount of silver coins that should be in the gift to stop robberies on the road. That is, if the gift contains a gold and b silver coins, then bandits will stop robberies on all the roads that gi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a and si\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b.Unfortunately kingdom treasury doesn\'t contain neither gold nor silver coins, but there are Olympian tugriks in it. The cost of one gold coin in tugriks is G, and the cost of one silver coin in tugriks is S. King really wants to send bandits such gift that for any two cities there will exist a safe path between them. Your task is to find the minimal cost in Olympian tugriks of the required gift." dsu,graphs,sortings,trees 2200
2009E "Klee\'s SUPER DUPER LARGE Array!!!" "Klee has an array a of length n containing integers [k,k+1,...,k+n\xe2\x88\x921] in that order. Klee wants to choose an index i (1\xe2\x89\xa4i\xe2\x89\xa4n) such that x=|a1+a2+\xe2\x8b\xaf+ai\xe2\x88\x92ai+1\xe2\x88\x92\xe2\x8b\xaf\xe2\x88\x92an| is minimized. Note that for an arbitrary integer z, |z| represents the absolute value of z. Output the minimum possible value of x." "binary search,math,ternary search" 1400
1742G Orray "You are given an array a consisting of n nonnegative integers. Let\'s define the prefix OR array b as the array bi=a1 OR a2 OR \xe2\x80\xa6 OR ai, where OR represents the bitwise OR operation. In other words, the array b is formed by computing the OR of every prefix of a.You are asked to rearrange the elements of the array a in such a way that its prefix OR array is lexicographically maximum.An array x is lexicographically greater than an array y if in the first position where x and y differ, xi>yi." "bitmasks,brute force,greedy,math,sortings" 1500
701C "They Are Everywhere" "Sergei B., the young coach of Pokemons, has found the big house which consists of n flats ordered in a row from left to right. It is possible to enter each flat from the street. It is possible to go out from each flat. Also, each flat is connected with the flat to the left and the flat to the right. Flat number 1 is only connected with the flat number 2 and the flat number n is only connected with the flat number n\xe2\x80\x89-\xe2\x80\x891.There is exactly one Pokemon of some type in each of these flats. Sergei B. asked residents of the house to let him enter their flats in order to catch Pokemons. After consulting the residents of the house decided to let Sergei B. enter one flat from the street, visit several flats and then go out from some flat. But they won\'t let him visit the same flat more than once. Sergei B. was very pleased, and now he wants to visit as few flats as possible in order to collect Pokemons of all types that appear in this house. Your task is to help him and determine this minimum number of flats he has to visit." "binary search,strings,two pointers" 1500
2019A "Max Plus Size" "EnV - Dynasty\xe2\xa0\x80You are given an array a1,a2,\xe2\x80\xa6,an of positive integers.You can color some elements of the array red, but there cannot be two adjacent red elements (i.e., for 1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921, at least one of ai and ai+1 must not be red).Your score is the maximum value of a red element plus the number of red elements. Find the maximum score you can get." "brute force,dp,greedy" 800
1714D "Color with Occurrences" "You are given some text t and a set of n strings s1,s2,\xe2\x80\xa6,sn. In one step, you can choose any occurrence of any string si in the text t and color the corresponding characters of the text in red. For example, if t=bababa and s1=ba, s2=aba, you can get t=bababa, t=bababa or t=bababa in one step.You want to color all the letters of the text t in red. When you color a letter in red again, it stays red.In the example above, three steps are enough:  Let\'s color t[2\xe2\x80\xa64]=s2=aba in red, we get t=bababa;  Let\'s color t[1\xe2\x80\xa62]=s1=ba in red, we get t=bababa;  Let\'s color t[4\xe2\x80\xa66]=s2=aba in red, we get t=bababa. Each string si can be applied any number of times (or not at all). Occurrences for coloring can intersect arbitrarily.Determine the minimum number of steps needed to color all letters t in red and how to do it. If it is impossible to color all letters of the text t in red, output -1." "brute force,data structures,dp,greedy,strings" 1600
1039B "Subway Pursuit" "This is an interactive problem.In the Wonderful Metropolis of the Future, there is no need in subway train drivers. Due to the technological progress, they were replaced by the Artificial Intelligence (AI). Unfortunately, one day the predictions of sci-fi writers came true: the AI rebelled and now there is an uncontrollable train in the subway. It can be dangerous! Your task is to find the train and stop the AI.The subway of the Metropolis is one line (regular straight line with no self-intersections) with n stations, indexed consecutively from 1 to n. At each moment the train is at some station. You need to determine the index of this station, so that the train would be secured.To find the train, dispatcher Sarah gave you a gadget that allows you to select arbitrary numbers l and r (l\xe2\x89\xa4r), and then check, whether the train is located on a station with index between l and r, inclusive. Unfortunately, recharging of the gadget takes some time (and every time you use it as soon as possible), so between two applications of the gadget the train can move to any station that is at most k stations away. Formally, if the train was at the station x when the gadget was applied, then at the next application of the gadget the train can appear at any station y such that max(1,x\xe2\x88\x92k)\xe2\x89\xa4y\xe2\x89\xa4min(n,x+k).Note that AI is not aware that you are trying to catch the train, so it makes all moves according to its predefined plan.After an examination of the gadget you found that it is very old and can hold no more than 4500 applications, after which it will break and your mission will be considered a failure.Can you find the station with the train using no more than 4500 applications of the gadgets?" "binary search,interactive,probabilities" 2100
869B "The Eternal Immortality" "Even if the world is full of counterfeits, I still regard it as wonderful.Pile up herbs and incense, and arise again from the flames and ashes of its predecessor \xe2\x80\x94 as is known to many, the phoenix does it like this.The phoenix has a rather long lifespan, and reincarnates itself once every a! years. Here a! denotes the factorial of integer a, that is, a!\xe2\x80\x89=\xe2\x80\x891\xe2\x80\x89\xc3\x97\xe2\x80\x892\xe2\x80\x89\xc3\x97\xe2\x80\x89...\xe2\x80\x89\xc3\x97\xe2\x80\x89a. Specifically, 0!\xe2\x80\x89=\xe2\x80\x891.Koyomi doesn\'t care much about this, but before he gets into another mess with oddities, he is interested in the number of times the phoenix will reincarnate in a timespan of b! years, that is, . Note that when b\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89a this value is always integer.As the answer can be quite large, it would be enough for Koyomi just to know the last digit of the answer in decimal representation. And you\'re here to provide Koyomi with this knowledge." math 1100
1554B Cobb "You are given n integers a1,a2,\xe2\x80\xa6,an and an integer k. Find the maximum value of i\xe2\x8b\x85j\xe2\x88\x92k\xe2\x8b\x85(ai|aj) over all pairs (i,j) of integers with 1\xe2\x89\xa4i<j\xe2\x89\xa4n. Here, | is the bitwise OR operator." "bitmasks,brute force,greedy,math" 1700
2005A "Simple Palindrome" "Narek has to spend 2 hours with some 2-year-old kids at the kindergarten. He wants to teach them competitive programming, and their first lesson is about palindromes.Narek found out that the kids only know the vowels of the English alphabet (the letters a, e, i, o, and u), so Narek needs to make a string that consists of vowels only. After making the string, he\'ll ask the kids to count the number of subsequences that are palindromes. Narek wants to keep it simple, so he\'s looking for a string such that the amount of palindrome subsequences is minimal.Help Narek find a string of length n, consisting of lowercase English vowels only (letters a, e, i, o, and u), which minimizes the amount of palindrome\xe2\x80\xa0 subsequences\xe2\x80\xa1 in it.\xe2\x80\xa0 A string is called a palindrome if it reads the same from left to right and from right to left.\xe2\x80\xa1 String t is a subsequence of string s if t can be obtained from s by removing several (possibly, zero or all) characters from s and concatenating the remaining ones, without changing their order. For example, odocs is a subsequence of codeforces." "combinatorics,constructive algorithms,greedy,math" 900
1017B "The Bits" "Rudolf is on his way to the castle. Before getting into the castle, the security staff asked him a question:Given two binary numbers a and b of length n. How many different ways of swapping two digits in a (only in a, not b) so that bitwise OR of these two numbers will be changed? In other words, let c be the bitwise OR of a and b, you need to find the number of ways of swapping two bits in a so that bitwise OR will not be equal to c.Note that binary numbers can contain leading zeros so that length of each number is exactly n.Bitwise OR is a binary operation. A result is a binary number which contains a one in each digit if there is a one in at least one of the two numbers. For example, 010102 OR 100112 = 110112.Well, to your surprise, you are not Rudolf, and you don\'t need to help him\xe2\x80\xa6 You are the security staff! Please find the number of ways of swapping two bits in a so that bitwise OR will be changed." implementation,math 1200
1730C "Minimum Notation" "You have a string s consisting of digits from 0 to 9 inclusive. You can perform the following operation any (possibly zero) number of times:   You can choose a position i and delete a digit d on the i-th position. Then insert the digit min(d+1,9) on any position (at the beginning, at the end or in between any two adjacent digits). What is the lexicographically smallest string you can get by performing these operations?A string a is lexicographically smaller than a string b of the same length if and only if the following holds:   in the first position where a and b differ, the string a has a smaller digit than the corresponding digit in b." "data structures,greedy,math,sortings" 1200
1080E "Sonya and Matrix Beauty" "Sonya had a birthday recently. She was presented with the matrix of size n\xc3\x97m and consist of lowercase Latin letters. We assume that the rows are numbered by integers from 1 to n from bottom to top, and the columns are numbered from 1 to m from left to right. Let\'s call a submatrix (i1,j1,i2,j2) (1\xe2\x89\xa4i1\xe2\x89\xa4i2\xe2\x89\xa4n;1\xe2\x89\xa4j1\xe2\x89\xa4j2\xe2\x89\xa4m) elements aij of this matrix, such that i1\xe2\x89\xa4i\xe2\x89\xa4i2 and j1\xe2\x89\xa4j\xe2\x89\xa4j2. Sonya states that a submatrix is beautiful if we can independently reorder the characters in each row (not in column) so that all rows and columns of this submatrix form palidroms. Let\'s recall that a string is called palindrome if it reads the same from left to right and from right to left. For example, strings abacaba,bcaacb,a are palindromes while strings abca,acbba,ab are not.Help Sonya to find the number of beautiful submatrixes. Submatrixes are different if there is an element that belongs to only one submatrix." strings 2400
432B "Football Kit" "Consider a football tournament where n teams participate. Each team has two football kits: for home games, and for away games. The kit for home games of the i-th team has color xi and the kit for away games of this team has color yi (xi\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89yi).In the tournament, each team plays exactly one home game and exactly one away game with each other team (n(n\xe2\x80\x89-\xe2\x80\x891) games in total). The team, that plays the home game, traditionally plays in its home kit. The team that plays an away game plays in its away kit. However, if two teams has the kits of the same color, they cannot be distinguished. In this case the away team plays in its home kit.Calculate how many games in the described tournament each team plays in its home kit and how many games it plays in its away kit." "brute force,greedy,implementation" 1200
1208F "Bits And Pieces" "You are given an array a of n integers.You need to find the maximum value of ai|(aj&ak) over all triplets (i,j,k) such that i<j<k.Here & denotes the bitwise AND operation, and | denotes the bitwise OR operation." "bitmasks,dfs and similar,dp,greedy" 2600
847H "Load Testing" "Polycarp plans to conduct a load testing of its new project Fakebook. He already agreed with his friends that at certain points in time they will send requests to Fakebook. The load testing will last n minutes and in the i-th minute friends will send ai requests.Polycarp plans to test Fakebook under a special kind of load. In case the information about Fakebook gets into the mass media, Polycarp hopes for a monotone increase of the load, followed by a monotone decrease of the interest to the service. Polycarp wants to test this form of load.Your task is to determine how many requests Polycarp must add so that before some moment the load on the server strictly increases and after that moment strictly decreases. Both the increasing part and the decreasing part can be empty (i. e. absent). The decrease should immediately follow the increase. In particular, the load with two equal neigbouring values is unacceptable.For example, if the load is described with one of the arrays [1, 2, 8, 4, 3], [1, 3, 5] or [10], then such load satisfies Polycarp (in each of the cases there is an increasing part, immediately followed with a decreasing part). If the load is described with one of the arrays [1, 2, 2, 1], [2, 1, 2] or [10, 10], then such load does not satisfy Polycarp.Help Polycarp to make the minimum number of additional requests, so that the resulting load satisfies Polycarp. He can make any number of additional requests at any minute from 1 to n." greedy 1600
7A "Kalevitch and Chess" "A famous Berland\'s painter Kalevitch likes to shock the public. One of his last obsessions is chess. For more than a thousand years people have been playing this old game on uninteresting, monotonous boards. Kalevitch decided to put an end to this tradition and to introduce a new attitude to chessboards.As before, the chessboard is a square-checkered board with the squares arranged in a 8\xe2\x80\x89\xc3\x97\xe2\x80\x898 grid, each square is painted black or white. Kalevitch suggests that chessboards should be painted in the following manner: there should be chosen a horizontal or a vertical line of 8 squares (i.e. a row or a column), and painted black. Initially the whole chessboard is white, and it can be painted in the above described way one or more times. It is allowed to paint a square many times, but after the first time it does not change its colour any more and remains black. Kalevitch paints chessboards neatly, and it is impossible to judge by an individual square if it was painted with a vertical or a horizontal stroke.Kalevitch hopes that such chessboards will gain popularity, and he will be commissioned to paint chessboards, which will help him ensure a comfortable old age. The clients will inform him what chessboard they want to have, and the painter will paint a white chessboard meeting the client\'s requirements.It goes without saying that in such business one should economize on everything \xe2\x80\x94 for each commission he wants to know the minimum amount of strokes that he has to paint to fulfill the client\'s needs. You are asked to help Kalevitch with this task." "brute force,constructive algorithms" 1100
1933D "Turtle Tenacity: Continual Mods" "Given an array a1,a2,\xe2\x80\xa6,an, determine whether it is possible to rearrange its elements into b1,b2,\xe2\x80\xa6,bn, such that b1modb2mod\xe2\x80\xa6modbn\xe2\x89\xa00.Here xmody denotes the remainder from dividing x by y. Also, the modulo operations are calculated from left to right. That is, xmodymodz=(xmody)modz. For example, 2024mod1000mod8=(2024mod1000)mod8=24mod8=0." "constructive algorithms,greedy,math,number theory,sortings" 1200
1322E "Median Mountain Range" "Berland \xe2\x80\x94 is a huge country with diverse geography. One of the most famous natural attractions of Berland is the ""Median mountain range"". This mountain range is n mountain peaks, located on one straight line and numbered in order of 1 to n. The height of the i-th mountain top is ai. ""Median mountain range"" is famous for the so called alignment of mountain peaks happening to it every day. At the moment of alignment simultaneously for each mountain from 2 to n\xe2\x88\x921 its height becomes equal to the median height among it and two neighboring mountains. Formally, if before the alignment the heights were equal bi, then after the alignment new heights ai are as follows: a1=b1, an=bn and for all i from 2 to n\xe2\x88\x921 ai=median(bi\xe2\x88\x921,bi,bi+1). The median of three integers is the second largest number among them. For example, median(5,1,2)=2, and median(4,2,4)=4.Recently, Berland scientists have proved that whatever are the current heights of the mountains, the alignment process will stabilize sooner or later, i.e. at some point the altitude of the mountains won\'t changing after the alignment any more. The government of Berland wants to understand how soon it will happen, i.e. to find the value of c \xe2\x80\x94 how many alignments will occur, which will change the height of at least one mountain. Also, the government of Berland needs to determine the heights of the mountains after c alignments, that is, find out what heights of the mountains stay forever. Help scientists solve this important problem!" "data structures" 3300
1023E "Down or Right" "This is an interactive problem.Bob lives in a square grid of size n\xc3\x97n, with rows numbered 1 through n from top to bottom, and columns numbered 1 through n from left to right. Every cell is either allowed or blocked, but you don\'t know the exact description of the grid. You are given only an integer n.Bob can move through allowed cells but only in some limited directions. When Bob is in an allowed cell in the grid, he can move down or right to an adjacent cell, if it is allowed.You can ask at most 4\xe2\x8b\x85n queries of form ""? r1 c1 r2 c2"" (1\xe2\x89\xa4r1\xe2\x89\xa4r2\xe2\x89\xa4n, 1\xe2\x89\xa4c1\xe2\x89\xa4c2\xe2\x89\xa4n). The answer will be ""YES"" if Bob can get from a cell (r1,c1) to a cell (r2,c2), and ""NO"" otherwise. In particular, if one of the two cells (or both) is a blocked cell then the answer is ""NO"" for sure. Since Bob doesn\'t like short trips, you can only ask queries with the manhattan distance between the two cells at least n\xe2\x88\x921, i.e. the following condition must be satisfied: (r2\xe2\x88\x92r1)+(c2\xe2\x88\x92c1)\xe2\x89\xa5n\xe2\x88\x921.It\'s guaranteed that Bob can get from the top-left corner (1,1) to the bottom-right corner (n,n) and your task is to find a way to do it. You should print the answer in form ""! S"" where S is a string of length 2\xe2\x8b\x85n\xe2\x88\x922 consisting of characters \'D\' and \'R\', denoting moves down and right respectively. The down move increases the first coordinate by 1, the right move increases the second coordinate by 1. If there are multiple solutions, any of them will be accepted. You should terminate immediately after printing the solution." "constructive algorithms,interactive,matrices" 2100
1638C "Inversion Graph" "You are given a permutation p1,p2,\xe2\x80\xa6,pn. Then, an undirected graph is constructed in the following way: add an edge between vertices i, j such that i<j if and only if pi>pj. Your task is to count the number of connected components in this graph.Two vertices u and v belong to the same connected component if and only if there is at least one path along edges connecting u and v.A permutation is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array) and [1,3,4] is also not a permutation (n=3 but there is 4 in the array)." "data structures,dsu,graphs,math" 1300
1360E Polygon "Polygon is not only the best platform for developing problems but also a square matrix with side n, initially filled with the character 0.On the polygon, military training was held. The soldiers placed a cannon above each cell in the first row and a cannon to the left of each cell in the first column. Thus, exactly 2n cannons were placed.  Initial polygon for n=4. Cannons shoot character 1. At any moment of time, no more than one cannon is shooting. When a 1 flies out of a cannon, it flies forward (in the direction of the shot) until it collides with a polygon border or another 1. After that, it takes the cell in which it was before the collision and remains there. Take a look at the examples for better understanding.More formally:   if a cannon stands in the row i, to the left of the first column, and shoots with a 1, then the 1 starts its flight from the cell (i,1) and ends in some cell (i,j);  if a cannon stands in the column j, above the first row, and shoots with a 1, then the 1 starts its flight from the cell (1,j) and ends in some cell (i,j). For example, consider the following sequence of shots:   1. Shoot the cannon in the row 2.                         2. Shoot the cannon in the row 2.                         3. Shoot the cannon in column 3. You have a report from the military training on your desk. This report is a square matrix with side length n consisting of 0 and 1. You wonder if the training actually happened. In other words, is there a sequence of shots such that, after the training, you get the given matrix?Each cannon can make an arbitrary number of shots. Before the training, each cell of the polygon contains 0." "dp,graphs,implementation,shortest paths" 1300
450B "Jzzhu and Sequences" "Jzzhu has invented a kind of sequences, they meet the following property:You are given x and y, please calculate fn modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." implementation,math 1300
177D2 "Encrypting Messages" "The Smart Beaver from ABBYY invented a new message encryption method and now wants to check its performance. Checking it manually is long and tiresome, so he decided to ask the ABBYY Cup contestants for help.A message is a sequence of n integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. Encryption uses a key which is a sequence of m integers b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bm (m\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n). All numbers from the message and from the key belong to the interval from 0 to c\xe2\x80\x89-\xe2\x80\x891, inclusive, and all the calculations are performed modulo c.Encryption is performed in n\xe2\x80\x89-\xe2\x80\x89m\xe2\x80\x89+\xe2\x80\x891 steps. On the first step we add to each number a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89am a corresponding number b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bm. On the second step we add to each number a2,\xe2\x80\x89a3,\xe2\x80\x89...,\xe2\x80\x89am\xe2\x80\x89+\xe2\x80\x891 (changed on the previous step) a corresponding number b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bm. And so on: on step number i we add to each number ai,\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x89m\xe2\x80\x89-\xe2\x80\x891 a corresponding number b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bm. The result of the encryption is the sequence a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an after n\xe2\x80\x89-\xe2\x80\x89m\xe2\x80\x89+\xe2\x80\x891 steps.Help the Beaver to write a program that will encrypt messages in the described manner." "data structures" 1500
1470E "Strange Permutation" "Alice had a permutation p1,p2,\xe2\x80\xa6,pn. Unfortunately, the permutation looked very boring, so she decided to change it and choose some non-overlapping subranges of this permutation and reverse them. The cost of reversing a single subrange [l,r] (elements from position l to position r, inclusive) is equal to r\xe2\x88\x92l, and the cost of the operation is the sum of costs of reversing individual subranges. Alice had an integer c in mind, so she only considered operations that cost no more than c.Then she got really bored, and decided to write down all the permutations that she could possibly obtain by performing exactly one operation on the initial permutation. Of course, Alice is very smart, so she wrote down each obtainable permutation exactly once (no matter in how many ways it can be obtained), and of course the list was sorted lexicographically.Now Bob would like to ask Alice some questions about her list. Each question is in the following form: what is the i-th number in the j-th permutation that Alice wrote down? Since Alice is too bored to answer these questions, she asked you to help her out." "binary search,combinatorics,data structures,dp,graphs,implementation,two pointers" 3200
1059A Cashier "Vasya has recently got a job as a cashier at a local store. His day at work is L minutes long. Vasya has already memorized n regular customers, the i-th of which comes after ti minutes after the beginning of the day, and his service consumes li minutes. It is guaranteed that no customer will arrive while Vasya is servicing another customer. Vasya is a bit lazy, so he likes taking smoke breaks for a minutes each. Those breaks may go one after another, but Vasya must be present at work during all the time periods he must serve regular customers, otherwise one of them may alert his boss. What is the maximum number of breaks Vasya can take during the day?" implementation 1000
1335A "Candies and Two Sisters" "There are two sisters Alice and Betty. You have n candies. You want to distribute these n candies between two sisters in such a way that:  Alice will get a (a>0) candies;  Betty will get b (b>0) candies;  each sister will get some integer number of candies;  Alice will get a greater amount of candies than Betty (i.e. a>b);  all the candies will be given to one of two sisters (i.e. a+b=n). Your task is to calculate the number of ways to distribute exactly n candies between sisters in a way described above. Candies are indistinguishable.Formally, find the number of ways to represent n as the sum of n=a+b, where a and b are positive integers and a>b.You have to answer t independent test cases." math 800
1986C "Update Queries" "Let\'s consider the following simple problem. You are given a string s of length n, consisting of lowercase Latin letters, as well as an array of indices ind of length m (1\xe2\x89\xa4indi\xe2\x89\xa4n) and a string c of length m, consisting of lowercase Latin letters. Then, in order, you perform the update operations, namely, during the i-th operation, you set sindi=ci. Note that you perform all m operations from the first to the last.Of course, if you change the order of indices in the array ind and/or the order of letters in the string c, you can get different results. Find the lexicographically smallest string s that can be obtained after m update operations, if you can rearrange the indices in the array ind and the letters in the string c as you like.A string a is lexicographically less than a string b if and only if one of the following conditions is met: a is a prefix of b, but a\xe2\x89\xa0b; in the first position where a and b differ, the symbol in string a is earlier in the alphabet than the corresponding symbol in string b." "data structures,greedy,sortings" 1100
403E "Two Rooted Trees" "You have two rooted undirected trees, each contains n vertices. Let\'s number the vertices of each tree with integers from 1 to n. The root of each tree is at vertex 1. The edges of the first tree are painted blue, the edges of the second one are painted red. For simplicity, let\'s say that the first tree is blue and the second tree is red.Edge {x,\xe2\x80\x89y} is called bad for edge {p,\xe2\x80\x89q} if two conditions are fulfilled:   The color of edge {x,\xe2\x80\x89y} is different from the color of edge {p,\xe2\x80\x89q}.  Let\'s consider the tree of the same color that edge {p,\xe2\x80\x89q} is. Exactly one of vertices x, y lies both in the subtree of vertex p and in the subtree of vertex q. In this problem, your task is to simulate the process described below. The process consists of several stages:  On each stage edges of exactly one color are deleted.  On the first stage, exactly one blue edge is deleted.  Let\'s assume that at the stage i we\'ve deleted edges {u1,\xe2\x80\x89v1}, {u2,\xe2\x80\x89v2}, ..., {uk,\xe2\x80\x89vk}. At the stage i\xe2\x80\x89+\xe2\x80\x891 we will delete all undeleted bad edges for edge {u1,\xe2\x80\x89v1}, then we will delete all undeleted bad edges for edge {u2,\xe2\x80\x89v2} and so on until we reach edge {uk,\xe2\x80\x89vk}.  For each stage of deleting edges determine what edges will be removed on the stage. Note that the definition of a bad edge always considers the initial tree before it had any edges removed." "data structures,implementation,trees" 2900
202B "Brand New Easy Problem" "A widely known among some people Belarusian sport programmer Lesha decided to make some money to buy a one square meter larger flat. To do this, he wants to make and carry out a Super Rated Match (SRM) on the site Torcoder.com. But there\'s a problem \xe2\x80\x94 a severe torcoder coordinator Ivan does not accept any Lesha\'s problem, calling each of them an offensive word ""duped"" (that is, duplicated). And one day they nearely quarrelled over yet another problem Ivan wouldn\'t accept.You are invited to act as a fair judge and determine whether the problem is indeed brand new, or Ivan is right and the problem bears some resemblance to those used in the previous SRMs.You are given the descriptions of Lesha\'s problem and each of Torcoder.com archive problems. The description of each problem is a sequence of words. Besides, it is guaranteed that Lesha\'s problem has no repeated words, while the description of an archive problem may contain any number of repeated words.The ""similarity"" between Lesha\'s problem and some archive problem can be found as follows. Among all permutations of words in Lesha\'s problem we choose the one that occurs in the archive problem as a subsequence. If there are multiple such permutations, we choose the one with the smallest number of inversions. Then the ""similarity"" of a problem can be written as , where n is the number of words in Lesha\'s problem and x is the number of inversions in the chosen permutation. Note that the ""similarity"" p is always a positive integer.The problem is called brand new if there is not a single problem in Ivan\'s archive which contains a permutation of words from Lesha\'s problem as a subsequence.Help the boys and determine whether the proposed problem is new, or specify the problem from the archive which resembles Lesha\'s problem the most, otherwise." "brute force" 1700
1210A "Anadi and Domino" "Anadi has a set of dominoes. Every domino has two parts, and each part contains some dots. For every aa and bb such that 1\xe2\x89\xa4a\xe2\x89\xa4b\xe2\x89\xa461\xe2\x89\xa4a\xe2\x89\xa4b\xe2\x89\xa46, there is exactly one domino with aa dots on one half and bb dots on the other half. The set contains exactly 2121 dominoes. Here is an exact illustration of his set:  Also, Anadi has an undirected graph without self-loops and multiple edges. He wants to choose some dominoes and place them on the edges of this graph. He can use at most one domino of each type. Each edge can fit at most one domino. It\'s not necessary to place a domino on each edge of the graph.When placing a domino on an edge, he also chooses its direction. In other words, one half of any placed domino must be directed toward one of the endpoints of the edge and the other half must be directed toward the other endpoint. There\'s a catch: if there are multiple halves of dominoes directed toward the same vertex, each of these halves must contain the same number of dots.How many dominoes at most can Anadi place on the edges of his graph?" "brute force,graphs" 1700
651A Joysticks "Friends are going to play console. They have two joysticks and only one charger for them. Initially first joystick is charged at a1 percent and second one is charged at a2 percent. You can connect charger to a joystick only at the beginning of each minute. In one minute joystick either discharges by 2 percent (if not connected to a charger) or charges by 1 percent (if connected to a charger).Game continues while both joysticks have a positive charge. Hence, if at the beginning of minute some joystick is charged by 1 percent, it has to be connected to a charger, otherwise the game stops. If some joystick completely discharges (its charge turns to 0), the game also stops.Determine the maximum number of minutes that game can last. It is prohibited to pause the game, i. e. at each moment both joysticks should be enabled. It is allowed for joystick to be charged by more than 100 percent." dp,greedy,implementation,math 1100
1999E "Triple Operations" "On the board Ivy wrote down all integers from l to r, inclusive.In an operation, she does the following:   pick two numbers x and y on the board, erase them, and in their place write the numbers 3x and \xe2\x8c\x8ay3\xe2\x8c\x8b. (Here \xe2\x8c\x8a\xe2\x88\x99\xe2\x8c\x8b denotes rounding down to the nearest integer). What is the minimum number of operations Ivy needs to make all numbers on the board equal 0? We have a proof that this is always possible." dp,implementation,math 1300
460A "Vasya and Socks" "Vasya has n pairs of socks. In the morning of each day Vasya has to put on a pair of socks before he goes to school. When he comes home in the evening, Vasya takes off the used socks and throws them away. Every m-th day (at days with numbers m,\xe2\x80\x892m,\xe2\x80\x893m,\xe2\x80\x89...) mom buys a pair of socks to Vasya. She does it late in the evening, so that Vasya cannot put on a new pair of socks before the next day. How many consecutive days pass until Vasya runs out of socks?" "brute force,implementation,math" 900
1914E1 "Game with Marbles (Easy Version)" "The easy and hard versions of this problem differ only in the constraints on the number of test cases and n. In the easy version, the number of test cases does not exceed 103, and n does not exceed 6.Recently, Alice and Bob were given marbles of n different colors by their parents. Alice has received a1 marbles of color 1, a2 marbles of color 2,..., an marbles of color n. Bob has received b1 marbles of color 1, b2 marbles of color 2, ..., bn marbles of color n. All ai and bi are between 1 and 109.After some discussion, Alice and Bob came up with the following game: players take turns, starting with Alice. On their turn, a player chooses a color i such that both players have at least one marble of that color. The player then discards one marble of color i, and their opponent discards all marbles of color i. The game ends when there is no color i such that both players have at least one marble of that color.The score in the game is the difference between the number of remaining marbles that Alice has and the number of remaining marbles that Bob has at the end of the game. In other words, the score in the game is equal to (A\xe2\x88\x92B), where A is the number of marbles Alice has and B is the number of marbles Bob has at the end of the game. Alice wants to maximize the score, while Bob wants to minimize it.Calculate the score at the end of the game if both players play optimally." "brute force,games,greedy,sortings" 1400
1900B "Laura and Operations" "Laura is a girl who does not like combinatorics. Nemanja will try to convince her otherwise.Nemanja wrote some digits on the board. All of them are either 1, 2, or 3. The number of digits 1 is a. The number of digits 2 is b and the number of digits 3 is c. He told Laura that in one operation she can do the following:  Select two different digits and erase them from the board. After that, write the digit (1, 2, or 3) different from both erased digits. For example, let the digits be 1, 1, 1, 2, 3, 3. She can choose digits 1 and 3 and erase them. Then the board will look like this 1, 1, 2, 3. After that, she has to write another digit 2, so at the end of the operation, the board will look like 1, 1, 2, 3, 2.Nemanja asked her whether it was possible for only digits of one type to remain written on the board after some operations. If so, which digits can they be?Laura was unable to solve this problem and asked you for help. As an award for helping her, she will convince Nemanja to give you some points." dp,math 900
163C Conveyor "Anton came to a chocolate factory. There he found a working conveyor and decided to run on it from the beginning to the end.The conveyor is a looped belt with a total length of 2l meters, of which l meters are located on the surface and are arranged in a straight line. The part of the belt which turns at any moment (the part which emerges from under the floor to the surface and returns from the surface under the floor) is assumed to be negligibly short.The belt is moving uniformly at speed v1 meters per second. Anton will be moving on it in the same direction at the constant speed of v2 meters per second, so his speed relatively to the floor will be v1\xe2\x80\x89+\xe2\x80\x89v2 meters per second. Anton will neither stop nor change the speed or the direction of movement.Here and there there are chocolates stuck to the belt (n chocolates). They move together with the belt, and do not come off it. Anton is keen on the chocolates, but he is more keen to move forward. So he will pick up all the chocolates he will pass by, but nothing more. If a chocolate is at the beginning of the belt at the moment when Anton starts running, he will take it, and if a chocolate is at the end of the belt at the moment when Anton comes off the belt, he will leave it.   The figure shows an example with two chocolates. One is located   in the position a1\xe2\x80\x89=\xe2\x80\x89l\xe2\x80\x89-\xe2\x80\x89d, and is now on the top half of the belt, the second one   is in the position a2\xe2\x80\x89=\xe2\x80\x892l\xe2\x80\x89-\xe2\x80\x89d, and is now on the bottom half of the belt.  You are given the positions of the chocolates relative to the initial start position of the belt 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a1\xe2\x80\x89<\xe2\x80\x89a2\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89an\xe2\x80\x89<\xe2\x80\x892l. The positions on the belt from 0 to l correspond to the top, and from l to 2l \xe2\x80\x94 to the the bottom half of the belt (see example). All coordinates are given in meters.Anton begins to run along the belt at a random moment of time. This means that all possible positions of the belt at the moment he starts running are equiprobable. For each i from 0 to n calculate the probability that Anton will pick up exactly i chocolates." "sortings,two pointers" 2100
126E Pills "Doctor prescribed medicine to his patient. The medicine is represented by pills. Each pill consists of a shell and healing powder. The shell consists of two halves; each half has one of four colors \xe2\x80\x94 blue, red, white or yellow.The doctor wants to put 28 pills in a rectangular box 7\xe2\x80\x89\xc3\x97\xe2\x80\x898 in size. Besides, each pill occupies exactly two neighboring cells and any cell contains exactly one half of a pill. Thus, the result is a four colored picture 7\xe2\x80\x89\xc3\x97\xe2\x80\x898 in size.The doctor thinks that a patient will recover sooner if the picture made by the pills will be special. Unfortunately, putting the pills in the box so as to get the required picture is not a very easy task. That\'s why doctor asks you to help. Doctor has some amount of pills of each of 10 painting types. They all contain the same medicine, that\'s why it doesn\'t matter which 28 of them will be stored inside the box.Place the pills in the box so that the required picture was formed. If it is impossible to place the pills in the required manner, then place them so that the number of matching colors in all 56 cells in the final arrangement and the doctor\'s picture were maximum." "brute force,flows" 2900
549B "Looksery Party" "The Looksery company, consisting of n staff members, is planning another big party. Every employee has his phone number and the phone numbers of his friends in the phone book. Everyone who comes to the party, sends messages to his contacts about how cool it is. At the same time everyone is trying to spend as much time on the fun as possible, so they send messages to everyone without special thinking, moreover, each person even sends a message to himself or herself.Igor and Max, Looksery developers, started a dispute on how many messages each person gets. Igor indicates n numbers, the i-th of which indicates how many messages, in his view, the i-th employee is going to take. If Igor guesses correctly at least one of these numbers, he wins, otherwise Max wins.You support Max in this debate, so you need, given the contact lists of the employees, to determine whether there is a situation where Igor loses. Specifically, you need to determine which employees should come to the party, and which should not, so after all the visitors send messages to their contacts, each employee received a number of messages that is different from what Igor stated." "constructive algorithms,dfs and similar,graphs,greedy" 2300
379F "New Year Tree" "You are a programmer and you have a New Year Tree (not the traditional fur tree, though) \xe2\x80\x94 a tree of four vertices: one vertex of degree three (has number 1), connected with three leaves (their numbers are from 2 to 4).On the New Year, programmers usually have fun. You decided to have fun as well by adding vertices to the tree. One adding operation looks as follows:  First we choose some leaf of the tree with number v.  Let\'s mark the number of vertices on the tree at this moment by variable n, then two vertexes are added to the tree, their numbers are n\xe2\x80\x89+\xe2\x80\x891 and n\xe2\x80\x89+\xe2\x80\x892, also you get new edges, one between vertices v and n\xe2\x80\x89+\xe2\x80\x891 and one between vertices v and n\xe2\x80\x89+\xe2\x80\x892. Your task is not just to model the process of adding vertices to the tree, but after each adding operation print the diameter of the current tree. Come on, let\'s solve the New Year problem!" "data structures,divide and conquer,trees" 2400
1750E "Bracket Cost" "Daemon Targaryen decided to stop looking like a Metin2 character. He turned himself into the most beautiful thing, a bracket sequence.For a bracket sequence, we can do two kind of operations:  Select one of its substrings\xe2\x80\xa0 and cyclic shift it to the right. For example, after a cyclic shift to the right, ""(())"" will become "")(()"";  Insert any bracket, opening \'(\' or closing \')\', wherever you want in the sequence. We define the cost of a bracket sequence as the minimum number of such operations to make it balanced\xe2\x80\xa1.Given a bracket sequence s of length n, find the sum of costs across all its n(n+1)2 non-empty substrings. Note that for each substring we calculate the cost independently.\xe2\x80\xa0 A string a is a substring of a string b if a can be obtained from b by deletion of several (possibly, zero or all) characters from the beginning and several (possibly, zero or all) characters from the end.\xe2\x80\xa1 A sequence of brackets is called balanced if one can turn it into a valid math expression by adding characters + and 1. For example, sequences ""(())()"", ""()"", and ""(()(()))"" are balanced, while "")("", ""(()"", and ""(()))("" are not." "binary search,data structures,divide and conquer,dp,greedy,strings" 2400
1639B "Treasure Hunt" "All problems in this contest share the same statement, the only difference is the test your solution runs on. For further information on scoring please refer to ""Scoring"" section of the statement.This is an interactive problem.Imagine you are a treasure hunter, a very skillful one. One day you came across an ancient map which could help you to become rich. The map shows multiple forestry roads, and at each junction there is a treasure. So, you start your journey hoping to retrieve all the hidden treasures, but you don\'t know yet that there is a wicked wizard standing against you and craving to tangle up these roads and impede your achievements.The treasure map is represented as an undirected graph in which vertices correspond to junctions and edges correspond to roads. Your path begins at a certain fixed vertex with a label known to you. Every time you come to a vertex that you have not been to before, you dig up a treasure chest and put a flag in this vertex. At the initial vertex you\'ll find a treasure chest immediately and, consequently, you\'ll put a flag there immediately as well.When you are standing at the junction you can see for each of the adjacent vertices its degree and if there is a flag there. There are no other things you can see from there. Besides, the power of the wicked wizard is so great that he is able to change the location of the roads and junctions on the map without changing the graph structure. Therefore, the sequence of the roads coming from the junction v might be different each time you come in the junction v. However, keep in mind that the set of adjacent crossroads does not change, and you are well aware of previously dug treasures at each adjacent to v vertex.Your goal is to collect treasures from all vertices of the graph as fast as you can. Good luck in hunting!" graphs,interactive -999
1368E "Ski Accidents" "Arthur owns a ski resort on a mountain. There are n landing spots on the mountain numbered from 1 to n from the top to the foot of the mountain. The spots are connected with one-directional ski tracks. All tracks go towards the foot of the mountain, so there are no directed cycles formed by the tracks. There are at most two tracks leaving each spot, but many tracks may enter the same spot.A skier can start skiing from one spot and stop in another spot if there is a sequence of tracks that lead from the starting spot and end in the ending spot. Unfortunately, recently there were many accidents, because the structure of the resort allows a skier to go through dangerous paths, by reaching high speed and endangering himself and the other customers. Here, a path is called dangerous, if it consists of at least two tracks.Arthur wants to secure his customers by closing some of the spots in a way that there are no dangerous paths in the resort. When a spot is closed, all tracks entering and leaving that spot become unusable. Formally, after closing some of the spots, there should not be a path that consists of two or more tracks.Arthur doesn\'t want to close too many spots. He will be happy to find any way to close at most 47n spots so that the remaining part is safe. Help him find any suitable way to do so." "constructive algorithms,graphs,greedy" 2500
255A "Greg\'s Workout" "Greg is a beginner bodybuilder. Today the gym coach gave him the training plan. All it had was n integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. These numbers mean that Greg needs to do exactly n exercises today. Besides, Greg should repeat the i-th in order exercise ai times.Greg now only does three types of exercises: ""chest"" exercises, ""biceps"" exercises and ""back"" exercises. Besides, his training is cyclic, that is, the first exercise he does is a ""chest"" one, the second one is ""biceps"", the third one is ""back"", the fourth one is ""chest"", the fifth one is ""biceps"", and so on to the n-th exercise.Now Greg wonders, which muscle will get the most exercise during his training. We know that the exercise Greg repeats the maximum number of times, trains the corresponding muscle the most. Help Greg, determine which muscle will get the most training." implementation 800
1970D3 "Arithmancy (Hard)" "The only difference between the versions of this problem is the maximum value of n.Professor Vector is preparing to teach her Arithmancy class. She needs to prepare n distinct magic words for the class. Each magic word is a string consisting of characters X and O. A spell is a string created by concatenating two magic words together. The power of a spell is equal to the number of its different non-empty substrings. For example, the power of the spell XOXO is equal to 7, because it has 7 different substrings: X, O, XO, OX, XOX, OXO and XOXO.Each student will create their own spell by concatenating two magic words. Since the students are not very good at magic yet, they will choose each of the two words independently and uniformly at random from the n words provided by Professor Vector. It is therefore also possible that the two words a student chooses are the same. Each student will then compute the power of their spell, and tell it to Professor Vector. In order to check their work, and of course to impress the students, Professor Vector needs to find out which two magic words and in which order were concatenated by each student.Your program needs to perform the role of Professor Vector: first, create n distinct magic words, and then handle multiple requests where it is given the spell power and needs to determine the indices of the two magic words, in the correct order, that were used to create the corresponding spell." interactive 3100
1473B "String LCM" "Let\'s define a multiplication operation between a string a and a positive integer x: a\xe2\x8b\x85x is the string that is a result of writing x copies of a one after another. For example, ""abc"" \xe2\x8b\x85 2 = ""abcabc"", ""a"" \xe2\x8b\x85 5 = ""aaaaa"".A string a is divisible by another string b if there exists an integer x such that b\xe2\x8b\x85x=a. For example, ""abababab"" is divisible by ""ab"", but is not divisible by ""ababab"" or ""aa"".LCM of two strings s and t (defined as LCM(s,t)) is the shortest non-empty string that is divisible by both s and t.You are given two strings s and t. Find LCM(s,t) or report that it does not exist. It can be shown that if LCM(s,t) exists, it is unique." "brute force,math,number theory,strings" 1000
1921F "Sum of Progression" "You are given an array a of n numbers. There are also q queries of the form s,d,k.For each query q, find the sum of elements as+as+d\xe2\x8b\x852+\xe2\x8b\xaf+as+d\xe2\x8b\x85(k\xe2\x88\x921)\xe2\x8b\x85k. In other words, for each query, it is necessary to find the sum of k elements of the array with indices starting from the s-th, taking steps of size d, multiplying it by the serial number of the element in the resulting sequence." "brute force,data structures,dp,implementation,math" 1900
1819E "Roads in E City" "This is an interactive problem.As is well known, the city ""E"" has never had its roads repaired in its a thousand and a half years old history. And only recently the city administration repaired some of them.It is known that in total in the city ""E"" there are n intersections and m roads, which can be used in both directions, numbered with integers from 1 to m. The i-th road connects intersections with numbers ai and bi.Among all m roads, some subset of the roads has been repaired, but you do not know which one. The only information you could get from the city\'s road services is that you can get from any intersection to any other intersection by driving only on the roads that have been repaired.You are a young entrepreneur, and decided to organize a delivery service of fresh raw meat in the city ""E"" (in this city such meat is called ""steaks"", it is very popular among the locals). You have already recruited a staff of couriers, but the couriers are willing to travel only on repaired roads. Now you have to find out which roads have already been repaired.The city administration has given you the city for a period of time, so you can make different queries of one of three types:  Block the road with the number x. In this case, movement on the road for couriers will be forbidden. Initially all roads are unblocked. Unblock the road with the number x. In this case, couriers will be able to move on the road x if it is repaired. Try to deliver the order to the intersection with the number y. In this case, one of your couriers will start moving from intersection with number s you don\'t know and deliver the order to intersection with number y if there is a path on unblocked repaired roads from intersection s to intersection y. It is guaranteed that intersection s will be chosen beforehand. Unfortunately, the city is placed at your complete disposal for a short period of time, so you can make no more than 100\xe2\x8b\x85m requests." interactive,math,probabilities,trees 3200
1622F "Quadratic Set" "Let\'s call a set of positive integers a1,a2,\xe2\x80\xa6,ak quadratic if the product of the factorials of its elements is a square of an integer, i.\xe2\x80\x89e. k\xe2\x88\x8fi=1ai!=m2, for some integer m.You are given a positive integer n.Your task is to find a quadratic subset of a set 1,2,\xe2\x80\xa6,n of maximum size. If there are multiple answers, print any of them." "constructive algorithms,hashing,math,number theory" 2900
207C3 "Game with Two Trees" "The Smart Beaver from ABBYY has come up with a new developing game for children. The Beaver thinks that this game will help children to understand programming better.The main object of the game is finite rooted trees, each of their edges contains some lowercase English letter. Vertices on any tree are always numbered sequentially from 1 to m, where m is the number of vertices in the tree. Before describing the actual game, let\'s introduce some definitions.We\'ll assume that the sequence of vertices with numbers v1, v2, ..., vk (k\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x891) is a forward path, if for any integer i from 1 to k\xe2\x80\x89-\xe2\x80\x891 vertex vi is a direct ancestor of vertex vi\xe2\x80\x89+\xe2\x80\x891. If we sequentially write out all letters from the the edges of the given path from v1 to vk, we get some string (k\xe2\x80\x89=\xe2\x80\x891 gives us an empty string). We\'ll say that such string corresponds to forward path v1, v2, ..., vk.We\'ll assume that the sequence of tree vertices with numbers v1, v2, ..., vk (k\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x891) is a backward path if for any integer i from 1 to k\xe2\x80\x89-\xe2\x80\x891 vertex vi is the direct descendant of vertex vi\xe2\x80\x89+\xe2\x80\x891. If we sequentially write out all the letters from the edges of the given path from v1 to vk, we get some string (k\xe2\x80\x89=\xe2\x80\x891 gives us an empty string). We\'ll say that such string corresponds to backward path v1, v2, ..., vk.Now let\'s describe the game that the Smart Beaver from ABBYY has come up with. The game uses two rooted trees, each of which initially consists of one vertex with number 1. The player is given some sequence of operations. Each operation is characterized by three values (t, v, c) where:   t is the number of the tree on which the operation is executed (1 or 2);  v is the vertex index in this tree (it is guaranteed that the tree contains a vertex with this index);  c is a lowercase English letter. The actual operation is as follows: vertex v of tree t gets a new descendant with number m\xe2\x80\x89+\xe2\x80\x891 (where m is the current number of vertices in tree t), and there should be letter c put on the new edge from vertex v to vertex m\xe2\x80\x89+\xe2\x80\x891.We\'ll say that an ordered group of three integers (i, j, q) is a good combination if:   1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m1, where m1 is the number of vertices in the first tree;  1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j,\xe2\x80\x89q\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m2, where m2 is the number of vertices in the second tree;  there exists a forward path v1, v2, ..., vk such that v1\xe2\x80\x89=\xe2\x80\x89j and vk\xe2\x80\x89=\xe2\x80\x89q in the second tree;  the string that corresponds to the forward path in the second tree from vertex j to vertex q equals the string that corresponds to the backward path in the first tree from vertex i to vertex 1 (note that both paths are determined uniquely). Your task is to calculate the number of existing good combinations after each operation on the trees." "data structures" 2700
989A "A Blend of Springtime" "When the curtains are opened, a canvas unfolds outside. Kanno marvels at all the blonde colours along the riverside \xe2\x80\x94 not tangerines, but blossoms instead.""What a pity it\'s already late spring,"" sighs Mino with regret, ""one more drizzling night and they\'d be gone.""""But these blends are at their best, aren\'t they?"" Absorbed in the landscape, Kanno remains optimistic. The landscape can be expressed as a row of consecutive cells, each of which either contains a flower of colour amber or buff or canary yellow, or is empty.When a flower withers, it disappears from the cell that it originally belonged to, and it spreads petals of its colour in its two neighbouring cells (or outside the field if the cell is on the side of the landscape). In case petals fall outside the given cells, they simply become invisible.You are to help Kanno determine whether it\'s possible that after some (possibly none or all) flowers shed their petals, at least one of the cells contains all three colours, considering both petals and flowers. Note that flowers can wither in arbitrary order." implementation,strings 900
1406C "Link Cut Centroids" "Fishing Prince loves trees, and he especially loves trees with only one centroid. The tree is a connected graph without cycles.A vertex is a centroid of a tree only when you cut this vertex (remove it and remove all edges from this vertex), the size of the largest connected component of the remaining graph is the smallest possible.For example, the centroid of the following tree is 2, because when you cut it, the size of the largest connected component of the remaining graph is 2 and it can\'t be smaller.  However, in some trees, there might be more than one centroid, for example:  Both vertex 1 and vertex 2 are centroids because the size of the largest connected component is 3 after cutting each of them.Now Fishing Prince has a tree. He should cut one edge of the tree (it means to remove the edge). After that, he should add one edge. The resulting graph after these two operations should be a tree. He can add the edge that he cut.He wants the centroid of the resulting tree to be unique. Help him and find any possible way to make the operations. It can be proved, that at least one such way always exists." "constructive algorithms,dfs and similar,graphs,trees" 1700
1887B "Time Travel" "Berland is a country with ancient history, where roads were built and destroyed for centuries. It is known that there always were n cities in Berland. You also have records of t key moments in the history of the country, numbered from 1 to t. Each record contains a list of bidirectional roads between some pairs of cities, which could be used for travel in Berland at a specific moment in time.You have discovered a time machine that transports you between key moments. Unfortunately, you cannot choose what point in time to end up at, but you know the order consisting of k moments in time ai, in which the machine will transport you. Since there is little time between the travels, when you find yourself in the next key moment in time (including after the last time travel), you can travel on at most one existing road at that moment, coming out from the city you were in before time travel.Currently, you are in city 1, and the time machine has already transported you to moment a1. You want to reach city n as quickly as possible. Determine the minimum number of time travels, including the first one, that you need to make in order to reach city n." "binary search,graphs,shortest paths" 1900
1889A "Qingshan Loves Strings 2" "Qingshan has a string s which only contains 0 and 1.A string a of length k is good if and only if  ai\xe2\x89\xa0ak\xe2\x88\x92i+1 for all i=1,2,\xe2\x80\xa6,k. For Div. 2 contestants, note that this condition is different from the condition in problem B.For example, 10, 1010, 111000 are good, while 11, 101, 001, 001100 are not good.Qingshan wants to make s good. To do this, she can do the following operation at most 300 times (possibly, zero):   insert 01 to any position of s (getting a new s). Please tell Qingshan if it is possible to make s good. If it is possible, print a sequence of operations that makes s good." "constructive algorithms,greedy,implementation" 1300
79C Beaver "After Fox Ciel got off a bus, she found that the bus she was on was a wrong bus and she lost her way in a strange town. However, she fortunately met her friend Beaver Taro and asked which way to go to her castle. Taro\'s response to her was a string s, and she tried to remember the string s correctly.However, Ciel feels n strings b1,\xe2\x80\x89b2,\xe2\x80\x89... ,\xe2\x80\x89bn are really boring, and unfortunately she dislikes to remember a string that contains a boring substring. To make the thing worse, what she can remember is only the contiguous substring of s.Determine the longest contiguous substring of s that does not contain any boring string, so that she can remember the longest part of Taro\'s response." "data structures,dp,greedy,hashing,strings,two pointers" 1800
1627F "Not Splitting" "There is a k\xc3\x97k grid, where k is even. The square in row r and column c is denoted by (r,c). Two squares (r1,c1) and (r2,c2) are considered adjacent if |r1\xe2\x88\x92r2|+|c1\xe2\x88\x92c2|=1.An array of adjacent pairs of squares is called strong if it is possible to cut the grid along grid lines into two connected, congruent pieces so that each pair is part of the same piece. Two pieces are congruent if one can be matched with the other by translation, rotation, and reflection, or a combination of these.  The picture above represents the first test case. Arrows indicate pairs of squares, and the thick black line represents the cut. You are given an array a of n pairs of adjacent squares. Find the size of the largest strong subsequence of a. An array p is a subsequence of an array q if p can be obtained from q by deletion of several (possibly, zero or all) elements." "geometry,graphs,greedy,implementation,shortest paths" 2700
1194F "Crossword Expert" "Today Adilbek is taking his probability theory test. Unfortunately, when Adilbek arrived at the university, there had already been a long queue of students wanting to take the same test. Adilbek has estimated that he will be able to start the test only T seconds after coming. Fortunately, Adilbek can spend time without revising any boring theorems or formulas. He has an app on this smartphone which contains n Japanese crosswords to solve. Adilbek has decided to solve them all one by one in the order they are listed in the app, without skipping any crossword. For each crossword, a number ti is given that represents the time it takes an average crossword expert to solve this crossword (the time is given in seconds).Adilbek is a true crossword expert, but, unfortunately, he is sometimes unlucky in choosing the way to solve the crossword. So, it takes him either ti seconds or ti+1 seconds to solve the i-th crossword, equiprobably (with probability 12 he solves the crossword in exactly ti seconds, and with probability 12 he has to spend an additional second to finish the crossword). All these events are independent.After T seconds pass (or after solving the last crossword, if he manages to do it in less than T seconds), Adilbek closes the app (if he finishes some crossword at the same moment, that crossword is considered solved; otherwise Adilbek does not finish solving the current crossword at all). He thinks it would be an interesting probability theory problem to calculate E \xe2\x80\x94 the expected number of crosswords he will be able to solve completely. Can you calculate it? Recall that the expected value of a discrete random variable is the probability-weighted average of all possible values \xe2\x80\x94 in this problem it means that the expected value of the number of solved crosswords can be calculated as E=n\xe2\x88\x91i=0ipi, where pi is the probability that Adilbek will solve exactly i crosswords. We can represent E as rational fraction PQ with Q>0. To give the answer, you should print P\xe2\x8b\x85Q\xe2\x88\x921mod(109+7)." "combinatorics,dp,number theory,probabilities,two pointers" 2400
835C "Star sky" "The Cartesian coordinate system is set in the sky. There you can see n stars, the i-th has coordinates (xi, yi), a maximum brightness c, equal for all stars, and an initial brightness si (0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89si\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89c).Over time the stars twinkle. At moment 0 the i-th star has brightness si. Let at moment t some star has brightness x. Then at moment (t\xe2\x80\x89+\xe2\x80\x891) this star will have brightness x\xe2\x80\x89+\xe2\x80\x891, if x\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89c, and 0, otherwise.You want to look at the sky q times. In the i-th time you will look at the moment ti and you will see a rectangle with sides parallel to the coordinate axes, the lower left corner has coordinates (x1i, y1i) and the upper right \xe2\x80\x94 (x2i, y2i). For each view, you want to know the total brightness of the stars lying in the viewed rectangle.A star lies in a rectangle if it lies on its border or lies strictly inside it." dp,implementation 1600
11C "How Many Squares?" "You are given a 0-1 rectangular matrix. What is the number of squares in it? A square is a solid square frame (border) with linewidth equal to 1. A square should be at least 2\xe2\x80\x89\xc3\x97\xe2\x80\x892. We are only interested in two types of squares:   squares with each side parallel to a side of the matrix;  squares with each side parallel to a diagonal of the matrix. For example the following matrix contains only one square of the first type: 0000000 0111100 0100100 0100100 0111100The following matrix contains only one square of the second type:00000000010000010100000100000000000Regardless of type, a square must contain at least one 1 and can\'t touch (by side or corner) any foreign 1. Of course, the lengths of the sides of each square should be equal.How many squares are in the given matrix?" implementation 2200
439B "Devu, the Dumb Guy" "Devu is a dumb guy, his learning curve is very slow. You are supposed to teach him n subjects, the ith subject has ci chapters. When you teach him, you are supposed to teach all the chapters of a subject continuously.Let us say that his initial per chapter learning power of a subject is x hours. In other words he can learn a chapter of a particular subject in x hours.Well Devu is not complete dumb, there is a good thing about him too. If you teach him a subject, then time required to teach any chapter of the next subject will require exactly 1 hour less than previously required (see the examples to understand it more clearly). Note that his per chapter learning power can not be less than 1 hour.You can teach him the n subjects in any possible order. Find out minimum amount of time (in hours) Devu will take to understand all the subjects and you will be free to do some enjoying task rather than teaching a dumb guy.Please be careful that answer might not fit in 32 bit data type." implementation,sortings 1200
1702C "Train and Queries" "Along the railroad there are stations indexed from 1 to 109. An express train always travels along a route consisting of n stations with indices u1,u2,\xe2\x80\xa6,un, where (1\xe2\x89\xa4ui\xe2\x89\xa4109). The train travels along the route from left to right. It starts at station u1, then stops at station u2, then at u3, and so on. Station un \xe2\x80\x94 the terminus.It is possible that the train will visit the same station more than once. That is, there may be duplicates among the values u1,u2,\xe2\x80\xa6,un.You are given k queries, each containing two different integers aj and bj (1\xe2\x89\xa4aj,bj\xe2\x89\xa4109). For each query, determine whether it is possible to travel by train from the station with index aj to the station with index bj.For example, let the train route consist of 6 of stations with indices [3,7,1,5,1,4] and give 3 of the following queries:   a1=3, b1=5It is possible to travel from station 3 to station 5 by taking a section of the route consisting of stations [3,7,1,5]. Answer: YES.  a2=1, b2=7You cannot travel from station 1 to station 7 because the train cannot travel in the opposite direction. Answer: NO.  a3=3, b3=10It is not possible to travel from station 3 to station 10 because station 10 is not part of the train\'s route. Answer: NO." "data structures,greedy" 1100
1172C2 "Nauuo and Pictures (hard version)" "The only difference between easy and hard versions is constraints.Nauuo is a girl who loves random picture websites.One day she made a random picture website by herself which includes n pictures.When Nauuo visits the website, she sees exactly one picture. The website does not display each picture with equal probability. The i-th picture has a non-negative weight wi, and the probability of the i-th picture being displayed is wi\xe2\x88\x91nj=1wj. That is to say, the probability of a picture to be displayed is proportional to its weight.However, Nauuo discovered that some pictures she does not like were displayed too often. To solve this problem, she came up with a great idea: when she saw a picture she likes, she would add 1 to its weight; otherwise, she would subtract 1 from its weight.Nauuo will visit the website m times. She wants to know the expected weight of each picture after all the m visits modulo 998244353. Can you help her?The expected weight of the i-th picture can be denoted by qipi where gcd(pi,qi)=1, you need to print an integer ri satisfying 0\xe2\x89\xa4ri<998244353 and ri\xe2\x8b\x85pi\xe2\x89\xa1qi(mod998244353). It can be proved that such ri exists and is unique." dp,probabilities 2600
416C "Booking System" "Innovation technologies are on a victorious march around the planet. They integrate into all spheres of human activity!A restaurant called ""Dijkstra\'s Place"" has started thinking about optimizing the booking system. There are n booking requests received by now. Each request is characterized by two numbers: ci and pi \xe2\x80\x94 the size of the group of visitors who will come via this request and the total sum of money they will spend in the restaurant, correspondingly.We know that for each request, all ci people want to sit at the same table and are going to spend the whole evening in the restaurant, from the opening moment at 18:00 to the closing moment.Unfortunately, there only are k tables in the restaurant. For each table, we know ri \xe2\x80\x94 the maximum number of people who can sit at it. A table can have only people from the same group sitting at it. If you cannot find a large enough table for the whole group, then all visitors leave and naturally, pay nothing.Your task is: given the tables and the requests, decide which requests to accept and which requests to decline so that the money paid by the happy and full visitors was maximum." "binary search,dp,greedy,implementation" 1600
1779B "MKnez\'s ConstructiveForces Task" "MKnez wants to construct an array s1,s2,\xe2\x80\xa6,sn satisfying the following conditions:  Each element is an integer number different from 0;  For each pair of adjacent elements their sum is equal to the sum of the whole array. More formally, si\xe2\x89\xa00 must hold for each 1\xe2\x89\xa4i\xe2\x89\xa4n. Moreover, it must hold that s1+s2+\xe2\x8b\xaf+sn=si+si+1 for each 1\xe2\x89\xa4i<n.Help MKnez to construct an array with these properties or determine that it does not exist." "constructive algorithms,math" 900
1787B "Number Factorization" "Given an integer n.Consider all pairs of integer arrays a and p of the same length such that n=\xe2\x88\x8fapii (i.e. ap11\xe2\x8b\x85ap22\xe2\x8b\x85\xe2\x80\xa6) (ai>1;pi>0) and ai is the product of some (possibly one) distinct prime numbers.For example, for n=28=22\xe2\x8b\x8571=41\xe2\x8b\x8571 the array pair a=[2,7], p=[2,1] is correct, but the pair of arrays a=[4,7], p=[1,1] is not, because 4=22 is a product of non-distinct prime numbers.Your task is to find the maximum value of \xe2\x88\x91ai\xe2\x8b\x85pi (i.e. a1\xe2\x8b\x85p1+a2\xe2\x8b\x85p2+\xe2\x80\xa6) over all possible pairs of arrays a and p. Note that you do not need to minimize or maximize the length of the arrays." "greedy,math,number theory" 1100
294B "Shaass and Bookshelf" "Shaass has n books. He wants to make a bookshelf for all his books. He wants the bookshelf\'s dimensions to be as small as possible. The thickness of the i-th book is ti and its pages\' width is equal to wi. The thickness of each book is either 1 or 2. All books have the same page heights.  Shaass puts the books on the bookshelf in the following way. First he selects some of the books and put them vertically. Then he puts the rest of the books horizontally above the vertical books. The sum of the widths of the horizontal books must be no more than the total thickness of the vertical books. A sample arrangement of the books is depicted in the figure.  Help Shaass to find the minimum total thickness of the vertical books that we can achieve." dp,greedy 1700
309A "Morning run" "People like to be fit. That\'s why many of them are ready to wake up at dawn, go to the stadium and run. In this problem your task is to help a company design a new stadium. The city of N has a shabby old stadium. Many people like it and every morning thousands of people come out to this stadium to run. The stadium can be represented as a circle, its length is exactly l meters with a marked start line. However, there can\'t be simultaneous start in the morning, so exactly at 7, each runner goes to his favorite spot on the stadium and starts running from there. Note that not everybody runs in the same manner as everybody else. Some people run in the clockwise direction, some of them run in the counter-clockwise direction. It mostly depends on the runner\'s mood in the morning, so you can assume that each running direction is equiprobable for each runner in any fixed morning. The stadium is tiny and is in need of major repair, for right now there only is one running track! You can\'t get too playful on a single track, that\'s why all runners keep the same running speed \xe2\x80\x94 exactly 1 meter per a time unit. Nevertheless, the runners that choose different directions bump into each other as they meet. The company wants to design a new stadium, but they first need to know how bad the old one is. For that they need the expectation of the number of bumpings by t time units after the running has begun. Help the company count the required expectation. Note that each runner chooses a direction equiprobably, independently from the others and then all runners start running simultaneously at 7 a.m. Assume that each runner runs for t time units without stopping. Consider the runners to bump at a certain moment if at that moment they found themselves at the same point in the stadium. A pair of runners can bump more than once." "binary search,math,two pointers" 2000
1311A "Add Odd or Subtract Even" "You are given two positive integers a and b.In one move, you can change a in the following way:  Choose any positive odd integer x (x>0) and replace a with a+x;  choose any positive even integer y (y>0) and replace a with a\xe2\x88\x92y. You can perform as many such operations as you want. You can choose the same numbers x and y in different moves.Your task is to find the minimum number of moves required to obtain b from a. It is guaranteed that you can always obtain b from a.You have to answer t independent test cases." greedy,implementation,math 800
745A "Hongcow Learns the Cyclic Shift" "Hongcow is learning to spell! One day, his teacher gives him a word that he needs to learn to spell. Being a dutiful student, he immediately learns how to spell the word.Hongcow has decided to try to make new words from this one. He starts by taking the word he just learned how to spell, and moves the last character of the word to the beginning of the word. He calls this a cyclic shift. He can apply cyclic shift many times. For example, consecutively applying cyclic shift operation to the word ""abracadabra"" Hongcow will get words ""aabracadabr"", ""raabracadab"" and so on.Hongcow is now wondering how many distinct words he can generate by doing the cyclic shift arbitrarily many times. The initial string is also counted." implementation,strings 900
314A "Sereja and Contest" "During the last Sereja\'s Codesecrof round the server crashed many times, so the round was decided to be made unrated for some participants. Let\'s assume that n people took part in the contest. Let\'s assume that the participant who got the first place has rating a1, the second place participant has rating a2, ..., the n-th place participant has rating an. Then changing the rating on the Codesecrof site is calculated by the formula .After the round was over, the Codesecrof management published the participants\' results table. They decided that if for a participant di\xe2\x80\x89<\xe2\x80\x89k, then the round can be considered unrated for him. But imagine the management\'s surprise when they found out that the participants\' rating table is dynamic. In other words, when some participant is removed from the rating, he is removed from the results\' table and the rating is recalculated according to the new table. And of course, all applications for exclusion from the rating are considered in view of the current table.We know that among all the applications for exclusion from the rating the first application to consider is from the participant with the best rank (the rank with the minimum number), for who di\xe2\x80\x89<\xe2\x80\x89k. We also know that the applications for exclusion from rating were submitted by all participants.Now Sereja wonders, what is the number of participants to be excluded from the contest rating, and the numbers of the participants in the original table in the order of their exclusion from the rating. Pay attention to the analysis of the first test case for a better understanding of the statement." implementation 1600
1951A "Dual Trigger" "Ng\xe1\xbb\x8dt - L\xe1\xba\xa6N CU\xe1\xbb\x90I (\xc4\x91i b\xc3\xaan em x\xc3\xb3t xa ng\xc6\xb0\xe1\xbb\x9di \xc6\xa1i)\xe0\xb6\x9eThere are n lamps numbered 1 to n lined up in a row, initially turned off. You can perform the following operation any number of times (possibly zero):   Choose two non-adjacent\xe2\x80\xa0 lamps that are currently turned off, then turn them on. Determine whether you can reach configuration s, where si=1 means the i-th lamp is turned on, and si=0 otherwise.\xe2\x80\xa0 Only lamp i and i+1 are adjacent for all 1\xe2\x89\xa4i<n. Note that lamp n and 1 are not adjacent when n\xe2\x89\xa02." "constructive algorithms,greedy,math" 900
822D "My pretty girl Noora" "In Pavlopolis University where Noora studies it was decided to hold beauty contest ""Miss Pavlopolis University"". Let\'s describe the process of choosing the most beautiful girl in the university in more detail.The contest is held in several stages. Suppose that exactly n girls participate in the competition initially. All the participants are divided into equal groups, x participants in each group. Furthermore the number x is chosen arbitrarily, i. e. on every stage number x can be different. Within each group the jury of the contest compares beauty of the girls in the format ""each with each"". In this way, if group consists of x girls, then  comparisons occur. Then, from each group, the most beautiful participant is selected. Selected girls enter the next stage of the competition. Thus if n girls were divided into groups, x participants in each group, then exactly  participants will enter the next stage. The contest continues until there is exactly one girl left who will be ""Miss Pavlopolis University""But for the jury this contest is a very tedious task. They would like to divide the girls into groups in each stage so that the total number of pairwise comparisons of the girls is as few as possible. Let f(n) be the minimal total number of comparisons that should be made to select the most beautiful participant, if we admit n girls to the first stage.The organizers of the competition are insane. They give Noora three integers t, l and r and ask the poor girl to calculate the value of the following expression: t0\xc2\xb7f(l)\xe2\x80\x89+\xe2\x80\x89t1\xc2\xb7f(l\xe2\x80\x89+\xe2\x80\x891)\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89tr\xe2\x80\x89-\xe2\x80\x89l\xc2\xb7f(r). However, since the value of this expression can be quite large the organizers ask her to calculate it modulo 109\xe2\x80\x89+\xe2\x80\x897. If Noora can calculate the value of this expression the organizers promise her to help during the beauty contest. But the poor girl is not strong in mathematics, so she turned for help to Leha and he turned to you." "brute force,dp,greedy,math,number theory" 1800
1221B Knights "You are given a chess board with n rows and n columns. Initially all cells of the board are empty, and you have to put a white or a black knight into each cell of the board.A knight is a chess piece that can attack a piece in cell (x2, y2) from the cell (x1, y1) if one of the following conditions is met:  |x1\xe2\x88\x92x2|=2 and |y1\xe2\x88\x92y2|=1, or  |x1\xe2\x88\x92x2|=1 and |y1\xe2\x88\x92y2|=2. Here are some examples of which cells knight can attack. In each of the following pictures, if the knight is currently in the blue cell, it can attack all red cells (and only them).  A duel of knights is a pair of knights of different colors such that these knights attack each other. You have to put a knight (a white one or a black one) into each cell in such a way that the number of duels is maximum possible." "constructive algorithms,greedy" 1100
1249C1 "Good Numbers (easy version)" "The only difference between easy and hard versions is the maximum value of n.You are given a positive integer number n. You really love good numbers so you want to find the smallest good number greater than or equal to n.The positive integer is called good if it can be represented as a sum of distinct powers of 3 (i.e. no duplicates of powers of 3 are allowed).For example:  30 is a good number: 30=33+31,  1 is a good number: 1=30,  12 is a good number: 12=32+31,  but 2 is not a good number: you can\'t represent it as a sum of distinct powers of 3 (2=30+30),  19 is not a good number: you can\'t represent it as a sum of distinct powers of 3 (for example, the representations 19=32+32+30=32+31+31+31+30 are invalid),  20 is also not a good number: you can\'t represent it as a sum of distinct powers of 3 (for example, the representation 20=32+32+30+30 is invalid). Note, that there exist other representations of 19 and 20 as sums of powers of 3 but none of them consists of distinct powers of 3.For the given positive integer n find such smallest m (n\xe2\x89\xa4m) that m is a good number.You have to answer q independent queries." "brute force,greedy,implementation" 1300
1926E "Vlad and an Odd Ordering" "Vladislav has n cards numbered 1,2,\xe2\x80\xa6,n. He wants to lay them down in a row as follows:   First, he lays down all the odd-numbered cards from smallest to largest.  Next, he lays down all cards that are twice an odd number from smallest to largest (i.e. 2 multiplied by an odd number).  Next, he lays down all cards that are 3 times an odd number from smallest to largest (i.e. 3 multiplied by an odd number).  Next, he lays down all cards that are 4 times an odd number from smallest to largest (i.e. 4 multiplied by an odd number).  And so on, until all cards are laid down.  What is the k-th card he lays down in this process? Once Vladislav puts a card down, he cannot use that card again." "binary search,bitmasks,data structures,dp,implementation,math,number theory" 1500
648D "\xd0\xa1\xd0\xbe\xd0\xb1\xd0\xb0\xd1\x87\xd0\xba\xd0\xb8 \xd0\xb8 \xd0\xbc\xd0\xb8\xd1\x81\xd0\xba\xd0\xb8" "\xd0\x9d\xd0\xb0 \xd0\xba\xd0\xbe\xd0\xbe\xd1\x80\xd0\xb4\xd0\xb8\xd0\xbd\xd0\xb0\xd1\x82\xd0\xbd\xd0\xbe\xd0\xb9 \xd0\xbf\xd1\x80\xd1\x8f\xd0\xbc\xd0\xbe\xd0\xb9 \xd1\x81\xd0\xb8\xd0\xb4\xd0\xb8\xd1\x82 n \xd1\x81\xd0\xbe\xd0\xb1\xd0\xb0\xd1\x87\xd0\xb5\xd0\xba, i-\xd1\x8f \xd1\x81\xd0\xbe\xd0\xb1\xd0\xb0\xd1\x87\xd0\xba\xd0\xb0 \xd0\xbd\xd0\xb0\xd1\x85\xd0\xbe\xd0\xb4\xd0\xb8\xd1\x82\xd1\x81\xd1\x8f \xd0\xb2 \xd1\x82\xd0\xbe\xd1\x87\xd0\xba\xd0\xb5 xi. \xd0\x9a\xd1\x80\xd0\xbe\xd0\xbc\xd0\xb5 \xd1\x82\xd0\xbe\xd0\xb3\xd0\xbe, \xd0\xbd\xd0\xb0 \xd0\xbf\xd1\x80\xd1\x8f\xd0\xbc\xd0\xbe\xd0\xb9 \xd0\xb5\xd1\x81\xd1\x82\xd1\x8c m \xd0\xbc\xd0\xb8\xd1\x81\xd0\xbe\xd0\xba \xd1\x81 \xd0\xb5\xd0\xb4\xd0\xbe\xd0\xb9, \xd0\xb4\xd0\xbb\xd1\x8f \xd0\xba\xd0\xb0\xd0\xb6\xd0\xb4\xd0\xbe\xd0\xb9 \xd0\xb8\xd0\xb7\xd0\xb2\xd0\xb5\xd1\x81\xd1\x82\xd0\xbd\xd0\xb0 \xd0\xb5\xd1\x91 \xd0\xba\xd0\xbe\xd0\xbe\xd1\x80\xd0\xb4\xd0\xb8\xd0\xbd\xd0\xb0\xd1\x82\xd0\xb0 \xd0\xbd\xd0\xb0 \xd0\xbf\xd1\x80\xd1\x8f\xd0\xbc\xd0\xbe\xd0\xb9 uj \xd0\xb8 \xd0\xb2\xd1\x80\xd0\xb5\xd0\xbc\xd1\x8f tj, \xd1\x87\xd0\xb5\xd1\x80\xd0\xb5\xd0\xb7 \xd0\xba\xd0\xbe\xd1\x82\xd0\xbe\xd1\x80\xd0\xbe\xd0\xb5 \xd0\xb5\xd0\xb4\xd0\xb0 \xd0\xb2 \xd0\xbc\xd0\xb8\xd1\x81\xd0\xba\xd0\xb5 \xd0\xbe\xd1\x81\xd1\x82\xd1\x8b\xd0\xbd\xd0\xb5\xd1\x82 \xd0\xb8 \xd1\x81\xd1\x82\xd0\xb0\xd0\xbd\xd0\xb5\xd1\x82 \xd0\xbd\xd0\xb5\xd0\xb2\xd0\xba\xd1\x83\xd1\x81\xd0\xbd\xd0\xbe\xd0\xb9. \xd0\xad\xd1\x82\xd0\xbe \xd0\xb7\xd0\xbd\xd0\xb0\xd1\x87\xd0\xb8\xd1\x82, \xd1\x87\xd1\x82\xd0\xbe \xd0\xb5\xd1\x81\xd0\xbb\xd0\xb8 \xd1\x81\xd0\xbe\xd0\xb1\xd0\xb0\xd1\x87\xd0\xba\xd0\xb0 \xd0\xbf\xd1\x80\xd0\xb8\xd0\xb1\xd0\xb5\xd0\xb6\xd0\xb8\xd1\x82 \xd0\xba \xd0\xbc\xd0\xb8\xd1\x81\xd0\xba\xd0\xb5 \xd0\xb2 \xd0\xbc\xd0\xbe\xd0\xbc\xd0\xb5\xd0\xbd\xd1\x82 \xd0\xb2\xd1\x80\xd0\xb5\xd0\xbc\xd0\xb5\xd0\xbd\xd0\xb8, \xd1\x81\xd1\x82\xd1\x80\xd0\xbe\xd0\xb3\xd0\xbe \xd0\xb1\xd0\xbe\xd0\xbb\xd1\x8c\xd1\x88\xd0\xb8\xd0\xb9 tj, \xd1\x82\xd0\xbe \xd0\xb5\xd0\xb4\xd0\xb0 \xd1\x83\xd0\xb6\xd0\xb5 \xd0\xbe\xd1\x81\xd1\x82\xd1\x8b\xd0\xbd\xd0\xb5\xd1\x82, \xd0\xb8 \xd1\x81\xd0\xbe\xd0\xb1\xd0\xb0\xd1\x87\xd0\xba\xd0\xb0 \xd0\xba\xd1\x83\xd1\x88\xd0\xb0\xd1\x82\xd1\x8c \xd0\xb5\xd1\x91 \xd0\xbd\xd0\xb5 \xd1\x81\xd1\x82\xd0\xb0\xd0\xbd\xd0\xb5\xd1\x82.\xd0\xa1\xd1\x87\xd0\xb8\xd1\x82\xd0\xb0\xd1\x8f, \xd1\x87\xd1\x82\xd0\xbe \xd0\xba\xd0\xb0\xd0\xb6\xd0\xb4\xd0\xb0\xd1\x8f \xd1\x81\xd0\xbe\xd0\xb1\xd0\xb0\xd1\x87\xd0\xba\xd0\xb0 \xd0\xb1\xd0\xb5\xd0\xb6\xd0\xb8\xd1\x82 \xd1\x81\xd0\xbe \xd1\x81\xd0\xba\xd0\xbe\xd1\x80\xd0\xbe\xd1\x81\xd1\x82\xd1\x8c\xd1\x8e 1, \xd0\xbd\xd0\xb0\xd0\xb9\xd0\xb4\xd0\xb8\xd1\x82\xd0\xb5 \xd0\xbc\xd0\xb0\xd0\xba\xd1\x81\xd0\xb8\xd0\xbc\xd0\xb0\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe\xd0\xb5 \xd0\xba\xd0\xbe\xd0\xbb\xd0\xb8\xd1\x87\xd0\xb5\xd1\x81\xd1\x82\xd0\xb2\xd0\xbe \xd1\x81\xd0\xbe\xd0\xb1\xd0\xb0\xd1\x87\xd0\xb5\xd0\xba, \xd0\xba\xd0\xbe\xd1\x82\xd0\xbe\xd1\x80\xd1\x8b\xd0\xb5 \xd1\x81\xd0\xbc\xd0\xbe\xd0\xb3\xd1\x83\xd1\x82 \xd0\xbf\xd0\xbe\xd0\xba\xd1\x83\xd1\x88\xd0\xb0\xd1\x82\xd1\x8c. \xd0\xa1\xd1\x87\xd0\xb8\xd1\x82\xd0\xb0\xd0\xb9\xd1\x82\xd0\xb5, \xd1\x87\xd1\x82\xd0\xbe \xd1\x81\xd0\xbe\xd0\xb1\xd0\xb0\xd1\x87\xd0\xba\xd0\xb8 \xd0\xbf\xd0\xbe\xd0\xb1\xd0\xb5\xd0\xb3\xd1\x83\xd1\x82 \xd0\xba \xd1\x82\xd0\xb5\xd0\xbc \xd0\xbc\xd0\xb8\xd1\x81\xd0\xba\xd0\xb0\xd0\xbc, \xd0\xbd\xd0\xb0 \xd0\xba\xd0\xbe\xd1\x82\xd0\xbe\xd1\x80\xd1\x8b\xd0\xb5 \xd0\xb2\xd1\x8b \xd0\xb8\xd0\xbc \xd1\x83\xd0\xba\xd0\xb0\xd0\xb6\xd0\xb5\xd1\x82\xd0\xb5. \xd0\x98\xd0\xb7 \xd0\xbe\xd0\xb4\xd0\xbd\xd0\xbe\xd0\xb9 \xd0\xbc\xd0\xb8\xd1\x81\xd0\xba\xd0\xb8 \xd0\xbd\xd0\xb5 \xd0\xbc\xd0\xbe\xd0\xb3\xd1\x83\xd1\x82 \xd0\xba\xd1\x83\xd1\x88\xd0\xb0\xd1\x82\xd1\x8c \xd0\xb4\xd0\xb2\xd0\xb5 \xd0\xb8\xd0\xbb\xd0\xb8 \xd0\xb1\xd0\xbe\xd0\xbb\xd0\xb5\xd0\xb5 \xd1\x81\xd0\xbe\xd0\xb1\xd0\xb0\xd1\x87\xd0\xba\xd0\xb8.\xd0\xa1\xd0\xbe\xd0\xb1\xd0\xb0\xd1\x87\xd0\xba\xd0\xb8 \xd0\xbc\xd0\xbe\xd0\xb3\xd1\x83\xd1\x82 \xd0\xbe\xd0\xb1\xd0\xb3\xd0\xbe\xd0\xbd\xd1\x8f\xd1\x82\xd1\x8c \xd0\xb4\xd1\x80\xd1\x83\xd0\xb3 \xd0\xb4\xd1\x80\xd1\x83\xd0\xb3\xd0\xb0, \xd1\x82\xd0\xbe \xd0\xb5\xd1\x81\xd1\x82\xd1\x8c, \xd0\xb5\xd1\x81\xd0\xbb\xd0\xb8 \xd0\xbe\xd0\xb4\xd0\xbd\xd0\xb0 \xd0\xb8\xd0\xb7 \xd0\xbd\xd0\xb8\xd1\x85 \xd0\xbe\xd1\x81\xd1\x82\xd0\xb0\xd0\xbd\xd0\xbe\xd0\xb2\xd0\xb8\xd1\x82\xd1\x81\xd1\x8f \xd0\xbf\xd0\xbe\xd0\xba\xd1\x83\xd1\x88\xd0\xb0\xd1\x82\xd1\x8c, \xd0\xb4\xd1\x80\xd1\x83\xd0\xb3\xd0\xb0\xd1\x8f \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xb5\xd1\x82 \xd0\xbf\xd1\x80\xd0\xbe\xd0\xb9\xd1\x82\xd0\xb8 \xd0\xbc\xd0\xb8\xd0\xbc\xd0\xbe \xd0\xbd\xd0\xb5\xd1\x91, \xd1\x87\xd1\x82\xd0\xbe\xd0\xb1\xd1\x8b \xd0\xbf\xd0\xbe\xd0\xbf\xd0\xb0\xd1\x81\xd1\x82\xd1\x8c \xd0\xba \xd0\xb4\xd1\x80\xd1\x83\xd0\xb3\xd0\xbe\xd0\xb9 \xd0\xbc\xd0\xb8\xd1\x81\xd0\xba\xd0\xb5." "data structures,greedy,sortings" 1900
1955F "Unfair Game" "Alice and Bob gathered in the evening to play an exciting game on a sequence of n integers, each integer of the sequence doesn\'t exceed 4. The rules of the game are too complex to describe, so let\'s just describe the winning condition \xe2\x80\x94 Alice wins if the bitwise XOR of all the numbers in the sequence is non-zero; otherwise, Bob wins.The guys invited Eve to act as a judge. Initially, Alice and Bob play with n numbers. After one game, Eve removes one of the numbers from the sequence, then Alice and Bob play with n\xe2\x88\x921 numbers. Eve removes one number again, after which Alice and Bob play with n\xe2\x88\x922 numbers. This continues until the sequence of numbers is empty.Eve seems to think that in such a game, Alice almost always wins, so she wants Bob to win as many times as possible. Determine the maximum number of times Bob can win against Alice if Eve removes the numbers optimally." dp,games,greedy,math,schedules 1800
868E "Policeman and a Tree" "You are given a tree (a connected non-oriented graph without cycles) with vertices numbered from 1 to n, and the length of the i-th edge is wi. In the vertex s there is a policeman, in the vertices x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xm (xj\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89s) m criminals are located.The policeman can walk along the edges with speed 1, the criminals can move with arbitrary large speed. If a criminal at some moment is at the same point as the policeman, he instantly gets caught by the policeman. Determine the time needed for the policeman to catch all criminals, assuming everybody behaves optimally (i.e. the criminals maximize that time, the policeman minimizes that time). Everybody knows positions of everybody else at any moment of time." dp,graphs,trees 2700
898E "Squares and not squares" "Ann and Borya have n piles with candies and n is even number. There are ai candies in pile with number i.Ann likes numbers which are square of some integer and Borya doesn\'t like numbers which are square of any integer. During one move guys can select some pile with candies and add one candy to it (this candy is new and doesn\'t belong to any other pile) or remove one candy (if there is at least one candy in this pile). Find out minimal number of moves that is required to make exactly n\xe2\x80\x89/\xe2\x80\x892 piles contain number of candies that is a square of some integer and exactly n\xe2\x80\x89/\xe2\x80\x892 piles contain number of candies that is not a square of any integer." "constructive algorithms,greedy" 1600
114B "PFAST Inc." "When little Petya grew up and entered the university, he started to take part in \xd0\x90\xd0\xa1\xd0\x9c contests. Later he realized that he doesn\'t like how the \xd0\x90\xd0\xa1\xd0\x9c contests are organised: the team could only have three members (and he couldn\'t take all his friends to the competitions and distribute the tasks between the team members efficiently), so he decided to organize his own contests PFAST Inc. \xe2\x80\x94 Petr and Friends Are Solving Tasks Corporation. PFAST Inc. rules allow a team to have unlimited number of members.To make this format of contests popular he organised his own tournament. To create the team he will prepare for the contest organised by the PFAST Inc. rules, he chose several volunteers (up to 16 people) and decided to compile a team from them. Petya understands perfectly that if a team has two people that don\'t get on well, then the team will perform poorly. Put together a team with as many players as possible given that all players should get on well with each other." "bitmasks,brute force,graphs" 1500
1028B "Unnatural Conditions" "Let s(x) be sum of digits in decimal representation of positive integer x. Given two integers n and m, find some positive integers a and b such that   s(a)\xe2\x89\xa5n,  s(b)\xe2\x89\xa5n,  s(a+b)\xe2\x89\xa4m." "constructive algorithms,math" 1200
1190B "Tokitsukaze, CSL and Stone Game" "Tokitsukaze and CSL are playing a little game of stones.In the beginning, there are n piles of stones, the i-th pile of which has ai stones. The two players take turns making moves. Tokitsukaze moves first. On each turn the player chooses a nonempty pile and removes exactly one stone from the pile. A player loses if all of the piles are empty before his turn, or if after removing the stone, two piles (possibly empty) contain the same number of stones. Supposing that both players play optimally, who will win the game?Consider an example: n=3 and sizes of piles are a1=2, a2=3, a3=0. It is impossible to choose the empty pile, so Tokitsukaze has two choices: the first and the second piles. If she chooses the first pile then the state will be [1,3,0] and it is a good move. But if she chooses the second pile then the state will be [2,2,0] and she immediately loses. So the only good move for her is to choose the first pile. Supposing that both players always take their best moves and never make mistakes, who will win the game?Note that even if there are two piles with the same number of stones at the beginning, Tokitsukaze may still be able to make a valid first move. It is only necessary that there are no two piles with the same number of stones after she moves." games 1800
538C "Tourist\'s Notes" "A tourist hiked along the mountain range. The hike lasted for n days, during each day the tourist noted height above the sea level. On the i-th day height was equal to some integer hi. The tourist pick smooth enough route for his hike, meaning that the between any two consecutive days height changes by at most 1, i.e. for all i\'s from 1 to n\xe2\x80\x89-\xe2\x80\x891 the inequality |hi\xe2\x80\x89-\xe2\x80\x89hi\xe2\x80\x89+\xe2\x80\x891|\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x891 holds.At the end of the route the tourist rafted down a mountain river and some notes in the journal were washed away. Moreover, the numbers in the notes could have been distorted. Now the tourist wonders what could be the maximum height during his hike. Help him restore the maximum possible value of the maximum height throughout the hike or determine that the notes were so much distorted that they do not represent any possible height values that meet limits |hi\xe2\x80\x89-\xe2\x80\x89hi\xe2\x80\x89+\xe2\x80\x891|\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x891." "binary search,brute force,greedy,implementation,math" 1600
1276A "As Simple as One and Two" "You are given a non-empty string s=s1s2\xe2\x80\xa6sn, which consists only of lowercase Latin letters. Polycarp does not like a string if it contains at least one string ""one"" or at least one string ""two"" (or both at the same time) as a substring. In other words, Polycarp does not like the string s if there is an integer j (1\xe2\x89\xa4j\xe2\x89\xa4n\xe2\x88\x922), that sjsj+1sj+2=""one"" or sjsj+1sj+2=""two"".For example:  Polycarp does not like strings ""oneee"", ""ontwow"", ""twone"" and ""oneonetwo"" (they all have at least one substring ""one"" or ""two""),  Polycarp likes strings ""oonnee"", ""twwwo"" and ""twnoe"" (they have no substrings ""one"" and ""two""). Polycarp wants to select a certain set of indices (positions) and remove all letters on these positions. All removals are made at the same time.For example, if the string looks like s=""onetwone"", then if Polycarp selects two indices 3 and 6, then ""onetwone"" will be selected and the result is ""ontwne"".What is the minimum number of indices (positions) that Polycarp needs to select to make the string liked? What should these positions be?" dp,greedy 1400
1941E "Rudolf and k Bridges" "Bernard loves visiting Rudolf, but he is always running late. The problem is that Bernard has to cross the river on a ferry. Rudolf decided to help his friend solve this problem.The river is a grid of n rows and m columns. The intersection of the i-th row and the j-th column contains the number ai,j \xe2\x80\x94 the depth in the corresponding cell. All cells in the first and last columns correspond to the river banks, so the depth for them is 0.  The river may look like this. Rudolf can choose the row (i,1),(i,2),\xe2\x80\xa6,(i,m) and build a bridge over it. In each cell of the row, he can install a support for the bridge. The cost of installing a support in the cell (i,j) is ai,j+1. Supports must be installed so that the following conditions are met:  A support must be installed in cell (i,1);  A support must be installed in cell (i,m);  The distance between any pair of adjacent supports must be no more than d. The distance between supports (i,j1) and (i,j2) is |j1\xe2\x88\x92j2|\xe2\x88\x921. Building just one bridge is boring. Therefore, Rudolf decided to build k bridges on consecutive rows of the river, that is, to choose some i (1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x92k+1) and independently build a bridge on each of the rows i,i+1,\xe2\x80\xa6,i+k\xe2\x88\x921. Help Rudolf minimize the total cost of installing supports." "binary search,data structures,dp,two pointers" 1600
1256C "Platforms Jumping" "There is a river of width n. The left bank of the river is cell 0 and the right bank is cell n+1 (more formally, the river can be represented as a sequence of n+2 cells numbered from 0 to n+1). There are also m wooden platforms on a river, the i-th platform has length ci (so the i-th platform takes ci consecutive cells of the river). It is guaranteed that the sum of lengths of platforms does not exceed n.You are standing at 0 and want to reach n+1 somehow. If you are standing at the position x, you can jump to any position in the range [x+1;x+d]. However you don\'t really like the water so you can jump only to such cells that belong to some wooden platform. For example, if d=1, you can jump only to the next position (if it belongs to the wooden platform). You can assume that cells 0 and n+1 belong to wooden platforms.You want to know if it is possible to reach n+1 from 0 if you can move any platform to the left or to the right arbitrary number of times (possibly, zero) as long as they do not intersect each other (but two platforms can touch each other). It also means that you cannot change the relative order of platforms.Note that you should move platforms until you start jumping (in other words, you first move the platforms and then start jumping).For example, if n=7, m=3, d=2 and c=[1,2,1], then one of the ways to reach 8 from 0 is follow:  The first example: n=7." greedy 1700
1914F "Programming Competition" "BerSoft is the biggest IT corporation in Berland. There are n employees at BerSoft company, numbered from 1 to n. The first employee is the head of the company, and he does not have any superiors. Every other employee i has exactly one direct superior pi.Employee x is considered to be a superior (direct or indirect) of employee y if one of the following conditions holds:   employee x is the direct superior of employee y;  employee x is a superior of the direct superior of employee y. The structure of BerSoft is organized in such a way that the head of the company is superior of every employee.A programming competition is going to be held soon. Two-person teams should be created for this purpose. However, if one employee in a team is the superior of another, they are uncomfortable together. So, teams of two people should be created so that no one is the superior of the other. Note that no employee can participate in more than one team.Your task is to calculate the maximum possible number of teams according to the aforementioned rules." "dfs and similar,dp,graph matchings,greedy,trees" 1900
1476F Lanterns "There are n lanterns in a row. The lantern i is placed in position i and has power equal to pi.Each lantern can be directed to illuminate either some lanterns to the left or some lanterns to the right. If the i-th lantern is turned to the left, it illuminates all such lanterns j that j\xe2\x88\x88[i\xe2\x88\x92pi,i\xe2\x88\x921]. Similarly, if it is turned to the right, it illuminates all such lanterns j that j\xe2\x88\x88[i+1,i+pi].Your goal is to choose a direction for each lantern so each lantern is illuminated by at least one other lantern, or report that it is impossible." "binary search,data structures,dp" 3000
616F "Expensive Strings" "You are given n strings ti. Each string has cost ci.Let\'s define the function of string , where ps,\xe2\x80\x89i is the number of occurrences of s in ti, |s| is the length of the string s. Find the maximal value of function f(s) over all strings.Note that the string s is not necessarily some string from t." "data structures,sortings,string suffix structures,strings" 2700
809D "Hitchhiking in the Baltic States" "Leha and Noora decided to go on a trip in the Baltic States. As you know from the previous problem, Leha has lost his car on the parking of the restaurant. Unfortunately, requests to the watchman didn\'t helped hacker find the car, so friends decided to go hitchhiking.In total, they intended to visit n towns. However it turned out that sights in i-th town are open for visitors only on days from li to ri.What to do? Leha proposed to choose for each town i a day, when they will visit this town, i.e any integer xi in interval [li,\xe2\x80\x89ri]. After that Noora choses some subsequence of towns id1,\xe2\x80\x89id2,\xe2\x80\x89...,\xe2\x80\x89idk, which friends are going to visit, that at first they are strictly increasing, i.e idi\xe2\x80\x89<\xe2\x80\x89idi\xe2\x80\x89+\xe2\x80\x891 is for all integers i from 1 to k\xe2\x80\x89-\xe2\x80\x891, but also the dates of the friends visits are strictly increasing, i.e xidi\xe2\x80\x89<\xe2\x80\x89xidi\xe2\x80\x89+\xe2\x80\x891 is true for all integers i from 1 to k\xe2\x80\x89-\xe2\x80\x891.Please help Leha and Noora in choosing such xi for each town i, and such subsequence of towns id1,\xe2\x80\x89id2,\xe2\x80\x89...,\xe2\x80\x89idk, so that friends can visit maximal number of towns.You may assume, that Leha and Noora can start the trip any day." "data structures,dp" 2900
938F "Erasing Substrings" "You are given a string s, initially consisting of n lowercase Latin letters. After that, you perform k operations with it, where . During i-th operation you must erase some substring of length exactly 2i\xe2\x80\x89-\xe2\x80\x891 from s.Print the lexicographically minimal string you may obtain after performing k such operations." bitmasks,dp,greedy 2700
1371E1 "Asterism (Easy Version)" "This is the easy version of the problem. The difference between versions is the constraints on n and ai. You can make hacks only if all versions of the problem are solved.First, Aoi came up with the following idea for the competitive programming problem:Yuzu is a girl who collecting candies. Originally, she has x candies. There are also n enemies numbered with integers from 1 to n. Enemy i has ai candies.Yuzu is going to determine a permutation P. A permutation is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, {2,3,1,5,4} is a permutation, but {1,2,2} is not a permutation (2 appears twice in the array) and {1,3,4} is also not a permutation (because n=3 but there is the number 4 in the array).After that, she will do n duels with the enemies with the following rules:  If Yuzu has equal or more number of candies than enemy Pi, she wins the duel and gets 1 candy. Otherwise, she loses the duel and gets nothing.  The candy which Yuzu gets will be used in the next duels. Yuzu wants to win all duels. How many valid permutations P exist?This problem was easy and wasn\'t interesting for Akari, who is a friend of Aoi. And Akari made the following problem from the above idea:Let\'s define f(x) as the number of valid permutations for the integer x.You are given n, a and a prime number p\xe2\x89\xa4n. Let\'s call a positive integer x good, if the value f(x) is not divisible by p. Find all good integers x.Your task is to solve this problem made by Akari." "binary search,brute force,combinatorics,math,number theory,sortings" 1900
1005C "Summarize to the Power of Two" "A sequence a1,a2,\xe2\x80\xa6,an is called good if, for each element ai, there exists an element aj (i\xe2\x89\xa0j) such that ai+aj is a power of two (that is, 2d for some non-negative integer d).For example, the following sequences are good:  [5,3,11] (for example, for a1=5 we can choose a2=3. Note that their sum is a power of two. Similarly, such an element can be found for a2 and a3),  [1,1,1,1023],  [7,39,89,25,89],  []. Note that, by definition, an empty sequence (with a length of 0) is good.For example, the following sequences are not good:  [16] (for a1=16, it is impossible to find another element aj such that their sum is a power of two),  [4,16] (for a1=4, it is impossible to find another element aj such that their sum is a power of two),  [1,3,2,8,8,8] (for a3=2, it is impossible to find another element aj such that their sum is a power of two). You are given a sequence a1,a2,\xe2\x80\xa6,an. What is the minimum number of elements you need to remove to make it good? You can delete an arbitrary set of elements." "brute force,greedy,implementation" 1300
80A "Panoramix\'s Prediction" "A prime number is a number which has exactly two distinct divisors: one and itself. For example, numbers 2, 7, 3 are prime, and 1, 6, 4 are not.The next prime number after x is the smallest prime number greater than x. For example, the next prime number after 2 is 3, and the next prime number after 3 is 5. Note that there is exactly one next prime number after each number. So 5 is not the next prime number for 2.One cold April morning Panoramix predicted that soon Kakofonix will break free from his straitjacket, and this will be a black day for the residents of the Gallic countryside.Panoramix\'s prophecy tells that if some day Asterix and Obelix beat exactly x Roman soldiers, where x is a prime number, and next day they beat exactly y Roman soldiers, where y is the next prime number after x, then it\'s time to wait for Armageddon, for nothing can shut Kakofonix up while he sings his infernal song.Yesterday the Gauls beat n Roman soldiers and it turned out that the number n was prime! Today their victims were a troop of m Romans (m\xe2\x80\x89>\xe2\x80\x89n). Determine whether the Gauls should wait for the black day after today\'s victory of Asterix and Obelix?" "brute force" 800
1753E "N Machines" "You have been invited as a production process optimization specialist to some very large company. The company has n machines at its factory, standing one behind another in the production chain. Each machine can be described in one of the following two ways: (+, ai) or (\xe2\x88\x97, ai).If a workpiece with the value x is supplied to the machine of kind (+, ai), then the output workpiece has value x+ai.If a workpiece with the value x is supplied to the machine of kind (\xe2\x88\x97, ai), then the output workpiece has value x\xe2\x8b\x85ai.The whole production process is as follows. The workpiece with the value 1 is supplied to the first machine, then the workpiece obtained after the operation of the first machine is supplied to the second machine, then the workpiece obtained after the operation of the second machine is supplied to the third machine, and so on. The company is not doing very well, so now the value of the resulting product does not exceed 2\xe2\x8b\x85109.The directors of the company are not satisfied with the efficiency of the production process and have given you a budget of b coins to optimize it.To optimize production you can change the order of machines in the chain. Namely, by spending p coins, you can take any machine of kind (+, ai) and move it to any place in the chain without changing the order of other machines. Also, by spending m coins, you can take any machine of kind (\xe2\x88\x97, ai) and move it to any place in the chain.What is the maximum value of the resulting product that can be achieved if the total cost of movements that are made should not exceed b coins?" "binary search,brute force,greedy" 3300
1975C "Chamo and Mocha\'s Array" "Mocha likes arrays, so before her departure, Chamo gave her an array a consisting of n positive integers as a gift.Mocha doesn\'t like arrays containing different numbers, so Mocha decides to use magic to change the array. Mocha can perform the following three-step operation some (possibly, zero) times:   Choose indices l and r (1\xe2\x89\xa4l<r\xe2\x89\xa4n)  Let x be the median\xe2\x80\xa0 of the subarray [al,al+1,\xe2\x80\xa6,ar]  Set all values al,al+1,\xe2\x80\xa6,ar to x Suppose a=[1,2,3,4,5] initially:   If Mocha chooses (l,r)=(3,4) in the first operation, then x=3, the array will be changed into a=[1,2,3,3,5].  If Mocha chooses (l,r)=(1,3) in the first operation, then x=2, the array will be changed into a=[2,2,2,4,5]. Mocha will perform the operation until the array contains only the same number. Mocha wants to know what is the maximum possible value of this number.\xe2\x80\xa0 The median in an array b of length m is an element that occupies position number \xe2\x8c\x8am+12\xe2\x8c\x8b after we sort the elements in non-decreasing order. For example, the median of [3,1,4,1,5] is 3 and the median of [5,25,20,24] is 20." "binary search,brute force,greedy" 1200
1353C "Board Moves" "You are given a board of size n\xc3\x97n, where n is odd (not divisible by 2). Initially, each cell of the board contains one figure.In one move, you can select exactly one figure presented in some cell and move it to one of the cells sharing a side or a corner with the current cell, i.e. from the cell (i,j) you can move the figure to cells:   (i\xe2\x88\x921,j\xe2\x88\x921);  (i\xe2\x88\x921,j);  (i\xe2\x88\x921,j+1);  (i,j\xe2\x88\x921);  (i,j+1);  (i+1,j\xe2\x88\x921);  (i+1,j);  (i+1,j+1); Of course, you can not move figures to cells out of the board. It is allowed that after a move there will be several figures in one cell.Your task is to find the minimum number of moves needed to get all the figures into one cell (i.e. n2\xe2\x88\x921 cells should contain 0 figures and one cell should contain n2 figures).You have to answer t independent test cases." math 1000
2021C1 "Adjust The Presentation (Easy Version)" "This is the easy version of the problem. In the two versions, the constraints on q and the time limit are different. In this version, q=0. You can make hacks only if all the versions of the problem are solved.A team consisting of n members, numbered from 1 to n, is set to present a slide show at a large meeting. The slide show contains m slides.There is an array a of length n. Initially, the members are standing in a line in the order of a1,a2,\xe2\x80\xa6,an from front to back. The slide show will be presented in order from slide 1 to slide m. Each section will be presented by the member at the front of the line. After each slide is presented, you can move the member at the front of the line to any position in the lineup (without changing the order of the rest of the members). For example, suppose the line of members is [3,1,2,4]. After member 3 presents the current slide, you can change the line of members into either [3,1,2,4], [1,3,2,4], [1,2,3,4] or [1,2,4,3].There is also an array b of length m. The slide show is considered good if it is possible to make member bi present slide i for all i from 1 to m under these constraints.However, your annoying boss wants to make q updates to the array b. In the i-th update, he will choose a slide si and a member ti and set bsi:=ti. Note that these updates are persistent, that is changes made to the array b will apply when processing future updates.For each of the q+1 states of array b, the initial state and after each of the q updates, determine if the slideshow is good." "constructive algorithms,greedy" 1300
1660D "Maximum Product Strikes Back" "You are given an array a consisting of n integers. For each i (1\xe2\x89\xa4i\xe2\x89\xa4n) the following inequality is true: \xe2\x88\x922\xe2\x89\xa4ai\xe2\x89\xa42.You can remove any number (possibly 0) of elements from the beginning of the array and any number (possibly 0) of elements from the end of the array. You are allowed to delete the whole array.You need to answer the question: how many elements should be removed from the beginning of the array, and how many elements should be removed from the end of the array, so that the result will be an array whose product (multiplication) of elements is maximal. If there is more than one way to get an array with the maximum product of elements on it, you are allowed to output any of them. The product of elements of an empty array (array of length 0) should be assumed to be 1." "brute force,implementation,math,two pointers" 1600
30E "Tricky and Clever Password" "In his very young years the hero of our story, king Copa, decided that his private data was hidden not enough securely, what is unacceptable for the king. That\'s why he invented tricky and clever password (later he learned that his password is a palindrome of odd length), and coded all his data using it. Copa is afraid to forget his password, so he decided to write it on a piece of paper. He is aware that it is insecure to keep password in such way, so he decided to cipher it the following way: he cut x characters from the start of his password and from the end of it (x can be 0, and 2x is strictly less than the password length). He obtained 3 parts of the password. Let\'s call it prefix, middle and suffix correspondingly, both prefix and suffix having equal length and middle always having odd length. From these parts he made a string A\xe2\x80\x89+\xe2\x80\x89prefix\xe2\x80\x89+\xe2\x80\x89B\xe2\x80\x89+\xe2\x80\x89middle\xe2\x80\x89+\xe2\x80\x89C\xe2\x80\x89+\xe2\x80\x89suffix, where A, B and C are some (possibly empty) strings invented by Copa, and \xc2\xab\xe2\x80\x89+\xe2\x80\x89\xc2\xbb means concatenation.Many years have passed, and just yesterday the king Copa found the piece of paper where his ciphered password was written. The password, as well as the strings A, B and C, was completely forgotten by Copa, so he asks you to find a password of maximum possible length, which could be invented, ciphered and written by Copa." "binary search,constructive algorithms,data structures,greedy,hashing,strings" 2800
1327F "AND Segments" "You are given three integers n, k, m and m conditions (l1,r1,x1),(l2,r2,x2),\xe2\x80\xa6,(lm,rm,xm).Calculate the number of distinct arrays a, consisting of n integers such that:   0\xe2\x89\xa4ai<2k for each 1\xe2\x89\xa4i\xe2\x89\xa4n;  bitwise AND of numbers a[li]&a[li+1]&\xe2\x80\xa6&a[ri]=xi for each 1\xe2\x89\xa4i\xe2\x89\xa4m. Two arrays a and b are considered different if there exists such a position i that ai\xe2\x89\xa0bi. The number can be pretty large so print it modulo 998244353." "bitmasks,combinatorics,data structures,dp,two pointers" 2500
1762B "Make Array Good" "An array b of m positive integers is good if for all pairs i and j (1\xe2\x89\xa4i,j\xe2\x89\xa4m), max(bi,bj) is divisible by min(bi,bj).You are given an array a of n positive integers. You can perform the following operation:  Select an index i (1\xe2\x89\xa4i\xe2\x89\xa4n) and an integer x (0\xe2\x89\xa4x\xe2\x89\xa4ai) and add x to ai, in other words, ai:=ai+x.  After this operation, ai\xe2\x89\xa41018 should be satisfied. You have to construct a sequence of at most n operations that will make a good. It can be proven that under the constraints of the problem, such a sequence of operations always exists." "constructive algorithms,implementation,number theory,sortings" 1100
1676B "Equal Candies" "There are n boxes with different quantities of candies in each of them. The i-th box has ai candies inside.You also have n friends that you want to give the candies to, so you decided to give each friend a box of candies. But, you don\'t want any friends to get upset so you decided to eat some (possibly none) candies from each box so that all boxes have the same quantity of candies in them. Note that you may eat a different number of candies from different boxes and you cannot add candies to any of the boxes.What\'s the minimum total number of candies you have to eat to satisfy the requirements?" greedy,math,sortings 800
262A "Roma and Lucky Numbers" "Roma (a popular Russian name that means \'Roman\') loves the Little Lvov Elephant\'s lucky numbers.Let us remind you that lucky numbers are positive integers whose decimal representation only contains lucky digits 4 and 7. For example, numbers 47, 744, 4 are lucky and 5, 17, 467 are not.Roma\'s got n positive integers. He wonders, how many of those integers have not more than k lucky digits? Help him, write the program that solves the problem." implementation 800
251D "Two Sets" "Little Petya likes numbers a lot. Recently his mother has presented him a collection of n non-negative integers. There\'s only one thing Petya likes more than numbers: playing with little Masha. He immediately decided to give a part of his new collection to her. To make the game even more interesting, Petya decided to give Masha such collection of numbers for which the following conditions fulfill:  Let\'s introduce x1 to denote the xor of all numbers Petya has got left; and let\'s introduce x2 to denote the xor of all numbers he gave to Masha. Value (x1\xe2\x80\x89+\xe2\x80\x89x2) must be as large as possible.  If there are multiple ways to divide the collection so that the previous condition fulfilled, then Petya minimizes the value x1. The xor operation is a bitwise excluding ""OR"", that is denoted as ""xor"" in the Pascal language and ""^"" in C/C++/Java.Help Petya divide the collection as described above. If there are multiple suitable ways to divide it, find any of them. Please note that after Petya gives a part of his numbers to Masha, he may have no numbers left. The reverse situation is also possible, when Petya gives nothing to Masha. In both cases we must assume that the xor of an empty set of numbers equals 0." bitmasks,math 2700
277D "Google Code Jam" "Many of you must be familiar with the Google Code Jam round rules. Let us remind you of some key moments that are crucial to solving this problem. During the round, the participants are suggested to solve several problems, each divided into two subproblems: an easy one with small limits (Small input), and a hard one with large limits (Large input). You can submit a solution for Large input only after you\'ve solved the Small input for this problem. There are no other restrictions on the order of solving inputs. In particular, the participant can first solve the Small input, then switch to another problem, and then return to the Large input. Solving each input gives the participant some number of points (usually different for each problem). This takes into account only complete solutions that work correctly on all tests of the input. The participant gets the test result of a Small input right after he submits it, but the test result of a Large input are out only after the round\'s over. In the final results table the participants are sorted by non-increasing of received points. If the points are equal, the participants are sorted by ascending of time penalty. By the Google Code Jam rules the time penalty is the time when the last correct solution was submitted.Vasya decided to check out a new tactics on another round. As soon as the round begins, the boy quickly read all the problems and accurately evaluated the time it takes to solve them. Specifically, for each one of the n problems Vasya knows five values: Solving the Small input of the i-th problem gives to the participant scoreSmalli points, and solving the Large input gives scoreLargei more points. That is, the maximum number of points you can get for the i-th problem equals scoreSmalli\xe2\x80\x89+\xe2\x80\x89scoreLargei. Writing the solution for the Small input of the i-th problem takes exactly timeSmalli minutes for Vasya. Improving this code and turning it into the solution of the Large input takes another timeLargei minutes. Vasya\'s had much practice, so he solves all Small inputs from the first attempt. But it\'s not so easy with the Large input: there is the probFaili probability that the solution to the Large input will turn out to be wrong at the end of the round. Please keep in mind that these solutions do not affect the participants\' points and the time penalty.A round lasts for t minutes. The time for reading problems and submitting solutions can be considered to equal zero. Vasya is allowed to submit a solution exactly at the moment when the round ends.Vasya wants to choose a set of inputs and the order of their solution so as to make the expectation of the total received points maximum possible. If there are multiple ways to do this, he needs to minimize the expectation of the time penalty. Help Vasya to cope with this problem." dp,probabilities 2800
417E "Square Table" "While resting on the ship after the ""Russian Code Cup"" a boy named Misha invented an interesting game. He promised to give his quadrocopter to whoever will be the first one to make a rectangular table of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m, consisting of positive integers such that the sum of the squares of numbers for each row and each column was also a square.Since checking the correctness of the table manually is difficult, Misha asks you to make each number in the table to not exceed 108." "constructive algorithms,math,probabilities" 2400
553C "Love Triangles" "There are many anime that are about ""love triangles"": Alice loves Bob, and Charlie loves Bob as well, but Alice hates Charlie. You are thinking about an anime which has n characters. The characters are labeled from 1 to n. Every pair of two characters can either mutually love each other or mutually hate each other (there is no neutral state).You hate love triangles (A-B are in love and B-C are in love, but A-C hate each other), and you also hate it when nobody is in love. So, considering any three characters, you will be happy if exactly one pair is in love (A and B love each other, and C hates both A and B), or if all three pairs are in love (A loves B, B loves C, C loves A).You are given a list of m known relationships in the anime. You know for sure that certain pairs love each other, and certain pairs hate each other. You\'re wondering how many ways you can fill in the remaining relationships so you are happy with every triangle. Two ways are considered different if two characters are in love in one way but hate each other in the other. Print this count modulo 1\xe2\x80\x89000\xe2\x80\x89000\xe2\x80\x89007." "dfs and similar,dsu,graphs" 2200
530B "String inside out" "You are given a string S of even length s1..s2n . Perform the following manipulations: divide it into two halves s1..sn and sn\xe2\x80\x89+\xe2\x80\x891..s2n reverse each of them sn..s1 and s2n..sn\xe2\x80\x89+\xe2\x80\x891 concatenate the resulting strings into sn..s1s2n..sn\xe2\x80\x89+\xe2\x80\x891Output the result of these manipulations." "*special problem" 1600
425C "Sereja and Two Sequences" "Sereja has two sequences a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an and b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bm, consisting of integers. One day Sereja got bored and he decided two play with them. The rules of the game was very simple. Sereja makes several moves, in one move he can perform one of the following actions:  Choose several (at least one) first elements of sequence a (non-empty prefix of a), choose several (at least one) first elements of sequence b (non-empty prefix of b); the element of sequence a with the maximum index among the chosen ones must be equal to the element of sequence b with the maximum index among the chosen ones; remove the chosen elements from the sequences.  Remove all elements of both sequences. The first action is worth e energy units and adds one dollar to Sereja\'s electronic account. The second action is worth the number of energy units equal to the number of elements Sereja removed from the sequences before performing this action. After Sereja performed the second action, he gets all the money that he earned on his electronic account during the game.Initially Sereja has s energy units and no money on his account. What maximum number of money can Sereja get? Note, the amount of Seraja\'s energy mustn\'t be negative at any time moment." "data structures,dp" 2300
704C "Black Widow" "Natalia Romanova is trying to test something on the new gun S.H.I.E.L.D gave her. In order to determine the result of the test, she needs to find the number of answers to a certain equation. The equation is of form:Where  represents logical OR and  represents logical exclusive OR (XOR), and vi,\xe2\x80\x89j are some boolean variables or their negations. Natalia calls the left side of the equation a XNF formula. Each statement in brackets is called a clause, and vi,\xe2\x80\x89j are called literals.In the equation Natalia has, the left side is actually a 2-XNF-2 containing variables x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xm and their negations. An XNF formula is 2-XNF-2 if:  For each 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n, ki\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x892, i.e. the size of each clause doesn\'t exceed two.  Each variable occurs in the formula at most two times (with negation and without negation in total). Please note that it\'s possible that a variable occurs twice but its negation doesn\'t occur in any clause (or vice versa). Natalia is given a formula of m variables, consisting of n clauses. Please, make sure to check the samples in order to properly understand how the formula looks like.Natalia is more into fight than theory, so she asked you to tell her the number of answers to this equation. More precisely, you need to find the number of ways to set x1,\xe2\x80\x89...,\xe2\x80\x89xm with true and false (out of total of 2m ways) so that the equation is satisfied. Since this number can be extremely large, you need to print the answer modulo 109\xe2\x80\x89+\xe2\x80\x897.Please, note that some variable may appear twice in one clause, or not appear in the equation at all (but still, setting it to false or true gives different ways to set variables)." dp,graphs,implementation,math 2900
678D "Iterated Linear Function" "Consider a linear function f(x)\xe2\x80\x89=\xe2\x80\x89Ax\xe2\x80\x89+\xe2\x80\x89B. Let\'s define g(0)(x)\xe2\x80\x89=\xe2\x80\x89x and g(n)(x)\xe2\x80\x89=\xe2\x80\x89f(g(n\xe2\x80\x89-\xe2\x80\x891)(x)) for n\xe2\x80\x89>\xe2\x80\x890. For the given integer values A, B, n and x find the value of g(n)(x) modulo 109\xe2\x80\x89+\xe2\x80\x897." "math,number theory" 1700
1511E "Colorings and Dominoes" "You have a large rectangular board which is divided into n\xc3\x97m cells (the board has n rows and m columns). Each cell is either white or black.You paint each white cell either red or blue. Obviously, the number of different ways to paint them is 2w, where w is the number of white cells.After painting the white cells of the board, you want to place the maximum number of dominoes on it, according to the following rules:  each domino covers two adjacent cells;  each cell is covered by at most one domino;  if a domino is placed horizontally (it covers two adjacent cells in one of the rows), it should cover only red cells;  if a domino is placed vertically (it covers two adjacent cells in one of the columns), it should cover only blue cells. Let the value of the board be the maximum number of dominoes you can place. Calculate the sum of values of the board over all 2w possible ways to paint it. Since it can be huge, print it modulo 998244353." combinatorics,dp,greedy,math 2100
436E "Cardboard Box" "Everyone who has played Cut the Rope knows full well how the gameplay is organized. All levels in the game are divided into boxes. Initially only one box with some levels is available. Player should complete levels to earn stars, collecting stars opens new box with levels.  Imagine that you are playing Cut the Rope for the first time. Currently you have only the levels of the first box (by the way, it is called ""Cardboard Box""). Each level is characterized by two integers: ai \xe2\x80\x94 how long it takes to complete the level for one star, bi \xe2\x80\x94 how long it takes to complete the level for two stars (ai\xe2\x80\x89<\xe2\x80\x89bi).You want to open the next box as quickly as possible. So, you need to earn at least w stars. How do make it happen? Note that the level can be passed only once: either for one star or for two. You do not necessarily need to pass all the levels." "data structures,greedy" 2600
1142A "The Beatles" "Recently a Golden Circle of Beetlovers was found in Byteland. It is a circle route going through n\xe2\x8b\x85k cities. The cities are numerated from 1 to n\xe2\x8b\x85k, the distance between the neighboring cities is exactly 1 km.Sergey does not like beetles, he loves burgers. Fortunately for him, there are n fast food restaurants on the circle, they are located in the 1-st, the (k+1)-st, the (2k+1)-st, and so on, the ((n\xe2\x88\x921)k+1)-st cities, i.e. the distance between the neighboring cities with fast food restaurants is k km.Sergey began his journey at some city s and traveled along the circle, making stops at cities each l km (l>0), until he stopped in s once again. Sergey then forgot numbers s and l, but he remembers that the distance from the city s to the nearest fast food restaurant was a km, and the distance from the city he stopped at after traveling the first l km from s to the nearest fast food restaurant was b km. Sergey always traveled in the same direction along the circle, but when he calculated distances to the restaurants, he considered both directions.Now Sergey is interested in two integers. The first integer x is the minimum number of stops (excluding the first) Sergey could have done before returning to s. The second integer y is the maximum number of stops (excluding the first) Sergey could have done before returning to s." "brute force,math" 1700
1177B "Digits Sequence (Hard Edition)" "Let\'s write all the positive integer numbers one after another from 1 without any delimiters (i.e. as a single string). It will be the infinite sequence starting with 123456789101112131415161718192021222324252627282930313233343536...Your task is to print the k-th digit of this sequence." "binary search,divide and conquer,implementation" 1800
313D "Ilya and Roads" "Everything is great about Ilya\'s city, except the roads. The thing is, the only ZooVille road is represented as n holes in a row. We will consider the holes numbered from 1 to n, from left to right.Ilya is really keep on helping his city. So, he wants to fix at least k holes (perharps he can fix more) on a single ZooVille road. The city has m building companies, the i-th company needs ci money units to fix a road segment containing holes with numbers of at least li and at most ri. The companies in ZooVille are very greedy, so, if they fix a segment containing some already fixed holes, they do not decrease the price for fixing the segment. Determine the minimum money Ilya will need to fix at least k holes." dp 2100
1527C "Sequence Pair Weight" "The weight of a sequence is defined as the number of unordered pairs of indexes (i,j) (here i<j) with same value (ai=aj). For example, the weight of sequence a=[1,1,2,2,1] is 4. The set of unordered pairs of indexes with same value are (1,2), (1,5), (2,5), and (3,4).You are given a sequence a of n integers. Print the sum of the weight of all subsegments of a. A sequence b is a subsegment of a sequence a if b can be obtained from a by deletion of several (possibly, zero or all) elements from the beginning and several (possibly, zero or all) elements from the end." hashing,implementation,math 1600
1805E "There Should Be a Lot of Maximums" "You are given a tree (a connected graph without cycles). Each vertex of the tree contains an integer. Let\'s define the MAD (maximum double) parameter of the tree as the maximum integer that occurs in the vertices of the tree at least 2 times. If no number occurs in the tree more than once, then we assume MAD=0.Note that if you remove an edge from the tree, it splits into two trees. Let\'s compute the MAD parameters of the two trees and take the maximum of the two values. Let the result be the value of the deleted edge.For each edge, find its value. Note that we don\'t actually delete any edges from the tree, the values are to be found independently." "brute force,data structures,dfs and similar,dp,trees,two pointers" 2300
1487G "String Counting" "You have c1 letters \'a\', c2 letters \'b\', ..., c26 letters \'z\'. You want to build a beautiful string of length n from them (obviously, you cannot use the i-th letter more than ci times). Each ci is greater than n3.A string is called beautiful if there are no palindromic contiguous substrings of odd length greater than 1 in it. For example, the string ""abacaba"" is not beautiful, it has several palindromic substrings of odd length greater than 1 (for example, ""aca""). Another example: the string ""abcaa"" is beautiful.Calculate the number of different strings you can build, and print the answer modulo 998244353." combinatorics,dp,fft,math 2700
659G "Fence Divercity" "Long ago, Vasily built a good fence at his country house. Vasily calls a fence good, if it is a series of n consecutively fastened vertical boards of centimeter width, the height of each in centimeters is a positive integer. The house owner remembers that the height of the i-th board to the left is hi.Today Vasily decided to change the design of the fence he had built, by cutting his top connected part so that the fence remained good. The cut part should consist of only the upper parts of the boards, while the adjacent parts must be interconnected (share a non-zero length before cutting out of the fence).You, as Vasily\'s curious neighbor, will count the number of possible ways to cut exactly one part as is described above. Two ways to cut a part are called distinct, if for the remaining fences there is such i, that the height of the i-th boards vary.As Vasily\'s fence can be very high and long, get the remainder after dividing the required number of ways by 1\xe2\x80\x89000\xe2\x80\x89000\xe2\x80\x89007 (109\xe2\x80\x89+\xe2\x80\x897)." "combinatorics,dp,number theory" 2300
1468A LaIS "Let\'s call a sequence b1,b2,b3\xe2\x80\xa6,bk\xe2\x88\x921,bk almost increasing if min(b1,b2)\xe2\x89\xa4min(b2,b3)\xe2\x89\xa4\xe2\x8b\xaf\xe2\x89\xa4min(bk\xe2\x88\x921,bk). In particular, any sequence with no more than two elements is almost increasing.You are given a sequence of integers a1,a2,\xe2\x80\xa6,an. Calculate the length of its longest almost increasing subsequence.You\'ll be given t test cases. Solve each test case independently.Reminder: a subsequence is a sequence that can be derived from another sequence by deleting some elements without changing the order of the remaining elements." "data structures,dp,greedy" 2200
1521D "Nastia Plays with a Tree" "Nastia has an unweighted tree with n vertices and wants to play with it!The girl will perform the following operation with her tree, as long as she needs:  Remove any existing edge.  Add an edge between any pair of vertices. What is the minimum number of operations Nastia needs to get a bamboo from a tree? A bamboo is a tree in which no node has a degree greater than 2." "constructive algorithms,data structures,dfs and similar,dp,dsu,greedy,implementation,trees" 2500
401B "Sereja and Contests" "Sereja is a coder and he likes to take part in Codesorfes rounds. However, Uzhland doesn\'t have good internet connection, so Sereja sometimes skips rounds.Codesorfes has rounds of two types: Div1 (for advanced coders) and Div2 (for beginner coders). Two rounds, Div1 and Div2, can go simultaneously, (Div1 round cannot be held without Div2) in all other cases the rounds don\'t overlap in time. Each round has a unique identifier \xe2\x80\x94 a positive integer. The rounds are sequentially (without gaps) numbered with identifiers by the starting time of the round. The identifiers of rounds that are run simultaneously are different by one, also the identifier of the Div1 round is always greater.Sereja is a beginner coder, so he can take part only in rounds of Div2 type. At the moment he is taking part in a Div2 round, its identifier equals to x. Sereja remembers very well that he has taken part in exactly k rounds before this round. Also, he remembers all identifiers of the rounds he has taken part in and all identifiers of the rounds that went simultaneously with them. Sereja doesn\'t remember anything about the rounds he missed.Sereja is wondering: what minimum and what maximum number of Div2 rounds could he have missed? Help him find these two numbers." greedy,implementation,math 1200
364C "Beautiful Set" "We\'ll call a set of positive integers a beautiful if the following condition fulfills: for any prime p, if , then . In other words, if one number from the set is divisible by prime p, then at least half of numbers from the set is divisible by p.Your task is to find any beautiful set, where the number of elements is equal to k and each element doesn\'t exceed 2k2." "brute force,number theory" 2300
120F Spiders "One day mum asked Petya to sort his toys and get rid of some of them. Petya found a whole box of toy spiders. They were quite dear to him and the boy didn\'t want to throw them away. Petya conjured a cunning plan: he will glue all the spiders together and attach them to the ceiling. Besides, Petya knows that the lower the spiders will hang, the more mum is going to like it and then she won\'t throw his favourite toys away. Help Petya carry out the plan.A spider consists of k beads tied together by k\xe2\x80\x89-\xe2\x80\x891 threads. Each thread connects two different beads, at that any pair of beads that make up a spider is either directly connected by a thread, or is connected via some chain of threads and beads.Petya may glue spiders together directly gluing their beads. The length of each thread equals 1. The sizes of the beads can be neglected. That\'s why we can consider that gluing spiders happens by identifying some of the beads (see the picture). Besides, the construction resulting from the gluing process should also represent a spider, that is, it should have the given features. After Petya glues all spiders together, he measures the length of the resulting toy. The distance between a pair of beads is identified as the total length of the threads that connect these two beads. The length of the resulting construction is the largest distance between all pairs of beads. Petya wants to make the spider whose length is as much as possible.    The picture two shows two spiders from the second sample. We can glue to the bead number 2 of the first spider the bead number 1 of the second spider. The threads in the spiders that form the sequence of threads of maximum lengths are highlighted on the picture." dp,greedy,trees 1400
965C "Greedy Arkady" "k people want to split n candies between them. Each candy should be given to exactly one of them or be thrown away.The people are numbered from 1 to k, and Arkady is the first of them. To split the candies, Arkady will choose an integer x and then give the first x candies to himself, the next x candies to the second person, the next x candies to the third person and so on in a cycle. The leftover (the remainder that is not divisible by x) will be thrown away.Arkady can\'t choose x greater than M as it is considered greedy. Also, he can\'t choose such a small x that some person will receive candies more than D times, as it is considered a slow splitting.Please find what is the maximum number of candies Arkady can receive by choosing some valid x." math 2000
1321A "Contest for Robots" "Polycarp is preparing the first programming contest for robots. There are n problems in it, and a lot of robots are going to participate in it. Each robot solving the problem i gets pi points, and the score of each robot in the competition is calculated as the sum of pi over all problems i solved by it. For each problem, pi is an integer not less than 1.Two corporations specializing in problem-solving robot manufacturing, ""Robo-Coder Inc."" and ""BionicSolver Industries"", are going to register two robots (one for each corporation) for participation as well. Polycarp knows the advantages and flaws of robots produced by these companies, so, for each problem, he knows precisely whether each robot will solve it during the competition. Knowing this, he can try predicting the results \xe2\x80\x94 or manipulating them. For some reason (which absolutely cannot involve bribing), Polycarp wants the ""Robo-Coder Inc."" robot to outperform the ""BionicSolver Industries"" robot in the competition. Polycarp wants to set the values of pi in such a way that the ""Robo-Coder Inc."" robot gets strictly more points than the ""BionicSolver Industries"" robot. However, if the values of pi will be large, it may look very suspicious \xe2\x80\x94 so Polycarp wants to minimize the maximum value of pi over all problems. Can you help Polycarp to determine the minimum possible upper bound on the number of points given for solving the problems?" greedy 900
828B "Black Square" "Polycarp has a checkered sheet of paper of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m. Polycarp painted some of cells with black, the others remained white. Inspired by Malevich\'s ""Black Square"", Polycarp wants to paint minimum possible number of white cells with black so that all black cells form a square.You are to determine the minimum possible number of cells needed to be painted black so that the black cells form a black square with sides parallel to the painting\'s sides. All the cells that do not belong to the square should be white. The square\'s side should have positive length." implementation 1300
1114C "Trailing Loves (or L\'oeufs?)" "The number ""zero"" is called ""love"" (or ""l\'oeuf"" to be precise, literally means ""egg"" in French), for example when denoting the zero score in a game of tennis. Aki is fond of numbers, especially those with trailing zeros. For example, the number 9200 has two trailing zeros. Aki thinks the more trailing zero digits a number has, the prettier it is.However, Aki believes, that the number of trailing zeros of a number is not static, but depends on the base (radix) it is represented in. Thus, he considers a few scenarios with some numbers and bases. And now, since the numbers he used become quite bizarre, he asks you to help him to calculate the beauty of these numbers.Given two integers n and b (in decimal notation), your task is to calculate the number of trailing zero digits in the b-ary (in the base/radix of b) representation of n! (factorial of n)." "brute force,implementation,math,number theory" 1700
1878E "Iva & Pav" "Iva and Pav are a famous Serbian competitive programming couple. In Serbia, they call Pav ""papuca"" and that\'s why he will make all of Iva\'s wishes come true.Iva gave Pav an array a of n elements.Let\'s define f(l,r)=al & al+1 &\xe2\x80\xa6& ar (here & denotes the bitwise AND operation). Note that f(l,r) is not defined when l>r.Iva also gave Pav q queries.Each query consists of 2 numbers, k and l, and she wants Pav to find the largest index r (l\xe2\x89\xa4r\xe2\x89\xa4n), such that f(l,r)\xe2\x89\xa5k. Pav wants to solve this problem fast because he doesn\'t want to upset Iva. He needs your help." "binary search,bitmasks,data structures,greedy" 1400
1157B "Long Number" "You are given a long decimal number aa consisting of n digits from 1 to 9. You also have a function f that maps every digit from 1 to 9 to some (possibly the same) digit from 1 to 9.You can perform the following operation no more than once: choose a non-empty contiguous subsegment of digits in a, and replace each digit x from this segment with f(x). For example, if a=1337, f(1)=1, f(3)=5, f(7)=3, and you choose the segment consisting of three rightmost digits, you get 1553 as the result.What is the maximum possible number you can obtain applying this operation no more than once?" greedy 1300
998A Balloons "There are quite a lot of ways to have fun with inflatable balloons. For example, you can fill them with water and see what happens.Grigory and Andrew have the same opinion. So, once upon a time, they went to the shop and bought n packets with inflatable balloons, where i-th of them has exactly ai balloons inside.They want to divide the balloons among themselves. In addition, there are several conditions to hold:  Do not rip the packets (both Grigory and Andrew should get unbroken packets);  Distribute all packets (every packet should be given to someone);  Give both Grigory and Andrew at least one packet;  To provide more fun, the total number of balloons in Grigory\'s packets should not be equal to the total number of balloons in Andrew\'s packets. Help them to divide the balloons or determine that it\'s impossible under these conditions." "constructive algorithms,implementation" 1000
1699A "The Third Three Number Problem" "You are given a positive integer n. Your task is to find any three integers a, b and c (0\xe2\x89\xa4a,b,c\xe2\x89\xa4109) for which (a\xe2\x8a\x95b)+(b\xe2\x8a\x95c)+(a\xe2\x8a\x95c)=n, or determine that there are no such integers.Here a\xe2\x8a\x95b denotes the bitwise XOR of a and b. For example, 2\xe2\x8a\x954=6 and 3\xe2\x8a\x951=2." "constructive algorithms,math" 800
715B "Complete The Graph" "ZS the Coder has drawn an undirected graph of n vertices numbered from 0 to n\xe2\x80\x89-\xe2\x80\x891 and m edges between them. Each edge of the graph is weighted, each weight is a positive integer.The next day, ZS the Coder realized that some of the weights were erased! So he wants to reassign positive integer weight to each of the edges which weights were erased, so that the length of the shortest path between vertices s and t in the resulting graph is exactly L. Can you help him?" "binary search,constructive algorithms,graphs,shortest paths" 2300
149B "Martian Clock" "Having stayed home alone, Petya decided to watch forbidden films on the Net in secret. ""What ungentlemanly behavior!"" \xe2\x80\x94 you can say that, of course, but don\'t be too harsh on the kid. In his country films about the Martians and other extraterrestrial civilizations are forbidden. It was very unfair to Petya as he adored adventure stories that featured lasers and robots. Today Petya is watching a shocking blockbuster about the Martians called ""R2:D2"". What can ""R2:D2"" possibly mean? It might be the Martian time represented in the Martian numeral system. Petya knows that time on Mars is counted just like on the Earth (that is, there are 24 hours and each hour has 60 minutes). The time is written as ""a:b"", where the string a stands for the number of hours (from 0 to 23 inclusive), and string b stands for the number of minutes (from 0 to 59 inclusive). The only thing Petya doesn\'t know is in what numeral system the Martian time is written.Your task is to print the radixes of all numeral system which can contain the time ""a:b""." implementation 1600
1362B "Johnny and His Hobbies" "Among Johnny\'s numerous hobbies, there are two seemingly harmless ones: applying bitwise operations and sneaking into his dad\'s office. As it is usually the case with small children, Johnny is unaware that combining these two activities can get him in a lot of trouble.There is a set S containing very important numbers on his dad\'s desk. The minute Johnny heard about it, he decided that it\'s a good idea to choose a positive integer k and replace each element s of the set S with s\xe2\x8a\x95k (\xe2\x8a\x95 denotes the exclusive or operation). Help him choose such k that Johnny\'s dad will not see any difference after his son is done playing (i.e. Johnny will get the same set as before playing). It is possible that no such number exists. It is also possible that there are many of them. In such a case, output the smallest one. Note that the order of elements in a set doesn\'t matter, i.e. set {1,2,3} equals to set {2,1,3}.Formally, find the smallest positive integer k such that {s\xe2\x8a\x95k|s\xe2\x88\x88S}=S or report that there is no such number.For example, if S={1,3,4} and k=2, new set will be equal to {3,1,6}. If S={0,1,2,3} and k=1, after playing set will stay the same." "bitmasks,brute force" 1200
1027E "Inverse Coloring" "You are given a square board, consisting of n rows and n columns. Each tile in it should be colored either white or black.Let\'s call some coloring beautiful if each pair of adjacent rows are either the same or different in every position. The same condition should be held for the columns as well.Let\'s call some coloring suitable if it is beautiful and there is no rectangle of the single color, consisting of at least k tiles.Your task is to count the number of suitable colorings of the board of the given size.Since the answer can be very large, print it modulo 998244353." combinatorics,dp,math 2100
1252F "Regular Forestation" "A forestation is an act of planting a bunch of trees to grow a forest, usually to replace a forest that had been cut down. Strangely enough, graph theorists have another idea on how to make a forest, i.e. by cutting down a tree!A tree is a graph of N nodes connected by N\xe2\x88\x921 edges. Let u be a node in a tree U which degree is at least 2 (i.e. directly connected to at least 2 other nodes in U). If we remove u from U, then we will get two or more disconnected (smaller) trees, or also known as forest by graph theorists. In this problem, we are going to investigate a special forestation of a tree done by graph theorists.Let V(S) be the set of nodes in a tree S and V(T) be the set of nodes in a tree T. Tree S and tree T are identical if there exists a bijection f:V(S)\xe2\x86\x92V(T) such that for all pairs of nodes (si,sj) in V(S), si and sj is connected by an edge in S if and only if node f(si) and f(sj) is connected by an edge in T. Note that f(s)=t implies node s in S corresponds to node t in T.We call a node u in a tree U as a good cutting point if and only if the removal of u from U causes two or more disconnected trees, and all those disconnected trees are pairwise identical.Given a tree U, your task is to determine whether there exists a good cutting point in U. If there is such a node, then you should output the maximum number of disconnected trees that can be obtained by removing exactly one good cutting point.For example, consider the following tree of 13 nodes.There is exactly one good cutting point in this tree, i.e. node 4. Observe that by removing node 4, we will get three identical trees (in this case, line graphs), i.e. {5,1,7,13}, {8,2,11,6}, and {3,12,9,10}, which are denoted by A, B, and C respectively in the figure.   The bijection function between A and B: f(5)=8, f(1)=2, f(7)=11, and f(13)=6.  The bijection function between A and C: f(5)=3, f(1)=12, f(7)=9, and f(13)=10.  The bijection function between B and C: f(8)=3, f(2)=12, f(11)=9, and f(6)=10.  Of course, there exists other bijection functions for those trees." hashing,trees 2400
638A "Home Numbers" "The main street of Berland is a straight line with n houses built along it (n is an even number). The houses are located at both sides of the street. The houses with odd numbers are at one side of the street and are numbered from 1 to n\xe2\x80\x89-\xe2\x80\x891 in the order from the beginning of the street to the end (in the picture: from left to right). The houses with even numbers are at the other side of the street and are numbered from 2 to n in the order from the end of the street to its beginning (in the picture: from right to left). The corresponding houses with even and odd numbers are strictly opposite each other, that is, house 1 is opposite house n, house 3 is opposite house n\xe2\x80\x89-\xe2\x80\x892, house 5 is opposite house n\xe2\x80\x89-\xe2\x80\x894 and so on.  Vasya needs to get to house number a as quickly as possible. He starts driving from the beginning of the street and drives his car to house a. To get from the beginning of the street to houses number 1 and n, he spends exactly 1 second. He also spends exactly one second to drive the distance between two neighbouring houses. Vasya can park at any side of the road, so the distance between the beginning of the street at the houses that stand opposite one another should be considered the same.Your task is: find the minimum time Vasya needs to reach house a." "*special problem,constructive algorithms,math" 1100
1146E "Hot is Cold" "You are given an array of n integers a1,a2,\xe2\x80\xa6,an.You will perform q operations. In the i-th operation, you have a symbol si which is either ""<"" or "">"" and a number xi.You make a new array b such that bj=\xe2\x88\x92aj if ajsixi and bj=aj otherwise (i.e. if si is \'>\', then all aj>xi will be flipped). After doing all these replacements, a is set to be b.You want to know what your final array looks like after all operations." "bitmasks,data structures,divide and conquer,implementation" 2400
2009C "The Legend of Freya the Frog" "Freya the Frog is traveling on the 2D coordinate plane. She is currently at point (0,0) and wants to go to point (x,y). In one move, she chooses an integer d such that 0\xe2\x89\xa4d\xe2\x89\xa4k and jumps d spots forward in the direction she is facing. Initially, she is facing the positive x direction. After every move, she will alternate between facing the positive x direction and the positive y direction (i.e., she will face the positive y direction on her second move, the positive x direction on her third move, and so on). What is the minimum amount of moves she must perform to land on point (x,y)?" implementation,math 1100
1213E "Two Small Strings" "You are given two strings s and t both of length 2 and both consisting only of characters \'a\', \'b\' and \'c\'.Possible examples of strings s and t: ""ab"", ""ca"", ""bb"".You have to find a string res consisting of 3n characters, n characters should be \'a\', n characters should be \'b\' and n characters should be \'c\' and s and t should not occur in res as substrings.A substring of a string is a contiguous subsequence of that string. So, the strings ""ab"", ""ac"" and ""cc"" are substrings of the string ""abacc"", but the strings ""bc"", ""aa"" and ""cb"" are not substrings of the string ""abacc"".If there are multiple answers, you can print any of them." "brute force,constructive algorithms" 1900
2037F "Ardent Flames" "You have obtained the new limited event character Xilonen. You decide to use her in combat.There are n enemies in a line. The i\'th enemy from the left has health hi and is currently at position xi. Xilonen has an attack damage of m, and you are ready to defeat the enemies with her.Xilonen has a powerful ""ground stomp"" attack. Before you perform any attacks, you select an integer p and position Xilonen there (p can be any integer position, including a position with an enemy currently). Afterwards, for each attack, she deals m damage to an enemy at position p (if there are any), m\xe2\x88\x921 damage to enemies at positions p\xe2\x88\x921 and p+1, m\xe2\x88\x922 damage to enemies at positions p\xe2\x88\x922 and p+2, and so on. Enemies that are at least a distance of m away from Xilonen take no damage from attacks.Formally, if there is an enemy at position x, she will deal max(0,m\xe2\x88\x92|p\xe2\x88\x92x|) damage to that enemy each hit. Note that you may not choose a different p for different attacks. Over all possible p, output the minimum number of attacks Xilonen must perform to defeat at least k enemies. If it is impossible to find a p such that eventually at least k enemies will be defeated, output \xe2\x88\x921 instead. Note that an enemy is considered to be defeated if its health reaches 0 or below." "binary search,data structures,sortings,two pointers" -999
917A "The Monster" "As Will is stuck in the Upside Down, he can still communicate with his mom, Joyce, through the Christmas lights (he can turn them on and off with his mind). He can\'t directly tell his mom where he is, because the monster that took him to the Upside Down will know and relocate him.   Thus, he came up with a puzzle to tell his mom his coordinates. His coordinates are the answer to the following problem.A string consisting only of parentheses (\'(\' and \')\') is called a bracket sequence. Some bracket sequence are called correct bracket sequences. More formally:  Empty string is a correct bracket sequence.  if s is a correct bracket sequence, then (s) is also a correct bracket sequence.  if s and t are correct bracket sequences, then st (concatenation of s and t) is also a correct bracket sequence. A string consisting of parentheses and question marks (\'?\') is called pretty if and only if there\'s a way to replace each question mark with either \'(\' or \')\' such that the resulting string is a non-empty correct bracket sequence.Will gave his mom a string s consisting of parentheses and question marks (using Morse code through the lights) and his coordinates are the number of pairs of integers (l,\xe2\x80\x89r) such that 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|s| and the string slsl\xe2\x80\x89+\xe2\x80\x891... sr is pretty, where si is i-th character of s.Joyce doesn\'t know anything about bracket sequences, so she asked for your help." dp,greedy,implementation,math 1800
332E "Binary Key" "Let\'s assume that p and q are strings of positive length, called the container and the key correspondingly, string q only consists of characters 0 and 1. Let\'s take a look at a simple algorithm that extracts message s from the given container p:i = 0;j = 0;s = <>;while i is less than the length of the string p{    if q[j] == 1, then add to the right of string s character p[i];    increase variables i, j by one;    if the value of the variable j equals the length of the string q, then j = 0; }In the given pseudocode i, j are integer variables, s is a string, \'=\' is an assignment operator, \'==\' is a comparison operation, \'[]\' is the operation of obtaining the string character with the preset index, \'<>\' is an empty string. We suppose that in all strings the characters are numbered starting from zero. We understand that implementing such algorithm is quite easy, so your task is going to be slightly different. You need to construct the lexicographically minimum key of length k, such that when it is used, the algorithm given above extracts message s from container p (otherwise find out that such key doesn\'t exist)." dp,greedy,implementation 2400
387A "George and Sleep" "George woke up and saw the current time s on the digital clock. Besides, George knows that he has slept for time t. Help George! Write a program that will, given time s and t, determine the time p when George went to bed. Note that George could have gone to bed yesterday relatively to the current time (see the second test sample)." implementation 900
1037H Security "Some programming website is establishing a secure communication protocol. For security reasons, they want to choose several more or less random strings.Initially, they have a string s consisting of lowercase English letters. Now they want to choose q strings using the following steps, and you are to help them.  A string x consisting of lowercase English letters and integers l and r (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4|s|) are chosen.  Consider all non-empty distinct substrings of the slsl+1\xe2\x80\xa6sr, that is all distinct strings sisi+1\xe2\x80\xa6sj where l\xe2\x89\xa4i\xe2\x89\xa4j\xe2\x89\xa4r. Among all of them choose all strings that are lexicographically greater than x.  If there are no such strings, you should print \xe2\x88\x921. Otherwise print the lexicographically smallest among them. String a is lexicographically less than string b, if either a is a prefix of b and a\xe2\x89\xa0b, or there exists such a position i (1\xe2\x89\xa4i\xe2\x89\xa4min(|a|,|b|)), such that ai<bi and for all j (1\xe2\x89\xa4j<i) aj=bj. Here |a| denotes the length of the string a." "data structures,string suffix structures" 3200
1444A Division "Oleg\'s favorite subjects are History and Math, and his favorite branch of mathematics is division.To improve his division skills, Oleg came up with t pairs of integers pi and qi and for each pair decided to find the greatest integer xi, such that:   pi is divisible by xi;  xi is not divisible by qi.  Oleg is really good at division and managed to find all the answers quickly, how about you?" "brute force,math,number theory" 1500
559B "Equivalent Strings" "Today on a lecture about strings Gerald learned a new definition of string equivalency. Two strings a and b of equal length are called equivalent in one of the two cases:   They are equal.  If we split string a into two halves of the same size a1 and a2, and string b into two halves of the same size b1 and b2, then one of the following is correct:   a1 is equivalent to b1, and a2 is equivalent to b2  a1 is equivalent to b2, and a2 is equivalent to b1  As a home task, the teacher gave two strings to his students and asked to determine if they are equivalent.Gerald has already completed this home task. Now it\'s your turn!" "divide and conquer,hashing,sortings,strings" 1700
739E "Gosha is hunting" "Gosha is hunting. His goal is to catch as many Pokemons as possible. Gosha has a Poke Balls and b Ultra Balls. There are n Pokemons. They are numbered 1 through n. Gosha knows that if he throws a Poke Ball at the i-th Pokemon he catches it with probability pi. If he throws an Ultra Ball at the i-th Pokemon he catches it with probability ui. He can throw at most one Ball of each type at any Pokemon.The hunting proceeds as follows: at first, Gosha chooses no more than a Pokemons at which he will throw Poke Balls and no more than b Pokemons at which he will throw Ultra Balls. After that, he throws the chosen Balls at the chosen Pokemons. If he throws both Ultra Ball and Poke Ball at some Pokemon, he is caught if and only if he is caught by any of these Balls. The outcome of a throw doesn\'t depend on the other throws.Gosha would like to know what is the expected number of the Pokemons he catches if he acts in an optimal way. In other words, he would like to know the maximum possible expected number of Pokemons can catch." "brute force,data structures,dp,flows,math,probabilities,sortings" 3000
1807A "Plus or Minus" "You are given three integers a, b, and c such that exactly one of these two equations is true:   a+b=c  a\xe2\x88\x92b=c  Output + if the first equation is true, and - otherwise." implementation 800
1102B "Array K-Coloring" "You are given an array a consisting of n integer numbers.You have to color this array in k colors in such a way that:   Each element of the array should be colored in some color;  For each i from 1 to k there should be at least one element colored in the i-th color in the array;  For each i from 1 to k all elements colored in the i-th color should be distinct. Obviously, such coloring might be impossible. In this case, print ""NO"". Otherwise print ""YES"" and any coloring (i.e. numbers c1,c2,\xe2\x80\xa6cn, where 1\xe2\x89\xa4ci\xe2\x89\xa4k and ci is the color of the i-th element of the given array) satisfying the conditions above. If there are multiple answers, you can print any." greedy,sortings 1400
1426F "Number of Subsequences" "You are given a string s consisting of lowercase Latin letters ""a"", ""b"" and ""c"" and question marks ""?"".Let the number of question marks in the string s be k. Let\'s replace each question mark with one of the letters ""a"", ""b"" and ""c"". Here we can obtain all 3k possible strings consisting only of letters ""a"", ""b"" and ""c"". For example, if s=""ac?b?c"" then we can obtain the following strings: [""acabac"", ""acabbc"", ""acabcc"", ""acbbac"", ""acbbbc"", ""acbbcc"", ""accbac"", ""accbbc"", ""accbcc""].Your task is to count the total number of subsequences ""abc"" in all resulting strings. Since the answer can be very large, print it modulo 109+7.A subsequence of the string t is such a sequence that can be derived from the string t after removing some (possibly, zero) number of letters without changing the order of remaining letters. For example, the string ""baacbc"" contains two subsequences ""abc"" \xe2\x80\x94 a subsequence consisting of letters at positions (2,5,6) and a subsequence consisting of letters at positions (3,5,6)." combinatorics,dp,strings 2000
1547A "Shortest Path with Obstacle" "There are three cells on an infinite 2-dimensional grid, labeled A, B, and F. Find the length of the shortest path from A to B if:   in one move you can go to any of the four adjacent cells sharing a side;  visiting the cell F is forbidden (it is an obstacle)." implementation,math 800
7B "Memory Manager" "There is little time left before the release of the first national operating system BerlOS. Some of its components are not finished yet \xe2\x80\x94 the memory manager is among them. According to the developers\' plan, in the first release the memory manager will be very simple and rectilinear. It will support three operations:   alloc n \xe2\x80\x94 to allocate n bytes of the memory and return the allocated block\'s identifier x;  erase x \xe2\x80\x94 to erase the block with the identifier x;  defragment \xe2\x80\x94 to defragment the free memory, bringing all the blocks as close to the beginning of the memory as possible and preserving their respective order; The memory model in this case is very simple. It is a sequence of m bytes, numbered for convenience from the first to the m-th.The first operation alloc n takes as the only parameter the size of the memory block that is to be allocated. While processing this operation, a free block of n successive bytes is being allocated in the memory. If the amount of such blocks is more than one, the block closest to the beginning of the memory (i.e. to the first byte) is prefered. All these bytes are marked as not free, and the memory manager returns a 32-bit integer numerical token that is the identifier of this block. If it is impossible to allocate a free block of this size, the function returns NULL.The second operation erase x takes as its parameter the identifier of some block. This operation frees the system memory, marking the bytes of this block as free for further use. In the case when this identifier does not point to the previously allocated block, which has not been erased yet, the function returns ILLEGAL_ERASE_ARGUMENT.The last operation defragment does not have any arguments and simply brings the occupied memory sections closer to the beginning of the memory without changing their respective order.In the current implementation you are to use successive integers, starting with 1, as identifiers. Each successful alloc operation procession should return following number. Unsuccessful alloc operations do not affect numeration.You are to write the implementation of the memory manager. You should output the returned value for each alloc command. You should also output ILLEGAL_ERASE_ARGUMENT for all the failed erase commands." implementation 1600
25D "Roads not only in Berland" "Berland Government decided to improve relations with neighboring countries. First of all, it was decided to build new roads so that from each city of Berland and neighboring countries it became possible to reach all the others. There are n cities in Berland and neighboring countries in total and exactly n\xe2\x80\x89-\xe2\x80\x891 two-way roads. Because of the recent financial crisis, the Berland Government is strongly pressed for money, so to build a new road it has to close some of the existing ones. Every day it is possible to close one existing road and immediately build a new one. Your task is to determine how many days would be needed to rebuild roads so that from each city it became possible to reach all the others, and to draw a plan of closure of old roads and building of new ones." dsu,graphs,trees 1900
1810H "Last Number" "You are given a multiset S. Initially, S={1,2,3,\xe2\x80\xa6,n}.You will perform the following operation n\xe2\x88\x921 times.  Choose the largest number Smax in S and the smallest number Smin in S. Remove the two numbers from S, and add Smax\xe2\x88\x92Smin into S. It\'s easy to show that there will be exactly one number left after n\xe2\x88\x921 operations. Output that number." combinatorics,math 2900
380E "Sereja and Dividing" "Let\'s assume that we have a sequence of doubles a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89a|a| and a double variable x. You are allowed to perform the following two-staged operation:  choose an index of the sequence element i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|a|);  consecutively perform assignments: . Let\'s use function g(a,\xe2\x80\x89x) to represent the largest value that can be obtained from variable x, using the described operation any number of times and sequence a.Sereja has sequence b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89b|b|. Help Sereja calculate sum: . Record [bi,\xe2\x80\x89bi\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89bj] represents a sequence containing the elements in brackets in the given order. To avoid problems with precision, please, print the required sum divided by |b|2." "data structures" 2600
1423B "Valuable Paper" "The pandemic is upon us, and the world is in shortage of the most important resource: toilet paper. As one of the best prepared nations for this crisis, BubbleLand promised to help all other world nations with this valuable resource. To do that, the country will send airplanes to other countries carrying toilet paper.In BubbleLand, there are N toilet paper factories, and N airports. Because of how much it takes to build a road, and of course legal issues, every factory must send paper to only one airport, and every airport can only take toilet paper from one factory.Also, a road can\'t be built between all airport-factory pairs, again because of legal issues. Every possible road has number d given, number of days it takes to build that road.Your job is to choose N factory-airport pairs, such that if the country starts building all roads at the same time, it takes the least amount of days to complete them." "binary search,flows,graph matchings,graphs" 1900
1674E "Breaking the Wall" "Monocarp plays ""Rage of Empires II: Definitive Edition"" \xe2\x80\x94 a strategic computer game. Right now he\'s planning to attack his opponent in the game, but Monocarp\'s forces cannot enter the opponent\'s territory since the opponent has built a wall.The wall consists of n sections, aligned in a row. The i-th section initially has durability ai. If durability of some section becomes 0 or less, this section is considered broken.To attack the opponent, Monocarp needs to break at least two sections of the wall (any two sections: possibly adjacent, possibly not). To do this, he plans to use an onager \xe2\x80\x94 a special siege weapon. The onager can be used to shoot any section of the wall; the shot deals 2 damage to the target section and 1 damage to adjacent sections. In other words, if the onager shoots at the section x, then the durability of the section x decreases by 2, and the durability of the sections x\xe2\x88\x921 and x+1 (if they exist) decreases by 1 each. Monocarp can shoot at any sections any number of times, he can even shoot at broken sections.Monocarp wants to calculate the minimum number of onager shots needed to break at least two sections. Help him!" "binary search,brute force,constructive algorithms,greedy,math" 2000
1194A "Remove a Progression" "You have a list of numbers from 11 to nn written from left to right on the blackboard.You perform an algorithm consisting of several steps (steps are 11-indexed). On the ii-th step you wipe the ii-th number (considering only remaining numbers). You wipe the whole number (not one digit).  When there are less than ii numbers remaining, you stop your algorithm. Now you wonder: what is the value of the xx-th remaining number after the algorithm is stopped?" math 800
150B "Quantity of Strings" "Just in case somebody missed it: this winter is totally cold in Nvodsk! It is so cold that one gets funny thoughts. For example, let\'s say there are strings with the length exactly n, based on the alphabet of size m. Any its substring with length equal to k is a palindrome. How many such strings exist? Your task is to find their quantity modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897). Be careful and don\'t miss a string or two!Let us remind you that a string is a palindrome if it can be read the same way in either direction, from the left to the right and from the right to the left." "combinatorics,dfs and similar,graphs,math" 1600
1475C "Ball in Berland" "At the school where Vasya is studying, preparations are underway for the graduation ceremony. One of the planned performances is a ball, which will be attended by pairs of boys and girls.Each class must present two couples to the ball. In Vasya\'s class, a boys and b girls wish to participate. But not all boys and not all girls are ready to dance in pairs.Formally, you know k possible one-boy-one-girl pairs. You need to choose two of these pairs so that no person is in more than one pair.For example, if a=3, b=4, k=4 and the couples (1,2), (1,3), (2,2), (3,4) are ready to dance together (in each pair, the boy\'s number comes first, then the girl\'s number), then the following combinations of two pairs are possible (not all possible options are listed below):   (1,3) and (2,2);  (3,4) and (1,3); But the following combinations are not possible:   (1,3) and (1,2) \xe2\x80\x94 the first boy enters two pairs;  (1,2) and (2,2) \xe2\x80\x94 the second girl enters two pairs; Find the number of ways to select two pairs that match the condition above. Two ways are considered different if they consist of different pairs." combinatorics,graphs,math 1400
975A "Aramic script" "In Aramic language words can only represent objects.Words in Aramic have special properties:   A word is a root if it does not contain the same letter more than once.  A root and all its permutations represent the same object.  The root x of a word y is the word that contains all letters that appear in y in a way that each letter appears once. For example, the root of ""aaaa"", ""aa"", ""aaa"" is ""a"", the root of ""aabb"", ""bab"", ""baabb"", ""ab"" is ""ab"".  Any word in Aramic represents the same object as its root. You have an ancient script in Aramic. What is the number of different objects mentioned in the script?" implementation,strings 900
1153E "Serval and Snake" "This is an interactive problem.Now Serval is a senior high school student in Japari Middle School. However, on the way to the school, he must go across a pond, in which there is a dangerous snake. The pond can be represented as a n\xc3\x97n grid. The snake has a head and a tail in different cells, and its body is a series of adjacent cells connecting the head and the tail without self-intersecting. If Serval hits its head or tail, the snake will bite him and he will die.Luckily, he has a special device which can answer the following question: you can pick a rectangle, it will tell you the number of times one needs to cross the border of the rectangle walking cell by cell along the snake from the head to the tail. The pictures below show a possible snake and a possible query to it, which will get an answer of 4.    Today Serval got up too late and only have time to make 2019 queries. As his best friend, can you help him find the positions of the head and the tail?Note that two cells are adjacent if and only if they have a common edge in the grid, and a snake can have a body of length 0, that means it only has adjacent head and tail.Also note that the snake is sleeping, so it won\'t move while Serval using his device. And what\'s obvious is that the snake position does not depend on your queries." "binary search,brute force,interactive" 2200
1766D "Lucky Chains" "Let\'s name a pair of positive integers (x,y) lucky if the greatest common divisor of them is equal to 1 (gcd(x,y)=1).Let\'s define a chain induced by (x,y) as a sequence of pairs (x,y), (x+1,y+1), (x+2,y+2), \xe2\x80\xa6, (x+k,y+k) for some integer k\xe2\x89\xa50. The length of the chain is the number of pairs it consists of, or (k+1).Let\'s name such chain lucky if all pairs in the chain are lucky.You are given n pairs (xi,yi). Calculate for each pair the length of the longest lucky chain induced by this pair. Note that if (xi,yi) is not lucky itself, the chain will have the length 0." "math,number theory" 1600
1997D "Maximize the Root" "You are given a rooted tree, consisting of n vertices. The vertices in the tree are numbered from 1 to n, and the root is the vertex 1. The value ai is written at the i-th vertex.You can perform the following operation any number of times (possibly zero): choose a vertex v which has at least one child; increase av by 1; and decrease au by 1 for all vertices u that are in the subtree of v (except v itself). However, after each operation, the values on all vertices should be non-negative.Your task is to calculate the maximum possible value written at the root using the aforementioned operation." "binary search,dfs and similar,dp,greedy,trees" 1500
171G "Mysterious numbers - 2" "InputThe only line of input contains three integers a1,\xe2\x80\x89a2,\xe2\x80\x89a3 (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a1,\xe2\x80\x89a2,\xe2\x80\x89a3\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x8920), separated by spaces.OutputOutput a single integer.ExamplesInputCopy2 3 2OutputCopy5InputCopy13 14 1OutputCopy14InputCopy14 5 9OutputCopy464InputCopy17 18 3OutputCopy53" "*special problem" 1600
1167G "Low Budget Inception" "So we got bored and decided to take our own guess at how would ""Inception"" production go if the budget for the film had been terribly low.The first scene we remembered was the one that features the whole city bending onto itself:  It feels like it will require high CGI expenses, doesn\'t it? Luckily, we came up with a similar-looking scene which was a tiny bit cheaper to make.Firstly, forget about 3D, that\'s hard and expensive! The city is now represented as a number line (infinite to make it easier, of course).Secondly, the city doesn\'t have to look natural at all. There are nn buildings on the line. Each building is a square 1\xc3\x9711\xc3\x971. Buildings are numbered from 11 to nn in ascending order of their positions. Lower corners of building ii are at integer points aiai and ai+1ai+1 of the number line. Also the distance between any two neighbouring buildings ii and i+1i+1 doesn\'t exceed dd (really, this condition is here just to make the city look not that sparse). Distance between some neighbouring buildings ii and i+1i+1 is calculated from the lower right corner of building ii to the lower left corner of building i+1i+1.Finally, curvature of the bend is also really hard to simulate! Let the bend at some integer coordinate xx be performed with the following algorithm. Take the ray from xx to +\xe2\x88\x9e+\xe2\x88\x9e and all the buildings which are on this ray and start turning the ray and the buildings counter-clockwise around point xx. At some angle some building will touch either another building or a part of the line. You have to stop bending there (implementing buildings crushing is also not worth its money). Let\'s call the angle between two rays in the final state the terminal angle \xce\xb1x\xce\xb1x.The only thing left is to decide what integer point xx is the best to start bending around. Fortunately, we\'ve already chosen mm candidates to perform the bending.So, can you please help us to calculate terminal angle \xce\xb1x\xce\xb1x for each bend xx from our list of candidates?" "brute force,geometry" 3100
167B "Wizards and Huge Prize" "One must train much to do well on wizardry contests. So, there are numerous wizardry schools and magic fees.One of such magic schools consists of n tours. A winner of each tour gets a huge prize. The school is organised quite far away, so one will have to take all the prizes home in one go. And the bags that you\'ve brought with you have space for no more than k huge prizes.Besides the fact that you want to take all the prizes home, you also want to perform well. You will consider your performance good if you win at least l tours.In fact, years of organizing contests proved to the organizers that transporting huge prizes is an issue for the participants. Alas, no one has ever invented a spell that would shrink the prizes... So, here\'s the solution: for some tours the winner gets a bag instead of a huge prize. Each bag is characterized by number ai \xe2\x80\x94 the number of huge prizes that will fit into it.You already know the subject of all tours, so you can estimate the probability pi of winning the i-th tour. You cannot skip the tour under any circumstances.Find the probability that you will perform well on the contest and will be able to take all won prizes home (that is, that you will be able to fit all the huge prizes that you won into the bags that you either won or brought from home)." dp,math,probabilities 1800
496C "Removing Columns" "You are given an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m rectangular table consisting of lower case English letters. In one operation you can completely remove one column from the table. The remaining parts are combined forming a new table. For example, after removing the second column from the tableabcdedfghijk we obtain the table:acdefghjk A table is called good if its rows are ordered from top to bottom lexicographically, i.e. each row is lexicographically no larger than the following one. Determine the minimum number of operations of removing a column needed to make a given table good." "brute force,constructive algorithms,implementation" 1500
796D "Police Stations" "Inzane finally found Zane with a lot of money to spare, so they together decided to establish a country of their own.Ruling a country is not an easy job. Thieves and terrorists are always ready to ruin the country\'s peace. To fight back, Zane and Inzane have enacted a very effective law: from each city it must be possible to reach a police station by traveling at most d kilometers along the roads.  There are n cities in the country, numbered from 1 to n, connected only by exactly n\xe2\x80\x89-\xe2\x80\x891 roads. All roads are 1 kilometer long. It is initially possible to travel from a city to any other city using these roads. The country also has k police stations located in some cities. In particular, the city\'s structure satisfies the requirement enforced by the previously mentioned law. Also note that there can be multiple police stations in one city.However, Zane feels like having as many as n\xe2\x80\x89-\xe2\x80\x891 roads is unnecessary. The country is having financial issues, so it wants to minimize the road maintenance cost by shutting down as many roads as possible.Help Zane find the maximum number of roads that can be shut down without breaking the law. Also, help him determine such roads." "constructive algorithms,dfs and similar,dp,graphs,shortest paths,trees" 2100
1965A "Everything Nim" "Alice and Bob are playing a game on n piles of stones. On each player\'s turn, they select a positive integer k that is at most the size of the smallest nonempty pile and remove k stones from each nonempty pile at once. The first player who is unable to make a move (because all piles are empty) loses.Given that Alice goes first, who will win the game if both players play optimally?" games,greedy,math,sortings 1400
71E "Nuclear Fusion" "There is the following puzzle popular among nuclear physicists.A reactor contains a set of n atoms of some chemical elements. We shall understand the phrase ""atomic number"" as the number of this atom\'s element in the periodic table of the chemical elements.You are allowed to take any two different atoms and fuse a new one from them. That results in a new atom, whose number is equal to the sum of the numbers of original atoms. The fusion operation can be performed several times.The aim is getting a new pregiven set of k atoms.The puzzle\'s difficulty is that it is only allowed to fuse two atoms into one, it is not allowed to split an atom into several atoms. You are suggested to try to solve the puzzle." bitmasks,dp 2200
763D "Timofey and a flat tree" "Little Timofey has a big tree \xe2\x80\x94 an undirected connected graph with n vertices and no simple cycles. He likes to walk along it. His tree is flat so when he walks along it he sees it entirely. Quite naturally, when he stands on a vertex, he sees the tree as a rooted tree with the root in this vertex.Timofey assumes that the more non-isomorphic subtrees are there in the tree, the more beautiful the tree is. A subtree of a vertex is a subgraph containing this vertex and all its descendants. You should tell Timofey the vertex in which he should stand to see the most beautiful rooted tree.Subtrees of vertices u and v are isomorphic if the number of children of u equals the number of children of v, and their children can be arranged in such a way that the subtree of the first son of u is isomorphic to the subtree of the first son of v, the subtree of the second son of u is isomorphic to the subtree of the second son of v, and so on. In particular, subtrees consisting of single vertex are isomorphic to each other." "data structures,graphs,hashing,shortest paths,trees" 2900
1862D "Ice Cream Balls" "Tema decided to improve his ice cream making skills. He has already learned how to make ice cream in a cone using exactly two balls.Before his ice cream obsession, Tema was interested in mathematics. Therefore, he is curious about the minimum number of balls he needs to have in order to make exactly n different types of ice cream.There are plenty possible ice cream flavours: 1,2,3,\xe2\x80\xa6. Tema can make two-balls ice cream with any flavours (probably the same).Two ice creams are considered different if their sets of ball flavours are different. For example, {1,2}={2,1}, but {1,1}\xe2\x89\xa0{1,2}.For example, having the following ice cream balls: {1,1,2}, Tema can make only two types of ice cream: {1,1} and {1,2}.Note, that Tema do not need to make all the ice cream cones at the same time. This means that he making ice cream cones independently. Also in order to make a following cone {x,x} for some x, Tema needs at least 2 balls of type x.Help Tema answer this question. It can be shown that answer always exist." "binary search,combinatorics,constructive algorithms,math" 1300
1358E "Are You Fired?" "Levian works as an accountant in a large company. Levian knows how much the company has earned in each of the n consecutive months \xe2\x80\x94 in the i-th month the company had income equal to ai (positive income means profit, negative income means loss, zero income means no change). Because of the general self-isolation, the first \xe2\x8c\x88n2\xe2\x8c\x89 months income might have been completely unstable, but then everything stabilized and for the last \xe2\x8c\x8an2\xe2\x8c\x8b months the income was the same.Levian decided to tell the directors n\xe2\x88\x92k+1 numbers \xe2\x80\x94 the total income of the company for each k consecutive months. In other words, for each i between 1 and n\xe2\x88\x92k+1 he will say the value ai+ai+1+\xe2\x80\xa6+ai+k\xe2\x88\x921. For example, if a=[\xe2\x88\x921,0,1,2,2] and k=3 he will say the numbers 0,3,5.Unfortunately, if at least one total income reported by Levian is not a profit (income \xe2\x89\xa40), the directors will get angry and fire the failed accountant.Save Levian\'s career: find any such k, that for each k months in a row the company had made a profit, or report that it is impossible." "constructive algorithms,data structures,greedy,implementation" 2400
1237F "Balanced Domino Placements" "Consider a square grid with h rows and w columns with some dominoes on it. Each domino covers exactly two cells of the grid that share a common side. Every cell is covered by at most one domino.Let\'s call a placement of dominoes on the grid perfectly balanced if no row and no column contains a pair of cells covered by two different dominoes. In other words, every row and column may contain no covered cells, one covered cell, or two covered cells that belong to the same domino.You are given a perfectly balanced placement of dominoes on a grid. Find the number of ways to place zero or more extra dominoes on this grid to keep the placement perfectly balanced. Output this number modulo 998244353." combinatorics,dp 2600
1469A "Regular Bracket Sequence" "A bracket sequence is called regular if it is possible to obtain correct arithmetic expression by inserting characters + and 1 into this sequence. For example, sequences (())(), () and (()(())) are regular, while )(, (() and (()))( are not. Let\'s call a regular bracket sequence ""RBS"".You are given a sequence s of n characters (, ), and/or ?. There is exactly one character ( and exactly one character ) in this sequence.You have to replace every character ? with either ) or ( (different characters ? can be replaced with different brackets). You cannot reorder the characters, remove them, insert other characters, and each ? must be replaced.Determine if it is possible to obtain an RBS after these replacements." "constructive algorithms,greedy" 1000
479C Exams "Student Valera is an undergraduate student at the University. His end of term exams are approaching and he is to pass exactly n exams. Valera is a smart guy, so he will be able to pass any exam he takes on his first try. Besides, he can take several exams on one day, and in any order.According to the schedule, a student can take the exam for the i-th subject on the day number ai. However, Valera has made an arrangement with each teacher and the teacher of the i-th subject allowed him to take an exam before the schedule time on day bi (bi\xe2\x80\x89<\xe2\x80\x89ai). Thus, Valera can take an exam for the i-th subject either on day ai, or on day bi. All the teachers put the record of the exam in the student\'s record book on the day of the actual exam and write down the date of the mark as number ai.Valera believes that it would be rather strange if the entries in the record book did not go in the order of non-decreasing date. Therefore Valera asks you to help him. Find the minimum possible value of the day when Valera can take the final exam if he takes exams so that all the records in his record book go in the order of non-decreasing date." greedy,sortings 1400
1070L "Odd Federalization" "Berland has n cities, some of which are connected by roads. Each road is bidirectional, connects two distinct cities and for each two cities there\'s at most one road connecting them.The president of Berland decided to split country into r states in such a way that each city will belong to exactly one of these r states.After this split each road will connect either cities of the same state or cities of the different states. Let\'s call roads that connect two cities of the same state ""inner"" roads.The president doesn\'t like odd people, odd cities and odd numbers, so he wants this split to be done in such a way that each city would have even number of ""inner"" roads connected to it.Please help president to find smallest possible r for which such a split exists." "constructive algorithms" 2600
1952I "Dark Matter" "View the statement as a PDF." bitmasks,geometry -999
1085E "Vasya and Templates" "Vasya owns three strings s , a and b, each of them consists only of first k Latin letters.Let a template be such a string of length k that each of the first k Latin letters appears in it exactly once (thus there are k! distinct templates). Application of template p to the string s is the replacement of each character in string s with pi, i is the index of this letter in the alphabet. For example, applying template ""bdca"" to a string ""aabccd"" yields string ""bbdcca"".Vasya wants to know if there exists such a template which yields a string lexicographically greater than or equal to string a and lexicographically less than or equal to string b after applying it to s.If there exist multiple suitable templates, print any of them.String a is lexicographically less than string b if there is some i (1\xe2\x89\xa4i\xe2\x89\xa4n) that ai<bi and for any j (1\xe2\x89\xa4j<i) aj=bj.You are required to answer t testcases independently." greedy,implementation,strings 2300
1521C "Nastia and a Hidden Permutation" "This is an interactive problem!Nastia has a hidden permutation p of length n consisting of integers from 1 to n. You, for some reason, want to figure out the permutation. To do that, you can give her an integer t (1\xe2\x89\xa4t\xe2\x89\xa42), two different indices i and j (1\xe2\x89\xa4i,j\xe2\x89\xa4n, i\xe2\x89\xa0j), and an integer x (1\xe2\x89\xa4x\xe2\x89\xa4n\xe2\x88\x921). Depending on t, she will answer:   t=1: max(min(x,pi),min(x+1,pj));  t=2: min(max(x,pi),max(x+1,pj)). You can ask Nastia at most \xe2\x8c\x8a3\xe2\x8b\x85n2\xe2\x8c\x8b+30 times. It is guaranteed that she will not change her permutation depending on your queries. Can you guess the permutation?" "constructive algorithms,interactive" 2000
1015F "Bracket Substring" "You are given a bracket sequence s (not necessarily a regular one). A bracket sequence is a string containing only characters \'(\' and \')\'.A regular bracket sequence is a bracket sequence that can be transformed into a correct arithmetic expression by inserting characters \'1\' and \'+\' between the original characters of the sequence. For example, bracket sequences ""()()"" and ""(())"" are regular (the resulting expressions are: ""(1)+(1)"" and ""((1+1)+1)""), and "")("", ""("" and "")"" are not.Your problem is to calculate the number of regular bracket sequences of length 2n containing the given bracket sequence s as a substring (consecutive sequence of characters) modulo 109+7 (1000000007)." dp,strings 2300
551E "GukiZ and GukiZiana" "Professor GukiZ was playing with arrays again and accidentally discovered new function, which he called GukiZiana. For given array a, indexed with integers from 1 to n, and number y, GukiZiana(a,\xe2\x80\x89y) represents maximum value of j\xe2\x80\x89-\xe2\x80\x89i, such that aj\xe2\x80\x89=\xe2\x80\x89ai\xe2\x80\x89=\xe2\x80\x89y. If there is no y as an element in a, then GukiZiana(a,\xe2\x80\x89y) is equal to \xe2\x80\x89-\xe2\x80\x891. GukiZ also prepared a problem for you. This time, you have two types of queries:   First type has form 1 l r x and asks you to increase values of all ai such that l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r by the non-negative integer x.  Second type has form 2 y and asks you to find value of GukiZiana(a,\xe2\x80\x89y). For each query of type 2, print the answer and make GukiZ happy!" "binary search,data structures,implementation" 2500
1475D "Cleaning the Phone" "Polycarp often uses his smartphone. He has already installed n applications on it. Application with number i takes up ai units of memory.Polycarp wants to free at least m units of memory (by removing some applications).Of course, some applications are more important to Polycarp than others. He came up with the following scoring system \xe2\x80\x94 he assigned an integer bi to each application:   bi=1 \xe2\x80\x94 regular application;  bi=2 \xe2\x80\x94 important application. According to this rating system, his phone has b1+b2+\xe2\x80\xa6+bn convenience points.Polycarp believes that if he removes applications with numbers i1,i2,\xe2\x80\xa6,ik, then he will free ai1+ai2+\xe2\x80\xa6+aik units of memory and lose bi1+bi2+\xe2\x80\xa6+bik convenience points.For example, if n=5, m=7, a=[5,3,2,1,4], b=[2,1,1,2,1], then Polycarp can uninstall the following application sets (not all options are listed below):   applications with numbers 1,4 and 5. In this case, it will free a1+a4+a5=10 units of memory and lose b1+b4+b5=5 convenience points;  applications with numbers 1 and 3. In this case, it will free a1+a3=7 units of memory and lose b1+b3=3 convenience points.  applications with numbers 2 and 5. In this case, it will free a2+a5=7 memory units and lose b2+b5=2 convenience points. Help Polycarp, choose a set of applications, such that if removing them will free at least m units of memory and lose the minimum number of convenience points, or indicate that such a set does not exist." "binary search,dp,sortings,two pointers" 1800
111B "Petya and Divisors" "Little Petya loves looking for numbers\' divisors. One day Petya came across the following problem:You are given n queries in the form ""xi yi"". For each query Petya should count how many divisors of number xi divide none of the numbers xi\xe2\x80\x89-\xe2\x80\x89yi,\xe2\x80\x89xi\xe2\x80\x89-\xe2\x80\x89yi\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89xi\xe2\x80\x89-\xe2\x80\x891. Help him." "binary search,data structures,number theory" 1900
934B "A Prosperous Lot" "Apart from Nian, there is a daemon named Sui, which terrifies children and causes them to become sick. Parents give their children money wrapped in red packets and put them under the pillow, so that when Sui tries to approach them, it will be driven away by the fairies inside.Big Banban is hesitating over the amount of money to give out. He considers loops to be lucky since it symbolizes unity and harmony.He would like to find a positive integer n not greater than 1018, such that there are exactly k loops in the decimal representation of n, or determine that such n does not exist.A loop is a planar area enclosed by lines in the digits\' decimal representation written in Arabic numerals. For example, there is one loop in digit 4, two loops in 8 and no loops in 5. Refer to the figure below for all exact forms." "constructive algorithms,implementation" 1200
789B "Masha and geometric depression" "Masha really loves algebra. On the last lesson, her strict teacher Dvastan gave she new exercise.You are given geometric progression b defined by two integers b1 and q. Remind that a geometric progression is a sequence of integers b1,\xe2\x80\x89b2,\xe2\x80\x89b3,\xe2\x80\x89..., where for each i\xe2\x80\x89>\xe2\x80\x891 the respective term satisfies the condition bi\xe2\x80\x89=\xe2\x80\x89bi\xe2\x80\x89-\xe2\x80\x891\xc2\xb7q, where q is called the common ratio of the progression. Progressions in Uzhlyandia are unusual: both b1 and q can equal 0. Also, Dvastan gave Masha m ""bad"" integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89am, and an integer l.Masha writes all progression terms one by one onto the board (including repetitive) while condition |bi|\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l is satisfied (|x| means absolute value of x). There is an exception: if a term equals one of the ""bad"" integers, Masha skips it (doesn\'t write onto the board) and moves forward to the next term.But the lesson is going to end soon, so Masha has to calculate how many integers will be written on the board. In order not to get into depression, Masha asked you for help: help her calculate how many numbers she will write, or print ""inf"" in case she needs to write infinitely many integers." "brute force,implementation,math" 1700
1180B "Nick and Array" "Nick had received an awesome array of integers a=[a1,a2,\xe2\x80\xa6,an] as a gift for his 5 birthday from his mother. He was already going to explore its various properties but after unpacking he was disappointed a lot because the product a1\xe2\x8b\x85a2\xe2\x8b\x85\xe2\x80\xa6an of its elements seemed to him not large enough.He was ready to throw out the array, but his mother reassured him. She told him, that array would not be spoiled after the following operation: choose any index i (1\xe2\x89\xa4i\xe2\x89\xa4n) and do ai:=\xe2\x88\x92ai\xe2\x88\x921.For example, he can change array [3,\xe2\x88\x921,\xe2\x88\x924,1] to an array [\xe2\x88\x924,\xe2\x88\x921,3,1] after applying this operation to elements with indices i=1 and i=3. Kolya had immediately understood that sometimes it\'s possible to increase the product of integers of the array a lot. Now he has decided that he wants to get an array with the maximal possible product of integers using only this operation with its elements (possibly zero, one or more times, as many as he wants), it is not forbidden to do this operation several times for the same index. Help Kolya and print the array with the maximal possible product of elements a1\xe2\x8b\x85a2\xe2\x8b\x85\xe2\x80\xa6an which can be received using only this operation in some order.If there are multiple answers, print any of them." greedy,implementation 1500
1948B "Array Fix" "You are given an integer array a of length n.You can perform the following operation any number of times (possibly zero): take any element of the array a, which is at least 10, delete it, and instead insert the digits that element consisted of in the same position, in order they appear in that element.For example:  if we apply this operation to the 3-rd element of the array [12,3,45,67], then the array becomes [12,3,4,5,67].  if we apply this operation to the 2-nd element of the array [2,10], then the array becomes [2,1,0]. Your task is to determine whether it is possible to make a sorted in non-descending order using the aforementioned operation any number of times (possibly zero). In other words, you have to determine if it is possible to transform the array a in such a way that a1\xe2\x89\xa4a2\xe2\x89\xa4\xe2\x8b\xaf\xe2\x89\xa4ak, where k is the current length of the array a." "brute force,dp,greedy,implementation" 1100
1997F "Chips on a Line" "You have n chips, and you are going to place all of them in one of x points, numbered from 1 to x. There can be multiple chips in each point.After placing the chips, you can perform the following four operations (in any order, any number of times):  choose a chip in point i\xe2\x89\xa53, remove it and place two chips: one in i\xe2\x88\x921, one in i\xe2\x88\x922;  choose two chips in adjacent points i and i+1, remove them and place a new chip in i+2;  choose a chip in point 1 and move it to 2;  choose a chip in point 2 and move it to 1. Note that the coordinates of the chips you place during the operations cannot be less than 1, but can be greater than x.Denote the cost of chip placement as the minimum number of chips which can be present on the line after you perform these operations, starting from the placement you\'ve chosen.For example, the cost of placing two chips in points 3 and one chip in point 5 is 2, because you can reduce the number of chips to 2 as follows:  choose a chip in point 3, remove it, place a chip in 1 and another chip in 2;  choose the chips in points 2 and 3, remove them and place a chip in 4;  choose the chips in points 4 and 5, remove them and place a chip in 6. You are given three integers n, x and m. Calculate the number of placements of exactly n chips in points from 1 to x having cost equal to m, and print it modulo 998244353. Two placements are considered different if the number of chips in some point differs between these placements." "brute force,combinatorics,dp,greedy,math" 2700
980B Marlin "The city of Fishtopia can be imagined as a grid of 4 rows and an odd number of columns. It has two main villages; the first is located at the top-left cell (1,1), people who stay there love fishing at the Tuna pond at the bottom-right cell (4,n). The second village is located at (4,1) and its people love the Salmon pond at (1,n).The mayor of Fishtopia wants to place k hotels in the city, each one occupying one cell. To allow people to enter the city from anywhere, hotels should not be placed on the border cells.A person can move from one cell to another if those cells are not occupied by hotels and share a side.Can you help the mayor place the hotels in a way such that there are equal number of shortest paths from each village to its preferred pond?" "constructive algorithms" 1600
1154F "Shovels Shop" "There are n shovels in the nearby shop. The i-th shovel costs ai bourles.Misha has to buy exactly k shovels. Each shovel can be bought no more than once.Misha can buy shovels by several purchases. During one purchase he can choose any subset of remaining (non-bought) shovels and buy this subset.There are also m special offers in the shop. The j-th of them is given as a pair (xj,yj), and it means that if Misha buys exactly xj shovels during one purchase then yj most cheapest of them are for free (i.e. he will not pay for yj most cheapest shovels during the current purchase).Misha can use any offer any (possibly, zero) number of times, but he cannot use more than one offer during one purchase (but he can buy shovels without using any offers).Your task is to calculate the minimum cost of buying k shovels, if Misha buys them optimally." dp,greedy,sortings 2100
1879E "Interactive Game with Coloring" "This is an interactive problem. Remember to flush your output while communicating with the testing program. You may use fflush(stdout) in C++, system.out.flush() in Java, stdout.flush() in Python or flush(output) in Pascal to flush the output. If you use some other programming language, consult its documentation. You may also refer to the guide on interactive problems: https://codeforces.com/blog/entry/45307.You are given a tree on n vertices; vertex 1 is the root of the tree. For every i\xe2\x88\x88[2,n], the parent of the i-th vertex is pi, and pi<i.You have to color all edges of the tree using the minimum possible number of colors such that you can win the game on that tree (every edge should be painted into exactly one color).The game we\'re going to play will be conducted as follows. After you paint the edges and print their colors, the jury will place a chip into one of the vertices of the tree (except for the root). Your goal is to move this chip to the root in exactly d moves, where d is the distance from the root to that vertex (the distance is equal to the number of edges on the path). If the chip reaches the root in d moves, you win. Otherwise, you lose.The jury won\'t tell you where the chip is located. You won\'t even know the value of d in advance. However, at the start of each move, you will be told how many edges of each color are incident to the current vertex (this includes both the edge leading up the tree and the edges leading away from the root). You have to choose one of these colors, and the chip will be moved along the edge of the chosen color (if there are multiple edges with that color incident to the current vertex, the jury gets to choose one of them). After the chip is moved, you will be told the same information about the current vertex again, and the game continues, until you either reach the root, or you make d moves without reaching the root.The interactor for this problem is adaptive. It means that both the starting vertex and the current vertex are not fixed and may change ""on the run"" depending on the output of your program. However, the state of the game will always be consistent with the information you are given: there will always be at least one starting vertex and at least one path of your chip from that vertex consistent with both the information about the colors you receive and the colors you\'ve chosen during the moves." "brute force,constructive algorithms,dfs and similar,graphs,implementation,interactive,trees" 2400
865C "Gotta Go Fast" "You\'re trying to set the record on your favorite video game. The game consists of N levels, which must be completed sequentially in order to beat the game. You usually complete each level as fast as possible, but sometimes finish a level slower. Specifically, you will complete the i-th level in either Fi seconds or Si seconds, where Fi\xe2\x80\x89<\xe2\x80\x89Si, and there\'s a Pi percent chance of completing it in Fi seconds. After completing a level, you may decide to either continue the game and play the next level, or reset the game and start again from the first level. Both the decision and the action are instant.Your goal is to complete all the levels sequentially in at most R total seconds. You want to minimize the expected amount of time playing before achieving that goal. If you continue and reset optimally, how much total time can you expect to spend playing?" "binary search,dp" 2400
82E Corridor "Consider a house plan. Let the house be represented by an infinite horizontal strip defined by the inequality \xe2\x80\x89-\xe2\x80\x89h\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89h. Strictly outside the house there are two light sources at the points (0,\xe2\x80\x89f) and (0,\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x89f). Windows are located in the walls, the windows are represented by segments on the lines y\xe2\x80\x89=\xe2\x80\x89h and y\xe2\x80\x89=\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x89h. Also, the windows are arranged symmetrically about the line y\xe2\x80\x89=\xe2\x80\x890.Your task is to find the area of the floor at the home, which will be lighted by the sources of light." geometry 2600
474D Flowers "We saw the little game Marmot made for Mole\'s lunch. Now it\'s Marmot\'s dinner time and, as we all know, Marmot eats flowers. At every dinner he eats some red and white flowers. Therefore a dinner can be represented as a sequence of several flowers, some of them white and some of them red.But, for a dinner to be tasty, there is a rule: Marmot wants to eat white flowers only in groups of size k.Now Marmot wonders in how many ways he can eat between a and b flowers. As the number of ways could be very large, print it modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." dp 1700
1454C "Sequence Transformation" "You are given a sequence a, initially consisting of n integers.You want to transform this sequence so that all elements in it are equal (i. e. it contains several occurrences of the same element).To achieve this, you choose some integer x that occurs at least once in a, and then perform the following operation any number of times (possibly zero): choose some segment [l,r] of the sequence and remove it. But there is one exception: you are not allowed to choose a segment that contains x. More formally, you choose some contiguous subsequence [al,al+1,\xe2\x80\xa6,ar] such that ai\xe2\x89\xa0x if l\xe2\x89\xa4i\xe2\x89\xa4r, and remove it. After removal, the numbering of elements to the right of the removed segment changes: the element that was the (r+1)-th is now l-th, the element that was (r+2)-th is now (l+1)-th, and so on (i. e. the remaining sequence just collapses).Note that you can not change x after you chose it.For example, suppose n=6, a=[1,3,2,4,1,2]. Then one of the ways to transform it in two operations is to choose x=1, then:  choose l=2, r=4, so the resulting sequence is a=[1,1,2];  choose l=3, r=3, so the resulting sequence is a=[1,1]. Note that choosing x is not an operation. Also, note that you can not remove any occurrence of x.Your task is to find the minimum number of operations required to transform the sequence in a way described above.You have to answer t independent test cases." greedy,implementation 1200
1555F "Good Graph" "You have an undirected graph consisting of n vertices with weighted edges.A simple cycle is a cycle of the graph without repeated vertices. Let the weight of the cycle be the XOR of weights of edges it consists of.Let\'s say the graph is good if all its simple cycles have weight 1. A graph is bad if it\'s not good.Initially, the graph is empty. Then q queries follow. Each query has the next type:   u v x \xe2\x80\x94 add edge between vertices u and v of weight x if it doesn\'t make the graph bad. For each query print, was the edge added or not." "data structures,dsu,graphs,trees" 2700
1444E "Finding the Vertex" "This is an interactive problem.You are given a tree \xe2\x80\x94 connected undirected graph without cycles. One vertex of the tree is special, and you have to find which one. You can ask questions in the following form: given an edge of the tree, which endpoint is closer to the special vertex, meaning which endpoint\'s shortest path to the special vertex contains fewer edges. You have to find the special vertex by asking the minimum number of questions in the worst case for a given tree.Please note that the special vertex might not be fixed by the interactor in advance: it might change the vertex to any other one, with the requirement of being consistent with the previously given answers." "brute force,dfs and similar,dp,interactive,trees" 3500
1163C2 "Power Transmission (Hard Edition)" "This problem is same as the previous one, but has larger constraints.It was a Sunday morning when the three friends Selena, Shiro and Katie decided to have a trip to the nearby power station (do not try this at home). After arriving at the power station, the cats got impressed with a large power transmission system consisting of many chimneys, electric poles, and wires. Since they are cats, they found those things gigantic.At the entrance of the station, there is a map describing the complicated wiring system. Selena is the best at math among three friends. He decided to draw the map on the Cartesian plane. Each pole is now a point at some coordinates (xi,yi). Since every pole is different, all of the points representing these poles are distinct. Also, every two poles are connected with each other by wires. A wire is a straight line on the plane infinite in both directions. If there are more than two poles lying on the same line, they are connected by a single common wire.Selena thinks, that whenever two different electric wires intersect, they may interfere with each other and cause damage. So he wonders, how many pairs are intersecting? Could you help him with this problem?" "data structures,geometry,implementation,math" 1900
69B Bets "In Chelyabinsk lives a much respected businessman Nikita with a strange nickname ""Boss"". Once Nikita decided to go with his friend Alex to the Summer Biathlon World Cup. Nikita, as a very important person, received a token which allows to place bets on each section no more than on one competitor.To begin with friends learned the rules: in the race there are n sections of equal length and m participants. The participants numbered from 1 to m. About each participant the following is known: li \xe2\x80\x94 the number of the starting section,  ri \xe2\x80\x94 the number of the finishing section (li\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ri), ti \xe2\x80\x94 the time a biathlete needs to complete an section of the path, ci \xe2\x80\x94 the profit in roubles. If the i-th sportsman wins on one of the sections, the profit will be given to the man who had placed a bet on that sportsman. The i-th biathlete passes the sections from li to ri inclusive. The competitor runs the whole way in (ri\xe2\x80\x89-\xe2\x80\x89li\xe2\x80\x89+\xe2\x80\x891)\xc2\xb7ti time units. It takes him exactly ti time units to pass each section. In case of the athlete\'s victory on k sections the man who has betted on him receives k\xc2\xb7ci roubles.In each section the winner is determined independently as follows: if there is at least one biathlete running this in this section, then among all of them the winner is the one who has ran this section in minimum time (spent minimum time passing this section). In case of equality of times the athlete with the smaller index number wins. If there are no participants in this section, then the winner in this section in not determined. We have to say that in the summer biathlon all the participants are moving at a constant speed.We should also add that Nikita can bet on each section and on any contestant running in this section.Help the friends find the maximum possible profit." greedy,implementation 1200
1605A "A.M. Deviation" "A number a2 is said to be the arithmetic mean of two numbers a1 and a3, if the following condition holds: a1+a3=2\xe2\x8b\x85a2. We define an arithmetic mean deviation of three numbers a1, a2 and a3 as follows: d(a1,a2,a3)=|a1+a3\xe2\x88\x922\xe2\x8b\x85a2|.Arithmetic means a lot to Jeevan. He has three numbers a1, a2 and a3 and he wants to minimize the arithmetic mean deviation d(a1,a2,a3). To do so, he can perform the following operation any number of times (possibly zero):  Choose i,j from {1,2,3} such that i\xe2\x89\xa0j and increment ai by 1 and decrement aj by 1 Help Jeevan find out the minimum value of d(a1,a2,a3) that can be obtained after applying the operation any number of times." "math,number theory" 800
712A "Memory and Crow" "There are n integers b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bn written in a row. For all i from 1 to n, values ai are defined by the crows performing the following procedure:  The crow sets ai initially 0.  The crow then adds bi to ai, subtracts bi\xe2\x80\x89+\xe2\x80\x891, adds the bi\xe2\x80\x89+\xe2\x80\x892 number, and so on until the n\'th number. Thus, ai\xe2\x80\x89=\xe2\x80\x89bi\xe2\x80\x89-\xe2\x80\x89bi\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x89bi\xe2\x80\x89+\xe2\x80\x892\xe2\x80\x89-\xe2\x80\x89bi\xe2\x80\x89+\xe2\x80\x893.... Memory gives you the values a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an, and he now wants you to find the initial numbers b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bn written in the row? Can you do it?" implementation,math 800
1346E "Magic Tricks" "Masha is going to participate in a talent show conducted by the university she studies at. She wants to impress the audience with lots of different magic tricks!For one of her tricks, she uses n sponge balls, one of which is a special one. First, she arranges the balls in a row in such a way that the special ball is put on position k (positions are numbered from 1 to n from left to right). After that, she performs m swaps: during the i-th swap, she chooses the ball on position xi and the ball on position yi, and swaps them.Since Masha is a magician, she fakes some of her actions to trick the audience \xe2\x80\x94 when she starts performing a swap, she may fake it, so it is not performed (but it looks like it is performed for the audience). There are no constraints on which swaps Masha should fake or should actually perform \xe2\x80\x94 for example, she may fake all of the swaps, or even not fake anything at all.For the trick to work perfectly, the special ball should end up on a specific position \xe2\x80\x94 Masha has not decided yet, which position is perfect. Since faking swaps is difficult, for each position she wants to know the minimum number of swaps she has to fake so that the special ball ends up there. Unfortunately, Masha is a magician, neither a mathematician nor a programmer. So she needs your help in calculating what she wants!" "*special problem,dp,graphs" 1700
1420C2 "Pok\xc3\xa9mon Army (hard version)" "This is the hard version of the problem. The difference between the versions is that the easy version has no swap operations. You can make hacks only if all versions of the problem are solved.Pikachu is a cute and friendly pok\xc3\xa9mon living in the wild pikachu herd.But it has become known recently that infamous team R wanted to steal all these pok\xc3\xa9mon! Pok\xc3\xa9mon trainer Andrew decided to help Pikachu to build a pok\xc3\xa9mon army to resist.First, Andrew counted all the pok\xc3\xa9mon \xe2\x80\x94 there were exactly n pikachu. The strength of the i-th pok\xc3\xa9mon is equal to ai, and all these numbers are distinct.As an army, Andrew can choose any non-empty subsequence of pokemons. In other words, Andrew chooses some array b from k indices such that 1\xe2\x89\xa4b1<b2<\xe2\x8b\xaf<bk\xe2\x89\xa4n, and his army will consist of pok\xc3\xa9mons with forces ab1,ab2,\xe2\x80\xa6,abk.The strength of the army is equal to the alternating sum of elements of the subsequence; that is, ab1\xe2\x88\x92ab2+ab3\xe2\x88\x92ab4+\xe2\x80\xa6.Andrew is experimenting with pok\xc3\xa9mon order. He performs q operations. In i-th operation Andrew swaps li-th and ri-th pok\xc3\xa9mon.Andrew wants to know the maximal stregth of the army he can achieve with the initial pok\xc3\xa9mon placement. He also needs to know the maximal strength after each operation.Help Andrew and the pok\xc3\xa9mon, or team R will realize their tricky plan!" "data structures,divide and conquer,dp,greedy,implementation" 2100
359E Neatness "Simon loves neatness. So before he goes to bed, Simon wants to complete all chores in the house.Simon\'s house looks like a rectangular table consisting of n rows and n columns from above. All rows of the table are numbered from 1 to n from top to bottom. All columns of the table are numbered from 1 to n from left to right. Each cell of the table is a room. Pair (x,\xe2\x80\x89y) denotes the room, located at the intersection of the x-th row and the y-th column. For each room we know if the light is on or not there.Initially Simon is in room (x0,\xe2\x80\x89y0). He wants to turn off the lights in all the rooms in the house, and then return to room (x0,\xe2\x80\x89y0). Suppose that at the current moment Simon is in the room (x,\xe2\x80\x89y). To reach the desired result, he can perform the following steps:  The format of the action is ""1"". The action is to turn on the light in room (x,\xe2\x80\x89y). Simon cannot do it if the room already has light on.  The format of the action is ""2"". The action is to turn off the light in room (x,\xe2\x80\x89y). Simon cannot do it if the room already has light off.  The format of the action is ""dir"" (dir is a character). The action is to move to a side-adjacent room in direction dir. The direction can be left, right, up or down (the corresponding dir is L, R, U or D). Additionally, Simon can move only if he see a light in the direction dir. More formally, if we represent the room, Simon wants to go, as (nx,\xe2\x80\x89ny), there shold be an integer k (k\xe2\x80\x89>\xe2\x80\x890), that room (x\xe2\x80\x89+\xe2\x80\x89(nx\xe2\x80\x89-\xe2\x80\x89x)k,\xe2\x80\x89y\xe2\x80\x89+\xe2\x80\x89(ny\xe2\x80\x89-\xe2\x80\x89y)k) has a light. Of course, Simon cannot move out of his house. Help Simon, find the sequence of actions that lets him achieve the desired result." "constructive algorithms,dfs and similar" 2400
490E "Restoring Increasing Sequence" "Peter wrote on the board a strictly increasing sequence of positive integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. Then Vasil replaced some digits in the numbers of this sequence by question marks. Thus, each question mark corresponds to exactly one lost digit.Restore the the original sequence knowing digits remaining on the board." "binary search,brute force,greedy,implementation" 2000
342C "Cupboard and Balloons" "A girl named Xenia has a cupboard that looks like an arc from ahead. The arc is made of a semicircle with radius r (the cupboard\'s top) and two walls of height h (the cupboard\'s sides). The cupboard\'s depth is r, that is, it looks like a rectangle with base r and height h\xe2\x80\x89+\xe2\x80\x89r from the sides. The figure below shows what the cupboard looks like (the front view is on the left, the side view is on the right).  Xenia got lots of balloons for her birthday. The girl hates the mess, so she wants to store the balloons in the cupboard. Luckily, each balloon is a sphere with radius . Help Xenia calculate the maximum number of balloons she can put in her cupboard. You can say that a balloon is in the cupboard if you can\'t see any part of the balloon on the left or right view. The balloons in the cupboard can touch each other. It is not allowed to squeeze the balloons or deform them in any way. You can assume that the cupboard\'s walls are negligibly thin." geometry 1900
1594B "Special Numbers" "Theofanis really likes sequences of positive integers, thus his teacher (Yeltsa Kcir) gave him a problem about a sequence that consists of only special numbers.Let\'s call a positive number special if it can be written as a sum of different non-negative powers of n. For example, for n=4 number 17 is special, because it can be written as 40+42=1+16=17, but 9 is not.Theofanis asks you to help him find the k-th special number if they are sorted in increasing order. Since this number may be too large, output it modulo 109+7." bitmasks,math 1100
920B "Tea Queue" "Recently n students from city S moved to city P to attend a programming camp.They moved there by train. In the evening, all students in the train decided that they want to drink some tea. Of course, no two people can use the same teapot simultaneously, so the students had to form a queue to get their tea.i-th student comes to the end of the queue at the beginning of li-th second. If there are multiple students coming to the queue in the same moment, then the student with greater index comes after the student with lesser index. Students in the queue behave as follows: if there is nobody in the queue before the student, then he uses the teapot for exactly one second and leaves the queue with his tea; otherwise the student waits for the people before him to get their tea. If at the beginning of ri-th second student i still cannot get his tea (there is someone before him in the queue), then he leaves the queue without getting any tea. For each student determine the second he will use the teapot and get his tea (if he actually gets it)." implementation 1200
45E Director "Vasya is a born Berland film director, he is currently working on a new blockbuster, ""The Unexpected"". Vasya knows from his own experience how important it is to choose the main characters\' names and surnames wisely. He made up a list of n names and n surnames that he wants to use. Vasya haven\'t decided yet how to call characters, so he is free to match any name to any surname. Now he has to make the list of all the main characters in the following format: ""Name1 Surname1, Name2 Surname2, ..., Namen Surnamen"", i.e. all the name-surname pairs should be separated by exactly one comma and exactly one space, and the name should be separated from the surname by exactly one space. First of all Vasya wants to maximize the number of the pairs, in which the name and the surname start from one letter. If there are several such variants, Vasya wants to get the lexicographically minimal one. Help him.An answer will be verified a line in the format as is shown above, including the needed commas and spaces. It\'s the lexicographical minimality of such a line that needs to be ensured. The output line shouldn\'t end with a space or with a comma." "constructive algorithms,greedy" 2000
337B "Routine Problem" "Manao has a monitor. The screen of the monitor has horizontal to vertical length ratio a:b. Now he is going to watch a movie. The movie\'s frame has horizontal to vertical length ratio c:d. Manao adjusts the view in such a way that the movie preserves the original frame ratio, but also occupies as much space on the screen as possible and fits within it completely. Thus, he may have to zoom the movie in or out, but Manao will always change the frame proportionally in both dimensions.Calculate the ratio of empty screen (the part of the screen not occupied by the movie) to the total screen size. Print the answer as an irreducible fraction p\xe2\x80\x89/\xe2\x80\x89q." "greedy,math,number theory" 1400
870D "Something with XOR Queries" "This is an interactive problem.Jury has hidden a permutation p of integers from 0 to n\xe2\x80\x89-\xe2\x80\x891. You know only the length n. Remind that in permutation all integers are distinct.Let b be the inverse permutation for p, i.e. pbi\xe2\x80\x89=\xe2\x80\x89i for all i. The only thing you can do is to ask xor of elements pi and bj, printing two indices i and j (not necessarily distinct). As a result of the query with indices i and j you\'ll get the value , where  denotes the xor operation. You can find the description of xor operation in notes.Note that some permutations can remain indistinguishable from the hidden one, even if you make all possible n2 queries. You have to compute the number of permutations indistinguishable from the hidden one, and print one of such permutations, making no more than 2n queries.The hidden permutation does not depend on your queries." "brute force,interactive,probabilities" 2000
870A "Search for Pretty Integers" "You are given two lists of non-zero digits.Let\'s call an integer pretty if its (base 10) representation has at least one digit from the first list and at least one digit from the second list. What is the smallest positive pretty integer?" "brute force,implementation" 900
988C "Equal Sums" "You are given k sequences of integers. The length of the i-th sequence equals to ni.You have to choose exactly two sequences i and j (i\xe2\x89\xa0j) such that you can remove exactly one element in each of them in such a way that the sum of the changed sequence i (its length will be equal to ni\xe2\x88\x921) equals to the sum of the changed sequence j (its length will be equal to nj\xe2\x88\x921).Note that it\'s required to remove exactly one element in each of the two chosen sequences.Assume that the sum of the empty (of the length equals 0) sequence is 0." implementation,sortings 1400
81E Pairs "There are n students in Polycarp\'s class (including himself). A few days ago all students wrote an essay ""My best friend"". Each student\'s essay was dedicated to one of the students of class, to his/her best friend. Note that student b\'s best friend is not necessarily student a, if a\'s best friend is b.And now the teacher leads the whole class to the museum of the history of sports programming. Exciting stories of legendary heroes await the students: tourist, Petr, tomek, SnapDragon \xe2\x80\x94 that\'s who they will hear about!The teacher decided to divide students into pairs so that each pair consisted of a student and his best friend. She may not be able to split all the students into pairs, it\'s not a problem \xe2\x80\x94 she wants to pick out the maximum number of such pairs. If there is more than one variant of doing so, she wants to pick out the pairs so that there were as much boy-girl pairs as possible. Of course, each student must not be included in more than one pair." "dfs and similar,dp,dsu,graphs,implementation,trees" 2700
415A "Mashmokh and Lights" "Mashmokh works in a factory. At the end of each day he must turn off all of the lights. The lights on the factory are indexed from 1 to n. There are n buttons in Mashmokh\'s room indexed from 1 to n as well. If Mashmokh pushes button with index i, then each light with index not less than i that is still turned on turns off.Mashmokh is not very clever. So instead of pushing the first button he pushes some of the buttons randomly each night. He pushed m distinct buttons b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bm (the buttons were pushed consecutively in the given order) this night. Now he wants to know for each light the index of the button that turned this light off. Please note that the index of button bi is actually bi, not i.Please, help Mashmokh, print these indices." implementation 900
1954B "Make It Ugly" "Let\'s call an array a beautiful if you can make all its elements the same by using the following operation an arbitrary number of times (possibly, zero):   choose an index i (2\xe2\x89\xa4i\xe2\x89\xa4|a|\xe2\x88\x921) such that ai\xe2\x88\x921=ai+1, and replace ai with ai\xe2\x88\x921. You are given a beautiful array a1,a2,\xe2\x80\xa6,an. What is the minimum number of elements you have to remove from it in order for it to stop being beautiful? Swapping elements is prohibited. If it is impossible to do so, then output -1." implementation,math 1200
1211F kotlinkotlinkotlinkotlin... "Polycarp really likes writing the word ""kotlin"". He wrote this word several times in a row without spaces. For example, he could write the string like ""kotlinkotlinkotlinkotlin"".Polycarp sliced (cut) the written string into n pieces and mixed them. As a result, he has n strings s1,s2,\xe2\x80\xa6,sn and he can arrange them in the right order, concatenate (join) all of them and get a string like ""kotlinkotlin...kotlin"".Help Polycarp to find the right order of strings s1,s2,\xe2\x80\xa6,sn, so that if he writes the strings in this order, he will get the word ""kotlin"" or the sequence of this word.Pay attention that you must use all given strings and you must use each string only once." "*special problem,graphs,implementation,strings" 2300
388D "Fox and Perfect Sets" "Fox Ciel studies number theory.She thinks a non-empty set S contains non-negative integers is perfect if and only if for any  (a can be equal to b), . Where operation xor means exclusive or operation (http://en.wikipedia.org/wiki/Exclusive_or).Please calculate the number of perfect sets consisting of integers not greater than k. The answer can be very large, so print it modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." math 2700
100G "Name the album" "The famous singer, Aryo, is going to publish a new album of his great work!Unfortunately these days, there are many albums, Aryo wants to choose a new name for his album, a name that has not been used or at least has not been used recently.He has a list of all used album names together with the year the albums were published. He also has a list of suitable names for his album.If he finds a suitable name which has not been used before, he\'ll use it. Otherwise he will use the name which was used as long ago as possible. If two such names are found (that haven\'t been used or were used at the same year), he uses the name that is alphabetically latest.Help him name his album." "*special problem,data structures,implementation" 1800
618B "Guess the Permutation" "Bob has a permutation of integers from 1 to n. Denote this permutation as p. The i-th element of p will be denoted as pi. For all pairs of distinct integers i,\xe2\x80\x89j between 1 and n, he wrote the number ai,\xe2\x80\x89j\xe2\x80\x89=\xe2\x80\x89min(pi,\xe2\x80\x89pj). He writes ai,\xe2\x80\x89i\xe2\x80\x89=\xe2\x80\x890 for all integer i from 1 to n.Bob gave you all the values of ai,\xe2\x80\x89j that he wrote down. Your job is to reconstruct any permutation that could have generated these values. The input will be formed so that it is guaranteed that there is at least one solution that is consistent with the information given." "constructive algorithms" 1100
321B "Ciel and Duel" "Fox Ciel is playing a card game with her friend Jiro.Jiro has n cards, each one has two attributes: position (Attack or Defense) and strength. Fox Ciel has m cards, each one has these two attributes too. It\'s known that position of all Ciel\'s cards is Attack.Now is Ciel\'s battle phase, Ciel can do the following operation many times:  Choose one of her cards X. This card mustn\'t be chosen before.  If Jiro has no alive cards at that moment, he gets the damage equal to (X\'s strength). Otherwise, Ciel needs to choose one Jiro\'s alive card Y, then:   If Y\'s position is Attack, then (X\'s strength) \xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89 (Y\'s strength) must hold. After this attack, card Y dies, and Jiro gets the damage equal to (X\'s strength) - (Y\'s strength).  If Y\'s position is Defense, then (X\'s strength) \xe2\x80\x89>\xe2\x80\x89 (Y\'s strength) must hold. After this attack, card Y dies, but Jiro gets no damage.  Ciel can end her battle phase at any moment (so, she can use not all her cards). Help the Fox to calculate the maximal sum of damage Jiro can get." dp,flows,greedy 1900
1082D "Maximum Diameter Graph" "Graph constructive problems are back! This time the graph you are asked to build should match the following properties.The graph is connected if and only if there exists a path between every pair of vertices.The diameter (aka ""longest shortest path"") of a connected undirected graph is the maximum number of edges in the shortest path between any pair of its vertices.The degree of a vertex is the number of edges incident to it.Given a sequence of n integers a1,a2,\xe2\x80\xa6,an construct a connected undirected graph of n vertices such that:  the graph contains no self-loops and no multiple edges;  the degree di of the i-th vertex doesn\'t exceed ai (i.e. di\xe2\x89\xa4ai);  the diameter of the graph is maximum possible. Output the resulting graph or report that no solution exists." "constructive algorithms,graphs,implementation" 1800
799D "Field expansion" "In one of the games Arkady is fond of the game process happens on a rectangular field. In the game process Arkady can buy extensions for his field, each extension enlarges one of the field sizes in a particular number of times. Formally, there are n extensions, the i-th of them multiplies the width or the length (by Arkady\'s choice) by ai. Each extension can\'t be used more than once, the extensions can be used in any order.Now Arkady\'s field has size h\xe2\x80\x89\xc3\x97\xe2\x80\x89w. He wants to enlarge it so that it is possible to place a rectangle of size a\xe2\x80\x89\xc3\x97\xe2\x80\x89b on it (along the width or along the length, with sides parallel to the field sides). Find the minimum number of extensions needed to reach Arkady\'s goal." "brute force,dp,meet-in-the-middle" 2100
730K "Roads Orientation Problem" "Berland consists of n cities and m bidirectional roads connecting pairs of cities. There is no road connecting a city to itself, and between any pair of cities there is no more than one road. It is possible to reach any city from any other moving along roads.Currently Mr. President is in the city s and his destination is the city t. He plans to move along roads from s to t (s\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89t).That\'s why Ministry of Fools and Roads has difficult days. The minister is afraid that Mr. President could get into a traffic jam or get lost. Who knows what else can happen!To be sure that everything goes as planned, the minister decided to temporarily make all roads one-way. So each road will be oriented in one of two possible directions. The following conditions must be satisfied:  There should be no cycles along roads after orientation.  The city s should be the only such city that all its roads are oriented out (i.e. there are no ingoing roads to the city s and the city s is the only such city).  The city t should be the only such city that all its roads are oriented in (i.e. there are no outgoing roads from the city t and the city t is the only such city). Help the minister solve his problem. Write a program to find any such orientation of all roads or report that no solution exists." graphs 3200
575I "Robots protection" "Company ""Robots industries"" produces robots for territory protection. Robots protect triangle territories \xe2\x80\x94 right isosceles triangles with catheti parallel to North-South and East-West directions.Owner of some land buys and sets robots on his territory to protect it. From time to time, businessmen want to build offices on that land and want to know how many robots will guard it. You are to handle these queries." "data structures" 2800
1799H "Tree Cutting" "You are given a tree with n vertices.A hero k times do the following operation:  Choose some edge.  Remove it.  Take one of the two remaining parts and delete it.  Write the number of vertices in the remaining part. You are given an initial tree and the a sequence of written numbers. Find the number of ways to make operations such that the written numbers are equal to the given numbers. Due to the answer can be big, find it by modulo 998244353. Two ways are considered different, if on some operation edge or remaining part are selected differently." "bitmasks,dfs and similar,dp" 3200
1375E "Inversion SwapSort" "Madeline has an array a of n integers. A pair (u,v) of integers forms an inversion in a if:  1\xe2\x89\xa4u<v\xe2\x89\xa4n.  au>av. Madeline recently found a magical paper, which allows her to write two indices u and v and swap the values au and av. Being bored, she decided to write a list of pairs (ui,vi) with the following conditions:  all the pairs in the list are distinct and form an inversion in a.  all the pairs that form an inversion in a are in the list.  Starting from the given array, if you swap the values at indices u1 and v1, then the values at indices u2 and v2 and so on, then after all pairs are processed, the array a will be sorted in non-decreasing order. Construct such a list or determine that no such list exists. If there are multiple possible answers, you may find any of them." "constructive algorithms,greedy,sortings" 2500
17E Palisection "In an English class Nick had nothing to do at all, and remembered about wonderful strings called palindromes. We should remind you that a string is called a palindrome if it can be read the same way both from left to right and from right to left. Here are examples of such strings: \xc2\xabeye\xc2\xbb, \xc2\xabpop\xc2\xbb, \xc2\xablevel\xc2\xbb, \xc2\xababa\xc2\xbb, \xc2\xabdeed\xc2\xbb, \xc2\xabracecar\xc2\xbb, \xc2\xabrotor\xc2\xbb, \xc2\xabmadam\xc2\xbb. Nick started to look carefully for all palindromes in the text that they were reading in the class. For each occurrence of each palindrome in the text he wrote a pair \xe2\x80\x94 the position of the beginning and the position of the ending of this occurrence in the text. Nick called each occurrence of each palindrome he found in the text subpalindrome. When he found all the subpalindromes, he decided to find out how many different pairs among these subpalindromes cross. Two subpalindromes cross if they cover common positions in the text. No palindrome can cross itself.Let\'s look at the actions, performed by Nick, by the example of text \xc2\xabbabb\xc2\xbb. At first he wrote out all subpalindromes:\xe2\x80\xa2 \xc2\xabb\xc2\xbb \xe2\x80\x94 1..1 \xe2\x80\xa2 \xc2\xabbab\xc2\xbb \xe2\x80\x94 1..3 \xe2\x80\xa2 \xc2\xaba\xc2\xbb \xe2\x80\x94 2..2 \xe2\x80\xa2 \xc2\xabb\xc2\xbb \xe2\x80\x94 3..3 \xe2\x80\xa2 \xc2\xabbb\xc2\xbb \xe2\x80\x94 3..4 \xe2\x80\xa2 \xc2\xabb\xc2\xbb \xe2\x80\x94 4..4 Then Nick counted the amount of different pairs among these subpalindromes that cross. These pairs were six: 1. 1..1 cross with 1..3  2. 1..3 cross with 2..2  3. 1..3 cross with 3..3  4. 1..3 cross with 3..4  5. 3..3 cross with 3..4  6. 3..4 cross with 4..4 Since it\'s very exhausting to perform all the described actions manually, Nick asked you to help him and write a program that can find out the amount of different subpalindrome pairs that cross. Two subpalindrome pairs are regarded as different if one of the pairs contains a subpalindrome that the other does not." strings 2900
1970B2 "Exact Neighbours (Medium)" "The only difference between this and the hard version is that a1=0.After some recent attacks on Hogwarts Castle by the Death Eaters, the Order of the Phoenix has decided to station n members in Hogsmead Village. The houses will be situated on a picturesque n\xc3\x97n square field. Each wizard will have their own house, and every house will belong to some wizard. Each house will take up the space of one square.However, as you might know wizards are very superstitious. During the weekends, each wizard i will want to visit the house that is exactly ai (0\xe2\x89\xa4ai\xe2\x89\xa4n) away from their own house. The roads in the village are built horizontally and vertically, so the distance between points (xi,yi) and (xj,yj) on the n\xc3\x97n field is |xi\xe2\x88\x92xj|+|yi\xe2\x88\x92yj|. The wizards know and trust each other, so one wizard can visit another wizard\'s house when the second wizard is away. The houses to be built will be big enough for all n wizards to simultaneously visit any house.Apart from that, each wizard is mandated to have a view of the Hogwarts Castle in the north and the Forbidden Forest in the south, so the house of no other wizard should block the view. In terms of the village, it means that in each column of the n\xc3\x97n field, there can be at most one house, i.e. if the i-th house has coordinates (xi,yi), then xi\xe2\x89\xa0xj for all i\xe2\x89\xa0j.The Order of the Phoenix doesn\'t yet know if it is possible to place n houses in such a way that will satisfy the visit and view requirements of all n wizards, so they are asking for your help in designing such a plan.If it is possible to have a correct placement, where for the i-th wizard there is a house that is ai away from it and the house of the i-th wizard is the only house in their column, output YES, the position of houses for each wizard, and to the house of which wizard should each wizard go during the weekends.If it is impossible to have a correct placement, output NO." "constructive algorithms" 2100
1493F "Enchanted Matrix" "This is an interactive problem.There exists a matrix a of size n\xc3\x97m (n rows and m columns), you know only numbers n and m. The rows of the matrix are numbered from 1 to n from top to bottom, and columns of the matrix are numbered from 1 to m from left to right. The cell on the intersection of the x-th row and the y-th column is denoted as (x,y).You are asked to find the number of pairs (r,c) (1\xe2\x89\xa4r\xe2\x89\xa4n, 1\xe2\x89\xa4c\xe2\x89\xa4m, r is a divisor of n, c is a divisor of m) such that if we split the matrix into rectangles of size r\xc3\x97c (of height r rows and of width c columns, each cell belongs to exactly one rectangle), all those rectangles are pairwise equal.You can use queries of the following type:   ? h w i1 j1 i2 j2 (1\xe2\x89\xa4h\xe2\x89\xa4n, 1\xe2\x89\xa4w\xe2\x89\xa4m, 1\xe2\x89\xa4i1,i2\xe2\x89\xa4n, 1\xe2\x89\xa4j1,j2\xe2\x89\xa4m) \xe2\x80\x94 to check if non-overlapping subrectangles of height h rows and of width w columns of matrix a are equal or not. The upper left corner of the first rectangle is (i1,j1). The upper left corner of the second rectangle is (i2,j2). Subrectangles overlap, if they have at least one mutual cell. If the subrectangles in your query have incorrect coordinates (for example, they go beyond the boundaries of the matrix) or overlap, your solution will be considered incorrect. You can use at most 3\xe2\x8b\x85\xe2\x8c\x8alog2(n+m)\xe2\x8c\x8b queries. All elements of the matrix a are fixed before the start of your program and do not depend on your queries." "bitmasks,interactive,number theory" 2600
1704D "Magical Array" "Eric has an array b of length m, then he generates n additional arrays c1,c2,\xe2\x80\xa6,cn, each of length m, from the array b, by the following way:Initially, ci=b for every 1\xe2\x89\xa4i\xe2\x89\xa4n. Eric secretly chooses an integer k (1\xe2\x89\xa4k\xe2\x89\xa4n) and chooses ck to be the special array.There are two operations that Eric can perform on an array ct: Operation 1: Choose two integers i and j (2\xe2\x89\xa4i<j\xe2\x89\xa4m\xe2\x88\x921), subtract 1 from both ct[i] and ct[j], and add 1 to both ct[i\xe2\x88\x921] and ct[j+1]. That operation can only be used on a non-special array, that is when t\xe2\x89\xa0k.; Operation 2: Choose two integers i and j (2\xe2\x89\xa4i<j\xe2\x89\xa4m\xe2\x88\x922), subtract 1 from both ct[i] and ct[j], and add 1 to both ct[i\xe2\x88\x921] and ct[j+2]. That operation can only be used on a special array, that is when t=k.Note that Eric can\'t perform an operation if any element of the array will become less than 0 after that operation.Now, Eric does the following:  For every non-special array ci (i\xe2\x89\xa0k), Eric uses only operation 1 on it at least once. For the special array ck, Eric uses only operation 2 on it at least once.Lastly, Eric discards the array b.For given arrays c1,c2,\xe2\x80\xa6,cn, your task is to find out the special array, i.e. the value k. Also, you need to find the number of times of operation 2 was used on it." "constructive algorithms,hashing,implementation,math" 1900
1969D "Shop Game" "Alice and Bob are playing a game in the shop. There are n items in the shop; each item has two parameters: ai (item price for Alice) and bi (item price for Bob).Alice wants to choose a subset (possibly empty) of items and buy them. After that, Bob does the following:   if Alice bought less than k items, Bob can take all of them for free;  otherwise, he will take k items for free that Alice bought (Bob chooses which k items it will be), and for the rest of the chosen items, Bob will buy them from Alice and pay bi for the i-th item. Alice\'s profit is equal to \xe2\x88\x91i\xe2\x88\x88Sbi\xe2\x88\x92\xe2\x88\x91j\xe2\x88\x88Taj, where S is the set of items Bob buys from Alice, and T is the set of items Alice buys from the shop. In other words, Alice\'s profit is the difference between the amount Bob pays her and the amount she spends buying the items.Alice wants to maximize her profit, Bob wants to minimize Alice\'s profit. Your task is to calculate Alice\'s profit if both Alice and Bob act optimally." "data structures,greedy,math,sortings" 1900
1265A "Beautiful String" "A string is called beautiful if no two consecutive characters are equal. For example, ""ababcb"", ""a"" and ""abab"" are beautiful strings, while ""aaaaaa"", ""abaa"" and ""bb"" are not.Ahcl wants to construct a beautiful string. He has a string s, consisting of only characters \'a\', \'b\', \'c\' and \'?\'. Ahcl needs to replace each character \'?\' with one of the three characters \'a\', \'b\' or \'c\', such that the resulting string is beautiful. Please help him!More formally, after replacing all characters \'?\', the condition si\xe2\x89\xa0si+1 should be satisfied for all 1\xe2\x89\xa4i\xe2\x89\xa4|s|\xe2\x88\x921, where |s| is the length of the string s." "constructive algorithms,greedy" 1000
45A "Codecraft III" "Today Vasya visited a widely known site and learned that the continuation of his favourite game Codecraft II will appear after exactly k months. He looked at the calendar and learned that at the moment is the month number s. Vasya immediately got interested in what month Codecraft III will appear. Help him understand that.All the twelve months in Vasya\'s calendar are named using their usual English names: January, February, March, April, May, June, July, August, September, October, November, December." implementation 900
1146G "Zoning Restrictions" "You are planning to build housing on a street. There are n spots available on the street on which you can build a house. The spots are labeled from 1 to n from left to right. In each spot, you can build a house with an integer height between 0 and h.In each spot, if a house has height a, you can gain a2 dollars from it.The city has m zoning restrictions though. The i-th restriction says that if the tallest house from spots li to ri is strictly more than xi, you must pay a fine of ci.You would like to build houses to maximize your profit (sum of dollars gained minus fines). Determine the maximum profit possible." dp,flows,graphs 2700
420B "Online Meeting" "Nearly each project of the F company has a whole team of developers working on it. They often are in different rooms of the office in different cities and even countries. To keep in touch and track the results of the project, the F company conducts shared online meetings in a Spyke chat.One day the director of the F company got hold of the records of a part of an online meeting of one successful team. The director watched the record and wanted to talk to the team leader. But how can he tell who the leader is? The director logically supposed that the leader is the person who is present at any conversation during a chat meeting. In other words, if at some moment of time at least one person is present on the meeting, then the leader is present on the meeting.You are the assistant director. Given the \'user logged on\'/\'user logged off\' messages of the meeting in the chronological order, help the director determine who can be the leader. Note that the director has the record of only a continuous part of the meeting (probably, it\'s not the whole meeting)." implementation 1800
750D "New Year and Fireworks" "One tradition of welcoming the New Year is launching fireworks into the sky. Usually a launched firework flies vertically upward for some period of time, then explodes, splitting into several parts flying in different directions. Sometimes those parts also explode after some period of time, splitting into even more parts, and so on.Limak, who lives in an infinite grid, has a single firework. The behaviour of the firework is described with a recursion depth n and a duration for each level of recursion t1,\xe2\x80\x89t2,\xe2\x80\x89...,\xe2\x80\x89tn. Once Limak launches the firework in some cell, the firework starts moving upward. After covering t1 cells (including the starting cell), it explodes and splits into two parts, each moving in the direction changed by 45 degrees (see the pictures below for clarification). So, one part moves in the top-left direction, while the other one moves in the top-right direction. Each part explodes again after covering t2 cells, splitting into two parts moving in directions again changed by 45 degrees. The process continues till the n-th level of recursion, when all 2n\xe2\x80\x89-\xe2\x80\x891 existing parts explode and disappear without creating new parts. After a few levels of recursion, it\'s possible that some parts will be at the same place and at the same time \xe2\x80\x94 it is allowed and such parts do not crash.Before launching the firework, Limak must make sure that nobody stands in cells which will be visited at least once by the firework. Can you count the number of those cells?" "brute force,data structures,dfs and similar,dp,implementation" 1900
1800F "Dasha and Nightmares" "Dasha, an excellent student, is studying at the best mathematical lyceum in the country. Recently, a mysterious stranger brought n words consisting of small latin letters s1,s2,\xe2\x80\xa6,sn to the lyceum. Since that day, Dasha has been tormented by nightmares.Consider some pair of integers \xe2\x9f\xa8i,j\xe2\x9f\xa9 (1\xe2\x89\xa4i\xe2\x89\xa4j\xe2\x89\xa4n). A nightmare is a string for which it is true:  It is obtained by concatenation sisj;  Its length is odd;  The number of different letters in it is exactly 25;  The number of occurrences of each letter that is in the word is odd. For example, if si= ""abcdefg"" and sj= ""ijklmnopqrstuvwxyz"", the pair \xe2\x9f\xa8i,j\xe2\x9f\xa9 creates a nightmare.Dasha will stop having nightmares if she counts their number. There are too many nightmares, so Dasha needs your help. Count the number of different nightmares.Nightmares are called different if the corresponding pairs \xe2\x9f\xa8i,j\xe2\x9f\xa9 are different. The pairs \xe2\x9f\xa8i1,j1\xe2\x9f\xa9 and \xe2\x9f\xa8i2,j2\xe2\x9f\xa9 are called different if i1\xe2\x89\xa0i2 or j1\xe2\x89\xa0j2." bitmasks,hashing,meet-in-the-middle,strings 1900
547C "Mike and Foam" "Mike is a bartender at Rico\'s bar. At Rico\'s, they put beer glasses in a special shelf. There are n kinds of beer at Rico\'s numbered from 1 to n. i-th kind of beer has ai milliliters of foam on it.  Maxim is Mike\'s boss. Today he told Mike to perform q queries. Initially the shelf is empty. In each request, Maxim gives him a number x. If beer number x is already in the shelf, then Mike should remove it from the shelf, otherwise he should put it in the shelf.After each query, Mike should tell him the score of the shelf. Bears are geeks. So they think that the score of a shelf is the number of pairs (i,\xe2\x80\x89j) of glasses in the shelf such that i\xe2\x80\x89<\xe2\x80\x89j and  where  is the greatest common divisor of numbers a and b.Mike is tired. So he asked you to help him in performing these requests." "bitmasks,combinatorics,dp,math,number theory" 2300
1473A "Replacing Elements" "You have an array a1,a2,\xe2\x80\xa6,an. All ai are positive integers.In one step you can choose three distinct indices i, j, and k (i\xe2\x89\xa0j; i\xe2\x89\xa0k; j\xe2\x89\xa0k) and assign the sum of aj and ak to ai, i. e. make ai=aj+ak.Can you make all ai lower or equal to d using the operation above any number of times (possibly, zero)?" greedy,implementation,math,sortings 800
1361F "Johnny and New Toy" "Johnny has a new toy. As you may guess, it is a little bit extraordinary. The toy is a permutation P of numbers from 1 to n, written in one row next to each other. For each i from 1 to n\xe2\x88\x921 between Pi and Pi+1 there is a weight Wi written, and those weights form a permutation of numbers from 1 to n\xe2\x88\x921. There are also extra weights W0=Wn=0.The instruction defines subsegment [L,R] as good if WL\xe2\x88\x921<Wi and WR<Wi for any i in {L,L+1,\xe2\x80\xa6,R\xe2\x88\x921}. For such subsegment it also defines WM as minimum of set {WL,WL+1,\xe2\x80\xa6,WR\xe2\x88\x921}. Now the fun begins. In one move, the player can choose one of the good subsegments, cut it into [L,M] and [M+1,R] and swap the two parts. More precisely, before one move the chosen subsegment of our toy looks like: WL\xe2\x88\x921,PL,WL,\xe2\x80\xa6,WM\xe2\x88\x921,PM,WM,PM+1,WM+1,\xe2\x80\xa6,WR\xe2\x88\x921,PR,WR and afterwards it looks like this: WL\xe2\x88\x921,PM+1,WM+1,\xe2\x80\xa6,WR\xe2\x88\x921,PR,WM,PL,WL,\xe2\x80\xa6,WM\xe2\x88\x921,PM,WR Such a move can be performed multiple times (possibly zero), and the goal is to achieve the minimum number of inversions in P. Johnny\'s younger sister Megan thinks that the rules are too complicated, so she wants to test her brother by choosing some pair of indices X and Y, and swapping PX and PY (X might be equal Y). After each sister\'s swap, Johnny wonders, what is the minimal number of inversions that he can achieve, starting with current P and making legal moves?You can assume that the input is generated randomly. P and W were chosen independently and equiprobably over all permutations; also, Megan\'s requests were chosen independently and equiprobably over all pairs of indices." "data structures,implementation,math" 3300
1569D "Inconvenient Pairs" "There is a city that can be represented as a square grid with corner points in (0,0) and (106,106).The city has n vertical and m horizontal streets that goes across the whole city, i. e. the i-th vertical streets goes from (xi,0) to (xi,106) and the j-th horizontal street goes from (0,yj) to (106,yj). All streets are bidirectional. Borders of the city are streets as well.There are k persons staying on the streets: the p-th person at point (xp,yp) (so either xp equal to some xi or yp equal to some yj, or both).Let\'s say that a pair of persons form an inconvenient pair if the shortest path from one person to another going only by streets is strictly greater than the Manhattan distance between them.Calculate the number of inconvenient pairs of persons (pairs (x,y) and (y,x) are the same pair).Let\'s recall that Manhattan distance between points (x1,y1) and (x2,y2) is |x1\xe2\x88\x92x2|+|y1\xe2\x88\x92y2|." "binary search,data structures,implementation,sortings,two pointers" 1900
1205F "Beauty of a Permutation" "Define the beauty of a permutation of numbers from 1 to n (p1,p2,\xe2\x80\xa6,pn) as number of pairs (L,R) such that 1\xe2\x89\xa4L\xe2\x89\xa4R\xe2\x89\xa4n and numbers pL,pL+1,\xe2\x80\xa6,pR are consecutive R\xe2\x88\x92L+1 numbers in some order. For example, the beauty of the permutation (1,2,5,3,4) equals 9, and segments, corresponding to pairs, are [1], [2], [5], [4], [3], [1,2], [3,4], [5,3,4], [1,2,5,3,4].Answer q independent queries. In each query, you will be given integers n and k. Determine if there exists a permutation of numbers from 1 to n with beauty equal to k, and if there exists, output one of them." "constructive algorithms,math" 3400
542F Quest "Polycarp is making a quest for his friends. He has already made n tasks, for each task the boy evaluated how interesting it is as an integer qi, and the time ti in minutes needed to complete the task. An interesting feature of his quest is: each participant should get the task that is best suited for him, depending on his preferences. The task is chosen based on an interactive quiz that consists of some questions. The player should answer these questions with ""yes"" or ""no"". Depending on the answer to the question, the participant either moves to another question or goes to one of the tasks that are in the quest. In other words, the quest is a binary tree, its nodes contain questions and its leaves contain tasks. We know that answering any of the questions that are asked before getting a task takes exactly one minute from the quest player. Polycarp knows that his friends are busy people and they can\'t participate in the quest for more than T minutes. Polycarp wants to choose some of the n tasks he made, invent the corresponding set of questions for them and use them to form an interactive quiz as a binary tree so that no matter how the player answers quiz questions, he spends at most T minutes on completing the whole quest (that is, answering all the questions and completing the task). Specifically, the quest can contain zero questions and go straight to the task. Each task can only be used once (i.e., the people who give different answers to questions should get different tasks).Polycarp wants the total ""interest"" value of the tasks involved in the quest to be as large as possible. Help him determine the maximum possible total interest value of the task considering that the quest should be completed in T minutes at any variant of answering questions." dp,greedy 2100
1714E "Add Modulo 10" "You are given an array of n integers a1,a2,\xe2\x80\xa6,anYou can apply the following operation an arbitrary number of times:   select an index i (1\xe2\x89\xa4i\xe2\x89\xa4n) and replace the value of the element ai with the value ai+(aimod10), where aimod10 is the remainder of the integer dividing ai by 10. For a single index (value i), this operation can be applied multiple times. If the operation is applied repeatedly to the same index, then the current value of ai is taken into account each time. For example, if ai=47 then after the first operation we get ai=47+7=54, and after the second operation we get ai=54+4=58.Check if it is possible to make all array elements equal by applying multiple (possibly zero) operations.For example, you have an array [6,11].   Let\'s apply this operation to the first element of the array. Let\'s replace a1=6 with a1+(a1mod10)=6+(6mod10)=6+6=12. We get the array [12,11].  Then apply this operation to the second element of the array. Let\'s replace a2=11 with a2+(a2mod10)=11+(11mod10)=11+1=12. We get the array [12,12]. Thus, by applying 2 operations, you can make all elements of an array equal." "brute force,math,number theory" 1400
766B "Mahmoud and a Triangle" "Mahmoud has n line segments, the i-th of them has length ai. Ehab challenged him to use exactly 3 line segments to form a non-degenerate triangle. Mahmoud doesn\'t accept challenges unless he is sure he can win, so he asked you to tell him if he should accept the challenge. Given the lengths of the line segments, check if he can choose exactly 3 of them to form a non-degenerate triangle.Mahmoud should use exactly 3 line segments, he can\'t concatenate two line segments or change any length. A non-degenerate triangle is a triangle with positive area." "constructive algorithms,geometry,greedy,math,number theory,sortings" 1000
1983F array-value "You have an array of non-negative integers a1,a2,\xe2\x80\xa6,an.The value of a sub-array of length \xe2\x89\xa52, a[l,r]=[al,al+1,\xe2\x80\xa6,ar] is the minimum value of ai\xe2\x8a\x95aj such that l\xe2\x89\xa4i<j\xe2\x89\xa4r, where \xe2\x8a\x95 is the xor (exclusive-or) operator.You have to find the k-th smallest value over all sub-arrays of length \xe2\x89\xa52." "binary search,bitmasks,data structures,greedy,two pointers" 2500
3D "Least Cost Bracket Sequence" "This is yet another problem on regular bracket sequences.A bracket sequence is called regular, if by inserting ""+"" and ""1"" into it we get a correct mathematical expression. For example, sequences ""(())()"", ""()"" and ""(()(()))"" are regular, while "")("", ""(()"" and ""(()))("" are not. You have a pattern of a bracket sequence that consists of characters ""("", "")"" and ""?"". You have to replace each character ""?"" with a bracket so, that you get a regular bracket sequence.For each character ""?"" the cost of its replacement with ""("" and "")"" is given. Among all the possible variants your should choose the cheapest." greedy 2600
609A "USB Flash Drives" "Sean is trying to save a large file to a USB flash drive. He has n USB flash drives with capacities equal to a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an megabytes. The file size is equal to m megabytes. Find the minimum number of USB flash drives needed to write Sean\'s file, if he can split the file between drives." greedy,implementation,sortings 800
1607A "Linear Keyboard" "You are given a keyboard that consists of 26 keys. The keys are arranged sequentially in one row in a certain order. Each key corresponds to a unique lowercase Latin letter.You have to type the word s on this keyboard. It also consists only of lowercase Latin letters.To type a word, you need to type all its letters consecutively one by one. To type each letter you must position your hand exactly over the corresponding key and press it.Moving the hand between the keys takes time which is equal to the absolute value of the difference between positions of these keys (the keys are numbered from left to right). No time is spent on pressing the keys and on placing your hand over the first letter of the word.For example, consider a keyboard where the letters from \'a\' to \'z\' are arranged in consecutive alphabetical order. The letters \'h\', \'e\', \'l\' and \'o\' then are on the positions 8, 5, 12 and 15, respectively. Therefore, it will take |5\xe2\x88\x928|+|12\xe2\x88\x925|+|12\xe2\x88\x9212|+|15\xe2\x88\x9212|=13 units of time to type the word ""hello"". Determine how long it will take to print the word s." implementation,strings 800
1110E "Magic Stones" "Grigory has n magic stones, conveniently numbered from 1 to n. The charge of the i-th stone is equal to ci.Sometimes Grigory gets bored and selects some inner stone (that is, some stone with index i, where 2\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921), and after that synchronizes it with neighboring stones. After that, the chosen stone loses its own charge, but acquires the charges from neighboring stones. In other words, its charge ci changes to c\xe2\x80\xb2i=ci+1+ci\xe2\x88\x921\xe2\x88\x92ci.Andrew, Grigory\'s friend, also has n stones with charges ti. Grigory is curious, whether there exists a sequence of zero or more synchronization operations, which transforms charges of Grigory\'s stones into charges of corresponding Andrew\'s stones, that is, changes ci into ti for all i?" "constructive algorithms,math,sortings" 2200
554A "Kyoya and Photobooks" "Kyoya Ootori is selling photobooks of the Ouran High School Host Club. He has 26 photos, labeled ""a"" to ""z"", and he has compiled them into a photo booklet with some photos in some order (possibly with some photos being duplicated). A photo booklet can be described as a string of lowercase letters, consisting of the photos in the booklet in order. He now wants to sell some ""special edition"" photobooks, each with one extra photo inserted anywhere in the book. He wants to make as many distinct photobooks as possible, so he can make more money. He asks Haruhi, how many distinct photobooks can he make by inserting one extra photo into the photobook he already has?Please help Haruhi solve this problem." "brute force,math,strings" 900
1415D XOR-gun "Arkady owns a non-decreasing array a1,a2,\xe2\x80\xa6,an. You are jealous of its beauty and want to destroy this property. You have a so-called XOR-gun that you can use one or more times.In one step you can select two consecutive elements of the array, let\'s say x and y, remove them from the array and insert the integer x\xe2\x8a\x95y on their place, where \xe2\x8a\x95 denotes the bitwise XOR operation. Note that the length of the array decreases by one after the operation. You can\'t perform this operation when the length of the array reaches one.For example, if the array is [2,5,6,8], you can select 5 and 6 and replace them with 5\xe2\x8a\x956=3. The array becomes [2,3,8].You want the array no longer be non-decreasing. What is the minimum number of steps needed? If the array stays non-decreasing no matter what you do, print \xe2\x88\x921." "bitmasks,brute force,constructive algorithms" 2000
302B "Eugeny and Play List" "Eugeny loves listening to music. He has n songs in his play list. We know that song number i has the duration of ti minutes. Eugeny listens to each song, perhaps more than once. He listens to song number i ci times. Eugeny\'s play list is organized as follows: first song number 1 plays c1 times, then song number 2 plays c2 times, ..., in the end the song number n plays cn times.Eugeny took a piece of paper and wrote out m moments of time when he liked a song. Now for each such moment he wants to know the number of the song that played at that moment. The moment x means that Eugeny wants to know which song was playing during the x-th minute of his listening to the play list.Help Eugeny and calculate the required numbers of songs." "binary search,implementation,two pointers" 1200
1924F "Anti-Proxy Attendance" "This is an interactive problem!Mr. 1048576 is one of those faculty who hates wasting his time in taking class attendance. Instead of taking attendance the old-fashioned way, he decided to try out something new today.There are n students in his class, having roll numbers 1 to n. He knows that exactly 1 student is absent today. In order to determine who is absent, he can ask some queries to the class. In each query, he can provide two integers l and r (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n) and all students whose roll numbers are between l and r (inclusive) will raise their hands. He then counts them to determine if the roll number of the absent student lies between these values.Things seemed fine until his teaching assistant noticed something \xe2\x80\x94 the students are dishonest! Some students whose roll numbers lie in the given range may not raise their hands, while some other students whose roll number does not lie in the given range may raise their hands. But the students don\'t want to raise much suspicion. So, only the following 4 cases are possible for a particular query (l,r) \xe2\x80\x94   True Positive: r\xe2\x88\x92l+1 students are present and r\xe2\x88\x92l+1 students raised their hands.  True Negative: r\xe2\x88\x92l students are present and r\xe2\x88\x92l students raised their hands.  False Positive: r\xe2\x88\x92l students are present but r\xe2\x88\x92l+1 students raised their hands.  False Negative: r\xe2\x88\x92l+1 students are present but r\xe2\x88\x92l students raised their hands. In the first two cases, the students are said to be answering honestly, while in the last two cases, the students are said to be answering dishonestly. The students can mutually decide upon their strategy, not known to Mr. 1048576. Also, the students do not want to raise any suspicion and at the same time, want to create a lot of confusion. So, their strategy always meets the following two conditions \xe2\x80\x94   The students will never answer honestly 3 times in a row.  The students will never answer dishonestly 3 times in a row. Mr. 1048576 is frustrated by this act of students. So, he is willing to mark at most 2 students as absent (though he knows that only one is). The attendance is said to be successful if the student who is actually absent is among those two. Also, due to limited class time, he can only ask up to \xe2\x8c\x88log1.116n\xe2\x8c\x89\xe2\x88\x921 queries (weird numbers but okay). Help him complete a successful attendance." "constructive algorithms,dp,interactive,ternary search" 3500
650E "Clockwork Bomb" "My name is James diGriz, I\'m the most clever robber and treasure hunter in the whole galaxy. There are books written about my adventures and songs about my operations, though you were able to catch me up in a pretty awkward moment.I was able to hide from cameras, outsmart all the guards and pass numerous traps, but when I finally reached the treasure box and opened it, I have accidentally started the clockwork bomb! Luckily, I have met such kind of bombs before and I know that the clockwork mechanism can be stopped by connecting contacts with wires on the control panel of the bomb in a certain manner.I see n contacts connected by n\xe2\x80\x89-\xe2\x80\x891 wires. Contacts are numbered with integers from 1 to n. Bomb has a security mechanism that ensures the following condition: if there exist k\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x892 contacts c1,\xe2\x80\x89c2,\xe2\x80\x89...,\xe2\x80\x89ck forming a circuit, i. e. there exist k distinct wires between contacts c1 and c2, c2 and c3, ..., ck and c1, then the bomb immediately explodes and my story ends here. In particular, if two contacts are connected by more than one wire they form a circuit of length 2. It is also prohibited to connect a contact with itself.On the other hand, if I disconnect more than one wire (i. e. at some moment there will be no more than n\xe2\x80\x89-\xe2\x80\x892 wires in the scheme) then the other security check fails and the bomb also explodes. So, the only thing I can do is to unplug some wire and plug it into a new place ensuring the fact that no circuits appear.I know how I should put the wires in order to stop the clockwork. But my time is running out! Help me get out of this alive: find the sequence of operations each of which consists of unplugging some wire and putting it into another place so that the bomb is defused." "data structures,dfs and similar,dsu,greedy,trees" 3200
1585B "Array Eversion" "You are given an array a of length n.Let\'s define the eversion operation. Let x=an. Then array a is partitioned into two parts: left and right. The left part contains the elements of a that are not greater than x (\xe2\x89\xa4x). The right part contains the elements of a that are strictly greater than x (>x). The order of elements in each part is kept the same as before the operation, i. e. the partition is stable. Then the array is replaced with the concatenation of the left and the right parts.For example, if the array a is [2,4,1,5,3], the eversion goes like this: [2,4,1,5,3]\xe2\x86\x92[2,1,3],[4,5]\xe2\x86\x92[2,1,3,4,5].We start with the array a and perform eversions on this array. We can prove that after several eversions the array a stops changing. Output the minimum number k such that the array stops changing after k eversions." greedy 900
2014A "Robin Helps" "There is a little bit of the outlaw in everyone, and a little bit of the hero too.The heroic outlaw Robin Hood is famous for taking from the rich and giving to the poor.Robin encounters n people starting from the 1-st and ending with the n-th. The i-th person has ai gold. If ai\xe2\x89\xa5k, Robin will take all ai gold, and if ai=0, Robin will give 1 gold if he has any. Robin starts with 0 gold.Find out how many people Robin gives gold to." greedy,implementation 800
696D Legen... "Barney was hanging out with Nora for a while and now he thinks he may have feelings for her. Barney wants to send her a cheesy text message and wants to make her as happy as possible.  Initially, happiness level of Nora is 0. Nora loves some pickup lines like ""I\'m falling for you"" and stuff. Totally, she knows n pickup lines, each consisting only of lowercase English letters, also some of them may be equal (in writing, but different in pronouncing or meaning though). Every time Nora sees i-th pickup line as a consecutive subsequence of Barney\'s text message her happiness level increases by ai. These substrings may overlap, for example, Nora will see the pickup line aa twice and the pickup line ab once in text message aaab.Due to texting app limits, Barney\'s text may have up to l characters.Barney asked you to help him make Nora as much happy as possible, it\'s gonna be legen..." "data structures,dp,matrices,strings" 2500
702F T-Shirts "The big consignment of t-shirts goes on sale in the shop before the beginning of the spring. In all n types of t-shirts go on sale. The t-shirt of the i-th type has two integer parameters \xe2\x80\x94 ci and qi, where ci \xe2\x80\x94 is the price of the i-th type t-shirt, qi \xe2\x80\x94 is the quality of the i-th type t-shirt. It should be assumed that the unlimited number of t-shirts of each type goes on sale in the shop, but in general the quality is not concerned with the price. As predicted, k customers will come to the shop within the next month, the j-th customer will get ready to spend up to bj on buying t-shirts. All customers have the same strategy. First of all, the customer wants to buy the maximum possible number of the highest quality t-shirts, then to buy the maximum possible number of the highest quality t-shirts from residuary t-shirts and so on. At the same time among several same quality t-shirts the customer will buy one that is cheaper. The customers don\'t like the same t-shirts, so each customer will not buy more than one t-shirt of one type. Determine the number of t-shirts which each customer will buy, if they use the described strategy. All customers act independently from each other, and the purchase of one does not affect the purchase of another." "data structures" 2800
207A1 "Beaver\'s Calculator 1.0" "The Smart Beaver from ABBYY has once again surprised us! He has developed a new calculating device, which he called the ""Beaver\'s Calculator 1.0"". It is very peculiar and it is planned to be used in a variety of scientific problems.To test it, the Smart Beaver invited n scientists, numbered from 1 to n. The i-th scientist brought ki calculating problems for the device developed by the Smart Beaver from ABBYY. The problems of the i-th scientist are numbered from 1 to ki, and they must be calculated sequentially in the described order, since calculating each problem heavily depends on the results of calculating of the previous ones.Each problem of each of the n scientists is described by one integer ai,\xe2\x80\x89j, where i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) is the number of the scientist, j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ki) is the number of the problem, and ai,\xe2\x80\x89j is the number of resource units the calculating device needs to solve this problem.The calculating device that is developed by the Smart Beaver is pretty unusual. It solves problems sequentially, one after another. After some problem is solved and before the next one is considered, the calculating device allocates or frees resources.The most expensive operation for the calculating device is freeing resources, which works much slower than allocating them. It is therefore desirable that each next problem for the calculating device requires no less resources than the previous one.You are given the information about the problems the scientists offered for the testing. You need to arrange these problems in such an order that the number of adjacent ""bad"" pairs of problems in this list is minimum possible. We will call two consecutive problems in this list a ""bad pair"" if the problem that is performed first requires more resources than the one that goes after it. Do not forget that the problems of the same scientist must be solved in a fixed order." greedy 1600
1088E "Ehab and a component choosing problem" "You\'re given a tree consisting of n nodes. Every node u has a weight au. You want to choose an integer k (1\xe2\x89\xa4k\xe2\x89\xa4n) and then choose k connected components of nodes that don\'t overlap (i.e every node is in at most 1 component). Let the set of nodes you chose be s. You want to maximize:\xe2\x88\x91u\xe2\x88\x88saukIn other words, you want to maximize the sum of weights of nodes in s divided by the number of connected components you chose. Also, if there are several solutions, you want to maximize k.Note that adjacent nodes can belong to different components. Refer to the third sample." dp,greedy,math,trees 2400
1189C Candies! "Consider a sequence of digits of length 2k [a1,a2,\xe2\x80\xa6,a2k]. We perform the following operation with it: replace pairs (a2i+1,a2i+2) with (a2i+1+a2i+2)mod10 for 0\xe2\x89\xa4i<2k\xe2\x88\x921. For every i where a2i+1+a2i+2\xe2\x89\xa510 we get a candy! As a result, we will get a sequence of length 2k\xe2\x88\x921.Less formally, we partition sequence of length 2k into 2k\xe2\x88\x921 pairs, each consisting of 2 numbers: the first pair consists of the first and second numbers, the second of the third and fourth \xe2\x80\xa6, the last pair consists of the (2k\xe2\x88\x921)-th and (2k)-th numbers. For every pair such that sum of numbers in it is at least 10, we get a candy. After that, we replace every pair of numbers with a remainder of the division of their sum by 10 (and don\'t change the order of the numbers).Perform this operation with a resulting array until it becomes of length 1. Let f([a1,a2,\xe2\x80\xa6,a2k]) denote the number of candies we get in this process. For example: if the starting sequence is [8,7,3,1,7,0,9,4] then:After the first operation the sequence becomes [(8+7)mod10,(3+1)mod10,(7+0)mod10,(9+4)mod10] = [5,4,7,3], and we get 2 candies as 8+7\xe2\x89\xa510 and 9+4\xe2\x89\xa510.After the second operation the sequence becomes [(5+4)mod10,(7+3)mod10] = [9,0], and we get one more candy as 7+3\xe2\x89\xa510. After the final operation sequence becomes [(9+0)mod10] = [9]. Therefore, f([8,7,3,1,7,0,9,4])=3 as we got 3 candies in total.You are given a sequence of digits of length n s1,s2,\xe2\x80\xa6sn. You have to answer q queries of the form (li,ri), where for i-th query you have to output f([sli,sli+1,\xe2\x80\xa6,sri]). It is guaranteed that ri\xe2\x88\x92li+1 is of form 2k for some nonnegative integer k." "data structures,dp,implementation,math" 1400
1918G "Permutation of Given" "You were given only one number, n. It didn\'t seem interesting to you, so you wondered if it\'s possible to come up with an array of length n consisting of non-zero integers, such that if each element of the array is replaced by the sum of its neighbors (the elements on the ends are replaced by their only neighbors), you obtain a permutation of the numbers in the original array." "constructive algorithms,math" 2700
1913B "Swap and Delete" "You are given a binary string s (a string consisting only of 0-s and 1-s).You can perform two types of operations on s:   delete one character from s. This operation costs 1 coin;  swap any pair of characters in s. This operation is free (costs 0 coins). You can perform these operations any number of times and in any order.Let\'s name a string you\'ve got after performing operations above as t. The string t is good if for each i from 1 to |t| ti\xe2\x89\xa0si (|t| is the length of the string t). The empty string is always good. Note that you are comparing the resulting string t with the initial string s.What is the minimum total cost to make the string t good?" strings 1000
867A "Between the Offices" "As you may know, MemSQL has American offices in both San Francisco and Seattle. Being a manager in the company, you travel a lot between the two cities, always by plane.You prefer flying from Seattle to San Francisco than in the other direction, because it\'s warmer in San Francisco. You are so busy that you don\'t remember the number of flights you have made in either direction. However, for each of the last n days you know whether you were in San Francisco office or in Seattle office. You always fly at nights, so you never were at both offices on the same day. Given this information, determine if you flew more times from Seattle to San Francisco during the last n days, or not." implementation 800
1761A "Two Permutations" "You are given three integers n, a, and b. Determine if there exist two permutations p and q of length n, for which the following conditions hold:  The length of the longest common prefix of p and q is a.  The length of the longest common suffix of p and q is b. A permutation of length n is an array containing each integer from 1 to n exactly once. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array), and [1,3,4] is also not a permutation (n=3 but there is 4 in the array)." "brute force,constructive algorithms" 800
1365F "Swaps Again" "Ayush, Ashish and Vivek are busy preparing a new problem for the next Codeforces round and need help checking if their test cases are valid.Each test case consists of an integer n and two arrays a and b, of size n. If after some (possibly zero) operations described below, array a can be transformed into array b, the input is said to be valid. Otherwise, it is invalid.An operation on array a is:   select an integer k (1\xe2\x89\xa4k\xe2\x89\xa4\xe2\x8c\x8an2\xe2\x8c\x8b)  swap the prefix of length k with the suffix of length k For example, if array a initially is {1,2,3,4,5,6}, after performing an operation with k=2, it is transformed into {5,6,3,4,1,2}.Given the set of test cases, help them determine if each one is valid or invalid." "constructive algorithms,implementation,sortings" 2100
1859F "Teleportation in Byteland" "There are n cities in Byteland, some of which are connected by roads, which can be traversed in any direction. The i-th road has its own hardness parameter wi. Time spent on traversing a road with its hardness equal to wi is \xe2\x8c\x88wic\xe2\x8c\x89, where c is the current driving skill.The travel network of Byteland is a tree. In other words, between any pair of cities, there is exactly one path that passes through each city at most once.In some cities you can visit driving courses. A single course takes T time to complete, and after completing the course the driver\'s skill c is increased by 2 times. Notice that the time T required to complete a course is the same in all cities, and courses can be completed in the same city more than once.You need to answer the q queries: what is the minimum time it takes to get from the city a to city b if you start the travelling with driving skill c=1?" "data structures,dfs and similar,divide and conquer,graphs,shortest paths,trees" 3200
1771A "Hossam and Combinatorics" "Hossam woke up bored, so he decided to create an interesting array with his friend Hazem.Now, they have an array a of n positive integers, Hossam will choose a number ai and Hazem will choose a number aj.Count the number of interesting pairs (ai,aj) that meet all the following conditions: 1\xe2\x89\xa4i,j\xe2\x89\xa4n; i\xe2\x89\xa0j; The absolute difference |ai\xe2\x88\x92aj| must be equal to the maximum absolute difference over all the pairs in the array. More formally, |ai\xe2\x88\x92aj|=max1\xe2\x89\xa4p,q\xe2\x89\xa4n|ap\xe2\x88\x92aq|." combinatorics,math,sortings 900
1805C "Place for a Selfie" "The universe is a coordinate plane. There are n space highways, each of which is a straight line y=kx passing through the origin (0,0). Also, there are m asteroid belts on the plane, which we represent as open upwards parabolas, i. e. graphs of functions y=ax2+bx+c, where a>0.You want to photograph each parabola. To do this, for each parabola you need to choose a line that does not intersect this parabola and does not touch it. You can select the same line for different parabolas. Please find such a line for each parabola, or determine that there is no such line." "binary search,data structures,geometry,math" 1400
1398F "Controversial Rounds" "Alice and Bob play a game. The game consists of several sets, and each set consists of several rounds. Each round is won either by Alice or by Bob, and the set ends when one of the players has won x rounds in a row. For example, if Bob won five rounds in a row and x=2, then two sets ends.You know that Alice and Bob have already played n rounds, and you know the results of some rounds. For each x from 1 to n, calculate the maximum possible number of sets that could have already finished if each set lasts until one of the players wins x rounds in a row. It is possible that the last set is still not finished \xe2\x80\x94 in that case, you should not count it in the answer." "binary search,data structures,dp,greedy,two pointers" 2500
156E "Mrs. Hudson\'s Pancakes" "Mrs. Hudson hasn\'t made her famous pancakes for quite a while and finally she decided to make them again. She has learned m new recipes recently and she can\'t wait to try them. Those recipes are based on n special spices. Mrs. Hudson has these spices in the kitchen lying in jars numbered with integers from 0 to n\xe2\x80\x89-\xe2\x80\x891 (each spice lies in an individual jar). Each jar also has the price of the corresponding spice inscribed \xe2\x80\x94 some integer ai.We know three values for the i-th pancake recipe: di, si, ci. Here di and ci are integers, and si is the pattern of some integer written in the numeral system with radix di. The pattern contains digits, Latin letters (to denote digits larger than nine) and question marks. Number x in the di-base numeral system matches the pattern si, if we can replace question marks in the pattern with digits and letters so that we obtain number x (leading zeroes aren\'t taken into consideration when performing the comparison). More formally: each question mark should be replaced by exactly one digit or exactly one letter. If after we replace all question marks we get a number with leading zeroes, we can delete these zeroes. For example, number 40A9875 in the 11-base numeral system matches the pattern ""??4??987?"", and number 4A9875 does not.To make the pancakes by the i-th recipe, Mrs. Hudson should take all jars with numbers whose representation in the di-base numeral system matches the pattern si. The control number of the recipe (zi) is defined as the sum of number ci and the product of prices of all taken jars. More formally:  (where j is all such numbers whose representation in the di-base numeral system matches the pattern si).Mrs. Hudson isn\'t as interested in the control numbers as she is in their minimum prime divisors. Your task is: for each recipe i find the minimum prime divisor of number zi. If this divisor exceeds 100, then you do not have to find it, print -1." "brute force,dp" 3000
1204D1 "Kirk and a Binary String (easy version)" "The only difference between easy and hard versions is the length of the string. You can hack this problem only if you solve both problems.Kirk has a binary string s (a string which consists of zeroes and ones) of length n and he is asking you to find a binary string t of the same length which satisfies the following conditions: For any l and r (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n) the length of the longest non-decreasing subsequence of the substring slsl+1\xe2\x80\xa6sr is equal to the length of the longest non-decreasing subsequence of the substring tltl+1\xe2\x80\xa6tr; The number of zeroes in t is the maximum possible.A non-decreasing subsequence of a string p is a sequence of indices i1,i2,\xe2\x80\xa6,ik such that i1<i2<\xe2\x80\xa6<ik and pi1\xe2\x89\xa4pi2\xe2\x89\xa4\xe2\x80\xa6\xe2\x89\xa4pik. The length of the subsequence is k.If there are multiple substrings which satisfy the conditions, output any." "brute force,greedy,strings" 2000
1617E "Christmas Chocolates" "Christmas is coming, Icy has just received a box of chocolates from her grandparents! The box contains n chocolates. The i-th chocolate has a non-negative integer type ai.Icy believes that good things come in pairs. Unfortunately, all types of chocolates are distinct (all ai are distinct). Icy wants to make at least one pair of chocolates the same type. As a result, she asks her grandparents to perform some chocolate exchanges. Before performing any chocolate exchanges, Icy chooses two chocolates with indices x and y (1\xe2\x89\xa4x,y\xe2\x89\xa4n, x\xe2\x89\xa0y).In a chocolate exchange, Icy\'s grandparents choose a non-negative integer k, such that 2k\xe2\x89\xa5ax, and change the type of the chocolate x from ax to 2k\xe2\x88\x92ax (that is, perform ax:=2k\xe2\x88\x92ax).The chocolate exchanges will be stopped only when ax=ay. Note that other pairs of equal chocolate types do not stop the procedure.Icy\'s grandparents are smart, so they would choose the sequence of chocolate exchanges that minimizes the number of exchanges needed. Since Icy likes causing trouble, she wants to maximize the minimum number of exchanges needed by choosing x and y appropriately. She wonders what is the optimal pair (x,y) such that the minimum number of exchanges needed is maximized across all possible choices of (x,y).Since Icy is not good at math, she hopes that you can help her solve the problem." "dfs and similar,dp,games,graphs,implementation,math,number theory,shortest paths,trees" 2700
1769D1 "\xd0\x98\xd0\xb3\xd1\x80\xd0\xb0 \xd0\xb2 \xd0\x94\xd0\xb5\xd0\xb2\xd1\x8f\xd1\x82\xd0\xba\xd1\x83 I" "\xd0\x92 \xd1\x8d\xd1\x82\xd0\xbe\xd0\xb9 \xd0\xb2\xd0\xb5\xd1\x80\xd1\x81\xd0\xb8\xd0\xb8 \xd0\xb7\xd0\xb0\xd0\xb4\xd0\xb0\xd1\x87\xd0\xb8 \xd0\xbd\xd1\x83\xd0\xb6\xd0\xbd\xd0\xbe \xd0\xbe\xd0\xbf\xd1\x80\xd0\xb5\xd0\xb4\xd0\xb5\xd0\xbb\xd0\xb8\xd1\x82\xd1\x8c, \xd0\xba\xd1\x82\xd0\xbe \xd0\xb2\xd1\x8b\xd0\xb8\xd0\xb3\xd1\x80\xd0\xb0\xd0\xb5\xd1\x82 \xd0\xb2 \xd0\xba\xd0\xb0\xd1\x80\xd1\x82\xd0\xbe\xd1\x87\xd0\xbd\xd0\xbe\xd0\xb9 \xd0\xb8\xd0\xb3\xd1\x80\xd0\xb5 \xd0\xb4\xd0\xbb\xd1\x8f \xd0\xb4\xd0\xb2\xd1\x83\xd1\x85 \xd0\xb8\xd0\xb3\xd1\x80\xd0\xbe\xd0\xba\xd0\xbe\xd0\xb2 \xd0\xb2 \xd0\xb7\xd0\xb0\xd0\xb4\xd0\xb0\xd0\xbd\xd0\xbd\xd0\xbe\xd0\xbc \xd1\x80\xd0\xb0\xd1\x81\xd0\xba\xd0\xbb\xd0\xb0\xd0\xb4\xd0\xb5 \xd0\xbf\xd1\x80\xd0\xb8 \xd0\xbe\xd0\xbf\xd1\x82\xd0\xb8\xd0\xbc\xd0\xb0\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe\xd0\xb9 \xd0\xb8\xd0\xb3\xd1\x80\xd0\xb5 \xd0\xbe\xd0\xb1\xd0\xbe\xd0\xb8\xd1\x85 \xd1\x81\xd0\xbe\xd0\xbf\xd0\xb5\xd1\x80\xd0\xbd\xd0\xb8\xd0\xba\xd0\xbe\xd0\xb2.\xd0\x90\xd0\xbb\xd0\xb8\xd1\x81\xd0\xb0 \xd0\xb8 \xd0\x91\xd0\xbe\xd0\xb1 \xd1\x80\xd0\xb5\xd1\x88\xd0\xb8\xd0\xbb\xd0\xb8 \xd1\x81\xd1\x8b\xd0\xb3\xd1\x80\xd0\xb0\xd1\x82\xd1\x8c \xd0\xb2 \xd0\xba\xd0\xb0\xd1\x80\xd1\x82\xd0\xbe\xd1\x87\xd0\xbd\xd1\x83\xd1\x8e \xd0\xb8\xd0\xb3\xd1\x80\xd1\x83 \xc2\xab\xd0\x94\xd0\xb5\xd0\xb2\xd1\x8f\xd1\x82\xd0\xba\xd0\xb0\xc2\xbb. \xd0\x9f\xd0\xbe\xd0\xb6\xd0\xb0\xd0\xbb\xd1\x83\xd0\xb9\xd1\x81\xd1\x82\xd0\xb0, \xd0\xb2\xd0\xbd\xd0\xb8\xd0\xbc\xd0\xb0\xd1\x82\xd0\xb5\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe \xd0\xbf\xd1\x80\xd0\xbe\xd1\x87\xd0\xb8\xd1\x82\xd0\xb0\xd0\xb9\xd1\x82\xd0\xb5 \xd1\x83\xd1\x81\xd0\xbb\xd0\xbe\xd0\xb2\xd0\xb8\xd0\xb5 \xd0\xb7\xd0\xb0\xd0\xb4\xd0\xb0\xd1\x87\xd0\xb8, \xd0\xbf\xd0\xbe\xd1\x81\xd0\xba\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xba\xd1\x83 \xd0\xbf\xd1\x80\xd0\xb0\xd0\xb2\xd0\xb8\xd0\xbb\xd0\xb0 \xd0\xbc\xd0\xbe\xd0\xb3\xd1\x83\xd1\x82 \xd0\xbe\xd1\x82\xd0\xbb\xd0\xb8\xd1\x87\xd0\xb0\xd1\x82\xd1\x8c\xd1\x81\xd1\x8f \xd0\xbe\xd1\x82 \xd0\xb8\xd0\xb7\xd0\xb2\xd0\xb5\xd1\x81\xd1\x82\xd0\xbd\xd1\x8b\xd1\x85 \xd0\xb2\xd0\xb0\xd0\xbc.\xd0\x94\xd0\xbb\xd1\x8f \xd0\xb8\xd0\xb3\xd1\x80\xd1\x8b \xd0\xbd\xd1\x83\xd0\xb6\xd0\xbd\xd0\xb0 \xd1\x81\xd1\x82\xd0\xb0\xd0\xbd\xd0\xb4\xd0\xb0\xd1\x80\xd1\x82\xd0\xbd\xd0\xb0\xd1\x8f \xd0\xba\xd0\xbe\xd0\xbb\xd0\xbe\xd0\xb4\xd0\xb0 \xd0\xb8\xd0\xb7 36 \xd0\xba\xd0\xb0\xd1\x80\xd1\x82 \xe2\x80\x94 \xd0\xbf\xd0\xbe \xd0\xb4\xd0\xb5\xd0\xb2\xd1\x8f\xd1\x82\xd1\x8c \xd0\xba\xd0\xb0\xd1\x80\xd1\x82 (\xd0\xbe\xd1\x82 \xd1\x88\xd0\xb5\xd1\x81\xd1\x82\xd1\x91\xd1\x80\xd0\xba\xd0\xb8 \xd0\xb4\xd0\xbe \xd1\x82\xd1\x83\xd0\xb7\xd0\xb0) \xd0\xba\xd0\xb0\xd0\xb6\xd0\xb4\xd0\xbe\xd0\xb9 \xd0\xb8\xd0\xb7 \xd1\x87\xd0\xb5\xd1\x82\xd1\x8b\xd1\x80\xd1\x91\xd1\x85 \xd0\xbc\xd0\xb0\xd1\x81\xd1\x82\xd0\xb5\xd0\xb9 (\xd1\x82\xd1\x80\xd0\xb5\xd1\x84\xd1\x8b, \xd0\xb1\xd1\x83\xd0\xb1\xd0\xbd\xd1\x8b, \xd0\xbf\xd0\xb8\xd0\xba\xd0\xb8 \xd0\xb8 \xd1\x87\xd0\xb5\xd1\x80\xd0\xb2\xd0\xb8). \xd0\x9a\xd0\xb0\xd1\x80\xd1\x82\xd1\x8b \xd0\xbf\xd0\xbe \xd0\xb4\xd0\xbe\xd1\x81\xd1\x82\xd0\xbe\xd0\xb8\xd0\xbd\xd1\x81\xd1\x82\xd0\xb2\xd1\x83 \xd0\xbe\xd1\x82 \xd0\xbc\xd0\xbb\xd0\xb0\xd0\xb4\xd1\x88\xd0\xb5\xd0\xb9 \xd0\xba \xd1\x81\xd1\x82\xd0\xb0\xd1\x80\xd1\x88\xd0\xb5\xd0\xb9 \xd0\xb8\xd0\xb4\xd1\x83\xd1\x82 \xd1\x81\xd0\xbb\xd0\xb5\xd0\xb4\xd1\x83\xd1\x8e\xd1\x89\xd0\xb8\xd0\xbc \xd0\xbe\xd0\xb1\xd1\x80\xd0\xb0\xd0\xb7\xd0\xbe\xd0\xbc: \xd1\x88\xd0\xb5\xd1\x81\xd1\x82\xd1\x91\xd1\x80\xd0\xba\xd0\xb0, \xd1\x81\xd0\xb5\xd0\xbc\xd1\x91\xd1\x80\xd0\xba\xd0\xb0, \xd0\xb2\xd0\xbe\xd1\x81\xd1\x8c\xd0\xbc\xd1\x91\xd1\x80\xd0\xba\xd0\xb0, \xd0\xb4\xd0\xb5\xd0\xb2\xd1\x8f\xd1\x82\xd0\xba\xd0\xb0, \xd0\xb4\xd0\xb5\xd1\x81\xd1\x8f\xd1\x82\xd0\xba\xd0\xb0, \xd0\xb2\xd0\xb0\xd0\xbb\xd0\xb5\xd1\x82, \xd0\xb4\xd0\xb0\xd0\xbc\xd0\xb0, \xd0\xba\xd0\xbe\xd1\x80\xd0\xbe\xd0\xbb\xd1\x8c, \xd1\x82\xd1\x83\xd0\xb7.\xd0\x9f\xd0\xb5\xd1\x80\xd0\xb5\xd0\xb4 \xd0\xb8\xd0\xb3\xd1\x80\xd0\xbe\xd0\xb9 \xd0\xba\xd0\xbe\xd0\xbb\xd0\xbe\xd0\xb4\xd0\xb0 \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb5\xd0\xbc\xd0\xb5\xd1\x88\xd0\xb8\xd0\xb2\xd0\xb0\xd0\xb5\xd1\x82\xd1\x81\xd1\x8f, \xd0\xb8 \xd0\xba\xd0\xb0\xd0\xb6\xd0\xb4\xd0\xbe\xd0\xbc\xd1\x83 \xd0\xb8\xd0\xb3\xd1\x80\xd0\xbe\xd0\xba\xd1\x83 \xd1\x80\xd0\xb0\xd0\xb7\xd0\xb4\xd0\xb0\xd1\x91\xd1\x82\xd1\x81\xd1\x8f \xd0\xbf\xd0\xbe 18 \xd0\xba\xd0\xb0\xd1\x80\xd1\x82. \xd0\x9a\xd0\xb0\xd1\x80\xd1\x82\xd1\x8b \xd0\xbd\xd1\x83\xd0\xb6\xd0\xbd\xd0\xbe \xd0\xb2\xd1\x8b\xd0\xba\xd0\xbb\xd0\xb0\xd0\xb4\xd1\x8b\xd0\xb2\xd0\xb0\xd1\x82\xd1\x8c \xd0\xb8\xd0\xb7 \xd1\x80\xd1\x83\xd0\xba\xd0\xb8 \xd0\xbd\xd0\xb0 \xd1\x81\xd1\x82\xd0\xbe\xd0\xbb \xd0\xbf\xd0\xbe \xd0\xbe\xd0\xbf\xd1\x80\xd0\xb5\xd0\xb4\xd0\xb5\xd0\xbb\xd1\x91\xd0\xbd\xd0\xbd\xd1\x8b\xd0\xbc \xd0\xbf\xd1\x80\xd0\xb0\xd0\xb2\xd0\xb8\xd0\xbb\xd0\xb0\xd0\xbc. \xd0\x92\xd1\x8b\xd0\xb8\xd0\xb3\xd1\x80\xd1\x8b\xd0\xb2\xd0\xb0\xd0\xb5\xd1\x82 \xd0\xb8\xd0\xb3\xd1\x80\xd0\xbe\xd0\xba, \xd0\xba\xd0\xbe\xd1\x82\xd0\xbe\xd1\x80\xd1\x8b\xd0\xb9 \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb2\xd1\x8b\xd0\xbc \xd0\xb2\xd1\x8b\xd0\xbb\xd0\xbe\xd0\xb6\xd0\xb8\xd1\x82 \xd0\xb2\xd1\x81\xd0\xb5 \xd0\xba\xd0\xb0\xd1\x80\xd1\x82\xd1\x8b \xd0\xb8\xd0\xb7 \xd1\x81\xd0\xb2\xd0\xbe\xd0\xb5\xd0\xb9 \xd1\x80\xd1\x83\xd0\xba\xd0\xb8.\xd0\x98\xd0\xb3\xd1\x80\xd0\xbe\xd0\xba\xd0\xb8 \xd1\x85\xd0\xbe\xd0\xb4\xd1\x8f\xd1\x82 \xd0\xbf\xd0\xbe \xd0\xbe\xd1\x87\xd0\xb5\xd1\x80\xd0\xb5\xd0\xb4\xd0\xb8. \xd0\xa5\xd0\xbe\xd0\xb4 \xd0\xb8\xd0\xb3\xd1\x80\xd0\xbe\xd0\xba\xd0\xb0 \xd0\xb8\xd0\xbc\xd0\xb5\xd0\xb5\xd1\x82 \xd0\xbe\xd0\xb4\xd0\xb8\xd0\xbd \xd0\xb8\xd0\xb7 \xd1\x81\xd0\xbb\xd0\xb5\xd0\xb4\xd1\x83\xd1\x8e\xd1\x89\xd0\xb8\xd1\x85 \xd0\xb2\xd0\xb8\xd0\xb4\xd0\xbe\xd0\xb2:   \xd0\xb2\xd1\x8b\xd0\xbb\xd0\xbe\xd0\xb6\xd0\xb8\xd1\x82\xd1\x8c \xd0\xbd\xd0\xb0 \xd1\x81\xd1\x82\xd0\xbe\xd0\xbb \xd0\xb8\xd0\xb7 \xd1\x81\xd0\xb2\xd0\xbe\xd0\xb5\xd0\xb9 \xd1\x80\xd1\x83\xd0\xba\xd0\xb8 \xd0\xb4\xd0\xb5\xd0\xb2\xd1\x8f\xd1\x82\xd0\xba\xd1\x83 \xd0\xbb\xd1\x8e\xd0\xb1\xd0\xbe\xd0\xb9 \xd0\xbc\xd0\xb0\xd1\x81\xd1\x82\xd0\xb8;  \xd0\xb2\xd1\x8b\xd0\xbb\xd0\xbe\xd0\xb6\xd0\xb8\xd1\x82\xd1\x8c \xd0\xbd\xd0\xb0 \xd1\x81\xd1\x82\xd0\xbe\xd0\xbb \xd1\x88\xd0\xb5\xd1\x81\xd1\x82\xd1\x91\xd1\x80\xd0\xba\xd1\x83, \xd1\x81\xd0\xb5\xd0\xbc\xd1\x91\xd1\x80\xd0\xba\xd1\x83 \xd0\xb8\xd0\xbb\xd0\xb8 \xd0\xb2\xd0\xbe\xd1\x81\xd1\x8c\xd0\xbc\xd1\x91\xd1\x80\xd0\xba\xd1\x83 \xd0\xbb\xd1\x8e\xd0\xb1\xd0\xbe\xd0\xb9 \xd0\xbc\xd0\xb0\xd1\x81\xd1\x82\xd0\xb8, \xd0\xb5\xd1\x81\xd0\xbb\xd0\xb8 \xd0\xbd\xd0\xb0 \xd1\x81\xd1\x82\xd0\xbe\xd0\xbb\xd0\xb5 \xd1\x83\xd0\xb6\xd0\xb5 \xd0\xbb\xd0\xb5\xd0\xb6\xd0\xb8\xd1\x82 \xd0\xba\xd0\xb0\xd1\x80\xd1\x82\xd0\xb0 \xd1\x82\xd0\xbe\xd0\xb9 \xd0\xb6\xd0\xb5 \xd0\xbc\xd0\xb0\xd1\x81\xd1\x82\xd0\xb8 \xd0\xb4\xd0\xbe\xd1\x81\xd1\x82\xd0\xbe\xd0\xb8\xd0\xbd\xd1\x81\xd1\x82\xd0\xb2\xd0\xbe\xd0\xbc \xd0\xbd\xd0\xb0 \xd0\xb5\xd0\xb4\xd0\xb8\xd0\xbd\xd0\xb8\xd1\x86\xd1\x83 \xd0\xb2\xd1\x8b\xd1\x88\xd0\xb5;  \xd0\xb2\xd1\x8b\xd0\xbb\xd0\xbe\xd0\xb6\xd0\xb8\xd1\x82\xd1\x8c \xd0\xbd\xd0\xb0 \xd1\x81\xd1\x82\xd0\xbe\xd0\xbb \xd0\xb4\xd0\xb5\xd1\x81\xd1\x8f\xd1\x82\xd0\xba\xd1\x83, \xd0\xb2\xd0\xb0\xd0\xbb\xd0\xb5\xd1\x82\xd0\xb0, \xd0\xb4\xd0\xb0\xd0\xbc\xd1\x83, \xd0\xba\xd0\xbe\xd1\x80\xd0\xbe\xd0\xbb\xd1\x8f \xd0\xb8\xd0\xbb\xd0\xb8 \xd1\x82\xd1\x83\xd0\xb7\xd0\xb0 \xd0\xbb\xd1\x8e\xd0\xb1\xd0\xbe\xd0\xb9 \xd0\xbc\xd0\xb0\xd1\x81\xd1\x82\xd0\xb8, \xd0\xb5\xd1\x81\xd0\xbb\xd0\xb8 \xd0\xbd\xd0\xb0 \xd1\x81\xd1\x82\xd0\xbe\xd0\xbb\xd0\xb5 \xd1\x83\xd0\xb6\xd0\xb5 \xd0\xbb\xd0\xb5\xd0\xb6\xd0\xb8\xd1\x82 \xd0\xba\xd0\xb0\xd1\x80\xd1\x82\xd0\xb0 \xd1\x82\xd0\xbe\xd0\xb9 \xd0\xb6\xd0\xb5 \xd0\xbc\xd0\xb0\xd1\x81\xd1\x82\xd0\xb8 \xd0\xb4\xd0\xbe\xd1\x81\xd1\x82\xd0\xbe\xd0\xb8\xd0\xbd\xd1\x81\xd1\x82\xd0\xb2\xd0\xbe\xd0\xbc \xd0\xbd\xd0\xb0 \xd0\xb5\xd0\xb4\xd0\xb8\xd0\xbd\xd0\xb8\xd1\x86\xd1\x83 \xd0\xbd\xd0\xb8\xd0\xb6\xd0\xb5. \xd0\x9d\xd0\xb0\xd0\xbf\xd1\x80\xd0\xb8\xd0\xbc\xd0\xb5\xd1\x80, \xd0\xb4\xd0\xb5\xd0\xb2\xd1\x8f\xd1\x82\xd0\xba\xd1\x83 \xd0\xbf\xd0\xb8\xd0\xba \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xbd\xd0\xbe \xd0\xb2\xd1\x8b\xd0\xbb\xd0\xbe\xd0\xb6\xd0\xb8\xd1\x82\xd1\x8c \xd0\xbd\xd0\xb0 \xd1\x81\xd1\x82\xd0\xbe\xd0\xbb \xd0\xb2 \xd0\xbb\xd1\x8e\xd0\xb1\xd0\xbe\xd0\xb9 \xd0\xbc\xd0\xbe\xd0\xbc\xd0\xb5\xd0\xbd\xd1\x82, \xd0\xb4\xd0\xbb\xd1\x8f \xd0\xb2\xd1\x8b\xd0\xba\xd0\xbb\xd0\xb0\xd0\xb4\xd1\x8b\xd0\xb2\xd0\xb0\xd0\xbd\xd0\xb8\xd1\x8f \xd1\x81\xd0\xb5\xd0\xbc\xd1\x91\xd1\x80\xd0\xba\xd0\xb8 \xd1\x82\xd1\x80\xd0\xb5\xd1\x84 \xd0\xbd\xd0\xb5\xd0\xbe\xd0\xb1\xd1\x85\xd0\xbe\xd0\xb4\xd0\xb8\xd0\xbc\xd0\xbe \xd0\xbd\xd0\xb0\xd0\xbb\xd0\xb8\xd1\x87\xd0\xb8\xd0\xb5 \xd0\xbd\xd0\xb0 \xd1\x81\xd1\x82\xd0\xbe\xd0\xbb\xd0\xb5 \xd0\xb2\xd0\xbe\xd1\x81\xd1\x8c\xd0\xbc\xd1\x91\xd1\x80\xd0\xba\xd0\xb8 \xd1\x82\xd1\x80\xd0\xb5\xd1\x84, \xd0\xb0 \xd0\xb4\xd0\xbb\xd1\x8f \xd0\xb2\xd1\x8b\xd0\xba\xd0\xbb\xd0\xb0\xd0\xb4\xd1\x8b\xd0\xb2\xd0\xb0\xd0\xbd\xd0\xb8\xd1\x8f \xd1\x82\xd1\x83\xd0\xb7\xd0\xb0 \xd1\x87\xd0\xb5\xd1\x80\xd0\xb2\xd0\xb5\xd0\xb9 \xd0\xbd\xd0\xb5\xd0\xbe\xd0\xb1\xd1\x85\xd0\xbe\xd0\xb4\xd0\xb8\xd0\xbc\xd0\xbe \xd0\xbd\xd0\xb0\xd0\xbb\xd0\xb8\xd1\x87\xd0\xb8\xd0\xb5 \xd0\xbd\xd0\xb0 \xd1\x81\xd1\x82\xd0\xbe\xd0\xbb\xd0\xb5 \xd0\xba\xd0\xbe\xd1\x80\xd0\xbe\xd0\xbb\xd1\x8f \xd1\x87\xd0\xb5\xd1\x80\xd0\xb2\xd0\xb5\xd0\xb9.\xd0\x95\xd1\x81\xd0\xbb\xd0\xb8 \xd0\xb8\xd0\xb3\xd1\x80\xd0\xbe\xd0\xba \xd0\xbd\xd0\xb5 \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xb5\xd1\x82 \xd0\xb2\xd1\x8b\xd0\xbb\xd0\xbe\xd0\xb6\xd0\xb8\xd1\x82\xd1\x8c \xd0\xbd\xd0\xb0 \xd1\x81\xd1\x82\xd0\xbe\xd0\xbb \xd0\xbd\xd0\xb8 \xd0\xbe\xd0\xb4\xd0\xbd\xd1\x83 \xd0\xba\xd0\xb0\xd1\x80\xd1\x82\xd1\x83 \xd0\xb8\xd0\xb7 \xd1\x81\xd0\xb2\xd0\xbe\xd0\xb5\xd0\xb9 \xd1\x80\xd1\x83\xd0\xba\xd0\xb8, \xd1\x82\xd0\xbe \xd1\x85\xd0\xbe\xd0\xb4 \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb5\xd1\x85\xd0\xbe\xd0\xb4\xd0\xb8\xd1\x82 \xd0\xba \xd1\x81\xd0\xbe\xd0\xbf\xd0\xb5\xd1\x80\xd0\xbd\xd0\xb8\xd0\xba\xd1\x83. \xd0\x9e\xd0\xb1\xd1\x80\xd0\xb0\xd1\x82\xd0\xb8\xd1\x82\xd0\xb5 \xd0\xb2\xd0\xbd\xd0\xb8\xd0\xbc\xd0\xb0\xd0\xbd\xd0\xb8\xd0\xb5: \xd0\xbd\xd0\xb5\xd0\xbb\xd1\x8c\xd0\xb7\xd1\x8f \xd0\xbf\xd1\x80\xd0\xbe\xd0\xbf\xd1\x83\xd1\x81\xd1\x82\xd0\xb8\xd1\x82\xd1\x8c \xd1\x85\xd0\xbe\xd0\xb4 \xd0\xbf\xd1\x80\xd0\xbe\xd1\x81\xd1\x82\xd0\xbe \xd1\x82\xd0\xb0\xd0\xba \xe2\x80\x94 \xd0\xb2\xd1\x81\xd0\xb5\xd0\xb3\xd0\xb4\xd0\xb0 \xd0\xbd\xd0\xb5\xd0\xbe\xd0\xb1\xd1\x85\xd0\xbe\xd0\xb4\xd0\xb8\xd0\xbc\xd0\xbe \xd0\xb2\xd1\x8b\xd0\xbb\xd0\xbe\xd0\xb6\xd0\xb8\xd1\x82\xd1\x8c \xd0\xba\xd0\xb0\xd1\x80\xd1\x82\xd1\x83 \xd0\xbd\xd0\xb0 \xd1\x81\xd1\x82\xd0\xbe\xd0\xbb \xd0\xba\xd0\xbe\xd1\x80\xd1\x80\xd0\xb5\xd0\xba\xd1\x82\xd0\xbd\xd1\x8b\xd0\xbc \xd0\xbe\xd0\xb1\xd1\x80\xd0\xb0\xd0\xb7\xd0\xbe\xd0\xbc, \xd0\xb5\xd1\x81\xd0\xbb\xd0\xb8 \xd1\x8d\xd1\x82\xd0\xbe \xd0\xb2\xd0\xbe\xd0\xb7\xd0\xbc\xd0\xbe\xd0\xb6\xd0\xbd\xd0\xbe.\xd0\x92\xd0\xb0\xd0\xbc \xd0\xb4\xd0\xb0\xd0\xbd \xd1\x80\xd0\xb0\xd1\x81\xd0\xba\xd0\xbb\xd0\xb0\xd0\xb4 \xd0\xba\xd0\xb0\xd1\x80\xd1\x82 \xd0\xb2 \xd0\xbd\xd0\xb0\xd1\x87\xd0\xb0\xd0\xbb\xd0\xb5 \xd0\xb8\xd0\xb3\xd1\x80\xd1\x8b. \xd0\x90\xd0\xbb\xd0\xb8\xd1\x81\xd0\xb0 \xd0\xb1\xd1\x83\xd0\xb4\xd0\xb5\xd1\x82 \xd1\x85\xd0\xbe\xd0\xb4\xd0\xb8\xd1\x82\xd1\x8c \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb2\xd0\xbe\xd0\xb9. \xd0\x9e\xd0\xbf\xd1\x80\xd0\xb5\xd0\xb4\xd0\xb5\xd0\xbb\xd0\xb8\xd1\x82\xd0\xb5, \xd0\xba\xd1\x82\xd0\xbe \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb2\xd1\x8b\xd0\xbc \xd0\xb8\xd0\xb7\xd0\xb1\xd0\xb0\xd0\xb2\xd0\xb8\xd1\x82\xd1\x81\xd1\x8f \xd0\xbe\xd1\x82 \xd0\xb2\xd1\x81\xd0\xb5\xd1\x85 \xd1\x81\xd0\xb2\xd0\xbe\xd0\xb8\xd1\x85 \xd0\xba\xd0\xb0\xd1\x80\xd1\x82 \xd0\xb8 \xd0\xb2\xd1\x8b\xd0\xb8\xd0\xb3\xd1\x80\xd0\xb0\xd0\xb5\xd1\x82, \xd0\xb5\xd1\x81\xd0\xbb\xd0\xb8 \xd0\xbe\xd0\xb1\xd0\xb0 \xd0\xb8\xd0\xb3\xd1\x80\xd0\xbe\xd0\xba\xd0\xb0 \xd0\xb1\xd1\x83\xd0\xb4\xd1\x83\xd1\x82 \xd0\xbf\xd1\x8b\xd1\x82\xd0\xb0\xd1\x82\xd1\x8c\xd1\x81\xd1\x8f \xd0\xbf\xd0\xbe\xd0\xb1\xd0\xb5\xd0\xb4\xd0\xb8\xd1\x82\xd1\x8c \xd0\xb8 \xd0\xb8\xd0\xb3\xd1\x80\xd0\xb0\xd1\x82\xd1\x8c \xd0\xbe\xd0\xbf\xd1\x82\xd0\xb8\xd0\xbc\xd0\xb0\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe." "*special problem,brute force,dp" 1800
1166F "Vicky\'s Delivery Service" "In a magical land there are n cities conveniently numbered 1,2,\xe2\x80\xa6,n. Some pairs of these cities are connected by magical colored roads. Magic is unstable, so at any time, new roads may appear between two cities.Vicky the witch has been tasked with performing deliveries between some pairs of cities. However, Vicky is a beginner, so she can only complete a delivery if she can move from her starting city to her destination city through a double rainbow. A double rainbow is a sequence of cities c1,c2,\xe2\x80\xa6,ck satisfying the following properties:  For each i with 1\xe2\x89\xa4i\xe2\x89\xa4k\xe2\x88\x921, the cities ci and ci+1 are connected by a road.  For each i with 1\xe2\x89\xa4i\xe2\x89\xa4k\xe2\x88\x9212, the roads connecting c2i with c2i\xe2\x88\x921 and c2i+1 have the same color. For example if k=5, the road between c1 and c2 must be the same color as the road between c2 and c3, and the road between c3 and c4 must be the same color as the road between c4 and c5.Vicky has a list of events in chronological order, where each event is either a delivery she must perform, or appearance of a new road. Help her determine which of her deliveries she will be able to complete." "data structures,dsu,graphs,hashing" 2400
1056F "Write The Contest" "Polycarp, Arkady\'s friend, prepares to the programming competition and decides to write a contest. The contest consists of n problems and lasts for T minutes. Each of the problems is defined by two positive integers ai and pi \xe2\x80\x94 its difficulty and the score awarded by its solution.Polycarp\'s experience suggests that his skill level is defined with positive real value s, and initially s=1.0. To solve the i-th problem Polycarp needs ai/s minutes.Polycarp loves to watch series, and before solving each of the problems he will definitely watch one episode. After Polycarp watches an episode, his skill decreases by 10%, that is skill level s decreases to 0.9s. Each episode takes exactly 10 minutes to watch. When Polycarp decides to solve some problem, he firstly has to watch one episode, and only then he starts solving the problem without breaks for ai/s minutes, where s is his current skill level. In calculation of ai/s no rounding is performed, only division of integer value ai by real value s happens.Also, Polycarp can train for some time. If he trains for t minutes, he increases his skill by C\xe2\x8b\x85t, where C is some given positive real constant. Polycarp can train only before solving any problem (and before watching series). Duration of the training can be arbitrary real value.Polycarp is interested: what is the largest score he can get in the contest? It is allowed to solve problems in any order, while training is only allowed before solving the first problem." "binary search,dp,math" 2500
213A Game "Furik and Rubik love playing computer games. Furik has recently found a new game that greatly interested Rubik. The game consists of n parts and to complete each part a player may probably need to complete some other ones. We know that the game can be fully completed, that is, its parts do not form cyclic dependencies. Rubik has 3 computers, on which he can play this game. All computers are located in different houses. Besides, it has turned out that each part of the game can be completed only on one of these computers. Let\'s number the computers with integers from 1 to 3. Rubik can perform the following actions:   Complete some part of the game on some computer. Rubik spends exactly 1 hour on completing any part on any computer.  Move from the 1-st computer to the 2-nd one. Rubik spends exactly 1 hour on that.  Move from the 1-st computer to the 3-rd one. Rubik spends exactly 2 hours on that.  Move from the 2-nd computer to the 1-st one. Rubik spends exactly 2 hours on that.  Move from the 2-nd computer to the 3-rd one. Rubik spends exactly 1 hour on that.  Move from the 3-rd computer to the 1-st one. Rubik spends exactly 1 hour on that.  Move from the 3-rd computer to the 2-nd one. Rubik spends exactly 2 hours on that. Help Rubik to find the minimum number of hours he will need to complete all parts of the game. Initially Rubik can be located at the computer he considers necessary." "dfs and similar,greedy" 1700
1249D1 "Too Many Segments (easy version)" "The only difference between easy and hard versions is constraints.You are given n segments on the coordinate axis OX. Segments can intersect, lie inside each other and even coincide. The i-th segment is [li;ri] (li\xe2\x89\xa4ri) and it covers all integer points j such that li\xe2\x89\xa4j\xe2\x89\xa4ri.The integer point is called bad if it is covered by strictly more than k segments.Your task is to remove the minimum number of segments so that there are no bad points at all." greedy 1800
1168E "Xor Permutations" "Toad Mikhail has an array of 2k integers a1,a2,\xe2\x80\xa6,a2k.Find two permutations p and q of integers 0,1,\xe2\x80\xa6,2k\xe2\x88\x921, such that ai is equal to pi\xe2\x8a\x95qi for all possible i, or determine there are no such permutations. Here \xe2\x8a\x95 denotes the bitwise XOR operation." "constructive algorithms,math" 3100
424D "Biathlon Track" "Recently an official statement of the world Olympic Committee said that the Olympic Winter Games 2030 will be held in Tomsk. The city officials decided to prepare for the Olympics thoroughly and to build all the necessary Olympic facilities as early as possible. First, a biathlon track will be built.To construct a biathlon track a plot of land was allocated, which is a rectangle divided into n\xe2\x80\x89\xc3\x97\xe2\x80\x89m identical squares. Each of the squares has two coordinates: the number of the row (from 1 to n), where it is located, the number of the column (from 1 to m), where it is located. Also each of the squares is characterized by its height. During the sports the biathletes will have to move from one square to another. If a biathlete moves from a higher square to a lower one, he makes a descent. If a biathlete moves from a lower square to a higher one, he makes an ascent. If a biathlete moves between two squares with the same height, then he moves on flat ground.The biathlon track should be a border of some rectangular area of the allocated land on which biathletes will move in the clockwise direction. It is known that on one move on flat ground an average biathlete spends tp seconds, an ascent takes tu seconds, a descent takes td seconds. The Tomsk Administration wants to choose the route so that the average biathlete passes it in as close to t seconds as possible. In other words, the difference between time ts of passing the selected track and t should be minimum.For a better understanding you can look at the first sample of the input data. In this sample n\xe2\x80\x89=\xe2\x80\x896,\xe2\x80\x89m\xe2\x80\x89=\xe2\x80\x897, and the administration wants the track covering time to be as close to t\xe2\x80\x89=\xe2\x80\x8948 seconds as possible, also, tp\xe2\x80\x89=\xe2\x80\x893, tu\xe2\x80\x89=\xe2\x80\x896 and td\xe2\x80\x89=\xe2\x80\x892. If we consider the rectangle shown on the image by arrows, the average biathlete can move along the boundary in a clockwise direction in exactly 48 seconds. The upper left corner of this track is located in the square with the row number 4, column number 3 and the lower right corner is at square with row number 6, column number 7.  Among other things the administration wants all sides of the rectangle which boundaries will be the biathlon track to consist of no less than three squares and to be completely contained within the selected land.You are given the description of the given plot of land and all necessary time values. You are to write the program to find the most suitable rectangle for a biathlon track. If there are several such rectangles, you are allowed to print any of them." "binary search,brute force,constructive algorithms,data structures,dp" 2300
1566F "Points Movement" "There are n points and m segments on the coordinate line. The initial coordinate of the i-th point is ai. The endpoints of the j-th segment are lj and rj \xe2\x80\x94 left and right endpoints, respectively.You can move the points. In one move you can move any point from its current coordinate x to the coordinate x\xe2\x88\x921 or the coordinate x+1. The cost of this move is 1.You should move the points in such a way that each segment is visited by at least one point. A point visits the segment [l,r] if there is a moment when its coordinate was on the segment [l,r] (including endpoints).You should find the minimal possible total cost of all moves such that all segments are visited." "data structures,dp,greedy,implementation,sortings" 2600
1607H "Banquet Preparations 2" "The chef has cooked n dishes yet again: the i-th dish consists of ai grams of fish and bi grams of meat. Banquet organizers consider two dishes i and j equal if ai=aj and bi=bj at the same time.The banquet organizers estimate the variety of n dishes as follows. The variety of a set of dishes is equal to the number of different dishes in it. The less variety is, the better.In order to reduce the variety, a taster was invited. He will eat exactly mi grams of food from each dish. For each dish, the taster determines separately how much fish and how much meat he will eat. The only condition is that he will eat exactly mi grams of the i-th dish in total.Determine how much of what type of food the taster should eat from each dish so that the value of variety is the minimum possible. If there are several correct answers, you may output any of them." "greedy,sortings,two pointers" 2200
1368B "Codeforces Subsequences" "Karl likes Codeforces and subsequences. He wants to find a string of lowercase English letters that contains at least k subsequences codeforces. Out of all possible strings, Karl wants to find a shortest one.Formally, a codeforces subsequence of a string s is a subset of ten characters of s that read codeforces from left to right. For example, codeforces contains codeforces a single time, while codeforcesisawesome contains codeforces four times: codeforcesisawesome, codeforcesisawesome, codeforcesisawesome, codeforcesisawesome.Help Karl find any shortest string that contains at least k codeforces subsequences." "brute force,constructive algorithms,greedy,math,strings" 1500
536D "Tavas in Kansas" "Tavas lives in Kansas. Kansas has n cities numbered from 1 to n connected with m bidirectional roads. We can travel from any city to any other city via these roads. Kansas is as strange as Tavas. So there may be a road between a city and itself or more than one road between two cities.Tavas invented a game and called it ""Dashti"". He wants to play Dashti with his girlfriends, Nafas.In this game, they assign an arbitrary integer value to each city of Kansas. The value of i-th city equals to pi.During the game, Tavas is in city s and Nafas is in city t. They play in turn and Tavas goes first. A player in his/her turn, must choose a non-negative integer x and his/her score increases by the sum of values of all cities with (shortest) distance no more than x from his/her city. Each city may be used once, or in the other words, after first time a player gets score from a city, city score becomes zero.There is an additional rule: the player must choose x such that he/she gets the point of at least one city that was not used before. Note that city may initially have value 0, such city isn\'t considered as been used at the beginning of the game, i. e. each player may use it to fullfill this rule.The game ends when nobody can make a move.A player\'s score is the sum of the points he/she earned during the game. The winner is the player with greater score, or there is a draw if players score the same value. Both players start game with zero points.  If Tavas wins, he\'ll break his girlfriend\'s heart, and if Nafas wins, Tavas will cry. But if their scores are equal, they\'ll be happy and Tavas will give Nafas flowers.They\'re not too emotional after all, so they\'ll play optimally. Your task is to tell Tavas what\'s going to happen after the game ends." dp,games 2900
1411F "The Thorny Path" "According to a legend the Hanoi Temple holds a permutation of integers from 1 to n. There are n stones of distinct colors lying in one line in front of the temple. Monks can perform the following operation on stones: choose a position i (1\xe2\x89\xa4i\xe2\x89\xa4n) and cyclically shift stones at positions i, p[i], p[p[i]], .... That is, a stone from position i will move to position p[i], a stone from position p[i] will move to position p[p[i]], and so on, a stone from position j, such that p[j]=i, will move to position i.Each day the monks must obtain a new arrangement of stones using an arbitrary number of these operations. When all possible arrangements will have been obtained, the world will end. You are wondering, what if some elements of the permutation could be swapped just before the beginning? How many days would the world last?You want to get a permutation that will allow the world to last as long as possible, using the minimum number of exchanges of two elements of the permutation.Two arrangements of stones are considered different if there exists a position i such that the colors of the stones on that position are different in these arrangements." greedy,math 3000
1759F "All Possible Digits" "A positive number x of length n in base p (2\xe2\x89\xa4p\xe2\x89\xa4109) is written on the blackboard. The number x is given as a sequence a1,a2,\xe2\x80\xa6,an (0\xe2\x89\xa4ai<p) \xe2\x80\x94 the digits of x in order from left to right (most significant to least significant).Dmitry is very fond of all the digits of this number system, so he wants to see each of them at least once.In one operation, he can:   take any number x written on the board, increase it by 1, and write the new value x+1 on the board. For example, p=5 and x=2345.  Initially, the board contains the digits 2, 3 and 4;  Dmitry increases the number 2345 by 1 and writes down the number 2405. On the board there are digits 0,2,3,4;  Dmitry increases the number 2405 by 1 and writes down the number 2415. Now the board contains all the digits from 0 to 4. Your task is to determine the minimum number of operations required to make all the digits from 0 to p\xe2\x88\x921 appear on the board at least once." "binary search,data structures,greedy,math,number theory" 1800
1951B "Battle Cows" "The HU - Shireg Shireg\xe0\xb6\x9eThere are n cows participating in a coding tournament. Cow i has a Cowdeforces rating of ai (all distinct), and is initially in position i. The tournament consists of n\xe2\x88\x921 matches as follows:   The first match is between the cow in position 1 and the cow in position 2.  Subsequently, each match i is between the cow in position i+1 and the winner of match i\xe2\x88\x921.  In each match, the cow with the higher Cowdeforces rating wins and proceeds to the next match. You are the owner of cow k. For you, winning the tournament is not important; rather, you want your cow to win in as many matches as possible. As an acquaintance of the tournament organizers, you can ask them to swap the position of your cow with another cow only once, or you can choose to do nothing.Find the maximum number of wins your cow can achieve." "binary search,data structures,greedy" 1200
1852C "Ina of the Mountain" "To prepare her ""Takodachi"" dumbo octopuses for world domination, Ninomae Ina\'nis, a.k.a. Ina of the Mountain, orders Hoshimachi Suisei to throw boulders at them. Ina asks you, Kiryu Coco, to help choose where the boulders are thrown.There are n octopuses on a single-file trail on Ina\'s mountain, numbered 1,2,\xe2\x80\xa6,n. The i-th octopus has a certain initial health value ai, where 1\xe2\x89\xa4ai\xe2\x89\xa4k.Each boulder crushes consecutive octopuses with indexes l,l+1,\xe2\x80\xa6,r, where 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n. You can choose the numbers l and r arbitrarily for each boulder.For each boulder, the health value of each octopus the boulder crushes is reduced by 1. However, as octopuses are immortal, once they reach a health value of 0, they will immediately regenerate to a health value of k. Given the octopuses\' initial health values, find the minimum number of boulders that need to be thrown to make the health of all octopuses equal to k." "data structures,dp,greedy,math" 2400
1891D "Suspicious logarithms" "Let f(x) be the floor of the binary logarithm of x. In other words, f(x) is largest non-negative integer y, such that 2y does not exceed x.Let g(x) be the floor of the logarithm of x with base f(x). In other words, g(x) is the largest non-negative integer z, such that f(x)z does not exceed x.You are given q queries. The i-th query consists of two integers li and ri. The answer to the query is the sum of g(k) across all integers k, such that li\xe2\x89\xa4k\xe2\x89\xa4ri. Since the answers might be large, print them modulo 109+7." "binary search,brute force,math" 1900
123C Brackets "A two dimensional array is called a bracket array if each grid contains one of the two possible brackets \xe2\x80\x94 ""("" or "")"". A path through the two dimensional array cells is called monotonous if any two consecutive cells in the path are side-adjacent and each cell of the path is located below or to the right from the previous one. A two dimensional array whose size equals n\xe2\x80\x89\xc3\x97\xe2\x80\x89m is called a correct bracket array, if any string formed by writing out the brackets on some monotonous way from cell (1,\xe2\x80\x891) to cell (n,\xe2\x80\x89m) forms a correct bracket sequence. Let\'s define the operation of comparing two correct bracket arrays of equal size (a and b) like that. Let\'s consider a given two dimensional array of priorities (c) \xe2\x80\x94 a two dimensional array of same size, containing different integers from 1 to nm. Let\'s find such position (i,\xe2\x80\x89j) in the two dimensional array, that ai,\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89bi,\xe2\x80\x89j. If there are several such positions, let\'s choose the one where number ci,\xe2\x80\x89j is minimum. If ai,\xe2\x80\x89j\xe2\x80\x89=\xe2\x80\x89""("", then a\xe2\x80\x89<\xe2\x80\x89b, otherwise a\xe2\x80\x89>\xe2\x80\x89b. If the position (i,\xe2\x80\x89j) is not found, then the arrays are considered equal.Your task is to find a k-th two dimensional correct bracket array. It is guaranteed that for the given sizes of n and m there will be no less than k two dimensional correct bracket arrays." combinatorics,dp,greedy 2300
282B "Painting Eggs" "The Bitlandians are quite weird people. They have very peculiar customs.As is customary, Uncle J. wants to have n eggs painted for Bitruz (an ancient Bitland festival). He has asked G. and A. to do the work.The kids are excited because just as is customary, they\'re going to be paid for the job! Overall uncle J. has got n eggs. G. named his price for painting each egg. Similarly, A. named his price for painting each egg. It turns out that for each egg the sum of the money both A. and G. want for the painting equals 1000.Uncle J. wants to distribute the eggs between the children so as to give each egg to exactly one child. Also, Uncle J. wants the total money paid to A. to be different from the total money paid to G. by no more than 500.Help Uncle J. Find the required distribution of eggs or otherwise say that distributing the eggs in the required manner is impossible." greedy,math 1500
1389F "Bicolored Segments" "You are given n segments [l1,r1],[l2,r2],\xe2\x80\xa6,[ln,rn]. Each segment has one of two colors: the i-th segment\'s color is ti.Let\'s call a pair of segments i and j bad if the following two conditions are met:  ti\xe2\x89\xa0tj;  the segments [li,ri] and [lj,rj] intersect, embed or touch, i.\xe2\x80\x89e. there exists an integer x such that x\xe2\x88\x88[li,ri] and x\xe2\x88\x88[lj,rj]. Calculate the maximum number of segments that can be selected from the given ones, so that there is no bad pair among the selected ones." "data structures,dp,graph matchings,sortings" 2600
922B "Magic Forest" "Imp is in a magic forest, where xorangles grow (wut?)  A xorangle of order n is such a non-degenerate triangle, that lengths of its sides are integers not exceeding n, and the xor-sum of the lengths is equal to zero. Imp has to count the number of distinct xorangles of order n to get out of the forest. Formally, for a given integer n you have to find the number of such triples (a,\xe2\x80\x89b,\xe2\x80\x89c), that:  1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89c\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n;  , where  denotes the bitwise xor of integers x and y.  (a,\xe2\x80\x89b,\xe2\x80\x89c) form a non-degenerate (with strictly positive area) triangle." "brute force" 1300
76B Mice "Modern researches has shown that a flock of hungry mice searching for a piece of cheese acts as follows: if there are several pieces of cheese then each mouse chooses the closest one. After that all mice start moving towards the chosen piece of cheese. When a mouse or several mice achieve the destination point and there is still a piece of cheese in it, they eat it and become well-fed. Each mice that reaches this point after that remains hungry. Moving speeds of all mice are equal.If there are several ways to choose closest pieces then mice will choose it in a way that would minimize the number of hungry mice. To check this theory scientists decided to conduct an experiment. They located N mice and M pieces of cheese on a cartesian plane where all mice are located on the line y\xe2\x80\x89=\xe2\x80\x89Y0 and all pieces of cheese \xe2\x80\x94 on another line y\xe2\x80\x89=\xe2\x80\x89Y1. To check the results of the experiment the scientists need a program which simulates the behavior of a flock of hungry mice.Write a program that computes the minimal number of mice which will remain hungry, i.e. without cheese." "greedy,two pointers" 2100
347B "Fixed Points" "A permutation of length n is an integer sequence such that each integer from 0 to (n\xe2\x80\x89-\xe2\x80\x891) appears exactly once in it. For example, sequence [0,\xe2\x80\x892,\xe2\x80\x891] is a permutation of length 3 while both [0,\xe2\x80\x892,\xe2\x80\x892] and [1,\xe2\x80\x892,\xe2\x80\x893] are not.A fixed point of a function is a point that is mapped to itself by the function. A permutation can be regarded as a bijective function. We\'ll get a definition of a fixed point in a permutation. An integer i is a fixed point of permutation a0,\xe2\x80\x89a1,\xe2\x80\x89...,\xe2\x80\x89an\xe2\x80\x89-\xe2\x80\x891 if and only if ai\xe2\x80\x89=\xe2\x80\x89i. For example, permutation [0,\xe2\x80\x892,\xe2\x80\x891] has 1 fixed point and permutation [0,\xe2\x80\x891,\xe2\x80\x892] has 3 fixed points.You are given permutation a. You are allowed to swap two elements of the permutation at most once. Your task is to maximize the number of fixed points in the resulting permutation. Note that you are allowed to make at most one swap operation." "brute force,implementation,math" 1100
276D "Little Girl and Maximum XOR" "A little girl loves problems on bitwise operations very much. Here\'s one of them.You are given two integers l and r. Let\'s consider the values of  for all pairs of integers a and b (l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r). Your task is to find the maximum value among all considered ones.Expression  means applying bitwise excluding or operation to integers x and y. The given operation exists in all modern programming languages, for example, in languages C++ and Java it is represented as ""^"", in Pascal \xe2\x80\x94 as ""xor""." bitmasks,dp,greedy,implementation,math 1700
1419A "Digit Game" "Everyone knows that agents in Valorant decide, who will play as attackers, and who will play as defenders. To do that Raze and Breach decided to play t matches of a digit game...In each of t matches of the digit game, a positive integer is generated. It consists of n digits. The digits of this integer are numerated from 1 to n from the highest-order digit to the lowest-order digit. After this integer is announced, the match starts.Agents play in turns. Raze starts. In one turn an agent can choose any unmarked digit and mark it. Raze can choose digits on odd positions, but can not choose digits on even positions. Breach can choose digits on even positions, but can not choose digits on odd positions. The match ends, when there is only one unmarked digit left. If the single last digit is odd, then Raze wins, else Breach wins.It can be proved, that before the end of the match (for every initial integer with n digits) each agent has an ability to make a turn, i.e. there is at least one unmarked digit, that stands on a position of required parity.For each of t matches find out, which agent wins, if both of them want to win and play optimally." games,greedy,implementation 900
175D "Plane of Tanks: Duel" "Vasya plays the Plane of Tanks.Tanks are described with the following attributes:   the number of hit points;  the interval between two gun shots (the time required to recharge the gun);  the probability that the gun shot will not pierce armor of the enemy tank;  the damage to the enemy\'s tank. The gun damage is described with a segment [l,\xe2\x80\x89r], where l and r are integer numbers. The potential gun damage x is chosen with equal probability among all integer numbers of the segment [l,\xe2\x80\x89r]. If the shot pierces the armor of an enemy\'s tank then the enemy loses x hit points. If the number of hit points becomes non-positive then the enemy tank is considered destroyed. It is possible that the shot does not pierce the armor of a tank. In this case the number of hit points doesn\'t change. The probability that the armor will not be pierced is considered as the shooting tank attribute and does not depend on players\' behavior.The victory is near and there is only one enemy tank left. Vasya is ready for the battle \xe2\x80\x94 one more battle between the Good and the Evil is inevitable! Two enemies saw each other and each of them fired a shot at the same moment... The last battle has begun! Help Vasya to determine what is the probability that he will win the battle by destroying the enemy tank? If both tanks are destroyed (after simultaneous shots), then Vasya is considered a winner. You can assume that each player fires a shot just after the gun recharge and each tank has infinite number of ammo." "brute force,dp,math,probabilities" 2400
961C Chessboard "Magnus decided to play a classic chess game. Though what he saw in his locker shocked him! His favourite chessboard got broken into 4 pieces, each of size n by n, n is always odd. And what\'s even worse, some squares were of wrong color. j-th square of the i-th row of k-th piece of the board has color ak,\xe2\x80\x89i,\xe2\x80\x89j; 1 being black and 0 being white. Now Magnus wants to change color of some squares in such a way that he recolors minimum number of squares and obtained pieces form a valid chessboard. Every square has its color different to each of the neightbouring by side squares in a valid board. Its size should be 2n by 2n. You are allowed to move pieces but not allowed to rotate or flip them." "bitmasks,brute force,implementation" 1400
1310C "Au Pont Rouge" "VK just opened its second HQ in St. Petersburg! Side of its office building has a huge string s written on its side. This part of the office is supposed to be split into m meeting rooms in such way that meeting room walls are strictly between letters on the building. Obviously, meeting rooms should not be of size 0, but can be as small as one letter wide. Each meeting room will be named after the substring of s written on its side.For each possible arrangement of m meeting rooms we ordered a test meeting room label for the meeting room with lexicographically minimal name. When delivered, those labels got sorted backward lexicographically.What is printed on kth label of the delivery?" "binary search,dp,strings" 2800
585C "Alice, Bob, Oranges and Apples" "Alice and Bob decided to eat some fruit. In the kitchen they found a large bag of oranges and apples. Alice immediately took an orange for herself, Bob took an apple. To make the process of sharing the remaining fruit more fun, the friends decided to play a game. They put multiple cards and on each one they wrote a letter, either \'A\', or the letter \'B\'. Then they began to remove the cards one by one from left to right, every time they removed a card with the letter \'A\', Alice gave Bob all the fruits she had at that moment and took out of the bag as many apples and as many oranges as she had before. Thus the number of oranges and apples Alice had, did not change. If the card had written letter \'B\', then Bob did the same, that is, he gave Alice all the fruit that he had, and took from the bag the same set of fruit. After the last card way removed, all the fruit in the bag were over.You know how many oranges and apples was in the bag at first. Your task is to find any sequence of cards that Alice and Bob could have played with." "number theory" 2400
1725L "Lemper Cooking Competition" "Pak Chanek is participating in a lemper cooking competition. In the competition, Pak Chanek has to cook lempers with N stoves that are arranged sequentially from stove 1 to stove N. Initially, stove i has a temperature of Ai degrees. A stove can have a negative temperature.Pak Chanek realises that, in order for his lempers to be cooked, he needs to keep the temperature of each stove at a non-negative value. To make it happen, Pak Chanek can do zero or more operations. In one operation, Pak Chanek chooses one stove i with 2\xe2\x89\xa4i\xe2\x89\xa4N\xe2\x88\x921, then:  changes the temperature of stove i\xe2\x88\x921 into Ai\xe2\x88\x921:=Ai\xe2\x88\x921+Ai,  changes the temperature of stove i+1 into Ai+1:=Ai+1+Ai, and  changes the temperature of stove i into Ai:=\xe2\x88\x92Ai. Pak Chanek wants to know the minimum number of operations he needs to do such that the temperatures of all stoves are at non-negative values. Help Pak Chanek by telling him the minimum number of operations needed or by reporting if it is not possible to do." "data structures" 2400
1458A "Row GCD" "You are given two positive integer sequences a1,\xe2\x80\xa6,an and b1,\xe2\x80\xa6,bm. For each j=1,\xe2\x80\xa6,m find the greatest common divisor of a1+bj,\xe2\x80\xa6,an+bj." "math,number theory" 1600
1883E "Look Back" "You are given an array of integers a1,a2,\xe2\x80\xa6,an. You need to make it non-decreasing with the minimum number of operations. In one operation, you do the following: Choose an index 1\xe2\x89\xa4i\xe2\x89\xa4n, Set ai=ai\xe2\x8b\x852.An array b1,b2,\xe2\x80\xa6,bn is non-decreasing if bi\xe2\x89\xa4bi+1 for all 1\xe2\x89\xa4i<n." bitmasks,greedy 1700
1736D "Equal Binary Subsequences" "Everool has a binary string s of length 2n. Note that a binary string is a string consisting of only characters 0 and 1. He wants to partition s into two disjoint equal subsequences. He needs your help to do it.You are allowed to do the following operation exactly once.   You can choose any subsequence (possibly empty) of s and rotate it right by one position. In other words, you can select a sequence of indices b1,b2,\xe2\x80\xa6,bm, where 1\xe2\x89\xa4b1<b2<\xe2\x80\xa6<bm\xe2\x89\xa42n. After that you simultaneously set sb1:=sbm, sb2:=sb1, \xe2\x80\xa6, sbm:=sbm\xe2\x88\x921.Can you partition s into two disjoint equal subsequences after performing the allowed operation exactly once?A partition of s into two disjoint equal subsequences sp and sq is two increasing arrays of indices p1,p2,\xe2\x80\xa6,pn and q1,q2,\xe2\x80\xa6,qn, such that each integer from 1 to 2n is encountered in either p or q exactly once, sp=sp1sp2\xe2\x80\xa6spn, sq=sq1sq2\xe2\x80\xa6sqn, and sp=sq.If it is not possible to partition after performing any kind of operation, report \xe2\x88\x921. If it is possible to do the operation and partition s into two disjoint subsequences sp and sq, such that sp=sq, print elements of b and indices of sp, i. e. the values p1,p2,\xe2\x80\xa6,pn." "constructive algorithms,geometry,greedy,implementation,strings" 2200
1572B "Xor of 3" "You are given a sequence a of length n consisting of 0s and 1s.You can perform the following operation on this sequence:   Pick an index i from 1 to n\xe2\x88\x922 (inclusive).  Change all of ai, ai+1, ai+2 to ai\xe2\x8a\x95ai+1\xe2\x8a\x95ai+2 simultaneously, where \xe2\x8a\x95 denotes the bitwise XOR operation  Find a sequence of at most n operations that changes all elements of a to 0s or report that it\'s impossible.We can prove that if there exists a sequence of operations of any length that changes all elements of a to 0s, then there is also such a sequence of length not greater than n." "brute force,constructive algorithms,greedy,two pointers" 2500
1292E "Rin and The Unknown Flower" "MisoilePunch\xe2\x99\xaa - \xe5\xbd\xa9This is an interactive problem!On a normal day at the hidden office in A.R.C. Markland-N, Rin received an artifact, given to her by the exploration captain Sagar.After much analysis, she now realizes that this artifact contains data about a strange flower, which has existed way before the New Age. However, the information about its chemical structure has been encrypted heavily.The chemical structure of this flower can be represented as a string p. From the unencrypted papers included, Rin already knows the length n of that string, and she can also conclude that the string contains at most three distinct letters: ""C"" (as in Carbon), ""H"" (as in Hydrogen), and ""O"" (as in Oxygen).At each moment, Rin can input a string s of an arbitrary length into the artifact\'s terminal, and it will return every starting position of s as a substring of p.However, the artifact has limited energy and cannot be recharged in any way, since the technology is way too ancient and is incompatible with any current A.R.C.\'s devices. To be specific:  The artifact only contains 75 units of energy.  For each time Rin inputs a string s of length t, the artifact consumes 1t2 units of energy.  If the amount of energy reaches below zero, the task will be considered failed immediately, as the artifact will go black forever. Since the artifact is so precious yet fragile, Rin is very nervous to attempt to crack the final data. Can you give her a helping hand?" "constructive algorithms,greedy,interactive,math" 3500
1658F "Juju and Binary String" "The cuteness of a binary string is the number of 1s divided by the length of the string. For example, the cuteness of 01101 is 35.Juju has a binary string s of length n. She wants to choose some non-intersecting subsegments of s such that their concatenation has length m and it has the same cuteness as the string s. More specifically, she wants to find two arrays l and r of equal length k such that 1\xe2\x89\xa4l1\xe2\x89\xa4r1<l2\xe2\x89\xa4r2<\xe2\x80\xa6<lk\xe2\x89\xa4rk\xe2\x89\xa4n, and also:  k\xe2\x88\x91i=1(ri\xe2\x88\x92li+1)=m;  The cuteness of s[l1,r1]+s[l2,r2]+\xe2\x80\xa6+s[lk,rk] is equal to the cuteness of s, where s[x,y] denotes the subsegment sxsx+1\xe2\x80\xa6sy, and + denotes string concatenation. Juju does not like splitting the string into many parts, so she also wants to minimize the value of k. Find the minimum value of k such that there exist l and r that satisfy the constraints above or determine that it is impossible to find such l and r for any k." "brute force,constructive algorithms,greedy,math" 2700
1633A "Div. 7" "You are given an integer n. You have to change the minimum number of digits in it in such a way that the resulting number does not have any leading zeroes and is divisible by 7.If there are multiple ways to do it, print any of them. If the given number is already divisible by 7, leave it unchanged." "brute force" 800
306C "White, Black and White Again" "Polycarpus is sure that his life fits the description: ""first there is a white stripe, then a black one, then a white one again"". So, Polycarpus is sure that this rule is going to fulfill during the next n days. Polycarpus knows that he is in for w good events and b not-so-good events. At least one event is going to take place during each day. As each day is unequivocally characterizes as a part of a white or a black stripe, then each day is going to have events of the same type only (ether good or not-so-good).What is the number of distinct ways this scenario can develop over the next n days if Polycarpus is in for a white stripe (a stripe that has good events only, the stripe\'s length is at least 1 day), the a black stripe (a stripe that has not-so-good events only, the stripe\'s length is at least 1 day) and a white stripe again (a stripe that has good events only, the stripe\'s length is at least 1 day). Each of n days will belong to one of the three stripes only.Note that even the events of the same type are distinct from each other. Even if some events occur on the same day, they go in some order (there are no simultaneous events).Write a code that prints the number of possible configurations to sort the events into days. See the samples for clarifications on which scenarios should be considered distinct. Print the answer modulo 1000000009 (109\xe2\x80\x89+\xe2\x80\x899)." "combinatorics,number theory" 2100
452B "4-point polyline" "You are given a rectangular grid of lattice points from (0,\xe2\x80\x890) to (n,\xe2\x80\x89m) inclusive. You have to choose exactly 4 different points to build a polyline possibly with self-intersections and self-touching. This polyline should be as long as possible.A polyline defined by points p1,\xe2\x80\x89p2,\xe2\x80\x89p3,\xe2\x80\x89p4 consists of the line segments p1\xe2\x80\x89p2,\xe2\x80\x89p2\xe2\x80\x89p3,\xe2\x80\x89p3\xe2\x80\x89p4, and its length is the sum of the lengths of the individual line segments." "brute force,constructive algorithms,geometry,trees" 1800
1368H1 "Breadboard Capacity (easy version)" "This is an easier version of the problem H without modification queries.Lester and Delbert work at an electronics company. They are currently working on a microchip component serving to connect two independent parts of a large supercomputer.The component is built on top of a breadboard \xe2\x80\x94 a grid-like base for a microchip. The breadboard has n rows and m columns, and each row-column intersection contains a node. Also, on each side of the breadboard there are ports that can be attached to adjacent nodes. Left and right side have n ports each, and top and bottom side have m ports each. Each of the ports is connected on the outside to one of the parts bridged by the breadboard, and is colored red or blue respectively.  Ports can be connected by wires going inside the breadboard. However, there are a few rules to follow: Each wire should connect a red port with a blue port, and each port should be connected to at most one wire. Each part of the wire should be horizontal or vertical, and turns are only possible at one of the nodes. To avoid interference, wires can not have common parts of non-zero length (but may have common nodes). Also, a wire can not cover the same segment of non-zero length twice.The capacity of the breadboard is the largest number of red-blue wire connections that can be made subject to the rules above. For example, the breadboard above has capacity 7, and one way to make seven connections is pictured below.  Up to this point statements of both versions are identical. Differences follow below.Given the current breadboard configuration, help Lester and Delbert find its capacity efficiently." dp,flows,greedy 3300
746C Tram "The tram in Berland goes along a straight line from the point 0 to the point s and back, passing 1 meter per t1 seconds in both directions. It means that the tram is always in the state of uniform rectilinear motion, instantly turning around at points x\xe2\x80\x89=\xe2\x80\x890 and x\xe2\x80\x89=\xe2\x80\x89s.Igor is at the point x1. He should reach the point x2. Igor passes 1 meter per t2 seconds. Your task is to determine the minimum time Igor needs to get from the point x1 to the point x2, if it is known where the tram is and in what direction it goes at the moment Igor comes to the point x1.Igor can enter the tram unlimited number of times at any moment when his and the tram\'s positions coincide. It is not obligatory that points in which Igor enter and exit the tram are integers. Assume that any boarding and unboarding happens instantly. Igor can move arbitrary along the line (but not faster than 1 meter per t2 seconds). He can also stand at some point for some time." "constructive algorithms,implementation,math" 1600
336E "Vasily the Bear and Painting Square" "Vasily the bear has two favorite integers n and k and a pencil. Besides, he\'s got k jars with different water color paints. All jars are numbered in some manner from 1 to k, inclusive. The jar number i contains the paint of the i-th color. Initially the bear took a pencil and drew four segments on the coordinate plane. All of them end at point (0,\xe2\x80\x890). They begin at: (0,\xe2\x80\x892n), (0,\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x892n), (2n,\xe2\x80\x890), (\xe2\x80\x89-\xe2\x80\x892n,\xe2\x80\x890). Then for each i\xe2\x80\x89=\xe2\x80\x891,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89n, the bear drew two squares. The first square has the following vertex coordinates: (2i,\xe2\x80\x890), (\xe2\x80\x89-\xe2\x80\x892i,\xe2\x80\x890), (0,\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x892i), (0,\xe2\x80\x892i). The second square has the following vertex coordinates: (\xe2\x80\x89-\xe2\x80\x892i\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x892i\xe2\x80\x89-\xe2\x80\x891), (\xe2\x80\x89-\xe2\x80\x892i\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x892i\xe2\x80\x89-\xe2\x80\x891), (2i\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x892i\xe2\x80\x89-\xe2\x80\x891), (2i\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x892i\xe2\x80\x89-\xe2\x80\x891). After that, the bear drew another square: (1,\xe2\x80\x890), (\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x890), (0,\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x891), (0,\xe2\x80\x891). All points mentioned above form the set of points A.The sample of the final picture at n\xe2\x80\x89=\xe2\x80\x890The sample of the final picture at n\xe2\x80\x89=\xe2\x80\x892The bear decided to paint the resulting picture in k moves. The i-th move consists of the following stages:   The bear chooses 3 distinct points in set \xd0\x90 so that any pair of the chosen points has a segment on the picture between them. The chosen points and segments mark the area that mustn\'t contain any previously painted points.  The bear paints the area bounded by the chosen points and segments the i-th color. Note that after the k-th move some parts of the picture can stay unpainted.The bear asked you to calculate, how many distinct ways there are to paint his picture. A way to paint the picture is a sequence of three-element sets of points he chose on each step. Two sequences are considered distinct if there is such number i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k), that the i-th members of these sequences do not coincide as sets. As the sought number can be rather large, you only need to calculate the remainder after dividing it by number 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." bitmasks,combinatorics,dp,implementation 2700
954D "Fight Against Traffic" "Little town Nsk consists of n junctions connected by m bidirectional roads. Each road connects two distinct junctions and no two roads connect the same pair of junctions. It is possible to get from any junction to any other junction by these roads. The distance between two junctions is equal to the minimum possible number of roads on a path between them.In order to improve the transportation system, the city council asks mayor to build one new road. The problem is that the mayor has just bought a wonderful new car and he really enjoys a ride from his home, located near junction s to work located near junction t. Thus, he wants to build a new road in such a way that the distance between these two junctions won\'t decrease. You are assigned a task to compute the number of pairs of junctions that are not connected by the road, such that if the new road between these two junctions is built the distance between s and t won\'t decrease." "dfs and similar,graphs,shortest paths" 1600
593C "Beautiful Function" "Every day Ruslan tried to count sheep to fall asleep, but this didn\'t help. Now he has found a more interesting thing to do. First, he thinks of some set of circles on a plane, and then tries to choose a beautiful set of points, such that there is at least one point from the set inside or on the border of each of the imagined circles.Yesterday Ruslan tried to solve this problem for the case when the set of points is considered beautiful if it is given as (xt\xe2\x80\x89=\xe2\x80\x89f(t),\xe2\x80\x89yt\xe2\x80\x89=\xe2\x80\x89g(t)), where argument t takes all integer values from 0 to 50. Moreover, f(t) and g(t) should be correct functions.Assume that w(t) and h(t) are some correct functions, and c is an integer ranging from 0 to 50. The function s(t) is correct if it\'s obtained by one of the following rules:  s(t)\xe2\x80\x89=\xe2\x80\x89abs(w(t)), where abs(x) means taking the absolute value of a number x, i.e. |x|; s(t)\xe2\x80\x89=\xe2\x80\x89(w(t)\xe2\x80\x89+\xe2\x80\x89h(t)); s(t)\xe2\x80\x89=\xe2\x80\x89(w(t)\xe2\x80\x89-\xe2\x80\x89h(t)); s(t)\xe2\x80\x89=\xe2\x80\x89(w(t)\xe2\x80\x89*\xe2\x80\x89h(t)), where \xe2\x80\x89*\xe2\x80\x89 means multiplication, i.e. (w(t)\xc2\xb7h(t)); s(t)\xe2\x80\x89=\xe2\x80\x89c; s(t)\xe2\x80\x89=\xe2\x80\x89t;Yesterday Ruslan thought on and on, but he could not cope with the task. Now he asks you to write a program that computes the appropriate f(t) and g(t) for any set of at most 50 circles.In each of the functions f(t) and g(t) you are allowed to use no more than 50 multiplications. The length of any function should not exceed 100\xc2\xb7n characters. The function should not contain spaces.Ruslan can\'t keep big numbers in his memory, so you should choose f(t) and g(t), such that for all integer t from 0 to 50 value of f(t) and g(t) and all the intermediate calculations won\'t exceed 109 by their absolute value." "constructive algorithms,math" 2200
1646B "Quality vs Quantity" "You are given a sequence of n non-negative integers a1,a2,\xe2\x80\xa6,an. Initially, all the elements of the sequence are unpainted. You can paint each number Red_ or \xc2\xafBlue (but not both), or leave it unpainted. For a color c, Count(c) is the number of elements in the sequence painted with that color and Sum(c) is the sum of the elements in the sequence painted with that color.For example, if the given sequence is [2,8,6,3,1] and it is painted this way: [\xc2\xaf2,8,6_,\xc2\xaf3,1] (where 6 is painted red, 2 and 3 are painted blue, 1 and 8 are unpainted) then Sum(Red_)=6, Sum(\xc2\xafBlue)=2+3=5, Count(Red_)=1, and Count(\xc2\xafBlue)=2.Determine if it is possible to paint the sequence so that Sum(Red_)>Sum(\xc2\xafBlue) and Count(Red_)<Count(\xc2\xafBlue)." "brute force,constructive algorithms,greedy,sortings,two pointers" 800
1889D "Game of Stacks" "You have n stacks r1,r2,\xe2\x80\xa6,rn. Each stack contains some positive integers ranging from 1 to n.Define the following functions:function init(pos):    stacks := an array that contains n stacks r[1], r[2], ..., r[n]    return get(stacks, pos)function get(stacks, pos):    if stacks[pos] is empty:        return pos    else:        new_pos := the top element of stacks[pos]        pop the top element of stacks[pos]        return get(stacks, new_pos)You want to know the values returned by init(1),init(2),\xe2\x80\xa6,init(n).Note that, during these calls, the stacks r1,r2,\xe2\x80\xa6,rn don\'t change, so the calls init(1),init(2),\xe2\x80\xa6,init(n) are independent." "brute force,dfs and similar,graphs,implementation,trees" 3000
1779G "The Game of the Century" "The time has finally come, MKnez and Baltic are to host The Game of the Century. For that purpose, they built a village to lodge its participants.The village has the shape of an equilateral triangle delimited by three roads of length n. It is cut into n2 smaller equilateral triangles, of side length 1, by 3n\xe2\x88\x923 additional roads which run parallel to the sides. See the figure for n=3. Each of the 3n roads is made of multiple (possibly 1) road segments of length 1 which connect adjacent intersections.  The direction has already been chosen for each of the 3n roads (so, for each road, the same direction is assigned to all its road segments). Traffic can only go in the specified directions (i. e. the roads are monodirectional).You are tasked with making adjustments to the traffic plan so that from each intersection it is possible to reach every other intersection. Specifically, you can invert the traffic direction of any number of road segments of length 1. What is the minimal number of road segments for which you need to invert the traffic direction?" "constructive algorithms,graphs,shortest paths" 3000
1919G "Tree LGM" "In TreeWorld, there is a popular two-player game played on a tree with n vertices labelled from 1 to n. In this game, the tournament leaders first choose a vertex to be the root of the tree and choose another vertex (possibly the same vertex as the root) to place a coin on. Then, each player will take turns moving the coin to any child\xe2\x80\xa0 of the vertex that the coin is currently on. The first player who is unable to make a move loses.Alice wants to be a tree LGM, so she spends a lot of time studying the game. She wrote down an n by n matrix s, where si,j=1 if the first player can win with the root of the tree chosen to be vertex i, and the coin was initially placed on vertex j. Otherwise, si,j=0. Alice is a perfectionist, so she assumes that both players play perfectly in the game.However, she accidentally knocked her head on the way to the tournament and forgot what the tree looked like. Determine whether there exists a tree that satisfies the winning and losing states represented by matrix s, and if it exists, construct a valid tree.\xe2\x80\xa0 A vertex c is a child of vertex u if there is an edge between c and u, and c does not lie on the unique simple path from the root to vertex u." "constructive algorithms,divide and conquer,games,trees" 3500
762A "k-th divisor" "You are given two integers n and k. Find k-th smallest divisor of n, or report that it doesn\'t exist.Divisor of n is any such natural number, that n can be divided by it without remainder." "math,number theory" 1400
188B "A + Reverse B" "You are given numbers a and b. Calculate the sum of a and reverse of b. A reverse of a number is a number which contains the same digits in reverse order. For example, reverse of 230 is 32, and reverse of 0 is 0." "*special problem,implementation" 1300
1773F Football "Scientists are researching an impact of football match results on the mood of football fans. They have a hypothesis that there is a correlation between the number of draws and fans\' desire to watch football matches in the future.In football, two teams play a match. The teams score goals throughout a match. A score ""x:y"" means that the team we observe scored x goals and conceded y goals. If x=y, then the match ends in a draw. If x>y, then the observed team wins, and if x<y, then it loses.To find out if there is a correlation, the scientists gathered information about the results of teams in lower leagues. The information they found is the number of matches played by the team (n), the number of goals scored in these matches (a), and the number of goals conceded in these matches (b). You are given this information for a single team. You are asked to calculate the minimum number of draws that could have happened during the team\'s matches and provide a list of match scores with the minimum number of draws." "constructive algorithms" 800
1383A "String Transformation 1" "Note that the only difference between String Transformation 1 and String Transformation 2 is in the move Koa does. In this version the letter y Koa selects must be strictly greater alphabetically than x (read statement for better understanding). You can make hacks in these problems independently.Koa the Koala has two strings A and B of the same length n (|A|=|B|=n) consisting of the first 20 lowercase English alphabet letters (ie. from a to t).In one move Koa:  selects some subset of positions p1,p2,\xe2\x80\xa6,pk (k\xe2\x89\xa51;1\xe2\x89\xa4pi\xe2\x89\xa4n;pi\xe2\x89\xa0pj if i\xe2\x89\xa0j) of A such that Ap1=Ap2=\xe2\x80\xa6=Apk=x (ie. all letters on this positions are equal to some letter x).  selects a letter y (from the first 20 lowercase letters in English alphabet) such that y>x (ie. letter y is strictly greater alphabetically than x).  sets each letter in positions p1,p2,\xe2\x80\xa6,pk to letter y. More formally: for each i (1\xe2\x89\xa4i\xe2\x89\xa4k) Koa sets Api=y. Note that you can only modify letters in string A.Koa wants to know the smallest number of moves she has to do to make strings equal to each other (A=B) or to determine that there is no way to make them equal. Help her!" "dsu,graphs,greedy,sortings,strings,trees,two pointers" 1700
222C "Reducing Fractions" "To confuse the opponents, the Galactic Empire represents fractions in an unusual format. The fractions are represented as two sets of integers. The product of numbers from the first set gives the fraction numerator, the product of numbers from the second set gives the fraction denominator. However, it turned out that the programs that work with fractions in this representations aren\'t complete, they lack supporting the operation of reducing fractions. Implement this operation and the Empire won\'t forget you." "implementation,math,number theory,sortings" 1800
1255C "League of Leesins" "Bob is an avid fan of the video game ""League of Leesins"", and today he celebrates as the League of Leesins World Championship comes to an end! The tournament consisted of n (n\xe2\x89\xa55) teams around the world. Before the tournament starts, Bob has made a prediction of the rankings of each team, from 1-st to n-th. After the final, he compared the prediction with the actual result and found out that the i-th team according to his prediction ended up at the pi-th position (1\xe2\x89\xa4pi\xe2\x89\xa4n, all pi are unique). In other words, p is a permutation of 1,2,\xe2\x80\xa6,n.As Bob\'s favorite League player is the famous ""3ga"", he decided to write down every 3 consecutive elements of the permutation p. Formally, Bob created an array q of n\xe2\x88\x922 triples, where qi=(pi,pi+1,pi+2) for each 1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x922. Bob was very proud of his array, so he showed it to his friend Alice.After learning of Bob\'s array, Alice declared that she could retrieve the permutation p even if Bob rearranges the elements of q and the elements within each triple. Of course, Bob did not believe in such magic, so he did just the same as above to see Alice\'s respond.For example, if n=5 and p=[1,4,2,3,5], then the original array q will be [(1,4,2),(4,2,3),(2,3,5)]. Bob can then rearrange the numbers within each triple and the positions of the triples to get [(4,3,2),(2,3,5),(4,1,2)]. Note that [(1,4,2),(4,2,2),(3,3,5)] is not a valid rearrangement of q, as Bob is not allowed to swap numbers belong to different triples.As Alice\'s friend, you know for sure that Alice was just trying to show off, so you decided to save her some face by giving her any permutation p that is consistent with the array q she was given." "constructive algorithms,implementation" 1600
1393A "Rainbow Dash, Fluttershy and Chess Coloring" "One evening Rainbow Dash and Fluttershy have come up with a game. Since the ponies are friends, they have decided not to compete in the game but to pursue a common goal. The game starts on a square flat grid, which initially has the outline borders built up. Rainbow Dash and Fluttershy have flat square blocks with size 1\xc3\x971, Rainbow Dash has an infinite amount of light blue blocks, Fluttershy has an infinite amount of yellow blocks. The blocks are placed according to the following rule: each newly placed block must touch the built on the previous turns figure by a side (note that the outline borders of the grid are built initially). At each turn, one pony can place any number of blocks of her color according to the game rules.Rainbow and Fluttershy have found out that they can build patterns on the grid of the game that way. They have decided to start with something simple, so they made up their mind to place the blocks to form a chess coloring. Rainbow Dash is well-known for her speed, so she is interested in the minimum number of turns she and Fluttershy need to do to get a chess coloring, covering the whole grid with blocks. Please help her find that number!Since the ponies can play many times on different boards, Rainbow Dash asks you to find the minimum numbers of turns for several grids of the games.The chess coloring in two colors is the one in which each square is neighbor by side only with squares of different colors." greedy,math 800
1120B "Once in a casino" "One player came to a casino and found a slot machine where everything depends only on how he plays. The rules follow.A positive integer a is initially on the screen. The player can put a coin into the machine and then add 1 to or subtract 1 from any two adjacent digits. All digits must remain from 0 to 9 after this operation, and the leading digit must not equal zero. In other words, it is forbidden to add 1 to 9, to subtract 1 from 0 and to subtract 1 from the leading 1. Once the number on the screen becomes equal to b, the player wins the jackpot. a and b have the same number of digits.Help the player to determine the minimal number of coins he needs to spend in order to win the jackpot and tell how to play." "constructive algorithms,greedy,implementation,math" 2700
1942F "Farmer John\'s Favorite Function" "\xce\xa9\xce\xa9PARTS - Camellia\xe2\xa0\x80Farmer John has an array a of length n. He also has a function f with the following recurrence:   f(1)=\xe2\x88\x9aa1;  For all i>1, f(i)=\xe2\x88\x9af(i\xe2\x88\x921)+ai. Note that f(i) is not necessarily an integer.He plans to do q updates to the array. Each update, he gives you two integers k and x and he wants you to set ak=x. After each update, he wants to know \xe2\x8c\x8af(n)\xe2\x8c\x8b, where \xe2\x8c\x8at\xe2\x8c\x8b denotes the value of t rounded down to the nearest integer." "brute force,data structures,implementation,math" 2700
1873A "Short Sort" "There are three cards with letters a, b, c placed in a row in some order. You can do the following operation at most once:   Pick two cards, and swap them.  Is it possible that the row becomes abc after the operation? Output ""YES"" if it is possible, and ""NO"" otherwise." "brute force,implementation" 800
178A3 "Educational Game" "The Smart Beaver from ABBYY began to develop a new educational game for children. The rules of the game are fairly simple and are described below.The playing field is a sequence of n non-negative integers ai numbered from 1 to n. The goal of the game is to make numbers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89ak (i.e. some prefix of the sequence) equal to zero for some fixed k (k\xe2\x80\x89<\xe2\x80\x89n), and this should be done in the smallest possible number of moves.One move is choosing an integer i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) such that ai\xe2\x80\x89>\xe2\x80\x890 and an integer t (t\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x890) such that i\xe2\x80\x89+\xe2\x80\x892t\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n. After the values of i and t have been selected, the value of ai is decreased by 1, and the value of ai\xe2\x80\x89+\xe2\x80\x892t is increased by 1. For example, let n\xe2\x80\x89=\xe2\x80\x894 and a\xe2\x80\x89=\xe2\x80\x89(1,\xe2\x80\x890,\xe2\x80\x891,\xe2\x80\x892), then it is possible to make move i\xe2\x80\x89=\xe2\x80\x893, t\xe2\x80\x89=\xe2\x80\x890 and get a\xe2\x80\x89=\xe2\x80\x89(1,\xe2\x80\x890,\xe2\x80\x890,\xe2\x80\x893) or to make move i\xe2\x80\x89=\xe2\x80\x891, t\xe2\x80\x89=\xe2\x80\x891 and get a\xe2\x80\x89=\xe2\x80\x89(0,\xe2\x80\x890,\xe2\x80\x892,\xe2\x80\x892) (the only possible other move is i\xe2\x80\x89=\xe2\x80\x891, t\xe2\x80\x89=\xe2\x80\x890).You are given n and the initial sequence ai. The task is to calculate the minimum number of moves needed to make the first k elements of the original sequence equal to zero for each possible k (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k\xe2\x80\x89<\xe2\x80\x89n)." greedy 1100
615B "Longtail Hedgehog" "This Christmas Santa gave Masha a magic picture and a pencil. The picture consists of n points connected by m segments (they might cross in any way, that doesn\'t matter). No two segments connect the same pair of points, and no segment connects the point to itself. Masha wants to color some segments in order paint a hedgehog. In Mashas mind every hedgehog consists of a tail and some spines. She wants to paint the tail that satisfies the following conditions:   Only segments already presented on the picture can be painted;  The tail should be continuous, i.e. consists of some sequence of points, such that every two neighbouring points are connected by a colored segment;  The numbers of points from the beginning of the tail to the end should strictly increase. Masha defines the length of the tail as the number of points in it. Also, she wants to paint some spines. To do so, Masha will paint all the segments, such that one of their ends is the endpoint of the tail. Masha defines the beauty of a hedgehog as the length of the tail multiplied by the number of spines. Masha wants to color the most beautiful hedgehog. Help her calculate what result she may hope to get.Note that according to Masha\'s definition of a hedgehog, one segment may simultaneously serve as a spine and a part of the tail (she is a little girl after all). Take a look at the picture for further clarifications." dp,graphs 1600
387B "George and Round" "George decided to prepare a Codesecrof round, so he has prepared m problems for the round. Let\'s number the problems with integers 1 through m. George estimates the i-th problem\'s complexity by integer bi.To make the round good, he needs to put at least n problems there. Besides, he needs to have at least one problem with complexity exactly a1, at least one with complexity exactly a2, ..., and at least one with complexity exactly an. Of course, the round can also have problems with other complexities.George has a poor imagination. It\'s easier for him to make some already prepared problem simpler than to come up with a new one and prepare it. George is magnificent at simplifying problems. He can simplify any already prepared problem with complexity c to any positive integer complexity d (c\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89d), by changing limits on the input data.However, nothing is so simple. George understood that even if he simplifies some problems, he can run out of problems for a good round. That\'s why he decided to find out the minimum number of problems he needs to come up with in addition to the m he\'s prepared in order to make a good round. Note that George can come up with a new problem of any complexity." "brute force,greedy,two pointers" 1200
1862G "The Great Equalizer" "Tema bought an old device with a small screen and a worn-out inscription ""The Great Equalizer"" on the side.The seller said that the device needs to be given an array a of integers as input, after which ""The Great Equalizer"" will work as follows:   Sort the current array in non-decreasing order and remove duplicate elements leaving only one occurrence of each element.  If the current length of the array is equal to 1, the device stops working and outputs the single number in the array \xe2\x80\x94 output value of the device.  Add an arithmetic progression {n, n\xe2\x88\x921, n\xe2\x88\x922, \xe2\x80\xa6, 1} to the current array, where n is the length of the current array. In other words, n\xe2\x88\x92i is added to the i-th element of the array, when indexed from zero.  Go to the first step. To test the operation of the device, Tema came up with a certain array of integers a, and then wanted to perform q operations on the array a of the following type:   Assign the value x (1\xe2\x89\xa4x\xe2\x89\xa4109) to the element ai (1\xe2\x89\xa4i\xe2\x89\xa4n).  Give the array a as input to the device and find out the result of the device\'s operation, while the array a remains unchanged during the operation of the device. Help Tema find out the output values of the device after each operation." "binary search,data structures,math,sortings" 2000
1297E "Modernization of Treeland" "Treeland consists of n cities and n\xe2\x88\x921 two-way roads connecting pairs of cities. From every city, you can reach every other city moving only by the roads. You are right, the system of cities and roads in this country forms an undirected tree.The government has announced a program for the modernization of urban infrastructure of some cities. You have been assigned to select an arbitrary subset of cities S to upgrade (potentially all the cities) that satisfies the following requirements:  the subset of cities must be ""connected"", that is, from any city of the subset S you can get to any other city of the subset S by roads, moving only through cities from S,  the number of ""dead-ends"" in S must be equal to the given number k. A city is a ""dead-end"" if it is the only city in S or connected to exactly one another city from S.   This shows one of the possible ways to select S (blue vertices) for a given configuration and k=4. Dead-ends are vertices with numbers 1, 4, 6 and 7. Help Treeland upgrade its cities. Find any of the possible subsets S or determine that such a subset does not exist." "*special problem,dfs and similar,trees" -999
1663C "P\xc5\x8dja Verdon" "Aenar has an array a consisting of n integers." "*special problem,implementation,math" -999
1525C "Robot Collisions" "There are n robots driving along an OX axis. There are also two walls: one is at coordinate 0 and one is at coordinate m.The i-th robot starts at an integer coordinate xi (0<xi<m) and moves either left (towards the 0) or right with the speed of 1 unit per second. No two robots start at the same coordinate.Whenever a robot reaches a wall, it turns around instantly and continues his ride in the opposite direction with the same speed.Whenever several robots meet at the same integer coordinate, they collide and explode into dust. Once a robot has exploded, it doesn\'t collide with any other robot. Note that if several robots meet at a non-integer coordinate, nothing happens.For each robot find out if it ever explodes and print the time of explosion if it happens and \xe2\x88\x921 otherwise." "data structures,greedy,implementation,sortings" 2000
724C "Ray Tracing" "There are k sensors located in the rectangular room of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m meters. The i-th sensor is located at point (xi,\xe2\x80\x89yi). All sensors are located at distinct points strictly inside the rectangle. Opposite corners of the room are located at points (0,\xe2\x80\x890) and (n,\xe2\x80\x89m). Walls of the room are parallel to coordinate axes.At the moment 0, from the point (0,\xe2\x80\x890) the laser ray is released in the direction of point (1,\xe2\x80\x891). The ray travels with a speed of  meters per second. Thus, the ray will reach the point (1,\xe2\x80\x891) in exactly one second after the start.When the ray meets the wall it\'s reflected by the rule that the angle of incidence is equal to the angle of reflection. If the ray reaches any of the four corners, it immediately stops.For each sensor you have to determine the first moment of time when the ray will pass through the point where this sensor is located. If the ray will never pass through this point, print \xe2\x80\x89-\xe2\x80\x891 for such sensors." "greedy,hashing,implementation,math,number theory,sortings" 1800
237B "Young Table" "You\'ve got table a, consisting of n rows, numbered from 1 to n. The i-th line of table a contains ci cells, at that for all i (1\xe2\x80\x89<\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) holds ci\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ci\xe2\x80\x89-\xe2\x80\x891. Let\'s denote s as the total number of cells of table a, that is, . We know that each cell of the table contains a single integer from 1 to s, at that all written integers are distinct. Let\'s assume that the cells of the i-th row of table a are numbered from 1 to ci, then let\'s denote the number written in the j-th cell of the i-th row as ai,\xe2\x80\x89j. Your task is to perform several swap operations to rearrange the numbers in the table so as to fulfill the following conditions:  for all i,\xe2\x80\x89j (1\xe2\x80\x89<\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n; 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ci) holds ai,\xe2\x80\x89j\xe2\x80\x89>\xe2\x80\x89ai\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89j;  for all i,\xe2\x80\x89j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n; 1\xe2\x80\x89<\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ci) holds ai,\xe2\x80\x89j\xe2\x80\x89>\xe2\x80\x89ai,\xe2\x80\x89j\xe2\x80\x89-\xe2\x80\x891. In one swap operation you are allowed to choose two different cells of the table and swap the recorded there numbers, that is the number that was recorded in the first of the selected cells before the swap, is written in the second cell after it. Similarly, the number that was recorded in the second of the selected cells, is written in the first cell after the swap.Rearrange the numbers in the required manner. Note that you are allowed to perform any number of operations, but not more than s. You do not have to minimize the number of operations." implementation,sortings 1500
1163C1 "Power Transmission (Easy Edition)" "This problem is same as the next one, but has smaller constraints.It was a Sunday morning when the three friends Selena, Shiro and Katie decided to have a trip to the nearby power station (do not try this at home). After arriving at the power station, the cats got impressed with a large power transmission system consisting of many chimneys, electric poles, and wires. Since they are cats, they found those things gigantic.At the entrance of the station, there is a map describing the complicated wiring system. Selena is the best at math among three friends. He decided to draw the map on the Cartesian plane. Each pole is now a point at some coordinates (xi,yi). Since every pole is different, all of the points representing these poles are distinct. Also, every two poles are connected with each other by wires. A wire is a straight line on the plane infinite in both directions. If there are more than two poles lying on the same line, they are connected by a single common wire.Selena thinks, that whenever two different electric wires intersect, they may interfere with each other and cause damage. So he wonders, how many pairs are intersecting? Could you help him with this problem?" "brute force,geometry" 1900
1657F "Words on Tree" "You are given a tree consisting of n vertices, and q triples (xi,yi,si), where xi and yi are integers from 1 to n, and si is a string with length equal to the number of vertices on the simple path from xi to yi.You want to write a lowercase Latin letter on each vertex in such a way that, for each of q given triples, at least one of the following conditions holds:  if you write out the letters on the vertices on the simple path from xi to yi in the order they appear on this path, you get the string si;  if you write out the letters on the vertices on the simple path from yi to xi in the order they appear on this path, you get the string si. Find any possible way to write a letter on each vertex to meet these constraints, or report that it is impossible." "2-sat,dfs and similar,dsu,graphs,trees" 2600
1773L "Lisa\'s Sequences" "Lisa loves playing with the sequences of integers. When she gets a new integer sequence ai of length n, she starts looking for all monotone subsequences. A monotone subsequence [l,r] is defined by two indices l and r (1\xe2\x89\xa4l<r\xe2\x89\xa4n) such that \xe2\x88\x80i=l,l+1,\xe2\x80\xa6,r\xe2\x88\x921:ai\xe2\x89\xa4ai+1 or \xe2\x88\x80i=l,l+1,\xe2\x80\xa6,r\xe2\x88\x921:ai\xe2\x89\xa5ai+1. Lisa considers a sequence ai to be boring if there is a monotone subsequence [l,r] that is as long as her boredom threshold k, that is when r\xe2\x88\x92l+1=k.Lucas has a sequence bi that he wants to present to Lisa, but the sequence might be boring for Lisa. So, he wants to change some elements of his sequence bi, so that Lisa does not get bored playing with it. However, Lucas is lazy and wants to change as few elements of the sequence bi as possible. Your task is to help Lucas find the required changes." dp 3500
1371B "Magical Calendar" "A competitive eater, Alice is scheduling some practices for an eating contest on a magical calendar. The calendar is unusual because a week contains not necessarily 7 days!In detail, she can choose any integer k which satisfies 1\xe2\x89\xa4k\xe2\x89\xa4r, and set k days as the number of days in a week.Alice is going to paint some n consecutive days on this calendar. On this calendar, dates are written from the left cell to the right cell in a week. If a date reaches the last day of a week, the next day\'s cell is the leftmost cell in the next (under) row.She wants to make all of the painted cells to be connected by side. It means, that for any two painted cells there should exist at least one sequence of painted cells, started in one of these cells, and ended in another, such that any two consecutive cells in this sequence are connected by side.Alice is considering the shape of the painted cells. Two shapes are the same if there exists a way to make them exactly overlapped using only parallel moves, parallel to the calendar\'s sides.For example, in the picture, a week has 4 days and Alice paints 5 consecutive days. [1] and [2] are different shapes, but [1] and [3] are equal shapes.  Alice wants to know how many possible shapes exists if she set how many days a week has and choose consecutive n days and paints them in calendar started in one of the days of the week. As was said before, she considers only shapes, there all cells are connected by side." math 1200
122B "Lucky Substring" "Petya loves lucky numbers. Everybody knows that lucky numbers are positive integers whose decimal representation contains only the lucky digits 4 and 7. For example, numbers 47, 744, 4 are lucky and 5, 17, 467 are not.One day Petya was delivered a string s, containing only digits. He needs to find a string that represents a lucky number without leading zeroes, is not empty, is contained in s as a substring the maximum number of times.Among all the strings for which the three conditions given above are fulfilled, Petya only needs the lexicographically minimum one. Find this string for Petya." "brute force,implementation" 1000
413E "Maze 2D" "The last product of the R2 company in the 2D games\' field is a new revolutionary algorithm of searching for the shortest path in a 2\xe2\x80\x89\xc3\x97\xe2\x80\x89n maze.Imagine a maze that looks like a 2\xe2\x80\x89\xc3\x97\xe2\x80\x89n rectangle, divided into unit squares. Each unit square is either an empty cell or an obstacle. In one unit of time, a person can move from an empty cell of the maze to any side-adjacent empty cell. The shortest path problem is formulated as follows. Given two free maze cells, you need to determine the minimum time required to go from one cell to the other.Unfortunately, the developed algorithm works well for only one request for finding the shortest path, in practice such requests occur quite often. You, as the chief R2 programmer, are commissioned to optimize the algorithm to find the shortest path. Write a program that will effectively respond to multiple requests to find the shortest path in a 2\xe2\x80\x89\xc3\x97\xe2\x80\x89n maze." "data structures,divide and conquer" 2200
1804G "Flow Control" "Raj has a single physical network line that connects his office to the Internet. This line bandwidth is b bytes per millisecond.There are n users who would like to use this network line to transmit some data. The i-th of them will use the line from millisecond si to millisecond fi inclusive. His initial data rate will be set to di. That means he will use data rate equal to di for millisecond si, and then it will change according to the procedure described below.The flow control will happen as follows. Suppose there are m users trying to transmit some data via the given network line during millisecond x. Denote as ti the data rate that the i-th of these m users has at the beginning of this millisecond. All ti are non-negative integer values.   If m=0, i. e. there are no users trying to transmit data during this millisecond, nothing happens.  If the sum of all ti is less than or equal to b, each active user successfully completes his transmission (the i-th active user transmits ti bytes). After that, the data rate of each active user grows by 1, i. e. each ti is increased by 1.  If the sum of all ti is greater than b, the congestion occurs and no data transmissions succeed this millisecond at all. If that happens, each ti decreases twice, i. e. each ti is replaced with \xe2\x8c\x8ati2\xe2\x8c\x8b. Raj knows all the values n, b, si, fi, and di, he wants to calculate the total number of bytes transmitted by all the users in the aggregate." "data structures,dsu,implementation" 3500
500F "New Year Shopping" "Dohyun is running a grocery store. He sells n items numbered by integers from 1 to n. The i-th (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) of them costs ci dollars, and if I buy it, my happiness increases by hi. Each item can be displayed only for p units of time because of freshness. As Dohyun displays the i-th item at time ti, the customers can buy the i-th item only from time ti to time ti\xe2\x80\x89+\xe2\x80\x89(p\xe2\x80\x89-\xe2\x80\x891) inclusively. Also, each customer cannot buy the same item more than once.I\'d like to visit Dohyun\'s grocery store and buy some items for the New Year Party, and maximize my happiness. Because I am a really busy person, I can visit the store only once, and for very short period of time. In other words, if I visit the store at time t, I can only buy the items available at time t. But I can buy as many items as possible, if the budget holds. I can\'t buy same item several times due to store rules. It is not necessary to use the whole budget.I made a list of q pairs of integers (aj,\xe2\x80\x89bj), which means I may visit the store at time aj, and spend at most bj dollars at the store. For each pair, I\'d like to know the maximum happiness I can obtain. But there are so many pairs that I can\'t handle them. Can you help me?" "divide and conquer,dp" 2700
1847B "Hamon Odyssey" "Jonathan is fighting against DIO\'s Vampire minions. There are n of them with strengths a1,a2,\xe2\x80\xa6,an. Denote (l,r) as the group consisting of the vampires with indices from l to r. Jonathan realizes that the strength of any such group is in its weakest link, that is, the bitwise AND. More formally, the strength level of the group (l,r) is defined as f(l,r)=al&al+1&al+2&\xe2\x80\xa6&ar. Here, & denotes the bitwise AND operation. Because Jonathan would like to defeat the vampire minions fast, he will divide the vampires into contiguous groups, such that each vampire is in exactly one group, and the sum of strengths of the groups is minimized. Among all ways to divide the vampires, he would like to find the way with the maximum number of groups.Given the strengths of each of the n vampires, find the maximum number of groups among all possible ways to divide the vampires with the smallest sum of strengths." "bitmasks,greedy,two pointers" 1000
41A Translation "The translation from the Berland language into the Birland language is not an easy task. Those languages are very similar: a Berlandish word differs from a Birlandish word with the same meaning a little: it is spelled (and pronounced) reversely. For example, a Berlandish word code corresponds to a Birlandish word edoc. However, making a mistake during the ""translation"" is easy. Vasya translated the word s from Berlandish into Birlandish as t. Help him: find out if he translated the word correctly." implementation,strings 800
115D "Unambiguous Arithmetic Expression" "Let\'s define an unambiguous arithmetic expression (UAE) as follows.   All non-negative integers are UAE\'s. Integers may have leading zeroes (for example, 0000 and 0010 are considered valid integers).  If X and Y are two UAE\'s, then ""(X)\xe2\x80\x89+\xe2\x80\x89(Y)"", ""(X)\xe2\x80\x89-\xe2\x80\x89(Y)"", ""(X)\xe2\x80\x89*\xe2\x80\x89(Y)"", and ""(X)\xe2\x80\x89/\xe2\x80\x89(Y)"" (all without the double quotes) are UAE\'s.  If X is an UAE, then ""\xe2\x80\x89-\xe2\x80\x89(X)"" and ""\xe2\x80\x89+\xe2\x80\x89(X)"" (both without the double quotes) are UAE\'s.You are given a string consisting only of digits (""0"" - ""9"") and characters ""-"", ""+"", ""*"", and ""/"". Your task is to compute the number of different possible unambiguous arithmetic expressions such that if all brackets (characters ""("" and "")"") of that unambiguous arithmetic expression are removed, it becomes the input string. Since the answer may be very large, print it modulo 1000003 (106\xe2\x80\x89+\xe2\x80\x893)." "dp,expression parsing" 2600
1890A "Doremy\'s Paint 3" "An array b1,b2,\xe2\x80\xa6,bn of positive integers is good if all the sums of two adjacent elements are equal to the same value. More formally, the array is good if there exists a k such that b1+b2=b2+b3=\xe2\x80\xa6=bn\xe2\x88\x921+bn=k.Doremy has an array a of length n. Now Doremy can permute its elements (change their order) however she wants. Determine if she can make the array good." "constructive algorithms" 800
1253E "Antenna Coverage" "The mayor of the Central Town wants to modernize Central Street, represented in this problem by the (Ox) axis.On this street, there are n antennas, numbered from 1 to n. The i-th antenna lies on the position xi and has an initial scope of si: it covers all integer positions inside the interval [xi\xe2\x88\x92si;xi+si].It is possible to increment the scope of any antenna by 1, this operation costs 1 coin. We can do this operation as much as we want (multiple times on the same antenna if we want).To modernize the street, we need to make all integer positions from 1 to m inclusive covered by at least one antenna. Note that it is authorized to cover positions outside [1;m], even if it\'s not required.What is the minimum amount of coins needed to achieve this modernization?" "data structures,dp,greedy,sortings" 2200
1925A "We Got Everything Covered!" "You are given two positive integers n and k. Your task is to find a string s such that all possible strings of length n that can be formed using the first k lowercase English alphabets occur as a subsequence of s. If there are multiple answers, print the one with the smallest length. If there are still multiple answers, you may print any of them.Note: A string a is called a subsequence of another string b if a can be obtained by deleting some (possibly zero) characters from b without changing the order of the remaining characters." "constructive algorithms,greedy,strings" 800
1188E "Problem from Red Panda" "At Moscow Workshops ICPC team gets a balloon for each problem they solved first. Team MSU Red Panda got so many balloons that they didn\'t know how to spend them. So they came up with a problem with them.There are several balloons, not more than 106 in total, each one is colored in one of k colors. We can perform the following operation: choose k\xe2\x88\x921 balloons such that they are of k\xe2\x88\x921 different colors, and recolor them all into remaining color. We can perform this operation any finite number of times (for example, we can only perform the operation if there are at least k\xe2\x88\x921 different colors among current balls).How many different balloon configurations can we get? Only number of balloons of each color matters, configurations differing only by the order of balloons are counted as equal. As this number can be very large, output it modulo 998244353." combinatorics 3300
786A Berzerk "Rick and Morty are playing their own version of Berzerk (which has nothing in common with the famous Berzerk game). This game needs a huge space, so they play it with a computer.In this game there are n objects numbered from 1 to n arranged in a circle (in clockwise order). Object number 1 is a black hole and the others are planets. There\'s a monster in one of the planet. Rick and Morty don\'t know on which one yet, only that he\'s not initially in the black hole, but Unity will inform them before the game starts. But for now, they want to be prepared for every possible scenario.  Each one of them has a set of numbers between 1 and n\xe2\x80\x89-\xe2\x80\x891 (inclusive). Rick\'s set is s1 with k1 elements and Morty\'s is s2 with k2 elements. One of them goes first and the player changes alternatively. In each player\'s turn, he should choose an arbitrary number like x from his set and the monster will move to his x-th next object from its current position (clockwise). If after his move the monster gets to the black hole he wins.Your task is that for each of monster\'s initial positions and who plays first determine if the starter wins, loses, or the game will stuck in an infinite loop. In case when player can lose or make game infinity, it more profitable to choose infinity game." "dfs and similar,dp,games" 2000
1043B "Lost Array" "Bajtek, known for his unusual gifts, recently got an integer array x0,x1,\xe2\x80\xa6,xk\xe2\x88\x921.Unfortunately, after a huge array-party with his extraordinary friends, he realized that he\'d lost it. After hours spent on searching for a new toy, Bajtek found on the arrays producer\'s website another array a of length n+1. As a formal description of a says, a0=0 and for all other i (1\xe2\x89\xa4i\xe2\x89\xa4n) ai=x(i\xe2\x88\x921)modk+ai\xe2\x88\x921, where pmodq denotes the remainder of division p by q.For example, if the x=[1,2,3] and n=5, then:  a0=0,  a1=x0mod3+a0=x0+0=1,  a2=x1mod3+a1=x1+1=3,  a3=x2mod3+a2=x2+3=6,  a4=x3mod3+a3=x0+6=7,  a5=x4mod3+a4=x1+7=9. So, if the x=[1,2,3] and n=5, then a=[0,1,3,6,7,9].Now the boy hopes that he will be able to restore x from a! Knowing that 1\xe2\x89\xa4k\xe2\x89\xa4n, help him and find all possible values of k \xe2\x80\x94 possible lengths of the lost array." implementation 1200
56E "Domino Principle" "Vasya is interested in arranging dominoes. He is fed up with common dominoes and he uses the dominoes of different heights. He put n dominoes on the table along one axis, going from left to right. Every domino stands perpendicular to that axis so that the axis passes through the center of its base. The i-th domino has the coordinate xi and the height hi. Now Vasya wants to learn for every domino, how many dominoes will fall if he pushes it to the right. Help him do that. Consider that a domino falls if it is touched strictly above the base. In other words, the fall of the domino with the initial coordinate x and height h leads to the fall of all dominoes on the segment [x\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89x\xe2\x80\x89+\xe2\x80\x89h\xe2\x80\x89-\xe2\x80\x891]." "binary search,data structures,sortings" 2200
1504B "Flip the Bits" "There is a binary string a of length n. In one operation, you can select any prefix of a with an equal number of 0 and 1 symbols. Then all symbols in the prefix are inverted: each 0 becomes 1 and each 1 becomes 0.For example, suppose a=0111010000.   In the first operation, we can select the prefix of length 8 since it has four 0\'s and four 1\'s: [01110100]00\xe2\x86\x92[10001011]00.  In the second operation, we can select the prefix of length 2 since it has one 0 and one 1: [10]00101100\xe2\x86\x92[01]00101100.  It is illegal to select the prefix of length 4 for the third operation, because it has three 0\'s and one 1. Can you transform the string a into the string b using some finite number of operations (possibly, none)?" "constructive algorithms,greedy,implementation,math" 1200
226C Anniversary "There are less than 60 years left till the 900-th birthday anniversary of a famous Italian mathematician Leonardo Fibonacci. Of course, such important anniversary needs much preparations.Dima is sure that it\'ll be great to learn to solve the following problem by the Big Day: You\'re given a set A, consisting of numbers l, l\xe2\x80\x89+\xe2\x80\x891, l\xe2\x80\x89+\xe2\x80\x892, ..., r; let\'s consider all its k-element subsets; for each such subset let\'s find the largest common divisor of Fibonacci numbers with indexes, determined by the subset elements. Among all found common divisors, Dima is interested in the largest one.Dima asked to remind you that Fibonacci numbers are elements of a numeric sequence, where F1\xe2\x80\x89=\xe2\x80\x891, F2\xe2\x80\x89=\xe2\x80\x891, Fn\xe2\x80\x89=\xe2\x80\x89Fn\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x89Fn\xe2\x80\x89-\xe2\x80\x892 for n\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x893.Dima has more than half a century ahead to solve the given task, but you only have two hours. Count the residue from dividing the sought largest common divisor by m." "data structures,implementation,math,matrices,number theory" 2400
1681E "Labyrinth Adventures" "You found a map of a weirdly shaped labyrinth. The map is a grid, consisting of n rows and n columns. The rows of the grid are numbered from 1 to n from bottom to top. The columns of the grid are numbered from 1 to n from left to right.The labyrinth has n layers. The first layer is the bottom left corner (cell (1,1)). The second layer consists of all cells that are in the grid and adjacent to the first layer by a side or a corner. The third layer consists of all cells that are in the grid and adjacent to the second layer by a side or a corner. And so on. The labyrinth with 5 layers, for example, is shaped as follows:   The layers are separated from one another with walls. However, there are doors in these walls.Each layer (except for layer n) has exactly two doors to the next layer. One door is placed on the top wall of the layer and another door is placed on the right wall of the layer. For each layer from 1 to n\xe2\x88\x921 you are given positions of these two doors. The doors can be passed in both directions: either from layer i to layer i+1 or from layer i+1 to layer i.If you are standing in some cell, you can move to an adjacent by a side cell if a wall doesn\'t block your move (e.g. you can\'t move to a cell in another layer if there is no door between the cells).Now you have m queries of sort: what\'s the minimum number of moves one has to make to go from cell (x1,y1) to cell (x2,y2)." "data structures,dp,matrices,shortest paths" 2600
1648D "Serious Business" "Dima is taking part in a show organized by his friend Peter. In this show Dima is required to cross a 3\xc3\x97n rectangular field. Rows are numbered from 1 to 3 and columns are numbered from 1 to n.The cell in the intersection of the i-th row and the j-th column of the field contains an integer ai,j. Initially Dima\'s score equals zero, and whenever Dima reaches a cell in the row i and the column j, his score changes by ai,j. Note that the score can become negative.Initially all cells in the first and the third row are marked as available, and all cells in the second row are marked as unavailable. However, Peter offered Dima some help: there are q special offers in the show, the i-th special offer allows Dima to mark cells in the second row between li and ri as available, though Dima\'s score reduces by ki whenever he accepts a special offer. Dima is allowed to use as many special offers as he wants, and might mark the same cell as available multiple times.Dima starts his journey in the cell (1,1) and would like to reach the cell (3,n). He can move either down to the next row or right to the next column (meaning he could increase the current row or column by 1), thus making n+1 moves in total, out of which exactly n\xe2\x88\x921 would be horizontal and 2 would be vertical.Peter promised Dima to pay him based on his final score, so the sum of all numbers of all visited cells minus the cost of all special offers used. Please help Dima to maximize his final score." "data structures,divide and conquer,dp,implementation,shortest paths" 2800
120A Elevator "A sky scraper with 1000 floors has been built in the city of N. It has modern superfast elevators to help to travel from one floor to another. Each elevator has two doors, the front one and the back one. If one goes in through the front door, he goes out through the back one and vice versa. The elevator has two rails numbered with numbers 1 and 2. Rail 1 is located to the left of the entrance to the front door (or correspondingly, to the right of the entrance to the back door). Rail 2 is located opposite it, to the right of the entrance to the front door and to the left of the entrance to the back door. We know that each person in the city of N holds at a rail with the strongest hand. One day a VIP person visited the city and of course, he took a look at the skyscraper and took a ride in the elevator. We know the door through which he entered and the rail he was holding at. Now we need to determine as soon as possible whether he is left-handed or right-handed." "brute force,implementation,math" 1000
1580F "Problems for Codeforces" "XYMXYM and CQXYM will prepare n problems for Codeforces. The difficulty of the problem i will be an integer ai, where ai\xe2\x89\xa50. The difficulty of the problems must satisfy ai+ai+1<m (1\xe2\x89\xa4i<n), and a1+an<m, where m is a fixed integer. XYMXYM wants to know how many plans of the difficulty of the problems there are modulo 998244353.Two plans of difficulty a and b are different only if there is an integer i (1\xe2\x89\xa4i\xe2\x89\xa4n) satisfying ai\xe2\x89\xa0bi." combinatorics,fft,math 3300
1669B Triple "Given an array a of n elements, print any value that appears at least three times or print -1 if there is no such value." implementation,sortings 800
895E "Eyes Closed" "Vasya and Petya were tired of studying so they decided to play a game. Before the game begins Vasya looks at array a consisting of n integers. As soon as he remembers all elements of a the game begins. Vasya closes his eyes and Petya does q actions of one of two types:1) Petya says 4 integers l1,\xe2\x80\x89r1,\xe2\x80\x89l2,\xe2\x80\x89r2 \xe2\x80\x94 boundaries of two non-intersecting segments. After that he swaps one random element from the [l1,\xe2\x80\x89r1] segment with another random element from the [l2,\xe2\x80\x89r2] segment.2) Petya asks Vasya the sum of the elements of a in the [l,\xe2\x80\x89r] segment.Vasya is a mathematician so he answers Petya the mathematical expectation of the sum of the elements in the segment.Your task is to write a program which will answer the second type questions as Vasya would do it. In other words your program should print the mathematical expectation of the sum of the elements of a in the [l,\xe2\x80\x89r] segment for every second type query." "data structures,probabilities" 2300
1183B "Equalize Prices" "There are n products in the shop. The price of the i-th product is ai. The owner of the shop wants to equalize the prices of all products. However, he wants to change prices smoothly.In fact, the owner of the shop can change the price of some product i in such a way that the difference between the old price of this product ai and the new price bi is at most k. In other words, the condition |ai\xe2\x88\x92bi|\xe2\x89\xa4k should be satisfied (|x| is the absolute value of x).He can change the price for each product not more than once. Note that he can leave the old prices for some products. The new price bi of each product i should be positive (i.e. bi>0 should be satisfied for all i from 1 to n).Your task is to find out the maximum possible equal price B of all productts with the restriction that for all products the condiion |ai\xe2\x88\x92B|\xe2\x89\xa4k should be satisfied (where ai is the old price of the product and B is the same new price of all products) or report that it is impossible to find such price B.Note that the chosen price B should be integer.You should answer q independent queries." math 900
1941A "Rudolf and the Ticket" "Rudolf is going to visit Bernard, and he decided to take the metro to get to him. The ticket can be purchased at a machine that accepts exactly two coins, the sum of which does not exceed k.Rudolf has two pockets with coins. In the left pocket, there are n coins with denominations b1,b2,\xe2\x80\xa6,bn. In the right pocket, there are m coins with denominations c1,c2,\xe2\x80\xa6,cm. He wants to choose exactly one coin from the left pocket and exactly one coin from the right pocket (two coins in total).Help Rudolf determine how many ways there are to select indices f and s such that bf+cs\xe2\x89\xa4k." "brute force,math" 800
153E "Euclidean Distance" "You are given a multiset of points on the plane with integer coordinates. Find the maximum distance between two points from this multiset." "*special problem" 2100
7E "Defining Macros" "Most C/C++ programmers know about excellent opportunities that preprocessor #define directives give; but many know as well about the problems that can arise because of their careless use.In this problem we consider the following model of #define constructions (also called macros). Each macro has its name and value. The generic syntax for declaring a macro is the following:#define macro_name macro_valueAfter the macro has been declared, ""macro_name"" is replaced with ""macro_value"" each time it is met in the program (only the whole tokens can be replaced; i.e. ""macro_name"" is replaced only when it is surrounded by spaces or other non-alphabetic symbol). A ""macro_value"" within our model can only be an arithmetic expression consisting of variables, four arithmetic operations, brackets, and also the names of previously declared macros (in this case replacement is performed sequentially). The process of replacing macros with their values is called substitution.One of the main problems arising while using macros \xe2\x80\x94 the situation when as a result of substitution we get an arithmetic expression with the changed order of calculation because of different priorities of the operations.Let\'s consider the following example. Say, we declared such a #define construction:#define sum x + yand further in the program the expression ""2 * sum"" is calculated. After macro substitution is performed we get ""2 * x + y"", instead of intuitively expected ""2 * (x + y)"".Let\'s call the situation ""suspicious"", if after the macro substitution the order of calculation changes, falling outside the bounds of some macro. Thus, your task is to find out by the given set of #define definitions and the given expression if this expression is suspicious or not.Let\'s speak more formally. We should perform an ordinary macros substitution in the given expression. Moreover, we should perform a ""safe"" macros substitution in the expression, putting in brackets each macro value; after this, guided by arithmetic rules of brackets expansion, we can omit some of the brackets. If there exist a way to get an expression, absolutely coinciding with the expression that is the result of an ordinary substitution (character-by-character, but ignoring spaces), then this expression and the macros system are called correct, otherwise \xe2\x80\x94 suspicious.Note that we consider the ""/"" operation as the usual mathematical division, not the integer division like in C/C++. That\'s why, for example, in the expression ""a*(b/c)"" we can omit brackets to get the expression ""a*b/c""." "dp,expression parsing,implementation" 2600
1674F "Desktop Rearrangement" "Your friend Ivan asked you to help him rearrange his desktop. The desktop can be represented as a rectangle matrix of size n\xc3\x97m consisting of characters \'.\' (empty cell of the desktop) and \'*\' (an icon).The desktop is called good if all its icons are occupying some prefix of full columns and, possibly, the prefix of the next column (and there are no icons outside this figure). In other words, some amount of first columns will be filled with icons and, possibly, some amount of first cells of the next (after the last full column) column will be also filled with icons (and all the icons on the desktop belong to this figure). This is pretty much the same as the real life icons arrangement.In one move, you can take one icon and move it to any empty cell in the desktop.Ivan loves to add some icons to his desktop and remove them from it, so he is asking you to answer q queries: what is the minimum number of moves required to make the desktop good after adding/removing one icon?Note that queries are permanent and change the state of the desktop." "data structures,greedy,implementation" 1800
225A "Dice Tower" "A dice is a cube, its faces contain distinct integers from 1 to 6 as black points. The sum of numbers at the opposite dice faces always equals 7. Please note that there are only two dice (these dices are mirror of each other) that satisfy the given constraints (both of them are shown on the picture on the left).  Alice and Bob play dice. Alice has built a tower from n dice. We know that in this tower the adjacent dice contact with faces with distinct numbers. Bob wants to uniquely identify the numbers written on the faces of all dice, from which the tower is built. Unfortunately, Bob is looking at the tower from the face, and so he does not see all the numbers on the faces. Bob sees the number on the top of the tower and the numbers on the two adjacent sides (on the right side of the picture shown what Bob sees).Help Bob, tell whether it is possible to uniquely identify the numbers on the faces of all the dice in the tower, or not." "constructive algorithms,greedy" 1100
774H "Repairing Of String" "Stepan had a favorite string s which consisted of the lowercase letters of the Latin alphabet. After graduation, he decided to remember it, but it was a long time ago, so he can\'t now remember it. But Stepan remembers some information about the string, namely the sequence of integers c1,\xe2\x80\x89c2,\xe2\x80\x89...,\xe2\x80\x89cn, where n equals the length of the string s, and ci equals the number of substrings in the string s with the length i, consisting of the same letters. The substring is a sequence of consecutive characters in the string s.For example, if the Stepan\'s favorite string is equal to ""tttesst"", the sequence c looks like: c\xe2\x80\x89=\xe2\x80\x89[7,\xe2\x80\x893,\xe2\x80\x891,\xe2\x80\x890,\xe2\x80\x890,\xe2\x80\x890,\xe2\x80\x890].Stepan asks you to help to repair his favorite string s according to the given sequence c1,\xe2\x80\x89c2,\xe2\x80\x89...,\xe2\x80\x89cn." "*special problem,constructive algorithms" 2200
1209A "Paint the Numbers" "You are given a sequence of integers a1,a2,\xe2\x80\xa6,an. You need to paint elements in colors, so that:   If we consider any color, all elements of this color must be divisible by the minimal element of this color.  The number of used colors must be minimized. For example, it\'s fine to paint elements [40,10,60] in a single color, because they are all divisible by 10. You can use any color an arbitrary amount of times (in particular, it is allowed to use a color only once). The elements painted in one color do not need to be consecutive.For example, if a=[6,2,3,4,12] then two colors are required: let\'s paint 6, 3 and 12 in the first color (6, 3 and 12 are divisible by 3) and paint 2 and 4 in the second color (2 and 4 are divisible by 2). For example, if a=[10,7,15] then 3 colors are required (we can simply paint each element in an unique color)." greedy,implementation,math 800
183C "Cyclic Coloring" "You are given a directed graph G with n vertices and m arcs (multiple arcs and self-loops are allowed). You have to paint each vertex of the graph into one of the k (k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) colors in such way that for all arcs of the graph leading from a vertex u to vertex v, vertex v is painted with the next color of the color used to paint vertex u.The colors are numbered cyclically 1 through k. This means that for each color i (i\xe2\x80\x89<\xe2\x80\x89k) its next color is color i\xe2\x80\x89+\xe2\x80\x891. In addition, the next color of color k is color 1. Note, that if k\xe2\x80\x89=\xe2\x80\x891, then the next color for color 1 is again color 1.Your task is to find and print the largest possible value of k (k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) such that it\'s possible to color G as described above with k colors. Note that you don\'t necessarily use all the k colors (that is, for each color i there does not necessarily exist a vertex that is colored with color i)." "dfs and similar" 2200
830C "Bamboo Partition" "Vladimir wants to modernize partitions in his office. To make the office more comfortable he decided to remove a partition and plant several bamboos in a row. He thinks it would be nice if there are n bamboos in a row, and the i-th from the left is ai meters high. Vladimir has just planted n bamboos in a row, each of which has height 0 meters right now, but they grow 1 meter each day. In order to make the partition nice Vladimir can cut each bamboo once at any height (no greater that the height of the bamboo), and then the bamboo will stop growing.Vladimir wants to check the bamboos each d days (i.e. d days after he planted, then after 2d days and so on), and cut the bamboos that reached the required height. Vladimir wants the total length of bamboo parts he will cut off to be no greater than k meters.What is the maximum value d he can choose so that he can achieve what he wants without cutting off more than k meters of bamboo?" "brute force,data structures,implementation,math,number theory,sortings,two pointers" 2300
1220G Geolocation "You are working for the Gryzzl company, headquartered in Pawnee, Indiana.The new national park has been opened near Pawnee recently and you are to implement a geolocation system, so people won\'t get lost. The concept you developed is innovative and minimalistic. There will be n antennas located somewhere in the park. When someone would like to know their current location, their Gryzzl hologram phone will communicate with antennas and obtain distances from a user\'s current location to all antennas.Knowing those distances and antennas locations it should be easy to recover a user\'s location... Right? Well, almost. The only issue is that there is no way to distinguish antennas, so you don\'t know, which distance corresponds to each antenna. Your task is to find a user\'s location given as little as all antennas location and an unordered multiset of distances." geometry 3400
1394E "Boboniu and Banknote Collection" "No matter what trouble you\'re in, don\'t be afraid, but face it with a smile.I\'ve made another billion dollars! \xe2\x80\x94 BoboniuBoboniu has issued his currencies, named Bobo Yuan. Bobo Yuan (BBY) is a series of currencies. Boboniu gives each of them a positive integer identifier, such as BBY-1, BBY-2, etc.Boboniu has a BBY collection. His collection looks like a sequence. For example:  We can use sequence a=[1,2,3,3,2,1,4,4,1] of length n=9 to denote it.Now Boboniu wants to fold his collection. You can imagine that Boboniu stick his collection to a long piece of paper and fold it between currencies:  Boboniu will only fold the same identifier of currencies together. In other words, if ai is folded over aj (1\xe2\x89\xa4i,j\xe2\x89\xa4n), then ai=aj must hold. Boboniu doesn\'t care if you follow this rule in the process of folding. But once it is finished, the rule should be obeyed.A formal definition of fold is described in notes.According to the picture above, you can fold a two times. In fact, you can fold a=[1,2,3,3,2,1,4,4,1] at most two times. So the maximum number of folds of it is 2.As an international fan of Boboniu, you\'re asked to calculate the maximum number of folds. You\'re given a sequence a of length n, for each i (1\xe2\x89\xa4i\xe2\x89\xa4n), you need to calculate the maximum number of folds of [a1,a2,\xe2\x80\xa6,ai]." strings 3500
1277A "Happy Birthday, Polycarp!" "Hooray! Polycarp turned n years old! The Technocup Team sincerely congratulates Polycarp!Polycarp celebrated all of his n birthdays: from the 1-th to the n-th. At the moment, he is wondering: how many times he turned beautiful number of years?According to Polycarp, a positive integer is beautiful if it consists of only one digit repeated one or more times. For example, the following numbers are beautiful: 1, 77, 777, 44 and 999999. The following numbers are not beautiful: 12, 11110, 6969 and 987654321.Of course, Polycarpus uses the decimal numeral system (i.e. radix is 10).Help Polycarpus to find the number of numbers from 1 to n (inclusive) that are beautiful." implementation 1000
1175C Electrification "At first, there was a legend related to the name of the problem, but now it\'s just a formal statement.You are given n points a1,a2,\xe2\x80\xa6,an on the OX axis. Now you are asked to find such an integer point x on OX axis that fk(x) is minimal possible.The function fk(x) can be described in the following way:   form a list of distances d1,d2,\xe2\x80\xa6,dn where di=|ai\xe2\x88\x92x| (distance between ai and x);  sort list d in non-descending order;  take dk+1 as a result. If there are multiple optimal answers you can print any of them." "binary search,brute force,greedy" 1600
1001E "Distinguish Bell states" "You are given two qubits which are guaranteed to be in one of the Bell states:    Your task is to perform necessary operations and measurements to figure out which state it was and to return the index of that state (0 for , 1 for  etc.). The state of the qubits after the operations does not matter." "*special problem" 1600
449D "Jzzhu and Numbers" "Jzzhu have n non-negative integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. We will call a sequence of indexes i1,\xe2\x80\x89i2,\xe2\x80\x89...,\xe2\x80\x89ik (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i1\xe2\x80\x89<\xe2\x80\x89i2\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89ik\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) a group of size k. Jzzhu wonders, how many groups exists such that ai1 & ai2 & ... & aik\xe2\x80\x89=\xe2\x80\x890 (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n)? Help him and print this number modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897). Operation x & y denotes bitwise AND operation of two numbers." bitmasks,combinatorics,dp 2400
1030B "Vasya and Cornfield" "Vasya owns a cornfield which can be defined with two integers n and d. The cornfield can be represented as rectangle with vertices having Cartesian coordinates (0,d),(d,0),(n,n\xe2\x88\x92d) and (n\xe2\x88\x92d,n).  An example of a cornfield with n=7 and d=2. Vasya also knows that there are m grasshoppers near the field (maybe even inside it). The i-th grasshopper is at the point (xi,yi). Vasya does not like when grasshoppers eat his corn, so for each grasshopper he wants to know whether its position is inside the cornfield (including the border) or outside.Help Vasya! For each grasshopper determine if it is inside the field (including the border)." geometry 1100
1737F "Ela and Prime GCD" "After a long, tough, but fruitful day at DTL, Ela goes home happily. She entertains herself by solving Competitive Programming problems. She prefers short statements, because she already read too many long papers and documentation at work. The problem of the day reads:You are given an integer c. Suppose that c has n divisors. You have to find a sequence with n\xe2\x88\x921 integers [a1,a2,...an\xe2\x88\x921], which satisfies the following conditions:  Each element is strictly greater than 1.  Each element is a divisor of c.  All elements are distinct.  For all 1\xe2\x89\xa4i<n\xe2\x88\x921, gcd(ai,ai+1) is a prime number. In this problem, because c can be too big, the result of prime factorization of c is given instead. Note that gcd(x,y) denotes the greatest common divisor (GCD) of integers x and y and a prime number is a positive integer which has exactly 2 divisors." "constructive algorithms,math,number theory" 3300
768D "Jon and Orbs" "Jon Snow is on the lookout for some orbs required to defeat the white walkers. There are k different types of orbs and he needs at least one of each. One orb spawns daily at the base of a Weirwood tree north of the wall. The probability of this orb being of any kind is equal. As the north of wall is full of dangers, he wants to know the minimum number of days he should wait before sending a ranger to collect the orbs such that the probability of him getting at least one of each kind of orb is at least , where \xce\xb5\xe2\x80\x89<\xe2\x80\x8910\xe2\x80\x89-\xe2\x80\x897.To better prepare himself, he wants to know the answer for q different values of pi. Since he is busy designing the battle strategy with Sam, he asks you for your help." dp,math,probabilities 2200
506E "Mr. Kitayuta\'s Gift" "Mr. Kitayuta has kindly given you a string s consisting of lowercase English letters. You are asked to insert exactly n lowercase English letters into s to make it a palindrome. (A palindrome is a string that reads the same forward and backward. For example, ""noon"", ""testset"" and ""a"" are all palindromes, while ""test"" and ""kitayuta"" are not.) You can choose any n lowercase English letters, and insert each of them to any position of s, possibly to the beginning or the end of s. You have to insert exactly n letters even if it is possible to turn s into a palindrome by inserting less than n letters.Find the number of the palindromes that can be obtained in this way, modulo 10007." combinatorics,dp,matrices,strings 3000
1530F Bingo "Getting ready for VK Fest 2021, you prepared a table with n rows and n columns, and filled each cell of this table with some event related with the festival that could either happen or not: for example, whether you will win a prize on the festival, or whether it will rain.Forecasting algorithms used in VK have already estimated the probability for each event to happen. Event in row i and column j will happen with probability ai,j\xe2\x8b\x8510\xe2\x88\x924. All of the events are mutually independent.Let\'s call the table winning if there exists a line such that all n events on it happen. The line could be any horizontal line (cells (i,1),(i,2),\xe2\x80\xa6,(i,n) for some i), any vertical line (cells (1,j),(2,j),\xe2\x80\xa6,(n,j) for some j), the main diagonal (cells (1,1),(2,2),\xe2\x80\xa6,(n,n)), or the antidiagonal (cells (1,n),(2,n\xe2\x88\x921),\xe2\x80\xa6,(n,1)).Find the probability of your table to be winning, and output it modulo 31607 (see Output section)." bitmasks,combinatorics,dp,math,probabilities 2600
93D Flags "When Igor K. was a freshman, his professor strictly urged him, as well as all other freshmen, to solve programming Olympiads. One day a problem called ""Flags"" from a website called Timmy\'s Online Judge caught his attention. In the problem one had to find the number of three-colored flags that would satisfy the condition... actually, it doesn\'t matter. Igor K. quickly found the formula and got the so passionately desired Accepted.However, the professor wasn\'t very much impressed. He decided that the problem represented on Timmy\'s Online Judge was very dull and simple: it only had three possible colors of flag stripes and only two limitations. He suggested a complicated task to Igor K. and the fellow failed to solve it. Of course, we won\'t tell anybody that the professor couldn\'t solve it as well.And how about you? Can you solve the problem?The flags consist of one or several parallel stripes of similar width. The stripes can be one of the following colors: white, black, red or yellow. You should find the number of different flags with the number of stripes from L to R, if:  a flag cannot have adjacent stripes of one color;  a flag cannot have adjacent white and yellow stripes;  a flag cannot have adjacent red and black stripes;  a flag cannot have the combination of black, white and red stripes following one after another in this or reverse order;  symmetrical flags (as, for example, a WB and a BW flag, where W and B stand for the white and black colors) are considered the same." dp,math,matrices 2500
1714C "Minimum  Varied Number" "Find the minimum number with the given sum of digits s such that all digits in it are distinct (i.e. all digits are unique).For example, if s=20, then the answer is 389. This is the minimum number in which all digits are different and the sum of the digits is 20 (3+8+9=20).For the given s print the required number." greedy 800
1360H "Binary Median" "Consider all binary strings of length m (1\xe2\x89\xa4m\xe2\x89\xa460). A binary string is a string that consists of the characters 0 and 1 only. For example, 0110 is a binary string, and 012aba is not. Obviously, there are exactly 2m such strings in total.The string s is lexicographically smaller than the string t (both have the same length m) if in the first position i from the left in which they differ, we have s[i]<t[i]. This is exactly the way strings are compared in dictionaries and in most modern programming languages when comparing them in a standard way. For example, the string 01011 is lexicographically smaller than the string 01100, because the first two characters are the same, and the third character in the first string is less than that in the second.We remove from this set n (1\xe2\x89\xa4n\xe2\x89\xa4min(2m\xe2\x88\x921,100)) distinct binary strings a1,a2,\xe2\x80\xa6,an, each of length m. Thus, the set will have k=2m\xe2\x88\x92n strings. Sort all strings of the resulting set in lexicographical ascending order (as in the dictionary).We number all the strings after sorting from 0 to k\xe2\x88\x921. Print the string whose index is \xe2\x8c\x8ak\xe2\x88\x9212\xe2\x8c\x8b (such an element is called median), where \xe2\x8c\x8ax\xe2\x8c\x8b is the rounding of the number down to the nearest integer.For example, if n=3, m=3 and a=[010, 111, 001], then after removing the strings ai and sorting, the result will take the form: [000, 011, 100, 101, 110]. Thus, the desired median is 100." "binary search,bitmasks,brute force,constructive algorithms" 2100
466D "Increase Sequence" "Peter has a sequence of integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. Peter wants all numbers in the sequence to equal h. He can perform the operation of ""adding one on the segment [l,\xe2\x80\x89r]"": add one to all elements of the sequence with indices from l to r (inclusive). At that, Peter never chooses any element as the beginning of the segment twice. Similarly, Peter never chooses any element as the end of the segment twice. In other words, for any two segments [l1,\xe2\x80\x89r1] and [l2,\xe2\x80\x89r2], where Peter added one, the following inequalities hold: l1\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89l2 and r1\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89r2.How many distinct ways are there to make all numbers in the sequence equal h? Print this number of ways modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897). Two ways are considered distinct if one of them has a segment that isn\'t in the other way." combinatorics,dp 2100
1217E "Sum Queries?" "Let\'s define a balanced multiset the following way. Write down the sum of all elements of the multiset in its decimal representation. For each position of that number check if the multiset includes at least one element such that the digit of the element and the digit of the sum at that position are the same. If that holds for every position, then the multiset is balanced. Otherwise it\'s unbalanced.For example, multiset {20,300,10001}{20,300,10001} is balanced and multiset {20,310,10001}{20,310,10001} is unbalanced:   The red digits mark the elements and the positions for which these elements have the same digit as the sum. The sum of the first multiset is 1032110321, every position has the digit required. The sum of the second multiset is 1033110331 and the second-to-last digit doesn\'t appear in any number, thus making the multiset unbalanced.You are given an array a1,a2,\xe2\x80\xa6,ana1,a2,\xe2\x80\xa6,an, consisting of nn integers.You are asked to perform some queries on it. The queries can be of two types:  1 i x1 i x \xe2\x80\x94 replace aiai with the value xx;  2 l r2 l r \xe2\x80\x94 find the unbalanced subset of the multiset of the numbers al,al+1,\xe2\x80\xa6,aral,al+1,\xe2\x80\xa6,ar with the minimum sum, or report that no unbalanced subset exists. Note that the empty multiset is balanced.For each query of the second type print the lowest sum of the unbalanced subset. Print -1 if no unbalanced subset exists." "data structures,greedy,implementation,math" 2300
629C "Famil Door and Brackets" "As Famil Door\xe2\x80\x99s birthday is coming, some of his friends (like Gabi) decided to buy a present for him. His friends are going to buy a string consisted of round brackets since Famil Door loves string of brackets of length n more than any other strings!The sequence of round brackets is called valid if and only if:   the total number of opening brackets is equal to the total number of closing brackets;  for any prefix of the sequence, the number of opening brackets is greater or equal than the number of closing brackets. Gabi bought a string s of length m (m\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) and want to complete it to obtain a valid sequence of brackets of length n. He is going to pick some strings p and q consisting of round brackets and merge them in a string p\xe2\x80\x89+\xe2\x80\x89s\xe2\x80\x89+\xe2\x80\x89q, that is add the string p at the beginning of the string s and string q at the end of the string s.Now he wonders, how many pairs of strings p and q exists, such that the string p\xe2\x80\x89+\xe2\x80\x89s\xe2\x80\x89+\xe2\x80\x89q is a valid sequence of round brackets. As this number may be pretty large, he wants to calculate it modulo 109\xe2\x80\x89+\xe2\x80\x897." dp,strings 2000
1286B "Numbers on Tree" "Evlampiy was gifted a rooted tree. The vertices of the tree are numbered from 1 to n. Each of its vertices also has an integer ai written on it. For each vertex i, Evlampiy calculated ci \xe2\x80\x94 the number of vertices j in the subtree of vertex i, such that aj<ai. Illustration for the second example, the first integer is ai and the integer in parentheses is ciAfter the new year, Evlampiy could not remember what his gift was! He remembers the tree and the values of ci, but he completely forgot which integers ai were written on the vertices.Help him to restore initial integers!" "constructive algorithms,data structures,dfs and similar,graphs,greedy,trees" 1800
530A "Quadratic equation" "You are given a quadratic equation with integer coefficients A\xe2\x80\x89*\xe2\x80\x89X2\xe2\x80\x89+\xe2\x80\x89B\xe2\x80\x89*\xe2\x80\x89X\xe2\x80\x89+\xe2\x80\x89C\xe2\x80\x89=\xe2\x80\x890. It is guaranteed that A\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x890 and that the equation has at least one real root. Output the roots of the equation." "*special problem" 1500
801A "Vicious Keyboard" "Tonio has a keyboard with only two letters, ""V"" and ""K"".One day, he has typed out a string s with only these two letters. He really likes it when the string ""VK"" appears, so he wishes to change at most one letter in the string (or do no changes) to maximize the number of occurrences of that string. Compute the maximum number of times ""VK"" can appear as a substring (i. e. a letter ""K"" right after a letter ""V"") in the resulting string." "brute force" 1100
1560F2 "Nearest Beautiful Number (hard version)" "It is a complicated version of problem F1. The difference between them is the constraints (F1: k\xe2\x89\xa42, F2: k\xe2\x89\xa410).You are given an integer n. Find the minimum integer x such that x\xe2\x89\xa5n and the number x is k-beautiful.A number is called k-beautiful if its decimal representation having no leading zeroes contains no more than k different digits. E.g. if k=2, the numbers 3434443, 55550, 777 and 21 are k-beautiful whereas the numbers 120, 445435 and 998244353 are not." "bitmasks,brute force,constructive algorithms,dfs and similar,dp,greedy" 2100
1476G "Minimum Difference" "You are given an integer array a of size n.You have to perform m queries. Each query has one of two types:   ""1 l r k"" \xe2\x80\x94 calculate the minimum value dif such that there are exist k distinct integers x1,x2,\xe2\x80\xa6,xk such that cnti>0 (for every i\xe2\x88\x88[1,k]) and |cnti\xe2\x88\x92cntj|\xe2\x89\xa4dif (for every i\xe2\x88\x88[1,k],j\xe2\x88\x88[1,k]), where cnti is the number of occurrences of xi in the subarray a[l..r]. If it is impossible to choose k integers, report it;  ""2 p x"" \xe2\x80\x94 assign ap:=x." "data structures,hashing,sortings,two pointers" 3100
1304F2 "Animal Observation (hard version)" "The only difference between easy and hard versions is the constraint on k.Gildong loves observing animals, so he bought two cameras to take videos of wild animals in a forest. The color of one camera is red, and the other one\'s color is blue.Gildong is going to take videos for n days, starting from day 1 to day n. The forest can be divided into m areas, numbered from 1 to m. He\'ll use the cameras in the following way:   On every odd day (1-st, 3-rd, 5-th, ...), bring the red camera to the forest and record a video for 2 days.  On every even day (2-nd, 4-th, 6-th, ...), bring the blue camera to the forest and record a video for 2 days.  If he starts recording on the n-th day with one of the cameras, the camera records for only one day. Each camera can observe k consecutive areas of the forest. For example, if m=5 and k=3, he can put a camera to observe one of these three ranges of areas for two days: [1,3], [2,4], and [3,5].Gildong got information about how many animals will be seen in each area on each day. Since he would like to observe as many animals as possible, he wants you to find the best way to place the two cameras for n days. Note that if the two cameras are observing the same area on the same day, the animals observed in that area are counted only once." "data structures,dp,greedy" 2400
1896E "Permutation Sorting" "You are given a permutation\xe2\x80\xa0 a of size n. We call an index i good if ai=i is satisfied. After each second, we rotate all indices that are not good to the right by one position. Formally,  Let s1,s2,\xe2\x80\xa6,sk be the indices of a that are not good in increasing order. That is, sj<sj+1 and if index i is not good, then there exists j such that sj=i.  For each i from 1 to k, we assign as(i%k+1):=asi all at once. For each i from 1 to n, find the first time that index i becomes good. \xe2\x80\xa0 A permutation is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array) and [1,3,4] is also not a permutation (n=3 but there is 4 in the array)." "data structures,sortings" 2100
13D Triangles "Little Petya likes to draw. He drew N red and M blue points on the plane in such a way that no three points lie on the same line. Now he wonders what is the number of distinct triangles with vertices in red points which do not contain any blue point inside." dp,geometry 2600
1090M "The Pleasant Walk" "There are n houses along the road where Anya lives, each one is painted in one of k possible colors.Anya likes walking along this road, but she doesn\'t like when two adjacent houses at the road have the same color. She wants to select a long segment of the road such that no two adjacent houses have the same color.Help Anya find the longest segment with this property." implementation 1000
978G "Petya\'s Exams" "Petya studies at university. The current academic year finishes with n special days. Petya needs to pass m exams in those special days. The special days in this problem are numbered from 1 to n.There are three values about each exam:  si \xe2\x80\x94 the day, when questions for the i-th exam will be published,  di \xe2\x80\x94 the day of the i-th exam (si<di),  ci \xe2\x80\x94 number of days Petya needs to prepare for the i-th exam. For the i-th exam Petya should prepare in days between si and di\xe2\x88\x921, inclusive. There are three types of activities for Petya in each day: to spend a day doing nothing (taking a rest), to spend a day passing exactly one exam or to spend a day preparing for exactly one exam. So he can\'t pass/prepare for multiple exams in a day. He can\'t mix his activities in a day. If he is preparing for the i-th exam in day j, then si\xe2\x89\xa4j<di.It is allowed to have breaks in a preparation to an exam and to alternate preparations for different exams in consecutive days. So preparation for an exam is not required to be done in consecutive days.Find the schedule for Petya to prepare for all exams and pass them, or report that it is impossible." greedy,implementation,sortings 1700
1373E "Sum of Digits" "Let f(x) be the sum of digits of a decimal number x.Find the smallest non-negative integer x such that f(x)+f(x+1)+\xe2\x8b\xaf+f(x+k)=n." "brute force,constructive algorithms,dp,greedy" 2200
1817B "Fish Graph" "You are given a simple undirected graph with n nodes and m edges. Note that the graph is not necessarily connected. The nodes are labeled from 1 to n.We define a graph to be a Fish Graph if it contains a simple cycle with a special node u belonging to the cycle. Apart from the edges in the cycle, the graph should have exactly 2 extra edges. Both edges should connect to node u, but they should not be connected to any other node of the cycle. Determine if the graph contains a subgraph that is a Fish Graph, and if so, find any such subgraph.In this problem, we define a subgraph as a graph obtained by taking any subset of the edges of the original graph.  Visualization of example 1. The red edges form one possible subgraph that is a Fish Graph." "brute force,constructive algorithms,dfs and similar,graphs" 1900
1630A "And Matching" "You are given a set of n (n is always a power of 2) elements containing all integers 0,1,2,\xe2\x80\xa6,n\xe2\x88\x921 exactly once.Find n2 pairs of elements such that:  Each element in the set is in exactly one pair.  The sum over all pairs of the bitwise AND of its elements must be exactly equal to k. Formally, if ai and bi are the elements of the i-th pair, then the following must hold: n/2\xe2\x88\x91i=1ai&bi=k, where & denotes the bitwise AND operation. If there are many solutions, print any of them, if there is no solution, print \xe2\x88\x921 instead." "bitmasks,constructive algorithms" 1500
1311F "Moving Points" "There are n points on a coordinate axis OX. The i-th point is located at the integer point xi and has a speed vi. It is guaranteed that no two points occupy the same coordinate. All n points move with the constant speed, the coordinate of the i-th point at the moment t (t can be non-integer) is calculated as xi+t\xe2\x8b\x85vi.Consider two points i and j. Let d(i,j) be the minimum possible distance between these two points over any possible moments of time (even non-integer). It means that if two points i and j coincide at some moment, the value d(i,j) will be 0.Your task is to calculate the value \xe2\x88\x911\xe2\x89\xa4i<j\xe2\x89\xa4n d(i,j) (the sum of minimum distances over all pairs of points)." "data structures,divide and conquer,implementation,sortings" 1900
1358B "Maria Breaks the Self-isolation" "Maria is the most active old lady in her house. She was tired of sitting at home. She decided to organize a ceremony against the coronavirus.She has n friends who are also grannies (Maria is not included in this number). The i-th granny is ready to attend the ceremony, provided that at the time of her appearance in the courtyard there will be at least ai other grannies there. Note that grannies can come into the courtyard at the same time. Formally, the granny i agrees to come if the number of other grannies who came earlier or at the same time with her is greater than or equal to ai.Grannies gather in the courtyard like that.  Initially, only Maria is in the courtyard (that is, the initial number of grannies in the courtyard is 1). All the remaining n grannies are still sitting at home. On each step Maria selects a subset of grannies, none of whom have yet to enter the courtyard. She promises each of them that at the time of her appearance there will be at least ai other grannies (including Maria) in the courtyard. Maria can call several grannies at once. In this case, the selected grannies will go out into the courtyard at the same moment of time. She cannot deceive grannies, that is, the situation when the i-th granny in the moment of appearing in the courtyard, finds that now there are strictly less than ai other grannies (except herself, but including Maria), is prohibited. Please note that if several grannies appeared in the yard at the same time, then each of them sees others at the time of appearance. Your task is to find what maximum number of grannies (including herself) Maria can collect in the courtyard for the ceremony. After all, the more people in one place during quarantine, the more effective the ceremony!Consider an example: if n=6 and a=[1,5,4,5,1,9], then:  at the first step Maria can call grannies with numbers 1 and 5, each of them will see two grannies at the moment of going out into the yard (note that a1=1\xe2\x89\xa42 and a5=1\xe2\x89\xa42);  at the second step, Maria can call grannies with numbers 2, 3 and 4, each of them will see five grannies at the moment of going out into the yard (note that a2=5\xe2\x89\xa45, a3=4\xe2\x89\xa45 and a4=5\xe2\x89\xa45);  the 6-th granny cannot be called into the yard  \xe2\x80\x94 therefore, the answer is 6 (Maria herself and another 5 grannies)." greedy,sortings 1000
854A Fraction "Petya is a big fan of mathematics, especially its part related to fractions. Recently he learned that a fraction  is called proper iff its numerator is smaller than its denominator (a\xe2\x80\x89<\xe2\x80\x89b) and that the fraction is called irreducible if its numerator and its denominator are coprime (they do not have positive common divisors except 1).During his free time, Petya thinks about proper irreducible fractions and converts them to decimals using the calculator. One day he mistakenly pressed addition button (\xe2\x80\x89+\xe2\x80\x89) instead of division button (\xc3\xb7) and got sum of numerator and denominator that was equal to n instead of the expected decimal notation. Petya wanted to restore the original fraction, but soon he realized that it might not be done uniquely. That\'s why he decided to determine maximum possible proper irreducible fraction  such that sum of its numerator and denominator equals n. Help Petya deal with this problem." "brute force,constructive algorithms,math" 800
1901D "Yet Another Monster Fight" "Vasya is a sorcerer that fights monsters. Again. There are n monsters standing in a row, the amount of health points of the i-th monster is ai.Vasya is a very powerful sorcerer who knows many overpowered spells. In this fight, he decided to use a chain lightning spell to defeat all the monsters. Let\'s see how this spell works.Firstly, Vasya chooses an index i of some monster (1\xe2\x89\xa4i\xe2\x89\xa4n) and the initial power of the spell x. Then the spell hits monsters exactly n times, one hit per monster. The first target of the spell is always the monster i. For every target except for the first one, the chain lightning will choose a random monster who was not hit by the spell and is adjacent to one of the monsters that already was hit. So, each monster will be hit exactly once. The first monster hit by the spell receives x damage, the second monster receives (x\xe2\x88\x921) damage, the third receives (x\xe2\x88\x922) damage, and so on.Vasya wants to show how powerful he is, so he wants to kill all the monsters with a single chain lightning spell. The monster is considered dead if the damage he received is not less than the amount of its health points. On the other hand, Vasya wants to show he doesn\'t care that much, so he wants to choose the minimum initial power of the spell x such that it kills all monsters, no matter which monster (among those who can get hit) gets hit on each step.Of course, Vasya is a sorcerer, but the amount of calculations required to determine the optimal spell setup is way above his possibilities, so you have to help him find the minimum spell power required to kill all the monsters.Note that Vasya chooses the initial target and the power of the spell, other things should be considered random and Vasya wants to kill all the monsters even in the worst possible scenario." "binary search,dp,greedy,implementation,math" 1700
1093D "Beautiful Graph" "You are given an undirected unweighted graph consisting of n vertices and m edges.You have to write a number on each vertex of the graph. Each number should be 1, 2 or 3. The graph becomes beautiful if for each edge the sum of numbers on vertices connected by this edge is odd.Calculate the number of possible ways to write numbers 1, 2 and 3 on vertices so the graph becomes beautiful. Since this number may be large, print it modulo 998244353.Note that you have to write exactly one number on each vertex.The graph does not have any self-loops or multiple edges." "dfs and similar,graphs" 1700
556A "Case of the Zeros and Ones" "Andrewid the Android is a galaxy-famous detective. In his free time he likes to think about strings containing zeros and ones.Once he thought about a string of length n consisting of zeroes and ones. Consider the following operation: we choose any two adjacent positions in the string, and if one them contains 0, and the other contains 1, then we are allowed to remove these two digits from the string, obtaining a string of length n\xe2\x80\x89-\xe2\x80\x892 as a result.Now Andreid thinks about what is the minimum length of the string that can remain after applying the described operation several times (possibly, zero)? Help him to calculate this number." greedy 900
1958A 1-3-5 "In Berland, coins of worth 1, 3 and 5 burles are commonly used (burles are local currency).Eva has to pay exactly n burles in a shop. She has an infinite amount of coins of all three types. However, she doesn\'t like to pay using coins worth 1 burle \xe2\x80\x94 she thinks they are the most convenient to use.Help Eva to calculate the minimum number of coins worth 1 burle she has to use, if she has to pay exactly n burles. Note that she can spend any number of coins worth 3 and/or 5 burles." "*special problem,dp" 1100
1696A "NIT orz!" "NIT, the cleaver, is new in town! Thousands of people line up to orz him. To keep his orzers entertained, NIT decided to let them solve the following problem related to orz. Can you solve this problem too?You are given a 1-indexed array of n integers, a, and an integer z. You can do the following operation any number (possibly zero) of times:  Select a positive integer i such that 1\xe2\x89\xa4i\xe2\x89\xa4n. Then, simutaneously set ai to (aiorz) and set z to (aiandz). In other words, let x and y respectively be the current values of ai and z. Then set ai to (xory) and set z to (xandy). Here or and and denote the bitwise operations OR and AND respectively.Find the maximum possible value of the maximum value in a after any number (possibly zero) of operations." bitmasks,greedy 800
321A "Ciel and Robot" "Fox Ciel has a robot on a 2D plane. Initially it is located in (0, 0). Fox Ciel code a command to it. The command was represented by string s. Each character of s is one move operation. There are four move operations at all:  \'U\': go up, (x, y) \xe2\x80\x89\xe2\x86\x92\xe2\x80\x89 (x, y+1);  \'D\': go down, (x, y) \xe2\x80\x89\xe2\x86\x92\xe2\x80\x89 (x, y-1);  \'L\': go left, (x, y) \xe2\x80\x89\xe2\x86\x92\xe2\x80\x89 (x-1, y);  \'R\': go right, (x, y) \xe2\x80\x89\xe2\x86\x92\xe2\x80\x89 (x+1, y). The robot will do the operations in s from left to right, and repeat it infinite times. Help Fox Ciel to determine if after some steps the robot will located in (a,\xe2\x80\x89b)." "binary search,implementation,math" 1700
1073B "Vasya and Books" "Vasya has got n books, numbered from 1 to n, arranged in a stack. The topmost book has number a1, the next one \xe2\x80\x94 a2, and so on. The book at the bottom of the stack has number an. All numbers are distinct.Vasya wants to move all the books to his backpack in n steps. During i-th step he wants to move the book number bi into his backpack. If the book with number bi is in the stack, he takes this book and all the books above the book bi, and puts them into the backpack; otherwise he does nothing and begins the next step. For example, if books are arranged in the order [1,2,3] (book 1 is the topmost), and Vasya moves the books in the order [2,1,3], then during the first step he will move two books (1 and 2), during the second step he will do nothing (since book 1 is already in the backpack), and during the third step \xe2\x80\x94 one book (the book number 3). Note that b1,b2,\xe2\x80\xa6,bn are distinct.Help Vasya! Tell him the number of books he will put into his backpack during each step." implementation,math 1000
162G "Non-decimal sum" "You are given an array of integers written in base radix. Calculate their sum and output it written in the same base." "*special problem" 2000
10E "Greedy Change" "Billy investigates the question of applying greedy algorithm to different spheres of life. At the moment he is studying the application of greedy algorithm to the problem about change. There is an amount of n coins of different face values, and the coins of each value are not limited in number. The task is to collect the sum x with the minimum amount of coins. Greedy algorithm with each its step takes the coin of the highest face value, not exceeding x. Obviously, if among the coins\' face values exists the face value 1, any sum x can be collected with the help of greedy algorithm. However, greedy algorithm does not always give the optimal representation of the sum, i.e. the representation with the minimum amount of coins. For example, if there are face values {1,\xe2\x80\x893,\xe2\x80\x894} and it is asked to collect the sum 6, greedy algorithm will represent the sum as 4\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x891, while the optimal representation is 3\xe2\x80\x89+\xe2\x80\x893, containing one coin less. By the given set of face values find out if there exist such a sum x that greedy algorithm will collect in a non-optimal way. If such a sum exists, find out the smallest of these sums." "constructive algorithms" 2600
330B "Road Construction" "A country has n cities. Initially, there is no road in the country. One day, the king decides to construct some roads connecting pairs of cities. Roads can be traversed either way. He wants those roads to be constructed in such a way that it is possible to go from each city to any other city by traversing at most two roads. You are also given m pairs of cities \xe2\x80\x94 roads cannot be constructed between these pairs of cities.Your task is to construct the minimum number of roads that still satisfy the above conditions. The constraints will guarantee that this is always possible." "constructive algorithms,graphs" 1300
1362C "Johnny and Another Rating Drop" "The last contest held on Johnny\'s favorite competitive programming platform has been received rather positively. However, Johnny\'s rating has dropped again! He thinks that the presented tasks are lovely, but don\'t show the truth about competitors\' skills.The boy is now looking at the ratings of consecutive participants written in a binary system. He thinks that the more such ratings differ, the more unfair is that such people are next to each other. He defines the difference between two numbers as the number of bit positions, where one number has zero, and another has one (we suppose that numbers are padded with leading zeros to the same length). For example, the difference of 5=1012 and 14=11102 equals to 3, since 0101 and 1110 differ in 3 positions. Johnny defines the unfairness of the contest as the sum of such differences counted for neighboring participants.Johnny has just sent you the rating sequence and wants you to find the unfairness of the competition. You have noticed that you\'ve got a sequence of consecutive integers from 0 to n. That\'s strange, but the boy stubbornly says that everything is right. So help him and find the desired unfairness for received numbers." bitmasks,greedy,math 1400
1702F "Equate Multisets" "Multiset \xe2\x80\x94is a set of numbers in which there can be equal elements, and the order of the numbers does not matter. Two multisets are equal when each value occurs the same number of times. For example, the multisets {2,2,4} and {2,4,2} are equal, but the multisets {1,2,2} and {1,1,2} \xe2\x80\x94 are not.You are given two multisets a and b, each consisting of n integers.In a single operation, any element of the b multiset can be doubled or halved (rounded down). In other words, you have one of the following operations available for an element x of the b multiset:   replace x with x\xe2\x8b\x852,  or replace x with \xe2\x8c\x8ax2\xe2\x8c\x8b (round down).  Note that you cannot change the elements of the a multiset.See if you can make the multiset b become equal to the multiset a in an arbitrary number of operations (maybe 0).For example, if n=4, a={4,24,5,2}, b={4,1,6,11}, then the answer is yes. We can proceed as follows:   Replace 1 with 1\xe2\x8b\x852=2. We get b={4,2,6,11}.  Replace 11 with \xe2\x8c\x8a112\xe2\x8c\x8b=5. We get b={4,2,6,5}.  Replace 6 with 6\xe2\x8b\x852=12. We get b={4,2,12,5}.  Replace 12 with 12\xe2\x8b\x852=24. We get b={4,2,24,5}.  Got equal multisets a={4,24,5,2} and b={4,2,24,5}." "constructive algorithms,data structures,greedy,math,number theory" 1700
1267I "Intriguing Selection" "This is an interactive problem.You are the head coach of a chess club. The club has 2n players, each player has some strength which can be represented by a number, and all those numbers are distinct. The strengths of the players are not known to you.You need to select n players who would represent your club in the upcoming championship. Naturally, you want to select n players with the highest strengths.You can organize matches between the players to do that. In every match, you pick two players, they play some games, and you learn which one of the two has higher strength. You can wait for the outcome of a match before deciding who will participate in the next one.However, you do not want to know exactly how those n players compare between themselves, as that would make the championship itself less intriguing. More formally, you must reach a state where there is exactly one way to choose n players with the highest strengths that is consistent with the outcomes of the matches you organized, but there must be at least two possible orderings of those n players by strength that are consistent with the outcomes of the matches you organized." "brute force,constructive algorithms,implementation,interactive,sortings" 2600
488B "Candy Boxes" "There is an old tradition of keeping 4 boxes of candies in the house in Cyberland. The numbers of candies are special if their arithmetic mean, their median and their range are all equal. By definition, for a set {x1,\xe2\x80\x89x2,\xe2\x80\x89x3,\xe2\x80\x89x4} (x1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x3\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x4) arithmetic mean is , median is  and range is x4\xe2\x80\x89-\xe2\x80\x89x1. The arithmetic mean and median are not necessary integer. It is well-known that if those three numbers are same, boxes will create a ""debugging field"" and codes in the field will have no bugs.For example, 1,\xe2\x80\x891,\xe2\x80\x893,\xe2\x80\x893 is the example of 4 numbers meeting the condition because their mean, median and range are all equal to 2.Jeff has 4 special boxes of candies. However, something bad has happened! Some of the boxes could have been lost and now there are only n (0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x894) boxes remaining. The i-th remaining box contains ai candies.Now Jeff wants to know: is there a possible way to find the number of candies of the 4\xe2\x80\x89-\xe2\x80\x89n missing boxes, meeting the condition above (the mean, median and range are equal)?" "brute force,constructive algorithms,math" 1900
820A "Mister B and Book Reading" "Mister B once received a gift: it was a book about aliens, which he started read immediately. This book had c pages.At first day Mister B read v0 pages, but after that he started to speed up. Every day, starting from the second, he read a pages more than on the previous day (at first day he read v0 pages, at second \xe2\x80\x94 v0\xe2\x80\x89+\xe2\x80\x89a pages, at third \xe2\x80\x94 v0\xe2\x80\x89+\xe2\x80\x892a pages, and so on). But Mister B is just a human, so he physically wasn\'t able to read more than v1 pages per day.Also, to refresh his memory, every day, starting from the second, Mister B had to reread last l pages he read on the previous day. Mister B finished the book when he read the last page for the first time.Help Mister B to calculate how many days he needed to finish the book." implementation 900
1165F1 "Microtransactions (easy version)" "The only difference between easy and hard versions is constraints.Ivan plays a computer game that contains some microtransactions to make characters look cooler. Since Ivan wants his character to be really cool, he wants to use some of these microtransactions \xe2\x80\x94 and he won\'t start playing until he gets all of them.Each day (during the morning) Ivan earns exactly one burle.There are n types of microtransactions in the game. Each microtransaction costs 2 burles usually and 1 burle if it is on sale. Ivan has to order exactly ki microtransactions of the i-th type (he orders microtransactions during the evening).Ivan can order any (possibly zero) number of microtransactions of any types during any day (of course, if he has enough money to do it). If the microtransaction he wants to order is on sale then he can buy it for 1 burle and otherwise he can buy it for 2 burles.There are also m special offers in the game shop. The j-th offer (dj,tj) means that microtransactions of the tj-th type are on sale during the dj-th day.Ivan wants to order all microtransactions as soon as possible. Your task is to calculate the minimum day when he can buy all microtransactions he want and actually start playing." "binary search,greedy" 2000
1687E "Become Big For Me" "Come, let\'s build a world where even the weak are not forgotten!\xe2\x80\x94Kijin Seija, Double Dealing CharactersShinmyoumaru has a mallet that can turn objects bigger or smaller. She is testing it out on a sequence a and a number v whose initial value is 1. She wants to make v=gcdi\xe2\x89\xa0j{ai\xe2\x8b\x85aj} by no more than 105 operations (gcdi\xe2\x89\xa0j{ai\xe2\x8b\x85aj} denotes the gcd of all products of two distinct elements of the sequence a). In each operation, she picks a subsequence b of a, and does one of the followings:   Enlarge: v=v\xe2\x8b\x85lcm(b)  Reduce: v=vlcm(b) Note that she does not need to guarantee that v is an integer, that is, v does not need to be a multiple of lcm(b) when performing Reduce.Moreover, she wants to guarantee that the total length of b chosen over the operations does not exceed 106. Fine a possible operation sequence for her. You don\'t need to minimize anything." "combinatorics,constructive algorithms,greedy,math,number theory" 3500
809E "Surprise me!" "Tired of boring dates, Leha and Noora decided to play a game.Leha found a tree with n vertices numbered from 1 to n. We remind you that tree is an undirected graph without cycles. Each vertex v of a tree has a number av written on it. Quite by accident it turned out that all values written on vertices are distinct and are natural numbers between 1 and n.The game goes in the following way. Noora chooses some vertex u of a tree uniformly at random and passes a move to Leha. Leha, in his turn, chooses (also uniformly at random) some vertex v from remaining vertices of a tree (v\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89u). As you could guess there are n(n\xe2\x80\x89-\xe2\x80\x891) variants of choosing vertices by players. After that players calculate the value of a function f(u,\xe2\x80\x89v)\xe2\x80\x89=\xe2\x80\x89\xcf\x86(au\xc2\xb7av) \xc2\xb7 d(u,\xe2\x80\x89v) of the chosen vertices where \xcf\x86(x) is Euler\'s totient function and d(x,\xe2\x80\x89y) is the shortest distance between vertices x and y in a tree.Soon the game became boring for Noora, so Leha decided to defuse the situation and calculate expected value of function f over all variants of choosing vertices u and v, hoping of at least somehow surprise the girl.Leha asks for your help in calculating this expected value. Let this value be representable in the form of an irreducible fraction . To further surprise Noora, he wants to name her the value . Help Leha!" "divide and conquer,math,number theory,trees" 3100
601E "A Museum Robbery" "There\'s a famous museum in the city where Kleof\xc3\xa1\xc5\xa1 lives. In the museum, n exhibits (numbered 1 through n) had been displayed for a long time; the i-th of those exhibits has value vi and mass wi. Then, the museum was bought by a large financial group and started to vary the exhibits. At about the same time, Kleof\xc3\xa1\xc5\xa1... gained interest in the museum, so to say.You should process q events of three types: type 1 \xe2\x80\x94 the museum displays an exhibit with value v and mass w; the exhibit displayed in the i-th event of this type is numbered n\xe2\x80\x89+\xe2\x80\x89i (see sample explanation for more details) type 2 \xe2\x80\x94 the museum removes the exhibit with number x and stores it safely in its vault type 3 \xe2\x80\x94 Kleof\xc3\xa1\xc5\xa1 visits the museum and wonders (for no important reason at all, of course): if there was a robbery and exhibits with total mass at most m were stolen, what would their maximum possible total value be?For each event of type 3, let s(m) be the maximum possible total value of stolen exhibits with total mass \xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m.Formally, let D be the set of numbers of all exhibits that are currently displayed (so initially D = {1, ..., n}). Let P(D) be the set of all subsets of D and let Then, s(m) is defined as Compute s(m) for each . Note that the output follows a special format." "data structures,dp" 2800
616E "Sum of Remainders" "Calculate the value of the sum: n mod 1 + n mod 2 + n mod 3 + ... + n mod m. As the result can be very large, you should print the value modulo 109\xe2\x80\x89+\xe2\x80\x897 (the remainder when divided by 109\xe2\x80\x89+\xe2\x80\x897).The modulo operator a mod b stands for the remainder after dividing a by b. For example 10 mod 3 = 1." "implementation,math,number theory" 2200
675E "Trains and Statistic" "Vasya commutes by train every day. There are n train stations in the city, and at the i-th station it\'s possible to buy only tickets to stations from i\xe2\x80\x89+\xe2\x80\x891 to ai inclusive. No tickets are sold at the last station.Let \xcf\x81i,\xe2\x80\x89j be the minimum number of tickets one needs to buy in order to get from stations i to station j. As Vasya is fond of different useless statistic he asks you to compute the sum of all values \xcf\x81i,\xe2\x80\x89j among all pairs 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n." "data structures,dp,greedy" 2300
1214B Badges "There are b boys and g girls participating in Olympiad of Metropolises. There will be a board games tournament in the evening and n participants have accepted the invitation. The organizers do not know how many boys and girls are among them.Organizers are preparing red badges for girls and blue ones for boys.Vasya prepared n+1 decks of badges. The i-th (where i is from 0 to n, inclusive) deck contains i blue badges and n\xe2\x88\x92i red ones. The total number of badges in any deck is exactly n.Determine the minimum number of decks among these n+1 that Vasya should take, so that there will be a suitable deck no matter how many girls and boys there will be among the participants of the tournament." "brute force,math" 1100
1789D "Serval and Shift-Shift-Shift" "Serval has two n-bit binary integer numbers a and b. He wants to share those numbers with Toxel.Since Toxel likes the number b more, Serval decides to change a into b by some (possibly zero) operations. In an operation, Serval can choose any positive integer k between 1 and n, and change a into one of the following number:  a\xe2\x8a\x95(a\xe2\x89\xaak)  a\xe2\x8a\x95(a\xe2\x89\xabk) In other words, the operation moves every bit of a left or right by k positions, where the overflowed bits are removed, and the missing bits are padded with 0. The bitwise XOR of the shift result and the original a is assigned back to a.Serval does not have much time. He wants to perform no more than n operations to change a into b. Please help him to find out an operation sequence, or determine that it is impossible to change a into b in at most n operations. You do not need to minimize the number of operations. In this problem, x\xe2\x8a\x95y denotes the bitwise XOR operation of x and y. a\xe2\x89\xaak and a\xe2\x89\xabk denote the logical left shift and logical right shift." "bitmasks,brute force,constructive algorithms,implementation" 2200
1840C "Ski Resort" "Dima Vatrushin is a math teacher at school. He was sent on vacation for n days for his good work. Dima has long dreamed of going to a ski resort, so he wants to allocate several consecutive days and go skiing. Since the vacation requires careful preparation, he will only go for at least k days.You are given an array a containing the weather forecast at the resort. That is, on the i-th day, the temperature will be ai degrees.Dima was born in Siberia, so he can go on vacation only if the temperature does not rise above q degrees throughout the vacation.Unfortunately, Dima was so absorbed in abstract algebra that he forgot how to count. He asks you to help him and count the number of ways to choose vacation dates at the resort." "combinatorics,math,two pointers" 1000
766D "Mahmoud and a Dictionary" "Mahmoud wants to write a new dictionary that contains n words and relations between them. There are two types of relations: synonymy (i. e. the two words mean the same) and antonymy (i. e. the two words mean the opposite). From time to time he discovers a new relation between two words.He know that if two words have a relation between them, then each of them has relations with the words that has relations with the other. For example, if like means love and love is the opposite of hate, then like is also the opposite of hate. One more example: if love is the opposite of hate and hate is the opposite of like, then love means like, and so on.Sometimes Mahmoud discovers a wrong relation. A wrong relation is a relation that makes two words equal and opposite at the same time. For example if he knows that love means like and like is the opposite of hate, and then he figures out that hate means like, the last relation is absolutely wrong because it makes hate and like opposite and have the same meaning at the same time.After Mahmoud figured out many relations, he was worried that some of them were wrong so that they will make other relations also wrong, so he decided to tell every relation he figured out to his coder friend Ehab and for every relation he wanted to know is it correct or wrong, basing on the previously discovered relations. If it is wrong he ignores it, and doesn\'t check with following relations.After adding all relations, Mahmoud asked Ehab about relations between some words based on the information he had given to him. Ehab is busy making a Codeforces round so he asked you for help." "data structures,dfs and similar,dp,dsu,graphs" 2000
232E "Quick Tortoise" "John Doe has a field, which is a rectangular table of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m. We assume that the field rows are numbered from 1 to n from top to bottom, and the field columns are numbered from 1 to m from left to right. Then the cell of the field at the intersection of the x-th row and the y-th column has coordinates (x; y).We know that some cells of John\'s field are painted white, and some are painted black. Also, John has a tortoise, which can move along the white cells of the field. The tortoise can get from a white cell with coordinates (x; y) into cell (x\xe2\x80\x89+\xe2\x80\x891; y) or (x; y\xe2\x80\x89+\xe2\x80\x891), if the corresponding cell is painted white. In other words, the turtle can move only along the white cells of the field to the right or down. The turtle can not go out of the bounds of the field.In addition, John has q queries, each of them is characterized by four numbers x1,\xe2\x80\x89y1,\xe2\x80\x89x2,\xe2\x80\x89y2 (x1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x2, y1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y2). For each query John wants to know whether the tortoise can start from the point with coordinates (x1; y1), and reach the point with coordinates (x2; y2), moving only along the white squares of the field." "bitmasks,divide and conquer,dp" 3000
349A "Cinema Line" "The new ""Die Hard"" movie has just been released! There are n people at the cinema box office standing in a huge line. Each of them has a single 100, 50 or 25 ruble bill. A ""Die Hard"" ticket costs 25 rubles. Can the booking clerk sell a ticket to each person and give the change if he initially has no money and sells the tickets strictly in the order people follow in the line?" greedy,implementation 1100
1091C "New Year and the Sphere Transmission" "There are n people sitting in a circle, numbered from 1 to n in the order in which they are seated. That is, for all i from 1 to n\xe2\x88\x921, the people with id i and i+1 are adjacent. People with id n and 1 are adjacent as well.The person with id 1 initially has a ball. He picks a positive integer k at most n, and passes the ball to his k-th neighbour in the direction of increasing ids, that person passes the ball to his k-th neighbour in the same direction, and so on until the person with the id 1 gets the ball back. When he gets it back, people do not pass the ball any more.For instance, if n=6 and k=4, the ball is passed in order [1,5,3,1]. Consider the set of all people that touched the ball. The fun value of the game is the sum of the ids of people that touched it. In the above example, the fun value would be 1+5+3=9.Find and report the set of possible fun values for all choices of positive integer k. It can be shown that under the constraints of the problem, the ball always gets back to the 1-st player after finitely many steps, and there are no more than 105 possible fun values for given n." "math,number theory" 1400
1451B "Non-Substring Subsequence" "Hr0d1y has q queries on a binary string s of length n. A binary string is a string containing only characters \'0\' and \'1\'.A query is described by a pair of integers li, ri (1\xe2\x89\xa4li<ri\xe2\x89\xa4n). For each query, he has to determine whether there exists a good subsequence in s that is equal to the substring s[li\xe2\x80\xa6ri].   A substring s[i\xe2\x80\xa6j] of a string s is the string formed by characters sisi+1\xe2\x80\xa6sj. String a is said to be a subsequence of string b if a can be obtained from b by deleting some characters without changing the order of the remaining characters. A subsequence is said to be good if it is not contiguous and has length \xe2\x89\xa52. For example, if s is ""1100110"", then the subsequences s1s2s4 (""1100110"") and s1s5s7 (""1100110"") are good, while s1s2s3 (""1100110"") is not good. Can you help Hr0d1y answer each query?" dp,greedy,implementation,strings 900
380D "Sereja and Cinema" "The cinema theater hall in Sereja\'s city is n seats lined up in front of one large screen. There are slots for personal possessions to the left and to the right of each seat. Any two adjacent seats have exactly one shared slot. The figure below shows the arrangement of seats and slots for n\xe2\x80\x89=\xe2\x80\x894.  Today it\'s the premiere of a movie called ""Dry Hard"". The tickets for all the seats have been sold. There is a very strict controller at the entrance to the theater, so all n people will come into the hall one by one. As soon as a person enters a cinema hall, he immediately (momentarily) takes his seat and occupies all empty slots to the left and to the right from him. If there are no empty slots, the man gets really upset and leaves.People are not very constant, so it\'s hard to predict the order in which the viewers will enter the hall. For some seats, Sereja knows the number of the viewer (his number in the entering queue of the viewers) that will come and take this seat. For others, it can be any order. Being a programmer and a mathematician, Sereja wonders: how many ways are there for the people to enter the hall, such that nobody gets upset? As the number can be quite large, print it modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." combinatorics,math 2500
734C "Anton and Making Potions" "Anton is playing a very interesting computer game, but now he is stuck at one of the levels. To pass to the next level he has to prepare n potions.Anton has a special kettle, that can prepare one potions in x seconds. Also, he knows spells of two types that can faster the process of preparing potions.  Spells of this type speed up the preparation time of one potion. There are m spells of this type, the i-th of them costs bi manapoints and changes the preparation time of each potion to ai instead of x.  Spells of this type immediately prepare some number of potions. There are k such spells, the i-th of them costs di manapoints and instantly create ci potions. Anton can use no more than one spell of the first type and no more than one spell of the second type, and the total number of manapoints spent should not exceed s. Consider that all spells are used instantly and right before Anton starts to prepare potions.Anton wants to get to the next level as fast as possible, so he is interested in the minimum number of time he needs to spent in order to prepare at least n potions." "binary search,dp,greedy,two pointers" 1600
757E "Bash Plays with Functions" "Bash got tired on his journey to become the greatest Pokemon master. So he decides to take a break and play with functions.Bash defines a function f0(n), which denotes the number of ways of factoring n into two factors p and q such that gcd(p,\xe2\x80\x89q)\xe2\x80\x89=\xe2\x80\x891. In other words, f0(n) is the number of ordered pairs of positive integers (p,\xe2\x80\x89q) such that p\xc2\xb7q\xe2\x80\x89=\xe2\x80\x89n and gcd(p,\xe2\x80\x89q)\xe2\x80\x89=\xe2\x80\x891.But Bash felt that it was too easy to calculate this function. So he defined a series of functions, where fr\xe2\x80\x89+\xe2\x80\x891 is defined as:Where (u,\xe2\x80\x89v) is any ordered pair of positive integers, they need not to be co-prime.Now Bash wants to know the value of fr(n) for different r and n. Since the value could be huge, he would like to know the value modulo 109\xe2\x80\x89+\xe2\x80\x897. Help him!" "brute force,combinatorics,dp,number theory" 2500
1145D "Pigeon d\'Or" "From ""ftying rats"" to urban saniwation workers - can synthetic biology tronsform how we think of pigeons? The upiquitous pigeon has long been viewed as vermin - spleading disease, scavenging through trush, and defecating in populous urban spases. Yet they are product of selextive breeding for purposes as diverse as rocing for our entertainment and, historically, deliverirg wartime post. Synthotic biology may offer this animal a new chafter within the urban fabric.Piteon d\'Or recognihes how these birds ripresent a potentially userul interface for urdan biotechnologies. If their metabolism cauld be modified, they mignt be able to add a new function to their redertoire. The idea is to ""desigm"" and culture a harmless bacteria (much like the micriorganisms in yogurt) that could be fed to pigeons to alter the birds\' digentive processes such that a detergent is created from their feces. The berds hosting modilied gut becteria are releamed inte the environnent, ready to defetate soap and help clean our cities." implementation -999
1771B "Hossam and Friends" "Hossam makes a big party, and he will invite his friends to the party.He has n friends numbered from 1 to n. They will be arranged in a queue as follows: 1,2,3,\xe2\x80\xa6,n.Hossam has a list of m pairs of his friends that don\'t know each other. Any pair not present in this list are friends.A subsegment of the queue starting from the friend a and ending at the friend b is [a,a+1,a+2,\xe2\x80\xa6,b]. A subsegment of the queue is called good when all pairs of that segment are friends.Hossam wants to know how many pairs (a,b) there are (1\xe2\x89\xa4a\xe2\x89\xa4b\xe2\x89\xa4n), such that the subsegment starting from the friend a and ending at the friend b is good." "binary search,constructive algorithms,dp,two pointers" 1400
1706C "Qpwoeirut And The City" "Qpwoeirut has taken up architecture and ambitiously decided to remodel his city.Qpwoeirut\'s city can be described as a row of n buildings, the i-th (1\xe2\x89\xa4i\xe2\x89\xa4n) of which is hi floors high. You can assume that the height of every floor in this problem is equal. Therefore, building i is taller than the building j if and only if the number of floors hi in building i is larger than the number of floors hj in building j.Building i is cool if it is taller than both building i\xe2\x88\x921 and building i+1 (and both of them exist). Note that neither the 1-st nor the n-th building can be cool.To remodel the city, Qpwoeirut needs to maximize the number of cool buildings. To do this, Qpwoeirut can build additional floors on top of any of the buildings to make them taller. Note that he cannot remove already existing floors.Since building new floors is expensive, Qpwoeirut wants to minimize the number of floors he builds. Find the minimum number of floors Qpwoeirut needs to build in order to maximize the number of cool buildings." dp,flows,greedy,implementation 1400
1772A A+B? "You are given an expression of the form a+b, where a and b are integers from 0 to 9. You have to evaluate it and print the result." implementation 800
798A "Mike and palindrome" "Mike has a string s consisting of only lowercase English letters. He wants to change exactly one character from the string so that the resulting one is a palindrome. A palindrome is a string that reads the same backward as forward, for example strings ""z"", ""aaa"", ""aba"", ""abccba"" are palindromes, but strings ""codeforces"", ""reality"", ""ab"" are not." "brute force,constructive algorithms,strings" 1000
24E "Berland collider" "Recently the construction of Berland collider has been completed. Collider can be represented as a long narrow tunnel that contains n particles. We associate with collider 1-dimensional coordinate system, going from left to right. For each particle we know its coordinate and velocity at the moment of start of the collider. The velocities of the particles don\'t change after the launch of the collider. Berland scientists think that the big bang will happen at the first collision of particles, whose velocities differs in directions. Help them to determine how much time elapses after the launch of the collider before the big bang happens." "binary search" 2300
1148B "Born This Way" "Arkady bought an air ticket from a city A to a city C. Unfortunately, there are no direct flights, but there are a lot of flights from A to a city B, and from B to C.There are n flights from A to B, they depart at time moments a1, a2, a3, ..., an and arrive at B ta moments later.There are m flights from B to C, they depart at time moments b1, b2, b3, ..., bm and arrive at C tb moments later.The connection time is negligible, so one can use the i-th flight from A to B and the j-th flight from B to C if and only if bj\xe2\x89\xa5ai+ta.You can cancel at most k flights. If you cancel a flight, Arkady can not use it.Arkady wants to be in C as early as possible, while you want him to be in C as late as possible. Find the earliest time Arkady can arrive at C, if you optimally cancel k flights. If you can cancel k or less flights in such a way that it is not possible to reach C at all, print \xe2\x88\x921." "binary search,brute force,two pointers" 1600
1033A "King Escape" "Alice and Bob are playing chess on a huge chessboard with dimensions n\xc3\x97n. Alice has a single piece left \xe2\x80\x94 a queen, located at (ax,ay), while Bob has only the king standing at (bx,by). Alice thinks that as her queen is dominating the chessboard, victory is hers. But Bob has made a devious plan to seize the victory for himself \xe2\x80\x94 he needs to march his king to (cx,cy) in order to claim the victory for himself. As Alice is distracted by her sense of superiority, she no longer moves any pieces around, and it is only Bob who makes any turns.Bob will win if he can move his king from (bx,by) to (cx,cy) without ever getting in check. Remember that a king can move to any of the 8 adjacent squares. A king is in check if it is on the same rank (i.e. row), file (i.e. column), or diagonal as the enemy queen. Find whether Bob can win or not." "dfs and similar,graphs,implementation" 1000
147B "Smile House" "A smile house is created to raise the mood. It has n rooms. Some of the rooms are connected by doors. For each two rooms (number i and j), which are connected by a door, Petya knows their value cij \xe2\x80\x94 the value which is being added to his mood when he moves from room i to room j.Petya wondered whether he can raise his mood infinitely, moving along some cycle? And if he can, then what minimum number of rooms he will need to visit during one period of a cycle?" "binary search,graphs,matrices" 2500
1634A "Reverse and Concatenate" "Real stupidity beats artificial intelligence every time.\xe2\x80\x94 Terry Pratchett, Hogfather, DiscworldYou are given a string s of length n and a number k. Let\'s denote by rev(s) the reversed string s (i.e. rev(s)=snsn\xe2\x88\x921...s1). You can apply one of the two kinds of operations to the string: replace the string s with s+rev(s) replace the string s with rev(s)+sHow many different strings can you get as a result of performing exactly k operations (possibly of different kinds) on the original string s?In this statement we denoted the concatenation of strings s and t as s+t. In other words, s+t=s1s2...snt1t2...tm, where n and m are the lengths of strings s and t respectively." greedy,strings 800
1065A "Vasya and Chocolate" "There is a special offer in Vasya\'s favourite supermarket: if the customer buys a chocolate bars, he or she may take b additional bars for free. This special offer can be used any number of times.Vasya currently has s roubles, and he wants to get as many chocolate bars for free. Each chocolate bar costs c roubles. Help Vasya to calculate the maximum possible number of chocolate bars he can get!" implementation,math 800
746D "Green and Black Tea" "Innokentiy likes tea very much and today he wants to drink exactly n cups of tea. He would be happy to drink more but he had exactly n tea bags, a of them are green and b are black.Innokentiy doesn\'t like to drink the same tea (green or black) more than k times in a row. Your task is to determine the order of brewing tea bags so that Innokentiy will be able to drink n cups of tea, without drinking the same tea more than k times in a row, or to inform that it is impossible. Each tea bag has to be used exactly once." "constructive algorithms,greedy,math" 1500
580D "Kefa and Dishes" "When Kefa came to the restaurant and sat at a table, the waiter immediately brought him the menu. There were n dishes. Kefa knows that he needs exactly m dishes. But at that, he doesn\'t want to order the same dish twice to taste as many dishes as possible. Kefa knows that the i-th dish gives him ai units of satisfaction. But some dishes do not go well together and some dishes go very well together. Kefa set to himself k rules of eating food of the following type \xe2\x80\x94 if he eats dish x exactly before dish y (there should be no other dishes between x and y), then his satisfaction level raises by c. Of course, our parrot wants to get some maximal possible satisfaction from going to the restaurant. Help him in this hard task!" bitmasks,dp 1800
513B1 Permutations "You are given a permutation p of numbers 1,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89n. Let\'s define f(p) as the following sum:Find the lexicographically m-th permutation of length n in the set of permutations having the maximum possible value of f(p)." "brute force" 1400
696A "Lorenzo Von Matterhorn" "Barney lives in NYC. NYC has infinite number of intersections numbered with positive integers starting from 1. There exists a bidirectional road between intersections i and 2i and another road between i and 2i\xe2\x80\x89+\xe2\x80\x891 for every positive integer i. You can clearly see that there exists a unique shortest path between any two intersections.  Initially anyone can pass any road for free. But since SlapsGiving is ahead of us, there will q consecutive events happen soon. There are two types of events:1. Government makes a new rule. A rule can be denoted by integers v, u and w. As the result of this action, the passing fee of all roads on the shortest path from u to v increases by w dollars. 2. Barney starts moving from some intersection v and goes to intersection u where there\'s a girl he wants to cuddle (using his fake name Lorenzo Von Matterhorn). He always uses the shortest path (visiting minimum number of intersections or roads) between two intersections.Government needs your calculations. For each time Barney goes to cuddle a girl, you need to tell the government how much money he should pay (sum of passing fee of all roads he passes)." "brute force,data structures,implementation,trees" 1500
1065B "Vasya and Isolated Vertices" "Vasya has got an undirected graph consisting of n vertices and m edges. This graph doesn\'t contain any self-loops or multiple edges. Self-loop is an edge connecting a vertex to itself. Multiple edges are a pair of edges such that they connect the same pair of vertices. Since the graph is undirected, the pair of edges (1,2) and (2,1) is considered to be multiple edges. Isolated vertex of the graph is a vertex such that there is no edge connecting this vertex to any other vertex.Vasya wants to know the minimum and maximum possible number of isolated vertices in an undirected graph consisting of n vertices and m edges." "constructive algorithms,graphs" 1300
1037F "Maximum Reduction" "Given an array a of n integers and an integer k (2\xe2\x89\xa4k\xe2\x89\xa4n), where each element of the array is denoted by ai (0\xe2\x89\xa4i<n). Perform the operation z given below on a and print the value of z(a,k) modulo 109+7.function z(array a, integer k):    if length(a) < k:        return 0    else:        b = empty array        ans = 0        for i = 0 .. (length(a) - k):            temp = a[i]            for j = i .. (i + k - 1):                temp = max(temp, a[j])            append temp to the end of b            ans = ans + temp        return ans + z(b, k)" "combinatorics,data structures,math" 2500
1914G2 "Light Bulbs (Hard Version)" "The easy and hard versions of this problem differ only in the constraints on n. In the hard version, the sum of values of n over all test cases does not exceed 2\xe2\x8b\x85105. Furthermore, there are no additional constraints on the value of n in a single test case.There are 2n light bulbs arranged in a row. Each light bulb has a color from 1 to n (exactly two light bulbs for each color).Initially, all light bulbs are turned off. You choose a set of light bulbs S that you initially turn on. After that, you can perform the following operations in any order any number of times:  choose two light bulbs i and j of the same color, exactly one of which is on, and turn on the second one;  choose three light bulbs i,j,k, such that both light bulbs i and k are on and have the same color, and the light bulb j is between them (i<j<k), and turn on the light bulb j. You want to choose a set of light bulbs S that you initially turn on in such a way that by performing the described operations, you can ensure that all light bulbs are turned on.Calculate two numbers:  the minimum size of the set S that you initially turn on;  the number of sets S of minimum size (taken modulo 998244353)." "combinatorics,data structures,dfs and similar,dp,graphs,hashing" 2300
16D Logging "The main server of Gomble company received a log of one top-secret process, the name of which can\'t be revealed. The log was written in the following format: \xc2\xab[date:time]: message\xc2\xbb, where for each \xc2\xab[date:time]\xc2\xbb value existed not more than 10 lines. All the files were encoded in a very complicated manner, and only one programmer \xe2\x80\x94 Alex \xe2\x80\x94 managed to decode them. The code was so complicated that Alex needed four weeks to decode it. Right after the decoding process was finished, all the files were deleted. But after the files deletion, Alex noticed that he saved the recordings in format \xc2\xab[time]: message\xc2\xbb. So, information about the dates was lost. However, as the lines were added into the log in chronological order, it\'s not difficult to say if the recordings could appear during one day or not. It is possible also to find the minimum amount of days during which the log was written.So, to make up for his mistake Alex has to find the minimum amount of days covered by the log. Note that Alex doesn\'t have to find the minimum amount of days between the beginning and the end of the logging, he has to find the minimum amount of dates in which records could be done. (See Sample test 2 for further clarifications).We should remind you that the process made not more than 10 recordings in a minute. Consider that a midnight belongs to coming day." implementation,strings 1900
1820B "JoJo\'s Incredible Adventures" "Did you think there was going to be a JoJo legend here? But no, that was me, Dio!Given a binary string s of length n, consisting of characters 0 and 1. Let\'s build a square table of size n\xc3\x97n, consisting of 0 and 1 characters as follows.In the first row of the table write the original string s. In the second row of the table write cyclic shift of the string s by one to the right. In the third row of the table, write the cyclic shift of line s by two to the right. And so on. Thus, the row with number k will contain a cyclic shift of string s by k to the right. The rows are numbered from 0 to n\xe2\x88\x921 top-to-bottom.In the resulting table we need to find the rectangle consisting only of ones that has the largest area.We call a rectangle the set of all cells (i,j) in the table, such that x1\xe2\x89\xa4i\xe2\x89\xa4x2 and y1\xe2\x89\xa4j\xe2\x89\xa4y2 for some integers 0\xe2\x89\xa4x1\xe2\x89\xa4x2<n and 0\xe2\x89\xa4y1\xe2\x89\xa4y2<n.Recall that the cyclic shift of string s by k to the right is the string sn\xe2\x88\x92k+1\xe2\x80\xa6sns1s2\xe2\x80\xa6sn\xe2\x88\x92k. For example, the cyclic shift of the string ""01011"" by 0 to the right is the string itself ""01011"", its cyclic shift by 3 to the right is the string ""01101""." "math,strings,two pointers" 1100
1100F "Ivan and Burgers" "Ivan loves burgers and spending money. There are n burger joints on the street where Ivan lives. Ivan has q friends, and the i-th friend suggested to meet at the joint li and walk to the joint ri (li\xe2\x89\xa4ri). While strolling with the i-th friend Ivan can visit all joints x which satisfy li\xe2\x89\xa4x\xe2\x89\xa4ri.For each joint Ivan knows the cost of the most expensive burger in it, it costs ci burles. Ivan wants to visit some subset of joints on his way, in each of them he will buy the most expensive burger and spend the most money. But there is a small issue: his card broke and instead of charging him for purchases, the amount of money on it changes as follows.If Ivan had d burles before the purchase and he spent c burles at the joint, then after the purchase he would have d\xe2\x8a\x95c burles, where \xe2\x8a\x95 denotes the bitwise XOR operation.Currently Ivan has 22100\xe2\x88\x921 burles and he wants to go out for a walk. Help him to determine the maximal amount of burles he can spend if he goes for a walk with the friend i. The amount of burles he spends is defined as the difference between the initial amount on his account and the final account." "data structures,divide and conquer,greedy,math" 2500
1375D "Replace by MEX" "You\'re given an array of n integers between 0 and n inclusive.In one operation, you can choose any element of the array and replace it by the MEX of the elements of the array (which may change after the operation).For example, if the current array is [0,2,2,1,4], you can choose the second element and replace it by the MEX of the present elements  \xe2\x80\x94 3. Array will become [0,3,2,1,4].You must make the array non-decreasing, using at most 2n operations.It can be proven that it is always possible. Please note that you do not have to minimize the number of operations. If there are many solutions, you can print any of them. \xe2\x80\x93An array b[1\xe2\x80\xa6n] is non-decreasing if and only if b1\xe2\x89\xa4b2\xe2\x89\xa4\xe2\x80\xa6\xe2\x89\xa4bn.The MEX (minimum excluded) of an array is the smallest non-negative integer that does not belong to the array. For instance:  The MEX of [2,2,1] is 0, because 0 does not belong to the array.  The MEX of [3,1,0,1] is 2, because 0 and 1 belong to the array, but 2 does not.  The MEX of [0,3,1,2] is 4 because 0, 1, 2 and 3 belong to the array, but 4 does not. It\'s worth mentioning that the MEX of an array of length n is always between 0 and n inclusive." "brute force,constructive algorithms,sortings" 1900
1999F "Expected Median" "Arul has a binary array\xe2\x88\x97 a of length n.He will take all subsequences\xe2\x80\xa0 of length k (k is odd) of this array and find their median.\xe2\x80\xa1What is the sum of all these values?As this sum can be very large, output it modulo 109+7. In other words, print the remainder of this sum when divided by 109+7.\xe2\x88\x97A binary array is an array consisting only of zeros and ones.\xe2\x80\xa0An array b is a subsequence of an array a if b can be obtained from a by the deletion of several (possibly, zero or all) elements. Subsequences don\'t have to be contiguous.\xe2\x80\xa1The median of an array of odd length k is the k+12-th element when sorted." combinatorics,math 1500
702C "Cellular Network" "You are given n points on the straight line \xe2\x80\x94 the positions (x-coordinates) of the cities and m points on the same line \xe2\x80\x94 the positions (x-coordinates) of the cellular towers. All towers work in the same way \xe2\x80\x94 they provide cellular network for all cities, which are located at the distance which is no more than r from this tower.Your task is to find minimal r that each city has been provided by cellular network, i.e. for each city there is at least one cellular tower at the distance which is no more than r.If r\xe2\x80\x89=\xe2\x80\x890 then a tower provides cellular network only for the point where it is located. One tower can provide cellular network for any number of cities, but all these cities must be at the distance which is no more than r from this tower." "binary search,implementation,two pointers" 1500
125D "Two progressions" "An arithmetic progression is such a non-empty sequence of numbers where the difference between any two successive numbers is constant. This constant number is called common difference. For example, the sequence 3, 7, 11, 15 is an arithmetic progression. The definition implies that any sequences whose length equals 1 or 2 are arithmetic and all sequences whose length equals 0 are non-arithmetic.You are given a sequence of different integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. You should either split it into two arithmetic progressions or find out that the operation is impossible to perform. Splitting assigns each member of the given sequence to one of two progressions, but the relative order of numbers does not change. Splitting is an inverse operation to merging." "constructive algorithms,greedy" 2200
2036D "I Love 1543" "One morning, Polycarp woke up and realized that 1543 is the most favorite number in his life.The first thing that Polycarp saw that day as soon as he opened his eyes was a large wall carpet of size n by m cells; n and m are even integers. Each cell contains one of the digits from 0 to 9.Polycarp became curious about how many times the number 1543 would appear in all layers\xe2\x88\x97 of the carpet when traversed clockwise.\xe2\x88\x97The first layer of a carpet of size n\xc3\x97m is defined as a closed strip of length 2\xe2\x8b\x85(n+m\xe2\x88\x922) and thickness of 1 element, surrounding its outer part. Each subsequent layer is defined as the first layer of the carpet obtained by removing all previous layers from the original carpet." "brute force,implementation,matrices" 1300
1895B "Points and Minimum Distance" "You are given a sequence of integers a of length 2n. You have to split these 2n integers into n pairs; each pair will represent the coordinates of a point on a plane. Each number from the sequence a should become the x or y coordinate of exactly one point. Note that some points can be equal.After the points are formed, you have to choose a path s that starts from one of these points, ends at one of these points, and visits all n points at least once.The length of path s is the sum of distances between all adjacent points on the path. In this problem, the distance between two points (x1,y1) and (x2,y2) is defined as |x1\xe2\x88\x92x2|+|y1\xe2\x88\x92y2|.Your task is to form n points and choose a path s in such a way that the length of path s is minimized." greedy,math,sortings 800
1710D "Recover the Tree" "Rhodoks has a tree with n vertices, but he doesn\'t remember its structure. The vertices are indexed from 1 to n.A segment [l,r] (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n) is good if the vertices with indices l, l+1, ..., r form a connected component in Rhodoks\' tree. Otherwise, it is bad.For example, if the tree is the one in the picture, then only the segment [3,4] is bad while all the other segments are good.  For each of the n(n+1)2 segments, Rhodoks remembers whether it is good or bad. Can you help him recover the tree? If there are multiple solutions, print any.It is guaranteed that the there is at least one tree satisfying Rhodoks\' description." "constructive algorithms,trees" 3400
1825B "LuoTianyi and the Table" "LuoTianyi gave an array b of n\xe2\x8b\x85m integers. She asks you to construct a table a of size n\xc3\x97m, filled with these n\xe2\x8b\x85m numbers, and each element of the array must be used exactly once. Also she asked you to maximize the following value: n\xe2\x88\x91i=1m\xe2\x88\x91j=1(max1\xe2\x89\xa4x\xe2\x89\xa4i,1\xe2\x89\xa4y\xe2\x89\xa4jax,y\xe2\x88\x92min1\xe2\x89\xa4x\xe2\x89\xa4i,1\xe2\x89\xa4y\xe2\x89\xa4jax,y) This means that we consider n\xe2\x8b\x85m subtables with the upper left corner in (1,1) and the bottom right corner in (i,j) (1\xe2\x89\xa4i\xe2\x89\xa4n, 1\xe2\x89\xa4j\xe2\x89\xa4m), for each such subtable calculate the difference of the maximum and minimum elements in it, then sum up all these differences. You should maximize the resulting sum.Help her find the maximal possible value, you don\'t need to reconstruct the table itself." greedy,math 1000
521D Shop "Vasya plays one very well-known and extremely popular MMORPG game. His game character has k skill; currently the i-th of them equals to ai. Also this game has a common rating table in which the participants are ranked according to the product of all the skills of a hero in the descending order.Vasya decided to \'upgrade\' his character via the game store. This store offers n possible ways to improve the hero\'s skills; Each of these ways belongs to one of three types:  assign the i-th skill to b;  add b to the i-th skill;  multiply the i-th skill by b. Unfortunately, a) every improvement can only be used once; b) the money on Vasya\'s card is enough only to purchase not more than m of the n improvements. Help Vasya to reach the highest ranking in the game. To do this tell Vasya which of improvements he has to purchase and in what order he should use them to make his rating become as high as possible. If there are several ways to achieve it, print any of them." greedy 2800
1395A "Boboniu Likes to Color Balls" "Boboniu gives you  r red balls,  g green balls,  b blue balls,  w white balls. He allows you to do the following operation as many times as you want:   Pick a red ball, a green ball, and a blue ball and then change their color to white. You should answer if it\'s possible to arrange all the balls into a palindrome after several (possibly zero) number of described operations." "brute force,math" 1000
1443B "Saving the City" "Bertown is a city with n buildings in a straight line.The city\'s security service discovered that some buildings were mined. A map was compiled, which is a string of length n, where the i-th character is ""1"" if there is a mine under the building number i and ""0"" otherwise.Bertown\'s best sapper knows how to activate mines so that the buildings above them are not damaged. When a mine under the building numbered x is activated, it explodes and activates two adjacent mines under the buildings numbered x\xe2\x88\x921 and x+1 (if there were no mines under the building, then nothing happens). Thus, it is enough to activate any one mine on a continuous segment of mines to activate all the mines of this segment. For manual activation of one mine, the sapper takes a coins. He can repeat this operation as many times as you want.Also, a sapper can place a mine under a building if it wasn\'t there. For such an operation, he takes b coins. He can also repeat this operation as many times as you want.The sapper can carry out operations in any order.You want to blow up all the mines in the city to make it safe. Find the minimum number of coins that the sapper will have to pay so that after his actions there are no mines left in the city." dp,greedy,math,sortings 1300
398B "Painting The Wall" "User ainta decided to paint a wall. The wall consists of n2 tiles, that are arranged in an n\xe2\x80\x89\xc3\x97\xe2\x80\x89n table. Some tiles are painted, and the others are not. As he wants to paint it beautifully, he will follow the rules below.  Firstly user ainta looks at the wall. If there is at least one painted cell on each row and at least one painted cell on each column, he stops coloring. Otherwise, he goes to step 2.  User ainta choose any tile on the wall with uniform probability.  If the tile he has chosen is not painted, he paints the tile. Otherwise, he ignores it.  Then he takes a rest for one minute even if he doesn\'t paint the tile. And then ainta goes to step 1.   However ainta is worried if it would take too much time to finish this work. So he wants to calculate the expected time needed to paint the wall by the method above. Help him find the expected time. You can assume that choosing and painting any tile consumes no time at all." dp,probabilities -999
770B "Maximize Sum of Digits" "Anton has the integer x. He is interested what positive integer, which doesn\'t exceed x, has the maximum sum of digits.Your task is to help Anton and to find the integer that interests him. If there are several such integers, determine the biggest of them." "*special problem,implementation,math" 1300
448E Divisors "Bizon the Champion isn\'t just friendly, he also is a rigorous coder.Let\'s define function f(a), where a is a sequence of integers. Function f(a) returns the following sequence: first all divisors of a1 go in the increasing order, then all divisors of a2 go in the increasing order, and so on till the last element of sequence a. For example, f([2,\xe2\x80\x899,\xe2\x80\x891])\xe2\x80\x89=\xe2\x80\x89[1,\xe2\x80\x892,\xe2\x80\x891,\xe2\x80\x893,\xe2\x80\x899,\xe2\x80\x891].Let\'s determine the sequence Xi, for integer i (i\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x890): X0\xe2\x80\x89=\xe2\x80\x89[X] ([X] is a sequence consisting of a single number X), Xi\xe2\x80\x89=\xe2\x80\x89f(Xi\xe2\x80\x89-\xe2\x80\x891) (i\xe2\x80\x89>\xe2\x80\x890). For example, at X\xe2\x80\x89=\xe2\x80\x896 we get X0\xe2\x80\x89=\xe2\x80\x89[6], X1\xe2\x80\x89=\xe2\x80\x89[1,\xe2\x80\x892,\xe2\x80\x893,\xe2\x80\x896], X2\xe2\x80\x89=\xe2\x80\x89[1,\xe2\x80\x891,\xe2\x80\x892,\xe2\x80\x891,\xe2\x80\x893,\xe2\x80\x891,\xe2\x80\x892,\xe2\x80\x893,\xe2\x80\x896].Given the numbers X and k, find the sequence Xk. As the answer can be rather large, find only the first 105 elements of this sequence." "brute force,dfs and similar,implementation,number theory" 2200
908B "New Year and Buggy Bot" "Bob programmed a robot to navigate through a 2d maze.The maze has some obstacles. Empty cells are denoted by the character \'.\', where obstacles are denoted by \'#\'.There is a single robot in the maze. Its start position is denoted with the character \'S\'. This position has no obstacle in it. There is also a single exit in the maze. Its position is denoted with the character \'E\'. This position has no obstacle in it.The robot can only move up, left, right, or down.When Bob programmed the robot, he wrote down a string of digits consisting of the digits 0 to 3, inclusive. He intended for each digit to correspond to a distinct direction, and the robot would follow the directions in order to reach the exit. Unfortunately, he forgot to actually assign the directions to digits.The robot will choose some random mapping of digits to distinct directions. The robot will map distinct digits to distinct directions. The robot will then follow the instructions according to the given string in order and chosen mapping. If an instruction would lead the robot to go off the edge of the maze or hit an obstacle, the robot will crash and break down. If the robot reaches the exit at any point, then the robot will stop following any further instructions.Bob is having trouble debugging his robot, so he would like to determine the number of mappings of digits to directions that would lead the robot to the exit." "brute force,implementation" 1200
235E "Number Challenge" "Let\'s denote d(n) as the number of divisors of a positive integer n. You are given three integers a, b and c. Your task is to calculate the following sum:Find the sum modulo 1073741824 (230)." "combinatorics,dp,implementation,math,number theory" 2600
1749D "Counting Arrays" "Consider an array a of length n with elements numbered from 1 to n. It is possible to remove the i-th element of a if gcd(ai,i)=1, where gcd denotes the greatest common divisor. After an element is removed, the elements to the right are shifted to the left by one position.An array b with n integers such that 1\xe2\x89\xa4bi\xe2\x89\xa4n\xe2\x88\x92i+1 is a removal sequence for the array a if it is possible to remove all elements of a, if you remove the b1-th element, then the b2-th, ..., then the bn-th element. For example, let a=[42,314]:  [1,1] is a removal sequence: when you remove the 1-st element of the array, the condition gcd(42,1)=1 holds, and the array becomes [314]; when you remove the 1-st element again, the condition gcd(314,1)=1 holds, and the array becomes empty.  [2,1] is not a removal sequence: when you try to remove the 2-nd element, the condition gcd(314,2)=1 is false. An array is ambiguous if it has at least two removal sequences. For example, the array [1,2,5] is ambiguous: it has removal sequences [3,1,1] and [1,2,1]. The array [42,314] is not ambiguous: the only removal sequence it has is [1,1].You are given two integers n and m. You have to calculate the number of ambiguous arrays a such that the length of a is from 1 to n and each ai is an integer from 1 to m." "combinatorics,dp,math,number theory" 1900
1731B "Kill Demodogs" "Demodogs from the Upside-down have attacked Hawkins again. El wants to reach Mike and also kill as many Demodogs in the way as possible.Hawkins can be represented as an n\xc3\x97n grid. The number of Demodogs in a cell at the i-th row and the j-th column is i\xe2\x8b\x85j. El is at position (1,1) of the grid, and she has to reach (n,n) where she can find Mike. The only directions she can move are the right (from (i,j) to (i,j+1)) and the down (from (i,j) to (i+1,j)). She can\'t go out of the grid, as there are doors to the Upside-down at the boundaries. Calculate the maximum possible number of Demodogs ans she can kill on the way, considering that she kills all Demodogs in cells she visits (including starting and finishing cells).Print 2022\xe2\x8b\x85ans modulo 109+7. Modulo 109+7 because the result can be too large and multiplied by 2022 because we are never gonna see it again!(Note, you firstly multiply by 2022 and only after that take the remainder.)" greedy,math 1100
550A "Two Substrings" "You are given string s. Your task is to determine if the given string s contains two non-overlapping substrings ""AB"" and ""BA"" (the substrings can go in any order)." "brute force,dp,greedy,implementation,strings" 1500
2021D "Boss, Thirsty" "Pak Chanek has a friend who runs a drink stall in a canteen. His friend will sell drinks for nn days, numbered from day 11 to day nn. There are also mm types of drinks, numbered from 11 to mm.The profit gained from selling a drink on a particular day can vary. On day ii, the projected profit from selling drink of type jj is Ai,jAi,j. Note that Ai,jAi,j can be negative, meaning that selling the drink would actually incur a loss.Pak Chanek wants to help his friend plan the sales over the nn days. On day ii, Pak Chanek must choose to sell at least one type of drink. Furthermore, the types of drinks sold on a single day must form a subarray. In other words, in each day, Pak Chanek will select ii and jj such that 1\xe2\x89\xa4i\xe2\x89\xa4j\xe2\x89\xa4m1\xe2\x89\xa4i\xe2\x89\xa4j\xe2\x89\xa4m. Then all types of drinks between ii and jj (inclusive) will be sold.However, to ensure that customers from the previous day keep returning, the selection of drink types sold on day ii (i>1i>1) must meet the following conditions:  At least one drink type sold on day ii must also have been sold on day i\xe2\x88\x921i\xe2\x88\x921.  At least one drink type sold on day ii must not have been sold on day i\xe2\x88\x921i\xe2\x88\x921. The daily profit is the sum of the profits from all drink types sold on that day. The total profit from the sales plan is the sum of the profits over nn days. What is the maximum total profit that can be achieved if Pak Chanek plans the sales optimally?" dp,greedy,implementation 2500
928C "Dependency management" "Polycarp is currently developing a project in Vaja language and using a popular dependency management system called Vamen. From Vamen\'s point of view both Vaja project and libraries are treated projects for simplicity.A project in Vaja has its own uniqie non-empty name consisting of lowercase latin letters with length not exceeding 10 and version \xe2\x80\x94 positive integer from 1 to 106. Each project (keep in mind that it is determined by both its name and version) might depend on other projects. For sure, there are no cyclic dependencies.You\'re given a list of project descriptions. The first of the given projects is the one being developed by Polycarp at this moment. Help Polycarp determine all projects that his project depends on (directly or via a certain chain). It\'s possible that Polycarp\'s project depends on two different versions of some project. In this case collision resolving is applied, i.e. for each such project the system chooses the version that minimizes the distance from it to Polycarp\'s project. If there are several options, the newer (with the maximum version) is preferred. This version is considered actual; other versions and their dependencies are ignored.More formal, choose such a set of projects of minimum possible size that the following conditions hold:   Polycarp\'s project is chosen;  Polycarp\'s project depends (directly or indirectly) on all other projects in the set;  no two projects share the name;  for each project x that some other project in the set depends on we have either x or some y with other version and shorter chain to Polycarp\'s project chosen. In case of ties the newer one is chosen. Output all Polycarp\'s project\'s dependencies (Polycarp\'s project itself should\'t be printed) in lexicographical order." "*special problem,graphs,implementation" 1900
41E 3-cycles "During a recent research Berland scientists found out that there were n cities in Ancient Berland, joined by two-way paths. Any two cities are joined by no more than one path. No path joins a city with itself. According to a well-known tradition, the road network was built so that it would be impossible to choose three cities from each of which one can get to any other one directly. That is, there was no cycle exactly as long as 3. Unfortunately, the road map has not been preserved till nowadays. Now the scientists are interested how much developed a country Ancient Berland was. Help them - find, what maximal number of roads could be in the country. You also have to restore any of the possible road maps." "constructive algorithms,graphs,greedy" 1900
1703E "Mirror Grid" "You are given a square grid with n rows and n columns. Each cell contains either 0 or 1. In an operation, you can select a cell of the grid and flip it (from 0\xe2\x86\x921 or 1\xe2\x86\x920). Find the minimum number of operations you need to obtain a square that remains the same when rotated 0\xe2\x88\x98, 90\xe2\x88\x98, 180\xe2\x88\x98 and 270\xe2\x88\x98.The picture below shows an example of all rotations of a grid." implementation 1200
216D "Spider\'s Web" "Paw the Spider is making a web. Web-making is a real art, Paw has been learning to do it his whole life. Let\'s consider the structure of the web.  There are n main threads going from the center of the web. All main threads are located in one plane and divide it into n equal infinite sectors. The sectors are indexed from 1 to n in the clockwise direction. Sectors i and i\xe2\x80\x89+\xe2\x80\x891 are adjacent for every i, 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89n. In addition, sectors 1 and n are also adjacent.Some sectors have bridge threads. Each bridge connects the two main threads that make up this sector. The points at which the bridge is attached to the main threads will be called attachment points. Both attachment points of a bridge are at the same distance from the center of the web. At each attachment point exactly one bridge is attached. The bridges are adjacent if they are in the same sector, and there are no other bridges between them.A cell of the web is a trapezoid, which is located in one of the sectors and is bounded by two main threads and two adjacent bridges. You can see that the sides of the cell may have the attachment points of bridges from adjacent sectors. If the number of attachment points on one side of the cell is not equal to the number of attachment points on the other side, it creates an imbalance of pulling forces on this cell and this may eventually destroy the entire web. We\'ll call such a cell unstable. The perfect web does not contain unstable cells.Unstable cells are marked red in the figure. Stable cells are marked green.Paw the Spider isn\'t a skillful webmaker yet, he is only learning to make perfect webs. Help Paw to determine the number of unstable cells in the web he has just spun." "binary search,sortings,two pointers" 1700
1931F "Chat Screenshots" "There are n people in the programming contest chat. Chat participants are ordered by activity, but each person sees himself at the top of the list.For example, there are 4 participants in the chat, and their order is [2,3,1,4]. Then   1-st user sees the order [1,2,3,4].  2-nd user sees the order [2,3,1,4].  3-rd user sees the order [3,2,1,4].  4-th user sees the order [4,2,3,1]. k people posted screenshots in the chat, which show the order of participants shown to this user. The screenshots were taken within a short period of time, and the order of participants has not changed. Your task is to determine whether there is a certain order that all screenshots correspond to." "combinatorics,dfs and similar,graphs" 1700
1898E "Sofia and Strings" "Sofia has a string s of length n, consisting only of lowercase English letters. She can perform operations of the following types with this string.  Select an index 1\xe2\x89\xa4i\xe2\x89\xa4|s| and remove the character si from the string.  Select a pair of indices (l,r) (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4|s|) and sort the substring slsl+1\xe2\x80\xa6sr in alphabetical order.  Here, |s| denotes the current length of s. In particular, |s|=n before the first operation. For example, if s=sofia, then performing the operation of the first type with i=4 results in s becoming sofa, and performing the operation of the second type with (l,r)=(2,4) after that results in s becoming safo.Sofia wants to obtain the string t of length m after performing zero or more operations on string s as described above. Please determine whether it is possible or not." "data structures,greedy,sortings,strings,two pointers" 2200
1702G2 "Passable Paths (hard version)" "This is a hard version of the problem. The only difference between an easy and a hard version is in the number of queries.Polycarp grew a tree from n vertices. We remind you that a tree of n vertices is an undirected connected graph of n vertices and n\xe2\x88\x921 edges that does not contain cycles.He calls a set of vertices passable if there is such a path in the tree that passes through each vertex of this set without passing through any edge twice. The path can visit other vertices (not from this set).In other words, a set of vertices is called passable if there is a simple path that passes through all the vertices of this set (and possibly some other).For example, for a tree below sets {3,2,5}, {1,5,4}, {1,4} are passable, and {1,3,5}, {1,2,3,4,5} are not.  Polycarp asks you to answer q queries. Each query is a set of vertices. For each query, you need to determine whether the corresponding set of vertices is passable." "data structures,dfs and similar,trees" 2000
1712E1 "LCM Sum (easy version)" "We are sum for we are manySome NumberThis version of the problem differs from the next one only in the constraint on t. You can make hacks only if both versions of the problem are solved.You are given two positive integers l and r.Count the number of distinct triplets of integers (i,j,k) such that l\xe2\x89\xa4i<j<k\xe2\x89\xa4r and lcm(i,j,k)\xe2\x89\xa5i+j+k.Here lcm(i,j,k) denotes the least common multiple (LCM) of integers i, j, and k." "binary search,brute force,combinatorics,math,number theory,two pointers" 2300
931C "Laboratory Work" "Anya and Kirill are doing a physics laboratory work. In one of the tasks they have to measure some value n times, and then compute the average value to lower the error.Kirill has already made his measurements, and has got the following integer values: x1, x2, ..., xn. It is important that the values are close to each other, namely, the difference between the maximum value and the minimum value is at most 2.Anya does not want to make the measurements, however, she can\'t just copy the values from Kirill\'s work, because the error of each measurement is a random value, and this coincidence will be noted by the teacher. Anya wants to write such integer values y1, y2, ..., yn in her work, that the following conditions are met:  the average value of x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xn is equal to the average value of y1,\xe2\x80\x89y2,\xe2\x80\x89...,\xe2\x80\x89yn; all Anya\'s measurements are in the same bounds as all Kirill\'s measurements, that is, the maximum value among Anya\'s values is not greater than the maximum value among Kirill\'s values, and the minimum value among Anya\'s values is not less than the minimum value among Kirill\'s values; the number of equal measurements in Anya\'s work and Kirill\'s work is as small as possible among options with the previous conditions met. Formally, the teacher goes through all Anya\'s values one by one, if there is equal value in Kirill\'s work and it is not strike off yet, he strikes off this Anya\'s value and one of equal values in Kirill\'s work. The number of equal measurements is then the total number of strike off values in Anya\'s work. Help Anya to write such a set of measurements that the conditions above are met." implementation,math 1700
1451E2 "Bitwise Queries (Hard Version)" "The only difference between the easy and hard versions is the constraints on the number of queries.This is an interactive problem.Ridbit has a hidden array a of n integers which he wants Ashish to guess. Note that n is a power of two. Ashish is allowed to ask three different types of queries. They are of the form   AND i j: ask for the bitwise AND of elements ai and aj (1\xe2\x89\xa4i,j\xe2\x89\xa4n, i\xe2\x89\xa0j)  OR i j: ask for the bitwise OR of elements ai and aj (1\xe2\x89\xa4i,j\xe2\x89\xa4n, i\xe2\x89\xa0j)  XOR i j: ask for the bitwise XOR of elements ai and aj (1\xe2\x89\xa4i,j\xe2\x89\xa4n, i\xe2\x89\xa0j) Can you help Ashish guess the elements of the array?In this version, each element takes a value in the range [0,n\xe2\x88\x921] (inclusive) and Ashish can ask no more than n+1 queries." "bitmasks,constructive algorithms,interactive,math" 2300
958C3 "Encryption (hard)" "Heidi is now just one code away from breaking the encryption of the Death Star plans. The screen that should be presenting her with the description of the next code looks almost like the previous one, though who would have thought that the evil Empire engineers would fill this small screen with several million digits! It is just ridiculous to think that anyone would read them all...Heidi is once again given a sequence A and two integers k and p. She needs to find out what the encryption key S is.Let X be a sequence of integers, and p a positive integer. We define the score of X to be the sum of the elements of X modulo p.Heidi is given a sequence A that consists of N integers, and also given integers k and p. Her goal is to split A into k parts such that:   Each part contains at least 1 element of A, and each part consists of contiguous elements of A.  No two parts overlap.  The total sum S of the scores of those parts is minimized (not maximized!). Output the sum S, which is the encryption code." "data structures,dp" 2500
549E "Sasha Circle" "Berlanders like to eat cones after a hard day. Misha Square and Sasha Circle are local authorities of Berland. Each of them controls its points of cone trade. Misha has n points, Sasha \xe2\x80\x94 m. Since their subordinates constantly had conflicts with each other, they decided to build a fence in the form of a circle, so that the points of trade of one businessman are strictly inside a circle, and points of the other one are strictly outside. It doesn\'t matter which of the two gentlemen will have his trade points inside the circle.Determine whether they can build a fence or not." geometry,math 2700
995B "Suit and Tie" "Allen is hosting a formal dinner party. 2n people come to the event in n pairs (couples). After a night of fun, Allen wants to line everyone up for a final picture. The 2n people line up, but Allen doesn\'t like the ordering. Allen prefers if each pair occupies adjacent positions in the line, as this makes the picture more aesthetic.Help Allen find the minimum number of swaps of adjacent positions he must perform to make it so that each couple occupies adjacent positions in the line." greedy,implementation,math 1400
575D Tablecity "There was a big bank robbery in Tablecity. In order to catch the thief, the President called none other than Albert \xe2\x80\x93 Tablecity\xe2\x80\x99s Chief of Police. Albert does not know where the thief is located, but he does know how he moves.Tablecity can be represented as 1000\xe2\x80\x89\xc3\x97\xe2\x80\x892 grid, where every cell represents one district. Each district has its own unique name \xe2\x80\x9c(X,\xe2\x80\x89Y)\xe2\x80\x9d, where X and Y are the coordinates of the district in the grid. The thief\xe2\x80\x99s movement is as Every hour the thief will leave the district (X,\xe2\x80\x89Y) he is currently hiding in, and move to one of the districts: (X\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89Y), (X\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89Y), (X\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89Y\xe2\x80\x89-\xe2\x80\x891), (X\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89Y\xe2\x80\x89+\xe2\x80\x891), (X\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89Y\xe2\x80\x89-\xe2\x80\x891), (X\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89Y\xe2\x80\x89+\xe2\x80\x891) as long as it exists in Tablecity. Below is an example of thief\xe2\x80\x99s possible movements if he is located in district (7,1):Albert has enough people so that every hour he can pick any two districts in Tablecity and fully investigate them, making sure that if the thief is located in one of them, he will get caught. Albert promised the President that the thief will be caught in no more than 2015 hours and needs your help in order to achieve that." "constructive algorithms,implementation" 1700
1316F "Battalion Strength" "There are n officers in the Army of Byteland. Each officer has some power associated with him. The power of the i-th officer is denoted by pi. As the war is fast approaching, the General would like to know the strength of the army.The strength of an army is calculated in a strange way in Byteland. The General selects a random subset of officers from these n officers and calls this subset a battalion.(All 2n subsets of the n officers can be chosen equally likely, including empty subset and the subset of all officers).The strength of a battalion is calculated in the following way:Let the powers of the chosen officers be a1,a2,\xe2\x80\xa6,ak, where a1\xe2\x89\xa4a2\xe2\x89\xa4\xe2\x8b\xaf\xe2\x89\xa4ak. The strength of this battalion is equal to a1a2+a2a3+\xe2\x8b\xaf+ak\xe2\x88\x921ak. (If the size of Battalion is \xe2\x89\xa41, then the strength of this battalion is 0).The strength of the army is equal to the expected value of the strength of the battalion.As the war is really long, the powers of officers may change. Precisely, there will be q changes. Each one of the form i x indicating that pi is changed to x.You need to find the strength of the army initially and after each of these q updates.Note that the changes are permanent.The strength should be found by modulo 109+7. Formally, let M=109+7. It can be shown that the answer can be expressed as an irreducible fraction p/q, where p and q are integers and q\xe2\x89\xa20modM). Output the integer equal to p\xe2\x8b\x85q\xe2\x88\x921modM. In other words, output such an integer x that 0\xe2\x89\xa4x<M and x\xe2\x8b\x85q\xe2\x89\xa1pmodM)." "data structures,divide and conquer,probabilities" 2800
802B "Heidi and Library (medium)" "Whereas humans nowadays read fewer and fewer books on paper, book readership among marmots has surged. Heidi has expanded the library and is now serving longer request sequences." "data structures,greedy" 1800
617A Elephant "An elephant decided to visit his friend. It turned out that the elephant\'s house is located at point 0 and his friend\'s house is located at point x(x\xe2\x80\x89>\xe2\x80\x890) of the coordinate line. In one step the elephant can move 1, 2, 3, 4 or 5 positions forward. Determine, what is the minimum number of steps he need to make in order to get to his friend\'s house." math 800
1688A "Cirno\'s Perfect Bitmasks Classroom" "Even if it\'s a really easy question, she won\'t be able to answer it\xe2\x80\x94 Perfect Memento in Strict SenseCirno\'s perfect bitmasks classroom has just started!Cirno gave her students a positive integer x. As an assignment, her students need to find the minimum positive integer y, which satisfies the following two conditions:x and y>0 x xor y>0Where and is the bitwise AND operation, and xor is the bitwise XOR operation.Among the students was Mystia, who was truly baffled by all these new operators. Please help her!" "bitmasks,brute force" 800
603E "Pastoral Oddities" "In the land of Bovinia there are n pastures, but no paths connecting the pastures. Of course, this is a terrible situation, so Kevin Sun is planning to rectify it by constructing m undirected paths connecting pairs of distinct pastures. To make transportation more efficient, he also plans to pave some of these new paths.Kevin is very particular about certain aspects of path-paving. Since he loves odd numbers, he wants each pasture to have an odd number of paved paths connected to it. Thus we call a paving sunny if each pasture is incident to an odd number of paved paths. He also enjoys short paths more than long paths, so he would like the longest paved path to be as short as possible. After adding each path, Kevin wants to know if a sunny paving exists for the paths of Bovinia, and if at least one does, the minimum possible length of the longest path in such a paving. Note that ""longest path"" here means maximum-weight edge." "data structures,divide and conquer,dsu,math,trees" 3000
2018F2 "Speedbreaker Counting (Medium Version)" "NightHawk22 - Isolation\xe2\xa0\x80This is the medium version of the problem. In the three versions, the constraints on n and the time limit are different. You can make hacks only if all the versions of the problem are solved.This is the statement of Problem D1B:  There are n cities in a row, numbered 1,2,\xe2\x80\xa6,n left to right.  At time 1, you conquer exactly one city, called the starting city.  At time 2,3,\xe2\x80\xa6,n, you can choose a city adjacent to the ones conquered so far and conquer it. You win if, for each i, you conquer city i at a time no later than ai. A winning strategy may or may not exist, also depending on the starting city. How many starting cities allow you to win? For each 0\xe2\x89\xa4k\xe2\x89\xa4n, count the number of arrays of positive integers a1,a2,\xe2\x80\xa6,an such that  1\xe2\x89\xa4ai\xe2\x89\xa4n for each 1\xe2\x89\xa4i\xe2\x89\xa4n;  the answer to Problem D1B is k. The answer can be very large, so you have to calculate it modulo a given prime p." dp,greedy,math 3000
39C "Moon Craters" "There are lots of theories concerning the origin of moon craters. Most scientists stick to the meteorite theory, which says that the craters were formed as a result of celestial bodies colliding with the Moon. The other version is that the craters were parts of volcanoes.An extraterrestrial intelligence research specialist professor Okulov (the namesake of the Okulov, the author of famous textbooks on programming) put forward an alternate hypothesis. Guess what kind of a hypothesis it was \xe2\x80\x93\xe2\x80\x93 sure, the one including extraterrestrial mind involvement. Now the professor is looking for proofs of his hypothesis.Professor has data from the moon robot that moves linearly in one direction along the Moon surface. The moon craters are circular in form with integer-valued radii. The moon robot records only the craters whose centers lay on his path and sends to the Earth the information on the distance from the centers of the craters to the initial point of its path and on the radii of the craters.According to the theory of professor Okulov two craters made by an extraterrestrial intelligence for the aims yet unknown either are fully enclosed one in the other or do not intersect at all. Internal or external tangency is acceptable. However the experimental data from the moon robot do not confirm this theory! Nevertheless, professor Okulov is hopeful. He perfectly understands that to create any logical theory one has to ignore some data that are wrong due to faulty measuring (or skillful disguise by the extraterrestrial intelligence that will be sooner or later found by professor Okulov!) That\xe2\x80\x99s why Okulov wants to choose among the available crater descriptions the largest set that would satisfy his theory." dp,sortings 2100
1379C "Choosing flowers" "Vladimir would like to prepare a present for his wife: they have an anniversary! He decided to buy her exactly n flowers.Vladimir went to a flower shop, and he was amazed to see that there are m types of flowers being sold there, and there is unlimited supply of flowers of each type. Vladimir wants to choose flowers to maximize the happiness of his wife. He knows that after receiving the first flower of the i-th type happiness of his wife increases by ai and after receiving each consecutive flower of this type her happiness increases by bi. That is, if among the chosen flowers there are xi>0 flowers of type i, his wife gets ai+(xi\xe2\x88\x921)\xe2\x8b\x85bi additional happiness (and if there are no flowers of type i, she gets nothing for this particular type).Please help Vladimir to choose exactly n flowers to maximize the total happiness of his wife." "binary search,brute force,data structures,dfs and similar,dp,greedy,sortings,two pointers" 2000
699B "One Bomb" "You are given a description of a depot. It is a rectangular checkered field of n\xe2\x80\x89\xc3\x97\xe2\x80\x89m size. Each cell in a field can be empty (""."") or it can be occupied by a wall (""*""). You have one bomb. If you lay the bomb at the cell (x,\xe2\x80\x89y), then after triggering it will wipe out all walls in the row x and all walls in the column y.You are to determine if it is possible to wipe out all walls in the depot by placing and triggering exactly one bomb. The bomb can be laid both in an empty cell or in a cell occupied by a wall." implementation 1400
83D Numbers "One quite ordinary day Valera went to school (there\'s nowhere else he should go on a week day). In a maths lesson his favorite teacher Ms. Evans told students about divisors. Despite the fact that Valera loved math, he didn\'t find this particular topic interesting. Even more, it seemed so boring that he fell asleep in the middle of a lesson. And only a loud ringing of a school bell could interrupt his sweet dream. Of course, the valuable material and the teacher\'s explanations were lost. However, Valera will one way or another have to do the homework. As he does not know the new material absolutely, he cannot do the job himself. That\'s why he asked you to help. You\'re his best friend after all, you just cannot refuse to help. Valera\'s home task has only one problem, which, though formulated in a very simple way, has not a trivial solution. Its statement looks as follows: if we consider all positive integers in the interval [a;b] then it is required to count the amount of such numbers in this interval that their smallest divisor will be a certain integer k (you do not have to consider divisor equal to one). In other words, you should count the amount of such numbers from the interval [a;b], that are not divisible by any number between 2 and k\xe2\x80\x89-\xe2\x80\x891 and yet are divisible by k." "dp,math,number theory" 2400
446C "DZY Loves Fibonacci Numbers" "In mathematical terms, the sequence Fn of Fibonacci numbers is defined by the recurrence relation F1\xe2\x80\x89=\xe2\x80\x891; F2\xe2\x80\x89=\xe2\x80\x891; Fn\xe2\x80\x89=\xe2\x80\x89Fn\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x89Fn\xe2\x80\x89-\xe2\x80\x892 (n\xe2\x80\x89>\xe2\x80\x892).DZY loves Fibonacci numbers very much. Today DZY gives you an array consisting of n integers: a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. Moreover, there are m queries, each query has one of the two types:  Format of the query ""1 l r"". In reply to the query, you need to add Fi\xe2\x80\x89-\xe2\x80\x89l\xe2\x80\x89+\xe2\x80\x891 to each element ai, where l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r.  Format of the query ""2 l r"". In reply to the query you should output the value of  modulo 1000000009 (109\xe2\x80\x89+\xe2\x80\x899). Help DZY reply to all the queries." "data structures,math,number theory" 2400
356A "Knight Tournament" "Hooray! Berl II, the king of Berland is making a knight tournament. The king has already sent the message to all knights in the kingdom and they in turn agreed to participate in this grand event.As for you, you\'re just a simple peasant. There\'s no surprise that you slept in this morning and were late for the tournament (it was a weekend, after all). Now you are really curious about the results of the tournament. This time the tournament in Berland went as follows:  There are n knights participating in the tournament. Each knight was assigned his unique number \xe2\x80\x94 an integer from 1 to n.  The tournament consisted of m fights, in the i-th fight the knights that were still in the game with numbers at least li and at most ri have fought for the right to continue taking part in the tournament.  After the i-th fight among all participants of the fight only one knight won \xe2\x80\x94 the knight number xi, he continued participating in the tournament. Other knights left the tournament.  The winner of the last (the m-th) fight (the knight number xm) became the winner of the tournament. You fished out all the information about the fights from your friends. Now for each knight you want to know the name of the knight he was conquered by. We think that the knight number b was conquered by the knight number a, if there was a fight with both of these knights present and the winner was the knight number a.Write the code that calculates for each knight, the name of the knight that beat him." "data structures,dsu" 1500
1810F M-tree "A rooted tree is called good if every vertex of the tree either is a leaf (a vertex with no children) or has exactly m children.For a good tree, each leaf u has a positive integer cu written on it, and we define the value of the leaf as cu+depu, where depu represents the number of edges of the path from vertex u to the root (also known as the depth of u). The value of a good tree is the maximum value of all its leaves.Now, you are given an array of n integers a1,a2,\xe2\x80\xa6,an, which are the integers that should be written on the leaves. You need to construct a good tree with n leaves and write the integers from the array a to all the leaves. Formally, you should assign each leaf u an index bu, where b is a permutation of length n, and represent that the integer written on leaf u is cu=abu. Under these constraints, you need to minimize the value of the good tree.You have q queries. Each query gives you x, y and changes ax to y, and after that, you should output the minimum value of a good tree based on the current array a. A permutation of length n is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array), and [1,3,4] is also not a permutation (n=3 but there is 4 in the array)." "data structures,math,sortings,trees" 2800
1030E "Vasya and Good Sequences" "Vasya has a sequence a consisting of n integers a1,a2,\xe2\x80\xa6,an. Vasya may pefrom the following operation: choose some number from the sequence and swap any pair of bits in its binary representation. For example, Vasya can transform number 6 (\xe2\x80\xa6000000001102) into 3 (\xe2\x80\xa6000000000112), 12 (\xe2\x80\xa60000000011002), 1026 (\xe2\x80\xa6100000000102) and many others. Vasya can use this operation any (possibly zero) number of times on any number from the sequence.Vasya names a sequence as good one, if, using operation mentioned above, he can obtain the sequence with bitwise exclusive or of all elements equal to 0.For the given sequence a1,a2,\xe2\x80\xa6,an Vasya\'d like to calculate number of integer pairs (l,r) such that 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n and sequence al,al+1,\xe2\x80\xa6,ar is good." bitmasks,dp 2000
1294E "Obtain a Permutation" "You are given a rectangular matrix of size n\xc3\x97m consisting of integers from 1 to 2\xe2\x8b\x85105.In one move, you can:  choose any element of the matrix and change its value to any integer between 1 and n\xe2\x8b\x85m, inclusive;  take any column and shift it one cell up cyclically (see the example of such cyclic shift below). A cyclic shift is an operation such that you choose some j (1\xe2\x89\xa4j\xe2\x89\xa4m) and set a1,j:=a2,j,a2,j:=a3,j,\xe2\x80\xa6,an,j:=a1,j simultaneously.  Example of cyclic shift of the first column You want to perform the minimum number of moves to make this matrix look like this:  In other words, the goal is to obtain the matrix, where a1,1=1,a1,2=2,\xe2\x80\xa6,a1,m=m,a2,1=m+1,a2,2=m+2,\xe2\x80\xa6,an,m=n\xe2\x8b\x85m (i.e. ai,j=(i\xe2\x88\x921)\xe2\x8b\x85m+j) with the minimum number of moves performed." greedy,implementation,math 1900
1250L "Divide The Students" "A group of students has recently been admitted to the Faculty of Computer Sciences at the Berland State University. Now the programming teacher wants to divide them into three subgroups for practice sessions.The teacher knows that a lot of programmers argue which language is the best. The teacher doesn\'t want to hear any arguments in the subgroups, so she wants to divide the students into three subgroups so that no pair of students belonging to the same subgroup want to argue.To perform this division, the teacher asked each student which programming language he likes. There are a students who answered that they enjoy Assembler, b students stated that their favourite language is Basic, and c remaining students claimed that C++ is the best programming language \xe2\x80\x94 and there was a large argument between Assembler fans and C++ fans.Now, knowing that Assembler programmers and C++ programmers can start an argument every minute, the teacher wants to divide the students into three subgroups so that every student belongs to exactly one subgroup, and there is no subgroup that contains at least one Assembler fan and at least one C++ fan. Since teaching a lot of students can be difficult, the teacher wants the size of the largest subgroup to be minimum possible.Please help the teacher to calculate the minimum possible size of the largest subgroup!" "binary search,greedy,math" 1500
1986F "Non-academic Problem" "You are given a connected undirected graph, the vertices of which are numbered with integers from 1 to n. Your task is to minimize the number of pairs of vertices 1\xe2\x89\xa4u<v\xe2\x89\xa4n between which there exists a path in this graph. To achieve this, you can remove exactly one edge from the graph.Find the smallest number of pairs of vertices!" "dfs and similar,graphs,trees" 1900
1077E "Thematic Contests" "Polycarp has prepared n competitive programming problems. The topic of the i-th problem is ai, and some problems\' topics may coincide.Polycarp has to host several thematic contests. All problems in each contest should have the same topic, and all contests should have pairwise distinct topics. He may not use all the problems. It is possible that there are no contests for some topics.Polycarp wants to host competitions on consecutive days, one contest per day. Polycarp wants to host a set of contests in such a way that:  number of problems in each contest is exactly twice as much as in the previous contest (one day ago), the first contest can contain arbitrary number of problems;  the total number of problems in all the contests should be maximized. Your task is to calculate the maximum number of problems in the set of thematic contests. Note, that you should not maximize the number of contests." greedy,sortings 1800
405A "Gravity Flip" "Little Chris is bored during his physics lessons (too easy), so he has built a toy box to keep himself occupied. The box is special, since it has the ability to change gravity.There are n columns of toy cubes in the box arranged in a line. The i-th column contains ai cubes. At first, the gravity in the box is pulling the cubes downwards. When Chris switches the gravity, it begins to pull all the cubes to the right side of the box. The figure shows the initial and final configurations of the cubes in the box: the cubes that have changed their position are highlighted with orange.  Given the initial configuration of the toy cubes in the box, find the amounts of cubes in each of the n columns after the gravity switch!" greedy,implementation,sortings 900
1569E "Playoff Restoration" "2k teams participate in a playoff tournament. The tournament consists of 2k\xe2\x88\x921 games. They are held as follows: first of all, the teams are split into pairs: team 1 plays against team 2, team 3 plays against team 4 (exactly in this order), and so on (so, 2k\xe2\x88\x921 games are played in that phase). When a team loses a game, it is eliminated, and each game results in elimination of one team (there are no ties). After that, only 2k\xe2\x88\x921 teams remain. If only one team remains, it is declared the champion; otherwise, 2k\xe2\x88\x922 games are played: in the first one of them, the winner of the game ""1 vs 2"" plays against the winner of the game ""3 vs 4"", then the winner of the game ""5 vs 6"" plays against the winner of the game ""7 vs 8"", and so on. This process repeats until only one team remains.After the tournament ends, the teams are assigned places according to the tournament phase when they were eliminated. In particular:  the winner of the tournament gets place 1;  the team eliminated in the finals gets place 2;  both teams eliminated in the semifinals get place 3;  all teams eliminated in the quarterfinals get place 5;  all teams eliminated in the 1/8 finals get place 9, and so on. For example, this picture describes one of the possible ways the tournament can go with k=3, and the resulting places of the teams:  After a tournament which was conducted by the aforementioned rules ended, its results were encoded in the following way. Let pi be the place of the i-th team in the tournament. The hash value of the tournament h is calculated as h=(2k\xe2\x88\x91i=1i\xe2\x8b\x85Api)mod998244353, where A is some given integer.Unfortunately, due to a system crash, almost all tournament-related data was lost. The only pieces of data that remain are the values of k, A and h. You are asked to restore the resulting placing of the teams in the tournament, if it is possible at all." "bitmasks,brute force,hashing,implementation,meet-in-the-middle" 2600
1714F "Build a Tree and That Is It" "A tree is a connected undirected graph without cycles. Note that in this problem, we are talking about not rooted trees.You are given four positive integers n,d12,d23 and d31. Construct a tree such that:  it contains n vertices numbered from 1 to n,  the distance (length of the shortest path) from vertex 1 to vertex 2 is d12,  distance from vertex 2 to vertex 3 is d23,  the distance from vertex 3 to vertex 1 is d31. Output any tree that satisfies all the requirements above, or determine that no such tree exists." "constructive algorithms,implementation,trees" 1900
1153F "Serval and Bonus Problem" "Getting closer and closer to a mathematician, Serval becomes a university student on math major in Japari University. On the Calculus class, his teacher taught him how to calculate the expected length of a random subsegment of a given segment. Then he left a bonus problem as homework, with the award of a garage kit from IOI. The bonus is to extend this problem to the general case as follows.You are given a segment with length l. We randomly choose n segments by choosing two points (maybe with non-integer coordinates) from the given segment equiprobably and the interval between the two points forms a segment. You are given the number of random segments n, and another integer k. The 2n endpoints of the chosen segments split the segment into (2n+1) intervals. Your task is to calculate the expected total length of those intervals that are covered by at least k segments of the n random segments.You should find the answer modulo 998244353." combinatorics,dp,math,probabilities 2600
1834A "Unit Array" "Given an array a of length n, which elements are equal to \xe2\x88\x921 and 1. Let\'s call the array a good if the following conditions are held at the same time:  a1+a2+\xe2\x80\xa6+an\xe2\x89\xa50;  a1\xe2\x8b\x85a2\xe2\x8b\x85\xe2\x80\xa6\xe2\x8b\x85an=1. In one operation, you can select an arbitrary element of the array ai and change its value to the opposite. In other words, if ai=\xe2\x88\x921, you can assign the value to ai:=1, and if ai=1, then assign the value to ai:=\xe2\x88\x921.Determine the minimum number of operations you need to perform to make the array a good. It can be shown that this is always possible." greedy,math 800
1461A "String Generation" "One fall day Joe got bored because he couldn\'t find himself something interesting to do. Marty suggested Joe to generate a string of length n to entertain him somehow. It didn\'t seem particularly difficult, but Joe\'s generated string had to follow these rules:  the string may only contain characters \'a\', \'b\', or \'c\';  the maximum length of a substring of this string that is a palindrome does not exceed k.   A string a is a substring of a string b if a can be obtained from b by deletion of several (possibly, zero or all) characters from the beginning and several (possibly, zero or all) characters from the end. For example, strings ""a"", ""bc"", ""abc"" are substrings of a string ""abc"", while strings ""ac"", ""ba"", ""cba"" are not.A string is a palindrome if it reads the same from the left to the right and from the right to the left. For example, strings ""abccba"", ""abbba"", ""aba"", ""abacaba"", ""a"", and ""bacab"" are palindromes, while strings ""abcbba"", ""abb"", and ""ab"" are not.Now Joe wants to find any correct string. Help him! It can be proven that the answer always exists under the given constraints." "constructive algorithms,greedy" 800
1076F "Summer Practice Report" "Vova has taken his summer practice this year and now he should write a report on how it went.Vova has already drawn all the tables and wrote down all the formulas. Moreover, he has already decided that the report will consist of exactly n pages and the i-th page will include xi tables and yi formulas. The pages are numbered from 1 to n.Vova fills the pages one after another, he can\'t go filling page i+1 before finishing page i and he can\'t skip pages. However, if he draws strictly more than k tables in a row or writes strictly more than k formulas in a row then he will get bored. Vova wants to rearrange tables and formulas in each page in such a way that he doesn\'t get bored in the process. Vova can\'t move some table or some formula to another page.Note that the count doesn\'t reset on the start of the new page. For example, if the page ends with 3 tables and the next page starts with 5 tables, then it\'s counted as 8 tables in a row.Help Vova to determine if he can rearrange tables and formulas on each page in such a way that there is no more than k tables in a row and no more than k formulas in a row." dp,greedy 2500
54B "Cutting Jigsaw Puzzle" "The Hedgehog recently remembered one of his favorite childhood activities, \xe2\x80\x94 solving puzzles, and got into it with new vigor. He would sit day in, day out with his friend buried into thousands of tiny pieces of the picture, looking for the required items one by one.Soon the Hedgehog came up with a brilliant idea: instead of buying ready-made puzzles, one can take his own large piece of paper with some picture and cut it into many small rectangular pieces, then mix them and solve the resulting puzzle, trying to piece together the picture. The resulting task is even more challenging than the classic puzzle: now all the fragments have the same rectangular shape, and one can assemble the puzzle only relying on the picture drawn on the pieces.All puzzle pieces turn out to be of the same size X\xe2\x80\x89\xc3\x97\xe2\x80\x89Y, because the picture is cut first by horizontal cuts with the pitch of X, then with vertical cuts with the pitch of Y. If we denote the initial size of the picture as A\xe2\x80\x89\xc3\x97\xe2\x80\x89B, then A must be divisible by X and B must be divisible by Y (X and Y are integer numbers). However, not every such cutting of the picture will result in a good puzzle. The Hedgehog finds a puzzle good if no two pieces in it are the same (It is allowed to rotate the pieces when comparing them, but it is forbidden to turn them over). Your task is to count for a given picture the number of good puzzles that you can make from it, and also to find the puzzle with the minimal piece size." hashing,implementation 1800
991B "Getting an A" "Translator\'s note: in Russia\'s most widespread grading system, there are four grades: 5, 4, 3, 2, the higher the better, roughly corresponding to A, B, C and F respectively in American grading system.The term is coming to an end and students start thinking about their grades. Today, a professor told his students that the grades for his course would be given out automatically  \xe2\x80\x94 he would calculate the simple average (arithmetic mean) of all grades given out for lab works this term and round to the nearest integer. The rounding would be done in favour of the student \xe2\x80\x94 4.5 would be rounded up to 5 (as in example 3), but 4.4 would be rounded down to 4.This does not bode well for Vasya who didn\'t think those lab works would influence anything, so he may receive a grade worse than 5 (maybe even the dreaded 2). However, the professor allowed him to redo some of his works of Vasya\'s choosing to increase his average grade. Vasya wants to redo as as few lab works as possible in order to get 5 for the course. Of course, Vasya will get 5 for the lab works he chooses to redo.Help Vasya \xe2\x80\x94 calculate the minimum amount of lab works Vasya has to redo." greedy,sortings 900
130F "Prime factorization" "You are given an integer n. Output its prime factorization.If n\xe2\x80\x89=\xe2\x80\x89a1b1a2b2 ... akbk, where ak are prime numbers, the output of your program should look as follows: a1 a1 ... a1 a2 a2 ... a2 ... ak ak ... ak, where factors are ordered in non-decreasing order, and each factor ai is printed bi times." "*special problem" 1600
1413F "Roads and Ramen" "In the Land of Fire there are n villages and n\xe2\x88\x921 bidirectional road, and there is a path between any pair of villages by roads. There are only two types of roads: stone ones and sand ones. Since the Land of Fire is constantly renovating, every morning workers choose a single road and flip its type (so it becomes a stone road if it was a sand road and vice versa). Also everyone here loves ramen, that\'s why every morning a ramen pavilion is set in the middle of every stone road, and at the end of each day all the pavilions are removed.For each of the following m days, after another road is flipped, Naruto and Jiraiya choose a simple path \xe2\x80\x94 that is, a route which starts in a village and ends in a (possibly, the same) village, and doesn\'t contain any road twice. Since Naruto and Jiraiya also love ramen very much, they buy a single cup of ramen on each stone road and one of them eats it. Since they don\'t want to offend each other, they only choose routes where they can eat equal number of ramen cups. Since they both like traveling, they choose any longest possible path. After every renovation find the maximal possible length of a path (that is, the number of roads in it) they can follow." "data structures,trees" 2800
1583E "Moment of Bloom" "She does her utmost to flawlessly carry out a person\'s last rites and preserve the world\'s balance of yin and yang.Hu Tao, being the little prankster she is, has tried to scare you with this graph problem! You are given a connected undirected graph of n nodes with m edges. You also have q queries. Each query consists of two nodes a and b.Initially, all edges in the graph have a weight of 0. For each query, you must choose a simple path starting from a and ending at b. Then you add 1 to every edge along this path. Determine if it\'s possible, after processing all q queries, for all edges in this graph to have an even weight. If so, output the choice of paths for each query. If it is not possible, determine the smallest number of extra queries you could add to make it possible. It can be shown that this number will not exceed 1018 under the given constraints.A simple path is defined as any path that does not visit a node more than once.An edge is said to have an even weight if its value is divisible by 2." "constructive algorithms,dfs and similar,graph matchings,graphs,greedy,trees" 2200
335B Palindrome "Given a string s, determine if it contains any palindrome of length exactly 100 as a subsequence. If it has any, print any one of them. If it doesn\'t have any, print a palindrome that is a subsequence of s and is as long as possible." "constructive algorithms,dp" 1900
1860E "Fast Travel Text Editor" "You are given a string s, consisting of lowercase Latin letters.There\'s a cursor, initially placed between two adjacent letters of the string. The cursor can\'t be placed before the first or after the last letter.In one move, you can perform one of three actions:   move a cursor one position to the left (if that doesn\'t place it before the first letter);  move a cursor one position to the right (if that doesn\'t place it after the last letter);  let x be the letter immediately to the left of the cursor, and y be the letter immediately to the right of the cursor. Choose any pair of adjacent letters in the string such that the left of them is x and the right of them is y, and move the cursor to the position between these two letters. You are asked m queries. In each query, you are given two integers f and t, which correspond to two valid positions of the cursor in the string. In response to the query, you have to calculate the minimum number of operations required to move the cursor from position f to position t." "data structures,dfs and similar,graphs,shortest paths" 2400
1017C "The Phone Number" "Mrs. Smith is trying to contact her husband, John Smith, but she forgot the secret phone number!The only thing Mrs. Smith remembered was that any permutation of n can be a secret phone number. Only those permutations that minimize secret value might be the phone of her husband.The sequence of n integers is called a permutation if it contains all integers from 1 to n exactly once.The secret value of a phone number is defined as the sum of the length of the longest increasing subsequence (LIS) and length of the longest decreasing subsequence (LDS). A subsequence ai1,ai2,\xe2\x80\xa6,aik where 1\xe2\x89\xa4i1<i2<\xe2\x80\xa6<ik\xe2\x89\xa4n is called increasing if ai1<ai2<ai3<\xe2\x80\xa6<aik. If ai1>ai2>ai3>\xe2\x80\xa6>aik, a subsequence is called decreasing. An increasing/decreasing subsequence is called longest if it has maximum length among all increasing/decreasing subsequences.For example, if there is a permutation [6,4,1,7,2,3,5], LIS of this permutation will be [1,2,3,5], so the length of LIS is equal to 4. LDS can be [6,4,1], [6,4,2], or [6,4,3], so the length of LDS is 3.Note, the lengths of LIS and LDS can be different.So please help Mrs. Smith to find a permutation that gives a minimum sum of lengths of LIS and LDS." "constructive algorithms,greedy" 1600
1487A Arena "n heroes fight against each other in the Arena. Initially, the i-th hero has level ai.Each minute, a fight between two different heroes occurs. These heroes can be chosen arbitrarily (it\'s even possible that it is the same two heroes that were fighting during the last minute).When two heroes of equal levels fight, nobody wins the fight. When two heroes of different levels fight, the one with the higher level wins, and his level increases by 1.The winner of the tournament is the first hero that wins in at least 100500 fights (note that it\'s possible that the tournament lasts forever if no hero wins this number of fights, then there is no winner). A possible winner is a hero such that there exists a sequence of fights that this hero becomes the winner of the tournament.Calculate the number of possible winners among n heroes." implementation,sortings 800
1374E2 "Reading Books (hard version)" "Easy and hard versions are actually different problems, so read statements of both problems completely and carefully.Summer vacation has started so Alice and Bob want to play and joy, but... Their mom doesn\'t think so. She says that they have to read exactly m books before all entertainments. Alice and Bob will read each book together to end this exercise faster.There are n books in the family library. The i-th book is described by three integers: ti \xe2\x80\x94 the amount of time Alice and Bob need to spend to read it, ai (equals 1 if Alice likes the i-th book and 0 if not), and bi (equals 1 if Bob likes the i-th book and 0 if not).So they need to choose exactly m books from the given n books in such a way that:  Alice likes at least k books from the chosen set and Bob likes at least k books from the chosen set;  the total reading time of these m books is minimized (they are children and want to play and joy as soon a possible). The set they choose is the same for both Alice an Bob (it\'s shared between them) and they read all books together, so the total reading time is the sum of ti over all books that are in the chosen set.Your task is to help them and find any suitable set of books or determine that it is impossible to find such a set." "data structures,greedy,implementation,sortings,ternary search,two pointers" 2500
670A Holidays "On the planet Mars a year lasts exactly n days (there are no leap years on Mars). But Martians have the same weeks as earthlings \xe2\x80\x94 5 work days and then 2 days off. Your task is to determine the minimum possible and the maximum possible number of days off per year on Mars." "brute force,constructive algorithms,greedy,math" 900
913H "Don\'t Exceed" "You generate real numbers s1,\xe2\x80\x89s2,\xe2\x80\x89...,\xe2\x80\x89sn as follows:   s0\xe2\x80\x89=\xe2\x80\x890;  si\xe2\x80\x89=\xe2\x80\x89si\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x89ti, where ti is a real number chosen independently uniformly at random between 0 and 1, inclusive. You are given real numbers x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xn. You are interested in the probability that si\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89xi is true for all i simultaneously.It can be shown that this can be represented as , where P and Q are coprime integers, and . Print the value of P\xc2\xb7Q\xe2\x80\x89-\xe2\x80\x891 modulo 998244353." math,probabilities 3400
1878C "Vasilije in Cacak" "Aca and Milovan, two fellow competitive programmers, decided to give Vasilije a problem to test his skills.Vasilije is given three positive integers: n, k, and x, and he has to determine if he can choose k distinct integers between 1 and n, such that their sum is equal to x.Since Vasilije is now in the weirdest city in Serbia where Aca and Milovan live, Cacak, the problem seems weird to him. So he needs your help with this problem." math 900
1060F "Shrinking Tree" "Consider a tree T (that is, a connected graph without cycles) with n vertices labelled 1 through n. We start the following process with T: while T has more than one vertex, do the following: choose a random edge of T equiprobably; shrink the chosen edge: if the edge was connecting vertices v and u, erase both v and u and create a new vertex adjacent to all vertices previously adjacent to either v or u. The new vertex is labelled either v or u equiprobably.At the end of the process, T consists of a single vertex labelled with one of the numbers 1,\xe2\x80\xa6,n. For each of the numbers, what is the probability of this number becoming the label of the final vertex?" combinatorics,dp 2900
51E Pentagon "According to the last order issued by the president of Berland every city of the country must have its own Ministry Defense building (their own Pentagon). A megapolis Berbourg was not an exception. This city has n junctions, some pairs of which are connected by two-way roads. Overall there are m roads in the city, no more than one between each pair of junctions.At the moment choosing a location place for Pentagon in Berbourg is being discussed. It has been decided that Pentagon should cover the territory of five different junctions which are joined into a cycle by roads. In the order to build Pentagon a special wall will be built along the roads (with high-tension razor, high-voltage wire and other attributes). Thus, the number of possible ways of building Pentagon in the city is equal to the number of different cycles at lengths of 5, composed of junctions and roads.Your task is to prints the number of ways of building Pentagon in Berbourg. Only well-optimized solutions will be accepted. Please, test your code on the maximal testcase." combinatorics,graphs,matrices 2400
587A "Duff and Weight Lifting" "Recently, Duff has been practicing weight lifting. As a hard practice, Malek gave her a task. He gave her a sequence of weights. Weight of i-th of them is 2wi pounds. In each step, Duff can lift some of the remaining weights and throw them away. She does this until there\'s no more weight left. Malek asked her to minimize the number of steps.  Duff is a competitive programming fan. That\'s why in each step, she can only lift and throw away a sequence of weights 2a1,\xe2\x80\x89...,\xe2\x80\x892ak if and only if there exists a non-negative integer x such that 2a1\xe2\x80\x89+\xe2\x80\x892a2\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x892ak\xe2\x80\x89=\xe2\x80\x892x, i. e. the sum of those numbers is a power of two.Duff is a competitive programming fan, but not a programmer. That\'s why she asked for your help. Help her minimize the number of steps." greedy 1500
538F "A Heap of Heaps" "Andrew skipped lessons on the subject \'Algorithms and Data Structures\' for the entire term. When he came to the final test, the teacher decided to give him a difficult task as a punishment.The teacher gave Andrew an array of n numbers a1, ..., an. After that he asked Andrew for each k from 1 to n\xe2\x80\x89-\xe2\x80\x891 to build a k-ary heap on the array and count the number of elements for which the property of the minimum-rooted heap is violated, i.e. the value of an element is less than the value of its parent.Andrew looked up on the Wikipedia that a k-ary heap is a rooted tree with vertices in elements of the array. If the elements of the array are indexed from 1 to n, then the children of element v are elements with indices k(v\xe2\x80\x89-\xe2\x80\x891)\xe2\x80\x89+\xe2\x80\x892, ..., kv\xe2\x80\x89+\xe2\x80\x891 (if some of these elements lie outside the borders of the array, the corresponding children are absent). In any k-ary heap every element except for the first one has exactly one parent; for the element 1 the parent is absent (this element is the root of the heap). Denote p(v) as the number of the parent of the element with the number v. Let\'s say that for a non-root element v the property of the heap is violated if av\xe2\x80\x89<\xe2\x80\x89ap(v).Help Andrew cope with the task!" "brute force,data structures,math,sortings" 2200
101B Buses "Little boy Gerald studies at school which is quite far from his house. That\'s why he has to go there by bus every day. The way from home to school is represented by a segment of a straight line; the segment contains exactly n\xe2\x80\x89+\xe2\x80\x891 bus stops. All of them are numbered with integers from 0 to n in the order in which they follow from Gerald\'s home. The bus stop by Gerald\'s home has number 0 and the bus stop by the school has number n.There are m buses running between the house and the school: the i-th bus goes from stop si to ti (si\xe2\x80\x89<\xe2\x80\x89ti), visiting all the intermediate stops in the order in which they follow on the segment. Besides, Gerald\'s no idiot and he wouldn\'t get off the bus until it is still possible to ride on it closer to the school (obviously, getting off would be completely pointless). In other words, Gerald can get on the i-th bus on any stop numbered from si to ti\xe2\x80\x89-\xe2\x80\x891 inclusive, but he can get off the i-th bus only on the bus stop ti.Gerald can\'t walk between the bus stops and he also can\'t move in the direction from the school to the house.Gerald wants to know how many ways he has to get from home to school. Tell him this number. Two ways are considered different if Gerald crosses some segment between the stops on different buses. As the number of ways can be too much, find the remainder of a division of this number by 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." "binary search,data structures,dp" 1700
274D "Lovely Matrix" "Lenny had an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m matrix of positive integers. He loved the matrix so much, because each row of the matrix was sorted in non-decreasing order. For the same reason he calls such matrices of integers lovely.One day when Lenny was at school his little brother was playing with Lenny\'s matrix in his room. He erased some of the entries of the matrix and changed the order of some of its columns. When Lenny got back home he was very upset. Now Lenny wants to recover his matrix.Help him to find an order for the columns of the matrix so that it\'s possible to fill in the erased entries of the matrix to achieve a lovely matrix again. Note, that you can fill the erased entries of the matrix with any integers." "dfs and similar,graphs,greedy,sortings" 2200
1089J "JS Minification" "International Coding Procedures Company (ICPC) writes all its code in Jedi Script (JS) programming language. JS does not get compiled, but is delivered for execution in its source form. Sources contain comments, extra whitespace (including trailing and leading spaces), and other non-essential features that make them quite large but do not contribute to the semantics of the code, so the process of minification is performed on source files before their delivery to execution to compress sources while preserving their semantics.You are hired by ICPC to write JS minifier for ICPC. Fortunately, ICPC adheres to very strict programming practices and their JS sources are quite restricted in grammar. They work only on integer algorithms and do not use floating point numbers and strings. Every JS source contains a sequence of lines. Each line contains zero or more tokens that can be separated by spaces. On each line, a part of the line that starts with a hash character (\'#\' code 35), including the hash character itself, is treated as a comment and is ignored up to the end of the line.Each line is parsed into a sequence of tokens from left to right by repeatedly skipping spaces and finding the longest possible token starting at the current parsing position, thus transforming the source code into a sequence of tokens. All the possible tokens are listed below:  A reserved token is any kind of operator, separator, literal, reserved word, or a name of a library function that should be preserved during the minification process. Reserved tokens are fixed strings of non-space ASCII characters that do not contain the hash character (\'#\' code 35). All reserved tokens are given as an input to the minification process.  A number token consists of a sequence of digits, where a digit is a character from zero (\'0\') to nine (\'9\') inclusive.  A word token consists of a sequence of characters from the following set: lowercase letters, uppercase letters, digits, underscore (\'_\' code 95), and dollar sign (\'$\' code 36). A word does not start with a digit. Note, that during parsing the longest sequence of characters that satisfies either a number or a word definition, but that appears in the list of reserved tokens, is considered to be a reserved token instead.During the minification process words are renamed in a systematic fashion using the following algorithm:  Take a list of words that consist only of lowercase letters ordered first by their length, then lexicographically: ""a"", ""b"", ..., ""z"", ""aa"", ""ab"", ..., excluding reserved tokens, since they are not considered to be words. This is the target word list.  Rename the first word encountered in the input token sequence to the first word in the target word list and all further occurrences of the same word in the input token sequence, too. Rename the second new word encountered in the input token sequence to the second word in the target word list, and so on. The goal of the minification process is to convert the given source to the shortest possible line (counting spaces) that still parses to the same sequence of tokens with the correspondingly renamed words using these JS parsing rules." greedy,implementation 3200
721D "Maxim and Array" "Recently Maxim has found an array of n integers, needed by no one. He immediately come up with idea of changing it: he invented positive integer x and decided to add or subtract it from arbitrary array elements. Formally, by applying single operation Maxim chooses integer i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) and replaces the i-th element of array ai either with ai\xe2\x80\x89+\xe2\x80\x89x or with ai\xe2\x80\x89-\xe2\x80\x89x. Please note that the operation may be applied more than once to the same position.Maxim is a curious minimalis, thus he wants to know what is the minimum value that the product of all array elements (i.e. ) can reach, if Maxim would apply no more than k operations to it. Please help him in that." "constructive algorithms,data structures,greedy,math" 2000
1980F2 "Field Division (hard version)" "This is a hard version of the problem; it differs from the easy version only by the question. The easy version only needs you to print whether some values are non-zero or not. The hard version needs you to print the exact values.Alice and Bob are dividing the field. The field is a rectangle of size n\xc3\x97m (2\xe2\x89\xa4n,m\xe2\x89\xa4109); the rows are numbered from 1 to n from top to bottom, and the columns are numbered from 1 to m from left to right. The cell at the intersection of row r and column c is denoted as (r,c).Bob has k (2\xe2\x89\xa4k\xe2\x89\xa42\xe2\x8b\x85105) fountains, all of them are located in different cells of the field. Alice is responsible for dividing the field, but she must meet several conditions:  To divide the field, Alice will start her path in any free (without a fountain) cell on the left or top side of the field and will move, each time moving to the adjacent cell down or right. Her path will end on the right or bottom side of the field.  Alice\'s path will divide the field into two parts \xe2\x80\x94 one part will belong to Alice (this part includes the cells of her path), the other part \xe2\x80\x94 to Bob.  Alice will own the part that includes the cell (n,1).  Bob will own the part that includes the cell (1,m). Alice wants to divide the field in such a way as to get as many cells as possible.Bob wants to keep ownership of all the fountains, but he can give one of them to Alice. First, output the integer \xce\xb1 \xe2\x80\x94 the maximum possible size of Alice\'s plot, if Bob does not give her any fountain (i.e., all fountains will remain on Bob\'s plot).Then output k non-negative integers a1,a2,\xe2\x80\xa6,ak, where ai is a value such that after Bob gives Alice the i-th fountain, the maximum size of her plot will be \xce\xb1+ai." math,sortings 2400
1676A Lucky? "A ticket is a string consisting of six digits. A ticket is considered lucky if the sum of the first three digits is equal to the sum of the last three digits. Given a ticket, output if it is lucky or not. Note that a ticket can have leading zeroes." implementation 800
1832A "New Palindrome" "A palindrome is a string that reads the same from left to right as from right to left. For example, abacaba, aaaa, abba, racecar are palindromes.You are given a string s consisting of lowercase Latin letters. The string s is a palindrome.You have to check whether it is possible to rearrange the letters in it to get another palindrome (not equal to the given string s)." strings 800
1147F "Zigzag Game" "You are given a complete bipartite graph with 2n nodes, with n nodes on each side of the bipartition. Nodes 1 through n are on one side of the bipartition, and nodes n+1 to 2n are on the other side. You are also given an n\xc3\x97n matrix a describing the edge weights. aij denotes the weight of the edge between nodes i and j+n. Each edge has a distinct weight.Alice and Bob are playing a game on this graph. First Alice chooses to play as either ""increasing"" or ""decreasing"" for herself, and Bob gets the other choice. Then she places a token on any node of the graph. Bob then moves the token along any edge incident to that node. They now take turns playing the following game, with Alice going first.The current player must move the token from the current vertex to some adjacent unvisited vertex. Let w be the last weight of the last edge that was traversed. The edge that is traversed must be strictly greater than w if the player is playing as ""increasing"", otherwise, it must be strictly less. The first player unable to make a move loses.You are given n and the edge weights of the graph. You can choose to play as either Alice or Bob, and you will play against the judge. You must win all the games for your answer to be judged correct." games,interactive 3500
1405B "Array Cancellation" "You\'re given an array a of n integers, such that a1+a2+\xe2\x8b\xaf+an=0.In one operation, you can choose two different indices i and j (1\xe2\x89\xa4i,j\xe2\x89\xa4n), decrement ai by one and increment aj by one. If i<j this operation is free, otherwise it costs one coin.How many coins do you have to spend in order to make all elements equal to 0?" "constructive algorithms,implementation" 1000
1140B "Good String" "You have a string s of length n consisting of only characters > and <. You may do some operations with this string, for each operation you have to choose some character that still remains in the string. If you choose a character >, the character that comes right after it is deleted (if the character you chose was the last one, nothing happens). If you choose a character <, the character that comes right before it is deleted (if the character you chose was the first one, nothing happens).For example, if we choose character > in string > > < >, the string will become to > > >. And if we choose character < in string > <, the string will become to <.The string is good if there is a sequence of operations such that after performing it only one character will remain in the string. For example, the strings >, > > are good. Before applying the operations, you may remove any number of characters from the given string (possibly none, possibly up to n\xe2\x88\x921, but not the whole string). You need to calculate the minimum number of characters to be deleted from string s so that it becomes good." implementation,strings 1200
244A "Dividing Orange" "One day Ms Swan bought an orange in a shop. The orange consisted of n\xc2\xb7k segments, numbered with integers from 1 to n\xc2\xb7k. There were k children waiting for Ms Swan at home. The children have recently learned about the orange and they decided to divide it between them. For that each child took a piece of paper and wrote the number of the segment that he would like to get: the i-th (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k) child wrote the number ai (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ai\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xc2\xb7k). All numbers ai accidentally turned out to be different.Now the children wonder, how to divide the orange so as to meet these conditions:  each child gets exactly n orange segments;  the i-th child gets the segment with number ai for sure;  no segment goes to two children simultaneously. Help the children, divide the orange and fulfill the requirements, described above." implementation 900
316B1 EKG "In the rush of modern life, people often forget how beautiful the world is. The time to enjoy those around them is so little that some even stand in queues to several rooms at the same time in the clinic, running from one queue to another.(Cultural note: standing in huge and disorganized queues for hours is a native tradition in Russia, dating back to the Soviet period. Queues can resemble crowds rather than lines. Not to get lost in such a queue, a person should follow a strict survival technique: you approach the queue and ask who the last person is, somebody answers and you join the crowd. Now you\'re the last person in the queue till somebody else shows up. You keep an eye on the one who was last before you as he is your only chance to get to your destination) I\'m sure many people have had the problem when a stranger asks who the last person in the queue is and even dares to hint that he will be the last in the queue and then bolts away to some unknown destination. These are the representatives of the modern world, in which the ratio of lack of time is so great that they do not even watch foreign top-rated TV series. Such people often create problems in queues, because the newcomer does not see the last person in the queue and takes a place after the ""virtual"" link in this chain, wondering where this legendary figure has left.The Smart Beaver has been ill and he\'s made an appointment with a therapist. The doctor told the Beaver the sad news in a nutshell: it is necessary to do an electrocardiogram. The next day the Smart Beaver got up early, put on the famous TV series on download (three hours till the download\'s complete), clenched his teeth and bravely went to join a queue to the electrocardiogram room, which is notorious for the biggest queues at the clinic.Having stood for about three hours in the queue, the Smart Beaver realized that many beavers had not seen who was supposed to stand in the queue before them and there was a huge mess. He came up to each beaver in the ECG room queue and asked who should be in front of him in the queue. If the beaver did not know his correct position in the queue, then it might be his turn to go get an ECG, or maybe he should wait for a long, long time...As you\'ve guessed, the Smart Beaver was in a hurry home, so he gave you all the necessary information for you to help him to determine what his number in the queue can be." "brute force,dfs and similar" 1500
148A "Insomnia cure" "\xc2\xabOne dragon. Two dragon. Three dragon\xc2\xbb, \xe2\x80\x94 the princess was counting. She had trouble falling asleep, and she got bored of counting lambs when she was nine.However, just counting dragons was boring as well, so she entertained herself at best she could. Tonight she imagined that all dragons were here to steal her, and she was fighting them off. Every k-th dragon got punched in the face with a frying pan. Every l-th dragon got his tail shut into the balcony door. Every m-th dragon got his paws trampled with sharp heels. Finally, she threatened every n-th dragon to call her mom, and he withdrew in panic.How many imaginary dragons suffered moral or physical damage tonight, if the princess counted a total of d dragons?" "constructive algorithms,implementation,math" 800
63D "Dividing Island" "A revolution took place on the Buka Island. New government replaced the old one. The new government includes n parties and each of them is entitled to some part of the island according to their contribution to the revolution. However, they can\'t divide the island.The island can be conventionally represented as two rectangles a\xe2\x80\x89\xc3\x97\xe2\x80\x89b and c\xe2\x80\x89\xc3\x97\xe2\x80\x89d unit squares in size correspondingly. The rectangles are located close to each other. At that, one of the sides with the length of a and one of the sides with the length of c lie on one line. You can see this in more details on the picture.  The i-th party is entitled to a part of the island equal to xi unit squares. Every such part should fully cover several squares of the island (it is not allowed to cover the squares partially) and be a connected figure. A ""connected figure"" presupposes that from any square of this party one can move to any other square of the same party moving through edge-adjacent squares also belonging to that party.Your task is to divide the island between parties." "constructive algorithms" 1900
1537B "Bad Boy" "Riley is a very bad boy, but at the same time, he is a yo-yo master. So, he decided to use his yo-yo skills to annoy his friend Anton.Anton\'s room can be represented as a grid with n rows and m columns. Let (i,j) denote the cell in row i and column j. Anton is currently standing at position (i,j) in his room. To annoy Anton, Riley decided to throw exactly two yo-yos in cells of the room (they can be in the same cell).Because Anton doesn\'t like yo-yos thrown on the floor, he has to pick up both of them and return back to the initial position. The distance travelled by Anton is the shortest path that goes through the positions of both yo-yos and returns back to (i,j) by travelling only to adjacent by side cells. That is, if he is in cell (x,y) then he can travel to the cells (x+1,y), (x\xe2\x88\x921,y), (x,y+1) and (x,y\xe2\x88\x921) in one step (if a cell with those coordinates exists).Riley is wondering where he should throw these two yo-yos so that the distance travelled by Anton is maximized. But because he is very busy, he asked you to tell him." "constructive algorithms,greedy,math" 900
862D "Mahmoud and Ehab and the binary string" "Mahmoud and Ehab are in the fourth stage now.Dr. Evil has a hidden binary string of length n. He guarantees that there is at least one \'0\' symbol and at least one \'1\' symbol in it. Now he wants Mahmoud and Ehab to find a position of any \'0\' symbol and any \'1\' symbol. In order to do this, Mahmoud and Ehab can ask Dr. Evil up to 15 questions. They tell Dr. Evil some binary string of length n, and Dr. Evil tells the Hamming distance between these two strings. Hamming distance between 2 binary strings of the same length is the number of positions in which they have different symbols. You can find the definition of Hamming distance in the notes section below.Help Mahmoud and Ehab find these two positions.You will get Wrong Answer verdict if   Your queries doesn\'t satisfy interaction protocol described below.  You ask strictly more than 15 questions and your program terminated after exceeding queries limit. Please note, that you can do up to 15 ask queries and one answer query.  Your final answer is not correct.  You will get Idleness Limit Exceeded if you don\'t print anything or if you forget to flush the output, including for the final answer (more info about flushing output below).If you exceed the maximum number of queries, You should terminate with 0, In this case you\'ll get Wrong Answer, If you don\'t terminate you may receive any verdict because you\'ll be reading from a closed stream ." "binary search,divide and conquer,interactive" 2000
1085B "Div Times Mod" "Vasya likes to solve equations. Today he wants to solve (x div k)\xe2\x8b\x85(xmodk)=n, where div and mod stand for integer division and modulo operations (refer to the Notes below for exact definition). In this equation, k and n are positive integer parameters, and x is a positive integer unknown. If there are several solutions, Vasya wants to find the smallest possible x. Can you help him?" math 1100
774B "Significant Cups" "Stepan is a very experienced olympiad participant. He has n cups for Physics olympiads and m cups for Informatics olympiads. Each cup is characterized by two parameters \xe2\x80\x94 its significance ci and width wi.Stepan decided to expose some of his cups on a shelf with width d in such a way, that:  there is at least one Physics cup and at least one Informatics cup on the shelf,  the total width of the exposed cups does not exceed d,  from each subjects (Physics and Informatics) some of the most significant cups are exposed (i. e. if a cup for some subject with significance x is exposed, then all the cups for this subject with significance greater than x must be exposed too). Your task is to determine the maximum possible total significance, which Stepan can get when he exposes cups on the shelf with width d, considering all the rules described above. The total significance is the sum of significances of all the exposed cups." "*special problem,binary search,data structures,two pointers" 2100
1593F "Red-Black Number" "It is given a non-negative integer x, the decimal representation of which contains n digits. You need to color each its digit in red or black, so that the number formed by the red digits is divisible by A, and the number formed by the black digits is divisible by B.At least one digit must be colored in each of two colors. Consider, the count of digits colored in red is r and the count of digits colored in black is b. Among all possible colorings of the given number x, you need to output any such that the value of |r\xe2\x88\x92b| is the minimum possible.Note that the number x and the numbers formed by digits of each color, may contain leading zeros.  Example of painting a number for A=3 and B=13 The figure above shows an example of painting the number x=02165 of n=5 digits for A=3 and B=13. The red digits form the number 015, which is divisible by 3, and the black ones \xe2\x80\x94 26, which is divisible by 13. Note that the absolute value of the difference between the counts of red and black digits is 1, it is impossible to achieve a smaller value." "dfs and similar,dp,implementation,math,meet-in-the-middle" 2100
131B "Opposites Attract" "Everybody knows that opposites attract. That is the key principle of the ""Perfect Matching"" dating agency. The ""Perfect Matching"" matchmakers have classified each registered customer by his interests and assigned to the i-th client number ti (\xe2\x80\x89-\xe2\x80\x8910\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ti\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x8910). Of course, one number can be assigned to any number of customers.""Perfect Matching"" wants to advertise its services and publish the number of opposite couples, that is, the couples who have opposite values of t. Each couple consists of exactly two clients. The customer can be included in a couple an arbitrary number of times. Help the agency and write the program that will find the sought number by the given sequence t1,\xe2\x80\x89t2,\xe2\x80\x89...,\xe2\x80\x89tn. For example, if t\xe2\x80\x89=\xe2\x80\x89(1,\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x891,\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x891), then any two elements ti and tj form a couple if i and j have different parity. Consequently, in this case the sought number equals 4.Of course, a client can\'t form a couple with him/herself." implementation,math 1200
2026B "Black Cells" "You are given a strip divided into cells, numbered from left to right from 0 to 1018. Initially, all cells are white.You can perform the following operation: choose two white cells i and j, such that i\xe2\x89\xa0j and |i\xe2\x88\x92j|\xe2\x89\xa4k, and paint them black.A list a is given. All cells from this list must be painted black. Additionally, at most one cell that is not in this list can also be painted black. Your task is to determine the minimum value of k for which this is possible." "binary search,brute force,constructive algorithms,greedy" 1300
1481F "AB Tree" "Kilani and Abd are neighbors for 3000 years, but then the day came and Kilani decided to move to another house. As a farewell gift, Kilani is going to challenge Abd with a problem written by their other neighbor with the same name Abd.  The problem is:You are given a connected tree rooted at node 1.You should assign a character a or b to every node in the tree so that the total number of a\'s is equal to x and the total number of b\'s is equal to n\xe2\x88\x92x.Let\'s define a string for each node v of the tree as follows:   if v is root then the string is just one character assigned to v:  otherwise, let\'s take a string defined for the v\'s parent pv and add to the end of it a character assigned to v. You should assign every node a character in a way that minimizes the number of distinct strings among the strings of all nodes." dp,greedy,trees 3100
2023E "Tree of Life" "In the heart of an ancient kingdom grows the legendary Tree of Life \xe2\x80\x94 the only one of its kind and the source of magical power for the entire world. The tree consists of n nodes. Each node of this tree is a magical source, connected to other such sources through magical channels (edges). In total, there are n\xe2\x88\x921 channels in the tree, with the i-th channel connecting nodes vi and ui. Moreover, there exists a unique simple path through the channels between any two nodes in the tree.However, the magical energy flowing through these channels must be balanced; otherwise, the power of the Tree of Life may disrupt the natural order and cause catastrophic consequences. The sages of the kingdom discovered that when two magical channels converge at a single node, a dangerous ""magical resonance vibration"" occurs between them. To protect the Tree of Life and maintain its balance, it is necessary to select several paths and perform special rituals along them. A path is a sequence of distinct nodes v1,v2,\xe2\x80\xa6,vk, where each pair of adjacent nodes vi and vi+1 is connected by a channel. When the sages perform a ritual along such a path, the resonance vibration between the channels (vi,vi+1) and (vi+1,vi+2) is blocked for each 1\xe2\x89\xa4i\xe2\x89\xa4k\xe2\x88\x922.The sages\' task is to select the minimum number of paths and perform rituals along them to block all resonance vibrations. This means that for every pair of channels emanating from a single node, there must exist at least one selected path that contains both of these channels.Help the sages find the minimum number of such paths so that the magical balance of the Tree of Life is preserved, and its power continues to nourish the entire world!" dp,greedy,trees 3300
1608E "The Cells on the Paper" "On an endless checkered sheet of paper, n cells are chosen and colored in three colors, where n is divisible by 3. It turns out that there are exactly n3 marked cells of each of three colors! Find the largest such k that it\'s possible to choose k3 cells of each color, remove all other marked cells, and then select three rectangles with sides parallel to the grid lines so that the following conditions hold:  No two rectangles can intersect (but they can share a part of the boundary). In other words, the area of intersection of any two of these rectangles must be 0. The i-th rectangle contains all the chosen cells of the i-th color and no chosen cells of other colors, for i=1,2,3." "binary search,implementation,sortings" 2800
1185D "Extra Element" "A sequence a1,a2,\xe2\x80\xa6,ak is called an arithmetic progression if for each i from 1 to k elements satisfy the condition ai=a1+c\xe2\x8b\x85(i\xe2\x88\x921) for some fixed c.For example, these five sequences are arithmetic progressions: [5,7,9,11], [101], [101,100,99], [13,97] and [5,5,5,5,5]. And these four sequences aren\'t arithmetic progressions: [3,1,2], [1,2,4,8], [1,\xe2\x88\x921,1,\xe2\x88\x921] and [1,2,3,3,3].You are given a sequence of integers b1,b2,\xe2\x80\xa6,bn. Find any index j (1\xe2\x89\xa4j\xe2\x89\xa4n), such that if you delete bj from the sequence, you can reorder the remaining n\xe2\x88\x921 elements, so that you will get an arithmetic progression. If there is no such index, output the number -1." implementation,math 1700
137A "Postcards and photos" "Polycarpus has postcards and photos hung in a row on the wall. He decided to put them away to the closet and hang on the wall a famous painter\'s picture. Polycarpus does it like that: he goes from the left to the right and removes the objects consecutively. As Polycarpus doesn\'t want any mix-ups to happen, he will not carry in his hands objects of two different types. In other words, Polycarpus can\'t carry both postcards and photos simultaneously. Sometimes he goes to the closet and puts the objects there, thus leaving his hands free. Polycarpus must put all the postcards and photos to the closet. He cannot skip objects. What minimum number of times he should visit the closet if he cannot carry more than 5 items?" implementation 900
1341B "Nastya and Door" "On February 14 Denis decided to give Valentine to Nastya and did not come up with anything better than to draw a huge red heart on the door of the length k (k\xe2\x89\xa53). Nastya was very confused by this present, so she decided to break the door, throwing it on the mountains.Mountains are described by a sequence of heights a1,a2,\xe2\x80\xa6,an in order from left to right (k\xe2\x89\xa4n). It is guaranteed that neighboring heights are not equal to each other (that is, ai\xe2\x89\xa0ai+1 for all i from 1 to n\xe2\x88\x921).Peaks of mountains on the segment [l,r] (from l to r) are called indexes i such that l<i<r, ai\xe2\x88\x921<ai and ai>ai+1. It is worth noting that the boundary indexes l and r for the segment are not peaks. For example, if n=8 and a=[3,1,4,1,5,9,2,6], then the segment [1,8] has only two peaks (with indexes 3 and 6), and there are no peaks on the segment [3,6].To break the door, Nastya throws it to a segment [l,l+k\xe2\x88\x921] of consecutive mountains of length k (1\xe2\x89\xa4l\xe2\x89\xa4n\xe2\x88\x92k+1). When the door touches the peaks of the mountains, it breaks into two parts, after that these parts will continue to fall in different halves and also break into pieces when touching the peaks of the mountains, and so on. Formally, the number of parts that the door will break into will be equal to p+1, where p is the number of peaks on the segment [l,l+k\xe2\x88\x921].Nastya wants to break it into as many pieces as possible. Help her choose such a segment of mountains [l,l+k\xe2\x88\x921] that the number of peaks on it is maximum. If there are several optimal segments, Nastya wants to find one for which the value l is minimal.Formally, you need to choose a segment of mountains [l,l+k\xe2\x88\x921] that has the maximum number of peaks. Among all such segments, you need to find the segment that has the minimum possible value l." greedy,implementation 1300
535B "Tavas and SaDDas" "Once again Tavas started eating coffee mix without water! Keione told him that it smells awful, but he didn\'t stop doing that. That\'s why Keione told his smart friend, SaDDas to punish him! SaDDas took Tavas\' headphones and told him: ""If you solve the following problem, I\'ll return it to you.""  The problem is: You are given a lucky number n. Lucky numbers are the positive integers whose decimal representations contain only the lucky digits 4 and 7. For example, numbers 47, 744, 4 are lucky and 5, 17, 467 are not.If we sort all lucky numbers in increasing order, what\'s the 1-based index of n? Tavas is not as smart as SaDDas, so he asked you to do him a favor and solve this problem so he can have his headphones back." "bitmasks,brute force,combinatorics,implementation" 1100
714B "Filya and Homework" "Today, hedgehog Filya went to school for the very first time! Teacher gave him a homework which Filya was unable to complete without your help.Filya is given an array of non-negative integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. First, he pick an integer x and then he adds x to some elements of the array (no more than once), subtract x from some other elements (also, no more than once) and do no change other elements. He wants all elements of the array to be equal.Now he wonders if it\'s possible to pick such integer x and change some elements of the array using this x in order to make all elements equal." implementation,sortings 1200
1612G "Max Sum Array" "You are given an array c=[c1,c2,\xe2\x80\xa6,cm]. An array a=[a1,a2,\xe2\x80\xa6,an] is constructed in such a way that it consists of integers 1,2,\xe2\x80\xa6,m, and for each i\xe2\x88\x88[1,m], there are exactly ci occurrences of integer i in a. So, the number of elements in a is exactly m\xe2\x88\x91i=1ci.Let\'s define for such array a the value f(a) as f(a)=\xe2\x88\x911\xe2\x89\xa4i<j\xe2\x89\xa4nai=ajj\xe2\x88\x92i.In other words, f(a) is the total sum of distances between all pairs of equal elements.Your task is to calculate the maximum possible value of f(a) and the number of arrays yielding the maximum possible value of f(a). Two arrays are considered different, if elements at some position differ." "combinatorics,constructive algorithms,greedy,sortings" 2500
1919C "Grouping Increases" "You are given an array a of size n. You will do the following process to calculate your penalty:   Split array a into two (possibly empty) subsequences\xe2\x80\xa0 s and t such that every element of a is either in s or t\xe2\x80\xa1.  For an array b of size m, define the penalty p(b) of an array b as the number of indices i between 1 and m\xe2\x88\x921 where bi<bi+1.  The total penalty you will receive is p(s)+p(t). If you perform the above process optimally, find the minimum possible penalty you will receive.\xe2\x80\xa0 A sequence x is a subsequence of a sequence y if x can be obtained from y by the deletion of several (possibly, zero or all) elements.\xe2\x80\xa1 Some valid ways to split array a=[3,1,4,1,5] into (s,t) are ([3,4,1,5],[1]), ([1,1],[3,4,5]) and ([],[3,1,4,1,5]) while some invalid ways to split a are ([3,4,5],[1]), ([3,1,4,1],[1,5]) and ([1,3,4],[5,1])." "data structures,dp,greedy" 1400
1158C "Permutation recovery" "Vasya has written some permutation p1,p2,\xe2\x80\xa6,pn of integers from 1 to n, so for all 1\xe2\x89\xa4i\xe2\x89\xa4n it is true that 1\xe2\x89\xa4pi\xe2\x89\xa4n and all p1,p2,\xe2\x80\xa6,pn are different. After that he wrote n numbers next1,next2,\xe2\x80\xa6,nextn. The number nexti is equal to the minimal index i<j\xe2\x89\xa4n, such that pj>pi. If there is no such j let\'s let\'s define as nexti=n+1.In the evening Vasya went home from school and due to rain, his notebook got wet. Now it is impossible to read some written numbers. Permutation and some values nexti are completely lost! If for some i the value nexti is lost, let\'s say that nexti=\xe2\x88\x921.You are given numbers next1,next2,\xe2\x80\xa6,nextn (maybe some of them are equal to \xe2\x88\x921). Help Vasya to find such permutation p1,p2,\xe2\x80\xa6,pn of integers from 1 to n, that he can write it to the notebook and all numbers nexti, which are not equal to \xe2\x88\x921, will be correct." "constructive algorithms,data structures,dfs and similar,graphs,greedy,math,sortings" 2100
1108E1 "Array and Segments (Easy version)" "The only difference between easy and hard versions is a number of elements in the array.You are given an array a consisting of n integers. The value of the i-th element of the array is ai.You are also given a set of m segments. The j-th segment is [lj;rj], where 1\xe2\x89\xa4lj\xe2\x89\xa4rj\xe2\x89\xa4n.You can choose some subset of the given set of segments and decrease values on each of the chosen segments by one (independently). For example, if the initial array a=[0,0,0,0,0] and the given segments are [1;3] and [2;4] then you can choose both of them and the array will become b=[\xe2\x88\x921,\xe2\x88\x922,\xe2\x88\x922,\xe2\x88\x921,0].You have to choose some subset of the given segments (each segment can be chosen at most once) in such a way that if you apply this subset of segments to the array a and obtain the array b then the value nmaxi=1bi\xe2\x88\x92nmini=1bi will be maximum possible.Note that you can choose the empty set.If there are multiple answers, you can print any.If you are Python programmer, consider using PyPy instead of Python when you submit your code." "brute force,greedy,implementation" 1800
11A "Increasing Sequence" "A sequence a0,\xe2\x80\x89a1,\xe2\x80\x89...,\xe2\x80\x89at\xe2\x80\x89-\xe2\x80\x891 is called increasing if ai\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89<\xe2\x80\x89ai for each i:\xe2\x80\x890\xe2\x80\x89<\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89t.You are given a sequence b0,\xe2\x80\x89b1,\xe2\x80\x89...,\xe2\x80\x89bn\xe2\x80\x89-\xe2\x80\x891 and a positive integer d. In each move you may choose one element of the given sequence and add d to it. What is the least number of moves required to make the given sequence increasing?" "constructive algorithms,implementation,math" 900
577B "Modulo Sum" "You are given a sequence of numbers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an, and a number m.Check if it is possible to choose a non-empty subsequence aij such that the sum of numbers in this subsequence is divisible by m." "combinatorics,data structures,dp,two pointers" 1900
1401F "Reverse and Swap" "You are given an array a of length 2n. You should process q queries on it. Each query has one of the following 4 types:   Replace(x,k) \xe2\x80\x94 change ax to k;  Reverse(k) \xe2\x80\x94 reverse each subarray [(i\xe2\x88\x921)\xe2\x8b\x852k+1,i\xe2\x8b\x852k] for all i (i\xe2\x89\xa51);  Swap(k) \xe2\x80\x94 swap subarrays [(2i\xe2\x88\x922)\xe2\x8b\x852k+1,(2i\xe2\x88\x921)\xe2\x8b\x852k] and [(2i\xe2\x88\x921)\xe2\x8b\x852k+1,2i\xe2\x8b\x852k] for all i (i\xe2\x89\xa51);  Sum(l,r) \xe2\x80\x94 print the sum of the elements of subarray [l,r]. Write a program that can quickly process given queries." "binary search,bitmasks,data structures" 2400
608B "Hamming Distance Sum" "Genos needs your help. He was asked to solve the following programming problem by Saitama:The length of some string s is denoted |s|. The Hamming distance between two strings s and t of equal length is defined as , where si is the i-th character of s and ti is the i-th character of t. For example, the Hamming distance between string ""0011"" and string ""0110"" is |0\xe2\x80\x89-\xe2\x80\x890|\xe2\x80\x89+\xe2\x80\x89|0\xe2\x80\x89-\xe2\x80\x891|\xe2\x80\x89+\xe2\x80\x89|1\xe2\x80\x89-\xe2\x80\x891|\xe2\x80\x89+\xe2\x80\x89|1\xe2\x80\x89-\xe2\x80\x890|\xe2\x80\x89=\xe2\x80\x890\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x890\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89=\xe2\x80\x892.Given two binary strings a and b, find the sum of the Hamming distances between a and all contiguous substrings of b of length |a|." combinatorics,strings 1500
217E "Alien DNA" "Professor Bajtocy is conducting experiments on alien DNA. He has discovered that it is subject to repetitive mutations \xe2\x80\x94 each mutation happens in the same way: some continuous subsequence of the alien DNA becomes active, copies itself, the copy gets mangled and inserts itself right after the original subsequence. The mangled copy of the activated continuous subsequence is formed by first joining all the elements at the even positions in that subsequence, and then joining all the elements at the odd ones at the end. That is, if the activated subsequence consists of 11 elements and represented as s1s2... s11, its mangled copy is s2s4s6s8s10s1s3s5s7s9s11.For example, if the original sequence was ""ACTGG"" and the mutation happened on the segment [2,\xe2\x80\x894] (that is the activated subsequence is ""CTG""), the mutated DNA is: ""ACTGTCGG"". The mangled copy of the activated subsequence is marked with bold font.Professor Bajtocy has written down the original DNA sequence and the mutations that sequentially happened to it, and he now asks you to recover the first k elements of the DNA sequence after all the mutations." "data structures,dsu,trees" 2800
641E "Little Artem and Time Machine" "Little Artem has invented a time machine! He could go anywhere in time, but all his thoughts of course are with computer science. He wants to apply this time machine to a well-known data structure: multiset.Artem wants to create a basic multiset of integers. He wants these structure to support operations of three types:  Add integer to the multiset. Note that the difference between set and multiset is that multiset may store several instances of one integer.  Remove integer from the multiset. Only one instance of this integer is removed. Artem doesn\'t want to handle any exceptions, so he assumes that every time remove operation is called, that integer is presented in the multiset.  Count the number of instances of the given integer that are stored in the multiset. But what about time machine? Artem doesn\'t simply apply operations to the multiset one by one, he now travels to different moments of time and apply his operation there. Consider the following example.  First Artem adds integer 5 to the multiset at the 1-st moment of time.  Then Artem adds integer 3 to the multiset at the moment 5.  Then Artem asks how many 5 are there in the multiset at moment 6. The answer is 1.  Then Artem returns back in time and asks how many integers 3 are there in the set at moment 4. Since 3 was added only at moment 5, the number of integers 3 at moment 4 equals to 0.  Then Artem goes back in time again and removes 5 from the multiset at moment 3.  Finally Artyom asks at moment 7 how many integers 5 are there in the set. The result is 0, since we have removed 5 at the moment 3. Note that Artem dislikes exceptions so much that he assures that after each change he makes all delete operations are applied only to element that is present in the multiset. The answer to the query of the third type is computed at the moment Artem makes the corresponding query and are not affected in any way by future changes he makes.Help Artem implement time travellers multiset." "data structures" 2000
675D "Tree Construction" "During the programming classes Vasya was assigned a difficult problem. However, he doesn\'t know how to code and was unable to find the solution in the Internet, so he asks you to help.You are given a sequence a, consisting of n distinct integers, that is used to construct the binary search tree. Below is the formal description of the construction process.  First element a1 becomes the root of the tree.  Elements a2,a3,\xe2\x80\xa6,an are added one by one. To add element ai one needs to traverse the tree starting from the root and using the following rules:   The pointer to the current node is set to the root.  If ai is greater than the value in the current node, then its right child becomes the current node. Otherwise, the left child of the current node becomes the new current node.  If at some point there is no required child, the new node is created, it is assigned value ai and becomes the corresponding child of the current node." "data structures,trees" 1800
1488B "RBS Deletion" "A bracket sequence is a string containing only characters ""("" and "")"". A regular bracket sequence (or, shortly, an RBS) is a bracket sequence that can be transformed into a correct arithmetic expression by inserting characters ""1"" and ""+"" between the original characters of the sequence. For example:  bracket sequences ""()()"" and ""(())"" are regular (the resulting expressions are: ""(1)+(1)"" and ""((1+1)+1)"");  bracket sequences "")("", ""("" and "")"" are not. You are given a string s, which is an RBS. You can apply any number of operations to this string. Each operation can have one of the following types:  choose some non-empty prefix of s and remove it from s, so s is still an RBS. For example, we can apply this operation as follows: ""(())()(())()()"" \xe2\x86\x92 ""()()"" (the first 10 characters are removed);  choose some contiguous non-empty substring of s and remove it from s, so s is still an RBS. For example, we can apply this operation as follows: ""(())()(())()()"" \xe2\x86\x92 ""(())()()()"" (the characters from the 7-th to the 10-th are removed). The operation 2 can be applied at most k times. Calculate the maximum number of operations you can apply until s becomes empty." "*special problem,greedy" 1800
1878G "wxhtzdy ORO Tree" "After (finally) qualifying for the IOI 2023, wxhtzdy was very happy, so he decided to do what most competitive programmers do: trying to guess the problems that will be on IOI. During this process, he accidentally made a problem, which he thought was really cool.You are given a tree (a connected acyclic graph) with n vertices and n\xe2\x88\x921 edges. Vertex i (1\xe2\x89\xa4i\xe2\x89\xa4n) has a value ai. Lets\' define g(u,v) as the bitwise or of the values of all vertices on the shortest path from u to v. For example, let\'s say that we want to calculate g(3,4), on the tree from the first test case in the example. On the path from 3 to 4 are vertices 3, 1, 4. Then, g(3,4)=a3 | a1 | a4 (here, | represents the bitwise OR operation).Also, you are given q queries, and each query looks like this:You are given x and y. Let\'s consider all vertices z such that z is on the shortest path from x to y (inclusive).Lets define the niceness of a vertex z as the sum of the number of non-zero bits in g(x,z) and the number of non-zero bits in g(y,z). You need to find the maximum niceness among all vertices z on the shortest path from x to y.Since his brain is really tired after solving an output only problem on SIO (he had to do it to qualify for the IOI), he wants your help with this problem." "binary search,bitmasks,brute force,data structures,dfs and similar,implementation,trees" 2300
1141F2 "Same Sum Blocks (Hard)" "This problem is given in two editions, which differ exclusively in the constraints on the number n.You are given an array of integers a[1],a[2],\xe2\x80\xa6,a[n]. A block is a sequence of contiguous (consecutive) elements a[l],a[l+1],\xe2\x80\xa6,a[r] (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n). Thus, a block is defined by a pair of indices (l,r).Find a set of blocks (l1,r1),(l2,r2),\xe2\x80\xa6,(lk,rk) such that:  They do not intersect (i.e. they are disjoint). Formally, for each pair of blocks (li,ri) and (lj,rj) where i\xe2\x89\xa0j either ri<lj or rj<li.  For each block the sum of its elements is the same. Formally, a[l1]+a[l1+1]+\xe2\x8b\xaf+a[r1]=a[l2]+a[l2+1]+\xe2\x8b\xaf+a[r2]= \xe2\x8b\xaf= a[lk]+a[lk+1]+\xe2\x8b\xaf+a[rk].  The number of the blocks in the set is maximum. Formally, there does not exist a set of blocks (l\xe2\x80\xb21,r\xe2\x80\xb21),(l\xe2\x80\xb22,r\xe2\x80\xb22),\xe2\x80\xa6,(l\xe2\x80\xb2k\xe2\x80\xb2,r\xe2\x80\xb2k\xe2\x80\xb2) satisfying the above two requirements with k\xe2\x80\xb2>k.   The picture corresponds to the first example. Blue boxes illustrate blocks. Write a program to find such a set of blocks." "data structures,greedy" 1900
1153C "Serval and Parenthesis Sequence" "Serval soon said goodbye to Japari kindergarten, and began his life in Japari Primary School.In his favorite math class, the teacher taught him the following interesting definitions.A parenthesis sequence is a string, containing only characters ""("" and "")"".A correct parenthesis sequence is a parenthesis sequence that can be transformed into a correct arithmetic expression by inserting characters ""1"" and ""+"" between the original characters of the sequence. For example, parenthesis sequences ""()()"", ""(())"" are correct (the resulting expressions are: ""(1+1)+(1+1)"", ""((1+1)+1)""), while "")("" and "")"" are not. Note that the empty string is a correct parenthesis sequence by definition.We define that |s| as the length of string s. A strict prefix s[1\xe2\x80\xa6l] (1\xe2\x89\xa4l<|s|) of a string s=s1s2\xe2\x80\xa6s|s| is string s1s2\xe2\x80\xa6sl. Note that the empty string and the whole string are not strict prefixes of any string by the definition.Having learned these definitions, he comes up with a new problem. He writes down a string s containing only characters ""("", "")"" and ""?"". And what he is going to do, is to replace each of the ""?"" in s independently by one of ""("" and "")"" to make all strict prefixes of the new sequence not a correct parenthesis sequence, while the new sequence should be a correct parenthesis sequence.After all, he is just a primary school student so this problem is too hard for him to solve. As his best friend, can you help him to replace the question marks? If there are many solutions, any of them is acceptable." greedy,strings 1700
1996C Sort "You are given two strings a and b of length n. Then, you are (forced against your will) to answer q queries.For each query, you are given a range bounded by l and r. In one operation, you can choose an integer i (l\xe2\x89\xa4i\xe2\x89\xa4r) and set ai=x where x is any character you desire. Output the minimum number of operations you must perform such that sorted(a[l..r])=sorted(b[l..r]). The operations you perform on one query does not affect other queries.For an arbitrary string c, sorted(c[l..r]) denotes the substring consisting of characters cl,cl+1,...,cr sorted in lexicographical order." dp,greedy,sortings,strings 1200
61D "Eternal Victory" "Valerian was captured by Shapur. The victory was such a great one that Shapur decided to carve a scene of Valerian\'s defeat on a mountain. So he had to find the best place to make his victory eternal!He decided to visit all n cities of Persia to find the best available mountain, but after the recent war he was too tired and didn\'t want to traverse a lot. So he wanted to visit each of these n cities at least once with smallest possible traverse. Persian cities are connected with bidirectional roads. You can go from any city to any other one using these roads and there is a unique path between each two cities.All cities are numbered 1 to n. Shapur is currently in the city 1 and he wants to visit all other cities with minimum possible traverse. He can finish his travels in any city.Help Shapur find how much He should travel." "dfs and similar,graphs,greedy,shortest paths,trees" 1800
1604A Era "Shohag has an integer sequence a1,a2,\xe2\x80\xa6,an. He can perform the following operation any number of times (possibly, zero):  Select any positive integer k (it can be different in different operations).  Choose any position in the sequence (possibly the beginning or end of the sequence, or in between any two elements) and insert k into the sequence at this position.  This way, the sequence a changes, and the next operation is performed on this changed sequence. For example, if a=[3,3,4] and he selects k=2, then after the operation he can obtain one of the sequences [2_,3,3,4], [3,2_,3,4], [3,3,2_,4], or [3,3,4,2_].Shohag wants this sequence to satisfy the following condition: for each 1\xe2\x89\xa4i\xe2\x89\xa4|a|, ai\xe2\x89\xa4i. Here, |a| denotes the size of a.Help him to find the minimum number of operations that he has to perform to achieve this goal. We can show that under the constraints of the problem it\'s always possible to achieve this goal in a finite number of operations." greedy 800
1354D Multiset "Note that the memory limit is unusual.You are given a multiset consisting of n integers. You have to process queries of two types:  add integer k into the multiset;  find the k-th order statistics in the multiset and remove it. k-th order statistics in the multiset is the k-th element in the sorted list of all elements of the multiset. For example, if the multiset contains elements 1, 4, 2, 1, 4, 5, 7, and k=3, then you have to find the 3-rd element in [1,1,2,4,4,5,7], which is 2. If you try to delete an element which occurs multiple times in the multiset, only one occurence is removed. After processing all queries, print any number belonging to the multiset, or say that it is empty." "binary search,data structures" 1900
675C "Money Transfers" "There are n banks in the city where Vasya lives, they are located in a circle, such that any two banks are neighbouring if their indices differ by no more than 1. Also, bank 1 and bank n are neighbours if n\xe2\x80\x89>\xe2\x80\x891. No bank is a neighbour of itself.Vasya has an account in each bank. Its balance may be negative, meaning Vasya owes some money to this bank.There is only one type of operations available: transfer some amount of money from any bank to account in any neighbouring bank. There are no restrictions on the size of the sum being transferred or balance requirements to perform this operation.Vasya doesn\'t like to deal with large numbers, so he asks you to determine the minimum number of operations required to change the balance of each bank account to zero. It\'s guaranteed, that this is possible to achieve, that is, the total balance of Vasya in all banks is equal to zero." "constructive algorithms,data structures,greedy,sortings" 2100
1346G "Two IP Cameras" "You have two IP cameras of the same model. Each camera can take photos starting from some moment of time with a fixed period. You can freely choose the starting moment but you can choose the period only as one of k values p1,p2,\xe2\x80\xa6,pk which are chosen by the camera\'s manufacturer.You have n moments of interest x1,x2,\xe2\x80\xa6,xn. You\'d like to configure both cameras in such a way that at least one camera will take a photo in each of these moments. Configuring the camera means setting the moment when it takes the first photo and the gap between two consecutive photos (which should be one of the values p1,p2,\xe2\x80\xa6,pk). It\'s not a problem for you that cameras can take photos at other moments of time \xe2\x80\x94 you only care about moments of interest." "*special problem,math,number theory" 2300
29A "Spit Problem" "In a Berland\'s zoo there is an enclosure with camels. It is known that camels like to spit. Bob watched these interesting animals for the whole day and registered in his notepad where each animal spitted. Now he wants to know if in the zoo there are two camels, which spitted at each other. Help him to solve this task.The trajectory of a camel\'s spit is an arc, i.e. if the camel in position x spits d meters right, he can hit only the camel in position x\xe2\x80\x89+\xe2\x80\x89d, if such a camel exists." "brute force" 1000
1712C "Sort Zero" "An array is sorted if it has no inversionsA Young BoyYou are given an array of n positive integers a1,a2,\xe2\x80\xa6,an. In one operation you do the following:   Choose any integer x.  For all i such that ai=x, do ai:=0 (assign 0 to ai). Find the minimum number of operations required to sort the array in non-decreasing order." greedy,sortings 1100
785E "Anton and Permutation" "Anton likes permutations, especially he likes to permute their elements. Note that a permutation of n elements is a sequence of numbers {a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an}, in which every number from 1 to n appears exactly once.One day Anton got a new permutation and started to play with it. He does the following operation q times: he takes two elements of the permutation and swaps these elements. After each operation he asks his friend Vanya, how many inversions there are in the new permutation. The number of inversions in a permutation is the number of distinct pairs (i,\xe2\x80\x89j) such that 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n and ai\xe2\x80\x89>\xe2\x80\x89aj.Vanya is tired of answering Anton\'s silly questions. So he asked you to write a program that would answer these questions instead of him.Initially Anton\'s permutation was {1,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89n}, that is ai\xe2\x80\x89=\xe2\x80\x89i for all i such that 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n." "brute force,data structures" 2200
33A "What is for dinner?" "In one little known, but very beautiful country called Waterland, lives a lovely shark Valerie. Like all the sharks, she has several rows of teeth, and feeds on crucians. One of Valerie\'s distinguishing features is that while eating one crucian she uses only one row of her teeth, the rest of the teeth are ""relaxing"".For a long time our heroine had been searching the sea for crucians, but a great misfortune happened. Her teeth started to ache, and she had to see the local dentist, lobster Ashot. As a professional, Ashot quickly relieved Valerie from her toothache. Moreover, he managed to determine the cause of Valerie\'s developing caries (for what he was later nicknamed Cap).It turned that Valerie eats too many crucians. To help Valerie avoid further reoccurrence of toothache, Ashot found for each Valerie\'s tooth its residual viability. Residual viability of a tooth is a value equal to the amount of crucians that Valerie can eat with this tooth. Every time Valerie eats a crucian, viability of all the teeth used for it will decrease by one. When the viability of at least one tooth becomes negative, the shark will have to see the dentist again. Unhappy, Valerie came back home, where a portion of crucians was waiting for her. For sure, the shark couldn\'t say no to her favourite meal, but she had no desire to go back to the dentist. That\'s why she decided to eat the maximum amount of crucians from the portion but so that the viability of no tooth becomes negative. As Valerie is not good at mathematics, she asked you to help her to find out the total amount of crucians that she can consume for dinner.We should remind you that while eating one crucian Valerie uses exactly one row of teeth and the viability of each tooth from this row decreases by one." greedy,implementation 1200
1896G "Pepe Racing" "This is an interactive problem.There are n2 pepes labeled 1,2,\xe2\x80\xa6,n2 with pairwise distinct speeds. You would like to set up some races to find out the relative speed of these pepes.In one race, you can choose exactly n distinct pepes and make them race against each other. After each race, you will only know the fastest pepe of these n pepes.Can you order the n2\xe2\x88\x92n+1 fastest pepes in at most 2n2\xe2\x88\x922n+1 races? Note that the slowest n\xe2\x88\x921 pepes are indistinguishable from each other.Note that the interactor is adaptive. That is, the relative speeds of the pepes are not fixed in the beginning and may depend on your queries. But it is guaranteed that at any moment there is at least one initial configuration of pepes such that all the answers to the queries are consistent." "constructive algorithms,implementation,interactive,sortings" 3200
1799D2 "Hot Start Up (hard version)" "This is a hard version of the problem. The constraints of t, n, k are the only difference between versions.You have a device with two CPUs. You also have k programs, numbered 1 through k, that you can run on the CPUs. The i-th program (1\xe2\x89\xa4i\xe2\x89\xa4k) takes coldi seconds to run on some CPU. However, if the last program we ran on this CPU was also program i, it only takes hoti seconds (hoti\xe2\x89\xa4coldi). Note that this only applies if we run program i multiple times consecutively  \xe2\x80\x94 if we run program i, then some different program, then program i again, it will take coldi seconds the second time.You are given a sequence a1,a2,\xe2\x80\xa6,an of length n, consisting of integers from 1 to k. You need to use your device to run programs a1,a2,\xe2\x80\xa6,an in sequence. For all 2\xe2\x89\xa4i\xe2\x89\xa4n, you cannot start running program ai until program ai\xe2\x88\x921 has completed.Find the minimum amount of time needed to run all programs a1,a2,\xe2\x80\xa6,an in sequence." "data structures,dp" 2100
282E "Sausage Maximization" "The Bitlandians are quite weird people. They have their own problems and their own solutions. They have their own thoughts and their own beliefs, they have their own values and their own merits. They have their own dishes and their own sausages!In Bitland a sausage is an array of integers! A sausage\'s deliciousness is equal to the bitwise excluding OR (the xor operation) of all integers in that sausage. One day, when Mr. Bitkoch (the local cook) was going to close his BitRestaurant, BitHaval and BitAryo, the most famous citizens of Bitland, entered the restaurant and each ordered a sausage.But Mr. Bitkoch had only one sausage left. So he decided to cut a prefix (several, may be zero, first array elements) of the sausage and give it to BitHaval and a postfix (several, may be zero, last array elements) of the sausage and give it to BitAryo. Note that one or both pieces of the sausage can be empty. Of course, the cut pieces mustn\'t intersect (no array element can occur in both pieces).The pleasure of BitHaval and BitAryo is equal to the bitwise XOR of their sausages\' deliciousness. An empty sausage\'s deliciousness equals zero.Find a way to cut a piece of sausage for BitHaval and BitAryo that maximizes the pleasure of these worthy citizens." "bitmasks,data structures,trees" 2200
345A "Expecting Trouble" "It is Friday the 13th today, and even though you\'re a modern well-educated person, you can\'t help feeling a bit nervous about it. You decide to look for evidence against this superstition (or for it). As a first step, you recall all Fridays the 13th in your life and calculate how many of them were unusually bad \xe2\x80\x94 like that time when you decided to play a game on ZX Spectrum and ended up breaking your TV set. The problem is, you can\'t remember some Fridays, and you\'re not sure why \xe2\x80\x94 were they really that bad?You have assembled a sequence of your recollections. Character ""0"" stands for a normal day, ""1"" \xe2\x80\x94 for a nasty one, and ""?"" means you have no idea what kind of day that was. Being a programmer, you decide to approximate these unknown days with independent random variables, which take value 1 with probability p, and 0 with probability (1\xe2\x80\x89-\xe2\x80\x89p).Given a string of your memories and the value of p, calculate out the expected value of average badness of your Fridays the 13th." "*special problem,probabilities" 1500
45G "Prime Problem" "In Berland prime numbers are fashionable \xe2\x80\x94 the respectable citizens dwell only on the floors with numbers that are prime numbers. The numismatists value particularly high the coins with prime nominal values. All the prime days are announced holidays!Yet even this is not enough to make the Berland people happy. On the main street of the capital stand n houses, numbered from 1 to n. The government decided to paint every house a color so that the sum of the numbers of the houses painted every color is a prime number.However it turned out that not all the citizens approve of this decision \xe2\x80\x94 many of them protest because they don\'t want many colored houses on the capital\'s main street. That\'s why it is decided to use the minimal possible number of colors. The houses don\'t have to be painted consecutively, but every one of n houses should be painted some color. The one-colored houses should not stand consecutively, any way of painting is acceptable.There are no more than 5 hours left before the start of painting, help the government find the way when the sum of house numbers for every color is a prime number and the number of used colors is minimal." "number theory" 2200
1834D "Survey in Class" "Zinaida Viktorovna has n students in her history class. The homework for today included m topics, but the students had little time to prepare, so i-th student learned only topics from li to ri inclusive.At the beginning of the lesson, each student holds their hand at 0. The teacher wants to ask some topics. It goes like this:  The teacher asks the topic k.  If the student has learned topic k, then he raises his hand by 1, otherwise he lower it by 1. Each topic Zinaida Viktorovna can ask no more than one time.Find the maximum difference of the heights of the highest and the lowest hand that can be in class after the survey.Note that the student\'s hand can go below 0." "brute force,data structures,greedy,implementation,sortings" 1900
906A Shockers "Valentin participates in a show called ""Shockers"". The rules are quite easy: jury selects one letter which Valentin doesn\'t know. He should make a small speech, but every time he pronounces a word that contains the selected letter, he receives an electric shock. He can make guesses which letter is selected, but for each incorrect guess he receives an electric shock too. The show ends when Valentin guesses the selected letter correctly.Valentin can\'t keep in mind everything, so he could guess the selected letter much later than it can be uniquely determined and get excessive electric shocks. Excessive electric shocks are those which Valentin got after the moment the selected letter can be uniquely determined. You should find out the number of excessive electric shocks." implementation,strings 1600
1980B "Choosing Cubes" "Dmitry has n cubes, numbered from left to right from 1 to n. The cube with index f is his favorite.Dmitry threw all the cubes on the table, and the i-th cube showed the value ai (1\xe2\x89\xa4ai\xe2\x89\xa4100). After that, he arranged the cubes in non-increasing order of their values, from largest to smallest. If two cubes show the same value, they can go in any order.After sorting, Dmitry removed the first k cubes. Then he became interested in whether he removed his favorite cube (note that its position could have changed after sorting).For example, if n=5, f=2, a=[4,3,3,2,3] (the favorite cube is highlighted in green), and k=2, the following could have happened:  After sorting a=[4,3,3,3,2], since the favorite cube ended up in the second position, it will be removed.  After sorting a=[4,3,3,3,2], since the favorite cube ended up in the third position, it will not be removed." sortings,sortings 800
256E "Lucky Arrays" "Little Maxim loves interesting problems. He decided to share one such problem with you. Initially there is an array a, consisting of n zeroes. The elements of the array are indexed, starting from 1. Then follow queries to change array a. Each query is characterized by two integers vi,\xe2\x80\x89ti. In the answer to the query we should make the vi-th array element equal ti (avi\xe2\x80\x89=\xe2\x80\x89ti; 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89vi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n).Maxim thinks that some pairs of integers (x,\xe2\x80\x89y) are good and some are not. Maxim thinks that array a, consisting of n integers, is lucky, if for all integer i, (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x891) the pair of integers (ai,\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x891) \xe2\x80\x94 is good. Note that the order of numbers in the pairs is important, that is, specifically, (1,\xe2\x80\x892)\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89(2,\xe2\x80\x891).After each query to change array a Maxim wants to know, how many ways there are to replace all zeroes in array a with integers from one to three so as to make the resulting array (without zeroes) lucky. Of course, distinct zeroes can be replaced by distinct integers.Maxim told you the sequence of queries and all pairs of integers he considers lucky. Help Maxim, solve this problem for him." "data structures" 2400
1764B "Doremy\'s Perfect Math Class" """Everybody! Doremy\'s Perfect Math Class is about to start! Come and do your best if you want to have as much IQ as me!"" In today\'s math class, Doremy is teaching everyone subtraction. Now she gives you a quiz to prove that you are paying attention in class.You are given a set S containing positive integers. You may perform the following operation some (possibly zero) number of times:  choose two integers x and y from the set S such that x>y and x\xe2\x88\x92y is not in the set S.  add x\xe2\x88\x92y into the set S. You need to tell Doremy the maximum possible number of integers in S if the operations are performed optimally. It can be proven that this number is finite." "math,number theory" 900
6C "Alice, Bob and Chocolate" "Alice and Bob like games. And now they are ready to start a new game. They have placed n chocolate bars in a line. Alice starts to eat chocolate bars one by one from left to right, and Bob \xe2\x80\x94 from right to left. For each chocololate bar the time, needed for the player to consume it, is known (Alice and Bob eat them with equal speed). When the player consumes a chocolate bar, he immediately starts with another. It is not allowed to eat two chocolate bars at the same time, to leave the bar unfinished and to make pauses. If both players start to eat the same bar simultaneously, Bob leaves it to Alice as a true gentleman.How many bars each of the players will consume?" "greedy,two pointers" 1200
1644C "Increase Subarray Sums" "You are given an array a1,a2,\xe2\x80\xa6,an, consisting of n integers. You are also given an integer value x.Let f(k) be the maximum sum of a contiguous subarray of a after applying the following operation: add x to the elements on exactly k distinct positions. An empty subarray should also be considered, it has sum 0.Note that the subarray doesn\'t have to include all of the increased elements.Calculate the maximum value of f(k) for all k from 0 to n independently." "brute force,dp,greedy,implementation" 1400
1765B "Broken Keyboard" "Recently, Mishka started noticing that his keyboard malfunctions \xe2\x80\x94 maybe it\'s because he was playing rhythm games too much. Empirically, Mishka has found out that every other time he presses a key, it is registered as if the key was pressed twice. For example, if Mishka types text, the first time he presses a key, exactly one letter is printed; the second time he presses a key, two same letters are printed; the third time he presses a key, one letter is printed; the fourth time he presses a key, two same letters are printed, and so on. Note that the number of times a key was pressed is counted for the whole keyboard, not for each key separately. For example, if Mishka tries to type the word osu, it will be printed on the screen as ossu.You are given a word consisting of n lowercase Latin letters. You have to determine if it can be printed on Mishka\'s keyboard or not. You may assume that Mishka cannot delete letters from the word, and every time he presses a key, the new letter (or letters) is appended to the end of the word." greedy 800
1874D "Jellyfish and Miku" "There are n+1 cities with numbers from 0 to n, connected by n roads. The i-th (1\xe2\x89\xa4i\xe2\x89\xa4n) road connects city i\xe2\x88\x921 and city i bi-directionally. After Jellyfish flew back to city 0, she found out that she had left her Miku fufu in city n.Each road has a positive integer level of beauty. Denote the beauty of the i-th road as ai.Jellyfish is trying to find her fufu. Because of her poor sense of direction, she doesn\'t know which way to go. Every day, she randomly chooses a road connected to the city she currently is in and traverses it. Let s be the sum of the beauty of the roads connected to the current city. For each road connected to the current city, Jellyfish will traverse the road with a probability of xs, where x is the beauty of the road, reaching the city on the other side of the road.Jellyfish will start at city 0, and she will get only her fufu back when she reaches city n.You want to choose the beauty of the roads such that the expected number of days Jellyfish takes to find her fufu will be the minimum possible. However, due to limited funding, the sum of beauties of all roads must be less than or equal to m. Find the minimum expected number of days Jellyfish needs to get her fufu back if the beauty of the roads is chosen optimally." "divide and conquer,dp,math,probabilities" 2800
1067B Multihedgehog "Someone give a strange birthday present to Ivan. It is hedgehog \xe2\x80\x94 connected undirected graph in which one vertex has degree at least 3 (we will call it center) and all other vertices has degree 1. Ivan thought that hedgehog is too boring and decided to make himself k-multihedgehog.Let us define k-multihedgehog as follows: 1-multihedgehog is hedgehog: it has one vertex of degree at least 3 and some vertices of degree 1. For all k\xe2\x89\xa52, k-multihedgehog is (k\xe2\x88\x921)-multihedgehog in which the following changes has been made for each vertex v with degree 1: let u be its only neighbor; remove vertex v, create a new hedgehog with center at vertex w and connect vertices u and w with an edge. New hedgehogs can differ from each other and the initial gift. Thereby k-multihedgehog is a tree. Ivan made k-multihedgehog but he is not sure that he did not make any mistakes. That is why he asked you to check if his tree is indeed k-multihedgehog." "dfs and similar,graphs,shortest paths" 1800
366A "Dima and Guards" "Nothing has changed since the last round. Dima and Inna still love each other and want to be together. They\'ve made a deal with Seryozha and now they need to make a deal with the dorm guards...There are four guardposts in Dima\'s dorm. Each post contains two guards (in Russia they are usually elderly women). You can bribe a guard by a chocolate bar or a box of juice. For each guard you know the minimum price of the chocolate bar she can accept as a gift and the minimum price of the box of juice she can accept as a gift. If a chocolate bar for some guard costs less than the minimum chocolate bar price for this guard is, or if a box of juice for some guard costs less than the minimum box of juice price for this guard is, then the guard doesn\'t accept such a gift.In order to pass through a guardpost, one needs to bribe both guards.The shop has an unlimited amount of juice and chocolate of any price starting with 1. Dima wants to choose some guardpost, buy one gift for each guard from the guardpost and spend exactly n rubles on it.Help him choose a post through which he can safely sneak Inna or otherwise say that this is impossible. Mind you, Inna would be very sorry to hear that!" implementation 1100
36A "Extra-terrestrial Intelligence" "Recently Vasya got interested in finding extra-terrestrial intelligence. He made a simple extra-terrestrial signals\xe2\x80\x99 receiver and was keeping a record of the signals for n days in a row. Each of those n days Vasya wrote a 1 in his notebook if he had received a signal that day and a 0 if he hadn\xe2\x80\x99t. Vasya thinks that he has found extra-terrestrial intelligence if there is a system in the way the signals has been received, i.e. if all the intervals between successive signals are equal. Otherwise, Vasya thinks that the signals were sent by some stupid aliens no one cares about. Help Vasya to deduce from the information given by the receiver if he has found extra-terrestrial intelligence or not." implementation 1300
2031F "Penchick and Even Medians" "This is an interactive problem. Returning from a restful vacation on Australia\'s Gold Coast, Penchick forgot to bring home gifts for his pet duck Duong Canh! But perhaps a beautiful problem crafted through deep thought on the scenic beaches could be the perfect souvenir.There is a hidden permutation\xe2\x88\x97 p of length n, where n is even. You are allowed to make the following query:  Choose a subsequence\xe2\x80\xa0 of the permutation p with even length 4\xe2\x89\xa4k\xe2\x89\xa4n. The interactor will return the value of the two medians\xe2\x80\xa1 in the chosen subsequence. Find the index of the two medians in permutation p using at most 80 queries.Note that the interactor is non-adaptive. This means that the permutation p is fixed at the beginning and will not change based on your queries.\xe2\x88\x97A permutation of length n is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array), and [1,3,4] is also not a permutation (n=3 but there is 4 in the array). \xe2\x80\xa0A sequence a is a subsequence of a sequence b if a can be obtained from b by the deletion of several (possibly, zero or all) element from arbitrary positions. \xe2\x80\xa1The two medians of an array a with even length k are defined as the k2-th and (k2+1)-th smallest element in the array (1-indexed)." "binary search,constructive algorithms,interactive,probabilities" -999
617B Chocolate "Bob loves everything sweet. His favorite chocolate bar consists of pieces, each piece may contain a nut. Bob wants to break the bar of chocolate into multiple pieces so that each part would contain exactly one nut and any break line goes between two adjacent pieces.You are asked to calculate the number of ways he can do it. Two ways to break chocolate are considered distinct if one of them contains a break between some two adjacent pieces and the other one doesn\'t. Please note, that if Bob doesn\'t make any breaks, all the bar will form one piece and it still has to have exactly one nut." combinatorics 1300
901D "Weighting a Tree" "You are given a connected undirected graph with n vertices and m edges. The vertices are enumerated from 1 to n. You are given n integers c1,\xe2\x80\x89c2,\xe2\x80\x89...,\xe2\x80\x89cn, each of them is between \xe2\x80\x89-\xe2\x80\x89n and n, inclusive. It is also guaranteed that the parity of cv equals the parity of degree of vertex v. The degree of a vertex is the number of edges connected to it.You are to write a weight between \xe2\x80\x89-\xe2\x80\x892\xc2\xb7n2 and 2\xc2\xb7n2 (inclusive) on each edge in such a way, that for each vertex v the sum of weights on edges connected to this vertex is equal to cv, or determine that this is impossible." "constructive algorithms,dfs and similar,graphs" 2700
1707E Replace "You are given an integer array a1,\xe2\x80\xa6,an, where 1\xe2\x89\xa4ai\xe2\x89\xa4n for all i.There\'s a ""replace"" function f which takes a pair of integers (l,r), where l\xe2\x89\xa4r, as input and outputs the pair f((l,r))=(min{al,al+1,\xe2\x80\xa6,ar},max{al,al+1,\xe2\x80\xa6,ar}).Consider repeated calls of this function. That is, from a starting pair (l,r) we get f((l,r)), then f(f((l,r))), then f(f(f((l,r)))), and so on.Now you need to answer q queries. For the i-th query you have two integers li and ri (1\xe2\x89\xa4li\xe2\x89\xa4ri\xe2\x89\xa4n). You must answer the minimum number of times you must apply the ""replace"" function to the pair (li,ri) to get (1,n), or report that it is impossible." "binary search,data structures" 3500
1547D "Co-growing Sequence" "A sequence of non-negative integers a1,a2,\xe2\x80\xa6,an is called growing if for all i from 1 to n\xe2\x88\x921 all ones (of binary representation) in ai are in the places of ones (of binary representation) in ai+1 (in other words, ai&ai+1=ai, where & denotes bitwise AND). If n=1 then the sequence is considered growing as well.For example, the following four sequences are growing:   [2,3,15,175] \xe2\x80\x94 in binary it\'s [102,112,11112,101011112];  [5] \xe2\x80\x94 in binary it\'s [1012];  [1,3,7,15] \xe2\x80\x94 in binary it\'s [12,112,1112,11112];  [0,0,0] \xe2\x80\x94 in binary it\'s [02,02,02]. The following three sequences are non-growing:   [3,4,5] \xe2\x80\x94 in binary it\'s [112,1002,1012];  [5,4,3] \xe2\x80\x94 in binary it\'s [1012,1002,0112];  [1,2,4,8] \xe2\x80\x94 in binary it\'s [00012,00102,01002,10002]. Consider two sequences of non-negative integers x1,x2,\xe2\x80\xa6,xn and y1,y2,\xe2\x80\xa6,yn. Let\'s call this pair of sequences co-growing if the sequence x1\xe2\x8a\x95y1,x2\xe2\x8a\x95y2,\xe2\x80\xa6,xn\xe2\x8a\x95yn is growing where \xe2\x8a\x95 denotes bitwise XOR.You are given a sequence of integers x1,x2,\xe2\x80\xa6,xn. Find the lexicographically minimal sequence y1,y2,\xe2\x80\xa6,yn such that sequences xi and yi are co-growing.The sequence a1,a2,\xe2\x80\xa6,an is lexicographically smaller than the sequence b1,b2,\xe2\x80\xa6,bn if there exists 1\xe2\x89\xa4k\xe2\x89\xa4n such that ai=bi for any 1\xe2\x89\xa4i<k but ak<bk." "bitmasks,constructive algorithms,greedy" 1300
1351A "A+B (Trial Problem)" "You are given two integers a and b. Print a+b." implementation 800
1492D "Genius\'s Gambit" "You are given three integers a, b, k.Find two binary integers x and y (x\xe2\x89\xa5y) such that   both x and y consist of a zeroes and b ones;  x\xe2\x88\x92y (also written in binary form) has exactly k ones.  You are not allowed to use leading zeros for x and y." "bitmasks,constructive algorithms,greedy,math" 1900
2025G "Variable Damage" "Monocarp is gathering an army to fight a dragon in a videogame.The army consists of two parts: the heroes and the defensive artifacts. Each hero has one parameter \xe2\x80\x94 his health. Each defensive artifact also has one parameter \xe2\x80\x94 its durability.Before the battle begins, Monocarp distributes artifacts to the heroes so that each hero receives at most one artifact.The battle consists of rounds that proceed as follows:   first, the dragon deals damage equal to 1a+b (a real number without rounding) to each hero, where a is the number of heroes alive and b is the number of active artifacts;  after that, all heroes with health 0 or less die;  finally, some artifacts are deactivated. An artifact with durability x is deactivated when one of the following occurs: the hero holding the artifact either dies or receives x total damage (from the start of the battle). If an artifact is not held by any hero, it is inactive from the beginning of the battle. The battle ends when there are no heroes left alive.Initially, the army is empty. There are q queries: add a hero with health x or an artifact with durability y to the army. After each query, determine the maximum number of rounds that Monocarp can survive if he distributes the artifacts optimally." "data structures,flows" 3000
1284G Seollal "It is only a few days until Seollal (Korean Lunar New Year), and Jaehyun has invited his family to his garden. There are kids among the guests. To make the gathering more fun for the kids, Jaehyun is going to run a game of hide-and-seek.The garden can be represented by a n\xc3\x97m grid of unit cells. Some (possibly zero) cells are blocked by rocks, and the remaining cells are free. Two cells are neighbors if they share an edge. Each cell has up to 4 neighbors: two in the horizontal direction and two in the vertical direction. Since the garden is represented as a grid, we can classify the cells in the garden as either ""black"" or ""white"". The top-left cell is black, and two cells which are neighbors must be different colors. Cell indices are 1-based, so the top-left corner of the garden is cell (1,1).Jaehyun wants to turn his garden into a maze by placing some walls between two cells. Walls can only be placed between neighboring cells. If the wall is placed between two neighboring cells a and b, then the two cells a and b are not neighboring from that point. One can walk directly between two neighboring cells if and only if there is no wall directly between them. A maze must have the following property. For each pair of free cells in the maze, there must be exactly one simple path between them. A simple path between cells a and b is a sequence of free cells in which the first cell is a, the last cell is b, all cells are distinct, and any two consecutive cells are neighbors which are not directly blocked by a wall.At first, kids will gather in cell (1,1), and start the hide-and-seek game. A kid can hide in a cell if and only if that cell is free, it is not (1,1), and has exactly one free neighbor. Jaehyun planted roses in the black cells, so it\'s dangerous if the kids hide there. So Jaehyun wants to create a maze where the kids can only hide in white cells.You are given the map of the garden as input. Your task is to help Jaehyun create a maze." graphs 3300
1000G Two-Paths "You are given a weighted tree (undirected connected graph with no cycles, loops or multiple edges) with n vertices. The edge {uj,vj} has weight wj. Also each vertex i has its own value ai assigned to it.Let\'s call a path starting in vertex u and ending in vertex v, where each edge can appear no more than twice (regardless of direction), a 2-path. Vertices can appear in the 2-path multiple times (even start and end vertices).For some 2-path p profit Pr(p)=\xe2\x88\x91v\xe2\x88\x88distinct vertices in pav\xe2\x88\x92\xe2\x88\x91e\xe2\x88\x88distinct edges in pke\xe2\x8b\x85we, where ke is the number of times edge e appears in p. That is, vertices are counted once, but edges are counted the number of times they appear in p.You are about to answer m queries. Each query is a pair of vertices (qu,qv). For each query find 2-path p from qu to qv with maximal profit Pr(p)." "data structures,dp,trees" 2700
2006E "Iris\'s Full Binary Tree" "Iris likes full binary trees.Let\'s define the depth of a rooted tree as the maximum number of vertices on the simple paths from some vertex to the root. A full binary tree of depth d is a binary tree of depth d with exactly 2d\xe2\x88\x921 vertices.Iris calls a tree a d-binary tree if some vertices and edges can be added to it to make it a full binary tree of depth d. Note that any vertex can be chosen as the root of a full binary tree.Since performing operations on large trees is difficult, she defines the binary depth of a tree as the minimum d satisfying that the tree is d-binary. Specifically, if there is no integer d\xe2\x89\xa51 such that the tree is d-binary, the binary depth of the tree is \xe2\x88\x921.Iris now has a tree consisting of only vertex 1. She wants to add n\xe2\x88\x921 more vertices to form a larger tree. She will add the vertices one by one. When she adds vertex i (2\xe2\x89\xa4i\xe2\x89\xa4n), she\'ll give you an integer pi (1\xe2\x89\xa4pi<i), and add a new edge connecting vertices i and pi.Iris wants to ask you the binary depth of the tree formed by the first i vertices for each 1\xe2\x89\xa4i\xe2\x89\xa4n. Can you tell her the answer?" "brute force,data structures,dfs and similar,trees" 3100
1389B "Array Walk" "You are given an array a1,a2,\xe2\x80\xa6,an, consisting of n positive integers. Initially you are standing at index 1 and have a score equal to a1. You can perform two kinds of moves:   move right \xe2\x80\x94 go from your current index x to x+1 and add ax+1 to your score. This move can only be performed if x<n.  move left \xe2\x80\x94 go from your current index x to x\xe2\x88\x921 and add ax\xe2\x88\x921 to your score. This move can only be performed if x>1. Also, you can\'t perform two or more moves to the left in a row. You want to perform exactly k moves. Also, there should be no more than z moves to the left among them.What is the maximum score you can achieve?" "brute force,dp,greedy" 1600
1999A "A+B Again?" "Given a two-digit positive integer n, find the sum of its digits." implementation,math 800
228D Zigzag "The court wizard Zigzag wants to become a famous mathematician. For that, he needs his own theorem, like the Cauchy theorem, or his sum, like the Minkowski sum. But most of all he wants to have his sequence, like the Fibonacci sequence, and his function, like the Euler\'s totient function.The Zigag\'s sequence with the zigzag factor z is an infinite sequence Siz (i\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x891; z\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x892), that is determined as follows:  Siz\xe2\x80\x89=\xe2\x80\x892, when ;  , when ;  , when . Operation  means taking the remainder from dividing number x by number y. For example, the beginning of sequence Si3 (zigzag factor 3) looks as follows: 1, 2, 3, 2, 1, 2, 3, 2, 1.Let\'s assume that we are given an array a, consisting of n integers. Let\'s define element number i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) of the array as ai. The Zigzag function is function , where l,\xe2\x80\x89r,\xe2\x80\x89z satisfy the inequalities 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n, z\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x892.To become better acquainted with the Zigzag sequence and the Zigzag function, the wizard offers you to implement the following operations on the given array a.  The assignment operation. The operation parameters are (p,\xe2\x80\x89v). The operation denotes assigning value v to the p-th array element. After the operation is applied, the value of the array element ap equals v.  The Zigzag operation. The operation parameters are (l,\xe2\x80\x89r,\xe2\x80\x89z). The operation denotes calculating the Zigzag function Z(l,\xe2\x80\x89r,\xe2\x80\x89z). Explore the magical powers of zigzags, implement the described operations." "data structures" 2100
1480A "Yet Another String Game" "Homer has two friends Alice and Bob. Both of them are string fans. One day, Alice and Bob decide to play a game on a string s=s1s2\xe2\x80\xa6sn of length n consisting of lowercase English letters. They move in turns alternatively and Alice makes the first move.In a move, a player must choose an index i (1\xe2\x89\xa4i\xe2\x89\xa4n) that has not been chosen before, and change si to any other lowercase English letter c that c\xe2\x89\xa0si.When all indices have been chosen, the game ends. The goal of Alice is to make the final string lexicographically as small as possible, while the goal of Bob is to make the final string lexicographically as large as possible. Both of them are game experts, so they always play games optimally. Homer is not a game expert, so he wonders what the final string will be.A string a is lexicographically smaller than a string b if and only if one of the following holds:   a is a prefix of b, but a\xe2\x89\xa0b;  in the first position where a and b differ, the string a has a letter that appears earlier in the alphabet than the corresponding letter in b." games,greedy,strings 800
281B "Nearest Fraction" "You are given three positive integers x,\xe2\x80\x89y,\xe2\x80\x89n. Your task is to find the nearest fraction to fraction  whose denominator is no more than n. Formally, you should find such pair of integers a,\xe2\x80\x89b (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n; 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a) that the value  is as minimal as possible.If there are multiple ""nearest"" fractions, choose the one with the minimum denominator. If there are multiple ""nearest"" fractions with the minimum denominator, choose the one with the minimum numerator." "brute force,implementation,two pointers" 1700
353B "Two Heaps" "Valera has 2\xc2\xb7n cubes, each cube contains an integer from 10 to 99. He arbitrarily chooses n cubes and puts them in the first heap. The remaining cubes form the second heap. Valera decided to play with cubes. During the game he takes a cube from the first heap and writes down the number it has. Then he takes a cube from the second heap and write out its two digits near two digits he had written (to the right of them). In the end he obtained a single fourdigit integer \xe2\x80\x94 the first two digits of it is written on the cube from the first heap, and the second two digits of it is written on the second cube from the second heap.Valera knows arithmetic very well. So, he can easily count the number of distinct fourdigit numbers he can get in the game. The other question is: how to split cubes into two heaps so that this number (the number of distinct fourdigit integers Valera can get) will be as large as possible?" "combinatorics,constructive algorithms,greedy,implementation,math,sortings" 1900
1770B "Koxia and Permutation" "Reve has two integers n and k.Let p be a permutation\xe2\x80\xa0 of length n. Let c be an array of length n\xe2\x88\x92k+1 such that ci=max(pi,\xe2\x80\xa6,pi+k\xe2\x88\x921)+min(pi,\xe2\x80\xa6,pi+k\xe2\x88\x921). Let the cost of the permutation p be the maximum element of c.Koxia wants you to construct a permutation with the minimum possible cost.\xe2\x80\xa0 A permutation of length n is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array), and [1,3,4] is also not a permutation (n=3 but there is 4 in the array)." "constructive algorithms" 1000
68C Synchrophasotron "For some experiments little Petya needs a synchrophasotron. He has already got the device, all that\'s left is to set the fuel supply. Fuel comes through a system of nodes numbered from 1 to n and connected by pipes. Pipes go from every node with smaller number to every node with greater number. Fuel can only flow through pipes in direction from node with smaller number to node with greater number. Any amount of fuel can enter through the first node and the last node is connected directly to the synchrophasotron. It is known that every pipe has three attributes: the minimum amount of fuel that should go through it, the maximum amount of fuel that can possibly go through it and the cost of pipe activation. If cij units of fuel (cij\xe2\x80\x89>\xe2\x80\x890) flow from node i to node j, it will cost aij\xe2\x80\x89+\xe2\x80\x89cij2 tugriks (aij is the cost of pipe activation), and if fuel doesn\'t flow through the pipe, it doesn\'t cost anything. Only integer number of units of fuel can flow through each pipe.Constraints on the minimal and the maximal fuel capacity of a pipe take place always, not only if it is active. You may assume that the pipe is active if and only if the flow through it is strictly greater than zero.Petya doesn\'t want the pipe system to be overloaded, so he wants to find the minimal amount of fuel, that, having entered the first node, can reach the synchrophasotron. Besides that he wants to impress the sponsors, so the sum of money needed to be paid for fuel to go through each pipe, must be as big as possible." "brute force" 2200
226B "Naughty Stone Piles" "There are n piles of stones of sizes a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an lying on the table in front of you.During one move you can take one pile and add it to the other. As you add pile i to pile j, the size of pile j increases by the current size of pile i, and pile i stops existing. The cost of the adding operation equals the size of the added pile.Your task is to determine the minimum cost at which you can gather all stones in one pile. To add some challenge, the stone piles built up conspiracy and decided that each pile will let you add to it not more than k times (after that it can only be added to another pile). Moreover, the piles decided to puzzle you completely and told you q variants (not necessarily distinct) of what k might equal. Your task is to find the minimum cost for each of q variants." greedy 1900
977B Two-gram "Two-gram is an ordered pair (i.e. string of length two) of capital Latin letters. For example, ""AZ"", ""AA"", ""ZA"" \xe2\x80\x94 three distinct two-grams.You are given a string s consisting of n capital Latin letters. Your task is to find any two-gram contained in the given string as a substring (i.e. two consecutive characters of the string) maximal number of times. For example, for string s = ""BBAABBBA"" the answer is two-gram ""BB"", which contained in s three times. In other words, find any most frequent two-gram.Note that occurrences of the two-gram can overlap with each other." implementation,strings 900
1672F1 "Array Shuffling" "oolimry has an array a of length n which he really likes. Today, you have changed his array to b, a permutation of a, to make him sad.Because oolimry is only a duck, he can only perform the following operation to restore his array:   Choose two integers i,j such that 1\xe2\x89\xa4i,j\xe2\x89\xa4n.  Swap bi and bj. The sadness of the array b is the minimum number of operations needed to transform b into a.Given the array a, find any array b which is a permutation of a that has the maximum sadness over all permutations of the array a." "constructive algorithms,graphs,greedy" 2000
1017A "The Rank" "John Smith knows that his son, Thomas Smith, is among the best students in his class and even in his school. After the students of the school took the exams in English, German, Math, and History, a table of results was formed.There are n students, each of them has a unique id (from 1 to n). Thomas\'s id is 1. Every student has four scores correspond to his or her English, German, Math, and History scores. The students are given in order of increasing of their ids.In the table, the students will be sorted by decreasing the sum of their scores. So, a student with the largest sum will get the first place. If two or more students have the same sum, these students will be sorted by increasing their ids. Please help John find out the rank of his son." implementation 800
1530B "Putting Plates" "To celebrate your birthday you have prepared a festive table! Now you want to seat as many guests as possible.The table can be represented as a rectangle with height h and width w, divided into h\xc3\x97w cells. Let (i,j) denote the cell in the i-th row and the j-th column of the rectangle (1\xe2\x89\xa4i\xe2\x89\xa4h; 1\xe2\x89\xa4j\xe2\x89\xa4w).Into each cell of the table you can either put a plate or keep it empty.As each guest has to be seated next to their plate, you can only put plates on the edge of the table \xe2\x80\x94 into the first or the last row of the rectangle, or into the first or the last column. Formally, for each cell (i,j) you put a plate into, at least one of the following conditions must be satisfied: i=1, i=h, j=1, j=w.To make the guests comfortable, no two plates must be put into cells that have a common side or corner. In other words, if cell (i,j) contains a plate, you can\'t put plates into cells (i\xe2\x88\x921,j), (i,j\xe2\x88\x921), (i+1,j), (i,j+1), (i\xe2\x88\x921,j\xe2\x88\x921), (i\xe2\x88\x921,j+1), (i+1,j\xe2\x88\x921), (i+1,j+1).Put as many plates on the table as possible without violating the rules above." "constructive algorithms,implementation" 800
750C "New Year and Rating" "Every Codeforces user has rating, described with one integer, possibly negative or zero. Users are divided into two divisions. The first division is for users with rating 1900 or higher. Those with rating 1899 or lower belong to the second division. In every contest, according to one\'s performance, his or her rating changes by some value, possibly negative or zero.Limak competed in n contests in the year 2016. He remembers that in the i-th contest he competed in the division di (i.e. he belonged to this division just before the start of this contest) and his rating changed by ci just after the contest. Note that negative ci denotes the loss of rating.What is the maximum possible rating Limak can have right now, after all n contests? If his rating may be arbitrarily big, print ""Infinity"". If there is no scenario matching the given information, print ""Impossible""." "binary search,greedy,math" 1600
1610D "Not Quite Lee" "Lee couldn\'t sleep lately, because he had nightmares. In one of his nightmares (which was about an unbalanced global round), he decided to fight back and propose a problem below (which you should solve) to balance the round, hopefully setting him free from the nightmares.A non-empty array b1,b2,\xe2\x80\xa6,bmb1,b2,\xe2\x80\xa6,bm is called good, if there exist mm integer sequences which satisfy the following properties:  The ii-th sequence consists of bibi consecutive integers (for example if bi=3bi=3 then the ii-th sequence can be (\xe2\x88\x921,0,1)(\xe2\x88\x921,0,1) or (\xe2\x88\x925,\xe2\x88\x924,\xe2\x88\x923)(\xe2\x88\x925,\xe2\x88\x924,\xe2\x88\x923) but not (0,\xe2\x88\x921,1)(0,\xe2\x88\x921,1) or (1,2,3,4)(1,2,3,4)).  Assuming the sum of integers in the ii-th sequence is sumisumi, we want sum1+sum2+\xe2\x80\xa6+summsum1+sum2+\xe2\x80\xa6+summ to be equal to 00. You are given an array a1,a2,\xe2\x80\xa6,ana1,a2,\xe2\x80\xa6,an. It has 2n\xe2\x88\x9212n\xe2\x88\x921 nonempty subsequences. Find how many of them are good.As this number can be very large, output it modulo 109+7109+7.An array cc is a subsequence of an array dd if cc can be obtained from dd by deletion of several (possibly, zero or all) elements." "combinatorics,dp,math,number theory" 2000
432D "Prefixes and Suffixes" "You have a string s\xe2\x80\x89=\xe2\x80\x89s1s2...s|s|, where |s| is the length of string s, and si its i-th character. Let\'s introduce several definitions:  A substring s[i..j] (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|s|) of string s is string sisi\xe2\x80\x89+\xe2\x80\x891...sj.  The prefix of string s of length l (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|s|) is string s[1..l].  The suffix of string s of length l (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|s|) is string s[|s|\xe2\x80\x89-\xe2\x80\x89l\xe2\x80\x89+\xe2\x80\x891..|s|]. Your task is, for any prefix of string s which matches a suffix of string s, print the number of times it occurs in string s as a substring." "dp,string suffix structures,strings,two pointers" 2000
1945H "GCD is Greater" "In the evenings during the hike, Kirill and Anton decided to take out an array of integers a of length n from their backpack and play a game with it. The rules are as follows: Kirill chooses from 2 to (n\xe2\x88\x922) numbers and encircles them in red. Anton encircles all the remaining numbers in blue. Kirill calculates the greatest common divisor (GCD) of all the red numbers. Anton calculates the bitwise AND of all the blue numbers and adds the number x to the result. If the GCD of all the red numbers is strictly greater than the sum of the bitwise AND of all the blue numbers and the number x, then Kirill wins; otherwise, Anton wins.Help Kirill to beat Anton or tell if it\'s impossible." "brute force,data structures,math,number theory" 2600
343D "Water Tree" "Mad scientist Mike has constructed a rooted tree, which consists of n vertices. Each vertex is a reservoir which can be either empty or filled with water.The vertices of the tree are numbered from 1 to n with the root at vertex 1. For each vertex, the reservoirs of its children are located below the reservoir of this vertex, and the vertex is connected with each of the children by a pipe through which water can flow downwards.Mike wants to do the following operations with the tree:   Fill vertex v with water. Then v and all its children are filled with water.  Empty vertex v. Then v and all its ancestors are emptied.  Determine whether vertex v is filled with water at the moment.  Initially all vertices of the tree are empty.Mike has already compiled a full list of operations that he wants to perform in order. Before experimenting with the tree Mike decided to run the list through a simulation. Help Mike determine what results will he get after performing all the operations." "data structures,dfs and similar,graphs,trees" 2100
370E "Summer Reading" "At school Vasya got an impressive list of summer reading books. Unlike other modern schoolchildren, Vasya loves reading, so he read some book each day of the summer.As Vasya was reading books, he was making notes in the Reader\'s Diary. Each day he wrote the orderal number of the book he was reading. The books in the list are numbered starting from 1 and Vasya was reading them in the order they go in the list. Vasya never reads a new book until he finishes reading the previous one. Unfortunately, Vasya wasn\'t accurate and some days he forgot to note the number of the book and the notes for those days remained empty.As Vasya knows that the literature teacher will want to check the Reader\'s Diary, so he needs to restore the lost records. Help him do it and fill all the blanks. Vasya is sure that he spends at least two and at most five days for each book. Vasya finished reading all the books he had started. Assume that the reading list contained many books. So many, in fact, that it is impossible to read all of them in a summer. If there are multiple valid ways to restore the diary records, Vasya prefers the one that shows the maximum number of read books." dp,greedy 2500
1804B Vaccination "Ethan runs a vaccination station to help people combat the seasonal flu. He analyses the historical data in order to develop an optimal strategy for vaccine usage.Consider there are n patients coming to the station on a particular day. The i-th patient comes at the moment ti. We know that each of these patients can be asked to wait for no more than w time moments. That means the i-th patient can get vaccine at moments ti,ti+1,\xe2\x80\xa6,ti+w.Vaccines come in packs, each pack consists of k doses. Each patient needs exactly one dose. Packs are stored in a special fridge. After a pack is taken out of the fridge and opened, it can no longer be put back. The lifetime of the vaccine outside the fridge is d moments of time. Thus, if the pack was taken out of the fridge and opened at moment x, its doses can be used to vaccinate patients at moments x,x+1,\xe2\x80\xa6,x+d. At moment x+d+1 all the remaining unused doses of this pack are thrown away.Assume that the vaccination station has enough staff to conduct an arbitrary number of operations at every moment of time. What is the minimum number of vaccine packs required to vaccinate all n patients?" greedy,implementation 1000
1866K "Keen Tree Calculation" "There is a tree of N vertices and N\xe2\x88\x921 edges. The i-th edge connects vertices Ui and Vi and has a length of Wi.Chaneka, the owner of the tree, asks you Q times. For the j-th question, the following is the question format:   Xj Kj \xe2\x80\x93 If each edge that contains vertex Xj has its length multiplied by Kj, what is the diameter of the tree? Notes:   Each of Chaneka\'s question is independent, which means the changes in edge length do not influence the next questions.  The diameter of a tree is the maximum possible distance between two different vertices in the tree." "binary search,data structures,dp,geometry,graphs,implementation,trees" 2500
1462A "Favorite Sequence" "Polycarp has a favorite sequence a[1\xe2\x80\xa6n] consisting of n integers. He wrote it out on the whiteboard as follows:  he wrote the number a1 to the left side (at the beginning of the whiteboard);  he wrote the number a2 to the right side (at the end of the whiteboard);  then as far to the left as possible (but to the right from a1), he wrote the number a3;  then as far to the right as possible (but to the left from a2), he wrote the number a4;  Polycarp continued to act as well, until he wrote out the entire sequence on the whiteboard.   The beginning of the result looks like this (of course, if n\xe2\x89\xa54). For example, if n=7 and a=[3,1,4,1,5,9,2], then Polycarp will write a sequence on the whiteboard [3,4,5,2,9,1,1].You saw the sequence written on the whiteboard and now you want to restore Polycarp\'s favorite sequence." "implementation,two pointers" 800
1811G2 "Vlad and the Nice Paths (hard version)" "This is hard version of the problem, it differs from the easy one only by constraints on n and k.Vlad found a row of n tiles and the integer k. The tiles are indexed from left to right and the i-th tile has the color ci. After a little thought, he decided what to do with it.You can start from any tile and jump to any number of tiles right, forming the path p. Let\'s call the path p of length m nice if:  p can be divided into blocks of length exactly k, that is, m is divisible by k;  cp1=cp2=\xe2\x80\xa6=cpk;  cpk+1=cpk+2=\xe2\x80\xa6=cp2k;  \xe2\x80\xa6  cpm\xe2\x88\x92k+1=cpm\xe2\x88\x92k+2=\xe2\x80\xa6=cpm; Your task is to find the number of nice paths of maximum length. Since this number may be too large, print it modulo 109+7." "binary search,combinatorics,data structures,dp,math,two pointers" 2200
664A "Complicated GCD" "Greatest common divisor GCD(a,\xe2\x80\x89b) of two positive integers a and b is equal to the biggest integer d such that both integers a and b are divisible by d. There are many efficient algorithms to find greatest common divisor GCD(a,\xe2\x80\x89b), for example, Euclid algorithm. Formally, find the biggest integer d, such that all integers a,\xe2\x80\x89a\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89a\xe2\x80\x89+\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89b are divisible by d. To make the problem even more complicated we allow a and b to be up to googol, 10100 \xe2\x80\x94 such number do not fit even in 64-bit integer type!" "math,number theory" 800
1551C "Interesting Story" "Stephen Queen wants to write a story. He is a very unusual writer, he uses only letters \'a\', \'b\', \'c\', \'d\' and \'e\'!To compose a story, Stephen wrote out n words consisting of the first 5 lowercase letters of the Latin alphabet. He wants to select the maximum number of words to make an interesting story.Let a story be a sequence of words that are not necessarily different. A story is called interesting if there exists a letter which occurs among all words of the story more times than all other letters together.For example, the story consisting of three words ""bac"", ""aaada"", ""e"" is interesting (the letter \'a\' occurs 5 times, all other letters occur 4 times in total). But the story consisting of two words ""aba"", ""abcde"" is not (no such letter that it occurs more than all other letters in total).You are given a sequence of n words consisting of letters \'a\', \'b\', \'c\', \'d\' and \'e\'. Your task is to choose the maximum number of them to make an interesting story. If there\'s no way to make a non-empty story, output 0." greedy,sortings,strings 1500
493A "Vasya and Football" "Vasya has started watching football games. He has learned that for some fouls the players receive yellow cards, and for some fouls they receive red cards. A player who receives the second yellow card automatically receives a red card.Vasya is watching a recorded football match now and makes notes of all the fouls that he would give a card for. Help Vasya determine all the moments in time when players would be given red cards if Vasya were the judge. For each player, Vasya wants to know only the first moment of time when he would receive a red card from Vasya." implementation 1300
1250K Projectors "There are n lectures and m seminars to be conducted today at the Faculty of Approximate Sciences. The i-th lecture starts at ai and ends at bi (formally, time of the lecture spans an interval [ai,bi), the right bound is exclusive). The j-th seminar starts at pj and ends at qj (similarly, time of the seminar spans an interval [pj,qj), the right bound is exclusive).There are x HD-projectors numbered from 1 to x and y ordinary projectors numbered from x+1 to x+y available at the faculty. Projectors should be distributed in such a way that:  an HD-projector is used in each lecture;  some projector (ordinary or HD) is used in each seminar;  a projector (ordinary or HD) can only be used in one event at the same moment of time;  if a projector is selected for an event, it is used there for the whole duration of the event;  a projector can be reused in some following event, if it starts not earlier than current event finishes. You are to find such distribution of projectors, if it exists.Again, note that the right bound of the event\'s time range is not inclusive: if some event starts exactly when another event finishes, the projector can be reused (suppose that it is instantly transported to the location of the event)." flows,graphs 3100
1168B "Good Triple" "Toad Rash has a binary string s. A binary string consists only of zeros and ones.Let n be the length of s.Rash needs to find the number of such pairs of integers l, r that 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n and there is at least one pair of integers x, k such that 1\xe2\x89\xa4x,k\xe2\x89\xa4n, l\xe2\x89\xa4x<x+2k\xe2\x89\xa4r, and sx=sx+k=sx+2k.Find this number of pairs for Rash." "brute force,two pointers" 1900
457F "An easy problem about trees" "Pieguy and Piegirl are playing a game. They have a rooted binary tree, that has a property that each node is either a leaf or has exactly two children. Each leaf has a number associated with it.On his/her turn a player can choose any two leafs that share their immediate parent, remove them, and associate either of their values with their parent, that now became a leaf (the player decides which of the two values to associate). The game ends when only one node (the one that was the root of the tree) is left.Pieguy goes first, and his goal is to maximize the value that will be associated with the root when the game ends. Piegirl wants to minimize that value. Assuming that both players are playing optimally, what number will be associated with the root when the game ends?" dp,games,greedy,trees 3200
1225D "Power Products" "You are given n positive integers a1,\xe2\x80\xa6,an, and an integer k\xe2\x89\xa52. Count the number of pairs i,j such that 1\xe2\x89\xa4i<j\xe2\x89\xa4n, and there exists an integer x such that ai\xe2\x8b\x85aj=xk." "hashing,math,number theory" 1800
1784B "Letter Exchange" "A cooperative game is played by m people. In the game, there are 3m sheets of paper: m sheets with letter \'w\', m sheets with letter \'i\', and m sheets with letter \'n\'.Initially, each person is given three sheets (possibly with equal letters).The goal of the game is to allow each of the m people to spell the word ""win"" using their sheets of paper. In other words, everyone should have one sheet with letter \'w\', one sheet with letter \'i\', and one sheet with letter \'n\'.To achieve the goal, people can make exchanges. Two people participate in each exchange. Both of them choose exactly one sheet of paper from the three sheets they own and exchange it with each other.Find the shortest sequence of exchanges after which everyone has one \'w\', one \'i\', and one \'n\'." "constructive algorithms" 1900
443A "Anton and Letters" "Recently, Anton has found a set. The set consists of small English letters. Anton carefully wrote out all the letters from the set in one line, separated by a comma. He also added an opening curved bracket at the beginning of the line and a closing curved bracket at the end of the line. Unfortunately, from time to time Anton would forget writing some letter and write it again. He asks you to count the total number of distinct letters in his set." "constructive algorithms,implementation" 800
1555C "Coin Rows" "Alice and Bob are playing a game on a matrix, consisting of 2 rows and m columns. The cell in the i-th row in the j-th column contains ai,j coins in it.Initially, both Alice and Bob are standing in a cell (1,1). They are going to perform a sequence of moves to reach a cell (2,m).The possible moves are:   Move right \xe2\x80\x94 from some cell (x,y) to (x,y+1);  Move down \xe2\x80\x94 from some cell (x,y) to (x+1,y). First, Alice makes all her moves until she reaches (2,m). She collects the coins in all cells she visit (including the starting cell).When Alice finishes, Bob starts his journey. He also performs the moves to reach (2,m) and collects the coins in all cells that he visited, but Alice didn\'t.The score of the game is the total number of coins Bob collects.Alice wants to minimize the score. Bob wants to maximize the score. What will the score of the game be if both players play optimally?" "brute force,constructive algorithms,dp,implementation" 1300
1462F "The Treasure of The Segments" "Polycarp found n segments on the street. A segment with the index i is described by two integers li and ri \xe2\x80\x94 coordinates of the beginning and end of the segment, respectively. Polycarp realized that he didn\'t need all the segments, so he wanted to delete some of them.Polycarp believes that a set of k segments is good if there is a segment [li,ri] (1\xe2\x89\xa4i\xe2\x89\xa4k) from the set, such that it intersects every segment from the set (the intersection must be a point or segment). For example, a set of 3 segments [[1,4],[2,3],[3,6]] is good, since the segment [2,3] intersects each segment from the set. Set of 4 segments [[1,2],[2,3],[3,5],[4,5]] is not good.Polycarp wonders, what is the minimum number of segments he has to delete so that the remaining segments form a good set?" "binary search,data structures,greedy" 1800
1599C "Bubble Strike" "Little Johnny Bubbles enjoys spending hours in front of his computer playing video games. His favorite game is Bubble Strike, fast-paced bubble shooting online game for two players.Each game is set in one of the N maps, each having different terrain configuration. First phase of each game decides on which map the game will be played. The game system randomly selects three maps and shows them to the players. Each player must pick one of those three maps to be discarded. The game system then randomly selects one of the maps that were not picked by any of the players and starts the game.Johnny is deeply enthusiastic about the game and wants to spend some time studying maps, thus increasing chances to win games played on those maps. However, he also needs to do his homework, so he does not have time to study all the maps. That is why he asked himself the following question: ""What is the minimum number of maps I have to study, so that the probability to play one of those maps is at least P""?Can you help Johnny find the answer for this question? You can assume Johnny\'s opponents do not know him, and they will randomly pick maps." "combinatorics,math,probabilities,ternary search" 2000
1036G "Sources and Sinks" "You are given an acyclic directed graph, consisting of n vertices and m edges. The graph contains no multiple edges and no self-loops.The vertex is called a source if it has no incoming edges. The vertex is called a sink if it has no outgoing edges. These definitions imply that some vertices can be both source and sink.The number of sources in the given graph is equal to the number of sinks in it, and each of these numbers doesn\'t exceed 20.The following algorithm is applied to the graph:  if the graph has no sources and sinks then quit;  choose arbitrary source s, arbitrary sink t, add an edge from t to s to the graph and go to step 1 (that operation pops s out of sources and t out of sinks). Note that s and t may be the same vertex, then a self-loop is added. At the end you check if the graph becomes strongly connected (that is, any vertex is reachable from any other vertex).Your task is to check that the graph becomes strongly connected no matter the choice of sources and sinks on the second step of the algorithm." "bitmasks,brute force,dfs and similar" 2700
1017F "The Neutral Zone" "Notice: unusual memory limit!After the war, destroyed cities in the neutral zone were restored. And children went back to school.The war changed the world, as well as education. In those hard days, a new math concept was created.As we all know, logarithm function can be described as: log(pa11pa22...pa2k)=a1logp1+a2logp2+...+aklogpk Where pa11pa22...pa2k is the prime factorization of a integer. A problem is that the function uses itself in the definition. That is why it is hard to calculate.So, the mathematicians from the neutral zone invented this: exlogf(pa11pa22...pa2k)=a1f(p1)+a2f(p2)+...+akf(pk)Notice that exlogf(1) is always equal to 0.This concept for any function f was too hard for children. So teachers told them that f can only be a polynomial of degree no more than 3 in daily uses (i.e., f(x)=Ax3+Bx2+Cx+D).""Class is over! Don\'t forget to do your homework!"" Here it is: n\xe2\x88\x91i=1exlogf(i)Help children to do their homework. Since the value can be very big, you need to find the answer modulo 232." "brute force,math" 2500
1411C "Peaceful Rooks" "You are given a n\xc3\x97n chessboard. Rows and columns of the board are numbered from 1 to n. Cell (x,y) lies on the intersection of column number x and row number y.Rook is a chess piece, that can in one turn move any number of cells vertically or horizontally. There are m rooks (m<n) placed on the chessboard in such a way that no pair of rooks attack each other. I.e. there are no pair of rooks that share a row or a column.In one turn you can move one of the rooks any number of cells vertically or horizontally. Additionally, it shouldn\'t be attacked by any other rook after movement. What is the minimum number of moves required to place all the rooks on the main diagonal?The main diagonal of the chessboard is all the cells (i,i), where 1\xe2\x89\xa4i\xe2\x89\xa4n." "dfs and similar,dsu,graphs" 1700
382D "Ksenia and Pawns" "Ksenia has a chessboard of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m. Each cell of the chessboard contains one of the characters: ""<"", "">"", ""^"", ""v"", ""#"". The cells that contain character ""#"" are blocked. We know that all chessboard cells that touch the border are blocked.Ksenia is playing with two pawns on this chessboard. Initially, she puts the pawns on the chessboard. One cell of the chessboard can contain two pawns if and only if the cell is blocked. In other cases two pawns can not stand in one cell. The game begins when Ksenia put pawns on the board. In one move, Ksenia moves each pawn to a side adjacent cell in the direction of arrows painted on the cell on which the corresponding pawn sits (if the pawn sits on ""#"", it does not move). Assume that Ksenia moves pawns simultaneously (see the second test case). Of course, Ksenia plays for points. How can one calculate the points per game? Very simply! Let\'s count how many movements the first pawn made and how many movements the second pawn made, sum these two numbers \xe2\x80\x94 it will be the resulting score of the game. Ksenia wonders: what is the maximum number of points she can earn (for that, she should place the pawns optimally well early in the game). Help her and find that number." "dfs and similar,graphs,implementation,trees" 2200
1398A "Bad Triangle" "You are given an array a1,a2,\xe2\x80\xa6,an, which is sorted in non-decreasing order (ai\xe2\x89\xa4ai+1). Find three indices i, j, k such that 1\xe2\x89\xa4i<j<k\xe2\x89\xa4n and it is impossible to construct a non-degenerate triangle (a triangle with nonzero area) having sides equal to ai, aj and ak (for example it is possible to construct a non-degenerate triangle with sides 3, 4 and 5 but impossible with sides 3, 4 and 7). If it is impossible to find such triple, report it." geometry,math 800
1685B Linguistics "Alina has discovered a weird language, which contains only 4 words: A, B, AB, BA. It also turned out that there are no spaces in this language: a sentence is written by just concatenating its words into a single string.Alina has found one such sentence s and she is curious: is it possible that it consists of precisely a words A, b words B, c words AB, and d words BA?In other words, determine, if it\'s possible to concatenate these a+b+c+d words in some order so that the resulting string is s. Each of the a+b+c+d words must be used exactly once in the concatenation, but you can choose the order in which they are concatenated." greedy,implementation,sortings,strings 2000
28E "DravDe saves the world" "How horrible! The empire of galactic chickens tries to conquer a beautiful city ""Z"", they have built a huge incubator that produces millions of chicken soldiers a day, and fenced it around. The huge incubator looks like a polygon on the plane Oxy with n vertices. Naturally, DravDe can\'t keep still, he wants to destroy the chicken empire. For sure, he will start with the incubator.DravDe is strictly outside the incubator\'s territory in point A(xa,\xe2\x80\x89ya), and wants to get inside and kill all the chickens working there. But it takes a lot of doing! The problem is that recently DravDe went roller skating and has broken both his legs. He will get to the incubator\'s territory in his jet airplane LEVAP-41.LEVAP-41 flies at speed V(xv,\xe2\x80\x89yv,\xe2\x80\x89zv). DravDe can get on the plane in point A, fly for some time, and then air drop himself. DravDe is very heavy, that\'s why he falls vertically at speed Fdown, but in each point of his free fall DravDe can open his parachute, and from that moment he starts to fall at the wind speed U(xu,\xe2\x80\x89yu,\xe2\x80\x89zu) until he lands. Unfortunately, DravDe isn\'t good at mathematics. Would you help poor world\'s saviour find such an air dropping plan, that allows him to land on the incubator\'s territory? If the answer is not unique, DravDe wants to find the plan with the minimum time of his flight on the plane. If the answers are still multiple, he wants to find the one with the minimum time of his free fall before opening his parachute" geometry,math 2800
793G "Oleg and chess" "Oleg the bank client solves an interesting chess problem: place on n\xe2\x80\x89\xc3\x97\xe2\x80\x89n chessboard the maximum number of rooks so that they don\'t beat each other. Of course, no two rooks can share the same cell.Remind that a rook standing in the cell (a,\xe2\x80\x89b) beats a rook standing in the cell (x,\xe2\x80\x89y) if and only if a\xe2\x80\x89=\xe2\x80\x89x or b\xe2\x80\x89=\xe2\x80\x89y.Unfortunately (of fortunately?) for Oleg the answer in this problem was always n, so the task bored Oleg soon. He decided to make it more difficult by removing some cells from the board. If a cell is deleted, Oleg can\'t put a rook there, but rooks do beat each other ""through"" deleted cells.Oleg deletes the cells in groups, namely, he repeatedly choose a rectangle with sides parallel to the board sides and deletes all the cells inside the rectangle. Formally, if he chooses a rectangle, lower left cell of which has coordinates (x1,\xe2\x80\x89y1), and upper right cell of which has coordinates (x2,\xe2\x80\x89y2), then he deletes all such cells with coordinates (x,\xe2\x80\x89y) that x1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x2 and y1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y2. It is guaranteed that no cell is deleted twice, i.e. the chosen rectangles do not intersect.This version of the problem Oleg can\'t solve, and his friend Igor is busy at a conference, so he can\'t help Oleg.You are the last hope for Oleg! Help him: given the size of the board and the deleted rectangles find the maximum possible number of rooks that could be placed on the board so that no two rooks beat each other." "data structures,divide and conquer,flows,graph matchings" 3400
1989A "Catch the Coin" "Monocarp visited a retro arcade club with arcade cabinets. There got curious about the ""Catch the Coin"" cabinet.The game is pretty simple. The screen represents a coordinate grid such that:   the X-axis is directed from left to right;  the Y-axis is directed from bottom to top;  the center of the screen has coordinates (0,0). At the beginning of the game, the character is located in the center, and n coins appear on the screen \xe2\x80\x94 the i-th coin is at coordinates (xi,yi). The coordinates of all coins are different and not equal to (0,0).In one second, Monocarp can move the character in one of eight directions. If the character is at coordinates (x,y), then it can end up at any of the coordinates (x,y+1), (x+1,y+1), (x+1,y), (x+1,y\xe2\x88\x921), (x,y\xe2\x88\x921), (x\xe2\x88\x921,y\xe2\x88\x921), (x\xe2\x88\x921,y), (x\xe2\x88\x921,y+1).If the character ends up at the coordinates with a coin, then Monocarp collects that coin.After Monocarp makes a move, all coins fall down by 1, that is, they move from (x,y) to (x,y\xe2\x88\x921). You can assume that the game field is infinite in all directions.Monocarp wants to collect at least one coin, but cannot decide which coin to go for. Help him determine, for each coin, whether he can collect it." implementation 800
313E "Ilya and Two Numbers" "Ilya has recently taken up archaeology. He\'s recently found two numbers, written in the m-based notation. Each of the found numbers consisted of exactly n digits. Ilya immediately started looking for information about those numbers. He learned that the numbers are part of a cyphered code and the one who can decypher it can get the greatest treasure.After considerable research Ilya understood that to decypher the code, he should do the following:  Rearrange digits in the first number in some manner. Similarly, rearrange digits in the second number in some manner. As a result of this operation, the numbers can get leading zeroes.  Add numbers, digit by digit, modulo m. In other words, we need to get the third number of length n, each digit of the number is the sum of the respective numbers of the found numbers. For example, suppose there are two numbers recorded in the ternary notation, 001210 and 012111, then if you add them to each other digit by digit modulo 3, you will get number 010021.  The key to the code is the maximum possible number that can be obtained in the previous step. Help Ilya, find the key to the code." "constructive algorithms,data structures,dsu,greedy" 2300
1275E3 "\xd0\x9a\xd0\xbe\xd0\xbd\xd1\x82\xd1\x80\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xb0\xd1\x8f \xd1\x81\xd1\x83\xd0\xbc\xd0\xbc\xd0\xb0" "\xd0\x94\xd0\xb0\xd0\xbd\xd0\xbd\xd1\x8b\xd0\xb5 \xd0\xbf\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xb7\xd0\xbe\xd0\xb2\xd0\xb0\xd1\x82\xd0\xb5\xd0\xbb\xd0\xb5\xd0\xb9 \xd0\x92\xd0\x9a\xd0\xbe\xd0\xbd\xd1\x82\xd0\xb0\xd0\xba\xd1\x82\xd0\xb5 \xd1\x85\xd1\x80\xd0\xb0\xd0\xbd\xd1\x8f\xd1\x82\xd1\x81\xd1\x8f \xd0\xbd\xd0\xb0 \xd0\xb4\xd0\xb5\xd1\x81\xd1\x8f\xd1\x82\xd0\xba\xd0\xb0\xd1\x85 \xd1\x82\xd1\x8b\xd1\x81\xd1\x8f\xd1\x87 \xd1\x81\xd0\xb5\xd1\x80\xd0\xb2\xd0\xb5\xd1\x80\xd0\xbe\xd0\xb2. \xd0\x94\xd0\xbb\xd1\x8f \xd1\x82\xd0\xbe\xd0\xb3\xd0\xbe, \xd1\x87\xd1\x82\xd0\xbe\xd0\xb1\xd1\x8b \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xbd\xd0\xbe \xd0\xb1\xd1\x8b\xd0\xbb\xd0\xbe \xd0\xbe\xd0\xbf\xd1\x80\xd0\xb5\xd0\xb4\xd0\xb5\xd0\xbb\xd1\x8f\xd1\x82\xd1\x8c \xd0\xbe\xd1\x88\xd0\xb8\xd0\xb1\xd0\xba\xd0\xb8 \xd0\xbf\xd1\x80\xd0\xb8 \xd0\xb7\xd0\xb0\xd0\xbf\xd0\xb8\xd1\x81\xd0\xb8 \xd0\xb4\xd0\xb0\xd0\xbd\xd0\xbd\xd1\x8b\xd1\x85 \xd0\xbd\xd0\xb0 \xd0\xb4\xd0\xb8\xd1\x81\xd0\xba, \xd0\xbd\xd0\xb0 \xd0\xb4\xd0\xb8\xd1\x81\xd0\xba \xd1\x80\xd0\xb5\xd0\xb3\xd1\x83\xd0\xbb\xd1\x8f\xd1\x80\xd0\xbd\xd0\xbe \xd0\xb7\xd0\xb0\xd0\xbf\xd0\xb8\xd1\x81\xd1\x8b\xd0\xb2\xd0\xb0\xd1\x8e\xd1\x82\xd1\x81\xd1\x8f \xd1\x82\xd0\xb5\xd0\xba\xd1\x83\xd1\x89\xd0\xb8\xd0\xb5 \xd0\xba\xd0\xbe\xd0\xbd\xd1\x82\xd1\x80\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xbd\xd1\x8b\xd0\xb5 \xd1\x81\xd1\x83\xd0\xbc\xd0\xbc\xd1\x8b CRC32 (Wiki, IEEE 802-3). \xd0\x91\xd0\xbb\xd0\xb0\xd0\xb3\xd0\xbe\xd0\xb4\xd0\xb0\xd1\x80\xd1\x8f \xd1\x8d\xd1\x82\xd0\xbe\xd0\xbc\xd1\x83, \xd0\xbf\xd1\x80\xd0\xb8 \xd1\x87\xd1\x82\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb8 \xd0\xb4\xd0\xb0\xd0\xbd\xd0\xbd\xd1\x8b\xd1\x85 \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xbd\xd0\xbe \xd0\xb7\xd0\xb0\xd0\xbd\xd0\xbe\xd0\xb2\xd0\xbe \xd0\xb2\xd1\x8b\xd1\x87\xd0\xb8\xd1\x81\xd0\xbb\xd0\xb8\xd1\x82\xd1\x8c \xd0\xba\xd0\xbe\xd0\xbd\xd1\x82\xd1\x80\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xbd\xd1\x83\xd1\x8e \xd1\x81\xd1\x83\xd0\xbc\xd0\xbc\xd1\x83 \xd0\xb8 \xd0\xbf\xd1\x80\xd0\xbe\xd0\xb2\xd0\xb5\xd1\x80\xd0\xb8\xd1\x82\xd1\x8c, \xd1\x87\xd1\x82\xd0\xbe \xd0\xb4\xd0\xb0\xd0\xbd\xd0\xbd\xd1\x8b\xd0\xb5 \xd0\xb8 \xd0\xba\xd0\xbe\xd0\xbd\xd1\x82\xd1\x80\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xb0\xd1\x8f \xd1\x81\xd1\x83\xd0\xbc\xd0\xbc\xd0\xb0 \xd0\xb7\xd0\xb0\xd0\xbf\xd0\xb8\xd1\x81\xd0\xb0\xd0\xbd\xd1\x8b \xd0\xba\xd0\xbe\xd1\x80\xd1\x80\xd0\xb5\xd0\xba\xd1\x82\xd0\xbd\xd0\xbe. \xd0\xa0\xd0\xb0\xd0\xb7\xd1\x83\xd0\xbc\xd0\xb5\xd0\xb5\xd1\x82\xd1\x81\xd1\x8f, \xd0\xbf\xd1\x80\xd0\xbe\xd0\xb2\xd0\xb5\xd1\x80\xd0\xba\xd0\xb8 \xd0\xbd\xd0\xb0 \xd1\x81\xd0\xbe\xd0\xb2\xd0\xbf\xd0\xb0\xd0\xb4\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb5 \xd0\xba\xd0\xbe\xd0\xbd\xd1\x82\xd1\x80\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe\xd0\xb9 \xd1\x81\xd1\x83\xd0\xbc\xd0\xbc\xd1\x8b \xd0\xb2\xd1\x81\xd1\x82\xd1\x80\xd0\xbe\xd0\xb5\xd0\xbd\xd1\x8b \xd0\xb2 \xd0\xb1\xd0\xbe\xd0\xbb\xd1\x8c\xd1\x88\xd0\xb8\xd0\xbd\xd1\x81\xd1\x82\xd0\xb2\xd0\xbe \xd1\x81\xd0\xb5\xd1\x80\xd0\xb2\xd0\xb8\xd1\x81\xd0\xbe\xd0\xb2 \xd0\x92\xd0\x9a\xd0\xbe\xd0\xbd\xd1\x82\xd0\xb0\xd0\xba\xd1\x82\xd0\xb5. \xd0\x9d\xd0\xbe \xd0\xba\xd0\xb0\xd0\xba-\xd1\x82\xd0\xbe \xd1\x80\xd0\xb0\xd0\xb7 \xd0\xbe\xd0\xba\xd0\xb0\xd0\xb7\xd0\xb0\xd0\xbb\xd0\xbe\xd1\x81\xd1\x8c, \xd1\x87\xd1\x82\xd0\xbe \xd0\xb2 \xd0\xbe\xd0\xb4\xd0\xbd\xd0\xbe\xd0\xbc \xd1\x81\xd0\xb5\xd0\xb3\xd0\xbc\xd0\xb5\xd0\xbd\xd1\x82\xd0\xb5 \xd0\xb4\xd0\xb0\xd0\xbd\xd0\xbd\xd1\x8b\xd1\x85 \xd0\xbd\xd1\x83\xd0\xb6\xd0\xbd\xd0\xbe \xd0\xb8\xd0\xb7\xd0\xbc\xd0\xb5\xd0\xbd\xd0\xb8\xd1\x82\xd1\x8c \xd0\xb7\xd0\xbd\xd0\xb0\xd1\x87\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb5 \xd1\x87\xd0\xb5\xd1\x82\xd1\x8b\xd1\x80\xd0\xb5\xd1\x85 \xd0\xbf\xd0\xbe\xd1\x81\xd0\xbb\xd0\xb5\xd0\xb4\xd0\xbe\xd0\xb2\xd0\xb0\xd1\x82\xd0\xb5\xd0\xbb\xd1\x8c\xd0\xbd\xd1\x8b\xd1\x85 \xd0\xb1\xd0\xb0\xd0\xb9\xd1\x82 \xd0\xbd\xd0\xb0 \xd0\xbd\xd0\xbe\xd0\xb2\xd0\xbe\xd0\xb5 \xe2\x80\x94 \xd0\xbd\xd1\x83\xd0\xb6\xd0\xbd\xd0\xbe \xd0\xb7\xd0\xb0\xd0\xbc\xd0\xb5\xd0\xbd\xd0\xb8\xd1\x82\xd1\x8c \xd0\xb7\xd0\xbd\xd0\xb0\xd1\x87\xd0\xb5\xd0\xbd\xd0\xb8\xd1\x8f \xd0\xbf\xd0\xbe\xd1\x81\xd0\xbb\xd0\xb5\xd0\xb4\xd0\xbe\xd0\xb2\xd0\xb0\xd1\x82\xd0\xb5\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe\xd1\x81\xd1\x82\xd0\xb8 ai,ai+1,ai+2,ai+3 \xd0\xbd\xd0\xb0 x0,x1,x2,x3. \xd0\x9f\xd1\x80\xd0\xb8 \xd1\x8d\xd1\x82\xd0\xbe\xd0\xbc, \xd0\xbd\xd1\x83\xd0\xb6\xd0\xbd\xd0\xbe \xd1\x87\xd1\x82\xd0\xbe\xd0\xb1\xd1\x8b \xd0\xb7\xd0\xbd\xd0\xb0\xd1\x87\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb5 \xd0\xba\xd0\xbe\xd0\xbd\xd1\x82\xd1\x80\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe\xd0\xb9 \xd1\x81\xd1\x83\xd0\xbc\xd0\xbc\xd1\x8b CRC32 \xd0\xbe\xd1\x81\xd1\x82\xd0\xb0\xd0\xbb\xd0\xbe\xd1\x81\xd1\x8c \xd0\xbf\xd1\x80\xd0\xb5\xd0\xb6\xd0\xbd\xd0\xb8\xd0\xbc. \xd0\x9a\xd0\xbe\xd0\xbd\xd0\xb5\xd1\x87\xd0\xbd\xd0\xbe, \xd0\xbf\xd1\x80\xd0\xb8 \xd0\xb8\xd0\xb7\xd0\xbc\xd0\xb5\xd0\xbd\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb8 \xd0\xbf\xd0\xbe\xd1\x81\xd0\xbb\xd0\xb5\xd0\xb4\xd0\xbe\xd0\xb2\xd0\xb0\xd1\x82\xd0\xb5\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe\xd1\x81\xd1\x82\xd0\xb8 \xd0\xb5\xd0\xb5 \xd0\xba\xd0\xbe\xd0\xbd\xd1\x82\xd1\x80\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xb0\xd1\x8f \xd1\x81\xd1\x83\xd0\xbc\xd0\xbc\xd0\xb0 \xd0\xb8\xd0\xb7\xd0\xbc\xd0\xb5\xd0\xbd\xd0\xb8\xd1\x82\xd1\x81\xd1\x8f, \xd0\xbf\xd0\xbe\xd1\x8d\xd1\x82\xd0\xbe\xd0\xbc\xd1\x83 \xd0\xba\xd1\x80\xd0\xbe\xd0\xbc\xd0\xb5 \xd0\xb8\xd0\xb7\xd0\xbc\xd0\xb5\xd0\xbd\xd0\xb5\xd0\xbd\xd0\xb8\xd1\x8f \xd1\x8d\xd1\x82\xd0\xb8\xd1\x85 \xd1\x87\xd0\xb5\xd1\x82\xd1\x8b\xd1\x80\xd0\xb5\xd1\x85 \xd0\xb1\xd0\xb0\xd0\xb9\xd1\x82 \xd0\xbd\xd0\xb0 \xd0\xbd\xd0\xbe\xd0\xb2\xd0\xbe\xd0\xb5 \xd0\xb7\xd0\xbd\xd0\xb0\xd1\x87\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb5, \xd0\xb1\xd1\x8b\xd0\xbb\xd0\xb8 \xd0\xb2\xd1\x8b\xd0\xb1\xd1\x80\xd0\xb0\xd0\xbd\xd1\x8b \xd1\x87\xd0\xb5\xd1\x82\xd1\x8b\xd1\x80\xd0\xb5 \xd0\xb1\xd0\xb0\xd0\xb9\xd1\x82\xd0\xb0 aj,aj+1,aj+2,aj+3, \xd0\xba\xd0\xbe\xd1\x82\xd0\xbe\xd1\x80\xd1\x8b\xd0\xbc \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xbd\xd0\xbe \xd0\xbd\xd0\xb0\xd0\xb7\xd0\xbd\xd0\xb0\xd1\x87\xd0\xb8\xd1\x82\xd1\x8c \xd0\xbb\xd1\x8e\xd0\xb1\xd0\xbe\xd0\xb5 \xd0\xb7\xd0\xbd\xd0\xb0\xd1\x87\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb5. \xd0\x92\xd0\xb0\xd1\x88\xd0\xb0 \xd0\xb7\xd0\xb0\xd0\xb4\xd0\xb0\xd1\x87\xd0\xb0 \xd0\xb2\xd1\x8b\xd0\xb1\xd1\x80\xd0\xb0\xd1\x82\xd1\x8c \xd0\xb8\xd0\xbc \xd0\xbd\xd0\xbe\xd0\xb2\xd1\x8b\xd0\xb5 \xd0\xb7\xd0\xbd\xd0\xb0\xd1\x87\xd0\xb5\xd0\xbd\xd0\xb8\xd1\x8f \xd1\x82\xd0\xb0\xd0\xba, \xd1\x87\xd1\x82\xd0\xbe\xd0\xb1\xd1\x8b CRC32 \xd0\xb4\xd0\xb0\xd0\xbd\xd0\xbd\xd0\xbe\xd0\xb9 \xd0\xbf\xd0\xbe\xd1\x81\xd0\xbb\xd0\xb5\xd0\xb4\xd0\xbe\xd0\xb2\xd0\xb0\xd1\x82\xd0\xb5\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe\xd1\x81\xd1\x82\xd0\xb8 \xd0\xbd\xd0\xb5 \xd0\xb8\xd0\xb7\xd0\xbc\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xbb\xd1\x81\xd1\x8f, \xd0\xb8\xd0\xbb\xd0\xb8 \xd0\xbe\xd0\xbf\xd1\x80\xd0\xb5\xd0\xb4\xd0\xb5\xd0\xbb\xd0\xb8\xd1\x82\xd1\x8c, \xd1\x87\xd1\x82\xd0\xbe \xd1\x8d\xd1\x82\xd0\xbe \xd0\xbd\xd0\xb5\xd0\xb2\xd0\xbe\xd0\xb7\xd0\xbc\xd0\xbe\xd0\xb6\xd0\xbd\xd0\xbe. \xd0\x9f\xd0\xbe\xd1\x81\xd0\xba\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xba\xd1\x83 \xd0\xb8\xd0\xb7\xd0\xbc\xd0\xb5\xd0\xbd\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb5 \xd0\xb4\xd0\xb0\xd0\xbd\xd0\xbd\xd1\x8b\xd1\x85 \xe2\x80\x94 \xd0\xbe\xd0\xbf\xd0\xb5\xd1\x80\xd0\xb0\xd1\x86\xd0\xb8\xd1\x8f \xd1\x81\xd0\xb5\xd1\x80\xd1\x8c\xd0\xb5\xd0\xb7\xd0\xbd\xd0\xb0\xd1\x8f, \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb5\xd0\xb4 \xd1\x81\xd0\xb0\xd0\xbc\xd0\xb8\xd0\xbc \xd0\xb8\xd0\xb7\xd0\xbc\xd0\xb5\xd0\xbd\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb5\xd0\xbc \xd0\xbd\xd1\x83\xd0\xb6\xd0\xbd\xd0\xbe \xd0\xbe\xd0\xbf\xd1\x80\xd0\xb5\xd0\xb4\xd0\xb5\xd0\xbb\xd0\xb8\xd1\x82\xd1\x8c, \xd0\xba\xd0\xb0\xd0\xba \xd0\xb8\xd0\xb7\xd0\xbc\xd0\xb5\xd0\xbd\xd0\xb8\xd1\x82\xd1\x81\xd1\x8f \xd0\xbf\xd0\xbe\xd1\x81\xd0\xbb\xd0\xb5\xd0\xb4\xd0\xbe\xd0\xb2\xd0\xb0\xd1\x82\xd0\xb5\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe\xd1\x81\xd1\x82\xd1\x8c \xd0\xb4\xd0\xbb\xd1\x8f q \xd0\xbd\xd0\xb5\xd0\xb7\xd0\xb0\xd0\xb2\xd0\xb8\xd1\x81\xd0\xb8\xd0\xbc\xd1\x8b\xd1\x85 \xd1\x82\xd0\xb5\xd1\x81\xd1\x82\xd0\xbe\xd0\xb2\xd1\x8b\xd1\x85 \xd1\x81\xd0\xbb\xd1\x83\xd1\x87\xd0\xb0\xd0\xb5\xd0\xb2." "*special problem" -999
1017G "The Tree" "Abendsen assigned a mission to Juliana. In this mission, Juliana has a rooted tree with n vertices. Vertex number 1 is the root of this tree. Each vertex can be either black or white. At first, all vertices are white. Juliana is asked to process q queries. Each query is one of three types:  If vertex v is white, mark it as black; otherwise, perform this operation on all direct sons of v instead.  Mark all vertices in the subtree of v (including v) as white.  Find the color of the i-th vertex.   An example of operation ""1 1"" (corresponds to the first example test). The vertices 1 and 2 are already black, so the operation goes to their sons instead. Can you help Juliana to process all these queries?" "data structures" 3200
1268A "Long Beautiful Integer" "You are given an integer x of n digits a1,a2,\xe2\x80\xa6,an, which make up its decimal notation in order from left to right.Also, you are given a positive integer k<n.Let\'s call integer b1,b2,\xe2\x80\xa6,bm beautiful if bi=bi+k for each i, such that 1\xe2\x89\xa4i\xe2\x89\xa4m\xe2\x88\x92k.You need to find the smallest beautiful integer y, such that y\xe2\x89\xa5x." "constructive algorithms,greedy,implementation,strings" 1700
615A Bulbs "Vasya wants to turn on Christmas lights consisting of m bulbs. Initially, all bulbs are turned off. There are n buttons, each of them is connected to some set of bulbs. Vasya can press any of these buttons. When the button is pressed, it turns on all the bulbs it\'s connected to. Can Vasya light up all the bulbs?If Vasya presses the button such that some bulbs connected to it are already turned on, they do not change their state, i.e. remain turned on." implementation 800
1860F "Evaluate RBS" "You are given 2n tuples of values (a,b,c), where a and b are positive integers and c is a bracket \'(\' or \')\'. Exactly n tuples have c=\'(\' and the other n tuples have c= \')\'.You are asked to choose two positive values x and y (x>0 and y>0; not necessarily integers) and sort the tuples in the increasing value of a\xe2\x8b\x85x+b\xe2\x8b\x85y. If several tuples have the same value, you can place them in any order among themselves.Is it possible to choose such x and y that taking brackets c from the tuples in the resulting order produces a regular bracket sequence?A regular bracket sequence is a bracket sequence that can be transformed into a correct arithmetic expression by inserting characters ""1"" and ""+"" between the original characters of the sequence." "data structures,geometry,implementation,math,sortings" 2900
586A "Alena\'s Schedule" "Alena has successfully passed the entrance exams to the university and is now looking forward to start studying.One two-hour lesson at the Russian university is traditionally called a pair, it lasts for two academic hours (an academic hour is equal to 45 minutes).The University works in such a way that every day it holds exactly n lessons. Depending on the schedule of a particular group of students, on a given day, some pairs may actually contain classes, but some may be empty (such pairs are called breaks).The official website of the university has already published the schedule for tomorrow for Alena\'s group. Thus, for each of the n pairs she knows if there will be a class at that time or not.Alena\'s House is far from the university, so if there are breaks, she doesn\'t always go home. Alena has time to go home only if the break consists of at least two free pairs in a row, otherwise she waits for the next pair at the university.Of course, Alena does not want to be sleepy during pairs, so she will sleep as long as possible, and will only come to the first pair that is presented in her schedule. Similarly, if there are no more pairs, then Alena immediately goes home.Alena appreciates the time spent at home, so she always goes home when it is possible, and returns to the university only at the beginning of the next pair. Help Alena determine for how many pairs she will stay at the university. Note that during some pairs Alena may be at the university waiting for the upcoming pair." implementation 900
1560E "Polycarp and String Transformation" "Polycarp has a string s. Polycarp performs the following actions until the string s is empty (t is initially an empty string):  he adds to the right to the string t the string s, i.e. he does t=t+s, where t+s is a concatenation of the strings t and s;  he selects an arbitrary letter of s and removes from s all its occurrences (the selected letter must occur in the string s at the moment of performing this action). Polycarp performs this sequence of actions strictly in this order.Note that after Polycarp finishes the actions, the string s will be empty and the string t will be equal to some value (that is undefined and depends on the order of removing).E.g. consider s=""abacaba"" so the actions may be performed as follows:  t=""abacaba"", the letter \'b\' is selected, then s=""aacaa"";  t=""abacabaaacaa"", the letter \'a\' is selected, then s=""c"";  t=""abacabaaacaac"", the letter \'c\' is selected, then s="""" (the empty string). You need to restore the initial value of the string s using only the final value of t and find the order of removing letters from s." "binary search,implementation,sortings,strings" 1800
920E "Connected Components?" "You are given an undirected graph consisting of n vertices and  edges. Instead of giving you the edges that exist in the graph, we give you m unordered pairs (x,\xe2\x80\x89y) such that there is no edge between x and y, and if some pair of vertices is not listed in the input, then there is an edge between these vertices.You have to find the number of connected components in the graph and the size of each component. A connected component is a set of vertices X such that for every two vertices from this set there exists at least one path in the graph connecting these vertices, but adding any other vertex to X violates this rule." "data structures,dfs and similar,dsu,graphs" 2100
1433F "Zero Remainder Sum" "You are given a matrix a of size n\xc3\x97m consisting of integers.You can choose no more than \xe2\x8c\x8am2\xe2\x8c\x8b elements in each row. Your task is to choose these elements in such a way that their sum is divisible by k and this sum is the maximum.In other words, you can choose no more than a half (rounded down) of elements in each row, you have to find the maximum sum of these elements divisible by k.Note that you can choose zero elements (and the sum of such set is 0)." dp 2100
102A Clothes "A little boy Gerald entered a clothes shop and found out something very unpleasant: not all clothes turns out to match. For example, Gerald noticed that he looks rather ridiculous in a smoking suit and a baseball cap.Overall the shop sells n clothing items, and exactly m pairs of clothing items match. Each item has its price, represented by an integer number of rubles. Gerald wants to buy three clothing items so that they matched each other. Besides, he wants to spend as little money as possible. Find the least possible sum he can spend." "brute force" 1200
131D Subway "A subway scheme, classic for all Berland cities is represented by a set of n stations connected by n passages, each of which connects exactly two stations and does not pass through any others. Besides, in the classic scheme one can get from any station to any other one along the passages. The passages can be used to move in both directions. Between each pair of stations there is no more than one passage.Berland mathematicians have recently proved a theorem that states that any classic scheme has a ringroad. There can be only one ringroad. In other words, in any classic scheme one can find the only scheme consisting of stations (where any two neighbouring ones are linked by a passage) and this cycle doesn\'t contain any station more than once.This invention had a powerful social impact as now the stations could be compared according to their distance from the ringroad. For example, a citizen could say ""I live in three passages from the ringroad"" and another one could reply ""you loser, I live in one passage from the ringroad"". The Internet soon got filled with applications that promised to count the distance from the station to the ringroad (send a text message to a short number...).The Berland government decided to put an end to these disturbances and start to control the situation. You are requested to write a program that can determine the remoteness from the ringroad for each station by the city subway scheme." "dfs and similar,graphs" 1600
1500C "Matrix Sorting" "You are given two tables A and B of size n\xc3\x97m. We define a sorting by column as the following: we choose a column and reorder the rows of the table by the value in this column, from the rows with the smallest value to the rows with the largest. In case there are two or more rows with equal value in this column, their relative order does not change (such sorting algorithms are called stable).You can find this behavior of sorting by column in many office software for managing spreadsheets. Petya works in one, and he has a table A opened right now. He wants to perform zero of more sortings by column to transform this table to table B.Determine if it is possible to do so, and if yes, find a sequence of columns to sort by. Note that you do not need to minimize the number of sortings." "bitmasks,brute force,constructive algorithms,greedy,two pointers" 2600
1999G2 "Ruler (hard version)" "This is the hard version of the problem. The only difference between the two versions is that in this version, you can make at most 7 queries.This is an interactive problem. If you are unsure how interactive problems work, then it is recommended to read the guide for participants.We have a secret ruler that is missing one number x (2\xe2\x89\xa4x\xe2\x89\xa4999). When you measure an object of length y, the ruler reports the following values:   If y<x, the ruler (correctly) measures the object as having length y.  If y\xe2\x89\xa5x, the ruler incorrectly measures the object as having length y+1.  The ruler above is missing the number 4, so it correctly measures the first segment as length 3 but incorrectly measures the second segment as length 6 even though it is actually 5. You need to find the value of x. To do that, you can make queries of the following form:  ? a b \xe2\x80\x94 in response, we will measure the side lengths of an a\xc3\x97b rectangle with our ruler and multiply the results, reporting the measured area of the rectangle back to you. For example, if x=4 and you query a 3\xc3\x975 rectangle, we will measure its side lengths as 3\xc3\x976 and report 18 back to you. Find the value of x. You can ask at most 7 queries." "binary search,interactive,ternary search" 1700
957A "Tritonic Iridescence" "Overlooking the captivating blend of myriads of vernal hues, Arkady the painter lays out a long, long canvas.Arkady has a sufficiently large amount of paint of three colours: cyan, magenta, and yellow. On the one-dimensional canvas split into n consecutive segments, each segment needs to be painted in one of the colours.Arkady has already painted some (possibly none or all) segments and passes the paintbrush to you. You are to determine whether there are at least two ways of colouring all the unpainted segments so that no two adjacent segments are of the same colour. Two ways are considered different if and only if a segment is painted in different colours in them." implementation 1300
1696G "Fishingprince Plays With Array Again" "Suppose you are given a 1-indexed sequence a of non-negative integers, whose length is n, and two integers x, y. In consecutive t seconds (t can be any positive real number), you can do one of the following operations:  Select 1\xe2\x89\xa4i<n, decrease ai by x\xe2\x8b\x85t, and decrease ai+1 by y\xe2\x8b\x85t.  Select 1\xe2\x89\xa4i<n, decrease ai by y\xe2\x8b\x85t, and decrease ai+1 by x\xe2\x8b\x85t. Define the minimum amount of time (it might be a real number) required to make all elements in the sequence less than or equal to 0 as f(a).For example, when x=1, y=2, it takes 3 seconds to deal with the array [3,1,1,3]. We can:  In the first 1.5 seconds do the second operation with i=1.  In the next 1.5 seconds do the first operation with i=3. We can prove that it\'s not possible to make all elements less than or equal to 0 in less than 3 seconds, so f([3,1,1,3])=3.Now you are given a 1-indexed sequence b of positive integers, whose length is n. You are also given positive integers x, y. Process q queries of the following two types:  1 k v: change bk to v.  2 l r: print f([bl,bl+1,\xe2\x80\xa6,br])." "brute force,data structures,geometry,math" 3300
840C "On the Bench" "A year ago on the bench in public park Leha found an array of n numbers. Leha believes that permutation p is right if for all 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89n condition, that api\xc2\xb7api\xe2\x80\x89+\xe2\x80\x891 is not perfect square, holds. Leha wants to find number of right permutations modulo 109\xe2\x80\x89+\xe2\x80\x897." combinatorics,dp 2500
1152F2 "Neko Rules the Catniverse (Large Version)" "This problem is same as the previous one, but has larger constraints.Aki is playing a new video game. In the video game, he will control Neko, the giant cat, to fly between planets in the Catniverse.There are n planets in the Catniverse, numbered from 1 to n. At the beginning of the game, Aki chooses the planet where Neko is initially located. Then Aki performs k\xe2\x88\x921 moves, where in each move Neko is moved from the current planet x to some other planet y such that:  Planet y is not visited yet.  1\xe2\x89\xa4y\xe2\x89\xa4x+m (where m is a fixed constant given in the input) This way, Neko will visit exactly k different planets. Two ways of visiting planets are called different if there is some index i such that, the i-th planet visited in the first way is different from the i-th planet visited in the second way.What is the total number of ways to visit k planets this way? Since the answer can be quite large, print it modulo 109+7." bitmasks,dp,matrices 3000
864D "Make a Permutation!" "Ivan has an array consisting of n elements. Each of the elements is an integer from 1 to n.Recently Ivan learned about permutations and their lexicographical order. Now he wants to change (replace) minimum number of elements in his array in such a way that his array becomes a permutation (i.e. each of the integers from 1 to n was encountered in his array exactly once). If there are multiple ways to do it he wants to find the lexicographically minimal permutation among them.Thus minimizing the number of changes has the first priority, lexicographical minimizing has the second priority.In order to determine which of the two permutations is lexicographically smaller, we compare their first elements. If they are equal \xe2\x80\x94 compare the second, and so on. If we have two permutations x and y, then x is lexicographically smaller if xi\xe2\x80\x89<\xe2\x80\x89yi, where i is the first index in which the permutations x and y differ.Determine the array Ivan will obtain after performing all the changes." greedy,implementation,math 1500
1115U3 "Block unitary" "Implement a unitary operation on N qubits which is represented by the following square matrix of size 2N: top right and bottom left quarters are filled with zero elements,  top left quarter is an anti-diagonal matrix of size 2N\xe2\x88\x921, bottom right quarter is filled with non-zero elements.For example, for N=2 the matrix of the operation should have the following shape:.X..X.....XX..XXHere X denotes a ""non-zero"" element of the matrix (a complex number which has the square of the absolute value greater than or equal to 10\xe2\x88\x925), and . denotes a ""zero"" element of the matrix (a complex number which has the square of the absolute value less than 10\xe2\x88\x925).The row and column indices of the matrix follow little endian format: the least significant bit of the index is stored first in the qubit array. Thus, the first column of the matrix gives you the coefficients of the basis states you\'ll get if you apply the unitary to the |00..0\xe2\x9f\xa9 basis state, the second column - to the |10..0\xe2\x9f\xa9 basis state etc. You can use the DumpUnitary tool to get the coefficients of the matrix your unitary implements (up to relative phases between columns) and the corresponding pattern of Xs and .s.You have to implement an operation which takes an array of N (2\xe2\x89\xa4N\xe2\x89\xa45) qubits as an input and applies the unitary transformation with the matrix of the described shape to it. If there are multiple unitaries which satisfy the requirements, you can implement any of them. The ""output"" of your operation is the pattern of the matrix coefficients implemented by it; you can see the testing harness in the UnitaryPatterns kata.Your code should have the following signature:namespace Solution {    open Microsoft.Quantum.Primitive;    open Microsoft.Quantum.Canon;    operation Solve (qs : Qubit[]) : Unit {        // your code here    }}" "*special problem" 1700
439C "Devu and Partitioning of the Array" "Devu being a small kid, likes to play a lot, but he only likes to play with arrays. While playing he came up with an interesting question which he could not solve, can you please solve it for him?Given an array consisting of distinct integers. Is it possible to partition the whole array into k disjoint non-empty parts such that p of the parts have even sum (each of them must have even sum) and remaining k - p have odd sum? (note that parts need not to be continuous).If it is possible to partition the array, also give any possible way of valid partitioning." "brute force,constructive algorithms,implementation,number theory" 1700
81B "Sequence Formatting" "Polycarp is very careful. He even types numeric sequences carefully, unlike his classmates. If he sees a sequence without a space after the comma, with two spaces in a row, or when something else does not look neat, he rushes to correct it. For example, number sequence written like ""1,2 ,3,...,   10"" will be corrected to ""1, 2, 3, ..., 10"".In this task you are given a string s, which is composed by a concatination of terms, each of which may be:   a positive integer of an arbitrary length (leading zeroes are not allowed),  a ""comma"" symbol ("",""),  a ""space"" symbol ("" ""),  ""three dots"" (""..."", that is, exactly three points written one after another, also known as suspension points). Polycarp wants to add and remove spaces in the string s to ensure the following:   each comma is followed by exactly one space (if the comma is the last character in the string, this rule does not apply to it),  each ""three dots"" term is preceded by exactly one space (if the dots are at the beginning of the string, this rule does not apply to the term),  if two consecutive numbers were separated by spaces only (one or more), then exactly one of them should be left,  there should not be other spaces. Automate Polycarp\'s work and write a program that will process the given string s." implementation,strings 1700
331A2 "Oh Sweet Beaverette" "\xe2\x80\x94 Oh my sweet Beaverette, would you fancy a walk along a wonderful woodland belt with me?   \xe2\x80\x94 Of course, my Smart Beaver! Let us enjoy the splendid view together. How about Friday night? At this point the Smart Beaver got rushing. Everything should be perfect by Friday, so he needed to prepare the belt to the upcoming walk. He needed to cut down several trees.Let\'s consider the woodland belt as a sequence of trees. Each tree i is described by the esthetic appeal ai \xe2\x80\x94 some trees are very esthetically pleasing, others are \'so-so\', and some trees are positively ugly!The Smart Beaver calculated that he needed the following effects to win the Beaverette\'s heart:   The first objective is to please the Beaverette: the sum of esthetic appeal of the remaining trees must be maximum possible;  the second objective is to surprise the Beaverette: the esthetic appeal of the first and the last trees in the resulting belt must be the same;  and of course, the walk should be successful: there must be at least two trees in the woodland belt left. Now help the Smart Beaver! Which trees does he need to cut down to win the Beaverette\'s heart?" "data structures,sortings" 1500
1269A Equation "Let\'s call a positive integer composite if it has at least one divisor other than 1 and itself. For example:  the following numbers are composite: 1024, 4, 6, 9;  the following numbers are not composite: 13, 1, 2, 3, 37. You are given a positive integer n. Find two composite integers a,b such that a\xe2\x88\x92b=n.It can be proven that solution always exists." "brute force,math" 800
1730F "Almost Sorted" "You are given a permutation p of length n and a positive integer k. Consider a permutation q of length n such that for any integers i and j, where 1\xe2\x89\xa4i<j\xe2\x89\xa4n, we have pqi\xe2\x89\xa4pqj+k.Find the minimum possible number of inversions in a permutation q.A permutation is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array) and [1,3,4] is also not a permutation (n=3 but there is 4 in the array).An inversion in a permutation a is a pair of indices i and j (1\xe2\x89\xa4i,j\xe2\x89\xa4n) such that i<j, but ai>aj." "bitmasks,data structures,dp" 2700
855C "Helga Hufflepuff\'s Cup" "Harry, Ron and Hermione have figured out that Helga Hufflepuff\'s cup is a horcrux. Through her encounter with Bellatrix Lestrange, Hermione came to know that the cup is present in Bellatrix\'s family vault in Gringott\'s Wizarding Bank. The Wizarding bank is in the form of a tree with total n vaults where each vault has some type, denoted by a number between 1 to m. A tree is an undirected connected graph with no cycles.The vaults with the highest security are of type k, and all vaults of type k have the highest security.There can be at most x vaults of highest security. Also, if a vault is of the highest security, its adjacent vaults are guaranteed to not be of the highest security and their type is guaranteed to be less than k.Harry wants to consider every possibility so that he can easily find the best path to reach Bellatrix\'s vault. So, you have to tell him, given the tree structure of Gringotts, the number of possible ways of giving each vault a type such that the above conditions hold." dp,trees 2000
1624D "Palindromes Coloring" "You have a string s consisting of lowercase Latin alphabet letters. You can color some letters in colors from 1 to k. It is not necessary to paint all the letters. But for each color, there must be a letter painted in that color.Then you can swap any two symbols painted in the same color as many times as you want. After that, k strings will be created, i-th of them will contain all the characters colored in the color i, written in the order of their sequence in the string s.Your task is to color the characters of the string so that all the resulting k strings are palindromes, and the length of the shortest of these k strings is as large as possible.Read the note for the first test case of the example if you need a clarification.Recall that a string is a palindrome if it reads the same way both from left to right and from right to left. For example, the strings abacaba, cccc, z and dxd are palindromes, but the strings abab and aaabaa \xe2\x80\x94 are not." "binary search,greedy,sortings,strings" 1400
1663E "Are You Safe?" "Seven boys and seven girls from Athens were brought before King Minos. The evil king laughed and said ""I hope you enjoy your stay in Crete"".With a loud clang, the doors behind them shut, and darkness reigned. The terrified children huddled together. In the distance they heard a bellowing, unholy roar.Bravely, they advanced forward, to their doom." "*special problem,implementation" -999
1842H "Tenzing and Random Real Numbers" "There are n uniform random real variables between 0 and 1, inclusive, which are denoted as x1,x2,\xe2\x80\xa6,xn.Tenzing has m conditions. Each condition has the form of xi+xj\xe2\x89\xa41 or xi+xj\xe2\x89\xa51.Tenzing wants to know the probability that all the conditions are satisfied, modulo 998 244 353.Formally, let M=998 244 353. It can be shown that the answer can be expressed as an irreducible fraction pq, where p and q are integers and q\xe2\x89\xa20(modM). Output the integer equal to p\xe2\x8b\x85q\xe2\x88\x921modM. In other words, output the integer x that 0\xe2\x89\xa4x<M and x\xe2\x8b\x85q\xe2\x89\xa1p(modM)." bitmasks,dp,graphs,math,probabilities 3000
1975H "378QAQ and Core" "378QAQ has a string s of length n. Define the core of a string as the substring\xe2\x80\xa0 with maximum lexicographic\xe2\x80\xa1 order.For example, the core of ""bazoka"" is ""zoka"", and the core of ""aaa"" is ""aaa"".378QAQ wants to rearrange the string s so that the core is lexicographically minimum. Find the lexicographically minimum possible core over all rearrangements of s.\xe2\x80\xa0 A substring of string s is a continuous segment of letters from s. For example, ""defor"", ""code"" and ""o"" are all substrings of ""codeforces"" while ""codes"" and ""aaa"" are not.\xe2\x80\xa1 A string p is lexicographically smaller than a string q if and only if one of the following holds:   p is a prefix of q, but p\xe2\x89\xa0q; or  in the first position where p and q differ, the string p has a smaller element than the corresponding element in q (when compared by their ASCII code). For example, ""code"" and ""coda"" are both lexicographically smaller than ""codeforces"" while ""codeforceston"" and ""z"" are not." greedy,strings 3500
35A "Shell Game" "Today the \xc2\xabZ\xc2\xbb city residents enjoy a shell game competition. The residents are gathered on the main square to watch the breath-taking performance. The performer puts 3 non-transparent cups upside down in a row. Then he openly puts a small ball under one of the cups and starts to shuffle the cups around very quickly so that on the whole he makes exactly 3 shuffles. After that the spectators have exactly one attempt to guess in which cup they think the ball is and if the answer is correct they get a prize. Maybe you can try to find the ball too?" implementation 1000
1948F "Rare Coins" "There are n bags numbered from 1 to n, the i-th bag contains ai golden coins and bi silver coins.The value of a gold coin is 1. The value of a silver coin is either 0 or 1, determined for each silver coin independently (0 with probability 12, 1 with probability 12).You have to answer q independent queries. Each query is the following:   l r \xe2\x80\x94 calculate the probability that the total value of coins in bags from l to r is strictly greater than the total value in all other bags." combinatorics,math,probabilities 2500
1990E2 "Catch the Mole(Hard Version)" "This is the hard version of the problem. The only difference is the limit on the number of queries.This is an interactive problem.You are given a tree of n nodes with node 1 as its root node.There is a hidden mole in one of the nodes. To find its position, you can pick an integer x (1\xe2\x89\xa4x\xe2\x89\xa4n) to make an inquiry to the jury. Next, the jury will return 1 when the mole is in subtree x. Otherwise, the judge will return 0. If the judge returns 0 and the mole is not in root node 1, the mole will move to the parent node of the node it is currently on.Use at most 160 operations to find the current node where the mole is located." "binary search,data structures,dfs and similar,divide and conquer,interactive,trees" 2600
25E Test "Sometimes it is hard to prepare tests for programming problems. Now Bob is preparing tests to new problem about strings \xe2\x80\x94 input data to his problem is one string. Bob has 3 wrong solutions to this problem. The first gives the wrong answer if the input data contains the substring s1, the second enters an infinite loop if the input data contains the substring s2, and the third requires too much memory if the input data contains the substring s3. Bob wants these solutions to fail single test. What is the minimal length of test, which couldn\'t be passed by all three Bob\'s solutions?" hashing,strings 2200
1912B "Blueprint for Seating" "An aircraft manufacturing company wants to optimize their products for passenger airlines. The company\'s latest research shows that most of the delays happen because of slow boarding.Most of the medium-sized aircraft are designed with 3-3 seat layout, meaning each row has 6 seats: 3 seats on the left side, a single aisle, and 3 seats on the right side. At each of the left and right sides there is a window seat, a middle seat, and an aisle seat. A passenger that boards an aircraft assigned to an aisle seat takes significantly less time than a passenger assigned to a window seat even when there is no one else in the aircraft.The company decided to compute an inconvenience of a layout as the total sum of distances from each of the seats of a single row to the closest aisle. The distance from a seat to an aisle is the number of seats between them. For a 3-3 layout, a window seat has a distance of 2, a middle seat \xe2\x80\x94 1, and an aisle seat \xe2\x80\x94 0. The inconvenience of a 3-3 layout is (2+1+0)+(0+1+2)=6. The inconvenience of a 3-5-3 layout is (2+1+0)+(0+1+2+1+0)+(0+1+2)=10.Formally, a layout is a sequence of positive integers a1,a2,\xe2\x80\xa6,ak+1 \xe2\x80\x94 group i having ai seats, with k aisles between groups, the i-th aisle being between groups i and i+1. This means that in a layout each aisle must always be between two seats, so no aisle can be next to a window, and no two aisles can be next to each other.The company decided to design a layout with a row of n seats, k aisles and having the minimum inconvenience possible. Help them find the minimum inconvenience among all layouts of n seats and k aisles, and count the number of such layouts modulo 998244353." "combinatorics,divide and conquer,math" 2100
639E "Bear and Paradox" "Limak is a big polar bear. He prepared n problems for an algorithmic contest. The i-th problem has initial score pi. Also, testers said that it takes ti minutes to solve the i-th problem. Problems aren\'t necessarily sorted by difficulty and maybe harder problems have smaller initial score but it\'s too late to change it \xe2\x80\x94 Limak has already announced initial scores for problems. Though it\'s still possible to adjust the speed of losing points, denoted by c in this statement.Let T denote the total number of minutes needed to solve all problems (so, T\xe2\x80\x89=\xe2\x80\x89t1\xe2\x80\x89+\xe2\x80\x89t2\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89tn). The contest will last exactly T minutes. So it\'s just enough to solve all problems.Points given for solving a problem decrease linearly. Solving the i-th problem after x minutes gives exactly  points, where  is some real constant that Limak must choose.Let\'s assume that c is fixed. During a contest a participant chooses some order in which he or she solves problems. There are n! possible orders and each of them gives some total number of points, not necessarily integer. We say that an order is optimal if it gives the maximum number of points. In other words, the total number of points given by this order is greater or equal than the number of points given by any other order. It\'s obvious that there is at least one optimal order. However, there may be more than one optimal order.Limak assumes that every participant will properly estimate ti at the very beginning and will choose some optimal order. He also assumes that testers correctly predicted time needed to solve each problem.For two distinct problems i and j such that pi\xe2\x80\x89<\xe2\x80\x89pj Limak wouldn\'t be happy to see a participant with strictly more points for problem i than for problem j. He calls such a situation a paradox.It\'s not hard to prove that there will be no paradox for c\xe2\x80\x89=\xe2\x80\x890. The situation may be worse for bigger c. What is the maximum real value c (remember that ) for which there is no paradox possible, that is, there will be no paradox for any optimal order of solving problems?It can be proved that the answer (the maximum c as described) always exists." "binary search,greedy,math,sortings" 2800
133A HQ9+ "HQ9+ is a joke programming language which has only four one-character instructions: ""H"" prints ""Hello, World!"", ""Q"" prints the source code of the program itself, ""9"" prints the lyrics of ""99 Bottles of Beer"" song,  ""+"" increments the value stored in the internal accumulator.Instructions ""H"" and ""Q"" are case-sensitive and must be uppercase. The characters of the program which are not instructions are ignored.You are given a program written in HQ9+. You have to figure out whether executing this program will produce any output." implementation 900
1214D "Treasure Island" "All of us love treasures, right? That\'s why young Vasya is heading for a Treasure Island.Treasure Island may be represented as a rectangular table n\xc3\x97m which is surrounded by the ocean. Let us number rows of the field with consecutive integers from 1 to n from top to bottom and columns with consecutive integers from 1 to m from left to right. Denote the cell in r-th row and c-th column as (r,c). Some of the island cells contain impassable forests, and some cells are free and passable. Treasure is hidden in cell (n,m).Vasya got off the ship in cell (1,1). Now he wants to reach the treasure. He is hurrying up, so he can move only from cell to the cell in next row (downwards) or next column (rightwards), i.e. from cell (x,y) he can move only to cells (x+1,y) and (x,y+1). Of course Vasya can\'t move through cells with impassable forests.Evil Witch is aware of Vasya\'s journey and she is going to prevent him from reaching the treasure. Before Vasya\'s first move she is able to grow using her evil magic impassable forests in previously free cells. Witch is able to grow a forest in any number of any free cells except cells (1,1) where Vasya got off his ship and (n,m) where the treasure is hidden.Help Evil Witch by finding out the minimum number of cells she has to turn into impassable forests so that Vasya is no longer able to reach the treasure." "dfs and similar,dp,flows,hashing" 1900
2011A "Problem Solving" "Jane has decided to solve a list of n problems on Codeforces. The i-th problem in her list has difficulty di, and the last problem in the list is the hardest one (for every problem j<n, dj<dn).Jane\'s problem-solving skill is some integer x (unknown to you). If a problem\'s difficulty is greater than x, then Jane cannot solve it, otherwise she can solve it.Jane has solved all problems form the list, except for the last one \xe2\x80\x94 she found out that it was too difficult for her. Can you uniquely determine the value of x \xe2\x80\x94 Jane\'s problem solving skill?" "*special problem" -999
228B "Two Tables" "You\'ve got two rectangular tables with sizes na\xe2\x80\x89\xc3\x97\xe2\x80\x89ma and nb\xe2\x80\x89\xc3\x97\xe2\x80\x89mb cells. The tables consist of zeroes and ones. We will consider the rows and columns of both tables indexed starting from 1. Then we will define the element of the first table, located at the intersection of the i-th row and the j-th column, as ai,\xe2\x80\x89j; we will define the element of the second table, located at the intersection of the i-th row and the j-th column, as bi,\xe2\x80\x89j. We will call the pair of integers (x,\xe2\x80\x89y) a shift of the second table relative to the first one. We\'ll call the overlap factor of the shift (x,\xe2\x80\x89y) value:where the variables i,\xe2\x80\x89j take only such values, in which the expression ai,\xe2\x80\x89j\xc2\xb7bi\xe2\x80\x89+\xe2\x80\x89x,\xe2\x80\x89j\xe2\x80\x89+\xe2\x80\x89y makes sense. More formally, inequalities 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89na,\xe2\x80\x891\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ma,\xe2\x80\x891\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89+\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89nb,\xe2\x80\x891\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89+\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89mb must hold. If there are no values of variables i,\xe2\x80\x89j, that satisfy the given inequalities, the value of the sum is considered equal to 0. Your task is to find the shift with the maximum overlap factor among all possible shifts." "brute force,implementation" 1400
1359D "Yet Another Yet Another Task" "Alice and Bob are playing yet another card game. This time the rules are the following. There are n cards lying in a row in front of them. The i-th card has value ai. First, Alice chooses a non-empty consecutive segment of cards [l;r] (l\xe2\x89\xa4r). After that Bob removes a single card j from that segment (l\xe2\x89\xa4j\xe2\x89\xa4r). The score of the game is the total value of the remaining cards on the segment (al+al+1+\xe2\x8b\xaf+aj\xe2\x88\x921+aj+1+\xe2\x8b\xaf+ar\xe2\x88\x921+ar). In particular, if Alice chooses a segment with just one element, then the score after Bob removes the only card is 0.Alice wants to make the score as big as possible. Bob takes such a card that the score is as small as possible.What segment should Alice choose so that the score is maximum possible? Output the maximum score." "data structures,dp,implementation,two pointers" 2000
1532D "Teams Forming" "There are n students in a university. The number of students is even. The i-th student has programming skill equal to ai. The coach wants to form n2 teams. Each team should consist of exactly two students, and each student should belong to exactly one team. Two students can form a team only if their skills are equal (otherwise they cannot understand each other and cannot form a team).Students can solve problems to increase their skill. One solved problem increases the skill by one.The coach wants to know the minimum total number of problems students should solve to form exactly n2 teams (i.e. each pair of students should form a team). Your task is to find this number." "*special problem,sortings" -999
37A Towers "Little Vasya has received a young builder\xe2\x80\x99s kit. The kit consists of several wooden bars, the lengths of all of them are known. The bars can be put one on the top of the other if their lengths are the same.Vasya wants to construct the minimal number of towers from the bars. Help Vasya to use the bars in the best way possible." sortings 1000
1402C "Star Trek" "The United Federation of Planets is an alliance of N planets, they are indexed from 1 to N. Some planets are connected by space tunnels. In a space tunnel, a starship can fly both ways really fast. There are exactly N\xe2\x88\x921 space tunnels, and we can travel from any planet to any other planet in the Federation using these tunnels.It\'s well known that there are D additional parallel universes. These are exact copies of our universe, they have the same planets and space tunnels. They are indexed from 1 to D (our universe has index 0). We denote the planet x in universe i by Pix. We can travel from one universe to another using dimension portals. For every i (0\xe2\x89\xa4i\xe2\x89\xa4D\xe2\x88\x921), we will place exactly one portal that allows us to fly from PiAi to Pi+1Bi, for some planet indices Ai and Bi (i.e. 1\xe2\x89\xa4Ai,Bi\xe2\x89\xa4N).Once all the portals are placed, Starship Batthy\xc3\xa1ny will embark on its maiden voyage. It is currently orbiting around P01. Captain \xc3\x81gnes and Lieutenant G\xc3\xa1bor have decided to play the following game: they choose alternately a destination (a planet) to fly to. This planet can be in the same universe, if a space tunnel goes there, or it can be in another universe, if a portal goes there. Their aim is to visit places where no one has gone before. That\'s why, once they have visited a planet Pix, they never go back there (but they can visit the planet x in another universe). Captain \xc3\x81gnes chooses the first destination (then G\xc3\xa1bor, then \xc3\x81gnes etc.). If somebody can\'t choose a planet where they have not been before in his/her turn, he/she loses.Captain \xc3\x81gnes and Lieutenant G\xc3\xa1bor are both very clever: they know the locations of all tunnels and portals, and they both play optimally. For how many different placements of portals does Captain \xc3\x81gnes win the game? Two placements are different if there is an index i (0\xe2\x89\xa4i\xe2\x89\xa4D\xe2\x88\x921), where the ith portal connects different pairs of planets in the two placements (i.e Ai or Bi differs).This number can be very big, so we are interested in it modulo 109+7." "*special problem,combinatorics,dfs and similar,dp,games,graphs,matrices,trees" 2600
865G "Flowers and Chocolate" "It\'s Piegirl\'s birthday soon, and Pieguy has decided to buy her a bouquet of flowers and a basket of chocolates.The flower shop has F different types of flowers available. The i-th type of flower always has exactly pi petals. Pieguy has decided to buy a bouquet consisting of exactly N flowers. He may buy the same type of flower multiple times. The N flowers are then arranged into a bouquet. The position of the flowers within a bouquet matters. You can think of a bouquet as an ordered list of flower types.The chocolate shop sells chocolates in boxes. There are B different types of boxes available. The i-th type of box contains ci pieces of chocolate. Pieguy can buy any number of boxes, and can buy the same type of box multiple times. He will then place these boxes into a basket. The position of the boxes within the basket matters. You can think of the basket as an ordered list of box types.Pieguy knows that Piegirl likes to pluck a petal from a flower before eating each piece of chocolate. He would like to ensure that she eats the last piece of chocolate from the last box just after plucking the last petal from the last flower. That is, the total number of petals on all the flowers in the bouquet should equal the total number of pieces of chocolate in all the boxes in the basket.How many different bouquet+basket combinations can Pieguy buy? The answer may be very large, so compute it modulo 1000000007\xe2\x80\x89=\xe2\x80\x89109\xe2\x80\x89+\xe2\x80\x897." combinatorics,math,matrices 3300
1304D "Shortest and Longest LIS" "Gildong recently learned how to find the longest increasing subsequence (LIS) in O(nlogn) time for a sequence of length n. He wants to test himself if he can implement it correctly, but he couldn\'t find any online judges that would do it (even though there are actually many of them). So instead he\'s going to make a quiz for you about making permutations of n distinct integers between 1 and n, inclusive, to test his code with your output.The quiz is as follows.Gildong provides a string of length n\xe2\x88\x921, consisting of characters \'<\' and \'>\' only. The i-th (1-indexed) character is the comparison result between the i-th element and the i+1-st element of the sequence. If the i-th character of the string is \'<\', then the i-th element of the sequence is less than the i+1-st element. If the i-th character of the string is \'>\', then the i-th element of the sequence is greater than the i+1-st element.He wants you to find two possible sequences (not necessarily distinct) consisting of n distinct integers between 1 and n, inclusive, each satisfying the comparison results, where the length of the LIS of the first sequence is minimum possible, and the length of the LIS of the second sequence is maximum possible." "constructive algorithms,graphs,greedy,two pointers" 1800
1662I "Ice Cream Shop" "On a beach there are n huts in a perfect line, hut 1 being at the left and hut i+1 being 100 meters to the right of hut i, for all 1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921. In hut i there are pi people.There are m ice cream sellers, also aligned in a perfect line with all the huts. The i-th ice cream seller has their shop xi meters to the right of the first hut. All ice cream shops are at distinct locations, but they may be at the same location as a hut.You want to open a new ice cream shop and you wonder what the best location for your shop is. You can place your ice cream shop anywhere on the beach (not necessarily at an integer distance from the first hut) as long as it is aligned with the huts and the other ice cream shops, even if there is already another ice cream shop or a hut at that location. You know that people would come to your shop only if it is strictly closer to their hut than any other ice cream shop.If every person living in the huts wants to buy exactly one ice cream, what is the maximum number of ice creams that you can sell if you place the shop optimally?" "brute force,implementation,sortings" -999
1680F "Lenient Vertex Cover" "You are given a simple connected undirected graph, consisting of n vertices and m edges. The vertices are numbered from 1 to n.A vertex cover of a graph is a set of vertices such that each edge has at least one of its endpoints in the set.Let\'s call a lenient vertex cover such a vertex cover that at most one edge in it has both endpoints in the set.Find a lenient vertex cover of a graph or report that there is none. If there are multiple answers, then print any of them." "dfs and similar,divide and conquer,dsu,graphs,trees" 2600
630C "Lucky Numbers" "The numbers of all offices in the new building of the Tax Office of IT City will have lucky numbers.Lucky number is a number that consists of digits 7 and 8 only. Find the maximum number of offices in the new building of the Tax Office given that a door-plate can hold a number not longer than n digits." combinatorics,math 1100
132C "Logo Turtle" "A lot of people associate Logo programming language with turtle graphics. In this case the turtle moves along the straight line and accepts commands ""T"" (""turn around"") and ""F"" (""move 1 unit forward"").You are given a list of commands that will be given to the turtle. You have to change exactly n commands from the list (one command can be changed several times). How far from the starting point can the turtle move after it follows all the commands of the modified list?" dp 1800
374C "Inna and Dima" "Inna and Dima bought a table of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m in the shop. Each cell of the table contains a single letter: ""D"", ""I"", ""M"", ""A"".Inna loves Dima, so she wants to go through his name as many times as possible as she moves through the table. For that, Inna acts as follows:  initially, Inna chooses some cell of the table where letter ""D"" is written;  then Inna can move to some side-adjacent table cell that contains letter ""I""; then from this cell she can go to one of the side-adjacent table cells that contains the written letter ""M""; then she can go to a side-adjacent cell that contains letter ""A"". Then Inna assumes that she has gone through her sweetheart\'s name;  Inna\'s next move can be going to one of the side-adjacent table cells that contains letter ""D"" and then walk on through name DIMA in the similar manner. Inna never skips a letter. So, from the letter ""D"" she always goes to the letter ""I"", from the letter ""I"" she always goes the to letter ""M"", from the letter ""M"" she always goes to the letter ""A"", and from the letter ""A"" she always goes to the letter ""D"". Depending on the choice of the initial table cell, Inna can go through name DIMA either an infinite number of times or some positive finite number of times or she can\'t go through his name once. Help Inna find out what maximum number of times she can go through name DIMA." "dfs and similar,dp,graphs,implementation" 1900
205B "Little Elephant and Sorting" "The Little Elephant loves sortings.He has an array a consisting of n integers. Let\'s number the array elements from 1 to n, then the i-th element will be denoted as ai. The Little Elephant can make one move to choose an arbitrary pair of integers l and r (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) and increase ai by 1 for all i such that l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r.Help the Little Elephant find the minimum number of moves he needs to convert array a to an arbitrary array sorted in the non-decreasing order. Array a, consisting of n elements, is sorted in the non-decreasing order if for any i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89n) ai\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x891 holds." "brute force,greedy" 1400
1051F "The Shortest Statement" "You are given a weighed undirected connected graph, consisting of n vertices and m edges.You should answer q queries, the i-th query is to find the shortest distance between vertices ui and vi." "graphs,shortest paths,trees" 2400
894A QAQ """QAQ"" is a word to denote an expression of crying. Imagine ""Q"" as eyes with tears and ""A"" as a mouth.Now Diamond has given Bort a string consisting of only uppercase English letters of length n. There is a great number of ""QAQ"" in the string (Diamond is so cute!).  illustration by \xe7\x8c\xab\xe5\xb1\x8b https://twitter.com/nekoyaliu Bort wants to know how many subsequences ""QAQ"" are in the string Diamond has given. Note that the letters ""QAQ"" don\'t have to be consecutive, but the order of letters should be exact." "brute force,dp" 800
86B "Tetris revisited" "Physicist Woll likes to play one relaxing game in between his search of the theory of everything.Game interface consists of a rectangular n\xe2\x80\x89\xc3\x97\xe2\x80\x89m playing field and a dashboard. Initially some cells of the playing field are filled while others are empty. Dashboard contains images of all various connected (we mean connectivity by side) figures of 2, 3, 4 and 5 cells, with all their rotations and reflections. Player can copy any figure from the dashboard and place it anywhere at the still empty cells of the playing field. Of course any figure can be used as many times as needed.Woll\'s aim is to fill the whole field in such a way that there are no empty cells left, and also... just have some fun.Every initially empty cell should be filled with exactly one cell of some figure. Every figure should be entirely inside the board.  In the picture black cells stand for initially filled cells of the field, and one-colour regions represent the figures." "constructive algorithms,graph matchings,greedy,math" 2200
291D "Parallel Programming" "Polycarpus has a computer with n processors. Also, his computer has n memory cells. We\'ll consider the processors numbered by integers from 1 to n and that the memory cells are consecutively numbered by integers from 1 to n.Polycarpus needs to come up with a parallel program model. For each memory cell number i this program must record the value n\xe2\x80\x89-\xe2\x80\x89i to this cell. In other words, for each cell you\'ve got to find the distance to cell n.Let\'s denote the value that is written in the i-th cell as ai. Initially, ai\xe2\x80\x89=\xe2\x80\x891 (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89n) and an\xe2\x80\x89=\xe2\x80\x890. We will consider that only processor i can write values in the memory cell number i. All processors can read an information from some cell (several processors can read an information from some cell simultaneously).The parallel program is executed in several steps. During each step we execute the parallel version of the increment operation. Executing the parallel version of the increment operation goes as follows:  Each processor independently of the other ones chooses some memory cell. Let\'s say that processor i has chosen a cell with number ci (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ci\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n).  All processors simultaneously execute operation ai\xe2\x80\x89=\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x89aci. Help Polycarpus come up with the parallel program model that is executed in exactly k steps. Calculate the operations that need to be executed. Note that after k steps for all i\'s value ai must be equal n\xe2\x80\x89-\xe2\x80\x89i." "*special problem,greedy" 1600
1415C "Bouncing Ball" "You\'re creating a game level for some mobile game. The level should contain some number of cells aligned in a row from left to right and numbered with consecutive integers starting from 1, and in each cell you can either put a platform or leave it empty.In order to pass a level, a player must throw a ball from the left so that it first lands on a platform in the cell p, then bounces off it, then bounces off a platform in the cell (p+k), then a platform in the cell (p+2k), and so on every k-th platform until it goes farther than the last cell. If any of these cells has no platform, you can\'t pass the level with these p and k.You already have some level pattern a1, a2, a3, ..., an, where ai=0 means there is no platform in the cell i, and ai=1 means there is one. You want to modify it so that the level can be passed with given p and k. In x seconds you can add a platform in some empty cell. In y seconds you can remove the first cell completely, reducing the number of cells by one, and renumerating the other cells keeping their order. You can\'t do any other operation. You can not reduce the number of cells to less than p.  Illustration for the third example test case. Crosses mark deleted cells. Blue platform is the newly added. What is the minimum number of seconds you need to make this level passable with given p and k?" "brute force,dp,implementation" 1400
1137F "Matches Are Not a Child\'s Play" "Lena is playing with matches. The natural question arising in the head of any child playing with matches is whether it\'s possible to set a tree on fire with a matches, or not.Let\'s say, that the tree is a connected graph without cycles and the vertices are labeled with integers 1,2,\xe2\x80\xa6,n1,2,\xe2\x80\xa6,n. Also every vertex vv has some integer priority pvpv associated with it. All priorities are distinct.It turns out, that if you set a tree on fire, it will burn to nothing. However, this process doesn\'t happen instantly. At the beginning, burns out the leaf (a vertex is called to be a leaf if it has only one adjacent vertex) of the tree of the minimum priority. Then burns out the leaf of the minimal priority of the remaining tree, and so on. This way, the vertices turn into the leaves and burn out until only one vertex remains. Then this vertex burns out as well.Lena has prepared a tree of nn vertices and every vertex in it has a priority pv=vpv=v. Lena is very curious about burning out this tree. However, she understands, that if she will burn the tree now, then it will disappear completely. Lena is a kind girl and she will feel bad for the burned tree, so she wants to study the process of burning the tree only in her mind. Lena wants to process qq queries, each of them is one of three following types:  ""up vv"", assign the vertex vv priority 1+max{p1,p2,\xe2\x80\xa6,pn}1+max{p1,p2,\xe2\x80\xa6,pn};  ""when vv"", find the step at which the vertex vv will burn out, if the tree would be set on fire now;  ""compare vv uu"", find out which of the vertices vv and uu will burn out first, if the tree would be set on fire now. Notice, that if all priorities would be distinct, then after the ""up"" query they will stay distinct as well. Initially all priorities are distinct, hence during any (purely hypothetical of course) burning of the tree, all leafs would have distinct priorities." "data structures,trees" 3400
1183F "Topforces Strikes Back" "One important contest will take place on the most famous programming platform (Topforces) very soon!The authors have a pool of n problems and should choose at most three of them into this contest. The prettiness of the i-th problem is ai. The authors have to compose the most pretty contest (in other words, the cumulative prettinesses of chosen problems should be maximum possible).But there is one important thing in the contest preparation: because of some superstitions of authors, the prettinesses of problems cannot divide each other. In other words, if the prettinesses of chosen problems are x,y,z, then x should be divisible by neither y, nor z, y should be divisible by neither x, nor z and z should be divisible by neither x, nor y. If the prettinesses of chosen problems are x and y then neither x should be divisible by y nor y should be divisible by x. Any contest composed from one problem is considered good.Your task is to find out the maximum possible total prettiness of the contest composed of at most three problems from the given pool.You have to answer q independent queries.If you are Python programmer, consider using PyPy instead of Python when you submit your code." "brute force,math,sortings" 2100
727E "Games on a CD" "Several years ago Tolya had n computer games and at some point of time he decided to burn them to CD. After that he wrote down the names of the games one after another in a circle on the CD in clockwise order. The names were distinct, the length of each name was equal to k. The names didn\'t overlap.Thus, there is a cyclic string of length n\xc2\xb7k written on the CD.Several years have passed and now Tolya can\'t remember which games he burned to his CD. He knows that there were g popular games that days. All of the games he burned were among these g games, and no game was burned more than once.You have to restore any valid list of games Tolya could burn to the CD several years ago." "data structures,hashing,string suffix structures,strings" 2300
868B "Race Against Time" "Have you ever tried to explain to the coordinator, why it is eight hours to the contest and not a single problem has been prepared yet? Misha had. And this time he has a really strong excuse: he faced a space-time paradox! Space and time replaced each other.The entire universe turned into an enormous clock face with three hands \xe2\x80\x94 hour, minute, and second. Time froze, and clocks now show the time h hours, m minutes, s seconds.Last time Misha talked with the coordinator at t1 o\'clock, so now he stands on the number t1 on the clock face. The contest should be ready by t2 o\'clock. In the terms of paradox it means that Misha has to go to number t2 somehow. Note that he doesn\'t have to move forward only: in these circumstances time has no direction.Clock hands are very long, and Misha cannot get round them. He also cannot step over as it leads to the collapse of space-time. That is, if hour clock points 12 and Misha stands at 11 then he cannot move to 1 along the top arc. He has to follow all the way round the clock center (of course, if there are no other hands on his way).Given the hands\' positions, t1, and t2, find if Misha can prepare the contest on time (or should we say on space?). That is, find if he can move from t1 to t2 by the clock face." implementation 1400
1910I "Inverse Problem" "Consider the following problem.You are given a string s, consisting of n lowercase Latin letters, and an integer k (n is not divisible by k). Each letter is one of the first c letters of the alphabet.You apply the following operation until the length of the string is less than k: choose a contiguous substring of the string of length exactly k, remove it from the string and glue the resulting parts together without changing the order.Let the resulting string of length smaller than k be t. What is lexicographically smallest string t that can obtained?You are asked the inverse of this problem. Given two integers n and k (n is not divisible by k) and a string t, consisting of (nmodk) lowercase Latin letters, count the number of strings s that produce t as the lexicographically smallest solution.Print that number modulo 998244353." "*special problem,combinatorics,dp" 2700
404E "Maze 1D" "Valera has a strip infinite in both directions and consisting of cells. The cells are numbered by integers. The cell number 0 has a robot.The robot has instructions \xe2\x80\x94 the sequence of moves that he must perform. In one move, the robot moves one cell to the left or one cell to the right, according to instructions. Before the robot starts moving, Valera puts obstacles in some cells of the strip, excluding cell number 0. If the robot should go into the cell with an obstacle according the instructions, it will skip this move.Also Valera indicates the finish cell in which the robot has to be after completing the entire instructions. The finishing cell should be different from the starting one. It is believed that the robot completed the instructions successfully, if during the process of moving he visited the finish cell exactly once \xe2\x80\x94 at its last move. Moreover, the latter move cannot be skipped.Let\'s assume that k is the minimum number of obstacles that Valera must put to make the robot able to complete the entire sequence of instructions successfully and end up in some finishing cell. You need to calculate in how many ways Valera can choose k obstacles and the finishing cell so that the robot is able to complete the instructions successfully." "binary search,greedy,implementation" 2200
1267K "Key Storage" "Karl is developing a key storage service. Each user has a positive integer key.Karl knows that storing keys in plain text is bad practice. So, instead of storing a key, he decided to store a fingerprint of a key. However, using some existing fingerprint algorithm looked too boring to him, so he invented his own one.Karl\'s fingerprint is calculated by the following process: divide the given integer by 2, then divide the result by 3, then divide the result by 4, and so on, until we get a result that equals zero (we are speaking about integer division each time). The fingerprint is defined as the multiset of the remainders of these divisions. For example, this is how Karl\'s fingerprint algorithm is applied to the key 11: 11 divided by 2 has remainder 1 and result 5, then 5 divided by 3 has remainder 2 and result 1, and 1 divided by 4 has remainder 1 and result 0. Thus, the key 11 produces the sequence of remainders [1,2,1] and has the fingerprint multiset {1,1,2}.Ksenia wants to prove that Karl\'s fingerprint algorithm is not very good. For example, she found that both keys 178800 and 123456 produce the fingerprint of {0,0,0,0,2,3,3,4}. Thus, users are at risk of fingerprint collision with some commonly used and easy to guess keys like 123456.Ksenia wants to make her words more persuasive. She wants to calculate the number of other keys that have the same fingerprint as the keys in the given list of some commonly used keys. Your task is to help her." combinatorics,math 2100
492E "Vanya and Field" "Vanya decided to walk in the field of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89n cells. The field contains m apple trees, the i-th apple tree is at the cell with coordinates (xi,\xe2\x80\x89yi). Vanya moves towards vector (dx,\xe2\x80\x89dy). That means that if Vanya is now at the cell (x,\xe2\x80\x89y), then in a second he will be at cell . The following condition is satisfied for the vector: , where  is the largest integer that divides both a and b. Vanya ends his path when he reaches the square he has already visited. Vanya wonders, from what square of the field he should start his path to see as many apple trees as possible." math 2000
1731F "Function Sum" "Suppose you have an integer array a1,a2,\xe2\x80\xa6,an.Let lsl(i) be the number of indices j (1\xe2\x89\xa4j<i) such that aj<ai.Analogically, let grr(i) be the number of indices j (i<j\xe2\x89\xa4n) such that aj>ai.Let\'s name position i good in the array a if lsl(i)<grr(i).Finally, let\'s define a function f on array a f(a) as the sum of all ai such that i is good in a.Given two integers n and k, find the sum of f(a) over all arrays a of size n such that 1\xe2\x89\xa4ai\xe2\x89\xa4k for all 1\xe2\x89\xa4i\xe2\x89\xa4n modulo 998244353." "brute force,combinatorics,dp,fft,math" 2500
85B "Embassy Queue" "In an embassy of a well-known kingdom an electronic queue is organised. Every person who comes to the embassy, needs to make the following three actions: show the ID, pay money to the cashier and be fingerprinted. Besides, the actions should be performed in the given order.For each action several separate windows are singled out: k1 separate windows for the first action (the first type windows), k2 windows for the second one (the second type windows), and k3 for the third one (the third type windows). The service time for one person in any of the first type window equals to t1. Similarly, it takes t2 time to serve a person in any of the second type windows. And it takes t3 to serve one person in any of the third type windows. Thus, the service time depends only on the window type and is independent from the person who is applying for visa.At some moment n people come to the embassy, the i-th person comes at the moment of time ci. The person is registered under some number. After that he sits in the hall and waits for his number to be shown on a special board. Besides the person\'s number the board shows the number of the window where one should go and the person goes there immediately. Let\'s consider that the time needed to approach the window is negligible. The table can show information for no more than one person at a time. The electronic queue works so as to immediately start working with the person who has approached the window, as there are no other people in front of the window.The Client Service Quality inspectors noticed that several people spend too much time in the embassy (this is particularly tiresome as the embassy has no mobile phone reception and 3G). It was decided to organise the system so that the largest time a person spends in the embassy were minimum. Help the inspectors organise the queue. Consider that all actions except for being served in at the window, happen instantly." "data structures,greedy" 1800
1059B Forgery "Student Andrey has been skipping physical education lessons for the whole term, and now he must somehow get a passing grade on this subject. Obviously, it is impossible to do this by legal means, but Andrey doesn\'t give up. Having obtained an empty certificate from a local hospital, he is going to use his knowledge of local doctor\'s handwriting to make a counterfeit certificate of illness. However, after writing most of the certificate, Andrey suddenly discovered that doctor\'s signature is impossible to forge. Or is it?For simplicity, the signature is represented as an n\xc3\x97m grid, where every cell is either filled with ink or empty. Andrey\'s pen can fill a 3\xc3\x973 square without its central cell if it is completely contained inside the grid, as shown below. xxxx.xxxx Determine whether is it possible to forge the signature on an empty n\xc3\x97m grid." implementation 1300
808A "Lucky Year" "Apart from having lots of holidays throughout the year, residents of Berland also have whole lucky years. Year is considered lucky if it has no more than 1 non-zero digit in its number. So years 100, 40000, 5 are lucky and 12, 3001 and 12345 are not.You are given current year in Berland. Your task is to find how long will residents of Berland wait till the next lucky year." implementation 900
1760D "Challenging Valleys" "You are given an array a[0\xe2\x80\xa6n\xe2\x88\x921] of n integers. This array is called a ""valley"" if there exists exactly one subarray a[l\xe2\x80\xa6r] such that:  0\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n\xe2\x88\x921,  al=al+1=al+2=\xe2\x8b\xaf=ar,  l=0 or al\xe2\x88\x921>al,  r=n\xe2\x88\x921 or ar<ar+1. Here are three examples:  The first image shows the array [3,2,2,1,2,2,3], it is a valley because only subarray with indices l=r=3 satisfies the condition.The second image shows the array [1,1,1,2,3,3,4,5,6,6,6], it is a valley because only subarray with indices l=0,r=2 satisfies the codition.The third image shows the array [1,2,3,4,3,2,1], it is not a valley because two subarrays l=r=0 and l=r=6 that satisfy the condition.You are asked whether the given array is a valley or not.Note that we consider the array to be indexed from 0." "implementation,two pointers" 1000
1036A "Function Height" "You are given a set of 2n+1 integer points on a Cartesian plane. Points are numbered from 0 to 2n inclusive. Let Pi be the i-th point. The x-coordinate of the point Pi equals i. The y-coordinate of the point Pi equals zero (initially). Thus, initially Pi=(i,0).The given points are vertices of a plot of a piecewise function. The j-th piece of the function is the segment PjPj+1.In one move you can increase the y-coordinate of any point with odd x-coordinate (i.e. such points are P1,P3,\xe2\x80\xa6,P2n\xe2\x88\x921) by 1. Note that the corresponding segments also change.For example, the following plot shows a function for n=3 (i.e. number of points is 2\xe2\x8b\x853+1=7) in which we increased the y-coordinate of the point P1 three times and y-coordinate of the point P5 one time:  Let the area of the plot be the area below this plot and above the coordinate axis OX. For example, the area of the plot on the picture above is 4 (the light blue area on the picture above is the area of the plot drawn on it).Let the height of the plot be the maximum y-coordinate among all initial points in the plot (i.e. points P0,P1,\xe2\x80\xa6,P2n). The height of the plot on the picture above is 3.Your problem is to say which minimum possible height can have the plot consisting of 2n+1 vertices and having an area equal to k. Note that it is unnecessary to minimize the number of moves.It is easy to see that any answer which can be obtained by performing moves described above always exists and is an integer number not exceeding 1018." math 1000
271C Secret "The Greatest Secret Ever consists of n words, indexed by positive integers from 1 to n. The secret needs dividing between k Keepers (let\'s index them by positive integers from 1 to k), the i-th Keeper gets a non-empty set of words with numbers from the set Ui\xe2\x80\x89=\xe2\x80\x89(ui,\xe2\x80\x891,\xe2\x80\x89ui,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89ui,\xe2\x80\x89|Ui|). Here and below we\'ll presuppose that the set elements are written in the increasing order.We\'ll say that the secret is safe if the following conditions are hold:  for any two indexes i,\xe2\x80\x89j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k) the intersection of sets Ui and Uj is an empty set;  the union of sets U1,\xe2\x80\x89U2,\xe2\x80\x89...,\xe2\x80\x89Uk is set (1,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89n);  in each set Ui, its elements ui,\xe2\x80\x891,\xe2\x80\x89ui,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89ui,\xe2\x80\x89|Ui| do not form an arithmetic progression (in particular, |Ui|\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x893 should hold). Let us remind you that the elements of set (u1,\xe2\x80\x89u2,\xe2\x80\x89...,\xe2\x80\x89us) form an arithmetic progression if there is such number d, that for all i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89s) fulfills ui\xe2\x80\x89+\xe2\x80\x89d\xe2\x80\x89=\xe2\x80\x89ui\xe2\x80\x89+\xe2\x80\x891. For example, the elements of sets (5), (1,\xe2\x80\x8910) and (1,\xe2\x80\x895,\xe2\x80\x899) form arithmetic progressions and the elements of sets (1,\xe2\x80\x892,\xe2\x80\x894) and (3,\xe2\x80\x896,\xe2\x80\x898) don\'t.Your task is to find any partition of the set of words into subsets U1,\xe2\x80\x89U2,\xe2\x80\x89...,\xe2\x80\x89Uk so that the secret is safe. Otherwise indicate that there\'s no such partition." "constructive algorithms,implementation" 1500
1141B "Maximal Continuous Rest" "Each day in Berland consists of n hours. Polycarp likes time management. That\'s why he has a fixed schedule for each day \xe2\x80\x94 it is a sequence a1,a2,\xe2\x80\xa6,an (each ai is either 0 or 1), where ai=0 if Polycarp works during the i-th hour of the day and ai=1 if Polycarp rests during the i-th hour of the day.Days go one after another endlessly and Polycarp uses the same schedule for each day.What is the maximal number of continuous hours during which Polycarp rests? It is guaranteed that there is at least one working hour in a day." implementation 900
1083A "The Fair Nut and the Best Path" "The Fair Nut is going to travel to the Tree Country, in which there are n cities. Most of the land of this country is covered by forest. Furthermore, the local road system forms a tree (connected graph without cycles). Nut wants to rent a car in the city u and go by a simple path to city v. He hasn\'t determined the path, so it\'s time to do it. Note that chosen path can consist of only one vertex.A filling station is located in every city. Because of strange law, Nut can buy only wi liters of gasoline in the i-th city. We can assume, that he has infinite money. Each road has a length, and as soon as Nut drives through this road, the amount of gasoline decreases by length. Of course, Nut can\'t choose a path, which consists of roads, where he runs out of gasoline. He can buy gasoline in every visited city, even in the first and the last.He also wants to find the maximum amount of gasoline that he can have at the end of the path. Help him: count it." "data structures,dp,trees" 1800
1555E "Boring Segments" "You are given n segments on a number line, numbered from 1 to n. The i-th segments covers all integer points from li to ri and has a value wi.You are asked to select a subset of these segments (possibly, all of them). Once the subset is selected, it\'s possible to travel between two integer points if there exists a selected segment that covers both of them. A subset is good if it\'s possible to reach point m starting from point 1 in arbitrary number of moves.The cost of the subset is the difference between the maximum and the minimum values of segments in it. Find the minimum cost of a good subset.In every test there exists at least one good subset." "data structures,sortings,trees,two pointers" 2100
231D "Magic Box" "One day Vasya was going home when he saw a box lying on the road. The box can be represented as a rectangular parallelepiped. Vasya needed no time to realize that the box is special, as all its edges are parallel to the coordinate axes, one of its vertices is at point (0,\xe2\x80\x890,\xe2\x80\x890), and the opposite one is at point (x1,\xe2\x80\x89y1,\xe2\x80\x89z1). The six faces of the box contain some numbers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89a6, exactly one number right in the center of each face.  The numbers are located on the box like that:   number a1 is written on the face that lies on the ZOX plane;  a2 is written on the face, parallel to the plane from the previous point;  a3 is written on the face that lies on the XOY plane;  a4 is written on the face, parallel to the plane from the previous point;  a5 is written on the face that lies on the YOZ plane;  a6 is written on the face, parallel to the plane from the previous point. At the moment Vasya is looking at the box from point (x,\xe2\x80\x89y,\xe2\x80\x89z). Find the sum of numbers that Vasya sees. Note that all faces of the box are not transparent and Vasya can\'t see the numbers through the box. The picture contains transparent faces just to make it easier to perceive. You can consider that if Vasya is looking from point, lying on the plane of some face, than he can not see the number that is written on this face. It is enough to see the center of a face to see the corresponding number for Vasya. Also note that Vasya always reads correctly the ai numbers that he sees, independently of their rotation, angle and other factors (that is, for example, if Vasya sees some ai\xe2\x80\x89=\xe2\x80\x896, then he can\'t mistake this number for 9 and so on)." "brute force,geometry" 1600
238C "World Eater Brothers" "You must have heard of the two brothers dreaming of ruling the world. With all their previous plans failed, this time they decided to cooperate with each other in order to rule the world. As you know there are n countries in the world. These countries are connected by n\xe2\x80\x89-\xe2\x80\x891 directed roads. If you don\'t consider direction of the roads there is a unique path between every pair of countries in the world, passing through each road at most once. Each of the brothers wants to establish his reign in some country, then it\'s possible for him to control the countries that can be reached from his country using directed roads. The brothers can rule the world if there exists at most two countries for brothers to choose (and establish their reign in these countries) so that any other country is under control of at least one of them. In order to make this possible they want to change the direction of minimum number of roads. Your task is to calculate this minimum number of roads." "dfs and similar,dp,greedy,trees" 2100
991A "If at first you don\'t succeed..." "Each student eagerly awaits the day he would pass the exams successfully. Thus, Vasya was ready to celebrate, but, alas, he didn\'t pass it. However, many of Vasya\'s fellow students from the same group were more successful and celebrated after the exam.Some of them celebrated in the BugDonalds restaurant, some of them \xe2\x80\x94 in the BeaverKing restaurant, the most successful ones were fast enough to celebrate in both of restaurants. Students which didn\'t pass the exam didn\'t celebrate in any of those restaurants and elected to stay home to prepare for their reexamination. However, this quickly bored Vasya and he started checking celebration photos on the Kilogramm. He found out that, in total, BugDonalds was visited by A students, BeaverKing \xe2\x80\x94 by B students and C students visited both restaurants. Vasya also knows that there are N students in his group.Based on this info, Vasya wants to determine either if his data contradicts itself or, if it doesn\'t, how many students in his group didn\'t pass the exam. Can you help him so he won\'t waste his valuable preparation time?" implementation 1000
1575J "Jeopardy of Dropped Balls" "Mr. Chanek has a new game called Dropping Balls. Initially, Mr. Chanek has a grid a of size n\xc3\x97mEach cell (x,y) contains an integer ax,y denoting the direction of how the ball will move.  ax,y=1 \xe2\x80\x94 the ball will move to the right (the next cell is (x,y+1));  ax,y=2 \xe2\x80\x94 the ball will move to the bottom (the next cell is (x+1,y));  ax,y=3 \xe2\x80\x94 the ball will move to the left (the next cell is (x,y\xe2\x88\x921)). Every time a ball leaves a cell (x,y), the integer ax,y will change to 2. Mr. Chanek will drop k balls sequentially, each starting from the first row, and on the c1,c2,\xe2\x80\xa6,ck-th (1\xe2\x89\xa4ci\xe2\x89\xa4m) columns.Determine in which column each ball will end up in (position of the ball after leaving the grid)." "binary search,brute force,dsu,implementation" 1500
979C "Kuro and Walking Route" "Kuro is living in a country called Uberland, consisting of n towns, numbered from 1 to n, and n\xe2\x88\x921 bidirectional roads connecting these towns. It is possible to reach each town from any other. Each road connects two towns a and b. Kuro loves walking and he is planning to take a walking marathon, in which he will choose a pair of towns (u,v) (u\xe2\x89\xa0v) and walk from u using the shortest path to v (note that (u,v) is considered to be different from (v,u)).Oddly, there are 2 special towns in Uberland named Flowrisa (denoted with the index x) and Beetopia (denoted with the index y). Flowrisa is a town where there are many strong-scent flowers, and Beetopia is another town where many bees live. In particular, Kuro will avoid any pair of towns (u,v) if on the path from u to v, he reaches Beetopia after he reached Flowrisa, since the bees will be attracted with the flower smell on Kuro\xe2\x80\x99s body and sting him.Kuro wants to know how many pair of city (u,v) he can take as his route. Since he\xe2\x80\x99s not really bright, he asked you to help him with this problem." "dfs and similar,trees" 1600
500C "New Year Book Reading" "New Year is coming, and Jaehyun decided to read many books during 2015, unlike this year. He has n books numbered by integers from 1 to n. The weight of the i-th (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) book is wi.As Jaehyun\'s house is not large enough to have a bookshelf, he keeps the n books by stacking them vertically. When he wants to read a certain book x, he follows the steps described below.  He lifts all the books above book x.  He pushes book x out of the stack.  He puts down the lifted books without changing their order.  After reading book x, he puts book x on the top of the stack.  He decided to read books for m days. In the j-th (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m) day, he will read the book that is numbered with integer bj (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89bj\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n). To read the book, he has to use the process described in the paragraph above. It is possible that he decides to re-read the same book several times.After making this plan, he realized that the total weight of books he should lift during m days would be too heavy. So, he decided to change the order of the stacked books before the New Year comes, and minimize the total weight. You may assume that books can be stacked in any possible order. Note that book that he is going to read on certain step isn\'t considered as lifted on that step. Can you help him?" "constructive algorithms,greedy,implementation,math" 1600
1638B "Odd Swap Sort" "You are given an array a1,a2,\xe2\x80\xa6,an. You can perform operations on the array. In each operation you can choose an integer i (1\xe2\x89\xa4i<n), and swap elements ai and ai+1 of the array, if ai+ai+1 is odd.Determine whether it can be sorted in non-decreasing order using this operation any number of times." "data structures,math,sortings" 1100
1346I "Pac-Man 2.0" "Polycarp is developing a new version of an old video game ""Pac-Man"". Though he really enjoyed playing the original game, he didn\'t like some aspects of it, so he decided to alter the rules a bit.In Polycarp\'s version, you play as Pac-Man and you have to collect pellets scattered over the game world while avoiding dangerous ghosts (no difference from the original yet). Polycarp didn\'t like the fact that there was no escape from the ghosts in the original, so, in his version, the game world is divided into n safe zones with m one-directional pathways between them \xe2\x80\x94 and it is guaranteed that Pac-Man can reach any safe zone from any other. Since safe zones are safe, the ghosts cannot attack Pac-Man while it is there, it is in danger only while traversing the pathways. Pac-Man starts the game in the safe zone s.All pellets are scattered over the safe zones; initially, the i-th safe zone contains ai pellets (and if Pac-Man is in a safe zone, it may freely collect all the pellets in it). The pellets disappear after being collected, but after the last pellet in the game world is collected, new pellets spawn in the safe zones in the same quantity as before (ai new pellets spawn in the i-th zone). The pellets can be respawned any number of times, so the game is essentially infinite.Polycarp has already determined the structure of the game world and the number of pellets in each safe zone. Now he is trying to find out if the game is difficult enough. There are q goals in the game, the i-th goal is to collect at least Ci pellets from the beginning of the game. Polycarp denotes the difficulty of the i-th goal as the minimum number of times the player has to traverse a one-directional pathway in order to collect Ci pellets (since only traversing a pathway puts Pac-Man in danger). If some pathway is traversed multiple times while Pac-Man is collecting the pellets, it is included in the answer the same number of times.Help Polycarp to calculate the difficulty of each goal!" "*special problem,dp" 2900
486C "Palindrome Transformation" "Nam is playing with a string on his computer. The string consists of n lowercase English letters. It is meaningless, so Nam decided to make the string more beautiful, that is to make it be a palindrome by using 4 arrow keys: left, right, up, down.There is a cursor pointing at some symbol of the string. Suppose that cursor is at position i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n, the string uses 1-based indexing) now. Left and right arrow keys are used to move cursor around the string. The string is cyclic, that means that when Nam presses left arrow key, the cursor will move to position i\xe2\x80\x89-\xe2\x80\x891 if i\xe2\x80\x89>\xe2\x80\x891 or to the end of the string (i. e. position n) otherwise. The same holds when he presses the right arrow key (if i\xe2\x80\x89=\xe2\x80\x89n, the cursor appears at the beginning of the string).When Nam presses up arrow key, the letter which the text cursor is pointing to will change to the next letter in English alphabet (assuming that alphabet is also cyclic, i. e. after \'z\' follows \'a\'). The same holds when he presses the down arrow key.Initially, the text cursor is at position p. Because Nam has a lot homework to do, he wants to complete this as fast as possible. Can you help him by calculating the minimum number of arrow keys presses to make the string to be a palindrome?" "brute force,greedy,implementation" 1700
138C "Mushroom Gnomes - 2" "One day Natalia was walking in the woods when she met a little mushroom gnome. The gnome told her the following story:Everybody knows that the mushroom gnomes\' power lies in the magic mushrooms that grow in the native woods of the gnomes. There are n trees and m magic mushrooms in the woods: the i-th tree grows at a point on a straight line with coordinates ai and has the height of hi, the j-th mushroom grows at the point with coordinates bj and has magical powers zj.But one day wild mushroommunchers, the sworn enemies of mushroom gnomes unleashed a terrible storm on their home forest. As a result, some of the trees began to fall and crush the magic mushrooms. The supreme oracle of mushroom gnomes calculated in advance the probability for each tree that it will fall to the left, to the right or will stand on. If the tree with the coordinate x and height h falls to the left, then all the mushrooms that belong to the right-open interval [x\xe2\x80\x89-\xe2\x80\x89h,\xe2\x80\x89x), are destroyed. If a tree falls to the right, then the mushrooms that belong to the left-open interval (x,\xe2\x80\x89x\xe2\x80\x89+\xe2\x80\x89h] are destroyed. Only those mushrooms that are not hit by a single tree survive.Knowing that all the trees fall independently of each other (i.e., all the events are mutually independent, and besides, the trees do not interfere with other trees falling in an arbitrary direction), the supreme oracle was also able to quickly calculate what would be the expectation of the total power of the mushrooms which survived after the storm. His calculations ultimately saved the mushroom gnomes from imminent death.Natalia, as a good Olympiad programmer, got interested in this story, and she decided to come up with a way to quickly calculate the expectation of the sum of the surviving mushrooms\' power." "binary search,data structures,probabilities,sortings" 2200
1543D2 "RPD and Rap Sheet (Hard Version)" "This is the hard version of the problem. The only difference is that here 2\xe2\x89\xa4k\xe2\x89\xa4100. You can make hacks only if both the versions of the problem are solved.This is an interactive problem!Every decimal number has a base k equivalent. The individual digits of a base k number are called k-its. Let\'s define the k-itwise XOR of two k-its a and b as (a+b)modk.The k-itwise XOR of two base k numbers is equal to the new number formed by taking the k-itwise XOR of their corresponding k-its. The k-itwise XOR of two decimal numbers a and b is denoted by a\xe2\x8a\x95kb and is equal to the decimal representation of the k-itwise XOR of the base k representations of a and b. All further numbers used in the statement below are in decimal unless specified.You have hacked the criminal database of Rockport Police Department (RPD), also known as the Rap Sheet. But in order to access it, you require a password. You don\'t know it, but you are quite sure that it lies between 0 and n\xe2\x88\x921 inclusive. So, you have decided to guess it. Luckily, you can try at most n times without being blocked by the system. But the system is adaptive. Each time you make an incorrect guess, it changes the password. Specifically, if the password before the guess was x, and you guess a different number y, then the system changes the password to a number z such that x\xe2\x8a\x95kz=y. Guess the password and break into the system." "brute force,constructive algorithms,interactive,math" 2200
38G Queue "On a cold winter evening our hero Vasya stood in a railway queue to buy a ticket for Codeforces championship final. As it usually happens, the cashier said he was going to be away for 5 minutes and left for an hour. Then Vasya, not to get bored, started to analyze such a mechanism as a queue. The findings astonished Vasya.Every man is characterized by two numbers: ai, which is the importance of his current task (the greater the number is, the more important the task is) and number ci, which is a picture of his conscience. Numbers ai form the permutation of numbers from 1 to n.Let the queue consist of n\xe2\x80\x89-\xe2\x80\x891 people at the moment. Let\'s look at the way the person who came number n behaves. First, he stands at the end of the queue and the does the following: if importance of the task ai of the man in front of him is less than an, they swap their places (it looks like this: the man number n asks the one before him: ""Erm... Excuse me please but it\'s very important for me... could you please let me move up the queue?""), then he again poses the question to the man in front of him and so on. But in case when ai is greater than an, moving up the queue stops. However, the man number n can perform the operation no more than cn times.In our task let us suppose that by the moment when the man number n joins the queue, the process of swaps between n\xe2\x80\x89-\xe2\x80\x891 will have stopped. If the swap is possible it necessarily takes place.Your task is to help Vasya model the described process and find the order in which the people will stand in queue when all the swaps stops." "data structures" 2300
362A "Two Semiknights Meet" "A boy Petya loves chess very much. He even came up with a chess piece of his own, a semiknight. The semiknight can move in any of these four directions: 2 squares forward and 2 squares to the right, 2 squares forward and 2 squares to the left, 2 squares backward and 2 to the right and 2 squares backward and 2 to the left. Naturally, the semiknight cannot move beyond the limits of the chessboard.Petya put two semiknights on a standard chessboard. Petya simultaneously moves with both semiknights. The squares are rather large, so after some move the semiknights can meet, that is, they can end up in the same square. After the meeting the semiknights can move on, so it is possible that they meet again. Petya wonders if there is such sequence of moves when the semiknights meet. Petya considers some squares bad. That is, they do not suit for the meeting. The semiknights can move through these squares but their meetings in these squares don\'t count.Petya prepared multiple chess boards. Help Petya find out whether the semiknights can meet on some good square for each board.Please see the test case analysis." greedy,math 1500
1648A "Weird Sum" "Egor has a table of size n\xc3\x97m, with lines numbered from 1 to n and columns numbered from 1 to m. Each cell has a color that can be presented as an integer from 1 to 105.Let us denote the cell that lies in the intersection of the r-th row and the c-th column as (r,c). We define the manhattan distance between two cells (r1,c1) and (r2,c2) as the length of a shortest path between them where each consecutive cells in the path must have a common side. The path can go through cells of any color. For example, in the table 3\xc3\x974 the manhattan distance between (1,2) and (3,3) is 3, one of the shortest paths is the following: (1,2)\xe2\x86\x92(2,2)\xe2\x86\x92(2,3)\xe2\x86\x92(3,3). Egor decided to calculate the sum of manhattan distances between each pair of cells of the same color. Help him to calculate this sum." "combinatorics,data structures,geometry,math,matrices,sortings" 1400
1825A "LuoTianyi and the Palindrome String" "LuoTianyi gives you a palindrome\xe2\x80\xa0 string s, and she wants you to find out the length of the longest non-empty subsequence\xe2\x80\xa1 of s which is not a palindrome string. If there is no such subsequence, output \xe2\x88\x921 instead.\xe2\x80\xa0 A palindrome is a string that reads the same backward as forward. For example, strings ""z"", ""aaa"", ""aba"", ""abccba"" are palindromes, but strings ""codeforces"", ""reality"", ""ab"" are not.\xe2\x80\xa1 A string a is a subsequence of a string b if a can be obtained from b by deletion of several (possibly, zero or all) characters from b. For example, strings ""a"", ""aaa"", ""bab"" are subsequences of string ""abaab"", but strings ""codeforces"", ""bbb"", ""h"" are not." greedy,strings 800
724A "Checking the Calendar" "You are given names of two days of the week.Please, determine whether it is possible that during some non-leap year the first day of some month was equal to the first day of the week you are given, while the first day of the next month was equal to the second day of the week you are given. Both months should belong to one year.In this problem, we consider the Gregorian calendar to be used. The number of months in this calendar is equal to 12. The number of days in months during any non-leap year is: 31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31.Names of the days of the week are given with lowercase English letters: ""monday"", ""tuesday"", ""wednesday"", ""thursday"", ""friday"", ""saturday"", ""sunday""." implementation 1000
1904D1 "Set To Max (Easy Version)" "This is the easy version of the problem. The only differences between the two versions of this problem are the constraints on n and the time limit. You can make hacks only if all versions of the problem are solved.You are given two arrays a and b of length n.You can perform the following operation some (possibly zero) times:   choose l and r such that 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n.  let x=max(al,al+1,\xe2\x80\xa6,ar).  for all l\xe2\x89\xa4i\xe2\x89\xa4r, set ai:=x. Determine if you can make array a equal to array b." "brute force,constructive algorithms,greedy" 1600
1695D2 "Tree Queries (Hard Version)" "The only difference between this problem and D1 is the bound on the size of the tree.You are given an unrooted tree with n vertices. There is some hidden vertex x in that tree that you are trying to find.To do this, you may ask k queries v1,v2,\xe2\x80\xa6,vk where the vi are vertices in the tree. After you are finished asking all of the queries, you are given k numbers d1,d2,\xe2\x80\xa6,dk, where di is the number of edges on the shortest path between vi and x. Note that you know which distance corresponds to which query.What is the minimum k such that there exists some queries v1,v2,\xe2\x80\xa6,vk that let you always uniquely identify x (no matter what x is).Note that you don\'t actually need to output these queries." "constructive algorithms,dfs and similar,dp,greedy,trees" 2300
1906M "Triangle Construction" "You are given a regular N-sided polygon. Label one arbitrary side as side 1, then label the next sides in clockwise order as side 2, 3, \xe2\x80\xa6, N. There are Ai special points on side i. These points are positioned such that side i is divided into Ai+1 segments with equal length.For instance, suppose that you have a regular 4-sided polygon, i.e., a square. The following illustration shows how the special points are located within each side when A=[3,1,4,6]. The uppermost side is labelled as side 1.  You want to create as many non-degenerate triangles as possible while satisfying the following requirements. Each triangle consists of 3 distinct special points (not necessarily from different sides) as its corners. Each special point can only become the corner of at most 1 triangle. All triangles must not intersect with each other.Determine the maximum number of non-degenerate triangles that you can create.A triangle is non-degenerate if it has a positive area." greedy,math 1700
1600J "Robot Factory" "You have received data from a Bubble bot. You know your task is to make factory facilities, but before you even start, you need to know how big the factory is and how many rooms it has. When you look at the data you see that you have the dimensions of the construction, which is in rectangle shape: N x M. Then in the next N lines you have M numbers. These numbers represent factory tiles and they can go from 0 to 15. Each of these numbers should be looked in its binary form. Because from each number you know on which side the tile has walls. For example number 10 in it\'s binary form is 1010, which means that it has a wall from the North side, it doesn\'t have a wall from the East, it has a wall on the South side and it doesn\'t have a wall on the West side. So it goes North, East, South, West. It is guaranteed that the construction always has walls on it\'s edges. The input will be correct. Your task is to print the size of the rooms from biggest to smallest." "bitmasks,dfs and similar" 1400
1380D "Berserk And Fireball" "There are n warriors in a row. The power of the i-th warrior is ai. All powers are pairwise distinct.You have two types of spells which you may cast:   Fireball: you spend x mana and destroy exactly k consecutive warriors;  Berserk: you spend y mana, choose two consecutive warriors, and the warrior with greater power destroys the warrior with smaller power. For example, let the powers of warriors be [2,3,7,8,11,5,4], and k=3. If you cast Berserk on warriors with powers 8 and 11, the resulting sequence of powers becomes [2,3,7,11,5,4]. Then, for example, if you cast Fireball on consecutive warriors with powers [7,11,5], the resulting sequence of powers becomes [2,3,4].You want to turn the current sequence of warriors powers a1,a2,\xe2\x80\xa6,an into b1,b2,\xe2\x80\xa6,bm. Calculate the minimum amount of mana you need to spend on it." "constructive algorithms,greedy,implementation,math,two pointers" 2000
802A "Heidi and Library (easy)" "Your search for Heidi is over \xe2\x80\x93 you finally found her at a library, dressed up as a human. In fact, she has spent so much time there that she now runs the place! Her job is to buy books and keep them at the library so that people can borrow and read them. There are n different books, numbered 1 through n.We will look at the library\'s operation during n consecutive days. Heidi knows in advance that on the i-th day (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) precisely one person will come to the library, request to borrow the book ai, read it in a few hours, and return the book later on the same day.Heidi desperately wants to please all her guests, so she will make sure to always have the book ai available in the library on the i-th day. During the night before the i-th day, she has the option of going to the bookstore (which operates at nights to avoid competition with the library) and buying any book for the price of 1 CHF. Of course, if she already has a book at the library, she does not need to buy it again. Initially, the library contains no books.There is a problem, though. The capacity of the library is k \xe2\x80\x93 this means that at any time, there can be at most k books at the library. If buying a new book would cause Heidi to have more than k books, she must first get rid of some book that she already has, in order to make room for the new book. If she later needs a book that she got rid of, she will need to buy that book again.You are given k and the sequence of requests for books a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. What is the minimum cost (in CHF) of buying new books to satisfy all the requests?" greedy 1800
1815A "Ian and Array Sorting" "To thank Ian, Mary gifted an array a of length n to Ian. To make himself look smart, he wants to make the array in non-decreasing order by doing the following finitely many times: he chooses two adjacent elements ai and ai+1 (1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921), and increases both of them by 1 or decreases both of them by 1. Note that, the elements of the array can become negative.As a smart person, you notice that, there are some arrays such that Ian cannot make it become non-decreasing order! Therefore, you decide to write a program to determine if it is possible to make the array in non-decreasing order." greedy,math 1300
1586I "Omkar and Mosaic" "Omkar is creating a mosaic using colored square tiles, which he places in an n\xc3\x97n grid. When the mosaic is complete, each cell in the grid will have either a glaucous or sinoper tile. However, currently he has only placed tiles in some cells. A completed mosaic will be a mastapeece if and only if each tile is adjacent to exactly 2 tiles of the same color (2 tiles are adjacent if they share a side.) Omkar wants to fill the rest of the tiles so that the mosaic becomes a mastapeece. Now he is wondering, is the way to do this unique, and if it is, what is it?" "combinatorics,constructive algorithms,math" 3500
100J "Interval Coloring" "Aryo has got a lot of intervals for his 2418th birthday. He is really excited and decided to color all these intervals with some colors. He has a simple rule for himself. He calls a coloring nice if there exists no three intervals a,\xe2\x80\x89b and c such that the following conditions are satisfied simultaneously:   a,\xe2\x80\x89b and c are colored with the same color,  ,  ,  . Moreover he found out that for every intervals i and j, there is at least one point in i which isn\'t in j.Given some set of intervals. You have to find the minimum number k, such that Aryo can find a nice coloring with k colors." "*special problem,greedy,math" 2400
1530H "Turing\'s Award" "Alan Turing is standing on a tape divided into cells that is infinite in both directions.Cells are numbered with consecutive integers from left to right. Alan is initially standing in cell 0. Every cell x has cell x\xe2\x88\x921 on the left and cell x+1 on the right.Each cell can either contain an integer or be empty. Initially all cells are empty.Alan is given a permutation a1,a2,\xe2\x80\xa6,an of integers from 1 to n that was chosen uniformly at random among all permutations of length n.At time 1, integer a1 is written down into cell 0 where Alan is located.At each time i from 2 to n inclusive, the following happens. First, Alan decides whether to stay in the same cell he\'s currently in, move to the neighboring cell on the left, or move to the neighboring cell on the right. After that, integer ai is written down into the cell where Alan is located. If that cell already contained some integer, the old integer is overwritten and irrelevant from that moment on.Once an is written down into some cell at time n, sequence b of all integers contained in the cells from left to right is formed. Empty cells are ignored.Turing\'s award is equal to the length of the longest increasing subsequence of sequence b.Help Alan and determine the largest possible value of his award if he acts optimally." "data structures,dp" 3400
1927D "Find the Different Ones!" "You are given an array a of n integers, and q queries.Each query is represented by two integers l and r (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n). Your task is to find, for each query, two indices i and j (or determine that they do not exist) such that:  l\xe2\x89\xa4i\xe2\x89\xa4r;  l\xe2\x89\xa4j\xe2\x89\xa4r;  ai\xe2\x89\xa0aj. In other words, for each query, you need to find a pair of different elements among al,al+1,\xe2\x80\xa6,ar, or report that such a pair does not exist." "binary search,brute force,data structures,dp,dsu,greedy,two pointers" 1300
1406D "Three Sequences" "You are given a sequence of n integers a1,a2,\xe2\x80\xa6,an.You have to construct two sequences of integers b and c with length n that satisfy:  for every i (1\xe2\x89\xa4i\xe2\x89\xa4n) bi+ci=ai  b is non-decreasing, which means that for every 1<i\xe2\x89\xa4n, bi\xe2\x89\xa5bi\xe2\x88\x921 must hold  c is non-increasing, which means that for every 1<i\xe2\x89\xa4n, ci\xe2\x89\xa4ci\xe2\x88\x921 must hold You have to minimize max(bi,ci). In other words, you have to minimize the maximum number in sequences b and c.Also there will be q changes, the i-th change is described by three integers l,r,x. You should add x to al,al+1,\xe2\x80\xa6,ar. You have to find the minimum possible value of max(bi,ci) for the initial sequence and for sequence after each change." "constructive algorithms,data structures,greedy,math" 2200
177G1 "Fibonacci Strings" "Fibonacci strings are defined as follows:   f1 = \xc2\xaba\xc2\xbb  f2 = \xc2\xabb\xc2\xbb  fn = fn\xe2\x80\x89-\xe2\x80\x891 fn\xe2\x80\x89-\xe2\x80\x892, n\xe2\x80\x89>\xe2\x80\x892 Thus, the first five Fibonacci strings are: ""a"", ""b"", ""ba"", ""bab"", ""babba"".You are given a Fibonacci string and m strings si. For each string si, find the number of times it occurs in the given Fibonacci string as a substring." strings 2400
1743G "Antifibonacci Cut" "Note that the memory limit is unusual.Let\'s define the sequence of Fibonacci strings as follows: f0 is 0, f1 is 1, fi is fi\xe2\x88\x921+fi\xe2\x88\x922 for i>1 (+ denotes the concatenation of two strings). So, for example, f2 is 10, f3 is 101, f4 is 10110.For a given string s, let\'s define g(s) as the number of ways to cut it into several (any number, possibly even just one) strings such that none of these strings are Fibonacci strings. For example, if s is 10110101, g(s)=3 since there are three ways to cut it:  101101 + 01;  1011 + 0101;  1011 + 01 + 01. You are given a sequence of strings s1,s2,\xe2\x80\xa6,sn. Calculate g(s1),g(s1+s2),\xe2\x80\xa6,g(s1+s2+\xe2\x80\xa6+sn). Since these values can be huge, print them modulo 998244353." "bitmasks,combinatorics,constructive algorithms,data structures,dp,hashing,math" 3000
1454E "Number of Simple Paths" "You are given an undirected graph consisting of n vertices and n edges. It is guaranteed that the given graph is connected (i. e. it is possible to reach any vertex from any other vertex) and there are no self-loops and multiple edges in the graph.Your task is to calculate the number of simple paths of length at least 1 in the given graph. Note that paths that differ only by their direction are considered the same (i. e. you have to calculate the number of undirected paths). For example, paths [1,2,3] and [3,2,1] are considered the same.You have to answer t independent test cases.Recall that a path in the graph is a sequence of vertices v1,v2,\xe2\x80\xa6,vk such that each pair of adjacent (consecutive) vertices in this sequence is connected by an edge. The length of the path is the number of edges in it. A simple path is such a path that all vertices in it are distinct." "combinatorics,dfs and similar,graphs,trees" 2000
1942C2 "Bessie\'s Birthday Cake (Hard Version)" "Proof Geometric Construction Can Solve All Love Affairs - manbo-p\xe2\xa0\x80This is the hard version of the problem. The only difference between the two versions is the constraint on y. In this version 0\xe2\x89\xa4y\xe2\x89\xa4n\xe2\x88\x92x. You can make hacks only if both versions are solved.Bessie has received a birthday cake from her best friend Elsie, and it came in the form of a regular polygon with n sides. The vertices of the cake are numbered from 1 to n clockwise. You and Bessie are going to choose some of those vertices to cut non-intersecting diagonals into the cake. In other words, the endpoints of the diagonals must be part of the chosen vertices.Bessie would only like to give out pieces of cake which result in a triangle to keep consistency. The size of the pieces doesn\'t matter, and the whole cake does not have to be separated into all triangles (other shapes are allowed in the cake, but those will not be counted). Bessie has already chosen x of those vertices that can be used to form diagonals. She wants you to choose no more than y other vertices such that the number of triangular pieces of cake she can give out is maximized.What is the maximum number of triangular pieces of cake Bessie can give out?" geometry,greedy,math 1700
234F Fence "Vasya should paint a fence in front of his own cottage. The fence is a sequence of n wooden boards arranged in a single row. Each board is a 1 centimeter wide rectangle. Let\'s number the board fence using numbers 1,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89n from left to right. The height of the i-th board is hi centimeters.Vasya has a 1 centimeter wide brush and the paint of two colors, red and green. Of course, the amount of the paint is limited. Vasya counted the area he can paint each of the colors. It turned out that he can not paint over a square centimeters of the fence red, and he can not paint over b square centimeters green. Each board of the fence should be painted exactly one of the two colors. Perhaps Vasya won\'t need one of the colors.In addition, Vasya wants his fence to look smart. To do this, he should paint the fence so as to minimize the value that Vasya called the fence unattractiveness value. Vasya believes that two consecutive fence boards, painted different colors, look unattractive. The unattractiveness value of a fence is the total length of contact between the neighboring boards of various colors. To make the fence look nice, you need to minimize the value as low as possible. Your task is to find what is the minimum unattractiveness Vasya can get, if he paints his fence completely.  The picture shows the fence, where the heights of boards (from left to right) are 2,3,2,4,3,1. The first and the fifth boards are painted red, the others are painted green. The first and the second boards have contact length 2, the fourth and fifth boards have contact length 3, the fifth and the sixth have contact length 1. Therefore, the unattractiveness of the given painted fence is 2+3+1=6." dp 1800
864E Fire "Polycarp is in really serious trouble \xe2\x80\x94 his house is on fire! It\'s time to save the most valuable items. Polycarp estimated that it would take ti seconds to save i-th item. In addition, for each item, he estimated the value of di \xe2\x80\x94 the moment after which the item i will be completely burned and will no longer be valuable for him at all. In particular, if ti\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89di, then i-th item cannot be saved.Given the values pi for each of the items, find a set of items that Polycarp can save such that the total value of this items is maximum possible. Polycarp saves the items one after another. For example, if he takes item a first, and then item b, then the item a will be saved in ta seconds, and the item b \xe2\x80\x94 in ta\xe2\x80\x89+\xe2\x80\x89tb seconds after fire started." dp,sortings 2000
6B "President\'s Office" "President of Berland has a very vast office-room, where, apart from him, work his subordinates. Each subordinate, as well as President himself, has his own desk of a unique colour. Each desk is rectangular, and its sides are parallel to the office walls. One day President decided to establish an assembly, of which all his deputies will be members. Unfortunately, he does not remember the exact amount of his deputies, but he remembers that the desk of each his deputy is adjacent to his own desk, that is to say, the two desks (President\'s and each deputy\'s) have a common side of a positive length.The office-room plan can be viewed as a matrix with n rows and m columns. Each cell of this matrix is either empty, or contains a part of a desk. An uppercase Latin letter stands for each desk colour. The \xc2\xabperiod\xc2\xbb character (\xc2\xab.\xc2\xbb) stands for an empty cell." implementation 1100
465B "Inbox (100500)" "Over time, Alexey\'s mail box got littered with too many letters. Some of them are read, while others are unread.Alexey\'s mail program can either show a list of all letters or show the content of a single letter. As soon as the program shows the content of an unread letter, it becomes read letter (if the program shows the content of a read letter nothing happens). In one click he can do any of the following operations: Move from the list of letters to the content of any single letter. Return to the list of letters from single letter viewing mode. In single letter viewing mode, move to the next or to the previous letter in the list. You cannot move from the first letter to the previous one or from the last letter to the next one.The program cannot delete the letters from the list or rearrange them.Alexey wants to read all the unread letters and go watch football. Now he is viewing the list of all letters and for each letter he can see if it is read or unread. What minimum number of operations does Alexey need to perform to read all unread letters?" implementation 1000
1237A "Balanced Rating Changes" "Another Codeforces Round has just finished! It has gathered n participants, and according to the results, the expected rating change of participant i is ai. These rating changes are perfectly balanced \xe2\x80\x94 their sum is equal to 0.Unfortunately, due to minor technical glitches, the round is declared semi-rated. It means that all rating changes must be divided by two.There are two conditions though:   For each participant i, their modified rating change bi must be integer, and as close to ai2 as possible. It means that either bi=\xe2\x8c\x8aai2\xe2\x8c\x8b or bi=\xe2\x8c\x88ai2\xe2\x8c\x89. In particular, if ai is even, bi=ai2. Here \xe2\x8c\x8ax\xe2\x8c\x8b denotes rounding down to the largest integer not greater than x, and \xe2\x8c\x88x\xe2\x8c\x89 denotes rounding up to the smallest integer not smaller than x.  The modified rating changes must be perfectly balanced \xe2\x80\x94 their sum must be equal to 0. Can you help with that?" implementation,math 1000
1579B "Shifting Sort" "The new generation external memory contains an array of integers a[1\xe2\x80\xa6n]=[a1,a2,\xe2\x80\xa6,an].This type of memory does not support changing the value of an arbitrary element. Instead, it allows you to cut out any segment of the given array, cyclically shift (rotate) it by any offset and insert it back into the same place.Technically, each cyclic shift consists of two consecutive actions:   You may select arbitrary indices l and r (1\xe2\x89\xa4l<r\xe2\x89\xa4n) as the boundaries of the segment.  Then you replace the segment a[l\xe2\x80\xa6r] with it\'s cyclic shift to the left by an arbitrary offset d. The concept of a cyclic shift can be also explained by following relations: the sequence [1,4,1,3] is a cyclic shift of the sequence [3,1,4,1] to the left by the offset 1 and the sequence [4,1,3,1] is a cyclic shift of the sequence [3,1,4,1] to the left by the offset 2. For example, if a=[1,3,2,8,5], then choosing l=2, r=4 and d=2 yields a segment a[2\xe2\x80\xa64]=[3,2,8]. This segment is then shifted by the offset d=2 to the left, and you get a segment [8,3,2] which then takes the place of of the original elements of the segment. In the end you get a=[1,8,3,2,5].Sort the given array a using no more than n cyclic shifts of any of its segments. Note that you don\'t need to minimize the number of cyclic shifts. Any method that requires n or less cyclic shifts will be accepted." implementation,sortings 1100
340E "Iahub and Permutations" "Iahub is so happy about inventing bubble sort graphs that he\'s staying all day long at the office and writing permutations. Iahubina is angry that she is no more important for Iahub. When Iahub goes away, Iahubina comes to his office and sabotage his research work.The girl finds an important permutation for the research. The permutation contains n distinct integers a1, a2, ..., an (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ai\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n). She replaces some of permutation elements with -1 value as a revenge. When Iahub finds out his important permutation is broken, he tries to recover it. The only thing he remembers about the permutation is it didn\'t have any fixed point. A fixed point for a permutation is an element ak which has value equal to k (ak\xe2\x80\x89=\xe2\x80\x89k). Your job is to proof to Iahub that trying to recover it is not a good idea. Output the number of permutations which could be originally Iahub\'s important permutation, modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." combinatorics,math 2000
1677F "Tokitsukaze and Gems" "Tokitsukaze has a sequence with length of n. She likes gems very much. There are n kinds of gems. The gems of the i-th kind are on the i-th position, and there are ai gems of the same kind on that position. Define G(l,r) as the multiset containing all gems on the segment [l,r] (inclusive).A multiset of gems can be represented as S=[s1,s2,\xe2\x80\xa6,sn], which is a non-negative integer sequence of length n and means that S contains si gems of the i-th kind in the multiset. A multiset T=[t1,t2,\xe2\x80\xa6,tn] is a multisubset of S=[s1,s2,\xe2\x80\xa6,sn] if and only if ti\xe2\x89\xa4si for any i satisfying 1\xe2\x89\xa4i\xe2\x89\xa4n.Now, given two positive integers k and p, you need to calculate the result ofn\xe2\x88\x91l=1n\xe2\x88\x91r=l\xe2\x88\x91[t1,t2,\xe2\x8b\xaf,tn]\xe2\x8a\x86G(l,r)((n\xe2\x88\x91i=1ptitki)(n\xe2\x88\x91i=1[ti>0])),where [ti>0]=1 if ti>0 and [ti>0]=0 if ti=0.Since the answer can be quite large, print it modulo 998244353." dp,math 3500
1585C "Minimize Distance" "A total of n depots are located on a number line. Depot i lies at the point xi for 1\xe2\x89\xa4i\xe2\x89\xa4n.You are a salesman with n bags of goods, attempting to deliver one bag to each of the n depots. You and the n bags are initially at the origin 0. You can carry up to k bags at a time. You must collect the required number of goods from the origin, deliver them to the respective depots, and then return to the origin to collect your next batch of goods.Calculate the minimum distance you need to cover to deliver all the bags of goods to the depots. You do not have to return to the origin after you have delivered all the bags." greedy 1300
552E "Vanya and Brackets" "Vanya is doing his maths homework. He has an expression of form , where x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xn are digits from 1 to 9, and sign  represents either a plus \'+\' or the multiplication sign \'*\'. Vanya needs to add one pair of brackets in this expression so that to maximize the value of the resulting expression." "brute force,dp,expression parsing,greedy,implementation,strings" 2100
258D "Little Elephant and Broken Sorting" "The Little Elephant loves permutations of integers from 1 to n very much. But most of all he loves sorting them. To sort a permutation, the Little Elephant repeatedly swaps some elements. As a result, he must receive a permutation 1,\xe2\x80\x892,\xe2\x80\x893,\xe2\x80\x89...,\xe2\x80\x89n.This time the Little Elephant has permutation p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pn. Its sorting program needs to make exactly m moves, during the i-th move it swaps elements that are at that moment located at the ai-th and the bi-th positions. But the Little Elephant\'s sorting program happened to break down and now on every step it can equiprobably either do nothing or swap the required elements.Now the Little Elephant doesn\'t even hope that the program will sort the permutation, but he still wonders: if he runs the program and gets some permutation, how much will the result of sorting resemble the sorted one? For that help the Little Elephant find the mathematical expectation of the number of permutation inversions after all moves of the program are completed.We\'ll call a pair of integers i,\xe2\x80\x89j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) an inversion in permutatuon p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pn, if the following inequality holds: pi\xe2\x80\x89>\xe2\x80\x89pj." dp,math,probabilities 2600
1019B "The hat" "This is an interactive problem.Imur Ishakov decided to organize a club for people who love to play the famous game \xc2\xabThe hat\xc2\xbb. The club was visited by n students, where n is even. Imur arranged them all in a circle and held a draw to break the students in pairs, but something went wrong. The participants are numbered so that participant i and participant i\xe2\x80\x89+\xe2\x80\x891 (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x891) are adjacent, as well as participant n and participant 1. Each student was given a piece of paper with a number in such a way, that for every two adjacent students, these numbers differ exactly by one. The plan was to form students with the same numbers in a pair, but it turned out that not all numbers appeared exactly twice.As you know, the most convenient is to explain the words to the partner when he is sitting exactly across you. Students with numbers i and  sit across each other. Imur is wondering if there are two people sitting across each other with the same numbers given. Help him to find such pair of people if it exists.You can ask questions of form \xc2\xabwhich number was received by student i?\xc2\xbb, and the goal is to determine whether the desired pair exists in no more than 60 questions." "binary search,interactive" 2000
1368G "Shifting Dominoes" "Bill likes to play with dominoes. He took an n\xc3\x97m board divided into equal square cells, and covered it with dominoes. Each domino covers two adjacent cells of the board either horizontally or vertically, and each cell is covered exactly once with a half of one domino (that is, there are no uncovered cells, and no two dominoes cover the same cell twice).After that Bill decided to play with the covered board and share some photos of it on social media. First, he removes exactly one domino from the board, freeing two of the cells. Next, he moves dominoes around. A domino can only be moved along the line parallel to its longer side. A move in the chosen direction is possible if the next cell in this direction is currently free. Bill doesn\'t want to lose track of what the original tiling looks like, so he makes sure that at any point each domino shares at least one cell with its original position.After removing a domino and making several (possibly, zero) moves Bill takes a photo of the board and posts it. However, with the amount of filters Bill is using, domino borders are not visible, so only the two free cells of the board can be identified. When the photo is posted, Bill reverts the board to its original state and starts the process again.Bill wants to post as many photos as possible, but he will not post any photo twice. How many distinct photos can he take? Recall that photos are different if the pairs of free cells in the photos are different." "data structures,geometry,graphs,trees" 3200
1264E "Beautiful League" "A football league has recently begun in Beautiful land. There are n teams participating in the league. Let\'s enumerate them with integers from 1 to n.There will be played exactly n(n\xe2\x88\x921)2 matches: each team will play against all other teams exactly once. In each match, there is always a winner and loser and there is no draw.After all matches are played, the organizers will count the number of beautiful triples. Let\'s call a triple of three teams (A,B,C) beautiful if a team A win against a team B, a team B win against a team C and a team C win against a team A. We look only to a triples of different teams and the order of teams in the triple is important.The beauty of the league is the number of beautiful triples.At the moment, m matches were played and their results are known.What is the maximum beauty of the league that can be, after playing all remaining matches? Also find a possible results for all remaining n(n\xe2\x88\x921)2\xe2\x88\x92m matches, so that the league has this maximum beauty." "constructive algorithms,flows,graph matchings" 2700
107C Arrangement "In the year 2500 the annual graduation ceremony in the German University in Cairo (GUC) has run smoothly for almost 500 years so far.The most important part of the ceremony is related to the arrangement of the professors in the ceremonial hall.Traditionally GUC has n professors. Each professor has his seniority level. All seniorities are different. Let\'s enumerate the professors from 1 to n, with 1 being the most senior professor and n being the most junior professor.The ceremonial hall has n seats, one seat for each professor. Some places in this hall are meant for more senior professors than the others. More specifically, m pairs of seats are in ""senior-junior"" relation, and the tradition requires that for all m pairs of seats (ai,\xe2\x80\x89bi) the professor seated in ""senior"" position ai should be more senior than the professor seated in ""junior"" position bi.GUC is very strict about its traditions, which have been carefully observed starting from year 2001. The tradition requires that:   The seating of the professors changes every year.  Year 2001 ceremony was using lexicographically first arrangement of professors in the ceremonial hall.  Each consecutive year lexicographically next arrangement of the professors is used. The arrangement of the professors is the list of n integers, where the first integer is the seniority of the professor seated in position number one, the second integer is the seniority of the professor seated in position number two, etc.Given n, the number of professors, y, the current year and m pairs of restrictions, output the arrangement of the professors for this year." bitmasks,dp 2400
585D "Lizard Era: Beginning" "In the game Lizard Era: Beginning the protagonist will travel with three companions: Lynn, Meliana and Worrigan. Overall the game has n mandatory quests. To perform each of them, you need to take exactly two companions.The attitude of each of the companions to the hero is an integer. Initially, the attitude of each of them to the hero of neutral and equal to 0. As the hero completes quests, he makes actions that change the attitude of the companions, whom he took to perform this task, in positive or negative direction.Tell us what companions the hero needs to choose to make their attitude equal after completing all the quests. If this can be done in several ways, choose the one in which the value of resulting attitude is greatest possible." meet-in-the-middle 2300
1639F "Treasure Hunt" "All problems in this contest share the same statement, the only difference is the test your solution runs on. For further information on scoring please refer to ""Scoring"" section of the statement.This is an interactive problem.Imagine you are a treasure hunter, a very skillful one. One day you came across an ancient map which could help you to become rich. The map shows multiple forestry roads, and at each junction there is a treasure. So, you start your journey hoping to retrieve all the hidden treasures, but you don\'t know yet that there is a wicked wizard standing against you and craving to tangle up these roads and impede your achievements.The treasure map is represented as an undirected graph in which vertices correspond to junctions and edges correspond to roads. Your path begins at a certain fixed vertex with a label known to you. Every time you come to a vertex that you have not been to before, you dig up a treasure chest and put a flag in this vertex. At the initial vertex you\'ll find a treasure chest immediately and, consequently, you\'ll put a flag there immediately as well.When you are standing at the junction you can see for each of the adjacent vertices its degree and if there is a flag there. There are no other things you can see from there. Besides, the power of the wicked wizard is so great that he is able to change the location of the roads and junctions on the map without changing the graph structure. Therefore, the sequence of the roads coming from the junction v might be different each time you come in the junction v. However, keep in mind that the set of adjacent crossroads does not change, and you are well aware of previously dug treasures at each adjacent to v vertex.Your goal is to collect treasures from all vertices of the graph as fast as you can. Good luck in hunting!" graphs,interactive -999
900D "Unusual Sequences" "Count the number of distinct sequences a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ai) consisting of positive integers such that gcd(a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an)\xe2\x80\x89=\xe2\x80\x89x and . As this number could be large, print the answer modulo 109\xe2\x80\x89+\xe2\x80\x897.gcd here means the greatest common divisor." "bitmasks,combinatorics,dp,math,number theory" 2000
1452B "Toy Blocks" "You are asked to watch your nephew who likes to play with toy blocks in a strange way.He has n boxes and the i-th box has ai blocks. His game consists of two steps:   he chooses an arbitrary box i;  he tries to move all blocks from the i-th box to other boxes.  If he can make the same number of blocks in each of n\xe2\x88\x921 other boxes then he will be happy, otherwise, will be sad. Note that your nephew can only move the blocks from the chosen box to the other boxes; he cannot move blocks from the other boxes.You don\'t want to make your nephew sad, so you decided to put several extra blocks into some boxes in such a way that no matter which box i he chooses he won\'t be sad. What is the minimum number of extra blocks you need to put?" "binary search,greedy,math,sortings" 1400
1635B "Avoid Local Maximums" "You are given an array a of size n. Each element in this array is an integer between 1 and 109.You can perform several operations to this array. During an operation, you can replace an element in the array with any integer between 1 and 109. Output the minimum number of operations needed such that the resulting array doesn\'t contain any local maximums, and the resulting array after the operations.An element ai is a local maximum if it is strictly larger than both of its neighbors (that is, ai>ai\xe2\x88\x921 and ai>ai+1). Since a1 and an have only one neighbor each, they will never be a local maximum." greedy 800
234D Cinema "Overall there are m actors in Berland. Each actor has a personal identifier \xe2\x80\x94 an integer from 1 to m (distinct actors have distinct identifiers). Vasya likes to watch Berland movies with Berland actors, and he has k favorite actors. He watched the movie trailers for the next month and wrote the following information for every movie: the movie title, the number of actors who starred in it, and the identifiers of these actors. Besides, he managed to copy the movie titles and how many actors starred there, but he didn\'t manage to write down the identifiers of some actors. Vasya looks at his records and wonders which movies may be his favourite, and which ones may not be. Once Vasya learns the exact cast of all movies, his favorite movies will be determined as follows: a movie becomes favorite movie, if no other movie from Vasya\'s list has more favorite actors.Help the boy to determine the following for each movie: whether it surely will be his favourite movie; whether it surely won\'t be his favourite movie;  can either be favourite or not." implementation 1600
1092A "Uniform String" "You are given two integers n and k.Your task is to construct such a string s of length n that for each i from 1 to k there is at least one i-th letter of the Latin alphabet in this string (the first letter is \'a\', the second is \'b\' and so on) and there are no other letters except these. You have to maximize the minimal frequency of some letter (the frequency of a letter is the number of occurrences of this letter in a string). If there are several possible answers, you can print any.You have to answer t independent queries." implementation 800
1666K "Kingdom Partition" "The King is gone. After the King\'s rule, all the roads in the Kingdom are run down and need repair. Three of the King\'s children, Adrian, Beatrice and Cecilia, are dividing the Kingdom between themselves.Adrian and Beatrice do not like each other and do not plan to maintain any relations between themselves in the future. Cecilia is on good terms with both of them. Moreover, most of the Kingdom\'s workers support Cecilia, so she has better resources and more opportunity to repair the infrastructure and develop the economy. Cecilia proposes to partition the Kingdom into three districts: A (for Adrian), B (for Beatrice), and C (for Cecilia), and let Adrian and Beatrice to negotiate and choose any towns they want to be in their districts, and agree on how they want to partition the Kingdom into three districts.Adrian\'s castle is located in town a, and Beatrice\'s one is located in town b. So Adrian and Beatrice want their castles to be located in districts A and B, respectively. Cecilia doesn\'t have a castle, so district C can consist of no towns.There is an issue for Adrian and Beatrice. When they choose the towns, they will have to pay for the roads\' repair.The cost to repair the road of length l is 2l gold. However, Adrian and Beatrice don\'t have to bear all the repair costs. The repair cost for the road of length l that they bear depends on what towns it connects:  For a road between two towns inside district A, Adrian has to pay 2l gold;  For a road between two towns inside district B, Beatrice has to pay 2l gold;  For a road between towns from district A and district C, Adrian has to pay l gold, Cecilia bears the remaining cost;  For a road between towns from district B and district C, Beatrice has to pay l gold, Cecilia bears the remaining cost. The roads that connect towns from district A and district B won\'t be repaired, since Adrian and Beatrice are not planning to use them, so no one pays for them. Cecilia herself will repair the roads that connect the towns inside district C, so Adrian and Beatrice won\'t bear the cost of their repair either.Adrian and Beatrice want to minimize the total cost they spend on roads\' repair. Find the cheapest way for them to partition the Kingdom into three districts." flows 3200
1372B "Omkar and Last Class of Math" "In Omkar\'s last class of math, he learned about the least common multiple, or LCM. LCM(a,b) is the smallest positive integer x which is divisible by both a and b.Omkar, having a laudably curious mind, immediately thought of a problem involving the LCM operation: given an integer n, find positive integers a and b such that a+b=n and LCM(a,b) is the minimum value possible.Can you help Omkar solve his ludicrously challenging math problem?" "greedy,math,number theory" 1300
718A "Efim and Strange Grade" "Efim just received his grade for the last test. He studies in a special school and his grade can be equal to any positive decimal fraction. First he got disappointed, as he expected a way more pleasant result. Then, he developed a tricky plan. Each second, he can ask his teacher to round the grade at any place after the decimal point (also, he can ask to round to the nearest integer). There are t seconds left till the end of the break, so Efim has to act fast. Help him find what is the maximum grade he can get in no more than t seconds. Note, that he can choose to not use all t seconds. Moreover, he can even choose to not round the grade at all.In this problem, classic rounding rules are used: while rounding number to the n-th digit one has to take a look at the digit n\xe2\x80\x89+\xe2\x80\x891. If it is less than 5 than the n-th digit remain unchanged while all subsequent digits are replaced with 0. Otherwise, if the n\xe2\x80\x89+\xe2\x80\x891 digit is greater or equal to 5, the digit at the position n is increased by 1 (this might also change some other digits, if this one was equal to 9) and all subsequent digits are replaced with 0. At the end, all trailing zeroes are thrown away.For example, if the number 1.14 is rounded to the first decimal place, the result is 1.1, while if we round 1.5 to the nearest integer, the result is 2. Rounding number 1.299996121 in the fifth decimal place will result in number 1.3." dp,implementation,math 1700
1677E "Tokitsukaze and Beautiful Subsegments" "Tokitsukaze has a permutation p of length n.Let\'s call a segment [l,r] beautiful if there exist i and j satisfying pi\xe2\x8b\x85pj=max{pl,pl+1,\xe2\x80\xa6,pr}, where l\xe2\x89\xa4i<j\xe2\x89\xa4r.Now Tokitsukaze has q queries, in the i-th query she wants to know how many beautiful subsegments [x,y] there are in the segment [li,ri] (i. e. li\xe2\x89\xa4x\xe2\x89\xa4y\xe2\x89\xa4ri)." "data structures" 2900
75D "Big Maximum Sum" "Ahmed and Mostafa used to compete together in many programming contests for several years. Their coach Fegla asked them to solve one challenging problem, of course Ahmed was able to solve it but Mostafa couldn\'t.This problem is similar to a standard problem but it has a different format and constraints.In the standard problem you are given an array of integers, and you have to find one or more consecutive elements in this array where their sum is the maximum possible sum.But in this problem you are given n small arrays, and you will create one big array from the concatenation of one or more instances of the small arrays (each small array could occur more than once). The big array will be given as an array of indexes (1-based) of the small arrays, and the concatenation should be done in the same order as in this array. Then you should apply the standard problem mentioned above on the resulting big array.For example let\'s suppose that the small arrays are {1, 6, -2}, {3, 3} and {-5, 1}. And the indexes in the big array are {2, 3, 1, 3}. So the actual values in the big array after formatting it as concatenation of the small arrays will be {3, 3, -5, 1, 1, 6, -2, -5, 1}. In this example the maximum sum is 9.Can you help Mostafa solve this problem?" "data structures,dp,greedy,implementation,math,trees" 2000
1509A "Average Height" "Sayaka Saeki is a member of the student council, which has n other members (excluding Sayaka). The i-th member has a height of ai millimeters.It\'s the end of the school year and Sayaka wants to take a picture of all other members of the student council. Being the hard-working and perfectionist girl as she is, she wants to arrange all the members in a line such that the amount of photogenic consecutive pairs of members is as large as possible.A pair of two consecutive members u and v on a line is considered photogenic if their average height is an integer, i.e. au+av2 is an integer.Help Sayaka arrange the other members to maximize the number of photogenic consecutive pairs." "constructive algorithms" 800
696F ...Dary! "Barney has finally found the one, a beautiful young lady named Lyanna. The problem is, Lyanna and Barney are trapped in Lord Loss\' castle. This castle has shape of a convex polygon of n points. Like most of castles in Demonata worlds, this castle has no ceiling.  Barney and Lyanna have an escape plan, but it requires some geometry knowledge, so they asked for your help.Barney knows that demons are organized and move in lines. He and Lyanna want to wait for the appropriate time so they need to watch for the demons. Each of them wants to stay in a point inside the castle (possibly on edges or corners), also they may stay in the same position. They both want to pick a real number r and watch all points in the circles with radius r around each of them (these two circles may overlap).  We say that Barney and Lyanna are watching carefully if and only if for every edge of the polygon, at least one of them can see at least one point on the line this edge lies on, thus such point may not be on the edge but it should be on edge\'s line. Formally, each edge line should have at least one common point with at least one of two circles.The greater r is, the more energy and focus they need. So they asked you to tell them the minimum value of r such that they can watch carefully." "binary search,geometry,two pointers" 3300
1710B Rain "You are the owner of a harvesting field which can be modeled as an infinite line, whose positions are identified by integers.It will rain for the next n days. On the i-th day, the rain will be centered at position xi and it will have intensity pi. Due to these rains, some rainfall will accumulate; let aj be the amount of rainfall accumulated at integer position j. Initially aj is 0, and it will increase by max(0,pi\xe2\x88\x92|xi\xe2\x88\x92j|) after the i-th day\'s rain.A flood will hit your field if, at any moment, there is a position j with accumulated rainfall aj>m.You can use a magical spell to erase exactly one day\'s rain, i.e., setting pi=0. For each i from 1 to n, check whether in case of erasing the i-th day\'s rain there is no flood." "binary search,brute force,data structures,geometry,greedy,implementation,math" 2100
1824A "LuoTianyi and the Show" "There are n people taking part in a show about VOCALOID. They will sit in the row of seats, numbered 1 to m from left to right.The n people come and sit in order. Each person occupies a seat in one of three ways:  Sit in the seat next to the left of the leftmost person who is already sitting, or if seat 1 is taken, then leave the show. If there is no one currently sitting, sit in seat m. Sit in the seat next to the right of the rightmost person who is already sitting, or if seat m is taken, then leave the show. If there is no one currently sitting, sit in seat 1. Sit in the seat numbered xi. If this seat is taken, then leave the show. Now you want to know what is the maximum number of people that can take a seat, if you can let people into the show in any order?" greedy,implementation 1400
819C "Mister B and Beacons on Field" "Mister B has a house in the middle of a giant plain field, which attracted aliens life. For convenience, aliens specified the Cartesian coordinate system on the field in such a way that Mister B\'s house has coordinates (0,\xe2\x80\x890). After that they sent three beacons to the field, but something went wrong. One beacon was completely destroyed, while the other two landed in positions with coordinates (m,\xe2\x80\x890) and (0,\xe2\x80\x89n), respectively, but shut down.Mister B was interested in this devices, so he decided to take them home. He came to the first beacon, placed at (m,\xe2\x80\x890), lifted it up and carried the beacon home choosing the shortest path. After that he came to the other beacon, placed at (0,\xe2\x80\x89n), and also carried it home choosing the shortest path. When first beacon was lifted up, the navigation system of the beacons was activated.Partially destroyed navigation system started to work in following way.At time moments when both survived beacons are at points with integer coordinates the system tries to find a location for the third beacon. It succeeds if and only if there is a point with integer coordinates such that the area of the triangle formed by the two survived beacons and this point is equal to s. In this case the system sends a packet of information with beacon positions to aliens, otherwise it doesn\'t.Compute how many packets of information system sent while Mister B was moving the beacons." "number theory" 2900
1184D1 "Parallel Universes (Easy)" "The Third Doctor Who once correctly said that travel between parallel universes is ""like travelling sideways"". However, he incorrectly thought that there were infinite parallel universes, whereas in fact, as we now all know, there will never be more than 250.Heidi recently got her hands on a multiverse observation tool. She was able to see all n universes lined up in a row, with non-existent links between them. She also noticed that the Doctor was in the k-th universe.The tool also points out that due to restrictions originating from the space-time discontinuum, the number of universes will never exceed m.Obviously, the multiverse is unstable because of free will. Each time a decision is made, one of two events will randomly happen: a new parallel universe is created, or a non-existent link is broken.More specifically,   When a universe is created, it will manifest itself between any two adjacent universes or at one of the ends.   When a link is broken, it could be cut between any two adjacent universes. After separating the multiverse into two segments, the segment NOT containing the Doctor will cease to exist. Heidi wants to perform a simulation of t decisions. Each time a decision is made, Heidi wants to know the length of the multiverse (i.e. the number of universes), and the position of the Doctor." implementation 1600
268C "Beautiful Sets of Points" "Manao has invented a new mathematical term \xe2\x80\x94 a beautiful set of points. He calls a set of points on a plane beautiful if it meets the following conditions:  The coordinates of each point in the set are integers.  For any two points from the set, the distance between them is a non-integer. Consider all points (x,\xe2\x80\x89y) which satisfy the inequations: 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n; 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m; x\xe2\x80\x89+\xe2\x80\x89y\xe2\x80\x89>\xe2\x80\x890. Choose their subset of maximum size such that it is also a beautiful set of points." "constructive algorithms,implementation" 1500
1083F "The Fair Nut and Amusing Xor" "The Fair Nut has two arrays a and b, consisting of n numbers. He found them so long ago that no one knows when they came to him.The Fair Nut often changes numbers in his arrays. He also is interested in how similar a and b are after every modification.Let\'s denote similarity of two arrays as the minimum number of operations to apply to make arrays equal (every operation can be applied for both arrays). If it is impossible, similarity will be equal \xe2\x88\x921.Per one operation you can choose a subarray with length k (k is fixed), and change every element ai, which belongs to the chosen subarray, to ai\xe2\x8a\x95x (x can be chosen), where \xe2\x8a\x95 denotes the bitwise XOR operation. Nut has already calculated the similarity of the arrays after every modification. Can you do it?Note that you just need to calculate those values, that is you do not need to apply any operations." "data structures" 3300
2003D1 "Turtle and a MEX Problem (Easy Version)" "The two versions are different problems. In this version of the problem, you can choose the same integer twice or more. You can make hacks only if both versions are solved.One day, Turtle was playing with n sequences. Let the length of the i-th sequence be li. Then the i-th sequence was ai,1,ai,2,\xe2\x80\xa6,ai,li.Piggy gave Turtle a problem to solve when Turtle was playing. The statement of the problem was:  There was a non-negative integer x at first. Turtle would perform an arbitrary number (possibly zero) of operations on the integer.  In each operation, Turtle could choose an integer i such that 1\xe2\x89\xa4i\xe2\x89\xa4n, and set x to mex\xe2\x80\xa0(x,ai,1,ai,2,\xe2\x80\xa6,ai,li).  Turtle was asked to find the answer, which was the maximum value of x after performing an arbitrary number of operations. Turtle solved the above problem without difficulty. He defined f(k) as the answer to the above problem when the initial value of x was k.Then Piggy gave Turtle a non-negative integer m and asked Turtle to find the value of m\xe2\x88\x91i=0f(i) (i.e., the value of f(0)+f(1)+\xe2\x80\xa6+f(m)). Unfortunately, he couldn\'t solve this problem. Please help him!\xe2\x80\xa0mex(c1,c2,\xe2\x80\xa6,ck) is defined as the smallest non-negative integer x which does not occur in the sequence c. For example, mex(2,2,0,3) is 1, mex(1,2) is 0." greedy,math 1500
930B "Game with String" "Vasya and Kolya play a game with a string, using the following rules. Initially, Kolya creates a string s, consisting of small English letters, and uniformly at random chooses an integer k from a segment [0,\xe2\x80\x89len(s)\xe2\x80\x89-\xe2\x80\x891]. He tells Vasya this string s, and then shifts it k letters to the left, i. e. creates a new string t\xe2\x80\x89=\xe2\x80\x89sk\xe2\x80\x89+\xe2\x80\x891sk\xe2\x80\x89+\xe2\x80\x892... sns1s2... sk. Vasya does not know the integer k nor the string t, but he wants to guess the integer k. To do this, he asks Kolya to tell him the first letter of the new string, and then, after he sees it, open one more letter on some position, which Vasya can choose.Vasya understands, that he can\'t guarantee that he will win, but he wants to know the probability of winning, if he plays optimally. He wants you to compute this probability. Note that Vasya wants to know the value of k uniquely, it means, that if there are at least two cyclic shifts of s that fit the information Vasya knowns, Vasya loses. Of course, at any moment of the game Vasya wants to maximize the probability of his win." implementation,probabilities,strings 1600
1473G Tiles "Consider a road consisting of several rows. Each row is divided into several rectangular tiles, and all tiles in the same row are equal. The first row contains exactly one rectangular tile. Look at the picture below which shows how the tiles are arranged.The road is constructed as follows:   the first row consists of 1 tile;  then a1 rows follow; each of these rows contains 1 tile greater than the previous row;  then b1 rows follow; each of these rows contains 1 tile less than the previous row;  then a2 rows follow; each of these rows contains 1 tile greater than the previous row;  then b2 rows follow; each of these rows contains 1 tile less than the previous row;  ...  then an rows follow; each of these rows contains 1 tile greater than the previous row;  then bn rows follow; each of these rows contains 1 tile less than the previous row.   An example of the road with n=2, a1=4, b1=2, a2=2, b2=3. Rows are arranged from left to right. You start from the only tile in the first row and want to reach the last row (any tile of it). From your current tile, you can move to any tile in the next row which touches your current tile.Calculate the number of different paths from the first row to the last row. Since it can be large, print it modulo 998244353." combinatorics,dp,fft,math 2800
1647C "Madoka and Childish Pranks" "Madoka as a child was an extremely capricious girl, and one of her favorite pranks was drawing on her wall. According to Madoka\'s memories, the wall was a table of n rows and m columns, consisting only of zeroes and ones. The coordinate of the cell in the i-th row and the j-th column (1\xe2\x89\xa4i\xe2\x89\xa4n, 1\xe2\x89\xa4j\xe2\x89\xa4m) is (i,j).One day she saw a picture ""Mahou Shoujo Madoka Magica"" and decided to draw it on her wall. Initially, the Madoka\'s table is a table of size n\xc3\x97m filled with zeroes. Then she applies the following operation any number of times:Madoka selects any rectangular subtable of the table and paints it in a chess coloring (the upper left corner of the subtable always has the color 0). Note that some cells may be colored several times. In this case, the final color of the cell is equal to the color obtained during the last repainting.  White color means 0, black means 1. So, for example, the table in the first picture is painted in a chess coloring, and the others are not. For better understanding of the statement, we recommend you to read the explanation of the first test.Help Madoka and find some sequence of no more than n\xe2\x8b\x85m operations that allows you to obtain the picture she wants, or determine that this is impossible." "constructive algorithms,greedy" 1300
557D "Vitaly and Cycle" "After Vitaly was expelled from the university, he became interested in the graph theory.Vitaly especially liked the cycles of an odd length in which each vertex occurs at most once.Vitaly was wondering how to solve the following problem. You are given an undirected graph consisting of n vertices and m edges, not necessarily connected, without parallel edges and loops. You need to find t \xe2\x80\x94 the minimum number of edges that must be added to the given graph in order to form a simple cycle of an odd length, consisting of more than one vertex. Moreover, he must find w \xe2\x80\x94 the number of ways to add t edges in order to form a cycle of an odd length (consisting of more than one vertex). It is prohibited to add loops or parallel edges.Two ways to add edges to the graph are considered equal if they have the same sets of added edges.Since Vitaly does not study at the university, he asked you to help him with this task." "combinatorics,dfs and similar,graphs,math" 2000
958F2 "Lightsabers (medium)" "There is unrest in the Galactic Senate. Several thousand solar systems have declared their intentions to leave the Republic. Master Heidi needs to select the Jedi Knights who will go on peacekeeping missions throughout the galaxy. It is well-known that the success of any peacekeeping mission depends on the colors of the lightsabers of the Jedi who will go on that mission. Heidi has n Jedi Knights standing in front of her, each one with a lightsaber of one of m possible colors. She knows that for the mission to be the most effective, she needs to select some contiguous interval of knights such that there are exactly k1 knights with lightsabers of the first color, k2 knights with lightsabers of the second color, ..., km knights with lightsabers of the m-th color.However, since the last time, she has learned that it is not always possible to select such an interval. Therefore, she decided to ask some Jedi Knights to go on an indefinite unpaid vacation leave near certain pits on Tatooine, if you know what I mean. Help Heidi decide what is the minimum number of Jedi Knights that need to be let go before she is able to select the desired interval from the subsequence of remaining knights." "binary search,two pointers" 1800
1207G "Indie Album" "Mishka\'s favourite experimental indie band has recently dropped a new album! Songs of that album share one gimmick. Each name si is one of the following types:  1 c \xe2\x80\x94 a single lowercase Latin letter;  2 j c \xe2\x80\x94 name sj (1\xe2\x89\xa4j<i) with a single lowercase Latin letter appended to its end. Songs are numbered from 1 to n. It\'s guaranteed that the first song is always of type 1.Vova is rather interested in the new album but he really doesn\'t have the time to listen to it entirely. Thus he asks Mishka some questions about it to determine if some song is worth listening to. Questions have the following format:  i t \xe2\x80\x94 count the number of occurrences of string t in si (the name of the i-th song of the album) as a continuous substring, t consists only of lowercase Latin letters. Mishka doesn\'t question the purpose of that information, yet he struggles to provide it. Can you please help Mishka answer all Vova\'s questions?" "data structures,dfs and similar,hashing,string suffix structures,strings,trees" 2700
1658B "Marin and Anti-coprime Permutation" "Marin wants you to count number of permutations that are beautiful. A beautiful permutation of length n is a permutation that has the following property: gcd(1\xe2\x8b\x85p1,2\xe2\x8b\x85p2,\xe2\x80\xa6,n\xe2\x8b\x85pn)>1, where gcd is the greatest common divisor.A permutation is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array) and [1,3,4] is also not a permutation (n=3 but there is 4 in the array)." "combinatorics,math,number theory" 800
1987F2 "Interesting Problem (Hard Version)" "This is the hard version of the problem. The only difference between the two versions is the constraint on n. You can make hacks only if both versions of the problem are solved.You are given an array of integers a of length n. In one operation, you will perform the following two-step process:   Choose an index i such that 1\xe2\x89\xa4i<|a| and ai=i.  Remove ai and ai+1 from the array and concatenate the remaining parts. Find the maximum number of times that you can perform the operation above." dp 2600
430B "Balls Game" "Iahub is training for the IOI. What is a better way to train than playing a Zuma-like game? There are n balls put in a row. Each ball is colored in one of k colors. Initially the row doesn\'t contain three or more contiguous balls with the same color. Iahub has a single ball of color x. He can insert his ball at any position in the row (probably, between two other balls). If at any moment there are three or more contiguous balls of the same color in the row, they are destroyed immediately. This rule is applied multiple times, until there are no more sets of 3 or more contiguous balls of the same color. For example, if Iahub has the row of balls [black, black, white, white, black, black] and a white ball, he can insert the ball between two white balls. Thus three white balls are destroyed, and then four black balls become contiguous, so all four balls are destroyed. The row will not contain any ball in the end, so Iahub can destroy all 6 balls.Iahub wants to destroy as many balls as possible. You are given the description of the row of balls, and the color of Iahub\'s ball. Help Iahub train for the IOI by telling him the maximum number of balls from the row he can destroy." "brute force,two pointers" 1400
2005E2 "Subtangle Game (Hard Version)" "This is the hard version of the problem. The differences between the two versions are the constraints on all the variables. You can make hacks only if both versions of the problem are solved.Tsovak and Narek are playing a game. They have an array a and a matrix b of integers with n rows and m columns, numbered from 1. The cell in the i-th row and the j-th column is (i,j).They are looking for the elements of a in turns; Tsovak starts first. Each time a player looks for a cell in the matrix containing the current element of a (Tsovak looks for the first, then Narek looks for the second, etc.). Let\'s say a player has chosen the cell (r,c). The next player has to choose his cell in the submatrix starting at (r+1,c+1) and ending in (n,m) (the submatrix can be empty if r=n or c=m). If a player cannot find such a cell (or the remaining submatrix is empty) or the array ends (the previous player has chosen the last element), then he loses.Your task is to determine the winner if the players play optimally.Note: since the input is large, you may need to optimize input/output for this problem.For example, in C++, it is enough to use the following lines at the start of the main() function: int main() {    ios_base::sync_with_stdio(false);    cin.tie(NULL); cout.tie(NULL);}" "data structures,dp,games,greedy,implementation" 2500
109A "Lucky Sum of Digits" "Petya loves lucky numbers. We all know that lucky numbers are the positive integers whose decimal representations contain only the lucky digits 4 and 7. For example, numbers 47, 744, 4 are lucky and 5, 17, 467 are not.Petya wonders eagerly what minimum lucky number has the sum of digits equal to n. Help him cope with the task." "brute force,implementation" 1000
938A "Word Correction" "Victor tries to write his own text editor, with word correction included. However, the rules of word correction are really strange.Victor thinks that if a word contains two consecutive vowels, then it\'s kinda weird and it needs to be replaced. So the word corrector works in such a way: as long as there are two consecutive vowels in the word, it deletes the first vowel in a word such that there is another vowel right before it. If there are no two consecutive vowels in the word, it is considered to be correct.You are given a word s. Can you predict what will it become after correction?In this problem letters a, e, i, o, u and y are considered to be vowels." implementation 800
1491I "Ruler Of The Zoo" "After realizing that Zookeeper is just a duck, the animals have overthrown Zookeeper. They now have to decide a new ruler among themselves through a fighting tournament of the following format:Initially, animal 0 is king, while everyone else queues up with animal 1 at the front of the queue and animal n\xe2\x88\x921 at the back. The animal at the front of the queue will challenge the king to a fight, and the animal with greater strength will win the fight. The winner will become king, while the loser joins the back of the queue.An animal who wins 3 times consecutively will be crowned ruler for the whole zoo. The strength of each animal depends on how many consecutive fights he won. Animal i has strength Ai with 0 consecutive win, Bi with 1 consecutive win, and Ci with 2 consecutive wins. Initially, everyone has 0 consecutive win.For all animals, Ai>Bi and Ci>Bi. Also, the values of Ai, Bi, Ci are distinct (all 3n values are pairwise different). In other words, an animal who is not a king has strength Ai. A king usually has a strength of Bi or Ci. The exception is on the first turn, the first king (animal 0) has strength Ai.Who is the new ruler, and after how many fights? Or will it end up that animals fight forever with no one ending up as ruler?" "brute force,data structures" 3500
271D "Good Substrings" "You\'ve got string s, consisting of small English letters. Some of the English letters are good, the rest are bad.A substring s[l...r] (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|s|) of string s\xe2\x80\x89\xe2\x80\x89=\xe2\x80\x89\xe2\x80\x89s1s2...s|s| (where |s| is the length of string s) is string \xe2\x80\x89slsl\xe2\x80\x89+\xe2\x80\x891...sr.The substring s[l...r] is good, if among the letters \xe2\x80\x89sl,\xe2\x80\x89sl\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89sr there are at most k bad ones (look at the sample\'s explanation to understand it more clear).Your task is to find the number of distinct good substrings of the given string s. Two substrings s[x...y] and s[p...q] are considered distinct if their content is different, i.e. s[x...y]\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89s[p...q]." "data structures,strings" 1800
1043D "Mysterious Crime" "Acingel is a small town. There was only one doctor here \xe2\x80\x94 Miss Ada. She was very friendly and nobody has ever said something bad about her, so who could\'ve expected that Ada will be found dead in her house? Mr Gawry, world-famous detective, is appointed to find the criminal. He asked m neighbours of Ada about clients who have visited her in that unlucky day. Let\'s number the clients from 1 to n. Each neighbour\'s testimony is a permutation of these numbers, which describes the order in which clients have been seen by the asked neighbour.However, some facts are very suspicious \xe2\x80\x93 how it is that, according to some of given permutations, some client has been seen in the morning, while in others he has been seen in the evening? ""In the morning some of neighbours must have been sleeping!"" \xe2\x80\x94 thinks Gawry \xe2\x80\x94 ""and in the evening there\'s been too dark to see somebody\'s face..."". Now he wants to delete some prefix and some suffix (both prefix and suffix can be empty) in each permutation, so that they\'ll be non-empty and equal to each other after that \xe2\x80\x94 some of the potential criminals may disappear, but the testimony won\'t stand in contradiction to each other.In how many ways he can do it? Two ways are called different if the remaining common part is different." "brute force,combinatorics,math,meet-in-the-middle,two pointers" 1700
653A "Bear and Three Balls" "Limak is a little polar bear. He has n balls, the i-th ball has size ti.Limak wants to give one ball to each of his three friends. Giving gifts isn\'t easy \xe2\x80\x94 there are two rules Limak must obey to make friends happy:  No two friends can get balls of the same size.  No two friends can get balls of sizes that differ by more than 2. For example, Limak can choose balls with sizes 4, 5 and 3, or balls with sizes 90, 91 and 92. But he can\'t choose balls with sizes 5, 5 and 6 (two friends would get balls of the same size), and he can\'t choose balls with sizes 30, 31 and 33 (because sizes 30 and 33 differ by more than 2).Your task is to check whether Limak can choose three balls that satisfy conditions above." "brute force,implementation,sortings" 900
120I "Luck is in Numbers" "Vasya has been collecting transport tickets for quite a while now. His collection contains several thousands of tram, trolleybus and bus tickets. Vasya is already fed up with the traditional definition of what a lucky ticket is. Thus, he\'s looking for new perspectives on that. Besides, Vasya cannot understand why all tickets are only divided into lucky and unlucky ones. He thinks that all tickets are lucky but in different degrees. Having given the matter some thought, Vasya worked out the definition of a ticket\'s degree of luckiness. Let a ticket consist of 2n digits. Let\'s regard each digit as written as is shown on the picture:  You have seen such digits on electronic clocks: seven segments are used to show digits. Each segment can either be colored or not. The colored segments form a digit. Vasya regards the digits as written in this very way and takes the right half of the ticket and puts it one the left one, so that the first digit coincides with the n\xe2\x80\x89+\xe2\x80\x891-th one, the second digit coincides with the n\xe2\x80\x89+\xe2\x80\x892-th one, ..., the n-th digit coincides with the 2n-th one. For each pair of digits, put one on another, he counts the number of segments colored in both digits and summarizes the resulting numbers. The resulting value is called the degree of luckiness of a ticket. For example, the degree of luckiness of ticket 03 equals four and the degree of luckiness of ticket 2345 equals six.You are given the number of a ticket containing 2n digits. Your task is to find among the tickets whose number exceeds the number of this ticket but also consists of 2n digits such ticket, whose degree of luckiness exceeds the degrees of luckiness of the given ticket. Moreover, if there are several such tickets, you should only choose the one with the smallest number." greedy 2200
522C "Chicken or Fish?" "Polycarp is flying in the airplane. Finally, it is his favorite time \xe2\x80\x94 the lunchtime. The BerAvia company stewardess is giving food consecutively to all the passengers from the 1-th one to the last one. Polycarp is sitting on seat m, that means, he will be the m-th person to get food.The flight menu has k dishes in total and when Polycarp boarded the flight, he had time to count the number of portions of each dish on board. Thus, he knows values a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89ak, where ai is the number of portions of the i-th dish.The stewardess has already given food to m\xe2\x80\x89-\xe2\x80\x891 passengers, gave Polycarp a polite smile and asked him what he would prefer. That\'s when Polycarp realized that they might have run out of some dishes by that moment. For some of the m\xe2\x80\x89-\xe2\x80\x891 passengers ahead of him, he noticed what dishes they were given. Besides, he\'s heard some strange mumbling from some of the m\xe2\x80\x89-\xe2\x80\x891 passengers ahead of him, similar to phrase \'I\'m disappointed\'. That happened when a passenger asked for some dish but the stewardess gave him a polite smile and said that they had run out of that dish. In that case the passenger needed to choose some other dish that was available. If Polycarp heard no more sounds from a passenger, that meant that the passenger chose his dish at the first try.Help Polycarp to find out for each dish: whether they could have run out of the dish by the moment Polyarp was served or that dish was definitely available." greedy 2100
1303F "Number of Components" "You are given a matrix n\xc3\x97m, initially filled with zeroes. We define ai,j as the element in the i-th row and the j-th column of the matrix.Two cells of the matrix are connected if they share a side, and the elements in these cells are equal. Two cells of the matrix belong to the same connected component if there exists a sequence s1, s2, ..., sk such that s1 is the first cell, sk is the second cell, and for every i\xe2\x88\x88[1,k\xe2\x88\x921], si and si+1 are connected.You are given q queries of the form xi yi ci (i\xe2\x88\x88[1,q]). For every such query, you have to do the following:  replace the element ax,y with c;  count the number of connected components in the matrix. There is one additional constraint: for every i\xe2\x88\x88[1,q\xe2\x88\x921], ci\xe2\x89\xa4ci+1." dsu,implementation 2800
1364A XXXXX "Ehab loves number theory, but for some reason he hates the number x. Given an array a, find the length of its longest subarray such that the sum of its elements isn\'t divisible by x, or determine that such subarray doesn\'t exist.An array a is a subarray of an array b if a can be obtained from b by deletion of several (possibly, zero or all) elements from the beginning and several (possibly, zero or all) elements from the end." "brute force,data structures,number theory,two pointers" 1200
1998E2 "Eliminating Balls With Merging (Hard Version)" "Drink water.\xe2\x80\x94 Sun Tzu, The Art of Becoming a Healthy ProgrammerThis is the hard version of the problem. The only difference is that x=1 in this version. You must solve both versions to be able to hack.You are given two integers n and x (x=1). There are n balls lined up in a row, numbered from 1 to n from left to right. Initially, there is a value ai written on the i-th ball.For each integer i from 1 to n, we define a function f(i) as follows:   Suppose you have a set S={1,2,\xe2\x80\xa6,i}.  In each operation, you have to select an integer l (1\xe2\x89\xa4l<i) from S such that l is not the largest element of S. Suppose r is the smallest element in S which is greater than l.   If al>ar, you set al=al+ar and remove r from S.  If al<ar, you set ar=al+ar and remove l from S.  If al=ar, you choose either the integer l or r to remove from S:   If you choose to remove l from S, you set ar=al+ar and remove l from S.  If you choose to remove r from S, you set al=al+ar and remove r from S.    f(i) denotes the number of integers j (1\xe2\x89\xa4j\xe2\x89\xa4i) such that it is possible to obtain S={j} after performing the above operations exactly i\xe2\x88\x921 times. For each integer i from x to n, you need to find f(i)." "binary search,brute force,data structures,divide and conquer,greedy,implementation" 2500
132D "Constants in the language of Shakespeare" "Shakespeare is a widely known esoteric programming language in which programs look like plays by Shakespeare, and numbers are given by combinations of ornate epithets. In this problem we will have a closer look at the way the numbers are described in Shakespeare.Each constant in Shakespeare is created from non-negative powers of 2 using arithmetic operations. For simplicity we\'ll allow only addition and subtraction and will look for a representation of the given number which requires a minimal number of operations.You are given an integer n. You have to represent it as n\xe2\x80\x89=\xe2\x80\x89a1\xe2\x80\x89+\xe2\x80\x89a2\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89am, where each of ai is a non-negative power of 2, possibly multiplied by -1. Find a representation which minimizes the value of m." "constructive algorithms,dp,greedy" 2100
1763A "Absolute Maximization" "You are given an array a of length n. You can perform the following operation several (possibly, zero) times:  Choose i, j, b: Swap the b-th digit in the binary representation of ai and aj. Find the maximum possible value of max(a)\xe2\x88\x92min(a).In a binary representation, bits are numbered from right (least significant) to left (most significant). Consider that there are an infinite number of leading zero bits at the beginning of any binary representation.For example, swap the 0-th bit for 4=1002 and 3=112 will result 1012=5 and 102=2. Swap the 2-nd bit for 4=1002 and 3=112 will result 0002=02=0 and 1112=7. Here, max(a) denotes the maximum element of array a and min(a) denotes the minimum element of array a.The binary representation of x is x written in base 2. For example, 9 and 6 written in base 2 are 1001 and 110, respectively." "bitmasks,constructive algorithms,greedy,math" 800
814A "An abandoned sentiment from past" "A few years ago, Hitagi encountered a giant crab, who stole the whole of her body weight. Ever since, she tried to avoid contact with others, for fear that this secret might be noticed.To get rid of the oddity and recover her weight, a special integer sequence is needed. Hitagi\'s sequence has been broken for a long time, but now Kaiki provides an opportunity.Hitagi\'s sequence a has a length of n. Lost elements in it are denoted by zeros. Kaiki provides another sequence b, whose length k equals the number of lost elements in a (i.e. the number of zeros). Hitagi is to replace each zero in a with an element from b so that each element in b should be used exactly once. Hitagi knows, however, that, apart from 0, no integer occurs in a and b more than once in total.If the resulting sequence is not an increasing sequence, then it has the power to recover Hitagi from the oddity. You are to determine whether this is possible, or Kaiki\'s sequence is just another fake. In other words, you should detect whether it is possible to replace each zero in a with an integer from b so that each integer from b is used exactly once, and the resulting sequence is not increasing." "constructive algorithms,greedy,implementation,sortings" 900
1320D "Reachable Strings" "In this problem, we will deal with binary strings. Each character of a binary string is either a 0 or a 1. We will also deal with substrings; recall that a substring is a contiguous subsequence of a string. We denote the substring of string s starting from the l-th character and ending with the r-th character as s[l\xe2\x80\xa6r]. The characters of each string are numbered from 1.We can perform several operations on the strings we consider. Each operation is to choose a substring of our string and replace it with another string. There are two possible types of operations: replace 011 with 110, or replace 110 with 011. For example, if we apply exactly one operation to the string 110011110, it can be transformed into 011011110, 110110110, or 110011011.Binary string a is considered reachable from binary string b if there exists a sequence s1, s2, ..., sk such that s1=a, sk=b, and for every i\xe2\x88\x88[1,k\xe2\x88\x921], si can be transformed into si+1 using exactly one operation. Note that k can be equal to 1, i.\xe2\x80\x89e., every string is reachable from itself.You are given a string t and q queries to it. Each query consists of three integers l1, l2 and len. To answer each query, you have to determine whether t[l1\xe2\x80\xa6l1+len\xe2\x88\x921] is reachable from t[l2\xe2\x80\xa6l2+len\xe2\x88\x921]." "data structures,hashing,strings" 2500
58B Coins "In Berland a money reform is being prepared. New coins are being introduced. After long economic calculations was decided that the most expensive coin should possess the denomination of exactly n Berland dollars. Also the following restriction has been introduced for comfort: the denomination of each coin should be divisible by the denomination of any cheaper coin. It is known that among all the possible variants the variant with the largest number of new coins will be chosen. Find this variant. Print in the order of decreasing of the coins\' denominations." greedy 1300
468B "Two Sets" "Little X has n distinct integers: p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pn. He wants to divide all of them into two sets A and B. The following two conditions must be satisfied:  If number x belongs to set A, then number a\xe2\x80\x89-\xe2\x80\x89x must also belong to set A.  If number x belongs to set B, then number b\xe2\x80\x89-\xe2\x80\x89x must also belong to set B. Help Little X divide the numbers into two sets or determine that it\'s impossible." "2-sat,dfs and similar,dsu,graph matchings,greedy" 2000
83C Track "You already know that Valery\'s favorite sport is biathlon. Due to your help, he learned to shoot without missing, and his skills are unmatched at the shooting range. But now a smaller task is to be performed, he should learn to complete the path fastest.The track\'s map is represented by a rectangle n\xe2\x80\x89\xc3\x97\xe2\x80\x89m in size divided into squares. Each square is marked with a lowercase Latin letter (which means the type of the plot), with the exception of the starting square (it is marked with a capital Latin letters S) and the terminating square (it is marked with a capital Latin letter T). The time of movement from one square to another is equal to 1 minute. The time of movement within the cell can be neglected. We can move from the cell only to side-adjacent ones, but it is forbidden to go beyond the map edges. Also the following restriction is imposed on the path: it is not allowed to visit more than k different types of squares (squares of one type can be visited an infinite number of times). Squares marked with S and T have no type, so they are not counted. But S must be visited exactly once \xe2\x80\x94 at the very beginning, and T must be visited exactly once \xe2\x80\x94 at the very end.Your task is to find the path from the square S to the square T that takes minimum time. Among all shortest paths you should choose the lexicographically minimal one. When comparing paths you should lexicographically represent them as a sequence of characters, that is, of plot types." "graphs,greedy,shortest paths" 2400
1856E1 "PermuTree (easy version)" "This is the easy version of the problem. The differences between the two versions are the constraint on n and the time limit. You can make hacks only if both versions of the problem are solved.You are given a tree with n vertices rooted at vertex 1.For some permutation\xe2\x80\xa0 a of length n, let f(a) be the number of pairs of vertices (u,v) such that au<alca(u,v)<av. Here, lca(u,v) denotes the lowest common ancestor of vertices u and v.Find the maximum possible value of f(a) over all permutations a of length n.\xe2\x80\xa0 A permutation of length n is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array), and [1,3,4] is also not a permutation (n=3 but there is 4 in the array)." "dfs and similar,dp,trees" 1800
1107E "Vasya and Binary String" "Vasya has a string s of length n consisting only of digits 0 and 1. Also he has an array a of length n. Vasya performs the following operation until the string becomes empty: choose some consecutive substring of equal characters, erase it from the string and glue together the remaining parts (any of them can be empty). For example, if he erases substring 111 from string 111110 he will get the string 110. Vasya gets ax points for erasing substring of length x.Vasya wants to maximize his total points, so help him with this!" dp 2400
508E "Arthur and Brackets" "Notice that the memory limit is non-standard.Recently Arthur and Sasha have studied correct bracket sequences. Arthur understood this topic perfectly and become so amazed about correct bracket sequences, so he even got himself a favorite correct bracket sequence of length 2n. Unlike Arthur, Sasha understood the topic very badly, and broke Arthur\'s favorite correct bracket sequence just to spite him.All Arthur remembers about his favorite sequence is for each opening parenthesis (\'(\') the approximate distance to the corresponding closing one (\')\'). For the i-th opening bracket he remembers the segment [li,\xe2\x80\x89ri], containing the distance to the corresponding closing bracket.Formally speaking, for the i-th opening bracket (in order from left to right) we know that the difference of its position and the position of the corresponding closing bracket belongs to the segment [li,\xe2\x80\x89ri].Help Arthur restore his favorite correct bracket sequence!" dp,greedy 2200
1129D Isolation "Find the number of ways to divide an array a of n integers into any number of disjoint non-empty segments so that, in each segment, there exist at most k distinct integers that appear exactly once.Since the answer can be large, find it modulo 998244353." "data structures,dp" 2900
1935D "Exam in MAC" "The Master\'s Assistance Center has announced an entrance exam, which consists of the following.The candidate is given a set s of size n and some strange integer c. For this set, it is needed to calculate the number of pairs of integers (x,y) such that 0\xe2\x89\xa4x\xe2\x89\xa4y\xe2\x89\xa4c, x+y is not contained in the set s, and also y\xe2\x88\x92x is not contained in the set s.Your friend wants to enter the Center. Help him pass the exam!" "binary search,combinatorics,implementation,math" 1800
1843B "Long Long" "Today Alex was brought array a1,a2,\xe2\x80\xa6,an of length n. He can apply as many operations as he wants (including zero operations) to change the array elements.In 1 operation Alex can choose any l and r such that 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n, and multiply all elements of the array from l to r inclusive by \xe2\x88\x921. In other words, Alex can replace the subarray [al,al+1,\xe2\x80\xa6,ar] by [\xe2\x88\x92al,\xe2\x88\x92al+1,\xe2\x80\xa6,\xe2\x88\x92ar] in 1 operation.For example, let n=5, the array is [1,\xe2\x88\x922,0,3,\xe2\x88\x921], l=2 and r=4, then after the operation the array will be [1,2,0,\xe2\x88\x923,\xe2\x88\x921].Alex is late for school, so you should help him find the maximum possible sum of numbers in the array, which can be obtained by making any number of operations, as well as the minimum number of operations that must be done for this." "greedy,math,two pointers" 800
1106B "Lunar New Year and Food Ordering" "Lunar New Year is approaching, and Bob is planning to go for a famous restaurant \xe2\x80\x94 ""Alice\'s"".The restaurant ""Alice\'s"" serves n kinds of food. The cost for the i-th kind is always ci. Initially, the restaurant has enough ingredients for serving exactly ai dishes of the i-th kind. In the New Year\'s Eve, m customers will visit Alice\'s one after another and the j-th customer will order dj dishes of the tj-th kind of food. The (i+1)-st customer will only come after the i-th customer is completely served.Suppose there are ri dishes of the i-th kind remaining (initially ri=ai). When a customer orders 1 dish of the i-th kind, the following principles will be processed. If ri>0, the customer will be served exactly 1 dish of the i-th kind. The cost for the dish is ci. Meanwhile, ri will be reduced by 1. Otherwise, the customer will be served 1 dish of the cheapest available kind of food if there are any. If there are multiple cheapest kinds of food, the one with the smallest index among the cheapest will be served. The cost will be the cost for the dish served and the remain for the corresponding dish will be reduced by 1. If there are no more dishes at all, the customer will leave angrily. Therefore, no matter how many dishes are served previously, the cost for the customer is 0.If the customer doesn\'t leave after the dj dishes are served, the cost for the customer will be the sum of the cost for these dj dishes.Please determine the total cost for each of the m customers." "data structures,implementation" 1500
1536F "Omkar and Akmar" "Omkar and Akmar are playing a game on a circular board with n (2\xe2\x89\xa4n\xe2\x89\xa4106) cells. The cells are numbered from 1 to n so that for each i (1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921) cell i is adjacent to cell i+1 and cell 1 is adjacent to cell n. Initially, each cell is empty.Omkar and Akmar take turns placing either an A or a B on the board, with Akmar going first. The letter must be placed on an empty cell. In addition, the letter cannot be placed adjacent to a cell containing the same letter. A player loses when it is their turn and there are no more valid moves.Output the number of possible distinct games where both players play optimally modulo 109+7. Note that we only consider games where some player has lost and there are no more valid moves.Two games are considered distinct if the number of turns is different or for some turn, the letter or cell number that the letter is placed on were different.A move is considered optimal if the move maximizes the player\'s chance of winning, assuming the other player plays optimally as well. More formally, if the player who has to move has a winning strategy, they have to make a move after which they will still have a winning strategy. If they do not, they can make any move." "chinese remainder theorem,combinatorics,constructive algorithms,fft,games,geometry,math,meet-in-the-middle,string suffix structures" 2600
1409D "Decrease the Sum of Digits" "You are given a positive integer n. In one move, you can increase n by one (i.e. make n:=n+1). Your task is to find the minimum number of moves you need to perform in order to make the sum of digits of n be less than or equal to s.You have to answer t independent test cases." greedy,math 1500
1838C "No Prime Differences" "You are given integers n and m. Fill an n by m grid with the integers 1 through n\xe2\x8b\x85m, in such a way that for any two adjacent cells in the grid, the absolute difference of the values in those cells is not a prime number. Two cells in the grid are considered adjacent if they share a side.  It can be shown that under the given constraints, there is always a solution." "constructive algorithms,math,number theory" 1400
1609G "A Stroll Around the Matrix" "William has two arrays of numbers a1,a2,\xe2\x80\xa6,ana1,a2,\xe2\x80\xa6,an and b1,b2,\xe2\x80\xa6,bm. The arrays satisfy the conditions of being convex. Formally an array c of length k is considered convex if ci\xe2\x88\x92ci\xe2\x88\x921<ci+1\xe2\x88\x92ci for all i from 2 to k\xe2\x88\x921 and c1<c2.Throughout William\'s life he observed q changes of two types happening to the arrays:   Add the arithmetic progression d,d\xe2\x8b\x852,d\xe2\x8b\x853,\xe2\x80\xa6,d\xe2\x8b\x85k to the suffix of the array a of length k. The array after the change looks like this: [a1,a2,\xe2\x80\xa6,an\xe2\x88\x92k,an\xe2\x88\x92k+1+d,an\xe2\x88\x92k+2+d\xe2\x8b\x852,\xe2\x80\xa6,an+d\xe2\x8b\x85k].  The same operation, but for array b. After each change a matrix d is created from arrays a and b, of size n\xc3\x97m, where di,j=ai+bj. William wants to get from cell (1,1) to cell (n,m) of this matrix. From cell (x,y) he can only move to cells (x+1,y) and (x,y+1). The length of a path is calculated as the sum of numbers in cells visited by William, including the first and the last cells.After each change William wants you to help find out the minimal length of the path he could take." "data structures,greedy,math" 3000
594C "Edo and Magnets" "Edo has got a collection of n refrigerator magnets!He decided to buy a refrigerator and hang the magnets on the door. The shop can make the refrigerator with any size of the door that meets the following restrictions: the refrigerator door must be rectangle, and both the length and the width of the door must be positive integers.Edo figured out how he wants to place the magnets on the refrigerator. He introduced a system of coordinates on the plane, where each magnet is represented as a rectangle with sides parallel to the coordinate axes.Now he wants to remove no more than k magnets (he may choose to keep all of them) and attach all remaining magnets to the refrigerator door, and the area of \xe2\x80\x8b\xe2\x80\x8bthe door should be as small as possible. A magnet is considered to be attached to the refrigerator door if its center lies on the door or on its boundary. The relative positions of all the remaining magnets must correspond to the plan.Let us explain the last two sentences. Let\'s suppose we want to hang two magnets on the refrigerator. If the magnet in the plan has coordinates of the lower left corner (x1, y1) and the upper right corner (x2, y2), then its center is located at (, ) (may not be integers). By saying the relative position should correspond to the plan we mean that the only available operation is translation, i.e. the vector connecting the centers of two magnets in the original plan, must be equal to the vector connecting the centers of these two magnets on the refrigerator.The sides of the refrigerator door must also be parallel to coordinate axes." "brute force,greedy,implementation,two pointers" 2300
1227A "Math Problem" "Your math teacher gave you the following problem:There are n segments on the x-axis, [l1;r1],[l2;r2],\xe2\x80\xa6,[ln;rn]. The segment [l;r] includes the bounds, i.e. it is a set of such x that l\xe2\x89\xa4x\xe2\x89\xa4r. The length of the segment [l;r] is equal to r\xe2\x88\x92l.Two segments [a;b] and [c;d] have a common point (intersect) if there exists x that a\xe2\x89\xa4x\xe2\x89\xa4b and c\xe2\x89\xa4x\xe2\x89\xa4d. For example, [2;5] and [3;10] have a common point, but [5;6] and [1;4] don\'t have.You should add one segment, which has at least one common point with each of the given segments and as short as possible (i.e. has minimal length). The required segment can degenerate to be a point (i.e a segment with length zero). The added segment may or may not be among the given n segments.In other words, you need to find a segment [a;b], such that [a;b] and every [li;ri] have a common point for each i, and b\xe2\x88\x92a is minimal." math 1100
626B Cards "Catherine has a deck of n cards, each of which is either red, green, or blue. As long as there are at least two cards left, she can do one of two actions:   take any two (not necessarily adjacent) cards with different colors and exchange them for a new card of the third color;  take any two (not necessarily adjacent) cards with the same color and exchange them for a new card with that color. She repeats this process until there is only one card left. What are the possible colors for the final card?" "constructive algorithms,dp,math" 1300
1102E "Monotonic Renumeration" "You are given an array a consisting of n integers. Let\'s denote monotonic renumeration of array a as an array b consisting of n integers such that all of the following conditions are met:  b1=0;  for every pair of indices i and j such that 1\xe2\x89\xa4i,j\xe2\x89\xa4n, if ai=aj, then bi=bj (note that if ai\xe2\x89\xa0aj, it is still possible that bi=bj);  for every index i\xe2\x88\x88[1,n\xe2\x88\x921] either bi=bi+1 or bi+1=bi+1. For example, if a=[1,2,1,2,3], then two possible monotonic renumerations of a are b=[0,0,0,0,0] and b=[0,0,0,0,1].Your task is to calculate the number of different monotonic renumerations of a. The answer may be large, so print it modulo 998244353." combinatorics,sortings 1700
1333B "Kind Anton" "Once again, Boris needs the help of Anton in creating a task. This time Anton needs to solve the following problem:There are two arrays of integers a and b of length n. It turned out that array a contains only elements from the set {\xe2\x88\x921,0,1}.Anton can perform the following sequence of operations any number of times:  Choose any pair of indexes (i,j) such that 1\xe2\x89\xa4i<j\xe2\x89\xa4n. It is possible to choose the same pair (i,j) more than once.   Add ai to aj. In other words, j-th element of the array becomes equal to ai+aj. For example, if you are given array [1,\xe2\x88\x921,0], you can transform it only to [1,\xe2\x88\x921,\xe2\x88\x921], [1,0,0] and [1,\xe2\x88\x921,1] by one operation.Anton wants to predict if it is possible to apply some number (zero or more) of these operations to the array a so that it becomes equal to array b. Can you help him?" greedy,implementation 1100
819A "Mister B and Boring Game" "Sometimes Mister B has free evenings when he doesn\'t know what to do. Fortunately, Mister B found a new game, where the player can play against aliens.All characters in this game are lowercase English letters. There are two players: Mister B and his competitor.Initially the players have a string s consisting of the first a English letters in alphabetical order (for example, if a\xe2\x80\x89=\xe2\x80\x895, then s equals to ""abcde"").The players take turns appending letters to string s. Mister B moves first.Mister B must append exactly b letters on each his move. He can arbitrary choose these letters. His opponent adds exactly a letters on each move.Mister B quickly understood that his opponent was just a computer that used a simple algorithm. The computer on each turn considers the suffix of string s of length a and generates a string t of length a such that all letters in the string t are distinct and don\'t appear in the considered suffix. From multiple variants of t lexicographically minimal is chosen (if a\xe2\x80\x89=\xe2\x80\x894 and the suffix is ""bfdd"", the computer chooses string t equal to ""aceg""). After that the chosen string t is appended to the end of s.Mister B soon found the game boring and came up with the following question: what can be the minimum possible number of different letters in string s on the segment between positions l and r, inclusive. Letters of string s are numerated starting from 1." games,greedy 2200
1705E "Mark and Professor Koro" "After watching a certain anime before going to sleep, Mark dreams of standing in an old classroom with a blackboard that has a sequence of n positive integers a1,a2,\xe2\x80\xa6,an on it.Then, professor Koro comes in. He can perform the following operation:  select an integer x that appears at least 2 times on the board,  erase those 2 appearances, and  write x+1 on the board. Professor Koro then asks Mark the question, ""what is the maximum possible number that could appear on the board after some operations?""Mark quickly solves this question, but he is still slower than professor Koro. Thus, professor Koro decides to give Mark additional challenges. He will update the initial sequence of integers q times. Each time, he will choose positive integers k and l, then change ak to l. After each update, he will ask Mark the same question again.Help Mark answer these questions faster than Professor Koro!Note that the updates are persistent. Changes made to the sequence a will apply when processing future updates." "binary search,bitmasks,brute force,combinatorics,data structures,greedy" 2300
768B "Code For 1" "Jon fought bravely to rescue the wildlings who were attacked by the white-walkers at Hardhome. On his arrival, Sam tells him that he wants to go to Oldtown to train at the Citadel to become a maester, so he can return and take the deceased Aemon\'s place as maester of Castle Black. Jon agrees to Sam\'s proposal and Sam sets off his journey to the Citadel. However becoming a trainee at the Citadel is not a cakewalk and hence the maesters at the Citadel gave Sam a problem to test his eligibility. Initially Sam has a list with a single element n. Then he has to perform certain operations on this list. In each operation Sam must remove any element x, such that x\xe2\x80\x89>\xe2\x80\x891, from the list and insert at the same position , ,  sequentially. He must continue with these operations until all the elements in the list are either 0 or 1.Now the masters want the total number of 1s in the range l to r (1-indexed). Sam wants to become a maester but unfortunately he cannot solve this problem. Can you help Sam to pass the eligibility test?" "constructive algorithms,dfs and similar,divide and conquer" 1600
1253C "Sweets Eating" "Tsumugi brought n delicious sweets to the Light Music Club. They are numbered from 1 to n, where the i-th sweet has a sugar concentration described by an integer ai.Yui loves sweets, but she can eat at most m sweets each day for health reasons.Days are 1-indexed (numbered 1,2,3,\xe2\x80\xa6). Eating the sweet i at the d-th day will cause a sugar penalty of (d\xe2\x8b\x85ai), as sweets become more sugary with time. A sweet can be eaten at most once.The total sugar penalty will be the sum of the individual penalties of each sweet eaten.Suppose that Yui chooses exactly k sweets, and eats them in any order she wants. What is the minimum total sugar penalty she can get?Since Yui is an undecided girl, she wants you to answer this question for every value of k between 1 and n." dp,greedy,math,sortings 1500
1872B "The Corridor or There and Back Again" "You are in a corridor that extends infinitely to the right, divided into square rooms. You start in room 1, proceed to room k, and then return to room 1. You can choose the value of k. Moving to an adjacent room takes 1 second.Additionally, there are n traps in the corridor: the i-th trap is located in room di and will be activated si seconds after you enter the room di. Once a trap is activated, you cannot enter or exit a room with that trap.  A schematic representation of a possible corridor and your path to room k and back. Determine the maximum value of k that allows you to travel from room 1 to room k and then return to room 1 safely.For instance, if n=1 and d1=2,s1=2, you can proceed to room k=2 and return safely (the trap will activate at the moment 1+s1=1+2=3, it can\'t prevent you to return back). But if you attempt to reach room k=3, the trap will activate at the moment 1+s1=1+2=3, preventing your return (you would attempt to enter room 2 on your way back at second 3, but the activated trap would block you). Any larger value for k is also not feasible. Thus, the answer is k=2." greedy,implementation 900
868C "Qualification Rounds" "Snark and Philip are preparing the problemset for the upcoming pre-qualification round for semi-quarter-finals. They have a bank of n problems, and they want to select any non-empty subset of it as a problemset.k experienced teams are participating in the contest. Some of these teams already know some of the problems. To make the contest interesting for them, each of the teams should know at most half of the selected problems.Determine if Snark and Philip can make an interesting problemset!" "bitmasks,brute force,constructive algorithms,dp" 1500
2024B "Buying Lemonade" "There is a vending machine that sells lemonade. The machine has a total of n slots. You know that initially, the i-th slot contains ai cans of lemonade. There are also n buttons on the machine, each button corresponds to a slot, with exactly one button corresponding to each slot. Unfortunately, the labels on the buttons have worn off, so you do not know which button corresponds to which slot.When you press the button corresponding to the i-th slot, one of two events occurs: If there is a can of lemonade in the i-th slot, it will drop out and you will take it. At this point, the number of cans in the i-th slot decreases by 1. If there are no cans of lemonade left in the i-th slot, nothing will drop out. After pressing, the can drops out so quickly that it is impossible to track from which slot it fell. The contents of the slots are hidden from your view, so you cannot see how many cans are left in each slot. The only thing you know is the initial number of cans in the slots: a1,a2,\xe2\x80\xa6,an.Determine the minimum number of button presses needed to guarantee that you receive at least k cans of lemonade.Note that you can adapt your strategy during the button presses based on whether you received a can or not. It is guaranteed that there are at least k cans of lemonade in total in the machine. In other words, k\xe2\x89\xa4a1+a2+\xe2\x80\xa6+an." "binary search,constructive algorithms,sortings" 1100
153D "Date Change" "You are given a date in ""DD.MM.YYYY"" (""day.month.year"") format and a number of days shift you have to add to this date. Output the resulting date." "*special problem" 2000
311E Biologist "SmallR is a biologist. Her latest research finding is how to change the sex of dogs. In other words, she can change female dogs into male dogs and vice versa.She is going to demonstrate this technique. Now SmallR has n dogs, the costs of each dog\'s change may be different. The dogs are numbered from 1 to n. The cost of change for dog i is vi RMB. By the way, this technique needs a kind of medicine which can be valid for only one day. So the experiment should be taken in one day and each dog can be changed at most once.This experiment has aroused extensive attention from all sectors of society. There are m rich folks which are suspicious of this experiment. They all want to bet with SmallR forcibly. If SmallR succeeds, the i-th rich folk will pay SmallR wi RMB. But it\'s strange that they have a special method to determine whether SmallR succeeds. For i-th rich folk, in advance, he will appoint certain ki dogs and certain one gender. He will think SmallR succeeds if and only if on some day the ki appointed dogs are all of the appointed gender. Otherwise, he will think SmallR fails.If SmallR can\'t satisfy some folk that isn\'t her friend, she need not pay him, but if someone she can\'t satisfy is her good friend, she must pay g RMB to him as apologies for her fail.Then, SmallR hope to acquire money as much as possible by this experiment. Please figure out the maximum money SmallR can acquire. By the way, it is possible that she can\'t obtain any money, even will lose money. Then, please give out the minimum money she should lose." flows 2300
1660C "Get an Even String" "A string a=a1a2\xe2\x80\xa6an is called even if it consists of a concatenation (joining) of strings of length 2 consisting of the same characters. In other words, a string a is even if two conditions are satisfied at the same time:  its length n is even;  for all odd i (1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921), ai=ai+1 is satisfied. For example, the following strings are even: """" (empty string), ""tt"", ""aabb"", ""oooo"", and ""ttrrrroouuuuuuuukk"". The following strings are not even: ""aaa"", ""abab"" and ""abba"".Given a string s consisting of lowercase Latin letters. Find the minimum number of characters to remove from the string s to make it even. The deleted characters do not have to be consecutive." dp,greedy,strings 1300
1425A "Arena of Greed" "Lately, Mr. Chanek frequently plays the game Arena of Greed. As the name implies, the game\'s goal is to find the greediest of them all, who will then be crowned king of Compfestnesia.The game is played by two people taking turns, where Mr. Chanek takes the first turn. Initially, there is a treasure chest containing N gold coins. The game ends if there are no more gold coins in the chest. In each turn, the players can make one of the following moves:  Take one gold coin from the chest.  Take half of the gold coins on the chest. This move is only available if the number of coins in the chest is even. Both players will try to maximize the number of coins they have. Mr. Chanek asks your help to find the maximum number of coins he can get at the end of the game if both he and the opponent plays optimally." games,greedy 1400
1704A "Two 0-1 Sequences" "AquaMoon has two binary sequences a and b, which contain only 0 and 1. AquaMoon can perform the following two operations any number of times (a1 is the first element of a, a2 is the second element of a, and so on): Operation 1: if a contains at least two elements, change a2 to min(a1,a2), and remove the first element of a. Operation 2: if a contains at least two elements, change a2 to max(a1,a2), and remove the first element of a.Note that after a removal of the first element of a, the former a2 becomes the first element of a, the former a3 becomes the second element of a and so on, and the length of a reduces by one.Determine if AquaMoon can make a equal to b by using these operations." "constructive algorithms,greedy" 800
343B "Alternating Current" "Mad scientist Mike has just finished constructing a new device to search for extraterrestrial intelligence! He was in such a hurry to launch it for the first time that he plugged in the power wires without giving it a proper glance and started experimenting right away. After a while Mike observed that the wires ended up entangled and now have to be untangled again.The device is powered by two wires ""plus"" and ""minus"". The wires run along the floor from the wall (on the left) to the device (on the right). Both the wall and the device have two contacts in them on the same level, into which the wires are plugged in some order. The wires are considered entangled if there are one or more places where one wire runs above the other one. For example, the picture below has four such places (top view):  Mike knows the sequence in which the wires run above each other. Mike also noticed that on the left side, the ""plus"" wire is always plugged into the top contact (as seen on the picture). He would like to untangle the wires without unplugging them and without moving the device. Determine if it is possible to do that. A wire can be freely moved and stretched on the floor, but cannot be cut.To understand the problem better please read the notes to the test samples." "data structures,greedy,implementation" 1600
1811B "Conveyor Belts" "Conveyor matrix mn is matrix of size n\xc3\x97n, where n is an even number. The matrix consists of concentric ribbons moving clockwise.In other words, the conveyor matrix for n=2 is simply a matrix 2\xc3\x972, whose cells form a cycle of length 4 clockwise. For any natural k\xe2\x89\xa52, the matrix m2k is obtained by adding to the matrix m2k\xe2\x88\x922 an outer layer forming a clockwise cycle.  The conveyor matrix 8\xc3\x978.   You are standing in a cell with coordinates x1,y1 and you want to get into a cell with coordinates x2,y2. A cell has coordinates x,y if it is located at the intersection of the xth row and the yth column.Standing on some cell, every second you will move to the cell next in the direction of movement of the tape on which you are. You can also move to a neighboring cell by spending one unit of energy. Movements happen instantly and you can make an unlimited number of them at any time.Your task is to find the minimum amount of energy that will have to be spent to get from the cell with coordinates x1,y1 to the cell with coordinates x2,y2.For example, n=8 initially you are in a cell with coordinates 1,3 and you want to get into a cell with coordinates 6,4. You can immediately make 2 movements, once you are in a cell with coordinates 3,3, and then after 8 seconds you will be in the right cell." implementation,math 1000
952G "Puzzling Language" "In this problem you will write a simple code generator for a 2D programming language derived from Brainfuck.The code in this language is a rectangular grid of characters \'.\' and \'X\'. The code is converted to a Brainfuck program as follows: the characters are read in the usual order (top to bottom, left to right), and each \'X\' character is converted a Brainfuck instruction to be executed. The instruction is defined by the left, top and right neighbors of the \'X\' character using the following conversion table:  You are given a string. Output a program in the described language which prints this string.You can download the language interpreter used for judging here: https://assets.codeforces.com/rounds/952/puzzling-interpreter.cpp (use C++11 to compile the code). Note several implementation details: The first step of the language interpretation is conversion to a Brainfuck program, which is then executed. The code must be rectangular, with all lines of the same length. It can have at most 10,000 lines and 10,000 columns, and can have at most 500,000 \'X\' characters. The code has toroidal topology, i.e. the \'X\' on the first line will have top neighbor in the last line. Brainfuck interpreter has 30000 memory cells which store integers from 0 to 255 with increment/decrement done modulo 256. Console input (, command) is allowed in Brainfuck code but has no effect when executed." "constructive algorithms" 2200
839E "Mother of Dragons" "There are n castles in the Lannister\'s Kingdom and some walls connect two castles, no two castles are connected by more than one wall, no wall connects a castle to itself. Sir Jaime Lannister has discovered that Daenerys Targaryen is going to attack his kingdom soon. Therefore he wants to defend his kingdom. He has k liters of a strange liquid. He wants to distribute that liquid among the castles, so each castle may contain some liquid (possibly zero or non-integer number of liters). After that the stability of a wall is defined as follows: if the wall connects two castles a and b, and they contain x and y liters of that liquid, respectively, then the strength of that wall is x\xc2\xb7y.Your task is to print the maximum possible sum of stabilities of the walls that Sir Jaime Lannister can achieve." "brute force,graphs,math,meet-in-the-middle" 2700
568C "New Language" "Living in Byteland was good enough to begin with, but the good king decided to please his subjects and to introduce a national language. He gathered the best of wise men, and sent an expedition to faraway countries, so that they would find out all about how a language should be designed.After some time, the wise men returned from the trip even wiser. They locked up for six months in the dining room, after which they said to the king: ""there are a lot of different languages, but almost all of them have letters that are divided into vowels and consonants; in a word, vowels and consonants must be combined correctly.""There are very many rules, all of them have exceptions, but our language will be deprived of such defects! We propose to introduce a set of formal rules of combining vowels and consonants, and include in the language all the words that satisfy them.The rules of composing words are: The letters are divided into vowels and consonants in some certain way; All words have a length of exactly n; There are m rules of the form (pos1,\xe2\x80\x89t1,\xe2\x80\x89pos2,\xe2\x80\x89t2). Each rule is: if the position pos1 has a letter of type t1, then the position pos2 has a letter of type t2.You are given some string s of length n, it is not necessarily a correct word of the new language. Among all the words of the language that lexicographically not smaller than the string s, find the minimal one in lexicographic order." 2-sat,greedy 2600
412A Poster "The R1 company has recently bought a high rise building in the centre of Moscow for its main office. It\'s time to decorate the new office, and the first thing to do is to write the company\'s slogan above the main entrance to the building.The slogan of the company consists of n characters, so the decorators hung a large banner, n meters wide and 1 meter high, divided into n equal squares. The first character of the slogan must be in the first square (the leftmost) of the poster, the second character must be in the second square, and so on.Of course, the R1 programmers want to write the slogan on the poster themselves. To do this, they have a large (and a very heavy) ladder which was put exactly opposite the k-th square of the poster. To draw the i-th character of the slogan on the poster, you need to climb the ladder, standing in front of the i-th square of the poster. This action (along with climbing up and down the ladder) takes one hour for a painter. The painter is not allowed to draw characters in the adjacent squares when the ladder is in front of the i-th square because the uncomfortable position of the ladder may make the characters untidy. Besides, the programmers can move the ladder. In one hour, they can move the ladder either a meter to the right or a meter to the left.Drawing characters and moving the ladder is very tiring, so the programmers want to finish the job in as little time as possible. Develop for them an optimal poster painting plan!" greedy,implementation 900
1075A "The King\'s Race" "On a chessboard with a width of nn and a height of nn, rows are numbered from bottom to top from 11 to nn, columns are numbered from left to right from 11 to nn. Therefore, for each cell of the chessboard, you can assign the coordinates (r,c)(r,c), where rr is the number of the row, and cc is the number of the column.The white king has been sitting in a cell with (1,1)(1,1) coordinates for a thousand years, while the black king has been sitting in a cell with (n,n)(n,n) coordinates. They would have sat like that further, but suddenly a beautiful coin fell on the cell with coordinates (x,y)(x,y)...Each of the monarchs wanted to get it, so they decided to arrange a race according to slightly changed chess rules:As in chess, the white king makes the first move, the black king makes the second one, the white king makes the third one, and so on. However, in this problem, kings can stand in adjacent cells or even in the same cell at the same time.The player who reaches the coin first will win, that is to say, the player who reaches the cell with the coordinates (x,y)(x,y) first will win.Let\'s recall that the king is such a chess piece that can move one cell in all directions, that is, if the king is in the (a,b)(a,b) cell, then in one move he can move from (a,b)(a,b) to the cells (a+1,b)(a+1,b), (a\xe2\x88\x921,b)(a\xe2\x88\x921,b), (a,b+1)(a,b+1), (a,b\xe2\x88\x921)(a,b\xe2\x88\x921), (a+1,b\xe2\x88\x921)(a+1,b\xe2\x88\x921), (a+1,b+1)(a+1,b+1), (a\xe2\x88\x921,b\xe2\x88\x921)(a\xe2\x88\x921,b\xe2\x88\x921), or (a\xe2\x88\x921,b+1)(a\xe2\x88\x921,b+1). Going outside of the field is prohibited.Determine the color of the king, who will reach the cell with the coordinates (x,y)(x,y) first, if the white king moves first." implementation,math 800
1331H "It\'s showtime" "You are given a mysterious language (codenamed ""UnknownX"") available in ""Custom Test"" tab. Find out what this language is, and use it to solve the following problem.You are given an integer input=1000\xe2\x88\x97n+mod (1\xe2\x89\xa4n,mod\xe2\x89\xa4999). Calculate double factorial of n modulo mod." "*special problem" -999
263C "Circle of Numbers" "One day Vasya came up to the blackboard and wrote out n distinct integers from 1 to n in some order in a circle. Then he drew arcs to join the pairs of integers (a,\xe2\x80\x89b) (a\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89b), that are either each other\'s immediate neighbors in the circle, or there is number c, such that a and \xd1\x81 are immediate neighbors, and b and c are immediate neighbors. As you can easily deduce, in the end Vasya drew 2\xc2\xb7n arcs.For example, if the numbers are written in the circle in the order 1,\xe2\x80\x892,\xe2\x80\x893,\xe2\x80\x894,\xe2\x80\x895 (in the clockwise direction), then the arcs will join pairs of integers (1,\xe2\x80\x892), (2,\xe2\x80\x893), (3,\xe2\x80\x894), (4,\xe2\x80\x895), (5,\xe2\x80\x891), (1,\xe2\x80\x893), (2,\xe2\x80\x894), (3,\xe2\x80\x895), (4,\xe2\x80\x891) and (5,\xe2\x80\x892).Much time has passed ever since, the numbers we wiped off the blackboard long ago, but recently Vasya has found a piece of paper with 2\xc2\xb7n written pairs of integers that were joined with the arcs on the board. Vasya asks you to find the order of numbers in the circle by these pairs." "brute force,dfs and similar,implementation" 2000
846E "Chemistry in Berland" "Igor is a post-graduate student of chemistry faculty in Berland State University (BerSU). He needs to conduct a complicated experiment to write his thesis, but laboratory of BerSU doesn\'t contain all the materials required for this experiment.Fortunately, chemical laws allow material transformations (yes, chemistry in Berland differs from ours). But the rules of transformation are a bit strange.Berland chemists are aware of n materials, numbered in the order they were discovered. Each material can be transformed into some other material (or vice versa). Formally, for each i (2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) there exist two numbers xi and ki that denote a possible transformation: ki kilograms of material xi can be transformed into 1 kilogram of material i, and 1 kilogram of material i can be transformed into 1 kilogram of material xi. Chemical processing equipment in BerSU allows only such transformation that the amount of resulting material is always an integer number of kilograms.For each i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) Igor knows that the experiment requires ai kilograms of material i, and the laboratory contains bi kilograms of this material. Is it possible to conduct an experiment after transforming some materials (or none)?" "dfs and similar,greedy,trees" 2300
1084A "The Fair Nut and Elevator" "The Fair Nut lives in n story house. ai people live on the i-th floor of the house. Every person uses elevator twice a day: to get from the floor where he/she lives to the ground (first) floor and to get from the first floor to the floor where he/she lives, when he/she comes back home in the evening. It was decided that elevator, when it is not used, will stay on the x-th floor, but x hasn\'t been chosen yet. When a person needs to get from floor a to floor b, elevator follows the simple algorithm:   Moves from the x-th floor (initially it stays on the x-th floor) to the a-th and takes the passenger.  Moves from the a-th floor to the b-th floor and lets out the passenger (if a equals b, elevator just opens and closes the doors, but still comes to the floor from the x-th floor).  Moves from the b-th floor back to the x-th.  The elevator never transposes more than one person and always goes back to the floor x before transposing a next passenger. The elevator spends one unit of electricity to move between neighboring floors. So moving from the a-th floor to the b-th floor requires |a\xe2\x88\x92b| units of electricity.Your task is to help Nut to find the minimum number of electricity units, that it would be enough for one day, by choosing an optimal the x-th floor. Don\'t forget than elevator initially stays on the x-th floor." "brute force,implementation" 1000
1955H "The Most Reckless Defense" "You are playing a very popular Tower Defense game called ""Runnerfield 2"". In this game, the player sets up defensive towers that attack enemies moving from a certain starting point to the player\'s base.You are given a grid of size n\xc3\x97m, on which k towers are already placed and a path is laid out through which enemies will move. The cell at the intersection of the x-th row and the y-th column is denoted as (x,y).Each second, a tower deals pi units of damage to all enemies within its range. For example, if an enemy is located at cell (x,y) and a tower is at (xi,yi) with a range of r, then the enemy will take damage of pi if (x\xe2\x88\x92xi)2+(y\xe2\x88\x92yi)2\xe2\x89\xa4r2.Enemies move from cell (1,1) to cell (n,m), visiting each cell of the path exactly once. An enemy instantly moves to an adjacent cell horizontally or vertically, but before doing so, it spends one second in the current cell. If its health becomes zero or less during this second, the enemy can no longer move. The player loses if an enemy reaches cell (n,m) and can make one more move.By default, all towers have a zero range, but the player can set a tower\'s range to an integer r (r>0), in which case the health of all enemies will increase by 3r. However, each r can only be used for at most one tower.Suppose an enemy has a base health of h units. If the tower ranges are 2, 4, and 5, then the enemy\'s health at the start of the path will be h+32+34+35=h+9+81+243=h+333. The choice of ranges is made once before the appearance of enemies and cannot be changed after the game starts.Find the maximum amount of base health h for which it is possible to set the ranges so that the player does not lose when an enemy with health h passes through (without considering the additions for tower ranges)." "bitmasks,brute force,constructive algorithms,dp,flows,graph matchings,shortest paths" 2300
1209C "Paint the Digits" "You are given a sequence of n digits d1d2\xe2\x80\xa6dn. You need to paint all the digits in two colors so that:  each digit is painted either in the color 1 or in the color 2;  if you write in a row from left to right all the digits painted in the color 1, and then after them all the digits painted in the color 2, then the resulting sequence of n digits will be non-decreasing (that is, each next digit will be greater than or equal to the previous digit). For example, for the sequence d=914 the only valid coloring is 211 (paint in the color 1 two last digits, paint in the color 2 the first digit). But 122 is not a valid coloring (9 concatenated with 14 is not a non-decreasing sequence).It is allowed that either of the two colors is not used at all. Digits painted in the same color are not required to have consecutive positions.Find any of the valid ways to paint the given sequence of digits or determine that it is impossible to do." "constructive algorithms,greedy,implementation" 1500
1704H2 "Game of AI (hard version)" "This is the hard version of this problem. The difference between easy and hard versions is the constraint on k and the time limit. Notice that you need to calculate the answer for all positive integers n\xe2\x88\x88[1,k] in this version. You can make hacks only if both versions of the problem are solved.Cirno is playing a war simulator game with n towers (numbered from 1 to n) and n bots (numbered from 1 to n). The i-th tower is initially occupied by the i-th bot for 1\xe2\x89\xa4i\xe2\x89\xa4n.Before the game, Cirno first chooses a permutation p=[p1,p2,\xe2\x80\xa6,pn] of length n (A permutation of length n is an array of length n where each integer between 1 and n appears exactly once). After that, she can choose a sequence a=[a1,a2,\xe2\x80\xa6,an] (1\xe2\x89\xa4ai\xe2\x89\xa4n and ai\xe2\x89\xa0i for all 1\xe2\x89\xa4i\xe2\x89\xa4n).The game has n rounds of attacks. In the i-th round, if the pi-th bot is still in the game, it will begin its attack, and as the result the api-th tower becomes occupied by the pi-th bot; the bot that previously occupied the api-th tower will no longer occupy it. If the pi-th bot is not in the game, nothing will happen in this round.After each round, if a bot doesn\'t occupy any towers, it will be eliminated and leave the game. Please note that no tower can be occupied by more than one bot, but one bot can occupy more than one tower during the game.At the end of the game, Cirno will record the result as a sequence b=[b1,b2,\xe2\x80\xa6,bn], where bi is the number of the bot that occupies the i-th tower at the end of the game.However, as a mathematics master, she wants you to solve the following counting problem instead of playing games:Count the number of different pairs of sequences a, b from all possible choices of sequence a and permutation p.Calculate the answers for all n such that 1\xe2\x89\xa4n\xe2\x89\xa4k. Since these numbers may be large, output them modulo M." combinatorics,fft,math 3500
115C Plumber "Little John aspires to become a plumber! Today he has drawn a grid consisting of n rows and m columns, consisting of n\xe2\x80\x89\xc3\x97\xe2\x80\x89m square cells.In each cell he will draw a pipe segment. He can only draw four types of segments numbered from 1 to 4, illustrated as follows:  Each pipe segment has two ends, illustrated by the arrows in the picture above. For example, segment 1 has ends at top and left side of it.Little John considers the piping system to be leaking if there is at least one pipe segment inside the grid whose end is not connected to another pipe\'s end or to the border of the grid. The image below shows an example of leaking and non-leaking systems of size 1\xe2\x80\x89\xc3\x97\xe2\x80\x892.  Now, you will be given the grid that has been partially filled by Little John. Each cell will either contain one of the four segments above, or be empty. Find the number of possible different non-leaking final systems after Little John finishes filling all of the empty cells with pipe segments. Print this number modulo 1000003 (106\xe2\x80\x89+\xe2\x80\x893).Note that rotations or flipping of the grid are not allowed and so two configurations that are identical only when one of them has been rotated or flipped either horizontally or vertically are considered two different configurations." math 2200
32D Constellation "A star map in Berland is a checked field n\xe2\x80\x89\xc3\x97\xe2\x80\x89m squares. In each square there is or there is not a star. The favourite constellation of all Berland\'s astronomers is the constellation of the Cross. This constellation can be formed by any 5 stars so, that for some integer x (radius of the constellation) the following is true:   the 2nd is on the same vertical line as the 1st, but x squares up  the 3rd is on the same vertical line as the 1st, but x squares down  the 4th is on the same horizontal line as the 1st, but x squares left  the 5th is on the same horizontal line as the 1st, but x squares right Such constellations can be very numerous, that\'s why they are numbered with integers from 1 on the following principle: when two constellations are compared, the one with a smaller radius gets a smaller index; if their radii are equal \xe2\x80\x94 the one, whose central star if higher than the central star of the other one; if their central stars are at the same level \xe2\x80\x94 the one, whose central star is to the left of the central star of the other one.Your task is to find the constellation with index k by the given Berland\'s star map." implementation 1600
306B Optimizer "A process RAM is a sequence of bytes that are indexed from 1 to n. Polycarpus\'s program contains such instructions as ""memset"", that is, the operations of filling memory cells on a segment with some value. The details are: the code only contains m instructions that look like ""set13 a_i l_i"". Instruction i fills a continuous memory segment of length li, starting from cell number ai, (that it cells with numbers ai,\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x89li\xe2\x80\x89-\xe2\x80\x891) with values 13.In Polycarpus\'s code, the optimizer\'s task is to remove the maximum number of instructions from his code in such a way that the remaining instructions set value 13 in all the memory bytes that got this value from the code before the optimization. Also, the value 13 should be set only in the memory bytes that got this value from the code before the optimization. Your task is to implement the optimizer for such program." "data structures,greedy,sortings" 2100
472E "Design Tutorial: Learn from a Game" "One way to create task is to learn from game. You should pick a game and focus on part of the mechanic of that game, then it might be a good task.Let\'s have a try. Puzzle and Dragon was a popular game in Japan, we focus on the puzzle part of that game, it is a tile-matching puzzle.(Picture from Wikipedia page: http://en.wikipedia.org/wiki/Puzzle_&_Dragons)There is an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m board which consists of orbs. During the game you can do the following move. In the beginning of move you touch a cell of the board, then you can move your finger to one of the adjacent cells (a cell not on the boundary has 8 adjacent cells), then you can move your finger from the current cell to one of the adjacent cells one more time, and so on. Each time you move your finger from a cell to another cell, the orbs in these cells swap with each other. In other words whatever move you make, the orb in the cell you are touching never changes.The goal is to achieve such kind of pattern that the orbs will be cancelled and your monster will attack the enemy, but we don\'t care about these details. Instead, we will give you the initial board as an input and the target board as an output. Your goal is to determine whether there is a way to reach the target in a single move." "constructive algorithms,implementation" 2800
177A2 "Good Matrix Elements" "The Smart Beaver from ABBYY got hooked on square matrices. Now he is busy studying an n\xe2\x80\x89\xc3\x97\xe2\x80\x89n size matrix, where n is odd. The Smart Beaver considers the following matrix elements good:    Elements of the main diagonal.   Elements of the secondary diagonal.   Elements of the ""middle"" row \xe2\x80\x94 the row which has exactly  rows above it and the same number of rows below it.   Elements of the ""middle"" column \xe2\x80\x94 the column that has exactly  columns to the left of it and the same number of columns to the right of it.    The figure shows a 5\xe2\x80\x89\xc3\x97\xe2\x80\x895 matrix.   The good elements are marked with green.  Help the Smart Beaver count the sum of good elements of the given matrix." implementation 800
975D Ghosts "Ghosts live in harmony and peace, they travel the space without any purpose other than scare whoever stands in their way.There are n ghosts in the universe, they move in the OXY plane, each one of them has its own velocity that does not change in time: \xe2\x86\x92V=Vx\xe2\x86\x92i+Vy\xe2\x86\x92j where Vx is its speed on the x-axis and Vy is on the y-axis.A ghost i has experience value EXi, which represent how many ghosts tried to scare him in his past. Two ghosts scare each other if they were in the same cartesian point at a moment of time.As the ghosts move with constant speed, after some moment of time there will be no further scaring (what a relief!) and the experience of ghost kind GX=\xe2\x88\x91ni=1EXi will never increase.Tameem is a red giant, he took a picture of the cartesian plane at a certain moment of time T, and magically all the ghosts were aligned on a line of the form y=a\xe2\x8b\x85x+b. You have to compute what will be the experience index of the ghost kind GX in the indefinite future, this is your task for today.Note that when Tameem took the picture, GX may already be greater than 0, because many ghosts may have scared one another at any moment between [\xe2\x88\x92\xe2\x88\x9e,T]." geometry,math 2000
1817C "Similar Polynomials" "A polynomial A(x) of degree d is an expression of the form A(x)=a0+a1x+a2x2+\xe2\x8b\xaf+adxd, where ai are integers, and ad\xe2\x89\xa00. Two polynomials A(x) and B(x) are called similar if there is an integer s such that for any integer x it holds thatB(x)\xe2\x89\xa1A(x+s)(mod109+7).For two similar polynomials A(x) and B(x) of degree d, you\'re given their values in the points x=0,1,\xe2\x80\xa6,d modulo 109+7.Find a value s such that B(x)\xe2\x89\xa1A(x+s)(mod109+7) for all integers x." combinatorics,math 2400
1676F "Longest Strike" "Given an array a of length n and an integer k, you are tasked to find any two numbers l and r (l\xe2\x89\xa4r) such that:   For each x (l\xe2\x89\xa4x\xe2\x89\xa4r), x appears in a at least k times (i.e. k or more array elements are equal to x).  The value r\xe2\x88\x92l is maximized. If no numbers satisfy the conditions, output -1.For example, if a=[11,11,12,13,13,14,14] and k=2, then:   for l=12, r=14 the first condition fails because 12 does not appear at least k=2 times.  for l=13, r=14 the first condition holds, because 13 occurs at least k=2 times in a and 14 occurs at least k=2 times in a.  for l=11, r=11 the first condition holds, because 11 occurs at least k=2 times in a. A pair of l and r for which the first condition holds and r\xe2\x88\x92l is maximal is l=13, r=14." "data structures,greedy,implementation,sortings,two pointers" 1300
946A Partition "You are given a sequence a consisting of n integers. You may partition this sequence into two sequences b and c in such a way that every element belongs exactly to one of these sequences. Let B be the sum of elements belonging to b, and C be the sum of elements belonging to c (if some of these sequences is empty, then its sum is 0). What is the maximum possible value of B\xe2\x80\x89-\xe2\x80\x89C?" greedy 800
1593E "Gardener and Tree" "A tree is an undirected connected graph in which there are no cycles. This problem is about non-rooted trees. A leaf of a tree is a vertex that is connected to at most one vertex.The gardener Vitaly grew a tree from n vertices. He decided to trim the tree. To do this, he performs a number of operations. In one operation, he removes all leaves of the tree.  Example of a tree. For example, consider the tree shown in the figure above. The figure below shows the result of applying exactly one operation to the tree.  The result of applying the operation ""remove all leaves"" to the tree. Note the special cases of the operation:  applying an operation to an empty tree (of 0 vertices) does not change it;  applying an operation to a tree of one vertex removes this vertex (this vertex is treated as a leaf);  applying an operation to a tree of two vertices removes both vertices (both vertices are treated as leaves). Vitaly applied k operations sequentially to the tree. How many vertices remain?" "brute force,data structures,dfs and similar,greedy,implementation,trees" 1600
1381A1 "Prefix Flip (Easy Version)" "This is the easy version of the problem. The difference between the versions is the constraint on n and the required number of operations. You can make hacks only if all versions of the problem are solved.There are two binary strings a and b of length n (a binary string is a string consisting of symbols 0 and 1). In an operation, you select a prefix of a, and simultaneously invert the bits in the prefix (0 changes to 1 and 1 changes to 0) and reverse the order of the bits in the prefix.For example, if a=001011 and you select the prefix of length 3, it becomes 011011. Then if you select the entire string, it becomes 001001.Your task is to transform the string a into b in at most 3n operations. It can be proved that it is always possible." "constructive algorithms,data structures,strings" 1300
1202D "Print a 1337-string..." "The subsequence is a sequence that can be derived from another sequence by deleting some elements without changing the order of the remaining elements.You are given an integer n. You have to find a sequence s consisting of digits {1,3,7} such that it has exactly n subsequences equal to 1337.For example, sequence 337133377 has 6 subsequences equal to 1337:   3371_33_3_77_ (you can remove the second and fifth characters);  3371_3_33_77_ (you can remove the third and fifth characters);  3371_3_3_377_ (you can remove the fourth and fifth characters);  3371_33_3_7_7 (you can remove the second and sixth characters);  3371_3_33_7_7 (you can remove the third and sixth characters);  3371_3_3_37_7 (you can remove the fourth and sixth characters). Note that the length of the sequence s must not exceed 105.You have to answer t independent queries." "combinatorics,constructive algorithms,math,strings" 1900
1063E "Lasers and Mirrors" "Oleg came to see the maze of mirrors. The maze is a n by n room in which each cell is either empty or contains a mirror connecting opposite corners of this cell. Mirrors in this maze reflect light in a perfect way, which causes the interesting visual effects and contributes to the loss of orientation in the maze.Oleg is a person of curious nature, so he decided to install n lasers facing internal of the maze on the south wall of the maze. On the north wall of the maze, Oleg installed n receivers, also facing internal of the maze. Let\'s number lasers and receivers from west to east with distinct integers from 1 to n. Each laser sends a beam of some specific kind and receiver with number ai should receive the beam sent from laser number i. Since two lasers\' beams can\'t come to the same receiver, these numbers form a permutation \xe2\x80\x94 each of the receiver numbers occurs exactly once.You came to the maze together with Oleg. Help him to place the mirrors in the initially empty maze so that the maximum number of lasers\' beams will come to the receivers they should. There are no mirrors outside the maze, so if the laser beam leaves the maze, it will not be able to go back." "constructive algorithms,math" 3000
345B Triskaidekaphobia "Triskaidekaphobia is a fear of number 13. Ordinary people who suffer from this phobia feel uncomfortable around numbers 13, 130, 513 etc, but you, being a programmer, take this fear one step further. For example, consider number 7. It\'s ok when written in decimal, but written in base 4 it becomes 13, the dreadful number!The more you think about it, the worse it looks. Number 100 has as many as 13 notations which contain 13! And there are numbers which have 13 in infinite number of their notations! Luckily, you can do any math in binary, which is completely safe from the nasty number. But still, you want to be able to estimate the level of nastiness of any number. Your task is: given an integer n, find the number of different integer bases b (b\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x892) for which n, written in base b, contains at least one 13. Assume that ""digits"" of the number in bases larger than 10 are written not as letters but as decimal numbers; thus, 30 in base 16 is not 1E but (1)(14) or simply 114. Please note, that 13 must be present as a substring of notation, not a subsequence (123 doesn\'t contain 13)." "*special problem" 2100
498E "Stairs and Lines" "You are given a figure on a grid representing stairs consisting of 7 steps. The width of the stair on height i is wi squares. Formally, the figure is created by consecutively joining rectangles of size wi\xe2\x80\x89\xc3\x97\xe2\x80\x89i so that the wi sides lie on one straight line. Thus, for example, if all wi\xe2\x80\x89=\xe2\x80\x891, the figure will look like that (different colors represent different rectangles):  And if w\xe2\x80\x89=\xe2\x80\x89{5,\xe2\x80\x891,\xe2\x80\x890,\xe2\x80\x893,\xe2\x80\x890,\xe2\x80\x890,\xe2\x80\x891}, then it looks like that:  Find the number of ways to color some borders of the figure\'s inner squares so that no square had all four borders colored. The borders of the squares lying on the border of the figure should be considered painted. The ways that differ with the figure\'s rotation should be considered distinct." dp,matrices 2700
1208E "Let Them Slide" "You are given n arrays that can have different sizes. You also have a table with w columns and n rows. The i-th array is placed horizontally in the i-th row. You can slide each array within its row as long as it occupies several consecutive cells and lies completely inside the table.You need to find the maximum sum of the integers in the j-th column for each j from 1 to w independently.  Optimal placements for columns 1, 2 and 3 are shown on the pictures from left to right. Note that you can exclude any array out of a column provided it remains in the window. In this case its value is considered to be zero." "data structures,implementation" 2200
242D Dispute "Valera has n counters numbered from 1 to n. Some of them are connected by wires, and each of the counters has a special button.Initially, all the counters contain number 0. When you press a button on a certain counter, the value it has increases by one. Also, the values recorded in all the counters, directly connected to it by a wire, increase by one.Valera and Ignat started having a dispute, the dispute is as follows. Ignat thought of a sequence of n integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. Valera should choose some set of distinct counters and press buttons on each of them exactly once (on other counters the buttons won\'t be pressed). If after that there is a counter with the number i, which has value ai, then Valera loses the dispute, otherwise he wins the dispute.Help Valera to determine on which counters he needs to press a button to win the dispute." "dfs and similar,graphs,greedy" 2100
1108F "MST Unification" "You are given an undirected weighted connected graph with n vertices and m edges without loops and multiple edges.The i-th edge is ei=(ui,vi,wi); the distance between vertices ui and vi along the edge ei is wi (1\xe2\x89\xa4wi). The graph is connected, i.\xe2\x80\x89e. for any pair of vertices, there is at least one path between them consisting only of edges of the given graph.A minimum spanning tree (MST) in case of positive weights is a subset of the edges of a connected weighted undirected graph that connects all the vertices together and has minimum total cost among all such subsets (total cost is the sum of costs of chosen edges).You can modify the given graph. The only operation you can perform is the following: increase the weight of some edge by 1. You can increase the weight of each edge multiple (possibly, zero) times.Suppose that the initial MST cost is k. Your problem is to increase weights of some edges with minimum possible number of operations in such a way that the cost of MST in the obtained graph remains k, but MST is unique (it means that there is only one way to choose MST in the obtained graph).Your problem is to calculate the minimum number of operations required to do it." "binary search,dsu,graphs,greedy" 2100
1510B "Button Lock" "You are standing in front of the room with great treasures. The only thing stopping you is the door with a push-button combination lock. This lock has d buttons with digits from 0 to d\xe2\x88\x921. Whenever you press a button, it stays pushed down. You can not pop back up just one button, but there is a ""RESET"" button \xe2\x80\x94 pressing it pops up all other buttons. Initially, no buttons are pushed down.The door instantly opens when some specific set of digits is pushed down. Sadly, you don\'t know the password for it. Having read the documentation for this specific lock, you found out that there are n possible passwords for this particular lock. Find the shortest sequence of button presses, such that all possible passwords appear at least once during its execution. Any shortest correct sequence of button presses will be accepted." "flows,graph matchings,graphs" 2600
15E Triangles "Last summer Peter was at his granny\'s in the country, when a wolf attacked sheep in the nearby forest. Now he fears to walk through the forest, to walk round the forest, even to get out of the house. He explains this not by the fear of the wolf, but by a strange, in his opinion, pattern of the forest that has n levels, where n is an even number.In the local council you were given an area map, where the granny\'s house is marked by point H, parts of dense forest are marked grey (see the picture to understand better).After a long time at home Peter decided to yield to his granny\'s persuasions and step out for a breath of fresh air. Being prudent, Peter plans the route beforehand. The route, that Peter considers the most suitable, has the following characteristics:   it starts and ends in the same place \xe2\x80\x94 the granny\'s house;  the route goes along the forest paths only (these are the segments marked black in the picture);  the route has positive length (to step out for a breath of fresh air Peter has to cover some distance anyway);  the route cannot cross itself;  there shouldn\'t be any part of dense forest within the part marked out by this route; You should find the amount of such suitable oriented routes modulo 1000000009.  The example of the area map for n\xe2\x80\x89=\xe2\x80\x8912 is given in the picture. Since the map has a regular structure, you can construct it for other n by analogy using the example." combinatorics,dp 2600
317C Balance "A system of n vessels with water is given. Several pairs of vessels are connected by tubes with transfusion mechanisms. One may transfer an integer amount of liters of water between two vessels connected by such tube (tube works in both directions). There might be multiple tubes between two vessels. Total number of tubes equals e. Volume of each vessel equals v liters. Of course, the amount of the water in any vessel cannot exceed v liters in the process of transfusions.Given the initial amounts ai of water in the vessels and the desired amounts bi find a sequence of transfusions that deals with the task. Total number of transfusions must not exceed 2\xc2\xb7n2." "constructive algorithms,dfs and similar,graphs,trees" 2500
908D "New Year and Arbitrary Arrangement" "You are given three integers k, pa and pb.You will construct a sequence with the following algorithm: Initially, start with the empty sequence. Each second, you do the following. With probability pa\xe2\x80\x89/\xe2\x80\x89(pa\xe2\x80\x89+\xe2\x80\x89pb), add \'a\' to the end of the sequence. Otherwise (with probability pb\xe2\x80\x89/\xe2\x80\x89(pa\xe2\x80\x89+\xe2\x80\x89pb)), add \'b\' to the end of the sequence.You stop once there are at least k subsequences that form \'ab\'. Determine the expected number of times \'ab\' is a subsequence in the resulting sequence. It can be shown that this can be represented by P\xe2\x80\x89/\xe2\x80\x89Q, where P and Q are coprime integers, and . Print the value of ." dp,math,probabilities 2200
571D Campus "Oscolcovo city has a campus consisting of n student dormitories, n universities and n military offices. Initially, the i-th dormitory belongs to the i-th university and is assigned to the i-th military office.Life goes on and the campus is continuously going through some changes. The changes can be of four types:  University aj merges with university bj. After that all the dormitories that belonged to university bj are assigned to to university aj, and university bj disappears.  Military office cj merges with military office dj. After that all the dormitories that were assigned to military office dj, are assigned to military office cj, and military office dj disappears.  Students of university xj move in dormitories. Lets kxj is the number of dormitories that belong to this university at the time when the students move in. Then the number of students in each dormitory of university xj increases by kxj (note that the more dormitories belong to the university, the more students move in each dormitory of the university).  Military office number yj conducts raids on all the dormitories assigned to it and takes all students from there. Thus, at each moment of time each dormitory is assigned to exactly one university and one military office. Initially, all the dormitory are empty.Your task is to process the changes that take place in the campus and answer the queries, how many people currently live in dormitory qj." "binary search,data structures,dsu,trees" 3100
91D "Grocer\'s Problem" "Yesterday was a fair in a supermarket\'s grocery section. There were n jars with spices on the fair. Before the event the jars were numbered from 1 to n from the left to the right. After the event the jars were moved and the grocer had to sort them by the increasing of the numbers.The grocer has a special machine at his disposal. The machine can take any 5 or less jars and rearrange them in the way the grocer wants. Note that the jars do not have to stand consecutively. For example, from the permutation 2, 6, 5, 4, 3, 1 one can get permutation 1, 2, 3, 4, 5, 6, if pick the jars on the positions 1, 2, 3, 5 and 6. Which minimum number of such operations is needed to arrange all the jars in the order of their numbers\' increasing?" "constructive algorithms,graphs,greedy" 2600
49C Disposition "Vasya bought the collected works of a well-known Berland poet Petya in n volumes. The volumes are numbered from 1 to n. He thinks that it does not do to arrange the book simply according to their order. Vasya wants to minimize the number of the disposition\xe2\x80\x99s divisors \xe2\x80\x94 the positive integers i such that for at least one j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) is true both: j mod i\xe2\x80\x89=\xe2\x80\x890 and at the same time p(j) mod i\xe2\x80\x89=\xe2\x80\x890, where p(j) is the number of the tome that stands on the j-th place and mod is the operation of taking the division remainder. Naturally, one volume can occupy exactly one place and in one place can stand exactly one volume.Help Vasya \xe2\x80\x94 find the volume disposition with the minimum number of divisors." "constructive algorithms,math" 1700
566A "Matching Names" "Teachers of one programming summer school decided to make a surprise for the students by giving them names in the style of the ""Hobbit"" movie. Each student must get a pseudonym maximally similar to his own name. The pseudonym must be a name of some character of the popular saga and now the teachers are busy matching pseudonyms to student names.There are n students in a summer school. Teachers chose exactly n pseudonyms for them. Each student must get exactly one pseudonym corresponding to him. Let us determine the relevance of a pseudonym b to a student with name a as the length of the largest common prefix a and b. We will represent such value as . Then we can determine the quality of matching of the pseudonyms to students as a sum of relevances of all pseudonyms to the corresponding students.Find the matching between students and pseudonyms with the maximum quality." "dfs and similar,strings,trees" 2300
1467C "Three Bags" "You are given three bags. Each bag contains a non-empty multiset of numbers. You can perform a number of operations on these bags. In one operation, you can choose any two non-empty bags, and choose one number from each of the bags. Let\'s say that you choose number a from the first bag and number b from the second bag. Then, you remove b from the second bag and replace a with a\xe2\x88\x92b in the first bag. Note that if there are multiple occurrences of these numbers, then you shall only remove/replace exactly one occurrence.You have to perform these operations in such a way that you have exactly one number remaining in exactly one of the bags (the other two bags being empty). It can be shown that you can always apply these operations to receive such a configuration in the end. Among all these configurations, find the one which has the maximum number left in the end." "constructive algorithms,greedy" 1900
440C "One-Based Arithmetic" "Prof. Vasechkin wants to represent positive integer n as a sum of addends, where each addends is an integer number containing only 1s. For example, he can represent 121 as 121=111+11+\xe2\x80\x931. Help him to find the least number of digits 1 in such sum." "brute force,dfs and similar,divide and conquer" 1800
1985H2 "Maximize the Largest Component (Hard Version)" "Easy and hard versions are actually different problems, so read statements of both problems completely and carefully. The only difference between the two versions is the operation.Alex has a grid with n rows and m columns consisting of \'.\' and \'#\' characters. A set of \'#\' cells forms a connected component if from any cell in this set, it is possible to reach any other cell in this set by only moving to another cell in the set that shares a common side. The size of a connected component is the number of cells in the set.In one operation, Alex selects any row r (1\xe2\x89\xa4r\xe2\x89\xa4n) and any column c (1\xe2\x89\xa4c\xe2\x89\xa4m), then sets every cell in row r and column c to be \'#\'. Help Alex find the maximum possible size of the largest connected component of \'#\' cells that he can achieve after performing the operation at most once." "data structures,dfs and similar,dp,dsu,implementation" 2200
1982B "Collatz Conjecture" "Recently, the first-year student Maxim learned about the Collatz conjecture, but he didn\'t pay much attention during the lecture, so he believes that the following process is mentioned in the conjecture:There is a variable x and a constant y. The following operation is performed k times:   increase x by 1, then  while the number x is divisible by y, divide it by y.  Note that both of these actions are performed sequentially within one operation.For example, if the number x=16, y=3, and k=2, then after one operation x becomes 17, and after another operation x becomes 2, because after adding one, x=18 is divisible by 3 twice.Given the initial values of x, y, and k, Maxim wants to know what is the final value of x." "brute force,implementation,math,number theory" 1200
1741D "Masha and a Beautiful Tree" "The girl named Masha was walking in the forest and found a complete binary tree of height n and a permutation p of length m=2n.A complete binary tree of height n is a rooted tree such that every vertex except the leaves has exactly two sons, and the length of the path from the root to any of the leaves is n. The picture below shows the complete binary tree for n=2.A permutation is an array consisting of n different integers from 1 to n. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not (2 occurs twice), and [1,3,4] is also not a permutation (n=3, but there is 4 in the array).Let\'s enumerate m leaves of this tree from left to right. The leaf with the number i contains the value pi (1\xe2\x89\xa4i\xe2\x89\xa4m).For example, if n=2, p=[3,1,4,2], the tree will look like this:  Masha considers a tree beautiful if the values in its leaves are ordered from left to right in increasing order.In one operation, Masha can choose any non-leaf vertex of the tree and swap its left and right sons (along with their subtrees).For example, if Masha applies this operation to the root of the tree discussed above, it will take the following form:  Help Masha understand if she can make a tree beautiful in a certain number of operations. If she can, then output the minimum number of operations to make the tree beautiful." "dfs and similar,divide and conquer,graphs,sortings,trees" 1300
1891E "Brukhovich and Exams" "The boy Smilo is learning algorithms with a teacher named Brukhovich.Over the course of the year, Brukhovich will administer n exams. For each exam, its difficulty ai is known, which is a non-negative integer.Smilo doesn\'t like when the greatest common divisor of the difficulties of two consecutive exams is equal to 1. Therefore, he considers the sadness of the academic year to be the number of such pairs of exams. More formally, the sadness is the number of indices i (1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921) such that gcd(ai,ai+1)=1, where gcd(x,y) is the greatest common divisor of integers x and y.Brukhovich wants to minimize the sadness of the year of Smilo. To do this, he can set the difficulty of any exam to 0. However, Brukhovich doesn\'t want to make his students\' lives too easy. Therefore, he will perform this action no more than k times.Help Smilo determine the minimum sadness that Brukhovich can achieve if he performs no more than k operations.As a reminder, the greatest common divisor (GCD) of two non-negative integers x and y is the maximum integer that is a divisor of both x and y and is denoted as gcd(x,y). In particular, gcd(x,0)=gcd(0,x)=x for any non-negative integer x." "brute force,greedy,implementation,math,sortings" 2500
847A "Union of Doubly Linked Lists" "Doubly linked list is one of the fundamental data structures. A doubly linked list is a sequence of elements, each containing information about the previous and the next elements of the list. In this problem all lists have linear structure. I.e. each element except the first has exactly one previous element, each element except the last has exactly one next element. The list is not closed in a cycle.In this problem you are given n memory cells forming one or more doubly linked lists. Each cell contains information about element from some list. Memory cells are numbered from 1 to n.For each cell i you are given two values:   li \xe2\x80\x94 cell containing previous element for the element in the cell i;  ri \xe2\x80\x94 cell containing next element for the element in the cell i. If cell i contains information about the element which has no previous element then li\xe2\x80\x89=\xe2\x80\x890. Similarly, if cell i contains information about the element which has no next element then ri\xe2\x80\x89=\xe2\x80\x890.  Three lists are shown on the picture. For example, for the picture above the values of l and r are the following: l1\xe2\x80\x89=\xe2\x80\x894, r1\xe2\x80\x89=\xe2\x80\x897; l2\xe2\x80\x89=\xe2\x80\x895, r2\xe2\x80\x89=\xe2\x80\x890; l3\xe2\x80\x89=\xe2\x80\x890, r3\xe2\x80\x89=\xe2\x80\x890; l4\xe2\x80\x89=\xe2\x80\x896, r4\xe2\x80\x89=\xe2\x80\x891; l5\xe2\x80\x89=\xe2\x80\x890, r5\xe2\x80\x89=\xe2\x80\x892; l6\xe2\x80\x89=\xe2\x80\x890, r6\xe2\x80\x89=\xe2\x80\x894; l7\xe2\x80\x89=\xe2\x80\x891, r7\xe2\x80\x89=\xe2\x80\x890.Your task is to unite all given lists in a single list, joining them to each other in any order. In particular, if the input data already contains a single list, then there is no need to perform any actions. Print the resulting list in the form of values li, ri.Any other action, other than joining the beginning of one list to the end of another, can not be performed." implementation 1500
1624G "MinOr Tree" "Recently, Vlad has been carried away by spanning trees, so his friends, without hesitation, gave him a connected weighted undirected graph of n vertices and m edges for his birthday.Vlad defined the ority of a spanning tree as the bitwise OR of all its weights, and now he is interested in what is the minimum possible ority that can be achieved by choosing a certain spanning tree. A spanning tree is a connected subgraph of a given graph that does not contain cycles.In other words, you want to keep n\xe2\x88\x921 edges so that the graph remains connected and the bitwise OR weights of the edges are as small as possible. You have to find the minimum bitwise OR itself." "bitmasks,dfs and similar,dsu,graphs,greedy" 1900
1481C "Fence Painting" "You finally woke up after this crazy dream and decided to walk around to clear your head. Outside you saw your house\'s fence \xe2\x80\x94 so plain and boring, that you\'d like to repaint it.  You have a fence consisting of n planks, where the i-th plank has the color ai. You want to repaint the fence in such a way that the i-th plank has the color bi.You\'ve invited m painters for this purpose. The j-th painter will arrive at the moment j and will recolor exactly one plank to color cj. For each painter you can choose which plank to recolor, but you can\'t turn them down, i. e. each painter has to color exactly one plank.Can you get the coloring b you want? If it\'s possible, print for each painter which plank he must paint." "brute force,constructive algorithms,greedy" 1600
1902B "Getting Points" "Monocarp is a student at Berland State University. Due to recent changes in the Berland education system, Monocarp has to study only one subject \xe2\x80\x94 programming.The academic term consists of n days, and in order not to get expelled, Monocarp has to earn at least P points during those n days. There are two ways to earn points \xe2\x80\x94 completing practical tasks and attending lessons. For each practical task Monocarp fulfills, he earns t points, and for each lesson he attends, he earns l points.Practical tasks are unlocked ""each week"" as the term goes on: the first task is unlocked on day 1 (and can be completed on any day from 1 to n), the second task is unlocked on day 8 (and can be completed on any day from 8 to n), the third task is unlocked on day 15, and so on.Every day from 1 to n, there is a lesson which can be attended by Monocarp. And every day, Monocarp chooses whether to study or to rest the whole day. When Monocarp decides to study, he attends a lesson and can complete no more than 2 tasks, which are already unlocked and not completed yet. If Monocarp rests the whole day, he skips a lesson and ignores tasks.Monocarp wants to have as many days off as possible, i. e. he wants to maximize the number of days he rests. Help him calculate the maximum number of days he can rest!" "binary search,brute force,greedy" 1100
1019E "Raining season" "By the year 3018, Summer Informatics School has greatly grown. Hotel \xc2\xabBerendeetronik\xc2\xbb has been chosen as a location of the school. The camp consists of n houses with n\xe2\x88\x921 pathways between them. It is possible to reach every house from each other using the pathways.Everything had been perfect until the rains started. The weather forecast promises that rains will continue for m days. A special squad of teachers was able to measure that the i-th pathway, connecting houses ui and vi, before the rain could be passed in bi seconds. Unfortunately, the rain erodes the roads, so with every day the time to pass the road will increase by ai seconds. In other words, on the t-th (from zero) day after the start of the rain, it will take ai\xe2\x8b\x85t+bi seconds to pass through this road.Unfortunately, despite all the efforts of teachers, even in the year 3018 not all the students are in their houses by midnight. As by midnight all students have to go to bed, it is important to find the maximal time between all the pairs of houses for each day, so every student would know the time when he has to run to his house.Find all the maximal times of paths between every pairs of houses after t=0, t=1, ..., t=m\xe2\x88\x921 days." "data structures,divide and conquer,trees" 3200
1560D "Make a Power of Two" "You are given an integer n. In 1 move, you can do one of the following actions:  erase any digit of the number (it\'s acceptable that the number before the operation has exactly one digit and after the operation, it is ""empty"");  add one digit to the right. The actions may be performed in any order any number of times.Note that if, after deleting some digit from a number, it will contain leading zeroes, they will not be deleted. E.g. if you delete from the number 301 the digit 3, the result is the number 01 (not 1).You need to perform the minimum number of actions to make the number any power of 2 (i.e. there\'s an integer k (k\xe2\x89\xa50) such that the resulting number is equal to 2k). The resulting number must not have leading zeroes.E.g. consider n=1052. The answer is equal to 2. First, let\'s add to the right one digit 4 (the result will be 10524). Then let\'s erase the digit 5, so the result will be 1024 which is a power of 2.E.g. consider n=8888. The answer is equal to 3. Let\'s erase any of the digits 8 three times. The result will be 8 which is a power of 2." greedy,math,strings 1300
1633E "Spanning Tree Queries" "You are given a connected weighted undirected graph, consisting of n vertices and m edges.You are asked k queries about it. Each query consists of a single integer x. For each query, you select a spanning tree in the graph. Let the weights of its edges be w1,w2,\xe2\x80\xa6,wn\xe2\x88\x921. The cost of a spanning tree is n\xe2\x88\x921\xe2\x88\x91i=1|wi\xe2\x88\x92x| (the sum of absolute differences between the weights and x). The answer to a query is the lowest cost of a spanning tree.The queries are given in a compressed format. The first p (1\xe2\x89\xa4p\xe2\x89\xa4k) queries q1,q2,\xe2\x80\xa6,qp are provided explicitly. For queries from p+1 to k, qj=(qj\xe2\x88\x921\xe2\x8b\x85a+b)modc.Print the xor of answers to all queries." "binary search,data structures,dfs and similar,dsu,graphs,greedy,math,sortings,trees" 2400
1055C "Lucky Days" "Bob and Alice are often participating in various programming competitions. Like many competitive programmers, Alice and Bob have good and bad days. They noticed, that their lucky and unlucky days are repeating with some period. For example, for Alice days [la;ra] are lucky, then there are some unlucky days: [ra+1;la+ta\xe2\x88\x921], and then there are lucky days again: [la+ta;ra+ta] and so on. In other words, the day is lucky for Alice if it lies in the segment [la+kta;ra+kta] for some non-negative integer k.The Bob\'s lucky day have similar structure, however the parameters of his sequence are different: lb, rb, tb. So a day is a lucky for Bob if it lies in a segment [lb+ktb;rb+ktb], for some non-negative integer k.Alice and Bob want to participate in team competitions together and so they want to find out what is the largest possible number of consecutive days, which are lucky for both Alice and Bob." "math,number theory" 1900
264B "Good Sequences" "Squirrel Liss is interested in sequences. She also has preferences of integers. She thinks n integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an are good.Now she is interested in good sequences. A sequence x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xk is called good if it satisfies the following three conditions:  The sequence is strictly increasing, i.e. xi\xe2\x80\x89<\xe2\x80\x89xi\xe2\x80\x89+\xe2\x80\x891 for each i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k\xe2\x80\x89-\xe2\x80\x891).  No two adjacent elements are coprime, i.e. gcd(xi,\xe2\x80\x89xi\xe2\x80\x89+\xe2\x80\x891)\xe2\x80\x89>\xe2\x80\x891 for each i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k\xe2\x80\x89-\xe2\x80\x891) (where gcd(p,\xe2\x80\x89q) denotes the greatest common divisor of the integers p and q).  All elements of the sequence are good integers. Find the length of the longest good sequence." "dp,number theory" 1500
1966A "Card Exchange" "You have a hand of n cards, where each card has a number written on it, and a fixed integer k. You can perform the following operation any number of times:  Choose any k cards from your hand that all have the same number.  Exchange these cards for k\xe2\x88\x921 cards, each of which can have any number you choose (including the number written on the cards you just exchanged). Here is one possible sequence of operations for the first example case, which has k=3:  What is the minimum number of cards you can have in your hand at the end of this process?" "constructive algorithms,games,greedy" 800
1303G "Sum of Prefix Sums" "We define the sum of prefix sums of an array [s1,s2,\xe2\x80\xa6,sk] as s1+(s1+s2)+(s1+s2+s3)+\xe2\x8b\xaf+(s1+s2+\xe2\x8b\xaf+sk).You are given a tree consisting of n vertices. Each vertex i has an integer ai written on it. We define the value of the simple path from vertex u to vertex v as follows: consider all vertices appearing on the path from u to v, write down all the numbers written on these vertices in the order they appear on the path, and compute the sum of prefix sums of the resulting sequence.Your task is to calculate the maximum value over all paths in the tree." "data structures,divide and conquer,geometry,trees" 2700
933B "A Determined Cleanup" "In order to put away old things and welcome a fresh new year, a thorough cleaning of the house is a must.Little Tommy finds an old polynomial and cleaned it up by taking it modulo another. But now he regrets doing this...Given two integers p and k, find a polynomial f(x) with non-negative integer coefficients strictly less than k, whose remainder is p when divided by (x\xe2\x80\x89+\xe2\x80\x89k). That is, f(x)\xe2\x80\x89=\xe2\x80\x89q(x)\xc2\xb7(x\xe2\x80\x89+\xe2\x80\x89k)\xe2\x80\x89+\xe2\x80\x89p, where q(x) is a polynomial (not necessarily with integer coefficients)." math 2000
63A "Sinking Ship" "The ship crashed into a reef and is sinking. Now the entire crew must be evacuated. All n crew members have already lined up in a row (for convenience let\'s label them all from left to right with positive integers from 1 to n) and await further instructions. However, one should evacuate the crew properly, in a strict order. Specifically:The first crew members to leave the ship are rats. Then women and children (both groups have the same priority) leave the ship. After that all men are evacuated from the ship. The captain leaves the sinking ship last.If we cannot determine exactly who should leave the ship first for any two members of the crew by the rules from the previous paragraph, then the one who stands to the left in the line leaves the ship first (or in other words, the one whose number in the line is less).For each crew member we know his status as a crew member, and also his name. All crew members have different names. Determine the order in which to evacuate the crew." implementation,sortings,strings 900
1105B "Zuhair and Strings" "Given a string s of length n and integer k (1\xe2\x89\xa4k\xe2\x89\xa4n). The string s has a level x, if x is largest non-negative integer, such that it\'s possible to find in s:  x non-intersecting (non-overlapping) substrings of length k,  all characters of these x substrings are the same (i.e. each substring contains only one distinct character and this character is the same for all the substrings). A substring is a sequence of consecutive (adjacent) characters, it is defined by two integers i and j (1\xe2\x89\xa4i\xe2\x89\xa4j\xe2\x89\xa4n), denoted as s[i\xe2\x80\xa6j] = ""sisi+1\xe2\x80\xa6sj"".For example, if k=2, then:  the string ""aabb"" has level 1 (you can select substring ""aa""),  the strings ""zzzz"" and ""zzbzz"" has level 2 (you can select two non-intersecting substrings ""zz"" in each of them),  the strings ""abed"" and ""aca"" have level 0 (you can\'t find at least one substring of the length k=2 containing the only distinct character). Zuhair gave you the integer k and the string s of length n. You need to find x, the level of the string s." "brute force,implementation,strings" 1100
1614B "Divan and a New Project" "The company ""Divan\'s Sofas"" is planning to build n+1 different buildings on a coordinate line so that:   the coordinate of each building is an integer number;  no two buildings stand at the same point. Let xi be the coordinate of the i-th building. To get from the building i to the building j, Divan spends |xi\xe2\x88\x92xj| minutes, where |y| is the absolute value of y.All buildings that Divan is going to build can be numbered from 0 to n. The businessman will live in the building 0, the new headquarters of ""Divan\'s Sofas"". In the first ten years after construction Divan will visit the i-th building ai times, each time spending 2\xe2\x8b\x85|x0\xe2\x88\x92xi| minutes for walking.Divan asks you to choose the coordinates for all n+1 buildings so that over the next ten years the businessman will spend as little time for walking as possible." "constructive algorithms,sortings" 1000
527C "Glass Carving" "Leonid wants to become a glass carver (the person who creates beautiful artworks by cutting the glass). He already has a rectangular w mm \xe2\x80\x89\xc3\x97\xe2\x80\x89 h mm sheet of glass, a diamond glass cutter and lots of enthusiasm. What he lacks is understanding of what to carve and how.In order not to waste time, he decided to practice the technique of carving. To do this, he makes vertical and horizontal cuts through the entire sheet. This process results in making smaller rectangular fragments of glass. Leonid does not move the newly made glass fragments. In particular, a cut divides each fragment of glass that it goes through into smaller fragments.After each cut Leonid tries to determine what area the largest of the currently available glass fragments has. Since there appear more and more fragments, this question takes him more and more time and distracts him from the fascinating process.Leonid offers to divide the labor \xe2\x80\x94 he will cut glass, and you will calculate the area of the maximum fragment after each cut. Do you agree?" "binary search,data structures,implementation" 1500
1672B "I love AAAB" "Let\'s call a string good if its length is at least 2 and all of its characters are A except for the last character which is B. The good strings are AB,AAB,AAAB,\xe2\x80\xa6. Note that B is not a good string.You are given an initially empty string s1.You can perform the following operation any number of times:   Choose any position of s1 and insert some good string in that position. Given a string s2, can we turn s1 into s2 after some number of operations?" "constructive algorithms,implementation" 800
1254D "Tree Queries" "Hanh is a famous biologist. He loves growing trees and doing experiments on his own garden.One day, he got a tree consisting of n vertices. Vertices are numbered from 1 to n. A tree with n vertices is an undirected connected graph with n\xe2\x88\x921 edges. Initially, Hanh sets the value of every vertex to 0.Now, Hanh performs q operations, each is either of the following types:   Type 1: Hanh selects a vertex v and an integer d. Then he chooses some vertex r uniformly at random, lists all vertices u such that the path from r to u passes through v. Hanh then increases the value of all such vertices u by d.  Type 2: Hanh selects a vertex v and calculates the expected value of v. Since Hanh is good at biology but not math, he needs your help on these operations." "data structures,probabilities,trees" 2700
246D "Colorful Graph" "You\'ve got an undirected graph, consisting of n vertices and m edges. We will consider the graph\'s vertices numbered with integers from 1 to n. Each vertex of the graph has a color. The color of the i-th vertex is an integer ci.Let\'s consider all vertices of the graph, that are painted some color k. Let\'s denote a set of such as V(k). Let\'s denote the value of the neighbouring color diversity for color k as the cardinality of the set Q(k)\xe2\x80\x89=\xe2\x80\x89{cu :\xe2\x80\x89 cu\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89k and there is vertex v belonging to set V(k) such that nodes v and u are connected by an edge of the graph}.Your task is to find such color k, which makes the cardinality of set Q(k) maximum. In other words, you want to find the color that has the most diverse neighbours. Please note, that you want to find such color k, that the graph has at least one vertex with such color." "brute force,dfs and similar,graphs" 1600
1144B "Parity Alternated Deletions" "Polycarp has an array a consisting of n integers.He wants to play a game with this array. The game consists of several moves. On the first move he chooses any element and deletes it (after the first move the array contains n\xe2\x88\x921 elements). For each of the next moves he chooses any element with the only restriction: its parity should differ from the parity of the element deleted on the previous move. In other words, he alternates parities (even-odd-even-odd-... or odd-even-odd-even-...) of the removed elements. Polycarp stops if he can\'t make a move.Formally:   If it is the first move, he chooses any element and deletes it;  If it is the second or any next move:   if the last deleted element was odd, Polycarp chooses any even element and deletes it;  if the last deleted element was even, Polycarp chooses any odd element and deletes it.   If after some move Polycarp cannot make a move, the game ends. Polycarp\'s goal is to minimize the sum of non-deleted elements of the array after end of the game. If Polycarp can delete the whole array, then the sum of non-deleted elements is zero.Help Polycarp find this value." greedy,implementation,sortings 900
2035C "Alya and Permutation" "Alya has been given a hard problem. Unfortunately, she is too busy running for student council. Please solve this problem for her.Given an integer n, construct a permutation p of integers 1,2,\xe2\x80\xa6,n that maximizes the value of k (which is initially 0) after the following process.Perform n operations, on the i-th operation (i=1,2,\xe2\x80\xa6,n),  If i is odd, k=k&pi, where & denotes the bitwise AND operation.  If i is even, k=k|pi, where | denotes the bitwise OR operation." "bitmasks,constructive algorithms,math" 1400
475E "Strongly Connected City 2" "Imagine a city with n junctions and m streets. Junctions are numbered from 1 to n.In order to increase the traffic flow, mayor of the city has decided to make each street one-way. This means in the street between junctions u and v, the traffic moves only from u to v or only from v to u. The problem is to direct the traffic flow of streets in a way that maximizes the number of pairs (u,\xe2\x80\x89v) where 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89u,\xe2\x80\x89v\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n and it is possible to reach junction v from u by passing the streets in their specified direction. Your task is to find out maximal possible number of such pairs." "dfs and similar" 2700
1338E JYPnation "Due to the success of TWICE, JYP Entertainment has earned countless money and emerged as the biggest entertainment firm by market capitalization. Therefore, the boss, JYP, has decided to create a new nation and has appointed you to provide a design diagram.The new nation consists of n cities and some roads between them. JYP has given some restrictions:  To guarantee efficiency while avoiding chaos, for any 2 different cities A and B, there is exactly one road between them, and it is one-directional. There are no roads connecting a city to itself.  The logo of rivaling companies should not appear in the plan, that is, there does not exist 4 distinct cities A,B,C,D , such that the following configuration occurs.   JYP has given criteria for your diagram. For two cities A,B, let dis(A,B) be the smallest number of roads you have to go through to get from A to B. If it is not possible to walk from A to B, dis(A,B)=614n. Then, the efficiency value is defined to be the sum of dis(A,B) for all ordered pairs of distinct cities (A,B).Note that dis(A,B) doesn\'t have to be equal to dis(B,A).You have drawn a design diagram that satisfies JYP\'s restrictions. Find the sum of dis(A,B) over all ordered pairs of cities (A,B) with A\xe2\x89\xa0B.Note that the input is given in compressed form. But even though it is compressed, you\'d better use fast input." graphs 3500
723B "Text Document Analysis" "Modern text editors usually show some information regarding the document being edited. For example, the number of words, the number of pages, or the number of characters.In this problem you should implement the similar functionality.You are given a string which only consists of:  uppercase and lowercase English letters,  underscore symbols (they are used as separators),  parentheses (both opening and closing). It is guaranteed that each opening parenthesis has a succeeding closing parenthesis. Similarly, each closing parentheses has a preceding opening parentheses matching it. For each pair of matching parentheses there are no other parenthesis between them. In other words, each parenthesis in the string belongs to a matching ""opening-closing"" pair, and such pairs can\'t be nested.For example, the following string is valid: ""_Hello_Vasya(and_Petya)__bye_(and_OK)"".Word is a maximal sequence of consecutive letters, i.e. such sequence that the first character to the left and the first character to the right of it is an underscore, a parenthesis, or it just does not exist. For example, the string above consists of seven words: ""Hello"", ""Vasya"", ""and"", ""Petya"", ""bye"", ""and"" and ""OK"". Write a program that finds:  the length of the longest word outside the parentheses (print 0, if there is no word outside the parentheses),  the number of words inside the parentheses (print 0, if there is no word inside the parentheses)." "expression parsing,implementation,strings" 1100
383C "Propagating tree" "Iahub likes trees very much. Recently he discovered an interesting tree named propagating tree. The tree consists of n nodes numbered from 1 to n, each node i having an initial value ai. The root of the tree is node 1.This tree has a special property: when a value val is added to a value of node i, the value -val is added to values of all the children of node i. Note that when you add value -val to a child of node i, you also add -(-val) to all children of the child of node i and so on. Look an example explanation to understand better how it works.This tree supports two types of queries:  ""1 x val"" \xe2\x80\x94 val is added to the value of node x;  ""2 x"" \xe2\x80\x94 print the current value of node x. In order to help Iahub understand the tree better, you must answer m queries of the preceding type." "data structures,dfs and similar,trees" 2000
77D "Domino Carpet" "...Mike the TV greets you again! Tired of the monotonous furniture? Sick of gray routine? Dreaming about dizzying changes in your humble abode? We have something to offer you! This domino carpet for only $99.99 will change your life! You can lay it on the floor, hang it on the wall or even on the ceiling! Among other things ... Having watched the commercial, virus Hexadecimal also wanted to get a Domino Carpet and wanted badly to be photographed in front of it. But of course, a virus will never consent to buying a licensed Carpet! So she ordered a truck of dominoes and decided to make such a Carpet herself. The original Domino Carpet is a field of squares n\xe2\x80\x89\xc3\x97\xe2\x80\x89m in size. Each square is half of a domino, and can be rotated either vertically or horizontally, independently from its neighbors. Vertically rotated domino halves look like this:    And horizontally rotated halves look like this:   Notice, that some halves looks the same in both rotations, but other halves differ.Dominoes bought by Hexadecimal are represented by uncuttable chips 1\xe2\x80\x89\xc3\x97\xe2\x80\x892 in size, which can be laid either vertically or horizontally. If the chip is laid vertically, then both of it\'s halves should be laid vertically orientated; if the chip is laid horizontally, then both of it\'s halves should be laid horizontally.The samples of valid and invalid dominoes laid vertically and horizontally are:    Virus Hexadecimal assembles her own Domino Carpet so that the following conditions are satisfied:  each carpet square is covered by a domino chip, i.e. there are no empty squares;  all domino chips lie entirely within the carpet and don\'t overlap with each other;  if there is a horizontal domino chip with its left half in column j then there are no horizontal domino chips with their left halves in columns j\xe2\x80\x89-\xe2\x80\x891 or j\xe2\x80\x89+\xe2\x80\x891. Before starting to assemble her own Domino Carpet, the virus wants to know the number of ways to achieve the intended purpose modulo 109\xe2\x80\x89+\xe2\x80\x897.You can assume that the virus has an infinitely large number of dominoes of each type." dp,implementation 2300
916A "Jamie and Alarm Snooze" "Jamie loves sleeping. One day, he decides that he needs to wake up at exactly hh:\xe2\x80\x89mm. However, he hates waking up, so he wants to make waking up less painful by setting the alarm at a lucky time. He will then press the snooze button every x minutes until hh:\xe2\x80\x89mm is reached, and only then he will wake up. He wants to know what is the smallest number of times he needs to press the snooze button.A time is considered lucky if it contains a digit \'7\'. For example, 13:\xe2\x80\x8907 and 17:\xe2\x80\x8927 are lucky, while 00:\xe2\x80\x8948 and 21:\xe2\x80\x8934 are not lucky.Note that it is not necessary that the time set for the alarm and the wake-up time are on the same day. It is guaranteed that there is a lucky time Jamie can set so that he can wake at hh:\xe2\x80\x89mm.Formally, find the smallest possible non-negative integer y such that the time representation of the time x\xc2\xb7y minutes before hh:\xe2\x80\x89mm contains the digit \'7\'.Jamie uses 24-hours clock, so after 23:\xe2\x80\x8959 comes 00:\xe2\x80\x8900." "brute force,implementation,math" 900
311D "Interval Cubing" "While learning Computational Geometry, Tiny is simultaneously learning a useful data structure called segment tree or interval tree. He has scarcely grasped it when comes out a strange problem:Given an integer sequence a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. You should run q queries of two types:  Given two integers l and r (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n), ask the sum of all elements in the sequence al,\xe2\x80\x89al\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89ar.  Given two integers l and r (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n), let each element x in the sequence al,\xe2\x80\x89al\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89ar becomes x3. In other words, apply an assignments al\xe2\x80\x89=\xe2\x80\x89al3,\xe2\x80\x89al\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89=\xe2\x80\x89al\xe2\x80\x89+\xe2\x80\x8913,\xe2\x80\x89...,\xe2\x80\x89ar\xe2\x80\x89=\xe2\x80\x89ar3. For every query of type 1, output the answer to it.Tiny himself surely cannot work it out, so he asks you for help. In addition, Tiny is a prime lover. He tells you that because the answer may be too huge, you should only output it modulo 95542721 (this number is a prime number)." "data structures,math" 2600
780G "Andryusha and Nervous Barriers" "Andryusha has found a perplexing arcade machine. The machine is a vertically adjusted board divided into square cells. The board has w columns numbered from 1 to w from left to right, and h rows numbered from 1 to h from the bottom to the top.Further, there are barriers in some of board rows. There are n barriers in total, and i-th of them occupied the cells li through ri of the row ui. Andryusha recollects well that no two barriers share the same row. Furthermore, no row is completely occupied with a barrier, that is, at least one cell in each row is free.The player can throw a marble to any column of the machine from above. A marble falls downwards until it encounters a barrier, or falls through the bottom of the board. A marble disappears once it encounters a barrier but is replaced by two more marbles immediately to the left and to the right of the same barrier. In a situation when the barrier is at an edge of the board, both marbles appear next to the barrier at the side opposite to the edge. More than one marble can occupy the same place of the board, without obstructing each other\'s movement. Ultimately, all marbles are bound to fall from the bottom of the machine.  Examples of marble-barrier interaction. Peculiarly, sometimes marbles can go through barriers as if they were free cells. That is so because the barriers are in fact alive, and frightened when a marble was coming at them from a very high altitude. More specifically, if a marble falls towards the barrier i from relative height more than si (that is, it started its fall strictly higher than ui\xe2\x80\x89+\xe2\x80\x89si), then the barrier evades the marble. If a marble is thrown from the top of the board, it is considered to appear at height (h\xe2\x80\x89+\xe2\x80\x891).Andryusha remembers to have thrown a marble once in each of the columns. Help him find the total number of marbles that came down at the bottom of the machine. Since the answer may be large, print it modulo 109\xe2\x80\x89+\xe2\x80\x897." "data structures,dp" 2700
706A Beru-taxi "Vasiliy lives at point (a,\xe2\x80\x89b) of the coordinate plane. He is hurrying up to work so he wants to get out of his house as soon as possible. New app suggested n available Beru-taxi nearby. The i-th taxi is located at point (xi,\xe2\x80\x89yi) and moves with a speed vi. Consider that each of n drivers will move directly to Vasiliy and with a maximum possible speed. Compute the minimum time when Vasiliy will get in any of Beru-taxi cars." "brute force,geometry,implementation" 900
1054B "Appending Mex" "Initially Ildar has an empty array. He performs n steps. On each step he takes a subset of integers already added to the array and appends the mex of this subset to the array. The mex of an multiset of integers is the smallest non-negative integer not presented in the multiset. For example, the mex of the multiset [0,2,3] is 1, while the mex of the multiset [1,2,1] is 0.More formally, on the step m, when Ildar already has an array a1,a2,\xe2\x80\xa6,am\xe2\x88\x921, he chooses some subset of indices 1\xe2\x89\xa4i1<i2<\xe2\x80\xa6<ik<m (possibly, empty), where 0\xe2\x89\xa4k<m, and appends the mex(ai1,ai2,\xe2\x80\xa6aik) to the end of the array.After performing all the steps Ildar thinks that he might have made a mistake somewhere. He asks you to determine for a given array a1,a2,\xe2\x80\xa6,an the minimum step t such that he has definitely made a mistake on at least one of the steps 1,2,\xe2\x80\xa6,t, or determine that he could have obtained this array without mistakes." implementation 1000
707B Bakery "Masha wants to open her own bakery and bake muffins in one of the n cities numbered from 1 to n. There are m bidirectional roads, each of whose connects some pair of cities.To bake muffins in her bakery, Masha needs to establish flour supply from some storage. There are only k storages, located in different cities numbered a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89ak.Unforunately the law of the country Masha lives in prohibits opening bakery in any of the cities which has storage located in it. She can open it only in one of another n\xe2\x80\x89-\xe2\x80\x89k cities, and, of course, flour delivery should be paid \xe2\x80\x94 for every kilometer of path between storage and bakery Masha should pay 1 ruble.Formally, Masha will pay x roubles, if she will open the bakery in some city b (ai\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89b for every 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k) and choose a storage in some city s (s\xe2\x80\x89=\xe2\x80\x89aj for some 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k) and b and s are connected by some path of roads of summary length x (if there are more than one path, Masha is able to choose which of them should be used).Masha is very thrifty and rational. She is interested in a city, where she can open her bakery (and choose one of k storages and one of the paths between city with bakery and city with storage) and pay minimum possible amount of rubles for flour delivery. Please help Masha find this amount." graphs 1300
234H "Merging Two Decks" "There are two decks of cards lying on the table in front of you, some cards in these decks lay face up, some of them lay face down. You want to merge them into one deck in which each card is face down. You\'re going to do it in two stages.The first stage is to merge the two decks in such a way that the relative order of the cards from the same deck doesn\'t change. That is, for any two different cards i and j in one deck, if card i lies above card j, then after the merge card i must also be above card j.The second stage is performed on the deck that resulted from the first stage. At this stage, the executed operation is the turning operation. In one turn you can take a few of the top cards, turn all of them, and put them back. Thus, each of the taken cards gets turned and the order of these cards is reversed. That is, the card that was on the bottom before the turn, will be on top after it.Your task is to make sure that all the cards are lying face down. Find such an order of merging cards in the first stage and the sequence of turning operations in the second stage, that make all the cards lie face down, and the number of turns is minimum." "constructive algorithms,greedy" 2000
1791F "Range Update Point Query" "Given an array a1,a2,\xe2\x80\xa6,an, you need to handle a total of q updates and queries of two types:  1 l r \xe2\x80\x94 for each index i with l\xe2\x89\xa4i\xe2\x89\xa4r, update the value of ai to the sum of the digits of ai.  2 x \xe2\x80\x94 output ax." "binary search,brute force,data structures" 1500
954G "Castle Defense" "Today you are going to lead a group of elven archers to defend the castle that is attacked by an army of angry orcs. Three sides of the castle are protected by impassable mountains and the remaining side is occupied by a long wall that is split into n sections. At this moment there are exactly ai archers located at the i-th section of this wall. You know that archer who stands at section i can shoot orcs that attack section located at distance not exceeding r, that is all such sections j that |i\xe2\x80\x89-\xe2\x80\x89j|\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r. In particular, r\xe2\x80\x89=\xe2\x80\x890 means that archers are only capable of shooting at orcs who attack section i.Denote as defense level of section i the total number of archers who can shoot at the orcs attacking this section. Reliability of the defense plan is the minimum value of defense level of individual wall section.There is a little time left till the attack so you can\'t redistribute archers that are already located at the wall. However, there is a reserve of k archers that you can distribute among wall sections in arbitrary way. You would like to achieve maximum possible reliability of the defence plan." "binary search,data structures,greedy,two pointers" 2000
1238G "Adilbek and the Watering System" "Adilbek has to water his garden. He is going to do it with the help of a complex watering system: he only has to deliver water to it, and the mechanisms will do all the remaining job.The watering system consumes one liter of water per minute (if there is no water, it is not working). It can hold no more than c liters. Adilbek has already poured c0 liters of water into the system. He is going to start watering the garden right now and water it for m minutes, and the watering system should contain at least one liter of water at the beginning of the i-th minute (for every i from 0 to m\xe2\x88\x921).Now Adilbek wonders what he will do if the watering system runs out of water. He called n his friends and asked them if they are going to bring some water. The i-th friend answered that he can bring no more than ai liters of water; he will arrive at the beginning of the ti-th minute and pour all the water he has into the system (if the system cannot hold such amount of water, the excess water is poured out); and then he will ask Adilbek to pay bi dollars for each liter of water he has brought. You may assume that if a friend arrives at the beginning of the ti-th minute and the system runs out of water at the beginning of the same minute, the friend pours his water fast enough so that the system does not stop working.Of course, Adilbek does not want to pay his friends, but he has to water the garden. So he has to tell his friends how much water should they bring. Formally, Adilbek wants to choose n integers k1, k2, ..., kn in such a way that:  if each friend i brings exactly ki liters of water, then the watering system works during the whole time required to water the garden;  the sum n\xe2\x88\x91i=1kibi is minimum possible. Help Adilbek to determine the minimum amount he has to pay his friends or determine that Adilbek not able to water the garden for m minutes.You have to answer q independent queries." "data structures,greedy,sortings" 2700
177G2 "Fibonacci Strings" "Fibonacci strings are defined as follows:   f1 = \xc2\xaba\xc2\xbb  f2 = \xc2\xabb\xc2\xbb  fn = fn\xe2\x80\x89-\xe2\x80\x891 fn\xe2\x80\x89-\xe2\x80\x892, n\xe2\x80\x89>\xe2\x80\x892 Thus, the first five Fibonacci strings are: ""a"", ""b"", ""ba"", ""bab"", ""babba"".You are given a Fibonacci string and m strings si. For each string si, find the number of times it occurs in the given Fibonacci string as a substring." matrices,strings 2600
133B Unary "Unary is a minimalistic Brainfuck dialect in which programs are written using only one token. Brainfuck programs use 8 commands: ""+"", ""-"", ""["", ""]"", ""<"", "">"", ""."" and "","" (their meaning is not important for the purposes of this problem). Unary programs are created from Brainfuck programs using the following algorithm. First, replace each command with a corresponding binary code, using the following conversion table:   "">"" \xe2\x80\x89\xe2\x86\x92\xe2\x80\x89 1000,  ""<"" \xe2\x80\x89\xe2\x86\x92\xe2\x80\x89 1001,  ""+"" \xe2\x80\x89\xe2\x86\x92\xe2\x80\x89 1010,  ""-"" \xe2\x80\x89\xe2\x86\x92\xe2\x80\x89 1011,  ""."" \xe2\x80\x89\xe2\x86\x92\xe2\x80\x89 1100,  "","" \xe2\x80\x89\xe2\x86\x92\xe2\x80\x89 1101,  ""["" \xe2\x80\x89\xe2\x86\x92\xe2\x80\x89 1110,  ""]"" \xe2\x80\x89\xe2\x86\x92\xe2\x80\x89 1111. Next, concatenate the resulting binary codes into one binary number in the same order as in the program. Finally, write this number using unary numeral system \xe2\x80\x94 this is the Unary program equivalent to the original Brainfuck one.You are given a Brainfuck program. Your task is to calculate the size of the equivalent Unary program, and print it modulo 1000003 (106\xe2\x80\x89+\xe2\x80\x893)." implementation 1200
1304B "Longest Palindrome" "Returning back to problem solving, Gildong is now studying about palindromes. He learned that a palindrome is a string that is the same as its reverse. For example, strings ""pop"", ""noon"", ""x"", and ""kkkkkk"" are palindromes, while strings ""moon"", ""tv"", and ""abab"" are not. An empty string is also a palindrome.Gildong loves this concept so much, so he wants to play with it. He has n distinct strings of equal length m. He wants to discard some of the strings (possibly none or all) and reorder the remaining strings so that the concatenation becomes a palindrome. He also wants the palindrome to be as long as possible. Please help him find one." "brute force,constructive algorithms,greedy,implementation,strings" 1100
1725K "Kingdom of Criticism" "Pak Chanek is visiting a kingdom that earned a nickname ""Kingdom of Criticism"" because of how often its residents criticise each aspect of the kingdom. One aspect that is often criticised is the heights of the buildings. The kingdom has N buildings. Initially, building i has a height of Ai units.At any point in time, the residents can give a new criticism, namely they currently do not like buildings with heights between l and r units inclusive for some two integers l and r. It is known that r\xe2\x88\x92l is always odd.In 1 minute, the kingdom\'s construction team can increase or decrease the height of any building by 1 unit as long as the height still becomes a positive number. Each time they receive the current criticism from the residents, the kingdom\'s construction team makes it so that there are no buildings with heights between l and r units inclusive in the minimum time possible. It can be obtained that there is only one way to do this. Note that the construction team only cares about the current criticism from the residents. All previous criticisms are forgotten.There will be Q queries that you must solve. Each query is one of the three following possibilities:   1 k w: The kingdom\'s construction team changes the height of building k to be w units (1\xe2\x89\xa4k\xe2\x89\xa4N, 1\xe2\x89\xa4w\xe2\x89\xa4109).  2 k: The kingdom\'s construction team wants you to find the height of building k (1\xe2\x89\xa4k\xe2\x89\xa4N).  3 l r: The residents currently do not like buildings with heights between l and r units inclusive (2\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4109\xe2\x88\x921, r\xe2\x88\x92l is odd). Note that each change in height still persists to the next queries." "data structures,dsu" 2500
1090A "Company Merging" "A conglomerate consists of n companies. To make managing easier, their owners have decided to merge all companies into one. By law, it is only possible to merge two companies, so the owners plan to select two companies, merge them into one, and continue doing so until there is only one company left.But anti-monopoly service forbids to merge companies if they suspect unfriendly absorption. The criterion they use is the difference in maximum salaries between two companies. Merging is allowed only if the maximum salaries are equal.To fulfill the anti-monopoly requirements, the owners can change salaries in their companies before merging. But the labor union insists on two conditions: it is only allowed to increase salaries, moreover all the employees in one company must get the same increase.Sure enough, the owners want to minimize the total increase of all salaries in all companies. Help them find the minimal possible increase that will allow them to merge companies into one." greedy 1300
344B "Simple Molecules" "Mad scientist Mike is busy carrying out experiments in chemistry. Today he will attempt to join three atoms into one molecule.A molecule consists of atoms, with some pairs of atoms connected by atomic bonds. Each atom has a valence number \xe2\x80\x94 the number of bonds the atom must form with other atoms. An atom can form one or multiple bonds with any other atom, but it cannot form a bond with itself. The number of bonds of an atom in the molecule must be equal to its valence number.  Mike knows valence numbers of the three atoms. Find a molecule that can be built from these atoms according to the stated rules, or determine that it is impossible." "brute force,graphs,math" 1200
1402A "Fancy Fence" "Everybody knows that Bal\xc3\xa1zs has the fanciest fence in the whole town. It\'s built up from N fancy sections. The sections are rectangles standing closely next to each other on the ground. The ith section has integer height hi and integer width wi.  We are looking for fancy rectangles on this fancy fence.  A rectangle is fancy if:   its sides are either horizontal or vertical and have integer lengths  the distance between the rectangle and the ground is integer  the distance between the rectangle and the left side of the first section is integer  it\'s lying completely on sections  What is the number of fancy rectangles?  This number can be very big, so we are interested in it modulo 109+7." "*special problem,data structures,dsu,implementation,math,sortings" 1800
560B "Gerald is into Art" "Gerald bought two very rare paintings at the Sotheby\'s auction and he now wants to hang them on the wall. For that he bought a special board to attach it to the wall and place the paintings on the board. The board has shape of an a1\xe2\x80\x89\xc3\x97\xe2\x80\x89b1 rectangle, the paintings have shape of a a2\xe2\x80\x89\xc3\x97\xe2\x80\x89b2 and a3\xe2\x80\x89\xc3\x97\xe2\x80\x89b3 rectangles.Since the paintings are painted in the style of abstract art, it does not matter exactly how they will be rotated, but still, one side of both the board, and each of the paintings must be parallel to the floor. The paintings can touch each other and the edges of the board, but can not overlap or go beyond the edge of the board. Gerald asks whether it is possible to place the paintings on the board, or is the board he bought not large enough?" "constructive algorithms,implementation" 1200
1056G "Take Metro" "Having problems with tram routes in the morning, Arkady decided to return home by metro. Fortunately for Arkady, there is only one metro line in the city.Unfortunately for Arkady, the line is circular. It means that the stations are enumerated from 1 to n and there is a tunnel between any pair of consecutive stations as well as between the station 1 and the station n. Trains that go in clockwise direction visit the stations in order 1\xe2\x86\x922\xe2\x86\x923\xe2\x86\x92\xe2\x80\xa6\xe2\x86\x92n\xe2\x86\x921 while the trains that go in the counter-clockwise direction visit the stations in the reverse order.The stations that have numbers from 1 to m have interior mostly in red colors while the stations that have numbers from m+1 to n have blue interior. Arkady entered the metro at station s and decided to use the following algorithm to choose his way home.  Initially he has a positive integer t in his mind.  If the current station has red interior, he takes a clockwise-directed train, otherwise he takes a counter-clockwise-directed train.  He rides exactly t stations on the train and leaves the train.  He decreases t by one. If t is still positive, he returns to step 2. Otherwise he exits the metro. You have already realized that this algorithm most probably won\'t bring Arkady home. Find the station he will exit the metro at so that you can continue helping him." "brute force,data structures,graphs" 2900
1343E "Weights Distributing" "You are given an undirected unweighted graph consisting of n vertices and m edges (which represents the map of Bertown) and the array of prices p of length m. It is guaranteed that there is a path between each pair of vertices (districts).Mike has planned a trip from the vertex (district) a to the vertex (district) b and then from the vertex (district) b to the vertex (district) c. He can visit the same district twice or more. But there is one issue: authorities of the city want to set a price for using the road so if someone goes along the road then he should pay the price corresponding to this road (he pays each time he goes along the road). The list of prices that will be used p is ready and they just want to distribute it between all roads in the town in such a way that each price from the array corresponds to exactly one road.You are a good friend of Mike (and suddenly a mayor of Bertown) and want to help him to make his trip as cheap as possible. So, your task is to distribute prices between roads in such a way that if Mike chooses the optimal path then the price of the trip is the minimum possible. Note that you cannot rearrange prices after the start of the trip.You have to answer t independent test cases." "brute force,graphs,greedy,shortest paths,sortings" 2100
2037A Twice "Kinich wakes up to the start of a new day. He turns on his phone, checks his mailbox, and finds a mysterious present. He decides to unbox the present.Kinich unboxes an array a with n integers. Initially, Kinich\'s score is 0. He will perform the following operation any number of times:  Select two indices i and j (1\xe2\x89\xa4i<j\xe2\x89\xa4n) such that neither i nor j has been chosen in any previous operation and ai=aj. Then, add 1 to his score. Output the maximum score Kinich can achieve after performing the aforementioned operation any number of times." implementation -999
1811D "Umka and a Long Flight" "The girl Umka loves to travel and participate in math olympiads. One day she was flying by plane to the next olympiad and out of boredom explored a huge checkered sheet of paper.Denote the n-th Fibonacci number as Fn={1,n=0;1,n=1;Fn\xe2\x88\x922+Fn\xe2\x88\x921,n\xe2\x89\xa52.A checkered rectangle with a height of Fn and a width of Fn+1 is called a Fibonacci rectangle of order n.Umka has a Fibonacci rectangle of order n. Someone colored a cell in it at the intersection of the row x and the column y.It is necessary to cut this rectangle exactly into n+1 squares in such way that  the painted cell was in a square with a side of 1;  there was at most one pair of squares with equal sides;  the side of each square was equal to a Fibonacci number. Will Umka be able to cut this rectangle in that way?" "constructive algorithms,implementation,math" 1600
1673A "Subtle Substring Subtraction" "Alice and Bob are playing a game with strings. There will be t rounds in the game. In each round, there will be a string s consisting of lowercase English letters. Alice moves first and both the players take alternate turns. Alice is allowed to remove any substring of even length (possibly empty) and Bob is allowed to remove any substring of odd length from s.More formally, if there was a string s=s1s2\xe2\x80\xa6sk the player can choose a substring slsl+1\xe2\x80\xa6sr\xe2\x88\x921sr with length of corresponding parity and remove it. After that the string will become s=s1\xe2\x80\xa6sl\xe2\x88\x921sr+1\xe2\x80\xa6sk.After the string becomes empty, the round ends and each player calculates his/her score for this round. The score of a player is the sum of values of all characters removed by him/her. The value of a is 1, the value of b is 2, the value of c is 3, \xe2\x80\xa6, and the value of z is 26. The player with higher score wins the round. For each round, determine the winner and the difference between winner\'s and loser\'s scores. Assume that both players play optimally to maximize their score. It can be proved that a draw is impossible." games,greedy,strings 800
1703C Cypher "Luca has a cypher made up of a sequence of n wheels, each with a digit ai written on it. On the i-th wheel, he made bi moves. Each move is one of two types:   up move (denoted by U): it increases the i-th digit by 1. After applying the up move on 9, it becomes 0.  down move (denoted by D): it decreases the i-th digit by 1. After applying the down move on 0, it becomes 9.   Example for n=4. The current sequence is 0 0 0 0. Luca knows the final sequence of wheels and the moves for each wheel. Help him find the original sequence and crack the cypher." "brute force,implementation,strings" 800
1340A "Nastya and Strange Generator" "Denis was very sad after Nastya rejected him. So he decided to walk through the gateways to have some fun. And luck smiled at him! When he entered the first courtyard, he met a strange man who was selling something. Denis bought a mysterious item and it was... Random permutation generator! Denis could not believed his luck.When he arrived home, he began to study how his generator works and learned the algorithm. The process of generating a permutation consists of n steps. At the i-th step, a place is chosen for the number i (1\xe2\x89\xa4i\xe2\x89\xa4n). The position for the number i is defined as follows:  For all j from 1 to n, we calculate rj  \xe2\x80\x94 the minimum index such that j\xe2\x89\xa4rj\xe2\x89\xa4n, and the position rj is not yet occupied in the permutation. If there are no such positions, then we assume that the value of rj is not defined.  For all t from 1 to n, we calculate countt  \xe2\x80\x94 the number of positions 1\xe2\x89\xa4j\xe2\x89\xa4n such that rj is defined and rj=t.  Consider the positions that are still not occupied by permutation and among those we consider the positions for which the value in the count array is maximum.  The generator selects one of these positions for the number i. The generator can choose any position. Let\'s have a look at the operation of the algorithm in the following example:  Let n=5 and the algorithm has already arranged the numbers 1,2,3 in the permutation. Consider how the generator will choose a position for the number 4:  The values of r will be r=[3,3,3,4,\xc3\x97], where \xc3\x97 means an indefinite value.  Then the count values will be count=[0,0,3,1,0].  There are only two unoccupied positions in the permutation: 3 and 4. The value in the count array for position 3 is 3, for position 4 it is 1.  The maximum value is reached only for position 3, so the algorithm will uniquely select this position for number 4. Satisfied with his purchase, Denis went home. For several days without a break, he generated permutations. He believes that he can come up with random permutations no worse than a generator. After that, he wrote out the first permutation that came to mind p1,p2,\xe2\x80\xa6,pn and decided to find out if it could be obtained as a result of the generator.Unfortunately, this task was too difficult for him, and he asked you for help. It is necessary to define whether the written permutation could be obtained using the described algorithm if the generator always selects the position Denis needs." "brute force,data structures,greedy,implementation" 1500
939E Maximize! "You are given a multiset S consisting of positive integers (initially empty). There are two kind of queries:   Add a positive integer to S, the newly added integer is not less than any number in it.  Find a subset s of the set S such that the value  is maximum possible. Here max(s) means maximum value of elements in s,  \xe2\x80\x94 the average value of numbers in s. Output this maximum possible value of ." "binary search,greedy,ternary search,two pointers" 1800
36E "Two Paths" "Once archaeologists found m mysterious papers, each of which had a pair of integers written on them. Ancient people were known to like writing down the indexes of the roads they walked along, as \xc2\xaba b\xc2\xbb or \xc2\xabb a\xc2\xbb, where a,\xe2\x80\x89b are the indexes of two different cities joint by the road . It is also known that the mysterious papers are pages of two travel journals (those days a new journal was written for every new journey).During one journey the traveler could walk along one and the same road several times in one or several directions but in that case he wrote a new entry for each time in his journal. Besides, the archaeologists think that the direction the traveler took on a road had no effect upon the entry: the entry that looks like \xc2\xaba b\xc2\xbb could refer to the road from a to b as well as to the road from b to a.The archaeologists want to put the pages in the right order and reconstruct the two travel paths but unfortunately, they are bad at programming. That\xe2\x80\x99s where you come in. Go help them!" "constructive algorithms,dsu,graphs,implementation" 2600
744B "Hongcow\'s Game" "This is an interactive problem. In the interaction section below you will see the information about flushing the output.In this problem, you will be playing a game with Hongcow. How lucky of you!Hongcow has a hidden n by n matrix M. Let Mi,\xe2\x80\x89j denote the entry i-th row and j-th column of the matrix. The rows and columns are labeled from 1 to n.The matrix entries are between 0 and 109. In addition, Mi,\xe2\x80\x89i\xe2\x80\x89=\xe2\x80\x890 for all valid i. Your task is to find the minimum value along each row, excluding diagonal elements. Formally, for each i, you must find .To do this, you can ask Hongcow some questions.A question consists of giving Hongcow a subset of distinct indices {w1,\xe2\x80\x89w2,\xe2\x80\x89...,\xe2\x80\x89wk}, with 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n. Hongcow will respond with n integers. The i-th integer will contain the minimum value of min1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89kMi,\xe2\x80\x89wj.You may only ask Hongcow at most 20 questions \xe2\x80\x94 he thinks you only need that many questions answered.When you are ready to answer, print out a single integer \xe2\x80\x89-\xe2\x80\x891 on its own line, then n integers on the next line. The i-th integer should be the minimum value in the i-th row of the matrix, excluding the i-th element. Do not forget to flush the final answer as well. Printing the answer does not count as asking a question.You will get Wrong Answer verdict if   Your question or answers are not in the format described in this statement.  You ask strictly more than 20 questions.  Your question contains duplicate indices.  The value of k in your question does not lie in the range from 1 to n, inclusive.  Your final answer is not correct.  You will get Idleness Limit Exceeded if you don\'t print anything or if you forget to flush the output, including for the final answer (more info about flushing output below)." "bitmasks,divide and conquer,interactive" 1900
922F Divisibility "Imp is really pleased that you helped him. But it you solve the last problem, his gladness would raise even more.   Let\'s define  for some set of integers  as the number of pairs a, b in , such that:  a is strictly less than b;  a divides b without a remainder. You are to find such a set , which is a subset of {1,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89n} (the set that contains all positive integers not greater than n), that ." "constructive algorithms,dp,greedy,number theory" 2400
1131A "Sea Battle" "In order to make the ""Sea Battle"" game more interesting, Boris decided to add a new ship type to it. The ship consists of two rectangles. The first rectangle has a width of w1 and a height of h1, while the second rectangle has a width of w2 and a height of h2, where w1\xe2\x89\xa5w2. In this game, exactly one ship is used, made up of two rectangles. There are no other ships on the field.The rectangles are placed on field in the following way:  the second rectangle is on top the first rectangle;  they are aligned to the left, i.e. their left sides are on the same line;  the rectangles are adjacent to each other without a gap. See the pictures in the notes: the first rectangle is colored red, the second rectangle is colored blue.Formally, let\'s introduce a coordinate system. Then, the leftmost bottom cell of the first rectangle has coordinates (1,1), the rightmost top cell of the first rectangle has coordinates (w1,h1), the leftmost bottom cell of the second rectangle has coordinates (1,h1+1) and the rightmost top cell of the second rectangle has coordinates (w2,h1+h2).After the ship is completely destroyed, all cells neighboring by side or a corner with the ship are marked. Of course, only cells, which don\'t belong to the ship are marked. On the pictures in the notes such cells are colored green.Find out how many cells should be marked after the ship is destroyed. The field of the game is infinite in any direction." math 800
1619G "Unusual Minesweeper" "Polycarp is very fond of playing the game Minesweeper. Recently he found a similar game and there are such rules.There are mines on the field, for each the coordinates of its location are known (xi,yi). Each mine has a lifetime in seconds, after which it will explode. After the explosion, the mine also detonates all mines vertically and horizontally at a distance of k (two perpendicular lines). As a result, we get an explosion on the field in the form of a ""plus"" symbol (\'+\'). Thus, one explosion can cause new explosions, and so on.Also, Polycarp can detonate anyone mine every second, starting from zero seconds. After that, a chain reaction of explosions also takes place. Mines explode instantly and also instantly detonate other mines according to the rules described above.Polycarp wants to set a new record and asks you to help him calculate in what minimum number of seconds all mines can be detonated." "binary search,dfs and similar,dsu,greedy,sortings" 2000
333E "Summer Earnings" "Many schoolchildren look for a job for the summer, and one day, when Gerald was still a schoolboy, he also decided to work in the summer. But as Gerald was quite an unusual schoolboy, he found quite unusual work. A certain Company agreed to pay him a certain sum of money if he draws them three identical circles on a plane. The circles must not interfere with each other (but they may touch each other). He can choose the centers of the circles only from the n options granted by the Company. He is free to choose the radius of the circles himself (all three radiuses must be equal), but please note that the larger the radius is, the more he gets paid. Help Gerald earn as much as possible." "binary search,bitmasks,brute force,geometry,sortings" 2500
1450A "Avoid Trygub" "A string b is a subsequence of a string a if b can be obtained from a by deletion of several (possibly, zero or all) characters. For example, ""xy"" is a subsequence of ""xzyw"" and ""xy"", but not ""yx"".You are given a string a. Your task is to reorder the characters of a so that ""trygub"" is not a subsequence of the resulting string.In other words, you should find a string b which is a permutation of symbols of the string a and ""trygub"" is not a subsequence of b.We have a truly marvelous proof that any string can be arranged not to contain ""trygub"" as a subsequence, but this problem statement is too short to contain it." "constructive algorithms,sortings" 800
1841A "Game with Board" "Alice and Bob play a game. They have a blackboard; initially, there are n integers written on it, and each integer is equal to 1.Alice and Bob take turns; Alice goes first. On their turn, the player has to choose several (at least two) equal integers on the board, wipe them and write a new integer which is equal to their sum.For example, if the board currently contains integers {1,1,2,2,2,3}, then the following moves are possible:  choose two integers equal to 1, wipe them and write an integer 2, then the board becomes {2,2,2,2,3};  choose two integers equal to 2, wipe them and write an integer 4, then the board becomes {1,1,2,3,4};  choose three integers equal to 2, wipe them and write an integer 6, then the board becomes {1,1,3,6}. If a player cannot make a move (all integers on the board are different), that player wins the game.Determine who wins if both players play optimally." "constructive algorithms,games" 800
2035F "Tree Operations" "This really says a lot about our society.One day, a turtle gives you a tree with n nodes rooted at node x. Each node has an initial nonnegative value; the i-th node has starting value ai.You want to make the values of all nodes equal to 0. To do so, you will perform a series of operations on the tree, where each operation will be performed on a certain node. Define an operation on node u as choosing a single node in u\'s subtree\xe2\x88\x97 and incrementing or decrementing its value by 1. The order in which operations are performed on nodes is as follows:  For 1\xe2\x89\xa4i\xe2\x89\xa4n, the i-th operation will be performed on node i.  For i>n, the i-th operation will be performed on the same node as operation i\xe2\x88\x92n. More formally, the i-th operation will be performed on the (((i\xe2\x88\x921)modn)+1)-th node.\xe2\x80\xa0Note that you cannot skip over operations; that is, you cannot perform the i-th operation without first performing operations 1,2,\xe2\x80\xa6,i\xe2\x88\x921.Find the minimum number of operations you must perform before you can make the values of all nodes equal to 0, assuming you pick operations optimally. If it\'s impossible to make the values of all nodes equal to 0 after finite operations, output \xe2\x88\x921.\xe2\x88\x97The subtree of a node u is the set of nodes for which u lies on the shortest path from this node to the root, including u itself.\xe2\x80\xa0Here, amodb denotes the remainder from dividing a by b." "binary search,brute force,dfs and similar,dp,trees" 2500
1778F "Maximizing Root" "You are given a rooted tree consisting of n vertices numbered from 1 to n. Vertex 1 is the root of the tree. Each vertex has an integer value. The value of i-th vertex is ai. You can do the following operation at most k times.  Choose a vertex v that has not been chosen before and an integer x such that x is a common divisor of the values of all vertices of the subtree of v. Multiply by x the value of each vertex in the subtree of v. What is the maximum possible value of the root node 1 after at most k operations? Formally, you have to maximize the value of a1.A tree is a connected undirected graph without cycles. A rooted tree is a tree with a selected vertex, which is called the root. The subtree of a node u is the set of all nodes y such that the simple path from y to the root passes through u. Note that u is in the subtree of u." "dfs and similar,dp,graphs,math,number theory,trees" 2600
818A "Diplomas and Certificates" "There are n students who have taken part in an olympiad. Now it\'s time to award the students.Some of them will receive diplomas, some wiil get certificates, and others won\'t receive anything. Students with diplomas and certificates are called winners. But there are some rules of counting the number of diplomas and certificates. The number of certificates must be exactly k times greater than the number of diplomas. The number of winners must not be greater than half of the number of all students (i.e. not be greater than half of n). It\'s possible that there are no winners.You have to identify the maximum possible number of winners, according to these rules. Also for this case you have to calculate the number of students with diplomas, the number of students with certificates and the number of students who are not winners." implementation,math 800
935C "Fifa and Fafa" "Fifa and Fafa are sharing a flat. Fifa loves video games and wants to download a new soccer game. Unfortunately, Fafa heavily uses the internet which consumes the quota. Fifa can access the internet through his Wi-Fi access point. This access point can be accessed within a range of r meters (this range can be chosen by Fifa) from its position. Fifa must put the access point inside the flat which has a circular shape of radius R. Fifa wants to minimize the area that is not covered by the access point inside the flat without letting Fafa or anyone outside the flat to get access to the internet.The world is represented as an infinite 2D plane. The flat is centered at (x1,\xe2\x80\x89y1) and has radius R and Fafa\'s laptop is located at (x2,\xe2\x80\x89y2), not necessarily inside the flat. Find the position and the radius chosen by Fifa for his access point which minimizes the uncovered area." geometry 1600
725A "Jumping Ball" "In a new version of the famous Pinball game, one of the most important parts of the game field is a sequence of n bumpers. The bumpers are numbered with integers from 1 to n from left to right. There are two types of bumpers. They are denoted by the characters \'<\' and \'>\'. When the ball hits the bumper at position i it goes one position to the right (to the position i\xe2\x80\x89+\xe2\x80\x891) if the type of this bumper is \'>\', or one position to the left (to i\xe2\x80\x89-\xe2\x80\x891) if the type of the bumper at position i is \'<\'. If there is no such position, in other words if i\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89<\xe2\x80\x891 or i\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89>\xe2\x80\x89n, the ball falls from the game field.Depending on the ball\'s starting position, the ball may eventually fall from the game field or it may stay there forever. You are given a string representing the bumpers\' types. Calculate the number of positions such that the ball will eventually fall from the game field if it starts at that position." implementation 1000
1091H "New Year and the Tricolore Recreation" "Alice and Bob play a game on a grid with n rows and infinitely many columns. In each row, there are three tokens, blue, white and red one. Before the game starts and after every move, the following two conditions must hold:   Any two tokens are not in the same cell.  In each row, the blue token is to the left of the white token, and the red token is to the right of the white token. First, they pick a positive integer f, whose value is valid for the whole game. Second, the starting player is chosen and makes his or her first turn. Then players take alternating turns. The player who is unable to make a move loses. During a move, a player first selects an integer k that is either a prime number or a product of two (not necessarily distinct) primes. The smallest possible values of k are thus 2,3,4,5,6,7,9,10,11,13,14,15,17,19,\xe2\x80\xa6. Furthermore, k must not be equal to the previously picked integer f. Each turn, a move is performed in exactly one of the rows.If it is Alice\'s turn, she chooses a single blue token and moves it k cells to the right. Alternatively, she may move both the blue and the white token in the same row by the same amount k to the right.On the other hand, Bob selects a single red token and moves it k cells to the left. Similarly, he may also move the white and the red token in the corresponding row by k to the left.Note that Alice may never move a red token, while Bob may never move a blue one. Remember that after a move, the two conditions on relative positions of the tokens must still hold. Both players play optimally. Given the initial state of the board, determine who wins for two games: if Alice starts and if Bob starts." games 3200
405E "Graph Cutting" "Little Chris is participating in a graph cutting contest. He\'s a pro. The time has come to test his skills to the fullest.Chris is given a simple undirected connected graph with n vertices (numbered from 1 to n) and m edges. The problem is to cut it into edge-distinct paths of length 2. Formally, Chris has to partition all edges of the graph into pairs in such a way that the edges in a single pair are adjacent and each edge must be contained in exactly one pair.For example, the figure shows a way Chris can cut a graph. The first sample test contains the description of this graph.  You are given a chance to compete with Chris. Find a way to cut the given graph or determine that it is impossible!" "dfs and similar,graphs" 2300
2022B "Kar Salesman" "Karel is a salesman in a car dealership. The dealership has n different models of cars. There are ai cars of the i-th model. Karel is an excellent salesperson and can convince customers to buy up to x cars (of Karel\'s choice), as long as the cars are from different models.Determine the minimum number of customers Karel has to bring in to sell all the cars." "binary search,greedy,math" 1300
1526B "I Hate 1111" "You are given an integer x. Can you make x by summing up some number of 11,111,1111,11111,\xe2\x80\xa6? (You can use any number among them any number of times).For instance,   33=11+11+11  144=111+11+11+11" "dp,math,number theory" 1400
478A "Initial Bet" "There are five people playing a game called ""Generosity"". Each person gives some non-zero number of coins b as an initial bet. After all players make their bets of b coins, the following operation is repeated for several times: a coin is passed from one player to some other player.Your task is to write a program that can, given the number of coins each player has at the end of the game, determine the size b of the initial bet or find out that such outcome of the game cannot be obtained for any positive number of coins b in the initial bet." implementation 1100
1737G "Ela Takes Dancing Class" "DTL engineers love partying in the weekend. Ela does, too! Unfortunately, she didn\'t know how to dance yet. Therefore, she decided to take a dancing class.There are n students in the dancing class, including Ela. In the final project, n students will participate in a choreography described below.n students are positioned on the positive side of the Ox-axis. The i-th dancer is located at ai>0. Some dancers will change positions during the dance (we\'ll call them movable dancers), and others will stay in the same place during a choreography (we\'ll call them immovable dancers). We distinguish the dancers using a binary string s of length n: if si equals \'1\', then the i-th dancer is movable, otherwise the i-th dancer is immovable.Let\'s call the ""positive energy value"" of the choreography d>0. The dancers will perform ""movements"" based on this value.Each minute after the dance begins, the movable dancer with the smallest x-coordinate will start moving to the right and initiate a ""movement"". At the beginning of the movement, the dancer\'s energy level will be initiated equally to the positive energy value of the choreography, which is d. Each time they move from some y to y+1, the energy level will be decreased by 1. At some point, the dancer might meet other fellow dancers in the same coordinates. If it happens, then the energy level of the dancer will be increased by 1. A dancer will stop moving to the right when his energy level reaches 0, and he doesn\'t share a position with another dancer.The dancers are very well-trained, and each ""movement"" will end before the next minute begins.To show her understanding of this choreography, Ela has to answer q queries, each consisting of two integers k and m. The answer to this query is the coordinate of the m-th dancer of both types from the left at k-th minute after the choreography begins. In other words, denote xk,1,xk,2,\xe2\x80\xa6,xk,n as the sorted coordinates of the dancers at k-th minute from the beginning, you need to print xk,m." "binary search,data structures" 3500
1614C "Divan and bitwise operations" "Once Divan analyzed a sequence a1,a2,\xe2\x80\xa6,an consisting of n non-negative integers as follows. He considered each non-empty subsequence of the sequence a, computed the bitwise XOR of its elements and added up all the XORs, obtaining the coziness of the sequence a.A sequence c is a subsequence of a sequence d if c can be obtained from d by deletion of several (possibly, zero or all) elements. For example, [1,2,3,4], [2,4], and [2] are subsequences of [1,2,3,4], but [4,3] and [0] are not.Divan was very proud of his analysis, but now he lost the sequence a, and also the coziness value! However, Divan remembers the value of bitwise OR on m contiguous subsegments of the sequence a. It turns out that each element of the original sequence is contained in at least one of these m segments.Divan asks you to help find the coziness of the sequence a using the information he remembers. If several coziness values are possible, print any.As the result can be very large, print the value modulo 109+7." "bitmasks,combinatorics,constructive algorithms,dp,math" 1500
915F "Imbalance Value of a Tree" "You are given a tree T consisting of n vertices. A number is written on each vertex; the number written on vertex i is ai. Let\'s denote the function I(x,\xe2\x80\x89y) as the difference between maximum and minimum value of ai on a simple path connecting vertices x and y.Your task is to calculate ." "data structures,dsu,graphs,trees" 2400
74A "Room Leader" "Let us remind you part of the rules of Codeforces. The given rules slightly simplified, use the problem statement as a formal document.In the beginning of the round the contestants are divided into rooms. Each room contains exactly n participants. During the contest the participants are suggested to solve five problems, A, B, C, D and E. For each of these problem, depending on when the given problem was solved and whether it was solved at all, the participants receive some points. Besides, a contestant can perform hacks on other contestants. For each successful hack a contestant earns 100 points, for each unsuccessful hack a contestant loses 50 points. The number of points for every contestant is represented by the sum of points he has received from all his problems, including hacks.You are suggested to determine the leader for some room; the leader is a participant who has maximum points." implementation 1000
1700F Puzzle "Pupils Alice and Ibragim are best friends. It\'s Ibragim\'s birthday soon, so Alice decided to gift him a new puzzle. The puzzle can be represented as a matrix with 2 rows and n columns, every element of which is either 0 or 1. In one move you can swap two values in neighboring cells.More formally, let\'s number rows 1 to 2 from top to bottom, and columns 1 to n from left to right. Also, let\'s denote a cell in row x and column y as (x,y). We consider cells (x1,y1) and (x2,y2) neighboring if |x1\xe2\x88\x92x2|+|y1\xe2\x88\x92y2|=1.Alice doesn\'t like the way in which the cells are currently arranged, so she came up with her own arrangement, with which she wants to gift the puzzle to Ibragim. Since you are her smartest friend, she asked you to help her find the minimal possible number of operations in which she can get the desired arrangement. Find this number, or determine that it\'s not possible to get the new arrangement." "constructive algorithms,dp,greedy" 2600
1038A Equality "You are given a string s of length n, which consists only of the first k letters of the Latin alphabet. All letters in string s are uppercase.A subsequence of string s is a string that can be derived from s by deleting some of its symbols without changing the order of the remaining symbols. For example, ""ADE"" and ""BD"" are subsequences of ""ABCDE"", but ""DEA"" is not.A subsequence of s called good if the number of occurences of each of the first k letters of the alphabet is the same.Find the length of the longest good subsequence of s." implementation,strings 800
1136E "Nastya Hasn\'t Written a Legend" "In this task, Nastya asked us to write a formal statement.An array a of length n and an array k of length n\xe2\x88\x921 are given. Two types of queries should be processed:   increase ai by x. Then if ai+1<ai+ki, ai+1 becomes exactly ai+ki; again, if ai+2<ai+1+ki+1, ai+2 becomes exactly ai+1+ki+1, and so far for ai+3, ..., an;  print the sum of the contiguous subarray from the l-th element to the r-th element of the array a. It\'s guaranteed that initially ai+ki\xe2\x89\xa4ai+1 for all 1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921." "binary search,data structures" 2200
1579E1 "Permutation Minimization by Deque" "In fact, the problems E1 and E2 do not have much in common. You should probably think of them as two separate problems.A permutation p of size n is given. A permutation of size n is an array of size n in which each integer from 1 to n occurs exactly once. For example, [1,4,3,2] and [4,2,1,3] are correct permutations while [1,2,4] and [1,2,2] are not.Let us consider an empty deque (double-ended queue). A deque is a data structure that supports adding elements to both the beginning and the end. So, if there are elements [1,5,2] currently in the deque, adding an element 4 to the beginning will produce the sequence [4,1,5,2], and adding same element to the end will produce [1,5,2,4].The elements of the permutation are sequentially added to the initially empty deque, starting with p1 and finishing with pn. Before adding each element to the deque, you may choose whether to add it to the beginning or the end.For example, if we consider a permutation p=[3,1,2,4], one of the possible sequences of actions looks like this:  1.add 3 to the end of the deque:deque has a sequence [3] in it; 2.add 1 to the beginning of the deque:deque has a sequence [1,3] in it; 3.add 2 to the end of the deque:deque has a sequence [1,3,2] in it; 4.add 4 to the end of the deque:deque has a sequence [1,3,2,4] in it;Find the lexicographically smallest possible sequence of elements in the deque after the entire permutation has been processed. A sequence [x1,x2,\xe2\x80\xa6,xn] is lexicographically smaller than the sequence [y1,y2,\xe2\x80\xa6,yn] if there exists such i\xe2\x89\xa4n that x1=y1, x2=y2, \xe2\x80\xa6, xi\xe2\x88\x921=yi\xe2\x88\x921 and xi<yi. In other words, if the sequences x and y have some (possibly empty) matching prefix, and the next element of the sequence x is strictly smaller than the corresponding element of the sequence y. For example, the sequence [1,3,2,4] is smaller than the sequence [1,3,4,2] because after the two matching elements [1,3] in the start the first sequence has an element 2 which is smaller than the corresponding element 4 in the second sequence." "constructive algorithms,greedy,math" 1000
1557B "Moamen and k-subarrays" "Moamen has an array of n distinct integers. He wants to sort that array in non-decreasing order by doing the following operations in order exactly once:  Split the array into exactly k non-empty subarrays such that each element belongs to exactly one subarray.  Reorder these subarrays arbitrary.  Merge the subarrays in their new order. A sequence a is a subarray of a sequence b if a can be obtained from b by deletion of several (possibly, zero or all) elements from the beginning and several (possibly, zero or all) elements from the end.Can you tell Moamen if there is a way to sort the array in non-decreasing order using the operations written above?" greedy,sortings 1100
1809B "Points on Plane" "You are given a two-dimensional plane, and you need to place n chips on it. You can place a chip only at a point with integer coordinates. The cost of placing a chip at the point (x,y) is equal to |x|+|y| (where |a| is the absolute value of a).The cost of placing n chips is equal to the maximum among the costs of each chip.You need to place n chips on the plane in such a way that the Euclidean distance between each pair of chips is strictly greater than 1, and the cost is the minimum possible." "binary search,greedy,math" 1000
817D "Imbalanced Array" "You are given an array a consisting of n elements. The imbalance value of some subsegment of this array is the difference between the maximum and minimum element from this segment. The imbalance value of the array is the sum of imbalance values of all subsegments of this array.For example, the imbalance value of array [1,\xe2\x80\x894,\xe2\x80\x891] is 9, because there are 6 different subsegments of this array:   [1] (from index 1 to index 1), imbalance value is 0;  [1,\xe2\x80\x894] (from index 1 to index 2), imbalance value is 3;  [1,\xe2\x80\x894,\xe2\x80\x891] (from index 1 to index 3), imbalance value is 3;  [4] (from index 2 to index 2), imbalance value is 0;  [4,\xe2\x80\x891] (from index 2 to index 3), imbalance value is 3;  [1] (from index 3 to index 3), imbalance value is 0; You have to determine the imbalance value of the array a." "data structures,divide and conquer,dsu,sortings" 1900
1118E "Yet Another Ball Problem" "The king of Berland organizes a ball! n pair are invited to the ball, they are numbered from 1 to n. Each pair consists of one man and one woman. Each dancer (either man or woman) has a monochrome costume. The color of each costume is represented by an integer from 1 to k, inclusive.Let bi be the color of the man\'s costume and gi be the color of the woman\'s costume in the i-th pair. You have to choose a color for each dancer\'s costume (i.e. values b1,b2,\xe2\x80\xa6,bn and g1,g2,\xe2\x80\xa6gn) in such a way that:  for every i: bi and gi are integers between 1 and k, inclusive;  there are no two completely identical pairs, i.e. no two indices i,j (i\xe2\x89\xa0j) such that bi=bj and gi=gj at the same time;  there is no pair such that the color of the man\'s costume is the same as the color of the woman\'s costume in this pair, i.e. bi\xe2\x89\xa0gi for every i;  for each two consecutive (adjacent) pairs both man\'s costume colors and woman\'s costume colors differ, i.e. for every i from 1 to n\xe2\x88\x921 the conditions bi\xe2\x89\xa0bi+1 and gi\xe2\x89\xa0gi+1 hold. Let\'s take a look at the examples of bad and good color choosing (for n=4 and k=3, man is the first in a pair and woman is the second):Bad color choosing:   (1,2), (2,3), (3,2), (1,2) \xe2\x80\x94 contradiction with the second rule (there are equal pairs);  (2,3), (1,1), (3,2), (1,3) \xe2\x80\x94 contradiction with the third rule (there is a pair with costumes of the same color);  (1,2), (2,3), (1,3), (2,1) \xe2\x80\x94 contradiction with the fourth rule (there are two consecutive pairs such that colors of costumes of men/women are the same). Good color choosing:   (1,2), (2,1), (1,3), (3,1);  (1,2), (3,1), (2,3), (3,2);  (3,1), (1,2), (2,3), (3,2). You have to find any suitable color choosing or say that no suitable choosing exists." "constructive algorithms,implementation" 1700
1830D "Mex Tree" "You are given a tree with n nodes. For each node, you either color it in 0 or 1.The value of a path (u,v) is equal to the MEX\xe2\x80\xa0 of the colors of the nodes from the shortest path between u and v.The value of a coloring is equal to the sum of values of all paths (u,v) such that 1\xe2\x89\xa4u\xe2\x89\xa4v\xe2\x89\xa4n.What is the maximum possible value of any coloring of the tree?\xe2\x80\xa0 The MEX (minimum excluded) of an array is the smallest non-negative integer that does not belong to the array. For instance:  The MEX of [2,2,1] is 0, because 0 does not belong to the array.  The MEX of [3,1,0,1] is 2, because 0 and 1 belong to the array, but 2 does not.  The MEX of [0,3,1,2] is 4 because 0, 1, 2, and 3 belong to the array, but 4 does not." "brute force,dp,trees" 2800
1540C1 "Converging Array (Easy Version)" "This is the easy version of the problem. The only difference is that in this version q=1. You can make hacks only if both versions of the problem are solved.There is a process that takes place on arrays a and b of length n and length n\xe2\x88\x921 respectively. The process is an infinite sequence of operations. Each operation is as follows:   First, choose a random integer i (1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921).  Then, simultaneously set ai=min(ai,ai+ai+1\xe2\x88\x92bi2) and ai+1=max(ai+1,ai+ai+1+bi2) without any rounding (so values may become non-integer).  See notes for an example of an operation.It can be proven that array a converges, i. e. for each i there exists a limit ai converges to. Let function F(a,b) return the value a1 converges to after a process on a and b.You are given array b, but not array a. However, you are given a third array c. Array a is good if it contains only integers and satisfies 0\xe2\x89\xa4ai\xe2\x89\xa4ci for 1\xe2\x89\xa4i\xe2\x89\xa4n.Your task is to count the number of good arrays a where F(a,b)\xe2\x89\xa5x for q values of x. Since the number of arrays can be very large, print it modulo 109+7." dp,math 2700
740A "Alyona and copybooks" "Little girl Alyona is in a shop to buy some copybooks for school. She study four subjects so she wants to have equal number of copybooks for each of the subjects. There are three types of copybook\'s packs in the shop: it is possible to buy one copybook for a rubles, a pack of two copybooks for b rubles, and a pack of three copybooks for c rubles. Alyona already has n copybooks.What is the minimum amount of rubles she should pay to buy such number of copybooks k that n\xe2\x80\x89+\xe2\x80\x89k is divisible by 4? There are infinitely many packs of any type in the shop. Alyona can buy packs of different type in the same purchase." "brute force,implementation" 1300
2022E1 "Billetes MX (Easy Version)" "This is the easy version of the problem. In this version, it is guaranteed that q=0. You can make hacks only if both versions of the problem are solved.An integer grid A with p rows and q columns is called beautiful if:   All elements of the grid are integers between 0 and 230\xe2\x88\x921, and  For any subgrid, the XOR of the values at the corners is equal to 0. Formally, for any four integers i1, i2, j1, j2 (1\xe2\x89\xa4i1<i2\xe2\x89\xa4p; 1\xe2\x89\xa4j1<j2\xe2\x89\xa4q), Ai1,j1\xe2\x8a\x95Ai1,j2\xe2\x8a\x95Ai2,j1\xe2\x8a\x95Ai2,j2=0, where \xe2\x8a\x95 denotes the bitwise XOR operation. There is a partially filled integer grid G with n rows and m columns where only k cells are filled. Polycarp wants to know how many ways he can assign integers to the unfilled cells so that the grid is beautiful.However, Monocarp thinks that this problem is too easy. Therefore, he will perform q updates on the grid. In each update, he will choose an unfilled cell and assign an integer to it. Note that these updates are persistent. That is, changes made to the grid will apply when processing future updates.For each of the q+1 states of the grid, the initial state and after each of the q queries, determine the number of ways Polycarp can assign integers to the unfilled cells so that the grid is beautiful. Since this number can be very large, you are only required to output their values modulo 109+7." "2-sat,binary search,combinatorics,constructive algorithms,dfs and similar,dsu,graphs" 2500
1721F "Matching Reduction" "You are given a bipartite graph with n1 vertices in the first part, n2 vertices in the second part, and m edges. The maximum matching in this graph is the maximum possible (by size) subset of edges of this graph such that no vertex is incident to more than one chosen edge.You have to process two types of queries to this graph:  1 \xe2\x80\x94 remove the minimum possible number of vertices from this graph so that the size of the maximum matching gets reduced exactly by 1, and print the vertices that you have removed. Then, find any maximum matching in this graph and print the sum of indices of edges belonging to this matching;  2 \xe2\x80\x94 query of this type will be asked only after a query of type 1. As the answer to this query, you have to print the edges forming the maximum matching you have chosen in the previous query. Note that you should solve the problem in online mode. It means that you can\'t read the whole input at once. You can read each query only after writing the answer for the last query. Use functions fflush in C++ and BufferedWriter.flush in Java languages after each writing in your program." "brute force,constructive algorithms,dfs and similar,flows,graph matchings,graphs,interactive" 2800
1200B "Block Adventure" "Gildong is playing a video game called Block Adventure. In Block Adventure, there are n columns of blocks in a row, and the columns are numbered from 1 to n. All blocks have equal heights. The height of the i-th column is represented as hi, which is the number of blocks stacked in the i-th column.Gildong plays the game as a character that can stand only on the top of the columns. At the beginning, the character is standing on the top of the 1-st column. The goal of the game is to move the character to the top of the n-th column.The character also has a bag that can hold infinitely many blocks. When the character is on the top of the i-th column, Gildong can take one of the following three actions as many times as he wants:   if there is at least one block on the column, remove one block from the top of the i-th column and put it in the bag;  if there is at least one block in the bag, take one block out of the bag and place it on the top of the i-th column;  if i<n and |hi\xe2\x88\x92hi+1|\xe2\x89\xa4k, move the character to the top of the i+1-st column. k is a non-negative integer given at the beginning of the game. Note that it is only possible to move to the next column. In actions of the first two types the character remains in the i-th column, and the value hi changes.The character initially has m blocks in the bag. Gildong wants to know if it is possible to win the game. Help Gildong find the answer to his question." dp,greedy 1200
1829D "Gold Rush" "Initially you have a single pile with n gold nuggets. In an operation you can do the following:   Take any pile and split it into two piles, so that one of the resulting piles has exactly twice as many gold nuggets as the other. (All piles should have an integer number of nuggets.)   One possible move is to take a pile of size 6 and split it into piles of sizes 2 and 4, which is valid since 4 is twice as large as 2.  Can you make a pile with exactly m gold nuggets using zero or more operations?" "brute force,dfs and similar,dp,implementation" 1000
218A "Mountain Scenery" "Little Bolek has found a picture with n mountain peaks painted on it. The n painted peaks are represented by a non-closed polyline, consisting of 2n segments. The segments go through 2n\xe2\x80\x89+\xe2\x80\x891 points with coordinates (1,\xe2\x80\x89y1), (2,\xe2\x80\x89y2), ..., (2n\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89y2n\xe2\x80\x89+\xe2\x80\x891), with the i-th segment connecting the point (i,\xe2\x80\x89yi) and the point (i\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89yi\xe2\x80\x89+\xe2\x80\x891). For any even i (2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x892n) the following condition holds: yi\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89<\xe2\x80\x89yi and yi\xe2\x80\x89>\xe2\x80\x89yi\xe2\x80\x89+\xe2\x80\x891. We shall call a vertex of a polyline with an even x coordinate a mountain peak.   The figure to the left shows the initial picture, the figure to the right shows what the picture looks like after Bolek\'s actions. The affected peaks are marked red, k = 2.  Bolek fancied a little mischief. He chose exactly k mountain peaks, rubbed out the segments that went through those peaks and increased each peak\'s height by one (that is, he increased the y coordinate of the corresponding points). Then he painted the missing segments to get a new picture of mountain peaks. Let us denote the points through which the new polyline passes on Bolek\'s new picture as (1,\xe2\x80\x89r1), (2,\xe2\x80\x89r2), ..., (2n\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89r2n\xe2\x80\x89+\xe2\x80\x891).Given Bolek\'s final picture, restore the initial one." "brute force,constructive algorithms,implementation" 1100
382E "Ksenia and Combinatorics" "Ksenia has her winter exams. Today she is learning combinatorics. Here\'s one of the problems she needs to learn to solve.How many distinct trees are there consisting of n vertices, each with the following properties:  the tree is marked, that is, the vertices of the tree are numbered from 1 to n;  each vertex of the tree is connected with at most three other vertices, and at the same moment the vertex with number 1 is connected with at most two other vertices;  the size of the tree\'s maximum matching equals k. Two trees are considered distinct if there are such two vertices u and v, that in one tree they are connected by an edge and in the other tree they are not.Help Ksenia solve the problem for the given n and k. As the answer to the problem can be very huge you should output it modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." combinatorics,dp 2600
1174E "Ehab and the Expected GCD Problem" "Let\'s define a function f(p) on a permutation p as follows. Let gi be the greatest common divisor (GCD) of elements p1, p2, ..., pi (in other words, it is the GCD of the prefix of length i). Then f(p) is the number of distinct elements among g1, g2, ..., gn.Let fmax(n) be the maximum value of f(p) among all permutations p of integers 1, 2, ..., n.Given an integers n, count the number of permutations p of integers 1, 2, ..., n, such that f(p) is equal to fmax(n). Since the answer may be large, print the remainder of its division by 1000000007=109+7." "combinatorics,dp,math,number theory" 2500
52B "Right Triangles" "You are given a n\xe2\x80\x89\xc3\x97\xe2\x80\x89m field consisting only of periods (\'.\') and asterisks (\'*\'). Your task is to count all right triangles with two sides parallel to the square sides, whose vertices are in the centers of \'*\'-cells. A right triangle is a triangle in which one angle is a right angle (that is, a 90 degree angle)." combinatorics 1600
1730B "Meeting on the Line" "n people live on the coordinate line, the i-th one lives at the point xi (1\xe2\x89\xa4i\xe2\x89\xa4n). They want to choose a position x0 to meet. The i-th person will spend |xi\xe2\x88\x92x0| minutes to get to the meeting place. Also, the i-th person needs ti minutes to get dressed, so in total he or she needs ti+|xi\xe2\x88\x92x0| minutes. Here |y| denotes the absolute value of y.These people ask you to find a position x0 that minimizes the time in which all n people can gather at the meeting place." "binary search,geometry,greedy,implementation,math,ternary search" 1600
1945D "Seraphim the Owl" "The guys lined up in a queue of n people, starting with person number i=1, to ask Serafim the Owl about the meaning of life. Unfortunately, Kirill was very busy writing the legend for this problem, so he arrived a little later and stood at the end of the line after the n-th person. Kirill is completely dissatisfied with this situation, so he decided to bribe some people ahead of him.For the i-th person in the queue, Kirill knows two values: ai and bi. If at the moment Kirill is standing at position i, then he can choose any position j such that j<i and exchange places with the person at position j. In this case, Kirill will have to pay him aj coins. And for each k such that j<k<i, Kirill will have to pay bk coins to the person at position k. Kirill can perform this action any number of times.Kirill is thrifty, so he wants to spend as few coins as possible, but he doesn\'t want to wait too long, so Kirill believes he should be among the first m people in line.Help Kirill determine the minimum number of coins he will have to spend in order to not wait too long." dp,greedy 1300
1391A Suborrays "A permutation of length n is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array) and [1,3,4] is also not a permutation (n=3 but there is 4 in the array).For a positive integer n, we call a permutation p of length n good if the following condition holds for every pair i and j (1\xe2\x89\xa4i\xe2\x89\xa4j\xe2\x89\xa4n) \xe2\x80\x94   (pi OR pi+1 OR \xe2\x80\xa6 OR pj\xe2\x88\x921 OR pj)\xe2\x89\xa5j\xe2\x88\x92i+1, where OR denotes the bitwise OR operation. In other words, a permutation p is good if for every subarray of p, the OR of all elements in it is not less than the number of elements in that subarray. Given a positive integer n, output any good permutation of length n. We can show that for the given constraints such a permutation always exists." "constructive algorithms,math" 800
725C "Hidden Word" "Let\xe2\x80\x99s define a grid to be a set of tiles with 2 rows and 13 columns. Each tile has an English letter written in it. The letters don\'t have to be unique: there might be two or more tiles with the same letter written on them. Here is an example of a grid: ABCDEFGHIJKLMNOPQRSTUVWXYZ We say that two tiles are adjacent if they share a side or a corner. In the example grid above, the tile with the letter \'A\' is adjacent only to the tiles with letters \'B\', \'N\', and \'O\'. A tile is not adjacent to itself.A sequence of tiles is called a path if each tile in the sequence is adjacent to the tile which follows it (except for the last tile in the sequence, which of course has no successor). In this example, ""ABC"" is a path, and so is ""KXWIHIJK"". ""MAB"" is not a path because \'M\' is not adjacent to \'A\'. A single tile can be used more than once by a path (though the tile cannot occupy two consecutive places in the path because no tile is adjacent to itself).You\xe2\x80\x99re given a string s which consists of 27 upper-case English letters. Each English letter occurs at least once in s. Find a grid that contains a path whose tiles, viewed in the order that the path visits them, form the string s. If there\xe2\x80\x99s no solution, print ""Impossible"" (without the quotes)." "brute force,constructive algorithms,implementation,strings" 1600
208E "Blood Cousins" "Polycarpus got hold of a family relationship tree. The tree describes family relationships of n people, numbered 1 through n. Each person in the tree has no more than one parent.Let\'s call person a a 1-ancestor of person b, if a is the parent of b.Let\'s call person a a k-ancestor (k\xe2\x80\x89>\xe2\x80\x891) of person b, if person b has a 1-ancestor, and a is a (k\xe2\x80\x89-\xe2\x80\x891)-ancestor of b\'s 1-ancestor. Family relationships don\'t form cycles in the found tree. In other words, there is no person who is his own ancestor, directly or indirectly (that is, who is an x-ancestor for himself, for some x, x\xe2\x80\x89>\xe2\x80\x890).Let\'s call two people x and y (x\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89y) p-th cousins (p\xe2\x80\x89>\xe2\x80\x890), if there is person z, who is a p-ancestor of x and a p-ancestor of y.Polycarpus wonders how many counsins and what kinds of them everybody has. He took a piece of paper and wrote m pairs of integers vi, pi. Help him to calculate the number of pi-th cousins that person vi has, for each pair vi, pi." "binary search,data structures,dfs and similar,trees" 2100
1689D "Lena and Matrix" "Lena is a beautiful girl who likes logical puzzles.As a gift for her birthday, Lena got a matrix puzzle!The matrix consists of n rows and m columns, and each cell is either black or white. The coordinates (i,j) denote the cell which belongs to the i-th row and j-th column for every 1\xe2\x89\xa4i\xe2\x89\xa4n and 1\xe2\x89\xa4j\xe2\x89\xa4m. To solve the puzzle, Lena has to choose a cell that minimizes the Manhattan distance to the farthest black cell from the chosen cell.More formally, let there be k\xe2\x89\xa51 black cells in the matrix with coordinates (xi,yi) for every 1\xe2\x89\xa4i\xe2\x89\xa4k. Lena should choose a cell (a,b) that minimizes kmaxi=1(|a\xe2\x88\x92xi|+|b\xe2\x88\x92yi|).As Lena has no skill, she asked you for help. Will you tell her the optimal cell to choose?" "data structures,dp,geometry,shortest paths" 1900
13A Numbers "Little Petya likes numbers a lot. He found that number 123 in base 16 consists of two digits: the first is 7 and the second is 11. So the sum of digits of 123 in base 16 is equal to 18.Now he wonders what is an average value of sum of digits of the number A written in all bases from 2 to A\xe2\x80\x89-\xe2\x80\x891.Note that all computations should be done in base 10. You should find the result as an irreducible fraction, written in base 10." implementation,math 1000
1753F "Minecraft Series" "Little Misha goes to the programming club and solves nothing there. It may seem strange, but when you find out that Misha is filming a Minecraft series, everything will fall into place...Misha is inspired by Manhattan, so he built a city in Minecraft that can be imagined as a table of size n\xc3\x97m. k students live in a city, the i-th student lives in the house, located at the intersection of the xi-th row and the yi-th column. Also, each student has a degree of his aggressiveness wi. Since the city turned out to be very large, Misha decided to territorially limit the actions of his series to some square s, which sides are parallel to the coordinate axes. The length of the side of the square should be an integer from 1 to min(n,m) cells.According to the plot, the main hero will come to the city and accidentally fall into the square s. Possessing a unique degree of aggressiveness 0, he will be able to show his leadership qualities and assemble a team of calm, moderate and aggressive students.In order for the assembled team to be versatile and close-knit, degrees of aggressiveness of all students of the team must be pairwise distinct and must form a single segment of consecutive integers. Formally, if there exist students with degrees of aggressiveness l,l+1,\xe2\x80\xa6,\xe2\x88\x921,1,\xe2\x80\xa6,r\xe2\x88\x921,r inside the square s, where l\xe2\x89\xa40\xe2\x89\xa4r, the main hero will be able to form a team of r\xe2\x88\x92l+1 people (of course, he is included in this team).Notice, that it is not required to take all students from square s to the team.Misha thinks that the team should consist of at least t people. That is why he is interested, how many squares are there in the table in which the main hero will be able to form a team of at least t people. Help him to calculate this." "brute force,two pointers" 3500
5B "Center Alignment" "Almost every text editor has a built-in function of center text alignment. The developers of the popular in Berland text editor \xc2\xabTextpad\xc2\xbb decided to introduce this functionality into the fourth release of the product.You are to implement the alignment in the shortest possible time. Good luck!" implementation,strings 1200
875E "Delivery Club" "Petya and Vasya got employed as couriers. During the working day they are to deliver packages to n different points on the line. According to the company\'s internal rules, the delivery of packages must be carried out strictly in a certain order. Initially, Petya is at the point with the coordinate s1, Vasya is at the point with the coordinate s2, and the clients are at the points x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xn in the order of the required visit.The guys agree in advance who of them will deliver the package to which of the customers, and then they act as follows. When the package for the i-th client is delivered, the one who delivers the package to the (i\xe2\x80\x89+\xe2\x80\x891)-st client is sent to the path (it can be the same person who went to the point xi, or the other). The friend who is not busy in delivering the current package, is standing still.To communicate with each other, the guys have got walkie-talkies. The walkie-talkies work rather poorly at great distances, so Petya and Vasya want to distribute the orders so that the maximum distance between them during the day is as low as possible. Help Petya and Vasya to minimize the maximum distance between them, observing all delivery rules." "binary search,data structures,dp" 2600
852B "Neural Network country" "Due to the recent popularity of the Deep learning new countries are starting to look like Neural Networks. That is, the countries are being built deep with many layers, each layer possibly having many cities. They also have one entry, and one exit point.There are exactly L layers, each having N cities. Let us look at the two adjacent layers L1 and L2. Each city from the layer L1 is connected to each city from the layer L2 with the traveling cost cij for , and each pair of adjacent layers has the same cost in between their cities as any other pair (they just stacked the same layers, as usual). Also, the traveling costs to each city from the layer L2 are same for all cities in the L1, that is cij is the same for , and fixed j.Doctor G. needs to speed up his computations for this country so he asks you to find the number of paths he can take from entry to exit point such that his traveling cost is divisible by given number M." dp,matrices 2000
198A "About Bacteria" "Qwerty the Ranger took up a government job and arrived on planet Mars. He should stay in the secret lab and conduct some experiments on bacteria that have funny and abnormal properties. The job isn\'t difficult, but the salary is high.At the beginning of the first experiment there is a single bacterium in the test tube. Every second each bacterium in the test tube divides itself into k bacteria. After that some abnormal effects create b more bacteria in the test tube. Thus, if at the beginning of some second the test tube had x bacteria, then at the end of the second it will have kx\xe2\x80\x89+\xe2\x80\x89b bacteria.The experiment showed that after n seconds there were exactly z bacteria and the experiment ended at this point.For the second experiment Qwerty is going to sterilize the test tube and put there t bacteria. He hasn\'t started the experiment yet but he already wonders, how many seconds he will need to grow at least z bacteria. The ranger thinks that the bacteria will divide by the same rule as in the first experiment. Help Qwerty and find the minimum number of seconds needed to get a tube with at least z bacteria in the second experiment." implementation,math 1700
254D Rats "Rats have bred to hundreds and hundreds in the basement of the store, owned by Vasily Petrovich. Vasily Petrovich may have not noticed their presence, but they got into the habit of sneaking into the warehouse and stealing food from there. Vasily Petrovich cannot put up with it anymore, he has to destroy the rats in the basement. Since mousetraps are outdated and do not help, and rat poison can poison inattentive people as well as rats, he chose a radical way: to blow up two grenades in the basement (he does not have more).In this problem, we will present the shop basement as a rectangular table of n\xe2\x80\x89\xc3\x97\xe2\x80\x89m cells. Some of the cells are occupied by walls, and the rest of them are empty. Vasily has been watching the rats and he found out that at a certain time they go to sleep, and all the time they sleep in the same places. He wants to blow up a grenade when this convenient time comes. On the plan of his basement, he marked cells with sleeping rats in them. Naturally, these cells are not occupied by walls.Grenades can only blow up in a cell that is not occupied by a wall. The blast wave from a grenade distributes as follows. We assume that the grenade blast occurs at time 0. During this initial time only the cell where the grenade blew up gets \'clear\'. If at time t some cell is clear, then at time t\xe2\x80\x89+\xe2\x80\x891 those side-neighbouring cells which are not occupied by the walls get clear too (some of them could have been cleared before). The blast wave distributes for exactly d seconds, then it dies immediately.  An example of a distributing blast wave: Picture 1 shows the situation before the blast, and the following pictures show ""clear"" cells by time 0,1,2,3 and 4. Thus, the blast wave on the picture distributes for d\xe2\x80\x89=\xe2\x80\x894 seconds. Vasily Petrovich wonders, whether he can choose two cells to blast the grenades so as to clear all cells with sleeping rats. Write the program that finds it out." "brute force,dfs and similar,graphs,implementation,shortest paths" 2300
1016G "Appropriate Team" "Since next season are coming, you\'d like to form a team from two or three participants. There are n candidates, the i-th candidate has rank ai. But you have weird requirements for your teammates: if you have rank v and have chosen the i-th and j-th candidate, then GCD(v,ai)=X and LCM(v,aj)=Y must be met.You are very experienced, so you can change your rank to any non-negative integer but X and Y are tied with your birthdate, so they are fixed.Now you want to know, how many are there pairs (i,j) such that there exists an integer v meeting the following constraints: GCD(v,ai)=X and LCM(v,aj)=Y. It\'s possible that i=j and you form a team of two.GCD is the greatest common divisor of two number, LCM \xe2\x80\x94 the least common multiple." "bitmasks,math,number theory" 2700
1662F Antennas "There are n equidistant antennas on a line, numbered from 1 to n. Each antenna has a power rating, the power of the i-th antenna is pi. The i-th and the j-th antenna can communicate directly if and only if their distance is at most the minimum of their powers, i.e., |i\xe2\x88\x92j|\xe2\x89\xa4min(pi,pj). Sending a message directly between two such antennas takes 1 second.What is the minimum amount of time necessary to send a message from antenna a to antenna b, possibly using other antennas as relays?" "data structures,dfs and similar,graphs,graphs,implementation,implementation,shortest paths,shortest paths" -999
773A "Success Rate" "You are an experienced Codeforces user. Today you found out that during your activity on Codeforces you have made y submissions, out of which x have been successful. Thus, your current success rate on Codeforces is equal to x\xe2\x80\x89/\xe2\x80\x89y.Your favorite rational number in the [0;1] range is p\xe2\x80\x89/\xe2\x80\x89q. Now you wonder: what is the smallest number of submissions you have to make if you want your success rate to be p\xe2\x80\x89/\xe2\x80\x89q?" "binary search,math" 1700
1862E "Kolya and Movie Theatre" "Recently, Kolya found out that a new movie theatre is going to be opened in his city soon, which will show a new movie every day for n days. So, on the day with the number 1\xe2\x89\xa4i\xe2\x89\xa4n, the movie theatre will show the premiere of the i-th movie. Also, Kolya found out the schedule of the movies and assigned the entertainment value to each movie, denoted by ai.However, the longer Kolya stays without visiting a movie theatre, the larger the decrease in entertainment value of the next movie. That decrease is equivalent to d\xe2\x8b\x85cnt, where d is a predetermined value and cnt is the number of days since the last visit to the movie theatre. It is also known that Kolya managed to visit another movie theatre a day before the new one opened \xe2\x80\x94 the day with the number 0. So if we visit the movie theatre the first time on the day with the number i, then cnt \xe2\x80\x94 the number of days since the last visit to the movie theatre will be equal to i.For example, if d=2 and a=[3,2,5,4,6], then by visiting movies with indices 1 and 3, cnt value for the day 1 will be equal to 1\xe2\x88\x920=1 and cnt value for the day 3 will be 3\xe2\x88\x921=2, so the total entertainment value of the movies will be a1\xe2\x88\x92d\xe2\x8b\x851+a3\xe2\x88\x92d\xe2\x8b\x852=3\xe2\x88\x922\xe2\x8b\x851+5\xe2\x88\x922\xe2\x8b\x852=2.Unfortunately, Kolya only has time to visit at most m movies. Help him create a plan to visit the cinema in such a way that the total entertainment value of all the movies he visits is maximized." "constructive algorithms,data structures,greedy" 1600
1363B "Subsequence Hate" "Shubham has a binary string s. A binary string is a string containing only characters ""0"" and ""1"".He can perform the following operation on the string any amount of times:   Select an index of the string, and flip the character at that index. This means, if the character was ""0"", it becomes ""1"", and vice versa. A string is called good if it does not contain ""010"" or ""101"" as a subsequence  \xe2\x80\x94 for instance, ""1001"" contains ""101"" as a subsequence, hence it is not a good string, while ""1000"" doesn\'t contain neither ""010"" nor ""101"" as subsequences, so it is a good string.What is the minimum number of operations he will have to perform, so that the string becomes good? It can be shown that with these operations we can make any string good.A string a is a subsequence of a string b if a can be obtained from b by deletion of several (possibly, zero or all) characters." implementation,strings 1400
363D "Renting Bikes" "A group of n schoolboys decided to ride bikes. As nobody of them has a bike, the boys need to rent them.The renting site offered them m bikes. The renting price is different for different bikes, renting the j-th bike costs pj rubles.In total, the boys\' shared budget is a rubles. Besides, each of them has his own personal money, the i-th boy has bi personal rubles. The shared budget can be spent on any schoolchildren arbitrarily, but each boy\'s personal money can be spent on renting only this boy\'s bike.Each boy can rent at most one bike, one cannot give his bike to somebody else.What maximum number of schoolboys will be able to ride bikes? What minimum sum of personal money will they have to spend in total to let as many schoolchildren ride bikes as possible?" "binary search,greedy" 1800
1554A Cherry "You are given n integers a1,a2,\xe2\x80\xa6,an. Find the maximum value of max(al,al+1,\xe2\x80\xa6,ar)\xe2\x8b\x85min(al,al+1,\xe2\x80\xa6,ar) over all pairs (l,r) of integers for which 1\xe2\x89\xa4l<r\xe2\x89\xa4n." greedy 800
1656F "Parametric MST" "You are given n integers a1,a2,\xe2\x80\xa6,an. For any real number t, consider the complete weighted graph on n vertices Kn(t) with weight of the edge between vertices i and j equal to wij(t)=ai\xe2\x8b\x85aj+t\xe2\x8b\x85(ai+aj). Let f(t) be the cost of the minimum spanning tree of Kn(t). Determine whether f(t) is bounded above and, if so, output the maximum value it attains." "binary search,constructive algorithms,graphs,greedy,math,sortings" 2600
1566B "MIN-MEX Cut" "A binary string is a string that consists of characters 0 and 1.Let MEX of a binary string be the smallest digit among 0, 1, or 2 that does not occur in the string. For example, MEX of 001011 is 2, because 0 and 1 occur in the string at least once, MEX of 1111 is 0, because 0 and 2 do not occur in the string and 0<2.A binary string s is given. You should cut it into any number of substrings such that each character is in exactly one substring. It is possible to cut the string into a single substring \xe2\x80\x94 the whole string.A string a is a substring of a string b if a can be obtained from b by deletion of several (possibly, zero or all) characters from the beginning and several (possibly, zero or all) characters from the end.What is the minimal sum of MEX of all substrings pieces can be?" "bitmasks,constructive algorithms,dp,greedy" 800
567B "Berland National Library" "Berland National Library has recently been built in the capital of Berland. In addition, in the library you can take any of the collected works of Berland leaders, the library has a reading room.Today was the pilot launch of an automated reading room visitors\' accounting system! The scanner of the system is installed at the entrance to the reading room. It records the events of the form ""reader entered room"", ""reader left room"". Every reader is assigned a registration number during the registration procedure at the library \xe2\x80\x94 it\'s a unique integer from 1 to 106. Thus, the system logs events of two forms:  ""+ ri"" \xe2\x80\x94 the reader with registration number ri entered the room;  ""- ri"" \xe2\x80\x94 the reader with registration number ri left the room. The first launch of the system was a success, it functioned for some period of time, and, at the time of its launch and at the time of its shutdown, the reading room may already have visitors.Significant funds of the budget of Berland have been spent on the design and installation of the system. Therefore, some of the citizens of the capital now demand to explain the need for this system and the benefits that its implementation will bring. Now, the developers of the system need to urgently come up with reasons for its existence.Help the system developers to find the minimum possible capacity of the reading room (in visitors) using the log of the system available to you." implementation 1300
1844C Particles "You have discovered n mysterious particles on a line with integer charges of c1,\xe2\x80\xa6,cn. You have a device that allows you to perform the following operation:   Choose a particle and remove it from the line. The remaining particles will shift to fill in the gap that is created. If there were particles with charges x and y directly to the left and right of the removed particle, they combine into a single particle of charge x+y. For example, if the line of particles had charges of [\xe2\x88\x923,1,4,\xe2\x88\x921,5,\xe2\x88\x929], performing the operation on the 4th particle will transform the line into [\xe2\x88\x923,1,9,\xe2\x88\x929].  If we then use the device on the 1st particle in this new line, the line will turn into [1,9,\xe2\x88\x929]. You will perform operations until there is only one particle left. What is the maximum charge of this remaining particle that you can obtain?" dp,greedy,implementation,math 1300
1531C "\xd0\xa1\xd0\xb8\xd0\xbc\xd0\xbc\xd0\xb5\xd1\x82\xd1\x80\xd0\xb8\xd1\x87\xd0\xbd\xd1\x8b\xd0\xb9 \xd0\xb0\xd0\xbc\xd1\x84\xd0\xb8\xd1\x82\xd0\xb5\xd0\xb0\xd1\x82\xd1\x80" "\xd0\x92\xd1\x81\xd0\xb5 \xd0\xb3\xd0\xbe\xd1\x82\xd0\xbe\xd0\xb2\xd1\x8f\xd1\x82\xd1\x81\xd1\x8f \xd0\xba VK Fest 2021! \xd0\x94\xd0\xbb\xd1\x8f \xd1\x82\xd0\xbe\xd0\xb3\xd0\xbe, \xd1\x87\xd1\x82\xd0\xbe\xd0\xb1\xd1\x8b \xd0\xb7\xd1\x80\xd0\xb8\xd1\x82\xd0\xb5\xd0\xbb\xd1\x8f\xd0\xbc \xd0\xb1\xd1\x8b\xd0\xbb\xd0\xb0 \xd0\xbb\xd1\x83\xd1\x87\xd1\x88\xd0\xb5 \xd0\xb2\xd0\xb8\xd0\xb4\xd0\xbd\xd0\xb0 \xd0\xb3\xd0\xbb\xd0\xb0\xd0\xb2\xd0\xbd\xd0\xb0\xd1\x8f \xd1\x81\xd1\x86\xd0\xb5\xd0\xbd\xd0\xb0, \xd0\xbf\xd0\xbb\xd0\xb0\xd0\xbd\xd0\xb8\xd1\x80\xd1\x83\xd0\xb5\xd1\x82\xd1\x81\xd1\x8f \xd0\xbf\xd0\xbe\xd1\x81\xd1\x82\xd1\x80\xd0\xbe\xd0\xb8\xd1\x82\xd1\x8c \xd0\xb0\xd0\xbc\xd1\x84\xd0\xb8\xd1\x82\xd0\xb5\xd0\xb0\xd1\x82\xd1\x80. \xd0\x92 \xd1\x8d\xd1\x82\xd0\xbe\xd0\xb9 \xd0\xb7\xd0\xb0\xd0\xb4\xd0\xb0\xd1\x87\xd0\xb5 \xd0\xbc\xd1\x8b \xd0\xb1\xd1\x83\xd0\xb4\xd0\xb5\xd0\xbc \xd1\x80\xd0\xb0\xd1\x81\xd1\x81\xd0\xbc\xd0\xb0\xd1\x82\xd1\x80\xd0\xb8\xd0\xb2\xd0\xb0\xd1\x82\xd1\x8c \xd0\xb5\xd0\xb3\xd0\xbe \xd1\x81\xd0\xb1\xd0\xbe\xd0\xba\xd1\x83 \xe2\x80\x94 \xd1\x81\xd1\x85\xd0\xb5\xd0\xbc\xd0\xb0\xd1\x82\xd0\xb8\xd1\x87\xd0\xbd\xd0\xbe \xd0\xbe\xd0\xbd \xd0\xb1\xd1\x83\xd0\xb4\xd0\xb5\xd1\x82 \xd0\xb8\xd0\xbc\xd0\xb5\xd1\x82\xd1\x8c \xd1\x84\xd0\xbe\xd1\x80\xd0\xbc\xd1\x83 \xd0\xbb\xd0\xb5\xd1\x81\xd1\x82\xd0\xbd\xd0\xb8\xd1\x86\xd1\x8b \xd0\xb8\xd0\xb7 nn \xd0\xbe\xd0\xb4\xd0\xb8\xd0\xbd\xd0\xb0\xd0\xba\xd0\xbe\xd0\xb2\xd1\x8b\xd1\x85 \xd0\xba\xd0\xb2\xd0\xb0\xd0\xb4\xd1\x80\xd0\xb0\xd1\x82\xd0\xbe\xd0\xb2. \xd0\x9b\xd0\xb5\xd1\x81\xd1\x82\xd0\xbd\xd0\xb8\xd1\x86\xd0\xb0 \xe2\x80\x94 \xd1\x8d\xd1\x82\xd0\xbe \xd0\xbe\xd0\xb4\xd0\xbd\xd0\xb0 \xd0\xb8\xd0\xbb\xd0\xb8 \xd0\xb1\xd0\xbe\xd0\xbb\xd0\xb5\xd0\xb5 \xd0\xb1\xd0\xb0\xd1\x88\xd0\xb5\xd0\xbd \xd0\xba\xd0\xb2\xd0\xb0\xd0\xb4\xd1\x80\xd0\xb0\xd1\x82\xd0\xbe\xd0\xb2, \xd0\xb2\xd1\x8b\xd1\x81\xd1\x82\xd1\x80\xd0\xbe\xd0\xb5\xd0\xbd\xd0\xbd\xd1\x8b\xd1\x85 \xd0\xb2 \xd1\x80\xd1\x8f\xd0\xb4, \xd0\xb3\xd0\xb4\xd0\xb5 \xd0\xb2\xd1\x8b\xd1\x81\xd0\xbe\xd1\x82\xd1\x8b \xd0\xb1\xd0\xb0\xd1\x88\xd0\xb5\xd0\xbd \xd0\xbd\xd0\xb5\xd0\xb2\xd0\xbe\xd0\xb7\xd1\x80\xd0\xb0\xd1\x81\xd1\x82\xd0\xb0\xd1\x8e\xd1\x82 \xd1\x81\xd0\xbb\xd0\xb5\xd0\xb2\xd0\xb0 \xd0\xbd\xd0\xb0\xd0\xbf\xd1\x80\xd0\xb0\xd0\xb2\xd0\xbe.\xd0\x9d\xd0\xb0 \xd1\x81\xd0\xbb\xd0\xb5\xd0\xb4\xd1\x83\xd1\x8e\xd1\x89\xd0\xb5\xd0\xbc \xd1\x80\xd0\xb8\xd1\x81\xd1\x83\xd0\xbd\xd0\xba\xd0\xb5 \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xbd\xd0\xbe \xd0\xb2\xd0\xb8\xd0\xb4\xd0\xb5\xd1\x82\xd1\x8c \xd1\x82\xd1\x80\xd0\xb8 \xd1\x80\xd0\xb0\xd0\xb7\xd0\xbd\xd1\x8b\xd0\xb5 \xd1\x84\xd0\xb8\xd0\xb3\xd1\x83\xd1\x80\xd1\x8b \xd0\xb8\xd0\xb7 1212 \xd0\xba\xd0\xb2\xd0\xb0\xd0\xb4\xd1\x80\xd0\xb0\xd1\x82\xd0\xbe\xd0\xb2. \xd0\x9f\xd0\xb5\xd1\x80\xd0\xb2\xd1\x8b\xd0\xb5 \xd0\xb4\xd0\xb2\xd0\xb5 \xd1\x84\xd0\xb8\xd0\xb3\xd1\x83\xd1\x80\xd1\x8b \xe2\x80\x94 \xd0\xbb\xd0\xb5\xd1\x81\xd1\x82\xd0\xbd\xd0\xb8\xd1\x86\xd1\x8b, \xd0\xb0 \xd1\x82\xd1\x80\xd0\xb5\xd1\x82\xd1\x8c\xd1\x8f \xe2\x80\x94 \xd0\xbd\xd0\xb5\xd1\x82.  \xd0\x98\xd0\xb7 \xd1\x8d\xd1\x81\xd1\x82\xd0\xb5\xd1\x82\xd0\xb8\xd1\x87\xd0\xb5\xd1\x81\xd0\xba\xd0\xb8\xd1\x85 \xd1\x81\xd0\xbe\xd0\xbe\xd0\xb1\xd1\x80\xd0\xb0\xd0\xb6\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb9 \xd0\xb1\xd1\x8b\xd0\xbb\xd0\xbe \xd1\x80\xd0\xb5\xd1\x88\xd0\xb5\xd0\xbd\xd0\xbe, \xd1\x87\xd1\x82\xd0\xbe \xd0\xb0\xd0\xbc\xd1\x84\xd0\xb8\xd1\x82\xd0\xb5\xd0\xb0\xd1\x82\xd1\x80 \xd0\xb4\xd0\xbe\xd0\xbb\xd0\xb6\xd0\xb5\xd0\xbd \xd0\xb1\xd1\x8b\xd1\x82\xd1\x8c \xd1\x81\xd0\xb8\xd0\xbc\xd0\xbc\xd0\xb5\xd1\x82\xd1\x80\xd0\xb8\xd1\x87\xd0\xbd\xd1\x8b\xd0\xbc. \xd0\xa4\xd0\xbe\xd1\x80\xd0\xbc\xd0\xb0\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe, \xd0\xb0\xd0\xbc\xd1\x84\xd0\xb8\xd1\x82\xd0\xb5\xd0\xb0\xd1\x82\xd1\x80 \xd0\xbd\xd0\xb0\xd0\xb7\xd1\x8b\xd0\xb2\xd0\xb0\xd0\xb5\xd1\x82\xd1\x81\xd1\x8f \xd1\x81\xd0\xb8\xd0\xbc\xd0\xbc\xd0\xb5\xd1\x82\xd1\x80\xd0\xb8\xd1\x87\xd0\xbd\xd1\x8b\xd0\xbc, \xd0\xb5\xd1\x81\xd0\xbb\xd0\xb8 \xd0\xbf\xd1\x80\xd0\xb8 \xd0\xbe\xd1\x82\xd1\x80\xd0\xb0\xd0\xb6\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb8 \xd0\xb5\xd0\xb3\xd0\xbe \xd1\x81\xd1\x85\xd0\xb5\xd0\xbc\xd1\x8b \xd0\xbe\xd1\x82\xd0\xbd\xd0\xbe\xd1\x81\xd0\xb8\xd1\x82\xd0\xb5\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe \xd0\xbf\xd1\x80\xd1\x8f\xd0\xbc\xd0\xbe\xd0\xb9 x=yx=y \xd0\xbf\xd0\xbe\xd0\xbb\xd1\x83\xd1\x87\xd0\xb0\xd0\xb5\xd1\x82\xd1\x81\xd1\x8f \xd1\x82\xd0\xbe\xd1\x82 \xd0\xb6\xd0\xb5 \xd1\x81\xd0\xb0\xd0\xbc\xd1\x8b\xd0\xb9 \xd1\x80\xd0\xb8\xd1\x81\xd1\x83\xd0\xbd\xd0\xbe\xd0\xba (\xd0\xb3\xd0\xb4\xd0\xb5 \xd0\xbe\xd1\x81\xd1\x8c xx \xd0\xbd\xd0\xb0\xd0\xbf\xd1\x80\xd0\xb0\xd0\xb2\xd0\xbb\xd0\xb5\xd0\xbd\xd0\xb0 \xd1\x81\xd0\xbb\xd0\xb5\xd0\xb2\xd0\xb0 \xd0\xbd\xd0\xb0\xd0\xbf\xd1\x80\xd0\xb0\xd0\xb2\xd0\xbe, \xd0\xb0 \xd0\xbe\xd1\x81\xd1\x8c yy \xe2\x80\x94 \xd1\x81\xd0\xbd\xd0\xb8\xd0\xb7\xd1\x83 \xd0\xb2\xd0\xb2\xd0\xb5\xd1\x80\xd1\x85). \xd0\x9d\xd0\xb0\xd0\xbf\xd1\x80\xd0\xb8\xd0\xbc\xd0\xb5\xd1\x80, \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb2\xd0\xb0\xd1\x8f \xd0\xbb\xd0\xb5\xd1\x81\xd1\x82\xd0\xbd\xd0\xb8\xd1\x86\xd0\xb0 \xd0\xbd\xd0\xb0 \xd1\x80\xd0\xb8\xd1\x81\xd1\x83\xd0\xbd\xd0\xba\xd0\xb5 \xd0\xb2\xd1\x8b\xd1\x88\xd0\xb5 \xe2\x80\x94 \xd1\x81\xd0\xb8\xd0\xbc\xd0\xbc\xd0\xb5\xd1\x82\xd1\x80\xd0\xb8\xd1\x87\xd0\xbd\xd0\xb0\xd1\x8f, \xd0\xb0 \xd0\xb2\xd1\x82\xd0\xbe\xd1\x80\xd0\xb0\xd1\x8f \xe2\x80\x94 \xd0\xbd\xd0\xb5\xd1\x82.  \xd0\x9a\xd1\x80\xd0\xbe\xd0\xbc\xd0\xb5 \xd1\x82\xd0\xbe\xd0\xb3\xd0\xbe, \xd0\xb0\xd0\xbc\xd1\x84\xd0\xb8\xd1\x82\xd0\xb5\xd0\xb0\xd1\x82\xd1\x80 \xd0\xb4\xd0\xbe\xd0\xbb\xd0\xb6\xd0\xb5\xd0\xbd \xd0\xb1\xd1\x8b\xd1\x82\xd1\x8c \xd0\xbc\xd0\xb0\xd0\xba\xd1\x81\xd0\xb8\xd0\xbc\xd0\xb0\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe \xd0\xba\xd0\xbe\xd0\xbc\xd0\xbf\xd0\xb0\xd0\xba\xd1\x82\xd0\xbd\xd1\x8b\xd0\xbc \xe2\x80\x94 \xd0\xb0 \xd0\xb8\xd0\xbc\xd0\xb5\xd0\xbd\xd0\xbd\xd0\xbe, \xd1\x81\xd1\x82\xd0\xbe\xd1\x80\xd0\xbe\xd0\xbd\xd0\xb0 \xd0\xbc\xd0\xb8\xd0\xbd\xd0\xb8\xd0\xbc\xd0\xb0\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe\xd0\xb3\xd0\xbe \xd0\xba\xd0\xb2\xd0\xb0\xd0\xb4\xd1\x80\xd0\xb0\xd1\x82\xd0\xb0, \xd0\xb2\xd0\xbd\xd1\x83\xd1\x82\xd1\x80\xd1\x8c \xd0\xba\xd0\xbe\xd1\x82\xd0\xbe\xd1\x80\xd0\xbe\xd0\xb3\xd0\xbe \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xbd\xd0\xbe \xd0\xb5\xd0\xb3\xd0\xbe \xd0\xbf\xd0\xbe\xd0\xbc\xd0\xb5\xd1\x81\xd1\x82\xd0\xb8\xd1\x82\xd1\x8c, \xd0\xb4\xd0\xbe\xd0\xbb\xd0\xb6\xd0\xbd\xd0\xb0 \xd0\xb1\xd1\x8b\xd1\x82\xd1\x8c \xd0\xba\xd0\xb0\xd0\xba \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xbd\xd0\xbe \xd0\xbc\xd0\xb5\xd0\xbd\xd1\x8c\xd1\x88\xd0\xb5.\xd0\x9f\xd0\xbe \xd0\xb7\xd0\xb0\xd0\xb4\xd0\xb0\xd0\xbd\xd0\xbd\xd0\xbe\xd0\xbc\xd1\x83 \xd1\x87\xd0\xb8\xd1\x81\xd0\xbb\xd1\x83 nn \xd0\xbd\xd0\xb0\xd1\x80\xd0\xb8\xd1\x81\xd1\x83\xd0\xb9\xd1\x82\xd0\xb5 \xd1\x81\xd1\x85\xd0\xb5\xd0\xbc\xd1\x83 \xd0\xb0\xd0\xbc\xd1\x84\xd0\xb8\xd1\x82\xd0\xb5\xd0\xb0\xd1\x82\xd1\x80\xd0\xb0 \xd0\xb8\xd0\xb7 \xd1\x80\xd0\xbe\xd0\xb2\xd0\xbd\xd0\xbe nn \xd0\xba\xd0\xb2\xd0\xb0\xd0\xb4\xd1\x80\xd0\xb0\xd1\x82\xd0\xbe\xd0\xb2, \xd1\x83\xd0\xb4\xd0\xbe\xd0\xb2\xd0\xbb\xd0\xb5\xd1\x82\xd0\xb2\xd0\xbe\xd1\x80\xd1\x8f\xd1\x8e\xd1\x89\xd1\x83\xd1\x8e \xd0\xb2\xd1\x81\xd0\xb5\xd0\xbc \xd1\x83\xd1\x81\xd0\xbb\xd0\xbe\xd0\xb2\xd0\xb8\xd1\x8f\xd0\xbc." "*special problem,constructive algorithms,dp" -999
553E "Kyoya and Train" "Kyoya Ootori wants to take the train to get to school. There are n train stations and m one-way train lines going between various stations. Kyoya is currently at train station 1, and the school is at station n. To take a train, he must pay for a ticket, and the train also takes a certain amount of time. However, the trains are not perfect and take random amounts of time to arrive at their destination. If Kyoya arrives at school strictly after t time units, he will have to pay a fine of x.Each train line is described by a ticket price, and a probability distribution on the time the train takes. More formally, train line i has ticket cost ci, and a probability distribution pi,\xe2\x80\x89k which denotes the probability that this train will take k time units for all 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89t. Amounts of time that each of the trains used by Kyouya takes are mutually independent random values (moreover, if Kyoya travels along the same train more than once, it is possible for the train to take different amounts of time and those amounts are also independent one from another). Kyoya wants to get to school by spending the least amount of money in expectation (for the ticket price plus possible fine for being late). Of course, Kyoya has an optimal plan for how to get to school, and every time he arrives at a train station, he may recalculate his plan based on how much time he has remaining. What is the expected cost that Kyoya will pay to get to school if he moves optimally?" dp,fft,graphs,math,probabilities 3200
1667C "Half Queen Cover" "You are given a board with n rows and n columns, numbered from 1 to n. The intersection of the a-th row and b-th column is denoted by (a,b).A half-queen attacks cells in the same row, same column, and on one diagonal. More formally, a half-queen on (a,b) attacks the cell (c,d) if a=c or b=d or a\xe2\x88\x92b=c\xe2\x88\x92d.  The blue cells are under attack.  What is the minimum number of half-queens that can be placed on that board so as to ensure that each square is attacked by at least one half-queen?Construct an optimal solution." "constructive algorithms,math" 2400
1896H1 "Cyclic Hamming (Easy Version)" "This is the easy version of the problem. The only difference between the two versions is the constraint on k. You can make hacks only if all versions of the problem are solved.In this statement, all strings are 0-indexed.For two strings a, b of the same length p, we define the following definitions:  The hamming distance between a and b, denoted as h(a,b), is defined as the number of positions i such that 0\xe2\x89\xa4i<p and ai\xe2\x89\xa0bi.  b is a cyclic shift of a if there exists some 0\xe2\x89\xa4k<p such that b(i+k)modp=ai for all 0\xe2\x89\xa4i<p. Here xmody denotes the remainder from dividing x by y. You are given two binary strings s and t of length 2k+1 each. Both strings may contain missing characters (denoted by the character \'?\'). Your task is to count the number of ways to replace the missing characters in both strings with the characters \'0\' or \'1\' such that:   Each string s and t contains exactly 2k occurrences of each character \'0\' and \'1\'  h(s,c)\xe2\x89\xa52k for all strings c that is a cyclic shift of t. As the result can be very large, you should print the value modulo 998244353." "brute force,divide and conquer,dp,fft,math,number theory" 3400
1949D "Funny or Scary?" "You are designing a new video game. It has n scenarios, which the player may play in any order, but each scenario must be played exactly once. When a player switches from a scenario to another scenario, the game shows a specially crafted transition video to make it all feel part of one big story. This video is specific to a pair of scenarios, but not to their order, in other words, the video playing when switching from scenario a to scenario b is the same as the video playing when switching from scenario b to scenario a. Therefore, you need to create n(n\xe2\x88\x921)2 different transition videos, one for each possible pair of different scenarios.Each transition video can be either funny or scary. It is boring to see too many funny videos or too many scary videos in a row. Therefore, your goal is to create the videos in such a way that no matter in which order does the player approach the scenarios, they will never see more than \xe2\x8c\x883n4\xe2\x8c\x89 transition videos of the same type in a row.You have already come up with ideas for at most \xe2\x8c\x8an2\xe2\x8c\x8b of the transition videos, and therefore already know if those will be funny or scary. Now you need to choose funny or scary for all other transition videos in such a way that the above requirement is satisfied." "constructive algorithms" 2600
940A "Points on the line" "We\'ve got no test cases. A big olympiad is coming up. But the problemsetters\' number one priority should be adding another problem to the round. The diameter of a multiset of points on the line is the largest distance between two points from this set. For example, the diameter of the multiset {1,\xe2\x80\x893,\xe2\x80\x892,\xe2\x80\x891} is 2.Diameter of multiset consisting of one point is 0.You are given n points on the line. What is the minimum number of points you have to remove, so that the diameter of the multiset of the remaining points will not exceed d?" "brute force,greedy,sortings" 1200
420C "Bug in Code" "Recently a serious bug has been found in the FOS code. The head of the F company wants to find the culprit and punish him. For that, he set up an organizational meeting, the issue is: who\'s bugged the code? Each of the n coders on the meeting said: \'I know for sure that either x or y did it!\'The head of the company decided to choose two suspects and invite them to his office. Naturally, he should consider the coders\' opinions. That\'s why the head wants to make such a choice that at least p of n coders agreed with it. A coder agrees with the choice of two suspects if at least one of the two people that he named at the meeting was chosen as a suspect. In how many ways can the head of F choose two suspects?Note that even if some coder was chosen as a suspect, he can agree with the head\'s choice if he named the other chosen coder at the meeting." "data structures,graphs,implementation,two pointers" 1900
31C Schedule "At the beginning of the new semester there is new schedule in the Berland State University. According to this schedule, n groups have lessons at the room 31. For each group the starting time of the lesson and the finishing time of the lesson are known. It has turned out that it is impossible to hold all lessons, because for some groups periods of their lessons intersect. If at some moment of time one groups finishes it\'s lesson, and the other group starts the lesson, their lessons don\'t intersect.The dean wants to cancel the lesson in one group so that no two time periods of lessons of the remaining groups intersect. You are to find all ways to do that." implementation 1700
1257A "Two Rival Students" "You are the gym teacher in the school.There are n students in the row. And there are two rivalling students among them. The first one is in position a, the second in position b. Positions are numbered from 1 to n from left to right.Since they are rivals, you want to maximize the distance between them. If students are in positions p and s respectively, then distance between them is |p\xe2\x88\x92s|. You can do the following operation at most x times: choose two adjacent (neighbouring) students and swap them.Calculate the maximum distance between two rivalling students after at most x swaps." greedy,math 800
1436F "Sum Over Subsets" "You are given a multiset S. Over all pairs of subsets A and B, such that:  B\xe2\x8a\x82A;  |B|=|A|\xe2\x88\x921;  greatest common divisor of all elements in A is equal to one; find the sum of \xe2\x88\x91x\xe2\x88\x88Ax\xe2\x8b\x85\xe2\x88\x91x\xe2\x88\x88Bx, modulo 998244353." "combinatorics,math,number theory" 2800
1089G "Guest Student" "Berland State University invites people from all over the world as guest students. You can come to the capital of Berland and study with the best teachers in the country.Berland State University works every day of the week, but classes for guest students are held on the following schedule. You know the sequence of seven integers a1,a2,\xe2\x80\xa6,a7 (ai=0 or ai=1):  a1=1 if and only if there are classes for guest students on Sundays;  a2=1 if and only if there are classes for guest students on Mondays;  ...   a7=1 if and only if there are classes for guest students on Saturdays. The classes for guest students are held in at least one day of a week.You want to visit the capital of Berland and spend the minimum number of days in it to study k days as a guest student in Berland State University. Write a program to find the length of the shortest continuous period of days to stay in the capital to study exactly k days as a guest student." math 1500
173E "Camping Groups" "A club wants to take its members camping. In order to organize the event better the club directors decided to partition the members into several groups. Club member i has a responsibility value ri and an age value ai. A group is a non-empty subset of club members with one member known as group leader. A group leader should be one of the most responsible members of the group (his responsibility value is not less than responsibility of any other group member) and his age absolute difference with any other group member should not exceed k. Some club members are friends and want to be in the same group. They also like their group to be as large as possible. Now you should write a program that answers a series of questions like ""What\'s the largest size of a group containing club member x and club member y?"". It\'s possible for x or y to be the group leader." "data structures,sortings" 2600
1392D "Omkar and Bed Wars" "Omkar is playing his favorite pixelated video game, Bed Wars! In Bed Wars, there are n players arranged in a circle, so that for all j such that 2\xe2\x89\xa4j\xe2\x89\xa4n, player j\xe2\x88\x921 is to the left of the player j, and player j is to the right of player j\xe2\x88\x921. Additionally, player n is to the left of player 1, and player 1 is to the right of player n.Currently, each player is attacking either the player to their left or the player to their right. This means that each player is currently being attacked by either 0, 1, or 2 other players. A key element of Bed Wars strategy is that if a player is being attacked by exactly 1 other player, then they should logically attack that player in response. If instead a player is being attacked by 0 or 2 other players, then Bed Wars strategy says that the player can logically attack either of the adjacent players.Unfortunately, it might be that some players in this game are not following Bed Wars strategy correctly. Omkar is aware of whom each player is currently attacking, and he can talk to any amount of the n players in the game to make them instead attack another player  \xe2\x80\x94 i. e. if they are currently attacking the player to their left, Omkar can convince them to instead attack the player to their right; if they are currently attacking the player to their right, Omkar can convince them to instead attack the player to their left. Omkar would like all players to be acting logically. Calculate the minimum amount of players that Omkar needs to talk to so that after all players he talked to (if any) have changed which player they are attacking, all players are acting logically according to Bed Wars strategy." dp,greedy 1700
1188D "Make Equal" "You are given n numbers a1,a2,\xe2\x80\xa6,an. In one operation we can add to any one of those numbers a nonnegative integer power of 2.What is the smallest number of operations we need to perform to make all n numbers equal? It can be proved that under given constraints it doesn\'t exceed 1018." dp 3100
396A "On Number of Decompositions into Multipliers" "You are given an integer m as a product of integers a1,\xe2\x80\x89a2,\xe2\x80\x89... an . Your task is to find the number of distinct decompositions of number m into the product of n ordered positive integers.Decomposition into n products, given in the input, must also be considered in the answer. As the answer can be very large, print it modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." "combinatorics,math,number theory" -999
1710E "Two Arrays" "You are given two arrays of integers a1,a2,\xe2\x80\xa6,an and b1,b2,\xe2\x80\xa6,bm. Alice and Bob are going to play a game. Alice moves first and they take turns making a move.They play on a grid of size n\xc3\x97m (a grid with n rows and m columns). Initially, there is a rook positioned on the first row and first column of the grid.During her/his move, a player can do one of the following two operations:  Move the rook to a different cell on the same row or the same column of the current cell. A player cannot move the rook to a cell that has been visited 1000 times before (i.e., the rook can stay in a certain cell at most 1000 times during the entire game). Note that the starting cell is considered to be visited once at the beginning of the game. End the game immediately with a score of ar+bc, where (r,c) is the current cell (i.e., the rook is on the r-th row and c-th column). Bob wants to maximize the score while Alice wants to minimize it. If they both play this game optimally, what is the final score of the game?" "binary search,games,graph matchings" 2400
780C "Andryusha and Colored Balloons" "Andryusha goes through a park each day. The squares and paths between them look boring to Andryusha, so he decided to decorate them.The park consists of n squares connected with (n\xe2\x80\x89-\xe2\x80\x891) bidirectional paths in such a way that any square is reachable from any other using these paths. Andryusha decided to hang a colored balloon at each of the squares. The baloons\' colors are described by positive integers, starting from 1. In order to make the park varicolored, Andryusha wants to choose the colors in a special way. More precisely, he wants to use such colors that if a, b and c are distinct squares that a and b have a direct path between them, and b and c have a direct path between them, then balloon colors on these three squares are distinct.Andryusha wants to use as little different colors as possible. Help him to choose the colors!" "dfs and similar,graphs,greedy,trees" 1600
567D "One-Dimensional Battle Ships" "Alice and Bob love playing one-dimensional battle ships. They play on the field in the form of a line consisting of n square cells (that is, on a 1\xe2\x80\x89\xc3\x97\xe2\x80\x89n table).At the beginning of the game Alice puts k ships on the field without telling their positions to Bob. Each ship looks as a 1\xe2\x80\x89\xc3\x97\xe2\x80\x89a rectangle (that is, it occupies a sequence of a consecutive squares of the field). The ships cannot intersect and even touch each other.After that Bob makes a sequence of ""shots"". He names cells of the field and Alice either says that the cell is empty (""miss""), or that the cell belongs to some ship (""hit"").But here\'s the problem! Alice like to cheat. May be that is why she responds to each Bob\'s move with a ""miss"". Help Bob catch Alice cheating \xe2\x80\x94 find Bob\'s first move, such that after it you can be sure that Alice cheated." "binary search,data structures,greedy,sortings" 1700
1245B "Restricted RPS" "Let n be a positive integer. Let a,b,c be nonnegative integers such that a+b+c=n.Alice and Bob are gonna play rock-paper-scissors n times. Alice knows the sequences of hands that Bob will play. However, Alice has to play rock a times, paper b times, and scissors c times.Alice wins if she beats Bob in at least \xe2\x8c\x88n2\xe2\x8c\x89 (n2 rounded up to the nearest integer) hands, otherwise Alice loses.Note that in rock-paper-scissors:  rock beats scissors;  paper beats rock;  scissors beat paper. The task is, given the sequence of hands that Bob will play, and the numbers a,b,c, determine whether or not Alice can win. And if so, find any possible sequence of hands that Alice can use to win.If there are multiple answers, print any of them." "constructive algorithms,dp,greedy" 1200
514C "Watto and Mechanism" "Watto, the owner of a spare parts store, has recently got an order for the mechanism that can process strings in a certain way. Initially the memory of the mechanism is filled with n strings. Then the mechanism should be able to process queries of the following type: ""Given string s, determine if the memory of the mechanism contains string t that consists of the same number of characters as s and differs from s in exactly one position"".Watto has already compiled the mechanism, all that\'s left is to write a program for it and check it on the data consisting of n initial lines and m queries. He decided to entrust this job to you." "binary search,data structures,hashing,string suffix structures,strings" 2000
1987C "Basil\'s Garden" "There are n flowers in a row, the i-th of them initially has a positive height of hi meters.Every second, the wind will blow from the left, causing the height of some flowers to decrease.Specifically, every second, for each i from 1 to n, in this order, the following happens:   If i=n or hi>hi+1, the value of hi changes to max(0,hi\xe2\x88\x921). How many seconds will pass before hi=0 for all 1\xe2\x89\xa4i\xe2\x89\xa4n for the first time?" dp,greedy 1200
128A Statues "In this task Anna and Maria play a game with a very unpleasant rival. Anna and Maria are in the opposite squares of a chessboard (8\xe2\x80\x89\xc3\x97\xe2\x80\x898): Anna is in the upper right corner, and Maria is in the lower left one. Apart from them, the board has several statues. Each statue occupies exactly one square. A square that contains a statue cannot have anything or anyone \xe2\x80\x94 neither any other statues, nor Anna, nor Maria.Anna is present on the board as a figurant (she stands still and never moves), and Maria has been actively involved in the game. Her goal is \xe2\x80\x94 to come to Anna\'s square. Maria and statues move in turn, Maria moves first. During one move Maria can go to any adjacent on the side or diagonal cell in which there is no statue, or she can stay in the cell where she is. The statues during their move must go one square down simultaneously, and those statues that were in the bottom row fall from the board and are no longer appeared.At that moment, when one of the statues is in the cell in which the Maria is, the statues are declared winners. At the moment when Maria comes into the cell where Anna has been waiting, Maria is declared the winner.Obviously, nothing depends on the statues, so it all depends on Maria. Determine who will win, if Maria does not make a strategic error." "dfs and similar" 1500
2002D2 "DFS Checker (Hard Version)" "This is the hard version of the problem. In this version, you are given a generic tree and the constraints on n and q are higher. You can make hacks only if both versions of the problem are solved.You are given a rooted tree consisting of n vertices. The vertices are numbered from 1 to n, and the root is the vertex 1. You are also given a permutation p1,p2,\xe2\x80\xa6,pn of [1,2,\xe2\x80\xa6,n].You need to answer q queries. For each query, you are given two integers x, y; you need to swap px and py and determine if p1,p2,\xe2\x80\xa6,pn is a valid DFS order\xe2\x80\xa0 of the given tree.Please note that the swaps are persistent through queries.\xe2\x80\xa0 A DFS order is found by calling the following dfs function on the given tree.dfs_order = []function dfs(v):    append v to the back of dfs_order    pick an arbitrary permutation s of children of v    for child in s:        dfs(child)dfs(1)Note that the DFS order is not unique." "binary search,data structures,dfs and similar,graphs,hashing,trees" 2300
1578K "Kingdom of Islands" "The Kingdom of Islands consists of p islands. As the king, you rule over the whole kingdom, while each island is ruled over by one or several jarls under your rule. In total, there are n jarls under your jurisdiction.Each island of the kingdom has its own strong traditions, so jarls that rule over the same island support each other and never have conflicts. The downsides of such strength are cultural conflicts between people inhabiting different islands. Thus, two jarls that rule over different islands are in conflict.However, recent years brought a few changes to traditional relations between the jarls. To your knowledge, there are exactly k pairs of jarls such that relationships between two jarls in the pair are different from the traditional. That is, if two jarls of the pair you know rule over the same island, these jarls are in conflict. If they rule over different islands, then they overcome cultural disagreement and there is no conflict between them anymore.As a true responsible king, you are worried about whether the kingdom is close to a major conflict. In order to estimate the current situation, you would like to find the largest possible group of jarls such that every two jarls in the group are in conflict." "brute force,graphs,implementation" 2800
1534A "Colour the Flag" "Today we will be playing a red and white colouring game (no, this is not the Russian Civil War; these are just the colours of the Canadian flag).You are given an n\xc3\x97m grid of ""R"", ""W"", and ""."" characters. ""R"" is red, ""W"" is white and ""."" is blank. The neighbours of a cell are those that share an edge with it (those that only share a corner do not count).Your job is to colour the blank cells red or white so that every red cell only has white neighbours (and no red ones) and every white cell only has red neighbours (and no white ones). You are not allowed to recolour already coloured cells." "brute force,implementation" 800
1906C "Cursed Game" "You found an antique box in your warehouse and decided to open it. The moment you open the box, it traps you into a cursed game where you are playing against a demon. The game consists of 333 rounds and you have to win all rounds in order to escape. The demon also gives you 999 coins that you can use throughout all rounds.Note that in this problem, denote cell (r,c) of a grid as the cell in row r and column c of the grid.Before the start of each round, the demon will prepare a secret paper, which can be represented as a grid with 3 rows and 3 columns, both numbered from 1 to 3. The demon will secretly put a hole in one or more cells, and you are not aware which cells have a hole in it. Then, the round starts with the demon giving you an odd integer N (3\xe2\x89\xa4N\xe2\x89\xa433).Within each round, you can ask the demon several queries, each costing you one coin. For each query, you are allowed to give the demon your paper, which can be represented as a grid with N rows and N columns, both numbered from 1 to N. Each cell is coloured either black or white by you.For each of your query, the demon will calculate a binary result grid with N\xe2\x88\x922 rows and N\xe2\x88\x922 columns, both numbered from 1 to N\xe2\x88\x922. The value on cell (r,c) of the result grid is filled as follows.  The demon will put the secret paper on top of your paper such that the cell (r+i\xe2\x88\x921,c+j\xe2\x88\x921) of your paper aligns with the cell (i,j) of the secret paper, for 1\xe2\x89\xa4i,j\xe2\x89\xa43.  The demon can only see the colour of the cell in your paper if the corresponding cell in the secret paper has a hole in it.  The value on cell (r,c) of the result grid is 1 if there is an odd number of black cells that it can see through the holes, or 0 otherwise. You win the round if the result grid consists of only the values 1. Otherwise, the demon will give you the result grid as a feedback, and the round continues.If you have spent all the coins and still did not win all the rounds, then you will be trapped forever. Escape the cursed game!" interactive 3000
1639K "Treasure Hunt" "All problems in this contest share the same statement, the only difference is the test your solution runs on. For further information on scoring please refer to ""Scoring"" section of the statement.This is an interactive problem.Imagine you are a treasure hunter, a very skillful one. One day you came across an ancient map which could help you to become rich. The map shows multiple forestry roads, and at each junction there is a treasure. So, you start your journey hoping to retrieve all the hidden treasures, but you don\'t know yet that there is a wicked wizard standing against you and craving to tangle up these roads and impede your achievements.The treasure map is represented as an undirected graph in which vertices correspond to junctions and edges correspond to roads. Your path begins at a certain fixed vertex with a label known to you. Every time you come to a vertex that you have not been to before, you dig up a treasure chest and put a flag in this vertex. At the initial vertex you\'ll find a treasure chest immediately and, consequently, you\'ll put a flag there immediately as well.When you are standing at the junction you can see for each of the adjacent vertices its degree and if there is a flag there. There are no other things you can see from there. Besides, the power of the wicked wizard is so great that he is able to change the location of the roads and junctions on the map without changing the graph structure. Therefore, the sequence of the roads coming from the junction v might be different each time you come in the junction v. However, keep in mind that the set of adjacent crossroads does not change, and you are well aware of previously dug treasures at each adjacent to v vertex.Your goal is to collect treasures from all vertices of the graph as fast as you can. Good luck in hunting!" graphs,interactive -999
1307C "Cow and Message" "Bessie the cow has just intercepted a text that Farmer John sent to Burger Queen! However, Bessie is sure that there is a secret message hidden inside.The text is a string s of lowercase Latin letters. She considers a string t as hidden in string s if t exists as a subsequence of s whose indices form an arithmetic progression. For example, the string aab is hidden in string aaabb because it occurs at indices 1, 3, and 5, which form an arithmetic progression with a common difference of 2. Bessie thinks that any hidden string that occurs the most times is the secret message. Two occurrences of a subsequence of S are distinct if the sets of indices are different. Help her find the number of occurrences of the secret message!For example, in the string aaabb, a is hidden 3 times, b is hidden 2 times, ab is hidden 6 times, aa is hidden 3 times, bb is hidden 1 time, aab is hidden 2 times, aaa is hidden 1 time, abb is hidden 1 time, aaab is hidden 1 time, aabb is hidden 1 time, and aaabb is hidden 1 time. The number of occurrences of the secret message is 6." "brute force,dp,math,strings" 1500
366D "Dima and Trap Graph" "Dima and Inna love spending time together. The problem is, Seryozha isn\'t too enthusiastic to leave his room for some reason. But Dima and Inna love each other so much that they decided to get criminal...Dima constructed a trap graph. He shouted: ""Hey Seryozha, have a look at my cool graph!"" to get his roommate interested and kicked him into the first node.A trap graph is an undirected graph consisting of n nodes and m edges. For edge number k, Dima denoted a range of integers from lk to rk (lk\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89rk). In order to get out of the trap graph, Seryozha initially (before starting his movements) should pick some integer (let\'s call it x), then Seryozha must go some way from the starting node with number 1 to the final node with number n. At that, Seryozha can go along edge k only if lk\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89rk.Seryozha is a mathematician. He defined the loyalty of some path from the 1-st node to the n-th one as the number of integers x, such that if he initially chooses one of them, he passes the whole path. Help Seryozha find the path of maximum loyalty and return to his room as quickly as possible!" "binary search,data structures,dfs and similar,dsu,shortest paths,two pointers" 2000
1789F "Serval and Brain Power" "Serval loves Brain Power and his brain power problem.Serval defines that a string T is powerful iff T can be obtained by concatenating some string T\xe2\x80\xb2 multiple times. Formally speaking, T is powerful iff there exist a string T\xe2\x80\xb2 and an integer k\xe2\x89\xa52 such that T=T\xe2\x80\xb2+T\xe2\x80\xb2+\xe2\x8b\xaf+T\xe2\x80\xb2\xe2\x8f\x9fk timesFor example, gogogo is powerful because it can be obtained by concatenating go three times, but power is not powerful.Serval has a string S consists of lowercase English letters. He is curious about the longest powerful subsequence of S, and he only needs you to find out the length of it. If all the non-empty subsequences of S is not powerful, the answer is considered to be 0.A string a is a subsequence of a string b if a can be obtained from b by the deletion of several (possibly, zero or all) characters." "bitmasks,brute force,dp,greedy,implementation,strings" 2700
1627D "Not Adding" "You have an array a1,a2,\xe2\x80\xa6,an consisting of n distinct integers. You are allowed to perform the following operation on it:  Choose two elements from the array ai and aj (i\xe2\x89\xa0j) such that gcd(ai,aj) is not present in the array, and add gcd(ai,aj) to the end of the array. Here gcd(x,y) denotes greatest common divisor (GCD) of integers x and y. Note that the array changes after each operation, and the subsequent operations are performed on the new array.What is the maximum number of times you can perform the operation on the array?" "brute force,dp,math,number theory" 1900
1765L "Project Manager" "There are n employees at Bersoft company, numbered from 1 to n. Each employee works on some days of the week and rests on the other days. You are given the lists of working days of the week for each employee.There are regular days and holidays. On regular days, only those employees work that have the current day of the week on their list. On holidays, no one works. You are provided with a list of days that are holidays. The days are numbered from 1 onwards, day 1 is Monday.The company receives k project offers they have to complete. The projects are numbered from 1 to k in the order of decreasing priority. Each project consists of multiple parts, where the i-th part must be completed by the ai-th employee. The parts must be completed in order (i.\xe2\x80\x89e. the (i+1)-st part can only be started when the i-th part is completed). Each part takes the corresponding employee a day to complete.The projects can be worked on simultaneously. However, one employee can complete a part of only one project during a single day. If they have a choice of what project to complete a part on, they always go for the project with the highest priority (the lowest index).For each project, output the day that project will be completed on." "brute force,data structures,implementation" 2400
549G "Happy Line" "Do you like summer? Residents of Berland do. They especially love eating ice cream in the hot summer. So this summer day a large queue of n Berland residents lined up in front of the ice cream stall. We know that each of them has a certain amount of berland dollars with them. The residents of Berland are nice people, so each person agrees to swap places with the person right behind him for just 1 dollar. More formally, if person a stands just behind person b, then person a can pay person b 1 dollar, then a and b get swapped. Of course, if person a has zero dollars, he can not swap places with person b.Residents of Berland are strange people. In particular, they get upset when there is someone with a strictly smaller sum of money in the line in front of them.Can you help the residents of Berland form such order in the line so that they were all happy? A happy resident is the one who stands first in the line or the one in front of who another resident stands with not less number of dollars. Note that the people of Berland are people of honor and they agree to swap places only in the manner described above." "constructive algorithms,greedy,sortings" 2200
1203A "Circle of Students" "There are n students standing in a circle in some order. The index of the i-th student is pi. It is guaranteed that all indices of students are distinct integers from 1 to n (i.\xe2\x80\x89e. they form a permutation).Students want to start a round dance. A clockwise round dance can be started if the student 2 comes right after the student 1 in clockwise order (there are no students between them), the student 3 comes right after the student 2 in clockwise order, and so on, and the student n comes right after the student n\xe2\x88\x921 in clockwise order. A counterclockwise round dance is almost the same thing \xe2\x80\x94 the only difference is that the student i should be right after the student i\xe2\x88\x921 in counterclockwise order (this condition should be met for every i from 2 to n). For example, if the indices of students listed in clockwise order are [2,3,4,5,1], then they can start a clockwise round dance. If the students have indices [3,2,1,4] in clockwise order, then they can start a counterclockwise round dance.Your task is to determine whether it is possible to start a round dance. Note that the students cannot change their positions before starting the dance; they cannot swap or leave the circle, and no other student can enter the circle. You have to answer q independent queries." implementation 1000
1942A "Farmer John\'s Challenge" "Trade Winds - Patrick Deng\xe2\xa0\x80Let\'s call an array a sorted if a1\xe2\x89\xa4a2\xe2\x89\xa4\xe2\x80\xa6\xe2\x89\xa4an\xe2\x88\x921\xe2\x89\xa4an.You are given two of Farmer John\'s favorite integers, n and k. He challenges you to find any array a1,a2,\xe2\x80\xa6,an satisfying the following requirements:  1\xe2\x89\xa4ai\xe2\x89\xa4109 for each 1\xe2\x89\xa4i\xe2\x89\xa4n;  Out of the n total cyclic shifts of a, exactly k of them are sorted.\xe2\x80\xa0 If there is no such array a, output \xe2\x88\x921.\xe2\x80\xa0The x-th (1\xe2\x89\xa4x\xe2\x89\xa4n) cyclic shift of the array a is ax,ax+1\xe2\x80\xa6an,a1,a2\xe2\x80\xa6ax\xe2\x88\x921. If cx,i denotes the i\'th element of the x\'th cyclic shift of a, exactly k such x should satisfy cx,1\xe2\x89\xa4cx,2\xe2\x89\xa4\xe2\x80\xa6\xe2\x89\xa4cx,n\xe2\x88\x921\xe2\x89\xa4cx,n.For example, the cyclic shifts for a=[1,2,3,3] are the following:  x=1: [1,2,3,3] (sorted);  x=2: [2,3,3,1] (not sorted);  x=3: [3,3,1,2] (not sorted);  x=4: [3,1,2,3] (not sorted)." "constructive algorithms,math" 800
980F "Cactus to Tree" "You are given a special connected undirected graph where each vertex belongs to at most one simple cycle.Your task is to remove as many edges as needed to convert this graph into a tree (connected graph with no cycles). For each node, independently, output the maximum distance between it and a leaf in the resulting tree, assuming you were to remove the edges in a way that minimizes this distance." dp,graphs,trees 2900
